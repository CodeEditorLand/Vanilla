var S=Object.defineProperty;var a=Object.getOwnPropertyDescriptor;var g=(o,e,r,t)=>{for(var i=t>1?void 0:t?a(e,r):e,d=o.length-1,c;d>=0;d--)(c=o[d])&&(i=(t?c(e,r,i):c(i))||i);return t&&i&&S(e,r,i),i},n=(o,e)=>(r,t)=>e(r,t,o);import{SequencerByKey as u}from"../../../../base/common/async.js";import{IEncryptionService as v}from"../../../../platform/encryption/common/encryptionService.js";import{InstantiationType as m,registerSingleton as p}from"../../../../platform/instantiation/common/extensions.js";import{ILogService as h}from"../../../../platform/log/common/log.js";import{ISecretStorageService as f,BaseSecretStorageService as P}from"../../../../platform/secrets/common/secrets.js";import{IStorageService as _}from"../../../../platform/storage/common/storage.js";import{IBrowserWorkbenchEnvironmentService as I}from"../../environment/browser/environmentService.js";let s=class extends P{_secretStorageProvider;_embedderSequencer;constructor(e,r,t,i){super(!0,e,r,i),t.options?.secretStorageProvider&&(this._secretStorageProvider=t.options.secretStorageProvider,this._embedderSequencer=new u)}get(e){return this._secretStorageProvider?this._embedderSequencer.queue(e,()=>this._secretStorageProvider.get(e)):super.get(e)}set(e,r){return this._secretStorageProvider?this._embedderSequencer.queue(e,async()=>{await this._secretStorageProvider.set(e,r),this.onDidChangeSecretEmitter.fire(e)}):super.set(e,r)}delete(e){return this._secretStorageProvider?this._embedderSequencer.queue(e,async()=>{await this._secretStorageProvider.delete(e),this.onDidChangeSecretEmitter.fire(e)}):super.delete(e)}get type(){return this._secretStorageProvider?this._secretStorageProvider.type:super.type}};s=g([n(0,_),n(1,v),n(2,I),n(3,h)],s),p(f,s,m.Delayed);export{s as BrowserSecretStorageService};
