import o from"assert";import{TextDiffEditorModel as u}from"../../../../common/editor/textDiffEditorModel.js";import{DiffEditorInput as I}from"../../../../common/editor/diffEditorInput.js";import{TextResourceEditorInput as a}from"../../../../common/editor/textResourceEditorInput.js";import{URI as c}from"../../../../../base/common/uri.js";import{workbenchInstantiationService as v,TestServiceAccessor as h}from"../../workbenchTestServices.js";import"../../../../../editor/common/model.js";import"../../../../../platform/instantiation/common/instantiation.js";import{DisposableStore as x}from"../../../../../base/common/lifecycle.js";import{ensureNoDisposablesAreLeakedInTestSuite as M}from"../../../../../base/test/common/utils.js";suite("TextDiffEditorModel",()=>{const e=new x;let i,n;setup(()=>{i=v(void 0,e),n=i.createInstance(h)}),teardown(()=>{e.clear()}),test("basics",async()=>{e.add(n.textModelResolverService.registerTextModelContentProvider("test",{provideTextContent:async function(s){if(s.scheme==="test"){const m="Hello Test",p=n.languageService.createById("json");return e.add(n.modelService.createModel(m,p,s))}return null}}));const f=e.add(i.createInstance(a,c.from({scheme:"test",authority:null,path:"thePath"}),"name","description",void 0,void 0)),l=e.add(i.createInstance(a,c.from({scheme:"test",authority:null,path:"thePath"}),"name2","description",void 0,void 0)),r=e.add(i.createInstance(I,"name","description",f,l,void 0));let t=e.add(await r.resolve());o(t),o(t instanceof u);const d=t.textDiffEditorModel;o(d.original),o(d.modified),t=e.add(await r.resolve()),o(t.isResolved()),o(d!==t.textDiffEditorModel),r.dispose(),o(!t.textDiffEditorModel)}),M()});
