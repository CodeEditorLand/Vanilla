var de=Object.defineProperty;var ce=Object.getOwnPropertyDescriptor;var C=(l,t,e,r)=>{for(var o=r>1?void 0:r?ce(t,e):t,i=l.length-1,s;i>=0;i--)(s=l[i])&&(o=(r?s(t,e,o):s(o))||o);return r&&o&&de(t,e,o),o},n=(l,t)=>(e,r)=>t(e,r,l);import"./media/scm.css";import*as pe from"../../../../base/common/platform.js";import{$ as b,append as I,h as $,reset as me}from"../../../../base/browser/dom.js";import"../../../../base/browser/ui/hover/hover.js";import"../../../../base/browser/ui/hover/hoverDelegate.js";import{IconLabel as B}from"../../../../base/browser/ui/iconLabel/iconLabel.js";import"../../../../base/browser/ui/list/list.js";import"../../../../base/browser/ui/tree/abstractTree.js";import"../../../../base/browser/ui/tree/tree.js";import{fromNow as he}from"../../../../base/common/date.js";import{createMatches as K}from"../../../../base/common/filters.js";import{MarkdownString as ue}from"../../../../base/common/htmlContent.js";import{Disposable as U,DisposableStore as T}from"../../../../base/common/lifecycle.js";import{autorun as G,autorunWithStore as ye,autorunWithStoreHandleChanges as Q,derived as F,derivedOpts as ve,observableValue as O}from"../../../../base/common/observable.js";import{ThemeIcon as k}from"../../../../base/common/themables.js";import{localize as c}from"../../../../nls.js";import{IConfigurationService as H}from"../../../../platform/configuration/common/configuration.js";import{ContextKeyExpr as D,IContextKeyService as Ie}from"../../../../platform/contextkey/common/contextkey.js";import{IContextMenuService as fe}from"../../../../platform/contextview/browser/contextView.js";import{IHoverService as z,WorkbenchHoverDelegate as ge}from"../../../../platform/hover/browser/hover.js";import{IInstantiationService as Se}from"../../../../platform/instantiation/common/instantiation.js";import{IKeybindingService as Me}from"../../../../platform/keybinding/common/keybinding.js";import{WorkbenchAsyncDataTree as Ce}from"../../../../platform/list/browser/listService.js";import{IOpenerService as be}from"../../../../platform/opener/common/opener.js";import{ITelemetryService as we}from"../../../../platform/telemetry/common/telemetry.js";import{asCssVariable as f,foreground as _e}from"../../../../platform/theme/common/colorRegistry.js";import{IThemeService as j}from"../../../../platform/theme/common/themeService.js";import{ViewAction as Y,ViewPane as Te,ViewPaneShowActions as He}from"../../../browser/parts/views/viewPane.js";import{IViewDescriptorService as Le,ViewContainerLocation as J}from"../../../common/views.js";import{renderSCMHistoryItemGraph as Ee,historyItemGroupLocal as Pe,historyItemGroupRemote as Ve,historyItemGroupBase as Ae,toISCMHistoryItemViewModelArray as ke,SWIMLANE_WIDTH as De,renderSCMHistoryGraphPlaceholder as xe,historyItemHoverDeletionsForeground as Re,historyItemHoverLabelForeground as X,historyItemHoverAdditionsForeground as $e,historyItemHoverDefaultLabelForeground as Ge,historyItemHoverDefaultLabelBackground as Z}from"./scmHistory.js";import{isSCMHistoryItemLoadMoreTreeElement as x,isSCMHistoryItemViewModelTreeElement as _,isSCMRepository as q}from"./util.js";import"../common/history.js";import{HISTORY_VIEW_PANE_ID as N,ISCMService as Fe,ISCMViewService as ee}from"../common/scm.js";import"../../../../base/browser/ui/list/listWidget.js";import{stripIcons as Oe}from"../../../../base/common/iconLabels.js";import{IWorkbenchLayoutService as ze,Position as re}from"../../../services/layout/browser/layoutService.js";import{HoverPosition as L}from"../../../../base/browser/ui/hover/hoverWidget.js";import{Action2 as qe,MenuId as E,registerAction2 as W}from"../../../../platform/actions/common/actions.js";import{Sequencer as te,Throttler as Ne}from"../../../../base/common/async.js";import{URI as oe}from"../../../../base/common/uri.js";import{ICommandService as ie}from"../../../../platform/commands/common/commands.js";import{ActionRunner as We}from"../../../../base/common/actions.js";import{tail as Be}from"../../../../base/common/arrays.js";import{Codicon as se}from"../../../../base/common/codicons.js";import{IProgressService as ne}from"../../../../platform/progress/common/progress.js";import{constObservable as Ke,derivedConstOnceDefined as Ue,latestChangedValue as Qe,observableFromEvent as ae}from"../../../../base/common/observableInternal/utils.js";import{ContextKeys as je}from"./scmViewPane.js";import"../../../../base/browser/ui/actionbar/actionbar.js";import"../../../../base/browser/ui/dropdown/dropdownActionViewItem.js";import{ActionViewItem as Ye}from"../../../../base/browser/ui/actionbar/actionViewItems.js";import{renderLabelWithIcons as Je}from"../../../../base/browser/ui/iconLabel/iconLabels.js";import{IQuickInputService as Xe}from"../../../../platform/quickinput/common/quickInput.js";import{Event as Ze}from"../../../../base/common/event.js";import{Iterable as le}from"../../../../base/common/iterator.js";import{clamp as er}from"../../../../base/common/numbers.js";import{observableConfigValue as rr}from"../../../../platform/observable/common/platformObservableUtils.js";import{structuralEquals as tr}from"../../../../base/common/equals.js";class or extends Ye{constructor(e,r,o){super(null,r,{...o,icon:!1,label:!0});this._repository=e}updateLabel(){this.options.label&&this.label&&(this.label.classList.add("scm-graph-repository-picker"),me(this.label,...Je(`$(repo) ${this._repository.provider.name}`)))}}W(class extends Y{constructor(){super({id:"workbench.scm.action.repository",title:"",viewId:N,f1:!1,menu:{id:E.SCMHistoryTitle,when:D.and(D.has("scm.providerCount"),D.greater("scm.providerCount",1)),group:"navigation",order:0}})}async runInView(l,t){t.pickRepository()}}),W(class extends Y{constructor(){super({id:"workbench.scm.action.refreshGraph",title:c("refreshGraph","Refresh"),viewId:N,f1:!1,icon:se.refresh,menu:{id:E.SCMHistoryTitle,group:"navigation",order:1e3}})}async runInView(l,t){t.refresh()}}),W(class extends qe{constructor(){super({id:"workbench.scm.action.scm.viewChanges",title:c("viewChanges","View Changes"),f1:!1,menu:[{id:E.SCMChangesContext,group:"0_view",when:D.equals("config.multiDiffEditor.experimental.enabled",!0)}]})}async run(l,t,...e){const r=l.get(ie);if(!t||e.length===0)return;const o=e[0],i=e[e.length-1],s=t.historyProvider.get();if(e.length>1){const M=await s?.resolveHistoryItemGroupCommonAncestor([o.id,i.id]);if(!M||M!==o.id&&M!==i.id)return}const a=i.parentIds.length>0?i.parentIds[0]:void 0,d=await s?.provideHistoryItemChanges(o.id,a);if(!d?.length)return;const p=e.length===1?`${e[0].displayId??e[0].id} - ${e[0].message}`:c("historyItemChangesEditorTitle","All Changes ({0} \u2194 {1})",i.displayId??i.id,o.displayId??o.id),m=t.rootUri,y=m?m.path:t.label,v=oe.from({scheme:"scm-history-item",path:`${y}/${a}..${o.id}`},!0);r.executeCommand("_workbench.openMultiDiffEditor",{title:p,multiDiffSourceUri:v,resources:d})}});class ir{getHeight(){return 22}getTemplateId(t){if(_(t))return g.TEMPLATE_ID;if(x(t))return S.TEMPLATE_ID;throw new Error("Unknown element")}}let g=class{constructor(t,e,r,o){this.hoverDelegate=t;this._configurationService=e;this._hoverService=r;this._themeService=o}static TEMPLATE_ID="history-item";get templateId(){return g.TEMPLATE_ID}_badgesConfig=rr("scm.graph.badges","filter",this._configurationService);renderTemplate(t){t.parentElement.parentElement.querySelector(".monaco-tl-twistie").classList.add("force-no-twistie");const e=I(t,b(".history-item")),r=I(e,b(".graph-container")),o=new B(e,{supportIcons:!0,supportHighlights:!0,supportDescriptionHighlights:!0}),i=I(e,b(".label-container"));return e.appendChild(i),{element:e,graphContainer:r,label:o,labelContainer:i,elementDisposables:new T,disposables:new T}}renderElement(t,e,r,o){const i=t.element.historyItemViewModel,s=i.historyItem,a=this._hoverService.setupManagedHover(this.hoverDelegate,r.element,this.getTooltip(t.element));r.elementDisposables.add(a),r.graphContainer.textContent="",r.graphContainer.appendChild(Ee(i));const m=t.element.repository.provider.historyProvider.get()?.currentHistoryItemGroup?.get()?.revision===s.id?["history-item-current"]:[],[y,v]=this.processMatches(i,t.filterData);r.label.setLabel(s.subject,s.author,{matches:y,descriptionMatches:v,extraClasses:m}),this._renderLabels(s,r)}_renderLabels(t,e){e.elementDisposables.add(G(r=>{const o=this._badgesConfig.read(r);e.labelContainer.textContent="";const i=t.labels?.find(s=>s.color);for(const s of t.labels??[])if(!(!s.color&&o==="filter")&&s.icon&&k.isThemeIcon(s.icon)){const a=$("div.label",{style:{color:s.color?f(X):f(_e),backgroundColor:s.color?f(s.color):f(Z)}},[$("div.icon@icon"),$("div.description@description")]);a.icon.classList.add(...k.asClassNameArray(s.icon)),a.description.textContent=s.title,a.description.style.display=s===i?"":"none",I(e.labelContainer,a.root)}}))}getTooltip(t){const e=this._themeService.getColorTheme(),r=t.historyItemViewModel.historyItem,o=new ue("",{isTrusted:!0,supportThemeIcons:!0});if(o.appendMarkdown(`$(git-commit) \`${r.displayId??r.id}\`

`),r.author){if(o.appendMarkdown(`$(account) **${r.author}**`),r.timestamp){const i=new Intl.DateTimeFormat(pe.language,{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"});o.appendMarkdown(`, $(history) ${he(r.timestamp,!0,!0)} (${i.format(r.timestamp)})`)}o.appendMarkdown(`

`)}if(o.appendMarkdown(`${r.message}

`),r.statistics){if(o.appendMarkdown(`---

`),o.appendMarkdown(`<span>${r.statistics.files===1?c("fileChanged","{0} file changed",r.statistics.files):c("filesChanged","{0} files changed",r.statistics.files)}</span>`),r.statistics.insertions){const i=e.getColor($e);o.appendMarkdown(`,&nbsp;<span style="color:${i};">${r.statistics.insertions===1?c("insertion","{0} insertion{1}",r.statistics.insertions,"(+)"):c("insertions","{0} insertions{1}",r.statistics.insertions,"(+)")}</span>`)}if(r.statistics.deletions){const i=e.getColor(Re);o.appendMarkdown(`,&nbsp;<span style="color:${i};">${r.statistics.deletions===1?c("deletion","{0} deletion{1}",r.statistics.deletions,"(-)"):c("deletions","{0} deletions{1}",r.statistics.deletions,"(-)")}</span>`)}}return(r.labels??[]).length>0&&(o.appendMarkdown(`

---

`),o.appendMarkdown((r.labels??[]).map(i=>{const s=k.isThemeIcon(i.icon)?i.icon.id:"",a=i.color?f(i.color):f(Z);return`<span style="color:${i.color?f(X):f(Ge)};background-color:${a};border-radius:2px;">&nbsp;$(${s})&nbsp;${i.title}&nbsp;</span>`}).join("&nbsp;&nbsp;"))),{markdown:o,markdownNotSupportedFallback:r.message}}processMatches(t,e){return e?[t.historyItem.message===e.label?K(e.score):void 0,t.historyItem.author===e.label?K(e.score):void 0]:[void 0,void 0]}disposeElement(t,e,r,o){r.elementDisposables.clear()}disposeTemplate(t){t.disposables.dispose()}};g=C([n(1,H),n(2,z),n(3,j)],g);let S=class{constructor(t,e,r){this._loadingMore=t;this._loadMoreCallback=e;this._configurationService=r}static TEMPLATE_ID="historyItemLoadMore";get templateId(){return S.TEMPLATE_ID}renderTemplate(t){t.parentElement.parentElement.querySelector(".monaco-tl-twistie").classList.add("force-no-twistie");const e=I(t,b(".history-item-load-more")),r=I(e,b(".graph-placeholder")),o=I(e,b(".history-item-placeholder")),i=new B(o,{supportIcons:!0});return{element:e,graphPlaceholder:r,historyItemPlaceholderContainer:o,historyItemPlaceholderLabel:i,elementDisposables:new T,disposables:new T}}renderElement(t,e,r,o){r.graphPlaceholder.textContent="",r.graphPlaceholder.style.width=`${De*(t.element.graphColumns.length+1)}px`,r.graphPlaceholder.appendChild(xe(t.element.graphColumns));const i=this._configurationService.getValue("scm.graph.pageOnScroll")===!0;r.historyItemPlaceholderContainer.classList.toggle("shimmer",i),i?(r.historyItemPlaceholderLabel.setLabel(""),this._loadMoreCallback(t.element.repository)):r.elementDisposables.add(G(s=>{const d=`$(${this._loadingMore().read(s)?"loading~spin":"fold-down"})`;r.historyItemPlaceholderLabel.setLabel(c("loadMore","{0} Load More...",d))}))}disposeElement(t,e,r,o){r.elementDisposables.clear()}disposeTemplate(t){t.disposables.dispose()}};S=C([n(2,H)],S);let P=class extends ge{constructor(e,r,o,i){super("element",!0,()=>this.getHoverOptions(),o,i);this._viewContainerLocation=e;this.layoutService=r}getHoverOptions(){const e=this.layoutService.getSideBarPosition();let r;return this._viewContainerLocation===J.Sidebar?r=e===re.LEFT?L.RIGHT:L.LEFT:this._viewContainerLocation===J.AuxiliaryBar?r=e===re.LEFT?L.LEFT:L.RIGHT:r=L.RIGHT,{additionalClasses:["history-item-hover"],position:{hoverPosition:r,forcePosition:!0}}}};P=C([n(1,ze),n(2,H),n(3,z)],P);let V=class extends We{constructor(e){super();this._progressService=e}runAction(e,r){return this._progressService.withProgress({location:N},async()=>await super.runAction(e,r))}};V=C([n(0,ne)],V);class sr{getWidgetAriaLabel(){return c("scm history","Source Control History")}getAriaLabel(t){if(q(t))return`${t.provider.name} ${t.provider.label}`;if(_(t)){const e=t.historyItemViewModel.historyItem;return`${Oe(e.message).trim()}${e.author?`, ${e.author}`:""}`}else return""}}class nr{getId(t){if(q(t))return`repo:${t.provider.id}`;if(_(t)){const e=t.repository.provider,r=t.historyItemViewModel.historyItem;return`historyItem:${e.id}/${r.id}/${r.parentIds.join(",")}`}else{if(x(t))return`historyItemLoadMore:${t.repository.provider.id}}`;throw new Error("Invalid tree element")}}}class ar{getKeyboardNavigationLabel(t){if(!q(t)){if(_(t))return[t.historyItemViewModel.historyItem.message,t.historyItemViewModel.historyItem.author];if(x(t))return"";throw new Error("Invalid tree element")}}}class lr extends U{async getChildren(t){if(!(t instanceof w))return[];const e=[],r=await t.getHistoryItems();e.push(...r);const o=t.repository.get(),i=Be(r);return o&&i&&i.historyItemViewModel.outputSwimlanes.length>0&&e.push({repository:o,graphColumns:i.historyItemViewModel.outputSwimlanes,type:"historyItemLoadMore"}),e}hasChildren(t){return t instanceof w}}let w=class extends U{constructor(e,r,o){super();this._configurationService=e;this._scmService=r;this._scmViewService=o;this._register(G(i=>{const s=this._closedRepository.read(i);s&&(this.repository.get()===s&&this._selectedRepository.set(le.first(this._scmService.repositories)??"auto",void 0),this._state.delete(s))}))}_closedRepository=ae(this,this._scmService.onDidRemoveRepository,e=>e);_firstRepository=this._scmService.repositoryCount>0?Ke(le.first(this._scmService.repositories)):ae(this,Ze.once(this._scmService.onDidAddRepository),e=>e);_selectedRepository=O(this,"auto");_graphRepository=F(e=>{const r=this._selectedRepository.read(e);return r!=="auto"?r:this._scmViewService.activeRepository.read(e)});repository=Qe(this,[this._firstRepository,this._graphRepository]);_historyItemGroupFilter=O(this,"auto");historyItemGroupFilter=F(e=>{const r=this._historyItemGroupFilter.read(e);if(Array.isArray(r))return r;if(r==="all")return[];const s=this.repository.get()?.provider.historyProvider.get()?.currentHistoryItemGroup.get();return s?[s.revision??s.id,...s.remote?[s.remote.revision??s.remote.id]:[],...s.base?[s.base.revision??s.base.id]:[]]:[]});_state=new Map;clearRepositoryState(){const e=this.repository.get();e&&this._state.delete(e)}setLoadMore(e,r){const o=this._state.get(e);o&&this._state.set(e,{...o,loadMore:r})}async getHistoryItems(){const e=this.repository.get();if(!e)return[];let r=this._state.get(e);const o=e.provider.historyProvider.get(),i=r?.currentHistoryItemGroup??o?.currentHistoryItemGroup.get();if(!o||!i)return[];if(!r||r.loadMore){const a=r?.items??[],d=this.historyItemGroupFilter.get(),p=er(this._configurationService.getValue("scm.graph.pageSize"),1,1e3),m=await o.provideHistoryItems({historyItemGroupIds:d,limit:p,skip:a.length})??[];r={currentHistoryItemGroup:i,items:[...a,...m],loadMore:!1},this._state.set(e,r)}const s=this._getGraphColorMap(i);return ke(r.items,s).map(a=>({repository:e,historyItemViewModel:a,type:"historyItemViewModel"}))}setRepository(e){this._selectedRepository.set(e,void 0)}_getGraphColorMap(e){const r=new Map([[e.name,Pe]]);return e.remote&&r.set(e.remote.name,Ve),e.base&&r.set(e.base.name,Ae),this._historyItemGroupFilter.get()==="all"&&r.set("*",""),r}dispose(){this._state.clear(),super.dispose()}};w=C([n(0,H),n(1,Fe),n(2,ee)],w);let R=class extends Te{constructor(e,r,o,i,s,a,d,p,m,y,v,M,A,u,h){super({...e,titleMenuId:E.SCMHistoryTitle,showActions:He.WhenExpanded},p,d,a,v,y,m,M,A,u,h);this._commandService=r;this._scmViewService=o;this._progressService=i;this._quickInputService=s;this._scmProviderCtx=je.SCMProvider.bindTo(this.scopedContextKeyService),this._actionRunner=this.instantiationService.createInstance(V),this._register(this._actionRunner),this._register(this._updateChildrenThrottler)}_treeContainer;_tree;_treeViewModel;_treeDataSource;_treeIdentityProvider;_repositoryLoadMore=O(this,!1);_actionRunner;_visibilityDisposables=new T;_treeOperationSequencer=new te;_treeLoadMoreSequencer=new te;_updateChildrenThrottler=new Ne;_scmProviderCtx;layoutBody(e,r){super.layoutBody(e,r),this._tree.layout(e,r)}renderBody(e){super.renderBody(e),this._treeContainer=I(e,b(".scm-view.scm-history-view")),this._treeContainer.classList.add("file-icon-themable-tree"),this._createTree(this._treeContainer),this.onDidChangeBodyVisibility(r=>{if(r){this._treeViewModel=this.instantiationService.createInstance(w),this._visibilityDisposables.add(this._treeViewModel);const o=Ue(this,i=>{const s=this._treeViewModel.repository.read(i);return s?.provider.historyProvider.read(i)?.currentHistoryItemGroup.read(i)!==void 0?s:void 0});this._visibilityDisposables.add(ye(async(i,s)=>{o.read(i)&&(this._treeOperationSequencer.queue(async()=>{await this._tree.setInput(this._treeViewModel),this._tree.scrollTop=0}),s.add(Q({owner:this,createEmptyChangeSummary:()=>({refresh:!1}),handleChange(d,p){return p.refresh=!0,!0}},(d,p,m)=>{const y=this._treeViewModel.repository.read(d),v=y?.provider.historyProvider.read(d);if(!y||!v)return;this._scmProviderCtx.set(y.provider.contextValue);const M=ve({owner:this,equalsFn:tr},u=>{const h=v.currentHistoryItemGroup.read(u);return h?{id:h.id,revision:h.revision,remoteId:h.remote?.id}:void 0}),A=F(u=>v.currentHistoryItemGroup.read(u)?.remote?.revision);m.add(Q({owner:this,createEmptyChangeSummary:()=>({refresh:!1}),handleChange(u,h){return h.refresh=u.didChange(A)?"ifScrollTop":!0,!0}},(u,h)=>{if(!(!M.read(u)&&!A.read(u)||h.refresh===!1)){if(h.refresh===!0){this.refresh();return}if(h.refresh==="ifScrollTop"){if(this._tree.scrollTop===0){this.refresh();return}this.updateTitleDescription(c("outdated","OUTDATED"))}}})),p.refresh&&this.refresh()})))}))}else this._visibilityDisposables.clear()})}getActionRunner(){return this._actionRunner}getActionsContext(){return this._treeViewModel?.repository.get()?.provider}getActionViewItem(e,r){if(e.id==="workbench.scm.action.repository"){const o=this._treeViewModel?.repository.get();if(o)return new or(o,e,r)}return super.getActionViewItem(e,r)}async refresh(){await this._updateChildren(!0),this.updateActions(),this.updateTitleDescription(void 0),this._tree.scrollTop=0}async pickRepository(){const e=[{label:c("auto","Auto"),description:c("activeRepository","Show the source control graph for the active repository"),repository:"auto"},{type:"separator"}];e.push(...this._scmViewService.repositories.map(o=>({label:o.provider.name,description:o.provider.rootUri?.fsPath,iconClass:k.asClassName(se.repo),repository:o})));const r=await this._quickInputService.pick(e,{placeHolder:c("scmGraphRepository","Select the repository to view, type to filter all repositories")});r&&this._treeViewModel.setRepository(r.repository)}_createTree(e){this._treeIdentityProvider=new nr;const r=this.instantiationService.createInstance(P,this.viewDescriptorService.getViewLocationById(this.id));this._register(r),this._treeDataSource=this.instantiationService.createInstance(lr),this._register(this._treeDataSource),this._tree=this.instantiationService.createInstance(Ce,"SCM History Tree",e,new ir,[this.instantiationService.createInstance(g,r),this.instantiationService.createInstance(S,()=>this._repositoryLoadMore,o=>this._loadMoreCallback(o))],this._treeDataSource,{accessibilityProvider:new sr,identityProvider:this._treeIdentityProvider,collapseByDefault:o=>!1,keyboardNavigationLabelProvider:new ar,horizontalScrolling:!1,multipleSelectionSupport:!1}),this._register(this._tree),this._tree.onDidOpen(this._onDidOpen,this,this._store),this._tree.onContextMenu(this._onContextMenu,this,this._store)}async _onDidOpen(e){if(e.element)if(_(e.element)){const r=e.element.historyItemViewModel.historyItem,o=r.parentIds.length>0?r.parentIds[0]:void 0,s=await e.element.repository.provider.historyProvider.get()?.provideHistoryItemChanges(r.id,o);if(s){const a=`${r.displayId??r.id} - ${r.message}`,d=e.element.repository.provider.rootUri,p=d?d.path:e.element.repository.provider.label,m=oe.from({scheme:"scm-history-item",path:`${p}/${o}..${r.id}`},!0);await this._commandService.executeCommand("_workbench.openMultiDiffEditor",{title:a,multiDiffSourceUri:m,resources:s})}}else x(e.element)&&(this.configurationService.getValue("scm.graph.pageOnScroll")===!0||(this._loadMoreCallback(e.element.repository),this._tree.setSelection([])));else return}_onContextMenu(e){const r=e.element;!r||!_(r)||this.contextMenuService.showContextMenu({menuId:E.SCMChangesContext,menuActionOptions:{arg:r.repository.provider,shouldForwardArgs:!0},getAnchor:()=>e.anchor,getActionsContext:()=>r.historyItemViewModel.historyItem})}async _loadMoreCallback(e){return this._treeLoadMoreSequencer.queue(async()=>{this._repositoryLoadMore.get()||(this._repositoryLoadMore.set(!0,void 0),this._treeViewModel.setLoadMore(e,!0),await this._updateChildren(),this._repositoryLoadMore.set(!1,void 0))})}_updateChildren(e=!1){return this._updateChildrenThrottler.queue(()=>this._treeOperationSequencer.queue(async()=>{e&&this._treeViewModel.clearRepositoryState(),await this._progressService.withProgress({location:this.id},async()=>{await this._tree.updateChildren(void 0,void 0,void 0,{})})}))}dispose(){this._visibilityDisposables.dispose(),super.dispose()}};R=C([n(1,ie),n(2,ee),n(3,ne),n(4,Xe),n(5,H),n(6,fe),n(7,Me),n(8,Se),n(9,Le),n(10,Ie),n(11,be),n(12,j),n(13,we),n(14,z)],R);export{R as SCMHistoryViewPane};
