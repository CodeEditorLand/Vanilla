var T=Object.defineProperty;var _=Object.getOwnPropertyDescriptor;var l=(m,o,e,c)=>{for(var i=c>1?void 0:c?_(o,e):o,s=m.length-1,a;s>=0;s--)(a=m[s])&&(i=(c?a(o,e,i):a(i))||i);return c&&i&&T(o,e,i),i},r=(m,o)=>(e,c)=>o(e,c,m);import{localize as I}from"../../../../nls.js";import{IQuickInputService as P}from"../../../../platform/quickinput/common/quickInput.js";import{PickerQuickAccessProvider as y,TriggerAction as h}from"../../../../platform/quickinput/browser/pickerQuickAccess.js";import{matchesFuzzy as C}from"../../../../base/common/filters.js";import{IExtensionService as E}from"../../../services/extensions/common/extensions.js";import{ITaskService as d}from"../common/taskService.js";import{CustomTask as R,ContributedTask as Q,ConfiguringTask as b}from"../common/tasks.js";import"../../../../base/common/cancellation.js";import"../../../../base/common/lifecycle.js";import{TaskQuickPick as w}from"./taskQuickPick.js";import{IConfigurationService as A}from"../../../../platform/configuration/common/configuration.js";import{isString as g}from"../../../../base/common/types.js";import{INotificationService as L}from"../../../../platform/notification/common/notification.js";import{IDialogService as x}from"../../../../platform/dialogs/common/dialogs.js";import{IThemeService as q}from"../../../../platform/theme/common/themeService.js";import{IStorageService as z}from"../../../../platform/storage/common/storage.js";let k=class extends y{constructor(e,c,i,s,a,v,n,p){super(k.PREFIX,{noResultsPick:{label:I("noTaskResults","No matching tasks")}});this._taskService=c;this._configurationService=i;this._quickInputService=s;this._notificationService=a;this._dialogService=v;this._themeService=n;this._storageService=p}static PREFIX="task ";async _getPicks(e,c,i){if(i.isCancellationRequested)return[];const s=new w(this._taskService,this._configurationService,this._quickInputService,this._notificationService,this._themeService,this._dialogService,this._storageService),a=await s.getTopLevelEntries(),v=[];for(const n of a.entries){const p=C(e,n.label);if(!p)continue;n.type==="separator"&&v.push(n);const t=n.task,u=n;u.highlights={label:p},u.trigger=S=>{if(S===1&&u.buttons?.length===2){const f=t&&!g(t)?t.getKey():void 0;return f&&this._taskService.removeRecentlyUsedTask(f),h.REFRESH_PICKER}else return Q.is(t)?this._taskService.customize(t,void 0,!0):R.is(t)&&this._taskService.openConfig(t),h.CLOSE_PICKER},u.accept=async()=>{if(g(t)){const S=await s.show(I("TaskService.pickRunTask","Select the task to run"),void 0,t);S&&this._taskService.run(S,{attachProblemMatcher:!0})}else this._taskService.run(await this._toTask(t),{attachProblemMatcher:!0})},v.push(u)}return v}async _toTask(e){return b.is(e)?this._taskService.tryResolveTask(e):e}};k=l([r(0,E),r(1,d),r(2,A),r(3,P),r(4,L),r(5,x),r(6,q),r(7,z)],k);export{k as TasksQuickAccessProvider};
