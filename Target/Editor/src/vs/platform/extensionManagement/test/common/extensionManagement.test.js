import t from"assert";import{ensureNoDisposablesAreLeakedInTestSuite as n}from"../../../../base/test/common/utils.js";import{EXTENSION_IDENTIFIER_PATTERN as i}from"../../common/extensionManagement.js";import{ExtensionKey as s}from"../../common/extensionManagementUtil.js";import{TargetPlatform as r}from"../../../extensions/common/extensions.js";suite("Extension Identifier Pattern",()=>{n(),test("extension identifier pattern",()=>{const e=new RegExp(i);t.strictEqual(!0,e.test("publisher.name")),t.strictEqual(!0,e.test("publiSher.name")),t.strictEqual(!0,e.test("publisher.Name")),t.strictEqual(!0,e.test("PUBLISHER.NAME")),t.strictEqual(!0,e.test("PUBLISHEr.NAMe")),t.strictEqual(!0,e.test("PUBLISHEr.N-AMe")),t.strictEqual(!0,e.test("PUB-LISHEr.NAMe")),t.strictEqual(!0,e.test("PUB-LISHEr.N-AMe")),t.strictEqual(!0,e.test("PUBLISH12Er90.N-A54Me123")),t.strictEqual(!0,e.test("111PUBLISH12Er90.N-1111A54Me123")),t.strictEqual(!1,e.test("publishername")),t.strictEqual(!1,e.test("-publisher.name")),t.strictEqual(!1,e.test("publisher.-name")),t.strictEqual(!1,e.test("-publisher.-name")),t.strictEqual(!1,e.test("publ_isher.name")),t.strictEqual(!1,e.test("publisher._name"))}),test("extension key",()=>{t.strictEqual(new s({id:"pub.extension-name"},"1.0.1").toString(),"pub.extension-name-1.0.1"),t.strictEqual(new s({id:"pub.extension-name"},"1.0.1",r.UNDEFINED).toString(),"pub.extension-name-1.0.1"),t.strictEqual(new s({id:"pub.extension-name"},"1.0.1",r.WIN32_X64).toString(),`pub.extension-name-1.0.1-${r.WIN32_X64}`)}),test("extension key parsing",()=>{t.strictEqual(s.parse("pub.extension-name"),null),t.strictEqual(s.parse("pub.extension-name@1.2.3"),null),t.strictEqual(s.parse("pub.extension-name-1.0.1")?.toString(),"pub.extension-name-1.0.1"),t.strictEqual(s.parse("pub.extension-name-1.0.1-win32-x64")?.toString(),"pub.extension-name-1.0.1-win32-x64")})});
