import f from"assert";import{ensureNoDisposablesAreLeakedInTestSuite as r}from"../../../../base/test/common/utils.js";import{RenderedLinesCollection as u}from"../../../browser/view/viewLayer.js";class l{constructor(o){this.id=o}_pinged=!1;onContentChanged(){this._pinged=!0}onTokensChanged(){this._pinged=!0}}function L(e,o){const d={startLineNumber:e.getStartLineNumber(),lines:[],pinged:[]};for(let t=e.getStartLineNumber();t<=e.getEndLineNumber();t++)d.lines.push(e.getLine(t).id),d.pinged.push(e.getLine(t)._pinged);f.deepStrictEqual(d,o)}suite("RenderedLinesCollection onLinesDeleted",()=>{r();function e(o,d,t,n){const s=new u({createLine:()=>new l("new")});s._set(6,[new l("old6"),new l("old7"),new l("old8"),new l("old9")]);const a=s.onLinesDeleted(o,d);let i=[];a&&(i=a.map(g=>g.id)),f.deepStrictEqual(i,t),L(s,n)}test("A1",()=>{e(3,3,[],{startLineNumber:5,lines:["old6","old7","old8","old9"],pinged:[!1,!1,!1,!1]})}),test("A2",()=>{e(3,4,[],{startLineNumber:4,lines:["old6","old7","old8","old9"],pinged:[!1,!1,!1,!1]})}),test("A3",()=>{e(3,5,[],{startLineNumber:3,lines:["old6","old7","old8","old9"],pinged:[!1,!1,!1,!1]})}),test("A4",()=>{e(3,6,["old6"],{startLineNumber:3,lines:["old7","old8","old9"],pinged:[!1,!1,!1]})}),test("A5",()=>{e(3,7,["old6","old7"],{startLineNumber:3,lines:["old8","old9"],pinged:[!1,!1]})}),test("A6",()=>{e(3,8,["old6","old7","old8"],{startLineNumber:3,lines:["old9"],pinged:[!1]})}),test("A7",()=>{e(3,9,["old6","old7","old8","old9"],{startLineNumber:3,lines:[],pinged:[]})}),test("A8",()=>{e(3,10,["old6","old7","old8","old9"],{startLineNumber:3,lines:[],pinged:[]})}),test("B1",()=>{e(5,5,[],{startLineNumber:5,lines:["old6","old7","old8","old9"],pinged:[!1,!1,!1,!1]})}),test("B2",()=>{e(5,6,["old6"],{startLineNumber:5,lines:["old7","old8","old9"],pinged:[!1,!1,!1]})}),test("B3",()=>{e(5,7,["old6","old7"],{startLineNumber:5,lines:["old8","old9"],pinged:[!1,!1]})}),test("B4",()=>{e(5,8,["old6","old7","old8"],{startLineNumber:5,lines:["old9"],pinged:[!1]})}),test("B5",()=>{e(5,9,["old6","old7","old8","old9"],{startLineNumber:5,lines:[],pinged:[]})}),test("B6",()=>{e(5,10,["old6","old7","old8","old9"],{startLineNumber:5,lines:[],pinged:[]})}),test("C1",()=>{e(6,6,["old6"],{startLineNumber:6,lines:["old7","old8","old9"],pinged:[!1,!1,!1]})}),test("C2",()=>{e(6,7,["old6","old7"],{startLineNumber:6,lines:["old8","old9"],pinged:[!1,!1]})}),test("C3",()=>{e(6,8,["old6","old7","old8"],{startLineNumber:6,lines:["old9"],pinged:[!1]})}),test("C4",()=>{e(6,9,["old6","old7","old8","old9"],{startLineNumber:6,lines:[],pinged:[]})}),test("C5",()=>{e(6,10,["old6","old7","old8","old9"],{startLineNumber:6,lines:[],pinged:[]})}),test("D1",()=>{e(7,7,["old7"],{startLineNumber:6,lines:["old6","old8","old9"],pinged:[!1,!1,!1]})}),test("D2",()=>{e(7,8,["old7","old8"],{startLineNumber:6,lines:["old6","old9"],pinged:[!1,!1]})}),test("D3",()=>{e(7,9,["old7","old8","old9"],{startLineNumber:6,lines:["old6"],pinged:[!1]})}),test("D4",()=>{e(7,10,["old7","old8","old9"],{startLineNumber:6,lines:["old6"],pinged:[!1]})}),test("E1",()=>{e(8,8,["old8"],{startLineNumber:6,lines:["old6","old7","old9"],pinged:[!1,!1,!1]})}),test("E2",()=>{e(8,9,["old8","old9"],{startLineNumber:6,lines:["old6","old7"],pinged:[!1,!1]})}),test("E3",()=>{e(8,10,["old8","old9"],{startLineNumber:6,lines:["old6","old7"],pinged:[!1,!1]})}),test("F1",()=>{e(9,9,["old9"],{startLineNumber:6,lines:["old6","old7","old8"],pinged:[!1,!1,!1]})}),test("F2",()=>{e(9,10,["old9"],{startLineNumber:6,lines:["old6","old7","old8"],pinged:[!1,!1,!1]})}),test("G1",()=>{e(10,10,[],{startLineNumber:6,lines:["old6","old7","old8","old9"],pinged:[!1,!1,!1,!1]})}),test("G2",()=>{e(10,11,[],{startLineNumber:6,lines:["old6","old7","old8","old9"],pinged:[!1,!1,!1,!1]})}),test("H1",()=>{e(11,13,[],{startLineNumber:6,lines:["old6","old7","old8","old9"],pinged:[!1,!1,!1,!1]})})}),suite("RenderedLinesCollection onLineChanged",()=>{r();function e(o,d,t){const n=new u({createLine:()=>new l("new")});n._set(6,[new l("old6"),new l("old7"),new l("old8"),new l("old9")]);const s=n.onLinesChanged(o,1);f.deepStrictEqual(s,d),L(n,t)}test("3",()=>{e(3,!1,{startLineNumber:6,lines:["old6","old7","old8","old9"],pinged:[!1,!1,!1,!1]})}),test("4",()=>{e(4,!1,{startLineNumber:6,lines:["old6","old7","old8","old9"],pinged:[!1,!1,!1,!1]})}),test("5",()=>{e(5,!1,{startLineNumber:6,lines:["old6","old7","old8","old9"],pinged:[!1,!1,!1,!1]})}),test("6",()=>{e(6,!0,{startLineNumber:6,lines:["old6","old7","old8","old9"],pinged:[!0,!1,!1,!1]})}),test("7",()=>{e(7,!0,{startLineNumber:6,lines:["old6","old7","old8","old9"],pinged:[!1,!0,!1,!1]})}),test("8",()=>{e(8,!0,{startLineNumber:6,lines:["old6","old7","old8","old9"],pinged:[!1,!1,!0,!1]})}),test("9",()=>{e(9,!0,{startLineNumber:6,lines:["old6","old7","old8","old9"],pinged:[!1,!1,!1,!0]})}),test("10",()=>{e(10,!1,{startLineNumber:6,lines:["old6","old7","old8","old9"],pinged:[!1,!1,!1,!1]})}),test("11",()=>{e(11,!1,{startLineNumber:6,lines:["old6","old7","old8","old9"],pinged:[!1,!1,!1,!1]})})}),suite("RenderedLinesCollection onLinesInserted",()=>{r();function e(o,d,t,n){const s=new u({createLine:()=>new l("new")});s._set(6,[new l("old6"),new l("old7"),new l("old8"),new l("old9")]);const a=s.onLinesInserted(o,d);let i=[];a&&(i=a.map(g=>g.id)),f.deepStrictEqual(i,t),L(s,n)}test("A1",()=>{e(3,3,[],{startLineNumber:7,lines:["old6","old7","old8","old9"],pinged:[!1,!1,!1,!1]})}),test("A2",()=>{e(3,4,[],{startLineNumber:8,lines:["old6","old7","old8","old9"],pinged:[!1,!1,!1,!1]})}),test("A3",()=>{e(3,5,[],{startLineNumber:9,lines:["old6","old7","old8","old9"],pinged:[!1,!1,!1,!1]})}),test("A4",()=>{e(3,6,[],{startLineNumber:10,lines:["old6","old7","old8","old9"],pinged:[!1,!1,!1,!1]})}),test("A5",()=>{e(3,7,[],{startLineNumber:11,lines:["old6","old7","old8","old9"],pinged:[!1,!1,!1,!1]})}),test("A6",()=>{e(3,8,[],{startLineNumber:12,lines:["old6","old7","old8","old9"],pinged:[!1,!1,!1,!1]})}),test("A7",()=>{e(3,9,[],{startLineNumber:13,lines:["old6","old7","old8","old9"],pinged:[!1,!1,!1,!1]})}),test("A8",()=>{e(3,10,[],{startLineNumber:14,lines:["old6","old7","old8","old9"],pinged:[!1,!1,!1,!1]})}),test("B1",()=>{e(5,5,[],{startLineNumber:7,lines:["old6","old7","old8","old9"],pinged:[!1,!1,!1,!1]})}),test("B2",()=>{e(5,6,[],{startLineNumber:8,lines:["old6","old7","old8","old9"],pinged:[!1,!1,!1,!1]})}),test("B3",()=>{e(5,7,[],{startLineNumber:9,lines:["old6","old7","old8","old9"],pinged:[!1,!1,!1,!1]})}),test("B4",()=>{e(5,8,[],{startLineNumber:10,lines:["old6","old7","old8","old9"],pinged:[!1,!1,!1,!1]})}),test("B5",()=>{e(5,9,[],{startLineNumber:11,lines:["old6","old7","old8","old9"],pinged:[!1,!1,!1,!1]})}),test("B6",()=>{e(5,10,[],{startLineNumber:12,lines:["old6","old7","old8","old9"],pinged:[!1,!1,!1,!1]})}),test("C1",()=>{e(6,6,[],{startLineNumber:7,lines:["old6","old7","old8","old9"],pinged:[!1,!1,!1,!1]})}),test("C2",()=>{e(6,7,[],{startLineNumber:8,lines:["old6","old7","old8","old9"],pinged:[!1,!1,!1,!1]})}),test("C3",()=>{e(6,8,[],{startLineNumber:9,lines:["old6","old7","old8","old9"],pinged:[!1,!1,!1,!1]})}),test("C4",()=>{e(6,9,[],{startLineNumber:10,lines:["old6","old7","old8","old9"],pinged:[!1,!1,!1,!1]})}),test("C5",()=>{e(6,10,[],{startLineNumber:11,lines:["old6","old7","old8","old9"],pinged:[!1,!1,!1,!1]})}),test("D1",()=>{e(7,7,["old9"],{startLineNumber:6,lines:["old6","new","old7","old8"],pinged:[!1,!1,!1,!1]})}),test("D2",()=>{e(7,8,["old8","old9"],{startLineNumber:6,lines:["old6","new","new","old7"],pinged:[!1,!1,!1,!1]})}),test("D3",()=>{e(7,9,["old7","old8","old9"],{startLineNumber:6,lines:["old6"],pinged:[!1]})}),test("D4",()=>{e(7,10,["old7","old8","old9"],{startLineNumber:6,lines:["old6"],pinged:[!1]})}),test("E1",()=>{e(8,8,["old9"],{startLineNumber:6,lines:["old6","old7","new","old8"],pinged:[!1,!1,!1,!1]})}),test("E2",()=>{e(8,9,["old8","old9"],{startLineNumber:6,lines:["old6","old7"],pinged:[!1,!1]})}),test("E3",()=>{e(8,10,["old8","old9"],{startLineNumber:6,lines:["old6","old7"],pinged:[!1,!1]})}),test("F1",()=>{e(9,9,["old9"],{startLineNumber:6,lines:["old6","old7","old8"],pinged:[!1,!1,!1]})}),test("F2",()=>{e(9,10,["old9"],{startLineNumber:6,lines:["old6","old7","old8"],pinged:[!1,!1,!1]})}),test("G1",()=>{e(10,10,[],{startLineNumber:6,lines:["old6","old7","old8","old9"],pinged:[!1,!1,!1,!1]})}),test("G2",()=>{e(10,11,[],{startLineNumber:6,lines:["old6","old7","old8","old9"],pinged:[!1,!1,!1,!1]})}),test("H1",()=>{e(11,13,[],{startLineNumber:6,lines:["old6","old7","old8","old9"],pinged:[!1,!1,!1,!1]})})}),suite("RenderedLinesCollection onTokensChanged",()=>{r();function e(o,d,t,n){const s=new u({createLine:()=>new l("new")});s._set(6,[new l("old6"),new l("old7"),new l("old8"),new l("old9")]);const a=s.onTokensChanged([{fromLineNumber:o,toLineNumber:d}]);f.deepStrictEqual(a,t),L(s,n)}test("A",()=>{e(3,3,!1,{startLineNumber:6,lines:["old6","old7","old8","old9"],pinged:[!1,!1,!1,!1]})}),test("B",()=>{e(3,5,!1,{startLineNumber:6,lines:["old6","old7","old8","old9"],pinged:[!1,!1,!1,!1]})}),test("C",()=>{e(3,6,!0,{startLineNumber:6,lines:["old6","old7","old8","old9"],pinged:[!0,!1,!1,!1]})}),test("D",()=>{e(6,6,!0,{startLineNumber:6,lines:["old6","old7","old8","old9"],pinged:[!0,!1,!1,!1]})}),test("E",()=>{e(5,10,!0,{startLineNumber:6,lines:["old6","old7","old8","old9"],pinged:[!0,!0,!0,!0]})}),test("F",()=>{e(8,9,!0,{startLineNumber:6,lines:["old6","old7","old8","old9"],pinged:[!1,!1,!0,!0]})}),test("G",()=>{e(8,11,!0,{startLineNumber:6,lines:["old6","old7","old8","old9"],pinged:[!1,!1,!0,!0]})}),test("H",()=>{e(10,10,!1,{startLineNumber:6,lines:["old6","old7","old8","old9"],pinged:[!1,!1,!1,!1]})}),test("I",()=>{e(10,11,!1,{startLineNumber:6,lines:["old6","old7","old8","old9"],pinged:[!1,!1,!1,!1]})})});
