import S from"../../../../../base/common/severity.js";import{localize as o}from"../../../../../nls.js";import{Action2 as l}from"../../../../../platform/actions/common/actions.js";import{IDialogService as v}from"../../../../../platform/dialogs/common/dialogs.js";import"../../../../../platform/instantiation/common/instantiation.js";import{IAuthenticationAccessService as A}from"../../../../services/authentication/browser/authenticationAccessService.js";import{IAuthenticationUsageService as p}from"../../../../services/authentication/browser/authenticationUsageService.js";import{IAuthenticationService as h}from"../../../../services/authentication/common/authentication.js";class k extends l{constructor(){super({id:"_signOutOfAccount",title:o("signOutOfAccount","Sign out of account"),f1:!1})}async run(n,{providerId:t,accountLabel:e}){const s=n.get(h),r=n.get(p),m=n.get(A),a=n.get(v);if(!t||!e)throw new Error("Invalid arguments. Expected: { providerId: string; accountLabel: string }");const g=(await s.getSessions(t)).filter(i=>i.account.label===e),c=r.readAccountUsages(t,e),{confirmed:u}=await a.confirm({type:S.Info,message:c.length?o("signOutMessage",`The account '{0}' has been used by: 

{1}

 Sign out from these extensions?`,e,c.map(i=>i.extensionName).join(`
`)):o("signOutMessageSimple","Sign out of '{0}'?",e),primaryButton:o({key:"signOut",comment:["&& denotes a mnemonic"]},"&&Sign Out")});if(u){const i=g.map(f=>s.removeSession(t,f.id));await Promise.all(i),r.removeAccountUsage(t,e),m.removeAllowedExtensions(t,e)}}}export{k as SignOutOfAccountAction};
