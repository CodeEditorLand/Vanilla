import{fileURLToPath as p,pathToFileURL as a}from"node:url";import{promises as s}from"node:fs";import{join as c}from"node:path";const m={};async function h(n){const o=p(new URL("../package.json",a(n))),t=JSON.parse(String(await s.readFile(o)));for(const[e]of Object.entries(t.dependencies))try{const i=c(o,`../node_modules/${e}/package.json`);let{main:r}=JSON.parse(String(await s.readFile(i)));r||(r="index.js"),r.endsWith(".js")||(r+=".js");const l=c(o,`../node_modules/${e}/${r}`);m[e]=a(l).href}catch{}}async function j(n,o,t){const e=m[n];return e!==void 0?{format:"commonjs",shortCircuit:!0,url:e}:t(n,o)}export{h as initialize,j as resolve};
