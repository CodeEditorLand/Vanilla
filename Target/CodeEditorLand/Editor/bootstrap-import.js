import{promises as a}from"node:fs";import{join as s}from"node:path";import{fileURLToPath as p,pathToFileURL as c}from"node:url";const m={};async function h(n){const o=p(new URL("../package.json",c(n))),t=JSON.parse(String(await a.readFile(o)));for(const[e]of Object.entries(t.dependencies))try{const i=s(o,`../node_modules/${e}/package.json`);let{main:r}=JSON.parse(String(await a.readFile(i)));r||(r="index.js"),r.endsWith(".js")||(r+=".js");const l=s(o,`../node_modules/${e}/${r}`);m[e]=c(l).href}catch{}}async function j(n,o,t){const e=m[n];return e!==void 0?{format:"commonjs",shortCircuit:!0,url:e}:t(n,o)}export{h as initialize,j as resolve};
