import{fileURLToPath as p,pathToFileURL as s}from"node:url";import{promises as a}from"node:fs";import{join as c}from"node:path";var l={};async function h(o){let r=p(new URL("../package.json",s(o))),t=JSON.parse(String(await a.readFile(r)));for(let[e]of Object.entries(t.dependencies))try{let i=c(r,`../node_modules/${e}/package.json`),{main:n}=JSON.parse(String(await a.readFile(i)));n||(n="index.js"),n.endsWith(".js")||(n+=".js");let m=c(r,`../node_modules/${e}/${n}`);l[e]=s(m).href}catch(i){console.error(e),console.error(i)}console.log(`[bootstrap-import] Initialized node_modules redirector for: ${o}`)}async function j(o,r,t){let e=l[o];return e!==void 0?{format:"commonjs",shortCircuit:!0,url:e}:t(o,r)}export{h as initialize,j as resolve};
