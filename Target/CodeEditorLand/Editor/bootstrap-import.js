import{fileURLToPath as p,pathToFileURL as s}from"node:url";import{promises as a}from"node:fs";import{join as c}from"node:path";const l={};async function h(o){const r=p(new URL("../package.json",s(o))),t=JSON.parse(String(await a.readFile(r)));for(const[e]of Object.entries(t.dependencies))try{const i=c(r,`../node_modules/${e}/package.json`);let{main:n}=JSON.parse(String(await a.readFile(i)));n||(n="index.js"),n.endsWith(".js")||(n+=".js");const m=c(r,`../node_modules/${e}/${n}`);l[e]=s(m).href}catch(i){console.error(e),console.error(i)}console.log(`[bootstrap-import] Initialized node_modules redirector for: ${o}`)}async function j(o,r,t){const e=l[o];return e!==void 0?{format:"commonjs",shortCircuit:!0,url:e}:t(o,r)}export{h as initialize,j as resolve};
