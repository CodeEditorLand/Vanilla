{
  "version": 3,
  "sources": ["../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/platform/userDataSync/common/userDataSyncResourceProvider.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { toFormattedString } from \"../../../base/common/jsonFormatter.js\";\nimport type { IExtUri } from \"../../../base/common/resources.js\";\nimport { trim } from \"../../../base/common/strings.js\";\nimport { URI } from \"../../../base/common/uri.js\";\nimport { localize } from \"../../../nls.js\";\nimport { IConfigurationService } from \"../../configuration/common/configuration.js\";\nimport { IEnvironmentService } from \"../../environment/common/environment.js\";\nimport { getServiceMachineId } from \"../../externalServices/common/serviceMachineId.js\";\nimport { IFileService } from \"../../files/common/files.js\";\nimport { IInstantiationService } from \"../../instantiation/common/instantiation.js\";\nimport { IStorageService } from \"../../storage/common/storage.js\";\nimport { IUriIdentityService } from \"../../uriIdentity/common/uriIdentity.js\";\nimport {\n\ttype IUserDataProfile,\n\tIUserDataProfilesService,\n} from \"../../userDataProfile/common/userDataProfile.js\";\nimport { isSyncData } from \"./abstractSynchronizer.js\";\nimport {\n\tLocalExtensionsProvider,\n\tparseExtensions,\n\tstringify as stringifyExtensions,\n} from \"./extensionsSync.js\";\nimport {\n\tLocalGlobalStateProvider,\n\tstringify as stringifyGlobalState,\n} from \"./globalStateSync.js\";\nimport { getKeybindingsContentFromSyncContent } from \"./keybindingsSync.js\";\nimport { parseSettingsSyncContent } from \"./settingsSync.js\";\nimport { parseSnippets } from \"./snippetsSync.js\";\nimport { getTasksContentFromSyncContent } from \"./tasksSync.js\";\nimport {\n\tparseUserDataProfilesManifest,\n\tstringifyLocalProfiles,\n} from \"./userDataProfilesManifestSync.js\";\nimport {\n\tCONFIG_SYNC_KEYBINDINGS_PER_PLATFORM,\n\ttype ISyncData,\n\ttype ISyncResourceHandle,\n\ttype ISyncUserDataProfile,\n\ttype IUserData,\n\tIUserDataSyncLocalStoreService,\n\tIUserDataSyncLogService,\n\ttype IUserDataSyncResource,\n\ttype IUserDataSyncResourceProviderService,\n\tIUserDataSyncStoreService,\n\tSyncResource,\n\tUSER_DATA_SYNC_SCHEME,\n\tUserDataSyncError,\n\tUserDataSyncErrorCode,\n} from \"./userDataSync.js\";\nimport type {\n\tIMachinesData,\n\tIUserDataSyncMachine,\n} from \"./userDataSyncMachines.js\";\n\ninterface ISyncResourceUriInfo {\n\treadonly remote: boolean;\n\treadonly syncResource: SyncResource;\n\treadonly profile: string;\n\treadonly collection: string | undefined;\n\treadonly ref: string | undefined;\n\treadonly node: string | undefined;\n\treadonly location: URI | undefined;\n}\n\nexport class UserDataSyncResourceProviderService\n\timplements IUserDataSyncResourceProviderService\n{\n\t_serviceBrand: any;\n\n\tprivate static readonly NOT_EXISTING_RESOURCE = \"not-existing-resource\";\n\tprivate static readonly REMOTE_BACKUP_AUTHORITY = \"remote-backup\";\n\tprivate static readonly LOCAL_BACKUP_AUTHORITY = \"local-backup\";\n\n\tprivate readonly extUri: IExtUri;\n\n\tconstructor(\n\t\t@IUserDataSyncStoreService private readonly userDataSyncStoreService: IUserDataSyncStoreService,\n\t\t@IUserDataSyncLocalStoreService private readonly userDataSyncLocalStoreService: IUserDataSyncLocalStoreService,\n\t\t@IUserDataSyncLogService protected readonly logService: IUserDataSyncLogService,\n\t\t@IUriIdentityService uriIdentityService: IUriIdentityService,\n\t\t@IEnvironmentService private readonly environmentService: IEnvironmentService,\n\t\t@IStorageService private readonly storageService: IStorageService,\n\t\t@IFileService private readonly fileService: IFileService,\n\t\t@IUserDataProfilesService private readonly userDataProfilesService: IUserDataProfilesService,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@IInstantiationService private readonly instantiationService: IInstantiationService,\n\t) {\n\t\tthis.extUri = uriIdentityService.extUri;\n\t}\n\n\tasync getRemoteSyncedProfiles(): Promise<ISyncUserDataProfile[]> {\n\t\tconst userData = await this.userDataSyncStoreService.readResource(\n\t\t\tSyncResource.Profiles,\n\t\t\tnull,\n\t\t\tundefined,\n\t\t);\n\t\tif (userData.content) {\n\t\t\tconst syncData = this.parseSyncData(\n\t\t\t\tuserData.content,\n\t\t\t\tSyncResource.Profiles,\n\t\t\t);\n\t\t\treturn parseUserDataProfilesManifest(syncData);\n\t\t}\n\t\treturn [];\n\t}\n\n\tasync getLocalSyncedProfiles(\n\t\tlocation?: URI,\n\t): Promise<ISyncUserDataProfile[]> {\n\t\tconst refs =\n\t\t\tawait this.userDataSyncLocalStoreService.getAllResourceRefs(\n\t\t\t\tSyncResource.Profiles,\n\t\t\t\tundefined,\n\t\t\t\tlocation,\n\t\t\t);\n\t\tif (refs.length) {\n\t\t\tconst content =\n\t\t\t\tawait this.userDataSyncLocalStoreService.resolveResourceContent(\n\t\t\t\t\tSyncResource.Profiles,\n\t\t\t\t\trefs[0].ref,\n\t\t\t\t\tundefined,\n\t\t\t\t\tlocation,\n\t\t\t\t);\n\t\t\tif (content) {\n\t\t\t\tconst syncData = this.parseSyncData(\n\t\t\t\t\tcontent,\n\t\t\t\t\tSyncResource.Profiles,\n\t\t\t\t);\n\t\t\t\treturn parseUserDataProfilesManifest(syncData);\n\t\t\t}\n\t\t}\n\t\treturn [];\n\t}\n\n\tasync getLocalSyncedMachines(\n\t\tlocation?: URI,\n\t): Promise<IUserDataSyncMachine[]> {\n\t\tconst refs =\n\t\t\tawait this.userDataSyncLocalStoreService.getAllResourceRefs(\n\t\t\t\t\"machines\",\n\t\t\t\tundefined,\n\t\t\t\tlocation,\n\t\t\t);\n\t\tif (refs.length) {\n\t\t\tconst content =\n\t\t\t\tawait this.userDataSyncLocalStoreService.resolveResourceContent(\n\t\t\t\t\t\"machines\",\n\t\t\t\t\trefs[0].ref,\n\t\t\t\t\tundefined,\n\t\t\t\t\tlocation,\n\t\t\t\t);\n\t\t\tif (content) {\n\t\t\t\tconst machinesData: IMachinesData = JSON.parse(content);\n\t\t\t\treturn machinesData.machines.map((m) => ({\n\t\t\t\t\t...m,\n\t\t\t\t\tisCurrent: false,\n\t\t\t\t}));\n\t\t\t}\n\t\t}\n\t\treturn [];\n\t}\n\n\tasync getRemoteSyncResourceHandles(\n\t\tsyncResource: SyncResource,\n\t\tprofile?: ISyncUserDataProfile,\n\t): Promise<ISyncResourceHandle[]> {\n\t\tconst handles = await this.userDataSyncStoreService.getAllResourceRefs(\n\t\t\tsyncResource,\n\t\t\tprofile?.collection,\n\t\t);\n\t\treturn handles.map(({ created, ref }) => ({\n\t\t\tcreated,\n\t\t\turi: this.toUri({\n\t\t\t\tremote: true,\n\t\t\t\tsyncResource,\n\t\t\t\tprofile:\n\t\t\t\t\tprofile?.id ??\n\t\t\t\t\tthis.userDataProfilesService.defaultProfile.id,\n\t\t\t\tlocation: undefined,\n\t\t\t\tcollection: profile?.collection,\n\t\t\t\tref,\n\t\t\t\tnode: undefined,\n\t\t\t}),\n\t\t}));\n\t}\n\n\tasync getLocalSyncResourceHandles(\n\t\tsyncResource: SyncResource,\n\t\tprofile?: ISyncUserDataProfile,\n\t\tlocation?: URI,\n\t): Promise<ISyncResourceHandle[]> {\n\t\tconst handles =\n\t\t\tawait this.userDataSyncLocalStoreService.getAllResourceRefs(\n\t\t\t\tsyncResource,\n\t\t\t\tprofile?.collection,\n\t\t\t\tlocation,\n\t\t\t);\n\t\treturn handles.map(({ created, ref }) => ({\n\t\t\tcreated,\n\t\t\turi: this.toUri({\n\t\t\t\tremote: false,\n\t\t\t\tsyncResource,\n\t\t\t\tprofile:\n\t\t\t\t\tprofile?.id ??\n\t\t\t\t\tthis.userDataProfilesService.defaultProfile.id,\n\t\t\t\tcollection: profile?.collection,\n\t\t\t\tref,\n\t\t\t\tnode: undefined,\n\t\t\t\tlocation,\n\t\t\t}),\n\t\t}));\n\t}\n\n\tresolveUserDataSyncResource({\n\t\turi,\n\t}: ISyncResourceHandle): IUserDataSyncResource | undefined {\n\t\tconst resolved = this.resolveUri(uri);\n\t\tconst profile = resolved\n\t\t\t? this.userDataProfilesService.profiles.find(\n\t\t\t\t\t(p) => p.id === resolved.profile,\n\t\t\t\t)\n\t\t\t: undefined;\n\t\treturn resolved && profile\n\t\t\t? { profile, syncResource: resolved?.syncResource }\n\t\t\t: undefined;\n\t}\n\n\tasync getAssociatedResources({\n\t\turi,\n\t}: ISyncResourceHandle): Promise<\n\t\t{ resource: URI; comparableResource: URI }[]\n\t> {\n\t\tconst resolved = this.resolveUri(uri);\n\t\tif (!resolved) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst profile = this.userDataProfilesService.profiles.find(\n\t\t\t(p) => p.id === resolved.profile,\n\t\t);\n\t\tswitch (resolved.syncResource) {\n\t\t\tcase SyncResource.Settings:\n\t\t\t\treturn this.getSettingsAssociatedResources(uri, profile);\n\t\t\tcase SyncResource.Keybindings:\n\t\t\t\treturn this.getKeybindingsAssociatedResources(uri, profile);\n\t\t\tcase SyncResource.Tasks:\n\t\t\t\treturn this.getTasksAssociatedResources(uri, profile);\n\t\t\tcase SyncResource.Snippets:\n\t\t\t\treturn this.getSnippetsAssociatedResources(uri, profile);\n\t\t\tcase SyncResource.GlobalState:\n\t\t\t\treturn this.getGlobalStateAssociatedResources(uri, profile);\n\t\t\tcase SyncResource.Extensions:\n\t\t\t\treturn this.getExtensionsAssociatedResources(uri, profile);\n\t\t\tcase SyncResource.Profiles:\n\t\t\t\treturn this.getProfilesAssociatedResources(uri, profile);\n\t\t\tcase SyncResource.WorkspaceState:\n\t\t\t\treturn [];\n\t\t}\n\t}\n\n\tasync getMachineId({\n\t\turi,\n\t}: ISyncResourceHandle): Promise<string | undefined> {\n\t\tconst resolved = this.resolveUri(uri);\n\t\tif (!resolved) {\n\t\t\treturn undefined;\n\t\t}\n\t\tif (resolved.remote) {\n\t\t\tif (resolved.ref) {\n\t\t\t\tconst { content } = await this.getUserData(\n\t\t\t\t\tresolved.syncResource,\n\t\t\t\t\tresolved.ref,\n\t\t\t\t\tresolved.collection,\n\t\t\t\t);\n\t\t\t\tif (content) {\n\t\t\t\t\tconst syncData = this.parseSyncData(\n\t\t\t\t\t\tcontent,\n\t\t\t\t\t\tresolved.syncResource,\n\t\t\t\t\t);\n\t\t\t\t\treturn syncData?.machineId;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (resolved.location) {\n\t\t\tif (resolved.ref) {\n\t\t\t\tconst content =\n\t\t\t\t\tawait this.userDataSyncLocalStoreService.resolveResourceContent(\n\t\t\t\t\t\tresolved.syncResource,\n\t\t\t\t\t\tresolved.ref,\n\t\t\t\t\t\tresolved.collection,\n\t\t\t\t\t\tresolved.location,\n\t\t\t\t\t);\n\t\t\t\tif (content) {\n\t\t\t\t\tconst syncData = this.parseSyncData(\n\t\t\t\t\t\tcontent,\n\t\t\t\t\t\tresolved.syncResource,\n\t\t\t\t\t);\n\t\t\t\t\treturn syncData?.machineId;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn undefined;\n\t\t}\n\n\t\treturn getServiceMachineId(\n\t\t\tthis.environmentService,\n\t\t\tthis.fileService,\n\t\t\tthis.storageService,\n\t\t);\n\t}\n\n\tasync resolveContent(uri: URI): Promise<string | null> {\n\t\tconst resolved = this.resolveUri(uri);\n\t\tif (!resolved) {\n\t\t\treturn null;\n\t\t}\n\n\t\tif (\n\t\t\tresolved.node ===\n\t\t\tUserDataSyncResourceProviderService.NOT_EXISTING_RESOURCE\n\t\t) {\n\t\t\treturn null;\n\t\t}\n\n\t\tif (resolved.ref) {\n\t\t\tconst content = await this.getContentFromStore(\n\t\t\t\tresolved.remote,\n\t\t\t\tresolved.syncResource,\n\t\t\t\tresolved.collection,\n\t\t\t\tresolved.ref,\n\t\t\t\tresolved.location,\n\t\t\t);\n\t\t\tif (resolved.node && content) {\n\t\t\t\treturn this.resolveNodeContent(\n\t\t\t\t\tresolved.syncResource,\n\t\t\t\t\tcontent,\n\t\t\t\t\tresolved.node,\n\t\t\t\t);\n\t\t\t}\n\t\t\treturn content;\n\t\t}\n\n\t\tif (!resolved.remote && !resolved.node) {\n\t\t\treturn this.resolveLatestContent(\n\t\t\t\tresolved.syncResource,\n\t\t\t\tresolved.profile,\n\t\t\t);\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tprivate async getContentFromStore(\n\t\tremote: boolean,\n\t\tsyncResource: SyncResource,\n\t\tcollection: string | undefined,\n\t\tref: string,\n\t\tlocation?: URI,\n\t): Promise<string | null> {\n\t\tif (remote) {\n\t\t\tconst { content } = await this.getUserData(\n\t\t\t\tsyncResource,\n\t\t\t\tref,\n\t\t\t\tcollection,\n\t\t\t);\n\t\t\treturn content;\n\t\t}\n\t\treturn this.userDataSyncLocalStoreService.resolveResourceContent(\n\t\t\tsyncResource,\n\t\t\tref,\n\t\t\tcollection,\n\t\t\tlocation,\n\t\t);\n\t}\n\n\tprivate resolveNodeContent(\n\t\tsyncResource: SyncResource,\n\t\tcontent: string,\n\t\tnode: string,\n\t): string | null {\n\t\tconst syncData = this.parseSyncData(content, syncResource);\n\t\tswitch (syncResource) {\n\t\t\tcase SyncResource.Settings:\n\t\t\t\treturn this.resolveSettingsNodeContent(syncData, node);\n\t\t\tcase SyncResource.Keybindings:\n\t\t\t\treturn this.resolveKeybindingsNodeContent(syncData, node);\n\t\t\tcase SyncResource.Tasks:\n\t\t\t\treturn this.resolveTasksNodeContent(syncData, node);\n\t\t\tcase SyncResource.Snippets:\n\t\t\t\treturn this.resolveSnippetsNodeContent(syncData, node);\n\t\t\tcase SyncResource.GlobalState:\n\t\t\t\treturn this.resolveGlobalStateNodeContent(syncData, node);\n\t\t\tcase SyncResource.Extensions:\n\t\t\t\treturn this.resolveExtensionsNodeContent(syncData, node);\n\t\t\tcase SyncResource.Profiles:\n\t\t\t\treturn this.resolveProfileNodeContent(syncData, node);\n\t\t\tcase SyncResource.WorkspaceState:\n\t\t\t\treturn null;\n\t\t}\n\t}\n\n\tprivate async resolveLatestContent(\n\t\tsyncResource: SyncResource,\n\t\tprofileId: string,\n\t): Promise<string | null> {\n\t\tconst profile = this.userDataProfilesService.profiles.find(\n\t\t\t(p) => p.id === profileId,\n\t\t);\n\t\tif (!profile) {\n\t\t\treturn null;\n\t\t}\n\t\tswitch (syncResource) {\n\t\t\tcase SyncResource.GlobalState:\n\t\t\t\treturn this.resolveLatestGlobalStateContent(profile);\n\t\t\tcase SyncResource.Extensions:\n\t\t\t\treturn this.resolveLatestExtensionsContent(profile);\n\t\t\tcase SyncResource.Profiles:\n\t\t\t\treturn this.resolveLatestProfilesContent(profile);\n\t\t\tcase SyncResource.Settings:\n\t\t\t\treturn null;\n\t\t\tcase SyncResource.Keybindings:\n\t\t\t\treturn null;\n\t\t\tcase SyncResource.Tasks:\n\t\t\t\treturn null;\n\t\t\tcase SyncResource.Snippets:\n\t\t\t\treturn null;\n\t\t\tcase SyncResource.WorkspaceState:\n\t\t\t\treturn null;\n\t\t}\n\t}\n\n\tprivate getSettingsAssociatedResources(\n\t\turi: URI,\n\t\tprofile: IUserDataProfile | undefined,\n\t): { resource: URI; comparableResource: URI }[] {\n\t\tconst resource = this.extUri.joinPath(uri, \"settings.json\");\n\t\tconst comparableResource = profile\n\t\t\t? profile.settingsResource\n\t\t\t: this.extUri.joinPath(\n\t\t\t\t\turi,\n\t\t\t\t\tUserDataSyncResourceProviderService.NOT_EXISTING_RESOURCE,\n\t\t\t\t);\n\t\treturn [{ resource, comparableResource }];\n\t}\n\n\tprivate resolveSettingsNodeContent(\n\t\tsyncData: ISyncData,\n\t\tnode: string,\n\t): string | null {\n\t\tswitch (node) {\n\t\t\tcase \"settings.json\":\n\t\t\t\treturn parseSettingsSyncContent(syncData.content).settings;\n\t\t}\n\t\treturn null;\n\t}\n\n\tprivate getKeybindingsAssociatedResources(\n\t\turi: URI,\n\t\tprofile: IUserDataProfile | undefined,\n\t): { resource: URI; comparableResource: URI }[] {\n\t\tconst resource = this.extUri.joinPath(uri, \"keybindings.json\");\n\t\tconst comparableResource = profile\n\t\t\t? profile.keybindingsResource\n\t\t\t: this.extUri.joinPath(\n\t\t\t\t\turi,\n\t\t\t\t\tUserDataSyncResourceProviderService.NOT_EXISTING_RESOURCE,\n\t\t\t\t);\n\t\treturn [{ resource, comparableResource }];\n\t}\n\n\tprivate resolveKeybindingsNodeContent(\n\t\tsyncData: ISyncData,\n\t\tnode: string,\n\t): string | null {\n\t\tswitch (node) {\n\t\t\tcase \"keybindings.json\":\n\t\t\t\treturn getKeybindingsContentFromSyncContent(\n\t\t\t\t\tsyncData.content,\n\t\t\t\t\t!!this.configurationService.getValue(\n\t\t\t\t\t\tCONFIG_SYNC_KEYBINDINGS_PER_PLATFORM,\n\t\t\t\t\t),\n\t\t\t\t\tthis.logService,\n\t\t\t\t);\n\t\t}\n\t\treturn null;\n\t}\n\n\tprivate getTasksAssociatedResources(\n\t\turi: URI,\n\t\tprofile: IUserDataProfile | undefined,\n\t): { resource: URI; comparableResource: URI }[] {\n\t\tconst resource = this.extUri.joinPath(uri, \"tasks.json\");\n\t\tconst comparableResource = profile\n\t\t\t? profile.tasksResource\n\t\t\t: this.extUri.joinPath(\n\t\t\t\t\turi,\n\t\t\t\t\tUserDataSyncResourceProviderService.NOT_EXISTING_RESOURCE,\n\t\t\t\t);\n\t\treturn [{ resource, comparableResource }];\n\t}\n\n\tprivate resolveTasksNodeContent(\n\t\tsyncData: ISyncData,\n\t\tnode: string,\n\t): string | null {\n\t\tswitch (node) {\n\t\t\tcase \"tasks.json\":\n\t\t\t\treturn getTasksContentFromSyncContent(\n\t\t\t\t\tsyncData.content,\n\t\t\t\t\tthis.logService,\n\t\t\t\t);\n\t\t}\n\t\treturn null;\n\t}\n\n\tprivate async getSnippetsAssociatedResources(\n\t\turi: URI,\n\t\tprofile: IUserDataProfile | undefined,\n\t): Promise<{ resource: URI; comparableResource: URI }[]> {\n\t\tconst content = await this.resolveContent(uri);\n\t\tif (content) {\n\t\t\tconst syncData = this.parseSyncData(content, SyncResource.Snippets);\n\t\t\tif (syncData) {\n\t\t\t\tconst snippets = parseSnippets(syncData);\n\t\t\t\tconst result = [];\n\t\t\t\tfor (const snippet of Object.keys(snippets)) {\n\t\t\t\t\tconst resource = this.extUri.joinPath(uri, snippet);\n\t\t\t\t\tconst comparableResource = profile\n\t\t\t\t\t\t? this.extUri.joinPath(profile.snippetsHome, snippet)\n\t\t\t\t\t\t: this.extUri.joinPath(\n\t\t\t\t\t\t\t\turi,\n\t\t\t\t\t\t\t\tUserDataSyncResourceProviderService.NOT_EXISTING_RESOURCE,\n\t\t\t\t\t\t\t);\n\t\t\t\t\tresult.push({ resource, comparableResource });\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t}\n\t\t}\n\t\treturn [];\n\t}\n\n\tprivate resolveSnippetsNodeContent(\n\t\tsyncData: ISyncData,\n\t\tnode: string,\n\t): string | null {\n\t\treturn parseSnippets(syncData)[node] || null;\n\t}\n\n\tprivate getExtensionsAssociatedResources(\n\t\turi: URI,\n\t\tprofile: IUserDataProfile | undefined,\n\t): { resource: URI; comparableResource: URI }[] {\n\t\tconst resource = this.extUri.joinPath(uri, \"extensions.json\");\n\t\tconst comparableResource = profile\n\t\t\t? this.toUri({\n\t\t\t\t\tremote: false,\n\t\t\t\t\tsyncResource: SyncResource.Extensions,\n\t\t\t\t\tprofile: profile.id,\n\t\t\t\t\tlocation: undefined,\n\t\t\t\t\tcollection: undefined,\n\t\t\t\t\tref: undefined,\n\t\t\t\t\tnode: undefined,\n\t\t\t\t})\n\t\t\t: this.extUri.joinPath(\n\t\t\t\t\turi,\n\t\t\t\t\tUserDataSyncResourceProviderService.NOT_EXISTING_RESOURCE,\n\t\t\t\t);\n\t\treturn [{ resource, comparableResource }];\n\t}\n\n\tprivate resolveExtensionsNodeContent(\n\t\tsyncData: ISyncData,\n\t\tnode: string,\n\t): string | null {\n\t\tswitch (node) {\n\t\t\tcase \"extensions.json\":\n\t\t\t\treturn stringifyExtensions(parseExtensions(syncData), true);\n\t\t}\n\t\treturn null;\n\t}\n\n\tprivate async resolveLatestExtensionsContent(\n\t\tprofile: IUserDataProfile,\n\t): Promise<string | null> {\n\t\tconst { localExtensions } = await this.instantiationService\n\t\t\t.createInstance(LocalExtensionsProvider)\n\t\t\t.getLocalExtensions(profile);\n\t\treturn stringifyExtensions(localExtensions, true);\n\t}\n\n\tprivate getGlobalStateAssociatedResources(\n\t\turi: URI,\n\t\tprofile: IUserDataProfile | undefined,\n\t): { resource: URI; comparableResource: URI }[] {\n\t\tconst resource = this.extUri.joinPath(uri, \"globalState.json\");\n\t\tconst comparableResource = profile\n\t\t\t? this.toUri({\n\t\t\t\t\tremote: false,\n\t\t\t\t\tsyncResource: SyncResource.GlobalState,\n\t\t\t\t\tprofile: profile.id,\n\t\t\t\t\tlocation: undefined,\n\t\t\t\t\tcollection: undefined,\n\t\t\t\t\tref: undefined,\n\t\t\t\t\tnode: undefined,\n\t\t\t\t})\n\t\t\t: this.extUri.joinPath(\n\t\t\t\t\turi,\n\t\t\t\t\tUserDataSyncResourceProviderService.NOT_EXISTING_RESOURCE,\n\t\t\t\t);\n\t\treturn [{ resource, comparableResource }];\n\t}\n\n\tprivate resolveGlobalStateNodeContent(\n\t\tsyncData: ISyncData,\n\t\tnode: string,\n\t): string | null {\n\t\tswitch (node) {\n\t\t\tcase \"globalState.json\":\n\t\t\t\treturn stringifyGlobalState(JSON.parse(syncData.content), true);\n\t\t}\n\t\treturn null;\n\t}\n\n\tprivate async resolveLatestGlobalStateContent(\n\t\tprofile: IUserDataProfile,\n\t): Promise<string | null> {\n\t\tconst localGlobalState = await this.instantiationService\n\t\t\t.createInstance(LocalGlobalStateProvider)\n\t\t\t.getLocalGlobalState(profile);\n\t\treturn stringifyGlobalState(localGlobalState, true);\n\t}\n\n\tprivate getProfilesAssociatedResources(\n\t\turi: URI,\n\t\tprofile: IUserDataProfile | undefined,\n\t): { resource: URI; comparableResource: URI }[] {\n\t\tconst resource = this.extUri.joinPath(uri, \"profiles.json\");\n\t\tconst comparableResource = this.toUri({\n\t\t\tremote: false,\n\t\t\tsyncResource: SyncResource.Profiles,\n\t\t\tprofile: this.userDataProfilesService.defaultProfile.id,\n\t\t\tlocation: undefined,\n\t\t\tcollection: undefined,\n\t\t\tref: undefined,\n\t\t\tnode: undefined,\n\t\t});\n\t\treturn [{ resource, comparableResource }];\n\t}\n\n\tprivate resolveProfileNodeContent(\n\t\tsyncData: ISyncData,\n\t\tnode: string,\n\t): string | null {\n\t\tswitch (node) {\n\t\t\tcase \"profiles.json\":\n\t\t\t\treturn toFormattedString(JSON.parse(syncData.content), {});\n\t\t}\n\t\treturn null;\n\t}\n\n\tprivate async resolveLatestProfilesContent(\n\t\tprofile: IUserDataProfile,\n\t): Promise<string | null> {\n\t\treturn stringifyLocalProfiles(\n\t\t\tthis.userDataProfilesService.profiles.filter(\n\t\t\t\t(p) => !p.isDefault && !p.isTransient,\n\t\t\t),\n\t\t\ttrue,\n\t\t);\n\t}\n\n\tprivate toUri(syncResourceUriInfo: ISyncResourceUriInfo): URI {\n\t\tconst authority = syncResourceUriInfo.remote\n\t\t\t? UserDataSyncResourceProviderService.REMOTE_BACKUP_AUTHORITY\n\t\t\t: UserDataSyncResourceProviderService.LOCAL_BACKUP_AUTHORITY;\n\t\tconst paths = [];\n\t\tif (syncResourceUriInfo.location) {\n\t\t\tpaths.push(`scheme:${syncResourceUriInfo.location.scheme}`);\n\t\t\tpaths.push(`authority:${syncResourceUriInfo.location.authority}`);\n\t\t\tpaths.push(trim(syncResourceUriInfo.location.path, \"/\"));\n\t\t}\n\t\tpaths.push(`syncResource:${syncResourceUriInfo.syncResource}`);\n\t\tpaths.push(`profile:${syncResourceUriInfo.profile}`);\n\t\tif (syncResourceUriInfo.collection) {\n\t\t\tpaths.push(`collection:${syncResourceUriInfo.collection}`);\n\t\t}\n\t\tif (syncResourceUriInfo.ref) {\n\t\t\tpaths.push(`ref:${syncResourceUriInfo.ref}`);\n\t\t}\n\t\tif (syncResourceUriInfo.node) {\n\t\t\tpaths.push(syncResourceUriInfo.node);\n\t\t}\n\t\treturn this.extUri.joinPath(\n\t\t\tURI.from({\n\t\t\t\tscheme: USER_DATA_SYNC_SCHEME,\n\t\t\t\tauthority,\n\t\t\t\tpath: `/`,\n\t\t\t\tquery: syncResourceUriInfo.location?.query,\n\t\t\t\tfragment: syncResourceUriInfo.location?.fragment,\n\t\t\t}),\n\t\t\t...paths,\n\t\t);\n\t}\n\n\tprivate resolveUri(uri: URI): ISyncResourceUriInfo | undefined {\n\t\tif (uri.scheme !== USER_DATA_SYNC_SCHEME) {\n\t\t\treturn undefined;\n\t\t}\n\t\tconst paths: string[] = [];\n\t\twhile (uri.path !== \"/\") {\n\t\t\tpaths.unshift(this.extUri.basename(uri));\n\t\t\turi = this.extUri.dirname(uri);\n\t\t}\n\t\tif (paths.length < 2) {\n\t\t\treturn undefined;\n\t\t}\n\t\tconst remote =\n\t\t\turi.authority ===\n\t\t\tUserDataSyncResourceProviderService.REMOTE_BACKUP_AUTHORITY;\n\t\tlet scheme: string | undefined;\n\t\tlet authority: string | undefined;\n\t\tconst locationPaths: string[] = [];\n\t\tlet syncResource: SyncResource | undefined;\n\t\tlet profile: string | undefined;\n\t\tlet collection: string | undefined;\n\t\tlet ref: string | undefined;\n\t\tlet node: string | undefined;\n\t\twhile (paths.length) {\n\t\t\tconst path = paths.shift()!;\n\t\t\tif (path.startsWith(\"scheme:\")) {\n\t\t\t\tscheme = path.substring(\"scheme:\".length);\n\t\t\t} else if (path.startsWith(\"authority:\")) {\n\t\t\t\tauthority = path.substring(\"authority:\".length);\n\t\t\t} else if (path.startsWith(\"syncResource:\")) {\n\t\t\t\tsyncResource = path.substring(\n\t\t\t\t\t\"syncResource:\".length,\n\t\t\t\t) as SyncResource;\n\t\t\t} else if (path.startsWith(\"profile:\")) {\n\t\t\t\tprofile = path.substring(\"profile:\".length);\n\t\t\t} else if (path.startsWith(\"collection:\")) {\n\t\t\t\tcollection = path.substring(\"collection:\".length);\n\t\t\t} else if (path.startsWith(\"ref:\")) {\n\t\t\t\tref = path.substring(\"ref:\".length);\n\t\t\t} else if (syncResource) {\n\t\t\t\tnode = path;\n\t\t\t} else {\n\t\t\t\tlocationPaths.push(path);\n\t\t\t}\n\t\t}\n\t\treturn {\n\t\t\tremote,\n\t\t\tsyncResource: syncResource!,\n\t\t\tprofile: profile!,\n\t\t\tcollection,\n\t\t\tref,\n\t\t\tnode,\n\t\t\tlocation:\n\t\t\t\tscheme && authority !== undefined\n\t\t\t\t\t? this.extUri.joinPath(\n\t\t\t\t\t\t\tURI.from({\n\t\t\t\t\t\t\t\tscheme,\n\t\t\t\t\t\t\t\tauthority,\n\t\t\t\t\t\t\t\tquery: uri.query,\n\t\t\t\t\t\t\t\tfragment: uri.fragment,\n\t\t\t\t\t\t\t\tpath: \"/\",\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t...locationPaths,\n\t\t\t\t\t\t)\n\t\t\t\t\t: undefined,\n\t\t};\n\t}\n\n\tprivate parseSyncData(\n\t\tcontent: string,\n\t\tsyncResource: SyncResource,\n\t): ISyncData {\n\t\ttry {\n\t\t\tconst syncData: ISyncData = JSON.parse(content);\n\t\t\tif (isSyncData(syncData)) {\n\t\t\t\treturn syncData;\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tthis.logService.error(error);\n\t\t}\n\t\tthrow new UserDataSyncError(\n\t\t\tlocalize(\n\t\t\t\t\"incompatible sync data\",\n\t\t\t\t\"Cannot parse sync data as it is not compatible with the current version.\",\n\t\t\t),\n\t\t\tUserDataSyncErrorCode.IncompatibleRemoteContent,\n\t\t\tsyncResource,\n\t\t);\n\t}\n\n\tprivate async getUserData(\n\t\tsyncResource: SyncResource,\n\t\tref: string,\n\t\tcollection?: string,\n\t): Promise<IUserData> {\n\t\tconst content =\n\t\t\tawait this.userDataSyncStoreService.resolveResourceContent(\n\t\t\t\tsyncResource,\n\t\t\t\tref,\n\t\t\t\tcollection,\n\t\t\t);\n\t\treturn { ref, content };\n\t}\n}\n"],
  "mappings": ";;;;;;;;;;;;AAKA,SAAS,yBAAyB;AAElC,SAAS,YAAY;AACrB,SAAS,WAAW;AACpB,SAAS,gBAAgB;AACzB,SAAS,6BAA6B;AACtC,SAAS,2BAA2B;AACpC,SAAS,2BAA2B;AACpC,SAAS,oBAAoB;AAC7B,SAAS,6BAA6B;AACtC,SAAS,uBAAuB;AAChC,SAAS,2BAA2B;AACpC;AAAA,EAEC;AAAA,OACM;AACP,SAAS,kBAAkB;AAC3B;AAAA,EACC;AAAA,EACA;AAAA,EACA,aAAa;AAAA,OACP;AACP;AAAA,EACC;AAAA,EACA,aAAa;AAAA,OACP;AACP,SAAS,4CAA4C;AACrD,SAAS,gCAAgC;AACzC,SAAS,qBAAqB;AAC9B,SAAS,sCAAsC;AAC/C;AAAA,EACC;AAAA,EACA;AAAA,OACM;AACP;AAAA,EACC;AAAA,EAKA;AAAA,EACA;AAAA,EAGA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,OACM;AAgBA,IAAM,sCAAN,MAEP;AAAA,EASC,YAC6C,0BACK,+BACL,YACvB,oBACiB,oBACJ,gBACH,aACY,yBACH,sBACA,sBACvC;AAV2C;AACK;AACL;AAEN;AACJ;AACH;AACY;AACH;AACA;AAExC,SAAK,SAAS,mBAAmB;AAAA,EAClC;AAAA,EA9FD,OAwEA;AAAA;AAAA;AAAA,EACC;AAAA,EAEA,OAAwB,wBAAwB;AAAA,EAChD,OAAwB,0BAA0B;AAAA,EAClD,OAAwB,yBAAyB;AAAA,EAEhC;AAAA,EAiBjB,MAAM,0BAA2D;AAChE,UAAM,WAAW,MAAM,KAAK,yBAAyB;AAAA,MACpD,aAAa;AAAA,MACb;AAAA,MACA;AAAA,IACD;AACA,QAAI,SAAS,SAAS;AACrB,YAAM,WAAW,KAAK;AAAA,QACrB,SAAS;AAAA,QACT,aAAa;AAAA,MACd;AACA,aAAO,8BAA8B,QAAQ;AAAA,IAC9C;AACA,WAAO,CAAC;AAAA,EACT;AAAA,EAEA,MAAM,uBACL,UACkC;AAClC,UAAM,OACL,MAAM,KAAK,8BAA8B;AAAA,MACxC,aAAa;AAAA,MACb;AAAA,MACA;AAAA,IACD;AACD,QAAI,KAAK,QAAQ;AAChB,YAAM,UACL,MAAM,KAAK,8BAA8B;AAAA,QACxC,aAAa;AAAA,QACb,KAAK,CAAC,EAAE;AAAA,QACR;AAAA,QACA;AAAA,MACD;AACD,UAAI,SAAS;AACZ,cAAM,WAAW,KAAK;AAAA,UACrB;AAAA,UACA,aAAa;AAAA,QACd;AACA,eAAO,8BAA8B,QAAQ;AAAA,MAC9C;AAAA,IACD;AACA,WAAO,CAAC;AAAA,EACT;AAAA,EAEA,MAAM,uBACL,UACkC;AAClC,UAAM,OACL,MAAM,KAAK,8BAA8B;AAAA,MACxC;AAAA,MACA;AAAA,MACA;AAAA,IACD;AACD,QAAI,KAAK,QAAQ;AAChB,YAAM,UACL,MAAM,KAAK,8BAA8B;AAAA,QACxC;AAAA,QACA,KAAK,CAAC,EAAE;AAAA,QACR;AAAA,QACA;AAAA,MACD;AACD,UAAI,SAAS;AACZ,cAAM,eAA8B,KAAK,MAAM,OAAO;AACtD,eAAO,aAAa,SAAS,IAAI,CAAC,OAAO;AAAA,UACxC,GAAG;AAAA,UACH,WAAW;AAAA,QACZ,EAAE;AAAA,MACH;AAAA,IACD;AACA,WAAO,CAAC;AAAA,EACT;AAAA,EAEA,MAAM,6BACL,cACA,SACiC;AACjC,UAAM,UAAU,MAAM,KAAK,yBAAyB;AAAA,MACnD;AAAA,MACA,SAAS;AAAA,IACV;AACA,WAAO,QAAQ,IAAI,CAAC,EAAE,SAAS,IAAI,OAAO;AAAA,MACzC;AAAA,MACA,KAAK,KAAK,MAAM;AAAA,QACf,QAAQ;AAAA,QACR;AAAA,QACA,SACC,SAAS,MACT,KAAK,wBAAwB,eAAe;AAAA,QAC7C,UAAU;AAAA,QACV,YAAY,SAAS;AAAA,QACrB;AAAA,QACA,MAAM;AAAA,MACP,CAAC;AAAA,IACF,EAAE;AAAA,EACH;AAAA,EAEA,MAAM,4BACL,cACA,SACA,UACiC;AACjC,UAAM,UACL,MAAM,KAAK,8BAA8B;AAAA,MACxC;AAAA,MACA,SAAS;AAAA,MACT;AAAA,IACD;AACD,WAAO,QAAQ,IAAI,CAAC,EAAE,SAAS,IAAI,OAAO;AAAA,MACzC;AAAA,MACA,KAAK,KAAK,MAAM;AAAA,QACf,QAAQ;AAAA,QACR;AAAA,QACA,SACC,SAAS,MACT,KAAK,wBAAwB,eAAe;AAAA,QAC7C,YAAY,SAAS;AAAA,QACrB;AAAA,QACA,MAAM;AAAA,QACN;AAAA,MACD,CAAC;AAAA,IACF,EAAE;AAAA,EACH;AAAA,EAEA,4BAA4B;AAAA,IAC3B;AAAA,EACD,GAA2D;AAC1D,UAAM,WAAW,KAAK,WAAW,GAAG;AACpC,UAAM,UAAU,WACb,KAAK,wBAAwB,SAAS;AAAA,MACtC,CAAC,MAAM,EAAE,OAAO,SAAS;AAAA,IAC1B,IACC;AACH,WAAO,YAAY,UAChB,EAAE,SAAS,cAAc,UAAU,aAAa,IAChD;AAAA,EACJ;AAAA,EAEA,MAAM,uBAAuB;AAAA,IAC5B;AAAA,EACD,GAEE;AACD,UAAM,WAAW,KAAK,WAAW,GAAG;AACpC,QAAI,CAAC,UAAU;AACd,aAAO,CAAC;AAAA,IACT;AAEA,UAAM,UAAU,KAAK,wBAAwB,SAAS;AAAA,MACrD,CAAC,MAAM,EAAE,OAAO,SAAS;AAAA,IAC1B;AACA,YAAQ,SAAS,cAAc;AAAA,MAC9B,KAAK,aAAa;AACjB,eAAO,KAAK,+BAA+B,KAAK,OAAO;AAAA,MACxD,KAAK,aAAa;AACjB,eAAO,KAAK,kCAAkC,KAAK,OAAO;AAAA,MAC3D,KAAK,aAAa;AACjB,eAAO,KAAK,4BAA4B,KAAK,OAAO;AAAA,MACrD,KAAK,aAAa;AACjB,eAAO,KAAK,+BAA+B,KAAK,OAAO;AAAA,MACxD,KAAK,aAAa;AACjB,eAAO,KAAK,kCAAkC,KAAK,OAAO;AAAA,MAC3D,KAAK,aAAa;AACjB,eAAO,KAAK,iCAAiC,KAAK,OAAO;AAAA,MAC1D,KAAK,aAAa;AACjB,eAAO,KAAK,+BAA+B,KAAK,OAAO;AAAA,MACxD,KAAK,aAAa;AACjB,eAAO,CAAC;AAAA,IACV;AAAA,EACD;AAAA,EAEA,MAAM,aAAa;AAAA,IAClB;AAAA,EACD,GAAqD;AACpD,UAAM,WAAW,KAAK,WAAW,GAAG;AACpC,QAAI,CAAC,UAAU;AACd,aAAO;AAAA,IACR;AACA,QAAI,SAAS,QAAQ;AACpB,UAAI,SAAS,KAAK;AACjB,cAAM,EAAE,QAAQ,IAAI,MAAM,KAAK;AAAA,UAC9B,SAAS;AAAA,UACT,SAAS;AAAA,UACT,SAAS;AAAA,QACV;AACA,YAAI,SAAS;AACZ,gBAAM,WAAW,KAAK;AAAA,YACrB;AAAA,YACA,SAAS;AAAA,UACV;AACA,iBAAO,UAAU;AAAA,QAClB;AAAA,MACD;AACA,aAAO;AAAA,IACR;AAEA,QAAI,SAAS,UAAU;AACtB,UAAI,SAAS,KAAK;AACjB,cAAM,UACL,MAAM,KAAK,8BAA8B;AAAA,UACxC,SAAS;AAAA,UACT,SAAS;AAAA,UACT,SAAS;AAAA,UACT,SAAS;AAAA,QACV;AACD,YAAI,SAAS;AACZ,gBAAM,WAAW,KAAK;AAAA,YACrB;AAAA,YACA,SAAS;AAAA,UACV;AACA,iBAAO,UAAU;AAAA,QAClB;AAAA,MACD;AACA,aAAO;AAAA,IACR;AAEA,WAAO;AAAA,MACN,KAAK;AAAA,MACL,KAAK;AAAA,MACL,KAAK;AAAA,IACN;AAAA,EACD;AAAA,EAEA,MAAM,eAAe,KAAkC;AACtD,UAAM,WAAW,KAAK,WAAW,GAAG;AACpC,QAAI,CAAC,UAAU;AACd,aAAO;AAAA,IACR;AAEA,QACC,SAAS,SACT,oCAAoC,uBACnC;AACD,aAAO;AAAA,IACR;AAEA,QAAI,SAAS,KAAK;AACjB,YAAM,UAAU,MAAM,KAAK;AAAA,QAC1B,SAAS;AAAA,QACT,SAAS;AAAA,QACT,SAAS;AAAA,QACT,SAAS;AAAA,QACT,SAAS;AAAA,MACV;AACA,UAAI,SAAS,QAAQ,SAAS;AAC7B,eAAO,KAAK;AAAA,UACX,SAAS;AAAA,UACT;AAAA,UACA,SAAS;AAAA,QACV;AAAA,MACD;AACA,aAAO;AAAA,IACR;AAEA,QAAI,CAAC,SAAS,UAAU,CAAC,SAAS,MAAM;AACvC,aAAO,KAAK;AAAA,QACX,SAAS;AAAA,QACT,SAAS;AAAA,MACV;AAAA,IACD;AAEA,WAAO;AAAA,EACR;AAAA,EAEA,MAAc,oBACb,QACA,cACA,YACA,KACA,UACyB;AACzB,QAAI,QAAQ;AACX,YAAM,EAAE,QAAQ,IAAI,MAAM,KAAK;AAAA,QAC9B;AAAA,QACA;AAAA,QACA;AAAA,MACD;AACA,aAAO;AAAA,IACR;AACA,WAAO,KAAK,8BAA8B;AAAA,MACzC;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA,EAEQ,mBACP,cACA,SACA,MACgB;AAChB,UAAM,WAAW,KAAK,cAAc,SAAS,YAAY;AACzD,YAAQ,cAAc;AAAA,MACrB,KAAK,aAAa;AACjB,eAAO,KAAK,2BAA2B,UAAU,IAAI;AAAA,MACtD,KAAK,aAAa;AACjB,eAAO,KAAK,8BAA8B,UAAU,IAAI;AAAA,MACzD,KAAK,aAAa;AACjB,eAAO,KAAK,wBAAwB,UAAU,IAAI;AAAA,MACnD,KAAK,aAAa;AACjB,eAAO,KAAK,2BAA2B,UAAU,IAAI;AAAA,MACtD,KAAK,aAAa;AACjB,eAAO,KAAK,8BAA8B,UAAU,IAAI;AAAA,MACzD,KAAK,aAAa;AACjB,eAAO,KAAK,6BAA6B,UAAU,IAAI;AAAA,MACxD,KAAK,aAAa;AACjB,eAAO,KAAK,0BAA0B,UAAU,IAAI;AAAA,MACrD,KAAK,aAAa;AACjB,eAAO;AAAA,IACT;AAAA,EACD;AAAA,EAEA,MAAc,qBACb,cACA,WACyB;AACzB,UAAM,UAAU,KAAK,wBAAwB,SAAS;AAAA,MACrD,CAAC,MAAM,EAAE,OAAO;AAAA,IACjB;AACA,QAAI,CAAC,SAAS;AACb,aAAO;AAAA,IACR;AACA,YAAQ,cAAc;AAAA,MACrB,KAAK,aAAa;AACjB,eAAO,KAAK,gCAAgC,OAAO;AAAA,MACpD,KAAK,aAAa;AACjB,eAAO,KAAK,+BAA+B,OAAO;AAAA,MACnD,KAAK,aAAa;AACjB,eAAO,KAAK,6BAA6B,OAAO;AAAA,MACjD,KAAK,aAAa;AACjB,eAAO;AAAA,MACR,KAAK,aAAa;AACjB,eAAO;AAAA,MACR,KAAK,aAAa;AACjB,eAAO;AAAA,MACR,KAAK,aAAa;AACjB,eAAO;AAAA,MACR,KAAK,aAAa;AACjB,eAAO;AAAA,IACT;AAAA,EACD;AAAA,EAEQ,+BACP,KACA,SAC+C;AAC/C,UAAM,WAAW,KAAK,OAAO,SAAS,KAAK,eAAe;AAC1D,UAAM,qBAAqB,UACxB,QAAQ,mBACR,KAAK,OAAO;AAAA,MACZ;AAAA,MACA,oCAAoC;AAAA,IACrC;AACF,WAAO,CAAC,EAAE,UAAU,mBAAmB,CAAC;AAAA,EACzC;AAAA,EAEQ,2BACP,UACA,MACgB;AAChB,YAAQ,MAAM;AAAA,MACb,KAAK;AACJ,eAAO,yBAAyB,SAAS,OAAO,EAAE;AAAA,IACpD;AACA,WAAO;AAAA,EACR;AAAA,EAEQ,kCACP,KACA,SAC+C;AAC/C,UAAM,WAAW,KAAK,OAAO,SAAS,KAAK,kBAAkB;AAC7D,UAAM,qBAAqB,UACxB,QAAQ,sBACR,KAAK,OAAO;AAAA,MACZ;AAAA,MACA,oCAAoC;AAAA,IACrC;AACF,WAAO,CAAC,EAAE,UAAU,mBAAmB,CAAC;AAAA,EACzC;AAAA,EAEQ,8BACP,UACA,MACgB;AAChB,YAAQ,MAAM;AAAA,MACb,KAAK;AACJ,eAAO;AAAA,UACN,SAAS;AAAA,UACT,CAAC,CAAC,KAAK,qBAAqB;AAAA,YAC3B;AAAA,UACD;AAAA,UACA,KAAK;AAAA,QACN;AAAA,IACF;AACA,WAAO;AAAA,EACR;AAAA,EAEQ,4BACP,KACA,SAC+C;AAC/C,UAAM,WAAW,KAAK,OAAO,SAAS,KAAK,YAAY;AACvD,UAAM,qBAAqB,UACxB,QAAQ,gBACR,KAAK,OAAO;AAAA,MACZ;AAAA,MACA,oCAAoC;AAAA,IACrC;AACF,WAAO,CAAC,EAAE,UAAU,mBAAmB,CAAC;AAAA,EACzC;AAAA,EAEQ,wBACP,UACA,MACgB;AAChB,YAAQ,MAAM;AAAA,MACb,KAAK;AACJ,eAAO;AAAA,UACN,SAAS;AAAA,UACT,KAAK;AAAA,QACN;AAAA,IACF;AACA,WAAO;AAAA,EACR;AAAA,EAEA,MAAc,+BACb,KACA,SACwD;AACxD,UAAM,UAAU,MAAM,KAAK,eAAe,GAAG;AAC7C,QAAI,SAAS;AACZ,YAAM,WAAW,KAAK,cAAc,SAAS,aAAa,QAAQ;AAClE,UAAI,UAAU;AACb,cAAM,WAAW,cAAc,QAAQ;AACvC,cAAM,SAAS,CAAC;AAChB,mBAAW,WAAW,OAAO,KAAK,QAAQ,GAAG;AAC5C,gBAAM,WAAW,KAAK,OAAO,SAAS,KAAK,OAAO;AAClD,gBAAM,qBAAqB,UACxB,KAAK,OAAO,SAAS,QAAQ,cAAc,OAAO,IAClD,KAAK,OAAO;AAAA,YACZ;AAAA,YACA,oCAAoC;AAAA,UACrC;AACF,iBAAO,KAAK,EAAE,UAAU,mBAAmB,CAAC;AAAA,QAC7C;AACA,eAAO;AAAA,MACR;AAAA,IACD;AACA,WAAO,CAAC;AAAA,EACT;AAAA,EAEQ,2BACP,UACA,MACgB;AAChB,WAAO,cAAc,QAAQ,EAAE,IAAI,KAAK;AAAA,EACzC;AAAA,EAEQ,iCACP,KACA,SAC+C;AAC/C,UAAM,WAAW,KAAK,OAAO,SAAS,KAAK,iBAAiB;AAC5D,UAAM,qBAAqB,UACxB,KAAK,MAAM;AAAA,MACX,QAAQ;AAAA,MACR,cAAc,aAAa;AAAA,MAC3B,SAAS,QAAQ;AAAA,MACjB,UAAU;AAAA,MACV,YAAY;AAAA,MACZ,KAAK;AAAA,MACL,MAAM;AAAA,IACP,CAAC,IACA,KAAK,OAAO;AAAA,MACZ;AAAA,MACA,oCAAoC;AAAA,IACrC;AACF,WAAO,CAAC,EAAE,UAAU,mBAAmB,CAAC;AAAA,EACzC;AAAA,EAEQ,6BACP,UACA,MACgB;AAChB,YAAQ,MAAM;AAAA,MACb,KAAK;AACJ,eAAO,oBAAoB,gBAAgB,QAAQ,GAAG,IAAI;AAAA,IAC5D;AACA,WAAO;AAAA,EACR;AAAA,EAEA,MAAc,+BACb,SACyB;AACzB,UAAM,EAAE,gBAAgB,IAAI,MAAM,KAAK,qBACrC,eAAe,uBAAuB,EACtC,mBAAmB,OAAO;AAC5B,WAAO,oBAAoB,iBAAiB,IAAI;AAAA,EACjD;AAAA,EAEQ,kCACP,KACA,SAC+C;AAC/C,UAAM,WAAW,KAAK,OAAO,SAAS,KAAK,kBAAkB;AAC7D,UAAM,qBAAqB,UACxB,KAAK,MAAM;AAAA,MACX,QAAQ;AAAA,MACR,cAAc,aAAa;AAAA,MAC3B,SAAS,QAAQ;AAAA,MACjB,UAAU;AAAA,MACV,YAAY;AAAA,MACZ,KAAK;AAAA,MACL,MAAM;AAAA,IACP,CAAC,IACA,KAAK,OAAO;AAAA,MACZ;AAAA,MACA,oCAAoC;AAAA,IACrC;AACF,WAAO,CAAC,EAAE,UAAU,mBAAmB,CAAC;AAAA,EACzC;AAAA,EAEQ,8BACP,UACA,MACgB;AAChB,YAAQ,MAAM;AAAA,MACb,KAAK;AACJ,eAAO,qBAAqB,KAAK,MAAM,SAAS,OAAO,GAAG,IAAI;AAAA,IAChE;AACA,WAAO;AAAA,EACR;AAAA,EAEA,MAAc,gCACb,SACyB;AACzB,UAAM,mBAAmB,MAAM,KAAK,qBAClC,eAAe,wBAAwB,EACvC,oBAAoB,OAAO;AAC7B,WAAO,qBAAqB,kBAAkB,IAAI;AAAA,EACnD;AAAA,EAEQ,+BACP,KACA,SAC+C;AAC/C,UAAM,WAAW,KAAK,OAAO,SAAS,KAAK,eAAe;AAC1D,UAAM,qBAAqB,KAAK,MAAM;AAAA,MACrC,QAAQ;AAAA,MACR,cAAc,aAAa;AAAA,MAC3B,SAAS,KAAK,wBAAwB,eAAe;AAAA,MACrD,UAAU;AAAA,MACV,YAAY;AAAA,MACZ,KAAK;AAAA,MACL,MAAM;AAAA,IACP,CAAC;AACD,WAAO,CAAC,EAAE,UAAU,mBAAmB,CAAC;AAAA,EACzC;AAAA,EAEQ,0BACP,UACA,MACgB;AAChB,YAAQ,MAAM;AAAA,MACb,KAAK;AACJ,eAAO,kBAAkB,KAAK,MAAM,SAAS,OAAO,GAAG,CAAC,CAAC;AAAA,IAC3D;AACA,WAAO;AAAA,EACR;AAAA,EAEA,MAAc,6BACb,SACyB;AACzB,WAAO;AAAA,MACN,KAAK,wBAAwB,SAAS;AAAA,QACrC,CAAC,MAAM,CAAC,EAAE,aAAa,CAAC,EAAE;AAAA,MAC3B;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA,EAEQ,MAAM,qBAAgD;AAC7D,UAAM,YAAY,oBAAoB,SACnC,oCAAoC,0BACpC,oCAAoC;AACvC,UAAM,QAAQ,CAAC;AACf,QAAI,oBAAoB,UAAU;AACjC,YAAM,KAAK,UAAU,oBAAoB,SAAS,MAAM,EAAE;AAC1D,YAAM,KAAK,aAAa,oBAAoB,SAAS,SAAS,EAAE;AAChE,YAAM,KAAK,KAAK,oBAAoB,SAAS,MAAM,GAAG,CAAC;AAAA,IACxD;AACA,UAAM,KAAK,gBAAgB,oBAAoB,YAAY,EAAE;AAC7D,UAAM,KAAK,WAAW,oBAAoB,OAAO,EAAE;AACnD,QAAI,oBAAoB,YAAY;AACnC,YAAM,KAAK,cAAc,oBAAoB,UAAU,EAAE;AAAA,IAC1D;AACA,QAAI,oBAAoB,KAAK;AAC5B,YAAM,KAAK,OAAO,oBAAoB,GAAG,EAAE;AAAA,IAC5C;AACA,QAAI,oBAAoB,MAAM;AAC7B,YAAM,KAAK,oBAAoB,IAAI;AAAA,IACpC;AACA,WAAO,KAAK,OAAO;AAAA,MAClB,IAAI,KAAK;AAAA,QACR,QAAQ;AAAA,QACR;AAAA,QACA,MAAM;AAAA,QACN,OAAO,oBAAoB,UAAU;AAAA,QACrC,UAAU,oBAAoB,UAAU;AAAA,MACzC,CAAC;AAAA,MACD,GAAG;AAAA,IACJ;AAAA,EACD;AAAA,EAEQ,WAAW,KAA4C;AAC9D,QAAI,IAAI,WAAW,uBAAuB;AACzC,aAAO;AAAA,IACR;AACA,UAAM,QAAkB,CAAC;AACzB,WAAO,IAAI,SAAS,KAAK;AACxB,YAAM,QAAQ,KAAK,OAAO,SAAS,GAAG,CAAC;AACvC,YAAM,KAAK,OAAO,QAAQ,GAAG;AAAA,IAC9B;AACA,QAAI,MAAM,SAAS,GAAG;AACrB,aAAO;AAAA,IACR;AACA,UAAM,SACL,IAAI,cACJ,oCAAoC;AACrC,QAAI;AACJ,QAAI;AACJ,UAAM,gBAA0B,CAAC;AACjC,QAAI;AACJ,QAAI;AACJ,QAAI;AACJ,QAAI;AACJ,QAAI;AACJ,WAAO,MAAM,QAAQ;AACpB,YAAM,OAAO,MAAM,MAAM;AACzB,UAAI,KAAK,WAAW,SAAS,GAAG;AAC/B,iBAAS,KAAK,UAAU,UAAU,MAAM;AAAA,MACzC,WAAW,KAAK,WAAW,YAAY,GAAG;AACzC,oBAAY,KAAK,UAAU,aAAa,MAAM;AAAA,MAC/C,WAAW,KAAK,WAAW,eAAe,GAAG;AAC5C,uBAAe,KAAK;AAAA,UACnB,gBAAgB;AAAA,QACjB;AAAA,MACD,WAAW,KAAK,WAAW,UAAU,GAAG;AACvC,kBAAU,KAAK,UAAU,WAAW,MAAM;AAAA,MAC3C,WAAW,KAAK,WAAW,aAAa,GAAG;AAC1C,qBAAa,KAAK,UAAU,cAAc,MAAM;AAAA,MACjD,WAAW,KAAK,WAAW,MAAM,GAAG;AACnC,cAAM,KAAK,UAAU,OAAO,MAAM;AAAA,MACnC,WAAW,cAAc;AACxB,eAAO;AAAA,MACR,OAAO;AACN,sBAAc,KAAK,IAAI;AAAA,MACxB;AAAA,IACD;AACA,WAAO;AAAA,MACN;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA,UACC,UAAU,cAAc,SACrB,KAAK,OAAO;AAAA,QACZ,IAAI,KAAK;AAAA,UACR;AAAA,UACA;AAAA,UACA,OAAO,IAAI;AAAA,UACX,UAAU,IAAI;AAAA,UACd,MAAM;AAAA,QACP,CAAC;AAAA,QACD,GAAG;AAAA,MACJ,IACC;AAAA,IACL;AAAA,EACD;AAAA,EAEQ,cACP,SACA,cACY;AACZ,QAAI;AACH,YAAM,WAAsB,KAAK,MAAM,OAAO;AAC9C,UAAI,WAAW,QAAQ,GAAG;AACzB,eAAO;AAAA,MACR;AAAA,IACD,SAAS,OAAO;AACf,WAAK,WAAW,MAAM,KAAK;AAAA,IAC5B;AACA,UAAM,IAAI;AAAA,MACT;AAAA,QACC;AAAA,QACA;AAAA,MACD;AAAA,MACA,sBAAsB;AAAA,MACtB;AAAA,IACD;AAAA,EACD;AAAA,EAEA,MAAc,YACb,cACA,KACA,YACqB;AACrB,UAAM,UACL,MAAM,KAAK,yBAAyB;AAAA,MACnC;AAAA,MACA;AAAA,MACA;AAAA,IACD;AACD,WAAO,EAAE,KAAK,QAAQ;AAAA,EACvB;AACD;AAxuBa,sCAAN;AAAA,EAYJ;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,GArBU;",
  "names": []
}
