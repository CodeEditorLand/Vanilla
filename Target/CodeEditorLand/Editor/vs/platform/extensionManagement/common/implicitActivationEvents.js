import{onUnexpectedError as c}from"../../../../vs/base/common/errors.js";import{ExtensionIdentifier as o}from"../../../../vs/platform/extensions/common/extensions.js";class v{_generators=new Map;_cache=new WeakMap;register(t,i){this._generators.set(t,i)}readActivationEvents(t){return this._cache.has(t)||this._cache.set(t,this._readActivationEvents(t)),this._cache.get(t)}createActivationEventsMap(t){const i=Object.create(null);for(const n of t){const e=this.readActivationEvents(n);e.length>0&&(i[o.toKey(n.identifier)]=e)}return i}_readActivationEvents(t){if(typeof t.main>"u"&&typeof t.browser>"u")return[];const i=Array.isArray(t.activationEvents)?t.activationEvents.slice(0):[];for(let n=0;n<i.length;n++)i[n]==="onUri"&&(i[n]=`onUri:${o.toKey(t.identifier)}`);if(!t.contributes)return i;for(const n in t.contributes){const e=this._generators.get(n);if(!e)continue;const r=t.contributes[n],s=Array.isArray(r)?r:[r];try{e(s,i)}catch(a){c(a)}}return i}}const l=new v;export{l as ImplicitActivationEvents,v as ImplicitActivationEventsImpl};
