import{parse as i}from"url";import{isBoolean as c}from"../../../base/common/types.js";function u(o,t){return o.protocol==="http:"?t.HTTP_PROXY||t.http_proxy||null:o.protocol==="https:"&&(t.HTTPS_PROXY||t.https_proxy||t.HTTP_PROXY||t.http_proxy)||null}async function f(o,t,p={}){const s=i(o),e=p.proxyUrl||u(s,t);if(!e)return null;const r=i(e);if(!/^https?:$/.test(r.protocol||""))return null;const l={host:r.hostname||"",port:(r.port?+r.port:0)||(r.protocol==="https"?443:80),auth:r.auth,rejectUnauthorized:c(p.strictSSL)?p.strictSSL:!0};if(s.protocol==="http:"){const{default:n}=await import("http-proxy-agent");return new n.HttpProxyAgent(e,l)}else{const{default:n}=await import("https-proxy-agent");return new n.HttpsProxyAgent(e,l)}}export{f as getProxyAgent};
