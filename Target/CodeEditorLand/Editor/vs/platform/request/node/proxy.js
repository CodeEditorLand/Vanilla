import{parse as i}from"url";import{isBoolean as c}from"../../../../vs/base/common/types.js";function u(o,t){return o.protocol==="http:"?t.HTTP_PROXY||t.http_proxy||null:o.protocol==="https:"&&(t.HTTPS_PROXY||t.https_proxy||t.HTTP_PROXY||t.http_proxy)||null}async function h(o,t,e={}){const s=i(o),p=e.proxyUrl||u(s,t);if(!p)return null;const r=i(p);if(!/^https?:$/.test(r.protocol||""))return null;const l={host:r.hostname||"",port:(r.port?+r.port:0)||(r.protocol==="https"?443:80),auth:r.auth,rejectUnauthorized:c(e.strictSSL)?e.strictSSL:!0};if(s.protocol==="http:"){const n=await import("http-proxy-agent");return new n.HttpProxyAgent(p,l)}else{const n=await import("https-proxy-agent");return new n.HttpsProxyAgent(p,l)}}export{h as getProxyAgent};
