{
  "version": 3,
  "sources": ["../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/platform/remote/node/nodeSocketFactory.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as net from 'net';\nimport { ISocket } from '../../../base/parts/ipc/common/ipc.net.js';\nimport { NodeSocket } from '../../../base/parts/ipc/node/ipc.net.js';\nimport { makeRawSocketHeaders } from '../common/managedSocket.js';\nimport { RemoteConnectionType, WebSocketRemoteConnection } from '../common/remoteAuthorityResolver.js';\nimport { ISocketFactory } from '../common/remoteSocketFactoryService.js';\n\nexport const nodeSocketFactory = new class implements ISocketFactory<RemoteConnectionType.WebSocket> {\n\n\tsupports(connectTo: WebSocketRemoteConnection): boolean {\n\t\treturn true;\n\t}\n\n\tconnect({ host, port }: WebSocketRemoteConnection, path: string, query: string, debugLabel: string): Promise<ISocket> {\n\t\treturn new Promise<ISocket>((resolve, reject) => {\n\t\t\tconst socket = net.createConnection({ host: host, port: port }, () => {\n\t\t\t\tsocket.removeListener('error', reject);\n\n\t\t\t\tsocket.write(makeRawSocketHeaders(path, query, debugLabel));\n\n\t\t\t\tconst onData = (data: Buffer) => {\n\t\t\t\t\tconst strData = data.toString();\n\t\t\t\t\tif (strData.indexOf('\\r\\n\\r\\n') >= 0) {\n\t\t\t\t\t\t// headers received OK\n\t\t\t\t\t\tsocket.off('data', onData);\n\t\t\t\t\t\tresolve(new NodeSocket(socket, debugLabel));\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tsocket.on('data', onData);\n\t\t\t});\n\t\t\t// Disable Nagle's algorithm.\n\t\t\tsocket.setNoDelay(true);\n\t\t\tsocket.once('error', reject);\n\t\t});\n\t}\n};\n"],
  "mappings": ";;AAKA,YAAY,SAAS;AACrB,SAAS,eAAe;AACxB,SAAS,kBAAkB;AAC3B,SAAS,4BAA4B;AACrC,SAAS,sBAAsB,iCAAiC;AAChE,SAAS,sBAAsB;AAExB,MAAM,oBAAoB,IAAI,MAAgE;AAAA,EAEpG,SAAS,WAA+C;AACvD,WAAO;AAAA,EACR;AAAA,EAEA,QAAQ,EAAE,MAAM,KAAK,GAA8B,MAAc,OAAe,YAAsC;AACrH,WAAO,IAAI,QAAiB,CAAC,SAAS,WAAW;AAChD,YAAM,SAAS,IAAI,iBAAiB,EAAE,MAAY,KAAW,GAAG,MAAM;AACrE,eAAO,eAAe,SAAS,MAAM;AAErC,eAAO,MAAM,qBAAqB,MAAM,OAAO,UAAU,CAAC;AAE1D,cAAM,SAAS,wBAAC,SAAiB;AAChC,gBAAM,UAAU,KAAK,SAAS;AAC9B,cAAI,QAAQ,QAAQ,UAAU,KAAK,GAAG;AAErC,mBAAO,IAAI,QAAQ,MAAM;AACzB,oBAAQ,IAAI,WAAW,QAAQ,UAAU,CAAC;AAAA,UAC3C;AAAA,QACD,GAPe;AAQf,eAAO,GAAG,QAAQ,MAAM;AAAA,MACzB,CAAC;AAED,aAAO,WAAW,IAAI;AACtB,aAAO,KAAK,SAAS,MAAM;AAAA,IAC5B,CAAC;AAAA,EACF;AACD;",
  "names": []
}
