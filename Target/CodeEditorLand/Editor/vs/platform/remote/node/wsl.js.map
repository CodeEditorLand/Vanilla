{
  "version": 3,
  "sources": ["../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/platform/remote/node/wsl.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as fs from 'fs';\nimport * as os from 'os';\nimport * as cp from 'child_process';\nimport * as path from 'path';\n\nlet hasWSLFeaturePromise: Promise<boolean> | undefined;\n\nexport async function hasWSLFeatureInstalled(refresh = false): Promise<boolean> {\n\tif (hasWSLFeaturePromise === undefined || refresh) {\n\t\thasWSLFeaturePromise = testWSLFeatureInstalled();\n\t}\n\treturn hasWSLFeaturePromise;\n}\n\nasync function testWSLFeatureInstalled(): Promise<boolean> {\n\tconst windowsBuildNumber = getWindowsBuildNumber();\n\tif (windowsBuildNumber === undefined) {\n\t\treturn false;\n\t}\n\tif (windowsBuildNumber >= 22000) {\n\t\tconst wslExePath = getWSLExecutablePath();\n\t\tif (wslExePath) {\n\t\t\treturn new Promise<boolean>(s => {\n\t\t\t\ttry {\n\t\t\t\t\tcp.execFile(wslExePath, ['--status'], err => s(!err));\n\t\t\t\t} catch (e) {\n\t\t\t\t\ts(false);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t} else {\n\t\tconst dllPath = getLxssManagerDllPath();\n\t\tif (dllPath) {\n\t\t\ttry {\n\t\t\t\tif ((await fs.promises.stat(dllPath)).isFile()) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t}\n\t\t}\n\t}\n\treturn false;\n}\n\nfunction getWindowsBuildNumber(): number | undefined {\n\tconst osVersion = (/(\\d+)\\.(\\d+)\\.(\\d+)/g).exec(os.release());\n\tif (osVersion) {\n\t\treturn parseInt(osVersion[3]);\n\t}\n\treturn undefined;\n}\n\nfunction getSystem32Path(subPath: string): string | undefined {\n\tconst systemRoot = process.env['SystemRoot'];\n\tif (systemRoot) {\n\t\tconst is32ProcessOn64Windows = process.env.hasOwnProperty('PROCESSOR_ARCHITEW6432');\n\t\treturn path.join(systemRoot, is32ProcessOn64Windows ? 'Sysnative' : 'System32', subPath);\n\t}\n\treturn undefined;\n}\n\nfunction getWSLExecutablePath(): string | undefined {\n\treturn getSystem32Path('wsl.exe');\n}\n\n/**\n * In builds < 22000 this dll inidcates that WSL is installed\n */\nfunction getLxssManagerDllPath(): string | undefined {\n\treturn getSystem32Path('lxss\\\\LxssManager.dll');\n}\n"],
  "mappings": ";;AAKA,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,YAAY,UAAU;AAEtB,IAAI;AAEJ,eAAsB,uBAAuB,UAAU,OAAyB;AAC/E,MAAI,yBAAyB,UAAa,SAAS;AAClD,2BAAuB,wBAAwB;AAAA,EAChD;AACA,SAAO;AACR;AALsB;AAOtB,eAAe,0BAA4C;AAC1D,QAAM,qBAAqB,sBAAsB;AACjD,MAAI,uBAAuB,QAAW;AACrC,WAAO;AAAA,EACR;AACA,MAAI,sBAAsB,MAAO;AAChC,UAAM,aAAa,qBAAqB;AACxC,QAAI,YAAY;AACf,aAAO,IAAI,QAAiB,OAAK;AAChC,YAAI;AACH,aAAG,SAAS,YAAY,CAAC,UAAU,GAAG,SAAO,EAAE,CAAC,GAAG,CAAC;AAAA,QACrD,SAAS,GAAG;AACX,YAAE,KAAK;AAAA,QACR;AAAA,MACD,CAAC;AAAA,IACF;AAAA,EACD,OAAO;AACN,UAAM,UAAU,sBAAsB;AACtC,QAAI,SAAS;AACZ,UAAI;AACH,aAAK,MAAM,GAAG,SAAS,KAAK,OAAO,GAAG,OAAO,GAAG;AAC/C,iBAAO;AAAA,QACR;AAAA,MACD,SAAS,GAAG;AAAA,MACZ;AAAA,IACD;AAAA,EACD;AACA,SAAO;AACR;AA5Be;AA8Bf,SAAS,wBAA4C;AACpD,QAAM,YAAa,uBAAwB,KAAK,GAAG,QAAQ,CAAC;AAC5D,MAAI,WAAW;AACd,WAAO,SAAS,UAAU,CAAC,CAAC;AAAA,EAC7B;AACA,SAAO;AACR;AANS;AAQT,SAAS,gBAAgB,SAAqC;AAC7D,QAAM,aAAa,QAAQ,IAAI,YAAY;AAC3C,MAAI,YAAY;AACf,UAAM,yBAAyB,QAAQ,IAAI,eAAe,wBAAwB;AAClF,WAAO,KAAK,KAAK,YAAY,yBAAyB,cAAc,YAAY,OAAO;AAAA,EACxF;AACA,SAAO;AACR;AAPS;AAST,SAAS,uBAA2C;AACnD,SAAO,gBAAgB,SAAS;AACjC;AAFS;AAOT,SAAS,wBAA4C;AACpD,SAAO,gBAAgB,uBAAuB;AAC/C;AAFS;",
  "names": []
}
