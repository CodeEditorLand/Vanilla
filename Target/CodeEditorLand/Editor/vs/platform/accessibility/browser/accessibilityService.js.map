{
  "version": 3,
  "sources": ["../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/platform/accessibility/browser/accessibilityService.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { addDisposableListener } from '../../../base/browser/dom.js';\nimport { alert, status } from '../../../base/browser/ui/aria/aria.js';\nimport { mainWindow } from '../../../base/browser/window.js';\nimport { Emitter, Event } from '../../../base/common/event.js';\nimport { Disposable } from '../../../base/common/lifecycle.js';\nimport { AccessibilitySupport, CONTEXT_ACCESSIBILITY_MODE_ENABLED, IAccessibilityService } from '../common/accessibility.js';\nimport { IConfigurationService } from '../../configuration/common/configuration.js';\nimport { IContextKey, IContextKeyService } from '../../contextkey/common/contextkey.js';\nimport { ILayoutService } from '../../layout/browser/layoutService.js';\n\nexport class AccessibilityService extends Disposable implements IAccessibilityService {\n\tdeclare readonly _serviceBrand: undefined;\n\n\tprivate _accessibilityModeEnabledContext: IContextKey<boolean>;\n\tprotected _accessibilitySupport = AccessibilitySupport.Unknown;\n\tprotected readonly _onDidChangeScreenReaderOptimized = new Emitter<void>();\n\n\tprotected _configMotionReduced: 'auto' | 'on' | 'off';\n\tprotected _systemMotionReduced: boolean;\n\tprotected readonly _onDidChangeReducedMotion = new Emitter<void>();\n\n\tprivate _linkUnderlinesEnabled: boolean;\n\tprotected readonly _onDidChangeLinkUnderline = new Emitter<void>();\n\n\tconstructor(\n\t\t@IContextKeyService private readonly _contextKeyService: IContextKeyService,\n\t\t@ILayoutService private readonly _layoutService: ILayoutService,\n\t\t@IConfigurationService protected readonly _configurationService: IConfigurationService\n\t) {\n\t\tsuper();\n\t\tthis._accessibilityModeEnabledContext = CONTEXT_ACCESSIBILITY_MODE_ENABLED.bindTo(this._contextKeyService);\n\n\t\tconst updateContextKey = () => this._accessibilityModeEnabledContext.set(this.isScreenReaderOptimized());\n\t\tthis._register(this._configurationService.onDidChangeConfiguration(e => {\n\t\t\tif (e.affectsConfiguration('editor.accessibilitySupport')) {\n\t\t\t\tupdateContextKey();\n\t\t\t\tthis._onDidChangeScreenReaderOptimized.fire();\n\t\t\t}\n\t\t\tif (e.affectsConfiguration('workbench.reduceMotion')) {\n\t\t\t\tthis._configMotionReduced = this._configurationService.getValue('workbench.reduceMotion');\n\t\t\t\tthis._onDidChangeReducedMotion.fire();\n\t\t\t}\n\t\t}));\n\t\tupdateContextKey();\n\t\tthis._register(this.onDidChangeScreenReaderOptimized(() => updateContextKey()));\n\n\t\tconst reduceMotionMatcher = mainWindow.matchMedia(`(prefers-reduced-motion: reduce)`);\n\t\tthis._systemMotionReduced = reduceMotionMatcher.matches;\n\t\tthis._configMotionReduced = this._configurationService.getValue<'auto' | 'on' | 'off'>('workbench.reduceMotion');\n\n\t\tthis._linkUnderlinesEnabled = this._configurationService.getValue('accessibility.underlineLinks');\n\n\t\tthis.initReducedMotionListeners(reduceMotionMatcher);\n\t\tthis.initLinkUnderlineListeners();\n\t}\n\n\tprivate initReducedMotionListeners(reduceMotionMatcher: MediaQueryList) {\n\n\t\tthis._register(addDisposableListener(reduceMotionMatcher, 'change', () => {\n\t\t\tthis._systemMotionReduced = reduceMotionMatcher.matches;\n\t\t\tif (this._configMotionReduced === 'auto') {\n\t\t\t\tthis._onDidChangeReducedMotion.fire();\n\t\t\t}\n\t\t}));\n\n\t\tconst updateRootClasses = () => {\n\t\t\tconst reduce = this.isMotionReduced();\n\t\t\tthis._layoutService.mainContainer.classList.toggle('reduce-motion', reduce);\n\t\t\tthis._layoutService.mainContainer.classList.toggle('enable-motion', !reduce);\n\t\t};\n\n\t\tupdateRootClasses();\n\t\tthis._register(this.onDidChangeReducedMotion(() => updateRootClasses()));\n\t}\n\n\tprivate initLinkUnderlineListeners() {\n\t\tthis._register(this._configurationService.onDidChangeConfiguration(e => {\n\t\t\tif (e.affectsConfiguration('accessibility.underlineLinks')) {\n\t\t\t\tconst linkUnderlinesEnabled = this._configurationService.getValue<boolean>('accessibility.underlineLinks');\n\t\t\t\tthis._linkUnderlinesEnabled = linkUnderlinesEnabled;\n\t\t\t\tthis._onDidChangeLinkUnderline.fire();\n\t\t\t}\n\t\t}));\n\n\t\tconst updateLinkUnderlineClasses = () => {\n\t\t\tconst underlineLinks = this._linkUnderlinesEnabled;\n\t\t\tthis._layoutService.mainContainer.classList.toggle('underline-links', underlineLinks);\n\t\t};\n\n\t\tupdateLinkUnderlineClasses();\n\n\t\tthis._register(this.onDidChangeLinkUnderlines(() => updateLinkUnderlineClasses()));\n\t}\n\n\tpublic onDidChangeLinkUnderlines(listener: () => void) {\n\t\treturn this._onDidChangeLinkUnderline.event(listener);\n\t}\n\n\tget onDidChangeScreenReaderOptimized(): Event<void> {\n\t\treturn this._onDidChangeScreenReaderOptimized.event;\n\t}\n\n\tisScreenReaderOptimized(): boolean {\n\t\tconst config = this._configurationService.getValue('editor.accessibilitySupport');\n\t\treturn config === 'on' || (config === 'auto' && this._accessibilitySupport === AccessibilitySupport.Enabled);\n\t}\n\n\tget onDidChangeReducedMotion(): Event<void> {\n\t\treturn this._onDidChangeReducedMotion.event;\n\t}\n\n\tisMotionReduced(): boolean {\n\t\tconst config = this._configMotionReduced;\n\t\treturn config === 'on' || (config === 'auto' && this._systemMotionReduced);\n\t}\n\n\talwaysUnderlineAccessKeys(): Promise<boolean> {\n\t\treturn Promise.resolve(false);\n\t}\n\n\tgetAccessibilitySupport(): AccessibilitySupport {\n\t\treturn this._accessibilitySupport;\n\t}\n\n\tsetAccessibilitySupport(accessibilitySupport: AccessibilitySupport): void {\n\t\tif (this._accessibilitySupport === accessibilitySupport) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._accessibilitySupport = accessibilitySupport;\n\t\tthis._onDidChangeScreenReaderOptimized.fire();\n\t}\n\n\talert(message: string): void {\n\t\talert(message);\n\t}\n\n\tstatus(message: string): void {\n\t\tstatus(message);\n\t}\n}\n"],
  "mappings": "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",
  "names": []
}
