var d=Object.defineProperty;var m=Object.getOwnPropertyDescriptor;var c=(r,e,t,o)=>{for(var i=o>1?void 0:o?m(e,t):e,s=r.length-1,a;s>=0;s--)(a=r[s])&&(i=(o?a(e,t,i):a(i))||i);return o&&i&&d(e,t,i),i},p=(r,e)=>(t,o)=>e(t,o,r);import{timeout as l}from"../../../base/common/async.js";import{ILogService as w}from"../../log/common/log.js";let n=class{constructor(e,t,o){this._window=e;this._sessionId=t;this._logService=o}async inspect(e){await this._connect();const t=this._window.webContents.debugger;await t.sendCommand("Profiler.start"),this._logService.warn("[perf] profiling STARTED",this._sessionId),await l(e);const o=await t.sendCommand("Profiler.stop");return this._logService.warn("[perf] profiling DONE",this._sessionId),await this._disconnect(),o.profile}async _connect(){const e=this._window.webContents.debugger;e.attach(),await e.sendCommand("Profiler.enable")}async _disconnect(){const e=this._window.webContents.debugger;await e.sendCommand("Profiler.disable"),e.detach()}};n=c([p(2,w)],n);export{n as WindowProfiler};
