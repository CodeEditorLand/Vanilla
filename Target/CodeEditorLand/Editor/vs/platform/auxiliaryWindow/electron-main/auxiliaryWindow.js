var c=Object.defineProperty;var l=Object.getOwnPropertyDescriptor;var w=(o,r,e,i)=>{for(var t=i>1?void 0:i?l(r,e):r,s=o.length-1,a;s>=0;s--)(a=o[s])&&(t=(i?a(r,e,t):a(t))||t);return i&&t&&c(r,e,t),t},n=(o,r)=>(e,i)=>r(e,i,o);import{BrowserWindow as f}from"electron";import{isLinux as h,isWindows as p}from"../../../../vs/base/common/platform.js";import{IConfigurationService as u}from"../../../../vs/platform/configuration/common/configuration.js";import{IEnvironmentMainService as v}from"../../../../vs/platform/environment/electron-main/environmentMainService.js";import{ILifecycleMainService as C}from"../../../../vs/platform/lifecycle/electron-main/lifecycleMainService.js";import{ILogService as S}from"../../../../vs/platform/log/common/log.js";import{IStateService as W}from"../../../../vs/platform/state/node/state.js";import{hasNativeTitlebar as y,TitlebarStyle as I}from"../../../../vs/platform/window/common/window.js";import{WindowMode as m}from"../../../../vs/platform/window/electron-main/window.js";import{BaseWindow as b}from"../../../../vs/platform/windows/electron-main/windowImpl.js";let d=class extends b{constructor(e,i,t,s,a,M){super(s,a,i,t);this.webContents=e;this.lifecycleMainService=M;this.tryClaimWindow()}id=this.webContents.id;parentId=-1;get win(){return super.win||this.tryClaimWindow(),super.win}stateApplied=!1;tryClaimWindow(e){this._store.isDisposed||this.webContents.isDestroyed()||(this.doTryClaimWindow(e),e&&!this.stateApplied&&(this.stateApplied=!0,this.applyState({x:e.x,y:e.y,width:e.width,height:e.height,mode:e.show===!1?m.Maximized:m.Normal})))}doTryClaimWindow(e){if(this._win)return;const i=f.fromWebContents(this.webContents);i&&(this.logService.trace("[aux window] Claimed browser window instance"),this.setWin(i,e),i.setMenu(null),(p||h)&&y(this.configurationService,e?.titleBarStyle==="hidden"?I.CUSTOM:void 0)&&i.setAutoHideMenuBar(!0),this.lifecycleMainService.registerAuxWindow(this))}matches(e){return this.webContents.id===e.id}};d=w([n(1,v),n(2,S),n(3,u),n(4,W),n(5,C)],d);export{d as AuxiliaryWindow};
