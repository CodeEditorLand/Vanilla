{
  "version": 3,
  "sources": ["../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/platform/windows/electron-main/windowImpl.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport electron, { BrowserWindowConstructorOptions } from 'electron';\nimport { DeferredPromise, RunOnceScheduler, timeout } from '../../../base/common/async.js';\nimport { CancellationToken } from '../../../base/common/cancellation.js';\nimport { toErrorMessage } from '../../../base/common/errorMessage.js';\nimport { Emitter, Event } from '../../../base/common/event.js';\nimport { Disposable } from '../../../base/common/lifecycle.js';\nimport { FileAccess, Schemas } from '../../../base/common/network.js';\nimport { getMarks, mark } from '../../../base/common/performance.js';\nimport { isBigSurOrNewer, isMacintosh, isWindows } from '../../../base/common/platform.js';\nimport { URI } from '../../../base/common/uri.js';\nimport { localize } from '../../../nls.js';\nimport { release } from 'os';\nimport { ISerializableCommandAction } from '../../action/common/action.js';\nimport { IBackupMainService } from '../../backup/electron-main/backup.js';\nimport { IConfigurationChangeEvent, IConfigurationService } from '../../configuration/common/configuration.js';\nimport { IDialogMainService } from '../../dialogs/electron-main/dialogMainService.js';\nimport { NativeParsedArgs } from '../../environment/common/argv.js';\nimport { IEnvironmentMainService } from '../../environment/electron-main/environmentMainService.js';\nimport { isLaunchedFromCli } from '../../environment/node/argvHelper.js';\nimport { IFileService } from '../../files/common/files.js';\nimport { ILifecycleMainService } from '../../lifecycle/electron-main/lifecycleMainService.js';\nimport { ILogService } from '../../log/common/log.js';\nimport { IProductService } from '../../product/common/productService.js';\nimport { IProtocolMainService } from '../../protocol/electron-main/protocol.js';\nimport { resolveMarketplaceHeaders } from '../../externalServices/common/marketplace.js';\nimport { IApplicationStorageMainService, IStorageMainService } from '../../storage/electron-main/storageMainService.js';\nimport { ITelemetryService } from '../../telemetry/common/telemetry.js';\nimport { ThemeIcon } from '../../../base/common/themables.js';\nimport { IThemeMainService } from '../../theme/electron-main/themeMainService.js';\nimport { getMenuBarVisibility, IFolderToOpen, INativeWindowConfiguration, IWindowSettings, IWorkspaceToOpen, MenuBarVisibility, hasNativeTitlebar, useNativeFullScreen, useWindowControlsOverlay, DEFAULT_CUSTOM_TITLEBAR_HEIGHT, TitlebarStyle } from '../../window/common/window.js';\nimport { defaultBrowserWindowOptions, IWindowsMainService, OpenContext, WindowStateValidator } from './windows.js';\nimport { ISingleFolderWorkspaceIdentifier, IWorkspaceIdentifier, isSingleFolderWorkspaceIdentifier, isWorkspaceIdentifier, toWorkspaceIdentifier } from '../../workspace/common/workspace.js';\nimport { IWorkspacesManagementMainService } from '../../workspaces/electron-main/workspacesManagementMainService.js';\nimport { IWindowState, ICodeWindow, ILoadEvent, WindowMode, WindowError, LoadReason, defaultWindowState, IBaseWindow } from '../../window/electron-main/window.js';\nimport { IPolicyService } from '../../policy/common/policy.js';\nimport { IUserDataProfile } from '../../userDataProfile/common/userDataProfile.js';\nimport { IStateService } from '../../state/node/state.js';\nimport { IUserDataProfilesMainService } from '../../userDataProfile/electron-main/userDataProfile.js';\nimport { ILoggerMainService } from '../../log/electron-main/loggerService.js';\nimport { IInstantiationService } from '../../instantiation/common/instantiation.js';\nimport { isESM } from '../../../base/common/amd.js';\n\nexport interface IWindowCreationOptions {\n\treadonly state: IWindowState;\n\treadonly extensionDevelopmentPath?: string[];\n\treadonly isExtensionTestHost?: boolean;\n}\n\ninterface ITouchBarSegment extends electron.SegmentedControlSegment {\n\treadonly id: string;\n}\n\ninterface ILoadOptions {\n\treadonly isReload?: boolean;\n\treadonly disableExtensions?: boolean;\n}\n\nconst enum ReadyState {\n\n\t/**\n\t * This window has not loaded anything yet\n\t * and this is the initial state of every\n\t * window.\n\t */\n\tNONE,\n\n\t/**\n\t * This window is navigating, either for the\n\t * first time or subsequent times.\n\t */\n\tNAVIGATING,\n\n\t/**\n\t * This window has finished loading and is ready\n\t * to forward IPC requests to the web contents.\n\t */\n\tREADY\n}\n\nexport abstract class BaseWindow extends Disposable implements IBaseWindow {\n\n\t//#region Events\n\n\tprivate readonly _onDidClose = this._register(new Emitter<void>());\n\treadonly onDidClose = this._onDidClose.event;\n\n\tprivate readonly _onDidMaximize = this._register(new Emitter<void>());\n\treadonly onDidMaximize = this._onDidMaximize.event;\n\n\tprivate readonly _onDidUnmaximize = this._register(new Emitter<void>());\n\treadonly onDidUnmaximize = this._onDidUnmaximize.event;\n\n\tprivate readonly _onDidTriggerSystemContextMenu = this._register(new Emitter<{ x: number; y: number }>());\n\treadonly onDidTriggerSystemContextMenu = this._onDidTriggerSystemContextMenu.event;\n\n\tprivate readonly _onDidEnterFullScreen = this._register(new Emitter<void>());\n\treadonly onDidEnterFullScreen = this._onDidEnterFullScreen.event;\n\n\tprivate readonly _onDidLeaveFullScreen = this._register(new Emitter<void>());\n\treadonly onDidLeaveFullScreen = this._onDidLeaveFullScreen.event;\n\n\t//#endregion\n\n\tabstract readonly id: number;\n\n\tprotected _lastFocusTime = Date.now(); // window is shown on creation so take current time\n\tget lastFocusTime(): number { return this._lastFocusTime; }\n\n\tprotected _win: electron.BrowserWindow | null = null;\n\tget win() { return this._win; }\n\tprotected setWin(win: electron.BrowserWindow, options?: BrowserWindowConstructorOptions): void {\n\t\tthis._win = win;\n\n\t\t// Window Events\n\t\tthis._register(Event.fromNodeEventEmitter(win, 'maximize')(() => this._onDidMaximize.fire()));\n\t\tthis._register(Event.fromNodeEventEmitter(win, 'unmaximize')(() => this._onDidUnmaximize.fire()));\n\t\tthis._register(Event.fromNodeEventEmitter(win, 'closed')(() => {\n\t\t\tthis._onDidClose.fire();\n\n\t\t\tthis.dispose();\n\t\t}));\n\t\tthis._register(Event.fromNodeEventEmitter(win, 'focus')(() => {\n\t\t\tthis._lastFocusTime = Date.now();\n\t\t}));\n\t\tthis._register(Event.fromNodeEventEmitter(this._win, 'enter-full-screen')(() => this._onDidEnterFullScreen.fire()));\n\t\tthis._register(Event.fromNodeEventEmitter(this._win, 'leave-full-screen')(() => this._onDidLeaveFullScreen.fire()));\n\n\t\t// Sheet Offsets\n\t\tconst useCustomTitleStyle = !hasNativeTitlebar(this.configurationService, options?.titleBarStyle === 'hidden' ? TitlebarStyle.CUSTOM : undefined /* unknown */);\n\t\tif (isMacintosh && useCustomTitleStyle) {\n\t\t\twin.setSheetOffset(isBigSurOrNewer(release()) ? 28 : 22); // offset dialogs by the height of the custom title bar if we have any\n\t\t}\n\n\t\t// Update the window controls immediately based on cached or default values\n\t\tif (useCustomTitleStyle && (useWindowControlsOverlay(this.configurationService) || isMacintosh)) {\n\t\t\tconst cachedWindowControlHeight = this.stateService.getItem<number>((BaseWindow.windowControlHeightStateStorageKey));\n\t\t\tif (cachedWindowControlHeight) {\n\t\t\t\tthis.updateWindowControls({ height: cachedWindowControlHeight });\n\t\t\t} else {\n\t\t\t\tthis.updateWindowControls({ height: DEFAULT_CUSTOM_TITLEBAR_HEIGHT });\n\t\t\t}\n\t\t}\n\n\t\t// Windows Custom System Context Menu\n\t\t// See https://github.com/electron/electron/issues/24893\n\t\t//\n\t\t// The purpose of this is to allow for the context menu in the Windows Title Bar\n\t\t//\n\t\t// Currently, all mouse events in the title bar are captured by the OS\n\t\t// thus we need to capture them here with a window hook specific to Windows\n\t\t// and then forward them to the correct window.\n\t\tif (isWindows && useCustomTitleStyle) {\n\t\t\tconst WM_INITMENU = 0x0116; // https://docs.microsoft.com/en-us/windows/win32/menurc/wm-initmenu\n\n\t\t\t// This sets up a listener for the window hook. This is a Windows-only API provided by electron.\n\t\t\twin.hookWindowMessage(WM_INITMENU, () => {\n\t\t\t\tconst [x, y] = win.getPosition();\n\t\t\t\tconst cursorPos = electron.screen.getCursorScreenPoint();\n\t\t\t\tconst cx = cursorPos.x - x;\n\t\t\t\tconst cy = cursorPos.y - y;\n\n\t\t\t\t// In some cases, show the default system context menu\n\t\t\t\t// 1) The mouse position is not within the title bar\n\t\t\t\t// 2) The mouse position is within the title bar, but over the app icon\n\t\t\t\t// We do not know the exact title bar height but we make an estimate based on window height\n\t\t\t\tconst shouldTriggerDefaultSystemContextMenu = () => {\n\t\t\t\t\t// Use the custom context menu when over the title bar, but not over the app icon\n\t\t\t\t\t// The app icon is estimated to be 30px wide\n\t\t\t\t\t// The title bar is estimated to be the max of 35px and 15% of the window height\n\t\t\t\t\tif (cx > 30 && cy >= 0 && cy <= Math.max(win.getBounds().height * 0.15, 35)) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn true;\n\t\t\t\t};\n\n\t\t\t\tif (!shouldTriggerDefaultSystemContextMenu()) {\n\n\t\t\t\t\t// This is necessary to make sure the native system context menu does not show up.\n\t\t\t\t\twin.setEnabled(false);\n\t\t\t\t\twin.setEnabled(true);\n\n\t\t\t\t\tthis._onDidTriggerSystemContextMenu.fire({ x: cx, y: cy });\n\t\t\t\t}\n\n\t\t\t\treturn 0;\n\t\t\t});\n\t\t}\n\n\t\t// Open devtools if instructed from command line args\n\t\tif (this.environmentMainService.args['open-devtools'] === true) {\n\t\t\twin.webContents.openDevTools();\n\t\t}\n\n\t\t// macOS: Window Fullscreen Transitions\n\t\tif (isMacintosh) {\n\t\t\tthis._register(this.onDidEnterFullScreen(() => {\n\t\t\t\tthis.joinNativeFullScreenTransition?.complete(true);\n\t\t\t}));\n\n\t\t\tthis._register(this.onDidLeaveFullScreen(() => {\n\t\t\t\tthis.joinNativeFullScreenTransition?.complete(true);\n\t\t\t}));\n\t\t}\n\t}\n\n\tconstructor(\n\t\tprotected readonly configurationService: IConfigurationService,\n\t\tprotected readonly stateService: IStateService,\n\t\tprotected readonly environmentMainService: IEnvironmentMainService,\n\t\tprotected readonly logService: ILogService\n\t) {\n\t\tsuper();\n\t}\n\n\tprotected applyState(state: IWindowState, hasMultipleDisplays = electron.screen.getAllDisplays().length > 0): void {\n\n\t\t// TODO@electron (Electron 4 regression): when running on multiple displays where the target display\n\t\t// to open the window has a larger resolution than the primary display, the window will not size\n\t\t// correctly unless we set the bounds again (https://github.com/microsoft/vscode/issues/74872)\n\t\t//\n\t\t// Extended to cover Windows as well as Mac (https://github.com/microsoft/vscode/issues/146499)\n\t\t//\n\t\t// However, when running with native tabs with multiple windows we cannot use this workaround\n\t\t// because there is a potential that the new window will be added as native tab instead of being\n\t\t// a window on its own. In that case calling setBounds() would cause https://github.com/microsoft/vscode/issues/75830\n\n\t\tconst windowSettings = this.configurationService.getValue<IWindowSettings | undefined>('window');\n\t\tconst useNativeTabs = isMacintosh && windowSettings?.nativeTabs === true;\n\t\tif ((isMacintosh || isWindows) && hasMultipleDisplays && (!useNativeTabs || electron.BrowserWindow.getAllWindows().length === 1)) {\n\t\t\tif ([state.width, state.height, state.x, state.y].every(value => typeof value === 'number')) {\n\t\t\t\tthis._win?.setBounds({\n\t\t\t\t\twidth: state.width,\n\t\t\t\t\theight: state.height,\n\t\t\t\t\tx: state.x,\n\t\t\t\t\ty: state.y\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif (state.mode === WindowMode.Maximized || state.mode === WindowMode.Fullscreen) {\n\n\t\t\t// this call may or may not show the window, depends\n\t\t\t// on the platform: currently on Windows and Linux will\n\t\t\t// show the window as active. To be on the safe side,\n\t\t\t// we show the window at the end of this block.\n\t\t\tthis._win?.maximize();\n\n\t\t\tif (state.mode === WindowMode.Fullscreen) {\n\t\t\t\tthis.setFullScreen(true, true);\n\t\t\t}\n\n\t\t\t// to reduce flicker from the default window size\n\t\t\t// to maximize or fullscreen, we only show after\n\t\t\tthis._win?.show();\n\t\t}\n\t}\n\n\tprivate representedFilename: string | undefined;\n\n\tsetRepresentedFilename(filename: string): void {\n\t\tif (isMacintosh) {\n\t\t\tthis.win?.setRepresentedFilename(filename);\n\t\t} else {\n\t\t\tthis.representedFilename = filename;\n\t\t}\n\t}\n\n\tgetRepresentedFilename(): string | undefined {\n\t\tif (isMacintosh) {\n\t\t\treturn this.win?.getRepresentedFilename();\n\t\t}\n\n\t\treturn this.representedFilename;\n\t}\n\n\tprivate documentEdited: boolean | undefined;\n\n\tsetDocumentEdited(edited: boolean): void {\n\t\tif (isMacintosh) {\n\t\t\tthis.win?.setDocumentEdited(edited);\n\t\t}\n\n\t\tthis.documentEdited = edited;\n\t}\n\n\tisDocumentEdited(): boolean {\n\t\tif (isMacintosh) {\n\t\t\treturn Boolean(this.win?.isDocumentEdited());\n\t\t}\n\n\t\treturn !!this.documentEdited;\n\t}\n\n\tfocus(options?: { force: boolean }): void {\n\t\tif (isMacintosh && options?.force) {\n\t\t\telectron.app.focus({ steal: true });\n\t\t}\n\n\t\tconst win = this.win;\n\t\tif (!win) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (win.isMinimized()) {\n\t\t\twin.restore();\n\t\t}\n\n\t\twin.focus();\n\t}\n\n\thandleTitleDoubleClick(): void {\n\t\tconst win = this.win;\n\t\tif (!win) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Respect system settings on mac with regards to title click on windows title\n\t\tif (isMacintosh) {\n\t\t\tconst action = electron.systemPreferences.getUserDefault('AppleActionOnDoubleClick', 'string');\n\t\t\tswitch (action) {\n\t\t\t\tcase 'Minimize':\n\t\t\t\t\twin.minimize();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'None':\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'Maximize':\n\t\t\t\tdefault:\n\t\t\t\t\tif (win.isMaximized()) {\n\t\t\t\t\t\twin.unmaximize();\n\t\t\t\t\t} else {\n\t\t\t\t\t\twin.maximize();\n\t\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Linux/Windows: just toggle maximize/minimized state\n\t\telse {\n\t\t\tif (win.isMaximized()) {\n\t\t\t\twin.unmaximize();\n\t\t\t} else {\n\t\t\t\twin.maximize();\n\t\t\t}\n\t\t}\n\t}\n\n\t//#region Window Control Overlays\n\n\tprivate static readonly windowControlHeightStateStorageKey = 'windowControlHeight';\n\n\tprivate readonly hasWindowControlOverlay = useWindowControlsOverlay(this.configurationService);\n\n\tupdateWindowControls(options: { height?: number; backgroundColor?: string; foregroundColor?: string }): void {\n\t\tconst win = this.win;\n\t\tif (!win) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Cache the height for speeds lookups on startup\n\t\tif (options.height) {\n\t\t\tthis.stateService.setItem((CodeWindow.windowControlHeightStateStorageKey), options.height);\n\t\t}\n\n\t\t// Windows/Linux: window control overlay (WCO)\n\t\tif (this.hasWindowControlOverlay) {\n\t\t\twin.setTitleBarOverlay({\n\t\t\t\tcolor: options.backgroundColor?.trim() === '' ? undefined : options.backgroundColor,\n\t\t\t\tsymbolColor: options.foregroundColor?.trim() === '' ? undefined : options.foregroundColor,\n\t\t\t\theight: options.height ? options.height - 1 : undefined // account for window border\n\t\t\t});\n\t\t}\n\n\t\t// macOS: traffic lights\n\t\telse if (isMacintosh && options.height !== undefined) {\n\t\t\tconst verticalOffset = (options.height - 15) / 2; // 15px is the height of the traffic lights\n\t\t\tif (!verticalOffset) {\n\t\t\t\twin.setWindowButtonPosition(null);\n\t\t\t} else {\n\t\t\t\twin.setWindowButtonPosition({ x: verticalOffset, y: verticalOffset });\n\t\t\t}\n\t\t}\n\t}\n\n\t//#endregion\n\n\t//#region Fullscreen\n\n\tprivate transientIsNativeFullScreen: boolean | undefined = undefined;\n\tprivate joinNativeFullScreenTransition: DeferredPromise<boolean> | undefined = undefined;\n\n\ttoggleFullScreen(): void {\n\t\tthis.setFullScreen(!this.isFullScreen, false);\n\t}\n\n\tprotected setFullScreen(fullscreen: boolean, fromRestore: boolean): void {\n\n\t\t// Set fullscreen state\n\t\tif (useNativeFullScreen(this.configurationService)) {\n\t\t\tthis.setNativeFullScreen(fullscreen, fromRestore);\n\t\t} else {\n\t\t\tthis.setSimpleFullScreen(fullscreen);\n\t\t}\n\t}\n\n\tget isFullScreen(): boolean {\n\t\tif (isMacintosh && typeof this.transientIsNativeFullScreen === 'boolean') {\n\t\t\treturn this.transientIsNativeFullScreen;\n\t\t}\n\n\t\tconst win = this.win;\n\t\tconst isFullScreen = win?.isFullScreen();\n\t\tconst isSimpleFullScreen = win?.isSimpleFullScreen();\n\n\t\treturn Boolean(isFullScreen || isSimpleFullScreen);\n\t}\n\n\tprivate setNativeFullScreen(fullscreen: boolean, fromRestore: boolean): void {\n\t\tconst win = this.win;\n\t\tif (win?.isSimpleFullScreen()) {\n\t\t\twin?.setSimpleFullScreen(false);\n\t\t}\n\n\t\tthis.doSetNativeFullScreen(fullscreen, fromRestore);\n\t}\n\n\tprivate doSetNativeFullScreen(fullscreen: boolean, fromRestore: boolean): void {\n\t\tif (isMacintosh) {\n\n\t\t\t// macOS: Electron windows report `false` for `isFullScreen()` for as long\n\t\t\t// as the fullscreen transition animation takes place. As such, we need to\n\t\t\t// listen to the transition events and carry around an intermediate state\n\t\t\t// for knowing if we are in fullscreen or not\n\t\t\t// Refs: https://github.com/electron/electron/issues/35360\n\n\t\t\tthis.transientIsNativeFullScreen = fullscreen;\n\n\t\t\tconst joinNativeFullScreenTransition = this.joinNativeFullScreenTransition = new DeferredPromise<boolean>();\n\t\t\t(async () => {\n\t\t\t\tconst transitioned = await Promise.race([\n\t\t\t\t\tjoinNativeFullScreenTransition.p,\n\t\t\t\t\ttimeout(10000).then(() => false)\n\t\t\t\t]);\n\n\t\t\t\tif (this.joinNativeFullScreenTransition !== joinNativeFullScreenTransition) {\n\t\t\t\t\treturn; // another transition was requested later\n\t\t\t\t}\n\n\t\t\t\tthis.transientIsNativeFullScreen = undefined;\n\t\t\t\tthis.joinNativeFullScreenTransition = undefined;\n\n\t\t\t\t// There is one interesting gotcha on macOS: when you are opening a new\n\t\t\t\t// window from a fullscreen window, that new window will immediately\n\t\t\t\t// open fullscreen and emit the `enter-full-screen` event even before we\n\t\t\t\t// reach this method. In that case, we actually will timeout after 10s\n\t\t\t\t// for detecting the transition and as such it is important that we only\n\t\t\t\t// signal to leave fullscreen if the window reports as not being in fullscreen.\n\n\t\t\t\tif (!transitioned && fullscreen && fromRestore && this.win && !this.win.isFullScreen()) {\n\n\t\t\t\t\t// We have seen requests for fullscreen failing eventually after some\n\t\t\t\t\t// time, for example when an OS update was performed and windows restore.\n\t\t\t\t\t// In those cases a user would find a window that is not in fullscreen\n\t\t\t\t\t// but also does not show any custom titlebar (and thus window controls)\n\t\t\t\t\t// because we think the window is in fullscreen.\n\t\t\t\t\t//\n\t\t\t\t\t// As a workaround in that case we emit a warning and leave fullscreen\n\t\t\t\t\t// so that at least the window controls are back.\n\n\t\t\t\t\tthis.logService.warn('window: native macOS fullscreen transition did not happen within 10s from restoring');\n\n\t\t\t\t\tthis._onDidLeaveFullScreen.fire();\n\t\t\t\t}\n\t\t\t})();\n\t\t}\n\n\t\tconst win = this.win;\n\t\twin?.setFullScreen(fullscreen);\n\t}\n\n\tprivate setSimpleFullScreen(fullscreen: boolean): void {\n\t\tconst win = this.win;\n\t\tif (win?.isFullScreen()) {\n\t\t\tthis.doSetNativeFullScreen(false, false);\n\t\t}\n\n\t\twin?.setSimpleFullScreen(fullscreen);\n\t\twin?.webContents.focus(); // workaround issue where focus is not going into window\n\t}\n\n\t//#endregion\n\n\tabstract matches(webContents: electron.WebContents): boolean;\n\n\toverride dispose(): void {\n\t\tsuper.dispose();\n\n\t\tthis._win = null!; // Important to dereference the window object to allow for GC\n\t}\n}\n\nexport class CodeWindow extends BaseWindow implements ICodeWindow {\n\n\t//#region Events\n\n\tprivate readonly _onWillLoad = this._register(new Emitter<ILoadEvent>());\n\treadonly onWillLoad = this._onWillLoad.event;\n\n\tprivate readonly _onDidSignalReady = this._register(new Emitter<void>());\n\treadonly onDidSignalReady = this._onDidSignalReady.event;\n\n\tprivate readonly _onDidDestroy = this._register(new Emitter<void>());\n\treadonly onDidDestroy = this._onDidDestroy.event;\n\n\t//#endregion\n\n\n\t//#region Properties\n\n\tprivate _id: number;\n\tget id(): number { return this._id; }\n\n\tprotected override _win: electron.BrowserWindow;\n\n\tget backupPath(): string | undefined { return this._config?.backupPath; }\n\n\tget openedWorkspace(): IWorkspaceIdentifier | ISingleFolderWorkspaceIdentifier | undefined { return this._config?.workspace; }\n\n\tget profile(): IUserDataProfile | undefined {\n\t\tif (!this.config) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst profile = this.userDataProfilesService.profiles.find(profile => profile.id === this.config?.profiles.profile.id);\n\t\tif (this.isExtensionDevelopmentHost && profile) {\n\t\t\treturn profile;\n\t\t}\n\n\t\treturn this.userDataProfilesService.getProfileForWorkspace(this.config.workspace ?? toWorkspaceIdentifier(this.backupPath, this.isExtensionDevelopmentHost)) ?? this.userDataProfilesService.defaultProfile;\n\t}\n\n\tget remoteAuthority(): string | undefined { return this._config?.remoteAuthority; }\n\n\tprivate _config: INativeWindowConfiguration | undefined;\n\tget config(): INativeWindowConfiguration | undefined { return this._config; }\n\n\tget isExtensionDevelopmentHost(): boolean { return !!(this._config?.extensionDevelopmentPath); }\n\n\tget isExtensionTestHost(): boolean { return !!(this._config?.extensionTestsPath); }\n\n\tget isExtensionDevelopmentTestFromCli(): boolean { return this.isExtensionDevelopmentHost && this.isExtensionTestHost && !this._config?.debugId; }\n\n\t//#endregion\n\n\tprivate readonly windowState: IWindowState;\n\tprivate currentMenuBarVisibility: MenuBarVisibility | undefined;\n\n\tprivate readonly whenReadyCallbacks: { (window: ICodeWindow): void }[] = [];\n\n\tprivate readonly touchBarGroups: electron.TouchBarSegmentedControl[] = [];\n\n\tprivate currentHttpProxy: string | undefined = undefined;\n\tprivate currentNoProxy: string | undefined = undefined;\n\n\tprivate customZoomLevel: number | undefined = undefined;\n\n\tprivate readonly configObjectUrl = this._register(this.protocolMainService.createIPCObjectUrl<INativeWindowConfiguration>());\n\tprivate pendingLoadConfig: INativeWindowConfiguration | undefined;\n\tprivate wasLoaded = false;\n\n\tconstructor(\n\t\tconfig: IWindowCreationOptions,\n\t\t@ILogService logService: ILogService,\n\t\t@ILoggerMainService private readonly loggerMainService: ILoggerMainService,\n\t\t@IEnvironmentMainService environmentMainService: IEnvironmentMainService,\n\t\t@IPolicyService private readonly policyService: IPolicyService,\n\t\t@IUserDataProfilesMainService private readonly userDataProfilesService: IUserDataProfilesMainService,\n\t\t@IFileService private readonly fileService: IFileService,\n\t\t@IApplicationStorageMainService private readonly applicationStorageMainService: IApplicationStorageMainService,\n\t\t@IStorageMainService private readonly storageMainService: IStorageMainService,\n\t\t@IConfigurationService configurationService: IConfigurationService,\n\t\t@IThemeMainService private readonly themeMainService: IThemeMainService,\n\t\t@IWorkspacesManagementMainService private readonly workspacesManagementMainService: IWorkspacesManagementMainService,\n\t\t@IBackupMainService private readonly backupMainService: IBackupMainService,\n\t\t@ITelemetryService private readonly telemetryService: ITelemetryService,\n\t\t@IDialogMainService private readonly dialogMainService: IDialogMainService,\n\t\t@ILifecycleMainService private readonly lifecycleMainService: ILifecycleMainService,\n\t\t@IProductService private readonly productService: IProductService,\n\t\t@IProtocolMainService private readonly protocolMainService: IProtocolMainService,\n\t\t@IWindowsMainService private readonly windowsMainService: IWindowsMainService,\n\t\t@IStateService stateService: IStateService,\n\t\t@IInstantiationService instantiationService: IInstantiationService\n\t) {\n\t\tsuper(configurationService, stateService, environmentMainService, logService);\n\n\t\t//#region create browser window\n\t\t{\n\t\t\t// Load window state\n\t\t\tconst [state, hasMultipleDisplays] = this.restoreWindowState(config.state);\n\t\t\tthis.windowState = state;\n\t\t\tthis.logService.trace('window#ctor: using window state', state);\n\n\t\t\tconst options = instantiationService.invokeFunction(defaultBrowserWindowOptions, this.windowState, undefined, {\n\t\t\t\tpreload: FileAccess.asFileUri('vs/base/parts/sandbox/electron-sandbox/preload.js').fsPath,\n\t\t\t\tadditionalArguments: [`--vscode-window-config=${this.configObjectUrl.resource.toString()}`],\n\t\t\t\tv8CacheOptions: this.environmentMainService.useCodeCache ? 'bypassHeatCheck' : 'none',\n\t\t\t});\n\n\t\t\t// Create the browser window\n\t\t\tmark('code/willCreateCodeBrowserWindow');\n\t\t\tthis._win = new electron.BrowserWindow(options);\n\t\t\tmark('code/didCreateCodeBrowserWindow');\n\n\t\t\tthis._id = this._win.id;\n\t\t\tthis.setWin(this._win, options);\n\n\t\t\t// Apply some state after window creation\n\t\t\tthis.applyState(this.windowState, hasMultipleDisplays);\n\n\t\t\tthis._lastFocusTime = Date.now(); // since we show directly, we need to set the last focus time too\n\t\t}\n\t\t//#endregion\n\n\t\t// respect configured menu bar visibility\n\t\tthis.onConfigurationUpdated();\n\n\t\t// macOS: touch bar support\n\t\tthis.createTouchBar();\n\n\t\t// Eventing\n\t\tthis.registerListeners();\n\t}\n\n\tprivate readyState = ReadyState.NONE;\n\n\tsetReady(): void {\n\t\tthis.logService.trace(`window#load: window reported ready (id: ${this._id})`);\n\n\t\tthis.readyState = ReadyState.READY;\n\n\t\t// inform all waiting promises that we are ready now\n\t\twhile (this.whenReadyCallbacks.length) {\n\t\t\tthis.whenReadyCallbacks.pop()!(this);\n\t\t}\n\n\t\t// Events\n\t\tthis._onDidSignalReady.fire();\n\t}\n\n\tready(): Promise<ICodeWindow> {\n\t\treturn new Promise<ICodeWindow>(resolve => {\n\t\t\tif (this.isReady) {\n\t\t\t\treturn resolve(this);\n\t\t\t}\n\n\t\t\t// otherwise keep and call later when we are ready\n\t\t\tthis.whenReadyCallbacks.push(resolve);\n\t\t});\n\t}\n\n\tget isReady(): boolean {\n\t\treturn this.readyState === ReadyState.READY;\n\t}\n\n\tget whenClosedOrLoaded(): Promise<void> {\n\t\treturn new Promise<void>(resolve => {\n\n\t\t\tfunction handle() {\n\t\t\t\tcloseListener.dispose();\n\t\t\t\tloadListener.dispose();\n\n\t\t\t\tresolve();\n\t\t\t}\n\n\t\t\tconst closeListener = this.onDidClose(() => handle());\n\t\t\tconst loadListener = this.onWillLoad(() => handle());\n\t\t});\n\t}\n\n\tprivate registerListeners(): void {\n\n\t\t// Window error conditions to handle\n\t\tthis._register(Event.fromNodeEventEmitter(this._win, 'unresponsive')(() => this.onWindowError(WindowError.UNRESPONSIVE)));\n\t\tthis._register(Event.fromNodeEventEmitter(this._win.webContents, 'render-process-gone', (event, details) => details)(details => this.onWindowError(WindowError.PROCESS_GONE, { ...details })));\n\t\tthis._register(Event.fromNodeEventEmitter(this._win.webContents, 'did-fail-load', (event, exitCode, reason) => ({ exitCode, reason }))(({ exitCode, reason }) => this.onWindowError(WindowError.LOAD, { reason, exitCode })));\n\n\t\t// Prevent windows/iframes from blocking the unload\n\t\t// through DOM events. We have our own logic for\n\t\t// unloading a window that should not be confused\n\t\t// with the DOM way.\n\t\t// (https://github.com/microsoft/vscode/issues/122736)\n\t\tthis._register(Event.fromNodeEventEmitter<electron.Event>(this._win.webContents, 'will-prevent-unload')(event => event.preventDefault()));\n\n\t\t// Remember that we loaded\n\t\tthis._register(Event.fromNodeEventEmitter(this._win.webContents, 'did-finish-load')(() => {\n\n\t\t\t// Associate properties from the load request if provided\n\t\t\tif (this.pendingLoadConfig) {\n\t\t\t\tthis._config = this.pendingLoadConfig;\n\n\t\t\t\tthis.pendingLoadConfig = undefined;\n\t\t\t}\n\t\t}));\n\n\t\t// Window (Un)Maximize\n\t\tthis._register(this.onDidMaximize(() => {\n\t\t\tif (this._config) {\n\t\t\t\tthis._config.maximized = true;\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(this.onDidUnmaximize(() => {\n\t\t\tif (this._config) {\n\t\t\t\tthis._config.maximized = false;\n\t\t\t}\n\t\t}));\n\n\t\t// Window Fullscreen\n\t\tthis._register(this.onDidEnterFullScreen(() => {\n\t\t\tthis.sendWhenReady('vscode:enterFullScreen', CancellationToken.None);\n\t\t}));\n\n\t\tthis._register(this.onDidLeaveFullScreen(() => {\n\t\t\tthis.sendWhenReady('vscode:leaveFullScreen', CancellationToken.None);\n\t\t}));\n\n\t\t// Handle configuration changes\n\t\tthis._register(this.configurationService.onDidChangeConfiguration(e => this.onConfigurationUpdated(e)));\n\n\t\t// Handle Workspace events\n\t\tthis._register(this.workspacesManagementMainService.onDidDeleteUntitledWorkspace(e => this.onDidDeleteUntitledWorkspace(e)));\n\n\t\t// Inject headers when requests are incoming\n\t\tconst urls = ['https://marketplace.visualstudio.com/*', 'https://*.vsassets.io/*'];\n\t\tthis._win.webContents.session.webRequest.onBeforeSendHeaders({ urls }, async (details, cb) => {\n\t\t\tconst headers = await this.getMarketplaceHeaders();\n\n\t\t\tcb({ cancel: false, requestHeaders: Object.assign(details.requestHeaders, headers) });\n\t\t});\n\t}\n\n\tprivate marketplaceHeadersPromise: Promise<object> | undefined;\n\tprivate getMarketplaceHeaders(): Promise<object> {\n\t\tif (!this.marketplaceHeadersPromise) {\n\t\t\tthis.marketplaceHeadersPromise = resolveMarketplaceHeaders(\n\t\t\t\tthis.productService.version,\n\t\t\t\tthis.productService,\n\t\t\t\tthis.environmentMainService,\n\t\t\t\tthis.configurationService,\n\t\t\t\tthis.fileService,\n\t\t\t\tthis.applicationStorageMainService,\n\t\t\t\tthis.telemetryService);\n\t\t}\n\n\t\treturn this.marketplaceHeadersPromise;\n\t}\n\n\tprivate async onWindowError(error: WindowError.UNRESPONSIVE): Promise<void>;\n\tprivate async onWindowError(error: WindowError.PROCESS_GONE, details: { reason: string; exitCode: number }): Promise<void>;\n\tprivate async onWindowError(error: WindowError.LOAD, details: { reason: string; exitCode: number }): Promise<void>;\n\tprivate async onWindowError(type: WindowError, details?: { reason?: string; exitCode?: number }): Promise<void> {\n\n\t\tswitch (type) {\n\t\t\tcase WindowError.PROCESS_GONE:\n\t\t\t\tthis.logService.error(`CodeWindow: renderer process gone (reason: ${details?.reason || '<unknown>'}, code: ${details?.exitCode || '<unknown>'})`);\n\t\t\t\tbreak;\n\t\t\tcase WindowError.UNRESPONSIVE:\n\t\t\t\tthis.logService.error('CodeWindow: detected unresponsive');\n\t\t\t\tbreak;\n\t\t\tcase WindowError.LOAD:\n\t\t\t\tthis.logService.error(`CodeWindow: failed to load (reason: ${details?.reason || '<unknown>'}, code: ${details?.exitCode || '<unknown>'})`);\n\t\t\t\tbreak;\n\t\t}\n\n\t\t// Telemetry\n\t\ttype WindowErrorClassification = {\n\t\t\ttype: { classification: 'SystemMetaData'; purpose: 'PerformanceAndHealth'; comment: 'The type of window error to understand the nature of the error better.' };\n\t\t\treason: { classification: 'SystemMetaData'; purpose: 'PerformanceAndHealth'; comment: 'The reason of the window error to understand the nature of the error better.' };\n\t\t\tcode: { classification: 'SystemMetaData'; purpose: 'PerformanceAndHealth'; comment: 'The exit code of the window process to understand the nature of the error better' };\n\t\t\towner: 'bpasero';\n\t\t\tcomment: 'Provides insight into reasons the vscode window had an error.';\n\t\t};\n\t\ttype WindowErrorEvent = {\n\t\t\ttype: WindowError;\n\t\t\treason: string | undefined;\n\t\t\tcode: number | undefined;\n\t\t};\n\t\tthis.telemetryService.publicLog2<WindowErrorEvent, WindowErrorClassification>('windowerror', {\n\t\t\ttype,\n\t\t\treason: details?.reason,\n\t\t\tcode: details?.exitCode\n\t\t});\n\n\t\t// Inform User if non-recoverable\n\t\tswitch (type) {\n\t\t\tcase WindowError.UNRESPONSIVE:\n\t\t\tcase WindowError.PROCESS_GONE:\n\n\t\t\t\t// If we run extension tests from CLI, we want to signal\n\t\t\t\t// back this state to the test runner by exiting with a\n\t\t\t\t// non-zero exit code.\n\t\t\t\tif (this.isExtensionDevelopmentTestFromCli) {\n\t\t\t\t\tthis.lifecycleMainService.kill(1);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// If we run smoke tests, want to proceed with an orderly\n\t\t\t\t// shutdown as much as possible by destroying the window\n\t\t\t\t// and then calling the normal `quit` routine.\n\t\t\t\tif (this.environmentMainService.args['enable-smoke-test-driver']) {\n\t\t\t\t\tawait this.destroyWindow(false, false);\n\t\t\t\t\tthis.lifecycleMainService.quit(); // still allow for an orderly shutdown\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// Unresponsive\n\t\t\t\tif (type === WindowError.UNRESPONSIVE) {\n\t\t\t\t\tif (this.isExtensionDevelopmentHost || this.isExtensionTestHost || (this._win && this._win.webContents && this._win.webContents.isDevToolsOpened())) {\n\t\t\t\t\t\t// TODO@electron Workaround for https://github.com/microsoft/vscode/issues/56994\n\t\t\t\t\t\t// In certain cases the window can report unresponsiveness because a breakpoint was hit\n\t\t\t\t\t\t// and the process is stopped executing. The most typical cases are:\n\t\t\t\t\t\t// - devtools are opened and debugging happens\n\t\t\t\t\t\t// - window is an extensions development host that is being debugged\n\t\t\t\t\t\t// - window is an extension test development host that is being debugged\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Show Dialog\n\t\t\t\t\tconst { response, checkboxChecked } = await this.dialogMainService.showMessageBox({\n\t\t\t\t\t\ttype: 'warning',\n\t\t\t\t\t\tbuttons: [\n\t\t\t\t\t\t\tlocalize({ key: 'reopen', comment: ['&& denotes a mnemonic'] }, \"&&Reopen\"),\n\t\t\t\t\t\t\tlocalize({ key: 'close', comment: ['&& denotes a mnemonic'] }, \"&&Close\"),\n\t\t\t\t\t\t\tlocalize({ key: 'wait', comment: ['&& denotes a mnemonic'] }, \"&&Keep Waiting\")\n\t\t\t\t\t\t],\n\t\t\t\t\t\tmessage: localize('appStalled', \"The window is not responding\"),\n\t\t\t\t\t\tdetail: localize('appStalledDetail', \"You can reopen or close the window or keep waiting.\"),\n\t\t\t\t\t\tcheckboxLabel: this._config?.workspace ? localize('doNotRestoreEditors', \"Don't restore editors\") : undefined\n\t\t\t\t\t}, this._win);\n\n\t\t\t\t\t// Handle choice\n\t\t\t\t\tif (response !== 2 /* keep waiting */) {\n\t\t\t\t\t\tconst reopen = response === 0;\n\t\t\t\t\t\tawait this.destroyWindow(reopen, checkboxChecked);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Process gone\n\t\t\t\telse if (type === WindowError.PROCESS_GONE) {\n\t\t\t\t\tlet message: string;\n\t\t\t\t\tif (!details) {\n\t\t\t\t\t\tmessage = localize('appGone', \"The window terminated unexpectedly\");\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmessage = localize('appGoneDetails', \"The window terminated unexpectedly (reason: '{0}', code: '{1}')\", details.reason, details.exitCode ?? '<unknown>');\n\t\t\t\t\t}\n\n\t\t\t\t\t// Show Dialog\n\t\t\t\t\tconst { response, checkboxChecked } = await this.dialogMainService.showMessageBox({\n\t\t\t\t\t\ttype: 'warning',\n\t\t\t\t\t\tbuttons: [\n\t\t\t\t\t\t\tthis._config?.workspace ? localize({ key: 'reopen', comment: ['&& denotes a mnemonic'] }, \"&&Reopen\") : localize({ key: 'newWindow', comment: ['&& denotes a mnemonic'] }, \"&&New Window\"),\n\t\t\t\t\t\t\tlocalize({ key: 'close', comment: ['&& denotes a mnemonic'] }, \"&&Close\")\n\t\t\t\t\t\t],\n\t\t\t\t\t\tmessage,\n\t\t\t\t\t\tdetail: this._config?.workspace ?\n\t\t\t\t\t\t\tlocalize('appGoneDetailWorkspace', \"We are sorry for the inconvenience. You can reopen the window to continue where you left off.\") :\n\t\t\t\t\t\t\tlocalize('appGoneDetailEmptyWindow', \"We are sorry for the inconvenience. You can open a new empty window to start again.\"),\n\t\t\t\t\t\tcheckboxLabel: this._config?.workspace ? localize('doNotRestoreEditors', \"Don't restore editors\") : undefined\n\t\t\t\t\t}, this._win);\n\n\t\t\t\t\t// Handle choice\n\t\t\t\t\tconst reopen = response === 0;\n\t\t\t\t\tawait this.destroyWindow(reopen, checkboxChecked);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tprivate async destroyWindow(reopen: boolean, skipRestoreEditors: boolean): Promise<void> {\n\t\tconst workspace = this._config?.workspace;\n\n\t\t// check to discard editor state first\n\t\tif (skipRestoreEditors && workspace) {\n\t\t\ttry {\n\t\t\t\tconst workspaceStorage = this.storageMainService.workspaceStorage(workspace);\n\t\t\t\tawait workspaceStorage.init();\n\t\t\t\tworkspaceStorage.delete('memento/workbench.parts.editor');\n\t\t\t\tawait workspaceStorage.close();\n\t\t\t} catch (error) {\n\t\t\t\tthis.logService.error(error);\n\t\t\t}\n\t\t}\n\n\t\t// 'close' event will not be fired on destroy(), so signal crash via explicit event\n\t\tthis._onDidDestroy.fire();\n\n\t\ttry {\n\t\t\t// ask the windows service to open a new fresh window if specified\n\t\t\tif (reopen && this._config) {\n\n\t\t\t\t// We have to reconstruct a openable from the current workspace\n\t\t\t\tlet uriToOpen: IWorkspaceToOpen | IFolderToOpen | undefined = undefined;\n\t\t\t\tlet forceEmpty = undefined;\n\t\t\t\tif (isSingleFolderWorkspaceIdentifier(workspace)) {\n\t\t\t\t\turiToOpen = { folderUri: workspace.uri };\n\t\t\t\t} else if (isWorkspaceIdentifier(workspace)) {\n\t\t\t\t\turiToOpen = { workspaceUri: workspace.configPath };\n\t\t\t\t} else {\n\t\t\t\t\tforceEmpty = true;\n\t\t\t\t}\n\n\t\t\t\t// Delegate to windows service\n\t\t\t\tconst window = (await this.windowsMainService.open({\n\t\t\t\t\tcontext: OpenContext.API,\n\t\t\t\t\tuserEnv: this._config.userEnv,\n\t\t\t\t\tcli: {\n\t\t\t\t\t\t...this.environmentMainService.args,\n\t\t\t\t\t\t_: [] // we pass in the workspace to open explicitly via `urisToOpen`\n\t\t\t\t\t},\n\t\t\t\t\turisToOpen: uriToOpen ? [uriToOpen] : undefined,\n\t\t\t\t\tforceEmpty,\n\t\t\t\t\tforceNewWindow: true,\n\t\t\t\t\tremoteAuthority: this.remoteAuthority\n\t\t\t\t})).at(0);\n\t\t\t\twindow?.focus();\n\t\t\t}\n\t\t} finally {\n\t\t\t// make sure to destroy the window as its renderer process is gone. do this\n\t\t\t// after the code for reopening the window, to prevent the entire application\n\t\t\t// from quitting when the last window closes as a result.\n\t\t\tthis._win?.destroy();\n\t\t}\n\t}\n\n\tprivate onDidDeleteUntitledWorkspace(workspace: IWorkspaceIdentifier): void {\n\n\t\t// Make sure to update our workspace config if we detect that it\n\t\t// was deleted\n\t\tif (this._config?.workspace?.id === workspace.id) {\n\t\t\tthis._config.workspace = undefined;\n\t\t}\n\t}\n\n\tprivate onConfigurationUpdated(e?: IConfigurationChangeEvent): void {\n\n\t\t// Menubar\n\t\tif (!e || e.affectsConfiguration('window.menuBarVisibility')) {\n\t\t\tconst newMenuBarVisibility = this.getMenuBarVisibility();\n\t\t\tif (newMenuBarVisibility !== this.currentMenuBarVisibility) {\n\t\t\t\tthis.currentMenuBarVisibility = newMenuBarVisibility;\n\t\t\t\tthis.setMenuBarVisibility(newMenuBarVisibility);\n\t\t\t}\n\t\t}\n\n\t\t// Proxy\n\t\tif (!e || e.affectsConfiguration('http.proxy') || e.affectsConfiguration('http.noProxy')) {\n\t\t\tlet newHttpProxy = (this.configurationService.getValue<string>('http.proxy') || '').trim()\n\t\t\t\t|| (process.env['https_proxy'] || process.env['HTTPS_PROXY'] || process.env['http_proxy'] || process.env['HTTP_PROXY'] || '').trim() // Not standardized.\n\t\t\t\t|| undefined;\n\n\t\t\tif (newHttpProxy?.indexOf('@') !== -1) {\n\t\t\t\tconst uri = URI.parse(newHttpProxy!);\n\t\t\t\tconst i = uri.authority.indexOf('@');\n\t\t\t\tif (i !== -1) {\n\t\t\t\t\tnewHttpProxy = uri.with({ authority: uri.authority.substring(i + 1) })\n\t\t\t\t\t\t.toString();\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (newHttpProxy?.endsWith('/')) {\n\t\t\t\tnewHttpProxy = newHttpProxy.substr(0, newHttpProxy.length - 1);\n\t\t\t}\n\n\t\t\tconst newNoProxy = (this.configurationService.getValue<string[]>('http.noProxy') || []).map((item) => item.trim()).join(',')\n\t\t\t\t|| (process.env['no_proxy'] || process.env['NO_PROXY'] || '').trim() || undefined; // Not standardized.\n\t\t\tif ((newHttpProxy || '').indexOf('@') === -1 && (newHttpProxy !== this.currentHttpProxy || newNoProxy !== this.currentNoProxy)) {\n\t\t\t\tthis.currentHttpProxy = newHttpProxy;\n\t\t\t\tthis.currentNoProxy = newNoProxy;\n\n\t\t\t\tconst proxyRules = newHttpProxy || '';\n\t\t\t\tconst proxyBypassRules = newNoProxy ? `${newNoProxy},<local>` : '<local>';\n\t\t\t\tthis.logService.trace(`Setting proxy to '${proxyRules}', bypassing '${proxyBypassRules}'`);\n\t\t\t\tthis._win.webContents.session.setProxy({ proxyRules, proxyBypassRules, pacScript: '' });\n\t\t\t\telectron.app.setProxy({ proxyRules, proxyBypassRules, pacScript: '' });\n\t\t\t}\n\t\t}\n\t}\n\n\taddTabbedWindow(window: ICodeWindow): void {\n\t\tif (isMacintosh && window.win) {\n\t\t\tthis._win.addTabbedWindow(window.win);\n\t\t}\n\t}\n\n\tload(configuration: INativeWindowConfiguration, options: ILoadOptions = Object.create(null)): void {\n\t\tthis.logService.trace(`window#load: attempt to load window (id: ${this._id})`);\n\n\t\t// Clear Document Edited if needed\n\t\tif (this.isDocumentEdited()) {\n\t\t\tif (!options.isReload || !this.backupMainService.isHotExitEnabled()) {\n\t\t\t\tthis.setDocumentEdited(false);\n\t\t\t}\n\t\t}\n\n\t\t// Clear Title and Filename if needed\n\t\tif (!options.isReload) {\n\t\t\tif (this.getRepresentedFilename()) {\n\t\t\t\tthis.setRepresentedFilename('');\n\t\t\t}\n\n\t\t\tthis._win.setTitle(this.productService.nameLong);\n\t\t}\n\n\t\t// Update configuration values based on our window context\n\t\t// and set it into the config object URL for usage.\n\t\tthis.updateConfiguration(configuration, options);\n\n\t\t// If this is the first time the window is loaded, we associate the paths\n\t\t// directly with the window because we assume the loading will just work\n\t\tif (this.readyState === ReadyState.NONE) {\n\t\t\tthis._config = configuration;\n\t\t}\n\n\t\t// Otherwise, the window is currently showing a folder and if there is an\n\t\t// unload handler preventing the load, we cannot just associate the paths\n\t\t// because the loading might be vetoed. Instead we associate it later when\n\t\t// the window load event has fired.\n\t\telse {\n\t\t\tthis.pendingLoadConfig = configuration;\n\t\t}\n\n\t\t// Indicate we are navigting now\n\t\tthis.readyState = ReadyState.NAVIGATING;\n\n\t\t// Load URL\n\t\tthis._win.loadURL(FileAccess.asBrowserUri(`vs/code/electron-sandbox/workbench/workbench${this.environmentMainService.isBuilt ? '' : '-dev'}.${isESM ? 'esm.' : ''}html`).toString(true));\n\n\t\t// Remember that we did load\n\t\tconst wasLoaded = this.wasLoaded;\n\t\tthis.wasLoaded = true;\n\n\t\t// Make window visible if it did not open in N seconds because this indicates an error\n\t\t// Only do this when running out of sources and not when running tests\n\t\tif (!this.environmentMainService.isBuilt && !this.environmentMainService.extensionTestsLocationURI) {\n\t\t\tthis._register(new RunOnceScheduler(() => {\n\t\t\t\tif (this._win && !this._win.isVisible() && !this._win.isMinimized()) {\n\t\t\t\t\tthis._win.show();\n\t\t\t\t\tthis.focus({ force: true });\n\t\t\t\t\tthis._win.webContents.openDevTools();\n\t\t\t\t}\n\t\t\t}, 10000)).schedule();\n\t\t}\n\n\t\t// Event\n\t\tthis._onWillLoad.fire({ workspace: configuration.workspace, reason: options.isReload ? LoadReason.RELOAD : wasLoaded ? LoadReason.LOAD : LoadReason.INITIAL });\n\t}\n\n\tprivate updateConfiguration(configuration: INativeWindowConfiguration, options: ILoadOptions): void {\n\n\t\t// If this window was loaded before from the command line\n\t\t// (as indicated by VSCODE_CLI environment), make sure to\n\t\t// preserve that user environment in subsequent loads,\n\t\t// unless the new configuration context was also a CLI\n\t\t// (for https://github.com/microsoft/vscode/issues/108571)\n\t\t// Also, preserve the environment if we're loading from an\n\t\t// extension development host that had its environment set\n\t\t// (for https://github.com/microsoft/vscode/issues/123508)\n\t\tconst currentUserEnv = (this._config ?? this.pendingLoadConfig)?.userEnv;\n\t\tif (currentUserEnv) {\n\t\t\tconst shouldPreserveLaunchCliEnvironment = isLaunchedFromCli(currentUserEnv) && !isLaunchedFromCli(configuration.userEnv);\n\t\t\tconst shouldPreserveDebugEnvironmnet = this.isExtensionDevelopmentHost;\n\t\t\tif (shouldPreserveLaunchCliEnvironment || shouldPreserveDebugEnvironmnet) {\n\t\t\t\tconfiguration.userEnv = { ...currentUserEnv, ...configuration.userEnv }; // still allow to override certain environment as passed in\n\t\t\t}\n\t\t}\n\n\t\t// If named pipe was instantiated for the crashpad_handler process, reuse the same\n\t\t// pipe for new app instances connecting to the original app instance.\n\t\t// Ref: https://github.com/microsoft/vscode/issues/115874\n\t\tif (process.env['CHROME_CRASHPAD_PIPE_NAME']) {\n\t\t\tObject.assign(configuration.userEnv, {\n\t\t\t\tCHROME_CRASHPAD_PIPE_NAME: process.env['CHROME_CRASHPAD_PIPE_NAME']\n\t\t\t});\n\t\t}\n\n\t\t// Add disable-extensions to the config, but do not preserve it on currentConfig or\n\t\t// pendingLoadConfig so that it is applied only on this load\n\t\tif (options.disableExtensions !== undefined) {\n\t\t\tconfiguration['disable-extensions'] = options.disableExtensions;\n\t\t}\n\n\t\t// Update window related properties\n\t\tconfiguration.fullscreen = this.isFullScreen;\n\t\tconfiguration.maximized = this._win.isMaximized();\n\t\tconfiguration.partsSplash = this.themeMainService.getWindowSplash();\n\t\tconfiguration.zoomLevel = this.getZoomLevel();\n\t\tconfiguration.isCustomZoomLevel = typeof this.customZoomLevel === 'number';\n\t\tif (configuration.isCustomZoomLevel && configuration.partsSplash) {\n\t\t\tconfiguration.partsSplash.zoomLevel = configuration.zoomLevel;\n\t\t}\n\n\t\t// Update with latest perf marks\n\t\tmark('code/willOpenNewWindow');\n\t\tconfiguration.perfMarks = getMarks();\n\n\t\t// Update in config object URL for usage in renderer\n\t\tthis.configObjectUrl.update(configuration);\n\t}\n\n\tasync reload(cli?: NativeParsedArgs): Promise<void> {\n\n\t\t// Copy our current config for reuse\n\t\tconst configuration = Object.assign({}, this._config);\n\n\t\t// Validate workspace\n\t\tconfiguration.workspace = await this.validateWorkspaceBeforeReload(configuration);\n\n\t\t// Delete some properties we do not want during reload\n\t\tdelete configuration.filesToOpenOrCreate;\n\t\tdelete configuration.filesToDiff;\n\t\tdelete configuration.filesToMerge;\n\t\tdelete configuration.filesToWait;\n\n\t\t// Some configuration things get inherited if the window is being reloaded and we are\n\t\t// in extension development mode. These options are all development related.\n\t\tif (this.isExtensionDevelopmentHost && cli) {\n\t\t\tconfiguration.verbose = cli.verbose;\n\t\t\tconfiguration.debugId = cli.debugId;\n\t\t\tconfiguration.extensionEnvironment = cli.extensionEnvironment;\n\t\t\tconfiguration['inspect-extensions'] = cli['inspect-extensions'];\n\t\t\tconfiguration['inspect-brk-extensions'] = cli['inspect-brk-extensions'];\n\t\t\tconfiguration['extensions-dir'] = cli['extensions-dir'];\n\t\t}\n\n\t\tconfiguration.accessibilitySupport = electron.app.isAccessibilitySupportEnabled();\n\t\tconfiguration.isInitialStartup = false; // since this is a reload\n\t\tconfiguration.policiesData = this.policyService.serialize(); // set policies data again\n\t\tconfiguration.continueOn = this.environmentMainService.continueOn;\n\t\tconfiguration.profiles = {\n\t\t\tall: this.userDataProfilesService.profiles,\n\t\t\tprofile: this.profile || this.userDataProfilesService.defaultProfile,\n\t\t\thome: this.userDataProfilesService.profilesHome\n\t\t};\n\t\tconfiguration.logLevel = this.loggerMainService.getLogLevel();\n\t\tconfiguration.loggers = {\n\t\t\twindow: this.loggerMainService.getRegisteredLoggers(this.id),\n\t\t\tglobal: this.loggerMainService.getRegisteredLoggers()\n\t\t};\n\n\t\t// Load config\n\t\tthis.load(configuration, { isReload: true, disableExtensions: cli?.['disable-extensions'] });\n\t}\n\n\tprivate async validateWorkspaceBeforeReload(configuration: INativeWindowConfiguration): Promise<IWorkspaceIdentifier | ISingleFolderWorkspaceIdentifier | undefined> {\n\n\t\t// Multi folder\n\t\tif (isWorkspaceIdentifier(configuration.workspace)) {\n\t\t\tconst configPath = configuration.workspace.configPath;\n\t\t\tif (configPath.scheme === Schemas.file) {\n\t\t\t\tconst workspaceExists = await this.fileService.exists(configPath);\n\t\t\t\tif (!workspaceExists) {\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Single folder\n\t\telse if (isSingleFolderWorkspaceIdentifier(configuration.workspace)) {\n\t\t\tconst uri = configuration.workspace.uri;\n\t\t\tif (uri.scheme === Schemas.file) {\n\t\t\t\tconst folderExists = await this.fileService.exists(uri);\n\t\t\t\tif (!folderExists) {\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Workspace is valid\n\t\treturn configuration.workspace;\n\t}\n\n\tserializeWindowState(): IWindowState {\n\t\tif (!this._win) {\n\t\t\treturn defaultWindowState();\n\t\t}\n\n\t\t// fullscreen gets special treatment\n\t\tif (this.isFullScreen) {\n\t\t\tlet display: electron.Display | undefined;\n\t\t\ttry {\n\t\t\t\tdisplay = electron.screen.getDisplayMatching(this.getBounds());\n\t\t\t} catch (error) {\n\t\t\t\t// Electron has weird conditions under which it throws errors\n\t\t\t\t// e.g. https://github.com/microsoft/vscode/issues/100334 when\n\t\t\t\t// large numbers are passed in\n\t\t\t}\n\n\t\t\tconst defaultState = defaultWindowState();\n\n\t\t\treturn {\n\t\t\t\tmode: WindowMode.Fullscreen,\n\t\t\t\tdisplay: display ? display.id : undefined,\n\n\t\t\t\t// Still carry over window dimensions from previous sessions\n\t\t\t\t// if we can compute it in fullscreen state.\n\t\t\t\t// does not seem possible in all cases on Linux for example\n\t\t\t\t// (https://github.com/microsoft/vscode/issues/58218) so we\n\t\t\t\t// fallback to the defaults in that case.\n\t\t\t\twidth: this.windowState.width || defaultState.width,\n\t\t\t\theight: this.windowState.height || defaultState.height,\n\t\t\t\tx: this.windowState.x || 0,\n\t\t\t\ty: this.windowState.y || 0,\n\t\t\t\tzoomLevel: this.customZoomLevel\n\t\t\t};\n\t\t}\n\n\t\tconst state: IWindowState = Object.create(null);\n\t\tlet mode: WindowMode;\n\n\t\t// get window mode\n\t\tif (!isMacintosh && this._win.isMaximized()) {\n\t\t\tmode = WindowMode.Maximized;\n\t\t} else {\n\t\t\tmode = WindowMode.Normal;\n\t\t}\n\n\t\t// we don't want to save minimized state, only maximized or normal\n\t\tif (mode === WindowMode.Maximized) {\n\t\t\tstate.mode = WindowMode.Maximized;\n\t\t} else {\n\t\t\tstate.mode = WindowMode.Normal;\n\t\t}\n\n\t\t// only consider non-minimized window states\n\t\tif (mode === WindowMode.Normal || mode === WindowMode.Maximized) {\n\t\t\tlet bounds: electron.Rectangle;\n\t\t\tif (mode === WindowMode.Normal) {\n\t\t\t\tbounds = this.getBounds();\n\t\t\t} else {\n\t\t\t\tbounds = this._win.getNormalBounds(); // make sure to persist the normal bounds when maximized to be able to restore them\n\t\t\t}\n\n\t\t\tstate.x = bounds.x;\n\t\t\tstate.y = bounds.y;\n\t\t\tstate.width = bounds.width;\n\t\t\tstate.height = bounds.height;\n\t\t}\n\n\t\tstate.zoomLevel = this.customZoomLevel;\n\n\t\treturn state;\n\t}\n\n\tprivate restoreWindowState(state?: IWindowState): [IWindowState, boolean? /* has multiple displays */] {\n\t\tmark('code/willRestoreCodeWindowState');\n\n\t\tlet hasMultipleDisplays = false;\n\t\tif (state) {\n\n\t\t\t// Window zoom\n\t\t\tthis.customZoomLevel = state.zoomLevel;\n\n\t\t\t// Window dimensions\n\t\t\ttry {\n\t\t\t\tconst displays = electron.screen.getAllDisplays();\n\t\t\t\thasMultipleDisplays = displays.length > 1;\n\n\t\t\t\tstate = WindowStateValidator.validateWindowState(this.logService, state, displays);\n\t\t\t} catch (err) {\n\t\t\t\tthis.logService.warn(`Unexpected error validating window state: ${err}\\n${err.stack}`); // somehow display API can be picky about the state to validate\n\t\t\t}\n\t\t}\n\n\t\tmark('code/didRestoreCodeWindowState');\n\n\t\treturn [state || defaultWindowState(), hasMultipleDisplays];\n\t}\n\n\tgetBounds(): electron.Rectangle {\n\t\tconst [x, y] = this._win.getPosition();\n\t\tconst [width, height] = this._win.getSize();\n\n\t\treturn { x, y, width, height };\n\t}\n\n\tprotected override setFullScreen(fullscreen: boolean, fromRestore: boolean): void {\n\t\tsuper.setFullScreen(fullscreen, fromRestore);\n\n\t\t// Events\n\t\tthis.sendWhenReady(fullscreen ? 'vscode:enterFullScreen' : 'vscode:leaveFullScreen', CancellationToken.None);\n\n\t\t// Respect configured menu bar visibility or default to toggle if not set\n\t\tif (this.currentMenuBarVisibility) {\n\t\t\tthis.setMenuBarVisibility(this.currentMenuBarVisibility, false);\n\t\t}\n\t}\n\n\tprivate getMenuBarVisibility(): MenuBarVisibility {\n\t\tlet menuBarVisibility = getMenuBarVisibility(this.configurationService);\n\t\tif (['visible', 'toggle', 'hidden'].indexOf(menuBarVisibility) < 0) {\n\t\t\tmenuBarVisibility = 'classic';\n\t\t}\n\n\t\treturn menuBarVisibility;\n\t}\n\n\tprivate setMenuBarVisibility(visibility: MenuBarVisibility, notify: boolean = true): void {\n\t\tif (isMacintosh) {\n\t\t\treturn; // ignore for macOS platform\n\t\t}\n\n\t\tif (visibility === 'toggle') {\n\t\t\tif (notify) {\n\t\t\t\tthis.send('vscode:showInfoMessage', localize('hiddenMenuBar', \"You can still access the menu bar by pressing the Alt-key.\"));\n\t\t\t}\n\t\t}\n\n\t\tif (visibility === 'hidden') {\n\t\t\t// for some weird reason that I have no explanation for, the menu bar is not hiding when calling\n\t\t\t// this without timeout (see https://github.com/microsoft/vscode/issues/19777). there seems to be\n\t\t\t// a timing issue with us opening the first window and the menu bar getting created. somehow the\n\t\t\t// fact that we want to hide the menu without being able to bring it back via Alt key makes Electron\n\t\t\t// still show the menu. Unable to reproduce from a simple Hello World application though...\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.doSetMenuBarVisibility(visibility);\n\t\t\t});\n\t\t} else {\n\t\t\tthis.doSetMenuBarVisibility(visibility);\n\t\t}\n\t}\n\n\tprivate doSetMenuBarVisibility(visibility: MenuBarVisibility): void {\n\t\tconst isFullscreen = this.isFullScreen;\n\n\t\tswitch (visibility) {\n\t\t\tcase ('classic'):\n\t\t\t\tthis._win.setMenuBarVisibility(!isFullscreen);\n\t\t\t\tthis._win.autoHideMenuBar = isFullscreen;\n\t\t\t\tbreak;\n\n\t\t\tcase ('visible'):\n\t\t\t\tthis._win.setMenuBarVisibility(true);\n\t\t\t\tthis._win.autoHideMenuBar = false;\n\t\t\t\tbreak;\n\n\t\t\tcase ('toggle'):\n\t\t\t\tthis._win.setMenuBarVisibility(false);\n\t\t\t\tthis._win.autoHideMenuBar = true;\n\t\t\t\tbreak;\n\n\t\t\tcase ('hidden'):\n\t\t\t\tthis._win.setMenuBarVisibility(false);\n\t\t\t\tthis._win.autoHideMenuBar = false;\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tnotifyZoomLevel(zoomLevel: number | undefined): void {\n\t\tthis.customZoomLevel = zoomLevel;\n\t}\n\n\tprivate getZoomLevel(): number | undefined {\n\t\tif (typeof this.customZoomLevel === 'number') {\n\t\t\treturn this.customZoomLevel;\n\t\t}\n\n\t\tconst windowSettings = this.configurationService.getValue<IWindowSettings | undefined>('window');\n\t\treturn windowSettings?.zoomLevel;\n\t}\n\n\tclose(): void {\n\t\tthis._win?.close();\n\t}\n\n\tsendWhenReady(channel: string, token: CancellationToken, ...args: any[]): void {\n\t\tif (this.isReady) {\n\t\t\tthis.send(channel, ...args);\n\t\t} else {\n\t\t\tthis.ready().then(() => {\n\t\t\t\tif (!token.isCancellationRequested) {\n\t\t\t\t\tthis.send(channel, ...args);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tsend(channel: string, ...args: any[]): void {\n\t\tif (this._win) {\n\t\t\tif (this._win.isDestroyed() || this._win.webContents.isDestroyed()) {\n\t\t\t\tthis.logService.warn(`Sending IPC message to channel '${channel}' for window that is destroyed`);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tthis._win.webContents.send(channel, ...args);\n\t\t\t} catch (error) {\n\t\t\t\tthis.logService.warn(`Error sending IPC message to channel '${channel}' of window ${this._id}: ${toErrorMessage(error)}`);\n\t\t\t}\n\t\t}\n\t}\n\n\tupdateTouchBar(groups: ISerializableCommandAction[][]): void {\n\t\tif (!isMacintosh) {\n\t\t\treturn; // only supported on macOS\n\t\t}\n\n\t\t// Update segments for all groups. Setting the segments property\n\t\t// of the group directly prevents ugly flickering from happening\n\t\tthis.touchBarGroups.forEach((touchBarGroup, index) => {\n\t\t\tconst commands = groups[index];\n\t\t\ttouchBarGroup.segments = this.createTouchBarGroupSegments(commands);\n\t\t});\n\t}\n\n\tprivate createTouchBar(): void {\n\t\tif (!isMacintosh) {\n\t\t\treturn; // only supported on macOS\n\t\t}\n\n\t\t// To avoid flickering, we try to reuse the touch bar group\n\t\t// as much as possible by creating a large number of groups\n\t\t// for reusing later.\n\t\tfor (let i = 0; i < 10; i++) {\n\t\t\tconst groupTouchBar = this.createTouchBarGroup();\n\t\t\tthis.touchBarGroups.push(groupTouchBar);\n\t\t}\n\n\t\tthis._win.setTouchBar(new electron.TouchBar({ items: this.touchBarGroups }));\n\t}\n\n\tprivate createTouchBarGroup(items: ISerializableCommandAction[] = []): electron.TouchBarSegmentedControl {\n\n\t\t// Group Segments\n\t\tconst segments = this.createTouchBarGroupSegments(items);\n\n\t\t// Group Control\n\t\tconst control = new electron.TouchBar.TouchBarSegmentedControl({\n\t\t\tsegments,\n\t\t\tmode: 'buttons',\n\t\t\tsegmentStyle: 'automatic',\n\t\t\tchange: (selectedIndex) => {\n\t\t\t\tthis.sendWhenReady('vscode:runAction', CancellationToken.None, { id: (control.segments[selectedIndex] as ITouchBarSegment).id, from: 'touchbar' });\n\t\t\t}\n\t\t});\n\n\t\treturn control;\n\t}\n\n\tprivate createTouchBarGroupSegments(items: ISerializableCommandAction[] = []): ITouchBarSegment[] {\n\t\tconst segments: ITouchBarSegment[] = items.map(item => {\n\t\t\tlet icon: electron.NativeImage | undefined;\n\t\t\tif (item.icon && !ThemeIcon.isThemeIcon(item.icon) && item.icon?.dark?.scheme === Schemas.file) {\n\t\t\t\ticon = electron.nativeImage.createFromPath(URI.revive(item.icon.dark).fsPath);\n\t\t\t\tif (icon.isEmpty()) {\n\t\t\t\t\ticon = undefined;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlet title: string;\n\t\t\tif (typeof item.title === 'string') {\n\t\t\t\ttitle = item.title;\n\t\t\t} else {\n\t\t\t\ttitle = item.title.value;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tid: item.id,\n\t\t\t\tlabel: !icon ? title : undefined,\n\t\t\t\ticon\n\t\t\t};\n\t\t});\n\n\t\treturn segments;\n\t}\n\n\tmatches(webContents: electron.WebContents): boolean {\n\t\treturn this._win?.webContents.id === webContents.id;\n\t}\n\n\toverride dispose(): void {\n\t\tsuper.dispose();\n\n\t\t// Deregister the loggers for this window\n\t\tthis.loggerMainService.deregisterLoggers(this.id);\n\t}\n}\n"],
  "mappings": "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",
  "names": ["ReadyState", "profile"]
}
