var Al=Object.create;var bi=Object.defineProperty;var Ks=Object.getOwnPropertyDescriptor;var Ml=Object.getOwnPropertyNames;var Fl=Object.getPrototypeOf,Ul=Object.prototype.hasOwnProperty;var Nl=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports);var Bl=(n,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Ml(e))!Ul.call(n,i)&&i!==t&&bi(n,i,{get:()=>e[i],enumerable:!(r=Ks(e,i))||r.enumerable});return n};var Wl=(n,e,t)=>(t=n!=null?Al(Fl(n)):{},Bl(e||!n||!n.__esModule?bi(t,"default",{value:n,enumerable:!0}):t,n));var b=(n,e,t,r)=>{for(var i=r>1?void 0:r?Ks(e,t):e,s=n.length-1,o;s>=0;s--)(o=n[s])&&(i=(r?o(e,t,i):o(i))||i);return r&&i&&bi(e,t,i),i},we=(n,e)=>(t,r)=>e(t,r,n);var ha=Nl((Hb,ma)=>{"use strict";function Uc(n,e){var t=n;e.slice(0,-1).forEach(function(i){t=t[i]||{}});var r=e[e.length-1];return r in t}function pa(n){return typeof n=="number"||/^0x[0-9a-f]+$/i.test(n)?!0:/^[-+]?(?:\d+(?:\.\d*)?|\.\d+)(e[-+]?\d+)?$/.test(n)}function fa(n,e){return e==="constructor"&&typeof n[e]=="function"||e==="__proto__"}ma.exports=function(n,e){e||(e={});var t={bools:{},strings:{},unknownFn:null};typeof e.unknown=="function"&&(t.unknownFn=e.unknown),typeof e.boolean=="boolean"&&e.boolean?t.allBools=!0:[].concat(e.boolean).filter(Boolean).forEach(function(g){t.bools[g]=!0});var r={};function i(g){return r[g].some(function(P){return t.bools[P]})}Object.keys(e.alias||{}).forEach(function(g){r[g]=[].concat(e.alias[g]),r[g].forEach(function(P){r[P]=[g].concat(r[g].filter(function(W){return P!==W}))})}),[].concat(e.string).filter(Boolean).forEach(function(g){t.strings[g]=!0,r[g]&&[].concat(r[g]).forEach(function(P){t.strings[P]=!0})});var s=e.default||{},o={_:[]};function l(g,P){return t.allBools&&/^--[^=]+$/.test(P)||t.strings[g]||t.bools[g]||r[g]}function c(g,P,W){for(var F=g,Ee=0;Ee<P.length-1;Ee++){var me=P[Ee];if(fa(F,me))return;F[me]===void 0&&(F[me]={}),(F[me]===Object.prototype||F[me]===Number.prototype||F[me]===String.prototype)&&(F[me]={}),F[me]===Array.prototype&&(F[me]=[]),F=F[me]}var Pe=P[P.length-1];fa(F,Pe)||((F===Object.prototype||F===Number.prototype||F===String.prototype)&&(F={}),F===Array.prototype&&(F=[]),F[Pe]===void 0||t.bools[Pe]||typeof F[Pe]=="boolean"?F[Pe]=W:Array.isArray(F[Pe])?F[Pe].push(W):F[Pe]=[F[Pe],W])}function u(g,P,W){if(!(W&&t.unknownFn&&!l(g,W)&&t.unknownFn(W)===!1)){var F=!t.strings[g]&&pa(P)?Number(P):P;c(o,g.split("."),F),(r[g]||[]).forEach(function(Ee){c(o,Ee.split("."),F)})}}Object.keys(t.bools).forEach(function(g){u(g,s[g]===void 0?!1:s[g])});var d=[];n.indexOf("--")!==-1&&(d=n.slice(n.indexOf("--")+1),n=n.slice(0,n.indexOf("--")));for(var p=0;p<n.length;p++){var f=n[p],m,h;if(/^--.+=/.test(f)){var _=f.match(/^--([^=]+)=([\s\S]*)$/);m=_[1];var T=_[2];t.bools[m]&&(T=T!=="false"),u(m,T,f)}else if(/^--no-.+/.test(f))m=f.match(/^--no-(.+)/)[1],u(m,!1,f);else if(/^--.+/.test(f))m=f.match(/^--(.+)/)[1],h=n[p+1],h!==void 0&&!/^(-|--)[^-]/.test(h)&&!t.bools[m]&&!t.allBools&&(!r[m]||!i(m))?(u(m,h,f),p+=1):/^(true|false)$/.test(h)?(u(m,h==="true",f),p+=1):u(m,t.strings[m]?"":!0,f);else if(/^-[^-]+/.test(f)){for(var A=f.slice(1,-1).split(""),$=!1,S=0;S<A.length;S++){if(h=f.slice(S+2),h==="-"){u(A[S],h,f);continue}if(/[A-Za-z]/.test(A[S])&&h[0]==="="){u(A[S],h.slice(1),f),$=!0;break}if(/[A-Za-z]/.test(A[S])&&/-?\d+(\.\d*)?(e-?\d+)?$/.test(h)){u(A[S],h,f),$=!0;break}if(A[S+1]&&A[S+1].match(/\W/)){u(A[S],f.slice(S+2),f),$=!0;break}else u(A[S],t.strings[A[S]]?"":!0,f)}m=f.slice(-1)[0],!$&&m!=="-"&&(n[p+1]&&!/^(-|--)[^-]/.test(n[p+1])&&!t.bools[m]&&(!r[m]||!i(m))?(u(m,n[p+1],f),p+=1):n[p+1]&&/^(true|false)$/.test(n[p+1])?(u(m,n[p+1]==="true",f),p+=1):u(m,t.strings[m]?"":!0,f))}else if((!t.unknownFn||t.unknownFn(f)!==!1)&&o._.push(t.strings._||!pa(f)?f:Number(f)),e.stopEarly){o._.push.apply(o._,n.slice(p+1));break}}return Object.keys(s).forEach(function(g){Uc(o,g.split("."))||(c(o,g.split("."),s[g]),(r[g]||[]).forEach(function(P){c(o,P.split("."),s[g])}))}),e["--"]?o["--"]=d.slice():d.forEach(function(g){o._.push(g)}),o}});var Ne=class{constructor(e){this.executor=e}_didRun=!1;_value;_error;get hasValue(){return this._didRun}get value(){if(!this._didRun)try{this._value=this.executor()}catch(e){this._error=e}finally{this._didRun=!0}if(this._error)throw this._error;return this._value}get rawValue(){return this._value}};var yi=class{unexpectedErrorHandler;listeners;constructor(){this.listeners=[],this.unexpectedErrorHandler=function(e){setTimeout(()=>{throw e.stack?Ae.isErrorNoTelemetry(e)?new Ae(e.message+`

`+e.stack):new Error(e.message+`

`+e.stack):e},0)}}addListener(e){return this.listeners.push(e),()=>{this._removeListener(e)}}emit(e){this.listeners.forEach(t=>{t(e)})}_removeListener(e){this.listeners.splice(this.listeners.indexOf(e),1)}setUnexpectedErrorHandler(e){this.unexpectedErrorHandler=e}getUnexpectedErrorHandler(){return this.unexpectedErrorHandler}onUnexpectedError(e){this.unexpectedErrorHandler(e),this.emit(e)}onUnexpectedExternalError(e){this.unexpectedErrorHandler(e)}},qs=new yi;function Rt(n){qs.onUnexpectedError(n)}function Be(n){Vl(n)||qs.onUnexpectedError(n)}var vi="Canceled";function Vl(n){return n instanceof ge?!0:n instanceof Error&&n.name===vi&&n.message===vi}var ge=class extends Error{constructor(){super(vi),this.name=this.message}};function zs(n){return n?new Error(`Illegal state: ${n}`):new Error("Illegal state")}var Ae=class n extends Error{name;constructor(e){super(e),this.name="CodeExpectedError"}static fromError(e){if(e instanceof n)return e;let t=new n;return t.message=e.message,t.stack=e.stack,t}static isErrorNoTelemetry(e){return e.name==="CodeExpectedError"}},Pt=class n extends Error{constructor(e){super(e||"An unexpected bug occurred."),Object.setPrototypeOf(this,n.prototype)}};function Xn(n,e){let t=this,r=!1,i;return function(){if(r)return i;if(r=!0,e)try{i=n.apply(t,arguments)}finally{e()}else i=n.apply(t,arguments);return i}}function js(n){return n.filter(e=>!!e)}function Gs(n){return n[Math.floor(Math.random()*n.length)]}var Xs;(l=>{function n(c){return c<0}l.isLessThan=n;function e(c){return c<=0}l.isLessThanOrEqual=e;function t(c){return c>0}l.isGreaterThan=t;function r(c){return c===0}l.isNeitherLessOrGreaterThan=r,l.greaterThan=1,l.lessThan=-1,l.neitherLessOrGreaterThan=0})(Xs||={});var Hs=class n{constructor(e){this.iterate=e}static empty=new n(e=>{});forEach(e){this.iterate(t=>(e(t),!0))}toArray(){let e=[];return this.iterate(t=>(e.push(t),!0)),e}filter(e){return new n(t=>this.iterate(r=>e(r)?t(r):!0))}map(e){return new n(t=>this.iterate(r=>t(e(r))))}some(e){let t=!1;return this.iterate(r=>(t=e(r),!t)),t}findFirst(e){let t;return this.iterate(r=>e(r)?(t=r,!1):!0),t}findLast(e){let t;return this.iterate(r=>(e(r)&&(t=r),!0)),t}findLastMaxBy(e){let t,r=!0;return this.iterate(i=>((r||Xs.isGreaterThan(e(i,t)))&&(r=!1,t=i),!0)),t}};function xi(){return globalThis._VSCODE_NLS_MESSAGES}function nn(){return globalThis._VSCODE_NLS_LANGUAGE}var Kl=nn()==="pseudo"||typeof document<"u"&&document.location&&document.location.hash.indexOf("pseudo=true")>=0;function Qn(n,e){let t;return e.length===0?t=n:t=n.replace(/\{(\d+)\}/g,(r,i)=>{let s=i[0],o=e[s],l=r;return typeof o=="string"?l=o:(typeof o=="number"||typeof o=="boolean"||o===void 0||o===null)&&(l=String(o)),l}),Kl&&(t="\uFF3B"+t.replace(/[aouei]/g,"$&$&")+"\uFF3D"),t}function v(n,e,...t){return Qn(typeof n=="number"?Js(n,e):e,t)}function Js(n,e){let t=xi()?.[n];if(typeof t!="string"){if(typeof e=="string")return e;throw new Error(`!!! NLS MISSING: ${n} !!!`)}return t}function dt(n,e,...t){let r;typeof n=="number"?r=Js(n,e):r=e;let i=Qn(r,t);return{value:i,original:e===r?i:Qn(e,t)}}var kt="en",sn=!1,on=!1,rn=!1,ql=!1,Zs=!1,Ii=!1,zl=!1,eo=!1,$l=!1,Hl=!1,Yn,Zn=kt,Ys=kt,jl,We,Ve=globalThis,_e;typeof Ve.vscode<"u"&&typeof Ve.vscode.process<"u"?_e=Ve.vscode.process:typeof process<"u"&&typeof process?.versions?.node=="string"&&(_e=process);var to=typeof _e?.versions?.electron=="string",Gl=to&&_e?.type==="renderer";if(typeof _e=="object"){sn=_e.platform==="win32",on=_e.platform==="darwin",rn=_e.platform==="linux",ql=rn&&!!_e.env.SNAP&&!!_e.env.SNAP_REVISION,zl=to,$l=!!_e.env.CI||!!_e.env.BUILD_ARTIFACTSTAGINGDIRECTORY,Yn=kt,Zn=kt;let n=_e.env.VSCODE_NLS_CONFIG;if(n)try{let e=JSON.parse(n);Yn=e.userLocale,Ys=e.osLocale,Zn=e.resolvedLanguage||kt,jl=e.languagePack?.translationsConfigFile}catch{}Zs=!0}else typeof navigator=="object"&&!Gl?(We=navigator.userAgent,sn=We.indexOf("Windows")>=0,on=We.indexOf("Macintosh")>=0,eo=(We.indexOf("Macintosh")>=0||We.indexOf("iPad")>=0||We.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,rn=We.indexOf("Linux")>=0,Hl=We?.indexOf("Mobi")>=0,Ii=!0,Zn=nn()||kt,Yn=navigator.language.toLowerCase(),Ys=Yn):console.error("Unable to resolve platform.");var er=0;on?er=1:sn?er=3:rn&&(er=2);var D=sn,be=on,Ce=rn;var no=Zs;var Dt=Ii,Xl=Ii&&typeof Ve.importScripts=="function",ro=Xl?Ve.origin:void 0;var io=er,Me=We,je=Zn,Ql;(r=>{function n(){return je}r.value=n;function e(){return je.length===2?je==="en":je.length>=3?je[0]==="e"&&je[1]==="n"&&je[2]==="-":!1}r.isDefaultVariant=e;function t(){return je==="en"}r.isDefault=t})(Ql||={});var Jl=typeof Ve.postMessage=="function"&&!Ve.importScripts,so=(()=>{if(Jl){let n=[];Ve.addEventListener("message",t=>{if(t.data&&t.data.vscodeScheduleAsyncWork)for(let r=0,i=n.length;r<i;r++){let s=n[r];if(s.id===t.data.vscodeScheduleAsyncWork){n.splice(r,1),s.callback();return}}});let e=0;return t=>{let r=++e;n.push({id:r,callback:t}),Ve.postMessage({vscodeScheduleAsyncWork:r},"*")}}return n=>setTimeout(n)})();var tr=on||eo?2:sn?1:3;var _i=!!(Me&&Me.indexOf("Chrome")>=0),oo=!!(Me&&Me.indexOf("Firefox")>=0),ao=!!(!_i&&Me&&Me.indexOf("Safari")>=0),lo=!!(Me&&Me.indexOf("Edg/")>=0),Cp=!!(Me&&Me.indexOf("Android")>=0);var pt,Ei=globalThis.vscode;if(typeof Ei<"u"&&typeof Ei.process<"u"){let n=Ei.process;pt={get platform(){return n.platform},get arch(){return n.arch},get env(){return n.env},cwd(){return n.cwd()}}}else typeof process<"u"&&typeof process?.versions?.node=="string"?pt={get platform(){return process.platform},get arch(){return process.arch},get env(){return process.env},cwd(){return process.env.VSCODE_CWD||process.cwd()}}:pt={get platform(){return D?"win32":be?"darwin":"linux"},get arch(){},get env(){return{}},cwd(){return"/"}};var Ke=pt.cwd,de=pt.env,nr=pt.platform,Rp=pt.arch;var Yl=65,Zl=97,eu=90,tu=122,Qe=46,se=47,ye=92,Ge=58,nu=63,rr=class extends Error{code;constructor(e,t,r){let i;typeof t=="string"&&t.indexOf("not ")===0?(i="must not be",t=t.replace(/^not /,"")):i="must be";let s=e.indexOf(".")!==-1?"property":"argument",o=`The "${e}" ${s} ${i} of type ${t}`;o+=`. Received type ${typeof r}`,super(o),this.code="ERR_INVALID_ARG_TYPE"}};function ru(n,e){if(n===null||typeof n!="object")throw new rr(e,"Object",n)}function Z(n,e){if(typeof n!="string")throw new rr(e,"string",n)}var ve=nr==="win32";function B(n){return n===se||n===ye}function Ci(n){return n===se}function Xe(n){return n>=Yl&&n<=eu||n>=Zl&&n<=tu}function ir(n,e,t,r){let i="",s=0,o=-1,l=0,c=0;for(let u=0;u<=n.length;++u){if(u<n.length)c=n.charCodeAt(u);else{if(r(c))break;c=se}if(r(c)){if(!(o===u-1||l===1))if(l===2){if(i.length<2||s!==2||i.charCodeAt(i.length-1)!==Qe||i.charCodeAt(i.length-2)!==Qe){if(i.length>2){let d=i.lastIndexOf(t);d===-1?(i="",s=0):(i=i.slice(0,d),s=i.length-1-i.lastIndexOf(t)),o=u,l=0;continue}else if(i.length!==0){i="",s=0,o=u,l=0;continue}}e&&(i+=i.length>0?`${t}..`:"..",s=2)}else i.length>0?i+=`${t}${n.slice(o+1,u)}`:i=n.slice(o+1,u),s=u-o-1;o=u,l=0}else c===Qe&&l!==-1?++l:l=-1}return i}function iu(n){return n?`${n[0]==="."?"":"."}${n}`:""}function uo(n,e){ru(e,"pathObject");let t=e.dir||e.root,r=e.base||`${e.name||""}${iu(e.ext)}`;return t?t===e.root?`${t}${r}`:`${t}${n}${r}`:r}var ee={resolve(...n){let e="",t="",r=!1;for(let i=n.length-1;i>=-1;i--){let s;if(i>=0){if(s=n[i],Z(s,`paths[${i}]`),s.length===0)continue}else e.length===0?s=Ke():(s=de[`=${e}`]||Ke(),(s===void 0||s.slice(0,2).toLowerCase()!==e.toLowerCase()&&s.charCodeAt(2)===ye)&&(s=`${e}\\`));let o=s.length,l=0,c="",u=!1,d=s.charCodeAt(0);if(o===1)B(d)&&(l=1,u=!0);else if(B(d))if(u=!0,B(s.charCodeAt(1))){let p=2,f=p;for(;p<o&&!B(s.charCodeAt(p));)p++;if(p<o&&p!==f){let m=s.slice(f,p);for(f=p;p<o&&B(s.charCodeAt(p));)p++;if(p<o&&p!==f){for(f=p;p<o&&!B(s.charCodeAt(p));)p++;(p===o||p!==f)&&(c=`\\\\${m}\\${s.slice(f,p)}`,l=p)}}}else l=1;else Xe(d)&&s.charCodeAt(1)===Ge&&(c=s.slice(0,2),l=2,o>2&&B(s.charCodeAt(2))&&(u=!0,l=3));if(c.length>0)if(e.length>0){if(c.toLowerCase()!==e.toLowerCase())continue}else e=c;if(r){if(e.length>0)break}else if(t=`${s.slice(l)}\\${t}`,r=u,u&&e.length>0)break}return t=ir(t,!r,"\\",B),r?`${e}\\${t}`:`${e}${t}`||"."},normalize(n){Z(n,"path");let e=n.length;if(e===0)return".";let t=0,r,i=!1,s=n.charCodeAt(0);if(e===1)return Ci(s)?"\\":n;if(B(s))if(i=!0,B(n.charCodeAt(1))){let l=2,c=l;for(;l<e&&!B(n.charCodeAt(l));)l++;if(l<e&&l!==c){let u=n.slice(c,l);for(c=l;l<e&&B(n.charCodeAt(l));)l++;if(l<e&&l!==c){for(c=l;l<e&&!B(n.charCodeAt(l));)l++;if(l===e)return`\\\\${u}\\${n.slice(c)}\\`;l!==c&&(r=`\\\\${u}\\${n.slice(c,l)}`,t=l)}}}else t=1;else Xe(s)&&n.charCodeAt(1)===Ge&&(r=n.slice(0,2),t=2,e>2&&B(n.charCodeAt(2))&&(i=!0,t=3));let o=t<e?ir(n.slice(t),!i,"\\",B):"";return o.length===0&&!i&&(o="."),o.length>0&&B(n.charCodeAt(e-1))&&(o+="\\"),r===void 0?i?`\\${o}`:o:i?`${r}\\${o}`:`${r}${o}`},isAbsolute(n){Z(n,"path");let e=n.length;if(e===0)return!1;let t=n.charCodeAt(0);return B(t)||e>2&&Xe(t)&&n.charCodeAt(1)===Ge&&B(n.charCodeAt(2))},join(...n){if(n.length===0)return".";let e,t;for(let s=0;s<n.length;++s){let o=n[s];Z(o,"path"),o.length>0&&(e===void 0?e=t=o:e+=`\\${o}`)}if(e===void 0)return".";let r=!0,i=0;if(typeof t=="string"&&B(t.charCodeAt(0))){++i;let s=t.length;s>1&&B(t.charCodeAt(1))&&(++i,s>2&&(B(t.charCodeAt(2))?++i:r=!1))}if(r){for(;i<e.length&&B(e.charCodeAt(i));)i++;i>=2&&(e=`\\${e.slice(i)}`)}return ee.normalize(e)},relative(n,e){if(Z(n,"from"),Z(e,"to"),n===e)return"";let t=ee.resolve(n),r=ee.resolve(e);if(t===r||(n=t.toLowerCase(),e=r.toLowerCase(),n===e))return"";let i=0;for(;i<n.length&&n.charCodeAt(i)===ye;)i++;let s=n.length;for(;s-1>i&&n.charCodeAt(s-1)===ye;)s--;let o=s-i,l=0;for(;l<e.length&&e.charCodeAt(l)===ye;)l++;let c=e.length;for(;c-1>l&&e.charCodeAt(c-1)===ye;)c--;let u=c-l,d=o<u?o:u,p=-1,f=0;for(;f<d;f++){let h=n.charCodeAt(i+f);if(h!==e.charCodeAt(l+f))break;h===ye&&(p=f)}if(f!==d){if(p===-1)return r}else{if(u>d){if(e.charCodeAt(l+f)===ye)return r.slice(l+f+1);if(f===2)return r.slice(l+f)}o>d&&(n.charCodeAt(i+f)===ye?p=f:f===2&&(p=3)),p===-1&&(p=0)}let m="";for(f=i+p+1;f<=s;++f)(f===s||n.charCodeAt(f)===ye)&&(m+=m.length===0?"..":"\\..");return l+=p,m.length>0?`${m}${r.slice(l,c)}`:(r.charCodeAt(l)===ye&&++l,r.slice(l,c))},toNamespacedPath(n){if(typeof n!="string"||n.length===0)return n;let e=ee.resolve(n);if(e.length<=2)return n;if(e.charCodeAt(0)===ye){if(e.charCodeAt(1)===ye){let t=e.charCodeAt(2);if(t!==nu&&t!==Qe)return`\\\\?\\UNC\\${e.slice(2)}`}}else if(Xe(e.charCodeAt(0))&&e.charCodeAt(1)===Ge&&e.charCodeAt(2)===ye)return`\\\\?\\${e}`;return n},dirname(n){Z(n,"path");let e=n.length;if(e===0)return".";let t=-1,r=0,i=n.charCodeAt(0);if(e===1)return B(i)?n:".";if(B(i)){if(t=r=1,B(n.charCodeAt(1))){let l=2,c=l;for(;l<e&&!B(n.charCodeAt(l));)l++;if(l<e&&l!==c){for(c=l;l<e&&B(n.charCodeAt(l));)l++;if(l<e&&l!==c){for(c=l;l<e&&!B(n.charCodeAt(l));)l++;if(l===e)return n;l!==c&&(t=r=l+1)}}}}else Xe(i)&&n.charCodeAt(1)===Ge&&(t=e>2&&B(n.charCodeAt(2))?3:2,r=t);let s=-1,o=!0;for(let l=e-1;l>=r;--l)if(B(n.charCodeAt(l))){if(!o){s=l;break}}else o=!1;if(s===-1){if(t===-1)return".";s=t}return n.slice(0,s)},basename(n,e){e!==void 0&&Z(e,"suffix"),Z(n,"path");let t=0,r=-1,i=!0,s;if(n.length>=2&&Xe(n.charCodeAt(0))&&n.charCodeAt(1)===Ge&&(t=2),e!==void 0&&e.length>0&&e.length<=n.length){if(e===n)return"";let o=e.length-1,l=-1;for(s=n.length-1;s>=t;--s){let c=n.charCodeAt(s);if(B(c)){if(!i){t=s+1;break}}else l===-1&&(i=!1,l=s+1),o>=0&&(c===e.charCodeAt(o)?--o===-1&&(r=s):(o=-1,r=l))}return t===r?r=l:r===-1&&(r=n.length),n.slice(t,r)}for(s=n.length-1;s>=t;--s)if(B(n.charCodeAt(s))){if(!i){t=s+1;break}}else r===-1&&(i=!1,r=s+1);return r===-1?"":n.slice(t,r)},extname(n){Z(n,"path");let e=0,t=-1,r=0,i=-1,s=!0,o=0;n.length>=2&&n.charCodeAt(1)===Ge&&Xe(n.charCodeAt(0))&&(e=r=2);for(let l=n.length-1;l>=e;--l){let c=n.charCodeAt(l);if(B(c)){if(!s){r=l+1;break}continue}i===-1&&(s=!1,i=l+1),c===Qe?t===-1?t=l:o!==1&&(o=1):t!==-1&&(o=-1)}return t===-1||i===-1||o===0||o===1&&t===i-1&&t===r+1?"":n.slice(t,i)},format:uo.bind(null,"\\"),parse(n){Z(n,"path");let e={root:"",dir:"",base:"",ext:"",name:""};if(n.length===0)return e;let t=n.length,r=0,i=n.charCodeAt(0);if(t===1)return B(i)?(e.root=e.dir=n,e):(e.base=e.name=n,e);if(B(i)){if(r=1,B(n.charCodeAt(1))){let p=2,f=p;for(;p<t&&!B(n.charCodeAt(p));)p++;if(p<t&&p!==f){for(f=p;p<t&&B(n.charCodeAt(p));)p++;if(p<t&&p!==f){for(f=p;p<t&&!B(n.charCodeAt(p));)p++;p===t?r=p:p!==f&&(r=p+1)}}}}else if(Xe(i)&&n.charCodeAt(1)===Ge){if(t<=2)return e.root=e.dir=n,e;if(r=2,B(n.charCodeAt(2))){if(t===3)return e.root=e.dir=n,e;r=3}}r>0&&(e.root=n.slice(0,r));let s=-1,o=r,l=-1,c=!0,u=n.length-1,d=0;for(;u>=r;--u){if(i=n.charCodeAt(u),B(i)){if(!c){o=u+1;break}continue}l===-1&&(c=!1,l=u+1),i===Qe?s===-1?s=u:d!==1&&(d=1):s!==-1&&(d=-1)}return l!==-1&&(s===-1||d===0||d===1&&s===l-1&&s===o+1?e.base=e.name=n.slice(o,l):(e.name=n.slice(o,s),e.base=n.slice(o,l),e.ext=n.slice(s,l))),o>0&&o!==r?e.dir=n.slice(0,o-1):e.dir=e.root,e},sep:"\\",delimiter:";",win32:null,posix:null},su=(()=>{if(ve){let n=/\\/g;return()=>{let e=Ke().replace(n,"/");return e.slice(e.indexOf("/"))}}return()=>Ke()})(),K={resolve(...n){let e="",t=!1;for(let r=n.length-1;r>=-1&&!t;r--){let i=r>=0?n[r]:su();Z(i,`paths[${r}]`),i.length!==0&&(e=`${i}/${e}`,t=i.charCodeAt(0)===se)}return e=ir(e,!t,"/",Ci),t?`/${e}`:e.length>0?e:"."},normalize(n){if(Z(n,"path"),n.length===0)return".";let e=n.charCodeAt(0)===se,t=n.charCodeAt(n.length-1)===se;return n=ir(n,!e,"/",Ci),n.length===0?e?"/":t?"./":".":(t&&(n+="/"),e?`/${n}`:n)},isAbsolute(n){return Z(n,"path"),n.length>0&&n.charCodeAt(0)===se},join(...n){if(n.length===0)return".";let e;for(let t=0;t<n.length;++t){let r=n[t];Z(r,"path"),r.length>0&&(e===void 0?e=r:e+=`/${r}`)}return e===void 0?".":K.normalize(e)},relative(n,e){if(Z(n,"from"),Z(e,"to"),n===e||(n=K.resolve(n),e=K.resolve(e),n===e))return"";let t=1,r=n.length,i=r-t,s=1,o=e.length-s,l=i<o?i:o,c=-1,u=0;for(;u<l;u++){let p=n.charCodeAt(t+u);if(p!==e.charCodeAt(s+u))break;p===se&&(c=u)}if(u===l)if(o>l){if(e.charCodeAt(s+u)===se)return e.slice(s+u+1);if(u===0)return e.slice(s+u)}else i>l&&(n.charCodeAt(t+u)===se?c=u:u===0&&(c=0));let d="";for(u=t+c+1;u<=r;++u)(u===r||n.charCodeAt(u)===se)&&(d+=d.length===0?"..":"/..");return`${d}${e.slice(s+c)}`},toNamespacedPath(n){return n},dirname(n){if(Z(n,"path"),n.length===0)return".";let e=n.charCodeAt(0)===se,t=-1,r=!0;for(let i=n.length-1;i>=1;--i)if(n.charCodeAt(i)===se){if(!r){t=i;break}}else r=!1;return t===-1?e?"/":".":e&&t===1?"//":n.slice(0,t)},basename(n,e){e!==void 0&&Z(e,"ext"),Z(n,"path");let t=0,r=-1,i=!0,s;if(e!==void 0&&e.length>0&&e.length<=n.length){if(e===n)return"";let o=e.length-1,l=-1;for(s=n.length-1;s>=0;--s){let c=n.charCodeAt(s);if(c===se){if(!i){t=s+1;break}}else l===-1&&(i=!1,l=s+1),o>=0&&(c===e.charCodeAt(o)?--o===-1&&(r=s):(o=-1,r=l))}return t===r?r=l:r===-1&&(r=n.length),n.slice(t,r)}for(s=n.length-1;s>=0;--s)if(n.charCodeAt(s)===se){if(!i){t=s+1;break}}else r===-1&&(i=!1,r=s+1);return r===-1?"":n.slice(t,r)},extname(n){Z(n,"path");let e=-1,t=0,r=-1,i=!0,s=0;for(let o=n.length-1;o>=0;--o){let l=n.charCodeAt(o);if(l===se){if(!i){t=o+1;break}continue}r===-1&&(i=!1,r=o+1),l===Qe?e===-1?e=o:s!==1&&(s=1):e!==-1&&(s=-1)}return e===-1||r===-1||s===0||s===1&&e===r-1&&e===t+1?"":n.slice(e,r)},format:uo.bind(null,"/"),parse(n){Z(n,"path");let e={root:"",dir:"",base:"",ext:"",name:""};if(n.length===0)return e;let t=n.charCodeAt(0)===se,r;t?(e.root="/",r=1):r=0;let i=-1,s=0,o=-1,l=!0,c=n.length-1,u=0;for(;c>=r;--c){let d=n.charCodeAt(c);if(d===se){if(!l){s=c+1;break}continue}o===-1&&(l=!1,o=c+1),d===Qe?i===-1?i=c:u!==1&&(u=1):i!==-1&&(u=-1)}if(o!==-1){let d=s===0&&t?1:s;i===-1||u===0||u===1&&i===o-1&&i===s+1?e.base=e.name=n.slice(d,o):(e.name=n.slice(d,i),e.base=n.slice(d,o),e.ext=n.slice(i,o))}return s>0?e.dir=n.slice(0,s-1):t&&(e.dir="/"),e},sep:"/",delimiter:":",win32:null,posix:null};K.win32=ee.win32=ee;K.posix=ee.posix=K;var Je=ve?ee.normalize:K.normalize,ft=ve?ee.isAbsolute:K.isAbsolute,k=ve?ee.join:K.join,Lt=ve?ee.resolve:K.resolve,co=ve?ee.relative:K.relative,Re=ve?ee.dirname:K.dirname,mt=ve?ee.basename:K.basename,po=ve?ee.extname:K.extname,kp=ve?ee.format:K.format,fo=ve?ee.parse:K.parse,Dp=ve?ee.toNamespacedPath:K.toNamespacedPath,Ye=ve?ee.sep:K.sep,Ot=ve?ee.delimiter:K.delimiter;var ou=/^\w[\w\d+.-]*$/,au=/^\//,lu=/^\/\//;function uu(n,e){if(!n.scheme&&e)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${n.authority}", path: "${n.path}", query: "${n.query}", fragment: "${n.fragment}"}`);if(n.scheme&&!ou.test(n.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(n.path){if(n.authority){if(!au.test(n.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(lu.test(n.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}function cu(n,e){return!n&&!e?"file":n}function du(n,e){switch(n){case"https":case"http":case"file":e?e[0]!==ke&&(e=ke+e):e=ke;break}return e}var Q="",ke="/",pu=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/,R=class n{static isUri(e){return e instanceof n?!0:e?typeof e.authority=="string"&&typeof e.fragment=="string"&&typeof e.path=="string"&&typeof e.query=="string"&&typeof e.scheme=="string"&&typeof e.fsPath=="string"&&typeof e.with=="function"&&typeof e.toString=="function":!1}scheme;authority;path;query;fragment;constructor(e,t,r,i,s,o=!1){typeof e=="object"?(this.scheme=e.scheme||Q,this.authority=e.authority||Q,this.path=e.path||Q,this.query=e.query||Q,this.fragment=e.fragment||Q):(this.scheme=cu(e,o),this.authority=t||Q,this.path=du(this.scheme,r||Q),this.query=i||Q,this.fragment=s||Q,uu(this,o))}get fsPath(){return an(this,!1)}with(e){if(!e)return this;let{scheme:t,authority:r,path:i,query:s,fragment:o}=e;return t===void 0?t=this.scheme:t===null&&(t=Q),r===void 0?r=this.authority:r===null&&(r=Q),i===void 0?i=this.path:i===null&&(i=Q),s===void 0?s=this.query:s===null&&(s=Q),o===void 0?o=this.fragment:o===null&&(o=Q),t===this.scheme&&r===this.authority&&i===this.path&&s===this.query&&o===this.fragment?this:new Ze(t,r,i,s,o)}static parse(e,t=!1){let r=pu.exec(e);return r?new Ze(r[2]||Q,sr(r[4]||Q),sr(r[5]||Q),sr(r[7]||Q),sr(r[9]||Q),t):new Ze(Q,Q,Q,Q,Q)}static file(e){let t=Q;if(D&&(e=e.replace(/\\/g,ke)),e[0]===ke&&e[1]===ke){let r=e.indexOf(ke,2);r===-1?(t=e.substring(2),e=ke):(t=e.substring(2,r),e=e.substring(r)||ke)}return new Ze("file",t,e,Q,Q)}static from(e,t){return new Ze(e.scheme,e.authority,e.path,e.query,e.fragment,t)}static joinPath(e,...t){if(!e.path)throw new Error("[UriError]: cannot call joinPath on URI without path");let r;return D&&e.scheme==="file"?r=n.file(ee.join(an(e,!0),...t)).path:r=K.join(e.path,...t),e.with({path:r})}toString(e=!1){return Si(this,e)}toJSON(){return this}static revive(e){if(e){if(e instanceof n)return e;{let t=new Ze(e);return t._formatted=e.external??null,t._fsPath=e._sep===bo?e.fsPath??null:null,t}}else return e}[Symbol.for("debug.description")](){return`URI(${this.toString()})`}};var bo=D?1:void 0,Ze=class extends R{_formatted=null;_fsPath=null;get fsPath(){return this._fsPath||(this._fsPath=an(this,!1)),this._fsPath}toString(e=!1){return e?Si(this,!0):(this._formatted||(this._formatted=Si(this,!1)),this._formatted)}toJSON(){let e={$mid:1};return this._fsPath&&(e.fsPath=this._fsPath,e._sep=bo),this._formatted&&(e.external=this._formatted),this.path&&(e.path=this.path),this.scheme&&(e.scheme=this.scheme),this.authority&&(e.authority=this.authority),this.query&&(e.query=this.query),this.fragment&&(e.fragment=this.fragment),e}},yo={58:"%3A",47:"%2F",63:"%3F",35:"%23",91:"%5B",93:"%5D",64:"%40",33:"%21",36:"%24",38:"%26",39:"%27",40:"%28",41:"%29",42:"%2A",43:"%2B",44:"%2C",59:"%3B",61:"%3D",32:"%20"};function mo(n,e,t){let r,i=-1;for(let s=0;s<n.length;s++){let o=n.charCodeAt(s);if(o>=97&&o<=122||o>=65&&o<=90||o>=48&&o<=57||o===45||o===46||o===95||o===126||e&&o===47||t&&o===91||t&&o===93||t&&o===58)i!==-1&&(r+=encodeURIComponent(n.substring(i,s)),i=-1),r!==void 0&&(r+=n.charAt(s));else{r===void 0&&(r=n.substr(0,s));let l=yo[o];l!==void 0?(i!==-1&&(r+=encodeURIComponent(n.substring(i,s)),i=-1),r+=l):i===-1&&(i=s)}}return i!==-1&&(r+=encodeURIComponent(n.substring(i))),r!==void 0?r:n}function fu(n){let e;for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);r===35||r===63?(e===void 0&&(e=n.substr(0,t)),e+=yo[r]):e!==void 0&&(e+=n[t])}return e!==void 0?e:n}function an(n,e){let t;return n.authority&&n.path.length>1&&n.scheme==="file"?t=`//${n.authority}${n.path}`:n.path.charCodeAt(0)===47&&(n.path.charCodeAt(1)>=65&&n.path.charCodeAt(1)<=90||n.path.charCodeAt(1)>=97&&n.path.charCodeAt(1)<=122)&&n.path.charCodeAt(2)===58?e?t=n.path.substr(1):t=n.path[1].toLowerCase()+n.path.substr(2):t=n.path,D&&(t=t.replace(/\//g,"\\")),t}function Si(n,e){let t=e?fu:mo,r="",{scheme:i,authority:s,path:o,query:l,fragment:c}=n;if(i&&(r+=i,r+=":"),(s||i==="file")&&(r+=ke,r+=ke),s){let u=s.indexOf("@");if(u!==-1){let d=s.substr(0,u);s=s.substr(u+1),u=d.lastIndexOf(":"),u===-1?r+=t(d,!1,!1):(r+=t(d.substr(0,u),!1,!1),r+=":",r+=t(d.substr(u+1),!1,!0)),r+="@"}s=s.toLowerCase(),u=s.lastIndexOf(":"),u===-1?r+=t(s,!1,!0):(r+=t(s.substr(0,u),!1,!0),r+=s.substr(u))}if(o){if(o.length>=3&&o.charCodeAt(0)===47&&o.charCodeAt(2)===58){let u=o.charCodeAt(1);u>=65&&u<=90&&(o=`/${String.fromCharCode(u+32)}:${o.substr(3)}`)}else if(o.length>=2&&o.charCodeAt(1)===58){let u=o.charCodeAt(0);u>=65&&u<=90&&(o=`${String.fromCharCode(u+32)}:${o.substr(2)}`)}r+=t(o,!0,!1)}return l&&(r+="?",r+=t(l,!1,!1)),c&&(r+="#",r+=e?c:mo(c,!1,!1)),r}function vo(n){try{return decodeURIComponent(n)}catch{return n.length>3?n.substr(0,3)+vo(n.substr(3)):n}}var ho=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function sr(n){return n.match(ho)?n.replace(ho,e=>vo(e)):n}var Pi=class{constructor(e,t){this.uri=e;this.value=t}};function mu(n){return Array.isArray(n)}var or=class n{static defaultToKey=e=>e.toString();[Symbol.toStringTag]="ResourceMap";map;toKey;constructor(e,t){if(e instanceof n)this.map=new Map(e.map),this.toKey=t??n.defaultToKey;else if(mu(e)){this.map=new Map,this.toKey=t??n.defaultToKey;for(let[r,i]of e)this.set(r,i)}else this.map=new Map,this.toKey=e??n.defaultToKey}set(e,t){return this.map.set(this.toKey(e),new Pi(e,t)),this}get(e){return this.map.get(this.toKey(e))?.value}has(e){return this.map.has(this.toKey(e))}get size(){return this.map.size}clear(){this.map.clear()}delete(e){return this.map.delete(this.toKey(e))}forEach(e,t){typeof t<"u"&&(e=e.bind(t));for(let[r,i]of this.map)e(i.value,i.uri,this)}*values(){for(let e of this.map.values())yield e.value}*keys(){for(let e of this.map.values())yield e.uri}*entries(){for(let e of this.map.values())yield[e.uri,e.value]}*[Symbol.iterator](){for(let[,e]of this.map)yield[e.uri,e.value]}};var Ri=class{[Symbol.toStringTag]="LinkedMap";_map;_head;_tail;_size;_state;constructor(){this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(e){return this._map.has(e)}get(e,t=0){let r=this._map.get(e);if(r)return t!==0&&this.touch(r,t),r.value}set(e,t,r=0){let i=this._map.get(e);if(i)i.value=t,r!==0&&this.touch(i,r);else{switch(i={key:e,value:t,next:void 0,previous:void 0},r){case 0:this.addItemLast(i);break;case 1:this.addItemFirst(i);break;case 2:this.addItemLast(i);break;default:this.addItemLast(i);break}this._map.set(e,i),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){let t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");let e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){let r=this._state,i=this._head;for(;i;){if(t?e.bind(t)(i.value,i.key,this):e(i.value,i.key,this),this._state!==r)throw new Error("LinkedMap got modified during iteration.");i=i.next}}keys(){let e=this,t=this._state,r=this._head,i={[Symbol.iterator](){return i},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(r){let s={value:r.key,done:!1};return r=r.next,s}else return{value:void 0,done:!0}}};return i}values(){let e=this,t=this._state,r=this._head,i={[Symbol.iterator](){return i},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(r){let s={value:r.value,done:!1};return r=r.next,s}else return{value:void 0,done:!0}}};return i}entries(){let e=this,t=this._state,r=this._head,i={[Symbol.iterator](){return i},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(r){let s={value:[r.key,r.value],done:!1};return r=r.next,s}else return{value:void 0,done:!0}}};return i}[Symbol.iterator](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._head,r=this.size;for(;t&&r>e;)this._map.delete(t.key),t=t.next,r--;this._head=t,this._size=r,t&&(t.previous=void 0),this._state++}trimNew(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._tail,r=this.size;for(;t&&r>e;)this._map.delete(t.key),t=t.previous,r--;this._tail=t,this._size=r,t&&(t.next=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{let t=e.next,r=e.previous;if(!t||!r)throw new Error("Invalid list");t.previous=r,r.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(t!==1&&t!==2)){if(t===1){if(e===this._head)return;let r=e.next,i=e.previous;e===this._tail?(i.next=void 0,this._tail=i):(r.previous=i,i.next=r),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===2){if(e===this._tail)return;let r=e.next,i=e.previous;e===this._head?(r.previous=void 0,this._head=r):(r.previous=i,i.next=r),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){let e=[];return this.forEach((t,r)=>{e.push([r,t])}),e}fromJSON(e){this.clear();for(let[t,r]of e)this.set(t,r)}},ki=class extends Ri{_limit;_ratio;constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,t=2){return super.get(e,t)}peek(e){return super.get(e,0)}set(e,t){return super.set(e,t,2),this}checkTrim(){this.size>this._limit&&this.trim(Math.round(this._limit*this._ratio))}},qe=class extends ki{constructor(e,t=1){super(e,t)}trim(e){this.trimOld(e)}set(e,t){return super.set(e,t),this.checkTrim(),this}};var ln;(S=>{function n(g){return g&&typeof g=="object"&&typeof g[Symbol.iterator]=="function"}S.is=n;let e=Object.freeze([]);function t(){return e}S.empty=t;function*r(g){yield g}S.single=r;function i(g){return n(g)?g:r(g)}S.wrap=i;function s(g){return g||e}S.from=s;function*o(g){for(let P=g.length-1;P>=0;P--)yield g[P]}S.reverse=o;function l(g){return!g||g[Symbol.iterator]().next().done===!0}S.isEmpty=l;function c(g){return g[Symbol.iterator]().next().value}S.first=c;function u(g,P){let W=0;for(let F of g)if(P(F,W++))return!0;return!1}S.some=u;function d(g,P){for(let W of g)if(P(W))return W}S.find=d;function*p(g,P){for(let W of g)P(W)&&(yield W)}S.filter=p;function*f(g,P){let W=0;for(let F of g)yield P(F,W++)}S.map=f;function*m(g,P){let W=0;for(let F of g)yield*P(F,W++)}S.flatMap=m;function*h(...g){for(let P of g)yield*P}S.concat=h;function _(g,P,W){let F=W;for(let Ee of g)F=P(F,Ee);return F}S.reduce=_;function*T(g,P,W=g.length){for(P<0&&(P+=g.length),W<0?W+=g.length:W>g.length&&(W=g.length);P<W;P++)yield g[P]}S.slice=T;function A(g,P=Number.POSITIVE_INFINITY){let W=[];if(P===0)return[W,g];let F=g[Symbol.iterator]();for(let Ee=0;Ee<P;Ee++){let me=F.next();if(me.done)return[W,S.empty()];W.push(me.value)}return[W,{[Symbol.iterator](){return F}}]}S.consume=A;async function $(g){let P=[];for await(let W of g)P.push(W);return Promise.resolve(P)}S.asyncToArray=$})(ln||={});var hu=!1,At=null;function gu(n){At=n}if(hu){let n="__is_disposable_tracked__";gu(new class{trackDisposable(e){let t=new Error("Potentially leaked disposable").stack;setTimeout(()=>{e[n]||console.log(t)},3e3)}setParent(e,t){if(e&&e!==O.None)try{e[n]=!0}catch{}}markAsDisposed(e){if(e&&e!==O.None)try{e[n]=!0}catch{}}markAsSingleton(e){}})}function gt(n){return At?.trackDisposable(n),n}function bt(n){At?.markAsDisposed(n)}function un(n,e){At?.setParent(n,e)}function bu(n,e){if(At)for(let t of n)At.setParent(t,e)}function Se(n){if(ln.is(n)){let e=[];for(let t of n)if(t)try{t.dispose()}catch(r){e.push(r)}if(e.length===1)throw e[0];if(e.length>1)throw new AggregateError(e,"Encountered errors while disposing of store");return Array.isArray(n)?[]:n}else if(n)return n.dispose(),n}function lr(...n){let e=X(()=>Se(n));return bu(n,e),e}function X(n){let e=gt({dispose:Xn(()=>{bt(e),n()})});return e}var ue=class n{static DISABLE_DISPOSED_WARNING=!1;_toDispose=new Set;_isDisposed=!1;constructor(){gt(this)}dispose(){this._isDisposed||(bt(this),this._isDisposed=!0,this.clear())}get isDisposed(){return this._isDisposed}clear(){if(this._toDispose.size!==0)try{Se(this._toDispose)}finally{this._toDispose.clear()}}add(e){if(!e)return e;if(e===this)throw new Error("Cannot register a disposable on itself!");return un(e,this),this._isDisposed?n.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this._toDispose.add(e),e}delete(e){if(e){if(e===this)throw new Error("Cannot dispose a disposable on itself!");this._toDispose.delete(e),e.dispose()}}deleteAndLeak(e){e&&this._toDispose.has(e)&&(this._toDispose.delete(e),un(e,null))}},O=class{static None=Object.freeze({dispose(){}});_store=new ue;constructor(){gt(this),un(this._store,this)}dispose(){bt(this),this._store.dispose()}_register(e){if(e===this)throw new Error("Cannot register a disposable on itself!");return this._store.add(e)}},Mt=class{_value;_isDisposed=!1;constructor(){gt(this)}get value(){return this._isDisposed?void 0:this._value}set value(e){this._isDisposed||e===this._value||(this._value?.dispose(),e&&un(e,this),this._value=e)}clear(){this.value=void 0}dispose(){this._isDisposed=!0,bt(this),this._value?.dispose(),this._value=void 0}clearAndLeak(){let e=this._value;return this._value=void 0,e&&un(e,null),e}},ar=class{_disposable=new Mt;_isDisposed=!1;constructor(e){this._disposable.value=e}get value(){return this._disposable.value}set value(e){this._isDisposed||e===this._disposable.value||(this._disposable.value=e)}dispose(){this._isDisposed=!0,this._disposable.dispose()}};var cn=class{_store=new Map;_isDisposed=!1;constructor(){gt(this)}dispose(){bt(this),this._isDisposed=!0,this.clearAndDisposeAll()}clearAndDisposeAll(){if(this._store.size)try{Se(this._store.values())}finally{this._store.clear()}}has(e){return this._store.has(e)}get size(){return this._store.size}get(e){return this._store.get(e)}set(e,t,r=!1){this._isDisposed&&console.warn(new Error("Trying to add a disposable to a DisposableMap that has already been disposed of. The added object will be leaked!").stack),r||this._store.get(e)?.dispose(),this._store.set(e,t)}deleteAndDispose(e){this._store.get(e)?.dispose(),this._store.delete(e)}deleteAndLeak(e){let t=this._store.get(e);return this._store.delete(e),t}keys(){return this._store.keys()}values(){return this._store.values()}[Symbol.iterator](){return this._store[Symbol.iterator]()}};var J=class n{static Undefined=new n(void 0);element;next;prev;constructor(e){this.element=e,this.next=n.Undefined,this.prev=n.Undefined}},dn=class{_first=J.Undefined;_last=J.Undefined;_size=0;get size(){return this._size}isEmpty(){return this._first===J.Undefined}clear(){let e=this._first;for(;e!==J.Undefined;){let t=e.next;e.prev=J.Undefined,e.next=J.Undefined,e=t}this._first=J.Undefined,this._last=J.Undefined,this._size=0}unshift(e){return this._insert(e,!1)}push(e){return this._insert(e,!0)}_insert(e,t){let r=new J(e);if(this._first===J.Undefined)this._first=r,this._last=r;else if(t){let s=this._last;this._last=r,r.prev=s,s.next=r}else{let s=this._first;this._first=r,r.next=s,s.prev=r}this._size+=1;let i=!1;return()=>{i||(i=!0,this._remove(r))}}shift(){if(this._first!==J.Undefined){let e=this._first.element;return this._remove(this._first),e}}pop(){if(this._last!==J.Undefined){let e=this._last.element;return this._remove(this._last),e}}_remove(e){if(e.prev!==J.Undefined&&e.next!==J.Undefined){let t=e.prev;t.next=e.next,e.next.prev=t}else e.prev===J.Undefined&&e.next===J.Undefined?(this._first=J.Undefined,this._last=J.Undefined):e.next===J.Undefined?(this._last=this._last.prev,this._last.next=J.Undefined):e.prev===J.Undefined&&(this._first=this._first.next,this._first.prev=J.Undefined);this._size-=1}*[Symbol.iterator](){let e=this._first;for(;e!==J.Undefined;)yield e.element,e=e.next}};var yt=(n,e)=>n===e;var De=class{constructor(e,t,r){this.owner=e;this.debugNameSource=t;this.referenceFn=r}getDebugName(e){return To(e,this)}},xo=new Map,Di=new WeakMap;function To(n,e){let t=Di.get(n);if(t)return t;let r=vu(n,e);if(r){let i=xo.get(r)??0;i++,xo.set(r,i);let s=i===1?r:`${r}#${i}`;return Di.set(n,s),s}}function vu(n,e){let t=Di.get(n);if(t)return t;let r=e.owner?Iu(e.owner)+".":"",i,s=e.debugNameSource;if(s!==void 0)if(typeof s=="function"){if(i=s(),i!==void 0)return r+i}else return r+s;let o=e.referenceFn;if(o!==void 0&&(i=ur(o),i!==void 0))return r+i;if(e.owner!==void 0){let l=xu(e.owner,n);if(l!==void 0)return r+l}}function xu(n,e){for(let t in n)if(n[t]===e)return t}var Io=new Map,_o=new WeakMap;function Iu(n){let e=_o.get(n);if(e)return e;let t=_u(n),r=Io.get(t)??0;r++,Io.set(t,r);let i=r===1?t:`${t}#${r}`;return _o.set(n,i),i}function _u(n){let e=n.constructor;return e?e.name:"Object"}function ur(n){let e=n.toString(),r=/\/\*\*\s*@description\s*([^*]*)\*\//.exec(e);return(r?r[1]:void 0)?.trim()}function cr(n,e){if(!n)throw new Error(e?`Assertion failed (${e})`:"Assertion Failed")}function dr(n){if(!n()){debugger;n(),Be(new Pt("Assertion Failed"))}}function pn(n){return new pr(new De(void 0,void 0,n),n,void 0,void 0)}var pr=class{constructor(e,t,r,i){this._debugNameData=e;this._runFn=t;this.createChangeSummary=r;this._handleChange=i;this.changeSummary=this.createChangeSummary?.(),Te()?.handleAutorunCreated(this),this._runIfNeeded(),gt(this)}state=2;updateCount=0;disposed=!1;dependencies=new Set;dependenciesToBeRemoved=new Set;changeSummary;get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}dispose(){this.disposed=!0;for(let e of this.dependencies)e.removeObserver(this);this.dependencies.clear(),bt(this)}_runIfNeeded(){if(this.state===3)return;let e=this.dependenciesToBeRemoved;this.dependenciesToBeRemoved=this.dependencies,this.dependencies=e,this.state=3;let t=this.disposed;try{if(!t){Te()?.handleAutorunTriggered(this);let r=this.changeSummary;try{this.changeSummary=this.createChangeSummary?.(),this._runFn(this,r)}catch(i){Rt(i)}}}finally{t||Te()?.handleAutorunFinished(this);for(let r of this.dependenciesToBeRemoved)r.removeObserver(this);this.dependenciesToBeRemoved.clear()}}toString(){return`Autorun<${this.debugName}>`}beginUpdate(){this.state===3&&(this.state=1),this.updateCount++}endUpdate(){try{if(this.updateCount===1)do{if(this.state===1){this.state=3;for(let e of this.dependencies)if(e.reportChanges(),this.state===2)break}this._runIfNeeded()}while(this.state!==3)}finally{this.updateCount--}dr(()=>this.updateCount>=0)}handlePossibleChange(e){this.state===3&&this.dependencies.has(e)&&!this.dependenciesToBeRemoved.has(e)&&(this.state=1)}handleChange(e,t){if(this.dependencies.has(e)&&!this.dependenciesToBeRemoved.has(e))try{(this._handleChange?this._handleChange({changedObservable:e,change:t,didChange:i=>i===e},this.changeSummary):!0)&&(this.state=2)}catch(r){Rt(r)}}readObservable(e){if(this.disposed)return e.get();e.addObserver(this);let t=e.get();return this.dependencies.add(e),this.dependenciesToBeRemoved.delete(e),t}};(e=>e.Observer=pr)(pn||={});function Li(n,e){return new fr(new De(n.owner,n.debugName,n.debugReferenceFn),e,void 0,void 0,n.onLastObserverRemoved,n.equalsFn??yt)}Eo(Li);var fr=class extends vt{constructor(t,r,i,s,o=void 0,l){super();this._debugNameData=t;this._computeFn=r;this.createChangeSummary=i;this._handleChange=s;this._handleLastObserverRemoved=o;this._equalityComparator=l;this.changeSummary=this.createChangeSummary?.(),Te()?.handleDerivedCreated(this)}state=0;value=void 0;updateCount=0;dependencies=new Set;dependenciesToBeRemoved=new Set;changeSummary=void 0;get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}onLastObserverRemoved(){this.state=0,this.value=void 0;for(let t of this.dependencies)t.removeObserver(this);this.dependencies.clear(),this._handleLastObserverRemoved?.()}get(){if(this.observers.size===0){let t=this._computeFn(this,this.createChangeSummary?.());return this.onLastObserverRemoved(),t}else{do{if(this.state===1){for(let t of this.dependencies)if(t.reportChanges(),this.state===2)break}this.state===1&&(this.state=3),this._recomputeIfNeeded()}while(this.state!==3);return this.value}}_recomputeIfNeeded(){if(this.state===3)return;let t=this.dependenciesToBeRemoved;this.dependenciesToBeRemoved=this.dependencies,this.dependencies=t;let r=this.state!==0,i=this.value;this.state=3;let s=!1;try{let o=this.changeSummary;this.changeSummary=this.createChangeSummary?.();try{this.value=this._computeFn(this,o)}finally{for(let l of this.dependenciesToBeRemoved)l.removeObserver(this);this.dependenciesToBeRemoved.clear()}s=r&&!this._equalityComparator(i,this.value),Te()?.handleDerivedRecomputed(this,{oldValue:i,newValue:this.value,change:void 0,didChange:s,hadValue:r})}catch(o){Rt(o)}if(s)for(let o of this.observers)o.handleChange(this,void 0)}toString(){return`LazyDerived<${this.debugName}>`}beginUpdate(t){this.updateCount++;let r=this.updateCount===1;if(this.state===3&&(this.state=1,!r))for(let i of this.observers)i.handlePossibleChange(this);if(r)for(let i of this.observers)i.beginUpdate(this)}endUpdate(t){if(this.updateCount--,this.updateCount===0){let r=[...this.observers];for(let i of r)i.endUpdate(this)}dr(()=>this.updateCount>=0)}handlePossibleChange(t){if(this.state===3&&this.dependencies.has(t)&&!this.dependenciesToBeRemoved.has(t)){this.state=1;for(let r of this.observers)r.handlePossibleChange(this)}}handleChange(t,r){if(this.dependencies.has(t)&&!this.dependenciesToBeRemoved.has(t)){let i=!1;try{i=this._handleChange?this._handleChange({changedObservable:t,change:r,didChange:o=>o===t},this.changeSummary):!0}catch(o){Rt(o)}let s=this.state===3;if(i&&(this.state===1||s)&&(this.state=2,s))for(let o of this.observers)o.handlePossibleChange(this)}}readObservable(t){t.addObserver(this);let r=t.get();return this.dependencies.add(t),this.dependenciesToBeRemoved.delete(t),r}addObserver(t){let r=!this.observers.has(t)&&this.updateCount>0;super.addObserver(t),r&&t.beginUpdate(this)}removeObserver(t){let r=this.observers.has(t)&&this.updateCount>0;super.removeObserver(t),r&&t.endUpdate(this)}};function Oi(...n){let e,t,r;return n.length===3?[e,t,r]=n:[t,r]=n,new tt(new De(e,void 0,r),t,r,()=>tt.globalTransaction,yt)}var tt=class extends vt{constructor(t,r,i,s,o){super();this._debugNameData=t;this.event=r;this._getValue=i;this._getTransaction=s;this._equalityComparator=o}static globalTransaction;value;hasValue=!1;subscription;getDebugName(){return this._debugNameData.getDebugName(this)}get debugName(){let t=this.getDebugName();return"From Event"+(t?`: ${t}`:"")}onFirstObserverAdded(){this.subscription=this.event(this.handleEvent)}handleEvent=t=>{let r=this._getValue(t),i=this.value,s=!this.hasValue||!this._equalityComparator(i,r),o=!1;s&&(this.value=r,this.hasValue&&(o=!0,Ai(this._getTransaction(),l=>{Te()?.handleFromEventObservableTriggered(this,{oldValue:i,newValue:r,change:void 0,didChange:s,hadValue:this.hasValue});for(let c of this.observers)l.updateObserver(c,this),c.handleChange(this,void 0)},()=>{let l=this.getDebugName();return"Event fired"+(l?`: ${l}`:"")})),this.hasValue=!0),o||Te()?.handleFromEventObservableTriggered(this,{oldValue:i,newValue:r,change:void 0,didChange:s,hadValue:this.hasValue})};onLastObserverRemoved(){this.subscription.dispose(),this.subscription=void 0,this.hasValue=!1,this.value=void 0}get(){return this.subscription?(this.hasValue||this.handleEvent(void 0),this.value):this._getValue(void 0)}};(t=>{t.Observer=tt;function e(r,i){let s=!1;tt.globalTransaction===void 0&&(tt.globalTransaction=r,s=!0);try{i()}finally{s&&(tt.globalTransaction=void 0)}}t.batchEventsGlobally=e})(Oi||={});function Co(n){let e=new mr(!1,void 0);return n.addObserver(e),X(()=>{n.removeObserver(e)})}Ro(Co);function So(n,e){let t=new mr(!0,e);return n.addObserver(t),e?e(n.get()):n.reportChanges(),X(()=>{n.removeObserver(t)})}Po(So);var mr=class{constructor(e,t){this._forceRecompute=e;this._handleValue=t}_counter=0;beginUpdate(e){this._counter++}endUpdate(e){this._counter--,this._counter===0&&this._forceRecompute&&(this._handleValue?this._handleValue(e.get()):e.reportChanges())}handlePossibleChange(e){}handleChange(e,t){}};var Do;function Lo(n){Do=n}function Te(){return Do}var br=class{indentation=0;textToConsoleArgs(e){return Cu([Ft(Ru("|  ",this.indentation)),e])}formatInfo(e){return e.hadValue?e.didChange?[Ft(" "),Le(mn(e.oldValue,70),{color:"red",strikeThrough:!0}),Ft(" "),Le(mn(e.newValue,60),{color:"green"})]:[Ft(" (unchanged)")]:[Ft(" "),Le(mn(e.newValue,60),{color:"green"}),Ft(" (initial)")]}handleObservableChanged(e,t){console.log(...this.textToConsoleArgs([fn("observable value changed"),Le(e.debugName,{color:"BlueViolet"}),...this.formatInfo(t)]))}changedObservablesSets=new WeakMap;formatChanges(e){if(e.size!==0)return Le(" (changed deps: "+[...e].map(t=>t.debugName).join(", ")+")",{color:"gray"})}handleDerivedCreated(e){let t=e.handleChange;this.changedObservablesSets.set(e,new Set),e.handleChange=(r,i)=>(this.changedObservablesSets.get(e).add(r),t.apply(e,[r,i]))}handleDerivedRecomputed(e,t){let r=this.changedObservablesSets.get(e);console.log(...this.textToConsoleArgs([fn("derived recomputed"),Le(e.debugName,{color:"BlueViolet"}),...this.formatInfo(t),this.formatChanges(r),{data:[{fn:e._debugNameData.referenceFn??e._computeFn}]}])),r.clear()}handleFromEventObservableTriggered(e,t){console.log(...this.textToConsoleArgs([fn("observable from event triggered"),Le(e.debugName,{color:"BlueViolet"}),...this.formatInfo(t),{data:[{fn:e._getValue}]}]))}handleAutorunCreated(e){let t=e.handleChange;this.changedObservablesSets.set(e,new Set),e.handleChange=(r,i)=>(this.changedObservablesSets.get(e).add(r),t.apply(e,[r,i]))}handleAutorunTriggered(e){let t=this.changedObservablesSets.get(e);console.log(...this.textToConsoleArgs([fn("autorun"),Le(e.debugName,{color:"BlueViolet"}),this.formatChanges(t),{data:[{fn:e._debugNameData.referenceFn??e._runFn}]}])),t.clear(),this.indentation++}handleAutorunFinished(e){this.indentation--}handleBeginTransaction(e){let t=e.getDebugName();t===void 0&&(t=""),console.log(...this.textToConsoleArgs([fn("transaction"),Le(t,{color:"BlueViolet"}),{data:[{fn:e._fn}]}])),this.indentation++}handleEndTransaction(){this.indentation--}};function Cu(n){let e=new Array,t=[],r="";function i(o){if("length"in o)for(let l of o)l&&i(l);else"text"in o?(r+=`%c${o.text}`,e.push(o.style),o.data&&t.push(...o.data)):"data"in o&&t.push(...o.data)}i(n);let s=[r,...e];return s.push(...t),s}function Ft(n){return Le(n,{color:"black"})}function fn(n){return Le(ku(`${n}: `,10),{color:"black",bold:!0})}function Le(n,e={color:"black"}){function t(i){return Object.entries(i).reduce((s,[o,l])=>`${s}${o}:${l};`,"")}let r={color:e.color};return e.strikeThrough&&(r["text-decoration"]="line-through"),e.bold&&(r["font-weight"]="bold"),{text:n,style:t(r)}}function mn(n,e){switch(typeof n){case"number":return""+n;case"string":return n.length+2<=e?`"${n}"`:`"${n.substr(0,e-7)}"+...`;case"boolean":return n?"true":"false";case"undefined":return"undefined";case"object":return n===null?"null":Array.isArray(n)?Su(n,e):Pu(n,e);case"symbol":return n.toString();case"function":return`[[Function${n.name?" "+n.name:""}]]`;default:return""+n}}function Su(n,e){let t="[ ",r=!0;for(let i of n){if(r||(t+=", "),t.length-5>e){t+="...";break}r=!1,t+=`${mn(i,e-t.length)}`}return t+=" ]",t}function Pu(n,e){let t="{ ",r=!0;for(let[i,s]of Object.entries(n)){if(r||(t+=", "),t.length-5>e){t+="...";break}r=!1,t+=`${i}: ${mn(s,e-t.length)}`}return t+=" }",t}function Ru(n,e){let t="";for(let r=1;r<=e;r++)t+=n;return t}function ku(n,e){for(;n.length<e;)n+=" ";return n}var Oo;function Po(n){Oo=n}var Ao;function Ro(n){Ao=n}var Mi;function Eo(n){Mi=n}var hr=class{get TChange(){return null}reportChanges(){this.get()}read(e){return e?e.readObservable(this):this.get()}map(e,t){let r=t===void 0?void 0:e,i=t===void 0?e:t;return Mi({owner:r,debugName:()=>{let s=ur(i);if(s!==void 0)return s;let l=/^\s*\(?\s*([a-zA-Z_$][a-zA-Z_$0-9]*)\s*\)?\s*=>\s*\1(?:\??)\.([a-zA-Z_$][a-zA-Z_$0-9]*)\s*$/.exec(i.toString());if(l)return`${this.debugName}.${l[2]}`;if(!r)return`${this.debugName} (mapped)`},debugReferenceFn:i},s=>i(this.read(s),s))}flatten(){return Mi({owner:void 0,debugName:()=>`${this.debugName} (flattened)`},e=>this.read(e).read(e))}recomputeInitiallyAndOnChange(e,t){return e.add(Oo(this,t)),this}keepObserved(e){return e.add(Ao(this)),this}get debugValue(){return this.get()}},vt=class extends hr{observers=new Set;addObserver(e){let t=this.observers.size;this.observers.add(e),t===0&&this.onFirstObserverAdded()}removeObserver(e){this.observers.delete(e)&&this.observers.size===0&&this.onLastObserverRemoved()}onFirstObserverAdded(){}onLastObserverRemoved(){}};function gr(n,e){let t=new yr(n,e);try{n(t)}finally{t.finish()}}function Ai(n,e,t){n?e(n):gr(e,t)}var yr=class{constructor(e,t){this._fn=e;this._getDebugName=t;Te()?.handleBeginTransaction(this)}updatingObservers=[];getDebugName(){return this._getDebugName?this._getDebugName():ur(this._fn)}updateObserver(e,t){this.updatingObservers.push({observer:e,observable:t}),e.beginUpdate(t)}finish(){let e=this.updatingObservers;for(let t=0;t<e.length;t++){let{observer:r,observable:i}=e[t];r.endUpdate(i)}this.updatingObservers=null,Te()?.handleEndTransaction()}};var Du=!1;Du&&Lo(new br);var Lu=globalThis.performance&&typeof globalThis.performance.now=="function",vr=class n{_startTime;_stopTime;_now;static create(e){return new n(e)}constructor(e){this._now=Lu&&e===!1?Date.now:globalThis.performance.now.bind(globalThis.performance),this._startTime=this._now(),this._stopTime=-1}stop(){this._stopTime=this._now()}reset(){this._startTime=this._now(),this._stopTime=-1}elapsed(){return this._stopTime!==-1?this._stopTime-this._startTime:this._now()-this._startTime}};var Ou=Symbol("MicrotaskDelay");var Au=!1,Mo=!1,Mu=!1,G;(ct=>{ct.None=()=>O.None;function e(E){if(Mu){let{onDidAddListener:x}=E,w=hn.create(),I=0;E.onDidAddListener=()=>{++I===2&&(console.warn("snapshotted emitter LIKELY used public and SHOULD HAVE BEEN created with DisposableStore. snapshotted here"),w.print()),x?.()}}}function t(E,x){return m(E,()=>{},0,void 0,!0,void 0,x)}ct.defer=t;function r(E){return(x,w=null,I)=>{let C=!1,N;return N=E(j=>{if(!C)return N?N.dispose():C=!0,x.call(w,j)},null,I),C&&N.dispose(),N}}ct.once=r;function i(E,x){return ct.once(ct.filter(E,x))}ct.onceIf=i;function s(E,x,w){return p((I,C=null,N)=>E(j=>I.call(C,x(j)),null,N),w)}ct.map=s;function o(E,x,w){return p((I,C=null,N)=>E(j=>{x(j),I.call(C,j)},null,N),w)}ct.forEach=o;function l(E,x,w){return p((I,C=null,N)=>E(j=>x(j)&&I.call(C,j),null,N),w)}ct.filter=l;function c(E){return E}ct.signal=c;function u(...E){return(x,w=null,I)=>{let C=lr(...E.map(N=>N(j=>x.call(w,j))));return f(C,I)}}ct.any=u;function d(E,x,w,I){let C=w;return s(E,N=>(C=x(C,N),C),I)}ct.reduce=d;function p(E,x){let w,I={onWillAddFirstListener(){w=E(C.fire,C)},onDidRemoveLastListener(){w?.dispose()}};x||e(I);let C=new y(I);return x?.add(C),C.event}function f(E,x){return x instanceof Array?x.push(E):x&&x.add(E),E}function m(E,x,w=100,I=!1,C=!1,N,j){let ne,le,L,jn=0,tn,Vs={leakWarningThreshold:N,onWillAddFirstListener(){ne=E(Ll=>{jn++,le=x(le,Ll),I&&!L&&(Gn.fire(le),le=void 0),tn=()=>{let Ol=le;le=void 0,L=void 0,(!I||jn>1)&&Gn.fire(Ol),jn=0},typeof w=="number"?(clearTimeout(L),L=setTimeout(tn,w)):L===void 0&&(L=0,queueMicrotask(tn))})},onWillRemoveListener(){C&&jn>0&&tn?.()},onDidRemoveLastListener(){tn=void 0,ne.dispose()}};j||e(Vs);let Gn=new y(Vs);return j?.add(Gn),Gn.event}ct.debounce=m;function h(E,x=0,w){return ct.debounce(E,(I,C)=>I?(I.push(C),I):[C],x,void 0,!0,void 0,w)}ct.accumulate=h;function _(E,x=(I,C)=>I===C,w){let I=!0,C;return l(E,N=>{let j=I||!x(N,C);return I=!1,C=N,j},w)}ct.latch=_;function T(E,x,w){return[ct.filter(E,x,w),ct.filter(E,I=>!x(I),w)]}ct.split=T;function A(E,x=!1,w=[],I){let C=w.slice(),N=E(le=>{C?C.push(le):ne.fire(le)});I&&I.add(N);let j=()=>{C?.forEach(le=>ne.fire(le)),C=null},ne=new y({onWillAddFirstListener(){N||(N=E(le=>ne.fire(le)),I&&I.add(N))},onDidAddFirstListener(){C&&(x?setTimeout(j):j())},onDidRemoveLastListener(){N&&N.dispose(),N=null}});return I&&I.add(ne),ne.event}ct.buffer=A;function $(E,x){return(I,C,N)=>{let j=x(new g);return E(function(ne){let le=j.evaluate(ne);le!==S&&I.call(C,le)},void 0,N)}}ct.chain=$;let S=Symbol("HaltChainable");class g{steps=[];map(x){return this.steps.push(x),this}forEach(x){return this.steps.push(w=>(x(w),w)),this}filter(x){return this.steps.push(w=>x(w)?w:S),this}reduce(x,w){let I=w;return this.steps.push(C=>(I=x(I,C),I)),this}latch(x=(w,I)=>w===I){let w=!0,I;return this.steps.push(C=>{let N=w||!x(C,I);return w=!1,I=C,N?C:S}),this}evaluate(x){for(let w of this.steps)if(x=w(x),x===S)break;return x}}function P(E,x,w=I=>I){let I=(...ne)=>j.fire(w(...ne)),C=()=>E.on(x,I),N=()=>E.removeListener(x,I),j=new y({onWillAddFirstListener:C,onDidRemoveLastListener:N});return j.event}ct.fromNodeEventEmitter=P;function W(E,x,w=I=>I){let I=(...ne)=>j.fire(w(...ne)),C=()=>E.addEventListener(x,I),N=()=>E.removeEventListener(x,I),j=new y({onWillAddFirstListener:C,onDidRemoveLastListener:N});return j.event}ct.fromDOMEventEmitter=W;function F(E){return new Promise(x=>r(E)(x))}ct.toPromise=F;function Ee(E){let x=new y;return E.then(w=>{x.fire(w)},()=>{x.fire(void 0)}).finally(()=>{x.dispose()}),x.event}ct.fromPromise=Ee;function me(E,x){return E(w=>x.fire(w))}ct.forward=me;function Pe(E,x,w){return x(w),E(I=>x(I))}ct.runAndSubscribe=Pe;class Ws{constructor(x,w){this._observable=x;let I={onWillAddFirstListener:()=>{x.addObserver(this),this._observable.reportChanges()},onDidRemoveLastListener:()=>{x.removeObserver(this)}};w||e(I),this.emitter=new y(I),w&&w.add(this.emitter)}emitter;_counter=0;_hasChanged=!1;beginUpdate(x){this._counter++}handlePossibleChange(x){}handleChange(x,w){this._hasChanged=!0}endUpdate(x){this._counter--,this._counter===0&&(this._observable.reportChanges(),this._hasChanged&&(this._hasChanged=!1,this.emitter.fire(this._observable.get())))}}function kl(E,x){return new Ws(E,x).emitter.event}ct.fromObservable=kl;function Dl(E){return(x,w,I)=>{let C=0,N=!1,j={beginUpdate(){C++},endUpdate(){C--,C===0&&(E.reportChanges(),N&&(N=!1,x.call(w)))},handlePossibleChange(){},handleChange(){N=!0}};E.addObserver(j),E.reportChanges();let ne={dispose(){E.removeObserver(j)}};return I instanceof ue?I.add(ne):Array.isArray(I)&&I.push(ne),ne}}ct.fromObservableLight=Dl})(G||={});var Fi=class n{static all=new Set;static _idPool=0;name;listenerCount=0;invocationCount=0;elapsedOverall=0;durations=[];_stopWatch;constructor(e){this.name=`${e}_${n._idPool++}`,n.all.add(this)}start(e){this._stopWatch=new vr,this.listenerCount=e}stop(){if(this._stopWatch){let e=this._stopWatch.elapsed();this.durations.push(e),this.elapsedOverall+=e,this.invocationCount+=1,this._stopWatch=void 0}}},Fo=-1;var Ui=class n{constructor(e,t,r=(n._idPool++).toString(16).padStart(3,"0")){this._errorHandler=e;this.threshold=t;this.name=r}static _idPool=1;_stacks;_warnCountdown=0;dispose(){this._stacks?.clear()}check(e,t){let r=this.threshold;if(r<=0||t<r)return;this._stacks||(this._stacks=new Map);let i=this._stacks.get(e.value)||0;if(this._stacks.set(e.value,i+1),this._warnCountdown-=1,this._warnCountdown<=0){this._warnCountdown=r*.5;let[s,o]=this.getMostFrequentStack(),l=`[${this.name}] potential listener LEAK detected, having ${t} listeners already. MOST frequent listener (${o}):`;console.warn(l),console.warn(s);let c=new Ni(l,s);this._errorHandler(c)}return()=>{let s=this._stacks.get(e.value)||0;this._stacks.set(e.value,s-1)}}getMostFrequentStack(){if(!this._stacks)return;let e,t=0;for(let[r,i]of this._stacks)(!e||t<i)&&(e=[r,i],t=i);return e}},hn=class n{constructor(e){this.value=e}static create(){let e=new Error;return new n(e.stack??"")}print(){console.warn(this.value.split(`
`).slice(2).join(`
`))}},Ni=class extends Error{constructor(e,t){super(e),this.name="ListenerLeakError",this.stack=t}},Bi=class extends Error{constructor(e,t){super(e),this.name="ListenerRefusalError",this.stack=t}},Fu=0,Ut=class{constructor(e){this.value=e}stack;id=Fu++},Uu=2,Nu=(n,e)=>{if(n instanceof Ut)e(n);else for(let t=0;t<n.length;t++){let r=n[t];r&&e(r)}},xr;if(Au){let n=[];setInterval(()=>{n.length!==0&&(console.warn("[LEAKING LISTENERS] GC'ed these listeners that were NOT yet disposed:"),console.warn(n.join(`
`)),n.length=0)},3e3),xr=new FinalizationRegistry(e=>{typeof e=="string"&&n.push(e)})}var y=class{_options;_leakageMon;_perfMon;_disposed;_event;_listeners;_deliveryQueue;_size=0;constructor(e){this._options=e,this._leakageMon=Fo>0||this._options?.leakWarningThreshold?new Ui(e?.onListenerError??Be,this._options?.leakWarningThreshold??Fo):void 0,this._perfMon=this._options?._profName?new Fi(this._options._profName):void 0,this._deliveryQueue=this._options?.deliveryQueue}dispose(){if(!this._disposed){if(this._disposed=!0,this._deliveryQueue?.current===this&&this._deliveryQueue.reset(),this._listeners){if(Mo){let e=this._listeners;queueMicrotask(()=>{Nu(e,t=>t.stack?.print())})}this._listeners=void 0,this._size=0}this._options?.onDidRemoveLastListener?.(),this._leakageMon?.dispose()}}get event(){return this._event??=(e,t,r)=>{if(this._leakageMon&&this._size>this._leakageMon.threshold**2){let c=`[${this._leakageMon.name}] REFUSES to accept new listeners because it exceeded its threshold by far (${this._size} vs ${this._leakageMon.threshold})`;console.warn(c);let u=this._leakageMon.getMostFrequentStack()??["UNKNOWN stack",-1],d=new Bi(`${c}. HINT: Stack shows most frequent listener (${u[1]}-times)`,u[0]);return(this._options?.onListenerError||Be)(d),O.None}if(this._disposed)return O.None;t&&(e=e.bind(t));let i=new Ut(e),s,o;this._leakageMon&&this._size>=Math.ceil(this._leakageMon.threshold*.2)&&(i.stack=hn.create(),s=this._leakageMon.check(i.stack,this._size+1)),Mo&&(i.stack=o??hn.create()),this._listeners?this._listeners instanceof Ut?(this._deliveryQueue??=new Wi,this._listeners=[this._listeners,i]):this._listeners.push(i):(this._options?.onWillAddFirstListener?.(this),this._listeners=i,this._options?.onDidAddFirstListener?.(this)),this._size++;let l=X(()=>{xr?.unregister(l),s?.(),this._removeListener(i)});if(r instanceof ue?r.add(l):Array.isArray(r)&&r.push(l),xr){let c=new Error().stack.split(`
`).slice(2,3).join(`
`).trim(),u=/(file:|vscode-file:\/\/vscode-app)?(\/[^:]*:\d+:\d+)/.exec(c);xr.register(l,u?.[2]??c,l)}return l},this._event}_removeListener(e){if(this._options?.onWillRemoveListener?.(this),!this._listeners)return;if(this._size===1){this._listeners=void 0,this._options?.onDidRemoveLastListener?.(this),this._size=0;return}let t=this._listeners,r=t.indexOf(e);if(r===-1)throw console.log("disposed?",this._disposed),console.log("size?",this._size),console.log("arr?",JSON.stringify(this._listeners)),new Error("Attempted to dispose unknown listener");this._size--,t[r]=void 0;let i=this._deliveryQueue.current===this;if(this._size*Uu<=t.length){let s=0;for(let o=0;o<t.length;o++)t[o]?t[s++]=t[o]:i&&(this._deliveryQueue.end--,s<this._deliveryQueue.i&&this._deliveryQueue.i--);t.length=s}}_deliver(e,t){if(!e)return;let r=this._options?.onListenerError||Be;if(!r){e.value(t);return}try{e.value(t)}catch(i){r(i)}}_deliverQueue(e){let t=e.current._listeners;for(;e.i<e.end;)this._deliver(t[e.i++],e.value);e.reset()}fire(e){if(this._deliveryQueue?.current&&(this._deliverQueue(this._deliveryQueue),this._perfMon?.stop()),this._perfMon?.start(this._size),this._listeners)if(this._listeners instanceof Ut)this._deliver(this._listeners,e);else{let t=this._deliveryQueue;t.enqueue(this,e,this._listeners.length),this._deliverQueue(t)}this._perfMon?.stop()}hasListeners(){return this._size>0}};var Wi=class{i=-1;end=0;current;value;enqueue(e,t,r){this.i=0,this.end=r,this.current=e,this.value=t}reset(){this.i=this.end,this.current=void 0,this.value=void 0}};var Ir=class{emitter;hasListeners=!1;events=[];constructor(){this.emitter=new y({onWillAddFirstListener:()=>this.onFirstListenerAdd(),onDidRemoveLastListener:()=>this.onLastListenerRemove()})}get event(){return this.emitter.event}add(e){let t={event:e,listener:null};return this.events.push(t),this.hasListeners&&this.hook(t),X(Xn(()=>{this.hasListeners&&this.unhook(t);let i=this.events.indexOf(t);this.events.splice(i,1)}))}onFirstListenerAdd(){this.hasListeners=!0,this.events.forEach(e=>this.hook(e))}onLastListenerRemove(){this.hasListeners=!1,this.events.forEach(e=>this.unhook(e))}hook(e){e.listener=e.event(t=>this.emitter.fire(t))}unhook(e){e.listener?.dispose(),e.listener=null}dispose(){this.emitter.dispose();for(let e of this.events)e.listener?.dispose();this.events=[]}};var _r=class{listening=!1;inputEvent=G.None;inputEventListener=O.None;emitter=new y({onDidAddFirstListener:()=>{this.listening=!0,this.inputEventListener=this.inputEvent(this.emitter.fire,this.emitter)},onDidRemoveLastListener:()=>{this.listening=!1,this.inputEventListener.dispose()}});event=this.emitter.event;set input(e){this.inputEvent=e,this.listening&&(this.inputEventListener.dispose(),this.inputEventListener=e(this.emitter.fire,this.emitter))}dispose(){this.inputEventListener.dispose(),this.emitter.dispose()}};var Uo=Object.freeze(function(n,e){let t=setTimeout(n.bind(e),0);return{dispose(){clearTimeout(t)}}}),Bt;(r=>{function n(i){return i===r.None||i===r.Cancelled||i instanceof Nt?!0:!i||typeof i!="object"?!1:typeof i.isCancellationRequested=="boolean"&&typeof i.onCancellationRequested=="function"}r.isCancellationToken=n,r.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:G.None}),r.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:Uo})})(Bt||={});var Nt=class{_isCancelled=!1;_emitter=null;cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?Uo:(this._emitter||(this._emitter=new y),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=null)}},Fe=class{_token=void 0;_parentListener=void 0;constructor(e){this._parentListener=e&&e.onCancellationRequested(this.cancel,this)}get token(){return this._token||(this._token=new Nt),this._token}cancel(){this._token?this._token instanceof Nt&&this._token.cancel():this._token=Bt.Cancelled}dispose(e=!1){e&&this.cancel(),this._parentListener?.dispose(),this._token?this._token instanceof Nt&&this._token.dispose():this._token=Bt.None}};var Tr=typeof Buffer<"u",Wu=new Ne(()=>new Uint8Array(256)),Vi,Ki,oe=class n{static alloc(e){return Tr?new n(Buffer.allocUnsafe(e)):new n(new Uint8Array(e))}static wrap(e){return Tr&&!Buffer.isBuffer(e)&&(e=Buffer.from(e.buffer,e.byteOffset,e.byteLength)),new n(e)}static fromString(e,t){return!(t?.dontUseNodeBuffer||!1)&&Tr?new n(Buffer.from(e)):(Vi||(Vi=new TextEncoder),new n(Vi.encode(e)))}static fromByteArray(e){let t=n.alloc(e.length);for(let r=0,i=e.length;r<i;r++)t.buffer[r]=e[r];return t}static concat(e,t){if(typeof t>"u"){t=0;for(let s=0,o=e.length;s<o;s++)t+=e[s].byteLength}let r=n.alloc(t),i=0;for(let s=0,o=e.length;s<o;s++){let l=e[s];r.set(l,i),i+=l.byteLength}return r}buffer;byteLength;constructor(e){this.buffer=e,this.byteLength=this.buffer.byteLength}clone(){let e=n.alloc(this.byteLength);return e.set(this),e}toString(){return Tr?this.buffer.toString():(Ki||(Ki=new TextDecoder),Ki.decode(this.buffer))}slice(e,t){return new n(this.buffer.subarray(e,t))}set(e,t){if(e instanceof n)this.buffer.set(e.buffer,t);else if(e instanceof Uint8Array)this.buffer.set(e,t);else if(e instanceof ArrayBuffer)this.buffer.set(new Uint8Array(e),t);else if(ArrayBuffer.isView(e))this.buffer.set(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),t);else throw new Error("Unknown argument 'array'")}readUInt32BE(e){return Ku(this.buffer,e)}writeUInt32BE(e,t){qu(this.buffer,e,t)}readUInt32LE(e){return zu(this.buffer,e)}writeUInt32LE(e,t){$u(this.buffer,e,t)}readUInt8(e){return Hu(this.buffer,e)}writeUInt8(e,t){ju(this.buffer,e,t)}indexOf(e,t=0){return Vu(this.buffer,e instanceof n?e.buffer:e,t)}};function Vu(n,e,t=0){let r=e.byteLength,i=n.byteLength;if(r===0)return 0;if(r===1)return n.indexOf(e[0]);if(r>i-t)return-1;let s=Wu.value;s.fill(e.length);for(let u=0;u<e.length;u++)s[e[u]]=e.length-u-1;let o=t+e.length-1,l=o,c=-1;for(;o<i;)if(n[o]===e[l]){if(l===0){c=o;break}o--,l--}else o+=Math.max(e.length-l,s[n[o]]),l=e.length-1;return c}function Ku(n,e){return n[e]*2**24+n[e+1]*2**16+n[e+2]*2**8+n[e+3]}function qu(n,e,t){n[t+3]=e,e=e>>>8,n[t+2]=e,e=e>>>8,n[t+1]=e,e=e>>>8,n[t]=e}function zu(n,e){return n[e+0]<<0>>>0|n[e+1]<<8>>>0|n[e+2]<<16>>>0|n[e+3]<<24>>>0}function $u(n,e,t){n[t+0]=e&255,e=e>>>8,n[t+1]=e&255,e=e>>>8,n[t+2]=e&255,e=e>>>8,n[t+3]=e&255}function Hu(n,e){return n[e]}function ju(n,e,t){n[t]=e}function gn(n,e=0){if(!n||e>200)return n;if(typeof n=="object"){switch(n.$mid){case 1:return R.revive(n);case 2:return new RegExp(n.source,n.flags);case 17:return new Date(n.source)}if(n instanceof oe||n instanceof Uint8Array)return n;if(Array.isArray(n))for(let t=0;t<n.length;++t)n[t]=gn(n[t],e+1);else for(let t in n)Object.hasOwnProperty.call(n,t)&&(n[t]=gn(n[t],e+1))}return n}var No=new class{transformIncoming(n){return n}transformOutgoing(n){return n}transformOutgoingURI(n){return n}transformOutgoingScheme(n){return n}};function Gu(n){return n}var Er=class{lastCache=void 0;lastArgKey=void 0;_fn;_computeKey;constructor(e,t){typeof e=="function"?(this._fn=e,this._computeKey=Gu):(this._fn=t,this._computeKey=e.getCacheKey)}get(e){let t=this._computeKey(e);return this.lastArgKey!==t&&(this.lastArgKey=t,this.lastCache=this._fn(e)),this.lastCache}};function Vo(n){return!n||typeof n!="string"?!0:n.trim().length===0}var Xu=/{(\d+)}/g;function Wt(n,...e){return e.length===0?n:n.replace(Xu,function(t,r){let i=parseInt(r,10);return isNaN(i)||i<0||i>=e.length?t:e[i]})}function qi(n,e){return n<e?-1:n>e?1:0}function Ko(n,e,t=0,r=n.length,i=0,s=e.length){for(;t<r&&i<s;t++,i++){let c=n.charCodeAt(t),u=e.charCodeAt(i);if(c<u)return-1;if(c>u)return 1}let o=r-t,l=s-i;return o<l?-1:o>l?1:0}function zi(n,e,t=0,r=n.length,i=0,s=e.length){for(;t<r&&i<s;t++,i++){let c=n.charCodeAt(t),u=e.charCodeAt(i);if(c===u)continue;if(c>=128||u>=128)return Ko(n.toLowerCase(),e.toLowerCase(),t,r,i,s);Bo(c)&&(c-=32),Bo(u)&&(u-=32);let d=c-u;if(d!==0)return d}let o=r-t,l=s-i;return o<l?-1:o>l?1:0}function Bo(n){return n>=97&&n<=122}function $i(n){return n>=65&&n<=90}function wr(n,e){return n.length===e.length&&zi(n,e)===0}function Vt(n,e){let t=e.length;return e.length>n.length?!1:zi(n,e,0,t)===0}function qo(n){return 55296<=n&&n<=56319}function Hi(n){return 56320<=n&&n<=57343}function zo(n,e){return(n-55296<<10)+(e-56320)+65536}var Qu=/(?:(?:\x1b\[|\x9B)[=?>!]?[\d;:]*["$#'* ]?[a-zA-Z@^`{}|~])|(:?\x1b\].*?\x07)/g;function Ju(n){return n&&(n=n.replace(Qu,"")),n}var Yu=/\\\[.*?\\\]/g;function $o(n){return Ju(n).replace(Yu,"")}var A1=String.fromCharCode(65279);var Wo=class n{constructor(e){this.confusableDictionary=e}static ambiguousCharacterData=new Ne(()=>JSON.parse('{"_common":[8232,32,8233,32,5760,32,8192,32,8193,32,8194,32,8195,32,8196,32,8197,32,8198,32,8200,32,8201,32,8202,32,8287,32,8199,32,8239,32,2042,95,65101,95,65102,95,65103,95,8208,45,8209,45,8210,45,65112,45,1748,45,8259,45,727,45,8722,45,10134,45,11450,45,1549,44,1643,44,8218,44,184,44,42233,44,894,59,2307,58,2691,58,1417,58,1795,58,1796,58,5868,58,65072,58,6147,58,6153,58,8282,58,1475,58,760,58,42889,58,8758,58,720,58,42237,58,451,33,11601,33,660,63,577,63,2429,63,5038,63,42731,63,119149,46,8228,46,1793,46,1794,46,42510,46,68176,46,1632,46,1776,46,42232,46,1373,96,65287,96,8219,96,8242,96,1370,96,1523,96,8175,96,65344,96,900,96,8189,96,8125,96,8127,96,8190,96,697,96,884,96,712,96,714,96,715,96,756,96,699,96,701,96,700,96,702,96,42892,96,1497,96,2036,96,2037,96,5194,96,5836,96,94033,96,94034,96,65339,91,10088,40,10098,40,12308,40,64830,40,65341,93,10089,41,10099,41,12309,41,64831,41,10100,123,119060,123,10101,125,65342,94,8270,42,1645,42,8727,42,66335,42,5941,47,8257,47,8725,47,8260,47,9585,47,10187,47,10744,47,119354,47,12755,47,12339,47,11462,47,20031,47,12035,47,65340,92,65128,92,8726,92,10189,92,10741,92,10745,92,119311,92,119355,92,12756,92,20022,92,12034,92,42872,38,708,94,710,94,5869,43,10133,43,66203,43,8249,60,10094,60,706,60,119350,60,5176,60,5810,60,5120,61,11840,61,12448,61,42239,61,8250,62,10095,62,707,62,119351,62,5171,62,94015,62,8275,126,732,126,8128,126,8764,126,65372,124,65293,45,120784,50,120794,50,120804,50,120814,50,120824,50,130034,50,42842,50,423,50,1000,50,42564,50,5311,50,42735,50,119302,51,120785,51,120795,51,120805,51,120815,51,120825,51,130035,51,42923,51,540,51,439,51,42858,51,11468,51,1248,51,94011,51,71882,51,120786,52,120796,52,120806,52,120816,52,120826,52,130036,52,5070,52,71855,52,120787,53,120797,53,120807,53,120817,53,120827,53,130037,53,444,53,71867,53,120788,54,120798,54,120808,54,120818,54,120828,54,130038,54,11474,54,5102,54,71893,54,119314,55,120789,55,120799,55,120809,55,120819,55,120829,55,130039,55,66770,55,71878,55,2819,56,2538,56,2666,56,125131,56,120790,56,120800,56,120810,56,120820,56,120830,56,130040,56,547,56,546,56,66330,56,2663,57,2920,57,2541,57,3437,57,120791,57,120801,57,120811,57,120821,57,120831,57,130041,57,42862,57,11466,57,71884,57,71852,57,71894,57,9082,97,65345,97,119834,97,119886,97,119938,97,119990,97,120042,97,120094,97,120146,97,120198,97,120250,97,120302,97,120354,97,120406,97,120458,97,593,97,945,97,120514,97,120572,97,120630,97,120688,97,120746,97,65313,65,119808,65,119860,65,119912,65,119964,65,120016,65,120068,65,120120,65,120172,65,120224,65,120276,65,120328,65,120380,65,120432,65,913,65,120488,65,120546,65,120604,65,120662,65,120720,65,5034,65,5573,65,42222,65,94016,65,66208,65,119835,98,119887,98,119939,98,119991,98,120043,98,120095,98,120147,98,120199,98,120251,98,120303,98,120355,98,120407,98,120459,98,388,98,5071,98,5234,98,5551,98,65314,66,8492,66,119809,66,119861,66,119913,66,120017,66,120069,66,120121,66,120173,66,120225,66,120277,66,120329,66,120381,66,120433,66,42932,66,914,66,120489,66,120547,66,120605,66,120663,66,120721,66,5108,66,5623,66,42192,66,66178,66,66209,66,66305,66,65347,99,8573,99,119836,99,119888,99,119940,99,119992,99,120044,99,120096,99,120148,99,120200,99,120252,99,120304,99,120356,99,120408,99,120460,99,7428,99,1010,99,11429,99,43951,99,66621,99,128844,67,71922,67,71913,67,65315,67,8557,67,8450,67,8493,67,119810,67,119862,67,119914,67,119966,67,120018,67,120174,67,120226,67,120278,67,120330,67,120382,67,120434,67,1017,67,11428,67,5087,67,42202,67,66210,67,66306,67,66581,67,66844,67,8574,100,8518,100,119837,100,119889,100,119941,100,119993,100,120045,100,120097,100,120149,100,120201,100,120253,100,120305,100,120357,100,120409,100,120461,100,1281,100,5095,100,5231,100,42194,100,8558,68,8517,68,119811,68,119863,68,119915,68,119967,68,120019,68,120071,68,120123,68,120175,68,120227,68,120279,68,120331,68,120383,68,120435,68,5024,68,5598,68,5610,68,42195,68,8494,101,65349,101,8495,101,8519,101,119838,101,119890,101,119942,101,120046,101,120098,101,120150,101,120202,101,120254,101,120306,101,120358,101,120410,101,120462,101,43826,101,1213,101,8959,69,65317,69,8496,69,119812,69,119864,69,119916,69,120020,69,120072,69,120124,69,120176,69,120228,69,120280,69,120332,69,120384,69,120436,69,917,69,120492,69,120550,69,120608,69,120666,69,120724,69,11577,69,5036,69,42224,69,71846,69,71854,69,66182,69,119839,102,119891,102,119943,102,119995,102,120047,102,120099,102,120151,102,120203,102,120255,102,120307,102,120359,102,120411,102,120463,102,43829,102,42905,102,383,102,7837,102,1412,102,119315,70,8497,70,119813,70,119865,70,119917,70,120021,70,120073,70,120125,70,120177,70,120229,70,120281,70,120333,70,120385,70,120437,70,42904,70,988,70,120778,70,5556,70,42205,70,71874,70,71842,70,66183,70,66213,70,66853,70,65351,103,8458,103,119840,103,119892,103,119944,103,120048,103,120100,103,120152,103,120204,103,120256,103,120308,103,120360,103,120412,103,120464,103,609,103,7555,103,397,103,1409,103,119814,71,119866,71,119918,71,119970,71,120022,71,120074,71,120126,71,120178,71,120230,71,120282,71,120334,71,120386,71,120438,71,1292,71,5056,71,5107,71,42198,71,65352,104,8462,104,119841,104,119945,104,119997,104,120049,104,120101,104,120153,104,120205,104,120257,104,120309,104,120361,104,120413,104,120465,104,1211,104,1392,104,5058,104,65320,72,8459,72,8460,72,8461,72,119815,72,119867,72,119919,72,120023,72,120179,72,120231,72,120283,72,120335,72,120387,72,120439,72,919,72,120494,72,120552,72,120610,72,120668,72,120726,72,11406,72,5051,72,5500,72,42215,72,66255,72,731,105,9075,105,65353,105,8560,105,8505,105,8520,105,119842,105,119894,105,119946,105,119998,105,120050,105,120102,105,120154,105,120206,105,120258,105,120310,105,120362,105,120414,105,120466,105,120484,105,618,105,617,105,953,105,8126,105,890,105,120522,105,120580,105,120638,105,120696,105,120754,105,1110,105,42567,105,1231,105,43893,105,5029,105,71875,105,65354,106,8521,106,119843,106,119895,106,119947,106,119999,106,120051,106,120103,106,120155,106,120207,106,120259,106,120311,106,120363,106,120415,106,120467,106,1011,106,1112,106,65322,74,119817,74,119869,74,119921,74,119973,74,120025,74,120077,74,120129,74,120181,74,120233,74,120285,74,120337,74,120389,74,120441,74,42930,74,895,74,1032,74,5035,74,5261,74,42201,74,119844,107,119896,107,119948,107,120000,107,120052,107,120104,107,120156,107,120208,107,120260,107,120312,107,120364,107,120416,107,120468,107,8490,75,65323,75,119818,75,119870,75,119922,75,119974,75,120026,75,120078,75,120130,75,120182,75,120234,75,120286,75,120338,75,120390,75,120442,75,922,75,120497,75,120555,75,120613,75,120671,75,120729,75,11412,75,5094,75,5845,75,42199,75,66840,75,1472,108,8739,73,9213,73,65512,73,1633,108,1777,73,66336,108,125127,108,120783,73,120793,73,120803,73,120813,73,120823,73,130033,73,65321,73,8544,73,8464,73,8465,73,119816,73,119868,73,119920,73,120024,73,120128,73,120180,73,120232,73,120284,73,120336,73,120388,73,120440,73,65356,108,8572,73,8467,108,119845,108,119897,108,119949,108,120001,108,120053,108,120105,73,120157,73,120209,73,120261,73,120313,73,120365,73,120417,73,120469,73,448,73,120496,73,120554,73,120612,73,120670,73,120728,73,11410,73,1030,73,1216,73,1493,108,1503,108,1575,108,126464,108,126592,108,65166,108,65165,108,1994,108,11599,73,5825,73,42226,73,93992,73,66186,124,66313,124,119338,76,8556,76,8466,76,119819,76,119871,76,119923,76,120027,76,120079,76,120131,76,120183,76,120235,76,120287,76,120339,76,120391,76,120443,76,11472,76,5086,76,5290,76,42209,76,93974,76,71843,76,71858,76,66587,76,66854,76,65325,77,8559,77,8499,77,119820,77,119872,77,119924,77,120028,77,120080,77,120132,77,120184,77,120236,77,120288,77,120340,77,120392,77,120444,77,924,77,120499,77,120557,77,120615,77,120673,77,120731,77,1018,77,11416,77,5047,77,5616,77,5846,77,42207,77,66224,77,66321,77,119847,110,119899,110,119951,110,120003,110,120055,110,120107,110,120159,110,120211,110,120263,110,120315,110,120367,110,120419,110,120471,110,1400,110,1404,110,65326,78,8469,78,119821,78,119873,78,119925,78,119977,78,120029,78,120081,78,120185,78,120237,78,120289,78,120341,78,120393,78,120445,78,925,78,120500,78,120558,78,120616,78,120674,78,120732,78,11418,78,42208,78,66835,78,3074,111,3202,111,3330,111,3458,111,2406,111,2662,111,2790,111,3046,111,3174,111,3302,111,3430,111,3664,111,3792,111,4160,111,1637,111,1781,111,65359,111,8500,111,119848,111,119900,111,119952,111,120056,111,120108,111,120160,111,120212,111,120264,111,120316,111,120368,111,120420,111,120472,111,7439,111,7441,111,43837,111,959,111,120528,111,120586,111,120644,111,120702,111,120760,111,963,111,120532,111,120590,111,120648,111,120706,111,120764,111,11423,111,4351,111,1413,111,1505,111,1607,111,126500,111,126564,111,126596,111,65259,111,65260,111,65258,111,65257,111,1726,111,64428,111,64429,111,64427,111,64426,111,1729,111,64424,111,64425,111,64423,111,64422,111,1749,111,3360,111,4125,111,66794,111,71880,111,71895,111,66604,111,1984,79,2534,79,2918,79,12295,79,70864,79,71904,79,120782,79,120792,79,120802,79,120812,79,120822,79,130032,79,65327,79,119822,79,119874,79,119926,79,119978,79,120030,79,120082,79,120134,79,120186,79,120238,79,120290,79,120342,79,120394,79,120446,79,927,79,120502,79,120560,79,120618,79,120676,79,120734,79,11422,79,1365,79,11604,79,4816,79,2848,79,66754,79,42227,79,71861,79,66194,79,66219,79,66564,79,66838,79,9076,112,65360,112,119849,112,119901,112,119953,112,120005,112,120057,112,120109,112,120161,112,120213,112,120265,112,120317,112,120369,112,120421,112,120473,112,961,112,120530,112,120544,112,120588,112,120602,112,120646,112,120660,112,120704,112,120718,112,120762,112,120776,112,11427,112,65328,80,8473,80,119823,80,119875,80,119927,80,119979,80,120031,80,120083,80,120187,80,120239,80,120291,80,120343,80,120395,80,120447,80,929,80,120504,80,120562,80,120620,80,120678,80,120736,80,11426,80,5090,80,5229,80,42193,80,66197,80,119850,113,119902,113,119954,113,120006,113,120058,113,120110,113,120162,113,120214,113,120266,113,120318,113,120370,113,120422,113,120474,113,1307,113,1379,113,1382,113,8474,81,119824,81,119876,81,119928,81,119980,81,120032,81,120084,81,120188,81,120240,81,120292,81,120344,81,120396,81,120448,81,11605,81,119851,114,119903,114,119955,114,120007,114,120059,114,120111,114,120163,114,120215,114,120267,114,120319,114,120371,114,120423,114,120475,114,43847,114,43848,114,7462,114,11397,114,43905,114,119318,82,8475,82,8476,82,8477,82,119825,82,119877,82,119929,82,120033,82,120189,82,120241,82,120293,82,120345,82,120397,82,120449,82,422,82,5025,82,5074,82,66740,82,5511,82,42211,82,94005,82,65363,115,119852,115,119904,115,119956,115,120008,115,120060,115,120112,115,120164,115,120216,115,120268,115,120320,115,120372,115,120424,115,120476,115,42801,115,445,115,1109,115,43946,115,71873,115,66632,115,65331,83,119826,83,119878,83,119930,83,119982,83,120034,83,120086,83,120138,83,120190,83,120242,83,120294,83,120346,83,120398,83,120450,83,1029,83,1359,83,5077,83,5082,83,42210,83,94010,83,66198,83,66592,83,119853,116,119905,116,119957,116,120009,116,120061,116,120113,116,120165,116,120217,116,120269,116,120321,116,120373,116,120425,116,120477,116,8868,84,10201,84,128872,84,65332,84,119827,84,119879,84,119931,84,119983,84,120035,84,120087,84,120139,84,120191,84,120243,84,120295,84,120347,84,120399,84,120451,84,932,84,120507,84,120565,84,120623,84,120681,84,120739,84,11430,84,5026,84,42196,84,93962,84,71868,84,66199,84,66225,84,66325,84,119854,117,119906,117,119958,117,120010,117,120062,117,120114,117,120166,117,120218,117,120270,117,120322,117,120374,117,120426,117,120478,117,42911,117,7452,117,43854,117,43858,117,651,117,965,117,120534,117,120592,117,120650,117,120708,117,120766,117,1405,117,66806,117,71896,117,8746,85,8899,85,119828,85,119880,85,119932,85,119984,85,120036,85,120088,85,120140,85,120192,85,120244,85,120296,85,120348,85,120400,85,120452,85,1357,85,4608,85,66766,85,5196,85,42228,85,94018,85,71864,85,8744,118,8897,118,65366,118,8564,118,119855,118,119907,118,119959,118,120011,118,120063,118,120115,118,120167,118,120219,118,120271,118,120323,118,120375,118,120427,118,120479,118,7456,118,957,118,120526,118,120584,118,120642,118,120700,118,120758,118,1141,118,1496,118,71430,118,43945,118,71872,118,119309,86,1639,86,1783,86,8548,86,119829,86,119881,86,119933,86,119985,86,120037,86,120089,86,120141,86,120193,86,120245,86,120297,86,120349,86,120401,86,120453,86,1140,86,11576,86,5081,86,5167,86,42719,86,42214,86,93960,86,71840,86,66845,86,623,119,119856,119,119908,119,119960,119,120012,119,120064,119,120116,119,120168,119,120220,119,120272,119,120324,119,120376,119,120428,119,120480,119,7457,119,1121,119,1309,119,1377,119,71434,119,71438,119,71439,119,43907,119,71919,87,71910,87,119830,87,119882,87,119934,87,119986,87,120038,87,120090,87,120142,87,120194,87,120246,87,120298,87,120350,87,120402,87,120454,87,1308,87,5043,87,5076,87,42218,87,5742,120,10539,120,10540,120,10799,120,65368,120,8569,120,119857,120,119909,120,119961,120,120013,120,120065,120,120117,120,120169,120,120221,120,120273,120,120325,120,120377,120,120429,120,120481,120,5441,120,5501,120,5741,88,9587,88,66338,88,71916,88,65336,88,8553,88,119831,88,119883,88,119935,88,119987,88,120039,88,120091,88,120143,88,120195,88,120247,88,120299,88,120351,88,120403,88,120455,88,42931,88,935,88,120510,88,120568,88,120626,88,120684,88,120742,88,11436,88,11613,88,5815,88,42219,88,66192,88,66228,88,66327,88,66855,88,611,121,7564,121,65369,121,119858,121,119910,121,119962,121,120014,121,120066,121,120118,121,120170,121,120222,121,120274,121,120326,121,120378,121,120430,121,120482,121,655,121,7935,121,43866,121,947,121,8509,121,120516,121,120574,121,120632,121,120690,121,120748,121,1199,121,4327,121,71900,121,65337,89,119832,89,119884,89,119936,89,119988,89,120040,89,120092,89,120144,89,120196,89,120248,89,120300,89,120352,89,120404,89,120456,89,933,89,978,89,120508,89,120566,89,120624,89,120682,89,120740,89,11432,89,1198,89,5033,89,5053,89,42220,89,94019,89,71844,89,66226,89,119859,122,119911,122,119963,122,120015,122,120067,122,120119,122,120171,122,120223,122,120275,122,120327,122,120379,122,120431,122,120483,122,7458,122,43923,122,71876,122,66293,90,71909,90,65338,90,8484,90,8488,90,119833,90,119885,90,119937,90,119989,90,120041,90,120197,90,120249,90,120301,90,120353,90,120405,90,120457,90,918,90,120493,90,120551,90,120609,90,120667,90,120725,90,5059,90,42204,90,71849,90,65282,34,65284,36,65285,37,65286,38,65290,42,65291,43,65294,46,65295,47,65296,48,65297,49,65298,50,65299,51,65300,52,65301,53,65302,54,65303,55,65304,56,65305,57,65308,60,65309,61,65310,62,65312,64,65316,68,65318,70,65319,71,65324,76,65329,81,65330,82,65333,85,65334,86,65335,87,65343,95,65346,98,65348,100,65350,102,65355,107,65357,109,65358,110,65361,113,65362,114,65364,116,65365,117,65367,119,65370,122,65371,123,65373,125,119846,109],"_default":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"cs":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"de":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"es":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"fr":[65374,126,65306,58,65281,33,8216,96,8245,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"it":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ja":[8211,45,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65292,44,65307,59],"ko":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pl":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pt-BR":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"qps-ploc":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ru":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,305,105,921,73,1009,112,215,120,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"tr":[160,32,8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"zh-hans":[65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41],"zh-hant":[8211,45,65374,126,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65307,59]}'));static cache=new Er({getCacheKey:JSON.stringify},e=>{function t(d){let p=new Map;for(let f=0;f<d.length;f+=2)p.set(d[f],d[f+1]);return p}function r(d,p){let f=new Map(d);for(let[m,h]of p)f.set(m,h);return f}function i(d,p){if(!d)return p;let f=new Map;for(let[m,h]of d)p.has(m)&&f.set(m,h);return f}let s=this.ambiguousCharacterData.value,o=e.filter(d=>!d.startsWith("_")&&d in s);o.length===0&&(o=["_default"]);let l;for(let d of o){let p=t(s[d]);l=i(l,p)}let c=t(s._common),u=r(c,l);return new n(u)});static getInstance(e){return n.cache.get(Array.from(e))}static _locales=new Ne(()=>Object.keys(n.ambiguousCharacterData.value).filter(e=>!e.startsWith("_")));static getLocales(){return n._locales.value}isAmbiguous(e){return this.confusableDictionary.has(e)}containsAmbiguousCharacter(e){for(let t=0;t<e.length;t++){let r=e.codePointAt(t);if(typeof r=="number"&&this.isAmbiguous(r))return!0}return!1}getPrimaryConfusable(e){return this.confusableDictionary.get(e)}getConfusableCodePoints(){return new Set(this.confusableDictionary.keys())}};function he(n){return typeof n=="string"}function Gi(n){return typeof n=="object"&&n!==null&&!Array.isArray(n)&&!(n instanceof RegExp)&&!(n instanceof Date)}function bn(n){return typeof n=="number"&&!isNaN(n)}function Zu(n){return typeof n>"u"}function Cr(n){return Zu(n)||n===null}function Ho(n,e){if(!n)throw new Error(e?`Unexpected type, expected '${e}'`:"Unexpected type")}function Sr(n){return typeof n=="function"}function jo(n,e){let t=Math.min(n.length,e.length);for(let r=0;r<t;r++)ec(n[r],e[r])}function ec(n,e){if(he(e)){if(typeof n!==e)throw new Error(`argument does not match constraint: typeof ${e}`)}else if(Sr(e)){try{if(n instanceof e)return}catch{}if(!Cr(n)&&n.constructor===e||e.length===1&&e.call(void 0,n)===!0)return;throw new Error("argument does not match one of these constraints: arg instanceof constraint, arg.constructor === constraint, nor constraint(arg) === true")}}function nt(n){return n===47||n===92}function Qi(n){return n.replace(/[\\/]/g,K.sep)}function Go(n){return n.indexOf("/")===-1&&(n=Qi(n)),/^[a-zA-Z]:(\/|$)/.test(n)&&(n="/"+n),n}function Ji(n,e=K.sep){if(!n)return"";let t=n.length,r=n.charCodeAt(0);if(nt(r)){if(nt(n.charCodeAt(1))&&!nt(n.charCodeAt(2))){let s=3,o=s;for(;s<t&&!nt(n.charCodeAt(s));s++);if(o!==s&&!nt(n.charCodeAt(s+1))){for(s+=1;s<t;s++)if(nt(n.charCodeAt(s)))return n.slice(0,s+1).replace(/[\\/]/g,e)}}return e}else if(Xo(r)&&n.charCodeAt(1)===58)return nt(n.charCodeAt(2))?n.slice(0,2)+e:n.slice(0,2);let i=n.indexOf("://");if(i!==-1){for(i+=3;i<t;i++)if(nt(n.charCodeAt(i)))return n.slice(0,i+1)}return""}function Kt(n,e,t,r=Ye){if(n===e)return!0;if(!n||!e||e.length>n.length)return!1;if(t){if(!Vt(n,e))return!1;if(e.length===n.length)return!0;let s=e.length;return e.charAt(e.length-1)===r&&s--,n.charAt(s)===r}return e.charAt(e.length-1)!==r&&(e+=r),n.indexOf(e)===0}function Xo(n){return n>=65&&n<=90||n>=97&&n<=122}function Qo(n){let e=Je(n);return D?n.length>3?!1:tc(e)&&(n.length===2||e.charCodeAt(2)===92):e===K.sep}function tc(n,e=D){return e?Xo(n.charCodeAt(0))&&n.charCodeAt(1)===58:!1}var nc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",rc="BDEFGHIJKMOQRSTUVWXYZbdefghijkmoqrstuvwxyz0123456789";function Jo(n,e,t=8){let r="";for(let s=0;s<t;s++){let o;s===0&&D&&!e&&(t===3||t===4)?o=rc:o=nc,r+=o.charAt(Math.floor(Math.random()*o.length))}let i;return e?i=`${e}-${r}`:i=r,n?k(n,i):i}var te;(L=>(L.inMemory="inmemory",L.vscode="vscode",L.internal="private",L.walkThrough="walkThrough",L.walkThroughSnippet="walkThroughSnippet",L.http="http",L.https="https",L.file="file",L.mailto="mailto",L.untitled="untitled",L.data="data",L.command="command",L.vscodeRemote="vscode-remote",L.vscodeRemoteResource="vscode-remote-resource",L.vscodeManagedRemoteResource="vscode-managed-remote-resource",L.vscodeUserData="vscode-userdata",L.vscodeCustomEditor="vscode-custom-editor",L.vscodeNotebookCell="vscode-notebook-cell",L.vscodeNotebookCellMetadata="vscode-notebook-cell-metadata",L.vscodeNotebookCellMetadataDiff="vscode-notebook-cell-metadata-diff",L.vscodeNotebookCellOutput="vscode-notebook-cell-output",L.vscodeNotebookCellOutputDiff="vscode-notebook-cell-output-diff",L.vscodeNotebookMetadata="vscode-notebook-metadata",L.vscodeInteractiveInput="vscode-interactive-input",L.vscodeSettings="vscode-settings",L.vscodeWorkspaceTrust="vscode-workspace-trust",L.vscodeTerminal="vscode-terminal",L.vscodeChatCodeBlock="vscode-chat-code-block",L.vscodeChatCodeCompareBlock="vscode-chat-code-compare-block",L.vscodeChatSesssion="vscode-chat-editor",L.webviewPanel="webview-panel",L.vscodeWebview="vscode-webview",L.extension="extension",L.vscodeFileResource="vscode-file",L.tmp="tmp",L.vsls="vsls",L.vscodeSourceControl="vscode-scm",L.commentsInput="comment",L.codeSetting="code-setting",L.outputChannel="output"))(te||={});var sc="tkn",Yi=class{_hosts=Object.create(null);_ports=Object.create(null);_connectionTokens=Object.create(null);_preferredWebSchema="http";_delegate=null;_serverRootPath="/";setPreferredWebSchema(e){this._preferredWebSchema=e}setDelegate(e){this._delegate=e}setServerRootPath(e,t){this._serverRootPath=ac(e,t)}getServerRootPath(){return this._serverRootPath}get _remoteResourcesPath(){return K.join(this._serverRootPath,te.vscodeRemoteResource)}set(e,t,r){this._hosts[e]=t,this._ports[e]=r}setConnectionToken(e,t){this._connectionTokens[e]=t}getPreferredWebSchema(){return this._preferredWebSchema}rewrite(e){if(this._delegate)try{return this._delegate(e)}catch(l){return Be(l),e}let t=e.authority,r=this._hosts[t];r&&r.indexOf(":")!==-1&&r.indexOf("[")===-1&&(r=`[${r}]`);let i=this._ports[t],s=this._connectionTokens[t],o=`path=${encodeURIComponent(e.path)}`;return typeof s=="string"&&(o+=`&${sc}=${encodeURIComponent(s)}`),R.from({scheme:Dt?this._preferredWebSchema:te.vscodeRemoteResource,authority:`${r}:${i}`,path:this._remoteResourcesPath,query:o})}},oc=new Yi;function ac(n,e){return K.join(e??"/",`${n.quality??"oss"}-${n.commit??"dev"}`)}var lc="vscode-app",Zi=class n{static FALLBACK_AUTHORITY=lc;asBrowserUri(e){let t=this.toUri(e);return this.uriToBrowserUri(t)}uriToBrowserUri(e){return e.scheme===te.vscodeRemote?oc.rewrite(e):e.scheme===te.file&&(no||ro===`${te.vscodeFileResource}://${n.FALLBACK_AUTHORITY}`)?e.with({scheme:te.vscodeFileResource,authority:e.authority||n.FALLBACK_AUTHORITY,query:null,fragment:null}):e}asFileUri(e){let t=this.toUri(e);return this.uriToFileUri(t)}uriToFileUri(e){return e.scheme===te.vscodeFileResource?e.with({scheme:te.file,authority:e.authority!==n.FALLBACK_AUTHORITY?e.authority:null,query:null,fragment:null}):e}toUri(e,t){if(R.isUri(e))return e;if(globalThis._VSCODE_FILE_ROOT){let r=globalThis._VSCODE_FILE_ROOT;if(/^\w[\w\d+.-]*:\/\//.test(r))return R.joinPath(R.parse(r,!0),e);let i=k(r,e);return R.file(i)}return R.parse(t.toUrl(e))}},rt=new Zi,uc;(s=>{let n=new Map([["1",{"Cross-Origin-Opener-Policy":"same-origin"}],["2",{"Cross-Origin-Embedder-Policy":"require-corp"}],["3",{"Cross-Origin-Opener-Policy":"same-origin","Cross-Origin-Embedder-Policy":"require-corp"}]]);s.CoopAndCoep=Object.freeze(n.get("3"));let t="vscode-coi";function r(o){let l;typeof o=="string"?l=new URL(o).searchParams:o instanceof URL?l=o.searchParams:R.isUri(o)&&(l=new URL(o.toString(!0)).searchParams);let c=l?.get(t);if(c)return n.get(c)}s.getHeadersFromQuery=r;function i(o,l,c){if(!globalThis.crossOriginIsolated)return;let u=l&&c?"3":c?"2":"1";o instanceof URLSearchParams?o.set(t,u):o[t]=u}s.addSearchParam=i})(uc||={});function ze(n){return an(n,!0)}var yn=class{constructor(e){this._ignorePathCasing=e}compare(e,t,r=!1){return e===t?0:qi(this.getComparisonKey(e,r),this.getComparisonKey(t,r))}isEqual(e,t,r=!1){return e===t?!0:!e||!t?!1:this.getComparisonKey(e,r)===this.getComparisonKey(t,r)}getComparisonKey(e,t=!1){return e.with({path:this._ignorePathCasing(e)?e.path.toLowerCase():void 0,fragment:t?null:void 0}).toString()}ignorePathCasing(e){return this._ignorePathCasing(e)}isEqualOrParent(e,t,r=!1){if(e.scheme===t.scheme){if(e.scheme===te.file)return Kt(ze(e),ze(t),this._ignorePathCasing(e))&&e.query===t.query&&(r||e.fragment===t.fragment);if(Yo(e.authority,t.authority))return Kt(e.path,t.path,this._ignorePathCasing(e),"/")&&e.query===t.query&&(r||e.fragment===t.fragment)}return!1}joinPath(e,...t){return R.joinPath(e,...t)}basenameOrAuthority(e){return pc(e)||e.authority}basename(e){return K.basename(e.path)}extname(e){return K.extname(e.path)}dirname(e){if(e.path.length===0)return e;let t;return e.scheme===te.file?t=R.file(Re(ze(e))).path:(t=K.dirname(e.path),e.authority&&t.length&&t.charCodeAt(0)!==47&&(console.error(`dirname("${e.toString})) resulted in a relative path`),t="/")),e.with({path:t})}normalizePath(e){if(!e.path.length)return e;let t;return e.scheme===te.file?t=R.file(Je(ze(e))).path:t=K.normalize(e.path),e.with({path:t})}relativePath(e,t){if(e.scheme!==t.scheme||!Yo(e.authority,t.authority))return;if(e.scheme===te.file){let s=co(ze(e),ze(t));return D?Qi(s):s}let r=e.path||"/",i=t.path||"/";if(this._ignorePathCasing(e)){let s=0;for(let o=Math.min(r.length,i.length);s<o&&!(r.charCodeAt(s)!==i.charCodeAt(s)&&r.charAt(s).toLowerCase()!==i.charAt(s).toLowerCase());s++);r=i.substr(0,s)+r.substr(s)}return K.relative(r,i)}resolvePath(e,t){if(e.scheme===te.file){let r=R.file(Lt(ze(e),t));return e.with({authority:r.authority,path:r.path})}return t=Go(t),e.with({path:K.resolve(e.path,t)})}isAbsolutePath(e){return!!e.path&&e.path[0]==="/"}isEqualAuthority(e,t){return e===t||e!==void 0&&t!==void 0&&wr(e,t)}hasTrailingPathSeparator(e,t=Ye){if(e.scheme===te.file){let r=ze(e);return r.length>Ji(r).length&&r[r.length-1]===t}else{let r=e.path;return r.length>1&&r.charCodeAt(r.length-1)===47&&!/^[a-zA-Z]:(\/$|\\$)/.test(e.fsPath)}}removeTrailingPathSeparator(e,t=Ye){return Zo(e,t)?e.with({path:e.path.substr(0,e.path.length-1)}):e}addTrailingPathSeparator(e,t=Ye){let r=!1;if(e.scheme===te.file){let i=ze(e);r=i!==void 0&&i.length===Ji(i).length&&i[i.length-1]===t}else{t="/";let i=e.path;r=i.length===1&&i.charCodeAt(i.length-1)===47}return!r&&!Zo(e,t)?e.with({path:e.path+"/"}):e}},q=new yn(()=>!1),es=new yn(n=>n.scheme===te.file?!Ce:!0),X1=new yn(n=>!0),cc=q.isEqual.bind(q),Q1=q.isEqualOrParent.bind(q),J1=q.getComparisonKey.bind(q),dc=q.basenameOrAuthority.bind(q),pc=q.basename.bind(q),fc=q.extname.bind(q),Y1=q.dirname.bind(q),xe=q.joinPath.bind(q),Z1=q.normalizePath.bind(q),eg=q.relativePath.bind(q),tg=q.resolvePath.bind(q),ng=q.isAbsolutePath.bind(q),Yo=q.isEqualAuthority.bind(q),Zo=q.hasTrailingPathSeparator.bind(q),rg=q.removeTrailingPathSeparator.bind(q),ig=q.addTrailingPathSeparator.bind(q);var mc;(s=>{s.META_DATA_LABEL="label",s.META_DATA_DESCRIPTION="description",s.META_DATA_SIZE="size",s.META_DATA_MIME="mime";function i(o){let l=new Map;o.path.substring(o.path.indexOf(";")+1,o.path.lastIndexOf(";")).split(";").forEach(d=>{let[p,f]=d.split(":");p&&f&&l.set(p,f)});let u=o.path.substring(0,o.path.indexOf(";"));return u&&l.set(s.META_DATA_MIME,u),l}s.parseMetaData=i})(mc||={});function _n(n){let e=new Fe,t=n(e.token),r=new Promise((i,s)=>{let o=e.token.onCancellationRequested(()=>{o.dispose(),s(new ge)});Promise.resolve(t).then(l=>{o.dispose(),e.dispose(),i(l)},l=>{o.dispose(),e.dispose(),s(l)})});return new class{cancel(){e.cancel(),e.dispose()}then(i,s){return r.then(i,s)}catch(i){return this.then(void 0,i)}finally(i){return r.finally(i)}}}var ns=class{_isOpen;_promise;_completePromise;constructor(){this._isOpen=!1,this._promise=new Promise((e,t)=>{this._completePromise=e})}isOpen(){return this._isOpen}open(){this._isOpen=!0,this._completePromise(!0)}wait(){return this._promise}},Pr=class extends ns{_timeout;constructor(e){super(),this._timeout=setTimeout(()=>this.open(),e)}open(){clearTimeout(this._timeout),super.open()}};function pe(n,e){return e?new Promise((t,r)=>{let i=setTimeout(()=>{s.dispose(),t()},n),s=e.onCancellationRequested(()=>{clearTimeout(i),s.dispose(),r(new ge)})}):_n(t=>pe(n,t))}var rs=class{_size=0;_isDisposed=!1;runningPromises;maxDegreeOfParalellism;outstandingPromises;_onDrained;constructor(e){this.maxDegreeOfParalellism=e,this.outstandingPromises=[],this.runningPromises=0,this._onDrained=new y}whenIdle(){return this.size>0?G.toPromise(this.onDrained):Promise.resolve()}get onDrained(){return this._onDrained.event}get size(){return this._size}queue(e){if(this._isDisposed)throw new Error("Object has been disposed");return this._size++,new Promise((t,r)=>{this.outstandingPromises.push({factory:e,c:t,e:r}),this.consume()})}consume(){for(;this.outstandingPromises.length&&this.runningPromises<this.maxDegreeOfParalellism;){let e=this.outstandingPromises.shift();this.runningPromises++;let t=e.factory();t.then(e.c,e.e),t.then(()=>this.consumed(),()=>this.consumed())}}consumed(){this._isDisposed||(this.runningPromises--,--this._size===0&&this._onDrained.fire(),this.outstandingPromises.length>0&&this.consume())}clear(){if(this._isDisposed)throw new Error("Object has been disposed");this.outstandingPromises.length=0,this._size=this.runningPromises}dispose(){this._isDisposed=!0,this.outstandingPromises.length=0,this._size=0,this._onDrained.dispose()}},vn=class extends rs{constructor(){super(1)}};var Rr=class{queues=new Map;drainers=new Set;drainListeners=void 0;drainListenerCount=0;async whenDrained(){if(this.isDrained())return;let e=new is;return this.drainers.add(e),e.p}isDrained(){for(let[,e]of this.queues)if(e.size>0)return!1;return!0}queueSize(e,t=q){let r=t.getComparisonKey(e);return this.queues.get(r)?.size??0}queueFor(e,t,r=q){let i=r.getComparisonKey(e),s=this.queues.get(i);if(!s){s=new vn;let o=this.drainListenerCount++,l=G.once(s.onDrained)(()=>{s?.dispose(),this.queues.delete(i),this.onDidQueueDrain(),this.drainListeners?.deleteAndDispose(o),this.drainListeners?.size===0&&(this.drainListeners.dispose(),this.drainListeners=void 0)});this.drainListeners||(this.drainListeners=new cn),this.drainListeners.set(o,l),this.queues.set(i,s)}return s.queue(t)}onDidQueueDrain(){this.isDrained()&&this.releaseDrainers()}releaseDrainers(){for(let e of this.drainers)e.complete();this.drainers.clear()}dispose(){for(let[,e]of this.queues)e.dispose();this.queues.clear(),this.releaseDrainers(),this.drainListeners?.dispose()}};var xn=class{runner;timeoutToken;timeout;timeoutHandler;constructor(e,t){this.timeoutToken=-1,this.runner=e,this.timeout=t,this.timeoutHandler=this.onTimeout.bind(this)}dispose(){this.cancel(),this.runner=null}cancel(){this.isScheduled()&&(clearTimeout(this.timeoutToken),this.timeoutToken=-1)}schedule(e=this.timeout){this.cancel(),this.timeoutToken=setTimeout(this.timeoutHandler,e)}get delay(){return this.timeout}set delay(e){this.timeout=e}isScheduled(){return this.timeoutToken!==-1}flush(){this.isScheduled()&&(this.cancel(),this.doRun())}onTimeout(){this.timeoutToken=-1,this.runner&&this.doRun()}doRun(){this.runner?.()}},In=class{runner;timeout;counter;intervalToken;intervalHandler;constructor(e,t){t%1e3!==0&&console.warn(`ProcessTimeRunOnceScheduler resolution is 1s, ${t}ms is not a multiple of 1000ms.`),this.runner=e,this.timeout=t,this.counter=0,this.intervalToken=-1,this.intervalHandler=this.onInterval.bind(this)}dispose(){this.cancel(),this.runner=null}cancel(){this.isScheduled()&&(clearInterval(this.intervalToken),this.intervalToken=-1)}schedule(e=this.timeout){e%1e3!==0&&console.warn(`ProcessTimeRunOnceScheduler resolution is 1s, ${e}ms is not a multiple of 1000ms.`),this.cancel(),this.counter=Math.ceil(e/1e3),this.intervalToken=setInterval(this.intervalHandler,1e3)}isScheduled(){return this.intervalToken!==-1}onInterval(){this.counter--,!(this.counter>0)&&(clearInterval(this.intervalToken),this.intervalToken=-1,this.runner?.())}};var hc,ts;(function(){typeof globalThis.requestIdleCallback!="function"||typeof globalThis.cancelIdleCallback!="function"?ts=(n,e)=>{so(()=>{if(t)return;let r=Date.now()+15;e(Object.freeze({didTimeout:!0,timeRemaining(){return Math.max(0,r-Date.now())}}))});let t=!1;return{dispose(){t||(t=!0)}}}:ts=(n,e,t)=>{let r=n.requestIdleCallback(e,typeof t=="number"?{timeout:t}:void 0),i=!1;return{dispose(){i||(i=!0,n.cancelIdleCallback(r))}}},hc=n=>ts(globalThis,n)})();var is=class{completeCallback;errorCallback;outcome;get isRejected(){return this.outcome?.outcome===1}get isResolved(){return this.outcome?.outcome===0}get isSettled(){return!!this.outcome}get value(){return this.outcome?.outcome===0?this.outcome?.value:void 0}p;constructor(){this.p=new Promise((e,t)=>{this.completeCallback=e,this.errorCallback=t})}complete(e){return new Promise(t=>{this.completeCallback(e),this.outcome={outcome:0,value:e},t()})}error(e){return new Promise(t=>{this.errorCallback(e),this.outcome={outcome:1,value:e},t()})}cancel(){return this.error(new ge)}},ss;(t=>{async function n(r){let i,s=await Promise.all(r.map(o=>o.then(l=>l,l=>{i||(i=l)})));if(typeof i<"u")throw i;return s}t.settled=n;function e(r){return new Promise(async(i,s)=>{try{await r(i,s)}catch(o){s(o)}})}t.withAsyncBody=e})(ss||={});var ea=class n{static fromArray(e){return new n(t=>{t.emitMany(e)})}static fromPromise(e){return new n(async t=>{t.emitMany(await e)})}static fromPromises(e){return new n(async t=>{await Promise.all(e.map(async r=>t.emitOne(await r)))})}static merge(e){return new n(async t=>{await Promise.all(e.map(async r=>{for await(let i of r)t.emitOne(i)}))})}static EMPTY=n.fromArray([]);_state;_results;_error;_onReturn;_onStateChanged;constructor(e,t){this._state=0,this._results=[],this._error=null,this._onReturn=t,this._onStateChanged=new y,queueMicrotask(async()=>{let r={emitOne:i=>this.emitOne(i),emitMany:i=>this.emitMany(i),reject:i=>this.reject(i)};try{await Promise.resolve(e(r)),this.resolve()}catch(i){this.reject(i)}finally{r.emitOne=void 0,r.emitMany=void 0,r.reject=void 0}})}[Symbol.asyncIterator](){let e=0;return{next:async()=>{do{if(this._state===2)throw this._error;if(e<this._results.length)return{done:!1,value:this._results[e++]};if(this._state===1)return{done:!0,value:void 0};await G.toPromise(this._onStateChanged.event)}while(!0)},return:async()=>(this._onReturn?.(),{done:!0,value:void 0})}}static map(e,t){return new n(async r=>{for await(let i of e)r.emitOne(t(i))})}map(e){return n.map(this,e)}static filter(e,t){return new n(async r=>{for await(let i of e)t(i)&&r.emitOne(i)})}filter(e){return n.filter(this,e)}static coalesce(e){return n.filter(e,t=>!!t)}coalesce(){return n.coalesce(this)}static async toPromise(e){let t=[];for await(let r of e)t.push(r);return t}toPromise(){return n.toPromise(this)}emitOne(e){this._state===0&&(this._results.push(e),this._onStateChanged.fire())}emitMany(e){this._state===0&&(this._results=this._results.concat(e),this._onStateChanged.fire())}resolve(){this._state===0&&(this._state=1,this._onStateChanged.fire())}reject(e){this._state===0&&(this._state=2,this._error=e,this._onStateChanged.fire())}};function ta(n){return(e,t,r)=>{let i=null,s=null;if(typeof r.value=="function"?(i="value",s=r.value):typeof r.get=="function"&&(i="get",s=r.get),!s)throw new Error("not supported");r[i]=n(s,t)}}function z(n,e,t){let r=null,i=null;if(typeof t.value=="function"?(r="value",i=t.value,i.length!==0&&console.warn("Memoize should only be used in functions with zero parameters")):typeof t.get=="function"&&(r="get",i=t.get),!i)throw new Error("not supported");let s=`$memoize$${e}`;t[r]=function(...o){return this.hasOwnProperty(s)||Object.defineProperty(this,s,{configurable:!1,enumerable:!1,writable:!1,value:i.apply(this,o)}),this[s]}}function qt(n,e,t){return ta((r,i)=>{let s=`$debounce$${i}`,o=`$debounce$result$${i}`;return function(...l){this[o]||(this[o]=t?t():void 0),clearTimeout(this[s]),e&&(this[o]=e(this[o],...l),l=[this[o]]),this[s]=setTimeout(()=>{r.apply(this,l),this[o]=t?t():void 0},n)}})}function kr(n,e,t){return ta((r,i)=>{let s=`$throttle$timer$${i}`,o=`$throttle$result$${i}`,l=`$throttle$lastRun$${i}`,c=`$throttle$pending$${i}`;return function(...u){if(this[o]||(this[o]=t?t():void 0),(this[l]===null||this[l]===void 0)&&(this[l]=-Number.MAX_VALUE),e&&(this[o]=e(this[o],...u)),this[c])return;let d=this[l]+n;d<=Date.now()?(this[l]=Date.now(),r.apply(this,[this[o]]),this[o]=t?t():void 0):(this[c]=!0,this[s]=setTimeout(()=>{this[c]=!1,this[l]=Date.now(),r.apply(this,[this[o]]),this[o]=t?t():void 0},d-Date.now()))}})}function Ht(n){switch(n){case 100:return"req";case 101:return"cancel";case 102:return"subscribe";case 103:return"unsubscribe"}}function Dr(n){switch(n){case 200:return"init";case 201:return"reply:";case 202:case 203:return"replyErr:";case 204:return"event:"}}function zt(n){let e=0;for(let t=0;;t+=7){let r=n.read(1);if(e|=(r.buffer[0]&127)<<t,!(r.buffer[0]&128))return e}}var gc=it(0);function $t(n,e){if(e===0){n.write(gc);return}let t=0;for(let i=e;i!==0;i=i>>>7)t++;let r=oe.alloc(t);for(let i=0;e!==0;i++)r.buffer[i]=e&127,e=e>>>7,e>0&&(r.buffer[i]|=128);n.write(r)}var En=class{constructor(e){this.buffer=e}pos=0;read(e){let t=this.buffer.slice(this.pos,this.pos+e);return this.pos+=t.byteLength,t}},Lr=class{buffers=[];get buffer(){return oe.concat(this.buffers)}write(e){this.buffers.push(e)}};function it(n){let e=oe.alloc(1);return e.writeUInt8(n,0),e}var xt={Undefined:it(0),String:it(1),Buffer:it(2),VSBuffer:it(3),Array:it(4),Object:it(5),Uint:it(6)},bc=typeof Buffer<"u";function wn(n,e){if(typeof e>"u")n.write(xt.Undefined);else if(typeof e=="string"){let t=oe.fromString(e);n.write(xt.String),$t(n,t.byteLength),n.write(t)}else if(bc&&Buffer.isBuffer(e)){let t=oe.wrap(e);n.write(xt.Buffer),$t(n,t.byteLength),n.write(t)}else if(e instanceof oe)n.write(xt.VSBuffer),$t(n,e.byteLength),n.write(e);else if(Array.isArray(e)){n.write(xt.Array),$t(n,e.length);for(let t of e)wn(n,t)}else if(typeof e=="number"&&(e|0)===e)n.write(xt.Uint),$t(n,e);else{let t=oe.fromString(JSON.stringify(e));n.write(xt.Object),$t(n,t.byteLength),n.write(t)}}function jt(n){switch(n.read(1).readUInt8(0)){case 0:return;case 1:return n.read(zt(n)).toString();case 2:return n.read(zt(n)).buffer;case 3:return n.read(zt(n));case 4:{let t=zt(n),r=[];for(let i=0;i<t;i++)r.push(jt(n));return r}case 5:return JSON.parse(n.read(zt(n)).toString());case 6:return zt(n)}}var Cn=class{constructor(e,t,r=null,i=1e3){this.protocol=e;this.ctx=t;this.logger=r;this.timeoutDelay=i;this.protocolListener=this.protocol.onMessage(s=>this.onRawMessage(s)),this.sendResponse({type:200})}channels=new Map;activeRequests=new Map;protocolListener;pendingRequests=new Map;registerChannel(e,t){this.channels.set(e,t),setTimeout(()=>this.flushPendingRequests(e),0)}sendResponse(e){switch(e.type){case 200:{let t=this.send([e.type]);this.logger?.logOutgoing(t,0,1,Dr(e.type));return}case 201:case 202:case 204:case 203:{let t=this.send([e.type,e.id],e.data);this.logger?.logOutgoing(t,e.id,1,Dr(e.type),e.data);return}}}send(e,t=void 0){let r=new Lr;return wn(r,e),wn(r,t),this.sendBuffer(r.buffer)}sendBuffer(e){try{return this.protocol.send(e),e.byteLength}catch{return 0}}onRawMessage(e){let t=new En(e),r=jt(t),i=jt(t),s=r[0];switch(s){case 100:return this.logger?.logIncoming(e.byteLength,r[1],1,`${Ht(s)}: ${r[2]}.${r[3]}`,i),this.onPromise({type:s,id:r[1],channelName:r[2],name:r[3],arg:i});case 102:return this.logger?.logIncoming(e.byteLength,r[1],1,`${Ht(s)}: ${r[2]}.${r[3]}`,i),this.onEventListen({type:s,id:r[1],channelName:r[2],name:r[3],arg:i});case 101:return this.logger?.logIncoming(e.byteLength,r[1],1,`${Ht(s)}`),this.disposeActiveRequest({type:s,id:r[1]});case 103:return this.logger?.logIncoming(e.byteLength,r[1],1,`${Ht(s)}`),this.disposeActiveRequest({type:s,id:r[1]})}}onPromise(e){let t=this.channels.get(e.channelName);if(!t){this.collectPendingRequest(e);return}let r=new Fe,i;try{i=t.call(this.ctx,e.name,e.arg,r.token)}catch(l){i=Promise.reject(l)}let s=e.id;i.then(l=>{this.sendResponse({id:s,data:l,type:201})},l=>{l instanceof Error?this.sendResponse({id:s,data:{message:l.message,name:l.name,stack:l.stack?l.stack.split(`
`):void 0},type:202}):this.sendResponse({id:s,data:l,type:203})}).finally(()=>{o.dispose(),this.activeRequests.delete(e.id)});let o=X(()=>r.cancel());this.activeRequests.set(e.id,o)}onEventListen(e){let t=this.channels.get(e.channelName);if(!t){this.collectPendingRequest(e);return}let r=e.id,s=t.listen(this.ctx,e.name,e.arg)(o=>this.sendResponse({id:r,data:o,type:204}));this.activeRequests.set(e.id,s)}disposeActiveRequest(e){let t=this.activeRequests.get(e.id);t&&(t.dispose(),this.activeRequests.delete(e.id))}collectPendingRequest(e){let t=this.pendingRequests.get(e.channelName);t||(t=[],this.pendingRequests.set(e.channelName,t));let r=setTimeout(()=>{console.error(`Unknown channel: ${e.channelName}`),e.type===100&&this.sendResponse({id:e.id,data:{name:"Unknown channel",message:`Channel name '${e.channelName}' timed out after ${this.timeoutDelay}ms`,stack:void 0},type:202})},this.timeoutDelay);t.push({request:e,timeoutTimer:r})}flushPendingRequests(e){let t=this.pendingRequests.get(e);if(t){for(let r of t)switch(clearTimeout(r.timeoutTimer),r.request.type){case 100:this.onPromise(r.request);break;case 102:this.onEventListen(r.request);break}this.pendingRequests.delete(e)}}dispose(){this.protocolListener&&(this.protocolListener.dispose(),this.protocolListener=null),Se(this.activeRequests.values()),this.activeRequests.clear()}};var Tn=class{constructor(e,t=null){this.protocol=e;this.protocolListener=this.protocol.onMessage(r=>this.onBuffer(r)),this.logger=t}isDisposed=!1;state=0;activeRequests=new Set;handlers=new Map;lastRequestId=0;protocolListener;logger;_onDidInitialize=new y;onDidInitialize=this._onDidInitialize.event;getChannel(e){let t=this;return{call(r,i,s){return t.isDisposed?Promise.reject(new ge):t.requestPromise(e,r,i,s)},listen(r,i){return t.isDisposed?G.None:t.requestEvent(e,r,i)}}}requestPromise(e,t,r,i=Bt.None){let s=this.lastRequestId++,l={id:s,type:100,channelName:e,name:t,arg:r};if(i.isCancellationRequested)return Promise.reject(new ge);let c;return new Promise((d,p)=>{if(i.isCancellationRequested)return p(new ge);let f=()=>{let T=A=>{switch(A.type){case 201:this.handlers.delete(s),d(A.data);break;case 202:{this.handlers.delete(s);let $=new Error(A.data.message);$.stack=Array.isArray(A.data.stack)?A.data.stack.join(`
`):A.data.stack,$.name=A.data.name,p($);break}case 203:this.handlers.delete(s),p(A.data);break}};this.handlers.set(s,T),this.sendRequest(l)},m=null;this.state===1?f():(m=_n(T=>this.whenInitialized()),m.then(()=>{m=null,f()}));let h=()=>{m?(m.cancel(),m=null):this.sendRequest({id:s,type:101}),p(new ge)},_=i.onCancellationRequested(h);c=lr(X(h),_),this.activeRequests.add(c)}).finally(()=>{c.dispose(),this.activeRequests.delete(c)})}requestEvent(e,t,r){let i=this.lastRequestId++,o={id:i,type:102,channelName:e,name:t,arg:r},l=null,c=new y({onWillAddFirstListener:()=>{l=_n(d=>this.whenInitialized()),l.then(()=>{l=null,this.activeRequests.add(c),this.sendRequest(o)})},onDidRemoveLastListener:()=>{l?(l.cancel(),l=null):(this.activeRequests.delete(c),this.sendRequest({id:i,type:103}))}}),u=d=>c.fire(d.data);return this.handlers.set(i,u),c.event}sendRequest(e){switch(e.type){case 100:case 102:{let t=this.send([e.type,e.id,e.channelName,e.name],e.arg);this.logger?.logOutgoing(t,e.id,0,`${Ht(e.type)}: ${e.channelName}.${e.name}`,e.arg);return}case 101:case 103:{let t=this.send([e.type,e.id]);this.logger?.logOutgoing(t,e.id,0,Ht(e.type));return}}}send(e,t=void 0){let r=new Lr;return wn(r,e),wn(r,t),this.sendBuffer(r.buffer)}sendBuffer(e){try{return this.protocol.send(e),e.byteLength}catch{return 0}}onBuffer(e){let t=new En(e),r=jt(t),i=jt(t),s=r[0];switch(s){case 200:return this.logger?.logIncoming(e.byteLength,0,0,Dr(s)),this.onResponse({type:r[0]});case 201:case 202:case 204:case 203:return this.logger?.logIncoming(e.byteLength,r[1],0,Dr(s),i),this.onResponse({type:r[0],id:r[1],data:i})}}onResponse(e){if(e.type===200){this.state=1,this._onDidInitialize.fire();return}this.handlers.get(e.id)?.(e)}get onDidInitializePromise(){return G.toPromise(this.onDidInitialize)}whenInitialized(){return this.state===1?Promise.resolve():this.onDidInitializePromise}dispose(){this.isDisposed=!0,this.protocolListener&&(this.protocolListener.dispose(),this.protocolListener=null),Se(this.activeRequests.values()),this.activeRequests.clear()}};b([z],Tn.prototype,"onDidInitializePromise",1);var Or=class{channels=new Map;_connections=new Set;_onDidAddConnection=new y;onDidAddConnection=this._onDidAddConnection.event;_onDidRemoveConnection=new y;onDidRemoveConnection=this._onDidRemoveConnection.event;disposables=new ue;get connections(){let e=[];return this._connections.forEach(t=>e.push(t)),e}constructor(e,t,r){this.disposables.add(e(({protocol:i,onDidClientDisconnect:s})=>{let o=G.once(i.onMessage);this.disposables.add(o(l=>{let c=new En(l),u=jt(c),d=new Cn(i,u,t,r),p=new Tn(i,t);this.channels.forEach((m,h)=>d.registerChannel(h,m));let f={channelServer:d,channelClient:p,ctx:u};this._connections.add(f),this._onDidAddConnection.fire(f),this.disposables.add(s(()=>{d.dispose(),p.dispose(),this._connections.delete(f),this._onDidRemoveConnection.fire(f)}))}))}))}getChannel(e,t){let r=this;return{call(i,s,o){let l;if(Sr(t)){let u=Gs(r.connections.filter(t));l=u?Promise.resolve(u):G.toPromise(G.filter(r.onDidAddConnection,t))}else l=t.routeCall(r,i,s);let c=l.then(u=>u.channelClient.getChannel(e));return na(c).call(i,s,o)},listen(i,s){if(Sr(t))return r.getMulticastEvent(e,t,i,s);let o=t.routeEvent(r,i,s).then(l=>l.channelClient.getChannel(e));return na(o).listen(i,s)}}}getMulticastEvent(e,t,r,i){let s=this,o,l=new y({onWillAddFirstListener:()=>{o=new ue;let c=new Ir,u=new Map,d=f=>{let h=f.channelClient.getChannel(e).listen(r,i),_=c.add(h);u.set(f,_)},p=f=>{let m=u.get(f);m&&(m.dispose(),u.delete(f))};s.connections.filter(t).forEach(d),G.filter(s.onDidAddConnection,t)(d,void 0,o),s.onDidRemoveConnection(p,void 0,o),c.event(l.fire,l,o),o.add(c)},onDidRemoveLastListener:()=>{o?.dispose(),o=void 0}});return l.event}registerChannel(e,t){this.channels.set(e,t);for(let r of this._connections)r.channelServer.registerChannel(e,t)}dispose(){this.disposables.dispose();for(let e of this._connections)e.channelClient.dispose(),e.channelServer.dispose();this._connections.clear(),this.channels.clear(),this._onDidAddConnection.dispose(),this._onDidRemoveConnection.dispose()}};function na(n){return{call(e,t,r){return n.then(i=>i.call(e,t,r))},listen(e,t){let r=new _r;return n.then(i=>r.input=i.listen(e,t)),r.event}}}var Ar;(i=>{function n(s,o,l){let c=s,u=l&&l.disableMarshalling,d=new Map;for(let p in c)t(p)&&d.set(p,G.buffer(c[p],!0,void 0,o));return new class{listen(p,f,m){let h=d.get(f);if(h)return h;let _=c[f];if(typeof _=="function"){if(r(f))return _.call(c,m);if(t(f))return d.set(f,G.buffer(c[f],!0,void 0,o)),d.get(f)}throw new Ae(`Event not found: ${f}`)}call(p,f,m){let h=c[f];if(typeof h=="function"){if(!u&&Array.isArray(m))for(let T=0;T<m.length;T++)m[T]=gn(m[T]);let _=h.apply(c,m);return _ instanceof Promise||(_=Promise.resolve(_)),_}throw new Ae(`Method not found: ${f}`)}}}i.fromService=n;function e(s,o){let l=o&&o.disableMarshalling;return new Proxy({},{get(c,u){if(typeof u=="string")return o?.properties?.has(u)?o.properties.get(u):r(u)?function(d){return s.listen(u,d)}:t(u)?s.listen(u):async function(...d){let p;o&&!Cr(o.context)?p=[o.context,...d]:p=d;let f=await s.call(u,p);return l?f:gn(f)};throw new Ae(`Property not found: ${String(u)}`)}})}i.toService=e;function t(s){return s[0]==="o"&&s[1]==="n"&&$i(s.charCodeAt(2))}function r(s){return/^onDynamic/.test(s)&&$i(s.charCodeAt(9))}})(Ar||={});function ra(n,e){let t=e.toLowerCase(),r=Object.keys(n).find(i=>i.toLowerCase()===t);return r?n[r]:n[e]}import{promises as ca}from"fs";import*as M from"fs";import{tmpdir as Ic}from"os";import{promisify as Mr}from"util";var yc=new qe(1e4);function os(n){return xc(n,"NFC",yc)}var jg=new qe(1e4);var vc=/[^\u0000-\u0080]/;function xc(n,e,t){if(!n)return n;let r=t.get(n);if(r)return r;let i;return vc.test(n)?i=n.normalize(e):i=n,t.set(n,i),i}async function sa(n,e=0,t){if(Qo(n))throw new Error("rimraf - will refuse to recursively delete root");return e===0?as(n):_c(n,t)}async function _c(n,e=Jo(Ic())){try{try{await M.promises.rename(n,e)}catch(t){return t.code==="ENOENT"?void 0:as(n)}as(e).catch(t=>{})}catch(t){if(t.code!=="ENOENT")throw t}}async function as(n){return M.promises.rm(n,{recursive:!0,force:!0,maxRetries:3})}async function Fr(n,e){return Ec(await(e?Tc(n):M.promises.readdir(n)))}async function Tc(n){try{return await M.promises.readdir(n,{withFileTypes:!0})}catch(r){console.warn("[node.js fs] readdir with filetypes failed with error: ",r)}let e=[],t=await Fr(n);for(let r of t){let i=!1,s=!1,o=!1;try{let l=await M.promises.lstat(k(n,r));i=l.isFile(),s=l.isDirectory(),o=l.isSymbolicLink()}catch(l){console.warn("[node.js fs] unexpected error from lstat after readdir: ",l)}e.push({name:r,isFile:()=>i,isDirectory:()=>s,isSymbolicLink:()=>o})}return e}function Ec(n){return n.map(e=>typeof e=="string"?be?os(e):e:(e.name=be?os(e.name):e.name,e))}async function wc(n){let e=await Fr(n),t=[];for(let r of e)await $e.existsDirectory(k(n,r))&&t.push(r);return t}var $e;(r=>{async function n(i){let s;try{if(s=await M.promises.lstat(i),!s.isSymbolicLink())return{stat:s}}catch{}try{return{stat:await M.promises.stat(i),symbolicLink:s?.isSymbolicLink()?{dangling:!1}:void 0}}catch(o){if(o.code==="ENOENT"&&s)return{stat:s,symbolicLink:{dangling:!0}};if(D&&o.code==="EACCES")try{return{stat:await M.promises.stat(await M.promises.readlink(i)),symbolicLink:{dangling:!1}}}catch(l){if(l.code==="ENOENT"&&s)return{stat:s,symbolicLink:{dangling:!0}};throw l}throw o}}r.stat=n;async function e(i){try{let{stat:s,symbolicLink:o}=await r.stat(i);return s.isFile()&&o?.dangling!==!0}catch{}return!1}r.existsFile=e;async function t(i){try{let{stat:s,symbolicLink:o}=await r.stat(i);return s.isDirectory()&&o?.dangling!==!0}catch{}return!1}r.existsDirectory=t})($e||={});var Cc=new Rr;function Sc(n,e,t){return Cc.queueFor(R.file(n),()=>{let r=kc(t);return new Promise((i,s)=>Rc(n,e,r,o=>o?s(o):i()))},es)}var oa=!0;function Pc(n){oa=n}function Rc(n,e,t,r){if(!oa)return M.writeFile(n,e,{mode:t.mode,flag:t.flag},r);M.open(n,t.flag,t.mode,(i,s)=>{if(i)return r(i);M.writeFile(s,e,o=>{if(o)return M.close(s,()=>r(o));M.fdatasync(s,l=>(l&&(console.warn("[node.js fs] fdatasync is now disabled for this session because it failed: ",l),Pc(!1)),M.close(s,c=>r(c))))})})}function kc(n){return n?{mode:typeof n.mode=="number"?n.mode:438,flag:typeof n.flag=="string"?n.flag:"w"}:{mode:438,flag:"w"}}async function Dc(n,e,t=6e4){if(n!==e)try{D&&typeof t=="number"?await aa(n,e,Date.now(),t):await M.promises.rename(n,e)}catch(r){if(n.toLowerCase()!==e.toLowerCase()&&r.code==="EXDEV"||n.endsWith("."))await la(n,e,{preserveSymlinks:!1}),await sa(n,1);else throw r}}async function aa(n,e,t,r,i=0){try{return await M.promises.rename(n,e)}catch(s){if(s.code!=="EACCES"&&s.code!=="EPERM"&&s.code!=="EBUSY")throw s;if(Date.now()-t>=r)throw console.error(`[node.js fs] rename failed after ${i} retries with error: ${s}`),s;if(i===0){let o=!1;try{let{stat:l}=await $e.stat(e);l.isFile()||(o=!0)}catch{}if(o)throw s}return await pe(Math.min(100,i*10)),aa(n,e,t,r,i+1)}}async function la(n,e,t){return ua(n,e,{root:{source:n,target:e},options:t,handledSourcePaths:new Set})}var ia=511;async function ua(n,e,t){if(t.handledSourcePaths.has(n))return;t.handledSourcePaths.add(n);let{stat:r,symbolicLink:i}=await $e.stat(n);if(i){if(t.options.preserveSymlinks)try{return await Ac(n,e,t)}catch{}if(i.dangling)return}return r.isDirectory()?Lc(n,e,r.mode&ia,t):Oc(n,e,r.mode&ia)}async function Lc(n,e,t,r){await M.promises.mkdir(e,{recursive:!0,mode:t});let i=await Fr(n);for(let s of i)await ua(k(n,s),k(e,s),r)}async function Oc(n,e,t){await M.promises.copyFile(n,e),await M.promises.chmod(e,t)}async function Ac(n,e,t){let r=await M.promises.readlink(n);Kt(r,t.root.source,!Ce)&&(r=k(t.root.target,r.substr(t.root.source.length+1))),await M.promises.symlink(r,e)}var It=new class{get read(){return(n,e,t,r,i)=>new Promise((s,o)=>{M.read(n,e,t,r,i,(l,c,u)=>l?o(l):s({bytesRead:c,buffer:u}))})}get write(){return(n,e,t,r,i)=>new Promise((s,o)=>{M.write(n,e,t,r,i,(l,c,u)=>l?o(l):s({bytesWritten:c,buffer:u}))})}get fdatasync(){return Mr(M.fdatasync)}get open(){return Mr(M.open)}get close(){return Mr(M.close)}get realpath(){return Mr(M.realpath)}async exists(n){try{return await M.promises.access(n),!0}catch{return!1}}get readdir(){return Fr}get readDirsInDir(){return wc}get writeFile(){return Sc}get rm(){return sa}get rename(){return Dc}get copy(){return la}};function da(n=de){return n.comspec||"cmd.exe"}var Mc;(e=>{async function n(t,r,i){if(ft(t))return t;if(r===void 0&&(r=Ke()),Re(t)!==".")return k(r,t);if(i===void 0&&he(de.PATH)&&(i=de.PATH.split(Ot)),i===void 0||i.length===0)return k(r,t);async function o(l){if(await It.exists(l)){let c;try{c=await ca.stat(l)}catch(u){u.message.startsWith("EACCES")&&(c=await ca.lstat(l))}return c?!c.isDirectory():!1}return!1}for(let l of i){let c;if(ft(l)?c=k(l,t):c=k(r,l,t),await o(c))return c;let u=c+".com";if(await o(u)||(u=c+".exe",await o(u)))return u}return k(r,t)}e.findExecutable=n})(Mc||={});var Ur=class extends Cn{constructor(e){super({send:t=>{try{process.send?.(t.buffer.toString("base64"))}catch{}},onMessage:G.fromNodeEventEmitter(process,"message",t=>oe.wrap(Buffer.from(t,"base64")))},e),process.once("disconnect",()=>this.dispose())}};function Nr(n){return!!n.parentPort}var us=class{constructor(e){this.port=e;e.start()}onMessage=G.fromNodeEventEmitter(this.port,"message",e=>e.data?oe.wrap(e.data):oe.alloc(0));send(e){this.port.postMessage(e.buffer)}disconnect(){this.port.close()}},Br=class n extends Or{static getOnDidClientConnect(e){Ho(Nr(process),"Electron Utility Process");let t=new y;return process.parentPort.on("message",r=>{if(e?.handledClientConnection(r))return;let i=r.ports.at(0);i&&t.fire(i)}),G.map(t.event,r=>({protocol:new us(r),onDidClientDisconnect:G.fromNodeEventEmitter(r,"close")}))}constructor(e){super(n.getOnDidClientConnect(e))}};var ga=Wl(ha());var Xb={o:v("optionsUpperCase","Options"),e:v("extensionsManagement","Extensions Management"),t:v("troubleshooting","Troubleshooting")};var ba={tunnel:{type:"subcommand",description:"Make the current machine accessible from vscode.dev or other machines through a secure tunnel",options:{"cli-data-dir":{type:"string",args:"dir",description:v("cliDataDir","Directory where CLI metadata should be stored.")},"disable-telemetry":{type:"boolean"},"telemetry-level":{type:"string"},user:{type:"subcommand",options:{login:{type:"subcommand",options:{provider:{type:"string"},"access-token":{type:"string"}}}}}}},"serve-web":{type:"subcommand",description:"Run a server that displays the editor UI in browsers.",options:{"cli-data-dir":{type:"string",args:"dir",description:v("cliDataDir","Directory where CLI metadata should be stored.")},"disable-telemetry":{type:"boolean"},"telemetry-level":{type:"string"}}},diff:{type:"boolean",cat:"o",alias:"d",args:["file","file"],description:v("diff","Compare two files with each other.")},merge:{type:"boolean",cat:"o",alias:"m",args:["path1","path2","base","result"],description:v("merge","Perform a three-way merge by providing paths for two modified versions of a file, the common origin of both modified versions and the output file to save merge results.")},add:{type:"boolean",cat:"o",alias:"a",args:"folder",description:v("add","Add folder(s) to the last active window.")},goto:{type:"boolean",cat:"o",alias:"g",args:"file:line[:character]",description:v("goto","Open a file at the path on the specified line and character position.")},"new-window":{type:"boolean",cat:"o",alias:"n",description:v("newWindow","Force to open a new window.")},"reuse-window":{type:"boolean",cat:"o",alias:"r",description:v("reuseWindow","Force to open a file or folder in an already opened window.")},wait:{type:"boolean",cat:"o",alias:"w",description:v("wait","Wait for the files to be closed before returning.")},waitMarkerFilePath:{type:"string"},locale:{type:"string",cat:"o",args:"locale",description:v("locale","The locale to use (e.g. en-US or zh-TW).")},"user-data-dir":{type:"string",cat:"o",args:"dir",description:v("userDataDir","Specifies the directory that user data is kept in. Can be used to open multiple distinct instances of Code.")},profile:{type:"string",cat:"o",args:"profileName",description:v("profileName","Opens the provided folder or workspace with the given profile and associates the profile with the workspace. If the profile does not exist, a new empty one is created.")},help:{type:"boolean",cat:"o",alias:"h",description:v("help","Print usage.")},"extensions-dir":{type:"string",deprecates:["extensionHomePath"],cat:"e",args:"dir",description:v("extensionHomePath","Set the root path for extensions.")},"extensions-download-dir":{type:"string"},"builtin-extensions-dir":{type:"string"},"list-extensions":{type:"boolean",cat:"e",description:v("listExtensions","List the installed extensions.")},"show-versions":{type:"boolean",cat:"e",description:v("showVersions","Show versions of installed extensions, when using --list-extensions.")},category:{type:"string",allowEmptyValue:!0,cat:"e",description:v("category","Filters installed extensions by provided category, when using --list-extensions."),args:"category"},"install-extension":{type:"string[]",cat:"e",args:"ext-id | path",description:v("installExtension","Installs or updates an extension. The argument is either an extension id or a path to a VSIX. The identifier of an extension is '${publisher}.${name}'. Use '--force' argument to update to latest version. To install a specific version provide '@${version}'. For example: 'vscode.csharp@1.2.3'.")},"pre-release":{type:"boolean",cat:"e",description:v("install prerelease","Installs the pre-release version of the extension, when using --install-extension")},"uninstall-extension":{type:"string[]",cat:"e",args:"ext-id",description:v("uninstallExtension","Uninstalls an extension.")},"update-extensions":{type:"boolean",cat:"e",description:v("updateExtensions","Update the installed extensions.")},"enable-proposed-api":{type:"string[]",allowEmptyValue:!0,cat:"e",args:"ext-id",description:v("experimentalApis","Enables proposed API features for extensions. Can receive one or more extension IDs to enable individually.")},version:{type:"boolean",cat:"t",alias:"v",description:v("version","Print version.")},verbose:{type:"boolean",cat:"t",global:!0,description:v("verbose","Print verbose output (implies --wait).")},log:{type:"string[]",cat:"t",args:"level",global:!0,description:v("log","Log level to use. Default is 'info'. Allowed values are 'critical', 'error', 'warn', 'info', 'debug', 'trace', 'off'. You can also configure the log level of an extension by passing extension id and log level in the following format: '${publisher}.${name}:${logLevel}'. For example: 'vscode.csharp:trace'. Can receive one or more such entries.")},status:{type:"boolean",alias:"s",cat:"t",description:v("status","Print process usage and diagnostics information.")},"prof-startup":{type:"boolean",cat:"t",description:v("prof-startup","Run CPU profiler during startup.")},"prof-append-timers":{type:"string"},"prof-duration-markers":{type:"string[]"},"prof-duration-markers-file":{type:"string"},"no-cached-data":{type:"boolean"},"prof-startup-prefix":{type:"string"},"prof-v8-extensions":{type:"boolean"},"disable-extensions":{type:"boolean",deprecates:["disableExtensions"],cat:"t",description:v("disableExtensions","Disable all installed extensions. This option is not persisted and is effective only when the command opens a new window.")},"disable-extension":{type:"string[]",cat:"t",args:"ext-id",description:v("disableExtension","Disable the provided extension. This option is not persisted and is effective only when the command opens a new window.")},sync:{type:"string",cat:"t",description:v("turn sync","Turn sync on or off."),args:["on | off"]},"inspect-extensions":{type:"string",allowEmptyValue:!0,deprecates:["debugPluginHost"],args:"port",cat:"t",description:v("inspect-extensions","Allow debugging and profiling of extensions. Check the developer tools for the connection URI.")},"inspect-brk-extensions":{type:"string",allowEmptyValue:!0,deprecates:["debugBrkPluginHost"],args:"port",cat:"t",description:v("inspect-brk-extensions","Allow debugging and profiling of extensions with the extension host being paused after start. Check the developer tools for the connection URI.")},"disable-lcd-text":{type:"boolean",cat:"t",description:v("disableLCDText","Disable LCD font rendering.")},"disable-gpu":{type:"boolean",cat:"t",description:v("disableGPU","Disable GPU hardware acceleration.")},"disable-chromium-sandbox":{type:"boolean",cat:"t",description:v("disableChromiumSandbox","Use this option only when there is requirement to launch the application as sudo user on Linux or when running as an elevated user in an applocker environment on Windows.")},sandbox:{type:"boolean"},telemetry:{type:"boolean",cat:"t",description:v("telemetry","Shows all telemetry events which VS code collects.")},remote:{type:"string",allowEmptyValue:!0},"folder-uri":{type:"string[]",cat:"o",args:"uri"},"file-uri":{type:"string[]",cat:"o",args:"uri"},"locate-extension":{type:"string[]"},extensionDevelopmentPath:{type:"string[]"},extensionDevelopmentKind:{type:"string[]"},extensionTestsPath:{type:"string"},extensionEnvironment:{type:"string"},debugId:{type:"string"},debugRenderer:{type:"boolean"},"inspect-ptyhost":{type:"string",allowEmptyValue:!0},"inspect-brk-ptyhost":{type:"string",allowEmptyValue:!0},"inspect-search":{type:"string",deprecates:["debugSearch"],allowEmptyValue:!0},"inspect-brk-search":{type:"string",deprecates:["debugBrkSearch"],allowEmptyValue:!0},"inspect-sharedprocess":{type:"string",allowEmptyValue:!0},"inspect-brk-sharedprocess":{type:"string",allowEmptyValue:!0},"export-default-configuration":{type:"string"},"install-source":{type:"string"},"enable-smoke-test-driver":{type:"boolean"},logExtensionHostCommunication:{type:"boolean"},"skip-release-notes":{type:"boolean"},"skip-welcome":{type:"boolean"},"disable-telemetry":{type:"boolean"},"disable-updates":{type:"boolean"},"use-inmemory-secretstorage":{type:"boolean",deprecates:["disable-keytar"]},"password-store":{type:"string"},"disable-workspace-trust":{type:"boolean"},"disable-crash-reporter":{type:"boolean"},"crash-reporter-directory":{type:"string"},"crash-reporter-id":{type:"string"},"skip-add-to-recently-opened":{type:"boolean"},"open-url":{type:"boolean"},"file-write":{type:"boolean"},"file-chmod":{type:"boolean"},"install-builtin-extension":{type:"string[]"},force:{type:"boolean"},"do-not-sync":{type:"boolean"},trace:{type:"boolean"},"trace-category-filter":{type:"string"},"trace-options":{type:"string"},"preserve-env":{type:"boolean"},"force-user-env":{type:"boolean"},"force-disable-user-env":{type:"boolean"},"open-devtools":{type:"boolean"},"disable-gpu-sandbox":{type:"boolean"},logsPath:{type:"string"},"__enable-file-policy":{type:"boolean"},editSessionId:{type:"string"},continueOn:{type:"string"},"locate-shell-integration-path":{type:"string",args:["bash","pwsh","zsh","fish"]},"enable-coi":{type:"boolean"},"no-proxy-server":{type:"boolean"},"no-sandbox":{type:"boolean",alias:"sandbox"},"proxy-server":{type:"string"},"proxy-bypass-list":{type:"string"},"proxy-pac-url":{type:"string"},"js-flags":{type:"string"},inspect:{type:"string",allowEmptyValue:!0},"inspect-brk":{type:"string",allowEmptyValue:!0},nolazy:{type:"boolean"},"force-device-scale-factor":{type:"string"},"force-renderer-accessibility":{type:"boolean"},"ignore-certificate-errors":{type:"boolean"},"allow-insecure-localhost":{type:"boolean"},"log-net-log":{type:"string"},vmodule:{type:"string"},_urls:{type:"string[]"},"disable-dev-shm-usage":{type:"boolean"},"profile-temp":{type:"boolean"},"ozone-platform":{type:"string"},"enable-tracing":{type:"string"},"trace-startup-format":{type:"string"},"trace-startup-file":{type:"string"},"trace-startup-duration":{type:"string"},_:{type:"string[]"}},Nc={onUnknownOption:()=>{},onMultipleValues:()=>{},onEmptyValue:()=>{},onDeprecatedOption:()=>{}};function cs(n,e,t=Nc){let r=n.find(f=>f.length>0&&f[0]!=="-"),i={},s=["_"],o=[],l={},c;for(let f in e){let m=e[f];m.type==="subcommand"?f===r&&(c=m):(m.alias&&(i[f]=m.alias),m.type==="string"||m.type==="string[]"?(s.push(f),m.deprecates&&s.push(...m.deprecates)):m.type==="boolean"&&(o.push(f),m.deprecates&&o.push(...m.deprecates)),m.global&&(l[f]=m))}if(c&&r){let f=l;for(let T in c.options)f[T]=c.options[T];let m=n.filter(T=>T!==r),h=t.getSubcommandReporter?t.getSubcommandReporter(r):void 0,_=cs(m,f,h);return{[r]:_,_:[]}}let u=(0,ga.default)(n,{string:s,boolean:o,alias:i}),d={},p=u;d._=u._.map(f=>String(f)).filter(f=>f.length>0),delete p._;for(let f in e){let m=e[f];if(m.type==="subcommand")continue;m.alias&&delete p[m.alias];let h=p[f];if(m.deprecates)for(let _ of m.deprecates)p.hasOwnProperty(_)&&(h||(h=p[_],h&&t.onDeprecatedOption(_,m.deprecationMessage||v("deprecated.useInstead","Use {0} instead.",f))),delete p[_]);if(typeof h<"u"){if(m.type==="string[]"){if(Array.isArray(h)||(h=[h]),!m.allowEmptyValue){let _=h.filter(T=>T.length>0);_.length!==h.length&&(t.onEmptyValue(f),h=_.length>0?_:void 0)}}else m.type==="string"&&(Array.isArray(h)?(h=h.pop(),t.onMultipleValues(f,h)):!h&&!m.allowEmptyValue&&(t.onEmptyValue(f),h=void 0));d[f]=h,m.deprecationMessage&&t.onDeprecatedOption(f,m.deprecationMessage)}delete p[f]}for(let f in p)t.onUnknownOption(f);return d}import{homedir as Hc,tmpdir as jc}from"os";var st;(i=>{i.serviceIds=new Map,i.DI_TARGET="$di$target",i.DI_DEPENDENCIES="$di$dependencies";function r(s){return s[i.DI_DEPENDENCIES]||[]}i.getServiceDependencies=r})(st||={});var l0=Y("instantiationService");function Bc(n,e,t){e[st.DI_TARGET]===e?e[st.DI_DEPENDENCIES].push({id:n,index:t}):(e[st.DI_DEPENDENCIES]=[{id:n,index:t}],e[st.DI_TARGET]=e)}function Y(n){if(st.serviceIds.has(n))return st.serviceIds.get(n);let e=function(t,r,i){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");Bc(e,t,i)};return e.toString=()=>n,st.serviceIds.set(n,e),e}var Wc=Y("environmentService"),m0=Wc;var Vc=60,Kc=Vc*60,ds=Kc*24,b0=ds*7,y0=ds*30,v0=ds*365;function ya(n){return n.getFullYear()+"-"+String(n.getMonth()+1).padStart(2,"0")+"-"+String(n.getDate()).padStart(2,"0")+"T"+String(n.getHours()).padStart(2,"0")+":"+String(n.getMinutes()).padStart(2,"0")+":"+String(n.getSeconds()).padStart(2,"0")+"."+(n.getMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}var va=Y("productService");var xa=/^([^.]+\..+)[:=](.+)$/,H=class{constructor(e,t,r){this._args=e;this.paths=t;this.productService=r}get appRoot(){return Re(rt.asFileUri("").fsPath)}get userHome(){return R.file(this.paths.homeDir)}get userDataPath(){return this.paths.userDataDir}get appSettingsHome(){return R.file(k(this.userDataPath,"User"))}get tmpDir(){return R.file(this.paths.tmpDir)}get cacheHome(){return R.file(this.userDataPath)}get stateResource(){return xe(this.appSettingsHome,"globalStorage","storage.json")}get userRoamingDataHome(){return this.appSettingsHome.with({scheme:te.vscodeUserData})}get userDataSyncHome(){return xe(this.appSettingsHome,"sync")}get logsHome(){if(!this.args.logsPath){let e=ya(new Date).replace(/-|:|\.\d+Z$/g,"");this.args.logsPath=k(this.userDataPath,"logs",e)}return R.file(this.args.logsPath)}get sync(){return this.args.sync}get machineSettingsResource(){return xe(R.file(k(this.userDataPath,"Machine")),"settings.json")}get workspaceStorageHome(){return xe(this.appSettingsHome,"workspaceStorage")}get localHistoryHome(){return xe(this.appSettingsHome,"History")}get keyboardLayoutResource(){return xe(this.userRoamingDataHome,"keyboardLayout.json")}get argvResource(){let e=de.VSCODE_PORTABLE;return e?R.file(k(e,"argv.json")):xe(this.userHome,this.productService.dataFolderName,"argv.json")}get isExtensionDevelopment(){return!!this.args.extensionDevelopmentPath}get untitledWorkspacesHome(){return R.file(k(this.userDataPath,"Workspaces"))}get builtinExtensionsPath(){let e=this.args["builtin-extensions-dir"];return e?Lt(e):Je(k(rt.asFileUri("").fsPath,"..","extensions"))}get extensionsDownloadLocation(){let e=this.args["extensions-download-dir"];return e?R.file(Lt(e)):R.file(k(this.userDataPath,"CachedExtensionVSIXs"))}get extensionsPath(){let e=this.args["extensions-dir"];if(e)return Lt(e);let t=de.VSCODE_EXTENSIONS;if(t)return t;let r=de.VSCODE_PORTABLE;return r?k(r,"extensions"):xe(this.userHome,this.productService.dataFolderName,"extensions").fsPath}get extensionDevelopmentLocationURI(){let e=this.args.extensionDevelopmentPath;if(Array.isArray(e))return e.map(t=>/^[^:/?#]+?:\/\//.test(t)?R.parse(t):R.file(Je(t)))}get extensionDevelopmentKind(){return this.args.extensionDevelopmentKind?.map(e=>e==="ui"||e==="workspace"||e==="web"?e:"workspace")}get extensionTestsLocationURI(){let e=this.args.extensionTestsPath;if(e)return/^[^:/?#]+?:\/\//.test(e)?R.parse(e):R.file(Je(e))}get disableExtensions(){if(this.args["disable-extensions"])return!0;let e=this.args["disable-extension"];if(e){if(typeof e=="string")return[e];if(Array.isArray(e)&&e.length>0)return e}return!1}get debugExtensionHost(){return qc(this.args,this.isBuilt)}get debugRenderer(){return!!this.args.debugRenderer}get isBuilt(){return!de.VSCODE_DEV}get verbose(){return!!this.args.verbose}get logLevel(){return this.args.log?.find(e=>!xa.test(e))}get extensionLogLevel(){let e=[];for(let t of this.args.log||[]){let r=xa.exec(t);r&&r[1]&&r[2]&&e.push([r[1],r[2]])}return e.length?e:void 0}get serviceMachineIdResource(){return xe(R.file(this.userDataPath),"machineid")}get crashReporterId(){return this.args["crash-reporter-id"]}get crashReporterDirectory(){return this.args["crash-reporter-directory"]}get disableTelemetry(){return!!this.args["disable-telemetry"]}get disableWorkspaceTrust(){return!!this.args["disable-workspace-trust"]}get useInMemorySecretStorage(){return!!this.args["use-inmemory-secretstorage"]}get policyFile(){if(this.args["__enable-file-policy"]){let e=de.VSCODE_PORTABLE;return e?R.file(k(e,"policy.json")):xe(this.userHome,this.productService.dataFolderName,"policy.json")}}editSessionId=this.args.editSessionId;get continueOn(){return this.args.continueOn}set continueOn(e){this.args.continueOn=e}get args(){return this._args}};b([z],H.prototype,"appRoot",1),b([z],H.prototype,"userHome",1),b([z],H.prototype,"userDataPath",1),b([z],H.prototype,"appSettingsHome",1),b([z],H.prototype,"tmpDir",1),b([z],H.prototype,"cacheHome",1),b([z],H.prototype,"stateResource",1),b([z],H.prototype,"userRoamingDataHome",1),b([z],H.prototype,"userDataSyncHome",1),b([z],H.prototype,"sync",1),b([z],H.prototype,"machineSettingsResource",1),b([z],H.prototype,"workspaceStorageHome",1),b([z],H.prototype,"localHistoryHome",1),b([z],H.prototype,"keyboardLayoutResource",1),b([z],H.prototype,"argvResource",1),b([z],H.prototype,"isExtensionDevelopment",1),b([z],H.prototype,"untitledWorkspacesHome",1),b([z],H.prototype,"builtinExtensionsPath",1),b([z],H.prototype,"extensionsPath",1),b([z],H.prototype,"extensionDevelopmentLocationURI",1),b([z],H.prototype,"extensionDevelopmentKind",1),b([z],H.prototype,"extensionTestsLocationURI",1),b([z],H.prototype,"debugExtensionHost",1),b([z],H.prototype,"logLevel",1),b([z],H.prototype,"extensionLogLevel",1),b([z],H.prototype,"serviceMachineIdResource",1),b([z],H.prototype,"disableTelemetry",1),b([z],H.prototype,"disableWorkspaceTrust",1),b([z],H.prototype,"useInMemorySecretStorage",1),b([z],H.prototype,"policyFile",1);function qc(n,e){return Ia(n["inspect-extensions"],n["inspect-brk-extensions"],5870,e,n.debugId,n.extensionEnvironment)}function Ia(n,e,t,r,i,s){let l=Number(e||n)||(r?null:t),c=l?!!e:!1,u;if(s)try{u=JSON.parse(s)}catch{}return{port:l,break:c,debugId:i,env:u}}import*as zc from"os";import*as $c from"path";var Wr={exports:{}};(function(){function e(t,r,i){function s(l,c){let u=o(l,c),d=[u];return t.isAbsolute(u)||d.unshift(i),t.resolve(...d)}function o(l,c){process.env.VSCODE_DEV&&(c="code-oss-dev");let u=process.env.VSCODE_PORTABLE;if(u)return t.join(u,"user-data");let d=process.env.VSCODE_APPDATA;if(d)return t.join(d,c);let p=l["user-data-dir"];if(p)return p;switch(process.platform){case"win32":if(d=process.env.APPDATA,!d){let f=process.env.USERPROFILE;if(typeof f!="string")throw new Error("Windows: Unexpected undefined %USERPROFILE% environment variable");d=t.join(f,"AppData","Roaming")}break;case"darwin":d=t.join(r.homedir(),"Library","Application Support");break;case"linux":d=process.env.XDG_CONFIG_HOME||t.join(r.homedir(),".config");break;default:throw new Error("Platform not supported")}return t.join(d,c)}return{getUserDataPath:s}}if(typeof Wr=="object"&&typeof Wr.exports=="object")Wr.exports=e($c,zc,process.env.VSCODE_CWD||process.cwd());else throw new Error("Unknown context")})();var _a=Wr.exports.getUserDataPath;var Vr=class extends H{constructor(e,t){super(e,{homeDir:Hc(),tmpDir:jc(),userDataDir:_a(e,t.nameShort)},t)}};function ps(n,e){return e&&(n.stack||n.stacktrace)?v("stackTrace.format","{0}: {1}",Ea(n),Ta(n.stack)||Ta(n.stacktrace)):Ea(n)}function Ta(n){return Array.isArray(n)?n.join(`
`):n}function Ea(n){return n.code==="ERR_UNC_HOST_NOT_ALLOWED"?`${n.message}. Please update the 'security.allowedUNCHosts' setting if you want to allow this host.`:typeof n.code=="string"&&typeof n.errno=="number"&&typeof n.syscall=="string"?v("nodeExceptionMessage","A system error occurred ({0})",n.message):n.message||v("error.defaultMessage","An unknown error occurred. Please consult the log for more details.")}function fs(n=null,e=!1){if(!n)return v("error.defaultMessage","An unknown error occurred. Please consult the log for more details.");if(Array.isArray(n)){let t=js(n),r=fs(t[0],e);return t.length>1?v("error.moreErrors","{0} ({1} errors in total)",r,t.length):r}if(he(n))return n;if(n.detail){let t=n.detail;if(t.error)return ps(t.error,e);if(t.exception)return ps(t.exception,e)}return n.stack?ps(n,e):n.message?n.message:v("error.defaultMessage","An unknown error occurred. Please consult the log for more details.")}function Sa(n){return hs(n,0)}function hs(n,e){switch(typeof n){case"object":return n===null?He(349,e):Array.isArray(n)?Xc(n,e):Qc(n,e);case"string":return Pa(n,e);case"boolean":return Gc(n,e);case"number":return He(n,e);case"undefined":return He(937,e);default:return He(617,e)}}function He(n,e){return(e<<5)-e+n|0}function Gc(n,e){return He(n?433:863,e)}function Pa(n,e){e=He(149417,e);for(let t=0,r=n.length;t<r;t++)e=He(n.charCodeAt(t),e);return e}function Xc(n,e){return e=He(104579,e),n.reduce((t,r)=>hs(r,t),e)}function Qc(n,e){return e=He(181387,e),Object.keys(n).sort().reduce((t,r)=>(t=Pa(r,t),hs(n[r],t)),e)}function ms(n,e,t=32){let r=t-e,i=~((1<<r)-1);return(n<<e|(i&n)>>>r)>>>0}function wa(n,e=0,t=n.byteLength,r=0){for(let i=0;i<t;i++)n[e+i]=r}function Jc(n,e,t="0"){for(;n.length<e;)n=t+n;return n}function Sn(n,e=32){return n instanceof ArrayBuffer?Array.from(new Uint8Array(n)).map(t=>t.toString(16).padStart(2,"0")).join(""):Jc((n>>>0).toString(16),e/4)}var Ca=class n{static _bigBlock32=new DataView(new ArrayBuffer(320));_h0=1732584193;_h1=4023233417;_h2=2562383102;_h3=271733878;_h4=3285377520;_buff;_buffDV;_buffLen;_totalLen;_leftoverHighSurrogate;_finished;constructor(){this._buff=new Uint8Array(67),this._buffDV=new DataView(this._buff.buffer),this._buffLen=0,this._totalLen=0,this._leftoverHighSurrogate=0,this._finished=!1}update(e){let t=e.length;if(t===0)return;let r=this._buff,i=this._buffLen,s=this._leftoverHighSurrogate,o,l;for(s!==0?(o=s,l=-1,s=0):(o=e.charCodeAt(0),l=0);;){let c=o;if(qo(o))if(l+1<t){let u=e.charCodeAt(l+1);Hi(u)?(l++,c=zo(o,u)):c=65533}else{s=o;break}else Hi(o)&&(c=65533);if(i=this._push(r,i,c),l++,l<t)o=e.charCodeAt(l);else break}this._buffLen=i,this._leftoverHighSurrogate=s}_push(e,t,r){return r<128?e[t++]=r:r<2048?(e[t++]=192|(r&1984)>>>6,e[t++]=128|(r&63)>>>0):r<65536?(e[t++]=224|(r&61440)>>>12,e[t++]=128|(r&4032)>>>6,e[t++]=128|(r&63)>>>0):(e[t++]=240|(r&1835008)>>>18,e[t++]=128|(r&258048)>>>12,e[t++]=128|(r&4032)>>>6,e[t++]=128|(r&63)>>>0),t>=64&&(this._step(),t-=64,this._totalLen+=64,e[0]=e[64],e[1]=e[65],e[2]=e[66]),t}digest(){return this._finished||(this._finished=!0,this._leftoverHighSurrogate&&(this._leftoverHighSurrogate=0,this._buffLen=this._push(this._buff,this._buffLen,65533)),this._totalLen+=this._buffLen,this._wrapUp()),Sn(this._h0)+Sn(this._h1)+Sn(this._h2)+Sn(this._h3)+Sn(this._h4)}_wrapUp(){this._buff[this._buffLen++]=128,wa(this._buff,this._buffLen),this._buffLen>56&&(this._step(),wa(this._buff));let e=8*this._totalLen;this._buffDV.setUint32(56,Math.floor(e/4294967296),!1),this._buffDV.setUint32(60,e%4294967296,!1),this._step()}_step(){let e=n._bigBlock32,t=this._buffDV;for(let p=0;p<64;p+=4)e.setUint32(p,t.getUint32(p,!1),!1);for(let p=64;p<320;p+=4)e.setUint32(p,ms(e.getUint32(p-12,!1)^e.getUint32(p-32,!1)^e.getUint32(p-56,!1)^e.getUint32(p-64,!1),1),!1);let r=this._h0,i=this._h1,s=this._h2,o=this._h3,l=this._h4,c,u,d;for(let p=0;p<80;p++)p<20?(c=i&s|~i&o,u=1518500249):p<40?(c=i^s^o,u=1859775393):p<60?(c=i&s|i&o|s&o,u=2400959708):(c=i^s^o,u=3395469782),d=ms(r,5)+c+l+u+e.getUint32(p*4,!1)&4294967295,l=o,o=s,s=ms(i,30),i=r,r=d;this._h0=this._h0+r&4294967295,this._h1=this._h1+i&4294967295,this._h2=this._h2+s&4294967295,this._h3=this._h3+o&4294967295,this._h4=this._h4+l&4294967295}};function gs(...n){switch(n.length){case 1:return v("contextkey.scanner.hint.didYouMean1","Did you mean {0}?",n[0]);case 2:return v("contextkey.scanner.hint.didYouMean2","Did you mean {0} or {1}?",n[0],n[1]);case 3:return v("contextkey.scanner.hint.didYouMean3","Did you mean {0}, {1} or {2}?",n[0],n[1],n[2]);default:return}}var Yc=v("contextkey.scanner.hint.didYouForgetToOpenOrCloseQuote","Did you forget to open or close the quote?"),Zc=v("contextkey.scanner.hint.didYouForgetToEscapeSlash","Did you forget to escape the '/' (slash) character? Put two backslashes before it to escape, e.g., '\\\\/'."),ot=class n{static getLexeme(e){switch(e.type){case 0:return"(";case 1:return")";case 2:return"!";case 3:return e.isTripleEq?"===":"==";case 4:return e.isTripleEq?"!==":"!=";case 5:return"<";case 6:return"<=";case 7:return">=";case 8:return">=";case 9:return"=~";case 10:return e.lexeme;case 11:return"true";case 12:return"false";case 13:return"in";case 14:return"not";case 15:return"&&";case 16:return"||";case 17:return e.lexeme;case 18:return e.lexeme;case 19:return e.lexeme;case 20:return"EOF";default:throw zs(`unhandled token type: ${JSON.stringify(e)}; have you forgotten to add a case?`)}}static _regexFlags=new Set(["i","g","s","m","y","u"].map(e=>e.charCodeAt(0)));static _keywords=new Map([["not",14],["in",13],["false",12],["true",11]]);_input="";_start=0;_current=0;_tokens=[];_errors=[];get errors(){return this._errors}reset(e){return this._input=e,this._start=0,this._current=0,this._tokens=[],this._errors=[],this}scan(){for(;!this._isAtEnd();)switch(this._start=this._current,this._advance()){case 40:this._addToken(0);break;case 41:this._addToken(1);break;case 33:if(this._match(61)){let t=this._match(61);this._tokens.push({type:4,offset:this._start,isTripleEq:t})}else this._addToken(2);break;case 39:this._quotedString();break;case 47:this._regex();break;case 61:if(this._match(61)){let t=this._match(61);this._tokens.push({type:3,offset:this._start,isTripleEq:t})}else this._match(126)?this._addToken(9):this._error(gs("==","=~"));break;case 60:this._addToken(this._match(61)?6:5);break;case 62:this._addToken(this._match(61)?8:7);break;case 38:this._match(38)?this._addToken(15):this._error(gs("&&"));break;case 124:this._match(124)?this._addToken(16):this._error(gs("||"));break;case 32:case 13:case 9:case 10:case 160:break;default:this._string()}return this._start=this._current,this._addToken(20),Array.from(this._tokens)}_match(e){return this._isAtEnd()||this._input.charCodeAt(this._current)!==e?!1:(this._current++,!0)}_advance(){return this._input.charCodeAt(this._current++)}_peek(){return this._isAtEnd()?0:this._input.charCodeAt(this._current)}_addToken(e){this._tokens.push({type:e,offset:this._start})}_error(e){let t=this._start,r=this._input.substring(this._start,this._current),i={type:19,offset:this._start,lexeme:r};this._errors.push({offset:t,lexeme:r,additionalInfo:e}),this._tokens.push(i)}stringRe=/[a-zA-Z0-9_<>\-\./\\:\*\?\+\[\]\^,#@;"%\$\p{L}-]+/uy;_string(){this.stringRe.lastIndex=this._start;let e=this.stringRe.exec(this._input);if(e){this._current=this._start+e[0].length;let t=this._input.substring(this._start,this._current),r=n._keywords.get(t);r?this._addToken(r):this._tokens.push({type:17,lexeme:t,offset:this._start})}}_quotedString(){for(;this._peek()!==39&&!this._isAtEnd();)this._advance();if(this._isAtEnd()){this._error(Yc);return}this._advance(),this._tokens.push({type:18,lexeme:this._input.substring(this._start+1,this._current-1),offset:this._start+1})}_regex(){let e=this._current,t=!1,r=!1;for(;;){if(e>=this._input.length){this._current=e,this._error(Zc);return}let s=this._input.charCodeAt(e);if(t)t=!1;else if(s===47&&!r){e++;break}else s===91?r=!0:s===92?t=!0:s===93&&(r=!1);e++}for(;e<this._input.length&&n._regexFlags.has(this._input.charCodeAt(e));)e++;this._current=e;let i=this._input.substring(this._start,this._current);this._tokens.push({type:10,lexeme:i,offset:this._start})}_isAtEnd(){return this._current>=this._input.length}};var re=new Map;re.set("false",!1);re.set("true",!0);re.set("isMac",be);re.set("isLinux",Ce);re.set("isWindows",D);re.set("isWeb",Dt);re.set("isMacNative",be&&!Dt);re.set("isEdge",lo);re.set("isFirefox",oo);re.set("isChrome",_i);re.set("isSafari",ao);var td=Object.prototype.hasOwnProperty;var nd={regexParsingWithErrorRecovery:!0},rd=v("contextkey.parser.error.emptyString","Empty context key expression"),id=v("contextkey.parser.error.emptyString.hint","Did you forget to write an expression? You can also put 'false' or 'true' to always evaluate to false or true, respectively."),sd=v("contextkey.parser.error.noInAfterNot","'in' after 'not'."),Ra=v("contextkey.parser.error.closingParenthesis","closing parenthesis ')'"),od=v("contextkey.parser.error.unexpectedToken","Unexpected token"),ad=v("contextkey.parser.error.unexpectedToken.hint","Did you forget to put && or || before the token?"),ld=v("contextkey.parser.error.unexpectedEOF","Unexpected end of expression"),ud=v("contextkey.parser.error.unexpectedEOF.hint","Did you forget to put a context key?"),bs=class n{constructor(e=nd){this._config=e}static _parseError=new Error;_scanner=new ot;_tokens=[];_current=0;_parsingErrors=[];get lexingErrors(){return this._scanner.errors}get parsingErrors(){return this._parsingErrors}parse(e){if(e===""){this._parsingErrors.push({message:rd,offset:0,lexeme:"",additionalInfo:id});return}this._tokens=this._scanner.reset(e).scan(),this._current=0,this._parsingErrors=[];try{let t=this._expr();if(!this._isAtEnd()){let r=this._peek(),i=r.type===17?ad:void 0;throw this._parsingErrors.push({message:od,offset:r.offset,lexeme:ot.getLexeme(r),additionalInfo:i}),n._parseError}return t}catch(t){if(t!==n._parseError)throw t;return}}_expr(){return this._or()}_or(){let e=[this._and()];for(;this._matchOne(16);){let t=this._and();e.push(t)}return e.length===1?e[0]:ae.or(...e)}_and(){let e=[this._term()];for(;this._matchOne(15);){let t=this._term();e.push(t)}return e.length===1?e[0]:ae.and(...e)}_term(){if(this._matchOne(2)){let e=this._peek();switch(e.type){case 11:return this._advance(),ce.INSTANCE;case 12:return this._advance(),fe.INSTANCE;case 0:{this._advance();let t=this._expr();return this._consume(1,Ra),t?.negate()}case 17:return this._advance(),Tt.create(e.lexeme);default:throw this._errExpectedButGot("KEY | true | false | '(' expression ')'",e)}}return this._primary()}_primary(){let e=this._peek();switch(e.type){case 11:return this._advance(),ae.true();case 12:return this._advance(),ae.false();case 0:{this._advance();let t=this._expr();return this._consume(1,Ra),t}case 17:{let t=e.lexeme;if(this._advance(),this._matchOne(9)){let i=this._peek();if(!this._config.regexParsingWithErrorRecovery){if(this._advance(),i.type!==10)throw this._errExpectedButGot("REGEX",i);let s=i.lexeme,o=s.lastIndexOf("/"),l=o===s.length-1?void 0:this._removeFlagsGY(s.substring(o+1)),c;try{c=new RegExp(s.substring(1,o),l)}catch{throw this._errExpectedButGot("REGEX",i)}return Mn.create(t,c)}switch(i.type){case 10:case 19:{let s=[i.lexeme];this._advance();let o=this._peek(),l=0;for(let f=0;f<i.lexeme.length;f++)i.lexeme.charCodeAt(f)===40?l++:i.lexeme.charCodeAt(f)===41&&l--;for(;!this._isAtEnd()&&o.type!==15&&o.type!==16;){switch(o.type){case 0:l++;break;case 1:l--;break;case 10:case 18:for(let f=0;f<o.lexeme.length;f++)o.lexeme.charCodeAt(f)===40?l++:i.lexeme.charCodeAt(f)===41&&l--}if(l<0)break;s.push(ot.getLexeme(o)),this._advance(),o=this._peek()}let c=s.join(""),u=c.lastIndexOf("/"),d=u===c.length-1?void 0:this._removeFlagsGY(c.substring(u+1)),p;try{p=new RegExp(c.substring(1,u),d)}catch{throw this._errExpectedButGot("REGEX",i)}return ae.regex(t,p)}case 18:{let s=i.lexeme;this._advance();let o=null;if(!Vo(s)){let l=s.indexOf("/"),c=s.lastIndexOf("/");if(l!==c&&l>=0){let u=s.slice(l+1,c),d=s[c+1]==="i"?"i":"";try{o=new RegExp(u,d)}catch{throw this._errExpectedButGot("REGEX",i)}}}if(o===null)throw this._errExpectedButGot("REGEX",i);return Mn.create(t,o)}default:throw this._errExpectedButGot("REGEX",this._peek())}}if(this._matchOne(14)){this._consume(13,sd);let i=this._value();return ae.notIn(t,i)}switch(this._peek().type){case 3:{this._advance();let i=this._value();if(this._previous().type===18)return ae.equals(t,i);switch(i){case"true":return ae.has(t);case"false":return ae.not(t);default:return ae.equals(t,i)}}case 4:{this._advance();let i=this._value();if(this._previous().type===18)return ae.notEquals(t,i);switch(i){case"true":return ae.not(t);case"false":return ae.has(t);default:return ae.notEquals(t,i)}}case 5:return this._advance(),On.create(t,this._value());case 6:return this._advance(),An.create(t,this._value());case 7:return this._advance(),Dn.create(t,this._value());case 8:return this._advance(),Ln.create(t,this._value());case 13:return this._advance(),ae.in(t,this._value());default:return ae.has(t)}}case 20:throw this._parsingErrors.push({message:ld,offset:e.offset,lexeme:"",additionalInfo:ud}),n._parseError;default:throw this._errExpectedButGot(`true | false | KEY 
	| KEY '=~' REGEX 
	| KEY ('==' | '!=' | '<' | '<=' | '>' | '>=' | 'in' | 'not' 'in') value`,this._peek())}}_value(){let e=this._peek();switch(e.type){case 17:case 18:return this._advance(),e.lexeme;case 11:return this._advance(),"true";case 12:return this._advance(),"false";case 13:return this._advance(),"in";default:return""}}_flagsGYRe=/g|y/g;_removeFlagsGY(e){return e.replaceAll(this._flagsGYRe,"")}_previous(){return this._tokens[this._current-1]}_matchOne(e){return this._check(e)?(this._advance(),!0):!1}_advance(){return this._isAtEnd()||this._current++,this._previous()}_consume(e,t){if(this._check(e))return this._advance();throw this._errExpectedButGot(t,this._peek())}_errExpectedButGot(e,t,r){let i=v("contextkey.parser.error.expectedButGot",`Expected: {0}
Received: '{1}'.`,e,ot.getLexeme(t)),s=t.offset,o=ot.getLexeme(t);return this._parsingErrors.push({message:i,offset:s,lexeme:o,additionalInfo:r}),n._parseError}_check(e){return this._peek().type===e}_peek(){return this._tokens[this._current]}_isAtEnd(){return this._peek().type===20}},ae=class{static false(){return ce.INSTANCE}static true(){return fe.INSTANCE}static has(e){return _t.create(e)}static equals(e,t){return Rn.create(e,t)}static notEquals(e,t){return kn.create(e,t)}static regex(e,t){return Mn.create(e,t)}static in(e,t){return Kr.create(e,t)}static notIn(e,t){return qr.create(e,t)}static not(e){return Tt.create(e)}static and(...e){return zr.create(e,null,!0)}static or(...e){return Fn.create(e,null,!0)}static greater(e,t){return Dn.create(e,t)}static greaterEquals(e,t){return Ln.create(e,t)}static smaller(e,t){return On.create(e,t)}static smallerEquals(e,t){return An.create(e,t)}static _parser=new bs({regexParsingWithErrorRecovery:!1});static deserialize(e){return e==null?void 0:this._parser.parse(e)}};function Pn(n,e){return n.cmp(e)}var ce=class n{static INSTANCE=new n;type=0;constructor(){}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}substituteConstants(){return this}evaluate(e){return!1}serialize(){return"false"}keys(){return[]}map(e){return this}negate(){return fe.INSTANCE}},fe=class n{static INSTANCE=new n;type=1;constructor(){}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}substituteConstants(){return this}evaluate(e){return!0}serialize(){return"true"}keys(){return[]}map(e){return this}negate(){return ce.INSTANCE}},_t=class n{constructor(e,t){this.key=e;this.negated=t}static create(e,t=null){let r=re.get(e);return typeof r=="boolean"?r?fe.INSTANCE:ce.INSTANCE:new n(e,t)}type=2;cmp(e){return e.type!==this.type?this.type-e.type:La(this.key,e.key)}equals(e){return e.type===this.type?this.key===e.key:!1}substituteConstants(){let e=re.get(this.key);return typeof e=="boolean"?e?fe.INSTANCE:ce.INSTANCE:this}evaluate(e){return!!e.getValue(this.key)}serialize(){return this.key}keys(){return[this.key]}map(e){return e.mapDefined(this.key)}negate(){return this.negated||(this.negated=Tt.create(this.key,this)),this.negated}},Rn=class n{constructor(e,t,r){this.key=e;this.value=t;this.negated=r}static create(e,t,r=null){if(typeof t=="boolean")return t?_t.create(e,r):Tt.create(e,r);let i=re.get(e);return typeof i=="boolean"?t===(i?"true":"false")?fe.INSTANCE:ce.INSTANCE:new n(e,t,r)}type=4;cmp(e){return e.type!==this.type?this.type-e.type:Et(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){let e=re.get(this.key);if(typeof e=="boolean"){let t=e?"true":"false";return this.value===t?fe.INSTANCE:ce.INSTANCE}return this}evaluate(e){return e.getValue(this.key)==this.value}serialize(){return`${this.key} == '${this.value}'`}keys(){return[this.key]}map(e){return e.mapEquals(this.key,this.value)}negate(){return this.negated||(this.negated=kn.create(this.key,this.value,this)),this.negated}},Kr=class n{constructor(e,t){this.key=e;this.valueKey=t}static create(e,t){return new n(e,t)}type=10;negated=null;cmp(e){return e.type!==this.type?this.type-e.type:Et(this.key,this.valueKey,e.key,e.valueKey)}equals(e){return e.type===this.type?this.key===e.key&&this.valueKey===e.valueKey:!1}substituteConstants(){return this}evaluate(e){let t=e.getValue(this.valueKey),r=e.getValue(this.key);return Array.isArray(t)?t.includes(r):typeof r=="string"&&typeof t=="object"&&t!==null?td.call(t,r):!1}serialize(){return`${this.key} in '${this.valueKey}'`}keys(){return[this.key,this.valueKey]}map(e){return e.mapIn(this.key,this.valueKey)}negate(){return this.negated||(this.negated=qr.create(this.key,this.valueKey)),this.negated}},qr=class n{constructor(e,t){this.key=e;this.valueKey=t;this._negated=Kr.create(e,t)}static create(e,t){return new n(e,t)}type=11;_negated;cmp(e){return e.type!==this.type?this.type-e.type:this._negated.cmp(e._negated)}equals(e){return e.type===this.type?this._negated.equals(e._negated):!1}substituteConstants(){return this}evaluate(e){return!this._negated.evaluate(e)}serialize(){return`${this.key} not in '${this.valueKey}'`}keys(){return this._negated.keys()}map(e){return e.mapNotIn(this.key,this.valueKey)}negate(){return this._negated}},kn=class n{constructor(e,t,r){this.key=e;this.value=t;this.negated=r}static create(e,t,r=null){if(typeof t=="boolean")return t?Tt.create(e,r):_t.create(e,r);let i=re.get(e);return typeof i=="boolean"?t===(i?"true":"false")?ce.INSTANCE:fe.INSTANCE:new n(e,t,r)}type=5;cmp(e){return e.type!==this.type?this.type-e.type:Et(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){let e=re.get(this.key);if(typeof e=="boolean"){let t=e?"true":"false";return this.value===t?ce.INSTANCE:fe.INSTANCE}return this}evaluate(e){return e.getValue(this.key)!=this.value}serialize(){return`${this.key} != '${this.value}'`}keys(){return[this.key]}map(e){return e.mapNotEquals(this.key,this.value)}negate(){return this.negated||(this.negated=Rn.create(this.key,this.value,this)),this.negated}},Tt=class n{constructor(e,t){this.key=e;this.negated=t}static create(e,t=null){let r=re.get(e);return typeof r=="boolean"?r?ce.INSTANCE:fe.INSTANCE:new n(e,t)}type=3;cmp(e){return e.type!==this.type?this.type-e.type:La(this.key,e.key)}equals(e){return e.type===this.type?this.key===e.key:!1}substituteConstants(){let e=re.get(this.key);return typeof e=="boolean"?e?ce.INSTANCE:fe.INSTANCE:this}evaluate(e){return!e.getValue(this.key)}serialize(){return`!${this.key}`}keys(){return[this.key]}map(e){return e.mapNot(this.key)}negate(){return this.negated||(this.negated=_t.create(this.key,this)),this.negated}};function $r(n,e){if(typeof n=="string"){let t=parseFloat(n);isNaN(t)||(n=t)}return typeof n=="string"||typeof n=="number"?e(n):ce.INSTANCE}var Dn=class n{constructor(e,t,r){this.key=e;this.value=t;this.negated=r}static create(e,t,r=null){return $r(t,i=>new n(e,i,r))}type=12;cmp(e){return e.type!==this.type?this.type-e.type:Et(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))>this.value}serialize(){return`${this.key} > ${this.value}`}keys(){return[this.key]}map(e){return e.mapGreater(this.key,this.value)}negate(){return this.negated||(this.negated=An.create(this.key,this.value,this)),this.negated}},Ln=class n{constructor(e,t,r){this.key=e;this.value=t;this.negated=r}static create(e,t,r=null){return $r(t,i=>new n(e,i,r))}type=13;cmp(e){return e.type!==this.type?this.type-e.type:Et(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))>=this.value}serialize(){return`${this.key} >= ${this.value}`}keys(){return[this.key]}map(e){return e.mapGreaterEquals(this.key,this.value)}negate(){return this.negated||(this.negated=On.create(this.key,this.value,this)),this.negated}},On=class n{constructor(e,t,r){this.key=e;this.value=t;this.negated=r}static create(e,t,r=null){return $r(t,i=>new n(e,i,r))}type=14;cmp(e){return e.type!==this.type?this.type-e.type:Et(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))<this.value}serialize(){return`${this.key} < ${this.value}`}keys(){return[this.key]}map(e){return e.mapSmaller(this.key,this.value)}negate(){return this.negated||(this.negated=Ln.create(this.key,this.value,this)),this.negated}},An=class n{constructor(e,t,r){this.key=e;this.value=t;this.negated=r}static create(e,t,r=null){return $r(t,i=>new n(e,i,r))}type=15;cmp(e){return e.type!==this.type?this.type-e.type:Et(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))<=this.value}serialize(){return`${this.key} <= ${this.value}`}keys(){return[this.key]}map(e){return e.mapSmallerEquals(this.key,this.value)}negate(){return this.negated||(this.negated=Dn.create(this.key,this.value,this)),this.negated}},Mn=class n{constructor(e,t){this.key=e;this.regexp=t}static create(e,t){return new n(e,t)}type=7;negated=null;cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.key<e.key)return-1;if(this.key>e.key)return 1;let t=this.regexp?this.regexp.source:"",r=e.regexp?e.regexp.source:"";return t<r?-1:t>r?1:0}equals(e){if(e.type===this.type){let t=this.regexp?this.regexp.source:"",r=e.regexp?e.regexp.source:"";return this.key===e.key&&t===r}return!1}substituteConstants(){return this}evaluate(e){let t=e.getValue(this.key);return this.regexp?this.regexp.test(t):!1}serialize(){let e=this.regexp?`/${this.regexp.source}/${this.regexp.flags}`:"/invalid/";return`${this.key} =~ ${e}`}keys(){return[this.key]}map(e){return e.mapRegex(this.key,this.regexp)}negate(){return this.negated||(this.negated=ys.create(this)),this.negated}},ys=class n{constructor(e){this._actual=e}static create(e){return new n(e)}type=8;cmp(e){return e.type!==this.type?this.type-e.type:this._actual.cmp(e._actual)}equals(e){return e.type===this.type?this._actual.equals(e._actual):!1}substituteConstants(){return this}evaluate(e){return!this._actual.evaluate(e)}serialize(){return`!(${this._actual.serialize()})`}keys(){return this._actual.keys()}map(e){return new n(this._actual.map(e))}negate(){return this._actual}};function Da(n){let e=null;for(let t=0,r=n.length;t<r;t++){let i=n[t].substituteConstants();if(n[t]!==i&&e===null){e=[];for(let s=0;s<t;s++)e[s]=n[s]}e!==null&&(e[t]=i)}return e===null?n:e}var zr=class n{constructor(e,t){this.expr=e;this.negated=t}static create(e,t,r){return n._normalizeArr(e,t,r)}type=6;cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.expr.length<e.expr.length)return-1;if(this.expr.length>e.expr.length)return 1;for(let t=0,r=this.expr.length;t<r;t++){let i=Pn(this.expr[t],e.expr[t]);if(i!==0)return i}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length)return!1;for(let t=0,r=this.expr.length;t<r;t++)if(!this.expr[t].equals(e.expr[t]))return!1;return!0}return!1}substituteConstants(){let e=Da(this.expr);return e===this.expr?this:n.create(e,this.negated,!1)}evaluate(e){for(let t=0,r=this.expr.length;t<r;t++)if(!this.expr[t].evaluate(e))return!1;return!0}static _normalizeArr(e,t,r){let i=[],s=!1;for(let o of e)if(o){if(o.type===1){s=!0;continue}if(o.type===0)return ce.INSTANCE;if(o.type===6){i.push(...o.expr);continue}i.push(o)}if(i.length===0&&s)return fe.INSTANCE;if(i.length!==0){if(i.length===1)return i[0];i.sort(Pn);for(let o=1;o<i.length;o++)i[o-1].equals(i[o])&&(i.splice(o,1),o--);if(i.length===1)return i[0];for(;i.length>1;){let o=i[i.length-1];if(o.type!==9)break;i.pop();let l=i.pop(),c=i.length===0,u=Fn.create(o.expr.map(d=>n.create([d,l],null,r)),null,c);u&&(i.push(u),i.sort(Pn))}if(i.length===1)return i[0];if(r){for(let o=0;o<i.length;o++)for(let l=o+1;l<i.length;l++)if(i[o].negate().equals(i[l]))return ce.INSTANCE;if(i.length===1)return i[0]}return new n(i,t)}}serialize(){return this.expr.map(e=>e.serialize()).join(" && ")}keys(){let e=[];for(let t of this.expr)e.push(...t.keys());return e}map(e){return new n(this.expr.map(t=>t.map(e)),null)}negate(){if(!this.negated){let e=[];for(let t of this.expr)e.push(t.negate());this.negated=Fn.create(e,this,!0)}return this.negated}},Fn=class n{constructor(e,t){this.expr=e;this.negated=t}static create(e,t,r){return n._normalizeArr(e,t,r)}type=9;cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.expr.length<e.expr.length)return-1;if(this.expr.length>e.expr.length)return 1;for(let t=0,r=this.expr.length;t<r;t++){let i=Pn(this.expr[t],e.expr[t]);if(i!==0)return i}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length)return!1;for(let t=0,r=this.expr.length;t<r;t++)if(!this.expr[t].equals(e.expr[t]))return!1;return!0}return!1}substituteConstants(){let e=Da(this.expr);return e===this.expr?this:n.create(e,this.negated,!1)}evaluate(e){for(let t=0,r=this.expr.length;t<r;t++)if(this.expr[t].evaluate(e))return!0;return!1}static _normalizeArr(e,t,r){let i=[],s=!1;if(e){for(let o=0,l=e.length;o<l;o++){let c=e[o];if(c){if(c.type===0){s=!0;continue}if(c.type===1)return fe.INSTANCE;if(c.type===9){i=i.concat(c.expr);continue}i.push(c)}}if(i.length===0&&s)return ce.INSTANCE;i.sort(Pn)}if(i.length!==0){if(i.length===1)return i[0];for(let o=1;o<i.length;o++)i[o-1].equals(i[o])&&(i.splice(o,1),o--);if(i.length===1)return i[0];if(r){for(let o=0;o<i.length;o++)for(let l=o+1;l<i.length;l++)if(i[o].negate().equals(i[l]))return fe.INSTANCE;if(i.length===1)return i[0]}return new n(i,t)}}serialize(){return this.expr.map(e=>e.serialize()).join(" || ")}keys(){let e=[];for(let t of this.expr)e.push(...t.keys());return e}map(e){return new n(this.expr.map(t=>t.map(e)),null)}negate(){if(!this.negated){let e=[];for(let t of this.expr)e.push(t.negate());for(;e.length>1;){let t=e.shift(),r=e.shift(),i=[];for(let s of ka(t))for(let o of ka(r))i.push(zr.create([s,o],null,!1));e.unshift(n.create(i,null,!1))}this.negated=n.create(e,this,!0)}return this.negated}},Gt=class n extends _t{static _info=[];static all(){return n._info.values()}_defaultValue;constructor(e,t,r){super(e,null),this._defaultValue=t,typeof r=="object"?n._info.push({...r,key:e}):r!==!0&&n._info.push({key:e,description:r,type:t!=null?typeof t:void 0})}bindTo(e){return e.createKey(this.key,this._defaultValue)}getValue(e){return e.getContextKeyValue(this.key)}toNegated(){return this.negate()}isEqualTo(e){return Rn.create(this.key,e)}notEqualsTo(e){return kn.create(this.key,e)}},Cy=Y("contextKeyService");function La(n,e){return n<e?-1:n>e?1:0}function Et(n,e,t,r){return n<t?-1:n>t?1:e<r?-1:e>r?1:0}function ka(n){return n.type===9?n.expr:[n]}var Oa=Object.create(null);function a(n,e){if(he(e)){let t=Oa[e];if(t===void 0)throw new Error(`${n} references an unknown codicon: ${e}`);e=t}return Oa[n]=e,{id:n}}var Aa={add:a("add",6e4),plus:a("plus",6e4),gistNew:a("gist-new",6e4),repoCreate:a("repo-create",6e4),lightbulb:a("lightbulb",60001),lightBulb:a("light-bulb",60001),repo:a("repo",60002),repoDelete:a("repo-delete",60002),gistFork:a("gist-fork",60003),repoForked:a("repo-forked",60003),gitPullRequest:a("git-pull-request",60004),gitPullRequestAbandoned:a("git-pull-request-abandoned",60004),recordKeys:a("record-keys",60005),keyboard:a("keyboard",60005),tag:a("tag",60006),gitPullRequestLabel:a("git-pull-request-label",60006),tagAdd:a("tag-add",60006),tagRemove:a("tag-remove",60006),person:a("person",60007),personFollow:a("person-follow",60007),personOutline:a("person-outline",60007),personFilled:a("person-filled",60007),gitBranch:a("git-branch",60008),gitBranchCreate:a("git-branch-create",60008),gitBranchDelete:a("git-branch-delete",60008),sourceControl:a("source-control",60008),mirror:a("mirror",60009),mirrorPublic:a("mirror-public",60009),star:a("star",60010),starAdd:a("star-add",60010),starDelete:a("star-delete",60010),starEmpty:a("star-empty",60010),comment:a("comment",60011),commentAdd:a("comment-add",60011),alert:a("alert",60012),warning:a("warning",60012),search:a("search",60013),searchSave:a("search-save",60013),logOut:a("log-out",60014),signOut:a("sign-out",60014),logIn:a("log-in",60015),signIn:a("sign-in",60015),eye:a("eye",60016),eyeUnwatch:a("eye-unwatch",60016),eyeWatch:a("eye-watch",60016),circleFilled:a("circle-filled",60017),primitiveDot:a("primitive-dot",60017),closeDirty:a("close-dirty",60017),debugBreakpoint:a("debug-breakpoint",60017),debugBreakpointDisabled:a("debug-breakpoint-disabled",60017),debugHint:a("debug-hint",60017),terminalDecorationSuccess:a("terminal-decoration-success",60017),primitiveSquare:a("primitive-square",60018),edit:a("edit",60019),pencil:a("pencil",60019),info:a("info",60020),issueOpened:a("issue-opened",60020),gistPrivate:a("gist-private",60021),gitForkPrivate:a("git-fork-private",60021),lock:a("lock",60021),mirrorPrivate:a("mirror-private",60021),close:a("close",60022),removeClose:a("remove-close",60022),x:a("x",60022),repoSync:a("repo-sync",60023),sync:a("sync",60023),clone:a("clone",60024),desktopDownload:a("desktop-download",60024),beaker:a("beaker",60025),microscope:a("microscope",60025),vm:a("vm",60026),deviceDesktop:a("device-desktop",60026),file:a("file",60027),fileText:a("file-text",60027),more:a("more",60028),ellipsis:a("ellipsis",60028),kebabHorizontal:a("kebab-horizontal",60028),mailReply:a("mail-reply",60029),reply:a("reply",60029),organization:a("organization",60030),organizationFilled:a("organization-filled",60030),organizationOutline:a("organization-outline",60030),newFile:a("new-file",60031),fileAdd:a("file-add",60031),newFolder:a("new-folder",60032),fileDirectoryCreate:a("file-directory-create",60032),trash:a("trash",60033),trashcan:a("trashcan",60033),history:a("history",60034),clock:a("clock",60034),folder:a("folder",60035),fileDirectory:a("file-directory",60035),symbolFolder:a("symbol-folder",60035),logoGithub:a("logo-github",60036),markGithub:a("mark-github",60036),github:a("github",60036),terminal:a("terminal",60037),console:a("console",60037),repl:a("repl",60037),zap:a("zap",60038),symbolEvent:a("symbol-event",60038),error:a("error",60039),stop:a("stop",60039),variable:a("variable",60040),symbolVariable:a("symbol-variable",60040),array:a("array",60042),symbolArray:a("symbol-array",60042),symbolModule:a("symbol-module",60043),symbolPackage:a("symbol-package",60043),symbolNamespace:a("symbol-namespace",60043),symbolObject:a("symbol-object",60043),symbolMethod:a("symbol-method",60044),symbolFunction:a("symbol-function",60044),symbolConstructor:a("symbol-constructor",60044),symbolBoolean:a("symbol-boolean",60047),symbolNull:a("symbol-null",60047),symbolNumeric:a("symbol-numeric",60048),symbolNumber:a("symbol-number",60048),symbolStructure:a("symbol-structure",60049),symbolStruct:a("symbol-struct",60049),symbolParameter:a("symbol-parameter",60050),symbolTypeParameter:a("symbol-type-parameter",60050),symbolKey:a("symbol-key",60051),symbolText:a("symbol-text",60051),symbolReference:a("symbol-reference",60052),goToFile:a("go-to-file",60052),symbolEnum:a("symbol-enum",60053),symbolValue:a("symbol-value",60053),symbolRuler:a("symbol-ruler",60054),symbolUnit:a("symbol-unit",60054),activateBreakpoints:a("activate-breakpoints",60055),archive:a("archive",60056),arrowBoth:a("arrow-both",60057),arrowDown:a("arrow-down",60058),arrowLeft:a("arrow-left",60059),arrowRight:a("arrow-right",60060),arrowSmallDown:a("arrow-small-down",60061),arrowSmallLeft:a("arrow-small-left",60062),arrowSmallRight:a("arrow-small-right",60063),arrowSmallUp:a("arrow-small-up",60064),arrowUp:a("arrow-up",60065),bell:a("bell",60066),bold:a("bold",60067),book:a("book",60068),bookmark:a("bookmark",60069),debugBreakpointConditionalUnverified:a("debug-breakpoint-conditional-unverified",60070),debugBreakpointConditional:a("debug-breakpoint-conditional",60071),debugBreakpointConditionalDisabled:a("debug-breakpoint-conditional-disabled",60071),debugBreakpointDataUnverified:a("debug-breakpoint-data-unverified",60072),debugBreakpointData:a("debug-breakpoint-data",60073),debugBreakpointDataDisabled:a("debug-breakpoint-data-disabled",60073),debugBreakpointLogUnverified:a("debug-breakpoint-log-unverified",60074),debugBreakpointLog:a("debug-breakpoint-log",60075),debugBreakpointLogDisabled:a("debug-breakpoint-log-disabled",60075),briefcase:a("briefcase",60076),broadcast:a("broadcast",60077),browser:a("browser",60078),bug:a("bug",60079),calendar:a("calendar",60080),caseSensitive:a("case-sensitive",60081),check:a("check",60082),checklist:a("checklist",60083),chevronDown:a("chevron-down",60084),chevronLeft:a("chevron-left",60085),chevronRight:a("chevron-right",60086),chevronUp:a("chevron-up",60087),chromeClose:a("chrome-close",60088),chromeMaximize:a("chrome-maximize",60089),chromeMinimize:a("chrome-minimize",60090),chromeRestore:a("chrome-restore",60091),circleOutline:a("circle-outline",60092),circle:a("circle",60092),debugBreakpointUnverified:a("debug-breakpoint-unverified",60092),terminalDecorationIncomplete:a("terminal-decoration-incomplete",60092),circleSlash:a("circle-slash",60093),circuitBoard:a("circuit-board",60094),clearAll:a("clear-all",60095),clippy:a("clippy",60096),closeAll:a("close-all",60097),cloudDownload:a("cloud-download",60098),cloudUpload:a("cloud-upload",60099),code:a("code",60100),collapseAll:a("collapse-all",60101),colorMode:a("color-mode",60102),commentDiscussion:a("comment-discussion",60103),creditCard:a("credit-card",60105),dash:a("dash",60108),dashboard:a("dashboard",60109),database:a("database",60110),debugContinue:a("debug-continue",60111),debugDisconnect:a("debug-disconnect",60112),debugPause:a("debug-pause",60113),debugRestart:a("debug-restart",60114),debugStart:a("debug-start",60115),debugStepInto:a("debug-step-into",60116),debugStepOut:a("debug-step-out",60117),debugStepOver:a("debug-step-over",60118),debugStop:a("debug-stop",60119),debug:a("debug",60120),deviceCameraVideo:a("device-camera-video",60121),deviceCamera:a("device-camera",60122),deviceMobile:a("device-mobile",60123),diffAdded:a("diff-added",60124),diffIgnored:a("diff-ignored",60125),diffModified:a("diff-modified",60126),diffRemoved:a("diff-removed",60127),diffRenamed:a("diff-renamed",60128),diff:a("diff",60129),diffSidebyside:a("diff-sidebyside",60129),discard:a("discard",60130),editorLayout:a("editor-layout",60131),emptyWindow:a("empty-window",60132),exclude:a("exclude",60133),extensions:a("extensions",60134),eyeClosed:a("eye-closed",60135),fileBinary:a("file-binary",60136),fileCode:a("file-code",60137),fileMedia:a("file-media",60138),filePdf:a("file-pdf",60139),fileSubmodule:a("file-submodule",60140),fileSymlinkDirectory:a("file-symlink-directory",60141),fileSymlinkFile:a("file-symlink-file",60142),fileZip:a("file-zip",60143),files:a("files",60144),filter:a("filter",60145),flame:a("flame",60146),foldDown:a("fold-down",60147),foldUp:a("fold-up",60148),fold:a("fold",60149),folderActive:a("folder-active",60150),folderOpened:a("folder-opened",60151),gear:a("gear",60152),gift:a("gift",60153),gistSecret:a("gist-secret",60154),gist:a("gist",60155),gitCommit:a("git-commit",60156),gitCompare:a("git-compare",60157),compareChanges:a("compare-changes",60157),gitMerge:a("git-merge",60158),githubAction:a("github-action",60159),githubAlt:a("github-alt",60160),globe:a("globe",60161),grabber:a("grabber",60162),graph:a("graph",60163),gripper:a("gripper",60164),heart:a("heart",60165),home:a("home",60166),horizontalRule:a("horizontal-rule",60167),hubot:a("hubot",60168),inbox:a("inbox",60169),issueReopened:a("issue-reopened",60171),issues:a("issues",60172),italic:a("italic",60173),jersey:a("jersey",60174),json:a("json",60175),kebabVertical:a("kebab-vertical",60176),key:a("key",60177),law:a("law",60178),lightbulbAutofix:a("lightbulb-autofix",60179),linkExternal:a("link-external",60180),link:a("link",60181),listOrdered:a("list-ordered",60182),listUnordered:a("list-unordered",60183),liveShare:a("live-share",60184),loading:a("loading",60185),location:a("location",60186),mailRead:a("mail-read",60187),mail:a("mail",60188),markdown:a("markdown",60189),megaphone:a("megaphone",60190),mention:a("mention",60191),milestone:a("milestone",60192),gitPullRequestMilestone:a("git-pull-request-milestone",60192),mortarBoard:a("mortar-board",60193),move:a("move",60194),multipleWindows:a("multiple-windows",60195),mute:a("mute",60196),noNewline:a("no-newline",60197),note:a("note",60198),octoface:a("octoface",60199),openPreview:a("open-preview",60200),package:a("package",60201),paintcan:a("paintcan",60202),pin:a("pin",60203),play:a("play",60204),run:a("run",60204),plug:a("plug",60205),preserveCase:a("preserve-case",60206),preview:a("preview",60207),project:a("project",60208),pulse:a("pulse",60209),question:a("question",60210),quote:a("quote",60211),radioTower:a("radio-tower",60212),reactions:a("reactions",60213),references:a("references",60214),refresh:a("refresh",60215),regex:a("regex",60216),remoteExplorer:a("remote-explorer",60217),remote:a("remote",60218),remove:a("remove",60219),replaceAll:a("replace-all",60220),replace:a("replace",60221),repoClone:a("repo-clone",60222),repoForcePush:a("repo-force-push",60223),repoPull:a("repo-pull",60224),repoPush:a("repo-push",60225),report:a("report",60226),requestChanges:a("request-changes",60227),rocket:a("rocket",60228),rootFolderOpened:a("root-folder-opened",60229),rootFolder:a("root-folder",60230),rss:a("rss",60231),ruby:a("ruby",60232),saveAll:a("save-all",60233),saveAs:a("save-as",60234),save:a("save",60235),screenFull:a("screen-full",60236),screenNormal:a("screen-normal",60237),searchStop:a("search-stop",60238),server:a("server",60240),settingsGear:a("settings-gear",60241),settings:a("settings",60242),shield:a("shield",60243),smiley:a("smiley",60244),sortPrecedence:a("sort-precedence",60245),splitHorizontal:a("split-horizontal",60246),splitVertical:a("split-vertical",60247),squirrel:a("squirrel",60248),starFull:a("star-full",60249),starHalf:a("star-half",60250),symbolClass:a("symbol-class",60251),symbolColor:a("symbol-color",60252),symbolConstant:a("symbol-constant",60253),symbolEnumMember:a("symbol-enum-member",60254),symbolField:a("symbol-field",60255),symbolFile:a("symbol-file",60256),symbolInterface:a("symbol-interface",60257),symbolKeyword:a("symbol-keyword",60258),symbolMisc:a("symbol-misc",60259),symbolOperator:a("symbol-operator",60260),symbolProperty:a("symbol-property",60261),wrench:a("wrench",60261),wrenchSubaction:a("wrench-subaction",60261),symbolSnippet:a("symbol-snippet",60262),tasklist:a("tasklist",60263),telescope:a("telescope",60264),textSize:a("text-size",60265),threeBars:a("three-bars",60266),thumbsdown:a("thumbsdown",60267),thumbsup:a("thumbsup",60268),tools:a("tools",60269),triangleDown:a("triangle-down",60270),triangleLeft:a("triangle-left",60271),triangleRight:a("triangle-right",60272),triangleUp:a("triangle-up",60273),twitter:a("twitter",60274),unfold:a("unfold",60275),unlock:a("unlock",60276),unmute:a("unmute",60277),unverified:a("unverified",60278),verified:a("verified",60279),versions:a("versions",60280),vmActive:a("vm-active",60281),vmOutline:a("vm-outline",60282),vmRunning:a("vm-running",60283),watch:a("watch",60284),whitespace:a("whitespace",60285),wholeWord:a("whole-word",60286),window:a("window",60287),wordWrap:a("word-wrap",60288),zoomIn:a("zoom-in",60289),zoomOut:a("zoom-out",60290),listFilter:a("list-filter",60291),listFlat:a("list-flat",60292),listSelection:a("list-selection",60293),selection:a("selection",60293),listTree:a("list-tree",60294),debugBreakpointFunctionUnverified:a("debug-breakpoint-function-unverified",60295),debugBreakpointFunction:a("debug-breakpoint-function",60296),debugBreakpointFunctionDisabled:a("debug-breakpoint-function-disabled",60296),debugStackframeActive:a("debug-stackframe-active",60297),circleSmallFilled:a("circle-small-filled",60298),debugStackframeDot:a("debug-stackframe-dot",60298),terminalDecorationMark:a("terminal-decoration-mark",60298),debugStackframe:a("debug-stackframe",60299),debugStackframeFocused:a("debug-stackframe-focused",60299),debugBreakpointUnsupported:a("debug-breakpoint-unsupported",60300),symbolString:a("symbol-string",60301),debugReverseContinue:a("debug-reverse-continue",60302),debugStepBack:a("debug-step-back",60303),debugRestartFrame:a("debug-restart-frame",60304),debugAlt:a("debug-alt",60305),callIncoming:a("call-incoming",60306),callOutgoing:a("call-outgoing",60307),menu:a("menu",60308),expandAll:a("expand-all",60309),feedback:a("feedback",60310),gitPullRequestReviewer:a("git-pull-request-reviewer",60310),groupByRefType:a("group-by-ref-type",60311),ungroupByRefType:a("ungroup-by-ref-type",60312),account:a("account",60313),gitPullRequestAssignee:a("git-pull-request-assignee",60313),bellDot:a("bell-dot",60314),debugConsole:a("debug-console",60315),library:a("library",60316),output:a("output",60317),runAll:a("run-all",60318),syncIgnored:a("sync-ignored",60319),pinned:a("pinned",60320),githubInverted:a("github-inverted",60321),serverProcess:a("server-process",60322),serverEnvironment:a("server-environment",60323),pass:a("pass",60324),issueClosed:a("issue-closed",60324),stopCircle:a("stop-circle",60325),playCircle:a("play-circle",60326),record:a("record",60327),debugAltSmall:a("debug-alt-small",60328),vmConnect:a("vm-connect",60329),cloud:a("cloud",60330),merge:a("merge",60331),export:a("export",60332),graphLeft:a("graph-left",60333),magnet:a("magnet",60334),notebook:a("notebook",60335),redo:a("redo",60336),checkAll:a("check-all",60337),pinnedDirty:a("pinned-dirty",60338),passFilled:a("pass-filled",60339),circleLargeFilled:a("circle-large-filled",60340),circleLarge:a("circle-large",60341),circleLargeOutline:a("circle-large-outline",60341),combine:a("combine",60342),gather:a("gather",60342),table:a("table",60343),variableGroup:a("variable-group",60344),typeHierarchy:a("type-hierarchy",60345),typeHierarchySub:a("type-hierarchy-sub",60346),typeHierarchySuper:a("type-hierarchy-super",60347),gitPullRequestCreate:a("git-pull-request-create",60348),runAbove:a("run-above",60349),runBelow:a("run-below",60350),notebookTemplate:a("notebook-template",60351),debugRerun:a("debug-rerun",60352),workspaceTrusted:a("workspace-trusted",60353),workspaceUntrusted:a("workspace-untrusted",60354),workspaceUnknown:a("workspace-unknown",60355),terminalCmd:a("terminal-cmd",60356),terminalDebian:a("terminal-debian",60357),terminalLinux:a("terminal-linux",60358),terminalPowershell:a("terminal-powershell",60359),terminalTmux:a("terminal-tmux",60360),terminalUbuntu:a("terminal-ubuntu",60361),terminalBash:a("terminal-bash",60362),arrowSwap:a("arrow-swap",60363),copy:a("copy",60364),personAdd:a("person-add",60365),filterFilled:a("filter-filled",60366),wand:a("wand",60367),debugLineByLine:a("debug-line-by-line",60368),inspect:a("inspect",60369),layers:a("layers",60370),layersDot:a("layers-dot",60371),layersActive:a("layers-active",60372),compass:a("compass",60373),compassDot:a("compass-dot",60374),compassActive:a("compass-active",60375),azure:a("azure",60376),issueDraft:a("issue-draft",60377),gitPullRequestClosed:a("git-pull-request-closed",60378),gitPullRequestDraft:a("git-pull-request-draft",60379),debugAll:a("debug-all",60380),debugCoverage:a("debug-coverage",60381),runErrors:a("run-errors",60382),folderLibrary:a("folder-library",60383),debugContinueSmall:a("debug-continue-small",60384),beakerStop:a("beaker-stop",60385),graphLine:a("graph-line",60386),graphScatter:a("graph-scatter",60387),pieChart:a("pie-chart",60388),bracket:a("bracket",60175),bracketDot:a("bracket-dot",60389),bracketError:a("bracket-error",60390),lockSmall:a("lock-small",60391),azureDevops:a("azure-devops",60392),verifiedFilled:a("verified-filled",60393),newline:a("newline",60394),layout:a("layout",60395),layoutActivitybarLeft:a("layout-activitybar-left",60396),layoutActivitybarRight:a("layout-activitybar-right",60397),layoutPanelLeft:a("layout-panel-left",60398),layoutPanelCenter:a("layout-panel-center",60399),layoutPanelJustify:a("layout-panel-justify",60400),layoutPanelRight:a("layout-panel-right",60401),layoutPanel:a("layout-panel",60402),layoutSidebarLeft:a("layout-sidebar-left",60403),layoutSidebarRight:a("layout-sidebar-right",60404),layoutStatusbar:a("layout-statusbar",60405),layoutMenubar:a("layout-menubar",60406),layoutCentered:a("layout-centered",60407),target:a("target",60408),indent:a("indent",60409),recordSmall:a("record-small",60410),errorSmall:a("error-small",60411),terminalDecorationError:a("terminal-decoration-error",60411),arrowCircleDown:a("arrow-circle-down",60412),arrowCircleLeft:a("arrow-circle-left",60413),arrowCircleRight:a("arrow-circle-right",60414),arrowCircleUp:a("arrow-circle-up",60415),layoutSidebarRightOff:a("layout-sidebar-right-off",60416),layoutPanelOff:a("layout-panel-off",60417),layoutSidebarLeftOff:a("layout-sidebar-left-off",60418),blank:a("blank",60419),heartFilled:a("heart-filled",60420),map:a("map",60421),mapHorizontal:a("map-horizontal",60421),foldHorizontal:a("fold-horizontal",60421),mapFilled:a("map-filled",60422),mapHorizontalFilled:a("map-horizontal-filled",60422),foldHorizontalFilled:a("fold-horizontal-filled",60422),circleSmall:a("circle-small",60423),bellSlash:a("bell-slash",60424),bellSlashDot:a("bell-slash-dot",60425),commentUnresolved:a("comment-unresolved",60426),gitPullRequestGoToChanges:a("git-pull-request-go-to-changes",60427),gitPullRequestNewChanges:a("git-pull-request-new-changes",60428),searchFuzzy:a("search-fuzzy",60429),commentDraft:a("comment-draft",60430),send:a("send",60431),sparkle:a("sparkle",60432),insert:a("insert",60433),mic:a("mic",60434),thumbsdownFilled:a("thumbsdown-filled",60435),thumbsupFilled:a("thumbsup-filled",60436),coffee:a("coffee",60437),snake:a("snake",60438),game:a("game",60439),vr:a("vr",60440),chip:a("chip",60441),piano:a("piano",60442),music:a("music",60443),micFilled:a("mic-filled",60444),repoFetch:a("repo-fetch",60445),copilot:a("copilot",60446),lightbulbSparkle:a("lightbulb-sparkle",60447),robot:a("robot",60448),sparkleFilled:a("sparkle-filled",60449),diffSingle:a("diff-single",60450),diffMultiple:a("diff-multiple",60451),surroundWith:a("surround-with",60452),share:a("share",60453),gitStash:a("git-stash",60454),gitStashApply:a("git-stash-apply",60455),gitStashPop:a("git-stash-pop",60456),vscode:a("vscode",60457),vscodeInsiders:a("vscode-insiders",60458),codeOss:a("code-oss",60459),runCoverage:a("run-coverage",60460),runAllCoverage:a("run-all-coverage",60461),coverage:a("coverage",60462),githubProject:a("github-project",60463),mapVertical:a("map-vertical",60464),foldVertical:a("fold-vertical",60464),mapVerticalFilled:a("map-vertical-filled",60465),foldVerticalFilled:a("fold-vertical-filled",60465),goToSearch:a("go-to-search",60466),percentage:a("percentage",60467),sortPercentage:a("sort-percentage",60467),attach:a("attach",60468)};var cd={dialogError:a("dialog-error","error"),dialogWarning:a("dialog-warning","warning"),dialogInfo:a("dialog-info","info"),dialogClose:a("dialog-close","close"),treeItemExpanded:a("tree-item-expanded","chevron-down"),treeFilterOnTypeOn:a("tree-filter-on-type-on","list-filter"),treeFilterOnTypeOff:a("tree-filter-on-type-off","list-selection"),treeFilterClear:a("tree-filter-clear","close"),treeItemLoading:a("tree-item-loading","loading"),menuSelection:a("menu-selection","check"),menuSubmenu:a("menu-submenu","chevron-right"),menuBarMore:a("menubar-more","more"),scrollbarButtonLeft:a("scrollbar-button-left","triangle-left"),scrollbarButtonRight:a("scrollbar-button-right","triangle-right"),scrollbarButtonUp:a("scrollbar-button-up","triangle-up"),scrollbarButtonDown:a("scrollbar-button-down","triangle-down"),toolBarMore:a("toolbar-more","more"),quickInputBack:a("quick-input-back","arrow-left"),dropDownButton:a("drop-down-button",60084),symbolCustomColor:a("symbol-customcolor",60252),exportIcon:a("export",60332),workspaceUnspecified:a("workspace-unspecified",60355),newLine:a("newline",60394),thumbsDownFilled:a("thumbsdown-filled",60435),thumbsUpFilled:a("thumbsup-filled",60436),gitFetch:a("git-fetch",60445),lightbulbSparkleAutofix:a("lightbulb-sparkle-autofix",60447),debugBreakpointPending:a("debug-breakpoint-pending",60377)},Ma={...Aa,...cd};var Fa;(e=>{function n(t){return t&&typeof t=="object"&&typeof t.id=="string"}e.isThemeColor=n})(Fa||={});var Un;(_=>{_.iconNameSegment="[A-Za-z0-9]+",_.iconNameExpression="[A-Za-z0-9-]+",_.iconModifierExpression="~[A-Za-z]+",_.iconNameCharacter="[A-Za-z0-9~-]";let i=new RegExp(`^(${_.iconNameExpression})(${_.iconModifierExpression})?$`);function s(T){let A=i.exec(T.id);if(!A)return s(Ma.error);let[,$,S]=A,g=["codicon","codicon-"+$];return S&&g.push("codicon-modifier-"+S.substring(1)),g}_.asClassNameArray=s;function o(T){return s(T).join(" ")}_.asClassName=o;function l(T){return"."+s(T).join(".")}_.asCSSSelector=l;function c(T){return T&&typeof T=="object"&&typeof T.id=="string"&&(typeof T.color>"u"||Fa.isThemeColor(T.color))}_.isThemeIcon=c;let u=new RegExp(`^\\$\\((${_.iconNameExpression}(?:${_.iconModifierExpression})?)\\)$`);function d(T){let A=u.exec(T);if(!A)return;let[,$]=A;return{id:$}}_.fromString=d;function p(T){return{id:T}}_.fromId=p;function f(T,A){let $=T.id,S=$.lastIndexOf("~");return S!==-1&&($=$.substring(0,S)),A&&($=`${$}~${A}`),{id:$}}_.modify=f;function m(T){let A=T.id.lastIndexOf("~");if(A!==-1)return T.id.substring(A+1)}_.getModifier=m;function h(T,A){return T.id===A.id&&T.color?.id===A.color?.id}_.isEqual=h})(Un||={});var Ky=Object.freeze({View:dt("view","View"),Help:dt("help","Help"),Test:dt("test","Test"),File:dt("file","File"),Preferences:dt("preferences","Preferences"),Developer:dt({key:"developer",comment:["A developer on Code itself or someone diagnosing issues in Code"]},"Developer")});var dd=Y("commandService"),Ua=new class{_commands=new Map;_onDidRegisterCommand=new y;onDidRegisterCommand=this._onDidRegisterCommand.event;registerCommand(n,e){if(!n)throw new Error("invalid command");if(typeof n=="string"){if(!e)throw new Error("invalid command");return this.registerCommand({id:n,handler:e})}if(n.metadata&&Array.isArray(n.metadata.args)){let o=[];for(let c of n.metadata.args)o.push(c.constraint);let l=n.handler;n.handler=function(c,...u){return jo(u,o),l(c,...u)}}let{id:t}=n,r=this._commands.get(t);r||(r=new dn,this._commands.set(t,r));let i=r.unshift(n),s=X(()=>{i(),this._commands.get(t)?.isEmpty()&&this._commands.delete(t)});return this._onDidRegisterCommand.fire(t),s}registerCommandAlias(n,e){return Ua.registerCommand(n,(t,...r)=>t.get(dd).executeCommand(e,...r))}getCommand(n){let e=this._commands.get(n);if(!(!e||e.isEmpty()))return ln.first(e)}getCommands(){let n=new Map;for(let e of this._commands.keys()){let t=this.getCommand(e);t&&n.set(e,t)}return n}};Ua.registerCommand("noop",()=>{});var Oe=Y("logService"),Uv=Y("loggerService");function vs(n){return bn(n)}var Na=3;function Xt(n,e=!1){let t="";for(let r=0;r<n.length;r++){let i=n[r];if(i instanceof Error&&(i=fs(i,e)),typeof i=="object")try{i=JSON.stringify(i)}catch{}t+=(r>0?" ":"")+i}return t}var Hr=class extends O{level=Na;_onDidChangeLogLevel=this._register(new y);onDidChangeLogLevel=this._onDidChangeLogLevel.event;setLevel(e){this.level!==e&&(this.level=e,this._onDidChangeLogLevel.fire(this.level))}getLevel(){return this.level}checkLogLevel(e){return this.level!==0&&this.level<=e}},Nn=class extends Hr{constructor(t){super();this.logAlways=t}checkLogLevel(t){return this.logAlways||super.checkLogLevel(t)}trace(t,...r){this.checkLogLevel(1)&&this.log(1,Xt([t,...r],!0))}debug(t,...r){this.checkLogLevel(2)&&this.log(2,Xt([t,...r]))}info(t,...r){this.checkLogLevel(3)&&this.log(3,Xt([t,...r]))}warn(t,...r){this.checkLogLevel(4)&&this.log(4,Xt([t,...r]))}error(t,...r){if(this.checkLogLevel(5))if(t instanceof Error){let i=Array.prototype.slice.call(arguments);i[0]=t.stack,this.log(5,Xt(i))}else this.log(5,Xt([t,...r]))}flush(){}};var jr=class extends Hr{constructor(t){super();this.loggers=t;t.length&&this.setLevel(t[0].getLevel())}setLevel(t){for(let r of this.loggers)r.setLevel(t);super.setLevel(t)}trace(t,...r){for(let i of this.loggers)i.trace(t,...r)}debug(t,...r){for(let i of this.loggers)i.debug(t,...r)}info(t,...r){for(let i of this.loggers)i.info(t,...r)}warn(t,...r){for(let i of this.loggers)i.warn(t,...r)}error(t,...r){for(let i of this.loggers)i.error(t,...r)}flush(){for(let t of this.loggers)t.flush()}dispose(){for(let t of this.loggers)t.dispose();super.dispose()}},Bn=class extends O{constructor(t,r,i){super();this.logLevel=t;this.logsHome=r;if(i)for(let s of i)this._loggers.set(s.resource,{logger:void 0,info:s})}_loggers=new or;_onDidChangeLoggers=this._register(new y);onDidChangeLoggers=this._onDidChangeLoggers.event;_onDidChangeLogLevel=this._register(new y);onDidChangeLogLevel=this._onDidChangeLogLevel.event;_onDidChangeVisibility=this._register(new y);onDidChangeVisibility=this._onDidChangeVisibility.event;getLoggerEntry(t){return he(t)?[...this._loggers.values()].find(r=>r.info.id===t):this._loggers.get(t)}getLogger(t){return this.getLoggerEntry(t)?.logger}createLogger(t,r){let i=this.toResource(t),s=he(t)?t:r?.id??Sa(i.toString()).toString(16),o=this._loggers.get(i)?.logger,l=r?.logLevel==="always"?1:r?.logLevel;o||(o=this.doCreateLogger(i,l??this.getLogLevel(i)??this.logLevel,{...r,id:s}));let c={logger:o,info:{resource:i,id:s,logLevel:l,name:r?.name,hidden:r?.hidden,extensionId:r?.extensionId,when:r?.when}};return this.registerLogger(c.info),this._loggers.set(i,c),o}toResource(t){return he(t)?xe(this.logsHome,`${t}.log`):t}setLogLevel(t,r){if(R.isUri(t)){let i=t,s=r,o=this._loggers.get(i);o&&s!==o.info.logLevel&&(o.info.logLevel=s===this.logLevel?void 0:s,o.logger?.setLevel(s),this._loggers.set(o.info.resource,o),this._onDidChangeLogLevel.fire([i,s]))}else{this.logLevel=t;for(let[i,s]of this._loggers.entries())this._loggers.get(i)?.info.logLevel===void 0&&s.logger?.setLevel(this.logLevel);this._onDidChangeLogLevel.fire(this.logLevel)}}setVisibility(t,r){let i=this.getLoggerEntry(t);i&&r!==!i.info.hidden&&(i.info.hidden=!r,this._loggers.set(i.info.resource,i),this._onDidChangeVisibility.fire([i.info.resource,r]))}getLogLevel(t){let r;return t&&(r=this._loggers.get(t)?.info.logLevel),r??this.logLevel}registerLogger(t){let r=this._loggers.get(t.resource);r?r.info.hidden!==t.hidden&&this.setVisibility(t.resource,!t.hidden):(this._loggers.set(t.resource,{info:t,logger:void 0}),this._onDidChangeLoggers.fire({added:[t],removed:[]}))}deregisterLogger(t){let r=this._loggers.get(t);r&&(r.logger&&r.logger.dispose(),this._loggers.delete(t),this._onDidChangeLoggers.fire({added:[],removed:[r.info]}))}*getRegisteredLoggers(){for(let t of this._loggers.values())yield t.info}getRegisteredLogger(t){return this._loggers.get(t)?.info}dispose(){this._loggers.forEach(t=>t.logger?.dispose()),this._loggers.clear(),super.dispose()}};function Ba(n){if(n.verbose)return 1;if(typeof n.logLevel=="string"){let e=fd(n.logLevel.toLowerCase());if(e!==void 0)return e}return Na}function pd(n){switch(n){case 1:return"trace";case 2:return"debug";case 3:return"info";case 4:return"warn";case 5:return"error";case 0:return"off"}}function fd(n){switch(n){case"trace":return 1;case"debug":return 2;case"info":return 3;case"warn":return 4;case"error":return 5;case"critical":return 5;case"off":return 0}}var Nv=new Gt("logLevel",pd(3));var Gr=class{constructor(e,t){this.loggerService=e;this.getUriTransformer=t}listen(e,t){let r=this.getUriTransformer(e);switch(t){case"onDidChangeLoggers":return G.map(this.loggerService.onDidChangeLoggers,i=>({added:[...i.added].map(s=>this.transformLogger(s,r)),removed:[...i.removed].map(s=>this.transformLogger(s,r))}));case"onDidChangeVisibility":return G.map(this.loggerService.onDidChangeVisibility,i=>[r.transformOutgoingURI(i[0]),i[1]]);case"onDidChangeLogLevel":return G.map(this.loggerService.onDidChangeLogLevel,i=>vs(i)?i:[r.transformOutgoingURI(i[0]),i[1]])}throw new Error(`Event not found: ${t}`)}async call(e,t,r){let i=this.getUriTransformer(e);switch(t){case"setLogLevel":return vs(r[0])?this.loggerService.setLogLevel(r[0]):this.loggerService.setLogLevel(R.revive(i.transformIncoming(r[0][0])),r[0][1]);case"getRegisteredLoggers":return Promise.resolve([...this.loggerService.getRegisteredLoggers()].map(s=>this.transformLogger(s,i)))}throw new Error(`Call not found: ${t}`)}transformLogger(e,t){return{...e,resource:t.transformOutgoingURI(e.resource)}}};var Xr=class extends O{logger;constructor(e,t=[]){super(),this.logger=new jr([e,...t]),this._register(e.onDidChangeLogLevel(r=>this.setLevel(r)))}get onDidChangeLogLevel(){return this.logger.onDidChangeLogLevel}setLevel(e){this.logger.setLevel(e)}getLevel(){return this.logger.getLevel()}trace(e,...t){this.logger.trace(e,...t)}debug(e,...t){this.logger.debug(e,...t)}info(e,...t){this.logger.info(e,...t)}warn(e,...t){this.logger.warn(e,...t)}error(e,...t){this.logger.error(e,...t)}flush(){this.logger.flush()}};var Wa=function(){if(typeof crypto=="object"&&typeof crypto.randomUUID=="function")return crypto.randomUUID.bind(crypto);let n;typeof crypto=="object"&&typeof crypto.getRandomValues=="function"?n=crypto.getRandomValues.bind(crypto):n=function(r){for(let i=0;i<r.length;i++)r[i]=Math.floor(Math.random()*256);return r};let e=new Uint8Array(16),t=[];for(let r=0;r<256;r++)t.push(r.toString(16).padStart(2,"0"));return function(){n(e),e[6]=e[6]&15|64,e[8]=e[8]&63|128;let i=0,s="";return s+=t[e[i++]],s+=t[e[i++]],s+=t[e[i++]],s+=t[e[i++]],s+="-",s+=t[e[i++]],s+=t[e[i++]],s+="-",s+=t[e[i++]],s+=t[e[i++]],s+="-",s+=t[e[i++]],s+=t[e[i++]],s+="-",s+=t[e[i++]],s+=t[e[i++]],s+=t[e[i++]],s+=t[e[i++]],s+=t[e[i++]],s+=t[e[i++]],s}}();var Ix=new qe(1e4);var Dx=new Uint32Array(10);var Lx=new Uint8Array([114,82,115,101,69,102,97,113,81,116,84,100,119,87,99,122,120,118,103]),Ox=new Uint16Array([107,111,105,79,106,112,117,80,104,27496,28520,27752,121,110,27246,28782,27758,98,109,27757,108]),Ax=new Uint16Array([114,82,29810,115,30579,26483,101,102,29286,24934,29030,29798,30822,30310,26470,97,113,29809,116,84,100,119,99,122,120,118,103]),Mx=new Uint16Array([114,82,29810,115,30579,26483,101,69,102,29286,24934,29030,29798,30822,30310,26470,97,113,81,29809,116,84,100,119,87,99,122,120,118,103,107,111,105,79,106,112,117,80,104,27496,28520,27752,121,110,27246,28782,27758,98,109,27757,108]);function Va(...n){return function(e,t){for(let r=0,i=n.length;r<i;r++){let s=n[r](e,t);if(s)return s}return null}}var qx=qa.bind(void 0,!1),Ka=qa.bind(void 0,!0);function qa(n,e,t){if(!t||t.length<e.length)return null;let r;return n?r=Vt(t,e):r=t.indexOf(e)===0,r?e.length>0?[{start:0,end:e.length}]:[]:null}function gd(n,e){let t=e.toLowerCase().indexOf(n.toLowerCase());return t===-1?null:[{start:t,end:t+n.length}]}function bd(n,e){return xs(n.toLowerCase(),e.toLowerCase(),0,0)}function xs(n,e,t,r){if(t===n.length)return[];if(r===e.length)return null;if(n[t]===e[r]){let i=null;return(i=xs(n,e,t+1,r+1))?$a({start:r,end:r+1},i):null}return xs(n,e,t,r+1)}function _s(n){return 97<=n&&n<=122}function Jr(n){return 65<=n&&n<=90}function Ts(n){return 48<=n&&n<=57}function yd(n){return n===32||n===9||n===10||n===13}var vd=new Set;"()[]{}<>`'\"-/;:,.?!".split("").forEach(n=>vd.add(n.charCodeAt(0)));function za(n){return _s(n)||Jr(n)||Ts(n)}function $a(n,e){return e.length===0?e=[n]:n.end===e[0].start?e[0].start=n.start:e.unshift(n),e}function Ha(n,e){for(let t=e;t<n.length;t++){let r=n.charCodeAt(t);if(Jr(r)||Ts(r)||t>0&&!za(n.charCodeAt(t-1)))return t}return n.length}function Is(n,e,t,r){if(t===n.length)return[];if(r===e.length)return null;if(n[t]!==e[r].toLowerCase())return null;{let i=null,s=r+1;for(i=Is(n,e,t+1,r+1);!i&&(s=Ha(e,s))<e.length;)i=Is(n,e,t+1,s),s++;return i===null?null:$a({start:r,end:r+1},i)}}function xd(n){let e=0,t=0,r=0,i=0,s=0;for(let d=0;d<n.length;d++)s=n.charCodeAt(d),Jr(s)&&e++,_s(s)&&t++,za(s)&&r++,Ts(s)&&i++;let o=e/n.length,l=t/n.length,c=r/n.length,u=i/n.length;return{upperPercent:o,lowerPercent:l,alphaPercent:c,numericPercent:u}}function Id(n){let{upperPercent:e,lowerPercent:t}=n;return t===0&&e>.6}function _d(n){let{upperPercent:e,lowerPercent:t,alphaPercent:r,numericPercent:i}=n;return t>.2&&e<.8&&r>.6&&i<.2}function Td(n){let e=0,t=0,r=0,i=0;for(let s=0;s<n.length;s++)r=n.charCodeAt(s),Jr(r)&&e++,_s(r)&&t++,yd(r)&&i++;return(e===0||t===0)&&i===0?n.length<=30:e<=5}function ja(n,e){if(!e||(e=e.trim(),e.length===0)||!Td(n))return null;e.length>60&&(e=e.substring(0,60));let t=xd(e);if(!_d(t)){if(!Id(t))return null;e=e.toLowerCase()}let r=null,i=0;for(n=n.toLowerCase();i<e.length&&(r=Is(n,e,0,i))===null;)i=Ha(e,i+1);return r}var zx=Va(Ka,ja,gd),$x=Va(Ka,ja,bd),Hx=new qe(1e4);var Qr=128;function Es(){let n=[],e=[];for(let t=0;t<=Qr;t++)e[t]=0;for(let t=0;t<=Qr;t++)n.push(e.slice(0));return n}function Ga(n){let e=[];for(let t=0;t<=n;t++)e[t]=0;return e}var jx=Ga(2*Qr),Gx=Ga(2*Qr),Xx=Es(),Qx=Es(),Jx=Es();var Ed;(t=>{t.Default=[-100,0];function e(r){return!r||r.length===2&&r[0]===-100&&r[1]===0}t.isDefault=e})(Ed||={});var ws=new RegExp(`\\$\\(${Un.iconNameExpression}(?:${Un.iconModifierExpression})?\\)`,"g"),i2=new RegExp(`(\\\\)?${ws.source}`,"g");var s2=new RegExp(`\\\\${ws.source}`,"g");var o2=new RegExp(`(\\s)?(\\\\)?${ws.source}(\\s)?`,"g");var a2=new RegExp(`\\$\\(${Un.iconNameCharacter}+\\)`,"g");var z2=Y("fileService");var Yr=class n{static KB=1024;static MB=n.KB*n.KB;static GB=n.MB*n.KB;static TB=n.GB*n.KB;static formatSize(e){return bn(e)||(e=0),e<n.KB?v("sizeB","{0}B",e.toFixed(0)):e<n.MB?v("sizeKB","{0}KB",(e/n.KB).toFixed(2)):e<n.GB?v("sizeMB","{0}MB",(e/n.MB).toFixed(2)):e<n.TB?v("sizeGB","{0}GB",(e/n.GB).toFixed(2)):v("sizeTB","{0}TB",(e/n.TB).toFixed(2))}};async function Cd(n,e,t,r,i){try{let s=await import("@vscode/spdlog");s.setFlushOn(0);let o=await s.createAsyncRotatingLogger(n,e,t,r);return i?o.clearFormatters():o.setPattern("%Y-%m-%d %H:%M:%S.%e [%l] %v"),o}catch(s){console.error(s)}return null}function Xa(n,e,t){switch(e){case 1:n.trace(t);break;case 2:n.debug(t);break;case 3:n.info(t);break;case 4:n.warn(t);break;case 5:n.error(t);break;case 0:break;default:throw new Error(`Invalid log level ${e}`)}}function Qa(n,e){switch(e){case 1:n.setLevel(0);break;case 2:n.setLevel(1);break;case 3:n.setLevel(2);break;case 4:n.setLevel(3);break;case 5:n.setLevel(4);break;case 0:n.setLevel(6);break;default:throw new Error(`Invalid log level ${e}`)}}var Zr=class extends Nn{buffer=[];_loggerCreationPromise;_logger;constructor(e,t,r,i,s){super(),this.setLevel(s),this._loggerCreationPromise=this._createSpdLogLogger(e,t,r,i),this._register(this.onDidChangeLogLevel(o=>{this._logger&&Qa(this._logger,o)}))}async _createSpdLogLogger(e,t,r,i){let s=r?6:1,o=30/s*Yr.MB,l=await Cd(e,t,o,s,i);if(l){this._logger=l,Qa(this._logger,this.getLevel());for(let{level:c,message:u}of this.buffer)Xa(this._logger,c,u);this.buffer=[]}}log(e,t){this._logger?Xa(this._logger,e,t):this.getLevel()<=e&&this.buffer.push({level:e,message:t})}flush(){this._logger?this._logger.flush():this._loggerCreationPromise.then(()=>this.flush())}dispose(){this._logger?this.disposeLogger():this._loggerCreationPromise.then(()=>this.disposeLogger()),super.dispose()}disposeLogger(){this._logger&&(this._logger.drop(),this._logger=void 0)}};var ei=class extends Bn{doCreateLogger(e,t,r){return new Zr(Wa(),e.fsPath,!r?.donotRotate,!!r?.donotUseFormatters,t)}};var Ie,Ss=globalThis.vscode;if(typeof Ss<"u"&&typeof Ss.context<"u"){let n=Ss.context.configuration();if(n)Ie=n.product;else throw new Error("Sandbox: unable to resolve product configuration from preload script.")}else if(globalThis._VSCODE_PRODUCT_JSON&&globalThis._VSCODE_PACKAGE_JSON){if(Ie=globalThis._VSCODE_PRODUCT_JSON,de.VSCODE_DEV&&Object.assign(Ie,{nameShort:`${Ie.nameShort} Dev`,nameLong:`${Ie.nameLong} Dev`,dataFolderName:`${Ie.dataFolderName}-dev`,serverDataFolderName:Ie.serverDataFolderName?`${Ie.serverDataFolderName}-dev`:void 0}),!Ie.version){let n=globalThis._VSCODE_PACKAGE_JSON;Object.assign(Ie,{version:n.version})}}else Ie={},Object.keys(Ie).length===0&&Object.assign(Ie,{version:"1.94.0-dev",nameShort:"Code - OSS Dev",nameLong:"Code - OSS Dev",applicationName:"code-oss",dataFolderName:".vscode-oss",urlProtocol:"code-oss",reportIssueUrl:"https://github.com/microsoft/vscode/issues/new",licenseName:"MIT",licenseUrl:"https://github.com/microsoft/vscode/blob/main/LICENSE.txt",serverLicenseUrl:"https://github.com/microsoft/vscode/blob/main/LICENSE.txt"});var Ja=Ie;var Wn=class n{constructor(e,t){this._xterm=e;this._properties=t}get command(){return this._properties.command}get commandLineConfidence(){return this._properties.commandLineConfidence}get isTrusted(){return this._properties.isTrusted}get timestamp(){return this._properties.timestamp}get duration(){return this._properties.duration}get promptStartMarker(){return this._properties.promptStartMarker}get marker(){return this._properties.marker}get endMarker(){return this._properties.endMarker}set endMarker(e){this._properties.endMarker=e}get executedMarker(){return this._properties.executedMarker}get aliases(){return this._properties.aliases}get wasReplayed(){return this._properties.wasReplayed}get cwd(){return this._properties.cwd}get exitCode(){return this._properties.exitCode}get commandStartLineContent(){return this._properties.commandStartLineContent}get markProperties(){return this._properties.markProperties}get executedX(){return this._properties.executedX}get startX(){return this._properties.startX}static deserialize(e,t,r){let i=e.buffer.normal,s=t.startLine!==void 0?e.registerMarker(t.startLine-(i.baseY+i.cursorY)):void 0;if(!s)return;let o=t.promptStartLine!==void 0?e.registerMarker(t.promptStartLine-(i.baseY+i.cursorY)):void 0,l=t.endLine!==void 0?e.registerMarker(t.endLine-(i.baseY+i.cursorY)):void 0,c=t.executedLine!==void 0?e.registerMarker(t.executedLine-(i.baseY+i.cursorY)):void 0;return new n(e,{command:r?"":t.command,commandLineConfidence:t.commandLineConfidence??"low",isTrusted:t.isTrusted,promptStartMarker:o,marker:s,startX:t.startX,endMarker:l,executedMarker:c,executedX:t.executedX,timestamp:t.timestamp,duration:t.duration,cwd:t.cwd,commandStartLineContent:t.commandStartLineContent,exitCode:t.exitCode,markProperties:t.markProperties,aliases:void 0,wasReplayed:!0})}serialize(e){return{promptStartLine:this.promptStartMarker?.line,startLine:this.marker?.line,startX:void 0,endLine:this.endMarker?.line,executedLine:this.executedMarker?.line,executedX:this.executedX,command:e?"":this.command,commandLineConfidence:e?"low":this.commandLineConfidence,isTrusted:this.isTrusted,cwd:this.cwd,exitCode:this.exitCode,commandStartLineContent:this.commandStartLineContent,timestamp:this.timestamp,duration:this.duration,markProperties:this.markProperties}}extractCommandLine(){return Za(this._xterm.buffer.active,this._xterm.cols,this.marker,this.startX,this.executedMarker,this.executedX)}getOutput(){if(!this.executedMarker||!this.endMarker)return;let e=this.executedMarker.line,t=this.endMarker.line;if(e===t)return;let r="",i;for(let s=e;s<t;s++)i=this._xterm.buffer.active.getLine(s),i&&(r+=i.translateToString(!i.isWrapped)+(i.isWrapped?"":`
`));return r===""?void 0:r}getOutputMatch(e){if(!this.executedMarker||!this.endMarker)return;let t=this.endMarker.line;if(t===-1)return;let r=this._xterm.buffer.active,i=Math.max(this.executedMarker.line,0),s=e.lineMatcher,o=typeof s=="string"?1:e.length||Sd(s),l=[],c;if(e.anchor==="bottom")for(let u=t-(e.offset||0);u>=i;u--){let d=u,p=u;for(;d>=i&&r.getLine(d)?.isWrapped;)d--;if(u=d,l.unshift(Ya(r,d,p,this._xterm.cols)),c||(c=l[0].match(s)),l.length>=o)break}else for(let u=i+(e.offset||0);u<t;u++){let d=u,p=u;for(;p+1<t&&r.getLine(p+1)?.isWrapped;)p++;if(u=p,l.push(Ya(r,d,p,this._xterm.cols)),c||(c=l[l.length-1].match(s)),l.length>=o)break}return c?{regexMatch:c,outputLines:l}:void 0}hasOutput(){return!this.executedMarker?.isDisposed&&!this.endMarker?.isDisposed&&!!(this.executedMarker&&this.endMarker&&this.executedMarker.line<this.endMarker.line)}getPromptRowCount(){return el(this,this._xterm.buffer.active)}getCommandRowCount(){return tl(this)}},Vn=class{constructor(e){this._xterm=e}promptStartMarker;commandStartMarker;commandStartX;commandStartLineContent;commandRightPromptStartX;commandRightPromptEndX;commandLines;commandExecutedMarker;commandExecutedX;commandExecutedTimestamp;commandDuration;commandFinishedMarker;currentContinuationMarker;continuations;cwd;command;commandLineConfidence;isTrusted;isInvalid;serialize(e){if(this.commandStartMarker)return{promptStartLine:this.promptStartMarker?.line,startLine:this.commandStartMarker.line,startX:this.commandStartX,endLine:void 0,executedLine:void 0,executedX:void 0,command:"",commandLineConfidence:"low",isTrusted:!0,cwd:e,exitCode:void 0,commandStartLineContent:void 0,timestamp:0,duration:0,markProperties:void 0}}promoteToFullCommand(e,t,r,i){if(t===void 0&&this.command===void 0&&(this.command=""),this.command!==void 0&&!this.command.startsWith("\\")||r)return new Wn(this._xterm,{command:r?"":this.command||"",commandLineConfidence:r?"low":this.commandLineConfidence||"low",isTrusted:!!this.isTrusted,promptStartMarker:this.promptStartMarker,marker:this.commandStartMarker,startX:this.commandStartX,endMarker:this.commandFinishedMarker,executedMarker:this.commandExecutedMarker,executedX:this.commandExecutedX,timestamp:Date.now(),duration:this.commandDuration||0,cwd:e,exitCode:t,commandStartLineContent:this.commandStartLineContent,markProperties:i})}markExecutedTime(){this.commandExecutedTimestamp===void 0&&(this.commandExecutedTimestamp=Date.now())}markFinishedTime(){this.commandDuration===void 0&&this.commandExecutedTimestamp!==void 0&&(this.commandDuration=Date.now()-this.commandExecutedTimestamp)}extractCommandLine(){return Za(this._xterm.buffer.active,this._xterm.cols,this.commandStartMarker,this.commandStartX,this.commandExecutedMarker,this.commandExecutedX)}getPromptRowCount(){return el(this,this._xterm.buffer.active)}getCommandRowCount(){return tl(this)}};function Za(n,e,t,r,i,s){if(!t||!i||r===void 0||s===void 0)return"";let o="";for(let l=t.line;l<=i.line;l++){let c=n.getLine(l);c&&(o+=c.translateToString(!0,l===t.line?r:0,l===i.line?s:e))}return o}function Ya(n,e,t,r){let i=Math.max(2048/r*2);t=Math.min(t,e+i);let s="";for(let o=e;o<=t;o++){let l=n.getLine(o);l&&(s+=l.translateToString(!0,0,r))}return s}function Sd(n){if(!n.multiline)return 1;let e=n.source,t=1,r=e.indexOf("\\n");for(;r!==-1;)t++,r=e.indexOf("\\n",r+1);return t}function el(n,e){let t="hasOutput"in n?n.marker:n.commandStartMarker;if(!t||!n.promptStartMarker)return 1;let r=1,i=n.promptStartMarker.line;for(;i<t.line&&(e.getLine(i)?.translateToString(!0)??"").length===0;)i++;return r=t.line-i+1,r}function tl(n){let e="hasOutput"in n?n.marker:n.commandStartMarker,t="hasOutput"in n?n.executedMarker:n.commandExecutedMarker;if(!e||!t)return 1;let i=Math.max(t.line,e.line)-e.line+1;return("hasOutput"in n?n.executedX:n.commandExecutedX)===0&&i--,i}var NI=Y("contextService");var nl="code-workspace",BI=`.${nl}`,WI=[{name:v("codeWorkspace","Code Workspace"),extensions:[nl]}];function rl(n){let e=[],t=0;for(let r=0;r<n.length-1;r++)(r-t+1>=50||n[r+1]==="\x1B")&&(e.push(n.substring(t,r+1)),t=r+1,r++);return t!==n.length&&e.push(n.substring(t)),e}var Ps=class{data=new Map;add(e,t){cr(he(e)),cr(Gi(t)),cr(!this.data.has(e),"There is already an extension with this id"),this.data.set(e,t)}knows(e){return this.data.has(e)}as(e){return this.data.get(e)||null}},il=new Ps;var X_=new Gt("terminalTabFocusMode",!1,!0);var Q_=Y("ptyService");var Pd={Backend:"workbench.contributions.terminal.processBackend"},Rs=class{_backends=new Map;get backends(){return this._backends}registerTerminalBackend(e){let t=this._sanitizeRemoteAuthority(e.remoteAuthority);if(this._backends.has(t))throw new Error(`A terminal backend with remote authority '${t}' was already registered.`);this._backends.set(t,e)}getTerminalBackend(e){return this._backends.get(this._sanitizeRemoteAuthority(e))}_sanitizeRemoteAuthority(e){return e?.toLowerCase()??""}};il.add(Pd.Backend,new Rs);var J_=Y("localPtyService"),Y_=Y("terminalLogService");var ti=class extends O{_onBeat=this._register(new y);onBeat=this._onBeat.event;constructor(){super();let e=setInterval(()=>{this._onBeat.fire()},5e3);this._register(X(()=>clearInterval(e)))}};import{execFile as Pl,exec as Zd}from"child_process";import{userInfo as Ud}from"os";import*as al from"os";var sl=/^\d+$/,Rd=/^Microsoft.PowerShell_.*/,kd=/^Microsoft.PowerShellPreview_.*/;var Kn;switch(process.arch){case"ia32":Kn=1;break;case"arm":case"arm64":Kn=2;break;default:Kn=0;break}var Qt;process.env.PROCESSOR_ARCHITEW6432?Qt=process.env.PROCESSOR_ARCHITEW6432==="ARM64"?2:0:process.env.PROCESSOR_ARCHITECTURE==="ARM64"?Qt=2:process.env.PROCESSOR_ARCHITECTURE==="X86"?Qt=1:Qt=0;var Jt=class{constructor(e,t,r){this.exePath=e;this.displayName=t;this.knownToExist=r}async exists(){return this.knownToExist===void 0&&(this.knownToExist=await $e.existsFile(this.exePath)),this.knownToExist}};function Dd({useAlternateBitness:n=!1}={}){return n?Kn===0?process.env["ProgramFiles(x86)"]||null:Qt===0&&process.env.ProgramW6432||null:process.env.ProgramFiles||null}async function ni({useAlternateBitness:n=!1,findPreview:e=!1}={}){let t=Dd({useAlternateBitness:n});if(!t)return null;let r=k(t,"PowerShell");if(!await $e.existsDirectory(r))return null;let i=-1,s=null;for(let c of await It.readdir(r)){let u=-1;if(e){let p=c.indexOf("-");if(p<0)continue;let f=c.substring(0,p);if(!sl.test(f)||c.substring(p+1)!=="preview")continue;u=parseInt(f,10)}else{if(!sl.test(c))continue;u=parseInt(c,10)}if(u<=i)continue;let d=k(r,c,"pwsh.exe");await $e.existsFile(d)&&(s=d,i=u)}if(!s)return null;let o=t.includes("x86")?" (x86)":"",l=e?" Preview":"";return new Jt(s,`PowerShell${l}${o}`,!0)}async function ol({findPreview:n}={}){if(!process.env.LOCALAPPDATA)return null;let e=k(process.env.LOCALAPPDATA,"Microsoft","WindowsApps");if(!await $e.existsDirectory(e))return null;let{pwshMsixDirRegex:t,pwshMsixName:r}=n?{pwshMsixDirRegex:kd,pwshMsixName:"PowerShell Preview (Store)"}:{pwshMsixDirRegex:Rd,pwshMsixName:"PowerShell (Store)"};for(let i of await It.readdir(e))if(t.test(i)){let s=k(e,i,"pwsh.exe");return new Jt(s,r)}return null}function Ld(){let n=k(al.homedir(),".dotnet","tools","pwsh.exe");return new Jt(n,".NET Core PowerShell Global Tool")}function Od(){let n=k(process.env.windir,Kn===1&&Qt!==1?"SysNative":"System32","WindowsPowerShell","v1.0","powershell.exe");return new Jt(n,"Windows PowerShell",!0)}async function*Ad(){let n=await ni();n&&(yield n),n=await ni({useAlternateBitness:!0}),n&&(yield n),n=await ol(),n&&(yield n),n=Ld(),n&&(yield n),n=await ni({findPreview:!0}),n&&(yield n),n=await ol({findPreview:!0}),n&&(yield n),n=await ni({useAlternateBitness:!0,findPreview:!0}),n&&(yield n),n=Od(),n&&(yield n)}async function*Md(){for await(let n of Ad())await n.exists()&&(yield n)}async function ll(){for await(let n of Md())return n;return null}async function ul(n,e){return n===1?D?Bd():da(e):Nd(n,e)}var ks=null;function Nd(n,e){if(Ce&&n===2||be&&n===3)return"/bin/bash";if(!ks){let t;if(D)t="/bin/bash";else{if(t=e.SHELL,!t)try{t=Ud().shell}catch{}t||(t="sh"),t==="/bin/false"&&(t="/bin/bash")}ks=t}return ks}var Ds=null;async function Bd(){return Ds||(Ds=(await ll()).exePath),Ds}var Yt=class extends O{constructor(t,r){super();this._logService=r;this._timeout=t===void 0?15e3:t,this._register(X(()=>{for(let i of this._pendingRequestDisposables.values())Se(i)}))}_lastRequestId=0;_timeout;_pendingRequests=new Map;_pendingRequestDisposables=new Map;_onCreateRequest=this._register(new y);onCreateRequest=this._onCreateRequest.event;createRequest(t){return new Promise((r,i)=>{let s=++this._lastRequestId;this._pendingRequests.set(s,r),this._onCreateRequest.fire({requestId:s,...t});let o=new Fe;pe(this._timeout,o.token).then(()=>i(`Request ${s} timed out (${this._timeout}ms)`)),this._pendingRequestDisposables.set(s,[X(()=>o.cancel())])})}acceptReply(t,r){let i=this._pendingRequests.get(t);i?(this._pendingRequests.delete(t),Se(this._pendingRequestDisposables.get(t)||[]),this._pendingRequestDisposables.delete(t),i(r)):this._logService.warn(`RequestStore#acceptReply was called without receiving a matching request ${t}`)}};Yt=b([we(1,Oe)],Yt);var ri=class{constructor(e){this._callback=e}_terminalBufferMap=new Map;dispose(){for(let e of this._terminalBufferMap.values())e.dispose()}startBuffering(e,t,r=5){let i=t(s=>{let o=typeof s=="string"?s:s.data,l=this._terminalBufferMap.get(e);if(l){l.data.push(o);return}let c=setTimeout(()=>this.flushBuffer(e),r);l={data:[o],timeoutId:c,dispose:()=>{clearTimeout(c),this.flushBuffer(e),i.dispose()}},this._terminalBufferMap.set(e,l)});return i}stopBuffering(e){this._terminalBufferMap.get(e)?.dispose()}flushBuffer(e){let t=this._terminalBufferMap.get(e);t&&(this._terminalBufferMap.delete(e),this._callback(e,t.data.join("")))}};function cl(n){let e=n;e.includes("\\")&&(e=e.replace(/\\/g,"\\\\"));let t=/[\`\$\|\&\>\~\#\!\^\*\;\<\"\']/g;return e=e.replace(t,""),`'${e}'`}function dl(n){return n.match(/^['"].*['"]$/)&&(n=n.substring(1,n.length-1)),tr===1&&n&&n[1]===":"?n[0].toUpperCase()+n.substring(1):n}import*as at from"os";function Wd(n){return new Map(n)}function Vd(n){return new Map(n??[])}function pl(n){return new Map(n.map(e=>[e[0],{map:Wd(e[1]),descriptionMap:Vd(e[2])}]))}var qd=new Map([[2,"APPEND"],[3,"PREPEND"],[1,"REPLACE"]]),ii=class{constructor(e){this.collections=e;e.forEach((t,r)=>{this.populateDescriptionMap(t,r);let i=t.map.entries(),s=i.next();for(;!s.done;){let o=s.value[1],l=s.value[0],c=this.map.get(l);if(c||(c=[],this.map.set(l,c)),c.length>0&&c[0].type===1){s=i.next();continue}let u={extensionIdentifier:r,value:o.value,type:o.type,scope:o.scope,variable:o.variable,options:o.options};u.scope||delete u.scope,c.unshift(u),s=i.next()}})}map=new Map;descriptionMap=new Map;async applyToProcessEnvironment(e,t,r){let i;D&&(i={},Object.keys(e).forEach(s=>i[s.toLowerCase()]=s));for(let[s,o]of this.getVariableMap(t)){let l=D&&i[s.toLowerCase()]||s;for(let c of o){let u=r?await r(c.value):c.value;if(c.options?.applyAtProcessCreation??!0)switch(c.type){case 2:e[l]=(e[l]||"")+u;break;case 3:e[l]=u+(e[l]||"");break;case 1:e[l]=u;break}if(c.options?.applyAtShellIntegration??!1){let d=`VSCODE_ENV_${qd.get(c.type)}`;e[d]=(e[d]?e[d]+":":"")+s+"="+this._encodeColons(u)}}}}_encodeColons(e){return e.replaceAll(":","\\x3a")}diff(e,t){let r=new Map,i=new Map,s=new Map;if(e.getVariableMap(t).forEach((o,l)=>{let c=this.getVariableMap(t).get(l),u=ml(o,c);u&&r.set(l,u)}),this.getVariableMap(t).forEach((o,l)=>{let c=e.getVariableMap(t).get(l),u=ml(o,c);u&&s.set(l,u)}),this.getVariableMap(t).forEach((o,l)=>{let c=e.getVariableMap(t).get(l),u=zd(o,c);u&&i.set(l,u)}),!(r.size===0&&i.size===0&&s.size===0))return{added:r,changed:i,removed:s}}getVariableMap(e){let t=new Map;for(let r of this.map.values()){let i=r.filter(s=>fl(s,e));i.length>0&&t.set(i[0].variable,i)}return t}getDescriptionMap(e){let t=new Map;for(let r of this.descriptionMap.values()){let i=r.filter(s=>fl(s,e,!0));for(let s of i)t.set(s.extensionIdentifier,s.description)}return t}populateDescriptionMap(e,t){if(!e.descriptionMap)return;let r=e.descriptionMap.entries(),i=r.next();for(;!i.done;){let s=i.value[1],o=i.value[0],l=this.descriptionMap.get(o);l||(l=[],this.descriptionMap.set(o,l));let c={extensionIdentifier:t,scope:s.scope,description:s.description};c.scope||delete c.scope,l.push(c),i=r.next()}}};function fl(n,e,t=!1){return n.scope?!!(n.scope.workspaceFolder&&e?.workspaceFolder&&n.scope.workspaceFolder.index===e.workspaceFolder.index):t?e===n.scope:!0}function ml(n,e){if(!e)return n;let t=new Set;e.forEach(i=>t.add(i.extensionIdentifier));let r=[];return n.forEach(i=>{t.has(i.extensionIdentifier)||r.push(i)}),r.length===0?void 0:r}function zd(n,e){if(!e)return;let t=new Map;e.forEach(i=>t.set(i.extensionIdentifier,i));let r=[];return n.forEach(i=>{let s=t.get(i.extensionIdentifier);s&&(i.type!==s.type||i.value!==s.value||i.scope?.workspaceFolder?.index!==s.scope?.workspaceFolder?.index)&&r.push(s)}),r.length===0?void 0:r}function lt(){let n=/(\d+)\.(\d+)\.(\d+)/g.exec(at.release()),e=0;return n&&n.length===4&&(e=parseInt(n[3])),e}async function yl(n,e,t,r=de,i=It.exists){if(ft(n))return await i(n)?n:void 0;if(e===void 0&&(e=Ke()),Re(n)!=="."){let c=k(e,n);return await i(c)?c:void 0}let o=ra(r,"PATH");if(t===void 0&&he(o)&&(t=o.split(Ot)),t===void 0||t.length===0){let c=k(e,n);return await i(c)?c:void 0}for(let c of t){let u;if(ft(c)?u=k(c,n):u=k(e,c,n),await i(u))return u;if(D){let d=u+".com";if(await i(d)||(d=u+".exe",await i(d)))return d}}let l=k(e,n);return await i(l)?l:void 0}function vl(n,e,t,r,i){let s=D&&(!e.windowsEnableConpty||lt()<18309);if(!e.shellIntegration.enabled||!n.executable||n.isFeatureTerminal&&!n.forceShellIntegration||n.ignoreShellIntegration||s)return;let o=n.args,l=nr==="win32"?mt(n.executable).toLowerCase():mt(n.executable),c=Re(rt.asFileUri("").fsPath),u,d={VSCODE_INJECTION:"1"};if(e.shellIntegration.nonce&&(d.VSCODE_NONCE=e.shellIntegration.nonce),D){if(l==="pwsh.exe"||l==="powershell.exe")return!o||bl(o)?u=ie.get("windows-pwsh"):gl(o)&&(u=ie.get("windows-pwsh-login")),u?(u=[...u],u[u.length-1]=Wt(u[u.length-1],c,""),d.VSCODE_STABLE=i.quality==="stable"?"1":"0",e.shellIntegration.suggestEnabled&&(d.VSCODE_SUGGEST="1"),{newArgs:u,envMixin:d}):void 0;if(l==="bash.exe")return!o||o.length===0?u=ie.get("bash"):Ls(o)&&(d.VSCODE_SHELL_LOGIN="1",si(e,d),u=ie.get("bash")),u?(u=[...u],u[u.length-1]=Wt(u[u.length-1],c),d.VSCODE_STABLE=i.quality==="stable"?"1":"0",{newArgs:u,envMixin:d}):void 0;r.warn(`Shell integration cannot be enabled for executable "${n.executable}" and args`,n.args);return}switch(l){case"bash":return!o||o.length===0?u=ie.get("bash"):Ls(o)&&(d.VSCODE_SHELL_LOGIN="1",si(e,d),u=ie.get("bash")),u?(u=[...u],u[u.length-1]=Wt(u[u.length-1],c),d.VSCODE_STABLE=i.quality==="stable"?"1":"0",{newArgs:u,envMixin:d}):void 0;case"fish":{let p=t?.XDG_DATA_DIRS??"/usr/local/share:/usr/share",f=k(c,"out/vs/workbench/contrib/terminal/common/scripts/fish_xdg_data");return d.XDG_DATA_DIRS=`${p}:${f}`,si(e,d),{newArgs:void 0,envMixin:d}}case"pwsh":return!o||bl(o)?u=ie.get("pwsh"):gl(o)&&(u=ie.get("pwsh-login")),u?(e.shellIntegration.suggestEnabled&&(d.VSCODE_SUGGEST="1"),u=[...u],u[u.length-1]=Wt(u[u.length-1],c,""),d.VSCODE_STABLE=i.quality==="stable"?"1":"0",{newArgs:u,envMixin:d}):void 0;case"zsh":{if(!o||o.length===0?u=ie.get("zsh"):Ls(o)?(u=ie.get("zsh-login"),si(e,d)):(o===ie.get("zsh")||o===ie.get("zsh-login"))&&(u=o),!u)return;u=[...u],u[u.length-1]=Wt(u[u.length-1],c);let p;try{p=at.userInfo().username}catch{p="unknown"}let f=k(at.tmpdir(),`${p}-${i.applicationName}-zsh`);d.ZDOTDIR=f;let m=t?.ZDOTDIR??at.homedir()??"~";d.USER_ZDOTDIR=m;let h=[];return h.push({source:k(c,"out/vs/workbench/contrib/terminal/common/scripts/shellIntegration-rc.zsh"),dest:k(f,".zshrc")}),h.push({source:k(c,"out/vs/workbench/contrib/terminal/common/scripts/shellIntegration-profile.zsh"),dest:k(f,".zprofile")}),h.push({source:k(c,"out/vs/workbench/contrib/terminal/common/scripts/shellIntegration-env.zsh"),dest:k(f,".zshenv")}),h.push({source:k(c,"out/vs/workbench/contrib/terminal/common/scripts/shellIntegration-login.zsh"),dest:k(f,".zlogin")}),{newArgs:u,envMixin:d,filesToCopy:h}}}r.warn(`Shell integration cannot be enabled for executable "${n.executable}" and args`,n.args)}function si(n,e){if(be&&n.environmentVariableCollections){let t=pl(n.environmentVariableCollections),i=new ii(t).getVariableMap({workspaceFolder:n.workspaceFolder}).get("PATH"),s=[];if(i)for(let o of i)o.type===3&&s.push(o.value);s.length>0&&(e.VSCODE_PATH_PREFIX=s.join(""))}}var ie=new Map;ie.set("windows-pwsh",["-noexit","-command",'try { . "{0}\\out\\vs\\workbench\\contrib\\terminal\\common\\scripts\\shellIntegration.ps1" } catch {}{1}']);ie.set("windows-pwsh-login",["-l","-noexit","-command",'try { . "{0}\\out\\vs\\workbench\\contrib\\terminal\\common\\scripts\\shellIntegration.ps1" } catch {}{1}']);ie.set("pwsh",["-noexit","-command",'. "{0}/out/vs/workbench/contrib/terminal/common/scripts/shellIntegration.ps1"{1}']);ie.set("pwsh-login",["-l","-noexit","-command",'. "{0}/out/vs/workbench/contrib/terminal/common/scripts/shellIntegration.ps1"']);ie.set("zsh",["-i"]);ie.set("zsh-login",["-il"]);ie.set("bash",["--init-file","{0}/out/vs/workbench/contrib/terminal/common/scripts/shellIntegration-bash.sh"]);var oi=["-login","-l"],hl=["--login","-l"],$d=["-i","--interactive"],ai=["-nol","-nologo"];function gl(n){return typeof n=="string"?oi.includes(n.toLowerCase()):n.length===1&&oi.includes(n[0].toLowerCase())||n.length===2&&(oi.includes(n[0].toLowerCase())||oi.includes(n[1].toLowerCase()))&&(ai.includes(n[0].toLowerCase())||ai.includes(n[1].toLowerCase()))}function bl(n){return typeof n=="string"?ai.includes(n.toLowerCase()):n.length===0||n?.length===1&&ai.includes(n[0].toLowerCase())}function Ls(n){return typeof n!="string"&&(n=n.filter(e=>!$d.includes(e.toLowerCase()))),n==="string"&&hl.includes(n.toLowerCase())||typeof n!="string"&&n.length===1&&hl.includes(n[0].toLowerCase())}import*as Zt from"fs";import{exec as Xd}from"child_process";import{exec as li}from"child_process";function Il(n){return new Promise((e,t)=>{let r,i=new Map;function s(c,u,d,p,f){let m=i.get(u);if(c===n||m){let h={name:o(d),cmd:d,pid:c,ppid:u,load:p,mem:f};i.set(c,h),c===n&&(r=h),m&&(m.children||(m.children=[]),m.children.push(h),m.children.length>1&&(m.children=m.children.sort((_,T)=>_.pid-T.pid)))}}function o(c){let u=/--utility-sub-type=network/i,d=/--crashes-directory/i,p=/\\pipe\\winpty-control/i,f=/conhost\.exe.+--headless/i,m=/--type=([a-zA-Z-]+)/;if(d.exec(c))return"electron-crash-reporter";if(p.exec(c))return"winpty-agent";if(f.exec(c))return"conpty-agent";let h=m.exec(c);if(h&&h.length===2)return h[1]==="renderer"?"window":h[1]==="utility"?u.exec(c)?"utility-network-service":"utility-process":h[1]==="extensionHost"?"extension-host":h[1];let _=/[a-zA-Z-]+\.js/g,T="";do h=_.exec(c),h&&(T+=h+" ");while(h);return T&&c.indexOf("node ")<0&&c.indexOf("node.exe")<0?`electron-nodejs (${T})`:c}if(process.platform==="win32"){let c=u=>u.indexOf("\\\\?\\")===0||u.indexOf("\\??\\")===0?u.substring(4):u.indexOf('"\\\\?\\')===0||u.indexOf('"\\??\\')===0?'"'+u.substring(5):u;import("@vscode/windows-process-tree").then(u=>{u.getProcessList(n,d=>{if(!d){t(new Error(`Root process ${n} not found`));return}u.getProcessCpuUsage(d,p=>{let f=new Map;p.forEach(m=>{let h=c(m.commandLine||"");f.set(m.pid,{name:o(h),cmd:h,pid:m.pid,ppid:m.ppid,load:m.cpu||0,mem:m.memory||0})}),r=f.get(n),r?(f.forEach(m=>{let h=f.get(m.ppid);h&&(h.children||(h.children=[]),h.children.push(m))}),f.forEach(m=>{m.children&&(m.children=m.children.sort((h,_)=>h.pid-_.pid))}),e(r)):t(new Error(`Root process ${n} not found`))})},u.ProcessDataFlag.CommandLine|u.ProcessDataFlag.Memory)})}else{let c=function(){let u=[r],d=[];for(;u.length;){let f=u.shift();f&&(d.push(f.pid),f.children&&(u=u.concat(f.children)))}let p=JSON.stringify(rt.asFileUri("vs/base/node/cpuUsage.sh").fsPath);p+=" "+d.join(" "),li(p,{},(f,m,h)=>{if(f||h)t(f||new Error(h.toString()));else{let _=m.toString().split(`
`);for(let T=0;T<d.length;T++){let A=i.get(d[T]);A.load=parseFloat(_[T])}if(!r){t(new Error(`Root process ${n} not found`));return}e(r)}})};var l=c;li("which ps",{},(u,d,p)=>{if(u||p)if(process.platform!=="linux")t(u||new Error(p.toString()));else{let f=JSON.stringify(rt.asFileUri("vs/base/node/ps.sh").fsPath);li(f,{},(m,h,_)=>{m||_?t(m||new Error(_.toString())):(xl(h,s),c())})}else{let f=d.toString().trim();li(`${f} -ax -o pid=,ppid=,pcpu=,pmem=,command=`,{maxBuffer:1e3*1024,env:{LC_NUMERIC:"en_US.UTF-8"}},(h,_,T)=>{h||T&&!T.includes("screen size is bogus")?t(h||new Error(T.toString())):(xl(_,s),process.platform==="linux"?c():r?e(r):t(new Error(`Root process ${n} not found`)))})}})}})}function xl(n,e){let t=/^\s*([0-9]+)\s+([0-9]+)\s+([0-9]+\.[0-9]+)\s+([0-9]+\.[0-9]+)\s+(.+)$/,r=n.toString().split(`
`);for(let i of r){let s=t.exec(i.trim());s&&s.length===6&&e(parseInt(s[1]),parseInt(s[2]),s[5],parseFloat(s[3]),parseFloat(s[4]))}}var ui=[],ut=class extends O{constructor(t,r){super();this._pid=t;this._logService=r}_hasChildProcesses=!1;set hasChildProcesses(t){this._hasChildProcesses!==t&&(this._hasChildProcesses=t,this._logService.debug("ChildProcessMonitor: Has child processes changed",t),this._onDidChangeHasChildProcesses.fire(t))}get hasChildProcesses(){return this._hasChildProcesses}_onDidChangeHasChildProcesses=this._register(new y);onDidChangeHasChildProcesses=this._onDidChangeHasChildProcesses.event;handleInput(){this._refreshActive()}handleOutput(){this._refreshInactive()}async _refreshActive(){if(!this._store.isDisposed)try{let t=await Il(this._pid);this.hasChildProcesses=this._processContainsChildren(t)}catch(t){this._logService.debug("ChildProcessMonitor: Fetching process tree failed",t)}}_refreshInactive(){this._refreshActive()}_processContainsChildren(t){if(!t.children)return!1;if(t.children.length===1){let r=t.children[0],i;if(r.cmd.startsWith('"'))i=r.cmd.substring(1,r.cmd.indexOf('"',1));else{let s=r.cmd.indexOf(" ");s===-1?i=r.cmd:i=r.cmd.substring(0,s)}return ui.indexOf(fo(i).name)===-1}return t.children.length>0}};b([qt(1e3)],ut.prototype,"_refreshActive",1),b([kr(5e3)],ut.prototype,"_refreshInactive",1),ut=b([we(1,Oe)],ut);var jd=["cmd.exe","powershell.exe","pwsh.exe","bash.exe","wsl.exe","ubuntu.exe","ubuntu1804.exe","kali.exe","debian.exe","opensuse-42.exe","sles-12.exe"],Os,qn=class extends O{constructor(t){super();this._rootProcessId=t;if(!D)throw new Error(`WindowsShellHelper cannot be instantiated on ${io}`);this._startMonitoringShell()}_currentRequest;_shellType;get shellType(){return this._shellType}_shellTitle="";get shellTitle(){return this._shellTitle}_onShellNameChanged=new y;get onShellNameChanged(){return this._onShellNameChanged.event}_onShellTypeChanged=new y;get onShellTypeChanged(){return this._onShellTypeChanged.event}async _startMonitoringShell(){this._store.isDisposed||this.checkShell()}async checkShell(){D&&(await pe(300),this.getShellName().then(t=>{let r=this.getShellType(t);r!==this._shellType&&(this._onShellTypeChanged.fire(r),this._onShellNameChanged.fire(t),this._shellType=r,this._shellTitle=t)}))}traverseTree(t){if(!t)return"";if(jd.indexOf(t.name)===-1||!t.children||t.children.length===0)return t.name;let r=0;for(;r<t.children.length;r++){let i=t.children[r];if(!i.children||i.children.length===0||i.children[0].name!=="conhost.exe")break}return r>=t.children.length?t.name:this.traverseTree(t.children[r])}async getShellName(){return this._store.isDisposed?Promise.resolve(""):this._currentRequest?this._currentRequest:(Os||(Os=await import("@vscode/windows-process-tree")),this._currentRequest=new Promise(t=>{Os.getProcessTree(this._rootProcessId,r=>{let i=this.traverseTree(r);this._currentRequest=void 0,t(i)})}),this._currentRequest)}getShellType(t){switch(t.toLowerCase()){case"cmd.exe":return"cmd";case"powershell.exe":case"pwsh.exe":return"pwsh";case"bash.exe":case"git-cmd.exe":return"gitbash";case"julialauncher.exe":return"julia";case"nu.exe":return"nu";case"wsl.exe":case"ubuntu.exe":case"ubuntu1804.exe":case"kali.exe":case"debian.exe":case"opensuse-42.exe":case"sles-12.exe":return"wsl";default:return t.match(/python(\d(\.\d{0,2})?)?\.exe/)?"python":void 0}}};b([qt(500)],qn.prototype,"checkShell",1);import{spawn as Qd}from"node-pty";var _l=new Map([["bash","bash"],["csh","csh"],["fish","fish"],["ksh","ksh"],["sh","sh"],["zsh","zsh"]]),Tl=new Map([["pwsh","pwsh"],["python","python"],["julia","julia"],["nu","nu"]]),Ue=class extends O{constructor(t,r,i,s,o,l,c,u,d){super();this.shellLaunchConfig=t;this._executableEnv=l;this._options=c;this._logService=u;this._productService=d;let p;D?p=mt(this.shellLaunchConfig.executable||""):p="xterm-256color",this._initialCwd=r,this._properties.initialCwd=this._initialCwd,this._properties.cwd=this._initialCwd;let f=this._options.windowsEnableConpty&&process.platform==="win32"&&lt()>=18309,m=f&&this._options.windowsUseConptyDll;this._ptyOptions={name:p,cwd:r,env:o,cols:i,rows:s,useConpty:f,useConptyDll:m,conptyInheritCursor:f&&!!t.initialText},D&&(f&&i===0&&s===0&&this.shellLaunchConfig.executable?.endsWith("Git\\bin\\bash.exe")&&(this._delayedResizer=new As,this._register(this._delayedResizer.onTrigger(h=>{this._delayedResizer?.dispose(),this._delayedResizer=void 0,h.cols&&h.rows&&this.resize(h.cols,h.rows)}))),this.onProcessReady(h=>{this._windowsShellHelper=this._register(new qn(h.pid)),this._register(this._windowsShellHelper.onShellTypeChanged(_=>this._onDidChangeProperty.fire({type:"shellType",value:_}))),this._register(this._windowsShellHelper.onShellNameChanged(_=>this._onDidChangeProperty.fire({type:"title",value:_})))})),this._register(X(()=>{this._titleInterval&&(clearInterval(this._titleInterval),this._titleInterval=null)}))}id=0;shouldPersist=!1;_properties={cwd:"",initialCwd:"",fixedDimensions:{cols:void 0,rows:void 0},title:"",shellType:void 0,hasChildProcesses:!0,resolvedShellLaunchConfig:{},overrideDimensions:void 0,failedShellIntegrationActivation:!1,usedShellIntegrationInjection:void 0};static _lastKillOrStart=0;_exitCode;_exitMessage;_closeTimeout;_ptyProcess;_currentTitle="";_processStartupComplete;_windowsShellHelper;_childProcessMonitor;_titleInterval=null;_writeQueue=[];_writeTimeout;_delayedResizer;_initialCwd;_ptyOptions;_isPtyPaused=!1;_unacknowledgedCharCount=0;get exitMessage(){return this._exitMessage}get currentTitle(){return this._windowsShellHelper?.shellTitle||this._currentTitle}get shellType(){return D?this._windowsShellHelper?.shellType:_l.get(this._currentTitle)||Tl.get(this._currentTitle)}get hasChildProcesses(){return this._childProcessMonitor?.hasChildProcesses||!1}_onProcessData=this._register(new y);onProcessData=this._onProcessData.event;_onProcessReady=this._register(new y);onProcessReady=this._onProcessReady.event;_onDidChangeProperty=this._register(new y);onDidChangeProperty=this._onDidChangeProperty.event;_onProcessExit=this._register(new y);onProcessExit=this._onProcessExit.event;async start(){let r=(await Promise.all([this._validateCwd(),this._validateExecutable()])).find(s=>s!==void 0);if(r)return r;let i;if(this._options.shellIntegration.enabled)if(i=vl(this.shellLaunchConfig,this._options,this._ptyOptions.env,this._logService,this._productService),i){if(this._onDidChangeProperty.fire({type:"usedShellIntegrationInjection",value:!0}),i.envMixin)for(let[s,o]of Object.entries(i.envMixin))this._ptyOptions.env||={},this._ptyOptions.env[s]=o;if(i.filesToCopy)for(let s of i.filesToCopy)try{await Zt.promises.mkdir(Re(s.dest),{recursive:!0}),await Zt.promises.copyFile(s.source,s.dest)}catch{}}else this._onDidChangeProperty.fire({type:"failedShellIntegrationActivation",value:!0});try{return await this.setupPtyProcess(this.shellLaunchConfig,this._ptyOptions,i),i?.newArgs?{injectedArgs:i.newArgs}:void 0}catch(s){return this._logService.trace("node-pty.node-pty.IPty#spawn native exception",s),{message:`A native exception occurred during launch (${s.message})`}}}async _validateCwd(){try{if(!(await Zt.promises.stat(this._initialCwd)).isDirectory())return{message:v("launchFail.cwdNotDirectory",'Starting directory (cwd) "{0}" is not a directory',this._initialCwd.toString())}}catch(t){if(t?.code==="ENOENT")return{message:v("launchFail.cwdDoesNotExist",'Starting directory (cwd) "{0}" does not exist',this._initialCwd.toString())}}this._onDidChangeProperty.fire({type:"initialCwd",value:this._initialCwd})}async _validateExecutable(){let t=this.shellLaunchConfig;if(!t.executable)throw new Error("IShellLaunchConfig.executable not set");let r=t.cwd instanceof R?t.cwd.path:t.cwd,i=t.env&&t.env.PATH?t.env.PATH.split(Ot):void 0,s=await yl(t.executable,r,i,this._executableEnv);if(!s)return{message:v("launchFail.executableDoesNotExist",'Path to shell executable "{0}" does not exist',t.executable)};try{let o=await Zt.promises.stat(s);if(!o.isFile()&&!o.isSymbolicLink())return{message:v("launchFail.executableIsNotFileOrSymlink",'Path to shell executable "{0}" is not a file or a symlink',t.executable)};t.executable=s}catch(o){if(o?.code!=="EACCES")throw o}}async setupPtyProcess(t,r,i){let s=i?.newArgs||t.args||[];await this._throttleKillSpawn(),this._logService.trace("node-pty.IPty#spawn",t.executable,s,r);let o=Qd(t.executable,s,r);this._ptyProcess=o,this._childProcessMonitor=this._register(new ut(o.pid,this._logService)),this._childProcessMonitor.onDidChangeHasChildProcesses(l=>this._onDidChangeProperty.fire({type:"hasChildProcesses",value:l})),this._processStartupComplete=new Promise(l=>{this.onProcessReady(()=>l())}),o.onData(l=>{this._unacknowledgedCharCount+=l.length,!this._isPtyPaused&&this._unacknowledgedCharCount>1e5&&(this._logService.trace(`Flow control: Pause (${this._unacknowledgedCharCount} > 100000)`),this._isPtyPaused=!0,o.pause()),this._logService.trace("node-pty.IPty#onData",l),this._onProcessData.fire(l),this._closeTimeout&&this._queueProcessExit(),this._windowsShellHelper?.checkShell(),this._childProcessMonitor?.handleOutput()}),o.onExit(l=>{this._exitCode=l.exitCode,this._queueProcessExit()}),this._sendProcessId(o.pid),this._setupTitlePolling(o)}_setupTitlePolling(t){setTimeout(()=>this._sendProcessTitle(t)),D||(this._titleInterval=setInterval(()=>{this._currentTitle!==t.process&&this._sendProcessTitle(t)},200))}_queueProcessExit(){this._logService.getLevel()===1&&this._logService.trace("TerminalProcess#_queueProcessExit",new Error().stack?.replace(/^Error/,"")),this._closeTimeout&&clearTimeout(this._closeTimeout),this._closeTimeout=setTimeout(()=>{this._closeTimeout=void 0,this._kill()},250)}async _kill(){if(await this._processStartupComplete,!this._store.isDisposed){try{this._ptyProcess&&(await this._throttleKillSpawn(),this._logService.trace("node-pty.IPty#kill"),this._ptyProcess.kill())}catch{}this._onProcessExit.fire(this._exitCode||0),this.dispose()}}async _throttleKillSpawn(){if(!(!D||!("useConpty"in this._ptyOptions)||!this._ptyOptions.useConpty)){for(;Date.now()-Ue._lastKillOrStart<250;)this._logService.trace("Throttling kill/spawn call"),await pe(250-(Date.now()-Ue._lastKillOrStart)+50);Ue._lastKillOrStart=Date.now()}}_sendProcessId(t){this._onProcessReady.fire({pid:t,cwd:this._initialCwd,windowsPty:this.getWindowsPty()})}_sendProcessTitle(t){if(this._store.isDisposed)return;this._currentTitle=t.process??"",this._onDidChangeProperty.fire({type:"title",value:this._currentTitle});let r=this.currentTitle.replace(/ \(figterm\)$/g,"");if(r.toLowerCase().startsWith("python"))this._onDidChangeProperty.fire({type:"shellType",value:"python"});else if(r.toLowerCase().startsWith("julia"))this._onDidChangeProperty.fire({type:"shellType",value:"julia"});else{let i=_l.get(r)||Tl.get(r);this._onDidChangeProperty.fire({type:"shellType",value:i})}}shutdown(t){this._logService.getLevel()===1&&this._logService.trace("TerminalProcess#shutdown",new Error().stack?.replace(/^Error/,"")),t&&!D?this._kill():!this._closeTimeout&&!this._store.isDisposed&&(this._queueProcessExit(),setTimeout(()=>{this._closeTimeout&&!this._store.isDisposed&&(this._closeTimeout=void 0,this._kill())},5e3))}input(t,r=!1){this._store.isDisposed||!this._ptyProcess||(this._writeQueue.push(...rl(t).map(i=>({isBinary:r,data:i}))),this._startWrite())}async processBinary(t){this.input(t,!0)}async refreshProperty(t){switch(t){case"cwd":{let r=await this.getCwd();return r!==this._properties.cwd&&(this._properties.cwd=r,this._onDidChangeProperty.fire({type:"cwd",value:this._properties.cwd})),r}case"initialCwd":{let r=await this.getInitialCwd();return r!==this._properties.initialCwd&&(this._properties.initialCwd=r,this._onDidChangeProperty.fire({type:"initialCwd",value:this._properties.initialCwd})),r}case"title":return this.currentTitle;default:return this.shellType}}async updateProperty(t,r){t==="fixedDimensions"&&(this._properties.fixedDimensions=r)}_startWrite(){if(!(this._writeTimeout!==void 0||this._writeQueue.length===0)){if(this._doWrite(),this._writeQueue.length===0){this._writeTimeout=void 0;return}this._writeTimeout=setTimeout(()=>{this._writeTimeout=void 0,this._startWrite()},5)}}_doWrite(){let t=this._writeQueue.shift();this._logService.trace("node-pty.IPty#write",t.data),t.isBinary?this._ptyProcess.write(Buffer.from(t.data,"binary")):this._ptyProcess.write(t.data),this._childProcessMonitor?.handleInput()}resize(t,r){if(!this._store.isDisposed&&!(typeof t!="number"||typeof r!="number"||isNaN(t)||isNaN(r))&&this._ptyProcess){if(t=Math.max(t,1),r=Math.max(r,1),this._delayedResizer){this._delayedResizer.cols=t,this._delayedResizer.rows=r;return}this._logService.trace("node-pty.IPty#resize",t,r);try{this._ptyProcess.resize(t,r)}catch(i){if(this._logService.trace("node-pty.IPty#resize exception "+i.message),this._exitCode!==void 0&&i.message!=="ioctl(2) failed, EBADF"&&i.message!=="Cannot resize a pty that has already exited")throw i}}}clearBuffer(){this._ptyProcess?.clear()}acknowledgeDataEvent(t){this._unacknowledgedCharCount=Math.max(this._unacknowledgedCharCount-t,0),this._logService.trace(`Flow control: Ack ${t} chars (unacknowledged: ${this._unacknowledgedCharCount})`),this._isPtyPaused&&this._unacknowledgedCharCount<5e3&&(this._logService.trace(`Flow control: Resume (${this._unacknowledgedCharCount} < 5000)`),this._ptyProcess?.resume(),this._isPtyPaused=!1)}clearUnacknowledgedChars(){this._unacknowledgedCharCount=0,this._logService.trace("Flow control: Cleared all unacknowledged chars, forcing resume"),this._isPtyPaused&&(this._ptyProcess?.resume(),this._isPtyPaused=!1)}async setUnicodeVersion(t){}getInitialCwd(){return Promise.resolve(this._initialCwd)}async getCwd(){if(be)return new Promise(t=>{if(!this._ptyProcess){t(this._initialCwd);return}this._logService.trace("node-pty.IPty#pid"),Xd("lsof -OPln -p "+this._ptyProcess.pid+" | grep cwd",{env:{...process.env,LANG:"en_US.UTF-8"}},(r,i,s)=>{!r&&i!==""?t(i.substring(i.indexOf("/"),i.length-1)):(this._logService.error("lsof did not run successfully, it may not be on the $PATH?",r,i,s),t(this._initialCwd))})});if(Ce){if(!this._ptyProcess)return this._initialCwd;this._logService.trace("node-pty.IPty#pid");try{return await Zt.promises.readlink(`/proc/${this._ptyProcess.pid}/cwd`)}catch{return this._initialCwd}}return this._initialCwd}getWindowsPty(){return D?{backend:"useConpty"in this._ptyOptions&&this._ptyOptions.useConpty?"conpty":"winpty",buildNumber:lt()}:void 0}};Ue=b([we(7,Oe),we(8,va)],Ue);var As=class extends O{rows;cols;_timeout;_onTrigger=this._register(new y);get onTrigger(){return this._onTrigger.event}constructor(){super(),this._timeout=setTimeout(()=>{this._onTrigger.fire({rows:this.rows,cols:this.cols})},1e3),this._register(X(()=>clearTimeout(this._timeout)))}};var ci=class extends O{_pointer=0;_paused=!1;_throttled=!1;constructor(e,t,r,i){super(),this._register(e.onProcessData(s=>{if(this._paused||this._throttled)return;let o=typeof s=="string"?s:s.data;for(let l=0;l<o.length;l++)o[l]===t[this._pointer]?this._pointer++:this._reset(),this._pointer===t.length&&(i.debug(`Auto reply match: "${t}", response: "${r}"`),e.input(r),this._throttled=!0,pe(1e3).then(()=>this._throttled=!1),this._reset())}))}_reset(){this._pointer=0}handleResize(){D&&(this._paused=!0)}handleInput(){this._paused=!1}};var di=class extends O{_map=new Map;_onDidRemoveCapabilityType=this._register(new y);onDidRemoveCapabilityType=this._onDidRemoveCapabilityType.event;_onDidAddCapabilityType=this._register(new y);onDidAddCapabilityType=this._onDidAddCapabilityType.event;_onDidRemoveCapability=this._register(new y);onDidRemoveCapability=this._onDidRemoveCapability.event;_onDidAddCapability=this._register(new y);onDidAddCapability=this._onDidAddCapability.event;get items(){return this._map.keys()}add(e,t){this._map.set(e,t),this._onDidAddCapabilityType.fire(e),this._onDidAddCapability.fire({id:e,capability:t})}get(e){return this._map.get(e)}remove(e){let t=this._map.get(e);t&&(this._map.delete(e),this._onDidRemoveCapabilityType.fire(e),this._onDidAddCapability.fire({id:e,capability:t}))}has(e){return this._map.has(e)}};var wt=class extends O{constructor(t,r,i,s){super();this._xterm=t;this._logService=s;this._register(G.any(this._xterm.onCursorMove,this._xterm.onData,this._xterm.onWriteParsed)(()=>this._sync())),this._register(this._xterm.onData(o=>this._handleUserInput(o))),this._register(r(o=>this._handleCommandStart(o))),this._register(i(()=>this._handleCommandExecuted())),this._register(this.onDidStartInput(()=>this._logCombinedStringIfTrace("PromptInputModel#onDidStartInput"))),this._register(this.onDidChangeInput(()=>this._logCombinedStringIfTrace("PromptInputModel#onDidChangeInput"))),this._register(this.onDidFinishInput(()=>this._logCombinedStringIfTrace("PromptInputModel#onDidFinishInput"))),this._register(this.onDidInterrupt(()=>this._logCombinedStringIfTrace("PromptInputModel#onDidInterrupt")))}_state=0;_commandStartMarker;_commandStartX=0;_lastPromptLine;_continuationPrompt;_lastUserInput="";_value="";get value(){return this._value}get prefix(){return this._value.substring(0,this._cursorIndex)}get suffix(){return this._value.substring(this._cursorIndex,this._ghostTextIndex===-1?void 0:this._ghostTextIndex)}_cursorIndex=0;get cursorIndex(){return this._cursorIndex}_ghostTextIndex=-1;get ghostTextIndex(){return this._ghostTextIndex}_onDidStartInput=this._register(new y);onDidStartInput=this._onDidStartInput.event;_onDidChangeInput=this._register(new y);onDidChangeInput=this._onDidChangeInput.event;_onDidFinishInput=this._register(new y);onDidFinishInput=this._onDidFinishInput.event;_onDidInterrupt=this._register(new y);onDidInterrupt=this._onDidInterrupt.event;_logCombinedStringIfTrace(t){this._logService.getLevel()===1&&this._logService.trace(t,this.getCombinedString())}setContinuationPrompt(t){this._continuationPrompt=t,this._sync()}setLastPromptLine(t){this._lastPromptLine=t,this._sync()}setConfidentCommandLine(t){this._value!==t&&(this._value=t,this._cursorIndex=-1,this._ghostTextIndex=-1,this._onDidChangeInput.fire(this._createStateObject()))}getCombinedString(){let t=this._value.replaceAll(`
`,"\u23CE");if(this._cursorIndex===-1)return t;let r=`${t.substring(0,this.cursorIndex)}|`;return this.ghostTextIndex!==-1?(r+=`${t.substring(this.cursorIndex,this.ghostTextIndex)}[`,r+=`${t.substring(this.ghostTextIndex)}]`):r+=t.substring(this.cursorIndex),r}serialize(){return{modelState:this._createStateObject(),commandStartX:this._commandStartX,lastPromptLine:this._lastPromptLine,continuationPrompt:this._continuationPrompt,lastUserInput:this._lastUserInput}}deserialize(t){this._value=t.modelState.value,this._cursorIndex=t.modelState.cursorIndex,this._ghostTextIndex=t.modelState.ghostTextIndex,this._commandStartX=t.commandStartX,this._lastPromptLine=t.lastPromptLine,this._continuationPrompt=t.continuationPrompt,this._lastUserInput=t.lastUserInput}_handleCommandStart(t){this._state!==1&&(this._state=1,this._commandStartMarker=t.marker,this._commandStartX=this._xterm.buffer.active.cursorX,this._value="",this._cursorIndex=0,this._onDidStartInput.fire(this._createStateObject()),this._onDidChangeInput.fire(this._createStateObject()),this._lastPromptLine&&this._commandStartX!==this._lastPromptLine.length&&this._xterm.buffer.active.getLine(this._commandStartMarker.line)?.translateToString(!0).startsWith(this._lastPromptLine)&&(this._commandStartX=this._lastPromptLine.length,this._sync()))}_handleCommandExecuted(){if(this._state===2)return;this._cursorIndex=-1,this._ghostTextIndex!==-1&&(this._value=this._value.substring(0,this._ghostTextIndex),this._ghostTextIndex=-1);let t=this._createStateObject();this._lastUserInput===""&&(this._lastUserInput="",this._onDidInterrupt.fire(t)),this._state=2,this._onDidFinishInput.fire(t),this._onDidChangeInput.fire(t)}_sync(){try{this._doSync()}catch(t){this._logService.error("Error while syncing prompt input model",t)}}_doSync(){if(this._state!==1)return;let t=this._commandStartMarker?.line;if(t===void 0)return;let r=this._xterm.buffer.active,i=r.getLine(t),s=i?.translateToString(!0,this._commandStartX);if(!i||s===void 0){this._logService.trace("PromptInputModel#_sync: no line");return}let o=r.baseY+r.cursorY,l=s,c=-1,u;o===t?u=this._getRelativeCursorIndex(this._commandStartX,r,i):u=s.trimEnd().length,o===t&&r.cursorX>1&&(c=this._scanForGhostText(r,i,u));for(let d=t+1;d<=o;d++){i=r.getLine(d);let p=i?.translateToString(!0);if(p&&i)if(i.isWrapped){l+=p;let f=this._getRelativeCursorIndex(0,r,i);o===d?u+=f:u+=p.length}else if(this._continuationPrompt===void 0||this._lineContainsContinuationPrompt(p)){let f=this._trimContinuationPrompt(p);if(l+=`
${f}`,o===d){let m=this._getContinuationPromptCellWidth(i,p),h=this._getRelativeCursorIndex(m,r,i);u+=h+1}else u+=f.length+1}else break}for(let d=o+1;d<r.baseY+this._xterm.rows;d++){i=r.getLine(d);let p=i?.translateToString(!0);if(p&&i)if(this._continuationPrompt===void 0||this._lineContainsContinuationPrompt(p))l+=`
${this._trimContinuationPrompt(p)}`;else break;else break}this._logService.getLevel()===1&&this._logService.trace(`PromptInputModel#_sync: ${this.getCombinedString()}`);{let d=this._value.length-this._value.trimEnd().length;this._lastUserInput==="\x7F"&&(this._lastUserInput="",u===this._cursorIndex-1&&(this._value.trimEnd().length>l.trimEnd().length&&l.trimEnd().length<=u?d=Math.max(this._value.length-1-l.trimEnd().length,0):d=Math.max(d-1,0))),this._lastUserInput==="\x1B[3~"&&(this._lastUserInput="",u===this._cursorIndex&&(d=Math.max(d-1,0)));let p=l.split(`
`),f=p.length>1,m=l.trimEnd();if(!f){m.length<l.length&&(this._lastUserInput===" "&&(this._lastUserInput="",u>m.length&&u>this._cursorIndex&&d++),d=Math.max(u-m.length,d,0));let h=u===0?"":l[u-1];d>0&&u===this._cursorIndex+1&&this._lastUserInput!==""&&h!==" "&&(d=this._value.length-this._cursorIndex)}if(f){p[p.length-1]=p.at(-1)?.trimEnd()??"";let h=(p.length-1)*(this._continuationPrompt?.length??0);d=Math.max(0,u-l.length-h)}l=p.map(h=>h.trimEnd()).join(`
`)+" ".repeat(d)}(this._value!==l||this._cursorIndex!==u||this._ghostTextIndex!==c)&&(this._value=l,this._cursorIndex=u,this._ghostTextIndex=c,this._onDidChangeInput.fire(this._createStateObject()))}_handleUserInput(t){this._lastUserInput=t}_scanForGhostText(t,r,i){let s=-1,o=!1,l=t.cursorX;for(;l>0;){let c=r.getCell(--l);if(!c)break;if(c.getChars().trim().length>0){o=!this._isCellStyledLikeGhostText(c);break}}if(o){let c=0,u=t.cursorX;for(;u<r.length;){let d=r.getCell(u++);if(!d||d.getCode()===0)break;if(this._isCellStyledLikeGhostText(d)){s=i+c;break}c+=d.getChars().length}}return s}_trimContinuationPrompt(t){return this._lineContainsContinuationPrompt(t)&&(t=t.substring(this._continuationPrompt.length)),t}_lineContainsContinuationPrompt(t){return!!(this._continuationPrompt&&t.startsWith(this._continuationPrompt))}_getContinuationPromptCellWidth(t,r){if(!this._continuationPrompt||!r.startsWith(this._continuationPrompt))return 0;let i="",s=0;for(;i!==this._continuationPrompt;)i+=t.getCell(s++).getChars();return s}_getRelativeCursorIndex(t,r,i){return i?.translateToString(!0,t,r.cursorX).length??0}_isCellStyledLikeGhostText(t){return!!(t.isItalic()||t.isDim())}_createStateObject(){return Object.freeze({value:this._value,prefix:this.prefix,suffix:this.suffix,cursorIndex:this._cursorIndex,ghostTextIndex:this._ghostTextIndex})}};b([kr(0)],wt.prototype,"_sync",1),wt=b([we(3,Oe)],wt);var Ct=class extends O{constructor(t,r){super();this._terminal=t;this._logService=r;this._promptInputModel=this._register(new wt(this._terminal,this.onCommandStarted,this.onCommandExecuted,this._logService)),this._register(this.onCommandExecuted(s=>{if(s.commandLineConfidence!=="high"){let o=s;s.command=o.extractCommandLine(),s.commandLineConfidence="low","getOutput"in o?o.promptStartMarker&&o.marker&&o.executedMarker&&s.command.indexOf(`
`)===-1&&o.startX!==void 0&&o.startX>0&&(s.commandLineConfidence="medium"):o.promptStartMarker&&o.commandStartMarker&&o.commandExecutedMarker&&s.command.indexOf(`
`)===-1&&o.commandStartX!==void 0&&o.commandStartX>0&&(s.commandLineConfidence="medium")}}));let i=this;this._ptyHeuristicsHooks=new class{get onCurrentCommandInvalidatedEmitter(){return i._onCurrentCommandInvalidated}get onCommandStartedEmitter(){return i._onCommandStarted}get onCommandExecutedEmitter(){return i._onCommandExecuted}get dimensions(){return i._dimensions}get isCommandStorageDisabled(){return i.__isCommandStorageDisabled}get commandMarkers(){return i._commandMarkers}set commandMarkers(s){i._commandMarkers=s}get clearCommandsInViewport(){return i._clearCommandsInViewport.bind(i)}commitCommandFinished(){i._commitCommandFinished?.flush(),i._commitCommandFinished=void 0}},this._ptyHeuristics=this._register(new ar(new zn(this._terminal,this,this._ptyHeuristicsHooks,this._logService))),this._dimensions={cols:this._terminal.cols,rows:this._terminal.rows},this._register(this._terminal.onResize(s=>this._handleResize(s))),this._register(this._terminal.onCursorMove(()=>this._handleCursorMove()))}type=2;_promptInputModel;get promptInputModel(){return this._promptInputModel}_commands=[];_cwd;_promptTerminator;_currentCommand=new Vn(this._terminal);_commandMarkers=[];_dimensions;__isCommandStorageDisabled=!1;_handleCommandStartOptions;_commitCommandFinished;_ptyHeuristicsHooks;_ptyHeuristics;get commands(){return this._commands}get executingCommand(){return this._currentCommand.command}get executingCommandObject(){if(this._currentCommand.commandStartMarker)return{marker:this._currentCommand.commandStartMarker}}get currentCommand(){return this._currentCommand}get cwd(){return this._cwd}get promptTerminator(){return this._promptTerminator}_onCommandStarted=this._register(new y);onCommandStarted=this._onCommandStarted.event;_onBeforeCommandFinished=this._register(new y);onBeforeCommandFinished=this._onBeforeCommandFinished.event;_onCommandFinished=this._register(new y);onCommandFinished=this._onCommandFinished.event;_onCommandExecuted=this._register(new y);onCommandExecuted=this._onCommandExecuted.event;_onCommandInvalidated=this._register(new y);onCommandInvalidated=this._onCommandInvalidated.event;_onCurrentCommandInvalidated=this._register(new y);onCurrentCommandInvalidated=this._onCurrentCommandInvalidated.event;_handleResize(t){this._ptyHeuristics.value.preHandleResize?.(t),this._dimensions.cols=t.cols,this._dimensions.rows=t.rows}_handleCursorMove(){this._store.isDisposed||this._terminal.buffer.active===this._terminal.buffer.normal&&this._currentCommand.commandStartMarker&&this._terminal.buffer.active.baseY+this._terminal.buffer.active.cursorY<this._currentCommand.commandStartMarker.line&&(this._clearCommandsInViewport(),this._currentCommand.isInvalid=!0,this._onCurrentCommandInvalidated.fire({reason:"windows"}))}_clearCommandsInViewport(){let t=0;for(let r=this._commands.length-1;r>=0;r--){let i=this._commands[r].marker?.line;if(i&&i<this._terminal.buffer.active.baseY)break;t++}t>0&&this._onCommandInvalidated.fire(this._commands.splice(this._commands.length-t,t))}setContinuationPrompt(t){this._promptInputModel.setContinuationPrompt(t)}setPromptTerminator(t,r){this._logService.debug("CommandDetectionCapability#setPromptTerminator",t),this._promptTerminator=t,this._promptInputModel.setLastPromptLine(r)}setCwd(t){this._cwd=t}setIsWindowsPty(t){if(t&&!(this._ptyHeuristics.value instanceof St)){let r=this;this._ptyHeuristics.value=new St(this._terminal,this,new class{get onCurrentCommandInvalidatedEmitter(){return r._onCurrentCommandInvalidated}get onCommandStartedEmitter(){return r._onCommandStarted}get onCommandExecutedEmitter(){return r._onCommandExecuted}get dimensions(){return r._dimensions}get isCommandStorageDisabled(){return r.__isCommandStorageDisabled}get commandMarkers(){return r._commandMarkers}set commandMarkers(i){r._commandMarkers=i}get clearCommandsInViewport(){return r._clearCommandsInViewport.bind(r)}commitCommandFinished(){r._commitCommandFinished?.flush(),r._commitCommandFinished=void 0}},this._logService)}else!t&&!(this._ptyHeuristics.value instanceof zn)&&(this._ptyHeuristics.value=new zn(this._terminal,this,this._ptyHeuristicsHooks,this._logService))}setIsCommandStorageDisabled(){this.__isCommandStorageDisabled=!0}getCommandForLine(t){if(this._currentCommand.promptStartMarker&&t>=this._currentCommand.promptStartMarker?.line)return this._currentCommand;if(this._commands.length!==0&&!((this._commands[0].promptStartMarker??this._commands[0].marker).line>t)){for(let r=this.commands.length-1;r>=0;r--)if((this.commands[r].promptStartMarker??this.commands[r].marker).line<=t)return this.commands[r]}}getCwdForLine(t){if(this._currentCommand.promptStartMarker&&t>=this._currentCommand.promptStartMarker?.line)return this._cwd;let r=this.getCommandForLine(t);if(r&&"cwd"in r)return r.cwd}handlePromptStart(t){let r=this.commands.at(-1);r?.endMarker&&r?.executedMarker&&r.endMarker.line===r.executedMarker.line&&(this._logService.debug("CommandDetectionCapability#handlePromptStart adjusted commandFinished",`${r.endMarker.line} -> ${r.executedMarker.line+1}`),r.endMarker=$n(this._terminal,r.executedMarker,1)),this._currentCommand.promptStartMarker=t?.marker||(r?.endMarker?$n(this._terminal,r.endMarker):this._terminal.registerMarker(0)),this._logService.debug("CommandDetectionCapability#handlePromptStart",this._terminal.buffer.active.cursorX,this._currentCommand.promptStartMarker?.line)}handleContinuationStart(){this._currentCommand.currentContinuationMarker=this._terminal.registerMarker(0),this._logService.debug("CommandDetectionCapability#handleContinuationStart",this._currentCommand.currentContinuationMarker)}handleContinuationEnd(){if(!this._currentCommand.currentContinuationMarker){this._logService.warn("CommandDetectionCapability#handleContinuationEnd Received continuation end without start");return}this._currentCommand.continuations||(this._currentCommand.continuations=[]),this._currentCommand.continuations.push({marker:this._currentCommand.currentContinuationMarker,end:this._terminal.buffer.active.cursorX}),this._currentCommand.currentContinuationMarker=void 0,this._logService.debug("CommandDetectionCapability#handleContinuationEnd",this._currentCommand.continuations[this._currentCommand.continuations.length-1])}handleRightPromptStart(){this._currentCommand.commandRightPromptStartX=this._terminal.buffer.active.cursorX,this._logService.debug("CommandDetectionCapability#handleRightPromptStart",this._currentCommand.commandRightPromptStartX)}handleRightPromptEnd(){this._currentCommand.commandRightPromptEndX=this._terminal.buffer.active.cursorX,this._logService.debug("CommandDetectionCapability#handleRightPromptEnd",this._currentCommand.commandRightPromptEndX)}handleCommandStart(t){if(this._handleCommandStartOptions=t,this._currentCommand.cwd=this._cwd,this._currentCommand.commandStartMarker=t?.marker||this._currentCommand.commandStartMarker,this._currentCommand.commandStartMarker?.line===this._terminal.buffer.active.cursorY){this._currentCommand.commandStartX=this._terminal.buffer.active.cursorX,this._logService.debug("CommandDetectionCapability#handleCommandStart",this._currentCommand.commandStartX,this._currentCommand.commandStartMarker?.line);return}this._ptyHeuristics.value.handleCommandStart(t)}handleGenericCommand(t){t?.markProperties?.disableCommandStorage&&this.setIsCommandStorageDisabled(),this.handlePromptStart(t),this.handleCommandStart(t),this.handleCommandExecuted(t),this.handleCommandFinished(void 0,t)}handleCommandExecuted(t){this._ptyHeuristics.value.handleCommandExecuted(t),this._currentCommand.markExecutedTime()}handleCommandFinished(t,r){if(this._currentCommand.markFinishedTime(),this._ptyHeuristics.value.preHandleCommandFinished?.(),this._logService.debug("CommandDetectionCapability#handleCommandFinished",this._terminal.buffer.active.cursorX,r?.marker?.line,this._currentCommand.command,this._currentCommand),t===void 0){let s=this.commands.length>0?this.commands[this.commands.length-1]:void 0;this._currentCommand.command&&this._currentCommand.command.length>0&&s?.command===this._currentCommand.command&&(t=s.exitCode)}if(this._currentCommand.commandStartMarker===void 0||!this._terminal.buffer.active)return;this._currentCommand.commandFinishedMarker=r?.marker||this._terminal.registerMarker(0),this._ptyHeuristics.value.postHandleCommandFinished?.();let i=this._currentCommand.promoteToFullCommand(this._cwd,t,this._handleCommandStartOptions?.ignoreCommandLine??!1,r?.markProperties);i&&(this._commands.push(i),this._commitCommandFinished=new xn(()=>{this._onBeforeCommandFinished.fire(i),this._currentCommand.isInvalid||(this._logService.debug("CommandDetectionCapability#onCommandFinished",i),this._onCommandFinished.fire(i))},50),this._commitCommandFinished.schedule()),this._currentCommand=new Vn(this._terminal),this._handleCommandStartOptions=void 0}setCommandLine(t,r){this._logService.debug("CommandDetectionCapability#setCommandLine",t,r),this._currentCommand.command=t,this._currentCommand.commandLineConfidence="high",this._currentCommand.isTrusted=r,r&&this._promptInputModel.setConfidentCommandLine(t)}serialize(){let t=this.commands.map(i=>i.serialize(this.__isCommandStorageDisabled)),r=this._currentCommand.serialize(this._cwd);return r&&t.push(r),{isWindowsPty:this._ptyHeuristics.value instanceof St,commands:t,promptInputModel:this._promptInputModel.serialize()}}deserialize(t){t.isWindowsPty&&this.setIsWindowsPty(t.isWindowsPty);let r=this._terminal.buffer.normal;for(let i of t.commands){if(!i.endLine){let o=i.startLine!==void 0?this._terminal.registerMarker(i.startLine-(r.baseY+r.cursorY)):void 0;if(!o)continue;this._currentCommand.commandStartMarker=i.startLine!==void 0?this._terminal.registerMarker(i.startLine-(r.baseY+r.cursorY)):void 0,this._currentCommand.commandStartX=i.startX,this._currentCommand.promptStartMarker=i.promptStartLine!==void 0?this._terminal.registerMarker(i.promptStartLine-(r.baseY+r.cursorY)):void 0,this._cwd=i.cwd,this._onCommandStarted.fire({marker:o});continue}let s=Wn.deserialize(this._terminal,i,this.__isCommandStorageDisabled);s&&(this._commands.push(s),this._logService.debug("CommandDetectionCapability#onCommandFinished",s),this._onCommandFinished.fire(s))}t.promptInputModel&&this._promptInputModel.deserialize(t.promptInputModel)}};b([qt(500)],Ct.prototype,"_handleCursorMove",1),Ct=b([we(1,Oe)],Ct);var zn=class extends O{constructor(t,r,i,s){super();this._terminal=t;this._capability=r;this._hooks=i;this._logService=s;this._register(t.parser.registerCsiHandler({final:"J"},o=>(o.length>=1&&(o[0]===2||o[0]===3)&&i.clearCommandsInViewport(),!1)))}handleCommandStart(t){this._hooks.commitCommandFinished();let r=this._capability.currentCommand;r.commandStartX=this._terminal.buffer.active.cursorX,r.commandStartMarker=t?.marker||this._terminal.registerMarker(0),r.commandExecutedMarker?.dispose(),r.commandExecutedMarker=void 0,r.commandExecutedX=void 0;for(let i of this._hooks.commandMarkers)i.dispose();this._hooks.commandMarkers.length=0,this._hooks.onCommandStartedEmitter.fire({marker:t?.marker||r.commandStartMarker,markProperties:t?.markProperties}),this._logService.debug("CommandDetectionCapability#handleCommandStart",r.commandStartX,r.commandStartMarker?.line)}handleCommandExecuted(t){let r=this._capability.currentCommand;if(r.commandExecutedMarker=t?.marker||this._terminal.registerMarker(0),r.commandExecutedX=this._terminal.buffer.active.cursorX,this._logService.debug("CommandDetectionCapability#handleCommandExecuted",r.commandExecutedX,r.commandExecutedMarker?.line),!r.commandStartMarker||!r.commandExecutedMarker||r.commandStartX===void 0)return;r.command=this._hooks.isCommandStorageDisabled?"":this._terminal.buffer.active.getLine(r.commandStartMarker.line)?.translateToString(!0,r.commandStartX,r.commandRightPromptStartX).trim();let i=r.commandStartMarker.line+1,s=r.commandExecutedMarker.line;for(;i<s;i++){let o=this._terminal.buffer.active.getLine(i);if(o){let l=r.continuations?.find(u=>u.marker.line===i);l&&(r.command+=`
`);let c=l?.end??0;r.command+=o.translateToString(!0,c)}}i===s&&(r.command+=this._terminal.buffer.active.getLine(s)?.translateToString(!0,void 0,r.commandExecutedX)||""),this._hooks.onCommandExecutedEmitter.fire(r)}};var St=class extends O{constructor(t,r,i,s){super();this._terminal=t;this._capability=r;this._hooks=i;this._logService=s;this._register(t.parser.registerCsiHandler({final:"J"},o=>(o.length>=1&&(o[0]===2||o[0]===3)&&this._hooks.clearCommandsInViewport(),!1))),this._register(this._capability.onBeforeCommandFinished(o=>{(o.command.trim().toLowerCase()==="clear"||o.command.trim().toLowerCase()==="cls")&&(this._tryAdjustCommandStartMarkerScheduler?.cancel(),this._tryAdjustCommandStartMarkerScheduler=void 0,this._hooks.clearCommandsInViewport(),this._capability.currentCommand.isInvalid=!0,this._hooks.onCurrentCommandInvalidatedEmitter.fire({reason:"windows"}))}))}_onCursorMoveListener=this._register(new Mt);_tryAdjustCommandStartMarkerScheduler;_tryAdjustCommandStartMarkerScannedLineCount=0;_tryAdjustCommandStartMarkerPollCount=0;preHandleResize(t){let r=this._terminal.buffer.active.baseY,i=t.rows-this._hooks.dimensions.rows;i>0&&this._waitForCursorMove().then(()=>{let s=Math.min(i,r);for(let o=this._capability.commands.length-1;o>=0;o--){let l=this._capability.commands[o];if(!l.marker||l.marker.line<r||l.commandStartLineContent===void 0)break;let c=this._terminal.buffer.active.getLine(l.marker.line);if(!c||c.translateToString(!0)===l.commandStartLineContent)continue;let u=l.marker.line-s;this._terminal.buffer.active.getLine(u)?.translateToString(!0)===l.commandStartLineContent&&this._terminal._core._bufferService.buffer.lines.onDeleteEmitter.fire({index:this._terminal.buffer.active.baseY,amount:s})}})}handleCommandStart(){this._capability.currentCommand.commandStartX=this._terminal.buffer.active.cursorX,this._hooks.commandMarkers.length=0;let t=this._capability.currentCommand.commandStartMarker=this._capability.currentCommand.promptStartMarker?$n(this._terminal,this._capability.currentCommand.promptStartMarker):this._terminal.registerMarker(0);this._capability.currentCommand.commandStartX=0,this._tryAdjustCommandStartMarkerScannedLineCount=0,this._tryAdjustCommandStartMarkerPollCount=0,this._tryAdjustCommandStartMarkerScheduler=new xn(()=>this._tryAdjustCommandStartMarker(t),20),this._tryAdjustCommandStartMarkerScheduler.schedule()}_tryAdjustCommandStartMarker(t){if(this._store.isDisposed)return;let r=this._terminal.buffer.active,i=this._tryAdjustCommandStartMarkerScannedLineCount;for(;i<10&&t.line+i<r.baseY+this._terminal.rows;){if(this._cursorOnNextLine()){let s=this._getWindowsPrompt(t.line+i);if(s){let o=typeof s=="string"?s:s.prompt;if(this._capability.currentCommand.commandStartMarker=this._terminal.registerMarker(0),typeof s=="object"&&s.likelySingleLine){this._logService.debug("CommandDetectionCapability#_tryAdjustCommandStartMarker adjusted promptStart",`${this._capability.currentCommand.promptStartMarker?.line} -> ${this._capability.currentCommand.commandStartMarker.line}`),this._capability.currentCommand.promptStartMarker?.dispose(),this._capability.currentCommand.promptStartMarker=$n(this._terminal,this._capability.currentCommand.commandStartMarker);let l=this._capability.commands.at(-1);l&&this._capability.currentCommand.commandStartMarker.line!==l.endMarker?.line&&(l.endMarker?.dispose(),l.endMarker=$n(this._terminal,this._capability.currentCommand.commandStartMarker))}this._capability.currentCommand.commandStartX=o.length,this._logService.debug("CommandDetectionCapability#_tryAdjustCommandStartMarker adjusted commandStart",`${t.line} -> ${this._capability.currentCommand.commandStartMarker.line}:${this._capability.currentCommand.commandStartX}`),this._flushPendingHandleCommandStartTask();return}}i++}i<10?(this._tryAdjustCommandStartMarkerScannedLineCount=i,++this._tryAdjustCommandStartMarkerPollCount<10?this._tryAdjustCommandStartMarkerScheduler?.schedule():this._flushPendingHandleCommandStartTask()):this._flushPendingHandleCommandStartTask()}_flushPendingHandleCommandStartTask(){if(this._tryAdjustCommandStartMarkerScheduler&&(this._tryAdjustCommandStartMarkerPollCount=10,this._tryAdjustCommandStartMarkerScheduler.flush(),this._tryAdjustCommandStartMarkerScheduler=void 0),this._hooks.commitCommandFinished(),this._capability.currentCommand.commandExecutedMarker||(this._onCursorMoveListener.value=this._terminal.onCursorMove(()=>{if(this._hooks.commandMarkers.length===0||this._hooks.commandMarkers[this._hooks.commandMarkers.length-1].line!==this._terminal.buffer.active.cursorY){let t=this._terminal.registerMarker(0);t&&this._hooks.commandMarkers.push(t)}})),this._capability.currentCommand.commandStartMarker){let t=this._terminal.buffer.active.getLine(this._capability.currentCommand.commandStartMarker.line);t&&(this._capability.currentCommand.commandStartLineContent=t.translateToString(!0))}this._hooks.onCommandStartedEmitter.fire({marker:this._capability.currentCommand.commandStartMarker}),this._logService.debug("CommandDetectionCapability#_handleCommandStartWindows",this._capability.currentCommand.commandStartX,this._capability.currentCommand.commandStartMarker?.line)}handleCommandExecuted(t){this._tryAdjustCommandStartMarkerScheduler&&this._flushPendingHandleCommandStartTask(),this._onCursorMoveListener.clear(),this._evaluateCommandMarkers(),this._capability.currentCommand.commandExecutedX=this._terminal.buffer.active.cursorX,this._hooks.onCommandExecutedEmitter.fire(this._capability.currentCommand),this._logService.debug("CommandDetectionCapability#handleCommandExecuted",this._capability.currentCommand.commandExecutedX,this._capability.currentCommand.commandExecutedMarker?.line)}preHandleCommandFinished(){this._capability.currentCommand.commandExecutedMarker||(this._hooks.commandMarkers.length===0&&(this._capability.currentCommand.commandStartMarker||(this._capability.currentCommand.commandStartMarker=this._terminal.registerMarker(0)),this._capability.currentCommand.commandStartMarker&&this._hooks.commandMarkers.push(this._capability.currentCommand.commandStartMarker)),this._evaluateCommandMarkers())}postHandleCommandFinished(){let t=this._capability.currentCommand,r=t.command,i=t.commandStartMarker?.line,s=t.commandExecutedMarker?.line;if(!r||r.length===0||i===void 0||i===-1||s===void 0||s===-1)return;let o=0,l=!1;for(let c=i;c<=s;c++){let u=this._terminal.buffer.active.getLine(c);if(!u)break;let d=u.translateToString(!0);for(let p=0;p<d.length;p++){for(;r.length<o&&r[o]===" ";)o++;if(d[p]===r[o]&&o++,o===r.length){let f=p>=this._terminal.cols-1;t.commandExecutedMarker=this._terminal.registerMarker(c-(this._terminal.buffer.active.baseY+this._terminal.buffer.active.cursorY)+(f?1:0)),t.commandExecutedX=f?0:p+1,l=!0;break}}if(l)break}}_evaluateCommandMarkers(){if(this._hooks.commandMarkers.length!==0){if(this._hooks.commandMarkers=this._hooks.commandMarkers.sort((t,r)=>t.line-r.line),this._capability.currentCommand.commandStartMarker=this._hooks.commandMarkers[0],this._capability.currentCommand.commandStartMarker){let t=this._terminal.buffer.active.getLine(this._capability.currentCommand.commandStartMarker.line);t&&(this._capability.currentCommand.commandStartLineContent=t.translateToString(!0))}this._capability.currentCommand.commandExecutedMarker=this._hooks.commandMarkers[this._hooks.commandMarkers.length-1],this._hooks.onCommandExecutedEmitter.fire(this._capability.currentCommand)}}_cursorOnNextLine(){let t=this._capability.commands.at(-1);if(!t)return!0;let r=this._terminal.buffer.active.baseY+this._terminal.buffer.active.cursorY,i=(t.endMarker?t.endMarker.line:t.marker?.line)??-1;return r>i}_waitForCursorMove(){let t=this._terminal.buffer.active.cursorX,r=this._terminal.buffer.active.cursorY,i=0;return new Promise((s,o)=>{let l=setInterval(()=>{if(t!==this._terminal.buffer.active.cursorX||r!==this._terminal.buffer.active.cursorY){s(),clearInterval(l);return}i+=10,i>1e3&&(clearInterval(l),s())},10)})}_getWindowsPrompt(t=this._terminal.buffer.active.baseY+this._terminal.buffer.active.cursorY){let r=this._terminal.buffer.active.getLine(t);if(!r)return;let i=r.translateToString(!0);if(!i)return;let s=i.match(/(?<prompt>(\(.+\)\s)?(?:PS.+>\s?))/)?.groups?.prompt;if(s){let d=this._adjustPrompt(s,i,">");if(d)return{prompt:d,likelySingleLine:!0}}let o=i.match(/.*\u276f(?=[^\u276f]*$)/g)?.[0];if(o){let d=this._adjustPrompt(o,i,"\u276F");if(d)return d}let l=i.match(/^(?<prompt>\$)/)?.groups?.prompt;if(l){let d=this._adjustPrompt(l,i,"$");if(d)return d}let c=i.match(/^(?<prompt>>>> )/g)?.groups?.prompt;if(c)return{prompt:c,likelySingleLine:!0};if(this._capability.promptTerminator&&i.trim().endsWith(this._capability.promptTerminator)){let d=this._adjustPrompt(i,i,this._capability.promptTerminator);if(d)return d}let u=i.match(/^(?<prompt>(\(.+\)\s)?(?:[A-Z]:\\.*>))/);return u?.groups?.prompt?{prompt:u.groups.prompt,likelySingleLine:!0}:void 0}_adjustPrompt(t,r,i){if(t)return r===t&&t.endsWith(i)&&(t+=" "),t}};St=b([we(3,Oe)],St);function $n(n,e,t=0){return n.registerMarker(e.line-(n.buffer.active.baseY+n.buffer.active.cursorY)+t)}var fi=class extends O{type=0;_cwd="";_cwds=new Map;get cwds(){return Array.from(this._cwds.keys())}_onDidChangeCwd=this._register(new y);onDidChangeCwd=this._onDidChangeCwd.event;getCwd(){return this._cwd}updateCwd(e){let t=this._cwd!==e;this._cwd=e;let r=this._cwds.get(this._cwd)||0;this._cwds.delete(this._cwd),this._cwds.set(this._cwd,r+1),t&&this._onDidChangeCwd.fire(e)}};var mi=class extends ue{constructor(t){super();this._terminal=t;this.add(this._terminal.onData(r=>this._onData(r))),this.add(this._terminal.parser.registerCsiHandler({final:"J"},r=>(r.length>=1&&(r[0]===2||r[0]===3)&&this._clearCommandsInViewport(),!1)))}type=3;_commands=[];get commands(){return this._commands}_onCommandFinished=this.add(new y);onCommandFinished=this._onCommandFinished.event;_onData(t){t==="\r"&&this._onEnter()}_onEnter(){if(this._terminal&&this._terminal.buffer.active.cursorX>=2){let t=this._terminal.registerMarker(0);t&&(this._commands.push(t),this._onCommandFinished.fire(t))}}_clearCommandsInViewport(){let t=0;for(let r=this._commands.length-1;r>=0&&!(this._commands[r].line<this._terminal.buffer.active.baseY);r--)t++;this._commands.splice(this._commands.length-t,t)}};var y7=Y("telemetryService"),v7=Y("customEndpointTelemetryService");var hi=class extends O{constructor(t){super();this._terminal=t}type=4;_idToMarkerMap=new Map;_anonymousMarkers=new Map;_onMarkAdded=this._register(new y);onMarkAdded=this._onMarkAdded.event;*markers(){for(let t of this._idToMarkerMap.values())yield t;for(let t of this._anonymousMarkers.values())yield t}addMark(t){let r=t?.marker||this._terminal.registerMarker(),i=t?.id;r&&(i?(this._idToMarkerMap.set(i,r),r.onDispose(()=>this._idToMarkerMap.delete(i))):(this._anonymousMarkers.set(r.id,r),r.onDispose(()=>this._anonymousMarkers.delete(r.id))),this._onMarkAdded.fire({marker:r,id:i,hidden:t?.hidden,hoverMessage:t?.hoverMessage}))}getMark(t){return this._idToMarkerMap.get(t)}};var gi=class extends O{constructor(t,r,i,s){super();this._nonce=t;this._disableTelemetry=r;this._telemetryService=i;this._logService=s;this._register(X(()=>{this._clearActivationTimeout(),this._disposeCommonProtocol()}))}_terminal;capabilities=this._register(new di);_hasUpdatedTelemetry=!1;_activationTimeout;_commonProtocolDisposables=[];_status=0;get status(){return this._status}_onDidChangeStatus=new y;onDidChangeStatus=this._onDidChangeStatus.event;_disposeCommonProtocol(){Se(this._commonProtocolDisposables),this._commonProtocolDisposables.length=0}activate(t){this._terminal=t,this.capabilities.add(3,this._register(new mi(this._terminal))),this._register(t.parser.registerOscHandler(633,r=>this._handleVSCodeSequence(r))),this._register(t.parser.registerOscHandler(1337,r=>this._doHandleITermSequence(r))),this._commonProtocolDisposables.push(t.parser.registerOscHandler(133,r=>this._handleFinalTermSequence(r))),this._register(t.parser.registerOscHandler(7,r=>this._doHandleSetCwd(r))),this._register(t.parser.registerOscHandler(9,r=>this._doHandleSetWindowsFriendlyCwd(r))),this._ensureCapabilitiesOrAddFailureTelemetry()}getMarkerId(t,r){this._createOrGetBufferMarkDetection(t).getMark(r)}_handleFinalTermSequence(t){let r=this._doHandleFinalTermSequence(t);return this._status===0&&(this._status=1,this._onDidChangeStatus.fire(this._status)),r}_doHandleFinalTermSequence(t){if(!this._terminal)return!1;let[r,...i]=t.split(";");switch(r){case"A":return this._createOrGetCommandDetection(this._terminal).handlePromptStart(),!0;case"B":return this._createOrGetCommandDetection(this._terminal).handleCommandStart({ignoreCommandLine:!0}),!0;case"C":return this._createOrGetCommandDetection(this._terminal).handleCommandExecuted(),!0;case"D":{let s=i.length===1?parseInt(i[0]):void 0;return this._createOrGetCommandDetection(this._terminal).handleCommandFinished(s),!0}}return!1}_handleVSCodeSequence(t){let r=this._doHandleVSCodeSequence(t);return!this._hasUpdatedTelemetry&&r&&(this._telemetryService?.publicLog2("terminal/shellIntegrationActivationSucceeded"),this._hasUpdatedTelemetry=!0,this._clearActivationTimeout()),this._status!==2&&(this._status=2,this._onDidChangeStatus.fire(this._status)),r}async _ensureCapabilitiesOrAddFailureTelemetry(){!this._telemetryService||this._disableTelemetry||(this._activationTimeout=setTimeout(()=>{!this.capabilities.get(2)&&!this.capabilities.get(0)&&(this._telemetryService?.publicLog2("terminal/shellIntegrationActivationTimeout"),this._logService.warn("Shell integration failed to add capabilities within 10 seconds")),this._hasUpdatedTelemetry=!0},1e4))}_clearActivationTimeout(){this._activationTimeout!==void 0&&(clearTimeout(this._activationTimeout),this._activationTimeout=void 0)}_doHandleVSCodeSequence(t){if(!this._terminal)return!1;let r=t.indexOf(";"),i=r===-1?t:t.substring(0,r),s=r===-1?[]:t.substring(r+1).split(";");switch(i){case"A":return this._createOrGetCommandDetection(this._terminal).handlePromptStart(),!0;case"B":return this._createOrGetCommandDetection(this._terminal).handleCommandStart(),!0;case"C":return this._createOrGetCommandDetection(this._terminal).handleCommandExecuted(),!0;case"D":{let o=s[0],l=o!==void 0?parseInt(o):void 0;return this._createOrGetCommandDetection(this._terminal).handleCommandFinished(l),!0}case"E":{let o=s[0],l=s[1],c;return o!==void 0?c=El(o):c="",this._createOrGetCommandDetection(this._terminal).setCommandLine(c,l===this._nonce),!0}case"F":return this._createOrGetCommandDetection(this._terminal).handleContinuationStart(),!0;case"G":return this._createOrGetCommandDetection(this._terminal).handleContinuationEnd(),!0;case"H":return this._createOrGetCommandDetection(this._terminal).handleRightPromptStart(),!0;case"I":return this._createOrGetCommandDetection(this._terminal).handleRightPromptEnd(),!0;case"P":{let o=s[0],l=o!==void 0?El(o):"",{key:c,value:u}=wl(l);if(u===void 0)return!0;switch(c){case"ContinuationPrompt":return this._updateContinuationPrompt($o(u)),!0;case"Cwd":return this._updateCwd(u),!0;case"IsWindows":return this._createOrGetCommandDetection(this._terminal).setIsWindowsPty(u==="True"),!0;case"Prompt":{let d=u.replace(/\x1b\[[0-9;]*m/g,"");return this._updatePromptTerminator(d),!0}case"Task":return this._createOrGetBufferMarkDetection(this._terminal),this.capabilities.get(2)?.setIsCommandStorageDisabled(),!0}}case"SetMark":return this._createOrGetBufferMarkDetection(this._terminal).addMark(Jd(s)),!0}return!1}_updateContinuationPrompt(t){this._terminal&&this._createOrGetCommandDetection(this._terminal).setContinuationPrompt(t)}_updatePromptTerminator(t){if(!this._terminal)return;let r=t.substring(t.lastIndexOf(`
`)+1),i=r.substring(r.lastIndexOf(" "));i&&this._createOrGetCommandDetection(this._terminal).setPromptTerminator(i,r)}_updateCwd(t){t=dl(t),this._createOrGetCwdDetection().updateCwd(t),this.capabilities.get(2)?.setCwd(t)}_doHandleITermSequence(t){if(!this._terminal)return!1;let[r]=t.split(";");switch(r){case"SetMark":this._createOrGetBufferMarkDetection(this._terminal).addMark();default:{let{key:i,value:s}=wl(r);if(s===void 0)return!0;switch(i){case"CurrentDir":return this._updateCwd(s),!0}}}return!1}_doHandleSetWindowsFriendlyCwd(t){if(!this._terminal)return!1;let[r,...i]=t.split(";");switch(r){case"9":return i.length&&this._updateCwd(i[0]),!0}return!1}_doHandleSetCwd(t){if(!this._terminal)return!1;let[r]=t.split(";");if(r.match(/^file:\/\/.*\//)){let i=R.parse(r);if(i.path&&i.path.length>0)return this._updateCwd(i.path),!0}return!1}serialize(){return!this._terminal||!this.capabilities.has(2)?{isWindowsPty:!1,commands:[],promptInputModel:void 0}:this._createOrGetCommandDetection(this._terminal).serialize()}deserialize(t){if(!this._terminal)throw new Error("Cannot restore commands before addon is activated");this._createOrGetCommandDetection(this._terminal).deserialize(t)}_createOrGetCwdDetection(){let t=this.capabilities.get(0);return t||(t=this._register(new fi),this.capabilities.add(0,t)),t}_createOrGetCommandDetection(t){let r=this.capabilities.get(2);return r||(r=this._register(new Ct(t,this._logService)),this.capabilities.add(2,r)),r}_createOrGetBufferMarkDetection(t){let r=this.capabilities.get(4);return r||(r=this._register(new hi(t)),this.capabilities.add(4,r)),r}};function El(n){return n.replaceAll(/\\(\\|x([0-9a-f]{2}))/gi,(e,t,r)=>r?String.fromCharCode(parseInt(r,16)):t)}function wl(n){let e=n.indexOf("=");return e===-1?{key:n,value:void 0}:{key:n.substring(0,e),value:n.substring(1+e)}}function Jd(n){let e,t=!1;for(let r of n)r!==void 0&&(r==="Hidden"&&(t=!0),r.startsWith("Id=")&&(e=r.substring(3)));return{id:e,hidden:t}}function Cl(n,e={}){let t="";return e.excludeLeadingNewLine||(t+=`\r
`),t+="\x1B[0m\x1B[7m * ",e.loudFormatting?t+="\x1B[0;104m":t+="\x1B[0m",t+=` ${n} \x1B[0m
\r`,t}import{join as ep}from"path";var Hn={exports:{}};(function(){function e(s){let o=[];typeof s=="number"&&o.push("code/timeOrigin",s);function l(u){o.push(u,Date.now())}function c(){let u=[];for(let d=0;d<o.length;d+=2)u.push({name:o[d],startTime:o[d+1]});return u}return{mark:l,getMarks:c}}function t(){if(typeof performance=="object"&&typeof performance.mark=="function"&&!performance.nodeTiming)return typeof performance.timeOrigin!="number"&&!performance.timing?e():{mark(s){performance.mark(s)},getMarks(){let s=performance.timeOrigin;typeof s!="number"&&(s=performance.timing.navigationStart||performance.timing.redirectStart||performance.timing.fetchStart);let o=[{name:"code/timeOrigin",startTime:Math.round(s)}];for(let l of performance.getEntriesByType("mark"))o.push({name:l.name,startTime:Math.round(s+l.startTime)});return o}};if(typeof process=="object"){let s=performance?.timeOrigin;return e(s)}else return console.trace("perf-util loaded in UNKNOWN environment"),e()}function r(s){return s.MonacoPerformanceMarks||(s.MonacoPerformanceMarks=t()),s.MonacoPerformanceMarks}var i;typeof global=="object"?i=global:typeof self=="object"?i=self:i={},typeof Hn=="object"&&typeof Hn.exports=="object"?Hn.exports=r(i):(console.trace("perf-util defined in UNKNOWN context (neither requirejs or commonjs)"),i.perf=r(i))})();var en=Hn.exports.mark,Sl=Hn.exports.getMarks;import tp from"@xterm/headless";var{Terminal:np}=tp;function V(n,e,t){if(typeof t.value!="function")throw new Error("not supported");let r="value",i=t.value;t[r]=async function(...s){this.traceRpcArgs.logService.getLevel()===1&&this.traceRpcArgs.logService.trace(`[RPC Request] PtyService#${i.name}(${s.map(l=>JSON.stringify(l)).join(", ")})`),this.traceRpcArgs.simulatedLatency&&await pe(this.traceRpcArgs.simulatedLatency);let o;try{o=await i.apply(this,s)}catch(l){throw this.traceRpcArgs.logService.error(`[RPC Response] PtyService#${i.name}`,l),l}return this.traceRpcArgs.logService.getLevel()===1&&this.traceRpcArgs.logService.trace(`[RPC Response] PtyService#${i.name}`,o),o}}var Ms,Fs,U=class extends O{constructor(t,r,i,s){super();this._logService=t;this._productService=r;this._reconnectConstants=i;this._simulatedLatency=s;this._register(X(()=>{for(let o of this._ptys.values())o.shutdown(!0);this._ptys.clear()})),this._detachInstanceRequestStore=this._register(new Yt(void 0,this._logService)),this._detachInstanceRequestStore.onCreateRequest(this._onDidRequestDetach.fire,this._onDidRequestDetach)}_ptys=new Map;_workspaceLayoutInfos=new Map;_detachInstanceRequestStore;_revivedPtyIdMap=new Map;_autoReplies=new Map;_lastPtyId=0;_onHeartbeat=this._register(new y);onHeartbeat=this._traceEvent("_onHeartbeat",this._onHeartbeat.event);_onProcessData=this._register(new y);onProcessData=this._traceEvent("_onProcessData",this._onProcessData.event);_onProcessReplay=this._register(new y);onProcessReplay=this._traceEvent("_onProcessReplay",this._onProcessReplay.event);_onProcessReady=this._register(new y);onProcessReady=this._traceEvent("_onProcessReady",this._onProcessReady.event);_onProcessExit=this._register(new y);onProcessExit=this._traceEvent("_onProcessExit",this._onProcessExit.event);_onProcessOrphanQuestion=this._register(new y);onProcessOrphanQuestion=this._traceEvent("_onProcessOrphanQuestion",this._onProcessOrphanQuestion.event);_onDidRequestDetach=this._register(new y);onDidRequestDetach=this._traceEvent("_onDidRequestDetach",this._onDidRequestDetach.event);_onDidChangeProperty=this._register(new y);onDidChangeProperty=this._traceEvent("_onDidChangeProperty",this._onDidChangeProperty.event);_traceEvent(t,r){return r(i=>{this._logService.getLevel()===1&&this._logService.trace(`[RPC Event] PtyService#${t}.fire(${JSON.stringify(i)})`)}),r}get traceRpcArgs(){return{logService:this._logService,simulatedLatency:this._simulatedLatency}}async refreshIgnoreProcessNames(t){ui.length=0,ui.push(...t)}async requestDetachInstance(t,r){return this._detachInstanceRequestStore.createRequest({workspaceId:t,instanceId:r})}async acceptDetachInstanceReply(t,r){let i,s=this._ptys.get(r);s&&(i=await this._buildProcessDetails(r,s)),this._detachInstanceRequestStore.acceptReply(t,i)}async freePortKillProcess(t){let i=(await new Promise((s,o)=>{Zd(D?`netstat -ano | findstr "${t}"`:`lsof -nP -iTCP -sTCP:LISTEN | grep ${t}`,{},(l,c)=>{if(l)return o("Problem occurred when listing active processes");s(c)})})).split(/\r?\n/).filter(s=>!!s.trim());if(i.length>=1){let s=/\s+(\d+)(?:\s+|$)/,o=i[0].match(s)?.[1];if(o)try{process.kill(Number.parseInt(o))}catch{}else throw new Error(`Processes for port ${t} were not found`);return{port:t,processId:o}}throw new Error(`Could not kill process with port ${t}`)}async serializeTerminalState(t){let r=[];for(let[s,o]of this._ptys.entries())o.hasWrittenData&&t.indexOf(s)!==-1&&r.push(ss.withAsyncBody(async l=>{l({id:s,shellLaunchConfig:o.shellLaunchConfig,processDetails:await this._buildProcessDetails(s,o),processLaunchConfig:o.processLaunchOptions,unicodeVersion:o.unicodeVersion,replayEvent:await o.serializeNormalBuffer(),timestamp:Date.now()})}));let i={version:1,state:await Promise.all(r)};return JSON.stringify(i)}async reviveTerminalProcesses(t,r,i){let s=[];for(let o of r)s.push(this._reviveTerminalProcess(t,o));await Promise.all(s)}async _reviveTerminalProcess(t,r){let i=v("terminal-history-restored","History restored"),s=await this.createProcess({...r.shellLaunchConfig,cwd:r.processDetails.cwd,color:r.processDetails.color,icon:r.processDetails.icon,name:r.processDetails.titleSource===0?r.processDetails.title:void 0,initialText:r.replayEvent.events[0].data+Cl(i,{loudFormatting:!0})},r.processDetails.cwd,r.replayEvent.events[0].cols,r.replayEvent.events[0].rows,r.unicodeVersion,r.processLaunchConfig.env,r.processLaunchConfig.executableEnv,r.processLaunchConfig.options,!0,r.processDetails.workspaceId,r.processDetails.workspaceName,!0,r.replayEvent.events[0].data),o=this._getRevivingProcessId(t,r.id);this._revivedPtyIdMap.set(o,{newId:s,state:r}),this._logService.info(`Revived process, old id ${o} -> new id ${s}`)}async shutdownAll(){this.dispose()}async createProcess(t,r,i,s,o,l,c,u,d,p,f,m,h){if(t.attachPersistentProcess)throw new Error("Attempt to create a process when attach object was provided");let _=++this._lastPtyId,T=new Ue(t,r,i,s,l,c,u,this._logService,this._productService),A={env:l,executableEnv:c,options:u},$=new Us(_,T,p,f,d,i,s,A,o,this._reconnectConstants,this._logService,m&&typeof t.initialText=="string"?t.initialText:void 0,h,t.icon,t.color,t.name,t.fixedDimensions);return T.onProcessExit(S=>{$.dispose(),this._ptys.delete(_),this._onProcessExit.fire({id:_,event:S})}),$.onProcessData(S=>this._onProcessData.fire({id:_,event:S})),$.onProcessReplay(S=>this._onProcessReplay.fire({id:_,event:S})),$.onProcessReady(S=>this._onProcessReady.fire({id:_,event:S})),$.onProcessOrphanQuestion(()=>this._onProcessOrphanQuestion.fire({id:_})),$.onDidChangeProperty(S=>this._onDidChangeProperty.fire({id:_,property:S})),$.onPersistentProcessReady(()=>{for(let S of this._autoReplies.entries())$.installAutoReply(S[0],S[1])}),this._ptys.set(_,$),_}async attachToProcess(t){try{await this._throwIfNoPty(t).attach(),this._logService.info(`Persistent process reconnection "${t}"`)}catch(r){throw this._logService.warn(`Persistent process reconnection "${t}" failed`,r.message),r}}async updateTitle(t,r,i){this._throwIfNoPty(t).setTitle(r,i)}async updateIcon(t,r,i,s){this._throwIfNoPty(t).setIcon(r,i,s)}async clearBuffer(t){this._throwIfNoPty(t).clearBuffer()}async refreshProperty(t,r){return this._throwIfNoPty(t).refreshProperty(r)}async updateProperty(t,r,i){return this._throwIfNoPty(t).updateProperty(r,i)}async detachFromProcess(t,r){return this._throwIfNoPty(t).detach(r)}async reduceConnectionGraceTime(){for(let t of this._ptys.values())t.reduceGraceTime()}async listProcesses(){let t=Array.from(this._ptys.entries()).filter(([s,o])=>o.shouldPersistTerminal);this._logService.info(`Listing ${t.length} persistent terminals, ${this._ptys.size} total terminals`);let r=t.map(async([s,o])=>this._buildProcessDetails(s,o));return(await Promise.all(r)).filter(s=>s.isOrphan)}async getPerformanceMarks(){return Sl()}async start(t){let r=this._ptys.get(t);return r?r.start():{message:`Could not find pty with id "${t}"`}}async shutdown(t,r){return this._ptys.get(t)?.shutdown(r)}async input(t,r){return this._throwIfNoPty(t).input(r)}async processBinary(t,r){return this._throwIfNoPty(t).writeBinary(r)}async resize(t,r,i){return this._throwIfNoPty(t).resize(r,i)}async getInitialCwd(t){return this._throwIfNoPty(t).getInitialCwd()}async getCwd(t){return this._throwIfNoPty(t).getCwd()}async acknowledgeDataEvent(t,r){return this._throwIfNoPty(t).acknowledgeDataEvent(r)}async setUnicodeVersion(t,r){return this._throwIfNoPty(t).setUnicodeVersion(r)}async getLatency(){return[]}async orphanQuestionReply(t){return this._throwIfNoPty(t).orphanQuestionReply()}async installAutoReply(t,r){this._autoReplies.set(t,r);for(let i of this._ptys.values())i.installAutoReply(t,r)}async uninstallAllAutoReplies(){for(let t of this._autoReplies.keys())for(let r of this._ptys.values())r.uninstallAutoReply(t)}async uninstallAutoReply(t){for(let r of this._ptys.values())r.uninstallAutoReply(t)}async getDefaultSystemShell(t=tr){return ul(t,process.env)}async getEnvironment(){return{...process.env}}async getWslPath(t,r){if(r==="win-to-unix"){if(!D)return t;if(lt()<17063)return t.replace(/\\/g,"/");let i=this._getWSLExecutablePath();return i?new Promise(s=>{Pl(i,["-e","wslpath",t],{},(l,c,u)=>{s(l?t:cl(c.trim()))}).stdin.end()}):t}if(r==="unix-to-win"&&D){if(lt()<17063)return t;let i=this._getWSLExecutablePath();return i?new Promise(s=>{Pl(i,["-e","wslpath","-w",t],{},(l,c,u)=>{s(l?t:c.trim())}).stdin.end()}):t}return t}_getWSLExecutablePath(){let t=lt()>=16299,r=process.env.hasOwnProperty("PROCESSOR_ARCHITEW6432"),i=process.env.SystemRoot;if(i)return ep(i,r?"Sysnative":"System32",t?"wsl.exe":"bash.exe")}async getRevivedPtyNewId(t,r){try{return this._revivedPtyIdMap.get(this._getRevivingProcessId(t,r))?.newId}catch(i){this._logService.warn(`Couldn't find terminal ID ${t}-${r}`,i.message)}}async setTerminalLayoutInfo(t){this._workspaceLayoutInfos.set(t.workspaceId,t)}async getTerminalLayoutInfo(t){en("code/willGetTerminalLayoutInfo");let r=this._workspaceLayoutInfos.get(t.workspaceId);if(r){let i=new Set,o=(await Promise.all(r.tabs.map(async l=>this._expandTerminalTab(t.workspaceId,l,i)))).filter(l=>l.terminals.length>0);return en("code/didGetTerminalLayoutInfo"),{tabs:o}}en("code/didGetTerminalLayoutInfo")}async _expandTerminalTab(t,r,i){let o=(await Promise.all(r.terminals.map(l=>this._expandTerminalInstance(t,l,i)))).filter(l=>l.terminal!==null);return{isActive:r.isActive,activePersistentProcessId:r.activePersistentProcessId,terminals:o}}async _expandTerminalInstance(t,r,i){try{let s=this._getRevivingProcessId(t,r.terminal),o=this._revivedPtyIdMap.get(s)?.newId;this._logService.info(`Expanding terminal instance, old id ${s} -> new id ${o}`),this._revivedPtyIdMap.delete(s);let l=o??r.terminal;if(i.has(l))throw new Error(`Terminal ${l} has already been expanded`);i.add(l);let c=this._throwIfNoPty(l);return{terminal:{...c&&await this._buildProcessDetails(r.terminal,c,o!==void 0),id:l},relativeSize:r.relativeSize}}catch(s){return this._logService.warn("Couldn't get layout info, a terminal was probably disconnected",s.message),this._logService.debug("Reattach to wrong terminal debug info - layout info by id",r),this._logService.debug("Reattach to wrong terminal debug info - _revivePtyIdMap",Array.from(this._revivedPtyIdMap.values())),this._logService.debug("Reattach to wrong terminal debug info - _ptys ids",Array.from(this._ptys.keys())),{terminal:null,relativeSize:r.relativeSize}}}_getRevivingProcessId(t,r){return`${t}-${r}`}async _buildProcessDetails(t,r,i=!1){en(`code/willBuildProcessDetails/${t}`);let[s,o]=await Promise.all([r.getCwd(),i?!0:r.isOrphaned()]),l={id:t,title:r.title,titleSource:r.titleSource,pid:r.pid,workspaceId:r.workspaceId,workspaceName:r.workspaceName,cwd:s,isOrphan:o,icon:r.icon,color:r.color,fixedDimensions:r.fixedDimensions,environmentVariableCollections:r.processLaunchOptions.options.environmentVariableCollections,reconnectionProperties:r.shellLaunchConfig.reconnectionProperties,waitOnExit:r.shellLaunchConfig.waitOnExit,hideFromUser:r.shellLaunchConfig.hideFromUser,isFeatureTerminal:r.shellLaunchConfig.isFeatureTerminal,type:r.shellLaunchConfig.type,hasChildProcesses:r.hasChildProcesses,shellIntegrationNonce:r.processLaunchOptions.options.shellIntegration.nonce};return en(`code/didBuildProcessDetails/${t}`),l}_throwIfNoPty(t){let r=this._ptys.get(t);if(!r)throw new Ae(`Could not find pty ${t} on pty host`);return r}};b([z],U.prototype,"traceRpcArgs",1),b([V],U.prototype,"refreshIgnoreProcessNames",1),b([V],U.prototype,"requestDetachInstance",1),b([V],U.prototype,"acceptDetachInstanceReply",1),b([V],U.prototype,"freePortKillProcess",1),b([V],U.prototype,"serializeTerminalState",1),b([V],U.prototype,"reviveTerminalProcesses",1),b([V],U.prototype,"shutdownAll",1),b([V],U.prototype,"createProcess",1),b([V],U.prototype,"attachToProcess",1),b([V],U.prototype,"updateTitle",1),b([V],U.prototype,"updateIcon",1),b([V],U.prototype,"clearBuffer",1),b([V],U.prototype,"refreshProperty",1),b([V],U.prototype,"updateProperty",1),b([V],U.prototype,"detachFromProcess",1),b([V],U.prototype,"reduceConnectionGraceTime",1),b([V],U.prototype,"listProcesses",1),b([V],U.prototype,"getPerformanceMarks",1),b([V],U.prototype,"start",1),b([V],U.prototype,"shutdown",1),b([V],U.prototype,"input",1),b([V],U.prototype,"processBinary",1),b([V],U.prototype,"resize",1),b([V],U.prototype,"getInitialCwd",1),b([V],U.prototype,"getCwd",1),b([V],U.prototype,"acknowledgeDataEvent",1),b([V],U.prototype,"setUnicodeVersion",1),b([V],U.prototype,"getLatency",1),b([V],U.prototype,"orphanQuestionReply",1),b([V],U.prototype,"installAutoReply",1),b([V],U.prototype,"uninstallAllAutoReplies",1),b([V],U.prototype,"uninstallAutoReply",1),b([V],U.prototype,"getDefaultSystemShell",1),b([V],U.prototype,"getEnvironment",1),b([V],U.prototype,"getWslPath",1),b([V],U.prototype,"getRevivedPtyNewId",1),b([V],U.prototype,"setTerminalLayoutInfo",1),b([V],U.prototype,"getTerminalLayoutInfo",1);var Us=class extends O{constructor(t,r,i,s,o,l,c,u,d,p,f,m,h,_,T,A,$){super();this._persistentProcessId=t;this._terminalProcess=r;this.workspaceId=i;this.workspaceName=s;this.shouldPersistTerminal=o;this.processLaunchOptions=u;this.unicodeVersion=d;this._logService=f;this._icon=_;this._color=T;this._interactionState=new Ns(`Persistent process "${this._persistentProcessId}" interaction state`,"None",this._logService),this._wasRevived=m!==void 0,this._serializer=new Bs(l,c,p.scrollback,d,m,u.options.shellIntegration.nonce,o?h:void 0,this._logService),A&&this.setTitle(A,0),this._fixedDimensions=$,this._orphanQuestionBarrier=null,this._orphanQuestionReplyTime=0,this._disconnectRunner1=this._register(new In(()=>{this._logService.info(`Persistent process "${this._persistentProcessId}": The reconnection grace time of ${Rl(p.graceTime)} has expired, shutting down pid "${this._pid}"`),this.shutdown(!0)},p.graceTime)),this._disconnectRunner2=this._register(new In(()=>{this._logService.info(`Persistent process "${this._persistentProcessId}": The short reconnection grace time of ${Rl(p.shortGraceTime)} has expired, shutting down pid ${this._pid}`),this.shutdown(!0)},p.shortGraceTime)),this._register(this._terminalProcess.onProcessExit(()=>this._bufferer.stopBuffering(this._persistentProcessId))),this._register(this._terminalProcess.onProcessReady(S=>{this._pid=S.pid,this._cwd=S.cwd,this._onProcessReady.fire(S)})),this._register(this._terminalProcess.onDidChangeProperty(S=>{this._onDidChangeProperty.fire(S)})),this._bufferer=new ri((S,g)=>this._onProcessData.fire(g)),this._register(this._bufferer.startBuffering(this._persistentProcessId,this._terminalProcess.onProcessData)),this._register(this.onProcessData(S=>this._serializer.handleData(S))),this._register(X(()=>{for(let S of this._autoReplies.values())S.dispose();this._autoReplies.clear()}))}_bufferer;_autoReplies=new Map;_pendingCommands=new Map;_isStarted=!1;_interactionState;_orphanQuestionBarrier;_orphanQuestionReplyTime;_orphanRequestQueue=new vn;_disconnectRunner1;_disconnectRunner2;_onProcessReplay=this._register(new y);onProcessReplay=this._onProcessReplay.event;_onProcessReady=this._register(new y);onProcessReady=this._onProcessReady.event;_onPersistentProcessReady=this._register(new y);onPersistentProcessReady=this._onPersistentProcessReady.event;_onProcessData=this._register(new y);onProcessData=this._onProcessData.event;_onProcessOrphanQuestion=this._register(new y);onProcessOrphanQuestion=this._onProcessOrphanQuestion.event;_onDidChangeProperty=this._register(new y);onDidChangeProperty=this._onDidChangeProperty.event;_inReplay=!1;_pid=-1;_cwd="";_title;_titleSource=1;_serializer;_wasRevived;_fixedDimensions;get pid(){return this._pid}get shellLaunchConfig(){return this._terminalProcess.shellLaunchConfig}get hasWrittenData(){return this._interactionState.value!=="None"}get title(){return this._title||this._terminalProcess.currentTitle}get titleSource(){return this._titleSource}get icon(){return this._icon}get color(){return this._color}get fixedDimensions(){return this._fixedDimensions}get hasChildProcesses(){return this._terminalProcess.hasChildProcesses}setTitle(t,r){r===0&&(this._interactionState.setValue("Session","setTitle"),this._serializer.freeRawReviveBuffer()),this._title=t,this._titleSource=r}setIcon(t,r,i){(!this._icon||"id"in r&&"id"in this._icon&&r.id!==this._icon.id||!this.color||i!==this._color)&&(this._serializer.freeRawReviveBuffer(),t&&this._interactionState.setValue("Session","setIcon")),this._icon=r,this._color=i}_setFixedDimensions(t){this._fixedDimensions=t}async attach(){!this._disconnectRunner1.isScheduled()&&!this._disconnectRunner2.isScheduled()&&this._logService.warn(`Persistent process "${this._persistentProcessId}": Process had no disconnect runners but was an orphan`),this._disconnectRunner1.cancel(),this._disconnectRunner2.cancel()}async detach(t){this.shouldPersistTerminal&&(this._interactionState.value!=="None"||t)?this._disconnectRunner1.schedule():this.shutdown(!0)}serializeNormalBuffer(){return this._serializer.generateReplayEvent(!0,this._interactionState.value!=="Session")}async refreshProperty(t){return this._terminalProcess.refreshProperty(t)}async updateProperty(t,r){if(t==="fixedDimensions")return this._setFixedDimensions(r)}async start(){if(!this._isStarted){let t=await this._terminalProcess.start();return t&&"message"in t||(this._isStarted=!0,this._wasRevived?this.triggerReplay():this._onPersistentProcessReady.fire()),t}this._onProcessReady.fire({pid:this._pid,cwd:this._cwd,windowsPty:this._terminalProcess.getWindowsPty()}),this._onDidChangeProperty.fire({type:"title",value:this._terminalProcess.currentTitle}),this._onDidChangeProperty.fire({type:"shellType",value:this._terminalProcess.shellType}),this.triggerReplay()}shutdown(t){return this._terminalProcess.shutdown(t)}input(t){if(this._interactionState.setValue("Session","input"),this._serializer.freeRawReviveBuffer(),!this._inReplay){for(let r of this._autoReplies.values())r.handleInput();return this._terminalProcess.input(t)}}writeBinary(t){return this._terminalProcess.processBinary(t)}resize(t,r){if(!this._inReplay){this._serializer.handleResize(t,r),this._bufferer.flushBuffer(this._persistentProcessId);for(let i of this._autoReplies.values())i.handleResize();return this._terminalProcess.resize(t,r)}}async clearBuffer(){this._serializer.clearBuffer(),this._terminalProcess.clearBuffer()}setUnicodeVersion(t){this.unicodeVersion=t,this._serializer.setUnicodeVersion?.(t)}acknowledgeDataEvent(t){if(!this._inReplay)return this._terminalProcess.acknowledgeDataEvent(t)}getInitialCwd(){return this._terminalProcess.getInitialCwd()}getCwd(){return this._terminalProcess.getCwd()}async triggerReplay(){this._interactionState.value==="None"&&this._interactionState.setValue("ReplayOnly","triggerReplay");let t=await this._serializer.generateReplayEvent(),r=0;for(let i of t.events)r+=i.data.length;this._logService.info(`Persistent process "${this._persistentProcessId}": Replaying ${r} chars and ${t.events.length} size events`),this._onProcessReplay.fire(t),this._terminalProcess.clearUnacknowledgedChars(),this._onPersistentProcessReady.fire()}installAutoReply(t,r){this._autoReplies.get(t)?.dispose(),this._autoReplies.set(t,new ci(this._terminalProcess,t,r,this._logService))}uninstallAutoReply(t){this._autoReplies.get(t)?.dispose(),this._autoReplies.delete(t)}sendCommandResult(t,r,i){this._pendingCommands.get(t)&&this._pendingCommands.delete(t)}orphanQuestionReply(){if(this._orphanQuestionReplyTime=Date.now(),this._orphanQuestionBarrier){let t=this._orphanQuestionBarrier;this._orphanQuestionBarrier=null,t.open()}}reduceGraceTime(){this._disconnectRunner2.isScheduled()||this._disconnectRunner1.isScheduled()&&this._disconnectRunner2.schedule()}async isOrphaned(){return await this._orphanRequestQueue.queue(async()=>this._isOrphaned())}async _isOrphaned(){return this._disconnectRunner1.isScheduled()||this._disconnectRunner2.isScheduled()?!0:(this._orphanQuestionBarrier||(this._orphanQuestionBarrier=new Pr(4e3),this._orphanQuestionReplyTime=0,this._onProcessOrphanQuestion.fire()),await this._orphanQuestionBarrier.wait(),Date.now()-this._orphanQuestionReplyTime>500)}},Ns=class{constructor(e,t,r){this._name=e;this._value=t;this._logService=r;this._log("initialized")}get value(){return this._value}setValue(e,t){this._value!==e&&(this._value=e,this._log(t))}_log(e){this._logService.debug(`MutationLogger "${this._name}" set to "${this._value}", reason: ${e}`)}},Bs=class{constructor(e,t,r,i,s,o,l,c){this._rawReviveBuffer=l;this._xterm=new np({cols:e,rows:t,scrollback:r,allowProposedApi:!0}),s&&this._xterm.writeln(s),this.setUnicodeVersion(i),this._shellIntegrationAddon=new gi(o,!0,void 0,c),this._xterm.loadAddon(this._shellIntegrationAddon)}_xterm;_shellIntegrationAddon;_unicodeAddon;freeRawReviveBuffer(){this._rawReviveBuffer=void 0}handleData(e){this._xterm.write(e)}handleResize(e,t){this._xterm.resize(e,t)}clearBuffer(){this._xterm.clear()}async generateReplayEvent(e,t){let r=new(await this._getSerializeConstructor());this._xterm.loadAddon(r);let i={scrollback:this._xterm.options.scrollback};e&&(i.excludeAltBuffer=!0,i.excludeModes=!0);let s;return t&&this._rawReviveBuffer?s=this._rawReviveBuffer:s=r.serialize(i),{events:[{cols:this._xterm.cols,rows:this._xterm.rows,data:s}],commands:this._shellIntegrationAddon.serialize()}}async setUnicodeVersion(e){this._xterm.unicode.activeVersion!==e&&(e==="11"?(this._unicodeAddon=new(await this._getUnicode11Constructor()),this._xterm.loadAddon(this._unicodeAddon)):(this._unicodeAddon?.dispose(),this._unicodeAddon=void 0),this._xterm.unicode.activeVersion=e)}async _getUnicode11Constructor(){return Fs||(Fs=(await import("@xterm/addon-unicode11")).Unicode11Addon),Fs}async _getSerializeConstructor(){return Ms||(Ms=(await import("@xterm/addon-serialize")).SerializeAddon),Ms}};function Rl(n){let e=0,t=0,r=0;n>=1e3&&(r=Math.floor(n/1e3),n-=r*1e3),r>=60&&(t=Math.floor(r/60),r-=t*60),t>=60&&(e=Math.floor(t/60),t-=e*60);let i=e?`${e}h`:"",s=t?`${t}m`:"",o=r?`${r}s`:"",l=n?`${n}ms`:"";return`${i}${s}${o}${l}`}rp();async function rp(){let n=parseInt(process.env.VSCODE_STARTUP_DELAY??"0"),e=parseInt(process.env.VSCODE_LATENCY??"0"),t={graceTime:parseInt(process.env.VSCODE_RECONNECT_GRACE_TIME||"0"),shortGraceTime:parseInt(process.env.VSCODE_RECONNECT_SHORT_GRACE_TIME||"0"),scrollback:parseInt(process.env.VSCODE_RECONNECT_SCROLLBACK||"100")};delete process.env.VSCODE_RECONNECT_GRACE_TIME,delete process.env.VSCODE_RECONNECT_SHORT_GRACE_TIME,delete process.env.VSCODE_RECONNECT_SCROLLBACK,delete process.env.VSCODE_LATENCY,delete process.env.VSCODE_STARTUP_DELAY,n&&await pe(n);let r=Nr(process),i;r?i=new Br:i=new Ur("ptyHost");let s={_serviceBrand:void 0,...Ja},o=new Vr(cs(process.argv,ba),s),l=new ei(Ba(o),o.logsHome);i.registerChannel("logger",new Gr(l,()=>No));let c=l.createLogger("ptyhost",{name:v("ptyHost","Pty Host")}),u=new Xr(c);n&&u.warn(`Pty Host startup is delayed ${n}ms`),e&&u.warn(`Pty host is simulating ${e}ms latency`);let d=new ue,p=new ti;i.registerChannel("heartbeat",Ar.fromService(p,d));let f=new U(u,s,t,e),m=Ar.fromService(f,d);i.registerChannel("ptyHost",m),r&&i.registerChannel("ptyHostWindow",m),process.once("exit",()=>{u.trace("Pty host exiting"),u.dispose(),p.dispose(),f.dispose()})}
