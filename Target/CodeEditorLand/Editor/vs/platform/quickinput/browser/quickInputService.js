var y=Object.defineProperty;var m=Object.getOwnPropertyDescriptor;var l=(u,n,e,t)=>{for(var i=t>1?void 0:t?m(n,e):n,r=u.length-1,o;r>=0;r--)(o=u[r])&&(i=(t?o(n,e,i):o(i))||i);return t&&i&&y(n,e,i),i},s=(u,n)=>(e,t)=>n(e,t,u);import{CancellationToken as p}from"../../../base/common/cancellation.js";import{Emitter as k}from"../../../base/common/event.js";import{IContextKeyService as S,RawContextKey as C}from"../../contextkey/common/contextkey.js";import{IInstantiationService as Q}from"../../instantiation/common/instantiation.js";import{ILayoutService as x}from"../../layout/browser/layoutService.js";import{IOpenerService as B}from"../../opener/common/opener.js";import{QuickAccessController as P}from"./quickAccess.js";import{defaultButtonStyles as _,defaultCountBadgeStyles as T,defaultInputBoxStyles as b,defaultKeybindingLabelStyles as F,defaultProgressBarStyles as w,defaultToggleStyles as K,getListStyles as O}from"../../theme/browser/defaultStyles.js";import{activeContrastBorder as I,asCssVariable as c,pickerGroupBorder as q,pickerGroupForeground as A,quickInputBackground as d,quickInputForeground as L,quickInputListFocusBackground as g,quickInputListFocusForeground as f,quickInputListFocusIconForeground as H,quickInputTitleBackground as D,widgetBorder as G,widgetShadow as W}from"../../theme/common/colorRegistry.js";import{IThemeService as M,Themable as N}from"../../theme/common/themeService.js";import{QuickInputHoverDelegate as E}from"./quickInput.js";import{QuickInputController as V}from"./quickInputController.js";import{IConfigurationService as R}from"../../configuration/common/configuration.js";import{getWindow as v}from"../../../base/browser/dom.js";let a=class extends N{constructor(e,t,i,r,o){super(i);this.instantiationService=e;this.contextKeyService=t;this.layoutService=r;this.configurationService=o}get backButton(){return this.controller.backButton}_onShow=this._register(new k);onShow=this._onShow.event;_onHide=this._register(new k);onHide=this._onHide.event;_controller;get controller(){return this._controller||(this._controller=this._register(this.createController())),this._controller}get hasController(){return!!this._controller}get currentQuickInput(){return this.controller.currentQuickInput}_quickAccess;get quickAccess(){return this._quickAccess||(this._quickAccess=this._register(this.instantiationService.createInstance(P))),this._quickAccess}contexts=new Map;createController(e=this.layoutService,t){const i={idPrefix:"quickInput_",container:e.activeContainer,ignoreFocusOut:()=>!1,backKeybindingLabel:()=>{},setContextKey:o=>this.setContextKey(o),linkOpenerDelegate:o=>{this.instantiationService.invokeFunction(h=>{h.get(B).open(o,{allowCommands:!0,fromUserGesture:!0})})},returnFocus:()=>e.focus(),styles:this.computeStyles(),hoverDelegate:this._register(this.instantiationService.createInstance(E))},r=this._register(this.instantiationService.createInstance(V,{...i,...t}));return r.layout(e.activeContainerDimension,e.activeContainerOffset.quickPickTop),this._register(e.onDidLayoutActiveContainer(o=>{v(e.activeContainer)===v(r.container)&&r.layout(o,e.activeContainerOffset.quickPickTop)})),this._register(e.onDidChangeActiveContainer(()=>{r.isVisible()||r.layout(e.activeContainerDimension,e.activeContainerOffset.quickPickTop)})),this._register(r.onShow(()=>{this.resetContextKeys(),this._onShow.fire()})),this._register(r.onHide(()=>{this.resetContextKeys(),this._onHide.fire()})),r}setContextKey(e){let t;e&&(t=this.contexts.get(e),t||(t=new C(e,!1).bindTo(this.contextKeyService),this.contexts.set(e,t))),!(t&&t.get())&&(this.resetContextKeys(),t?.set(!0))}resetContextKeys(){this.contexts.forEach(e=>{e.get()&&e.reset()})}pick(e,t,i=p.None){return this.controller.pick(e,t,i)}input(e={},t=p.None){return this.controller.input(e,t)}createQuickPick(e={useSeparators:!1}){return this.controller.createQuickPick(e)}createInputBox(){return this.controller.createInputBox()}createQuickWidget(){return this.controller.createQuickWidget()}focus(){this.controller.focus()}toggle(){this.controller.toggle()}navigate(e,t){this.controller.navigate(e,t)}accept(e){return this.controller.accept(e)}back(){return this.controller.back()}cancel(){return this.controller.cancel()}updateStyles(){this.hasController&&this.controller.applyStyles(this.computeStyles())}computeStyles(){return{widget:{quickInputBackground:c(d),quickInputForeground:c(L),quickInputTitleBackground:c(D),widgetBorder:c(G),widgetShadow:c(W)},inputBox:b,toggle:K,countBadge:T,button:_,progressBar:w,keybindingLabel:F,list:O({listBackground:d,listFocusBackground:g,listFocusForeground:f,listInactiveFocusForeground:f,listInactiveSelectionIconForeground:H,listInactiveFocusBackground:g,listFocusOutline:I,listInactiveFocusOutline:I}),pickerGroup:{pickerGroupBorder:c(q),pickerGroupForeground:c(A)}}}};a=l([s(0,Q),s(1,S),s(2,M),s(3,x),s(4,R)],a);export{a as QuickInputService};
