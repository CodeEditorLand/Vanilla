{
  "version": 3,
  "sources": ["../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/platform/quickinput/browser/quickInputService.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { getWindow } from \"../../../base/browser/dom.js\";\nimport { CancellationToken } from \"../../../base/common/cancellation.js\";\nimport { Emitter } from \"../../../base/common/event.js\";\nimport { IConfigurationService } from \"../../configuration/common/configuration.js\";\nimport {\n\ttype IContextKey,\n\tIContextKeyService,\n\tRawContextKey,\n} from \"../../contextkey/common/contextkey.js\";\nimport { IInstantiationService } from \"../../instantiation/common/instantiation.js\";\nimport { ILayoutService } from \"../../layout/browser/layoutService.js\";\nimport { IOpenerService } from \"../../opener/common/opener.js\";\nimport {\n\tdefaultButtonStyles,\n\tdefaultCountBadgeStyles,\n\tdefaultInputBoxStyles,\n\tdefaultKeybindingLabelStyles,\n\tdefaultProgressBarStyles,\n\tdefaultToggleStyles,\n\tgetListStyles,\n} from \"../../theme/browser/defaultStyles.js\";\nimport {\n\tactiveContrastBorder,\n\tasCssVariable,\n\tpickerGroupBorder,\n\tpickerGroupForeground,\n\tquickInputBackground,\n\tquickInputForeground,\n\tquickInputListFocusBackground,\n\tquickInputListFocusForeground,\n\tquickInputListFocusIconForeground,\n\tquickInputTitleBackground,\n\twidgetBorder,\n\twidgetShadow,\n} from \"../../theme/common/colorRegistry.js\";\nimport { IThemeService, Themable } from \"../../theme/common/themeService.js\";\nimport type { IQuickAccessController } from \"../common/quickAccess.js\";\nimport type {\n\tIInputBox,\n\tIInputOptions,\n\tIKeyMods,\n\tIPickOptions,\n\tIQuickInputButton,\n\tIQuickInputService,\n\tIQuickNavigateConfiguration,\n\tIQuickPick,\n\tIQuickPickItem,\n\tIQuickWidget,\n\tQuickPickInput,\n} from \"../common/quickInput.js\";\nimport { QuickAccessController } from \"./quickAccess.js\";\nimport {\n\ttype IQuickInputOptions,\n\ttype IQuickInputStyles,\n\tQuickInputHoverDelegate,\n} from \"./quickInput.js\";\nimport {\n\ttype IQuickInputControllerHost,\n\tQuickInputController,\n} from \"./quickInputController.js\";\n\nexport class QuickInputService extends Themable implements IQuickInputService {\n\tdeclare readonly _serviceBrand: undefined;\n\n\tget backButton(): IQuickInputButton {\n\t\treturn this.controller.backButton;\n\t}\n\n\tprivate readonly _onShow = this._register(new Emitter<void>());\n\treadonly onShow = this._onShow.event;\n\n\tprivate readonly _onHide = this._register(new Emitter<void>());\n\treadonly onHide = this._onHide.event;\n\n\tprivate _controller: QuickInputController | undefined;\n\tprivate get controller(): QuickInputController {\n\t\tif (!this._controller) {\n\t\t\tthis._controller = this._register(this.createController());\n\t\t}\n\n\t\treturn this._controller;\n\t}\n\n\tprivate get hasController() {\n\t\treturn !!this._controller;\n\t}\n\tget currentQuickInput() {\n\t\treturn this.controller.currentQuickInput;\n\t}\n\n\tprivate _quickAccess: IQuickAccessController | undefined;\n\tget quickAccess(): IQuickAccessController {\n\t\tif (!this._quickAccess) {\n\t\t\tthis._quickAccess = this._register(\n\t\t\t\tthis.instantiationService.createInstance(QuickAccessController),\n\t\t\t);\n\t\t}\n\n\t\treturn this._quickAccess;\n\t}\n\n\tprivate readonly contexts = new Map<string, IContextKey<boolean>>();\n\n\tconstructor(\n\t\t@IInstantiationService private readonly instantiationService: IInstantiationService,\n\t\t@IContextKeyService protected readonly contextKeyService: IContextKeyService,\n\t\t@IThemeService themeService: IThemeService,\n\t\t@ILayoutService protected readonly layoutService: ILayoutService,\n\t\t@IConfigurationService protected readonly configurationService: IConfigurationService,\n\t) {\n\t\tsuper(themeService);\n\t}\n\n\tprotected createController(\n\t\thost: IQuickInputControllerHost = this.layoutService,\n\t\toptions?: Partial<IQuickInputOptions>,\n\t): QuickInputController {\n\t\tconst defaultOptions: IQuickInputOptions = {\n\t\t\tidPrefix: \"quickInput_\",\n\t\t\tcontainer: host.activeContainer,\n\t\t\tignoreFocusOut: () => false,\n\t\t\tbackKeybindingLabel: () => undefined,\n\t\t\tsetContextKey: (id?: string) => this.setContextKey(id),\n\t\t\tlinkOpenerDelegate: (content) => {\n\t\t\t\t// HACK: https://github.com/microsoft/vscode/issues/173691\n\t\t\t\tthis.instantiationService.invokeFunction((accessor) => {\n\t\t\t\t\tconst openerService = accessor.get(IOpenerService);\n\t\t\t\t\topenerService.open(content, {\n\t\t\t\t\t\tallowCommands: true,\n\t\t\t\t\t\tfromUserGesture: true,\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\treturnFocus: () => host.focus(),\n\t\t\tstyles: this.computeStyles(),\n\t\t\thoverDelegate: this._register(\n\t\t\t\tthis.instantiationService.createInstance(\n\t\t\t\t\tQuickInputHoverDelegate,\n\t\t\t\t),\n\t\t\t),\n\t\t};\n\n\t\tconst controller = this._register(\n\t\t\tthis.instantiationService.createInstance(QuickInputController, {\n\t\t\t\t...defaultOptions,\n\t\t\t\t...options,\n\t\t\t}),\n\t\t);\n\n\t\tcontroller.layout(\n\t\t\thost.activeContainerDimension,\n\t\t\thost.activeContainerOffset.quickPickTop,\n\t\t);\n\n\t\t// Layout changes\n\t\tthis._register(\n\t\t\thost.onDidLayoutActiveContainer((dimension) => {\n\t\t\t\tif (\n\t\t\t\t\tgetWindow(host.activeContainer) ===\n\t\t\t\t\tgetWindow(controller.container)\n\t\t\t\t) {\n\t\t\t\t\tcontroller.layout(\n\t\t\t\t\t\tdimension,\n\t\t\t\t\t\thost.activeContainerOffset.quickPickTop,\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}),\n\t\t);\n\t\tthis._register(\n\t\t\thost.onDidChangeActiveContainer(() => {\n\t\t\t\tif (controller.isVisible()) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tcontroller.layout(\n\t\t\t\t\thost.activeContainerDimension,\n\t\t\t\t\thost.activeContainerOffset.quickPickTop,\n\t\t\t\t);\n\t\t\t}),\n\t\t);\n\n\t\t// Context keys\n\t\tthis._register(\n\t\t\tcontroller.onShow(() => {\n\t\t\t\tthis.resetContextKeys();\n\t\t\t\tthis._onShow.fire();\n\t\t\t}),\n\t\t);\n\t\tthis._register(\n\t\t\tcontroller.onHide(() => {\n\t\t\t\tthis.resetContextKeys();\n\t\t\t\tthis._onHide.fire();\n\t\t\t}),\n\t\t);\n\n\t\treturn controller;\n\t}\n\n\tprivate setContextKey(id?: string) {\n\t\tlet key: IContextKey<boolean> | undefined;\n\t\tif (id) {\n\t\t\tkey = this.contexts.get(id);\n\t\t\tif (!key) {\n\t\t\t\tkey = new RawContextKey<boolean>(id, false).bindTo(\n\t\t\t\t\tthis.contextKeyService,\n\t\t\t\t);\n\t\t\t\tthis.contexts.set(id, key);\n\t\t\t}\n\t\t}\n\n\t\tif (key && key.get()) {\n\t\t\treturn; // already active context\n\t\t}\n\n\t\tthis.resetContextKeys();\n\n\t\tkey?.set(true);\n\t}\n\n\tprivate resetContextKeys() {\n\t\tthis.contexts.forEach((context) => {\n\t\t\tif (context.get()) {\n\t\t\t\tcontext.reset();\n\t\t\t}\n\t\t});\n\t}\n\n\tpick<T extends IQuickPickItem, O extends IPickOptions<T>>(\n\t\tpicks: Promise<QuickPickInput<T>[]> | QuickPickInput<T>[],\n\t\toptions?: O,\n\t\ttoken: CancellationToken = CancellationToken.None,\n\t): Promise<(O extends { canPickMany: true } ? T[] : T) | undefined> {\n\t\treturn this.controller.pick(picks, options, token);\n\t}\n\n\tinput(\n\t\toptions: IInputOptions = {},\n\t\ttoken: CancellationToken = CancellationToken.None,\n\t): Promise<string | undefined> {\n\t\treturn this.controller.input(options, token);\n\t}\n\n\tcreateQuickPick<T extends IQuickPickItem>(options: {\n\t\tuseSeparators: true;\n\t}): IQuickPick<T, { useSeparators: true }>;\n\tcreateQuickPick<T extends IQuickPickItem>(options?: {\n\t\tuseSeparators: boolean;\n\t}): IQuickPick<T, { useSeparators: false }>;\n\tcreateQuickPick<T extends IQuickPickItem>(\n\t\toptions: { useSeparators: boolean } = { useSeparators: false },\n\t): IQuickPick<T, { useSeparators: boolean }> {\n\t\treturn this.controller.createQuickPick(options);\n\t}\n\n\tcreateInputBox(): IInputBox {\n\t\treturn this.controller.createInputBox();\n\t}\n\n\tcreateQuickWidget(): IQuickWidget {\n\t\treturn this.controller.createQuickWidget();\n\t}\n\n\tfocus() {\n\t\tthis.controller.focus();\n\t}\n\n\ttoggle() {\n\t\tthis.controller.toggle();\n\t}\n\n\tnavigate(next: boolean, quickNavigate?: IQuickNavigateConfiguration) {\n\t\tthis.controller.navigate(next, quickNavigate);\n\t}\n\n\taccept(keyMods?: IKeyMods) {\n\t\treturn this.controller.accept(keyMods);\n\t}\n\n\tback() {\n\t\treturn this.controller.back();\n\t}\n\n\tcancel() {\n\t\treturn this.controller.cancel();\n\t}\n\n\toverride updateStyles() {\n\t\tif (this.hasController) {\n\t\t\tthis.controller.applyStyles(this.computeStyles());\n\t\t}\n\t}\n\n\tprivate computeStyles(): IQuickInputStyles {\n\t\treturn {\n\t\t\twidget: {\n\t\t\t\tquickInputBackground: asCssVariable(quickInputBackground),\n\t\t\t\tquickInputForeground: asCssVariable(quickInputForeground),\n\t\t\t\tquickInputTitleBackground: asCssVariable(\n\t\t\t\t\tquickInputTitleBackground,\n\t\t\t\t),\n\t\t\t\twidgetBorder: asCssVariable(widgetBorder),\n\t\t\t\twidgetShadow: asCssVariable(widgetShadow),\n\t\t\t},\n\t\t\tinputBox: defaultInputBoxStyles,\n\t\t\ttoggle: defaultToggleStyles,\n\t\t\tcountBadge: defaultCountBadgeStyles,\n\t\t\tbutton: defaultButtonStyles,\n\t\t\tprogressBar: defaultProgressBarStyles,\n\t\t\tkeybindingLabel: defaultKeybindingLabelStyles,\n\t\t\tlist: getListStyles({\n\t\t\t\tlistBackground: quickInputBackground,\n\t\t\t\tlistFocusBackground: quickInputListFocusBackground,\n\t\t\t\tlistFocusForeground: quickInputListFocusForeground,\n\t\t\t\t// Look like focused when inactive.\n\t\t\t\tlistInactiveFocusForeground: quickInputListFocusForeground,\n\t\t\t\tlistInactiveSelectionIconForeground:\n\t\t\t\t\tquickInputListFocusIconForeground,\n\t\t\t\tlistInactiveFocusBackground: quickInputListFocusBackground,\n\t\t\t\tlistFocusOutline: activeContrastBorder,\n\t\t\t\tlistInactiveFocusOutline: activeContrastBorder,\n\t\t\t}),\n\t\t\tpickerGroup: {\n\t\t\t\tpickerGroupBorder: asCssVariable(pickerGroupBorder),\n\t\t\t\tpickerGroupForeground: asCssVariable(pickerGroupForeground),\n\t\t\t},\n\t\t};\n\t}\n}\n"],
  "mappings": "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",
  "names": []
}
