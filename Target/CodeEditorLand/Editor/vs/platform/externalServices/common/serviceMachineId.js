import{VSBuffer as a}from"../../../base/common/buffer.js";import{generateUuid as s,isUUID as m}from"../../../base/common/uuid.js";import{StorageScope as c,StorageTarget as l}from"../../storage/common/storage.js";async function g(t,i,r){let e=r&&r.get("storage.serviceMachineId",c.APPLICATION)||null;if(e)return e;try{const o=(await i.readFile(t.serviceMachineIdResource)).value.toString();e=m(o)?o:null}catch{e=null}if(!e){e=s();try{await i.writeFile(t.serviceMachineIdResource,a.fromString(e))}catch{}}return r?.store("storage.serviceMachineId",e,c.APPLICATION,l.MACHINE),e}export{g as getServiceMachineId};
