import{VSBuffer as a}from"../../../../vs/base/common/buffer.js";import{generateUuid as u,isUUID as I}from"../../../../vs/base/common/uuid.js";import"../../../../vs/platform/environment/common/environment.js";import"../../../../vs/platform/files/common/files.js";import{StorageScope as c,StorageTarget as l}from"../../../../vs/platform/storage/common/storage.js";async function p(t,i,r){let e=r&&r.get("storage.serviceMachineId",c.APPLICATION)||null;if(e)return e;try{const o=(await i.readFile(t.serviceMachineIdResource)).value.toString();e=I(o)?o:null}catch{e=null}if(!e){e=u();try{await i.writeFile(t.serviceMachineIdResource,a.fromString(e))}catch{}}return r?.store("storage.serviceMachineId",e,c.APPLICATION,l.MACHINE),e}export{p as getServiceMachineId};
