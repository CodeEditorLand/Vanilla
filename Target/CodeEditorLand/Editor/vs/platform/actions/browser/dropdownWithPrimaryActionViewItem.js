var A=Object.defineProperty;var g=Object.getOwnPropertyDescriptor;var m=(a,r,e,i)=>{for(var o=i>1?void 0:i?g(r,e):r,n=a.length-1,c;n>=0;n--)(c=a[n])&&(o=(i?c(r,e,o):c(o))||o);return i&&o&&A(r,e,o),o},d=(a,r)=>(e,i)=>r(e,i,a);import*as t from"../../../base/browser/dom.js";import{StandardKeyboardEvent as l}from"../../../base/browser/keyboardEvent.js";import{BaseActionViewItem as I}from"../../../base/browser/ui/actionbar/actionViewItems.js";import{DropdownMenuActionViewItem as h}from"../../../base/browser/ui/dropdown/dropdownActionViewItem.js";import{KeyCode as v}from"../../../base/common/keyCodes.js";import{IAccessibilityService as f}from"../../accessibility/common/accessibility.js";import{IContextKeyService as D}from"../../contextkey/common/contextkey.js";import{IKeybindingService as C}from"../../keybinding/common/keybinding.js";import{INotificationService as x}from"../../notification/common/notification.js";import{IThemeService as E}from"../../theme/common/themeService.js";import{MenuEntryActionViewItem as K}from"./menuEntryActionViewItem.js";let p=class extends I{constructor(e,i,o,n,c,s,u,_,y,b,w){super(null,e,{hoverDelegate:s?.hoverDelegate});this._contextMenuProvider=c;this._options=s;this._primaryAction=new K(e,{hoverDelegate:s?.hoverDelegate},u,_,y,b,c,w),s?.actionRunner&&(this._primaryAction.actionRunner=s.actionRunner),this._dropdown=new h(i,o,this._contextMenuProvider,{menuAsChild:s?.menuAsChild??!0,classNames:n?["codicon","codicon-chevron-down",n]:["codicon","codicon-chevron-down"],actionRunner:this._options?.actionRunner,keybindingProvider:this._options?.getKeyBinding,hoverDelegate:s?.hoverDelegate})}_primaryAction;_dropdown;_container=null;_dropdownContainer=null;get onDidChangeDropdownVisibility(){return this._dropdown.onDidChangeVisibility}setActionContext(e){super.setActionContext(e),this._primaryAction.setActionContext(e),this._dropdown.setActionContext(e)}render(e){this._container=e,super.render(this._container),this._container.classList.add("monaco-dropdown-with-primary");const i=t.$(".action-container");this._primaryAction.render(t.append(this._container,i)),this._dropdownContainer=t.$(".dropdown-action-container"),this._dropdown.render(t.append(this._container,this._dropdownContainer)),this._register(t.addDisposableListener(i,t.EventType.KEY_DOWN,o=>{const n=new l(o);n.equals(v.RightArrow)&&(this._primaryAction.element.tabIndex=-1,this._dropdown.focus(),n.stopPropagation())})),this._register(t.addDisposableListener(this._dropdownContainer,t.EventType.KEY_DOWN,o=>{const n=new l(o);n.equals(v.LeftArrow)&&(this._primaryAction.element.tabIndex=0,this._dropdown.setFocusable(!1),this._primaryAction.element?.focus(),n.stopPropagation())})),this.updateEnabled()}focus(e){e?this._dropdown.focus():(this._primaryAction.element.tabIndex=0,this._primaryAction.element.focus())}blur(){this._primaryAction.element.tabIndex=-1,this._dropdown.blur(),this._container.blur()}setFocusable(e){e?this._primaryAction.element.tabIndex=0:(this._primaryAction.element.tabIndex=-1,this._dropdown.setFocusable(!1))}updateEnabled(){const e=!this.action.enabled;this.element?.classList.toggle("disabled",e)}update(e,i,o){this._dropdown.dispose(),this._dropdown=new h(e,i,this._contextMenuProvider,{menuAsChild:!0,classNames:["codicon",o||"codicon-chevron-down"],actionRunner:this._options?.actionRunner,hoverDelegate:this._options?.hoverDelegate,keybindingProvider:this._options?.getKeyBinding}),this._dropdownContainer&&this._dropdown.render(this._dropdownContainer)}dispose(){this._primaryAction.dispose(),this._dropdown.dispose(),super.dispose()}};p=m([d(6,C),d(7,x),d(8,D),d(9,E),d(10,f)],p);export{p as DropdownWithPrimaryActionViewItem};
