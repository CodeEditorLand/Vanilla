var I=Object.defineProperty;var y=Object.getOwnPropertyDescriptor;var l=(n,e,t,o)=>{for(var r=o>1?void 0:o?y(e,t):e,i=n.length-1,c;i>=0;i--)(c=n[i])&&(r=(o?c(e,t,r):c(r))||r);return o&&r&&I(e,t,r),r},s=(n,e)=>(t,o)=>e(t,o,n);import{$ as m,append as _,clearNode as b}from"../../../base/browser/dom.js";import{Widget as f}from"../../../base/browser/ui/widget.js";import{Emitter as u}from"../../../base/common/event.js";import{Disposable as A,DisposableStore as N,toDisposable as x}from"../../../base/common/lifecycle.js";import{IContextKeyService as h}from"../../contextkey/common/contextkey.js";import{IInstantiationService as S}from"../../instantiation/common/instantiation.js";import{asCssVariable as p,asCssVariableWithDefault as g,buttonBackground as C,buttonForeground as k,contrastBorder as D,editorBackground as w,editorForeground as W}from"../../theme/common/colorRegistry.js";import{IMenuService as v}from"../common/actions.js";import{createAndFillInActionBarActions as M}from"./menuEntryActionViewItem.js";class E extends f{constructor(t){super();this.label=t;this._domNode=m(".floating-click-widget"),this._domNode.style.padding="6px 11px",this._domNode.style.borderRadius="2px",this._domNode.style.cursor="pointer",this._domNode.style.zIndex="1"}_onClick=this._register(new u);onClick=this._onClick.event;_domNode;getDomNode(){return this._domNode}render(){b(this._domNode),this._domNode.style.backgroundColor=g(C,p(w)),this._domNode.style.color=g(k,p(W)),this._domNode.style.border=`1px solid ${p(D)}`,_(this._domNode,m("")).textContent=this.label,this.onclick(this._domNode,()=>this._onClick.fire())}}let d=class extends A{renderEmitter=new u;onDidRender=this.renderEmitter.event;menu;constructor(e,t,o){super(),this.menu=this._register(t.createMenu(e,o))}render(){const e=this._register(new N),t=()=>{if(e.clear(),!this.isVisible())return;const o=[];if(M(this.menu,{renderShortTitle:!0,shouldForwardArgs:!0},o),o.length===0)return;const[r]=o,i=this.createWidget(r,e);e.add(i),e.add(i.onClick(()=>r.run(this.getActionArg()))),i.render()};this._register(this.menu.onDidChange(t)),t()}getActionArg(){}isVisible(){return!0}};d=l([s(1,v),s(2,h)],d);let a=class extends d{constructor(t,o,r,i){super(t.menuId,r,i);this.options=t;this.instantiationService=o;this.render()}createWidget(t,o){const r=this.instantiationService.createInstance(E,t.label),i=r.getDomNode();return this.options.container.appendChild(i),o.add(x(()=>i.remove())),r}getActionArg(){return this.options.getActionArg()}};a=l([s(1,S),s(2,v),s(3,h)],a);export{d as AbstractFloatingClickMenu,a as FloatingClickMenu,E as FloatingClickWidget};
