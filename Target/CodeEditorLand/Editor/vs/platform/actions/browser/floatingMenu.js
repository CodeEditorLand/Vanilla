var I=Object.defineProperty;var _=Object.getOwnPropertyDescriptor;var l=(n,e,t,r)=>{for(var o=r>1?void 0:r?_(e,t):e,i=n.length-1,c;i>=0;i--)(c=n[i])&&(o=(r?c(e,t,o):c(o))||o);return r&&o&&I(e,t,o),o},d=(n,e)=>(t,r)=>e(t,r,n);import{$ as p,append as b,clearNode as f}from"../../../base/browser/dom.js";import{Widget as y}from"../../../base/browser/ui/widget.js";import"../../../base/common/actions.js";import{Emitter as u}from"../../../base/common/event.js";import{Disposable as A,DisposableStore as N,toDisposable as x}from"../../../base/common/lifecycle.js";import{IContextKeyService as h}from"../../contextkey/common/contextkey.js";import{IInstantiationService as S}from"../../instantiation/common/instantiation.js";import{asCssVariable as m,asCssVariableWithDefault as g,buttonBackground as C,buttonForeground as k,contrastBorder as D,editorBackground as w,editorForeground as W}from"../../theme/common/colorRegistry.js";import{IMenuService as v}from"../common/actions.js";import{createAndFillInActionBarActions as M}from"./menuEntryActionViewItem.js";class E extends y{constructor(t){super();this.label=t;this._domNode=p(".floating-click-widget"),this._domNode.style.padding="6px 11px",this._domNode.style.borderRadius="2px",this._domNode.style.cursor="pointer",this._domNode.style.zIndex="1"}_onClick=this._register(new u);onClick=this._onClick.event;_domNode;getDomNode(){return this._domNode}render(){f(this._domNode),this._domNode.style.backgroundColor=g(C,m(w)),this._domNode.style.color=g(k,m(W)),this._domNode.style.border=`1px solid ${m(D)}`,b(this._domNode,p("")).textContent=this.label,this.onclick(this._domNode,()=>this._onClick.fire())}}let s=class extends A{renderEmitter=new u;onDidRender=this.renderEmitter.event;menu;constructor(e,t,r){super(),this.menu=this._register(t.createMenu(e,r))}render(){const e=this._register(new N),t=()=>{if(e.clear(),!this.isVisible())return;const r=[];if(M(this.menu,{renderShortTitle:!0,shouldForwardArgs:!0},r),r.length===0)return;const[o]=r,i=this.createWidget(o,e);e.add(i),e.add(i.onClick(()=>o.run(this.getActionArg()))),i.render()};this._register(this.menu.onDidChange(t)),t()}getActionArg(){}isVisible(){return!0}};s=l([d(1,v),d(2,h)],s);let a=class extends s{constructor(t,r,o,i){super(t.menuId,o,i);this.options=t;this.instantiationService=r;this.render()}createWidget(t,r){const o=this.instantiationService.createInstance(E,t.label),i=o.getDomNode();return this.options.container.appendChild(i),r.add(x(()=>i.remove())),o}getActionArg(){return this.options.getActionArg()}};a=l([d(1,S),d(2,v),d(3,h)],a);export{s as AbstractFloatingClickMenu,a as FloatingClickMenu,E as FloatingClickWidget};
