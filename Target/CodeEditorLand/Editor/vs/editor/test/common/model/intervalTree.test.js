import l from"assert";import{ensureNoDisposablesAreLeakedInTestSuite as _}from"../../../../base/test/common/utils.js";import{TrackedRangeStickiness as n}from"../../../common/model.js";import{IntervalNode as W,IntervalTree as m,NodeColor as f,SENTINEL as a,getNodeColor as w,intervalCompare as I,nodeAcceptEdit as S,setNodeStickiness as R}from"../../../common/model/intervalTree.js";const x=!1,C=x?1e4:0,c=!1,b=1,E=100,$=1,M=30,k=10,D=20;suite("IntervalTree 1",()=>{_();class e{_intervalBrand=void 0;start;end;constructor(t,r){this.start=t,this.end=r}}class i{intervals;constructor(){this.intervals=[]}insert(t){return this.intervals.push(t),this.intervals.sort((r,g)=>r.start===g.start?r.end-g.end:r.start-g.start),t}delete(t){for(let r=0,g=this.intervals.length;r<g;r++)if(this.intervals[r]===t){this.intervals.splice(r,1);return}}search(t){const r=[];for(let g=0,p=this.intervals.length;g<p;g++){const h=this.intervals[g];h.start<=t.end&&h.end>=t.start&&r.push(h)}return r}}class d{_oracle=new i;_tree=new m;_lastNodeId=-1;_treeNodes=[];_oracleNodes=[];acceptOp(t){if(t.type==="insert"){c&&console.log(`insert: {${JSON.stringify(new e(t.begin,t.end))}}`);const p=++this._lastNodeId;this._treeNodes[p]=new W(null,t.begin,t.end),this._tree.insert(this._treeNodes[p]),this._oracleNodes[p]=this._oracle.insert(new e(t.begin,t.end))}else if(t.type==="delete")c&&console.log(`delete: {${JSON.stringify(this._oracleNodes[t.id])}}`),this._tree.delete(this._treeNodes[t.id]),this._oracle.delete(this._oracleNodes[t.id]),this._treeNodes[t.id]=null,this._oracleNodes[t.id]=null;else if(t.type==="change")this._tree.delete(this._treeNodes[t.id]),this._treeNodes[t.id].reset(0,t.begin,t.end,null),this._tree.insert(this._treeNodes[t.id]),this._oracle.delete(this._oracleNodes[t.id]),this._oracleNodes[t.id].start=t.begin,this._oracleNodes[t.id].end=t.end,this._oracle.insert(this._oracleNodes[t.id]);else{const h=this._tree.intervalSearch(t.begin,t.end,0,!1,0,!1).map(u=>new e(u.cachedAbsoluteStart,u.cachedAbsoluteEnd)),T=this._oracle.search(new e(t.begin,t.end));l.deepStrictEqual(h,T);return}c&&L(this._tree),q(this._tree);const r=this._tree.getAllInOrder().map(p=>new e(p.cachedAbsoluteStart,p.cachedAbsoluteEnd)),g=this._oracle.intervals;l.deepStrictEqual(r,g)}getExistingNodeId(t){let r=-1;for(let g=0;g<this._treeNodes.length;g++)if(this._treeNodes[g]!==null&&(r++,r===t))return g;throw new Error("unexpected")}}function s(y){const t=new d;for(let r=0;r<y.length;r++)t.acceptOp(y[r])}function o(y,t){return Math.floor(Math.random()*(t-y+1))+y}function B(y,t){const r=o(y,t);let g;return o(1,10)<=2?g=o(0,t-r):g=o(0,Math.min(t-r,10)),[r,r+g]}class G{_ops=[];_state=new d;_insertCnt;_deleteCnt;_changeCnt;constructor(){this._insertCnt=o($,M),this._changeCnt=o(k,D),this._deleteCnt=0}_doRandomInsert(){const t=B(b,E);this._run({type:"insert",begin:t[0],end:t[1]})}_doRandomDelete(){const t=o(Math.floor(this._deleteCnt/2),this._deleteCnt-1);this._run({type:"delete",id:this._state.getExistingNodeId(t)})}_doRandomChange(){const t=o(0,this._deleteCnt-1),r=B(b,E);this._run({type:"change",id:this._state.getExistingNodeId(t),begin:r[0],end:r[1]})}run(){for(;this._insertCnt>0||this._deleteCnt>0||this._changeCnt>0;){this._insertCnt>0?(this._doRandomInsert(),this._insertCnt--,this._deleteCnt++):this._changeCnt>0?(this._doRandomChange(),this._changeCnt--):(this._doRandomDelete(),this._deleteCnt--);const t=B(b,E);this._run({type:"search",begin:t[0],end:t[1]})}}_run(t){this._ops.push(t),this._state.acceptOp(t)}print(){console.log(`testIntervalTree(${JSON.stringify(this._ops)})`)}}suite("generated",()=>{test("gen01",()=>{s([{type:"insert",begin:28,end:35},{type:"insert",begin:52,end:54},{type:"insert",begin:63,end:69}])}),test("gen02",()=>{s([{type:"insert",begin:80,end:89},{type:"insert",begin:92,end:100},{type:"insert",begin:99,end:99}])}),test("gen03",()=>{s([{type:"insert",begin:89,end:96},{type:"insert",begin:71,end:74},{type:"delete",id:1}])}),test("gen04",()=>{s([{type:"insert",begin:44,end:46},{type:"insert",begin:85,end:88},{type:"delete",id:0}])}),test("gen05",()=>{s([{type:"insert",begin:82,end:90},{type:"insert",begin:69,end:73},{type:"delete",id:0},{type:"delete",id:1}])}),test("gen06",()=>{s([{type:"insert",begin:41,end:63},{type:"insert",begin:98,end:98},{type:"insert",begin:47,end:51},{type:"delete",id:2}])}),test("gen07",()=>{s([{type:"insert",begin:24,end:26},{type:"insert",begin:11,end:28},{type:"insert",begin:27,end:30},{type:"insert",begin:80,end:85},{type:"delete",id:1}])}),test("gen08",()=>{s([{type:"insert",begin:100,end:100},{type:"insert",begin:100,end:100}])}),test("gen09",()=>{s([{type:"insert",begin:58,end:65},{type:"insert",begin:82,end:96},{type:"insert",begin:58,end:65}])}),test("gen10",()=>{s([{type:"insert",begin:32,end:40},{type:"insert",begin:25,end:29},{type:"insert",begin:24,end:32}])}),test("gen11",()=>{s([{type:"insert",begin:25,end:70},{type:"insert",begin:99,end:100},{type:"insert",begin:46,end:51},{type:"insert",begin:57,end:57},{type:"delete",id:2}])}),test("gen12",()=>{s([{type:"insert",begin:20,end:26},{type:"insert",begin:10,end:18},{type:"insert",begin:99,end:99},{type:"insert",begin:37,end:59},{type:"delete",id:2}])}),test("gen13",()=>{s([{type:"insert",begin:3,end:91},{type:"insert",begin:57,end:57},{type:"insert",begin:35,end:44},{type:"insert",begin:72,end:81},{type:"delete",id:2}])}),test("gen14",()=>{s([{type:"insert",begin:58,end:61},{type:"insert",begin:34,end:35},{type:"insert",begin:56,end:62},{type:"insert",begin:69,end:78},{type:"delete",id:0}])}),test("gen15",()=>{s([{type:"insert",begin:63,end:69},{type:"insert",begin:17,end:24},{type:"insert",begin:3,end:13},{type:"insert",begin:84,end:94},{type:"insert",begin:18,end:23},{type:"insert",begin:96,end:98},{type:"delete",id:1}])}),test("gen16",()=>{s([{type:"insert",begin:27,end:27},{type:"insert",begin:42,end:87},{type:"insert",begin:42,end:49},{type:"insert",begin:69,end:71},{type:"insert",begin:20,end:27},{type:"insert",begin:8,end:9},{type:"insert",begin:42,end:49},{type:"delete",id:1}])}),test("gen17",()=>{s([{type:"insert",begin:21,end:23},{type:"insert",begin:83,end:87},{type:"insert",begin:56,end:58},{type:"insert",begin:1,end:55},{type:"insert",begin:56,end:59},{type:"insert",begin:58,end:60},{type:"insert",begin:56,end:65},{type:"delete",id:1},{type:"delete",id:0},{type:"delete",id:6}])}),test("gen18",()=>{s([{type:"insert",begin:25,end:25},{type:"insert",begin:67,end:79},{type:"delete",id:0},{type:"search",begin:65,end:75}])}),test("force delta overflow",()=>{s([{type:"insert",begin:686081138593427,end:733009856502260},{type:"insert",begin:591031326181669,end:591031326181672},{type:"insert",begin:940037682731896,end:940037682731903},{type:"insert",begin:598413641151120,end:598413641151128},{type:"insert",begin:800564156553344,end:800564156553351},{type:"insert",begin:894198957565481,end:894198957565491}])})});for(let y=0;y<C;y++){y%100===0&&console.log(`TEST ${y+1}/${C}`);const t=new G;try{t.run()}catch(r){console.log(r),t.print();return}}suite("searching",()=>{function y(){const g=new m;return[[16,21],[8,9],[25,30],[5,8],[15,23],[17,19],[26,26],[0,3],[6,10],[19,20]].forEach(h=>{const T=new W(null,h[0],h[1]);g.insert(T)}),g}const t=y();function r(g,p,h){const u=t.intervalSearch(g,p,0,!1,0,!1).map(N=>[N.cachedAbsoluteStart,N.cachedAbsoluteEnd]);l.deepStrictEqual(u,h)}test("cormen 1->2",()=>{r(1,2,[[0,3]])}),test("cormen 4->8",()=>{r(4,8,[[5,8],[6,10],[8,9]])}),test("cormen 10->15",()=>{r(10,15,[[6,10],[15,23]])}),test("cormen 21->25",()=>{r(21,25,[[15,23],[16,21],[25,30]])}),test("cormen 24->24",()=>{r(24,24,[])})})}),suite("IntervalTree 2",()=>{_();function e(i,d,s,o,B,G,y,t,r,g){const p=new W("",d,s);R(p,o),S(p,B,G,y,t),l.deepStrictEqual([p.start,p.end],[r,g],i)}test("nodeAcceptEdit",()=>{e("A.000",0,0,n.AlwaysGrowsWhenTypingAtEdges,0,0,0,!1,0,0),e("A.001",0,0,n.NeverGrowsWhenTypingAtEdges,0,0,0,!1,0,0),e("A.002",0,0,n.GrowsOnlyWhenTypingBefore,0,0,0,!1,0,0),e("A.003",0,0,n.GrowsOnlyWhenTypingAfter,0,0,0,!1,0,0),e("A.004",0,0,n.AlwaysGrowsWhenTypingAtEdges,0,0,0,!0,0,0),e("A.005",0,0,n.NeverGrowsWhenTypingAtEdges,0,0,0,!0,0,0),e("A.006",0,0,n.GrowsOnlyWhenTypingBefore,0,0,0,!0,0,0),e("A.007",0,0,n.GrowsOnlyWhenTypingAfter,0,0,0,!0,0,0),e("A.008",0,0,n.AlwaysGrowsWhenTypingAtEdges,0,0,1,!1,0,1),e("A.009",0,0,n.NeverGrowsWhenTypingAtEdges,0,0,1,!1,1,1),e("A.010",0,0,n.GrowsOnlyWhenTypingBefore,0,0,1,!1,0,0),e("A.011",0,0,n.GrowsOnlyWhenTypingAfter,0,0,1,!1,1,1),e("A.012",0,0,n.AlwaysGrowsWhenTypingAtEdges,0,0,1,!0,1,1),e("A.013",0,0,n.NeverGrowsWhenTypingAtEdges,0,0,1,!0,1,1),e("A.014",0,0,n.GrowsOnlyWhenTypingBefore,0,0,1,!0,1,1),e("A.015",0,0,n.GrowsOnlyWhenTypingAfter,0,0,1,!0,1,1),e("B.000",0,5,n.AlwaysGrowsWhenTypingAtEdges,0,0,0,!1,0,5),e("B.001",0,5,n.NeverGrowsWhenTypingAtEdges,0,0,0,!1,0,5),e("B.002",0,5,n.GrowsOnlyWhenTypingBefore,0,0,0,!1,0,5),e("B.003",0,5,n.GrowsOnlyWhenTypingAfter,0,0,0,!1,0,5),e("B.004",0,5,n.AlwaysGrowsWhenTypingAtEdges,0,0,0,!0,0,5),e("B.005",0,5,n.NeverGrowsWhenTypingAtEdges,0,0,0,!0,0,5),e("B.006",0,5,n.GrowsOnlyWhenTypingBefore,0,0,0,!0,0,5),e("B.007",0,5,n.GrowsOnlyWhenTypingAfter,0,0,0,!0,0,5),e("B.008",0,5,n.AlwaysGrowsWhenTypingAtEdges,0,0,1,!1,0,6),e("B.009",0,5,n.NeverGrowsWhenTypingAtEdges,0,0,1,!1,1,6),e("B.010",0,5,n.GrowsOnlyWhenTypingBefore,0,0,1,!1,0,6),e("B.011",0,5,n.GrowsOnlyWhenTypingAfter,0,0,1,!1,1,6),e("B.012",0,5,n.AlwaysGrowsWhenTypingAtEdges,0,0,1,!0,1,6),e("B.013",0,5,n.NeverGrowsWhenTypingAtEdges,0,0,1,!0,1,6),e("B.014",0,5,n.GrowsOnlyWhenTypingBefore,0,0,1,!0,1,6),e("B.015",0,5,n.GrowsOnlyWhenTypingAfter,0,0,1,!0,1,6),e("B.016",0,5,n.AlwaysGrowsWhenTypingAtEdges,2,2,1,!1,0,6),e("B.017",0,5,n.NeverGrowsWhenTypingAtEdges,2,2,1,!1,0,6),e("B.018",0,5,n.GrowsOnlyWhenTypingBefore,2,2,1,!1,0,6),e("B.019",0,5,n.GrowsOnlyWhenTypingAfter,2,2,1,!1,0,6),e("B.020",0,5,n.AlwaysGrowsWhenTypingAtEdges,2,2,1,!0,0,6),e("B.021",0,5,n.NeverGrowsWhenTypingAtEdges,2,2,1,!0,0,6),e("B.022",0,5,n.GrowsOnlyWhenTypingBefore,2,2,1,!0,0,6),e("B.023",0,5,n.GrowsOnlyWhenTypingAfter,2,2,1,!0,0,6),e("B.024",0,5,n.AlwaysGrowsWhenTypingAtEdges,5,5,1,!1,0,6),e("B.025",0,5,n.NeverGrowsWhenTypingAtEdges,5,5,1,!1,0,5),e("B.026",0,5,n.GrowsOnlyWhenTypingBefore,5,5,1,!1,0,5),e("B.027",0,5,n.GrowsOnlyWhenTypingAfter,5,5,1,!1,0,6),e("B.028",0,5,n.AlwaysGrowsWhenTypingAtEdges,5,5,1,!0,0,6),e("B.029",0,5,n.NeverGrowsWhenTypingAtEdges,5,5,1,!0,0,6),e("B.030",0,5,n.GrowsOnlyWhenTypingBefore,5,5,1,!0,0,6),e("B.031",0,5,n.GrowsOnlyWhenTypingAfter,5,5,1,!0,0,6),e("B.032",5,10,n.AlwaysGrowsWhenTypingAtEdges,4,5,2,!1,5,11),e("B.033",5,10,n.NeverGrowsWhenTypingAtEdges,4,5,2,!1,6,11),e("B.034",5,10,n.GrowsOnlyWhenTypingBefore,4,5,2,!1,5,11),e("B.035",5,10,n.GrowsOnlyWhenTypingAfter,4,5,2,!1,6,11),e("B.036",5,10,n.AlwaysGrowsWhenTypingAtEdges,4,5,2,!0,6,11),e("B.037",5,10,n.NeverGrowsWhenTypingAtEdges,4,5,2,!0,6,11),e("B.038",5,10,n.GrowsOnlyWhenTypingBefore,4,5,2,!0,6,11),e("B.039",5,10,n.GrowsOnlyWhenTypingAfter,4,5,2,!0,6,11),e("B.040",5,10,n.AlwaysGrowsWhenTypingAtEdges,3,5,1,!1,4,9),e("B.041",5,10,n.NeverGrowsWhenTypingAtEdges,3,5,1,!1,4,9),e("B.042",5,10,n.GrowsOnlyWhenTypingBefore,3,5,1,!1,4,9),e("B.043",5,10,n.GrowsOnlyWhenTypingAfter,3,5,1,!1,4,9),e("B.044",5,10,n.AlwaysGrowsWhenTypingAtEdges,3,5,1,!0,4,9),e("B.045",5,10,n.NeverGrowsWhenTypingAtEdges,3,5,1,!0,4,9),e("B.046",5,10,n.GrowsOnlyWhenTypingBefore,3,5,1,!0,4,9),e("B.047",5,10,n.GrowsOnlyWhenTypingAfter,3,5,1,!0,4,9),e("B.048",5,10,n.AlwaysGrowsWhenTypingAtEdges,4,6,3,!1,5,11),e("B.049",5,10,n.NeverGrowsWhenTypingAtEdges,4,6,3,!1,5,11),e("B.050",5,10,n.GrowsOnlyWhenTypingBefore,4,6,3,!1,5,11),e("B.051",5,10,n.GrowsOnlyWhenTypingAfter,4,6,3,!1,5,11),e("B.052",5,10,n.AlwaysGrowsWhenTypingAtEdges,4,6,3,!0,7,11),e("B.053",5,10,n.NeverGrowsWhenTypingAtEdges,4,6,3,!0,7,11),e("B.054",5,10,n.GrowsOnlyWhenTypingBefore,4,6,3,!0,7,11),e("B.055",5,10,n.GrowsOnlyWhenTypingAfter,4,6,3,!0,7,11),e("B.056",5,10,n.AlwaysGrowsWhenTypingAtEdges,4,6,1,!1,5,9),e("B.057",5,10,n.NeverGrowsWhenTypingAtEdges,4,6,1,!1,5,9),e("B.058",5,10,n.GrowsOnlyWhenTypingBefore,4,6,1,!1,5,9),e("B.059",5,10,n.GrowsOnlyWhenTypingAfter,4,6,1,!1,5,9),e("B.060",5,10,n.AlwaysGrowsWhenTypingAtEdges,4,6,1,!0,5,9),e("B.061",5,10,n.NeverGrowsWhenTypingAtEdges,4,6,1,!0,5,9),e("B.062",5,10,n.GrowsOnlyWhenTypingBefore,4,6,1,!0,5,9),e("B.063",5,10,n.GrowsOnlyWhenTypingAfter,4,6,1,!0,5,9),e("B.064",5,10,n.AlwaysGrowsWhenTypingAtEdges,5,6,2,!1,5,11),e("B.065",5,10,n.NeverGrowsWhenTypingAtEdges,5,6,2,!1,5,11),e("B.066",5,10,n.GrowsOnlyWhenTypingBefore,5,6,2,!1,5,11),e("B.067",5,10,n.GrowsOnlyWhenTypingAfter,5,6,2,!1,5,11),e("B.068",5,10,n.AlwaysGrowsWhenTypingAtEdges,5,6,2,!0,7,11),e("B.069",5,10,n.NeverGrowsWhenTypingAtEdges,5,6,2,!0,7,11),e("B.070",5,10,n.GrowsOnlyWhenTypingBefore,5,6,2,!0,7,11),e("B.071",5,10,n.GrowsOnlyWhenTypingAfter,5,6,2,!0,7,11),e("B.072",5,10,n.AlwaysGrowsWhenTypingAtEdges,5,7,1,!1,5,9),e("B.073",5,10,n.NeverGrowsWhenTypingAtEdges,5,7,1,!1,5,9),e("B.074",5,10,n.GrowsOnlyWhenTypingBefore,5,7,1,!1,5,9),e("B.075",5,10,n.GrowsOnlyWhenTypingAfter,5,7,1,!1,5,9),e("B.076",5,10,n.AlwaysGrowsWhenTypingAtEdges,5,7,1,!0,6,9),e("B.077",5,10,n.NeverGrowsWhenTypingAtEdges,5,7,1,!0,6,9),e("B.078",5,10,n.GrowsOnlyWhenTypingBefore,5,7,1,!0,6,9),e("B.079",5,10,n.GrowsOnlyWhenTypingAfter,5,7,1,!0,6,9),e("B.080",5,10,n.AlwaysGrowsWhenTypingAtEdges,9,10,2,!1,5,11),e("B.081",5,10,n.NeverGrowsWhenTypingAtEdges,9,10,2,!1,5,10),e("B.082",5,10,n.GrowsOnlyWhenTypingBefore,9,10,2,!1,5,10),e("B.083",5,10,n.GrowsOnlyWhenTypingAfter,9,10,2,!1,5,11),e("B.084",5,10,n.AlwaysGrowsWhenTypingAtEdges,9,10,2,!0,5,11),e("B.085",5,10,n.NeverGrowsWhenTypingAtEdges,9,10,2,!0,5,11),e("B.086",5,10,n.GrowsOnlyWhenTypingBefore,9,10,2,!0,5,11),e("B.087",5,10,n.GrowsOnlyWhenTypingAfter,9,10,2,!0,5,11),e("B.088",5,10,n.AlwaysGrowsWhenTypingAtEdges,8,10,1,!1,5,9),e("B.089",5,10,n.NeverGrowsWhenTypingAtEdges,8,10,1,!1,5,9),e("B.090",5,10,n.GrowsOnlyWhenTypingBefore,8,10,1,!1,5,9),e("B.091",5,10,n.GrowsOnlyWhenTypingAfter,8,10,1,!1,5,9),e("B.092",5,10,n.AlwaysGrowsWhenTypingAtEdges,8,10,1,!0,5,9),e("B.093",5,10,n.NeverGrowsWhenTypingAtEdges,8,10,1,!0,5,9),e("B.094",5,10,n.GrowsOnlyWhenTypingBefore,8,10,1,!0,5,9),e("B.095",5,10,n.GrowsOnlyWhenTypingAfter,8,10,1,!0,5,9),e("B.096",5,10,n.AlwaysGrowsWhenTypingAtEdges,9,11,3,!1,5,10),e("B.097",5,10,n.NeverGrowsWhenTypingAtEdges,9,11,3,!1,5,10),e("B.098",5,10,n.GrowsOnlyWhenTypingBefore,9,11,3,!1,5,10),e("B.099",5,10,n.GrowsOnlyWhenTypingAfter,9,11,3,!1,5,10),e("B.100",5,10,n.AlwaysGrowsWhenTypingAtEdges,9,11,3,!0,5,12),e("B.101",5,10,n.NeverGrowsWhenTypingAtEdges,9,11,3,!0,5,12),e("B.102",5,10,n.GrowsOnlyWhenTypingBefore,9,11,3,!0,5,12),e("B.103",5,10,n.GrowsOnlyWhenTypingAfter,9,11,3,!0,5,12),e("B.104",5,10,n.AlwaysGrowsWhenTypingAtEdges,9,11,1,!1,5,10),e("B.105",5,10,n.NeverGrowsWhenTypingAtEdges,9,11,1,!1,5,10),e("B.106",5,10,n.GrowsOnlyWhenTypingBefore,9,11,1,!1,5,10),e("B.107",5,10,n.GrowsOnlyWhenTypingAfter,9,11,1,!1,5,10),e("B.108",5,10,n.AlwaysGrowsWhenTypingAtEdges,9,11,1,!0,5,10),e("B.109",5,10,n.NeverGrowsWhenTypingAtEdges,9,11,1,!0,5,10),e("B.110",5,10,n.GrowsOnlyWhenTypingBefore,9,11,1,!0,5,10),e("B.111",5,10,n.GrowsOnlyWhenTypingAfter,9,11,1,!0,5,10),e("B.112",5,10,n.AlwaysGrowsWhenTypingAtEdges,10,11,3,!1,5,10),e("B.113",5,10,n.NeverGrowsWhenTypingAtEdges,10,11,3,!1,5,10),e("B.114",5,10,n.GrowsOnlyWhenTypingBefore,10,11,3,!1,5,10),e("B.115",5,10,n.GrowsOnlyWhenTypingAfter,10,11,3,!1,5,10),e("B.116",5,10,n.AlwaysGrowsWhenTypingAtEdges,10,11,3,!0,5,13),e("B.117",5,10,n.NeverGrowsWhenTypingAtEdges,10,11,3,!0,5,13),e("B.118",5,10,n.GrowsOnlyWhenTypingBefore,10,11,3,!0,5,13),e("B.119",5,10,n.GrowsOnlyWhenTypingAfter,10,11,3,!0,5,13),e("B.120",5,10,n.AlwaysGrowsWhenTypingAtEdges,10,12,1,!1,5,10),e("B.121",5,10,n.NeverGrowsWhenTypingAtEdges,10,12,1,!1,5,10),e("B.122",5,10,n.GrowsOnlyWhenTypingBefore,10,12,1,!1,5,10),e("B.123",5,10,n.GrowsOnlyWhenTypingAfter,10,12,1,!1,5,10),e("B.124",5,10,n.AlwaysGrowsWhenTypingAtEdges,10,12,1,!0,5,11),e("B.125",5,10,n.NeverGrowsWhenTypingAtEdges,10,12,1,!0,5,11),e("B.126",5,10,n.GrowsOnlyWhenTypingBefore,10,12,1,!0,5,11),e("B.127",5,10,n.GrowsOnlyWhenTypingAfter,10,12,1,!0,5,11),e("B.128",5,10,n.AlwaysGrowsWhenTypingAtEdges,4,5,0,!1,4,9),e("B.129",5,10,n.NeverGrowsWhenTypingAtEdges,4,5,0,!1,4,9),e("B.130",5,10,n.GrowsOnlyWhenTypingBefore,4,5,0,!1,4,9),e("B.131",5,10,n.GrowsOnlyWhenTypingAfter,4,5,0,!1,4,9),e("B.132",5,10,n.AlwaysGrowsWhenTypingAtEdges,4,5,0,!0,4,9),e("B.133",5,10,n.NeverGrowsWhenTypingAtEdges,4,5,0,!0,4,9),e("B.134",5,10,n.GrowsOnlyWhenTypingBefore,4,5,0,!0,4,9),e("B.135",5,10,n.GrowsOnlyWhenTypingAfter,4,5,0,!0,4,9),e("B.136",5,10,n.AlwaysGrowsWhenTypingAtEdges,4,6,0,!1,4,8),e("B.137",5,10,n.NeverGrowsWhenTypingAtEdges,4,6,0,!1,4,8),e("B.138",5,10,n.GrowsOnlyWhenTypingBefore,4,6,0,!1,4,8),e("B.139",5,10,n.GrowsOnlyWhenTypingAfter,4,6,0,!1,4,8),e("B.140",5,10,n.AlwaysGrowsWhenTypingAtEdges,4,6,0,!0,4,8),e("B.141",5,10,n.NeverGrowsWhenTypingAtEdges,4,6,0,!0,4,8),e("B.142",5,10,n.GrowsOnlyWhenTypingBefore,4,6,0,!0,4,8),e("B.143",5,10,n.GrowsOnlyWhenTypingAfter,4,6,0,!0,4,8),e("B.144",5,10,n.AlwaysGrowsWhenTypingAtEdges,5,6,0,!1,5,9),e("B.145",5,10,n.NeverGrowsWhenTypingAtEdges,5,6,0,!1,5,9),e("B.146",5,10,n.GrowsOnlyWhenTypingBefore,5,6,0,!1,5,9),e("B.147",5,10,n.GrowsOnlyWhenTypingAfter,5,6,0,!1,5,9),e("B.148",5,10,n.AlwaysGrowsWhenTypingAtEdges,5,6,0,!0,5,9),e("B.149",5,10,n.NeverGrowsWhenTypingAtEdges,5,6,0,!0,5,9),e("B.150",5,10,n.GrowsOnlyWhenTypingBefore,5,6,0,!0,5,9),e("B.151",5,10,n.GrowsOnlyWhenTypingAfter,5,6,0,!0,5,9),e("B.152",5,10,n.AlwaysGrowsWhenTypingAtEdges,9,10,0,!1,5,9),e("B.153",5,10,n.NeverGrowsWhenTypingAtEdges,9,10,0,!1,5,9),e("B.154",5,10,n.GrowsOnlyWhenTypingBefore,9,10,0,!1,5,9),e("B.155",5,10,n.GrowsOnlyWhenTypingAfter,9,10,0,!1,5,9),e("B.156",5,10,n.AlwaysGrowsWhenTypingAtEdges,9,10,0,!0,5,9),e("B.157",5,10,n.NeverGrowsWhenTypingAtEdges,9,10,0,!0,5,9),e("B.158",5,10,n.GrowsOnlyWhenTypingBefore,9,10,0,!0,5,9),e("B.159",5,10,n.GrowsOnlyWhenTypingAfter,9,10,0,!0,5,9),e("B.160",5,10,n.AlwaysGrowsWhenTypingAtEdges,9,11,0,!1,5,9),e("B.161",5,10,n.NeverGrowsWhenTypingAtEdges,9,11,0,!1,5,9),e("B.162",5,10,n.GrowsOnlyWhenTypingBefore,9,11,0,!1,5,9),e("B.163",5,10,n.GrowsOnlyWhenTypingAfter,9,11,0,!1,5,9),e("B.164",5,10,n.AlwaysGrowsWhenTypingAtEdges,9,11,0,!0,5,9),e("B.165",5,10,n.NeverGrowsWhenTypingAtEdges,9,11,0,!0,5,9),e("B.166",5,10,n.GrowsOnlyWhenTypingBefore,9,11,0,!0,5,9),e("B.167",5,10,n.GrowsOnlyWhenTypingAfter,9,11,0,!0,5,9),e("B.168",5,10,n.AlwaysGrowsWhenTypingAtEdges,10,11,0,!1,5,10),e("B.169",5,10,n.NeverGrowsWhenTypingAtEdges,10,11,0,!1,5,10),e("B.170",5,10,n.GrowsOnlyWhenTypingBefore,10,11,0,!1,5,10),e("B.171",5,10,n.GrowsOnlyWhenTypingAfter,10,11,0,!1,5,10),e("B.172",5,10,n.AlwaysGrowsWhenTypingAtEdges,10,11,0,!0,5,10),e("B.173",5,10,n.NeverGrowsWhenTypingAtEdges,10,11,0,!0,5,10),e("B.174",5,10,n.GrowsOnlyWhenTypingBefore,10,11,0,!0,5,10),e("B.175",5,10,n.GrowsOnlyWhenTypingAfter,10,11,0,!0,5,10),e("B.176",5,10,n.AlwaysGrowsWhenTypingAtEdges,5,10,3,!1,5,8),e("B.177",5,10,n.NeverGrowsWhenTypingAtEdges,5,10,3,!1,5,8),e("B.178",5,10,n.GrowsOnlyWhenTypingBefore,5,10,3,!1,5,8),e("B.179",5,10,n.GrowsOnlyWhenTypingAfter,5,10,3,!1,5,8),e("B.180",5,10,n.AlwaysGrowsWhenTypingAtEdges,5,10,3,!0,8,8),e("B.181",5,10,n.NeverGrowsWhenTypingAtEdges,5,10,3,!0,8,8),e("B.182",5,10,n.GrowsOnlyWhenTypingBefore,5,10,3,!0,8,8),e("B.183",5,10,n.GrowsOnlyWhenTypingAfter,5,10,3,!0,8,8),e("B.184",5,10,n.AlwaysGrowsWhenTypingAtEdges,5,10,7,!1,5,12),e("B.185",5,10,n.NeverGrowsWhenTypingAtEdges,5,10,7,!1,5,10),e("B.186",5,10,n.GrowsOnlyWhenTypingBefore,5,10,7,!1,5,10),e("B.187",5,10,n.GrowsOnlyWhenTypingAfter,5,10,7,!1,5,12),e("B.188",5,10,n.AlwaysGrowsWhenTypingAtEdges,5,10,7,!0,12,12),e("B.189",5,10,n.NeverGrowsWhenTypingAtEdges,5,10,7,!0,12,12),e("B.190",5,10,n.GrowsOnlyWhenTypingBefore,5,10,7,!0,12,12),e("B.191",5,10,n.GrowsOnlyWhenTypingAfter,5,10,7,!0,12,12)})});function L(e){if(e.root===a){console.log("~~ empty");return}const i=[];O(e,e.root,"",0,i),console.log(i.join(""))}function O(e,i,d,s,o){o.push(`${d}[${w(i)===f.Red?"R":"B"},${i.delta}, ${i.start}->${i.end}, ${i.maxEnd}] : {${s+i.start}->${s+i.end}}, maxEnd: ${i.maxEnd+s}
`),i.left!==a?O(e,i.left,d+"    ",s,o):o.push(`${d}    NIL
`),i.right!==a?O(e,i.right,d+"    ",s+i.delta,o):o.push(`${d}    NIL
`)}function q(e){l(w(a)===f.Black),l(a.parent===a),l(a.left===a),l(a.right===a),l(a.start===0),l(a.end===0),l(a.delta===0),l(e.root.parent===a),V(e)}function A(e){return e===a?1:(l(A(e.left)===A(e.right)),(w(e)===f.Black?1:0)+A(e.left))}function v(e,i){if(e===a)return;const d=e.left,s=e.right;w(e)===f.Red&&(l(w(d)===f.Black),l(w(s)===f.Black));let o=e.end;d!==a&&(l(I(d.start+i,d.end+i,e.start+i,e.end+i)<=0),o=Math.max(o,d.maxEnd)),s!==a&&(l(I(e.start+i,e.end+i,s.start+i+e.delta,s.end+i+e.delta)<=0),o=Math.max(o,s.maxEnd+e.delta)),l(e.maxEnd===o),v(d,i),v(s,i+e.delta)}function V(e){e.root!==a&&(l(w(e.root)===f.Black),l(A(e.root.left)===A(e.root.right)),v(e.root,0))}
