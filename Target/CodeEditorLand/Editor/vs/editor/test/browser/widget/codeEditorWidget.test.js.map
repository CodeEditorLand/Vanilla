{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/editor/test/browser/widget/codeEditorWidget.test.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../base/test/common/utils.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { ILanguageService } from '../../../common/languages/language.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { withTestCodeEditor } from '../testCodeEditor.js';\n\nsuite('CodeEditorWidget', () => {\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('onDidChangeModelDecorations', () => {\n\t\twithTestCodeEditor('', {}, (editor, viewModel) => {\n\t\t\tconst disposables = new DisposableStore();\n\n\t\t\tlet invoked = false;\n\t\t\tdisposables.add(editor.onDidChangeModelDecorations((e) => {\n\t\t\t\tinvoked = true;\n\t\t\t}));\n\n\t\t\tviewModel.model.deltaDecorations([], [{ range: new Range(1, 1, 1, 1), options: { description: 'test' } }]);\n\n\t\t\tassert.deepStrictEqual(invoked, true);\n\n\t\t\tdisposables.dispose();\n\t\t});\n\t});\n\n\ttest('onDidChangeModelLanguage', () => {\n\t\twithTestCodeEditor('', {}, (editor, viewModel, instantiationService) => {\n\t\t\tconst languageService = instantiationService.get(ILanguageService);\n\t\t\tconst disposables = new DisposableStore();\n\t\t\tdisposables.add(languageService.registerLanguage({ id: 'testMode' }));\n\n\t\t\tlet invoked = false;\n\t\t\tdisposables.add(editor.onDidChangeModelLanguage((e) => {\n\t\t\t\tinvoked = true;\n\t\t\t}));\n\n\t\t\tviewModel.model.setLanguage('testMode');\n\n\t\t\tassert.deepStrictEqual(invoked, true);\n\n\t\t\tdisposables.dispose();\n\t\t});\n\t});\n\n\ttest('onDidChangeModelLanguageConfiguration', () => {\n\t\twithTestCodeEditor('', {}, (editor, viewModel, instantiationService) => {\n\t\t\tconst languageConfigurationService = instantiationService.get(ILanguageConfigurationService);\n\t\t\tconst languageService = instantiationService.get(ILanguageService);\n\t\t\tconst disposables = new DisposableStore();\n\t\t\tdisposables.add(languageService.registerLanguage({ id: 'testMode' }));\n\t\t\tviewModel.model.setLanguage('testMode');\n\n\t\t\tlet invoked = false;\n\t\t\tdisposables.add(editor.onDidChangeModelLanguageConfiguration((e) => {\n\t\t\t\tinvoked = true;\n\t\t\t}));\n\n\t\t\tdisposables.add(languageConfigurationService.register('testMode', {\n\t\t\t\tbrackets: [['(', ')']]\n\t\t\t}));\n\n\t\t\tassert.deepStrictEqual(invoked, true);\n\n\t\t\tdisposables.dispose();\n\t\t});\n\t});\n\n\ttest('onDidChangeModelContent', () => {\n\t\twithTestCodeEditor('', {}, (editor, viewModel) => {\n\t\t\tconst disposables = new DisposableStore();\n\n\t\t\tlet invoked = false;\n\t\t\tdisposables.add(editor.onDidChangeModelContent((e) => {\n\t\t\t\tinvoked = true;\n\t\t\t}));\n\n\t\t\tviewModel.type('hello', 'test');\n\n\t\t\tassert.deepStrictEqual(invoked, true);\n\n\t\t\tdisposables.dispose();\n\t\t});\n\t});\n\n\ttest('onDidChangeModelOptions', () => {\n\t\twithTestCodeEditor('', {}, (editor, viewModel) => {\n\t\t\tconst disposables = new DisposableStore();\n\n\t\t\tlet invoked = false;\n\t\t\tdisposables.add(editor.onDidChangeModelOptions((e) => {\n\t\t\t\tinvoked = true;\n\t\t\t}));\n\n\t\t\tviewModel.model.updateOptions({\n\t\t\t\ttabSize: 3\n\t\t\t});\n\n\t\t\tassert.deepStrictEqual(invoked, true);\n\n\t\t\tdisposables.dispose();\n\t\t});\n\t});\n\n\ttest('issue #145872 - Model change events are emitted before the selection updates', () => {\n\t\twithTestCodeEditor('', {}, (editor, viewModel) => {\n\t\t\tconst disposables = new DisposableStore();\n\n\t\t\tlet observedSelection: Selection | null = null;\n\t\t\tdisposables.add(editor.onDidChangeModelContent((e) => {\n\t\t\t\tobservedSelection = editor.getSelection();\n\t\t\t}));\n\n\t\t\tviewModel.type('hello', 'test');\n\n\t\t\tassert.deepStrictEqual(observedSelection, new Selection(1, 6, 1, 6));\n\n\t\t\tdisposables.dispose();\n\t\t});\n\t});\n\n\ttest('monaco-editor issue #2774 - Wrong order of events onDidChangeModelContent and onDidChangeCursorSelection on redo', () => {\n\t\twithTestCodeEditor('', {}, (editor, viewModel) => {\n\t\t\tconst disposables = new DisposableStore();\n\n\t\t\tconst calls: string[] = [];\n\t\t\tdisposables.add(editor.onDidChangeModelContent((e) => {\n\t\t\t\tcalls.push(`contentchange(${e.changes.reduce<any[]>((aggr, c) => [...aggr, c.text, c.rangeOffset, c.rangeLength], []).join(', ')})`);\n\t\t\t}));\n\t\t\tdisposables.add(editor.onDidChangeCursorSelection((e) => {\n\t\t\t\tcalls.push(`cursorchange(${e.selection.positionLineNumber}, ${e.selection.positionColumn})`);\n\t\t\t}));\n\n\t\t\tviewModel.type('a', 'test');\n\t\t\tviewModel.model.undo();\n\t\t\tviewModel.model.redo();\n\n\t\t\tassert.deepStrictEqual(calls, [\n\t\t\t\t'contentchange(a, 0, 0)',\n\t\t\t\t'cursorchange(1, 2)',\n\t\t\t\t'contentchange(, 0, 1)',\n\t\t\t\t'cursorchange(1, 1)',\n\t\t\t\t'contentchange(a, 0, 0)',\n\t\t\t\t'cursorchange(1, 2)'\n\t\t\t]);\n\n\t\t\tdisposables.dispose();\n\t\t});\n\t});\n\n\ttest('issue #146174: Events delivered out of order when adding decorations in content change listener (1 of 2)', () => {\n\t\twithTestCodeEditor('', {}, (editor, viewModel) => {\n\t\t\tconst disposables = new DisposableStore();\n\n\t\t\tconst calls: string[] = [];\n\t\t\tdisposables.add(editor.onDidChangeModelContent((e) => {\n\t\t\t\tcalls.push(`listener1 - contentchange(${e.changes.reduce<any[]>((aggr, c) => [...aggr, c.text, c.rangeOffset, c.rangeLength], []).join(', ')})`);\n\t\t\t}));\n\t\t\tdisposables.add(editor.onDidChangeCursorSelection((e) => {\n\t\t\t\tcalls.push(`listener1 - cursorchange(${e.selection.positionLineNumber}, ${e.selection.positionColumn})`);\n\t\t\t}));\n\t\t\tdisposables.add(editor.onDidChangeModelContent((e) => {\n\t\t\t\tcalls.push(`listener2 - contentchange(${e.changes.reduce<any[]>((aggr, c) => [...aggr, c.text, c.rangeOffset, c.rangeLength], []).join(', ')})`);\n\t\t\t}));\n\t\t\tdisposables.add(editor.onDidChangeCursorSelection((e) => {\n\t\t\t\tcalls.push(`listener2 - cursorchange(${e.selection.positionLineNumber}, ${e.selection.positionColumn})`);\n\t\t\t}));\n\n\t\t\tviewModel.type('a', 'test');\n\n\t\t\tassert.deepStrictEqual(calls, ([\n\t\t\t\t'listener1 - contentchange(a, 0, 0)',\n\t\t\t\t'listener2 - contentchange(a, 0, 0)',\n\t\t\t\t'listener1 - cursorchange(1, 2)',\n\t\t\t\t'listener2 - cursorchange(1, 2)',\n\t\t\t]));\n\n\t\t\tdisposables.dispose();\n\t\t});\n\t});\n\n\ttest('issue #146174: Events delivered out of order when adding decorations in content change listener (2 of 2)', () => {\n\t\twithTestCodeEditor('', {}, (editor, viewModel) => {\n\t\t\tconst disposables = new DisposableStore();\n\n\t\t\tconst calls: string[] = [];\n\t\t\tdisposables.add(editor.onDidChangeModelContent((e) => {\n\t\t\t\tcalls.push(`listener1 - contentchange(${e.changes.reduce<any[]>((aggr, c) => [...aggr, c.text, c.rangeOffset, c.rangeLength], []).join(', ')})`);\n\t\t\t\teditor.changeDecorations((changeAccessor) => {\n\t\t\t\t\tchangeAccessor.deltaDecorations([], [{ range: new Range(1, 1, 1, 1), options: { description: 'test' } }]);\n\t\t\t\t});\n\t\t\t}));\n\t\t\tdisposables.add(editor.onDidChangeCursorSelection((e) => {\n\t\t\t\tcalls.push(`listener1 - cursorchange(${e.selection.positionLineNumber}, ${e.selection.positionColumn})`);\n\t\t\t}));\n\t\t\tdisposables.add(editor.onDidChangeModelContent((e) => {\n\t\t\t\tcalls.push(`listener2 - contentchange(${e.changes.reduce<any[]>((aggr, c) => [...aggr, c.text, c.rangeOffset, c.rangeLength], []).join(', ')})`);\n\t\t\t}));\n\t\t\tdisposables.add(editor.onDidChangeCursorSelection((e) => {\n\t\t\t\tcalls.push(`listener2 - cursorchange(${e.selection.positionLineNumber}, ${e.selection.positionColumn})`);\n\t\t\t}));\n\n\t\t\tviewModel.type('a', 'test');\n\n\t\t\tassert.deepStrictEqual(calls, ([\n\t\t\t\t'listener1 - contentchange(a, 0, 0)',\n\t\t\t\t'listener2 - contentchange(a, 0, 0)',\n\t\t\t\t'listener1 - cursorchange(1, 2)',\n\t\t\t\t'listener2 - cursorchange(1, 2)',\n\t\t\t]));\n\n\t\t\tdisposables.dispose();\n\t\t});\n\t});\n\n});\n"],
  "mappings": "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",
  "names": []
}
