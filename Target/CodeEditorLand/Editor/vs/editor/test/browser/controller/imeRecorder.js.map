{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/editor/test/browser/controller/imeRecorder.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { IRecorded, IRecordedCompositionEvent, IRecordedEvent, IRecordedInputEvent, IRecordedKeyboardEvent, IRecordedTextareaState } from './imeRecordedTypes.js';\nimport * as browser from '../../../../base/browser/browser.js';\nimport * as platform from '../../../../base/common/platform.js';\nimport { mainWindow } from '../../../../base/browser/window.js';\nimport { TextAreaWrapper } from '../../../browser/controller/editContext/textArea/textAreaEditContextInput.js';\n\n(() => {\n\n\tconst startButton = <HTMLButtonElement>mainWindow.document.getElementById('startRecording')!;\n\tconst endButton = <HTMLButtonElement>mainWindow.document.getElementById('endRecording')!;\n\n\tlet inputarea: HTMLTextAreaElement;\n\tconst disposables = new DisposableStore();\n\tlet originTimeStamp = 0;\n\tlet recorded: IRecorded = {\n\t\tenv: null!,\n\t\tinitial: null!,\n\t\tevents: [],\n\t\tfinal: null!\n\t};\n\n\tconst readTextareaState = (): IRecordedTextareaState => {\n\t\treturn {\n\t\t\tselectionDirection: inputarea.selectionDirection,\n\t\t\tselectionEnd: inputarea.selectionEnd,\n\t\t\tselectionStart: inputarea.selectionStart,\n\t\t\tvalue: inputarea.value,\n\t\t};\n\t};\n\n\tstartButton.onclick = () => {\n\t\tdisposables.clear();\n\t\tstartTest();\n\t\toriginTimeStamp = 0;\n\t\trecorded = {\n\t\t\tenv: {\n\t\t\t\tOS: platform.OS,\n\t\t\t\tbrowser: {\n\t\t\t\t\tisAndroid: browser.isAndroid,\n\t\t\t\t\tisFirefox: browser.isFirefox,\n\t\t\t\t\tisChrome: browser.isChrome,\n\t\t\t\t\tisSafari: browser.isSafari\n\t\t\t\t}\n\t\t\t},\n\t\t\tinitial: readTextareaState(),\n\t\t\tevents: [],\n\t\t\tfinal: null!\n\t\t};\n\t};\n\tendButton.onclick = () => {\n\t\trecorded.final = readTextareaState();\n\t\tconsole.log(printRecordedData());\n\t};\n\n\tfunction printRecordedData() {\n\t\tconst lines = [];\n\t\tlines.push(`const recorded: IRecorded = {`);\n\t\tlines.push(`\\tenv: ${JSON.stringify(recorded.env)}, `);\n\t\tlines.push(`\\tinitial: ${printState(recorded.initial)}, `);\n\t\tlines.push(`\\tevents: [\\n\\t\\t${recorded.events.map(ev => printEvent(ev)).join(',\\n\\t\\t')}\\n\\t],`);\n\t\tlines.push(`\\tfinal: ${printState(recorded.final)},`);\n\t\tlines.push(`}`);\n\n\t\treturn lines.join('\\n');\n\n\t\tfunction printString(str: string) {\n\t\t\treturn str.replace(/\\\\/g, '\\\\\\\\').replace(/'/g, '\\\\\\'');\n\t\t}\n\t\tfunction printState(state: IRecordedTextareaState) {\n\t\t\treturn `{ value: '${printString(state.value)}', selectionStart: ${state.selectionStart}, selectionEnd: ${state.selectionEnd}, selectionDirection: '${state.selectionDirection}' }`;\n\t\t}\n\t\tfunction printEvent(ev: IRecordedEvent) {\n\t\t\tif (ev.type === 'keydown' || ev.type === 'keypress' || ev.type === 'keyup') {\n\t\t\t\treturn `{ timeStamp: ${ev.timeStamp.toFixed(2)}, state: ${printState(ev.state)}, type: '${ev.type}', altKey: ${ev.altKey}, charCode: ${ev.charCode}, code: '${ev.code}', ctrlKey: ${ev.ctrlKey}, isComposing: ${ev.isComposing}, key: '${ev.key}', keyCode: ${ev.keyCode}, location: ${ev.location}, metaKey: ${ev.metaKey}, repeat: ${ev.repeat}, shiftKey: ${ev.shiftKey} }`;\n\t\t\t}\n\t\t\tif (ev.type === 'compositionstart' || ev.type === 'compositionupdate' || ev.type === 'compositionend') {\n\t\t\t\treturn `{ timeStamp: ${ev.timeStamp.toFixed(2)}, state: ${printState(ev.state)}, type: '${ev.type}', data: '${printString(ev.data)}' }`;\n\t\t\t}\n\t\t\tif (ev.type === 'beforeinput' || ev.type === 'input') {\n\t\t\t\treturn `{ timeStamp: ${ev.timeStamp.toFixed(2)}, state: ${printState(ev.state)}, type: '${ev.type}', data: ${ev.data === null ? 'null' : `'${printString(ev.data)}'`}, inputType: '${ev.inputType}', isComposing: ${ev.isComposing} }`;\n\t\t\t}\n\t\t\treturn JSON.stringify(ev);\n\t\t}\n\t}\n\n\tfunction startTest() {\n\t\tinputarea = document.createElement('textarea');\n\t\tmainWindow.document.body.appendChild(inputarea);\n\t\tinputarea.focus();\n\t\tdisposables.add(toDisposable(() => {\n\t\t\tinputarea.remove();\n\t\t}));\n\t\tconst wrapper = disposables.add(new TextAreaWrapper(inputarea));\n\n\t\twrapper.setValue('', `aaaa`);\n\t\twrapper.setSelectionRange('', 2, 2);\n\n\t\tconst recordEvent = (e: IRecordedEvent) => {\n\t\t\trecorded.events.push(e);\n\t\t};\n\n\t\tconst recordKeyboardEvent = (e: KeyboardEvent): void => {\n\t\t\tif (e.type !== 'keydown' && e.type !== 'keypress' && e.type !== 'keyup') {\n\t\t\t\tthrow new Error(`Not supported!`);\n\t\t\t}\n\t\t\tif (originTimeStamp === 0) {\n\t\t\t\toriginTimeStamp = e.timeStamp;\n\t\t\t}\n\t\t\tconst ev: IRecordedKeyboardEvent = {\n\t\t\t\ttimeStamp: e.timeStamp - originTimeStamp,\n\t\t\t\tstate: readTextareaState(),\n\t\t\t\ttype: e.type,\n\t\t\t\taltKey: e.altKey,\n\t\t\t\tcharCode: e.charCode,\n\t\t\t\tcode: e.code,\n\t\t\t\tctrlKey: e.ctrlKey,\n\t\t\t\tisComposing: e.isComposing,\n\t\t\t\tkey: e.key,\n\t\t\t\tkeyCode: e.keyCode,\n\t\t\t\tlocation: e.location,\n\t\t\t\tmetaKey: e.metaKey,\n\t\t\t\trepeat: e.repeat,\n\t\t\t\tshiftKey: e.shiftKey\n\t\t\t};\n\t\t\trecordEvent(ev);\n\t\t};\n\n\t\tconst recordCompositionEvent = (e: CompositionEvent): void => {\n\t\t\tif (e.type !== 'compositionstart' && e.type !== 'compositionupdate' && e.type !== 'compositionend') {\n\t\t\t\tthrow new Error(`Not supported!`);\n\t\t\t}\n\t\t\tif (originTimeStamp === 0) {\n\t\t\t\toriginTimeStamp = e.timeStamp;\n\t\t\t}\n\t\t\tconst ev: IRecordedCompositionEvent = {\n\t\t\t\ttimeStamp: e.timeStamp - originTimeStamp,\n\t\t\t\tstate: readTextareaState(),\n\t\t\t\ttype: e.type,\n\t\t\t\tdata: e.data,\n\t\t\t};\n\t\t\trecordEvent(ev);\n\t\t};\n\n\t\tconst recordInputEvent = (e: InputEvent): void => {\n\t\t\tif (e.type !== 'beforeinput' && e.type !== 'input') {\n\t\t\t\tthrow new Error(`Not supported!`);\n\t\t\t}\n\t\t\tif (originTimeStamp === 0) {\n\t\t\t\toriginTimeStamp = e.timeStamp;\n\t\t\t}\n\t\t\tconst ev: IRecordedInputEvent = {\n\t\t\t\ttimeStamp: e.timeStamp - originTimeStamp,\n\t\t\t\tstate: readTextareaState(),\n\t\t\t\ttype: e.type,\n\t\t\t\tdata: e.data,\n\t\t\t\tinputType: e.inputType,\n\t\t\t\tisComposing: e.isComposing,\n\t\t\t};\n\t\t\trecordEvent(ev);\n\t\t};\n\n\t\twrapper.onKeyDown(recordKeyboardEvent);\n\t\twrapper.onKeyPress(recordKeyboardEvent);\n\t\twrapper.onKeyUp(recordKeyboardEvent);\n\t\twrapper.onCompositionStart(recordCompositionEvent);\n\t\twrapper.onCompositionUpdate(recordCompositionEvent);\n\t\twrapper.onCompositionEnd(recordCompositionEvent);\n\t\twrapper.onBeforeInput(recordInputEvent);\n\t\twrapper.onInput(recordInputEvent);\n\t}\n\n})();\n"],
  "mappings": ";;AAKA,SAAS,iBAAiB,oBAAoB;AAC9C,SAAS,WAAW,2BAA2B,gBAAgB,qBAAqB,wBAAwB,8BAA8B;AAC1I,YAAY,aAAa;AACzB,YAAY,cAAc;AAC1B,SAAS,kBAAkB;AAC3B,SAAS,uBAAuB;AAAA,CAE/B,MAAM;AAEN,QAAM,cAAiC,WAAW,SAAS,eAAe,gBAAgB;AAC1F,QAAM,YAA+B,WAAW,SAAS,eAAe,cAAc;AAEtF,MAAI;AACJ,QAAM,cAAc,IAAI,gBAAgB;AACxC,MAAI,kBAAkB;AACtB,MAAI,WAAsB;AAAA,IACzB,KAAK;AAAA,IACL,SAAS;AAAA,IACT,QAAQ,CAAC;AAAA,IACT,OAAO;AAAA,EACR;AAEA,QAAM,oBAAoB,6BAA8B;AACvD,WAAO;AAAA,MACN,oBAAoB,UAAU;AAAA,MAC9B,cAAc,UAAU;AAAA,MACxB,gBAAgB,UAAU;AAAA,MAC1B,OAAO,UAAU;AAAA,IAClB;AAAA,EACD,GAP0B;AAS1B,cAAY,UAAU,MAAM;AAC3B,gBAAY,MAAM;AAClB,cAAU;AACV,sBAAkB;AAClB,eAAW;AAAA,MACV,KAAK;AAAA,QACJ,IAAI,SAAS;AAAA,QACb,SAAS;AAAA,UACR,WAAW,QAAQ;AAAA,UACnB,WAAW,QAAQ;AAAA,UACnB,UAAU,QAAQ;AAAA,UAClB,UAAU,QAAQ;AAAA,QACnB;AAAA,MACD;AAAA,MACA,SAAS,kBAAkB;AAAA,MAC3B,QAAQ,CAAC;AAAA,MACT,OAAO;AAAA,IACR;AAAA,EACD;AACA,YAAU,UAAU,MAAM;AACzB,aAAS,QAAQ,kBAAkB;AACnC,YAAQ,IAAI,kBAAkB,CAAC;AAAA,EAChC;AAEA,WAAS,oBAAoB;AAC5B,UAAM,QAAQ,CAAC;AACf,UAAM,KAAK,+BAA+B;AAC1C,UAAM,KAAK,SAAU,KAAK,UAAU,SAAS,GAAG,CAAC,IAAI;AACrD,UAAM,KAAK,aAAc,WAAW,SAAS,OAAO,CAAC,IAAI;AACzD,UAAM,KAAK;AAAA,IAAoB,SAAS,OAAO,IAAI,QAAM,WAAW,EAAE,CAAC,EAAE,KAAK,OAAS,CAAC;AAAA,IAAQ;AAChG,UAAM,KAAK,WAAY,WAAW,SAAS,KAAK,CAAC,GAAG;AACpD,UAAM,KAAK,GAAG;AAEd,WAAO,MAAM,KAAK,IAAI;AAEtB,aAAS,YAAY,KAAa;AACjC,aAAO,IAAI,QAAQ,OAAO,MAAM,EAAE,QAAQ,MAAM,KAAM;AAAA,IACvD;AAFS;AAGT,aAAS,WAAW,OAA+B;AAClD,aAAO,aAAa,YAAY,MAAM,KAAK,CAAC,sBAAsB,MAAM,cAAc,mBAAmB,MAAM,YAAY,0BAA0B,MAAM,kBAAkB;AAAA,IAC9K;AAFS;AAGT,aAAS,WAAW,IAAoB;AACvC,UAAI,GAAG,SAAS,aAAa,GAAG,SAAS,cAAc,GAAG,SAAS,SAAS;AAC3E,eAAO,gBAAgB,GAAG,UAAU,QAAQ,CAAC,CAAC,YAAY,WAAW,GAAG,KAAK,CAAC,YAAY,GAAG,IAAI,cAAc,GAAG,MAAM,eAAe,GAAG,QAAQ,YAAY,GAAG,IAAI,eAAe,GAAG,OAAO,kBAAkB,GAAG,WAAW,WAAW,GAAG,GAAG,eAAe,GAAG,OAAO,eAAe,GAAG,QAAQ,cAAc,GAAG,OAAO,aAAa,GAAG,MAAM,eAAe,GAAG,QAAQ;AAAA,MAC3W;AACA,UAAI,GAAG,SAAS,sBAAsB,GAAG,SAAS,uBAAuB,GAAG,SAAS,kBAAkB;AACtG,eAAO,gBAAgB,GAAG,UAAU,QAAQ,CAAC,CAAC,YAAY,WAAW,GAAG,KAAK,CAAC,YAAY,GAAG,IAAI,aAAa,YAAY,GAAG,IAAI,CAAC;AAAA,MACnI;AACA,UAAI,GAAG,SAAS,iBAAiB,GAAG,SAAS,SAAS;AACrD,eAAO,gBAAgB,GAAG,UAAU,QAAQ,CAAC,CAAC,YAAY,WAAW,GAAG,KAAK,CAAC,YAAY,GAAG,IAAI,YAAY,GAAG,SAAS,OAAO,SAAS,IAAI,YAAY,GAAG,IAAI,CAAC,GAAG,iBAAiB,GAAG,SAAS,mBAAmB,GAAG,WAAW;AAAA,MACnO;AACA,aAAO,KAAK,UAAU,EAAE;AAAA,IACzB;AAXS;AAAA,EAYV;AA7BS;AA+BT,WAAS,YAAY;AACpB,gBAAY,SAAS,cAAc,UAAU;AAC7C,eAAW,SAAS,KAAK,YAAY,SAAS;AAC9C,cAAU,MAAM;AAChB,gBAAY,IAAI,aAAa,MAAM;AAClC,gBAAU,OAAO;AAAA,IAClB,CAAC,CAAC;AACF,UAAM,UAAU,YAAY,IAAI,IAAI,gBAAgB,SAAS,CAAC;AAE9D,YAAQ,SAAS,IAAI,MAAM;AAC3B,YAAQ,kBAAkB,IAAI,GAAG,CAAC;AAElC,UAAM,cAAc,wBAAC,MAAsB;AAC1C,eAAS,OAAO,KAAK,CAAC;AAAA,IACvB,GAFoB;AAIpB,UAAM,sBAAsB,wBAAC,MAA2B;AACvD,UAAI,EAAE,SAAS,aAAa,EAAE,SAAS,cAAc,EAAE,SAAS,SAAS;AACxE,cAAM,IAAI,MAAM,gBAAgB;AAAA,MACjC;AACA,UAAI,oBAAoB,GAAG;AAC1B,0BAAkB,EAAE;AAAA,MACrB;AACA,YAAM,KAA6B;AAAA,QAClC,WAAW,EAAE,YAAY;AAAA,QACzB,OAAO,kBAAkB;AAAA,QACzB,MAAM,EAAE;AAAA,QACR,QAAQ,EAAE;AAAA,QACV,UAAU,EAAE;AAAA,QACZ,MAAM,EAAE;AAAA,QACR,SAAS,EAAE;AAAA,QACX,aAAa,EAAE;AAAA,QACf,KAAK,EAAE;AAAA,QACP,SAAS,EAAE;AAAA,QACX,UAAU,EAAE;AAAA,QACZ,SAAS,EAAE;AAAA,QACX,QAAQ,EAAE;AAAA,QACV,UAAU,EAAE;AAAA,MACb;AACA,kBAAY,EAAE;AAAA,IACf,GAxB4B;AA0B5B,UAAM,yBAAyB,wBAAC,MAA8B;AAC7D,UAAI,EAAE,SAAS,sBAAsB,EAAE,SAAS,uBAAuB,EAAE,SAAS,kBAAkB;AACnG,cAAM,IAAI,MAAM,gBAAgB;AAAA,MACjC;AACA,UAAI,oBAAoB,GAAG;AAC1B,0BAAkB,EAAE;AAAA,MACrB;AACA,YAAM,KAAgC;AAAA,QACrC,WAAW,EAAE,YAAY;AAAA,QACzB,OAAO,kBAAkB;AAAA,QACzB,MAAM,EAAE;AAAA,QACR,MAAM,EAAE;AAAA,MACT;AACA,kBAAY,EAAE;AAAA,IACf,GAd+B;AAgB/B,UAAM,mBAAmB,wBAAC,MAAwB;AACjD,UAAI,EAAE,SAAS,iBAAiB,EAAE,SAAS,SAAS;AACnD,cAAM,IAAI,MAAM,gBAAgB;AAAA,MACjC;AACA,UAAI,oBAAoB,GAAG;AAC1B,0BAAkB,EAAE;AAAA,MACrB;AACA,YAAM,KAA0B;AAAA,QAC/B,WAAW,EAAE,YAAY;AAAA,QACzB,OAAO,kBAAkB;AAAA,QACzB,MAAM,EAAE;AAAA,QACR,MAAM,EAAE;AAAA,QACR,WAAW,EAAE;AAAA,QACb,aAAa,EAAE;AAAA,MAChB;AACA,kBAAY,EAAE;AAAA,IACf,GAhByB;AAkBzB,YAAQ,UAAU,mBAAmB;AACrC,YAAQ,WAAW,mBAAmB;AACtC,YAAQ,QAAQ,mBAAmB;AACnC,YAAQ,mBAAmB,sBAAsB;AACjD,YAAQ,oBAAoB,sBAAsB;AAClD,YAAQ,iBAAiB,sBAAsB;AAC/C,YAAQ,cAAc,gBAAgB;AACtC,YAAQ,QAAQ,gBAAgB;AAAA,EACjC;AApFS;AAsFV,GAAG;",
  "names": []
}
