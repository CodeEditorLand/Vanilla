import n from"assert";import{CancellationToken as r}from"../../../../../base/common/cancellation.js";import{canceled as m}from"../../../../../base/common/errors.js";import{DisposableStore as a}from"../../../../../base/common/lifecycle.js";import{ensureNoDisposablesAreLeakedInTestSuite as c}from"../../../../../base/test/common/utils.js";import{LanguageFeatureRegistry as d}from"../../../../common/languageFeatureRegistry.js";import"../../../../common/languages.js";import"../../../../common/model.js";import{getDocumentSemanticTokens as l}from"../../common/getSemanticTokens.js";import{createTextModel as k}from"../../../../test/common/testTextModel.js";suite("getSemanticTokens",()=>{c(),test("issue #136540: semantic highlighting flickers",async()=>{const t=new a,o=new d,s=new class{getLegend(){return{tokenTypes:["test"],tokenModifiers:[]}}provideDocumentSemanticTokens(e,u,T){throw m()}releaseDocumentSemanticTokens(e){}};t.add(o.register("testLang",s));const i=t.add(k("example","testLang"));await l(o,i,null,null,r.None).then(e=>{n.fail()},e=>{n.ok(!!e)}),t.dispose()})});
