{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/editor/contrib/codeAction/browser/codeActionController.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { getDomNodePagePosition } from '../../../../base/browser/dom.js';\nimport * as aria from '../../../../base/browser/ui/aria/aria.js';\nimport { IAnchor } from '../../../../base/browser/ui/contextview/contextview.js';\nimport { IAction } from '../../../../base/common/actions.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { Color } from '../../../../base/common/color.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { Lazy } from '../../../../base/common/lazy.js';\nimport { Disposable, MutableDisposable } from '../../../../base/common/lifecycle.js';\nimport { ICodeEditor } from '../../../browser/editorBrowser.js';\nimport { IPosition, Position } from '../../../common/core/position.js';\nimport { IEditorContribution, ScrollType } from '../../../common/editorCommon.js';\nimport { CodeActionTriggerType } from '../../../common/languages.js';\nimport { IModelDeltaDecoration } from '../../../common/model.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { ApplyCodeActionReason, applyCodeAction } from './codeAction.js';\nimport { CodeActionKeybindingResolver } from './codeActionKeybindingResolver.js';\nimport { toMenuItems } from './codeActionMenu.js';\nimport { LightBulbWidget } from './lightBulbWidget.js';\nimport { MessageController } from '../../message/browser/messageController.js';\nimport { localize } from '../../../../nls.js';\nimport { IActionListDelegate } from '../../../../platform/actionWidget/browser/actionList.js';\nimport { IActionWidgetService } from '../../../../platform/actionWidget/browser/actionWidget.js';\nimport { ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IMarkerService } from '../../../../platform/markers/common/markers.js';\nimport { IEditorProgressService } from '../../../../platform/progress/common/progress.js';\nimport { editorFindMatchHighlight, editorFindMatchHighlightBorder } from '../../../../platform/theme/common/colorRegistry.js';\nimport { isHighContrast } from '../../../../platform/theme/common/theme.js';\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\nimport { CodeActionAutoApply, CodeActionFilter, CodeActionItem, CodeActionKind, CodeActionSet, CodeActionTrigger, CodeActionTriggerSource } from '../common/types.js';\nimport { CodeActionModel, CodeActionsState } from './codeActionModel.js';\nimport { HierarchicalKind } from '../../../../base/common/hierarchicalKind.js';\nimport { ITelemetryService } from '../../../../platform/telemetry/common/telemetry.js';\n\ninterface IActionShowOptions {\n\treadonly includeDisabledActions?: boolean;\n\treadonly fromLightbulb?: boolean;\n}\n\n\nconst DECORATION_CLASS_NAME = 'quickfix-edit-highlight';\n\nexport class CodeActionController extends Disposable implements IEditorContribution {\n\n\tpublic static readonly ID = 'editor.contrib.codeActionController';\n\n\tpublic static get(editor: ICodeEditor): CodeActionController | null {\n\t\treturn editor.getContribution<CodeActionController>(CodeActionController.ID);\n\t}\n\n\tprivate readonly _editor: ICodeEditor;\n\tprivate readonly _model: CodeActionModel;\n\n\tprivate readonly _lightBulbWidget: Lazy<LightBulbWidget | null>;\n\tprivate readonly _activeCodeActions = this._register(new MutableDisposable<CodeActionSet>());\n\tprivate _showDisabled = false;\n\n\tprivate readonly _resolver: CodeActionKeybindingResolver;\n\n\tprivate _disposed = false;\n\n\tconstructor(\n\t\teditor: ICodeEditor,\n\t\t@IMarkerService markerService: IMarkerService,\n\t\t@IContextKeyService contextKeyService: IContextKeyService,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@ILanguageFeaturesService languageFeaturesService: ILanguageFeaturesService,\n\t\t@IEditorProgressService progressService: IEditorProgressService,\n\t\t@ICommandService private readonly _commandService: ICommandService,\n\t\t@IConfigurationService private readonly _configurationService: IConfigurationService,\n\t\t@IActionWidgetService private readonly _actionWidgetService: IActionWidgetService,\n\t\t@IInstantiationService private readonly _instantiationService: IInstantiationService,\n\t\t@ITelemetryService private readonly _telemetryService: ITelemetryService\n\t) {\n\t\tsuper();\n\n\t\tthis._editor = editor;\n\t\tthis._model = this._register(new CodeActionModel(this._editor, languageFeaturesService.codeActionProvider, markerService, contextKeyService, progressService, _configurationService, this._telemetryService));\n\t\tthis._register(this._model.onDidChangeState(newState => this.update(newState)));\n\n\t\tthis._lightBulbWidget = new Lazy(() => {\n\t\t\tconst widget = this._editor.getContribution<LightBulbWidget>(LightBulbWidget.ID);\n\t\t\tif (widget) {\n\t\t\t\tthis._register(widget.onClick(e => this.showCodeActionsFromLightbulb(e.actions, e)));\n\t\t\t}\n\t\t\treturn widget;\n\t\t});\n\n\t\tthis._resolver = instantiationService.createInstance(CodeActionKeybindingResolver);\n\n\t\tthis._register(this._editor.onDidLayoutChange(() => this._actionWidgetService.hide()));\n\t}\n\n\toverride dispose() {\n\t\tthis._disposed = true;\n\t\tsuper.dispose();\n\t}\n\n\tprivate async showCodeActionsFromLightbulb(actions: CodeActionSet, at: IAnchor | IPosition): Promise<void> {\n\t\tif (actions.allAIFixes && actions.validActions.length === 1) {\n\t\t\tconst actionItem = actions.validActions[0];\n\t\t\tconst command = actionItem.action.command;\n\t\t\tif (command && command.id === 'inlineChat.start') {\n\t\t\t\tif (command.arguments && command.arguments.length >= 1) {\n\t\t\t\t\tcommand.arguments[0] = { ...command.arguments[0], autoSend: false };\n\t\t\t\t}\n\t\t\t}\n\t\t\tawait this._applyCodeAction(actionItem, false, false, ApplyCodeActionReason.FromAILightbulb);\n\t\t\treturn;\n\t\t}\n\t\tawait this.showCodeActionList(actions, at, { includeDisabledActions: false, fromLightbulb: true });\n\t}\n\n\tpublic showCodeActions(_trigger: CodeActionTrigger, actions: CodeActionSet, at: IAnchor | IPosition) {\n\t\treturn this.showCodeActionList(actions, at, { includeDisabledActions: false, fromLightbulb: false });\n\t}\n\n\tpublic hideCodeActions(): void {\n\t\tthis._actionWidgetService.hide();\n\t}\n\n\tpublic manualTriggerAtCurrentPosition(\n\t\tnotAvailableMessage: string,\n\t\ttriggerAction: CodeActionTriggerSource,\n\t\tfilter?: CodeActionFilter,\n\t\tautoApply?: CodeActionAutoApply,\n\t): void {\n\t\tif (!this._editor.hasModel()) {\n\t\t\treturn;\n\t\t}\n\n\t\tMessageController.get(this._editor)?.closeMessage();\n\t\tconst triggerPosition = this._editor.getPosition();\n\t\tthis._trigger({ type: CodeActionTriggerType.Invoke, triggerAction, filter, autoApply, context: { notAvailableMessage, position: triggerPosition } });\n\t}\n\n\tprivate _trigger(trigger: CodeActionTrigger) {\n\t\treturn this._model.trigger(trigger);\n\t}\n\n\tprivate async _applyCodeAction(action: CodeActionItem, retrigger: boolean, preview: boolean, actionReason: ApplyCodeActionReason): Promise<void> {\n\t\ttry {\n\t\t\tawait this._instantiationService.invokeFunction(applyCodeAction, action, actionReason, { preview, editor: this._editor });\n\t\t} finally {\n\t\t\tif (retrigger) {\n\t\t\t\tthis._trigger({ type: CodeActionTriggerType.Auto, triggerAction: CodeActionTriggerSource.QuickFix, filter: {} });\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic hideLightBulbWidget(): void {\n\t\tthis._lightBulbWidget.rawValue?.hide();\n\t\tthis._lightBulbWidget.rawValue?.gutterHide();\n\t}\n\n\tprivate async update(newState: CodeActionsState.State): Promise<void> {\n\t\tif (newState.type !== CodeActionsState.Type.Triggered) {\n\t\t\tthis.hideLightBulbWidget();\n\t\t\treturn;\n\t\t}\n\n\t\tlet actions: CodeActionSet;\n\t\ttry {\n\t\t\tactions = await newState.actions;\n\t\t} catch (e) {\n\t\t\tonUnexpectedError(e);\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._disposed) {\n\t\t\treturn;\n\t\t}\n\n\n\t\tconst selection = this._editor.getSelection();\n\t\tif (selection?.startLineNumber !== newState.position.lineNumber) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._lightBulbWidget.value?.update(actions, newState.trigger, newState.position);\n\n\t\tif (newState.trigger.type === CodeActionTriggerType.Invoke) {\n\t\t\tif (newState.trigger.filter?.include) { // Triggered for specific scope\n\t\t\t\t// Check to see if we want to auto apply.\n\n\t\t\t\tconst validActionToApply = this.tryGetValidActionToApply(newState.trigger, actions);\n\t\t\t\tif (validActionToApply) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tthis.hideLightBulbWidget();\n\t\t\t\t\t\tawait this._applyCodeAction(validActionToApply, false, false, ApplyCodeActionReason.FromCodeActions);\n\t\t\t\t\t} finally {\n\t\t\t\t\t\tactions.dispose();\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// Check to see if there is an action that we would have applied were it not invalid\n\t\t\t\tif (newState.trigger.context) {\n\t\t\t\t\tconst invalidAction = this.getInvalidActionThatWouldHaveBeenApplied(newState.trigger, actions);\n\t\t\t\t\tif (invalidAction && invalidAction.action.disabled) {\n\t\t\t\t\t\tMessageController.get(this._editor)?.showMessage(invalidAction.action.disabled, newState.trigger.context.position);\n\t\t\t\t\t\tactions.dispose();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst includeDisabledActions = !!newState.trigger.filter?.include;\n\t\t\tif (newState.trigger.context) {\n\t\t\t\tif (!actions.allActions.length || !includeDisabledActions && !actions.validActions.length) {\n\t\t\t\t\tMessageController.get(this._editor)?.showMessage(newState.trigger.context.notAvailableMessage, newState.trigger.context.position);\n\t\t\t\t\tthis._activeCodeActions.value = actions;\n\t\t\t\t\tactions.dispose();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis._activeCodeActions.value = actions;\n\t\t\tthis.showCodeActionList(actions, this.toCoords(newState.position), { includeDisabledActions, fromLightbulb: false });\n\t\t} else {\n\t\t\t// auto magically triggered\n\t\t\tif (this._actionWidgetService.isVisible) {\n\t\t\t\t// TODO: Figure out if we should update the showing menu?\n\t\t\t\tactions.dispose();\n\t\t\t} else {\n\t\t\t\tthis._activeCodeActions.value = actions;\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate getInvalidActionThatWouldHaveBeenApplied(trigger: CodeActionTrigger, actions: CodeActionSet): CodeActionItem | undefined {\n\t\tif (!actions.allActions.length) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif ((trigger.autoApply === CodeActionAutoApply.First && actions.validActions.length === 0)\n\t\t\t|| (trigger.autoApply === CodeActionAutoApply.IfSingle && actions.allActions.length === 1)\n\t\t) {\n\t\t\treturn actions.allActions.find(({ action }) => action.disabled);\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tprivate tryGetValidActionToApply(trigger: CodeActionTrigger, actions: CodeActionSet): CodeActionItem | undefined {\n\t\tif (!actions.validActions.length) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif ((trigger.autoApply === CodeActionAutoApply.First && actions.validActions.length > 0)\n\t\t\t|| (trigger.autoApply === CodeActionAutoApply.IfSingle && actions.validActions.length === 1)\n\t\t) {\n\t\t\treturn actions.validActions[0];\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tprivate static readonly DECORATION = ModelDecorationOptions.register({\n\t\tdescription: 'quickfix-highlight',\n\t\tclassName: DECORATION_CLASS_NAME\n\t});\n\n\tpublic async showCodeActionList(actions: CodeActionSet, at: IAnchor | IPosition, options: IActionShowOptions): Promise<void> {\n\n\t\tconst currentDecorations = this._editor.createDecorationsCollection();\n\n\t\tconst editorDom = this._editor.getDomNode();\n\t\tif (!editorDom) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst actionsToShow = options.includeDisabledActions && (this._showDisabled || actions.validActions.length === 0) ? actions.allActions : actions.validActions;\n\t\tif (!actionsToShow.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst anchor = Position.isIPosition(at) ? this.toCoords(at) : at;\n\n\t\tconst delegate: IActionListDelegate<CodeActionItem> = {\n\t\t\tonSelect: async (action: CodeActionItem, preview?: boolean) => {\n\t\t\t\tthis._applyCodeAction(action, /* retrigger */ true, !!preview, options.fromLightbulb ? ApplyCodeActionReason.FromAILightbulb : ApplyCodeActionReason.FromCodeActions);\n\t\t\t\tthis._actionWidgetService.hide(false);\n\t\t\t\tcurrentDecorations.clear();\n\t\t\t},\n\t\t\tonHide: (didCancel?) => {\n\t\t\t\tthis._editor?.focus();\n\t\t\t\tcurrentDecorations.clear();\n\t\t\t},\n\t\t\tonHover: async (action: CodeActionItem, token: CancellationToken) => {\n\t\t\t\tif (token.isCancellationRequested) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tlet canPreview = false;\n\t\t\t\tconst actionKind = action.action.kind;\n\n\t\t\t\tif (actionKind) {\n\t\t\t\t\tconst hierarchicalKind = new HierarchicalKind(actionKind);\n\t\t\t\t\tconst refactorKinds = [\n\t\t\t\t\t\tCodeActionKind.RefactorExtract,\n\t\t\t\t\t\tCodeActionKind.RefactorInline,\n\t\t\t\t\t\tCodeActionKind.RefactorRewrite,\n\t\t\t\t\t\tCodeActionKind.RefactorMove,\n\t\t\t\t\t\tCodeActionKind.Source\n\t\t\t\t\t];\n\n\t\t\t\t\tcanPreview = refactorKinds.some(refactorKind => refactorKind.contains(hierarchicalKind));\n\t\t\t\t}\n\n\t\t\t\treturn { canPreview: canPreview || !!action.action.edit?.edits.length };\n\t\t\t},\n\t\t\tonFocus: (action: CodeActionItem | undefined) => {\n\t\t\t\tif (action && action.action) {\n\t\t\t\t\tconst ranges = action.action.ranges;\n\t\t\t\t\tconst diagnostics = action.action.diagnostics;\n\t\t\t\t\tcurrentDecorations.clear();\n\t\t\t\t\tif (ranges && ranges.length > 0) {\n\t\t\t\t\t\t// Handles case for `fix all` where there are multiple diagnostics.\n\t\t\t\t\t\tconst decorations: IModelDeltaDecoration[] = (diagnostics && diagnostics?.length > 1)\n\t\t\t\t\t\t\t? diagnostics.map(diagnostic => ({ range: diagnostic, options: CodeActionController.DECORATION }))\n\t\t\t\t\t\t\t: ranges.map(range => ({ range, options: CodeActionController.DECORATION }));\n\t\t\t\t\t\tcurrentDecorations.set(decorations);\n\t\t\t\t\t} else if (diagnostics && diagnostics.length > 0) {\n\t\t\t\t\t\tconst decorations: IModelDeltaDecoration[] = diagnostics.map(diagnostic => ({ range: diagnostic, options: CodeActionController.DECORATION }));\n\t\t\t\t\t\tcurrentDecorations.set(decorations);\n\t\t\t\t\t\tconst diagnostic = diagnostics[0];\n\t\t\t\t\t\tif (diagnostic.startLineNumber && diagnostic.startColumn) {\n\t\t\t\t\t\t\tconst selectionText = this._editor.getModel()?.getWordAtPosition({ lineNumber: diagnostic.startLineNumber, column: diagnostic.startColumn })?.word;\n\t\t\t\t\t\t\taria.status(localize('editingNewSelection', \"Context: {0} at line {1} and column {2}.\", selectionText, diagnostic.startLineNumber, diagnostic.startColumn));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tcurrentDecorations.clear();\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tthis._actionWidgetService.show(\n\t\t\t'codeActionWidget',\n\t\t\ttrue,\n\t\t\ttoMenuItems(actionsToShow, this._shouldShowHeaders(), this._resolver.getResolver()),\n\t\t\tdelegate,\n\t\t\tanchor,\n\t\t\teditorDom,\n\t\t\tthis._getActionBarActions(actions, at, options));\n\t}\n\n\tprivate toCoords(position: IPosition): IAnchor {\n\t\tif (!this._editor.hasModel()) {\n\t\t\treturn { x: 0, y: 0 };\n\t\t}\n\n\t\tthis._editor.revealPosition(position, ScrollType.Immediate);\n\t\tthis._editor.render();\n\n\t\t// Translate to absolute editor position\n\t\tconst cursorCoords = this._editor.getScrolledVisiblePosition(position);\n\t\tconst editorCoords = getDomNodePagePosition(this._editor.getDomNode());\n\t\tconst x = editorCoords.left + cursorCoords.left;\n\t\tconst y = editorCoords.top + cursorCoords.top + cursorCoords.height;\n\n\t\treturn { x, y };\n\t}\n\n\tprivate _shouldShowHeaders(): boolean {\n\t\tconst model = this._editor?.getModel();\n\t\treturn this._configurationService.getValue('editor.codeActionWidget.showHeaders', { resource: model?.uri });\n\t}\n\n\tprivate _getActionBarActions(actions: CodeActionSet, at: IAnchor | IPosition, options: IActionShowOptions): IAction[] {\n\t\tif (options.fromLightbulb) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst resultActions = actions.documentation.map((command): IAction => ({\n\t\t\tid: command.id,\n\t\t\tlabel: command.title,\n\t\t\ttooltip: command.tooltip ?? '',\n\t\t\tclass: undefined,\n\t\t\tenabled: true,\n\t\t\trun: () => this._commandService.executeCommand(command.id, ...(command.arguments ?? [])),\n\t\t}));\n\n\t\tif (options.includeDisabledActions && actions.validActions.length > 0 && actions.allActions.length !== actions.validActions.length) {\n\t\t\tresultActions.push(this._showDisabled ? {\n\t\t\t\tid: 'hideMoreActions',\n\t\t\t\tlabel: localize('hideMoreActions', 'Hide Disabled'),\n\t\t\t\tenabled: true,\n\t\t\t\ttooltip: '',\n\t\t\t\tclass: undefined,\n\t\t\t\trun: () => {\n\t\t\t\t\tthis._showDisabled = false;\n\t\t\t\t\treturn this.showCodeActionList(actions, at, options);\n\t\t\t\t}\n\t\t\t} : {\n\t\t\t\tid: 'showMoreActions',\n\t\t\t\tlabel: localize('showMoreActions', 'Show Disabled'),\n\t\t\t\tenabled: true,\n\t\t\t\ttooltip: '',\n\t\t\t\tclass: undefined,\n\t\t\t\trun: () => {\n\t\t\t\t\tthis._showDisabled = true;\n\t\t\t\t\treturn this.showCodeActionList(actions, at, options);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn resultActions;\n\t}\n}\n\nregisterThemingParticipant((theme, collector) => {\n\tconst addBackgroundColorRule = (selector: string, color: Color | undefined): void => {\n\t\tif (color) {\n\t\t\tcollector.addRule(`.monaco-editor ${selector} { background-color: ${color}; }`);\n\t\t}\n\t};\n\n\taddBackgroundColorRule('.quickfix-edit-highlight', theme.getColor(editorFindMatchHighlight));\n\tconst findMatchHighlightBorder = theme.getColor(editorFindMatchHighlightBorder);\n\n\tif (findMatchHighlightBorder) {\n\t\tcollector.addRule(`.monaco-editor .quickfix-edit-highlight { border: 1px ${isHighContrast(theme.type) ? 'dotted' : 'solid'} ${findMatchHighlightBorder}; box-sizing: border-box; }`);\n\t}\n});\n"],
  "mappings": "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",
  "names": ["diagnostic"]
}
