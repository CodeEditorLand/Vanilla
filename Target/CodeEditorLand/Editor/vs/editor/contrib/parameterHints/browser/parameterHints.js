var y=Object.defineProperty;var f=Object.getOwnPropertyDescriptor;var h=(t,r,n,a)=>{for(var i=a>1?void 0:a?f(r,n):r,l=t.length-1,p;l>=0;l--)(p=t[l])&&(i=(a?p(r,n,i):p(i))||i);return a&&i&&y(r,n,i),i},c=(t,r)=>(n,a)=>r(n,a,t);import{KeyCode as e,KeyMod as s}from"../../../../base/common/keyCodes.js";import{Lazy as v}from"../../../../base/common/lazy.js";import{Disposable as E}from"../../../../base/common/lifecycle.js";import"../../../browser/editorBrowser.js";import{EditorAction as I,EditorCommand as x,EditorContributionInstantiation as A,registerEditorAction as H,registerEditorCommand as g,registerEditorContribution as P}from"../../../browser/editorExtensions.js";import"../../../common/editorCommon.js";import{EditorContextKeys as d}from"../../../common/editorContextKeys.js";import*as S from"../../../common/languages.js";import{ILanguageFeaturesService as k}from"../../../common/services/languageFeatures.js";import{ParameterHintsModel as K}from"./parameterHintsModel.js";import{Context as m}from"./provideSignatureHelp.js";import*as D from"../../../../nls.js";import{ContextKeyExpr as b}from"../../../../platform/contextkey/common/contextkey.js";import{IInstantiationService as T}from"../../../../platform/instantiation/common/instantiation.js";import{KeybindingWeight as C}from"../../../../platform/keybinding/common/keybindingsRegistry.js";import{ParameterHintsWidget as V}from"./parameterHintsWidget.js";let o=class extends E{static ID="editor.controller.parameterHints";static get(r){return r.getContribution(o.ID)}editor;model;widget;constructor(r,n,a){super(),this.editor=r,this.model=this._register(new K(r,a.signatureHelpProvider)),this._register(this.model.onChangedHints(i=>{i?(this.widget.value.show(),this.widget.value.render(i)):this.widget.rawValue?.hide()})),this.widget=new v(()=>this._register(n.createInstance(V,this.editor,this.model)))}cancel(){this.model.cancel()}previous(){this.widget.rawValue?.previous()}next(){this.widget.rawValue?.next()}trigger(r){this.model.trigger(r,0)}};o=h([c(1,T),c(2,k)],o);class M extends I{constructor(){super({id:"editor.action.triggerParameterHints",label:D.localize("parameterHints.trigger.label","Trigger Parameter Hints"),alias:"Trigger Parameter Hints",precondition:d.hasSignatureHelpProvider,kbOpts:{kbExpr:d.editorTextFocus,primary:s.CtrlCmd|s.Shift|e.Space,weight:C.EditorContrib}})}run(r,n){o.get(n)?.trigger({triggerKind:S.SignatureHelpTriggerKind.Invoke})}}P(o.ID,o,A.BeforeFirstInteraction),H(M);const u=C.EditorContrib+75,w=x.bindToContribution(o.get);g(new w({id:"closeParameterHints",precondition:m.Visible,handler:t=>t.cancel(),kbOpts:{weight:u,kbExpr:d.focus,primary:e.Escape,secondary:[s.Shift|e.Escape]}})),g(new w({id:"showPrevParameterHint",precondition:b.and(m.Visible,m.MultipleSignatures),handler:t=>t.previous(),kbOpts:{weight:u,kbExpr:d.focus,primary:e.UpArrow,secondary:[s.Alt|e.UpArrow],mac:{primary:e.UpArrow,secondary:[s.Alt|e.UpArrow,s.WinCtrl|e.KeyP]}}})),g(new w({id:"showNextParameterHint",precondition:b.and(m.Visible,m.MultipleSignatures),handler:t=>t.next(),kbOpts:{weight:u,kbExpr:d.focus,primary:e.DownArrow,secondary:[s.Alt|e.DownArrow],mac:{primary:e.DownArrow,secondary:[s.Alt|e.DownArrow,s.WinCtrl|e.KeyN]}}}));export{o as ParameterHintsController,M as TriggerParameterHintsAction};
