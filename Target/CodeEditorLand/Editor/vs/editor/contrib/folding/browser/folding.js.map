{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/editor/contrib/folding/browser/folding.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport {\n\ttype CancelablePromise,\n\tDelayer,\n\tRunOnceScheduler,\n\tcreateCancelablePromise,\n} from \"../../../../base/common/async.js\";\nimport { CancellationToken } from \"../../../../base/common/cancellation.js\";\nimport {\n\tillegalArgument,\n\tonUnexpectedError,\n} from \"../../../../base/common/errors.js\";\nimport { KeyChord, KeyCode, KeyMod } from \"../../../../base/common/keyCodes.js\";\nimport {\n\tDisposable,\n\tDisposableStore,\n\ttype IDisposable,\n} from \"../../../../base/common/lifecycle.js\";\nimport { escapeRegExpCharacters } from \"../../../../base/common/strings.js\";\nimport * as types from \"../../../../base/common/types.js\";\nimport \"./folding.css\";\nimport { Emitter, type Event } from \"../../../../base/common/event.js\";\nimport { StopWatch } from \"../../../../base/common/stopwatch.js\";\nimport { URI } from \"../../../../base/common/uri.js\";\nimport * as nls from \"../../../../nls.js\";\nimport { CommandsRegistry } from \"../../../../platform/commands/common/commands.js\";\nimport { IConfigurationService } from \"../../../../platform/configuration/common/configuration.js\";\nimport {\n\ttype IContextKey,\n\tIContextKeyService,\n\tRawContextKey,\n} from \"../../../../platform/contextkey/common/contextkey.js\";\nimport { KeybindingWeight } from \"../../../../platform/keybinding/common/keybindingsRegistry.js\";\nimport { INotificationService } from \"../../../../platform/notification/common/notification.js\";\nimport {\n\ttype ICodeEditor,\n\ttype IEditorMouseEvent,\n\tMouseTargetType,\n} from \"../../../browser/editorBrowser.js\";\nimport {\n\tEditorAction,\n\tEditorContributionInstantiation,\n\ttype ServicesAccessor,\n\tregisterEditorAction,\n\tregisterEditorContribution,\n\tregisterInstantiatedEditorAction,\n} from \"../../../browser/editorExtensions.js\";\nimport { StableEditorScrollState } from \"../../../browser/stableEditorScroll.js\";\nimport {\n\ttype ConfigurationChangedEvent,\n\tEditorOption,\n} from \"../../../common/config/editorOptions.js\";\nimport type { IPosition } from \"../../../common/core/position.js\";\nimport type { IRange } from \"../../../common/core/range.js\";\nimport type { Selection } from \"../../../common/core/selection.js\";\nimport {\n\ttype IEditorContribution,\n\tScrollType,\n} from \"../../../common/editorCommon.js\";\nimport { EditorContextKeys } from \"../../../common/editorContextKeys.js\";\nimport {\n\ttype FoldingRange,\n\tFoldingRangeKind,\n\ttype FoldingRangeProvider,\n} from \"../../../common/languages.js\";\nimport { ILanguageConfigurationService } from \"../../../common/languages/languageConfigurationRegistry.js\";\nimport type { ITextModel } from \"../../../common/model.js\";\nimport {\n\ttype IFeatureDebounceInformation,\n\tILanguageFeatureDebounceService,\n} from \"../../../common/services/languageFeatureDebounce.js\";\nimport { ILanguageFeaturesService } from \"../../../common/services/languageFeatures.js\";\nimport { IModelService } from \"../../../common/services/model.js\";\nimport type { IModelContentChangedEvent } from \"../../../common/textModelEvents.js\";\nimport { FoldingDecorationProvider } from \"./foldingDecorations.js\";\nimport {\n\ttype CollapseMemento,\n\tFoldingModel,\n\tgetNextFoldLine,\n\tgetParentFoldLine,\n\tgetPreviousFoldLine,\n\tsetCollapseStateAtLevel,\n\tsetCollapseStateForMatchingLines,\n\tsetCollapseStateForRest,\n\tsetCollapseStateForType,\n\tsetCollapseStateLevelsDown,\n\tsetCollapseStateLevelsUp,\n\tsetCollapseStateUp,\n\ttoggleCollapseState,\n} from \"./foldingModel.js\";\nimport {\n\ttype FoldRange,\n\tFoldSource,\n\ttype FoldingRegion,\n\tFoldingRegions,\n\ttype ILineRange,\n} from \"./foldingRanges.js\";\nimport { HiddenRangeModel } from \"./hiddenRangeModel.js\";\nimport { IndentRangeProvider } from \"./indentRangeProvider.js\";\nimport { SyntaxRangeProvider } from \"./syntaxRangeProvider.js\";\n\nconst CONTEXT_FOLDING_ENABLED = new RawContextKey<boolean>(\n\t\"foldingEnabled\",\n\tfalse,\n);\n\nexport interface RangeProvider {\n\treadonly id: string;\n\tcompute(\n\t\tcancelationToken: CancellationToken,\n\t): Promise<FoldingRegions | null>;\n\tdispose(): void;\n}\n\ninterface FoldingStateMemento {\n\tcollapsedRegions?: CollapseMemento;\n\tlineCount?: number;\n\tprovider?: string;\n\tfoldedImports?: boolean;\n}\n\nexport interface FoldingLimitReporter {\n\treadonly limit: number;\n\tupdate(computed: number, limited: number | false): void;\n}\n\nexport type FoldingRangeProviderSelector = (\n\tprovider: FoldingRangeProvider[],\n\tdocument: ITextModel,\n) => FoldingRangeProvider[] | undefined;\n\nexport class FoldingController\n\textends Disposable\n\timplements IEditorContribution\n{\n\tpublic static readonly ID = \"editor.contrib.folding\";\n\n\tpublic static get(editor: ICodeEditor): FoldingController | null {\n\t\treturn editor.getContribution<FoldingController>(FoldingController.ID);\n\t}\n\n\tprivate static _foldingRangeSelector:\n\t\t| FoldingRangeProviderSelector\n\t\t| undefined;\n\n\tpublic static getFoldingRangeProviders(\n\t\tlanguageFeaturesService: ILanguageFeaturesService,\n\t\tmodel: ITextModel,\n\t): FoldingRangeProvider[] {\n\t\tconst foldingRangeProviders =\n\t\t\tlanguageFeaturesService.foldingRangeProvider.ordered(model);\n\t\treturn (\n\t\t\tFoldingController._foldingRangeSelector?.(\n\t\t\t\tfoldingRangeProviders,\n\t\t\t\tmodel,\n\t\t\t) ?? foldingRangeProviders\n\t\t);\n\t}\n\n\tpublic static setFoldingRangeProviderSelector(\n\t\tfoldingRangeSelector: FoldingRangeProviderSelector,\n\t): IDisposable {\n\t\tFoldingController._foldingRangeSelector = foldingRangeSelector;\n\t\treturn {\n\t\t\tdispose: () => {\n\t\t\t\tFoldingController._foldingRangeSelector = undefined;\n\t\t\t},\n\t\t};\n\t}\n\n\tprivate readonly editor: ICodeEditor;\n\tprivate _isEnabled: boolean;\n\tprivate _useFoldingProviders: boolean;\n\tprivate _unfoldOnClickAfterEndOfLine: boolean;\n\tprivate _restoringViewState: boolean;\n\tprivate _foldingImportsByDefault: boolean;\n\tprivate _currentModelHasFoldedImports: boolean;\n\n\tprivate readonly foldingDecorationProvider: FoldingDecorationProvider;\n\n\tprivate foldingModel: FoldingModel | null;\n\tprivate hiddenRangeModel: HiddenRangeModel | null;\n\n\tprivate rangeProvider: RangeProvider | null;\n\tprivate foldingRegionPromise: CancelablePromise<FoldingRegions | null> | null;\n\n\tprivate foldingModelPromise: Promise<FoldingModel | null> | null;\n\tprivate updateScheduler: Delayer<FoldingModel | null> | null;\n\tprivate readonly updateDebounceInfo: IFeatureDebounceInformation;\n\n\tprivate foldingEnabled: IContextKey<boolean>;\n\tprivate cursorChangedScheduler: RunOnceScheduler | null;\n\n\tprivate readonly localToDispose = this._register(new DisposableStore());\n\tprivate mouseDownInfo: { lineNumber: number; iconClicked: boolean } | null;\n\n\tpublic readonly _foldingLimitReporter: RangesLimitReporter;\n\n\tconstructor(\n\t\teditor: ICodeEditor,\n\t\t@IContextKeyService\n\t\tprivate readonly contextKeyService: IContextKeyService,\n\t\t@ILanguageConfigurationService\n\t\tprivate readonly languageConfigurationService: ILanguageConfigurationService,\n\t\t@INotificationService notificationService: INotificationService,\n\t\t@ILanguageFeatureDebounceService\n\t\tlanguageFeatureDebounceService: ILanguageFeatureDebounceService,\n\t\t@ILanguageFeaturesService\n\t\tprivate readonly languageFeaturesService: ILanguageFeaturesService,\n\t) {\n\t\tsuper();\n\t\tthis.editor = editor;\n\n\t\tthis._foldingLimitReporter = new RangesLimitReporter(editor);\n\n\t\tconst options = this.editor.getOptions();\n\t\tthis._isEnabled = options.get(EditorOption.folding);\n\t\tthis._useFoldingProviders =\n\t\t\toptions.get(EditorOption.foldingStrategy) !== \"indentation\";\n\t\tthis._unfoldOnClickAfterEndOfLine = options.get(\n\t\t\tEditorOption.unfoldOnClickAfterEndOfLine,\n\t\t);\n\t\tthis._restoringViewState = false;\n\t\tthis._currentModelHasFoldedImports = false;\n\t\tthis._foldingImportsByDefault = options.get(\n\t\t\tEditorOption.foldingImportsByDefault,\n\t\t);\n\t\tthis.updateDebounceInfo = languageFeatureDebounceService.for(\n\t\t\tlanguageFeaturesService.foldingRangeProvider,\n\t\t\t\"Folding\",\n\t\t\t{ min: 200 },\n\t\t);\n\n\t\tthis.foldingModel = null;\n\t\tthis.hiddenRangeModel = null;\n\t\tthis.rangeProvider = null;\n\t\tthis.foldingRegionPromise = null;\n\t\tthis.foldingModelPromise = null;\n\t\tthis.updateScheduler = null;\n\t\tthis.cursorChangedScheduler = null;\n\t\tthis.mouseDownInfo = null;\n\n\t\tthis.foldingDecorationProvider = new FoldingDecorationProvider(editor);\n\t\tthis.foldingDecorationProvider.showFoldingControls = options.get(\n\t\t\tEditorOption.showFoldingControls,\n\t\t);\n\t\tthis.foldingDecorationProvider.showFoldingHighlights = options.get(\n\t\t\tEditorOption.foldingHighlight,\n\t\t);\n\t\tthis.foldingEnabled = CONTEXT_FOLDING_ENABLED.bindTo(\n\t\t\tthis.contextKeyService,\n\t\t);\n\t\tthis.foldingEnabled.set(this._isEnabled);\n\n\t\tthis._register(\n\t\t\tthis.editor.onDidChangeModel(() => this.onModelChanged()),\n\t\t);\n\n\t\tthis._register(\n\t\t\tthis.editor.onDidChangeConfiguration(\n\t\t\t\t(e: ConfigurationChangedEvent) => {\n\t\t\t\t\tif (e.hasChanged(EditorOption.folding)) {\n\t\t\t\t\t\tthis._isEnabled = this.editor\n\t\t\t\t\t\t\t.getOptions()\n\t\t\t\t\t\t\t.get(EditorOption.folding);\n\t\t\t\t\t\tthis.foldingEnabled.set(this._isEnabled);\n\t\t\t\t\t\tthis.onModelChanged();\n\t\t\t\t\t}\n\t\t\t\t\tif (e.hasChanged(EditorOption.foldingMaximumRegions)) {\n\t\t\t\t\t\tthis.onModelChanged();\n\t\t\t\t\t}\n\t\t\t\t\tif (\n\t\t\t\t\t\te.hasChanged(EditorOption.showFoldingControls) ||\n\t\t\t\t\t\te.hasChanged(EditorOption.foldingHighlight)\n\t\t\t\t\t) {\n\t\t\t\t\t\tconst options = this.editor.getOptions();\n\t\t\t\t\t\tthis.foldingDecorationProvider.showFoldingControls =\n\t\t\t\t\t\t\toptions.get(EditorOption.showFoldingControls);\n\t\t\t\t\t\tthis.foldingDecorationProvider.showFoldingHighlights =\n\t\t\t\t\t\t\toptions.get(EditorOption.foldingHighlight);\n\t\t\t\t\t\tthis.triggerFoldingModelChanged();\n\t\t\t\t\t}\n\t\t\t\t\tif (e.hasChanged(EditorOption.foldingStrategy)) {\n\t\t\t\t\t\tthis._useFoldingProviders =\n\t\t\t\t\t\t\tthis.editor\n\t\t\t\t\t\t\t\t.getOptions()\n\t\t\t\t\t\t\t\t.get(EditorOption.foldingStrategy) !==\n\t\t\t\t\t\t\t\"indentation\";\n\t\t\t\t\t\tthis.onFoldingStrategyChanged();\n\t\t\t\t\t}\n\t\t\t\t\tif (\n\t\t\t\t\t\te.hasChanged(EditorOption.unfoldOnClickAfterEndOfLine)\n\t\t\t\t\t) {\n\t\t\t\t\t\tthis._unfoldOnClickAfterEndOfLine = this.editor\n\t\t\t\t\t\t\t.getOptions()\n\t\t\t\t\t\t\t.get(EditorOption.unfoldOnClickAfterEndOfLine);\n\t\t\t\t\t}\n\t\t\t\t\tif (e.hasChanged(EditorOption.foldingImportsByDefault)) {\n\t\t\t\t\t\tthis._foldingImportsByDefault = this.editor\n\t\t\t\t\t\t\t.getOptions()\n\t\t\t\t\t\t\t.get(EditorOption.foldingImportsByDefault);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t),\n\t\t);\n\t\tthis.onModelChanged();\n\t}\n\n\tpublic get limitReporter() {\n\t\treturn this._foldingLimitReporter;\n\t}\n\n\t/**\n\t * Store view state.\n\t */\n\tpublic saveViewState(): FoldingStateMemento | undefined {\n\t\tconst model = this.editor.getModel();\n\t\tif (!model || !this._isEnabled || model.isTooLargeForTokenization()) {\n\t\t\treturn {};\n\t\t}\n\t\tif (this.foldingModel) {\n\t\t\t// disposed ?\n\t\t\tconst collapsedRegions = this.foldingModel.getMemento();\n\t\t\tconst provider = this.rangeProvider\n\t\t\t\t? this.rangeProvider.id\n\t\t\t\t: undefined;\n\t\t\treturn {\n\t\t\t\tcollapsedRegions,\n\t\t\t\tlineCount: model.getLineCount(),\n\t\t\t\tprovider,\n\t\t\t\tfoldedImports: this._currentModelHasFoldedImports,\n\t\t\t};\n\t\t}\n\t\treturn undefined;\n\t}\n\n\t/**\n\t * Restore view state.\n\t */\n\tpublic restoreViewState(state: FoldingStateMemento): void {\n\t\tconst model = this.editor.getModel();\n\t\tif (\n\t\t\t!model ||\n\t\t\t!this._isEnabled ||\n\t\t\tmodel.isTooLargeForTokenization() ||\n\t\t\t!this.hiddenRangeModel\n\t\t) {\n\t\t\treturn;\n\t\t}\n\t\tif (!state) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._currentModelHasFoldedImports = !!state.foldedImports;\n\t\tif (\n\t\t\tstate.collapsedRegions &&\n\t\t\tstate.collapsedRegions.length > 0 &&\n\t\t\tthis.foldingModel\n\t\t) {\n\t\t\tthis._restoringViewState = true;\n\t\t\ttry {\n\t\t\t\tthis.foldingModel.applyMemento(state.collapsedRegions);\n\t\t\t} finally {\n\t\t\t\tthis._restoringViewState = false;\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate onModelChanged(): void {\n\t\tthis.localToDispose.clear();\n\n\t\tconst model = this.editor.getModel();\n\t\tif (!this._isEnabled || !model || model.isTooLargeForTokenization()) {\n\t\t\t// huge files get no view model, so they cannot support hidden areas\n\t\t\treturn;\n\t\t}\n\n\t\tthis._currentModelHasFoldedImports = false;\n\t\tthis.foldingModel = new FoldingModel(\n\t\t\tmodel,\n\t\t\tthis.foldingDecorationProvider,\n\t\t);\n\t\tthis.localToDispose.add(this.foldingModel);\n\n\t\tthis.hiddenRangeModel = new HiddenRangeModel(this.foldingModel);\n\t\tthis.localToDispose.add(this.hiddenRangeModel);\n\t\tthis.localToDispose.add(\n\t\t\tthis.hiddenRangeModel.onDidChange((hr) =>\n\t\t\t\tthis.onHiddenRangesChanges(hr),\n\t\t\t),\n\t\t);\n\n\t\tthis.updateScheduler = new Delayer<FoldingModel>(\n\t\t\tthis.updateDebounceInfo.get(model),\n\t\t);\n\n\t\tthis.cursorChangedScheduler = new RunOnceScheduler(\n\t\t\t() => this.revealCursor(),\n\t\t\t200,\n\t\t);\n\t\tthis.localToDispose.add(this.cursorChangedScheduler);\n\t\tthis.localToDispose.add(\n\t\t\tthis.languageFeaturesService.foldingRangeProvider.onDidChange(() =>\n\t\t\t\tthis.onFoldingStrategyChanged(),\n\t\t\t),\n\t\t);\n\t\tthis.localToDispose.add(\n\t\t\tthis.editor.onDidChangeModelLanguageConfiguration(() =>\n\t\t\t\tthis.onFoldingStrategyChanged(),\n\t\t\t),\n\t\t); // covers model language changes as well\n\t\tthis.localToDispose.add(\n\t\t\tthis.editor.onDidChangeModelContent((e) =>\n\t\t\t\tthis.onDidChangeModelContent(e),\n\t\t\t),\n\t\t);\n\t\tthis.localToDispose.add(\n\t\t\tthis.editor.onDidChangeCursorPosition(() =>\n\t\t\t\tthis.onCursorPositionChanged(),\n\t\t\t),\n\t\t);\n\t\tthis.localToDispose.add(\n\t\t\tthis.editor.onMouseDown((e) => this.onEditorMouseDown(e)),\n\t\t);\n\t\tthis.localToDispose.add(\n\t\t\tthis.editor.onMouseUp((e) => this.onEditorMouseUp(e)),\n\t\t);\n\t\tthis.localToDispose.add({\n\t\t\tdispose: () => {\n\t\t\t\tif (this.foldingRegionPromise) {\n\t\t\t\t\tthis.foldingRegionPromise.cancel();\n\t\t\t\t\tthis.foldingRegionPromise = null;\n\t\t\t\t}\n\t\t\t\tthis.updateScheduler?.cancel();\n\t\t\t\tthis.updateScheduler = null;\n\t\t\t\tthis.foldingModel = null;\n\t\t\t\tthis.foldingModelPromise = null;\n\t\t\t\tthis.hiddenRangeModel = null;\n\t\t\t\tthis.cursorChangedScheduler = null;\n\t\t\t\tthis.rangeProvider?.dispose();\n\t\t\t\tthis.rangeProvider = null;\n\t\t\t},\n\t\t});\n\t\tthis.triggerFoldingModelChanged();\n\t}\n\n\tprivate onFoldingStrategyChanged() {\n\t\tthis.rangeProvider?.dispose();\n\t\tthis.rangeProvider = null;\n\t\tthis.triggerFoldingModelChanged();\n\t}\n\n\tprivate getRangeProvider(editorModel: ITextModel): RangeProvider {\n\t\tif (this.rangeProvider) {\n\t\t\treturn this.rangeProvider;\n\t\t}\n\t\tconst indentRangeProvider = new IndentRangeProvider(\n\t\t\teditorModel,\n\t\t\tthis.languageConfigurationService,\n\t\t\tthis._foldingLimitReporter,\n\t\t);\n\t\tthis.rangeProvider = indentRangeProvider; // fallback\n\t\tif (this._useFoldingProviders && this.foldingModel) {\n\t\t\tconst selectedProviders =\n\t\t\t\tFoldingController.getFoldingRangeProviders(\n\t\t\t\t\tthis.languageFeaturesService,\n\t\t\t\t\teditorModel,\n\t\t\t\t);\n\t\t\tif (selectedProviders.length > 0) {\n\t\t\t\tthis.rangeProvider = new SyntaxRangeProvider(\n\t\t\t\t\teditorModel,\n\t\t\t\t\tselectedProviders,\n\t\t\t\t\t() => this.triggerFoldingModelChanged(),\n\t\t\t\t\tthis._foldingLimitReporter,\n\t\t\t\t\tindentRangeProvider,\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\treturn this.rangeProvider;\n\t}\n\n\tpublic getFoldingModel(): Promise<FoldingModel | null> | null {\n\t\treturn this.foldingModelPromise;\n\t}\n\n\tprivate onDidChangeModelContent(e: IModelContentChangedEvent) {\n\t\tthis.hiddenRangeModel?.notifyChangeModelContent(e);\n\t\tthis.triggerFoldingModelChanged();\n\t}\n\n\tpublic triggerFoldingModelChanged() {\n\t\tif (this.updateScheduler) {\n\t\t\tif (this.foldingRegionPromise) {\n\t\t\t\tthis.foldingRegionPromise.cancel();\n\t\t\t\tthis.foldingRegionPromise = null;\n\t\t\t}\n\t\t\tthis.foldingModelPromise = this.updateScheduler\n\t\t\t\t.trigger(() => {\n\t\t\t\t\tconst foldingModel = this.foldingModel;\n\t\t\t\t\tif (!foldingModel) {\n\t\t\t\t\t\t// null if editor has been disposed, or folding turned off\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\t\t\t\t\tconst sw = new StopWatch();\n\t\t\t\t\tconst provider = this.getRangeProvider(\n\t\t\t\t\t\tfoldingModel.textModel,\n\t\t\t\t\t);\n\t\t\t\t\tconst foldingRegionPromise = (this.foldingRegionPromise =\n\t\t\t\t\t\tcreateCancelablePromise((token) =>\n\t\t\t\t\t\t\tprovider.compute(token),\n\t\t\t\t\t\t));\n\t\t\t\t\treturn foldingRegionPromise.then((foldingRanges) => {\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tfoldingRanges &&\n\t\t\t\t\t\t\tfoldingRegionPromise === this.foldingRegionPromise\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t// new request or cancelled in the meantime?\n\t\t\t\t\t\t\tlet scrollState:\n\t\t\t\t\t\t\t\t| StableEditorScrollState\n\t\t\t\t\t\t\t\t| undefined;\n\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\tthis._foldingImportsByDefault &&\n\t\t\t\t\t\t\t\t!this._currentModelHasFoldedImports\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tconst hasChanges =\n\t\t\t\t\t\t\t\t\tfoldingRanges.setCollapsedAllOfType(\n\t\t\t\t\t\t\t\t\t\tFoldingRangeKind.Imports.value,\n\t\t\t\t\t\t\t\t\t\ttrue,\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tif (hasChanges) {\n\t\t\t\t\t\t\t\t\tscrollState =\n\t\t\t\t\t\t\t\t\t\tStableEditorScrollState.capture(\n\t\t\t\t\t\t\t\t\t\t\tthis.editor,\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\tthis._currentModelHasFoldedImports =\n\t\t\t\t\t\t\t\t\t\thasChanges;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// some cursors might have moved into hidden regions, make sure they are in expanded regions\n\t\t\t\t\t\t\tconst selections = this.editor.getSelections();\n\t\t\t\t\t\t\tfoldingModel.update(\n\t\t\t\t\t\t\t\tfoldingRanges,\n\t\t\t\t\t\t\t\ttoSelectedLines(selections),\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tscrollState?.restore(this.editor);\n\n\t\t\t\t\t\t\t// update debounce info\n\t\t\t\t\t\t\tconst newValue = this.updateDebounceInfo.update(\n\t\t\t\t\t\t\t\tfoldingModel.textModel,\n\t\t\t\t\t\t\t\tsw.elapsed(),\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tif (this.updateScheduler) {\n\t\t\t\t\t\t\t\tthis.updateScheduler.defaultDelay = newValue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn foldingModel;\n\t\t\t\t\t});\n\t\t\t\t})\n\t\t\t\t.then(undefined, (err) => {\n\t\t\t\t\tonUnexpectedError(err);\n\t\t\t\t\treturn null;\n\t\t\t\t});\n\t\t}\n\t}\n\n\tprivate onHiddenRangesChanges(hiddenRanges: IRange[]) {\n\t\tif (\n\t\t\tthis.hiddenRangeModel &&\n\t\t\thiddenRanges.length &&\n\t\t\t!this._restoringViewState\n\t\t) {\n\t\t\tconst selections = this.editor.getSelections();\n\t\t\tif (selections) {\n\t\t\t\tif (this.hiddenRangeModel.adjustSelections(selections)) {\n\t\t\t\t\tthis.editor.setSelections(selections);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis.editor.setHiddenAreas(hiddenRanges, this);\n\t}\n\n\tprivate onCursorPositionChanged() {\n\t\tif (this.hiddenRangeModel && this.hiddenRangeModel.hasRanges()) {\n\t\t\tthis.cursorChangedScheduler!.schedule();\n\t\t}\n\t}\n\n\tprivate revealCursor() {\n\t\tconst foldingModel = this.getFoldingModel();\n\t\tif (!foldingModel) {\n\t\t\treturn;\n\t\t}\n\t\tfoldingModel\n\t\t\t.then((foldingModel) => {\n\t\t\t\t// null is returned if folding got disabled in the meantime\n\t\t\t\tif (foldingModel) {\n\t\t\t\t\tconst selections = this.editor.getSelections();\n\t\t\t\t\tif (selections && selections.length > 0) {\n\t\t\t\t\t\tconst toToggle: FoldingRegion[] = [];\n\t\t\t\t\t\tfor (const selection of selections) {\n\t\t\t\t\t\t\tconst lineNumber =\n\t\t\t\t\t\t\t\tselection.selectionStartLineNumber;\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\tthis.hiddenRangeModel &&\n\t\t\t\t\t\t\t\tthis.hiddenRangeModel.isHidden(lineNumber)\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\ttoToggle.push(\n\t\t\t\t\t\t\t\t\t...foldingModel.getAllRegionsAtLine(\n\t\t\t\t\t\t\t\t\t\tlineNumber,\n\t\t\t\t\t\t\t\t\t\t(r) =>\n\t\t\t\t\t\t\t\t\t\t\tr.isCollapsed &&\n\t\t\t\t\t\t\t\t\t\t\tlineNumber > r.startLineNumber,\n\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (toToggle.length) {\n\t\t\t\t\t\t\tfoldingModel.toggleCollapseState(toToggle);\n\t\t\t\t\t\t\tthis.reveal(selections[0].getPosition());\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t\t.then(undefined, onUnexpectedError);\n\t}\n\n\tprivate onEditorMouseDown(e: IEditorMouseEvent): void {\n\t\tthis.mouseDownInfo = null;\n\n\t\tif (!this.hiddenRangeModel || !e.target || !e.target.range) {\n\t\t\treturn;\n\t\t}\n\t\tif (!e.event.leftButton && !e.event.middleButton) {\n\t\t\treturn;\n\t\t}\n\t\tconst range = e.target.range;\n\t\tlet iconClicked = false;\n\t\tswitch (e.target.type) {\n\t\t\tcase MouseTargetType.GUTTER_LINE_DECORATIONS: {\n\t\t\t\tconst data = e.target.detail;\n\t\t\t\tconst offsetLeftInGutter = e.target.element!.offsetLeft;\n\t\t\t\tconst gutterOffsetX = data.offsetX - offsetLeftInGutter;\n\n\t\t\t\t// const gutterOffsetX = data.offsetX - data.glyphMarginWidth - data.lineNumbersWidth - data.glyphMarginLeft;\n\n\t\t\t\t// TODO@joao TODO@alex TODO@martin this is such that we don't collide with dirty diff\n\t\t\t\tif (gutterOffsetX < 4) {\n\t\t\t\t\t// the whitespace between the border and the real folding icon border is 4px\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\ticonClicked = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase MouseTargetType.CONTENT_EMPTY: {\n\t\t\t\tif (\n\t\t\t\t\tthis._unfoldOnClickAfterEndOfLine &&\n\t\t\t\t\tthis.hiddenRangeModel.hasRanges()\n\t\t\t\t) {\n\t\t\t\t\tconst data = e.target.detail;\n\t\t\t\t\tif (!data.isAfterLines) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tcase MouseTargetType.CONTENT_TEXT: {\n\t\t\t\tif (this.hiddenRangeModel.hasRanges()) {\n\t\t\t\t\tconst model = this.editor.getModel();\n\t\t\t\t\tif (\n\t\t\t\t\t\tmodel &&\n\t\t\t\t\t\trange.startColumn ===\n\t\t\t\t\t\t\tmodel.getLineMaxColumn(range.startLineNumber)\n\t\t\t\t\t) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tdefault:\n\t\t\t\treturn;\n\t\t}\n\n\t\tthis.mouseDownInfo = { lineNumber: range.startLineNumber, iconClicked };\n\t}\n\n\tprivate onEditorMouseUp(e: IEditorMouseEvent): void {\n\t\tconst foldingModel = this.foldingModel;\n\t\tif (!foldingModel || !this.mouseDownInfo || !e.target) {\n\t\t\treturn;\n\t\t}\n\t\tconst lineNumber = this.mouseDownInfo.lineNumber;\n\t\tconst iconClicked = this.mouseDownInfo.iconClicked;\n\n\t\tconst range = e.target.range;\n\t\tif (!range || range.startLineNumber !== lineNumber) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (iconClicked) {\n\t\t\tif (e.target.type !== MouseTargetType.GUTTER_LINE_DECORATIONS) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t} else {\n\t\t\tconst model = this.editor.getModel();\n\t\t\tif (\n\t\t\t\t!model ||\n\t\t\t\trange.startColumn !== model.getLineMaxColumn(lineNumber)\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tconst region = foldingModel.getRegionAtLine(lineNumber);\n\t\tif (region && region.startLineNumber === lineNumber) {\n\t\t\tconst isCollapsed = region.isCollapsed;\n\t\t\tif (iconClicked || isCollapsed) {\n\t\t\t\tconst surrounding = e.event.altKey;\n\t\t\t\tlet toToggle = [];\n\t\t\t\tif (surrounding) {\n\t\t\t\t\tconst filter = (otherRegion: FoldingRegion) =>\n\t\t\t\t\t\t!otherRegion.containedBy(region) &&\n\t\t\t\t\t\t!region.containedBy(otherRegion);\n\t\t\t\t\tconst toMaybeToggle = foldingModel.getRegionsInside(\n\t\t\t\t\t\tnull,\n\t\t\t\t\t\tfilter,\n\t\t\t\t\t);\n\t\t\t\t\tfor (const r of toMaybeToggle) {\n\t\t\t\t\t\tif (r.isCollapsed) {\n\t\t\t\t\t\t\ttoToggle.push(r);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t// if any surrounding regions are folded, unfold those. Otherwise, fold all surrounding\n\t\t\t\t\tif (toToggle.length === 0) {\n\t\t\t\t\t\ttoToggle = toMaybeToggle;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tconst recursive = e.event.middleButton || e.event.shiftKey;\n\t\t\t\t\tif (recursive) {\n\t\t\t\t\t\tfor (const r of foldingModel.getRegionsInside(region)) {\n\t\t\t\t\t\t\tif (r.isCollapsed === isCollapsed) {\n\t\t\t\t\t\t\t\ttoToggle.push(r);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t// when recursive, first only collapse all children. If all are already folded or there are no children, also fold parent.\n\t\t\t\t\tif (isCollapsed || !recursive || toToggle.length === 0) {\n\t\t\t\t\t\ttoToggle.push(region);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfoldingModel.toggleCollapseState(toToggle);\n\t\t\t\tthis.reveal({ lineNumber, column: 1 });\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic reveal(position: IPosition): void {\n\t\tthis.editor.revealPositionInCenterIfOutsideViewport(\n\t\t\tposition,\n\t\t\tScrollType.Smooth,\n\t\t);\n\t}\n}\n\nexport class RangesLimitReporter implements FoldingLimitReporter {\n\tconstructor(private readonly editor: ICodeEditor) {}\n\n\tpublic get limit() {\n\t\treturn this.editor.getOptions().get(EditorOption.foldingMaximumRegions);\n\t}\n\n\tprivate _onDidChange = new Emitter<void>();\n\tpublic readonly onDidChange: Event<void> = this._onDidChange.event;\n\n\tprivate _computed = 0;\n\tprivate _limited: number | false = false;\n\tpublic get computed(): number {\n\t\treturn this._computed;\n\t}\n\tpublic get limited(): number | false {\n\t\treturn this._limited;\n\t}\n\tpublic update(computed: number, limited: number | false) {\n\t\tif (computed !== this._computed || limited !== this._limited) {\n\t\t\tthis._computed = computed;\n\t\t\tthis._limited = limited;\n\t\t\tthis._onDidChange.fire();\n\t\t}\n\t}\n}\n\nabstract class FoldingAction<T> extends EditorAction {\n\tabstract invoke(\n\t\tfoldingController: FoldingController,\n\t\tfoldingModel: FoldingModel,\n\t\teditor: ICodeEditor,\n\t\targs: T,\n\t\tlanguageConfigurationService: ILanguageConfigurationService,\n\t): void;\n\n\tpublic override runEditorCommand(\n\t\taccessor: ServicesAccessor,\n\t\teditor: ICodeEditor,\n\t\targs: T,\n\t): void | Promise<void> {\n\t\tconst languageConfigurationService = accessor.get(\n\t\t\tILanguageConfigurationService,\n\t\t);\n\t\tconst foldingController = FoldingController.get(editor);\n\t\tif (!foldingController) {\n\t\t\treturn;\n\t\t}\n\t\tconst foldingModelPromise = foldingController.getFoldingModel();\n\t\tif (foldingModelPromise) {\n\t\t\tthis.reportTelemetry(accessor, editor);\n\t\t\treturn foldingModelPromise.then((foldingModel) => {\n\t\t\t\tif (foldingModel) {\n\t\t\t\t\tthis.invoke(\n\t\t\t\t\t\tfoldingController,\n\t\t\t\t\t\tfoldingModel,\n\t\t\t\t\t\teditor,\n\t\t\t\t\t\targs,\n\t\t\t\t\t\tlanguageConfigurationService,\n\t\t\t\t\t);\n\t\t\t\t\tconst selection = editor.getSelection();\n\t\t\t\t\tif (selection) {\n\t\t\t\t\t\tfoldingController.reveal(selection.getStartPosition());\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tprotected getSelectedLines(editor: ICodeEditor) {\n\t\tconst selections = editor.getSelections();\n\t\treturn selections ? selections.map((s) => s.startLineNumber) : [];\n\t}\n\n\tprotected getLineNumbers(args: FoldingArguments, editor: ICodeEditor) {\n\t\tif (args && args.selectionLines) {\n\t\t\treturn args.selectionLines.map((l) => l + 1); // to 0-bases line numbers\n\t\t}\n\t\treturn this.getSelectedLines(editor);\n\t}\n\n\tpublic run(_accessor: ServicesAccessor, _editor: ICodeEditor): void {}\n}\n\nexport interface SelectedLines {\n\tstartsInside(startLine: number, endLine: number): boolean;\n}\n\nexport function toSelectedLines(selections: Selection[] | null): SelectedLines {\n\tif (!selections || selections.length === 0) {\n\t\treturn {\n\t\t\tstartsInside: () => false,\n\t\t};\n\t}\n\treturn {\n\t\tstartsInside(startLine: number, endLine: number): boolean {\n\t\t\tfor (const s of selections) {\n\t\t\t\tconst line = s.startLineNumber;\n\t\t\t\tif (line >= startLine && line <= endLine) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false;\n\t\t},\n\t};\n}\n\ninterface FoldingArguments {\n\tlevels?: number;\n\tdirection?: \"up\" | \"down\";\n\tselectionLines?: number[];\n}\n\nfunction foldingArgumentsConstraint(args: any) {\n\tif (!types.isUndefined(args)) {\n\t\tif (!types.isObject(args)) {\n\t\t\treturn false;\n\t\t}\n\t\tconst foldingArgs: FoldingArguments = args;\n\t\tif (\n\t\t\t!types.isUndefined(foldingArgs.levels) &&\n\t\t\t!types.isNumber(foldingArgs.levels)\n\t\t) {\n\t\t\treturn false;\n\t\t}\n\t\tif (\n\t\t\t!types.isUndefined(foldingArgs.direction) &&\n\t\t\t!types.isString(foldingArgs.direction)\n\t\t) {\n\t\t\treturn false;\n\t\t}\n\t\tif (\n\t\t\t!types.isUndefined(foldingArgs.selectionLines) &&\n\t\t\t(!Array.isArray(foldingArgs.selectionLines) ||\n\t\t\t\t!foldingArgs.selectionLines.every(types.isNumber))\n\t\t) {\n\t\t\treturn false;\n\t\t}\n\t}\n\treturn true;\n}\n\nclass UnfoldAction extends FoldingAction<FoldingArguments> {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: \"editor.unfold\",\n\t\t\tlabel: nls.localize(\"unfoldAction.label\", \"Unfold\"),\n\t\t\talias: \"Unfold\",\n\t\t\tprecondition: CONTEXT_FOLDING_ENABLED,\n\t\t\tkbOpts: {\n\t\t\t\tkbExpr: EditorContextKeys.editorTextFocus,\n\t\t\t\tprimary: KeyMod.CtrlCmd | KeyMod.Shift | KeyCode.BracketRight,\n\t\t\t\tmac: {\n\t\t\t\t\tprimary: KeyMod.CtrlCmd | KeyMod.Alt | KeyCode.BracketRight,\n\t\t\t\t},\n\t\t\t\tweight: KeybindingWeight.EditorContrib,\n\t\t\t},\n\t\t\tmetadata: {\n\t\t\t\tdescription: \"Unfold the content in the editor\",\n\t\t\t\targs: [\n\t\t\t\t\t{\n\t\t\t\t\t\tname: \"Unfold editor argument\",\n\t\t\t\t\t\tdescription: `Property-value pairs that can be passed through this argument:\n\t\t\t\t\t\t* 'levels': Number of levels to unfold. If not set, defaults to 1.\n\t\t\t\t\t\t* 'direction': If 'up', unfold given number of levels up otherwise unfolds down.\n\t\t\t\t\t\t* 'selectionLines': Array of the start lines (0-based) of the editor selections to apply the unfold action to. If not set, the active selection(s) will be used.\n\t\t\t\t\t\t`,\n\t\t\t\t\t\tconstraint: foldingArgumentsConstraint,\n\t\t\t\t\t\tschema: {\n\t\t\t\t\t\t\ttype: \"object\",\n\t\t\t\t\t\t\tproperties: {\n\t\t\t\t\t\t\t\tlevels: {\n\t\t\t\t\t\t\t\t\ttype: \"number\",\n\t\t\t\t\t\t\t\t\tdefault: 1,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tdirection: {\n\t\t\t\t\t\t\t\t\ttype: \"string\",\n\t\t\t\t\t\t\t\t\tenum: [\"up\", \"down\"],\n\t\t\t\t\t\t\t\t\tdefault: \"down\",\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tselectionLines: {\n\t\t\t\t\t\t\t\t\ttype: \"array\",\n\t\t\t\t\t\t\t\t\titems: {\n\t\t\t\t\t\t\t\t\t\ttype: \"number\",\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t});\n\t}\n\n\tinvoke(\n\t\t_foldingController: FoldingController,\n\t\tfoldingModel: FoldingModel,\n\t\teditor: ICodeEditor,\n\t\targs: FoldingArguments,\n\t): void {\n\t\tconst levels = (args && args.levels) || 1;\n\t\tconst lineNumbers = this.getLineNumbers(args, editor);\n\t\tif (args && args.direction === \"up\") {\n\t\t\tsetCollapseStateLevelsUp(foldingModel, false, levels, lineNumbers);\n\t\t} else {\n\t\t\tsetCollapseStateLevelsDown(\n\t\t\t\tfoldingModel,\n\t\t\t\tfalse,\n\t\t\t\tlevels,\n\t\t\t\tlineNumbers,\n\t\t\t);\n\t\t}\n\t}\n}\n\nclass UnFoldRecursivelyAction extends FoldingAction<void> {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: \"editor.unfoldRecursively\",\n\t\t\tlabel: nls.localize(\n\t\t\t\t\"unFoldRecursivelyAction.label\",\n\t\t\t\t\"Unfold Recursively\",\n\t\t\t),\n\t\t\talias: \"Unfold Recursively\",\n\t\t\tprecondition: CONTEXT_FOLDING_ENABLED,\n\t\t\tkbOpts: {\n\t\t\t\tkbExpr: EditorContextKeys.editorTextFocus,\n\t\t\t\tprimary: KeyChord(\n\t\t\t\t\tKeyMod.CtrlCmd | KeyCode.KeyK,\n\t\t\t\t\tKeyMod.CtrlCmd | KeyCode.BracketRight,\n\t\t\t\t),\n\t\t\t\tweight: KeybindingWeight.EditorContrib,\n\t\t\t},\n\t\t});\n\t}\n\n\tinvoke(\n\t\t_foldingController: FoldingController,\n\t\tfoldingModel: FoldingModel,\n\t\teditor: ICodeEditor,\n\t\t_args: any,\n\t): void {\n\t\tsetCollapseStateLevelsDown(\n\t\t\tfoldingModel,\n\t\t\tfalse,\n\t\t\tNumber.MAX_VALUE,\n\t\t\tthis.getSelectedLines(editor),\n\t\t);\n\t}\n}\n\nclass FoldAction extends FoldingAction<FoldingArguments> {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: \"editor.fold\",\n\t\t\tlabel: nls.localize(\"foldAction.label\", \"Fold\"),\n\t\t\talias: \"Fold\",\n\t\t\tprecondition: CONTEXT_FOLDING_ENABLED,\n\t\t\tkbOpts: {\n\t\t\t\tkbExpr: EditorContextKeys.editorTextFocus,\n\t\t\t\tprimary: KeyMod.CtrlCmd | KeyMod.Shift | KeyCode.BracketLeft,\n\t\t\t\tmac: {\n\t\t\t\t\tprimary: KeyMod.CtrlCmd | KeyMod.Alt | KeyCode.BracketLeft,\n\t\t\t\t},\n\t\t\t\tweight: KeybindingWeight.EditorContrib,\n\t\t\t},\n\t\t\tmetadata: {\n\t\t\t\tdescription: \"Fold the content in the editor\",\n\t\t\t\targs: [\n\t\t\t\t\t{\n\t\t\t\t\t\tname: \"Fold editor argument\",\n\t\t\t\t\t\tdescription: `Property-value pairs that can be passed through this argument:\n\t\t\t\t\t\t\t* 'levels': Number of levels to fold.\n\t\t\t\t\t\t\t* 'direction': If 'up', folds given number of levels up otherwise folds down.\n\t\t\t\t\t\t\t* 'selectionLines': Array of the start lines (0-based) of the editor selections to apply the fold action to. If not set, the active selection(s) will be used.\n\t\t\t\t\t\t\tIf no levels or direction is set, folds the region at the locations or if already collapsed, the first uncollapsed parent instead.\n\t\t\t\t\t\t`,\n\t\t\t\t\t\tconstraint: foldingArgumentsConstraint,\n\t\t\t\t\t\tschema: {\n\t\t\t\t\t\t\ttype: \"object\",\n\t\t\t\t\t\t\tproperties: {\n\t\t\t\t\t\t\t\tlevels: {\n\t\t\t\t\t\t\t\t\ttype: \"number\",\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tdirection: {\n\t\t\t\t\t\t\t\t\ttype: \"string\",\n\t\t\t\t\t\t\t\t\tenum: [\"up\", \"down\"],\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tselectionLines: {\n\t\t\t\t\t\t\t\t\ttype: \"array\",\n\t\t\t\t\t\t\t\t\titems: {\n\t\t\t\t\t\t\t\t\t\ttype: \"number\",\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t});\n\t}\n\n\tinvoke(\n\t\t_foldingController: FoldingController,\n\t\tfoldingModel: FoldingModel,\n\t\teditor: ICodeEditor,\n\t\targs: FoldingArguments,\n\t): void {\n\t\tconst lineNumbers = this.getLineNumbers(args, editor);\n\n\t\tconst levels = args && args.levels;\n\t\tconst direction = args && args.direction;\n\n\t\tif (typeof levels !== \"number\" && typeof direction !== \"string\") {\n\t\t\t// fold the region at the location or if already collapsed, the first uncollapsed parent instead.\n\t\t\tsetCollapseStateUp(foldingModel, true, lineNumbers);\n\t\t} else if (direction === \"up\") {\n\t\t\tsetCollapseStateLevelsUp(\n\t\t\t\tfoldingModel,\n\t\t\t\ttrue,\n\t\t\t\tlevels || 1,\n\t\t\t\tlineNumbers,\n\t\t\t);\n\t\t} else {\n\t\t\tsetCollapseStateLevelsDown(\n\t\t\t\tfoldingModel,\n\t\t\t\ttrue,\n\t\t\t\tlevels || 1,\n\t\t\t\tlineNumbers,\n\t\t\t);\n\t\t}\n\t}\n}\n\nclass ToggleFoldAction extends FoldingAction<void> {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: \"editor.toggleFold\",\n\t\t\tlabel: nls.localize(\"toggleFoldAction.label\", \"Toggle Fold\"),\n\t\t\talias: \"Toggle Fold\",\n\t\t\tprecondition: CONTEXT_FOLDING_ENABLED,\n\t\t\tkbOpts: {\n\t\t\t\tkbExpr: EditorContextKeys.editorTextFocus,\n\t\t\t\tprimary: KeyChord(\n\t\t\t\t\tKeyMod.CtrlCmd | KeyCode.KeyK,\n\t\t\t\t\tKeyMod.CtrlCmd | KeyCode.KeyL,\n\t\t\t\t),\n\t\t\t\tweight: KeybindingWeight.EditorContrib,\n\t\t\t},\n\t\t});\n\t}\n\n\tinvoke(\n\t\t_foldingController: FoldingController,\n\t\tfoldingModel: FoldingModel,\n\t\teditor: ICodeEditor,\n\t): void {\n\t\tconst selectedLines = this.getSelectedLines(editor);\n\t\ttoggleCollapseState(foldingModel, 1, selectedLines);\n\t}\n}\n\nclass FoldRecursivelyAction extends FoldingAction<void> {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: \"editor.foldRecursively\",\n\t\t\tlabel: nls.localize(\n\t\t\t\t\"foldRecursivelyAction.label\",\n\t\t\t\t\"Fold Recursively\",\n\t\t\t),\n\t\t\talias: \"Fold Recursively\",\n\t\t\tprecondition: CONTEXT_FOLDING_ENABLED,\n\t\t\tkbOpts: {\n\t\t\t\tkbExpr: EditorContextKeys.editorTextFocus,\n\t\t\t\tprimary: KeyChord(\n\t\t\t\t\tKeyMod.CtrlCmd | KeyCode.KeyK,\n\t\t\t\t\tKeyMod.CtrlCmd | KeyCode.BracketLeft,\n\t\t\t\t),\n\t\t\t\tweight: KeybindingWeight.EditorContrib,\n\t\t\t},\n\t\t});\n\t}\n\n\tinvoke(\n\t\t_foldingController: FoldingController,\n\t\tfoldingModel: FoldingModel,\n\t\teditor: ICodeEditor,\n\t): void {\n\t\tconst selectedLines = this.getSelectedLines(editor);\n\t\tsetCollapseStateLevelsDown(\n\t\t\tfoldingModel,\n\t\t\ttrue,\n\t\t\tNumber.MAX_VALUE,\n\t\t\tselectedLines,\n\t\t);\n\t}\n}\n\nclass ToggleFoldRecursivelyAction extends FoldingAction<void> {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: \"editor.toggleFoldRecursively\",\n\t\t\tlabel: nls.localize(\n\t\t\t\t\"toggleFoldRecursivelyAction.label\",\n\t\t\t\t\"Toggle Fold Recursively\",\n\t\t\t),\n\t\t\talias: \"Toggle Fold Recursively\",\n\t\t\tprecondition: CONTEXT_FOLDING_ENABLED,\n\t\t\tkbOpts: {\n\t\t\t\tkbExpr: EditorContextKeys.editorTextFocus,\n\t\t\t\tprimary: KeyChord(\n\t\t\t\t\tKeyMod.CtrlCmd | KeyCode.KeyK,\n\t\t\t\t\tKeyMod.CtrlCmd | KeyMod.Shift | KeyCode.KeyL,\n\t\t\t\t),\n\t\t\t\tweight: KeybindingWeight.EditorContrib,\n\t\t\t},\n\t\t});\n\t}\n\n\tinvoke(\n\t\t_foldingController: FoldingController,\n\t\tfoldingModel: FoldingModel,\n\t\teditor: ICodeEditor,\n\t): void {\n\t\tconst selectedLines = this.getSelectedLines(editor);\n\t\ttoggleCollapseState(foldingModel, Number.MAX_VALUE, selectedLines);\n\t}\n}\n\nclass FoldAllBlockCommentsAction extends FoldingAction<void> {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: \"editor.foldAllBlockComments\",\n\t\t\tlabel: nls.localize(\n\t\t\t\t\"foldAllBlockComments.label\",\n\t\t\t\t\"Fold All Block Comments\",\n\t\t\t),\n\t\t\talias: \"Fold All Block Comments\",\n\t\t\tprecondition: CONTEXT_FOLDING_ENABLED,\n\t\t\tkbOpts: {\n\t\t\t\tkbExpr: EditorContextKeys.editorTextFocus,\n\t\t\t\tprimary: KeyChord(\n\t\t\t\t\tKeyMod.CtrlCmd | KeyCode.KeyK,\n\t\t\t\t\tKeyMod.CtrlCmd | KeyCode.Slash,\n\t\t\t\t),\n\t\t\t\tweight: KeybindingWeight.EditorContrib,\n\t\t\t},\n\t\t});\n\t}\n\n\tinvoke(\n\t\t_foldingController: FoldingController,\n\t\tfoldingModel: FoldingModel,\n\t\teditor: ICodeEditor,\n\t\targs: void,\n\t\tlanguageConfigurationService: ILanguageConfigurationService,\n\t): void {\n\t\tif (foldingModel.regions.hasTypes()) {\n\t\t\tsetCollapseStateForType(\n\t\t\t\tfoldingModel,\n\t\t\t\tFoldingRangeKind.Comment.value,\n\t\t\t\ttrue,\n\t\t\t);\n\t\t} else {\n\t\t\tconst editorModel = editor.getModel();\n\t\t\tif (!editorModel) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst comments =\n\t\t\t\tlanguageConfigurationService.getLanguageConfiguration(\n\t\t\t\t\teditorModel.getLanguageId(),\n\t\t\t\t).comments;\n\t\t\tif (comments && comments.blockCommentStartToken) {\n\t\t\t\tconst regExp = new RegExp(\n\t\t\t\t\t\"^\\\\s*\" +\n\t\t\t\t\t\tescapeRegExpCharacters(comments.blockCommentStartToken),\n\t\t\t\t);\n\t\t\t\tsetCollapseStateForMatchingLines(foldingModel, regExp, true);\n\t\t\t}\n\t\t}\n\t}\n}\n\nclass FoldAllRegionsAction extends FoldingAction<void> {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: \"editor.foldAllMarkerRegions\",\n\t\t\tlabel: nls.localize(\n\t\t\t\t\"foldAllMarkerRegions.label\",\n\t\t\t\t\"Fold All Regions\",\n\t\t\t),\n\t\t\talias: \"Fold All Regions\",\n\t\t\tprecondition: CONTEXT_FOLDING_ENABLED,\n\t\t\tkbOpts: {\n\t\t\t\tkbExpr: EditorContextKeys.editorTextFocus,\n\t\t\t\tprimary: KeyChord(\n\t\t\t\t\tKeyMod.CtrlCmd | KeyCode.KeyK,\n\t\t\t\t\tKeyMod.CtrlCmd | KeyCode.Digit8,\n\t\t\t\t),\n\t\t\t\tweight: KeybindingWeight.EditorContrib,\n\t\t\t},\n\t\t});\n\t}\n\n\tinvoke(\n\t\t_foldingController: FoldingController,\n\t\tfoldingModel: FoldingModel,\n\t\teditor: ICodeEditor,\n\t\targs: void,\n\t\tlanguageConfigurationService: ILanguageConfigurationService,\n\t): void {\n\t\tif (foldingModel.regions.hasTypes()) {\n\t\t\tsetCollapseStateForType(\n\t\t\t\tfoldingModel,\n\t\t\t\tFoldingRangeKind.Region.value,\n\t\t\t\ttrue,\n\t\t\t);\n\t\t} else {\n\t\t\tconst editorModel = editor.getModel();\n\t\t\tif (!editorModel) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst foldingRules =\n\t\t\t\tlanguageConfigurationService.getLanguageConfiguration(\n\t\t\t\t\teditorModel.getLanguageId(),\n\t\t\t\t).foldingRules;\n\t\t\tif (\n\t\t\t\tfoldingRules &&\n\t\t\t\tfoldingRules.markers &&\n\t\t\t\tfoldingRules.markers.start\n\t\t\t) {\n\t\t\t\tconst regExp = new RegExp(foldingRules.markers.start);\n\t\t\t\tsetCollapseStateForMatchingLines(foldingModel, regExp, true);\n\t\t\t}\n\t\t}\n\t}\n}\n\nclass UnfoldAllRegionsAction extends FoldingAction<void> {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: \"editor.unfoldAllMarkerRegions\",\n\t\t\tlabel: nls.localize(\n\t\t\t\t\"unfoldAllMarkerRegions.label\",\n\t\t\t\t\"Unfold All Regions\",\n\t\t\t),\n\t\t\talias: \"Unfold All Regions\",\n\t\t\tprecondition: CONTEXT_FOLDING_ENABLED,\n\t\t\tkbOpts: {\n\t\t\t\tkbExpr: EditorContextKeys.editorTextFocus,\n\t\t\t\tprimary: KeyChord(\n\t\t\t\t\tKeyMod.CtrlCmd | KeyCode.KeyK,\n\t\t\t\t\tKeyMod.CtrlCmd | KeyCode.Digit9,\n\t\t\t\t),\n\t\t\t\tweight: KeybindingWeight.EditorContrib,\n\t\t\t},\n\t\t});\n\t}\n\n\tinvoke(\n\t\t_foldingController: FoldingController,\n\t\tfoldingModel: FoldingModel,\n\t\teditor: ICodeEditor,\n\t\targs: void,\n\t\tlanguageConfigurationService: ILanguageConfigurationService,\n\t): void {\n\t\tif (foldingModel.regions.hasTypes()) {\n\t\t\tsetCollapseStateForType(\n\t\t\t\tfoldingModel,\n\t\t\t\tFoldingRangeKind.Region.value,\n\t\t\t\tfalse,\n\t\t\t);\n\t\t} else {\n\t\t\tconst editorModel = editor.getModel();\n\t\t\tif (!editorModel) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst foldingRules =\n\t\t\t\tlanguageConfigurationService.getLanguageConfiguration(\n\t\t\t\t\teditorModel.getLanguageId(),\n\t\t\t\t).foldingRules;\n\t\t\tif (\n\t\t\t\tfoldingRules &&\n\t\t\t\tfoldingRules.markers &&\n\t\t\t\tfoldingRules.markers.start\n\t\t\t) {\n\t\t\t\tconst regExp = new RegExp(foldingRules.markers.start);\n\t\t\t\tsetCollapseStateForMatchingLines(foldingModel, regExp, false);\n\t\t\t}\n\t\t}\n\t}\n}\n\nclass FoldAllExceptAction extends FoldingAction<void> {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: \"editor.foldAllExcept\",\n\t\t\tlabel: nls.localize(\n\t\t\t\t\"foldAllExcept.label\",\n\t\t\t\t\"Fold All Except Selected\",\n\t\t\t),\n\t\t\talias: \"Fold All Except Selected\",\n\t\t\tprecondition: CONTEXT_FOLDING_ENABLED,\n\t\t\tkbOpts: {\n\t\t\t\tkbExpr: EditorContextKeys.editorTextFocus,\n\t\t\t\tprimary: KeyChord(\n\t\t\t\t\tKeyMod.CtrlCmd | KeyCode.KeyK,\n\t\t\t\t\tKeyMod.CtrlCmd | KeyCode.Minus,\n\t\t\t\t),\n\t\t\t\tweight: KeybindingWeight.EditorContrib,\n\t\t\t},\n\t\t});\n\t}\n\n\tinvoke(\n\t\t_foldingController: FoldingController,\n\t\tfoldingModel: FoldingModel,\n\t\teditor: ICodeEditor,\n\t): void {\n\t\tconst selectedLines = this.getSelectedLines(editor);\n\t\tsetCollapseStateForRest(foldingModel, true, selectedLines);\n\t}\n}\n\nclass UnfoldAllExceptAction extends FoldingAction<void> {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: \"editor.unfoldAllExcept\",\n\t\t\tlabel: nls.localize(\n\t\t\t\t\"unfoldAllExcept.label\",\n\t\t\t\t\"Unfold All Except Selected\",\n\t\t\t),\n\t\t\talias: \"Unfold All Except Selected\",\n\t\t\tprecondition: CONTEXT_FOLDING_ENABLED,\n\t\t\tkbOpts: {\n\t\t\t\tkbExpr: EditorContextKeys.editorTextFocus,\n\t\t\t\tprimary: KeyChord(\n\t\t\t\t\tKeyMod.CtrlCmd | KeyCode.KeyK,\n\t\t\t\t\tKeyMod.CtrlCmd | KeyCode.Equal,\n\t\t\t\t),\n\t\t\t\tweight: KeybindingWeight.EditorContrib,\n\t\t\t},\n\t\t});\n\t}\n\n\tinvoke(\n\t\t_foldingController: FoldingController,\n\t\tfoldingModel: FoldingModel,\n\t\teditor: ICodeEditor,\n\t): void {\n\t\tconst selectedLines = this.getSelectedLines(editor);\n\t\tsetCollapseStateForRest(foldingModel, false, selectedLines);\n\t}\n}\n\nclass FoldAllAction extends FoldingAction<void> {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: \"editor.foldAll\",\n\t\t\tlabel: nls.localize(\"foldAllAction.label\", \"Fold All\"),\n\t\t\talias: \"Fold All\",\n\t\t\tprecondition: CONTEXT_FOLDING_ENABLED,\n\t\t\tkbOpts: {\n\t\t\t\tkbExpr: EditorContextKeys.editorTextFocus,\n\t\t\t\tprimary: KeyChord(\n\t\t\t\t\tKeyMod.CtrlCmd | KeyCode.KeyK,\n\t\t\t\t\tKeyMod.CtrlCmd | KeyCode.Digit0,\n\t\t\t\t),\n\t\t\t\tweight: KeybindingWeight.EditorContrib,\n\t\t\t},\n\t\t});\n\t}\n\n\tinvoke(\n\t\t_foldingController: FoldingController,\n\t\tfoldingModel: FoldingModel,\n\t\t_editor: ICodeEditor,\n\t): void {\n\t\tsetCollapseStateLevelsDown(foldingModel, true);\n\t}\n}\n\nclass UnfoldAllAction extends FoldingAction<void> {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: \"editor.unfoldAll\",\n\t\t\tlabel: nls.localize(\"unfoldAllAction.label\", \"Unfold All\"),\n\t\t\talias: \"Unfold All\",\n\t\t\tprecondition: CONTEXT_FOLDING_ENABLED,\n\t\t\tkbOpts: {\n\t\t\t\tkbExpr: EditorContextKeys.editorTextFocus,\n\t\t\t\tprimary: KeyChord(\n\t\t\t\t\tKeyMod.CtrlCmd | KeyCode.KeyK,\n\t\t\t\t\tKeyMod.CtrlCmd | KeyCode.KeyJ,\n\t\t\t\t),\n\t\t\t\tweight: KeybindingWeight.EditorContrib,\n\t\t\t},\n\t\t});\n\t}\n\n\tinvoke(\n\t\t_foldingController: FoldingController,\n\t\tfoldingModel: FoldingModel,\n\t\t_editor: ICodeEditor,\n\t): void {\n\t\tsetCollapseStateLevelsDown(foldingModel, false);\n\t}\n}\n\nclass FoldLevelAction extends FoldingAction<void> {\n\tprivate static readonly ID_PREFIX = \"editor.foldLevel\";\n\tpublic static readonly ID = (level: number) =>\n\t\tFoldLevelAction.ID_PREFIX + level;\n\n\tprivate getFoldingLevel() {\n\t\treturn Number.parseInt(\n\t\t\tthis.id.substr(FoldLevelAction.ID_PREFIX.length),\n\t\t);\n\t}\n\n\tinvoke(\n\t\t_foldingController: FoldingController,\n\t\tfoldingModel: FoldingModel,\n\t\teditor: ICodeEditor,\n\t): void {\n\t\tsetCollapseStateAtLevel(\n\t\t\tfoldingModel,\n\t\t\tthis.getFoldingLevel(),\n\t\t\ttrue,\n\t\t\tthis.getSelectedLines(editor),\n\t\t);\n\t}\n}\n\n/** Action to go to the parent fold of current line */\nclass GotoParentFoldAction extends FoldingAction<void> {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: \"editor.gotoParentFold\",\n\t\t\tlabel: nls.localize(\"gotoParentFold.label\", \"Go to Parent Fold\"),\n\t\t\talias: \"Go to Parent Fold\",\n\t\t\tprecondition: CONTEXT_FOLDING_ENABLED,\n\t\t\tkbOpts: {\n\t\t\t\tkbExpr: EditorContextKeys.editorTextFocus,\n\t\t\t\tweight: KeybindingWeight.EditorContrib,\n\t\t\t},\n\t\t});\n\t}\n\n\tinvoke(\n\t\t_foldingController: FoldingController,\n\t\tfoldingModel: FoldingModel,\n\t\teditor: ICodeEditor,\n\t): void {\n\t\tconst selectedLines = this.getSelectedLines(editor);\n\t\tif (selectedLines.length > 0) {\n\t\t\tconst startLineNumber = getParentFoldLine(\n\t\t\t\tselectedLines[0],\n\t\t\t\tfoldingModel,\n\t\t\t);\n\t\t\tif (startLineNumber !== null) {\n\t\t\t\teditor.setSelection({\n\t\t\t\t\tstartLineNumber: startLineNumber,\n\t\t\t\t\tstartColumn: 1,\n\t\t\t\t\tendLineNumber: startLineNumber,\n\t\t\t\t\tendColumn: 1,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n}\n\n/** Action to go to the previous fold of current line */\nclass GotoPreviousFoldAction extends FoldingAction<void> {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: \"editor.gotoPreviousFold\",\n\t\t\tlabel: nls.localize(\n\t\t\t\t\"gotoPreviousFold.label\",\n\t\t\t\t\"Go to Previous Folding Range\",\n\t\t\t),\n\t\t\talias: \"Go to Previous Folding Range\",\n\t\t\tprecondition: CONTEXT_FOLDING_ENABLED,\n\t\t\tkbOpts: {\n\t\t\t\tkbExpr: EditorContextKeys.editorTextFocus,\n\t\t\t\tweight: KeybindingWeight.EditorContrib,\n\t\t\t},\n\t\t});\n\t}\n\n\tinvoke(\n\t\t_foldingController: FoldingController,\n\t\tfoldingModel: FoldingModel,\n\t\teditor: ICodeEditor,\n\t): void {\n\t\tconst selectedLines = this.getSelectedLines(editor);\n\t\tif (selectedLines.length > 0) {\n\t\t\tconst startLineNumber = getPreviousFoldLine(\n\t\t\t\tselectedLines[0],\n\t\t\t\tfoldingModel,\n\t\t\t);\n\t\t\tif (startLineNumber !== null) {\n\t\t\t\teditor.setSelection({\n\t\t\t\t\tstartLineNumber: startLineNumber,\n\t\t\t\t\tstartColumn: 1,\n\t\t\t\t\tendLineNumber: startLineNumber,\n\t\t\t\t\tendColumn: 1,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n}\n\n/** Action to go to the next fold of current line */\nclass GotoNextFoldAction extends FoldingAction<void> {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: \"editor.gotoNextFold\",\n\t\t\tlabel: nls.localize(\n\t\t\t\t\"gotoNextFold.label\",\n\t\t\t\t\"Go to Next Folding Range\",\n\t\t\t),\n\t\t\talias: \"Go to Next Folding Range\",\n\t\t\tprecondition: CONTEXT_FOLDING_ENABLED,\n\t\t\tkbOpts: {\n\t\t\t\tkbExpr: EditorContextKeys.editorTextFocus,\n\t\t\t\tweight: KeybindingWeight.EditorContrib,\n\t\t\t},\n\t\t});\n\t}\n\n\tinvoke(\n\t\t_foldingController: FoldingController,\n\t\tfoldingModel: FoldingModel,\n\t\teditor: ICodeEditor,\n\t): void {\n\t\tconst selectedLines = this.getSelectedLines(editor);\n\t\tif (selectedLines.length > 0) {\n\t\t\tconst startLineNumber = getNextFoldLine(\n\t\t\t\tselectedLines[0],\n\t\t\t\tfoldingModel,\n\t\t\t);\n\t\t\tif (startLineNumber !== null) {\n\t\t\t\teditor.setSelection({\n\t\t\t\t\tstartLineNumber: startLineNumber,\n\t\t\t\t\tstartColumn: 1,\n\t\t\t\t\tendLineNumber: startLineNumber,\n\t\t\t\t\tendColumn: 1,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n}\n\nclass FoldRangeFromSelectionAction extends FoldingAction<void> {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: \"editor.createFoldingRangeFromSelection\",\n\t\t\tlabel: nls.localize(\n\t\t\t\t\"createManualFoldRange.label\",\n\t\t\t\t\"Create Folding Range from Selection\",\n\t\t\t),\n\t\t\talias: \"Create Folding Range from Selection\",\n\t\t\tprecondition: CONTEXT_FOLDING_ENABLED,\n\t\t\tkbOpts: {\n\t\t\t\tkbExpr: EditorContextKeys.editorTextFocus,\n\t\t\t\tprimary: KeyChord(\n\t\t\t\t\tKeyMod.CtrlCmd | KeyCode.KeyK,\n\t\t\t\t\tKeyMod.CtrlCmd | KeyCode.Comma,\n\t\t\t\t),\n\t\t\t\tweight: KeybindingWeight.EditorContrib,\n\t\t\t},\n\t\t});\n\t}\n\n\tinvoke(\n\t\t_foldingController: FoldingController,\n\t\tfoldingModel: FoldingModel,\n\t\teditor: ICodeEditor,\n\t): void {\n\t\tconst collapseRanges: FoldRange[] = [];\n\t\tconst selections = editor.getSelections();\n\t\tif (selections) {\n\t\t\tfor (const selection of selections) {\n\t\t\t\tlet endLineNumber = selection.endLineNumber;\n\t\t\t\tif (selection.endColumn === 1) {\n\t\t\t\t\t--endLineNumber;\n\t\t\t\t}\n\t\t\t\tif (endLineNumber > selection.startLineNumber) {\n\t\t\t\t\tcollapseRanges.push({\n\t\t\t\t\t\tstartLineNumber: selection.startLineNumber,\n\t\t\t\t\t\tendLineNumber: endLineNumber,\n\t\t\t\t\t\ttype: undefined,\n\t\t\t\t\t\tisCollapsed: true,\n\t\t\t\t\t\tsource: FoldSource.userDefined,\n\t\t\t\t\t});\n\t\t\t\t\teditor.setSelection({\n\t\t\t\t\t\tstartLineNumber: selection.startLineNumber,\n\t\t\t\t\t\tstartColumn: 1,\n\t\t\t\t\t\tendLineNumber: selection.startLineNumber,\n\t\t\t\t\t\tendColumn: 1,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (collapseRanges.length > 0) {\n\t\t\t\tcollapseRanges.sort((a, b) => {\n\t\t\t\t\treturn a.startLineNumber - b.startLineNumber;\n\t\t\t\t});\n\t\t\t\tconst newRanges = FoldingRegions.sanitizeAndMerge(\n\t\t\t\t\tfoldingModel.regions,\n\t\t\t\t\tcollapseRanges,\n\t\t\t\t\teditor.getModel()?.getLineCount(),\n\t\t\t\t);\n\t\t\t\tfoldingModel.updatePost(\n\t\t\t\t\tFoldingRegions.fromFoldRanges(newRanges),\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n}\n\nclass RemoveFoldRangeFromSelectionAction extends FoldingAction<void> {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: \"editor.removeManualFoldingRanges\",\n\t\t\tlabel: nls.localize(\n\t\t\t\t\"removeManualFoldingRanges.label\",\n\t\t\t\t\"Remove Manual Folding Ranges\",\n\t\t\t),\n\t\t\talias: \"Remove Manual Folding Ranges\",\n\t\t\tprecondition: CONTEXT_FOLDING_ENABLED,\n\t\t\tkbOpts: {\n\t\t\t\tkbExpr: EditorContextKeys.editorTextFocus,\n\t\t\t\tprimary: KeyChord(\n\t\t\t\t\tKeyMod.CtrlCmd | KeyCode.KeyK,\n\t\t\t\t\tKeyMod.CtrlCmd | KeyCode.Period,\n\t\t\t\t),\n\t\t\t\tweight: KeybindingWeight.EditorContrib,\n\t\t\t},\n\t\t});\n\t}\n\n\tinvoke(\n\t\tfoldingController: FoldingController,\n\t\tfoldingModel: FoldingModel,\n\t\teditor: ICodeEditor,\n\t): void {\n\t\tconst selections = editor.getSelections();\n\t\tif (selections) {\n\t\t\tconst ranges: ILineRange[] = [];\n\t\t\tfor (const selection of selections) {\n\t\t\t\tconst { startLineNumber, endLineNumber } = selection;\n\t\t\t\tranges.push(\n\t\t\t\t\tendLineNumber >= startLineNumber\n\t\t\t\t\t\t? { startLineNumber, endLineNumber }\n\t\t\t\t\t\t: { endLineNumber, startLineNumber },\n\t\t\t\t);\n\t\t\t}\n\t\t\tfoldingModel.removeManualRanges(ranges);\n\t\t\tfoldingController.triggerFoldingModelChanged();\n\t\t}\n\t}\n}\n\nclass ToggleImportFoldAction extends FoldingAction<void> {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: \"editor.toggleImportFold\",\n\t\t\tlabel: nls.localize(\"toggleImportFold.label\", \"Toggle Import Fold\"),\n\t\t\talias: \"Toggle Import Fold\",\n\t\t\tprecondition: CONTEXT_FOLDING_ENABLED,\n\t\t\tkbOpts: {\n\t\t\t\tkbExpr: EditorContextKeys.editorTextFocus,\n\t\t\t\tweight: KeybindingWeight.EditorContrib,\n\t\t\t},\n\t\t});\n\t}\n\n\tasync invoke(\n\t\tfoldingController: FoldingController,\n\t\tfoldingModel: FoldingModel,\n\t): Promise<void> {\n\t\tconst regionsToToggle: FoldingRegion[] = [];\n\t\tconst regions = foldingModel.regions;\n\t\tfor (let i = regions.length - 1; i >= 0; i--) {\n\t\t\tif (regions.getType(i) === FoldingRangeKind.Imports.value) {\n\t\t\t\tregionsToToggle.push(regions.toRegion(i));\n\t\t\t}\n\t\t}\n\t\tfoldingModel.toggleCollapseState(regionsToToggle);\n\t\tfoldingController.triggerFoldingModelChanged();\n\t}\n}\n\nregisterEditorContribution(\n\tFoldingController.ID,\n\tFoldingController,\n\tEditorContributionInstantiation.Eager,\n); // eager because it uses `saveViewState`/`restoreViewState`\nregisterEditorAction(UnfoldAction);\nregisterEditorAction(UnFoldRecursivelyAction);\nregisterEditorAction(FoldAction);\nregisterEditorAction(FoldRecursivelyAction);\nregisterEditorAction(ToggleFoldRecursivelyAction);\nregisterEditorAction(FoldAllAction);\nregisterEditorAction(UnfoldAllAction);\nregisterEditorAction(FoldAllBlockCommentsAction);\nregisterEditorAction(FoldAllRegionsAction);\nregisterEditorAction(UnfoldAllRegionsAction);\nregisterEditorAction(FoldAllExceptAction);\nregisterEditorAction(UnfoldAllExceptAction);\nregisterEditorAction(ToggleFoldAction);\nregisterEditorAction(GotoParentFoldAction);\nregisterEditorAction(GotoPreviousFoldAction);\nregisterEditorAction(GotoNextFoldAction);\nregisterEditorAction(FoldRangeFromSelectionAction);\nregisterEditorAction(RemoveFoldRangeFromSelectionAction);\nregisterEditorAction(ToggleImportFoldAction);\n\nfor (let i = 1; i <= 7; i++) {\n\tregisterInstantiatedEditorAction(\n\t\tnew FoldLevelAction({\n\t\t\tid: FoldLevelAction.ID(i),\n\t\t\tlabel: nls.localize(\"foldLevelAction.label\", \"Fold Level {0}\", i),\n\t\t\talias: `Fold Level ${i}`,\n\t\t\tprecondition: CONTEXT_FOLDING_ENABLED,\n\t\t\tkbOpts: {\n\t\t\t\tkbExpr: EditorContextKeys.editorTextFocus,\n\t\t\t\tprimary: KeyChord(\n\t\t\t\t\tKeyMod.CtrlCmd | KeyCode.KeyK,\n\t\t\t\t\tKeyMod.CtrlCmd | (KeyCode.Digit0 + i),\n\t\t\t\t),\n\t\t\t\tweight: KeybindingWeight.EditorContrib,\n\t\t\t},\n\t\t}),\n\t);\n}\n\nCommandsRegistry.registerCommand(\n\t\"_executeFoldingRangeProvider\",\n\tasync (accessor, ...args) => {\n\t\tconst [resource] = args;\n\t\tif (!(resource instanceof URI)) {\n\t\t\tthrow illegalArgument();\n\t\t}\n\n\t\tconst languageFeaturesService = accessor.get(ILanguageFeaturesService);\n\n\t\tconst model = accessor.get(IModelService).getModel(resource);\n\t\tif (!model) {\n\t\t\tthrow illegalArgument();\n\t\t}\n\n\t\tconst configurationService = accessor.get(IConfigurationService);\n\t\tif (!configurationService.getValue(\"editor.folding\", { resource })) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst languageConfigurationService = accessor.get(\n\t\t\tILanguageConfigurationService,\n\t\t);\n\n\t\tconst strategy = configurationService.getValue(\n\t\t\t\"editor.foldingStrategy\",\n\t\t\t{ resource },\n\t\t);\n\t\tconst foldingLimitReporter = {\n\t\t\tget limit() {\n\t\t\t\treturn <number>(\n\t\t\t\t\tconfigurationService.getValue(\n\t\t\t\t\t\t\"editor.foldingMaximumRegions\",\n\t\t\t\t\t\t{ resource },\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t},\n\t\t\tupdate: (computed: number, limited: number | false) => {},\n\t\t};\n\n\t\tconst indentRangeProvider = new IndentRangeProvider(\n\t\t\tmodel,\n\t\t\tlanguageConfigurationService,\n\t\t\tfoldingLimitReporter,\n\t\t);\n\t\tlet rangeProvider: RangeProvider = indentRangeProvider;\n\t\tif (strategy !== \"indentation\") {\n\t\t\tconst providers = FoldingController.getFoldingRangeProviders(\n\t\t\t\tlanguageFeaturesService,\n\t\t\t\tmodel,\n\t\t\t);\n\t\t\tif (providers.length) {\n\t\t\t\trangeProvider = new SyntaxRangeProvider(\n\t\t\t\t\tmodel,\n\t\t\t\t\tproviders,\n\t\t\t\t\t() => {},\n\t\t\t\t\tfoldingLimitReporter,\n\t\t\t\t\tindentRangeProvider,\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\tconst ranges = await rangeProvider.compute(CancellationToken.None);\n\t\tconst result: FoldingRange[] = [];\n\t\ttry {\n\t\t\tif (ranges) {\n\t\t\t\tfor (let i = 0; i < ranges.length; i++) {\n\t\t\t\t\tconst type = ranges.getType(i);\n\t\t\t\t\tresult.push({\n\t\t\t\t\t\tstart: ranges.getStartLineNumber(i),\n\t\t\t\t\t\tend: ranges.getEndLineNumber(i),\n\t\t\t\t\t\tkind: type\n\t\t\t\t\t\t\t? FoldingRangeKind.fromValue(type)\n\t\t\t\t\t\t\t: undefined,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn result;\n\t\t} finally {\n\t\t\trangeProvider.dispose();\n\t\t}\n\t},\n);\n"],
  "mappings": "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",
  "names": ["options", "foldingModel"]
}
