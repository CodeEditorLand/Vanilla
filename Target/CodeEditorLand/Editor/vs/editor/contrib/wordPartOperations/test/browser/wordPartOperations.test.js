import i from"assert";import{ensureNoDisposablesAreLeakedInTestSuite as f}from"../../../../../base/test/common/utils.js";import"../../../../browser/editorBrowser.js";import"../../../../browser/editorExtensions.js";import{Position as n}from"../../../../common/core/position.js";import{ILanguageConfigurationService as I}from"../../../../common/languages/languageConfigurationRegistry.js";import{deserializePipePositions as r,serializePipePositions as c,testRepeatedActionAndExtractPositions as u}from"../../../wordOperations/test/browser/wordTestUtils.js";import{CursorWordPartLeft as W,CursorWordPartLeftSelect as q,CursorWordPartRight as v,CursorWordPartRightSelect as x,DeleteWordPartLeft as A,DeleteWordPartRight as T}from"../../browser/wordPartOperations.js";import{StaticServiceAccessor as D}from"./utils.js";import{TestLanguageConfigurationService as L}from"../../../../test/common/modes/testLanguageConfigurationService.js";suite("WordPartOperations",()=>{f();const p=new A,g=new T,h=new W,w=new q,_=new v,C=new x,m=new D().withService(I,new L);function P(e,o){o.runEditorCommand(m,e,null)}function l(e,o=!1){P(e,o?w:h)}function d(e,o=!1){P(e,o?C:_)}function S(e){P(e,p)}function E(e){P(e,g)}test("cursorWordPartLeft - basic",()=>{const e=["|start| |line|","|this|Is|A|Camel|Case|Var|  |this_|is_|a_|snake_|case_|var| |THIS_|IS_|CAPS_|SNAKE| |this_|IS|Mixed|Use|","|end| |line"].join(`
`),[o]=r(e),s=u(o,new n(1e3,1e3),t=>l(t),t=>t.getPosition(),t=>t.getPosition().equals(new n(1,1))),a=c(o,s);i.deepStrictEqual(a,e)}),test("cursorWordPartLeft - issue #53899: whitespace",()=>{const e="|myvar| |=| |'|demonstration|     |of| |selection| |with| |space|'",[o]=r(e),s=u(o,new n(1e3,1e3),t=>l(t),t=>t.getPosition(),t=>t.getPosition().equals(new n(1,1))),a=c(o,s);i.deepStrictEqual(a,e)}),test("cursorWordPartLeft - issue #53899: underscores",()=>{const e="|myvar| |=| |'|demonstration_____|of| |selection| |with| |space|'",[o]=r(e),s=u(o,new n(1e3,1e3),t=>l(t),t=>t.getPosition(),t=>t.getPosition().equals(new n(1,1))),a=c(o,s);i.deepStrictEqual(a,e)}),test("cursorWordPartRight - basic",()=>{const e=["start| |line|","|this|Is|A|Camel|Case|Var|  |this|_is|_a|_snake|_case|_var| |THIS|_IS|_CAPS|_SNAKE| |this|_IS|Mixed|Use|","|end| |line|"].join(`
`),[o]=r(e),s=u(o,new n(1,1),t=>d(t),t=>t.getPosition(),t=>t.getPosition().equals(new n(3,9))),a=c(o,s);i.deepStrictEqual(a,e)}),test("cursorWordPartRight - issue #53899: whitespace",()=>{const e="myvar| |=| |'|demonstration|     |of| |selection| |with| |space|'|",[o]=r(e),s=u(o,new n(1,1),t=>d(t),t=>t.getPosition(),t=>t.getPosition().equals(new n(1,52))),a=c(o,s);i.deepStrictEqual(a,e)}),test("cursorWordPartRight - issue #53899: underscores",()=>{const e="myvar| |=| |'|demonstration|_____of| |selection| |with| |space|'|",[o]=r(e),s=u(o,new n(1,1),t=>d(t),t=>t.getPosition(),t=>t.getPosition().equals(new n(1,52))),a=c(o,s);i.deepStrictEqual(a,e)}),test("cursorWordPartRight - issue #53899: second case",()=>{const e=[";| |--| |1|","|;|        |--| |2|","|;|    |#|3|","|;|   |#|4|"].join(`
`),[o]=r(e),s=u(o,new n(1,1),t=>d(t),t=>t.getPosition(),t=>t.getPosition().equals(new n(4,7))),a=c(o,s);i.deepStrictEqual(a,e)}),test("issue #93239 - cursorWordPartRight",()=>{const e=["foo|_bar|"].join(`
`),[o]=r(e),s=u(o,new n(1,1),t=>d(t),t=>t.getPosition(),t=>t.getPosition().equals(new n(1,8))),a=c(o,s);i.deepStrictEqual(a,e)}),test("issue #93239 - cursorWordPartLeft",()=>{const e=["|foo_|bar"].join(`
`),[o]=r(e),s=u(o,new n(1,8),t=>l(t),t=>t.getPosition(),t=>t.getPosition().equals(new n(1,1))),a=c(o,s);i.deepStrictEqual(a,e)}),test("deleteWordPartLeft - basic",()=>{const e="|   |/*| |Just| |some| |text| |a|+=| |3| |+|5|-|3| |*/|  |this|Is|A|Camel|Case|Var|  |this_|is_|a_|snake_|case_|var| |THIS_|IS_|CAPS_|SNAKE| |this_|IS|Mixed|Use",[o]=r(e),s=u(o,new n(1,1e3),t=>S(t),t=>t.getPosition(),t=>t.getValue().length===0),a=c(o,s);i.deepStrictEqual(a,e)}),test("deleteWordPartRight - basic",()=>{const e="   |/*| |Just| |some| |text| |a|+=| |3| |+|5|-|3| |*/|  |this|Is|A|Camel|Case|Var|  |this|_is|_a|_snake|_case|_var| |THIS|_IS|_CAPS|_SNAKE| |this|_IS|Mixed|Use|",[o]=r(e),s=u(o,new n(1,1),t=>E(t),t=>new n(1,o.length-t.getValue().length+1),t=>t.getValue().length===0),a=c(o,s);i.deepStrictEqual(a,e)}),test('issue #158667: cursorWordPartLeft stops at "-" even when "-" is not in word separators',()=>{const e=["|this-|is-|a-|kebab-|case-|var| |THIS-|IS-|CAPS-|KEBAB| |this-|IS|Mixed|Use"].join(`
`),[o]=r(e),s=u(o,new n(1e3,1e3),t=>l(t),t=>t.getPosition(),t=>t.getPosition().equals(new n(1,1)),{wordSeparators:"!\"#&'()*+,./:;<=>?@[\\]^`{|}\xB7"}),a=c(o,s);i.deepStrictEqual(a,e)}),test('issue #158667: cursorWordPartRight stops at "-" even when "-" is not in word separators',()=>{const e=["this|-is|-a|-kebab|-case|-var| |THIS|-IS|-CAPS|-KEBAB| |this|-IS|Mixed|Use|"].join(`
`),[o]=r(e),s=u(o,new n(1,1),t=>d(t),t=>t.getPosition(),t=>t.getPosition().equals(new n(1,60)),{wordSeparators:"!\"#&'()*+,./:;<=>?@[\\]^`{|}\xB7"}),a=c(o,s);i.deepStrictEqual(a,e)}),test('issue #158667: deleteWordPartLeft stops at "-" even when "-" is not in word separators',()=>{const e=["|this-|is-|a-|kebab-|case-|var| |THIS-|IS-|CAPS-|KEBAB| |this-|IS|Mixed|Use"].join(" "),[o]=r(e),s=u(o,new n(1e3,1e3),t=>S(t),t=>t.getPosition(),t=>t.getValue().length===0,{wordSeparators:"!\"#&'()*+,./:;<=>?@[\\]^`{|}\xB7"}),a=c(o,s);i.deepStrictEqual(a,e)}),test('issue #158667: deleteWordPartRight stops at "-" even when "-" is not in word separators',()=>{const e=["this|-is|-a|-kebab|-case|-var| |THIS|-IS|-CAPS|-KEBAB| |this|-IS|Mixed|Use|"].join(" "),[o]=r(e),s=u(o,new n(1,1),t=>E(t),t=>new n(1,o.length-t.getValue().length+1),t=>t.getValue().length===0,{wordSeparators:"!\"#&'()*+,./:;<=>?@[\\]^`{|}\xB7"}),a=c(o,s);i.deepStrictEqual(a,e)})});
