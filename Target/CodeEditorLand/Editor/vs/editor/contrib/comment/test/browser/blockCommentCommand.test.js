import"../../../../../base/common/lifecycle.js";import{ensureNoDisposablesAreLeakedInTestSuite as g}from"../../../../../base/test/common/utils.js";import{Selection as e}from"../../../../common/core/selection.js";import"../../../../common/editorCommon.js";import{ILanguageService as q}from"../../../../common/languages/language.js";import{ILanguageConfigurationService as d}from"../../../../common/languages/languageConfigurationRegistry.js";import{BlockCommentCommand as h}from"../../browser/blockCommentCommand.js";import{testCommand as S}from"../../../../test/browser/testCommand.js";import"../../../../../platform/instantiation/common/instantiation.js";function c(i,o,s,f,r){const n="commentMode";S(i,n,o,s,f,r,void 0,(w,m)=>{const a=w.get(d),u=w.get(q);m.add(u.registerLanguage({id:n})),m.add(a.register(n,{comments:{lineComment:"!@#",blockComment:["<0","0>"]}}))})}function t(i,o,s,f){c(i,o,(r,n)=>new h(n,!0,r.get(d)),s,f)}suite("Editor Contrib - Block Comment Command",()=>{g(),test("empty selection wraps itself",function(){t(["first","	second line","third line","fourth line","fifth"],new e(1,3,1,3),["fi<0  0>rst","	second line","third line","fourth line","fifth"],new e(1,6,1,6))}),test("invisible selection ignored",function(){t(["first","	second line","third line","fourth line","fifth"],new e(2,1,1,1),["<0 first"," 0>	second line","third line","fourth line","fifth"],new e(1,4,2,1))}),test("bug9511",()=>{t(["first","	second line","third line","fourth line","fifth"],new e(1,6,1,1),["<0 first 0>","	second line","third line","fourth line","fifth"],new e(1,4,1,9)),t(["<0first0>","	second line","third line","fourth line","fifth"],new e(1,8,1,3),["first","	second line","third line","fourth line","fifth"],new e(1,1,1,6))}),test("one line selection",function(){t(["first","	second line","third line","fourth line","fifth"],new e(1,6,1,3),["fi<0 rst 0>","	second line","third line","fourth line","fifth"],new e(1,6,1,9))}),test("one line selection toggle",function(){t(["first","	second line","third line","fourth line","fifth"],new e(1,6,1,3),["fi<0 rst 0>","	second line","third line","fourth line","fifth"],new e(1,6,1,9)),t(["fi<0rst0>","	second line","third line","fourth line","fifth"],new e(1,8,1,5),["first","	second line","third line","fourth line","fifth"],new e(1,3,1,6)),t(["<0 first 0>","	second line","third line","fourth line","fifth"],new e(1,10,1,1),["first","	second line","third line","fourth line","fifth"],new e(1,1,1,6)),t(["<0 first0>","	second line","third line","fourth line","fifth"],new e(1,9,1,1),["first","	second line","third line","fourth line","fifth"],new e(1,1,1,6)),t(["<0first 0>","	second line","third line","fourth line","fifth"],new e(1,9,1,1),["first","	second line","third line","fourth line","fifth"],new e(1,1,1,6)),t(["fi<0rst0>","	second line","third line","fourth line","fifth"],new e(1,8,1,5),["first","	second line","third line","fourth line","fifth"],new e(1,3,1,6))}),test("multi line selection",function(){t(["first","	second line","third line","fourth line","fifth"],new e(2,4,1,1),["<0 first","	se 0>cond line","third line","fourth line","fifth"],new e(1,4,2,4))}),test("multi line selection toggle",function(){t(["first","	second line","third line","fourth line","fifth"],new e(2,4,1,1),["<0 first","	se 0>cond line","third line","fourth line","fifth"],new e(1,4,2,4)),t(["<0first","	se0>cond line","third line","fourth line","fifth"],new e(2,4,1,3),["first","	second line","third line","fourth line","fifth"],new e(1,1,2,4)),t(["<0 first","	se0>cond line","third line","fourth line","fifth"],new e(2,4,1,3),["first","	second line","third line","fourth line","fifth"],new e(1,1,2,4)),t(["<0first","	se 0>cond line","third line","fourth line","fifth"],new e(2,4,1,3),["first","	second line","third line","fourth line","fifth"],new e(1,1,2,4)),t(["<0 first","	se 0>cond line","third line","fourth line","fifth"],new e(2,4,1,3),["first","	second line","third line","fourth line","fifth"],new e(1,1,2,4))}),test("fuzzy removes",function(){t(["asd <0 qwe","asd 0> qwe"],new e(2,5,1,7),["asd qwe","asd qwe"],new e(1,5,2,4)),t(["asd <0 qwe","asd 0> qwe"],new e(2,5,1,6),["asd qwe","asd qwe"],new e(1,5,2,4)),t(["asd <0 qwe","asd 0> qwe"],new e(2,5,1,5),["asd qwe","asd qwe"],new e(1,5,2,4)),t(["asd <0 qwe","asd 0> qwe"],new e(2,5,1,11),["asd qwe","asd qwe"],new e(1,5,2,4)),t(["asd <0 qwe","asd 0> qwe"],new e(2,1,1,11),["asd qwe","asd qwe"],new e(1,5,2,4)),t(["asd <0 qwe","asd 0> qwe"],new e(2,7,1,11),["asd qwe","asd qwe"],new e(1,5,2,4))}),test("bug #30358",function(){t(["<0 start 0> middle end"],new e(1,20,1,23),["<0 start 0> middle <0 end 0>"],new e(1,23,1,26)),t(["<0 start 0> middle <0 end 0>"],new e(1,13,1,19),["<0 start 0> <0 middle 0> <0 end 0>"],new e(1,16,1,22))}),test("issue #34618",function(){t(["<0  0> middle end"],new e(1,4,1,4),[" middle end"],new e(1,1,1,1))}),test("insertSpace false",()=>{function i(o,s,f,r){c(o,s,(n,l)=>new h(l,!1,n.get(d)),f,r)}i(["some text"],new e(1,1,1,5),["<0some0> text"],new e(1,3,1,7))}),test("insertSpace false does not remove space",()=>{function i(o,s,f,r){c(o,s,(n,l)=>new h(l,!1,n.get(d)),f,r)}i(["<0 some 0> text"],new e(1,4,1,8),[" some  text"],new e(1,1,1,7))})});
