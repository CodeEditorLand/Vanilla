import h from"assert";import{ensureNoDisposablesAreLeakedInTestSuite as d}from"../../../../../base/test/common/utils.js";import{Selection as i}from"../../../../common/core/selection.js";import{CopyLinesCommand as u}from"../../browser/copyLinesCommand.js";import{DuplicateSelectionAction as m}from"../../browser/linesOperations.js";import{withTestCodeEditor as a}from"../../../../test/browser/testCodeEditor.js";import{testCommand as p}from"../../../../test/browser/testCommand.js";function w(t,e,o,f){p(t,null,e,(s,l)=>new u(l,!0),o,f)}function n(t,e,o,f){p(t,null,e,(s,l)=>new u(l,!1),o,f)}suite("Editor Contrib - Copy Lines Command",()=>{d(),test("copy first line down",function(){w(["first","second line","third line","fourth line","fifth"],new i(1,3,1,1),["first","first","second line","third line","fourth line","fifth"],new i(2,3,2,1))}),test("copy first line up",function(){n(["first","second line","third line","fourth line","fifth"],new i(1,3,1,1),["first","first","second line","third line","fourth line","fifth"],new i(1,3,1,1))}),test("copy last line down",function(){w(["first","second line","third line","fourth line","fifth"],new i(5,3,5,1),["first","second line","third line","fourth line","fifth","fifth"],new i(6,3,6,1))}),test("copy last line up",function(){n(["first","second line","third line","fourth line","fifth"],new i(5,3,5,1),["first","second line","third line","fourth line","fifth","fifth"],new i(5,3,5,1))}),test("issue #1322: copy line up",function(){n(["first","second line","third line","fourth line","fifth"],new i(3,11,3,11),["first","second line","third line","third line","fourth line","fifth"],new i(3,11,3,11))}),test("issue #1322: copy last line up",function(){n(["first","second line","third line","fourth line","fifth"],new i(5,6,5,6),["first","second line","third line","fourth line","fifth","fifth"],new i(5,6,5,6))}),test("copy many lines up",function(){n(["first","second line","third line","fourth line","fifth"],new i(4,3,2,1),["first","second line","third line","fourth line","second line","third line","fourth line","fifth"],new i(4,3,2,1))}),test("ignore empty selection",function(){n(["first","second line","third line","fourth line","fifth"],new i(2,1,1,1),["first","first","second line","third line","fourth line","fifth"],new i(2,1,1,1))})}),suite("Editor Contrib - Duplicate Selection",()=>{d();const t=new m;function e(o,f,s,l){a(o.join(`
`),{},r=>{r.setSelections(f),t.run(null,r,{}),h.deepStrictEqual(r.getValue(),s.join(`
`)),h.deepStrictEqual(r.getSelections().map(c=>c.toString()),l.map(c=>c.toString()))})}test("empty selection",function(){e(["first","second line","third line","fourth line","fifth"],[new i(2,2,2,2),new i(3,2,3,2)],["first","second line","second line","third line","third line","fourth line","fifth"],[new i(3,2,3,2),new i(5,2,5,2)])}),test("with selection",function(){e(["first","second line","third line","fourth line","fifth"],[new i(2,1,2,4),new i(3,1,3,4)],["first","secsecond line","thithird line","fourth line","fifth"],[new i(2,4,2,7),new i(3,4,3,7)])})});
