var L=Object.defineProperty;var R=Object.getOwnPropertyDescriptor;var l=(n,e,r,t)=>{for(var i=t>1?void 0:t?R(e,r):e,s=n.length-1,f;s>=0;s--)(f=n[s])&&(i=(t?f(e,r,i):f(i))||i);return t&&i&&L(e,r,i),i},o=(n,e)=>(r,t)=>e(r,t,n);import*as g from"../../../../../base/browser/dom.js";import{CountBadge as S}from"../../../../../base/browser/ui/countBadge/countBadge.js";import{HighlightedLabel as E}from"../../../../../base/browser/ui/highlightedlabel/highlightedLabel.js";import{IconLabel as F}from"../../../../../base/browser/ui/iconLabel/iconLabel.js";import{FuzzyScore as M,createMatches as v}from"../../../../../base/common/filters.js";import{Disposable as h}from"../../../../../base/common/lifecycle.js";import{basename as y,dirname as w}from"../../../../../base/common/resources.js";import{localize as p}from"../../../../../nls.js";import{IInstantiationService as x}from"../../../../../platform/instantiation/common/instantiation.js";import{IKeybindingService as O}from"../../../../../platform/keybinding/common/keybinding.js";import{ILabelService as z}from"../../../../../platform/label/common/label.js";import{defaultCountBadgeStyles as C}from"../../../../../platform/theme/browser/defaultStyles.js";import{ITextModelService as P}from"../../../../common/services/resolverService.js";import{FileReferences as u,OneReference as I,ReferencesModel as T}from"../referencesModel.js";let d=class{constructor(e){this._resolverService=e}hasChildren(e){return e instanceof T||e instanceof u}getChildren(e){if(e instanceof T)return e.groups;if(e instanceof u)return e.resolve(this._resolverService).then(r=>r.children);throw new Error("bad tree")}};d=l([o(0,P)],d);class J{getHeight(){return 23}getTemplateId(e){return e instanceof u?a.id:b.id}}let m=class{constructor(e){this._keybindingService=e}getKeyboardNavigationLabel(e){if(e instanceof I){const r=e.parent.getPreview(e)?.preview(e.range);if(r)return r.value}return y(e.uri)}mightProducePrintableCharacter(e){return this._keybindingService.mightProducePrintableCharacter(e)}};m=l([o(0,O)],m);class Q{getId(e){return e instanceof I?e.id:e.uri}}let c=class extends h{constructor(r,t){super();this._labelService=t;const i=document.createElement("div");i.classList.add("reference-file"),this.file=this._register(new F(i,{supportHighlights:!0})),this.badge=new S(g.append(i,g.$(".count")),{},C),r.appendChild(i)}file;badge;set(r,t){const i=w(r.uri);this.file.setLabel(this._labelService.getUriBasenameLabel(r.uri),this._labelService.getUriLabel(i,{relative:!0}),{title:this._labelService.getUriLabel(r.uri),matches:t});const s=r.children.length;this.badge.setCount(s),s>1?this.badge.setTitleFormat(p("referencesCount","{0} references",s)):this.badge.setTitleFormat(p("referenceCount","{0} reference",s))}};c=l([o(1,z)],c);let a=class{constructor(e){this._instantiationService=e}static id="FileReferencesRenderer";templateId=a.id;renderTemplate(e){return this._instantiationService.createInstance(c,e)}renderElement(e,r,t){t.set(e.element,v(e.filterData))}disposeTemplate(e){e.dispose()}};a=l([o(0,x)],a);class _ extends h{label;constructor(e){super(),this.label=this._register(new E(e))}set(e,r){const t=e.parent.getPreview(e)?.preview(e.range);if(!t||!t.value)this.label.set(`${y(e.uri)}:${e.range.startLineNumber+1}:${e.range.startColumn+1}`);else{const{value:i,highlight:s}=t;r&&!M.isDefault(r)?(this.label.element.classList.toggle("referenceMatch",!1),this.label.set(i,v(r))):(this.label.element.classList.toggle("referenceMatch",!0),this.label.set(i,[s]))}}}class b{static id="OneReferenceRenderer";templateId=b.id;renderTemplate(e){return new _(e)}renderElement(e,r,t){t.set(e.element,e.filterData)}disposeTemplate(e){e.dispose()}}class X{getWidgetAriaLabel(){return p("treeAriaLabel","References")}getAriaLabel(e){return e.ariaMessage}}export{X as AccessibilityProvider,d as DataSource,J as Delegate,a as FileReferencesRenderer,Q as IdentityProvider,b as OneReferenceRenderer,m as StringRepresentationProvider};
