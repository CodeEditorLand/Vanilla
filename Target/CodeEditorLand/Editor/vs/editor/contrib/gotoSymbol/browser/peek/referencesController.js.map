{
  "version": 3,
  "sources": ["../../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/editor/contrib/gotoSymbol/browser/peek/referencesController.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport {\n\ttype CancelablePromise,\n\tcreateCancelablePromise,\n} from \"../../../../../base/common/async.js\";\nimport { onUnexpectedError } from \"../../../../../base/common/errors.js\";\nimport {\n\tKeyChord,\n\tKeyCode,\n\tKeyMod,\n} from \"../../../../../base/common/keyCodes.js\";\nimport { DisposableStore } from \"../../../../../base/common/lifecycle.js\";\nimport * as nls from \"../../../../../nls.js\";\nimport { CommandsRegistry } from \"../../../../../platform/commands/common/commands.js\";\nimport { IConfigurationService } from \"../../../../../platform/configuration/common/configuration.js\";\nimport {\n\tContextKeyExpr,\n\ttype IContextKey,\n\tIContextKeyService,\n\tRawContextKey,\n} from \"../../../../../platform/contextkey/common/contextkey.js\";\nimport { InputFocusedContext } from \"../../../../../platform/contextkey/common/contextkeys.js\";\nimport { TextEditorSelectionSource } from \"../../../../../platform/editor/common/editor.js\";\nimport {\n\tIInstantiationService,\n\ttype ServicesAccessor,\n} from \"../../../../../platform/instantiation/common/instantiation.js\";\nimport {\n\tKeybindingWeight,\n\tKeybindingsRegistry,\n} from \"../../../../../platform/keybinding/common/keybindingsRegistry.js\";\nimport {\n\tIListService,\n\tWorkbenchListFocusContextKey,\n\tWorkbenchTreeElementCanCollapse,\n\tWorkbenchTreeElementCanExpand,\n} from \"../../../../../platform/list/browser/listService.js\";\nimport { INotificationService } from \"../../../../../platform/notification/common/notification.js\";\nimport {\n\tIStorageService,\n\tStorageScope,\n\tStorageTarget,\n} from \"../../../../../platform/storage/common/storage.js\";\nimport type { ICodeEditor } from \"../../../../browser/editorBrowser.js\";\nimport { ICodeEditorService } from \"../../../../browser/services/codeEditorService.js\";\nimport { EditorOption } from \"../../../../common/config/editorOptions.js\";\nimport { Position } from \"../../../../common/core/position.js\";\nimport { Range } from \"../../../../common/core/range.js\";\nimport type { IEditorContribution } from \"../../../../common/editorCommon.js\";\nimport { EditorContextKeys } from \"../../../../common/editorContextKeys.js\";\nimport type { Location } from \"../../../../common/languages.js\";\nimport {\n\tPeekContext,\n\tgetOuterEditor,\n} from \"../../../peekView/browser/peekView.js\";\nimport { OneReference, type ReferencesModel } from \"../referencesModel.js\";\nimport { LayoutData, ReferenceWidget } from \"./referencesWidget.js\";\n\nexport const ctxReferenceSearchVisible = new RawContextKey<boolean>(\n\t\"referenceSearchVisible\",\n\tfalse,\n\tnls.localize(\n\t\t\"referenceSearchVisible\",\n\t\t\"Whether reference peek is visible, like 'Peek References' or 'Peek Definition'\",\n\t),\n);\n\nexport abstract class ReferencesController implements IEditorContribution {\n\tstatic readonly ID = \"editor.contrib.referencesController\";\n\n\tprivate readonly _disposables = new DisposableStore();\n\n\tprivate _widget?: ReferenceWidget;\n\tprivate _model?: ReferencesModel;\n\tprivate _peekMode?: boolean;\n\tprivate _requestIdPool = 0;\n\tprivate _ignoreModelChangeEvent = false;\n\n\tprivate readonly _referenceSearchVisible: IContextKey<boolean>;\n\n\tstatic get(editor: ICodeEditor): ReferencesController | null {\n\t\treturn editor.getContribution<ReferencesController>(\n\t\t\tReferencesController.ID,\n\t\t);\n\t}\n\n\tconstructor(\n\t\tprivate readonly _defaultTreeKeyboardSupport: boolean,\n\t\tprivate readonly _editor: ICodeEditor,\n\t\t@IContextKeyService contextKeyService: IContextKeyService,\n\t\t@ICodeEditorService private readonly _editorService: ICodeEditorService,\n\t\t@INotificationService\n\t\tprivate readonly _notificationService: INotificationService,\n\t\t@IInstantiationService\n\t\tprivate readonly _instantiationService: IInstantiationService,\n\t\t@IStorageService private readonly _storageService: IStorageService,\n\t\t@IConfigurationService\n\t\tprivate readonly _configurationService: IConfigurationService,\n\t) {\n\t\tthis._referenceSearchVisible =\n\t\t\tctxReferenceSearchVisible.bindTo(contextKeyService);\n\t}\n\n\tdispose(): void {\n\t\tthis._referenceSearchVisible.reset();\n\t\tthis._disposables.dispose();\n\t\tthis._widget?.dispose();\n\t\tthis._model?.dispose();\n\t\tthis._widget = undefined;\n\t\tthis._model = undefined;\n\t}\n\n\ttoggleWidget(\n\t\trange: Range,\n\t\tmodelPromise: CancelablePromise<ReferencesModel>,\n\t\tpeekMode: boolean,\n\t): void {\n\t\t// close current widget and return early is position didn't change\n\t\tlet widgetPosition: Position | undefined;\n\t\tif (this._widget) {\n\t\t\twidgetPosition = this._widget.position;\n\t\t}\n\t\tthis.closeWidget();\n\t\tif (!!widgetPosition && range.containsPosition(widgetPosition)) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._peekMode = peekMode;\n\t\tthis._referenceSearchVisible.set(true);\n\n\t\t// close the widget on model/mode changes\n\t\tthis._disposables.add(\n\t\t\tthis._editor.onDidChangeModelLanguage(() => {\n\t\t\t\tthis.closeWidget();\n\t\t\t}),\n\t\t);\n\t\tthis._disposables.add(\n\t\t\tthis._editor.onDidChangeModel(() => {\n\t\t\t\tif (!this._ignoreModelChangeEvent) {\n\t\t\t\t\tthis.closeWidget();\n\t\t\t\t}\n\t\t\t}),\n\t\t);\n\t\tconst storageKey = \"peekViewLayout\";\n\t\tconst data = LayoutData.fromJSON(\n\t\t\tthis._storageService.get(storageKey, StorageScope.PROFILE, \"{}\"),\n\t\t);\n\t\tthis._widget = this._instantiationService.createInstance(\n\t\t\tReferenceWidget,\n\t\t\tthis._editor,\n\t\t\tthis._defaultTreeKeyboardSupport,\n\t\t\tdata,\n\t\t);\n\t\tthis._widget.setTitle(nls.localize(\"labelLoading\", \"Loading...\"));\n\t\tthis._widget.show(range);\n\n\t\tthis._disposables.add(\n\t\t\tthis._widget.onDidClose(() => {\n\t\t\t\tmodelPromise.cancel();\n\t\t\t\tif (this._widget) {\n\t\t\t\t\tthis._storageService.store(\n\t\t\t\t\t\tstorageKey,\n\t\t\t\t\t\tJSON.stringify(this._widget.layoutData),\n\t\t\t\t\t\tStorageScope.PROFILE,\n\t\t\t\t\t\tStorageTarget.MACHINE,\n\t\t\t\t\t);\n\t\t\t\t\tif (!this._widget.isClosing) {\n\t\t\t\t\t\t// to prevent calling this too many times, check whether it was already closing.\n\t\t\t\t\t\tthis.closeWidget();\n\t\t\t\t\t}\n\t\t\t\t\tthis._widget = undefined;\n\t\t\t\t} else {\n\t\t\t\t\tthis.closeWidget();\n\t\t\t\t}\n\t\t\t}),\n\t\t);\n\n\t\tthis._disposables.add(\n\t\t\tthis._widget.onDidSelectReference((event) => {\n\t\t\t\tconst { element, kind } = event;\n\t\t\t\tif (!element) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tswitch (kind) {\n\t\t\t\t\tcase \"open\":\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tevent.source !== \"editor\" ||\n\t\t\t\t\t\t\t!this._configurationService.getValue(\n\t\t\t\t\t\t\t\t\"editor.stablePeek\",\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t// when stable peek is configured we don't close\n\t\t\t\t\t\t\t// the peek window on selecting the editor\n\t\t\t\t\t\t\tthis.openReference(element, false, false);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"side\":\n\t\t\t\t\t\tthis.openReference(element, true, false);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"goto\":\n\t\t\t\t\t\tif (peekMode) {\n\t\t\t\t\t\t\tthis._gotoReference(element, true);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.openReference(element, false, true);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}),\n\t\t);\n\n\t\tconst requestId = ++this._requestIdPool;\n\n\t\tmodelPromise.then(\n\t\t\t(model) => {\n\t\t\t\t// still current request? widget still open?\n\t\t\t\tif (requestId !== this._requestIdPool || !this._widget) {\n\t\t\t\t\tmodel.dispose();\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\n\t\t\t\tthis._model?.dispose();\n\t\t\t\tthis._model = model;\n\n\t\t\t\t// show widget\n\t\t\t\treturn this._widget.setModel(this._model).then(() => {\n\t\t\t\t\tif (\n\t\t\t\t\t\tthis._widget &&\n\t\t\t\t\t\tthis._model &&\n\t\t\t\t\t\tthis._editor.hasModel()\n\t\t\t\t\t) {\n\t\t\t\t\t\t// might have been closed\n\n\t\t\t\t\t\t// set title\n\t\t\t\t\t\tif (this._model.isEmpty) {\n\t\t\t\t\t\t\tthis._widget.setMetaTitle(\"\");\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis._widget.setMetaTitle(\n\t\t\t\t\t\t\t\tnls.localize(\n\t\t\t\t\t\t\t\t\t\"metaTitle.N\",\n\t\t\t\t\t\t\t\t\t\"{0} ({1})\",\n\t\t\t\t\t\t\t\t\tthis._model.title,\n\t\t\t\t\t\t\t\t\tthis._model.references.length,\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// set 'best' selection\n\t\t\t\t\t\tconst uri = this._editor.getModel().uri;\n\t\t\t\t\t\tconst pos = new Position(\n\t\t\t\t\t\t\trange.startLineNumber,\n\t\t\t\t\t\t\trange.startColumn,\n\t\t\t\t\t\t);\n\t\t\t\t\t\tconst selection = this._model.nearestReference(\n\t\t\t\t\t\t\turi,\n\t\t\t\t\t\t\tpos,\n\t\t\t\t\t\t);\n\t\t\t\t\t\tif (selection) {\n\t\t\t\t\t\t\treturn this._widget\n\t\t\t\t\t\t\t\t.setSelection(selection)\n\t\t\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\t\tthis._widget &&\n\t\t\t\t\t\t\t\t\t\tthis._editor.getOption(\n\t\t\t\t\t\t\t\t\t\t\tEditorOption.peekWidgetDefaultFocus,\n\t\t\t\t\t\t\t\t\t\t) === \"editor\"\n\t\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\t\tthis._widget.focusOnPreviewEditor();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn undefined;\n\t\t\t\t});\n\t\t\t},\n\t\t\t(error) => {\n\t\t\t\tthis._notificationService.error(error);\n\t\t\t},\n\t\t);\n\t}\n\n\tchangeFocusBetweenPreviewAndReferences() {\n\t\tif (!this._widget) {\n\t\t\t// can be called while still resolving...\n\t\t\treturn;\n\t\t}\n\t\tif (this._widget.isPreviewEditorFocused()) {\n\t\t\tthis._widget.focusOnReferenceTree();\n\t\t} else {\n\t\t\tthis._widget.focusOnPreviewEditor();\n\t\t}\n\t}\n\n\tasync goToNextOrPreviousReference(fwd: boolean) {\n\t\tif (!this._editor.hasModel() || !this._model || !this._widget) {\n\t\t\t// can be called while still resolving...\n\t\t\treturn;\n\t\t}\n\t\tconst currentPosition = this._widget.position;\n\t\tif (!currentPosition) {\n\t\t\treturn;\n\t\t}\n\t\tconst source = this._model.nearestReference(\n\t\t\tthis._editor.getModel().uri,\n\t\t\tcurrentPosition,\n\t\t);\n\t\tif (!source) {\n\t\t\treturn;\n\t\t}\n\t\tconst target = this._model.nextOrPreviousReference(source, fwd);\n\t\tconst editorFocus = this._editor.hasTextFocus();\n\t\tconst previewEditorFocus = this._widget.isPreviewEditorFocused();\n\t\tawait this._widget.setSelection(target);\n\t\tawait this._gotoReference(target, false);\n\t\tif (editorFocus) {\n\t\t\tthis._editor.focus();\n\t\t} else if (this._widget && previewEditorFocus) {\n\t\t\tthis._widget.focusOnPreviewEditor();\n\t\t}\n\t}\n\n\tasync revealReference(reference: OneReference): Promise<void> {\n\t\tif (!this._editor.hasModel() || !this._model || !this._widget) {\n\t\t\t// can be called while still resolving...\n\t\t\treturn;\n\t\t}\n\n\t\tawait this._widget.revealReference(reference);\n\t}\n\n\tcloseWidget(focusEditor = true): void {\n\t\tthis._widget?.dispose();\n\t\tthis._model?.dispose();\n\t\tthis._referenceSearchVisible.reset();\n\t\tthis._disposables.clear();\n\t\tthis._widget = undefined;\n\t\tthis._model = undefined;\n\t\tif (focusEditor) {\n\t\t\tthis._editor.focus();\n\t\t}\n\t\tthis._requestIdPool += 1; // Cancel pending requests\n\t}\n\n\tprivate _gotoReference(ref: Location, pinned: boolean): Promise<any> {\n\t\tthis._widget?.hide();\n\n\t\tthis._ignoreModelChangeEvent = true;\n\t\tconst range = Range.lift(ref.range).collapseToStart();\n\n\t\treturn this._editorService\n\t\t\t.openCodeEditor(\n\t\t\t\t{\n\t\t\t\t\tresource: ref.uri,\n\t\t\t\t\toptions: {\n\t\t\t\t\t\tselection: range,\n\t\t\t\t\t\tselectionSource: TextEditorSelectionSource.JUMP,\n\t\t\t\t\t\tpinned,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tthis._editor,\n\t\t\t)\n\t\t\t.then(\n\t\t\t\t(openedEditor) => {\n\t\t\t\t\tthis._ignoreModelChangeEvent = false;\n\n\t\t\t\t\tif (!openedEditor || !this._widget) {\n\t\t\t\t\t\t// something went wrong...\n\t\t\t\t\t\tthis.closeWidget();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this._editor === openedEditor) {\n\t\t\t\t\t\t//\n\t\t\t\t\t\tthis._widget.show(range);\n\t\t\t\t\t\tthis._widget.focusOnReferenceTree();\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// we opened a different editor instance which means a different controller instance.\n\t\t\t\t\t\t// therefore we stop with this controller and continue with the other\n\t\t\t\t\t\tconst other = ReferencesController.get(openedEditor);\n\t\t\t\t\t\tconst model = this._model!.clone();\n\n\t\t\t\t\t\tthis.closeWidget();\n\t\t\t\t\t\topenedEditor.focus();\n\n\t\t\t\t\t\tother?.toggleWidget(\n\t\t\t\t\t\t\trange,\n\t\t\t\t\t\t\tcreateCancelablePromise((_) =>\n\t\t\t\t\t\t\t\tPromise.resolve(model),\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\tthis._peekMode ?? false,\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t(err) => {\n\t\t\t\t\tthis._ignoreModelChangeEvent = false;\n\t\t\t\t\tonUnexpectedError(err);\n\t\t\t\t},\n\t\t\t);\n\t}\n\n\topenReference(ref: Location, sideBySide: boolean, pinned: boolean): void {\n\t\t// clear stage\n\t\tif (!sideBySide) {\n\t\t\tthis.closeWidget();\n\t\t}\n\n\t\tconst { uri, range } = ref;\n\t\tthis._editorService.openCodeEditor(\n\t\t\t{\n\t\t\t\tresource: uri,\n\t\t\t\toptions: {\n\t\t\t\t\tselection: range,\n\t\t\t\t\tselectionSource: TextEditorSelectionSource.JUMP,\n\t\t\t\t\tpinned,\n\t\t\t\t},\n\t\t\t},\n\t\t\tthis._editor,\n\t\t\tsideBySide,\n\t\t);\n\t}\n}\n\nfunction withController(\n\taccessor: ServicesAccessor,\n\tfn: (controller: ReferencesController) => void,\n): void {\n\tconst outerEditor = getOuterEditor(accessor);\n\tif (!outerEditor) {\n\t\treturn;\n\t}\n\tconst controller = ReferencesController.get(outerEditor);\n\tif (controller) {\n\t\tfn(controller);\n\t}\n}\n\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n\tid: \"togglePeekWidgetFocus\",\n\tweight: KeybindingWeight.EditorContrib,\n\tprimary: KeyChord(KeyMod.CtrlCmd | KeyCode.KeyK, KeyCode.F2),\n\twhen: ContextKeyExpr.or(\n\t\tctxReferenceSearchVisible,\n\t\tPeekContext.inPeekEditor,\n\t),\n\thandler(accessor) {\n\t\twithController(accessor, (controller) => {\n\t\t\tcontroller.changeFocusBetweenPreviewAndReferences();\n\t\t});\n\t},\n});\n\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n\tid: \"goToNextReference\",\n\tweight: KeybindingWeight.EditorContrib - 10,\n\tprimary: KeyCode.F4,\n\tsecondary: [KeyCode.F12],\n\twhen: ContextKeyExpr.or(\n\t\tctxReferenceSearchVisible,\n\t\tPeekContext.inPeekEditor,\n\t),\n\thandler(accessor) {\n\t\twithController(accessor, (controller) => {\n\t\t\tcontroller.goToNextOrPreviousReference(true);\n\t\t});\n\t},\n});\n\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n\tid: \"goToPreviousReference\",\n\tweight: KeybindingWeight.EditorContrib - 10,\n\tprimary: KeyMod.Shift | KeyCode.F4,\n\tsecondary: [KeyMod.Shift | KeyCode.F12],\n\twhen: ContextKeyExpr.or(\n\t\tctxReferenceSearchVisible,\n\t\tPeekContext.inPeekEditor,\n\t),\n\thandler(accessor) {\n\t\twithController(accessor, (controller) => {\n\t\t\tcontroller.goToNextOrPreviousReference(false);\n\t\t});\n\t},\n});\n\n// commands that aren't needed anymore because there is now ContextKeyExpr.OR\nCommandsRegistry.registerCommandAlias(\n\t\"goToNextReferenceFromEmbeddedEditor\",\n\t\"goToNextReference\",\n);\nCommandsRegistry.registerCommandAlias(\n\t\"goToPreviousReferenceFromEmbeddedEditor\",\n\t\"goToPreviousReference\",\n);\n\n// close\nCommandsRegistry.registerCommandAlias(\n\t\"closeReferenceSearchEditor\",\n\t\"closeReferenceSearch\",\n);\nCommandsRegistry.registerCommand(\"closeReferenceSearch\", (accessor) =>\n\twithController(accessor, (controller) => controller.closeWidget()),\n);\nKeybindingsRegistry.registerKeybindingRule({\n\tid: \"closeReferenceSearch\",\n\tweight: KeybindingWeight.EditorContrib - 101,\n\tprimary: KeyCode.Escape,\n\tsecondary: [KeyMod.Shift | KeyCode.Escape],\n\twhen: ContextKeyExpr.and(\n\t\tPeekContext.inPeekEditor,\n\t\tContextKeyExpr.not(\"config.editor.stablePeek\"),\n\t),\n});\nKeybindingsRegistry.registerKeybindingRule({\n\tid: \"closeReferenceSearch\",\n\tweight: KeybindingWeight.WorkbenchContrib + 50,\n\tprimary: KeyCode.Escape,\n\tsecondary: [KeyMod.Shift | KeyCode.Escape],\n\twhen: ContextKeyExpr.and(\n\t\tctxReferenceSearchVisible,\n\t\tContextKeyExpr.not(\"config.editor.stablePeek\"),\n\t\tContextKeyExpr.or(\n\t\t\tEditorContextKeys.editorTextFocus,\n\t\t\tInputFocusedContext.negate(),\n\t\t),\n\t),\n});\n\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n\tid: \"revealReference\",\n\tweight: KeybindingWeight.WorkbenchContrib,\n\tprimary: KeyCode.Enter,\n\tmac: {\n\t\tprimary: KeyCode.Enter,\n\t\tsecondary: [KeyMod.CtrlCmd | KeyCode.DownArrow],\n\t},\n\twhen: ContextKeyExpr.and(\n\t\tctxReferenceSearchVisible,\n\t\tWorkbenchListFocusContextKey,\n\t\tWorkbenchTreeElementCanCollapse.negate(),\n\t\tWorkbenchTreeElementCanExpand.negate(),\n\t),\n\thandler(accessor: ServicesAccessor) {\n\t\tconst listService = accessor.get(IListService);\n\t\tconst focus = <any[]>listService.lastFocusedList?.getFocus();\n\t\tif (Array.isArray(focus) && focus[0] instanceof OneReference) {\n\t\t\twithController(accessor, (controller) =>\n\t\t\t\tcontroller.revealReference(focus[0]),\n\t\t\t);\n\t\t}\n\t},\n});\n\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n\tid: \"openReferenceToSide\",\n\tweight: KeybindingWeight.EditorContrib,\n\tprimary: KeyMod.CtrlCmd | KeyCode.Enter,\n\tmac: {\n\t\tprimary: KeyMod.WinCtrl | KeyCode.Enter,\n\t},\n\twhen: ContextKeyExpr.and(\n\t\tctxReferenceSearchVisible,\n\t\tWorkbenchListFocusContextKey,\n\t\tWorkbenchTreeElementCanCollapse.negate(),\n\t\tWorkbenchTreeElementCanExpand.negate(),\n\t),\n\thandler(accessor: ServicesAccessor) {\n\t\tconst listService = accessor.get(IListService);\n\t\tconst focus = <any[]>listService.lastFocusedList?.getFocus();\n\t\tif (Array.isArray(focus) && focus[0] instanceof OneReference) {\n\t\t\twithController(accessor, (controller) =>\n\t\t\t\tcontroller.openReference(focus[0], true, true),\n\t\t\t);\n\t\t}\n\t},\n});\n\nCommandsRegistry.registerCommand(\"openReference\", (accessor) => {\n\tconst listService = accessor.get(IListService);\n\tconst focus = <any[]>listService.lastFocusedList?.getFocus();\n\tif (Array.isArray(focus) && focus[0] instanceof OneReference) {\n\t\twithController(accessor, (controller) =>\n\t\t\tcontroller.openReference(focus[0], false, true),\n\t\t);\n\t}\n});\n"],
  "mappings": "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",
  "names": []
}
