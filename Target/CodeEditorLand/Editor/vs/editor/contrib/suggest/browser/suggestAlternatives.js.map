{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/editor/contrib/suggest/browser/suggestAlternatives.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport type { IDisposable } from \"../../../../base/common/lifecycle.js\";\nimport {\n\ttype IContextKey,\n\tIContextKeyService,\n\tRawContextKey,\n} from \"../../../../platform/contextkey/common/contextkey.js\";\nimport type { ICodeEditor } from \"../../../browser/editorBrowser.js\";\nimport type { CompletionModel } from \"./completionModel.js\";\nimport type { ISelectedSuggestion } from \"./suggestWidget.js\";\n\nexport class SuggestAlternatives {\n\tstatic readonly OtherSuggestions = new RawContextKey<boolean>(\n\t\t\"hasOtherSuggestions\",\n\t\tfalse,\n\t);\n\n\tprivate readonly _ckOtherSuggestions: IContextKey<boolean>;\n\n\tprivate _index = 0;\n\tprivate _model: CompletionModel | undefined;\n\tprivate _acceptNext: ((selected: ISelectedSuggestion) => any) | undefined;\n\tprivate _listener: IDisposable | undefined;\n\tprivate _ignore: boolean | undefined;\n\n\tconstructor(\n\t\tprivate readonly _editor: ICodeEditor,\n\t\t@IContextKeyService contextKeyService: IContextKeyService,\n\t) {\n\t\tthis._ckOtherSuggestions =\n\t\t\tSuggestAlternatives.OtherSuggestions.bindTo(contextKeyService);\n\t}\n\n\tdispose(): void {\n\t\tthis.reset();\n\t}\n\n\treset(): void {\n\t\tthis._ckOtherSuggestions.reset();\n\t\tthis._listener?.dispose();\n\t\tthis._model = undefined;\n\t\tthis._acceptNext = undefined;\n\t\tthis._ignore = false;\n\t}\n\n\tset(\n\t\t{ model, index }: ISelectedSuggestion,\n\t\tacceptNext: (selected: ISelectedSuggestion) => any,\n\t): void {\n\t\t// no suggestions -> nothing to do\n\t\tif (model.items.length === 0) {\n\t\t\tthis.reset();\n\t\t\treturn;\n\t\t}\n\n\t\t// no alternative suggestions -> nothing to do\n\t\tconst nextIndex = SuggestAlternatives._moveIndex(true, model, index);\n\t\tif (nextIndex === index) {\n\t\t\tthis.reset();\n\t\t\treturn;\n\t\t}\n\n\t\tthis._acceptNext = acceptNext;\n\t\tthis._model = model;\n\t\tthis._index = index;\n\t\tthis._listener = this._editor.onDidChangeCursorPosition(() => {\n\t\t\tif (!this._ignore) {\n\t\t\t\tthis.reset();\n\t\t\t}\n\t\t});\n\t\tthis._ckOtherSuggestions.set(true);\n\t}\n\n\tprivate static _moveIndex(\n\t\tfwd: boolean,\n\t\tmodel: CompletionModel,\n\t\tindex: number,\n\t): number {\n\t\tlet newIndex = index;\n\t\tfor (let rounds = model.items.length; rounds > 0; rounds--) {\n\t\t\tnewIndex =\n\t\t\t\t(newIndex + model.items.length + (fwd ? +1 : -1)) %\n\t\t\t\tmodel.items.length;\n\t\t\tif (newIndex === index) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (!model.items[newIndex].completion.additionalTextEdits) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn newIndex;\n\t}\n\n\tnext(): void {\n\t\tthis._move(true);\n\t}\n\n\tprev(): void {\n\t\tthis._move(false);\n\t}\n\n\tprivate _move(fwd: boolean): void {\n\t\tif (!this._model) {\n\t\t\t// nothing to reason about\n\t\t\treturn;\n\t\t}\n\t\ttry {\n\t\t\tthis._ignore = true;\n\t\t\tthis._index = SuggestAlternatives._moveIndex(\n\t\t\t\tfwd,\n\t\t\t\tthis._model,\n\t\t\t\tthis._index,\n\t\t\t);\n\t\t\tthis._acceptNext!({\n\t\t\t\tindex: this._index,\n\t\t\t\titem: this._model.items[this._index],\n\t\t\t\tmodel: this._model,\n\t\t\t});\n\t\t} finally {\n\t\t\tthis._ignore = false;\n\t\t}\n\t}\n}\n"],
  "mappings": ";;;;;;;;;;;;AAMA;AAAA,EAEC;AAAA,EACA;AAAA,OACM;AAKA,IAAM,sBAAN,MAA0B;AAAA,EAchC,YACkB,SACG,mBACnB;AAFgB;AAGjB,SAAK,sBACJ,oBAAoB,iBAAiB,OAAO,iBAAiB;AAAA,EAC/D;AAAA,EAnCD,OAeiC;AAAA;AAAA;AAAA,EAChC,OAAgB,mBAAmB,IAAI;AAAA,IACtC;AAAA,IACA;AAAA,EACD;AAAA,EAEiB;AAAA,EAET,SAAS;AAAA,EACT;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EAUR,UAAgB;AACf,SAAK,MAAM;AAAA,EACZ;AAAA,EAEA,QAAc;AACb,SAAK,oBAAoB,MAAM;AAC/B,SAAK,WAAW,QAAQ;AACxB,SAAK,SAAS;AACd,SAAK,cAAc;AACnB,SAAK,UAAU;AAAA,EAChB;AAAA,EAEA,IACC,EAAE,OAAO,MAAM,GACf,YACO;AAEP,QAAI,MAAM,MAAM,WAAW,GAAG;AAC7B,WAAK,MAAM;AACX;AAAA,IACD;AAGA,UAAM,YAAY,oBAAoB,WAAW,MAAM,OAAO,KAAK;AACnE,QAAI,cAAc,OAAO;AACxB,WAAK,MAAM;AACX;AAAA,IACD;AAEA,SAAK,cAAc;AACnB,SAAK,SAAS;AACd,SAAK,SAAS;AACd,SAAK,YAAY,KAAK,QAAQ,0BAA0B,MAAM;AAC7D,UAAI,CAAC,KAAK,SAAS;AAClB,aAAK,MAAM;AAAA,MACZ;AAAA,IACD,CAAC;AACD,SAAK,oBAAoB,IAAI,IAAI;AAAA,EAClC;AAAA,EAEA,OAAe,WACd,KACA,OACA,OACS;AACT,QAAI,WAAW;AACf,aAAS,SAAS,MAAM,MAAM,QAAQ,SAAS,GAAG,UAAU;AAC3D,kBACE,WAAW,MAAM,MAAM,UAAU,MAAM,IAAK,OAC7C,MAAM,MAAM;AACb,UAAI,aAAa,OAAO;AACvB;AAAA,MACD;AACA,UAAI,CAAC,MAAM,MAAM,QAAQ,EAAE,WAAW,qBAAqB;AAC1D;AAAA,MACD;AAAA,IACD;AACA,WAAO;AAAA,EACR;AAAA,EAEA,OAAa;AACZ,SAAK,MAAM,IAAI;AAAA,EAChB;AAAA,EAEA,OAAa;AACZ,SAAK,MAAM,KAAK;AAAA,EACjB;AAAA,EAEQ,MAAM,KAAoB;AACjC,QAAI,CAAC,KAAK,QAAQ;AAEjB;AAAA,IACD;AACA,QAAI;AACH,WAAK,UAAU;AACf,WAAK,SAAS,oBAAoB;AAAA,QACjC;AAAA,QACA,KAAK;AAAA,QACL,KAAK;AAAA,MACN;AACA,WAAK,YAAa;AAAA,QACjB,OAAO,KAAK;AAAA,QACZ,MAAM,KAAK,OAAO,MAAM,KAAK,MAAM;AAAA,QACnC,OAAO,KAAK;AAAA,MACb,CAAC;AAAA,IACF,UAAE;AACD,WAAK,UAAU;AAAA,IAChB;AAAA,EACD;AACD;AA/Ga,sBAAN;AAAA,EAgBJ;AAAA,GAhBU;",
  "names": []
}
