import{DisposableStore as d}from"../../../../base/common/lifecycle.js";class a{static _maxSelectionLength=51200;_disposables=new d;_lastOvertyped=[];_locked=!1;constructor(e,l){this._disposables.add(e.onWillType(()=>{if(this._locked||!e.hasModel())return;const s=e.getSelections(),o=s.length;let n=!1;for(let t=0;t<o;t++)if(!s[t].isEmpty()){n=!0;break}if(!n){this._lastOvertyped.length!==0&&(this._lastOvertyped.length=0);return}this._lastOvertyped=[];const r=e.getModel();for(let t=0;t<o;t++){const i=s[t];if(r.getValueLengthInRange(i)>a._maxSelectionLength)return;this._lastOvertyped[t]={value:r.getValueInRange(i),multiline:i.startLineNumber!==i.endLineNumber}}})),this._disposables.add(l.onDidTrigger(s=>{this._locked=!0})),this._disposables.add(l.onDidCancel(s=>{this._locked=!1}))}getLastOvertypedInfo(e){if(e>=0&&e<this._lastOvertyped.length)return this._lastOvertyped[e]}dispose(){this._disposables.dispose()}}export{a as OvertypingCapturer};
