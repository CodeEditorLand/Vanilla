{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/editor/contrib/suggest/browser/suggestCommitCharacters.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { isNonEmptyArray } from \"../../../../base/common/arrays.js\";\nimport { DisposableStore } from \"../../../../base/common/lifecycle.js\";\nimport type { ICodeEditor } from \"../../../browser/editorBrowser.js\";\nimport { EditorOption } from \"../../../common/config/editorOptions.js\";\nimport { CharacterSet } from \"../../../common/core/characterClassifier.js\";\nimport { State, type SuggestModel } from \"./suggestModel.js\";\nimport type { ISelectedSuggestion, SuggestWidget } from \"./suggestWidget.js\";\n\nexport class CommitCharacterController {\n\tprivate readonly _disposables = new DisposableStore();\n\n\tprivate _active?: {\n\t\treadonly acceptCharacters: CharacterSet;\n\t\treadonly item: ISelectedSuggestion;\n\t};\n\n\tconstructor(\n\t\teditor: ICodeEditor,\n\t\twidget: SuggestWidget,\n\t\tmodel: SuggestModel,\n\t\taccept: (selected: ISelectedSuggestion) => any,\n\t) {\n\t\tthis._disposables.add(\n\t\t\tmodel.onDidSuggest((e) => {\n\t\t\t\tif (e.completionModel.items.length === 0) {\n\t\t\t\t\tthis.reset();\n\t\t\t\t}\n\t\t\t}),\n\t\t);\n\t\tthis._disposables.add(\n\t\t\tmodel.onDidCancel((e) => {\n\t\t\t\tthis.reset();\n\t\t\t}),\n\t\t);\n\n\t\tthis._disposables.add(\n\t\t\twidget.onDidShow(() => this._onItem(widget.getFocusedItem())),\n\t\t);\n\t\tthis._disposables.add(widget.onDidFocus(this._onItem, this));\n\t\tthis._disposables.add(widget.onDidHide(this.reset, this));\n\n\t\tthis._disposables.add(\n\t\t\teditor.onWillType((text) => {\n\t\t\t\tif (\n\t\t\t\t\tthis._active &&\n\t\t\t\t\t!widget.isFrozen() &&\n\t\t\t\t\tmodel.state !== State.Idle\n\t\t\t\t) {\n\t\t\t\t\tconst ch = text.charCodeAt(text.length - 1);\n\t\t\t\t\tif (\n\t\t\t\t\t\tthis._active.acceptCharacters.has(ch) &&\n\t\t\t\t\t\teditor.getOption(\n\t\t\t\t\t\t\tEditorOption.acceptSuggestionOnCommitCharacter,\n\t\t\t\t\t\t)\n\t\t\t\t\t) {\n\t\t\t\t\t\taccept(this._active.item);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}),\n\t\t);\n\t}\n\n\tprivate _onItem(selected: ISelectedSuggestion | undefined): void {\n\t\tif (\n\t\t\t!selected ||\n\t\t\t!isNonEmptyArray(selected.item.completion.commitCharacters)\n\t\t) {\n\t\t\t// no item or no commit characters\n\t\t\tthis.reset();\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._active && this._active.item.item === selected.item) {\n\t\t\t// still the same item\n\t\t\treturn;\n\t\t}\n\n\t\t// keep item and its commit characters\n\t\tconst acceptCharacters = new CharacterSet();\n\t\tfor (const ch of selected.item.completion.commitCharacters) {\n\t\t\tif (ch.length > 0) {\n\t\t\t\tacceptCharacters.add(ch.charCodeAt(0));\n\t\t\t}\n\t\t}\n\t\tthis._active = { acceptCharacters, item: selected };\n\t}\n\n\treset(): void {\n\t\tthis._active = undefined;\n\t}\n\n\tdispose() {\n\t\tthis._disposables.dispose();\n\t}\n}\n"],
  "mappings": ";;AAKA,SAAS,uBAAuB;AAChC,SAAS,uBAAuB;AAEhC,SAAS,oBAAoB;AAC7B,SAAS,oBAAoB;AAC7B,SAAS,aAAgC;AAGlC,MAAM,0BAA0B;AAAA,EAbvC,OAauC;AAAA;AAAA;AAAA,EACrB,eAAe,IAAI,gBAAgB;AAAA,EAE5C;AAAA,EAKR,YACC,QACA,QACA,OACA,QACC;AACD,SAAK,aAAa;AAAA,MACjB,MAAM,aAAa,CAAC,MAAM;AACzB,YAAI,EAAE,gBAAgB,MAAM,WAAW,GAAG;AACzC,eAAK,MAAM;AAAA,QACZ;AAAA,MACD,CAAC;AAAA,IACF;AACA,SAAK,aAAa;AAAA,MACjB,MAAM,YAAY,CAAC,MAAM;AACxB,aAAK,MAAM;AAAA,MACZ,CAAC;AAAA,IACF;AAEA,SAAK,aAAa;AAAA,MACjB,OAAO,UAAU,MAAM,KAAK,QAAQ,OAAO,eAAe,CAAC,CAAC;AAAA,IAC7D;AACA,SAAK,aAAa,IAAI,OAAO,WAAW,KAAK,SAAS,IAAI,CAAC;AAC3D,SAAK,aAAa,IAAI,OAAO,UAAU,KAAK,OAAO,IAAI,CAAC;AAExD,SAAK,aAAa;AAAA,MACjB,OAAO,WAAW,CAAC,SAAS;AAC3B,YACC,KAAK,WACL,CAAC,OAAO,SAAS,KACjB,MAAM,UAAU,MAAM,MACrB;AACD,gBAAM,KAAK,KAAK,WAAW,KAAK,SAAS,CAAC;AAC1C,cACC,KAAK,QAAQ,iBAAiB,IAAI,EAAE,KACpC,OAAO;AAAA,YACN,aAAa;AAAA,UACd,GACC;AACD,mBAAO,KAAK,QAAQ,IAAI;AAAA,UACzB;AAAA,QACD;AAAA,MACD,CAAC;AAAA,IACF;AAAA,EACD;AAAA,EAEQ,QAAQ,UAAiD;AAChE,QACC,CAAC,YACD,CAAC,gBAAgB,SAAS,KAAK,WAAW,gBAAgB,GACzD;AAED,WAAK,MAAM;AACX;AAAA,IACD;AAEA,QAAI,KAAK,WAAW,KAAK,QAAQ,KAAK,SAAS,SAAS,MAAM;AAE7D;AAAA,IACD;AAGA,UAAM,mBAAmB,IAAI,aAAa;AAC1C,eAAW,MAAM,SAAS,KAAK,WAAW,kBAAkB;AAC3D,UAAI,GAAG,SAAS,GAAG;AAClB,yBAAiB,IAAI,GAAG,WAAW,CAAC,CAAC;AAAA,MACtC;AAAA,IACD;AACA,SAAK,UAAU,EAAE,kBAAkB,MAAM,SAAS;AAAA,EACnD;AAAA,EAEA,QAAc;AACb,SAAK,UAAU;AAAA,EAChB;AAAA,EAEA,UAAU;AACT,SAAK,aAAa,QAAQ;AAAA,EAC3B;AACD;",
  "names": []
}
