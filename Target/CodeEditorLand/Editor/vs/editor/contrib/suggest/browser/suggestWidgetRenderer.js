var K=Object.defineProperty;var W=Object.getOwnPropertyDescriptor;var E=(a,o,n,e)=>{for(var t=e>1?void 0:e?W(o,n):o,s=a.length-1,c;s>=0;s--)(c=a[s])&&(t=(e?c(o,n,t):c(t))||t);return e&&t&&K(o,n,t),t},u=(a,o)=>(n,e)=>o(n,e,a);import{$ as r,append as l,hide as F,show as D}from"../../../../base/browser/dom.js";import{IconLabel as V}from"../../../../base/browser/ui/iconLabel/iconLabel.js";import{Codicon as B}from"../../../../base/common/codicons.js";import{Emitter as U}from"../../../../base/common/event.js";import{createMatches as G}from"../../../../base/common/filters.js";import{DisposableStore as J}from"../../../../base/common/lifecycle.js";import{ThemeIcon as _}from"../../../../base/common/themables.js";import{URI as L}from"../../../../base/common/uri.js";import*as w from"../../../../nls.js";import{FileKind as b}from"../../../../platform/files/common/files.js";import{registerIcon as Q}from"../../../../platform/theme/common/iconRegistry.js";import{IThemeService as X}from"../../../../platform/theme/common/themeService.js";import{EditorOption as I}from"../../../common/config/editorOptions.js";import{CompletionItemKind as C,CompletionItemKinds as Y,CompletionItemTag as Z}from"../../../common/languages.js";import{ILanguageService as ee}from"../../../common/languages/language.js";import{getIconClasses as S}from"../../../common/services/getIconClasses.js";import{IModelService as te}from"../../../common/services/model.js";import{canExpandCompletionItem as oe}from"./suggestWidgetDetails.js";function ne(a){return`suggest-aria-id:${a}`}const ie=Q("suggest-more-info",B.chevronRight,w.localize("suggestMoreInfoIcon","Icon for more information in the suggest widget.")),se=new class p{static _regexRelaxed=/(#([\da-fA-F]{3}){1,2}|(rgb|hsl)a\(\s*(\d{1,3}%?\s*,\s*){3}(1|0?\.\d+)\)|(rgb|hsl)\(\s*\d{1,3}%?(\s*,\s*\d{1,3}%?){2}\s*\))/;static _regexStrict=new RegExp(`^${p._regexRelaxed.source}$`,"i");extract(o,n){if(o.textLabel.match(p._regexStrict))return n[0]=o.textLabel,!0;if(o.completion.detail&&o.completion.detail.match(p._regexStrict))return n[0]=o.completion.detail,!0;if(o.completion.documentation){const e=typeof o.completion.documentation=="string"?o.completion.documentation:o.completion.documentation.value,t=p._regexRelaxed.exec(e);if(t&&(t.index===0||t.index+t[0].length===e.length))return n[0]=t[0],!0}return!1}};let x=class{constructor(o,n,e,t){this._editor=o;this._modelService=n;this._languageService=e;this._themeService=t}_onDidToggleDetails=new U;onDidToggleDetails=this._onDidToggleDetails.event;templateId="suggestion";dispose(){this._onDidToggleDetails.dispose()}renderTemplate(o){const n=new J,e=o;e.classList.add("show-file-icons");const t=l(o,r(".icon")),s=l(t,r("span.colorspan")),c=l(o,r(".contents")),i=l(c,r(".main")),d=l(i,r(".icon-label.codicon")),f=l(i,r("span.left")),y=l(i,r("span.right")),M=new V(f,{supportHighlights:!0,supportIcons:!0});n.add(M);const H=l(f,r("span.signature-label")),k=l(f,r("span.qualifier-label")),N=l(y,r("span.details-label")),h=l(y,r("span.readMore"+_.asCSSSelector(ie)));return h.title=w.localize("readMore","Read More"),{root:e,left:f,right:y,icon:t,colorspan:s,iconLabel:M,iconContainer:d,parametersLabel:H,qualifierLabel:k,detailsLabel:N,readMore:h,disposables:n,configureFont:()=>{const v=this._editor.getOptions(),m=v.get(I.fontInfo),O=m.getMassagedFontFamily(),R=m.fontFeatureSettings,z=v.get(I.suggestFontSize)||m.fontSize,$=v.get(I.suggestLineHeight)||m.lineHeight,P=m.fontWeight,j=m.letterSpacing,q=`${z}px`,g=`${$}px`,A=`${j}px`;e.style.fontSize=q,e.style.fontWeight=P,e.style.letterSpacing=A,i.style.fontFamily=O,i.style.fontFeatureSettings=R,i.style.lineHeight=g,t.style.height=g,t.style.width=g,h.style.height=g,h.style.width=g}}}renderElement(o,n,e){e.configureFont();const{completion:t}=o;e.root.id=ne(n),e.colorspan.style.backgroundColor="";const s={labelEscapeNewLines:!0,matches:G(o.score)},c=[];if(t.kind===C.Color&&se.extract(o,c))e.icon.className="icon customcolor",e.iconContainer.className="icon hide",e.colorspan.style.backgroundColor=c[0];else if(t.kind===C.File&&this._themeService.getFileIconTheme().hasFileIcons){e.icon.className="icon hide",e.iconContainer.className="icon hide";const i=S(this._modelService,this._languageService,L.from({scheme:"fake",path:o.textLabel}),b.FILE),d=S(this._modelService,this._languageService,L.from({scheme:"fake",path:t.detail}),b.FILE);s.extraClasses=i.length>d.length?i:d}else t.kind===C.Folder&&this._themeService.getFileIconTheme().hasFolderIcons?(e.icon.className="icon hide",e.iconContainer.className="icon hide",s.extraClasses=[S(this._modelService,this._languageService,L.from({scheme:"fake",path:o.textLabel}),b.FOLDER),S(this._modelService,this._languageService,L.from({scheme:"fake",path:t.detail}),b.FOLDER)].flat()):(e.icon.className="icon hide",e.iconContainer.className="",e.iconContainer.classList.add("suggest-icon",..._.asClassNameArray(Y.toIcon(t.kind))));t.tags&&t.tags.indexOf(Z.Deprecated)>=0&&(s.extraClasses=(s.extraClasses||[]).concat(["deprecated"]),s.matches=[]),e.iconLabel.setLabel(o.textLabel,void 0,s),typeof t.label=="string"?(e.parametersLabel.textContent="",e.detailsLabel.textContent=T(t.detail||""),e.root.classList.add("string-label")):(e.parametersLabel.textContent=T(t.label.detail||""),e.detailsLabel.textContent=T(t.label.description||""),e.root.classList.remove("string-label")),this._editor.getOption(I.suggest).showInlineDetails?D(e.detailsLabel):F(e.detailsLabel),oe(o)?(e.right.classList.add("can-expand-details"),D(e.readMore),e.readMore.onmousedown=i=>{i.stopPropagation(),i.preventDefault()},e.readMore.onclick=i=>{i.stopPropagation(),i.preventDefault(),this._onDidToggleDetails.fire()}):(e.right.classList.remove("can-expand-details"),F(e.readMore),e.readMore.onmousedown=null,e.readMore.onclick=null)}disposeTemplate(o){o.disposables.dispose()}};x=E([u(1,te),u(2,ee),u(3,X)],x);function T(a){return a.replace(/\r\n|\r|\n/g,"")}export{x as ItemRenderer,ne as getAriaId};
