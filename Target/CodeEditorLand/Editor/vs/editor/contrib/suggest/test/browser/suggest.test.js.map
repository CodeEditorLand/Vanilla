{
  "version": 3,
  "sources": ["../../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/editor/contrib/suggest/test/browser/suggest.test.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport assert from 'assert';\nimport { IDisposable } from '../../../../../base/common/lifecycle.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { Position } from '../../../../common/core/position.js';\nimport { Range } from '../../../../common/core/range.js';\nimport { TextModel } from '../../../../common/model/textModel.js';\nimport { CompletionItemKind, CompletionItemProvider } from '../../../../common/languages.js';\nimport { CompletionOptions, provideSuggestionItems, SnippetSortOrder } from '../../browser/suggest.js';\nimport { createTextModel } from '../../../../test/common/testTextModel.js';\nimport { LanguageFeatureRegistry } from '../../../../common/languageFeatureRegistry.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\n\n\nsuite('Suggest', function () {\n\tlet model: TextModel;\n\tlet registration: IDisposable;\n\tlet registry: LanguageFeatureRegistry<CompletionItemProvider>;\n\n\tsetup(function () {\n\t\tregistry = new LanguageFeatureRegistry();\n\t\tmodel = createTextModel('FOO\\nbar\\BAR\\nfoo', undefined, undefined, URI.parse('foo:bar/path'));\n\t\tregistration = registry.register({ pattern: 'bar/path', scheme: 'foo' }, {\n\t\t\t_debugDisplayName: 'test',\n\t\t\tprovideCompletionItems(_doc, pos) {\n\t\t\t\treturn {\n\t\t\t\t\tincomplete: false,\n\t\t\t\t\tsuggestions: [{\n\t\t\t\t\t\tlabel: 'aaa',\n\t\t\t\t\t\tkind: CompletionItemKind.Snippet,\n\t\t\t\t\t\tinsertText: 'aaa',\n\t\t\t\t\t\trange: Range.fromPositions(pos)\n\t\t\t\t\t}, {\n\t\t\t\t\t\tlabel: 'zzz',\n\t\t\t\t\t\tkind: CompletionItemKind.Snippet,\n\t\t\t\t\t\tinsertText: 'zzz',\n\t\t\t\t\t\trange: Range.fromPositions(pos)\n\t\t\t\t\t}, {\n\t\t\t\t\t\tlabel: 'fff',\n\t\t\t\t\t\tkind: CompletionItemKind.Property,\n\t\t\t\t\t\tinsertText: 'fff',\n\t\t\t\t\t\trange: Range.fromPositions(pos)\n\t\t\t\t\t}]\n\t\t\t\t};\n\t\t\t}\n\t\t});\n\t});\n\n\tteardown(() => {\n\t\tregistration.dispose();\n\t\tmodel.dispose();\n\t});\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('sort - snippet inline', async function () {\n\t\tconst { items, disposable } = await provideSuggestionItems(registry, model, new Position(1, 1), new CompletionOptions(SnippetSortOrder.Inline));\n\t\tassert.strictEqual(items.length, 3);\n\t\tassert.strictEqual(items[0].completion.label, 'aaa');\n\t\tassert.strictEqual(items[1].completion.label, 'fff');\n\t\tassert.strictEqual(items[2].completion.label, 'zzz');\n\t\tdisposable.dispose();\n\t});\n\n\ttest('sort - snippet top', async function () {\n\t\tconst { items, disposable } = await provideSuggestionItems(registry, model, new Position(1, 1), new CompletionOptions(SnippetSortOrder.Top));\n\t\tassert.strictEqual(items.length, 3);\n\t\tassert.strictEqual(items[0].completion.label, 'aaa');\n\t\tassert.strictEqual(items[1].completion.label, 'zzz');\n\t\tassert.strictEqual(items[2].completion.label, 'fff');\n\t\tdisposable.dispose();\n\t});\n\n\ttest('sort - snippet bottom', async function () {\n\t\tconst { items, disposable } = await provideSuggestionItems(registry, model, new Position(1, 1), new CompletionOptions(SnippetSortOrder.Bottom));\n\t\tassert.strictEqual(items.length, 3);\n\t\tassert.strictEqual(items[0].completion.label, 'fff');\n\t\tassert.strictEqual(items[1].completion.label, 'aaa');\n\t\tassert.strictEqual(items[2].completion.label, 'zzz');\n\t\tdisposable.dispose();\n\t});\n\n\ttest('sort - snippet none', async function () {\n\t\tconst { items, disposable } = await provideSuggestionItems(registry, model, new Position(1, 1), new CompletionOptions(undefined, new Set<CompletionItemKind>().add(CompletionItemKind.Snippet)));\n\t\tassert.strictEqual(items.length, 1);\n\t\tassert.strictEqual(items[0].completion.label, 'fff');\n\t\tdisposable.dispose();\n\t});\n\n\ttest('only from', function (callback) {\n\n\t\tconst foo: any = {\n\t\t\ttriggerCharacters: [],\n\t\t\tprovideCompletionItems() {\n\t\t\t\treturn {\n\t\t\t\t\tcurrentWord: '',\n\t\t\t\t\tincomplete: false,\n\t\t\t\t\tsuggestions: [{\n\t\t\t\t\t\tlabel: 'jjj',\n\t\t\t\t\t\ttype: 'property',\n\t\t\t\t\t\tinsertText: 'jjj'\n\t\t\t\t\t}]\n\t\t\t\t};\n\t\t\t}\n\t\t};\n\t\tconst registration = registry.register({ pattern: 'bar/path', scheme: 'foo' }, foo);\n\n\t\tprovideSuggestionItems(registry, model, new Position(1, 1), new CompletionOptions(undefined, undefined, new Set<CompletionItemProvider>().add(foo))).then(({ items, disposable }) => {\n\t\t\tregistration.dispose();\n\n\t\t\tassert.strictEqual(items.length, 1);\n\t\t\tassert.ok(items[0].provider === foo);\n\t\t\tdisposable.dispose();\n\t\t\tcallback();\n\t\t});\n\t});\n\n\ttest('Ctrl+space completions stopped working with the latest Insiders, #97650', async function () {\n\n\n\t\tconst foo = new class implements CompletionItemProvider {\n\n\t\t\t_debugDisplayName = 'test';\n\t\t\ttriggerCharacters = [];\n\n\t\t\tprovideCompletionItems() {\n\t\t\t\treturn {\n\t\t\t\t\tsuggestions: [{\n\t\t\t\t\t\tlabel: 'one',\n\t\t\t\t\t\tkind: CompletionItemKind.Class,\n\t\t\t\t\t\tinsertText: 'one',\n\t\t\t\t\t\trange: {\n\t\t\t\t\t\t\tinsert: new Range(0, 0, 0, 0),\n\t\t\t\t\t\t\treplace: new Range(0, 0, 0, 10)\n\t\t\t\t\t\t}\n\t\t\t\t\t}, {\n\t\t\t\t\t\tlabel: 'two',\n\t\t\t\t\t\tkind: CompletionItemKind.Class,\n\t\t\t\t\t\tinsertText: 'two',\n\t\t\t\t\t\trange: {\n\t\t\t\t\t\t\tinsert: new Range(0, 0, 0, 0),\n\t\t\t\t\t\t\treplace: new Range(0, 1, 0, 10)\n\t\t\t\t\t\t}\n\t\t\t\t\t}]\n\t\t\t\t};\n\t\t\t}\n\t\t};\n\n\t\tconst registration = registry.register({ pattern: 'bar/path', scheme: 'foo' }, foo);\n\t\tconst { items, disposable } = await provideSuggestionItems(registry, model, new Position(0, 0), new CompletionOptions(undefined, undefined, new Set<CompletionItemProvider>().add(foo)));\n\t\tregistration.dispose();\n\n\t\tassert.strictEqual(items.length, 2);\n\t\tconst [a, b] = items;\n\n\t\tassert.strictEqual(a.completion.label, 'one');\n\t\tassert.strictEqual(a.isInvalid, false);\n\t\tassert.strictEqual(b.completion.label, 'two');\n\t\tassert.strictEqual(b.isInvalid, true);\n\t\tdisposable.dispose();\n\t});\n});\n"],
  "mappings": "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",
  "names": ["registration"]
}
