{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/editor/contrib/placeholderText/browser/placeholderTextContribution.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { h } from \"../../../../base/browser/dom.js\";\nimport { structuralEquals } from \"../../../../base/common/equals.js\";\nimport { Disposable } from \"../../../../base/common/lifecycle.js\";\nimport {\n\ttype DebugOwner,\n\ttype IObservable,\n\ttype IReader,\n\tautorun,\n\tconstObservable,\n\tderivedObservableWithCache,\n\tderivedOpts,\n\tderivedWithStore,\n} from \"../../../../base/common/observable.js\";\nimport type { ICodeEditor } from \"../../../browser/editorBrowser.js\";\nimport { observableCodeEditor } from \"../../../browser/observableCodeEditor.js\";\nimport { EditorOption } from \"../../../common/config/editorOptions.js\";\nimport type { IEditorContribution } from \"../../../common/editorCommon.js\";\n\n/**\n * Use the editor option to set the placeholder text.\n */\nexport class PlaceholderTextContribution\n\textends Disposable\n\timplements IEditorContribution\n{\n\tpublic static get(editor: ICodeEditor): PlaceholderTextContribution {\n\t\treturn editor.getContribution<PlaceholderTextContribution>(\n\t\t\tPlaceholderTextContribution.ID,\n\t\t)!;\n\t}\n\n\tpublic static readonly ID = \"editor.contrib.placeholderText\";\n\tprivate readonly _editorObs = observableCodeEditor(this._editor);\n\n\tprivate readonly _placeholderText = this._editorObs.getOption(\n\t\tEditorOption.placeholder,\n\t);\n\n\tprivate readonly _state = derivedOpts<{ placeholder: string } | undefined>(\n\t\t{ owner: this, equalsFn: structuralEquals },\n\t\t(reader) => {\n\t\t\tconst p = this._placeholderText.read(reader);\n\t\t\tif (!p) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t\tif (!this._editorObs.valueIsEmpty.read(reader)) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t\treturn { placeholder: p };\n\t\t},\n\t);\n\n\tprivate readonly _shouldViewBeAlive = isOrWasTrue(\n\t\tthis,\n\t\t(reader) => this._state.read(reader)?.placeholder !== undefined,\n\t);\n\n\tprivate readonly _view = derivedWithStore((reader, store) => {\n\t\tif (!this._shouldViewBeAlive.read(reader)) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst element = h(\"div.editorPlaceholder\");\n\n\t\tstore.add(\n\t\t\tautorun((reader) => {\n\t\t\t\tconst data = this._state.read(reader);\n\t\t\t\tconst shouldBeVisibile = data?.placeholder !== undefined;\n\t\t\t\telement.root.style.display = shouldBeVisibile\n\t\t\t\t\t? \"block\"\n\t\t\t\t\t: \"none\";\n\t\t\t\telement.root.innerText = data?.placeholder ?? \"\";\n\t\t\t}),\n\t\t);\n\t\tstore.add(\n\t\t\tautorun((reader) => {\n\t\t\t\tconst info = this._editorObs.layoutInfo.read(reader);\n\t\t\t\telement.root.style.left = `${info.contentLeft}px`;\n\t\t\t\telement.root.style.width =\n\t\t\t\t\tinfo.contentWidth - info.verticalScrollbarWidth + \"px\";\n\t\t\t\telement.root.style.top = `${this._editor.getTopForLineNumber(0)}px`;\n\t\t\t}),\n\t\t);\n\t\tstore.add(\n\t\t\tautorun((reader) => {\n\t\t\t\telement.root.style.fontFamily = this._editorObs\n\t\t\t\t\t.getOption(EditorOption.fontFamily)\n\t\t\t\t\t.read(reader);\n\t\t\t\telement.root.style.fontSize =\n\t\t\t\t\tthis._editorObs\n\t\t\t\t\t\t.getOption(EditorOption.fontSize)\n\t\t\t\t\t\t.read(reader) + \"px\";\n\t\t\t\telement.root.style.lineHeight =\n\t\t\t\t\tthis._editorObs\n\t\t\t\t\t\t.getOption(EditorOption.lineHeight)\n\t\t\t\t\t\t.read(reader) + \"px\";\n\t\t\t}),\n\t\t);\n\t\tstore.add(\n\t\t\tthis._editorObs.createOverlayWidget({\n\t\t\t\tallowEditorOverflow: false,\n\t\t\t\tminContentWidthInPx: constObservable(0),\n\t\t\t\tposition: constObservable(null),\n\t\t\t\tdomNode: element.root,\n\t\t\t}),\n\t\t);\n\t});\n\n\tconstructor(private readonly _editor: ICodeEditor) {\n\t\tsuper();\n\t\tthis._view.recomputeInitiallyAndOnChange(this._store);\n\t}\n}\n\nfunction isOrWasTrue(\n\towner: DebugOwner,\n\tfn: (reader: IReader) => boolean,\n): IObservable<boolean> {\n\treturn derivedObservableWithCache<boolean>(owner, (reader, lastValue) => {\n\t\tif (lastValue === true) {\n\t\t\treturn true;\n\t\t}\n\t\treturn fn(reader);\n\t});\n}\n"],
  "mappings": "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",
  "names": ["reader"]
}
