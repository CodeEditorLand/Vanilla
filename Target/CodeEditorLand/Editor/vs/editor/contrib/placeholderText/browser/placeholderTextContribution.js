import{h as u}from"../../../../base/browser/dom.js";import{structuralEquals as b}from"../../../../base/common/equals.js";import{Disposable as c}from"../../../../base/common/lifecycle.js";import{autorun as n,constObservable as a,derivedObservableWithCache as f,derivedOpts as m}from"../../../../base/common/observable.js";import{derivedWithStore as O}from"../../../../base/common/observableInternal/derived.js";import{observableCodeEditor as v}from"../../../browser/observableCodeEditor.js";import{EditorOption as d}from"../../../common/config/editorOptions.js";class s extends c{constructor(e){super();this._editor=e;this._view.recomputeInitiallyAndOnChange(this._store)}static get(e){return e.getContribution(s.ID)}static ID="editor.contrib.placeholderText";_editorObs=v(this._editor);_placeholderText=this._editorObs.getOption(d.placeholder);_state=m({owner:this,equalsFn:b},e=>{const t=this._placeholderText.read(e);if(t&&this._editorObs.valueIsEmpty.read(e))return{placeholder:t}});_shouldViewBeAlive=y(this,e=>this._state.read(e)?.placeholder!==void 0);_view=O((e,t)=>{if(!this._shouldViewBeAlive.read(e))return;const o=u("div.editorPlaceholder");t.add(n(r=>{const i=this._state.read(r),h=i?.placeholder!==void 0;o.root.style.display=h?"block":"none",o.root.innerText=i?.placeholder??""})),t.add(n(r=>{const i=this._editorObs.layoutInfo.read(r);o.root.style.left=`${i.contentLeft}px`,o.root.style.width=i.contentWidth-i.verticalScrollbarWidth+"px",o.root.style.top=`${this._editor.getTopForLineNumber(0)}px`})),t.add(n(r=>{o.root.style.fontFamily=this._editorObs.getOption(d.fontFamily).read(r),o.root.style.fontSize=this._editorObs.getOption(d.fontSize).read(r)+"px",o.root.style.lineHeight=this._editorObs.getOption(d.lineHeight).read(r)+"px"})),t.add(this._editorObs.createOverlayWidget({allowEditorOverflow:!1,minContentWidthInPx:a(0),position:a(null),domNode:o.root}))})}function y(p,l){return f(p,(e,t)=>t===!0?!0:l(e))}export{s as PlaceholderTextContribution};
