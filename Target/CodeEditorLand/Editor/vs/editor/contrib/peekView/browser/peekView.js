var v=Object.defineProperty;var b=Object.getOwnPropertyDescriptor;var k=(d,i,e,t)=>{for(var o=t>1?void 0:t?b(i,e):i,a=d.length-1,h;a>=0;a--)(h=d[a])&&(o=(t?h(i,e,o):h(o))||o);return t&&o&&v(i,e,o),o},m=(d,i)=>(e,t)=>i(e,t,d);import*as l from"../../../../base/browser/dom.js";import{ActionBar as H,ActionsOrientation as C}from"../../../../base/browser/ui/actionbar/actionbar.js";import{Action as V}from"../../../../base/common/actions.js";import{Codicon as I}from"../../../../base/common/codicons.js";import{Color as r}from"../../../../base/common/color.js";import{Emitter as B}from"../../../../base/common/event.js";import*as S from"../../../../base/common/objects.js";import{ThemeIcon as F}from"../../../../base/common/themables.js";import"./media/peekViewWidget.css";import*as n from"../../../../nls.js";import{createActionViewItem as T}from"../../../../platform/actions/browser/menuEntryActionViewItem.js";import{IContextKeyService as x,RawContextKey as L}from"../../../../platform/contextkey/common/contextkey.js";import{InstantiationType as D,registerSingleton as M}from"../../../../platform/instantiation/common/extensions.js";import{IInstantiationService as O,createDecorator as R}from"../../../../platform/instantiation/common/instantiation.js";import{activeContrastBorder as u,contrastBorder as w,editorForeground as p,editorInfoForeground as f,registerColor as s}from"../../../../platform/theme/common/colorRegistry.js";import{EditorContributionInstantiation as z,registerEditorContribution as P}from"../../../browser/editorExtensions.js";import{ICodeEditorService as A}from"../../../browser/services/codeEditorService.js";import{EmbeddedCodeEditorWidget as y}from"../../../browser/widget/codeEditor/embeddedCodeEditorWidget.js";import{EditorOption as W}from"../../../common/config/editorOptions.js";import{ZoneWidget as $}from"../../zoneWidget/browser/zoneWidget.js";const j=R("IPeekViewService");M(j,class{_widgets=new Map;addExclusiveWidget(d,i){const e=this._widgets.get(d);e&&(e.listener.dispose(),e.widget.dispose());const t=()=>{const o=this._widgets.get(d);o&&o.widget===i&&(o.listener.dispose(),this._widgets.delete(d))};this._widgets.set(d,{widget:i,listener:i.onDidClose(t)})}},D.Delayed);var E;(e=>(e.inPeekEditor=new L("inReferenceSearchEditor",!0,n.localize("inReferenceSearchEditor","Whether the current code editor is embedded inside peek")),e.notInPeekEditor=e.inPeekEditor.toNegated()))(E||={});let c=class{static ID="editor.contrib.referenceController";constructor(i,e){i instanceof y&&E.inPeekEditor.bindTo(e)}dispose(){}};c=k([m(1,x)],c),P(c.ID,c,z.Eager);function ae(d){const i=d.get(A).getFocusedCodeEditor();return i instanceof y?i.getParentEditor():i}const N={headerBackgroundColor:r.white,primaryHeadingColor:r.fromHex("#333333"),secondaryHeadingColor:r.fromHex("#6c6c6cb3")};let g=class extends ${constructor(e,t,o){super(e,t);this.instantiationService=o;S.mixin(this.options,N,!1)}_onDidClose=new B;onDidClose=this._onDidClose.event;disposed;_headElement;_titleElement;_primaryHeading;_secondaryHeading;_metaHeading;_actionbarWidget;_bodyElement;dispose(){this.disposed||(this.disposed=!0,super.dispose(),this._onDidClose.fire(this))}style(e){const t=this.options;e.headerBackgroundColor&&(t.headerBackgroundColor=e.headerBackgroundColor),e.primaryHeadingColor&&(t.primaryHeadingColor=e.primaryHeadingColor),e.secondaryHeadingColor&&(t.secondaryHeadingColor=e.secondaryHeadingColor),super.style(e)}_applyStyles(){super._applyStyles();const e=this.options;this._headElement&&e.headerBackgroundColor&&(this._headElement.style.backgroundColor=e.headerBackgroundColor.toString()),this._primaryHeading&&e.primaryHeadingColor&&(this._primaryHeading.style.color=e.primaryHeadingColor.toString()),this._secondaryHeading&&e.secondaryHeadingColor&&(this._secondaryHeading.style.color=e.secondaryHeadingColor.toString()),this._bodyElement&&e.frameColor&&(this._bodyElement.style.borderColor=e.frameColor.toString())}_fillContainer(e){this.setCssClass("peekview-widget"),this._headElement=l.$(".head"),this._bodyElement=l.$(".body"),this._fillHead(this._headElement),this._fillBody(this._bodyElement),e.appendChild(this._headElement),e.appendChild(this._bodyElement)}_fillHead(e,t){this._titleElement=l.$(".peekview-title"),this.options.supportOnTitleClick&&(this._titleElement.classList.add("clickable"),l.addStandardDisposableListener(this._titleElement,"click",h=>this._onTitleClick(h))),l.append(this._headElement,this._titleElement),this._fillTitleIcon(this._titleElement),this._primaryHeading=l.$("span.filename"),this._secondaryHeading=l.$("span.dirname"),this._metaHeading=l.$("span.meta"),l.append(this._titleElement,this._primaryHeading,this._secondaryHeading,this._metaHeading);const o=l.$(".peekview-actions");l.append(this._headElement,o);const a=this._getActionBarOptions();this._actionbarWidget=new H(o,a),this._disposables.add(this._actionbarWidget),t||this._actionbarWidget.push(new V("peekview.close",n.localize("label.close","Close"),F.asClassName(I.close),!0,()=>(this.dispose(),Promise.resolve())),{label:!1,icon:!0})}_fillTitleIcon(e){}_getActionBarOptions(){return{actionViewItemProvider:T.bind(void 0,this.instantiationService),orientation:C.HORIZONTAL}}_onTitleClick(e){}setTitle(e,t){this._primaryHeading&&this._secondaryHeading&&(this._primaryHeading.innerText=e,this._primaryHeading.setAttribute("title",e),t?this._secondaryHeading.innerText=t:l.clearNode(this._secondaryHeading))}setMetaTitle(e){this._metaHeading&&(e?(this._metaHeading.innerText=e,l.show(this._metaHeading)):l.hide(this._metaHeading))}_doLayout(e,t){if(!this._isShowing&&e<0){this.dispose();return}const o=Math.ceil(this.editor.getOption(W.lineHeight)*1.2),a=Math.round(e-(o+2));this._doLayoutHead(o,t),this._doLayoutBody(a,t)}_doLayoutHead(e,t){this._headElement&&(this._headElement.style.height=`${e}px`,this._headElement.style.lineHeight=this._headElement.style.height)}_doLayoutBody(e,t){this._bodyElement&&(this._bodyElement.style.height=`${e}px`)}};g=k([m(2,O)],g);const ce=s("peekViewTitle.background",{dark:"#252526",light:"#F3F3F3",hcDark:r.black,hcLight:r.white},n.localize("peekViewTitleBackground","Background color of the peek view title area.")),he=s("peekViewTitleLabel.foreground",{dark:r.white,light:r.black,hcDark:r.white,hcLight:p},n.localize("peekViewTitleForeground","Color of the peek view title.")),pe=s("peekViewTitleDescription.foreground",{dark:"#ccccccb3",light:"#616161",hcDark:"#FFFFFF99",hcLight:"#292929"},n.localize("peekViewTitleInfoForeground","Color of the peek view title info.")),ge=s("peekView.border",{dark:f,light:f,hcDark:w,hcLight:w},n.localize("peekViewBorder","Color of the peek view borders and arrow.")),ke=s("peekViewResult.background",{dark:"#252526",light:"#F3F3F3",hcDark:r.black,hcLight:r.white},n.localize("peekViewResultsBackground","Background color of the peek view result list.")),me=s("peekViewResult.lineForeground",{dark:"#bbbbbb",light:"#646465",hcDark:r.white,hcLight:p},n.localize("peekViewResultsMatchForeground","Foreground color for line nodes in the peek view result list.")),ue=s("peekViewResult.fileForeground",{dark:r.white,light:"#1E1E1E",hcDark:r.white,hcLight:p},n.localize("peekViewResultsFileForeground","Foreground color for file nodes in the peek view result list.")),we=s("peekViewResult.selectionBackground",{dark:"#3399ff33",light:"#3399ff33",hcDark:null,hcLight:null},n.localize("peekViewResultsSelectionBackground","Background color of the selected entry in the peek view result list.")),fe=s("peekViewResult.selectionForeground",{dark:r.white,light:"#6C6C6C",hcDark:r.white,hcLight:p},n.localize("peekViewResultsSelectionForeground","Foreground color of the selected entry in the peek view result list.")),_=s("peekViewEditor.background",{dark:"#001F33",light:"#F2F8FC",hcDark:r.black,hcLight:r.white},n.localize("peekViewEditorBackground","Background color of the peek view editor.")),ye=s("peekViewEditorGutter.background",_,n.localize("peekViewEditorGutterBackground","Background color of the gutter in the peek view editor.")),Ee=s("peekViewEditorStickyScroll.background",_,n.localize("peekViewEditorStickScrollBackground","Background color of sticky scroll in the peek view editor.")),_e=s("peekViewResult.matchHighlightBackground",{dark:"#ea5c004d",light:"#ea5c004d",hcDark:null,hcLight:null},n.localize("peekViewResultsMatchHighlight","Match highlight color in the peek view result list.")),ve=s("peekViewEditor.matchHighlightBackground",{dark:"#ff8f0099",light:"#f5d802de",hcDark:null,hcLight:null},n.localize("peekViewEditorMatchHighlight","Match highlight color in the peek view editor.")),be=s("peekViewEditor.matchHighlightBorder",{dark:null,light:null,hcDark:u,hcLight:u},n.localize("peekViewEditorMatchHighlightBorder","Match highlight border in the peek view editor."));export{j as IPeekViewService,E as PeekContext,g as PeekViewWidget,ae as getOuterEditor,ge as peekViewBorder,_ as peekViewEditorBackground,ye as peekViewEditorGutterBackground,ve as peekViewEditorMatchHighlight,be as peekViewEditorMatchHighlightBorder,Ee as peekViewEditorStickyScrollBackground,ke as peekViewResultsBackground,ue as peekViewResultsFileForeground,me as peekViewResultsMatchForeground,_e as peekViewResultsMatchHighlight,we as peekViewResultsSelectionBackground,fe as peekViewResultsSelectionForeground,ce as peekViewTitleBackground,he as peekViewTitleForeground,pe as peekViewTitleInfoForeground};
