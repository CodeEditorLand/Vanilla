{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/editor/contrib/inlayHints/browser/inlayHintsHover.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { isNonEmptyArray } from \"../../../../base/common/arrays.js\";\nimport { AsyncIterableObject } from \"../../../../base/common/async.js\";\nimport type { CancellationToken } from \"../../../../base/common/cancellation.js\";\nimport {\n\ttype IMarkdownString,\n\tMarkdownString,\n\tisEmptyMarkdownString,\n} from \"../../../../base/common/htmlContent.js\";\nimport * as platform from \"../../../../base/common/platform.js\";\nimport { localize } from \"../../../../nls.js\";\nimport { ICommandService } from \"../../../../platform/commands/common/commands.js\";\nimport { IConfigurationService } from \"../../../../platform/configuration/common/configuration.js\";\nimport { IHoverService } from \"../../../../platform/hover/browser/hover.js\";\nimport { IKeybindingService } from \"../../../../platform/keybinding/common/keybinding.js\";\nimport { IOpenerService } from \"../../../../platform/opener/common/opener.js\";\nimport {\n\ttype ICodeEditor,\n\ttype IEditorMouseEvent,\n\tMouseTargetType,\n} from \"../../../browser/editorBrowser.js\";\nimport { EditorOption } from \"../../../common/config/editorOptions.js\";\nimport { Position } from \"../../../common/core/position.js\";\nimport { ILanguageService } from \"../../../common/languages/language.js\";\nimport type { IModelDecoration } from \"../../../common/model.js\";\nimport { ModelDecorationInjectedTextOptions } from \"../../../common/model/textModel.js\";\nimport { ILanguageFeaturesService } from \"../../../common/services/languageFeatures.js\";\nimport { ITextModelService } from \"../../../common/services/resolverService.js\";\nimport { getHoverProviderResultsAsAsyncIterable } from \"../../hover/browser/getHover.js\";\nimport {\n\ttype HoverAnchor,\n\tHoverForeignElementAnchor,\n\ttype IEditorHoverParticipant,\n} from \"../../hover/browser/hoverTypes.js\";\nimport {\n\tMarkdownHover,\n\tMarkdownHoverParticipant,\n} from \"../../hover/browser/markdownHoverParticipant.js\";\nimport { asCommandLink } from \"./inlayHints.js\";\nimport {\n\tInlayHintsController,\n\tRenderedInlayHintLabelPart,\n} from \"./inlayHintsController.js\";\n\nclass InlayHintsHoverAnchor extends HoverForeignElementAnchor {\n\tconstructor(\n\t\treadonly part: RenderedInlayHintLabelPart,\n\t\towner: InlayHintsHover,\n\t\tinitialMousePosX: number | undefined,\n\t\tinitialMousePosY: number | undefined,\n\t) {\n\t\tsuper(\n\t\t\t10,\n\t\t\towner,\n\t\t\tpart.item.anchor.range,\n\t\t\tinitialMousePosX,\n\t\t\tinitialMousePosY,\n\t\t\ttrue,\n\t\t);\n\t}\n}\n\nexport class InlayHintsHover\n\textends MarkdownHoverParticipant\n\timplements IEditorHoverParticipant<MarkdownHover>\n{\n\tpublic override readonly hoverOrdinal: number = 6;\n\n\tconstructor(\n\t\teditor: ICodeEditor,\n\t\t@ILanguageService languageService: ILanguageService,\n\t\t@IOpenerService openerService: IOpenerService,\n\t\t@IKeybindingService keybindingService: IKeybindingService,\n\t\t@IHoverService hoverService: IHoverService,\n\t\t@IConfigurationService configurationService: IConfigurationService,\n\t\t@ITextModelService private readonly _resolverService: ITextModelService,\n\t\t@ILanguageFeaturesService languageFeaturesService: ILanguageFeaturesService,\n\t\t@ICommandService commandService: ICommandService\n\t) {\n\t\tsuper(editor, languageService, openerService, configurationService, languageFeaturesService, keybindingService, hoverService, commandService);\n\t}\n\n\tsuggestHoverAnchor(mouseEvent: IEditorMouseEvent): HoverAnchor | null {\n\t\tconst controller = InlayHintsController.get(this._editor);\n\t\tif (!controller) {\n\t\t\treturn null;\n\t\t}\n\t\tif (mouseEvent.target.type !== MouseTargetType.CONTENT_TEXT) {\n\t\t\treturn null;\n\t\t}\n\t\tconst options = mouseEvent.target.detail.injectedText?.options;\n\t\tif (\n\t\t\t!(\n\t\t\t\toptions instanceof ModelDecorationInjectedTextOptions &&\n\t\t\t\toptions.attachedData instanceof RenderedInlayHintLabelPart\n\t\t\t)\n\t\t) {\n\t\t\treturn null;\n\t\t}\n\t\treturn new InlayHintsHoverAnchor(\n\t\t\toptions.attachedData,\n\t\t\tthis,\n\t\t\tmouseEvent.event.posx,\n\t\t\tmouseEvent.event.posy,\n\t\t);\n\t}\n\n\toverride computeSync(): MarkdownHover[] {\n\t\treturn [];\n\t}\n\n\toverride computeAsync(\n\t\tanchor: HoverAnchor,\n\t\t_lineDecorations: IModelDecoration[],\n\t\ttoken: CancellationToken,\n\t): AsyncIterableObject<MarkdownHover> {\n\t\tif (!(anchor instanceof InlayHintsHoverAnchor)) {\n\t\t\treturn AsyncIterableObject.EMPTY;\n\t\t}\n\n\t\treturn new AsyncIterableObject<MarkdownHover>(async (executor) => {\n\t\t\tconst { part } = anchor;\n\t\t\tawait part.item.resolve(token);\n\n\t\t\tif (token.isCancellationRequested) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// (1) Inlay Tooltip\n\t\t\tlet itemTooltip: IMarkdownString | undefined;\n\t\t\tif (typeof part.item.hint.tooltip === \"string\") {\n\t\t\t\titemTooltip = new MarkdownString().appendText(\n\t\t\t\t\tpart.item.hint.tooltip,\n\t\t\t\t);\n\t\t\t} else if (part.item.hint.tooltip) {\n\t\t\t\titemTooltip = part.item.hint.tooltip;\n\t\t\t}\n\t\t\tif (itemTooltip) {\n\t\t\t\texecutor.emitOne(\n\t\t\t\t\tnew MarkdownHover(\n\t\t\t\t\t\tthis,\n\t\t\t\t\t\tanchor.range,\n\t\t\t\t\t\t[itemTooltip],\n\t\t\t\t\t\tfalse,\n\t\t\t\t\t\t0,\n\t\t\t\t\t),\n\t\t\t\t);\n\t\t\t}\n\t\t\t// (1.2) Inlay dbl-click gesture\n\t\t\tif (isNonEmptyArray(part.item.hint.textEdits)) {\n\t\t\t\texecutor.emitOne(\n\t\t\t\t\tnew MarkdownHover(\n\t\t\t\t\t\tthis,\n\t\t\t\t\t\tanchor.range,\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tnew MarkdownString().appendText(\n\t\t\t\t\t\t\t\tlocalize(\"hint.dbl\", \"Double-click to insert\"),\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t],\n\t\t\t\t\t\tfalse,\n\t\t\t\t\t\t10001,\n\t\t\t\t\t),\n\t\t\t\t);\n\t\t\t}\n\n\t\t\t// (2) Inlay Label Part Tooltip\n\t\t\tlet partTooltip: IMarkdownString | undefined;\n\t\t\tif (typeof part.part.tooltip === \"string\") {\n\t\t\t\tpartTooltip = new MarkdownString().appendText(\n\t\t\t\t\tpart.part.tooltip,\n\t\t\t\t);\n\t\t\t} else if (part.part.tooltip) {\n\t\t\t\tpartTooltip = part.part.tooltip;\n\t\t\t}\n\t\t\tif (partTooltip) {\n\t\t\t\texecutor.emitOne(\n\t\t\t\t\tnew MarkdownHover(\n\t\t\t\t\t\tthis,\n\t\t\t\t\t\tanchor.range,\n\t\t\t\t\t\t[partTooltip],\n\t\t\t\t\t\tfalse,\n\t\t\t\t\t\t1,\n\t\t\t\t\t),\n\t\t\t\t);\n\t\t\t}\n\n\t\t\t// (2.2) Inlay Label Part Help Hover\n\t\t\tif (part.part.location || part.part.command) {\n\t\t\t\tlet linkHint: MarkdownString | undefined;\n\t\t\t\tconst useMetaKey =\n\t\t\t\t\tthis._editor.getOption(EditorOption.multiCursorModifier) ===\n\t\t\t\t\t\"altKey\";\n\t\t\t\tconst kb = useMetaKey\n\t\t\t\t\t? platform.isMacintosh\n\t\t\t\t\t\t? localize(\"links.navigate.kb.meta.mac\", \"cmd + click\")\n\t\t\t\t\t\t: localize(\"links.navigate.kb.meta\", \"ctrl + click\")\n\t\t\t\t\t: platform.isMacintosh\n\t\t\t\t\t\t? localize(\n\t\t\t\t\t\t\t\t\"links.navigate.kb.alt.mac\",\n\t\t\t\t\t\t\t\t\"option + click\",\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t: localize(\"links.navigate.kb.alt\", \"alt + click\");\n\n\t\t\t\tif (part.part.location && part.part.command) {\n\t\t\t\t\tlinkHint = new MarkdownString().appendText(\n\t\t\t\t\t\tlocalize(\n\t\t\t\t\t\t\t\"hint.defAndCommand\",\n\t\t\t\t\t\t\t\"Go to Definition ({0}), right click for more\",\n\t\t\t\t\t\t\tkb,\n\t\t\t\t\t\t),\n\t\t\t\t\t);\n\t\t\t\t} else if (part.part.location) {\n\t\t\t\t\tlinkHint = new MarkdownString().appendText(\n\t\t\t\t\t\tlocalize(\"hint.def\", \"Go to Definition ({0})\", kb),\n\t\t\t\t\t);\n\t\t\t\t} else if (part.part.command) {\n\t\t\t\t\tlinkHint = new MarkdownString(\n\t\t\t\t\t\t`[${localize(\"hint.cmd\", \"Execute Command\")}](${asCommandLink(part.part.command)} \"${part.part.command.title}\") (${kb})`,\n\t\t\t\t\t\t{ isTrusted: true },\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tif (linkHint) {\n\t\t\t\t\texecutor.emitOne(\n\t\t\t\t\t\tnew MarkdownHover(\n\t\t\t\t\t\t\tthis,\n\t\t\t\t\t\t\tanchor.range,\n\t\t\t\t\t\t\t[linkHint],\n\t\t\t\t\t\t\tfalse,\n\t\t\t\t\t\t\t10000,\n\t\t\t\t\t\t),\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// (3) Inlay Label Part Location tooltip\n\t\t\tconst iterable = await this._resolveInlayHintLabelPartHover(\n\t\t\t\tpart,\n\t\t\t\ttoken,\n\t\t\t);\n\t\t\tfor await (const item of iterable) {\n\t\t\t\texecutor.emitOne(item);\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate async _resolveInlayHintLabelPartHover(\n\t\tpart: RenderedInlayHintLabelPart,\n\t\ttoken: CancellationToken,\n\t): Promise<AsyncIterableObject<MarkdownHover>> {\n\t\tif (!part.part.location) {\n\t\t\treturn AsyncIterableObject.EMPTY;\n\t\t}\n\t\tconst { uri, range } = part.part.location;\n\t\tconst ref = await this._resolverService.createModelReference(uri);\n\t\ttry {\n\t\t\tconst model = ref.object.textEditorModel;\n\t\t\tif (!this._languageFeaturesService.hoverProvider.has(model)) {\n\t\t\t\treturn AsyncIterableObject.EMPTY;\n\t\t\t}\n\t\t\treturn getHoverProviderResultsAsAsyncIterable(\n\t\t\t\tthis._languageFeaturesService.hoverProvider,\n\t\t\t\tmodel,\n\t\t\t\tnew Position(range.startLineNumber, range.startColumn),\n\t\t\t\ttoken,\n\t\t\t)\n\t\t\t\t.filter((item) => !isEmptyMarkdownString(item.hover.contents))\n\t\t\t\t.map(\n\t\t\t\t\t(item) =>\n\t\t\t\t\t\tnew MarkdownHover(\n\t\t\t\t\t\t\tthis,\n\t\t\t\t\t\t\tpart.item.anchor.range,\n\t\t\t\t\t\t\titem.hover.contents,\n\t\t\t\t\t\t\tfalse,\n\t\t\t\t\t\t\t2 + item.ordinal,\n\t\t\t\t\t\t),\n\t\t\t\t);\n\t\t} finally {\n\t\t\tref.dispose();\n\t\t}\n\t}\n}\n"],
  "mappings": "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",
  "names": []
}
