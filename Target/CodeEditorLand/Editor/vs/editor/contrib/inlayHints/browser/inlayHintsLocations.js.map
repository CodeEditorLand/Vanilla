{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/editor/contrib/inlayHints/browser/inlayHintsLocations.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as dom from \"../../../../base/browser/dom.js\";\nimport {\n\tAction,\n\ttype IAction,\n\tSeparator,\n} from \"../../../../base/common/actions.js\";\nimport { CancellationToken } from \"../../../../base/common/cancellation.js\";\nimport { generateUuid } from \"../../../../base/common/uuid.js\";\nimport {\n\tMenuId,\n\tMenuItemAction,\n\tMenuRegistry,\n\tisIMenuItem,\n} from \"../../../../platform/actions/common/actions.js\";\nimport { ICommandService } from \"../../../../platform/commands/common/commands.js\";\nimport { IContextKeyService } from \"../../../../platform/contextkey/common/contextkey.js\";\nimport { IContextMenuService } from \"../../../../platform/contextview/browser/contextView.js\";\nimport {\n\tIInstantiationService,\n\ttype ServicesAccessor,\n} from \"../../../../platform/instantiation/common/instantiation.js\";\nimport {\n\tINotificationService,\n\tSeverity,\n} from \"../../../../platform/notification/common/notification.js\";\nimport type {\n\tIActiveCodeEditor,\n\tICodeEditor,\n} from \"../../../browser/editorBrowser.js\";\nimport { EditorOption } from \"../../../common/config/editorOptions.js\";\nimport { Range } from \"../../../common/core/range.js\";\nimport type { Location } from \"../../../common/languages.js\";\nimport { ITextModelService } from \"../../../common/services/resolverService.js\";\nimport {\n\tDefinitionAction,\n\tSymbolNavigationAction,\n\tSymbolNavigationAnchor,\n} from \"../../gotoSymbol/browser/goToCommands.js\";\nimport type { ClickLinkMouseEvent } from \"../../gotoSymbol/browser/link/clickLinkGesture.js\";\nimport { PeekContext } from \"../../peekView/browser/peekView.js\";\nimport type { RenderedInlayHintLabelPart } from \"./inlayHintsController.js\";\n\nexport async function showGoToContextMenu(\n\taccessor: ServicesAccessor,\n\teditor: ICodeEditor,\n\tanchor: HTMLElement,\n\tpart: RenderedInlayHintLabelPart,\n) {\n\tconst resolverService = accessor.get(ITextModelService);\n\tconst contextMenuService = accessor.get(IContextMenuService);\n\tconst commandService = accessor.get(ICommandService);\n\tconst instaService = accessor.get(IInstantiationService);\n\tconst notificationService = accessor.get(INotificationService);\n\n\tawait part.item.resolve(CancellationToken.None);\n\n\tif (!part.part.location) {\n\t\treturn;\n\t}\n\n\tconst location: Location = part.part.location;\n\tconst menuActions: IAction[] = [];\n\n\t// from all registered (not active) context menu actions select those\n\t// that are a symbol navigation actions\n\tconst filter = new Set(\n\t\tMenuRegistry.getMenuItems(MenuId.EditorContext).map((item) =>\n\t\t\tisIMenuItem(item) ? item.command.id : generateUuid(),\n\t\t),\n\t);\n\n\tfor (const delegate of SymbolNavigationAction.all()) {\n\t\tif (filter.has(delegate.desc.id)) {\n\t\t\tmenuActions.push(\n\t\t\t\tnew Action(\n\t\t\t\t\tdelegate.desc.id,\n\t\t\t\t\tMenuItemAction.label(delegate.desc, {\n\t\t\t\t\t\trenderShortTitle: true,\n\t\t\t\t\t}),\n\t\t\t\t\tundefined,\n\t\t\t\t\ttrue,\n\t\t\t\t\tasync () => {\n\t\t\t\t\t\tconst ref = await resolverService.createModelReference(\n\t\t\t\t\t\t\tlocation.uri,\n\t\t\t\t\t\t);\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tconst symbolAnchor = new SymbolNavigationAnchor(\n\t\t\t\t\t\t\t\tref.object.textEditorModel,\n\t\t\t\t\t\t\t\tRange.getStartPosition(location.range),\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tconst range = part.item.anchor.range;\n\t\t\t\t\t\t\tawait instaService.invokeFunction(\n\t\t\t\t\t\t\t\tdelegate.runEditorCommand.bind(delegate),\n\t\t\t\t\t\t\t\teditor,\n\t\t\t\t\t\t\t\tsymbolAnchor,\n\t\t\t\t\t\t\t\trange,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t} finally {\n\t\t\t\t\t\t\tref.dispose();\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t),\n\t\t\t);\n\t\t}\n\t}\n\n\tif (part.part.command) {\n\t\tconst { command } = part.part;\n\t\tmenuActions.push(new Separator());\n\t\tmenuActions.push(\n\t\t\tnew Action(command.id, command.title, undefined, true, async () => {\n\t\t\t\ttry {\n\t\t\t\t\tawait commandService.executeCommand(\n\t\t\t\t\t\tcommand.id,\n\t\t\t\t\t\t...(command.arguments ?? []),\n\t\t\t\t\t);\n\t\t\t\t} catch (err) {\n\t\t\t\t\tnotificationService.notify({\n\t\t\t\t\t\tseverity: Severity.Error,\n\t\t\t\t\t\tsource: part.item.provider.displayName,\n\t\t\t\t\t\tmessage: err,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}),\n\t\t);\n\t}\n\n\t// show context menu\n\tconst useShadowDOM = editor.getOption(EditorOption.useShadowDOM);\n\tcontextMenuService.showContextMenu({\n\t\tdomForShadowRoot: useShadowDOM\n\t\t\t? (editor.getDomNode() ?? undefined)\n\t\t\t: undefined,\n\t\tgetAnchor: () => {\n\t\t\tconst box = dom.getDomNodePagePosition(anchor);\n\t\t\treturn { x: box.left, y: box.top + box.height + 8 };\n\t\t},\n\t\tgetActions: () => menuActions,\n\t\tonHide: () => {\n\t\t\teditor.focus();\n\t\t},\n\t\tautoSelectFirstItem: true,\n\t});\n}\n\nexport async function goToDefinitionWithLocation(\n\taccessor: ServicesAccessor,\n\tevent: ClickLinkMouseEvent,\n\teditor: IActiveCodeEditor,\n\tlocation: Location,\n) {\n\tconst resolverService = accessor.get(ITextModelService);\n\tconst ref = await resolverService.createModelReference(location.uri);\n\n\tawait editor.invokeWithinContext(async (accessor) => {\n\t\tconst openToSide = event.hasSideBySideModifier;\n\t\tconst contextKeyService = accessor.get(IContextKeyService);\n\n\t\tconst isInPeek = PeekContext.inPeekEditor.getValue(contextKeyService);\n\t\tconst canPeek =\n\t\t\t!openToSide &&\n\t\t\teditor.getOption(EditorOption.definitionLinkOpensInPeek) &&\n\t\t\t!isInPeek;\n\n\t\tconst action = new DefinitionAction(\n\t\t\t{ openToSide, openInPeek: canPeek, muteMessage: true },\n\t\t\t{\n\t\t\t\ttitle: { value: \"\", original: \"\" },\n\t\t\t\tid: \"\",\n\t\t\t\tprecondition: undefined,\n\t\t\t},\n\t\t);\n\t\treturn action.run(\n\t\t\taccessor,\n\t\t\tnew SymbolNavigationAnchor(\n\t\t\t\tref.object.textEditorModel,\n\t\t\t\tRange.getStartPosition(location.range),\n\t\t\t),\n\t\t\tRange.lift(location.range),\n\t\t);\n\t});\n\n\tref.dispose();\n}\n"],
  "mappings": "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",
  "names": ["accessor"]
}
