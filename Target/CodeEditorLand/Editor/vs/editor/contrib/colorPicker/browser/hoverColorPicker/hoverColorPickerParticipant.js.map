{
  "version": 3,
  "sources": ["../../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/editor/contrib/colorPicker/browser/hoverColorPicker/hoverColorPickerParticipant.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { AsyncIterableObject } from \"../../../../../base/common/async.js\";\nimport type { CancellationToken } from \"../../../../../base/common/cancellation.js\";\nimport * as nls from \"../../../../../nls.js\";\nimport { IThemeService } from \"../../../../../platform/theme/common/themeService.js\";\nimport type { ICodeEditor } from \"../../../../browser/editorBrowser.js\";\nimport type { Range } from \"../../../../common/core/range.js\";\nimport type { DocumentColorProvider } from \"../../../../common/languages.js\";\nimport type { IModelDecoration } from \"../../../../common/model.js\";\nimport {\n\ttype HoverAnchor,\n\tHoverAnchorType,\n\ttype IEditorHoverParticipant,\n\ttype IEditorHoverRenderContext,\n\ttype IHoverPart,\n\ttype IRenderedHoverPart,\n\ttype IRenderedHoverParts,\n\tRenderedHoverParts,\n} from \"../../../hover/browser/hoverTypes.js\";\nimport { ColorDetector } from \"../colorDetector.js\";\nimport type { ColorPickerModel } from \"../colorPickerModel.js\";\nimport {\n\tcreateColorHover,\n\trenderHoverParts,\n} from \"../colorPickerParticipantUtils.js\";\nimport type { ColorPickerWidget } from \"./hoverColorPickerWidget.js\";\n\nexport class ColorHover implements IHoverPart {\n\t/**\n\t * Force the hover to always be rendered at this specific range,\n\t * even in the case of multiple hover parts.\n\t */\n\tpublic readonly forceShowAtRange: boolean = true;\n\n\tconstructor(\n\t\tpublic readonly owner: IEditorHoverParticipant<ColorHover>,\n\t\tpublic readonly range: Range,\n\t\tpublic readonly model: ColorPickerModel,\n\t\tpublic readonly provider: DocumentColorProvider,\n\t) {}\n\n\tpublic isValidForHoverAnchor(anchor: HoverAnchor): boolean {\n\t\treturn (\n\t\t\tanchor.type === HoverAnchorType.Range &&\n\t\t\tthis.range.startColumn <= anchor.range.startColumn &&\n\t\t\tthis.range.endColumn >= anchor.range.endColumn\n\t\t);\n\t}\n}\n\nexport class HoverColorPickerParticipant\n\timplements IEditorHoverParticipant<ColorHover>\n{\n\tpublic readonly hoverOrdinal: number = 2;\n\n\tprivate _colorPicker: ColorPickerWidget | undefined;\n\n\tconstructor(\n\t\tprivate readonly _editor: ICodeEditor,\n\t\t@IThemeService private readonly _themeService: IThemeService,\n\t) { }\n\n\tpublic computeSync(\n\t\t_anchor: HoverAnchor,\n\t\t_lineDecorations: IModelDecoration[],\n\t): ColorHover[] {\n\t\treturn [];\n\t}\n\n\tpublic computeAsync(\n\t\tanchor: HoverAnchor,\n\t\tlineDecorations: IModelDecoration[],\n\t\ttoken: CancellationToken,\n\t): AsyncIterableObject<ColorHover> {\n\t\treturn AsyncIterableObject.fromPromise(\n\t\t\tthis._computeAsync(anchor, lineDecorations, token),\n\t\t);\n\t}\n\n\tprivate async _computeAsync(\n\t\t_anchor: HoverAnchor,\n\t\tlineDecorations: IModelDecoration[],\n\t\t_token: CancellationToken,\n\t): Promise<ColorHover[]> {\n\t\tif (!this._editor.hasModel()) {\n\t\t\treturn [];\n\t\t}\n\t\tconst colorDetector = ColorDetector.get(this._editor);\n\t\tif (!colorDetector) {\n\t\t\treturn [];\n\t\t}\n\t\tfor (const d of lineDecorations) {\n\t\t\tif (!colorDetector.isColorDecoration(d)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst colorData = colorDetector.getColorData(\n\t\t\t\td.range.getStartPosition(),\n\t\t\t);\n\t\t\tif (colorData) {\n\t\t\t\tconst colorHover = await createColorHover(\n\t\t\t\t\tthis,\n\t\t\t\t\tthis._editor.getModel(),\n\t\t\t\t\tcolorData.colorInfo,\n\t\t\t\t\tcolorData.provider,\n\t\t\t\t);\n\t\t\t\treturn [colorHover];\n\t\t\t}\n\t\t}\n\t\treturn [];\n\t}\n\n\tpublic renderHoverParts(\n\t\tcontext: IEditorHoverRenderContext,\n\t\thoverParts: ColorHover[],\n\t): IRenderedHoverParts<ColorHover> {\n\t\tconst renderedPart = renderHoverParts(\n\t\t\tthis,\n\t\t\tthis._editor,\n\t\t\tthis._themeService,\n\t\t\thoverParts,\n\t\t\tcontext,\n\t\t);\n\t\tif (!renderedPart) {\n\t\t\treturn new RenderedHoverParts([]);\n\t\t}\n\t\tthis._colorPicker = renderedPart.colorPicker;\n\t\tconst renderedHoverPart: IRenderedHoverPart<ColorHover> = {\n\t\t\thoverPart: renderedPart.hoverPart,\n\t\t\thoverElement: this._colorPicker.domNode,\n\t\t\tdispose() {\n\t\t\t\trenderedPart.disposables.dispose();\n\t\t\t},\n\t\t};\n\t\treturn new RenderedHoverParts([renderedHoverPart]);\n\t}\n\n\tpublic getAccessibleContent(hoverPart: ColorHover): string {\n\t\treturn nls.localize(\n\t\t\t\"hoverAccessibilityColorParticipant\",\n\t\t\t\"There is a color picker here.\",\n\t\t);\n\t}\n\n\tpublic handleResize(): void {\n\t\tthis._colorPicker?.layout();\n\t}\n\n\tpublic isColorPickerVisible(): boolean {\n\t\treturn !!this._colorPicker;\n\t}\n}\n"],
  "mappings": ";;;;;;;;;;;;AAKA,SAAS,2BAA2B;AAEpC,YAAY,SAAS;AACrB,SAAS,qBAAqB;AAK9B;AAAA,EAEC;AAAA,EAMA;AAAA,OACM;AACP,SAAS,qBAAqB;AAE9B;AAAA,EACC;AAAA,EACA;AAAA,OACM;AAGA,MAAM,WAAiC;AAAA,EAO7C,YACiB,OACA,OACA,OACA,UACf;AAJe;AACA;AACA;AACA;AAAA,EACd;AAAA,EA3CJ,OA+B8C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAK7B,mBAA4B;AAAA,EASrC,sBAAsB,QAA8B;AAC1D,WACC,OAAO,SAAS,gBAAgB,SAChC,KAAK,MAAM,eAAe,OAAO,MAAM,eACvC,KAAK,MAAM,aAAa,OAAO,MAAM;AAAA,EAEvC;AACD;AAEO,IAAM,8BAAN,MAEP;AAAA,EAKC,YACkB,SACe,eAC/B;AAFgB;AACe;AAAA,EAC7B;AAAA,EAhEL,OAwDA;AAAA;AAAA;AAAA,EACiB,eAAuB;AAAA,EAE/B;AAAA,EAOD,YACN,SACA,kBACe;AACf,WAAO,CAAC;AAAA,EACT;AAAA,EAEO,aACN,QACA,iBACA,OACkC;AAClC,WAAO,oBAAoB;AAAA,MAC1B,KAAK,cAAc,QAAQ,iBAAiB,KAAK;AAAA,IAClD;AAAA,EACD;AAAA,EAEA,MAAc,cACb,SACA,iBACA,QACwB;AACxB,QAAI,CAAC,KAAK,QAAQ,SAAS,GAAG;AAC7B,aAAO,CAAC;AAAA,IACT;AACA,UAAM,gBAAgB,cAAc,IAAI,KAAK,OAAO;AACpD,QAAI,CAAC,eAAe;AACnB,aAAO,CAAC;AAAA,IACT;AACA,eAAW,KAAK,iBAAiB;AAChC,UAAI,CAAC,cAAc,kBAAkB,CAAC,GAAG;AACxC;AAAA,MACD;AAEA,YAAM,YAAY,cAAc;AAAA,QAC/B,EAAE,MAAM,iBAAiB;AAAA,MAC1B;AACA,UAAI,WAAW;AACd,cAAM,aAAa,MAAM;AAAA,UACxB;AAAA,UACA,KAAK,QAAQ,SAAS;AAAA,UACtB,UAAU;AAAA,UACV,UAAU;AAAA,QACX;AACA,eAAO,CAAC,UAAU;AAAA,MACnB;AAAA,IACD;AACA,WAAO,CAAC;AAAA,EACT;AAAA,EAEO,iBACN,SACA,YACkC;AAClC,UAAM,eAAe;AAAA,MACpB;AAAA,MACA,KAAK;AAAA,MACL,KAAK;AAAA,MACL;AAAA,MACA;AAAA,IACD;AACA,QAAI,CAAC,cAAc;AAClB,aAAO,IAAI,mBAAmB,CAAC,CAAC;AAAA,IACjC;AACA,SAAK,eAAe,aAAa;AACjC,UAAM,oBAAoD;AAAA,MACzD,WAAW,aAAa;AAAA,MACxB,cAAc,KAAK,aAAa;AAAA,MAChC,UAAU;AACT,qBAAa,YAAY,QAAQ;AAAA,MAClC;AAAA,IACD;AACA,WAAO,IAAI,mBAAmB,CAAC,iBAAiB,CAAC;AAAA,EAClD;AAAA,EAEO,qBAAqB,WAA+B;AAC1D,WAAO,IAAI;AAAA,MACV;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA,EAEO,eAAqB;AAC3B,SAAK,cAAc,OAAO;AAAA,EAC3B;AAAA,EAEO,uBAAgC;AACtC,WAAO,CAAC,CAAC,KAAK;AAAA,EACf;AACD;AArGa,8BAAN;AAAA,EASJ;AAAA,GATU;",
  "names": []
}
