var m=Object.defineProperty;var v=Object.getOwnPropertyDescriptor;var a=(n,o,e,r)=>{for(var t=r>1?void 0:r?v(o,e):o,l=n.length-1,i;l>=0;l--)(i=n[l])&&(t=(r?i(o,e,t):i(t))||t);return r&&t&&m(o,e,t),t},d=(n,o)=>(e,r)=>o(e,r,n);import{AsyncIterableObject as p}from"../../../../../base/common/async.js";import"../../../../../base/common/cancellation.js";import*as u from"../../../../../nls.js";import{IThemeService as h}from"../../../../../platform/theme/common/themeService.js";import"../../../../browser/editorBrowser.js";import"../../../../common/core/range.js";import"../../../../common/languages.js";import"../../../../common/model.js";import{HoverAnchorType as H,RenderedHoverParts as s}from"../../../hover/browser/hoverTypes.js";import{ColorDetector as C}from"../colorDetector.js";import"../colorPickerModel.js";import{createColorHover as P,renderHoverParts as b}from"../colorPickerParticipantUtils.js";import"./hoverColorPickerWidget.js";class L{constructor(o,e,r,t){this.owner=o;this.range=e;this.model=r;this.provider=t}forceShowAtRange=!0;isValidForHoverAnchor(o){return o.type===H.Range&&this.range.startColumn<=o.range.startColumn&&this.range.endColumn>=o.range.endColumn}}let c=class{constructor(o,e){this._editor=o;this._themeService=e}hoverOrdinal=2;_colorPicker;computeSync(o,e){return[]}computeAsync(o,e,r){return p.fromPromise(this._computeAsync(o,e,r))}async _computeAsync(o,e,r){if(!this._editor.hasModel())return[];const t=C.get(this._editor);if(!t)return[];for(const l of e){if(!t.isColorDecoration(l))continue;const i=t.getColorData(l.range.getStartPosition());if(i)return[await P(this,this._editor.getModel(),i.colorInfo,i.provider)]}return[]}renderHoverParts(o,e){const r=b(this,this._editor,this._themeService,e,o);if(!r)return new s([]);this._colorPicker=r.colorPicker;const t={hoverPart:r.hoverPart,hoverElement:this._colorPicker.domNode,dispose(){r.disposables.dispose()}};return new s([t])}getAccessibleContent(o){return u.localize("hoverAccessibilityColorParticipant","There is a color picker here.")}handleResize(){this._colorPicker?.layout()}isColorPickerVisible(){return!!this._colorPicker}};c=a([d(1,h)],c);export{L as ColorHover,c as HoverColorPickerParticipant};
