var m=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var a=(n,o,r,e)=>{for(var t=e>1?void 0:e?p(o,r):o,c=n.length-1,i;c>=0;c--)(i=n[c])&&(t=(e?i(o,r,t):i(t))||t);return e&&t&&m(o,r,t),t},s=(n,o)=>(r,e)=>o(r,e,n);import{AsyncIterableObject as v}from"../../../../../base/common/async.js";import*as u from"../../../../../nls.js";import{IThemeService as h}from"../../../../../platform/theme/common/themeService.js";import{HoverAnchorType as y,RenderedHoverParts as d}from"../../../hover/browser/hoverTypes.js";import{ColorDetector as C}from"../colorDetector.js";import{createColorHover as H,renderHoverParts as P}from"../colorPickerParticipantUtils.js";class D{constructor(o,r,e,t){this.owner=o;this.range=r;this.model=e;this.provider=t}forceShowAtRange=!0;isValidForHoverAnchor(o){return o.type===y.Range&&this.range.startColumn<=o.range.startColumn&&this.range.endColumn>=o.range.endColumn}}let l=class{constructor(o,r){this._editor=o;this._themeService=r}hoverOrdinal=2;_colorPicker;computeSync(o,r){return[]}computeAsync(o,r,e){return v.fromPromise(this._computeAsync(o,r,e))}async _computeAsync(o,r,e){if(!this._editor.hasModel())return[];const t=C.get(this._editor);if(!t)return[];for(const c of r){if(!t.isColorDecoration(c))continue;const i=t.getColorData(c.range.getStartPosition());if(i)return[await H(this,this._editor.getModel(),i.colorInfo,i.provider)]}return[]}renderHoverParts(o,r){const e=P(this,this._editor,this._themeService,r,o);if(!e)return new d([]);this._colorPicker=e.colorPicker;const t={hoverPart:e.hoverPart,hoverElement:this._colorPicker.domNode,dispose(){e.disposables.dispose()}};return new d([t])}getAccessibleContent(o){return u.localize("hoverAccessibilityColorParticipant","There is a color picker here.")}handleResize(){this._colorPicker?.layout()}isColorPickerVisible(){return!!this._colorPicker}};l=a([s(1,h)],l);export{D as ColorHover,l as HoverColorPickerParticipant};
