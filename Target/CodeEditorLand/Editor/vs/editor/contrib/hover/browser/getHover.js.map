{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/editor/contrib/hover/browser/getHover.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { AsyncIterableObject } from \"../../../../base/common/async.js\";\nimport { CancellationToken } from \"../../../../base/common/cancellation.js\";\nimport { onUnexpectedExternalError } from \"../../../../base/common/errors.js\";\nimport { registerModelAndPositionCommand } from \"../../../browser/editorExtensions.js\";\nimport type { Position } from \"../../../common/core/position.js\";\nimport type { LanguageFeatureRegistry } from \"../../../common/languageFeatureRegistry.js\";\nimport type { Hover, HoverProvider } from \"../../../common/languages.js\";\nimport type { ITextModel } from \"../../../common/model.js\";\nimport { ILanguageFeaturesService } from \"../../../common/services/languageFeatures.js\";\n\nexport class HoverProviderResult {\n\tconstructor(\n\t\tpublic readonly provider: HoverProvider,\n\t\tpublic readonly hover: Hover,\n\t\tpublic readonly ordinal: number,\n\t) {}\n}\n\n/**\n * Does not throw or return a rejected promise (returns undefined instead).\n */\nasync function executeProvider(\n\tprovider: HoverProvider,\n\tordinal: number,\n\tmodel: ITextModel,\n\tposition: Position,\n\ttoken: CancellationToken,\n): Promise<HoverProviderResult | undefined> {\n\tconst result = await Promise.resolve(\n\t\tprovider.provideHover(model, position, token),\n\t).catch(onUnexpectedExternalError);\n\tif (!result || !isValid(result)) {\n\t\treturn undefined;\n\t}\n\treturn new HoverProviderResult(provider, result, ordinal);\n}\n\nexport function getHoverProviderResultsAsAsyncIterable(\n\tregistry: LanguageFeatureRegistry<HoverProvider>,\n\tmodel: ITextModel,\n\tposition: Position,\n\ttoken: CancellationToken,\n\trecursive = false,\n): AsyncIterableObject<HoverProviderResult> {\n\tconst providers = registry.ordered(model, recursive);\n\tconst promises = providers.map((provider, index) =>\n\t\texecuteProvider(provider, index, model, position, token),\n\t);\n\treturn AsyncIterableObject.fromPromises(promises).coalesce();\n}\n\nexport function getHoversPromise(\n\tregistry: LanguageFeatureRegistry<HoverProvider>,\n\tmodel: ITextModel,\n\tposition: Position,\n\ttoken: CancellationToken,\n\trecursive = false,\n): Promise<Hover[]> {\n\treturn getHoverProviderResultsAsAsyncIterable(\n\t\tregistry,\n\t\tmodel,\n\t\tposition,\n\t\ttoken,\n\t\trecursive,\n\t)\n\t\t.map((item) => item.hover)\n\t\t.toPromise();\n}\n\nregisterModelAndPositionCommand(\n\t\"_executeHoverProvider\",\n\t(accessor, model, position): Promise<Hover[]> => {\n\t\tconst languageFeaturesService = accessor.get(ILanguageFeaturesService);\n\t\treturn getHoversPromise(\n\t\t\tlanguageFeaturesService.hoverProvider,\n\t\t\tmodel,\n\t\t\tposition,\n\t\t\tCancellationToken.None,\n\t\t);\n\t},\n);\n\nregisterModelAndPositionCommand(\n\t\"_executeHoverProvider_recursive\",\n\t(accessor, model, position): Promise<Hover[]> => {\n\t\tconst languageFeaturesService = accessor.get(ILanguageFeaturesService);\n\t\treturn getHoversPromise(\n\t\t\tlanguageFeaturesService.hoverProvider,\n\t\t\tmodel,\n\t\t\tposition,\n\t\t\tCancellationToken.None,\n\t\t\ttrue,\n\t\t);\n\t},\n);\n\nfunction isValid(result: Hover) {\n\tconst hasRange = typeof result.range !== \"undefined\";\n\tconst hasHtmlContent =\n\t\ttypeof result.contents !== \"undefined\" &&\n\t\tresult.contents &&\n\t\tresult.contents.length > 0;\n\treturn hasRange && hasHtmlContent;\n}\n"],
  "mappings": ";;AAKA,SAAS,2BAA2B;AACpC,SAAS,yBAAyB;AAClC,SAAS,iCAAiC;AAC1C,SAAS,uCAAuC;AAKhD,SAAS,gCAAgC;AAElC,MAAM,oBAAoB;AAAA,EAChC,YACiB,UACA,OACA,SACf;AAHe;AACA;AACA;AAAA,EACd;AAAA,EApBJ,OAeiC;AAAA;AAAA;AAMjC;AAKA,eAAe,gBACd,UACA,SACA,OACA,UACA,OAC2C;AAC3C,QAAM,SAAS,MAAM,QAAQ;AAAA,IAC5B,SAAS,aAAa,OAAO,UAAU,KAAK;AAAA,EAC7C,EAAE,MAAM,yBAAyB;AACjC,MAAI,CAAC,UAAU,CAAC,QAAQ,MAAM,GAAG;AAChC,WAAO;AAAA,EACR;AACA,SAAO,IAAI,oBAAoB,UAAU,QAAQ,OAAO;AACzD;AAde;AAgBR,SAAS,uCACf,UACA,OACA,UACA,OACA,YAAY,OAC+B;AAC3C,QAAM,YAAY,SAAS,QAAQ,OAAO,SAAS;AACnD,QAAM,WAAW,UAAU;AAAA,IAAI,CAAC,UAAU,UACzC,gBAAgB,UAAU,OAAO,OAAO,UAAU,KAAK;AAAA,EACxD;AACA,SAAO,oBAAoB,aAAa,QAAQ,EAAE,SAAS;AAC5D;AAZgB;AAcT,SAAS,iBACf,UACA,OACA,UACA,OACA,YAAY,OACO;AACnB,SAAO;AAAA,IACN;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EACD,EACE,IAAI,CAAC,SAAS,KAAK,KAAK,EACxB,UAAU;AACb;AAhBgB;AAkBhB;AAAA,EACC;AAAA,EACA,CAAC,UAAU,OAAO,aAA+B;AAChD,UAAM,0BAA0B,SAAS,IAAI,wBAAwB;AACrE,WAAO;AAAA,MACN,wBAAwB;AAAA,MACxB;AAAA,MACA;AAAA,MACA,kBAAkB;AAAA,IACnB;AAAA,EACD;AACD;AAEA;AAAA,EACC;AAAA,EACA,CAAC,UAAU,OAAO,aAA+B;AAChD,UAAM,0BAA0B,SAAS,IAAI,wBAAwB;AACrE,WAAO;AAAA,MACN,wBAAwB;AAAA,MACxB;AAAA,MACA;AAAA,MACA,kBAAkB;AAAA,MAClB;AAAA,IACD;AAAA,EACD;AACD;AAEA,SAAS,QAAQ,QAAe;AAC/B,QAAM,WAAW,OAAO,OAAO,UAAU;AACzC,QAAM,iBACL,OAAO,OAAO,aAAa,eAC3B,OAAO,YACP,OAAO,SAAS,SAAS;AAC1B,SAAO,YAAY;AACpB;AAPS;",
  "names": []
}
