{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/editor/contrib/hover/browser/getHover.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { AsyncIterableObject } from '../../../../base/common/async.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { registerModelAndPositionCommand } from '../../../browser/editorExtensions.js';\nimport { Position } from '../../../common/core/position.js';\nimport { ITextModel } from '../../../common/model.js';\nimport { Hover, HoverProvider } from '../../../common/languages.js';\nimport { LanguageFeatureRegistry } from '../../../common/languageFeatureRegistry.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\n\nexport class HoverProviderResult {\n\tconstructor(\n\t\tpublic readonly provider: HoverProvider,\n\t\tpublic readonly hover: Hover,\n\t\tpublic readonly ordinal: number\n\t) { }\n}\n\n/**\n * Does not throw or return a rejected promise (returns undefined instead).\n */\nasync function executeProvider(provider: HoverProvider, ordinal: number, model: ITextModel, position: Position, token: CancellationToken): Promise<HoverProviderResult | undefined> {\n\tconst result = await Promise\n\t\t.resolve(provider.provideHover(model, position, token))\n\t\t.catch(onUnexpectedExternalError);\n\tif (!result || !isValid(result)) {\n\t\treturn undefined;\n\t}\n\treturn new HoverProviderResult(provider, result, ordinal);\n}\n\nexport function getHoverProviderResultsAsAsyncIterable(registry: LanguageFeatureRegistry<HoverProvider>, model: ITextModel, position: Position, token: CancellationToken, recursive = false): AsyncIterableObject<HoverProviderResult> {\n\tconst providers = registry.ordered(model, recursive);\n\tconst promises = providers.map((provider, index) => executeProvider(provider, index, model, position, token));\n\treturn AsyncIterableObject.fromPromises(promises).coalesce();\n}\n\nexport function getHoversPromise(registry: LanguageFeatureRegistry<HoverProvider>, model: ITextModel, position: Position, token: CancellationToken, recursive = false): Promise<Hover[]> {\n\treturn getHoverProviderResultsAsAsyncIterable(registry, model, position, token, recursive).map(item => item.hover).toPromise();\n}\n\nregisterModelAndPositionCommand('_executeHoverProvider', (accessor, model, position): Promise<Hover[]> => {\n\tconst languageFeaturesService = accessor.get(ILanguageFeaturesService);\n\treturn getHoversPromise(languageFeaturesService.hoverProvider, model, position, CancellationToken.None);\n});\n\nregisterModelAndPositionCommand('_executeHoverProvider_recursive', (accessor, model, position): Promise<Hover[]> => {\n\tconst languageFeaturesService = accessor.get(ILanguageFeaturesService);\n\treturn getHoversPromise(languageFeaturesService.hoverProvider, model, position, CancellationToken.None, true);\n});\n\nfunction isValid(result: Hover) {\n\tconst hasRange = (typeof result.range !== 'undefined');\n\tconst hasHtmlContent = typeof result.contents !== 'undefined' && result.contents && result.contents.length > 0;\n\treturn hasRange && hasHtmlContent;\n}\n"],
  "mappings": ";;AAKA,SAAS,2BAA2B;AACpC,SAAS,yBAAyB;AAClC,SAAS,iCAAiC;AAC1C,SAAS,uCAAuC;AAChD,SAAS,gBAAgB;AACzB,SAAS,kBAAkB;AAC3B,SAAS,OAAO,qBAAqB;AACrC,SAAS,+BAA+B;AACxC,SAAS,gCAAgC;AAElC,MAAM,oBAAoB;AAAA,EAChC,YACiB,UACA,OACA,SACf;AAHe;AACA;AACA;AAAA,EACb;AAAA,EApBL,OAeiC;AAAA;AAAA;AAMjC;AAKA,eAAe,gBAAgB,UAAyB,SAAiB,OAAmB,UAAoB,OAAoE;AACnL,QAAM,SAAS,MAAM,QACnB,QAAQ,SAAS,aAAa,OAAO,UAAU,KAAK,CAAC,EACrD,MAAM,yBAAyB;AACjC,MAAI,CAAC,UAAU,CAAC,QAAQ,MAAM,GAAG;AAChC,WAAO;AAAA,EACR;AACA,SAAO,IAAI,oBAAoB,UAAU,QAAQ,OAAO;AACzD;AARe;AAUR,SAAS,uCAAuC,UAAkD,OAAmB,UAAoB,OAA0B,YAAY,OAAiD;AACtO,QAAM,YAAY,SAAS,QAAQ,OAAO,SAAS;AACnD,QAAM,WAAW,UAAU,IAAI,CAAC,UAAU,UAAU,gBAAgB,UAAU,OAAO,OAAO,UAAU,KAAK,CAAC;AAC5G,SAAO,oBAAoB,aAAa,QAAQ,EAAE,SAAS;AAC5D;AAJgB;AAMT,SAAS,iBAAiB,UAAkD,OAAmB,UAAoB,OAA0B,YAAY,OAAyB;AACxL,SAAO,uCAAuC,UAAU,OAAO,UAAU,OAAO,SAAS,EAAE,IAAI,UAAQ,KAAK,KAAK,EAAE,UAAU;AAC9H;AAFgB;AAIhB,gCAAgC,yBAAyB,CAAC,UAAU,OAAO,aAA+B;AACzG,QAAM,0BAA0B,SAAS,IAAI,wBAAwB;AACrE,SAAO,iBAAiB,wBAAwB,eAAe,OAAO,UAAU,kBAAkB,IAAI;AACvG,CAAC;AAED,gCAAgC,mCAAmC,CAAC,UAAU,OAAO,aAA+B;AACnH,QAAM,0BAA0B,SAAS,IAAI,wBAAwB;AACrE,SAAO,iBAAiB,wBAAwB,eAAe,OAAO,UAAU,kBAAkB,MAAM,IAAI;AAC7G,CAAC;AAED,SAAS,QAAQ,QAAe;AAC/B,QAAM,WAAY,OAAO,OAAO,UAAU;AAC1C,QAAM,iBAAiB,OAAO,OAAO,aAAa,eAAe,OAAO,YAAY,OAAO,SAAS,SAAS;AAC7G,SAAO,YAAY;AACpB;AAJS;",
  "names": []
}
