import*as i from"../../../../../vs/base/browser/dom.js";import{ResizableHTMLElement as l}from"../../../../../vs/base/browser/ui/resizable/resizable.js";import{Disposable as h}from"../../../../../vs/base/common/lifecycle.js";import{ContentWidgetPositionPreference as s}from"../../../../../vs/editor/browser/editorBrowser.js";import{EditorOption as c}from"../../../../../vs/editor/common/config/editorOptions.js";import{Position as m}from"../../../../../vs/editor/common/core/position.js";const b=30,u=24;class E extends h{constructor(o,e=new i.Dimension(10,10)){super();this._editor=o;this._resizableNode.domNode.style.position="absolute",this._resizableNode.minSize=i.Dimension.lift(e),this._resizableNode.layout(e.height,e.width),this._resizableNode.enableSashes(!0,!0,!0,!0),this._register(this._resizableNode.onDidResize(t=>{this._resize(new i.Dimension(t.dimension.width,t.dimension.height)),t.done&&(this._isResizing=!1)})),this._register(this._resizableNode.onDidWillResize(()=>{this._isResizing=!0}))}allowEditorOverflow=!0;suppressMouseDown=!1;_resizableNode=this._register(new l);_contentPosition=null;_isResizing=!1;get isResizing(){return this._isResizing}getDomNode(){return this._resizableNode.domNode}getPosition(){return this._contentPosition}get position(){return this._contentPosition?.position?m.lift(this._contentPosition.position):void 0}_availableVerticalSpaceAbove(o){const e=this._editor.getDomNode(),t=this._editor.getScrolledVisiblePosition(o);return!e||!t?void 0:i.getDomNodePagePosition(e).top+t.top-b}_availableVerticalSpaceBelow(o){const e=this._editor.getDomNode(),t=this._editor.getScrolledVisiblePosition(o);if(!e||!t)return;const n=i.getDomNodePagePosition(e),a=i.getClientArea(e.ownerDocument.body),r=n.top+t.top+t.height;return a.height-r-u}_findPositionPreference(o,e){const t=Math.min(this._availableVerticalSpaceBelow(e)??1/0,o),n=Math.min(this._availableVerticalSpaceAbove(e)??1/0,o),a=Math.min(Math.max(n,t),o),r=Math.min(o,a);let d;return this._editor.getOption(c.hover).above?d=r<=n?s.ABOVE:s.BELOW:d=r<=t?s.BELOW:s.ABOVE,d===s.ABOVE?this._resizableNode.enableSashes(!0,!0,!1,!1):this._resizableNode.enableSashes(!1,!0,!0,!1),d}_resize(o){this._resizableNode.layout(o.height,o.width)}}export{E as ResizableContentWidget};
