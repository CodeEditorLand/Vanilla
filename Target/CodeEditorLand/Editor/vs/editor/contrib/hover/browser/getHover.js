import{AsyncIterableObject as l}from"../../../../base/common/async.js";import{CancellationToken as s}from"../../../../base/common/cancellation.js";import{onUnexpectedExternalError as p}from"../../../../base/common/errors.js";import{registerModelAndPositionCommand as a}from"../../../browser/editorExtensions.js";import{ILanguageFeaturesService as c}from"../../../common/services/languageFeatures.js";class g{constructor(r,o,t){this.provider=r;this.hover=o;this.ordinal=t}}async function P(e,r,o,t,i){const n=await Promise.resolve(e.provideHover(o,t,i)).catch(p);if(!(!n||!H(n)))return new g(e,n,r)}function f(e,r,o,t,i=!1){const m=e.ordered(r,i).map((u,d)=>P(u,d,r,o,t));return l.fromPromises(m).coalesce()}function v(e,r,o,t,i=!1){return f(e,r,o,t,i).map(n=>n.hover).toPromise()}a("_executeHoverProvider",(e,r,o)=>{const t=e.get(c);return v(t.hoverProvider,r,o,s.None)}),a("_executeHoverProvider_recursive",(e,r,o)=>{const t=e.get(c);return v(t.hoverProvider,r,o,s.None,!0)});function H(e){const r=typeof e.range<"u",o=typeof e.contents<"u"&&e.contents&&e.contents.length>0;return r&&o}export{g as HoverProviderResult,f as getHoverProviderResultsAsAsyncIterable,v as getHoversPromise};
