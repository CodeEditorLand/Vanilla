{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/editor/contrib/diffEditorBreadcrumbs/browser/contribution.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { reverseOrder, compareBy, numberComparator } from '../../../../base/common/arrays.js';\nimport { observableValue, observableSignalFromEvent, autorunWithStore, IReader } from '../../../../base/common/observable.js';\nimport { HideUnchangedRegionsFeature, IDiffEditorBreadcrumbsSource } from '../../../browser/widget/diffEditor/features/hideUnchangedRegionsFeature.js';\nimport { DisposableCancellationTokenSource } from '../../../browser/widget/diffEditor/utils.js';\nimport { LineRange } from '../../../common/core/lineRange.js';\nimport { ITextModel } from '../../../common/model.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { IOutlineModelService, OutlineModel } from '../../documentSymbols/browser/outlineModel.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { Event } from '../../../../base/common/event.js';\nimport { SymbolKind } from '../../../common/languages.js';\n\nclass DiffEditorBreadcrumbsSource extends Disposable implements IDiffEditorBreadcrumbsSource {\n\tprivate readonly _currentModel = observableValue<OutlineModel | undefined>(this, undefined);\n\n\tconstructor(\n\t\tprivate readonly _textModel: ITextModel,\n\t\t@ILanguageFeaturesService private readonly _languageFeaturesService: ILanguageFeaturesService,\n\t\t@IOutlineModelService private readonly _outlineModelService: IOutlineModelService,\n\t) {\n\t\tsuper();\n\n\t\tconst documentSymbolProviderChanged = observableSignalFromEvent(\n\t\t\t'documentSymbolProvider.onDidChange',\n\t\t\tthis._languageFeaturesService.documentSymbolProvider.onDidChange\n\t\t);\n\n\t\tconst textModelChanged = observableSignalFromEvent(\n\t\t\t'_textModel.onDidChangeContent',\n\t\t\tEvent.debounce<any>(e => this._textModel.onDidChangeContent(e), () => undefined, 100)\n\t\t);\n\n\t\tthis._register(autorunWithStore(async (reader, store) => {\n\t\t\tdocumentSymbolProviderChanged.read(reader);\n\t\t\ttextModelChanged.read(reader);\n\n\t\t\tconst src = store.add(new DisposableCancellationTokenSource());\n\t\t\tconst model = await this._outlineModelService.getOrCreate(this._textModel, src.token);\n\t\t\tif (store.isDisposed) { return; }\n\n\t\t\tthis._currentModel.set(model, undefined);\n\t\t}));\n\t}\n\n\tpublic getBreadcrumbItems(startRange: LineRange, reader: IReader): { name: string; kind: SymbolKind; startLineNumber: number }[] {\n\t\tconst m = this._currentModel.read(reader);\n\t\tif (!m) { return []; }\n\t\tconst symbols = m.asListOfDocumentSymbols()\n\t\t\t.filter(s => startRange.contains(s.range.startLineNumber) && !startRange.contains(s.range.endLineNumber));\n\t\tsymbols.sort(reverseOrder(compareBy(s => s.range.endLineNumber - s.range.startLineNumber, numberComparator)));\n\t\treturn symbols.map(s => ({ name: s.name, kind: s.kind, startLineNumber: s.range.startLineNumber }));\n\t}\n}\n\nHideUnchangedRegionsFeature.setBreadcrumbsSourceFactory((textModel, instantiationService) => {\n\treturn instantiationService.createInstance(DiffEditorBreadcrumbsSource, textModel);\n});\n"],
  "mappings": ";;;;;;;;;;;;AAKA,SAAS,cAAc,WAAW,wBAAwB;AAC1D,SAAS,iBAAiB,2BAA2B,kBAAkB,eAAe;AACtF,SAAS,6BAA6B,oCAAoC;AAC1E,SAAS,yCAAyC;AAClD,SAAS,iBAAiB;AAC1B,SAAS,kBAAkB;AAC3B,SAAS,gCAAgC;AACzC,SAAS,sBAAsB,oBAAoB;AACnD,SAAS,kBAAkB;AAC3B,SAAS,aAAa;AACtB,SAAS,kBAAkB;AAE3B,IAAM,8BAAN,cAA0C,WAAmD;AAAA,EAG5F,YACkB,YAC0B,0BACJ,sBACtC;AACD,UAAM;AAJW;AAC0B;AACJ;AAIvC,UAAM,gCAAgC;AAAA,MACrC;AAAA,MACA,KAAK,yBAAyB,uBAAuB;AAAA,IACtD;AAEA,UAAM,mBAAmB;AAAA,MACxB;AAAA,MACA,MAAM,SAAc,OAAK,KAAK,WAAW,mBAAmB,CAAC,GAAG,MAAM,QAAW,GAAG;AAAA,IACrF;AAEA,SAAK,UAAU,iBAAiB,OAAO,QAAQ,UAAU;AACxD,oCAA8B,KAAK,MAAM;AACzC,uBAAiB,KAAK,MAAM;AAE5B,YAAM,MAAM,MAAM,IAAI,IAAI,kCAAkC,CAAC;AAC7D,YAAM,QAAQ,MAAM,KAAK,qBAAqB,YAAY,KAAK,YAAY,IAAI,KAAK;AACpF,UAAI,MAAM,YAAY;AAAE;AAAA,MAAQ;AAEhC,WAAK,cAAc,IAAI,OAAO,MAAS;AAAA,IACxC,CAAC,CAAC;AAAA,EACH;AAAA,EA/CD,OAiB6F;AAAA;AAAA;AAAA,EAC3E,gBAAgB,gBAA0C,MAAM,MAAS;AAAA,EA+BnF,mBAAmB,YAAuB,QAAgF;AAChI,UAAM,IAAI,KAAK,cAAc,KAAK,MAAM;AACxC,QAAI,CAAC,GAAG;AAAE,aAAO,CAAC;AAAA,IAAG;AACrB,UAAM,UAAU,EAAE,wBAAwB,EACxC,OAAO,OAAK,WAAW,SAAS,EAAE,MAAM,eAAe,KAAK,CAAC,WAAW,SAAS,EAAE,MAAM,aAAa,CAAC;AACzG,YAAQ,KAAK,aAAa,UAAU,OAAK,EAAE,MAAM,gBAAgB,EAAE,MAAM,iBAAiB,gBAAgB,CAAC,CAAC;AAC5G,WAAO,QAAQ,IAAI,QAAM,EAAE,MAAM,EAAE,MAAM,MAAM,EAAE,MAAM,iBAAiB,EAAE,MAAM,gBAAgB,EAAE;AAAA,EACnG;AACD;AAxCM,8BAAN;AAAA,EAKG;AAAA,EACA;AAAA,GANG;AA0CN,4BAA4B,4BAA4B,CAAC,WAAW,yBAAyB;AAC5F,SAAO,qBAAqB,eAAe,6BAA6B,SAAS;AAClF,CAAC;",
  "names": []
}
