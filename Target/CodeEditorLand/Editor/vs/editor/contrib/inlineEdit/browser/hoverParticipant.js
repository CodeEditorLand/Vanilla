var p=Object.defineProperty;var h=Object.getOwnPropertyDescriptor;var c=(i,r,t,e)=>{for(var o=e>1?void 0:e?h(r,t):r,n=i.length-1,l;n>=0;n--)(l=i[n])&&(o=(e?l(r,t,o):l(o))||o);return e&&o&&p(r,t,o),o},a=(i,r)=>(t,e)=>r(t,e,i);import{DisposableStore as g}from"../../../../../vs/base/common/lifecycle.js";import{constObservable as H}from"../../../../../vs/base/common/observable.js";import{MouseTargetType as d}from"../../../../../vs/editor/browser/editorBrowser.js";import{EditorOption as I}from"../../../../../vs/editor/common/config/editorOptions.js";import"../../../../../vs/editor/common/core/range.js";import"../../../../../vs/editor/common/model.js";import{HoverAnchorType as u,HoverForeignElementAnchor as v,RenderedHoverParts as E}from"../../../../../vs/editor/contrib/hover/browser/hoverTypes.js";import{InlineEditController as m}from"../../../../../vs/editor/contrib/inlineEdit/browser/inlineEditController.js";import{InlineEditHintsContentWidget as f}from"../../../../../vs/editor/contrib/inlineEdit/browser/inlineEditHintsWidget.js";import*as y from"../../../../../vs/nls.js";import{IInstantiationService as w}from"../../../../../vs/platform/instantiation/common/instantiation.js";import{ITelemetryService as T}from"../../../../../vs/platform/telemetry/common/telemetry.js";class b{constructor(r,t,e){this.owner=r;this.range=t;this.controller=e}isValidForHoverAnchor(r){return r.type===u.Range&&this.range.startColumn<=r.range.startColumn&&this.range.endColumn>=r.range.endColumn}}let s=class{constructor(r,t,e){this._editor=r;this._instantiationService=t;this._telemetryService=e}hoverOrdinal=5;suggestHoverAnchor(r){const t=m.get(this._editor);if(!t)return null;const e=r.target;if(e.type===d.CONTENT_VIEW_ZONE){const o=e.detail;if(t.shouldShowHoverAtViewZone(o.viewZoneId)){const n=e.range;return new v(1e3,this,n,r.event.posx,r.event.posy,!1)}}return e.type===d.CONTENT_EMPTY&&t.shouldShowHoverAt(e.range)?new v(1e3,this,e.range,r.event.posx,r.event.posy,!1):e.type===d.CONTENT_TEXT&&e.detail.mightBeForeignElement&&t.shouldShowHoverAt(e.range)?new v(1e3,this,e.range,r.event.posx,r.event.posy,!1):null}computeSync(r,t){if(this._editor.getOption(I.inlineEdit).showToolbar!=="onHover")return[];const e=m.get(this._editor);return e&&e.shouldShowHoverAt(r.range)?[new b(this,r.range,e)]:[]}renderHoverParts(r,t){const e=new g;this._telemetryService.publicLog2("inlineEditHover.shown");const o=this._instantiationService.createInstance(f,this._editor,!1,H(null));e.add(o);const n=o.getDomNode(),l={hoverPart:t[0],hoverElement:n,dispose:()=>e.dispose()};return new E([l])}getAccessibleContent(r){return y.localize("hoverAccessibilityInlineEdits","There are inline edits here.")}};s=c([a(1,w),a(2,T)],s);export{b as InlineEditHover,s as InlineEditHoverParticipant};
