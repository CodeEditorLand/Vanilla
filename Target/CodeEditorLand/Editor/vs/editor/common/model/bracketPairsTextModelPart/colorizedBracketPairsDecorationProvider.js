import"../../../../../vs/base/common/color.js";import{Emitter as g}from"../../../../../vs/base/common/event.js";import{Disposable as d}from"../../../../../vs/base/common/lifecycle.js";import{editorBracketHighlightingForeground1 as c,editorBracketHighlightingForeground2 as p,editorBracketHighlightingForeground3 as m,editorBracketHighlightingForeground4 as h,editorBracketHighlightingForeground5 as u,editorBracketHighlightingForeground6 as C,editorBracketHighlightingUnexpectedBracketForeground as f}from"../../../../../vs/editor/common/core/editorColorRegistry.js";import{Range as v}from"../../../../../vs/editor/common/core/range.js";import"../../../../../vs/editor/common/model.js";import"../../../../../vs/editor/common/model/decorationProvider.js";import"../../../../../vs/editor/common/model/textModel.js";import"../../../../../vs/editor/common/textModelBracketPairs.js";import"../../../../../vs/editor/common/textModelEvents.js";import{registerThemingParticipant as k}from"../../../../../vs/platform/theme/common/themeService.js";class w extends d{constructor(e){super();this.textModel=e;this.colorizationOptions=e.getOptions().bracketPairColorizationOptions,this._register(e.bracketPairs.onDidChange(r=>{this.onDidChangeEmitter.fire()}))}colorizationOptions;colorProvider=new s;onDidChangeEmitter=new g;onDidChange=this.onDidChangeEmitter.event;handleDidChangeOptions(e){this.colorizationOptions=this.textModel.getOptions().bracketPairColorizationOptions}getDecorationsInRange(e,r,a,o){return o?[]:r===void 0?[]:this.colorizationOptions.enabled?this.textModel.bracketPairs.getBracketsInRange(e,!0).map(n=>({id:`bracket${n.range.toString()}-${n.nestingLevel}`,options:{description:"BracketPairColorization",inlineClassName:this.colorProvider.getInlineClassName(n,this.colorizationOptions.independentColorPoolPerBracketType)},ownerId:0,range:n.range})).toArray():[]}getAllDecorations(e,r){return e===void 0?[]:this.colorizationOptions.enabled?this.getDecorationsInRange(new v(1,1,this.textModel.getLineCount(),1),e,r):[]}}class s{unexpectedClosingBracketClassName="unexpected-closing-bracket";getInlineClassName(i,e){return i.isInvalid?this.unexpectedClosingBracketClassName:this.getInlineClassNameOfLevel(e?i.nestingLevelOfEqualBracketType:i.nestingLevel)}getInlineClassNameOfLevel(i){return`bracket-highlighting-${i%30}`}}k((t,i)=>{const e=[c,p,m,h,u,C],r=new s;i.addRule(`.monaco-editor .${r.unexpectedClosingBracketClassName} { color: ${t.getColor(f)}; }`);const a=e.map(o=>t.getColor(o)).filter(o=>!!o).filter(o=>!o.isTransparent());for(let o=0;o<30;o++){const l=a[o%a.length];i.addRule(`.monaco-editor .${r.getInlineClassNameOfLevel(o)} { color: ${l}; }`)}});export{w as ColorizedBracketPairsDecorationProvider};
