{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/editor/common/model/bracketPairsTextModelPart/colorizedBracketPairsDecorationProvider.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Color } from '../../../../base/common/color.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { Range } from '../../core/range.js';\nimport { BracketPairColorizationOptions, IModelDecoration } from '../../model.js';\nimport { BracketInfo } from '../../textModelBracketPairs.js';\nimport { DecorationProvider } from '../decorationProvider.js';\nimport { TextModel } from '../textModel.js';\nimport {\n\teditorBracketHighlightingForeground1, editorBracketHighlightingForeground2, editorBracketHighlightingForeground3, editorBracketHighlightingForeground4, editorBracketHighlightingForeground5, editorBracketHighlightingForeground6, editorBracketHighlightingUnexpectedBracketForeground\n} from '../../core/editorColorRegistry.js';\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\nimport { IModelOptionsChangedEvent } from '../../textModelEvents.js';\n\nexport class ColorizedBracketPairsDecorationProvider extends Disposable implements DecorationProvider {\n\tprivate colorizationOptions: BracketPairColorizationOptions;\n\tprivate readonly colorProvider = new ColorProvider();\n\n\tprivate readonly onDidChangeEmitter = new Emitter<void>();\n\tpublic readonly onDidChange = this.onDidChangeEmitter.event;\n\n\tconstructor(private readonly textModel: TextModel) {\n\t\tsuper();\n\n\t\tthis.colorizationOptions = textModel.getOptions().bracketPairColorizationOptions;\n\n\t\tthis._register(textModel.bracketPairs.onDidChange(e => {\n\t\t\tthis.onDidChangeEmitter.fire();\n\t\t}));\n\t}\n\n\t//#region TextModel events\n\n\tpublic handleDidChangeOptions(e: IModelOptionsChangedEvent): void {\n\t\tthis.colorizationOptions = this.textModel.getOptions().bracketPairColorizationOptions;\n\t}\n\n\t//#endregion\n\n\tgetDecorationsInRange(range: Range, ownerId?: number, filterOutValidation?: boolean, onlyMinimapDecorations?: boolean): IModelDecoration[] {\n\t\tif (onlyMinimapDecorations) {\n\t\t\t// Bracket pair colorization decorations are not rendered in the minimap\n\t\t\treturn [];\n\t\t}\n\t\tif (ownerId === undefined) {\n\t\t\treturn [];\n\t\t}\n\t\tif (!this.colorizationOptions.enabled) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst result = this.textModel.bracketPairs.getBracketsInRange(range, true).map<IModelDecoration>(bracket => ({\n\t\t\tid: `bracket${bracket.range.toString()}-${bracket.nestingLevel}`,\n\t\t\toptions: {\n\t\t\t\tdescription: 'BracketPairColorization',\n\t\t\t\tinlineClassName: this.colorProvider.getInlineClassName(\n\t\t\t\t\tbracket,\n\t\t\t\t\tthis.colorizationOptions.independentColorPoolPerBracketType\n\t\t\t\t),\n\t\t\t},\n\t\t\townerId: 0,\n\t\t\trange: bracket.range,\n\t\t})).toArray();\n\n\t\treturn result;\n\t}\n\n\tgetAllDecorations(ownerId?: number, filterOutValidation?: boolean): IModelDecoration[] {\n\t\tif (ownerId === undefined) {\n\t\t\treturn [];\n\t\t}\n\t\tif (!this.colorizationOptions.enabled) {\n\t\t\treturn [];\n\t\t}\n\t\treturn this.getDecorationsInRange(\n\t\t\tnew Range(1, 1, this.textModel.getLineCount(), 1),\n\t\t\townerId,\n\t\t\tfilterOutValidation\n\t\t);\n\t}\n}\n\nclass ColorProvider {\n\tpublic readonly unexpectedClosingBracketClassName = 'unexpected-closing-bracket';\n\n\tgetInlineClassName(bracket: BracketInfo, independentColorPoolPerBracketType: boolean): string {\n\t\tif (bracket.isInvalid) {\n\t\t\treturn this.unexpectedClosingBracketClassName;\n\t\t}\n\t\treturn this.getInlineClassNameOfLevel(independentColorPoolPerBracketType ? bracket.nestingLevelOfEqualBracketType : bracket.nestingLevel);\n\t}\n\n\tgetInlineClassNameOfLevel(level: number): string {\n\t\t// To support a dynamic amount of colors up to 6 colors,\n\t\t// we use a number that is a lcm of all numbers from 1 to 6.\n\t\treturn `bracket-highlighting-${level % 30}`;\n\t}\n}\n\nregisterThemingParticipant((theme, collector) => {\n\tconst colors = [\n\t\teditorBracketHighlightingForeground1,\n\t\teditorBracketHighlightingForeground2,\n\t\teditorBracketHighlightingForeground3,\n\t\teditorBracketHighlightingForeground4,\n\t\teditorBracketHighlightingForeground5,\n\t\teditorBracketHighlightingForeground6\n\t];\n\tconst colorProvider = new ColorProvider();\n\n\tcollector.addRule(`.monaco-editor .${colorProvider.unexpectedClosingBracketClassName} { color: ${theme.getColor(editorBracketHighlightingUnexpectedBracketForeground)}; }`);\n\n\tconst colorValues = colors\n\t\t.map(c => theme.getColor(c))\n\t\t.filter((c): c is Color => !!c)\n\t\t.filter(c => !c.isTransparent());\n\n\tfor (let level = 0; level < 30; level++) {\n\t\tconst color = colorValues[level % colorValues.length];\n\t\tcollector.addRule(`.monaco-editor .${colorProvider.getInlineClassNameOfLevel(level)} { color: ${color}; }`);\n\t}\n});\n"],
  "mappings": ";;AAKA,SAAS,aAAa;AACtB,SAAS,eAAe;AACxB,SAAS,kBAAkB;AAC3B,SAAS,aAAa;AACtB,SAAS,gCAAgC,wBAAwB;AACjE,SAAS,mBAAmB;AAC5B,SAAS,0BAA0B;AACnC,SAAS,iBAAiB;AAC1B;AAAA,EACC;AAAA,EAAsC;AAAA,EAAsC;AAAA,EAAsC;AAAA,EAAsC;AAAA,EAAsC;AAAA,EAAsC;AAAA,OAC9N;AACP,SAAS,kCAAkC;AAC3C,SAAS,iCAAiC;AAEnC,MAAM,gDAAgD,WAAyC;AAAA,EAOrG,YAA6B,WAAsB;AAClD,UAAM;AADsB;AAG5B,SAAK,sBAAsB,UAAU,WAAW,EAAE;AAElD,SAAK,UAAU,UAAU,aAAa,YAAY,OAAK;AACtD,WAAK,mBAAmB,KAAK;AAAA,IAC9B,CAAC,CAAC;AAAA,EACH;AAAA,EAlCD,OAmBsG;AAAA;AAAA;AAAA,EAC7F;AAAA,EACS,gBAAgB,IAAI,cAAc;AAAA,EAElC,qBAAqB,IAAI,QAAc;AAAA,EACxC,cAAc,KAAK,mBAAmB;AAAA;AAAA,EAc/C,uBAAuB,GAAoC;AACjE,SAAK,sBAAsB,KAAK,UAAU,WAAW,EAAE;AAAA,EACxD;AAAA;AAAA,EAIA,sBAAsB,OAAc,SAAkB,qBAA+B,wBAAsD;AAC1I,QAAI,wBAAwB;AAE3B,aAAO,CAAC;AAAA,IACT;AACA,QAAI,YAAY,QAAW;AAC1B,aAAO,CAAC;AAAA,IACT;AACA,QAAI,CAAC,KAAK,oBAAoB,SAAS;AACtC,aAAO,CAAC;AAAA,IACT;AAEA,UAAM,SAAS,KAAK,UAAU,aAAa,mBAAmB,OAAO,IAAI,EAAE,IAAsB,cAAY;AAAA,MAC5G,IAAI,UAAU,QAAQ,MAAM,SAAS,CAAC,IAAI,QAAQ,YAAY;AAAA,MAC9D,SAAS;AAAA,QACR,aAAa;AAAA,QACb,iBAAiB,KAAK,cAAc;AAAA,UACnC;AAAA,UACA,KAAK,oBAAoB;AAAA,QAC1B;AAAA,MACD;AAAA,MACA,SAAS;AAAA,MACT,OAAO,QAAQ;AAAA,IAChB,EAAE,EAAE,QAAQ;AAEZ,WAAO;AAAA,EACR;AAAA,EAEA,kBAAkB,SAAkB,qBAAmD;AACtF,QAAI,YAAY,QAAW;AAC1B,aAAO,CAAC;AAAA,IACT;AACA,QAAI,CAAC,KAAK,oBAAoB,SAAS;AACtC,aAAO,CAAC;AAAA,IACT;AACA,WAAO,KAAK;AAAA,MACX,IAAI,MAAM,GAAG,GAAG,KAAK,UAAU,aAAa,GAAG,CAAC;AAAA,MAChD;AAAA,MACA;AAAA,IACD;AAAA,EACD;AACD;AAEA,MAAM,cAAc;AAAA,EAvFpB,OAuFoB;AAAA;AAAA;AAAA,EACH,oCAAoC;AAAA,EAEpD,mBAAmB,SAAsB,oCAAqD;AAC7F,QAAI,QAAQ,WAAW;AACtB,aAAO,KAAK;AAAA,IACb;AACA,WAAO,KAAK,0BAA0B,qCAAqC,QAAQ,iCAAiC,QAAQ,YAAY;AAAA,EACzI;AAAA,EAEA,0BAA0B,OAAuB;AAGhD,WAAO,wBAAwB,QAAQ,EAAE;AAAA,EAC1C;AACD;AAEA,2BAA2B,CAAC,OAAO,cAAc;AAChD,QAAM,SAAS;AAAA,IACd;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EACD;AACA,QAAM,gBAAgB,IAAI,cAAc;AAExC,YAAU,QAAQ,mBAAmB,cAAc,iCAAiC,aAAa,MAAM,SAAS,oDAAoD,CAAC,KAAK;AAE1K,QAAM,cAAc,OAClB,IAAI,OAAK,MAAM,SAAS,CAAC,CAAC,EAC1B,OAAO,CAAC,MAAkB,CAAC,CAAC,CAAC,EAC7B,OAAO,OAAK,CAAC,EAAE,cAAc,CAAC;AAEhC,WAAS,QAAQ,GAAG,QAAQ,IAAI,SAAS;AACxC,UAAM,QAAQ,YAAY,QAAQ,YAAY,MAAM;AACpD,cAAU,QAAQ,mBAAmB,cAAc,0BAA0B,KAAK,CAAC,aAAa,KAAK,KAAK;AAAA,EAC3G;AACD,CAAC;",
  "names": []
}
