{
  "version": 3,
  "sources": ["../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/editor/common/config/fontInfo.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as platform from \"../../../base/common/platform.js\";\nimport {\n\tEDITOR_FONT_DEFAULTS,\n\tEditorFontVariations,\n\tEditorOption,\n\tEditorOptions,\n\ttype FindComputedEditorOptionValueById,\n} from \"./editorOptions.js\";\nimport { EditorZoom } from \"./editorZoom.js\";\n\n/**\n * Determined from empirical observations.\n * @internal\n */\nconst GOLDEN_LINE_HEIGHT_RATIO = platform.isMacintosh ? 1.5 : 1.35;\n\n/**\n * @internal\n */\nconst MINIMUM_LINE_HEIGHT = 8;\n\n/**\n * @internal\n */\nexport interface IValidatedEditorOptions {\n\tget<T extends EditorOption>(id: T): FindComputedEditorOptionValueById<T>;\n}\n\nexport class BareFontInfo {\n\treadonly _bareFontInfoBrand: void = undefined;\n\n\t/**\n\t * @internal\n\t */\n\tpublic static createFromValidatedSettings(\n\t\toptions: IValidatedEditorOptions,\n\t\tpixelRatio: number,\n\t\tignoreEditorZoom: boolean,\n\t): BareFontInfo {\n\t\tconst fontFamily = options.get(EditorOption.fontFamily);\n\t\tconst fontWeight = options.get(EditorOption.fontWeight);\n\t\tconst fontSize = options.get(EditorOption.fontSize);\n\t\tconst fontFeatureSettings = options.get(EditorOption.fontLigatures);\n\t\tconst fontVariationSettings = options.get(EditorOption.fontVariations);\n\t\tconst lineHeight = options.get(EditorOption.lineHeight);\n\t\tconst letterSpacing = options.get(EditorOption.letterSpacing);\n\t\treturn BareFontInfo._create(\n\t\t\tfontFamily,\n\t\t\tfontWeight,\n\t\t\tfontSize,\n\t\t\tfontFeatureSettings,\n\t\t\tfontVariationSettings,\n\t\t\tlineHeight,\n\t\t\tletterSpacing,\n\t\t\tpixelRatio,\n\t\t\tignoreEditorZoom,\n\t\t);\n\t}\n\n\t/**\n\t * @internal\n\t */\n\tpublic static createFromRawSettings(\n\t\topts: {\n\t\t\tfontFamily?: string;\n\t\t\tfontWeight?: string;\n\t\t\tfontSize?: number;\n\t\t\tfontLigatures?: boolean | string;\n\t\t\tfontVariations?: boolean | string;\n\t\t\tlineHeight?: number;\n\t\t\tletterSpacing?: number;\n\t\t},\n\t\tpixelRatio: number,\n\t\tignoreEditorZoom = false,\n\t): BareFontInfo {\n\t\tconst fontFamily = EditorOptions.fontFamily.validate(opts.fontFamily);\n\t\tconst fontWeight = EditorOptions.fontWeight.validate(opts.fontWeight);\n\t\tconst fontSize = EditorOptions.fontSize.validate(opts.fontSize);\n\t\tconst fontFeatureSettings = EditorOptions.fontLigatures2.validate(\n\t\t\topts.fontLigatures,\n\t\t);\n\t\tconst fontVariationSettings = EditorOptions.fontVariations.validate(\n\t\t\topts.fontVariations,\n\t\t);\n\t\tconst lineHeight = EditorOptions.lineHeight.validate(opts.lineHeight);\n\t\tconst letterSpacing = EditorOptions.letterSpacing.validate(\n\t\t\topts.letterSpacing,\n\t\t);\n\t\treturn BareFontInfo._create(\n\t\t\tfontFamily,\n\t\t\tfontWeight,\n\t\t\tfontSize,\n\t\t\tfontFeatureSettings,\n\t\t\tfontVariationSettings,\n\t\t\tlineHeight,\n\t\t\tletterSpacing,\n\t\t\tpixelRatio,\n\t\t\tignoreEditorZoom,\n\t\t);\n\t}\n\n\t/**\n\t * @internal\n\t */\n\tprivate static _create(\n\t\tfontFamily: string,\n\t\tfontWeight: string,\n\t\tfontSize: number,\n\t\tfontFeatureSettings: string,\n\t\tfontVariationSettings: string,\n\t\tlineHeight: number,\n\t\tletterSpacing: number,\n\t\tpixelRatio: number,\n\t\tignoreEditorZoom: boolean,\n\t): BareFontInfo {\n\t\tif (lineHeight === 0) {\n\t\t\tlineHeight = GOLDEN_LINE_HEIGHT_RATIO * fontSize;\n\t\t} else if (lineHeight < MINIMUM_LINE_HEIGHT) {\n\t\t\t// Values too small to be line heights in pixels are in ems.\n\t\t\tlineHeight = lineHeight * fontSize;\n\t\t}\n\n\t\t// Enforce integer, minimum constraints\n\t\tlineHeight = Math.round(lineHeight);\n\t\tif (lineHeight < MINIMUM_LINE_HEIGHT) {\n\t\t\tlineHeight = MINIMUM_LINE_HEIGHT;\n\t\t}\n\n\t\tconst editorZoomLevelMultiplier =\n\t\t\t1 + (ignoreEditorZoom ? 0 : EditorZoom.getZoomLevel() * 0.1);\n\t\tfontSize *= editorZoomLevelMultiplier;\n\t\tlineHeight *= editorZoomLevelMultiplier;\n\n\t\tif (fontVariationSettings === EditorFontVariations.TRANSLATE) {\n\t\t\tif (fontWeight === \"normal\" || fontWeight === \"bold\") {\n\t\t\t\tfontVariationSettings = EditorFontVariations.OFF;\n\t\t\t} else {\n\t\t\t\tconst fontWeightAsNumber = Number.parseInt(fontWeight, 10);\n\t\t\t\tfontVariationSettings = `'wght' ${fontWeightAsNumber}`;\n\t\t\t\tfontWeight = \"normal\";\n\t\t\t}\n\t\t}\n\n\t\treturn new BareFontInfo({\n\t\t\tpixelRatio: pixelRatio,\n\t\t\tfontFamily: fontFamily,\n\t\t\tfontWeight: fontWeight,\n\t\t\tfontSize: fontSize,\n\t\t\tfontFeatureSettings: fontFeatureSettings,\n\t\t\tfontVariationSettings,\n\t\t\tlineHeight: lineHeight,\n\t\t\tletterSpacing: letterSpacing,\n\t\t});\n\t}\n\n\treadonly pixelRatio: number;\n\treadonly fontFamily: string;\n\treadonly fontWeight: string;\n\treadonly fontSize: number;\n\treadonly fontFeatureSettings: string;\n\treadonly fontVariationSettings: string;\n\treadonly lineHeight: number;\n\treadonly letterSpacing: number;\n\n\t/**\n\t * @internal\n\t */\n\tprotected constructor(opts: {\n\t\tpixelRatio: number;\n\t\tfontFamily: string;\n\t\tfontWeight: string;\n\t\tfontSize: number;\n\t\tfontFeatureSettings: string;\n\t\tfontVariationSettings: string;\n\t\tlineHeight: number;\n\t\tletterSpacing: number;\n\t}) {\n\t\tthis.pixelRatio = opts.pixelRatio;\n\t\tthis.fontFamily = String(opts.fontFamily);\n\t\tthis.fontWeight = String(opts.fontWeight);\n\t\tthis.fontSize = opts.fontSize;\n\t\tthis.fontFeatureSettings = opts.fontFeatureSettings;\n\t\tthis.fontVariationSettings = opts.fontVariationSettings;\n\t\tthis.lineHeight = opts.lineHeight | 0;\n\t\tthis.letterSpacing = opts.letterSpacing;\n\t}\n\n\t/**\n\t * @internal\n\t */\n\tpublic getId(): string {\n\t\treturn `${this.pixelRatio}-${this.fontFamily}-${this.fontWeight}-${this.fontSize}-${this.fontFeatureSettings}-${this.fontVariationSettings}-${this.lineHeight}-${this.letterSpacing}`;\n\t}\n\n\t/**\n\t * @internal\n\t */\n\tpublic getMassagedFontFamily(): string {\n\t\tconst fallbackFontFamily = EDITOR_FONT_DEFAULTS.fontFamily;\n\t\tconst fontFamily = BareFontInfo._wrapInQuotes(this.fontFamily);\n\t\tif (fallbackFontFamily && this.fontFamily !== fallbackFontFamily) {\n\t\t\treturn `${fontFamily}, ${fallbackFontFamily}`;\n\t\t}\n\t\treturn fontFamily;\n\t}\n\n\tprivate static _wrapInQuotes(fontFamily: string): string {\n\t\tif (/[,\"']/.test(fontFamily)) {\n\t\t\t// Looks like the font family might be already escaped\n\t\t\treturn fontFamily;\n\t\t}\n\t\tif (/[+ ]/.test(fontFamily)) {\n\t\t\t// Wrap a font family using + or <space> with quotes\n\t\t\treturn `\"${fontFamily}\"`;\n\t\t}\n\t\treturn fontFamily;\n\t}\n}\n\n// change this whenever `FontInfo` members are changed\nexport const SERIALIZED_FONT_INFO_VERSION = 2;\n\nexport class FontInfo extends BareFontInfo {\n\treadonly _editorStylingBrand: void = undefined;\n\n\treadonly version: number = SERIALIZED_FONT_INFO_VERSION;\n\treadonly isTrusted: boolean;\n\treadonly isMonospace: boolean;\n\treadonly typicalHalfwidthCharacterWidth: number;\n\treadonly typicalFullwidthCharacterWidth: number;\n\treadonly canUseHalfwidthRightwardsArrow: boolean;\n\treadonly spaceWidth: number;\n\treadonly middotWidth: number;\n\treadonly wsmiddotWidth: number;\n\treadonly maxDigitWidth: number;\n\n\t/**\n\t * @internal\n\t */\n\tconstructor(\n\t\topts: {\n\t\t\tpixelRatio: number;\n\t\t\tfontFamily: string;\n\t\t\tfontWeight: string;\n\t\t\tfontSize: number;\n\t\t\tfontFeatureSettings: string;\n\t\t\tfontVariationSettings: string;\n\t\t\tlineHeight: number;\n\t\t\tletterSpacing: number;\n\t\t\tisMonospace: boolean;\n\t\t\ttypicalHalfwidthCharacterWidth: number;\n\t\t\ttypicalFullwidthCharacterWidth: number;\n\t\t\tcanUseHalfwidthRightwardsArrow: boolean;\n\t\t\tspaceWidth: number;\n\t\t\tmiddotWidth: number;\n\t\t\twsmiddotWidth: number;\n\t\t\tmaxDigitWidth: number;\n\t\t},\n\t\tisTrusted: boolean,\n\t) {\n\t\tsuper(opts);\n\t\tthis.isTrusted = isTrusted;\n\t\tthis.isMonospace = opts.isMonospace;\n\t\tthis.typicalHalfwidthCharacterWidth =\n\t\t\topts.typicalHalfwidthCharacterWidth;\n\t\tthis.typicalFullwidthCharacterWidth =\n\t\t\topts.typicalFullwidthCharacterWidth;\n\t\tthis.canUseHalfwidthRightwardsArrow =\n\t\t\topts.canUseHalfwidthRightwardsArrow;\n\t\tthis.spaceWidth = opts.spaceWidth;\n\t\tthis.middotWidth = opts.middotWidth;\n\t\tthis.wsmiddotWidth = opts.wsmiddotWidth;\n\t\tthis.maxDigitWidth = opts.maxDigitWidth;\n\t}\n\n\t/**\n\t * @internal\n\t */\n\tpublic equals(other: FontInfo): boolean {\n\t\treturn (\n\t\t\tthis.fontFamily === other.fontFamily &&\n\t\t\tthis.fontWeight === other.fontWeight &&\n\t\t\tthis.fontSize === other.fontSize &&\n\t\t\tthis.fontFeatureSettings === other.fontFeatureSettings &&\n\t\t\tthis.fontVariationSettings === other.fontVariationSettings &&\n\t\t\tthis.lineHeight === other.lineHeight &&\n\t\t\tthis.letterSpacing === other.letterSpacing &&\n\t\t\tthis.typicalHalfwidthCharacterWidth ===\n\t\t\t\tother.typicalHalfwidthCharacterWidth &&\n\t\t\tthis.typicalFullwidthCharacterWidth ===\n\t\t\t\tother.typicalFullwidthCharacterWidth &&\n\t\t\tthis.canUseHalfwidthRightwardsArrow ===\n\t\t\t\tother.canUseHalfwidthRightwardsArrow &&\n\t\t\tthis.spaceWidth === other.spaceWidth &&\n\t\t\tthis.middotWidth === other.middotWidth &&\n\t\t\tthis.wsmiddotWidth === other.wsmiddotWidth &&\n\t\t\tthis.maxDigitWidth === other.maxDigitWidth\n\t\t);\n\t}\n}\n"],
  "mappings": "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",
  "names": []
}
