{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/editor/common/diff/defaultLinesDiffComputer/utils.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { CharCode } from \"../../../../base/common/charCode.js\";\nimport type { LineRange } from \"../../core/lineRange.js\";\nimport type { DetailedLineRangeMapping } from \"../rangeMapping.js\";\n\nexport class Array2D<T> {\n\tprivate readonly array: T[] = [];\n\n\tconstructor(\n\t\tpublic readonly width: number,\n\t\tpublic readonly height: number,\n\t) {\n\t\tthis.array = new Array<T>(width * height);\n\t}\n\n\tget(x: number, y: number): T {\n\t\treturn this.array[x + y * this.width];\n\t}\n\n\tset(x: number, y: number, value: T): void {\n\t\tthis.array[x + y * this.width] = value;\n\t}\n}\n\nexport function isSpace(charCode: number): boolean {\n\treturn charCode === CharCode.Space || charCode === CharCode.Tab;\n}\n\nexport class LineRangeFragment {\n\tprivate static chrKeys = new Map<string, number>();\n\n\tprivate static getKey(chr: string): number {\n\t\tlet key = this.chrKeys.get(chr);\n\t\tif (key === undefined) {\n\t\t\tkey = this.chrKeys.size;\n\t\t\tthis.chrKeys.set(chr, key);\n\t\t}\n\t\treturn key;\n\t}\n\n\tprivate readonly totalCount: number;\n\tprivate readonly histogram: number[] = [];\n\tconstructor(\n\t\tpublic readonly range: LineRange,\n\t\tpublic readonly lines: string[],\n\t\tpublic readonly source: DetailedLineRangeMapping,\n\t) {\n\t\tlet counter = 0;\n\t\tfor (\n\t\t\tlet i = range.startLineNumber - 1;\n\t\t\ti < range.endLineNumberExclusive - 1;\n\t\t\ti++\n\t\t) {\n\t\t\tconst line = lines[i];\n\t\t\tfor (let j = 0; j < line.length; j++) {\n\t\t\t\tcounter++;\n\t\t\t\tconst chr = line[j];\n\t\t\t\tconst key = LineRangeFragment.getKey(chr);\n\t\t\t\tthis.histogram[key] = (this.histogram[key] || 0) + 1;\n\t\t\t}\n\t\t\tcounter++;\n\t\t\tconst key = LineRangeFragment.getKey(\"\\n\");\n\t\t\tthis.histogram[key] = (this.histogram[key] || 0) + 1;\n\t\t}\n\n\t\tthis.totalCount = counter;\n\t}\n\n\tpublic computeSimilarity(other: LineRangeFragment): number {\n\t\tlet sumDifferences = 0;\n\t\tconst maxLength = Math.max(\n\t\t\tthis.histogram.length,\n\t\t\tother.histogram.length,\n\t\t);\n\t\tfor (let i = 0; i < maxLength; i++) {\n\t\t\tsumDifferences += Math.abs(\n\t\t\t\t(this.histogram[i] ?? 0) - (other.histogram[i] ?? 0),\n\t\t\t);\n\t\t}\n\t\treturn 1 - sumDifferences / (this.totalCount + other.totalCount);\n\t}\n}\n"],
  "mappings": ";;AAKA,SAAS,gBAAgB;AAIlB,MAAM,QAAW;AAAA,EAGvB,YACiB,OACA,QACf;AAFe;AACA;AAEhB,SAAK,QAAQ,IAAI,MAAS,QAAQ,MAAM;AAAA,EACzC;AAAA,EAjBD,OASwB;AAAA;AAAA;AAAA,EACN,QAAa,CAAC;AAAA,EAS/B,IAAI,GAAW,GAAc;AAC5B,WAAO,KAAK,MAAM,IAAI,IAAI,KAAK,KAAK;AAAA,EACrC;AAAA,EAEA,IAAI,GAAW,GAAW,OAAgB;AACzC,SAAK,MAAM,IAAI,IAAI,KAAK,KAAK,IAAI;AAAA,EAClC;AACD;AAEO,SAAS,QAAQ,UAA2B;AAClD,SAAO,aAAa,SAAS,SAAS,aAAa,SAAS;AAC7D;AAFgB;AAIT,MAAM,kBAAkB;AAAA,EAc9B,YACiB,OACA,OACA,QACf;AAHe;AACA;AACA;AAEhB,QAAI,UAAU;AACd,aACK,IAAI,MAAM,kBAAkB,GAChC,IAAI,MAAM,yBAAyB,GACnC,KACC;AACD,YAAM,OAAO,MAAM,CAAC;AACpB,eAAS,IAAI,GAAG,IAAI,KAAK,QAAQ,KAAK;AACrC;AACA,cAAM,MAAM,KAAK,CAAC;AAClB,cAAMA,OAAM,kBAAkB,OAAO,GAAG;AACxC,aAAK,UAAUA,IAAG,KAAK,KAAK,UAAUA,IAAG,KAAK,KAAK;AAAA,MACpD;AACA;AACA,YAAM,MAAM,kBAAkB,OAAO,IAAI;AACzC,WAAK,UAAU,GAAG,KAAK,KAAK,UAAU,GAAG,KAAK,KAAK;AAAA,IACpD;AAEA,SAAK,aAAa;AAAA,EACnB;AAAA,EAtED,OAgC+B;AAAA;AAAA;AAAA,EAC9B,OAAe,UAAU,oBAAI,IAAoB;AAAA,EAEjD,OAAe,OAAO,KAAqB;AAC1C,QAAI,MAAM,KAAK,QAAQ,IAAI,GAAG;AAC9B,QAAI,QAAQ,QAAW;AACtB,YAAM,KAAK,QAAQ;AACnB,WAAK,QAAQ,IAAI,KAAK,GAAG;AAAA,IAC1B;AACA,WAAO;AAAA,EACR;AAAA,EAEiB;AAAA,EACA,YAAsB,CAAC;AAAA,EA2BjC,kBAAkB,OAAkC;AAC1D,QAAI,iBAAiB;AACrB,UAAM,YAAY,KAAK;AAAA,MACtB,KAAK,UAAU;AAAA,MACf,MAAM,UAAU;AAAA,IACjB;AACA,aAAS,IAAI,GAAG,IAAI,WAAW,KAAK;AACnC,wBAAkB,KAAK;AAAA,SACrB,KAAK,UAAU,CAAC,KAAK,MAAM,MAAM,UAAU,CAAC,KAAK;AAAA,MACnD;AAAA,IACD;AACA,WAAO,IAAI,kBAAkB,KAAK,aAAa,MAAM;AAAA,EACtD;AACD;",
  "names": ["key"]
}
