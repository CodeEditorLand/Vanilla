{
  "version": 3,
  "sources": ["../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/editor/common/services/textResourceConfigurationService.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Emitter, Event } from '../../../base/common/event.js';\nimport { Disposable } from '../../../base/common/lifecycle.js';\nimport { URI } from '../../../base/common/uri.js';\nimport { IPosition, Position } from '../core/position.js';\nimport { ILanguageService } from '../languages/language.js';\nimport { IModelService } from './model.js';\nimport { ITextResourceConfigurationService, ITextResourceConfigurationChangeEvent } from './textResourceConfiguration.js';\nimport { IConfigurationService, ConfigurationTarget, IConfigurationValue, IConfigurationChangeEvent } from '../../../platform/configuration/common/configuration.js';\n\nexport class TextResourceConfigurationService extends Disposable implements ITextResourceConfigurationService {\n\n\tpublic _serviceBrand: undefined;\n\n\tprivate readonly _onDidChangeConfiguration: Emitter<ITextResourceConfigurationChangeEvent> = this._register(new Emitter<ITextResourceConfigurationChangeEvent>());\n\tpublic readonly onDidChangeConfiguration: Event<ITextResourceConfigurationChangeEvent> = this._onDidChangeConfiguration.event;\n\n\tconstructor(\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@IModelService private readonly modelService: IModelService,\n\t\t@ILanguageService private readonly languageService: ILanguageService,\n\t) {\n\t\tsuper();\n\t\tthis._register(this.configurationService.onDidChangeConfiguration(e => this._onDidChangeConfiguration.fire(this.toResourceConfigurationChangeEvent(e))));\n\t}\n\n\tgetValue<T>(resource: URI | undefined, section?: string): T;\n\tgetValue<T>(resource: URI | undefined, at?: IPosition, section?: string): T;\n\tgetValue<T>(resource: URI | undefined, arg2?: any, arg3?: any): T {\n\t\tif (typeof arg3 === 'string') {\n\t\t\treturn this._getValue(resource, Position.isIPosition(arg2) ? arg2 : null, arg3);\n\t\t}\n\t\treturn this._getValue(resource, null, typeof arg2 === 'string' ? arg2 : undefined);\n\t}\n\n\tupdateValue(resource: URI, key: string, value: any, configurationTarget?: ConfigurationTarget): Promise<void> {\n\t\tconst language = this.getLanguage(resource, null);\n\t\tconst configurationValue = this.configurationService.inspect(key, { resource, overrideIdentifier: language });\n\t\tif (configurationTarget === undefined) {\n\t\t\tconfigurationTarget = this.deriveConfigurationTarget(configurationValue, language);\n\t\t}\n\t\tconst overrideIdentifier = language && configurationValue.overrideIdentifiers?.includes(language) ? language : undefined;\n\t\treturn this.configurationService.updateValue(key, value, { resource, overrideIdentifier }, configurationTarget);\n\t}\n\n\tprivate deriveConfigurationTarget(configurationValue: IConfigurationValue<any>, language: string | null): ConfigurationTarget {\n\t\tif (language) {\n\t\t\tif (configurationValue.memory?.override !== undefined) {\n\t\t\t\treturn ConfigurationTarget.MEMORY;\n\t\t\t}\n\t\t\tif (configurationValue.workspaceFolder?.override !== undefined) {\n\t\t\t\treturn ConfigurationTarget.WORKSPACE_FOLDER;\n\t\t\t}\n\t\t\tif (configurationValue.workspace?.override !== undefined) {\n\t\t\t\treturn ConfigurationTarget.WORKSPACE;\n\t\t\t}\n\t\t\tif (configurationValue.userRemote?.override !== undefined) {\n\t\t\t\treturn ConfigurationTarget.USER_REMOTE;\n\t\t\t}\n\t\t\tif (configurationValue.userLocal?.override !== undefined) {\n\t\t\t\treturn ConfigurationTarget.USER_LOCAL;\n\t\t\t}\n\t\t}\n\t\tif (configurationValue.memory?.value !== undefined) {\n\t\t\treturn ConfigurationTarget.MEMORY;\n\t\t}\n\t\tif (configurationValue.workspaceFolder?.value !== undefined) {\n\t\t\treturn ConfigurationTarget.WORKSPACE_FOLDER;\n\t\t}\n\t\tif (configurationValue.workspace?.value !== undefined) {\n\t\t\treturn ConfigurationTarget.WORKSPACE;\n\t\t}\n\t\tif (configurationValue.userRemote?.value !== undefined) {\n\t\t\treturn ConfigurationTarget.USER_REMOTE;\n\t\t}\n\t\treturn ConfigurationTarget.USER_LOCAL;\n\t}\n\n\tprivate _getValue<T>(resource: URI | undefined, position: IPosition | null, section: string | undefined): T {\n\t\tconst language = resource ? this.getLanguage(resource, position) : undefined;\n\t\tif (typeof section === 'undefined') {\n\t\t\treturn this.configurationService.getValue<T>({ resource, overrideIdentifier: language });\n\t\t}\n\t\treturn this.configurationService.getValue<T>(section, { resource, overrideIdentifier: language });\n\t}\n\n\tinspect<T>(resource: URI | undefined, position: IPosition | null, section: string): IConfigurationValue<Readonly<T>> {\n\t\tconst language = resource ? this.getLanguage(resource, position) : undefined;\n\t\treturn this.configurationService.inspect<T>(section, { resource, overrideIdentifier: language });\n\t}\n\n\tprivate getLanguage(resource: URI, position: IPosition | null): string | null {\n\t\tconst model = this.modelService.getModel(resource);\n\t\tif (model) {\n\t\t\treturn position ? model.getLanguageIdAtPosition(position.lineNumber, position.column) : model.getLanguageId();\n\t\t}\n\t\treturn this.languageService.guessLanguageIdByFilepathOrFirstLine(resource);\n\t}\n\n\tprivate toResourceConfigurationChangeEvent(configurationChangeEvent: IConfigurationChangeEvent): ITextResourceConfigurationChangeEvent {\n\t\treturn {\n\t\t\taffectedKeys: configurationChangeEvent.affectedKeys,\n\t\t\taffectsConfiguration: (resource: URI | undefined, configuration: string) => {\n\t\t\t\tconst overrideIdentifier = resource ? this.getLanguage(resource, null) : undefined;\n\t\t\t\treturn configurationChangeEvent.affectsConfiguration(configuration, { resource, overrideIdentifier });\n\t\t\t}\n\t\t};\n\t}\n}\n"],
  "mappings": "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",
  "names": []
}
