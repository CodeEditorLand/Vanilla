import{Iterable as d}from"../../../base/common/iterator.js";import{toDisposable as p}from"../../../base/common/lifecycle.js";import{LinkedList as c}from"../../../base/common/linkedList.js";const E="`~!@#$%^&*()-=+[{]}\\|;:'\",.<>/?";function R(e=""){let t="(-?\\d*\\.\\d\\w*)|([^";for(const n of E)e.indexOf(n)>=0||(t+="\\"+n);return t+="\\s]+)",new RegExp(t,"g")}const b=R();function f(e){let t=b;if(e&&e instanceof RegExp)if(e.global)t=e;else{let n="g";e.ignoreCase&&(n+="i"),e.multiline&&(n+="m"),e.unicode&&(n+="u"),t=new RegExp(e.source,n)}return t.lastIndex=0,t}const o=new c;o.unshift({maxLen:1e3,windowSize:15,timeBudget:150});function L(e){const t=o.unshift(e);return p(t)}function A(e,t,n,u,r){if(t=f(t),r||(r=d.first(o)),n.length>r.maxLen){let l=e-r.maxLen/2;return l<0?l=0:u+=l,n=n.substring(l,e+r.maxLen/2),A(e,t,n,u,r)}const s=Date.now(),g=e-1-u;let m=-1,a=null;for(let l=1;!(Date.now()-s>=r.timeBudget);l++){const x=g-r.windowSize*l;t.lastIndex=Math.max(0,x);const i=I(t,n,g,m);if(!i&&a||(a=i,x<=0))break;m=x}if(a){const l={word:a[0],startColumn:u+1+a.index,endColumn:u+1+a.index+a[0].length};return t.lastIndex=0,l}return null}function I(e,t,n,u){let r;for(;r=e.exec(t);){const s=r.index||0;if(s<=n&&e.lastIndex>=n)return r;if(u>0&&s>u)return null}return null}export{b as DEFAULT_WORD_REGEXP,E as USUAL_WORD_SEPARATORS,f as ensureValidWordDefinition,A as getWordAtText,L as setDefaultGetWordAtTextConfig};
