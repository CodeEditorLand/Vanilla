import{Color as m,HSLA as I}from"../../../base/common/color.js";import"../core/position.js";import"../core/range.js";import"../languages.js";function p(r){const e=[];for(const n of r){const a=Number(n);(a||a===0&&n.replace(/\s/g,"")!=="")&&e.push(a)}return e}function g(r,e,n,a){return{red:r/255,blue:n/255,green:e/255,alpha:a}}function f(r,e){const n=e.index,a=e[0].length;if(!n)return;const t=r.positionAt(n);return{startLineNumber:t.lineNumber,startColumn:t.column,endLineNumber:t.lineNumber,endColumn:t.column+a}}function C(r,e){if(!r)return;const n=m.Format.CSS.parseHex(e);if(n)return{range:r,color:g(n.rgba.r,n.rgba.g,n.rgba.b,n.rgba.a)}}function b(r,e,n){if(!r||e.length!==1)return;const t=e[0].values(),o=p(t);return{range:r,color:g(o[0],o[1],o[2],n?o[3]:1)}}function d(r,e,n){if(!r||e.length!==1)return;const t=e[0].values(),o=p(t),s=new m(new I(o[0],o[1]/100,o[2]/100,n?o[3]:1));return{range:r,color:g(s.rgba.r,s.rgba.g,s.rgba.b,s.rgba.a)}}function l(r,e){return typeof r=="string"?[...r.matchAll(e)]:r.findMatches(e)}function h(r){const e=[],a=l(r,/\b(rgb|rgba|hsl|hsla)(\([0-9\s,.\%]*\))|(#)([A-Fa-f0-9]{3})\b|(#)([A-Fa-f0-9]{4})\b|(#)([A-Fa-f0-9]{6})\b|(#)([A-Fa-f0-9]{8})\b/gm);if(a.length>0)for(const t of a){const o=t.filter(i=>i!==void 0),s=o[1],c=o[2];if(!c)continue;let u;if(s==="rgb"){const i=/^\(\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*\)$/gm;u=b(f(r,t),l(c,i),!1)}else if(s==="rgba"){const i=/^\(\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(0[.][0-9]+|[.][0-9]+|[01][.]|[01])\s*\)$/gm;u=b(f(r,t),l(c,i),!0)}else if(s==="hsl"){const i=/^\(\s*(36[0]|3[0-5][0-9]|[12][0-9][0-9]|[1-9]?[0-9])\s*,\s*(100|\d{1,2}[.]\d*|\d{1,2})%\s*,\s*(100|\d{1,2}[.]\d*|\d{1,2})%\s*\)$/gm;u=d(f(r,t),l(c,i),!1)}else if(s==="hsla"){const i=/^\(\s*(36[0]|3[0-5][0-9]|[12][0-9][0-9]|[1-9]?[0-9])\s*,\s*(100|\d{1,2}[.]\d*|\d{1,2})%\s*,\s*(100|\d{1,2}[.]\d*|\d{1,2})%\s*,\s*(0[.][0-9]+|[.][0-9]+|[01][.]|[01])\s*\)$/gm;u=d(f(r,t),l(c,i),!0)}else s==="#"&&(u=C(f(r,t),s+c));u&&e.push(u)}return e}function _(r){return!r||typeof r.getValue!="function"||typeof r.positionAt!="function"?[]:h(r)}export{_ as computeDefaultDocumentColors};
