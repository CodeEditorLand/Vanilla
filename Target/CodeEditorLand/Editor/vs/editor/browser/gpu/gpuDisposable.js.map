{
  "version": 3,
  "sources": ["../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/editor/browser/gpu/gpuDisposable.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport type { IReference } from \"../../../base/common/lifecycle.js\";\nimport { isFunction } from \"../../../base/common/types.js\";\n\nexport namespace GPULifecycle {\n\texport async function requestDevice(\n\t\tfallback?: (message: string) => void,\n\t): Promise<IReference<GPUDevice>> {\n\t\ttry {\n\t\t\tif (!navigator.gpu) {\n\t\t\t\tthrow new Error(\"This browser does not support WebGPU\");\n\t\t\t}\n\t\t\tconst adapter = (await navigator.gpu.requestAdapter())!;\n\t\t\tif (!adapter) {\n\t\t\t\tthrow new Error(\n\t\t\t\t\t\"This browser supports WebGPU but it appears to be disabled\",\n\t\t\t\t);\n\t\t\t}\n\t\t\treturn wrapDestroyableInDisposable(await adapter.requestDevice());\n\t\t} catch (e) {\n\t\t\tif (fallback) {\n\t\t\t\tfallback(e.message);\n\t\t\t}\n\t\t\tthrow e;\n\t\t}\n\t}\n\n\texport function createBuffer(\n\t\tdevice: GPUDevice,\n\t\tdescriptor: GPUBufferDescriptor,\n\t\tinitialValues?: Float32Array | (() => Float32Array),\n\t): IReference<GPUBuffer> {\n\t\tconst buffer = device.createBuffer(descriptor);\n\t\tif (initialValues) {\n\t\t\tdevice.queue.writeBuffer(\n\t\t\t\tbuffer,\n\t\t\t\t0,\n\t\t\t\tisFunction(initialValues) ? initialValues() : initialValues,\n\t\t\t);\n\t\t}\n\t\treturn wrapDestroyableInDisposable(buffer);\n\t}\n\n\texport function createTexture(\n\t\tdevice: GPUDevice,\n\t\tdescriptor: GPUTextureDescriptor,\n\t): IReference<GPUTexture> {\n\t\treturn wrapDestroyableInDisposable(device.createTexture(descriptor));\n\t}\n}\n\nfunction wrapDestroyableInDisposable<T extends { destroy(): void }>(\n\tvalue: T,\n): IReference<T> {\n\treturn {\n\t\tobject: value,\n\t\tdispose: () => value.destroy(),\n\t};\n}\n"],
  "mappings": ";;AAMA,SAAS,kBAAkB;AAEpB,IAAU;AAAA,CAAV,CAAUA,kBAAV;AACN,iBAAsB,cACrB,UACiC;AACjC,QAAI;AACH,UAAI,CAAC,UAAU,KAAK;AACnB,cAAM,IAAI,MAAM,sCAAsC;AAAA,MACvD;AACA,YAAM,UAAW,MAAM,UAAU,IAAI,eAAe;AACpD,UAAI,CAAC,SAAS;AACb,cAAM,IAAI;AAAA,UACT;AAAA,QACD;AAAA,MACD;AACA,aAAO,4BAA4B,MAAM,QAAQ,cAAc,CAAC;AAAA,IACjE,SAAS,GAAG;AACX,UAAI,UAAU;AACb,iBAAS,EAAE,OAAO;AAAA,MACnB;AACA,YAAM;AAAA,IACP;AAAA,EACD;AApBA,EAAAA,cAAsB;AAAA;AAsBf,WAAS,aACf,QACA,YACA,eACwB;AACxB,UAAM,SAAS,OAAO,aAAa,UAAU;AAC7C,QAAI,eAAe;AAClB,aAAO,MAAM;AAAA,QACZ;AAAA,QACA;AAAA,QACA,WAAW,aAAa,IAAI,cAAc,IAAI;AAAA,MAC/C;AAAA,IACD;AACA,WAAO,4BAA4B,MAAM;AAAA,EAC1C;AAdO,EAAAA,cAAS;AAAA;AAgBT,WAAS,cACf,QACA,YACyB;AACzB,WAAO,4BAA4B,OAAO,cAAc,UAAU,CAAC;AAAA,EACpE;AALO,EAAAA,cAAS;AAAA;AAAA,GAvCA;AA+CjB,SAAS,4BACR,OACgB;AAChB,SAAO;AAAA,IACN,QAAQ;AAAA,IACR,SAAS,6BAAM,MAAM,QAAQ,GAApB;AAAA,EACV;AACD;AAPS;",
  "names": ["GPULifecycle"]
}
