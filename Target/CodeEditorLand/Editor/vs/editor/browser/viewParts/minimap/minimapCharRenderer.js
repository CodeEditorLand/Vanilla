import{toUint8 as L}from"../../../../base/common/uint.js";import{Constants as s,getCharIndex as U}from"./minimapCharSheet.js";class S{constructor(t,a){this.scale=a;this.charDataNormal=S.soften(t,12/15),this.charDataLight=S.soften(t,50/60)}_minimapCharRendererBrand=void 0;charDataNormal;charDataLight;static soften(t,a){const n=new Uint8ClampedArray(t.length);for(let e=0,r=t.length;e<r;e++)n[e]=L(t[e]*a);return n}renderChar(t,a,n,e,r,i,m,f,u,y,B){const d=s.BASE_CHAR_WIDTH*this.scale,h=s.BASE_CHAR_HEIGHT*this.scale,b=B?1:h;if(a+d>t.width||n+b>t.height)return;const R=y?this.charDataLight:this.charDataNormal,C=U(e,u),H=t.width*s.RGBA_CHANNELS_CNT,G=m.r,g=m.g,p=m.b,D=r.r-G,E=r.g-g,w=r.b-p,l=Math.max(i,f),o=t.data;let N=C*d*h,c=n*H+a*s.RGBA_CHANNELS_CNT;for(let A=0;A<b;A++){let _=c;for(let T=0;T<d;T++){const I=R[N++]/255*(i/255);o[_++]=G+D*I,o[_++]=g+E*I,o[_++]=p+w*I,o[_++]=l}c+=H}}blockRenderChar(t,a,n,e,r,i,m,f){const u=s.BASE_CHAR_WIDTH*this.scale,y=s.BASE_CHAR_HEIGHT*this.scale,B=f?1:y;if(a+u>t.width||n+B>t.height)return;const d=t.width*s.RGBA_CHANNELS_CNT,h=.5*(r/255),b=i.r,R=i.g,C=i.b,H=e.r-b,G=e.g-R,g=e.b-C,p=b+H*h,D=R+G*h,E=C+g*h,w=Math.max(r,m),l=t.data;let o=n*d+a*s.RGBA_CHANNELS_CNT;for(let N=0;N<B;N++){let c=o;for(let A=0;A<u;A++)l[c++]=p,l[c++]=D,l[c++]=E,l[c++]=w;o+=d}}}export{S as MinimapCharRenderer};
