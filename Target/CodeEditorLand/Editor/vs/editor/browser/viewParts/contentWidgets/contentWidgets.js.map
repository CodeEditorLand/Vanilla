{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/editor/browser/viewParts/contentWidgets/contentWidgets.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as dom from '../../../../base/browser/dom.js';\nimport { FastDomNode, createFastDomNode } from '../../../../base/browser/fastDomNode.js';\nimport { ContentWidgetPositionPreference, IContentWidget } from '../../editorBrowser.js';\nimport { PartFingerprint, PartFingerprints, ViewPart } from '../../view/viewPart.js';\nimport { RenderingContext, RestrictedRenderingContext } from '../../view/renderingContext.js';\nimport { ViewContext } from '../../../common/viewModel/viewContext.js';\nimport * as viewEvents from '../../../common/viewEvents.js';\nimport { ViewportData } from '../../../common/viewLayout/viewLinesViewportData.js';\nimport { EditorOption } from '../../../common/config/editorOptions.js';\nimport { IDimension } from '../../../common/core/dimension.js';\nimport { PositionAffinity } from '../../../common/model.js';\nimport { IPosition, Position } from '../../../common/core/position.js';\nimport { IViewModel } from '../../../common/viewModel.js';\n\n/**\n * This view part is responsible for rendering the content widgets, which are\n * used for rendering elements that are associated to an editor position,\n * such as suggestions or the parameter hints.\n */\nexport class ViewContentWidgets extends ViewPart {\n\n\tprivate readonly _viewDomNode: FastDomNode<HTMLElement>;\n\tprivate _widgets: { [key: string]: Widget };\n\n\tpublic domNode: FastDomNode<HTMLElement>;\n\tpublic overflowingContentWidgetsDomNode: FastDomNode<HTMLElement>;\n\n\tconstructor(context: ViewContext, viewDomNode: FastDomNode<HTMLElement>) {\n\t\tsuper(context);\n\t\tthis._viewDomNode = viewDomNode;\n\t\tthis._widgets = {};\n\n\t\tthis.domNode = createFastDomNode(document.createElement('div'));\n\t\tPartFingerprints.write(this.domNode, PartFingerprint.ContentWidgets);\n\t\tthis.domNode.setClassName('contentWidgets');\n\t\tthis.domNode.setPosition('absolute');\n\t\tthis.domNode.setTop(0);\n\n\t\tthis.overflowingContentWidgetsDomNode = createFastDomNode(document.createElement('div'));\n\t\tPartFingerprints.write(this.overflowingContentWidgetsDomNode, PartFingerprint.OverflowingContentWidgets);\n\t\tthis.overflowingContentWidgetsDomNode.setClassName('overflowingContentWidgets');\n\t}\n\n\tpublic override dispose(): void {\n\t\tsuper.dispose();\n\t\tthis._widgets = {};\n\t}\n\n\t// --- begin event handlers\n\n\tpublic override onConfigurationChanged(e: viewEvents.ViewConfigurationChangedEvent): boolean {\n\t\tconst keys = Object.keys(this._widgets);\n\t\tfor (const widgetId of keys) {\n\t\t\tthis._widgets[widgetId].onConfigurationChanged(e);\n\t\t}\n\t\treturn true;\n\t}\n\tpublic override onDecorationsChanged(e: viewEvents.ViewDecorationsChangedEvent): boolean {\n\t\t// true for inline decorations that can end up relayouting text\n\t\treturn true;\n\t}\n\tpublic override onFlushed(e: viewEvents.ViewFlushedEvent): boolean {\n\t\treturn true;\n\t}\n\tpublic override onLineMappingChanged(e: viewEvents.ViewLineMappingChangedEvent): boolean {\n\t\tthis._updateAnchorsViewPositions();\n\t\treturn true;\n\t}\n\tpublic override onLinesChanged(e: viewEvents.ViewLinesChangedEvent): boolean {\n\t\tthis._updateAnchorsViewPositions();\n\t\treturn true;\n\t}\n\tpublic override onLinesDeleted(e: viewEvents.ViewLinesDeletedEvent): boolean {\n\t\tthis._updateAnchorsViewPositions();\n\t\treturn true;\n\t}\n\tpublic override onLinesInserted(e: viewEvents.ViewLinesInsertedEvent): boolean {\n\t\tthis._updateAnchorsViewPositions();\n\t\treturn true;\n\t}\n\tpublic override onScrollChanged(e: viewEvents.ViewScrollChangedEvent): boolean {\n\t\treturn true;\n\t}\n\tpublic override onZonesChanged(e: viewEvents.ViewZonesChangedEvent): boolean {\n\t\treturn true;\n\t}\n\n\t// ---- end view event handlers\n\n\tprivate _updateAnchorsViewPositions(): void {\n\t\tconst keys = Object.keys(this._widgets);\n\t\tfor (const widgetId of keys) {\n\t\t\tthis._widgets[widgetId].updateAnchorViewPosition();\n\t\t}\n\t}\n\n\tpublic addWidget(_widget: IContentWidget): void {\n\t\tconst myWidget = new Widget(this._context, this._viewDomNode, _widget);\n\t\tthis._widgets[myWidget.id] = myWidget;\n\n\t\tif (myWidget.allowEditorOverflow) {\n\t\t\tthis.overflowingContentWidgetsDomNode.appendChild(myWidget.domNode);\n\t\t} else {\n\t\t\tthis.domNode.appendChild(myWidget.domNode);\n\t\t}\n\n\t\tthis.setShouldRender();\n\t}\n\n\tpublic setWidgetPosition(widget: IContentWidget, primaryAnchor: IPosition | null, secondaryAnchor: IPosition | null, preference: ContentWidgetPositionPreference[] | null, affinity: PositionAffinity | null): void {\n\t\tconst myWidget = this._widgets[widget.getId()];\n\t\tmyWidget.setPosition(primaryAnchor, secondaryAnchor, preference, affinity);\n\n\t\tthis.setShouldRender();\n\t}\n\n\tpublic removeWidget(widget: IContentWidget): void {\n\t\tconst widgetId = widget.getId();\n\t\tif (this._widgets.hasOwnProperty(widgetId)) {\n\t\t\tconst myWidget = this._widgets[widgetId];\n\t\t\tdelete this._widgets[widgetId];\n\n\t\t\tconst domNode = myWidget.domNode.domNode;\n\t\t\tdomNode.remove();\n\t\t\tdomNode.removeAttribute('monaco-visible-content-widget');\n\n\t\t\tthis.setShouldRender();\n\t\t}\n\t}\n\n\tpublic shouldSuppressMouseDownOnWidget(widgetId: string): boolean {\n\t\tif (this._widgets.hasOwnProperty(widgetId)) {\n\t\t\treturn this._widgets[widgetId].suppressMouseDown;\n\t\t}\n\t\treturn false;\n\t}\n\n\tpublic onBeforeRender(viewportData: ViewportData): void {\n\t\tconst keys = Object.keys(this._widgets);\n\t\tfor (const widgetId of keys) {\n\t\t\tthis._widgets[widgetId].onBeforeRender(viewportData);\n\t\t}\n\t}\n\n\tpublic prepareRender(ctx: RenderingContext): void {\n\t\tconst keys = Object.keys(this._widgets);\n\t\tfor (const widgetId of keys) {\n\t\t\tthis._widgets[widgetId].prepareRender(ctx);\n\t\t}\n\t}\n\n\tpublic render(ctx: RestrictedRenderingContext): void {\n\t\tconst keys = Object.keys(this._widgets);\n\t\tfor (const widgetId of keys) {\n\t\t\tthis._widgets[widgetId].render(ctx);\n\t\t}\n\t}\n}\n\ninterface IBoxLayoutResult {\n\tfitsAbove: boolean;\n\taboveTop: number;\n\n\tfitsBelow: boolean;\n\tbelowTop: number;\n\n\tleft: number;\n}\n\ninterface IOffViewportRenderData {\n\tkind: 'offViewport';\n\tpreserveFocus: boolean;\n}\n\ninterface IInViewportRenderData {\n\tkind: 'inViewport';\n\tcoordinate: Coordinate;\n\tposition: ContentWidgetPositionPreference;\n}\n\ntype IRenderData = IInViewportRenderData | IOffViewportRenderData;\n\nclass Widget {\n\tprivate readonly _context: ViewContext;\n\tprivate readonly _viewDomNode: FastDomNode<HTMLElement>;\n\tprivate readonly _actual: IContentWidget;\n\n\tpublic readonly domNode: FastDomNode<HTMLElement>;\n\tpublic readonly id: string;\n\tpublic readonly allowEditorOverflow: boolean;\n\tpublic readonly suppressMouseDown: boolean;\n\n\tprivate readonly _fixedOverflowWidgets: boolean;\n\tprivate _contentWidth: number;\n\tprivate _contentLeft: number;\n\tprivate _lineHeight: number;\n\n\tprivate _primaryAnchor: PositionPair = new PositionPair(null, null);\n\tprivate _secondaryAnchor: PositionPair = new PositionPair(null, null);\n\tprivate _affinity: PositionAffinity | null;\n\tprivate _preference: ContentWidgetPositionPreference[] | null;\n\tprivate _cachedDomNodeOffsetWidth: number;\n\tprivate _cachedDomNodeOffsetHeight: number;\n\tprivate _maxWidth: number;\n\tprivate _isVisible: boolean;\n\n\tprivate _renderData: IRenderData | null;\n\n\tconstructor(context: ViewContext, viewDomNode: FastDomNode<HTMLElement>, actual: IContentWidget) {\n\t\tthis._context = context;\n\t\tthis._viewDomNode = viewDomNode;\n\t\tthis._actual = actual;\n\n\t\tthis.domNode = createFastDomNode(this._actual.getDomNode());\n\t\tthis.id = this._actual.getId();\n\t\tthis.allowEditorOverflow = this._actual.allowEditorOverflow || false;\n\t\tthis.suppressMouseDown = this._actual.suppressMouseDown || false;\n\n\t\tconst options = this._context.configuration.options;\n\t\tconst layoutInfo = options.get(EditorOption.layoutInfo);\n\n\t\tthis._fixedOverflowWidgets = options.get(EditorOption.fixedOverflowWidgets);\n\t\tthis._contentWidth = layoutInfo.contentWidth;\n\t\tthis._contentLeft = layoutInfo.contentLeft;\n\t\tthis._lineHeight = options.get(EditorOption.lineHeight);\n\n\t\tthis._affinity = null;\n\t\tthis._preference = [];\n\t\tthis._cachedDomNodeOffsetWidth = -1;\n\t\tthis._cachedDomNodeOffsetHeight = -1;\n\t\tthis._maxWidth = this._getMaxWidth();\n\t\tthis._isVisible = false;\n\t\tthis._renderData = null;\n\n\t\tthis.domNode.setPosition((this._fixedOverflowWidgets && this.allowEditorOverflow) ? 'fixed' : 'absolute');\n\t\tthis.domNode.setDisplay('none');\n\t\tthis.domNode.setVisibility('hidden');\n\t\tthis.domNode.setAttribute('widgetId', this.id);\n\t\tthis.domNode.setMaxWidth(this._maxWidth);\n\t}\n\n\tpublic onConfigurationChanged(e: viewEvents.ViewConfigurationChangedEvent): void {\n\t\tconst options = this._context.configuration.options;\n\t\tthis._lineHeight = options.get(EditorOption.lineHeight);\n\t\tif (e.hasChanged(EditorOption.layoutInfo)) {\n\t\t\tconst layoutInfo = options.get(EditorOption.layoutInfo);\n\t\t\tthis._contentLeft = layoutInfo.contentLeft;\n\t\t\tthis._contentWidth = layoutInfo.contentWidth;\n\t\t\tthis._maxWidth = this._getMaxWidth();\n\t\t}\n\t}\n\n\tpublic updateAnchorViewPosition(): void {\n\t\tthis._setPosition(this._affinity, this._primaryAnchor.modelPosition, this._secondaryAnchor.modelPosition);\n\t}\n\n\tprivate _setPosition(affinity: PositionAffinity | null, primaryAnchor: IPosition | null, secondaryAnchor: IPosition | null): void {\n\t\tthis._affinity = affinity;\n\t\tthis._primaryAnchor = getValidPositionPair(primaryAnchor, this._context.viewModel, this._affinity);\n\t\tthis._secondaryAnchor = getValidPositionPair(secondaryAnchor, this._context.viewModel, this._affinity);\n\n\t\tfunction getValidPositionPair(position: IPosition | null, viewModel: IViewModel, affinity: PositionAffinity | null): PositionPair {\n\t\t\tif (!position) {\n\t\t\t\treturn new PositionPair(null, null);\n\t\t\t}\n\t\t\t// Do not trust that widgets give a valid position\n\t\t\tconst validModelPosition = viewModel.model.validatePosition(position);\n\t\t\tif (viewModel.coordinatesConverter.modelPositionIsVisible(validModelPosition)) {\n\t\t\t\tconst viewPosition = viewModel.coordinatesConverter.convertModelPositionToViewPosition(validModelPosition, affinity ?? undefined);\n\t\t\t\treturn new PositionPair(position, viewPosition);\n\t\t\t}\n\t\t\treturn new PositionPair(position, null);\n\t\t}\n\t}\n\n\tprivate _getMaxWidth(): number {\n\t\tconst elDocument = this.domNode.domNode.ownerDocument;\n\t\tconst elWindow = elDocument.defaultView;\n\t\treturn (\n\t\t\tthis.allowEditorOverflow\n\t\t\t\t? elWindow?.innerWidth || elDocument.documentElement.offsetWidth || elDocument.body.offsetWidth\n\t\t\t\t: this._contentWidth\n\t\t);\n\t}\n\n\tpublic setPosition(primaryAnchor: IPosition | null, secondaryAnchor: IPosition | null, preference: ContentWidgetPositionPreference[] | null, affinity: PositionAffinity | null): void {\n\t\tthis._setPosition(affinity, primaryAnchor, secondaryAnchor);\n\t\tthis._preference = preference;\n\t\tif (this._primaryAnchor.viewPosition && this._preference && this._preference.length > 0) {\n\t\t\t// this content widget would like to be visible if possible\n\t\t\t// we change it from `display:none` to `display:block` even if it\n\t\t\t// might be outside the viewport such that we can measure its size\n\t\t\t// in `prepareRender`\n\t\t\tthis.domNode.setDisplay('block');\n\t\t} else {\n\t\t\tthis.domNode.setDisplay('none');\n\t\t}\n\t\tthis._cachedDomNodeOffsetWidth = -1;\n\t\tthis._cachedDomNodeOffsetHeight = -1;\n\t}\n\n\tprivate _layoutBoxInViewport(anchor: AnchorCoordinate, width: number, height: number, ctx: RenderingContext): IBoxLayoutResult {\n\t\t// Our visible box is split horizontally by the current line => 2 boxes\n\n\t\t// a) the box above the line\n\t\tconst aboveLineTop = anchor.top;\n\t\tconst heightAvailableAboveLine = aboveLineTop;\n\n\t\t// b) the box under the line\n\t\tconst underLineTop = anchor.top + anchor.height;\n\t\tconst heightAvailableUnderLine = ctx.viewportHeight - underLineTop;\n\n\t\tconst aboveTop = aboveLineTop - height;\n\t\tconst fitsAbove = (heightAvailableAboveLine >= height);\n\t\tconst belowTop = underLineTop;\n\t\tconst fitsBelow = (heightAvailableUnderLine >= height);\n\n\t\t// And its left\n\t\tlet left = anchor.left;\n\t\tif (left + width > ctx.scrollLeft + ctx.viewportWidth) {\n\t\t\tleft = ctx.scrollLeft + ctx.viewportWidth - width;\n\t\t}\n\t\tif (left < ctx.scrollLeft) {\n\t\t\tleft = ctx.scrollLeft;\n\t\t}\n\n\t\treturn { fitsAbove, aboveTop, fitsBelow, belowTop, left };\n\t}\n\n\tprivate _layoutHorizontalSegmentInPage(windowSize: dom.Dimension, domNodePosition: dom.IDomNodePagePosition, left: number, width: number): [number, number] {\n\t\t// Leave some clearance to the left/right\n\t\tconst LEFT_PADDING = 15;\n\t\tconst RIGHT_PADDING = 15;\n\n\t\t// Initially, the limits are defined as the dom node limits\n\t\tconst MIN_LIMIT = Math.max(LEFT_PADDING, domNodePosition.left - width);\n\t\tconst MAX_LIMIT = Math.min(domNodePosition.left + domNodePosition.width + width, windowSize.width - RIGHT_PADDING);\n\n\t\tconst elDocument = this._viewDomNode.domNode.ownerDocument;\n\t\tconst elWindow = elDocument.defaultView;\n\t\tlet absoluteLeft = domNodePosition.left + left - (elWindow?.scrollX ?? 0);\n\n\t\tif (absoluteLeft + width > MAX_LIMIT) {\n\t\t\tconst delta = absoluteLeft - (MAX_LIMIT - width);\n\t\t\tabsoluteLeft -= delta;\n\t\t\tleft -= delta;\n\t\t}\n\n\t\tif (absoluteLeft < MIN_LIMIT) {\n\t\t\tconst delta = absoluteLeft - MIN_LIMIT;\n\t\t\tabsoluteLeft -= delta;\n\t\t\tleft -= delta;\n\t\t}\n\n\t\treturn [left, absoluteLeft];\n\t}\n\n\tprivate _layoutBoxInPage(anchor: AnchorCoordinate, width: number, height: number, ctx: RenderingContext): IBoxLayoutResult | null {\n\t\tconst aboveTop = anchor.top - height;\n\t\tconst belowTop = anchor.top + anchor.height;\n\n\t\tconst domNodePosition = dom.getDomNodePagePosition(this._viewDomNode.domNode);\n\t\tconst elDocument = this._viewDomNode.domNode.ownerDocument;\n\t\tconst elWindow = elDocument.defaultView;\n\t\tconst absoluteAboveTop = domNodePosition.top + aboveTop - (elWindow?.scrollY ?? 0);\n\t\tconst absoluteBelowTop = domNodePosition.top + belowTop - (elWindow?.scrollY ?? 0);\n\n\t\tconst windowSize = dom.getClientArea(elDocument.body);\n\t\tconst [left, absoluteAboveLeft] = this._layoutHorizontalSegmentInPage(windowSize, domNodePosition, anchor.left - ctx.scrollLeft + this._contentLeft, width);\n\n\t\t// Leave some clearance to the top/bottom\n\t\tconst TOP_PADDING = 22;\n\t\tconst BOTTOM_PADDING = 22;\n\n\t\tconst fitsAbove = (absoluteAboveTop >= TOP_PADDING);\n\t\tconst fitsBelow = (absoluteBelowTop + height <= windowSize.height - BOTTOM_PADDING);\n\n\t\tif (this._fixedOverflowWidgets) {\n\t\t\treturn {\n\t\t\t\tfitsAbove,\n\t\t\t\taboveTop: Math.max(absoluteAboveTop, TOP_PADDING),\n\t\t\t\tfitsBelow,\n\t\t\t\tbelowTop: absoluteBelowTop,\n\t\t\t\tleft: absoluteAboveLeft\n\t\t\t};\n\t\t}\n\n\t\treturn { fitsAbove, aboveTop, fitsBelow, belowTop, left };\n\t}\n\n\tprivate _prepareRenderWidgetAtExactPositionOverflowing(topLeft: Coordinate): Coordinate {\n\t\treturn new Coordinate(topLeft.top, topLeft.left + this._contentLeft);\n\t}\n\n\t/**\n\t * Compute the coordinates above and below the primary and secondary anchors.\n\t * The content widget *must* touch the primary anchor.\n\t * The content widget should touch if possible the secondary anchor.\n\t */\n\tprivate _getAnchorsCoordinates(ctx: RenderingContext): { primary: AnchorCoordinate | null; secondary: AnchorCoordinate | null } {\n\t\tconst primary = getCoordinates(this._primaryAnchor.viewPosition, this._affinity, this._lineHeight);\n\t\tconst secondaryViewPosition = (this._secondaryAnchor.viewPosition?.lineNumber === this._primaryAnchor.viewPosition?.lineNumber ? this._secondaryAnchor.viewPosition : null);\n\t\tconst secondary = getCoordinates(secondaryViewPosition, this._affinity, this._lineHeight);\n\t\treturn { primary, secondary };\n\n\t\tfunction getCoordinates(position: Position | null, affinity: PositionAffinity | null, lineHeight: number): AnchorCoordinate | null {\n\t\t\tif (!position) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tconst horizontalPosition = ctx.visibleRangeForPosition(position);\n\t\t\tif (!horizontalPosition) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\t// Left-align widgets that should appear :before content\n\t\t\tconst left = (position.column === 1 && affinity === PositionAffinity.LeftOfInjectedText ? 0 : horizontalPosition.left);\n\t\t\tconst top = ctx.getVerticalOffsetForLineNumber(position.lineNumber) - ctx.scrollTop;\n\t\t\treturn new AnchorCoordinate(top, left, lineHeight);\n\t\t}\n\t}\n\n\tprivate _reduceAnchorCoordinates(primary: AnchorCoordinate, secondary: AnchorCoordinate | null, width: number): AnchorCoordinate {\n\t\tif (!secondary) {\n\t\t\treturn primary;\n\t\t}\n\n\t\tconst fontInfo = this._context.configuration.options.get(EditorOption.fontInfo);\n\n\t\tlet left = secondary.left;\n\t\tif (left < primary.left) {\n\t\t\tleft = Math.max(left, primary.left - width + fontInfo.typicalFullwidthCharacterWidth);\n\t\t} else {\n\t\t\tleft = Math.min(left, primary.left + width - fontInfo.typicalFullwidthCharacterWidth);\n\t\t}\n\t\treturn new AnchorCoordinate(primary.top, left, primary.height);\n\t}\n\n\tprivate _prepareRenderWidget(ctx: RenderingContext): IRenderData | null {\n\t\tif (!this._preference || this._preference.length === 0) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst { primary, secondary } = this._getAnchorsCoordinates(ctx);\n\t\tif (!primary) {\n\t\t\treturn {\n\t\t\t\tkind: 'offViewport',\n\t\t\t\tpreserveFocus: this.domNode.domNode.contains(this.domNode.domNode.ownerDocument.activeElement)\n\t\t\t};\n\t\t\t// return null;\n\t\t}\n\n\t\tif (this._cachedDomNodeOffsetWidth === -1 || this._cachedDomNodeOffsetHeight === -1) {\n\n\t\t\tlet preferredDimensions: IDimension | null = null;\n\t\t\tif (typeof this._actual.beforeRender === 'function') {\n\t\t\t\tpreferredDimensions = safeInvoke(this._actual.beforeRender, this._actual);\n\t\t\t}\n\t\t\tif (preferredDimensions) {\n\t\t\t\tthis._cachedDomNodeOffsetWidth = preferredDimensions.width;\n\t\t\t\tthis._cachedDomNodeOffsetHeight = preferredDimensions.height;\n\t\t\t} else {\n\t\t\t\tconst domNode = this.domNode.domNode;\n\t\t\t\tconst clientRect = domNode.getBoundingClientRect();\n\t\t\t\tthis._cachedDomNodeOffsetWidth = Math.round(clientRect.width);\n\t\t\t\tthis._cachedDomNodeOffsetHeight = Math.round(clientRect.height);\n\t\t\t}\n\t\t}\n\n\t\tconst anchor = this._reduceAnchorCoordinates(primary, secondary, this._cachedDomNodeOffsetWidth);\n\n\t\tlet placement: IBoxLayoutResult | null;\n\t\tif (this.allowEditorOverflow) {\n\t\t\tplacement = this._layoutBoxInPage(anchor, this._cachedDomNodeOffsetWidth, this._cachedDomNodeOffsetHeight, ctx);\n\t\t} else {\n\t\t\tplacement = this._layoutBoxInViewport(anchor, this._cachedDomNodeOffsetWidth, this._cachedDomNodeOffsetHeight, ctx);\n\t\t}\n\n\t\t// Do two passes, first for perfect fit, second picks first option\n\t\tfor (let pass = 1; pass <= 2; pass++) {\n\t\t\tfor (const pref of this._preference) {\n\t\t\t\t// placement\n\t\t\t\tif (pref === ContentWidgetPositionPreference.ABOVE) {\n\t\t\t\t\tif (!placement) {\n\t\t\t\t\t\t// Widget outside of viewport\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\t\t\t\t\tif (pass === 2 || placement.fitsAbove) {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tkind: 'inViewport',\n\t\t\t\t\t\t\tcoordinate: new Coordinate(placement.aboveTop, placement.left),\n\t\t\t\t\t\t\tposition: ContentWidgetPositionPreference.ABOVE\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t} else if (pref === ContentWidgetPositionPreference.BELOW) {\n\t\t\t\t\tif (!placement) {\n\t\t\t\t\t\t// Widget outside of viewport\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\t\t\t\t\tif (pass === 2 || placement.fitsBelow) {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tkind: 'inViewport',\n\t\t\t\t\t\t\tcoordinate: new Coordinate(placement.belowTop, placement.left),\n\t\t\t\t\t\t\tposition: ContentWidgetPositionPreference.BELOW\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (this.allowEditorOverflow) {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tkind: 'inViewport',\n\t\t\t\t\t\t\tcoordinate: this._prepareRenderWidgetAtExactPositionOverflowing(new Coordinate(anchor.top, anchor.left)),\n\t\t\t\t\t\t\tposition: ContentWidgetPositionPreference.EXACT\n\t\t\t\t\t\t};\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tkind: 'inViewport',\n\t\t\t\t\t\t\tcoordinate: new Coordinate(anchor.top, anchor.left),\n\t\t\t\t\t\t\tposition: ContentWidgetPositionPreference.EXACT\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t/**\n\t * On this first pass, we ensure that the content widget (if it is in the viewport) has the max width set correctly.\n\t */\n\tpublic onBeforeRender(viewportData: ViewportData): void {\n\t\tif (!this._primaryAnchor.viewPosition || !this._preference) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._primaryAnchor.viewPosition.lineNumber < viewportData.startLineNumber || this._primaryAnchor.viewPosition.lineNumber > viewportData.endLineNumber) {\n\t\t\t// Outside of viewport\n\t\t\treturn;\n\t\t}\n\n\t\tthis.domNode.setMaxWidth(this._maxWidth);\n\t}\n\n\tpublic prepareRender(ctx: RenderingContext): void {\n\t\tthis._renderData = this._prepareRenderWidget(ctx);\n\t}\n\n\tpublic render(ctx: RestrictedRenderingContext): void {\n\t\tif (!this._renderData || this._renderData.kind === 'offViewport') {\n\t\t\t// This widget should be invisible\n\t\t\tif (this._isVisible) {\n\t\t\t\tthis.domNode.removeAttribute('monaco-visible-content-widget');\n\t\t\t\tthis._isVisible = false;\n\n\t\t\t\tif (this._renderData?.kind === 'offViewport' && this._renderData.preserveFocus) {\n\t\t\t\t\t// widget wants to be shown, but it is outside of the viewport and it\n\t\t\t\t\t// has focus which we need to preserve\n\t\t\t\t\tthis.domNode.setTop(-1000);\n\t\t\t\t} else {\n\t\t\t\t\tthis.domNode.setVisibility('hidden');\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (typeof this._actual.afterRender === 'function') {\n\t\t\t\tsafeInvoke(this._actual.afterRender, this._actual, null);\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\t// This widget should be visible\n\t\tif (this.allowEditorOverflow) {\n\t\t\tthis.domNode.setTop(this._renderData.coordinate.top);\n\t\t\tthis.domNode.setLeft(this._renderData.coordinate.left);\n\t\t} else {\n\t\t\tthis.domNode.setTop(this._renderData.coordinate.top + ctx.scrollTop - ctx.bigNumbersDelta);\n\t\t\tthis.domNode.setLeft(this._renderData.coordinate.left);\n\t\t}\n\n\t\tif (!this._isVisible) {\n\t\t\tthis.domNode.setVisibility('inherit');\n\t\t\tthis.domNode.setAttribute('monaco-visible-content-widget', 'true');\n\t\t\tthis._isVisible = true;\n\t\t}\n\n\t\tif (typeof this._actual.afterRender === 'function') {\n\t\t\tsafeInvoke(this._actual.afterRender, this._actual, this._renderData.position);\n\t\t}\n\t}\n}\n\nclass PositionPair {\n\tconstructor(\n\t\tpublic readonly modelPosition: IPosition | null,\n\t\tpublic readonly viewPosition: Position | null\n\t) { }\n}\n\nclass Coordinate {\n\t_coordinateBrand: void = undefined;\n\n\tconstructor(\n\t\tpublic readonly top: number,\n\t\tpublic readonly left: number\n\t) { }\n}\n\nclass AnchorCoordinate {\n\t_anchorCoordinateBrand: void = undefined;\n\n\tconstructor(\n\t\tpublic readonly top: number,\n\t\tpublic readonly left: number,\n\t\tpublic readonly height: number\n\t) { }\n}\n\nfunction safeInvoke<T extends (...args: any[]) => any>(fn: T, thisArg: ThisParameterType<T>, ...args: Parameters<T>): ReturnType<T> | null {\n\ttry {\n\t\treturn fn.call(thisArg, ...args);\n\t} catch {\n\t\t// ignore\n\t\treturn null;\n\t}\n}\n"],
  "mappings": "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",
  "names": ["affinity"]
}
