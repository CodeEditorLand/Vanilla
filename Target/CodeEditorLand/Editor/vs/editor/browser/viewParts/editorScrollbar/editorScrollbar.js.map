{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/editor/browser/viewParts/editorScrollbar/editorScrollbar.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as dom from \"../../../../base/browser/dom.js\";\nimport {\n\ttype FastDomNode,\n\tcreateFastDomNode,\n} from \"../../../../base/browser/fastDomNode.js\";\nimport type { IMouseWheelEvent } from \"../../../../base/browser/mouseEvent.js\";\nimport {\n\ttype IOverviewRulerLayoutInfo,\n\tSmoothScrollableElement,\n} from \"../../../../base/browser/ui/scrollbar/scrollableElement.js\";\nimport type {\n\tScrollableElementChangeOptions,\n\tScrollableElementCreationOptions,\n} from \"../../../../base/browser/ui/scrollbar/scrollableElementOptions.js\";\nimport { getThemeTypeSelector } from \"../../../../platform/theme/common/themeService.js\";\nimport { EditorOption } from \"../../../common/config/editorOptions.js\";\nimport {\n\ttype INewScrollPosition,\n\tScrollType,\n} from \"../../../common/editorCommon.js\";\nimport type * as viewEvents from \"../../../common/viewEvents.js\";\nimport type { ViewContext } from \"../../../common/viewModel/viewContext.js\";\nimport type {\n\tRenderingContext,\n\tRestrictedRenderingContext,\n} from \"../../view/renderingContext.js\";\nimport {\n\tPartFingerprint,\n\tPartFingerprints,\n\tViewPart,\n} from \"../../view/viewPart.js\";\n\n/**\n * The editor scrollbar built on VS Code's scrollable element that sits beside\n * the minimap.\n */\nexport class EditorScrollbar extends ViewPart {\n\tprivate readonly scrollbar: SmoothScrollableElement;\n\tprivate readonly scrollbarDomNode: FastDomNode<HTMLElement>;\n\n\tconstructor(\n\t\tcontext: ViewContext,\n\t\tlinesContent: FastDomNode<HTMLElement>,\n\t\tviewDomNode: FastDomNode<HTMLElement>,\n\t\toverflowGuardDomNode: FastDomNode<HTMLElement>,\n\t) {\n\t\tsuper(context);\n\n\t\tconst options = this._context.configuration.options;\n\t\tconst scrollbar = options.get(EditorOption.scrollbar);\n\t\tconst mouseWheelScrollSensitivity = options.get(\n\t\t\tEditorOption.mouseWheelScrollSensitivity,\n\t\t);\n\t\tconst fastScrollSensitivity = options.get(\n\t\t\tEditorOption.fastScrollSensitivity,\n\t\t);\n\t\tconst scrollPredominantAxis = options.get(\n\t\t\tEditorOption.scrollPredominantAxis,\n\t\t);\n\n\t\tconst scrollbarOptions: ScrollableElementCreationOptions = {\n\t\t\tlistenOnDomNode: viewDomNode.domNode,\n\t\t\tclassName:\n\t\t\t\t\"editor-scrollable\" +\n\t\t\t\t\" \" +\n\t\t\t\tgetThemeTypeSelector(context.theme.type),\n\t\t\tuseShadows: false,\n\t\t\tlazyRender: true,\n\n\t\t\tvertical: scrollbar.vertical,\n\t\t\thorizontal: scrollbar.horizontal,\n\t\t\tverticalHasArrows: scrollbar.verticalHasArrows,\n\t\t\thorizontalHasArrows: scrollbar.horizontalHasArrows,\n\t\t\tverticalScrollbarSize: scrollbar.verticalScrollbarSize,\n\t\t\tverticalSliderSize: scrollbar.verticalSliderSize,\n\t\t\thorizontalScrollbarSize: scrollbar.horizontalScrollbarSize,\n\t\t\thorizontalSliderSize: scrollbar.horizontalSliderSize,\n\t\t\thandleMouseWheel: scrollbar.handleMouseWheel,\n\t\t\talwaysConsumeMouseWheel: scrollbar.alwaysConsumeMouseWheel,\n\t\t\tarrowSize: scrollbar.arrowSize,\n\t\t\tmouseWheelScrollSensitivity: mouseWheelScrollSensitivity,\n\t\t\tfastScrollSensitivity: fastScrollSensitivity,\n\t\t\tscrollPredominantAxis: scrollPredominantAxis,\n\t\t\tscrollByPage: scrollbar.scrollByPage,\n\t\t};\n\n\t\tthis.scrollbar = this._register(\n\t\t\tnew SmoothScrollableElement(\n\t\t\t\tlinesContent.domNode,\n\t\t\t\tscrollbarOptions,\n\t\t\t\tthis._context.viewLayout.getScrollable(),\n\t\t\t),\n\t\t);\n\t\tPartFingerprints.write(\n\t\t\tthis.scrollbar.getDomNode(),\n\t\t\tPartFingerprint.ScrollableElement,\n\t\t);\n\n\t\tthis.scrollbarDomNode = createFastDomNode(this.scrollbar.getDomNode());\n\t\tthis.scrollbarDomNode.setPosition(\"absolute\");\n\t\tthis._setLayout();\n\n\t\t// When having a zone widget that calls .focus() on one of its dom elements,\n\t\t// the browser will try desperately to reveal that dom node, unexpectedly\n\t\t// changing the .scrollTop of this.linesContent\n\n\t\tconst onBrowserDesperateReveal = (\n\t\t\tdomNode: HTMLElement,\n\t\t\tlookAtScrollTop: boolean,\n\t\t\tlookAtScrollLeft: boolean,\n\t\t) => {\n\t\t\tconst newScrollPosition: INewScrollPosition = {};\n\n\t\t\tif (lookAtScrollTop) {\n\t\t\t\tconst deltaTop = domNode.scrollTop;\n\t\t\t\tif (deltaTop) {\n\t\t\t\t\tnewScrollPosition.scrollTop =\n\t\t\t\t\t\tthis._context.viewLayout.getCurrentScrollTop() +\n\t\t\t\t\t\tdeltaTop;\n\t\t\t\t\tdomNode.scrollTop = 0;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (lookAtScrollLeft) {\n\t\t\t\tconst deltaLeft = domNode.scrollLeft;\n\t\t\t\tif (deltaLeft) {\n\t\t\t\t\tnewScrollPosition.scrollLeft =\n\t\t\t\t\t\tthis._context.viewLayout.getCurrentScrollLeft() +\n\t\t\t\t\t\tdeltaLeft;\n\t\t\t\t\tdomNode.scrollLeft = 0;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis._context.viewModel.viewLayout.setScrollPosition(\n\t\t\t\tnewScrollPosition,\n\t\t\t\tScrollType.Immediate,\n\t\t\t);\n\t\t};\n\n\t\t// I've seen this happen both on the view dom node & on the lines content dom node.\n\t\tthis._register(\n\t\t\tdom.addDisposableListener(\n\t\t\t\tviewDomNode.domNode,\n\t\t\t\t\"scroll\",\n\t\t\t\t(e: Event) =>\n\t\t\t\t\tonBrowserDesperateReveal(viewDomNode.domNode, true, true),\n\t\t\t),\n\t\t);\n\t\tthis._register(\n\t\t\tdom.addDisposableListener(\n\t\t\t\tlinesContent.domNode,\n\t\t\t\t\"scroll\",\n\t\t\t\t(e: Event) =>\n\t\t\t\t\tonBrowserDesperateReveal(linesContent.domNode, true, false),\n\t\t\t),\n\t\t);\n\t\tthis._register(\n\t\t\tdom.addDisposableListener(\n\t\t\t\toverflowGuardDomNode.domNode,\n\t\t\t\t\"scroll\",\n\t\t\t\t(e: Event) =>\n\t\t\t\t\tonBrowserDesperateReveal(\n\t\t\t\t\t\toverflowGuardDomNode.domNode,\n\t\t\t\t\t\ttrue,\n\t\t\t\t\t\tfalse,\n\t\t\t\t\t),\n\t\t\t),\n\t\t);\n\t\tthis._register(\n\t\t\tdom.addDisposableListener(\n\t\t\t\tthis.scrollbarDomNode.domNode,\n\t\t\t\t\"scroll\",\n\t\t\t\t(e: Event) =>\n\t\t\t\t\tonBrowserDesperateReveal(\n\t\t\t\t\t\tthis.scrollbarDomNode.domNode,\n\t\t\t\t\t\ttrue,\n\t\t\t\t\t\tfalse,\n\t\t\t\t\t),\n\t\t\t),\n\t\t);\n\t}\n\n\tpublic override dispose(): void {\n\t\tsuper.dispose();\n\t}\n\n\tprivate _setLayout(): void {\n\t\tconst options = this._context.configuration.options;\n\t\tconst layoutInfo = options.get(EditorOption.layoutInfo);\n\n\t\tthis.scrollbarDomNode.setLeft(layoutInfo.contentLeft);\n\n\t\tconst minimap = options.get(EditorOption.minimap);\n\t\tconst side = minimap.side;\n\t\tif (side === \"right\") {\n\t\t\tthis.scrollbarDomNode.setWidth(\n\t\t\t\tlayoutInfo.contentWidth + layoutInfo.minimap.minimapWidth,\n\t\t\t);\n\t\t} else {\n\t\t\tthis.scrollbarDomNode.setWidth(layoutInfo.contentWidth);\n\t\t}\n\t\tthis.scrollbarDomNode.setHeight(layoutInfo.height);\n\t}\n\n\tpublic getOverviewRulerLayoutInfo(): IOverviewRulerLayoutInfo {\n\t\treturn this.scrollbar.getOverviewRulerLayoutInfo();\n\t}\n\n\tpublic getDomNode(): FastDomNode<HTMLElement> {\n\t\treturn this.scrollbarDomNode;\n\t}\n\n\tpublic delegateVerticalScrollbarPointerDown(\n\t\tbrowserEvent: PointerEvent,\n\t): void {\n\t\tthis.scrollbar.delegateVerticalScrollbarPointerDown(browserEvent);\n\t}\n\n\tpublic delegateScrollFromMouseWheelEvent(browserEvent: IMouseWheelEvent) {\n\t\tthis.scrollbar.delegateScrollFromMouseWheelEvent(browserEvent);\n\t}\n\n\t// --- begin event handlers\n\n\tpublic override onConfigurationChanged(\n\t\te: viewEvents.ViewConfigurationChangedEvent,\n\t): boolean {\n\t\tif (\n\t\t\te.hasChanged(EditorOption.scrollbar) ||\n\t\t\te.hasChanged(EditorOption.mouseWheelScrollSensitivity) ||\n\t\t\te.hasChanged(EditorOption.fastScrollSensitivity)\n\t\t) {\n\t\t\tconst options = this._context.configuration.options;\n\t\t\tconst scrollbar = options.get(EditorOption.scrollbar);\n\t\t\tconst mouseWheelScrollSensitivity = options.get(\n\t\t\t\tEditorOption.mouseWheelScrollSensitivity,\n\t\t\t);\n\t\t\tconst fastScrollSensitivity = options.get(\n\t\t\t\tEditorOption.fastScrollSensitivity,\n\t\t\t);\n\t\t\tconst scrollPredominantAxis = options.get(\n\t\t\t\tEditorOption.scrollPredominantAxis,\n\t\t\t);\n\t\t\tconst newOpts: ScrollableElementChangeOptions = {\n\t\t\t\tvertical: scrollbar.vertical,\n\t\t\t\thorizontal: scrollbar.horizontal,\n\t\t\t\tverticalScrollbarSize: scrollbar.verticalScrollbarSize,\n\t\t\t\thorizontalScrollbarSize: scrollbar.horizontalScrollbarSize,\n\t\t\t\tscrollByPage: scrollbar.scrollByPage,\n\t\t\t\thandleMouseWheel: scrollbar.handleMouseWheel,\n\t\t\t\tmouseWheelScrollSensitivity: mouseWheelScrollSensitivity,\n\t\t\t\tfastScrollSensitivity: fastScrollSensitivity,\n\t\t\t\tscrollPredominantAxis: scrollPredominantAxis,\n\t\t\t};\n\t\t\tthis.scrollbar.updateOptions(newOpts);\n\t\t}\n\t\tif (e.hasChanged(EditorOption.layoutInfo)) {\n\t\t\tthis._setLayout();\n\t\t}\n\t\treturn true;\n\t}\n\tpublic override onScrollChanged(\n\t\te: viewEvents.ViewScrollChangedEvent,\n\t): boolean {\n\t\treturn true;\n\t}\n\tpublic override onThemeChanged(\n\t\te: viewEvents.ViewThemeChangedEvent,\n\t): boolean {\n\t\tthis.scrollbar.updateClassName(\n\t\t\t\"editor-scrollable\" +\n\t\t\t\t\" \" +\n\t\t\t\tgetThemeTypeSelector(this._context.theme.type),\n\t\t);\n\t\treturn true;\n\t}\n\n\t// --- end event handlers\n\n\tpublic prepareRender(ctx: RenderingContext): void {\n\t\t// Nothing to do\n\t}\n\n\tpublic render(ctx: RestrictedRenderingContext): void {\n\t\tthis.scrollbar.renderNow();\n\t}\n}\n"],
  "mappings": "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",
  "names": []
}
