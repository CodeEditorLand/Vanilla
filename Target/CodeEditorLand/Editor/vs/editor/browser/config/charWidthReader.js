import{applyFontInfo as l}from"./domFontInfo.js";import"../../common/config/fontInfo.js";var h=(t=>(t[t.Regular=0]="Regular",t[t.Italic=1]="Italic",t[t.Bold=2]="Bold",t))(h||{});class f{chr;type;width;constructor(e,n){this.chr=e,this.type=n,this.width=0}fulfill(e){this.width=e}}class a{_bareFontInfo;_requests;_container;_testElements;constructor(e,n){this._bareFontInfo=e,this._requests=n,this._container=null,this._testElements=null}read(e){this._createDomElements(),e.document.body.appendChild(this._container),this._readFromDomElements(),this._container?.remove(),this._container=null,this._testElements=null}_createDomElements(){const e=document.createElement("div");e.style.position="absolute",e.style.top="-50000px",e.style.width="50000px";const n=document.createElement("div");l(n,this._bareFontInfo),e.appendChild(n);const t=document.createElement("div");l(t,this._bareFontInfo),t.style.fontWeight="bold",e.appendChild(t);const o=document.createElement("div");l(o,this._bareFontInfo),o.style.fontStyle="italic",e.appendChild(o);const c=[];for(const r of this._requests){let i;r.type===0&&(i=n),r.type===2&&(i=t),r.type===1&&(i=o),i.appendChild(document.createElement("br"));const s=document.createElement("span");a._render(s,r),i.appendChild(s),c.push(s)}this._container=e,this._testElements=c}static _render(e,n){if(n.chr===" "){let t="\xA0";for(let o=0;o<8;o++)t+=t;e.innerText=t}else{let t=n.chr;for(let o=0;o<8;o++)t+=t;e.textContent=t}}_readFromDomElements(){for(let e=0,n=this._requests.length;e<n;e++){const t=this._requests[e],o=this._testElements[e];t.fulfill(o.offsetWidth/256)}}}function _(d,e,n){new a(e,n).read(d)}export{f as CharWidthRequest,h as CharWidthRequestType,_ as readCharWidths};
