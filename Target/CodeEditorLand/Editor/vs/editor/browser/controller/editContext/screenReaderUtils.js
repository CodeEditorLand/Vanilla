import*as d from"../../../../nls.js";import{AccessibilitySupport as A}from"../../../../platform/accessibility/common/accessibility.js";import{EditorOption as y}from"../../../common/config/editorOptions.js";import{Range as b}from"../../../common/core/range.js";import{EndOfLinePreference as s}from"../../../common/model.js";class u{static _getPageOfLine(e,n){return Math.floor((e-1)/n)}static _getRangeForPage(e,n){const t=e*n,o=t+1,g=t+n;return new b(o,1,g+1,1)}static fromEditorSelection(e,n,t,o){const r=u._getPageOfLine(n.startLineNumber,t),L=u._getRangeForPage(r,t),f=u._getPageOfLine(n.endLineNumber,t),R=u._getRangeForPage(f,t);let a=L.intersectRanges(new b(1,1,n.startLineNumber,n.startColumn));if(o&&e.getValueLengthInRange(a,s.LF)>500){const l=e.modifyPosition(a.getEndPosition(),-500);a=b.fromPositions(l,a.getEndPosition())}const p=e.getValueInRange(a,s.LF),I=e.getLineCount(),C=e.getLineMaxColumn(I);let c=R.intersectRanges(new b(n.endLineNumber,n.endColumn,I,C));if(o&&e.getValueLengthInRange(c,s.LF)>500){const l=e.modifyPosition(c.getStartPosition(),500);c=b.fromPositions(c.getStartPosition(),l)}const S=e.getValueInRange(c,s.LF);let i;if(r===f||r+1===f)i=e.getValueInRange(n,s.LF);else{const l=L.intersectRanges(n),h=R.intersectRanges(n);i=e.getValueInRange(l,s.LF)+"\u2026"+e.getValueInRange(h,s.LF)}return o&&i.length>2*500&&(i=i.substring(0,500)+"\u2026"+i.substring(i.length-500,i.length)),{value:p+i+S,selection:n,selectionStart:p.length,selectionEnd:p.length+i.length,newlineCountBeforeSelection:a.endLineNumber-a.startLineNumber}}}function O(m,e){if(m.get(y.accessibilitySupport)===A.Disabled){const t=e.lookupKeybinding("editor.action.toggleScreenReaderAccessibilityMode")?.getAriaLabel(),o=e.lookupKeybinding("workbench.action.showCommands")?.getAriaLabel(),g=e.lookupKeybinding("workbench.action.openGlobalKeybindings")?.getAriaLabel(),r=d.localize("accessibilityModeOff","The editor is not accessible at this time.");return t?d.localize("accessibilityOffAriaLabel","{0} To enable screen reader optimized mode, use {1}",r,t):o?d.localize("accessibilityOffAriaLabelNoKb","{0} To enable screen reader optimized mode, open the quick pick with {1} and run the command Toggle Screen Reader Accessibility Mode, which is currently not triggerable via keyboard.",r,o):g?d.localize("accessibilityOffAriaLabelNoKbs","{0} Please assign a keybinding for the command Toggle Screen Reader Accessibility Mode by accessing the keybindings editor with {1} and run it.",r,g):r}return m.get(y.ariaLabel)}function w(m){let e=0,n=-1;do{if(n=m.indexOf(`
`,n+1),n===-1)break;e++}while(!0);return e}export{u as PagedScreenReaderStrategy,O as ariaLabelForScreenReaderContent,w as newlinecount};
