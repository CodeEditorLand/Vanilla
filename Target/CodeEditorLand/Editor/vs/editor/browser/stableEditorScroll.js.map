{
  "version": 3,
  "sources": ["../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/editor/browser/stableEditorScroll.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { ICodeEditor } from './editorBrowser.js';\nimport { Position } from '../common/core/position.js';\nimport { ScrollType } from '../common/editorCommon.js';\n\nexport class StableEditorScrollState {\n\n\tpublic static capture(editor: ICodeEditor): StableEditorScrollState {\n\t\tif (editor.getScrollTop() === 0 || editor.hasPendingScrollAnimation()) {\n\t\t\t// Never mess with the scroll top if the editor is at the top of the file or if there is a pending scroll animation\n\t\t\treturn new StableEditorScrollState(editor.getScrollTop(), editor.getContentHeight(), null, 0, null);\n\t\t}\n\n\t\tlet visiblePosition: Position | null = null;\n\t\tlet visiblePositionScrollDelta = 0;\n\t\tconst visibleRanges = editor.getVisibleRanges();\n\t\tif (visibleRanges.length > 0) {\n\t\t\tvisiblePosition = visibleRanges[0].getStartPosition();\n\t\t\tconst visiblePositionScrollTop = editor.getTopForPosition(visiblePosition.lineNumber, visiblePosition.column);\n\t\t\tvisiblePositionScrollDelta = editor.getScrollTop() - visiblePositionScrollTop;\n\t\t}\n\t\treturn new StableEditorScrollState(editor.getScrollTop(), editor.getContentHeight(), visiblePosition, visiblePositionScrollDelta, editor.getPosition());\n\t}\n\n\tconstructor(\n\t\tprivate readonly _initialScrollTop: number,\n\t\tprivate readonly _initialContentHeight: number,\n\t\tprivate readonly _visiblePosition: Position | null,\n\t\tprivate readonly _visiblePositionScrollDelta: number,\n\t\tprivate readonly _cursorPosition: Position | null,\n\t) {\n\t}\n\n\tpublic restore(editor: ICodeEditor): void {\n\t\tif (this._initialContentHeight === editor.getContentHeight() && this._initialScrollTop === editor.getScrollTop()) {\n\t\t\t// The editor's content height and scroll top haven't changed, so we don't need to do anything\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._visiblePosition) {\n\t\t\tconst visiblePositionScrollTop = editor.getTopForPosition(this._visiblePosition.lineNumber, this._visiblePosition.column);\n\t\t\teditor.setScrollTop(visiblePositionScrollTop + this._visiblePositionScrollDelta);\n\t\t}\n\t}\n\n\tpublic restoreRelativeVerticalPositionOfCursor(editor: ICodeEditor): void {\n\t\tif (this._initialContentHeight === editor.getContentHeight() && this._initialScrollTop === editor.getScrollTop()) {\n\t\t\t// The editor's content height and scroll top haven't changed, so we don't need to do anything\n\t\t\treturn;\n\t\t}\n\n\t\tconst currentCursorPosition = editor.getPosition();\n\n\t\tif (!this._cursorPosition || !currentCursorPosition) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst offset = editor.getTopForLineNumber(currentCursorPosition.lineNumber) - editor.getTopForLineNumber(this._cursorPosition.lineNumber);\n\t\teditor.setScrollTop(editor.getScrollTop() + offset, ScrollType.Immediate);\n\t}\n}\n\n\nexport class StableEditorBottomScrollState {\n\n\tpublic static capture(editor: ICodeEditor): StableEditorBottomScrollState {\n\t\tif (editor.hasPendingScrollAnimation()) {\n\t\t\t// Never mess with the scroll if there is a pending scroll animation\n\t\t\treturn new StableEditorBottomScrollState(editor.getScrollTop(), editor.getContentHeight(), null, 0);\n\t\t}\n\n\t\tlet visiblePosition: Position | null = null;\n\t\tlet visiblePositionScrollDelta = 0;\n\t\tconst visibleRanges = editor.getVisibleRanges();\n\t\tif (visibleRanges.length > 0) {\n\t\t\tvisiblePosition = visibleRanges.at(-1)!.getEndPosition();\n\t\t\tconst visiblePositionScrollBottom = editor.getBottomForLineNumber(visiblePosition.lineNumber);\n\t\t\tvisiblePositionScrollDelta = visiblePositionScrollBottom - editor.getScrollTop();\n\t\t}\n\t\treturn new StableEditorBottomScrollState(editor.getScrollTop(), editor.getContentHeight(), visiblePosition, visiblePositionScrollDelta);\n\t}\n\n\tconstructor(\n\t\tprivate readonly _initialScrollTop: number,\n\t\tprivate readonly _initialContentHeight: number,\n\t\tprivate readonly _visiblePosition: Position | null,\n\t\tprivate readonly _visiblePositionScrollDelta: number,\n\t) {\n\t}\n\n\tpublic restore(editor: ICodeEditor): void {\n\t\tif (this._initialContentHeight === editor.getContentHeight() && this._initialScrollTop === editor.getScrollTop()) {\n\t\t\t// The editor's content height and scroll top haven't changed, so we don't need to do anything\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._visiblePosition) {\n\t\t\tconst visiblePositionScrollBottom = editor.getBottomForLineNumber(this._visiblePosition.lineNumber);\n\t\t\teditor.setScrollTop(visiblePositionScrollBottom - this._visiblePositionScrollDelta, ScrollType.Immediate);\n\t\t}\n\t}\n}\n"],
  "mappings": "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",
  "names": []
}
