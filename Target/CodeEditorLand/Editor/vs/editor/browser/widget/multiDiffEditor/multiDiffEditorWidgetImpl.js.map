{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/editor/browser/widget/multiDiffEditor/multiDiffEditorWidgetImpl.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport {\n\ttype Dimension,\n\tgetWindow,\n\th,\n\tscheduleAtNextAnimationFrame,\n} from \"../../../../base/browser/dom.js\";\nimport { SmoothScrollableElement } from \"../../../../base/browser/ui/scrollbar/scrollableElement.js\";\nimport { compareBy, numberComparator } from \"../../../../base/common/arrays.js\";\nimport { findFirstMax } from \"../../../../base/common/arraysFind.js\";\nimport { BugIndicatingError } from \"../../../../base/common/errors.js\";\nimport {\n\tDisposable,\n\ttype IReference,\n\ttoDisposable,\n} from \"../../../../base/common/lifecycle.js\";\nimport {\n\ttype IObservable,\n\ttype IReader,\n\ttype ITransaction,\n\tautorun,\n\tautorunWithStore,\n\tderived,\n\tderivedWithStore,\n\tdisposableObservableValue,\n\tglobalTransaction,\n\tobservableFromEvent,\n\tobservableValue,\n\ttransaction,\n} from \"../../../../base/common/observable.js\";\nimport {\n\tScrollable,\n\tScrollbarVisibility,\n} from \"../../../../base/common/scrollable.js\";\nimport type { URI } from \"../../../../base/common/uri.js\";\nimport { localize } from \"../../../../nls.js\";\nimport {\n\ttype ContextKeyValue,\n\tIContextKeyService,\n} from \"../../../../platform/contextkey/common/contextkey.js\";\nimport type { ITextEditorOptions } from \"../../../../platform/editor/common/editor.js\";\nimport { IInstantiationService } from \"../../../../platform/instantiation/common/instantiation.js\";\nimport { ServiceCollection } from \"../../../../platform/instantiation/common/serviceCollection.js\";\nimport { OffsetRange } from \"../../../common/core/offsetRange.js\";\nimport type { IRange } from \"../../../common/core/range.js\";\nimport { type ISelection, Selection } from \"../../../common/core/selection.js\";\nimport type { IDiffEditor } from \"../../../common/editorCommon.js\";\nimport { EditorContextKeys } from \"../../../common/editorContextKeys.js\";\nimport type { ICodeEditor } from \"../../editorBrowser.js\";\nimport { ObservableElementSizeObserver } from \"../diffEditor/utils.js\";\nimport {\n\tDiffEditorItemTemplate,\n\tTemplateData,\n} from \"./diffEditorItemTemplate.js\";\nimport type { IDocumentDiffItem } from \"./model.js\";\nimport type {\n\tDocumentDiffItemViewModel,\n\tMultiDiffEditorViewModel,\n} from \"./multiDiffEditorViewModel.js\";\nimport type { RevealOptions } from \"./multiDiffEditorWidget.js\";\nimport { ObjectPool } from \"./objectPool.js\";\nimport \"./style.css\";\nimport type { IWorkbenchUIElementFactory } from \"./workbenchUIElementFactory.js\";\n\nexport class MultiDiffEditorWidgetImpl extends Disposable {\n\tprivate readonly _scrollableElements = h(\"div.scrollContent\", [\n\t\th(\"div@content\", {\n\t\t\tstyle: {\n\t\t\t\toverflow: \"hidden\",\n\t\t\t},\n\t\t}),\n\t\th(\"div.monaco-editor@overflowWidgetsDomNode\", {}),\n\t]);\n\n\tprivate readonly _scrollable = this._register(\n\t\tnew Scrollable({\n\t\t\tforceIntegerValues: false,\n\t\t\tscheduleAtNextAnimationFrame: (cb) =>\n\t\t\t\tscheduleAtNextAnimationFrame(getWindow(this._element), cb),\n\t\t\tsmoothScrollDuration: 100,\n\t\t}),\n\t);\n\n\tprivate readonly _scrollableElement = this._register(\n\t\tnew SmoothScrollableElement(\n\t\t\tthis._scrollableElements.root,\n\t\t\t{\n\t\t\t\tvertical: ScrollbarVisibility.Auto,\n\t\t\t\thorizontal: ScrollbarVisibility.Auto,\n\t\t\t\tuseShadows: false,\n\t\t\t},\n\t\t\tthis._scrollable,\n\t\t),\n\t);\n\n\tprivate readonly _elements = h(\"div.monaco-component.multiDiffEditor\", {}, [\n\t\th(\"div\", {}, [this._scrollableElement.getDomNode()]),\n\t\th(\"div.placeholder@placeholder\", {}, [h(\"div\")]),\n\t]);\n\n\tprivate readonly _sizeObserver = this._register(\n\t\tnew ObservableElementSizeObserver(this._element, undefined),\n\t);\n\n\tprivate readonly _objectPool = this._register(\n\t\tnew ObjectPool<TemplateData, DiffEditorItemTemplate>((data) => {\n\t\t\tconst template = this._instantiationService.createInstance(\n\t\t\t\tDiffEditorItemTemplate,\n\t\t\t\tthis._scrollableElements.content,\n\t\t\t\tthis._scrollableElements.overflowWidgetsDomNode,\n\t\t\t\tthis._workbenchUIElementFactory,\n\t\t\t);\n\t\t\ttemplate.setData(data);\n\t\t\treturn template;\n\t\t}),\n\t);\n\n\tpublic readonly scrollTop = observableFromEvent(\n\t\tthis,\n\t\tthis._scrollableElement.onScroll,\n\t\t() =>\n\t\t\t/** @description scrollTop */ this._scrollableElement.getScrollPosition()\n\t\t\t\t.scrollTop,\n\t);\n\tpublic readonly scrollLeft = observableFromEvent(\n\t\tthis,\n\t\tthis._scrollableElement.onScroll,\n\t\t() =>\n\t\t\t/** @description scrollLeft */ this._scrollableElement.getScrollPosition()\n\t\t\t\t.scrollLeft,\n\t);\n\n\tprivate readonly _viewItemsInfo = derivedWithStore<{\n\t\titems: readonly VirtualizedViewItem[];\n\t\tgetItem: (viewModel: DocumentDiffItemViewModel) => VirtualizedViewItem;\n\t}>(this, (reader, store) => {\n\t\tconst vm = this._viewModel.read(reader);\n\t\tif (!vm) {\n\t\t\treturn {\n\t\t\t\titems: [],\n\t\t\t\tgetItem: (_d) => {\n\t\t\t\t\tthrow new BugIndicatingError();\n\t\t\t\t},\n\t\t\t};\n\t\t}\n\t\tconst viewModels = vm.items.read(reader);\n\t\tconst map = new Map<DocumentDiffItemViewModel, VirtualizedViewItem>();\n\t\tconst items = viewModels.map((d) => {\n\t\t\tconst item = store.add(\n\t\t\t\tnew VirtualizedViewItem(\n\t\t\t\t\td,\n\t\t\t\t\tthis._objectPool,\n\t\t\t\t\tthis.scrollLeft,\n\t\t\t\t\t(delta) => {\n\t\t\t\t\t\tthis._scrollableElement.setScrollPosition({\n\t\t\t\t\t\t\tscrollTop:\n\t\t\t\t\t\t\t\tthis._scrollableElement.getScrollPosition()\n\t\t\t\t\t\t\t\t\t.scrollTop + delta,\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t),\n\t\t\t);\n\t\t\tconst data = this._lastDocStates?.[item.getKey()];\n\t\t\tif (data) {\n\t\t\t\ttransaction((tx) => {\n\t\t\t\t\titem.setViewState(data, tx);\n\t\t\t\t});\n\t\t\t}\n\t\t\tmap.set(d, item);\n\t\t\treturn item;\n\t\t});\n\t\treturn { items, getItem: (d) => map.get(d)! };\n\t});\n\n\tprivate readonly _viewItems = this._viewItemsInfo.map(\n\t\tthis,\n\t\t(items) => items.items,\n\t);\n\n\tprivate readonly _spaceBetweenPx = 0;\n\n\tprivate readonly _totalHeight = this._viewItems.map(this, (items, reader) =>\n\t\titems.reduce(\n\t\t\t(r, i) => r + i.contentHeight.read(reader) + this._spaceBetweenPx,\n\t\t\t0,\n\t\t),\n\t);\n\tpublic readonly activeControl = derived(this, (reader) => {\n\t\tconst activeDiffItem = this._viewModel\n\t\t\t.read(reader)\n\t\t\t?.activeDiffItem.read(reader);\n\t\tif (!activeDiffItem) {\n\t\t\treturn undefined;\n\t\t}\n\t\tconst viewItem = this._viewItemsInfo\n\t\t\t.read(reader)\n\t\t\t.getItem(activeDiffItem);\n\t\treturn viewItem.template.read(reader)?.editor;\n\t});\n\n\tprivate readonly _contextKeyService = this._register(\n\t\tthis._parentContextKeyService.createScoped(this._element),\n\t);\n\tprivate readonly _instantiationService = this._register(\n\t\tthis._parentInstantiationService.createChild(\n\t\t\tnew ServiceCollection([\n\t\t\t\tIContextKeyService,\n\t\t\t\tthis._contextKeyService,\n\t\t\t]),\n\t\t),\n\t);\n\n\tconstructor(\n\t\tprivate readonly _element: HTMLElement,\n\t\tprivate readonly _dimension: IObservable<Dimension | undefined>,\n\t\tprivate readonly _viewModel: IObservable<\n\t\t\tMultiDiffEditorViewModel | undefined\n\t\t>,\n\t\tprivate readonly _workbenchUIElementFactory: IWorkbenchUIElementFactory,\n\t\t@IContextKeyService\n\t\tprivate readonly _parentContextKeyService: IContextKeyService,\n\t\t@IInstantiationService\n\t\tprivate readonly _parentInstantiationService: IInstantiationService,\n\t) {\n\t\tsuper();\n\n\t\tthis._register(\n\t\t\tautorunWithStore((reader, store) => {\n\t\t\t\tconst viewModel = this._viewModel.read(reader);\n\t\t\t\tif (viewModel && viewModel.contextKeys) {\n\t\t\t\t\tfor (const [key, value] of Object.entries(\n\t\t\t\t\t\tviewModel.contextKeys,\n\t\t\t\t\t)) {\n\t\t\t\t\t\tconst contextKey =\n\t\t\t\t\t\t\tthis._contextKeyService.createKey<ContextKeyValue>(\n\t\t\t\t\t\t\t\tkey,\n\t\t\t\t\t\t\t\tundefined,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\tcontextKey.set(value);\n\t\t\t\t\t\tstore.add(toDisposable(() => contextKey.reset()));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}),\n\t\t);\n\n\t\tconst ctxAllCollapsed =\n\t\t\tthis._parentContextKeyService.createKey<boolean>(\n\t\t\t\tEditorContextKeys.multiDiffEditorAllCollapsed.key,\n\t\t\t\tfalse,\n\t\t\t);\n\t\tthis._register(\n\t\t\tautorun((reader) => {\n\t\t\t\tconst viewModel = this._viewModel.read(reader);\n\t\t\t\tif (viewModel) {\n\t\t\t\t\tconst allCollapsed = viewModel.items\n\t\t\t\t\t\t.read(reader)\n\t\t\t\t\t\t.every((item) => item.collapsed.read(reader));\n\t\t\t\t\tctxAllCollapsed.set(allCollapsed);\n\t\t\t\t}\n\t\t\t}),\n\t\t);\n\n\t\tthis._register(\n\t\t\tautorun((reader) => {\n\t\t\t\t/** @description Update widget dimension */\n\t\t\t\tconst dimension = this._dimension.read(reader);\n\t\t\t\tthis._sizeObserver.observe(dimension);\n\t\t\t}),\n\t\t);\n\n\t\tconst placeholderMessage = derived((reader) => {\n\t\t\tconst items = this._viewItems.read(reader);\n\t\t\tif (items.length > 0) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\tconst vm = this._viewModel.read(reader);\n\t\t\treturn !vm || vm.isLoading.read(reader)\n\t\t\t\t? localize(\"loading\", \"Loading...\")\n\t\t\t\t: localize(\"noChangedFiles\", \"No Changed Files\");\n\t\t});\n\n\t\tthis._register(\n\t\t\tautorun((reader) => {\n\t\t\t\tconst message = placeholderMessage.read(reader);\n\t\t\t\tthis._elements.placeholder.innerText = message ?? \"\";\n\t\t\t\tthis._elements.placeholder.classList.toggle(\n\t\t\t\t\t\"visible\",\n\t\t\t\t\t!!message,\n\t\t\t\t);\n\t\t\t}),\n\t\t);\n\n\t\tthis._scrollableElements.content.style.position = \"relative\";\n\n\t\tthis._register(\n\t\t\tautorun((reader) => {\n\t\t\t\t/** @description Update scroll dimensions */\n\t\t\t\tconst height = this._sizeObserver.height.read(reader);\n\t\t\t\tthis._scrollableElements.root.style.height = `${height}px`;\n\t\t\t\tconst totalHeight = this._totalHeight.read(reader);\n\t\t\t\tthis._scrollableElements.content.style.height = `${totalHeight}px`;\n\n\t\t\t\tconst width = this._sizeObserver.width.read(reader);\n\n\t\t\t\tlet scrollWidth = width;\n\t\t\t\tconst viewItems = this._viewItems.read(reader);\n\t\t\t\tconst max = findFirstMax(\n\t\t\t\t\tviewItems,\n\t\t\t\t\tcompareBy(\n\t\t\t\t\t\t(i) => i.maxScroll.read(reader).maxScroll,\n\t\t\t\t\t\tnumberComparator,\n\t\t\t\t\t),\n\t\t\t\t);\n\t\t\t\tif (max) {\n\t\t\t\t\tconst maxScroll = max.maxScroll.read(reader);\n\t\t\t\t\tscrollWidth = width + maxScroll.maxScroll;\n\t\t\t\t}\n\n\t\t\t\tthis._scrollableElement.setScrollDimensions({\n\t\t\t\t\twidth: width,\n\t\t\t\t\theight: height,\n\t\t\t\t\tscrollHeight: totalHeight,\n\t\t\t\t\tscrollWidth,\n\t\t\t\t});\n\t\t\t}),\n\t\t);\n\n\t\t_element.replaceChildren(this._elements.root);\n\t\tthis._register(\n\t\t\ttoDisposable(() => {\n\t\t\t\t_element.replaceChildren();\n\t\t\t}),\n\t\t);\n\n\t\tthis._register(\n\t\t\tthis._register(\n\t\t\t\tautorun((reader) => {\n\t\t\t\t\t/** @description Render all */\n\t\t\t\t\tglobalTransaction((tx) => {\n\t\t\t\t\t\tthis.render(reader);\n\t\t\t\t\t});\n\t\t\t\t}),\n\t\t\t),\n\t\t);\n\t}\n\n\tpublic setScrollState(scrollState: { top?: number; left?: number }): void {\n\t\tthis._scrollableElement.setScrollPosition({\n\t\t\tscrollLeft: scrollState.left,\n\t\t\tscrollTop: scrollState.top,\n\t\t});\n\t}\n\n\tpublic reveal(\n\t\tresource: IMultiDiffResourceId,\n\t\toptions?: RevealOptions,\n\t): void {\n\t\tconst viewItems = this._viewItems.get();\n\t\tconst index = viewItems.findIndex(\n\t\t\t(item) =>\n\t\t\t\titem.viewModel.originalUri?.toString() ===\n\t\t\t\t\tresource.original?.toString() &&\n\t\t\t\titem.viewModel.modifiedUri?.toString() ===\n\t\t\t\t\tresource.modified?.toString(),\n\t\t);\n\t\tif (index === -1) {\n\t\t\tthrow new BugIndicatingError(\"Resource not found in diff editor\");\n\t\t}\n\t\tconst viewItem = viewItems[index];\n\t\tthis._viewModel\n\t\t\t.get()!\n\t\t\t.activeDiffItem.setCache(viewItem.viewModel, undefined);\n\n\t\tlet scrollTop = 0;\n\t\tfor (let i = 0; i < index; i++) {\n\t\t\tscrollTop +=\n\t\t\t\tviewItems[i].contentHeight.get() + this._spaceBetweenPx;\n\t\t}\n\t\tthis._scrollableElement.setScrollPosition({ scrollTop });\n\n\t\tconst diffEditor = viewItem.template.get()?.editor;\n\t\tconst editor =\n\t\t\t\"original\" in resource\n\t\t\t\t? diffEditor?.getOriginalEditor()\n\t\t\t\t: diffEditor?.getModifiedEditor();\n\t\tif (editor && options?.range) {\n\t\t\teditor.revealRangeInCenter(options.range);\n\t\t\thighlightRange(editor, options.range);\n\t\t}\n\t}\n\n\tpublic getViewState(): IMultiDiffEditorViewState {\n\t\treturn {\n\t\t\tscrollState: {\n\t\t\t\ttop: this.scrollTop.get(),\n\t\t\t\tleft: this.scrollLeft.get(),\n\t\t\t},\n\t\t\tdocStates: Object.fromEntries(\n\t\t\t\tthis._viewItems\n\t\t\t\t\t.get()\n\t\t\t\t\t.map((i) => [i.getKey(), i.getViewState()]),\n\t\t\t),\n\t\t};\n\t}\n\n\t/** This accounts for documents that are not loaded yet. */\n\tprivate _lastDocStates: IMultiDiffEditorViewState[\"docStates\"] = {};\n\n\tpublic setViewState(viewState: IMultiDiffEditorViewState): void {\n\t\tthis.setScrollState(viewState.scrollState);\n\n\t\tthis._lastDocStates = viewState.docStates;\n\n\t\ttransaction((tx) => {\n\t\t\t/** setViewState */\n\t\t\tif (viewState.docStates) {\n\t\t\t\tfor (const i of this._viewItems.get()) {\n\t\t\t\t\tconst state = viewState.docStates[i.getKey()];\n\t\t\t\t\tif (state) {\n\t\t\t\t\t\ti.setViewState(state, tx);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tpublic findDocumentDiffItem(resource: URI): IDocumentDiffItem | undefined {\n\t\tconst item = this._viewItems\n\t\t\t.get()\n\t\t\t.find(\n\t\t\t\t(v) =>\n\t\t\t\t\tv.viewModel.diffEditorViewModel.model.modified.uri.toString() ===\n\t\t\t\t\t\tresource.toString() ||\n\t\t\t\t\tv.viewModel.diffEditorViewModel.model.original.uri.toString() ===\n\t\t\t\t\t\tresource.toString(),\n\t\t\t);\n\t\treturn item?.viewModel.documentDiffItem;\n\t}\n\n\tpublic tryGetCodeEditor(\n\t\tresource: URI,\n\t): { diffEditor: IDiffEditor; editor: ICodeEditor } | undefined {\n\t\tconst item = this._viewItems\n\t\t\t.get()\n\t\t\t.find(\n\t\t\t\t(v) =>\n\t\t\t\t\tv.viewModel.diffEditorViewModel.model.modified.uri.toString() ===\n\t\t\t\t\t\tresource.toString() ||\n\t\t\t\t\tv.viewModel.diffEditorViewModel.model.original.uri.toString() ===\n\t\t\t\t\t\tresource.toString(),\n\t\t\t);\n\t\tconst editor = item?.template.get()?.editor;\n\t\tif (!editor) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (\n\t\t\titem.viewModel.diffEditorViewModel.model.modified.uri.toString() ===\n\t\t\tresource.toString()\n\t\t) {\n\t\t\treturn { diffEditor: editor, editor: editor.getModifiedEditor() };\n\t\t} else {\n\t\t\treturn { diffEditor: editor, editor: editor.getOriginalEditor() };\n\t\t}\n\t}\n\n\tprivate render(reader: IReader | undefined) {\n\t\tconst scrollTop = this.scrollTop.read(reader);\n\t\tlet contentScrollOffsetToScrollOffset = 0;\n\t\tlet itemHeightSumBefore = 0;\n\t\tlet itemContentHeightSumBefore = 0;\n\t\tconst viewPortHeight = this._sizeObserver.height.read(reader);\n\t\tconst contentViewPort = OffsetRange.ofStartAndLength(\n\t\t\tscrollTop,\n\t\t\tviewPortHeight,\n\t\t);\n\n\t\tconst width = this._sizeObserver.width.read(reader);\n\n\t\tfor (const v of this._viewItems.read(reader)) {\n\t\t\tconst itemContentHeight = v.contentHeight.read(reader);\n\t\t\tconst itemHeight = Math.min(itemContentHeight, viewPortHeight);\n\t\t\tconst itemRange = OffsetRange.ofStartAndLength(\n\t\t\t\titemHeightSumBefore,\n\t\t\t\titemHeight,\n\t\t\t);\n\t\t\tconst itemContentRange = OffsetRange.ofStartAndLength(\n\t\t\t\titemContentHeightSumBefore,\n\t\t\t\titemContentHeight,\n\t\t\t);\n\n\t\t\tif (itemContentRange.isBefore(contentViewPort)) {\n\t\t\t\tcontentScrollOffsetToScrollOffset -=\n\t\t\t\t\titemContentHeight - itemHeight;\n\t\t\t\tv.hide();\n\t\t\t} else if (itemContentRange.isAfter(contentViewPort)) {\n\t\t\t\tv.hide();\n\t\t\t} else {\n\t\t\t\tconst scroll = Math.max(\n\t\t\t\t\t0,\n\t\t\t\t\tMath.min(\n\t\t\t\t\t\tcontentViewPort.start - itemContentRange.start,\n\t\t\t\t\t\titemContentHeight - itemHeight,\n\t\t\t\t\t),\n\t\t\t\t);\n\t\t\t\tcontentScrollOffsetToScrollOffset -= scroll;\n\t\t\t\tconst viewPort = OffsetRange.ofStartAndLength(\n\t\t\t\t\tscrollTop + contentScrollOffsetToScrollOffset,\n\t\t\t\t\tviewPortHeight,\n\t\t\t\t);\n\t\t\t\tv.render(itemRange, scroll, width, viewPort);\n\t\t\t}\n\n\t\t\titemHeightSumBefore += itemHeight + this._spaceBetweenPx;\n\t\t\titemContentHeightSumBefore +=\n\t\t\t\titemContentHeight + this._spaceBetweenPx;\n\t\t}\n\n\t\tthis._scrollableElements.content.style.transform = `translateY(${-(scrollTop + contentScrollOffsetToScrollOffset)}px)`;\n\t}\n}\n\nfunction highlightRange(targetEditor: ICodeEditor, range: IRange) {\n\tconst modelNow = targetEditor.getModel();\n\tconst decorations = targetEditor.createDecorationsCollection([\n\t\t{\n\t\t\trange,\n\t\t\toptions: {\n\t\t\t\tdescription: \"symbol-navigate-action-highlight\",\n\t\t\t\tclassName: \"symbolHighlight\",\n\t\t\t},\n\t\t},\n\t]);\n\tsetTimeout(() => {\n\t\tif (targetEditor.getModel() === modelNow) {\n\t\t\tdecorations.clear();\n\t\t}\n\t}, 350);\n}\n\nexport interface IMultiDiffEditorViewState {\n\tscrollState: { top: number; left: number };\n\tdocStates?: Record<string, IMultiDiffDocState>;\n}\n\ninterface IMultiDiffDocState {\n\tcollapsed: boolean;\n\tselections?: ISelection[];\n}\n\nexport interface IMultiDiffEditorOptions extends ITextEditorOptions {\n\tviewState?: IMultiDiffEditorOptionsViewState;\n}\n\nexport interface IMultiDiffEditorOptionsViewState {\n\trevealData?: {\n\t\tresource: IMultiDiffResourceId;\n\t\trange?: IRange;\n\t};\n}\n\nexport type IMultiDiffResourceId = {\n\toriginal: URI | undefined;\n\tmodified: URI | undefined;\n};\n\nclass VirtualizedViewItem extends Disposable {\n\tprivate readonly _templateRef = this._register(\n\t\tdisposableObservableValue<\n\t\t\tIReference<DiffEditorItemTemplate> | undefined\n\t\t>(this, undefined),\n\t);\n\n\tpublic readonly contentHeight = derived(\n\t\tthis,\n\t\t(reader) =>\n\t\t\tthis._templateRef\n\t\t\t\t.read(reader)\n\t\t\t\t?.object.contentHeight?.read(reader) ??\n\t\t\tthis.viewModel.lastTemplateData.read(reader).contentHeight,\n\t);\n\n\tpublic readonly maxScroll = derived(\n\t\tthis,\n\t\t(reader) =>\n\t\t\tthis._templateRef.read(reader)?.object.maxScroll.read(reader) ?? {\n\t\t\t\tmaxScroll: 0,\n\t\t\t\tscrollWidth: 0,\n\t\t\t},\n\t);\n\n\tpublic readonly template = derived(\n\t\tthis,\n\t\t(reader) => this._templateRef.read(reader)?.object,\n\t);\n\tprivate _isHidden = observableValue(this, false);\n\n\tprivate readonly _isFocused = derived(\n\t\tthis,\n\t\t(reader) => this.template.read(reader)?.isFocused.read(reader) ?? false,\n\t);\n\n\tconstructor(\n\t\tpublic readonly viewModel: DocumentDiffItemViewModel,\n\t\tprivate readonly _objectPool: ObjectPool<\n\t\t\tTemplateData,\n\t\t\tDiffEditorItemTemplate\n\t\t>,\n\t\tprivate readonly _scrollLeft: IObservable<number>,\n\t\tprivate readonly _deltaScrollVertical: (delta: number) => void,\n\t) {\n\t\tsuper();\n\n\t\tthis.viewModel.setIsFocused(this._isFocused, undefined);\n\n\t\tthis._register(\n\t\t\tautorun((reader) => {\n\t\t\t\tconst scrollLeft = this._scrollLeft.read(reader);\n\t\t\t\tthis._templateRef\n\t\t\t\t\t.read(reader)\n\t\t\t\t\t?.object.setScrollLeft(scrollLeft);\n\t\t\t}),\n\t\t);\n\n\t\tthis._register(\n\t\t\tautorun((reader) => {\n\t\t\t\tconst ref = this._templateRef.read(reader);\n\t\t\t\tif (!ref) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst isHidden = this._isHidden.read(reader);\n\t\t\t\tif (!isHidden) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst isFocused = ref.object.isFocused.read(reader);\n\t\t\t\tif (isFocused) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis._clear();\n\t\t\t}),\n\t\t);\n\t}\n\n\toverride dispose(): void {\n\t\tthis._clear();\n\t\tsuper.dispose();\n\t}\n\n\tpublic override toString(): string {\n\t\treturn `VirtualViewItem(${this.viewModel.documentDiffItem.modified?.uri.toString()})`;\n\t}\n\n\tpublic getKey(): string {\n\t\treturn this.viewModel.getKey();\n\t}\n\n\tpublic getViewState(): IMultiDiffDocState {\n\t\ttransaction((tx) => {\n\t\t\tthis._updateTemplateData(tx);\n\t\t});\n\t\treturn {\n\t\t\tcollapsed: this.viewModel.collapsed.get(),\n\t\t\tselections: this.viewModel.lastTemplateData.get().selections,\n\t\t};\n\t}\n\n\tpublic setViewState(viewState: IMultiDiffDocState, tx: ITransaction): void {\n\t\tthis.viewModel.collapsed.set(viewState.collapsed, tx);\n\n\t\tthis._updateTemplateData(tx);\n\t\tconst data = this.viewModel.lastTemplateData.get();\n\t\tconst selections = viewState.selections?.map(Selection.liftSelection);\n\t\tthis.viewModel.lastTemplateData.set(\n\t\t\t{\n\t\t\t\t...data,\n\t\t\t\tselections,\n\t\t\t},\n\t\t\ttx,\n\t\t);\n\t\tconst ref = this._templateRef.get();\n\t\tif (ref) {\n\t\t\tif (selections) {\n\t\t\t\tref.object.editor.setSelections(selections);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _updateTemplateData(tx: ITransaction): void {\n\t\tconst ref = this._templateRef.get();\n\t\tif (!ref) {\n\t\t\treturn;\n\t\t}\n\t\tthis.viewModel.lastTemplateData.set(\n\t\t\t{\n\t\t\t\tcontentHeight: ref.object.contentHeight.get(),\n\t\t\t\tselections: ref.object.editor.getSelections() ?? undefined,\n\t\t\t},\n\t\t\ttx,\n\t\t);\n\t}\n\n\tprivate _clear(): void {\n\t\tconst ref = this._templateRef.get();\n\t\tif (!ref) {\n\t\t\treturn;\n\t\t}\n\t\ttransaction((tx) => {\n\t\t\tthis._updateTemplateData(tx);\n\t\t\tref.object.hide();\n\t\t\tthis._templateRef.set(undefined, tx);\n\t\t});\n\t}\n\n\tpublic hide(): void {\n\t\tthis._isHidden.set(true, undefined);\n\t}\n\n\tpublic render(\n\t\tverticalSpace: OffsetRange,\n\t\toffset: number,\n\t\twidth: number,\n\t\tviewPort: OffsetRange,\n\t): void {\n\t\tthis._isHidden.set(false, undefined);\n\n\t\tlet ref = this._templateRef.get();\n\t\tif (!ref) {\n\t\t\tref = this._objectPool.getUnusedObj(\n\t\t\t\tnew TemplateData(this.viewModel, this._deltaScrollVertical),\n\t\t\t);\n\t\t\tthis._templateRef.set(ref, undefined);\n\n\t\t\tconst selections = this.viewModel.lastTemplateData.get().selections;\n\t\t\tif (selections) {\n\t\t\t\tref.object.editor.setSelections(selections);\n\t\t\t}\n\t\t}\n\t\tref.object.render(verticalSpace, width, offset, viewPort);\n\t}\n}\n"],
  "mappings": "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",
  "names": []
}
