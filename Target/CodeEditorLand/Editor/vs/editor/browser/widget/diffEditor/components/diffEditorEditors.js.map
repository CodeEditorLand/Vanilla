{
  "version": 3,
  "sources": ["../../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/editor/browser/widget/diffEditor/components/diffEditorEditors.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Emitter } from '../../../../../base/common/event.js';\nimport { Disposable } from '../../../../../base/common/lifecycle.js';\nimport { IReader, autorunHandleChanges, derived, derivedOpts, observableFromEvent } from '../../../../../base/common/observable.js';\nimport { IEditorConstructionOptions } from '../../../config/editorConfiguration.js';\nimport { IDiffEditorConstructionOptions } from '../../../editorBrowser.js';\nimport { observableCodeEditor } from '../../../observableCodeEditor.js';\nimport { CodeEditorWidget, ICodeEditorWidgetOptions } from '../../codeEditor/codeEditorWidget.js';\nimport { IDiffCodeEditorWidgetOptions } from '../diffEditorWidget.js';\nimport { OverviewRulerFeature } from '../features/overviewRulerFeature.js';\nimport { EditorOptions, IEditorOptions } from '../../../../common/config/editorOptions.js';\nimport { Position } from '../../../../common/core/position.js';\nimport { IContentSizeChangedEvent } from '../../../../common/editorCommon.js';\nimport { localize } from '../../../../../nls.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../../../platform/keybinding/common/keybinding.js';\nimport { DiffEditorOptions } from '../diffEditorOptions.js';\n\nexport class DiffEditorEditors extends Disposable {\n\tpublic readonly original = this._register(this._createLeftHandSideEditor(this._options.editorOptions.get(), this._argCodeEditorWidgetOptions.originalEditor || {}));\n\tpublic readonly modified = this._register(this._createRightHandSideEditor(this._options.editorOptions.get(), this._argCodeEditorWidgetOptions.modifiedEditor || {}));\n\n\tprivate readonly _onDidContentSizeChange = this._register(new Emitter<IContentSizeChangedEvent>());\n\tpublic get onDidContentSizeChange() { return this._onDidContentSizeChange.event; }\n\n\tpublic readonly modifiedScrollTop = observableFromEvent(this, this.modified.onDidScrollChange, () => /** @description modified.getScrollTop */ this.modified.getScrollTop());\n\tpublic readonly modifiedScrollHeight = observableFromEvent(this, this.modified.onDidScrollChange, () => /** @description modified.getScrollHeight */ this.modified.getScrollHeight());\n\n\tpublic readonly modifiedObs = observableCodeEditor(this.modified);\n\tpublic readonly originalObs = observableCodeEditor(this.original);\n\n\tpublic readonly modifiedModel = this.modifiedObs.model;\n\n\tpublic readonly modifiedSelections = observableFromEvent(this, this.modified.onDidChangeCursorSelection, () => this.modified.getSelections() ?? []);\n\tpublic readonly modifiedCursor = derivedOpts({ owner: this, equalsFn: Position.equals }, reader => this.modifiedSelections.read(reader)[0]?.getPosition() ?? new Position(1, 1));\n\n\tpublic readonly originalCursor = observableFromEvent(this, this.original.onDidChangeCursorPosition, () => this.original.getPosition() ?? new Position(1, 1));\n\n\tpublic readonly isOriginalFocused = observableCodeEditor(this.original).isFocused;\n\tpublic readonly isModifiedFocused = observableCodeEditor(this.modified).isFocused;\n\n\tpublic readonly isFocused = derived(this, reader => this.isOriginalFocused.read(reader) || this.isModifiedFocused.read(reader));\n\n\tconstructor(\n\t\tprivate readonly originalEditorElement: HTMLElement,\n\t\tprivate readonly modifiedEditorElement: HTMLElement,\n\t\tprivate readonly _options: DiffEditorOptions,\n\t\tprivate _argCodeEditorWidgetOptions: IDiffCodeEditorWidgetOptions,\n\t\tprivate readonly _createInnerEditor: (instantiationService: IInstantiationService, container: HTMLElement, options: Readonly<IEditorOptions>, editorWidgetOptions: ICodeEditorWidgetOptions) => CodeEditorWidget,\n\t\t@IInstantiationService private readonly _instantiationService: IInstantiationService,\n\t\t@IKeybindingService private readonly _keybindingService: IKeybindingService\n\t) {\n\t\tsuper();\n\n\t\tthis._argCodeEditorWidgetOptions = null as any;\n\n\t\tthis._register(autorunHandleChanges({\n\t\t\tcreateEmptyChangeSummary: (): IDiffEditorConstructionOptions => ({}),\n\t\t\thandleChange: (ctx, changeSummary) => {\n\t\t\t\tif (ctx.didChange(_options.editorOptions)) {\n\t\t\t\t\tObject.assign(changeSummary, ctx.change.changedOptions);\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}, (reader, changeSummary) => {\n\t\t\t/** @description update editor options */\n\t\t\t_options.editorOptions.read(reader);\n\n\t\t\tthis._options.renderSideBySide.read(reader);\n\n\t\t\tthis.modified.updateOptions(this._adjustOptionsForRightHandSide(reader, changeSummary));\n\t\t\tthis.original.updateOptions(this._adjustOptionsForLeftHandSide(reader, changeSummary));\n\t\t}));\n\t}\n\n\tprivate _createLeftHandSideEditor(options: Readonly<IDiffEditorConstructionOptions>, codeEditorWidgetOptions: ICodeEditorWidgetOptions): CodeEditorWidget {\n\t\tconst leftHandSideOptions = this._adjustOptionsForLeftHandSide(undefined, options);\n\t\tconst editor = this._constructInnerEditor(this._instantiationService, this.originalEditorElement, leftHandSideOptions, codeEditorWidgetOptions);\n\t\teditor.setContextValue('isInDiffLeftEditor', true);\n\t\treturn editor;\n\t}\n\n\tprivate _createRightHandSideEditor(options: Readonly<IDiffEditorConstructionOptions>, codeEditorWidgetOptions: ICodeEditorWidgetOptions): CodeEditorWidget {\n\t\tconst rightHandSideOptions = this._adjustOptionsForRightHandSide(undefined, options);\n\t\tconst editor = this._constructInnerEditor(this._instantiationService, this.modifiedEditorElement, rightHandSideOptions, codeEditorWidgetOptions);\n\t\teditor.setContextValue('isInDiffRightEditor', true);\n\t\treturn editor;\n\t}\n\n\tprivate _constructInnerEditor(instantiationService: IInstantiationService, container: HTMLElement, options: Readonly<IEditorConstructionOptions>, editorWidgetOptions: ICodeEditorWidgetOptions): CodeEditorWidget {\n\t\tconst editor = this._createInnerEditor(instantiationService, container, options, editorWidgetOptions);\n\n\t\tthis._register(editor.onDidContentSizeChange(e => {\n\t\t\tconst width = this.original.getContentWidth() + this.modified.getContentWidth() + OverviewRulerFeature.ENTIRE_DIFF_OVERVIEW_WIDTH;\n\t\t\tconst height = Math.max(this.modified.getContentHeight(), this.original.getContentHeight());\n\n\t\t\tthis._onDidContentSizeChange.fire({\n\t\t\t\tcontentHeight: height,\n\t\t\t\tcontentWidth: width,\n\t\t\t\tcontentHeightChanged: e.contentHeightChanged,\n\t\t\t\tcontentWidthChanged: e.contentWidthChanged\n\t\t\t});\n\t\t}));\n\t\treturn editor;\n\t}\n\n\tprivate _adjustOptionsForLeftHandSide(_reader: IReader | undefined, changedOptions: Readonly<IDiffEditorConstructionOptions>): IEditorConstructionOptions {\n\t\tconst result = this._adjustOptionsForSubEditor(changedOptions);\n\t\tif (!this._options.renderSideBySide.get()) {\n\t\t\t// never wrap hidden editor\n\t\t\tresult.wordWrapOverride1 = 'off';\n\t\t\tresult.wordWrapOverride2 = 'off';\n\t\t\tresult.stickyScroll = { enabled: false };\n\n\t\t\t// Disable unicode highlighting for the original side in inline mode, as they are not shown anyway.\n\t\t\tresult.unicodeHighlight = { nonBasicASCII: false, ambiguousCharacters: false, invisibleCharacters: false };\n\t\t} else {\n\t\t\tresult.unicodeHighlight = this._options.editorOptions.get().unicodeHighlight || {};\n\t\t\tresult.wordWrapOverride1 = this._options.diffWordWrap.get();\n\t\t}\n\t\tresult.glyphMargin = this._options.renderSideBySide.get();\n\n\t\tif (changedOptions.originalAriaLabel) {\n\t\t\tresult.ariaLabel = changedOptions.originalAriaLabel;\n\t\t}\n\t\tresult.ariaLabel = this._updateAriaLabel(result.ariaLabel);\n\t\tresult.readOnly = !this._options.originalEditable.get();\n\t\tresult.dropIntoEditor = { enabled: !result.readOnly };\n\t\tresult.extraEditorClassName = 'original-in-monaco-diff-editor';\n\t\treturn result;\n\t}\n\n\tprivate _adjustOptionsForRightHandSide(reader: IReader | undefined, changedOptions: Readonly<IDiffEditorConstructionOptions>): IEditorConstructionOptions {\n\t\tconst result = this._adjustOptionsForSubEditor(changedOptions);\n\t\tif (changedOptions.modifiedAriaLabel) {\n\t\t\tresult.ariaLabel = changedOptions.modifiedAriaLabel;\n\t\t}\n\t\tresult.ariaLabel = this._updateAriaLabel(result.ariaLabel);\n\t\tresult.wordWrapOverride1 = this._options.diffWordWrap.get();\n\t\tresult.revealHorizontalRightPadding = EditorOptions.revealHorizontalRightPadding.defaultValue + OverviewRulerFeature.ENTIRE_DIFF_OVERVIEW_WIDTH;\n\t\tresult.scrollbar!.verticalHasArrows = false;\n\t\tresult.extraEditorClassName = 'modified-in-monaco-diff-editor';\n\t\treturn result;\n\t}\n\n\tprivate _adjustOptionsForSubEditor(options: Readonly<IDiffEditorConstructionOptions>): IEditorConstructionOptions {\n\t\tconst clonedOptions = {\n\t\t\t...options,\n\t\t\tdimension: {\n\t\t\t\theight: 0,\n\t\t\t\twidth: 0\n\t\t\t},\n\t\t};\n\t\tclonedOptions.inDiffEditor = true;\n\t\tclonedOptions.automaticLayout = false;\n\n\t\t// Clone scrollbar options before changing them\n\t\tclonedOptions.scrollbar = { ...(clonedOptions.scrollbar || {}) };\n\t\tclonedOptions.folding = false;\n\t\tclonedOptions.codeLens = this._options.diffCodeLens.get();\n\t\tclonedOptions.fixedOverflowWidgets = true;\n\n\t\t// Clone minimap options before changing them\n\t\tclonedOptions.minimap = { ...(clonedOptions.minimap || {}) };\n\t\tclonedOptions.minimap.enabled = false;\n\n\t\tif (this._options.hideUnchangedRegions.get()) {\n\t\t\tclonedOptions.stickyScroll = { enabled: false };\n\t\t} else {\n\t\t\tclonedOptions.stickyScroll = this._options.editorOptions.get().stickyScroll;\n\t\t}\n\t\treturn clonedOptions;\n\t}\n\n\tprivate _updateAriaLabel(ariaLabel: string | undefined): string | undefined {\n\t\tif (!ariaLabel) {\n\t\t\tariaLabel = '';\n\t\t}\n\t\tconst ariaNavigationTip = localize('diff-aria-navigation-tip', ' use {0} to open the accessibility help.', this._keybindingService.lookupKeybinding('editor.action.accessibilityHelp')?.getAriaLabel());\n\t\tif (this._options.accessibilityVerbose.get()) {\n\t\t\treturn ariaLabel + ariaNavigationTip;\n\t\t} else if (ariaLabel) {\n\t\t\treturn ariaLabel.replaceAll(ariaNavigationTip, '');\n\t\t}\n\t\treturn '';\n\t}\n}\n"],
  "mappings": "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",
  "names": []
}
