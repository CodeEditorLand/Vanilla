{
  "version": 3,
  "sources": ["../../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/editor/browser/widget/diffEditor/features/hideUnchangedRegionsFeature.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport {\n\t$,\n\taddDisposableListener,\n\tgetWindow,\n\th,\n\treset,\n} from \"../../../../../base/browser/dom.js\";\nimport {\n\trenderIcon,\n\trenderLabelWithIcons,\n} from \"../../../../../base/browser/ui/iconLabel/iconLabels.js\";\nimport { Codicon } from \"../../../../../base/common/codicons.js\";\nimport { MarkdownString } from \"../../../../../base/common/htmlContent.js\";\nimport {\n\tDisposable,\n\ttype IDisposable,\n} from \"../../../../../base/common/lifecycle.js\";\nimport {\n\ttype IObservable,\n\ttype IReader,\n\tautorun,\n\tderived,\n\tderivedDisposable,\n\tderivedWithStore,\n\tobservableValue,\n\ttransaction,\n} from \"../../../../../base/common/observable.js\";\nimport { ThemeIcon } from \"../../../../../base/common/themables.js\";\nimport { isDefined } from \"../../../../../base/common/types.js\";\nimport { localize } from \"../../../../../nls.js\";\nimport { IInstantiationService } from \"../../../../../platform/instantiation/common/instantiation.js\";\nimport { EditorOption } from \"../../../../common/config/editorOptions.js\";\nimport { LineRange } from \"../../../../common/core/lineRange.js\";\nimport { Position } from \"../../../../common/core/position.js\";\nimport { Range } from \"../../../../common/core/range.js\";\nimport { CursorChangeReason } from \"../../../../common/cursorEvents.js\";\nimport { type SymbolKind, SymbolKinds } from \"../../../../common/languages.js\";\nimport type {\n\tIModelDecorationOptions,\n\tIModelDeltaDecoration,\n\tITextModel,\n} from \"../../../../common/model.js\";\nimport type { ICodeEditor } from \"../../../editorBrowser.js\";\nimport { observableCodeEditor } from \"../../../observableCodeEditor.js\";\nimport type { DiffEditorEditors } from \"../components/diffEditorEditors.js\";\nimport type { DiffEditorOptions } from \"../diffEditorOptions.js\";\nimport {\n\ttype DiffEditorViewModel,\n\tRevealPreference,\n\ttype UnchangedRegion,\n} from \"../diffEditorViewModel.js\";\nimport {\n\ttype IObservableViewZone,\n\tPlaceholderViewZone,\n\tViewZoneOverlayWidget,\n\tapplyObservableDecorations,\n\tapplyStyle,\n} from \"../utils.js\";\n\n/**\n * Make sure to add the view zones to the editor!\n */\nexport class HideUnchangedRegionsFeature extends Disposable {\n\tprivate static readonly _breadcrumbsSourceFactory = observableValue<\n\t\t(\n\t\t\ttextModel: ITextModel,\n\t\t\tinstantiationService: IInstantiationService,\n\t\t) => IDiffEditorBreadcrumbsSource\n\t>(HideUnchangedRegionsFeature, () => ({\n\t\tdispose() {},\n\t\tgetBreadcrumbItems(startRange, reader) {\n\t\t\treturn [];\n\t\t},\n\t}));\n\tpublic static setBreadcrumbsSourceFactory(\n\t\tfactory: (\n\t\t\ttextModel: ITextModel,\n\t\t\tinstantiationService: IInstantiationService,\n\t\t) => IDiffEditorBreadcrumbsSource,\n\t) {\n\t\tthis._breadcrumbsSourceFactory.set(factory, undefined);\n\t}\n\n\tprivate readonly _modifiedOutlineSource = derivedDisposable(\n\t\tthis,\n\t\t(reader) => {\n\t\t\tconst m = this._editors.modifiedModel.read(reader);\n\t\t\tconst factory =\n\t\t\t\tHideUnchangedRegionsFeature._breadcrumbsSourceFactory.read(\n\t\t\t\t\treader,\n\t\t\t\t);\n\t\t\treturn !m || !factory\n\t\t\t\t? undefined\n\t\t\t\t: factory(m, this._instantiationService);\n\t\t},\n\t);\n\n\tpublic readonly viewZones: IObservable<{\n\t\torigViewZones: IObservableViewZone[];\n\t\tmodViewZones: IObservableViewZone[];\n\t}>;\n\n\tprivate _isUpdatingHiddenAreas = false;\n\tpublic get isUpdatingHiddenAreas() {\n\t\treturn this._isUpdatingHiddenAreas;\n\t}\n\n\tconstructor(\n\t\tprivate readonly _editors: DiffEditorEditors,\n\t\tprivate readonly _diffModel: IObservable<DiffEditorViewModel | undefined>,\n\t\tprivate readonly _options: DiffEditorOptions,\n\t\t@IInstantiationService private readonly _instantiationService: IInstantiationService,\n\t) {\n\t\tsuper();\n\n\t\tthis._register(this._editors.original.onDidChangeCursorPosition(e => {\n\t\t\tif (e.reason === CursorChangeReason.ContentFlush) { return; }\n\t\t\tconst m = this._diffModel.get();\n\t\t\ttransaction(tx => {\n\t\t\t\tfor (const s of this._editors.original.getSelections() || []) {\n\t\t\t\t\tm?.ensureOriginalLineIsVisible(s.getStartPosition().lineNumber, RevealPreference.FromCloserSide, tx);\n\t\t\t\t\tm?.ensureOriginalLineIsVisible(s.getEndPosition().lineNumber, RevealPreference.FromCloserSide, tx);\n\t\t\t\t}\n\t\t\t});\n\t\t}));\n\n\t\tthis._register(this._editors.modified.onDidChangeCursorPosition(e => {\n\t\t\tif (e.reason === CursorChangeReason.ContentFlush) { return; }\n\t\t\tconst m = this._diffModel.get();\n\t\t\ttransaction(tx => {\n\t\t\t\tfor (const s of this._editors.modified.getSelections() || []) {\n\t\t\t\t\tm?.ensureModifiedLineIsVisible(s.getStartPosition().lineNumber, RevealPreference.FromCloserSide, tx);\n\t\t\t\t\tm?.ensureModifiedLineIsVisible(s.getEndPosition().lineNumber, RevealPreference.FromCloserSide, tx);\n\t\t\t\t}\n\t\t\t});\n\t\t}));\n\n\t\tconst unchangedRegions = this._diffModel.map((m, reader) => {\n\t\t\tconst regions = m?.unchangedRegions.read(reader) ?? [];\n\t\t\tif (regions.length === 1 && regions[0].modifiedLineNumber === 1 && regions[0].lineCount === this._editors.modifiedModel.read(reader)?.getLineCount()) {\n\t\t\t\treturn [];\n\t\t\t}\n\t\t\treturn regions;\n\t\t});\n\n\t\tthis.viewZones = derivedWithStore(this, (reader, store) => {\n\t\t\t/** @description view Zones */\n\t\t\tconst modifiedOutlineSource = this._modifiedOutlineSource.read(reader);\n\t\t\tif (!modifiedOutlineSource) { return { origViewZones: [], modViewZones: [] }; }\n\n\t\t\tconst origViewZones: IObservableViewZone[] = [];\n\t\t\tconst modViewZones: IObservableViewZone[] = [];\n\t\t\tconst sideBySide = this._options.renderSideBySide.read(reader);\n\n\t\t\tconst compactMode = this._options.compactMode.read(reader);\n\n\t\t\tconst curUnchangedRegions = unchangedRegions.read(reader);\n\t\t\tfor (let i = 0; i < curUnchangedRegions.length; i++) {\n\t\t\t\tconst r = curUnchangedRegions[i];\n\t\t\t\tif (r.shouldHideControls(reader)) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (compactMode && (i === 0 || i === curUnchangedRegions.length - 1)) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (compactMode) {\n\t\t\t\t\t{\n\t\t\t\t\t\tconst d = derived(this, reader => /** @description hiddenOriginalRangeStart */ r.getHiddenOriginalRange(reader).startLineNumber - 1);\n\t\t\t\t\t\tconst origVz = new PlaceholderViewZone(d, 12);\n\t\t\t\t\t\torigViewZones.push(origVz);\n\t\t\t\t\t\tstore.add(new CompactCollapsedCodeOverlayWidget(\n\t\t\t\t\t\t\tthis._editors.original,\n\t\t\t\t\t\t\torigVz,\n\t\t\t\t\t\t\tr,\n\t\t\t\t\t\t\t!sideBySide,\n\t\t\t\t\t\t));\n\t\t\t\t\t}\n\t\t\t\t\t{\n\t\t\t\t\t\tconst d = derived(this, reader => /** @description hiddenModifiedRangeStart */ r.getHiddenModifiedRange(reader).startLineNumber - 1);\n\t\t\t\t\t\tconst modViewZone = new PlaceholderViewZone(d, 12);\n\t\t\t\t\t\tmodViewZones.push(modViewZone);\n\t\t\t\t\t\tstore.add(new CompactCollapsedCodeOverlayWidget(\n\t\t\t\t\t\t\tthis._editors.modified,\n\t\t\t\t\t\t\tmodViewZone,\n\t\t\t\t\t\t\tr,\n\t\t\t\t\t\t));\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t{\n\t\t\t\t\t\tconst d = derived(this, reader => /** @description hiddenOriginalRangeStart */ r.getHiddenOriginalRange(reader).startLineNumber - 1);\n\t\t\t\t\t\tconst origVz = new PlaceholderViewZone(d, 24);\n\t\t\t\t\t\torigViewZones.push(origVz);\n\t\t\t\t\t\tstore.add(new CollapsedCodeOverlayWidget(\n\t\t\t\t\t\t\tthis._editors.original,\n\t\t\t\t\t\t\torigVz,\n\t\t\t\t\t\t\tr,\n\t\t\t\t\t\t\tr.originalUnchangedRange,\n\t\t\t\t\t\t\t!sideBySide,\n\t\t\t\t\t\t\tmodifiedOutlineSource,\n\t\t\t\t\t\t\tl => this._diffModel.get()!.ensureModifiedLineIsVisible(l, RevealPreference.FromBottom, undefined),\n\t\t\t\t\t\t\tthis._options,\n\t\t\t\t\t\t));\n\t\t\t\t\t}\n\t\t\t\t\t{\n\t\t\t\t\t\tconst d = derived(this, reader => /** @description hiddenModifiedRangeStart */ r.getHiddenModifiedRange(reader).startLineNumber - 1);\n\t\t\t\t\t\tconst modViewZone = new PlaceholderViewZone(d, 24);\n\t\t\t\t\t\tmodViewZones.push(modViewZone);\n\t\t\t\t\t\tstore.add(new CollapsedCodeOverlayWidget(\n\t\t\t\t\t\t\tthis._editors.modified,\n\t\t\t\t\t\t\tmodViewZone,\n\t\t\t\t\t\t\tr,\n\t\t\t\t\t\t\tr.modifiedUnchangedRange,\n\t\t\t\t\t\t\tfalse,\n\t\t\t\t\t\t\tmodifiedOutlineSource,\n\t\t\t\t\t\t\tl => this._diffModel.get()!.ensureModifiedLineIsVisible(l, RevealPreference.FromBottom, undefined),\n\t\t\t\t\t\t\tthis._options,\n\t\t\t\t\t\t));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn { origViewZones, modViewZones, };\n\t\t});\n\n\n\t\tconst unchangedLinesDecoration: IModelDecorationOptions = {\n\t\t\tdescription: 'unchanged lines',\n\t\t\tclassName: 'diff-unchanged-lines',\n\t\t\tisWholeLine: true,\n\t\t};\n\t\tconst unchangedLinesDecorationShow: IModelDecorationOptions = {\n\t\t\tdescription: 'Fold Unchanged',\n\t\t\tglyphMarginHoverMessage: new MarkdownString(undefined, { isTrusted: true, supportThemeIcons: true })\n\t\t\t\t.appendMarkdown(localize('foldUnchanged', 'Fold Unchanged Region')),\n\t\t\tglyphMarginClassName: 'fold-unchanged ' + ThemeIcon.asClassName(Codicon.fold),\n\t\t\tzIndex: 10001,\n\t\t};\n\n\t\tthis._register(applyObservableDecorations(this._editors.original, derived(this, reader => {\n\t\t\t/** @description decorations */\n\t\t\tconst curUnchangedRegions = unchangedRegions.read(reader);\n\t\t\tconst result = curUnchangedRegions.map<IModelDeltaDecoration>(r => ({\n\t\t\t\trange: r.originalUnchangedRange.toInclusiveRange()!,\n\t\t\t\toptions: unchangedLinesDecoration,\n\t\t\t}));\n\t\t\tfor (const r of curUnchangedRegions) {\n\t\t\t\tif (r.shouldHideControls(reader)) {\n\t\t\t\t\tresult.push({\n\t\t\t\t\t\trange: Range.fromPositions(new Position(r.originalLineNumber, 1)),\n\t\t\t\t\t\toptions: unchangedLinesDecorationShow,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn result;\n\t\t})));\n\n\t\tthis._register(applyObservableDecorations(this._editors.modified, derived(this, reader => {\n\t\t\t/** @description decorations */\n\t\t\tconst curUnchangedRegions = unchangedRegions.read(reader);\n\t\t\tconst result = curUnchangedRegions.map<IModelDeltaDecoration>(r => ({\n\t\t\t\trange: r.modifiedUnchangedRange.toInclusiveRange()!,\n\t\t\t\toptions: unchangedLinesDecoration,\n\t\t\t}));\n\t\t\tfor (const r of curUnchangedRegions) {\n\t\t\t\tif (r.shouldHideControls(reader)) {\n\t\t\t\t\tresult.push({\n\t\t\t\t\t\trange: LineRange.ofLength(r.modifiedLineNumber, 1).toInclusiveRange()!,\n\t\t\t\t\t\toptions: unchangedLinesDecorationShow,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn result;\n\t\t})));\n\n\t\tthis._register(autorun((reader) => {\n\t\t\t/** @description update folded unchanged regions */\n\t\t\tconst curUnchangedRegions = unchangedRegions.read(reader);\n\t\t\tthis._isUpdatingHiddenAreas = true;\n\t\t\ttry {\n\t\t\t\tthis._editors.original.setHiddenAreas(curUnchangedRegions.map(r => r.getHiddenOriginalRange(reader).toInclusiveRange()).filter(isDefined));\n\t\t\t\tthis._editors.modified.setHiddenAreas(curUnchangedRegions.map(r => r.getHiddenModifiedRange(reader).toInclusiveRange()).filter(isDefined));\n\t\t\t} finally {\n\t\t\t\tthis._isUpdatingHiddenAreas = false;\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(this._editors.modified.onMouseUp(event => {\n\t\t\tif (!event.event.rightButton && event.target.position && event.target.element?.className.includes('fold-unchanged')) {\n\t\t\t\tconst lineNumber = event.target.position.lineNumber;\n\t\t\t\tconst model = this._diffModel.get();\n\t\t\t\tif (!model) { return; }\n\t\t\t\tconst region = model.unchangedRegions.get().find(r => r.modifiedUnchangedRange.includes(lineNumber));\n\t\t\t\tif (!region) { return; }\n\t\t\t\tregion.collapseAll(undefined);\n\t\t\t\tevent.event.stopPropagation();\n\t\t\t\tevent.event.preventDefault();\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(this._editors.original.onMouseUp(event => {\n\t\t\tif (!event.event.rightButton && event.target.position && event.target.element?.className.includes('fold-unchanged')) {\n\t\t\t\tconst lineNumber = event.target.position.lineNumber;\n\t\t\t\tconst model = this._diffModel.get();\n\t\t\t\tif (!model) { return; }\n\t\t\t\tconst region = model.unchangedRegions.get().find(r => r.originalUnchangedRange.includes(lineNumber));\n\t\t\t\tif (!region) { return; }\n\t\t\t\tregion.collapseAll(undefined);\n\t\t\t\tevent.event.stopPropagation();\n\t\t\t\tevent.event.preventDefault();\n\t\t\t}\n\t\t}));\n\t}\n}\n\nclass CompactCollapsedCodeOverlayWidget extends ViewZoneOverlayWidget {\n\tprivate readonly _nodes = h(\"div.diff-hidden-lines-compact\", [\n\t\th(\"div.line-left\", []),\n\t\th(\"div.text@text\", []),\n\t\th(\"div.line-right\", []),\n\t]);\n\n\tconstructor(\n\t\teditor: ICodeEditor,\n\t\t_viewZone: PlaceholderViewZone,\n\t\tprivate readonly _unchangedRegion: UnchangedRegion,\n\t\tprivate readonly _hide: boolean = false,\n\t) {\n\t\tconst root = h(\"div.diff-hidden-lines-widget\");\n\t\tsuper(editor, _viewZone, root.root);\n\t\troot.root.appendChild(this._nodes.root);\n\n\t\tif (this._hide) {\n\t\t\tthis._nodes.root.replaceChildren();\n\t\t}\n\n\t\tthis._register(\n\t\t\tautorun((reader) => {\n\t\t\t\t/** @description update labels */\n\n\t\t\t\tif (!this._hide) {\n\t\t\t\t\tconst lineCount =\n\t\t\t\t\t\tthis._unchangedRegion.getHiddenModifiedRange(\n\t\t\t\t\t\t\treader,\n\t\t\t\t\t\t).length;\n\t\t\t\t\tconst linesHiddenText = localize(\n\t\t\t\t\t\t\"hiddenLines\",\n\t\t\t\t\t\t\"{0} hidden lines\",\n\t\t\t\t\t\tlineCount,\n\t\t\t\t\t);\n\t\t\t\t\tthis._nodes.text.innerText = linesHiddenText;\n\t\t\t\t}\n\t\t\t}),\n\t\t);\n\t}\n}\n\nclass CollapsedCodeOverlayWidget extends ViewZoneOverlayWidget {\n\tprivate readonly _nodes = h(\"div.diff-hidden-lines\", [\n\t\th(\"div.top@top\", {\n\t\t\ttitle: localize(\n\t\t\t\t\"diff.hiddenLines.top\",\n\t\t\t\t\"Click or drag to show more above\",\n\t\t\t),\n\t\t}),\n\t\th(\"div.center@content\", { style: { display: \"flex\" } }, [\n\t\t\th(\n\t\t\t\t\"div@first\",\n\t\t\t\t{\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\tdisplay: \"flex\",\n\t\t\t\t\t\tjustifyContent: \"center\",\n\t\t\t\t\t\talignItems: \"center\",\n\t\t\t\t\t\tflexShrink: \"0\",\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t[\n\t\t\t\t\t$(\n\t\t\t\t\t\t\"a\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: localize(\n\t\t\t\t\t\t\t\t\"showUnchangedRegion\",\n\t\t\t\t\t\t\t\t\"Show Unchanged Region\",\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\trole: \"button\",\n\t\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\t\tthis._unchangedRegion.showAll(undefined);\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t\t...renderLabelWithIcons(\"$(unfold)\"),\n\t\t\t\t\t),\n\t\t\t\t],\n\t\t\t),\n\t\t\th(\"div@others\", {\n\t\t\t\tstyle: {\n\t\t\t\t\tdisplay: \"flex\",\n\t\t\t\t\tjustifyContent: \"center\",\n\t\t\t\t\talignItems: \"center\",\n\t\t\t\t},\n\t\t\t}),\n\t\t]),\n\t\th(\"div.bottom@bottom\", {\n\t\t\ttitle: localize(\"diff.bottom\", \"Click or drag to show more below\"),\n\t\t\trole: \"button\",\n\t\t}),\n\t]);\n\n\tconstructor(\n\t\tprivate readonly _editor: ICodeEditor,\n\t\t_viewZone: PlaceholderViewZone,\n\t\tprivate readonly _unchangedRegion: UnchangedRegion,\n\t\tprivate readonly _unchangedRegionRange: LineRange,\n\t\tprivate readonly _hide: boolean,\n\t\tprivate readonly _modifiedOutlineSource: IDiffEditorBreadcrumbsSource,\n\t\tprivate readonly _revealModifiedHiddenLine: (\n\t\t\tlineNumber: number,\n\t\t) => void,\n\t\tprivate readonly _options: DiffEditorOptions,\n\t) {\n\t\tconst root = h(\"div.diff-hidden-lines-widget\");\n\t\tsuper(_editor, _viewZone, root.root);\n\t\troot.root.appendChild(this._nodes.root);\n\n\t\tif (this._hide) {\n\t\t\treset(this._nodes.first);\n\t\t} else {\n\t\t\tthis._register(\n\t\t\t\tapplyStyle(this._nodes.first, {\n\t\t\t\t\twidth: observableCodeEditor(this._editor)\n\t\t\t\t\t\t.layoutInfoContentLeft,\n\t\t\t\t}),\n\t\t\t);\n\t\t}\n\n\t\tthis._register(\n\t\t\tautorun((reader) => {\n\t\t\t\t/** @description Update CollapsedCodeOverlayWidget canMove* css classes */\n\t\t\t\tconst isFullyRevealed =\n\t\t\t\t\tthis._unchangedRegion.visibleLineCountTop.read(reader) +\n\t\t\t\t\t\tthis._unchangedRegion.visibleLineCountBottom.read(\n\t\t\t\t\t\t\treader,\n\t\t\t\t\t\t) ===\n\t\t\t\t\tthis._unchangedRegion.lineCount;\n\n\t\t\t\tthis._nodes.bottom.classList.toggle(\n\t\t\t\t\t\"canMoveTop\",\n\t\t\t\t\t!isFullyRevealed,\n\t\t\t\t);\n\t\t\t\tthis._nodes.bottom.classList.toggle(\n\t\t\t\t\t\"canMoveBottom\",\n\t\t\t\t\tthis._unchangedRegion.visibleLineCountBottom.read(reader) >\n\t\t\t\t\t\t0,\n\t\t\t\t);\n\t\t\t\tthis._nodes.top.classList.toggle(\n\t\t\t\t\t\"canMoveTop\",\n\t\t\t\t\tthis._unchangedRegion.visibleLineCountTop.read(reader) > 0,\n\t\t\t\t);\n\t\t\t\tthis._nodes.top.classList.toggle(\n\t\t\t\t\t\"canMoveBottom\",\n\t\t\t\t\t!isFullyRevealed,\n\t\t\t\t);\n\t\t\t\tconst isDragged = this._unchangedRegion.isDragged.read(reader);\n\t\t\t\tconst domNode = this._editor.getDomNode();\n\t\t\t\tif (domNode) {\n\t\t\t\t\tdomNode.classList.toggle(\n\t\t\t\t\t\t\"draggingUnchangedRegion\",\n\t\t\t\t\t\t!!isDragged,\n\t\t\t\t\t);\n\t\t\t\t\tif (isDragged === \"top\") {\n\t\t\t\t\t\tdomNode.classList.toggle(\n\t\t\t\t\t\t\t\"canMoveTop\",\n\t\t\t\t\t\t\tthis._unchangedRegion.visibleLineCountTop.read(\n\t\t\t\t\t\t\t\treader,\n\t\t\t\t\t\t\t) > 0,\n\t\t\t\t\t\t);\n\t\t\t\t\t\tdomNode.classList.toggle(\n\t\t\t\t\t\t\t\"canMoveBottom\",\n\t\t\t\t\t\t\t!isFullyRevealed,\n\t\t\t\t\t\t);\n\t\t\t\t\t} else if (isDragged === \"bottom\") {\n\t\t\t\t\t\tdomNode.classList.toggle(\n\t\t\t\t\t\t\t\"canMoveTop\",\n\t\t\t\t\t\t\t!isFullyRevealed,\n\t\t\t\t\t\t);\n\t\t\t\t\t\tdomNode.classList.toggle(\n\t\t\t\t\t\t\t\"canMoveBottom\",\n\t\t\t\t\t\t\tthis._unchangedRegion.visibleLineCountBottom.read(\n\t\t\t\t\t\t\t\treader,\n\t\t\t\t\t\t\t) > 0,\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdomNode.classList.toggle(\"canMoveTop\", false);\n\t\t\t\t\t\tdomNode.classList.toggle(\"canMoveBottom\", false);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}),\n\t\t);\n\n\t\tconst editor = this._editor;\n\n\t\tthis._register(\n\t\t\taddDisposableListener(this._nodes.top, \"mousedown\", (e) => {\n\t\t\t\tif (e.button !== 0) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis._nodes.top.classList.toggle(\"dragging\", true);\n\t\t\t\tthis._nodes.root.classList.toggle(\"dragging\", true);\n\t\t\t\te.preventDefault();\n\t\t\t\tconst startTop = e.clientY;\n\t\t\t\tlet didMove = false;\n\t\t\t\tconst cur = this._unchangedRegion.visibleLineCountTop.get();\n\t\t\t\tthis._unchangedRegion.isDragged.set(\"top\", undefined);\n\n\t\t\t\tconst window = getWindow(this._nodes.top);\n\n\t\t\t\tconst mouseMoveListener = addDisposableListener(\n\t\t\t\t\twindow,\n\t\t\t\t\t\"mousemove\",\n\t\t\t\t\t(e) => {\n\t\t\t\t\t\tconst currentTop = e.clientY;\n\t\t\t\t\t\tconst delta = currentTop - startTop;\n\t\t\t\t\t\tdidMove = didMove || Math.abs(delta) > 2;\n\t\t\t\t\t\tconst lineDelta = Math.round(\n\t\t\t\t\t\t\tdelta / editor.getOption(EditorOption.lineHeight),\n\t\t\t\t\t\t);\n\t\t\t\t\t\tconst newVal = Math.max(\n\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\tMath.min(\n\t\t\t\t\t\t\t\tcur + lineDelta,\n\t\t\t\t\t\t\t\tthis._unchangedRegion.getMaxVisibleLineCountTop(),\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis._unchangedRegion.visibleLineCountTop.set(\n\t\t\t\t\t\t\tnewVal,\n\t\t\t\t\t\t\tundefined,\n\t\t\t\t\t\t);\n\t\t\t\t\t},\n\t\t\t\t);\n\n\t\t\t\tconst mouseUpListener = addDisposableListener(\n\t\t\t\t\twindow,\n\t\t\t\t\t\"mouseup\",\n\t\t\t\t\t(e) => {\n\t\t\t\t\t\tif (!didMove) {\n\t\t\t\t\t\t\tthis._unchangedRegion.showMoreAbove(\n\t\t\t\t\t\t\t\tthis._options.hideUnchangedRegionsRevealLineCount.get(),\n\t\t\t\t\t\t\t\tundefined,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis._nodes.top.classList.toggle(\"dragging\", false);\n\t\t\t\t\t\tthis._nodes.root.classList.toggle(\"dragging\", false);\n\t\t\t\t\t\tthis._unchangedRegion.isDragged.set(\n\t\t\t\t\t\t\tundefined,\n\t\t\t\t\t\t\tundefined,\n\t\t\t\t\t\t);\n\t\t\t\t\t\tmouseMoveListener.dispose();\n\t\t\t\t\t\tmouseUpListener.dispose();\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t}),\n\t\t);\n\n\t\tthis._register(\n\t\t\taddDisposableListener(this._nodes.bottom, \"mousedown\", (e) => {\n\t\t\t\tif (e.button !== 0) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis._nodes.bottom.classList.toggle(\"dragging\", true);\n\t\t\t\tthis._nodes.root.classList.toggle(\"dragging\", true);\n\t\t\t\te.preventDefault();\n\t\t\t\tconst startTop = e.clientY;\n\t\t\t\tlet didMove = false;\n\t\t\t\tconst cur = this._unchangedRegion.visibleLineCountBottom.get();\n\t\t\t\tthis._unchangedRegion.isDragged.set(\"bottom\", undefined);\n\n\t\t\t\tconst window = getWindow(this._nodes.bottom);\n\n\t\t\t\tconst mouseMoveListener = addDisposableListener(\n\t\t\t\t\twindow,\n\t\t\t\t\t\"mousemove\",\n\t\t\t\t\t(e) => {\n\t\t\t\t\t\tconst currentTop = e.clientY;\n\t\t\t\t\t\tconst delta = currentTop - startTop;\n\t\t\t\t\t\tdidMove = didMove || Math.abs(delta) > 2;\n\t\t\t\t\t\tconst lineDelta = Math.round(\n\t\t\t\t\t\t\tdelta / editor.getOption(EditorOption.lineHeight),\n\t\t\t\t\t\t);\n\t\t\t\t\t\tconst newVal = Math.max(\n\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\tMath.min(\n\t\t\t\t\t\t\t\tcur - lineDelta,\n\t\t\t\t\t\t\t\tthis._unchangedRegion.getMaxVisibleLineCountBottom(),\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t);\n\t\t\t\t\t\tconst top =\n\t\t\t\t\t\t\tthis._unchangedRegionRange.endLineNumberExclusive >\n\t\t\t\t\t\t\teditor.getModel()!.getLineCount()\n\t\t\t\t\t\t\t\t? editor.getContentHeight()\n\t\t\t\t\t\t\t\t: editor.getTopForLineNumber(\n\t\t\t\t\t\t\t\t\t\tthis._unchangedRegionRange\n\t\t\t\t\t\t\t\t\t\t\t.endLineNumberExclusive,\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\tthis._unchangedRegion.visibleLineCountBottom.set(\n\t\t\t\t\t\t\tnewVal,\n\t\t\t\t\t\t\tundefined,\n\t\t\t\t\t\t);\n\t\t\t\t\t\tconst top2 =\n\t\t\t\t\t\t\tthis._unchangedRegionRange.endLineNumberExclusive >\n\t\t\t\t\t\t\teditor.getModel()!.getLineCount()\n\t\t\t\t\t\t\t\t? editor.getContentHeight()\n\t\t\t\t\t\t\t\t: editor.getTopForLineNumber(\n\t\t\t\t\t\t\t\t\t\tthis._unchangedRegionRange\n\t\t\t\t\t\t\t\t\t\t\t.endLineNumberExclusive,\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\teditor.setScrollTop(\n\t\t\t\t\t\t\teditor.getScrollTop() + (top2 - top),\n\t\t\t\t\t\t);\n\t\t\t\t\t},\n\t\t\t\t);\n\n\t\t\t\tconst mouseUpListener = addDisposableListener(\n\t\t\t\t\twindow,\n\t\t\t\t\t\"mouseup\",\n\t\t\t\t\t(e) => {\n\t\t\t\t\t\tthis._unchangedRegion.isDragged.set(\n\t\t\t\t\t\t\tundefined,\n\t\t\t\t\t\t\tundefined,\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tif (!didMove) {\n\t\t\t\t\t\t\tconst top = editor.getTopForLineNumber(\n\t\t\t\t\t\t\t\tthis._unchangedRegionRange\n\t\t\t\t\t\t\t\t\t.endLineNumberExclusive,\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tthis._unchangedRegion.showMoreBelow(\n\t\t\t\t\t\t\t\tthis._options.hideUnchangedRegionsRevealLineCount.get(),\n\t\t\t\t\t\t\t\tundefined,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tconst top2 = editor.getTopForLineNumber(\n\t\t\t\t\t\t\t\tthis._unchangedRegionRange\n\t\t\t\t\t\t\t\t\t.endLineNumberExclusive,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\teditor.setScrollTop(\n\t\t\t\t\t\t\t\teditor.getScrollTop() + (top2 - top),\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis._nodes.bottom.classList.toggle(\"dragging\", false);\n\t\t\t\t\t\tthis._nodes.root.classList.toggle(\"dragging\", false);\n\t\t\t\t\t\tmouseMoveListener.dispose();\n\t\t\t\t\t\tmouseUpListener.dispose();\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t}),\n\t\t);\n\n\t\tthis._register(\n\t\t\tautorun((reader) => {\n\t\t\t\t/** @description update labels */\n\n\t\t\t\tconst children: HTMLElement[] = [];\n\t\t\t\tif (!this._hide) {\n\t\t\t\t\tconst lineCount =\n\t\t\t\t\t\t_unchangedRegion.getHiddenModifiedRange(reader).length;\n\t\t\t\t\tconst linesHiddenText = localize(\n\t\t\t\t\t\t\"hiddenLines\",\n\t\t\t\t\t\t\"{0} hidden lines\",\n\t\t\t\t\t\tlineCount,\n\t\t\t\t\t);\n\t\t\t\t\tconst span = $(\n\t\t\t\t\t\t\"span\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: localize(\n\t\t\t\t\t\t\t\t\"diff.hiddenLines.expandAll\",\n\t\t\t\t\t\t\t\t\"Double click to unfold\",\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t},\n\t\t\t\t\t\tlinesHiddenText,\n\t\t\t\t\t);\n\t\t\t\t\tspan.addEventListener(\"dblclick\", (e) => {\n\t\t\t\t\t\tif (e.button !== 0) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tthis._unchangedRegion.showAll(undefined);\n\t\t\t\t\t});\n\t\t\t\t\tchildren.push(span);\n\n\t\t\t\t\tconst range =\n\t\t\t\t\t\tthis._unchangedRegion.getHiddenModifiedRange(reader);\n\t\t\t\t\tconst items =\n\t\t\t\t\t\tthis._modifiedOutlineSource.getBreadcrumbItems(\n\t\t\t\t\t\t\trange,\n\t\t\t\t\t\t\treader,\n\t\t\t\t\t\t);\n\n\t\t\t\t\tif (items.length > 0) {\n\t\t\t\t\t\tchildren.push(\n\t\t\t\t\t\t\t$(\"span\", undefined, \"\\u00a0\\u00a0|\\u00a0\\u00a0\"),\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tfor (let i = 0; i < items.length; i++) {\n\t\t\t\t\t\t\tconst item = items[i];\n\t\t\t\t\t\t\tconst icon = SymbolKinds.toIcon(item.kind);\n\t\t\t\t\t\t\tconst divItem = h(\n\t\t\t\t\t\t\t\t\"div.breadcrumb-item\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\t\t\t\tdisplay: \"flex\",\n\t\t\t\t\t\t\t\t\t\talignItems: \"center\",\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\trenderIcon(icon),\n\t\t\t\t\t\t\t\t\t\"\\u00a0\",\n\t\t\t\t\t\t\t\t\titem.name,\n\t\t\t\t\t\t\t\t\t...(i === items.length - 1\n\t\t\t\t\t\t\t\t\t\t? []\n\t\t\t\t\t\t\t\t\t\t: [renderIcon(Codicon.chevronRight)]),\n\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t).root;\n\t\t\t\t\t\t\tchildren.push(divItem);\n\t\t\t\t\t\t\tdivItem.onclick = () => {\n\t\t\t\t\t\t\t\tthis._revealModifiedHiddenLine(\n\t\t\t\t\t\t\t\t\titem.startLineNumber,\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treset(this._nodes.others, ...children);\n\t\t\t}),\n\t\t);\n\t}\n}\n\nexport interface IDiffEditorBreadcrumbsSource extends IDisposable {\n\tgetBreadcrumbItems(\n\t\tstartRange: LineRange,\n\t\treader: IReader,\n\t): { name: string; kind: SymbolKind; startLineNumber: number }[];\n}\n"],
  "mappings": ";;;;;;;;;;;;AAKA;AAAA,EACC;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,OACM;AACP;AAAA,EACC;AAAA,EACA;AAAA,OACM;AACP,SAAS,eAAe;AACxB,SAAS,sBAAsB;AAC/B;AAAA,EACC;AAAA,OAEM;AACP;AAAA,EAGC;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,OACM;AACP,SAAS,iBAAiB;AAC1B,SAAS,iBAAiB;AAC1B,SAAS,gBAAgB;AACzB,SAAS,6BAA6B;AACtC,SAAS,oBAAoB;AAC7B,SAAS,iBAAiB;AAC1B,SAAS,gBAAgB;AACzB,SAAS,aAAa;AACtB,SAAS,0BAA0B;AACnC,SAA0B,mBAAmB;AAO7C,SAAS,4BAA4B;AAGrC;AAAA,EAEC;AAAA,OAEM;AACP;AAAA,EAEC;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,OACM;AAKA,IAAM,8BAAN,cAA0C,WAAW;AAAA,EA6C3D,YACkB,UACA,YACA,UACuB,uBACvC;AACD,UAAM;AALW;AACA;AACA;AACuB;AAIxC,SAAK,UAAU,KAAK,SAAS,SAAS,0BAA0B,OAAK;AACpE,UAAI,EAAE,WAAW,mBAAmB,cAAc;AAAE;AAAA,MAAQ;AAC5D,YAAM,IAAI,KAAK,WAAW,IAAI;AAC9B,kBAAY,QAAM;AACjB,mBAAW,KAAK,KAAK,SAAS,SAAS,cAAc,KAAK,CAAC,GAAG;AAC7D,aAAG,4BAA4B,EAAE,iBAAiB,EAAE,YAAY,iBAAiB,gBAAgB,EAAE;AACnG,aAAG,4BAA4B,EAAE,eAAe,EAAE,YAAY,iBAAiB,gBAAgB,EAAE;AAAA,QAClG;AAAA,MACD,CAAC;AAAA,IACF,CAAC,CAAC;AAEF,SAAK,UAAU,KAAK,SAAS,SAAS,0BAA0B,OAAK;AACpE,UAAI,EAAE,WAAW,mBAAmB,cAAc;AAAE;AAAA,MAAQ;AAC5D,YAAM,IAAI,KAAK,WAAW,IAAI;AAC9B,kBAAY,QAAM;AACjB,mBAAW,KAAK,KAAK,SAAS,SAAS,cAAc,KAAK,CAAC,GAAG;AAC7D,aAAG,4BAA4B,EAAE,iBAAiB,EAAE,YAAY,iBAAiB,gBAAgB,EAAE;AACnG,aAAG,4BAA4B,EAAE,eAAe,EAAE,YAAY,iBAAiB,gBAAgB,EAAE;AAAA,QAClG;AAAA,MACD,CAAC;AAAA,IACF,CAAC,CAAC;AAEF,UAAM,mBAAmB,KAAK,WAAW,IAAI,CAAC,GAAG,WAAW;AAC3D,YAAM,UAAU,GAAG,iBAAiB,KAAK,MAAM,KAAK,CAAC;AACrD,UAAI,QAAQ,WAAW,KAAK,QAAQ,CAAC,EAAE,uBAAuB,KAAK,QAAQ,CAAC,EAAE,cAAc,KAAK,SAAS,cAAc,KAAK,MAAM,GAAG,aAAa,GAAG;AACrJ,eAAO,CAAC;AAAA,MACT;AACA,aAAO;AAAA,IACR,CAAC;AAED,SAAK,YAAY,iBAAiB,MAAM,CAAC,QAAQ,UAAU;AAE1D,YAAM,wBAAwB,KAAK,uBAAuB,KAAK,MAAM;AACrE,UAAI,CAAC,uBAAuB;AAAE,eAAO,EAAE,eAAe,CAAC,GAAG,cAAc,CAAC,EAAE;AAAA,MAAG;AAE9E,YAAM,gBAAuC,CAAC;AAC9C,YAAM,eAAsC,CAAC;AAC7C,YAAM,aAAa,KAAK,SAAS,iBAAiB,KAAK,MAAM;AAE7D,YAAM,cAAc,KAAK,SAAS,YAAY,KAAK,MAAM;AAEzD,YAAM,sBAAsB,iBAAiB,KAAK,MAAM;AACxD,eAAS,IAAI,GAAG,IAAI,oBAAoB,QAAQ,KAAK;AACpD,cAAM,IAAI,oBAAoB,CAAC;AAC/B,YAAI,EAAE,mBAAmB,MAAM,GAAG;AACjC;AAAA,QACD;AAEA,YAAI,gBAAgB,MAAM,KAAK,MAAM,oBAAoB,SAAS,IAAI;AACrE;AAAA,QACD;AAEA,YAAI,aAAa;AAChB;AACC,kBAAM,IAAI,QAAQ,MAAM,CAAAA;AAAA;AAAA,cAAuD,EAAE,uBAAuBA,OAAM,EAAE,kBAAkB;AAAA,aAAC;AACnI,kBAAM,SAAS,IAAI,oBAAoB,GAAG,EAAE;AAC5C,0BAAc,KAAK,MAAM;AACzB,kBAAM,IAAI,IAAI;AAAA,cACb,KAAK,SAAS;AAAA,cACd;AAAA,cACA;AAAA,cACA,CAAC;AAAA,YACF,CAAC;AAAA,UACF;AACA;AACC,kBAAM,IAAI,QAAQ,MAAM,CAAAA;AAAA;AAAA,cAAuD,EAAE,uBAAuBA,OAAM,EAAE,kBAAkB;AAAA,aAAC;AACnI,kBAAM,cAAc,IAAI,oBAAoB,GAAG,EAAE;AACjD,yBAAa,KAAK,WAAW;AAC7B,kBAAM,IAAI,IAAI;AAAA,cACb,KAAK,SAAS;AAAA,cACd;AAAA,cACA;AAAA,YACD,CAAC;AAAA,UACF;AAAA,QACD,OAAO;AACN;AACC,kBAAM,IAAI,QAAQ,MAAM,CAAAA;AAAA;AAAA,cAAuD,EAAE,uBAAuBA,OAAM,EAAE,kBAAkB;AAAA,aAAC;AACnI,kBAAM,SAAS,IAAI,oBAAoB,GAAG,EAAE;AAC5C,0BAAc,KAAK,MAAM;AACzB,kBAAM,IAAI,IAAI;AAAA,cACb,KAAK,SAAS;AAAA,cACd;AAAA,cACA;AAAA,cACA,EAAE;AAAA,cACF,CAAC;AAAA,cACD;AAAA,cACA,OAAK,KAAK,WAAW,IAAI,EAAG,4BAA4B,GAAG,iBAAiB,YAAY,MAAS;AAAA,cACjG,KAAK;AAAA,YACN,CAAC;AAAA,UACF;AACA;AACC,kBAAM,IAAI,QAAQ,MAAM,CAAAA;AAAA;AAAA,cAAuD,EAAE,uBAAuBA,OAAM,EAAE,kBAAkB;AAAA,aAAC;AACnI,kBAAM,cAAc,IAAI,oBAAoB,GAAG,EAAE;AACjD,yBAAa,KAAK,WAAW;AAC7B,kBAAM,IAAI,IAAI;AAAA,cACb,KAAK,SAAS;AAAA,cACd;AAAA,cACA;AAAA,cACA,EAAE;AAAA,cACF;AAAA,cACA;AAAA,cACA,OAAK,KAAK,WAAW,IAAI,EAAG,4BAA4B,GAAG,iBAAiB,YAAY,MAAS;AAAA,cACjG,KAAK;AAAA,YACN,CAAC;AAAA,UACF;AAAA,QACD;AAAA,MACD;AAEA,aAAO,EAAE,eAAe,aAAc;AAAA,IACvC,CAAC;AAGD,UAAM,2BAAoD;AAAA,MACzD,aAAa;AAAA,MACb,WAAW;AAAA,MACX,aAAa;AAAA,IACd;AACA,UAAM,+BAAwD;AAAA,MAC7D,aAAa;AAAA,MACb,yBAAyB,IAAI,eAAe,QAAW,EAAE,WAAW,MAAM,mBAAmB,KAAK,CAAC,EACjG,eAAe,SAAS,iBAAiB,uBAAuB,CAAC;AAAA,MACnE,sBAAsB,oBAAoB,UAAU,YAAY,QAAQ,IAAI;AAAA,MAC5E,QAAQ;AAAA,IACT;AAEA,SAAK,UAAU,2BAA2B,KAAK,SAAS,UAAU,QAAQ,MAAM,YAAU;AAEzF,YAAM,sBAAsB,iBAAiB,KAAK,MAAM;AACxD,YAAM,SAAS,oBAAoB,IAA2B,QAAM;AAAA,QACnE,OAAO,EAAE,uBAAuB,iBAAiB;AAAA,QACjD,SAAS;AAAA,MACV,EAAE;AACF,iBAAW,KAAK,qBAAqB;AACpC,YAAI,EAAE,mBAAmB,MAAM,GAAG;AACjC,iBAAO,KAAK;AAAA,YACX,OAAO,MAAM,cAAc,IAAI,SAAS,EAAE,oBAAoB,CAAC,CAAC;AAAA,YAChE,SAAS;AAAA,UACV,CAAC;AAAA,QACF;AAAA,MACD;AACA,aAAO;AAAA,IACR,CAAC,CAAC,CAAC;AAEH,SAAK,UAAU,2BAA2B,KAAK,SAAS,UAAU,QAAQ,MAAM,YAAU;AAEzF,YAAM,sBAAsB,iBAAiB,KAAK,MAAM;AACxD,YAAM,SAAS,oBAAoB,IAA2B,QAAM;AAAA,QACnE,OAAO,EAAE,uBAAuB,iBAAiB;AAAA,QACjD,SAAS;AAAA,MACV,EAAE;AACF,iBAAW,KAAK,qBAAqB;AACpC,YAAI,EAAE,mBAAmB,MAAM,GAAG;AACjC,iBAAO,KAAK;AAAA,YACX,OAAO,UAAU,SAAS,EAAE,oBAAoB,CAAC,EAAE,iBAAiB;AAAA,YACpE,SAAS;AAAA,UACV,CAAC;AAAA,QACF;AAAA,MACD;AACA,aAAO;AAAA,IACR,CAAC,CAAC,CAAC;AAEH,SAAK,UAAU,QAAQ,CAAC,WAAW;AAElC,YAAM,sBAAsB,iBAAiB,KAAK,MAAM;AACxD,WAAK,yBAAyB;AAC9B,UAAI;AACH,aAAK,SAAS,SAAS,eAAe,oBAAoB,IAAI,OAAK,EAAE,uBAAuB,MAAM,EAAE,iBAAiB,CAAC,EAAE,OAAO,SAAS,CAAC;AACzI,aAAK,SAAS,SAAS,eAAe,oBAAoB,IAAI,OAAK,EAAE,uBAAuB,MAAM,EAAE,iBAAiB,CAAC,EAAE,OAAO,SAAS,CAAC;AAAA,MAC1I,UAAE;AACD,aAAK,yBAAyB;AAAA,MAC/B;AAAA,IACD,CAAC,CAAC;AAEF,SAAK,UAAU,KAAK,SAAS,SAAS,UAAU,WAAS;AACxD,UAAI,CAAC,MAAM,MAAM,eAAe,MAAM,OAAO,YAAY,MAAM,OAAO,SAAS,UAAU,SAAS,gBAAgB,GAAG;AACpH,cAAM,aAAa,MAAM,OAAO,SAAS;AACzC,cAAM,QAAQ,KAAK,WAAW,IAAI;AAClC,YAAI,CAAC,OAAO;AAAE;AAAA,QAAQ;AACtB,cAAM,SAAS,MAAM,iBAAiB,IAAI,EAAE,KAAK,OAAK,EAAE,uBAAuB,SAAS,UAAU,CAAC;AACnG,YAAI,CAAC,QAAQ;AAAE;AAAA,QAAQ;AACvB,eAAO,YAAY,MAAS;AAC5B,cAAM,MAAM,gBAAgB;AAC5B,cAAM,MAAM,eAAe;AAAA,MAC5B;AAAA,IACD,CAAC,CAAC;AAEF,SAAK,UAAU,KAAK,SAAS,SAAS,UAAU,WAAS;AACxD,UAAI,CAAC,MAAM,MAAM,eAAe,MAAM,OAAO,YAAY,MAAM,OAAO,SAAS,UAAU,SAAS,gBAAgB,GAAG;AACpH,cAAM,aAAa,MAAM,OAAO,SAAS;AACzC,cAAM,QAAQ,KAAK,WAAW,IAAI;AAClC,YAAI,CAAC,OAAO;AAAE;AAAA,QAAQ;AACtB,cAAM,SAAS,MAAM,iBAAiB,IAAI,EAAE,KAAK,OAAK,EAAE,uBAAuB,SAAS,UAAU,CAAC;AACnG,YAAI,CAAC,QAAQ;AAAE;AAAA,QAAQ;AACvB,eAAO,YAAY,MAAS;AAC5B,cAAM,MAAM,gBAAgB;AAC5B,cAAM,MAAM,eAAe;AAAA,MAC5B;AAAA,IACD,CAAC,CAAC;AAAA,EACH;AAAA,EA9TD,OAmE4D;AAAA;AAAA;AAAA,EAC3D,OAAwB,4BAA4B,gBAKlD,6BAA6B,OAAO;AAAA,IACrC,UAAU;AAAA,IAAC;AAAA,IACX,mBAAmB,YAAY,QAAQ;AACtC,aAAO,CAAC;AAAA,IACT;AAAA,EACD,EAAE;AAAA,EACF,OAAc,4BACb,SAIC;AACD,SAAK,0BAA0B,IAAI,SAAS,MAAS;AAAA,EACtD;AAAA,EAEiB,yBAAyB;AAAA,IACzC;AAAA,IACA,CAAC,WAAW;AACX,YAAM,IAAI,KAAK,SAAS,cAAc,KAAK,MAAM;AACjD,YAAM,UACL,4BAA4B,0BAA0B;AAAA,QACrD;AAAA,MACD;AACD,aAAO,CAAC,KAAK,CAAC,UACX,SACA,QAAQ,GAAG,KAAK,qBAAqB;AAAA,IACzC;AAAA,EACD;AAAA,EAEgB;AAAA,EAKR,yBAAyB;AAAA,EACjC,IAAW,wBAAwB;AAClC,WAAO,KAAK;AAAA,EACb;AAiND;AA5Pa,8BAAN;AAAA,EAiDJ;AAAA,GAjDU;AA8Pb,MAAM,0CAA0C,sBAAsB;AAAA,EAOrE,YACC,QACA,WACiB,kBACA,QAAiB,OACjC;AACD,UAAM,OAAO,EAAE,8BAA8B;AAC7C,UAAM,QAAQ,WAAW,KAAK,IAAI;AAJjB;AACA;AAIjB,SAAK,KAAK,YAAY,KAAK,OAAO,IAAI;AAEtC,QAAI,KAAK,OAAO;AACf,WAAK,OAAO,KAAK,gBAAgB;AAAA,IAClC;AAEA,SAAK;AAAA,MACJ,QAAQ,CAAC,WAAW;AAGnB,YAAI,CAAC,KAAK,OAAO;AAChB,gBAAM,YACL,KAAK,iBAAiB;AAAA,YACrB;AAAA,UACD,EAAE;AACH,gBAAM,kBAAkB;AAAA,YACvB;AAAA,YACA;AAAA,YACA;AAAA,UACD;AACA,eAAK,OAAO,KAAK,YAAY;AAAA,QAC9B;AAAA,MACD,CAAC;AAAA,IACF;AAAA,EACD;AAAA,EAxWD,OAiUsE;AAAA;AAAA;AAAA,EACpD,SAAS,EAAE,iCAAiC;AAAA,IAC5D,EAAE,iBAAiB,CAAC,CAAC;AAAA,IACrB,EAAE,iBAAiB,CAAC,CAAC;AAAA,IACrB,EAAE,kBAAkB,CAAC,CAAC;AAAA,EACvB,CAAC;AAmCF;AAEA,MAAM,mCAAmC,sBAAsB;AAAA,EAkD9D,YACkB,SACjB,WACiB,kBACA,uBACA,OACA,wBACA,2BAGA,UAChB;AACD,UAAM,OAAO,EAAE,8BAA8B;AAC7C,UAAM,SAAS,WAAW,KAAK,IAAI;AAZlB;AAEA;AACA;AACA;AACA;AACA;AAGA;AAIjB,SAAK,KAAK,YAAY,KAAK,OAAO,IAAI;AAEtC,QAAI,KAAK,OAAO;AACf,YAAM,KAAK,OAAO,KAAK;AAAA,IACxB,OAAO;AACN,WAAK;AAAA,QACJ,WAAW,KAAK,OAAO,OAAO;AAAA,UAC7B,OAAO,qBAAqB,KAAK,OAAO,EACtC;AAAA,QACH,CAAC;AAAA,MACF;AAAA,IACD;AAEA,SAAK;AAAA,MACJ,QAAQ,CAAC,WAAW;AAEnB,cAAM,kBACL,KAAK,iBAAiB,oBAAoB,KAAK,MAAM,IACpD,KAAK,iBAAiB,uBAAuB;AAAA,UAC5C;AAAA,QACD,MACD,KAAK,iBAAiB;AAEvB,aAAK,OAAO,OAAO,UAAU;AAAA,UAC5B;AAAA,UACA,CAAC;AAAA,QACF;AACA,aAAK,OAAO,OAAO,UAAU;AAAA,UAC5B;AAAA,UACA,KAAK,iBAAiB,uBAAuB,KAAK,MAAM,IACvD;AAAA,QACF;AACA,aAAK,OAAO,IAAI,UAAU;AAAA,UACzB;AAAA,UACA,KAAK,iBAAiB,oBAAoB,KAAK,MAAM,IAAI;AAAA,QAC1D;AACA,aAAK,OAAO,IAAI,UAAU;AAAA,UACzB;AAAA,UACA,CAAC;AAAA,QACF;AACA,cAAM,YAAY,KAAK,iBAAiB,UAAU,KAAK,MAAM;AAC7D,cAAM,UAAU,KAAK,QAAQ,WAAW;AACxC,YAAI,SAAS;AACZ,kBAAQ,UAAU;AAAA,YACjB;AAAA,YACA,CAAC,CAAC;AAAA,UACH;AACA,cAAI,cAAc,OAAO;AACxB,oBAAQ,UAAU;AAAA,cACjB;AAAA,cACA,KAAK,iBAAiB,oBAAoB;AAAA,gBACzC;AAAA,cACD,IAAI;AAAA,YACL;AACA,oBAAQ,UAAU;AAAA,cACjB;AAAA,cACA,CAAC;AAAA,YACF;AAAA,UACD,WAAW,cAAc,UAAU;AAClC,oBAAQ,UAAU;AAAA,cACjB;AAAA,cACA,CAAC;AAAA,YACF;AACA,oBAAQ,UAAU;AAAA,cACjB;AAAA,cACA,KAAK,iBAAiB,uBAAuB;AAAA,gBAC5C;AAAA,cACD,IAAI;AAAA,YACL;AAAA,UACD,OAAO;AACN,oBAAQ,UAAU,OAAO,cAAc,KAAK;AAC5C,oBAAQ,UAAU,OAAO,iBAAiB,KAAK;AAAA,UAChD;AAAA,QACD;AAAA,MACD,CAAC;AAAA,IACF;AAEA,UAAM,SAAS,KAAK;AAEpB,SAAK;AAAA,MACJ,sBAAsB,KAAK,OAAO,KAAK,aAAa,CAAC,MAAM;AAC1D,YAAI,EAAE,WAAW,GAAG;AACnB;AAAA,QACD;AACA,aAAK,OAAO,IAAI,UAAU,OAAO,YAAY,IAAI;AACjD,aAAK,OAAO,KAAK,UAAU,OAAO,YAAY,IAAI;AAClD,UAAE,eAAe;AACjB,cAAM,WAAW,EAAE;AACnB,YAAI,UAAU;AACd,cAAM,MAAM,KAAK,iBAAiB,oBAAoB,IAAI;AAC1D,aAAK,iBAAiB,UAAU,IAAI,OAAO,MAAS;AAEpD,cAAM,SAAS,UAAU,KAAK,OAAO,GAAG;AAExC,cAAM,oBAAoB;AAAA,UACzB;AAAA,UACA;AAAA,UACA,CAACC,OAAM;AACN,kBAAM,aAAaA,GAAE;AACrB,kBAAM,QAAQ,aAAa;AAC3B,sBAAU,WAAW,KAAK,IAAI,KAAK,IAAI;AACvC,kBAAM,YAAY,KAAK;AAAA,cACtB,QAAQ,OAAO,UAAU,aAAa,UAAU;AAAA,YACjD;AACA,kBAAM,SAAS,KAAK;AAAA,cACnB;AAAA,cACA,KAAK;AAAA,gBACJ,MAAM;AAAA,gBACN,KAAK,iBAAiB,0BAA0B;AAAA,cACjD;AAAA,YACD;AACA,iBAAK,iBAAiB,oBAAoB;AAAA,cACzC;AAAA,cACA;AAAA,YACD;AAAA,UACD;AAAA,QACD;AAEA,cAAM,kBAAkB;AAAA,UACvB;AAAA,UACA;AAAA,UACA,CAACA,OAAM;AACN,gBAAI,CAAC,SAAS;AACb,mBAAK,iBAAiB;AAAA,gBACrB,KAAK,SAAS,oCAAoC,IAAI;AAAA,gBACtD;AAAA,cACD;AAAA,YACD;AACA,iBAAK,OAAO,IAAI,UAAU,OAAO,YAAY,KAAK;AAClD,iBAAK,OAAO,KAAK,UAAU,OAAO,YAAY,KAAK;AACnD,iBAAK,iBAAiB,UAAU;AAAA,cAC/B;AAAA,cACA;AAAA,YACD;AACA,8BAAkB,QAAQ;AAC1B,4BAAgB,QAAQ;AAAA,UACzB;AAAA,QACD;AAAA,MACD,CAAC;AAAA,IACF;AAEA,SAAK;AAAA,MACJ,sBAAsB,KAAK,OAAO,QAAQ,aAAa,CAAC,MAAM;AAC7D,YAAI,EAAE,WAAW,GAAG;AACnB;AAAA,QACD;AACA,aAAK,OAAO,OAAO,UAAU,OAAO,YAAY,IAAI;AACpD,aAAK,OAAO,KAAK,UAAU,OAAO,YAAY,IAAI;AAClD,UAAE,eAAe;AACjB,cAAM,WAAW,EAAE;AACnB,YAAI,UAAU;AACd,cAAM,MAAM,KAAK,iBAAiB,uBAAuB,IAAI;AAC7D,aAAK,iBAAiB,UAAU,IAAI,UAAU,MAAS;AAEvD,cAAM,SAAS,UAAU,KAAK,OAAO,MAAM;AAE3C,cAAM,oBAAoB;AAAA,UACzB;AAAA,UACA;AAAA,UACA,CAACA,OAAM;AACN,kBAAM,aAAaA,GAAE;AACrB,kBAAM,QAAQ,aAAa;AAC3B,sBAAU,WAAW,KAAK,IAAI,KAAK,IAAI;AACvC,kBAAM,YAAY,KAAK;AAAA,cACtB,QAAQ,OAAO,UAAU,aAAa,UAAU;AAAA,YACjD;AACA,kBAAM,SAAS,KAAK;AAAA,cACnB;AAAA,cACA,KAAK;AAAA,gBACJ,MAAM;AAAA,gBACN,KAAK,iBAAiB,6BAA6B;AAAA,cACpD;AAAA,YACD;AACA,kBAAM,MACL,KAAK,sBAAsB,yBAC3B,OAAO,SAAS,EAAG,aAAa,IAC7B,OAAO,iBAAiB,IACxB,OAAO;AAAA,cACP,KAAK,sBACH;AAAA,YACH;AACH,iBAAK,iBAAiB,uBAAuB;AAAA,cAC5C;AAAA,cACA;AAAA,YACD;AACA,kBAAM,OACL,KAAK,sBAAsB,yBAC3B,OAAO,SAAS,EAAG,aAAa,IAC7B,OAAO,iBAAiB,IACxB,OAAO;AAAA,cACP,KAAK,sBACH;AAAA,YACH;AACH,mBAAO;AAAA,cACN,OAAO,aAAa,KAAK,OAAO;AAAA,YACjC;AAAA,UACD;AAAA,QACD;AAEA,cAAM,kBAAkB;AAAA,UACvB;AAAA,UACA;AAAA,UACA,CAACA,OAAM;AACN,iBAAK,iBAAiB,UAAU;AAAA,cAC/B;AAAA,cACA;AAAA,YACD;AAEA,gBAAI,CAAC,SAAS;AACb,oBAAM,MAAM,OAAO;AAAA,gBAClB,KAAK,sBACH;AAAA,cACH;AAEA,mBAAK,iBAAiB;AAAA,gBACrB,KAAK,SAAS,oCAAoC,IAAI;AAAA,gBACtD;AAAA,cACD;AACA,oBAAM,OAAO,OAAO;AAAA,gBACnB,KAAK,sBACH;AAAA,cACH;AACA,qBAAO;AAAA,gBACN,OAAO,aAAa,KAAK,OAAO;AAAA,cACjC;AAAA,YACD;AACA,iBAAK,OAAO,OAAO,UAAU,OAAO,YAAY,KAAK;AACrD,iBAAK,OAAO,KAAK,UAAU,OAAO,YAAY,KAAK;AACnD,8BAAkB,QAAQ;AAC1B,4BAAgB,QAAQ;AAAA,UACzB;AAAA,QACD;AAAA,MACD,CAAC;AAAA,IACF;AAEA,SAAK;AAAA,MACJ,QAAQ,CAAC,WAAW;AAGnB,cAAM,WAA0B,CAAC;AACjC,YAAI,CAAC,KAAK,OAAO;AAChB,gBAAM,YACL,iBAAiB,uBAAuB,MAAM,EAAE;AACjD,gBAAM,kBAAkB;AAAA,YACvB;AAAA,YACA;AAAA,YACA;AAAA,UACD;AACA,gBAAM,OAAO;AAAA,YACZ;AAAA,YACA;AAAA,cACC,OAAO;AAAA,gBACN;AAAA,gBACA;AAAA,cACD;AAAA,YACD;AAAA,YACA;AAAA,UACD;AACA,eAAK,iBAAiB,YAAY,CAAC,MAAM;AACxC,gBAAI,EAAE,WAAW,GAAG;AACnB;AAAA,YACD;AACA,cAAE,eAAe;AACjB,iBAAK,iBAAiB,QAAQ,MAAS;AAAA,UACxC,CAAC;AACD,mBAAS,KAAK,IAAI;AAElB,gBAAM,QACL,KAAK,iBAAiB,uBAAuB,MAAM;AACpD,gBAAM,QACL,KAAK,uBAAuB;AAAA,YAC3B;AAAA,YACA;AAAA,UACD;AAED,cAAI,MAAM,SAAS,GAAG;AACrB,qBAAS;AAAA,cACR,EAAE,QAAQ,QAAW,mBAA2B;AAAA,YACjD;AAEA,qBAAS,IAAI,GAAG,IAAI,MAAM,QAAQ,KAAK;AACtC,oBAAM,OAAO,MAAM,CAAC;AACpB,oBAAM,OAAO,YAAY,OAAO,KAAK,IAAI;AACzC,oBAAM,UAAU;AAAA,gBACf;AAAA,gBACA;AAAA,kBACC,OAAO;AAAA,oBACN,SAAS;AAAA,oBACT,YAAY;AAAA,kBACb;AAAA,gBACD;AAAA,gBACA;AAAA,kBACC,WAAW,IAAI;AAAA,kBACf;AAAA,kBACA,KAAK;AAAA,kBACL,GAAI,MAAM,MAAM,SAAS,IACtB,CAAC,IACD,CAAC,WAAW,QAAQ,YAAY,CAAC;AAAA,gBACrC;AAAA,cACD,EAAE;AACF,uBAAS,KAAK,OAAO;AACrB,sBAAQ,UAAU,MAAM;AACvB,qBAAK;AAAA,kBACJ,KAAK;AAAA,gBACN;AAAA,cACD;AAAA,YACD;AAAA,UACD;AAAA,QACD;AAEA,cAAM,KAAK,OAAO,QAAQ,GAAG,QAAQ;AAAA,MACtC,CAAC;AAAA,IACF;AAAA,EACD;AAAA,EApuBD,OA2W+D;AAAA;AAAA;AAAA,EAC7C,SAAS,EAAE,yBAAyB;AAAA,IACpD,EAAE,eAAe;AAAA,MAChB,OAAO;AAAA,QACN;AAAA,QACA;AAAA,MACD;AAAA,IACD,CAAC;AAAA,IACD,EAAE,sBAAsB,EAAE,OAAO,EAAE,SAAS,OAAO,EAAE,GAAG;AAAA,MACvD;AAAA,QACC;AAAA,QACA;AAAA,UACC,OAAO;AAAA,YACN,SAAS;AAAA,YACT,gBAAgB;AAAA,YAChB,YAAY;AAAA,YACZ,YAAY;AAAA,UACb;AAAA,QACD;AAAA,QACA;AAAA,UACC;AAAA,YACC;AAAA,YACA;AAAA,cACC,OAAO;AAAA,gBACN;AAAA,gBACA;AAAA,cACD;AAAA,cACA,MAAM;AAAA,cACN,SAAS,6BAAM;AACd,qBAAK,iBAAiB,QAAQ,MAAS;AAAA,cACxC,GAFS;AAAA,YAGV;AAAA,YACA,GAAG,qBAAqB,WAAW;AAAA,UACpC;AAAA,QACD;AAAA,MACD;AAAA,MACA,EAAE,cAAc;AAAA,QACf,OAAO;AAAA,UACN,SAAS;AAAA,UACT,gBAAgB;AAAA,UAChB,YAAY;AAAA,QACb;AAAA,MACD,CAAC;AAAA,IACF,CAAC;AAAA,IACD,EAAE,qBAAqB;AAAA,MACtB,OAAO,SAAS,eAAe,kCAAkC;AAAA,MACjE,MAAM;AAAA,IACP,CAAC;AAAA,EACF,CAAC;AA0UF;",
  "names": ["reader", "e"]
}
