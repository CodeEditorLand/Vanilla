var z5=Object.defineProperty;var K5=Object.getOwnPropertyDescriptor;var O=(o,e,t,n)=>{for(var i=n>1?void 0:n?K5(e,t):e,r=o.length-1,s;r>=0;r--)(s=o[r])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&z5(e,t,i),i},x=(o,e)=>(t,n)=>e(t,n,o);function Vc(o,e){let t=G5(o,e);if(t!==-1)return o[t]}function G5(o,e,t=o.length-1){for(let n=t;n>=0;n--){let i=o[n];if(e(i))return n}return-1}function sl(o,e){let t=al(o,e);return t===-1?void 0:o[t]}function al(o,e,t=0,n=o.length){let i=t,r=n;for(;i<r;){let s=Math.floor((i+r)/2);e(o[s])?i=s+1:r=s}return i-1}function ON(o,e){let t=Kg(o,e);return t===o.length?void 0:o[t]}function Kg(o,e,t=0,n=o.length){let i=t,r=n;for(;i<r;){let s=Math.floor((i+r)/2);e(o[s])?r=s:i=s+1}return i}var zg=class o{constructor(e){this._array=e}static assertInvariants=!1;_findLastMonotonousLastIdx=0;_prevFindLastPredicate;findLastMonotonous(e){if(o.assertInvariants){if(this._prevFindLastPredicate){for(let n of this._array)if(this._prevFindLastPredicate(n)&&!e(n))throw new Error("MonotonousArray: current predicate must be weaker than (or equal to) the previous predicate.")}this._prevFindLastPredicate=e}let t=al(this._array,e,this._findLastMonotonousLastIdx);return this._findLastMonotonousLastIdx=t+1,t===-1?void 0:this._array[t]}};function j5(o,e){if(o.length===0)return;let t=o[0];for(let n=1;n<o.length;n++){let i=o[n];e(i,t)>0&&(t=i)}return t}function NN(o,e){if(o.length===0)return;let t=o[0];for(let n=1;n<o.length;n++){let i=o[n];e(i,t)>=0&&(t=i)}return t}function AN(o,e){return j5(o,(t,n)=>-e(t,n))}function FN(o,e){if(o.length===0)return-1;let t=0;for(let n=1;n<o.length;n++){let i=o[n];e(i,o[t])>0&&(t=n)}return t}var ED=class{unexpectedErrorHandler;listeners;constructor(){this.listeners=[],this.unexpectedErrorHandler=function(e){setTimeout(()=>{throw e.stack?ll.isErrorNoTelemetry(e)?new ll(e.message+`

`+e.stack):new Error(e.message+`

`+e.stack):e},0)}}addListener(e){return this.listeners.push(e),()=>{this._removeListener(e)}}emit(e){this.listeners.forEach(t=>{t(e)})}_removeListener(e){this.listeners.splice(this.listeners.indexOf(e),1)}setUnexpectedErrorHandler(e){this.unexpectedErrorHandler=e}getUnexpectedErrorHandler(){return this.unexpectedErrorHandler}onUnexpectedError(e){this.unexpectedErrorHandler(e),this.emit(e)}onUnexpectedExternalError(e){this.unexpectedErrorHandler(e)}},BN=new ED;function Rp(o){BN.onUnexpectedError(o)}function qe(o){Sy(o)||BN.onUnexpectedError(o)}var TD="Canceled";function Sy(o){return o instanceof Vi?!0:o instanceof Error&&o.name===TD&&o.message===TD}var Vi=class extends Error{constructor(){super(TD),this.name=this.message}};function Wc(o){return o?new Error(`Illegal argument: ${o}`):new Error("Illegal argument")}function VN(o){return o?new Error(`Illegal state: ${o}`):new Error("Illegal state")}function xD(o){return o?o.message?o.message:o.stack?o.stack.split(`
`)[0]:String(o):"Error"}var Cy=class extends Error{constructor(e){super("NotSupported"),e&&(this.message=e)}};var ll=class o extends Error{name;constructor(e){super(e),this.name="CodeExpectedError"}static fromError(e){if(e instanceof o)return e;let t=new o;return t.message=e.message,t.stack=e.stack,t}static isErrorNoTelemetry(e){return e.name==="CodeExpectedError"}},Ye=class o extends Error{constructor(e){super(e||"An unexpected bug occurred."),Object.setPrototypeOf(this,o.prototype)}};function Do(o,e=0){return o[o.length-(1+e)]}function Ty(o){if(o.length===0)throw new Error("Invalid tail call");return[o.slice(0,o.length-1),o[o.length-1]]}function zt(o,e,t=(n,i)=>n===i){if(o===e)return!0;if(!o||!e||o.length!==e.length)return!1;for(let n=0,i=o.length;n<i;n++)if(!t(o[n],e[n]))return!1;return!0}function WN(o,e){let t=o.length-1;e<t&&(o[e]=o[t]),o.pop()}function HN(o,e,t){return $5(o.length,n=>t(o[n],e))}function $5(o,e){let t=0,n=o-1;for(;t<=n;){let i=(t+n)/2|0,r=e(i);if(r<0)t=i+1;else if(r>0)n=i-1;else return i}return-(t+1)}function*kp(o,e){let t,n;for(let i of o)n!==void 0&&e(n,i)?t.push(i):(t&&(yield t),t=[i]),n=i;t&&(yield t)}function xy(o,e){for(let t=0;t<=o.length;t++)e(t===0?void 0:o[t-1],t===o.length?void 0:o[t])}function UN(o,e){for(let t=0;t<o.length;t++)e(t===0?void 0:o[t-1],o[t],t+1===o.length?void 0:o[t+1])}function Er(o){return o.filter(e=>!!e)}function wD(o){let e=0;for(let t=0;t<o.length;t++)o[t]&&(o[e]=o[t],e+=1);o.length=e}function Tr(o,e=t=>t){let t=new Set;return o.filter(n=>{let i=e(n);return t.has(i)?!1:(t.add(i),!0)})}function Yn(o,e){let t=typeof e=="number"?o:0;typeof e=="number"?t=o:(t=0,e=o);let n=[];if(t<=e)for(let i=t;i<e;i++)n.push(i);else for(let i=t;i>e;i--)n.push(i);return n}function wy(o,e){return o.push(e),()=>Y5(o,e)}function Y5(o,e){let t=o.indexOf(e);if(t>-1)return o.splice(t,1),e}function sa(o,e,t){let n=o.slice(0,e),i=o.slice(e);return n.concat(t,i)}function _y(o,e){let t=o.indexOf(e);t>-1&&(o.splice(t,1),o.unshift(e))}function Gg(o,e){let t=o.indexOf(e);t>-1&&(o.splice(t,1),o.push(e))}function jg(o,e){for(let t of e)o.push(t)}function Z5(o,e,t){let n=zN(o,e),i=o.length,r=t.length;o.length=i+r;for(let s=i-1;s>=n;s--)o[s+r]=o[s];for(let s=0;s<r;s++)o[s+n]=t[s]}function _D(o,e,t,n){let i=zN(o,e),r=o.splice(i,t);return r===void 0&&(r=[]),Z5(o,i,n),r}function zN(o,e){return e<0?Math.max(e+o.length,0):Math.min(e,o.length)}var Ey;(a=>{function o(l){return l<0}a.isLessThan=o;function e(l){return l<=0}a.isLessThanOrEqual=e;function t(l){return l>0}a.isGreaterThan=t;function n(l){return l===0}a.isNeitherLessOrGreaterThan=n,a.greaterThan=1,a.lessThan=-1,a.neitherLessOrGreaterThan=0})(Ey||={});function mo(o,e){return(t,n)=>e(o(t),o(n))}function KN(...o){return(e,t)=>{for(let n of o){let i=n(e,t);if(!Ey.isNeitherLessOrGreaterThan(i))return i}return Ey.neitherLessOrGreaterThan}}var aa=(o,e)=>o-e,GN=(o,e)=>aa(o?1:0,e?1:0);function jN(o){return(e,t)=>-o(e,t)}var Wi=class{constructor(e){this.items=e}firstIdx=0;lastIdx=this.items.length-1;get length(){return this.lastIdx-this.firstIdx+1}takeWhile(e){let t=this.firstIdx;for(;t<this.items.length&&e(this.items[t]);)t++;let n=t===this.firstIdx?null:this.items.slice(this.firstIdx,t);return this.firstIdx=t,n}takeFromEndWhile(e){let t=this.lastIdx;for(;t>=0&&e(this.items[t]);)t--;let n=t===this.lastIdx?null:this.items.slice(t+1,this.lastIdx+1);return this.lastIdx=t,n}peek(){if(this.length!==0)return this.items[this.firstIdx]}peekLast(){if(this.length!==0)return this.items[this.lastIdx]}dequeue(){let e=this.items[this.firstIdx];return this.firstIdx++,e}removeLast(){let e=this.items[this.lastIdx];return this.lastIdx--,e}takeCount(e){let t=this.items.slice(this.firstIdx,this.firstIdx+e);return this.firstIdx+=e,t}},dl=class o{constructor(e){this.iterate=e}static empty=new o(e=>{});forEach(e){this.iterate(t=>(e(t),!0))}toArray(){let e=[];return this.iterate(t=>(e.push(t),!0)),e}filter(e){return new o(t=>this.iterate(n=>e(n)?t(n):!0))}map(e){return new o(t=>this.iterate(n=>t(e(n))))}some(e){let t=!1;return this.iterate(n=>(t=e(n),!t)),t}findFirst(e){let t;return this.iterate(n=>e(n)?(t=n,!1):!0),t}findLast(e){let t;return this.iterate(n=>(e(n)&&(t=n),!0)),t}findLastMaxBy(e){let t,n=!0;return this.iterate(i=>((n||Ey.isGreaterThan(e(i,t)))&&(n=!1,t=i),!0)),t}};function qN(o,e){let t=new Set;for(let n of e)o.has(n)&&t.add(n);return t}function DD(){return globalThis._VSCODE_NLS_MESSAGES}function qg(){return globalThis._VSCODE_NLS_LANGUAGE}var X5=qg()==="pseudo"||typeof document<"u"&&document.location&&document.location.hash.indexOf("pseudo=true")>=0;function Dy(o,e){let t;return e.length===0?t=o:t=o.replace(/\{(\d+)\}/g,(n,i)=>{let r=i[0],s=e[r],a=n;return typeof s=="string"?a=s:(typeof s=="number"||typeof s=="boolean"||s===void 0||s===null)&&(a=String(s)),a}),X5&&(t="\uFF3B"+t.replace(/[aouei]/g,"$&$&")+"\uFF3D"),t}function m(o,e,...t){return Dy(typeof o=="number"?$N(o,e):e,t)}function $N(o,e){let t=DD()?.[o];if(typeof t!="string"){if(typeof e=="string")return e;throw new Error(`!!! NLS MISSING: ${o} !!!`)}return t}function Zo(o,e,...t){let n;typeof o=="number"?n=$N(o,e):n=e;let i=Dy(n,t);return{value:i,original:e===n?i:Dy(e,t)}}var Mp="en",Zg=!1,Xg=!1,Yg=!1,Q5=!1,QN=!1,LD=!1,J5=!1,RD=!1,ez=!1,JN=!1,$g,Ly=Mp,YN=Mp,tz,cl,ul=globalThis,wr;typeof ul.vscode<"u"&&typeof ul.vscode.process<"u"?wr=ul.vscode.process:typeof process<"u"&&typeof process?.versions?.node=="string"&&(wr=process);var eA=typeof wr?.versions?.electron=="string",nz=eA&&wr?.type==="renderer";if(typeof wr=="object"){Zg=wr.platform==="win32",Xg=wr.platform==="darwin",Yg=wr.platform==="linux",Q5=Yg&&!!wr.env.SNAP&&!!wr.env.SNAP_REVISION,J5=eA,ez=!!wr.env.CI||!!wr.env.BUILD_ARTIFACTSTAGINGDIRECTORY,$g=Mp,Ly=Mp;let o=wr.env.VSCODE_NLS_CONFIG;if(o)try{let e=JSON.parse(o);$g=e.userLocale,YN=e.osLocale,Ly=e.resolvedLanguage||Mp,tz=e.languagePack?.translationsConfigFile}catch{}QN=!0}else typeof navigator=="object"&&!nz?(cl=navigator.userAgent,Zg=cl.indexOf("Windows")>=0,Xg=cl.indexOf("Macintosh")>=0,RD=(cl.indexOf("Macintosh")>=0||cl.indexOf("iPad")>=0||cl.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,Yg=cl.indexOf("Linux")>=0,JN=cl?.indexOf("Mobi")>=0,LD=!0,Ly=qg()||Mp,$g=navigator.language.toLowerCase(),YN=$g):console.error("Unable to resolve platform.");function kD(o){switch(o){case 0:return"Web";case 1:return"Mac";case 2:return"Linux";case 3:return"Windows"}}var Ry=0;Xg?Ry=1:Zg?Ry=3:Yg&&(Ry=2);var pt=Zg,Ve=Xg,At=Yg;var ca=QN;var Hn=LD,iz=LD&&typeof ul.importScripts=="function",tA=iz?ul.origin:void 0,jr=RD,ky=JN;var Pp=Ry,da=cl,la=Ly,oz;(n=>{function o(){return la}n.value=o;function e(){return la.length===2?la==="en":la.length>=3?la[0]==="e"&&la[1]==="n"&&la[2]==="-":!1}n.isDefaultVariant=e;function t(){return la==="en"}n.isDefault=t})(oz||={});var nA=$g;var rz=typeof ul.postMessage=="function"&&!ul.importScripts,My=(()=>{if(rz){let o=[];ul.addEventListener("message",t=>{if(t.data&&t.data.vscodeScheduleAsyncWork)for(let n=0,i=o.length;n<i;n++){let r=o[n];if(r.id===t.data.vscodeScheduleAsyncWork){o.splice(n,1),r.callback();return}}});let e=0;return t=>{let n=++e;o.push({id:n,callback:t}),ul.postMessage({vscodeScheduleAsyncWork:n},"*")}}return o=>setTimeout(o)})();var qr=Xg||RD?2:Zg?1:3,ZN=!0,XN=!1;function iA(){if(!XN){XN=!0;let o=new Uint8Array(2);o[0]=1,o[1]=2,ZN=new Uint16Array(o.buffer)[0]===513}return ZN}var Qg=!!(da&&da.indexOf("Chrome")>=0),Op=!!(da&&da.indexOf("Firefox")>=0),Py=!!(!Qg&&da&&da.indexOf("Safari")>=0),Oy=!!(da&&da.indexOf("Edg/")>=0),Ny=!!(da&&da.indexOf("Android")>=0);var Hc,MD=globalThis.vscode;if(typeof MD<"u"&&typeof MD.process<"u"){let o=MD.process;Hc={get platform(){return o.platform},get arch(){return o.arch},get env(){return o.env},cwd(){return o.cwd()}}}else typeof process<"u"&&typeof process?.versions?.node=="string"?Hc={get platform(){return process.platform},get arch(){return process.arch},get env(){return process.env},cwd(){return process.env.VSCODE_CWD||process.cwd()}}:Hc={get platform(){return pt?"win32":Ve?"darwin":"linux"},get arch(){},get env(){return{}},cwd(){return"/"}};var Jg=Hc.cwd,$r=Hc.env,PD=Hc.platform,sz=Hc.arch;var lz=65,dz=97,cz=90,uz=122,sd=46,Hi=47,Xo=92,od=58,pz=63,Ay=class extends Error{code;constructor(e,t,n){let i;typeof t=="string"&&t.indexOf("not ")===0?(i="must not be",t=t.replace(/^not /,"")):i="must be";let r=e.indexOf(".")!==-1?"property":"argument",s=`The "${e}" ${r} ${i} of type ${t}`;s+=`. Received type ${typeof n}`,super(s),this.code="ERR_INVALID_ARG_TYPE"}};function hz(o,e){if(o===null||typeof o!="object")throw new Ay(e,"Object",o)}function Un(o,e){if(typeof o!="string")throw new Ay(e,"string",o)}var Qo=PD==="win32";function ft(o){return o===Hi||o===Xo}function OD(o){return o===Hi}function rd(o){return o>=lz&&o<=cz||o>=dz&&o<=uz}function Fy(o,e,t,n){let i="",r=0,s=-1,a=0,l=0;for(let d=0;d<=o.length;++d){if(d<o.length)l=o.charCodeAt(d);else{if(n(l))break;l=Hi}if(n(l)){if(!(s===d-1||a===1))if(a===2){if(i.length<2||r!==2||i.charCodeAt(i.length-1)!==sd||i.charCodeAt(i.length-2)!==sd){if(i.length>2){let c=i.lastIndexOf(t);c===-1?(i="",r=0):(i=i.slice(0,c),r=i.length-1-i.lastIndexOf(t)),s=d,a=0;continue}else if(i.length!==0){i="",r=0,s=d,a=0;continue}}e&&(i+=i.length>0?`${t}..`:"..",r=2)}else i.length>0?i+=`${t}${o.slice(s+1,d)}`:i=o.slice(s+1,d),r=d-s-1;s=d,a=0}else l===sd&&a!==-1?++a:a=-1}return i}function mz(o){return o?`${o[0]==="."?"":"."}${o}`:""}function oA(o,e){hz(e,"pathObject");let t=e.dir||e.root,n=e.base||`${e.name||""}${mz(e.ext)}`;return t?t===e.root?`${t}${n}`:`${t}${o}${n}`:n}var wn={resolve(...o){let e="",t="",n=!1;for(let i=o.length-1;i>=-1;i--){let r;if(i>=0){if(r=o[i],Un(r,`paths[${i}]`),r.length===0)continue}else e.length===0?r=Jg():(r=$r[`=${e}`]||Jg(),(r===void 0||r.slice(0,2).toLowerCase()!==e.toLowerCase()&&r.charCodeAt(2)===Xo)&&(r=`${e}\\`));let s=r.length,a=0,l="",d=!1,c=r.charCodeAt(0);if(s===1)ft(c)&&(a=1,d=!0);else if(ft(c))if(d=!0,ft(r.charCodeAt(1))){let u=2,p=u;for(;u<s&&!ft(r.charCodeAt(u));)u++;if(u<s&&u!==p){let h=r.slice(p,u);for(p=u;u<s&&ft(r.charCodeAt(u));)u++;if(u<s&&u!==p){for(p=u;u<s&&!ft(r.charCodeAt(u));)u++;(u===s||u!==p)&&(l=`\\\\${h}\\${r.slice(p,u)}`,a=u)}}}else a=1;else rd(c)&&r.charCodeAt(1)===od&&(l=r.slice(0,2),a=2,s>2&&ft(r.charCodeAt(2))&&(d=!0,a=3));if(l.length>0)if(e.length>0){if(l.toLowerCase()!==e.toLowerCase())continue}else e=l;if(n){if(e.length>0)break}else if(t=`${r.slice(a)}\\${t}`,n=d,d&&e.length>0)break}return t=Fy(t,!n,"\\",ft),n?`${e}\\${t}`:`${e}${t}`||"."},normalize(o){Un(o,"path");let e=o.length;if(e===0)return".";let t=0,n,i=!1,r=o.charCodeAt(0);if(e===1)return OD(r)?"\\":o;if(ft(r))if(i=!0,ft(o.charCodeAt(1))){let a=2,l=a;for(;a<e&&!ft(o.charCodeAt(a));)a++;if(a<e&&a!==l){let d=o.slice(l,a);for(l=a;a<e&&ft(o.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&!ft(o.charCodeAt(a));)a++;if(a===e)return`\\\\${d}\\${o.slice(l)}\\`;a!==l&&(n=`\\\\${d}\\${o.slice(l,a)}`,t=a)}}}else t=1;else rd(r)&&o.charCodeAt(1)===od&&(n=o.slice(0,2),t=2,e>2&&ft(o.charCodeAt(2))&&(i=!0,t=3));let s=t<e?Fy(o.slice(t),!i,"\\",ft):"";return s.length===0&&!i&&(s="."),s.length>0&&ft(o.charCodeAt(e-1))&&(s+="\\"),n===void 0?i?`\\${s}`:s:i?`${n}\\${s}`:`${n}${s}`},isAbsolute(o){Un(o,"path");let e=o.length;if(e===0)return!1;let t=o.charCodeAt(0);return ft(t)||e>2&&rd(t)&&o.charCodeAt(1)===od&&ft(o.charCodeAt(2))},join(...o){if(o.length===0)return".";let e,t;for(let r=0;r<o.length;++r){let s=o[r];Un(s,"path"),s.length>0&&(e===void 0?e=t=s:e+=`\\${s}`)}if(e===void 0)return".";let n=!0,i=0;if(typeof t=="string"&&ft(t.charCodeAt(0))){++i;let r=t.length;r>1&&ft(t.charCodeAt(1))&&(++i,r>2&&(ft(t.charCodeAt(2))?++i:n=!1))}if(n){for(;i<e.length&&ft(e.charCodeAt(i));)i++;i>=2&&(e=`\\${e.slice(i)}`)}return wn.normalize(e)},relative(o,e){if(Un(o,"from"),Un(e,"to"),o===e)return"";let t=wn.resolve(o),n=wn.resolve(e);if(t===n||(o=t.toLowerCase(),e=n.toLowerCase(),o===e))return"";let i=0;for(;i<o.length&&o.charCodeAt(i)===Xo;)i++;let r=o.length;for(;r-1>i&&o.charCodeAt(r-1)===Xo;)r--;let s=r-i,a=0;for(;a<e.length&&e.charCodeAt(a)===Xo;)a++;let l=e.length;for(;l-1>a&&e.charCodeAt(l-1)===Xo;)l--;let d=l-a,c=s<d?s:d,u=-1,p=0;for(;p<c;p++){let f=o.charCodeAt(i+p);if(f!==e.charCodeAt(a+p))break;f===Xo&&(u=p)}if(p!==c){if(u===-1)return n}else{if(d>c){if(e.charCodeAt(a+p)===Xo)return n.slice(a+p+1);if(p===2)return n.slice(a+p)}s>c&&(o.charCodeAt(i+p)===Xo?u=p:p===2&&(u=3)),u===-1&&(u=0)}let h="";for(p=i+u+1;p<=r;++p)(p===r||o.charCodeAt(p)===Xo)&&(h+=h.length===0?"..":"\\..");return a+=u,h.length>0?`${h}${n.slice(a,l)}`:(n.charCodeAt(a)===Xo&&++a,n.slice(a,l))},toNamespacedPath(o){if(typeof o!="string"||o.length===0)return o;let e=wn.resolve(o);if(e.length<=2)return o;if(e.charCodeAt(0)===Xo){if(e.charCodeAt(1)===Xo){let t=e.charCodeAt(2);if(t!==pz&&t!==sd)return`\\\\?\\UNC\\${e.slice(2)}`}}else if(rd(e.charCodeAt(0))&&e.charCodeAt(1)===od&&e.charCodeAt(2)===Xo)return`\\\\?\\${e}`;return o},dirname(o){Un(o,"path");let e=o.length;if(e===0)return".";let t=-1,n=0,i=o.charCodeAt(0);if(e===1)return ft(i)?o:".";if(ft(i)){if(t=n=1,ft(o.charCodeAt(1))){let a=2,l=a;for(;a<e&&!ft(o.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&ft(o.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&!ft(o.charCodeAt(a));)a++;if(a===e)return o;a!==l&&(t=n=a+1)}}}}else rd(i)&&o.charCodeAt(1)===od&&(t=e>2&&ft(o.charCodeAt(2))?3:2,n=t);let r=-1,s=!0;for(let a=e-1;a>=n;--a)if(ft(o.charCodeAt(a))){if(!s){r=a;break}}else s=!1;if(r===-1){if(t===-1)return".";r=t}return o.slice(0,r)},basename(o,e){e!==void 0&&Un(e,"suffix"),Un(o,"path");let t=0,n=-1,i=!0,r;if(o.length>=2&&rd(o.charCodeAt(0))&&o.charCodeAt(1)===od&&(t=2),e!==void 0&&e.length>0&&e.length<=o.length){if(e===o)return"";let s=e.length-1,a=-1;for(r=o.length-1;r>=t;--r){let l=o.charCodeAt(r);if(ft(l)){if(!i){t=r+1;break}}else a===-1&&(i=!1,a=r+1),s>=0&&(l===e.charCodeAt(s)?--s===-1&&(n=r):(s=-1,n=a))}return t===n?n=a:n===-1&&(n=o.length),o.slice(t,n)}for(r=o.length-1;r>=t;--r)if(ft(o.charCodeAt(r))){if(!i){t=r+1;break}}else n===-1&&(i=!1,n=r+1);return n===-1?"":o.slice(t,n)},extname(o){Un(o,"path");let e=0,t=-1,n=0,i=-1,r=!0,s=0;o.length>=2&&o.charCodeAt(1)===od&&rd(o.charCodeAt(0))&&(e=n=2);for(let a=o.length-1;a>=e;--a){let l=o.charCodeAt(a);if(ft(l)){if(!r){n=a+1;break}continue}i===-1&&(r=!1,i=a+1),l===sd?t===-1?t=a:s!==1&&(s=1):t!==-1&&(s=-1)}return t===-1||i===-1||s===0||s===1&&t===i-1&&t===n+1?"":o.slice(t,i)},format:oA.bind(null,"\\"),parse(o){Un(o,"path");let e={root:"",dir:"",base:"",ext:"",name:""};if(o.length===0)return e;let t=o.length,n=0,i=o.charCodeAt(0);if(t===1)return ft(i)?(e.root=e.dir=o,e):(e.base=e.name=o,e);if(ft(i)){if(n=1,ft(o.charCodeAt(1))){let u=2,p=u;for(;u<t&&!ft(o.charCodeAt(u));)u++;if(u<t&&u!==p){for(p=u;u<t&&ft(o.charCodeAt(u));)u++;if(u<t&&u!==p){for(p=u;u<t&&!ft(o.charCodeAt(u));)u++;u===t?n=u:u!==p&&(n=u+1)}}}}else if(rd(i)&&o.charCodeAt(1)===od){if(t<=2)return e.root=e.dir=o,e;if(n=2,ft(o.charCodeAt(2))){if(t===3)return e.root=e.dir=o,e;n=3}}n>0&&(e.root=o.slice(0,n));let r=-1,s=n,a=-1,l=!0,d=o.length-1,c=0;for(;d>=n;--d){if(i=o.charCodeAt(d),ft(i)){if(!l){s=d+1;break}continue}a===-1&&(l=!1,a=d+1),i===sd?r===-1?r=d:c!==1&&(c=1):r!==-1&&(c=-1)}return a!==-1&&(r===-1||c===0||c===1&&r===a-1&&r===s+1?e.base=e.name=o.slice(s,a):(e.name=o.slice(s,r),e.base=o.slice(s,a),e.ext=o.slice(r,a))),s>0&&s!==n?e.dir=o.slice(0,s-1):e.dir=e.root,e},sep:"\\",delimiter:";",win32:null,posix:null},gz=(()=>{if(Qo){let o=/\\/g;return()=>{let e=Jg().replace(o,"/");return e.slice(e.indexOf("/"))}}return()=>Jg()})(),bt={resolve(...o){let e="",t=!1;for(let n=o.length-1;n>=-1&&!t;n--){let i=n>=0?o[n]:gz();Un(i,`paths[${n}]`),i.length!==0&&(e=`${i}/${e}`,t=i.charCodeAt(0)===Hi)}return e=Fy(e,!t,"/",OD),t?`/${e}`:e.length>0?e:"."},normalize(o){if(Un(o,"path"),o.length===0)return".";let e=o.charCodeAt(0)===Hi,t=o.charCodeAt(o.length-1)===Hi;return o=Fy(o,!e,"/",OD),o.length===0?e?"/":t?"./":".":(t&&(o+="/"),e?`/${o}`:o)},isAbsolute(o){return Un(o,"path"),o.length>0&&o.charCodeAt(0)===Hi},join(...o){if(o.length===0)return".";let e;for(let t=0;t<o.length;++t){let n=o[t];Un(n,"path"),n.length>0&&(e===void 0?e=n:e+=`/${n}`)}return e===void 0?".":bt.normalize(e)},relative(o,e){if(Un(o,"from"),Un(e,"to"),o===e||(o=bt.resolve(o),e=bt.resolve(e),o===e))return"";let t=1,n=o.length,i=n-t,r=1,s=e.length-r,a=i<s?i:s,l=-1,d=0;for(;d<a;d++){let u=o.charCodeAt(t+d);if(u!==e.charCodeAt(r+d))break;u===Hi&&(l=d)}if(d===a)if(s>a){if(e.charCodeAt(r+d)===Hi)return e.slice(r+d+1);if(d===0)return e.slice(r+d)}else i>a&&(o.charCodeAt(t+d)===Hi?l=d:d===0&&(l=0));let c="";for(d=t+l+1;d<=n;++d)(d===n||o.charCodeAt(d)===Hi)&&(c+=c.length===0?"..":"/..");return`${c}${e.slice(r+l)}`},toNamespacedPath(o){return o},dirname(o){if(Un(o,"path"),o.length===0)return".";let e=o.charCodeAt(0)===Hi,t=-1,n=!0;for(let i=o.length-1;i>=1;--i)if(o.charCodeAt(i)===Hi){if(!n){t=i;break}}else n=!1;return t===-1?e?"/":".":e&&t===1?"//":o.slice(0,t)},basename(o,e){e!==void 0&&Un(e,"ext"),Un(o,"path");let t=0,n=-1,i=!0,r;if(e!==void 0&&e.length>0&&e.length<=o.length){if(e===o)return"";let s=e.length-1,a=-1;for(r=o.length-1;r>=0;--r){let l=o.charCodeAt(r);if(l===Hi){if(!i){t=r+1;break}}else a===-1&&(i=!1,a=r+1),s>=0&&(l===e.charCodeAt(s)?--s===-1&&(n=r):(s=-1,n=a))}return t===n?n=a:n===-1&&(n=o.length),o.slice(t,n)}for(r=o.length-1;r>=0;--r)if(o.charCodeAt(r)===Hi){if(!i){t=r+1;break}}else n===-1&&(i=!1,n=r+1);return n===-1?"":o.slice(t,n)},extname(o){Un(o,"path");let e=-1,t=0,n=-1,i=!0,r=0;for(let s=o.length-1;s>=0;--s){let a=o.charCodeAt(s);if(a===Hi){if(!i){t=s+1;break}continue}n===-1&&(i=!1,n=s+1),a===sd?e===-1?e=s:r!==1&&(r=1):e!==-1&&(r=-1)}return e===-1||n===-1||r===0||r===1&&e===n-1&&e===t+1?"":o.slice(e,n)},format:oA.bind(null,"/"),parse(o){Un(o,"path");let e={root:"",dir:"",base:"",ext:"",name:""};if(o.length===0)return e;let t=o.charCodeAt(0)===Hi,n;t?(e.root="/",n=1):n=0;let i=-1,r=0,s=-1,a=!0,l=o.length-1,d=0;for(;l>=n;--l){let c=o.charCodeAt(l);if(c===Hi){if(!a){r=l+1;break}continue}s===-1&&(a=!1,s=l+1),c===sd?i===-1?i=l:d!==1&&(d=1):i!==-1&&(d=-1)}if(s!==-1){let c=r===0&&t?1:r;i===-1||d===0||d===1&&i===s-1&&i===r+1?e.base=e.name=o.slice(c,s):(e.name=o.slice(c,i),e.base=o.slice(c,s),e.ext=o.slice(i,s))}return r>0?e.dir=o.slice(0,r-1):t&&(e.dir="/"),e},sep:"/",delimiter:":",win32:null,posix:null};bt.win32=wn.win32=wn;bt.posix=wn.posix=bt;var ad=Qo?wn.normalize:bt.normalize,ND=Qo?wn.isAbsolute:bt.isAbsolute,_r=Qo?wn.join:bt.join,Np=Qo?wn.resolve:bt.resolve,rA=Qo?wn.relative:bt.relative,By=Qo?wn.dirname:bt.dirname,AD=Qo?wn.basename:bt.basename,Vy=Qo?wn.extname:bt.extname,E$=Qo?wn.format:bt.format,T$=Qo?wn.parse:bt.parse,x$=Qo?wn.toNamespacedPath:bt.toNamespacedPath,ui=Qo?wn.sep:bt.sep,w$=Qo?wn.delimiter:bt.delimiter;var bz=/^\w[\w\d+.-]*$/,vz=/^\//,yz=/^\/\//;function Iz(o,e){if(!o.scheme&&e)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${o.authority}", path: "${o.path}", query: "${o.query}", fragment: "${o.fragment}"}`);if(o.scheme&&!bz.test(o.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(o.path){if(o.authority){if(!vz.test(o.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(yz.test(o.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}function Cz(o,e){return!o&&!e?"file":o}function Sz(o,e){switch(o){case"https":case"http":case"file":e?e[0]!==fs&&(e=fs+e):e=fs;break}return e}var mn="",fs="/",Ez=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/,J=class o{static isUri(e){return e instanceof o?!0:e?typeof e.authority=="string"&&typeof e.fragment=="string"&&typeof e.path=="string"&&typeof e.query=="string"&&typeof e.scheme=="string"&&typeof e.fsPath=="string"&&typeof e.with=="function"&&typeof e.toString=="function":!1}scheme;authority;path;query;fragment;constructor(e,t,n,i,r,s=!1){typeof e=="object"?(this.scheme=e.scheme||mn,this.authority=e.authority||mn,this.path=e.path||mn,this.query=e.query||mn,this.fragment=e.fragment||mn):(this.scheme=Cz(e,s),this.authority=t||mn,this.path=Sz(this.scheme,n||mn),this.query=i||mn,this.fragment=r||mn,Iz(this,s))}get fsPath(){return ef(this,!1)}with(e){if(!e)return this;let{scheme:t,authority:n,path:i,query:r,fragment:s}=e;return t===void 0?t=this.scheme:t===null&&(t=mn),n===void 0?n=this.authority:n===null&&(n=mn),i===void 0?i=this.path:i===null&&(i=mn),r===void 0?r=this.query:r===null&&(r=mn),s===void 0?s=this.fragment:s===null&&(s=mn),t===this.scheme&&n===this.authority&&i===this.path&&r===this.query&&s===this.fragment?this:new ld(t,n,i,r,s)}static parse(e,t=!1){let n=Ez.exec(e);return n?new ld(n[2]||mn,Wy(n[4]||mn),Wy(n[5]||mn),Wy(n[7]||mn),Wy(n[9]||mn),t):new ld(mn,mn,mn,mn,mn)}static file(e){let t=mn;if(pt&&(e=e.replace(/\\/g,fs)),e[0]===fs&&e[1]===fs){let n=e.indexOf(fs,2);n===-1?(t=e.substring(2),e=fs):(t=e.substring(2,n),e=e.substring(n)||fs)}return new ld("file",t,e,mn,mn)}static from(e,t){return new ld(e.scheme,e.authority,e.path,e.query,e.fragment,t)}static joinPath(e,...t){if(!e.path)throw new Error("[UriError]: cannot call joinPath on URI without path");let n;return pt&&e.scheme==="file"?n=o.file(wn.join(ef(e,!0),...t)).path:n=bt.join(e.path,...t),e.with({path:n})}toString(e=!1){return BD(this,e)}toJSON(){return this}static revive(e){if(e){if(e instanceof o)return e;{let t=new ld(e);return t._formatted=e.external??null,t._fsPath=e._sep===lA?e.fsPath??null:null,t}}else return e}[Symbol.for("debug.description")](){return`URI(${this.toString()})`}};var lA=pt?1:void 0,ld=class extends J{_formatted=null;_fsPath=null;get fsPath(){return this._fsPath||(this._fsPath=ef(this,!1)),this._fsPath}toString(e=!1){return e?BD(this,!0):(this._formatted||(this._formatted=BD(this,!1)),this._formatted)}toJSON(){let e={$mid:1};return this._fsPath&&(e.fsPath=this._fsPath,e._sep=lA),this._formatted&&(e.external=this._formatted),this.path&&(e.path=this.path),this.scheme&&(e.scheme=this.scheme),this.authority&&(e.authority=this.authority),this.query&&(e.query=this.query),this.fragment&&(e.fragment=this.fragment),e}},dA={58:"%3A",47:"%2F",63:"%3F",35:"%23",91:"%5B",93:"%5D",64:"%40",33:"%21",36:"%24",38:"%26",39:"%27",40:"%28",41:"%29",42:"%2A",43:"%2B",44:"%2C",59:"%3B",61:"%3D",32:"%20"};function sA(o,e,t){let n,i=-1;for(let r=0;r<o.length;r++){let s=o.charCodeAt(r);if(s>=97&&s<=122||s>=65&&s<=90||s>=48&&s<=57||s===45||s===46||s===95||s===126||e&&s===47||t&&s===91||t&&s===93||t&&s===58)i!==-1&&(n+=encodeURIComponent(o.substring(i,r)),i=-1),n!==void 0&&(n+=o.charAt(r));else{n===void 0&&(n=o.substr(0,r));let a=dA[s];a!==void 0?(i!==-1&&(n+=encodeURIComponent(o.substring(i,r)),i=-1),n+=a):i===-1&&(i=r)}}return i!==-1&&(n+=encodeURIComponent(o.substring(i))),n!==void 0?n:o}function Tz(o){let e;for(let t=0;t<o.length;t++){let n=o.charCodeAt(t);n===35||n===63?(e===void 0&&(e=o.substr(0,t)),e+=dA[n]):e!==void 0&&(e+=o[t])}return e!==void 0?e:o}function ef(o,e){let t;return o.authority&&o.path.length>1&&o.scheme==="file"?t=`//${o.authority}${o.path}`:o.path.charCodeAt(0)===47&&(o.path.charCodeAt(1)>=65&&o.path.charCodeAt(1)<=90||o.path.charCodeAt(1)>=97&&o.path.charCodeAt(1)<=122)&&o.path.charCodeAt(2)===58?e?t=o.path.substr(1):t=o.path[1].toLowerCase()+o.path.substr(2):t=o.path,pt&&(t=t.replace(/\//g,"\\")),t}function BD(o,e){let t=e?Tz:sA,n="",{scheme:i,authority:r,path:s,query:a,fragment:l}=o;if(i&&(n+=i,n+=":"),(r||i==="file")&&(n+=fs,n+=fs),r){let d=r.indexOf("@");if(d!==-1){let c=r.substr(0,d);r=r.substr(d+1),d=c.lastIndexOf(":"),d===-1?n+=t(c,!1,!1):(n+=t(c.substr(0,d),!1,!1),n+=":",n+=t(c.substr(d+1),!1,!0)),n+="@"}r=r.toLowerCase(),d=r.lastIndexOf(":"),d===-1?n+=t(r,!1,!0):(n+=t(r.substr(0,d),!1,!0),n+=r.substr(d))}if(s){if(s.length>=3&&s.charCodeAt(0)===47&&s.charCodeAt(2)===58){let d=s.charCodeAt(1);d>=65&&d<=90&&(s=`/${String.fromCharCode(d+32)}:${s.substr(3)}`)}else if(s.length>=2&&s.charCodeAt(1)===58){let d=s.charCodeAt(0);d>=65&&d<=90&&(s=`${String.fromCharCode(d+32)}:${s.substr(2)}`)}n+=t(s,!0,!1)}return a&&(n+="?",n+=t(a,!1,!1)),l&&(n+="#",n+=e?l:sA(l,!1,!1)),n}function cA(o){try{return decodeURIComponent(o)}catch{return o.length>3?o.substr(0,3)+cA(o.substr(3)):o}}var aA=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function Wy(o){return o.match(aA)?o.replace(aA,e=>cA(e)):o}function tf(o,e,t){let n=o.get(e);return n===void 0&&(n=t,o.set(e,n)),n}var VD=class{constructor(e,t){this.uri=e;this.value=t}};function xz(o){return Array.isArray(o)}var Ui=class o{static defaultToKey=e=>e.toString();[Symbol.toStringTag]="ResourceMap";map;toKey;constructor(e,t){if(e instanceof o)this.map=new Map(e.map),this.toKey=t??o.defaultToKey;else if(xz(e)){this.map=new Map,this.toKey=t??o.defaultToKey;for(let[n,i]of e)this.set(n,i)}else this.map=new Map,this.toKey=e??o.defaultToKey}set(e,t){return this.map.set(this.toKey(e),new VD(e,t)),this}get(e){return this.map.get(this.toKey(e))?.value}has(e){return this.map.has(this.toKey(e))}get size(){return this.map.size}clear(){this.map.clear()}delete(e){return this.map.delete(this.toKey(e))}forEach(e,t){typeof t<"u"&&(e=e.bind(t));for(let[n,i]of this.map)e(i.value,i.uri,this)}*values(){for(let e of this.map.values())yield e.value}*keys(){for(let e of this.map.values())yield e.uri}*entries(){for(let e of this.map.values())yield[e.uri,e.value]}*[Symbol.iterator](){for(let[,e]of this.map)yield[e.uri,e.value]}},Ap=class{[Symbol.toStringTag]="ResourceSet";_map;constructor(e,t){!e||typeof e=="function"?this._map=new Ui(e):(this._map=new Ui(t),e.forEach(this.add,this))}get size(){return this._map.size}add(e){return this._map.set(e,e),this}clear(){this._map.clear()}delete(e){return this._map.delete(e)}forEach(e,t){this._map.forEach((n,i)=>e.call(t,i,i,this))}has(e){return this._map.has(e)}entries(){return this._map.entries()}keys(){return this._map.keys()}values(){return this._map.keys()}[Symbol.iterator](){return this.keys()}};var WD=class{[Symbol.toStringTag]="LinkedMap";_map;_head;_tail;_size;_state;constructor(){this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(e){return this._map.has(e)}get(e,t=0){let n=this._map.get(e);if(n)return t!==0&&this.touch(n,t),n.value}set(e,t,n=0){let i=this._map.get(e);if(i)i.value=t,n!==0&&this.touch(i,n);else{switch(i={key:e,value:t,next:void 0,previous:void 0},n){case 0:this.addItemLast(i);break;case 1:this.addItemFirst(i);break;case 2:this.addItemLast(i);break;default:this.addItemLast(i);break}this._map.set(e,i),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){let t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");let e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){let n=this._state,i=this._head;for(;i;){if(t?e.bind(t)(i.value,i.key,this):e(i.value,i.key,this),this._state!==n)throw new Error("LinkedMap got modified during iteration.");i=i.next}}keys(){let e=this,t=this._state,n=this._head,i={[Symbol.iterator](){return i},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){let r={value:n.key,done:!1};return n=n.next,r}else return{value:void 0,done:!0}}};return i}values(){let e=this,t=this._state,n=this._head,i={[Symbol.iterator](){return i},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){let r={value:n.value,done:!1};return n=n.next,r}else return{value:void 0,done:!0}}};return i}entries(){let e=this,t=this._state,n=this._head,i={[Symbol.iterator](){return i},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){let r={value:[n.key,n.value],done:!1};return n=n.next,r}else return{value:void 0,done:!0}}};return i}[Symbol.iterator](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._head,n=this.size;for(;t&&n>e;)this._map.delete(t.key),t=t.next,n--;this._head=t,this._size=n,t&&(t.previous=void 0),this._state++}trimNew(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._tail,n=this.size;for(;t&&n>e;)this._map.delete(t.key),t=t.previous,n--;this._tail=t,this._size=n,t&&(t.next=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{let t=e.next,n=e.previous;if(!t||!n)throw new Error("Invalid list");t.previous=n,n.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(t!==1&&t!==2)){if(t===1){if(e===this._head)return;let n=e.next,i=e.previous;e===this._tail?(i.next=void 0,this._tail=i):(n.previous=i,i.next=n),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===2){if(e===this._tail)return;let n=e.next,i=e.previous;e===this._head?(n.previous=void 0,this._head=n):(n.previous=i,i.next=n),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){let e=[];return this.forEach((t,n)=>{e.push([n,t])}),e}fromJSON(e){this.clear();for(let[t,n]of e)this.set(t,n)}},HD=class extends WD{_limit;_ratio;constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,t=2){return super.get(e,t)}peek(e){return super.get(e,0)}set(e,t){return super.set(e,t,2),this}checkTrim(){this.size>this._limit&&this.trim(Math.round(this._limit*this._ratio))}},Jo=class extends HD{constructor(e,t=1){super(e,t)}trim(e){this.trimOld(e)}set(e,t){return super.set(e,t),this.checkTrim(),this}};var pl=class{map=new Map;add(e,t){let n=this.map.get(e);n||(n=new Set,this.map.set(e,n)),n.add(t)}delete(e,t){let n=this.map.get(e);n&&(n.delete(t),n.size===0&&this.map.delete(e))}forEach(e,t){let n=this.map.get(e);n&&n.forEach(t)}get(e){let t=this.map.get(e);return t||new Set}};function bs(o,e){let t=this,n=!1,i;return function(){if(n)return i;if(n=!0,e)try{i=o.apply(t,arguments)}finally{e()}else i=o.apply(t,arguments);return i}}var Je;(S=>{function o(E){return E&&typeof E=="object"&&typeof E[Symbol.iterator]=="function"}S.is=o;let e=Object.freeze([]);function t(){return e}S.empty=t;function*n(E){yield E}S.single=n;function i(E){return o(E)?E:n(E)}S.wrap=i;function r(E){return E||e}S.from=r;function*s(E){for(let C=E.length-1;C>=0;C--)yield E[C]}S.reverse=s;function a(E){return!E||E[Symbol.iterator]().next().done===!0}S.isEmpty=a;function l(E){return E[Symbol.iterator]().next().value}S.first=l;function d(E,C){let w=0;for(let _ of E)if(C(_,w++))return!0;return!1}S.some=d;function c(E,C){for(let w of E)if(C(w))return w}S.find=c;function*u(E,C){for(let w of E)C(w)&&(yield w)}S.filter=u;function*p(E,C){let w=0;for(let _ of E)yield C(_,w++)}S.map=p;function*h(E,C){let w=0;for(let _ of E)yield*C(_,w++)}S.flatMap=h;function*f(...E){for(let C of E)yield*C}S.concat=f;function g(E,C,w){let _=w;for(let L of E)_=C(_,L);return _}S.reduce=g;function*b(E,C,w=E.length){for(C<0&&(C+=E.length),w<0?w+=E.length:w>E.length&&(w=E.length);C<w;C++)yield E[C]}S.slice=b;function v(E,C=Number.POSITIVE_INFINITY){let w=[];if(C===0)return[w,E];let _=E[Symbol.iterator]();for(let L=0;L<C;L++){let k=_.next();if(k.done)return[w,S.empty()];w.push(k.value)}return[w,{[Symbol.iterator](){return _}}]}S.consume=v;async function y(E){let C=[];for await(let w of E)C.push(w);return Promise.resolve(C)}S.asyncToArray=y})(Je||={});var wz=!1,Uc=null;function _z(o){Uc=o}if(wz){let o="__is_disposable_tracked__";_z(new class{trackDisposable(e){let t=new Error("Potentially leaked disposable").stack;setTimeout(()=>{e[o]||console.log(t)},3e3)}setParent(e,t){if(e&&e!==F.None)try{e[o]=!0}catch{}}markAsDisposed(e){if(e&&e!==F.None)try{e[o]=!0}catch{}}markAsSingleton(e){}})}function zc(o){return Uc?.trackDisposable(o),o}function Kc(o){Uc?.markAsDisposed(o)}function nf(o,e){Uc?.setParent(o,e)}function Dz(o,e){if(Uc)for(let t of o)Uc.setParent(t,e)}function dd(o){return Uc?.markAsSingleton(o),o}function Hy(o){return typeof o=="object"&&o!==null&&typeof o.dispose=="function"&&o.dispose.length===0}function wt(o){if(Je.is(o)){let e=[];for(let t of o)if(t)try{t.dispose()}catch(n){e.push(n)}if(e.length===1)throw e[0];if(e.length>1)throw new AggregateError(e,"Encountered errors while disposing of store");return Array.isArray(o)?[]:o}else if(o)return o.dispose(),o}function Ro(...o){let e=le(()=>wt(o));return Dz(o,e),e}function le(o){let e=zc({dispose:bs(()=>{Kc(e),o()})});return e}var ee=class o{static DISABLE_DISPOSED_WARNING=!1;_toDispose=new Set;_isDisposed=!1;constructor(){zc(this)}dispose(){this._isDisposed||(Kc(this),this._isDisposed=!0,this.clear())}get isDisposed(){return this._isDisposed}clear(){if(this._toDispose.size!==0)try{wt(this._toDispose)}finally{this._toDispose.clear()}}add(e){if(!e)return e;if(e===this)throw new Error("Cannot register a disposable on itself!");return nf(e,this),this._isDisposed?o.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this._toDispose.add(e),e}delete(e){if(e){if(e===this)throw new Error("Cannot dispose a disposable on itself!");this._toDispose.delete(e),e.dispose()}}deleteAndLeak(e){e&&this._toDispose.has(e)&&(this._toDispose.delete(e),nf(e,null))}},F=class{static None=Object.freeze({dispose(){}});_store=new ee;constructor(){zc(this),nf(this._store,this)}dispose(){Kc(this),this._store.dispose()}_register(e){if(e===this)throw new Error("Cannot register a disposable on itself!");return this._store.add(e)}},un=class{_value;_isDisposed=!1;constructor(){zc(this)}get value(){return this._isDisposed?void 0:this._value}set value(e){this._isDisposed||e===this._value||(this._value?.dispose(),e&&nf(e,this),this._value=e)}clear(){this.value=void 0}dispose(){this._isDisposed=!0,Kc(this),this._value?.dispose(),this._value=void 0}clearAndLeak(){let e=this._value;return this._value=void 0,e&&nf(e,null),e}};var Lo=class{_store=new Map;_isDisposed=!1;constructor(){zc(this)}dispose(){Kc(this),this._isDisposed=!0,this.clearAndDisposeAll()}clearAndDisposeAll(){if(this._store.size)try{wt(this._store.values())}finally{this._store.clear()}}has(e){return this._store.has(e)}get size(){return this._store.size}get(e){return this._store.get(e)}set(e,t,n=!1){this._isDisposed&&console.warn(new Error("Trying to add a disposable to a DisposableMap that has already been disposed of. The added object will be leaked!").stack),n||this._store.get(e)?.dispose(),this._store.set(e,t)}deleteAndDispose(e){this._store.get(e)?.dispose(),this._store.delete(e)}deleteAndLeak(e){let t=this._store.get(e);return this._store.delete(e),t}keys(){return this._store.keys()}values(){return this._store.values()}[Symbol.iterator](){return this._store[Symbol.iterator]()}};var uA=Object.freeze(function(o,e){let t=setTimeout(o.bind(e),0);return{dispose(){clearTimeout(t)}}}),sn;(n=>{function o(i){return i===n.None||i===n.Cancelled||i instanceof Fp?!0:!i||typeof i!="object"?!1:typeof i.isCancellationRequested=="boolean"&&typeof i.onCancellationRequested=="function"}n.isCancellationToken=o,n.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:q.None}),n.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:uA})})(sn||={});var Fp=class{_isCancelled=!1;_emitter=null;cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?uA:(this._emitter||(this._emitter=new D),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=null)}},zn=class{_token=void 0;_parentListener=void 0;constructor(e){this._parentListener=e&&e.onCancellationRequested(this.cancel,this)}get token(){return this._token||(this._token=new Fp),this._token}cancel(){this._token?this._token instanceof Fp&&this._token.cancel():this._token=sn.Cancelled}dispose(e=!1){e&&this.cancel(),this._parentListener?.dispose(),this._token?this._token instanceof Fp&&this._token.dispose():this._token=sn.None}};var _n=class o{static Undefined=new o(void 0);element;next;prev;constructor(e){this.element=e,this.next=o.Undefined,this.prev=o.Undefined}},zi=class{_first=_n.Undefined;_last=_n.Undefined;_size=0;get size(){return this._size}isEmpty(){return this._first===_n.Undefined}clear(){let e=this._first;for(;e!==_n.Undefined;){let t=e.next;e.prev=_n.Undefined,e.next=_n.Undefined,e=t}this._first=_n.Undefined,this._last=_n.Undefined,this._size=0}unshift(e){return this._insert(e,!1)}push(e){return this._insert(e,!0)}_insert(e,t){let n=new _n(e);if(this._first===_n.Undefined)this._first=n,this._last=n;else if(t){let r=this._last;this._last=n,n.prev=r,r.next=n}else{let r=this._first;this._first=n,n.next=r,r.prev=n}this._size+=1;let i=!1;return()=>{i||(i=!0,this._remove(n))}}shift(){if(this._first!==_n.Undefined){let e=this._first.element;return this._remove(this._first),e}}pop(){if(this._last!==_n.Undefined){let e=this._last.element;return this._remove(this._last),e}}_remove(e){if(e.prev!==_n.Undefined&&e.next!==_n.Undefined){let t=e.prev;t.next=e.next,e.next.prev=t}else e.prev===_n.Undefined&&e.next===_n.Undefined?(this._first=_n.Undefined,this._last=_n.Undefined):e.next===_n.Undefined?(this._last=this._last.prev,this._last.next=_n.Undefined):e.prev===_n.Undefined&&(this._first=this._first.next,this._first.prev=_n.Undefined);this._size-=1}*[Symbol.iterator](){let e=this._first;for(;e!==_n.Undefined;)yield e.element,e=e.next}};var Ki=(o,e)=>o===e;function zD(o=Ki){return(e,t)=>zt(e,t,o)}function Uy(o,e,t){if(t!==void 0){let n=o;return n==null||e===void 0||e===null?e===n:t(n,e)}else{let n=o;return(i,r)=>i==null||r===void 0||r===null?r===i:n(i,r)}}function hA(o){return JSON.stringify(UD(o))}var Lz=0,pA=new WeakMap;function UD(o){if(Array.isArray(o))return o.map(UD);if(o&&typeof o=="object")if(Object.getPrototypeOf(o)===Object.prototype){let e=o,t=Object.create(null);for(let n of Object.keys(e).sort())t[n]=UD(e[n]);return t}else{let e=pA.get(o);return e===void 0&&(e=Lz++,pA.set(o,e)),e+"----2b76a038c20c4bcc"}return o}var yn=class{constructor(e,t,n){this.owner=e;this.debugNameSource=t;this.referenceFn=n}getDebugName(e){return bA(e,this)}},mA=new Map,KD=new WeakMap;function bA(o,e){let t=KD.get(o);if(t)return t;let n=Rz(o,e);if(n){let i=mA.get(n)??0;i++,mA.set(n,i);let r=i===1?n:`${n}#${i}`;return KD.set(o,r),r}}function Rz(o,e){let t=KD.get(o);if(t)return t;let n=e.owner?Mz(e.owner)+".":"",i,r=e.debugNameSource;if(r!==void 0)if(typeof r=="function"){if(i=r(),i!==void 0)return n+i}else return n+r;let s=e.referenceFn;if(s!==void 0&&(i=zy(s),i!==void 0))return n+i;if(e.owner!==void 0){let a=kz(e.owner,o);if(a!==void 0)return n+a}}function kz(o,e){for(let t in o)if(o[t]===e)return t}var gA=new Map,fA=new WeakMap;function Mz(o){let e=fA.get(o);if(e)return e;let t=Pz(o),n=gA.get(t)??0;n++,gA.set(t,n);let i=n===1?t:`${t}#${n}`;return fA.set(o,i),i}function Pz(o){let e=o.constructor;return e?e.name:"Object"}function zy(o){let e=o.toString(),n=/\/\*\*\s*@description\s*([^*]*)\*\//.exec(e);return(n?n[1]:void 0)?.trim()}function Ky(o,e){if(!o)throw new Error(e?`Assertion failed (${e})`:"Assertion Failed")}function of(o,e="Unreachable"){throw new Error(e)}function GD(o){o||qe(new Ye("Soft Assertion Failed"))}function vs(o){if(!o()){debugger;o(),qe(new Ye("Assertion Failed"))}}function rf(o,e){let t=0;for(;t<o.length-1;){let n=o[t],i=o[t+1];if(!e(n,i))return!1;t++}return!0}function rt(o){return new Bp(new yn(void 0,void 0,o),o,void 0,void 0)}function hl(o,e){return new Bp(new yn(o.owner,o.debugName,o.debugReferenceFn??e),e,void 0,void 0)}function cd(o,e){return new Bp(new yn(o.owner,o.debugName,o.debugReferenceFn??e),e,o.createEmptyChangeSummary,o.handleChange)}function Ei(o){let e=new ee,t=hl({owner:void 0,debugName:void 0,debugReferenceFn:o},n=>{e.clear(),o(n,e)});return le(()=>{t.dispose(),e.dispose()})}var Bp=class{constructor(e,t,n,i){this._debugNameData=e;this._runFn=t;this.createChangeSummary=n;this._handleChange=i;this.changeSummary=this.createChangeSummary?.(),er()?.handleAutorunCreated(this),this._runIfNeeded(),zc(this)}state=2;updateCount=0;disposed=!1;dependencies=new Set;dependenciesToBeRemoved=new Set;changeSummary;get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}dispose(){this.disposed=!0;for(let e of this.dependencies)e.removeObserver(this);this.dependencies.clear(),Kc(this)}_runIfNeeded(){if(this.state===3)return;let e=this.dependenciesToBeRemoved;this.dependenciesToBeRemoved=this.dependencies,this.dependencies=e,this.state=3;let t=this.disposed;try{if(!t){er()?.handleAutorunTriggered(this);let n=this.changeSummary;try{this.changeSummary=this.createChangeSummary?.(),this._runFn(this,n)}catch(i){Rp(i)}}}finally{t||er()?.handleAutorunFinished(this);for(let n of this.dependenciesToBeRemoved)n.removeObserver(this);this.dependenciesToBeRemoved.clear()}}toString(){return`Autorun<${this.debugName}>`}beginUpdate(){this.state===3&&(this.state=1),this.updateCount++}endUpdate(){try{if(this.updateCount===1)do{if(this.state===1){this.state=3;for(let e of this.dependencies)if(e.reportChanges(),this.state===2)break}this._runIfNeeded()}while(this.state!==3)}finally{this.updateCount--}vs(()=>this.updateCount>=0)}handlePossibleChange(e){this.state===3&&this.dependencies.has(e)&&!this.dependenciesToBeRemoved.has(e)&&(this.state=1)}handleChange(e,t){if(this.dependencies.has(e)&&!this.dependenciesToBeRemoved.has(e))try{(this._handleChange?this._handleChange({changedObservable:e,change:t,didChange:i=>i===e},this.changeSummary):!0)&&(this.state=2)}catch(n){Rp(n)}}readObservable(e){if(this.disposed)return e.get();e.addObserver(this);let t=e.get();return this.dependencies.add(e),this.dependenciesToBeRemoved.delete(e),t}};(e=>e.Observer=Bp)(rt||={});function Pe(o,e){return e!==void 0?new ml(new yn(o,void 0,e),e,void 0,void 0,void 0,Ki):new ml(new yn(void 0,void 0,o),o,void 0,void 0,void 0,Ki)}function Vp(o,e,t){return new jD(new yn(o,void 0,e),e,void 0,void 0,void 0,Ki,t)}function ua(o,e){return new ml(new yn(o.owner,o.debugName,o.debugReferenceFn),e,void 0,void 0,o.onLastObserverRemoved,o.equalsFn??Ki)}vA(ua);function gl(o,e){let t,n;e===void 0?(t=o,n=void 0):(n=o,t=e);let i=new ee;return new ml(new yn(n,void 0,t),r=>(i.clear(),t(r,i)),void 0,void 0,()=>i.dispose(),Ki)}function Dr(o,e){let t,n;e===void 0?(t=o,n=void 0):(n=o,t=e);let i;return new ml(new yn(n,void 0,t),r=>{i?i.clear():i=new ee;let s=t(r);return s&&i.add(s),s},void 0,void 0,()=>{i&&(i.dispose(),i=void 0)},Ki)}var ml=class extends ys{constructor(t,n,i,r,s=void 0,a){super();this._debugNameData=t;this._computeFn=n;this.createChangeSummary=i;this._handleChange=r;this._handleLastObserverRemoved=s;this._equalityComparator=a;this.changeSummary=this.createChangeSummary?.(),er()?.handleDerivedCreated(this)}state=0;value=void 0;updateCount=0;dependencies=new Set;dependenciesToBeRemoved=new Set;changeSummary=void 0;get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}onLastObserverRemoved(){this.state=0,this.value=void 0;for(let t of this.dependencies)t.removeObserver(this);this.dependencies.clear(),this._handleLastObserverRemoved?.()}get(){if(this.observers.size===0){let t=this._computeFn(this,this.createChangeSummary?.());return this.onLastObserverRemoved(),t}else{do{if(this.state===1){for(let t of this.dependencies)if(t.reportChanges(),this.state===2)break}this.state===1&&(this.state=3),this._recomputeIfNeeded()}while(this.state!==3);return this.value}}_recomputeIfNeeded(){if(this.state===3)return;let t=this.dependenciesToBeRemoved;this.dependenciesToBeRemoved=this.dependencies,this.dependencies=t;let n=this.state!==0,i=this.value;this.state=3;let r=!1;try{let s=this.changeSummary;this.changeSummary=this.createChangeSummary?.();try{this.value=this._computeFn(this,s)}finally{for(let a of this.dependenciesToBeRemoved)a.removeObserver(this);this.dependenciesToBeRemoved.clear()}r=n&&!this._equalityComparator(i,this.value),er()?.handleDerivedRecomputed(this,{oldValue:i,newValue:this.value,change:void 0,didChange:r,hadValue:n})}catch(s){Rp(s)}if(r)for(let s of this.observers)s.handleChange(this,void 0)}toString(){return`LazyDerived<${this.debugName}>`}beginUpdate(t){this.updateCount++;let n=this.updateCount===1;if(this.state===3&&(this.state=1,!n))for(let i of this.observers)i.handlePossibleChange(this);if(n)for(let i of this.observers)i.beginUpdate(this)}endUpdate(t){if(this.updateCount--,this.updateCount===0){let n=[...this.observers];for(let i of n)i.endUpdate(this)}vs(()=>this.updateCount>=0)}handlePossibleChange(t){if(this.state===3&&this.dependencies.has(t)&&!this.dependenciesToBeRemoved.has(t)){this.state=1;for(let n of this.observers)n.handlePossibleChange(this)}}handleChange(t,n){if(this.dependencies.has(t)&&!this.dependenciesToBeRemoved.has(t)){let i=!1;try{i=this._handleChange?this._handleChange({changedObservable:t,change:n,didChange:s=>s===t},this.changeSummary):!0}catch(s){Rp(s)}let r=this.state===3;if(i&&(this.state===1||r)&&(this.state=2,r))for(let s of this.observers)s.handlePossibleChange(this)}}readObservable(t){t.addObserver(this);let n=t.get();return this.dependencies.add(t),this.dependenciesToBeRemoved.delete(t),n}addObserver(t){let n=!this.observers.has(t)&&this.updateCount>0;super.addObserver(t),n&&t.beginUpdate(this)}removeObserver(t){let n=this.observers.has(t)&&this.updateCount>0;super.removeObserver(t),n&&t.endUpdate(this)}},jD=class extends ml{constructor(t,n,i,r,s=void 0,a,l){super(t,n,i,r,s,a);this.set=l}};function ud(o){return new qD(o)}var qD=class extends sf{constructor(t){super();this.value=t}get debugName(){return this.toString()}get(){return this.value}addObserver(t){}removeObserver(t){}toString(){return`Const: ${this.value}`}};function Lt(...o){let e,t,n;return o.length===3?[e,t,n]=o:[t,n]=o,new pa(new yn(e,void 0,n),t,n,()=>pa.globalTransaction,Ki)}function yA(o,e,t){return new pa(new yn(o.owner,o.debugName,o.debugReferenceFn??t),e,t,()=>pa.globalTransaction,o.equalsFn??Ki)}var pa=class extends ys{constructor(t,n,i,r,s){super();this._debugNameData=t;this.event=n;this._getValue=i;this._getTransaction=r;this._equalityComparator=s}static globalTransaction;value;hasValue=!1;subscription;getDebugName(){return this._debugNameData.getDebugName(this)}get debugName(){let t=this.getDebugName();return"From Event"+(t?`: ${t}`:"")}onFirstObserverAdded(){this.subscription=this.event(this.handleEvent)}handleEvent=t=>{let n=this._getValue(t),i=this.value,r=!this.hasValue||!this._equalityComparator(i,n),s=!1;r&&(this.value=n,this.hasValue&&(s=!0,jc(this._getTransaction(),a=>{er()?.handleFromEventObservableTriggered(this,{oldValue:i,newValue:n,change:void 0,didChange:r,hadValue:this.hasValue});for(let l of this.observers)a.updateObserver(l,this),l.handleChange(this,void 0)},()=>{let a=this.getDebugName();return"Event fired"+(a?`: ${a}`:"")})),this.hasValue=!0),s||er()?.handleFromEventObservableTriggered(this,{oldValue:i,newValue:n,change:void 0,didChange:r,hadValue:this.hasValue})};onLastObserverRemoved(){this.subscription.dispose(),this.subscription=void 0,this.hasValue=!1,this.value=void 0}get(){return this.subscription?(this.hasValue||this.handleEvent(void 0),this.value):this._getValue(void 0)}};(t=>{t.Observer=pa;function e(n,i){let r=!1;pa.globalTransaction===void 0&&(pa.globalTransaction=n,r=!0);try{i()}finally{r&&(pa.globalTransaction=void 0)}}t.batchEventsGlobally=e})(Lt||={});function Ti(o,e){return new $D(o,e)}var $D=class extends ys{constructor(t,n){super();this.debugName=t;this.event=n}subscription;onFirstObserverAdded(){this.subscription=this.event(this.handleEvent)}handleEvent=()=>{Xt(t=>{for(let n of this.observers)t.updateObserver(n,this),n.handleChange(this,void 0)},()=>this.debugName)};onLastObserverRemoved(){this.subscription.dispose(),this.subscription=void 0}get(){}};function Gc(o){return typeof o=="string"?new Gy(o):new Gy(void 0,o)}var Gy=class extends ys{constructor(t,n){super();this._debugName=t;this._owner=n}get debugName(){return new yn(this._owner,this._debugName,void 0).getDebugName(this)??"Observable Signal"}toString(){return this.debugName}trigger(t,n){if(!t){Xt(i=>{this.trigger(i,n)},()=>`Trigger signal ${this.debugName}`);return}for(let i of this.observers)t.updateObserver(i,this),i.handleChange(this,n)}get(){}};function IA(o){let e=new jy(!1,void 0);return o.addObserver(e),le(()=>{o.removeObserver(e)})}TA(IA);function Wp(o,e){let t=new jy(!0,e);return o.addObserver(t),e?e(o.get()):o.reportChanges(),le(()=>{o.removeObserver(t)})}EA(Wp);var jy=class{constructor(e,t){this._forceRecompute=e;this._handleValue=t}_counter=0;beginUpdate(e){this._counter++}endUpdate(e){this._counter--,this._counter===0&&this._forceRecompute&&(this._handleValue?this._handleValue(e.get()):e.reportChanges())}handlePossibleChange(e){}handleChange(e,t){}};function CA(o,e){let t;return ua({owner:o,debugReferenceFn:e},i=>(t=e(i,t),t))}var qy=class{constructor(e){this.observable=e}get onDidChange(){return q.fromObservableLight(this.observable)}get value(){return this.observable.get()}};function SA(o,e){return CA(o,(t,n)=>n??e(t))}var xA;function wA(o){xA=o}function er(){return xA}var $y=class{indentation=0;textToConsoleArgs(e){return Az([Hp(Vz("|  ",this.indentation)),e])}formatInfo(e){return e.hadValue?e.didChange?[Hp(" "),Is(lf(e.oldValue,70),{color:"red",strikeThrough:!0}),Hp(" "),Is(lf(e.newValue,60),{color:"green"})]:[Hp(" (unchanged)")]:[Hp(" "),Is(lf(e.newValue,60),{color:"green"}),Hp(" (initial)")]}handleObservableChanged(e,t){console.log(...this.textToConsoleArgs([af("observable value changed"),Is(e.debugName,{color:"BlueViolet"}),...this.formatInfo(t)]))}changedObservablesSets=new WeakMap;formatChanges(e){if(e.size!==0)return Is(" (changed deps: "+[...e].map(t=>t.debugName).join(", ")+")",{color:"gray"})}handleDerivedCreated(e){let t=e.handleChange;this.changedObservablesSets.set(e,new Set),e.handleChange=(n,i)=>(this.changedObservablesSets.get(e).add(n),t.apply(e,[n,i]))}handleDerivedRecomputed(e,t){let n=this.changedObservablesSets.get(e);console.log(...this.textToConsoleArgs([af("derived recomputed"),Is(e.debugName,{color:"BlueViolet"}),...this.formatInfo(t),this.formatChanges(n),{data:[{fn:e._debugNameData.referenceFn??e._computeFn}]}])),n.clear()}handleFromEventObservableTriggered(e,t){console.log(...this.textToConsoleArgs([af("observable from event triggered"),Is(e.debugName,{color:"BlueViolet"}),...this.formatInfo(t),{data:[{fn:e._getValue}]}]))}handleAutorunCreated(e){let t=e.handleChange;this.changedObservablesSets.set(e,new Set),e.handleChange=(n,i)=>(this.changedObservablesSets.get(e).add(n),t.apply(e,[n,i]))}handleAutorunTriggered(e){let t=this.changedObservablesSets.get(e);console.log(...this.textToConsoleArgs([af("autorun"),Is(e.debugName,{color:"BlueViolet"}),this.formatChanges(t),{data:[{fn:e._debugNameData.referenceFn??e._runFn}]}])),t.clear(),this.indentation++}handleAutorunFinished(e){this.indentation--}handleBeginTransaction(e){let t=e.getDebugName();t===void 0&&(t=""),console.log(...this.textToConsoleArgs([af("transaction"),Is(t,{color:"BlueViolet"}),{data:[{fn:e._fn}]}])),this.indentation++}handleEndTransaction(){this.indentation--}};function Az(o){let e=new Array,t=[],n="";function i(s){if("length"in s)for(let a of s)a&&i(a);else"text"in s?(n+=`%c${s.text}`,e.push(s.style),s.data&&t.push(...s.data)):"data"in s&&t.push(...s.data)}i(o);let r=[n,...e];return r.push(...t),r}function Hp(o){return Is(o,{color:"black"})}function af(o){return Is(Wz(`${o}: `,10),{color:"black",bold:!0})}function Is(o,e={color:"black"}){function t(i){return Object.entries(i).reduce((r,[s,a])=>`${r}${s}:${a};`,"")}let n={color:e.color};return e.strikeThrough&&(n["text-decoration"]="line-through"),e.bold&&(n["font-weight"]="bold"),{text:o,style:t(n)}}function lf(o,e){switch(typeof o){case"number":return""+o;case"string":return o.length+2<=e?`"${o}"`:`"${o.substr(0,e-7)}"+...`;case"boolean":return o?"true":"false";case"undefined":return"undefined";case"object":return o===null?"null":Array.isArray(o)?Fz(o,e):Bz(o,e);case"symbol":return o.toString();case"function":return`[[Function${o.name?" "+o.name:""}]]`;default:return""+o}}function Fz(o,e){let t="[ ",n=!0;for(let i of o){if(n||(t+=", "),t.length-5>e){t+="...";break}n=!1,t+=`${lf(i,e-t.length)}`}return t+=" ]",t}function Bz(o,e){let t="{ ",n=!0;for(let[i,r]of Object.entries(o)){if(n||(t+=", "),t.length-5>e){t+="...";break}n=!1,t+=`${i}: ${lf(r,e-t.length)}`}return t+=" }",t}function Vz(o,e){let t="";for(let n=1;n<=e;n++)t+=o;return t}function Wz(o,e){for(;o.length<e;)o+=" ";return o}var _A;function EA(o){_A=o}var DA;function TA(o){DA=o}var YD;function vA(o){YD=o}var sf=class{get TChange(){return null}reportChanges(){this.get()}read(e){return e?e.readObservable(this):this.get()}map(e,t){let n=t===void 0?void 0:e,i=t===void 0?e:t;return YD({owner:n,debugName:()=>{let r=zy(i);if(r!==void 0)return r;let a=/^\s*\(?\s*([a-zA-Z_$][a-zA-Z_$0-9]*)\s*\)?\s*=>\s*\1(?:\??)\.([a-zA-Z_$][a-zA-Z_$0-9]*)\s*$/.exec(i.toString());if(a)return`${this.debugName}.${a[2]}`;if(!n)return`${this.debugName} (mapped)`},debugReferenceFn:i},r=>i(this.read(r),r))}flatten(){return YD({owner:void 0,debugName:()=>`${this.debugName} (flattened)`},e=>this.read(e).read(e))}recomputeInitiallyAndOnChange(e,t){return e.add(_A(this,t)),this}keepObserved(e){return e.add(DA(this)),this}get debugValue(){return this.get()}},ys=class extends sf{observers=new Set;addObserver(e){let t=this.observers.size;this.observers.add(e),t===0&&this.onFirstObserverAdded()}removeObserver(e){this.observers.delete(e)&&this.observers.size===0&&this.onLastObserverRemoved()}onFirstObserverAdded(){}onLastObserverRemoved(){}};function Xt(o,e){let t=new pd(o,e);try{o(t)}finally{t.finish()}}function jc(o,e,t){o?e(o):Xt(e,t)}var pd=class{constructor(e,t){this._fn=e;this._getDebugName=t;er()?.handleBeginTransaction(this)}updatingObservers=[];getDebugName(){return this._getDebugName?this._getDebugName():zy(this._fn)}updateObserver(e,t){this.updatingObservers.push({observer:e,observable:t}),e.beginUpdate(t)}finish(){let e=this.updatingObservers;for(let t=0;t<e.length;t++){let{observer:n,observable:i}=e[t];n.endUpdate(i)}this.updatingObservers=null,er()?.handleEndTransaction()}};function at(o,e){let t;return typeof o=="string"?t=new yn(void 0,o,void 0):t=new yn(o,void 0,void 0),new Up(t,e,Ki)}var Up=class extends ys{constructor(t,n,i){super();this._debugNameData=t;this._equalityComparator=i;this._value=n}_value;get debugName(){return this._debugNameData.getDebugName(this)??"ObservableValue"}get(){return this._value}set(t,n,i){if(i===void 0&&this._equalityComparator(this._value,t))return;let r;n||(n=r=new pd(()=>{},()=>`Setting ${this.debugName}`));try{let s=this._value;this._setValue(t),er()?.handleObservableChanged(this,{oldValue:s,newValue:t,change:i,didChange:!0,hadValue:!0});for(let a of this.observers)n.updateObserver(a,this),a.handleChange(this,i)}finally{r&&r.finish()}}toString(){return`${this.debugName}: ${this._value}`}_setValue(t){this._value=t}};function XD(o,e){let t;return typeof o=="string"?t=new yn(void 0,o,void 0):t=new yn(o,void 0,void 0),new ZD(t,e,Ki)}var ZD=class extends Up{_setValue(e){this._value!==e&&(this._value&&this._value.dispose(),this._value=e)}dispose(){this._value?.dispose()}};function QD(o,e,t,n){return e||(e=i=>i!=null),new Promise((i,r)=>{let s=!0,a=!1,l=o.map(c=>({isFinished:e(c),error:t?t(c):!1,state:c})),d=rt(c=>{let{isFinished:u,error:p,state:h}=l.read(c);(u||p)&&(s?a=!0:d.dispose(),p?r(p===!0?h:p):i(h))});if(n){let c=n.onCancellationRequested(()=>{d.dispose(),c.dispose(),r(new Vi)});if(n.isCancellationRequested){d.dispose(),c.dispose(),r(new Vi);return}}s=!1,a&&d.dispose()})}var Yy=class extends ys{constructor(t,n,i){super();this._debugNameData=t;this._equalityComparator=i;this._value=n}_value;_isUpToDate=!0;_deltas=[];get debugName(){return this._debugNameData.getDebugName(this)??"LazyObservableValue"}get(){return this._update(),this._value}_update(){if(!this._isUpToDate)if(this._isUpToDate=!0,this._deltas.length>0){for(let t of this.observers)for(let n of this._deltas)t.handleChange(this,n);this._deltas.length=0}else for(let t of this.observers)t.handleChange(this,void 0)}_updateCounter=0;_beginUpdate(){if(this._updateCounter++,this._updateCounter===1)for(let t of this.observers)t.beginUpdate(this)}_endUpdate(){if(this._updateCounter--,this._updateCounter===0){this._update();let t=[...this.observers];for(let n of t)n.endUpdate(this)}}addObserver(t){let n=!this.observers.has(t)&&this._updateCounter>0;super.addObserver(t),n&&t.beginUpdate(this)}removeObserver(t){let n=this.observers.has(t)&&this._updateCounter>0;super.removeObserver(t),n&&t.endUpdate(this)}set(t,n,i){if(i===void 0&&this._equalityComparator(this._value,t))return;let r;n||(n=r=new pd(()=>{},()=>`Setting ${this.debugName}`));try{if(this._isUpToDate=!1,this._setValue(t),i!==void 0&&this._deltas.push(i),n.updateObserver({beginUpdate:()=>this._beginUpdate(),endUpdate:()=>this._endUpdate(),handleChange:(s,a)=>{},handlePossibleChange:s=>{}},this),this._updateCounter>1)for(let s of this.observers)s.handlePossibleChange(this)}finally{r&&r.finish()}}toString(){return`${this.debugName}: ${this._value}`}_setValue(t){this._value=t}};function Zy(o,e){return o.lazy?new Yy(new yn(o.owner,o.debugName,void 0),e,o.equalsFn??Ki):new Up(new yn(o.owner,o.debugName,void 0),e,o.equalsFn??Ki)}var Hz=!1;Hz&&wA(new $y);var Uz=globalThis.performance&&typeof globalThis.performance.now=="function",Cs=class o{_startTime;_stopTime;_now;static create(e){return new o(e)}constructor(e){this._now=Uz&&e===!1?Date.now:globalThis.performance.now.bind(globalThis.performance),this._startTime=this._now(),this._stopTime=-1}stop(){this._stopTime=this._now()}reset(){this._startTime=this._now(),this._stopTime=-1}elapsed(){return this._stopTime!==-1?this._stopTime-this._startTime:this._now()-this._startTime}};var Xy=Symbol("MicrotaskDelay");var zz=!1,LA=!1,Kz=!1,q;(Se=>{Se.None=()=>F.None;function e(ne){if(Kz){let{onDidAddListener:Q}=ne,de=df.create(),se=0;ne.onDidAddListener=()=>{++se===2&&(console.warn("snapshotted emitter LIKELY used public and SHOULD HAVE BEEN created with DisposableStore. snapshotted here"),de.print()),Q?.()}}}function t(ne,Q){return h(ne,()=>{},0,void 0,!0,void 0,Q)}Se.defer=t;function n(ne){return(Q,de=null,se)=>{let ie=!1,Te;return Te=ne(ue=>{if(!ie)return Te?Te.dispose():ie=!0,Q.call(de,ue)},null,se),ie&&Te.dispose(),Te}}Se.once=n;function i(ne,Q){return Se.once(Se.filter(ne,Q))}Se.onceIf=i;function r(ne,Q,de){return u((se,ie=null,Te)=>ne(ue=>se.call(ie,Q(ue)),null,Te),de)}Se.map=r;function s(ne,Q,de){return u((se,ie=null,Te)=>ne(ue=>{Q(ue),se.call(ie,ue)},null,Te),de)}Se.forEach=s;function a(ne,Q,de){return u((se,ie=null,Te)=>ne(ue=>Q(ue)&&se.call(ie,ue),null,Te),de)}Se.filter=a;function l(ne){return ne}Se.signal=l;function d(...ne){return(Q,de=null,se)=>{let ie=Ro(...ne.map(Te=>Te(ue=>Q.call(de,ue))));return p(ie,se)}}Se.any=d;function c(ne,Q,de,se){let ie=de;return r(ne,Te=>(ie=Q(ie,Te),ie),se)}Se.reduce=c;function u(ne,Q){let de,se={onWillAddFirstListener(){de=ne(ie.fire,ie)},onDidRemoveLastListener(){de?.dispose()}};Q||e(se);let ie=new D(se);return Q?.add(ie),ie.event}function p(ne,Q){return Q instanceof Array?Q.push(ne):Q&&Q.add(ne),ne}function h(ne,Q,de=100,se=!1,ie=!1,Te,ue){let Xe,ze,_e,vn=0,cn,Bn={leakWarningThreshold:Te,onWillAddFirstListener(){Xe=ne(ms=>{vn++,ze=Q(ze,ms),se&&!_e&&(di.fire(ze),ze=void 0),cn=()=>{let Nt=ze;ze=void 0,_e=void 0,(!se||vn>1)&&di.fire(Nt),vn=0},typeof de=="number"?(clearTimeout(_e),_e=setTimeout(cn,de)):_e===void 0&&(_e=0,queueMicrotask(cn))})},onWillRemoveListener(){ie&&vn>0&&cn?.()},onDidRemoveLastListener(){cn=void 0,Xe.dispose()}};ue||e(Bn);let di=new D(Bn);return ue?.add(di),di.event}Se.debounce=h;function f(ne,Q=0,de){return Se.debounce(ne,(se,ie)=>se?(se.push(ie),se):[ie],Q,void 0,!0,void 0,de)}Se.accumulate=f;function g(ne,Q=(se,ie)=>se===ie,de){let se=!0,ie;return a(ne,Te=>{let ue=se||!Q(Te,ie);return se=!1,ie=Te,ue},de)}Se.latch=g;function b(ne,Q,de){return[Se.filter(ne,Q,de),Se.filter(ne,se=>!Q(se),de)]}Se.split=b;function v(ne,Q=!1,de=[],se){let ie=de.slice(),Te=ne(ze=>{ie?ie.push(ze):Xe.fire(ze)});se&&se.add(Te);let ue=()=>{ie?.forEach(ze=>Xe.fire(ze)),ie=null},Xe=new D({onWillAddFirstListener(){Te||(Te=ne(ze=>Xe.fire(ze)),se&&se.add(Te))},onDidAddFirstListener(){ie&&(Q?setTimeout(ue):ue())},onDidRemoveLastListener(){Te&&Te.dispose(),Te=null}});return se&&se.add(Xe),Xe.event}Se.buffer=v;function y(ne,Q){return(se,ie,Te)=>{let ue=Q(new E);return ne(function(Xe){let ze=ue.evaluate(Xe);ze!==S&&se.call(ie,ze)},void 0,Te)}}Se.chain=y;let S=Symbol("HaltChainable");class E{steps=[];map(Q){return this.steps.push(Q),this}forEach(Q){return this.steps.push(de=>(Q(de),de)),this}filter(Q){return this.steps.push(de=>Q(de)?de:S),this}reduce(Q,de){let se=de;return this.steps.push(ie=>(se=Q(se,ie),se)),this}latch(Q=(de,se)=>de===se){let de=!0,se;return this.steps.push(ie=>{let Te=de||!Q(ie,se);return de=!1,se=ie,Te?ie:S}),this}evaluate(Q){for(let de of this.steps)if(Q=de(Q),Q===S)break;return Q}}function C(ne,Q,de=se=>se){let se=(...Xe)=>ue.fire(de(...Xe)),ie=()=>ne.on(Q,se),Te=()=>ne.removeListener(Q,se),ue=new D({onWillAddFirstListener:ie,onDidRemoveLastListener:Te});return ue.event}Se.fromNodeEventEmitter=C;function w(ne,Q,de=se=>se){let se=(...Xe)=>ue.fire(de(...Xe)),ie=()=>ne.addEventListener(Q,se),Te=()=>ne.removeEventListener(Q,se),ue=new D({onWillAddFirstListener:ie,onDidRemoveLastListener:Te});return ue.event}Se.fromDOMEventEmitter=w;function _(ne){return new Promise(Q=>n(ne)(Q))}Se.toPromise=_;function L(ne){let Q=new D;return ne.then(de=>{Q.fire(de)},()=>{Q.fire(void 0)}).finally(()=>{Q.dispose()}),Q.event}Se.fromPromise=L;function k(ne,Q){return ne(de=>Q.fire(de))}Se.forward=k;function W(ne,Q,de){return Q(de),ne(se=>Q(se))}Se.runAndSubscribe=W;class K{constructor(Q,de){this._observable=Q;let se={onWillAddFirstListener:()=>{Q.addObserver(this),this._observable.reportChanges()},onDidRemoveLastListener:()=>{Q.removeObserver(this)}};de||e(se),this.emitter=new D(se),de&&de.add(this.emitter)}emitter;_counter=0;_hasChanged=!1;beginUpdate(Q){this._counter++}handlePossibleChange(Q){}handleChange(Q,de){this._hasChanged=!0}endUpdate(Q){this._counter--,this._counter===0&&(this._observable.reportChanges(),this._hasChanged&&(this._hasChanged=!1,this.emitter.fire(this._observable.get())))}}function U(ne,Q){return new K(ne,Q).emitter.event}Se.fromObservable=U;function oe(ne){return(Q,de,se)=>{let ie=0,Te=!1,ue={beginUpdate(){ie++},endUpdate(){ie--,ie===0&&(ne.reportChanges(),Te&&(Te=!1,Q.call(de)))},handlePossibleChange(){},handleChange(){Te=!0}};ne.addObserver(ue),ne.reportChanges();let Xe={dispose(){ne.removeObserver(ue)}};return se instanceof ee?se.add(Xe):Array.isArray(se)&&se.push(Xe),Xe}}Se.fromObservableLight=oe})(q||={});var JD=class o{static all=new Set;static _idPool=0;name;listenerCount=0;invocationCount=0;elapsedOverall=0;durations=[];_stopWatch;constructor(e){this.name=`${e}_${o._idPool++}`,o.all.add(this)}start(e){this._stopWatch=new Cs,this.listenerCount=e}stop(){if(this._stopWatch){let e=this._stopWatch.elapsed();this.durations.push(e),this.elapsedOverall+=e,this.invocationCount+=1,this._stopWatch=void 0}}},RA=-1;var eL=class o{constructor(e,t,n=(o._idPool++).toString(16).padStart(3,"0")){this._errorHandler=e;this.threshold=t;this.name=n}static _idPool=1;_stacks;_warnCountdown=0;dispose(){this._stacks?.clear()}check(e,t){let n=this.threshold;if(n<=0||t<n)return;this._stacks||(this._stacks=new Map);let i=this._stacks.get(e.value)||0;if(this._stacks.set(e.value,i+1),this._warnCountdown-=1,this._warnCountdown<=0){this._warnCountdown=n*.5;let[r,s]=this.getMostFrequentStack(),a=`[${this.name}] potential listener LEAK detected, having ${t} listeners already. MOST frequent listener (${s}):`;console.warn(a),console.warn(r);let l=new tL(a,r);this._errorHandler(l)}return()=>{let r=this._stacks.get(e.value)||0;this._stacks.set(e.value,r-1)}}getMostFrequentStack(){if(!this._stacks)return;let e,t=0;for(let[n,i]of this._stacks)(!e||t<i)&&(e=[n,i],t=i);return e}},df=class o{constructor(e){this.value=e}static create(){let e=new Error;return new o(e.stack??"")}print(){console.warn(this.value.split(`
`).slice(2).join(`
`))}},tL=class extends Error{constructor(e,t){super(e),this.name="ListenerLeakError",this.stack=t}},nL=class extends Error{constructor(e,t){super(e),this.name="ListenerRefusalError",this.stack=t}},Gz=0,zp=class{constructor(e){this.value=e}stack;id=Gz++},jz=2,kA=(o,e)=>{if(o instanceof zp)e(o);else for(let t=0;t<o.length;t++){let n=o[t];n&&e(n)}},Qy;if(zz){let o=[];setInterval(()=>{o.length!==0&&(console.warn("[LEAKING LISTENERS] GC'ed these listeners that were NOT yet disposed:"),console.warn(o.join(`
`)),o.length=0)},3e3),Qy=new FinalizationRegistry(e=>{typeof e=="string"&&o.push(e)})}var D=class{_options;_leakageMon;_perfMon;_disposed;_event;_listeners;_deliveryQueue;_size=0;constructor(e){this._options=e,this._leakageMon=RA>0||this._options?.leakWarningThreshold?new eL(e?.onListenerError??qe,this._options?.leakWarningThreshold??RA):void 0,this._perfMon=this._options?._profName?new JD(this._options._profName):void 0,this._deliveryQueue=this._options?.deliveryQueue}dispose(){if(!this._disposed){if(this._disposed=!0,this._deliveryQueue?.current===this&&this._deliveryQueue.reset(),this._listeners){if(LA){let e=this._listeners;queueMicrotask(()=>{kA(e,t=>t.stack?.print())})}this._listeners=void 0,this._size=0}this._options?.onDidRemoveLastListener?.(),this._leakageMon?.dispose()}}get event(){return this._event??=(e,t,n)=>{if(this._leakageMon&&this._size>this._leakageMon.threshold**2){let l=`[${this._leakageMon.name}] REFUSES to accept new listeners because it exceeded its threshold by far (${this._size} vs ${this._leakageMon.threshold})`;console.warn(l);let d=this._leakageMon.getMostFrequentStack()??["UNKNOWN stack",-1],c=new nL(`${l}. HINT: Stack shows most frequent listener (${d[1]}-times)`,d[0]);return(this._options?.onListenerError||qe)(c),F.None}if(this._disposed)return F.None;t&&(e=e.bind(t));let i=new zp(e),r,s;this._leakageMon&&this._size>=Math.ceil(this._leakageMon.threshold*.2)&&(i.stack=df.create(),r=this._leakageMon.check(i.stack,this._size+1)),LA&&(i.stack=s??df.create()),this._listeners?this._listeners instanceof zp?(this._deliveryQueue??=new Jy,this._listeners=[this._listeners,i]):this._listeners.push(i):(this._options?.onWillAddFirstListener?.(this),this._listeners=i,this._options?.onDidAddFirstListener?.(this)),this._size++;let a=le(()=>{Qy?.unregister(a),r?.(),this._removeListener(i)});if(n instanceof ee?n.add(a):Array.isArray(n)&&n.push(a),Qy){let l=new Error().stack.split(`
`).slice(2,3).join(`
`).trim(),d=/(file:|vscode-file:\/\/vscode-app)?(\/[^:]*:\d+:\d+)/.exec(l);Qy.register(a,d?.[2]??l,a)}return a},this._event}_removeListener(e){if(this._options?.onWillRemoveListener?.(this),!this._listeners)return;if(this._size===1){this._listeners=void 0,this._options?.onDidRemoveLastListener?.(this),this._size=0;return}let t=this._listeners,n=t.indexOf(e);if(n===-1)throw console.log("disposed?",this._disposed),console.log("size?",this._size),console.log("arr?",JSON.stringify(this._listeners)),new Error("Attempted to dispose unknown listener");this._size--,t[n]=void 0;let i=this._deliveryQueue.current===this;if(this._size*jz<=t.length){let r=0;for(let s=0;s<t.length;s++)t[s]?t[r++]=t[s]:i&&(this._deliveryQueue.end--,r<this._deliveryQueue.i&&this._deliveryQueue.i--);t.length=r}}_deliver(e,t){if(!e)return;let n=this._options?.onListenerError||qe;if(!n){e.value(t);return}try{e.value(t)}catch(i){n(i)}}_deliverQueue(e){let t=e.current._listeners;for(;e.i<e.end;)this._deliver(t[e.i++],e.value);e.reset()}fire(e){if(this._deliveryQueue?.current&&(this._deliverQueue(this._deliveryQueue),this._perfMon?.stop()),this._perfMon?.start(this._size),this._listeners)if(this._listeners instanceof zp)this._deliver(this._listeners,e);else{let t=this._deliveryQueue;t.enqueue(this,e,this._listeners.length),this._deliverQueue(t)}this._perfMon?.stop()}hasListeners(){return this._size>0}},MA=()=>new Jy,Jy=class{i=-1;end=0;current;value;enqueue(e,t,n){this.i=0,this.end=n,this.current=e,this.value=t}reset(){this.i=this.end,this.current=void 0,this.value=void 0}},Kp=class extends D{_asyncDeliveryQueue;async fireAsync(e,t,n){if(this._listeners)for(this._asyncDeliveryQueue||(this._asyncDeliveryQueue=new zi),kA(this._listeners,i=>this._asyncDeliveryQueue.push([i.value,e]));this._asyncDeliveryQueue.size>0&&!t.isCancellationRequested;){let[i,r]=this._asyncDeliveryQueue.shift(),s=[],a={...r,token:t,waitUntil:l=>{if(Object.isFrozen(s))throw new Error("waitUntil can NOT be called asynchronous");n&&(l=n(l,i)),s.push(l)}};try{i(a)}catch(l){qe(l);continue}Object.freeze(s),await Promise.allSettled(s).then(l=>{for(let d of l)d.status==="rejected"&&qe(d.reason)})}}},hd=class extends D{_isPaused=0;_eventQueue=new zi;_mergeFn;get isPaused(){return this._isPaused!==0}constructor(e){super(e),this._mergeFn=e?.merge}pause(){this._isPaused++}resume(){if(this._isPaused!==0&&--this._isPaused===0)if(this._mergeFn){if(this._eventQueue.size>0){let e=Array.from(this._eventQueue);this._eventQueue.clear(),super.fire(this._mergeFn(e))}}else for(;!this._isPaused&&this._eventQueue.size!==0;)super.fire(this._eventQueue.shift())}fire(e){this._size&&(this._isPaused!==0?this._eventQueue.push(e):super.fire(e))}},eI=class extends hd{_delay;_handle;constructor(e){super(e),this._delay=e.delay??100}fire(e){this._handle||(this.pause(),this._handle=setTimeout(()=>{this._handle=void 0,this.resume()},this._delay)),super.fire(e)}},tI=class extends D{_queuedEvents=[];_mergeFn;constructor(e){super(e),this._mergeFn=e?.merge}fire(e){this.hasListeners()&&(this._queuedEvents.push(e),this._queuedEvents.length===1&&queueMicrotask(()=>{this._mergeFn?super.fire(this._mergeFn(this._queuedEvents)):this._queuedEvents.forEach(t=>super.fire(t)),this._queuedEvents=[]}))}},cf=class{emitter;hasListeners=!1;events=[];constructor(){this.emitter=new D({onWillAddFirstListener:()=>this.onFirstListenerAdd(),onDidRemoveLastListener:()=>this.onLastListenerRemove()})}get event(){return this.emitter.event}add(e){let t={event:e,listener:null};return this.events.push(t),this.hasListeners&&this.hook(t),le(bs(()=>{this.hasListeners&&this.unhook(t);let i=this.events.indexOf(t);this.events.splice(i,1)}))}onFirstListenerAdd(){this.hasListeners=!0,this.events.forEach(e=>this.hook(e))}onLastListenerRemove(){this.hasListeners=!1,this.events.forEach(e=>this.unhook(e))}hook(e){e.listener=e.event(t=>this.emitter.fire(t))}unhook(e){e.listener?.dispose(),e.listener=null}dispose(){this.emitter.dispose();for(let e of this.events)e.listener?.dispose();this.events=[]}};var md=class{data=[];wrapEvent(e,t,n){return(i,r,s)=>e(a=>{let l=this.data[this.data.length-1];if(!t){l?l.buffers.push(()=>i.call(r,a)):i.call(r,a);return}let d=l;if(!d){i.call(r,t(n,a));return}d.items??=[],d.items.push(a),d.buffers.length===0&&l.buffers.push(()=>{d.reducedResult??=n?d.items.reduce(t,n):d.items.reduce(t),i.call(r,d.reducedResult)})},void 0,s)}bufferEvents(e){let t={buffers:new Array};this.data.push(t);let n=e();return this.data.pop(),t.buffers.forEach(i=>i()),n}},Yr=class{listening=!1;inputEvent=q.None;inputEventListener=F.None;emitter=new D({onDidAddFirstListener:()=>{this.listening=!0,this.inputEventListener=this.inputEvent(this.emitter.fire,this.emitter)},onDidRemoveLastListener:()=>{this.listening=!1,this.inputEventListener.dispose()}});event=this.emitter.event;set input(e){this.inputEvent=e,this.listening&&(this.inputEventListener.dispose(),this.inputEventListener=e(this.emitter.fire,this.emitter))}dispose(){this.inputEventListener.dispose(),this.emitter.dispose()}};var Ht=class extends F{_onDidChange=this._register(new D);onDidChange=this._onDidChange.event;_id;_label;_tooltip;_cssClass;_enabled=!0;_checked;_actionCallback;constructor(e,t="",n="",i=!0,r){super(),this._id=e,this._label=t,this._cssClass=n,this._enabled=i,this._actionCallback=r}get id(){return this._id}get label(){return this._label}set label(e){this._setLabel(e)}_setLabel(e){this._label!==e&&(this._label=e,this._onDidChange.fire({label:e}))}get tooltip(){return this._tooltip||""}set tooltip(e){this._setTooltip(e)}_setTooltip(e){this._tooltip!==e&&(this._tooltip=e,this._onDidChange.fire({tooltip:e}))}get class(){return this._cssClass}set class(e){this._setClass(e)}_setClass(e){this._cssClass!==e&&(this._cssClass=e,this._onDidChange.fire({class:e}))}get enabled(){return this._enabled}set enabled(e){this._setEnabled(e)}_setEnabled(e){this._enabled!==e&&(this._enabled=e,this._onDidChange.fire({enabled:e}))}get checked(){return this._checked}set checked(e){this._setChecked(e)}_setChecked(e){this._checked!==e&&(this._checked=e,this._onDidChange.fire({checked:e}))}async run(e,t){this._actionCallback&&await this._actionCallback(e)}},ko=class extends F{_onWillRun=this._register(new D);onWillRun=this._onWillRun.event;_onDidRun=this._register(new D);onDidRun=this._onDidRun.event;async run(e,t){if(!e.enabled)return;this._onWillRun.fire({action:e});let n;try{await this.runAction(e,t)}catch(i){n=i}this._onDidRun.fire({action:e,error:n})}async runAction(e,t){await e.run(t)}},Zn=class o{static join(...e){let t=[];for(let n of e)n.length&&(t.length?t=[...t,new o,...n]:t=n);return t}static ID="vs.actions.separator";id=o.ID;label="";tooltip="";class="separator";enabled=!1;checked=!1;async run(){}},fl=class{id;label;class;tooltip="";enabled=!0;checked=void 0;_actions;get actions(){return this._actions}constructor(e,t,n,i){this.id=e,this.label=t,this.class=i,this._actions=n}async run(){}};function xi(o){return{id:o.id,label:o.label,tooltip:o.tooltip??o.label,class:o.class,enabled:o.enabled??!0,checked:o.checked,run:async(...e)=>o.run(...e)}}function In(o){return typeof o=="string"}function an(o){return typeof o=="object"&&o!==null&&!Array.isArray(o)&&!(o instanceof RegExp)&&!(o instanceof Date)}function Gi(o){return typeof o=="number"&&!isNaN(o)}function iL(o){return!!o&&typeof o[Symbol.iterator]=="function"}function nI(o){return o===!0||o===!1}function Kn(o){return typeof o>"u"}function bl(o){return!gn(o)}function gn(o){return Kn(o)||o===null}function Gp(o,e){if(!o)throw new Error(e?`Unexpected type, expected '${e}'`:"Unexpected type")}function fn(o){if(gn(o))throw new Error("Assertion Failed: argument is undefined or null");return o}var $z=Object.prototype.hasOwnProperty;function qc(o){if(!an(o))return!1;for(let e in o)if($z.call(o,e))return!1;return!0}function $c(o){return typeof o=="function"}function PA(o,e){let t=Math.min(o.length,e.length);for(let n=0;n<t;n++)Yz(o[n],e[n])}function Yz(o,e){if(In(e)){if(typeof o!==e)throw new Error(`argument does not match constraint: typeof ${e}`)}else if($c(e)){try{if(o instanceof e)return}catch{}if(!gn(o)&&o.constructor===e||e.length===1&&e.call(void 0,o)===!0)return;throw new Error("argument does not match one of these constraints: arg instanceof constraint, arg.constructor === constraint, nor constraint(arg) === true")}}var oL=Object.create(null);function I(o,e){if(In(e)){let t=oL[e];if(t===void 0)throw new Error(`${o} references an unknown codicon: ${e}`);e=t}return oL[o]=e,{id:o}}function rL(){return oL}var OA={add:I("add",6e4),plus:I("plus",6e4),gistNew:I("gist-new",6e4),repoCreate:I("repo-create",6e4),lightbulb:I("lightbulb",60001),lightBulb:I("light-bulb",60001),repo:I("repo",60002),repoDelete:I("repo-delete",60002),gistFork:I("gist-fork",60003),repoForked:I("repo-forked",60003),gitPullRequest:I("git-pull-request",60004),gitPullRequestAbandoned:I("git-pull-request-abandoned",60004),recordKeys:I("record-keys",60005),keyboard:I("keyboard",60005),tag:I("tag",60006),gitPullRequestLabel:I("git-pull-request-label",60006),tagAdd:I("tag-add",60006),tagRemove:I("tag-remove",60006),person:I("person",60007),personFollow:I("person-follow",60007),personOutline:I("person-outline",60007),personFilled:I("person-filled",60007),gitBranch:I("git-branch",60008),gitBranchCreate:I("git-branch-create",60008),gitBranchDelete:I("git-branch-delete",60008),sourceControl:I("source-control",60008),mirror:I("mirror",60009),mirrorPublic:I("mirror-public",60009),star:I("star",60010),starAdd:I("star-add",60010),starDelete:I("star-delete",60010),starEmpty:I("star-empty",60010),comment:I("comment",60011),commentAdd:I("comment-add",60011),alert:I("alert",60012),warning:I("warning",60012),search:I("search",60013),searchSave:I("search-save",60013),logOut:I("log-out",60014),signOut:I("sign-out",60014),logIn:I("log-in",60015),signIn:I("sign-in",60015),eye:I("eye",60016),eyeUnwatch:I("eye-unwatch",60016),eyeWatch:I("eye-watch",60016),circleFilled:I("circle-filled",60017),primitiveDot:I("primitive-dot",60017),closeDirty:I("close-dirty",60017),debugBreakpoint:I("debug-breakpoint",60017),debugBreakpointDisabled:I("debug-breakpoint-disabled",60017),debugHint:I("debug-hint",60017),terminalDecorationSuccess:I("terminal-decoration-success",60017),primitiveSquare:I("primitive-square",60018),edit:I("edit",60019),pencil:I("pencil",60019),info:I("info",60020),issueOpened:I("issue-opened",60020),gistPrivate:I("gist-private",60021),gitForkPrivate:I("git-fork-private",60021),lock:I("lock",60021),mirrorPrivate:I("mirror-private",60021),close:I("close",60022),removeClose:I("remove-close",60022),x:I("x",60022),repoSync:I("repo-sync",60023),sync:I("sync",60023),clone:I("clone",60024),desktopDownload:I("desktop-download",60024),beaker:I("beaker",60025),microscope:I("microscope",60025),vm:I("vm",60026),deviceDesktop:I("device-desktop",60026),file:I("file",60027),fileText:I("file-text",60027),more:I("more",60028),ellipsis:I("ellipsis",60028),kebabHorizontal:I("kebab-horizontal",60028),mailReply:I("mail-reply",60029),reply:I("reply",60029),organization:I("organization",60030),organizationFilled:I("organization-filled",60030),organizationOutline:I("organization-outline",60030),newFile:I("new-file",60031),fileAdd:I("file-add",60031),newFolder:I("new-folder",60032),fileDirectoryCreate:I("file-directory-create",60032),trash:I("trash",60033),trashcan:I("trashcan",60033),history:I("history",60034),clock:I("clock",60034),folder:I("folder",60035),fileDirectory:I("file-directory",60035),symbolFolder:I("symbol-folder",60035),logoGithub:I("logo-github",60036),markGithub:I("mark-github",60036),github:I("github",60036),terminal:I("terminal",60037),console:I("console",60037),repl:I("repl",60037),zap:I("zap",60038),symbolEvent:I("symbol-event",60038),error:I("error",60039),stop:I("stop",60039),variable:I("variable",60040),symbolVariable:I("symbol-variable",60040),array:I("array",60042),symbolArray:I("symbol-array",60042),symbolModule:I("symbol-module",60043),symbolPackage:I("symbol-package",60043),symbolNamespace:I("symbol-namespace",60043),symbolObject:I("symbol-object",60043),symbolMethod:I("symbol-method",60044),symbolFunction:I("symbol-function",60044),symbolConstructor:I("symbol-constructor",60044),symbolBoolean:I("symbol-boolean",60047),symbolNull:I("symbol-null",60047),symbolNumeric:I("symbol-numeric",60048),symbolNumber:I("symbol-number",60048),symbolStructure:I("symbol-structure",60049),symbolStruct:I("symbol-struct",60049),symbolParameter:I("symbol-parameter",60050),symbolTypeParameter:I("symbol-type-parameter",60050),symbolKey:I("symbol-key",60051),symbolText:I("symbol-text",60051),symbolReference:I("symbol-reference",60052),goToFile:I("go-to-file",60052),symbolEnum:I("symbol-enum",60053),symbolValue:I("symbol-value",60053),symbolRuler:I("symbol-ruler",60054),symbolUnit:I("symbol-unit",60054),activateBreakpoints:I("activate-breakpoints",60055),archive:I("archive",60056),arrowBoth:I("arrow-both",60057),arrowDown:I("arrow-down",60058),arrowLeft:I("arrow-left",60059),arrowRight:I("arrow-right",60060),arrowSmallDown:I("arrow-small-down",60061),arrowSmallLeft:I("arrow-small-left",60062),arrowSmallRight:I("arrow-small-right",60063),arrowSmallUp:I("arrow-small-up",60064),arrowUp:I("arrow-up",60065),bell:I("bell",60066),bold:I("bold",60067),book:I("book",60068),bookmark:I("bookmark",60069),debugBreakpointConditionalUnverified:I("debug-breakpoint-conditional-unverified",60070),debugBreakpointConditional:I("debug-breakpoint-conditional",60071),debugBreakpointConditionalDisabled:I("debug-breakpoint-conditional-disabled",60071),debugBreakpointDataUnverified:I("debug-breakpoint-data-unverified",60072),debugBreakpointData:I("debug-breakpoint-data",60073),debugBreakpointDataDisabled:I("debug-breakpoint-data-disabled",60073),debugBreakpointLogUnverified:I("debug-breakpoint-log-unverified",60074),debugBreakpointLog:I("debug-breakpoint-log",60075),debugBreakpointLogDisabled:I("debug-breakpoint-log-disabled",60075),briefcase:I("briefcase",60076),broadcast:I("broadcast",60077),browser:I("browser",60078),bug:I("bug",60079),calendar:I("calendar",60080),caseSensitive:I("case-sensitive",60081),check:I("check",60082),checklist:I("checklist",60083),chevronDown:I("chevron-down",60084),chevronLeft:I("chevron-left",60085),chevronRight:I("chevron-right",60086),chevronUp:I("chevron-up",60087),chromeClose:I("chrome-close",60088),chromeMaximize:I("chrome-maximize",60089),chromeMinimize:I("chrome-minimize",60090),chromeRestore:I("chrome-restore",60091),circleOutline:I("circle-outline",60092),circle:I("circle",60092),debugBreakpointUnverified:I("debug-breakpoint-unverified",60092),terminalDecorationIncomplete:I("terminal-decoration-incomplete",60092),circleSlash:I("circle-slash",60093),circuitBoard:I("circuit-board",60094),clearAll:I("clear-all",60095),clippy:I("clippy",60096),closeAll:I("close-all",60097),cloudDownload:I("cloud-download",60098),cloudUpload:I("cloud-upload",60099),code:I("code",60100),collapseAll:I("collapse-all",60101),colorMode:I("color-mode",60102),commentDiscussion:I("comment-discussion",60103),creditCard:I("credit-card",60105),dash:I("dash",60108),dashboard:I("dashboard",60109),database:I("database",60110),debugContinue:I("debug-continue",60111),debugDisconnect:I("debug-disconnect",60112),debugPause:I("debug-pause",60113),debugRestart:I("debug-restart",60114),debugStart:I("debug-start",60115),debugStepInto:I("debug-step-into",60116),debugStepOut:I("debug-step-out",60117),debugStepOver:I("debug-step-over",60118),debugStop:I("debug-stop",60119),debug:I("debug",60120),deviceCameraVideo:I("device-camera-video",60121),deviceCamera:I("device-camera",60122),deviceMobile:I("device-mobile",60123),diffAdded:I("diff-added",60124),diffIgnored:I("diff-ignored",60125),diffModified:I("diff-modified",60126),diffRemoved:I("diff-removed",60127),diffRenamed:I("diff-renamed",60128),diff:I("diff",60129),diffSidebyside:I("diff-sidebyside",60129),discard:I("discard",60130),editorLayout:I("editor-layout",60131),emptyWindow:I("empty-window",60132),exclude:I("exclude",60133),extensions:I("extensions",60134),eyeClosed:I("eye-closed",60135),fileBinary:I("file-binary",60136),fileCode:I("file-code",60137),fileMedia:I("file-media",60138),filePdf:I("file-pdf",60139),fileSubmodule:I("file-submodule",60140),fileSymlinkDirectory:I("file-symlink-directory",60141),fileSymlinkFile:I("file-symlink-file",60142),fileZip:I("file-zip",60143),files:I("files",60144),filter:I("filter",60145),flame:I("flame",60146),foldDown:I("fold-down",60147),foldUp:I("fold-up",60148),fold:I("fold",60149),folderActive:I("folder-active",60150),folderOpened:I("folder-opened",60151),gear:I("gear",60152),gift:I("gift",60153),gistSecret:I("gist-secret",60154),gist:I("gist",60155),gitCommit:I("git-commit",60156),gitCompare:I("git-compare",60157),compareChanges:I("compare-changes",60157),gitMerge:I("git-merge",60158),githubAction:I("github-action",60159),githubAlt:I("github-alt",60160),globe:I("globe",60161),grabber:I("grabber",60162),graph:I("graph",60163),gripper:I("gripper",60164),heart:I("heart",60165),home:I("home",60166),horizontalRule:I("horizontal-rule",60167),hubot:I("hubot",60168),inbox:I("inbox",60169),issueReopened:I("issue-reopened",60171),issues:I("issues",60172),italic:I("italic",60173),jersey:I("jersey",60174),json:I("json",60175),kebabVertical:I("kebab-vertical",60176),key:I("key",60177),law:I("law",60178),lightbulbAutofix:I("lightbulb-autofix",60179),linkExternal:I("link-external",60180),link:I("link",60181),listOrdered:I("list-ordered",60182),listUnordered:I("list-unordered",60183),liveShare:I("live-share",60184),loading:I("loading",60185),location:I("location",60186),mailRead:I("mail-read",60187),mail:I("mail",60188),markdown:I("markdown",60189),megaphone:I("megaphone",60190),mention:I("mention",60191),milestone:I("milestone",60192),gitPullRequestMilestone:I("git-pull-request-milestone",60192),mortarBoard:I("mortar-board",60193),move:I("move",60194),multipleWindows:I("multiple-windows",60195),mute:I("mute",60196),noNewline:I("no-newline",60197),note:I("note",60198),octoface:I("octoface",60199),openPreview:I("open-preview",60200),package:I("package",60201),paintcan:I("paintcan",60202),pin:I("pin",60203),play:I("play",60204),run:I("run",60204),plug:I("plug",60205),preserveCase:I("preserve-case",60206),preview:I("preview",60207),project:I("project",60208),pulse:I("pulse",60209),question:I("question",60210),quote:I("quote",60211),radioTower:I("radio-tower",60212),reactions:I("reactions",60213),references:I("references",60214),refresh:I("refresh",60215),regex:I("regex",60216),remoteExplorer:I("remote-explorer",60217),remote:I("remote",60218),remove:I("remove",60219),replaceAll:I("replace-all",60220),replace:I("replace",60221),repoClone:I("repo-clone",60222),repoForcePush:I("repo-force-push",60223),repoPull:I("repo-pull",60224),repoPush:I("repo-push",60225),report:I("report",60226),requestChanges:I("request-changes",60227),rocket:I("rocket",60228),rootFolderOpened:I("root-folder-opened",60229),rootFolder:I("root-folder",60230),rss:I("rss",60231),ruby:I("ruby",60232),saveAll:I("save-all",60233),saveAs:I("save-as",60234),save:I("save",60235),screenFull:I("screen-full",60236),screenNormal:I("screen-normal",60237),searchStop:I("search-stop",60238),server:I("server",60240),settingsGear:I("settings-gear",60241),settings:I("settings",60242),shield:I("shield",60243),smiley:I("smiley",60244),sortPrecedence:I("sort-precedence",60245),splitHorizontal:I("split-horizontal",60246),splitVertical:I("split-vertical",60247),squirrel:I("squirrel",60248),starFull:I("star-full",60249),starHalf:I("star-half",60250),symbolClass:I("symbol-class",60251),symbolColor:I("symbol-color",60252),symbolConstant:I("symbol-constant",60253),symbolEnumMember:I("symbol-enum-member",60254),symbolField:I("symbol-field",60255),symbolFile:I("symbol-file",60256),symbolInterface:I("symbol-interface",60257),symbolKeyword:I("symbol-keyword",60258),symbolMisc:I("symbol-misc",60259),symbolOperator:I("symbol-operator",60260),symbolProperty:I("symbol-property",60261),wrench:I("wrench",60261),wrenchSubaction:I("wrench-subaction",60261),symbolSnippet:I("symbol-snippet",60262),tasklist:I("tasklist",60263),telescope:I("telescope",60264),textSize:I("text-size",60265),threeBars:I("three-bars",60266),thumbsdown:I("thumbsdown",60267),thumbsup:I("thumbsup",60268),tools:I("tools",60269),triangleDown:I("triangle-down",60270),triangleLeft:I("triangle-left",60271),triangleRight:I("triangle-right",60272),triangleUp:I("triangle-up",60273),twitter:I("twitter",60274),unfold:I("unfold",60275),unlock:I("unlock",60276),unmute:I("unmute",60277),unverified:I("unverified",60278),verified:I("verified",60279),versions:I("versions",60280),vmActive:I("vm-active",60281),vmOutline:I("vm-outline",60282),vmRunning:I("vm-running",60283),watch:I("watch",60284),whitespace:I("whitespace",60285),wholeWord:I("whole-word",60286),window:I("window",60287),wordWrap:I("word-wrap",60288),zoomIn:I("zoom-in",60289),zoomOut:I("zoom-out",60290),listFilter:I("list-filter",60291),listFlat:I("list-flat",60292),listSelection:I("list-selection",60293),selection:I("selection",60293),listTree:I("list-tree",60294),debugBreakpointFunctionUnverified:I("debug-breakpoint-function-unverified",60295),debugBreakpointFunction:I("debug-breakpoint-function",60296),debugBreakpointFunctionDisabled:I("debug-breakpoint-function-disabled",60296),debugStackframeActive:I("debug-stackframe-active",60297),circleSmallFilled:I("circle-small-filled",60298),debugStackframeDot:I("debug-stackframe-dot",60298),terminalDecorationMark:I("terminal-decoration-mark",60298),debugStackframe:I("debug-stackframe",60299),debugStackframeFocused:I("debug-stackframe-focused",60299),debugBreakpointUnsupported:I("debug-breakpoint-unsupported",60300),symbolString:I("symbol-string",60301),debugReverseContinue:I("debug-reverse-continue",60302),debugStepBack:I("debug-step-back",60303),debugRestartFrame:I("debug-restart-frame",60304),debugAlt:I("debug-alt",60305),callIncoming:I("call-incoming",60306),callOutgoing:I("call-outgoing",60307),menu:I("menu",60308),expandAll:I("expand-all",60309),feedback:I("feedback",60310),gitPullRequestReviewer:I("git-pull-request-reviewer",60310),groupByRefType:I("group-by-ref-type",60311),ungroupByRefType:I("ungroup-by-ref-type",60312),account:I("account",60313),gitPullRequestAssignee:I("git-pull-request-assignee",60313),bellDot:I("bell-dot",60314),debugConsole:I("debug-console",60315),library:I("library",60316),output:I("output",60317),runAll:I("run-all",60318),syncIgnored:I("sync-ignored",60319),pinned:I("pinned",60320),githubInverted:I("github-inverted",60321),serverProcess:I("server-process",60322),serverEnvironment:I("server-environment",60323),pass:I("pass",60324),issueClosed:I("issue-closed",60324),stopCircle:I("stop-circle",60325),playCircle:I("play-circle",60326),record:I("record",60327),debugAltSmall:I("debug-alt-small",60328),vmConnect:I("vm-connect",60329),cloud:I("cloud",60330),merge:I("merge",60331),export:I("export",60332),graphLeft:I("graph-left",60333),magnet:I("magnet",60334),notebook:I("notebook",60335),redo:I("redo",60336),checkAll:I("check-all",60337),pinnedDirty:I("pinned-dirty",60338),passFilled:I("pass-filled",60339),circleLargeFilled:I("circle-large-filled",60340),circleLarge:I("circle-large",60341),circleLargeOutline:I("circle-large-outline",60341),combine:I("combine",60342),gather:I("gather",60342),table:I("table",60343),variableGroup:I("variable-group",60344),typeHierarchy:I("type-hierarchy",60345),typeHierarchySub:I("type-hierarchy-sub",60346),typeHierarchySuper:I("type-hierarchy-super",60347),gitPullRequestCreate:I("git-pull-request-create",60348),runAbove:I("run-above",60349),runBelow:I("run-below",60350),notebookTemplate:I("notebook-template",60351),debugRerun:I("debug-rerun",60352),workspaceTrusted:I("workspace-trusted",60353),workspaceUntrusted:I("workspace-untrusted",60354),workspaceUnknown:I("workspace-unknown",60355),terminalCmd:I("terminal-cmd",60356),terminalDebian:I("terminal-debian",60357),terminalLinux:I("terminal-linux",60358),terminalPowershell:I("terminal-powershell",60359),terminalTmux:I("terminal-tmux",60360),terminalUbuntu:I("terminal-ubuntu",60361),terminalBash:I("terminal-bash",60362),arrowSwap:I("arrow-swap",60363),copy:I("copy",60364),personAdd:I("person-add",60365),filterFilled:I("filter-filled",60366),wand:I("wand",60367),debugLineByLine:I("debug-line-by-line",60368),inspect:I("inspect",60369),layers:I("layers",60370),layersDot:I("layers-dot",60371),layersActive:I("layers-active",60372),compass:I("compass",60373),compassDot:I("compass-dot",60374),compassActive:I("compass-active",60375),azure:I("azure",60376),issueDraft:I("issue-draft",60377),gitPullRequestClosed:I("git-pull-request-closed",60378),gitPullRequestDraft:I("git-pull-request-draft",60379),debugAll:I("debug-all",60380),debugCoverage:I("debug-coverage",60381),runErrors:I("run-errors",60382),folderLibrary:I("folder-library",60383),debugContinueSmall:I("debug-continue-small",60384),beakerStop:I("beaker-stop",60385),graphLine:I("graph-line",60386),graphScatter:I("graph-scatter",60387),pieChart:I("pie-chart",60388),bracket:I("bracket",60175),bracketDot:I("bracket-dot",60389),bracketError:I("bracket-error",60390),lockSmall:I("lock-small",60391),azureDevops:I("azure-devops",60392),verifiedFilled:I("verified-filled",60393),newline:I("newline",60394),layout:I("layout",60395),layoutActivitybarLeft:I("layout-activitybar-left",60396),layoutActivitybarRight:I("layout-activitybar-right",60397),layoutPanelLeft:I("layout-panel-left",60398),layoutPanelCenter:I("layout-panel-center",60399),layoutPanelJustify:I("layout-panel-justify",60400),layoutPanelRight:I("layout-panel-right",60401),layoutPanel:I("layout-panel",60402),layoutSidebarLeft:I("layout-sidebar-left",60403),layoutSidebarRight:I("layout-sidebar-right",60404),layoutStatusbar:I("layout-statusbar",60405),layoutMenubar:I("layout-menubar",60406),layoutCentered:I("layout-centered",60407),target:I("target",60408),indent:I("indent",60409),recordSmall:I("record-small",60410),errorSmall:I("error-small",60411),terminalDecorationError:I("terminal-decoration-error",60411),arrowCircleDown:I("arrow-circle-down",60412),arrowCircleLeft:I("arrow-circle-left",60413),arrowCircleRight:I("arrow-circle-right",60414),arrowCircleUp:I("arrow-circle-up",60415),layoutSidebarRightOff:I("layout-sidebar-right-off",60416),layoutPanelOff:I("layout-panel-off",60417),layoutSidebarLeftOff:I("layout-sidebar-left-off",60418),blank:I("blank",60419),heartFilled:I("heart-filled",60420),map:I("map",60421),mapHorizontal:I("map-horizontal",60421),foldHorizontal:I("fold-horizontal",60421),mapFilled:I("map-filled",60422),mapHorizontalFilled:I("map-horizontal-filled",60422),foldHorizontalFilled:I("fold-horizontal-filled",60422),circleSmall:I("circle-small",60423),bellSlash:I("bell-slash",60424),bellSlashDot:I("bell-slash-dot",60425),commentUnresolved:I("comment-unresolved",60426),gitPullRequestGoToChanges:I("git-pull-request-go-to-changes",60427),gitPullRequestNewChanges:I("git-pull-request-new-changes",60428),searchFuzzy:I("search-fuzzy",60429),commentDraft:I("comment-draft",60430),send:I("send",60431),sparkle:I("sparkle",60432),insert:I("insert",60433),mic:I("mic",60434),thumbsdownFilled:I("thumbsdown-filled",60435),thumbsupFilled:I("thumbsup-filled",60436),coffee:I("coffee",60437),snake:I("snake",60438),game:I("game",60439),vr:I("vr",60440),chip:I("chip",60441),piano:I("piano",60442),music:I("music",60443),micFilled:I("mic-filled",60444),repoFetch:I("repo-fetch",60445),copilot:I("copilot",60446),lightbulbSparkle:I("lightbulb-sparkle",60447),robot:I("robot",60448),sparkleFilled:I("sparkle-filled",60449),diffSingle:I("diff-single",60450),diffMultiple:I("diff-multiple",60451),surroundWith:I("surround-with",60452),share:I("share",60453),gitStash:I("git-stash",60454),gitStashApply:I("git-stash-apply",60455),gitStashPop:I("git-stash-pop",60456),vscode:I("vscode",60457),vscodeInsiders:I("vscode-insiders",60458),codeOss:I("code-oss",60459),runCoverage:I("run-coverage",60460),runAllCoverage:I("run-all-coverage",60461),coverage:I("coverage",60462),githubProject:I("github-project",60463),mapVertical:I("map-vertical",60464),foldVertical:I("fold-vertical",60464),mapVerticalFilled:I("map-vertical-filled",60465),foldVerticalFilled:I("fold-vertical-filled",60465),goToSearch:I("go-to-search",60466),percentage:I("percentage",60467),sortPercentage:I("sort-percentage",60467),attach:I("attach",60468)};var Zz={dialogError:I("dialog-error","error"),dialogWarning:I("dialog-warning","warning"),dialogInfo:I("dialog-info","info"),dialogClose:I("dialog-close","close"),treeItemExpanded:I("tree-item-expanded","chevron-down"),treeFilterOnTypeOn:I("tree-filter-on-type-on","list-filter"),treeFilterOnTypeOff:I("tree-filter-on-type-off","list-selection"),treeFilterClear:I("tree-filter-clear","close"),treeItemLoading:I("tree-item-loading","loading"),menuSelection:I("menu-selection","check"),menuSubmenu:I("menu-submenu","chevron-right"),menuBarMore:I("menubar-more","more"),scrollbarButtonLeft:I("scrollbar-button-left","triangle-left"),scrollbarButtonRight:I("scrollbar-button-right","triangle-right"),scrollbarButtonUp:I("scrollbar-button-up","triangle-up"),scrollbarButtonDown:I("scrollbar-button-down","triangle-down"),toolBarMore:I("toolbar-more","more"),quickInputBack:I("quick-input-back","arrow-left"),dropDownButton:I("drop-down-button",60084),symbolCustomColor:I("symbol-customcolor",60252),exportIcon:I("export",60332),workspaceUnspecified:I("workspace-unspecified",60355),newLine:I("newline",60394),thumbsDownFilled:I("thumbsdown-filled",60435),thumbsUpFilled:I("thumbsup-filled",60436),gitFetch:I("git-fetch",60445),lightbulbSparkleAutofix:I("lightbulb-sparkle-autofix",60447),debugBreakpointPending:I("debug-breakpoint-pending",60377)},te={...OA,...Zz};var NA;(e=>{function o(t){return t&&typeof t=="object"&&typeof t.id=="string"}e.isThemeColor=o})(NA||={});var we;(g=>{g.iconNameSegment="[A-Za-z0-9]+",g.iconNameExpression="[A-Za-z0-9-]+",g.iconModifierExpression="~[A-Za-z]+",g.iconNameCharacter="[A-Za-z0-9~-]";let i=new RegExp(`^(${g.iconNameExpression})(${g.iconModifierExpression})?$`);function r(b){let v=i.exec(b.id);if(!v)return r(te.error);let[,y,S]=v,E=["codicon","codicon-"+y];return S&&E.push("codicon-modifier-"+S.substring(1)),E}g.asClassNameArray=r;function s(b){return r(b).join(" ")}g.asClassName=s;function a(b){return"."+r(b).join(".")}g.asCSSSelector=a;function l(b){return b&&typeof b=="object"&&typeof b.id=="string"&&(typeof b.color>"u"||NA.isThemeColor(b.color))}g.isThemeIcon=l;let d=new RegExp(`^\\$\\((${g.iconNameExpression}(?:${g.iconModifierExpression})?)\\)$`);function c(b){let v=d.exec(b);if(!v)return;let[,y]=v;return{id:y}}g.fromString=c;function u(b){return{id:b}}g.fromId=u;function p(b,v){let y=b.id,S=y.lastIndexOf("~");return S!==-1&&(y=y.substring(0,S)),v&&(y=`${y}~${v}`),{id:y}}g.modify=p;function h(b){let v=b.id.lastIndexOf("~");if(v!==-1)return b.id.substring(v+1)}g.getModifier=h;function f(b,v){return b.id===v.id&&b.color?.id===v.color?.id}g.isEqual=f})(we||={});var uf=class{ctor;staticArguments;supportsDelayedInstantiation;constructor(e,t=[],n=!1){this.ctor=e,this.staticArguments=t,this.supportsDelayedInstantiation=n}};var gd=class{_entries=new Map;constructor(...e){for(let[t,n]of e)this.set(t,n)}set(e,t){let n=this._entries.get(e);return this._entries.set(e,t),n}has(e){return this._entries.has(e)}get(e){return this._entries.get(e)}};var fd;(i=>{i.serviceIds=new Map,i.DI_TARGET="$di$target",i.DI_DEPENDENCIES="$di$dependencies";function n(r){return r[i.DI_DEPENDENCIES]||[]}i.getServiceDependencies=n})(fd||={});var Oe=Y("instantiationService");function Xz(o,e,t){e[fd.DI_TARGET]===e?e[fd.DI_DEPENDENCIES].push({id:o,index:t}):(e[fd.DI_DEPENDENCIES]=[{id:o,index:t}],e[fd.DI_TARGET]=e)}function Y(o){if(fd.serviceIds.has(o))return fd.serviceIds.get(o);let e=function(t,n,i){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");Xz(e,t,i)};return e.toString=()=>o,fd.serviceIds.set(o,e),e}var Xn=Y("telemetryService"),sQ=Y("customEndpointTelemetryService");function AA(o){return o}var iI=class{lastCache=void 0;lastArgKey=void 0;_fn;_computeKey;constructor(e,t){typeof e=="function"?(this._fn=e,this._computeKey=AA):(this._fn=t,this._computeKey=e.getCacheKey)}get(e){let t=this._computeKey(e);return this.lastArgKey!==t&&(this.lastArgKey=t,this.lastCache=this._fn(e)),this.lastCache}},bd=class{_map=new Map;_map2=new Map;get cachedValues(){return this._map}_fn;_computeKey;constructor(e,t){typeof e=="function"?(this._fn=e,this._computeKey=AA):(this._fn=t,this._computeKey=e.getCacheKey)}get(e){let t=this._computeKey(e);if(this._map2.has(t))return this._map2.get(t);let n=this._fn(e);return this._map.set(e,n),this._map2.set(t,n),n}};var Qn=class{constructor(e){this.executor=e}_didRun=!1;_value;_error;get hasValue(){return this._didRun}get value(){if(!this._didRun)try{this._value=this.executor()}catch(e){this._error=e}finally{this._didRun=!0}if(this._error)throw this._error;return this._value}get rawValue(){return this._value}};function Yc(o){return o<0?0:o>255?255:o|0}function BA(o){return!o||typeof o!="string"?!0:o.trim().length===0}function VA(o){return o.replace(/[<>"'&]/g,e=>{switch(e){case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"'":return"&apos;";case"&":return"&amp;"}return e})}function jp(o){return o.replace(/[<>&]/g,function(e){switch(e){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";default:return e}})}function ji(o){return o.replace(/[\\\{\}\*\+\?\|\^\$\.\[\]\(\)]/g,"\\$&")}function rI(o,e){if(!o||!e)return o;let t=e.length;if(t===0||o.length===0)return o;let n=0;for(;o.indexOf(e,n)===n;)n=n+t;return o.substring(n)}function WA(o){return o.replace(/\*/g,"")}function sI(o,e,t={}){if(!o)throw new Error("Cannot create regex from empty string");e||(o=ji(o)),t.wholeWord&&(/\B/.test(o.charAt(0))||(o="\\b"+o),/\B/.test(o.charAt(o.length-1))||(o=o+"\\b"));let n="";return t.global&&(n+="g"),t.matchCase||(n+="i"),t.multiline&&(n+="m"),t.unicode&&(n+="u"),new RegExp(o,n)}function pf(o){return o.split(/\r\n|\r|\n/)}function Cn(o){for(let e=0,t=o.length;e<t;e++){let n=o.charCodeAt(e);if(n!==32&&n!==9)return e}return-1}function Jn(o,e=0,t=o.length){for(let n=e;n<t;n++){let i=o.charCodeAt(n);if(i!==32&&i!==9)return o.substring(e,n)}return o.substring(e,t)}function Lr(o,e=o.length-1){for(let t=e;t>=0;t--){let n=o.charCodeAt(t);if(n!==32&&n!==9)return t}return-1}function lL(o,e){return o<e?-1:o>e?1:0}function HA(o,e,t=0,n=o.length,i=0,r=e.length){for(;t<n&&i<r;t++,i++){let l=o.charCodeAt(t),d=e.charCodeAt(i);if(l<d)return-1;if(l>d)return 1}let s=n-t,a=r-i;return s<a?-1:s>a?1:0}function dL(o,e){return aI(o,e,0,o.length,0,e.length)}function aI(o,e,t=0,n=o.length,i=0,r=e.length){for(;t<n&&i<r;t++,i++){let l=o.charCodeAt(t),d=e.charCodeAt(i);if(l===d)continue;if(l>=128||d>=128)return HA(o.toLowerCase(),e.toLowerCase(),t,n,i,r);Zc(l)&&(l-=32),Zc(d)&&(d-=32);let c=l-d;if(c!==0)return c}let s=n-t,a=r-i;return s<a?-1:s>a?1:0}function hf(o){return o>=48&&o<=57}function Zc(o){return o>=97&&o<=122}function ha(o){return o>=65&&o<=90}function tr(o,e){return o.length===e.length&&aI(o,e)===0}function yd(o,e){let t=e.length;return e.length>o.length?!1:aI(o,e,0,t)===0}function mf(o,e){let t=Math.min(o.length,e.length),n;for(n=0;n<t;n++)if(o.charCodeAt(n)!==e.charCodeAt(n))return n;return t}function gf(o,e){let t=Math.min(o.length,e.length),n,i=o.length-1,r=e.length-1;for(n=0;n<t;n++)if(o.charCodeAt(i-n)!==e.charCodeAt(r-n))return n;return t}function ln(o){return 55296<=o&&o<=56319}function Id(o){return 56320<=o&&o<=57343}function lI(o,e){return(o-55296<<10)+(e-56320)+65536}function qp(o,e,t){let n=o.charCodeAt(t);if(ln(n)&&t+1<e){let i=o.charCodeAt(t+1);if(Id(i))return lI(n,i)}return n}function Qz(o,e){let t=o.charCodeAt(e-1);if(Id(t)&&e>1){let n=o.charCodeAt(e-2);if(ln(n))return lI(n,t)}return t}var Xc=class{_str;_len;_offset;get offset(){return this._offset}constructor(e,t=0){this._str=e,this._len=e.length,this._offset=t}setOffset(e){this._offset=e}prevCodePoint(){let e=Qz(this._str,this._offset);return this._offset-=e>=65536?2:1,e}nextCodePoint(){let e=qp(this._str,this._len,this._offset);return this._offset+=e>=65536?2:1,e}eol(){return this._offset>=this._len}},Qc=class{_iterator;get offset(){return this._iterator.offset}constructor(e,t=0){this._iterator=new Xc(e,t)}nextGraphemeLength(){let e=oI.getInstance(),t=this._iterator,n=t.offset,i=e.getGraphemeBreakType(t.nextCodePoint());for(;!t.eol();){let r=t.offset,s=e.getGraphemeBreakType(t.nextCodePoint());if(FA(i,s)){t.setOffset(r);break}i=s}return t.offset-n}prevGraphemeLength(){let e=oI.getInstance(),t=this._iterator,n=t.offset,i=e.getGraphemeBreakType(t.prevCodePoint());for(;t.offset>0;){let r=t.offset,s=e.getGraphemeBreakType(t.prevCodePoint());if(FA(s,i)){t.setOffset(r);break}i=s}return n-t.offset}eol(){return this._iterator.eol()}};function ff(o,e){return new Qc(o,e).nextGraphemeLength()}function cL(o,e){return new Qc(o,e).prevGraphemeLength()}function dI(o,e){e>0&&Id(o.charCodeAt(e))&&e--;let t=e+ff(o,e);return[t-cL(o,t),t]}var sL;function Jz(){return/(?:[\u05BE\u05C0\u05C3\u05C6\u05D0-\u05F4\u0608\u060B\u060D\u061B-\u064A\u066D-\u066F\u0671-\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u0710\u0712-\u072F\u074D-\u07A5\u07B1-\u07EA\u07F4\u07F5\u07FA\u07FE-\u0815\u081A\u0824\u0828\u0830-\u0858\u085E-\u088E\u08A0-\u08C9\u200F\uFB1D\uFB1F-\uFB28\uFB2A-\uFD3D\uFD50-\uFDC7\uFDF0-\uFDFC\uFE70-\uFEFC]|\uD802[\uDC00-\uDD1B\uDD20-\uDE00\uDE10-\uDE35\uDE40-\uDEE4\uDEEB-\uDF35\uDF40-\uDFFF]|\uD803[\uDC00-\uDD23\uDE80-\uDEA9\uDEAD-\uDF45\uDF51-\uDF81\uDF86-\uDFF6]|\uD83A[\uDC00-\uDCCF\uDD00-\uDD43\uDD4B-\uDFFF]|\uD83B[\uDC00-\uDEBB])/}function yl(o){return sL||(sL=Jz()),sL.test(o)}var e7=/^[\t\n\r\x20-\x7E]*$/;function bf(o){return e7.test(o)}var uL=/[\u2028\u2029]/;function cI(o){return uL.test(o)}function Rr(o){return o>=11904&&o<=55215||o>=63744&&o<=64255||o>=65281&&o<=65374}function vf(o){return o>=127462&&o<=127487||o===8986||o===8987||o===9200||o===9203||o>=9728&&o<=10175||o===11088||o===11093||o>=127744&&o<=128591||o>=128640&&o<=128764||o>=128992&&o<=129008||o>=129280&&o<=129535||o>=129648&&o<=129782}var UA=String.fromCharCode(65279);function zA(o){return!!(o&&o.length>0&&o.charCodeAt(0)===65279)}function uI(o){let e=26;return o=o%(2*e),o<e?String.fromCharCode(97+o):String.fromCharCode(65+o-e)}function FA(o,e){return o===0?e!==5&&e!==7:o===2&&e===3?!1:o===4||o===2||o===3||e===4||e===2||e===3?!0:!(o===8&&(e===8||e===9||e===11||e===12)||(o===11||o===9)&&(e===9||e===10)||(o===12||o===10)&&e===10||e===5||e===13||e===7||o===1||o===13&&e===14||o===6&&e===6)}var oI=class o{static _INSTANCE=null;static getInstance(){return o._INSTANCE||(o._INSTANCE=new o),o._INSTANCE}_data;constructor(){this._data=t7()}getGraphemeBreakType(e){if(e<32)return e===10?3:e===13?2:4;if(e<127)return 0;let t=this._data,n=t.length/3,i=1;for(;i<=n;)if(e<t[3*i])i=2*i;else if(e>t[3*i+1])i=2*i+1;else return t[3*i+2];return 0}};function t7(){return JSON.parse("[0,0,0,51229,51255,12,44061,44087,12,127462,127487,6,7083,7085,5,47645,47671,12,54813,54839,12,128678,128678,14,3270,3270,5,9919,9923,14,45853,45879,12,49437,49463,12,53021,53047,12,71216,71218,7,128398,128399,14,129360,129374,14,2519,2519,5,4448,4519,9,9742,9742,14,12336,12336,14,44957,44983,12,46749,46775,12,48541,48567,12,50333,50359,12,52125,52151,12,53917,53943,12,69888,69890,5,73018,73018,5,127990,127990,14,128558,128559,14,128759,128760,14,129653,129655,14,2027,2035,5,2891,2892,7,3761,3761,5,6683,6683,5,8293,8293,4,9825,9826,14,9999,9999,14,43452,43453,5,44509,44535,12,45405,45431,12,46301,46327,12,47197,47223,12,48093,48119,12,48989,49015,12,49885,49911,12,50781,50807,12,51677,51703,12,52573,52599,12,53469,53495,12,54365,54391,12,65279,65279,4,70471,70472,7,72145,72147,7,119173,119179,5,127799,127818,14,128240,128244,14,128512,128512,14,128652,128652,14,128721,128722,14,129292,129292,14,129445,129450,14,129734,129743,14,1476,1477,5,2366,2368,7,2750,2752,7,3076,3076,5,3415,3415,5,4141,4144,5,6109,6109,5,6964,6964,5,7394,7400,5,9197,9198,14,9770,9770,14,9877,9877,14,9968,9969,14,10084,10084,14,43052,43052,5,43713,43713,5,44285,44311,12,44733,44759,12,45181,45207,12,45629,45655,12,46077,46103,12,46525,46551,12,46973,46999,12,47421,47447,12,47869,47895,12,48317,48343,12,48765,48791,12,49213,49239,12,49661,49687,12,50109,50135,12,50557,50583,12,51005,51031,12,51453,51479,12,51901,51927,12,52349,52375,12,52797,52823,12,53245,53271,12,53693,53719,12,54141,54167,12,54589,54615,12,55037,55063,12,69506,69509,5,70191,70193,5,70841,70841,7,71463,71467,5,72330,72342,5,94031,94031,5,123628,123631,5,127763,127765,14,127941,127941,14,128043,128062,14,128302,128317,14,128465,128467,14,128539,128539,14,128640,128640,14,128662,128662,14,128703,128703,14,128745,128745,14,129004,129007,14,129329,129330,14,129402,129402,14,129483,129483,14,129686,129704,14,130048,131069,14,173,173,4,1757,1757,1,2200,2207,5,2434,2435,7,2631,2632,5,2817,2817,5,3008,3008,5,3201,3201,5,3387,3388,5,3542,3542,5,3902,3903,7,4190,4192,5,6002,6003,5,6439,6440,5,6765,6770,7,7019,7027,5,7154,7155,7,8205,8205,13,8505,8505,14,9654,9654,14,9757,9757,14,9792,9792,14,9852,9853,14,9890,9894,14,9937,9937,14,9981,9981,14,10035,10036,14,11035,11036,14,42654,42655,5,43346,43347,7,43587,43587,5,44006,44007,7,44173,44199,12,44397,44423,12,44621,44647,12,44845,44871,12,45069,45095,12,45293,45319,12,45517,45543,12,45741,45767,12,45965,45991,12,46189,46215,12,46413,46439,12,46637,46663,12,46861,46887,12,47085,47111,12,47309,47335,12,47533,47559,12,47757,47783,12,47981,48007,12,48205,48231,12,48429,48455,12,48653,48679,12,48877,48903,12,49101,49127,12,49325,49351,12,49549,49575,12,49773,49799,12,49997,50023,12,50221,50247,12,50445,50471,12,50669,50695,12,50893,50919,12,51117,51143,12,51341,51367,12,51565,51591,12,51789,51815,12,52013,52039,12,52237,52263,12,52461,52487,12,52685,52711,12,52909,52935,12,53133,53159,12,53357,53383,12,53581,53607,12,53805,53831,12,54029,54055,12,54253,54279,12,54477,54503,12,54701,54727,12,54925,54951,12,55149,55175,12,68101,68102,5,69762,69762,7,70067,70069,7,70371,70378,5,70720,70721,7,71087,71087,5,71341,71341,5,71995,71996,5,72249,72249,7,72850,72871,5,73109,73109,5,118576,118598,5,121505,121519,5,127245,127247,14,127568,127569,14,127777,127777,14,127872,127891,14,127956,127967,14,128015,128016,14,128110,128172,14,128259,128259,14,128367,128368,14,128424,128424,14,128488,128488,14,128530,128532,14,128550,128551,14,128566,128566,14,128647,128647,14,128656,128656,14,128667,128673,14,128691,128693,14,128715,128715,14,128728,128732,14,128752,128752,14,128765,128767,14,129096,129103,14,129311,129311,14,129344,129349,14,129394,129394,14,129413,129425,14,129466,129471,14,129511,129535,14,129664,129666,14,129719,129722,14,129760,129767,14,917536,917631,5,13,13,2,1160,1161,5,1564,1564,4,1807,1807,1,2085,2087,5,2307,2307,7,2382,2383,7,2497,2500,5,2563,2563,7,2677,2677,5,2763,2764,7,2879,2879,5,2914,2915,5,3021,3021,5,3142,3144,5,3263,3263,5,3285,3286,5,3398,3400,7,3530,3530,5,3633,3633,5,3864,3865,5,3974,3975,5,4155,4156,7,4229,4230,5,5909,5909,7,6078,6085,7,6277,6278,5,6451,6456,7,6744,6750,5,6846,6846,5,6972,6972,5,7074,7077,5,7146,7148,7,7222,7223,5,7416,7417,5,8234,8238,4,8417,8417,5,9000,9000,14,9203,9203,14,9730,9731,14,9748,9749,14,9762,9763,14,9776,9783,14,9800,9811,14,9831,9831,14,9872,9873,14,9882,9882,14,9900,9903,14,9929,9933,14,9941,9960,14,9974,9974,14,9989,9989,14,10006,10006,14,10062,10062,14,10160,10160,14,11647,11647,5,12953,12953,14,43019,43019,5,43232,43249,5,43443,43443,5,43567,43568,7,43696,43696,5,43765,43765,7,44013,44013,5,44117,44143,12,44229,44255,12,44341,44367,12,44453,44479,12,44565,44591,12,44677,44703,12,44789,44815,12,44901,44927,12,45013,45039,12,45125,45151,12,45237,45263,12,45349,45375,12,45461,45487,12,45573,45599,12,45685,45711,12,45797,45823,12,45909,45935,12,46021,46047,12,46133,46159,12,46245,46271,12,46357,46383,12,46469,46495,12,46581,46607,12,46693,46719,12,46805,46831,12,46917,46943,12,47029,47055,12,47141,47167,12,47253,47279,12,47365,47391,12,47477,47503,12,47589,47615,12,47701,47727,12,47813,47839,12,47925,47951,12,48037,48063,12,48149,48175,12,48261,48287,12,48373,48399,12,48485,48511,12,48597,48623,12,48709,48735,12,48821,48847,12,48933,48959,12,49045,49071,12,49157,49183,12,49269,49295,12,49381,49407,12,49493,49519,12,49605,49631,12,49717,49743,12,49829,49855,12,49941,49967,12,50053,50079,12,50165,50191,12,50277,50303,12,50389,50415,12,50501,50527,12,50613,50639,12,50725,50751,12,50837,50863,12,50949,50975,12,51061,51087,12,51173,51199,12,51285,51311,12,51397,51423,12,51509,51535,12,51621,51647,12,51733,51759,12,51845,51871,12,51957,51983,12,52069,52095,12,52181,52207,12,52293,52319,12,52405,52431,12,52517,52543,12,52629,52655,12,52741,52767,12,52853,52879,12,52965,52991,12,53077,53103,12,53189,53215,12,53301,53327,12,53413,53439,12,53525,53551,12,53637,53663,12,53749,53775,12,53861,53887,12,53973,53999,12,54085,54111,12,54197,54223,12,54309,54335,12,54421,54447,12,54533,54559,12,54645,54671,12,54757,54783,12,54869,54895,12,54981,55007,12,55093,55119,12,55243,55291,10,66045,66045,5,68325,68326,5,69688,69702,5,69817,69818,5,69957,69958,7,70089,70092,5,70198,70199,5,70462,70462,5,70502,70508,5,70750,70750,5,70846,70846,7,71100,71101,5,71230,71230,7,71351,71351,5,71737,71738,5,72000,72000,7,72160,72160,5,72273,72278,5,72752,72758,5,72882,72883,5,73031,73031,5,73461,73462,7,94192,94193,7,119149,119149,7,121403,121452,5,122915,122916,5,126980,126980,14,127358,127359,14,127535,127535,14,127759,127759,14,127771,127771,14,127792,127793,14,127825,127867,14,127897,127899,14,127945,127945,14,127985,127986,14,128000,128007,14,128021,128021,14,128066,128100,14,128184,128235,14,128249,128252,14,128266,128276,14,128335,128335,14,128379,128390,14,128407,128419,14,128444,128444,14,128481,128481,14,128499,128499,14,128526,128526,14,128536,128536,14,128543,128543,14,128556,128556,14,128564,128564,14,128577,128580,14,128643,128645,14,128649,128649,14,128654,128654,14,128660,128660,14,128664,128664,14,128675,128675,14,128686,128689,14,128695,128696,14,128705,128709,14,128717,128719,14,128725,128725,14,128736,128741,14,128747,128748,14,128755,128755,14,128762,128762,14,128981,128991,14,129009,129023,14,129160,129167,14,129296,129304,14,129320,129327,14,129340,129342,14,129356,129356,14,129388,129392,14,129399,129400,14,129404,129407,14,129432,129442,14,129454,129455,14,129473,129474,14,129485,129487,14,129648,129651,14,129659,129660,14,129671,129679,14,129709,129711,14,129728,129730,14,129751,129753,14,129776,129782,14,917505,917505,4,917760,917999,5,10,10,3,127,159,4,768,879,5,1471,1471,5,1536,1541,1,1648,1648,5,1767,1768,5,1840,1866,5,2070,2073,5,2137,2139,5,2274,2274,1,2363,2363,7,2377,2380,7,2402,2403,5,2494,2494,5,2507,2508,7,2558,2558,5,2622,2624,7,2641,2641,5,2691,2691,7,2759,2760,5,2786,2787,5,2876,2876,5,2881,2884,5,2901,2902,5,3006,3006,5,3014,3016,7,3072,3072,5,3134,3136,5,3157,3158,5,3260,3260,5,3266,3266,5,3274,3275,7,3328,3329,5,3391,3392,7,3405,3405,5,3457,3457,5,3536,3537,7,3551,3551,5,3636,3642,5,3764,3772,5,3895,3895,5,3967,3967,7,3993,4028,5,4146,4151,5,4182,4183,7,4226,4226,5,4253,4253,5,4957,4959,5,5940,5940,7,6070,6070,7,6087,6088,7,6158,6158,4,6432,6434,5,6448,6449,7,6679,6680,5,6742,6742,5,6754,6754,5,6783,6783,5,6912,6915,5,6966,6970,5,6978,6978,5,7042,7042,7,7080,7081,5,7143,7143,7,7150,7150,7,7212,7219,5,7380,7392,5,7412,7412,5,8203,8203,4,8232,8232,4,8265,8265,14,8400,8412,5,8421,8432,5,8617,8618,14,9167,9167,14,9200,9200,14,9410,9410,14,9723,9726,14,9733,9733,14,9745,9745,14,9752,9752,14,9760,9760,14,9766,9766,14,9774,9774,14,9786,9786,14,9794,9794,14,9823,9823,14,9828,9828,14,9833,9850,14,9855,9855,14,9875,9875,14,9880,9880,14,9885,9887,14,9896,9897,14,9906,9916,14,9926,9927,14,9935,9935,14,9939,9939,14,9962,9962,14,9972,9972,14,9978,9978,14,9986,9986,14,9997,9997,14,10002,10002,14,10017,10017,14,10055,10055,14,10071,10071,14,10133,10135,14,10548,10549,14,11093,11093,14,12330,12333,5,12441,12442,5,42608,42610,5,43010,43010,5,43045,43046,5,43188,43203,7,43302,43309,5,43392,43394,5,43446,43449,5,43493,43493,5,43571,43572,7,43597,43597,7,43703,43704,5,43756,43757,5,44003,44004,7,44009,44010,7,44033,44059,12,44089,44115,12,44145,44171,12,44201,44227,12,44257,44283,12,44313,44339,12,44369,44395,12,44425,44451,12,44481,44507,12,44537,44563,12,44593,44619,12,44649,44675,12,44705,44731,12,44761,44787,12,44817,44843,12,44873,44899,12,44929,44955,12,44985,45011,12,45041,45067,12,45097,45123,12,45153,45179,12,45209,45235,12,45265,45291,12,45321,45347,12,45377,45403,12,45433,45459,12,45489,45515,12,45545,45571,12,45601,45627,12,45657,45683,12,45713,45739,12,45769,45795,12,45825,45851,12,45881,45907,12,45937,45963,12,45993,46019,12,46049,46075,12,46105,46131,12,46161,46187,12,46217,46243,12,46273,46299,12,46329,46355,12,46385,46411,12,46441,46467,12,46497,46523,12,46553,46579,12,46609,46635,12,46665,46691,12,46721,46747,12,46777,46803,12,46833,46859,12,46889,46915,12,46945,46971,12,47001,47027,12,47057,47083,12,47113,47139,12,47169,47195,12,47225,47251,12,47281,47307,12,47337,47363,12,47393,47419,12,47449,47475,12,47505,47531,12,47561,47587,12,47617,47643,12,47673,47699,12,47729,47755,12,47785,47811,12,47841,47867,12,47897,47923,12,47953,47979,12,48009,48035,12,48065,48091,12,48121,48147,12,48177,48203,12,48233,48259,12,48289,48315,12,48345,48371,12,48401,48427,12,48457,48483,12,48513,48539,12,48569,48595,12,48625,48651,12,48681,48707,12,48737,48763,12,48793,48819,12,48849,48875,12,48905,48931,12,48961,48987,12,49017,49043,12,49073,49099,12,49129,49155,12,49185,49211,12,49241,49267,12,49297,49323,12,49353,49379,12,49409,49435,12,49465,49491,12,49521,49547,12,49577,49603,12,49633,49659,12,49689,49715,12,49745,49771,12,49801,49827,12,49857,49883,12,49913,49939,12,49969,49995,12,50025,50051,12,50081,50107,12,50137,50163,12,50193,50219,12,50249,50275,12,50305,50331,12,50361,50387,12,50417,50443,12,50473,50499,12,50529,50555,12,50585,50611,12,50641,50667,12,50697,50723,12,50753,50779,12,50809,50835,12,50865,50891,12,50921,50947,12,50977,51003,12,51033,51059,12,51089,51115,12,51145,51171,12,51201,51227,12,51257,51283,12,51313,51339,12,51369,51395,12,51425,51451,12,51481,51507,12,51537,51563,12,51593,51619,12,51649,51675,12,51705,51731,12,51761,51787,12,51817,51843,12,51873,51899,12,51929,51955,12,51985,52011,12,52041,52067,12,52097,52123,12,52153,52179,12,52209,52235,12,52265,52291,12,52321,52347,12,52377,52403,12,52433,52459,12,52489,52515,12,52545,52571,12,52601,52627,12,52657,52683,12,52713,52739,12,52769,52795,12,52825,52851,12,52881,52907,12,52937,52963,12,52993,53019,12,53049,53075,12,53105,53131,12,53161,53187,12,53217,53243,12,53273,53299,12,53329,53355,12,53385,53411,12,53441,53467,12,53497,53523,12,53553,53579,12,53609,53635,12,53665,53691,12,53721,53747,12,53777,53803,12,53833,53859,12,53889,53915,12,53945,53971,12,54001,54027,12,54057,54083,12,54113,54139,12,54169,54195,12,54225,54251,12,54281,54307,12,54337,54363,12,54393,54419,12,54449,54475,12,54505,54531,12,54561,54587,12,54617,54643,12,54673,54699,12,54729,54755,12,54785,54811,12,54841,54867,12,54897,54923,12,54953,54979,12,55009,55035,12,55065,55091,12,55121,55147,12,55177,55203,12,65024,65039,5,65520,65528,4,66422,66426,5,68152,68154,5,69291,69292,5,69633,69633,5,69747,69748,5,69811,69814,5,69826,69826,5,69932,69932,7,70016,70017,5,70079,70080,7,70095,70095,5,70196,70196,5,70367,70367,5,70402,70403,7,70464,70464,5,70487,70487,5,70709,70711,7,70725,70725,7,70833,70834,7,70843,70844,7,70849,70849,7,71090,71093,5,71103,71104,5,71227,71228,7,71339,71339,5,71344,71349,5,71458,71461,5,71727,71735,5,71985,71989,7,71998,71998,5,72002,72002,7,72154,72155,5,72193,72202,5,72251,72254,5,72281,72283,5,72344,72345,5,72766,72766,7,72874,72880,5,72885,72886,5,73023,73029,5,73104,73105,5,73111,73111,5,92912,92916,5,94095,94098,5,113824,113827,4,119142,119142,7,119155,119162,4,119362,119364,5,121476,121476,5,122888,122904,5,123184,123190,5,125252,125258,5,127183,127183,14,127340,127343,14,127377,127386,14,127491,127503,14,127548,127551,14,127744,127756,14,127761,127761,14,127769,127769,14,127773,127774,14,127780,127788,14,127796,127797,14,127820,127823,14,127869,127869,14,127894,127895,14,127902,127903,14,127943,127943,14,127947,127950,14,127972,127972,14,127988,127988,14,127992,127994,14,128009,128011,14,128019,128019,14,128023,128041,14,128064,128064,14,128102,128107,14,128174,128181,14,128238,128238,14,128246,128247,14,128254,128254,14,128264,128264,14,128278,128299,14,128329,128330,14,128348,128359,14,128371,128377,14,128392,128393,14,128401,128404,14,128421,128421,14,128433,128434,14,128450,128452,14,128476,128478,14,128483,128483,14,128495,128495,14,128506,128506,14,128519,128520,14,128528,128528,14,128534,128534,14,128538,128538,14,128540,128542,14,128544,128549,14,128552,128555,14,128557,128557,14,128560,128563,14,128565,128565,14,128567,128576,14,128581,128591,14,128641,128642,14,128646,128646,14,128648,128648,14,128650,128651,14,128653,128653,14,128655,128655,14,128657,128659,14,128661,128661,14,128663,128663,14,128665,128666,14,128674,128674,14,128676,128677,14,128679,128685,14,128690,128690,14,128694,128694,14,128697,128702,14,128704,128704,14,128710,128714,14,128716,128716,14,128720,128720,14,128723,128724,14,128726,128727,14,128733,128735,14,128742,128744,14,128746,128746,14,128749,128751,14,128753,128754,14,128756,128758,14,128761,128761,14,128763,128764,14,128884,128895,14,128992,129003,14,129008,129008,14,129036,129039,14,129114,129119,14,129198,129279,14,129293,129295,14,129305,129310,14,129312,129319,14,129328,129328,14,129331,129338,14,129343,129343,14,129351,129355,14,129357,129359,14,129375,129387,14,129393,129393,14,129395,129398,14,129401,129401,14,129403,129403,14,129408,129412,14,129426,129431,14,129443,129444,14,129451,129453,14,129456,129465,14,129472,129472,14,129475,129482,14,129484,129484,14,129488,129510,14,129536,129647,14,129652,129652,14,129656,129658,14,129661,129663,14,129667,129670,14,129680,129685,14,129705,129708,14,129712,129718,14,129723,129727,14,129731,129733,14,129744,129750,14,129754,129759,14,129768,129775,14,129783,129791,14,917504,917504,4,917506,917535,4,917632,917759,4,918000,921599,4,0,9,4,11,12,4,14,31,4,169,169,14,174,174,14,1155,1159,5,1425,1469,5,1473,1474,5,1479,1479,5,1552,1562,5,1611,1631,5,1750,1756,5,1759,1764,5,1770,1773,5,1809,1809,5,1958,1968,5,2045,2045,5,2075,2083,5,2089,2093,5,2192,2193,1,2250,2273,5,2275,2306,5,2362,2362,5,2364,2364,5,2369,2376,5,2381,2381,5,2385,2391,5,2433,2433,5,2492,2492,5,2495,2496,7,2503,2504,7,2509,2509,5,2530,2531,5,2561,2562,5,2620,2620,5,2625,2626,5,2635,2637,5,2672,2673,5,2689,2690,5,2748,2748,5,2753,2757,5,2761,2761,7,2765,2765,5,2810,2815,5,2818,2819,7,2878,2878,5,2880,2880,7,2887,2888,7,2893,2893,5,2903,2903,5,2946,2946,5,3007,3007,7,3009,3010,7,3018,3020,7,3031,3031,5,3073,3075,7,3132,3132,5,3137,3140,7,3146,3149,5,3170,3171,5,3202,3203,7,3262,3262,7,3264,3265,7,3267,3268,7,3271,3272,7,3276,3277,5,3298,3299,5,3330,3331,7,3390,3390,5,3393,3396,5,3402,3404,7,3406,3406,1,3426,3427,5,3458,3459,7,3535,3535,5,3538,3540,5,3544,3550,7,3570,3571,7,3635,3635,7,3655,3662,5,3763,3763,7,3784,3789,5,3893,3893,5,3897,3897,5,3953,3966,5,3968,3972,5,3981,3991,5,4038,4038,5,4145,4145,7,4153,4154,5,4157,4158,5,4184,4185,5,4209,4212,5,4228,4228,7,4237,4237,5,4352,4447,8,4520,4607,10,5906,5908,5,5938,5939,5,5970,5971,5,6068,6069,5,6071,6077,5,6086,6086,5,6089,6099,5,6155,6157,5,6159,6159,5,6313,6313,5,6435,6438,7,6441,6443,7,6450,6450,5,6457,6459,5,6681,6682,7,6741,6741,7,6743,6743,7,6752,6752,5,6757,6764,5,6771,6780,5,6832,6845,5,6847,6862,5,6916,6916,7,6965,6965,5,6971,6971,7,6973,6977,7,6979,6980,7,7040,7041,5,7073,7073,7,7078,7079,7,7082,7082,7,7142,7142,5,7144,7145,5,7149,7149,5,7151,7153,5,7204,7211,7,7220,7221,7,7376,7378,5,7393,7393,7,7405,7405,5,7415,7415,7,7616,7679,5,8204,8204,5,8206,8207,4,8233,8233,4,8252,8252,14,8288,8292,4,8294,8303,4,8413,8416,5,8418,8420,5,8482,8482,14,8596,8601,14,8986,8987,14,9096,9096,14,9193,9196,14,9199,9199,14,9201,9202,14,9208,9210,14,9642,9643,14,9664,9664,14,9728,9729,14,9732,9732,14,9735,9741,14,9743,9744,14,9746,9746,14,9750,9751,14,9753,9756,14,9758,9759,14,9761,9761,14,9764,9765,14,9767,9769,14,9771,9773,14,9775,9775,14,9784,9785,14,9787,9791,14,9793,9793,14,9795,9799,14,9812,9822,14,9824,9824,14,9827,9827,14,9829,9830,14,9832,9832,14,9851,9851,14,9854,9854,14,9856,9861,14,9874,9874,14,9876,9876,14,9878,9879,14,9881,9881,14,9883,9884,14,9888,9889,14,9895,9895,14,9898,9899,14,9904,9905,14,9917,9918,14,9924,9925,14,9928,9928,14,9934,9934,14,9936,9936,14,9938,9938,14,9940,9940,14,9961,9961,14,9963,9967,14,9970,9971,14,9973,9973,14,9975,9977,14,9979,9980,14,9982,9985,14,9987,9988,14,9992,9996,14,9998,9998,14,10000,10001,14,10004,10004,14,10013,10013,14,10024,10024,14,10052,10052,14,10060,10060,14,10067,10069,14,10083,10083,14,10085,10087,14,10145,10145,14,10175,10175,14,11013,11015,14,11088,11088,14,11503,11505,5,11744,11775,5,12334,12335,5,12349,12349,14,12951,12951,14,42607,42607,5,42612,42621,5,42736,42737,5,43014,43014,5,43043,43044,7,43047,43047,7,43136,43137,7,43204,43205,5,43263,43263,5,43335,43345,5,43360,43388,8,43395,43395,7,43444,43445,7,43450,43451,7,43454,43456,7,43561,43566,5,43569,43570,5,43573,43574,5,43596,43596,5,43644,43644,5,43698,43700,5,43710,43711,5,43755,43755,7,43758,43759,7,43766,43766,5,44005,44005,5,44008,44008,5,44012,44012,7,44032,44032,11,44060,44060,11,44088,44088,11,44116,44116,11,44144,44144,11,44172,44172,11,44200,44200,11,44228,44228,11,44256,44256,11,44284,44284,11,44312,44312,11,44340,44340,11,44368,44368,11,44396,44396,11,44424,44424,11,44452,44452,11,44480,44480,11,44508,44508,11,44536,44536,11,44564,44564,11,44592,44592,11,44620,44620,11,44648,44648,11,44676,44676,11,44704,44704,11,44732,44732,11,44760,44760,11,44788,44788,11,44816,44816,11,44844,44844,11,44872,44872,11,44900,44900,11,44928,44928,11,44956,44956,11,44984,44984,11,45012,45012,11,45040,45040,11,45068,45068,11,45096,45096,11,45124,45124,11,45152,45152,11,45180,45180,11,45208,45208,11,45236,45236,11,45264,45264,11,45292,45292,11,45320,45320,11,45348,45348,11,45376,45376,11,45404,45404,11,45432,45432,11,45460,45460,11,45488,45488,11,45516,45516,11,45544,45544,11,45572,45572,11,45600,45600,11,45628,45628,11,45656,45656,11,45684,45684,11,45712,45712,11,45740,45740,11,45768,45768,11,45796,45796,11,45824,45824,11,45852,45852,11,45880,45880,11,45908,45908,11,45936,45936,11,45964,45964,11,45992,45992,11,46020,46020,11,46048,46048,11,46076,46076,11,46104,46104,11,46132,46132,11,46160,46160,11,46188,46188,11,46216,46216,11,46244,46244,11,46272,46272,11,46300,46300,11,46328,46328,11,46356,46356,11,46384,46384,11,46412,46412,11,46440,46440,11,46468,46468,11,46496,46496,11,46524,46524,11,46552,46552,11,46580,46580,11,46608,46608,11,46636,46636,11,46664,46664,11,46692,46692,11,46720,46720,11,46748,46748,11,46776,46776,11,46804,46804,11,46832,46832,11,46860,46860,11,46888,46888,11,46916,46916,11,46944,46944,11,46972,46972,11,47000,47000,11,47028,47028,11,47056,47056,11,47084,47084,11,47112,47112,11,47140,47140,11,47168,47168,11,47196,47196,11,47224,47224,11,47252,47252,11,47280,47280,11,47308,47308,11,47336,47336,11,47364,47364,11,47392,47392,11,47420,47420,11,47448,47448,11,47476,47476,11,47504,47504,11,47532,47532,11,47560,47560,11,47588,47588,11,47616,47616,11,47644,47644,11,47672,47672,11,47700,47700,11,47728,47728,11,47756,47756,11,47784,47784,11,47812,47812,11,47840,47840,11,47868,47868,11,47896,47896,11,47924,47924,11,47952,47952,11,47980,47980,11,48008,48008,11,48036,48036,11,48064,48064,11,48092,48092,11,48120,48120,11,48148,48148,11,48176,48176,11,48204,48204,11,48232,48232,11,48260,48260,11,48288,48288,11,48316,48316,11,48344,48344,11,48372,48372,11,48400,48400,11,48428,48428,11,48456,48456,11,48484,48484,11,48512,48512,11,48540,48540,11,48568,48568,11,48596,48596,11,48624,48624,11,48652,48652,11,48680,48680,11,48708,48708,11,48736,48736,11,48764,48764,11,48792,48792,11,48820,48820,11,48848,48848,11,48876,48876,11,48904,48904,11,48932,48932,11,48960,48960,11,48988,48988,11,49016,49016,11,49044,49044,11,49072,49072,11,49100,49100,11,49128,49128,11,49156,49156,11,49184,49184,11,49212,49212,11,49240,49240,11,49268,49268,11,49296,49296,11,49324,49324,11,49352,49352,11,49380,49380,11,49408,49408,11,49436,49436,11,49464,49464,11,49492,49492,11,49520,49520,11,49548,49548,11,49576,49576,11,49604,49604,11,49632,49632,11,49660,49660,11,49688,49688,11,49716,49716,11,49744,49744,11,49772,49772,11,49800,49800,11,49828,49828,11,49856,49856,11,49884,49884,11,49912,49912,11,49940,49940,11,49968,49968,11,49996,49996,11,50024,50024,11,50052,50052,11,50080,50080,11,50108,50108,11,50136,50136,11,50164,50164,11,50192,50192,11,50220,50220,11,50248,50248,11,50276,50276,11,50304,50304,11,50332,50332,11,50360,50360,11,50388,50388,11,50416,50416,11,50444,50444,11,50472,50472,11,50500,50500,11,50528,50528,11,50556,50556,11,50584,50584,11,50612,50612,11,50640,50640,11,50668,50668,11,50696,50696,11,50724,50724,11,50752,50752,11,50780,50780,11,50808,50808,11,50836,50836,11,50864,50864,11,50892,50892,11,50920,50920,11,50948,50948,11,50976,50976,11,51004,51004,11,51032,51032,11,51060,51060,11,51088,51088,11,51116,51116,11,51144,51144,11,51172,51172,11,51200,51200,11,51228,51228,11,51256,51256,11,51284,51284,11,51312,51312,11,51340,51340,11,51368,51368,11,51396,51396,11,51424,51424,11,51452,51452,11,51480,51480,11,51508,51508,11,51536,51536,11,51564,51564,11,51592,51592,11,51620,51620,11,51648,51648,11,51676,51676,11,51704,51704,11,51732,51732,11,51760,51760,11,51788,51788,11,51816,51816,11,51844,51844,11,51872,51872,11,51900,51900,11,51928,51928,11,51956,51956,11,51984,51984,11,52012,52012,11,52040,52040,11,52068,52068,11,52096,52096,11,52124,52124,11,52152,52152,11,52180,52180,11,52208,52208,11,52236,52236,11,52264,52264,11,52292,52292,11,52320,52320,11,52348,52348,11,52376,52376,11,52404,52404,11,52432,52432,11,52460,52460,11,52488,52488,11,52516,52516,11,52544,52544,11,52572,52572,11,52600,52600,11,52628,52628,11,52656,52656,11,52684,52684,11,52712,52712,11,52740,52740,11,52768,52768,11,52796,52796,11,52824,52824,11,52852,52852,11,52880,52880,11,52908,52908,11,52936,52936,11,52964,52964,11,52992,52992,11,53020,53020,11,53048,53048,11,53076,53076,11,53104,53104,11,53132,53132,11,53160,53160,11,53188,53188,11,53216,53216,11,53244,53244,11,53272,53272,11,53300,53300,11,53328,53328,11,53356,53356,11,53384,53384,11,53412,53412,11,53440,53440,11,53468,53468,11,53496,53496,11,53524,53524,11,53552,53552,11,53580,53580,11,53608,53608,11,53636,53636,11,53664,53664,11,53692,53692,11,53720,53720,11,53748,53748,11,53776,53776,11,53804,53804,11,53832,53832,11,53860,53860,11,53888,53888,11,53916,53916,11,53944,53944,11,53972,53972,11,54000,54000,11,54028,54028,11,54056,54056,11,54084,54084,11,54112,54112,11,54140,54140,11,54168,54168,11,54196,54196,11,54224,54224,11,54252,54252,11,54280,54280,11,54308,54308,11,54336,54336,11,54364,54364,11,54392,54392,11,54420,54420,11,54448,54448,11,54476,54476,11,54504,54504,11,54532,54532,11,54560,54560,11,54588,54588,11,54616,54616,11,54644,54644,11,54672,54672,11,54700,54700,11,54728,54728,11,54756,54756,11,54784,54784,11,54812,54812,11,54840,54840,11,54868,54868,11,54896,54896,11,54924,54924,11,54952,54952,11,54980,54980,11,55008,55008,11,55036,55036,11,55064,55064,11,55092,55092,11,55120,55120,11,55148,55148,11,55176,55176,11,55216,55238,9,64286,64286,5,65056,65071,5,65438,65439,5,65529,65531,4,66272,66272,5,68097,68099,5,68108,68111,5,68159,68159,5,68900,68903,5,69446,69456,5,69632,69632,7,69634,69634,7,69744,69744,5,69759,69761,5,69808,69810,7,69815,69816,7,69821,69821,1,69837,69837,1,69927,69931,5,69933,69940,5,70003,70003,5,70018,70018,7,70070,70078,5,70082,70083,1,70094,70094,7,70188,70190,7,70194,70195,7,70197,70197,7,70206,70206,5,70368,70370,7,70400,70401,5,70459,70460,5,70463,70463,7,70465,70468,7,70475,70477,7,70498,70499,7,70512,70516,5,70712,70719,5,70722,70724,5,70726,70726,5,70832,70832,5,70835,70840,5,70842,70842,5,70845,70845,5,70847,70848,5,70850,70851,5,71088,71089,7,71096,71099,7,71102,71102,7,71132,71133,5,71219,71226,5,71229,71229,5,71231,71232,5,71340,71340,7,71342,71343,7,71350,71350,7,71453,71455,5,71462,71462,7,71724,71726,7,71736,71736,7,71984,71984,5,71991,71992,7,71997,71997,7,71999,71999,1,72001,72001,1,72003,72003,5,72148,72151,5,72156,72159,7,72164,72164,7,72243,72248,5,72250,72250,1,72263,72263,5,72279,72280,7,72324,72329,1,72343,72343,7,72751,72751,7,72760,72765,5,72767,72767,5,72873,72873,7,72881,72881,7,72884,72884,7,73009,73014,5,73020,73021,5,73030,73030,1,73098,73102,7,73107,73108,7,73110,73110,7,73459,73460,5,78896,78904,4,92976,92982,5,94033,94087,7,94180,94180,5,113821,113822,5,118528,118573,5,119141,119141,5,119143,119145,5,119150,119154,5,119163,119170,5,119210,119213,5,121344,121398,5,121461,121461,5,121499,121503,5,122880,122886,5,122907,122913,5,122918,122922,5,123566,123566,5,125136,125142,5,126976,126979,14,126981,127182,14,127184,127231,14,127279,127279,14,127344,127345,14,127374,127374,14,127405,127461,14,127489,127490,14,127514,127514,14,127538,127546,14,127561,127567,14,127570,127743,14,127757,127758,14,127760,127760,14,127762,127762,14,127766,127768,14,127770,127770,14,127772,127772,14,127775,127776,14,127778,127779,14,127789,127791,14,127794,127795,14,127798,127798,14,127819,127819,14,127824,127824,14,127868,127868,14,127870,127871,14,127892,127893,14,127896,127896,14,127900,127901,14,127904,127940,14,127942,127942,14,127944,127944,14,127946,127946,14,127951,127955,14,127968,127971,14,127973,127984,14,127987,127987,14,127989,127989,14,127991,127991,14,127995,127999,5,128008,128008,14,128012,128014,14,128017,128018,14,128020,128020,14,128022,128022,14,128042,128042,14,128063,128063,14,128065,128065,14,128101,128101,14,128108,128109,14,128173,128173,14,128182,128183,14,128236,128237,14,128239,128239,14,128245,128245,14,128248,128248,14,128253,128253,14,128255,128258,14,128260,128263,14,128265,128265,14,128277,128277,14,128300,128301,14,128326,128328,14,128331,128334,14,128336,128347,14,128360,128366,14,128369,128370,14,128378,128378,14,128391,128391,14,128394,128397,14,128400,128400,14,128405,128406,14,128420,128420,14,128422,128423,14,128425,128432,14,128435,128443,14,128445,128449,14,128453,128464,14,128468,128475,14,128479,128480,14,128482,128482,14,128484,128487,14,128489,128494,14,128496,128498,14,128500,128505,14,128507,128511,14,128513,128518,14,128521,128525,14,128527,128527,14,128529,128529,14,128533,128533,14,128535,128535,14,128537,128537,14]")}function KA(o,e){if(o===0)return 0;let t=n7(o,e);if(t!==void 0)return t;let n=new Xc(e,o);return n.prevCodePoint(),n.offset}function n7(o,e){let t=new Xc(e,o),n=t.prevCodePoint();for(;i7(n)||n===65039||n===8419;){if(t.offset===0)return;n=t.prevCodePoint()}if(!vf(n))return;let i=t.offset;return i>0&&t.prevCodePoint()===8205&&(i=t.offset),i}function i7(o){return 127995<=o&&o<=127999}var aL=class o{constructor(e){this.confusableDictionary=e}static ambiguousCharacterData=new Qn(()=>JSON.parse('{"_common":[8232,32,8233,32,5760,32,8192,32,8193,32,8194,32,8195,32,8196,32,8197,32,8198,32,8200,32,8201,32,8202,32,8287,32,8199,32,8239,32,2042,95,65101,95,65102,95,65103,95,8208,45,8209,45,8210,45,65112,45,1748,45,8259,45,727,45,8722,45,10134,45,11450,45,1549,44,1643,44,8218,44,184,44,42233,44,894,59,2307,58,2691,58,1417,58,1795,58,1796,58,5868,58,65072,58,6147,58,6153,58,8282,58,1475,58,760,58,42889,58,8758,58,720,58,42237,58,451,33,11601,33,660,63,577,63,2429,63,5038,63,42731,63,119149,46,8228,46,1793,46,1794,46,42510,46,68176,46,1632,46,1776,46,42232,46,1373,96,65287,96,8219,96,8242,96,1370,96,1523,96,8175,96,65344,96,900,96,8189,96,8125,96,8127,96,8190,96,697,96,884,96,712,96,714,96,715,96,756,96,699,96,701,96,700,96,702,96,42892,96,1497,96,2036,96,2037,96,5194,96,5836,96,94033,96,94034,96,65339,91,10088,40,10098,40,12308,40,64830,40,65341,93,10089,41,10099,41,12309,41,64831,41,10100,123,119060,123,10101,125,65342,94,8270,42,1645,42,8727,42,66335,42,5941,47,8257,47,8725,47,8260,47,9585,47,10187,47,10744,47,119354,47,12755,47,12339,47,11462,47,20031,47,12035,47,65340,92,65128,92,8726,92,10189,92,10741,92,10745,92,119311,92,119355,92,12756,92,20022,92,12034,92,42872,38,708,94,710,94,5869,43,10133,43,66203,43,8249,60,10094,60,706,60,119350,60,5176,60,5810,60,5120,61,11840,61,12448,61,42239,61,8250,62,10095,62,707,62,119351,62,5171,62,94015,62,8275,126,732,126,8128,126,8764,126,65372,124,65293,45,120784,50,120794,50,120804,50,120814,50,120824,50,130034,50,42842,50,423,50,1000,50,42564,50,5311,50,42735,50,119302,51,120785,51,120795,51,120805,51,120815,51,120825,51,130035,51,42923,51,540,51,439,51,42858,51,11468,51,1248,51,94011,51,71882,51,120786,52,120796,52,120806,52,120816,52,120826,52,130036,52,5070,52,71855,52,120787,53,120797,53,120807,53,120817,53,120827,53,130037,53,444,53,71867,53,120788,54,120798,54,120808,54,120818,54,120828,54,130038,54,11474,54,5102,54,71893,54,119314,55,120789,55,120799,55,120809,55,120819,55,120829,55,130039,55,66770,55,71878,55,2819,56,2538,56,2666,56,125131,56,120790,56,120800,56,120810,56,120820,56,120830,56,130040,56,547,56,546,56,66330,56,2663,57,2920,57,2541,57,3437,57,120791,57,120801,57,120811,57,120821,57,120831,57,130041,57,42862,57,11466,57,71884,57,71852,57,71894,57,9082,97,65345,97,119834,97,119886,97,119938,97,119990,97,120042,97,120094,97,120146,97,120198,97,120250,97,120302,97,120354,97,120406,97,120458,97,593,97,945,97,120514,97,120572,97,120630,97,120688,97,120746,97,65313,65,119808,65,119860,65,119912,65,119964,65,120016,65,120068,65,120120,65,120172,65,120224,65,120276,65,120328,65,120380,65,120432,65,913,65,120488,65,120546,65,120604,65,120662,65,120720,65,5034,65,5573,65,42222,65,94016,65,66208,65,119835,98,119887,98,119939,98,119991,98,120043,98,120095,98,120147,98,120199,98,120251,98,120303,98,120355,98,120407,98,120459,98,388,98,5071,98,5234,98,5551,98,65314,66,8492,66,119809,66,119861,66,119913,66,120017,66,120069,66,120121,66,120173,66,120225,66,120277,66,120329,66,120381,66,120433,66,42932,66,914,66,120489,66,120547,66,120605,66,120663,66,120721,66,5108,66,5623,66,42192,66,66178,66,66209,66,66305,66,65347,99,8573,99,119836,99,119888,99,119940,99,119992,99,120044,99,120096,99,120148,99,120200,99,120252,99,120304,99,120356,99,120408,99,120460,99,7428,99,1010,99,11429,99,43951,99,66621,99,128844,67,71922,67,71913,67,65315,67,8557,67,8450,67,8493,67,119810,67,119862,67,119914,67,119966,67,120018,67,120174,67,120226,67,120278,67,120330,67,120382,67,120434,67,1017,67,11428,67,5087,67,42202,67,66210,67,66306,67,66581,67,66844,67,8574,100,8518,100,119837,100,119889,100,119941,100,119993,100,120045,100,120097,100,120149,100,120201,100,120253,100,120305,100,120357,100,120409,100,120461,100,1281,100,5095,100,5231,100,42194,100,8558,68,8517,68,119811,68,119863,68,119915,68,119967,68,120019,68,120071,68,120123,68,120175,68,120227,68,120279,68,120331,68,120383,68,120435,68,5024,68,5598,68,5610,68,42195,68,8494,101,65349,101,8495,101,8519,101,119838,101,119890,101,119942,101,120046,101,120098,101,120150,101,120202,101,120254,101,120306,101,120358,101,120410,101,120462,101,43826,101,1213,101,8959,69,65317,69,8496,69,119812,69,119864,69,119916,69,120020,69,120072,69,120124,69,120176,69,120228,69,120280,69,120332,69,120384,69,120436,69,917,69,120492,69,120550,69,120608,69,120666,69,120724,69,11577,69,5036,69,42224,69,71846,69,71854,69,66182,69,119839,102,119891,102,119943,102,119995,102,120047,102,120099,102,120151,102,120203,102,120255,102,120307,102,120359,102,120411,102,120463,102,43829,102,42905,102,383,102,7837,102,1412,102,119315,70,8497,70,119813,70,119865,70,119917,70,120021,70,120073,70,120125,70,120177,70,120229,70,120281,70,120333,70,120385,70,120437,70,42904,70,988,70,120778,70,5556,70,42205,70,71874,70,71842,70,66183,70,66213,70,66853,70,65351,103,8458,103,119840,103,119892,103,119944,103,120048,103,120100,103,120152,103,120204,103,120256,103,120308,103,120360,103,120412,103,120464,103,609,103,7555,103,397,103,1409,103,119814,71,119866,71,119918,71,119970,71,120022,71,120074,71,120126,71,120178,71,120230,71,120282,71,120334,71,120386,71,120438,71,1292,71,5056,71,5107,71,42198,71,65352,104,8462,104,119841,104,119945,104,119997,104,120049,104,120101,104,120153,104,120205,104,120257,104,120309,104,120361,104,120413,104,120465,104,1211,104,1392,104,5058,104,65320,72,8459,72,8460,72,8461,72,119815,72,119867,72,119919,72,120023,72,120179,72,120231,72,120283,72,120335,72,120387,72,120439,72,919,72,120494,72,120552,72,120610,72,120668,72,120726,72,11406,72,5051,72,5500,72,42215,72,66255,72,731,105,9075,105,65353,105,8560,105,8505,105,8520,105,119842,105,119894,105,119946,105,119998,105,120050,105,120102,105,120154,105,120206,105,120258,105,120310,105,120362,105,120414,105,120466,105,120484,105,618,105,617,105,953,105,8126,105,890,105,120522,105,120580,105,120638,105,120696,105,120754,105,1110,105,42567,105,1231,105,43893,105,5029,105,71875,105,65354,106,8521,106,119843,106,119895,106,119947,106,119999,106,120051,106,120103,106,120155,106,120207,106,120259,106,120311,106,120363,106,120415,106,120467,106,1011,106,1112,106,65322,74,119817,74,119869,74,119921,74,119973,74,120025,74,120077,74,120129,74,120181,74,120233,74,120285,74,120337,74,120389,74,120441,74,42930,74,895,74,1032,74,5035,74,5261,74,42201,74,119844,107,119896,107,119948,107,120000,107,120052,107,120104,107,120156,107,120208,107,120260,107,120312,107,120364,107,120416,107,120468,107,8490,75,65323,75,119818,75,119870,75,119922,75,119974,75,120026,75,120078,75,120130,75,120182,75,120234,75,120286,75,120338,75,120390,75,120442,75,922,75,120497,75,120555,75,120613,75,120671,75,120729,75,11412,75,5094,75,5845,75,42199,75,66840,75,1472,108,8739,73,9213,73,65512,73,1633,108,1777,73,66336,108,125127,108,120783,73,120793,73,120803,73,120813,73,120823,73,130033,73,65321,73,8544,73,8464,73,8465,73,119816,73,119868,73,119920,73,120024,73,120128,73,120180,73,120232,73,120284,73,120336,73,120388,73,120440,73,65356,108,8572,73,8467,108,119845,108,119897,108,119949,108,120001,108,120053,108,120105,73,120157,73,120209,73,120261,73,120313,73,120365,73,120417,73,120469,73,448,73,120496,73,120554,73,120612,73,120670,73,120728,73,11410,73,1030,73,1216,73,1493,108,1503,108,1575,108,126464,108,126592,108,65166,108,65165,108,1994,108,11599,73,5825,73,42226,73,93992,73,66186,124,66313,124,119338,76,8556,76,8466,76,119819,76,119871,76,119923,76,120027,76,120079,76,120131,76,120183,76,120235,76,120287,76,120339,76,120391,76,120443,76,11472,76,5086,76,5290,76,42209,76,93974,76,71843,76,71858,76,66587,76,66854,76,65325,77,8559,77,8499,77,119820,77,119872,77,119924,77,120028,77,120080,77,120132,77,120184,77,120236,77,120288,77,120340,77,120392,77,120444,77,924,77,120499,77,120557,77,120615,77,120673,77,120731,77,1018,77,11416,77,5047,77,5616,77,5846,77,42207,77,66224,77,66321,77,119847,110,119899,110,119951,110,120003,110,120055,110,120107,110,120159,110,120211,110,120263,110,120315,110,120367,110,120419,110,120471,110,1400,110,1404,110,65326,78,8469,78,119821,78,119873,78,119925,78,119977,78,120029,78,120081,78,120185,78,120237,78,120289,78,120341,78,120393,78,120445,78,925,78,120500,78,120558,78,120616,78,120674,78,120732,78,11418,78,42208,78,66835,78,3074,111,3202,111,3330,111,3458,111,2406,111,2662,111,2790,111,3046,111,3174,111,3302,111,3430,111,3664,111,3792,111,4160,111,1637,111,1781,111,65359,111,8500,111,119848,111,119900,111,119952,111,120056,111,120108,111,120160,111,120212,111,120264,111,120316,111,120368,111,120420,111,120472,111,7439,111,7441,111,43837,111,959,111,120528,111,120586,111,120644,111,120702,111,120760,111,963,111,120532,111,120590,111,120648,111,120706,111,120764,111,11423,111,4351,111,1413,111,1505,111,1607,111,126500,111,126564,111,126596,111,65259,111,65260,111,65258,111,65257,111,1726,111,64428,111,64429,111,64427,111,64426,111,1729,111,64424,111,64425,111,64423,111,64422,111,1749,111,3360,111,4125,111,66794,111,71880,111,71895,111,66604,111,1984,79,2534,79,2918,79,12295,79,70864,79,71904,79,120782,79,120792,79,120802,79,120812,79,120822,79,130032,79,65327,79,119822,79,119874,79,119926,79,119978,79,120030,79,120082,79,120134,79,120186,79,120238,79,120290,79,120342,79,120394,79,120446,79,927,79,120502,79,120560,79,120618,79,120676,79,120734,79,11422,79,1365,79,11604,79,4816,79,2848,79,66754,79,42227,79,71861,79,66194,79,66219,79,66564,79,66838,79,9076,112,65360,112,119849,112,119901,112,119953,112,120005,112,120057,112,120109,112,120161,112,120213,112,120265,112,120317,112,120369,112,120421,112,120473,112,961,112,120530,112,120544,112,120588,112,120602,112,120646,112,120660,112,120704,112,120718,112,120762,112,120776,112,11427,112,65328,80,8473,80,119823,80,119875,80,119927,80,119979,80,120031,80,120083,80,120187,80,120239,80,120291,80,120343,80,120395,80,120447,80,929,80,120504,80,120562,80,120620,80,120678,80,120736,80,11426,80,5090,80,5229,80,42193,80,66197,80,119850,113,119902,113,119954,113,120006,113,120058,113,120110,113,120162,113,120214,113,120266,113,120318,113,120370,113,120422,113,120474,113,1307,113,1379,113,1382,113,8474,81,119824,81,119876,81,119928,81,119980,81,120032,81,120084,81,120188,81,120240,81,120292,81,120344,81,120396,81,120448,81,11605,81,119851,114,119903,114,119955,114,120007,114,120059,114,120111,114,120163,114,120215,114,120267,114,120319,114,120371,114,120423,114,120475,114,43847,114,43848,114,7462,114,11397,114,43905,114,119318,82,8475,82,8476,82,8477,82,119825,82,119877,82,119929,82,120033,82,120189,82,120241,82,120293,82,120345,82,120397,82,120449,82,422,82,5025,82,5074,82,66740,82,5511,82,42211,82,94005,82,65363,115,119852,115,119904,115,119956,115,120008,115,120060,115,120112,115,120164,115,120216,115,120268,115,120320,115,120372,115,120424,115,120476,115,42801,115,445,115,1109,115,43946,115,71873,115,66632,115,65331,83,119826,83,119878,83,119930,83,119982,83,120034,83,120086,83,120138,83,120190,83,120242,83,120294,83,120346,83,120398,83,120450,83,1029,83,1359,83,5077,83,5082,83,42210,83,94010,83,66198,83,66592,83,119853,116,119905,116,119957,116,120009,116,120061,116,120113,116,120165,116,120217,116,120269,116,120321,116,120373,116,120425,116,120477,116,8868,84,10201,84,128872,84,65332,84,119827,84,119879,84,119931,84,119983,84,120035,84,120087,84,120139,84,120191,84,120243,84,120295,84,120347,84,120399,84,120451,84,932,84,120507,84,120565,84,120623,84,120681,84,120739,84,11430,84,5026,84,42196,84,93962,84,71868,84,66199,84,66225,84,66325,84,119854,117,119906,117,119958,117,120010,117,120062,117,120114,117,120166,117,120218,117,120270,117,120322,117,120374,117,120426,117,120478,117,42911,117,7452,117,43854,117,43858,117,651,117,965,117,120534,117,120592,117,120650,117,120708,117,120766,117,1405,117,66806,117,71896,117,8746,85,8899,85,119828,85,119880,85,119932,85,119984,85,120036,85,120088,85,120140,85,120192,85,120244,85,120296,85,120348,85,120400,85,120452,85,1357,85,4608,85,66766,85,5196,85,42228,85,94018,85,71864,85,8744,118,8897,118,65366,118,8564,118,119855,118,119907,118,119959,118,120011,118,120063,118,120115,118,120167,118,120219,118,120271,118,120323,118,120375,118,120427,118,120479,118,7456,118,957,118,120526,118,120584,118,120642,118,120700,118,120758,118,1141,118,1496,118,71430,118,43945,118,71872,118,119309,86,1639,86,1783,86,8548,86,119829,86,119881,86,119933,86,119985,86,120037,86,120089,86,120141,86,120193,86,120245,86,120297,86,120349,86,120401,86,120453,86,1140,86,11576,86,5081,86,5167,86,42719,86,42214,86,93960,86,71840,86,66845,86,623,119,119856,119,119908,119,119960,119,120012,119,120064,119,120116,119,120168,119,120220,119,120272,119,120324,119,120376,119,120428,119,120480,119,7457,119,1121,119,1309,119,1377,119,71434,119,71438,119,71439,119,43907,119,71919,87,71910,87,119830,87,119882,87,119934,87,119986,87,120038,87,120090,87,120142,87,120194,87,120246,87,120298,87,120350,87,120402,87,120454,87,1308,87,5043,87,5076,87,42218,87,5742,120,10539,120,10540,120,10799,120,65368,120,8569,120,119857,120,119909,120,119961,120,120013,120,120065,120,120117,120,120169,120,120221,120,120273,120,120325,120,120377,120,120429,120,120481,120,5441,120,5501,120,5741,88,9587,88,66338,88,71916,88,65336,88,8553,88,119831,88,119883,88,119935,88,119987,88,120039,88,120091,88,120143,88,120195,88,120247,88,120299,88,120351,88,120403,88,120455,88,42931,88,935,88,120510,88,120568,88,120626,88,120684,88,120742,88,11436,88,11613,88,5815,88,42219,88,66192,88,66228,88,66327,88,66855,88,611,121,7564,121,65369,121,119858,121,119910,121,119962,121,120014,121,120066,121,120118,121,120170,121,120222,121,120274,121,120326,121,120378,121,120430,121,120482,121,655,121,7935,121,43866,121,947,121,8509,121,120516,121,120574,121,120632,121,120690,121,120748,121,1199,121,4327,121,71900,121,65337,89,119832,89,119884,89,119936,89,119988,89,120040,89,120092,89,120144,89,120196,89,120248,89,120300,89,120352,89,120404,89,120456,89,933,89,978,89,120508,89,120566,89,120624,89,120682,89,120740,89,11432,89,1198,89,5033,89,5053,89,42220,89,94019,89,71844,89,66226,89,119859,122,119911,122,119963,122,120015,122,120067,122,120119,122,120171,122,120223,122,120275,122,120327,122,120379,122,120431,122,120483,122,7458,122,43923,122,71876,122,66293,90,71909,90,65338,90,8484,90,8488,90,119833,90,119885,90,119937,90,119989,90,120041,90,120197,90,120249,90,120301,90,120353,90,120405,90,120457,90,918,90,120493,90,120551,90,120609,90,120667,90,120725,90,5059,90,42204,90,71849,90,65282,34,65284,36,65285,37,65286,38,65290,42,65291,43,65294,46,65295,47,65296,48,65297,49,65298,50,65299,51,65300,52,65301,53,65302,54,65303,55,65304,56,65305,57,65308,60,65309,61,65310,62,65312,64,65316,68,65318,70,65319,71,65324,76,65329,81,65330,82,65333,85,65334,86,65335,87,65343,95,65346,98,65348,100,65350,102,65355,107,65357,109,65358,110,65361,113,65362,114,65364,116,65365,117,65367,119,65370,122,65371,123,65373,125,119846,109],"_default":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"cs":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"de":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"es":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"fr":[65374,126,65306,58,65281,33,8216,96,8245,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"it":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ja":[8211,45,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65292,44,65307,59],"ko":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pl":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pt-BR":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"qps-ploc":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ru":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,305,105,921,73,1009,112,215,120,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"tr":[160,32,8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"zh-hans":[65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41],"zh-hant":[8211,45,65374,126,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65307,59]}'));static cache=new iI({getCacheKey:JSON.stringify},e=>{function t(c){let u=new Map;for(let p=0;p<c.length;p+=2)u.set(c[p],c[p+1]);return u}function n(c,u){let p=new Map(c);for(let[h,f]of u)p.set(h,f);return p}function i(c,u){if(!c)return u;let p=new Map;for(let[h,f]of c)u.has(h)&&p.set(h,f);return p}let r=this.ambiguousCharacterData.value,s=e.filter(c=>!c.startsWith("_")&&c in r);s.length===0&&(s=["_default"]);let a;for(let c of s){let u=t(r[c]);a=i(a,u)}let l=t(r._common),d=n(l,a);return new o(d)});static getInstance(e){return o.cache.get(Array.from(e))}static _locales=new Qn(()=>Object.keys(o.ambiguousCharacterData.value).filter(e=>!e.startsWith("_")));static getLocales(){return o._locales.value}isAmbiguous(e){return this.confusableDictionary.has(e)}containsAmbiguousCharacter(e){for(let t=0;t<e.length;t++){let n=e.codePointAt(t);if(typeof n=="number"&&this.isAmbiguous(n))return!0}return!1}getPrimaryConfusable(e){return this.confusableDictionary.get(e)}getConfusableCodePoints(){return new Set(this.confusableDictionary.keys())}};function Zr(o){return hL(o,0)}function hL(o,e){switch(typeof o){case"object":return o===null?Il(349,e):Array.isArray(o)?r7(o,e):s7(o,e);case"string":return pI(o,e);case"boolean":return o7(o,e);case"number":return Il(o,e);case"undefined":return Il(937,e);default:return Il(617,e)}}function Il(o,e){return(e<<5)-e+o|0}function o7(o,e){return Il(o?433:863,e)}function pI(o,e){e=Il(149417,e);for(let t=0,n=o.length;t<n;t++)e=Il(o.charCodeAt(t),e);return e}function r7(o,e){return e=Il(104579,e),o.reduce((t,n)=>hL(n,t),e)}function s7(o,e){return e=Il(181387,e),Object.keys(o).sort().reduce((t,n)=>(t=pI(n,t),hL(o[n],t)),e)}function pL(o,e,t=32){let n=t-e,i=~((1<<n)-1);return(o<<e|(i&o)>>>n)>>>0}function GA(o,e=0,t=o.byteLength,n=0){for(let i=0;i<t;i++)o[e+i]=n}function a7(o,e,t="0"){for(;o.length<e;)o=t+o;return o}function yf(o,e=32){return o instanceof ArrayBuffer?Array.from(new Uint8Array(o)).map(t=>t.toString(16).padStart(2,"0")).join(""):a7((o>>>0).toString(16),e/4)}var jA=class o{static _bigBlock32=new DataView(new ArrayBuffer(320));_h0=1732584193;_h1=4023233417;_h2=2562383102;_h3=271733878;_h4=3285377520;_buff;_buffDV;_buffLen;_totalLen;_leftoverHighSurrogate;_finished;constructor(){this._buff=new Uint8Array(67),this._buffDV=new DataView(this._buff.buffer),this._buffLen=0,this._totalLen=0,this._leftoverHighSurrogate=0,this._finished=!1}update(e){let t=e.length;if(t===0)return;let n=this._buff,i=this._buffLen,r=this._leftoverHighSurrogate,s,a;for(r!==0?(s=r,a=-1,r=0):(s=e.charCodeAt(0),a=0);;){let l=s;if(ln(s))if(a+1<t){let d=e.charCodeAt(a+1);Id(d)?(a++,l=lI(s,d)):l=65533}else{r=s;break}else Id(s)&&(l=65533);if(i=this._push(n,i,l),a++,a<t)s=e.charCodeAt(a);else break}this._buffLen=i,this._leftoverHighSurrogate=r}_push(e,t,n){return n<128?e[t++]=n:n<2048?(e[t++]=192|(n&1984)>>>6,e[t++]=128|(n&63)>>>0):n<65536?(e[t++]=224|(n&61440)>>>12,e[t++]=128|(n&4032)>>>6,e[t++]=128|(n&63)>>>0):(e[t++]=240|(n&1835008)>>>18,e[t++]=128|(n&258048)>>>12,e[t++]=128|(n&4032)>>>6,e[t++]=128|(n&63)>>>0),t>=64&&(this._step(),t-=64,this._totalLen+=64,e[0]=e[64],e[1]=e[65],e[2]=e[66]),t}digest(){return this._finished||(this._finished=!0,this._leftoverHighSurrogate&&(this._leftoverHighSurrogate=0,this._buffLen=this._push(this._buff,this._buffLen,65533)),this._totalLen+=this._buffLen,this._wrapUp()),yf(this._h0)+yf(this._h1)+yf(this._h2)+yf(this._h3)+yf(this._h4)}_wrapUp(){this._buff[this._buffLen++]=128,GA(this._buff,this._buffLen),this._buffLen>56&&(this._step(),GA(this._buff));let e=8*this._totalLen;this._buffDV.setUint32(56,Math.floor(e/4294967296),!1),this._buffDV.setUint32(60,e%4294967296,!1),this._step()}_step(){let e=o._bigBlock32,t=this._buffDV;for(let u=0;u<64;u+=4)e.setUint32(u,t.getUint32(u,!1),!1);for(let u=64;u<320;u+=4)e.setUint32(u,pL(e.getUint32(u-12,!1)^e.getUint32(u-32,!1)^e.getUint32(u-56,!1)^e.getUint32(u-64,!1),1),!1);let n=this._h0,i=this._h1,r=this._h2,s=this._h3,a=this._h4,l,d,c;for(let u=0;u<80;u++)u<20?(l=i&r|~i&s,d=1518500249):u<40?(l=i^r^s,d=1859775393):u<60?(l=i&r|i&s|r&s,d=2400959708):(l=i^r^s,d=3395469782),c=pL(n,5)+l+a+d+e.getUint32(u*4,!1)&4294967295,a=s,s=r,r=pL(i,30),i=n,n=c;this._h0=this._h0+n&4294967295,this._h1=this._h1+i&4294967295,this._h2=this._h2+r&4294967295,this._h3=this._h3+s&4294967295,this._h4=this._h4+a&4294967295}};function Cd(o){return o===47||o===92}function hI(o){return o.replace(/[\\/]/g,bt.sep)}function $A(o){return o.indexOf("/")===-1&&(o=hI(o)),/^[a-zA-Z]:(\/|$)/.test(o)&&(o="/"+o),o}function mL(o,e=bt.sep){if(!o)return"";let t=o.length,n=o.charCodeAt(0);if(Cd(n)){if(Cd(o.charCodeAt(1))&&!Cd(o.charCodeAt(2))){let r=3,s=r;for(;r<t&&!Cd(o.charCodeAt(r));r++);if(s!==r&&!Cd(o.charCodeAt(r+1))){for(r+=1;r<t;r++)if(Cd(o.charCodeAt(r)))return o.slice(0,r+1).replace(/[\\/]/g,e)}}return e}else if(ZA(n)&&o.charCodeAt(1)===58)return Cd(o.charCodeAt(2))?o.slice(0,2)+e:o.slice(0,2);let i=o.indexOf("://");if(i!==-1){for(i+=3;i<t;i++)if(Cd(o.charCodeAt(i)))return o.slice(0,i+1)}return""}var l7=/[\\/:\*\?"<>\|]/g,d7=/[/]/g,c7=/^(con|prn|aux|clock\$|nul|lpt[0-9]|com[0-9])(\.(.*?))?$/i;function YA(o,e=pt){let t=e?l7:d7;return!(!o||o.length===0||/^\s+$/.test(o)||(t.lastIndex=0,t.test(o))||e&&c7.test(o)||o==="."||o===".."||e&&o[o.length-1]==="."||e&&o.length!==o.trim().length||o.length>255)}function If(o,e,t,n=ui){if(o===e)return!0;if(!o||!e||e.length>o.length)return!1;if(t){if(!yd(o,e))return!1;if(e.length===o.length)return!0;let r=e.length;return e.charAt(e.length-1)===n&&r--,o.charAt(r)===n}return e.charAt(e.length-1)!==n&&(e+=n),o.indexOf(e)===0}function ZA(o){return o>=65&&o<=90||o>=97&&o<=122}function XA(o,e=pt){return e?ZA(o.charCodeAt(0))&&o.charCodeAt(1)===58:!1}function QA(o,e=pt){return XA(o,e)?o[0]:void 0}function JA(o,e,t){return e.length>o.length?-1:o===e?0:(t&&(o=o.toLowerCase(),e=e.toLowerCase()),o.indexOf(e))}function eF(o){let e=o.split(":"),t,n,i;for(let r of e){let s=Number(r);Gi(s)?n===void 0?n=s:i===void 0&&(i=s):t=t?[t,r].join(":"):r}if(!t)throw new Error("Format for `--goto` should be: `FILE:LINE(:COLUMN)`");return{path:t,line:n!==void 0?n:void 0,column:i!==void 0?i:n!==void 0?1:void 0}}var Le;(_e=>(_e.inMemory="inmemory",_e.vscode="vscode",_e.internal="private",_e.walkThrough="walkThrough",_e.walkThroughSnippet="walkThroughSnippet",_e.http="http",_e.https="https",_e.file="file",_e.mailto="mailto",_e.untitled="untitled",_e.data="data",_e.command="command",_e.vscodeRemote="vscode-remote",_e.vscodeRemoteResource="vscode-remote-resource",_e.vscodeManagedRemoteResource="vscode-managed-remote-resource",_e.vscodeUserData="vscode-userdata",_e.vscodeCustomEditor="vscode-custom-editor",_e.vscodeNotebookCell="vscode-notebook-cell",_e.vscodeNotebookCellMetadata="vscode-notebook-cell-metadata",_e.vscodeNotebookCellMetadataDiff="vscode-notebook-cell-metadata-diff",_e.vscodeNotebookCellOutput="vscode-notebook-cell-output",_e.vscodeNotebookCellOutputDiff="vscode-notebook-cell-output-diff",_e.vscodeNotebookMetadata="vscode-notebook-metadata",_e.vscodeInteractiveInput="vscode-interactive-input",_e.vscodeSettings="vscode-settings",_e.vscodeWorkspaceTrust="vscode-workspace-trust",_e.vscodeTerminal="vscode-terminal",_e.vscodeChatCodeBlock="vscode-chat-code-block",_e.vscodeChatCodeCompareBlock="vscode-chat-code-compare-block",_e.vscodeChatSesssion="vscode-chat-editor",_e.webviewPanel="webview-panel",_e.vscodeWebview="vscode-webview",_e.extension="extension",_e.vscodeFileResource="vscode-file",_e.tmp="tmp",_e.vsls="vsls",_e.vscodeSourceControl="vscode-scm",_e.commentsInput="comment",_e.codeSetting="code-setting",_e.outputChannel="output"))(Le||={});function Cf(o,e){return J.isUri(o)?tr(o.scheme,e):yd(o,e+":")}var p7="tkn",gL=class{_hosts=Object.create(null);_ports=Object.create(null);_connectionTokens=Object.create(null);_preferredWebSchema="http";_delegate=null;_serverRootPath="/";setPreferredWebSchema(e){this._preferredWebSchema=e}setDelegate(e){this._delegate=e}setServerRootPath(e,t){this._serverRootPath=h7(e,t)}getServerRootPath(){return this._serverRootPath}get _remoteResourcesPath(){return bt.join(this._serverRootPath,Le.vscodeRemoteResource)}set(e,t,n){this._hosts[e]=t,this._ports[e]=n}setConnectionToken(e,t){this._connectionTokens[e]=t}getPreferredWebSchema(){return this._preferredWebSchema}rewrite(e){if(this._delegate)try{return this._delegate(e)}catch(a){return qe(a),e}let t=e.authority,n=this._hosts[t];n&&n.indexOf(":")!==-1&&n.indexOf("[")===-1&&(n=`[${n}]`);let i=this._ports[t],r=this._connectionTokens[t],s=`path=${encodeURIComponent(e.path)}`;return typeof r=="string"&&(s+=`&${p7}=${encodeURIComponent(r)}`),J.from({scheme:Hn?this._preferredWebSchema:Le.vscodeRemoteResource,authority:`${n}:${i}`,path:this._remoteResourcesPath,query:s})}},mI=new gL;function h7(o,e){return bt.join(e??"/",`${o.quality??"oss"}-${o.commit??"dev"}`)}var bL="vscode-app",fL=class o{static FALLBACK_AUTHORITY=bL;asBrowserUri(e){let t=this.toUri(e);return this.uriToBrowserUri(t)}uriToBrowserUri(e){return e.scheme===Le.vscodeRemote?mI.rewrite(e):e.scheme===Le.file&&(ca||tA===`${Le.vscodeFileResource}://${o.FALLBACK_AUTHORITY}`)?e.with({scheme:Le.vscodeFileResource,authority:e.authority||o.FALLBACK_AUTHORITY,query:null,fragment:null}):e}asFileUri(e){let t=this.toUri(e);return this.uriToFileUri(t)}uriToFileUri(e){return e.scheme===Le.vscodeFileResource?e.with({scheme:Le.file,authority:e.authority!==o.FALLBACK_AUTHORITY?e.authority:null,query:null,fragment:null}):e}toUri(e,t){if(J.isUri(e))return e;if(globalThis._VSCODE_FILE_ROOT){let n=globalThis._VSCODE_FILE_ROOT;if(/^\w[\w\d+.-]*:\/\//.test(n))return J.joinPath(J.parse(n,!0),e);let i=_r(n,e);return J.file(i)}return J.parse(t.toUrl(e))}},ma=new fL,m7;(r=>{let o=new Map([["1",{"Cross-Origin-Opener-Policy":"same-origin"}],["2",{"Cross-Origin-Embedder-Policy":"require-corp"}],["3",{"Cross-Origin-Opener-Policy":"same-origin","Cross-Origin-Embedder-Policy":"require-corp"}]]);r.CoopAndCoep=Object.freeze(o.get("3"));let t="vscode-coi";function n(s){let a;typeof s=="string"?a=new URL(s).searchParams:s instanceof URL?a=s.searchParams:J.isUri(s)&&(a=new URL(s.toString(!0)).searchParams);let l=a?.get(t);if(l)return o.get(l)}r.getHeadersFromQuery=n;function i(s,a,l){if(!globalThis.crossOriginIsolated)return;let d=a&&l?"3":l?"2":"1";s instanceof URLSearchParams?s.set(t,d):s[t]=d}r.addSearchParam=i})(m7||={});function Cl(o){return ef(o,!0)}var Sf=class{constructor(e){this._ignorePathCasing=e}compare(e,t,n=!1){return e===t?0:lL(this.getComparisonKey(e,n),this.getComparisonKey(t,n))}isEqual(e,t,n=!1){return e===t?!0:!e||!t?!1:this.getComparisonKey(e,n)===this.getComparisonKey(t,n)}getComparisonKey(e,t=!1){return e.with({path:this._ignorePathCasing(e)?e.path.toLowerCase():void 0,fragment:t?null:void 0}).toString()}ignorePathCasing(e){return this._ignorePathCasing(e)}isEqualOrParent(e,t,n=!1){if(e.scheme===t.scheme){if(e.scheme===Le.file)return If(Cl(e),Cl(t),this._ignorePathCasing(e))&&e.query===t.query&&(n||e.fragment===t.fragment);if(tF(e.authority,t.authority))return If(e.path,t.path,this._ignorePathCasing(e),"/")&&e.query===t.query&&(n||e.fragment===t.fragment)}return!1}joinPath(e,...t){return J.joinPath(e,...t)}basenameOrAuthority(e){return go(e)||e.authority}basename(e){return bt.basename(e.path)}extname(e){return bt.extname(e.path)}dirname(e){if(e.path.length===0)return e;let t;return e.scheme===Le.file?t=J.file(By(Cl(e))).path:(t=bt.dirname(e.path),e.authority&&t.length&&t.charCodeAt(0)!==47&&(console.error(`dirname("${e.toString})) resulted in a relative path`),t="/")),e.with({path:t})}normalizePath(e){if(!e.path.length)return e;let t;return e.scheme===Le.file?t=J.file(ad(Cl(e))).path:t=bt.normalize(e.path),e.with({path:t})}relativePath(e,t){if(e.scheme!==t.scheme||!tF(e.authority,t.authority))return;if(e.scheme===Le.file){let r=rA(Cl(e),Cl(t));return pt?hI(r):r}let n=e.path||"/",i=t.path||"/";if(this._ignorePathCasing(e)){let r=0;for(let s=Math.min(n.length,i.length);r<s&&!(n.charCodeAt(r)!==i.charCodeAt(r)&&n.charAt(r).toLowerCase()!==i.charAt(r).toLowerCase());r++);n=i.substr(0,r)+n.substr(r)}return bt.relative(n,i)}resolvePath(e,t){if(e.scheme===Le.file){let n=J.file(Np(Cl(e),t));return e.with({authority:n.authority,path:n.path})}return t=$A(t),e.with({path:bt.resolve(e.path,t)})}isAbsolutePath(e){return!!e.path&&e.path[0]==="/"}isEqualAuthority(e,t){return e===t||e!==void 0&&t!==void 0&&tr(e,t)}hasTrailingPathSeparator(e,t=ui){if(e.scheme===Le.file){let n=Cl(e);return n.length>mL(n).length&&n[n.length-1]===t}else{let n=e.path;return n.length>1&&n.charCodeAt(n.length-1)===47&&!/^[a-zA-Z]:(\/$|\\$)/.test(e.fsPath)}}removeTrailingPathSeparator(e,t=ui){return nF(e,t)?e.with({path:e.path.substr(0,e.path.length-1)}):e}addTrailingPathSeparator(e,t=ui){let n=!1;if(e.scheme===Le.file){let i=Cl(e);n=i!==void 0&&i.length===mL(i).length&&i[i.length-1]===t}else{t="/";let i=e.path;n=i.length===1&&i.charCodeAt(i.length-1)===47}return!n&&!nF(e,t)?e.with({path:e.path+"/"}):e}},Ft=new Sf(()=>!1),g7=new Sf(o=>o.scheme===Le.file?!At:!0),f7=new Sf(o=>!0),nr=Ft.isEqual.bind(Ft),PQ=Ft.isEqualOrParent.bind(Ft),OQ=Ft.getComparisonKey.bind(Ft),b7=Ft.basenameOrAuthority.bind(Ft),go=Ft.basename.bind(Ft),gI=Ft.extname.bind(Ft),Sd=Ft.dirname.bind(Ft),Ct=Ft.joinPath.bind(Ft),NQ=Ft.normalizePath.bind(Ft),fI=Ft.relativePath.bind(Ft),vL=Ft.resolvePath.bind(Ft),AQ=Ft.isAbsolutePath.bind(Ft),tF=Ft.isEqualAuthority.bind(Ft),nF=Ft.hasTrailingPathSeparator.bind(Ft),FQ=Ft.removeTrailingPathSeparator.bind(Ft),BQ=Ft.addTrailingPathSeparator.bind(Ft);var $p;(r=>{r.META_DATA_LABEL="label",r.META_DATA_DESCRIPTION="description",r.META_DATA_SIZE="size",r.META_DATA_MIME="mime";function i(s){let a=new Map;s.path.substring(s.path.indexOf(";")+1,s.path.lastIndexOf(";")).split(";").forEach(c=>{let[u,p]=c.split(":");u&&p&&a.set(u,p)});let d=s.path.substring(0,s.path.indexOf(";"));return d&&a.set(r.META_DATA_MIME,d),a}r.parseMetaData=i})($p||={});var Mo=Y("environmentService"),UQ=Mo;function Ef(o,e){return new yL(o,e)}var yL=class{constructor(e,t){this.reducer=e;this.options=t}state={flowing:!1,ended:!1,destroyed:!1};buffer={data:[],error:[]};listeners={data:[],error:[],end:[]};pendingWritePromises=[];pause(){this.state.destroyed||(this.state.flowing=!1)}resume(){this.state.destroyed||this.state.flowing||(this.state.flowing=!0,this.flowData(),this.flowErrors(),this.flowEnd())}write(e){if(!this.state.destroyed){if(this.state.flowing)this.emitData(e);else if(this.buffer.data.push(e),typeof this.options?.highWaterMark=="number"&&this.buffer.data.length>this.options.highWaterMark)return new Promise(t=>this.pendingWritePromises.push(t))}}error(e){this.state.destroyed||(this.state.flowing?this.emitError(e):this.buffer.error.push(e))}end(e){this.state.destroyed||(typeof e<"u"&&this.write(e),this.state.flowing?(this.emitEnd(),this.destroy()):this.state.ended=!0)}emitData(e){this.listeners.data.slice(0).forEach(t=>t(e))}emitError(e){this.listeners.error.length===0?qe(e):this.listeners.error.slice(0).forEach(t=>t(e))}emitEnd(){this.listeners.end.slice(0).forEach(e=>e())}on(e,t){if(!this.state.destroyed)switch(e){case"data":this.listeners.data.push(t),this.resume();break;case"end":this.listeners.end.push(t),this.state.flowing&&this.flowEnd()&&this.destroy();break;case"error":this.listeners.error.push(t),this.state.flowing&&this.flowErrors();break}}removeListener(e,t){if(this.state.destroyed)return;let n;switch(e){case"data":n=this.listeners.data;break;case"end":n=this.listeners.end;break;case"error":n=this.listeners.error;break}if(n){let i=n.indexOf(t);i>=0&&n.splice(i,1)}}flowData(){if(this.buffer.data.length>0){let e=this.reducer(this.buffer.data);this.emitData(e),this.buffer.data.length=0;let t=[...this.pendingWritePromises];this.pendingWritePromises.length=0,t.forEach(n=>n())}}flowErrors(){if(this.listeners.error.length>0){for(let e of this.buffer.error)this.emitError(e);this.buffer.error.length=0}}flowEnd(){return this.state.ended?(this.emitEnd(),this.listeners.end.length>0):!1}destroy(){this.state.destroyed||(this.state.destroyed=!0,this.state.ended=!0,this.buffer.data.length=0,this.buffer.error.length=0,this.listeners.data.length=0,this.listeners.error.length=0,this.listeners.end.length=0,this.pendingWritePromises.length=0)}};function IL(o,e,t){o.on("error",n=>{t?.isCancellationRequested||e.onError(n)}),o.on("end",()=>{t?.isCancellationRequested||e.onEnd()}),o.on("data",n=>{t?.isCancellationRequested||e.onData(n)})}function iF(o,e){let t=Ef(e);return t.end(o),t}function oF(o){let e=!1;return{read:()=>e?null:(e=!0,o)}}var vI=typeof Buffer<"u",I7=new Qn(()=>new Uint8Array(256)),CL,SL,vt=class o{static alloc(e){return vI?new o(Buffer.allocUnsafe(e)):new o(new Uint8Array(e))}static wrap(e){return vI&&!Buffer.isBuffer(e)&&(e=Buffer.from(e.buffer,e.byteOffset,e.byteLength)),new o(e)}static fromString(e,t){return!(t?.dontUseNodeBuffer||!1)&&vI?new o(Buffer.from(e)):(CL||(CL=new TextEncoder),new o(CL.encode(e)))}static fromByteArray(e){let t=o.alloc(e.length);for(let n=0,i=e.length;n<i;n++)t.buffer[n]=e[n];return t}static concat(e,t){if(typeof t>"u"){t=0;for(let r=0,s=e.length;r<s;r++)t+=e[r].byteLength}let n=o.alloc(t),i=0;for(let r=0,s=e.length;r<s;r++){let a=e[r];n.set(a,i),i+=a.byteLength}return n}buffer;byteLength;constructor(e){this.buffer=e,this.byteLength=this.buffer.byteLength}clone(){let e=o.alloc(this.byteLength);return e.set(this),e}toString(){return vI?this.buffer.toString():(SL||(SL=new TextDecoder),SL.decode(this.buffer))}slice(e,t){return new o(this.buffer.subarray(e,t))}set(e,t){if(e instanceof o)this.buffer.set(e.buffer,t);else if(e instanceof Uint8Array)this.buffer.set(e,t);else if(e instanceof ArrayBuffer)this.buffer.set(new Uint8Array(e),t);else if(ArrayBuffer.isView(e))this.buffer.set(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),t);else throw new Error("Unknown argument 'array'")}readUInt32BE(e){return pi(this.buffer,e)}writeUInt32BE(e,t){hi(this.buffer,e,t)}readUInt32LE(e){return S7(this.buffer,e)}writeUInt32LE(e,t){E7(this.buffer,e,t)}readUInt8(e){return yI(this.buffer,e)}writeUInt8(e,t){II(this.buffer,e,t)}indexOf(e,t=0){return C7(this.buffer,e instanceof o?e.buffer:e,t)}};function C7(o,e,t=0){let n=e.byteLength,i=o.byteLength;if(n===0)return 0;if(n===1)return o.indexOf(e[0]);if(n>i-t)return-1;let r=I7.value;r.fill(e.length);for(let d=0;d<e.length;d++)r[e[d]]=e.length-d-1;let s=t+e.length-1,a=s,l=-1;for(;s<i;)if(o[s]===e[a]){if(a===0){l=s;break}s--,a--}else s+=Math.max(e.length-a,r[o[s]]),a=e.length-1;return l}function rF(o,e){return o[e+0]<<0>>>0|o[e+1]<<8>>>0}function sF(o,e,t){o[t+0]=e&255,e=e>>>8,o[t+1]=e&255}function pi(o,e){return o[e]*2**24+o[e+1]*2**16+o[e+2]*2**8+o[e+3]}function hi(o,e,t){o[t+3]=e,e=e>>>8,o[t+2]=e,e=e>>>8,o[t+1]=e,e=e>>>8,o[t]=e}function S7(o,e){return o[e+0]<<0>>>0|o[e+1]<<8>>>0|o[e+2]<<16>>>0|o[e+3]<<24>>>0}function E7(o,e,t){o[t+0]=e&255,e=e>>>8,o[t+1]=e&255,e=e>>>8,o[t+2]=e&255,e=e>>>8,o[t+3]=e&255}function yI(o,e){return o[e]}function II(o,e,t){o[t]=e}function aF(o){return oF(o)}function lF(o){return iF(o,e=>vt.concat(e))}function TI(o){return!!o&&typeof o.then=="function"}function Sl(o){let e=new zn,t=o(e.token),n=new Promise((i,r)=>{let s=e.token.onCancellationRequested(()=>{s.dispose(),r(new Vi)});Promise.resolve(t).then(a=>{s.dispose(),e.dispose(),i(a)},a=>{s.dispose(),e.dispose(),r(a)})});return new class{cancel(){e.cancel(),e.dispose()}then(i,r){return n.then(i,r)}catch(i){return this.then(void 0,i)}finally(i){return n.finally(i)}}}function xf(o,e,t){return new Promise((n,i)=>{let r=e.onCancellationRequested(()=>{r.dispose(),n(t)});o.then(n,i).finally(()=>r.dispose())})}function cF(){let o,e;return{promise:new Promise((n,i)=>{o=n,e=i}),resolve:o,reject:e}}var TL=class{activePromise;queuedPromise;queuedPromiseFactory;isDisposed=!1;constructor(){this.activePromise=null,this.queuedPromise=null,this.queuedPromiseFactory=null}queue(e){if(this.isDisposed)return Promise.reject(new Error("Throttler is disposed"));if(this.activePromise){if(this.queuedPromiseFactory=e,!this.queuedPromise){let t=()=>{if(this.queuedPromise=null,this.isDisposed)return;let n=this.queue(this.queuedPromiseFactory);return this.queuedPromiseFactory=null,n};this.queuedPromise=new Promise(n=>{this.activePromise.then(t,t).then(n)})}return new Promise((t,n)=>{this.queuedPromise.then(t,n)})}return this.activePromise=e(),new Promise((t,n)=>{this.activePromise.then(i=>{this.activePromise=null,t(i)},i=>{this.activePromise=null,n(i)})})}dispose(){this.isDisposed=!0}};var T7=(o,e)=>{let t=!0,n=setTimeout(()=>{t=!1,e()},o);return{isTriggered:()=>t,dispose:()=>{clearTimeout(n),t=!1}}},x7=o=>{let e=!0;return queueMicrotask(()=>{e&&(e=!1,o())}),{isTriggered:()=>e,dispose:()=>{e=!1}}},Ss=class{constructor(e){this.defaultDelay=e;this.deferred=null,this.completionPromise=null,this.doResolve=null,this.doReject=null,this.task=null}deferred;completionPromise;doResolve;doReject;task;trigger(e,t=this.defaultDelay){this.task=e,this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise((i,r)=>{this.doResolve=i,this.doReject=r}).then(()=>{if(this.completionPromise=null,this.doResolve=null,this.task){let i=this.task;return this.task=null,i()}}));let n=()=>{this.deferred=null,this.doResolve?.(null)};return this.deferred=t===Xy?x7(n):T7(t,n),this.completionPromise}isTriggered(){return!!this.deferred?.isTriggered()}cancel(){this.cancelTimeout(),this.completionPromise&&(this.doReject?.(new Vi),this.completionPromise=null)}cancelTimeout(){this.deferred?.dispose(),this.deferred=null}dispose(){this.cancel()}},Zp=class{delayer;throttler;constructor(e){this.delayer=new Ss(e),this.throttler=new TL}trigger(e,t){return this.delayer.trigger(()=>this.throttler.queue(e),t)}isTriggered(){return this.delayer.isTriggered()}cancel(){this.delayer.cancel()}dispose(){this.delayer.dispose(),this.throttler.dispose()}},Xp=class{_isOpen;_promise;_completePromise;constructor(){this._isOpen=!1,this._promise=new Promise((e,t)=>{this._completePromise=e})}isOpen(){return this._isOpen}open(){this._isOpen=!0,this._completePromise(!0)}wait(){return this._promise}};function wi(o,e){return e?new Promise((t,n)=>{let i=setTimeout(()=>{r.dispose(),t()},o),r=e.onCancellationRequested(()=>{clearTimeout(i),r.dispose(),n(new Vi)})}):Sl(t=>wi(o,t))}function wf(o,e=0,t){let n=setTimeout(()=>{o(),t&&i.dispose()},e),i=le(()=>{clearTimeout(n),t?.deleteAndLeak(i)});return t?.add(i),i}var Es=class{_token;_isDisposed=!1;constructor(e,t){this._token=-1,typeof e=="function"&&typeof t=="number"&&this.setIfNotSet(e,t)}dispose(){this.cancel(),this._isDisposed=!0}cancel(){this._token!==-1&&(clearTimeout(this._token),this._token=-1)}cancelAndSet(e,t){if(this._isDisposed)throw new Ye("Calling 'cancelAndSet' on a disposed TimeoutTimer");this.cancel(),this._token=setTimeout(()=>{this._token=-1,e()},t)}setIfNotSet(e,t){if(this._isDisposed)throw new Ye("Calling 'setIfNotSet' on a disposed TimeoutTimer");this._token===-1&&(this._token=setTimeout(()=>{this._token=-1,e()},t))}},CI=class{disposable=void 0;isDisposed=!1;cancel(){this.disposable?.dispose(),this.disposable=void 0}cancelAndSet(e,t,n=globalThis){if(this.isDisposed)throw new Ye("Calling 'cancelAndSet' on a disposed IntervalTimer");this.cancel();let i=n.setInterval(()=>{e()},t);this.disposable=le(()=>{n.clearInterval(i),this.disposable=void 0})}dispose(){this.cancel(),this.isDisposed=!0}},nn=class{runner;timeoutToken;timeout;timeoutHandler;constructor(e,t){this.timeoutToken=-1,this.runner=e,this.timeout=t,this.timeoutHandler=this.onTimeout.bind(this)}dispose(){this.cancel(),this.runner=null}cancel(){this.isScheduled()&&(clearTimeout(this.timeoutToken),this.timeoutToken=-1)}schedule(e=this.timeout){this.cancel(),this.timeoutToken=setTimeout(this.timeoutHandler,e)}get delay(){return this.timeout}set delay(e){this.timeout=e}isScheduled(){return this.timeoutToken!==-1}flush(){this.isScheduled()&&(this.cancel(),this.doRun())}onTimeout(){this.timeoutToken=-1,this.runner&&this.doRun()}doRun(){this.runner?.()}};var Td,Yp;(function(){typeof globalThis.requestIdleCallback!="function"||typeof globalThis.cancelIdleCallback!="function"?Yp=(o,e)=>{My(()=>{if(t)return;let n=Date.now()+15;e(Object.freeze({didTimeout:!0,timeRemaining(){return Math.max(0,n-Date.now())}}))});let t=!1;return{dispose(){t||(t=!0)}}}:Yp=(o,e,t)=>{let n=o.requestIdleCallback(e,typeof t=="number"?{timeout:t}:void 0),i=!1;return{dispose(){i||(i=!0,o.cancelIdleCallback(n))}}},Td=o=>Yp(globalThis,o)})();var SI=class{_executor;_handle;_didRun=!1;_value;_error;constructor(e,t){this._executor=()=>{try{this._value=t()}catch(n){this._error=n}finally{this._didRun=!0}},this._handle=Yp(e,()=>this._executor())}dispose(){this._handle.dispose()}get value(){if(this._didRun||(this._handle.dispose(),this._executor()),this._error)throw this._error;return this._value}get isInitialized(){return this._didRun}},Tf=class extends SI{constructor(e){super(globalThis,e)}};var EI=class{_running;_queued;isRunning(e){return typeof e=="number"?this._running?.taskId===e:!!this._running}get running(){return this._running?.promise}cancelRunning(){this._running?.cancel()}run(e,t,n){return this._running={taskId:e,cancel:()=>n?.(),promise:t},t.then(()=>this.doneRunning(e),()=>this.doneRunning(e)),t}doneRunning(e){this._running&&e===this._running.taskId&&(this._running=void 0,this.runQueued())}runQueued(){if(this._queued){let e=this._queued;this._queued=void 0,e.run().then(e.promiseResolve,e.promiseReject)}}queue(e){if(this._queued)this._queued.run=e;else{let{promise:t,resolve:n,reject:i}=cF();this._queued={run:e,promise:t,promiseResolve:n,promiseReject:i}}return this._queued.promise}hasQueued(){return!!this._queued}async join(){return this._queued?.promise??this._running?.promise}};var Ed=class{completeCallback;errorCallback;outcome;get isRejected(){return this.outcome?.outcome===1}get isResolved(){return this.outcome?.outcome===0}get isSettled(){return!!this.outcome}get value(){return this.outcome?.outcome===0?this.outcome?.value:void 0}p;constructor(){this.p=new Promise((e,t)=>{this.completeCallback=e,this.errorCallback=t})}complete(e){return new Promise(t=>{this.completeCallback(e),this.outcome={outcome:0,value:e},t()})}error(e){return new Promise(t=>{this.errorCallback(e),this.outcome={outcome:1,value:e},t()})}cancel(){return this.error(new Vi)}},Po;(t=>{async function o(n){let i,r=await Promise.all(n.map(s=>s.then(a=>a,a=>{i||(i=a)})));if(typeof i<"u")throw i;return r}t.settled=o;function e(n){return new Promise(async(i,r)=>{try{await n(i,r)}catch(s){r(s)}})}t.withAsyncBody=e})(Po||={});var dF=class o{static fromArray(e){return new o(t=>{t.emitMany(e)})}static fromPromise(e){return new o(async t=>{t.emitMany(await e)})}static fromPromises(e){return new o(async t=>{await Promise.all(e.map(async n=>t.emitOne(await n)))})}static merge(e){return new o(async t=>{await Promise.all(e.map(async n=>{for await(let i of n)t.emitOne(i)}))})}static EMPTY=o.fromArray([]);_state;_results;_error;_onReturn;_onStateChanged;constructor(e,t){this._state=0,this._results=[],this._error=null,this._onReturn=t,this._onStateChanged=new D,queueMicrotask(async()=>{let n={emitOne:i=>this.emitOne(i),emitMany:i=>this.emitMany(i),reject:i=>this.reject(i)};try{await Promise.resolve(e(n)),this.resolve()}catch(i){this.reject(i)}finally{n.emitOne=void 0,n.emitMany=void 0,n.reject=void 0}})}[Symbol.asyncIterator](){let e=0;return{next:async()=>{do{if(this._state===2)throw this._error;if(e<this._results.length)return{done:!1,value:this._results[e++]};if(this._state===1)return{done:!0,value:void 0};await q.toPromise(this._onStateChanged.event)}while(!0)},return:async()=>(this._onReturn?.(),{done:!0,value:void 0})}}static map(e,t){return new o(async n=>{for await(let i of e)n.emitOne(t(i))})}map(e){return o.map(this,e)}static filter(e,t){return new o(async n=>{for await(let i of e)t(i)&&n.emitOne(i)})}filter(e){return o.filter(this,e)}static coalesce(e){return o.filter(e,t=>!!t)}coalesce(){return o.coalesce(this)}static async toPromise(e){let t=[];for await(let n of e)t.push(n);return t}toPromise(){return o.toPromise(this)}emitOne(e){this._state===0&&(this._results.push(e),this._onStateChanged.fire())}emitMany(e){this._state===0&&(this._results=this._results.concat(e),this._onStateChanged.fire())}resolve(){this._state===0&&(this._state=1,this._onStateChanged.fire())}reject(e){this._state===0&&(this._state=2,this._error=e,this._onStateChanged.fire())}};var xI="**",uF="/",wI="[/\\\\]",_I="[^/\\\\]",w7=/\//g;function pF(o,e){switch(o){case 0:return"";case 1:return`${_I}*?`;default:return`(?:${wI}|${_I}+${wI}${e?`|${wI}${_I}+`:""})*?`}}function hF(o,e){if(!o)return[];let t=[],n=!1,i=!1,r="";for(let s of o){switch(s){case e:if(!n&&!i){t.push(r),r="";continue}break;case"{":n=!0;break;case"}":n=!1;break;case"[":i=!0;break;case"]":i=!1;break}r+=s}return r&&t.push(r),t}function vF(o){if(!o)return"";let e="",t=hF(o,uF);if(t.every(n=>n===xI))e=".*";else{let n=!1;t.forEach((i,r)=>{if(i===xI){if(n)return;e+=pF(2,r===t.length-1)}else{let s=!1,a="",l=!1,d="";for(let c of i){if(c!=="}"&&s){a+=c;continue}if(l&&(c!=="]"||!d)){let u;c==="-"?u=c:(c==="^"||c==="!")&&!d?u="^":c===uF?u="":u=ji(c),d+=u;continue}switch(c){case"{":s=!0;continue;case"[":l=!0;continue;case"}":{let p=`(?:${hF(a,",").map(h=>vF(h)).join("|")})`;e+=p,s=!1,a="";break}case"]":{e+="["+d+"]",l=!1,d="";break}case"?":e+=_I;continue;case"*":e+=pF(1);continue;default:e+=ji(c)}}r<t.length-1&&(t[r+1]!==xI||r+2<t.length)&&(e+=wI)}n=i===xI})}return e}var _7=/^\*\*\/\*\.[\w\.-]+$/,D7=/^\*\*\/([\w\.-]+)\/?$/,L7=/^{\*\*\/\*?[\w\.-]+\/?(,\*\*\/\*?[\w\.-]+\/?)*}$/,R7=/^{\*\*\/\*?[\w\.-]+(\/(\*\*)?)?(,\*\*\/\*?[\w\.-]+(\/(\*\*)?)?)*}$/,k7=/^\*\*((\/[\w\.-]+)+)\/?$/,M7=/^([\w\.-]+(\/[\w\.-]+)*)\/?$/,mF=new Jo(1e4),gF=function(){return!1},ga=function(){return null};function wL(o,e){if(!o)return ga;let t;typeof o!="string"?t=o.pattern:t=o,t=t.trim();let n=`${t}_${!!e.trimForExclusions}`,i=mF.get(n);if(i)return fF(i,o);let r;return _7.test(t)?i=P7(t.substr(4),t):(r=D7.exec(xL(t,e)))?i=O7(r[1],t):(e.trimForExclusions?R7:L7).test(t)?i=N7(t,e):(r=k7.exec(xL(t,e)))?i=bF(r[1].substr(1),t,!0):(r=M7.exec(xL(t,e)))?i=bF(r[1],t,!1):i=A7(t),mF.set(n,i),fF(i,o)}function fF(o,e){if(typeof e=="string")return o;let t=function(n,i){return If(n,e.base,!At)?o(rI(n.substr(e.base.length),ui),i):null};return t.allBasenames=o.allBasenames,t.allPaths=o.allPaths,t.basenames=o.basenames,t.patterns=o.patterns,t}function xL(o,e){return e.trimForExclusions&&o.endsWith("/**")?o.substr(0,o.length-2):o}function P7(o,e){return function(t,n){return typeof t=="string"&&t.endsWith(o)?e:null}}function O7(o,e){let t=`/${o}`,n=`\\${o}`,i=function(s,a){return typeof s!="string"?null:a?a===o?e:null:s===o||s.endsWith(t)||s.endsWith(n)?e:null},r=[o];return i.basenames=r,i.patterns=[e],i.allBasenames=r,i}function N7(o,e){let t=yF(o.slice(1,-1).split(",").map(a=>wL(a,e)).filter(a=>a!==ga),o),n=t.length;if(!n)return ga;if(n===1)return t[0];let i=function(a,l){for(let d=0,c=t.length;d<c;d++)if(t[d](a,l))return o;return null},r=t.find(a=>!!a.allBasenames);r&&(i.allBasenames=r.allBasenames);let s=t.reduce((a,l)=>l.allPaths?a.concat(l.allPaths):a,[]);return s.length&&(i.allPaths=s),i}function bF(o,e,t){let n=ui===bt.sep,i=n?o:o.replace(w7,ui),r=ui+i,s=bt.sep+o,a;return t?a=function(l,d){return typeof l=="string"&&(l===i||l.endsWith(r)||!n&&(l===o||l.endsWith(s)))?e:null}:a=function(l,d){return typeof l=="string"&&(l===i||!n&&l===o)?e:null},a.allPaths=[(t?"*/":"./")+o],a}function A7(o){try{let e=new RegExp(`^${vF(o)}$`);return function(t){return e.lastIndex=0,typeof t=="string"&&e.test(t)?o:null}}catch{return ga}}function _L(o,e={}){if(!o)return gF;if(typeof o=="string"||F7(o)){let t=wL(o,e);if(t===ga)return gF;let n=function(i,r){return!!t(i,r)};return t.allBasenames&&(n.allBasenames=t.allBasenames),t.allPaths&&(n.allPaths=t.allPaths),n}return B7(o,e)}function F7(o){let e=o;return e?typeof e.base=="string"&&typeof e.pattern=="string":!1}function B7(o,e){let t=yF(Object.getOwnPropertyNames(o).map(a=>V7(a,o[a],e)).filter(a=>a!==ga)),n=t.length;if(!n)return ga;if(!t.some(a=>!!a.requiresSiblings)){if(n===1)return t[0];let a=function(c,u){let p;for(let h=0,f=t.length;h<f;h++){let g=t[h](c,u);if(typeof g=="string")return g;TI(g)&&(p||(p=[]),p.push(g))}return p?(async()=>{for(let h of p){let f=await h;if(typeof f=="string")return f}return null})():null},l=t.find(c=>!!c.allBasenames);l&&(a.allBasenames=l.allBasenames);let d=t.reduce((c,u)=>u.allPaths?c.concat(u.allPaths):c,[]);return d.length&&(a.allPaths=d),a}let i=function(a,l,d){let c,u;for(let p=0,h=t.length;p<h;p++){let f=t[p];f.requiresSiblings&&d&&(l||(l=AD(a)),c||(c=l.substr(0,l.length-Vy(a).length)));let g=f(a,l,c,d);if(typeof g=="string")return g;TI(g)&&(u||(u=[]),u.push(g))}return u?(async()=>{for(let p of u){let h=await p;if(typeof h=="string")return h}return null})():null},r=t.find(a=>!!a.allBasenames);r&&(i.allBasenames=r.allBasenames);let s=t.reduce((a,l)=>l.allPaths?a.concat(l.allPaths):a,[]);return s.length&&(i.allPaths=s),i}function V7(o,e,t){if(e===!1)return ga;let n=wL(o,t);if(n===ga)return ga;if(typeof e=="boolean")return n;if(e){let i=e.when;if(typeof i=="string"){let r=(s,a,l,d)=>{if(!d||!n(s,a))return null;let c=i.replace("$(basename)",()=>l),u=d(c);return TI(u)?u.then(p=>p?o:null):u?o:null};return r.requiresSiblings=!0,r}}return n}function yF(o,e){let t=o.filter(a=>!!a.basenames);if(t.length<2)return o;let n=t.reduce((a,l)=>{let d=l.basenames;return d?a.concat(d):a},[]),i;if(e){i=[];for(let a=0,l=n.length;a<l;a++)i.push(e)}else i=t.reduce((a,l)=>{let d=l.patterns;return d?a.concat(d):a},[]);let r=function(a,l){if(typeof a!="string")return null;if(!l){let c;for(c=a.length;c>0;c--){let u=a.charCodeAt(c-1);if(u===47||u===92)break}l=a.substr(c)}let d=n.indexOf(l);return d!==-1?i[d]:null};r.basenames=n,r.patterns=i,r.allBasenames=n;let s=o.filter(a=>!a.basenames);return s.push(r),s}var kJ=new Uint32Array(10);var MJ=new Uint8Array([114,82,115,101,69,102,97,113,81,116,84,100,119,87,99,122,120,118,103]),PJ=new Uint16Array([107,111,105,79,106,112,117,80,104,27496,28520,27752,121,110,27246,28782,27758,98,109,27757,108]),OJ=new Uint16Array([114,82,29810,115,30579,26483,101,102,29286,24934,29030,29798,30822,30310,26470,97,113,29809,116,84,100,119,99,122,120,118,103]),NJ=new Uint16Array([114,82,29810,115,30579,26483,101,69,102,29286,24934,29030,29798,30822,30310,26470,97,113,81,29809,116,84,100,119,87,99,122,120,118,103,107,111,105,79,106,112,117,80,104,27496,28520,27752,121,110,27246,28782,27758,98,109,27757,108]);function CF(...o){return function(e,t){for(let n=0,i=o.length;n<i;n++){let r=o[n](e,t);if(r)return r}return null}}var UJ=SF.bind(void 0,!1),Jc=SF.bind(void 0,!0);function SF(o,e,t){if(!t||t.length<e.length)return null;let n;return o?n=yd(t,e):n=t.indexOf(e)===0,n?e.length>0?[{start:0,end:e.length}]:[]:null}function H7(o,e){let t=e.toLowerCase().indexOf(o.toLowerCase());return t===-1?null:[{start:t,end:t+o.length}]}function U7(o,e){return LL(o.toLowerCase(),e.toLowerCase(),0,0)}function LL(o,e,t,n){if(t===o.length)return[];if(n===e.length)return null;if(o[t]===e[n]){let i=null;return(i=LL(o,e,t+1,n+1))?TF({start:n,end:n+1},i):null}return LL(o,e,t,n+1)}function PL(o){return 97<=o&&o<=122}function Qp(o){return 65<=o&&o<=90}function OL(o){return 48<=o&&o<=57}function z7(o){return o===32||o===9||o===10||o===13}var K7=new Set;"()[]{}<>`'\"-/;:,.?!".split("").forEach(o=>K7.add(o.charCodeAt(0)));function EF(o){return PL(o)||Qp(o)||OL(o)}function TF(o,e){return e.length===0?e=[o]:o.end===e[0].start?e[0].start=o.start:e.unshift(o),e}function xF(o,e){for(let t=e;t<o.length;t++){let n=o.charCodeAt(t);if(Qp(n)||OL(n)||t>0&&!EF(o.charCodeAt(t-1)))return t}return o.length}function RL(o,e,t,n){if(t===o.length)return[];if(n===e.length)return null;if(o[t]!==e[n].toLowerCase())return null;{let i=null,r=n+1;for(i=RL(o,e,t+1,n+1);!i&&(r=xF(e,r))<e.length;)i=RL(o,e,t+1,r),r++;return i===null?null:TF({start:n,end:n+1},i)}}function G7(o){let e=0,t=0,n=0,i=0,r=0;for(let c=0;c<o.length;c++)r=o.charCodeAt(c),Qp(r)&&e++,PL(r)&&t++,EF(r)&&n++,OL(r)&&i++;let s=e/o.length,a=t/o.length,l=n/o.length,d=i/o.length;return{upperPercent:s,lowerPercent:a,alphaPercent:l,numericPercent:d}}function j7(o){let{upperPercent:e,lowerPercent:t}=o;return t===0&&e>.6}function q7(o){let{upperPercent:e,lowerPercent:t,alphaPercent:n,numericPercent:i}=o;return t>.2&&e<.8&&n>.6&&i<.2}function $7(o){let e=0,t=0,n=0,i=0;for(let r=0;r<o.length;r++)n=o.charCodeAt(r),Qp(n)&&e++,PL(n)&&t++,z7(n)&&i++;return(e===0||t===0)&&i===0?o.length<=30:e<=5}function wF(o,e){if(!e||(e=e.trim(),e.length===0)||!$7(o))return null;e.length>60&&(e=e.substring(0,60));let t=G7(e);if(!q7(t)){if(!j7(t))return null;e=e.toLowerCase()}let n=null,i=0;for(o=o.toLowerCase();i<e.length&&(n=RL(o,e,0,i))===null;)i=xF(e,i+1);return n}var zJ=CF(Jc,wF,H7),KJ=CF(Jc,wF,U7),GJ=new Jo(1e4);function _F(o,e){let t=RI(o,o.toLowerCase(),0,e,e.toLowerCase(),0,{firstMatchCanBeWeak:!0,boostFullMatch:!0});return t?DF(t):null}function DF(o){if(typeof o>"u")return[];let e=[],t=o[1];for(let n=o.length-1;n>1;n--){let i=o[n]+t,r=e[e.length-1];r&&r.end===i?r.end=i+1:e.push({start:i,end:i+1})}return e}var wd=128;function NL(){let o=[],e=[];for(let t=0;t<=wd;t++)e[t]=0;for(let t=0;t<=wd;t++)o.push(e.slice(0));return o}function LF(o){let e=[];for(let t=0;t<=o;t++)e[t]=0;return e}var RF=LF(2*wd),kL=LF(2*wd),fa=NL(),xd=NL(),_f=NL(),Y7=!1;function DL(o,e,t,n,i){function r(a,l,d=" "){for(;a.length<l;)a=d+a;return a}let s=` |   |${n.split("").map(a=>r(a,3)).join("|")}
`;for(let a=0;a<=t;a++)a===0?s+=" |":s+=`${e[a-1]}|`,s+=o[a].slice(0,i+1).map(l=>r(l.toString(),3)).join("|")+`
`;return s}function Z7(o,e,t,n){o=o.substr(e),t=t.substr(n),console.log(DL(xd,o,o.length,t,t.length)),console.log(DL(_f,o,o.length,t,t.length)),console.log(DL(fa,o,o.length,t,t.length))}function DI(o,e){if(e<0||e>=o.length)return!1;let t=o.codePointAt(e);switch(t){case 95:case 45:case 46:case 32:case 47:case 92:case 39:case 34:case 58:case 36:case 60:case 62:case 40:case 41:case 91:case 93:case 123:case 125:return!0;case void 0:return!1;default:return!!vf(t)}}function IF(o,e){if(e<0||e>=o.length)return!1;switch(o.charCodeAt(e)){case 32:case 9:return!0;default:return!1}}function LI(o,e,t){return e[o]!==t[o]}function X7(o,e,t,n,i,r,s=!1){for(;e<t&&i<r;)o[e]===n[i]&&(s&&(RF[e]=i),e+=1),i+=1;return e===t}var eu;(t=>{t.Default=[-100,0];function e(n){return!n||n.length===2&&n[0]===-100&&n[1]===0}t.isDefault=e})(eu||={});var ML=class{constructor(e,t){this.firstMatchCanBeWeak=e;this.boostFullMatch=t}static default={boostFullMatch:!0,firstMatchCanBeWeak:!1}};function RI(o,e,t,n,i,r,s=ML.default){let a=o.length>wd?wd:o.length,l=n.length>wd?wd:n.length;if(t>=a||r>=l||a-t>l-r||!X7(e,t,a,i,r,l,!0))return;Q7(a,l,t,r,e,i);let d=1,c=1,u=t,p=r,h=[!1];for(d=1,u=t;u<a;d++,u++){let y=RF[u],S=kL[u],E=u+1<a?kL[u+1]:l;for(c=y-r+1,p=y;p<E;c++,p++){let C=Number.MIN_SAFE_INTEGER,w=!1;p<=S&&(C=J7(o,e,u,t,n,i,p,l,r,fa[d-1][c-1]===0,h));let _=0;C!==Number.MAX_SAFE_INTEGER&&(w=!0,_=C+xd[d-1][c-1]);let L=p>y,k=L?xd[d][c-1]+(fa[d][c-1]>0?-5:0):0,W=p>y+1&&fa[d][c-1]>0,K=W?xd[d][c-2]+(fa[d][c-2]>0?-5:0):0;if(W&&(!L||K>=k)&&(!w||K>=_))xd[d][c]=K,_f[d][c]=3,fa[d][c]=0;else if(L&&(!w||k>=_))xd[d][c]=k,_f[d][c]=2,fa[d][c]=0;else if(w)xd[d][c]=_,_f[d][c]=1,fa[d][c]=fa[d-1][c-1]+1;else throw new Error("not possible")}}if(Y7&&Z7(o,t,n,r),!h[0]&&!s.firstMatchCanBeWeak)return;d--,c--;let f=[xd[d][c],r],g=0,b=0;for(;d>=1;){let y=c;do{let S=_f[d][y];if(S===3)y=y-2;else if(S===2)y=y-1;else break}while(y>=1);g>1&&e[t+d-1]===i[r+c-1]&&!LI(y+r-1,n,i)&&g+1>fa[d][y]&&(y=c),y===c?g++:g=1,b||(b=y),d--,c=y-1,f.push(c)}l-r===a&&s.boostFullMatch&&(f[0]+=2);let v=b-a;return f[0]-=v,f}function Q7(o,e,t,n,i,r){let s=o-1,a=e-1;for(;s>=t&&a>=n;)i[s]===r[a]&&(kL[s]=a,s--),a--}function J7(o,e,t,n,i,r,s,a,l,d,c){if(e[t]!==r[s])return Number.MIN_SAFE_INTEGER;let u=1,p=!1;return s===t-n?u=o[t]===i[s]?7:5:LI(s,i,r)&&(s===0||!LI(s-1,i,r))?(u=o[t]===i[s]?7:5,p=!0):DI(r,s)&&(s===0||!DI(r,s-1))?u=5:(DI(r,s-1)||IF(r,s-1))&&(u=5,p=!0),u>1&&t===n&&(c[0]=!0),p||(p=LI(s,i,r)||DI(r,s-1)||IF(r,s-1)),t===n?s>l&&(u-=p?3:5):d?u+=p?2:0:u+=p?0:1,s+1===a&&(u-=p?3:5),u}var AL=new RegExp(`\\$\\(${we.iconNameExpression}(?:${we.iconModifierExpression})?\\)`,"g"),e9=new RegExp(`(\\\\)?${AL.source}`,"g");function kF(o){return o.replace(e9,(e,t)=>t?e:`\\${e}`)}var t9=new RegExp(`\\\\${AL.source}`,"g");function MF(o){return o.replace(t9,e=>`\\${e}`)}var QJ=new RegExp(`(\\s)?(\\\\)?${AL.source}(\\s)?`,"g");var JJ=new RegExp(`\\$\\(${we.iconNameCharacter}+\\)`,"g");var kI=class{value;isTrusted;supportThemeIcons;supportHtml;baseUri;constructor(e="",t=!1){if(this.value=e,typeof this.value!="string")throw Wc("value");typeof t=="boolean"?(this.isTrusted=t,this.supportThemeIcons=!1,this.supportHtml=!1):(this.isTrusted=t.isTrusted??void 0,this.supportThemeIcons=t.supportThemeIcons??!1,this.supportHtml=t.supportHtml??!1)}appendText(e,t=0){return this.value+=n9(this.supportThemeIcons?kF(e):e).replace(/([ \t]+)/g,(n,i)=>"&nbsp;".repeat(i.length)).replace(/\>/gm,"\\>").replace(/\n/g,t===1?`\\
`:`

`),this}appendMarkdown(e){return this.value+=e,this}appendCodeblock(e,t){return this.value+=`
${i9(t,e)}
`,this}appendLink(e,t,n){return this.value+="[",this.value+=this._escape(t,"]"),this.value+="](",this.value+=this._escape(String(e),")"),n&&(this.value+=` "${this._escape(this._escape(n,'"'),")")}"`),this.value+=")",this}_escape(e,t){let n=new RegExp(ji(t),"g");return e.replace(n,(i,r)=>e.charAt(r-1)!=="\\"?`\\${i}`:i)}};function n9(o){return o.replace(/[\\`*_{}[\]()#+\-!~]/g,"\\$&")}function i9(o,e){let t=o.match(/^`+/gm)?.reduce((i,r)=>i.length>r.length?i:r).length??0,n=t>=3?t+1:3;return[`${"`".repeat(n)}${e}`,o,`${"`".repeat(n)}`].join(`
`)}function Df(o){return o.replace(/"/g,"&quot;")}function MI(o){return o&&o.replace(/\\([\\`*_{}[\]()#+\-.!~])/g,"$1")}function PF(o){let e=[],t=o.split("|").map(i=>i.trim());o=t[0];let n=t[1];if(n){let i=/height=(\d+)/.exec(n),r=/width=(\d+)/.exec(n),s=i?i[1]:"",a=r?r[1]:"",l=isFinite(parseInt(a)),d=isFinite(parseInt(s));l&&e.push(`width="${a}"`),d&&e.push(`height="${s}"`)}return{href:o,dimensions:e}}var Bt=Y("fileService");function OF(o){return!!(o.capabilities&2048)}var PI=class o extends Error{constructor(t,n){super(t);this.code=n}static create(t,n){let i=new o(t.toString(),n);return r9(i,n),i}};function kr(o,e){return PI.create(o,e)}function r9(o,e){return o.name=e?`${e} (FileSystemError)`:"FileSystemError",o}function s9(o){if(!o)return"Unknown";if(o instanceof PI)return o.code;let e=/^(.+) \(FileSystemError\)$/.exec(o.name);if(!e)return"Unknown";switch(e[1]){case"EntryExists":return"EntryExists";case"EntryIsADirectory":return"EntryIsADirectory";case"EntryNotADirectory":return"EntryNotADirectory";case"EntryNotFound":return"EntryNotFound";case"EntryTooLarge":return"EntryTooLarge";case"EntryWriteLocked":return"EntryWriteLocked";case"NoPermissions":return"NoPermissions";case"Unavailable":return"Unavailable"}return"Unknown"}function NF(o){if(o instanceof ir)return o.fileOperationResult;switch(s9(o)){case"EntryNotFound":return 1;case"EntryIsADirectory":return 0;case"EntryNotADirectory":return 9;case"EntryWriteLocked":return 5;case"NoPermissions":return 6;case"EntryExists":return 4;case"EntryTooLarge":return 7;default:return 10}}var ir=class extends Error{constructor(t,n,i){super(t);this.fileOperationResult=n;this.options=i}},OI=class extends ir{constructor(t,n,i,r){super(t,n,r);this.fileOperationResult=n;this.size=i}},NI=class extends ir{constructor(t,n,i){super(t,2,i);this.stat=n}};var Ts={OFF:"off",AFTER_DELAY:"afterDelay",ON_FOCUS_CHANGE:"onFocusChange",ON_WINDOW_CHANGE:"onWindowChange"},Jp={OFF:"off",ON_EXIT:"onExit",ON_EXIT_AND_WINDOW_CLOSE:"onExitAndWindowClose"};var AF="files.readonlyInclude",FF="files.readonlyExclude";var Lf="";var AI=class o{static KB=1024;static MB=o.KB*o.KB;static GB=o.MB*o.KB;static TB=o.GB*o.KB;static formatSize(e){return Gi(e)||(e=0),e<o.KB?m("sizeB","{0}B",e.toFixed(0)):e<o.MB?m("sizeKB","{0}KB",(e/o.KB).toFixed(2)):e<o.GB?m("sizeMB","{0}MB",(e/o.MB).toFixed(2)):e<o.TB?m("sizeGB","{0}GB",(e/o.GB).toFixed(2)):m("sizeTB","{0}TB",(e/o.TB).toFixed(2))}};function FL(o,e){return e&&(o.stack||o.stacktrace)?m("stackTrace.format","{0}: {1}",VF(o),BF(o.stack)||BF(o.stacktrace)):VF(o)}function BF(o){return Array.isArray(o)?o.join(`
`):o}function VF(o){return o.code==="ERR_UNC_HOST_NOT_ALLOWED"?`${o.message}. Please update the 'security.allowedUNCHosts' setting if you want to allow this host.`:typeof o.code=="string"&&typeof o.errno=="number"&&typeof o.syscall=="string"?m("nodeExceptionMessage","A system error occurred ({0})",o.message):o.message||m("error.defaultMessage","An unknown error occurred. Please consult the log for more details.")}function FI(o=null,e=!1){if(!o)return m("error.defaultMessage","An unknown error occurred. Please consult the log for more details.");if(Array.isArray(o)){let t=Er(o),n=FI(t[0],e);return t.length>1?m("error.moreErrors","{0} ({1} errors in total)",n,t.length):n}if(In(o))return o;if(o.detail){let t=o.detail;if(t.error)return FL(t.error,e);if(t.exception)return FL(t.exception,e)}return o.stack?FL(o,e):o.message?o.message:m("error.defaultMessage","An unknown error occurred. Please consult the log for more details.")}function BL(o){let e=o;return e instanceof Error&&Array.isArray(e.actions)}function WF(o,e){let t;return typeof o=="string"?t=new Error(o):t=o,t.actions=e,t}function VL(...o){switch(o.length){case 1:return m("contextkey.scanner.hint.didYouMean1","Did you mean {0}?",o[0]);case 2:return m("contextkey.scanner.hint.didYouMean2","Did you mean {0} or {1}?",o[0],o[1]);case 3:return m("contextkey.scanner.hint.didYouMean3","Did you mean {0}, {1} or {2}?",o[0],o[1],o[2]);default:return}}var a9=m("contextkey.scanner.hint.didYouForgetToOpenOrCloseQuote","Did you forget to open or close the quote?"),l9=m("contextkey.scanner.hint.didYouForgetToEscapeSlash","Did you forget to escape the '/' (slash) character? Put two backslashes before it to escape, e.g., '\\\\/'."),_d=class o{static getLexeme(e){switch(e.type){case 0:return"(";case 1:return")";case 2:return"!";case 3:return e.isTripleEq?"===":"==";case 4:return e.isTripleEq?"!==":"!=";case 5:return"<";case 6:return"<=";case 7:return">=";case 8:return">=";case 9:return"=~";case 10:return e.lexeme;case 11:return"true";case 12:return"false";case 13:return"in";case 14:return"not";case 15:return"&&";case 16:return"||";case 17:return e.lexeme;case 18:return e.lexeme;case 19:return e.lexeme;case 20:return"EOF";default:throw VN(`unhandled token type: ${JSON.stringify(e)}; have you forgotten to add a case?`)}}static _regexFlags=new Set(["i","g","s","m","y","u"].map(e=>e.charCodeAt(0)));static _keywords=new Map([["not",14],["in",13],["false",12],["true",11]]);_input="";_start=0;_current=0;_tokens=[];_errors=[];get errors(){return this._errors}reset(e){return this._input=e,this._start=0,this._current=0,this._tokens=[],this._errors=[],this}scan(){for(;!this._isAtEnd();)switch(this._start=this._current,this._advance()){case 40:this._addToken(0);break;case 41:this._addToken(1);break;case 33:if(this._match(61)){let t=this._match(61);this._tokens.push({type:4,offset:this._start,isTripleEq:t})}else this._addToken(2);break;case 39:this._quotedString();break;case 47:this._regex();break;case 61:if(this._match(61)){let t=this._match(61);this._tokens.push({type:3,offset:this._start,isTripleEq:t})}else this._match(126)?this._addToken(9):this._error(VL("==","=~"));break;case 60:this._addToken(this._match(61)?6:5);break;case 62:this._addToken(this._match(61)?8:7);break;case 38:this._match(38)?this._addToken(15):this._error(VL("&&"));break;case 124:this._match(124)?this._addToken(16):this._error(VL("||"));break;case 32:case 13:case 9:case 10:case 160:break;default:this._string()}return this._start=this._current,this._addToken(20),Array.from(this._tokens)}_match(e){return this._isAtEnd()||this._input.charCodeAt(this._current)!==e?!1:(this._current++,!0)}_advance(){return this._input.charCodeAt(this._current++)}_peek(){return this._isAtEnd()?0:this._input.charCodeAt(this._current)}_addToken(e){this._tokens.push({type:e,offset:this._start})}_error(e){let t=this._start,n=this._input.substring(this._start,this._current),i={type:19,offset:this._start,lexeme:n};this._errors.push({offset:t,lexeme:n,additionalInfo:e}),this._tokens.push(i)}stringRe=/[a-zA-Z0-9_<>\-\./\\:\*\?\+\[\]\^,#@;"%\$\p{L}-]+/uy;_string(){this.stringRe.lastIndex=this._start;let e=this.stringRe.exec(this._input);if(e){this._current=this._start+e[0].length;let t=this._input.substring(this._start,this._current),n=o._keywords.get(t);n?this._addToken(n):this._tokens.push({type:17,lexeme:t,offset:this._start})}}_quotedString(){for(;this._peek()!==39&&!this._isAtEnd();)this._advance();if(this._isAtEnd()){this._error(a9);return}this._advance(),this._tokens.push({type:18,lexeme:this._input.substring(this._start+1,this._current-1),offset:this._start+1})}_regex(){let e=this._current,t=!1,n=!1;for(;;){if(e>=this._input.length){this._current=e,this._error(l9);return}let r=this._input.charCodeAt(e);if(t)t=!1;else if(r===47&&!n){e++;break}else r===91?n=!0:r===92?t=!0:r===93&&(n=!1);e++}for(;e<this._input.length&&o._regexFlags.has(this._input.charCodeAt(e));)e++;this._current=e;let i=this._input.substring(this._start,this._current);this._tokens.push({type:10,lexeme:i,offset:this._start})}_isAtEnd(){return this._current>=this._input.length}};var _i=new Map;_i.set("false",!1);_i.set("true",!0);_i.set("isMac",Ve);_i.set("isLinux",At);_i.set("isWindows",pt);_i.set("isWeb",Hn);_i.set("isMacNative",Ve&&!Hn);_i.set("isEdge",Oy);_i.set("isFirefox",Op);_i.set("isChrome",Qg);_i.set("isSafari",Py);var d9=Object.prototype.hasOwnProperty;var c9={regexParsingWithErrorRecovery:!0},u9=m("contextkey.parser.error.emptyString","Empty context key expression"),p9=m("contextkey.parser.error.emptyString.hint","Did you forget to write an expression? You can also put 'false' or 'true' to always evaluate to false or true, respectively."),h9=m("contextkey.parser.error.noInAfterNot","'in' after 'not'."),HF=m("contextkey.parser.error.closingParenthesis","closing parenthesis ')'"),m9=m("contextkey.parser.error.unexpectedToken","Unexpected token"),g9=m("contextkey.parser.error.unexpectedToken.hint","Did you forget to put && or || before the token?"),f9=m("contextkey.parser.error.unexpectedEOF","Unexpected end of expression"),b9=m("contextkey.parser.error.unexpectedEOF.hint","Did you forget to put a context key?"),WL=class o{constructor(e=c9){this._config=e}static _parseError=new Error;_scanner=new _d;_tokens=[];_current=0;_parsingErrors=[];get lexingErrors(){return this._scanner.errors}get parsingErrors(){return this._parsingErrors}parse(e){if(e===""){this._parsingErrors.push({message:u9,offset:0,lexeme:"",additionalInfo:p9});return}this._tokens=this._scanner.reset(e).scan(),this._current=0,this._parsingErrors=[];try{let t=this._expr();if(!this._isAtEnd()){let n=this._peek(),i=n.type===17?g9:void 0;throw this._parsingErrors.push({message:m9,offset:n.offset,lexeme:_d.getLexeme(n),additionalInfo:i}),o._parseError}return t}catch(t){if(t!==o._parseError)throw t;return}}_expr(){return this._or()}_or(){let e=[this._and()];for(;this._matchOne(16);){let t=this._and();e.push(t)}return e.length===1?e[0]:Kt.or(...e)}_and(){let e=[this._term()];for(;this._matchOne(15);){let t=this._term();e.push(t)}return e.length===1?e[0]:Kt.and(...e)}_term(){if(this._matchOne(2)){let e=this._peek();switch(e.type){case 11:return this._advance(),Qi.INSTANCE;case 12:return this._advance(),fo.INSTANCE;case 0:{this._advance();let t=this._expr();return this._consume(1,HF),t?.negate()}case 17:return this._advance(),nu.create(e.lexeme);default:throw this._errExpectedButGot("KEY | true | false | '(' expression ')'",e)}}return this._primary()}_primary(){let e=this._peek();switch(e.type){case 11:return this._advance(),Kt.true();case 12:return this._advance(),Kt.false();case 0:{this._advance();let t=this._expr();return this._consume(1,HF),t}case 17:{let t=e.lexeme;if(this._advance(),this._matchOne(9)){let i=this._peek();if(!this._config.regexParsingWithErrorRecovery){if(this._advance(),i.type!==10)throw this._errExpectedButGot("REGEX",i);let r=i.lexeme,s=r.lastIndexOf("/"),a=s===r.length-1?void 0:this._removeFlagsGY(r.substring(s+1)),l;try{l=new RegExp(r.substring(1,s),a)}catch{throw this._errExpectedButGot("REGEX",i)}return Ff.create(t,l)}switch(i.type){case 10:case 19:{let r=[i.lexeme];this._advance();let s=this._peek(),a=0;for(let p=0;p<i.lexeme.length;p++)i.lexeme.charCodeAt(p)===40?a++:i.lexeme.charCodeAt(p)===41&&a--;for(;!this._isAtEnd()&&s.type!==15&&s.type!==16;){switch(s.type){case 0:a++;break;case 1:a--;break;case 10:case 18:for(let p=0;p<s.lexeme.length;p++)s.lexeme.charCodeAt(p)===40?a++:i.lexeme.charCodeAt(p)===41&&a--}if(a<0)break;r.push(_d.getLexeme(s)),this._advance(),s=this._peek()}let l=r.join(""),d=l.lastIndexOf("/"),c=d===l.length-1?void 0:this._removeFlagsGY(l.substring(d+1)),u;try{u=new RegExp(l.substring(1,d),c)}catch{throw this._errExpectedButGot("REGEX",i)}return Kt.regex(t,u)}case 18:{let r=i.lexeme;this._advance();let s=null;if(!BA(r)){let a=r.indexOf("/"),l=r.lastIndexOf("/");if(a!==l&&a>=0){let d=r.slice(a+1,l),c=r[l+1]==="i"?"i":"";try{s=new RegExp(d,c)}catch{throw this._errExpectedButGot("REGEX",i)}}}if(s===null)throw this._errExpectedButGot("REGEX",i);return Ff.create(t,s)}default:throw this._errExpectedButGot("REGEX",this._peek())}}if(this._matchOne(14)){this._consume(13,h9);let i=this._value();return Kt.notIn(t,i)}switch(this._peek().type){case 3:{this._advance();let i=this._value();if(this._previous().type===18)return Kt.equals(t,i);switch(i){case"true":return Kt.has(t);case"false":return Kt.not(t);default:return Kt.equals(t,i)}}case 4:{this._advance();let i=this._value();if(this._previous().type===18)return Kt.notEquals(t,i);switch(i){case"true":return Kt.not(t);case"false":return Kt.has(t);default:return Kt.notEquals(t,i)}}case 5:return this._advance(),Nf.create(t,this._value());case 6:return this._advance(),Af.create(t,this._value());case 7:return this._advance(),Pf.create(t,this._value());case 8:return this._advance(),Of.create(t,this._value());case 13:return this._advance(),Kt.in(t,this._value());default:return Kt.has(t)}}case 20:throw this._parsingErrors.push({message:f9,offset:e.offset,lexeme:"",additionalInfo:b9}),o._parseError;default:throw this._errExpectedButGot(`true | false | KEY 
	| KEY '=~' REGEX 
	| KEY ('==' | '!=' | '<' | '<=' | '>' | '>=' | 'in' | 'not' 'in') value`,this._peek())}}_value(){let e=this._peek();switch(e.type){case 17:case 18:return this._advance(),e.lexeme;case 11:return this._advance(),"true";case 12:return this._advance(),"false";case 13:return this._advance(),"in";default:return""}}_flagsGYRe=/g|y/g;_removeFlagsGY(e){return e.replaceAll(this._flagsGYRe,"")}_previous(){return this._tokens[this._current-1]}_matchOne(e){return this._check(e)?(this._advance(),!0):!1}_advance(){return this._isAtEnd()||this._current++,this._previous()}_consume(e,t){if(this._check(e))return this._advance();throw this._errExpectedButGot(t,this._peek())}_errExpectedButGot(e,t,n){let i=m("contextkey.parser.error.expectedButGot",`Expected: {0}
Received: '{1}'.`,e,_d.getLexeme(t)),r=t.offset,s=_d.getLexeme(t);return this._parsingErrors.push({message:i,offset:r,lexeme:s,additionalInfo:n}),o._parseError}_check(e){return this._peek().type===e}_peek(){return this._tokens[this._current]}_isAtEnd(){return this._peek().type===20}},Kt=class{static false(){return Qi.INSTANCE}static true(){return fo.INSTANCE}static has(e){return tu.create(e)}static equals(e,t){return kf.create(e,t)}static notEquals(e,t){return Mf.create(e,t)}static regex(e,t){return Ff.create(e,t)}static in(e,t){return BI.create(e,t)}static notIn(e,t){return VI.create(e,t)}static not(e){return nu.create(e)}static and(...e){return WI.create(e,null,!0)}static or(...e){return Bf.create(e,null,!0)}static greater(e,t){return Pf.create(e,t)}static greaterEquals(e,t){return Of.create(e,t)}static smaller(e,t){return Nf.create(e,t)}static smallerEquals(e,t){return Af.create(e,t)}static _parser=new WL({regexParsingWithErrorRecovery:!1});static deserialize(e){return e==null?void 0:this._parser.parse(e)}};function Rf(o,e){return o.cmp(e)}var Qi=class o{static INSTANCE=new o;type=0;constructor(){}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}substituteConstants(){return this}evaluate(e){return!1}serialize(){return"false"}keys(){return[]}map(e){return this}negate(){return fo.INSTANCE}},fo=class o{static INSTANCE=new o;type=1;constructor(){}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}substituteConstants(){return this}evaluate(e){return!0}serialize(){return"true"}keys(){return[]}map(e){return this}negate(){return Qi.INSTANCE}},tu=class o{constructor(e,t){this.key=e;this.negated=t}static create(e,t=null){let n=_i.get(e);return typeof n=="boolean"?n?fo.INSTANCE:Qi.INSTANCE:new o(e,t)}type=2;cmp(e){return e.type!==this.type?this.type-e.type:KF(this.key,e.key)}equals(e){return e.type===this.type?this.key===e.key:!1}substituteConstants(){let e=_i.get(this.key);return typeof e=="boolean"?e?fo.INSTANCE:Qi.INSTANCE:this}evaluate(e){return!!e.getValue(this.key)}serialize(){return this.key}keys(){return[this.key]}map(e){return e.mapDefined(this.key)}negate(){return this.negated||(this.negated=nu.create(this.key,this)),this.negated}},kf=class o{constructor(e,t,n){this.key=e;this.value=t;this.negated=n}static create(e,t,n=null){if(typeof t=="boolean")return t?tu.create(e,n):nu.create(e,n);let i=_i.get(e);return typeof i=="boolean"?t===(i?"true":"false")?fo.INSTANCE:Qi.INSTANCE:new o(e,t,n)}type=4;cmp(e){return e.type!==this.type?this.type-e.type:iu(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){let e=_i.get(this.key);if(typeof e=="boolean"){let t=e?"true":"false";return this.value===t?fo.INSTANCE:Qi.INSTANCE}return this}evaluate(e){return e.getValue(this.key)==this.value}serialize(){return`${this.key} == '${this.value}'`}keys(){return[this.key]}map(e){return e.mapEquals(this.key,this.value)}negate(){return this.negated||(this.negated=Mf.create(this.key,this.value,this)),this.negated}},BI=class o{constructor(e,t){this.key=e;this.valueKey=t}static create(e,t){return new o(e,t)}type=10;negated=null;cmp(e){return e.type!==this.type?this.type-e.type:iu(this.key,this.valueKey,e.key,e.valueKey)}equals(e){return e.type===this.type?this.key===e.key&&this.valueKey===e.valueKey:!1}substituteConstants(){return this}evaluate(e){let t=e.getValue(this.valueKey),n=e.getValue(this.key);return Array.isArray(t)?t.includes(n):typeof n=="string"&&typeof t=="object"&&t!==null?d9.call(t,n):!1}serialize(){return`${this.key} in '${this.valueKey}'`}keys(){return[this.key,this.valueKey]}map(e){return e.mapIn(this.key,this.valueKey)}negate(){return this.negated||(this.negated=VI.create(this.key,this.valueKey)),this.negated}},VI=class o{constructor(e,t){this.key=e;this.valueKey=t;this._negated=BI.create(e,t)}static create(e,t){return new o(e,t)}type=11;_negated;cmp(e){return e.type!==this.type?this.type-e.type:this._negated.cmp(e._negated)}equals(e){return e.type===this.type?this._negated.equals(e._negated):!1}substituteConstants(){return this}evaluate(e){return!this._negated.evaluate(e)}serialize(){return`${this.key} not in '${this.valueKey}'`}keys(){return this._negated.keys()}map(e){return e.mapNotIn(this.key,this.valueKey)}negate(){return this._negated}},Mf=class o{constructor(e,t,n){this.key=e;this.value=t;this.negated=n}static create(e,t,n=null){if(typeof t=="boolean")return t?nu.create(e,n):tu.create(e,n);let i=_i.get(e);return typeof i=="boolean"?t===(i?"true":"false")?Qi.INSTANCE:fo.INSTANCE:new o(e,t,n)}type=5;cmp(e){return e.type!==this.type?this.type-e.type:iu(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){let e=_i.get(this.key);if(typeof e=="boolean"){let t=e?"true":"false";return this.value===t?Qi.INSTANCE:fo.INSTANCE}return this}evaluate(e){return e.getValue(this.key)!=this.value}serialize(){return`${this.key} != '${this.value}'`}keys(){return[this.key]}map(e){return e.mapNotEquals(this.key,this.value)}negate(){return this.negated||(this.negated=kf.create(this.key,this.value,this)),this.negated}},nu=class o{constructor(e,t){this.key=e;this.negated=t}static create(e,t=null){let n=_i.get(e);return typeof n=="boolean"?n?Qi.INSTANCE:fo.INSTANCE:new o(e,t)}type=3;cmp(e){return e.type!==this.type?this.type-e.type:KF(this.key,e.key)}equals(e){return e.type===this.type?this.key===e.key:!1}substituteConstants(){let e=_i.get(this.key);return typeof e=="boolean"?e?Qi.INSTANCE:fo.INSTANCE:this}evaluate(e){return!e.getValue(this.key)}serialize(){return`!${this.key}`}keys(){return[this.key]}map(e){return e.mapNot(this.key)}negate(){return this.negated||(this.negated=tu.create(this.key,this)),this.negated}};function HI(o,e){if(typeof o=="string"){let t=parseFloat(o);isNaN(t)||(o=t)}return typeof o=="string"||typeof o=="number"?e(o):Qi.INSTANCE}var Pf=class o{constructor(e,t,n){this.key=e;this.value=t;this.negated=n}static create(e,t,n=null){return HI(t,i=>new o(e,i,n))}type=12;cmp(e){return e.type!==this.type?this.type-e.type:iu(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))>this.value}serialize(){return`${this.key} > ${this.value}`}keys(){return[this.key]}map(e){return e.mapGreater(this.key,this.value)}negate(){return this.negated||(this.negated=Af.create(this.key,this.value,this)),this.negated}},Of=class o{constructor(e,t,n){this.key=e;this.value=t;this.negated=n}static create(e,t,n=null){return HI(t,i=>new o(e,i,n))}type=13;cmp(e){return e.type!==this.type?this.type-e.type:iu(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))>=this.value}serialize(){return`${this.key} >= ${this.value}`}keys(){return[this.key]}map(e){return e.mapGreaterEquals(this.key,this.value)}negate(){return this.negated||(this.negated=Nf.create(this.key,this.value,this)),this.negated}},Nf=class o{constructor(e,t,n){this.key=e;this.value=t;this.negated=n}static create(e,t,n=null){return HI(t,i=>new o(e,i,n))}type=14;cmp(e){return e.type!==this.type?this.type-e.type:iu(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))<this.value}serialize(){return`${this.key} < ${this.value}`}keys(){return[this.key]}map(e){return e.mapSmaller(this.key,this.value)}negate(){return this.negated||(this.negated=Of.create(this.key,this.value,this)),this.negated}},Af=class o{constructor(e,t,n){this.key=e;this.value=t;this.negated=n}static create(e,t,n=null){return HI(t,i=>new o(e,i,n))}type=15;cmp(e){return e.type!==this.type?this.type-e.type:iu(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))<=this.value}serialize(){return`${this.key} <= ${this.value}`}keys(){return[this.key]}map(e){return e.mapSmallerEquals(this.key,this.value)}negate(){return this.negated||(this.negated=Pf.create(this.key,this.value,this)),this.negated}},Ff=class o{constructor(e,t){this.key=e;this.regexp=t}static create(e,t){return new o(e,t)}type=7;negated=null;cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.key<e.key)return-1;if(this.key>e.key)return 1;let t=this.regexp?this.regexp.source:"",n=e.regexp?e.regexp.source:"";return t<n?-1:t>n?1:0}equals(e){if(e.type===this.type){let t=this.regexp?this.regexp.source:"",n=e.regexp?e.regexp.source:"";return this.key===e.key&&t===n}return!1}substituteConstants(){return this}evaluate(e){let t=e.getValue(this.key);return this.regexp?this.regexp.test(t):!1}serialize(){let e=this.regexp?`/${this.regexp.source}/${this.regexp.flags}`:"/invalid/";return`${this.key} =~ ${e}`}keys(){return[this.key]}map(e){return e.mapRegex(this.key,this.regexp)}negate(){return this.negated||(this.negated=HL.create(this)),this.negated}},HL=class o{constructor(e){this._actual=e}static create(e){return new o(e)}type=8;cmp(e){return e.type!==this.type?this.type-e.type:this._actual.cmp(e._actual)}equals(e){return e.type===this.type?this._actual.equals(e._actual):!1}substituteConstants(){return this}evaluate(e){return!this._actual.evaluate(e)}serialize(){return`!(${this._actual.serialize()})`}keys(){return this._actual.keys()}map(e){return new o(this._actual.map(e))}negate(){return this._actual}};function zF(o){let e=null;for(let t=0,n=o.length;t<n;t++){let i=o[t].substituteConstants();if(o[t]!==i&&e===null){e=[];for(let r=0;r<t;r++)e[r]=o[r]}e!==null&&(e[t]=i)}return e===null?o:e}var WI=class o{constructor(e,t){this.expr=e;this.negated=t}static create(e,t,n){return o._normalizeArr(e,t,n)}type=6;cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.expr.length<e.expr.length)return-1;if(this.expr.length>e.expr.length)return 1;for(let t=0,n=this.expr.length;t<n;t++){let i=Rf(this.expr[t],e.expr[t]);if(i!==0)return i}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length)return!1;for(let t=0,n=this.expr.length;t<n;t++)if(!this.expr[t].equals(e.expr[t]))return!1;return!0}return!1}substituteConstants(){let e=zF(this.expr);return e===this.expr?this:o.create(e,this.negated,!1)}evaluate(e){for(let t=0,n=this.expr.length;t<n;t++)if(!this.expr[t].evaluate(e))return!1;return!0}static _normalizeArr(e,t,n){let i=[],r=!1;for(let s of e)if(s){if(s.type===1){r=!0;continue}if(s.type===0)return Qi.INSTANCE;if(s.type===6){i.push(...s.expr);continue}i.push(s)}if(i.length===0&&r)return fo.INSTANCE;if(i.length!==0){if(i.length===1)return i[0];i.sort(Rf);for(let s=1;s<i.length;s++)i[s-1].equals(i[s])&&(i.splice(s,1),s--);if(i.length===1)return i[0];for(;i.length>1;){let s=i[i.length-1];if(s.type!==9)break;i.pop();let a=i.pop(),l=i.length===0,d=Bf.create(s.expr.map(c=>o.create([c,a],null,n)),null,l);d&&(i.push(d),i.sort(Rf))}if(i.length===1)return i[0];if(n){for(let s=0;s<i.length;s++)for(let a=s+1;a<i.length;a++)if(i[s].negate().equals(i[a]))return Qi.INSTANCE;if(i.length===1)return i[0]}return new o(i,t)}}serialize(){return this.expr.map(e=>e.serialize()).join(" && ")}keys(){let e=[];for(let t of this.expr)e.push(...t.keys());return e}map(e){return new o(this.expr.map(t=>t.map(e)),null)}negate(){if(!this.negated){let e=[];for(let t of this.expr)e.push(t.negate());this.negated=Bf.create(e,this,!0)}return this.negated}},Bf=class o{constructor(e,t){this.expr=e;this.negated=t}static create(e,t,n){return o._normalizeArr(e,t,n)}type=9;cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.expr.length<e.expr.length)return-1;if(this.expr.length>e.expr.length)return 1;for(let t=0,n=this.expr.length;t<n;t++){let i=Rf(this.expr[t],e.expr[t]);if(i!==0)return i}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length)return!1;for(let t=0,n=this.expr.length;t<n;t++)if(!this.expr[t].equals(e.expr[t]))return!1;return!0}return!1}substituteConstants(){let e=zF(this.expr);return e===this.expr?this:o.create(e,this.negated,!1)}evaluate(e){for(let t=0,n=this.expr.length;t<n;t++)if(this.expr[t].evaluate(e))return!0;return!1}static _normalizeArr(e,t,n){let i=[],r=!1;if(e){for(let s=0,a=e.length;s<a;s++){let l=e[s];if(l){if(l.type===0){r=!0;continue}if(l.type===1)return fo.INSTANCE;if(l.type===9){i=i.concat(l.expr);continue}i.push(l)}}if(i.length===0&&r)return Qi.INSTANCE;i.sort(Rf)}if(i.length!==0){if(i.length===1)return i[0];for(let s=1;s<i.length;s++)i[s-1].equals(i[s])&&(i.splice(s,1),s--);if(i.length===1)return i[0];if(n){for(let s=0;s<i.length;s++)for(let a=s+1;a<i.length;a++)if(i[s].negate().equals(i[a]))return fo.INSTANCE;if(i.length===1)return i[0]}return new o(i,t)}}serialize(){return this.expr.map(e=>e.serialize()).join(" || ")}keys(){let e=[];for(let t of this.expr)e.push(...t.keys());return e}map(e){return new o(this.expr.map(t=>t.map(e)),null)}negate(){if(!this.negated){let e=[];for(let t of this.expr)e.push(t.negate());for(;e.length>1;){let t=e.shift(),n=e.shift(),i=[];for(let r of UF(t))for(let s of UF(n))i.push(WI.create([r,s],null,!1));e.unshift(o.create(i,null,!1))}this.negated=o.create(e,this,!0)}return this.negated}},$=class o extends tu{static _info=[];static all(){return o._info.values()}_defaultValue;constructor(e,t,n){super(e,null),this._defaultValue=t,typeof n=="object"?o._info.push({...n,key:e}):n!==!0&&o._info.push({key:e,description:n,type:t!=null?typeof t:void 0})}bindTo(e){return e.createKey(this.key,this._defaultValue)}getValue(e){return e.getContextKeyValue(this.key)}toNegated(){return this.negate()}isEqualTo(e){return kf.create(this.key,e)}notEqualsTo(e){return Mf.create(this.key,e)}},_t=Y("contextKeyService");function KF(o,e){return o<e?-1:o>e?1:0}function iu(o,e,t,n){return o<t?-1:o>t?1:e<n?-1:e>n?1:0}function UF(o){return o.type===9?o.expr:[o]}var v9=Object.freeze({View:Zo("view","View"),Help:Zo("help","Help"),Test:Zo("test","Test"),File:Zo("file","File"),Preferences:Zo("preferences","Preferences"),Developer:Zo({key:"developer",comment:["A developer on Code itself or someone diagnosing issues in Code"]},"Developer")});function GF(o){let e=!1,t=new Map,n=new Map;if(y9(o,c=>{if(o===c)return!0;let u=JSON.stringify(c);if(u.length<30)return!0;let p=t.get(u);if(!p){let h={schemas:[c]};return t.set(u,h),n.set(c,h),!0}return p.schemas.push(c),n.set(c,p),e=!0,!1}),t.clear(),!e)return JSON.stringify(o);let r="$defs";for(;o.hasOwnProperty(r);)r+="_";let s=[];function a(c){return JSON.stringify(c,(u,p)=>{if(p!==c){let h=n.get(p);if(h&&h.schemas.length>1)return h.id||(h.id=`_${s.length}`,s.push(h.schemas[0])),{$ref:`#/${r}/${h.id}`}}return p})}let l=a(o),d=[];for(let c=0;c<s.length;c++)d.push(`"_${c}":${a(s[c])}`);return d.length?`${l.substring(0,l.length-1)},"${r}":{${d.join(",")}}}`:l}function eh(o){return typeof o=="object"&&o!==null}function y9(o,e){if(!o||typeof o!="object")return;let t=(...l)=>{for(let d of l)eh(d)&&s.push(d)},n=(...l)=>{for(let d of l)if(eh(d))for(let c in d){let u=d[c];eh(u)&&s.push(u)}},i=(...l)=>{for(let d of l)if(Array.isArray(d))for(let c of d)eh(c)&&s.push(c)},r=l=>{if(Array.isArray(l))for(let d of l)eh(d)&&s.push(d);else eh(l)&&s.push(l)},s=[o],a=s.pop();for(;a;)e(a)&&(t(a.additionalItems,a.additionalProperties,a.not,a.contains,a.propertyNames,a.if,a.then,a.else,a.unevaluatedItems,a.unevaluatedProperties),n(a.definitions,a.$defs,a.properties,a.patternProperties,a.dependencies,a.dependentSchemas),i(a.anyOf,a.allOf,a.oneOf,a.prefixItems),r(a.items)),a=s.pop()}var Ji=Y("commandService"),Xr=new class{_commands=new Map;_onDidRegisterCommand=new D;onDidRegisterCommand=this._onDidRegisterCommand.event;registerCommand(o,e){if(!o)throw new Error("invalid command");if(typeof o=="string"){if(!e)throw new Error("invalid command");return this.registerCommand({id:o,handler:e})}if(o.metadata&&Array.isArray(o.metadata.args)){let s=[];for(let l of o.metadata.args)s.push(l.constraint);let a=o.handler;o.handler=function(l,...d){return PA(d,s),a(l,...d)}}let{id:t}=o,n=this._commands.get(t);n||(n=new zi,this._commands.set(t,n));let i=n.unshift(o),r=le(()=>{i(),this._commands.get(t)?.isEmpty()&&this._commands.delete(t)});return this._onDidRegisterCommand.fire(t),r}registerCommandAlias(o,e){return Xr.registerCommand(o,(t,...n)=>t.get(Ji).executeCommand(e,...n))}getCommand(o){let e=this._commands.get(o);if(!(!e||e.isEmpty()))return Je.first(e)}getCommands(){let o=new Map;for(let e of this._commands.keys()){let t=this.getCommand(e);t&&o.set(e,t)}return o}};Xr.registerCommand("noop",()=>{});function jF(o){return o?o.condition!==void 0:!1}var Gt=Y("logService"),Jte=Y("loggerService");function UI(o){switch(o){case 1:return"trace";case 2:return"debug";case 3:return"info";case 4:return"warn";case 5:return"error";case 0:return"off"}}var ene=new $("logLevel",UI(3));var Dd=Y("contextService");function zI(o){let e=o;return typeof e?.id=="string"&&J.isUri(e.uri)}function KI(o){let e=o;return typeof e?.id=="string"&&J.isUri(e.configPath)}var qF="code-workspace",mne=`.${qF}`,gne=[{name:m("codeWorkspace","Code Workspace"),extensions:[qF]}];var eo=Y("IUriIdentityService");var I9=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function $F(o){return I9.test(o)}var Mr=function(){if(typeof crypto=="object"&&typeof crypto.randomUUID=="function")return crypto.randomUUID.bind(crypto);let o;typeof crypto=="object"&&typeof crypto.getRandomValues=="function"?o=crypto.getRandomValues.bind(crypto):o=function(n){for(let i=0;i<n.length;i++)n[i]=Math.floor(Math.random()*256);return n};let e=new Uint8Array(16),t=[];for(let n=0;n<256;n++)t.push(n.toString(16).padStart(2,"0"));return function(){o(e),e[6]=e[6]&15|64,e[8]=e[8]&63|128;let i=0,r="";return r+=t[e[i++]],r+=t[e[i++]],r+=t[e[i++]],r+=t[e[i++]],r+="-",r+=t[e[i++]],r+=t[e[i++]],r+="-",r+=t[e[i++]],r+=t[e[i++]],r+="-",r+=t[e[i++]],r+=t[e[i++]],r+="-",r+=t[e[i++]],r+=t[e[i++]],r+=t[e[i++]],r+=t[e[i++]],r+=t[e[i++]],r+=t[e[i++]],r}}();function ba(o){let e=o;return!!(e&&typeof e=="object"&&typeof e.id=="string"&&typeof e.isDefault=="boolean"&&typeof e.name=="string"&&J.isUri(e.location)&&J.isUri(e.globalStorageHome)&&J.isUri(e.settingsResource)&&J.isUri(e.keybindingsResource)&&J.isUri(e.tasksResource)&&J.isUri(e.snippetsHome)&&J.isUri(e.extensionsResource))}var su=Y("IUserDataProfilesService");function ou(o,e,t,n,i,r){return{id:o,name:e,location:t,isDefault:!1,shortName:i?.shortName,icon:i?.icon,globalStorageHome:r&&i?.useDefaultFlags?.globalState?r.globalStorageHome:Ct(t,"globalStorage"),settingsResource:r&&i?.useDefaultFlags?.settings?r.settingsResource:Ct(t,"settings.json"),keybindingsResource:r&&i?.useDefaultFlags?.keybindings?r.keybindingsResource:Ct(t,"keybindings.json"),tasksResource:r&&i?.useDefaultFlags?.tasks?r.tasksResource:Ct(t,"tasks.json"),snippetsHome:r&&i?.useDefaultFlags?.snippets?r.snippetsHome:Ct(t,"snippets"),extensionsResource:r&&i?.useDefaultFlags?.extensions?r.extensionsResource:Ct(t,"extensions.json"),cacheHome:Ct(n,o),useDefaultFlags:i?.useDefaultFlags,isTransient:i?.transient}}var GI=class extends F{constructor(t,n,i,r){super();this.environmentService=t;this.fileService=n;this.uriIdentityService=i;this.logService=r;this.profilesHome=Ct(this.environmentService.userRoamingDataHome,"profiles"),this.profilesCacheHome=Ct(this.environmentService.cacheHome,"CachedProfilesData")}static PROFILES_KEY="userDataProfiles";static PROFILE_ASSOCIATIONS_KEY="profileAssociations";_serviceBrand;enabled=!0;profilesHome;profilesCacheHome;get defaultProfile(){return this.profiles[0]}get profiles(){return[...this.profilesObject.profiles,...this.transientProfilesObject.profiles]}_onDidChangeProfiles=this._register(new D);onDidChangeProfiles=this._onDidChangeProfiles.event;_onWillCreateProfile=this._register(new D);onWillCreateProfile=this._onWillCreateProfile.event;_onWillRemoveProfile=this._register(new D);onWillRemoveProfile=this._onWillRemoveProfile.event;_onDidResetWorkspaces=this._register(new D);onDidResetWorkspaces=this._onDidResetWorkspaces.event;profileCreationPromises=new Map;transientProfilesObject={profiles:[],folders:new Ui,workspaces:new Ui,emptyWindows:new Map};init(){this._profilesObject=void 0}setEnablement(t){this.enabled!==t&&(this._profilesObject=void 0,this.enabled=t)}isEnabled(){return this.enabled}_profilesObject;get profilesObject(){if(!this._profilesObject){let t=this.createDefaultProfile(),n=[t];if(this.enabled)try{for(let s of this.getStoredProfiles()){if(!s.name||!In(s.name)||!s.location){this.logService.warn("Skipping the invalid stored profile",s.location||s.name);continue}n.push(ou(go(s.location),s.name,s.location,this.profilesCacheHome,{shortName:s.shortName,icon:s.icon,useDefaultFlags:s.useDefaultFlags},t))}}catch(s){this.logService.error(s)}let i=new Ui,r=new Map;if(n.length)try{let s=this.getStoredProfileAssociations();if(s.workspaces)for(let[a,l]of Object.entries(s.workspaces)){let d=J.parse(a),c=n.find(u=>u.id===l);c&&i.set(d,c)}if(s.emptyWindows)for(let[a,l]of Object.entries(s.emptyWindows)){let d=n.find(c=>c.id===l);d&&r.set(a,d)}}catch(s){this.logService.error(s)}this._profilesObject={profiles:n,workspaces:i,emptyWindows:r}}return this._profilesObject}createDefaultProfile(){let t=ou("__default__profile__",m("defaultProfile","Default"),this.environmentService.userRoamingDataHome,this.profilesCacheHome);return{...t,extensionsResource:this.getDefaultProfileExtensionsLocation()??t.extensionsResource,isDefault:!0}}async createTransientProfile(t){let n="Temp",i=new RegExp(`${ji(n)}\\s(\\d+)`),r=0;for(let a of this.profiles){let l=i.exec(a.name),d=l?parseInt(l[1]):0;r=d>r?d:r}let s=`${n} ${r+1}`;return this.createProfile(Zr(Mr()).toString(16),s,{transient:!0},t)}async createNamedProfile(t,n,i){return this.createProfile(Zr(Mr()).toString(16),t,n,i)}async createProfile(t,n,i,r){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");let s=await this.doCreateProfile(t,n,i);return r&&await this.setProfileForWorkspace(r,s),s}async doCreateProfile(t,n,i){if(!In(n)||!n)throw new Error("Name of the profile is mandatory and must be of type `string`");let r=this.profileCreationPromises.get(n);return r||(r=(async()=>{try{if(this.profiles.find(d=>d.name===n||d.id===t))throw new Error(`Profile with ${n} name already exists`);let a=ou(t,n,Ct(this.profilesHome,t),this.profilesCacheHome,i,this.defaultProfile);await this.fileService.createFolder(a.location);let l=[];return this._onWillCreateProfile.fire({profile:a,join(d){l.push(d)}}),await Po.settled(l),this.updateProfiles([a],[],[]),a}finally{this.profileCreationPromises.delete(n)}})(),this.profileCreationPromises.set(n,r)),r}async updateProfile(t,n){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");let i=this.profiles.find(r=>r.id===t.id);if(!i)throw new Error(`Profile '${t.name}' does not exist`);return i=ou(i.id,n.name??i.name,i.location,this.profilesCacheHome,{shortName:n.shortName??i.shortName,icon:n.icon===null?void 0:n.icon??i.icon,transient:n.transient??i.isTransient,useDefaultFlags:n.useDefaultFlags??i.useDefaultFlags},this.defaultProfile),this.updateProfiles([],[],[i]),i}async removeProfile(t){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");if(t.isDefault)throw new Error("Cannot remove default profile");let n=this.profiles.find(r=>r.id===t.id);if(!n)throw new Error(`Profile '${t.name}' does not exist`);let i=[];this._onWillRemoveProfile.fire({profile:n,join(r){i.push(r)}});try{await Promise.allSettled(i)}catch(r){this.logService.error(r)}for(let r of[...this.profilesObject.emptyWindows.keys()])n.id===this.profilesObject.emptyWindows.get(r)?.id&&this.profilesObject.emptyWindows.delete(r);for(let r of[...this.profilesObject.workspaces.keys()])n.id===this.profilesObject.workspaces.get(r)?.id&&this.profilesObject.workspaces.delete(r);this.updateStoredProfileAssociations(),this.updateProfiles([],[n],[]);try{await this.fileService.del(n.cacheHome,{recursive:!0})}catch(r){NF(r)!==1&&this.logService.error(r)}}async setProfileForWorkspace(t,n){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");let i=this.profiles.find(r=>r.id===n.id);if(!i)throw new Error(`Profile '${n.name}' does not exist`);this.updateWorkspaceAssociation(t,i)}unsetWorkspace(t,n){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");this.updateWorkspaceAssociation(t,void 0,n)}async resetWorkspaces(){this.transientProfilesObject.folders.clear(),this.transientProfilesObject.workspaces.clear(),this.transientProfilesObject.emptyWindows.clear(),this.profilesObject.workspaces.clear(),this.profilesObject.emptyWindows.clear(),this.updateStoredProfileAssociations(),this._onDidResetWorkspaces.fire()}async cleanUp(){if(this.enabled&&await this.fileService.exists(this.profilesHome)){let t=await this.fileService.resolve(this.profilesHome);await Promise.all((t.children||[]).filter(n=>n.isDirectory&&this.profiles.every(i=>!this.uriIdentityService.extUri.isEqual(i.location,n.resource))).map(n=>this.fileService.del(n.resource,{recursive:!0})))}}async cleanUpTransientProfiles(){if(!this.enabled)return;let t=this.transientProfilesObject.profiles.filter(n=>!this.isProfileAssociatedToWorkspace(n));await Promise.allSettled(t.map(n=>this.removeProfile(n)))}getProfileForWorkspace(t){let n=this.getWorkspace(t),i=J.isUri(n)?this.profilesObject.workspaces.get(n):this.profilesObject.emptyWindows.get(n);return i||(zI(t)?this.transientProfilesObject.folders.get(t.uri):KI(t)?this.transientProfilesObject.workspaces.get(t.configPath):this.transientProfilesObject.emptyWindows.get(t.id))}getWorkspace(t){return zI(t)?t.uri:KI(t)?t.configPath:t.id}isProfileAssociatedToWorkspace(t){return!!([...this.profilesObject.emptyWindows.values()].some(n=>this.uriIdentityService.extUri.isEqual(n.location,t.location))||[...this.profilesObject.workspaces.values()].some(n=>this.uriIdentityService.extUri.isEqual(n.location,t.location))||[...this.transientProfilesObject.emptyWindows.values()].some(n=>this.uriIdentityService.extUri.isEqual(n.location,t.location))||[...this.transientProfilesObject.workspaces.values()].some(n=>this.uriIdentityService.extUri.isEqual(n.location,t.location))||[...this.transientProfilesObject.folders.values()].some(n=>this.uriIdentityService.extUri.isEqual(n.location,t.location)))}updateProfiles(t,n,i){let r=[...this.profiles,...t],s=[],a=this.transientProfilesObject.profiles;this.transientProfilesObject.profiles=[];for(let l of r){if(l.isDefault||n.some(c=>l.id===c.id))continue;l=i.find(c=>l.id===c.id)??l;let d=a.find(c=>l.id===c.id);if(l.isTransient)this.transientProfilesObject.profiles.push(l);else{if(d){for(let[c,u]of this.transientProfilesObject.emptyWindows.entries())if(l.id===u.id){this.updateWorkspaceAssociation({id:c},l);break}for(let[c,u]of this.transientProfilesObject.workspaces.entries())if(l.id===u.id){this.updateWorkspaceAssociation({id:"",configPath:c},l);break}for(let[c,u]of this.transientProfilesObject.folders.entries())if(l.id===u.id){this.updateWorkspaceAssociation({id:"",uri:c},l);break}}s.push({location:l.location,name:l.name,shortName:l.shortName,icon:l.icon,useDefaultFlags:l.useDefaultFlags})}}this.saveStoredProfiles(s),this._profilesObject=void 0,this.triggerProfilesChanges(t,n,i)}triggerProfilesChanges(t,n,i){this._onDidChangeProfiles.fire({added:t,removed:n,updated:i,all:this.profiles})}updateWorkspaceAssociation(t,n,i){if(i=n?.isTransient?!0:i,i)zI(t)?(this.transientProfilesObject.folders.delete(t.uri),n&&this.transientProfilesObject.folders.set(t.uri,n)):KI(t)?(this.transientProfilesObject.workspaces.delete(t.configPath),n&&this.transientProfilesObject.workspaces.set(t.configPath,n)):(this.transientProfilesObject.emptyWindows.delete(t.id),n&&this.transientProfilesObject.emptyWindows.set(t.id,n));else{this.updateWorkspaceAssociation(t,void 0,!0);let r=this.getWorkspace(t);J.isUri(r)?(this.profilesObject.workspaces.delete(r),n&&this.profilesObject.workspaces.set(r,n)):(this.profilesObject.emptyWindows.delete(r),n&&this.profilesObject.emptyWindows.set(r,n)),this.updateStoredProfileAssociations()}}updateStoredProfileAssociations(){let t={};for(let[i,r]of this.profilesObject.workspaces.entries())t[i.toString()]=r.id;let n={};for(let[i,r]of this.profilesObject.emptyWindows.entries())n[i.toString()]=r.id;this.saveStoredProfileAssociations({workspaces:t,emptyWindows:n}),this._profilesObject=void 0}migrateStoredProfileAssociations(t){let n={},i=this.createDefaultProfile();if(t.workspaces)for(let[s,a]of Object.entries(t.workspaces)){let l=J.parse(a);n[s]=this.uriIdentityService.extUri.isEqual(l,i.location)?i.id:this.uriIdentityService.extUri.basename(l)}let r={};if(t.emptyWindows)for(let[s,a]of Object.entries(t.emptyWindows)){let l=J.parse(a);r[s]=this.uriIdentityService.extUri.isEqual(l,i.location)?i.id:this.uriIdentityService.extUri.basename(l)}return{workspaces:n,emptyWindows:r}}getStoredProfiles(){return[]}saveStoredProfiles(t){throw new Error("not implemented")}getStoredProfileAssociations(){return{}}saveStoredProfileAssociations(t){throw new Error("not implemented")}getDefaultProfileExtensionsLocation(){}};GI=O([x(0,Mo),x(1,Bt),x(2,eo),x(3,Gt)],GI);var UL=class{data=new Map;add(e,t){Ky(In(e)),Ky(an(t)),Ky(!this.data.has(e),"There is already an extension with this id"),this.data.set(e,t)}knows(e){return this.data.has(e)}as(e){return this.data.get(e)||null}},et=new UL;var Ld={JSONContribution:"base.contributions.json"};function C9(o){return o.length>0&&o.charAt(o.length-1)==="#"?o.substring(0,o.length-1):o}var zL=class{schemasById;_onDidChangeSchema=new D;onDidChangeSchema=this._onDidChangeSchema.event;constructor(){this.schemasById={}}registerSchema(e,t){this.schemasById[C9(e)]=t,this._onDidChangeSchema.fire(e)}notifySchemaChanged(e){this._onDidChangeSchema.fire(e)}getSchemaContributions(){return{schemas:this.schemasById}}getSchemaContent(e){let t=this.schemasById[e];return t?GF(t):void 0}hasSchemaContent(e){return!!this.schemasById[e]}},S9=new zL;et.add(Ld.JSONContribution,S9);var E9={IconContribution:"base.contributions.icons"},T9;(e=>{function o(t,n){let i=t.defaults;for(;we.isThemeIcon(i);){let r=th.getIcon(i.id);if(!r)return;i=r.defaults}return i}e.getDefinition=o})(T9||={});var x9;(t=>{function o(n){return{weight:n.weight,style:n.style,src:n.src.map(i=>({format:i.format,location:i.location.toString()}))}}t.toJSONObject=o;function e(n){let i=r=>In(r)?r:void 0;if(n&&Array.isArray(n.src)&&n.src.every(r=>In(r.format)&&In(r.location)))return{weight:i(n.weight),style:i(n.style),src:n.src.map(r=>({format:r.format,location:J.parse(r.location)}))}}t.fromJSONObject=e})(x9||={});var KL=class{_onDidChange=new D;onDidChange=this._onDidChange.event;iconsById;iconSchema={definitions:{icons:{type:"object",properties:{fontId:{type:"string",description:m("iconDefinition.fontId","The id of the font to use. If not set, the font that is defined first is used.")},fontCharacter:{type:"string",description:m("iconDefinition.fontCharacter","The font character associated with the icon definition.")}},additionalProperties:!1,defaultSnippets:[{body:{fontCharacter:"\\\\e030"}}]}},type:"object",properties:{}};iconReferenceSchema={type:"string",pattern:`^${we.iconNameExpression}$`,enum:[],enumDescriptions:[]};iconFontsById;constructor(){this.iconsById={},this.iconFontsById={}}registerIcon(e,t,n,i){let r=this.iconsById[e];if(r){if(n&&!r.description){r.description=n,this.iconSchema.properties[e].markdownDescription=`${n} $(${e})`;let l=this.iconReferenceSchema.enum.indexOf(e);l!==-1&&(this.iconReferenceSchema.enumDescriptions[l]=n),this._onDidChange.fire()}return r}let s={id:e,description:n,defaults:t,deprecationMessage:i};this.iconsById[e]=s;let a={$ref:"#/definitions/icons"};return i&&(a.deprecationMessage=i),n&&(a.markdownDescription=`${n}: $(${e})`),this.iconSchema.properties[e]=a,this.iconReferenceSchema.enum.push(e),this.iconReferenceSchema.enumDescriptions.push(n||""),this._onDidChange.fire(),{id:e}}deregisterIcon(e){delete this.iconsById[e],delete this.iconSchema.properties[e];let t=this.iconReferenceSchema.enum.indexOf(e);t!==-1&&(this.iconReferenceSchema.enum.splice(t,1),this.iconReferenceSchema.enumDescriptions.splice(t,1)),this._onDidChange.fire()}getIcons(){return Object.keys(this.iconsById).map(e=>this.iconsById[e])}getIcon(e){return this.iconsById[e]}getIconSchema(){return this.iconSchema}getIconReferenceSchema(){return this.iconReferenceSchema}registerIconFont(e,t){let n=this.iconFontsById[e];return n||(this.iconFontsById[e]=t,this._onDidChange.fire(),t)}deregisterIconFont(e){delete this.iconFontsById[e]}getIconFont(e){return this.iconFontsById[e]}toString(){let e=(r,s)=>r.id.localeCompare(s.id),t=r=>{for(;we.isThemeIcon(r.defaults);)r=this.iconsById[r.defaults.id];return`codicon codicon-${r?r.id:""}`},n=[];n.push("| preview     | identifier                        | default codicon ID                | description"),n.push("| ----------- | --------------------------------- | --------------------------------- | --------------------------------- |");let i=Object.keys(this.iconsById).map(r=>this.iconsById[r]);for(let r of i.filter(s=>!!s.description).sort(e))n.push(`|<i class="${t(r)}"></i>|${r.id}|${we.isThemeIcon(r.defaults)?r.defaults.id:r.id}|${r.description||""}|`);n.push("| preview     | identifier                        "),n.push("| ----------- | --------------------------------- |");for(let r of i.filter(s=>!we.isThemeIcon(s.defaults)).sort(e))n.push(`|<i class="${t(r)}"></i>|${r.id}|`);return n.join(`
`)}},th=new KL;et.add(E9.IconContribution,th);function or(o,e,t,n){return th.registerIcon(o,e,t,n)}function w9(){let o=rL();for(let e in o){let t="\\"+o[e].toString(16);th.registerIcon(e,{fontCharacter:t})}}w9();var ZF="vscode://schemas/icons",XF=et.as(Ld.JSONContribution);XF.registerSchema(ZF,th.getIconSchema());var YF=new nn(()=>XF.notifySchemaChanged(ZF),200);th.onDidChange(()=>{YF.isScheduled()||YF.schedule()});var mie=or("widget-close",te.close,m("widgetClose","Icon for the close action in widgets.")),gie=or("goto-previous-location",te.arrowUp,m("previousChangeIcon","Icon for goto previous editor location.")),fie=or("goto-next-location",te.arrowDown,m("nextChangeIcon","Icon for goto next editor location.")),bie=we.modify(te.sync,"spin"),vie=we.modify(te.loading,"spin");function kd(o,e){let t=Math.pow(10,e);return Math.round(o*t)/t}var tt=class{_rgbaBrand=void 0;r;g;b;a;constructor(e,t,n,i=1){this.r=Math.min(255,Math.max(0,e))|0,this.g=Math.min(255,Math.max(0,t))|0,this.b=Math.min(255,Math.max(0,n))|0,this.a=kd(Math.max(Math.min(1,i),0),3)}static equals(e,t){return e.r===t.r&&e.g===t.g&&e.b===t.b&&e.a===t.a}},Rd=class o{_hslaBrand=void 0;h;s;l;a;constructor(e,t,n,i){this.h=Math.max(Math.min(360,e),0)|0,this.s=kd(Math.max(Math.min(1,t),0),3),this.l=kd(Math.max(Math.min(1,n),0),3),this.a=kd(Math.max(Math.min(1,i),0),3)}static equals(e,t){return e.h===t.h&&e.s===t.s&&e.l===t.l&&e.a===t.a}static fromRGBA(e){let t=e.r/255,n=e.g/255,i=e.b/255,r=e.a,s=Math.max(t,n,i),a=Math.min(t,n,i),l=0,d=0,c=(a+s)/2,u=s-a;if(u>0){switch(d=Math.min(c<=.5?u/(2*c):u/(2-2*c),1),s){case t:l=(n-i)/u+(n<i?6:0);break;case n:l=(i-t)/u+2;break;case i:l=(t-n)/u+4;break}l*=60,l=Math.round(l)}return new o(l,d,c,r)}static _hue2rgb(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*(2/3-n)*6:e}static toRGBA(e){let t=e.h/360,{s:n,l:i,a:r}=e,s,a,l;if(n===0)s=a=l=i;else{let d=i<.5?i*(1+n):i+n-i*n,c=2*i-d;s=o._hue2rgb(c,d,t+1/3),a=o._hue2rgb(c,d,t),l=o._hue2rgb(c,d,t-1/3)}return new tt(Math.round(s*255),Math.round(a*255),Math.round(l*255),r)}},nh=class o{_hsvaBrand=void 0;h;s;v;a;constructor(e,t,n,i){this.h=Math.max(Math.min(360,e),0)|0,this.s=kd(Math.max(Math.min(1,t),0),3),this.v=kd(Math.max(Math.min(1,n),0),3),this.a=kd(Math.max(Math.min(1,i),0),3)}static equals(e,t){return e.h===t.h&&e.s===t.s&&e.v===t.v&&e.a===t.a}static fromRGBA(e){let t=e.r/255,n=e.g/255,i=e.b/255,r=Math.max(t,n,i),s=Math.min(t,n,i),a=r-s,l=r===0?0:a/r,d;return a===0?d=0:r===t?d=((n-i)/a%6+6)%6:r===n?d=(i-t)/a+2:d=(t-n)/a+4,new o(Math.round(d*60),l,r,e.a)}static toRGBA(e){let{h:t,s:n,v:i,a:r}=e,s=i*n,a=s*(1-Math.abs(t/60%2-1)),l=i-s,[d,c,u]=[0,0,0];return t<60?(d=s,c=a):t<120?(d=a,c=s):t<180?(c=s,u=a):t<240?(c=a,u=s):t<300?(d=a,u=s):t<=360&&(d=s,u=a),d=Math.round((d+l)*255),c=Math.round((c+l)*255),u=Math.round((u+l)*255),new tt(d,c,u,r)}},H=class o{static fromHex(e){return o.Format.CSS.parseHex(e)||o.red}static equals(e,t){return!e&&!t?!0:!e||!t?!1:e.equals(t)}rgba;_hsla;get hsla(){return this._hsla?this._hsla:Rd.fromRGBA(this.rgba)}_hsva;get hsva(){return this._hsva?this._hsva:nh.fromRGBA(this.rgba)}constructor(e){if(e)if(e instanceof tt)this.rgba=e;else if(e instanceof Rd)this._hsla=e,this.rgba=Rd.toRGBA(e);else if(e instanceof nh)this._hsva=e,this.rgba=nh.toRGBA(e);else throw new Error("Invalid color ctor argument");else throw new Error("Color needs a value")}equals(e){return!!e&&tt.equals(this.rgba,e.rgba)&&Rd.equals(this.hsla,e.hsla)&&nh.equals(this.hsva,e.hsva)}getRelativeLuminance(){let e=o._relativeLuminanceForComponent(this.rgba.r),t=o._relativeLuminanceForComponent(this.rgba.g),n=o._relativeLuminanceForComponent(this.rgba.b),i=.2126*e+.7152*t+.0722*n;return kd(i,4)}static _relativeLuminanceForComponent(e){let t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}getContrastRatio(e){let t=this.getRelativeLuminance(),n=e.getRelativeLuminance();return t>n?(t+.05)/(n+.05):(n+.05)/(t+.05)}isDarker(){return(this.rgba.r*299+this.rgba.g*587+this.rgba.b*114)/1e3<128}isLighter(){return(this.rgba.r*299+this.rgba.g*587+this.rgba.b*114)/1e3>=128}isLighterThan(e){let t=this.getRelativeLuminance(),n=e.getRelativeLuminance();return t>n}isDarkerThan(e){let t=this.getRelativeLuminance(),n=e.getRelativeLuminance();return t<n}lighten(e){return new o(new Rd(this.hsla.h,this.hsla.s,this.hsla.l+this.hsla.l*e,this.hsla.a))}darken(e){return new o(new Rd(this.hsla.h,this.hsla.s,this.hsla.l-this.hsla.l*e,this.hsla.a))}transparent(e){let{r:t,g:n,b:i,a:r}=this.rgba;return new o(new tt(t,n,i,r*e))}isTransparent(){return this.rgba.a===0}isOpaque(){return this.rgba.a===1}opposite(){return new o(new tt(255-this.rgba.r,255-this.rgba.g,255-this.rgba.b,this.rgba.a))}blend(e){let t=e.rgba,n=this.rgba.a,i=t.a,r=n+i*(1-n);if(r<1e-6)return o.transparent;let s=this.rgba.r*n/r+t.r*i*(1-n)/r,a=this.rgba.g*n/r+t.g*i*(1-n)/r,l=this.rgba.b*n/r+t.b*i*(1-n)/r;return new o(new tt(s,a,l,r))}makeOpaque(e){if(this.isOpaque()||e.rgba.a!==1)return this;let{r:t,g:n,b:i,a:r}=this.rgba;return new o(new tt(e.rgba.r-r*(e.rgba.r-t),e.rgba.g-r*(e.rgba.g-n),e.rgba.b-r*(e.rgba.b-i),1))}flatten(...e){let t=e.reduceRight((n,i)=>o._flatten(i,n));return o._flatten(this,t)}static _flatten(e,t){let n=1-e.rgba.a;return new o(new tt(n*t.rgba.r+e.rgba.a*e.rgba.r,n*t.rgba.g+e.rgba.a*e.rgba.g,n*t.rgba.b+e.rgba.a*e.rgba.b))}_toString;toString(){return this._toString||(this._toString=o.Format.CSS.format(this)),this._toString}static getLighterColor(e,t,n){if(e.isLighterThan(t))return e;n=n||.5;let i=e.getRelativeLuminance(),r=t.getRelativeLuminance();return n=n*(r-i)/r,e.lighten(n)}static getDarkerColor(e,t,n){if(e.isDarkerThan(t))return e;n=n||.5;let i=e.getRelativeLuminance(),r=t.getRelativeLuminance();return n=n*(i-r)/i,e.darken(n)}static white=new o(new tt(255,255,255,1));static black=new o(new tt(0,0,0,1));static red=new o(new tt(255,0,0,1));static blue=new o(new tt(0,0,255,1));static green=new o(new tt(0,255,0,1));static cyan=new o(new tt(0,255,255,1));static lightgrey=new o(new tt(211,211,211,1));static transparent=new o(new tt(0,0,0,0))};(e=>{let o;(n=>{let t;(f=>{function i(g){return g.rgba.a===1?`rgb(${g.rgba.r}, ${g.rgba.g}, ${g.rgba.b})`:e.Format.CSS.formatRGBA(g)}f.formatRGB=i;function r(g){return`rgba(${g.rgba.r}, ${g.rgba.g}, ${g.rgba.b}, ${+g.rgba.a.toFixed(2)})`}f.formatRGBA=r;function s(g){return g.hsla.a===1?`hsl(${g.hsla.h}, ${(g.hsla.s*100).toFixed(2)}%, ${(g.hsla.l*100).toFixed(2)}%)`:e.Format.CSS.formatHSLA(g)}f.formatHSL=s;function a(g){return`hsla(${g.hsla.h}, ${(g.hsla.s*100).toFixed(2)}%, ${(g.hsla.l*100).toFixed(2)}%, ${g.hsla.a.toFixed(2)})`}f.formatHSLA=a;function l(g){let b=g.toString(16);return b.length!==2?"0"+b:b}function d(g){return`#${l(g.rgba.r)}${l(g.rgba.g)}${l(g.rgba.b)}`}f.formatHex=d;function c(g,b=!1){return b&&g.rgba.a===1?e.Format.CSS.formatHex(g):`#${l(g.rgba.r)}${l(g.rgba.g)}${l(g.rgba.b)}${l(Math.round(g.rgba.a*255))}`}f.formatHexA=c;function u(g){return g.isOpaque()?e.Format.CSS.formatHex(g):e.Format.CSS.formatRGBA(g)}f.format=u;function p(g){let b=g.length;if(b===0||g.charCodeAt(0)!==35)return null;if(b===7){let v=16*h(g.charCodeAt(1))+h(g.charCodeAt(2)),y=16*h(g.charCodeAt(3))+h(g.charCodeAt(4)),S=16*h(g.charCodeAt(5))+h(g.charCodeAt(6));return new e(new tt(v,y,S,1))}if(b===9){let v=16*h(g.charCodeAt(1))+h(g.charCodeAt(2)),y=16*h(g.charCodeAt(3))+h(g.charCodeAt(4)),S=16*h(g.charCodeAt(5))+h(g.charCodeAt(6)),E=16*h(g.charCodeAt(7))+h(g.charCodeAt(8));return new e(new tt(v,y,S,E/255))}if(b===4){let v=h(g.charCodeAt(1)),y=h(g.charCodeAt(2)),S=h(g.charCodeAt(3));return new e(new tt(16*v+v,16*y+y,16*S+S))}if(b===5){let v=h(g.charCodeAt(1)),y=h(g.charCodeAt(2)),S=h(g.charCodeAt(3)),E=h(g.charCodeAt(4));return new e(new tt(16*v+v,16*y+y,16*S+S,(16*E+E)/255))}return null}f.parseHex=p;function h(g){switch(g){case 48:return 0;case 49:return 1;case 50:return 2;case 51:return 3;case 52:return 4;case 53:return 5;case 54:return 6;case 55:return 7;case 56:return 8;case 57:return 9;case 97:return 10;case 65:return 10;case 98:return 11;case 66:return 11;case 99:return 12;case 67:return 12;case 100:return 13;case 68:return 13;case 101:return 14;case 69:return 14;case 102:return 15;case 70:return 15}return 0}})(t=n.CSS||={})})(o=e.Format||={})})(H||={});var _9=Object.freeze({create:o=>Tr(o.map(e=>e.toString())).join(`\r
`),split:o=>o.split(`\r
`),parse:o=>_9.split(o).filter(e=>!e.startsWith("#"))});var QF=class o{constructor(e){this.value=e}static sep=".";static None=new o("@@none@@");static Empty=new o("");equals(e){return this.value===e.value}contains(e){return this.equals(e)||this.value===""||e.value.startsWith(this.value+o.sep)}intersects(e){return this.contains(e)||e.contains(this)}append(...e){return new o((this.value?[this.value,...e]:e).join(o.sep))}};var A=class o{lineNumber;column;constructor(e,t){this.lineNumber=e,this.column=t}with(e=this.lineNumber,t=this.column){return e===this.lineNumber&&t===this.column?this:new o(e,t)}delta(e=0,t=0){return this.with(this.lineNumber+e,this.column+t)}equals(e){return o.equals(this,e)}static equals(e,t){return!e&&!t?!0:!!e&&!!t&&e.lineNumber===t.lineNumber&&e.column===t.column}isBefore(e){return o.isBefore(this,e)}static isBefore(e,t){return e.lineNumber<t.lineNumber?!0:t.lineNumber<e.lineNumber?!1:e.column<t.column}isBeforeOrEqual(e){return o.isBeforeOrEqual(this,e)}static isBeforeOrEqual(e,t){return e.lineNumber<t.lineNumber?!0:t.lineNumber<e.lineNumber?!1:e.column<=t.column}static compare(e,t){let n=e.lineNumber|0,i=t.lineNumber|0;if(n===i){let r=e.column|0,s=t.column|0;return r-s}return n-i}clone(){return new o(this.lineNumber,this.column)}toString(){return"("+this.lineNumber+","+this.column+")"}static lift(e){return new o(e.lineNumber,e.column)}static isIPosition(e){return e&&typeof e.lineNumber=="number"&&typeof e.column=="number"}toJSON(){return{lineNumber:this.lineNumber,column:this.column}}};var P=class o{startLineNumber;startColumn;endLineNumber;endColumn;constructor(e,t,n,i){e>n||e===n&&t>i?(this.startLineNumber=n,this.startColumn=i,this.endLineNumber=e,this.endColumn=t):(this.startLineNumber=e,this.startColumn=t,this.endLineNumber=n,this.endColumn=i)}isEmpty(){return o.isEmpty(this)}static isEmpty(e){return e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn}containsPosition(e){return o.containsPosition(this,e)}static containsPosition(e,t){return!(t.lineNumber<e.startLineNumber||t.lineNumber>e.endLineNumber||t.lineNumber===e.startLineNumber&&t.column<e.startColumn||t.lineNumber===e.endLineNumber&&t.column>e.endColumn)}static strictContainsPosition(e,t){return!(t.lineNumber<e.startLineNumber||t.lineNumber>e.endLineNumber||t.lineNumber===e.startLineNumber&&t.column<=e.startColumn||t.lineNumber===e.endLineNumber&&t.column>=e.endColumn)}containsRange(e){return o.containsRange(this,e)}static containsRange(e,t){return!(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber||t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber||t.startLineNumber===e.startLineNumber&&t.startColumn<e.startColumn||t.endLineNumber===e.endLineNumber&&t.endColumn>e.endColumn)}strictContainsRange(e){return o.strictContainsRange(this,e)}static strictContainsRange(e,t){return!(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber||t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber||t.startLineNumber===e.startLineNumber&&t.startColumn<=e.startColumn||t.endLineNumber===e.endLineNumber&&t.endColumn>=e.endColumn)}plusRange(e){return o.plusRange(this,e)}static plusRange(e,t){let n,i,r,s;return t.startLineNumber<e.startLineNumber?(n=t.startLineNumber,i=t.startColumn):t.startLineNumber===e.startLineNumber?(n=t.startLineNumber,i=Math.min(t.startColumn,e.startColumn)):(n=e.startLineNumber,i=e.startColumn),t.endLineNumber>e.endLineNumber?(r=t.endLineNumber,s=t.endColumn):t.endLineNumber===e.endLineNumber?(r=t.endLineNumber,s=Math.max(t.endColumn,e.endColumn)):(r=e.endLineNumber,s=e.endColumn),new o(n,i,r,s)}intersectRanges(e){return o.intersectRanges(this,e)}static intersectRanges(e,t){let n=e.startLineNumber,i=e.startColumn,r=e.endLineNumber,s=e.endColumn,a=t.startLineNumber,l=t.startColumn,d=t.endLineNumber,c=t.endColumn;return n<a?(n=a,i=l):n===a&&(i=Math.max(i,l)),r>d?(r=d,s=c):r===d&&(s=Math.min(s,c)),n>r||n===r&&i>s?null:new o(n,i,r,s)}equalsRange(e){return o.equalsRange(this,e)}static equalsRange(e,t){return!e&&!t?!0:!!e&&!!t&&e.startLineNumber===t.startLineNumber&&e.startColumn===t.startColumn&&e.endLineNumber===t.endLineNumber&&e.endColumn===t.endColumn}getEndPosition(){return o.getEndPosition(this)}static getEndPosition(e){return new A(e.endLineNumber,e.endColumn)}getStartPosition(){return o.getStartPosition(this)}static getStartPosition(e){return new A(e.startLineNumber,e.startColumn)}toString(){return"["+this.startLineNumber+","+this.startColumn+" -> "+this.endLineNumber+","+this.endColumn+"]"}setEndPosition(e,t){return new o(this.startLineNumber,this.startColumn,e,t)}setStartPosition(e,t){return new o(e,t,this.endLineNumber,this.endColumn)}collapseToStart(){return o.collapseToStart(this)}static collapseToStart(e){return new o(e.startLineNumber,e.startColumn,e.startLineNumber,e.startColumn)}collapseToEnd(){return o.collapseToEnd(this)}static collapseToEnd(e){return new o(e.endLineNumber,e.endColumn,e.endLineNumber,e.endColumn)}delta(e){return new o(this.startLineNumber+e,this.startColumn,this.endLineNumber+e,this.endColumn)}static fromPositions(e,t=e){return new o(e.lineNumber,e.column,t.lineNumber,t.column)}static lift(e){return e?new o(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn):null}static isIRange(e){return e&&typeof e.startLineNumber=="number"&&typeof e.startColumn=="number"&&typeof e.endLineNumber=="number"&&typeof e.endColumn=="number"}static areIntersectingOrTouching(e,t){return!(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<t.startColumn||t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<e.startColumn)}static areIntersecting(e,t){return!(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<=t.startColumn||t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<=e.startColumn)}static compareRangesUsingStarts(e,t){if(e&&t){let r=e.startLineNumber|0,s=t.startLineNumber|0;if(r===s){let a=e.startColumn|0,l=t.startColumn|0;if(a===l){let d=e.endLineNumber|0,c=t.endLineNumber|0;if(d===c){let u=e.endColumn|0,p=t.endColumn|0;return u-p}return d-c}return a-l}return r-s}return(e?1:0)-(t?1:0)}static compareRangesUsingEnds(e,t){return e.endLineNumber===t.endLineNumber?e.endColumn===t.endColumn?e.startLineNumber===t.startLineNumber?e.startColumn-t.startColumn:e.startLineNumber-t.startLineNumber:e.endColumn-t.endColumn:e.endLineNumber-t.endLineNumber}static spansMultipleLines(e){return e.endLineNumber>e.startLineNumber}toJSON(){return this}};var $e=class o extends P{selectionStartLineNumber;selectionStartColumn;positionLineNumber;positionColumn;constructor(e,t,n,i){super(e,t,n,i),this.selectionStartLineNumber=e,this.selectionStartColumn=t,this.positionLineNumber=n,this.positionColumn=i}toString(){return"["+this.selectionStartLineNumber+","+this.selectionStartColumn+" -> "+this.positionLineNumber+","+this.positionColumn+"]"}equalsSelection(e){return o.selectionsEqual(this,e)}static selectionsEqual(e,t){return e.selectionStartLineNumber===t.selectionStartLineNumber&&e.selectionStartColumn===t.selectionStartColumn&&e.positionLineNumber===t.positionLineNumber&&e.positionColumn===t.positionColumn}getDirection(){return this.selectionStartLineNumber===this.startLineNumber&&this.selectionStartColumn===this.startColumn?0:1}setEndPosition(e,t){return this.getDirection()===0?new o(this.startLineNumber,this.startColumn,e,t):new o(e,t,this.startLineNumber,this.startColumn)}getPosition(){return new A(this.positionLineNumber,this.positionColumn)}getSelectionStart(){return new A(this.selectionStartLineNumber,this.selectionStartColumn)}setStartPosition(e,t){return this.getDirection()===0?new o(e,t,this.endLineNumber,this.endColumn):new o(this.endLineNumber,this.endColumn,e,t)}static fromPositions(e,t=e){return new o(e.lineNumber,e.column,t.lineNumber,t.column)}static fromRange(e,t){return t===0?new o(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn):new o(e.endLineNumber,e.endColumn,e.startLineNumber,e.startColumn)}static liftSelection(e){return new o(e.selectionStartLineNumber,e.selectionStartColumn,e.positionLineNumber,e.positionColumn)}static selectionsArrEqual(e,t){if(e&&!t||!e&&t)return!1;if(!e&&!t)return!0;if(e.length!==t.length)return!1;for(let n=0,i=e.length;n<i;n++)if(!this.selectionsEqual(e[n],t[n]))return!1;return!0}static isISelection(e){return e&&typeof e.selectionStartLineNumber=="number"&&typeof e.selectionStartColumn=="number"&&typeof e.positionLineNumber=="number"&&typeof e.positionColumn=="number"}static createWithDirection(e,t,n,i,r){return r===0?new o(e,t,n,i):new o(n,i,e,t)}};var rr=class{static getLanguageId(e){return(e&255)>>>0}static getTokenType(e){return(e&768)>>>8}static containsBalancedBrackets(e){return(e&1024)!==0}static getFontStyle(e){return(e&30720)>>>11}static getForeground(e){return(e&16744448)>>>15}static getBackground(e){return(e&4278190080)>>>24}static getClassNameFromMetadata(e){let n="mtk"+this.getForeground(e),i=this.getFontStyle(e);return i&1&&(n+=" mtki"),i&2&&(n+=" mtkb"),i&4&&(n+=" mtku"),i&8&&(n+=" mtks"),n}static getInlineStyleFromMetadata(e,t){let n=this.getForeground(e),i=this.getFontStyle(e),r=`color: ${t[n]};`;i&1&&(r+="font-style: italic;"),i&2&&(r+="font-weight: bold;");let s="";return i&4&&(s+=" underline"),i&8&&(s+=" line-through"),s&&(r+=`text-decoration:${s};`),r}static getPresentationFromMetadata(e){let t=this.getForeground(e),n=this.getFontStyle(e);return{foreground:t,italic:!!(n&1),bold:!!(n&2),underline:!!(n&4),strikethrough:!!(n&8)}}};function Md(o){if(!o||typeof o!="object"||o instanceof RegExp)return o;let e=Array.isArray(o)?[]:{};return Object.entries(o).forEach(([t,n])=>{e[t]=n&&typeof n=="object"?Md(n):n}),e}var L9=Object.prototype.hasOwnProperty;function jL(o,e){return GL(o,e,new Set)}function GL(o,e,t){if(gn(o))return o;let n=e(o);if(typeof n<"u")return n;if(Array.isArray(o)){let i=[];for(let r of o)i.push(GL(r,e,t));return i}if(an(o)){if(t.has(o))throw new Error("Cannot clone recursive data-structure");t.add(o);let i={};for(let r in o)L9.call(o,r)&&(i[r]=GL(o[r],e,t));return t.delete(o),i}return o}function Mn(o,e){if(o===e)return!0;if(o==null||e===null||e===void 0||typeof o!=typeof e||typeof o!="object"||Array.isArray(o)!==Array.isArray(e))return!1;let t,n;if(Array.isArray(o)){if(o.length!==e.length)return!1;for(t=0;t<o.length;t++)if(!Mn(o[t],e[t]))return!1}else{let i=[];for(n in o)i.push(n);i.sort();let r=[];for(n in e)r.push(n);if(r.sort(),!Mn(i,r))return!1;for(t=0;t<i.length;t++)if(!Mn(o[i[t]],e[i[t]]))return!1}return!0}function JF(o,e){let t=Object.create(null);return!o||!e||Object.keys(e).forEach(i=>{let r=o[i],s=e[i];Mn(r,s)||(t[i]=s)}),t}var $L;function eB(){return $L||($L=new TextDecoder("UTF-16LE")),$L}var YL;function R9(){return YL||(YL=new TextDecoder("UTF-16BE")),YL}var ZL;function XL(){return ZL||(ZL=iA()?eB():R9()),ZL}function tB(o,e,t){let n=new Uint16Array(o.buffer,e,t);return t>0&&(n[0]===65279||n[0]===65534)?k9(o,e,t):eB().decode(n)}function k9(o,e,t){let n=[],i=0;for(let r=0;r<t;r++){let s=rF(o,e);e+=2,n[i++]=String.fromCharCode(s)}return n.join("")}var va=class{_capacity;_buffer;_completedStrings;_bufferLength;constructor(e){this._capacity=e|0,this._buffer=new Uint16Array(this._capacity),this._completedStrings=null,this._bufferLength=0}reset(){this._completedStrings=null,this._bufferLength=0}build(){return this._completedStrings!==null?(this._flushBuffer(),this._completedStrings.join("")):this._buildBuffer()}_buildBuffer(){if(this._bufferLength===0)return"";let e=new Uint16Array(this._buffer.buffer,0,this._bufferLength);return XL().decode(e)}_flushBuffer(){let e=this._buildBuffer();this._bufferLength=0,this._completedStrings===null?this._completedStrings=[e]:this._completedStrings[this._completedStrings.length]=e}appendCharCode(e){let t=this._capacity-this._bufferLength;t<=1&&(t===0||ln(e))&&this._flushBuffer(),this._buffer[this._bufferLength++]=e}appendASCIICharCode(e){this._bufferLength===this._capacity&&this._flushBuffer(),this._buffer[this._bufferLength++]=e}appendString(e){let t=e.length;if(this._bufferLength+t>=this._capacity){this._flushBuffer(),this._completedStrings[this._completedStrings.length]=e;return}for(let n=0;n<t;n++)this._buffer[this._bufferLength++]=e.charCodeAt(n)}};function qI(o){return o.replace(/\n/g,"\\n").replace(/\r/g,"\\r")}var sr=class o{constructor(e,t,n,i){this.oldPosition=e;this.oldText=t;this.newPosition=n;this.newText=i}get oldLength(){return this.oldText.length}get oldEnd(){return this.oldPosition+this.oldText.length}get newLength(){return this.newText.length}get newEnd(){return this.newPosition+this.newText.length}toString(){return this.oldText.length===0?`(insert@${this.oldPosition} "${qI(this.newText)}")`:this.newText.length===0?`(delete@${this.oldPosition} "${qI(this.oldText)}")`:`(replace@${this.oldPosition} "${qI(this.oldText)}" with "${qI(this.newText)}")`}static _writeStringSize(e){return 4+2*e.length}static _writeString(e,t,n){let i=t.length;hi(e,i,n),n+=4;for(let r=0;r<i;r++)sF(e,t.charCodeAt(r),n),n+=2;return n}static _readString(e,t){let n=pi(e,t);return t+=4,tB(e,t,n)}writeSize(){return 8+o._writeStringSize(this.oldText)+o._writeStringSize(this.newText)}write(e,t){return hi(e,this.oldPosition,t),t+=4,hi(e,this.newPosition,t),t+=4,t=o._writeString(e,this.oldText,t),t=o._writeString(e,this.newText,t),t}static read(e,t,n){let i=pi(e,t);t+=4;let r=pi(e,t);t+=4;let s=o._readString(e,t);t+=o._writeStringSize(s);let a=o._readString(e,t);return t+=o._writeStringSize(a),n.push(new o(i,s,r,a)),t}};function nB(o,e){return o===null||o.length===0?e:new QL(o,e).compress()}var QL=class o{_prevEdits;_currEdits;_result;_resultLen;_prevLen;_prevDeltaOffset;_currLen;_currDeltaOffset;constructor(e,t){this._prevEdits=e,this._currEdits=t,this._result=[],this._resultLen=0,this._prevLen=this._prevEdits.length,this._prevDeltaOffset=0,this._currLen=this._currEdits.length,this._currDeltaOffset=0}compress(){let e=0,t=0,n=this._getPrev(e),i=this._getCurr(t);for(;e<this._prevLen||t<this._currLen;){if(n===null){this._acceptCurr(i),i=this._getCurr(++t);continue}if(i===null){this._acceptPrev(n),n=this._getPrev(++e);continue}if(i.oldEnd<=n.newPosition){this._acceptCurr(i),i=this._getCurr(++t);continue}if(n.newEnd<=i.oldPosition){this._acceptPrev(n),n=this._getPrev(++e);continue}if(i.oldPosition<n.newPosition){let[d,c]=o._splitCurr(i,n.newPosition-i.oldPosition);this._acceptCurr(d),i=c;continue}if(n.newPosition<i.oldPosition){let[d,c]=o._splitPrev(n,i.oldPosition-n.newPosition);this._acceptPrev(d),n=c;continue}let a,l;if(i.oldEnd===n.newEnd)a=n,l=i,n=this._getPrev(++e),i=this._getCurr(++t);else if(i.oldEnd<n.newEnd){let[d,c]=o._splitPrev(n,i.oldLength);a=d,l=i,n=c,i=this._getCurr(++t)}else{let[d,c]=o._splitCurr(i,n.newLength);a=n,l=d,n=this._getPrev(++e),i=c}this._result[this._resultLen++]=new sr(a.oldPosition,a.oldText,l.newPosition,l.newText),this._prevDeltaOffset+=a.newLength-a.oldLength,this._currDeltaOffset+=l.newLength-l.oldLength}let r=o._merge(this._result);return o._removeNoOps(r)}_acceptCurr(e){this._result[this._resultLen++]=o._rebaseCurr(this._prevDeltaOffset,e),this._currDeltaOffset+=e.newLength-e.oldLength}_getCurr(e){return e<this._currLen?this._currEdits[e]:null}_acceptPrev(e){this._result[this._resultLen++]=o._rebasePrev(this._currDeltaOffset,e),this._prevDeltaOffset+=e.newLength-e.oldLength}_getPrev(e){return e<this._prevLen?this._prevEdits[e]:null}static _rebaseCurr(e,t){return new sr(t.oldPosition-e,t.oldText,t.newPosition,t.newText)}static _rebasePrev(e,t){return new sr(t.oldPosition,t.oldText,t.newPosition+e,t.newText)}static _splitPrev(e,t){let n=e.newText.substr(0,t),i=e.newText.substr(t);return[new sr(e.oldPosition,e.oldText,e.newPosition,n),new sr(e.oldEnd,"",e.newPosition+t,i)]}static _splitCurr(e,t){let n=e.oldText.substr(0,t),i=e.oldText.substr(t);return[new sr(e.oldPosition,n,e.newPosition,e.newText),new sr(e.oldPosition+t,i,e.newEnd,"")]}static _merge(e){if(e.length===0)return e;let t=[],n=0,i=e[0];for(let r=1;r<e.length;r++){let s=e[r];i.oldEnd===s.oldPosition?i=new sr(i.oldPosition,i.oldText+s.oldText,i.newPosition,i.newText+s.newText):(t[n++]=i,i=s)}return t[n++]=i,t}static _removeNoOps(e){if(e.length===0)return e;let t=[],n=0;for(let i=0;i<e.length;i++){let r=e[i];r.oldText!==r.newText&&(t[n++]=r)}return t}};var ih=class o{_asciiMap;_map;_defaultValue;constructor(e){let t=Yc(e);this._defaultValue=t,this._asciiMap=o._createAsciiMap(t),this._map=new Map}static _createAsciiMap(e){let t=new Uint8Array(256);return t.fill(e),t}set(e,t){let n=Yc(t);e>=0&&e<256?this._asciiMap[e]=n:this._map.set(e,n)}get(e){return e>=0&&e<256?this._asciiMap[e]:this._map.get(e)||this._defaultValue}clear(){this._asciiMap.fill(this._defaultValue),this._map.clear()}};var JL=class extends ih{intlSegmenterLocales;_segmenter=null;_cachedLine=null;_cachedSegments=[];constructor(e,t){super(0),this.intlSegmenterLocales=t,this.intlSegmenterLocales.length>0?this._segmenter=new Intl.Segmenter(this.intlSegmenterLocales,{granularity:"word"}):this._segmenter=null;for(let n=0,i=e.length;n<i;n++)this.set(e.charCodeAt(n),2);this.set(32,1),this.set(9,1)}findPrevIntlWordBeforeOrAtOffset(e,t){let n=null;for(let i of this._getIntlSegmenterWordsOnLine(e)){if(i.index>t)break;n=i}return n}findNextIntlWordAtOrAfterOffset(e,t){for(let n of this._getIntlSegmenterWordsOnLine(e))if(!(n.index<t))return n;return null}_getIntlSegmenterWordsOnLine(e){return this._segmenter?this._cachedLine===e?this._cachedSegments:(this._cachedLine=e,this._cachedSegments=this._filterWordSegments(this._segmenter.segment(e)),this._cachedSegments):[]}_filterWordSegments(e){let t=[];for(let n of e)this._isWordLike(n)&&t.push(n);return t}_isWordLike(e){return!!e.isWordLike}},iB=new Jo(10);function ya(o,e){let t=`${o}/${e.join(",")}`,n=iB.get(t);return n||(n=new JL(o,e),iB.set(t,n)),n}var eR="`~!@#$%^&*()-=+[{]}\\|;:'\",.<>/?";function P9(o=""){let e="(-?\\d*\\.\\d\\w*)|([^";for(let t of eR)o.indexOf(t)>=0||(e+="\\"+t);return e+="\\s]+)",new RegExp(e,"g")}var $I=P9();function Vf(o){let e=$I;if(o&&o instanceof RegExp)if(o.global)e=o;else{let t="g";o.ignoreCase&&(t+="i"),o.multiline&&(t+="m"),o.unicode&&(t+="u"),e=new RegExp(o.source,t)}return e.lastIndex=0,e}var oB=new zi;oB.unshift({maxLen:1e3,windowSize:15,timeBudget:150});function Wf(o,e,t,n,i){if(e=Vf(e),i||(i=Je.first(oB)),t.length>i.maxLen){let d=o-i.maxLen/2;return d<0?d=0:n+=d,t=t.substring(d,o+i.maxLen/2),Wf(o,e,t,n,i)}let r=Date.now(),s=o-1-n,a=-1,l=null;for(let d=1;!(Date.now()-r>=i.timeBudget);d++){let c=s-i.windowSize*d;e.lastIndex=Math.max(0,c);let u=O9(e,t,s,a);if(!u&&l||(l=u,c<=0))break;a=c}if(l){let d={word:l[0],startColumn:n+1+l.index,endColumn:n+1+l.index+l[0].length};return e.lastIndex=0,d}return null}function O9(o,e,t,n){let i;for(;i=o.exec(e);){let r=i.index||0;if(r<=t&&o.lastIndex>=t)return i;if(n>0&&r>n)return null}return null}var Di=Y("languageService");var ke=class o{constructor(e,t){this.start=e;this.endExclusive=t;if(e>t)throw new Ye(`Invalid range: ${this.toString()}`)}static addRange(e,t){let n=0;for(;n<t.length&&t[n].endExclusive<e.start;)n++;let i=n;for(;i<t.length&&t[i].start<=e.endExclusive;)i++;if(n===i)t.splice(n,0,e);else{let r=Math.min(e.start,t[n].start),s=Math.max(e.endExclusive,t[i-1].endExclusive);t.splice(n,i-n,new o(r,s))}}static tryCreate(e,t){if(!(e>t))return new o(e,t)}static ofLength(e){return new o(0,e)}static ofStartAndLength(e,t){return new o(e,e+t)}static emptyAt(e){return new o(e,e)}get isEmpty(){return this.start===this.endExclusive}delta(e){return new o(this.start+e,this.endExclusive+e)}deltaStart(e){return new o(this.start+e,this.endExclusive)}deltaEnd(e){return new o(this.start,this.endExclusive+e)}get length(){return this.endExclusive-this.start}toString(){return`[${this.start}, ${this.endExclusive})`}equals(e){return this.start===e.start&&this.endExclusive===e.endExclusive}containsRange(e){return this.start<=e.start&&e.endExclusive<=this.endExclusive}contains(e){return this.start<=e&&e<this.endExclusive}join(e){return new o(Math.min(this.start,e.start),Math.max(this.endExclusive,e.endExclusive))}intersect(e){let t=Math.max(this.start,e.start),n=Math.min(this.endExclusive,e.endExclusive);if(t<=n)return new o(t,n)}intersectionLength(e){let t=Math.max(this.start,e.start),n=Math.min(this.endExclusive,e.endExclusive);return Math.max(0,n-t)}intersects(e){let t=Math.max(this.start,e.start),n=Math.min(this.endExclusive,e.endExclusive);return t<n}intersectsOrTouches(e){let t=Math.max(this.start,e.start),n=Math.min(this.endExclusive,e.endExclusive);return t<=n}isBefore(e){return this.endExclusive<=e.start}isAfter(e){return this.start>=e.endExclusive}slice(e){return e.slice(this.start,this.endExclusive)}substring(e){return e.substring(this.start,this.endExclusive)}clip(e){if(this.isEmpty)throw new Ye(`Invalid clipping range: ${this.toString()}`);return Math.max(this.start,Math.min(this.endExclusive-1,e))}clipCyclic(e){if(this.isEmpty)throw new Ye(`Invalid clipping range: ${this.toString()}`);return e<this.start?this.endExclusive-(this.start-e)%this.length:e>=this.endExclusive?this.start+(e-this.start)%this.length:e}map(e){let t=[];for(let n=this.start;n<this.endExclusive;n++)t.push(e(n));return t}forEach(e){for(let t=this.start;t<this.endExclusive;t++)e(t)}},YI=class o{_sortedRanges=[];addRange(e){let t=0;for(;t<this._sortedRanges.length&&this._sortedRanges[t].endExclusive<e.start;)t++;let n=t;for(;n<this._sortedRanges.length&&this._sortedRanges[n].start<=e.endExclusive;)n++;if(t===n)this._sortedRanges.splice(t,0,e);else{let i=Math.min(e.start,this._sortedRanges[t].start),r=Math.max(e.endExclusive,this._sortedRanges[n-1].endExclusive);this._sortedRanges.splice(t,n-t,new ke(i,r))}}toString(){return this._sortedRanges.map(e=>e.toString()).join(", ")}intersectsStrict(e){let t=0;for(;t<this._sortedRanges.length&&this._sortedRanges[t].endExclusive<=e.start;)t++;return t<this._sortedRanges.length&&this._sortedRanges[t].start<e.endExclusive}intersectWithRange(e){let t=new o;for(let n of this._sortedRanges){let i=n.intersect(e);i&&t.addRange(i)}return t}intersectWithRangeLength(e){return this.intersectWithRange(e).length}get length(){return this._sortedRanges.reduce((e,t)=>e+t.length,0)}};var tR=class o{constructor(e){this._tokenInfo=e}static create(e){return new o(e)}forEach(e){let t=0;for(let n of this._tokenInfo){let i=new ke(t,t+n.length);e(i,n),t+=n.length}}slice(e){let t=[],n=0;for(let i of this._tokenInfo){let r=n,s=r+i.length;if(s>e.start){if(r>=e.endExclusive)break;let a=Math.max(0,e.start-r),l=Math.max(0,s-e.endExclusive);t.push(new ZI(i.length-a-l,i.metadata))}n+=i.length}return o.create(t)}},ZI=class{constructor(e,t){this.length=e;this.metadata=t}},XI=class{_tokens=[];add(e,t){this._tokens.push(new ZI(e,t))}build(){return tR.create(this._tokens)}};var Sn=class o{static createEmpty(e,t){let n=o.defaultTokenMetadata,i=new Uint32Array(2);return i[0]=e.length,i[1]=n,new o(i,e,t)}static createFromTextAndMetadata(e,t){let n=0,i="",r=new Array;for(let{text:s,metadata:a}of e)r.push(n+s.length,a),n+=s.length,i+=s;return new o(new Uint32Array(r),i,t)}static convertToEndOffset(e,t){let i=(e.length>>>1)-1;for(let r=0;r<i;r++)e[r<<1]=e[r+1<<1];e[i<<1]=t}static findIndexInTokensArray(e,t){if(e.length<=2)return 0;let n=0,i=(e.length>>>1)-1;for(;n<i;){let r=n+Math.floor((i-n)/2),s=e[r<<1];if(s===t)return r+1;s<t?n=r+1:s>t&&(i=r)}return n}_lineTokensBrand=void 0;_tokens;_tokensCount;_text;languageIdCodec;static defaultTokenMetadata=(32768|2<<24)>>>0;constructor(e,t,n){this._tokens=e,this._tokensCount=this._tokens.length>>>1,this._text=t,this.languageIdCodec=n}equals(e){return e instanceof o?this.slicedEquals(e,0,this._tokensCount):!1}slicedEquals(e,t,n){if(this._text!==e._text||this._tokensCount!==e._tokensCount)return!1;let i=t<<1,r=i+(n<<1);for(let s=i;s<r;s++)if(this._tokens[s]!==e._tokens[s])return!1;return!0}getLineContent(){return this._text}getCount(){return this._tokensCount}getStartOffset(e){return e>0?this._tokens[e-1<<1]:0}getMetadata(e){return this._tokens[(e<<1)+1]}getLanguageId(e){let t=this._tokens[(e<<1)+1],n=rr.getLanguageId(t);return this.languageIdCodec.decodeLanguageId(n)}getStandardTokenType(e){let t=this._tokens[(e<<1)+1];return rr.getTokenType(t)}getForeground(e){let t=this._tokens[(e<<1)+1];return rr.getForeground(t)}getClassName(e){let t=this._tokens[(e<<1)+1];return rr.getClassNameFromMetadata(t)}getInlineStyle(e,t){let n=this._tokens[(e<<1)+1];return rr.getInlineStyleFromMetadata(n,t)}getPresentation(e){let t=this._tokens[(e<<1)+1];return rr.getPresentationFromMetadata(t)}getEndOffset(e){return this._tokens[e<<1]}findTokenIndexAtOffset(e){return o.findIndexInTokensArray(this._tokens,e)}inflate(){return this}sliceAndInflate(e,t,n){return new nR(this,e,t,n)}withInserted(e){if(e.length===0)return this;let t=0,n=0,i="",r=new Array,s=0;for(;;){let a=t<this._tokensCount?this._tokens[t<<1]:-1,l=n<e.length?e[n]:null;if(a!==-1&&(l===null||a<=l.offset)){i+=this._text.substring(s,a);let d=this._tokens[(t<<1)+1];r.push(i.length,d),t++,s=a}else if(l){if(l.offset>s){i+=this._text.substring(s,l.offset);let d=this._tokens[(t<<1)+1];r.push(i.length,d),s=l.offset}i+=l.text,r.push(i.length,l.tokenMetadata),n++}else break}return new o(new Uint32Array(r),i,this.languageIdCodec)}getTokensInRange(e){let t=new XI,n=this.findTokenIndexAtOffset(e.start),i=this.findTokenIndexAtOffset(e.endExclusive);for(let r=n;r<=i;r++){let a=new ke(this.getStartOffset(r),this.getEndOffset(r)).intersectionLength(e);a>0&&t.add(a,this.getMetadata(r))}return t.build()}getTokenText(e){let t=this.getStartOffset(e),n=this.getEndOffset(e);return this._text.substring(t,n)}forEach(e){let t=this.getCount();for(let n=0;n<t;n++)e(n)}},nR=class o{_source;_startOffset;_endOffset;_deltaOffset;_firstTokenIndex;_tokensCount;languageIdCodec;constructor(e,t,n,i){this._source=e,this._startOffset=t,this._endOffset=n,this._deltaOffset=i,this._firstTokenIndex=e.findTokenIndexAtOffset(t),this.languageIdCodec=e.languageIdCodec,this._tokensCount=0;for(let r=this._firstTokenIndex,s=e.getCount();r<s&&!(e.getStartOffset(r)>=n);r++)this._tokensCount++}getMetadata(e){return this._source.getMetadata(this._firstTokenIndex+e)}getLanguageId(e){return this._source.getLanguageId(this._firstTokenIndex+e)}getLineContent(){return this._source.getLineContent().substring(this._startOffset,this._endOffset)}equals(e){return e instanceof o?this._startOffset===e._startOffset&&this._endOffset===e._endOffset&&this._deltaOffset===e._deltaOffset&&this._source.slicedEquals(e._source,this._firstTokenIndex,this._tokensCount):!1}getCount(){return this._tokensCount}getStandardTokenType(e){return this._source.getStandardTokenType(this._firstTokenIndex+e)}getForeground(e){return this._source.getForeground(this._firstTokenIndex+e)}getEndOffset(e){let t=this._source.getEndOffset(this._firstTokenIndex+e);return Math.min(this._endOffset,t)-this._startOffset+this._deltaOffset}getClassName(e){return this._source.getClassName(this._firstTokenIndex+e)}getInlineStyle(e,t){return this._source.getInlineStyle(this._firstTokenIndex+e,t)}getPresentation(e){return this._source.getPresentation(this._firstTokenIndex+e)}findTokenIndexAtOffset(e){return this._source.findTokenIndexAtOffset(e+this._startOffset-this._deltaOffset)-this._firstTokenIndex}getTokenText(e){let t=this._firstTokenIndex+e,n=this._source.getStartOffset(t),i=this._source.getEndOffset(t),r=this._source.getTokenText(t);return n<this._startOffset&&(r=r.substring(this._startOffset-n)),i>this._endOffset&&(r=r.substring(0,r.length-(i-this._endOffset))),r}forEach(e){for(let t=0;t<this.getCount();t++)e(t)}};function Ia(o,e){let t=o.getCount(),n=o.findTokenIndexAtOffset(e),i=o.getLanguageId(n),r=n;for(;r+1<t&&o.getLanguageId(r+1)===i;)r++;let s=n;for(;s>0&&o.getLanguageId(s-1)===i;)s--;return new oR(o,i,s,r+1,o.getStartOffset(s),o.getEndOffset(r))}var oR=class{_scopedLineTokensBrand=void 0;languageIdCodec;languageId;_actual;_firstTokenIndex;_lastTokenIndex;firstCharOffset;_lastCharOffset;constructor(e,t,n,i,r,s){this._actual=e,this.languageId=t,this._firstTokenIndex=n,this._lastTokenIndex=i,this.firstCharOffset=r,this._lastCharOffset=s,this.languageIdCodec=e.languageIdCodec}getLineContent(){return this._actual.getLineContent().substring(this.firstCharOffset,this._lastCharOffset)}getLineLength(){return this._lastCharOffset-this.firstCharOffset}getActualLineContentBefore(e){return this._actual.getLineContent().substring(0,this.firstCharOffset+e)}getTokenCount(){return this._lastTokenIndex-this._firstTokenIndex}findTokenIndexAtOffset(e){return this._actual.findTokenIndexAtOffset(e+this.firstCharOffset)-this._firstTokenIndex}getStandardTokenType(e){return this._actual.getStandardTokenType(e+this._firstTokenIndex)}toIViewLineTokens(){return this._actual.sliceAndInflate(this.firstCharOffset,this._lastCharOffset,0)}},sB=(e=>(e[e.value=3]="value",e))(sB||{});function Qr(o){return(o&sB.value)!==0}var oh=class{open;close;_inString;_inComment;_inRegEx;_neutralCharacter=null;_neutralCharacterSearched=!1;constructor(e){if(this.open=e.open,this.close=e.close,this._inString=!0,this._inComment=!0,this._inRegEx=!0,Array.isArray(e.notIn))for(let t=0,n=e.notIn.length;t<n;t++)switch(e.notIn[t]){case"string":this._inString=!1;break;case"comment":this._inComment=!1;break;case"regex":this._inRegEx=!1;break}}isOK(e){switch(e){case 0:return!0;case 1:return this._inComment;case 2:return this._inString;case 3:return this._inRegEx}}shouldAutoClose(e,t){if(e.getTokenCount()===0)return!0;let n=e.findTokenIndexAtOffset(t-2),i=e.getStandardTokenType(n);return this.isOK(i)}_findNeutralCharacterInRange(e,t){for(let n=e;n<=t;n++){let i=String.fromCharCode(n);if(!this.open.includes(i)&&!this.close.includes(i))return i}return null}findNeutralCharacter(){return this._neutralCharacterSearched||(this._neutralCharacterSearched=!0,this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(48,57)),this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(97,122)),this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(65,90))),this._neutralCharacter}},QI=class{autoClosingPairsOpenByStart;autoClosingPairsOpenByEnd;autoClosingPairsCloseByStart;autoClosingPairsCloseByEnd;autoClosingPairsCloseSingleChar;constructor(e){this.autoClosingPairsOpenByStart=new Map,this.autoClosingPairsOpenByEnd=new Map,this.autoClosingPairsCloseByStart=new Map,this.autoClosingPairsCloseByEnd=new Map,this.autoClosingPairsCloseSingleChar=new Map;for(let t of e)Hf(this.autoClosingPairsOpenByStart,t.open.charAt(0),t),Hf(this.autoClosingPairsOpenByEnd,t.open.charAt(t.open.length-1),t),Hf(this.autoClosingPairsCloseByStart,t.close.charAt(0),t),Hf(this.autoClosingPairsCloseByEnd,t.close.charAt(t.close.length-1),t),t.close.length===1&&t.open.length===1&&Hf(this.autoClosingPairsCloseSingleChar,t.close,t)}};function Hf(o,e,t){o.has(e)?o.get(e).push(t):o.set(e,[t])}var rR=class o{_richEditBracketBrand=void 0;languageId;index;open;close;forwardRegex;reversedRegex;_openSet;_closeSet;constructor(e,t,n,i,r,s){this.languageId=e,this.index=t,this.open=n,this.close=i,this.forwardRegex=r,this.reversedRegex=s,this._openSet=o._toSet(this.open),this._closeSet=o._toSet(this.close)}isOpen(e){return this._openSet.has(e)}isClose(e){return this._closeSet.has(e)}static _toSet(e){let t=new Set;for(let n of e)t.add(n);return t}};function N9(o){let e=o.length;o=o.map(s=>[s[0].toLowerCase(),s[1].toLowerCase()]);let t=[];for(let s=0;s<e;s++)t[s]=s;let n=(s,a)=>{let[l,d]=s,[c,u]=a;return l===c||l===u||d===c||d===u},i=(s,a)=>{let l=Math.min(s,a),d=Math.max(s,a);for(let c=0;c<e;c++)t[c]===d&&(t[c]=l)};for(let s=0;s<e;s++){let a=o[s];for(let l=s+1;l<e;l++){let d=o[l];n(a,d)&&i(t[s],t[l])}}let r=[];for(let s=0;s<e;s++){let a=[],l=[];for(let d=0;d<e;d++)if(t[d]===s){let[c,u]=o[d];a.push(c),l.push(u)}a.length>0&&r.push({open:a,close:l})}return r}var JI=class{_richEditBracketsBrand=void 0;brackets;forwardRegex;reversedRegex;maxBracketLength;textIsBracket;textIsOpenBracket;constructor(e,t){let n=N9(t);this.brackets=n.map((i,r)=>new rR(e,r,i.open,i.close,A9(i.open,i.close,n,r),F9(i.open,i.close,n,r))),this.forwardRegex=B9(this.brackets),this.reversedRegex=V9(this.brackets),this.textIsBracket={},this.textIsOpenBracket={},this.maxBracketLength=0;for(let i of this.brackets){for(let r of i.open)this.textIsBracket[r]=i,this.textIsOpenBracket[r]=!0,this.maxBracketLength=Math.max(this.maxBracketLength,r.length);for(let r of i.close)this.textIsBracket[r]=i,this.textIsOpenBracket[r]=!1,this.maxBracketLength=Math.max(this.maxBracketLength,r.length)}}};function aB(o,e,t,n){for(let i=0,r=e.length;i<r;i++){if(i===t)continue;let s=e[i];for(let a of s.open)a.indexOf(o)>=0&&n.push(a);for(let a of s.close)a.indexOf(o)>=0&&n.push(a)}}function lB(o,e){return o.length-e.length}function eC(o){if(o.length<=1)return o;let e=[],t=new Set;for(let n of o)t.has(n)||(e.push(n),t.add(n));return e}function A9(o,e,t,n){let i=[];i=i.concat(o),i=i.concat(e);for(let r=0,s=i.length;r<s;r++)aB(i[r],t,n,i);return i=eC(i),i.sort(lB),i.reverse(),rh(i)}function F9(o,e,t,n){let i=[];i=i.concat(o),i=i.concat(e);for(let r=0,s=i.length;r<s;r++)aB(i[r],t,n,i);return i=eC(i),i.sort(lB),i.reverse(),rh(i.map(sR))}function B9(o){let e=[];for(let t of o){for(let n of t.open)e.push(n);for(let n of t.close)e.push(n)}return e=eC(e),rh(e)}function V9(o){let e=[];for(let t of o){for(let n of t.open)e.push(n);for(let n of t.close)e.push(n)}return e=eC(e),rh(e.map(sR))}function W9(o){let e=/^[\w ]+$/.test(o);return o=ji(o),e?`\\b${o}\\b`:o}function rh(o,e){let t=`(${o.map(W9).join(")|(")})`;return sI(t,!0,e)}var sR=function(){function o(n){let i=new Uint16Array(n.length),r=0;for(let s=n.length-1;s>=0;s--)i[r++]=n.charCodeAt(s);return XL().decode(i)}let e=null,t=null;return function(i){return e!==i&&(e=i,t=o(e)),t}}(),bo=class{static _findPrevBracketInText(e,t,n,i){let r=n.match(e);if(!r)return null;let s=n.length-(r.index||0),a=r[0].length,l=i+s;return new P(t,l-a+1,t,l+1)}static findPrevBracketInRange(e,t,n,i,r){let a=sR(n).substring(n.length-r,n.length-i);return this._findPrevBracketInText(e,t,a,i)}static findNextBracketInText(e,t,n,i){let r=n.match(e);if(!r)return null;let s=r.index||0,a=r[0].length;if(a===0)return null;let l=i+s;return new P(t,l+1,t,l+1+a)}static findNextBracketInRange(e,t,n,i,r){let s=n.substring(i,r);return this.findNextBracketInText(e,t,s,i)}};var tC=class{constructor(e,t){this.languageId=e;let n=t.brackets?dB(t.brackets):[],i=new bd(a=>{let l=new Set;return{info:new aR(this,a,l),closing:l}}),r=new bd(a=>{let l=new Set,d=new Set;return{info:new lR(this,a,l,d),opening:l,openingColorized:d}});for(let[a,l]of n){let d=i.get(a),c=r.get(l);d.closing.add(c.info),c.opening.add(d.info)}let s=t.colorizedBracketPairs?dB(t.colorizedBracketPairs):n.filter(a=>!(a[0]==="<"&&a[1]===">"));for(let[a,l]of s){let d=i.get(a),c=r.get(l);d.closing.add(c.info),c.openingColorized.add(d.info),c.opening.add(d.info)}this._openingBrackets=new Map([...i.cachedValues].map(([a,l])=>[a,l.info])),this._closingBrackets=new Map([...r.cachedValues].map(([a,l])=>[a,l.info]))}_openingBrackets;_closingBrackets;get openingBrackets(){return[...this._openingBrackets.values()]}get closingBrackets(){return[...this._closingBrackets.values()]}getOpeningBracketInfo(e){return this._openingBrackets.get(e)}getClosingBracketInfo(e){return this._closingBrackets.get(e)}getBracketInfo(e){return this.getOpeningBracketInfo(e)||this.getClosingBracketInfo(e)}getBracketRegExp(e){let t=Array.from([...this._openingBrackets.keys(),...this._closingBrackets.keys()]);return rh(t,e)}};function dB(o){return o.filter(([e,t])=>e!==""&&t!=="")}var nC=class{constructor(e,t){this.config=e;this.bracketText=t}get languageId(){return this.config.languageId}},aR=class extends nC{constructor(t,n,i){super(t,n);this.openedBrackets=i}isOpeningBracket=!0},lR=class extends nC{constructor(t,n,i,r){super(t,n);this.openingBrackets=i;this.openingColorizedBrackets=r}isOpeningBracket=!1;closes(t){return t.config!==this.config?!1:this.openingBrackets.has(t)}closesColorized(t){return t.config!==this.config?!1:this.openingColorizedBrackets.has(t)}getOpeningBrackets(){return[...this.openingBrackets]}};var Vt=class o{static _nextVisibleColumn(e,t,n){return e===9?o.nextRenderTabStop(t,n):Rr(e)||vf(e)?t+2:t+1}static visibleColumnFromColumn(e,t,n){let i=Math.min(t-1,e.length),r=e.substring(0,i),s=new Qc(r),a=0;for(;!s.eol();){let l=qp(r,i,s.offset);s.nextGraphemeLength(),a=this._nextVisibleColumn(l,a,n)}return a}static toStatusbarColumn(e,t,n){let i=e.substring(0,Math.min(t-1,e.length)),r=new Xc(i),s=0;for(;!r.eol();)r.nextCodePoint()===9?s=o.nextRenderTabStop(s,n):s=s+1;return s+1}static columnFromVisibleColumn(e,t,n){if(t<=0)return 1;let i=e.length,r=new Qc(e),s=0,a=1;for(;!r.eol();){let l=qp(e,i,r.offset);r.nextGraphemeLength();let d=this._nextVisibleColumn(l,s,n),c=r.offset+1;if(d>=t){let u=t-s;return d-t<u?c:a}s=d,a=c}return i+1}static nextRenderTabStop(e,t){return e+t-e%t}static nextIndentTabStop(e,t){return e+t-e%t}static prevRenderTabStop(e,t){return Math.max(0,e-1-(e-1)%t)}static prevIndentTabStop(e,t){return Math.max(0,e-1-(e-1)%t)}};var Oo=class o{constructor(e,t){this.lineCount=e;this.columnCount=t}static zero=new o(0,0);static lengthDiffNonNegative(e,t){return t.isLessThan(e)?o.zero:e.lineCount===t.lineCount?new o(0,t.columnCount-e.columnCount):new o(t.lineCount-e.lineCount,t.columnCount)}static betweenPositions(e,t){return e.lineNumber===t.lineNumber?new o(0,t.column-e.column):new o(t.lineNumber-e.lineNumber,t.column-1)}static ofRange(e){return o.betweenPositions(e.getStartPosition(),e.getEndPosition())}static ofText(e){let t=0,n=0;for(let i of e)i===`
`?(t++,n=0):n++;return new o(t,n)}isZero(){return this.lineCount===0&&this.columnCount===0}isLessThan(e){return this.lineCount!==e.lineCount?this.lineCount<e.lineCount:this.columnCount<e.columnCount}isGreaterThan(e){return this.lineCount!==e.lineCount?this.lineCount>e.lineCount:this.columnCount>e.columnCount}isGreaterThanOrEqualTo(e){return this.lineCount!==e.lineCount?this.lineCount>e.lineCount:this.columnCount>=e.columnCount}equals(e){return this.lineCount===e.lineCount&&this.columnCount===e.columnCount}compare(e){return this.lineCount!==e.lineCount?this.lineCount-e.lineCount:this.columnCount-e.columnCount}add(e){return e.lineCount===0?new o(this.lineCount,this.columnCount+e.columnCount):new o(this.lineCount+e.lineCount,e.columnCount)}createRange(e){return this.lineCount===0?new P(e.lineNumber,e.column,e.lineNumber,e.column+this.columnCount):new P(e.lineNumber,e.column,e.lineNumber+this.lineCount,this.columnCount+1)}toRange(){return new P(1,1,this.lineCount+1,this.columnCount+1)}addToPosition(e){return this.lineCount===0?new A(e.lineNumber,e.column+this.columnCount):new A(e.lineNumber+this.lineCount,this.columnCount+1)}toString(){return`${this.lineCount},${this.columnCount}`}};function cB(o,e,t,n){return o!==t?Qt(t-o,n):Qt(0,n-e)}var ei=0;function sh(o){return o===0}var ar=2**26;function Qt(o,e){return o*ar+e}function to(o){let e=o,t=Math.floor(e/ar),n=e-t*ar;return new Oo(t,n)}function uB(o){return Math.floor(o/ar)}function jt(o,e){let t=o+e;return e>=ar&&(t=t-o%ar),t}function pB(o,e){return o.reduce((t,n)=>jt(t,e(n)),ei)}function dR(o,e){return o===e}function lu(o,e){let t=o,n=e;if(n-t<=0)return ei;let r=Math.floor(t/ar),s=Math.floor(n/ar),a=n-s*ar;if(r===s){let l=t-r*ar;return Qt(0,a-l)}else return Qt(s-r,a)}function Tl(o,e){return o<e}function Pd(o,e){return o<=e}function ah(o,e){return o>=e}function Od(o){return Qt(o.lineNumber-1,o.column-1)}function Nd(o,e){let t=o,n=Math.floor(t/ar),i=t-n*ar,r=e,s=Math.floor(r/ar),a=r-s*ar;return new P(n+1,i+1,s+1,a+1)}function hB(o){let e=pf(o);return Qt(e.length-1,e[e.length-1].length)}var iC=[],Li=class o{constructor(e,t){this.items=e;this.additionalItems=t}static cache=new Array(129);static create(e,t){if(e<=128&&t.length===0){let n=o.cache[e];return n||(n=new o(e,t),o.cache[e]=n),n}return new o(e,t)}static empty=o.create(0,iC);static getEmpty(){return this.empty}add(e,t){let n=t.getKey(e),i=n>>5;if(i===0){let s=1<<n|this.items;return s===this.items?this:o.create(s,this.additionalItems)}i--;let r=this.additionalItems.slice(0);for(;r.length<i;)r.push(0);return r[i]|=1<<(n&31),o.create(this.items,r)}has(e,t){let n=t.getKey(e),i=n>>5;return i===0?(this.items&1<<n)!==0:(i--,((this.additionalItems[i]||0)&1<<(n&31))!==0)}merge(e){let t=this.items|e.items;if(this.additionalItems===iC&&e.additionalItems===iC)return t===this.items?this:t===e.items?e:o.create(t,iC);let n=[];for(let i=0;i<Math.max(this.additionalItems.length,e.additionalItems.length);i++){let r=this.additionalItems[i]||0,s=e.additionalItems[i]||0;n.push(r|s)}return o.create(t,n)}intersects(e){if(this.items&e.items)return!0;for(let t=0;t<Math.min(this.additionalItems.length,e.additionalItems.length);t++)if(this.additionalItems[t]&e.additionalItems[t])return!0;return!1}equals(e){if(this.items!==e.items||this.additionalItems.length!==e.additionalItems.length)return!1;for(let t=0;t<this.additionalItems.length;t++)if(this.additionalItems[t]!==e.additionalItems[t])return!1;return!0}},cR={getKey(o){return o}},oC=class{items=new Map;getKey(e){let t=this.items.get(e);return t===void 0&&(t=this.items.size,this.items.set(e,t)),t}reverseLookup(e){return[...this.items].find(([t,n])=>n===e)?.[0]}reverseLookupSet(e){let t=[];for(let[n]of this.items)e.has(n,this)&&t.push(n);return t}keys(){return this.items.keys()}};var rC=class o{static DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_QUOTES=`;:.,=}])> 
	`;static DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_BRACKETS=`'"\`;:.,=}])> 
	`;static DEFAULT_AUTOCLOSE_BEFORE_WHITESPACE=` 
	`;_autoClosingPairs;_surroundingPairs;_autoCloseBeforeForQuotes;_autoCloseBeforeForBrackets;constructor(e){if(e.autoClosingPairs?this._autoClosingPairs=e.autoClosingPairs.map(t=>new oh(t)):e.brackets?this._autoClosingPairs=e.brackets.map(t=>new oh({open:t[0],close:t[1]})):this._autoClosingPairs=[],e.__electricCharacterSupport&&e.__electricCharacterSupport.docComment){let t=e.__electricCharacterSupport.docComment;this._autoClosingPairs.push(new oh({open:t.open,close:t.close||""}))}this._autoCloseBeforeForQuotes=typeof e.autoCloseBefore=="string"?e.autoCloseBefore:o.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_QUOTES,this._autoCloseBeforeForBrackets=typeof e.autoCloseBefore=="string"?e.autoCloseBefore:o.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_BRACKETS,this._surroundingPairs=e.surroundingPairs||this._autoClosingPairs}getAutoClosingPairs(){return this._autoClosingPairs}getAutoCloseBeforeSet(e){return e?this._autoCloseBeforeForQuotes:this._autoCloseBeforeForBrackets}getSurroundingPairs(){return this._surroundingPairs}};var sC=class{_richEditBrackets;constructor(e){this._richEditBrackets=e}getElectricCharacters(){let e=[];if(this._richEditBrackets)for(let t of this._richEditBrackets.brackets)for(let n of t.close){let i=n.charAt(n.length-1);e.push(i)}return Tr(e)}onElectricCharacter(e,t,n){if(!this._richEditBrackets||this._richEditBrackets.brackets.length===0)return null;let i=t.findTokenIndexAtOffset(n-1);if(Qr(t.getStandardTokenType(i)))return null;let r=this._richEditBrackets.reversedRegex,s=t.getLineContent().substring(0,n-1)+e,a=bo.findPrevBracketInRange(r,1,s,0,s.length);if(!a)return null;let l=s.substring(a.startColumn-1,a.endColumn-1).toLowerCase();if(this._richEditBrackets.textIsOpenBracket[l])return null;let c=t.getActualLineContentBefore(a.startColumn-1);return/^\s*$/.test(c)?{matchOpenBracket:l}:null}};function aC(o){return o.global&&(o.lastIndex=0),!0}var lC=class{_indentationRules;constructor(e){this._indentationRules=e}shouldIncrease(e){return!!(this._indentationRules&&this._indentationRules.increaseIndentPattern&&aC(this._indentationRules.increaseIndentPattern)&&this._indentationRules.increaseIndentPattern.test(e))}shouldDecrease(e){return!!(this._indentationRules&&this._indentationRules.decreaseIndentPattern&&aC(this._indentationRules.decreaseIndentPattern)&&this._indentationRules.decreaseIndentPattern.test(e))}shouldIndentNextLine(e){return!!(this._indentationRules&&this._indentationRules.indentNextLinePattern&&aC(this._indentationRules.indentNextLinePattern)&&this._indentationRules.indentNextLinePattern.test(e))}shouldIgnore(e){return!!(this._indentationRules&&this._indentationRules.unIndentedLinePattern&&aC(this._indentationRules.unIndentedLinePattern)&&this._indentationRules.unIndentedLinePattern.test(e))}getIndentMetadata(e){let t=0;return this.shouldIncrease(e)&&(t+=1),this.shouldDecrease(e)&&(t+=2),this.shouldIndentNextLine(e)&&(t+=4),this.shouldIgnore(e)&&(t+=8),t}};var pR=class o{constructor(e,t,n,i,r,s,a){this._forceIntegerValues=e;this._forceIntegerValues&&(t=t|0,n=n|0,i=i|0,r=r|0,s=s|0,a=a|0),this.rawScrollLeft=i,this.rawScrollTop=a,t<0&&(t=0),i+t>n&&(i=n-t),i<0&&(i=0),r<0&&(r=0),a+r>s&&(a=s-r),a<0&&(a=0),this.width=t,this.scrollWidth=n,this.scrollLeft=i,this.height=r,this.scrollHeight=s,this.scrollTop=a}_scrollStateBrand=void 0;rawScrollLeft;rawScrollTop;width;scrollWidth;scrollLeft;height;scrollHeight;scrollTop;equals(e){return this.rawScrollLeft===e.rawScrollLeft&&this.rawScrollTop===e.rawScrollTop&&this.width===e.width&&this.scrollWidth===e.scrollWidth&&this.scrollLeft===e.scrollLeft&&this.height===e.height&&this.scrollHeight===e.scrollHeight&&this.scrollTop===e.scrollTop}withScrollDimensions(e,t){return new o(this._forceIntegerValues,typeof e.width<"u"?e.width:this.width,typeof e.scrollWidth<"u"?e.scrollWidth:this.scrollWidth,t?this.rawScrollLeft:this.scrollLeft,typeof e.height<"u"?e.height:this.height,typeof e.scrollHeight<"u"?e.scrollHeight:this.scrollHeight,t?this.rawScrollTop:this.scrollTop)}withScrollPosition(e){return new o(this._forceIntegerValues,this.width,this.scrollWidth,typeof e.scrollLeft<"u"?e.scrollLeft:this.rawScrollLeft,this.height,this.scrollHeight,typeof e.scrollTop<"u"?e.scrollTop:this.rawScrollTop)}createScrollEvent(e,t){let n=this.width!==e.width,i=this.scrollWidth!==e.scrollWidth,r=this.scrollLeft!==e.scrollLeft,s=this.height!==e.height,a=this.scrollHeight!==e.scrollHeight,l=this.scrollTop!==e.scrollTop;return{inSmoothScrolling:t,oldWidth:e.width,oldScrollWidth:e.scrollWidth,oldScrollLeft:e.scrollLeft,width:this.width,scrollWidth:this.scrollWidth,scrollLeft:this.scrollLeft,oldHeight:e.height,oldScrollHeight:e.scrollHeight,oldScrollTop:e.scrollTop,height:this.height,scrollHeight:this.scrollHeight,scrollTop:this.scrollTop,widthChanged:n,scrollWidthChanged:i,scrollLeftChanged:r,heightChanged:s,scrollHeightChanged:a,scrollTopChanged:l}}},xs=class extends F{_scrollableBrand=void 0;_smoothScrollDuration;_scheduleAtNextAnimationFrame;_state;_smoothScrolling;_onScroll=this._register(new D);onScroll=this._onScroll.event;constructor(e){super(),this._smoothScrollDuration=e.smoothScrollDuration,this._scheduleAtNextAnimationFrame=e.scheduleAtNextAnimationFrame,this._state=new pR(e.forceIntegerValues,0,0,0,0,0,0),this._smoothScrolling=null}dispose(){this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),super.dispose()}setSmoothScrollDuration(e){this._smoothScrollDuration=e}validateScrollPosition(e){return this._state.withScrollPosition(e)}getScrollDimensions(){return this._state}setScrollDimensions(e,t){let n=this._state.withScrollDimensions(e,t);this._setState(n,!!this._smoothScrolling),this._smoothScrolling?.acceptScrollDimensions(this._state)}getFutureScrollPosition(){return this._smoothScrolling?this._smoothScrolling.to:this._state}getCurrentScrollPosition(){return this._state}setScrollPositionNow(e){let t=this._state.withScrollPosition(e);this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),this._setState(t,!1)}setScrollPositionSmooth(e,t){if(this._smoothScrollDuration===0)return this.setScrollPositionNow(e);if(this._smoothScrolling){e={scrollLeft:typeof e.scrollLeft>"u"?this._smoothScrolling.to.scrollLeft:e.scrollLeft,scrollTop:typeof e.scrollTop>"u"?this._smoothScrolling.to.scrollTop:e.scrollTop};let n=this._state.withScrollPosition(e);if(this._smoothScrolling.to.scrollLeft===n.scrollLeft&&this._smoothScrolling.to.scrollTop===n.scrollTop)return;let i;t?i=new cC(this._smoothScrolling.from,n,this._smoothScrolling.startTime,this._smoothScrolling.duration):i=this._smoothScrolling.combine(this._state,n,this._smoothScrollDuration),this._smoothScrolling.dispose(),this._smoothScrolling=i}else{let n=this._state.withScrollPosition(e);this._smoothScrolling=cC.start(this._state,n,this._smoothScrollDuration)}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())})}hasPendingScrollAnimation(){return!!this._smoothScrolling}_performSmoothScrolling(){if(!this._smoothScrolling)return;let e=this._smoothScrolling.tick(),t=this._state.withScrollPosition(e);if(this._setState(t,!0),!!this._smoothScrolling){if(e.isDone){this._smoothScrolling.dispose(),this._smoothScrolling=null;return}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())})}}_setState(e,t){let n=this._state;n.equals(e)||(this._state=e,this._onScroll.fire(this._state.createScrollEvent(n,t)))}},dC=class{scrollLeft;scrollTop;isDone;constructor(e,t,n){this.scrollLeft=e,this.scrollTop=t,this.isDone=n}};function uR(o,e){let t=e-o;return function(n){return o+t*z9(n)}}function H9(o,e,t){return function(n){return n<t?o(n/t):e((n-t)/(1-t))}}var cC=class o{from;to;duration;startTime;animationFrameDisposable;scrollLeft;scrollTop;constructor(e,t,n,i){this.from=e,this.to=t,this.duration=i,this.startTime=n,this.animationFrameDisposable=null,this._initAnimations()}_initAnimations(){this.scrollLeft=this._initAnimation(this.from.scrollLeft,this.to.scrollLeft,this.to.width),this.scrollTop=this._initAnimation(this.from.scrollTop,this.to.scrollTop,this.to.height)}_initAnimation(e,t,n){if(Math.abs(e-t)>2.5*n){let r,s;return e<t?(r=e+.75*n,s=t-.75*n):(r=e-.75*n,s=t+.75*n),H9(uR(e,r),uR(s,t),.33)}return uR(e,t)}dispose(){this.animationFrameDisposable!==null&&(this.animationFrameDisposable.dispose(),this.animationFrameDisposable=null)}acceptScrollDimensions(e){this.to=e.withScrollPosition(this.to),this._initAnimations()}tick(){return this._tick(Date.now())}_tick(e){let t=(e-this.startTime)/this.duration;if(t<1){let n=this.scrollLeft(t),i=this.scrollTop(t);return new dC(n,i,!1)}return new dC(this.to.scrollLeft,this.to.scrollTop,!0)}combine(e,t,n){return o.start(e,t,n)}static start(e,t,n){n=n+10;let i=Date.now()-10;return new o(e,t,i,n)}};function U9(o){return Math.pow(o,3)}function z9(o){return 1-U9(1-o)}var Ca=new class{_zoomLevel=0;_onDidChangeZoomLevel=new D;onDidChangeZoomLevel=this._onDidChangeZoomLevel.event;getZoomLevel(){return this._zoomLevel}setZoomLevel(o){o=Math.min(Math.max(-5,o),20),this._zoomLevel!==o&&(this._zoomLevel=o,this._onDidChangeZoomLevel.fire(this._zoomLevel))}};var K9=Ve?1.5:1.35,hR=8,Uf=class o{_bareFontInfoBrand=void 0;static createFromValidatedSettings(e,t,n){let i=e.get(50),r=e.get(54),s=e.get(53),a=e.get(52),l=e.get(55),d=e.get(68),c=e.get(65);return o._create(i,r,s,a,l,d,c,t,n)}static createFromRawSettings(e,t,n=!1){let i=Jr.fontFamily.validate(e.fontFamily),r=Jr.fontWeight.validate(e.fontWeight),s=Jr.fontSize.validate(e.fontSize),a=Jr.fontLigatures2.validate(e.fontLigatures),l=Jr.fontVariations.validate(e.fontVariations),d=Jr.lineHeight.validate(e.lineHeight),c=Jr.letterSpacing.validate(e.letterSpacing);return o._create(i,r,s,a,l,d,c,t,n)}static _create(e,t,n,i,r,s,a,l,d){s===0?s=K9*n:s<hR&&(s=s*n),s=Math.round(s),s<hR&&(s=hR);let c=1+(d?0:Ca.getZoomLevel()*.1);return n*=c,s*=c,r===dh.TRANSLATE&&(t==="normal"||t==="bold"?r=dh.OFF:(r=`'wght' ${parseInt(t,10)}`,t="normal")),new o({pixelRatio:l,fontFamily:e,fontWeight:t,fontSize:n,fontFeatureSettings:i,fontVariationSettings:r,lineHeight:s,letterSpacing:a})}pixelRatio;fontFamily;fontWeight;fontSize;fontFeatureSettings;fontVariationSettings;lineHeight;letterSpacing;constructor(e){this.pixelRatio=e.pixelRatio,this.fontFamily=String(e.fontFamily),this.fontWeight=String(e.fontWeight),this.fontSize=e.fontSize,this.fontFeatureSettings=e.fontFeatureSettings,this.fontVariationSettings=e.fontVariationSettings,this.lineHeight=e.lineHeight|0,this.letterSpacing=e.letterSpacing}getId(){return`${this.pixelRatio}-${this.fontFamily}-${this.fontWeight}-${this.fontSize}-${this.fontFeatureSettings}-${this.fontVariationSettings}-${this.lineHeight}-${this.letterSpacing}`}getMassagedFontFamily(){let e=No.fontFamily,t=o._wrapInQuotes(this.fontFamily);return e&&this.fontFamily!==e?`${t}, ${e}`:t}static _wrapInQuotes(e){return/[,"']/.test(e)?e:/[+ ]/.test(e)?`"${e}"`:e}},mR=2,lh=class extends Uf{_editorStylingBrand=void 0;version=mR;isTrusted;isMonospace;typicalHalfwidthCharacterWidth;typicalFullwidthCharacterWidth;canUseHalfwidthRightwardsArrow;spaceWidth;middotWidth;wsmiddotWidth;maxDigitWidth;constructor(e,t){super(e),this.isTrusted=t,this.isMonospace=e.isMonospace,this.typicalHalfwidthCharacterWidth=e.typicalHalfwidthCharacterWidth,this.typicalFullwidthCharacterWidth=e.typicalFullwidthCharacterWidth,this.canUseHalfwidthRightwardsArrow=e.canUseHalfwidthRightwardsArrow,this.spaceWidth=e.spaceWidth,this.middotWidth=e.middotWidth,this.wsmiddotWidth=e.wsmiddotWidth,this.maxDigitWidth=e.maxDigitWidth}equals(e){return this.fontFamily===e.fontFamily&&this.fontWeight===e.fontWeight&&this.fontSize===e.fontSize&&this.fontFeatureSettings===e.fontFeatureSettings&&this.fontVariationSettings===e.fontVariationSettings&&this.lineHeight===e.lineHeight&&this.letterSpacing===e.letterSpacing&&this.typicalHalfwidthCharacterWidth===e.typicalHalfwidthCharacterWidth&&this.typicalFullwidthCharacterWidth===e.typicalFullwidthCharacterWidth&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.maxDigitWidth===e.maxDigitWidth}};var Sa={tabSize:4,indentSize:4,insertSpaces:!0,detectIndentation:!0,trimAutoWhitespace:!0,largeFileOptimizations:!0,bracketPairColorizationOptions:{enabled:!0,independentColorPoolPerBracketType:!1}};var vo=Y("accessibilityService");var qre=new $("accessibilityModeEnabled",!1);var ut=Y("configurationService");function mB(o){return o.replace(/[\[\]]/g,"")}var dse=Y("policy");var Ao={Configuration:"base.contributions.configuration"};var Kf={properties:{},patternProperties:{}},uC={properties:{},patternProperties:{}},pC={properties:{},patternProperties:{}},hC={properties:{},patternProperties:{}},mC={properties:{},patternProperties:{}},zf={properties:{},patternProperties:{}},du="vscode://schemas/settings/resourceLanguage";var gC=et.as(Ld.JSONContribution),gR=class{registeredConfigurationDefaults=[];configurationDefaultsOverrides;defaultLanguageConfigurationOverridesNode;configurationContributors;configurationProperties;policyConfigurations;excludedConfigurationProperties;resourceLanguageSettingsSchema;overrideIdentifiers=new Set;_onDidSchemaChange=new D;onDidSchemaChange=this._onDidSchemaChange.event;_onDidUpdateConfiguration=new D;onDidUpdateConfiguration=this._onDidUpdateConfiguration.event;constructor(){this.configurationDefaultsOverrides=new Map,this.defaultLanguageConfigurationOverridesNode={id:"defaultOverrides",title:m("defaultLanguageConfigurationOverrides.title","Default Language Configuration Overrides"),properties:{}},this.configurationContributors=[this.defaultLanguageConfigurationOverridesNode],this.resourceLanguageSettingsSchema={properties:{},patternProperties:{},additionalProperties:!0,allowTrailingCommas:!0,allowComments:!0},this.configurationProperties={},this.policyConfigurations=new Map,this.excludedConfigurationProperties={},gC.registerSchema(du,this.resourceLanguageSettingsSchema),this.registerOverridePropertyPatternKey()}registerConfiguration(e,t=!0){this.registerConfigurations([e],t)}registerConfigurations(e,t=!0){let n=new Set;this.doRegisterConfigurations(e,t,n),gC.registerSchema(du,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:n})}deregisterConfigurations(e){let t=new Set;this.doDeregisterConfigurations(e,t),gC.registerSchema(du,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:t})}updateConfigurations({add:e,remove:t}){let n=new Set;this.doDeregisterConfigurations(t,n),this.doRegisterConfigurations(e,!1,n),gC.registerSchema(du,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:n})}registerDefaultConfigurations(e){let t=new Set;this.doRegisterDefaultConfigurations(e,t),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:t,defaultsOverrides:!0})}doRegisterDefaultConfigurations(e,t){this.registeredConfigurationDefaults.push(...e);let n=[];for(let{overrides:i,source:r}of e)for(let s in i){t.add(s);let a=this.configurationDefaultsOverrides.get(s)??this.configurationDefaultsOverrides.set(s,{configurationDefaultOverrides:[]}).get(s),l=i[s];if(a.configurationDefaultOverrides.push({value:l,source:r}),ch.test(s)){let d=this.mergeDefaultConfigurationsForOverrideIdentifier(s,l,r,a.configurationDefaultOverrideValue);if(!d)continue;a.configurationDefaultOverrideValue=d,this.updateDefaultOverrideProperty(s,d,r),n.push(...G9(s))}else{let d=this.mergeDefaultConfigurationsForConfigurationProperty(s,l,r,a.configurationDefaultOverrideValue);if(!d)continue;a.configurationDefaultOverrideValue=d;let c=this.configurationProperties[s];c&&(this.updatePropertyDefaultValue(s,c),this.updateSchema(s,c))}}this.doRegisterOverrideIdentifiers(n)}deregisterDefaultConfigurations(e){let t=new Set;this.doDeregisterDefaultConfigurations(e,t),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:t,defaultsOverrides:!0})}doDeregisterDefaultConfigurations(e,t){for(let n of e){let i=this.registeredConfigurationDefaults.indexOf(n);i!==-1&&this.registeredConfigurationDefaults.splice(i,1)}for(let{overrides:n,source:i}of e)for(let r in n){let s=this.configurationDefaultsOverrides.get(r);if(!s)continue;let a=s.configurationDefaultOverrides.findIndex(l=>i?l.source?.id===i.id:l.value===n[r]);if(a!==-1){if(s.configurationDefaultOverrides.splice(a,1),s.configurationDefaultOverrides.length===0&&this.configurationDefaultsOverrides.delete(r),ch.test(r)){let l;for(let d of s.configurationDefaultOverrides)l=this.mergeDefaultConfigurationsForOverrideIdentifier(r,d.value,d.source,l);l&&!qc(l.value)?(s.configurationDefaultOverrideValue=l,this.updateDefaultOverrideProperty(r,l,i)):(this.configurationDefaultsOverrides.delete(r),delete this.configurationProperties[r],delete this.defaultLanguageConfigurationOverridesNode.properties[r])}else{let l;for(let c of s.configurationDefaultOverrides)l=this.mergeDefaultConfigurationsForConfigurationProperty(r,c.value,c.source,l);s.configurationDefaultOverrideValue=l;let d=this.configurationProperties[r];d&&(this.updatePropertyDefaultValue(r,d),this.updateSchema(r,d))}t.add(r)}}this.updateOverridePropertyPatternKey()}updateDefaultOverrideProperty(e,t,n){let i={type:"object",default:t.value,description:m("defaultLanguageConfiguration.description","Configure settings to be overridden for the {0} language.",mB(e)),$ref:du,defaultDefaultValue:t.value,source:n,defaultValueSource:n};this.configurationProperties[e]=i,this.defaultLanguageConfigurationOverridesNode.properties[e]=i}mergeDefaultConfigurationsForOverrideIdentifier(e,t,n,i){let r=i?.value||{},s=i?.source??new Map;if(!(s instanceof Map)){console.error("objectConfigurationSources is not a Map");return}for(let a of Object.keys(t)){let l=t[a];if(an(l)&&(Kn(r[a])||an(r[a]))){if(r[a]={...r[a]??{},...l},n)for(let c in l)s.set(`${a}.${c}`,n)}else r[a]=l,n?s.set(a,n):s.delete(a)}return{value:r,source:s}}mergeDefaultConfigurationsForConfigurationProperty(e,t,n,i){let r=this.configurationProperties[e],s=i?.value??r?.defaultDefaultValue,a=n;if(an(t)&&(r!==void 0&&r.type==="object"||r===void 0&&(Kn(s)||an(s)))){if(a=i?.source??new Map,!(a instanceof Map)){console.error("defaultValueSource is not a Map");return}for(let d in t)n&&a.set(`${e}.${d}`,n);t={...an(s)?s:{},...t}}return{value:t,source:a}}deltaConfiguration(e){let t=!1,n=new Set;e.removedDefaults&&(this.doDeregisterDefaultConfigurations(e.removedDefaults,n),t=!0),e.addedDefaults&&(this.doRegisterDefaultConfigurations(e.addedDefaults,n),t=!0),e.removedConfigurations&&this.doDeregisterConfigurations(e.removedConfigurations,n),e.addedConfigurations&&this.doRegisterConfigurations(e.addedConfigurations,!1,n),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:n,defaultsOverrides:t})}notifyConfigurationSchemaUpdated(...e){this._onDidSchemaChange.fire()}registerOverrideIdentifiers(e){this.doRegisterOverrideIdentifiers(e),this._onDidSchemaChange.fire()}doRegisterOverrideIdentifiers(e){for(let t of e)this.overrideIdentifiers.add(t);this.updateOverridePropertyPatternKey()}doRegisterConfigurations(e,t,n){e.forEach(i=>{this.validateAndRegisterProperties(i,t,i.extensionInfo,i.restrictedProperties,void 0,n),this.configurationContributors.push(i),this.registerJSONConfiguration(i)})}doDeregisterConfigurations(e,t){let n=i=>{if(i.properties)for(let r in i.properties){t.add(r);let s=this.configurationProperties[r];s?.policy?.name&&this.policyConfigurations.delete(s.policy.name),delete this.configurationProperties[r],this.removeFromSchema(r,i.properties[r])}i.allOf?.forEach(r=>n(r))};for(let i of e){n(i);let r=this.configurationContributors.indexOf(i);r!==-1&&this.configurationContributors.splice(r,1)}}validateAndRegisterProperties(e,t=!0,n,i,r=3,s){r=gn(e.scope)?r:e.scope;let a=e.properties;if(a)for(let d in a){let c=a[d];if(t&&q9(d,c)){delete a[d];continue}if(c.source=n,c.defaultDefaultValue=a[d].default,this.updatePropertyDefaultValue(d,c),ch.test(d)?c.scope=void 0:(c.scope=gn(c.scope)?r:c.scope,c.restricted=gn(c.restricted)?!!i?.includes(d):c.restricted),a[d].hasOwnProperty("included")&&!a[d].included){this.excludedConfigurationProperties[d]=a[d],delete a[d];continue}else this.configurationProperties[d]=a[d],a[d].policy?.name&&this.policyConfigurations.set(a[d].policy.name,d);!a[d].deprecationMessage&&a[d].markdownDeprecationMessage&&(a[d].deprecationMessage=a[d].markdownDeprecationMessage),s.add(d)}let l=e.allOf;if(l)for(let d of l)this.validateAndRegisterProperties(d,t,n,i,r,s)}getConfigurations(){return this.configurationContributors}getConfigurationProperties(){return this.configurationProperties}getPolicyConfigurations(){return this.policyConfigurations}getExcludedConfigurationProperties(){return this.excludedConfigurationProperties}getRegisteredDefaultConfigurations(){return[...this.registeredConfigurationDefaults]}getConfigurationDefaultsOverrides(){let e=new Map;for(let[t,n]of this.configurationDefaultsOverrides)n.configurationDefaultOverrideValue&&e.set(t,n.configurationDefaultOverrideValue);return e}registerJSONConfiguration(e){let t=n=>{let i=n.properties;if(i)for(let s in i)this.updateSchema(s,i[s]);n.allOf?.forEach(t)};t(e)}updateSchema(e,t){switch(Kf.properties[e]=t,t.scope){case 1:uC.properties[e]=t;break;case 2:pC.properties[e]=t;break;case 6:hC.properties[e]=t;break;case 3:mC.properties[e]=t;break;case 4:zf.properties[e]=t;break;case 5:zf.properties[e]=t,this.resourceLanguageSettingsSchema.properties[e]=t;break}}removeFromSchema(e,t){switch(delete Kf.properties[e],t.scope){case 1:delete uC.properties[e];break;case 2:delete pC.properties[e];break;case 6:delete hC.properties[e];break;case 3:delete mC.properties[e];break;case 4:case 5:delete zf.properties[e],delete this.resourceLanguageSettingsSchema.properties[e];break}}updateOverridePropertyPatternKey(){for(let e of this.overrideIdentifiers.values()){let t=`[${e}]`,n={type:"object",description:m("overrideSettings.defaultDescription","Configure editor settings to be overridden for a language."),errorMessage:m("overrideSettings.errorMessage","This setting does not support per-language configuration."),$ref:du};this.updatePropertyDefaultValue(t,n),Kf.properties[t]=n,uC.properties[t]=n,pC.properties[t]=n,hC.properties[t]=n,mC.properties[t]=n,zf.properties[t]=n}}registerOverridePropertyPatternKey(){let e={type:"object",description:m("overrideSettings.defaultDescription","Configure editor settings to be overridden for a language."),errorMessage:m("overrideSettings.errorMessage","This setting does not support per-language configuration."),$ref:du};Kf.patternProperties[cu]=e,uC.patternProperties[cu]=e,pC.patternProperties[cu]=e,hC.patternProperties[cu]=e,mC.patternProperties[cu]=e,zf.patternProperties[cu]=e,this._onDidSchemaChange.fire()}updatePropertyDefaultValue(e,t){let n=this.configurationDefaultsOverrides.get(e)?.configurationDefaultOverrideValue,i,r;n&&(!t.disallowConfigurationDefault||!n.source)&&(i=n.value,r=n.source),Kn(i)&&(i=t.defaultDefaultValue,r=void 0),Kn(i)&&(i=j9(t.type)),t.default=i,t.defaultValueSource=r}},fB="\\[([^\\]]+)\\]",gB=new RegExp(fB,"g"),cu=`^(${fB})+$`,ch=new RegExp(cu);function G9(o){let e=[];if(ch.test(o)){let t=gB.exec(o);for(;t?.length;){let n=t[1].trim();n&&e.push(n),t=gB.exec(o)}}return Tr(e)}function j9(o){switch(Array.isArray(o)?o[0]:o){case"boolean":return!1;case"integer":case"number":return 0;case"string":return"";case"array":return[];case"object":return{};default:return null}}var fC=new gR;et.add(Ao.Configuration,fC);function q9(o,e){return o.trim()?ch.test(o)?m("config.property.languageDefault","Cannot register '{0}'. This matches property pattern '\\\\[.*\\\\]$' for describing language specific editor settings. Use 'configurationDefaults' contribution.",o):fC.getConfigurationProperties()[o]!==void 0?m("config.property.duplicate","Cannot register '{0}'. This property is already registered.",o):e.policy?.name&&fC.getPolicyConfigurations().get(e.policy?.name)!==void 0?m("config.policy.duplicate","Cannot register '{0}'. The associated policy {1} is already registered with {2}.",o,e.policy?.name,fC.getPolicyConfigurations().get(e.policy?.name)):null:m("config.property.empty","Cannot register an empty property")}var Ds=8,bC=class{_values;constructor(e){this._values=e}hasChanged(e){return this._values[e]}},Gf=class{stableMinimapLayoutInput;stableFitMaxMinimapScale;stableFitRemainingWidth;constructor(){this.stableMinimapLayoutInput=null,this.stableFitMaxMinimapScale=0,this.stableFitRemainingWidth=0}},Mt=class{id;name;defaultValue;schema;constructor(e,t,n,i){this.id=e,this.name=t,this.defaultValue=n,this.schema=i}applyUpdate(e,t){return yC(e,t)}compute(e,t,n){return n}},ph=class{constructor(e,t){this.newValue=e;this.didChange=t}};function yC(o,e){if(typeof o!="object"||typeof e!="object"||!o||!e)return new ph(e,o!==e);if(Array.isArray(o)||Array.isArray(e)){let n=Array.isArray(o)&&Array.isArray(e)&&zt(o,e);return new ph(e,!n)}let t=!1;for(let n in e)if(e.hasOwnProperty(n)){let i=yC(o[n],e[n]);i.didChange&&(o[n]=i.newValue,t=!0)}return new ph(o,t)}var pu=class{id;name;defaultValue;schema=void 0;constructor(e){this.id=e,this.name="_never_",this.defaultValue=void 0}applyUpdate(e,t){return yC(e,t)}validate(e){return this.defaultValue}},Ad=class{id;name;defaultValue;schema;constructor(e,t,n,i){this.id=e,this.name=t,this.defaultValue=n,this.schema=i}applyUpdate(e,t){return yC(e,t)}validate(e){return typeof e>"u"?this.defaultValue:e}compute(e,t,n){return n}};function be(o,e){return typeof o>"u"?e:o==="false"?!1:!!o}var it=class extends Ad{constructor(e,t,n,i=void 0){typeof i<"u"&&(i.type="boolean",i.default=n),super(e,t,n,i)}validate(e){return be(e,this.defaultValue)}};function Fd(o,e,t,n){if(typeof o>"u")return e;let i=parseInt(o,10);return isNaN(i)?e:(i=Math.max(t,i),i=Math.min(n,i),i|0)}var Dt=class o extends Ad{static clampedInt(e,t,n,i){return Fd(e,t,n,i)}minimum;maximum;constructor(e,t,n,i,r,s=void 0){typeof s<"u"&&(s.type="integer",s.default=n,s.minimum=i,s.maximum=r),super(e,t,n,s),this.minimum=i,this.maximum=r}validate(e){return o.clampedInt(e,this.defaultValue,this.minimum,this.maximum)}};function vB(o,e,t,n){if(typeof o>"u")return e;let i=lr.float(o,e);return lr.clamp(i,t,n)}var lr=class o extends Ad{static clamp(e,t,n){return e<t?t:e>n?n:e}static float(e,t){if(typeof e=="number")return e;if(typeof e>"u")return t;let n=parseFloat(e);return isNaN(n)?t:n}validationFn;constructor(e,t,n,i,r){typeof r<"u"&&(r.type="number",r.default=n),super(e,t,n,r),this.validationFn=i}validate(e){return this.validationFn(o.float(e,this.defaultValue))}},qi=class o extends Ad{static string(e,t){return typeof e!="string"?t:e}constructor(e,t,n,i=void 0){typeof i<"u"&&(i.type="string",i.default=n),super(e,t,n,i)}validate(e){return o.string(e,this.defaultValue)}};function Jt(o,e,t,n){return typeof o!="string"?e:n&&o in n?n[o]:t.indexOf(o)===-1?e:o}var qt=class extends Ad{_allowedValues;constructor(e,t,n,i,r=void 0){typeof r<"u"&&(r.type="string",r.enum=i,r.default=n),super(e,t,n,r),this._allowedValues=i}validate(e){return Jt(e,this.defaultValue,this._allowedValues)}},uh=class extends Mt{_allowedValues;_convert;constructor(e,t,n,i,r,s,a=void 0){typeof a<"u"&&(a.type="string",a.enum=r,a.default=i),super(e,t,n,a),this._allowedValues=r,this._convert=s}validate(e){return typeof e!="string"?this.defaultValue:this._allowedValues.indexOf(e)===-1?this.defaultValue:this._convert(e)}};function $9(o){switch(o){case"none":return 0;case"keep":return 1;case"brackets":return 2;case"advanced":return 3;case"full":return 4}}var fR=class extends Mt{constructor(){super(2,"accessibilitySupport",0,{type:"string",enum:["auto","on","off"],enumDescriptions:[m("accessibilitySupport.auto","Use platform APIs to detect when a Screen Reader is attached."),m("accessibilitySupport.on","Optimize for usage with a Screen Reader."),m("accessibilitySupport.off","Assume a screen reader is not attached.")],default:"auto",tags:["accessibility"],description:m("accessibilitySupport","Controls if the UI should run in a mode where it is optimized for screen readers.")})}validate(e){switch(e){case"auto":return 0;case"off":return 1;case"on":return 2}return this.defaultValue}compute(e,t,n){return n===0?e.accessibilitySupport:n}},bR=class extends Mt{constructor(){let e={insertSpace:!0,ignoreEmptyLines:!0};super(23,"comments",e,{"editor.comments.insertSpace":{type:"boolean",default:e.insertSpace,description:m("comments.insertSpace","Controls whether a space character is inserted when commenting.")},"editor.comments.ignoreEmptyLines":{type:"boolean",default:e.ignoreEmptyLines,description:m("comments.ignoreEmptyLines","Controls if empty lines should be ignored with toggle, add or remove actions for line comments.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{insertSpace:be(t.insertSpace,this.defaultValue.insertSpace),ignoreEmptyLines:be(t.ignoreEmptyLines,this.defaultValue.ignoreEmptyLines)}}};function Y9(o){switch(o){case"blink":return 1;case"smooth":return 2;case"phase":return 3;case"expand":return 4;case"solid":return 5}}function Z9(o){switch(o){case"line":return 1;case"block":return 2;case"underline":return 3;case"line-thin":return 4;case"block-outline":return 5;case"underline-thin":return 6}}var vR=class extends pu{constructor(){super(144)}compute(e,t,n){let i=["monaco-editor"];return t.get(40)&&i.push(t.get(40)),e.extraEditorClassName&&i.push(e.extraEditorClassName),t.get(75)==="default"?i.push("mouse-default"):t.get(75)==="copy"&&i.push("mouse-copy"),t.get(113)&&i.push("showUnused"),t.get(142)&&i.push("showDeprecated"),i.join(" ")}},yR=class extends it{constructor(){super(38,"emptySelectionClipboard",!0,{description:m("emptySelectionClipboard","Controls whether copying without a selection copies the current line.")})}compute(e,t,n){return n&&e.emptySelectionClipboard}},IR=class extends Mt{constructor(){let e={cursorMoveOnType:!0,seedSearchStringFromSelection:"always",autoFindInSelection:"never",globalFindClipboard:!1,addExtraSpaceOnTop:!0,loop:!0};super(42,"find",e,{"editor.find.cursorMoveOnType":{type:"boolean",default:e.cursorMoveOnType,description:m("find.cursorMoveOnType","Controls whether the cursor should jump to find matches while typing.")},"editor.find.seedSearchStringFromSelection":{type:"string",enum:["never","always","selection"],default:e.seedSearchStringFromSelection,enumDescriptions:[m("editor.find.seedSearchStringFromSelection.never","Never seed search string from the editor selection."),m("editor.find.seedSearchStringFromSelection.always","Always seed search string from the editor selection, including word at cursor position."),m("editor.find.seedSearchStringFromSelection.selection","Only seed search string from the editor selection.")],description:m("find.seedSearchStringFromSelection","Controls whether the search string in the Find Widget is seeded from the editor selection.")},"editor.find.autoFindInSelection":{type:"string",enum:["never","always","multiline"],default:e.autoFindInSelection,enumDescriptions:[m("editor.find.autoFindInSelection.never","Never turn on Find in Selection automatically (default)."),m("editor.find.autoFindInSelection.always","Always turn on Find in Selection automatically."),m("editor.find.autoFindInSelection.multiline","Turn on Find in Selection automatically when multiple lines of content are selected.")],description:m("find.autoFindInSelection","Controls the condition for turning on Find in Selection automatically.")},"editor.find.globalFindClipboard":{type:"boolean",default:e.globalFindClipboard,description:m("find.globalFindClipboard","Controls whether the Find Widget should read or modify the shared find clipboard on macOS."),included:Ve},"editor.find.addExtraSpaceOnTop":{type:"boolean",default:e.addExtraSpaceOnTop,description:m("find.addExtraSpaceOnTop","Controls whether the Find Widget should add extra lines on top of the editor. When true, you can scroll beyond the first line when the Find Widget is visible.")},"editor.find.loop":{type:"boolean",default:e.loop,description:m("find.loop","Controls whether the search automatically restarts from the beginning (or the end) when no further matches can be found.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{cursorMoveOnType:be(t.cursorMoveOnType,this.defaultValue.cursorMoveOnType),seedSearchStringFromSelection:typeof e.seedSearchStringFromSelection=="boolean"?e.seedSearchStringFromSelection?"always":"never":Jt(t.seedSearchStringFromSelection,this.defaultValue.seedSearchStringFromSelection,["never","always","selection"]),autoFindInSelection:typeof e.autoFindInSelection=="boolean"?e.autoFindInSelection?"always":"never":Jt(t.autoFindInSelection,this.defaultValue.autoFindInSelection,["never","always","multiline"]),globalFindClipboard:be(t.globalFindClipboard,this.defaultValue.globalFindClipboard),addExtraSpaceOnTop:be(t.addExtraSpaceOnTop,this.defaultValue.addExtraSpaceOnTop),loop:be(t.loop,this.defaultValue.loop)}}},_s=class o extends Mt{static OFF='"liga" off, "calt" off';static ON='"liga" on, "calt" on';constructor(){super(52,"fontLigatures",o.OFF,{anyOf:[{type:"boolean",description:m("fontLigatures","Enables/Disables font ligatures ('calt' and 'liga' font features). Change this to a string for fine-grained control of the 'font-feature-settings' CSS property.")},{type:"string",description:m("fontFeatureSettings","Explicit 'font-feature-settings' CSS property. A boolean can be passed instead if one only needs to turn on/off ligatures.")}],description:m("fontLigaturesGeneral","Configures font ligatures or font features. Can be either a boolean to enable/disable ligatures or a string for the value of the CSS 'font-feature-settings' property."),default:!1})}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e==="false"||e.length===0?o.OFF:e==="true"?o.ON:e:e?o.ON:o.OFF}},dh=class o extends Mt{static OFF="normal";static TRANSLATE="translate";constructor(){super(55,"fontVariations",o.OFF,{anyOf:[{type:"boolean",description:m("fontVariations","Enables/Disables the translation from font-weight to font-variation-settings. Change this to a string for fine-grained control of the 'font-variation-settings' CSS property.")},{type:"string",description:m("fontVariationSettings","Explicit 'font-variation-settings' CSS property. A boolean can be passed instead if one only needs to translate font-weight to font-variation-settings.")}],description:m("fontVariationsGeneral","Configures font variations. Can be either a boolean to enable/disable the translation from font-weight to font-variation-settings or a string for the value of the CSS 'font-variation-settings' property."),default:!1})}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e==="false"?o.OFF:e==="true"?o.TRANSLATE:e:e?o.TRANSLATE:o.OFF}compute(e,t,n){return e.fontInfo.fontVariationSettings}},CR=class extends pu{constructor(){super(51)}compute(e,t,n){return e.fontInfo}},SR=class extends Ad{constructor(){super(53,"fontSize",No.fontSize,{type:"number",minimum:6,maximum:100,default:No.fontSize,description:m("fontSize","Controls the font size in pixels.")})}validate(e){let t=lr.float(e,this.defaultValue);return t===0?No.fontSize:lr.clamp(t,6,100)}compute(e,t,n){return e.fontInfo.fontSize}},ER=class o extends Mt{static SUGGESTION_VALUES=["normal","bold","100","200","300","400","500","600","700","800","900"];static MINIMUM_VALUE=1;static MAXIMUM_VALUE=1e3;constructor(){super(54,"fontWeight",No.fontWeight,{anyOf:[{type:"number",minimum:o.MINIMUM_VALUE,maximum:o.MAXIMUM_VALUE,errorMessage:m("fontWeightErrorMessage",'Only "normal" and "bold" keywords or numbers between 1 and 1000 are allowed.')},{type:"string",pattern:"^(normal|bold|1000|[1-9][0-9]{0,2})$"},{enum:o.SUGGESTION_VALUES}],default:No.fontWeight,description:m("fontWeight",'Controls the font weight. Accepts "normal" and "bold" keywords or numbers between 1 and 1000.')})}validate(e){return e==="normal"||e==="bold"?e:String(Dt.clampedInt(e,No.fontWeight,o.MINIMUM_VALUE,o.MAXIMUM_VALUE))}},TR=class extends Mt{constructor(){let e={multiple:"peek",multipleDefinitions:"peek",multipleTypeDefinitions:"peek",multipleDeclarations:"peek",multipleImplementations:"peek",multipleReferences:"peek",multipleTests:"peek",alternativeDefinitionCommand:"editor.action.goToReferences",alternativeTypeDefinitionCommand:"editor.action.goToReferences",alternativeDeclarationCommand:"editor.action.goToReferences",alternativeImplementationCommand:"",alternativeReferenceCommand:"",alternativeTestsCommand:""},t={type:"string",enum:["peek","gotoAndPeek","goto"],default:e.multiple,enumDescriptions:[m("editor.gotoLocation.multiple.peek","Show Peek view of the results (default)"),m("editor.gotoLocation.multiple.gotoAndPeek","Go to the primary result and show a Peek view"),m("editor.gotoLocation.multiple.goto","Go to the primary result and enable Peek-less navigation to others")]},n=["","editor.action.referenceSearch.trigger","editor.action.goToReferences","editor.action.peekImplementation","editor.action.goToImplementation","editor.action.peekTypeDefinition","editor.action.goToTypeDefinition","editor.action.peekDeclaration","editor.action.revealDeclaration","editor.action.peekDefinition","editor.action.revealDefinitionAside","editor.action.revealDefinition"];super(59,"gotoLocation",e,{"editor.gotoLocation.multiple":{deprecationMessage:m("editor.gotoLocation.multiple.deprecated","This setting is deprecated, please use separate settings like 'editor.editor.gotoLocation.multipleDefinitions' or 'editor.editor.gotoLocation.multipleImplementations' instead.")},"editor.gotoLocation.multipleDefinitions":{description:m("editor.editor.gotoLocation.multipleDefinitions","Controls the behavior the 'Go to Definition'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleTypeDefinitions":{description:m("editor.editor.gotoLocation.multipleTypeDefinitions","Controls the behavior the 'Go to Type Definition'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleDeclarations":{description:m("editor.editor.gotoLocation.multipleDeclarations","Controls the behavior the 'Go to Declaration'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleImplementations":{description:m("editor.editor.gotoLocation.multipleImplemenattions","Controls the behavior the 'Go to Implementations'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleReferences":{description:m("editor.editor.gotoLocation.multipleReferences","Controls the behavior the 'Go to References'-command when multiple target locations exist."),...t},"editor.gotoLocation.alternativeDefinitionCommand":{type:"string",default:e.alternativeDefinitionCommand,enum:n,description:m("alternativeDefinitionCommand","Alternative command id that is being executed when the result of 'Go to Definition' is the current location.")},"editor.gotoLocation.alternativeTypeDefinitionCommand":{type:"string",default:e.alternativeTypeDefinitionCommand,enum:n,description:m("alternativeTypeDefinitionCommand","Alternative command id that is being executed when the result of 'Go to Type Definition' is the current location.")},"editor.gotoLocation.alternativeDeclarationCommand":{type:"string",default:e.alternativeDeclarationCommand,enum:n,description:m("alternativeDeclarationCommand","Alternative command id that is being executed when the result of 'Go to Declaration' is the current location.")},"editor.gotoLocation.alternativeImplementationCommand":{type:"string",default:e.alternativeImplementationCommand,enum:n,description:m("alternativeImplementationCommand","Alternative command id that is being executed when the result of 'Go to Implementation' is the current location.")},"editor.gotoLocation.alternativeReferenceCommand":{type:"string",default:e.alternativeReferenceCommand,enum:n,description:m("alternativeReferenceCommand","Alternative command id that is being executed when the result of 'Go to Reference' is the current location.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{multiple:Jt(t.multiple,this.defaultValue.multiple,["peek","gotoAndPeek","goto"]),multipleDefinitions:t.multipleDefinitions??Jt(t.multipleDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleTypeDefinitions:t.multipleTypeDefinitions??Jt(t.multipleTypeDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleDeclarations:t.multipleDeclarations??Jt(t.multipleDeclarations,"peek",["peek","gotoAndPeek","goto"]),multipleImplementations:t.multipleImplementations??Jt(t.multipleImplementations,"peek",["peek","gotoAndPeek","goto"]),multipleReferences:t.multipleReferences??Jt(t.multipleReferences,"peek",["peek","gotoAndPeek","goto"]),multipleTests:t.multipleTests??Jt(t.multipleTests,"peek",["peek","gotoAndPeek","goto"]),alternativeDefinitionCommand:qi.string(t.alternativeDefinitionCommand,this.defaultValue.alternativeDefinitionCommand),alternativeTypeDefinitionCommand:qi.string(t.alternativeTypeDefinitionCommand,this.defaultValue.alternativeTypeDefinitionCommand),alternativeDeclarationCommand:qi.string(t.alternativeDeclarationCommand,this.defaultValue.alternativeDeclarationCommand),alternativeImplementationCommand:qi.string(t.alternativeImplementationCommand,this.defaultValue.alternativeImplementationCommand),alternativeReferenceCommand:qi.string(t.alternativeReferenceCommand,this.defaultValue.alternativeReferenceCommand),alternativeTestsCommand:qi.string(t.alternativeTestsCommand,this.defaultValue.alternativeTestsCommand)}}},xR=class extends Mt{constructor(){let e={enabled:!0,delay:300,hidingDelay:300,sticky:!0,above:!0};super(61,"hover",e,{"editor.hover.enabled":{type:"boolean",default:e.enabled,description:m("hover.enabled","Controls whether the hover is shown.")},"editor.hover.delay":{type:"number",default:e.delay,minimum:0,maximum:1e4,description:m("hover.delay","Controls the delay in milliseconds after which the hover is shown.")},"editor.hover.sticky":{type:"boolean",default:e.sticky,description:m("hover.sticky","Controls whether the hover should remain visible when mouse is moved over it.")},"editor.hover.hidingDelay":{type:"integer",minimum:0,default:e.hidingDelay,description:m("hover.hidingDelay","Controls the delay in milliseconds after which the hover is hidden. Requires `editor.hover.sticky` to be enabled.")},"editor.hover.above":{type:"boolean",default:e.above,description:m("hover.above","Prefer showing hovers above the line, if there's space.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:be(t.enabled,this.defaultValue.enabled),delay:Dt.clampedInt(t.delay,this.defaultValue.delay,0,1e4),sticky:be(t.sticky,this.defaultValue.sticky),hidingDelay:Dt.clampedInt(t.hidingDelay,this.defaultValue.hidingDelay,0,6e5),above:be(t.above,this.defaultValue.above)}}};var jf=class o extends pu{constructor(){super(147)}compute(e,t,n){return o.computeLayout(t,{memory:e.memory,outerWidth:e.outerWidth,outerHeight:e.outerHeight,isDominatedByLongLines:e.isDominatedByLongLines,lineHeight:e.fontInfo.lineHeight,viewLineCount:e.viewLineCount,lineNumbersDigitCount:e.lineNumbersDigitCount,typicalHalfwidthCharacterWidth:e.fontInfo.typicalHalfwidthCharacterWidth,maxDigitWidth:e.fontInfo.maxDigitWidth,pixelRatio:e.pixelRatio,glyphMarginDecorationLaneCount:e.glyphMarginDecorationLaneCount})}static computeContainedMinimapLineCount(e){let t=e.height/e.lineHeight,n=Math.floor(e.paddingTop/e.lineHeight),i=Math.floor(e.paddingBottom/e.lineHeight);e.scrollBeyondLastLine&&(i=Math.max(i,t-1));let r=(n+e.viewLineCount+i)/(e.pixelRatio*e.height),s=Math.floor(e.viewLineCount/r);return{typicalViewportLineCount:t,extraLinesBeforeFirstLine:n,extraLinesBeyondLastLine:i,desiredRatio:r,minimapLineCount:s}}static _computeMinimapLayout(e,t){let n=e.outerWidth,i=e.outerHeight,r=e.pixelRatio;if(!e.minimap.enabled)return{renderMinimap:0,minimapLeft:0,minimapWidth:0,minimapHeightIsEditorHeight:!1,minimapIsSampling:!1,minimapScale:1,minimapLineHeight:1,minimapCanvasInnerWidth:0,minimapCanvasInnerHeight:Math.floor(r*i),minimapCanvasOuterWidth:0,minimapCanvasOuterHeight:i};let s=t.stableMinimapLayoutInput,a=s&&e.outerHeight===s.outerHeight&&e.lineHeight===s.lineHeight&&e.typicalHalfwidthCharacterWidth===s.typicalHalfwidthCharacterWidth&&e.pixelRatio===s.pixelRatio&&e.scrollBeyondLastLine===s.scrollBeyondLastLine&&e.paddingTop===s.paddingTop&&e.paddingBottom===s.paddingBottom&&e.minimap.enabled===s.minimap.enabled&&e.minimap.side===s.minimap.side&&e.minimap.size===s.minimap.size&&e.minimap.showSlider===s.minimap.showSlider&&e.minimap.renderCharacters===s.minimap.renderCharacters&&e.minimap.maxColumn===s.minimap.maxColumn&&e.minimap.scale===s.minimap.scale&&e.verticalScrollbarWidth===s.verticalScrollbarWidth&&e.isViewportWrapping===s.isViewportWrapping,l=e.lineHeight,d=e.typicalHalfwidthCharacterWidth,c=e.scrollBeyondLastLine,u=e.minimap.renderCharacters,p=r>=2?Math.round(e.minimap.scale*2):e.minimap.scale,h=e.minimap.maxColumn,f=e.minimap.size,g=e.minimap.side,b=e.verticalScrollbarWidth,v=e.viewLineCount,y=e.remainingWidth,S=e.isViewportWrapping,E=u?2:3,C=Math.floor(r*i),w=C/r,_=!1,L=!1,k=E*p,W=p/r,K=1;if(f==="fill"||f==="fit"){let{typicalViewportLineCount:se,extraLinesBeforeFirstLine:ie,extraLinesBeyondLastLine:Te,desiredRatio:ue,minimapLineCount:Xe}=o.computeContainedMinimapLineCount({viewLineCount:v,scrollBeyondLastLine:c,paddingTop:e.paddingTop,paddingBottom:e.paddingBottom,height:i,lineHeight:l,pixelRatio:r});if(v/Xe>1)_=!0,L=!0,p=1,k=1,W=p/r;else{let _e=!1,vn=p+1;if(f==="fit"){let cn=Math.ceil((ie+v+Te)*k);S&&a&&y<=t.stableFitRemainingWidth?(_e=!0,vn=t.stableFitMaxMinimapScale):_e=cn>C}if(f==="fill"||_e){_=!0;let cn=p;k=Math.min(l*r,Math.max(1,Math.floor(1/ue))),S&&a&&y<=t.stableFitRemainingWidth&&(vn=t.stableFitMaxMinimapScale),p=Math.min(vn,Math.max(1,Math.floor(k/E))),p>cn&&(K=Math.min(2,p/cn)),W=p/r/K,C=Math.ceil(Math.max(se,ie+v+Te)*k),S?(t.stableMinimapLayoutInput=e,t.stableFitRemainingWidth=y,t.stableFitMaxMinimapScale=p):(t.stableMinimapLayoutInput=null,t.stableFitRemainingWidth=0)}}}let U=Math.floor(h*W),oe=Math.min(U,Math.max(0,Math.floor((y-b-2)*W/(d+W)))+Ds),Se=Math.floor(r*oe),ne=Se/r;Se=Math.floor(Se*K);let Q=u?1:2,de=g==="left"?0:n-oe-b;return{renderMinimap:Q,minimapLeft:de,minimapWidth:oe,minimapHeightIsEditorHeight:_,minimapIsSampling:L,minimapScale:p,minimapLineHeight:k,minimapCanvasInnerWidth:Se,minimapCanvasInnerHeight:C,minimapCanvasOuterWidth:ne,minimapCanvasOuterHeight:w}}static computeLayout(e,t){let n=t.outerWidth|0,i=t.outerHeight|0,r=t.lineHeight|0,s=t.lineNumbersDigitCount|0,a=t.typicalHalfwidthCharacterWidth,l=t.maxDigitWidth,d=t.pixelRatio,c=t.viewLineCount,u=e.get(139),p=u==="inherit"?e.get(138):u,h=p==="inherit"?e.get(134):p,f=e.get(137),g=t.isDominatedByLongLines,b=e.get(58),v=e.get(69).renderType!==0,y=e.get(70),S=e.get(107),E=e.get(85),C=e.get(74),w=e.get(105),_=w.verticalScrollbarSize,L=w.verticalHasArrows,k=w.arrowSize,W=w.horizontalScrollbarSize,K=e.get(44),U=e.get(112)!=="never",oe=e.get(67);K&&U&&(oe+=16);let Se=0;if(v){let di=Math.max(s,y);Se=Math.round(di*l)}let ne=0;b&&(ne=r*t.glyphMarginDecorationLaneCount);let Q=0,de=Q+ne,se=de+Se,ie=se+oe,Te=n-ne-Se-oe,ue=!1,Xe=!1,ze=-1;p==="inherit"&&g?(ue=!0,Xe=!0):h==="on"||h==="bounded"?Xe=!0:h==="wordWrapColumn"&&(ze=f);let _e=o._computeMinimapLayout({outerWidth:n,outerHeight:i,lineHeight:r,typicalHalfwidthCharacterWidth:a,pixelRatio:d,scrollBeyondLastLine:S,paddingTop:E.top,paddingBottom:E.bottom,minimap:C,verticalScrollbarWidth:_,viewLineCount:c,remainingWidth:Te,isViewportWrapping:Xe},t.memory||new Gf);_e.renderMinimap!==0&&_e.minimapLeft===0&&(Q+=_e.minimapWidth,de+=_e.minimapWidth,se+=_e.minimapWidth,ie+=_e.minimapWidth);let vn=Te-_e.minimapWidth,cn=Math.max(1,Math.floor((vn-_-2)/a)),Bn=L?k:0;return Xe&&(ze=Math.max(1,cn),h==="bounded"&&(ze=Math.min(ze,f))),{width:n,height:i,glyphMarginLeft:Q,glyphMarginWidth:ne,glyphMarginDecorationLaneCount:t.glyphMarginDecorationLaneCount,lineNumbersLeft:de,lineNumbersWidth:Se,decorationsLeft:se,decorationsWidth:oe,contentLeft:ie,contentWidth:vn,minimap:_e,viewportColumn:cn,isWordWrapMinified:ue,isViewportWrapping:Xe,wrappingColumn:ze,verticalScrollbarWidth:_,horizontalScrollbarHeight:W,overviewRuler:{top:Bn,width:_,height:i-2*Bn,right:0}}}},wR=class extends Mt{constructor(){super(141,"wrappingStrategy","simple",{"editor.wrappingStrategy":{enumDescriptions:[m("wrappingStrategy.simple","Assumes that all characters are of the same width. This is a fast algorithm that works correctly for monospace fonts and certain scripts (like Latin characters) where glyphs are of equal width."),m("wrappingStrategy.advanced","Delegates wrapping points computation to the browser. This is a slow algorithm, that might cause freezes for large files, but it works correctly in all cases.")],type:"string",enum:["simple","advanced"],default:"simple",description:m("wrappingStrategy","Controls the algorithm that computes wrapping points. Note that when in accessibility mode, advanced will be used for the best experience.")}})}validate(e){return Jt(e,"simple",["simple","advanced"])}compute(e,t,n){return t.get(2)===2?"advanced":n}};var _R=class extends Mt{constructor(){let e={enabled:"onCode"};super(66,"lightbulb",e,{"editor.lightbulb.enabled":{type:"string",tags:["experimental"],enum:["off","onCode","on"],default:e.enabled,enumDescriptions:[m("editor.lightbulb.enabled.off","Disable the code action menu."),m("editor.lightbulb.enabled.onCode","Show the code action menu when the cursor is on lines with code."),m("editor.lightbulb.enabled.on","Show the code action menu when the cursor is on lines with code or on empty lines.")],description:m("enabled","Enables the Code Action lightbulb in the editor.")}})}validate(e){return!e||typeof e!="object"?this.defaultValue:{enabled:Jt(e.enabled,this.defaultValue.enabled,["off","onCode","on"])}}},DR=class extends Mt{constructor(){let e={enabled:!0,maxLineCount:5,defaultModel:"outlineModel",scrollWithEditor:!0};super(117,"stickyScroll",e,{"editor.stickyScroll.enabled":{type:"boolean",default:e.enabled,description:m("editor.stickyScroll.enabled","Shows the nested current scopes during the scroll at the top of the editor."),tags:["experimental"]},"editor.stickyScroll.maxLineCount":{type:"number",default:e.maxLineCount,minimum:1,maximum:20,description:m("editor.stickyScroll.maxLineCount","Defines the maximum number of sticky lines to show.")},"editor.stickyScroll.defaultModel":{type:"string",enum:["outlineModel","foldingProviderModel","indentationModel"],default:e.defaultModel,description:m("editor.stickyScroll.defaultModel","Defines the model to use for determining which lines to stick. If the outline model does not exist, it will fall back on the folding provider model which falls back on the indentation model. This order is respected in all three cases.")},"editor.stickyScroll.scrollWithEditor":{type:"boolean",default:e.scrollWithEditor,description:m("editor.stickyScroll.scrollWithEditor","Enable scrolling of Sticky Scroll with the editor's horizontal scrollbar.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:be(t.enabled,this.defaultValue.enabled),maxLineCount:Dt.clampedInt(t.maxLineCount,this.defaultValue.maxLineCount,1,20),defaultModel:Jt(t.defaultModel,this.defaultValue.defaultModel,["outlineModel","foldingProviderModel","indentationModel"]),scrollWithEditor:be(t.scrollWithEditor,this.defaultValue.scrollWithEditor)}}},LR=class extends Mt{constructor(){let e={enabled:"on",fontSize:0,fontFamily:"",padding:!1,maximumLength:43};super(143,"inlayHints",e,{"editor.inlayHints.enabled":{type:"string",default:e.enabled,description:m("inlayHints.enable","Enables the inlay hints in the editor."),enum:["on","onUnlessPressed","offUnlessPressed","off"],markdownEnumDescriptions:[m("editor.inlayHints.on","Inlay hints are enabled"),m("editor.inlayHints.onUnlessPressed","Inlay hints are showing by default and hide when holding {0}",Ve?"Ctrl+Option":"Ctrl+Alt"),m("editor.inlayHints.offUnlessPressed","Inlay hints are hidden by default and show when holding {0}",Ve?"Ctrl+Option":"Ctrl+Alt"),m("editor.inlayHints.off","Inlay hints are disabled")]},"editor.inlayHints.fontSize":{type:"number",default:e.fontSize,markdownDescription:m("inlayHints.fontSize","Controls font size of inlay hints in the editor. As default the {0} is used when the configured value is less than {1} or greater than the editor font size.","`#editor.fontSize#`","`5`")},"editor.inlayHints.fontFamily":{type:"string",default:e.fontFamily,markdownDescription:m("inlayHints.fontFamily","Controls font family of inlay hints in the editor. When set to empty, the {0} is used.","`#editor.fontFamily#`")},"editor.inlayHints.padding":{type:"boolean",default:e.padding,description:m("inlayHints.padding","Enables the padding around the inlay hints in the editor.")},"editor.inlayHints.maximumLength":{type:"number",default:e.maximumLength,markdownDescription:m("inlayHints.maximumLength","Maximum overall length of inlay hints, for a single line, before they get truncated by the editor. Set to `0` to never truncate")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return typeof t.enabled=="boolean"&&(t.enabled=t.enabled?"on":"off"),{enabled:Jt(t.enabled,this.defaultValue.enabled,["on","off","offUnlessPressed","onUnlessPressed"]),fontSize:Dt.clampedInt(t.fontSize,this.defaultValue.fontSize,0,100),fontFamily:qi.string(t.fontFamily,this.defaultValue.fontFamily),padding:be(t.padding,this.defaultValue.padding),maximumLength:Dt.clampedInt(t.maximumLength,this.defaultValue.maximumLength,0,Number.MAX_SAFE_INTEGER)}}},RR=class extends Mt{constructor(){super(67,"lineDecorationsWidth",10)}validate(e){return typeof e=="string"&&/^\d+(\.\d+)?ch$/.test(e)?-parseFloat(e.substring(0,e.length-2)):Dt.clampedInt(e,this.defaultValue,0,1e3)}compute(e,t,n){return n<0?Dt.clampedInt(-n*e.fontInfo.typicalHalfwidthCharacterWidth,this.defaultValue,0,1e3):n}},kR=class extends lr{constructor(){super(68,"lineHeight",No.lineHeight,e=>lr.clamp(e,0,150),{markdownDescription:m("lineHeight",`Controls the line height. 
 - Use 0 to automatically compute the line height from the font size.
 - Values between 0 and 8 will be used as a multiplier with the font size.
 - Values greater than or equal to 8 will be used as effective values.`)})}compute(e,t,n){return e.fontInfo.lineHeight}},MR=class extends Mt{constructor(){let e={enabled:!0,size:"proportional",side:"right",showSlider:"mouseover",autohide:!1,renderCharacters:!0,maxColumn:120,scale:1,showRegionSectionHeaders:!0,showMarkSectionHeaders:!0,sectionHeaderFontSize:9,sectionHeaderLetterSpacing:1};super(74,"minimap",e,{"editor.minimap.enabled":{type:"boolean",default:e.enabled,description:m("minimap.enabled","Controls whether the minimap is shown.")},"editor.minimap.autohide":{type:"boolean",default:e.autohide,description:m("minimap.autohide","Controls whether the minimap is hidden automatically.")},"editor.minimap.size":{type:"string",enum:["proportional","fill","fit"],enumDescriptions:[m("minimap.size.proportional","The minimap has the same size as the editor contents (and might scroll)."),m("minimap.size.fill","The minimap will stretch or shrink as necessary to fill the height of the editor (no scrolling)."),m("minimap.size.fit","The minimap will shrink as necessary to never be larger than the editor (no scrolling).")],default:e.size,description:m("minimap.size","Controls the size of the minimap.")},"editor.minimap.side":{type:"string",enum:["left","right"],default:e.side,description:m("minimap.side","Controls the side where to render the minimap.")},"editor.minimap.showSlider":{type:"string",enum:["always","mouseover"],default:e.showSlider,description:m("minimap.showSlider","Controls when the minimap slider is shown.")},"editor.minimap.scale":{type:"number",default:e.scale,minimum:1,maximum:3,enum:[1,2,3],description:m("minimap.scale","Scale of content drawn in the minimap: 1, 2 or 3.")},"editor.minimap.renderCharacters":{type:"boolean",default:e.renderCharacters,description:m("minimap.renderCharacters","Render the actual characters on a line as opposed to color blocks.")},"editor.minimap.maxColumn":{type:"number",default:e.maxColumn,description:m("minimap.maxColumn","Limit the width of the minimap to render at most a certain number of columns.")},"editor.minimap.showRegionSectionHeaders":{type:"boolean",default:e.showRegionSectionHeaders,description:m("minimap.showRegionSectionHeaders","Controls whether named regions are shown as section headers in the minimap.")},"editor.minimap.showMarkSectionHeaders":{type:"boolean",default:e.showMarkSectionHeaders,description:m("minimap.showMarkSectionHeaders","Controls whether MARK: comments are shown as section headers in the minimap.")},"editor.minimap.sectionHeaderFontSize":{type:"number",default:e.sectionHeaderFontSize,description:m("minimap.sectionHeaderFontSize","Controls the font size of section headers in the minimap.")},"editor.minimap.sectionHeaderLetterSpacing":{type:"number",default:e.sectionHeaderLetterSpacing,description:m("minimap.sectionHeaderLetterSpacing","Controls the amount of space (in pixels) between characters of section header. This helps the readability of the header in small font sizes.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:be(t.enabled,this.defaultValue.enabled),autohide:be(t.autohide,this.defaultValue.autohide),size:Jt(t.size,this.defaultValue.size,["proportional","fill","fit"]),side:Jt(t.side,this.defaultValue.side,["right","left"]),showSlider:Jt(t.showSlider,this.defaultValue.showSlider,["always","mouseover"]),renderCharacters:be(t.renderCharacters,this.defaultValue.renderCharacters),scale:Dt.clampedInt(t.scale,1,1,3),maxColumn:Dt.clampedInt(t.maxColumn,this.defaultValue.maxColumn,1,1e4),showRegionSectionHeaders:be(t.showRegionSectionHeaders,this.defaultValue.showRegionSectionHeaders),showMarkSectionHeaders:be(t.showMarkSectionHeaders,this.defaultValue.showMarkSectionHeaders),sectionHeaderFontSize:lr.clamp(t.sectionHeaderFontSize??this.defaultValue.sectionHeaderFontSize,4,32),sectionHeaderLetterSpacing:lr.clamp(t.sectionHeaderLetterSpacing??this.defaultValue.sectionHeaderLetterSpacing,0,5)}}};function X9(o){return o==="ctrlCmd"?Ve?"metaKey":"ctrlKey":"altKey"}var PR=class extends Mt{constructor(){super(85,"padding",{top:0,bottom:0},{"editor.padding.top":{type:"number",default:0,minimum:0,maximum:1e3,description:m("padding.top","Controls the amount of space between the top edge of the editor and the first line.")},"editor.padding.bottom":{type:"number",default:0,minimum:0,maximum:1e3,description:m("padding.bottom","Controls the amount of space between the bottom edge of the editor and the last line.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{top:Dt.clampedInt(t.top,0,0,1e3),bottom:Dt.clampedInt(t.bottom,0,0,1e3)}}},OR=class extends Mt{constructor(){let e={enabled:!0,cycle:!0};super(87,"parameterHints",e,{"editor.parameterHints.enabled":{type:"boolean",default:e.enabled,description:m("parameterHints.enabled","Enables a pop-up that shows parameter documentation and type information as you type.")},"editor.parameterHints.cycle":{type:"boolean",default:e.cycle,description:m("parameterHints.cycle","Controls whether the parameter hints menu cycles or closes when reaching the end of the list.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:be(t.enabled,this.defaultValue.enabled),cycle:be(t.cycle,this.defaultValue.cycle)}}},NR=class extends pu{constructor(){super(145)}compute(e,t,n){return e.pixelRatio}},AR=class extends Mt{constructor(){super(89,"placeholder",void 0)}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e:this.defaultValue}},FR=class extends Mt{defaultValue;constructor(){let e={other:"on",comments:"off",strings:"off"},t=[{type:"boolean"},{type:"string",enum:["on","inline","off"],enumDescriptions:[m("on","Quick suggestions show inside the suggest widget"),m("inline","Quick suggestions show as ghost text"),m("off","Quick suggestions are disabled")]}];super(91,"quickSuggestions",e,{type:"object",additionalProperties:!1,properties:{strings:{anyOf:t,default:e.strings,description:m("quickSuggestions.strings","Enable quick suggestions inside strings.")},comments:{anyOf:t,default:e.comments,description:m("quickSuggestions.comments","Enable quick suggestions inside comments.")},other:{anyOf:t,default:e.other,description:m("quickSuggestions.other","Enable quick suggestions outside of strings and comments.")}},default:e,markdownDescription:m("quickSuggestions","Controls whether suggestions should automatically show up while typing. This can be controlled for typing in comments, strings, and other code. Quick suggestion can be configured to show as ghost text or with the suggest widget. Also be aware of the {0}-setting which controls if suggestions are triggered by special characters.","`#editor.suggestOnTriggerCharacters#`")}),this.defaultValue=e}validate(e){if(typeof e=="boolean"){let d=e?"on":"off";return{comments:d,strings:d,other:d}}if(!e||typeof e!="object")return this.defaultValue;let{other:t,comments:n,strings:i}=e,r=["on","inline","off"],s,a,l;return typeof t=="boolean"?s=t?"on":"off":s=Jt(t,this.defaultValue.other,r),typeof n=="boolean"?a=n?"on":"off":a=Jt(n,this.defaultValue.comments,r),typeof i=="boolean"?l=i?"on":"off":l=Jt(i,this.defaultValue.strings,r),{other:s,comments:a,strings:l}}};var BR=class extends Mt{constructor(){super(69,"lineNumbers",{renderType:1,renderFn:null},{type:"string",enum:["off","on","relative","interval"],enumDescriptions:[m("lineNumbers.off","Line numbers are not rendered."),m("lineNumbers.on","Line numbers are rendered as absolute number."),m("lineNumbers.relative","Line numbers are rendered as distance in lines to cursor position."),m("lineNumbers.interval","Line numbers are rendered every 10 lines.")],default:"on",description:m("lineNumbers","Controls the display of line numbers.")})}validate(e){let t=this.defaultValue.renderType,n=this.defaultValue.renderFn;return typeof e<"u"&&(typeof e=="function"?(t=4,n=e):e==="interval"?t=3:e==="relative"?t=2:e==="on"?t=1:t=0),{renderType:t,renderFn:n}}};function hu(o){let e=o.get(100);return e==="editable"?o.get(93):e!=="on"}var VR=class extends Mt{constructor(){let e=[],t={type:"number",description:m("rulers.size","Number of monospace characters at which this editor ruler will render.")};super(104,"rulers",e,{type:"array",items:{anyOf:[t,{type:["object"],properties:{column:t,color:{type:"string",description:m("rulers.color","Color of this editor ruler."),format:"color-hex"}}}]},default:e,description:m("rulers","Render vertical rulers after a certain number of monospace characters. Use multiple values for multiple rulers. No rulers are drawn if array is empty.")})}validate(e){if(Array.isArray(e)){let t=[];for(let n of e)if(typeof n=="number")t.push({column:Dt.clampedInt(n,0,0,1e4),color:null});else if(n&&typeof n=="object"){let i=n;t.push({column:Dt.clampedInt(i.column,0,0,1e4),color:i.color})}return t.sort((n,i)=>n.column-i.column),t}return this.defaultValue}},WR=class extends Mt{constructor(){super(94,"readOnlyMessage",void 0)}validate(e){return!e||typeof e!="object"?this.defaultValue:e}};function bB(o,e){if(typeof o!="string")return e;switch(o){case"hidden":return 2;case"visible":return 3;default:return 1}}var HR=class extends Mt{constructor(){let e={vertical:1,horizontal:1,arrowSize:11,useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,horizontalScrollbarSize:12,horizontalSliderSize:12,verticalScrollbarSize:14,verticalSliderSize:14,handleMouseWheel:!0,alwaysConsumeMouseWheel:!0,scrollByPage:!1,ignoreHorizontalScrollbarInContentHeight:!1};super(105,"scrollbar",e,{"editor.scrollbar.vertical":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[m("scrollbar.vertical.auto","The vertical scrollbar will be visible only when necessary."),m("scrollbar.vertical.visible","The vertical scrollbar will always be visible."),m("scrollbar.vertical.fit","The vertical scrollbar will always be hidden.")],default:"auto",description:m("scrollbar.vertical","Controls the visibility of the vertical scrollbar.")},"editor.scrollbar.horizontal":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[m("scrollbar.horizontal.auto","The horizontal scrollbar will be visible only when necessary."),m("scrollbar.horizontal.visible","The horizontal scrollbar will always be visible."),m("scrollbar.horizontal.fit","The horizontal scrollbar will always be hidden.")],default:"auto",description:m("scrollbar.horizontal","Controls the visibility of the horizontal scrollbar.")},"editor.scrollbar.verticalScrollbarSize":{type:"number",default:e.verticalScrollbarSize,description:m("scrollbar.verticalScrollbarSize","The width of the vertical scrollbar.")},"editor.scrollbar.horizontalScrollbarSize":{type:"number",default:e.horizontalScrollbarSize,description:m("scrollbar.horizontalScrollbarSize","The height of the horizontal scrollbar.")},"editor.scrollbar.scrollByPage":{type:"boolean",default:e.scrollByPage,description:m("scrollbar.scrollByPage","Controls whether clicks scroll by page or jump to click position.")},"editor.scrollbar.ignoreHorizontalScrollbarInContentHeight":{type:"boolean",default:e.ignoreHorizontalScrollbarInContentHeight,description:m("scrollbar.ignoreHorizontalScrollbarInContentHeight","When set, the horizontal scrollbar will not increase the size of the editor's content.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e,n=Dt.clampedInt(t.horizontalScrollbarSize,this.defaultValue.horizontalScrollbarSize,0,1e3),i=Dt.clampedInt(t.verticalScrollbarSize,this.defaultValue.verticalScrollbarSize,0,1e3);return{arrowSize:Dt.clampedInt(t.arrowSize,this.defaultValue.arrowSize,0,1e3),vertical:bB(t.vertical,this.defaultValue.vertical),horizontal:bB(t.horizontal,this.defaultValue.horizontal),useShadows:be(t.useShadows,this.defaultValue.useShadows),verticalHasArrows:be(t.verticalHasArrows,this.defaultValue.verticalHasArrows),horizontalHasArrows:be(t.horizontalHasArrows,this.defaultValue.horizontalHasArrows),handleMouseWheel:be(t.handleMouseWheel,this.defaultValue.handleMouseWheel),alwaysConsumeMouseWheel:be(t.alwaysConsumeMouseWheel,this.defaultValue.alwaysConsumeMouseWheel),horizontalScrollbarSize:n,horizontalSliderSize:Dt.clampedInt(t.horizontalSliderSize,n,0,1e3),verticalScrollbarSize:i,verticalSliderSize:Dt.clampedInt(t.verticalSliderSize,i,0,1e3),scrollByPage:be(t.scrollByPage,this.defaultValue.scrollByPage),ignoreHorizontalScrollbarInContentHeight:be(t.ignoreHorizontalScrollbarInContentHeight,this.defaultValue.ignoreHorizontalScrollbarInContentHeight)}}},ws="inUntrustedWorkspace",uu={allowedCharacters:"editor.unicodeHighlight.allowedCharacters",invisibleCharacters:"editor.unicodeHighlight.invisibleCharacters",nonBasicASCII:"editor.unicodeHighlight.nonBasicASCII",ambiguousCharacters:"editor.unicodeHighlight.ambiguousCharacters",includeComments:"editor.unicodeHighlight.includeComments",includeStrings:"editor.unicodeHighlight.includeStrings",allowedLocales:"editor.unicodeHighlight.allowedLocales"},UR=class extends Mt{constructor(){let e={nonBasicASCII:ws,invisibleCharacters:!0,ambiguousCharacters:!0,includeComments:ws,includeStrings:!0,allowedCharacters:{},allowedLocales:{_os:!0,_vscode:!0}};super(127,"unicodeHighlight",e,{[uu.nonBasicASCII]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,ws],default:e.nonBasicASCII,description:m("unicodeHighlight.nonBasicASCII","Controls whether all non-basic ASCII characters are highlighted. Only characters between U+0020 and U+007E, tab, line-feed and carriage-return are considered basic ASCII.")},[uu.invisibleCharacters]:{restricted:!0,type:"boolean",default:e.invisibleCharacters,description:m("unicodeHighlight.invisibleCharacters","Controls whether characters that just reserve space or have no width at all are highlighted.")},[uu.ambiguousCharacters]:{restricted:!0,type:"boolean",default:e.ambiguousCharacters,description:m("unicodeHighlight.ambiguousCharacters","Controls whether characters are highlighted that can be confused with basic ASCII characters, except those that are common in the current user locale.")},[uu.includeComments]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,ws],default:e.includeComments,description:m("unicodeHighlight.includeComments","Controls whether characters in comments should also be subject to Unicode highlighting.")},[uu.includeStrings]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,ws],default:e.includeStrings,description:m("unicodeHighlight.includeStrings","Controls whether characters in strings should also be subject to Unicode highlighting.")},[uu.allowedCharacters]:{restricted:!0,type:"object",default:e.allowedCharacters,description:m("unicodeHighlight.allowedCharacters","Defines allowed characters that are not being highlighted."),additionalProperties:{type:"boolean"}},[uu.allowedLocales]:{restricted:!0,type:"object",additionalProperties:{type:"boolean"},default:e.allowedLocales,description:m("unicodeHighlight.allowedLocales","Unicode characters that are common in allowed locales are not being highlighted.")}})}applyUpdate(e,t){let n=!1;t.allowedCharacters&&e&&(Mn(e.allowedCharacters,t.allowedCharacters)||(e={...e,allowedCharacters:t.allowedCharacters},n=!0)),t.allowedLocales&&e&&(Mn(e.allowedLocales,t.allowedLocales)||(e={...e,allowedLocales:t.allowedLocales},n=!0));let i=super.applyUpdate(e,t);return n?new ph(i.newValue,!0):i}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{nonBasicASCII:hh(t.nonBasicASCII,ws,[!0,!1,ws]),invisibleCharacters:be(t.invisibleCharacters,this.defaultValue.invisibleCharacters),ambiguousCharacters:be(t.ambiguousCharacters,this.defaultValue.ambiguousCharacters),includeComments:hh(t.includeComments,ws,[!0,!1,ws]),includeStrings:hh(t.includeStrings,ws,[!0,!1,ws]),allowedCharacters:this.validateBooleanMap(e.allowedCharacters,this.defaultValue.allowedCharacters),allowedLocales:this.validateBooleanMap(e.allowedLocales,this.defaultValue.allowedLocales)}}validateBooleanMap(e,t){if(typeof e!="object"||!e)return t;let n={};for(let[i,r]of Object.entries(e))r===!0&&(n[i]=!0);return n}},zR=class extends Mt{constructor(){let e={enabled:!0,mode:"subwordSmart",showToolbar:"onHover",suppressSuggestions:!1,keepOnBlur:!1,fontFamily:"default",syntaxHighlightingEnabled:!1};super(63,"inlineSuggest",e,{"editor.inlineSuggest.enabled":{type:"boolean",default:e.enabled,description:m("inlineSuggest.enabled","Controls whether to automatically show inline suggestions in the editor.")},"editor.inlineSuggest.showToolbar":{type:"string",default:e.showToolbar,enum:["always","onHover","never"],enumDescriptions:[m("inlineSuggest.showToolbar.always","Show the inline suggestion toolbar whenever an inline suggestion is shown."),m("inlineSuggest.showToolbar.onHover","Show the inline suggestion toolbar when hovering over an inline suggestion."),m("inlineSuggest.showToolbar.never","Never show the inline suggestion toolbar.")],description:m("inlineSuggest.showToolbar","Controls when to show the inline suggestion toolbar.")},"editor.inlineSuggest.syntaxHighlightingEnabled":{type:"boolean",default:e.syntaxHighlightingEnabled,description:m("inlineSuggest.syntaxHighlightingEnabled","Controls whether to show syntax highlighting for inline suggestions in the editor.")},"editor.inlineSuggest.suppressSuggestions":{type:"boolean",default:e.suppressSuggestions,description:m("inlineSuggest.suppressSuggestions","Controls how inline suggestions interact with the suggest widget. If enabled, the suggest widget is not shown automatically when inline suggestions are available.")},"editor.inlineSuggest.fontFamily":{type:"string",default:e.fontFamily,description:m("inlineSuggest.fontFamily","Controls the font family of the inline suggestions.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:be(t.enabled,this.defaultValue.enabled),mode:Jt(t.mode,this.defaultValue.mode,["prefix","subword","subwordSmart"]),showToolbar:Jt(t.showToolbar,this.defaultValue.showToolbar,["always","onHover","never"]),suppressSuggestions:be(t.suppressSuggestions,this.defaultValue.suppressSuggestions),keepOnBlur:be(t.keepOnBlur,this.defaultValue.keepOnBlur),fontFamily:qi.string(t.fontFamily,this.defaultValue.fontFamily),syntaxHighlightingEnabled:be(t.syntaxHighlightingEnabled,this.defaultValue.syntaxHighlightingEnabled)}}},KR=class extends Mt{constructor(){let e={enabled:!1,showToolbar:"onHover",fontFamily:"default",keepOnBlur:!1};super(64,"experimentalInlineEdit",e,{"editor.experimentalInlineEdit.enabled":{type:"boolean",default:e.enabled,description:m("inlineEdit.enabled","Controls whether to show inline edits in the editor.")},"editor.experimentalInlineEdit.showToolbar":{type:"string",default:e.showToolbar,enum:["always","onHover","never"],enumDescriptions:[m("inlineEdit.showToolbar.always","Show the inline edit toolbar whenever an inline suggestion is shown."),m("inlineEdit.showToolbar.onHover","Show the inline edit toolbar when hovering over an inline suggestion."),m("inlineEdit.showToolbar.never","Never show the inline edit toolbar.")],description:m("inlineEdit.showToolbar","Controls when to show the inline edit toolbar.")},"editor.experimentalInlineEdit.fontFamily":{type:"string",default:e.fontFamily,description:m("inlineEdit.fontFamily","Controls the font family of the inline edit.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:be(t.enabled,this.defaultValue.enabled),showToolbar:Jt(t.showToolbar,this.defaultValue.showToolbar,["always","onHover","never"]),fontFamily:qi.string(t.fontFamily,this.defaultValue.fontFamily),keepOnBlur:be(t.keepOnBlur,this.defaultValue.keepOnBlur)}}},GR=class extends Mt{constructor(){let e={enabled:Sa.bracketPairColorizationOptions.enabled,independentColorPoolPerBracketType:Sa.bracketPairColorizationOptions.independentColorPoolPerBracketType};super(15,"bracketPairColorization",e,{"editor.bracketPairColorization.enabled":{type:"boolean",default:e.enabled,markdownDescription:m("bracketPairColorization.enabled","Controls whether bracket pair colorization is enabled or not. Use {0} to override the bracket highlight colors.","`#workbench.colorCustomizations#`")},"editor.bracketPairColorization.independentColorPoolPerBracketType":{type:"boolean",default:e.independentColorPoolPerBracketType,description:m("bracketPairColorization.independentColorPoolPerBracketType","Controls whether each bracket type has its own independent color pool.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:be(t.enabled,this.defaultValue.enabled),independentColorPoolPerBracketType:be(t.independentColorPoolPerBracketType,this.defaultValue.independentColorPoolPerBracketType)}}},jR=class extends Mt{constructor(){let e={bracketPairs:!1,bracketPairsHorizontal:"active",highlightActiveBracketPair:!0,indentation:!0,highlightActiveIndentation:!0};super(16,"guides",e,{"editor.guides.bracketPairs":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[m("editor.guides.bracketPairs.true","Enables bracket pair guides."),m("editor.guides.bracketPairs.active","Enables bracket pair guides only for the active bracket pair."),m("editor.guides.bracketPairs.false","Disables bracket pair guides.")],default:e.bracketPairs,description:m("editor.guides.bracketPairs","Controls whether bracket pair guides are enabled or not.")},"editor.guides.bracketPairsHorizontal":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[m("editor.guides.bracketPairsHorizontal.true","Enables horizontal guides as addition to vertical bracket pair guides."),m("editor.guides.bracketPairsHorizontal.active","Enables horizontal guides only for the active bracket pair."),m("editor.guides.bracketPairsHorizontal.false","Disables horizontal bracket pair guides.")],default:e.bracketPairsHorizontal,description:m("editor.guides.bracketPairsHorizontal","Controls whether horizontal bracket pair guides are enabled or not.")},"editor.guides.highlightActiveBracketPair":{type:"boolean",default:e.highlightActiveBracketPair,description:m("editor.guides.highlightActiveBracketPair","Controls whether the editor should highlight the active bracket pair.")},"editor.guides.indentation":{type:"boolean",default:e.indentation,description:m("editor.guides.indentation","Controls whether the editor should render indent guides.")},"editor.guides.highlightActiveIndentation":{type:["boolean","string"],enum:[!0,"always",!1],enumDescriptions:[m("editor.guides.highlightActiveIndentation.true","Highlights the active indent guide."),m("editor.guides.highlightActiveIndentation.always","Highlights the active indent guide even if bracket guides are highlighted."),m("editor.guides.highlightActiveIndentation.false","Do not highlight the active indent guide.")],default:e.highlightActiveIndentation,description:m("editor.guides.highlightActiveIndentation","Controls whether the editor should highlight the active indent guide.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{bracketPairs:hh(t.bracketPairs,this.defaultValue.bracketPairs,[!0,!1,"active"]),bracketPairsHorizontal:hh(t.bracketPairsHorizontal,this.defaultValue.bracketPairsHorizontal,[!0,!1,"active"]),highlightActiveBracketPair:be(t.highlightActiveBracketPair,this.defaultValue.highlightActiveBracketPair),indentation:be(t.indentation,this.defaultValue.indentation),highlightActiveIndentation:hh(t.highlightActiveIndentation,this.defaultValue.highlightActiveIndentation,[!0,!1,"always"])}}};function hh(o,e,t){let n=t.indexOf(o);return n===-1?e:t[n]}var qR=class extends Mt{constructor(){let e={insertMode:"insert",filterGraceful:!0,snippetsPreventQuickSuggestions:!1,localityBonus:!1,shareSuggestSelections:!1,selectionMode:"always",showIcons:!0,showStatusBar:!1,preview:!1,previewMode:"subwordSmart",showInlineDetails:!0,showMethods:!0,showFunctions:!0,showConstructors:!0,showDeprecated:!0,matchOnWordStartOnly:!0,showFields:!0,showVariables:!0,showClasses:!0,showStructs:!0,showInterfaces:!0,showModules:!0,showProperties:!0,showEvents:!0,showOperators:!0,showUnits:!0,showValues:!0,showConstants:!0,showEnums:!0,showEnumMembers:!0,showKeywords:!0,showWords:!0,showColors:!0,showFiles:!0,showReferences:!0,showFolders:!0,showTypeParameters:!0,showSnippets:!0,showUsers:!0,showIssues:!0};super(120,"suggest",e,{"editor.suggest.insertMode":{type:"string",enum:["insert","replace"],enumDescriptions:[m("suggest.insertMode.insert","Insert suggestion without overwriting text right of the cursor."),m("suggest.insertMode.replace","Insert suggestion and overwrite text right of the cursor.")],default:e.insertMode,description:m("suggest.insertMode","Controls whether words are overwritten when accepting completions. Note that this depends on extensions opting into this feature.")},"editor.suggest.filterGraceful":{type:"boolean",default:e.filterGraceful,description:m("suggest.filterGraceful","Controls whether filtering and sorting suggestions accounts for small typos.")},"editor.suggest.localityBonus":{type:"boolean",default:e.localityBonus,description:m("suggest.localityBonus","Controls whether sorting favors words that appear close to the cursor.")},"editor.suggest.shareSuggestSelections":{type:"boolean",default:e.shareSuggestSelections,markdownDescription:m("suggest.shareSuggestSelections","Controls whether remembered suggestion selections are shared between multiple workspaces and windows (needs `#editor.suggestSelection#`).")},"editor.suggest.selectionMode":{type:"string",enum:["always","never","whenTriggerCharacter","whenQuickSuggestion"],enumDescriptions:[m("suggest.insertMode.always","Always select a suggestion when automatically triggering IntelliSense."),m("suggest.insertMode.never","Never select a suggestion when automatically triggering IntelliSense."),m("suggest.insertMode.whenTriggerCharacter","Select a suggestion only when triggering IntelliSense from a trigger character."),m("suggest.insertMode.whenQuickSuggestion","Select a suggestion only when triggering IntelliSense as you type.")],default:e.selectionMode,markdownDescription:m("suggest.selectionMode","Controls whether a suggestion is selected when the widget shows. Note that this only applies to automatically triggered suggestions ({0} and {1}) and that a suggestion is always selected when explicitly invoked, e.g via `Ctrl+Space`.","`#editor.quickSuggestions#`","`#editor.suggestOnTriggerCharacters#`")},"editor.suggest.snippetsPreventQuickSuggestions":{type:"boolean",default:e.snippetsPreventQuickSuggestions,description:m("suggest.snippetsPreventQuickSuggestions","Controls whether an active snippet prevents quick suggestions.")},"editor.suggest.showIcons":{type:"boolean",default:e.showIcons,description:m("suggest.showIcons","Controls whether to show or hide icons in suggestions.")},"editor.suggest.showStatusBar":{type:"boolean",default:e.showStatusBar,description:m("suggest.showStatusBar","Controls the visibility of the status bar at the bottom of the suggest widget.")},"editor.suggest.preview":{type:"boolean",default:e.preview,description:m("suggest.preview","Controls whether to preview the suggestion outcome in the editor.")},"editor.suggest.showInlineDetails":{type:"boolean",default:e.showInlineDetails,description:m("suggest.showInlineDetails","Controls whether suggest details show inline with the label or only in the details widget.")},"editor.suggest.maxVisibleSuggestions":{type:"number",deprecationMessage:m("suggest.maxVisibleSuggestions.dep","This setting is deprecated. The suggest widget can now be resized.")},"editor.suggest.filteredTypes":{type:"object",deprecationMessage:m("deprecated","This setting is deprecated, please use separate settings like 'editor.suggest.showKeywords' or 'editor.suggest.showSnippets' instead.")},"editor.suggest.showMethods":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showMethods","When enabled IntelliSense shows `method`-suggestions.")},"editor.suggest.showFunctions":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showFunctions","When enabled IntelliSense shows `function`-suggestions.")},"editor.suggest.showConstructors":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showConstructors","When enabled IntelliSense shows `constructor`-suggestions.")},"editor.suggest.showDeprecated":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showDeprecated","When enabled IntelliSense shows `deprecated`-suggestions.")},"editor.suggest.matchOnWordStartOnly":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.matchOnWordStartOnly","When enabled IntelliSense filtering requires that the first character matches on a word start. For example, `c` on `Console` or `WebContext` but _not_ on `description`. When disabled IntelliSense will show more results but still sorts them by match quality.")},"editor.suggest.showFields":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showFields","When enabled IntelliSense shows `field`-suggestions.")},"editor.suggest.showVariables":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showVariables","When enabled IntelliSense shows `variable`-suggestions.")},"editor.suggest.showClasses":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showClasss","When enabled IntelliSense shows `class`-suggestions.")},"editor.suggest.showStructs":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showStructs","When enabled IntelliSense shows `struct`-suggestions.")},"editor.suggest.showInterfaces":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showInterfaces","When enabled IntelliSense shows `interface`-suggestions.")},"editor.suggest.showModules":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showModules","When enabled IntelliSense shows `module`-suggestions.")},"editor.suggest.showProperties":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showPropertys","When enabled IntelliSense shows `property`-suggestions.")},"editor.suggest.showEvents":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showEvents","When enabled IntelliSense shows `event`-suggestions.")},"editor.suggest.showOperators":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showOperators","When enabled IntelliSense shows `operator`-suggestions.")},"editor.suggest.showUnits":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showUnits","When enabled IntelliSense shows `unit`-suggestions.")},"editor.suggest.showValues":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showValues","When enabled IntelliSense shows `value`-suggestions.")},"editor.suggest.showConstants":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showConstants","When enabled IntelliSense shows `constant`-suggestions.")},"editor.suggest.showEnums":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showEnums","When enabled IntelliSense shows `enum`-suggestions.")},"editor.suggest.showEnumMembers":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showEnumMembers","When enabled IntelliSense shows `enumMember`-suggestions.")},"editor.suggest.showKeywords":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showKeywords","When enabled IntelliSense shows `keyword`-suggestions.")},"editor.suggest.showWords":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showTexts","When enabled IntelliSense shows `text`-suggestions.")},"editor.suggest.showColors":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showColors","When enabled IntelliSense shows `color`-suggestions.")},"editor.suggest.showFiles":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showFiles","When enabled IntelliSense shows `file`-suggestions.")},"editor.suggest.showReferences":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showReferences","When enabled IntelliSense shows `reference`-suggestions.")},"editor.suggest.showCustomcolors":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showCustomcolors","When enabled IntelliSense shows `customcolor`-suggestions.")},"editor.suggest.showFolders":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showFolders","When enabled IntelliSense shows `folder`-suggestions.")},"editor.suggest.showTypeParameters":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showTypeParameters","When enabled IntelliSense shows `typeParameter`-suggestions.")},"editor.suggest.showSnippets":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showSnippets","When enabled IntelliSense shows `snippet`-suggestions.")},"editor.suggest.showUsers":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showUsers","When enabled IntelliSense shows `user`-suggestions.")},"editor.suggest.showIssues":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showIssues","When enabled IntelliSense shows `issues`-suggestions.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{insertMode:Jt(t.insertMode,this.defaultValue.insertMode,["insert","replace"]),filterGraceful:be(t.filterGraceful,this.defaultValue.filterGraceful),snippetsPreventQuickSuggestions:be(t.snippetsPreventQuickSuggestions,this.defaultValue.filterGraceful),localityBonus:be(t.localityBonus,this.defaultValue.localityBonus),shareSuggestSelections:be(t.shareSuggestSelections,this.defaultValue.shareSuggestSelections),selectionMode:Jt(t.selectionMode,this.defaultValue.selectionMode,["always","never","whenQuickSuggestion","whenTriggerCharacter"]),showIcons:be(t.showIcons,this.defaultValue.showIcons),showStatusBar:be(t.showStatusBar,this.defaultValue.showStatusBar),preview:be(t.preview,this.defaultValue.preview),previewMode:Jt(t.previewMode,this.defaultValue.previewMode,["prefix","subword","subwordSmart"]),showInlineDetails:be(t.showInlineDetails,this.defaultValue.showInlineDetails),showMethods:be(t.showMethods,this.defaultValue.showMethods),showFunctions:be(t.showFunctions,this.defaultValue.showFunctions),showConstructors:be(t.showConstructors,this.defaultValue.showConstructors),showDeprecated:be(t.showDeprecated,this.defaultValue.showDeprecated),matchOnWordStartOnly:be(t.matchOnWordStartOnly,this.defaultValue.matchOnWordStartOnly),showFields:be(t.showFields,this.defaultValue.showFields),showVariables:be(t.showVariables,this.defaultValue.showVariables),showClasses:be(t.showClasses,this.defaultValue.showClasses),showStructs:be(t.showStructs,this.defaultValue.showStructs),showInterfaces:be(t.showInterfaces,this.defaultValue.showInterfaces),showModules:be(t.showModules,this.defaultValue.showModules),showProperties:be(t.showProperties,this.defaultValue.showProperties),showEvents:be(t.showEvents,this.defaultValue.showEvents),showOperators:be(t.showOperators,this.defaultValue.showOperators),showUnits:be(t.showUnits,this.defaultValue.showUnits),showValues:be(t.showValues,this.defaultValue.showValues),showConstants:be(t.showConstants,this.defaultValue.showConstants),showEnums:be(t.showEnums,this.defaultValue.showEnums),showEnumMembers:be(t.showEnumMembers,this.defaultValue.showEnumMembers),showKeywords:be(t.showKeywords,this.defaultValue.showKeywords),showWords:be(t.showWords,this.defaultValue.showWords),showColors:be(t.showColors,this.defaultValue.showColors),showFiles:be(t.showFiles,this.defaultValue.showFiles),showReferences:be(t.showReferences,this.defaultValue.showReferences),showFolders:be(t.showFolders,this.defaultValue.showFolders),showTypeParameters:be(t.showTypeParameters,this.defaultValue.showTypeParameters),showSnippets:be(t.showSnippets,this.defaultValue.showSnippets),showUsers:be(t.showUsers,this.defaultValue.showUsers),showIssues:be(t.showIssues,this.defaultValue.showIssues)}}},$R=class extends Mt{constructor(){super(115,"smartSelect",{selectLeadingAndTrailingWhitespace:!0,selectSubwords:!0},{"editor.smartSelect.selectLeadingAndTrailingWhitespace":{description:m("selectLeadingAndTrailingWhitespace","Whether leading and trailing whitespace should always be selected."),default:!0,type:"boolean"},"editor.smartSelect.selectSubwords":{description:m("selectSubwords","Whether subwords (like 'foo' in 'fooBar' or 'foo_bar') should be selected."),default:!0,type:"boolean"}})}validate(e){return!e||typeof e!="object"?this.defaultValue:{selectLeadingAndTrailingWhitespace:be(e.selectLeadingAndTrailingWhitespace,this.defaultValue.selectLeadingAndTrailingWhitespace),selectSubwords:be(e.selectSubwords,this.defaultValue.selectSubwords)}}},YR=class extends Mt{constructor(){let e=[];super(132,"wordSegmenterLocales",e,{anyOf:[{description:m("wordSegmenterLocales","Locales to be used for word segmentation when doing word related navigations or operations. Specify the BCP 47 language tag of the word you wish to recognize (e.g., ja, zh-CN, zh-Hant-TW, etc.)."),type:"string"},{description:m("wordSegmenterLocales","Locales to be used for word segmentation when doing word related navigations or operations. Specify the BCP 47 language tag of the word you wish to recognize (e.g., ja, zh-CN, zh-Hant-TW, etc.)."),type:"array",items:{type:"string"}}]})}validate(e){if(typeof e=="string"&&(e=[e]),Array.isArray(e)){let t=[];for(let n of e)if(typeof n=="string")try{Intl.Segmenter.supportedLocalesOf(n).length>0&&t.push(n)}catch{}return t}return this.defaultValue}};var ZR=class extends Mt{constructor(){super(140,"wrappingIndent",1,{"editor.wrappingIndent":{type:"string",enum:["none","same","indent","deepIndent"],enumDescriptions:[m("wrappingIndent.none","No indentation. Wrapped lines begin at column 1."),m("wrappingIndent.same","Wrapped lines get the same indentation as the parent."),m("wrappingIndent.indent","Wrapped lines get +1 indentation toward the parent."),m("wrappingIndent.deepIndent","Wrapped lines get +2 indentation toward the parent.")],description:m("wrappingIndent","Controls the indentation of wrapped lines."),default:"same"}})}validate(e){switch(e){case"none":return 0;case"same":return 1;case"indent":return 2;case"deepIndent":return 3}return 1}compute(e,t,n){return t.get(2)===2?0:n}},XR=class extends pu{constructor(){super(148)}compute(e,t,n){let i=t.get(147);return{isDominatedByLongLines:e.isDominatedByLongLines,isWordWrapMinified:i.isWordWrapMinified,isViewportWrapping:i.isViewportWrapping,wrappingColumn:i.wrappingColumn}}},QR=class extends Mt{constructor(){let e={enabled:!0,showDropSelector:"afterDrop"};super(36,"dropIntoEditor",e,{"editor.dropIntoEditor.enabled":{type:"boolean",default:e.enabled,markdownDescription:m("dropIntoEditor.enabled","Controls whether you can drag and drop a file into a text editor by holding down the `Shift` key (instead of opening the file in an editor).")},"editor.dropIntoEditor.showDropSelector":{type:"string",markdownDescription:m("dropIntoEditor.showDropSelector","Controls if a widget is shown when dropping files into the editor. This widget lets you control how the file is dropped."),enum:["afterDrop","never"],enumDescriptions:[m("dropIntoEditor.showDropSelector.afterDrop","Show the drop selector widget after a file is dropped into the editor."),m("dropIntoEditor.showDropSelector.never","Never show the drop selector widget. Instead the default drop provider is always used.")],default:"afterDrop"}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:be(t.enabled,this.defaultValue.enabled),showDropSelector:Jt(t.showDropSelector,this.defaultValue.showDropSelector,["afterDrop","never"])}}},JR=class extends Mt{constructor(){let e={enabled:!0,showPasteSelector:"afterPaste"};super(86,"pasteAs",e,{"editor.pasteAs.enabled":{type:"boolean",default:e.enabled,markdownDescription:m("pasteAs.enabled","Controls whether you can paste content in different ways.")},"editor.pasteAs.showPasteSelector":{type:"string",markdownDescription:m("pasteAs.showPasteSelector","Controls if a widget is shown when pasting content in to the editor. This widget lets you control how the file is pasted."),enum:["afterPaste","never"],enumDescriptions:[m("pasteAs.showPasteSelector.afterPaste","Show the paste selector widget after content is pasted into the editor."),m("pasteAs.showPasteSelector.never","Never show the paste selector widget. Instead the default pasting behavior is always used.")],default:"afterPaste"}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:be(t.enabled,this.defaultValue.enabled),showPasteSelector:Jt(t.showPasteSelector,this.defaultValue.showPasteSelector,["afterPaste","never"])}}},Q9="Consolas, 'Courier New', monospace",J9="Menlo, Monaco, 'Courier New', monospace",e8="'Droid Sans Mono', 'monospace', monospace",No={fontFamily:Ve?J9:At?e8:Q9,fontWeight:"normal",fontSize:Ve?12:14,lineHeight:0,letterSpacing:0},mh=[];function Z(o){return mh[o.id]=o,o}var Jr={acceptSuggestionOnCommitCharacter:Z(new it(0,"acceptSuggestionOnCommitCharacter",!0,{markdownDescription:m("acceptSuggestionOnCommitCharacter","Controls whether suggestions should be accepted on commit characters. For example, in JavaScript, the semi-colon (`;`) can be a commit character that accepts a suggestion and types that character.")})),acceptSuggestionOnEnter:Z(new qt(1,"acceptSuggestionOnEnter","on",["on","smart","off"],{markdownEnumDescriptions:["",m("acceptSuggestionOnEnterSmart","Only accept a suggestion with `Enter` when it makes a textual change."),""],markdownDescription:m("acceptSuggestionOnEnter","Controls whether suggestions should be accepted on `Enter`, in addition to `Tab`. Helps to avoid ambiguity between inserting new lines or accepting suggestions.")})),accessibilitySupport:Z(new fR),accessibilityPageSize:Z(new Dt(3,"accessibilityPageSize",10,1,1073741824,{description:m("accessibilityPageSize","Controls the number of lines in the editor that can be read out by a screen reader at once. When we detect a screen reader we automatically set the default to be 500. Warning: this has a performance implication for numbers larger than the default."),tags:["accessibility"]})),ariaLabel:Z(new qi(4,"ariaLabel",m("editorViewAccessibleLabel","Editor content"))),ariaRequired:Z(new it(5,"ariaRequired",!1,void 0)),screenReaderAnnounceInlineSuggestion:Z(new it(8,"screenReaderAnnounceInlineSuggestion",!0,{description:m("screenReaderAnnounceInlineSuggestion","Control whether inline suggestions are announced by a screen reader."),tags:["accessibility"]})),autoClosingBrackets:Z(new qt(6,"autoClosingBrackets","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",m("editor.autoClosingBrackets.languageDefined","Use language configurations to determine when to autoclose brackets."),m("editor.autoClosingBrackets.beforeWhitespace","Autoclose brackets only when the cursor is to the left of whitespace."),""],description:m("autoClosingBrackets","Controls whether the editor should automatically close brackets after the user adds an opening bracket.")})),autoClosingComments:Z(new qt(7,"autoClosingComments","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",m("editor.autoClosingComments.languageDefined","Use language configurations to determine when to autoclose comments."),m("editor.autoClosingComments.beforeWhitespace","Autoclose comments only when the cursor is to the left of whitespace."),""],description:m("autoClosingComments","Controls whether the editor should automatically close comments after the user adds an opening comment.")})),autoClosingDelete:Z(new qt(9,"autoClosingDelete","auto",["always","auto","never"],{enumDescriptions:["",m("editor.autoClosingDelete.auto","Remove adjacent closing quotes or brackets only if they were automatically inserted."),""],description:m("autoClosingDelete","Controls whether the editor should remove adjacent closing quotes or brackets when deleting.")})),autoClosingOvertype:Z(new qt(10,"autoClosingOvertype","auto",["always","auto","never"],{enumDescriptions:["",m("editor.autoClosingOvertype.auto","Type over closing quotes or brackets only if they were automatically inserted."),""],description:m("autoClosingOvertype","Controls whether the editor should type over closing quotes or brackets.")})),autoClosingQuotes:Z(new qt(11,"autoClosingQuotes","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",m("editor.autoClosingQuotes.languageDefined","Use language configurations to determine when to autoclose quotes."),m("editor.autoClosingQuotes.beforeWhitespace","Autoclose quotes only when the cursor is to the left of whitespace."),""],description:m("autoClosingQuotes","Controls whether the editor should automatically close quotes after the user adds an opening quote.")})),autoIndent:Z(new uh(12,"autoIndent",4,"full",["none","keep","brackets","advanced","full"],$9,{enumDescriptions:[m("editor.autoIndent.none","The editor will not insert indentation automatically."),m("editor.autoIndent.keep","The editor will keep the current line's indentation."),m("editor.autoIndent.brackets","The editor will keep the current line's indentation and honor language defined brackets."),m("editor.autoIndent.advanced","The editor will keep the current line's indentation, honor language defined brackets and invoke special onEnterRules defined by languages."),m("editor.autoIndent.full","The editor will keep the current line's indentation, honor language defined brackets, invoke special onEnterRules defined by languages, and honor indentationRules defined by languages.")],description:m("autoIndent","Controls whether the editor should automatically adjust the indentation when users type, paste, move or indent lines.")})),automaticLayout:Z(new it(13,"automaticLayout",!1)),autoSurround:Z(new qt(14,"autoSurround","languageDefined",["languageDefined","quotes","brackets","never"],{enumDescriptions:[m("editor.autoSurround.languageDefined","Use language configurations to determine when to automatically surround selections."),m("editor.autoSurround.quotes","Surround with quotes but not brackets."),m("editor.autoSurround.brackets","Surround with brackets but not quotes."),""],description:m("autoSurround","Controls whether the editor should automatically surround selections when typing quotes or brackets.")})),bracketPairColorization:Z(new GR),bracketPairGuides:Z(new jR),stickyTabStops:Z(new it(118,"stickyTabStops",!1,{description:m("stickyTabStops","Emulate selection behavior of tab characters when using spaces for indentation. Selection will stick to tab stops.")})),codeLens:Z(new it(17,"codeLens",!0,{description:m("codeLens","Controls whether the editor shows CodeLens.")})),codeLensFontFamily:Z(new qi(18,"codeLensFontFamily","",{description:m("codeLensFontFamily","Controls the font family for CodeLens.")})),codeLensFontSize:Z(new Dt(19,"codeLensFontSize",0,0,100,{type:"number",default:0,minimum:0,maximum:100,markdownDescription:m("codeLensFontSize","Controls the font size in pixels for CodeLens. When set to 0, 90% of `#editor.fontSize#` is used.")})),colorDecorators:Z(new it(20,"colorDecorators",!0,{description:m("colorDecorators","Controls whether the editor should render the inline color decorators and color picker.")})),colorDecoratorActivatedOn:Z(new qt(150,"colorDecoratorsActivatedOn","clickAndHover",["clickAndHover","hover","click"],{enumDescriptions:[m("editor.colorDecoratorActivatedOn.clickAndHover","Make the color picker appear both on click and hover of the color decorator"),m("editor.colorDecoratorActivatedOn.hover","Make the color picker appear on hover of the color decorator"),m("editor.colorDecoratorActivatedOn.click","Make the color picker appear on click of the color decorator")],description:m("colorDecoratorActivatedOn","Controls the condition to make a color picker appear from a color decorator")})),colorDecoratorsLimit:Z(new Dt(21,"colorDecoratorsLimit",500,1,1e6,{markdownDescription:m("colorDecoratorsLimit","Controls the max number of color decorators that can be rendered in an editor at once.")})),columnSelection:Z(new it(22,"columnSelection",!1,{description:m("columnSelection","Enable that the selection with the mouse and keys is doing column selection.")})),comments:Z(new bR),contextmenu:Z(new it(24,"contextmenu",!0)),copyWithSyntaxHighlighting:Z(new it(25,"copyWithSyntaxHighlighting",!0,{description:m("copyWithSyntaxHighlighting","Controls whether syntax highlighting should be copied into the clipboard.")})),cursorBlinking:Z(new uh(26,"cursorBlinking",1,"blink",["blink","smooth","phase","expand","solid"],Y9,{description:m("cursorBlinking","Control the cursor animation style.")})),cursorSmoothCaretAnimation:Z(new qt(27,"cursorSmoothCaretAnimation","off",["off","explicit","on"],{enumDescriptions:[m("cursorSmoothCaretAnimation.off","Smooth caret animation is disabled."),m("cursorSmoothCaretAnimation.explicit","Smooth caret animation is enabled only when the user moves the cursor with an explicit gesture."),m("cursorSmoothCaretAnimation.on","Smooth caret animation is always enabled.")],description:m("cursorSmoothCaretAnimation","Controls whether the smooth caret animation should be enabled.")})),cursorStyle:Z(new uh(28,"cursorStyle",1,"line",["line","block","underline","line-thin","block-outline","underline-thin"],Z9,{description:m("cursorStyle","Controls the cursor style.")})),cursorSurroundingLines:Z(new Dt(29,"cursorSurroundingLines",0,0,1073741824,{description:m("cursorSurroundingLines","Controls the minimal number of visible leading lines (minimum 0) and trailing lines (minimum 1) surrounding the cursor. Known as 'scrollOff' or 'scrollOffset' in some other editors.")})),cursorSurroundingLinesStyle:Z(new qt(30,"cursorSurroundingLinesStyle","default",["default","all"],{enumDescriptions:[m("cursorSurroundingLinesStyle.default","`cursorSurroundingLines` is enforced only when triggered via the keyboard or API."),m("cursorSurroundingLinesStyle.all","`cursorSurroundingLines` is enforced always.")],markdownDescription:m("cursorSurroundingLinesStyle","Controls when `#editor.cursorSurroundingLines#` should be enforced.")})),cursorWidth:Z(new Dt(31,"cursorWidth",0,0,1073741824,{markdownDescription:m("cursorWidth","Controls the width of the cursor when `#editor.cursorStyle#` is set to `line`.")})),disableLayerHinting:Z(new it(32,"disableLayerHinting",!1)),disableMonospaceOptimizations:Z(new it(33,"disableMonospaceOptimizations",!1)),domReadOnly:Z(new it(34,"domReadOnly",!1)),dragAndDrop:Z(new it(35,"dragAndDrop",!0,{description:m("dragAndDrop","Controls whether the editor should allow moving selections via drag and drop.")})),emptySelectionClipboard:Z(new yR),dropIntoEditor:Z(new QR),experimentalEditContextEnabled:Z(new it(37,"experimentalEditContextEnabled",!1,{description:m("experimentalEditContextEnabled","Sets whether the new experimental edit context should be used instead of the text area.")})),stickyScroll:Z(new DR),experimentalWhitespaceRendering:Z(new qt(39,"experimentalWhitespaceRendering","svg",["svg","font","off"],{enumDescriptions:[m("experimentalWhitespaceRendering.svg","Use a new rendering method with svgs."),m("experimentalWhitespaceRendering.font","Use a new rendering method with font characters."),m("experimentalWhitespaceRendering.off","Use the stable rendering method.")],description:m("experimentalWhitespaceRendering","Controls whether whitespace is rendered with a new, experimental method.")})),extraEditorClassName:Z(new qi(40,"extraEditorClassName","")),fastScrollSensitivity:Z(new lr(41,"fastScrollSensitivity",5,o=>o<=0?5:o,{markdownDescription:m("fastScrollSensitivity","Scrolling speed multiplier when pressing `Alt`.")})),find:Z(new IR),fixedOverflowWidgets:Z(new it(43,"fixedOverflowWidgets",!1)),folding:Z(new it(44,"folding",!0,{description:m("folding","Controls whether the editor has code folding enabled.")})),foldingStrategy:Z(new qt(45,"foldingStrategy","auto",["auto","indentation"],{enumDescriptions:[m("foldingStrategy.auto","Use a language-specific folding strategy if available, else the indentation-based one."),m("foldingStrategy.indentation","Use the indentation-based folding strategy.")],description:m("foldingStrategy","Controls the strategy for computing folding ranges.")})),foldingHighlight:Z(new it(46,"foldingHighlight",!0,{description:m("foldingHighlight","Controls whether the editor should highlight folded ranges.")})),foldingImportsByDefault:Z(new it(47,"foldingImportsByDefault",!1,{description:m("foldingImportsByDefault","Controls whether the editor automatically collapses import ranges.")})),foldingMaximumRegions:Z(new Dt(48,"foldingMaximumRegions",5e3,10,65e3,{description:m("foldingMaximumRegions","The maximum number of foldable regions. Increasing this value may result in the editor becoming less responsive when the current source has a large number of foldable regions.")})),unfoldOnClickAfterEndOfLine:Z(new it(49,"unfoldOnClickAfterEndOfLine",!1,{description:m("unfoldOnClickAfterEndOfLine","Controls whether clicking on the empty content after a folded line will unfold the line.")})),fontFamily:Z(new qi(50,"fontFamily",No.fontFamily,{description:m("fontFamily","Controls the font family.")})),fontInfo:Z(new CR),fontLigatures2:Z(new _s),fontSize:Z(new SR),fontWeight:Z(new ER),fontVariations:Z(new dh),formatOnPaste:Z(new it(56,"formatOnPaste",!1,{description:m("formatOnPaste","Controls whether the editor should automatically format the pasted content. A formatter must be available and the formatter should be able to format a range in a document.")})),formatOnType:Z(new it(57,"formatOnType",!1,{description:m("formatOnType","Controls whether the editor should automatically format the line after typing.")})),glyphMargin:Z(new it(58,"glyphMargin",!0,{description:m("glyphMargin","Controls whether the editor should render the vertical glyph margin. Glyph margin is mostly used for debugging.")})),gotoLocation:Z(new TR),hideCursorInOverviewRuler:Z(new it(60,"hideCursorInOverviewRuler",!1,{description:m("hideCursorInOverviewRuler","Controls whether the cursor should be hidden in the overview ruler.")})),hover:Z(new xR),inDiffEditor:Z(new it(62,"inDiffEditor",!1)),letterSpacing:Z(new lr(65,"letterSpacing",No.letterSpacing,o=>lr.clamp(o,-5,20),{description:m("letterSpacing","Controls the letter spacing in pixels.")})),lightbulb:Z(new _R),lineDecorationsWidth:Z(new RR),lineHeight:Z(new kR),lineNumbers:Z(new BR),lineNumbersMinChars:Z(new Dt(70,"lineNumbersMinChars",5,1,300)),linkedEditing:Z(new it(71,"linkedEditing",!1,{description:m("linkedEditing","Controls whether the editor has linked editing enabled. Depending on the language, related symbols such as HTML tags, are updated while editing.")})),links:Z(new it(72,"links",!0,{description:m("links","Controls whether the editor should detect links and make them clickable.")})),matchBrackets:Z(new qt(73,"matchBrackets","always",["always","near","never"],{description:m("matchBrackets","Highlight matching brackets.")})),minimap:Z(new MR),mouseStyle:Z(new qt(75,"mouseStyle","text",["text","default","copy"])),mouseWheelScrollSensitivity:Z(new lr(76,"mouseWheelScrollSensitivity",1,o=>o===0?1:o,{markdownDescription:m("mouseWheelScrollSensitivity","A multiplier to be used on the `deltaX` and `deltaY` of mouse wheel scroll events.")})),mouseWheelZoom:Z(new it(77,"mouseWheelZoom",!1,{markdownDescription:Ve?m("mouseWheelZoom.mac","Zoom the font of the editor when using mouse wheel and holding `Cmd`."):m("mouseWheelZoom","Zoom the font of the editor when using mouse wheel and holding `Ctrl`.")})),multiCursorMergeOverlapping:Z(new it(78,"multiCursorMergeOverlapping",!0,{description:m("multiCursorMergeOverlapping","Merge multiple cursors when they are overlapping.")})),multiCursorModifier:Z(new uh(79,"multiCursorModifier","altKey","alt",["ctrlCmd","alt"],X9,{markdownEnumDescriptions:[m("multiCursorModifier.ctrlCmd","Maps to `Control` on Windows and Linux and to `Command` on macOS."),m("multiCursorModifier.alt","Maps to `Alt` on Windows and Linux and to `Option` on macOS.")],markdownDescription:m({key:"multiCursorModifier",comment:["- `ctrlCmd` refers to a value the setting can take and should not be localized.","- `Control` and `Command` refer to the modifier keys Ctrl or Cmd on the keyboard and can be localized."]},"The modifier to be used to add multiple cursors with the mouse. The Go to Definition and Open Link mouse gestures will adapt such that they do not conflict with the [multicursor modifier](https://code.visualstudio.com/docs/editor/codebasics#_multicursor-modifier).")})),multiCursorPaste:Z(new qt(80,"multiCursorPaste","spread",["spread","full"],{markdownEnumDescriptions:[m("multiCursorPaste.spread","Each cursor pastes a single line of the text."),m("multiCursorPaste.full","Each cursor pastes the full text.")],markdownDescription:m("multiCursorPaste","Controls pasting when the line count of the pasted text matches the cursor count.")})),multiCursorLimit:Z(new Dt(81,"multiCursorLimit",1e4,1,1e5,{markdownDescription:m("multiCursorLimit","Controls the max number of cursors that can be in an active editor at once.")})),occurrencesHighlight:Z(new qt(82,"occurrencesHighlight","singleFile",["off","singleFile","multiFile"],{markdownEnumDescriptions:[m("occurrencesHighlight.off","Does not highlight occurrences."),m("occurrencesHighlight.singleFile","Highlights occurrences only in the current file."),m("occurrencesHighlight.multiFile","Experimental: Highlights occurrences across all valid open files.")],markdownDescription:m("occurrencesHighlight","Controls whether occurrences should be highlighted across open files.")})),overviewRulerBorder:Z(new it(83,"overviewRulerBorder",!0,{description:m("overviewRulerBorder","Controls whether a border should be drawn around the overview ruler.")})),overviewRulerLanes:Z(new Dt(84,"overviewRulerLanes",3,0,3)),padding:Z(new PR),pasteAs:Z(new JR),parameterHints:Z(new OR),peekWidgetDefaultFocus:Z(new qt(88,"peekWidgetDefaultFocus","tree",["tree","editor"],{enumDescriptions:[m("peekWidgetDefaultFocus.tree","Focus the tree when opening peek"),m("peekWidgetDefaultFocus.editor","Focus the editor when opening peek")],description:m("peekWidgetDefaultFocus","Controls whether to focus the inline editor or the tree in the peek widget.")})),placeholder:Z(new AR),definitionLinkOpensInPeek:Z(new it(90,"definitionLinkOpensInPeek",!1,{description:m("definitionLinkOpensInPeek","Controls whether the Go to Definition mouse gesture always opens the peek widget.")})),quickSuggestions:Z(new FR),quickSuggestionsDelay:Z(new Dt(92,"quickSuggestionsDelay",10,0,1073741824,{description:m("quickSuggestionsDelay","Controls the delay in milliseconds after which quick suggestions will show up.")})),readOnly:Z(new it(93,"readOnly",!1)),readOnlyMessage:Z(new WR),renameOnType:Z(new it(95,"renameOnType",!1,{description:m("renameOnType","Controls whether the editor auto renames on type."),markdownDeprecationMessage:m("renameOnTypeDeprecate","Deprecated, use `editor.linkedEditing` instead.")})),renderControlCharacters:Z(new it(96,"renderControlCharacters",!0,{description:m("renderControlCharacters","Controls whether the editor should render control characters."),restricted:!0})),renderFinalNewline:Z(new qt(97,"renderFinalNewline",At?"dimmed":"on",["off","on","dimmed"],{description:m("renderFinalNewline","Render last line number when the file ends with a newline.")})),renderLineHighlight:Z(new qt(98,"renderLineHighlight","line",["none","gutter","line","all"],{enumDescriptions:["","","",m("renderLineHighlight.all","Highlights both the gutter and the current line.")],description:m("renderLineHighlight","Controls how the editor should render the current line highlight.")})),renderLineHighlightOnlyWhenFocus:Z(new it(99,"renderLineHighlightOnlyWhenFocus",!1,{description:m("renderLineHighlightOnlyWhenFocus","Controls if the editor should render the current line highlight only when the editor is focused.")})),renderValidationDecorations:Z(new qt(100,"renderValidationDecorations","editable",["editable","on","off"])),renderWhitespace:Z(new qt(101,"renderWhitespace","selection",["none","boundary","selection","trailing","all"],{enumDescriptions:["",m("renderWhitespace.boundary","Render whitespace characters except for single spaces between words."),m("renderWhitespace.selection","Render whitespace characters only on selected text."),m("renderWhitespace.trailing","Render only trailing whitespace characters."),""],description:m("renderWhitespace","Controls how the editor should render whitespace characters.")})),revealHorizontalRightPadding:Z(new Dt(102,"revealHorizontalRightPadding",15,0,1e3)),roundedSelection:Z(new it(103,"roundedSelection",!0,{description:m("roundedSelection","Controls whether selections should have rounded corners.")})),rulers:Z(new VR),scrollbar:Z(new HR),scrollBeyondLastColumn:Z(new Dt(106,"scrollBeyondLastColumn",4,0,1073741824,{description:m("scrollBeyondLastColumn","Controls the number of extra characters beyond which the editor will scroll horizontally.")})),scrollBeyondLastLine:Z(new it(107,"scrollBeyondLastLine",!0,{description:m("scrollBeyondLastLine","Controls whether the editor will scroll beyond the last line.")})),scrollPredominantAxis:Z(new it(108,"scrollPredominantAxis",!0,{description:m("scrollPredominantAxis","Scroll only along the predominant axis when scrolling both vertically and horizontally at the same time. Prevents horizontal drift when scrolling vertically on a trackpad.")})),selectionClipboard:Z(new it(109,"selectionClipboard",!0,{description:m("selectionClipboard","Controls whether the Linux primary clipboard should be supported."),included:At})),selectionHighlight:Z(new it(110,"selectionHighlight",!0,{description:m("selectionHighlight","Controls whether the editor should highlight matches similar to the selection.")})),selectOnLineNumbers:Z(new it(111,"selectOnLineNumbers",!0)),showFoldingControls:Z(new qt(112,"showFoldingControls","mouseover",["always","never","mouseover"],{enumDescriptions:[m("showFoldingControls.always","Always show the folding controls."),m("showFoldingControls.never","Never show the folding controls and reduce the gutter size."),m("showFoldingControls.mouseover","Only show the folding controls when the mouse is over the gutter.")],description:m("showFoldingControls","Controls when the folding controls on the gutter are shown.")})),showUnused:Z(new it(113,"showUnused",!0,{description:m("showUnused","Controls fading out of unused code.")})),showDeprecated:Z(new it(142,"showDeprecated",!0,{description:m("showDeprecated","Controls strikethrough deprecated variables.")})),inlayHints:Z(new LR),snippetSuggestions:Z(new qt(114,"snippetSuggestions","inline",["top","bottom","inline","none"],{enumDescriptions:[m("snippetSuggestions.top","Show snippet suggestions on top of other suggestions."),m("snippetSuggestions.bottom","Show snippet suggestions below other suggestions."),m("snippetSuggestions.inline","Show snippets suggestions with other suggestions."),m("snippetSuggestions.none","Do not show snippet suggestions.")],description:m("snippetSuggestions","Controls whether snippets are shown with other suggestions and how they are sorted.")})),smartSelect:Z(new $R),smoothScrolling:Z(new it(116,"smoothScrolling",!1,{description:m("smoothScrolling","Controls whether the editor will scroll using an animation.")})),stopRenderingLineAfter:Z(new Dt(119,"stopRenderingLineAfter",1e4,-1,1073741824)),suggest:Z(new qR),inlineSuggest:Z(new zR),inlineEdit:Z(new KR),inlineCompletionsAccessibilityVerbose:Z(new it(151,"inlineCompletionsAccessibilityVerbose",!1,{description:m("inlineCompletionsAccessibilityVerbose","Controls whether the accessibility hint should be provided to screen reader users when an inline completion is shown.")})),suggestFontSize:Z(new Dt(121,"suggestFontSize",0,0,1e3,{markdownDescription:m("suggestFontSize","Font size for the suggest widget. When set to {0}, the value of {1} is used.","`0`","`#editor.fontSize#`")})),suggestLineHeight:Z(new Dt(122,"suggestLineHeight",0,0,1e3,{markdownDescription:m("suggestLineHeight","Line height for the suggest widget. When set to {0}, the value of {1} is used. The minimum value is 8.","`0`","`#editor.lineHeight#`")})),suggestOnTriggerCharacters:Z(new it(123,"suggestOnTriggerCharacters",!0,{description:m("suggestOnTriggerCharacters","Controls whether suggestions should automatically show up when typing trigger characters.")})),suggestSelection:Z(new qt(124,"suggestSelection","first",["first","recentlyUsed","recentlyUsedByPrefix"],{markdownEnumDescriptions:[m("suggestSelection.first","Always select the first suggestion."),m("suggestSelection.recentlyUsed","Select recent suggestions unless further typing selects one, e.g. `console.| -> console.log` because `log` has been completed recently."),m("suggestSelection.recentlyUsedByPrefix","Select suggestions based on previous prefixes that have completed those suggestions, e.g. `co -> console` and `con -> const`.")],description:m("suggestSelection","Controls how suggestions are pre-selected when showing the suggest list.")})),tabCompletion:Z(new qt(125,"tabCompletion","off",["on","off","onlySnippets"],{enumDescriptions:[m("tabCompletion.on","Tab complete will insert the best matching suggestion when pressing tab."),m("tabCompletion.off","Disable tab completions."),m("tabCompletion.onlySnippets","Tab complete snippets when their prefix match. Works best when 'quickSuggestions' aren't enabled.")],description:m("tabCompletion","Enables tab completions.")})),tabIndex:Z(new Dt(126,"tabIndex",0,-1,1073741824)),unicodeHighlight:Z(new UR),unusualLineTerminators:Z(new qt(128,"unusualLineTerminators","prompt",["auto","off","prompt"],{enumDescriptions:[m("unusualLineTerminators.auto","Unusual line terminators are automatically removed."),m("unusualLineTerminators.off","Unusual line terminators are ignored."),m("unusualLineTerminators.prompt","Unusual line terminators prompt to be removed.")],description:m("unusualLineTerminators","Remove unusual line terminators that might cause problems.")})),useShadowDOM:Z(new it(129,"useShadowDOM",!0)),useTabStops:Z(new it(130,"useTabStops",!0,{description:m("useTabStops","Spaces and tabs are inserted and deleted in alignment with tab stops.")})),wordBreak:Z(new qt(131,"wordBreak","normal",["normal","keepAll"],{markdownEnumDescriptions:[m("wordBreak.normal","Use the default line break rule."),m("wordBreak.keepAll","Word breaks should not be used for Chinese/Japanese/Korean (CJK) text. Non-CJK text behavior is the same as for normal.")],description:m("wordBreak","Controls the word break rules used for Chinese/Japanese/Korean (CJK) text.")})),wordSegmenterLocales:Z(new YR),wordSeparators:Z(new qi(133,"wordSeparators",eR,{description:m("wordSeparators","Characters that will be used as word separators when doing word related navigations or operations.")})),wordWrap:Z(new qt(134,"wordWrap","off",["off","on","wordWrapColumn","bounded"],{markdownEnumDescriptions:[m("wordWrap.off","Lines will never wrap."),m("wordWrap.on","Lines will wrap at the viewport width."),m({key:"wordWrap.wordWrapColumn",comment:["- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Lines will wrap at `#editor.wordWrapColumn#`."),m({key:"wordWrap.bounded",comment:["- viewport means the edge of the visible window size.","- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Lines will wrap at the minimum of viewport and `#editor.wordWrapColumn#`.")],description:m({key:"wordWrap",comment:["- 'off', 'on', 'wordWrapColumn' and 'bounded' refer to values the setting can take and should not be localized.","- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Controls how lines should wrap.")})),wordWrapBreakAfterCharacters:Z(new qi(135,"wordWrapBreakAfterCharacters"," 	})]?|/&.,;\xA2\xB0\u2032\u2033\u2030\u2103\u3001\u3002\uFF61\uFF64\uFFE0\uFF0C\uFF0E\uFF1A\uFF1B\uFF1F\uFF01\uFF05\u30FB\uFF65\u309D\u309E\u30FD\u30FE\u30FC\u30A1\u30A3\u30A5\u30A7\u30A9\u30C3\u30E3\u30E5\u30E7\u30EE\u30F5\u30F6\u3041\u3043\u3045\u3047\u3049\u3063\u3083\u3085\u3087\u308E\u3095\u3096\u31F0\u31F1\u31F2\u31F3\u31F4\u31F5\u31F6\u31F7\u31F8\u31F9\u31FA\u31FB\u31FC\u31FD\u31FE\u31FF\u3005\u303B\uFF67\uFF68\uFF69\uFF6A\uFF6B\uFF6C\uFF6D\uFF6E\uFF6F\uFF70\u201D\u3009\u300B\u300D\u300F\u3011\u3015\uFF09\uFF3D\uFF5D\uFF63")),wordWrapBreakBeforeCharacters:Z(new qi(136,"wordWrapBreakBeforeCharacters","([{\u2018\u201C\u3008\u300A\u300C\u300E\u3010\u3014\uFF08\uFF3B\uFF5B\uFF62\xA3\xA5\uFF04\uFFE1\uFFE5+\uFF0B")),wordWrapColumn:Z(new Dt(137,"wordWrapColumn",80,1,1073741824,{markdownDescription:m({key:"wordWrapColumn",comment:["- `editor.wordWrap` refers to a different setting and should not be localized.","- 'wordWrapColumn' and 'bounded' refer to values the different setting can take and should not be localized."]},"Controls the wrapping column of the editor when `#editor.wordWrap#` is `wordWrapColumn` or `bounded`.")})),wordWrapOverride1:Z(new qt(138,"wordWrapOverride1","inherit",["off","on","inherit"])),wordWrapOverride2:Z(new qt(139,"wordWrapOverride2","inherit",["off","on","inherit"])),editorClassName:Z(new vR),defaultColorDecorators:Z(new it(149,"defaultColorDecorators",!1,{markdownDescription:m("defaultColorDecorators","Controls whether inline color decorations should be shown using the default document color provider")})),pixelRatio:Z(new NR),tabFocusMode:Z(new it(146,"tabFocusMode",!1,{markdownDescription:m("tabFocusMode","Controls whether the editor receives tabs or defers them to the workbench for navigation.")})),layoutInfo:Z(new jf),wrappingInfo:Z(new XR),wrappingIndent:Z(new ZR),wrappingStrategy:Z(new wR)};var IC=class o{_brackets;_regExpRules;constructor(e){e=e||{},e.brackets=e.brackets||[["(",")"],["{","}"],["[","]"]],this._brackets=[],e.brackets.forEach(t=>{let n=o._createOpenBracketRegExp(t[0]),i=o._createCloseBracketRegExp(t[1]);n&&i&&this._brackets.push({open:t[0],openRegExp:n,close:t[1],closeRegExp:i})}),this._regExpRules=e.onEnterRules||[]}onEnter(e,t,n,i){if(e>=3)for(let r=0,s=this._regExpRules.length;r<s;r++){let a=this._regExpRules[r];if([{reg:a.beforeText,text:n},{reg:a.afterText,text:i},{reg:a.previousLineText,text:t}].every(d=>d.reg?(d.reg.lastIndex=0,d.reg.test(d.text)):!0))return a.action}if(e>=2&&n.length>0&&i.length>0)for(let r=0,s=this._brackets.length;r<s;r++){let a=this._brackets[r];if(a.openRegExp.test(n)&&a.closeRegExp.test(i))return{indentAction:2}}if(e>=2&&n.length>0){for(let r=0,s=this._brackets.length;r<s;r++)if(this._brackets[r].openRegExp.test(n))return{indentAction:1}}return null}static _createOpenBracketRegExp(e){let t=ji(e);return/\B/.test(t.charAt(0))||(t="\\b"+t),t+="\\s*$",o._safeRegExp(t)}static _createCloseBracketRegExp(e){let t=ji(e);return/\B/.test(t.charAt(t.length-1))||(t=t+"\\b"),t="^\\s*"+t,o._safeRegExp(t)}static _safeRegExp(e){try{return new RegExp(e)}catch(t){return qe(t),null}}};var t8=[];function $i(o,e,t){e instanceof uf||(e=new uf(e,[],!!t)),t8.push([o,e])}var mu=Object.freeze({text:"text/plain",binary:"application/octet-stream",unknown:"application/unknown",markdown:"text/markdown",latex:"text/latex",uriList:"text/uri-list"});var n8={ModesRegistry:"editor.modesRegistry"},t0=class{_languages;_onDidChangeLanguages=new D;onDidChangeLanguages=this._onDidChangeLanguages.event;constructor(){this._languages=[]}registerLanguage(e){return this._languages.push(e),this._onDidChangeLanguages.fire(void 0),{dispose:()=>{for(let t=0,n=this._languages.length;t<n;t++)if(this._languages[t]===e){this._languages.splice(t,1);return}}}}getLanguages(){return this._languages}},IB=new t0;et.add(n8.ModesRegistry,IB);var Ls="plaintext",i8=".txt";IB.registerLanguage({id:Ls,extensions:[i8],aliases:[m("plainText.alias","Plain Text"),"text"],mimetypes:[mu.text]});et.as(Ao.Configuration).registerDefaultConfigurations([{overrides:{"[plaintext]":{"editor.unicodeHighlight.ambiguousCharacters":!1,"editor.unicodeHighlight.invisibleCharacters":!1}}}]);var $f=class{constructor(e){this.languageId=e}affects(e){return this.languageId?this.languageId===e:!0}},xl=Y("languageConfigurationService"),qf=class extends F{constructor(t,n){super();this.configurationService=t;this.languageService=n;let i=new Set(Object.values(n0));this._register(this.configurationService.onDidChangeConfiguration(r=>{let s=r.change.keys.some(l=>i.has(l)),a=r.change.overrides.filter(([l,d])=>d.some(c=>i.has(c))).map(([l])=>l);if(s)this.configurations.clear(),this.onDidChangeEmitter.fire(new $f(void 0));else for(let l of a)this.languageService.isRegisteredLanguageId(l)&&(this.configurations.delete(l),this.onDidChangeEmitter.fire(new $f(l)))})),this._register(this._registry.onDidChange(r=>{this.configurations.delete(r.languageId),this.onDidChangeEmitter.fire(new $f(r.languageId))}))}_serviceBrand;_registry=this._register(new o0);onDidChangeEmitter=this._register(new D);onDidChange=this.onDidChangeEmitter.event;configurations=new Map;register(t,n,i){return this._registry.register(t,n,i)}getLanguageConfiguration(t){let n=this.configurations.get(t);return n||(n=o8(t,this._registry,this.configurationService,this.languageService),this.configurations.set(t,n)),n}};qf=O([x(0,ut),x(1,Di)],qf);function o8(o,e,t,n){let i=e.getLanguageConfiguration(o);if(!i){if(!n.isRegisteredLanguageId(o))return new gh(o,{});i=new gh(o,{})}let r=r8(i.languageId,t),s=SB([i.underlyingConfig,r]);return new gh(i.languageId,s)}var n0={brackets:"editor.language.brackets",colorizedBracketPairs:"editor.language.colorizedBracketPairs"};function r8(o,e){let t=e.getValue(n0.brackets,{overrideIdentifier:o}),n=e.getValue(n0.colorizedBracketPairs,{overrideIdentifier:o});return{brackets:CB(t),colorizedBracketPairs:CB(n)}}function CB(o){if(Array.isArray(o))return o.map(e=>{if(!(!Array.isArray(e)||e.length!==2))return[e[0],e[1]]}).filter(e=>!!e)}function EC(o,e,t){let n=o.getLineContent(e),i=Jn(n);return i.length>t-1&&(i=i.substring(0,t-1)),i}var i0=class{constructor(e){this.languageId=e;this._entries=[],this._order=0,this._resolved=null}_entries;_order;_resolved=null;register(e,t){let n=new CC(e,t,++this._order);return this._entries.push(n),this._resolved=null,le(()=>{for(let i=0;i<this._entries.length;i++)if(this._entries[i]===n){this._entries.splice(i,1),this._resolved=null;break}})}getResolvedConfiguration(){if(!this._resolved){let e=this._resolve();e&&(this._resolved=new gh(this.languageId,e))}return this._resolved}_resolve(){return this._entries.length===0?null:(this._entries.sort(CC.cmp),SB(this._entries.map(e=>e.configuration)))}};function SB(o){let e={comments:void 0,brackets:void 0,wordPattern:void 0,indentationRules:void 0,onEnterRules:void 0,autoClosingPairs:void 0,surroundingPairs:void 0,autoCloseBefore:void 0,folding:void 0,colorizedBracketPairs:void 0,__electricCharacterSupport:void 0};for(let t of o)e={comments:t.comments||e.comments,brackets:t.brackets||e.brackets,wordPattern:t.wordPattern||e.wordPattern,indentationRules:t.indentationRules||e.indentationRules,onEnterRules:t.onEnterRules||e.onEnterRules,autoClosingPairs:t.autoClosingPairs||e.autoClosingPairs,surroundingPairs:t.surroundingPairs||e.surroundingPairs,autoCloseBefore:t.autoCloseBefore||e.autoCloseBefore,folding:t.folding||e.folding,colorizedBracketPairs:t.colorizedBracketPairs||e.colorizedBracketPairs,__electricCharacterSupport:t.__electricCharacterSupport||e.__electricCharacterSupport};return e}var CC=class{constructor(e,t,n){this.configuration=e;this.priority=t;this.order=n}static cmp(e,t){return e.priority===t.priority?e.order-t.order:e.priority-t.priority}},SC=class{constructor(e){this.languageId=e}},o0=class extends F{_entries=new Map;_onDidChange=this._register(new D);onDidChange=this._onDidChange.event;constructor(){super(),this._register(this.register(Ls,{brackets:[["(",")"],["[","]"],["{","}"]],surroundingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:"<",close:">"},{open:'"',close:'"'},{open:"'",close:"'"},{open:"`",close:"`"}],colorizedBracketPairs:[],folding:{offSide:!0}},0))}register(e,t,n=0){let i=this._entries.get(e);i||(i=new i0(e),this._entries.set(e,i));let r=i.register(t,n);return this._onDidChange.fire(new SC(e)),le(()=>{r.dispose(),this._onDidChange.fire(new SC(e))})}getLanguageConfiguration(e){return this._entries.get(e)?.getResolvedConfiguration()||null}},gh=class o{constructor(e,t){this.languageId=e;this.underlyingConfig=t;this._brackets=null,this._electricCharacter=null,this._onEnterSupport=this.underlyingConfig.brackets||this.underlyingConfig.indentationRules||this.underlyingConfig.onEnterRules?new IC(this.underlyingConfig):null,this.comments=o._handleComments(this.underlyingConfig),this.characterPair=new rC(this.underlyingConfig),this.wordDefinition=this.underlyingConfig.wordPattern||$I,this.indentationRules=this.underlyingConfig.indentationRules,this.underlyingConfig.indentationRules?this.indentRulesSupport=new lC(this.underlyingConfig.indentationRules):this.indentRulesSupport=null,this.foldingRules=this.underlyingConfig.folding||{},this.bracketsNew=new tC(e,this.underlyingConfig)}_brackets;_electricCharacter;_onEnterSupport;comments;characterPair;wordDefinition;indentRulesSupport;indentationRules;foldingRules;bracketsNew;getWordDefinition(){return Vf(this.wordDefinition)}get brackets(){return!this._brackets&&this.underlyingConfig.brackets&&(this._brackets=new JI(this.languageId,this.underlyingConfig.brackets)),this._brackets}get electricCharacter(){return this._electricCharacter||(this._electricCharacter=new sC(this.brackets)),this._electricCharacter}onEnter(e,t,n,i){return this._onEnterSupport?this._onEnterSupport.onEnter(e,t,n,i):null}getAutoClosingPairs(){return new QI(this.characterPair.getAutoClosingPairs())}getAutoCloseBeforeSet(e){return this.characterPair.getAutoCloseBeforeSet(e)}getSurroundingPairs(){return this.characterPair.getSurroundingPairs()}static _handleComments(e){let t=e.comments;if(!t)return null;let n={};if(t.lineComment&&(n.lineCommentToken=t.lineComment),t.blockComment){let[i,r]=t.blockComment;n.blockCommentStartToken=i,n.blockCommentEndToken=r}return n}};$i(xl,qf,1);var r0=class o{constructor(e){this.map=e}static createFromLanguage(e,t){function n(r){return t.getKey(`${r.languageId}:::${r.bracketText}`)}let i=new Map;for(let r of e.bracketsNew.openingBrackets){let s=Qt(0,r.bracketText.length),a=n(r),l=Li.getEmpty().add(a,cR);i.set(r.bracketText,new Rs(s,1,a,l,Yf.create(s,r,l)))}for(let r of e.bracketsNew.closingBrackets){let s=Qt(0,r.bracketText.length),a=Li.getEmpty(),l=r.getOpeningBrackets();for(let d of l)a=a.add(n(d),cR);i.set(r.bracketText,new Rs(s,2,n(l[0]),a,Yf.create(s,r,a)))}return new o(i)}hasRegExp=!1;_regExpGlobal=null;getRegExpStr(){if(this.isEmpty)return null;{let e=[...this.map.keys()];return e.sort(),e.reverse(),e.map(t=>s8(t)).join("|")}}get regExpGlobal(){if(!this.hasRegExp){let e=this.getRegExpStr();this._regExpGlobal=e?new RegExp(e,"gi"):null,this.hasRegExp=!0}return this._regExpGlobal}getToken(e){return this.map.get(e.toLowerCase())}findClosingTokenText(e){for(let[t,n]of this.map)if(n.kind===2&&n.bracketIds.intersects(e))return t}get isEmpty(){return this.map.size===0}};function s8(o){let e=ji(o);return/^[\w ]+/.test(o)&&(e=`\\b${e}`),/[\w ]+$/.test(o)&&(e=`${e}\\b`),e}var TC=class{constructor(e,t){this.denseKeyProvider=e;this.getLanguageConfiguration=t}languageIdToBracketTokens=new Map;didLanguageChange(e){return this.languageIdToBracketTokens.has(e)}getSingleLanguageBracketTokens(e){let t=this.languageIdToBracketTokens.get(e);return t||(t=r0.createFromLanguage(this.getLanguageConfiguration(e),this.denseKeyProvider),this.languageIdToBracketTokens.set(e,t)),t}getToken(e,t){return this.getSingleLanguageBracketTokens(t).getToken(e)}};var Rs=class{constructor(e,t,n,i,r){this.length=e;this.kind=t;this.bracketId=n;this.bracketIds=i;this.astNode=r}},xC=class{constructor(e,t){this.textModel=e;this.bracketTokens=t;this.textBufferLineCount=e.getLineCount(),this.textBufferLastLineLength=e.getLineLength(this.textBufferLineCount)}textBufferLineCount;textBufferLastLineLength;reader=new s0(this.textModel,this.bracketTokens);_offset=ei;get offset(){return this._offset}get length(){return Qt(this.textBufferLineCount-1,this.textBufferLastLineLength)}getText(){return this.textModel.getValue()}skip(e){this.didPeek=!1,this._offset=jt(this._offset,e);let t=to(this._offset);this.reader.setPosition(t.lineCount,t.columnCount)}didPeek=!1;peeked=null;read(){let e;return this.peeked?(this.didPeek=!1,e=this.peeked):e=this.reader.read(),e&&(this._offset=jt(this._offset,e.length)),e}peek(){return this.didPeek||(this.peeked=this.reader.read(),this.didPeek=!0),this.peeked}},s0=class{constructor(e,t){this.textModel=e;this.bracketTokens=t;this.textBufferLineCount=e.getLineCount(),this.textBufferLastLineLength=e.getLineLength(this.textBufferLineCount)}textBufferLineCount;textBufferLastLineLength;lineIdx=0;line=null;lineCharOffset=0;lineTokens=null;lineTokenOffset=0;setPosition(e,t){e===this.lineIdx?(this.lineCharOffset=t,this.line!==null&&(this.lineTokenOffset=this.lineCharOffset===0?0:this.lineTokens.findTokenIndexAtOffset(this.lineCharOffset))):(this.lineIdx=e,this.lineCharOffset=t,this.line=null),this.peekedToken=null}peekedToken=null;read(){if(this.peekedToken){let r=this.peekedToken;return this.peekedToken=null,this.lineCharOffset+=r.length,r}if(this.lineIdx>this.textBufferLineCount-1||this.lineIdx===this.textBufferLineCount-1&&this.lineCharOffset>=this.textBufferLastLineLength)return null;this.line===null&&(this.lineTokens=this.textModel.tokenization.getLineTokens(this.lineIdx+1),this.line=this.lineTokens.getLineContent(),this.lineTokenOffset=this.lineCharOffset===0?0:this.lineTokens.findTokenIndexAtOffset(this.lineCharOffset));let e=this.lineIdx,t=this.lineCharOffset,n=0;for(;;){let r=this.lineTokens,s=r.getCount(),a=null;if(this.lineTokenOffset<s){let l=r.getMetadata(this.lineTokenOffset);for(;this.lineTokenOffset+1<s&&l===r.getMetadata(this.lineTokenOffset+1);)this.lineTokenOffset++;let d=rr.getTokenType(l)===0,c=rr.containsBalancedBrackets(l),u=r.getEndOffset(this.lineTokenOffset);if(c&&d&&this.lineCharOffset<u){let p=r.getLanguageId(this.lineTokenOffset),h=this.line.substring(this.lineCharOffset,u),f=this.bracketTokens.getSingleLanguageBracketTokens(p),g=f.regExpGlobal;if(g){g.lastIndex=0;let b=g.exec(h);b&&(a=f.getToken(b[0]),a&&(this.lineCharOffset+=b.index))}}if(n+=u-this.lineCharOffset,a)if(e!==this.lineIdx||t!==this.lineCharOffset){this.peekedToken=a;break}else return this.lineCharOffset+=a.length,a;else this.lineTokenOffset++,this.lineCharOffset=u}else if(this.lineIdx===this.textBufferLineCount-1||(this.lineIdx++,this.lineTokens=this.textModel.tokenization.getLineTokens(this.lineIdx+1),this.lineTokenOffset=0,this.line=this.lineTokens.getLineContent(),this.lineCharOffset=0,n+=33,n>1e3))break;if(n>1500)break}let i=cB(e,t,this.lineIdx,this.lineCharOffset);return new Rs(i,0,-1,Li.getEmpty(),new ks(i))}},wC=class{constructor(e,t){this.text=e;let n=t.getRegExpStr(),i=n?new RegExp(n+`|
`,"gi"):null,r=[],s,a=0,l=0,d=0,c=0,u=[];for(let f=0;f<60;f++)u.push(new Rs(Qt(0,f),0,-1,Li.getEmpty(),new ks(Qt(0,f))));let p=[];for(let f=0;f<60;f++)p.push(new Rs(Qt(1,f),0,-1,Li.getEmpty(),new ks(Qt(1,f))));if(i)for(i.lastIndex=0;(s=i.exec(e))!==null;){let f=s.index,g=s[0];if(g===`
`)a++,l=f+1;else{if(d!==f){let b;if(c===a){let v=f-d;if(v<u.length)b=u[v];else{let y=Qt(0,v);b=new Rs(y,0,-1,Li.getEmpty(),new ks(y))}}else{let v=a-c,y=f-l;if(v===1&&y<p.length)b=p[y];else{let S=Qt(v,y);b=new Rs(S,0,-1,Li.getEmpty(),new ks(S))}}r.push(b)}r.push(t.getToken(g)),d=f+g.length,c=a}}let h=e.length;if(d!==h){let f=c===a?Qt(0,h-d):Qt(a-c,h-l);r.push(new Rs(f,0,-1,Li.getEmpty(),new ks(f)))}this.length=Qt(a,h-l),this.tokens=r}_offset=ei;tokens;idx=0;get offset(){return this._offset}length;read(){return this.tokens[this.idx++]||null}peek(){return this.tokens[this.idx]||null}skip(e){throw new Cy}getText(){return this.text}};var Zf=class{_length;get length(){return this._length}constructor(e){this._length=e}},Xf=class o extends Zf{constructor(t,n,i,r,s){super(t);this.openingBracket=n;this.child=i;this.closingBracket=r;this.missingOpeningBracketIds=s}static create(t,n,i){let r=t.length;return n&&(r=jt(r,n.length)),i&&(r=jt(r,i.length)),new o(r,t,n,i,n?n.missingOpeningBracketIds:Li.getEmpty())}get kind(){return 2}get listHeight(){return 0}get childrenLength(){return 3}getChild(t){switch(t){case 0:return this.openingBracket;case 1:return this.child;case 2:return this.closingBracket}throw new Error("Invalid child index")}get children(){let t=[];return t.push(this.openingBracket),this.child&&t.push(this.child),this.closingBracket&&t.push(this.closingBracket),t}canBeReused(t){return!(this.closingBracket===null||t.intersects(this.missingOpeningBracketIds))}flattenLists(){return o.create(this.openingBracket.flattenLists(),this.child&&this.child.flattenLists(),this.closingBracket&&this.closingBracket.flattenLists())}deepClone(){return new o(this.length,this.openingBracket.deepClone(),this.child&&this.child.deepClone(),this.closingBracket&&this.closingBracket.deepClone(),this.missingOpeningBracketIds)}computeMinIndentation(t,n){return this.child?this.child.computeMinIndentation(jt(t,this.openingBracket.length),n):Number.MAX_SAFE_INTEGER}},dr=class o extends Zf{constructor(t,n,i){super(t);this.listHeight=n;this._missingOpeningBracketIds=i}static create23(t,n,i,r=!1){let s=t.length,a=t.missingOpeningBracketIds;if(t.listHeight!==n.listHeight)throw new Error("Invalid list heights");if(s=jt(s,n.length),a=a.merge(n.missingOpeningBracketIds),i){if(t.listHeight!==i.listHeight)throw new Error("Invalid list heights");s=jt(s,i.length),a=a.merge(i.missingOpeningBracketIds)}return r?new a0(s,t.listHeight+1,t,n,i,a):new Qf(s,t.listHeight+1,t,n,i,a)}static create(t,n=!1){if(t.length===0)return this.getEmpty();{let i=t[0].length,r=t[0].missingOpeningBracketIds;for(let s=1;s<t.length;s++)i=jt(i,t[s].length),r=r.merge(t[s].missingOpeningBracketIds);return n?new _C(i,t[0].listHeight+1,t,r):new Jf(i,t[0].listHeight+1,t,r)}}static getEmpty(){return new _C(ei,0,[],Li.getEmpty())}get kind(){return 4}get missingOpeningBracketIds(){return this._missingOpeningBracketIds}cachedMinIndentation=-1;throwIfImmutable(){}makeLastElementMutable(){this.throwIfImmutable();let t=this.childrenLength;if(t===0)return;let n=this.getChild(t-1),i=n.kind===4?n.toMutable():n;return n!==i&&this.setChild(t-1,i),i}makeFirstElementMutable(){if(this.throwIfImmutable(),this.childrenLength===0)return;let n=this.getChild(0),i=n.kind===4?n.toMutable():n;return n!==i&&this.setChild(0,i),i}canBeReused(t){if(t.intersects(this.missingOpeningBracketIds)||this.childrenLength===0)return!1;let n=this;for(;n.kind===4;){let i=n.childrenLength;if(i===0)throw new Ye;n=n.getChild(i-1)}return n.canBeReused(t)}handleChildrenChanged(){this.throwIfImmutable();let t=this.childrenLength,n=this.getChild(0).length,i=this.getChild(0).missingOpeningBracketIds;for(let r=1;r<t;r++){let s=this.getChild(r);n=jt(n,s.length),i=i.merge(s.missingOpeningBracketIds)}this._length=n,this._missingOpeningBracketIds=i,this.cachedMinIndentation=-1}flattenLists(){let t=[];for(let n of this.children){let i=n.flattenLists();i.kind===4?t.push(...i.children):t.push(i)}return o.create(t)}computeMinIndentation(t,n){if(this.cachedMinIndentation!==-1)return this.cachedMinIndentation;let i=Number.MAX_SAFE_INTEGER,r=t;for(let s=0;s<this.childrenLength;s++){let a=this.getChild(s);a&&(i=Math.min(i,a.computeMinIndentation(r,n)),r=jt(r,a.length))}return this.cachedMinIndentation=i,i}},Qf=class o extends dr{constructor(t,n,i,r,s,a){super(t,n,a);this._item1=i;this._item2=r;this._item3=s}get childrenLength(){return this._item3!==null?3:2}getChild(t){switch(t){case 0:return this._item1;case 1:return this._item2;case 2:return this._item3}throw new Error("Invalid child index")}setChild(t,n){switch(t){case 0:this._item1=n;return;case 1:this._item2=n;return;case 2:this._item3=n;return}throw new Error("Invalid child index")}get children(){return this._item3?[this._item1,this._item2,this._item3]:[this._item1,this._item2]}get item1(){return this._item1}get item2(){return this._item2}get item3(){return this._item3}deepClone(){return new o(this.length,this.listHeight,this._item1.deepClone(),this._item2.deepClone(),this._item3?this._item3.deepClone():null,this.missingOpeningBracketIds)}appendChildOfSameHeight(t){if(this._item3)throw new Error("Cannot append to a full (2,3) tree node");this.throwIfImmutable(),this._item3=t,this.handleChildrenChanged()}unappendChild(){if(!this._item3)throw new Error("Cannot remove from a non-full (2,3) tree node");this.throwIfImmutable();let t=this._item3;return this._item3=null,this.handleChildrenChanged(),t}prependChildOfSameHeight(t){if(this._item3)throw new Error("Cannot prepend to a full (2,3) tree node");this.throwIfImmutable(),this._item3=this._item2,this._item2=this._item1,this._item1=t,this.handleChildrenChanged()}unprependChild(){if(!this._item3)throw new Error("Cannot remove from a non-full (2,3) tree node");this.throwIfImmutable();let t=this._item1;return this._item1=this._item2,this._item2=this._item3,this._item3=null,this.handleChildrenChanged(),t}toMutable(){return this}},a0=class extends Qf{toMutable(){return new Qf(this.length,this.listHeight,this.item1,this.item2,this.item3,this.missingOpeningBracketIds)}throwIfImmutable(){throw new Error("this instance is immutable")}},Jf=class o extends dr{constructor(t,n,i,r){super(t,n,r);this._children=i}get childrenLength(){return this._children.length}getChild(t){return this._children[t]}setChild(t,n){this._children[t]=n}get children(){return this._children}deepClone(){let t=new Array(this._children.length);for(let n=0;n<this._children.length;n++)t[n]=this._children[n].deepClone();return new o(this.length,this.listHeight,t,this.missingOpeningBracketIds)}appendChildOfSameHeight(t){this.throwIfImmutable(),this._children.push(t),this.handleChildrenChanged()}unappendChild(){this.throwIfImmutable();let t=this._children.pop();return this.handleChildrenChanged(),t}prependChildOfSameHeight(t){this.throwIfImmutable(),this._children.unshift(t),this.handleChildrenChanged()}unprependChild(){this.throwIfImmutable();let t=this._children.shift();return this.handleChildrenChanged(),t}toMutable(){return this}},_C=class extends Jf{toMutable(){return new Jf(this.length,this.listHeight,[...this.children],this.missingOpeningBracketIds)}throwIfImmutable(){throw new Error("this instance is immutable")}},l8=[],eb=class extends Zf{get listHeight(){return 0}get childrenLength(){return 0}getChild(e){return null}get children(){return l8}flattenLists(){return this}deepClone(){return this}},ks=class extends eb{get kind(){return 0}get missingOpeningBracketIds(){return Li.getEmpty()}canBeReused(e){return!0}computeMinIndentation(e,t){let n=to(e),i=(n.columnCount===0?n.lineCount:n.lineCount+1)+1,r=uB(jt(e,this.length))+1,s=Number.MAX_SAFE_INTEGER;for(let a=i;a<=r;a++){let l=t.getLineFirstNonWhitespaceColumn(a),d=t.getLineContent(a);if(l===0)continue;let c=Vt.visibleColumnFromColumn(d,l,t.getOptions().tabSize);s=Math.min(s,c)}return s}},Yf=class o extends eb{constructor(t,n,i){super(t);this.bracketInfo=n;this.bracketIds=i}static create(t,n,i){return new o(t,n,i)}get kind(){return 1}get missingOpeningBracketIds(){return Li.getEmpty()}get text(){return this.bracketInfo.bracketText}get languageId(){return this.bracketInfo.languageId}canBeReused(t){return!1}computeMinIndentation(t,n){return Number.MAX_SAFE_INTEGER}},DC=class extends eb{get kind(){return 3}missingOpeningBracketIds;constructor(e,t){super(t),this.missingOpeningBracketIds=e}canBeReused(e){return!e.intersects(this.missingOpeningBracketIds)}computeMinIndentation(e,t){return Number.MAX_SAFE_INTEGER}};var tb=class{constructor(e,t,n,i){this.range=e;this.nestingLevel=t;this.nestingLevelOfEqualBracketType=n;this.isInvalid=i}},l0=class{constructor(e,t,n,i,r,s){this.range=e;this.openingBracketRange=t;this.closingBracketRange=n;this.nestingLevel=i;this.nestingLevelOfEqualBracketType=r;this.bracketPairNode=s}get openingBracketInfo(){return this.bracketPairNode.openingBracket.bracketInfo}get closingBracketInfo(){return this.bracketPairNode.closingBracket?.bracketInfo}},LC=class extends l0{constructor(t,n,i,r,s,a,l){super(t,n,i,r,s,a);this.minVisibleColumnIndentation=l}};var RC=class{changeType=1},Fo=class o{constructor(e,t,n,i,r){this.ownerId=e;this.lineNumber=t;this.column=n;this.options=i;this.order=r}static applyInjectedText(e,t){if(!t||t.length===0)return e;let n="",i=0;for(let r of t)n+=e.substring(i,r.column-1),i=r.column-1,n+=r.options.content;return n+=e.substring(i),n}static fromDecorations(e){let t=[];for(let n of e)n.options.before&&n.options.before.content.length>0&&t.push(new o(n.ownerId,n.range.startLineNumber,n.range.startColumn,n.options.before,0)),n.options.after&&n.options.after.content.length>0&&t.push(new o(n.ownerId,n.range.endLineNumber,n.range.endColumn,n.options.after,1));return t.sort((n,i)=>n.lineNumber===i.lineNumber?n.column===i.column?n.order-i.order:n.column-i.column:n.lineNumber-i.lineNumber),t}withText(e){return new o(this.ownerId,this.lineNumber,this.column,{...this.options,content:e},this.order)}},nb=class{changeType=2;lineNumber;detail;injectedText;constructor(e,t,n){this.lineNumber=e,this.detail=t,this.injectedText=n}},kC=class{changeType=3;fromLineNumber;toLineNumber;constructor(e,t){this.fromLineNumber=e,this.toLineNumber=t}},MC=class{changeType=4;fromLineNumber;toLineNumber;detail;injectedTexts;constructor(e,t,n,i){this.injectedTexts=i,this.fromLineNumber=e,this.toLineNumber=t,this.detail=n}},PC=class{changeType=5},gu=class o{changes;versionId;isUndoing;isRedoing;resultingSelection;constructor(e,t,n,i){this.changes=e,this.versionId=t,this.isUndoing=n,this.isRedoing=i,this.resultingSelection=null}containsEvent(e){for(let t=0,n=this.changes.length;t<n;t++)if(this.changes[t].changeType===e)return!0;return!1}static merge(e,t){let n=[].concat(e.changes).concat(t.changes),i=t.versionId,r=e.isUndoing||t.isUndoing,s=e.isRedoing||t.isRedoing;return new o(n,i,r,s)}},fh=class{changes;constructor(e){this.changes=e}},Vd=class o{constructor(e,t){this.rawContentChangedEvent=e;this.contentChangedEvent=t}merge(e){let t=gu.merge(this.rawContentChangedEvent,e.rawContentChangedEvent),n=o._mergeChangeEvents(this.contentChangedEvent,e.contentChangedEvent);return new o(t,n)}static _mergeChangeEvents(e,t){let n=[].concat(e.changes).concat(t.changes),i=t.eol,r=t.versionId,s=e.isUndoing||t.isUndoing,a=e.isRedoing||t.isRedoing,l=e.isFlush||t.isFlush,d=e.isEolChange&&t.isEolChange;return{changes:n,eol:i,isEolChange:d,versionId:r,isUndoing:s,isRedoing:a,isFlush:l}}};var ts=class{constructor(e,t,n,i,r,s){this.visibleColumn=e;this.column=t;this.className=n;this.horizontalLine=i;this.forWrappedLinesAfterColumn=r;this.forWrappedLinesBeforeOrAtColumn=s;if(e!==-1==(t!==-1))throw new Error}},wl=class{constructor(e,t){this.top=e;this.endColumn=t}};var OC=class o{constructor(e){this.edits=e;let t=-1;for(let n of e){if(!(n.replaceRange.start>=t))throw new Ye(`Edits must be disjoint and sorted. Found ${n} after ${t}`);t=n.replaceRange.endExclusive}}static empty=new o([]);static fromJson(e){return new o(e.map(Ms.fromJson))}static replace(e,t){return new o([new Ms(e,t)])}static insert(e,t){return o.replace(ke.emptyAt(e),t)}normalize(){let e=[],t;for(let n of this.edits)n.newText.length===0&&n.replaceRange.length===0||(t&&t.replaceRange.endExclusive===n.replaceRange.start?t=new Ms(t.replaceRange.join(n.replaceRange),t.newText+n.newText):(t&&e.push(t),t=n));return t&&e.push(t),new o(e)}toString(){return`[${this.edits.map(t=>t.toString()).join(", ")}]`}apply(e){let t=[],n=0;for(let i of this.edits)t.push(e.substring(n,i.replaceRange.start)),t.push(i.newText),n=i.replaceRange.endExclusive;return t.push(e.substring(n)),t.join("")}compose(e){return c8(this,e)}inverse(e){let t=[],n=0;for(let i of this.edits)t.push(new Ms(ke.ofStartAndLength(i.replaceRange.start+n,i.newText.length),e.substring(i.replaceRange.start,i.replaceRange.endExclusive))),n+=i.newText.length-i.replaceRange.length;return new o(t)}getNewTextRanges(){let e=[],t=0;for(let n of this.edits)e.push(ke.ofStartAndLength(n.replaceRange.start+t,n.newText.length)),t+=n.newText.length-n.replaceRange.length;return e}get isEmpty(){return this.edits.length===0}tryRebase(e){let t=[],n=0,i=0,r=0;for(;i<this.edits.length||n<e.edits.length;){let s=e.edits[n],a=this.edits[i];if(a)s?a.replaceRange.intersects(s.replaceRange)?i++:a.replaceRange.start<s.replaceRange.start?(t.push(new Ms(a.replaceRange.delta(r),a.newText)),i++):(n++,r+=s.newText.length-s.replaceRange.length):(t.push(new Ms(a.replaceRange.delta(r),a.newText)),i++);else break}return new o(t)}applyToOffset(e){let t=0;for(let n of this.edits)if(n.replaceRange.start<=e){if(e<n.replaceRange.endExclusive)return n.replaceRange.start+t;t+=n.newText.length-n.replaceRange.length}else break;return e+t}applyToOffsetRange(e){return new ke(this.applyToOffset(e.start),this.applyToOffset(e.endExclusive))}applyInverseToOffset(e){let t=0;for(let n of this.edits){let i=n.newText.length;if(n.replaceRange.start<=e-t){if(e-t<n.replaceRange.start+i)return n.replaceRange.start;t+=i-n.replaceRange.length}else break}return e-t}},Ms=class o{constructor(e,t){this.replaceRange=e;this.newText=t}static fromJson(e){return new o(ke.ofStartAndLength(e.pos,e.len),e.txt)}static insert(e,t){return new o(ke.emptyAt(e),t)}toString(){return`${this.replaceRange} -> "${this.newText}"`}get isEmpty(){return this.newText.length===0&&this.replaceRange.length===0}};function c8(o,e){if(o=o.normalize(),e=e.normalize(),o.isEmpty)return e;if(e.isEmpty)return o;let t=[...o.edits],n=[],i=0;for(let r of e.edits){for(;;){let d=t[0];if(!d||d.replaceRange.start+i+d.newText.length>=r.replaceRange.start)break;t.shift(),n.push(d),i+=d.newText.length-d.replaceRange.length}let s=i,a,l;for(;;){let d=t[0];if(!d||d.replaceRange.start+i>r.replaceRange.endExclusive)break;a||(a=d),l=d,t.shift(),i+=d.newText.length-d.replaceRange.length}if(!a)n.push(new Ms(r.replaceRange.delta(-i),r.newText));else{let d="",c=r.replaceRange.start-(a.replaceRange.start+s);c>0&&(d=a.newText.slice(0,c));let u=l.replaceRange.endExclusive+i-r.replaceRange.endExclusive;if(u>0){let f=new Ms(ke.ofStartAndLength(l.replaceRange.endExclusive,0),l.newText.slice(-u));t.unshift(f),i-=f.newText.length-f.replaceRange.length}let p=d+r.newText,h=new ke(Math.min(a.replaceRange.start,r.replaceRange.start-s),r.replaceRange.endExclusive-i);n.push(new Ms(h,p))}}for(;;){let r=t.shift();if(!r)break;n.push(r)}return new OC(n).normalize()}function Bo(o){let e=0,t=0,n=0,i=0;for(let r=0,s=o.length;r<s;r++){let a=o.charCodeAt(r);a===13?(e===0&&(t=r),e++,r+1<s&&o.charCodeAt(r+1)===10?(i|=2,r++):i|=3,n=r+1):a===10&&(i|=1,e===0&&(t=r),e++,n=r+1)}return e===0&&(t=o.length),[e,t,o.length-n,i]}var xB=Y("undoRedoService");var EB=class o{static _ID=0;id;order;constructor(){this.id=o._ID++,this.order=1}nextOrder(){return this.id===0?0:this.order++}static None=new o},TB=class o{static _ID=0;id;order;constructor(){this.id=o._ID++,this.order=1}nextOrder(){return this.id===0?0:this.order++}static None=new o};var bh=class{_textModelResolvedOptionsBrand=void 0;tabSize;indentSize;_indentSizeIsTabSize;insertSpaces;defaultEOL;trimAutoWhitespace;bracketPairColorizationOptions;get originalIndentSize(){return this._indentSizeIsTabSize?"tabSize":this.indentSize}constructor(e){this.tabSize=Math.max(1,e.tabSize|0),e.indentSize==="tabSize"?(this.indentSize=this.tabSize,this._indentSizeIsTabSize=!0):(this.indentSize=Math.max(1,e.indentSize|0),this._indentSizeIsTabSize=!1),this.insertSpaces=!!e.insertSpaces,this.defaultEOL=e.defaultEOL|0,this.trimAutoWhitespace=!!e.trimAutoWhitespace,this.bracketPairColorizationOptions=e.bracketPairColorizationOptions}equals(e){return this.tabSize===e.tabSize&&this._indentSizeIsTabSize===e._indentSizeIsTabSize&&this.indentSize===e.indentSize&&this.insertSpaces===e.insertSpaces&&this.defaultEOL===e.defaultEOL&&this.trimAutoWhitespace===e.trimAutoWhitespace&&Mn(this.bracketPairColorizationOptions,e.bracketPairColorizationOptions)}createChangeEvent(e){return{tabSize:this.tabSize!==e.tabSize,indentSize:this.indentSize!==e.indentSize,insertSpaces:this.insertSpaces!==e.insertSpaces,trimAutoWhitespace:this.trimAutoWhitespace!==e.trimAutoWhitespace}}},Wd=class{_findMatchBrand=void 0;range;matches;constructor(e,t){this.range=e,this.matches=t}};function wB(o){return o&&typeof o.read=="function"}var vh=class{constructor(e,t,n,i,r,s){this.identifier=e;this.range=t;this.text=n;this.forceMoveMarkers=i;this.isAutoWhitespaceEdit=r;this._isTracked=s}},NC=class{regex;wordSeparators;simpleSearch;constructor(e,t,n){this.regex=e,this.wordSeparators=t,this.simpleSearch=n}},AC=class{constructor(e,t,n){this.reverseEdits=e;this.changes=t;this.trimAutoWhitespaceLineNumbers=n}};var ib=class{_tokenizationSupports=new Map;_factories=new Map;_onDidChange=new D;onDidChange=this._onDidChange.event;_colorMap;constructor(){this._colorMap=null}handleChange(e){this._onDidChange.fire({changedLanguages:e,changedColorMap:!1})}register(e,t){return this._tokenizationSupports.set(e,t),this.handleChange([e]),le(()=>{this._tokenizationSupports.get(e)===t&&(this._tokenizationSupports.delete(e),this.handleChange([e]))})}get(e){return this._tokenizationSupports.get(e)||null}registerFactory(e,t){this._factories.get(e)?.dispose();let n=new d0(this,e,t);return this._factories.set(e,n),le(()=>{let i=this._factories.get(e);!i||i!==n||(this._factories.delete(e),i.dispose())})}async getOrCreate(e){let t=this.get(e);if(t)return t;let n=this._factories.get(e);return!n||n.isResolved?null:(await n.resolve(),this.get(e))}isResolved(e){if(this.get(e))return!0;let n=this._factories.get(e);return!!(!n||n.isResolved)}setColorMap(e){this._colorMap=e,this._onDidChange.fire({changedLanguages:Array.from(this._tokenizationSupports.keys()),changedColorMap:!0})}getColorMap(){return this._colorMap}getDefaultBackground(){return this._colorMap&&this._colorMap.length>2?this._colorMap[2]:null}},d0=class extends F{constructor(t,n,i){super();this._registry=t;this._languageId=n;this._factory=i}_isDisposed=!1;_resolvePromise=null;_isResolved=!1;get isResolved(){return this._isResolved}dispose(){this._isDisposed=!0,super.dispose()}async resolve(){return this._resolvePromise||(this._resolvePromise=this._create()),this._resolvePromise}async _create(){let t=await this._factory.tokenizationSupport;this._isResolved=!0,t&&!this._isDisposed&&this._register(this._registry.register(this._languageId,t))}};var Ea=new Uint32Array(0).buffer,mi=class o{static deleteBeginning(e,t){return e===null||e===Ea?e:o.delete(e,0,t)}static deleteEnding(e,t){if(e===null||e===Ea)return e;let n=Ta(e),i=n[n.length-2];return o.delete(e,t,i)}static delete(e,t,n){if(e===null||e===Ea||t===n)return e;let i=Ta(e),r=i.length>>>1;if(t===0&&i[i.length-2]===n)return Ea;let s=Sn.findIndexInTokensArray(i,t),a=s>0?i[s-1<<1]:0,l=i[s<<1];if(n<l){let h=n-t;for(let f=s;f<r;f++)i[f<<1]-=h;return e}let d,c;a!==t?(i[s<<1]=t,d=s+1<<1,c=t):(d=s<<1,c=a);let u=n-t;for(let h=s+1;h<r;h++){let f=i[h<<1]-u;f>c&&(i[d++]=f,i[d++]=i[(h<<1)+1],c=f)}if(d===i.length)return e;let p=new Uint32Array(d);return p.set(i.subarray(0,d),0),p.buffer}static append(e,t){if(t===Ea)return e;if(e===Ea)return t;if(e===null)return e;if(t===null)return null;let n=Ta(e),i=Ta(t),r=i.length>>>1,s=new Uint32Array(n.length+i.length);s.set(n,0);let a=n.length,l=n[n.length-2];for(let d=0;d<r;d++)s[a++]=i[d<<1]+l,s[a++]=i[(d<<1)+1];return s.buffer}static insert(e,t,n){if(e===null||e===Ea)return e;let i=Ta(e),r=i.length>>>1,s=Sn.findIndexInTokensArray(i,t);s>0&&i[s-1<<1]===t&&s--;for(let a=s;a<r;a++)i[a<<1]+=n;return e}};function Ta(o){return o instanceof Uint32Array?o:new Uint32Array(o)}var Re=class o{static fromRange(e){return new o(e.startLineNumber,e.endLineNumber)}static fromRangeInclusive(e){return new o(e.startLineNumber,e.endLineNumber+1)}static subtract(e,t){return t?e.startLineNumber<t.startLineNumber&&t.endLineNumberExclusive<e.endLineNumberExclusive?[new o(e.startLineNumber,t.startLineNumber),new o(t.endLineNumberExclusive,e.endLineNumberExclusive)]:t.startLineNumber<=e.startLineNumber&&e.endLineNumberExclusive<=t.endLineNumberExclusive?[]:t.endLineNumberExclusive<e.endLineNumberExclusive?[new o(Math.max(t.endLineNumberExclusive,e.startLineNumber),e.endLineNumberExclusive)]:[new o(e.startLineNumber,Math.min(t.startLineNumber,e.endLineNumberExclusive))]:[e]}static joinMany(e){if(e.length===0)return[];let t=new Pr(e[0].slice());for(let n=1;n<e.length;n++)t=t.getUnion(new Pr(e[n].slice()));return t.ranges}static join(e){if(e.length===0)throw new Ye("lineRanges cannot be empty");let t=e[0].startLineNumber,n=e[0].endLineNumberExclusive;for(let i=1;i<e.length;i++)t=Math.min(t,e[i].startLineNumber),n=Math.max(n,e[i].endLineNumberExclusive);return new o(t,n)}static ofLength(e,t){return new o(e,e+t)}static deserialize(e){return new o(e[0],e[1])}startLineNumber;endLineNumberExclusive;constructor(e,t){if(e>t)throw new Ye(`startLineNumber ${e} cannot be after endLineNumberExclusive ${t}`);this.startLineNumber=e,this.endLineNumberExclusive=t}contains(e){return this.startLineNumber<=e&&e<this.endLineNumberExclusive}get isEmpty(){return this.startLineNumber===this.endLineNumberExclusive}delta(e){return new o(this.startLineNumber+e,this.endLineNumberExclusive+e)}deltaLength(e){return new o(this.startLineNumber,this.endLineNumberExclusive+e)}get length(){return this.endLineNumberExclusive-this.startLineNumber}join(e){return new o(Math.min(this.startLineNumber,e.startLineNumber),Math.max(this.endLineNumberExclusive,e.endLineNumberExclusive))}toString(){return`[${this.startLineNumber},${this.endLineNumberExclusive})`}intersect(e){let t=Math.max(this.startLineNumber,e.startLineNumber),n=Math.min(this.endLineNumberExclusive,e.endLineNumberExclusive);if(t<=n)return new o(t,n)}intersectsStrict(e){return this.startLineNumber<e.endLineNumberExclusive&&e.startLineNumber<this.endLineNumberExclusive}overlapOrTouch(e){return this.startLineNumber<=e.endLineNumberExclusive&&e.startLineNumber<=this.endLineNumberExclusive}equals(e){return this.startLineNumber===e.startLineNumber&&this.endLineNumberExclusive===e.endLineNumberExclusive}toInclusiveRange(){return this.isEmpty?null:new P(this.startLineNumber,1,this.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER)}toExclusiveRange(){return new P(this.startLineNumber,1,this.endLineNumberExclusive,1)}mapToLineArray(e){let t=[];for(let n=this.startLineNumber;n<this.endLineNumberExclusive;n++)t.push(e(n));return t}forEach(e){for(let t=this.startLineNumber;t<this.endLineNumberExclusive;t++)e(t)}serialize(){return[this.startLineNumber,this.endLineNumberExclusive]}includes(e){return this.startLineNumber<=e&&e<this.endLineNumberExclusive}toOffsetRange(){return new ke(this.startLineNumber-1,this.endLineNumberExclusive-1)}},Pr=class o{constructor(e=[]){this._normalizedRanges=e}get ranges(){return this._normalizedRanges}addRange(e){if(e.length===0)return;let t=Kg(this._normalizedRanges,i=>i.endLineNumberExclusive>=e.startLineNumber),n=al(this._normalizedRanges,i=>i.startLineNumber<=e.endLineNumberExclusive)+1;if(t===n)this._normalizedRanges.splice(t,0,e);else if(t===n-1){let i=this._normalizedRanges[t];this._normalizedRanges[t]=i.join(e)}else{let i=this._normalizedRanges[t].join(this._normalizedRanges[n-1]).join(e);this._normalizedRanges.splice(t,n-t,i)}}contains(e){let t=sl(this._normalizedRanges,n=>n.startLineNumber<=e);return!!t&&t.endLineNumberExclusive>e}intersects(e){let t=sl(this._normalizedRanges,n=>n.startLineNumber<e.endLineNumberExclusive);return!!t&&t.endLineNumberExclusive>e.startLineNumber}getUnion(e){if(this._normalizedRanges.length===0)return e;if(e._normalizedRanges.length===0)return this;let t=[],n=0,i=0,r=null;for(;n<this._normalizedRanges.length||i<e._normalizedRanges.length;){let s=null;if(n<this._normalizedRanges.length&&i<e._normalizedRanges.length){let a=this._normalizedRanges[n],l=e._normalizedRanges[i];a.startLineNumber<l.startLineNumber?(s=a,n++):(s=l,i++)}else n<this._normalizedRanges.length?(s=this._normalizedRanges[n],n++):(s=e._normalizedRanges[i],i++);r===null?r=s:r.endLineNumberExclusive>=s.startLineNumber?r=new Re(r.startLineNumber,Math.max(r.endLineNumberExclusive,s.endLineNumberExclusive)):(t.push(r),r=s)}return r!==null&&t.push(r),new o(t)}subtractFrom(e){let t=Kg(this._normalizedRanges,s=>s.endLineNumberExclusive>=e.startLineNumber),n=al(this._normalizedRanges,s=>s.startLineNumber<=e.endLineNumberExclusive)+1;if(t===n)return new o([e]);let i=[],r=e.startLineNumber;for(let s=t;s<n;s++){let a=this._normalizedRanges[s];a.startLineNumber>r&&i.push(new Re(r,a.startLineNumber)),r=a.endLineNumberExclusive}return r<e.endLineNumberExclusive&&i.push(new Re(r,e.endLineNumberExclusive)),new o(i)}toString(){return this._normalizedRanges.map(e=>e.toString()).join(", ")}getIntersection(e){let t=[],n=0,i=0;for(;n<this._normalizedRanges.length&&i<e._normalizedRanges.length;){let r=this._normalizedRanges[n],s=e._normalizedRanges[i],a=r.intersect(s);a&&!a.isEmpty&&t.push(a),r.endLineNumberExclusive<s.endLineNumberExclusive?n++:i++}return new o(t)}getWithDelta(e){return new o(this._normalizedRanges.map(t=>t.delta(e)))}};var ob=class o{static deserialize(e,t,n){let i=new Uint32Array(e.buffer),r=pi(e,t);t+=4;let s=pi(e,t);t+=4;let a=[];for(let l=0;l<s;l++){let d=pi(e,t);t+=4,a.push(i.subarray(t/4,t/4+d/4)),t+=d}return n.push(new o(r,a)),t}_startLineNumber;_tokens;get startLineNumber(){return this._startLineNumber}get endLineNumber(){return this._startLineNumber+this._tokens.length-1}constructor(e,t){this._startLineNumber=e,this._tokens=t}getLineRange(){return new Re(this._startLineNumber,this._startLineNumber+this._tokens.length)}getLineTokens(e){return this._tokens[e-this._startLineNumber]}appendLineTokens(e){this._tokens.push(e)}serializeSize(){let e=0;e+=4,e+=4;for(let t=0;t<this._tokens.length;t++){let n=this._tokens[t];if(!(n instanceof Uint32Array))throw new Error("Not supported!");e+=4,e+=n.byteLength}return e}serialize(e,t){hi(e,this._startLineNumber,t),t+=4,hi(e,this._tokens.length,t),t+=4;for(let n=0;n<this._tokens.length;n++){let i=this._tokens[n];if(!(i instanceof Uint32Array))throw new Error("Not supported!");hi(e,i.byteLength,t),t+=4,e.set(new Uint8Array(i.buffer),t),t+=i.byteLength}return t}applyEdit(e,t){let[n,i]=Bo(t);this._acceptDeleteRange(e),this._acceptInsertText(new A(e.startLineNumber,e.startColumn),n,i)}_acceptDeleteRange(e){if(e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn)return;let t=e.startLineNumber-this._startLineNumber,n=e.endLineNumber-this._startLineNumber;if(n<0){let i=n-t;this._startLineNumber-=i;return}if(!(t>=this._tokens.length)){if(t<0&&n>=this._tokens.length){this._startLineNumber=0,this._tokens=[];return}if(t===n){this._tokens[t]=mi.delete(this._tokens[t],e.startColumn-1,e.endColumn-1);return}if(t>=0)if(this._tokens[t]=mi.deleteEnding(this._tokens[t],e.startColumn-1),n<this._tokens.length){let i=mi.deleteBeginning(this._tokens[n],e.endColumn-1);this._tokens[t]=mi.append(this._tokens[t],i),this._tokens.splice(t+1,n-t)}else this._tokens[t]=mi.append(this._tokens[t],null),this._tokens=this._tokens.slice(0,t+1);else{let i=-t;this._startLineNumber-=i,this._tokens[n]=mi.deleteBeginning(this._tokens[n],e.endColumn-1),this._tokens=this._tokens.slice(n)}}}_acceptInsertText(e,t,n){if(t===0&&n===0)return;let i=e.lineNumber-this._startLineNumber;if(i<0){this._startLineNumber+=t;return}if(!(i>=this._tokens.length)){if(t===0){this._tokens[i]=mi.insert(this._tokens[i],e.column-1,n);return}this._tokens[i]=mi.deleteEnding(this._tokens[i],e.column-1),this._tokens[i]=mi.insert(this._tokens[i],e.column-1,n),this._insertLines(e.lineNumber,t)}}_insertLines(e,t){if(t===0)return;let n=[];for(let i=0;i<t;i++)n[i]=null;this._tokens=sa(this._tokens,e,n)}};var FC=(i=>(i[i.Ignore=0]="Ignore",i[i.Info=1]="Info",i[i.Warning=2]="Warning",i[i.Error=3]="Error",i))(FC||{});(a=>{let o="error",e="warning",t="warn",n="info",i="ignore";function r(l){return l?tr(o,l)?3:tr(e,l)||tr(t,l)?2:tr(n,l)?1:0:0}a.fromValue=r;function s(l){switch(l){case 3:return o;case 2:return e;case 1:return n;default:return i}}a.toString=s})(FC||={});var gi=FC;var BC=class{value;_lower;constructor(e){this.value=e,this._lower=e.toLowerCase()}static equals(e,t){if(typeof e>"u"||e===null)return typeof t>"u"||t===null;if(typeof t>"u"||t===null)return!1;if(typeof e=="string"||typeof t=="string"){let n=typeof e=="string"?e:e.value,i=typeof t=="string"?t:t.value;return tr(n,i)}return e._lower===t._lower}static toKey(e){return typeof e=="string"?e.toLowerCase():e._lower}};var due=Y("IBuiltinExtensionsScannerService");var rb=(i=>(i[i.Hint=1]="Hint",i[i.Info=2]="Info",i[i.Warning=4]="Warning",i[i.Error=8]="Error",i))(rb||{});(r=>{function o(s,a){return a-s}r.compare=o;let e=Object.create(null);e[8]=m("sev.error","Error"),e[4]=m("sev.warning","Warning"),e[2]=m("sev.info","Info");function t(s){return e[s]||""}r.toString=t;function n(s){switch(s){case gi.Error:return 8;case gi.Warning:return 4;case gi.Info:return 2;case gi.Ignore:return 1}}r.fromSeverity=n;function i(s){switch(s){case 8:return gi.Error;case 4:return gi.Warning;case 2:return gi.Info;case 1:return gi.Ignore}}r.toSeverity=i})(rb||={});var h8;(n=>{let o="";function e(i){return t(i,!0)}n.makeKey=e;function t(i,r){let s=[o];return i.source?s.push(i.source.replace("\xA6","\\\xA6")):s.push(o),i.code?typeof i.code=="string"?s.push(i.code.replace("\xA6","\\\xA6")):s.push(i.code.value.replace("\xA6","\\\xA6")):s.push(o),i.severity!==void 0&&i.severity!==null?s.push(rb.toString(i.severity)):s.push(o),i.message&&r?s.push(i.message.replace("\xA6","\\\xA6")):s.push(o),i.startLineNumber!==void 0&&i.startLineNumber!==null?s.push(i.startLineNumber.toString()):s.push(o),i.startColumn!==void 0&&i.startColumn!==null?s.push(i.startColumn.toString()):s.push(o),i.endLineNumber!==void 0&&i.endLineNumber!==null?s.push(i.endLineNumber.toString()):s.push(o),i.endColumn!==void 0&&i.endColumn!==null?s.push(i.endColumn.toString()):s.push(o),s.push(o),s.join("\xA6")}n.makeKeyOptionalMessage=t})(h8||={});var _B=Y("markerService");var VC=class{constructor(e,t){this.tokens=e;this.endState=t}_encodedTokenizationResultBrand=void 0};var m8;(i=>{let o=new Map;o.set(0,te.symbolMethod),o.set(1,te.symbolFunction),o.set(2,te.symbolConstructor),o.set(3,te.symbolField),o.set(4,te.symbolVariable),o.set(5,te.symbolClass),o.set(6,te.symbolStruct),o.set(7,te.symbolInterface),o.set(8,te.symbolModule),o.set(9,te.symbolProperty),o.set(10,te.symbolEvent),o.set(11,te.symbolOperator),o.set(12,te.symbolUnit),o.set(13,te.symbolValue),o.set(15,te.symbolEnum),o.set(14,te.symbolConstant),o.set(15,te.symbolEnum),o.set(16,te.symbolEnumMember),o.set(17,te.symbolKeyword),o.set(27,te.symbolSnippet),o.set(18,te.symbolText),o.set(19,te.symbolColor),o.set(20,te.symbolFile),o.set(21,te.symbolReference),o.set(22,te.symbolCustomColor),o.set(23,te.symbolFolder),o.set(24,te.symbolTypeParameter),o.set(25,te.account),o.set(26,te.issues);function e(r){let s=o.get(r);return s||(console.info("No codicon found for CompletionItemKind "+r),s=te.symbolProperty),s}i.toIcon=e;let t=new Map;t.set("method",0),t.set("function",1),t.set("constructor",2),t.set("field",3),t.set("variable",4),t.set("class",5),t.set("struct",6),t.set("interface",7),t.set("module",8),t.set("property",9),t.set("event",10),t.set("operator",11),t.set("unit",12),t.set("value",13),t.set("constant",14),t.set("enum",15),t.set("enum-member",16),t.set("enumMember",16),t.set("keyword",17),t.set("snippet",27),t.set("text",18),t.set("color",19),t.set("file",20),t.set("reference",21),t.set("customcolor",22),t.set("folder",23),t.set("type-parameter",24),t.set("typeParameter",24),t.set("account",25),t.set("issue",26);function n(r,s){let a=t.get(r);return typeof a>"u"&&!s&&(a=9),a}i.fromString=n})(m8||={});var dpe={17:m("Array","array"),16:m("Boolean","boolean"),4:m("Class","class"),13:m("Constant","constant"),8:m("Constructor","constructor"),9:m("Enum","enumeration"),21:m("EnumMember","enumeration member"),23:m("Event","event"),7:m("Field","field"),0:m("File","file"),11:m("Function","function"),10:m("Interface","interface"),19:m("Key","key"),5:m("Method","method"),1:m("Module","module"),2:m("Namespace","namespace"),20:m("Null","null"),15:m("Number","number"),18:m("Object","object"),24:m("Operator","operator"),3:m("Package","package"),6:m("Property","property"),14:m("String","string"),22:m("Struct","struct"),25:m("TypeParameter","type parameter"),12:m("Variable","variable")};var c0;(t=>{let o=new Map;o.set(0,te.symbolFile),o.set(1,te.symbolModule),o.set(2,te.symbolNamespace),o.set(3,te.symbolPackage),o.set(4,te.symbolClass),o.set(5,te.symbolMethod),o.set(6,te.symbolProperty),o.set(7,te.symbolField),o.set(8,te.symbolConstructor),o.set(9,te.symbolEnum),o.set(10,te.symbolInterface),o.set(11,te.symbolFunction),o.set(12,te.symbolVariable),o.set(13,te.symbolConstant),o.set(14,te.symbolString),o.set(15,te.symbolNumber),o.set(16,te.symbolBoolean),o.set(17,te.symbolArray),o.set(18,te.symbolObject),o.set(19,te.symbolKey),o.set(20,te.symbolNull),o.set(21,te.symbolEnumMember),o.set(22,te.symbolStruct),o.set(23,te.symbolEvent),o.set(24,te.symbolOperator),o.set(25,te.symbolTypeParameter);function e(n){let i=o.get(n);return i||(console.info("No codicon found for SymbolKind "+n),i=te.symbolProperty),i}t.toIcon=e})(c0||={});var DB=class o{constructor(e){this.value=e}static Comment=new o("comment");static Imports=new o("imports");static Region=new o("region");static fromValue(e){switch(e){case"comment":return o.Comment;case"imports":return o.Imports;case"region":return o.Region}return new o(e)}};var g8;(e=>{function o(t){return!t||typeof t!="object"?!1:typeof t.id=="string"&&typeof t.title=="string"}e.is=o})(g8||={});var cr=new ib,sb=new ib;var ab=class{_keyCodeToStr;_strToKeyCode;constructor(){this._keyCodeToStr=[],this._strToKeyCode=Object.create(null)}define(e,t){this._keyCodeToStr[e]=t,this._strToKeyCode[t.toLowerCase()]=e}keyCodeToStr(e){return this._keyCodeToStr[e]}strToKeyCode(e){return this._strToKeyCode[e.toLowerCase()]||0}},WC=new ab,u0=new ab,p0=new ab,m0=new Array(230),f8={},b8=[],v8=Object.create(null),y8=Object.create(null);var LB=[],h0=[];for(let o=0;o<=193;o++)LB[o]=-1;for(let o=0;o<=132;o++)h0[o]=-1;(function(){let o="",e=[[1,0,"None",0,"unknown",0,"VK_UNKNOWN",o,o],[1,1,"Hyper",0,o,0,o,o,o],[1,2,"Super",0,o,0,o,o,o],[1,3,"Fn",0,o,0,o,o,o],[1,4,"FnLock",0,o,0,o,o,o],[1,5,"Suspend",0,o,0,o,o,o],[1,6,"Resume",0,o,0,o,o,o],[1,7,"Turbo",0,o,0,o,o,o],[1,8,"Sleep",0,o,0,"VK_SLEEP",o,o],[1,9,"WakeUp",0,o,0,o,o,o],[0,10,"KeyA",31,"A",65,"VK_A",o,o],[0,11,"KeyB",32,"B",66,"VK_B",o,o],[0,12,"KeyC",33,"C",67,"VK_C",o,o],[0,13,"KeyD",34,"D",68,"VK_D",o,o],[0,14,"KeyE",35,"E",69,"VK_E",o,o],[0,15,"KeyF",36,"F",70,"VK_F",o,o],[0,16,"KeyG",37,"G",71,"VK_G",o,o],[0,17,"KeyH",38,"H",72,"VK_H",o,o],[0,18,"KeyI",39,"I",73,"VK_I",o,o],[0,19,"KeyJ",40,"J",74,"VK_J",o,o],[0,20,"KeyK",41,"K",75,"VK_K",o,o],[0,21,"KeyL",42,"L",76,"VK_L",o,o],[0,22,"KeyM",43,"M",77,"VK_M",o,o],[0,23,"KeyN",44,"N",78,"VK_N",o,o],[0,24,"KeyO",45,"O",79,"VK_O",o,o],[0,25,"KeyP",46,"P",80,"VK_P",o,o],[0,26,"KeyQ",47,"Q",81,"VK_Q",o,o],[0,27,"KeyR",48,"R",82,"VK_R",o,o],[0,28,"KeyS",49,"S",83,"VK_S",o,o],[0,29,"KeyT",50,"T",84,"VK_T",o,o],[0,30,"KeyU",51,"U",85,"VK_U",o,o],[0,31,"KeyV",52,"V",86,"VK_V",o,o],[0,32,"KeyW",53,"W",87,"VK_W",o,o],[0,33,"KeyX",54,"X",88,"VK_X",o,o],[0,34,"KeyY",55,"Y",89,"VK_Y",o,o],[0,35,"KeyZ",56,"Z",90,"VK_Z",o,o],[0,36,"Digit1",22,"1",49,"VK_1",o,o],[0,37,"Digit2",23,"2",50,"VK_2",o,o],[0,38,"Digit3",24,"3",51,"VK_3",o,o],[0,39,"Digit4",25,"4",52,"VK_4",o,o],[0,40,"Digit5",26,"5",53,"VK_5",o,o],[0,41,"Digit6",27,"6",54,"VK_6",o,o],[0,42,"Digit7",28,"7",55,"VK_7",o,o],[0,43,"Digit8",29,"8",56,"VK_8",o,o],[0,44,"Digit9",30,"9",57,"VK_9",o,o],[0,45,"Digit0",21,"0",48,"VK_0",o,o],[1,46,"Enter",3,"Enter",13,"VK_RETURN",o,o],[1,47,"Escape",9,"Escape",27,"VK_ESCAPE",o,o],[1,48,"Backspace",1,"Backspace",8,"VK_BACK",o,o],[1,49,"Tab",2,"Tab",9,"VK_TAB",o,o],[1,50,"Space",10,"Space",32,"VK_SPACE",o,o],[0,51,"Minus",88,"-",189,"VK_OEM_MINUS","-","OEM_MINUS"],[0,52,"Equal",86,"=",187,"VK_OEM_PLUS","=","OEM_PLUS"],[0,53,"BracketLeft",92,"[",219,"VK_OEM_4","[","OEM_4"],[0,54,"BracketRight",94,"]",221,"VK_OEM_6","]","OEM_6"],[0,55,"Backslash",93,"\\",220,"VK_OEM_5","\\","OEM_5"],[0,56,"IntlHash",0,o,0,o,o,o],[0,57,"Semicolon",85,";",186,"VK_OEM_1",";","OEM_1"],[0,58,"Quote",95,"'",222,"VK_OEM_7","'","OEM_7"],[0,59,"Backquote",91,"`",192,"VK_OEM_3","`","OEM_3"],[0,60,"Comma",87,",",188,"VK_OEM_COMMA",",","OEM_COMMA"],[0,61,"Period",89,".",190,"VK_OEM_PERIOD",".","OEM_PERIOD"],[0,62,"Slash",90,"/",191,"VK_OEM_2","/","OEM_2"],[1,63,"CapsLock",8,"CapsLock",20,"VK_CAPITAL",o,o],[1,64,"F1",59,"F1",112,"VK_F1",o,o],[1,65,"F2",60,"F2",113,"VK_F2",o,o],[1,66,"F3",61,"F3",114,"VK_F3",o,o],[1,67,"F4",62,"F4",115,"VK_F4",o,o],[1,68,"F5",63,"F5",116,"VK_F5",o,o],[1,69,"F6",64,"F6",117,"VK_F6",o,o],[1,70,"F7",65,"F7",118,"VK_F7",o,o],[1,71,"F8",66,"F8",119,"VK_F8",o,o],[1,72,"F9",67,"F9",120,"VK_F9",o,o],[1,73,"F10",68,"F10",121,"VK_F10",o,o],[1,74,"F11",69,"F11",122,"VK_F11",o,o],[1,75,"F12",70,"F12",123,"VK_F12",o,o],[1,76,"PrintScreen",0,o,0,o,o,o],[1,77,"ScrollLock",84,"ScrollLock",145,"VK_SCROLL",o,o],[1,78,"Pause",7,"PauseBreak",19,"VK_PAUSE",o,o],[1,79,"Insert",19,"Insert",45,"VK_INSERT",o,o],[1,80,"Home",14,"Home",36,"VK_HOME",o,o],[1,81,"PageUp",11,"PageUp",33,"VK_PRIOR",o,o],[1,82,"Delete",20,"Delete",46,"VK_DELETE",o,o],[1,83,"End",13,"End",35,"VK_END",o,o],[1,84,"PageDown",12,"PageDown",34,"VK_NEXT",o,o],[1,85,"ArrowRight",17,"RightArrow",39,"VK_RIGHT","Right",o],[1,86,"ArrowLeft",15,"LeftArrow",37,"VK_LEFT","Left",o],[1,87,"ArrowDown",18,"DownArrow",40,"VK_DOWN","Down",o],[1,88,"ArrowUp",16,"UpArrow",38,"VK_UP","Up",o],[1,89,"NumLock",83,"NumLock",144,"VK_NUMLOCK",o,o],[1,90,"NumpadDivide",113,"NumPad_Divide",111,"VK_DIVIDE",o,o],[1,91,"NumpadMultiply",108,"NumPad_Multiply",106,"VK_MULTIPLY",o,o],[1,92,"NumpadSubtract",111,"NumPad_Subtract",109,"VK_SUBTRACT",o,o],[1,93,"NumpadAdd",109,"NumPad_Add",107,"VK_ADD",o,o],[1,94,"NumpadEnter",3,o,0,o,o,o],[1,95,"Numpad1",99,"NumPad1",97,"VK_NUMPAD1",o,o],[1,96,"Numpad2",100,"NumPad2",98,"VK_NUMPAD2",o,o],[1,97,"Numpad3",101,"NumPad3",99,"VK_NUMPAD3",o,o],[1,98,"Numpad4",102,"NumPad4",100,"VK_NUMPAD4",o,o],[1,99,"Numpad5",103,"NumPad5",101,"VK_NUMPAD5",o,o],[1,100,"Numpad6",104,"NumPad6",102,"VK_NUMPAD6",o,o],[1,101,"Numpad7",105,"NumPad7",103,"VK_NUMPAD7",o,o],[1,102,"Numpad8",106,"NumPad8",104,"VK_NUMPAD8",o,o],[1,103,"Numpad9",107,"NumPad9",105,"VK_NUMPAD9",o,o],[1,104,"Numpad0",98,"NumPad0",96,"VK_NUMPAD0",o,o],[1,105,"NumpadDecimal",112,"NumPad_Decimal",110,"VK_DECIMAL",o,o],[0,106,"IntlBackslash",97,"OEM_102",226,"VK_OEM_102",o,o],[1,107,"ContextMenu",58,"ContextMenu",93,o,o,o],[1,108,"Power",0,o,0,o,o,o],[1,109,"NumpadEqual",0,o,0,o,o,o],[1,110,"F13",71,"F13",124,"VK_F13",o,o],[1,111,"F14",72,"F14",125,"VK_F14",o,o],[1,112,"F15",73,"F15",126,"VK_F15",o,o],[1,113,"F16",74,"F16",127,"VK_F16",o,o],[1,114,"F17",75,"F17",128,"VK_F17",o,o],[1,115,"F18",76,"F18",129,"VK_F18",o,o],[1,116,"F19",77,"F19",130,"VK_F19",o,o],[1,117,"F20",78,"F20",131,"VK_F20",o,o],[1,118,"F21",79,"F21",132,"VK_F21",o,o],[1,119,"F22",80,"F22",133,"VK_F22",o,o],[1,120,"F23",81,"F23",134,"VK_F23",o,o],[1,121,"F24",82,"F24",135,"VK_F24",o,o],[1,122,"Open",0,o,0,o,o,o],[1,123,"Help",0,o,0,o,o,o],[1,124,"Select",0,o,0,o,o,o],[1,125,"Again",0,o,0,o,o,o],[1,126,"Undo",0,o,0,o,o,o],[1,127,"Cut",0,o,0,o,o,o],[1,128,"Copy",0,o,0,o,o,o],[1,129,"Paste",0,o,0,o,o,o],[1,130,"Find",0,o,0,o,o,o],[1,131,"AudioVolumeMute",117,"AudioVolumeMute",173,"VK_VOLUME_MUTE",o,o],[1,132,"AudioVolumeUp",118,"AudioVolumeUp",175,"VK_VOLUME_UP",o,o],[1,133,"AudioVolumeDown",119,"AudioVolumeDown",174,"VK_VOLUME_DOWN",o,o],[1,134,"NumpadComma",110,"NumPad_Separator",108,"VK_SEPARATOR",o,o],[0,135,"IntlRo",115,"ABNT_C1",193,"VK_ABNT_C1",o,o],[1,136,"KanaMode",0,o,0,o,o,o],[0,137,"IntlYen",0,o,0,o,o,o],[1,138,"Convert",0,o,0,o,o,o],[1,139,"NonConvert",0,o,0,o,o,o],[1,140,"Lang1",0,o,0,o,o,o],[1,141,"Lang2",0,o,0,o,o,o],[1,142,"Lang3",0,o,0,o,o,o],[1,143,"Lang4",0,o,0,o,o,o],[1,144,"Lang5",0,o,0,o,o,o],[1,145,"Abort",0,o,0,o,o,o],[1,146,"Props",0,o,0,o,o,o],[1,147,"NumpadParenLeft",0,o,0,o,o,o],[1,148,"NumpadParenRight",0,o,0,o,o,o],[1,149,"NumpadBackspace",0,o,0,o,o,o],[1,150,"NumpadMemoryStore",0,o,0,o,o,o],[1,151,"NumpadMemoryRecall",0,o,0,o,o,o],[1,152,"NumpadMemoryClear",0,o,0,o,o,o],[1,153,"NumpadMemoryAdd",0,o,0,o,o,o],[1,154,"NumpadMemorySubtract",0,o,0,o,o,o],[1,155,"NumpadClear",131,"Clear",12,"VK_CLEAR",o,o],[1,156,"NumpadClearEntry",0,o,0,o,o,o],[1,0,o,5,"Ctrl",17,"VK_CONTROL",o,o],[1,0,o,4,"Shift",16,"VK_SHIFT",o,o],[1,0,o,6,"Alt",18,"VK_MENU",o,o],[1,0,o,57,"Meta",91,"VK_COMMAND",o,o],[1,157,"ControlLeft",5,o,0,"VK_LCONTROL",o,o],[1,158,"ShiftLeft",4,o,0,"VK_LSHIFT",o,o],[1,159,"AltLeft",6,o,0,"VK_LMENU",o,o],[1,160,"MetaLeft",57,o,0,"VK_LWIN",o,o],[1,161,"ControlRight",5,o,0,"VK_RCONTROL",o,o],[1,162,"ShiftRight",4,o,0,"VK_RSHIFT",o,o],[1,163,"AltRight",6,o,0,"VK_RMENU",o,o],[1,164,"MetaRight",57,o,0,"VK_RWIN",o,o],[1,165,"BrightnessUp",0,o,0,o,o,o],[1,166,"BrightnessDown",0,o,0,o,o,o],[1,167,"MediaPlay",0,o,0,o,o,o],[1,168,"MediaRecord",0,o,0,o,o,o],[1,169,"MediaFastForward",0,o,0,o,o,o],[1,170,"MediaRewind",0,o,0,o,o,o],[1,171,"MediaTrackNext",124,"MediaTrackNext",176,"VK_MEDIA_NEXT_TRACK",o,o],[1,172,"MediaTrackPrevious",125,"MediaTrackPrevious",177,"VK_MEDIA_PREV_TRACK",o,o],[1,173,"MediaStop",126,"MediaStop",178,"VK_MEDIA_STOP",o,o],[1,174,"Eject",0,o,0,o,o,o],[1,175,"MediaPlayPause",127,"MediaPlayPause",179,"VK_MEDIA_PLAY_PAUSE",o,o],[1,176,"MediaSelect",128,"LaunchMediaPlayer",181,"VK_MEDIA_LAUNCH_MEDIA_SELECT",o,o],[1,177,"LaunchMail",129,"LaunchMail",180,"VK_MEDIA_LAUNCH_MAIL",o,o],[1,178,"LaunchApp2",130,"LaunchApp2",183,"VK_MEDIA_LAUNCH_APP2",o,o],[1,179,"LaunchApp1",0,o,0,"VK_MEDIA_LAUNCH_APP1",o,o],[1,180,"SelectTask",0,o,0,o,o,o],[1,181,"LaunchScreenSaver",0,o,0,o,o,o],[1,182,"BrowserSearch",120,"BrowserSearch",170,"VK_BROWSER_SEARCH",o,o],[1,183,"BrowserHome",121,"BrowserHome",172,"VK_BROWSER_HOME",o,o],[1,184,"BrowserBack",122,"BrowserBack",166,"VK_BROWSER_BACK",o,o],[1,185,"BrowserForward",123,"BrowserForward",167,"VK_BROWSER_FORWARD",o,o],[1,186,"BrowserStop",0,o,0,"VK_BROWSER_STOP",o,o],[1,187,"BrowserRefresh",0,o,0,"VK_BROWSER_REFRESH",o,o],[1,188,"BrowserFavorites",0,o,0,"VK_BROWSER_FAVORITES",o,o],[1,189,"ZoomToggle",0,o,0,o,o,o],[1,190,"MailReply",0,o,0,o,o,o],[1,191,"MailForward",0,o,0,o,o,o],[1,192,"MailSend",0,o,0,o,o,o],[1,0,o,114,"KeyInComposition",229,o,o,o],[1,0,o,116,"ABNT_C2",194,"VK_ABNT_C2",o,o],[1,0,o,96,"OEM_8",223,"VK_OEM_8",o,o],[1,0,o,0,o,0,"VK_KANA",o,o],[1,0,o,0,o,0,"VK_HANGUL",o,o],[1,0,o,0,o,0,"VK_JUNJA",o,o],[1,0,o,0,o,0,"VK_FINAL",o,o],[1,0,o,0,o,0,"VK_HANJA",o,o],[1,0,o,0,o,0,"VK_KANJI",o,o],[1,0,o,0,o,0,"VK_CONVERT",o,o],[1,0,o,0,o,0,"VK_NONCONVERT",o,o],[1,0,o,0,o,0,"VK_ACCEPT",o,o],[1,0,o,0,o,0,"VK_MODECHANGE",o,o],[1,0,o,0,o,0,"VK_SELECT",o,o],[1,0,o,0,o,0,"VK_PRINT",o,o],[1,0,o,0,o,0,"VK_EXECUTE",o,o],[1,0,o,0,o,0,"VK_SNAPSHOT",o,o],[1,0,o,0,o,0,"VK_HELP",o,o],[1,0,o,0,o,0,"VK_APPS",o,o],[1,0,o,0,o,0,"VK_PROCESSKEY",o,o],[1,0,o,0,o,0,"VK_PACKET",o,o],[1,0,o,0,o,0,"VK_DBE_SBCSCHAR",o,o],[1,0,o,0,o,0,"VK_DBE_DBCSCHAR",o,o],[1,0,o,0,o,0,"VK_ATTN",o,o],[1,0,o,0,o,0,"VK_CRSEL",o,o],[1,0,o,0,o,0,"VK_EXSEL",o,o],[1,0,o,0,o,0,"VK_EREOF",o,o],[1,0,o,0,o,0,"VK_PLAY",o,o],[1,0,o,0,o,0,"VK_ZOOM",o,o],[1,0,o,0,o,0,"VK_NONAME",o,o],[1,0,o,0,o,0,"VK_PA1",o,o],[1,0,o,0,o,0,"VK_OEM_CLEAR",o,o]],t=[],n=[];for(let i of e){let[r,s,a,l,d,c,u,p,h]=i;if(n[s]||(n[s]=!0,b8[s]=a,v8[a]=s,y8[a.toLowerCase()]=s,r&&(LB[s]=l,l!==0&&l!==3&&l!==5&&l!==4&&l!==6&&l!==57&&(h0[l]=s))),!t[l]){if(t[l]=!0,!d)throw new Error(`String representation missing for key code ${l} around scan code ${a}`);WC.define(l,d),u0.define(l,p||d),p0.define(l,h||p||d)}c&&(m0[c]=l),u&&(f8[u]=l)}h0[3]=46})();var lb;(s=>{function o(a){return WC.keyCodeToStr(a)}s.toString=o;function e(a){return WC.strToKeyCode(a)}s.fromString=e;function t(a){return u0.keyCodeToStr(a)}s.toUserSettingsUS=t;function n(a){return p0.keyCodeToStr(a)}s.toUserSettingsGeneral=n;function i(a){return u0.strToKeyCode(a)||p0.strToKeyCode(a)}s.fromUserSettings=i;function r(a){if(a>=98&&a<=113)return null;switch(a){case 16:return"Up";case 18:return"Down";case 15:return"Left";case 17:return"Right"}return WC.keyCodeToStr(a)}s.toElectronAccelerator=r})(lb||={});function g0(o,e){if(typeof o=="number"){if(o===0)return null;let t=(o&65535)>>>0,n=(o&4294901760)>>>16;return n!==0?new yh([HC(t,e),HC(n,e)]):new yh([HC(t,e)])}else{let t=[];for(let n=0;n<o.length;n++)t.push(HC(o[n],e));return new yh(t)}}function HC(o,e){let t=!!(o&2048),n=!!(o&256),i=e===2?n:t,r=!!(o&1024),s=!!(o&512),a=e===2?t:n,l=o&255;return new db(i,r,s,a,l)}var db=class o{constructor(e,t,n,i,r){this.ctrlKey=e;this.shiftKey=t;this.altKey=n;this.metaKey=i;this.keyCode=r}equals(e){return e instanceof o&&this.ctrlKey===e.ctrlKey&&this.shiftKey===e.shiftKey&&this.altKey===e.altKey&&this.metaKey===e.metaKey&&this.keyCode===e.keyCode}getHashCode(){let e=this.ctrlKey?"1":"0",t=this.shiftKey?"1":"0",n=this.altKey?"1":"0",i=this.metaKey?"1":"0";return`K${e}${t}${n}${i}${this.keyCode}`}isModifierKey(){return this.keyCode===0||this.keyCode===5||this.keyCode===57||this.keyCode===6||this.keyCode===4}toKeybinding(){return new yh([this])}isDuplicateModifierCase(){return this.ctrlKey&&this.keyCode===5||this.shiftKey&&this.keyCode===4||this.altKey&&this.keyCode===6||this.metaKey&&this.keyCode===57}};var yh=class{chords;constructor(e){if(e.length===0)throw Wc("chords");this.chords=e}getHashCode(){let e="";for(let t=0,n=this.chords.length;t<n;t++)t!==0&&(e+=";"),e+=this.chords[t].getHashCode();return e}equals(e){if(e===null||this.chords.length!==e.chords.length)return!1;for(let t=0;t<this.chords.length;t++)if(!this.chords[t].equals(e.chords[t]))return!1;return!0}};var f0=class o{_coreKeybindings;_extensionKeybindings;_cachedMergedKeybindings;constructor(){this._coreKeybindings=new zi,this._extensionKeybindings=[],this._cachedMergedKeybindings=null}static bindToCurrentPlatform(e){if(qr===1){if(e&&e.win)return e.win}else if(qr===2){if(e&&e.mac)return e.mac}else if(e&&e.linux)return e.linux;return e}registerKeybindingRule(e){let t=o.bindToCurrentPlatform(e),n=new ee;if(t&&t.primary){let i=g0(t.primary,qr);i&&n.add(this._registerDefaultKeybinding(i,e.id,e.args,e.weight,0,e.when))}if(t&&Array.isArray(t.secondary))for(let i=0,r=t.secondary.length;i<r;i++){let s=t.secondary[i],a=g0(s,qr);a&&n.add(this._registerDefaultKeybinding(a,e.id,e.args,e.weight,-i-1,e.when))}return n}setExtensionKeybindings(e){let t=[],n=0;for(let i of e)i.keybinding&&(t[n++]={keybinding:i.keybinding,command:i.id,commandArgs:i.args,when:i.when,weight1:i.weight,weight2:0,extensionId:i.extensionId||null,isBuiltinExtension:i.isBuiltinExtension||!1});this._extensionKeybindings=t,this._cachedMergedKeybindings=null}registerCommandAndKeybindingRule(e){return Ro(this.registerKeybindingRule(e),Xr.registerCommand(e))}_registerDefaultKeybinding(e,t,n,i,r,s){let a=this._coreKeybindings.push({keybinding:e,command:t,commandArgs:n,when:s,weight1:i,weight2:r,extensionId:null,isBuiltinExtension:!1});return this._cachedMergedKeybindings=null,le(()=>{a(),this._cachedMergedKeybindings=null})}getDefaultKeybindings(){return this._cachedMergedKeybindings||(this._cachedMergedKeybindings=Array.from(this._coreKeybindings).concat(this._extensionKeybindings),this._cachedMergedKeybindings.sort(C8)),this._cachedMergedKeybindings.slice(0)}},Hd=new f0,I8={EditorModes:"platform.keybindingsRegistry"};et.add(I8.EditorModes,Hd);function C8(o,e){if(o.weight1!==e.weight1)return o.weight1-e.weight1;if(o.command&&e.command){if(o.command<e.command)return-1;if(o.command>e.command)return 1}return o.weight2-e.weight2}var UC=gi,fu=Y("notificationService");var b0=Y("progressService");var $pe=Object.freeze({total(){},worked(){},done(){}}),RB=class{constructor(e){this.callback=e}static None=Object.freeze({report(){}});_value;get value(){return this._value}report(e){this._value=e,this.callback(this._value)}};var zC=class extends F{deferred=new Ed;reporter;lastStep;constructor(e,t){super(),t.withProgress(e,n=>(this.reporter=n,this.lastStep&&n.report(this.lastStep),this.deferred.p)),this._register(le(()=>this.deferred.complete()))}report(e){this.reporter?this.reporter.report(e):this.lastStep=e}};zC=O([x(1,b0)],zC);var kB=Y("editorProgressService");var Vhe=m("views log","Views"),Whe=or("default-view-icon",te.window,m("defaultViewIcon","Default view icon.")),I0;(t=>(t.ViewContainersRegistry="workbench.registry.view.containers",t.ViewsRegistry="workbench.registry.view"))(I0||={});var v0=class extends F{_onDidRegister=this._register(new D);onDidRegister=this._onDidRegister.event;_onDidDeregister=this._register(new D);onDidDeregister=this._onDidDeregister.event;viewContainers=new Map;defaultViewContainers=[];get all(){return[...this.viewContainers.values()].flat()}registerViewContainer(e,t,n){let i=this.get(e.id);if(i)return i;let r=e;return r.openCommandActionDescriptor=n?.doNotRegisterOpenCommand?void 0:r.openCommandActionDescriptor??{id:r.id},tf(this.viewContainers,t,[]).push(r),n?.isDefault&&this.defaultViewContainers.push(r),this._onDidRegister.fire({viewContainer:r,viewContainerLocation:t}),r}deregisterViewContainer(e){for(let t of this.viewContainers.keys()){let n=this.viewContainers.get(t),i=n?.indexOf(e);if(i!==-1){n?.splice(i,1),n.length===0&&this.viewContainers.delete(t),this._onDidDeregister.fire({viewContainer:e,viewContainerLocation:t});return}}}get(e){return this.all.filter(t=>t.id===e)[0]}getViewContainers(e){return[...this.viewContainers.get(e)||[]]}getViewContainerLocation(e){return[...this.viewContainers.keys()].filter(t=>this.getViewContainers(t).filter(n=>n?.id===e.id).length>0)[0]}getDefaultViewContainer(e){return this.defaultViewContainers.find(t=>this.getViewContainerLocation(t)===e)}};et.add(I0.ViewContainersRegistry,new v0);function S8(o,e){let t=o.group??"9_more",n=e.group??"9_more";return t!==n?t.localeCompare(n):(o.order??5)-(e.order??5)}var y0=class extends F{_onViewsRegistered=this._register(new D);onViewsRegistered=this._onViewsRegistered.event;_onViewsDeregistered=this._register(new D);onViewsDeregistered=this._onViewsDeregistered.event;_onDidChangeContainer=this._register(new D);onDidChangeContainer=this._onDidChangeContainer.event;_onDidChangeViewWelcomeContent=this._register(new D);onDidChangeViewWelcomeContent=this._onDidChangeViewWelcomeContent.event;_viewContainers=[];_views=new Map;_viewWelcomeContents=new pl;registerViews(e,t){this.registerViews2([{views:e,viewContainer:t}])}registerViews2(e){e.forEach(({views:t,viewContainer:n})=>this.addViews(t,n)),this._onViewsRegistered.fire(e)}deregisterViews(e,t){let n=this.removeViews(e,t);n.length&&this._onViewsDeregistered.fire({views:n,viewContainer:t})}moveViews(e,t){for(let n of this._views.keys())if(n!==t){let i=this.removeViews(e,n);i.length&&(this.addViews(i,t),this._onDidChangeContainer.fire({views:i,from:n,to:t}))}}getViews(e){return this._views.get(e)||[]}getView(e){for(let t of this._viewContainers){let n=(this._views.get(t)||[]).filter(i=>i.id===e)[0];if(n)return n}return null}getViewContainer(e){for(let t of this._viewContainers)if((this._views.get(t)||[]).filter(i=>i.id===e)[0])return t;return null}registerViewWelcomeContent(e,t){return this._viewWelcomeContents.add(e,t),this._onDidChangeViewWelcomeContent.fire(e),le(()=>{this._viewWelcomeContents.delete(e,t),this._onDidChangeViewWelcomeContent.fire(e)})}registerViewWelcomeContent2(e,t){let n=new Map;for(let[i,r]of t)this._viewWelcomeContents.add(e,r),n.set(i,le(()=>{this._viewWelcomeContents.delete(e,r),this._onDidChangeViewWelcomeContent.fire(e)}));return this._onDidChangeViewWelcomeContent.fire(e),n}getViewWelcomeContent(e){let t=[];return this._viewWelcomeContents.forEach(e,n=>t.push(n)),t.sort(S8)}addViews(e,t){let n=this._views.get(t);n||(n=[],this._views.set(t,n),this._viewContainers.push(t));for(let i of e){if(this.getView(i.id)!==null)throw new Error(m("duplicateId","A view with id '{0}' is already registered",i.id));n.push(i)}}removeViews(e,t){let n=this._views.get(t);if(!n)return[];let i=[],r=[];for(let s of n)e.includes(s)?i.push(s):r.push(s);return i.length&&(r.length?this._views.set(t,r):(this._views.delete(t),this._viewContainers.splice(this._viewContainers.indexOf(t),1))),i}};et.add(I0.ViewsRegistry,new y0);var Hhe=Y("viewDescriptorService");var Ch=Y("productService");var Or=Y("IUserDataProfileService"),cb=Y("IUserDataProfileManagementService");var E8="profile";var T8="profile-";function MB(o){return o.authority===E8||new RegExp(`^${T8}`).test(o.authority)}var C0=Y("IUserDataProfileImportExportService"),Cme=or("defaultProfile-icon",te.settings,m("defaultProfileIcon","Icon for Default Profile.")),x8=Zo("profiles","Profiles"),Sme={...x8},w8="code-profile",Eme=[{name:m("profile","Profile"),extensions:[w8]}],Tme=new $("profiles.enabled",!0),xme=new $("currentProfile",""),wme=new $("isCurrentProfileTransient",!1),_me=new $("hasProfiles",!1);var xa=class extends F{_onWillDispose=this._register(new D);onWillDispose=this._onWillDispose.event;resolved=!1;async resolve(){this.resolved=!0}isResolved(){return this.resolved}isDisposed(){return this._store.isDisposed}dispose(){this._onWillDispose.fire(),super.dispose()}};var OB="^([a-z0-9A-Z][a-z0-9-A-Z]*)\\.([a-z0-9A-Z][a-z0-9-A-Z]*)$",ege=new RegExp(OB);var S0="skipWalkthrough";var E0=Y("extensionGalleryService");var ub=Y("extensionManagementService"),T0="extensionsIdentifiers/disabled";var NB=Y("IGlobalExtensionEnablementService"),tge=Y("IExtensionTipsService"),nge=Zo("extensions","Extensions"),ige=Zo("preferences","Preferences");var x0=class{telemetryLevel=0;sessionId="someValue.sessionId";machineId="someValue.machineId";sqmId="someValue.sqmId";devDeviceId="someValue.devDeviceId";firstSessionDate="someValue.firstSessionDate";sendErrorTelemetry=!1;publicLog(){}publicLog2(){}publicLogError(){}publicLogError2(){}setExperimentProperty(){}},Age=new x0;function Vo(o,e){return o.uuid&&e.uuid?o.uuid===e.uuid:o.id===e.id?!0:dL(o.id,e.id)===0}var ife=new BC("pprice.better-merge");var pb={exports:{}};(function(){function e(r){let s=[];typeof r=="number"&&s.push("code/timeOrigin",r);function a(d){s.push(d,Date.now())}function l(){let d=[];for(let c=0;c<s.length;c+=2)d.push({name:s[c],startTime:s[c+1]});return d}return{mark:a,getMarks:l}}function t(){if(typeof performance=="object"&&typeof performance.mark=="function"&&!performance.nodeTiming)return typeof performance.timeOrigin!="number"&&!performance.timing?e():{mark(r){performance.mark(r)},getMarks(){let r=performance.timeOrigin;typeof r!="number"&&(r=performance.timing.navigationStart||performance.timing.redirectStart||performance.timing.fetchStart);let s=[{name:"code/timeOrigin",startTime:Math.round(r)}];for(let a of performance.getEntriesByType("mark"))s.push({name:a.name,startTime:Math.round(r+a.startTime)});return s}};if(typeof process=="object"){let r=performance?.timeOrigin;return e(r)}else return console.trace("perf-util loaded in UNKNOWN environment"),e()}function n(r){return r.MonacoPerformanceMarks||(r.MonacoPerformanceMarks=t()),r.MonacoPerformanceMarks}var i;typeof global=="object"?i=global:typeof self=="object"?i=self:i={},typeof pb=="object"&&typeof pb.exports=="object"?pb.exports=n(i):(console.trace("perf-util defined in UNKNOWN context (neither requirejs or commonjs)"),i.perf=n(i))})();var ti=pb.exports.mark,rfe=pb.exports.getMarks;function AB(o){return JSON.stringify(o,L8)}function KC(o){let e=JSON.parse(o);return e=Sh(e),e}function L8(o,e){return e instanceof RegExp?{$mid:2,source:e.source,flags:e.flags}:e}function Sh(o,e=0){if(!o||e>200)return o;if(typeof o=="object"){switch(o.$mid){case 1:return J.revive(o);case 2:return new RegExp(o.source,o.flags);case 17:return new Date(o.source)}if(o instanceof vt||o instanceof Uint8Array)return o;if(Array.isArray(o))for(let t=0;t<o.length;++t)o[t]=Sh(o[t],e+1);else for(let t in o)Object.hasOwnProperty.call(o,t)&&(o[t]=Sh(o[t],e+1))}return o}var hb=class o extends F{constructor(t,n=Object.create(null)){super();this.database=t;this.options=n;this.registerListeners()}static DEFAULT_FLUSH_DELAY=100;_onDidChangeStorage=this._register(new hd);onDidChangeStorage=this._onDidChangeStorage.event;state=0;cache=new Map;flushDelayer=this._register(new Zp(o.DEFAULT_FLUSH_DELAY));pendingDeletes=new Set;pendingInserts=new Map;pendingClose=void 0;whenFlushedCallbacks=[];registerListeners(){this._register(this.database.onDidChangeItemsExternal(t=>this.onDidChangeItemsExternal(t)))}onDidChangeItemsExternal(t){this._onDidChangeStorage.pause();try{t.changed?.forEach((n,i)=>this.acceptExternal(i,n)),t.deleted?.forEach(n=>this.acceptExternal(n,void 0))}finally{this._onDidChangeStorage.resume()}}acceptExternal(t,n){if(this.state===2)return;let i=!1;gn(n)?i=this.cache.delete(t):this.cache.get(t)!==n&&(this.cache.set(t,n),i=!0),i&&this._onDidChangeStorage.fire({key:t,external:!0})}get items(){return this.cache}get size(){return this.cache.size}async init(){this.state===0&&(this.state=1,this.options.hint!==0&&(this.cache=await this.database.getItems()))}get(t,n){let i=this.cache.get(t);return gn(i)?n:i}getBoolean(t,n){let i=this.get(t);return gn(i)?n:i==="true"}getNumber(t,n){let i=this.get(t);return gn(i)?n:parseInt(i,10)}getObject(t,n){let i=this.get(t);return gn(i)?n:KC(i)}async set(t,n,i=!1){if(this.state===2)return;if(gn(n))return this.delete(t,i);let r=an(n)||Array.isArray(n)?AB(n):String(n);if(this.cache.get(t)!==r)return this.cache.set(t,r),this.pendingInserts.set(t,r),this.pendingDeletes.delete(t),this._onDidChangeStorage.fire({key:t,external:i}),this.doFlush()}async delete(t,n=!1){if(!(this.state===2||!this.cache.delete(t)))return this.pendingDeletes.has(t)||this.pendingDeletes.add(t),this.pendingInserts.delete(t),this._onDidChangeStorage.fire({key:t,external:n}),this.doFlush()}async optimize(){if(this.state!==2)return await this.flush(0),this.database.optimize()}async close(){return this.pendingClose||(this.pendingClose=this.doClose()),this.pendingClose}async doClose(){this.state=2;try{await this.doFlush(0)}catch{}await this.database.close(()=>this.cache)}get hasPending(){return this.pendingInserts.size>0||this.pendingDeletes.size>0}async flushPending(){if(!this.hasPending)return;let t={insert:this.pendingInserts,delete:this.pendingDeletes};return this.pendingDeletes=new Set,this.pendingInserts=new Map,this.database.updateItems(t).finally(()=>{if(!this.hasPending)for(;this.whenFlushedCallbacks.length;)this.whenFlushedCallbacks.pop()?.()})}async flush(t){if(!(this.state===2||this.pendingClose))return this.doFlush(t)}async doFlush(t){return this.options.hint===1?this.flushPending():this.flushDelayer.trigger(()=>this.flushPending(),t)}async whenFlushed(){if(this.hasPending)return new Promise(t=>this.whenFlushedCallbacks.push(t))}isInMemory(){return this.options.hint===1}};var R8="__$__isNewStorageMarker",GC="__$__targetStorageMarker",Ln=Y("storageService");function k8(o){let e=o.get(GC);if(e)try{return JSON.parse(e)}catch{}return Object.create(null)}var jC=class o extends F{constructor(t={flushInterval:o.DEFAULT_FLUSH_INTERVAL}){super();this.options=t}static DEFAULT_FLUSH_INTERVAL=60*1e3;_onDidChangeValue=this._register(new hd);_onDidChangeTarget=this._register(new hd);onDidChangeTarget=this._onDidChangeTarget.event;_onWillSaveState=this._register(new D);onWillSaveState=this._onWillSaveState.event;initializationPromise;flushWhenIdleScheduler=this._register(new nn(()=>this.doFlushWhenIdle(),this.options.flushInterval));runFlushWhenIdle=this._register(new un);onDidChangeValue(t,n,i){return q.filter(this._onDidChangeValue.event,r=>r.scope===t&&(n===void 0||r.key===n),i)}doFlushWhenIdle(){this.runFlushWhenIdle.value=Td(()=>{this.shouldFlushWhenIdle()&&this.flush(),this.flushWhenIdleScheduler.schedule()})}shouldFlushWhenIdle(){return!0}stopFlushWhenIdle(){wt([this.runFlushWhenIdle,this.flushWhenIdleScheduler])}initialize(){return this.initializationPromise||(this.initializationPromise=(async()=>{ti("code/willInitStorage");try{await this.doInitialize()}finally{ti("code/didInitStorage")}this.flushWhenIdleScheduler.schedule()})()),this.initializationPromise}emitDidChangeValue(t,n){let{key:i,external:r}=n;if(i===GC){switch(t){case-1:this._applicationKeyTargets=void 0;break;case 0:this._profileKeyTargets=void 0;break;case 1:this._workspaceKeyTargets=void 0;break}this._onDidChangeTarget.fire({scope:t})}else this._onDidChangeValue.fire({scope:t,key:i,target:this.getKeyTargets(t)[i],external:r})}emitWillSaveState(t){this._onWillSaveState.fire({reason:t})}get(t,n,i){return this.getStorage(n)?.get(t,i)}getBoolean(t,n,i){return this.getStorage(n)?.getBoolean(t,i)}getNumber(t,n,i){return this.getStorage(n)?.getNumber(t,i)}getObject(t,n,i){return this.getStorage(n)?.getObject(t,i)}storeAll(t,n){this.withPausedEmitters(()=>{for(let i of t)this.store(i.key,i.value,i.scope,i.target,n)})}store(t,n,i,r,s=!1){if(gn(n)){this.remove(t,i,s);return}this.withPausedEmitters(()=>{this.updateKeyTarget(t,i,r),this.getStorage(i)?.set(t,n,s)})}remove(t,n,i=!1){this.withPausedEmitters(()=>{this.updateKeyTarget(t,n,void 0),this.getStorage(n)?.delete(t,i)})}withPausedEmitters(t){this._onDidChangeValue.pause(),this._onDidChangeTarget.pause();try{t()}finally{this._onDidChangeValue.resume(),this._onDidChangeTarget.resume()}}keys(t,n){let i=[],r=this.getKeyTargets(t);for(let s of Object.keys(r))r[s]===n&&i.push(s);return i}updateKeyTarget(t,n,i,r=!1){let s=this.getKeyTargets(n);typeof i=="number"?s[t]!==i&&(s[t]=i,this.getStorage(n)?.set(GC,JSON.stringify(s),r)):typeof s[t]=="number"&&(delete s[t],this.getStorage(n)?.set(GC,JSON.stringify(s),r))}_workspaceKeyTargets=void 0;get workspaceKeyTargets(){return this._workspaceKeyTargets||(this._workspaceKeyTargets=this.loadKeyTargets(1)),this._workspaceKeyTargets}_profileKeyTargets=void 0;get profileKeyTargets(){return this._profileKeyTargets||(this._profileKeyTargets=this.loadKeyTargets(0)),this._profileKeyTargets}_applicationKeyTargets=void 0;get applicationKeyTargets(){return this._applicationKeyTargets||(this._applicationKeyTargets=this.loadKeyTargets(-1)),this._applicationKeyTargets}getKeyTargets(t){switch(t){case-1:return this.applicationKeyTargets;case 0:return this.profileKeyTargets;default:return this.workspaceKeyTargets}}loadKeyTargets(t){let n=this.getStorage(t);return n?k8(n):Object.create(null)}isNew(t){return this.getBoolean(R8,t)===!0}async flush(t=0){this._onWillSaveState.fire({reason:t});let n=this.getStorage(-1),i=this.getStorage(0),r=this.getStorage(1);switch(t){case 0:await Po.settled([n?.whenFlushed()??Promise.resolve(),i?.whenFlushed()??Promise.resolve(),r?.whenFlushed()??Promise.resolve()]);break;case 1:await Po.settled([n?.flush(0)??Promise.resolve(),i?.flush(0)??Promise.resolve(),r?.flush(0)??Promise.resolve()]);break}}async log(){let t=this.getStorage(-1)?.items??new Map,n=this.getStorage(0)?.items??new Map,i=this.getStorage(1)?.items??new Map;return M8(t,n,i,this.getLogDetails(-1)??"",this.getLogDetails(0)??"",this.getLogDetails(1)??"")}async optimize(t){return await this.flush(),this.getStorage(t)?.optimize()}async switch(t,n){return this.emitWillSaveState(0),ba(t)?this.switchToProfile(t,n):this.switchToWorkspace(t,n)}canSwitchProfile(t,n){return!(t.id===n.id||w0(n)&&w0(t))}switchData(t,n,i){this.withPausedEmitters(()=>{let r=new Set;for(let[s,a]of t)r.add(s),n.get(s)!==a&&this.emitDidChangeValue(i,{key:s,external:!0});for(let[s]of n.items)r.has(s)||this.emitDidChangeValue(i,{key:s,external:!0})})}};function w0(o){return o.isDefault||!!o.useDefaultFlags?.globalState}async function M8(o,e,t,n,i,r){let s=g=>{try{return JSON.parse(g)}catch{return g}},a=new Map,l=new Map;o.forEach((g,b)=>{a.set(b,g),l.set(b,s(g))});let d=new Map,c=new Map;e.forEach((g,b)=>{d.set(b,g),c.set(b,s(g))});let u=new Map,p=new Map;t.forEach((g,b)=>{u.set(b,g),p.set(b,s(g))}),console.group(n!==i?`Storage: Application (path: ${n})`:`Storage: Application & Profile (path: ${n}, default profile)`);let h=[];if(a.forEach((g,b)=>{h.push({key:b,value:g})}),console.table(h),console.groupEnd(),console.log(l),n!==i){console.group(`Storage: Profile (path: ${i}, profile specific)`);let g=[];d.forEach((b,v)=>{g.push({key:v,value:b})}),console.table(g),console.groupEnd(),console.log(c)}console.group(`Storage: Workspace (path: ${r})`);let f=[];u.forEach((g,b)=>{f.push({key:b,value:g})}),console.table(f),console.groupEnd(),console.log(p)}var Eh=class extends F{_onDidChangeEnablement=new D;onDidChangeEnablement=this._onDidChangeEnablement.event;storageManager;constructor(e,t){super(),this.storageManager=this._register(new _0(e)),this._register(this.storageManager.onDidChange(n=>this._onDidChangeEnablement.fire({extensions:n,source:"storage"}))),this._register(t.onDidInstallExtensions(n=>n.forEach(({local:i,operation:r})=>{i&&r===4&&this._removeFromDisabledExtensions(i.identifier)})))}async enableExtension(e,t){return this._removeFromDisabledExtensions(e)?(this._onDidChangeEnablement.fire({extensions:[e],source:t}),!0):!1}async disableExtension(e,t){return this._addToDisabledExtensions(e)?(this._onDidChangeEnablement.fire({extensions:[e],source:t}),!0):!1}getDisabledExtensions(){return this._getExtensions(T0)}async getDisabledExtensionsAsync(){return this.getDisabledExtensions()}_addToDisabledExtensions(e){let t=this.getDisabledExtensions();return t.every(n=>!Vo(n,e))?(t.push(e),this._setDisabledExtensions(t),!0):!1}_removeFromDisabledExtensions(e){let t=this.getDisabledExtensions();for(let n=0;n<t.length;n++){let i=t[n];if(Vo(i,e))return t.splice(n,1),this._setDisabledExtensions(t),!0}return!1}_setDisabledExtensions(e){this._setExtensions(T0,e)}_getExtensions(e){return this.storageManager.get(e,0)}_setExtensions(e,t){this.storageManager.set(e,t,0)}};Eh=O([x(0,Ln),x(1,ub)],Eh);var _0=class extends F{constructor(t){super();this.storageService=t;this._register(t.onDidChangeValue(0,void 0,this._register(new ee))(n=>this.onDidStorageChange(n)))}storage=Object.create(null);_onDidChange=this._register(new D);onDidChange=this._onDidChange.event;get(t,n){let i;return n===0?(gn(this.storage[t])&&(this.storage[t]=this._get(t,n)),i=this.storage[t]):i=this._get(t,n),JSON.parse(i)}set(t,n,i){let r=JSON.stringify(n.map(({id:a,uuid:l})=>({id:a,uuid:l})));this._get(t,i)!==r&&(i===0&&(n.length?this.storage[t]=r:delete this.storage[t]),this._set(t,n.length?r:void 0,i))}onDidStorageChange(t){if(!gn(this.storage[t.key])&&this._get(t.key,t.scope)!==this.storage[t.key]){let i=this.get(t.key,t.scope);delete this.storage[t.key];let r=this.get(t.key,t.scope),s=i.filter(l=>!r.some(d=>Vo(l,d))),a=r.filter(l=>!i.some(d=>Vo(d,l)));(s.length||a.length)&&this._onDidChange.fire([...s,...a])}}_get(t,n){return this.storageService.get(t,n,"[]")}_set(t,n,i){n?this.storageService.store(t,n,i,1):this.storageService.remove(t,i)}};function he(o,e,t){let n=null,i=null;if(typeof t.value=="function"?(n="value",i=t.value,i.length!==0&&console.warn("Memoize should only be used in functions with zero parameters")):typeof t.get=="function"&&(n="get",i=t.get),!i)throw new Error("not supported");let r=`$memoize$${e}`;t[n]=function(...s){return this.hasOwnProperty(r)||Object.defineProperty(this,r,{configurable:!1,enumerable:!1,writable:!1,value:i.apply(this,s)}),this[r]}}function FB(o){switch(o){case 100:return"req";case 101:return"cancel";case 102:return"subscribe";case 103:return"unsubscribe"}}function BB(o){switch(o){case 200:return"init";case 201:return"reply:";case 202:case 203:return"replyErr:";case 204:return"event:"}}function Th(o){let e=0;for(let t=0;;t+=7){let n=o.read(1);if(e|=(n.buffer[0]&127)<<t,!(n.buffer[0]&128))return e}}var P8=zd(0);function xh(o,e){if(e===0){o.write(P8);return}let t=0;for(let i=e;i!==0;i=i>>>7)t++;let n=vt.alloc(t);for(let i=0;e!==0;i++)n.buffer[i]=e&127,e=e>>>7,e>0&&(n.buffer[i]|=128);o.write(n)}var L0=class{constructor(e){this.buffer=e}pos=0;read(e){let t=this.buffer.slice(this.pos,this.pos+e);return this.pos+=t.byteLength,t}},R0=class{buffers=[];get buffer(){return vt.concat(this.buffers)}write(e){this.buffers.push(e)}};function zd(o){let e=vt.alloc(1);return e.writeUInt8(o,0),e}var vu={Undefined:zd(0),String:zd(1),Buffer:zd(2),VSBuffer:zd(3),Array:zd(4),Object:zd(5),Uint:zd(6)},O8=typeof Buffer<"u";function k0(o,e){if(typeof e>"u")o.write(vu.Undefined);else if(typeof e=="string"){let t=vt.fromString(e);o.write(vu.String),xh(o,t.byteLength),o.write(t)}else if(O8&&Buffer.isBuffer(e)){let t=vt.wrap(e);o.write(vu.Buffer),xh(o,t.byteLength),o.write(t)}else if(e instanceof vt)o.write(vu.VSBuffer),xh(o,e.byteLength),o.write(e);else if(Array.isArray(e)){o.write(vu.Array),xh(o,e.length);for(let t of e)k0(o,t)}else if(typeof e=="number"&&(e|0)===e)o.write(vu.Uint),xh(o,e);else{let t=vt.fromString(JSON.stringify(e));o.write(vu.Object),xh(o,t.byteLength),o.write(t)}}function M0(o){switch(o.read(1).readUInt8(0)){case 0:return;case 1:return o.read(Th(o)).toString();case 2:return o.read(Th(o)).buffer;case 3:return o.read(Th(o));case 4:{let t=Th(o),n=[];for(let i=0;i<t;i++)n.push(M0(o));return n}case 5:return JSON.parse(o.read(Th(o)).toString());case 6:return Th(o)}}var D0=class{constructor(e,t=null){this.protocol=e;this.protocolListener=this.protocol.onMessage(n=>this.onBuffer(n)),this.logger=t}isDisposed=!1;state=0;activeRequests=new Set;handlers=new Map;lastRequestId=0;protocolListener;logger;_onDidInitialize=new D;onDidInitialize=this._onDidInitialize.event;getChannel(e){let t=this;return{call(n,i,r){return t.isDisposed?Promise.reject(new Vi):t.requestPromise(e,n,i,r)},listen(n,i){return t.isDisposed?q.None:t.requestEvent(e,n,i)}}}requestPromise(e,t,n,i=sn.None){let r=this.lastRequestId++,a={id:r,type:100,channelName:e,name:t,arg:n};if(i.isCancellationRequested)return Promise.reject(new Vi);let l;return new Promise((c,u)=>{if(i.isCancellationRequested)return u(new Vi);let p=()=>{let b=v=>{switch(v.type){case 201:this.handlers.delete(r),c(v.data);break;case 202:{this.handlers.delete(r);let y=new Error(v.data.message);y.stack=Array.isArray(v.data.stack)?v.data.stack.join(`
`):v.data.stack,y.name=v.data.name,u(y);break}case 203:this.handlers.delete(r),u(v.data);break}};this.handlers.set(r,b),this.sendRequest(a)},h=null;this.state===1?p():(h=Sl(b=>this.whenInitialized()),h.then(()=>{h=null,p()}));let f=()=>{h?(h.cancel(),h=null):this.sendRequest({id:r,type:101}),u(new Vi)},g=i.onCancellationRequested(f);l=Ro(le(f),g),this.activeRequests.add(l)}).finally(()=>{l.dispose(),this.activeRequests.delete(l)})}requestEvent(e,t,n){let i=this.lastRequestId++,s={id:i,type:102,channelName:e,name:t,arg:n},a=null,l=new D({onWillAddFirstListener:()=>{a=Sl(c=>this.whenInitialized()),a.then(()=>{a=null,this.activeRequests.add(l),this.sendRequest(s)})},onDidRemoveLastListener:()=>{a?(a.cancel(),a=null):(this.activeRequests.delete(l),this.sendRequest({id:i,type:103}))}}),d=c=>l.fire(c.data);return this.handlers.set(i,d),l.event}sendRequest(e){switch(e.type){case 100:case 102:{let t=this.send([e.type,e.id,e.channelName,e.name],e.arg);this.logger?.logOutgoing(t,e.id,0,`${FB(e.type)}: ${e.channelName}.${e.name}`,e.arg);return}case 101:case 103:{let t=this.send([e.type,e.id]);this.logger?.logOutgoing(t,e.id,0,FB(e.type));return}}}send(e,t=void 0){let n=new R0;return k0(n,e),k0(n,t),this.sendBuffer(n.buffer)}sendBuffer(e){try{return this.protocol.send(e),e.byteLength}catch{return 0}}onBuffer(e){let t=new L0(e),n=M0(t),i=M0(t),r=n[0];switch(r){case 200:return this.logger?.logIncoming(e.byteLength,0,0,BB(r)),this.onResponse({type:n[0]});case 201:case 202:case 204:case 203:return this.logger?.logIncoming(e.byteLength,n[1],0,BB(r),i),this.onResponse({type:n[0],id:n[1],data:i})}}onResponse(e){if(e.type===200){this.state=1,this._onDidInitialize.fire();return}this.handlers.get(e.id)?.(e)}get onDidInitializePromise(){return q.toPromise(this.onDidInitialize)}whenInitialized(){return this.state===1?Promise.resolve():this.onDidInitializePromise}dispose(){this.isDisposed=!0,this.protocolListener&&(this.protocolListener.dispose(),this.protocolListener=null),wt(this.activeRequests.values()),this.activeRequests.clear()}};O([he],D0.prototype,"onDidInitializePromise",1);var N8;(i=>{function o(r,s,a){let l=r,d=a&&a.disableMarshalling,c=new Map;for(let u in l)t(u)&&c.set(u,q.buffer(l[u],!0,void 0,s));return new class{listen(u,p,h){let f=c.get(p);if(f)return f;let g=l[p];if(typeof g=="function"){if(n(p))return g.call(l,h);if(t(p))return c.set(p,q.buffer(l[p],!0,void 0,s)),c.get(p)}throw new ll(`Event not found: ${p}`)}call(u,p,h){let f=l[p];if(typeof f=="function"){if(!d&&Array.isArray(h))for(let b=0;b<h.length;b++)h[b]=Sh(h[b]);let g=f.apply(l,h);return g instanceof Promise||(g=Promise.resolve(g)),g}throw new ll(`Method not found: ${p}`)}}}i.fromService=o;function e(r,s){let a=s&&s.disableMarshalling;return new Proxy({},{get(l,d){if(typeof d=="string")return s?.properties?.has(d)?s.properties.get(d):n(d)?function(c){return r.listen(d,c)}:t(d)?r.listen(d):async function(...c){let u;s&&!gn(s.context)?u=[s.context,...c]:u=c;let p=await r.call(d,u);return a?p:Sh(p)};throw new ll(`Property not found: ${String(d)}`)}})}i.toService=e;function t(r){return r[0]==="o"&&r[1]==="n"&&ha(r.charCodeAt(2))}function n(r){return/^onDynamic/.test(r)&&ha(r.charCodeAt(9))}})(N8||={});var VB=Y("IUserDataProfileStorageService"),qC=class extends F{constructor(t,n){super();this.storageService=n;t&&(this.storageServicesMap=this._register(new Lo))}_serviceBrand;storageServicesMap;async readStorageData(t){return this.withProfileScopedStorageService(t,async n=>this.getItems(n))}async updateStorageData(t,n,i){return this.withProfileScopedStorageService(t,async r=>this.writeItems(r,n,i))}async withProfileScopedStorageService(t,n){if(this.storageService.hasScope(t))return n(this.storageService);let i=this.storageServicesMap?.get(t.id);if(!i){i=new P0(this.createStorageDatabase(t)),this.storageServicesMap?.set(t.id,i);try{await i.initialize()}catch(r){throw this.storageServicesMap?.has(t.id)?this.storageServicesMap.deleteAndDispose(t.id):i.dispose(),r}}try{let r=await n(i);return await i.flush(),r}finally{this.storageServicesMap?.has(t.id)||i.dispose()}}getItems(t){let n=new Map,i=r=>{for(let s of t.keys(0,r))n.set(s,{value:t.get(s,0),target:r})};return i(0),i(1),n}writeItems(t,n,i){t.storeAll(Array.from(n.entries()).map(([r,s])=>({key:r,value:s,scope:0,target:i})),!0)}};qC=O([x(1,Ln)],qC);var P0=class extends jC{constructor(t){super({flushInterval:100});this.profileStorageDatabase=t}profileStorage;async doInitialize(){let t=await this.profileStorageDatabase,n=new hb(t);return this._register(n.onDidChangeStorage(i=>{this.emitDidChangeValue(0,i)})),this._register(le(()=>{n.close(),n.dispose(),Hy(t)&&t.dispose()})),this.profileStorage=n,this.profileStorage.init()}getStorage(t){return t===0?this.profileStorage:void 0}getLogDetails(){}async switchToProfile(){}async switchToWorkspace(){}hasScope(){return!1}};var $C=class{constructor(e,t,n,i,r){this.userDataProfileService=e;this.extensionManagementService=t;this.extensionGalleryService=n;this.extensionEnablementService=i;this.logService=r}async initialize(e){let t=JSON.parse(e),n=await this.extensionManagementService.getInstalled(void 0,this.userDataProfileService.currentProfile.extensionsResource),i=[],r=[];for(let a of t){let l=this.extensionEnablementService.getDisabledExtensions().some(c=>Vo(c,a.identifier)),d=n.find(c=>Vo(c.identifier,a.identifier));(!d||!d.isBuiltin&&d.preRelease!==a.preRelease)&&r.push(a),l!==!!a.disabled&&i.push({extension:a.identifier,enable:!a.disabled})}let s=n.filter(a=>!a.isBuiltin&&!t.some(({identifier:l})=>Vo(l,a.identifier)));for(let{extension:a,enable:l}of i)l?(this.logService.trace("Initializing Profile: Enabling extension...",a.id),await this.extensionEnablementService.enableExtension(a),this.logService.info("Initializing Profile: Enabled extension...",a.id)):(this.logService.trace("Initializing Profile: Disabling extension...",a.id),await this.extensionEnablementService.disableExtension(a),this.logService.info("Initializing Profile: Disabled extension...",a.id));if(r.length){let a=await this.extensionGalleryService.getExtensions(r.map(l=>({...l.identifier,version:l.version,hasPreRelease:l.version?void 0:l.preRelease})),sn.None);await Promise.all(r.map(async l=>{let d=a.find(c=>Vo(c.identifier,l.identifier));d&&(await this.extensionManagementService.canInstall(d)?(this.logService.trace("Initializing Profile: Installing extension...",d.identifier.id,d.version),await this.extensionManagementService.installFromGallery(d,{isMachineScoped:!1,donotIncludePackAndDependencies:!0,installGivenVersion:!!l.version,installPreReleaseVersion:l.preRelease,profileLocation:this.userDataProfileService.currentProfile.extensionsResource,context:{[S0]:!0}}),this.logService.info("Initializing Profile: Installed extension...",d.identifier.id,d.version)):this.logService.info("Initializing Profile: Skipped installing extension because it cannot be installed.",d.identifier.id))}))}s.length&&await Promise.all(s.map(a=>this.extensionManagementService.uninstall(a)))}};$C=O([x(0,Or),x(1,ub),x(2,E0),x(3,NB),x(4,Gt)],$C);var Kd=class{constructor(e,t,n,i,r){this.extensionManagementService=e;this.extensionGalleryService=t;this.userDataProfileStorageService=n;this.instantiationService=i;this.logService=r}async getContent(e,t){let n=await this.getLocalExtensions(e);return this.toContent(n,t)}toContent(e,t){return JSON.stringify(t?.length?e.filter(n=>!t.includes(n.identifier.id.toLowerCase())):e)}async apply(e,t,n,i){return this.withProfileScopedServices(t,async r=>{let s=await this.getProfileExtensions(e),a=await this.extensionManagementService.getInstalled(void 0,t.extensionsResource),l=[],d=[];for(let u of s){let p=r.getDisabledExtensions().some(f=>Vo(f,u.identifier)),h=a.find(f=>Vo(f.identifier,u.identifier));(!h||!h.isBuiltin&&h.preRelease!==u.preRelease)&&d.push(u),p!==!!u.disabled&&l.push({extension:u.identifier,enable:!u.disabled})}let c=a.filter(u=>!u.isBuiltin&&!s.some(({identifier:p})=>Vo(p,u.identifier))&&!u.isApplicationScoped);for(let{extension:u,enable:p}of l)p?(this.logService.trace(`Importing Profile (${t.name}): Enabling extension...`,u.id),await r.enableExtension(u),this.logService.info(`Importing Profile (${t.name}): Enabled extension...`,u.id)):(this.logService.trace(`Importing Profile (${t.name}): Disabling extension...`,u.id),await r.disableExtension(u),this.logService.info(`Importing Profile (${t.name}): Disabled extension...`,u.id));if(d.length){this.logService.info(`Importing Profile (${t.name}): Started installing extensions.`);let u=await this.extensionGalleryService.getExtensions(d.map(h=>({...h.identifier,version:h.version,hasPreRelease:h.version?void 0:h.preRelease})),sn.None),p=[];if(await Promise.all(d.map(async h=>{let f=u.find(g=>Vo(g.identifier,h.identifier));f&&(await this.extensionManagementService.canInstall(f)?p.push({extension:f,options:{isMachineScoped:!1,donotIncludePackAndDependencies:!0,installGivenVersion:!!h.version,installPreReleaseVersion:h.preRelease,profileLocation:t.extensionsResource,context:{[S0]:!0}}}):this.logService.info(`Importing Profile (${t.name}): Skipped installing extension because it cannot be installed.`,f.identifier.id))})),p.length)if(i)for(let h of p){if(i.isCancellationRequested)return;n?.(m("installingExtension","Installing extension {0}...",h.extension.displayName??h.extension.identifier.id)),await this.extensionManagementService.installFromGallery(h.extension,h.options)}else await this.extensionManagementService.installGalleryExtensions(p);this.logService.info(`Importing Profile (${t.name}): Finished installing extensions.`)}c.length&&await Promise.all(c.map(u=>this.extensionManagementService.uninstall(u)))})}async copy(e,t,n){await this.extensionManagementService.copyExtensions(e.extensionsResource,t.extensionsResource);let i=await this.withProfileScopedServices(e,async r=>r.getDisabledExtensions());if(n){let r=await this.extensionManagementService.getInstalled(1,t.extensionsResource);for(let s of r)i.push(s.identifier)}await this.withProfileScopedServices(t,async r=>Promise.all(i.map(s=>r.disableExtension(s))))}async getLocalExtensions(e){return this.withProfileScopedServices(e,async t=>{let n=new Map,i=await this.extensionManagementService.getInstalled(void 0,e.extensionsResource),r=t.getDisabledExtensions();for(let s of i){let{identifier:a,preRelease:l}=s,d=r.some(p=>Vo(p,a));if(s.isBuiltin&&!d||!s.isBuiltin&&!s.identifier.uuid)continue;n.get(a.id.toLowerCase())?.disabled&&n.delete(a.id.toLowerCase());let u={identifier:a,displayName:s.manifest.displayName};d&&(u.disabled=!0),!s.isBuiltin&&s.pinned&&(u.version=s.manifest.version),!u.version&&l&&(u.preRelease=!0),n.set(u.identifier.id.toLowerCase(),u)}return[...n.values()]})}async getProfileExtensions(e){return JSON.parse(e)}async withProfileScopedServices(e,t){return this.userDataProfileStorageService.withProfileScopedStorageService(e,async n=>{let i=new ee,r=i.add(this.instantiationService.createChild(new gd([Ln,n]))),s=i.add(r.createInstance(Eh));try{return await t(s)}finally{i.dispose()}})}};Kd=O([x(0,ub),x(1,E0),x(2,VB),x(3,Oe),x(4,Gt)],Kd);var YC=class{type="extensions";handle="extensions";label={label:m("extensions","Extensions")};collapsibleState=2;contextValue="extensions";checkbox;excludedExtensions=new Set;async getChildren(){let e=(await this.getExtensions()).sort((n,i)=>(n.displayName??n.identifier.id).localeCompare(i.displayName??i.identifier.id)),t=this;return e.map(n=>({handle:n.identifier.id.toLowerCase(),parent:this,label:{label:n.displayName||n.identifier.id},description:n.disabled?m("disabled","Disabled"):void 0,collapsibleState:0,checkbox:t.checkbox?{get isChecked(){return!t.excludedExtensions.has(n.identifier.id.toLowerCase())},set isChecked(i){i?t.excludedExtensions.delete(n.identifier.id.toLowerCase()):t.excludedExtensions.add(n.identifier.id.toLowerCase())},tooltip:m("exclude","Select {0} Extension",n.displayName||n.identifier.id),accessibilityInformation:{label:m("exclude","Select {0} Extension",n.displayName||n.identifier.id)}}:void 0,themeIcon:te.extensions,command:{id:"extension.open",title:"",arguments:[n.identifier.id,void 0,!0]}}))}async hasContent(){return(await this.getExtensions()).length>0}},wh=class extends YC{constructor(t,n){super();this.profile=t;this.instantiationService=n}isFromDefaultProfile(){return!this.profile.isDefault&&!!this.profile.useDefaultFlags?.extensions}getExtensions(){return this.instantiationService.createInstance(Kd).getLocalExtensions(this.profile)}async getContent(){return this.instantiationService.createInstance(Kd).getContent(this.profile,[...this.excludedExtensions.values()])}};wh=O([x(1,Oe)],wh);var _h=class extends YC{constructor(t,n){super();this.content=t;this.instantiationService=n}isFromDefaultProfile(){return!1}getExtensions(){return this.instantiationService.createInstance(Kd).getProfileExtensions(this.content)}async getContent(){let t=this.instantiationService.createInstance(Kd),n=await t.getProfileExtensions(this.content);return t.toContent(n,[...this.excludedExtensions.values()])}};_h=O([x(1,Oe)],_h);var QC;(e=>e.DEFAULT={allowTrailingComma:!0})(QC||={});function N0(o,e=!1){let t=0,n=o.length,i="",r=0,s=16,a=0;function l(g){let b=0,v=0;for(;b<g;){let y=o.charCodeAt(t);if(y>=48&&y<=57)v=v*16+y-48;else if(y>=65&&y<=70)v=v*16+y-65+10;else if(y>=97&&y<=102)v=v*16+y-97+10;else break;t++,b++}return b<g&&(v=-1),v}function d(g){t=g,i="",r=0,s=16,a=0}function c(){let g=t;if(o.charCodeAt(t)===48)t++;else for(t++;t<o.length&&Dh(o.charCodeAt(t));)t++;if(t<o.length&&o.charCodeAt(t)===46)if(t++,t<o.length&&Dh(o.charCodeAt(t)))for(t++;t<o.length&&Dh(o.charCodeAt(t));)t++;else return a=3,o.substring(g,t);let b=t;if(t<o.length&&(o.charCodeAt(t)===69||o.charCodeAt(t)===101))if(t++,(t<o.length&&o.charCodeAt(t)===43||o.charCodeAt(t)===45)&&t++,t<o.length&&Dh(o.charCodeAt(t))){for(t++;t<o.length&&Dh(o.charCodeAt(t));)t++;b=t}else a=3;return o.substring(g,b)}function u(){let g="",b=t;for(;;){if(t>=n){g+=o.substring(b,t),a=2;break}let v=o.charCodeAt(t);if(v===34){g+=o.substring(b,t),t++;break}if(v===92){if(g+=o.substring(b,t),t++,t>=n){a=2;break}switch(o.charCodeAt(t++)){case 34:g+='"';break;case 92:g+="\\";break;case 47:g+="/";break;case 98:g+="\b";break;case 102:g+="\f";break;case 110:g+=`
`;break;case 114:g+="\r";break;case 116:g+="	";break;case 117:{let S=l(4);S>=0?g+=String.fromCharCode(S):a=4;break}default:a=5}b=t;continue}if(v>=0&&v<=31)if(XC(v)){g+=o.substring(b,t),a=2;break}else a=6;t++}return g}function p(){if(i="",a=0,r=t,t>=n)return r=n,s=17;let g=o.charCodeAt(t);if(O0(g)){do t++,i+=String.fromCharCode(g),g=o.charCodeAt(t);while(O0(g));return s=15}if(XC(g))return t++,i+=String.fromCharCode(g),g===13&&o.charCodeAt(t)===10&&(t++,i+=`
`),s=14;switch(g){case 123:return t++,s=1;case 125:return t++,s=2;case 91:return t++,s=3;case 93:return t++,s=4;case 58:return t++,s=6;case 44:return t++,s=5;case 34:return t++,i=u(),s=10;case 47:{let b=t-1;if(o.charCodeAt(t+1)===47){for(t+=2;t<n&&!XC(o.charCodeAt(t));)t++;return i=o.substring(b,t),s=12}if(o.charCodeAt(t+1)===42){t+=2;let v=n-1,y=!1;for(;t<v;){if(o.charCodeAt(t)===42&&o.charCodeAt(t+1)===47){t+=2,y=!0;break}t++}return y||(t++,a=1),i=o.substring(b,t),s=13}return i+=String.fromCharCode(g),t++,s=16}case 45:if(i+=String.fromCharCode(g),t++,t===n||!Dh(o.charCodeAt(t)))return s=16;case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return i+=c(),s=11;default:for(;t<n&&h(g);)t++,g=o.charCodeAt(t);if(r!==t){switch(i=o.substring(r,t),i){case"true":return s=8;case"false":return s=9;case"null":return s=7}return s=16}return i+=String.fromCharCode(g),t++,s=16}}function h(g){if(O0(g)||XC(g))return!1;switch(g){case 125:case 93:case 123:case 91:case 34:case 58:case 44:case 47:return!1}return!0}function f(){let g;do g=p();while(g>=12&&g<=15);return g}return{setPosition:d,getPosition:()=>t,scan:e?f:p,getToken:()=>s,getTokenValue:()=>i,getTokenOffset:()=>r,getTokenLength:()=>t-r,getTokenError:()=>a}}function O0(o){return o===32||o===9||o===11||o===12||o===160||o===5760||o>=8192&&o<=8203||o===8239||o===8287||o===12288||o===65279}function XC(o){return o===10||o===13||o===8232||o===8233}function Dh(o){return o>=48&&o<=57}function JC(o,e=[],t=QC.DEFAULT){let n=null,i=[],r=[];function s(l){Array.isArray(i)?i.push(l):n!==null&&(i[n]=l)}return gb(o,{onObjectBegin:()=>{let l={};s(l),r.push(i),i=l,n=null},onObjectProperty:l=>{n=l},onObjectEnd:()=>{i=r.pop()},onArrayBegin:()=>{let l=[];s(l),r.push(i),i=l,n=null},onArrayEnd:()=>{i=r.pop()},onLiteralValue:s,onError:(l,d,c)=>{e.push({error:l,offset:d,length:c})}},t),i[0]}function WB(o,e=[],t=QC.DEFAULT){let n={type:"array",offset:-1,length:-1,children:[],parent:void 0};function i(l){n.type==="property"&&(n.length=l-n.offset,n=n.parent)}function r(l){return n.children.push(l),l}gb(o,{onObjectBegin:l=>{n=r({type:"object",offset:l,length:-1,parent:n,children:[]})},onObjectProperty:(l,d,c)=>{n=r({type:"property",offset:d,length:-1,parent:n,children:[]}),n.children.push({type:"string",value:l,offset:d,length:c,parent:n})},onObjectEnd:(l,d)=>{n.length=l+d-n.offset,n=n.parent,i(l+d)},onArrayBegin:(l,d)=>{n=r({type:"array",offset:l,length:-1,parent:n,children:[]})},onArrayEnd:(l,d)=>{n.length=l+d-n.offset,n=n.parent,i(l+d)},onLiteralValue:(l,d,c)=>{r({type:A8(l),offset:d,length:c,parent:n,value:l}),i(d+c)},onSeparator:(l,d,c)=>{n.type==="property"&&(l===":"?n.colonOffset=d:l===","&&i(d))},onError:(l,d,c)=>{e.push({error:l,offset:d,length:c})}},t);let a=n.children[0];return a&&delete a.parent,a}function A0(o,e){if(!o)return;let t=o;for(let n of e)if(typeof n=="string"){if(t.type!=="object"||!Array.isArray(t.children))return;let i=!1;for(let r of t.children)if(Array.isArray(r.children)&&r.children[0].value===n){t=r.children[1],i=!0;break}if(!i)return}else{let i=n;if(t.type!=="array"||i<0||!Array.isArray(t.children)||i>=t.children.length)return;t=t.children[i]}return t}function gb(o,e,t=QC.DEFAULT){let n=N0(o,!1);function i(k){return k?()=>k(n.getTokenOffset(),n.getTokenLength()):()=>!0}function r(k){return k?W=>k(W,n.getTokenOffset(),n.getTokenLength()):()=>!0}let s=i(e.onObjectBegin),a=r(e.onObjectProperty),l=i(e.onObjectEnd),d=i(e.onArrayBegin),c=i(e.onArrayEnd),u=r(e.onLiteralValue),p=r(e.onSeparator),h=i(e.onComment),f=r(e.onError),g=t&&t.disallowComments,b=t&&t.allowTrailingComma;function v(){for(;;){let k=n.scan();switch(n.getTokenError()){case 4:y(14);break;case 5:y(15);break;case 3:y(13);break;case 1:g||y(11);break;case 2:y(12);break;case 6:y(16);break}switch(k){case 12:case 13:g?y(10):h();break;case 16:y(1);break;case 15:case 14:break;default:return k}}}function y(k,W=[],K=[]){if(f(k),W.length+K.length>0){let U=n.getToken();for(;U!==17;){if(W.indexOf(U)!==-1){v();break}else if(K.indexOf(U)!==-1)break;U=v()}}}function S(k){let W=n.getTokenValue();return k?u(W):a(W),v(),!0}function E(){switch(n.getToken()){case 11:{let k=0;try{k=JSON.parse(n.getTokenValue()),typeof k!="number"&&(y(2),k=0)}catch{y(2)}u(k);break}case 7:u(null);break;case 8:u(!0);break;case 9:u(!1);break;default:return!1}return v(),!0}function C(){return n.getToken()!==10?(y(3,[],[2,5]),!1):(S(!1),n.getToken()===6?(p(":"),v(),L()||y(4,[],[2,5])):y(5,[],[2,5]),!0)}function w(){s(),v();let k=!1;for(;n.getToken()!==2&&n.getToken()!==17;){if(n.getToken()===5){if(k||y(4,[],[]),p(","),v(),n.getToken()===2&&b)break}else k&&y(6,[],[]);C()||y(4,[],[2,5]),k=!0}return l(),n.getToken()!==2?y(7,[2],[]):v(),!0}function _(){d(),v();let k=!1;for(;n.getToken()!==4&&n.getToken()!==17;){if(n.getToken()===5){if(k||y(4,[],[]),p(","),v(),n.getToken()===4&&b)break}else k&&y(6,[],[]);L()||y(4,[],[4,5]),k=!0}return c(),n.getToken()!==4?y(8,[4],[]):v(),!0}function L(){switch(n.getToken()){case 3:return _();case 1:return w();case 10:return S(!0);default:return E()}}return v(),n.getToken()===17?t.allowEmptyContent?!0:(y(4,[],[]),!1):L()?(n.getToken()!==17&&y(9,[],[]),!0):(y(4,[],[]),!1)}function A8(o){switch(typeof o){case"boolean":return"boolean";case"number":return"number";case"string":return"string";case"object":{if(o){if(Array.isArray(o))return"array"}else return"null";return"object"}default:return"null"}}function HB(o,e,t){let n,i,r,s,a;if(e){for(s=e.offset,a=s+e.length,r=s;r>0&&!fb(o,r-1);)r--;let S=a;for(;S<o.length&&!fb(o,S);)S++;i=o.substring(r,S),n=F8(i,t)}else i=o,n=0,r=0,s=0,a=o.length;let l=B0(t,o),d=!1,c=0,u;t.insertSpaces?u=F0(" ",t.tabSize||4):u="	";let p=N0(i,!1),h=!1;function f(){return l+F0(u,n+c)}function g(){let S=p.scan();for(d=!1;S===15||S===14;)d=d||S===14,S=p.scan();return h=S===16||p.getTokenError()!==0,S}let b=[];function v(S,E,C){!h&&E<a&&C>s&&o.substring(E,C)!==S&&b.push({offset:E,length:C-E,content:S})}let y=g();if(y!==17){let S=p.getTokenOffset()+r,E=F0(u,n);v(E,r,S)}for(;y!==17;){let S=p.getTokenOffset()+p.getTokenLength()+r,E=g(),C="";for(;!d&&(E===12||E===13);){let _=p.getTokenOffset()+r;v(" ",S,_),S=p.getTokenOffset()+p.getTokenLength()+r,C=E===12?f():"",E=g()}if(E===2)y!==1&&(c--,C=f());else if(E===4)y!==3&&(c--,C=f());else{switch(y){case 3:case 1:c++,C=f();break;case 5:case 12:C=f();break;case 13:d?C=f():C=" ";break;case 6:C=" ";break;case 10:if(E===6){C="";break}case 7:case 8:case 9:case 11:case 2:case 4:E===12||E===13?C=" ":E!==5&&E!==17&&(h=!0);break;case 16:h=!0;break}d&&(E===12||E===13)&&(C=f())}let w=p.getTokenOffset()+r;v(C,S,w),y=E}return b}function F0(o,e){let t="";for(let n=0;n<e;n++)t+=o;return t}function F8(o,e){let t=0,n=0,i=e.tabSize||4;for(;t<o.length;){let r=o.charAt(t);if(r===" ")n++;else if(r==="	")n+=i;else break;t++}return Math.floor(n/i)}function B0(o,e){for(let t=0;t<e.length;t++){let n=e.charAt(t);if(n==="\r")return t+1<e.length&&e.charAt(t+1)===`
`?`\r
`:"\r";if(n===`
`)return`
`}return o&&o.eol||`
`}function fb(o,e){return`\r
`.indexOf(o.charAt(e))!==-1}function eS(o,e,t,n,i){let r=e.slice(),a=WB(o,[]),l,d;for(;r.length>0&&(d=r.pop(),l=A0(a,r),l===void 0&&t!==void 0);)typeof d=="string"?t={[d]:t}:t=[t];if(l)if(l.type==="object"&&typeof d=="string"&&Array.isArray(l.children)){let c=A0(l,[d]);if(c!==void 0)if(t===void 0){if(!c.parent)throw new Error("Malformed AST");let u=l.children.indexOf(c.parent),p,h=c.parent.offset+c.parent.length;if(u>0){let f=l.children[u-1];p=f.offset+f.length}else p=l.offset+1,l.children.length>1&&(h=l.children[1].offset);return Gd(o,{offset:p,length:h-p,content:""},n)}else return Gd(o,{offset:c.offset,length:c.length,content:JSON.stringify(t)},n);else{if(t===void 0)return[];let u=`${JSON.stringify(d)}: ${JSON.stringify(t)}`,p=i?i(l.children.map(f=>f.children[0].value)):l.children.length,h;if(p>0){let f=l.children[p-1];h={offset:f.offset+f.length,length:0,content:","+u}}else l.children.length===0?h={offset:l.offset+1,length:0,content:u}:h={offset:l.offset+1,length:0,content:u+","};return Gd(o,h,n)}}else if(l.type==="array"&&typeof d=="number"&&Array.isArray(l.children))if(t!==void 0){let c=`${JSON.stringify(t)}`,u;if(l.children.length===0||d===0)u={offset:l.offset+1,length:0,content:l.children.length===0?c:c+","};else{let p=d===-1||d>l.children.length?l.children.length:d,h=l.children[p-1];u={offset:h.offset+h.length,length:0,content:","+c}}return Gd(o,u,n)}else{let c=d,u=l.children[c],p;if(l.children.length===1)p={offset:l.offset+1,length:l.length-2,content:""};else if(l.children.length-1===c){let h=l.children[c-1],f=h.offset+h.length,g=l.offset+l.length;p={offset:f,length:g-2-f,content:""}}else p={offset:u.offset,length:l.children[c+1].offset-u.offset,content:""};return Gd(o,p,n)}else throw new Error(`Can not add ${typeof d!="number"?"index":"property"} to parent of type ${l.type}`);else return t===void 0?[]:Gd(o,{offset:a?a.offset:0,length:a?a.length:0,content:JSON.stringify(t)},n)}function Gd(o,e,t){let n=V0(o,e),i=e.offset,r=e.offset+e.content.length;if(e.length===0||e.content.length===0){for(;i>0&&!fb(n,i-1);)i--;for(;r<n.length&&!fb(n,r);)r++}let s=HB(n,{offset:i,length:r-i},t);for(let l=s.length-1;l>=0;l--){let d=s[l];n=V0(n,d),i=Math.min(i,d.offset),r=Math.max(r,d.offset+d.length),r+=d.content.length-d.length}let a=o.length-(n.length-r)-i;return[{offset:i,length:a,content:n.substring(i,r)}]}function V0(o,e){return o.substring(0,e.offset)+e.content+o.substring(e.offset+e.length)}function UB(o,e){let t=e.slice(0).sort((i,r)=>{let s=i.offset-r.offset;return s===0?i.length-r.length:s}),n=o.length;for(let i=t.length-1;i>=0;i--){let r=t[i];if(r.offset+r.length<=n)o=V0(o,r);else throw new Error("Overlapping edit");n=r.offset}return o}function W0(o,e,t,n){let i=eS(o,e,t,n)[0];return i&&(o=o.substring(0,i.offset)+i.content+o.substring(i.offset+i.length)),o}async function zB(o,e,t){let n=t&&t.get("storage.serviceMachineId",-1)||null;if(n)return n;try{let r=(await e.readFile(o.serviceMachineIdResource)).value.toString();n=$F(r)?r:null}catch{n=null}if(!n){n=Mr();try{await e.writeFile(o.serviceMachineIdResource,vt.fromString(n))}catch{}}return t?.store("storage.serviceMachineId",n,-1,1),n}var Cye=Y("IUserDataSyncMachinesService"),KB="sync.currentMachineName",V8="Safari",W8="Chrome",H8="Edge",U8="Firefox",z8="Android";function GB(){return Py?V8:Qg?W8:Oy?H8:Op?U8:Ny?z8:kD(Hn?0:Pp)}var wa=class extends F{constructor(t,n,i,r,s,a){super();this.storageService=i;this.userDataSyncStoreService=r;this.logService=s;this.productService=a;this.currentMachineIdPromise=zB(t,n,i)}static VERSION=1;static RESOURCE="machines";_serviceBrand;_onDidChange=this._register(new D);onDidChange=this._onDidChange.event;currentMachineIdPromise;userData=null;async getMachines(t){let n=await this.currentMachineIdPromise;return(await this.readMachinesData(t)).machines.map(r=>({...r,isCurrent:r.id===n}))}async addCurrentMachine(t){let n=await this.currentMachineIdPromise,i=await this.readMachinesData(t);i.machines.some(({id:r})=>r===n)||(i.machines.push({id:n,name:this.computeCurrentMachineName(i.machines),platform:GB()}),await this.writeMachinesData(i))}async removeCurrentMachine(t){let n=await this.currentMachineIdPromise,i=await this.readMachinesData(t),r=i.machines.filter(({id:s})=>s!==n);r.length!==i.machines.length&&(i.machines=r,await this.writeMachinesData(i))}async renameMachine(t,n,i){let r=await this.readMachinesData(i),s=r.machines.find(({id:a})=>a===t);if(s){s.name=n,await this.writeMachinesData(r);let a=await this.currentMachineIdPromise;t===a&&this.storageService.store(KB,n,-1,1)}}async setEnablements(t){let n=await this.readMachinesData();for(let[i,r]of t){let s=n.machines.find(a=>a.id===i);s&&(s.disabled=r?void 0:!0)}await this.writeMachinesData(n)}computeCurrentMachineName(t){let n=this.storageService.get(KB,-1);if(n)return n;let i=`${this.productService.embedderIdentifier?`${this.productService.embedderIdentifier} - `:""}${GB()} (${this.productService.nameShort})`,r=new RegExp(`${ji(i)}\\s#(\\d+)`),s=0;for(let a of t){let l=r.exec(a.name),d=l?parseInt(l[1]):0;s=d>s?d:s}return`${i} #${s+1}`}async readMachinesData(t){this.userData=await this.readUserData(t);let n=this.parse(this.userData);if(n.version!==wa.VERSION)throw new Error(m("error incompatible","Cannot read machines data as the current version is incompatible. Please update {0} and try again.",this.productService.nameLong));return n}async writeMachinesData(t){let n=JSON.stringify(t),i=await this.userDataSyncStoreService.writeResource(wa.RESOURCE,n,this.userData?.ref||null);this.userData={ref:i,content:n},this._onDidChange.fire()}async readUserData(t){if(this.userData){let n=t&&t.latest?t.latest[wa.RESOURCE]:void 0;if(this.userData.ref===n)return this.userData;if(n===void 0&&this.userData.content===null)return this.userData}return this.userDataSyncStoreService.readResource(wa.RESOURCE,this.userData)}parse(t){if(t.content!==null)try{return JSON.parse(t.content)}catch(n){this.logService.error(n)}return{version:wa.VERSION,machines:[]}}};wa=O([x(0,Mo),x(1,Bt),x(2,Ln),x(3,jB),x(4,qB),x(5,Ch)],wa);var hIe=Y("IUserDataSyncStoreManagementService"),jB=Y("IUserDataSyncStoreService"),mIe=Y("IUserDataSyncLocalStoreService");var tS=class extends Error{constructor(t,n,i,r){super(t);this.code=n;this.resource=i;this.operationId=r;this.name=`${this.code} (UserDataSyncError) syncResource:${this.resource||"unknown"} operationId:${this.operationId||"unknown"}`}};(e=>{function o(t){if(t instanceof e)return t;let n=/^(.+) \(UserDataSyncError\) syncResource:(.+) operationId:(.+)$/.exec(t.name);if(n&&n[1]){let i=n[2]==="unknown"?void 0:n[2],r=n[3]==="unknown"?void 0:n[3];return new e(t.message,n[1],i,r)}return new e(t.message,"Unknown")}e.toUserDataSyncError=o})(tS||={});var gIe=Y("IUserDataSyncEnablementService"),fIe=Y("IUserDataSyncService"),bIe=Y("IUserDataSyncResourceProviderService"),vIe=Y("IUserDataAutoSyncService"),$B=Y("IUserDataSyncUtilService"),qB=Y("IUserDataSyncLogService");function z0(o,e,t,n){if(t.length){let i=U0(e),r=JC(e)||{},s=JC(o);if(!s)return o;let a=[];for(let l of t){let d=r[l],c=s[l];d===void 0?o=W0(o,[l],void 0,n):c!==void 0?o=W0(o,[l],d,n):a.push(bb(l,i))}a.sort((l,d)=>l.startOffset-d.startOffset),a.forEach(l=>o=K8(l.setting.key,e,o,n))}return o}function K8(o,e,t,n){let i=JC(e),r=U0(e),s=U0(t),a=G8(o,r,s);return j8(t,o,i[o],a,s,n)}function G8(o,e,t){let n=e.findIndex(r=>r.setting?.key===o),i=e[n-1];if(i){if(i.setting){let s=bb(i.setting.key,t);if(s)return{index:t.indexOf(s),insertAfter:!0}}else{let s=H0(n,e);if(s){let a=bb(s.setting.key,t);if(a){let l=oS(t.indexOf(a),t),d=Lh(e,s,e[n]);if(l){let c=Lh(t,a,l),u=iS(d,c);return u?{index:t.indexOf(u),insertAfter:!0}:{index:t.indexOf(l),insertAfter:!1}}else{let c=Lh(t,a,t[t.length-1]),u=iS(d,c);return u?{index:t.indexOf(u),insertAfter:!0}:{index:t.length-1,insertAfter:!0}}}}}let r=e[n+1];if(r)if(r.setting){let s=bb(r.setting.key,t);if(s)return{index:t.indexOf(s),insertAfter:!1}}else{let s=oS(n,e);if(s){let a=bb(s.setting.key,t);if(a){let l=H0(t.indexOf(a),t),d=Lh(e,e[n],s);if(l){let c=Lh(t,l,a),u=iS(d.reverse(),c.reverse());return u?{index:t.indexOf(u),insertAfter:!1}:{index:t.indexOf(l),insertAfter:!0}}else{let c=Lh(t,t[0],a),u=iS(d.reverse(),c.reverse());return u?{index:t.indexOf(u),insertAfter:!1}:{index:0,insertAfter:!1}}}}}}return{index:t.length-1,insertAfter:!0}}function j8(o,e,t,n,i,r){let s;return n.index===-1?s=eS(o,[e],t,r):s=q8(o,e,t,n,i,r).map(a=>Gd(o,a,r)[0]),UB(o,s)}function q8(o,e,t,n,i,r){let s=`${JSON.stringify(e)}: ${JSON.stringify(t)}`,a=B0(r,o),l=i[n.index];if(n.insertAfter){let d=[];if(l.setting)d.push({offset:l.endOffset,length:0,content:","+s});else{let c=oS(n.index,i),u=H0(n.index,i),p=u?.setting?.commaOffset;u&&p===void 0&&d.push({offset:u.endOffset,length:0,content:","});let h=p!==void 0&&p>l.endOffset;d.push({offset:h?p+1:l.endOffset,length:0,content:c?a+s+",":a+s})}return d}else{if(l.setting)return[{offset:l.startOffset,length:0,content:s+","}];let d=(i[n.index-1]&&!i[n.index-1].setting?a:"")+s+(oS(n.index,i)?",":"")+a;return[{offset:l.startOffset,length:0,content:d}]}}function bb(o,e){return e.filter(t=>t.setting?.key===o)[0]}function H0(o,e){for(let t=o-1;t>=0;t--)if(e[t].setting)return e[t]}function oS(o,e){for(let t=o+1;t<e.length;t++)if(e[t].setting)return e[t]}function Lh(o,e,t){let n=o.indexOf(e),i=o.indexOf(t);return o.filter((r,s)=>n<s&&s<i)}function iS(o,e){if(o.length&&e.length){let t=0;for(;t<e.length&&t<o.length;t++)if(o[t].value!==e[t].value)return e[t-1];return e[t-1]}}function U0(o){let e=[],t=-1,n,i;return gb(o,{onObjectBegin:s=>{t++},onObjectProperty:(s,a,l)=>{t===0&&(n=a,i=s)},onObjectEnd:(s,a)=>{t--,t===0&&e.push({startOffset:n,endOffset:s+a,value:o.substring(n,s+a),setting:{key:i,commaOffset:void 0}})},onArrayBegin:(s,a)=>{t++},onArrayEnd:(s,a)=>{t--,t===0&&e.push({startOffset:n,endOffset:s+a,value:o.substring(n,s+a),setting:{key:i,commaOffset:void 0}})},onLiteralValue:(s,a,l)=>{t===0&&e.push({startOffset:n,endOffset:a+l,value:o.substring(n,a+l),setting:{key:i,commaOffset:void 0}})},onSeparator:(s,a,l)=>{if(t===0&&s===","){let d=e.length-1;for(;d>=0&&!e[d].setting;d--);let c=e[d];c&&e.splice(d,1,{startOffset:c.startOffset,endOffset:c.endOffset,value:c.value,setting:{key:c.setting.key,commaOffset:a}})}},onComment:(s,a)=>{t===0&&e.push({startOffset:s,endOffset:s+a,value:o.substring(s,s+a)})}}),e}function rS(o,e){let t=o;typeof t.vscodeWindowId!="number"&&Object.defineProperty(t,"vscodeWindowId",{get:()=>e})}var Ne=window;function K0(o){return o===Ne?!1:typeof o?.vscodeWindowId=="number"}var yu=class o{static INSTANCE=new o;mapWindowIdToZoomLevel=new Map;_onDidChangeZoomLevel=new D;onDidChangeZoomLevel=this._onDidChangeZoomLevel.event;getZoomLevel(e){return this.mapWindowIdToZoomLevel.get(this.getWindowId(e))??0}setZoomLevel(e,t){if(this.getZoomLevel(t)===e)return;let n=this.getWindowId(t);this.mapWindowIdToZoomLevel.set(n,e),this._onDidChangeZoomLevel.fire(n)}mapWindowIdToZoomFactor=new Map;getZoomFactor(e){return this.mapWindowIdToZoomFactor.get(this.getWindowId(e))??1}setZoomFactor(e,t){this.mapWindowIdToZoomFactor.set(this.getWindowId(t),e)}_onDidChangeFullscreen=new D;onDidChangeFullscreen=this._onDidChangeFullscreen.event;mapWindowIdToFullScreen=new Map;setFullscreen(e,t){if(this.isFullscreen(t)===e)return;let n=this.getWindowId(t);this.mapWindowIdToFullScreen.set(n,e),this._onDidChangeFullscreen.fire(n)}isFullscreen(e){return!!this.mapWindowIdToFullScreen.get(this.getWindowId(e))}getWindowId(e){return e.vscodeWindowId}};function $8(o,e,t){typeof e=="string"&&(e=o.matchMedia(e)),e.addEventListener("change",t)}function YB(o){return yu.INSTANCE.getZoomLevel(o)}var VIe=yu.INSTANCE.onDidChangeZoomLevel;function ZB(o){return yu.INSTANCE.getZoomFactor(o)}function XB(o,e){yu.INSTANCE.setFullscreen(o,e)}var WIe=yu.INSTANCE.onDidChangeFullscreen,Rh=navigator.userAgent,Gn=Rh.indexOf("Firefox")>=0,Ps=Rh.indexOf("AppleWebKit")>=0,jd=Rh.indexOf("Chrome")>=0,Wo=!jd&&Rh.indexOf("Safari")>=0,QB=!jd&&!Wo&&Ps,HIe=Rh.indexOf("Electron/")>=0,G0=Rh.indexOf("Android")>=0,sS=!1;if(typeof Ne.matchMedia=="function"){let o=Ne.matchMedia("(display-mode: standalone) or (display-mode: window-controls-overlay)"),e=Ne.matchMedia("(display-mode: fullscreen)");sS=o.matches,$8(Ne,o,({matches:t})=>{sS&&e.matches||(sS=t)})}function JB(){return sS}function Y8(o){if(o.charCode){let t=String.fromCharCode(o.charCode).toUpperCase();return lb.fromString(t)}let e=o.keyCode;if(e===3)return 7;if(Gn)switch(e){case 59:return 85;case 60:if(At)return 97;break;case 61:return 86;case 107:return 109;case 109:return 111;case 173:return 88;case 224:if(Ve)return 57;break}else if(Ps){if(Ve&&e===93)return 57;if(!Ve&&e===92)return 57}return m0[e]||0}var Z8=Ve?256:2048,X8=512,Q8=1024,J8=Ve?2048:256;var mt=class{_standardKeyboardEventBrand=!0;browserEvent;target;ctrlKey;shiftKey;altKey;metaKey;altGraphKey;keyCode;code;_asKeybinding;_asKeyCodeChord;constructor(e){let t=e;this.browserEvent=t,this.target=t.target,this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.altKey=t.altKey,this.metaKey=t.metaKey,this.altGraphKey=t.getModifierState?.("AltGraph"),this.keyCode=Y8(t),this.code=t.code,this.ctrlKey=this.ctrlKey||this.keyCode===5,this.altKey=this.altKey||this.keyCode===6,this.shiftKey=this.shiftKey||this.keyCode===4,this.metaKey=this.metaKey||this.keyCode===57,this._asKeybinding=this._computeKeybinding(),this._asKeyCodeChord=this._computeKeyCodeChord()}preventDefault(){this.browserEvent&&this.browserEvent.preventDefault&&this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent&&this.browserEvent.stopPropagation&&this.browserEvent.stopPropagation()}toKeyCodeChord(){return this._asKeyCodeChord}equals(e){return this._asKeybinding===e}_computeKeybinding(){let e=0;this.keyCode!==5&&this.keyCode!==4&&this.keyCode!==6&&this.keyCode!==57&&(e=this.keyCode);let t=0;return this.ctrlKey&&(t|=Z8),this.altKey&&(t|=X8),this.shiftKey&&(t|=Q8),this.metaKey&&(t|=J8),t|=e,t}_computeKeyCodeChord(){let e=0;return this.keyCode!==5&&this.keyCode!==4&&this.keyCode!==6&&this.keyCode!==57&&(e=this.keyCode),new db(this.ctrlKey,this.shiftKey,this.altKey,this.metaKey,e)}};var eV=new WeakMap;function e3(o){if(!o.parent||o.parent===o)return null;try{let e=o.location,t=o.parent.location;if(e.origin!=="null"&&t.origin!=="null"&&e.origin!==t.origin)return null}catch{return null}return o.parent}var aS=class{static getSameOriginWindowChain(e){let t=eV.get(e);if(!t){t=[],eV.set(e,t);let n=e,i;do i=e3(n),i?t.push({window:new WeakRef(n),iframeElement:n.frameElement||null}):t.push({window:new WeakRef(n),iframeElement:null}),n=i;while(n)}return t.slice(0)}static getPositionOfChildWindowRelativeToAncestorWindow(e,t){if(!t||e===t)return{top:0,left:0};let n=0,i=0,r=this.getSameOriginWindowChain(e);for(let s of r){let a=s.window.deref();if(n+=a?.scrollY??0,i+=a?.scrollX??0,a===t||!s.iframeElement)break;let l=s.iframeElement.getBoundingClientRect();n+=l.top,i+=l.left}return{top:n,left:i}}};var Yi=class{browserEvent;leftButton;middleButton;rightButton;buttons;target;detail;posx;posy;ctrlKey;shiftKey;altKey;metaKey;timestamp;constructor(e,t){this.timestamp=Date.now(),this.browserEvent=t,this.leftButton=t.button===0,this.middleButton=t.button===1,this.rightButton=t.button===2,this.buttons=t.buttons,this.target=t.target,this.detail=t.detail||1,t.type==="dblclick"&&(this.detail=2),this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.altKey=t.altKey,this.metaKey=t.metaKey,typeof t.pageX=="number"?(this.posx=t.pageX,this.posy=t.pageY):(this.posx=t.clientX+this.target.ownerDocument.body.scrollLeft+this.target.ownerDocument.documentElement.scrollLeft,this.posy=t.clientY+this.target.ownerDocument.body.scrollTop+this.target.ownerDocument.documentElement.scrollTop);let n=aS.getPositionOfChildWindowRelativeToAncestorWindow(e,t.view);this.posx-=n.left,this.posy-=n.top}preventDefault(){this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent.stopPropagation()}};var Nr=class{browserEvent;deltaY;deltaX;target;constructor(e,t=0,n=0){this.browserEvent=e||null,this.target=e?e.target||e.targetNode||e.srcElement:null,this.deltaY=n,this.deltaX=t;let i=!1;if(jd){let r=navigator.userAgent.match(/Chrome\/(\d+)/);i=(r?parseInt(r[1]):123)<=122}if(e){let r=e,s=e,a=e.view?.devicePixelRatio||1;if(typeof r.wheelDeltaY<"u")i?this.deltaY=r.wheelDeltaY/(120*a):this.deltaY=r.wheelDeltaY/120;else if(typeof s.VERTICAL_AXIS<"u"&&s.axis===s.VERTICAL_AXIS)this.deltaY=-s.detail/3;else if(e.type==="wheel"){let l=e;l.deltaMode===l.DOM_DELTA_LINE?Gn&&!Ve?this.deltaY=-e.deltaY/3:this.deltaY=-e.deltaY:this.deltaY=-e.deltaY/40}if(typeof r.wheelDeltaX<"u")Wo&&pt?this.deltaX=-(r.wheelDeltaX/120):i?this.deltaX=r.wheelDeltaX/(120*a):this.deltaX=r.wheelDeltaX/120;else if(typeof s.HORIZONTAL_AXIS<"u"&&s.axis===s.HORIZONTAL_AXIS)this.deltaX=-e.detail/3;else if(e.type==="wheel"){let l=e;l.deltaMode===l.DOM_DELTA_LINE?Gn&&!Ve?this.deltaX=-e.deltaX/3:this.deltaX=-e.deltaX:this.deltaX=-e.deltaX/40}this.deltaY===0&&this.deltaX===0&&e.wheelDelta&&(i?this.deltaY=e.wheelDelta/(120*a):this.deltaY=e.wheelDelta/120)}}preventDefault(){this.browserEvent?.preventDefault()}stopPropagation(){this.browserEvent?.stopPropagation()}};var lS={clipboard:{writeText:ca||document.queryCommandSupported&&document.queryCommandSupported("copy")||!!(navigator&&navigator.clipboard&&navigator.clipboard.writeText),readText:ca||!!(navigator&&navigator.clipboard&&navigator.clipboard.readText)},keyboard:ca||JB()?0:navigator.keyboard||Wo?1:2,touch:"ontouchstart"in Ne||navigator.maxTouchPoints>0,pointerEvents:Ne.PointerEvent&&("ontouchstart"in Ne||navigator.maxTouchPoints>0)};var{entries:lV,setPrototypeOf:tV,isFrozen:t3,getPrototypeOf:n3,getOwnPropertyDescriptor:i3}=Object,{freeze:Ho,seal:Ns,create:o3}=Object,{apply:X0,construct:Q0}=typeof Reflect<"u"&&Reflect;X0||(X0=function(e,t,n){return e.apply(t,n)});Ho||(Ho=function(e){return e});Ns||(Ns=function(e){return e});Q0||(Q0=function(e,t){return new e(...t)});var r3=ns(Array.prototype.forEach),nV=ns(Array.prototype.pop),vb=ns(Array.prototype.push),uS=ns(String.prototype.toLowerCase),j0=ns(String.prototype.toString),s3=ns(String.prototype.match),Os=ns(String.prototype.replace),a3=ns(String.prototype.indexOf),l3=ns(String.prototype.trim),Ar=ns(RegExp.prototype.test),yb=d3(TypeError);function ns(o){return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return X0(o,e,n)}}function d3(o){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Q0(o,t)}}function St(o,e,t){var n;t=(n=t)!==null&&n!==void 0?n:uS,tV&&tV(o,null);let i=e.length;for(;i--;){let r=e[i];if(typeof r=="string"){let s=t(r);s!==r&&(t3(e)||(e[i]=s),r=s)}o[r]=!0}return o}function kh(o){let e=o3(null);for(let[t,n]of lV(o))e[t]=n;return e}function dS(o,e){for(;o!==null;){let n=i3(o,e);if(n){if(n.get)return ns(n.get);if(typeof n.value=="function")return ns(n.value)}o=n3(o)}function t(n){return console.warn("fallback value for",n),null}return t}var iV=Ho(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),q0=Ho(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),$0=Ho(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),c3=Ho(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Y0=Ho(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),u3=Ho(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),oV=Ho(["#text"]),rV=Ho(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),Z0=Ho(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),sV=Ho(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),cS=Ho(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),p3=Ns(/\{\{[\w\W]*|[\w\W]*\}\}/gm),h3=Ns(/<%[\w\W]*|[\w\W]*%>/gm),m3=Ns(/\${[\w\W]*}/gm),g3=Ns(/^data-[\-\w.\u00B7-\uFFFF]/),f3=Ns(/^aria-[\-\w]+$/),dV=Ns(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),b3=Ns(/^(?:\w+script|data):/i),v3=Ns(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),cV=Ns(/^html$/i),aV=Object.freeze({__proto__:null,MUSTACHE_EXPR:p3,ERB_EXPR:h3,TMPLIT_EXPR:m3,DATA_ATTR:g3,ARIA_ATTR:f3,IS_ALLOWED_URI:dV,IS_SCRIPT_OR_DATA:b3,ATTR_WHITESPACE:v3,DOCTYPE_NAME:cV}),y3=()=>typeof window>"u"?null:window,I3=function(e,t){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let n=null,i="data-tt-policy-suffix";t&&t.hasAttribute(i)&&(n=t.getAttribute(i));let r="dompurify"+(n?"#"+n:"");try{return e.createPolicy(r,{createHTML(s){return s},createScriptURL(s){return s}})}catch{return console.warn("TrustedTypes policy "+r+" could not be created."),null}};function uV(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:y3(),e=Fe=>uV(Fe);if(e.version="3.0.5",e.removed=[],!o||!o.document||o.document.nodeType!==9)return e.isSupported=!1,e;let t=o.document,n=t.currentScript,{document:i}=o,{DocumentFragment:r,HTMLTemplateElement:s,Node:a,Element:l,NodeFilter:d,NamedNodeMap:c=o.NamedNodeMap||o.MozNamedAttrMap,HTMLFormElement:u,DOMParser:p,trustedTypes:h}=o,f=l.prototype,g=dS(f,"cloneNode"),b=dS(f,"nextSibling"),v=dS(f,"childNodes"),y=dS(f,"parentNode");if(typeof s=="function"){let Fe=i.createElement("template");Fe.content&&Fe.content.ownerDocument&&(i=Fe.content.ownerDocument)}let S,E="",{implementation:C,createNodeIterator:w,createDocumentFragment:_,getElementsByTagName:L}=i,{importNode:k}=t,W={};e.isSupported=typeof lV=="function"&&typeof y=="function"&&C&&C.createHTMLDocument!==void 0;let{MUSTACHE_EXPR:K,ERB_EXPR:U,TMPLIT_EXPR:oe,DATA_ATTR:Se,ARIA_ATTR:ne,IS_SCRIPT_OR_DATA:Q,ATTR_WHITESPACE:de}=aV,{IS_ALLOWED_URI:se}=aV,ie=null,Te=St({},[...iV,...q0,...$0,...Y0,...oV]),ue=null,Xe=St({},[...rV,...Z0,...sV,...cS]),ze=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),_e=null,vn=null,cn=!0,Bn=!0,di=!1,ms=!0,Nt=!1,Ai=!1,Fc=!1,Jl=!1,Fi=!1,ed=!1,td=!1,Dp=!0,Lp=!1,He="user-content-",ol=!0,nd=!1,ta={},Gr=null,Wg=St({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Bc=null,Hg=St({},["audio","video","img","source","image","track"]),na=null,Ug=St({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ia="http://www.w3.org/1998/Math/MathML",Cr="http://www.w3.org/2000/svg",Vn="http://www.w3.org/1999/xhtml",Sr=Vn,rl=!1,po=null,id=St({},[ia,Cr,Vn],j0),gs,oa=["application/xhtml+xml","text/html"],ve="text/html",pe,B=null,ae=i.createElement("form"),fe=function(G){return G instanceof RegExp||G instanceof Function},nt=function(G){if(!(B&&B===G)){if((!G||typeof G!="object")&&(G={}),G=kh(G),gs=oa.indexOf(G.PARSER_MEDIA_TYPE)===-1?gs=ve:gs=G.PARSER_MEDIA_TYPE,pe=gs==="application/xhtml+xml"?j0:uS,ie="ALLOWED_TAGS"in G?St({},G.ALLOWED_TAGS,pe):Te,ue="ALLOWED_ATTR"in G?St({},G.ALLOWED_ATTR,pe):Xe,po="ALLOWED_NAMESPACES"in G?St({},G.ALLOWED_NAMESPACES,j0):id,na="ADD_URI_SAFE_ATTR"in G?St(kh(Ug),G.ADD_URI_SAFE_ATTR,pe):Ug,Bc="ADD_DATA_URI_TAGS"in G?St(kh(Hg),G.ADD_DATA_URI_TAGS,pe):Hg,Gr="FORBID_CONTENTS"in G?St({},G.FORBID_CONTENTS,pe):Wg,_e="FORBID_TAGS"in G?St({},G.FORBID_TAGS,pe):{},vn="FORBID_ATTR"in G?St({},G.FORBID_ATTR,pe):{},ta="USE_PROFILES"in G?G.USE_PROFILES:!1,cn=G.ALLOW_ARIA_ATTR!==!1,Bn=G.ALLOW_DATA_ATTR!==!1,di=G.ALLOW_UNKNOWN_PROTOCOLS||!1,ms=G.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Nt=G.SAFE_FOR_TEMPLATES||!1,Ai=G.WHOLE_DOCUMENT||!1,Fi=G.RETURN_DOM||!1,ed=G.RETURN_DOM_FRAGMENT||!1,td=G.RETURN_TRUSTED_TYPE||!1,Jl=G.FORCE_BODY||!1,Dp=G.SANITIZE_DOM!==!1,Lp=G.SANITIZE_NAMED_PROPS||!1,ol=G.KEEP_CONTENT!==!1,nd=G.IN_PLACE||!1,se=G.ALLOWED_URI_REGEXP||dV,Sr=G.NAMESPACE||Vn,ze=G.CUSTOM_ELEMENT_HANDLING||{},G.CUSTOM_ELEMENT_HANDLING&&fe(G.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(ze.tagNameCheck=G.CUSTOM_ELEMENT_HANDLING.tagNameCheck),G.CUSTOM_ELEMENT_HANDLING&&fe(G.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(ze.attributeNameCheck=G.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),G.CUSTOM_ELEMENT_HANDLING&&typeof G.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(ze.allowCustomizedBuiltInElements=G.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Nt&&(Bn=!1),ed&&(Fi=!0),ta&&(ie=St({},[...oV]),ue=[],ta.html===!0&&(St(ie,iV),St(ue,rV)),ta.svg===!0&&(St(ie,q0),St(ue,Z0),St(ue,cS)),ta.svgFilters===!0&&(St(ie,$0),St(ue,Z0),St(ue,cS)),ta.mathMl===!0&&(St(ie,Y0),St(ue,sV),St(ue,cS))),G.ADD_TAGS&&(ie===Te&&(ie=kh(ie)),St(ie,G.ADD_TAGS,pe)),G.ADD_ATTR&&(ue===Xe&&(ue=kh(ue)),St(ue,G.ADD_ATTR,pe)),G.ADD_URI_SAFE_ATTR&&St(na,G.ADD_URI_SAFE_ATTR,pe),G.FORBID_CONTENTS&&(Gr===Wg&&(Gr=kh(Gr)),St(Gr,G.FORBID_CONTENTS,pe)),ol&&(ie["#text"]=!0),Ai&&St(ie,["html","head","body"]),ie.table&&(St(ie,["tbody"]),delete _e.tbody),G.TRUSTED_TYPES_POLICY){if(typeof G.TRUSTED_TYPES_POLICY.createHTML!="function")throw yb('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof G.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw yb('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');S=G.TRUSTED_TYPES_POLICY,E=S.createHTML("")}else S===void 0&&(S=I3(h,n)),S!==null&&typeof E=="string"&&(E=S.createHTML(""));Ho&&Ho(G),B=G}},Rt=St({},["mi","mo","mn","ms","mtext"]),ci=St({},["foreignobject","desc","title","annotation-xml"]),Bi=St({},["title","style","font","a","script"]),Ke=St({},q0);St(Ke,$0),St(Ke,c3);let R=St({},Y0);St(R,u3);let M=function(G){let Ie=y(G);(!Ie||!Ie.tagName)&&(Ie={namespaceURI:Sr,tagName:"template"});let Me=uS(G.tagName),Zt=uS(Ie.tagName);return po[G.namespaceURI]?G.namespaceURI===Cr?Ie.namespaceURI===Vn?Me==="svg":Ie.namespaceURI===ia?Me==="svg"&&(Zt==="annotation-xml"||Rt[Zt]):!!Ke[Me]:G.namespaceURI===ia?Ie.namespaceURI===Vn?Me==="math":Ie.namespaceURI===Cr?Me==="math"&&ci[Zt]:!!R[Me]:G.namespaceURI===Vn?Ie.namespaceURI===Cr&&!ci[Zt]||Ie.namespaceURI===ia&&!Rt[Zt]?!1:!R[Me]&&(Bi[Me]||!Ke[Me]):!!(gs==="application/xhtml+xml"&&po[G.namespaceURI]):!1},N=function(G){vb(e.removed,{element:G});try{G.parentNode.removeChild(G)}catch{G.remove()}},V=function(G,Ie){try{vb(e.removed,{attribute:Ie.getAttributeNode(G),from:Ie})}catch{vb(e.removed,{attribute:null,from:Ie})}if(Ie.removeAttribute(G),G==="is"&&!ue[G])if(Fi||ed)try{N(Ie)}catch{}else try{Ie.setAttribute(G,"")}catch{}},z=function(G){let Ie,Me;if(Jl)G="<remove></remove>"+G;else{let ho=s3(G,/^[\r\n\t ]+/);Me=ho&&ho[0]}gs==="application/xhtml+xml"&&Sr===Vn&&(G='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+G+"</body></html>");let Zt=S?S.createHTML(G):G;if(Sr===Vn)try{Ie=new p().parseFromString(Zt,gs)}catch{}if(!Ie||!Ie.documentElement){Ie=C.createDocument(Sr,"template",null);try{Ie.documentElement.innerHTML=rl?E:Zt}catch{}}let $n=Ie.body||Ie.documentElement;return G&&Me&&$n.insertBefore(i.createTextNode(Me),$n.childNodes[0]||null),Sr===Vn?L.call(Ie,Ai?"html":"body")[0]:Ai?Ie.documentElement:$n},X=function(G){return w.call(G.ownerDocument||G,G,d.SHOW_ELEMENT|d.SHOW_COMMENT|d.SHOW_TEXT,null,!1)},re=function(G){return G instanceof u&&(typeof G.nodeName!="string"||typeof G.textContent!="string"||typeof G.removeChild!="function"||!(G.attributes instanceof c)||typeof G.removeAttribute!="function"||typeof G.setAttribute!="function"||typeof G.namespaceURI!="string"||typeof G.insertBefore!="function"||typeof G.hasChildNodes!="function")},xe=function(G){return typeof a=="object"?G instanceof a:G&&typeof G=="object"&&typeof G.nodeType=="number"&&typeof G.nodeName=="string"},De=function(G,Ie,Me){W[G]&&r3(W[G],Zt=>{Zt.call(e,Ie,Me,B)})},ot=function(G){let Ie;if(De("beforeSanitizeElements",G,null),re(G))return N(G),!0;let Me=pe(G.nodeName);if(De("uponSanitizeElement",G,{tagName:Me,allowedTags:ie}),G.hasChildNodes()&&!xe(G.firstElementChild)&&(!xe(G.content)||!xe(G.content.firstElementChild))&&Ar(/<[/\w]/g,G.innerHTML)&&Ar(/<[/\w]/g,G.textContent))return N(G),!0;if(!ie[Me]||_e[Me]){if(!_e[Me]&&rn(Me)&&(ze.tagNameCheck instanceof RegExp&&Ar(ze.tagNameCheck,Me)||ze.tagNameCheck instanceof Function&&ze.tagNameCheck(Me)))return!1;if(ol&&!Gr[Me]){let Zt=y(G)||G.parentNode,$n=v(G)||G.childNodes;if($n&&Zt){let ho=$n.length;for(let On=ho-1;On>=0;--On)Zt.insertBefore(g($n[On],!0),b(G))}}return N(G),!0}return G instanceof l&&!M(G)||(Me==="noscript"||Me==="noembed"||Me==="noframes")&&Ar(/<\/no(script|embed|frames)/i,G.innerHTML)?(N(G),!0):(Nt&&G.nodeType===3&&(Ie=G.textContent,Ie=Os(Ie,K," "),Ie=Os(Ie,U," "),Ie=Os(Ie,oe," "),G.textContent!==Ie&&(vb(e.removed,{element:G.cloneNode()}),G.textContent=Ie)),De("afterSanitizeElements",G,null),!1)},Tt=function(G,Ie,Me){if(Dp&&(Ie==="id"||Ie==="name")&&(Me in i||Me in ae))return!1;if(!(Bn&&!vn[Ie]&&Ar(Se,Ie))){if(!(cn&&Ar(ne,Ie))){if(!ue[Ie]||vn[Ie]){if(!(rn(G)&&(ze.tagNameCheck instanceof RegExp&&Ar(ze.tagNameCheck,G)||ze.tagNameCheck instanceof Function&&ze.tagNameCheck(G))&&(ze.attributeNameCheck instanceof RegExp&&Ar(ze.attributeNameCheck,Ie)||ze.attributeNameCheck instanceof Function&&ze.attributeNameCheck(Ie))||Ie==="is"&&ze.allowCustomizedBuiltInElements&&(ze.tagNameCheck instanceof RegExp&&Ar(ze.tagNameCheck,Me)||ze.tagNameCheck instanceof Function&&ze.tagNameCheck(Me))))return!1}else if(!na[Ie]){if(!Ar(se,Os(Me,de,""))){if(!((Ie==="src"||Ie==="xlink:href"||Ie==="href")&&G!=="script"&&a3(Me,"data:")===0&&Bc[G])){if(!(di&&!Ar(Q,Os(Me,de,"")))){if(Me)return!1}}}}}}return!0},rn=function(G){return G.indexOf("-")>0},Wn=function(G){let Ie,Me,Zt,$n;De("beforeSanitizeAttributes",G,null);let{attributes:ho}=G;if(!ho)return;let On={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:ue};for($n=ho.length;$n--;){Ie=ho[$n];let{name:ra,namespaceURI:SD}=Ie;if(Me=ra==="value"?Ie.value:l3(Ie.value),Zt=pe(ra),On.attrName=Zt,On.attrValue=Me,On.keepAttr=!0,On.forceKeepAttr=void 0,De("uponSanitizeAttribute",G,On),Me=On.attrValue,On.forceKeepAttr||(V(ra,G),!On.keepAttr))continue;if(!ms&&Ar(/\/>/i,Me)){V(ra,G);continue}Nt&&(Me=Os(Me,K," "),Me=Os(Me,U," "),Me=Os(Me,oe," "));let PN=pe(G.nodeName);if(Tt(PN,Zt,Me)){if(Lp&&(Zt==="id"||Zt==="name")&&(V(ra,G),Me=He+Me),S&&typeof h=="object"&&typeof h.getAttributeType=="function"&&!SD)switch(h.getAttributeType(PN,Zt)){case"TrustedHTML":{Me=S.createHTML(Me);break}case"TrustedScriptURL":{Me=S.createScriptURL(Me);break}}try{SD?G.setAttributeNS(SD,ra,Me):G.setAttribute(ra,Me),nV(e.removed)}catch{}}}De("afterSanitizeAttributes",G,null)},hn=function Fe(G){let Ie,Me=X(G);for(De("beforeSanitizeShadowDOM",G,null);Ie=Me.nextNode();)De("uponSanitizeShadowNode",Ie,null),!ot(Ie)&&(Ie.content instanceof r&&Fe(Ie.content),Wn(Ie));De("afterSanitizeShadowDOM",G,null)};return e.sanitize=function(Fe){let G=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Ie,Me,Zt,$n;if(rl=!Fe,rl&&(Fe="<!-->"),typeof Fe!="string"&&!xe(Fe))if(typeof Fe.toString=="function"){if(Fe=Fe.toString(),typeof Fe!="string")throw yb("dirty is not a string, aborting")}else throw yb("toString is not a function");if(!e.isSupported)return Fe;if(Fc||nt(G),e.removed=[],typeof Fe=="string"&&(nd=!1),nd){if(Fe.nodeName){let ra=pe(Fe.nodeName);if(!ie[ra]||_e[ra])throw yb("root node is forbidden and cannot be sanitized in-place")}}else if(Fe instanceof a)Ie=z("<!---->"),Me=Ie.ownerDocument.importNode(Fe,!0),Me.nodeType===1&&Me.nodeName==="BODY"||Me.nodeName==="HTML"?Ie=Me:Ie.appendChild(Me);else{if(!Fi&&!Nt&&!Ai&&Fe.indexOf("<")===-1)return S&&td?S.createHTML(Fe):Fe;if(Ie=z(Fe),!Ie)return Fi?null:td?E:""}Ie&&Jl&&N(Ie.firstChild);let ho=X(nd?Fe:Ie);for(;Zt=ho.nextNode();)ot(Zt)||(Zt.content instanceof r&&hn(Zt.content),Wn(Zt));if(nd)return Fe;if(Fi){if(ed)for($n=_.call(Ie.ownerDocument);Ie.firstChild;)$n.appendChild(Ie.firstChild);else $n=Ie;return(ue.shadowroot||ue.shadowrootmode)&&($n=k.call(t,$n,!0)),$n}let On=Ai?Ie.outerHTML:Ie.innerHTML;return Ai&&ie["!doctype"]&&Ie.ownerDocument&&Ie.ownerDocument.doctype&&Ie.ownerDocument.doctype.name&&Ar(cV,Ie.ownerDocument.doctype.name)&&(On="<!DOCTYPE "+Ie.ownerDocument.doctype.name+`>
`+On),Nt&&(On=Os(On,K," "),On=Os(On,U," "),On=Os(On,oe," ")),S&&td?S.createHTML(On):On},e.setConfig=function(Fe){nt(Fe),Fc=!0},e.clearConfig=function(){B=null,Fc=!1},e.isValidAttribute=function(Fe,G,Ie){B||nt({});let Me=pe(Fe),Zt=pe(G);return Tt(Me,Zt,Ie)},e.addHook=function(Fe,G){typeof G=="function"&&(W[Fe]=W[Fe]||[],vb(W[Fe],G))},e.removeHook=function(Fe){if(W[Fe])return nV(W[Fe])},e.removeHooks=function(Fe){W[Fe]&&(W[Fe]=[])},e.removeAllHooks=function(){W={}},e}var _a=uV();var ZIe=_a.version,XIe=_a.isSupported,pS=_a.sanitize,QIe=_a.setConfig,JIe=_a.clearConfig,eCe=_a.isValidAttribute,hS=_a.addHook,mS=_a.removeHook,tCe=_a.removeHooks,nCe=_a.removeAllHooks;function Ri(o,e,t){return Math.min(Math.max(o,e),t)}var{registerWindow:fV,getWindow:Ce,getDocument:SCe,getWindows:Cb,getWindowsCount:fS,getWindowId:$d,getWindowById:Cu,hasWindow:ECe,onDidRegisterWindow:tk,onWillUnregisterWindow:TCe,onDidUnregisterWindow:bV}=function(){let o=new Map;rS(Ne,1);let e={window:Ne,disposables:new ee};o.set(Ne.vscodeWindowId,e);let t=new D,n=new D,i=new D;function r(s,a){return(typeof s=="number"?o.get(s):void 0)??(a?e:void 0)}return{onDidRegisterWindow:t.event,onWillUnregisterWindow:i.event,onDidUnregisterWindow:n.event,registerWindow(s){if(o.has(s.vscodeWindowId))return F.None;let a=new ee,l={window:s,disposables:a.add(new ee)};return o.set(s.vscodeWindowId,l),a.add(le(()=>{o.delete(s.vscodeWindowId),n.fire(s)})),a.add(j(s,me.BEFORE_UNLOAD,()=>{i.fire(s)})),t.fire(l),a},getWindows(){return o.values()},getWindowsCount(){return o.size},getWindowId(s){return s.vscodeWindowId},hasWindow(s){return o.has(s)},getWindowById:r,getWindow(s){let a=s;if(a?.ownerDocument?.defaultView)return a.ownerDocument.defaultView.window;let l=s;return l?.view?l.view.window:Ne},getDocument(s){return Ce(s).document}}}();function fi(o){for(;o.firstChild;)o.firstChild.remove()}var J0=class{_handler;_node;_type;_options;constructor(e,t,n,i){this._node=e,this._type=t,this._handler=n,this._options=i||!1,this._node.addEventListener(this._type,this._handler,this._options)}dispose(){this._handler&&(this._node.removeEventListener(this._type,this._handler,this._options),this._node=null,this._handler=null)}};function j(o,e,t,n){return new J0(o,e,t,n)}function C3(o,e){return function(t){return e(new Yi(o,t))}}function S3(o){return function(e){return o(new mt(e))}}var bn=function(e,t,n,i){let r=n;return t==="click"||t==="mousedown"||t==="contextmenu"?r=C3(Ce(e),n):(t==="keydown"||t==="keypress"||t==="keyup")&&(r=S3(n)),j(e,t,r,i)};function Sb(o,e,t){return Yp(o,e,t)}var nk,ni;var Mh=class extends CI{defaultTarget;constructor(e){super(),this.defaultTarget=e&&Ce(e)}cancelAndSet(e,t,n){return super.cancelAndSet(e,t,n??this.defaultTarget)}},Ib=class{_runner;priority;_canceled;constructor(e,t=0){this._runner=e,this.priority=t,this._canceled=!1}dispose(){this._canceled=!0}execute(){if(!this._canceled)try{this._runner()}catch(e){qe(e)}}static sort(e,t){return t.priority-e.priority}};(function(){let o=new Map,e=new Map,t=new Map,n=new Map,i=r=>{t.set(r,!1);let s=o.get(r)??[];for(e.set(r,s),o.set(r,[]),n.set(r,!0);s.length>0;)s.sort(Ib.sort),s.shift().execute();n.set(r,!1)};ni=(r,s,a=0)=>{let l=$d(r),d=new Ib(s,a),c=o.get(l);return c||(c=[],o.set(l,c)),c.push(d),t.get(l)||(t.set(l,!0),r.requestAnimationFrame(()=>i(l))),d},nk=(r,s,a)=>{let l=$d(r);if(n.get(l)){let d=new Ib(s,a),c=e.get(l);return c||(c=[],e.set(l,c)),c.push(d),d}else return ni(r,s,a)}})();function vV(o){return Ce(o).getComputedStyle(o,null)}function Su(o,e){let t=Ce(o),n=t.document;if(o!==n.body)return new no(o.clientWidth,o.clientHeight);if(jr&&t?.visualViewport)return new no(t.visualViewport.width,t.visualViewport.height);if(t?.innerWidth&&t.innerHeight)return new no(t.innerWidth,t.innerHeight);if(n.body&&n.body.clientWidth&&n.body.clientHeight)return new no(n.body.clientWidth,n.body.clientHeight);if(n.documentElement&&n.documentElement.clientWidth&&n.documentElement.clientHeight)return new no(n.documentElement.clientWidth,n.documentElement.clientHeight);if(e)return Su(e);throw new Error("Unable to figure out browser width and height")}var yo=class o{static convertToPixels(e,t){return parseFloat(t)||0}static getDimension(e,t,n){let i=vV(e),r=i?i.getPropertyValue(t):"0";return o.convertToPixels(e,r)}static getBorderLeftWidth(e){return o.getDimension(e,"border-left-width","borderLeftWidth")}static getBorderRightWidth(e){return o.getDimension(e,"border-right-width","borderRightWidth")}static getBorderTopWidth(e){return o.getDimension(e,"border-top-width","borderTopWidth")}static getBorderBottomWidth(e){return o.getDimension(e,"border-bottom-width","borderBottomWidth")}static getPaddingLeft(e){return o.getDimension(e,"padding-left","paddingLeft")}static getPaddingRight(e){return o.getDimension(e,"padding-right","paddingRight")}static getPaddingTop(e){return o.getDimension(e,"padding-top","paddingTop")}static getPaddingBottom(e){return o.getDimension(e,"padding-bottom","paddingBottom")}static getMarginLeft(e){return o.getDimension(e,"margin-left","marginLeft")}static getMarginTop(e){return o.getDimension(e,"margin-top","marginTop")}static getMarginRight(e){return o.getDimension(e,"margin-right","marginRight")}static getMarginBottom(e){return o.getDimension(e,"margin-bottom","marginBottom")}},no=class o{constructor(e,t){this.width=e;this.height=t}static None=new o(0,0);with(e=this.width,t=this.height){return e!==this.width||t!==this.height?new o(e,t):this}static is(e){return typeof e=="object"&&typeof e.height=="number"&&typeof e.width=="number"}static lift(e){return e instanceof o?e:new o(e.width,e.height)}static equals(e,t){return e===t?!0:!e||!t?!1:e.width===t.width&&e.height===t.height}};function Eb(o){let e=o.offsetParent,t=o.offsetTop,n=o.offsetLeft;for(;(o=o.parentNode)!==null&&o!==o.ownerDocument.body&&o!==o.ownerDocument.documentElement;){t-=o.scrollTop;let i=IV(o)?null:vV(o);i&&(n-=i.direction!=="rtl"?o.scrollLeft:-o.scrollLeft),o===e&&(n+=yo.getBorderLeftWidth(o),t+=yo.getBorderTopWidth(o),t+=o.offsetTop,n+=o.offsetLeft,e=o.offsetParent)}return{left:n,top:t}}function yV(o,e,t,n,i,r="absolute"){typeof e=="number"&&(o.style.top=`${e}px`),typeof t=="number"&&(o.style.right=`${t}px`),typeof n=="number"&&(o.style.bottom=`${n}px`),typeof i=="number"&&(o.style.left=`${i}px`),o.style.position=r}function io(o){let e=o.getBoundingClientRect(),t=Ce(o);return{left:e.left+t.scrollX,top:e.top+t.scrollY,width:e.width,height:e.height}}function Oh(o){let e=yo.getMarginLeft(o)+yo.getMarginRight(o);return o.offsetWidth+e}function Nh(o){let e=yo.getBorderLeftWidth(o)+yo.getBorderRightWidth(o),t=yo.getPaddingLeft(o)+yo.getPaddingRight(o);return o.offsetWidth-e-t}function bS(o){let e=yo.getBorderTopWidth(o)+yo.getBorderBottomWidth(o),t=yo.getPaddingTop(o)+yo.getPaddingBottom(o);return o.offsetHeight-e-t}function vS(o){let e=yo.getMarginTop(o)+yo.getMarginBottom(o);return o.offsetHeight+e}function is(o,e){return!!e?.contains(o)}function E3(o,e,t){for(;o&&o.nodeType===o.ELEMENT_NODE;){if(o.classList.contains(e))return o;if(t){if(typeof t=="string"){if(o.classList.contains(t))return null}else if(o===t)return null}o=o.parentNode}return null}function yS(o,e,t){return!!E3(o,e,t)}function IV(o){return o&&!!o.host&&!!o.mode}function Yd(o){for(;o.parentNode;){if(o===o.ownerDocument?.body)return null;o=o.parentNode}return IV(o)?o:null}function Io(){let o=ik().activeElement;for(;o?.shadowRoot;)o=o.shadowRoot.activeElement;return o}function Fr(o){return Io()===o}function ik(){return fS()<=1?Ne.document:Array.from(Cb()).map(({window:e})=>e.document).find(e=>e.hasFocus())??Ne.document}function Zd(){return ik().defaultView?.window??Ne}var ok=new Map;function CV(o){return ok.has(o)}function ur(o=Ne.document.head,e,t){let n=document.createElement("style");if(n.type="text/css",n.media="screen",e?.(n),o.appendChild(n),t&&t.add(le(()=>n.remove())),o===Ne.document.head){let i=new Set;ok.set(n,i);for(let{window:r,disposables:s}of Cb()){if(r===Ne)continue;let a=s.add(EV(n,i,r));t?.add(a)}}return n}function SV(o){let e=new ee;for(let[t,n]of ok)e.add(EV(t,n,o));return e}function EV(o,e,t){let n=new ee,i=o.cloneNode(!0);t.document.head.appendChild(i),n.add(le(()=>i.remove()));for(let r of T3(o))i.sheet?.insertRule(r.cssText,i.sheet?.cssRules.length);return n.add(IS.observe(o,n,{childList:!0})(()=>{i.textContent=o.textContent})),e.add(i),n.add(le(()=>e.delete(i))),n}var IS=new class{mutationObservers=new Map;observe(o,e,t){let n=this.mutationObservers.get(o);n||(n=new Map,this.mutationObservers.set(o,n));let i=Zr(t),r=n.get(i);if(r)r.users+=1;else{let s=new D,a=new MutationObserver(d=>s.fire(d));a.observe(o,t);let l=r={users:1,observer:a,onDidMutate:s.event};e.add(le(()=>{l.users-=1,l.users===0&&(s.dispose(),a.disconnect(),n?.delete(i),n?.size===0&&this.mutationObservers.delete(o))})),n.set(i,r)}return r.onDidMutate}};function TV(o=Ne.document.head){return wV("meta",o)}function xV(o=Ne.document.head){return wV("link",o)}function wV(o,e=Ne.document.head){let t=document.createElement(o);return e.appendChild(t),t}function T3(o){return o?.sheet?.rules?o.sheet.rules:o?.sheet?.cssRules?o.sheet.cssRules:[]}function Nn(o){return o instanceof HTMLElement||o instanceof Ce(o).HTMLElement}function _V(o){return o instanceof SVGElement||o instanceof Ce(o).SVGElement}function CS(o){return o instanceof MouseEvent||o instanceof Ce(o).MouseEvent}function os(o){return o instanceof KeyboardEvent||o instanceof Ce(o).KeyboardEvent}var me={CLICK:"click",AUXCLICK:"auxclick",DBLCLICK:"dblclick",MOUSE_UP:"mouseup",MOUSE_DOWN:"mousedown",MOUSE_OVER:"mouseover",MOUSE_MOVE:"mousemove",MOUSE_OUT:"mouseout",MOUSE_ENTER:"mouseenter",MOUSE_LEAVE:"mouseleave",MOUSE_WHEEL:"wheel",POINTER_UP:"pointerup",POINTER_DOWN:"pointerdown",POINTER_MOVE:"pointermove",POINTER_LEAVE:"pointerleave",CONTEXT_MENU:"contextmenu",WHEEL:"wheel",KEY_DOWN:"keydown",KEY_PRESS:"keypress",KEY_UP:"keyup",LOAD:"load",BEFORE_UNLOAD:"beforeunload",UNLOAD:"unload",PAGE_SHOW:"pageshow",PAGE_HIDE:"pagehide",PASTE:"paste",ABORT:"abort",ERROR:"error",RESIZE:"resize",SCROLL:"scroll",FULLSCREEN_CHANGE:"fullscreenchange",WK_FULLSCREEN_CHANGE:"webkitfullscreenchange",SELECT:"select",CHANGE:"change",SUBMIT:"submit",RESET:"reset",FOCUS:"focus",FOCUS_IN:"focusin",FOCUS_OUT:"focusout",BLUR:"blur",INPUT:"input",STORAGE:"storage",DRAG_START:"dragstart",DRAG:"drag",DRAG_ENTER:"dragenter",DRAG_LEAVE:"dragleave",DRAG_OVER:"dragover",DROP:"drop",DRAG_END:"dragend",ANIMATION_START:Ps?"webkitAnimationStart":"animationstart",ANIMATION_END:Ps?"webkitAnimationEnd":"animationend",ANIMATION_ITERATION:Ps?"webkitAnimationIteration":"animationiteration"};var st={stop:(o,e)=>(o.preventDefault(),e&&o.stopPropagation(),o)};function DV(o){let e=[];for(let t=0;o&&o.nodeType===o.ELEMENT_NODE;t++)e[t]=o.scrollTop,o=o.parentNode;return e}function LV(o,e){for(let t=0;o&&o.nodeType===o.ELEMENT_NODE;t++)o.scrollTop!==e[t]&&(o.scrollTop=e[t]),o=o.parentNode}var ek=class o extends F{_onDidFocus=this._register(new D);onDidFocus=this._onDidFocus.event;_onDidBlur=this._register(new D);onDidBlur=this._onDidBlur.event;_refreshStateHandler;static hasFocusWithin(e){if(Nn(e)){let t=Yd(e),n=t?t.activeElement:e.ownerDocument.activeElement;return is(n,e)}else{let t=e;return is(t.document.activeElement,t.document)}}constructor(e){super();let t=o.hasFocusWithin(e),n=!1,i=()=>{n=!1,t||(t=!0,this._onDidFocus.fire())},r=()=>{t&&(n=!0,(Nn(e)?Ce(e):e).setTimeout(()=>{n&&(n=!1,t=!1,this._onDidBlur.fire())},0))};this._refreshStateHandler=()=>{o.hasFocusWithin(e)!==t&&(t?r():i())},this._register(j(e,me.FOCUS,i,!0)),this._register(j(e,me.BLUR,r,!0)),Nn(e)&&(this._register(j(e,me.FOCUS_IN,()=>this._refreshStateHandler())),this._register(j(e,me.FOCUS_OUT,()=>this._refreshStateHandler())))}refreshState(){this._refreshStateHandler()}};function _l(o){return new ek(o)}function dt(o,...e){if(o.append(...e),e.length===1&&typeof e[0]!="string")return e[0]}function rk(o,e){return o.insertBefore(e,o.firstChild),e}function Br(o,...e){o.innerText="",dt(o,...e)}var x3=/([\w\-]+)?(#([\w\-]+))?((\.([\w\-]+))*)/;function RV(o,e,t,...n){let i=x3.exec(e);if(!i)throw new Error("Bad use of emmet");let r=i[1]||"div",s;return o!=="http://www.w3.org/1999/xhtml"?s=document.createElementNS(o,r):s=document.createElement(r),i[3]&&(s.id=i[3]),i[4]&&(s.className=i[4].replace(/\./g," ").trim()),t&&Object.entries(t).forEach(([a,l])=>{typeof l>"u"||(/^on\w+$/.test(a)?s[a]=l:a==="selected"?l&&s.setAttribute(a,"true"):s.setAttribute(a,l))}),s.append(...n),s}function Ge(o,e,...t){return RV("http://www.w3.org/1999/xhtml",o,e,...t)}Ge.SVG=function(o,e,...t){return RV("http://www.w3.org/2000/svg",o,e,...t)};function sk(o,e){let t=o.devicePixelRatio*e;return Math.max(1,Math.floor(t))/o.devicePixelRatio}function ak(o){Ne.open(o,"_blank","noopener")}var hV=780,mV=640;function lk(o){let e=Math.floor(Ne.screenLeft+Ne.innerWidth/2-hV/2),t=Math.floor(Ne.screenTop+Ne.innerHeight/2-mV/2);Ne.open(o,"_blank",`width=${hV},height=${mV},top=${t},left=${e}`)}function kV(o,e=!0){let t=Ne.open();return t?(e&&(t.opener=null),t.location.href=o,!0):!1}function MV(o,e){let t=()=>{e(),n=ni(o,t)},n=ni(o,t);return le(()=>n.dispose())}mI.setPreferredWebSchema(/^https:/.test(Ne.location.href)?"https":"http");function Tb(o){return o?`url('${ma.uriToBrowserUri(o).toString(!0).replace(/'/g,"%27")}')`:"url('')"}function Vr(o,e){if(o!==void 0){let t=o.match(/^\s*var\((.+)\)$/);if(t){let n=t[1].split(",",2);return n.length===2&&(e=Vr(n[1].trim(),e)),`var(${n[0]}, ${e})`}return o}return e}function PV(o,e=!1){let t=document.createElement("a");return hS("afterSanitizeAttributes",n=>{for(let i of["href","src"])if(n.hasAttribute(i)){let r=n.getAttribute(i);if(i==="href"&&r.startsWith("#"))continue;if(t.href=r,!o.includes(t.protocol.replace(/:$/,""))){if(e&&i==="src"&&t.href.startsWith("data:"))continue;n.removeAttribute(i)}}}),le(()=>{mS("afterSanitizeAttributes")})}var xCe=[Le.http,Le.https,Le.command],OV=Object.freeze(["a","abbr","b","bdo","blockquote","br","caption","cite","code","col","colgroup","dd","del","details","dfn","div","dl","dt","em","figcaption","figure","h1","h2","h3","h4","h5","h6","hr","i","img","input","ins","kbd","label","li","mark","ol","p","pre","q","rp","rt","ruby","samp","small","small","source","span","strike","strong","sub","summary","sup","table","tbody","td","tfoot","th","thead","time","tr","tt","u","ul","var","video","wbr"]),wCe=Object.freeze({ALLOWED_TAGS:["a","button","blockquote","code","div","h1","h2","h3","h4","h5","h6","hr","input","label","li","p","pre","select","small","span","strong","textarea","ul","ol"],ALLOWED_ATTR:["href","data-href","data-command","target","title","name","src","alt","class","id","role","tabindex","style","data-code","width","height","align","x-dispatch","required","checked","placeholder","type","start"],RETURN_DOM:!1,RETURN_DOM_FRAGMENT:!1,RETURN_TRUSTED_TYPE:!0});function w3(o){let e=new Uint16Array(o.length);for(let i=0;i<e.length;i++)e[i]=o.charCodeAt(i);let t="",n=new Uint8Array(e.buffer);for(let i=0;i<n.length;i++)t+=String.fromCharCode(n[i]);return t}function Ah(o){return btoa(w3(o))}var Ph=class o extends D{_subscriptions=new ee;_keyStatus;static instance;constructor(){super(),this._keyStatus={altKey:!1,shiftKey:!1,ctrlKey:!1,metaKey:!1},this._subscriptions.add(q.runAndSubscribe(tk,({window:e,disposables:t})=>this.registerListeners(e,t),{window:Ne,disposables:this._subscriptions}))}registerListeners(e,t){t.add(j(e,"keydown",n=>{if(n.defaultPrevented)return;let i=new mt(n);if(!(i.keyCode===6&&n.repeat)){if(n.altKey&&!this._keyStatus.altKey)this._keyStatus.lastKeyPressed="alt";else if(n.ctrlKey&&!this._keyStatus.ctrlKey)this._keyStatus.lastKeyPressed="ctrl";else if(n.metaKey&&!this._keyStatus.metaKey)this._keyStatus.lastKeyPressed="meta";else if(n.shiftKey&&!this._keyStatus.shiftKey)this._keyStatus.lastKeyPressed="shift";else if(i.keyCode!==6)this._keyStatus.lastKeyPressed=void 0;else return;this._keyStatus.altKey=n.altKey,this._keyStatus.ctrlKey=n.ctrlKey,this._keyStatus.metaKey=n.metaKey,this._keyStatus.shiftKey=n.shiftKey,this._keyStatus.lastKeyPressed&&(this._keyStatus.event=n,this.fire(this._keyStatus))}},!0)),t.add(j(e,"keyup",n=>{n.defaultPrevented||(!n.altKey&&this._keyStatus.altKey?this._keyStatus.lastKeyReleased="alt":!n.ctrlKey&&this._keyStatus.ctrlKey?this._keyStatus.lastKeyReleased="ctrl":!n.metaKey&&this._keyStatus.metaKey?this._keyStatus.lastKeyReleased="meta":!n.shiftKey&&this._keyStatus.shiftKey?this._keyStatus.lastKeyReleased="shift":this._keyStatus.lastKeyReleased=void 0,this._keyStatus.lastKeyPressed!==this._keyStatus.lastKeyReleased&&(this._keyStatus.lastKeyPressed=void 0),this._keyStatus.altKey=n.altKey,this._keyStatus.ctrlKey=n.ctrlKey,this._keyStatus.metaKey=n.metaKey,this._keyStatus.shiftKey=n.shiftKey,this._keyStatus.lastKeyReleased&&(this._keyStatus.event=n,this.fire(this._keyStatus)))},!0)),t.add(j(e.document.body,"mousedown",()=>{this._keyStatus.lastKeyPressed=void 0},!0)),t.add(j(e.document.body,"mouseup",()=>{this._keyStatus.lastKeyPressed=void 0},!0)),t.add(j(e.document.body,"mousemove",n=>{n.buttons&&(this._keyStatus.lastKeyPressed=void 0)},!0)),t.add(j(e,"blur",()=>{this.resetKeyStatus()}))}get keyStatus(){return this._keyStatus}get isModifierPressed(){return this._keyStatus.altKey||this._keyStatus.ctrlKey||this._keyStatus.metaKey||this._keyStatus.shiftKey}resetKeyStatus(){this.doResetKeyStatus(),this.fire(this._keyStatus)}doResetKeyStatus(){this._keyStatus={altKey:!1,shiftKey:!1,ctrlKey:!1,metaKey:!1}}static getInstance(){return o.instance||(o.instance=new o),o.instance}dispose(){super.dispose(),this._subscriptions.dispose()}};var gS=class extends F{constructor(t,n){super();this.element=t;this.callbacks=n;this.registerListeners()}counter=0;dragStartTime=0;registerListeners(){this.callbacks.onDragStart&&this._register(j(this.element,me.DRAG_START,t=>{this.callbacks.onDragStart?.(t)})),this.callbacks.onDrag&&this._register(j(this.element,me.DRAG,t=>{this.callbacks.onDrag?.(t)})),this._register(j(this.element,me.DRAG_ENTER,t=>{this.counter++,this.dragStartTime=t.timeStamp,this.callbacks.onDragEnter?.(t)})),this._register(j(this.element,me.DRAG_OVER,t=>{t.preventDefault(),this.callbacks.onDragOver?.(t,t.timeStamp-this.dragStartTime)})),this._register(j(this.element,me.DRAG_LEAVE,t=>{this.counter--,this.counter===0&&(this.dragStartTime=0,this.callbacks.onDragLeave?.(t))})),this._register(j(this.element,me.DRAG_END,t=>{this.counter=0,this.dragStartTime=0,this.callbacks.onDragEnd?.(t)})),this._register(j(this.element,me.DROP,t=>{this.counter=0,this.dragStartTime=0,this.callbacks.onDrop?.(t)}))}},_3=/(?<tag>[\w\-]+)?(?:#(?<id>[\w\-]+))?(?<class>(?:\.(?:[\w\-]+))*)(?:@(?<name>(?:[\w\_])+))?/;function yt(o,...e){let t,n;Array.isArray(e[0])?(t={},n=e[0]):(t=e[0]||{},n=e[1]);let i=_3.exec(o);if(!i||!i.groups)throw new Error("Bad use of h");let r=i.groups.tag||"div",s=document.createElement(r);i.groups.id&&(s.id=i.groups.id);let a=[];if(i.groups.class)for(let d of i.groups.class.split("."))d!==""&&a.push(d);if(t.className!==void 0)for(let d of t.className.split("."))d!==""&&a.push(d);a.length>0&&(s.className=a.join(" "));let l={};if(i.groups.name&&(l[i.groups.name]=s),n)for(let d of n)Nn(d)?s.appendChild(d):typeof d=="string"?s.append(d):"root"in d&&(Object.assign(l,d),s.appendChild(d.root));for(let[d,c]of Object.entries(t))if(d!=="className")if(d==="style")for(let[u,p]of Object.entries(c))s.style.setProperty(gV(u),typeof p=="number"?p+"px":""+p);else d==="tabIndex"?s.tabIndex=c:s.setAttribute(gV(d),c.toString());return l.root=s,l}function gV(o){return o.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function SS(o,e,t){for(let{name:n,value:i}of o.attributes)(!t||t.includes(n))&&e.setAttribute(n,i)}function D3(o,e,t){let n=o.getAttribute(t);n?e.setAttribute(t,n):e.removeAttribute(t)}function ES(o,e,t){SS(o,e,t);let n=new ee;return n.add(IS.observe(o,n,{attributes:!0,attributeFilter:t})(i=>{for(let r of i)r.type==="attributes"&&r.attributeName&&D3(o,e,r.attributeName)})),n}function rs(o){return o.tagName.toLowerCase()==="input"||o.tagName.toLowerCase()==="textarea"||Nn(o)&&!!o.editContext}var Et;(r=>(r.Tap="-monaco-gesturetap",r.Change="-monaco-gesturechange",r.Start="-monaco-gesturestart",r.End="-monaco-gesturesend",r.Contextmenu="-monaco-gesturecontextmenu"))(Et||={});var Zi=class Zi extends F{static SCROLL_FRICTION=-.005;static INSTANCE;static HOLD_DELAY=700;dispatched=!1;targets=new zi;ignoreTargets=new zi;handle;activeTouches;_lastSetTapCountTime;static CLEAR_TAP_COUNT_TIME=400;constructor(){super(),this.activeTouches={},this.handle=null,this._lastSetTapCountTime=0,this._register(q.runAndSubscribe(tk,({window:e,disposables:t})=>{t.add(j(e.document,"touchstart",n=>this.onTouchStart(n),{passive:!1})),t.add(j(e.document,"touchend",n=>this.onTouchEnd(e,n))),t.add(j(e.document,"touchmove",n=>this.onTouchMove(n),{passive:!1}))},{window:Ne,disposables:this._store}))}static addTarget(e){if(!Zi.isTouchDevice())return F.None;Zi.INSTANCE||(Zi.INSTANCE=dd(new Zi));let t=Zi.INSTANCE.targets.push(e);return le(t)}static ignoreTarget(e){if(!Zi.isTouchDevice())return F.None;Zi.INSTANCE||(Zi.INSTANCE=dd(new Zi));let t=Zi.INSTANCE.ignoreTargets.push(e);return le(t)}static isTouchDevice(){return"ontouchstart"in Ne||navigator.maxTouchPoints>0}dispose(){this.handle&&(this.handle.dispose(),this.handle=null),super.dispose()}onTouchStart(e){let t=Date.now();this.handle&&(this.handle.dispose(),this.handle=null);for(let n=0,i=e.targetTouches.length;n<i;n++){let r=e.targetTouches.item(n);this.activeTouches[r.identifier]={id:r.identifier,initialTarget:r.target,initialTimeStamp:t,initialPageX:r.pageX,initialPageY:r.pageY,rollingTimestamps:[t],rollingPageX:[r.pageX],rollingPageY:[r.pageY]};let s=this.newGestureEvent(Et.Start,r.target);s.pageX=r.pageX,s.pageY=r.pageY,this.dispatchEvent(s)}this.dispatched&&(e.preventDefault(),e.stopPropagation(),this.dispatched=!1)}onTouchEnd(e,t){let n=Date.now(),i=Object.keys(this.activeTouches).length;for(let r=0,s=t.changedTouches.length;r<s;r++){let a=t.changedTouches.item(r);if(!this.activeTouches.hasOwnProperty(String(a.identifier))){console.warn("move of an UNKNOWN touch",a);continue}let l=this.activeTouches[a.identifier],d=Date.now()-l.initialTimeStamp;if(d<Zi.HOLD_DELAY&&Math.abs(l.initialPageX-Do(l.rollingPageX))<30&&Math.abs(l.initialPageY-Do(l.rollingPageY))<30){let c=this.newGestureEvent(Et.Tap,l.initialTarget);c.pageX=Do(l.rollingPageX),c.pageY=Do(l.rollingPageY),this.dispatchEvent(c)}else if(d>=Zi.HOLD_DELAY&&Math.abs(l.initialPageX-Do(l.rollingPageX))<30&&Math.abs(l.initialPageY-Do(l.rollingPageY))<30){let c=this.newGestureEvent(Et.Contextmenu,l.initialTarget);c.pageX=Do(l.rollingPageX),c.pageY=Do(l.rollingPageY),this.dispatchEvent(c)}else if(i===1){let c=Do(l.rollingPageX),u=Do(l.rollingPageY),p=Do(l.rollingTimestamps)-l.rollingTimestamps[0],h=c-l.rollingPageX[0],f=u-l.rollingPageY[0],g=[...this.targets].filter(b=>l.initialTarget instanceof Node&&b.contains(l.initialTarget));this.inertia(e,g,n,Math.abs(h)/p,h>0?1:-1,c,Math.abs(f)/p,f>0?1:-1,u)}this.dispatchEvent(this.newGestureEvent(Et.End,l.initialTarget)),delete this.activeTouches[a.identifier]}this.dispatched&&(t.preventDefault(),t.stopPropagation(),this.dispatched=!1)}newGestureEvent(e,t){let n=document.createEvent("CustomEvent");return n.initEvent(e,!1,!0),n.initialTarget=t,n.tapCount=0,n}dispatchEvent(e){if(e.type===Et.Tap){let t=new Date().getTime(),n=0;t-this._lastSetTapCountTime>Zi.CLEAR_TAP_COUNT_TIME?n=1:n=2,this._lastSetTapCountTime=t,e.tapCount=n}else(e.type===Et.Change||e.type===Et.Contextmenu)&&(this._lastSetTapCountTime=0);if(e.initialTarget instanceof Node){for(let n of this.ignoreTargets)if(n.contains(e.initialTarget))return;let t=[];for(let n of this.targets)if(n.contains(e.initialTarget)){let i=0,r=e.initialTarget;for(;r&&r!==n;)i++,r=r.parentElement;t.push([i,n])}t.sort((n,i)=>n[0]-i[0]);for(let[n,i]of t)i.dispatchEvent(e),this.dispatched=!0}}inertia(e,t,n,i,r,s,a,l,d){this.handle=ni(e,()=>{let c=Date.now(),u=c-n,p=0,h=0,f=!0;i+=Zi.SCROLL_FRICTION*u,a+=Zi.SCROLL_FRICTION*u,i>0&&(f=!1,p=r*i*u),a>0&&(f=!1,h=l*a*u);let g=this.newGestureEvent(Et.Change);g.translationX=p,g.translationY=h,t.forEach(b=>b.dispatchEvent(g)),f||this.inertia(e,t,c,i,r,s+p,a,l,d+h)})}onTouchMove(e){let t=Date.now();for(let n=0,i=e.changedTouches.length;n<i;n++){let r=e.changedTouches.item(n);if(!this.activeTouches.hasOwnProperty(String(r.identifier))){console.warn("end of an UNKNOWN touch",r);continue}let s=this.activeTouches[r.identifier],a=this.newGestureEvent(Et.Change,s.initialTarget);a.translationX=r.pageX-Do(s.rollingPageX),a.translationY=r.pageY-Do(s.rollingPageY),a.pageX=r.pageX,a.pageY=r.pageY,this.dispatchEvent(a),s.rollingPageX.length>3&&(s.rollingPageX.shift(),s.rollingPageY.shift(),s.rollingTimestamps.shift()),s.rollingPageX.push(r.pageX),s.rollingPageY.push(r.pageY),s.rollingTimestamps.push(t)}this.dispatched&&(e.preventDefault(),e.stopPropagation(),this.dispatched=!1)}};O([he],Zi,"isTouchDevice",1);var An=Zi;var Ae=class{emitter;get event(){return this.emitter.event}constructor(e,t,n){let i=r=>this.emitter.fire(r);this.emitter=new D({onWillAddFirstListener:()=>e.addEventListener(t,i,n),onDidRemoveLastListener:()=>e.removeEventListener(t,i,n)})}dispose(){this.emitter.dispose()}};var L3=!1;var R3=4,k3=new D;var M3=300,P3=new D;var xb=class{constructor(e){this.el=e}disposables=new ee;get onPointerMove(){return this.disposables.add(new Ae(Ce(this.el),"mousemove")).event}get onPointerUp(){return this.disposables.add(new Ae(Ce(this.el),"mouseup")).event}dispose(){this.disposables.dispose()}};O([he],xb.prototype,"onPointerMove",1),O([he],xb.prototype,"onPointerUp",1);var wb=class{constructor(e){this.el=e}disposables=new ee;get onPointerMove(){return this.disposables.add(new Ae(this.el,Et.Change)).event}get onPointerUp(){return this.disposables.add(new Ae(this.el,Et.End)).event}dispose(){this.disposables.dispose()}};O([he],wb.prototype,"onPointerMove",1),O([he],wb.prototype,"onPointerUp",1);var Fh=class{constructor(e){this.factory=e}get onPointerMove(){return this.factory.onPointerMove}get onPointerUp(){return this.factory.onPointerUp}dispose(){}};O([he],Fh.prototype,"onPointerMove",1),O([he],Fh.prototype,"onPointerUp",1);var NV="pointer-events-disabled",Eu=class o extends F{el;layoutProvider;orientation;size;hoverDelay=M3;hoverDelayer=this._register(new Ss(this.hoverDelay));_state=3;onDidEnablementChange=this._register(new D);_onDidStart=this._register(new D);_onDidChange=this._register(new D);_onDidReset=this._register(new D);_onDidEnd=this._register(new D);orthogonalStartSashDisposables=this._register(new ee);_orthogonalStartSash;orthogonalStartDragHandleDisposables=this._register(new ee);_orthogonalStartDragHandle;orthogonalEndSashDisposables=this._register(new ee);_orthogonalEndSash;orthogonalEndDragHandleDisposables=this._register(new ee);_orthogonalEndDragHandle;get state(){return this._state}get orthogonalStartSash(){return this._orthogonalStartSash}get orthogonalEndSash(){return this._orthogonalEndSash}set state(e){this._state!==e&&(this.el.classList.toggle("disabled",e===0),this.el.classList.toggle("minimum",e===1),this.el.classList.toggle("maximum",e===2),this._state=e,this.onDidEnablementChange.fire(e))}onDidStart=this._onDidStart.event;onDidChange=this._onDidChange.event;onDidReset=this._onDidReset.event;onDidEnd=this._onDidEnd.event;linkedSash=void 0;set orthogonalStartSash(e){if(this._orthogonalStartSash!==e){if(this.orthogonalStartDragHandleDisposables.clear(),this.orthogonalStartSashDisposables.clear(),e){let t=n=>{this.orthogonalStartDragHandleDisposables.clear(),n!==0&&(this._orthogonalStartDragHandle=dt(this.el,Ge(".orthogonal-drag-handle.start")),this.orthogonalStartDragHandleDisposables.add(le(()=>this._orthogonalStartDragHandle.remove())),this.orthogonalStartDragHandleDisposables.add(new Ae(this._orthogonalStartDragHandle,"mouseenter")).event(()=>o.onMouseEnter(e),void 0,this.orthogonalStartDragHandleDisposables),this.orthogonalStartDragHandleDisposables.add(new Ae(this._orthogonalStartDragHandle,"mouseleave")).event(()=>o.onMouseLeave(e),void 0,this.orthogonalStartDragHandleDisposables))};this.orthogonalStartSashDisposables.add(e.onDidEnablementChange.event(t,this)),t(e.state)}this._orthogonalStartSash=e}}set orthogonalEndSash(e){if(this._orthogonalEndSash!==e){if(this.orthogonalEndDragHandleDisposables.clear(),this.orthogonalEndSashDisposables.clear(),e){let t=n=>{this.orthogonalEndDragHandleDisposables.clear(),n!==0&&(this._orthogonalEndDragHandle=dt(this.el,Ge(".orthogonal-drag-handle.end")),this.orthogonalEndDragHandleDisposables.add(le(()=>this._orthogonalEndDragHandle.remove())),this.orthogonalEndDragHandleDisposables.add(new Ae(this._orthogonalEndDragHandle,"mouseenter")).event(()=>o.onMouseEnter(e),void 0,this.orthogonalEndDragHandleDisposables),this.orthogonalEndDragHandleDisposables.add(new Ae(this._orthogonalEndDragHandle,"mouseleave")).event(()=>o.onMouseLeave(e),void 0,this.orthogonalEndDragHandleDisposables))};this.orthogonalEndSashDisposables.add(e.onDidEnablementChange.event(t,this)),t(e.state)}this._orthogonalEndSash=e}}constructor(e,t,n){super(),this.el=dt(e,Ge(".monaco-sash")),n.orthogonalEdge&&this.el.classList.add(`orthogonal-edge-${n.orthogonalEdge}`),Ve&&this.el.classList.add("mac");let i=this._register(new Ae(this.el,"mousedown")).event;this._register(i(u=>this.onPointerStart(u,new xb(e)),this));let r=this._register(new Ae(this.el,"dblclick")).event;this._register(r(this.onPointerDoublePress,this));let s=this._register(new Ae(this.el,"mouseenter")).event;this._register(s(()=>o.onMouseEnter(this)));let a=this._register(new Ae(this.el,"mouseleave")).event;this._register(a(()=>o.onMouseLeave(this))),this._register(An.addTarget(this.el));let l=this._register(new Ae(this.el,Et.Start)).event;this._register(l(u=>this.onPointerStart(u,new wb(this.el)),this));let d=this._register(new Ae(this.el,Et.Tap)).event,c;this._register(d(u=>{if(c){clearTimeout(c),c=void 0,this.onPointerDoublePress(u);return}clearTimeout(c),c=setTimeout(()=>c=void 0,250)},this)),typeof n.size=="number"?(this.size=n.size,n.orientation===0?this.el.style.width=`${this.size}px`:this.el.style.height=`${this.size}px`):(this.size=R3,this._register(k3.event(u=>{this.size=u,this.layout()}))),this._register(P3.event(u=>this.hoverDelay=u)),this.layoutProvider=t,this.orthogonalStartSash=n.orthogonalStartSash,this.orthogonalEndSash=n.orthogonalEndSash,this.orientation=n.orientation||0,this.orientation===1?(this.el.classList.add("horizontal"),this.el.classList.remove("vertical")):(this.el.classList.remove("horizontal"),this.el.classList.add("vertical")),this.el.classList.toggle("debug",L3),this.layout()}onPointerStart(e,t){st.stop(e);let n=!1;if(!e.__orthogonalSashEvent){let f=this.getOrthogonalSash(e);f&&(n=!0,e.__orthogonalSashEvent=!0,f.onPointerStart(e,new Fh(t)))}if(this.linkedSash&&!e.__linkedSashEvent&&(e.__linkedSashEvent=!0,this.linkedSash.onPointerStart(e,new Fh(t))),!this.state)return;let i=this.el.ownerDocument.getElementsByTagName("iframe");for(let f of i)f.classList.add(NV);let r=e.pageX,s=e.pageY,a=e.altKey,l={startX:r,currentX:r,startY:s,currentY:s,altKey:a};this.el.classList.add("active"),this._onDidStart.fire(l);let d=ur(this.el),c=()=>{let f="";n?f="all-scroll":this.orientation===1?this.state===1?f="s-resize":this.state===2?f="n-resize":f=Ve?"row-resize":"ns-resize":this.state===1?f="e-resize":this.state===2?f="w-resize":f=Ve?"col-resize":"ew-resize",d.textContent=`* { cursor: ${f} !important; }`},u=new ee;c(),n||this.onDidEnablementChange.event(c,null,u);let p=f=>{st.stop(f,!1);let g={startX:r,currentX:f.pageX,startY:s,currentY:f.pageY,altKey:a};this._onDidChange.fire(g)},h=f=>{st.stop(f,!1),d.remove(),this.el.classList.remove("active"),this._onDidEnd.fire(),u.dispose();for(let g of i)g.classList.remove(NV)};t.onPointerMove(p,null,u),t.onPointerUp(h,null,u),u.add(t)}onPointerDoublePress(e){let t=this.getOrthogonalSash(e);t&&t._onDidReset.fire(),this.linkedSash&&this.linkedSash._onDidReset.fire(),this._onDidReset.fire()}static onMouseEnter(e,t=!1){e.el.classList.contains("active")?(e.hoverDelayer.cancel(),e.el.classList.add("hover")):e.hoverDelayer.trigger(()=>e.el.classList.add("hover"),e.hoverDelay).then(void 0,()=>{}),!t&&e.linkedSash&&o.onMouseEnter(e.linkedSash,!0)}static onMouseLeave(e,t=!1){e.hoverDelayer.cancel(),e.el.classList.remove("hover"),!t&&e.linkedSash&&o.onMouseLeave(e.linkedSash,!0)}clearSashHoverState(){o.onMouseLeave(this)}layout(){if(this.orientation===0){let e=this.layoutProvider;this.el.style.left=e.getVerticalSashLeft(this)-this.size/2+"px",e.getVerticalSashTop&&(this.el.style.top=e.getVerticalSashTop(this)+"px"),e.getVerticalSashHeight&&(this.el.style.height=e.getVerticalSashHeight(this)+"px")}else{let e=this.layoutProvider;this.el.style.top=e.getHorizontalSashTop(this)-this.size/2+"px",e.getHorizontalSashLeft&&(this.el.style.left=e.getHorizontalSashLeft(this)+"px"),e.getHorizontalSashWidth&&(this.el.style.width=e.getHorizontalSashWidth(this)+"px")}}getOrthogonalSash(e){let t=e.initialTarget??e.target;if(!(!t||!Nn(t))&&t.classList.contains("orthogonal-drag-handle"))return t.classList.contains("start")?this.orthogonalStartSash:this.orthogonalEndSash}dispose(){super.dispose(),this.el.remove()}};var Bh=class extends F{_onDidChange=this._register(new D);onDidChange=this._onDidChange.event;_referenceDomElement;_width;_height;_resizeObserver;constructor(e,t){super(),this._referenceDomElement=e,this._width=-1,this._height=-1,this._resizeObserver=null,this.measureReferenceDomElement(!1,t)}dispose(){this.stopObserving(),super.dispose()}getWidth(){return this._width}getHeight(){return this._height}startObserving(){if(!this._resizeObserver&&this._referenceDomElement){let e=null,t=()=>{e?this.observe({width:e.width,height:e.height}):this.observe()},n=!1,i=!1,r=()=>{if(n&&!i)try{n=!1,i=!0,t()}finally{ni(Ce(this._referenceDomElement),()=>{i=!1,r()})}};this._resizeObserver=new ResizeObserver(s=>{s&&s[0]&&s[0].contentRect?e={width:s[0].contentRect.width,height:s[0].contentRect.height}:e=null,n=!0,r()}),this._resizeObserver.observe(this._referenceDomElement)}}stopObserving(){this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=null)}observe(e){this.measureReferenceDomElement(!0,e)}measureReferenceDomElement(e,t){let n=0,i=0;t?(n=t.width,i=t.height):this._referenceDomElement&&(n=this._referenceDomElement.clientWidth,i=this._referenceDomElement.clientHeight),n=Math.max(5,n),i=Math.max(5,i),(this._width!==n||this._height!==i)&&(this._width=n,this._height=i,e&&this._onDidChange.fire())}};var dk=class extends F{_onDidChange=this._register(new D);onDidChange=this._onDidChange.event;_listener;_mediaQueryList;constructor(e){super(),this._listener=()=>this._handleChange(e,!0),this._mediaQueryList=null,this._handleChange(e,!1)}_handleChange(e,t){this._mediaQueryList?.removeEventListener("change",this._listener),this._mediaQueryList=e.matchMedia(`(resolution: ${e.devicePixelRatio}dppx)`),this._mediaQueryList.addEventListener("change",this._listener),t&&this._onDidChange.fire()}},ck=class extends F{_onDidChange=this._register(new D);onDidChange=this._onDidChange.event;_value;get value(){return this._value}constructor(e){super(),this._value=this._getPixelRatio(e);let t=this._register(new dk(e));this._register(t.onDidChange(()=>{this._value=this._getPixelRatio(e),this._onDidChange.fire(this._value)}))}_getPixelRatio(e){let t=document.createElement("canvas").getContext("2d"),n=e.devicePixelRatio||1,i=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return n/i}},uk=class{mapWindowIdToPixelRatioMonitor=new Map;_getOrCreatePixelRatioMonitor(e){let t=$d(e),n=this.mapWindowIdToPixelRatioMonitor.get(t);return n||(n=dd(new ck(e)),this.mapWindowIdToPixelRatioMonitor.set(t,n),dd(q.once(bV)(({vscodeWindowId:i})=>{i===t&&(n?.dispose(),this.mapWindowIdToPixelRatioMonitor.delete(t))}))),n}getInstance(e){return this._getOrCreatePixelRatioMonitor(e)}},Vh=new uk;var Tu=class{constructor(e){this.domNode=e}_maxWidth="";_width="";_height="";_top="";_left="";_bottom="";_right="";_paddingTop="";_paddingLeft="";_paddingBottom="";_paddingRight="";_fontFamily="";_fontWeight="";_fontSize="";_fontStyle="";_fontFeatureSettings="";_fontVariationSettings="";_textDecoration="";_lineHeight="";_letterSpacing="";_className="";_display="";_position="";_visibility="";_color="";_backgroundColor="";_layerHint=!1;_contain="none";_boxShadow="";setMaxWidth(e){let t=pr(e);this._maxWidth!==t&&(this._maxWidth=t,this.domNode.style.maxWidth=this._maxWidth)}setWidth(e){let t=pr(e);this._width!==t&&(this._width=t,this.domNode.style.width=this._width)}setHeight(e){let t=pr(e);this._height!==t&&(this._height=t,this.domNode.style.height=this._height)}setTop(e){let t=pr(e);this._top!==t&&(this._top=t,this.domNode.style.top=this._top)}setLeft(e){let t=pr(e);this._left!==t&&(this._left=t,this.domNode.style.left=this._left)}setBottom(e){let t=pr(e);this._bottom!==t&&(this._bottom=t,this.domNode.style.bottom=this._bottom)}setRight(e){let t=pr(e);this._right!==t&&(this._right=t,this.domNode.style.right=this._right)}setPaddingTop(e){let t=pr(e);this._paddingTop!==t&&(this._paddingTop=t,this.domNode.style.paddingTop=this._paddingTop)}setPaddingLeft(e){let t=pr(e);this._paddingLeft!==t&&(this._paddingLeft=t,this.domNode.style.paddingLeft=this._paddingLeft)}setPaddingBottom(e){let t=pr(e);this._paddingBottom!==t&&(this._paddingBottom=t,this.domNode.style.paddingBottom=this._paddingBottom)}setPaddingRight(e){let t=pr(e);this._paddingRight!==t&&(this._paddingRight=t,this.domNode.style.paddingRight=this._paddingRight)}setFontFamily(e){this._fontFamily!==e&&(this._fontFamily=e,this.domNode.style.fontFamily=this._fontFamily)}setFontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.domNode.style.fontWeight=this._fontWeight)}setFontSize(e){let t=pr(e);this._fontSize!==t&&(this._fontSize=t,this.domNode.style.fontSize=this._fontSize)}setFontStyle(e){this._fontStyle!==e&&(this._fontStyle=e,this.domNode.style.fontStyle=this._fontStyle)}setFontFeatureSettings(e){this._fontFeatureSettings!==e&&(this._fontFeatureSettings=e,this.domNode.style.fontFeatureSettings=this._fontFeatureSettings)}setFontVariationSettings(e){this._fontVariationSettings!==e&&(this._fontVariationSettings=e,this.domNode.style.fontVariationSettings=this._fontVariationSettings)}setTextDecoration(e){this._textDecoration!==e&&(this._textDecoration=e,this.domNode.style.textDecoration=this._textDecoration)}setLineHeight(e){let t=pr(e);this._lineHeight!==t&&(this._lineHeight=t,this.domNode.style.lineHeight=this._lineHeight)}setLetterSpacing(e){let t=pr(e);this._letterSpacing!==t&&(this._letterSpacing=t,this.domNode.style.letterSpacing=this._letterSpacing)}setClassName(e){this._className!==e&&(this._className=e,this.domNode.className=this._className)}toggleClassName(e,t){this.domNode.classList.toggle(e,t),this._className=this.domNode.className}setDisplay(e){this._display!==e&&(this._display=e,this.domNode.style.display=this._display)}setPosition(e){this._position!==e&&(this._position=e,this.domNode.style.position=this._position)}setVisibility(e){this._visibility!==e&&(this._visibility=e,this.domNode.style.visibility=this._visibility)}setColor(e){this._color!==e&&(this._color=e,this.domNode.style.color=this._color)}setBackgroundColor(e){this._backgroundColor!==e&&(this._backgroundColor=e,this.domNode.style.backgroundColor=this._backgroundColor)}setLayerHinting(e){this._layerHint!==e&&(this._layerHint=e,this.domNode.style.transform=this._layerHint?"translate3d(0px, 0px, 0px)":"")}setBoxShadow(e){this._boxShadow!==e&&(this._boxShadow=e,this.domNode.style.boxShadow=e)}setContain(e){this._contain!==e&&(this._contain=e,this.domNode.style.contain=this._contain)}setAttribute(e,t){this.domNode.setAttribute(e,t)}removeAttribute(e){this.domNode.removeAttribute(e)}appendChild(e){this.domNode.appendChild(e.domNode)}removeChild(e){this.domNode.removeChild(e.domNode)}};function pr(o){return typeof o=="number"?`${o}px`:o}function We(o){return new Tu(o)}function on(o,e){o instanceof Tu?(o.setFontFamily(e.getMassagedFontFamily()),o.setFontWeight(e.fontWeight),o.setFontSize(e.fontSize),o.setFontFeatureSettings(e.fontFeatureSettings),o.setFontVariationSettings(e.fontVariationSettings),o.setLineHeight(e.lineHeight),o.setLetterSpacing(e.letterSpacing)):(o.style.fontFamily=e.getMassagedFontFamily(),o.style.fontWeight=e.fontWeight,o.style.fontSize=e.fontSize+"px",o.style.fontFeatureSettings=e.fontFeatureSettings,o.style.fontVariationSettings=e.fontVariationSettings,o.style.lineHeight=e.lineHeight+"px",o.style.letterSpacing=e.letterSpacing+"px")}var TS=class{chr;type;width;constructor(e,t){this.chr=e,this.type=t,this.width=0}fulfill(e){this.width=e}},pk=class o{_bareFontInfo;_requests;_container;_testElements;constructor(e,t){this._bareFontInfo=e,this._requests=t,this._container=null,this._testElements=null}read(e){this._createDomElements(),e.document.body.appendChild(this._container),this._readFromDomElements(),this._container?.remove(),this._container=null,this._testElements=null}_createDomElements(){let e=document.createElement("div");e.style.position="absolute",e.style.top="-50000px",e.style.width="50000px";let t=document.createElement("div");on(t,this._bareFontInfo),e.appendChild(t);let n=document.createElement("div");on(n,this._bareFontInfo),n.style.fontWeight="bold",e.appendChild(n);let i=document.createElement("div");on(i,this._bareFontInfo),i.style.fontStyle="italic",e.appendChild(i);let r=[];for(let s of this._requests){let a;s.type===0&&(a=t),s.type===2&&(a=n),s.type===1&&(a=i),a.appendChild(document.createElement("br"));let l=document.createElement("span");o._render(l,s),a.appendChild(l),r.push(l)}this._container=e,this._testElements=r}static _render(e,t){if(t.chr===" "){let n="\xA0";for(let i=0;i<8;i++)n+=n;e.innerText=n}else{let n=t.chr;for(let i=0;i<8;i++)n+=n;e.textContent=n}}_readFromDomElements(){for(let e=0,t=this._requests.length;e<t;e++){let n=this._requests[e],i=this._testElements[e];n.fulfill(i.offsetWidth/256)}}};function AV(o,e,t){new pk(e,t).read(o)}var hk=class extends F{_cache=new Map;_evictUntrustedReadingsTimeout=-1;_onDidChange=this._register(new D);onDidChange=this._onDidChange.event;dispose(){this._evictUntrustedReadingsTimeout!==-1&&(clearTimeout(this._evictUntrustedReadingsTimeout),this._evictUntrustedReadingsTimeout=-1),super.dispose()}clearAllFontInfos(){this._cache.clear(),this._onDidChange.fire()}_ensureCache(e){let t=$d(e),n=this._cache.get(t);return n||(n=new mk,this._cache.set(t,n)),n}_writeToCache(e,t,n){this._ensureCache(e).put(t,n),!n.isTrusted&&this._evictUntrustedReadingsTimeout===-1&&(this._evictUntrustedReadingsTimeout=e.setTimeout(()=>{this._evictUntrustedReadingsTimeout=-1,this._evictUntrustedReadings(e)},5e3))}_evictUntrustedReadings(e){let t=this._ensureCache(e),n=t.getValues(),i=!1;for(let r of n)r.isTrusted||(i=!0,t.remove(r));i&&this._onDidChange.fire()}serializeFontInfo(e){return this._ensureCache(e).getValues().filter(n=>n.isTrusted)}restoreFontInfo(e,t){for(let n of t){if(n.version!==mR)continue;let i=new lh(n,!1);this._writeToCache(e,i,i)}}readFontInfo(e,t){let n=this._ensureCache(e);if(!n.has(t)){let i=this._actualReadFontInfo(e,t);(i.typicalHalfwidthCharacterWidth<=2||i.typicalFullwidthCharacterWidth<=2||i.spaceWidth<=2||i.maxDigitWidth<=2)&&(i=new lh({pixelRatio:Vh.getInstance(e).value,fontFamily:i.fontFamily,fontWeight:i.fontWeight,fontSize:i.fontSize,fontFeatureSettings:i.fontFeatureSettings,fontVariationSettings:i.fontVariationSettings,lineHeight:i.lineHeight,letterSpacing:i.letterSpacing,isMonospace:i.isMonospace,typicalHalfwidthCharacterWidth:Math.max(i.typicalHalfwidthCharacterWidth,5),typicalFullwidthCharacterWidth:Math.max(i.typicalFullwidthCharacterWidth,5),canUseHalfwidthRightwardsArrow:i.canUseHalfwidthRightwardsArrow,spaceWidth:Math.max(i.spaceWidth,5),middotWidth:Math.max(i.middotWidth,5),wsmiddotWidth:Math.max(i.wsmiddotWidth,5),maxDigitWidth:Math.max(i.maxDigitWidth,5)},!1)),this._writeToCache(e,t,i)}return n.get(t)}_createRequest(e,t,n,i){let r=new TS(e,t);return n.push(r),i?.push(r),r}_actualReadFontInfo(e,t){let n=[],i=[],r=this._createRequest("n",0,n,i),s=this._createRequest("\uFF4D",0,n,null),a=this._createRequest(" ",0,n,i),l=this._createRequest("0",0,n,i),d=this._createRequest("1",0,n,i),c=this._createRequest("2",0,n,i),u=this._createRequest("3",0,n,i),p=this._createRequest("4",0,n,i),h=this._createRequest("5",0,n,i),f=this._createRequest("6",0,n,i),g=this._createRequest("7",0,n,i),b=this._createRequest("8",0,n,i),v=this._createRequest("9",0,n,i),y=this._createRequest("\u2192",0,n,i),S=this._createRequest("\uFFEB",0,n,null),E=this._createRequest("\xB7",0,n,i),C=this._createRequest("\u2E31",0,n,null),w="|/-_ilm%";for(let K=0,U=w.length;K<U;K++)this._createRequest(w.charAt(K),0,n,i),this._createRequest(w.charAt(K),1,n,i),this._createRequest(w.charAt(K),2,n,i);AV(e,t,n);let _=Math.max(l.width,d.width,c.width,u.width,p.width,h.width,f.width,g.width,b.width,v.width),L=t.fontFeatureSettings===_s.OFF,k=i[0].width;for(let K=1,U=i.length;L&&K<U;K++){let oe=k-i[K].width;if(oe<-.001||oe>.001){L=!1;break}}let W=!0;return L&&S.width!==k&&(W=!1),S.width>y.width&&(W=!1),new lh({pixelRatio:Vh.getInstance(e).value,fontFamily:t.fontFamily,fontWeight:t.fontWeight,fontSize:t.fontSize,fontFeatureSettings:t.fontFeatureSettings,fontVariationSettings:t.fontVariationSettings,lineHeight:t.lineHeight,letterSpacing:t.letterSpacing,isMonospace:L,typicalHalfwidthCharacterWidth:r.width,typicalFullwidthCharacterWidth:s.width,canUseHalfwidthRightwardsArrow:W,spaceWidth:a.width,middotWidth:E.width,wsmiddotWidth:C.width,maxDigitWidth:_},!0)}},mk=class{_keys;_values;constructor(){this._keys=Object.create(null),this._values=Object.create(null)}has(e){let t=e.getId();return!!this._values[t]}get(e){let t=e.getId();return this._values[t]}put(e,t){let n=e.getId();this._keys[n]=e,this._values[n]=t}remove(e){let t=e.getId();delete this._keys[t],delete this._values[t]}getValues(){return Object.keys(this._keys).map(e=>this._values[e])}},gk=new hk;var _b=class o{constructor(e,t){this.key=e;this.migrate=t}static items=[];apply(e){let t=o._read(e,this.key),n=r=>o._read(e,r),i=(r,s)=>o._write(e,r,s);this.migrate(t,n,i)}static _read(e,t){if(typeof e>"u")return;let n=t.indexOf(".");if(n>=0){let i=t.substring(0,n);return this._read(e[i],t.substring(n+1))}return e[t]}static _write(e,t,n){let i=t.indexOf(".");if(i>=0){let r=t.substring(0,i);e[r]=e[r]||{},this._write(e[r],t.substring(i+1),n);return}e[t]=n}};function As(o,e){_b.items.push(new _b(o,e))}function Uo(o,e){As(o,(t,n,i)=>{if(typeof t<"u"){for(let[r,s]of e)if(t===r){i(o,s);return}}})}function FV(o){_b.items.forEach(e=>e.apply(o))}Uo("wordWrap",[[!0,"on"],[!1,"off"]]);Uo("lineNumbers",[[!0,"on"],[!1,"off"]]);Uo("cursorBlinking",[["visible","solid"]]);Uo("renderWhitespace",[[!0,"boundary"],[!1,"none"]]);Uo("renderLineHighlight",[[!0,"line"],[!1,"none"]]);Uo("acceptSuggestionOnEnter",[[!0,"on"],[!1,"off"]]);Uo("tabCompletion",[[!1,"off"],[!0,"onlySnippets"]]);Uo("hover",[[!0,{enabled:!0}],[!1,{enabled:!1}]]);Uo("parameterHints",[[!0,{enabled:!0}],[!1,{enabled:!1}]]);Uo("autoIndent",[[!1,"advanced"],[!0,"full"]]);Uo("matchBrackets",[[!0,"always"],[!1,"never"]]);Uo("renderFinalNewline",[[!0,"on"],[!1,"off"]]);Uo("cursorSmoothCaretAnimation",[[!0,"on"],[!1,"off"]]);Uo("occurrencesHighlight",[[!0,"singleFile"],[!1,"off"]]);Uo("wordBasedSuggestions",[[!0,"matchingDocuments"],[!1,"off"]]);As("autoClosingBrackets",(o,e,t)=>{o===!1&&(t("autoClosingBrackets","never"),typeof e("autoClosingQuotes")>"u"&&t("autoClosingQuotes","never"),typeof e("autoSurround")>"u"&&t("autoSurround","never"))});As("renderIndentGuides",(o,e,t)=>{typeof o<"u"&&(t("renderIndentGuides",void 0),typeof e("guides.indentation")>"u"&&t("guides.indentation",!!o))});As("highlightActiveIndentGuide",(o,e,t)=>{typeof o<"u"&&(t("highlightActiveIndentGuide",void 0),typeof e("guides.highlightActiveIndentation")>"u"&&t("guides.highlightActiveIndentation",!!o))});var O3={method:"showMethods",function:"showFunctions",constructor:"showConstructors",deprecated:"showDeprecated",field:"showFields",variable:"showVariables",class:"showClasses",struct:"showStructs",interface:"showInterfaces",module:"showModules",property:"showProperties",event:"showEvents",operator:"showOperators",unit:"showUnits",value:"showValues",constant:"showConstants",enum:"showEnums",enumMember:"showEnumMembers",keyword:"showKeywords",text:"showWords",color:"showColors",file:"showFiles",reference:"showReferences",folder:"showFolders",typeParameter:"showTypeParameters",snippet:"showSnippets"};As("suggest.filteredTypes",(o,e,t)=>{if(o&&typeof o=="object"){for(let n of Object.entries(O3))o[n[0]]===!1&&typeof e(`suggest.${n[1]}`)>"u"&&t(`suggest.${n[1]}`,!1);t("suggest.filteredTypes",void 0)}});As("quickSuggestions",(o,e,t)=>{if(typeof o=="boolean"){let n=o?"on":"off";t("quickSuggestions",{comments:n,strings:n,other:n})}});As("experimental.stickyScroll.enabled",(o,e,t)=>{typeof o=="boolean"&&(t("experimental.stickyScroll.enabled",void 0),typeof e("stickyScroll.enabled")>"u"&&t("stickyScroll.enabled",o))});As("experimental.stickyScroll.maxLineCount",(o,e,t)=>{typeof o=="number"&&(t("experimental.stickyScroll.maxLineCount",void 0),typeof e("stickyScroll.maxLineCount")>"u"&&t("stickyScroll.maxLineCount",o))});As("codeActionsOnSave",(o,e,t)=>{if(o&&typeof o=="object"){let n=!1,i={};for(let r of Object.entries(o))typeof r[1]=="boolean"?(n=!0,i[r[0]]=r[1]?"explicit":"never"):i[r[0]]=r[1];n&&t("codeActionsOnSave",i)}});As("codeActionWidget.includeNearbyQuickfixes",(o,e,t)=>{typeof o=="boolean"&&(t("codeActionWidget.includeNearbyQuickfixes",void 0),typeof e("codeActionWidget.includeNearbyQuickFixes")>"u"&&t("codeActionWidget.includeNearbyQuickFixes",o))});As("lightbulb.enabled",(o,e,t)=>{typeof o=="boolean"&&t("lightbulb.enabled",o?void 0:"off")});var fk=class{_tabFocus=!1;_onDidChangeTabFocus=new D;onDidChangeTabFocus=this._onDidChangeTabFocus.event;getTabFocusMode(){return this._tabFocus}setTabFocusMode(e){this._tabFocus=e,this._onDidChangeTabFocus.fire(this._tabFocus)}},Wh=new fk;function Hh(o){return o.command!==void 0}function BV(o){return o.submenu!==void 0}var bi=class o{static _instances=new Map;static CommandPalette=new o("CommandPalette");static DebugBreakpointsContext=new o("DebugBreakpointsContext");static DebugCallStackContext=new o("DebugCallStackContext");static DebugConsoleContext=new o("DebugConsoleContext");static DebugVariablesContext=new o("DebugVariablesContext");static NotebookVariablesContext=new o("NotebookVariablesContext");static DebugHoverContext=new o("DebugHoverContext");static DebugWatchContext=new o("DebugWatchContext");static DebugToolBar=new o("DebugToolBar");static DebugToolBarStop=new o("DebugToolBarStop");static DebugCallStackToolbar=new o("DebugCallStackToolbar");static DebugCreateConfiguration=new o("DebugCreateConfiguration");static EditorContext=new o("EditorContext");static SimpleEditorContext=new o("SimpleEditorContext");static EditorContent=new o("EditorContent");static EditorLineNumberContext=new o("EditorLineNumberContext");static EditorContextCopy=new o("EditorContextCopy");static EditorContextPeek=new o("EditorContextPeek");static EditorContextShare=new o("EditorContextShare");static EditorTitle=new o("EditorTitle");static EditorTitleRun=new o("EditorTitleRun");static EditorTitleContext=new o("EditorTitleContext");static EditorTitleContextShare=new o("EditorTitleContextShare");static EmptyEditorGroup=new o("EmptyEditorGroup");static EmptyEditorGroupContext=new o("EmptyEditorGroupContext");static EditorTabsBarContext=new o("EditorTabsBarContext");static EditorTabsBarShowTabsSubmenu=new o("EditorTabsBarShowTabsSubmenu");static EditorTabsBarShowTabsZenModeSubmenu=new o("EditorTabsBarShowTabsZenModeSubmenu");static EditorActionsPositionSubmenu=new o("EditorActionsPositionSubmenu");static ExplorerContext=new o("ExplorerContext");static ExplorerContextShare=new o("ExplorerContextShare");static ExtensionContext=new o("ExtensionContext");static ExtensionEditorContextMenu=new o("ExtensionEditorContextMenu");static GlobalActivity=new o("GlobalActivity");static CommandCenter=new o("CommandCenter");static CommandCenterCenter=new o("CommandCenterCenter");static LayoutControlMenuSubmenu=new o("LayoutControlMenuSubmenu");static LayoutControlMenu=new o("LayoutControlMenu");static MenubarMainMenu=new o("MenubarMainMenu");static MenubarAppearanceMenu=new o("MenubarAppearanceMenu");static MenubarDebugMenu=new o("MenubarDebugMenu");static MenubarEditMenu=new o("MenubarEditMenu");static MenubarCopy=new o("MenubarCopy");static MenubarFileMenu=new o("MenubarFileMenu");static MenubarGoMenu=new o("MenubarGoMenu");static MenubarHelpMenu=new o("MenubarHelpMenu");static MenubarLayoutMenu=new o("MenubarLayoutMenu");static MenubarNewBreakpointMenu=new o("MenubarNewBreakpointMenu");static PanelAlignmentMenu=new o("PanelAlignmentMenu");static PanelPositionMenu=new o("PanelPositionMenu");static ActivityBarPositionMenu=new o("ActivityBarPositionMenu");static MenubarPreferencesMenu=new o("MenubarPreferencesMenu");static MenubarRecentMenu=new o("MenubarRecentMenu");static MenubarSelectionMenu=new o("MenubarSelectionMenu");static MenubarShare=new o("MenubarShare");static MenubarSwitchEditorMenu=new o("MenubarSwitchEditorMenu");static MenubarSwitchGroupMenu=new o("MenubarSwitchGroupMenu");static MenubarTerminalMenu=new o("MenubarTerminalMenu");static MenubarViewMenu=new o("MenubarViewMenu");static MenubarHomeMenu=new o("MenubarHomeMenu");static OpenEditorsContext=new o("OpenEditorsContext");static OpenEditorsContextShare=new o("OpenEditorsContextShare");static ProblemsPanelContext=new o("ProblemsPanelContext");static SCMInputBox=new o("SCMInputBox");static SCMChangesContext=new o("SCMChangesContext");static SCMChangeContext=new o("SCMChangeContext");static SCMResourceContext=new o("SCMResourceContext");static SCMResourceContextShare=new o("SCMResourceContextShare");static SCMResourceFolderContext=new o("SCMResourceFolderContext");static SCMResourceGroupContext=new o("SCMResourceGroupContext");static SCMSourceControl=new o("SCMSourceControl");static SCMSourceControlInline=new o("SCMSourceControlInline");static SCMSourceControlTitle=new o("SCMSourceControlTitle");static SCMHistoryTitle=new o("SCMHistoryTitle");static SCMTitle=new o("SCMTitle");static SearchContext=new o("SearchContext");static SearchActionMenu=new o("SearchActionContext");static StatusBarWindowIndicatorMenu=new o("StatusBarWindowIndicatorMenu");static StatusBarRemoteIndicatorMenu=new o("StatusBarRemoteIndicatorMenu");static StickyScrollContext=new o("StickyScrollContext");static TestItem=new o("TestItem");static TestItemGutter=new o("TestItemGutter");static TestProfilesContext=new o("TestProfilesContext");static TestMessageContext=new o("TestMessageContext");static TestMessageContent=new o("TestMessageContent");static TestPeekElement=new o("TestPeekElement");static TestPeekTitle=new o("TestPeekTitle");static TestCallStack=new o("TestCallStack");static TouchBarContext=new o("TouchBarContext");static TitleBarContext=new o("TitleBarContext");static TitleBarTitleContext=new o("TitleBarTitleContext");static TunnelContext=new o("TunnelContext");static TunnelPrivacy=new o("TunnelPrivacy");static TunnelProtocol=new o("TunnelProtocol");static TunnelPortInline=new o("TunnelInline");static TunnelTitle=new o("TunnelTitle");static TunnelLocalAddressInline=new o("TunnelLocalAddressInline");static TunnelOriginInline=new o("TunnelOriginInline");static ViewItemContext=new o("ViewItemContext");static ViewContainerTitle=new o("ViewContainerTitle");static ViewContainerTitleContext=new o("ViewContainerTitleContext");static ViewTitle=new o("ViewTitle");static ViewTitleContext=new o("ViewTitleContext");static CommentEditorActions=new o("CommentEditorActions");static CommentThreadTitle=new o("CommentThreadTitle");static CommentThreadActions=new o("CommentThreadActions");static CommentThreadAdditionalActions=new o("CommentThreadAdditionalActions");static CommentThreadTitleContext=new o("CommentThreadTitleContext");static CommentThreadCommentContext=new o("CommentThreadCommentContext");static CommentTitle=new o("CommentTitle");static CommentActions=new o("CommentActions");static CommentsViewThreadActions=new o("CommentsViewThreadActions");static InteractiveToolbar=new o("InteractiveToolbar");static InteractiveCellTitle=new o("InteractiveCellTitle");static InteractiveCellDelete=new o("InteractiveCellDelete");static InteractiveCellExecute=new o("InteractiveCellExecute");static InteractiveInputExecute=new o("InteractiveInputExecute");static InteractiveInputConfig=new o("InteractiveInputConfig");static ReplInputExecute=new o("ReplInputExecute");static IssueReporter=new o("IssueReporter");static NotebookToolbar=new o("NotebookToolbar");static NotebookStickyScrollContext=new o("NotebookStickyScrollContext");static NotebookCellTitle=new o("NotebookCellTitle");static NotebookCellDelete=new o("NotebookCellDelete");static NotebookCellInsert=new o("NotebookCellInsert");static NotebookCellBetween=new o("NotebookCellBetween");static NotebookCellListTop=new o("NotebookCellTop");static NotebookCellExecute=new o("NotebookCellExecute");static NotebookCellExecuteGoTo=new o("NotebookCellExecuteGoTo");static NotebookCellExecutePrimary=new o("NotebookCellExecutePrimary");static NotebookDiffCellInputTitle=new o("NotebookDiffCellInputTitle");static NotebookDiffCellMetadataTitle=new o("NotebookDiffCellMetadataTitle");static NotebookDiffCellOutputsTitle=new o("NotebookDiffCellOutputsTitle");static NotebookOutputToolbar=new o("NotebookOutputToolbar");static NotebookOutlineFilter=new o("NotebookOutlineFilter");static NotebookOutlineActionMenu=new o("NotebookOutlineActionMenu");static NotebookEditorLayoutConfigure=new o("NotebookEditorLayoutConfigure");static NotebookKernelSource=new o("NotebookKernelSource");static BulkEditTitle=new o("BulkEditTitle");static BulkEditContext=new o("BulkEditContext");static TimelineItemContext=new o("TimelineItemContext");static TimelineTitle=new o("TimelineTitle");static TimelineTitleContext=new o("TimelineTitleContext");static TimelineFilterSubMenu=new o("TimelineFilterSubMenu");static AccountsContext=new o("AccountsContext");static SidebarTitle=new o("SidebarTitle");static PanelTitle=new o("PanelTitle");static AuxiliaryBarTitle=new o("AuxiliaryBarTitle");static AuxiliaryBarHeader=new o("AuxiliaryBarHeader");static TerminalInstanceContext=new o("TerminalInstanceContext");static TerminalEditorInstanceContext=new o("TerminalEditorInstanceContext");static TerminalNewDropdownContext=new o("TerminalNewDropdownContext");static TerminalTabContext=new o("TerminalTabContext");static TerminalTabEmptyAreaContext=new o("TerminalTabEmptyAreaContext");static TerminalStickyScrollContext=new o("TerminalStickyScrollContext");static WebviewContext=new o("WebviewContext");static InlineCompletionsActions=new o("InlineCompletionsActions");static InlineEditsActions=new o("InlineEditsActions");static InlineEditActions=new o("InlineEditActions");static NewFile=new o("NewFile");static MergeInput1Toolbar=new o("MergeToolbar1Toolbar");static MergeInput2Toolbar=new o("MergeToolbar2Toolbar");static MergeBaseToolbar=new o("MergeBaseToolbar");static MergeInputResultToolbar=new o("MergeToolbarResultToolbar");static InlineSuggestionToolbar=new o("InlineSuggestionToolbar");static InlineEditToolbar=new o("InlineEditToolbar");static ChatContext=new o("ChatContext");static ChatCodeBlock=new o("ChatCodeblock");static ChatCompareBlock=new o("ChatCompareBlock");static ChatMessageTitle=new o("ChatMessageTitle");static ChatExecute=new o("ChatExecute");static ChatExecuteSecondary=new o("ChatExecuteSecondary");static ChatInputSide=new o("ChatInputSide");static AccessibleView=new o("AccessibleView");static MultiDiffEditorFileToolbar=new o("MultiDiffEditorFileToolbar");static DiffEditorHunkToolbar=new o("DiffEditorHunkToolbar");static DiffEditorSelectionToolbar=new o("DiffEditorSelectionToolbar");static for(e){return o._instances.get(e)??new o(e)}id;constructor(e){if(o._instances.has(e))throw new TypeError(`MenuId with identifier '${e}' already exists. Use MenuId.for(ident) or a unique identifier`);o._instances.set(e,this),this.id=e}},wu=Y("menuService"),xu=class o{constructor(e){this.id=e;this.has=t=>t===e}static _all=new Map;static for(e){let t=this._all.get(e);return t||(t=new o(e),this._all.set(e,t)),t}static merge(e){let t=new Set;for(let n of e)n instanceof o&&t.add(n.id);return t}has},_u=new class{_commands=new Map;_menuItems=new Map;_onDidChangeMenu=new tI({merge:xu.merge});onDidChangeMenu=this._onDidChangeMenu.event;addCommand(o){return this._commands.set(o.id,o),this._onDidChangeMenu.fire(xu.for(bi.CommandPalette)),le(()=>{this._commands.delete(o.id)&&this._onDidChangeMenu.fire(xu.for(bi.CommandPalette))})}getCommand(o){return this._commands.get(o)}getCommands(){let o=new Map;return this._commands.forEach((e,t)=>o.set(t,e)),o}appendMenuItem(o,e){let t=this._menuItems.get(o);t||(t=new zi,this._menuItems.set(o,t));let n=t.push(e);return this._onDidChangeMenu.fire(xu.for(o)),le(()=>{n(),this._onDidChangeMenu.fire(xu.for(o))})}appendMenuItems(o){let e=new ee;for(let{id:t,item:n}of o)e.add(this.appendMenuItem(t,n));return e}getMenuItems(o){let e;return this._menuItems.has(o)?e=[...this._menuItems.get(o)]:e=[],o===bi.CommandPalette&&this._appendImplicitItems(e),e}_appendImplicitItems(o){let e=new Set;for(let t of o)Hh(t)&&(e.add(t.command.id),t.alt&&e.add(t.alt.id));this._commands.forEach((t,n)=>{e.has(n)||o.push({command:t})})}},Dl=class extends fl{constructor(t,n,i){super(`submenuitem.${t.submenu.id}`,typeof t.title=="string"?t.title:t.title.value,i,"submenu");this.item=t;this.hideActions=n}},Co=class{constructor(e,t,n,i,r,s,a){this.hideActions=i;this.menuKeybinding=r;this._commandService=a;this.id=e.id,this.label=Co.label(e,n),this.tooltip=(typeof e.tooltip=="string"?e.tooltip:e.tooltip?.value)??"",this.enabled=!e.precondition||s.contextMatchesRules(e.precondition),this.checked=void 0;let l;if(e.toggled){let d=e.toggled.condition?e.toggled:{condition:e.toggled};this.checked=s.contextMatchesRules(d.condition),this.checked&&d.tooltip&&(this.tooltip=typeof d.tooltip=="string"?d.tooltip:d.tooltip.value),this.checked&&we.isThemeIcon(d.icon)&&(l=d.icon),this.checked&&d.title&&(this.label=typeof d.title=="string"?d.title:d.title.value)}l||(l=we.isThemeIcon(e.icon)?e.icon:void 0),this.item=e,this.alt=t?new Co(t,void 0,n,i,void 0,s,a):void 0,this._options=n,this.class=l&&we.asClassName(l)}static label(e,t){return t?.renderShortTitle&&e.shortTitle?typeof e.shortTitle=="string"?e.shortTitle:e.shortTitle.value:typeof e.title=="string"?e.title:e.title.value}item;alt;_options;id;label;tooltip;class;enabled;checked;run(...e){let t=[];return this._options?.arg&&(t=[...t,this._options.arg]),this._options?.shouldForwardArgs&&(t=[...t,...e]),this._commandService.executeCommand(this.id,...t)}};Co=O([x(5,_t),x(6,Ji)],Co);var Uh=class extends F{constructor(t,n,i,r,s){super();this._accessibilityService=s;this.isSimpleWidget=t,this.contextMenuId=n,this._containerObserver=this._register(new Bh(r,i.dimension)),this._targetWindowId=Ce(r).vscodeWindowId,this._rawOptions=VV(i),this._validatedOptions=Du.validateOptions(this._rawOptions),this.options=this._computeOptions(),this.options.get(13)&&this._containerObserver.startObserving(),this._register(Ca.onDidChangeZoomLevel(()=>this._recomputeOptions())),this._register(Wh.onDidChangeTabFocus(()=>this._recomputeOptions())),this._register(this._containerObserver.onDidChange(()=>this._recomputeOptions())),this._register(gk.onDidChange(()=>this._recomputeOptions())),this._register(Vh.getInstance(Ce(r)).onDidChange(()=>this._recomputeOptions())),this._register(this._accessibilityService.onDidChangeScreenReaderOptimized(()=>this._recomputeOptions()))}_onDidChange=this._register(new D);onDidChange=this._onDidChange.event;_onDidChangeFast=this._register(new D);onDidChangeFast=this._onDidChangeFast.event;isSimpleWidget;contextMenuId;_containerObserver;_isDominatedByLongLines=!1;_viewLineCount=1;_lineNumbersDigitCount=1;_reservedHeight=0;_glyphMarginDecorationLaneCount=1;_targetWindowId;_computeOptionsMemory=new Gf;_rawOptions;_validatedOptions;options;_recomputeOptions(){let t=this._computeOptions(),n=Du.checkEquals(this.options,t);n!==null&&(this.options=t,this._onDidChangeFast.fire(n),this._onDidChange.fire(n))}_computeOptions(){let t=this._readEnvConfiguration(),n=Uf.createFromValidatedSettings(this._validatedOptions,t.pixelRatio,this.isSimpleWidget),i=this._readFontInfo(n),r={memory:this._computeOptionsMemory,outerWidth:t.outerWidth,outerHeight:t.outerHeight-this._reservedHeight,fontInfo:i,extraEditorClassName:t.extraEditorClassName,isDominatedByLongLines:this._isDominatedByLongLines,viewLineCount:this._viewLineCount,lineNumbersDigitCount:this._lineNumbersDigitCount,emptySelectionClipboard:t.emptySelectionClipboard,pixelRatio:t.pixelRatio,tabFocusMode:Wh.getTabFocusMode(),accessibilitySupport:t.accessibilitySupport,glyphMarginDecorationLaneCount:this._glyphMarginDecorationLaneCount};return Du.computeOptions(this._validatedOptions,r)}_readEnvConfiguration(){return{extraEditorClassName:A3(),outerWidth:this._containerObserver.getWidth(),outerHeight:this._containerObserver.getHeight(),emptySelectionClipboard:Ps||Gn,pixelRatio:Vh.getInstance(Cu(this._targetWindowId,!0).window).value,accessibilitySupport:this._accessibilityService.isScreenReaderOptimized()?2:this._accessibilityService.getAccessibilitySupport()}}_readFontInfo(t){return gk.readFontInfo(Cu(this._targetWindowId,!0).window,t)}getRawOptions(){return this._rawOptions}updateOptions(t){let n=VV(t);Du.applyUpdate(this._rawOptions,n)&&(this._validatedOptions=Du.validateOptions(this._rawOptions),this._recomputeOptions())}observeContainer(t){this._containerObserver.observe(t)}setIsDominatedByLongLines(t){this._isDominatedByLongLines!==t&&(this._isDominatedByLongLines=t,this._recomputeOptions())}setModelLineCount(t){let n=N3(t);this._lineNumbersDigitCount!==n&&(this._lineNumbersDigitCount=n,this._recomputeOptions())}setViewLineCount(t){this._viewLineCount!==t&&(this._viewLineCount=t,this._recomputeOptions())}setReservedHeight(t){this._reservedHeight!==t&&(this._reservedHeight=t,this._recomputeOptions())}setGlyphMarginDecorationLaneCount(t){this._glyphMarginDecorationLaneCount!==t&&(this._glyphMarginDecorationLaneCount=t,this._recomputeOptions())}};Uh=O([x(4,vo)],Uh);function N3(o){let e=0;for(;o;)o=Math.floor(o/10),e++;return e||1}function A3(){let o="";return!Wo&&!QB&&(o+="no-user-select "),Wo&&(o+="no-minimap-shadow ",o+="enable-user-select "),Ve&&(o+="mac "),o}var bk=class{_values=[];_read(e){return this._values[e]}get(e){return this._values[e]}_write(e,t){this._values[e]=t}},vk=class{_values=[];_read(e){if(e>=this._values.length)throw new Error("Cannot read uninitialized value");return this._values[e]}get(e){return this._read(e)}_write(e,t){this._values[e]=t}},Du=class o{static validateOptions(e){let t=new bk;for(let n of mh){let i=n.name==="_never_"?void 0:e[n.name];t._write(n.id,n.validate(i))}return t}static computeOptions(e,t){let n=new vk;for(let i of mh)n._write(i.id,i.compute(t,n,e._read(i.id)));return n}static _deepEquals(e,t){if(typeof e!="object"||typeof t!="object"||!e||!t)return e===t;if(Array.isArray(e)||Array.isArray(t))return Array.isArray(e)&&Array.isArray(t)?zt(e,t):!1;if(Object.keys(e).length!==Object.keys(t).length)return!1;for(let n in e)if(!o._deepEquals(e[n],t[n]))return!1;return!0}static checkEquals(e,t){let n=[],i=!1;for(let r of mh){let s=!o._deepEquals(e._read(r.id),t._read(r.id));n[r.id]=s,s&&(i=!0)}return i?new bC(n):null}static applyUpdate(e,t){let n=!1;for(let i of mh)if(t.hasOwnProperty(i.name)){let r=i.applyUpdate(e[i.name],t[i.name]);e[i.name]=r.newValue,n=n||r.didChange}return n}};function VV(o){let e=Md(o);return FV(e),e}var Fs=class{originalStart;originalLength;modifiedStart;modifiedLength;constructor(e,t,n,i){this.originalStart=e,this.originalLength=t,this.modifiedStart=n,this.modifiedLength=i}getOriginalEnd(){return this.originalStart+this.originalLength}getModifiedEnd(){return this.modifiedStart+this.modifiedLength}};var Xd=class{static Assert(e,t){if(!e)throw new Error(t)}},Qd=class{static Copy(e,t,n,i,r){for(let s=0;s<r;s++)n[i+s]=e[t+s]}static Copy2(e,t,n,i,r){for(let s=0;s<r;s++)n[i+s]=e[t+s]}};var xS=class{m_changes;m_originalStart;m_modifiedStart;m_originalCount;m_modifiedCount;constructor(){this.m_changes=[],this.m_originalStart=1073741824,this.m_modifiedStart=1073741824,this.m_originalCount=0,this.m_modifiedCount=0}MarkNextChange(){(this.m_originalCount>0||this.m_modifiedCount>0)&&this.m_changes.push(new Fs(this.m_originalStart,this.m_originalCount,this.m_modifiedStart,this.m_modifiedCount)),this.m_originalCount=0,this.m_modifiedCount=0,this.m_originalStart=1073741824,this.m_modifiedStart=1073741824}AddOriginalElement(e,t){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,t),this.m_originalCount++}AddModifiedElement(e,t){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,t),this.m_modifiedCount++}getChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes}getReverseChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes.reverse(),this.m_changes}},Db=class o{ContinueProcessingPredicate;_originalSequence;_modifiedSequence;_hasStrings;_originalStringElements;_originalElementsOrHash;_modifiedStringElements;_modifiedElementsOrHash;m_forwardHistory;m_reverseHistory;constructor(e,t,n=null){this.ContinueProcessingPredicate=n,this._originalSequence=e,this._modifiedSequence=t;let[i,r,s]=o._getElements(e),[a,l,d]=o._getElements(t);this._hasStrings=s&&d,this._originalStringElements=i,this._originalElementsOrHash=r,this._modifiedStringElements=a,this._modifiedElementsOrHash=l,this.m_forwardHistory=[],this.m_reverseHistory=[]}static _isStringArray(e){return e.length>0&&typeof e[0]=="string"}static _getElements(e){let t=e.getElements();if(o._isStringArray(t)){let n=new Int32Array(t.length);for(let i=0,r=t.length;i<r;i++)n[i]=pI(t[i],0);return[t,n,!0]}return t instanceof Int32Array?[[],t,!1]:[[],new Int32Array(t),!1]}ElementsAreEqual(e,t){return this._originalElementsOrHash[e]!==this._modifiedElementsOrHash[t]?!1:this._hasStrings?this._originalStringElements[e]===this._modifiedStringElements[t]:!0}ElementsAreStrictEqual(e,t){if(!this.ElementsAreEqual(e,t))return!1;let n=o._getStrictElement(this._originalSequence,e),i=o._getStrictElement(this._modifiedSequence,t);return n===i}static _getStrictElement(e,t){return typeof e.getStrictElement=="function"?e.getStrictElement(t):null}OriginalElementsAreEqual(e,t){return this._originalElementsOrHash[e]!==this._originalElementsOrHash[t]?!1:this._hasStrings?this._originalStringElements[e]===this._originalStringElements[t]:!0}ModifiedElementsAreEqual(e,t){return this._modifiedElementsOrHash[e]!==this._modifiedElementsOrHash[t]?!1:this._hasStrings?this._modifiedStringElements[e]===this._modifiedStringElements[t]:!0}ComputeDiff(e){return this._ComputeDiff(0,this._originalElementsOrHash.length-1,0,this._modifiedElementsOrHash.length-1,e)}_ComputeDiff(e,t,n,i,r){let s=[!1],a=this.ComputeDiffRecursive(e,t,n,i,s);return r&&(a=this.PrettifyChanges(a)),{quitEarly:s[0],changes:a}}ComputeDiffRecursive(e,t,n,i,r){for(r[0]=!1;e<=t&&n<=i&&this.ElementsAreEqual(e,n);)e++,n++;for(;t>=e&&i>=n&&this.ElementsAreEqual(t,i);)t--,i--;if(e>t||n>i){let u;return n<=i?(Xd.Assert(e===t+1,"originalStart should only be one more than originalEnd"),u=[new Fs(e,0,n,i-n+1)]):e<=t?(Xd.Assert(n===i+1,"modifiedStart should only be one more than modifiedEnd"),u=[new Fs(e,t-e+1,n,0)]):(Xd.Assert(e===t+1,"originalStart should only be one more than originalEnd"),Xd.Assert(n===i+1,"modifiedStart should only be one more than modifiedEnd"),u=[]),u}let s=[0],a=[0],l=this.ComputeRecursionPoint(e,t,n,i,s,a,r),d=s[0],c=a[0];if(l!==null)return l;if(!r[0]){let u=this.ComputeDiffRecursive(e,d,n,c,r),p=[];return r[0]?p=[new Fs(d+1,t-(d+1)+1,c+1,i-(c+1)+1)]:p=this.ComputeDiffRecursive(d+1,t,c+1,i,r),this.ConcatenateChanges(u,p)}return[new Fs(e,t-e+1,n,i-n+1)]}WALKTRACE(e,t,n,i,r,s,a,l,d,c,u,p,h,f,g,b,v,y){let S=null,E=null,C=new xS,w=t,_=n,L=h[0]-b[0]-i,k=-1073741824,W=this.m_forwardHistory.length-1;do{let K=L+e;K===w||K<_&&d[K-1]<d[K+1]?(u=d[K+1],f=u-L-i,u<k&&C.MarkNextChange(),k=u,C.AddModifiedElement(u+1,f),L=K+1-e):(u=d[K-1]+1,f=u-L-i,u<k&&C.MarkNextChange(),k=u-1,C.AddOriginalElement(u,f+1),L=K-1-e),W>=0&&(d=this.m_forwardHistory[W],e=d[0],w=1,_=d.length-1)}while(--W>=-1);if(S=C.getReverseChanges(),y[0]){let K=h[0]+1,U=b[0]+1;if(S!==null&&S.length>0){let oe=S[S.length-1];K=Math.max(K,oe.getOriginalEnd()),U=Math.max(U,oe.getModifiedEnd())}E=[new Fs(K,p-K+1,U,g-U+1)]}else{C=new xS,w=s,_=a,L=h[0]-b[0]-l,k=1073741824,W=v?this.m_reverseHistory.length-1:this.m_reverseHistory.length-2;do{let K=L+r;K===w||K<_&&c[K-1]>=c[K+1]?(u=c[K+1]-1,f=u-L-l,u>k&&C.MarkNextChange(),k=u+1,C.AddOriginalElement(u+1,f+1),L=K+1-r):(u=c[K-1],f=u-L-l,u>k&&C.MarkNextChange(),k=u,C.AddModifiedElement(u+1,f+1),L=K-1-r),W>=0&&(c=this.m_reverseHistory[W],r=c[0],w=1,_=c.length-1)}while(--W>=-1);E=C.getChanges()}return this.ConcatenateChanges(S,E)}ComputeRecursionPoint(e,t,n,i,r,s,a){let l=0,d=0,c=0,u=0,p=0,h=0;e--,n--,r[0]=0,s[0]=0,this.m_forwardHistory=[],this.m_reverseHistory=[];let f=t-e+(i-n),g=f+1,b=new Int32Array(g),v=new Int32Array(g),y=i-n,S=t-e,E=e-n,C=t-i,_=(S-y)%2===0;b[y]=e,v[S]=t,a[0]=!1;for(let L=1;L<=f/2+1;L++){let k=0,W=0;c=this.ClipDiagonalBound(y-L,L,y,g),u=this.ClipDiagonalBound(y+L,L,y,g);for(let U=c;U<=u;U+=2){U===c||U<u&&b[U-1]<b[U+1]?l=b[U+1]:l=b[U-1]+1,d=l-(U-y)-E;let oe=l;for(;l<t&&d<i&&this.ElementsAreEqual(l+1,d+1);)l++,d++;if(b[U]=l,l+d>k+W&&(k=l,W=d),!_&&Math.abs(U-S)<=L-1&&l>=v[U])return r[0]=l,s[0]=d,oe<=v[U]&&L<=1448?this.WALKTRACE(y,c,u,E,S,p,h,C,b,v,l,t,r,d,i,s,_,a):null}let K=(k-e+(W-n)-L)/2;if(this.ContinueProcessingPredicate!==null&&!this.ContinueProcessingPredicate(k,K))return a[0]=!0,r[0]=k,s[0]=W,K>0&&L<=1448?this.WALKTRACE(y,c,u,E,S,p,h,C,b,v,l,t,r,d,i,s,_,a):(e++,n++,[new Fs(e,t-e+1,n,i-n+1)]);p=this.ClipDiagonalBound(S-L,L,S,g),h=this.ClipDiagonalBound(S+L,L,S,g);for(let U=p;U<=h;U+=2){U===p||U<h&&v[U-1]>=v[U+1]?l=v[U+1]-1:l=v[U-1],d=l-(U-S)-C;let oe=l;for(;l>e&&d>n&&this.ElementsAreEqual(l,d);)l--,d--;if(v[U]=l,_&&Math.abs(U-y)<=L&&l<=b[U])return r[0]=l,s[0]=d,oe>=b[U]&&L<=1448?this.WALKTRACE(y,c,u,E,S,p,h,C,b,v,l,t,r,d,i,s,_,a):null}if(L<=1447){let U=new Int32Array(u-c+2);U[0]=y-c+1,Qd.Copy2(b,c,U,1,u-c+1),this.m_forwardHistory.push(U),U=new Int32Array(h-p+2),U[0]=S-p+1,Qd.Copy2(v,p,U,1,h-p+1),this.m_reverseHistory.push(U)}}return this.WALKTRACE(y,c,u,E,S,p,h,C,b,v,l,t,r,d,i,s,_,a)}PrettifyChanges(e){for(let t=0;t<e.length;t++){let n=e[t],i=t<e.length-1?e[t+1].originalStart:this._originalElementsOrHash.length,r=t<e.length-1?e[t+1].modifiedStart:this._modifiedElementsOrHash.length,s=n.originalLength>0,a=n.modifiedLength>0;for(;n.originalStart+n.originalLength<i&&n.modifiedStart+n.modifiedLength<r&&(!s||this.OriginalElementsAreEqual(n.originalStart,n.originalStart+n.originalLength))&&(!a||this.ModifiedElementsAreEqual(n.modifiedStart,n.modifiedStart+n.modifiedLength));){let d=this.ElementsAreStrictEqual(n.originalStart,n.modifiedStart);if(this.ElementsAreStrictEqual(n.originalStart+n.originalLength,n.modifiedStart+n.modifiedLength)&&!d)break;n.originalStart++,n.modifiedStart++}let l=[null];if(t<e.length-1&&this.ChangesOverlap(e[t],e[t+1],l)){e[t]=l[0],e.splice(t+1,1),t--;continue}}for(let t=e.length-1;t>=0;t--){let n=e[t],i=0,r=0;if(t>0){let u=e[t-1];i=u.originalStart+u.originalLength,r=u.modifiedStart+u.modifiedLength}let s=n.originalLength>0,a=n.modifiedLength>0,l=0,d=this._boundaryScore(n.originalStart,n.originalLength,n.modifiedStart,n.modifiedLength);for(let u=1;;u++){let p=n.originalStart-u,h=n.modifiedStart-u;if(p<i||h<r||s&&!this.OriginalElementsAreEqual(p,p+n.originalLength)||a&&!this.ModifiedElementsAreEqual(h,h+n.modifiedLength))break;let g=(p===i&&h===r?5:0)+this._boundaryScore(p,n.originalLength,h,n.modifiedLength);g>d&&(d=g,l=u)}n.originalStart-=l,n.modifiedStart-=l;let c=[null];if(t>0&&this.ChangesOverlap(e[t-1],e[t],c)){e[t-1]=c[0],e.splice(t,1),t++;continue}}if(this._hasStrings)for(let t=1,n=e.length;t<n;t++){let i=e[t-1],r=e[t],s=r.originalStart-i.originalStart-i.originalLength,a=i.originalStart,l=r.originalStart+r.originalLength,d=l-a,c=i.modifiedStart,u=r.modifiedStart+r.modifiedLength,p=u-c;if(s<5&&d<20&&p<20){let h=this._findBetterContiguousSequence(a,d,c,p,s);if(h){let[f,g]=h;(f!==i.originalStart+i.originalLength||g!==i.modifiedStart+i.modifiedLength)&&(i.originalLength=f-i.originalStart,i.modifiedLength=g-i.modifiedStart,r.originalStart=f+s,r.modifiedStart=g+s,r.originalLength=l-r.originalStart,r.modifiedLength=u-r.modifiedStart)}}}return e}_findBetterContiguousSequence(e,t,n,i,r){if(t<r||i<r)return null;let s=e+t-r+1,a=n+i-r+1,l=0,d=0,c=0;for(let u=e;u<s;u++)for(let p=n;p<a;p++){let h=this._contiguousSequenceScore(u,p,r);h>0&&h>l&&(l=h,d=u,c=p)}return l>0?[d,c]:null}_contiguousSequenceScore(e,t,n){let i=0;for(let r=0;r<n;r++){if(!this.ElementsAreEqual(e+r,t+r))return 0;i+=this._originalStringElements[e+r].length}return i}_OriginalIsBoundary(e){return e<=0||e>=this._originalElementsOrHash.length-1?!0:this._hasStrings&&/^\s*$/.test(this._originalStringElements[e])}_OriginalRegionIsBoundary(e,t){if(this._OriginalIsBoundary(e)||this._OriginalIsBoundary(e-1))return!0;if(t>0){let n=e+t;if(this._OriginalIsBoundary(n-1)||this._OriginalIsBoundary(n))return!0}return!1}_ModifiedIsBoundary(e){return e<=0||e>=this._modifiedElementsOrHash.length-1?!0:this._hasStrings&&/^\s*$/.test(this._modifiedStringElements[e])}_ModifiedRegionIsBoundary(e,t){if(this._ModifiedIsBoundary(e)||this._ModifiedIsBoundary(e-1))return!0;if(t>0){let n=e+t;if(this._ModifiedIsBoundary(n-1)||this._ModifiedIsBoundary(n))return!0}return!1}_boundaryScore(e,t,n,i){let r=this._OriginalRegionIsBoundary(e,t)?1:0,s=this._ModifiedRegionIsBoundary(n,i)?1:0;return r+s}ConcatenateChanges(e,t){let n=[];if(e.length===0||t.length===0)return t.length>0?t:e;if(this.ChangesOverlap(e[e.length-1],t[0],n)){let i=new Array(e.length+t.length-1);return Qd.Copy(e,0,i,0,e.length-1),i[e.length-1]=n[0],Qd.Copy(t,1,i,e.length,t.length-1),i}else{let i=new Array(e.length+t.length);return Qd.Copy(e,0,i,0,e.length),Qd.Copy(t,0,i,e.length,t.length),i}}ChangesOverlap(e,t,n){if(Xd.Assert(e.originalStart<=t.originalStart,"Left change is not less than or equal to right change"),Xd.Assert(e.modifiedStart<=t.modifiedStart,"Left change is not less than or equal to right change"),e.originalStart+e.originalLength>=t.originalStart||e.modifiedStart+e.modifiedLength>=t.modifiedStart){let i=e.originalStart,r=e.originalLength,s=e.modifiedStart,a=e.modifiedLength;return e.originalStart+e.originalLength>=t.originalStart&&(r=t.originalStart+t.originalLength-e.originalStart),e.modifiedStart+e.modifiedLength>=t.modifiedStart&&(a=t.modifiedStart+t.modifiedLength-e.modifiedStart),n[0]=new Fs(i,r,s,a),!0}else return n[0]=null,!1}ClipDiagonalBound(e,t,n,i){if(e>=0&&e<i)return e;let r=n,s=i-n-1,a=t%2===0;if(e<0){let l=r%2===0;return a===l?0:1}else{let l=s%2===0;return a===l?i-1:i-2}}};var wS=class{constructor(e){this.text=e;this.lineStartOffsetByLineIdx=[],this.lineStartOffsetByLineIdx.push(0);for(let t=0;t<e.length;t++)e.charAt(t)===`
`&&this.lineStartOffsetByLineIdx.push(t+1)}lineStartOffsetByLineIdx;getOffset(e){return this.lineStartOffsetByLineIdx[e.lineNumber-1]+e.column-1}getOffsetRange(e){return new ke(this.getOffset(e.getStartPosition()),this.getOffset(e.getEndPosition()))}getPosition(e){let t=al(this.lineStartOffsetByLineIdx,r=>r<=e),n=t+1,i=e-this.lineStartOffsetByLineIdx[t]+1;return new A(n,i)}getRange(e){return P.fromPositions(this.getPosition(e.start),this.getPosition(e.endExclusive))}getTextLength(e){return Oo.ofRange(this.getRange(e))}get textLength(){let e=this.lineStartOffsetByLineIdx.length-1;return new Oo(e,this.text.length-this.lineStartOffsetByLineIdx[e])}};var DS=class o{constructor(e){this.edits=e;vs(()=>rf(e,(t,n)=>t.range.getEndPosition().isBeforeOrEqual(n.range.getStartPosition())))}static single(e,t){return new o([new Lu(e,t)])}normalize(){let e=[];for(let t of this.edits)if(e.length>0&&e[e.length-1].range.getEndPosition().equals(t.range.getStartPosition())){let n=e[e.length-1];e[e.length-1]=new Lu(n.range.plusRange(t.range),n.text+t.text)}else t.isEmpty||e.push(t);return new o(e)}mapPosition(e){let t=0,n=0,i=0;for(let r of this.edits){let s=r.range.getStartPosition(),a=r.range.getEndPosition();if(e.isBeforeOrEqual(s))break;let l=Oo.ofText(r.text);if(e.isBefore(a)){let d=new A(s.lineNumber+t,s.column+(s.lineNumber+t===n?i:0)),c=l.addToPosition(d);return _S(d,c)}t+=l.lineCount-(r.range.endLineNumber-r.range.startLineNumber),l.lineCount===0?a.lineNumber!==s.lineNumber?i+=l.columnCount-(a.column-1):i+=l.columnCount-(a.column-s.column):i=l.columnCount,n=a.lineNumber+t}return new A(e.lineNumber+t,e.column+(e.lineNumber+t===n?i:0))}mapRange(e){function t(s){return s instanceof A?s:s.getStartPosition()}function n(s){return s instanceof A?s:s.getEndPosition()}let i=t(this.mapPosition(e.getStartPosition())),r=n(this.mapPosition(e.getEndPosition()));return _S(i,r)}inverseMapPosition(e,t){return this.inverse(t).mapPosition(e)}inverseMapRange(e,t){return this.inverse(t).mapRange(e)}apply(e){let t="",n=new A(1,1);for(let r of this.edits){let s=r.range,a=s.getStartPosition(),l=s.getEndPosition(),d=_S(n,a);d.isEmpty()||(t+=e.getValueOfRange(d)),t+=r.text,n=l}let i=_S(n,e.endPositionExclusive);return i.isEmpty()||(t+=e.getValueOfRange(i)),t}applyToString(e){let t=new yk(e);return this.apply(t)}inverse(e){let t=this.getNewRanges();return new o(this.edits.map((n,i)=>new Lu(t[i],e.getValueOfRange(n.range))))}getNewRanges(){let e=[],t=0,n=0,i=0;for(let r of this.edits){let s=Oo.ofText(r.text),a=A.lift({lineNumber:r.range.startLineNumber+n,column:r.range.startColumn+(r.range.startLineNumber===t?i:0)}),l=s.createRange(a);e.push(l),n=l.endLineNumber-r.range.endLineNumber,i=l.endColumn-r.range.endColumn,t=r.range.endLineNumber}return e}},Lu=class{constructor(e,t){this.range=e;this.text=t}get isEmpty(){return this.range.isEmpty()&&this.text.length===0}static equals(e,t){return e.range.equalsRange(t.range)&&e.text===t.text}toSingleEditOperation(){return{range:this.range,text:this.text}}};function _S(o,e){if(o.lineNumber===e.lineNumber&&o.column===Number.MAX_SAFE_INTEGER)return P.fromPositions(e,e);if(!o.isBeforeOrEqual(e))throw new Ye("start must be before end");return new P(o.lineNumber,o.column,e.lineNumber,e.column)}var Lb=class{get endPositionExclusive(){return this.length.addToPosition(new A(1,1))}getValue(){return this.getValueOfRange(this.length.toRange())}};var yk=class extends Lb{constructor(t){super();this.value=t}_t=new wS(this.value);getValueOfRange(t){return this._t.getOffsetRange(t).substring(this.value)}get length(){return this._t.textLength}};var Xi=class o{static inverse(e,t,n){let i=[],r=1,s=1;for(let l of e){let d=new o(new Re(r,l.original.startLineNumber),new Re(s,l.modified.startLineNumber));d.modified.isEmpty||i.push(d),r=l.original.endLineNumberExclusive,s=l.modified.endLineNumberExclusive}let a=new o(new Re(r,t+1),new Re(s,n+1));return a.modified.isEmpty||i.push(a),i}static clip(e,t,n){let i=[];for(let r of e){let s=r.original.intersect(t),a=r.modified.intersect(n);s&&!s.isEmpty&&a&&!a.isEmpty&&i.push(new o(s,a))}return i}original;modified;constructor(e,t){this.original=e,this.modified=t}toString(){return`{${this.original.toString()}->${this.modified.toString()}}`}flip(){return new o(this.modified,this.original)}join(e){return new o(this.original.join(e.original),this.modified.join(e.modified))}get changedLineCount(){return Math.max(this.original.length,this.modified.length)}toRangeMapping(){let e=this.original.toInclusiveRange(),t=this.modified.toInclusiveRange();if(e&&t)return new oo(e,t);if(this.original.startLineNumber===1||this.modified.startLineNumber===1){if(!(this.modified.startLineNumber===1&&this.original.startLineNumber===1))throw new Ye("not a valid diff");return new oo(new P(this.original.startLineNumber,1,this.original.endLineNumberExclusive,1),new P(this.modified.startLineNumber,1,this.modified.endLineNumberExclusive,1))}else return new oo(new P(this.original.startLineNumber-1,Number.MAX_SAFE_INTEGER,this.original.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),new P(this.modified.startLineNumber-1,Number.MAX_SAFE_INTEGER,this.modified.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER))}toRangeMapping2(e,t){if(WV(this.original.endLineNumberExclusive,e)&&WV(this.modified.endLineNumberExclusive,t))return new oo(new P(this.original.startLineNumber,1,this.original.endLineNumberExclusive,1),new P(this.modified.startLineNumber,1,this.modified.endLineNumberExclusive,1));if(!this.original.isEmpty&&!this.modified.isEmpty)return new oo(P.fromPositions(new A(this.original.startLineNumber,1),zh(new A(this.original.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),e)),P.fromPositions(new A(this.modified.startLineNumber,1),zh(new A(this.modified.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),t)));if(this.original.startLineNumber>1&&this.modified.startLineNumber>1)return new oo(P.fromPositions(zh(new A(this.original.startLineNumber-1,Number.MAX_SAFE_INTEGER),e),zh(new A(this.original.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),e)),P.fromPositions(zh(new A(this.modified.startLineNumber-1,Number.MAX_SAFE_INTEGER),t),zh(new A(this.modified.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),t)));throw new Ye}};function zh(o,e){if(o.lineNumber<1)return new A(1,1);if(o.lineNumber>e.length)return new A(e.length,e[e.length-1].length+1);let t=e[o.lineNumber-1];return o.column>t.length+1?new A(o.lineNumber,t.length+1):o}function WV(o,e){return o>=1&&o<=e.length}var hr=class o extends Xi{static fromRangeMappings(e){let t=Re.join(e.map(i=>Re.fromRangeInclusive(i.originalRange))),n=Re.join(e.map(i=>Re.fromRangeInclusive(i.modifiedRange)));return new o(t,n,e)}innerChanges;constructor(e,t,n){super(e,t),this.innerChanges=n}flip(){return new o(this.modified,this.original,this.innerChanges?.map(e=>e.flip()))}withInnerChangesFromLineRanges(){return new o(this.original,this.modified,[this.toRangeMapping()])}},oo=class o{static assertSorted(e){for(let t=1;t<e.length;t++){let n=e[t-1],i=e[t];if(!(n.originalRange.getEndPosition().isBeforeOrEqual(i.originalRange.getStartPosition())&&n.modifiedRange.getEndPosition().isBeforeOrEqual(i.modifiedRange.getStartPosition())))throw new Ye("Range mappings must be sorted")}}originalRange;modifiedRange;constructor(e,t){this.originalRange=e,this.modifiedRange=t}toString(){return`{${this.originalRange.toString()}->${this.modifiedRange.toString()}}`}flip(){return new o(this.modifiedRange,this.originalRange)}toTextEdit(e){let t=e.getValueOfRange(this.modifiedRange);return new Lu(this.originalRange,t)}};var Ru=class{constructor(e,t,n){this.changes=e;this.moves=t;this.hitTimeout=n}},LS=class o{lineRangeMapping;changes;constructor(e,t){this.lineRangeMapping=e,this.changes=t}flip(){return new o(this.lineRangeMapping.flip(),this.changes.map(e=>e.flip()))}};var Rb={ICodeEditor:"vs.editor.ICodeEditor",IDiffEditor:"vs.editor.IDiffEditor"};var Ll=class{constructor(e,t,n,i,r){this.injectionOffsets=e;this.injectionOptions=t;this.breakOffsets=n;this.breakOffsetsVisibleColumn=i;this.wrappedTextIndentLength=r}getOutputLineCount(){return this.breakOffsets.length}getMinOutputOffset(e){return e>0?this.wrappedTextIndentLength:0}getLineLength(e){let t=e>0?this.breakOffsets[e-1]:0,i=this.breakOffsets[e]-t;return e>0&&(i+=this.wrappedTextIndentLength),i}getMaxOutputOffset(e){return this.getLineLength(e)}translateToInputOffset(e,t){e>0&&(t=Math.max(0,t-this.wrappedTextIndentLength));let i=e===0?t:this.breakOffsets[e-1]+t;if(this.injectionOffsets!==null)for(let r=0;r<this.injectionOffsets.length&&i>this.injectionOffsets[r];r++)i<this.injectionOffsets[r]+this.injectionOptions[r].content.length?i=this.injectionOffsets[r]:i-=this.injectionOptions[r].content.length;return i}translateToOutputPosition(e,t=2){let n=e;if(this.injectionOffsets!==null)for(let i=0;i<this.injectionOffsets.length&&!(e<this.injectionOffsets[i]||t!==1&&e===this.injectionOffsets[i]);i++)n+=this.injectionOptions[i].content.length;return this.offsetInInputWithInjectionsToOutputPosition(n,t)}offsetInInputWithInjectionsToOutputPosition(e,t=2){let n=0,i=this.breakOffsets.length-1,r=0,s=0;for(;n<=i;){r=n+(i-n)/2|0;let l=this.breakOffsets[r];if(s=r>0?this.breakOffsets[r-1]:0,t===0)if(e<=s)i=r-1;else if(e>l)n=r+1;else break;else if(e<s)i=r-1;else if(e>=l)n=r+1;else break}let a=e-s;return r>0&&(a+=this.wrappedTextIndentLength),new Kh(r,a)}normalizeOutputPosition(e,t,n){if(this.injectionOffsets!==null){let i=this.outputPositionToOffsetInInputWithInjections(e,t),r=this.normalizeOffsetInInputWithInjectionsAroundInjections(i,n);if(r!==i)return this.offsetInInputWithInjectionsToOutputPosition(r,n)}if(n===0){if(e>0&&t===this.getMinOutputOffset(e))return new Kh(e-1,this.getMaxOutputOffset(e-1))}else if(n===1){let i=this.getOutputLineCount()-1;if(e<i&&t===this.getMaxOutputOffset(e))return new Kh(e+1,this.getMinOutputOffset(e+1))}return new Kh(e,t)}outputPositionToOffsetInInputWithInjections(e,t){return e>0&&(t=Math.max(0,t-this.wrappedTextIndentLength)),(e>0?this.breakOffsets[e-1]:0)+t}normalizeOffsetInInputWithInjectionsAroundInjections(e,t){let n=this.getInjectedTextAtOffset(e);if(!n)return e;if(t===2){if(e===n.offsetInInputWithInjections+n.length&&HV(this.injectionOptions[n.injectedTextIndex].cursorStops))return n.offsetInInputWithInjections+n.length;{let i=n.offsetInInputWithInjections;if(UV(this.injectionOptions[n.injectedTextIndex].cursorStops))return i;let r=n.injectedTextIndex-1;for(;r>=0&&this.injectionOffsets[r]===this.injectionOffsets[n.injectedTextIndex]&&!(HV(this.injectionOptions[r].cursorStops)||(i-=this.injectionOptions[r].content.length,UV(this.injectionOptions[r].cursorStops)));)r--;return i}}else if(t===1||t===4){let i=n.offsetInInputWithInjections+n.length,r=n.injectedTextIndex;for(;r+1<this.injectionOffsets.length&&this.injectionOffsets[r+1]===this.injectionOffsets[r];)i+=this.injectionOptions[r+1].content.length,r++;return i}else if(t===0||t===3){let i=n.offsetInInputWithInjections,r=n.injectedTextIndex;for(;r-1>=0&&this.injectionOffsets[r-1]===this.injectionOffsets[r];)i-=this.injectionOptions[r-1].content.length,r--;return i}of(t)}getInjectedText(e,t){let n=this.outputPositionToOffsetInInputWithInjections(e,t),i=this.getInjectedTextAtOffset(n);return i?{options:this.injectionOptions[i.injectedTextIndex]}:null}getInjectedTextAtOffset(e){let t=this.injectionOffsets,n=this.injectionOptions;if(t!==null){let i=0;for(let r=0;r<t.length;r++){let s=n[r].content.length,a=t[r]+i,l=t[r]+i+s;if(a>e)break;if(e<=l)return{injectedTextIndex:r,offsetInInputWithInjections:a,length:s};i+=s}}}};function HV(o){return o==null?!0:o===1||o===0}function UV(o){return o==null?!0:o===2||o===0}var Kh=class{outputLineIndex;outputOffset;constructor(e,t){this.outputLineIndex=e,this.outputOffset=t}toString(){return`${this.outputLineIndex}:${this.outputOffset}`}toPosition(e){return new A(e+this.outputLineIndex,this.outputOffset+1)}};function F3(o,e,t){let n=0;for(let r=0;r<o.length;r++)o.charAt(r)==="	"?n=Vt.nextIndentTabStop(n,e):n++;let i="";if(!t){let r=Math.floor(n/e);n=n%e;for(let s=0;s<r;s++)i+="	"}for(let r=0;r<n;r++)i+=" ";return i}function RS(o,e,t){let n=Cn(o);return n===-1&&(n=o.length),F3(o.substring(0,n),e,t)+o.substring(n)}var B3=()=>!0,V3=()=>!1,W3=o=>o===" "||o==="	",Rl=class{constructor(e,t,n,i){this.languageConfigurationService=i;this._languageId=e;let r=n.options,s=r.get(147),a=r.get(51);this.readOnly=r.get(93),this.tabSize=t.tabSize,this.indentSize=t.indentSize,this.insertSpaces=t.insertSpaces,this.stickyTabStops=r.get(118),this.lineHeight=a.lineHeight,this.typicalHalfwidthCharacterWidth=a.typicalHalfwidthCharacterWidth,this.pageSize=Math.max(1,Math.floor(s.height/this.lineHeight)-2),this.useTabStops=r.get(130),this.wordSeparators=r.get(133),this.emptySelectionClipboard=r.get(38),this.copyWithSyntaxHighlighting=r.get(25),this.multiCursorMergeOverlapping=r.get(78),this.multiCursorPaste=r.get(80),this.multiCursorLimit=r.get(81),this.autoClosingBrackets=r.get(6),this.autoClosingComments=r.get(7),this.autoClosingQuotes=r.get(11),this.autoClosingDelete=r.get(9),this.autoClosingOvertype=r.get(10),this.autoSurround=r.get(14),this.autoIndent=r.get(12),this.wordSegmenterLocales=r.get(132),this.surroundingPairs={},this._electricChars=null,this.shouldAutoCloseBefore={quote:this._getShouldAutoClose(e,this.autoClosingQuotes,!0),comment:this._getShouldAutoClose(e,this.autoClosingComments,!1),bracket:this._getShouldAutoClose(e,this.autoClosingBrackets,!1)},this.autoClosingPairs=this.languageConfigurationService.getLanguageConfiguration(e).getAutoClosingPairs();let l=this.languageConfigurationService.getLanguageConfiguration(e).getSurroundingPairs();if(l)for(let c of l)this.surroundingPairs[c.open]=c.close;let d=this.languageConfigurationService.getLanguageConfiguration(e).comments;this.blockCommentStartToken=d?.blockCommentStartToken??null}_cursorMoveConfigurationBrand=void 0;readOnly;tabSize;indentSize;insertSpaces;stickyTabStops;pageSize;lineHeight;typicalHalfwidthCharacterWidth;useTabStops;wordSeparators;emptySelectionClipboard;copyWithSyntaxHighlighting;multiCursorMergeOverlapping;multiCursorPaste;multiCursorLimit;autoClosingBrackets;autoClosingComments;autoClosingQuotes;autoClosingDelete;autoClosingOvertype;autoSurround;autoIndent;autoClosingPairs;surroundingPairs;blockCommentStartToken;shouldAutoCloseBefore;wordSegmenterLocales;_languageId;_electricChars;static shouldRecreate(e){return e.hasChanged(147)||e.hasChanged(133)||e.hasChanged(38)||e.hasChanged(78)||e.hasChanged(80)||e.hasChanged(81)||e.hasChanged(6)||e.hasChanged(7)||e.hasChanged(11)||e.hasChanged(9)||e.hasChanged(10)||e.hasChanged(14)||e.hasChanged(130)||e.hasChanged(51)||e.hasChanged(93)||e.hasChanged(132)}get electricChars(){if(!this._electricChars){this._electricChars={};let e=this.languageConfigurationService.getLanguageConfiguration(this._languageId).electricCharacter?.getElectricCharacters();if(e)for(let t of e)this._electricChars[t]=!0}return this._electricChars}onElectricCharacter(e,t,n){let i=Ia(t,n-1),r=this.languageConfigurationService.getLanguageConfiguration(i.languageId).electricCharacter;return r?r.onElectricCharacter(e,i,n-i.firstCharOffset):null}normalizeIndentation(e){return RS(e,this.indentSize,this.insertSpaces)}_getShouldAutoClose(e,t,n){switch(t){case"beforeWhitespace":return W3;case"languageDefined":return this._getLanguageDefinedShouldAutoClose(e,n);case"always":return B3;case"never":return V3}}_getLanguageDefinedShouldAutoClose(e,t){let n=this.languageConfigurationService.getLanguageConfiguration(e).getAutoCloseBeforeSet(t);return i=>n.indexOf(i)!==-1}visibleColumnFromColumn(e,t){return Vt.visibleColumnFromColumn(e.getLineContent(t.lineNumber),t.column,this.tabSize)}columnFromVisibleColumn(e,t,n){let i=Vt.columnFromVisibleColumn(e.getLineContent(t),n,this.tabSize),r=e.getLineMinColumn(t);if(i<r)return r;let s=e.getLineMaxColumn(t);return i>s?s:i}},Ze=class o{_cursorStateBrand=void 0;static fromModelState(e){return new Ck(e)}static fromViewState(e){return new Sk(e)}static fromModelSelection(e){let t=$e.liftSelection(e),n=new Pn(P.fromPositions(t.getSelectionStart()),0,0,t.getPosition(),0);return o.fromModelState(n)}static fromModelSelections(e){let t=[];for(let n=0,i=e.length;n<i;n++)t[n]=this.fromModelSelection(e[n]);return t}modelState;viewState;constructor(e,t){this.modelState=e,this.viewState=t}equals(e){return this.viewState.equals(e.viewState)&&this.modelState.equals(e.modelState)}},Ck=class{modelState;viewState;constructor(e){this.modelState=e,this.viewState=null}},Sk=class{modelState;viewState;constructor(e){this.modelState=null,this.viewState=e}};var Pn=class o{constructor(e,t,n,i,r){this.selectionStart=e;this.selectionStartKind=t;this.selectionStartLeftoverVisibleColumns=n;this.position=i;this.leftoverVisibleColumns=r;this.selection=o._computeSelection(this.selectionStart,this.position)}_singleCursorStateBrand=void 0;selection;equals(e){return this.selectionStartLeftoverVisibleColumns===e.selectionStartLeftoverVisibleColumns&&this.leftoverVisibleColumns===e.leftoverVisibleColumns&&this.selectionStartKind===e.selectionStartKind&&this.position.equals(e.position)&&this.selectionStart.equalsRange(e.selectionStart)}hasSelection(){return!this.selection.isEmpty()||!this.selectionStart.isEmpty()}move(e,t,n,i){return e?new o(this.selectionStart,this.selectionStartKind,this.selectionStartLeftoverVisibleColumns,new A(t,n),i):new o(new P(t,n,t,n),0,i,new A(t,n),i)}static _computeSelection(e,t){return e.isEmpty()||!t.isBeforeOrEqual(e.getStartPosition())?$e.fromPositions(e.getStartPosition(),t):$e.fromPositions(e.getEndPosition(),t)}},jn=class{_editOperationResultBrand=void 0;type;commands;shouldPushStackElementBefore;shouldPushStackElementAfter;constructor(e,t,n){this.type=e,this.commands=t,this.shouldPushStackElementBefore=n.shouldPushStackElementBefore,this.shouldPushStackElementAfter=n.shouldPushStackElementAfter}};function Bs(o){return o==="'"||o==='"'||o==="`"}function KV(o){return`--vscode-${o.replace(/\./g,"-")}`}function ce(o){return`var(${KV(o)})`}function GV(o,e){return`var(${KV(o)}, ${e})`}function H3(o){return o!==null&&typeof o=="object"&&"light"in o&&"dark"in o}var U3={ColorContribution:"base.contributions.colors"},z3="default",Ek=class{_onDidChangeSchema=new D;onDidChangeSchema=this._onDidChangeSchema.event;colorsById;colorSchema={type:"object",properties:{}};colorReferenceSchema={type:"string",enum:[],enumDescriptions:[]};constructor(){this.colorsById={}}notifyThemeUpdate(e){for(let t of Object.keys(this.colorsById)){let n=e.getColor(t);n&&(this.colorSchema.properties[t].oneOf[0].defaultSnippets[0].body=`\${1:${n.toString()}}`)}this._onDidChangeSchema.fire()}registerColor(e,t,n,i=!1,r){let s={id:e,description:n,defaults:t,needsTransparency:i,deprecationMessage:r};this.colorsById[e]=s;let a={type:"string",format:"color-hex",defaultSnippets:[{body:"${1:#ff0000}"}]};return r&&(a.deprecationMessage=r),i&&(a.pattern="^#(?:(?<rgba>[0-9a-fA-f]{3}[0-9a-eA-E])|(?:[0-9a-fA-F]{6}(?:(?![fF]{2})(?:[0-9a-fA-F]{2}))))?$",a.patternErrorMessage=m("transparecyRequired","This color must be transparent or it will obscure content")),this.colorSchema.properties[e]={description:n,oneOf:[a,{type:"string",const:z3,description:m("useDefault","Use the default color.")}]},this.colorReferenceSchema.enum.push(e),this.colorReferenceSchema.enumDescriptions.push(n),this._onDidChangeSchema.fire(),e}deregisterColor(e){delete this.colorsById[e],delete this.colorSchema.properties[e];let t=this.colorReferenceSchema.enum.indexOf(e);t!==-1&&(this.colorReferenceSchema.enum.splice(t,1),this.colorReferenceSchema.enumDescriptions.splice(t,1)),this._onDidChangeSchema.fire()}getColors(){return Object.keys(this.colorsById).map(e=>this.colorsById[e])}resolveDefaultColor(e,t){let n=this.colorsById[e];if(n?.defaults){let i=H3(n.defaults)?n.defaults[t.type]:n.defaults;return Vs(i,t)}}getColorSchema(){return this.colorSchema}getColorReferenceSchema(){return this.colorReferenceSchema}toString(){let e=(t,n)=>{let i=t.indexOf(".")===-1?0:1,r=n.indexOf(".")===-1?0:1;return i!==r?i-r:t.localeCompare(n)};return Object.keys(this.colorsById).sort(e).map(t=>`- \`${t}\`: ${this.colorsById[t].description}`).join(`
`)}},kS=new Ek;et.add(U3.ColorContribution,kS);function T(o,e,t,n,i){return kS.registerColor(o,e,t,n,i)}function K3(o,e){switch(o.op){case 0:return Vs(o.value,e)?.darken(o.factor);case 1:return Vs(o.value,e)?.lighten(o.factor);case 2:return Vs(o.value,e)?.transparent(o.factor);case 3:{let t=Vs(o.background,e);return t?Vs(o.value,e)?.makeOpaque(t):Vs(o.value,e)}case 4:for(let t of o.values){let n=Vs(t,e);if(n)return n}return;case 6:return Vs(e.defines(o.if)?o.then:o.else,e);case 5:{let t=Vs(o.value,e);if(!t)return;let n=Vs(o.background,e);return n?t.isDarkerThan(n)?H.getLighterColor(t,n,o.factor).transparent(o.transparency):H.getDarkerColor(t,n,o.factor).transparent(o.transparency):t.transparent(o.factor*o.transparency)}default:throw of(o)}}function ro(o,e){return{op:0,value:o,factor:e}}function So(o,e){return{op:1,value:o,factor:e}}function ye(o,e){return{op:2,value:o,factor:e}}function Tk(...o){return{op:4,values:o}}function jV(o,e,t){return{op:6,if:o,then:e,else:t}}function xk(o,e,t,n){return{op:5,value:o,background:e,factor:t,transparency:n}}function Vs(o,e){if(o!==null){if(typeof o=="string")return o[0]==="#"?H.fromHex(o):e.getColor(o);if(o instanceof H)return o;if(typeof o=="object")return K3(o,e)}}var qV="vscode://schemas/workbench-colors",$V=et.as(Ld.JSONContribution);$V.registerSchema(qV,kS.getColorSchema());var zV=new nn(()=>$V.notifySchemaChanged(qV),200);kS.onDidChangeSchema(()=>{zV.isScheduled()||zV.schedule()});var gt=T("foreground",{dark:"#CCCCCC",light:"#616161",hcDark:"#FFFFFF",hcLight:"#292929"},m("foreground","Overall foreground color. This color is only used if not overridden by a component.")),Twe=T("disabledForeground",{dark:"#CCCCCC80",light:"#61616180",hcDark:"#A5A5A5",hcLight:"#7F7F7F"},m("disabledForeground","Overall foreground for disabled elements. This color is only used if not overridden by a component.")),wk=T("errorForeground",{dark:"#F48771",light:"#A1260D",hcDark:"#F48771",hcLight:"#B5200D"},m("errorForeground","Overall foreground color for error messages. This color is only used if not overridden by a component.")),xwe=T("descriptionForeground",{light:"#717171",dark:ye(gt,.7),hcDark:ye(gt,.7),hcLight:ye(gt,.7)},m("descriptionForeground","Foreground color for description text providing additional information, for example for a label.")),kb=T("icon.foreground",{dark:"#C5C5C5",light:"#424242",hcDark:"#FFFFFF",hcLight:"#292929"},m("iconForeground","The default color for icons in the workbench.")),so=T("focusBorder",{dark:"#007FD4",light:"#0090F1",hcDark:"#F38518",hcLight:"#006BBD"},m("focusBorder","Overall border color for focused elements. This color is only used if not overridden by a component.")),Ee=T("contrastBorder",{light:null,dark:null,hcDark:"#6FC3DF",hcLight:"#0F4A85"},m("contrastBorder","An extra border around elements to separate them from others for greater contrast.")),Pt=T("contrastActiveBorder",{light:null,dark:null,hcDark:so,hcLight:so},m("activeContrastBorder","An extra border around active elements to separate them from others for greater contrast.")),wwe=T("selection.background",null,m("selectionBackground","The background color of text selections in the workbench (e.g. for input fields or text areas). Note that this does not apply to selections within the editor.")),MS=T("textLink.foreground",{light:"#006AB1",dark:"#3794FF",hcDark:"#21A6FF",hcLight:"#0F4A85"},m("textLinkForeground","Foreground color for links in text.")),_we=T("textLink.activeForeground",{light:"#006AB1",dark:"#3794FF",hcDark:"#21A6FF",hcLight:"#0F4A85"},m("textLinkActiveForeground","Foreground color for links in text when clicked on and on mouse hover.")),Dwe=T("textSeparator.foreground",{light:"#0000002e",dark:"#ffffff2e",hcDark:H.black,hcLight:"#292929"},m("textSeparatorForeground","Color for text separators.")),Lwe=T("textPreformat.foreground",{light:"#A31515",dark:"#D7BA7D",hcDark:"#000000",hcLight:"#FFFFFF"},m("textPreformatForeground","Foreground color for preformatted text segments.")),Rwe=T("textPreformat.background",{light:"#0000001A",dark:"#FFFFFF1A",hcDark:"#FFFFFF",hcLight:"#09345f"},m("textPreformatBackground","Background color for preformatted text segments.")),kwe=T("textBlockQuote.background",{light:"#f2f2f2",dark:"#222222",hcDark:null,hcLight:"#F2F2F2"},m("textBlockQuoteBackground","Background color for block quotes in text.")),Mwe=T("textBlockQuote.border",{light:"#007acc80",dark:"#007acc80",hcDark:H.white,hcLight:"#292929"},m("textBlockQuoteBorder","Border color for block quotes in text.")),Pwe=T("textCodeBlock.background",{light:"#dcdcdc66",dark:"#0a0a0a66",hcDark:H.black,hcLight:"#F2F2F2"},m("textCodeBlockBackground","Background color for code blocks in text."));var Bwe=T("sash.hoverBorder",so,m("sashActiveBorder","Border color of active sashes.")),Gh=T("badge.background",{dark:"#4D4D4D",light:"#C4C4C4",hcDark:H.black,hcLight:"#0F4A85"},m("badgeBackground","Badge background color. Badges are small information labels, e.g. for search results count.")),YV=T("badge.foreground",{dark:H.white,light:"#333",hcDark:H.white,hcLight:H.white},m("badgeForeground","Badge foreground color. Badges are small information labels, e.g. for search results count.")),Jd=T("scrollbar.shadow",{dark:"#000000",light:"#DDDDDD",hcDark:null,hcLight:null},m("scrollbarShadow","Scrollbar shadow to indicate that the view is scrolled.")),PS=T("scrollbarSlider.background",{dark:H.fromHex("#797979").transparent(.4),light:H.fromHex("#646464").transparent(.4),hcDark:ye(Ee,.6),hcLight:ye(Ee,.4)},m("scrollbarSliderBackground","Scrollbar slider background color.")),OS=T("scrollbarSlider.hoverBackground",{dark:H.fromHex("#646464").transparent(.7),light:H.fromHex("#646464").transparent(.7),hcDark:ye(Ee,.8),hcLight:ye(Ee,.8)},m("scrollbarSliderHoverBackground","Scrollbar slider background color when hovering.")),NS=T("scrollbarSlider.activeBackground",{dark:H.fromHex("#BFBFBF").transparent(.4),light:H.fromHex("#000000").transparent(.6),hcDark:Ee,hcLight:Ee},m("scrollbarSliderActiveBackground","Scrollbar slider background color when clicked on.")),ZV=T("progressBar.background",{dark:H.fromHex("#0E70C0"),light:H.fromHex("#0E70C0"),hcDark:Ee,hcLight:Ee},m("progressBarBackground","Background color of the progress bar that can show for long running operations."));var ss=T("editor.background",{light:"#ffffff",dark:"#1E1E1E",hcDark:H.black,hcLight:H.white},m("editorBackground","Editor background color.")),Da=T("editor.foreground",{light:"#333333",dark:"#BBBBBB",hcDark:H.white,hcLight:gt},m("editorForeground","Editor default foreground color.")),Kwe=T("editorStickyScroll.background",ss,m("editorStickyScrollBackground","Background color of sticky scroll in the editor")),Gwe=T("editorStickyScrollHover.background",{dark:"#2A2D2E",light:"#F0F0F0",hcDark:null,hcLight:H.fromHex("#0F4A85").transparent(.1)},m("editorStickyScrollHoverBackground","Background color of sticky scroll on hover in the editor")),jwe=T("editorStickyScroll.border",{dark:null,light:null,hcDark:Ee,hcLight:Ee},m("editorStickyScrollBorder","Border color of sticky scroll in the editor")),qwe=T("editorStickyScroll.shadow",Jd,m("editorStickyScrollShadow"," Shadow color of sticky scroll in the editor")),ki=T("editorWidget.background",{dark:"#252526",light:"#F3F3F3",hcDark:"#0C141F",hcLight:H.white},m("editorWidgetBackground","Background color of editor widgets, such as find/replace.")),La=T("editorWidget.foreground",gt,m("editorWidgetForeground","Foreground color of editor widgets, such as find/replace.")),Rk=T("editorWidget.border",{dark:"#454545",light:"#C8C8C8",hcDark:Ee,hcLight:Ee},m("editorWidgetBorder","Border color of editor widgets. The color is only used if the widget chooses to have a border and if the color is not overridden by a widget.")),$we=T("editorWidget.resizeBorder",null,m("editorWidgetResizeBorder","Border color of the resize bar of editor widgets. The color is only used if the widget chooses to have a resize border and if the color is not overridden by a widget.")),Ywe=T("editorError.background",null,m("editorError.background","Background color of error text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0),Mu=T("editorError.foreground",{dark:"#F14C4C",light:"#E51400",hcDark:"#F48771",hcLight:"#B5200D"},m("editorError.foreground","Foreground color of error squigglies in the editor.")),Zwe=T("editorError.border",{dark:null,light:null,hcDark:H.fromHex("#E47777").transparent(.8),hcLight:"#B5200D"},m("errorBorder","If set, color of double underlines for errors in the editor.")),t2=T("editorWarning.background",null,m("editorWarning.background","Background color of warning text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0),Eo=T("editorWarning.foreground",{dark:"#CCA700",light:"#BF8803",hcDark:"#FFD370",hcLight:"#895503"},m("editorWarning.foreground","Foreground color of warning squigglies in the editor.")),Yh=T("editorWarning.border",{dark:null,light:null,hcDark:H.fromHex("#FFCC00").transparent(.8),hcLight:H.fromHex("#FFCC00").transparent(.8)},m("warningBorder","If set, color of double underlines for warnings in the editor.")),Xwe=T("editorInfo.background",null,m("editorInfo.background","Background color of info text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0),mr=T("editorInfo.foreground",{dark:"#3794FF",light:"#1a85ff",hcDark:"#3794FF",hcLight:"#1a85ff"},m("editorInfo.foreground","Foreground color of info squigglies in the editor.")),Zh=T("editorInfo.border",{dark:null,light:null,hcDark:H.fromHex("#3794FF").transparent(.8),hcLight:"#292929"},m("infoBorder","If set, color of double underlines for infos in the editor.")),n2=T("editorHint.foreground",{dark:H.fromHex("#eeeeee").transparent(.7),light:"#6c6c6c",hcDark:null,hcLight:null},m("editorHint.foreground","Foreground color of hint squigglies in the editor.")),Qwe=T("editorHint.border",{dark:null,light:null,hcDark:H.fromHex("#eeeeee").transparent(.8),hcLight:"#292929"},m("hintBorder","If set, color of double underlines for hints in the editor.")),Jwe=T("editorLink.activeForeground",{dark:"#4E94CE",light:H.blue,hcDark:H.cyan,hcLight:"#292929"},m("activeLinkForeground","Color of active links.")),jh=T("editor.selectionBackground",{light:"#ADD6FF",dark:"#264F78",hcDark:"#f3f518",hcLight:"#0F4A85"},m("editorSelectionBackground","Color of the editor selection.")),i2=T("editor.selectionForeground",{light:null,dark:null,hcDark:"#000000",hcLight:H.white},m("editorSelectionForeground","Color of the selected text for high contrast.")),e_e=T("editor.inactiveSelectionBackground",{light:ye(jh,.5),dark:ye(jh,.5),hcDark:ye(jh,.7),hcLight:ye(jh,.5)},m("editorInactiveSelection","Color of the selection in an inactive editor. The color must not be opaque so as not to hide underlying decorations."),!0),t_e=T("editor.selectionHighlightBackground",{light:xk(jh,ss,.3,.6),dark:xk(jh,ss,.3,.6),hcDark:null,hcLight:null},m("editorSelectionHighlight","Color for regions with the same content as the selection. The color must not be opaque so as not to hide underlying decorations."),!0),n_e=T("editor.selectionHighlightBorder",{light:null,dark:null,hcDark:Pt,hcLight:Pt},m("editorSelectionHighlightBorder","Border color for regions with the same content as the selection.")),i_e=T("editor.findMatchBackground",{light:"#A8AC94",dark:"#515C6A",hcDark:null,hcLight:null},m("editorFindMatch","Color of the current search match.")),o_e=T("editor.findMatchForeground",null,m("editorFindMatchForeground","Text color of the current search match.")),Ws=T("editor.findMatchHighlightBackground",{light:"#EA5C0055",dark:"#EA5C0055",hcDark:null,hcLight:null},m("findMatchHighlight","Color of the other search matches. The color must not be opaque so as not to hide underlying decorations."),!0),r_e=T("editor.findMatchHighlightForeground",null,m("findMatchHighlightForeground","Foreground color of the other search matches."),!0),s_e=T("editor.findRangeHighlightBackground",{dark:"#3a3d4166",light:"#b4b4b44d",hcDark:null,hcLight:null},m("findRangeHighlight","Color of the range limiting the search. The color must not be opaque so as not to hide underlying decorations."),!0),a_e=T("editor.findMatchBorder",{light:null,dark:null,hcDark:Pt,hcLight:Pt},m("editorFindMatchBorder","Border color of the current search match.")),ec=T("editor.findMatchHighlightBorder",{light:null,dark:null,hcDark:Pt,hcLight:Pt},m("findMatchHighlightBorder","Border color of the other search matches.")),l_e=T("editor.findRangeHighlightBorder",{dark:null,light:null,hcDark:ye(Pt,.4),hcLight:ye(Pt,.4)},m("findRangeHighlightBorder","Border color of the range limiting the search. The color must not be opaque so as not to hide underlying decorations."),!0),d_e=T("editor.hoverHighlightBackground",{light:"#ADD6FF26",dark:"#264f7840",hcDark:"#ADD6FF26",hcLight:null},m("hoverHighlight","Highlight below the word for which a hover is shown. The color must not be opaque so as not to hide underlying decorations."),!0),XV=T("editorHoverWidget.background",ki,m("hoverBackground","Background color of the editor hover.")),c_e=T("editorHoverWidget.foreground",La,m("hoverForeground","Foreground color of the editor hover.")),u_e=T("editorHoverWidget.border",Rk,m("hoverBorder","Border color of the editor hover.")),p_e=T("editorHoverWidget.statusBarBackground",{dark:So(XV,.2),light:ro(XV,.05),hcDark:ki,hcLight:ki},m("statusBarBackground","Background color of the editor hover status bar.")),o2=T("editorInlayHint.foreground",{dark:"#969696",light:"#969696",hcDark:H.white,hcLight:H.black},m("editorInlayHintForeground","Foreground color of inline hints")),r2=T("editorInlayHint.background",{dark:ye(Gh,.1),light:ye(Gh,.1),hcDark:ye(H.white,.1),hcLight:ye(Gh,.1)},m("editorInlayHintBackground","Background color of inline hints")),h_e=T("editorInlayHint.typeForeground",o2,m("editorInlayHintForegroundTypes","Foreground color of inline hints for types")),m_e=T("editorInlayHint.typeBackground",r2,m("editorInlayHintBackgroundTypes","Background color of inline hints for types")),g_e=T("editorInlayHint.parameterForeground",o2,m("editorInlayHintForegroundParameter","Foreground color of inline hints for parameters")),f_e=T("editorInlayHint.parameterBackground",r2,m("editorInlayHintBackgroundParameter","Background color of inline hints for parameters")),G3=T("editorLightBulb.foreground",{dark:"#FFCC00",light:"#DDB100",hcDark:"#FFCC00",hcLight:"#007ACC"},m("editorLightBulbForeground","The color used for the lightbulb actions icon.")),b_e=T("editorLightBulbAutoFix.foreground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},m("editorLightBulbAutoFixForeground","The color used for the lightbulb auto fix actions icon.")),v_e=T("editorLightBulbAi.foreground",G3,m("editorLightBulbAiForeground","The color used for the lightbulb AI icon.")),y_e=T("editor.snippetTabstopHighlightBackground",{dark:new H(new tt(124,124,124,.3)),light:new H(new tt(10,50,100,.2)),hcDark:new H(new tt(124,124,124,.3)),hcLight:new H(new tt(10,50,100,.2))},m("snippetTabstopHighlightBackground","Highlight background color of a snippet tabstop.")),I_e=T("editor.snippetTabstopHighlightBorder",null,m("snippetTabstopHighlightBorder","Highlight border color of a snippet tabstop.")),C_e=T("editor.snippetFinalTabstopHighlightBackground",null,m("snippetFinalTabstopHighlightBackground","Highlight background color of the final tabstop of a snippet.")),S_e=T("editor.snippetFinalTabstopHighlightBorder",{dark:"#525252",light:new H(new tt(10,50,100,.5)),hcDark:"#525252",hcLight:"#292929"},m("snippetFinalTabstopHighlightBorder","Highlight border color of the final tabstop of a snippet.")),AS=new H(new tt(155,185,85,.2)),FS=new H(new tt(255,0,0,.2)),s2=T("diffEditor.insertedTextBackground",{dark:"#9ccc2c33",light:"#9ccc2c40",hcDark:null,hcLight:null},m("diffEditorInserted","Background color for text that got inserted. The color must not be opaque so as not to hide underlying decorations."),!0),a2=T("diffEditor.removedTextBackground",{dark:"#ff000033",light:"#ff000033",hcDark:null,hcLight:null},m("diffEditorRemoved","Background color for text that got removed. The color must not be opaque so as not to hide underlying decorations."),!0),E_e=T("diffEditor.insertedLineBackground",{dark:AS,light:AS,hcDark:null,hcLight:null},m("diffEditorInsertedLines","Background color for lines that got inserted. The color must not be opaque so as not to hide underlying decorations."),!0),T_e=T("diffEditor.removedLineBackground",{dark:FS,light:FS,hcDark:null,hcLight:null},m("diffEditorRemovedLines","Background color for lines that got removed. The color must not be opaque so as not to hide underlying decorations."),!0),x_e=T("diffEditorGutter.insertedLineBackground",null,m("diffEditorInsertedLineGutter","Background color for the margin where lines got inserted.")),w_e=T("diffEditorGutter.removedLineBackground",null,m("diffEditorRemovedLineGutter","Background color for the margin where lines got removed.")),l2=T("diffEditorOverview.insertedForeground",null,m("diffEditorOverviewInserted","Diff overview ruler foreground for inserted content.")),d2=T("diffEditorOverview.removedForeground",null,m("diffEditorOverviewRemoved","Diff overview ruler foreground for removed content.")),__e=T("diffEditor.insertedTextBorder",{dark:null,light:null,hcDark:"#33ff2eff",hcLight:"#374E06"},m("diffEditorInsertedOutline","Outline color for the text that got inserted.")),D_e=T("diffEditor.removedTextBorder",{dark:null,light:null,hcDark:"#FF008F",hcLight:"#AD0707"},m("diffEditorRemovedOutline","Outline color for text that got removed.")),L_e=T("diffEditor.border",{dark:null,light:null,hcDark:Ee,hcLight:Ee},m("diffEditorBorder","Border color between the two text editors.")),R_e=T("diffEditor.diagonalFill",{dark:"#cccccc33",light:"#22222233",hcDark:null,hcLight:null},m("diffDiagonalFill","Color of the diff editor's diagonal fill. The diagonal fill is used in side-by-side diff views.")),k_e=T("diffEditor.unchangedRegionBackground","sideBar.background",m("diffEditor.unchangedRegionBackground","The background color of unchanged blocks in the diff editor.")),M_e=T("diffEditor.unchangedRegionForeground","foreground",m("diffEditor.unchangedRegionForeground","The foreground color of unchanged blocks in the diff editor.")),P_e=T("diffEditor.unchangedCodeBackground",{dark:"#74747429",light:"#b8b8b829",hcDark:null,hcLight:null},m("diffEditor.unchangedCodeBackground","The background color of unchanged code in the diff editor.")),Xh=T("widget.shadow",{dark:ye(H.black,.36),light:ye(H.black,.16),hcDark:null,hcLight:null},m("widgetShadow","Shadow color of widgets such as find/replace inside the editor.")),Pb=T("widget.border",{dark:null,light:null,hcDark:Ee,hcLight:Ee},m("widgetBorder","Border color of widgets such as find/replace inside the editor.")),Mb=T("toolbar.hoverBackground",{dark:"#5a5d5e50",light:"#b8b8b850",hcDark:null,hcLight:null},m("toolbarHoverBackground","Toolbar background when hovering over actions using the mouse")),O_e=T("toolbar.hoverOutline",{dark:null,light:null,hcDark:Pt,hcLight:Pt},m("toolbarHoverOutline","Toolbar outline when hovering over actions using the mouse")),N_e=T("toolbar.activeBackground",{dark:So(Mb,.1),light:ro(Mb,.1),hcDark:null,hcLight:null},m("toolbarActiveBackground","Toolbar background when holding the mouse over actions")),c2=T("breadcrumb.foreground",ye(gt,.8),m("breadcrumbsFocusForeground","Color of focused breadcrumb items.")),u2=T("breadcrumb.background",ss,m("breadcrumbsBackground","Background color of breadcrumb items.")),kk=T("breadcrumb.focusForeground",{light:ro(gt,.2),dark:So(gt,.1),hcDark:So(gt,.1),hcLight:So(gt,.1)},m("breadcrumbsFocusForeground","Color of focused breadcrumb items.")),p2=T("breadcrumb.activeSelectionForeground",{light:ro(gt,.2),dark:So(gt,.1),hcDark:So(gt,.1),hcLight:So(gt,.1)},m("breadcrumbsSelectedForeground","Color of selected breadcrumb items.")),A_e=T("breadcrumbPicker.background",ki,m("breadcrumbsSelectedBackground","Background color of breadcrumb item picker.")),h2=.5,QV=H.fromHex("#40C8AE").transparent(h2),JV=H.fromHex("#40A6FF").transparent(h2),e2=H.fromHex("#606060").transparent(.4),Mk=.4,qh=1,_k=T("merge.currentHeaderBackground",{dark:QV,light:QV,hcDark:null,hcLight:null},m("mergeCurrentHeaderBackground","Current header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),F_e=T("merge.currentContentBackground",ye(_k,Mk),m("mergeCurrentContentBackground","Current content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),Dk=T("merge.incomingHeaderBackground",{dark:JV,light:JV,hcDark:null,hcLight:null},m("mergeIncomingHeaderBackground","Incoming header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),B_e=T("merge.incomingContentBackground",ye(Dk,Mk),m("mergeIncomingContentBackground","Incoming content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),Lk=T("merge.commonHeaderBackground",{dark:e2,light:e2,hcDark:null,hcLight:null},m("mergeCommonHeaderBackground","Common ancestor header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),V_e=T("merge.commonContentBackground",ye(Lk,Mk),m("mergeCommonContentBackground","Common ancestor content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),$h=T("merge.border",{dark:null,light:null,hcDark:"#C3DF6F",hcLight:"#007ACC"},m("mergeBorder","Border color on headers and the splitter in inline merge-conflicts.")),W_e=T("editorOverviewRuler.currentContentForeground",{dark:ye(_k,qh),light:ye(_k,qh),hcDark:$h,hcLight:$h},m("overviewRulerCurrentContentForeground","Current overview ruler foreground for inline merge-conflicts.")),H_e=T("editorOverviewRuler.incomingContentForeground",{dark:ye(Dk,qh),light:ye(Dk,qh),hcDark:$h,hcLight:$h},m("overviewRulerIncomingContentForeground","Incoming overview ruler foreground for inline merge-conflicts.")),U_e=T("editorOverviewRuler.commonContentForeground",{dark:ye(Lk,qh),light:ye(Lk,qh),hcDark:$h,hcLight:$h},m("overviewRulerCommonContentForeground","Common ancestor overview ruler foreground for inline merge-conflicts.")),z_e=T("editorOverviewRuler.findMatchForeground",{dark:"#d186167e",light:"#d186167e",hcDark:"#AB5A00",hcLight:"#AB5A00"},m("overviewRulerFindMatchForeground","Overview ruler marker color for find matches. The color must not be opaque so as not to hide underlying decorations."),!0),K_e=T("editorOverviewRuler.selectionHighlightForeground","#A0A0A0CC",m("overviewRulerSelectionHighlightForeground","Overview ruler marker color for selection highlights. The color must not be opaque so as not to hide underlying decorations."),!0),m2=T("problemsErrorIcon.foreground",Mu,m("problemsErrorIconForeground","The color used for the problems error icon.")),g2=T("problemsWarningIcon.foreground",Eo,m("problemsWarningIconForeground","The color used for the problems warning icon.")),f2=T("problemsInfoIcon.foreground",mr,m("problemsInfoIconForeground","The color used for the problems info icon."));var b2=T("minimap.findMatchHighlight",{light:"#d18616",dark:"#d18616",hcDark:"#AB5A00",hcLight:"#0F4A85"},m("minimapFindMatchHighlight","Minimap marker color for find matches."),!0),Z_e=T("minimap.selectionOccurrenceHighlight",{light:"#c9c9c9",dark:"#676767",hcDark:"#ffffff",hcLight:"#0F4A85"},m("minimapSelectionOccurrenceHighlight","Minimap marker color for repeating editor selections."),!0),Pk=T("minimap.selectionHighlight",{light:"#ADD6FF",dark:"#264F78",hcDark:"#ffffff",hcLight:"#0F4A85"},m("minimapSelectionHighlight","Minimap marker color for the editor selection."),!0),X_e=T("minimap.infoHighlight",{dark:mr,light:mr,hcDark:Zh,hcLight:Zh},m("minimapInfo","Minimap marker color for infos.")),Q_e=T("minimap.warningHighlight",{dark:Eo,light:Eo,hcDark:Yh,hcLight:Yh},m("overviewRuleWarning","Minimap marker color for warnings.")),J_e=T("minimap.errorHighlight",{dark:new H(new tt(255,18,18,.7)),light:new H(new tt(255,18,18,.7)),hcDark:new H(new tt(255,50,50,1)),hcLight:"#B5200D"},m("minimapError","Minimap marker color for errors.")),v2=T("minimap.background",null,m("minimapBackground","Minimap background color.")),y2=T("minimap.foregroundOpacity",H.fromHex("#000f"),m("minimapForegroundOpacity",'Opacity of foreground elements rendered in the minimap. For example, "#000000c0" will render the elements with 75% opacity.')),eDe=T("minimapSlider.background",ye(PS,.5),m("minimapSliderBackground","Minimap slider background color.")),tDe=T("minimapSlider.hoverBackground",ye(OS,.5),m("minimapSliderHoverBackground","Minimap slider background color when hovering.")),nDe=T("minimapSlider.activeBackground",ye(NS,.5),m("minimapSliderActiveBackground","Minimap slider background color when clicked on."));var lDe=T("charts.foreground",gt,m("chartsForeground","The foreground color used in charts.")),dDe=T("charts.lines",ye(gt,.5),m("chartsLines","The color used for horizontal lines in charts.")),cDe=T("charts.red",Mu,m("chartsRed","The red color used in chart visualizations.")),uDe=T("charts.blue",mr,m("chartsBlue","The blue color used in chart visualizations.")),pDe=T("charts.yellow",Eo,m("chartsYellow","The yellow color used in chart visualizations.")),hDe=T("charts.orange",b2,m("chartsOrange","The orange color used in chart visualizations.")),mDe=T("charts.green",{dark:"#89D185",light:"#388A34",hcDark:"#89D185",hcLight:"#374e06"},m("chartsGreen","The green color used in chart visualizations.")),gDe=T("charts.purple",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},m("chartsPurple","The purple color used in chart visualizations."));var I2=T("input.background",{dark:"#3C3C3C",light:H.white,hcDark:H.black,hcLight:H.white},m("inputBoxBackground","Input box background.")),C2=T("input.foreground",gt,m("inputBoxForeground","Input box foreground.")),em=T("input.border",{dark:null,light:null,hcDark:Ee,hcLight:Ee},m("inputBoxBorder","Input box border.")),Ok=T("inputOption.activeBorder",{dark:"#007ACC",light:"#007ACC",hcDark:Ee,hcLight:Ee},m("inputBoxActiveOptionBorder","Border color of activated options in input fields.")),j3=T("inputOption.hoverBackground",{dark:"#5a5d5e80",light:"#b8b8b850",hcDark:null,hcLight:null},m("inputOption.hoverBackground","Background color of activated options in input fields.")),Nk=T("inputOption.activeBackground",{dark:ye(so,.4),light:ye(so,.2),hcDark:H.transparent,hcLight:H.transparent},m("inputOption.activeBackground","Background hover color of options in input fields.")),Ak=T("inputOption.activeForeground",{dark:H.white,light:H.black,hcDark:gt,hcLight:gt},m("inputOption.activeForeground","Foreground color of activated options in input fields.")),CDe=T("input.placeholderForeground",{light:ye(gt,.5),dark:ye(gt,.5),hcDark:ye(gt,.7),hcLight:ye(gt,.7)},m("inputPlaceholderForeground","Input box foreground color for placeholder text.")),S2=T("inputValidation.infoBackground",{dark:"#063B49",light:"#D6ECF2",hcDark:H.black,hcLight:H.white},m("inputValidationInfoBackground","Input validation background color for information severity.")),E2=T("inputValidation.infoForeground",{dark:null,light:null,hcDark:null,hcLight:gt},m("inputValidationInfoForeground","Input validation foreground color for information severity.")),T2=T("inputValidation.infoBorder",{dark:"#007acc",light:"#007acc",hcDark:Ee,hcLight:Ee},m("inputValidationInfoBorder","Input validation border color for information severity.")),x2=T("inputValidation.warningBackground",{dark:"#352A05",light:"#F6F5D2",hcDark:H.black,hcLight:H.white},m("inputValidationWarningBackground","Input validation background color for warning severity.")),w2=T("inputValidation.warningForeground",{dark:null,light:null,hcDark:null,hcLight:gt},m("inputValidationWarningForeground","Input validation foreground color for warning severity.")),_2=T("inputValidation.warningBorder",{dark:"#B89500",light:"#B89500",hcDark:Ee,hcLight:Ee},m("inputValidationWarningBorder","Input validation border color for warning severity.")),D2=T("inputValidation.errorBackground",{dark:"#5A1D1D",light:"#F2DEDE",hcDark:H.black,hcLight:H.white},m("inputValidationErrorBackground","Input validation background color for error severity.")),L2=T("inputValidation.errorForeground",{dark:null,light:null,hcDark:null,hcLight:gt},m("inputValidationErrorForeground","Input validation foreground color for error severity.")),R2=T("inputValidation.errorBorder",{dark:"#BE1100",light:"#BE1100",hcDark:Ee,hcLight:Ee},m("inputValidationErrorBorder","Input validation border color for error severity.")),tm=T("dropdown.background",{dark:"#3C3C3C",light:H.white,hcDark:H.black,hcLight:H.white},m("dropdownBackground","Dropdown background.")),k2=T("dropdown.listBackground",{dark:null,light:null,hcDark:H.black,hcLight:H.white},m("dropdownListBackground","Dropdown list background.")),Ob=T("dropdown.foreground",{dark:"#F0F0F0",light:gt,hcDark:H.white,hcLight:gt},m("dropdownForeground","Dropdown foreground.")),Nb=T("dropdown.border",{dark:tm,light:"#CECECE",hcDark:Ee,hcLight:Ee},m("dropdownBorder","Dropdown border.")),Fk=T("button.foreground",H.white,m("buttonForeground","Button foreground color.")),M2=T("button.separator",ye(Fk,.4),m("buttonSeparator","Button separator color.")),Qh=T("button.background",{dark:"#0E639C",light:"#007ACC",hcDark:null,hcLight:"#0F4A85"},m("buttonBackground","Button background color.")),P2=T("button.hoverBackground",{dark:So(Qh,.2),light:ro(Qh,.2),hcDark:Qh,hcLight:Qh},m("buttonHoverBackground","Button background color when hovering.")),O2=T("button.border",Ee,m("buttonBorder","Button border color.")),N2=T("button.secondaryForeground",{dark:H.white,light:H.white,hcDark:H.white,hcLight:gt},m("buttonSecondaryForeground","Secondary button foreground color.")),BS=T("button.secondaryBackground",{dark:"#3A3D41",light:"#5F6A79",hcDark:null,hcLight:H.white},m("buttonSecondaryBackground","Secondary button background color.")),A2=T("button.secondaryHoverBackground",{dark:So(BS,.2),light:ro(BS,.2),hcDark:null,hcLight:null},m("buttonSecondaryHoverBackground","Secondary button background color when hovering.")),Jh=T("radio.activeForeground",Ak,m("radioActiveForeground","Foreground color of active radio option.")),F2=T("radio.activeBackground",Nk,m("radioBackground","Background color of active radio option.")),B2=T("radio.activeBorder",Ok,m("radioActiveBorder","Border color of the active radio option.")),V2=T("radio.inactiveForeground",null,m("radioInactiveForeground","Foreground color of inactive radio option.")),W2=T("radio.inactiveBackground",null,m("radioInactiveBackground","Background color of inactive radio option.")),H2=T("radio.inactiveBorder",{light:ye(Jh,.2),dark:ye(Jh,.2),hcDark:ye(Jh,.4),hcLight:ye(Jh,.2)},m("radioInactiveBorder","Border color of the inactive radio option.")),U2=T("radio.inactiveHoverBackground",j3,m("radioHoverBackground","Background color of inactive active radio option when hovering.")),z2=T("checkbox.background",tm,m("checkbox.background","Background color of checkbox widget.")),SDe=T("checkbox.selectBackground",ki,m("checkbox.select.background","Background color of checkbox widget when the element it's in is selected.")),K2=T("checkbox.foreground",Ob,m("checkbox.foreground","Foreground color of checkbox widget.")),G2=T("checkbox.border",Nb,m("checkbox.border","Border color of checkbox widget.")),EDe=T("checkbox.selectBorder",kb,m("checkbox.select.border","Border color of checkbox widget when the element it's in is selected.")),j2=T("keybindingLabel.background",{dark:new H(new tt(128,128,128,.17)),light:new H(new tt(221,221,221,.4)),hcDark:H.transparent,hcLight:H.transparent},m("keybindingLabelBackground","Keybinding label background color. The keybinding label is used to represent a keyboard shortcut.")),q2=T("keybindingLabel.foreground",{dark:H.fromHex("#CCCCCC"),light:H.fromHex("#555555"),hcDark:H.white,hcLight:gt},m("keybindingLabelForeground","Keybinding label foreground color. The keybinding label is used to represent a keyboard shortcut.")),$2=T("keybindingLabel.border",{dark:new H(new tt(51,51,51,.6)),light:new H(new tt(204,204,204,.4)),hcDark:new H(new tt(111,195,223)),hcLight:Ee},m("keybindingLabelBorder","Keybinding label border color. The keybinding label is used to represent a keyboard shortcut.")),Y2=T("keybindingLabel.bottomBorder",{dark:new H(new tt(68,68,68,.6)),light:new H(new tt(187,187,187,.4)),hcDark:new H(new tt(111,195,223)),hcLight:gt},m("keybindingLabelBottomBorder","Keybinding label border bottom color. The keybinding label is used to represent a keyboard shortcut."));var Z2=T("list.focusBackground",null,m("listFocusBackground","List/Tree background color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),X2=T("list.focusForeground",null,m("listFocusForeground","List/Tree foreground color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),Q2=T("list.focusOutline",{dark:so,light:so,hcDark:Pt,hcLight:Pt},m("listFocusOutline","List/Tree outline color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),J2=T("list.focusAndSelectionOutline",null,m("listFocusAndSelectionOutline","List/Tree outline color for the focused item when the list/tree is active and selected. An active list/tree has keyboard focus, an inactive does not.")),zo=T("list.activeSelectionBackground",{dark:"#04395E",light:"#0060C0",hcDark:null,hcLight:H.fromHex("#0F4A85").transparent(.1)},m("listActiveSelectionBackground","List/Tree background color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),Ra=T("list.activeSelectionForeground",{dark:H.white,light:H.white,hcDark:null,hcLight:null},m("listActiveSelectionForeground","List/Tree foreground color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),WS=T("list.activeSelectionIconForeground",null,m("listActiveSelectionIconForeground","List/Tree icon foreground color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),eW=T("list.inactiveSelectionBackground",{dark:"#37373D",light:"#E4E6F1",hcDark:null,hcLight:H.fromHex("#0F4A85").transparent(.1)},m("listInactiveSelectionBackground","List/Tree background color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),tW=T("list.inactiveSelectionForeground",null,m("listInactiveSelectionForeground","List/Tree foreground color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),nW=T("list.inactiveSelectionIconForeground",null,m("listInactiveSelectionIconForeground","List/Tree icon foreground color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),iW=T("list.inactiveFocusBackground",null,m("listInactiveFocusBackground","List/Tree background color for the focused item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),oW=T("list.inactiveFocusOutline",null,m("listInactiveFocusOutline","List/Tree outline color for the focused item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),Bk=T("list.hoverBackground",{dark:"#2A2D2E",light:"#F0F0F0",hcDark:H.white.transparent(.1),hcLight:H.fromHex("#0F4A85").transparent(.1)},m("listHoverBackground","List/Tree background when hovering over items using the mouse.")),Vk=T("list.hoverForeground",null,m("listHoverForeground","List/Tree foreground when hovering over items using the mouse.")),rW=T("list.dropBackground",{dark:"#062F4A",light:"#D6EBFF",hcDark:null,hcLight:null},m("listDropBackground","List/Tree drag and drop background when moving items over other items when using the mouse.")),sW=T("list.dropBetweenBackground",{dark:kb,light:kb,hcDark:null,hcLight:null},m("listDropBetweenBackground","List/Tree drag and drop border color when moving items between items when using the mouse.")),VS=T("list.highlightForeground",{dark:"#2AAAFF",light:"#0066BF",hcDark:so,hcLight:so},m("highlight","List/Tree foreground color of the match highlights when searching inside the list/tree.")),LDe=T("list.focusHighlightForeground",{dark:VS,light:jV(zo,VS,"#BBE7FF"),hcDark:VS,hcLight:VS},m("listFocusHighlightForeground","List/Tree foreground color of the match highlights on actively focused items when searching inside the list/tree.")),RDe=T("list.invalidItemForeground",{dark:"#B89500",light:"#B89500",hcDark:"#B89500",hcLight:"#B5200D"},m("invalidItemForeground","List/Tree foreground color for invalid items, for example an unresolved root in explorer.")),kDe=T("list.errorForeground",{dark:"#F88070",light:"#B01011",hcDark:null,hcLight:null},m("listErrorForeground","Foreground color of list items containing errors.")),MDe=T("list.warningForeground",{dark:"#CCA700",light:"#855F00",hcDark:null,hcLight:null},m("listWarningForeground","Foreground color of list items containing warnings.")),aW=T("listFilterWidget.background",{light:ro(ki,0),dark:So(ki,0),hcDark:ki,hcLight:ki},m("listFilterWidgetBackground","Background color of the type filter widget in lists and trees.")),lW=T("listFilterWidget.outline",{dark:H.transparent,light:H.transparent,hcDark:"#f38518",hcLight:"#007ACC"},m("listFilterWidgetOutline","Outline color of the type filter widget in lists and trees.")),dW=T("listFilterWidget.noMatchesOutline",{dark:"#BE1100",light:"#BE1100",hcDark:Ee,hcLight:Ee},m("listFilterWidgetNoMatchesOutline","Outline color of the type filter widget in lists and trees, when there are no matches.")),cW=T("listFilterWidget.shadow",Xh,m("listFilterWidgetShadow","Shadow color of the type filter widget in lists and trees.")),PDe=T("list.filterMatchBackground",{dark:Ws,light:Ws,hcDark:null,hcLight:null},m("listFilterMatchHighlight","Background color of the filtered match.")),ODe=T("list.filterMatchBorder",{dark:ec,light:ec,hcDark:Ee,hcLight:Pt},m("listFilterMatchHighlightBorder","Border color of the filtered match.")),NDe=T("list.deemphasizedForeground",{dark:"#8C8C8C",light:"#8E8E90",hcDark:"#A7A8A9",hcLight:"#666666"},m("listDeemphasizedForeground","List/Tree foreground color for items that are deemphasized.")),nm=T("tree.indentGuidesStroke",{dark:"#585858",light:"#a9a9a9",hcDark:"#a9a9a9",hcLight:"#a5a5a5"},m("treeIndentGuidesStroke","Tree stroke color for the indentation guides.")),uW=T("tree.inactiveIndentGuidesStroke",ye(nm,.4),m("treeInactiveIndentGuidesStroke","Tree stroke color for the indentation guides that are not active.")),pW=T("tree.tableColumnsBorder",{dark:"#CCCCCC20",light:"#61616120",hcDark:null,hcLight:null},m("tableColumnsBorder","Table border color between columns.")),hW=T("tree.tableOddRowsBackground",{dark:ye(gt,.04),light:ye(gt,.04),hcDark:null,hcLight:null},m("tableOddRowsBackgroundColor","Background color for odd table rows.")),ADe=T("editorActionList.background",ki,m("editorActionListBackground","Action List background color.")),FDe=T("editorActionList.foreground",La,m("editorActionListForeground","Action List foreground color.")),BDe=T("editorActionList.focusForeground",Ra,m("editorActionListFocusForeground","Action List foreground color for the focused item.")),VDe=T("editorActionList.focusBackground",zo,m("editorActionListFocusBackground","Action List background color for the focused item."));var mW=T("menu.border",{dark:null,light:null,hcDark:Ee,hcLight:Ee},m("menuBorder","Border color of menus.")),gW=T("menu.foreground",Ob,m("menuForeground","Foreground color of menu items.")),fW=T("menu.background",tm,m("menuBackground","Background color of menu items.")),bW=T("menu.selectionForeground",Ra,m("menuSelectionForeground","Foreground color of the selected menu item in menus.")),vW=T("menu.selectionBackground",zo,m("menuSelectionBackground","Background color of the selected menu item in menus.")),yW=T("menu.selectionBorder",{dark:null,light:null,hcDark:Pt,hcLight:Pt},m("menuSelectionBorder","Border color of the selected menu item in menus.")),IW=T("menu.separatorBackground",{dark:"#606060",light:"#D4D4D4",hcDark:Ee,hcLight:Ee},m("menuSeparatorBackground","Color of a separator menu item in menus."));var ZDe=T("quickInput.background",ki,m("pickerBackground","Quick picker background color. The quick picker widget is the container for pickers like the command palette.")),XDe=T("quickInput.foreground",La,m("pickerForeground","Quick picker foreground color. The quick picker widget is the container for pickers like the command palette.")),QDe=T("quickInputTitle.background",{dark:new H(new tt(255,255,255,.105)),light:new H(new tt(0,0,0,.06)),hcDark:"#000000",hcLight:H.white},m("pickerTitleBackground","Quick picker title background color. The quick picker widget is the container for pickers like the command palette.")),SW=T("pickerGroup.foreground",{dark:"#3794FF",light:"#0066BF",hcDark:H.white,hcLight:"#0F4A85"},m("pickerGroupForeground","Quick picker color for grouping labels.")),JDe=T("pickerGroup.border",{dark:"#3F3F46",light:"#CCCEDB",hcDark:H.white,hcLight:"#0F4A85"},m("pickerGroupBorder","Quick picker color for grouping borders.")),CW=T("quickInput.list.focusBackground",null,"",void 0,m("quickInput.list.focusBackground deprecation","Please use quickInputList.focusBackground instead")),EW=T("quickInputList.focusForeground",Ra,m("quickInput.listFocusForeground","Quick picker foreground color for the focused item.")),TW=T("quickInputList.focusIconForeground",WS,m("quickInput.listFocusIconForeground","Quick picker icon foreground color for the focused item.")),xW=T("quickInputList.focusBackground",{dark:Tk(CW,zo),light:Tk(CW,zo),hcDark:null,hcLight:null},m("quickInput.listFocusBackground","Quick picker background color for the focused item."));var oLe=T("search.resultsInfoForeground",{light:gt,dark:ye(gt,.65),hcDark:gt,hcLight:gt},m("search.resultsInfoForeground","Color of the text in the search viewlet's completion message.")),rLe=T("searchEditor.findMatchBackground",{light:ye(Ws,.66),dark:ye(Ws,.66),hcDark:Ws,hcLight:Ws},m("searchEditor.queryMatch","Color of the Search Editor query matches.")),sLe=T("searchEditor.findMatchBorder",{light:ye(ec,.66),dark:ye(ec,.66),hcDark:ec,hcLight:ec},m("searchEditor.editorFindMatchBorder","Border color of the Search Editor query matches."));function tc(o){return o==="hcDark"||o==="hcLight"}function Wk(o){return o==="dark"||o==="hcDark"}var Ko=Y("themeService");var FLe=te.file,BLe=te.folder;function Ab(o){switch(o){case"dark":return"vs-dark";case"hcDark":return"hc-black";case"hcLight":return"hc-light";default:return"vs"}}var $3={ThemingContribution:"base.contributions.theming"},Hk=class{themingParticipants=[];onThemingParticipantAddedEmitter;constructor(){this.themingParticipants=[],this.onThemingParticipantAddedEmitter=new D}onColorThemeChange(e){return this.themingParticipants.push(e),this.onThemingParticipantAddedEmitter.fire(e),le(()=>{let t=this.themingParticipants.indexOf(e);this.themingParticipants.splice(t,1)})}get onThemingParticipantAdded(){return this.onThemingParticipantAddedEmitter.event}getThemingParticipants(){return this.themingParticipants}},wW=new Hk;et.add($3.ThemingContribution,wW);function To(o){return wW.onColorThemeChange(o)}var HS=class extends F{constructor(t){super();this.themeService=t;this.theme=t.getColorTheme(),this._register(this.themeService.onDidColorThemeChange(n=>this.onThemeChange(n)))}theme;onThemeChange(t){this.theme=t,this.updateStyles()}updateStyles(){}getColor(t,n){let i=this.theme.getColor(t);return i&&n&&(i=n(i,this.theme)),i?i.toString():null}};var US=class{_theme;get type(){return this._theme.type}get value(){return this._theme}constructor(e){this._theme=e}update(e){this._theme=e}getColor(e){return this._theme.getColor(e)}};var zS=class{type=0;constructor(){}},KS=class{type=1;constructor(){}},GS=class{type=2;_source;constructor(e){this._source=e}hasChanged(e){return this._source.hasChanged(e)}},jS=class{constructor(e,t,n){this.selections=e;this.modelSelections=t;this.reason=n}type=3},ka=class{type=4;affectsMinimap;affectsOverviewRuler;affectsGlyphMargin;affectsLineNumber;constructor(e){e?(this.affectsMinimap=e.affectsMinimap,this.affectsOverviewRuler=e.affectsOverviewRuler,this.affectsGlyphMargin=e.affectsGlyphMargin,this.affectsLineNumber=e.affectsLineNumber):(this.affectsMinimap=!0,this.affectsOverviewRuler=!0,this.affectsGlyphMargin=!0,this.affectsLineNumber=!0)}},Pu=class{type=5;constructor(){}},qS=class{type=6;isFocused;constructor(e){this.isFocused=e}},$S=class{type=7},Ou=class{type=8;constructor(){}},Fb=class{constructor(e,t){this.fromLineNumber=e;this.count=t}type=9},im=class{type=10;fromLineNumber;toLineNumber;constructor(e,t){this.fromLineNumber=e,this.toLineNumber=t}},om=class{type=11;fromLineNumber;toLineNumber;constructor(e,t){this.fromLineNumber=e,this.toLineNumber=t}};var kl=class{constructor(e,t,n,i,r,s,a){this.source=e;this.minimalReveal=t;this.range=n;this.selections=i;this.verticalType=r;this.revealHorizontal=s;this.scrollType=a}type=12},YS=class{type=13;scrollWidth;scrollLeft;scrollHeight;scrollTop;scrollWidthChanged;scrollLeftChanged;scrollHeightChanged;scrollTopChanged;constructor(e){this.scrollWidth=e.scrollWidth,this.scrollLeft=e.scrollLeft,this.scrollHeight=e.scrollHeight,this.scrollTop=e.scrollTop,this.scrollWidthChanged=e.scrollWidthChanged,this.scrollLeftChanged=e.scrollLeftChanged,this.scrollHeightChanged=e.scrollHeightChanged,this.scrollTopChanged=e.scrollTopChanged}},ZS=class{constructor(e){this.theme=e}type=14},XS=class{type=15;ranges;constructor(e){this.ranges=e}},QS=class{type=16;constructor(){}},JS=class{type=17;constructor(){}};var as=class extends F{_shouldRender;constructor(){super(),this._shouldRender=!0}shouldRender(){return this._shouldRender}forceShouldRender(){this._shouldRender=!0}setShouldRender(){this._shouldRender=!0}onDidRender(){this._shouldRender=!1}onCompositionStart(e){return!1}onCompositionEnd(e){return!1}onConfigurationChanged(e){return!1}onCursorStateChanged(e){return!1}onDecorationsChanged(e){return!1}onFlushed(e){return!1}onFocusChanged(e){return!1}onLanguageConfigurationChanged(e){return!1}onLineMappingChanged(e){return!1}onLinesChanged(e){return!1}onLinesDeleted(e){return!1}onLinesInserted(e){return!1}onRevealRangeRequest(e){return!1}onScrollChanged(e){return!1}onThemeChanged(e){return!1}onTokensChanged(e){return!1}onTokensColorsChanged(e){return!1}onZonesChanged(e){return!1}handleEvents(e){let t=!1;for(let n=0,i=e.length;n<i;n++){let r=e[n];switch(r.type){case 0:this.onCompositionStart(r)&&(t=!0);break;case 1:this.onCompositionEnd(r)&&(t=!0);break;case 2:this.onConfigurationChanged(r)&&(t=!0);break;case 3:this.onCursorStateChanged(r)&&(t=!0);break;case 4:this.onDecorationsChanged(r)&&(t=!0);break;case 5:this.onFlushed(r)&&(t=!0);break;case 6:this.onFocusChanged(r)&&(t=!0);break;case 7:this.onLanguageConfigurationChanged(r)&&(t=!0);break;case 8:this.onLineMappingChanged(r)&&(t=!0);break;case 9:this.onLinesChanged(r)&&(t=!0);break;case 10:this.onLinesDeleted(r)&&(t=!0);break;case 11:this.onLinesInserted(r)&&(t=!0);break;case 12:this.onRevealRangeRequest(r)&&(t=!0);break;case 13:this.onScrollChanged(r)&&(t=!0);break;case 15:this.onTokensChanged(r)&&(t=!0);break;case 14:this.onThemeChanged(r)&&(t=!0);break;case 16:this.onTokensColorsChanged(r)&&(t=!0);break;case 17:this.onZonesChanged(r)&&(t=!0);break;default:console.info("View received unknown event: "),console.info(r)}}t&&(this._shouldRender=!0)}};var Bb=class{_viewportBrand=void 0;top;left;width;height;constructor(e,t,n,i){this.top=e|0,this.left=t|0,this.width=n|0,this.height=i|0}},eE=class{tabSize;data;constructor(e,t){this.tabSize=e,this.data=t}},Nu=class{_viewLineDataBrand=void 0;content;continuesWithWrappedLine;minColumn;maxColumn;startVisibleColumn;tokens;inlineDecorations;constructor(e,t,n,i,r,s,a){this.content=e,this.continuesWithWrappedLine=t,this.minColumn=n,this.maxColumn=i,this.startVisibleColumn=r,this.tokens=s,this.inlineDecorations=a}},Ma=class o{minColumn;maxColumn;content;continuesWithWrappedLine;containsRTL;isBasicASCII;tokens;inlineDecorations;tabSize;startVisibleColumn;constructor(e,t,n,i,r,s,a,l,d,c){this.minColumn=e,this.maxColumn=t,this.content=n,this.continuesWithWrappedLine=i,this.isBasicASCII=o.isBasicASCII(n,s),this.containsRTL=o.containsRTL(n,this.isBasicASCII,r),this.tokens=a,this.inlineDecorations=l,this.tabSize=d,this.startVisibleColumn=c}static isBasicASCII(e,t){return t?bf(e):!0}static containsRTL(e,t,n){return!t&&n?yl(e):!1}};var Ml=class{constructor(e,t,n){this.range=e;this.inlineClassName=t;this.type=n}},tE=class{constructor(e,t,n,i){this.startOffset=e;this.endOffset=t;this.inlineClassName=n;this.inlineClassNameAffectsLetterSpacing=i}toInlineDecoration(e){return new Ml(new P(e,this.startOffset+1,e,this.endOffset+1),this.inlineClassName,this.inlineClassNameAffectsLetterSpacing?3:0)}},sm=class{_viewModelDecorationBrand=void 0;range;options;constructor(e,t){this.range=e,this.options=t}},Au=class o{constructor(e,t,n){this.color=e;this.zIndex=t;this.data=n}static compareByRenderingProps(e,t){return e.zIndex===t.zIndex?e.color<t.color?-1:e.color>t.color?1:0:e.zIndex-t.zIndex}static equals(e,t){return e.color===t.color&&e.zIndex===t.zIndex&&zt(e.data,t.data)}static equalsArr(e,t){return zt(e,t,o.equals)}};var nE=class{_colorZoneBrand=void 0;from;to;colorId;constructor(e,t,n){this.from=e|0,this.to=t|0,this.colorId=n|0}static compare(e,t){return e.colorId===t.colorId?e.from===t.from?e.to-t.to:e.from-t.from:e.colorId-t.colorId}},Vb=class{_overviewRulerZoneBrand=void 0;startLineNumber;endLineNumber;heightInLines;color;_colorZone;constructor(e,t,n,i){this.startLineNumber=e,this.endLineNumber=t,this.heightInLines=n,this.color=i,this._colorZone=null}static compare(e,t){return e.color===t.color?e.startLineNumber===t.startLineNumber?e.heightInLines===t.heightInLines?e.endLineNumber-t.endLineNumber:e.heightInLines-t.heightInLines:e.startLineNumber-t.startLineNumber:e.color<t.color?-1:1}setColorZone(e){this._colorZone=e}getColorZones(){return this._colorZone}},iE=class{_getVerticalOffsetForLine;_zones;_colorZonesInvalid;_lineHeight;_domWidth;_domHeight;_outerHeight;_pixelRatio;_lastAssignedId;_color2Id;_id2Color;constructor(e){this._getVerticalOffsetForLine=e,this._zones=[],this._colorZonesInvalid=!1,this._lineHeight=0,this._domWidth=0,this._domHeight=0,this._outerHeight=0,this._pixelRatio=1,this._lastAssignedId=0,this._color2Id=Object.create(null),this._id2Color=[]}getId2Color(){return this._id2Color}setZones(e){this._zones=e,this._zones.sort(Vb.compare)}setLineHeight(e){return this._lineHeight===e?!1:(this._lineHeight=e,this._colorZonesInvalid=!0,!0)}setPixelRatio(e){this._pixelRatio=e,this._colorZonesInvalid=!0}getDOMWidth(){return this._domWidth}getCanvasWidth(){return this._domWidth*this._pixelRatio}setDOMWidth(e){return this._domWidth===e?!1:(this._domWidth=e,this._colorZonesInvalid=!0,!0)}getDOMHeight(){return this._domHeight}getCanvasHeight(){return this._domHeight*this._pixelRatio}setDOMHeight(e){return this._domHeight===e?!1:(this._domHeight=e,this._colorZonesInvalid=!0,!0)}getOuterHeight(){return this._outerHeight}setOuterHeight(e){return this._outerHeight===e?!1:(this._outerHeight=e,this._colorZonesInvalid=!0,!0)}resolveColorZones(){let e=this._colorZonesInvalid,t=Math.floor(this._lineHeight),n=Math.floor(this.getCanvasHeight()),i=Math.floor(this._outerHeight),r=n/i,s=Math.floor(4*this._pixelRatio/2),a=[];for(let l=0,d=this._zones.length;l<d;l++){let c=this._zones[l];if(!e){let E=c.getColorZones();if(E){a.push(E);continue}}let u=this._getVerticalOffsetForLine(c.startLineNumber),p=c.heightInLines===0?this._getVerticalOffsetForLine(c.endLineNumber)+t:u+c.heightInLines*t,h=Math.floor(r*u),f=Math.floor(r*p),g=Math.floor((h+f)/2),b=f-g;b<s&&(b=s),g-b<0&&(g=b),g+b>n&&(g=n-b);let v=c.color,y=this._color2Id[v];y||(y=++this._lastAssignedId,this._color2Id[v]=y,this._id2Color[y]=v);let S=new nE(g-b,g+b,y);c.setColorZone(S),a.push(S)}return this._colorZonesInvalid=!1,a.sort(nE.compare),a}};var ge;(He=>(He.editorSimpleInput=new $("editorSimpleInput",!1,!0),He.editorTextFocus=new $("editorTextFocus",!1,m("editorTextFocus","Whether the editor text has focus (cursor is blinking)")),He.focus=new $("editorFocus",!1,m("editorFocus","Whether the editor or an editor widget has focus (e.g. focus is in the find widget)")),He.textInputFocus=new $("textInputFocus",!1,m("textInputFocus","Whether an editor or a rich text input has focus (cursor is blinking)")),He.readOnly=new $("editorReadonly",!1,m("editorReadonly","Whether the editor is read-only")),He.inDiffEditor=new $("inDiffEditor",!1,m("inDiffEditor","Whether the context is a diff editor")),He.isEmbeddedDiffEditor=new $("isEmbeddedDiffEditor",!1,m("isEmbeddedDiffEditor","Whether the context is an embedded diff editor")),He.multiDiffEditorAllCollapsed=new $("multiDiffEditorAllCollapsed",void 0,m("multiDiffEditorAllCollapsed","Whether all files in multi diff editor are collapsed")),He.hasChanges=new $("diffEditorHasChanges",!1,m("diffEditorHasChanges","Whether the diff editor has changes")),He.comparingMovedCode=new $("comparingMovedCode",!1,m("comparingMovedCode","Whether a moved code block is selected for comparison")),He.accessibleDiffViewerVisible=new $("accessibleDiffViewerVisible",!1,m("accessibleDiffViewerVisible","Whether the accessible diff viewer is visible")),He.diffEditorRenderSideBySideInlineBreakpointReached=new $("diffEditorRenderSideBySideInlineBreakpointReached",!1,m("diffEditorRenderSideBySideInlineBreakpointReached","Whether the diff editor render side by side inline breakpoint is reached")),He.diffEditorInlineMode=new $("diffEditorInlineMode",!1,m("diffEditorInlineMode","Whether inline mode is active")),He.diffEditorOriginalWritable=new $("diffEditorOriginalWritable",!1,m("diffEditorOriginalWritable","Whether modified is writable in the diff editor")),He.diffEditorModifiedWritable=new $("diffEditorModifiedWritable",!1,m("diffEditorModifiedWritable","Whether modified is writable in the diff editor")),He.diffEditorOriginalUri=new $("diffEditorOriginalUri","",m("diffEditorOriginalUri","The uri of the original document")),He.diffEditorModifiedUri=new $("diffEditorModifiedUri","",m("diffEditorModifiedUri","The uri of the modified document")),He.columnSelection=new $("editorColumnSelection",!1,m("editorColumnSelection","Whether `editor.columnSelection` is enabled")),He.writable=He.readOnly.toNegated(),He.hasNonEmptySelection=new $("editorHasSelection",!1,m("editorHasSelection","Whether the editor has text selected")),He.hasOnlyEmptySelection=He.hasNonEmptySelection.toNegated(),He.hasMultipleSelections=new $("editorHasMultipleSelections",!1,m("editorHasMultipleSelections","Whether the editor has multiple selections")),He.hasSingleSelection=He.hasMultipleSelections.toNegated(),He.tabMovesFocus=new $("editorTabMovesFocus",!1,m("editorTabMovesFocus","Whether `Tab` will move focus out of the editor")),He.tabDoesNotMoveFocus=He.tabMovesFocus.toNegated(),He.isInEmbeddedEditor=new $("isInEmbeddedEditor",!1,!0),He.canUndo=new $("canUndo",!1,!0),He.canRedo=new $("canRedo",!1,!0),He.hoverVisible=new $("editorHoverVisible",!1,m("editorHoverVisible","Whether the editor hover is visible")),He.hoverFocused=new $("editorHoverFocused",!1,m("editorHoverFocused","Whether the editor hover is focused")),He.stickyScrollFocused=new $("stickyScrollFocused",!1,m("stickyScrollFocused","Whether the sticky scroll is focused")),He.stickyScrollVisible=new $("stickyScrollVisible",!1,m("stickyScrollVisible","Whether the sticky scroll is visible")),He.standaloneColorPickerVisible=new $("standaloneColorPickerVisible",!1,m("standaloneColorPickerVisible","Whether the standalone color picker is visible")),He.standaloneColorPickerFocused=new $("standaloneColorPickerFocused",!1,m("standaloneColorPickerFocused","Whether the standalone color picker is focused")),He.inCompositeEditor=new $("inCompositeEditor",void 0,m("inCompositeEditor","Whether the editor is part of a larger editor (e.g. notebooks)")),He.notInCompositeEditor=He.inCompositeEditor.toNegated(),He.languageId=new $("editorLangId","",m("editorLangId","The language identifier of the editor")),He.hasCompletionItemProvider=new $("editorHasCompletionItemProvider",!1,m("editorHasCompletionItemProvider","Whether the editor has a completion item provider")),He.hasCodeActionsProvider=new $("editorHasCodeActionsProvider",!1,m("editorHasCodeActionsProvider","Whether the editor has a code actions provider")),He.hasCodeLensProvider=new $("editorHasCodeLensProvider",!1,m("editorHasCodeLensProvider","Whether the editor has a code lens provider")),He.hasDefinitionProvider=new $("editorHasDefinitionProvider",!1,m("editorHasDefinitionProvider","Whether the editor has a definition provider")),He.hasDeclarationProvider=new $("editorHasDeclarationProvider",!1,m("editorHasDeclarationProvider","Whether the editor has a declaration provider")),He.hasImplementationProvider=new $("editorHasImplementationProvider",!1,m("editorHasImplementationProvider","Whether the editor has an implementation provider")),He.hasTypeDefinitionProvider=new $("editorHasTypeDefinitionProvider",!1,m("editorHasTypeDefinitionProvider","Whether the editor has a type definition provider")),He.hasHoverProvider=new $("editorHasHoverProvider",!1,m("editorHasHoverProvider","Whether the editor has a hover provider")),He.hasDocumentHighlightProvider=new $("editorHasDocumentHighlightProvider",!1,m("editorHasDocumentHighlightProvider","Whether the editor has a document highlight provider")),He.hasDocumentSymbolProvider=new $("editorHasDocumentSymbolProvider",!1,m("editorHasDocumentSymbolProvider","Whether the editor has a document symbol provider")),He.hasReferenceProvider=new $("editorHasReferenceProvider",!1,m("editorHasReferenceProvider","Whether the editor has a reference provider")),He.hasRenameProvider=new $("editorHasRenameProvider",!1,m("editorHasRenameProvider","Whether the editor has a rename provider")),He.hasSignatureHelpProvider=new $("editorHasSignatureHelpProvider",!1,m("editorHasSignatureHelpProvider","Whether the editor has a signature help provider")),He.hasInlayHintsProvider=new $("editorHasInlayHintsProvider",!1,m("editorHasInlayHintsProvider","Whether the editor has an inline hints provider")),He.hasDocumentFormattingProvider=new $("editorHasDocumentFormattingProvider",!1,m("editorHasDocumentFormattingProvider","Whether the editor has a document formatting provider")),He.hasDocumentSelectionFormattingProvider=new $("editorHasDocumentSelectionFormattingProvider",!1,m("editorHasDocumentSelectionFormattingProvider","Whether the editor has a document selection formatting provider")),He.hasMultipleDocumentFormattingProvider=new $("editorHasMultipleDocumentFormattingProvider",!1,m("editorHasMultipleDocumentFormattingProvider","Whether the editor has multiple document formatting providers")),He.hasMultipleDocumentSelectionFormattingProvider=new $("editorHasMultipleDocumentSelectionFormattingProvider",!1,m("editorHasMultipleDocumentSelectionFormattingProvider","Whether the editor has multiple document selection formatting providers"))))(ge||={});function Uk(o){let e=o;return typeof e?.resolve=="function"&&typeof e?.isResolved=="function"}var ao;(i=>{function o(r,s){if(r.start>=s.end||s.start>=r.end)return{start:0,end:0};let a=Math.max(r.start,s.start),l=Math.min(r.end,s.end);return l-a<=0?{start:0,end:0}:{start:a,end:l}}i.intersect=o;function e(r){return r.end-r.start<=0}i.isEmpty=e;function t(r,s){return!e(o(r,s))}i.intersects=t;function n(r,s){let a=[],l={start:r.start,end:Math.min(s.start,r.end)},d={start:Math.max(s.end,r.start),end:r.end};return e(l)||a.push(l),e(d)||a.push(d),a}i.relativeComplement=n})(ao||={});var oE={RESOURCES:"ResourceURLs",DOWNLOAD_URL:"DownloadURL",FILES:"Files",TEXT:mu.text,INTERNAL_URI_LIST:"application/vnd.code.uri-list"};var Pa=class{_hooks=new ee;_pointerMoveCallback=null;_onStopCallback=null;dispose(){this.stopMonitoring(!1),this._hooks.dispose()}stopMonitoring(e,t){if(!this.isMonitoring())return;this._hooks.clear(),this._pointerMoveCallback=null;let n=this._onStopCallback;this._onStopCallback=null,e&&n&&n(t)}isMonitoring(){return!!this._pointerMoveCallback}startMonitoring(e,t,n,i,r){this.isMonitoring()&&this.stopMonitoring(!1),this._pointerMoveCallback=i,this._onStopCallback=r;let s=e;try{e.setPointerCapture(t),this._hooks.add(le(()=>{try{e.releasePointerCapture(t)}catch{}}))}catch{s=Ce(e)}this._hooks.add(j(s,me.POINTER_MOVE,a=>{if(a.buttons!==n){this.stopMonitoring(!0);return}a.preventDefault(),this._pointerMoveCallback(a)})),this._hooks.add(j(s,me.POINTER_UP,a=>this.stopMonitoring(!0)))}};var lo=class extends F{onclick(e,t){this._register(j(e,me.CLICK,n=>t(new Yi(Ce(e),n))))}onmousedown(e,t){this._register(j(e,me.MOUSE_DOWN,n=>t(new Yi(Ce(e),n))))}onmouseover(e,t){this._register(j(e,me.MOUSE_OVER,n=>t(new Yi(Ce(e),n))))}onmouseleave(e,t){this._register(j(e,me.MOUSE_LEAVE,n=>t(new Yi(Ce(e),n))))}onkeydown(e,t){this._register(j(e,me.KEY_DOWN,n=>t(new mt(n))))}onkeyup(e,t){this._register(j(e,me.KEY_UP,n=>t(new mt(n))))}oninput(e,t){this._register(j(e,me.INPUT,t))}onblur(e,t){this._register(j(e,me.BLUR,t))}onfocus(e,t){this._register(j(e,me.FOCUS,t))}onchange(e,t){this._register(j(e,me.CHANGE,t))}ignoreGesture(e){return An.ignoreTarget(e)}};var nc=11,rE=class extends lo{_onActivate;bgDomNode;domNode;_pointerdownRepeatTimer;_pointerdownScheduleRepeatTimer;_pointerMoveMonitor;constructor(e){super(),this._onActivate=e.onActivate,this.bgDomNode=document.createElement("div"),this.bgDomNode.className="arrow-background",this.bgDomNode.style.position="absolute",this.bgDomNode.style.width=e.bgWidth+"px",this.bgDomNode.style.height=e.bgHeight+"px",typeof e.top<"u"&&(this.bgDomNode.style.top="0px"),typeof e.left<"u"&&(this.bgDomNode.style.left="0px"),typeof e.bottom<"u"&&(this.bgDomNode.style.bottom="0px"),typeof e.right<"u"&&(this.bgDomNode.style.right="0px"),this.domNode=document.createElement("div"),this.domNode.className=e.className,this.domNode.classList.add(...we.asClassNameArray(e.icon)),this.domNode.style.position="absolute",this.domNode.style.width=nc+"px",this.domNode.style.height=nc+"px",typeof e.top<"u"&&(this.domNode.style.top=e.top+"px"),typeof e.left<"u"&&(this.domNode.style.left=e.left+"px"),typeof e.bottom<"u"&&(this.domNode.style.bottom=e.bottom+"px"),typeof e.right<"u"&&(this.domNode.style.right=e.right+"px"),this._pointerMoveMonitor=this._register(new Pa),this._register(bn(this.bgDomNode,me.POINTER_DOWN,t=>this._arrowPointerDown(t))),this._register(bn(this.domNode,me.POINTER_DOWN,t=>this._arrowPointerDown(t))),this._pointerdownRepeatTimer=this._register(new Mh),this._pointerdownScheduleRepeatTimer=this._register(new Es)}_arrowPointerDown(e){if(!e.target||!(e.target instanceof Element))return;let t=()=>{this._pointerdownRepeatTimer.cancelAndSet(()=>this._onActivate(),1e3/24,Ce(e))};this._onActivate(),this._pointerdownRepeatTimer.cancel(),this._pointerdownScheduleRepeatTimer.cancelAndSet(t,200),this._pointerMoveMonitor.startMonitoring(e.target,e.pointerId,e.buttons,n=>{},()=>{this._pointerdownRepeatTimer.cancel(),this._pointerdownScheduleRepeatTimer.cancel()}),e.preventDefault()}};var ic=class o{_scrollbarSize;_oppositeScrollbarSize;_arrowSize;_visibleSize;_scrollSize;_scrollPosition;_computedAvailableSize;_computedIsNeeded;_computedSliderSize;_computedSliderRatio;_computedSliderPosition;constructor(e,t,n,i,r,s){this._scrollbarSize=Math.round(t),this._oppositeScrollbarSize=Math.round(n),this._arrowSize=Math.round(e),this._visibleSize=i,this._scrollSize=r,this._scrollPosition=s,this._computedAvailableSize=0,this._computedIsNeeded=!1,this._computedSliderSize=0,this._computedSliderRatio=0,this._computedSliderPosition=0,this._refreshComputedValues()}clone(){return new o(this._arrowSize,this._scrollbarSize,this._oppositeScrollbarSize,this._visibleSize,this._scrollSize,this._scrollPosition)}setVisibleSize(e){let t=Math.round(e);return this._visibleSize!==t?(this._visibleSize=t,this._refreshComputedValues(),!0):!1}setScrollSize(e){let t=Math.round(e);return this._scrollSize!==t?(this._scrollSize=t,this._refreshComputedValues(),!0):!1}setScrollPosition(e){let t=Math.round(e);return this._scrollPosition!==t?(this._scrollPosition=t,this._refreshComputedValues(),!0):!1}setScrollbarSize(e){this._scrollbarSize=Math.round(e)}setOppositeScrollbarSize(e){this._oppositeScrollbarSize=Math.round(e)}static _computeValues(e,t,n,i,r){let s=Math.max(0,n-e),a=Math.max(0,s-2*t),l=i>0&&i>n;if(!l)return{computedAvailableSize:Math.round(s),computedIsNeeded:l,computedSliderSize:Math.round(a),computedSliderRatio:0,computedSliderPosition:0};let d=Math.round(Math.max(20,Math.floor(n*a/i))),c=(a-d)/(i-n),u=r*c;return{computedAvailableSize:Math.round(s),computedIsNeeded:l,computedSliderSize:Math.round(d),computedSliderRatio:c,computedSliderPosition:Math.round(u)}}_refreshComputedValues(){let e=o._computeValues(this._oppositeScrollbarSize,this._arrowSize,this._visibleSize,this._scrollSize,this._scrollPosition);this._computedAvailableSize=e.computedAvailableSize,this._computedIsNeeded=e.computedIsNeeded,this._computedSliderSize=e.computedSliderSize,this._computedSliderRatio=e.computedSliderRatio,this._computedSliderPosition=e.computedSliderPosition}getArrowSize(){return this._arrowSize}getScrollPosition(){return this._scrollPosition}getRectangleLargeSize(){return this._computedAvailableSize}getRectangleSmallSize(){return this._scrollbarSize}isNeeded(){return this._computedIsNeeded}getSliderSize(){return this._computedSliderSize}getSliderPosition(){return this._computedSliderPosition}getDesiredScrollPositionFromOffset(e){if(!this._computedIsNeeded)return 0;let t=e-this._arrowSize-this._computedSliderSize/2;return Math.round(t/this._computedSliderRatio)}getDesiredScrollPositionFromOffsetPaged(e){if(!this._computedIsNeeded)return 0;let t=e-this._arrowSize,n=this._scrollPosition;return t<this._computedSliderPosition?n-=this._visibleSize:n+=this._visibleSize,n}getDesiredScrollPositionFromDelta(e){if(!this._computedIsNeeded)return 0;let t=this._computedSliderPosition+e;return Math.round(t/this._computedSliderRatio)}};var sE=class extends F{_visibility;_visibleClassName;_invisibleClassName;_domNode;_rawShouldBeVisible;_shouldBeVisible;_isNeeded;_isVisible;_revealTimer;constructor(e,t,n){super(),this._visibility=e,this._visibleClassName=t,this._invisibleClassName=n,this._domNode=null,this._isVisible=!1,this._isNeeded=!1,this._rawShouldBeVisible=!1,this._shouldBeVisible=!1,this._revealTimer=this._register(new Es)}setVisibility(e){this._visibility!==e&&(this._visibility=e,this._updateShouldBeVisible())}setShouldBeVisible(e){this._rawShouldBeVisible=e,this._updateShouldBeVisible()}_applyVisibilitySetting(){return this._visibility===2?!1:this._visibility===3?!0:this._rawShouldBeVisible}_updateShouldBeVisible(){let e=this._applyVisibilitySetting();this._shouldBeVisible!==e&&(this._shouldBeVisible=e,this.ensureVisibility())}setIsNeeded(e){this._isNeeded!==e&&(this._isNeeded=e,this.ensureVisibility())}setDomNode(e){this._domNode=e,this._domNode.setClassName(this._invisibleClassName),this.setShouldBeVisible(!1)}ensureVisibility(){if(!this._isNeeded){this._hide(!1);return}this._shouldBeVisible?this._reveal():this._hide(!0)}_reveal(){this._isVisible||(this._isVisible=!0,this._revealTimer.setIfNotSet(()=>{this._domNode?.setClassName(this._visibleClassName)},0))}_hide(e){this._revealTimer.cancel(),this._isVisible&&(this._isVisible=!1,this._domNode?.setClassName(this._invisibleClassName+(e?" fade":"")))}};var Y3=140,am=class extends lo{_host;_scrollable;_scrollByPage;_lazyRender;_scrollbarState;_visibilityController;_pointerMoveMonitor;domNode;slider;_shouldRender;constructor(e){super(),this._lazyRender=e.lazyRender,this._host=e.host,this._scrollable=e.scrollable,this._scrollByPage=e.scrollByPage,this._scrollbarState=e.scrollbarState,this._visibilityController=this._register(new sE(e.visibility,"visible scrollbar "+e.extraScrollbarClassName,"invisible scrollbar "+e.extraScrollbarClassName)),this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._pointerMoveMonitor=this._register(new Pa),this._shouldRender=!0,this.domNode=We(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this._visibilityController.setDomNode(this.domNode),this.domNode.setPosition("absolute"),this._register(j(this.domNode.domNode,me.POINTER_DOWN,t=>this._domNodePointerDown(t)))}_createArrow(e){let t=this._register(new rE(e));this.domNode.domNode.appendChild(t.bgDomNode),this.domNode.domNode.appendChild(t.domNode)}_createSlider(e,t,n,i){this.slider=We(document.createElement("div")),this.slider.setClassName("slider"),this.slider.setPosition("absolute"),this.slider.setTop(e),this.slider.setLeft(t),typeof n=="number"&&this.slider.setWidth(n),typeof i=="number"&&this.slider.setHeight(i),this.slider.setLayerHinting(!0),this.slider.setContain("strict"),this.domNode.domNode.appendChild(this.slider.domNode),this._register(j(this.slider.domNode,me.POINTER_DOWN,r=>{r.button===0&&(r.preventDefault(),this._sliderPointerDown(r))})),this.onclick(this.slider.domNode,r=>{r.leftButton&&r.stopPropagation()})}_onElementSize(e){return this._scrollbarState.setVisibleSize(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollSize(e){return this._scrollbarState.setScrollSize(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollPosition(e){return this._scrollbarState.setScrollPosition(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}beginReveal(){this._visibilityController.setShouldBeVisible(!0)}beginHide(){this._visibilityController.setShouldBeVisible(!1)}render(){this._shouldRender&&(this._shouldRender=!1,this._renderDomNode(this._scrollbarState.getRectangleLargeSize(),this._scrollbarState.getRectangleSmallSize()),this._updateSlider(this._scrollbarState.getSliderSize(),this._scrollbarState.getArrowSize()+this._scrollbarState.getSliderPosition()))}_domNodePointerDown(e){e.target===this.domNode.domNode&&this._onPointerDown(e)}delegatePointerDown(e){let t=this.domNode.domNode.getClientRects()[0].top,n=t+this._scrollbarState.getSliderPosition(),i=t+this._scrollbarState.getSliderPosition()+this._scrollbarState.getSliderSize(),r=this._sliderPointerPosition(e);n<=r&&r<=i?e.button===0&&(e.preventDefault(),this._sliderPointerDown(e)):this._onPointerDown(e)}_onPointerDown(e){let t,n;if(e.target===this.domNode.domNode&&typeof e.offsetX=="number"&&typeof e.offsetY=="number")t=e.offsetX,n=e.offsetY;else{let r=io(this.domNode.domNode);t=e.pageX-r.left,n=e.pageY-r.top}let i=this._pointerDownRelativePosition(t,n);this._setDesiredScrollPositionNow(this._scrollByPage?this._scrollbarState.getDesiredScrollPositionFromOffsetPaged(i):this._scrollbarState.getDesiredScrollPositionFromOffset(i)),e.button===0&&(e.preventDefault(),this._sliderPointerDown(e))}_sliderPointerDown(e){if(!e.target||!(e.target instanceof Element))return;let t=this._sliderPointerPosition(e),n=this._sliderOrthogonalPointerPosition(e),i=this._scrollbarState.clone();this.slider.toggleClassName("active",!0),this._pointerMoveMonitor.startMonitoring(e.target,e.pointerId,e.buttons,r=>{let s=this._sliderOrthogonalPointerPosition(r),a=Math.abs(s-n);if(pt&&a>Y3){this._setDesiredScrollPositionNow(i.getScrollPosition());return}let d=this._sliderPointerPosition(r)-t;this._setDesiredScrollPositionNow(i.getDesiredScrollPositionFromDelta(d))},()=>{this.slider.toggleClassName("active",!1),this._host.onDragEnd()}),this._host.onDragStart()}_setDesiredScrollPositionNow(e){let t={};this.writeScrollPosition(t,e),this._scrollable.setScrollPositionNow(t)}updateScrollbarSize(e){this._updateScrollbarSize(e),this._scrollbarState.setScrollbarSize(e),this._shouldRender=!0,this._lazyRender||this.render()}isNeeded(){return this._scrollbarState.isNeeded()}};var aE=class extends am{constructor(e,t,n){let i=e.getScrollDimensions(),r=e.getCurrentScrollPosition();if(super({lazyRender:t.lazyRender,host:n,scrollbarState:new ic(t.horizontalHasArrows?t.arrowSize:0,t.horizontal===2?0:t.horizontalScrollbarSize,t.vertical===2?0:t.verticalScrollbarSize,i.width,i.scrollWidth,r.scrollLeft),visibility:t.horizontal,extraScrollbarClassName:"horizontal",scrollable:e,scrollByPage:t.scrollByPage}),t.horizontalHasArrows){let s=(t.arrowSize-nc)/2,a=(t.horizontalScrollbarSize-nc)/2;this._createArrow({className:"scra",icon:te.scrollbarButtonLeft,top:a,left:s,bottom:void 0,right:void 0,bgWidth:t.arrowSize,bgHeight:t.horizontalScrollbarSize,onActivate:()=>this._host.onMouseWheel(new Nr(null,1,0))}),this._createArrow({className:"scra",icon:te.scrollbarButtonRight,top:a,left:void 0,bottom:void 0,right:s,bgWidth:t.arrowSize,bgHeight:t.horizontalScrollbarSize,onActivate:()=>this._host.onMouseWheel(new Nr(null,-1,0))})}this._createSlider(Math.floor((t.horizontalScrollbarSize-t.horizontalSliderSize)/2),0,void 0,t.horizontalSliderSize)}_updateSlider(e,t){this.slider.setWidth(e),this.slider.setLeft(t)}_renderDomNode(e,t){this.domNode.setWidth(e),this.domNode.setHeight(t),this.domNode.setLeft(0),this.domNode.setBottom(0)}onDidScroll(e){return this._shouldRender=this._onElementScrollSize(e.scrollWidth)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(e.scrollLeft)||this._shouldRender,this._shouldRender=this._onElementSize(e.width)||this._shouldRender,this._shouldRender}_pointerDownRelativePosition(e,t){return e}_sliderPointerPosition(e){return e.pageX}_sliderOrthogonalPointerPosition(e){return e.pageY}_updateScrollbarSize(e){this.slider.setHeight(e)}writeScrollPosition(e,t){e.scrollLeft=t}updateOptions(e){this.updateScrollbarSize(e.horizontal===2?0:e.horizontalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(e.vertical===2?0:e.verticalScrollbarSize),this._visibilityController.setVisibility(e.horizontal),this._scrollByPage=e.scrollByPage}};var lE=class extends am{constructor(e,t,n){let i=e.getScrollDimensions(),r=e.getCurrentScrollPosition();if(super({lazyRender:t.lazyRender,host:n,scrollbarState:new ic(t.verticalHasArrows?t.arrowSize:0,t.vertical===2?0:t.verticalScrollbarSize,0,i.height,i.scrollHeight,r.scrollTop),visibility:t.vertical,extraScrollbarClassName:"vertical",scrollable:e,scrollByPage:t.scrollByPage}),t.verticalHasArrows){let s=(t.arrowSize-nc)/2,a=(t.verticalScrollbarSize-nc)/2;this._createArrow({className:"scra",icon:te.scrollbarButtonUp,top:s,left:a,bottom:void 0,right:void 0,bgWidth:t.verticalScrollbarSize,bgHeight:t.arrowSize,onActivate:()=>this._host.onMouseWheel(new Nr(null,0,1))}),this._createArrow({className:"scra",icon:te.scrollbarButtonDown,top:void 0,left:a,bottom:s,right:void 0,bgWidth:t.verticalScrollbarSize,bgHeight:t.arrowSize,onActivate:()=>this._host.onMouseWheel(new Nr(null,0,-1))})}this._createSlider(0,Math.floor((t.verticalScrollbarSize-t.verticalSliderSize)/2),t.verticalSliderSize,void 0)}_updateSlider(e,t){this.slider.setHeight(e),this.slider.setTop(t)}_renderDomNode(e,t){this.domNode.setWidth(t),this.domNode.setHeight(e),this.domNode.setRight(0),this.domNode.setTop(0)}onDidScroll(e){return this._shouldRender=this._onElementScrollSize(e.scrollHeight)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(e.scrollTop)||this._shouldRender,this._shouldRender=this._onElementSize(e.height)||this._shouldRender,this._shouldRender}_pointerDownRelativePosition(e,t){return t}_sliderPointerPosition(e){return e.pageY}_sliderOrthogonalPointerPosition(e){return e.pageX}_updateScrollbarSize(e){this.slider.setWidth(e)}writeScrollPosition(e,t){e.scrollTop=t}updateOptions(e){this.updateScrollbarSize(e.vertical===2?0:e.verticalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(0),this._visibilityController.setVisibility(e.vertical),this._scrollByPage=e.scrollByPage}};var Z3=500,LW=50,RW=!0,zk=class{timestamp;deltaX;deltaY;score;constructor(e,t,n){this.timestamp=e,this.deltaX=t,this.deltaY=n,this.score=0}},Wb=class o{static INSTANCE=new o;_capacity;_memory;_front;_rear;constructor(){this._capacity=5,this._memory=[],this._front=-1,this._rear=-1}isPhysicalMouseWheel(){if(this._front===-1&&this._rear===-1)return!1;let e=1,t=0,n=1,i=this._rear;do{let r=i===this._front?e:Math.pow(2,-n);if(e-=r,t+=this._memory[i].score*r,i===this._front)break;i=(this._capacity+i-1)%this._capacity,n++}while(!0);return t<=.5}acceptStandardWheelEvent(e){if(jd){let t=Ce(e.browserEvent),n=ZB(t);this.accept(Date.now(),e.deltaX*n,e.deltaY*n)}else this.accept(Date.now(),e.deltaX,e.deltaY)}accept(e,t,n){let i=null,r=new zk(e,t,n);this._front===-1&&this._rear===-1?(this._memory[0]=r,this._front=0,this._rear=0):(i=this._memory[this._rear],this._rear=(this._rear+1)%this._capacity,this._rear===this._front&&(this._front=(this._front+1)%this._capacity),this._memory[this._rear]=r),r.score=this._computeScore(r,i)}_computeScore(e,t){if(Math.abs(e.deltaX)>0&&Math.abs(e.deltaY)>0)return 1;let n=.5;if((!this._isAlmostInt(e.deltaX)||!this._isAlmostInt(e.deltaY))&&(n+=.25),t){let i=Math.abs(e.deltaX),r=Math.abs(e.deltaY),s=Math.abs(t.deltaX),a=Math.abs(t.deltaY),l=Math.max(Math.min(i,s),1),d=Math.max(Math.min(r,a),1),c=Math.max(i,s),u=Math.max(r,a);c%l===0&&u%d===0&&(n-=.5)}return Math.min(Math.max(n,0),1)}_isAlmostInt(e){return Math.abs(Math.round(e)-e)<.01}},Hb=class extends lo{_options;_scrollable;_verticalScrollbar;_horizontalScrollbar;_domNode;_leftShadowDomNode;_topShadowDomNode;_topLeftShadowDomNode;_listenOnDomNode;_mouseWheelToDispose;_isDragging;_mouseIsOver;_hideTimeout;_shouldRender;_revealOnScroll;_onScroll=this._register(new D);onScroll=this._onScroll.event;_onWillScroll=this._register(new D);onWillScroll=this._onWillScroll.event;get options(){return this._options}constructor(e,t,n){super(),e.style.overflow="hidden",this._options=X3(t),this._scrollable=n,this._register(this._scrollable.onScroll(r=>{this._onWillScroll.fire(r),this._onDidScroll(r),this._onScroll.fire(r)}));let i={onMouseWheel:r=>this._onMouseWheel(r),onDragStart:()=>this._onDragStart(),onDragEnd:()=>this._onDragEnd()};this._verticalScrollbar=this._register(new lE(this._scrollable,this._options,i)),this._horizontalScrollbar=this._register(new aE(this._scrollable,this._options,i)),this._domNode=document.createElement("div"),this._domNode.className="monaco-scrollable-element "+this._options.className,this._domNode.setAttribute("role","presentation"),this._domNode.style.position="relative",this._domNode.style.overflow="hidden",this._domNode.appendChild(e),this._domNode.appendChild(this._horizontalScrollbar.domNode.domNode),this._domNode.appendChild(this._verticalScrollbar.domNode.domNode),this._options.useShadows?(this._leftShadowDomNode=We(document.createElement("div")),this._leftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._leftShadowDomNode.domNode),this._topShadowDomNode=We(document.createElement("div")),this._topShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topShadowDomNode.domNode),this._topLeftShadowDomNode=We(document.createElement("div")),this._topLeftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topLeftShadowDomNode.domNode)):(this._leftShadowDomNode=null,this._topShadowDomNode=null,this._topLeftShadowDomNode=null),this._listenOnDomNode=this._options.listenOnDomNode||this._domNode,this._mouseWheelToDispose=[],this._setListeningToMouseWheel(this._options.handleMouseWheel),this.onmouseover(this._listenOnDomNode,r=>this._onMouseOver(r)),this.onmouseleave(this._listenOnDomNode,r=>this._onMouseLeave(r)),this._hideTimeout=this._register(new Es),this._isDragging=!1,this._mouseIsOver=!1,this._shouldRender=!0,this._revealOnScroll=!0}dispose(){this._mouseWheelToDispose=wt(this._mouseWheelToDispose),super.dispose()}getDomNode(){return this._domNode}getOverviewRulerLayoutInfo(){return{parent:this._domNode,insertBefore:this._verticalScrollbar.domNode.domNode}}delegateVerticalScrollbarPointerDown(e){this._verticalScrollbar.delegatePointerDown(e)}getScrollDimensions(){return this._scrollable.getScrollDimensions()}setScrollDimensions(e){this._scrollable.setScrollDimensions(e,!1)}updateClassName(e){this._options.className=e,Ve&&(this._options.className+=" mac"),this._domNode.className="monaco-scrollable-element "+this._options.className}updateOptions(e){typeof e.handleMouseWheel<"u"&&(this._options.handleMouseWheel=e.handleMouseWheel,this._setListeningToMouseWheel(this._options.handleMouseWheel)),typeof e.mouseWheelScrollSensitivity<"u"&&(this._options.mouseWheelScrollSensitivity=e.mouseWheelScrollSensitivity),typeof e.fastScrollSensitivity<"u"&&(this._options.fastScrollSensitivity=e.fastScrollSensitivity),typeof e.scrollPredominantAxis<"u"&&(this._options.scrollPredominantAxis=e.scrollPredominantAxis),typeof e.horizontal<"u"&&(this._options.horizontal=e.horizontal),typeof e.vertical<"u"&&(this._options.vertical=e.vertical),typeof e.horizontalScrollbarSize<"u"&&(this._options.horizontalScrollbarSize=e.horizontalScrollbarSize),typeof e.verticalScrollbarSize<"u"&&(this._options.verticalScrollbarSize=e.verticalScrollbarSize),typeof e.scrollByPage<"u"&&(this._options.scrollByPage=e.scrollByPage),this._horizontalScrollbar.updateOptions(this._options),this._verticalScrollbar.updateOptions(this._options),this._options.lazyRender||this._render()}setRevealOnScroll(e){this._revealOnScroll=e}delegateScrollFromMouseWheelEvent(e){this._onMouseWheel(new Nr(e))}_setListeningToMouseWheel(e){if(this._mouseWheelToDispose.length>0!==e&&(this._mouseWheelToDispose=wt(this._mouseWheelToDispose),e)){let n=i=>{this._onMouseWheel(new Nr(i))};this._mouseWheelToDispose.push(j(this._listenOnDomNode,me.MOUSE_WHEEL,n,{passive:!1}))}}_onMouseWheel(e){if(e.browserEvent?.defaultPrevented)return;let t=Wb.INSTANCE;RW&&t.acceptStandardWheelEvent(e);let n=!1;if(e.deltaY||e.deltaX){let r=e.deltaY*this._options.mouseWheelScrollSensitivity,s=e.deltaX*this._options.mouseWheelScrollSensitivity;this._options.scrollPredominantAxis&&(this._options.scrollYToX&&s+r===0?s=r=0:Math.abs(r)>=Math.abs(s)?s=0:r=0),this._options.flipAxes&&([r,s]=[s,r]);let a=!Ve&&e.browserEvent&&e.browserEvent.shiftKey;(this._options.scrollYToX||a)&&!s&&(s=r,r=0),e.browserEvent&&e.browserEvent.altKey&&(s=s*this._options.fastScrollSensitivity,r=r*this._options.fastScrollSensitivity);let l=this._scrollable.getFutureScrollPosition(),d={};if(r){let c=LW*r,u=l.scrollTop-(c<0?Math.floor(c):Math.ceil(c));this._verticalScrollbar.writeScrollPosition(d,u)}if(s){let c=LW*s,u=l.scrollLeft-(c<0?Math.floor(c):Math.ceil(c));this._horizontalScrollbar.writeScrollPosition(d,u)}d=this._scrollable.validateScrollPosition(d),(l.scrollLeft!==d.scrollLeft||l.scrollTop!==d.scrollTop)&&(RW&&this._options.mouseWheelSmoothScroll&&t.isPhysicalMouseWheel()?this._scrollable.setScrollPositionSmooth(d):this._scrollable.setScrollPositionNow(d),n=!0)}let i=n;!i&&this._options.alwaysConsumeMouseWheel&&(i=!0),!i&&this._options.consumeMouseWheelIfScrollbarIsNeeded&&(this._verticalScrollbar.isNeeded()||this._horizontalScrollbar.isNeeded())&&(i=!0),i&&(e.preventDefault(),e.stopPropagation())}_onDidScroll(e){this._shouldRender=this._horizontalScrollbar.onDidScroll(e)||this._shouldRender,this._shouldRender=this._verticalScrollbar.onDidScroll(e)||this._shouldRender,this._options.useShadows&&(this._shouldRender=!0),this._revealOnScroll&&this._reveal(),this._options.lazyRender||this._render()}renderNow(){if(!this._options.lazyRender)throw new Error("Please use `lazyRender` together with `renderNow`!");this._render()}_render(){if(this._shouldRender&&(this._shouldRender=!1,this._horizontalScrollbar.render(),this._verticalScrollbar.render(),this._options.useShadows)){let e=this._scrollable.getCurrentScrollPosition(),t=e.scrollTop>0,n=e.scrollLeft>0,i=n?" left":"",r=t?" top":"",s=n||t?" top-left-corner":"";this._leftShadowDomNode.setClassName(`shadow${i}`),this._topShadowDomNode.setClassName(`shadow${r}`),this._topLeftShadowDomNode.setClassName(`shadow${s}${r}${i}`)}}_onDragStart(){this._isDragging=!0,this._reveal()}_onDragEnd(){this._isDragging=!1,this._hide()}_onMouseLeave(e){this._mouseIsOver=!1,this._hide()}_onMouseOver(e){this._mouseIsOver=!0,this._reveal()}_reveal(){this._verticalScrollbar.beginReveal(),this._horizontalScrollbar.beginReveal(),this._scheduleHide()}_hide(){!this._mouseIsOver&&!this._isDragging&&(this._verticalScrollbar.beginHide(),this._horizontalScrollbar.beginHide())}_scheduleHide(){!this._mouseIsOver&&!this._isDragging&&this._hideTimeout.cancelAndSet(()=>this._hide(),Z3)}},dE=class extends Hb{constructor(e,t){t=t||{},t.mouseWheelSmoothScroll=!1;let n=new xs({forceIntegerValues:!0,smoothScrollDuration:0,scheduleAtNextAnimationFrame:i=>ni(Ce(e),i)});super(e,t,n),this._register(n)}setScrollPosition(e){this._scrollable.setScrollPositionNow(e)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}},oc=class extends Hb{constructor(e,t,n){super(e,t,n)}setScrollPosition(e){e.reuseAnimation?this._scrollable.setScrollPositionSmooth(e,e.reuseAnimation):this._scrollable.setScrollPositionNow(e)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}},Fu=class extends Hb{_element;constructor(e,t){t=t||{},t.mouseWheelSmoothScroll=!1;let n=new xs({forceIntegerValues:!1,smoothScrollDuration:0,scheduleAtNextAnimationFrame:i=>ni(Ce(e),i)});super(e,t,n),this._register(n),this._element=e,this._register(this.onScroll(i=>{i.scrollTopChanged&&(this._element.scrollTop=i.scrollTop),i.scrollLeftChanged&&(this._element.scrollLeft=i.scrollLeft)})),this.scanDomNode()}setScrollPosition(e){this._scrollable.setScrollPositionNow(e)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}scanDomNode(){this.setScrollDimensions({width:this._element.clientWidth,scrollWidth:this._element.scrollWidth,height:this._element.clientHeight,scrollHeight:this._element.scrollHeight}),this.setScrollPosition({scrollLeft:this._element.scrollLeft,scrollTop:this._element.scrollTop})}};function X3(o){let e={lazyRender:typeof o.lazyRender<"u"?o.lazyRender:!1,className:typeof o.className<"u"?o.className:"",useShadows:typeof o.useShadows<"u"?o.useShadows:!0,handleMouseWheel:typeof o.handleMouseWheel<"u"?o.handleMouseWheel:!0,flipAxes:typeof o.flipAxes<"u"?o.flipAxes:!1,consumeMouseWheelIfScrollbarIsNeeded:typeof o.consumeMouseWheelIfScrollbarIsNeeded<"u"?o.consumeMouseWheelIfScrollbarIsNeeded:!1,alwaysConsumeMouseWheel:typeof o.alwaysConsumeMouseWheel<"u"?o.alwaysConsumeMouseWheel:!1,scrollYToX:typeof o.scrollYToX<"u"?o.scrollYToX:!1,mouseWheelScrollSensitivity:typeof o.mouseWheelScrollSensitivity<"u"?o.mouseWheelScrollSensitivity:1,fastScrollSensitivity:typeof o.fastScrollSensitivity<"u"?o.fastScrollSensitivity:5,scrollPredominantAxis:typeof o.scrollPredominantAxis<"u"?o.scrollPredominantAxis:!0,mouseWheelSmoothScroll:typeof o.mouseWheelSmoothScroll<"u"?o.mouseWheelSmoothScroll:!0,arrowSize:typeof o.arrowSize<"u"?o.arrowSize:11,listenOnDomNode:typeof o.listenOnDomNode<"u"?o.listenOnDomNode:null,horizontal:typeof o.horizontal<"u"?o.horizontal:1,horizontalScrollbarSize:typeof o.horizontalScrollbarSize<"u"?o.horizontalScrollbarSize:10,horizontalSliderSize:typeof o.horizontalSliderSize<"u"?o.horizontalSliderSize:0,horizontalHasArrows:typeof o.horizontalHasArrows<"u"?o.horizontalHasArrows:!1,vertical:typeof o.vertical<"u"?o.vertical:1,verticalScrollbarSize:typeof o.verticalScrollbarSize<"u"?o.verticalScrollbarSize:10,verticalHasArrows:typeof o.verticalHasArrows<"u"?o.verticalHasArrows:!1,verticalSliderSize:typeof o.verticalSliderSize<"u"?o.verticalSliderSize:0,scrollByPage:typeof o.scrollByPage<"u"?o.scrollByPage:!1};return e.horizontalSliderSize=typeof o.horizontalSliderSize<"u"?o.horizontalSliderSize:e.horizontalScrollbarSize,e.verticalSliderSize=typeof o.verticalSliderSize<"u"?o.verticalSliderSize:e.verticalScrollbarSize,Ve&&(e.className+=" mac"),e}function kW(o,e){let t=[];for(let n of e){if(o.start>=n.range.end)continue;if(o.end<n.range.start)break;let i=ao.intersect(o,n.range);ao.isEmpty(i)||t.push({range:i,size:n.size})}return t}function uE({start:o,end:e},t){return{start:o+t,end:e+t}}function Q3(o){let e=[],t=null;for(let n of o){let i=n.range.start,r=n.range.end,s=n.size;if(t&&s===t.size){t.range.end=r;continue}t={range:{start:i,end:r},size:s},e.push(t)}return e}function J3(...o){return Q3(o.reduce((e,t)=>e.concat(t),[]))}var cE=class{groups=[];_size=0;_paddingTop=0;get paddingTop(){return this._paddingTop}set paddingTop(e){this._size=this._size+e-this._paddingTop,this._paddingTop=e}constructor(e){this._paddingTop=e??0,this._size=this._paddingTop}splice(e,t,n=[]){let i=n.length-t,r=kW({start:0,end:e},this.groups),s=kW({start:e+t,end:Number.POSITIVE_INFINITY},this.groups).map(l=>({range:uE(l.range,i),size:l.size})),a=n.map((l,d)=>({range:{start:e+d,end:e+d+1},size:l.size}));this.groups=J3(r,a,s),this._size=this._paddingTop+this.groups.reduce((l,d)=>l+d.size*(d.range.end-d.range.start),0)}get count(){let e=this.groups.length;return e?this.groups[e-1].range.end:0}get size(){return this._size}indexAt(e){if(e<0)return-1;if(e<this._paddingTop)return 0;let t=0,n=this._paddingTop;for(let i of this.groups){let r=i.range.end-i.range.start,s=n+r*i.size;if(e<s)return t+Math.floor((e-n)/i.size);t+=r,n=s}return t}indexAfter(e){return Math.min(this.indexAt(e)+1,this.count)}positionAt(e){if(e<0)return-1;let t=0,n=0;for(let i of this.groups){let r=i.range.end-i.range.start,s=n+r;if(e<s)return this._paddingTop+t+(e-n)*i.size;t+=r*i.size,n=s}return-1}};var pE=class{constructor(e){this.renderers=e}cache=new Map;transactionNodesPendingRemoval=new Set;inTransaction=!1;alloc(e){let t=this.getTemplateCache(e).pop(),n=!1;if(t)n=this.transactionNodesPendingRemoval.has(t.domNode),n&&this.transactionNodesPendingRemoval.delete(t.domNode);else{let i=Ge(".monaco-list-row"),s=this.getRenderer(e).renderTemplate(i);t={domNode:i,templateId:e,templateData:s}}return{row:t,isReusingConnectedDomNode:n}}release(e){e&&this.releaseRow(e)}transact(e){if(this.inTransaction)throw new Error("Already in transaction");this.inTransaction=!0;try{e()}finally{for(let t of this.transactionNodesPendingRemoval)this.doRemoveNode(t);this.transactionNodesPendingRemoval.clear(),this.inTransaction=!1}}releaseRow(e){let{domNode:t,templateId:n}=e;t&&(this.inTransaction?this.transactionNodesPendingRemoval.add(t):this.doRemoveNode(t)),this.getTemplateCache(n).push(e)}doRemoveNode(e){e.classList.remove("scrolling"),e.remove()}getTemplateCache(e){let t=this.cache.get(e);return t||(t=[],this.cache.set(e,t)),t}dispose(){this.cache.forEach((e,t)=>{for(let n of e)this.getRenderer(t).disposeTemplate(n.templateData),n.templateData=null}),this.cache.clear(),this.transactionNodesPendingRemoval.clear()}getRenderer(e){let t=this.renderers.get(e);if(!t)throw new Error(`No renderer found for ${e}`);return t}};var MW=2e4,NW,Kk,PW,Gk,OW;function rc(o){NW&&(Kk.textContent!==o?(fi(PW),hE(Kk,o)):(fi(Kk),hE(PW,o)))}function Ub(o){NW&&(Gk.textContent!==o?(fi(OW),hE(Gk,o)):(fi(Gk),hE(OW,o)))}function hE(o,e){fi(o),e.length>MW&&(e=e.substr(0,MW)),o.textContent=e,o.style.visibility="hidden",o.style.visibility="visible"}var Bu={CurrentDragAndDropData:void 0};var Oa={useShadows:!0,verticalScrollMode:1,setRowLineHeight:!0,setRowHeight:!0,supportDynamicHeights:!1,dnd:{getDragElements(o){return[o]},getDragURI(){return null},onDragStart(){},onDragOver(){return!1},drop(){},dispose(){}},horizontalScrolling:!1,transformOptimization:!0,alwaysConsumeMouseWheel:!0},Pl=class{elements;_context;get context(){return this._context}set context(e){this._context=e}constructor(e){this.elements=e}update(){}getData(){return this.elements}},jk=class{elements;constructor(e){this.elements=e}update(){}getData(){return this.elements}},qk=class{types;files;constructor(){this.types=[],this.files=[]}update(e){if(e.types&&this.types.splice(0,this.types.length,...e.types),e.files){this.files.splice(0,this.files.length);for(let t=0;t<e.files.length;t++){let n=e.files.item(t);n&&(n.size||n.type)&&this.files.push(n)}}}getData(){return{types:this.types,files:this.files}}};function t6(o,e){return Array.isArray(o)&&Array.isArray(e)?zt(o,e):o===e}var $k=class{getSetSize;getPosInSet;getRole;isChecked;constructor(e){e?.getSetSize?this.getSetSize=e.getSetSize.bind(e):this.getSetSize=(t,n,i)=>i,e?.getPosInSet?this.getPosInSet=e.getPosInSet.bind(e):this.getPosInSet=(t,n)=>n+1,e?.getRole?this.getRole=e.getRole.bind(e):this.getRole=t=>"listitem",e?.isChecked?this.isChecked=e.isChecked.bind(e):this.isChecked=t=>{}}},gr=class gr{constructor(e,t,n,i=Oa){this.virtualDelegate=t;if(i.horizontalScrolling&&i.supportDynamicHeights)throw new Error("Horizontal scrolling and dynamic heights not supported simultaneously");this.items=[],this.itemId=0,this.rangeMap=this.createRangeMap(i.paddingTop??0);for(let s of n)this.renderers.set(s.templateId,s);this.cache=this.disposables.add(new pE(this.renderers)),this.lastRenderTop=0,this.lastRenderHeight=0,this.domNode=document.createElement("div"),this.domNode.className="monaco-list",this.domNode.classList.add(this.domId),this.domNode.tabIndex=0,this.domNode.classList.toggle("mouse-support",typeof i.mouseSupport=="boolean"?i.mouseSupport:!0),this._horizontalScrolling=i.horizontalScrolling??Oa.horizontalScrolling,this.domNode.classList.toggle("horizontal-scrolling",this._horizontalScrolling),this.paddingBottom=typeof i.paddingBottom>"u"?0:i.paddingBottom,this.accessibilityProvider=new $k(i.accessibilityProvider),this.rowsContainer=document.createElement("div"),this.rowsContainer.className="monaco-list-rows",(i.transformOptimization??Oa.transformOptimization)&&(this.rowsContainer.style.transform="translate3d(0px, 0px, 0px)",this.rowsContainer.style.overflow="hidden",this.rowsContainer.style.contain="strict"),this.disposables.add(An.addTarget(this.rowsContainer)),this.scrollable=this.disposables.add(new xs({forceIntegerValues:!0,smoothScrollDuration:i.smoothScrolling??!1?125:0,scheduleAtNextAnimationFrame:s=>ni(Ce(this.domNode),s)})),this.scrollableElement=this.disposables.add(new oc(this.rowsContainer,{alwaysConsumeMouseWheel:i.alwaysConsumeMouseWheel??Oa.alwaysConsumeMouseWheel,horizontal:1,vertical:i.verticalScrollMode??Oa.verticalScrollMode,useShadows:i.useShadows??Oa.useShadows,mouseWheelScrollSensitivity:i.mouseWheelScrollSensitivity,fastScrollSensitivity:i.fastScrollSensitivity,scrollByPage:i.scrollByPage},this.scrollable)),this.domNode.appendChild(this.scrollableElement.getDomNode()),e.appendChild(this.domNode),this.scrollableElement.onScroll(this.onScroll,this,this.disposables),this.disposables.add(j(this.rowsContainer,Et.Change,s=>this.onTouchChange(s))),this.disposables.add(j(this.scrollableElement.getDomNode(),"scroll",s=>s.target.scrollTop=0)),this.disposables.add(j(this.domNode,"dragover",s=>this.onDragOver(this.toDragEvent(s)))),this.disposables.add(j(this.domNode,"drop",s=>this.onDrop(this.toDragEvent(s)))),this.disposables.add(j(this.domNode,"dragleave",s=>this.onDragLeave(this.toDragEvent(s)))),this.disposables.add(j(this.domNode,"dragend",s=>this.onDragEnd(s))),this.setRowLineHeight=i.setRowLineHeight??Oa.setRowLineHeight,this.setRowHeight=i.setRowHeight??Oa.setRowHeight,this.supportDynamicHeights=i.supportDynamicHeights??Oa.supportDynamicHeights,this.dnd=i.dnd??this.disposables.add(Oa.dnd),this.layout(i.initialSize?.height,i.initialSize?.width)}static InstanceCount=0;domId=`list_id_${++gr.InstanceCount}`;domNode;items;itemId;rangeMap;cache;renderers=new Map;lastRenderTop;lastRenderHeight;renderWidth=0;rowsContainer;scrollable;scrollableElement;_scrollHeight=0;scrollableElementUpdateDisposable=null;scrollableElementWidthDelayer=new Ss(50);splicing=!1;dragOverAnimationDisposable;dragOverAnimationStopDisposable=F.None;dragOverMouseY=0;setRowLineHeight;setRowHeight;supportDynamicHeights;paddingBottom;accessibilityProvider;scrollWidth;dnd;canDrop=!1;currentDragData;currentDragFeedback;currentDragFeedbackPosition;currentDragFeedbackDisposable=F.None;onDragLeaveTimeout=F.None;disposables=new ee;_onDidChangeContentHeight=new D;_onDidChangeContentWidth=new D;onDidChangeContentHeight=q.latch(this._onDidChangeContentHeight.event,void 0,this.disposables);onDidChangeContentWidth=q.latch(this._onDidChangeContentWidth.event,void 0,this.disposables);get contentHeight(){return this.rangeMap.size}get contentWidth(){return this.scrollWidth??0}get onDidScroll(){return this.scrollableElement.onScroll}get onWillScroll(){return this.scrollableElement.onWillScroll}get containerDomNode(){return this.rowsContainer}get scrollableElementDomNode(){return this.scrollableElement.getDomNode()}_horizontalScrolling=!1;get horizontalScrolling(){return this._horizontalScrolling}set horizontalScrolling(e){if(e!==this._horizontalScrolling){if(e&&this.supportDynamicHeights)throw new Error("Horizontal scrolling and dynamic heights not supported simultaneously");if(this._horizontalScrolling=e,this.domNode.classList.toggle("horizontal-scrolling",this._horizontalScrolling),this._horizontalScrolling){for(let t of this.items)this.measureItemWidth(t);this.updateScrollWidth(),this.scrollableElement.setScrollDimensions({width:Nh(this.domNode)}),this.rowsContainer.style.width=`${Math.max(this.scrollWidth||0,this.renderWidth)}px`}else this.scrollableElementWidthDelayer.cancel(),this.scrollableElement.setScrollDimensions({width:this.renderWidth,scrollWidth:this.renderWidth}),this.rowsContainer.style.width=""}}updateOptions(e){e.paddingBottom!==void 0&&(this.paddingBottom=e.paddingBottom,this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight})),e.smoothScrolling!==void 0&&this.scrollable.setSmoothScrollDuration(e.smoothScrolling?125:0),e.horizontalScrolling!==void 0&&(this.horizontalScrolling=e.horizontalScrolling);let t;if(e.scrollByPage!==void 0&&(t={...t??{},scrollByPage:e.scrollByPage}),e.mouseWheelScrollSensitivity!==void 0&&(t={...t??{},mouseWheelScrollSensitivity:e.mouseWheelScrollSensitivity}),e.fastScrollSensitivity!==void 0&&(t={...t??{},fastScrollSensitivity:e.fastScrollSensitivity}),t&&this.scrollableElement.updateOptions(t),e.paddingTop!==void 0&&e.paddingTop!==this.rangeMap.paddingTop){let n=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),i=e.paddingTop-this.rangeMap.paddingTop;this.rangeMap.paddingTop=e.paddingTop,this.render(n,Math.max(0,this.lastRenderTop+i),this.lastRenderHeight,void 0,void 0,!0),this.setScrollTop(this.lastRenderTop),this.eventuallyUpdateScrollDimensions(),this.supportDynamicHeights&&this._rerender(this.lastRenderTop,this.lastRenderHeight)}}delegateScrollFromMouseWheelEvent(e){this.scrollableElement.delegateScrollFromMouseWheelEvent(e)}delegateVerticalScrollbarPointerDown(e){this.scrollableElement.delegateVerticalScrollbarPointerDown(e)}updateElementHeight(e,t,n){if(e<0||e>=this.items.length)return;let i=this.items[e].size;if(typeof t>"u"){if(!this.supportDynamicHeights){console.warn("Dynamic heights not supported",new Error().stack);return}this.items[e].lastDynamicHeightWidth=void 0,t=i+this.probeDynamicHeight(e)}if(i===t)return;let r=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),s=0;e<r.start||n!==null&&n>e&&n<r.end?s=t-i:s=0,this.rangeMap.splice(e,1,[{size:t}]),this.items[e].size=t,this.render(r,Math.max(0,this.lastRenderTop+s),this.lastRenderHeight,void 0,void 0,!0),this.setScrollTop(this.lastRenderTop),this.eventuallyUpdateScrollDimensions(),this.supportDynamicHeights&&this._rerender(this.lastRenderTop,this.lastRenderHeight)}createRangeMap(e){return new cE(e)}splice(e,t,n=[]){if(this.splicing)throw new Error("Can't run recursive splices.");this.splicing=!0;try{return this._splice(e,t,n)}finally{this.splicing=!1,this._onDidChangeContentHeight.fire(this.contentHeight)}}_splice(e,t,n=[]){let i=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),r={start:e,end:e+t},s=ao.intersect(i,r),a=new Map;for(let C=s.end-1;C>=s.start;C--){let w=this.items[C];if(w.dragStartDisposable.dispose(),w.checkedDisposable.dispose(),w.row){let _=a.get(w.templateId);_||(_=[],a.set(w.templateId,_));let L=this.renderers.get(w.templateId);L&&L.disposeElement&&L.disposeElement(w.element,C,w.row.templateData,w.size),_.unshift(w.row)}w.row=null,w.stale=!0}let l={start:e+t,end:this.items.length},d=ao.intersect(l,i),c=ao.relativeComplement(l,i),u=n.map(C=>({id:String(this.itemId++),element:C,templateId:this.virtualDelegate.getTemplateId(C),size:this.virtualDelegate.getHeight(C),width:void 0,hasDynamicHeight:!!this.virtualDelegate.hasDynamicHeight&&this.virtualDelegate.hasDynamicHeight(C),lastDynamicHeightWidth:void 0,row:null,uri:void 0,dropTarget:!1,dragStartDisposable:F.None,checkedDisposable:F.None,stale:!1})),p;e===0&&t>=this.items.length?(this.rangeMap=this.createRangeMap(this.rangeMap.paddingTop),this.rangeMap.splice(0,0,u),p=this.items,this.items=u):(this.rangeMap.splice(e,t,u),p=this.items.splice(e,t,...u));let h=n.length-t,f=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),g=uE(d,h),b=ao.intersect(f,g);for(let C=b.start;C<b.end;C++)this.updateItemInDOM(this.items[C],C);let v=ao.relativeComplement(g,f);for(let C of v)for(let w=C.start;w<C.end;w++)this.removeItemFromDOM(w);let y=c.map(C=>uE(C,h)),E=[{start:e,end:e+n.length},...y].map(C=>ao.intersect(f,C)).reverse();for(let C of E)for(let w=C.end-1;w>=C.start;w--){let _=this.items[w],k=a.get(_.templateId)?.pop();this.insertItemInDOM(w,k)}for(let C of a.values())for(let w of C)this.cache.release(w);return this.eventuallyUpdateScrollDimensions(),this.supportDynamicHeights&&this._rerender(this.scrollTop,this.renderHeight),p.map(C=>C.element)}eventuallyUpdateScrollDimensions(){this._scrollHeight=this.contentHeight,this.rowsContainer.style.height=`${this._scrollHeight}px`,this.scrollableElementUpdateDisposable||(this.scrollableElementUpdateDisposable=ni(Ce(this.domNode),()=>{this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight}),this.updateScrollWidth(),this.scrollableElementUpdateDisposable=null}))}eventuallyUpdateScrollWidth(){if(!this.horizontalScrolling){this.scrollableElementWidthDelayer.cancel();return}this.scrollableElementWidthDelayer.trigger(()=>this.updateScrollWidth())}updateScrollWidth(){if(!this.horizontalScrolling)return;let e=0;for(let t of this.items)typeof t.width<"u"&&(e=Math.max(e,t.width));this.scrollWidth=e,this.scrollableElement.setScrollDimensions({scrollWidth:e===0?0:e+10}),this._onDidChangeContentWidth.fire(this.scrollWidth)}updateWidth(e){if(!this.horizontalScrolling||typeof this.scrollWidth>"u")return;let t=this.items[e];this.measureItemWidth(t),typeof t.width<"u"&&t.width>this.scrollWidth&&(this.scrollWidth=t.width,this.scrollableElement.setScrollDimensions({scrollWidth:this.scrollWidth+10}),this._onDidChangeContentWidth.fire(this.scrollWidth))}rerender(){if(this.supportDynamicHeights){for(let e of this.items)e.lastDynamicHeightWidth=void 0;this._rerender(this.lastRenderTop,this.lastRenderHeight)}}get length(){return this.items.length}get renderHeight(){return this.scrollableElement.getScrollDimensions().height}get firstVisibleIndex(){return this.getRenderRange(this.lastRenderTop,this.lastRenderHeight).start}get firstMostlyVisibleIndex(){let e=this.firstVisibleIndex,t=this.rangeMap.positionAt(e),n=this.rangeMap.positionAt(e+1);return n!==-1&&(n-t)/2+t<this.scrollTop?e+1:e}get lastVisibleIndex(){return this.getRenderRange(this.lastRenderTop,this.lastRenderHeight).end-1}element(e){return this.items[e].element}indexOf(e){return this.items.findIndex(t=>t.element===e)}domElement(e){let t=this.items[e].row;return t&&t.domNode}elementHeight(e){return this.items[e].size}elementTop(e){return this.rangeMap.positionAt(e)}indexAt(e){return this.rangeMap.indexAt(e)}indexAfter(e){return this.rangeMap.indexAfter(e)}layout(e,t){let n={height:typeof e=="number"?e:bS(this.domNode)};this.scrollableElementUpdateDisposable&&(this.scrollableElementUpdateDisposable.dispose(),this.scrollableElementUpdateDisposable=null,n.scrollHeight=this.scrollHeight),this.scrollableElement.setScrollDimensions(n),typeof t<"u"&&(this.renderWidth=t,this.supportDynamicHeights&&this._rerender(this.scrollTop,this.renderHeight)),this.horizontalScrolling&&this.scrollableElement.setScrollDimensions({width:typeof t=="number"?t:Nh(this.domNode)})}render(e,t,n,i,r,s=!1){let a=this.getRenderRange(t,n),l=ao.relativeComplement(a,e).reverse(),d=ao.relativeComplement(e,a);if(s){let c=ao.intersect(e,a);for(let u=c.start;u<c.end;u++)this.updateItemInDOM(this.items[u],u)}this.cache.transact(()=>{for(let c of d)for(let u=c.start;u<c.end;u++)this.removeItemFromDOM(u);for(let c of l)for(let u=c.end-1;u>=c.start;u--)this.insertItemInDOM(u)}),i!==void 0&&(this.rowsContainer.style.left=`-${i}px`),this.rowsContainer.style.top=`-${t}px`,this.horizontalScrolling&&r!==void 0&&(this.rowsContainer.style.width=`${Math.max(r,this.renderWidth)}px`),this.lastRenderTop=t,this.lastRenderHeight=n}insertItemInDOM(e,t){let n=this.items[e];if(!n.row)if(t)n.row=t,n.stale=!0;else{let l=this.cache.alloc(n.templateId);n.row=l.row,n.stale||=l.isReusingConnectedDomNode}let i=this.accessibilityProvider.getRole(n.element)||"listitem";n.row.domNode.setAttribute("role",i);let r=this.accessibilityProvider.isChecked(n.element);if(typeof r=="boolean")n.row.domNode.setAttribute("aria-checked",String(!!r));else if(r){let l=d=>n.row.domNode.setAttribute("aria-checked",String(!!d));l(r.value),n.checkedDisposable=r.onDidChange(()=>l(r.value))}if(n.stale||!n.row.domNode.parentElement){let l=this.items.at(e+1)?.row?.domNode??null;(n.row.domNode.parentElement!==this.rowsContainer||n.row.domNode.nextElementSibling!==l)&&this.rowsContainer.insertBefore(n.row.domNode,l),n.stale=!1}this.updateItemInDOM(n,e);let s=this.renderers.get(n.templateId);if(!s)throw new Error(`No renderer found for template id ${n.templateId}`);s?.renderElement(n.element,e,n.row.templateData,n.size);let a=this.dnd.getDragURI(n.element);n.dragStartDisposable.dispose(),n.row.domNode.draggable=!!a,a&&(n.dragStartDisposable=j(n.row.domNode,"dragstart",l=>this.onDragStart(n.element,a,l))),this.horizontalScrolling&&(this.measureItemWidth(n),this.eventuallyUpdateScrollWidth())}measureItemWidth(e){if(!e.row||!e.row.domNode)return;e.row.domNode.style.width="fit-content",e.width=Nh(e.row.domNode);let t=Ce(e.row.domNode).getComputedStyle(e.row.domNode);t.paddingLeft&&(e.width+=parseFloat(t.paddingLeft)),t.paddingRight&&(e.width+=parseFloat(t.paddingRight)),e.row.domNode.style.width=""}updateItemInDOM(e,t){e.row.domNode.style.top=`${this.elementTop(t)}px`,this.setRowHeight&&(e.row.domNode.style.height=`${e.size}px`),this.setRowLineHeight&&(e.row.domNode.style.lineHeight=`${e.size}px`),e.row.domNode.setAttribute("data-index",`${t}`),e.row.domNode.setAttribute("data-last-element",t===this.length-1?"true":"false"),e.row.domNode.setAttribute("data-parity",t%2===0?"even":"odd"),e.row.domNode.setAttribute("aria-setsize",String(this.accessibilityProvider.getSetSize(e.element,t,this.length))),e.row.domNode.setAttribute("aria-posinset",String(this.accessibilityProvider.getPosInSet(e.element,t))),e.row.domNode.setAttribute("id",this.getElementDomId(t)),e.row.domNode.classList.toggle("drop-target",e.dropTarget)}removeItemFromDOM(e){let t=this.items[e];if(t.dragStartDisposable.dispose(),t.checkedDisposable.dispose(),t.row){let n=this.renderers.get(t.templateId);n&&n.disposeElement&&n.disposeElement(t.element,e,t.row.templateData,t.size),this.cache.release(t.row),t.row=null}this.horizontalScrolling&&this.eventuallyUpdateScrollWidth()}getScrollTop(){return this.scrollableElement.getScrollPosition().scrollTop}setScrollTop(e,t){this.scrollableElementUpdateDisposable&&(this.scrollableElementUpdateDisposable.dispose(),this.scrollableElementUpdateDisposable=null,this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight})),this.scrollableElement.setScrollPosition({scrollTop:e,reuseAnimation:t})}getScrollLeft(){return this.scrollableElement.getScrollPosition().scrollLeft}setScrollLeft(e){this.scrollableElementUpdateDisposable&&(this.scrollableElementUpdateDisposable.dispose(),this.scrollableElementUpdateDisposable=null,this.scrollableElement.setScrollDimensions({scrollWidth:this.scrollWidth})),this.scrollableElement.setScrollPosition({scrollLeft:e})}get scrollTop(){return this.getScrollTop()}set scrollTop(e){this.setScrollTop(e)}get scrollHeight(){return this._scrollHeight+(this.horizontalScrolling?10:0)+this.paddingBottom}get onMouseClick(){return q.map(this.disposables.add(new Ae(this.domNode,"click")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseDblClick(){return q.map(this.disposables.add(new Ae(this.domNode,"dblclick")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseMiddleClick(){return q.filter(q.map(this.disposables.add(new Ae(this.domNode,"auxclick")).event,e=>this.toMouseEvent(e),this.disposables),e=>e.browserEvent.button===1,this.disposables)}get onMouseUp(){return q.map(this.disposables.add(new Ae(this.domNode,"mouseup")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseDown(){return q.map(this.disposables.add(new Ae(this.domNode,"mousedown")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseOver(){return q.map(this.disposables.add(new Ae(this.domNode,"mouseover")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseMove(){return q.map(this.disposables.add(new Ae(this.domNode,"mousemove")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseOut(){return q.map(this.disposables.add(new Ae(this.domNode,"mouseout")).event,e=>this.toMouseEvent(e),this.disposables)}get onContextMenu(){return q.any(q.map(this.disposables.add(new Ae(this.domNode,"contextmenu")).event,e=>this.toMouseEvent(e),this.disposables),q.map(this.disposables.add(new Ae(this.domNode,Et.Contextmenu)).event,e=>this.toGestureEvent(e),this.disposables))}get onTouchStart(){return q.map(this.disposables.add(new Ae(this.domNode,"touchstart")).event,e=>this.toTouchEvent(e),this.disposables)}get onTap(){return q.map(this.disposables.add(new Ae(this.rowsContainer,Et.Tap)).event,e=>this.toGestureEvent(e),this.disposables)}toMouseEvent(e){let t=this.getItemIndexFromEventTarget(e.target||null),n=typeof t>"u"?void 0:this.items[t],i=n&&n.element;return{browserEvent:e,index:t,element:i}}toTouchEvent(e){let t=this.getItemIndexFromEventTarget(e.target||null),n=typeof t>"u"?void 0:this.items[t],i=n&&n.element;return{browserEvent:e,index:t,element:i}}toGestureEvent(e){let t=this.getItemIndexFromEventTarget(e.initialTarget||null),n=typeof t>"u"?void 0:this.items[t],i=n&&n.element;return{browserEvent:e,index:t,element:i}}toDragEvent(e){let t=this.getItemIndexFromEventTarget(e.target||null),n=typeof t>"u"?void 0:this.items[t],i=n&&n.element,r=this.getTargetSector(e,t);return{browserEvent:e,index:t,element:i,sector:r}}onScroll(e){try{let t=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight);this.render(t,e.scrollTop,e.height,e.scrollLeft,e.scrollWidth),this.supportDynamicHeights&&this._rerender(e.scrollTop,e.height,e.inSmoothScrolling)}catch(t){throw console.error("Got bad scroll event:",e),t}}onTouchChange(e){e.preventDefault(),e.stopPropagation(),this.scrollTop-=e.translationY}onDragStart(e,t,n){if(!n.dataTransfer)return;let i=this.dnd.getDragElements(e);if(n.dataTransfer.effectAllowed="copyMove",n.dataTransfer.setData(oE.TEXT,t),n.dataTransfer.setDragImage){let r;this.dnd.getDragLabel&&(r=this.dnd.getDragLabel(i,n)),typeof r>"u"&&(r=String(i.length));let s=Ge(".monaco-drag-image");s.textContent=r,(d=>{for(;d&&!d.classList.contains("monaco-workbench");)d=d.parentElement;return d||this.domNode.ownerDocument})(this.domNode).appendChild(s),n.dataTransfer.setDragImage(s,-10,-10),setTimeout(()=>s.remove(),0)}this.domNode.classList.add("dragging"),this.currentDragData=new Pl(i),Bu.CurrentDragAndDropData=new jk(i),this.dnd.onDragStart?.(this.currentDragData,n)}onDragOver(e){if(e.browserEvent.preventDefault(),this.onDragLeaveTimeout.dispose(),Bu.CurrentDragAndDropData&&Bu.CurrentDragAndDropData.getData()==="vscode-ui"||(this.setupDragAndDropScrollTopAnimation(e.browserEvent),!e.browserEvent.dataTransfer))return!1;if(!this.currentDragData)if(Bu.CurrentDragAndDropData)this.currentDragData=Bu.CurrentDragAndDropData;else{if(!e.browserEvent.dataTransfer.types)return!1;this.currentDragData=new qk}let t=this.dnd.onDragOver(this.currentDragData,e.element,e.index,e.sector,e.browserEvent);if(this.canDrop=typeof t=="boolean"?t:t.accept,!this.canDrop)return this.currentDragFeedback=void 0,this.currentDragFeedbackDisposable.dispose(),!1;e.browserEvent.dataTransfer.dropEffect=typeof t!="boolean"&&t.effect?.type===0?"copy":"move";let n;typeof t!="boolean"&&t.feedback?n=t.feedback:typeof e.index>"u"?n=[-1]:n=[e.index],n=Tr(n).filter(r=>r>=-1&&r<this.length).sort((r,s)=>r-s),n=n[0]===-1?[-1]:n;let i=typeof t!="boolean"&&t.effect&&t.effect.position?t.effect.position:"drop-target";if(t6(this.currentDragFeedback,n)&&this.currentDragFeedbackPosition===i)return!0;if(this.currentDragFeedback=n,this.currentDragFeedbackPosition=i,this.currentDragFeedbackDisposable.dispose(),n[0]===-1)this.domNode.classList.add(i),this.rowsContainer.classList.add(i),this.currentDragFeedbackDisposable=le(()=>{this.domNode.classList.remove(i),this.rowsContainer.classList.remove(i)});else{if(n.length>1&&i!=="drop-target")throw new Error("Can't use multiple feedbacks with position different than 'over'");i==="drop-target-after"&&n[0]<this.length-1&&(n[0]+=1,i="drop-target-before");for(let r of n){let s=this.items[r];s.dropTarget=!0,s.row?.domNode.classList.add(i)}this.currentDragFeedbackDisposable=le(()=>{for(let r of n){let s=this.items[r];s.dropTarget=!1,s.row?.domNode.classList.remove(i)}})}return!0}onDragLeave(e){this.onDragLeaveTimeout.dispose(),this.onDragLeaveTimeout=wf(()=>this.clearDragOverFeedback(),100,this.disposables),this.currentDragData&&this.dnd.onDragLeave?.(this.currentDragData,e.element,e.index,e.browserEvent)}onDrop(e){if(!this.canDrop)return;let t=this.currentDragData;this.teardownDragAndDropScrollTopAnimation(),this.clearDragOverFeedback(),this.domNode.classList.remove("dragging"),this.currentDragData=void 0,Bu.CurrentDragAndDropData=void 0,!(!t||!e.browserEvent.dataTransfer)&&(e.browserEvent.preventDefault(),t.update(e.browserEvent.dataTransfer),this.dnd.drop(t,e.element,e.index,e.sector,e.browserEvent))}onDragEnd(e){this.canDrop=!1,this.teardownDragAndDropScrollTopAnimation(),this.clearDragOverFeedback(),this.domNode.classList.remove("dragging"),this.currentDragData=void 0,Bu.CurrentDragAndDropData=void 0,this.dnd.onDragEnd?.(e)}clearDragOverFeedback(){this.currentDragFeedback=void 0,this.currentDragFeedbackPosition=void 0,this.currentDragFeedbackDisposable.dispose(),this.currentDragFeedbackDisposable=F.None}setupDragAndDropScrollTopAnimation(e){if(!this.dragOverAnimationDisposable){let t=Eb(this.domNode).top;this.dragOverAnimationDisposable=MV(Ce(this.domNode),this.animateDragAndDropScrollTop.bind(this,t))}this.dragOverAnimationStopDisposable.dispose(),this.dragOverAnimationStopDisposable=wf(()=>{this.dragOverAnimationDisposable&&(this.dragOverAnimationDisposable.dispose(),this.dragOverAnimationDisposable=void 0)},1e3,this.disposables),this.dragOverMouseY=e.pageY}animateDragAndDropScrollTop(e){if(this.dragOverMouseY===void 0)return;let t=this.dragOverMouseY-e,n=this.renderHeight-35;t<35?this.scrollTop+=Math.max(-14,Math.floor(.3*(t-35))):t>n&&(this.scrollTop+=Math.min(14,Math.floor(.3*(t-n))))}teardownDragAndDropScrollTopAnimation(){this.dragOverAnimationStopDisposable.dispose(),this.dragOverAnimationDisposable&&(this.dragOverAnimationDisposable.dispose(),this.dragOverAnimationDisposable=void 0)}getTargetSector(e,t){if(t===void 0)return;let n=e.offsetY/this.items[t].size,i=Math.floor(n/.25);return Ri(i,0,3)}getItemIndexFromEventTarget(e){let t=this.scrollableElement.getDomNode(),n=e;for(;(Nn(n)||_V(n))&&n!==this.rowsContainer&&t.contains(n);){let i=n.getAttribute("data-index");if(i){let r=Number(i);if(!isNaN(r))return r}n=n.parentElement}}getRenderRange(e,t){return{start:this.rangeMap.indexAt(e),end:this.rangeMap.indexAfter(e+t-1)}}_rerender(e,t,n){let i=this.getRenderRange(e,t),r,s;e===this.elementTop(i.start)?(r=i.start,s=0):i.end-i.start>1&&(r=i.start+1,s=this.elementTop(r)-e);let a=0;for(;;){let l=this.getRenderRange(e,t),d=!1;for(let c=l.start;c<l.end;c++){let u=this.probeDynamicHeight(c);u!==0&&this.rangeMap.splice(c,1,[this.items[c]]),a+=u,d=d||u!==0}if(!d){a!==0&&this.eventuallyUpdateScrollDimensions();let c=ao.relativeComplement(i,l);for(let p of c)for(let h=p.start;h<p.end;h++)this.items[h].row&&this.removeItemFromDOM(h);let u=ao.relativeComplement(l,i).reverse();for(let p of u)for(let h=p.end-1;h>=p.start;h--)this.insertItemInDOM(h);for(let p=l.start;p<l.end;p++)this.items[p].row&&this.updateItemInDOM(this.items[p],p);if(typeof r=="number"){let p=this.scrollable.getFutureScrollPosition().scrollTop-e,h=this.elementTop(r)-s+p;this.setScrollTop(h,n)}this._onDidChangeContentHeight.fire(this.contentHeight);return}}}probeDynamicHeight(e){let t=this.items[e];if(this.virtualDelegate.getDynamicHeight){let s=this.virtualDelegate.getDynamicHeight(t.element);if(s!==null){let a=t.size;return t.size=s,t.lastDynamicHeightWidth=this.renderWidth,s-a}}if(!t.hasDynamicHeight||t.lastDynamicHeightWidth===this.renderWidth||this.virtualDelegate.hasDynamicHeight&&!this.virtualDelegate.hasDynamicHeight(t.element))return 0;let n=t.size;if(t.row)return t.row.domNode.style.height="",t.size=t.row.domNode.offsetHeight,t.size===0&&!is(t.row.domNode,Ce(t.row.domNode).document.body)&&console.warn("Measuring item node that is not in DOM! Add ListView to the DOM before measuring row height!",new Error().stack),t.lastDynamicHeightWidth=this.renderWidth,t.size-n;let{row:i}=this.cache.alloc(t.templateId);i.domNode.style.height="",this.rowsContainer.appendChild(i.domNode);let r=this.renderers.get(t.templateId);if(!r)throw new Ye("Missing renderer for templateId: "+t.templateId);return r.renderElement(t.element,e,i.templateData,void 0),t.size=i.domNode.offsetHeight,r.disposeElement?.(t.element,e,i.templateData,void 0),this.virtualDelegate.setDynamicHeight?.(t.element,t.size),t.lastDynamicHeightWidth=this.renderWidth,i.domNode.remove(),this.cache.release(i),t.size-n}getElementDomId(e){return`${this.domId}_${e}`}dispose(){for(let e of this.items)if(e.dragStartDisposable.dispose(),e.checkedDisposable.dispose(),e.row){let t=this.renderers.get(e.row.templateId);t&&(t.disposeElement?.(e.element,-1,e.row.templateData,void 0),t.disposeTemplate(e.row.templateData))}this.items=[],this.domNode?.remove(),this.dragOverAnimationDisposable?.dispose(),this.disposables.dispose()}};O([he],gr.prototype,"onMouseClick",1),O([he],gr.prototype,"onMouseDblClick",1),O([he],gr.prototype,"onMouseMiddleClick",1),O([he],gr.prototype,"onMouseUp",1),O([he],gr.prototype,"onMouseDown",1),O([he],gr.prototype,"onMouseOver",1),O([he],gr.prototype,"onMouseMove",1),O([he],gr.prototype,"onMouseOut",1),O([he],gr.prototype,"onContextMenu",1),O([he],gr.prototype,"onTouchStart",1),O([he],gr.prototype,"onTap",1);var mE=gr;var Na=class extends Error{constructor(e,t){super(`ListError [${e}] ${t}`)}};var gE=class{constructor(e){this.spliceables=e}splice(e,t,n){this.spliceables.forEach(i=>i.splice(e,t,n))}};var Yk=class{constructor(e){this.trait=e}renderedElements=[];get templateId(){return`template:${this.trait.name}`}renderTemplate(e){return e}renderElement(e,t,n){let i=this.renderedElements.findIndex(r=>r.templateData===n);if(i>=0){let r=this.renderedElements[i];this.trait.unrender(n),r.index=t}else{let r={index:t,templateData:n};this.renderedElements.push(r)}this.trait.renderIndex(t,n)}splice(e,t,n){let i=[];for(let r of this.renderedElements)r.index<e?i.push(r):r.index>=e+t&&i.push({index:r.index+n-t,templateData:r.templateData});this.renderedElements=i}renderIndexes(e){for(let{index:t,templateData:n}of this.renderedElements)e.indexOf(t)>-1&&this.trait.renderIndex(t,n)}disposeTemplate(e){let t=this.renderedElements.findIndex(n=>n.templateData===e);t<0||this.renderedElements.splice(t,1)}},dm=class{constructor(e){this._trait=e}indexes=[];sortedIndexes=[];_onChange=new D;onChange=this._onChange.event;get name(){return this._trait}get renderer(){return new Yk(this)}splice(e,t,n){let i=n.length-t,r=e+t,s=[],a=0;for(;a<this.sortedIndexes.length&&this.sortedIndexes[a]<e;)s.push(this.sortedIndexes[a++]);for(let l=0;l<n.length;l++)n[l]&&s.push(l+e);for(;a<this.sortedIndexes.length&&this.sortedIndexes[a]>=r;)s.push(this.sortedIndexes[a++]+i);this.renderer.splice(e,t,n.length),this._set(s,s)}renderIndex(e,t){t.classList.toggle(this._trait,this.contains(e))}unrender(e){e.classList.remove(this._trait)}set(e,t){return this._set(e,[...e].sort(FW),t)}_set(e,t,n){let i=this.indexes,r=this.sortedIndexes;this.indexes=e,this.sortedIndexes=t;let s=Jk(r,e);return this.renderer.renderIndexes(s),this._onChange.fire({indexes:e,browserEvent:n}),i}get(){return this.indexes}contains(e){return HN(this.sortedIndexes,e,FW)>=0}dispose(){wt(this._onChange)}};O([he],dm.prototype,"renderer",1);var Zk=class extends dm{constructor(t){super("selected");this.setAriaSelected=t}renderIndex(t,n){super.renderIndex(t,n),this.setAriaSelected&&(this.contains(t)?n.setAttribute("aria-selected","true"):n.setAttribute("aria-selected","false"))}},zb=class{constructor(e,t,n){this.trait=e;this.view=t;this.identityProvider=n}splice(e,t,n){if(!this.identityProvider)return this.trait.splice(e,t,new Array(n.length).fill(!1));let i=this.trait.get().map(a=>this.identityProvider.getId(this.view.element(a)).toString());if(i.length===0)return this.trait.splice(e,t,new Array(n.length).fill(!1));let r=new Set(i),s=n.map(a=>r.has(this.identityProvider.getId(a).toString()));this.trait.splice(e,t,s)}};function Gb(o,e){return o.classList.contains(e)?!0:o.classList.contains("monaco-list")||!o.parentElement?!1:Gb(o.parentElement,e)}function lm(o){return Gb(o,"monaco-editor")}function BW(o){return Gb(o,"monaco-custom-toggle")}function VW(o){return Gb(o,"action-item")}function cm(o){return Gb(o,"monaco-tree-sticky-row")}function um(o){return o.classList.contains("monaco-tree-sticky-container")}function i1(o){return o.tagName==="A"&&o.classList.contains("monaco-button")||o.tagName==="DIV"&&o.classList.contains("monaco-button-dropdown")?!0:o.classList.contains("monaco-list")||!o.parentElement?!1:i1(o.parentElement)}var fE=class{constructor(e,t,n){this.list=e;this.view=t;this.multipleSelectionSupport=n.multipleSelectionSupport,this.disposables.add(this.onKeyDown(i=>{switch(i.keyCode){case 3:return this.onEnter(i);case 16:return this.onUpArrow(i);case 18:return this.onDownArrow(i);case 11:return this.onPageUpArrow(i);case 12:return this.onPageDownArrow(i);case 9:return this.onEscape(i);case 31:this.multipleSelectionSupport&&(Ve?i.metaKey:i.ctrlKey)&&this.onCtrlA(i)}}))}disposables=new ee;multipleSelectionDisposables=new ee;multipleSelectionSupport;get onKeyDown(){return q.chain(this.disposables.add(new Ae(this.view.domNode,"keydown")).event,e=>e.filter(t=>!rs(t.target)).map(t=>new mt(t)))}updateOptions(e){e.multipleSelectionSupport!==void 0&&(this.multipleSelectionSupport=e.multipleSelectionSupport)}onEnter(e){e.preventDefault(),e.stopPropagation(),this.list.setSelection(this.list.getFocus(),e.browserEvent)}onUpArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusPrevious(1,!1,e.browserEvent);let t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onDownArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusNext(1,!1,e.browserEvent);let t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onPageUpArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusPreviousPage(e.browserEvent);let t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onPageDownArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusNextPage(e.browserEvent);let t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onCtrlA(e){e.preventDefault(),e.stopPropagation(),this.list.setSelection(Yn(this.list.length),e.browserEvent),this.list.setAnchor(void 0),this.view.domNode.focus()}onEscape(e){this.list.getSelection().length&&(e.preventDefault(),e.stopPropagation(),this.list.setSelection([],e.browserEvent),this.list.setAnchor(void 0),this.view.domNode.focus())}dispose(){this.disposables.dispose(),this.multipleSelectionDisposables.dispose()}};O([he],fE.prototype,"onKeyDown",1);var o6=new class{mightProducePrintableCharacter(o){return o.ctrlKey||o.metaKey||o.altKey?!1:o.keyCode>=31&&o.keyCode<=56||o.keyCode>=21&&o.keyCode<=30||o.keyCode>=98&&o.keyCode<=107||o.keyCode>=85&&o.keyCode<=95}},Xk=class{constructor(e,t,n,i,r){this.list=e;this.view=t;this.keyboardNavigationLabelProvider=n;this.keyboardNavigationEventFilter=i;this.delegate=r;this.updateOptions(e.options)}enabled=!1;state=0;mode=0;triggered=!1;previouslyFocused=-1;enabledDisposables=new ee;disposables=new ee;updateOptions(e){e.typeNavigationEnabled??!0?this.enable():this.disable(),this.mode=e.typeNavigationMode??0}trigger(){this.triggered=!this.triggered}enable(){if(this.enabled)return;let e=!1,t=q.chain(this.enabledDisposables.add(new Ae(this.view.domNode,"keydown")).event,r=>r.filter(s=>!rs(s.target)).filter(()=>this.mode===0||this.triggered).map(s=>new mt(s)).filter(s=>e||this.keyboardNavigationEventFilter(s)).filter(s=>this.delegate.mightProducePrintableCharacter(s)).forEach(s=>st.stop(s,!0)).map(s=>s.browserEvent.key)),n=q.debounce(t,()=>null,800,void 0,void 0,void 0,this.enabledDisposables);q.reduce(q.any(t,n),(r,s)=>s===null?null:(r||"")+s,void 0,this.enabledDisposables)(this.onInput,this,this.enabledDisposables),n(this.onClear,this,this.enabledDisposables),t(()=>e=!0,void 0,this.enabledDisposables),n(()=>e=!1,void 0,this.enabledDisposables),this.enabled=!0,this.triggered=!1}disable(){this.enabled&&(this.enabledDisposables.clear(),this.enabled=!1,this.triggered=!1)}onClear(){let e=this.list.getFocus();if(e.length>0&&e[0]===this.previouslyFocused){let t=this.list.options.accessibilityProvider?.getAriaLabel(this.list.element(e[0]));typeof t=="string"?rc(t):t&&rc(t.get())}this.previouslyFocused=-1}onInput(e){if(!e){this.state=0,this.triggered=!1;return}let t=this.list.getFocus(),n=t.length>0?t[0]:0,i=this.state===0?1:0;this.state=1;for(let r=0;r<this.list.length;r++){let s=(n+r+i)%this.list.length,a=this.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(this.view.element(s)),l=a&&a.toString();if(this.list.options.typeNavigationEnabled){if(typeof l<"u"){if(Jc(e,l)){this.previouslyFocused=n,this.list.setFocus([s]),this.list.reveal(s);return}let d=_F(e,l);if(d&&d[0].end-d[0].start>1&&d.length===1){this.previouslyFocused=n,this.list.setFocus([s]),this.list.reveal(s);return}}}else if(typeof l>"u"||Jc(e,l)){this.previouslyFocused=n,this.list.setFocus([s]),this.list.reveal(s);return}}}dispose(){this.disable(),this.enabledDisposables.dispose(),this.disposables.dispose()}},Qk=class{constructor(e,t){this.list=e;this.view=t;let n=q.chain(this.disposables.add(new Ae(t.domNode,"keydown")).event,r=>r.filter(s=>!rs(s.target)).map(s=>new mt(s)));q.chain(n,r=>r.filter(s=>s.keyCode===2&&!s.ctrlKey&&!s.metaKey&&!s.shiftKey&&!s.altKey))(this.onTab,this,this.disposables)}disposables=new ee;onTab(e){if(e.target!==this.view.domNode)return;let t=this.list.getFocus();if(t.length===0)return;let n=this.view.domElement(t[0]);if(!n)return;let i=n.querySelector("[tabIndex]");if(!i||!Nn(i)||i.tabIndex===-1)return;let r=Ce(i).getComputedStyle(i);r.visibility==="hidden"||r.display==="none"||(e.preventDefault(),e.stopPropagation(),i.focus())}dispose(){this.disposables.dispose()}};function o1(o){return Ve?o.browserEvent.metaKey:o.browserEvent.ctrlKey}function r1(o){return o.browserEvent.shiftKey}function r6(o){return CS(o)&&o.button===2}var AW={isSelectionSingleChangeEvent:o1,isSelectionRangeChangeEvent:r1},Kb=class{constructor(e){this.list=e;e.options.multipleSelectionSupport!==!1&&(this.multipleSelectionController=this.list.options.multipleSelectionController||AW),this.mouseSupport=typeof e.options.mouseSupport>"u"||!!e.options.mouseSupport,this.mouseSupport&&(e.onMouseDown(this.onMouseDown,this,this.disposables),e.onContextMenu(this.onContextMenu,this,this.disposables),e.onMouseDblClick(this.onDoubleClick,this,this.disposables),e.onTouchStart(this.onMouseDown,this,this.disposables),this.disposables.add(An.addTarget(e.getHTMLElement()))),q.any(e.onMouseClick,e.onMouseMiddleClick,e.onTap)(this.onViewPointer,this,this.disposables)}multipleSelectionController;mouseSupport;disposables=new ee;_onPointer=new D;onPointer=this._onPointer.event;updateOptions(e){e.multipleSelectionSupport!==void 0&&(this.multipleSelectionController=void 0,e.multipleSelectionSupport&&(this.multipleSelectionController=this.list.options.multipleSelectionController||AW))}isSelectionSingleChangeEvent(e){return this.multipleSelectionController?this.multipleSelectionController.isSelectionSingleChangeEvent(e):!1}isSelectionRangeChangeEvent(e){return this.multipleSelectionController?this.multipleSelectionController.isSelectionRangeChangeEvent(e):!1}isSelectionChangeEvent(e){return this.isSelectionSingleChangeEvent(e)||this.isSelectionRangeChangeEvent(e)}onMouseDown(e){lm(e.browserEvent.target)||Io()!==e.browserEvent.target&&this.list.domFocus()}onContextMenu(e){if(rs(e.browserEvent.target)||lm(e.browserEvent.target))return;let t=typeof e.index>"u"?[]:[e.index];this.list.setFocus(t,e.browserEvent)}onViewPointer(e){if(!this.mouseSupport||rs(e.browserEvent.target)||lm(e.browserEvent.target)||e.browserEvent.isHandledByList)return;e.browserEvent.isHandledByList=!0;let t=e.index;if(typeof t>"u"){this.list.setFocus([],e.browserEvent),this.list.setSelection([],e.browserEvent),this.list.setAnchor(void 0);return}if(this.isSelectionChangeEvent(e))return this.changeSelection(e);this.list.setFocus([t],e.browserEvent),this.list.setAnchor(t),r6(e.browserEvent)||this.list.setSelection([t],e.browserEvent),this._onPointer.fire(e)}onDoubleClick(e){if(rs(e.browserEvent.target)||lm(e.browserEvent.target)||this.isSelectionChangeEvent(e)||e.browserEvent.isHandledByList)return;e.browserEvent.isHandledByList=!0;let t=this.list.getFocus();this.list.setSelection(t,e.browserEvent)}changeSelection(e){let t=e.index,n=this.list.getAnchor();if(this.isSelectionRangeChangeEvent(e)){typeof n>"u"&&(n=this.list.getFocus()[0]??t,this.list.setAnchor(n));let i=Math.min(n,t),r=Math.max(n,t),s=Yn(i,r+1),a=this.list.getSelection(),l=a6(Jk(a,[n]),n);if(l.length===0)return;let d=Jk(s,l6(a,l));this.list.setSelection(d,e.browserEvent),this.list.setFocus([t],e.browserEvent)}else if(this.isSelectionSingleChangeEvent(e)){let i=this.list.getSelection(),r=i.filter(s=>s!==t);this.list.setFocus([t]),this.list.setAnchor(t),i.length===r.length?this.list.setSelection([...r,t],e.browserEvent):this.list.setSelection(r,e.browserEvent)}}dispose(){this.disposables.dispose()}},bE=class{constructor(e,t){this.styleElement=e;this.selectorSuffix=t}style(e){let t=this.selectorSuffix&&`.${this.selectorSuffix}`,n=[];e.listBackground&&n.push(`.monaco-list${t} .monaco-list-rows { background: ${e.listBackground}; }`),e.listFocusBackground&&(n.push(`.monaco-list${t}:focus .monaco-list-row.focused { background-color: ${e.listFocusBackground}; }`),n.push(`.monaco-list${t}:focus .monaco-list-row.focused:hover { background-color: ${e.listFocusBackground}; }`)),e.listFocusForeground&&n.push(`.monaco-list${t}:focus .monaco-list-row.focused { color: ${e.listFocusForeground}; }`),e.listActiveSelectionBackground&&(n.push(`.monaco-list${t}:focus .monaco-list-row.selected { background-color: ${e.listActiveSelectionBackground}; }`),n.push(`.monaco-list${t}:focus .monaco-list-row.selected:hover { background-color: ${e.listActiveSelectionBackground}; }`)),e.listActiveSelectionForeground&&n.push(`.monaco-list${t}:focus .monaco-list-row.selected { color: ${e.listActiveSelectionForeground}; }`),e.listActiveSelectionIconForeground&&n.push(`.monaco-list${t}:focus .monaco-list-row.selected .codicon { color: ${e.listActiveSelectionIconForeground}; }`),e.listFocusAndSelectionBackground&&n.push(`
				.monaco-drag-image,
				.monaco-list${t}:focus .monaco-list-row.selected.focused { background-color: ${e.listFocusAndSelectionBackground}; }
			`),e.listFocusAndSelectionForeground&&n.push(`
				.monaco-drag-image,
				.monaco-list${t}:focus .monaco-list-row.selected.focused { color: ${e.listFocusAndSelectionForeground}; }
			`),e.listInactiveFocusForeground&&(n.push(`.monaco-list${t} .monaco-list-row.focused { color:  ${e.listInactiveFocusForeground}; }`),n.push(`.monaco-list${t} .monaco-list-row.focused:hover { color:  ${e.listInactiveFocusForeground}; }`)),e.listInactiveSelectionIconForeground&&n.push(`.monaco-list${t} .monaco-list-row.focused .codicon { color:  ${e.listInactiveSelectionIconForeground}; }`),e.listInactiveFocusBackground&&(n.push(`.monaco-list${t} .monaco-list-row.focused { background-color:  ${e.listInactiveFocusBackground}; }`),n.push(`.monaco-list${t} .monaco-list-row.focused:hover { background-color:  ${e.listInactiveFocusBackground}; }`)),e.listInactiveSelectionBackground&&(n.push(`.monaco-list${t} .monaco-list-row.selected { background-color:  ${e.listInactiveSelectionBackground}; }`),n.push(`.monaco-list${t} .monaco-list-row.selected:hover { background-color:  ${e.listInactiveSelectionBackground}; }`)),e.listInactiveSelectionForeground&&n.push(`.monaco-list${t} .monaco-list-row.selected { color: ${e.listInactiveSelectionForeground}; }`),e.listHoverBackground&&n.push(`.monaco-list${t}:not(.drop-target):not(.dragging) .monaco-list-row:hover:not(.selected):not(.focused) { background-color: ${e.listHoverBackground}; }`),e.listHoverForeground&&n.push(`.monaco-list${t}:not(.drop-target):not(.dragging) .monaco-list-row:hover:not(.selected):not(.focused) { color:  ${e.listHoverForeground}; }`);let i=Vr(e.listFocusAndSelectionOutline,Vr(e.listSelectionOutline,e.listFocusOutline??""));i&&n.push(`.monaco-list${t}:focus .monaco-list-row.focused.selected { outline: 1px solid ${i}; outline-offset: -1px;}`),e.listFocusOutline&&n.push(`
				.monaco-drag-image,
				.monaco-list${t}:focus .monaco-list-row.focused { outline: 1px solid ${e.listFocusOutline}; outline-offset: -1px; }
				.monaco-workbench.context-menu-visible .monaco-list${t}.last-focused .monaco-list-row.focused { outline: 1px solid ${e.listFocusOutline}; outline-offset: -1px; }
			`);let r=Vr(e.listSelectionOutline,e.listInactiveFocusOutline??"");r&&n.push(`.monaco-list${t} .monaco-list-row.focused.selected { outline: 1px dotted ${r}; outline-offset: -1px; }`),e.listSelectionOutline&&n.push(`.monaco-list${t} .monaco-list-row.selected { outline: 1px dotted ${e.listSelectionOutline}; outline-offset: -1px; }`),e.listInactiveFocusOutline&&n.push(`.monaco-list${t} .monaco-list-row.focused { outline: 1px dotted ${e.listInactiveFocusOutline}; outline-offset: -1px; }`),e.listHoverOutline&&n.push(`.monaco-list${t} .monaco-list-row:hover { outline: 1px dashed ${e.listHoverOutline}; outline-offset: -1px; }`),e.listDropOverBackground&&n.push(`
				.monaco-list${t}.drop-target,
				.monaco-list${t} .monaco-list-rows.drop-target,
				.monaco-list${t} .monaco-list-row.drop-target { background-color: ${e.listDropOverBackground} !important; color: inherit !important; }
			`),e.listDropBetweenBackground&&(n.push(`
			.monaco-list${t} .monaco-list-rows.drop-target-before .monaco-list-row:first-child::before,
			.monaco-list${t} .monaco-list-row.drop-target-before::before {
				content: ""; position: absolute; top: 0px; left: 0px; width: 100%; height: 1px;
				background-color: ${e.listDropBetweenBackground};
			}`),n.push(`
			.monaco-list${t} .monaco-list-rows.drop-target-after .monaco-list-row:last-child::after,
			.monaco-list${t} .monaco-list-row.drop-target-after::after {
				content: ""; position: absolute; bottom: 0px; left: 0px; width: 100%; height: 1px;
				background-color: ${e.listDropBetweenBackground};
			}`)),e.tableColumnsBorder&&n.push(`
				.monaco-table > .monaco-split-view2,
				.monaco-table > .monaco-split-view2 .monaco-sash.vertical::before,
				.monaco-workbench:not(.reduce-motion) .monaco-table:hover > .monaco-split-view2,
				.monaco-workbench:not(.reduce-motion) .monaco-table:hover > .monaco-split-view2 .monaco-sash.vertical::before {
					border-color: ${e.tableColumnsBorder};
				}

				.monaco-workbench:not(.reduce-motion) .monaco-table > .monaco-split-view2,
				.monaco-workbench:not(.reduce-motion) .monaco-table > .monaco-split-view2 .monaco-sash.vertical::before {
					border-color: transparent;
				}
			`),e.tableOddRowsBackgroundColor&&n.push(`
				.monaco-table .monaco-list-row[data-parity=odd]:not(.focused):not(.selected):not(:hover) .monaco-table-tr,
				.monaco-table .monaco-list:not(:focus) .monaco-list-row[data-parity=odd].focused:not(.selected):not(:hover) .monaco-table-tr,
				.monaco-table .monaco-list:not(.focused) .monaco-list-row[data-parity=odd].focused:not(.selected):not(:hover) .monaco-table-tr {
					background-color: ${e.tableOddRowsBackgroundColor};
				}
			`),this.styleElement.textContent=n.join(`
`)}},vE={listFocusBackground:"#7FB0D0",listActiveSelectionBackground:"#0E639C",listActiveSelectionForeground:"#FFFFFF",listActiveSelectionIconForeground:"#FFFFFF",listFocusAndSelectionOutline:"#90C2F9",listFocusAndSelectionBackground:"#094771",listFocusAndSelectionForeground:"#FFFFFF",listInactiveSelectionBackground:"#3F3F46",listInactiveSelectionIconForeground:"#FFFFFF",listHoverBackground:"#2A2D2E",listDropOverBackground:"#383B3D",listDropBetweenBackground:"#EEEEEE",treeIndentGuidesStroke:"#a9a9a9",treeInactiveIndentGuidesStroke:H.fromHex("#a9a9a9").transparent(.4).toString(),tableColumnsBorder:H.fromHex("#cccccc").transparent(.2).toString(),tableOddRowsBackgroundColor:H.fromHex("#cccccc").transparent(.04).toString(),listBackground:void 0,listFocusForeground:void 0,listInactiveSelectionForeground:void 0,listInactiveFocusForeground:void 0,listInactiveFocusBackground:void 0,listHoverForeground:void 0,listFocusOutline:void 0,listInactiveFocusOutline:void 0,listSelectionOutline:void 0,listHoverOutline:void 0,treeStickyScrollBackground:void 0,treeStickyScrollBorder:void 0,treeStickyScrollShadow:void 0},s6={keyboardSupport:!0,mouseSupport:!0,multipleSelectionSupport:!0,dnd:{getDragURI(){return null},onDragStart(){},onDragOver(){return!1},drop(){},dispose(){}}};function a6(o,e){let t=o.indexOf(e);if(t===-1)return[];let n=[],i=t-1;for(;i>=0&&o[i]===e-(t-i);)n.push(o[i--]);for(n.reverse(),i=t;i<o.length&&o[i]===e+(i-t);)n.push(o[i++]);return n}function Jk(o,e){let t=[],n=0,i=0;for(;n<o.length||i<e.length;)if(n>=o.length)t.push(e[i++]);else if(i>=e.length)t.push(o[n++]);else if(o[n]===e[i]){t.push(o[n]),n++,i++;continue}else o[n]<e[i]?t.push(o[n++]):t.push(e[i++]);return t}function l6(o,e){let t=[],n=0,i=0;for(;n<o.length||i<e.length;)if(n>=o.length)t.push(e[i++]);else if(i>=e.length)t.push(o[n++]);else if(o[n]===e[i]){n++,i++;continue}else o[n]<e[i]?t.push(o[n++]):i++;return t}var FW=(o,e)=>o-e,e1=class{constructor(e,t){this._templateId=e;this.renderers=t}get templateId(){return this._templateId}renderTemplate(e){return this.renderers.map(t=>t.renderTemplate(e))}renderElement(e,t,n,i){let r=0;for(let s of this.renderers)s.renderElement(e,t,n[r++],i)}disposeElement(e,t,n,i){let r=0;for(let s of this.renderers)s.disposeElement?.(e,t,n[r],i),r+=1}disposeTemplate(e){let t=0;for(let n of this.renderers)n.disposeTemplate(e[t++])}},t1=class{constructor(e){this.accessibilityProvider=e}templateId="a18n";renderTemplate(e){return{container:e,disposables:new ee}}renderElement(e,t,n){let i=this.accessibilityProvider.getAriaLabel(e),r=i&&typeof i!="string"?i:ud(i);n.disposables.add(rt(a=>{this.setAriaLabel(a.readObservable(r),n.container)}));let s=this.accessibilityProvider.getAriaLevel&&this.accessibilityProvider.getAriaLevel(e);typeof s=="number"?n.container.setAttribute("aria-level",`${s}`):n.container.removeAttribute("aria-level")}setAriaLabel(e,t){e?t.setAttribute("aria-label",e):t.removeAttribute("aria-label")}disposeElement(e,t,n,i){n.disposables.clear()}disposeTemplate(e){e.disposables.dispose()}},n1=class{constructor(e,t){this.list=e;this.dnd=t}getDragElements(e){let t=this.list.getSelectedElements();return t.indexOf(e)>-1?t:[e]}getDragURI(e){return this.dnd.getDragURI(e)}getDragLabel(e,t){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(e,t)}onDragStart(e,t){this.dnd.onDragStart?.(e,t)}onDragOver(e,t,n,i,r){return this.dnd.onDragOver(e,t,n,i,r)}onDragLeave(e,t,n,i){this.dnd.onDragLeave?.(e,t,n,i)}onDragEnd(e){this.dnd.onDragEnd?.(e)}drop(e,t,n,i,r){this.dnd.drop(e,t,n,i,r)}dispose(){this.dnd.dispose()}},ii=class{constructor(e,t,n,i,r=s6){this.user=e;this._options=r;let s=this._options.accessibilityProvider&&this._options.accessibilityProvider.getWidgetRole?this._options.accessibilityProvider?.getWidgetRole():"list";this.selection=new Zk(s!=="listbox");let a=[this.focus.renderer,this.selection.renderer];this.accessibilityProvider=r.accessibilityProvider,this.accessibilityProvider&&(a.push(new t1(this.accessibilityProvider)),this.accessibilityProvider.onDidChangeActiveDescendant?.(this.onDidChangeActiveDescendant,this,this.disposables)),i=i.map(d=>new e1(d.templateId,[...a,d]));let l={...r,dnd:r.dnd&&new n1(this,r.dnd)};if(this.view=this.createListView(t,n,i,l),this.view.domNode.setAttribute("role",s),r.styleController)this.styleController=r.styleController(this.view.domId);else{let d=ur(this.view.domNode);this.styleController=new bE(d,this.view.domId)}if(this.spliceable=new gE([new zb(this.focus,this.view,r.identityProvider),new zb(this.selection,this.view,r.identityProvider),new zb(this.anchor,this.view,r.identityProvider),this.view]),this.disposables.add(this.focus),this.disposables.add(this.selection),this.disposables.add(this.anchor),this.disposables.add(this.view),this.disposables.add(this._onDidDispose),this.disposables.add(new Qk(this,this.view)),(typeof r.keyboardSupport!="boolean"||r.keyboardSupport)&&(this.keyboardController=new fE(this,this.view,r),this.disposables.add(this.keyboardController)),r.keyboardNavigationLabelProvider){let d=r.keyboardNavigationDelegate||o6;this.typeNavigationController=new Xk(this,this.view,r.keyboardNavigationLabelProvider,r.keyboardNavigationEventFilter??(()=>!0),d),this.disposables.add(this.typeNavigationController)}this.mouseController=this.createMouseController(r),this.disposables.add(this.mouseController),this.onDidChangeFocus(this._onFocusChange,this,this.disposables),this.onDidChangeSelection(this._onSelectionChange,this,this.disposables),this.accessibilityProvider&&(this.ariaLabel=this.accessibilityProvider.getWidgetAriaLabel()),this._options.multipleSelectionSupport!==!1&&this.view.domNode.setAttribute("aria-multiselectable","true")}focus=new dm("focused");selection;anchor=new dm("anchor");eventBufferer=new md;view;spliceable;styleController;typeNavigationController;accessibilityProvider;keyboardController;mouseController;_ariaLabel="";disposables=new ee;get onDidChangeFocus(){return q.map(this.eventBufferer.wrapEvent(this.focus.onChange),e=>this.toListEvent(e),this.disposables)}get onDidChangeSelection(){return q.map(this.eventBufferer.wrapEvent(this.selection.onChange),e=>this.toListEvent(e),this.disposables)}get domId(){return this.view.domId}get onDidScroll(){return this.view.onDidScroll}get onMouseClick(){return this.view.onMouseClick}get onMouseDblClick(){return this.view.onMouseDblClick}get onMouseMiddleClick(){return this.view.onMouseMiddleClick}get onPointer(){return this.mouseController.onPointer}get onMouseUp(){return this.view.onMouseUp}get onMouseDown(){return this.view.onMouseDown}get onMouseOver(){return this.view.onMouseOver}get onMouseMove(){return this.view.onMouseMove}get onMouseOut(){return this.view.onMouseOut}get onTouchStart(){return this.view.onTouchStart}get onTap(){return this.view.onTap}get onContextMenu(){let e=!1,t=q.chain(this.disposables.add(new Ae(this.view.domNode,"keydown")).event,r=>r.map(s=>new mt(s)).filter(s=>e=s.keyCode===58||s.shiftKey&&s.keyCode===68).map(s=>st.stop(s,!0)).filter(()=>!1)),n=q.chain(this.disposables.add(new Ae(this.view.domNode,"keyup")).event,r=>r.forEach(()=>e=!1).map(s=>new mt(s)).filter(s=>s.keyCode===58||s.shiftKey&&s.keyCode===68).map(s=>st.stop(s,!0)).map(({browserEvent:s})=>{let a=this.getFocus(),l=a.length?a[0]:void 0,d=typeof l<"u"?this.view.element(l):void 0,c=typeof l<"u"?this.view.domElement(l):this.view.domNode;return{index:l,element:d,anchor:c,browserEvent:s}})),i=q.chain(this.view.onContextMenu,r=>r.filter(s=>!e).map(({element:s,index:a,browserEvent:l})=>({element:s,index:a,anchor:new Yi(Ce(this.view.domNode),l),browserEvent:l})));return q.any(t,n,i)}get onKeyDown(){return this.disposables.add(new Ae(this.view.domNode,"keydown")).event}get onKeyUp(){return this.disposables.add(new Ae(this.view.domNode,"keyup")).event}get onKeyPress(){return this.disposables.add(new Ae(this.view.domNode,"keypress")).event}get onDidFocus(){return q.signal(this.disposables.add(new Ae(this.view.domNode,"focus",!0)).event)}get onDidBlur(){return q.signal(this.disposables.add(new Ae(this.view.domNode,"blur",!0)).event)}_onDidDispose=new D;onDidDispose=this._onDidDispose.event;createListView(e,t,n,i){return new mE(e,t,n,i)}createMouseController(e){return new Kb(this)}updateOptions(e={}){this._options={...this._options,...e},this.typeNavigationController?.updateOptions(this._options),this._options.multipleSelectionController!==void 0&&(this._options.multipleSelectionSupport?this.view.domNode.setAttribute("aria-multiselectable","true"):this.view.domNode.removeAttribute("aria-multiselectable")),this.mouseController.updateOptions(e),this.keyboardController?.updateOptions(e),this.view.updateOptions(e)}get options(){return this._options}splice(e,t,n=[]){if(e<0||e>this.view.length)throw new Na(this.user,`Invalid start index: ${e}`);if(t<0)throw new Na(this.user,`Invalid delete count: ${t}`);t===0&&n.length===0||this.eventBufferer.bufferEvents(()=>this.spliceable.splice(e,t,n))}updateWidth(e){this.view.updateWidth(e)}updateElementHeight(e,t){this.view.updateElementHeight(e,t,null)}rerender(){this.view.rerender()}element(e){return this.view.element(e)}indexOf(e){return this.view.indexOf(e)}indexAt(e){return this.view.indexAt(e)}get length(){return this.view.length}get contentHeight(){return this.view.contentHeight}get contentWidth(){return this.view.contentWidth}get onDidChangeContentHeight(){return this.view.onDidChangeContentHeight}get onDidChangeContentWidth(){return this.view.onDidChangeContentWidth}get scrollTop(){return this.view.getScrollTop()}set scrollTop(e){this.view.setScrollTop(e)}get scrollLeft(){return this.view.getScrollLeft()}set scrollLeft(e){this.view.setScrollLeft(e)}get scrollHeight(){return this.view.scrollHeight}get renderHeight(){return this.view.renderHeight}get firstVisibleIndex(){return this.view.firstVisibleIndex}get firstMostlyVisibleIndex(){return this.view.firstMostlyVisibleIndex}get lastVisibleIndex(){return this.view.lastVisibleIndex}get ariaLabel(){return this._ariaLabel}set ariaLabel(e){this._ariaLabel=e,this.view.domNode.setAttribute("aria-label",e)}domFocus(){this.view.domNode.focus({preventScroll:!0})}layout(e,t){this.view.layout(e,t)}triggerTypeNavigation(){this.typeNavigationController?.trigger()}setSelection(e,t){for(let n of e)if(n<0||n>=this.length)throw new Na(this.user,`Invalid index ${n}`);this.selection.set(e,t)}getSelection(){return this.selection.get()}getSelectedElements(){return this.getSelection().map(e=>this.view.element(e))}setAnchor(e){if(typeof e>"u"){this.anchor.set([]);return}if(e<0||e>=this.length)throw new Na(this.user,`Invalid index ${e}`);this.anchor.set([e])}getAnchor(){return this.anchor.get().at(0)}getAnchorElement(){let e=this.getAnchor();return typeof e>"u"?void 0:this.element(e)}setFocus(e,t){for(let n of e)if(n<0||n>=this.length)throw new Na(this.user,`Invalid index ${n}`);this.focus.set(e,t)}focusNext(e=1,t=!1,n,i){if(this.length===0)return;let r=this.focus.get(),s=this.findNextIndex(r.length>0?r[0]+e:0,t,i);s>-1&&this.setFocus([s],n)}focusPrevious(e=1,t=!1,n,i){if(this.length===0)return;let r=this.focus.get(),s=this.findPreviousIndex(r.length>0?r[0]-e:0,t,i);s>-1&&this.setFocus([s],n)}async focusNextPage(e,t){let n=this.view.indexAt(this.view.getScrollTop()+this.view.renderHeight);n=n===0?0:n-1;let i=this.getFocus()[0];if(i!==n&&(i===void 0||n>i)){let r=this.findPreviousIndex(n,!1,t);r>-1&&i!==r?this.setFocus([r],e):this.setFocus([n],e)}else{let r=this.view.getScrollTop(),s=r+this.view.renderHeight;n>i&&(s-=this.view.elementHeight(n)),this.view.setScrollTop(s),this.view.getScrollTop()!==r&&(this.setFocus([]),await wi(0),await this.focusNextPage(e,t))}}async focusPreviousPage(e,t,n=()=>0){let i,r=n(),s=this.view.getScrollTop()+r;s===0?i=this.view.indexAt(s):i=this.view.indexAfter(s-1);let a=this.getFocus()[0];if(a!==i&&(a===void 0||a>=i)){let l=this.findNextIndex(i,!1,t);l>-1&&a!==l?this.setFocus([l],e):this.setFocus([i],e)}else{let l=s;this.view.setScrollTop(s-this.view.renderHeight-r),this.view.getScrollTop()+n()!==l&&(this.setFocus([]),await wi(0),await this.focusPreviousPage(e,t,n))}}focusLast(e,t){if(this.length===0)return;let n=this.findPreviousIndex(this.length-1,!1,t);n>-1&&this.setFocus([n],e)}focusFirst(e,t){this.focusNth(0,e,t)}focusNth(e,t,n){if(this.length===0)return;let i=this.findNextIndex(e,!1,n);i>-1&&this.setFocus([i],t)}findNextIndex(e,t=!1,n){for(let i=0;i<this.length;i++){if(e>=this.length&&!t)return-1;if(e=e%this.length,!n||n(this.element(e)))return e;e++}return-1}findPreviousIndex(e,t=!1,n){for(let i=0;i<this.length;i++){if(e<0&&!t)return-1;if(e=(this.length+e%this.length)%this.length,!n||n(this.element(e)))return e;e--}return-1}getFocus(){return this.focus.get()}getFocusedElements(){return this.getFocus().map(e=>this.view.element(e))}reveal(e,t,n=0){if(e<0||e>=this.length)throw new Na(this.user,`Invalid index ${e}`);let i=this.view.getScrollTop(),r=this.view.elementTop(e),s=this.view.elementHeight(e);if(Gi(t)){let a=s-this.view.renderHeight+n;this.view.setScrollTop(a*Ri(t,0,1)+r-n)}else{let a=r+s,l=i+this.view.renderHeight;r<i+n&&a>=l||(r<i+n||a>=l&&s>=this.view.renderHeight?this.view.setScrollTop(r-n):a>=l&&this.view.setScrollTop(a-this.view.renderHeight))}}getRelativeTop(e,t=0){if(e<0||e>=this.length)throw new Na(this.user,`Invalid index ${e}`);let n=this.view.getScrollTop(),i=this.view.elementTop(e),r=this.view.elementHeight(e);if(i<n+t||i+r>n+this.view.renderHeight)return null;let s=r-this.view.renderHeight+t;return Math.abs((n+t-i)/s)}isDOMFocused(){return Fr(this.view.domNode)}getHTMLElement(){return this.view.domNode}getScrollableElement(){return this.view.scrollableElementDomNode}getElementID(e){return this.view.getElementDomId(e)}getElementTop(e){return this.view.elementTop(e)}style(e){this.styleController.style(e)}toListEvent({indexes:e,browserEvent:t}){return{indexes:e,elements:e.map(n=>this.view.element(n)),browserEvent:t}}_onFocusChange(){let e=this.focus.get();this.view.domNode.classList.toggle("element-focused",e.length>0),this.onDidChangeActiveDescendant()}onDidChangeActiveDescendant(){let e=this.focus.get();if(e.length>0){let t;this.accessibilityProvider?.getActiveDescendantId&&(t=this.accessibilityProvider.getActiveDescendantId(this.view.element(e[0]))),this.view.domNode.setAttribute("aria-activedescendant",t||this.view.getElementDomId(e[0]))}else this.view.domNode.removeAttribute("aria-activedescendant")}_onSelectionChange(){let e=this.selection.get();this.view.domNode.classList.toggle("selection-none",e.length===0),this.view.domNode.classList.toggle("selection-single",e.length===1),this.view.domNode.classList.toggle("selection-multiple",e.length>1)}dispose(){this._onDidDispose.fire(),this.disposables.dispose(),this._onDidDispose.dispose()}};O([he],ii.prototype,"onDidChangeFocus",1),O([he],ii.prototype,"onDidChangeSelection",1),O([he],ii.prototype,"onContextMenu",1),O([he],ii.prototype,"onKeyDown",1),O([he],ii.prototype,"onKeyUp",1),O([he],ii.prototype,"onKeyPress",1),O([he],ii.prototype,"onDidFocus",1),O([he],ii.prototype,"onDidBlur",1);var s1=class{constructor(e,t){this.renderer=e;this.modelProvider=t}get templateId(){return this.renderer.templateId}renderTemplate(e){return{data:this.renderer.renderTemplate(e),disposable:F.None}}renderElement(e,t,n,i){if(n.disposable?.dispose(),!n.data)return;let r=this.modelProvider();if(r.isResolved(e))return this.renderer.renderElement(r.get(e),e,n.data,i);let s=new zn,a=r.resolve(e,s.token);n.disposable={dispose:()=>s.cancel()},this.renderer.renderPlaceholder(e,n.data),a.then(l=>this.renderer.renderElement(l,e,n.data,i))}disposeTemplate(e){e.disposable&&(e.disposable.dispose(),e.disposable=void 0),e.data&&(this.renderer.disposeTemplate(e.data),e.data=void 0)}},a1=class{constructor(e,t){this.modelProvider=e;this.accessibilityProvider=t}getWidgetAriaLabel(){return this.accessibilityProvider.getWidgetAriaLabel()}getAriaLabel(e){let t=this.modelProvider();return t.isResolved(e)?this.accessibilityProvider.getAriaLabel(t.get(e)):null}};function d6(o,e){return{...e,accessibilityProvider:e.accessibilityProvider&&new a1(o,e.accessibilityProvider)}}var yE=class{list;_model;constructor(e,t,n,i,r={}){let s=()=>this.model,a=i.map(l=>new s1(l,s));this.list=new ii(e,t,n,a,d6(s,r))}updateOptions(e){this.list.updateOptions(e)}getHTMLElement(){return this.list.getHTMLElement()}isDOMFocused(){return Fr(this.getHTMLElement())}domFocus(){this.list.domFocus()}get onDidFocus(){return this.list.onDidFocus}get onDidBlur(){return this.list.onDidBlur}get widget(){return this.list}get onDidDispose(){return this.list.onDidDispose}get onMouseClick(){return q.map(this.list.onMouseClick,({element:e,index:t,browserEvent:n})=>({element:e===void 0?void 0:this._model.get(e),index:t,browserEvent:n}))}get onMouseDblClick(){return q.map(this.list.onMouseDblClick,({element:e,index:t,browserEvent:n})=>({element:e===void 0?void 0:this._model.get(e),index:t,browserEvent:n}))}get onTap(){return q.map(this.list.onTap,({element:e,index:t,browserEvent:n})=>({element:e===void 0?void 0:this._model.get(e),index:t,browserEvent:n}))}get onPointer(){return q.map(this.list.onPointer,({element:e,index:t,browserEvent:n})=>({element:e===void 0?void 0:this._model.get(e),index:t,browserEvent:n}))}get onDidChangeFocus(){return q.map(this.list.onDidChangeFocus,({elements:e,indexes:t,browserEvent:n})=>({elements:e.map(i=>this._model.get(i)),indexes:t,browserEvent:n}))}get onDidChangeSelection(){return q.map(this.list.onDidChangeSelection,({elements:e,indexes:t,browserEvent:n})=>({elements:e.map(i=>this._model.get(i)),indexes:t,browserEvent:n}))}get onContextMenu(){return q.map(this.list.onContextMenu,({element:e,index:t,anchor:n,browserEvent:i})=>typeof e>"u"?{element:e,index:t,anchor:n,browserEvent:i}:{element:this._model.get(e),index:t,anchor:n,browserEvent:i})}get model(){return this._model}set model(e){this._model=e,this.list.splice(0,this.list.length,Yn(e.length))}get length(){return this.list.length}get scrollTop(){return this.list.scrollTop}set scrollTop(e){this.list.scrollTop=e}get scrollLeft(){return this.list.scrollLeft}set scrollLeft(e){this.list.scrollLeft=e}setAnchor(e){this.list.setAnchor(e)}getAnchor(){return this.list.getAnchor()}setFocus(e){this.list.setFocus(e)}focusNext(e,t){this.list.focusNext(e,t)}focusPrevious(e,t){this.list.focusPrevious(e,t)}focusNextPage(){return this.list.focusNextPage()}focusPreviousPage(){return this.list.focusPreviousPage()}focusLast(){this.list.focusLast()}focusFirst(){this.list.focusFirst()}getFocus(){return this.list.getFocus()}setSelection(e,t){this.list.setSelection(e,t)}getSelection(){return this.list.getSelection()}getSelectedElements(){return this.getSelection().map(e=>this.model.get(e))}layout(e,t){this.list.layout(e,t)}triggerTypeNavigation(){this.list.triggerTypeNavigation()}reveal(e,t){this.list.reveal(e,t)}style(e){this.list.style(e)}dispose(){this.list.dispose()}};var c6={showHover:()=>{},hideHover:()=>{},showAndFocusLastHover:()=>{},setupManagedHover:()=>null,showManagedHover:()=>{}};function xo(){return c6}var u6=()=>({get delay(){return-1},dispose:()=>{},showHover:()=>{}}),l1=u6,p6=new Qn(()=>l1("mouse",!1)),h6=new Qn(()=>l1("element",!1));function Fn(o){return o==="element"?h6.value:p6.value}function Ol(){return l1("element",!0)}var g6={separatorBorder:H.transparent};var IE=class{constructor(e,t,n,i){this.container=e;this.view=t;this.disposable=i;typeof n=="number"?(this._size=n,this._cachedVisibleSize=void 0,e.classList.add("visible")):(this._size=0,this._cachedVisibleSize=n.cachedVisibleSize)}_size;set size(e){this._size=e}get size(){return this._size}_cachedVisibleSize=void 0;get cachedVisibleSize(){return this._cachedVisibleSize}get visible(){return typeof this._cachedVisibleSize>"u"}setVisible(e,t){if(e!==this.visible){e?(this.size=Ri(this._cachedVisibleSize,this.viewMinimumSize,this.viewMaximumSize),this._cachedVisibleSize=void 0):(this._cachedVisibleSize=typeof t=="number"?t:this.size,this.size=0),this.container.classList.toggle("visible",e);try{this.view.setVisible?.(e)}catch(n){console.error("Splitview: Failed to set visible view"),console.error(n)}}}get minimumSize(){return this.visible?this.view.minimumSize:0}get viewMinimumSize(){return this.view.minimumSize}get maximumSize(){return this.visible?this.view.maximumSize:0}get viewMaximumSize(){return this.view.maximumSize}get priority(){return this.view.priority}get proportionalLayout(){return this.view.proportionalLayout??!0}get snap(){return!!this.view.snap}set enabled(e){this.container.style.pointerEvents=e?"":"none"}layout(e,t){this.layoutContainer(e);try{this.view.layout(this.size,e,t)}catch(n){console.error("Splitview: Failed to layout view"),console.error(n)}}dispose(){this.disposable.dispose()}},d1=class extends IE{layoutContainer(e){this.container.style.top=`${e}px`,this.container.style.height=`${this.size}px`}},c1=class extends IE{layoutContainer(e){this.container.style.left=`${e}px`,this.container.style.width=`${this.size}px`}};var ac;(i=>{i.Distribute={type:"distribute"};function e(r){return{type:"split",index:r}}i.Split=e;function t(r){return{type:"auto",index:r}}i.Auto=t;function n(r){return{type:"invisible",cachedVisibleSize:r}}i.Invisible=n})(ac||={});var Vu=class extends F{orientation;el;sashContainer;viewContainer;scrollable;scrollableElement;size=0;layoutContext;_contentSize=0;proportions=void 0;viewItems=[];sashItems=[];sashDragState;state=0;inverseAltBehavior;proportionalLayout;getSashOrthogonalSize;_onDidSashChange=this._register(new D);_onDidSashReset=this._register(new D);_orthogonalStartSash;_orthogonalEndSash;_startSnappingEnabled=!0;_endSnappingEnabled=!0;get contentSize(){return this._contentSize}onDidSashChange=this._onDidSashChange.event;onDidSashReset=this._onDidSashReset.event;onDidScroll;get length(){return this.viewItems.length}get minimumSize(){return this.viewItems.reduce((e,t)=>e+t.minimumSize,0)}get maximumSize(){return this.length===0?Number.POSITIVE_INFINITY:this.viewItems.reduce((e,t)=>e+t.maximumSize,0)}get orthogonalStartSash(){return this._orthogonalStartSash}get orthogonalEndSash(){return this._orthogonalEndSash}get startSnappingEnabled(){return this._startSnappingEnabled}get endSnappingEnabled(){return this._endSnappingEnabled}set orthogonalStartSash(e){for(let t of this.sashItems)t.sash.orthogonalStartSash=e;this._orthogonalStartSash=e}set orthogonalEndSash(e){for(let t of this.sashItems)t.sash.orthogonalEndSash=e;this._orthogonalEndSash=e}get sashes(){return this.sashItems.map(e=>e.sash)}set startSnappingEnabled(e){this._startSnappingEnabled!==e&&(this._startSnappingEnabled=e,this.updateSashEnablement())}set endSnappingEnabled(e){this._endSnappingEnabled!==e&&(this._endSnappingEnabled=e,this.updateSashEnablement())}constructor(e,t={}){super(),this.orientation=t.orientation??0,this.inverseAltBehavior=t.inverseAltBehavior??!1,this.proportionalLayout=t.proportionalLayout??!0,this.getSashOrthogonalSize=t.getSashOrthogonalSize,this.el=document.createElement("div"),this.el.classList.add("monaco-split-view2"),this.el.classList.add(this.orientation===0?"vertical":"horizontal"),e.appendChild(this.el),this.sashContainer=dt(this.el,Ge(".sash-container")),this.viewContainer=Ge(".split-view-container"),this.scrollable=this._register(new xs({forceIntegerValues:!0,smoothScrollDuration:125,scheduleAtNextAnimationFrame:i=>ni(Ce(this.el),i)})),this.scrollableElement=this._register(new oc(this.viewContainer,{vertical:this.orientation===0?t.scrollbarVisibility??1:2,horizontal:this.orientation===1?t.scrollbarVisibility??1:2},this.scrollable));let n=this._register(new Ae(this.viewContainer,"scroll")).event;this._register(n(i=>{let r=this.scrollableElement.getScrollPosition(),s=Math.abs(this.viewContainer.scrollLeft-r.scrollLeft)<=1?void 0:this.viewContainer.scrollLeft,a=Math.abs(this.viewContainer.scrollTop-r.scrollTop)<=1?void 0:this.viewContainer.scrollTop;(s!==void 0||a!==void 0)&&this.scrollableElement.setScrollPosition({scrollLeft:s,scrollTop:a})})),this.onDidScroll=this.scrollableElement.onScroll,this._register(this.onDidScroll(i=>{i.scrollTopChanged&&(this.viewContainer.scrollTop=i.scrollTop),i.scrollLeftChanged&&(this.viewContainer.scrollLeft=i.scrollLeft)})),dt(this.el,this.scrollableElement.getDomNode()),this.style(t.styles||g6),t.descriptor&&(this.size=t.descriptor.size,t.descriptor.views.forEach((i,r)=>{let s=Kn(i.visible)||i.visible?i.size:{type:"invisible",cachedVisibleSize:i.size},a=i.view;this.doAddView(a,s,r,!0)}),this._contentSize=this.viewItems.reduce((i,r)=>i+r.size,0),this.saveProportions())}style(e){e.separatorBorder.isTransparent()?(this.el.classList.remove("separator-border"),this.el.style.removeProperty("--separator-border")):(this.el.classList.add("separator-border"),this.el.style.setProperty("--separator-border",e.separatorBorder.toString()))}addView(e,t,n=this.viewItems.length,i){this.doAddView(e,t,n,i)}removeView(e,t){if(e<0||e>=this.viewItems.length)throw new Error("Index out of bounds");if(this.state!==0)throw new Error("Cant modify splitview");this.state=1;try{t?.type==="auto"&&(this.areViewsDistributed()?t={type:"distribute"}:t={type:"split",index:t.index});let n=t?.type==="split"?this.viewItems[t.index]:void 0,i=this.viewItems.splice(e,1)[0];if(n&&(n.size+=i.size),this.viewItems.length>=1){let s=Math.max(e-1,0);this.sashItems.splice(s,1)[0].disposable.dispose()}this.relayout(),t?.type==="distribute"&&this.distributeViewSizes();let r=i.view;return i.dispose(),r}finally{this.state=0}}removeAllViews(){if(this.state!==0)throw new Error("Cant modify splitview");this.state=1;try{let e=this.viewItems.splice(0,this.viewItems.length);for(let n of e)n.dispose();let t=this.sashItems.splice(0,this.sashItems.length);for(let n of t)n.disposable.dispose();return this.relayout(),e.map(n=>n.view)}finally{this.state=0}}moveView(e,t){if(this.state!==0)throw new Error("Cant modify splitview");let n=this.getViewCachedVisibleSize(e),i=typeof n>"u"?this.getViewSize(e):ac.Invisible(n),r=this.removeView(e);this.addView(r,i,t)}swapViews(e,t){if(this.state!==0)throw new Error("Cant modify splitview");if(e>t)return this.swapViews(t,e);let n=this.getViewSize(e),i=this.getViewSize(t),r=this.removeView(t),s=this.removeView(e);this.addView(r,n,e),this.addView(s,i,t)}isViewVisible(e){if(e<0||e>=this.viewItems.length)throw new Error("Index out of bounds");return this.viewItems[e].visible}setViewVisible(e,t){if(e<0||e>=this.viewItems.length)throw new Error("Index out of bounds");this.viewItems[e].setVisible(t),this.distributeEmptySpace(e),this.layoutViews(),this.saveProportions()}getViewCachedVisibleSize(e){if(e<0||e>=this.viewItems.length)throw new Error("Index out of bounds");return this.viewItems[e].cachedVisibleSize}layout(e,t){let n=Math.max(this.size,this._contentSize);if(this.size=e,this.layoutContext=t,this.proportions){let i=0;for(let r=0;r<this.viewItems.length;r++){let s=this.viewItems[r],a=this.proportions[r];typeof a=="number"?i+=a:e-=s.size}for(let r=0;r<this.viewItems.length;r++){let s=this.viewItems[r],a=this.proportions[r];typeof a=="number"&&i>0&&(s.size=Ri(Math.round(a*e/i),s.minimumSize,s.maximumSize))}}else{let i=Yn(this.viewItems.length),r=i.filter(a=>this.viewItems[a].priority===1),s=i.filter(a=>this.viewItems[a].priority===2);this.resize(this.viewItems.length-1,e-n,void 0,r,s)}this.distributeEmptySpace(),this.layoutViews()}saveProportions(){this.proportionalLayout&&this._contentSize>0&&(this.proportions=this.viewItems.map(e=>e.proportionalLayout&&e.visible?e.size/this._contentSize:void 0))}onSashStart({sash:e,start:t,alt:n}){for(let a of this.viewItems)a.enabled=!1;let i=this.sashItems.findIndex(a=>a.sash===e),r=Ro(j(this.el.ownerDocument.body,"keydown",a=>s(this.sashDragState.current,a.altKey)),j(this.el.ownerDocument.body,"keyup",()=>s(this.sashDragState.current,!1))),s=(a,l)=>{let d=this.viewItems.map(f=>f.size),c=Number.NEGATIVE_INFINITY,u=Number.POSITIVE_INFINITY;if(this.inverseAltBehavior&&(l=!l),l)if(i===this.sashItems.length-1){let g=this.viewItems[i];c=(g.minimumSize-g.size)/2,u=(g.maximumSize-g.size)/2}else{let g=this.viewItems[i+1];c=(g.size-g.maximumSize)/2,u=(g.size-g.minimumSize)/2}let p,h;if(!l){let f=Yn(i,-1),g=Yn(i+1,this.viewItems.length),b=f.reduce((L,k)=>L+(this.viewItems[k].minimumSize-d[k]),0),v=f.reduce((L,k)=>L+(this.viewItems[k].viewMaximumSize-d[k]),0),y=g.length===0?Number.POSITIVE_INFINITY:g.reduce((L,k)=>L+(d[k]-this.viewItems[k].minimumSize),0),S=g.length===0?Number.NEGATIVE_INFINITY:g.reduce((L,k)=>L+(d[k]-this.viewItems[k].viewMaximumSize),0),E=Math.max(b,S),C=Math.min(y,v),w=this.findFirstSnapIndex(f),_=this.findFirstSnapIndex(g);if(typeof w=="number"){let L=this.viewItems[w],k=Math.floor(L.viewMinimumSize/2);p={index:w,limitDelta:L.visible?E-k:E+k,size:L.size}}if(typeof _=="number"){let L=this.viewItems[_],k=Math.floor(L.viewMinimumSize/2);h={index:_,limitDelta:L.visible?C+k:C-k,size:L.size}}}this.sashDragState={start:a,current:a,index:i,sizes:d,minDelta:c,maxDelta:u,alt:l,snapBefore:p,snapAfter:h,disposable:r}};s(t,n)}onSashChange({current:e}){let{index:t,start:n,sizes:i,alt:r,minDelta:s,maxDelta:a,snapBefore:l,snapAfter:d}=this.sashDragState;this.sashDragState.current=e;let c=e-n,u=this.resize(t,c,i,void 0,void 0,s,a,l,d);if(r){let p=t===this.sashItems.length-1,h=this.viewItems.map(S=>S.size),f=p?t:t+1,g=this.viewItems[f],b=g.size-g.maximumSize,v=g.size-g.minimumSize,y=p?t-1:t+1;this.resize(y,-u,h,void 0,void 0,b,v)}this.distributeEmptySpace(),this.layoutViews()}onSashEnd(e){this._onDidSashChange.fire(e),this.sashDragState.disposable.dispose(),this.saveProportions();for(let t of this.viewItems)t.enabled=!0}onViewChange(e,t){let n=this.viewItems.indexOf(e);n<0||n>=this.viewItems.length||(t=typeof t=="number"?t:e.size,t=Ri(t,e.minimumSize,e.maximumSize),this.inverseAltBehavior&&n>0?(this.resize(n-1,Math.floor((e.size-t)/2)),this.distributeEmptySpace(),this.layoutViews()):(e.size=t,this.relayout([n],void 0)))}resizeView(e,t){if(!(e<0||e>=this.viewItems.length)){if(this.state!==0)throw new Error("Cant modify splitview");this.state=1;try{let n=Yn(this.viewItems.length).filter(a=>a!==e),i=[...n.filter(a=>this.viewItems[a].priority===1),e],r=n.filter(a=>this.viewItems[a].priority===2),s=this.viewItems[e];t=Math.round(t),t=Ri(t,s.minimumSize,Math.min(s.maximumSize,this.size)),s.size=t,this.relayout(i,r)}finally{this.state=0}}}isViewExpanded(e){if(e<0||e>=this.viewItems.length)return!1;for(let t of this.viewItems)if(t!==this.viewItems[e]&&t.size>t.minimumSize)return!1;return!0}distributeViewSizes(){let e=[],t=0;for(let a of this.viewItems)a.maximumSize-a.minimumSize>0&&(e.push(a),t+=a.size);let n=Math.floor(t/e.length);for(let a of e)a.size=Ri(n,a.minimumSize,a.maximumSize);let i=Yn(this.viewItems.length),r=i.filter(a=>this.viewItems[a].priority===1),s=i.filter(a=>this.viewItems[a].priority===2);this.relayout(r,s)}getViewSize(e){return e<0||e>=this.viewItems.length?-1:this.viewItems[e].size}doAddView(e,t,n=this.viewItems.length,i){if(this.state!==0)throw new Error("Cant modify splitview");this.state=1;try{let r=Ge(".split-view-view");n===this.viewItems.length?this.viewContainer.appendChild(r):this.viewContainer.insertBefore(r,this.viewContainer.children.item(n));let s=e.onDidChange(p=>this.onViewChange(c,p)),a=le(()=>r.remove()),l=Ro(s,a),d;typeof t=="number"?d=t:(t.type==="auto"&&(this.areViewsDistributed()?t={type:"distribute"}:t={type:"split",index:t.index}),t.type==="split"?d=this.getViewSize(t.index)/2:t.type==="invisible"?d={cachedVisibleSize:t.cachedVisibleSize}:d=e.minimumSize);let c=this.orientation===0?new d1(r,e,d,l):new c1(r,e,d,l);if(this.viewItems.splice(n,0,c),this.viewItems.length>1){let p={orthogonalStartSash:this.orthogonalStartSash,orthogonalEndSash:this.orthogonalEndSash},h=this.orientation===0?new Eu(this.sashContainer,{getHorizontalSashTop:L=>this.getSashPosition(L),getHorizontalSashWidth:this.getSashOrthogonalSize},{...p,orientation:1}):new Eu(this.sashContainer,{getVerticalSashLeft:L=>this.getSashPosition(L),getVerticalSashHeight:this.getSashOrthogonalSize},{...p,orientation:0}),f=this.orientation===0?L=>({sash:h,start:L.startY,current:L.currentY,alt:L.altKey}):L=>({sash:h,start:L.startX,current:L.currentX,alt:L.altKey}),b=q.map(h.onDidStart,f)(this.onSashStart,this),y=q.map(h.onDidChange,f)(this.onSashChange,this),E=q.map(h.onDidEnd,()=>this.sashItems.findIndex(L=>L.sash===h))(this.onSashEnd,this),C=h.onDidReset(()=>{let L=this.sashItems.findIndex(oe=>oe.sash===h),k=Yn(L,-1),W=Yn(L+1,this.viewItems.length),K=this.findFirstSnapIndex(k),U=this.findFirstSnapIndex(W);typeof K=="number"&&!this.viewItems[K].visible||typeof U=="number"&&!this.viewItems[U].visible||this._onDidSashReset.fire(L)}),w=Ro(b,y,E,C,h),_={sash:h,disposable:w};this.sashItems.splice(n-1,0,_)}r.appendChild(e.element);let u;typeof t!="number"&&t.type==="split"&&(u=[t.index]),i||this.relayout([n],u),!i&&typeof t!="number"&&t.type==="distribute"&&this.distributeViewSizes()}finally{this.state=0}}relayout(e,t){let n=this.viewItems.reduce((i,r)=>i+r.size,0);this.resize(this.viewItems.length-1,this.size-n,void 0,e,t),this.distributeEmptySpace(),this.layoutViews(),this.saveProportions()}resize(e,t,n=this.viewItems.map(c=>c.size),i,r,s=Number.NEGATIVE_INFINITY,a=Number.POSITIVE_INFINITY,l,d){if(e<0||e>=this.viewItems.length)return 0;let c=Yn(e,-1),u=Yn(e+1,this.viewItems.length);if(r)for(let _ of r)_y(c,_),_y(u,_);if(i)for(let _ of i)Gg(c,_),Gg(u,_);let p=c.map(_=>this.viewItems[_]),h=c.map(_=>n[_]),f=u.map(_=>this.viewItems[_]),g=u.map(_=>n[_]),b=c.reduce((_,L)=>_+(this.viewItems[L].minimumSize-n[L]),0),v=c.reduce((_,L)=>_+(this.viewItems[L].maximumSize-n[L]),0),y=u.length===0?Number.POSITIVE_INFINITY:u.reduce((_,L)=>_+(n[L]-this.viewItems[L].minimumSize),0),S=u.length===0?Number.NEGATIVE_INFINITY:u.reduce((_,L)=>_+(n[L]-this.viewItems[L].maximumSize),0),E=Math.max(b,S,s),C=Math.min(y,v,a),w=!1;if(l){let _=this.viewItems[l.index],L=t>=l.limitDelta;w=L!==_.visible,_.setVisible(L,l.size)}if(!w&&d){let _=this.viewItems[d.index],L=t<d.limitDelta;w=L!==_.visible,_.setVisible(L,d.size)}if(w)return this.resize(e,t,n,i,r,s,a);t=Ri(t,E,C);for(let _=0,L=t;_<p.length;_++){let k=p[_],W=Ri(h[_]+L,k.minimumSize,k.maximumSize),K=W-h[_];L-=K,k.size=W}for(let _=0,L=t;_<f.length;_++){let k=f[_],W=Ri(g[_]-L,k.minimumSize,k.maximumSize),K=W-g[_];L+=K,k.size=W}return t}distributeEmptySpace(e){let t=this.viewItems.reduce((a,l)=>a+l.size,0),n=this.size-t,i=Yn(this.viewItems.length-1,-1),r=i.filter(a=>this.viewItems[a].priority===1),s=i.filter(a=>this.viewItems[a].priority===2);for(let a of s)_y(i,a);for(let a of r)Gg(i,a);typeof e=="number"&&Gg(i,e);for(let a=0;n!==0&&a<i.length;a++){let l=this.viewItems[i[a]],d=Ri(l.size+n,l.minimumSize,l.maximumSize),c=d-l.size;n-=c,l.size=d}}layoutViews(){this._contentSize=this.viewItems.reduce((t,n)=>t+n.size,0);let e=0;for(let t of this.viewItems)t.layout(e,this.layoutContext),e+=t.size;this.sashItems.forEach(t=>t.sash.layout()),this.updateSashEnablement(),this.updateScrollableElement()}updateScrollableElement(){this.orientation===0?this.scrollableElement.setScrollDimensions({height:this.size,scrollHeight:this._contentSize}):this.scrollableElement.setScrollDimensions({width:this.size,scrollWidth:this._contentSize})}updateSashEnablement(){let e=!1,t=this.viewItems.map(l=>e=l.size-l.minimumSize>0||e);e=!1;let n=this.viewItems.map(l=>e=l.maximumSize-l.size>0||e),i=[...this.viewItems].reverse();e=!1;let r=i.map(l=>e=l.size-l.minimumSize>0||e).reverse();e=!1;let s=i.map(l=>e=l.maximumSize-l.size>0||e).reverse(),a=0;for(let l=0;l<this.sashItems.length;l++){let{sash:d}=this.sashItems[l],c=this.viewItems[l];a+=c.size;let u=!(t[l]&&s[l+1]),p=!(n[l]&&r[l+1]);if(u&&p){let h=Yn(l,-1),f=Yn(l+1,this.viewItems.length),g=this.findFirstSnapIndex(h),b=this.findFirstSnapIndex(f),v=typeof g=="number"&&!this.viewItems[g].visible,y=typeof b=="number"&&!this.viewItems[b].visible;v&&r[l]&&(a>0||this.startSnappingEnabled)?d.state=1:y&&t[l]&&(a<this._contentSize||this.endSnappingEnabled)?d.state=2:d.state=0}else u&&!p?d.state=1:!u&&p?d.state=2:d.state=3}}getSashPosition(e){let t=0;for(let n=0;n<this.sashItems.length;n++)if(t+=this.viewItems[n].size,this.sashItems[n].sash===e)return t;return 0}findFirstSnapIndex(e){for(let t of e){let n=this.viewItems[t];if(n.visible&&n.snap)return t}for(let t of e){let n=this.viewItems[t];if(n.visible&&n.maximumSize-n.minimumSize>0)return;if(!n.visible&&n.snap)return t}}areViewsDistributed(){let e,t;for(let n of this.viewItems)if(e=e===void 0?n.size:Math.min(e,n.size),t=t===void 0?n.size:Math.max(t,n.size),t-e>2)return!1;return!0}dispose(){this.sashDragState?.disposable.dispose(),wt(this.viewItems),this.viewItems=[],this.sashItems.forEach(e=>e.disposable.dispose()),this.sashItems=[],super.dispose()}};var CE=class o{constructor(e,t,n){this.columns=e;this.getColumnSize=n;let i=new Map(t.map(r=>[r.templateId,r]));this.renderers=[];for(let r of e){let s=i.get(r.templateId);if(!s)throw new Error(`Table cell renderer for template id ${r.templateId} not found.`);this.renderers.push(s)}}static TemplateId="row";templateId=o.TemplateId;renderers;renderedTemplates=new Set;renderTemplate(e){let t=dt(e,Ge(".monaco-table-tr")),n=[],i=[];for(let s=0;s<this.columns.length;s++){let a=this.renderers[s],l=dt(t,Ge(".monaco-table-td",{"data-col-index":s}));l.style.width=`${this.getColumnSize(s)}px`,n.push(l),i.push(a.renderTemplate(l))}let r={container:e,cellContainers:n,cellTemplateData:i};return this.renderedTemplates.add(r),r}renderElement(e,t,n,i){for(let r=0;r<this.columns.length;r++){let a=this.columns[r].project(e);this.renderers[r].renderElement(a,t,n.cellTemplateData[r],i)}}disposeElement(e,t,n,i){for(let r=0;r<this.columns.length;r++){let s=this.renderers[r];if(s.disposeElement){let l=this.columns[r].project(e);s.disposeElement(l,t,n.cellTemplateData[r],i)}}}disposeTemplate(e){for(let t=0;t<this.columns.length;t++)this.renderers[t].disposeTemplate(e.cellTemplateData[t]);fi(e.container),this.renderedTemplates.delete(e)}layoutColumn(e,t){for(let{cellContainers:n}of this.renderedTemplates)n[e].style.width=`${t}px`}};function f6(o){return{getHeight(e){return o.getHeight(e)},getTemplateId(){return CE.TemplateId}}}var u1=class extends F{constructor(t,n){super();this.column=t;this.index=n;this.element=Ge(".monaco-table-th",{"data-col-index":n},t.label),t.tooltip&&this._register(xo().setupManagedHover(Fn("mouse"),this.element,t.tooltip))}element;get minimumSize(){return this.column.minimumWidth??120}get maximumSize(){return this.column.maximumWidth??Number.POSITIVE_INFINITY}get onDidChange(){return this.column.onDidChangeWidthConstraints??q.None}_onDidLayout=new D;onDidLayout=this._onDidLayout.event;layout(t){this._onDidLayout.fire([this.index,t])}},SE=class o{constructor(e,t,n,i,r,s){this.virtualDelegate=n;this.columns=i;this.domNode=dt(t,Ge(`.monaco-table.${this.domId}`));let a=i.map((c,u)=>this.disposables.add(new u1(c,u))),l={size:a.reduce((c,u)=>c+u.column.weight,0),views:a.map(c=>({size:c.column.weight,view:c}))};this.splitview=this.disposables.add(new Vu(this.domNode,{orientation:1,scrollbarVisibility:2,getSashOrthogonalSize:()=>this.cachedHeight,descriptor:l})),this.splitview.el.style.height=`${n.headerRowHeight}px`,this.splitview.el.style.lineHeight=`${n.headerRowHeight}px`;let d=new CE(i,r,c=>this.splitview.getViewSize(c));this.list=this.disposables.add(new ii(e,this.domNode,f6(n),[d],s)),q.any(...a.map(c=>c.onDidLayout))(([c,u])=>d.layoutColumn(c,u),null,this.disposables),this.splitview.onDidSashReset(c=>{let u=i.reduce((h,f)=>h+f.weight,0),p=i[c].weight/u*this.cachedWidth;this.splitview.resizeView(c,p)},null,this.disposables),this.styleElement=ur(this.domNode),this.style(vE)}static InstanceCount=0;domId=`table_id_${++o.InstanceCount}`;domNode;splitview;list;styleElement;disposables=new ee;cachedWidth=0;cachedHeight=0;get onDidChangeFocus(){return this.list.onDidChangeFocus}get onDidChangeSelection(){return this.list.onDidChangeSelection}get onDidScroll(){return this.list.onDidScroll}get onMouseClick(){return this.list.onMouseClick}get onMouseDblClick(){return this.list.onMouseDblClick}get onMouseMiddleClick(){return this.list.onMouseMiddleClick}get onPointer(){return this.list.onPointer}get onMouseUp(){return this.list.onMouseUp}get onMouseDown(){return this.list.onMouseDown}get onMouseOver(){return this.list.onMouseOver}get onMouseMove(){return this.list.onMouseMove}get onMouseOut(){return this.list.onMouseOut}get onTouchStart(){return this.list.onTouchStart}get onTap(){return this.list.onTap}get onContextMenu(){return this.list.onContextMenu}get onDidFocus(){return this.list.onDidFocus}get onDidBlur(){return this.list.onDidBlur}get scrollTop(){return this.list.scrollTop}set scrollTop(e){this.list.scrollTop=e}get scrollLeft(){return this.list.scrollLeft}set scrollLeft(e){this.list.scrollLeft=e}get scrollHeight(){return this.list.scrollHeight}get renderHeight(){return this.list.renderHeight}get onDidDispose(){return this.list.onDidDispose}getColumnLabels(){return this.columns.map(e=>e.label)}resizeColumn(e,t){let n=Math.round(t/100*this.cachedWidth);this.splitview.resizeView(e,n)}updateOptions(e){this.list.updateOptions(e)}splice(e,t,n=[]){this.list.splice(e,t,n)}rerender(){this.list.rerender()}row(e){return this.list.element(e)}indexOf(e){return this.list.indexOf(e)}get length(){return this.list.length}getHTMLElement(){return this.domNode}layout(e,t){e=e??bS(this.domNode),t=t??Nh(this.domNode),this.cachedWidth=t,this.cachedHeight=e,this.splitview.layout(t);let n=e-this.virtualDelegate.headerRowHeight;this.list.getHTMLElement().style.height=`${n}px`,this.list.layout(n,t)}triggerTypeNavigation(){this.list.triggerTypeNavigation()}style(e){let t=[];t.push(`.monaco-table.${this.domId} > .monaco-split-view2 .monaco-sash.vertical::before {
			top: ${this.virtualDelegate.headerRowHeight+1}px;
			height: calc(100% - ${this.virtualDelegate.headerRowHeight}px);
		}`),this.styleElement.textContent=t.join(`
`),this.list.style(e)}domFocus(){this.list.domFocus()}setAnchor(e){this.list.setAnchor(e)}getAnchor(){return this.list.getAnchor()}getSelectedElements(){return this.list.getSelectedElements()}setSelection(e,t){this.list.setSelection(e,t)}getSelection(){return this.list.getSelection()}setFocus(e,t){this.list.setFocus(e,t)}focusNext(e=1,t=!1,n){this.list.focusNext(e,t,n)}focusPrevious(e=1,t=!1,n){this.list.focusPrevious(e,t,n)}focusNextPage(e){return this.list.focusNextPage(e)}focusPreviousPage(e){return this.list.focusPreviousPage(e)}focusFirst(e){this.list.focusFirst(e)}focusLast(e){this.list.focusLast(e)}getFocus(){return this.list.getFocus()}getFocusedElements(){return this.list.getFocusedElements()}getRelativeTop(e){return this.list.getRelativeTop(e)}reveal(e,t){this.list.reveal(e,t)}dispose(){this.disposables.dispose()}};function WW(o,e={}){let t=EE(e);return t.textContent=o,t}function HW(o,e={}){let t=EE(e);return UW(t,b6(o,!!e.renderCodeSegments),e.actionHandler,e.renderCodeSegments),t}function EE(o){let e=o.inline?"span":"div",t=document.createElement(e);return o.className&&(t.className=o.className),t}var p1=class{source;index;constructor(e){this.source=e,this.index=0}eos(){return this.index>=this.source.length}next(){let e=this.peek();return this.advance(),e}peek(){return this.source[this.index]}advance(){this.index++}};function UW(o,e,t,n){let i;if(e.type===2)i=document.createTextNode(e.content||"");else if(e.type===3)i=document.createElement("b");else if(e.type===4)i=document.createElement("i");else if(e.type===7&&n)i=document.createElement("code");else if(e.type===5&&t){let r=document.createElement("a");t.disposables.add(bn(r,"click",s=>{t.callback(String(e.index),s)})),i=r}else e.type===8?i=document.createElement("br"):e.type===1&&(i=o);i&&o!==i&&o.appendChild(i),i&&Array.isArray(e.children)&&e.children.forEach(r=>{UW(i,r,t,n)})}function b6(o,e){let t={type:1,children:[]},n=0,i=t,r=[],s=new p1(o);for(;!s.eos();){let a=s.next(),l=a==="\\"&&h1(s.peek(),e)!==0;if(l&&(a=s.next()),!l&&v6(a,e)&&a===s.peek()){s.advance(),i.type===2&&(i=r.pop());let d=h1(a,e);if(i.type===d||i.type===5&&d===6)i=r.pop();else{let c={type:d,children:[]};d===5&&(c.index=n,n++),i.children.push(c),r.push(i),i=c}}else if(a===`
`)i.type===2&&(i=r.pop()),i.children.push({type:8});else if(i.type!==2){let d={type:2,content:a};i.children.push(d),r.push(i),i=d}else i.content+=a}return i.type===2&&(i=r.pop()),r.length,t}function v6(o,e){return h1(o,e)!==0}function h1(o,e){switch(o){case"*":return 3;case"_":return 4;case"[":return 5;case"]":return 6;case"`":return e?7:0;default:return 0}}var y6=new RegExp(`(\\\\)?\\$\\((${we.iconNameExpression}(?:${we.iconModifierExpression})?)\\)`,"g");function jb(o){let e=new Array,t,n=0,i=0;for(;(t=y6.exec(o))!==null;){i=t.index||0,n<i&&e.push(o.substring(n,i)),n=(t.index||0)+t[0].length;let[,r,s]=t;e.push(r?`$(${s})`:pm({id:s}))}return n<o.length&&e.push(o.substring(n)),e}function pm(o){let e=Ge("span");return e.classList.add(...we.asClassNameArray(o)),e}var m1=class{_prefix;_lastId;constructor(e){this._prefix=e,this._lastId=0}nextId(){return this._prefix+ ++this._lastId}},g1=new m1("id#");var Mi={};(function(){function o(e,t){t(Mi)}o.amd=!0,function(e,t){typeof o=="function"&&o.amd?o(["exports"],t):typeof exports=="object"&&typeof module<"u"?t(exports):(e=typeof globalThis<"u"?globalThis:e||self,t(e.marked={}))}(this,function(e){"use strict";function t(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}e.defaults=t();function n(Ke){e.defaults=Ke}let i=/[&<>"']/,r=new RegExp(i.source,"g"),s=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,a=new RegExp(s.source,"g"),l={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},d=Ke=>l[Ke];function c(Ke,R){if(R){if(i.test(Ke))return Ke.replace(r,d)}else if(s.test(Ke))return Ke.replace(a,d);return Ke}let u=/(^|[^\[])\^/g;function p(Ke,R){let M=typeof Ke=="string"?Ke:Ke.source;R=R||"";let N={replace:(V,z)=>{let X=typeof z=="string"?z:z.source;return X=X.replace(u,"$1"),M=M.replace(V,X),N},getRegex:()=>new RegExp(M,R)};return N}function h(Ke){try{Ke=encodeURI(Ke).replace(/%25/g,"%")}catch{return null}return Ke}let f={exec:()=>null};function g(Ke,R){let M=Ke.replace(/\|/g,(z,X,re)=>{let xe=!1,De=X;for(;--De>=0&&re[De]==="\\";)xe=!xe;return xe?"|":" |"}),N=M.split(/ \|/),V=0;if(N[0].trim()||N.shift(),N.length>0&&!N[N.length-1].trim()&&N.pop(),R)if(N.length>R)N.splice(R);else for(;N.length<R;)N.push("");for(;V<N.length;V++)N[V]=N[V].trim().replace(/\\\|/g,"|");return N}function b(Ke,R,M){let N=Ke.length;if(N===0)return"";let V=0;for(;V<N;){let z=Ke.charAt(N-V-1);if(z===R&&!M)V++;else if(z!==R&&M)V++;else break}return Ke.slice(0,N-V)}function v(Ke,R){if(Ke.indexOf(R[1])===-1)return-1;let M=0;for(let N=0;N<Ke.length;N++)if(Ke[N]==="\\")N++;else if(Ke[N]===R[0])M++;else if(Ke[N]===R[1]&&(M--,M<0))return N;return-1}function y(Ke,R,M,N){let V=R.href,z=R.title?c(R.title):null,X=Ke[1].replace(/\\([\[\]])/g,"$1");if(Ke[0].charAt(0)!=="!"){N.state.inLink=!0;let re={type:"link",raw:M,href:V,title:z,text:X,tokens:N.inlineTokens(X)};return N.state.inLink=!1,re}return{type:"image",raw:M,href:V,title:z,text:c(X)}}function S(Ke,R){let M=Ke.match(/^(\s+)(?:```)/);if(M===null)return R;let N=M[1];return R.split(`
`).map(V=>{let z=V.match(/^\s+/);if(z===null)return V;let[X]=z;return X.length>=N.length?V.slice(N.length):V}).join(`
`)}class E{options;rules;lexer;constructor(R){this.options=R||e.defaults}space(R){let M=this.rules.block.newline.exec(R);if(M&&M[0].length>0)return{type:"space",raw:M[0]}}code(R){let M=this.rules.block.code.exec(R);if(M){let N=M[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:M[0],codeBlockStyle:"indented",text:this.options.pedantic?N:b(N,`
`)}}}fences(R){let M=this.rules.block.fences.exec(R);if(M){let N=M[0],V=S(N,M[3]||"");return{type:"code",raw:N,lang:M[2]?M[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):M[2],text:V}}}heading(R){let M=this.rules.block.heading.exec(R);if(M){let N=M[2].trim();if(/#$/.test(N)){let V=b(N,"#");(this.options.pedantic||!V||/ $/.test(V))&&(N=V.trim())}return{type:"heading",raw:M[0],depth:M[1].length,text:N,tokens:this.lexer.inline(N)}}}hr(R){let M=this.rules.block.hr.exec(R);if(M)return{type:"hr",raw:b(M[0],`
`)}}blockquote(R){let M=this.rules.block.blockquote.exec(R);if(M){let N=b(M[0],`
`).split(`
`),V="",z="",X=[];for(;N.length>0;){let re=!1,xe=[],De;for(De=0;De<N.length;De++)if(/^ {0,3}>/.test(N[De]))xe.push(N[De]),re=!0;else if(!re)xe.push(N[De]);else break;N=N.slice(De);let ot=xe.join(`
`),Tt=ot.replace(/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,`
    $1`).replace(/^ {0,3}>[ \t]?/gm,"");V=V?`${V}
${ot}`:ot,z=z?`${z}
${Tt}`:Tt;let rn=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(Tt,X,!0),this.lexer.state.top=rn,N.length===0)break;let Wn=X[X.length-1];if(Wn?.type==="code")break;if(Wn?.type==="blockquote"){let hn=Wn,Fe=hn.raw+`
`+N.join(`
`),G=this.blockquote(Fe);X[X.length-1]=G,V=V.substring(0,V.length-hn.raw.length)+G.raw,z=z.substring(0,z.length-hn.text.length)+G.text;break}else if(Wn?.type==="list"){let hn=Wn,Fe=hn.raw+`
`+N.join(`
`),G=this.list(Fe);X[X.length-1]=G,V=V.substring(0,V.length-Wn.raw.length)+G.raw,z=z.substring(0,z.length-hn.raw.length)+G.raw,N=Fe.substring(X[X.length-1].raw.length).split(`
`);continue}}return{type:"blockquote",raw:V,tokens:X,text:z}}}list(R){let M=this.rules.block.list.exec(R);if(M){let N=M[1].trim(),V=N.length>1,z={type:"list",raw:"",ordered:V,start:V?+N.slice(0,-1):"",loose:!1,items:[]};N=V?`\\d{1,9}\\${N.slice(-1)}`:`\\${N}`,this.options.pedantic&&(N=V?N:"[*+-]");let X=new RegExp(`^( {0,3}${N})((?:[	 ][^\\n]*)?(?:\\n|$))`),re=!1;for(;R;){let xe=!1,De="",ot="";if(!(M=X.exec(R))||this.rules.block.hr.test(R))break;De=M[0],R=R.substring(De.length);let Tt=M[2].split(`
`,1)[0].replace(/^\t+/,Ie=>" ".repeat(3*Ie.length)),rn=R.split(`
`,1)[0],Wn=!Tt.trim(),hn=0;if(this.options.pedantic?(hn=2,ot=Tt.trimStart()):Wn?hn=M[1].length+1:(hn=M[2].search(/[^ ]/),hn=hn>4?1:hn,ot=Tt.slice(hn),hn+=M[1].length),Wn&&/^ *$/.test(rn)&&(De+=rn+`
`,R=R.substring(rn.length+1),xe=!0),!xe){let Ie=new RegExp(`^ {0,${Math.min(3,hn-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),Me=new RegExp(`^ {0,${Math.min(3,hn-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),Zt=new RegExp(`^ {0,${Math.min(3,hn-1)}}(?:\`\`\`|~~~)`),$n=new RegExp(`^ {0,${Math.min(3,hn-1)}}#`);for(;R;){let ho=R.split(`
`,1)[0];if(rn=ho,this.options.pedantic&&(rn=rn.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),Zt.test(rn)||$n.test(rn)||Ie.test(rn)||Me.test(R))break;if(rn.search(/[^ ]/)>=hn||!rn.trim())ot+=`
`+rn.slice(hn);else{if(Wn||Tt.search(/[^ ]/)>=4||Zt.test(Tt)||$n.test(Tt)||Me.test(Tt))break;ot+=`
`+rn}!Wn&&!rn.trim()&&(Wn=!0),De+=ho+`
`,R=R.substring(ho.length+1),Tt=rn.slice(hn)}}z.loose||(re?z.loose=!0:/\n *\n *$/.test(De)&&(re=!0));let Fe=null,G;this.options.gfm&&(Fe=/^\[[ xX]\] /.exec(ot),Fe&&(G=Fe[0]!=="[ ] ",ot=ot.replace(/^\[[ xX]\] +/,""))),z.items.push({type:"list_item",raw:De,task:!!Fe,checked:G,loose:!1,text:ot,tokens:[]}),z.raw+=De}z.items[z.items.length-1].raw=z.items[z.items.length-1].raw.trimEnd(),z.items[z.items.length-1].text=z.items[z.items.length-1].text.trimEnd(),z.raw=z.raw.trimEnd();for(let xe=0;xe<z.items.length;xe++)if(this.lexer.state.top=!1,z.items[xe].tokens=this.lexer.blockTokens(z.items[xe].text,[]),!z.loose){let De=z.items[xe].tokens.filter(Tt=>Tt.type==="space"),ot=De.length>0&&De.some(Tt=>/\n.*\n/.test(Tt.raw));z.loose=ot}if(z.loose)for(let xe=0;xe<z.items.length;xe++)z.items[xe].loose=!0;return z}}html(R){let M=this.rules.block.html.exec(R);if(M)return{type:"html",block:!0,raw:M[0],pre:M[1]==="pre"||M[1]==="script"||M[1]==="style",text:M[0]}}def(R){let M=this.rules.block.def.exec(R);if(M){let N=M[1].toLowerCase().replace(/\s+/g," "),V=M[2]?M[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",z=M[3]?M[3].substring(1,M[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):M[3];return{type:"def",tag:N,raw:M[0],href:V,title:z}}}table(R){let M=this.rules.block.table.exec(R);if(!M||!/[:|]/.test(M[2]))return;let N=g(M[1]),V=M[2].replace(/^\||\| *$/g,"").split("|"),z=M[3]&&M[3].trim()?M[3].replace(/\n[ \t]*$/,"").split(`
`):[],X={type:"table",raw:M[0],header:[],align:[],rows:[]};if(N.length===V.length){for(let re of V)/^ *-+: *$/.test(re)?X.align.push("right"):/^ *:-+: *$/.test(re)?X.align.push("center"):/^ *:-+ *$/.test(re)?X.align.push("left"):X.align.push(null);for(let re=0;re<N.length;re++)X.header.push({text:N[re],tokens:this.lexer.inline(N[re]),header:!0,align:X.align[re]});for(let re of z)X.rows.push(g(re,X.header.length).map((xe,De)=>({text:xe,tokens:this.lexer.inline(xe),header:!1,align:X.align[De]})));return X}}lheading(R){let M=this.rules.block.lheading.exec(R);if(M)return{type:"heading",raw:M[0],depth:M[2].charAt(0)==="="?1:2,text:M[1],tokens:this.lexer.inline(M[1])}}paragraph(R){let M=this.rules.block.paragraph.exec(R);if(M){let N=M[1].charAt(M[1].length-1)===`
`?M[1].slice(0,-1):M[1];return{type:"paragraph",raw:M[0],text:N,tokens:this.lexer.inline(N)}}}text(R){let M=this.rules.block.text.exec(R);if(M)return{type:"text",raw:M[0],text:M[0],tokens:this.lexer.inline(M[0])}}escape(R){let M=this.rules.inline.escape.exec(R);if(M)return{type:"escape",raw:M[0],text:c(M[1])}}tag(R){let M=this.rules.inline.tag.exec(R);if(M)return!this.lexer.state.inLink&&/^<a /i.test(M[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(M[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(M[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(M[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:M[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:M[0]}}link(R){let M=this.rules.inline.link.exec(R);if(M){let N=M[2].trim();if(!this.options.pedantic&&/^</.test(N)){if(!/>$/.test(N))return;let X=b(N.slice(0,-1),"\\");if((N.length-X.length)%2===0)return}else{let X=v(M[2],"()");if(X>-1){let xe=(M[0].indexOf("!")===0?5:4)+M[1].length+X;M[2]=M[2].substring(0,X),M[0]=M[0].substring(0,xe).trim(),M[3]=""}}let V=M[2],z="";if(this.options.pedantic){let X=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(V);X&&(V=X[1],z=X[3])}else z=M[3]?M[3].slice(1,-1):"";return V=V.trim(),/^</.test(V)&&(this.options.pedantic&&!/>$/.test(N)?V=V.slice(1):V=V.slice(1,-1)),y(M,{href:V&&V.replace(this.rules.inline.anyPunctuation,"$1"),title:z&&z.replace(this.rules.inline.anyPunctuation,"$1")},M[0],this.lexer)}}reflink(R,M){let N;if((N=this.rules.inline.reflink.exec(R))||(N=this.rules.inline.nolink.exec(R))){let V=(N[2]||N[1]).replace(/\s+/g," "),z=M[V.toLowerCase()];if(!z){let X=N[0].charAt(0);return{type:"text",raw:X,text:X}}return y(N,z,N[0],this.lexer)}}emStrong(R,M,N=""){let V=this.rules.inline.emStrongLDelim.exec(R);if(!V||V[3]&&N.match(/[\p{L}\p{N}]/u))return;if(!(V[1]||V[2]||"")||!N||this.rules.inline.punctuation.exec(N)){let X=[...V[0]].length-1,re,xe,De=X,ot=0,Tt=V[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(Tt.lastIndex=0,M=M.slice(-1*R.length+X);(V=Tt.exec(M))!=null;){if(re=V[1]||V[2]||V[3]||V[4]||V[5]||V[6],!re)continue;if(xe=[...re].length,V[3]||V[4]){De+=xe;continue}else if((V[5]||V[6])&&X%3&&!((X+xe)%3)){ot+=xe;continue}if(De-=xe,De>0)continue;xe=Math.min(xe,xe+De+ot);let rn=[...V[0]][0].length,Wn=R.slice(0,X+V.index+rn+xe);if(Math.min(X,xe)%2){let Fe=Wn.slice(1,-1);return{type:"em",raw:Wn,text:Fe,tokens:this.lexer.inlineTokens(Fe)}}let hn=Wn.slice(2,-2);return{type:"strong",raw:Wn,text:hn,tokens:this.lexer.inlineTokens(hn)}}}}codespan(R){let M=this.rules.inline.code.exec(R);if(M){let N=M[2].replace(/\n/g," "),V=/[^ ]/.test(N),z=/^ /.test(N)&&/ $/.test(N);return V&&z&&(N=N.substring(1,N.length-1)),N=c(N,!0),{type:"codespan",raw:M[0],text:N}}}br(R){let M=this.rules.inline.br.exec(R);if(M)return{type:"br",raw:M[0]}}del(R){let M=this.rules.inline.del.exec(R);if(M)return{type:"del",raw:M[0],text:M[2],tokens:this.lexer.inlineTokens(M[2])}}autolink(R){let M=this.rules.inline.autolink.exec(R);if(M){let N,V;return M[2]==="@"?(N=c(M[1]),V="mailto:"+N):(N=c(M[1]),V=N),{type:"link",raw:M[0],text:N,href:V,tokens:[{type:"text",raw:N,text:N}]}}}url(R){let M;if(M=this.rules.inline.url.exec(R)){let N,V;if(M[2]==="@")N=c(M[0]),V="mailto:"+N;else{let z;do z=M[0],M[0]=this.rules.inline._backpedal.exec(M[0])?.[0]??"";while(z!==M[0]);N=c(M[0]),M[1]==="www."?V="http://"+M[0]:V=M[0]}return{type:"link",raw:M[0],text:N,href:V,tokens:[{type:"text",raw:N,text:N}]}}}inlineText(R){let M=this.rules.inline.text.exec(R);if(M){let N;return this.lexer.state.inRawBlock?N=M[0]:N=c(M[0]),{type:"text",raw:M[0],text:N}}}}let C=/^(?: *(?:\n|$))+/,w=/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,_=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,L=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,k=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,W=/(?:[*+-]|\d{1,9}[.)])/,K=p(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,W).replace(/blockCode/g,/ {4}/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),U=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,oe=/^[^\n]+/,Se=/(?!\s*\])(?:\\.|[^\[\]\\])+/,ne=p(/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/).replace("label",Se).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),Q=p(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,W).getRegex(),de="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",se=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,ie=p("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))","i").replace("comment",se).replace("tag",de).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Te=p(U).replace("hr",L).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",de).getRegex(),Xe={blockquote:p(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Te).getRegex(),code:w,def:ne,fences:_,heading:k,hr:L,html:ie,lheading:K,list:Q,newline:C,paragraph:Te,table:f,text:oe},ze=p("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",L).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",de).getRegex(),_e={...Xe,table:ze,paragraph:p(U).replace("hr",L).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",ze).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",de).getRegex()},vn={...Xe,html:p(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",se).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:f,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:p(U).replace("hr",L).replace("heading",` *#{1,6} *[^
]`).replace("lheading",K).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},cn=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,Bn=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,di=/^( {2,}|\\)\n(?!\s*$)/,ms=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,Nt="\\p{P}\\p{S}",Ai=p(/^((?![*_])[\spunctuation])/,"u").replace(/punctuation/g,Nt).getRegex(),Fc=/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g,Jl=p(/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,"u").replace(/punct/g,Nt).getRegex(),Fi=p("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)[punct](\\*+)(?=[\\s]|$)|[^punct\\s](\\*+)(?!\\*)(?=[punct\\s]|$)|(?!\\*)[punct\\s](\\*+)(?=[^punct\\s])|[\\s](\\*+)(?!\\*)(?=[punct])|(?!\\*)[punct](\\*+)(?!\\*)(?=[punct])|[^punct\\s](\\*+)(?=[^punct\\s])","gu").replace(/punct/g,Nt).getRegex(),ed=p("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\\s]|$)|[^punct\\s](_+)(?!_)(?=[punct\\s]|$)|(?!_)[punct\\s](_+)(?=[^punct\\s])|[\\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])","gu").replace(/punct/g,Nt).getRegex(),td=p(/\\([punct])/,"gu").replace(/punct/g,Nt).getRegex(),Dp=p(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),Lp=p(se).replace("(?:-->|$)","-->").getRegex(),He=p("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",Lp).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),ol=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,nd=p(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",ol).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),ta=p(/^!?\[(label)\]\[(ref)\]/).replace("label",ol).replace("ref",Se).getRegex(),Gr=p(/^!?\[(ref)\](?:\[\])?/).replace("ref",Se).getRegex(),Wg=p("reflink|nolink(?!\\()","g").replace("reflink",ta).replace("nolink",Gr).getRegex(),Bc={_backpedal:f,anyPunctuation:td,autolink:Dp,blockSkip:Fc,br:di,code:Bn,del:f,emStrongLDelim:Jl,emStrongRDelimAst:Fi,emStrongRDelimUnd:ed,escape:cn,link:nd,nolink:Gr,punctuation:Ai,reflink:ta,reflinkSearch:Wg,tag:He,text:ms,url:f},Hg={...Bc,link:p(/^!?\[(label)\]\((.*?)\)/).replace("label",ol).getRegex(),reflink:p(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",ol).getRegex()},na={...Bc,escape:p(cn).replace("])","~|])").getRegex(),url:p(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},Ug={...na,br:p(di).replace("{2,}","*").getRegex(),text:p(na.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},ia={normal:Xe,gfm:_e,pedantic:vn},Cr={normal:Bc,gfm:na,breaks:Ug,pedantic:Hg};class Vn{tokens;options;state;tokenizer;inlineQueue;constructor(R){this.tokens=[],this.tokens.links=Object.create(null),this.options=R||e.defaults,this.options.tokenizer=this.options.tokenizer||new E,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let M={block:ia.normal,inline:Cr.normal};this.options.pedantic?(M.block=ia.pedantic,M.inline=Cr.pedantic):this.options.gfm&&(M.block=ia.gfm,this.options.breaks?M.inline=Cr.breaks:M.inline=Cr.gfm),this.tokenizer.rules=M}static get rules(){return{block:ia,inline:Cr}}static lex(R,M){return new Vn(M).lex(R)}static lexInline(R,M){return new Vn(M).inlineTokens(R)}lex(R){R=R.replace(/\r\n|\r/g,`
`),this.blockTokens(R,this.tokens);for(let M=0;M<this.inlineQueue.length;M++){let N=this.inlineQueue[M];this.inlineTokens(N.src,N.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(R,M=[],N=!1){this.options.pedantic?R=R.replace(/\t/g,"    ").replace(/^ +$/gm,""):R=R.replace(/^( *)(\t+)/gm,(re,xe,De)=>xe+"    ".repeat(De.length));let V,z,X;for(;R;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(re=>(V=re.call({lexer:this},R,M))?(R=R.substring(V.raw.length),M.push(V),!0):!1))){if(V=this.tokenizer.space(R)){R=R.substring(V.raw.length),V.raw.length===1&&M.length>0?M[M.length-1].raw+=`
`:M.push(V);continue}if(V=this.tokenizer.code(R)){R=R.substring(V.raw.length),z=M[M.length-1],z&&(z.type==="paragraph"||z.type==="text")?(z.raw+=`
`+V.raw,z.text+=`
`+V.text,this.inlineQueue[this.inlineQueue.length-1].src=z.text):M.push(V);continue}if(V=this.tokenizer.fences(R)){R=R.substring(V.raw.length),M.push(V);continue}if(V=this.tokenizer.heading(R)){R=R.substring(V.raw.length),M.push(V);continue}if(V=this.tokenizer.hr(R)){R=R.substring(V.raw.length),M.push(V);continue}if(V=this.tokenizer.blockquote(R)){R=R.substring(V.raw.length),M.push(V);continue}if(V=this.tokenizer.list(R)){R=R.substring(V.raw.length),M.push(V);continue}if(V=this.tokenizer.html(R)){R=R.substring(V.raw.length),M.push(V);continue}if(V=this.tokenizer.def(R)){R=R.substring(V.raw.length),z=M[M.length-1],z&&(z.type==="paragraph"||z.type==="text")?(z.raw+=`
`+V.raw,z.text+=`
`+V.raw,this.inlineQueue[this.inlineQueue.length-1].src=z.text):this.tokens.links[V.tag]||(this.tokens.links[V.tag]={href:V.href,title:V.title});continue}if(V=this.tokenizer.table(R)){R=R.substring(V.raw.length),M.push(V);continue}if(V=this.tokenizer.lheading(R)){R=R.substring(V.raw.length),M.push(V);continue}if(X=R,this.options.extensions&&this.options.extensions.startBlock){let re=1/0,xe=R.slice(1),De;this.options.extensions.startBlock.forEach(ot=>{De=ot.call({lexer:this},xe),typeof De=="number"&&De>=0&&(re=Math.min(re,De))}),re<1/0&&re>=0&&(X=R.substring(0,re+1))}if(this.state.top&&(V=this.tokenizer.paragraph(X))){z=M[M.length-1],N&&z?.type==="paragraph"?(z.raw+=`
`+V.raw,z.text+=`
`+V.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=z.text):M.push(V),N=X.length!==R.length,R=R.substring(V.raw.length);continue}if(V=this.tokenizer.text(R)){R=R.substring(V.raw.length),z=M[M.length-1],z&&z.type==="text"?(z.raw+=`
`+V.raw,z.text+=`
`+V.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=z.text):M.push(V);continue}if(R){let re="Infinite loop on byte: "+R.charCodeAt(0);if(this.options.silent){console.error(re);break}else throw new Error(re)}}return this.state.top=!0,M}inline(R,M=[]){return this.inlineQueue.push({src:R,tokens:M}),M}inlineTokens(R,M=[]){let N,V,z,X=R,re,xe,De;if(this.tokens.links){let ot=Object.keys(this.tokens.links);if(ot.length>0)for(;(re=this.tokenizer.rules.inline.reflinkSearch.exec(X))!=null;)ot.includes(re[0].slice(re[0].lastIndexOf("[")+1,-1))&&(X=X.slice(0,re.index)+"["+"a".repeat(re[0].length-2)+"]"+X.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(re=this.tokenizer.rules.inline.blockSkip.exec(X))!=null;)X=X.slice(0,re.index)+"["+"a".repeat(re[0].length-2)+"]"+X.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(re=this.tokenizer.rules.inline.anyPunctuation.exec(X))!=null;)X=X.slice(0,re.index)+"++"+X.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;R;)if(xe||(De=""),xe=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(ot=>(N=ot.call({lexer:this},R,M))?(R=R.substring(N.raw.length),M.push(N),!0):!1))){if(N=this.tokenizer.escape(R)){R=R.substring(N.raw.length),M.push(N);continue}if(N=this.tokenizer.tag(R)){R=R.substring(N.raw.length),V=M[M.length-1],V&&N.type==="text"&&V.type==="text"?(V.raw+=N.raw,V.text+=N.text):M.push(N);continue}if(N=this.tokenizer.link(R)){R=R.substring(N.raw.length),M.push(N);continue}if(N=this.tokenizer.reflink(R,this.tokens.links)){R=R.substring(N.raw.length),V=M[M.length-1],V&&N.type==="text"&&V.type==="text"?(V.raw+=N.raw,V.text+=N.text):M.push(N);continue}if(N=this.tokenizer.emStrong(R,X,De)){R=R.substring(N.raw.length),M.push(N);continue}if(N=this.tokenizer.codespan(R)){R=R.substring(N.raw.length),M.push(N);continue}if(N=this.tokenizer.br(R)){R=R.substring(N.raw.length),M.push(N);continue}if(N=this.tokenizer.del(R)){R=R.substring(N.raw.length),M.push(N);continue}if(N=this.tokenizer.autolink(R)){R=R.substring(N.raw.length),M.push(N);continue}if(!this.state.inLink&&(N=this.tokenizer.url(R))){R=R.substring(N.raw.length),M.push(N);continue}if(z=R,this.options.extensions&&this.options.extensions.startInline){let ot=1/0,Tt=R.slice(1),rn;this.options.extensions.startInline.forEach(Wn=>{rn=Wn.call({lexer:this},Tt),typeof rn=="number"&&rn>=0&&(ot=Math.min(ot,rn))}),ot<1/0&&ot>=0&&(z=R.substring(0,ot+1))}if(N=this.tokenizer.inlineText(z)){R=R.substring(N.raw.length),N.raw.slice(-1)!=="_"&&(De=N.raw.slice(-1)),xe=!0,V=M[M.length-1],V&&V.type==="text"?(V.raw+=N.raw,V.text+=N.text):M.push(N);continue}if(R){let ot="Infinite loop on byte: "+R.charCodeAt(0);if(this.options.silent){console.error(ot);break}else throw new Error(ot)}}return M}}class Sr{options;parser;constructor(R){this.options=R||e.defaults}space(R){return""}code({text:R,lang:M,escaped:N}){let V=(M||"").match(/^\S*/)?.[0],z=R.replace(/\n$/,"")+`
`;return V?'<pre><code class="language-'+c(V)+'">'+(N?z:c(z,!0))+`</code></pre>
`:"<pre><code>"+(N?z:c(z,!0))+`</code></pre>
`}blockquote({tokens:R}){return`<blockquote>
${this.parser.parse(R)}</blockquote>
`}html({text:R}){return R}heading({tokens:R,depth:M}){return`<h${M}>${this.parser.parseInline(R)}</h${M}>
`}hr(R){return`<hr>
`}list(R){let M=R.ordered,N=R.start,V="";for(let re=0;re<R.items.length;re++){let xe=R.items[re];V+=this.listitem(xe)}let z=M?"ol":"ul",X=M&&N!==1?' start="'+N+'"':"";return"<"+z+X+`>
`+V+"</"+z+`>
`}listitem(R){let M="";if(R.task){let N=this.checkbox({checked:!!R.checked});R.loose?R.tokens.length>0&&R.tokens[0].type==="paragraph"?(R.tokens[0].text=N+" "+R.tokens[0].text,R.tokens[0].tokens&&R.tokens[0].tokens.length>0&&R.tokens[0].tokens[0].type==="text"&&(R.tokens[0].tokens[0].text=N+" "+R.tokens[0].tokens[0].text)):R.tokens.unshift({type:"text",raw:N+" ",text:N+" "}):M+=N+" "}return M+=this.parser.parse(R.tokens,!!R.loose),`<li>${M}</li>
`}checkbox({checked:R}){return"<input "+(R?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:R}){return`<p>${this.parser.parseInline(R)}</p>
`}table(R){let M="",N="";for(let z=0;z<R.header.length;z++)N+=this.tablecell(R.header[z]);M+=this.tablerow({text:N});let V="";for(let z=0;z<R.rows.length;z++){let X=R.rows[z];N="";for(let re=0;re<X.length;re++)N+=this.tablecell(X[re]);V+=this.tablerow({text:N})}return V&&(V=`<tbody>${V}</tbody>`),`<table>
<thead>
`+M+`</thead>
`+V+`</table>
`}tablerow({text:R}){return`<tr>
${R}</tr>
`}tablecell(R){let M=this.parser.parseInline(R.tokens),N=R.header?"th":"td";return(R.align?`<${N} align="${R.align}">`:`<${N}>`)+M+`</${N}>
`}strong({tokens:R}){return`<strong>${this.parser.parseInline(R)}</strong>`}em({tokens:R}){return`<em>${this.parser.parseInline(R)}</em>`}codespan({text:R}){return`<code>${R}</code>`}br(R){return"<br>"}del({tokens:R}){return`<del>${this.parser.parseInline(R)}</del>`}link({href:R,title:M,tokens:N}){let V=this.parser.parseInline(N),z=h(R);if(z===null)return V;R=z;let X='<a href="'+R+'"';return M&&(X+=' title="'+M+'"'),X+=">"+V+"</a>",X}image({href:R,title:M,text:N}){let V=h(R);if(V===null)return N;R=V;let z=`<img src="${R}" alt="${N}"`;return M&&(z+=` title="${M}"`),z+=">",z}text(R){return"tokens"in R&&R.tokens?this.parser.parseInline(R.tokens):R.text}}class rl{strong({text:R}){return R}em({text:R}){return R}codespan({text:R}){return R}del({text:R}){return R}html({text:R}){return R}text({text:R}){return R}link({text:R}){return""+R}image({text:R}){return""+R}br(){return""}}class po{options;renderer;textRenderer;constructor(R){this.options=R||e.defaults,this.options.renderer=this.options.renderer||new Sr,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new rl}static parse(R,M){return new po(M).parse(R)}static parseInline(R,M){return new po(M).parseInline(R)}parse(R,M=!0){let N="";for(let V=0;V<R.length;V++){let z=R[V];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[z.type]){let re=z,xe=this.options.extensions.renderers[re.type].call({parser:this},re);if(xe!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(re.type)){N+=xe||"";continue}}let X=z;switch(X.type){case"space":{N+=this.renderer.space(X);continue}case"hr":{N+=this.renderer.hr(X);continue}case"heading":{N+=this.renderer.heading(X);continue}case"code":{N+=this.renderer.code(X);continue}case"table":{N+=this.renderer.table(X);continue}case"blockquote":{N+=this.renderer.blockquote(X);continue}case"list":{N+=this.renderer.list(X);continue}case"html":{N+=this.renderer.html(X);continue}case"paragraph":{N+=this.renderer.paragraph(X);continue}case"text":{let re=X,xe=this.renderer.text(re);for(;V+1<R.length&&R[V+1].type==="text";)re=R[++V],xe+=`
`+this.renderer.text(re);M?N+=this.renderer.paragraph({type:"paragraph",raw:xe,text:xe,tokens:[{type:"text",raw:xe,text:xe}]}):N+=xe;continue}default:{let re='Token with "'+X.type+'" type was not found.';if(this.options.silent)return console.error(re),"";throw new Error(re)}}}return N}parseInline(R,M){M=M||this.renderer;let N="";for(let V=0;V<R.length;V++){let z=R[V];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[z.type]){let re=this.options.extensions.renderers[z.type].call({parser:this},z);if(re!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(z.type)){N+=re||"";continue}}let X=z;switch(X.type){case"escape":{N+=M.text(X);break}case"html":{N+=M.html(X);break}case"link":{N+=M.link(X);break}case"image":{N+=M.image(X);break}case"strong":{N+=M.strong(X);break}case"em":{N+=M.em(X);break}case"codespan":{N+=M.codespan(X);break}case"br":{N+=M.br(X);break}case"del":{N+=M.del(X);break}case"text":{N+=M.text(X);break}default:{let re='Token with "'+X.type+'" type was not found.';if(this.options.silent)return console.error(re),"";throw new Error(re)}}}return N}}class id{options;constructor(R){this.options=R||e.defaults}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(R){return R}postprocess(R){return R}processAllTokens(R){return R}}class gs{defaults=t();options=this.setOptions;parse=this.parseMarkdown(Vn.lex,po.parse);parseInline=this.parseMarkdown(Vn.lexInline,po.parseInline);Parser=po;Renderer=Sr;TextRenderer=rl;Lexer=Vn;Tokenizer=E;Hooks=id;constructor(...R){this.use(...R)}walkTokens(R,M){let N=[];for(let V of R)switch(N=N.concat(M.call(this,V)),V.type){case"table":{let z=V;for(let X of z.header)N=N.concat(this.walkTokens(X.tokens,M));for(let X of z.rows)for(let re of X)N=N.concat(this.walkTokens(re.tokens,M));break}case"list":{let z=V;N=N.concat(this.walkTokens(z.items,M));break}default:{let z=V;this.defaults.extensions?.childTokens?.[z.type]?this.defaults.extensions.childTokens[z.type].forEach(X=>{let re=z[X].flat(1/0);N=N.concat(this.walkTokens(re,M))}):z.tokens&&(N=N.concat(this.walkTokens(z.tokens,M)))}}return N}use(...R){let M=this.defaults.extensions||{renderers:{},childTokens:{}};return R.forEach(N=>{let V={...N};if(V.async=this.defaults.async||V.async||!1,N.extensions&&(N.extensions.forEach(z=>{if(!z.name)throw new Error("extension name required");if("renderer"in z){let X=M.renderers[z.name];X?M.renderers[z.name]=function(...re){let xe=z.renderer.apply(this,re);return xe===!1&&(xe=X.apply(this,re)),xe}:M.renderers[z.name]=z.renderer}if("tokenizer"in z){if(!z.level||z.level!=="block"&&z.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let X=M[z.level];X?X.unshift(z.tokenizer):M[z.level]=[z.tokenizer],z.start&&(z.level==="block"?M.startBlock?M.startBlock.push(z.start):M.startBlock=[z.start]:z.level==="inline"&&(M.startInline?M.startInline.push(z.start):M.startInline=[z.start]))}"childTokens"in z&&z.childTokens&&(M.childTokens[z.name]=z.childTokens)}),V.extensions=M),N.renderer){let z=this.defaults.renderer||new Sr(this.defaults);for(let X in N.renderer){if(!(X in z))throw new Error(`renderer '${X}' does not exist`);if(["options","parser"].includes(X))continue;let re=X,xe=N.renderer[re],De=z[re];z[re]=(...ot)=>{let Tt=xe.apply(z,ot);return Tt===!1&&(Tt=De.apply(z,ot)),Tt||""}}V.renderer=z}if(N.tokenizer){let z=this.defaults.tokenizer||new E(this.defaults);for(let X in N.tokenizer){if(!(X in z))throw new Error(`tokenizer '${X}' does not exist`);if(["options","rules","lexer"].includes(X))continue;let re=X,xe=N.tokenizer[re],De=z[re];z[re]=(...ot)=>{let Tt=xe.apply(z,ot);return Tt===!1&&(Tt=De.apply(z,ot)),Tt}}V.tokenizer=z}if(N.hooks){let z=this.defaults.hooks||new id;for(let X in N.hooks){if(!(X in z))throw new Error(`hook '${X}' does not exist`);if(X==="options")continue;let re=X,xe=N.hooks[re],De=z[re];id.passThroughHooks.has(X)?z[re]=ot=>{if(this.defaults.async)return Promise.resolve(xe.call(z,ot)).then(rn=>De.call(z,rn));let Tt=xe.call(z,ot);return De.call(z,Tt)}:z[re]=(...ot)=>{let Tt=xe.apply(z,ot);return Tt===!1&&(Tt=De.apply(z,ot)),Tt}}V.hooks=z}if(N.walkTokens){let z=this.defaults.walkTokens,X=N.walkTokens;V.walkTokens=function(re){let xe=[];return xe.push(X.call(this,re)),z&&(xe=xe.concat(z.call(this,re))),xe}}this.defaults={...this.defaults,...V}}),this}setOptions(R){return this.defaults={...this.defaults,...R},this}lexer(R,M){return Vn.lex(R,M??this.defaults)}parser(R,M){return po.parse(R,M??this.defaults)}parseMarkdown(R,M){return(V,z)=>{let X={...z},re={...this.defaults,...X},xe=this.onError(!!re.silent,!!re.async);if(this.defaults.async===!0&&X.async===!1)return xe(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof V>"u"||V===null)return xe(new Error("marked(): input parameter is undefined or null"));if(typeof V!="string")return xe(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(V)+", string expected"));if(re.hooks&&(re.hooks.options=re),re.async)return Promise.resolve(re.hooks?re.hooks.preprocess(V):V).then(De=>R(De,re)).then(De=>re.hooks?re.hooks.processAllTokens(De):De).then(De=>re.walkTokens?Promise.all(this.walkTokens(De,re.walkTokens)).then(()=>De):De).then(De=>M(De,re)).then(De=>re.hooks?re.hooks.postprocess(De):De).catch(xe);try{re.hooks&&(V=re.hooks.preprocess(V));let De=R(V,re);re.hooks&&(De=re.hooks.processAllTokens(De)),re.walkTokens&&this.walkTokens(De,re.walkTokens);let ot=M(De,re);return re.hooks&&(ot=re.hooks.postprocess(ot)),ot}catch(De){return xe(De)}}}onError(R,M){return N=>{if(N.message+=`
Please report this to https://github.com/markedjs/marked.`,R){let V="<p>An error occurred:</p><pre>"+c(N.message+"",!0)+"</pre>";return M?Promise.resolve(V):V}if(M)return Promise.reject(N);throw N}}}let oa=new gs;function ve(Ke,R){return oa.parse(Ke,R)}ve.options=ve.setOptions=function(Ke){return oa.setOptions(Ke),ve.defaults=oa.defaults,n(ve.defaults),ve},ve.getDefaults=t,ve.defaults=e.defaults,ve.use=function(...Ke){return oa.use(...Ke),ve.defaults=oa.defaults,n(ve.defaults),ve},ve.walkTokens=function(Ke,R){return oa.walkTokens(Ke,R)},ve.parseInline=oa.parseInline,ve.Parser=po,ve.parser=po.parse,ve.Renderer=Sr,ve.TextRenderer=rl,ve.Lexer=Vn,ve.lexer=Vn.lex,ve.Tokenizer=E,ve.Hooks=id,ve.parse=ve;let pe=ve.options,B=ve.setOptions,ae=ve.use,fe=ve.walkTokens,nt=ve.parseInline,Rt=ve,ci=po.parse,Bi=Vn.lex;e.Hooks=id,e.Lexer=Vn,e.Marked=gs,e.Parser=po,e.Renderer=Sr,e.TextRenderer=rl,e.Tokenizer=E,e.getDefaults=t,e.lexer=Bi,e.marked=ve,e.options=pe,e.parse=Rt,e.parseInline=nt,e.parser=ci,e.setOptions=B,e.use=ae,e.walkTokens=fe})})();var sFe=Mi.Hooks||exports.Hooks,aFe=Mi.Lexer||exports.Lexer,lFe=Mi.Marked||exports.Marked,dFe=Mi.Parser||exports.Parser,f1=Mi.Renderer||exports.Renderer,cFe=Mi.TextRenderer||exports.TextRenderer,uFe=Mi.Tokenizer||exports.Tokenizer,zW=Mi.defaults||exports.defaults,pFe=Mi.getDefaults||exports.getDefaults,qb=Mi.lexer||exports.lexer,hFe=Mi.marked||exports.marked,mFe=Mi.options||exports.options,KW=Mi.parse||exports.parse,gFe=Mi.parseInline||exports.parseInline,GW=Mi.parser||exports.parser,fFe=Mi.setOptions||exports.setOptions,bFe=Mi.use||exports.use,vFe=Mi.walkTokens||exports.walkTokens;var b1=Object.freeze({image:({href:o,title:e,text:t})=>{let n=[],i=[];return o&&({href:o,dimensions:n}=PF(o),i.push(`src="${Df(o)}"`)),t&&i.push(`alt="${Df(t)}"`),e&&i.push(`title="${Df(e)}"`),n.length&&(i=i.concat(n)),"<img "+i.join(" ")+">"},paragraph({tokens:o}){return`<p>${this.parser.parseInline(o)}</p>`},link({href:o,title:e,tokens:t}){let n=this.parser.parseInline(t);return typeof o!="string"?"":(o===n&&(n=MI(n)),e=typeof e=="string"?Df(MI(e)):"",o=MI(o),o=o.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"),`<a href="${o}" title="${e||o}" draggable="false">${n}</a>`)}});function y1(o,e={},t={}){let n=new ee,i=!1,r=EE(e),s=function(g){let b;try{b=KC(decodeURIComponent(g))}catch{}return b?(b=jL(b,v=>{if(o.uris&&o.uris[v])return J.revive(o.uris[v])}),encodeURIComponent(JSON.stringify(b))):g},a=function(g,b){let v=o.uris&&o.uris[g],y=J.revive(v);return b?g.startsWith(Le.data+":")?g:(y||(y=J.parse(g)),ma.uriToBrowserUri(y).toString(!0)):!y||J.parse(g).toString()===y.toString()?g:(y.query&&(y=y.with({query:s(y.query)})),y.toString())},l=new f1;l.image=b1.image,l.link=b1.link,l.paragraph=b1.paragraph;let d=[],c=[];if(e.codeBlockRendererSync?l.code=({text:g,lang:b})=>{let v=g1.nextId(),y=e.codeBlockRendererSync(jW(b),g);return c.push([v,y]),`<div class="code" data-code="${v}">${jp(g)}</div>`}:e.codeBlockRenderer&&(l.code=({text:g,lang:b})=>{let v=g1.nextId(),y=e.codeBlockRenderer(jW(b),g);return d.push(y.then(S=>[v,S])),`<div class="code" data-code="${v}">${jp(g)}</div>`}),e.actionHandler){let g=function(y){let S=y.target.closest("a[data-href]");if(Nn(S))try{let E=S.dataset.href;E&&(o.baseUri&&(E=v1(J.from(o.baseUri),E)),e.actionHandler.callback(E,y))}catch(E){qe(E)}finally{y.preventDefault()}},b=e.actionHandler.disposables.add(new Ae(r,"click")),v=e.actionHandler.disposables.add(new Ae(r,"auxclick"));e.actionHandler.disposables.add(q.any(b.event,v.event)(y=>{let S=new Yi(Ce(r),y);!S.leftButton&&!S.middleButton||g(S)})),e.actionHandler.disposables.add(j(r,"keydown",y=>{let S=new mt(y);!S.equals(10)&&!S.equals(3)||g(S)}))}o.supportHtml||(l.html=({text:g})=>e.sanitizerOptions?.replaceWithPlaintext?jp(g):(o.isTrusted?g.match(/^(<span[^>]+>)|(<\/\s*span>)$/):void 0)?g:""),t.renderer=l;let u=o.value??"";u.length>1e5&&(u=`${u.substr(0,1e5)}\u2026`),o.supportThemeIcons&&(u=MF(u));let p;if(e.fillInIncompleteTokens){let g={...zW,...t},b=qb(u,g),v=D6(b);p=GW(v,g)}else p=KW(u,{...t,async:!1});o.supportThemeIcons&&(p=jb(p).map(b=>typeof b=="string"?b:b.outerHTML).join(""));let f=new DOMParser().parseFromString(qW({isTrusted:o.isTrusted,...e.sanitizerOptions},p),"text/html");if(f.body.querySelectorAll("img, audio, video, source").forEach(g=>{let b=g.getAttribute("src");if(b){let v=b;try{o.baseUri&&(v=v1(J.from(o.baseUri),v))}catch{}if(g.setAttribute("src",a(v,!0)),e.remoteImageIsAllowed){let y=J.parse(v);y.scheme!==Le.file&&y.scheme!==Le.data&&!e.remoteImageIsAllowed(y)&&g.replaceWith(Ge("",void 0,g.outerHTML))}}}),f.body.querySelectorAll("a").forEach(g=>{let b=g.getAttribute("href");if(g.setAttribute("href",""),!b||/^data:|javascript:/i.test(b)||/^command:/i.test(b)&&!o.isTrusted||/^command:(\/\/\/)?_workbench\.downloadResource/i.test(b))g.replaceWith(...g.childNodes);else{let v=a(b,!1);o.baseUri&&(v=v1(J.from(o.baseUri),b)),g.dataset.href=v}}),r.innerHTML=qW({isTrusted:o.isTrusted,...e.sanitizerOptions},f.body.innerHTML),d.length>0)Promise.all(d).then(g=>{if(i)return;let b=new Map(g),v=r.querySelectorAll("div[data-code]");for(let y of v){let S=b.get(y.dataset.code??"");S&&Br(y,S)}e.asyncRenderCallback?.()});else if(c.length>0){let g=new Map(c),b=r.querySelectorAll("div[data-code]");for(let v of b){let y=g.get(v.dataset.code??"");y&&Br(v,y)}}if(e.asyncRenderCallback)for(let g of r.getElementsByTagName("img")){let b=n.add(j(g,"load",()=>{b.dispose(),e.asyncRenderCallback()}))}return{element:r,dispose:()=>{i=!0,n.dispose()}}}function jW(o){if(!o)return"";let e=o.split(/[\s+|:|,|\{|\?]/,1);return e.length?e[0]:o}function v1(o,e){return/^\w[\w\d+.-]*:/.test(e)?e:o.path.endsWith("/")?vL(o,e).toString():vL(Sd(o),e).toString()}var C6=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"];function qW(o,e){let{config:t,allowedSchemes:n}=E6(o),i=new ee;i.add($W("uponSanitizeAttribute",(r,s)=>{if(s.attrName==="style"||s.attrName==="class"){if(r.tagName==="SPAN"){if(s.attrName==="style"){s.keepAttr=/^(color\:(#[0-9a-fA-F]+|var\(--vscode(-[a-zA-Z0-9]+)+\));)?(background-color\:(#[0-9a-fA-F]+|var\(--vscode(-[a-zA-Z0-9]+)+\));)?(border-radius:[0-9]+px;)?$/.test(s.attrValue);return}else if(s.attrName==="class"){s.keepAttr=/^codicon codicon-[a-z\-]+( codicon-modifier-[a-z\-]+)?$/.test(s.attrValue);return}}s.keepAttr=!1;return}else if(r.tagName==="INPUT"&&r.attributes.getNamedItem("type")?.value==="checkbox"){if(s.attrName==="type"&&s.attrValue==="checkbox"||s.attrName==="disabled"||s.attrName==="checked"){s.keepAttr=!0;return}s.keepAttr=!1}})),i.add($W("uponSanitizeElement",(r,s)=>{if(s.tagName==="input"&&(r.attributes.getNamedItem("type")?.value==="checkbox"?r.setAttribute("disabled",""):o.replaceWithPlaintext||r.remove()),o.replaceWithPlaintext&&!s.allowedTags[s.tagName]&&s.tagName!=="body"&&r.parentElement){let a,l;if(s.tagName==="#comment")a=`<!--${r.textContent}-->`;else{let p=C6.includes(s.tagName),h=r.attributes.length?" "+Array.from(r.attributes).map(f=>`${f.name}="${f.value}"`).join(" "):"";a=`<${s.tagName}${h}>`,p||(l=`</${s.tagName}>`)}let d=document.createDocumentFragment(),c=r.parentElement.ownerDocument.createTextNode(a);d.appendChild(c);let u=l?r.parentElement.ownerDocument.createTextNode(l):void 0;for(;r.firstChild;)d.appendChild(r.firstChild);u&&d.appendChild(u),r.parentElement.replaceChild(d,r)}})),i.add(PV(n));try{return pS(e,{...t,RETURN_TRUSTED_TYPE:!0})}finally{i.dispose()}}var S6=["align","autoplay","alt","checked","class","colspan","controls","data-code","data-href","disabled","draggable","height","href","loop","muted","playsinline","poster","rowspan","src","style","target","title","type","width","start"];function E6(o){let e=[Le.http,Le.https,Le.mailto,Le.data,Le.file,Le.vscodeFileResource,Le.vscodeRemote,Le.vscodeRemoteResource];return o.isTrusted&&e.push(Le.command),{config:{ALLOWED_TAGS:o.allowedTags??[...OV],ALLOWED_ATTR:S6,ALLOW_UNKNOWN_PROTOCOLS:!0},allowedSchemes:e}}function YW(){let o=new f1;return o.code=({text:e})=>e,o.blockquote=({text:e})=>e+`
`,o.html=e=>"",o.heading=function({tokens:e}){return this.parser.parseInline(e)+`
`},o.hr=()=>"",o.list=function({items:e}){return e.map(t=>this.listitem(t)).join(`
`)+`
`},o.listitem=({text:e})=>e+`
`,o.paragraph=function({tokens:e}){return this.parser.parseInline(e)+`
`},o.table=function({header:e,rows:t}){return e.map(n=>this.tablecell(n)).join(" ")+`
`+t.map(n=>n.map(i=>this.tablecell(i)).join(" ")).join(`
`)+`
`},o.tablerow=({text:e})=>e,o.tablecell=function({tokens:e}){return this.parser.parseInline(e)},o.strong=({text:e})=>e,o.em=({text:e})=>e,o.codespan=({text:e})=>e,o.br=e=>`
`,o.del=({text:e})=>e,o.image=e=>"",o.text=({text:e})=>e,o.link=({text:e})=>e,o}var UFe=new Qn(o=>YW()),zFe=new Qn(()=>{let o=YW();return o.code=({text:e})=>`
\`\`\`
${e}
\`\`\`
`,o});function TE(o){let e="";return o.forEach(t=>{e+=t.raw}),e}function ZW(o){if(o.tokens)for(let e=o.tokens.length-1;e>=0;e--){let t=o.tokens[e];if(t.type==="text"){let n=t.raw.split(`
`),i=n[n.length-1];if(i.includes("`"))return R6(o);if(i.includes("**"))return A6(o);if(i.match(/\*\w/))return k6(o);if(i.match(/(^|\s)__\w/))return F6(o);if(i.match(/(^|\s)_\w/))return M6(o);if(T6(i)||x6(i)&&o.tokens.slice(0,e).some(r=>r.type==="text"&&r.raw.match(/\[[^\]]*$/))){let r=o.tokens.slice(e+1);return r[0]?.type==="link"&&r[1]?.type==="text"&&r[1].raw.match(/^ *"[^"]*$/)||i.match(/^[^"]* +"[^"]*$/)?O6(o):P6(o)}else if(i.match(/(^|\s)\[\w*/))return N6(o)}}}function T6(o){return!!o.match(/(^|\s)\[.*\]\(\w*/)}function x6(o){return!!o.match(/^[^\[]*\]\([^\)]*$/)}function w6(o){let e=o.items[o.items.length-1],t=e.tokens?e.tokens[e.tokens.length-1]:void 0,n;if(t?.type==="text"&&!("inRawBlock"in e)&&(n=ZW(t)),!n||n.type!=="paragraph")return;let i=TE(o.items.slice(0,-1)),r=e.raw.match(/^(\s*(-|\d+\.|\*) +)/)?.[0];if(!r)return;let s=r+TE(e.tokens.slice(0,-1))+n.raw,a=qb(i+s)[0];if(a.type==="list")return a}var _6=3;function D6(o){for(let e=0;e<_6;e++){let t=L6(o);if(t)o=t;else break}return o}function L6(o){let e,t;for(e=0;e<o.length;e++){let n=o[e];if(n.type==="paragraph"&&n.raw.match(/(\n|^)\|/)){t=B6(o.slice(e));break}if(e===o.length-1&&n.type==="list"){let i=w6(n);if(i){t=[i];break}}if(e===o.length-1&&n.type==="paragraph"){let i=ZW(n);if(i){t=[i];break}}}if(t){let n=[...o.slice(0,e),...t];return n.links=o.links,n}return null}function R6(o){return lc(o,"`")}function k6(o){return lc(o,"*")}function M6(o){return lc(o,"_")}function P6(o){return lc(o,")")}function O6(o){return lc(o,'")')}function N6(o){return lc(o,"](https://microsoft.com)")}function A6(o){return lc(o,"**")}function F6(o){return lc(o,"__")}function lc(o,e){let t=TE(Array.isArray(o)?o:[o]);return qb(t+e)[0]}function B6(o){let e=TE(o),t=e.split(`
`),n,i=!1;for(let r=0;r<t.length;r++){let s=t[r].trim();if(typeof n>"u"&&s.match(/^\s*\|/)){let a=s.match(/(\|[^\|]+)(?=\||$)/g);a&&(n=a.length)}else if(typeof n=="number")if(s.match(/^\s*\|/)){if(r!==t.length-1)return;i=!0}else return}if(typeof n=="number"&&n>0){let r=i?t.slice(0,-1).join(`
`):e,s=!!r.match(/\|\s*$/),a=r+(s?"":"|")+`
|${" --- |".repeat(n)}`;return qb(a)}}function $W(o,e){return hS(o,e),le(()=>mS(o))}var Wu=Ge,XW="selectOption.entry.template",I1=class{get templateId(){return XW}renderTemplate(e){let t=Object.create(null);return t.root=e,t.text=dt(e,Wu(".option-text")),t.detail=dt(e,Wu(".option-detail")),t.decoratorRight=dt(e,Wu(".option-decorator-right")),t}renderElement(e,t,n){let i=n,r=e.text,s=e.detail,a=e.decoratorRight,l=e.isDisabled;i.text.textContent=r,i.detail.textContent=s||"",i.decoratorRight.innerText=a||"",l?i.root.classList.add("option-disabled"):i.root.classList.remove("option-disabled")}disposeTemplate(e){}},xE=class o extends F{static DEFAULT_DROPDOWN_MINIMUM_BOTTOM_MARGIN=32;static DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN=2;static DEFAULT_MINIMUM_VISIBLE_OPTIONS=3;_isVisible;selectBoxOptions;selectElement;container;options=[];selected;_onDidSelect;styles;listRenderer;contextViewProvider;selectDropDownContainer;styleElement;selectList;selectDropDownListContainer;widthControlElement;_currentSelection=0;_dropDownPosition;_hasDetails=!1;selectionDetailsPane;_skipLayout=!1;_cachedMaxDetailsHeight;_hover;_sticky=!1;constructor(e,t,n,i,r){super(),this._isVisible=!1,this.styles=i,this.selectBoxOptions=r||Object.create(null),typeof this.selectBoxOptions.minBottomMargin!="number"?this.selectBoxOptions.minBottomMargin=o.DEFAULT_DROPDOWN_MINIMUM_BOTTOM_MARGIN:this.selectBoxOptions.minBottomMargin<0&&(this.selectBoxOptions.minBottomMargin=0),this.selectElement=document.createElement("select"),this.selectElement.className="monaco-select-box monaco-select-box-dropdown-padding",typeof this.selectBoxOptions.ariaLabel=="string"&&this.selectElement.setAttribute("aria-label",this.selectBoxOptions.ariaLabel),typeof this.selectBoxOptions.ariaDescription=="string"&&this.selectElement.setAttribute("aria-description",this.selectBoxOptions.ariaDescription),this._onDidSelect=new D,this._register(this._onDidSelect),this.registerListeners(),this.constructSelectDropDown(n),this.selected=t||0,e&&this.setOptions(e,t),this.initStyleSheet()}setTitle(e){!this._hover&&e?this._hover=this._register(xo().setupManagedHover(Fn("mouse"),this.selectElement,e)):this._hover&&this._hover.update(e)}getHeight(){return 22}getTemplateId(){return XW}constructSelectDropDown(e){this.contextViewProvider=e,this.selectDropDownContainer=Ge(".monaco-select-box-dropdown-container"),this.selectDropDownContainer.classList.add("monaco-select-box-dropdown-padding"),this.selectionDetailsPane=dt(this.selectDropDownContainer,Wu(".select-box-details-pane"));let t=dt(this.selectDropDownContainer,Wu(".select-box-dropdown-container-width-control")),n=dt(t,Wu(".width-control-div"));this.widthControlElement=document.createElement("span"),this.widthControlElement.className="option-text-width-control",dt(n,this.widthControlElement),this._dropDownPosition=0,this.styleElement=ur(this.selectDropDownContainer),this.selectDropDownContainer.setAttribute("draggable","true"),this._register(j(this.selectDropDownContainer,me.DRAG_START,i=>{st.stop(i,!0)}))}registerListeners(){this._register(bn(this.selectElement,"change",t=>{this.selected=t.target.selectedIndex,this._onDidSelect.fire({index:t.target.selectedIndex,selected:t.target.value}),this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)})),this._register(j(this.selectElement,me.CLICK,t=>{st.stop(t),this._isVisible?this.hideSelectDropDown(!0):this.showSelectDropDown()})),this._register(j(this.selectElement,me.MOUSE_DOWN,t=>{st.stop(t)}));let e;this._register(j(this.selectElement,"touchstart",t=>{e=this._isVisible})),this._register(j(this.selectElement,"touchend",t=>{st.stop(t),e?this.hideSelectDropDown(!0):this.showSelectDropDown()})),this._register(j(this.selectElement,me.KEY_DOWN,t=>{let n=new mt(t),i=!1;Ve?(n.keyCode===18||n.keyCode===16||n.keyCode===10||n.keyCode===3)&&(i=!0):(n.keyCode===18&&n.altKey||n.keyCode===16&&n.altKey||n.keyCode===10||n.keyCode===3)&&(i=!0),i&&(this.showSelectDropDown(),st.stop(t,!0))}))}get onDidSelect(){return this._onDidSelect.event}setOptions(e,t){zt(this.options,e)||(this.options=e,this.selectElement.options.length=0,this._hasDetails=!1,this._cachedMaxDetailsHeight=void 0,this.options.forEach((n,i)=>{this.selectElement.add(this.createOption(n.text,i,n.isDisabled)),typeof n.description=="string"&&(this._hasDetails=!0)})),t!==void 0&&(this.select(t),this._currentSelection=this.selected)}setEnabled(e){this.selectElement.disabled=!e}setOptionsList(){this.selectList?.splice(0,this.selectList.length,this.options)}select(e){e>=0&&e<this.options.length?this.selected=e:e>this.options.length-1?this.select(this.options.length-1):this.selected<0&&(this.selected=0),this.selectElement.selectedIndex=this.selected,this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)}setAriaLabel(e){this.selectBoxOptions.ariaLabel=e,this.selectElement.setAttribute("aria-label",this.selectBoxOptions.ariaLabel)}focus(){this.selectElement&&(this.selectElement.tabIndex=0,this.selectElement.focus())}blur(){this.selectElement&&(this.selectElement.tabIndex=-1,this.selectElement.blur())}setFocusable(e){this.selectElement.tabIndex=e?0:-1}render(e){this.container=e,e.classList.add("select-container"),e.appendChild(this.selectElement),this.styleSelectElement()}initStyleSheet(){let e=[];this.styles.listFocusBackground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { background-color: ${this.styles.listFocusBackground} !important; }`),this.styles.listFocusForeground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { color: ${this.styles.listFocusForeground} !important; }`),this.styles.decoratorRightForeground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.focused) .option-decorator-right { color: ${this.styles.decoratorRightForeground}; }`),this.styles.selectBackground&&this.styles.selectBorder&&this.styles.selectBorder!==this.styles.selectBackground?(e.push(`.monaco-select-box-dropdown-container { border: 1px solid ${this.styles.selectBorder} } `),e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-top { border-top: 1px solid ${this.styles.selectBorder} } `),e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-bottom { border-bottom: 1px solid ${this.styles.selectBorder} } `)):this.styles.selectListBorder&&(e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-top { border-top: 1px solid ${this.styles.selectListBorder} } `),e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-bottom { border-bottom: 1px solid ${this.styles.selectListBorder} } `)),this.styles.listHoverForeground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { color: ${this.styles.listHoverForeground} !important; }`),this.styles.listHoverBackground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { background-color: ${this.styles.listHoverBackground} !important; }`),this.styles.listFocusOutline&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { outline: 1.6px dotted ${this.styles.listFocusOutline} !important; outline-offset: -1.6px !important; }`),this.styles.listHoverOutline&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { outline: 1.6px dashed ${this.styles.listHoverOutline} !important; outline-offset: -1.6px !important; }`),e.push(".monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.option-disabled.focused { background-color: transparent !important; color: inherit !important; outline: none !important; }"),e.push(".monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.option-disabled:hover { background-color: transparent !important; color: inherit !important; outline: none !important; }"),this.styleElement.textContent=e.join(`
`)}styleSelectElement(){let e=this.styles.selectBackground??"",t=this.styles.selectForeground??"",n=this.styles.selectBorder??"";this.selectElement.style.backgroundColor=e,this.selectElement.style.color=t,this.selectElement.style.borderColor=n}styleList(){let e=this.styles.selectBackground??"",t=Vr(this.styles.selectListBackground,e);this.selectDropDownListContainer.style.backgroundColor=t,this.selectionDetailsPane.style.backgroundColor=t;let n=this.styles.focusBorder??"";this.selectDropDownContainer.style.outlineColor=n,this.selectDropDownContainer.style.outlineOffset="-1px",this.selectList.style(this.styles)}createOption(e,t,n){let i=document.createElement("option");return i.value=e,i.text=e,i.disabled=!!n,i}showSelectDropDown(){this.selectionDetailsPane.innerText="",!(!this.contextViewProvider||this._isVisible)&&(this.createSelectList(this.selectDropDownContainer),this.setOptionsList(),this.contextViewProvider.showContextView({getAnchor:()=>this.selectElement,render:e=>this.renderSelectDropDown(e,!0),layout:()=>{this.layoutSelectDropDown()},onHide:()=>{this.selectDropDownContainer.classList.remove("visible"),this.selectElement.classList.remove("synthetic-focus")},anchorPosition:this._dropDownPosition},this.selectBoxOptions.optionsAsChildren?this.container:void 0),this._isVisible=!0,this.hideSelectDropDown(!1),this.contextViewProvider.showContextView({getAnchor:()=>this.selectElement,render:e=>this.renderSelectDropDown(e),layout:()=>this.layoutSelectDropDown(),onHide:()=>{this.selectDropDownContainer.classList.remove("visible"),this.selectElement.classList.remove("synthetic-focus")},anchorPosition:this._dropDownPosition},this.selectBoxOptions.optionsAsChildren?this.container:void 0),this._currentSelection=this.selected,this._isVisible=!0,this.selectElement.setAttribute("aria-expanded","true"))}hideSelectDropDown(e){!this.contextViewProvider||!this._isVisible||(this._isVisible=!1,this.selectElement.setAttribute("aria-expanded","false"),e&&this.selectElement.focus(),this.contextViewProvider.hideContextView())}renderSelectDropDown(e,t){return e.appendChild(this.selectDropDownContainer),this.layoutSelectDropDown(t),{dispose:()=>{this.selectDropDownContainer.remove()}}}measureMaxDetailsHeight(){let e=0;return this.options.forEach((t,n)=>{this.updateDetail(n),this.selectionDetailsPane.offsetHeight>e&&(e=this.selectionDetailsPane.offsetHeight)}),e}layoutSelectDropDown(e){if(this._skipLayout)return!1;if(this.selectList){this.selectDropDownContainer.classList.add("visible");let t=Ce(this.selectElement),n=io(this.selectElement),i=Ce(this.selectElement).getComputedStyle(this.selectElement),r=parseFloat(i.getPropertyValue("--dropdown-padding-top"))+parseFloat(i.getPropertyValue("--dropdown-padding-bottom")),s=t.innerHeight-n.top-n.height-(this.selectBoxOptions.minBottomMargin||0),a=n.top-o.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN,l=this.selectElement.offsetWidth,d=this.setWidthControlElement(this.widthControlElement),c=Math.max(d,Math.round(l)).toString()+"px";this.selectDropDownContainer.style.width=c,this.selectList.getHTMLElement().style.height="",this.selectList.layout();let u=this.selectList.contentHeight;this._hasDetails&&this._cachedMaxDetailsHeight===void 0&&(this._cachedMaxDetailsHeight=this.measureMaxDetailsHeight());let p=this._hasDetails?this._cachedMaxDetailsHeight:0,h=u+r+p,f=Math.floor((s-r-p)/this.getHeight()),g=Math.floor((a-r-p)/this.getHeight());if(e)return n.top+n.height>t.innerHeight-22||n.top<o.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN||f<1&&g<1?!1:(f<o.DEFAULT_MINIMUM_VISIBLE_OPTIONS&&g>f&&this.options.length>f?(this._dropDownPosition=1,this.selectDropDownListContainer.remove(),this.selectionDetailsPane.remove(),this.selectDropDownContainer.appendChild(this.selectionDetailsPane),this.selectDropDownContainer.appendChild(this.selectDropDownListContainer),this.selectionDetailsPane.classList.remove("border-top"),this.selectionDetailsPane.classList.add("border-bottom")):(this._dropDownPosition=0,this.selectDropDownListContainer.remove(),this.selectionDetailsPane.remove(),this.selectDropDownContainer.appendChild(this.selectDropDownListContainer),this.selectDropDownContainer.appendChild(this.selectionDetailsPane),this.selectionDetailsPane.classList.remove("border-bottom"),this.selectionDetailsPane.classList.add("border-top")),!0);if(n.top+n.height>t.innerHeight-22||n.top<o.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN||this._dropDownPosition===0&&f<1||this._dropDownPosition===1&&g<1)return this.hideSelectDropDown(!0),!1;if(this._dropDownPosition===0){if(this._isVisible&&f+g<1)return this.hideSelectDropDown(!0),!1;h>s&&(u=f*this.getHeight())}else h>a&&(u=g*this.getHeight());return this.selectList.layout(u),this.selectList.domFocus(),this.selectList.length>0&&(this.selectList.setFocus([this.selected||0]),this.selectList.reveal(this.selectList.getFocus()[0]||0)),this._hasDetails?(this.selectList.getHTMLElement().style.height=u+r+"px",this.selectDropDownContainer.style.height=""):this.selectDropDownContainer.style.height=u+r+"px",this.updateDetail(this.selected),this.selectDropDownContainer.style.width=c,this.selectDropDownListContainer.setAttribute("tabindex","0"),this.selectElement.classList.add("synthetic-focus"),this.selectDropDownContainer.classList.add("synthetic-focus"),!0}else return!1}setWidthControlElement(e){let t=0;if(e){let n=0,i=0;this.options.forEach((r,s)=>{let a=r.detail?r.detail.length:0,l=r.decoratorRight?r.decoratorRight.length:0,d=r.text.length+a+l;d>i&&(n=s,i=d)}),e.textContent=this.options[n].text+(this.options[n].decoratorRight?this.options[n].decoratorRight+" ":""),t=Oh(e)}return t}createSelectList(e){if(this.selectList)return;this.selectDropDownListContainer=dt(e,Wu(".select-box-dropdown-list-container")),this.listRenderer=new I1,this.selectList=this._register(new ii("SelectBoxCustom",this.selectDropDownListContainer,this,[this.listRenderer],{useShadows:!1,verticalScrollMode:3,keyboardSupport:!1,mouseSupport:!1,accessibilityProvider:{getAriaLabel:i=>{let r=i.text;return i.detail&&(r+=`. ${i.detail}`),i.decoratorRight&&(r+=`. ${i.decoratorRight}`),i.description&&(r+=`. ${i.description}`),r},getWidgetAriaLabel:()=>m({key:"selectBox",comment:["Behave like native select dropdown element."]},"Select Box"),getRole:()=>Ve?"":"option",getWidgetRole:()=>"listbox"}})),this.selectBoxOptions.ariaLabel&&(this.selectList.ariaLabel=this.selectBoxOptions.ariaLabel);let t=this._register(new Ae(this.selectDropDownListContainer,"keydown")),n=q.chain(t.event,i=>i.filter(()=>this.selectList.length>0).map(r=>new mt(r)));this._register(q.chain(n,i=>i.filter(r=>r.keyCode===3))(this.onEnter,this)),this._register(q.chain(n,i=>i.filter(r=>r.keyCode===2))(this.onEnter,this)),this._register(q.chain(n,i=>i.filter(r=>r.keyCode===9))(this.onEscape,this)),this._register(q.chain(n,i=>i.filter(r=>r.keyCode===16))(this.onUpArrow,this)),this._register(q.chain(n,i=>i.filter(r=>r.keyCode===18))(this.onDownArrow,this)),this._register(q.chain(n,i=>i.filter(r=>r.keyCode===12))(this.onPageDown,this)),this._register(q.chain(n,i=>i.filter(r=>r.keyCode===11))(this.onPageUp,this)),this._register(q.chain(n,i=>i.filter(r=>r.keyCode===14))(this.onHome,this)),this._register(q.chain(n,i=>i.filter(r=>r.keyCode===13))(this.onEnd,this)),this._register(q.chain(n,i=>i.filter(r=>r.keyCode>=21&&r.keyCode<=56||r.keyCode>=85&&r.keyCode<=113))(this.onCharacter,this)),this._register(j(this.selectList.getHTMLElement(),me.POINTER_UP,i=>this.onPointerUp(i))),this._register(this.selectList.onMouseOver(i=>typeof i.index<"u"&&this.selectList.setFocus([i.index]))),this._register(this.selectList.onDidChangeFocus(i=>this.onListFocus(i))),this._register(j(this.selectDropDownContainer,me.FOCUS_OUT,i=>{!this._isVisible||is(i.relatedTarget,this.selectDropDownContainer)||this.onListBlur()})),this.selectList.getHTMLElement().setAttribute("aria-label",this.selectBoxOptions.ariaLabel||""),this.selectList.getHTMLElement().setAttribute("aria-expanded","true"),this.styleList()}onPointerUp(e){if(!this.selectList.length)return;st.stop(e);let t=e.target;if(!t||t.classList.contains("slider"))return;let n=t.closest(".monaco-list-row");if(!n)return;let i=Number(n.getAttribute("data-index")),r=n.classList.contains("option-disabled");i>=0&&i<this.options.length&&!r&&(this.selected=i,this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0]),this.selected!==this._currentSelection&&(this._currentSelection=this.selected,this._onDidSelect.fire({index:this.selectElement.selectedIndex,selected:this.options[this.selected].text}),this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)),this.hideSelectDropDown(!0))}onListBlur(){this._sticky||(this.selected!==this._currentSelection&&this.select(this._currentSelection),this.hideSelectDropDown(!1))}renderDescriptionMarkdown(e,t){let n=r=>{for(let s=0;s<r.childNodes.length;s++){let a=r.childNodes.item(s);(a.tagName&&a.tagName.toLowerCase())==="img"?a.remove():n(a)}},i=y1({value:e,supportThemeIcons:!0},{actionHandler:t});return i.element.classList.add("select-box-description-markdown"),n(i.element),i.element}onListFocus(e){!this._isVisible||!this._hasDetails||this.updateDetail(e.indexes[0])}updateDetail(e){this.selectionDetailsPane.innerText="";let t=this.options[e],n=t?.description??"",i=t?.descriptionIsMarkdown??!1;if(n){if(i){let r=t.descriptionMarkdownActionHandler;this.selectionDetailsPane.appendChild(this.renderDescriptionMarkdown(n,r))}else this.selectionDetailsPane.innerText=n;this.selectionDetailsPane.style.display="block"}else this.selectionDetailsPane.style.display="none";this._skipLayout=!0,this.contextViewProvider.layout(),this._skipLayout=!1}onEscape(e){st.stop(e),this.select(this._currentSelection),this.hideSelectDropDown(!0)}onEnter(e){st.stop(e),this.selected!==this._currentSelection&&(this._currentSelection=this.selected,this._onDidSelect.fire({index:this.selectElement.selectedIndex,selected:this.options[this.selected].text}),this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)),this.hideSelectDropDown(!0)}onDownArrow(e){if(this.selected<this.options.length-1){st.stop(e,!0);let t=this.options[this.selected+1].isDisabled;if(t&&this.options.length>this.selected+2)this.selected+=2;else{if(t)return;this.selected++}this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0])}}onUpArrow(e){this.selected>0&&(st.stop(e,!0),this.options[this.selected-1].isDisabled&&this.selected>1?this.selected-=2:this.selected--,this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0]))}onPageUp(e){st.stop(e),this.selectList.focusPreviousPage(),setTimeout(()=>{this.selected=this.selectList.getFocus()[0],this.options[this.selected].isDisabled&&this.selected<this.options.length-1&&(this.selected++,this.selectList.setFocus([this.selected])),this.selectList.reveal(this.selected),this.select(this.selected)},1)}onPageDown(e){st.stop(e),this.selectList.focusNextPage(),setTimeout(()=>{this.selected=this.selectList.getFocus()[0],this.options[this.selected].isDisabled&&this.selected>0&&(this.selected--,this.selectList.setFocus([this.selected])),this.selectList.reveal(this.selected),this.select(this.selected)},1)}onHome(e){st.stop(e),!(this.options.length<2)&&(this.selected=0,this.options[this.selected].isDisabled&&this.selected>1&&this.selected++,this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selected),this.select(this.selected))}onEnd(e){st.stop(e),!(this.options.length<2)&&(this.selected=this.options.length-1,this.options[this.selected].isDisabled&&this.selected>1&&this.selected--,this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selected),this.select(this.selected))}onCharacter(e){let t=lb.toString(e.keyCode),n=-1;for(let i=0;i<this.options.length-1;i++)if(n=(i+this.selected+1)%this.options.length,this.options[n].text.charAt(0).toUpperCase()===t&&!this.options[n].isDisabled){this.select(n),this.selectList.setFocus([n]),this.selectList.reveal(this.selectList.getFocus()[0]),st.stop(e);break}}dispose(){this.hideSelectDropDown(!1),super.dispose()}};var wE=class extends F{selectElement;selectBoxOptions;options;selected=0;_onDidSelect;styles;constructor(e,t,n,i){super(),this.selectBoxOptions=i||Object.create(null),this.options=[],this.selectElement=document.createElement("select"),this.selectElement.className="monaco-select-box",typeof this.selectBoxOptions.ariaLabel=="string"&&this.selectElement.setAttribute("aria-label",this.selectBoxOptions.ariaLabel),typeof this.selectBoxOptions.ariaDescription=="string"&&this.selectElement.setAttribute("aria-description",this.selectBoxOptions.ariaDescription),this._onDidSelect=this._register(new D),this.styles=n,this.registerListeners(),this.setOptions(e,t)}registerListeners(){this._register(An.addTarget(this.selectElement)),[Et.Tap].forEach(e=>{this._register(j(this.selectElement,e,t=>{this.selectElement.focus()}))}),this._register(bn(this.selectElement,"click",e=>{st.stop(e,!0)})),this._register(bn(this.selectElement,"change",e=>{this.selectElement.title=e.target.value,this._onDidSelect.fire({index:e.target.selectedIndex,selected:e.target.value})})),this._register(bn(this.selectElement,"keydown",e=>{let t=!1;Ve?(e.keyCode===18||e.keyCode===16||e.keyCode===10)&&(t=!0):(e.keyCode===18&&e.altKey||e.keyCode===10||e.keyCode===3)&&(t=!0),t&&e.stopPropagation()}))}get onDidSelect(){return this._onDidSelect.event}setOptions(e,t){(!this.options||!zt(this.options,e))&&(this.options=e,this.selectElement.options.length=0,this.options.forEach((n,i)=>{this.selectElement.add(this.createOption(n.text,i,n.isDisabled))})),t!==void 0&&this.select(t)}select(e){this.options.length===0?this.selected=0:e>=0&&e<this.options.length?this.selected=e:e>this.options.length-1?this.select(this.options.length-1):this.selected<0&&(this.selected=0),this.selectElement.selectedIndex=this.selected,this.selected<this.options.length&&typeof this.options[this.selected].text=="string"?this.selectElement.title=this.options[this.selected].text:this.selectElement.title=""}setAriaLabel(e){this.selectBoxOptions.ariaLabel=e,this.selectElement.setAttribute("aria-label",e)}focus(){this.selectElement&&(this.selectElement.tabIndex=0,this.selectElement.focus())}blur(){this.selectElement&&(this.selectElement.tabIndex=-1,this.selectElement.blur())}setEnabled(e){this.selectElement.disabled=!e}setFocusable(e){this.selectElement.tabIndex=e?0:-1}render(e){e.classList.add("select-container"),e.appendChild(this.selectElement),this.setOptions(this.options,this.selected),this.applyStyles()}style(e){this.styles=e,this.applyStyles()}applyStyles(){this.selectElement&&(this.selectElement.style.backgroundColor=this.styles.selectBackground??"",this.selectElement.style.color=this.styles.selectForeground??"",this.selectElement.style.borderColor=this.styles.selectBorder??"")}createOption(e,t,n){let i=document.createElement("option");return i.value=e,i.text=e,i.disabled=!!n,i}};var JBe={...vE,selectBackground:"#3C3C3C",selectForeground:"#F0F0F0",selectBorder:"#3C3C3C",decoratorRightForeground:void 0,selectListBackground:void 0,selectListBorder:void 0,focusBorder:void 0},_E=class extends lo{selectBoxDelegate;constructor(e,t,n,i,r){super(),Ve&&!r?.useCustomDrawn?this.selectBoxDelegate=new wE(e,t,i,r):this.selectBoxDelegate=new xE(e,t,n,i,r),this._register(this.selectBoxDelegate)}get onDidSelect(){return this.selectBoxDelegate.onDidSelect}setOptions(e,t){this.selectBoxDelegate.setOptions(e,t)}select(e){this.selectBoxDelegate.select(e)}setAriaLabel(e){this.selectBoxDelegate.setAriaLabel(e)}focus(){this.selectBoxDelegate.focus()}blur(){this.selectBoxDelegate.blur()}setFocusable(e){this.selectBoxDelegate.setFocusable(e)}setEnabled(e){this.selectBoxDelegate.setEnabled(e)}render(e){this.selectBoxDelegate.render(e)}};var QW={inputActiveOptionBorder:"#007ACC00",inputActiveOptionForeground:"#FFFFFF",inputActiveOptionBackground:"#0E639C50"};var Nl=class extends lo{_onChange=this._register(new D);onChange=this._onChange.event;_onKeyDown=this._register(new D);onKeyDown=this._onKeyDown.event;_opts;_icon;domNode;_checked;_hover;constructor(e){super(),this._opts=e,this._checked=this._opts.isChecked;let t=["monaco-custom-toggle"];this._opts.icon&&(this._icon=this._opts.icon,t.push(...we.asClassNameArray(this._icon))),this._opts.actionClassName&&t.push(...this._opts.actionClassName.split(" ")),this._checked&&t.push("checked"),this.domNode=document.createElement("div"),this._hover=this._register(xo().setupManagedHover(e.hoverDelegate??Fn("mouse"),this.domNode,this._opts.title)),this.domNode.classList.add(...t),this._opts.notFocusable||(this.domNode.tabIndex=0),this.domNode.setAttribute("role","checkbox"),this.domNode.setAttribute("aria-checked",String(this._checked)),this.domNode.setAttribute("aria-label",this._opts.title),this.applyStyles(),this.onclick(this.domNode,n=>{this.enabled&&(this.checked=!this._checked,this._onChange.fire(!1),n.preventDefault())}),this._register(this.ignoreGesture(this.domNode)),this.onkeydown(this.domNode,n=>{if(n.keyCode===10||n.keyCode===3){this.checked=!this._checked,this._onChange.fire(!0),n.preventDefault(),n.stopPropagation();return}this._onKeyDown.fire(n)})}get enabled(){return this.domNode.getAttribute("aria-disabled")!=="true"}focus(){this.domNode.focus()}get checked(){return this._checked}set checked(e){this._checked=e,this.domNode.setAttribute("aria-checked",String(this._checked)),this.domNode.classList.toggle("checked",this._checked),this.applyStyles()}setIcon(e){this._icon&&this.domNode.classList.remove(...we.asClassNameArray(this._icon)),this._icon=e,this._icon&&this.domNode.classList.add(...we.asClassNameArray(this._icon))}width(){return 22}applyStyles(){this.domNode&&(this.domNode.style.borderColor=this._checked&&this._opts.inputActiveOptionBorder||"",this.domNode.style.color=this._checked&&this._opts.inputActiveOptionForeground||"inherit",this.domNode.style.backgroundColor=this._checked&&this._opts.inputActiveOptionBackground||"")}enable(){this.domNode.setAttribute("aria-disabled",String(!1))}disable(){this.domNode.setAttribute("aria-disabled",String(!0))}setTitle(e){this._hover.update(e),this.domNode.setAttribute("aria-label",e)}set visible(e){this.domNode.style.display=e?"":"none"}get visible(){return this.domNode.style.display!=="none"}};var co=class extends F{constructor(t,n,i={}){super();this.options=i;this._context=t||this,this._action=n,n instanceof Ht&&this._register(n.onDidChange(r=>{this.element&&this.handleActionChangeEvent(r)}))}element;_context;_action;customHover;get action(){return this._action}_actionRunner;handleActionChangeEvent(t){t.enabled!==void 0&&this.updateEnabled(),t.checked!==void 0&&this.updateChecked(),t.class!==void 0&&this.updateClass(),t.label!==void 0&&(this.updateLabel(),this.updateTooltip()),t.tooltip!==void 0&&this.updateTooltip()}get actionRunner(){return this._actionRunner||(this._actionRunner=this._register(new ko)),this._actionRunner}set actionRunner(t){this._actionRunner=t}isEnabled(){return this._action.enabled}setActionContext(t){this._context=t}render(t){let n=this.element=t;this._register(An.addTarget(t));let i=this.options&&this.options.draggable;i&&(t.draggable=!0,Gn&&this._register(j(t,me.DRAG_START,r=>r.dataTransfer?.setData(oE.TEXT,this._action.label)))),this._register(j(n,Et.Tap,r=>this.onClick(r,!0))),this._register(j(n,me.MOUSE_DOWN,r=>{i||st.stop(r,!0),this._action.enabled&&r.button===0&&n.classList.add("active")})),Ve&&this._register(j(n,me.CONTEXT_MENU,r=>{r.button===0&&r.ctrlKey===!0&&this.onClick(r)})),this._register(j(n,me.CLICK,r=>{st.stop(r,!0),this.options&&this.options.isMenu||this.onClick(r)})),this._register(j(n,me.DBLCLICK,r=>{st.stop(r,!0)})),[me.MOUSE_UP,me.MOUSE_OUT].forEach(r=>{this._register(j(n,r,s=>{st.stop(s),n.classList.remove("active")}))})}onClick(t,n=!1){st.stop(t,!0);let i=gn(this._context)?this.options?.useEventAsContext?t:{preserveFocus:n}:this._context;this.actionRunner.run(this._action,i)}focus(){this.element&&(this.element.tabIndex=0,this.element.focus(),this.element.classList.add("focused"))}isFocused(){return!!this.element?.classList.contains("focused")}blur(){this.element&&(this.element.blur(),this.element.tabIndex=-1,this.element.classList.remove("focused"))}setFocusable(t){this.element&&(this.element.tabIndex=t?0:-1)}get trapsArrowNavigation(){return!1}updateEnabled(){}updateLabel(){}getClass(){return this.action.class}getTooltip(){return this.action.tooltip}updateTooltip(){if(!this.element)return;let t=this.getTooltip()??"";if(this.updateAriaLabel(),this.options.hoverDelegate?.showNativeHover)this.element.title=t;else if(!this.customHover&&t!==""){let n=this.options.hoverDelegate??Fn("element");this.customHover=this._store.add(xo().setupManagedHover(n,this.element,t))}else this.customHover&&this.customHover.update(t)}updateAriaLabel(){if(this.element){let t=this.getTooltip()??"";this.element.setAttribute("aria-label",t)}}updateClass(){}updateChecked(){}dispose(){this.element&&(this.element.remove(),this.element=void 0),this._context=void 0,super.dispose()}},dc=class extends co{label;options;cssClass;constructor(e,t,n){super(e,t,n),this.options=n,this.options.icon=n.icon!==void 0?n.icon:!1,this.options.label=n.label!==void 0?n.label:!0,this.cssClass=""}render(e){super.render(e),Gp(this.element);let t=document.createElement("a");if(t.classList.add("action-label"),t.setAttribute("role",this.getDefaultAriaRole()),this.label=t,this.element.appendChild(t),this.options.label&&this.options.keybinding){let n=document.createElement("span");n.classList.add("keybinding"),n.textContent=this.options.keybinding,this.element.appendChild(n)}this.updateClass(),this.updateLabel(),this.updateTooltip(),this.updateEnabled(),this.updateChecked()}getDefaultAriaRole(){return this._action.id===Zn.ID?"presentation":this.options.isMenu?"menuitem":this.options.isTabList?"tab":"button"}focus(){this.label&&(this.label.tabIndex=0,this.label.focus())}isFocused(){return!!this.label&&this.label?.tabIndex===0}blur(){this.label&&(this.label.tabIndex=-1)}setFocusable(e){this.label&&(this.label.tabIndex=e?0:-1)}updateLabel(){this.options.label&&this.label&&(this.label.textContent=this.action.label)}getTooltip(){let e=null;return this.action.tooltip?e=this.action.tooltip:!this.options.label&&this.action.label&&this.options.icon&&(e=this.action.label,this.options.keybinding&&(e=m({key:"titleLabel",comment:["action title","action keybinding"]},"{0} ({1})",e,this.options.keybinding))),e??void 0}updateClass(){this.cssClass&&this.label&&this.label.classList.remove(...this.cssClass.split(" ")),this.options.icon?(this.cssClass=this.getClass(),this.label&&(this.label.classList.add("codicon"),this.cssClass&&this.label.classList.add(...this.cssClass.split(" "))),this.updateEnabled()):this.label?.classList.remove("codicon")}updateEnabled(){this.action.enabled?(this.label&&(this.label.removeAttribute("aria-disabled"),this.label.classList.remove("disabled")),this.element?.classList.remove("disabled")):(this.label&&(this.label.setAttribute("aria-disabled","true"),this.label.classList.add("disabled")),this.element?.classList.add("disabled"))}updateAriaLabel(){if(this.label){let e=this.getTooltip()??"";this.label.setAttribute("aria-label",e)}}updateChecked(){this.label&&(this.action.checked!==void 0?(this.label.classList.toggle("checked",this.action.checked),this.options.isTabList?this.label.setAttribute("aria-selected",this.action.checked?"true":"false"):(this.label.setAttribute("aria-checked",this.action.checked?"true":"false"),this.label.setAttribute("role","checkbox"))):(this.label.classList.remove("checked"),this.label.removeAttribute(this.options.isTabList?"aria-selected":"aria-checked"),this.label.setAttribute("role",this.getDefaultAriaRole())))}},DE=class extends co{selectBox;constructor(e,t,n,i,r,s,a){super(e,t),this.selectBox=new _E(n,i,r,s,a),this.selectBox.setFocusable(!1),this._register(this.selectBox),this.registerListeners()}setOptions(e,t){this.selectBox.setOptions(e,t)}select(e){this.selectBox.select(e)}registerListeners(){this._register(this.selectBox.onDidSelect(e=>this.runAction(e.selected,e.index)))}runAction(e,t){this.actionRunner.run(this._action,this.getActionContext(e,t))}getActionContext(e,t){return e}setFocusable(e){this.selectBox.setFocusable(e)}focus(){this.selectBox?.focus()}blur(){this.selectBox?.blur()}render(e){this.selectBox.render(e)}};var fr=class extends F{options;_hoverDelegate;_actionRunner;_actionRunnerDisposables=this._register(new ee);_context;_orientation;_triggerKeys;viewItems;viewItemDisposables=this._register(new Lo);previouslyFocusedItem;focusedItem;focusTracker;triggerKeyDown=!1;focusable=!0;domNode;actionsList;_onDidBlur=this._register(new D);onDidBlur=this._onDidBlur.event;_onDidCancel=this._register(new D({onWillAddFirstListener:()=>this.cancelHasListener=!0}));onDidCancel=this._onDidCancel.event;cancelHasListener=!1;_onDidRun=this._register(new D);onDidRun=this._onDidRun.event;_onWillRun=this._register(new D);onWillRun=this._onWillRun.event;constructor(e,t={}){super(),this.options=t,this._context=t.context??null,this._orientation=this.options.orientation??0,this._triggerKeys={keyDown:this.options.triggerKeys?.keyDown??!1,keys:this.options.triggerKeys?.keys??[3,10]},this._hoverDelegate=t.hoverDelegate??this._register(Ol()),this.options.actionRunner?this._actionRunner=this.options.actionRunner:(this._actionRunner=new ko,this._actionRunnerDisposables.add(this._actionRunner)),this._actionRunnerDisposables.add(this._actionRunner.onDidRun(r=>this._onDidRun.fire(r))),this._actionRunnerDisposables.add(this._actionRunner.onWillRun(r=>this._onWillRun.fire(r))),this.viewItems=[],this.focusedItem=void 0,this.domNode=document.createElement("div"),this.domNode.className="monaco-action-bar";let n,i;switch(this._orientation){case 0:n=[15],i=[17];break;case 1:n=[16],i=[18],this.domNode.className+=" vertical";break}this._register(j(this.domNode,me.KEY_DOWN,r=>{let s=new mt(r),a=!0,l=typeof this.focusedItem=="number"?this.viewItems[this.focusedItem]:void 0;n&&(s.equals(n[0])||s.equals(n[1]))?a=this.focusPrevious():i&&(s.equals(i[0])||s.equals(i[1]))?a=this.focusNext():s.equals(9)&&this.cancelHasListener?this._onDidCancel.fire():s.equals(14)?a=this.focusFirst():s.equals(13)?a=this.focusLast():s.equals(2)&&l instanceof co&&l.trapsArrowNavigation?a=this.focusNext(void 0,!0):this.isTriggerKeyEvent(s)?this._triggerKeys.keyDown?this.doTrigger(s):this.triggerKeyDown=!0:a=!1,a&&(s.preventDefault(),s.stopPropagation())})),this._register(j(this.domNode,me.KEY_UP,r=>{let s=new mt(r);this.isTriggerKeyEvent(s)?(!this._triggerKeys.keyDown&&this.triggerKeyDown&&(this.triggerKeyDown=!1,this.doTrigger(s)),s.preventDefault(),s.stopPropagation()):(s.equals(2)||s.equals(1026)||s.equals(16)||s.equals(18)||s.equals(15)||s.equals(17))&&this.updateFocusedItem()})),this.focusTracker=this._register(_l(this.domNode)),this._register(this.focusTracker.onDidBlur(()=>{(Io()===this.domNode||!is(Io(),this.domNode))&&(this._onDidBlur.fire(),this.previouslyFocusedItem=this.focusedItem,this.focusedItem=void 0,this.triggerKeyDown=!1)})),this._register(this.focusTracker.onDidFocus(()=>this.updateFocusedItem())),this.actionsList=document.createElement("ul"),this.actionsList.className="actions-container",this.options.highlightToggledItems&&this.actionsList.classList.add("highlight-toggled"),this.actionsList.setAttribute("role",this.options.ariaRole||"toolbar"),this.options.ariaLabel&&this.actionsList.setAttribute("aria-label",this.options.ariaLabel),this.domNode.appendChild(this.actionsList),e.appendChild(this.domNode)}refreshRole(){this.length()>=1?this.actionsList.setAttribute("role",this.options.ariaRole||"toolbar"):this.actionsList.setAttribute("role","presentation")}setAriaLabel(e){e?this.actionsList.setAttribute("aria-label",e):this.actionsList.removeAttribute("aria-label")}setFocusable(e){if(this.focusable=e,this.focusable){let t=this.viewItems.find(n=>n instanceof co&&n.isEnabled());t instanceof co&&t.setFocusable(!0)}else this.viewItems.forEach(t=>{t instanceof co&&t.setFocusable(!1)})}isTriggerKeyEvent(e){let t=!1;return this._triggerKeys.keys.forEach(n=>{t=t||e.equals(n)}),t}updateFocusedItem(){for(let e=0;e<this.actionsList.children.length;e++){let t=this.actionsList.children[e];if(is(Io(),t)){this.focusedItem=e,this.viewItems[this.focusedItem]?.showHover?.();break}}}get context(){return this._context}set context(e){this._context=e,this.viewItems.forEach(t=>t.setActionContext(e))}get actionRunner(){return this._actionRunner}set actionRunner(e){this._actionRunner=e,this._actionRunnerDisposables.clear(),this._actionRunnerDisposables.add(this._actionRunner.onDidRun(t=>this._onDidRun.fire(t))),this._actionRunnerDisposables.add(this._actionRunner.onWillRun(t=>this._onWillRun.fire(t))),this.viewItems.forEach(t=>t.actionRunner=e)}getContainer(){return this.domNode}hasAction(e){return this.viewItems.findIndex(t=>t.action.id===e.id)!==-1}getAction(e){if(typeof e=="number")return this.viewItems[e]?.action;if(Nn(e)){for(;e.parentElement!==this.actionsList;){if(!e.parentElement)return;e=e.parentElement}for(let t=0;t<this.actionsList.childNodes.length;t++)if(this.actionsList.childNodes[t]===e)return this.viewItems[t].action}}push(e,t={}){let n=Array.isArray(e)?e:[e],i=Gi(t.index)?t.index:null;n.forEach(r=>{let s=document.createElement("li");s.className="action-item",s.setAttribute("role","presentation");let a,l={hoverDelegate:this._hoverDelegate,...t,isTabList:this.options.ariaRole==="tablist"};this.options.actionViewItemProvider&&(a=this.options.actionViewItemProvider(r,l)),a||(a=new dc(this.context,r,l)),this.options.allowContextMenu||this.viewItemDisposables.set(a,j(s,me.CONTEXT_MENU,d=>{st.stop(d,!0)})),a.actionRunner=this._actionRunner,a.setActionContext(this.context),a.render(s),this.focusable&&a instanceof co&&this.viewItems.length===0&&a.setFocusable(!0),i===null||i<0||i>=this.actionsList.children.length?(this.actionsList.appendChild(s),this.viewItems.push(a)):(this.actionsList.insertBefore(s,this.actionsList.children[i]),this.viewItems.splice(i,0,a),i++)}),typeof this.focusedItem=="number"&&this.focus(this.focusedItem),this.refreshRole()}getWidth(e){if(e>=0&&e<this.actionsList.children.length){let t=this.actionsList.children.item(e);if(t)return t.clientWidth}return 0}getHeight(e){if(e>=0&&e<this.actionsList.children.length){let t=this.actionsList.children.item(e);if(t)return t.clientHeight}return 0}pull(e){e>=0&&e<this.viewItems.length&&(this.actionsList.childNodes[e].remove(),this.viewItemDisposables.deleteAndDispose(this.viewItems[e]),wt(this.viewItems.splice(e,1)),this.refreshRole())}clear(){this.isEmpty()||(this.viewItems=wt(this.viewItems),this.viewItemDisposables.clearAndDisposeAll(),fi(this.actionsList),this.refreshRole())}length(){return this.viewItems.length}isEmpty(){return this.viewItems.length===0}focus(e){let t=!1,n;if(e===void 0?t=!0:typeof e=="number"?n=e:typeof e=="boolean"&&(t=e),t&&typeof this.focusedItem>"u"){let i=this.viewItems.findIndex(r=>r.isEnabled());this.focusedItem=i===-1?void 0:i,this.updateFocus(void 0,void 0,!0)}else n!==void 0&&(this.focusedItem=n),this.updateFocus(void 0,void 0,!0)}focusFirst(){return this.focusedItem=this.length()-1,this.focusNext(!0)}focusLast(){return this.focusedItem=0,this.focusPrevious(!0)}focusNext(e,t){if(typeof this.focusedItem>"u")this.focusedItem=this.viewItems.length-1;else if(this.viewItems.length<=1)return!1;let n=this.focusedItem,i;do{if(!e&&this.options.preventLoopNavigation&&this.focusedItem+1>=this.viewItems.length)return this.focusedItem=n,!1;this.focusedItem=(this.focusedItem+1)%this.viewItems.length,i=this.viewItems[this.focusedItem]}while(this.focusedItem!==n&&(this.options.focusOnlyEnabledItems&&!i.isEnabled()||i.action.id===Zn.ID));return this.updateFocus(void 0,void 0,t),!0}focusPrevious(e){if(typeof this.focusedItem>"u")this.focusedItem=0;else if(this.viewItems.length<=1)return!1;let t=this.focusedItem,n;do{if(this.focusedItem=this.focusedItem-1,this.focusedItem<0){if(!e&&this.options.preventLoopNavigation)return this.focusedItem=t,!1;this.focusedItem=this.viewItems.length-1}n=this.viewItems[this.focusedItem]}while(this.focusedItem!==t&&(this.options.focusOnlyEnabledItems&&!n.isEnabled()||n.action.id===Zn.ID));return this.updateFocus(!0),!0}updateFocus(e,t,n=!1){typeof this.focusedItem>"u"&&this.actionsList.focus({preventScroll:t}),this.previouslyFocusedItem!==void 0&&this.previouslyFocusedItem!==this.focusedItem&&this.viewItems[this.previouslyFocusedItem]?.blur();let i=this.focusedItem!==void 0?this.viewItems[this.focusedItem]:void 0;if(i){let r=!0;$c(i.focus)||(r=!1),this.options.focusOnlyEnabledItems&&$c(i.isEnabled)&&!i.isEnabled()&&(r=!1),i.action.id===Zn.ID&&(r=!1),r?(n||this.previouslyFocusedItem!==this.focusedItem)&&(i.focus(e),this.previouslyFocusedItem=this.focusedItem):(this.actionsList.focus({preventScroll:t}),this.previouslyFocusedItem=void 0),r&&i.showHover?.()}}doTrigger(e){if(typeof this.focusedItem>"u")return;let t=this.viewItems[this.focusedItem];if(t instanceof co){let n=t._context===null||t._context===void 0?e:t._context;this.run(t._action,n)}}async run(e,t){await this._actionRunner.run(e,t)}dispose(){this._context=void 0,this.viewItems=wt(this.viewItems),this.getContainer().remove(),super.dispose()}};var V6=m("caseDescription","Match Case"),W6=m("wordsDescription","Match Whole Word"),H6=m("regexDescription","Use Regular Expression"),LE=class extends Nl{constructor(e){super({icon:te.caseSensitive,title:V6+e.appendTitle,isChecked:e.isChecked,hoverDelegate:e.hoverDelegate??Fn("element"),inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}},RE=class extends Nl{constructor(e){super({icon:te.wholeWord,title:W6+e.appendTitle,isChecked:e.isChecked,hoverDelegate:e.hoverDelegate??Fn("element"),inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}},kE=class extends Nl{constructor(e){super({icon:te.regex,title:H6+e.appendTitle,isChecked:e.isChecked,hoverDelegate:e.hoverDelegate??Fn("element"),inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}};var ME=class{constructor(e,t=0,n=e.length,i=t-1){this.items=e;this.start=t;this.end=n;this.index=i}current(){return this.index===this.start-1||this.index===this.end?null:this.items[this.index]}next(){return this.index=Math.min(this.index+1,this.end),this.current()}previous(){return this.index=Math.max(this.index-1,this.start-1),this.current()}first(){return this.index=this.start,this.current()}last(){return this.index=this.end-1,this.current()}};var PE=class{_history;_limit;_navigator;constructor(e=[],t=10){this._initialize(e),this._limit=t,this._onChange()}getHistory(){return this._elements}add(e){this._history.delete(e),this._history.add(e),this._onChange()}next(){return this._navigator.next()}previous(){return this._currentPosition()!==0?this._navigator.previous():null}current(){return this._navigator.current()}first(){return this._navigator.first()}last(){return this._navigator.last()}isFirst(){return this._currentPosition()===0}isLast(){return this._currentPosition()>=this._elements.length-1}isNowhere(){return this._navigator.current()===null}has(e){return this._history.has(e)}clear(){this._initialize([]),this._onChange()}_onChange(){this._reduceToLimit();let e=this._elements;this._navigator=new ME(e,0,e.length,e.length)}_reduceToLimit(){let e=this._elements;e.length>this._limit&&this._initialize(e.slice(e.length-this._limit))}_currentPosition(){let e=this._navigator.current();return e?this._elements.indexOf(e):-1}_initialize(e){this._history=new Set;for(let t of e)this._history.add(t)}get _elements(){let e=[];return this._history.forEach(t=>e.push(t)),e}};var $b=Ge;var JW={inputBackground:"#3C3C3C",inputForeground:"#CCCCCC",inputValidationInfoBorder:"#55AAFF",inputValidationInfoBackground:"#063B49",inputValidationWarningBorder:"#B89500",inputValidationWarningBackground:"#352A05",inputValidationErrorBorder:"#BE1100",inputValidationErrorBackground:"#5A1D1D",inputBorder:void 0,inputValidationErrorForeground:void 0,inputValidationInfoForeground:void 0,inputValidationWarningForeground:void 0},OE=class extends lo{contextViewProvider;element;input;actionbar;options;message;placeholder;tooltip;ariaLabel;validation;state="idle";mirror;cachedHeight;cachedContentHeight;maxHeight=Number.POSITIVE_INFINITY;scrollableElement;hover;_onDidChange=this._register(new D);onDidChange=this._onDidChange.event;_onDidHeightChange=this._register(new D);onDidHeightChange=this._onDidHeightChange.event;constructor(e,t,n){super(),this.contextViewProvider=t,this.options=n,this.message=null,this.placeholder=this.options.placeholder||"",this.tooltip=this.options.tooltip??(this.placeholder||""),this.ariaLabel=this.options.ariaLabel||"",this.options.validationOptions&&(this.validation=this.options.validationOptions.validation),this.element=dt(e,$b(".monaco-inputbox.idle"));let i=this.options.flexibleHeight?"textarea":"input",r=dt(this.element,$b(".ibwrapper"));if(this.input=dt(r,$b(i+".input.empty")),this.input.setAttribute("autocorrect","off"),this.input.setAttribute("autocapitalize","off"),this.input.setAttribute("spellcheck","false"),this.onfocus(this.input,()=>this.element.classList.add("synthetic-focus")),this.onblur(this.input,()=>this.element.classList.remove("synthetic-focus")),this.options.flexibleHeight){this.maxHeight=typeof this.options.flexibleMaxHeight=="number"?this.options.flexibleMaxHeight:Number.POSITIVE_INFINITY,this.mirror=dt(r,$b("div.mirror")),this.mirror.innerText="\xA0",this.scrollableElement=new dE(this.element,{vertical:1}),this.options.flexibleWidth&&(this.input.setAttribute("wrap","off"),this.mirror.style.whiteSpace="pre",this.mirror.style.wordWrap="initial"),dt(e,this.scrollableElement.getDomNode()),this._register(this.scrollableElement),this._register(this.scrollableElement.onScroll(l=>this.input.scrollTop=l.scrollTop));let s=this._register(new Ae(e.ownerDocument,"selectionchange")),a=q.filter(s.event,()=>e.ownerDocument.getSelection()?.anchorNode===r);this._register(a(this.updateScrollDimensions,this)),this._register(this.onDidHeightChange(this.updateScrollDimensions,this))}else this.input.type=this.options.type||"text",this.input.setAttribute("wrap","off");this.ariaLabel&&this.input.setAttribute("aria-label",this.ariaLabel),this.placeholder&&!this.options.showPlaceholderOnFocus&&this.setPlaceHolder(this.placeholder),this.tooltip&&this.setTooltip(this.tooltip),this.oninput(this.input,()=>this.onValueChange()),this.onblur(this.input,()=>this.onBlur()),this.onfocus(this.input,()=>this.onFocus()),this._register(this.ignoreGesture(this.input)),setTimeout(()=>this.updateMirror(),0),this.options.actions&&(this.actionbar=this._register(new fr(this.element)),this.actionbar.push(this.options.actions,{icon:!0,label:!1})),this.applyStyles()}onBlur(){this._hideMessage(),this.options.showPlaceholderOnFocus&&this.input.setAttribute("placeholder","")}onFocus(){this._showMessage(),this.options.showPlaceholderOnFocus&&this.input.setAttribute("placeholder",this.placeholder||"")}setPlaceHolder(e){this.placeholder=e,this.input.setAttribute("placeholder",e)}setTooltip(e){this.tooltip=e,this.hover?this.hover.update(e):this.hover=this._register(xo().setupManagedHover(Fn("mouse"),this.input,e))}setAriaLabel(e){this.ariaLabel=e,e?this.input.setAttribute("aria-label",this.ariaLabel):this.input.removeAttribute("aria-label")}getAriaLabel(){return this.ariaLabel}get mirrorElement(){return this.mirror}get inputElement(){return this.input}get value(){return this.input.value}set value(e){this.input.value!==e&&(this.input.value=e,this.onValueChange())}get step(){return this.input.step}set step(e){this.input.step=e}get height(){return typeof this.cachedHeight=="number"?this.cachedHeight:vS(this.element)}focus(){this.input.focus()}blur(){this.input.blur()}hasFocus(){return Fr(this.input)}select(e=null){this.input.select(),e&&(this.input.setSelectionRange(e.start,e.end),e.end===this.input.value.length&&(this.input.scrollLeft=this.input.scrollWidth))}isSelectionAtEnd(){return this.input.selectionEnd===this.input.value.length&&this.input.selectionStart===this.input.selectionEnd}getSelection(){let e=this.input.selectionStart;if(e===null)return null;let t=this.input.selectionEnd??e;return{start:e,end:t}}enable(){this.input.removeAttribute("disabled")}disable(){this.blur(),this.input.disabled=!0,this._hideMessage()}setEnabled(e){e?this.enable():this.disable()}get width(){return Oh(this.input)}set width(e){if(this.options.flexibleHeight&&this.options.flexibleWidth){let t=0;if(this.mirror){let n=parseFloat(this.mirror.style.paddingLeft||"")||0,i=parseFloat(this.mirror.style.paddingRight||"")||0;t=n+i}this.input.style.width=e-t+"px"}else this.input.style.width=e+"px";this.mirror&&(this.mirror.style.width=e+"px")}set paddingRight(e){this.input.style.width=`calc(100% - ${e}px)`,this.mirror&&(this.mirror.style.paddingRight=e+"px")}updateScrollDimensions(){if(typeof this.cachedContentHeight!="number"||typeof this.cachedHeight!="number"||!this.scrollableElement)return;let e=this.cachedContentHeight,t=this.cachedHeight,n=this.input.scrollTop;this.scrollableElement.setScrollDimensions({scrollHeight:e,height:t}),this.scrollableElement.setScrollPosition({scrollTop:n})}showMessage(e,t){if(this.state==="open"&&Mn(this.message,e))return;this.message=e,this.element.classList.remove("idle"),this.element.classList.remove("info"),this.element.classList.remove("warning"),this.element.classList.remove("error"),this.element.classList.add(this.classForType(e.type));let n=this.stylesForType(this.message.type);this.element.style.border=`1px solid ${Vr(n.border,"transparent")}`,this.message.content&&(this.hasFocus()||t)&&this._showMessage()}hideMessage(){this.message=null,this.element.classList.remove("info"),this.element.classList.remove("warning"),this.element.classList.remove("error"),this.element.classList.add("idle"),this._hideMessage(),this.applyStyles()}isInputValid(){return!!this.validation&&!this.validation(this.value)}validate(){let e=null;return this.validation&&(e=this.validation(this.value),e?(this.inputElement.setAttribute("aria-invalid","true"),this.showMessage(e)):this.inputElement.hasAttribute("aria-invalid")&&(this.inputElement.removeAttribute("aria-invalid"),this.hideMessage())),e?.type}stylesForType(e){let t=this.options.inputBoxStyles;switch(e){case 1:return{border:t.inputValidationInfoBorder,background:t.inputValidationInfoBackground,foreground:t.inputValidationInfoForeground};case 2:return{border:t.inputValidationWarningBorder,background:t.inputValidationWarningBackground,foreground:t.inputValidationWarningForeground};default:return{border:t.inputValidationErrorBorder,background:t.inputValidationErrorBackground,foreground:t.inputValidationErrorForeground}}}classForType(e){switch(e){case 1:return"info";case 2:return"warning";default:return"error"}}_showMessage(){if(!this.contextViewProvider||!this.message)return;let e,t=()=>e.style.width=Oh(this.element)+"px";this.contextViewProvider.showContextView({getAnchor:()=>this.element,anchorAlignment:1,render:i=>{if(!this.message)return null;e=dt(i,$b(".monaco-inputbox-container")),t();let r={inline:!0,className:"monaco-inputbox-message"},s=this.message.formatContent?HW(this.message.content,r):WW(this.message.content,r);s.classList.add(this.classForType(this.message.type));let a=this.stylesForType(this.message.type);return s.style.backgroundColor=a.background??"",s.style.color=a.foreground??"",s.style.border=a.border?`1px solid ${a.border}`:"",dt(e,s),null},onHide:()=>{this.state="closed"},layout:t});let n;this.message.type===3?n=m("alertErrorMessage","Error: {0}",this.message.content):this.message.type===2?n=m("alertWarningMessage","Warning: {0}",this.message.content):n=m("alertInfoMessage","Info: {0}",this.message.content),rc(n),this.state="open"}_hideMessage(){this.contextViewProvider&&(this.state==="open"&&this.contextViewProvider.hideContextView(),this.state="idle")}onValueChange(){this._onDidChange.fire(this.value),this.validate(),this.updateMirror(),this.input.classList.toggle("empty",!this.value),this.state==="open"&&this.contextViewProvider&&this.contextViewProvider.layout()}updateMirror(){if(!this.mirror)return;let e=this.value,n=e.charCodeAt(e.length-1)===10?" ":"";(e+n).replace(/\u000c/g,"")?this.mirror.textContent=e+n:this.mirror.innerText="\xA0",this.layout()}applyStyles(){let e=this.options.inputBoxStyles,t=e.inputBackground??"",n=e.inputForeground??"",i=e.inputBorder??"";this.element.style.backgroundColor=t,this.element.style.color=n,this.input.style.backgroundColor="inherit",this.input.style.color=n,this.element.style.border=`1px solid ${Vr(i,"transparent")}`}layout(){if(!this.mirror)return;let e=this.cachedContentHeight;this.cachedContentHeight=vS(this.mirror),e!==this.cachedContentHeight&&(this.cachedHeight=Math.min(this.cachedContentHeight,this.maxHeight),this.input.style.height=this.cachedHeight+"px",this._onDidHeightChange.fire(this.cachedContentHeight))}insertAtCursor(e){let t=this.inputElement,n=t.selectionStart,i=t.selectionEnd,r=t.value;n!==null&&i!==null&&(this.value=r.substr(0,n)+e+r.substr(i),t.setSelectionRange(n+1,n+1),this.layout())}dispose(){this._hideMessage(),this.message=null,this.actionbar?.dispose(),super.dispose()}},NE=class extends OE{history;observer;_onDidFocus=this._register(new D);onDidFocus=this._onDidFocus.event;_onDidBlur=this._register(new D);onDidBlur=this._onDidBlur.event;constructor(e,t,n){let i=m({key:"history.inputbox.hint.suffix.noparens",comment:['Text is the suffix of an input field placeholder coming after the action the input field performs, this will be used when the input field ends in a closing parenthesis ")", for example "Filter (e.g. text, !exclude)". The character inserted into the final string is \u21C5 to represent the up and down arrow keys.']}," or {0} for history","\u21C5"),r=m({key:"history.inputbox.hint.suffix.inparens",comment:['Text is the suffix of an input field placeholder coming after the action the input field performs, this will be used when the input field does NOT end in a closing parenthesis (eg. "Find"). The character inserted into the final string is \u21C5 to represent the up and down arrow keys.']}," ({0} for history)","\u21C5");super(e,t,n),this.history=new PE(n.history,100);let s=()=>{if(n.showHistoryHint&&n.showHistoryHint()&&!this.placeholder.endsWith(i)&&!this.placeholder.endsWith(r)&&this.history.getHistory().length){let a=this.placeholder.endsWith(")")?i:r,l=this.placeholder+a;n.showPlaceholderOnFocus&&!Fr(this.input)?this.placeholder=l:this.setPlaceHolder(l)}};this.observer=new MutationObserver((a,l)=>{a.forEach(d=>{d.target.textContent||s()})}),this.observer.observe(this.input,{attributeFilter:["class"]}),this.onfocus(this.input,()=>s()),this.onblur(this.input,()=>{let a=l=>{if(this.placeholder.endsWith(l)){let d=this.placeholder.slice(0,this.placeholder.length-l.length);return n.showPlaceholderOnFocus?this.placeholder=d:this.setPlaceHolder(d),!0}else return!1};a(r)||a(i)})}dispose(){super.dispose(),this.observer&&(this.observer.disconnect(),this.observer=void 0)}addToHistory(e){this.value&&(e||this.value!==this.getCurrentValue())&&this.history.add(this.value)}prependHistory(e){let t=this.getHistory();this.clearHistory(),e.forEach(n=>{this.history.add(n)}),t.forEach(n=>{this.history.add(n)})}getHistory(){return this.history.getHistory()}isAtFirstInHistory(){return this.history.isFirst()}isAtLastInHistory(){return this.history.isLast()}isNowhereInHistory(){return this.history.isNowhere()}showNextValue(){this.history.has(this.value)||this.addToHistory();let e=this.getNextValue();e&&(e=e===this.value?this.getNextValue():e),this.value=e??"",Ub(this.value?this.value:m("clearedInput","Cleared Input"))}showPreviousValue(){this.history.has(this.value)||this.addToHistory();let e=this.getPreviousValue();e&&(e=e===this.value?this.getPreviousValue():e),e&&(this.value=e,Ub(this.value))}clearHistory(){this.history.clear()}setPlaceHolder(e){super.setPlaceHolder(e),this.setTooltip(e)}onBlur(){super.onBlur(),this._onDidBlur.fire()}onFocus(){super.onFocus(),this._onDidFocus.fire()}getCurrentValue(){let e=this.history.current();return e||(e=this.history.last(),this.history.next()),e}getPreviousValue(){return this.history.previous()||this.history.first()}getNextValue(){return this.history.next()}};var z6=m("defaultLabel","input"),AE=class extends lo{static OPTION_CHANGE="optionChange";placeholder;validation;label;showCommonFindToggles;fixFocusOnOptionClickEnabled=!0;imeSessionInProgress=!1;additionalTogglesDisposables=this._register(new un);controls;regex;wholeWords;caseSensitive;additionalToggles=[];domNode;inputBox;_onDidOptionChange=this._register(new D);onDidOptionChange=this._onDidOptionChange.event;_onKeyDown=this._register(new D);onKeyDown=this._onKeyDown.event;_onMouseDown=this._register(new D);onMouseDown=this._onMouseDown.event;_onInput=this._register(new D);onInput=this._onInput.event;_onKeyUp=this._register(new D);onKeyUp=this._onKeyUp.event;_onCaseSensitiveKeyDown=this._register(new D);onCaseSensitiveKeyDown=this._onCaseSensitiveKeyDown.event;_onRegexKeyDown=this._register(new D);onRegexKeyDown=this._onRegexKeyDown.event;constructor(e,t,n){super(),this.placeholder=n.placeholder||"",this.validation=n.validation,this.label=n.label||z6,this.showCommonFindToggles=!!n.showCommonFindToggles;let i=n.appendCaseSensitiveLabel||"",r=n.appendWholeWordsLabel||"",s=n.appendRegexLabel||"",a=n.history||[],l=!!n.flexibleHeight,d=!!n.flexibleWidth,c=n.flexibleMaxHeight;this.domNode=document.createElement("div"),this.domNode.classList.add("monaco-findInput"),this.inputBox=this._register(new NE(this.domNode,t,{placeholder:this.placeholder||"",ariaLabel:this.label||"",validationOptions:{validation:this.validation},history:a,showHistoryHint:n.showHistoryHint,flexibleHeight:l,flexibleWidth:d,flexibleMaxHeight:c,inputBoxStyles:n.inputBoxStyles}));let u=this._register(Ol());if(this.showCommonFindToggles){this.regex=this._register(new kE({appendTitle:s,isChecked:!1,hoverDelegate:u,...n.toggleStyles})),this._register(this.regex.onChange(h=>{this._onDidOptionChange.fire(h),!h&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this._register(this.regex.onKeyDown(h=>{this._onRegexKeyDown.fire(h)})),this.wholeWords=this._register(new RE({appendTitle:r,isChecked:!1,hoverDelegate:u,...n.toggleStyles})),this._register(this.wholeWords.onChange(h=>{this._onDidOptionChange.fire(h),!h&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this.caseSensitive=this._register(new LE({appendTitle:i,isChecked:!1,hoverDelegate:u,...n.toggleStyles})),this._register(this.caseSensitive.onChange(h=>{this._onDidOptionChange.fire(h),!h&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this._register(this.caseSensitive.onKeyDown(h=>{this._onCaseSensitiveKeyDown.fire(h)}));let p=[this.caseSensitive.domNode,this.wholeWords.domNode,this.regex.domNode];this.onkeydown(this.domNode,h=>{if(h.equals(15)||h.equals(17)||h.equals(9)){let f=p.indexOf(this.domNode.ownerDocument.activeElement);if(f>=0){let g=-1;h.equals(17)?g=(f+1)%p.length:h.equals(15)&&(f===0?g=p.length-1:g=f-1),h.equals(9)?(p[f].blur(),this.inputBox.focus()):g>=0&&p[g].focus(),st.stop(h,!0)}}})}this.controls=document.createElement("div"),this.controls.className="controls",this.controls.style.display=this.showCommonFindToggles?"":"none",this.caseSensitive&&this.controls.append(this.caseSensitive.domNode),this.wholeWords&&this.controls.appendChild(this.wholeWords.domNode),this.regex&&this.controls.appendChild(this.regex.domNode),this.setAdditionalToggles(n?.additionalToggles),this.controls&&this.domNode.appendChild(this.controls),e?.appendChild(this.domNode),this._register(j(this.inputBox.inputElement,"compositionstart",p=>{this.imeSessionInProgress=!0})),this._register(j(this.inputBox.inputElement,"compositionend",p=>{this.imeSessionInProgress=!1,this._onInput.fire()})),this.onkeydown(this.inputBox.inputElement,p=>this._onKeyDown.fire(p)),this.onkeyup(this.inputBox.inputElement,p=>this._onKeyUp.fire(p)),this.oninput(this.inputBox.inputElement,p=>this._onInput.fire()),this.onmousedown(this.inputBox.inputElement,p=>this._onMouseDown.fire(p))}get isImeSessionInProgress(){return this.imeSessionInProgress}get onDidChange(){return this.inputBox.onDidChange}layout(e){this.inputBox.layout(),this.updateInputBoxPadding(e.collapsedFindWidget)}enable(){this.domNode.classList.remove("disabled"),this.inputBox.enable(),this.regex?.enable(),this.wholeWords?.enable(),this.caseSensitive?.enable();for(let e of this.additionalToggles)e.enable()}disable(){this.domNode.classList.add("disabled"),this.inputBox.disable(),this.regex?.disable(),this.wholeWords?.disable(),this.caseSensitive?.disable();for(let e of this.additionalToggles)e.disable()}setFocusInputOnOptionClick(e){this.fixFocusOnOptionClickEnabled=e}setEnabled(e){e?this.enable():this.disable()}setAdditionalToggles(e){for(let t of this.additionalToggles)t.domNode.remove();this.additionalToggles=[],this.additionalTogglesDisposables.value=new ee;for(let t of e??[])this.additionalTogglesDisposables.value.add(t),this.controls.appendChild(t.domNode),this.additionalTogglesDisposables.value.add(t.onChange(n=>{this._onDidOptionChange.fire(n),!n&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus()})),this.additionalToggles.push(t);this.additionalToggles.length>0&&(this.controls.style.display=""),this.updateInputBoxPadding()}updateInputBoxPadding(e=!1){e?this.inputBox.paddingRight=0:this.inputBox.paddingRight=(this.caseSensitive?.width()??0)+(this.wholeWords?.width()??0)+(this.regex?.width()??0)+this.additionalToggles.reduce((t,n)=>t+n.width(),0)}clear(){this.clearValidation(),this.setValue(""),this.focus()}getValue(){return this.inputBox.value}setValue(e){this.inputBox.value!==e&&(this.inputBox.value=e)}onSearchSubmit(){this.inputBox.addToHistory()}select(){this.inputBox.select()}focus(){this.inputBox.focus()}getCaseSensitive(){return this.caseSensitive?.checked??!1}setCaseSensitive(e){this.caseSensitive&&(this.caseSensitive.checked=e)}getWholeWords(){return this.wholeWords?.checked??!1}setWholeWords(e){this.wholeWords&&(this.wholeWords.checked=e)}getRegex(){return this.regex?.checked??!1}setRegex(e){this.regex&&(this.regex.checked=e,this.validate())}focusOnCaseSensitive(){this.caseSensitive?.focus()}focusOnRegex(){this.regex?.focus()}_lastHighlightFindOptions=0;highlightFindOptions(){this.domNode.classList.remove("highlight-"+this._lastHighlightFindOptions),this._lastHighlightFindOptions=1-this._lastHighlightFindOptions,this.domNode.classList.add("highlight-"+this._lastHighlightFindOptions)}validate(){this.inputBox.validate()}showMessage(e){this.inputBox.showMessage(e)}clearMessage(){this.inputBox.hideMessage()}clearValidation(){this.inputBox.hideMessage()}};var dn=class extends Error{constructor(e,t){super(`TreeError [${e}] ${t}`)}},Hu=class{constructor(e){this.fn=e}_map=new WeakMap;map(e){let t=this._map.get(e);return t||(t=this.fn(e),this._map.set(e,t)),t}};function Yb(o){return typeof o=="object"&&"visibility"in o&&"data"in o}function Uu(o){switch(o){case!0:return 1;case!1:return 0;default:return o}}function C1(o){return typeof o.collapsible=="boolean"}var FE=class{constructor(e,t,n={}){this.user=e;this.collapseByDefault=typeof n.collapseByDefault>"u"?!1:n.collapseByDefault,this.allowNonCollapsibleParents=n.allowNonCollapsibleParents??!1,this.filter=n.filter,this.autoExpandSingleChildren=typeof n.autoExpandSingleChildren>"u"?!1:n.autoExpandSingleChildren,this.root={parent:void 0,element:t,children:[],depth:0,visibleChildrenCount:0,visibleChildIndex:-1,collapsible:!1,collapsed:!1,renderNodeCount:0,visibility:1,visible:!0,filterData:void 0}}rootRef=[];root;eventBufferer=new md;_onDidSpliceModel=new D;onDidSpliceModel=this._onDidSpliceModel.event;_onDidSpliceRenderedNodes=new D;onDidSpliceRenderedNodes=this._onDidSpliceRenderedNodes.event;_onDidChangeCollapseState=new D;onDidChangeCollapseState=this.eventBufferer.wrapEvent(this._onDidChangeCollapseState.event);_onDidChangeRenderNodeCount=new D;onDidChangeRenderNodeCount=this.eventBufferer.wrapEvent(this._onDidChangeRenderNodeCount.event);collapseByDefault;allowNonCollapsibleParents;filter;autoExpandSingleChildren;refilterDelayer=new Ss(Xy);splice(e,t,n=Je.empty(),i={}){if(e.length===0)throw new dn(this.user,"Invalid tree location");i.diffIdentityProvider?this.spliceSmart(i.diffIdentityProvider,e,t,n,i):this.spliceSimple(e,t,n,i)}spliceSmart(e,t,n,i=Je.empty(),r,s=r.diffDepth??0){let{parentNode:a}=this.getParentNodeWithListIndex(t);if(!a.lastDiffIds)return this.spliceSimple(t,n,i,r);let l=[...i],d=t[t.length-1],c=new Db({getElements:()=>a.lastDiffIds},{getElements:()=>[...a.children.slice(0,d),...l,...a.children.slice(d+n)].map(g=>e.getId(g.element).toString())}).ComputeDiff(!1);if(c.quitEarly)return a.lastDiffIds=void 0,this.spliceSimple(t,n,l,r);let u=t.slice(0,-1),p=(g,b,v)=>{if(s>0)for(let y=0;y<v;y++)g--,b--,this.spliceSmart(e,[...u,g,0],Number.MAX_SAFE_INTEGER,l[b].children,r,s-1)},h=Math.min(a.children.length,d+n),f=l.length;for(let g of c.changes.sort((b,v)=>v.originalStart-b.originalStart))p(h,f,h-(g.originalStart+g.originalLength)),h=g.originalStart,f=g.modifiedStart-d,this.spliceSimple([...u,h],g.originalLength,Je.slice(l,f,f+g.modifiedLength),r);p(h,f,h)}spliceSimple(e,t,n=Je.empty(),{onDidCreateNode:i,onDidDeleteNode:r,diffIdentityProvider:s}){let{parentNode:a,listIndex:l,revealed:d,visible:c}=this.getParentNodeWithListIndex(e),u=[],p=Je.map(n,C=>this.createTreeNode(C,a,a.visible?1:0,d,u,i)),h=e[e.length-1],f=0;for(let C=h;C>=0&&C<a.children.length;C--){let w=a.children[C];if(w.visible){f=w.visibleChildIndex;break}}let g=[],b=0,v=0;for(let C of p)g.push(C),v+=C.renderNodeCount,C.visible&&(C.visibleChildIndex=f+b++);let y=_D(a.children,h,t,g);s?a.lastDiffIds?_D(a.lastDiffIds,h,t,g.map(C=>s.getId(C.element).toString())):a.lastDiffIds=a.children.map(C=>s.getId(C.element).toString()):a.lastDiffIds=void 0;let S=0;for(let C of y)C.visible&&S++;if(S!==0)for(let C=h+g.length;C<a.children.length;C++){let w=a.children[C];w.visible&&(w.visibleChildIndex-=S)}if(a.visibleChildrenCount+=b-S,d&&c){let C=y.reduce((w,_)=>w+(_.visible?_.renderNodeCount:0),0);this._updateAncestorsRenderNodeCount(a,v-C),this._onDidSpliceRenderedNodes.fire({start:l,deleteCount:C,elements:u})}if(y.length>0&&r){let C=w=>{r(w),w.children.forEach(C)};y.forEach(C)}this._onDidSpliceModel.fire({insertedNodes:g,deletedNodes:y});let E=a;for(;E;){if(E.visibility===2){this.refilterDelayer.trigger(()=>this.refilter());break}E=E.parent}}rerender(e){if(e.length===0)throw new dn(this.user,"Invalid tree location");let{node:t,listIndex:n,revealed:i}=this.getTreeNodeWithListIndex(e);t.visible&&i&&this._onDidSpliceRenderedNodes.fire({start:n,deleteCount:1,elements:[t]})}has(e){return this.hasTreeNode(e)}getListIndex(e){let{listIndex:t,visible:n,revealed:i}=this.getTreeNodeWithListIndex(e);return n&&i?t:-1}getListRenderCount(e){return this.getTreeNode(e).renderNodeCount}isCollapsible(e){return this.getTreeNode(e).collapsible}setCollapsible(e,t){let n=this.getTreeNode(e);typeof t>"u"&&(t=!n.collapsible);let i={collapsible:t};return this.eventBufferer.bufferEvents(()=>this._setCollapseState(e,i))}isCollapsed(e){return this.getTreeNode(e).collapsed}setCollapsed(e,t,n){let i=this.getTreeNode(e);typeof t>"u"&&(t=!i.collapsed);let r={collapsed:t,recursive:n||!1};return this.eventBufferer.bufferEvents(()=>this._setCollapseState(e,r))}_setCollapseState(e,t){let{node:n,listIndex:i,revealed:r}=this.getTreeNodeWithListIndex(e),s=this._setListNodeCollapseState(n,i,r,t);if(n!==this.root&&this.autoExpandSingleChildren&&s&&!C1(t)&&n.collapsible&&!n.collapsed&&!t.recursive){let a=-1;for(let l=0;l<n.children.length;l++)if(n.children[l].visible)if(a>-1){a=-1;break}else a=l;a>-1&&this._setCollapseState([...e,a],t)}return s}_setListNodeCollapseState(e,t,n,i){let r=this._setNodeCollapseState(e,i,!1);if(!n||!e.visible||!r)return r;let s=e.renderNodeCount,a=this.updateNodeAfterCollapseChange(e),l=s-(t===-1?0:1);return this._onDidSpliceRenderedNodes.fire({start:t+1,deleteCount:l,elements:a.slice(1)}),r}_setNodeCollapseState(e,t,n){let i;if(e===this.root?i=!1:(C1(t)?(i=e.collapsible!==t.collapsible,e.collapsible=t.collapsible):e.collapsible?(i=e.collapsed!==t.collapsed,e.collapsed=t.collapsed):i=!1,i&&this._onDidChangeCollapseState.fire({node:e,deep:n})),!C1(t)&&t.recursive)for(let r of e.children)i=this._setNodeCollapseState(r,t,!0)||i;return i}expandTo(e){this.eventBufferer.bufferEvents(()=>{let t=this.getTreeNode(e);for(;t.parent;)t=t.parent,e=e.slice(0,e.length-1),t.collapsed&&this._setCollapseState(e,{collapsed:!1,recursive:!1})})}refilter(){let e=this.root.renderNodeCount,t=this.updateNodeAfterFilterChange(this.root);this._onDidSpliceRenderedNodes.fire({start:0,deleteCount:e,elements:t}),this.refilterDelayer.cancel()}createTreeNode(e,t,n,i,r,s){let a={parent:t,element:e.element,children:[],depth:t.depth+1,visibleChildrenCount:0,visibleChildIndex:-1,collapsible:typeof e.collapsible=="boolean"?e.collapsible:typeof e.collapsed<"u",collapsed:typeof e.collapsed>"u"?this.collapseByDefault:e.collapsed,renderNodeCount:1,visibility:1,visible:!0,filterData:void 0},l=this._filterNode(a,n);a.visibility=l,i&&r.push(a);let d=e.children||Je.empty(),c=i&&l!==0&&!a.collapsed,u=0,p=1;for(let h of d){let f=this.createTreeNode(h,a,l,c,r,s);a.children.push(f),p+=f.renderNodeCount,f.visible&&(f.visibleChildIndex=u++)}return this.allowNonCollapsibleParents||(a.collapsible=a.collapsible||a.children.length>0),a.visibleChildrenCount=u,a.visible=l===2?u>0:l===1,a.visible?a.collapsed||(a.renderNodeCount=p):(a.renderNodeCount=0,i&&r.pop()),s?.(a),a}updateNodeAfterCollapseChange(e){let t=e.renderNodeCount,n=[];return this._updateNodeAfterCollapseChange(e,n),this._updateAncestorsRenderNodeCount(e.parent,n.length-t),n}_updateNodeAfterCollapseChange(e,t){if(e.visible===!1)return 0;if(t.push(e),e.renderNodeCount=1,!e.collapsed)for(let n of e.children)e.renderNodeCount+=this._updateNodeAfterCollapseChange(n,t);return this._onDidChangeRenderNodeCount.fire(e),e.renderNodeCount}updateNodeAfterFilterChange(e){let t=e.renderNodeCount,n=[];return this._updateNodeAfterFilterChange(e,e.visible?1:0,n),this._updateAncestorsRenderNodeCount(e.parent,n.length-t),n}_updateNodeAfterFilterChange(e,t,n,i=!0){let r;if(e!==this.root){if(r=this._filterNode(e,t),r===0)return e.visible=!1,e.renderNodeCount=0,!1;i&&n.push(e)}let s=n.length;e.renderNodeCount=e===this.root?0:1;let a=!1;if(!e.collapsed||r!==0){let l=0;for(let d of e.children)a=this._updateNodeAfterFilterChange(d,r,n,i&&!e.collapsed)||a,d.visible&&(d.visibleChildIndex=l++);e.visibleChildrenCount=l}else e.visibleChildrenCount=0;return e!==this.root&&(e.visible=r===2?a:r===1,e.visibility=r),e.visible?e.collapsed||(e.renderNodeCount+=n.length-s):(e.renderNodeCount=0,i&&n.pop()),this._onDidChangeRenderNodeCount.fire(e),e.visible}_updateAncestorsRenderNodeCount(e,t){if(t!==0)for(;e;)e.renderNodeCount+=t,this._onDidChangeRenderNodeCount.fire(e),e=e.parent}_filterNode(e,t){let n=this.filter?this.filter.filter(e.element,t):1;return typeof n=="boolean"?(e.filterData=void 0,n?1:0):Yb(n)?(e.filterData=n.data,Uu(n.visibility)):(e.filterData=void 0,Uu(n))}hasTreeNode(e,t=this.root){if(!e||e.length===0)return!0;let[n,...i]=e;return n<0||n>t.children.length?!1:this.hasTreeNode(i,t.children[n])}getTreeNode(e,t=this.root){if(!e||e.length===0)return t;let[n,...i]=e;if(n<0||n>t.children.length)throw new dn(this.user,"Invalid tree location");return this.getTreeNode(i,t.children[n])}getTreeNodeWithListIndex(e){if(e.length===0)return{node:this.root,listIndex:-1,revealed:!0,visible:!1};let{parentNode:t,listIndex:n,revealed:i,visible:r}=this.getParentNodeWithListIndex(e),s=e[e.length-1];if(s<0||s>t.children.length)throw new dn(this.user,"Invalid tree location");let a=t.children[s];return{node:a,listIndex:n,revealed:i,visible:r&&a.visible}}getParentNodeWithListIndex(e,t=this.root,n=0,i=!0,r=!0){let[s,...a]=e;if(s<0||s>t.children.length)throw new dn(this.user,"Invalid tree location");for(let l=0;l<s;l++)n+=t.children[l].renderNodeCount;return i=i&&!t.collapsed,r=r&&t.visible,a.length===0?{parentNode:t,listIndex:n,revealed:i,visible:r}:this.getParentNodeWithListIndex(a,t.children[s],n+1,i,r)}getNode(e=[]){return this.getTreeNode(e)}getNodeLocation(e){let t=[],n=e;for(;n.parent;)t.push(n.parent.children.indexOf(n)),n=n.parent;return t.reverse()}getParentNodeLocation(e){if(e.length!==0)return e.length===1?[]:Ty(e)[0]}getFirstElementChild(e){let t=this.getTreeNode(e);if(t.children.length!==0)return t.children[0].element}getLastElementAncestor(e=[]){let t=this.getTreeNode(e);if(t.children.length!==0)return this._getLastElementAncestor(t)}_getLastElementAncestor(e){return e.children.length===0?e.element:this._getLastElementAncestor(e.children[e.children.length-1])}};var E1=class extends Pl{constructor(t){super(t.elements.map(n=>n.element));this.data=t}set context(t){this.data.context=t}get context(){return this.data.context}};function S1(o){return o instanceof Pl?new E1(o):o}var T1=class{constructor(e,t){this.modelProvider=e;this.dnd=t}autoExpandNode;autoExpandDisposable=F.None;disposables=new ee;getDragURI(e){return this.dnd.getDragURI(e.element)}getDragLabel(e,t){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(e.map(n=>n.element),t)}onDragStart(e,t){this.dnd.onDragStart?.(S1(e),t)}onDragOver(e,t,n,i,r,s=!0){let a=this.dnd.onDragOver(S1(e),t&&t.element,n,i,r),l=this.autoExpandNode!==t;if(l&&(this.autoExpandDisposable.dispose(),this.autoExpandNode=t),typeof t>"u")return a;if(l&&typeof a!="boolean"&&a.autoExpand&&(this.autoExpandDisposable=wf(()=>{let h=this.modelProvider(),f=h.getNodeLocation(t);h.isCollapsed(f)&&h.setCollapsed(f,!1),this.autoExpandNode=void 0},500,this.disposables)),typeof a=="boolean"||!a.accept||typeof a.bubble>"u"||a.feedback){if(!s){let h=typeof a=="boolean"?a:a.accept,f=typeof a=="boolean"?void 0:a.effect;return{accept:h,effect:f,feedback:[n]}}return a}if(a.bubble===1){let h=this.modelProvider(),f=h.getNodeLocation(t),g=h.getParentNodeLocation(f),b=h.getNode(g),v=g&&h.getListIndex(g);return this.onDragOver(e,b,v,i,r,!1)}let d=this.modelProvider(),c=d.getNodeLocation(t),u=d.getListIndex(c),p=d.getListRenderCount(c);return{...a,feedback:Yn(u,u+p)}}drop(e,t,n,i,r){this.autoExpandDisposable.dispose(),this.autoExpandNode=void 0,this.dnd.drop(S1(e),t&&t.element,n,i,r)}onDragEnd(e){this.dnd.onDragEnd?.(e)}dispose(){this.disposables.dispose(),this.dnd.dispose()}};function K6(o,e){return e&&{...e,identityProvider:e.identityProvider&&{getId(t){return e.identityProvider.getId(t.element)}},dnd:e.dnd&&new T1(o,e.dnd),multipleSelectionController:e.multipleSelectionController&&{isSelectionSingleChangeEvent(t){return e.multipleSelectionController.isSelectionSingleChangeEvent({...t,element:t.element})},isSelectionRangeChangeEvent(t){return e.multipleSelectionController.isSelectionRangeChangeEvent({...t,element:t.element})}},accessibilityProvider:e.accessibilityProvider&&{...e.accessibilityProvider,getSetSize(t){let n=o(),i=n.getNodeLocation(t),r=n.getParentNodeLocation(i);return n.getNode(r).visibleChildrenCount},getPosInSet(t){return t.visibleChildIndex+1},isChecked:e.accessibilityProvider&&e.accessibilityProvider.isChecked?t=>e.accessibilityProvider.isChecked(t.element):void 0,getRole:e.accessibilityProvider&&e.accessibilityProvider.getRole?t=>e.accessibilityProvider.getRole(t.element):()=>"treeitem",getAriaLabel(t){return e.accessibilityProvider.getAriaLabel(t.element)},getWidgetAriaLabel(){return e.accessibilityProvider.getWidgetAriaLabel()},getWidgetRole:e.accessibilityProvider&&e.accessibilityProvider.getWidgetRole?()=>e.accessibilityProvider.getWidgetRole():()=>"tree",getAriaLevel:e.accessibilityProvider&&e.accessibilityProvider.getAriaLevel?t=>e.accessibilityProvider.getAriaLevel(t.element):t=>t.depth,getActiveDescendantId:e.accessibilityProvider.getActiveDescendantId&&(t=>e.accessibilityProvider.getActiveDescendantId(t.element))},keyboardNavigationLabelProvider:e.keyboardNavigationLabelProvider&&{...e.keyboardNavigationLabelProvider,getKeyboardNavigationLabel(t){return e.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(t.element)}}}}var mm=class{constructor(e){this.delegate=e}getHeight(e){return this.delegate.getHeight(e.element)}getTemplateId(e){return this.delegate.getTemplateId(e.element)}hasDynamicHeight(e){return!!this.delegate.hasDynamicHeight&&this.delegate.hasDynamicHeight(e.element)}setDynamicHeight(e,t){this.delegate.setDynamicHeight?.(e.element,t)}},x1=class o{focus;selection;expanded;scrollTop;static lift(e){return e instanceof o?e:new o(e)}static empty(e=0){return new o({focus:[],selection:[],expanded:Object.create(null),scrollTop:e})}constructor(e){if(this.focus=new Set(e.focus),this.selection=new Set(e.selection),e.expanded instanceof Array){this.expanded=Object.create(null);for(let t of e.expanded)this.expanded[t]=1}else this.expanded=e.expanded;this.expanded=e.expanded,this.scrollTop=e.scrollTop}toJSON(){return{focus:Array.from(this.focus),selection:Array.from(this.selection),expanded:this.expanded,scrollTop:this.scrollTop}}};var w1=class{constructor(e,t=[]){this._elements=t;this.onDidChange=q.forEach(e,n=>this._elements=n,this.disposables)}disposables=new ee;onDidChange;get elements(){return this._elements}dispose(){this.disposables.dispose()}},_1=class o{constructor(e,t,n,i,r,s={}){this.renderer=e;this.model=t;this.activeNodes=i;this.renderedIndentGuides=r;this.templateId=e.templateId,this.updateOptions(s),q.map(n,a=>a.node)(this.onDidChangeNodeTwistieState,this,this.disposables),e.onDidChangeTwistieState?.(this.onDidChangeTwistieState,this,this.disposables)}static DefaultIndent=8;templateId;renderedElements=new Map;renderedNodes=new Map;indent=o.DefaultIndent;hideTwistiesOfChildlessElements=!1;shouldRenderIndentGuides=!1;activeIndentNodes=new Set;indentGuidesDisposable=F.None;disposables=new ee;updateOptions(e={}){if(typeof e.indent<"u"){let t=Ri(e.indent,0,40);if(t!==this.indent){this.indent=t;for(let[n,i]of this.renderedNodes)this.renderTreeElement(n,i)}}if(typeof e.renderIndentGuides<"u"){let t=e.renderIndentGuides!=="none";if(t!==this.shouldRenderIndentGuides){this.shouldRenderIndentGuides=t;for(let[n,i]of this.renderedNodes)this._renderIndentGuides(n,i);if(this.indentGuidesDisposable.dispose(),t){let n=new ee;this.activeNodes.onDidChange(this._onDidChangeActiveNodes,this,n),this.indentGuidesDisposable=n,this._onDidChangeActiveNodes(this.activeNodes.elements)}}}typeof e.hideTwistiesOfChildlessElements<"u"&&(this.hideTwistiesOfChildlessElements=e.hideTwistiesOfChildlessElements)}renderTemplate(e){let t=dt(e,Ge(".monaco-tl-row")),n=dt(t,Ge(".monaco-tl-indent")),i=dt(t,Ge(".monaco-tl-twistie")),r=dt(t,Ge(".monaco-tl-contents")),s=this.renderer.renderTemplate(r);return{container:e,indent:n,twistie:i,indentGuidesDisposable:F.None,templateData:s}}renderElement(e,t,n,i){this.renderedNodes.set(e,n),this.renderedElements.set(e.element,e),this.renderTreeElement(e,n),this.renderer.renderElement(e,t,n.templateData,i)}disposeElement(e,t,n,i){n.indentGuidesDisposable.dispose(),this.renderer.disposeElement?.(e,t,n.templateData,i),typeof i=="number"&&(this.renderedNodes.delete(e),this.renderedElements.delete(e.element))}disposeTemplate(e){this.renderer.disposeTemplate(e.templateData)}onDidChangeTwistieState(e){let t=this.renderedElements.get(e);t&&this.onDidChangeNodeTwistieState(t)}onDidChangeNodeTwistieState(e){let t=this.renderedNodes.get(e);t&&(this._onDidChangeActiveNodes(this.activeNodes.elements),this.renderTreeElement(e,t))}renderTreeElement(e,t){let n=o.DefaultIndent+(e.depth-1)*this.indent;t.twistie.style.paddingLeft=`${n}px`,t.indent.style.width=`${n+this.indent-16}px`,e.collapsible?t.container.setAttribute("aria-expanded",String(!e.collapsed)):t.container.removeAttribute("aria-expanded"),t.twistie.classList.remove(...we.asClassNameArray(te.treeItemExpanded));let i=!1;this.renderer.renderTwistie&&(i=this.renderer.renderTwistie(e.element,t.twistie)),e.collapsible&&(!this.hideTwistiesOfChildlessElements||e.visibleChildrenCount>0)?(i||t.twistie.classList.add(...we.asClassNameArray(te.treeItemExpanded)),t.twistie.classList.add("collapsible"),t.twistie.classList.toggle("collapsed",e.collapsed)):t.twistie.classList.remove("collapsible","collapsed"),this._renderIndentGuides(e,t)}_renderIndentGuides(e,t){if(fi(t.indent),t.indentGuidesDisposable.dispose(),!this.shouldRenderIndentGuides)return;let n=new ee;for(;;){let i=this.model.getNodeLocation(e),r=this.model.getParentNodeLocation(i);if(!r)break;let s=this.model.getNode(r),a=Ge(".indent-guide",{style:`width: ${this.indent}px`});this.activeIndentNodes.has(s)&&a.classList.add("active"),t.indent.childElementCount===0?t.indent.appendChild(a):t.indent.insertBefore(a,t.indent.firstElementChild),this.renderedIndentGuides.add(s,a),n.add(le(()=>this.renderedIndentGuides.delete(s,a))),e=s}t.indentGuidesDisposable=n}_onDidChangeActiveNodes(e){if(!this.shouldRenderIndentGuides)return;let t=new Set;e.forEach(n=>{let i=this.model.getNodeLocation(n);try{let r=this.model.getParentNodeLocation(i);n.collapsible&&n.children.length>0&&!n.collapsed?t.add(n):r&&t.add(this.model.getNode(r))}catch{}}),this.activeIndentNodes.forEach(n=>{t.has(n)||this.renderedIndentGuides.forEach(n,i=>i.classList.remove("active"))}),t.forEach(n=>{this.activeIndentNodes.has(n)||this.renderedIndentGuides.forEach(n,i=>i.classList.add("active"))}),this.activeIndentNodes=t}setModel(e){this.model=e}dispose(){this.renderedNodes.clear(),this.renderedElements.clear(),this.indentGuidesDisposable.dispose(),wt(this.disposables)}},D1=class{constructor(e,t,n){this.tree=e;this.keyboardNavigationLabelProvider=t;this._filter=n;e.onWillRefilter(this.reset,this,this.disposables)}_totalCount=0;get totalCount(){return this._totalCount}_matchCount=0;get matchCount(){return this._matchCount}_pattern="";_lowercasePattern="";disposables=new ee;set pattern(e){this._pattern=e,this._lowercasePattern=e.toLowerCase()}filter(e,t){let n=1;if(this._filter){let s=this._filter.filter(e,t);if(typeof s=="boolean"?n=s?1:0:Yb(s)?n=Uu(s.visibility):n=s,n===0)return!1}if(this._totalCount++,!this._pattern)return this._matchCount++,{data:eu.Default,visibility:n};let i=this.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(e),r=Array.isArray(i)?i:[i];for(let s of r){let a=s&&s.toString();if(typeof a>"u")return{data:eu.Default,visibility:n};let l;if(this.tree.findMatchType===1){let d=a.toLowerCase().indexOf(this._lowercasePattern);if(d>-1){l=[Number.MAX_SAFE_INTEGER,0];for(let c=this._lowercasePattern.length;c>0;c--)l.push(d+c-1)}}else l=RI(this._pattern,this._lowercasePattern,0,a,a.toLowerCase(),0,{firstMatchCanBeWeak:!0,boostFullMatch:!0});if(l)return this._matchCount++,r.length===1?{data:l,visibility:n}:{data:{label:a,score:l},visibility:n}}return this.tree.findMode===1?typeof this.tree.options.defaultFindVisibility=="number"?this.tree.options.defaultFindVisibility:this.tree.options.defaultFindVisibility?this.tree.options.defaultFindVisibility(e):2:{data:eu.Default,visibility:n}}reset(){this._totalCount=0,this._matchCount=0}dispose(){wt(this.disposables)}},L1=class extends Nl{constructor(e){super({icon:te.listFilter,title:m("filter","Filter"),isChecked:e.isChecked??!1,hoverDelegate:e.hoverDelegate??Fn("element"),inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}},R1=class extends Nl{constructor(e){super({icon:te.searchFuzzy,title:m("fuzzySearch","Fuzzy Match"),isChecked:e.isChecked??!1,hoverDelegate:e.hoverDelegate??Fn("element"),inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}},G6={inputBoxStyles:JW,toggleStyles:QW,listFilterWidgetBackground:void 0,listFilterWidgetNoMatchesOutline:void 0,listFilterWidgetOutline:void 0,listFilterWidgetShadow:void 0};var k1=class extends F{constructor(t,n,i,r,s,a){super();this.tree=n;t.appendChild(this.elements.root),this._register(le(()=>this.elements.root.remove()));let l=a?.styles??G6;l.listFilterWidgetBackground&&(this.elements.root.style.backgroundColor=l.listFilterWidgetBackground),l.listFilterWidgetShadow&&(this.elements.root.style.boxShadow=`0 0 8px 2px ${l.listFilterWidgetShadow}`);let d=this._register(Ol());this.modeToggle=this._register(new L1({...l.toggleStyles,isChecked:r===1,hoverDelegate:d})),this.matchTypeToggle=this._register(new R1({...l.toggleStyles,isChecked:s===0,hoverDelegate:d})),this.onDidChangeMode=q.map(this.modeToggle.onChange,()=>this.modeToggle.checked?1:0,this._store),this.onDidChangeMatchType=q.map(this.matchTypeToggle.onChange,()=>this.matchTypeToggle.checked?0:1,this._store),this.findInput=this._register(new AE(this.elements.findInput,i,{label:m("type to search","Type to search"),additionalToggles:[this.modeToggle,this.matchTypeToggle],showCommonFindToggles:!1,inputBoxStyles:l.inputBoxStyles,toggleStyles:l.toggleStyles,history:a?.history})),this.actionbar=this._register(new fr(this.elements.actionbar)),this.mode=r;let c=this._register(new Ae(this.findInput.inputBox.inputElement,"keydown")),u=q.chain(c.event,g=>g.map(b=>new mt(b)));this._register(u(g=>{if(g.equals(3)){g.preventDefault(),g.stopPropagation(),this.findInput.inputBox.addToHistory(),this.tree.domFocus();return}if(g.equals(18)){g.preventDefault(),g.stopPropagation(),this.findInput.inputBox.isAtLastInHistory()||this.findInput.inputBox.isNowhereInHistory()?(this.findInput.inputBox.addToHistory(),this.tree.domFocus()):this.findInput.inputBox.showNextValue();return}if(g.equals(16)){g.preventDefault(),g.stopPropagation(),this.findInput.inputBox.showPreviousValue();return}}));let p=this._register(new Ht("close",m("close","Close"),"codicon codicon-close",!0,()=>this.dispose()));this.actionbar.push(p,{icon:!0,label:!1});let h=this._register(new Ae(this.elements.grab,"mousedown"));this._register(h.event(g=>{let b=new ee,v=b.add(new Ae(Ce(g),"mousemove")),y=b.add(new Ae(Ce(g),"mouseup")),S=this.right,E=g.pageX,C=this.top,w=g.pageY;this.elements.grab.classList.add("grabbing");let _=this.elements.root.style.transition;this.elements.root.style.transition="unset";let L=k=>{let W=k.pageX-E;this.right=S-W;let K=k.pageY-w;this.top=C+K,this.layout()};b.add(v.event(L)),b.add(y.event(k=>{L(k),this.elements.grab.classList.remove("grabbing"),this.elements.root.style.transition=_,b.dispose()}))}));let f=q.chain(this._register(new Ae(this.elements.grab,"keydown")).event,g=>g.map(b=>new mt(b)));this._register(f(g=>{let b,v;if(g.keyCode===15?b=Number.POSITIVE_INFINITY:g.keyCode===17?b=0:g.keyCode===10&&(b=this.right===0?Number.POSITIVE_INFINITY:0),g.keyCode===16?v=0:g.keyCode===18&&(v=Number.POSITIVE_INFINITY),b!==void 0&&(g.preventDefault(),g.stopPropagation(),this.right=b,this.layout()),v!==void 0){g.preventDefault(),g.stopPropagation(),this.top=v;let y=this.elements.root.style.transition;this.elements.root.style.transition="unset",this.layout(),setTimeout(()=>{this.elements.root.style.transition=y},0)}})),this.onDidChangeValue=this.findInput.onDidChange}elements=yt(".monaco-tree-type-filter",[yt(".monaco-tree-type-filter-grab.codicon.codicon-debug-gripper@grab",{tabIndex:0}),yt(".monaco-tree-type-filter-input@findInput"),yt(".monaco-tree-type-filter-actionbar@actionbar")]);set mode(t){this.modeToggle.checked=t===1,this.findInput.inputBox.setPlaceHolder(t===1?m("type to filter","Type to filter"):m("type to search","Type to search"))}set matchType(t){this.matchTypeToggle.checked=t===0}get value(){return this.findInput.inputBox.value}set value(t){this.findInput.inputBox.value=t}modeToggle;matchTypeToggle;findInput;actionbar;width=0;right=0;top=0;_onDidDisable=new D;onDidDisable=this._onDidDisable.event;onDidChangeValue;onDidChangeMode;onDidChangeMatchType;getHistory(){return this.findInput.inputBox.getHistory()}focus(){this.findInput.focus()}select(){this.findInput.select(),this.findInput.inputBox.addToHistory(!0)}layout(t=this.width){this.width=t,this.right=Ri(this.right,0,Math.max(0,t-212)),this.elements.root.style.right=`${this.right}px`,this.top=Ri(this.top,0,24),this.elements.root.style.top=`${this.top}px`}showMessage(t){this.findInput.showMessage(t)}clearMessage(){this.findInput.clearMessage()}async dispose(){this._onDidDisable.fire(),this.elements.root.classList.add("disabled"),await wi(300),super.dispose()}},M1=class{constructor(e,t,n,i,r={}){this.tree=e;this.view=t;this.filter=n;this.contextViewProvider=i;this.options=r;this._mode=e.options.defaultFindMode??0,this._matchType=e.options.defaultFindMatchType??0}_history;_pattern="";get pattern(){return this._pattern}previousPattern="";_mode;get mode(){return this._mode}set mode(e){e!==this._mode&&(this._mode=e,this.widget&&(this.widget.mode=this._mode),this.tree.refilter(),this.render(),this._onDidChangeMode.fire(e))}_matchType;get matchType(){return this._matchType}set matchType(e){e!==this._matchType&&(this._matchType=e,this.widget&&(this.widget.matchType=this._matchType),this.tree.refilter(),this.render(),this._onDidChangeMatchType.fire(e))}widget;width=0;_onDidChangeMode=new D;onDidChangeMode=this._onDidChangeMode.event;_onDidChangeMatchType=new D;onDidChangeMatchType=this._onDidChangeMatchType.event;_onDidChangePattern=new D;onDidChangePattern=this._onDidChangePattern.event;_onDidChangeOpenState=new D;onDidChangeOpenState=this._onDidChangeOpenState.event;enabledDisposables=new ee;disposables=new ee;updateOptions(e={}){e.defaultFindMode!==void 0&&(this.mode=e.defaultFindMode),e.defaultFindMatchType!==void 0&&(this.matchType=e.defaultFindMatchType)}isOpened(){return!!this.widget}open(){if(this.widget){this.widget.focus(),this.widget.select();return}this.widget=new k1(this.view.getHTMLElement(),this.tree,this.contextViewProvider,this.mode,this.matchType,{...this.options,history:this._history}),this.enabledDisposables.add(this.widget),this.widget.onDidChangeValue(this.onDidChangeValue,this,this.enabledDisposables),this.widget.onDidChangeMode(e=>this.mode=e,void 0,this.enabledDisposables),this.widget.onDidChangeMatchType(e=>this.matchType=e,void 0,this.enabledDisposables),this.widget.onDidDisable(this.close,this,this.enabledDisposables),this.widget.layout(this.width),this.widget.focus(),this.widget.value=this.previousPattern,this.widget.select(),this._onDidChangeOpenState.fire(!0)}close(){this.widget&&(this._history=this.widget.getHistory(),this.widget=void 0,this.enabledDisposables.clear(),this.previousPattern=this.pattern,this.onDidChangeValue(""),this.tree.domFocus(),this._onDidChangeOpenState.fire(!1))}onDidChangeValue(e){this._pattern=e,this._onDidChangePattern.fire(e),this.filter.pattern=e,this.tree.refilter(),e&&this.tree.focusNext(0,!0,void 0,n=>!eu.isDefault(n.filterData));let t=this.tree.getFocus();if(t.length>0){let n=t[0];this.tree.getRelativeTop(n)===null&&this.tree.reveal(n,.5)}this.render()}render(){let e=this.filter.totalCount>0&&this.filter.matchCount===0;this.pattern&&e?(rc(m("replFindNoResults","No results")),this.tree.options.showNotFoundMessage??!0?this.widget?.showMessage({type:2,content:m("not found","No elements found.")}):this.widget?.showMessage({type:2})):(this.widget?.clearMessage(),this.pattern&&rc(m("replFindResults","{0} results",this.filter.matchCount)))}shouldAllowFocus(e){return!this.widget||!this.pattern||this.filter.totalCount>0&&this.filter.matchCount<=1?!0:!eu.isDefault(e.filterData)}layout(e){this.width=e,this.widget?.layout(e)}dispose(){this._history=void 0,this._onDidChangePattern.dispose(),this.enabledDisposables.dispose(),this.disposables.dispose()}};function j6(o,e){return o.position===e.position&&tH(o,e)}function tH(o,e){return o.node.element===e.node.element&&o.startIndex===e.startIndex&&o.height===e.height&&o.endIndex===e.endIndex}var P1=class{constructor(e=[]){this.stickyNodes=e}get count(){return this.stickyNodes.length}equal(e){return zt(this.stickyNodes,e.stickyNodes,j6)}lastNodePartiallyVisible(){if(this.count===0)return!1;let e=this.stickyNodes[this.count-1];if(this.count===1)return e.position!==0;let t=this.stickyNodes[this.count-2];return t.position+t.height!==e.position}animationStateChanged(e){if(!zt(this.stickyNodes,e.stickyNodes,tH)||this.count===0)return!1;let t=this.stickyNodes[this.count-1],n=e.stickyNodes[e.count-1];return t.position!==n.position}},O1=class{constrainStickyScrollNodes(e,t,n){for(let i=0;i<e.length;i++){let r=e[i];if(r.position+r.height>n||i>=t)return e.slice(0,i)}return e}},VE=class extends F{constructor(t,n,i,r,s,a={}){super();this.tree=t;this.model=n;this.view=i;this.treeDelegate=s;let l=this.validateStickySettings(a);this.stickyScrollMaxItemCount=l.stickyScrollMaxItemCount,this.stickyScrollDelegate=a.stickyScrollDelegate??new O1,this._widget=this._register(new N1(i.getScrollableElement(),i,t,r,s,a.accessibilityProvider)),this.onDidChangeHasFocus=this._widget.onDidChangeHasFocus,this.onContextMenu=this._widget.onContextMenu,this._register(i.onDidScroll(()=>this.update())),this._register(i.onDidChangeContentHeight(()=>this.update())),this._register(t.onDidChangeCollapseState(()=>this.update())),this.update()}onDidChangeHasFocus;onContextMenu;stickyScrollDelegate;stickyScrollMaxItemCount;maxWidgetViewRatio=.4;_widget;get height(){return this._widget.height}get count(){return this._widget.count}getNode(t){return this._widget.getNode(t)}getNodeAtHeight(t){let n;if(t===0?n=this.view.firstVisibleIndex:n=this.view.indexAt(t+this.view.scrollTop),!(n<0||n>=this.view.length))return this.view.element(n)}update(){let t=this.getNodeAtHeight(0);if(!t||this.tree.scrollTop===0){this._widget.setState(void 0);return}let n=this.findStickyState(t);this._widget.setState(n)}findStickyState(t){let n=[],i=t,r=0,s=this.getNextStickyNode(i,void 0,r);for(;s&&(n.push(s),r+=s.height,!(n.length<=this.stickyScrollMaxItemCount&&(i=this.getNextVisibleNode(s),!i)));)s=this.getNextStickyNode(i,s.node,r);let a=this.constrainStickyNodes(n);return a.length?new P1(a):void 0}getNextVisibleNode(t){return this.getNodeAtHeight(t.position+t.height)}getNextStickyNode(t,n,i){let r=this.getAncestorUnderPrevious(t,n);if(r&&!(r===t&&(!this.nodeIsUncollapsedParent(t)||this.nodeTopAlignsWithStickyNodesBottom(t,i))))return this.createStickyScrollNode(r,i)}nodeTopAlignsWithStickyNodesBottom(t,n){let i=this.getNodeIndex(t),r=this.view.getElementTop(i),s=n;return this.view.scrollTop===r-s}createStickyScrollNode(t,n){let i=this.treeDelegate.getHeight(t),{startIndex:r,endIndex:s}=this.getNodeRange(t),a=this.calculateStickyNodePosition(s,n,i);return{node:t,position:a,height:i,startIndex:r,endIndex:s}}getAncestorUnderPrevious(t,n=void 0){let i=t,r=this.getParentNode(i);for(;r;){if(r===n)return i;i=r,r=this.getParentNode(i)}if(n===void 0)return i}calculateStickyNodePosition(t,n,i){let r=this.view.getRelativeTop(t);if(r===null&&this.view.firstVisibleIndex===t&&t+1<this.view.length){let c=this.treeDelegate.getHeight(this.view.element(t)),u=this.view.getRelativeTop(t+1);r=u?u-c/this.view.renderHeight:null}if(r===null)return n;let s=this.view.element(t),a=this.treeDelegate.getHeight(s),d=r*this.view.renderHeight+a;return n+i>d&&n<=d?d-i:n}constrainStickyNodes(t){if(t.length===0)return[];let n=this.view.renderHeight*this.maxWidgetViewRatio,i=t[t.length-1];if(t.length<=this.stickyScrollMaxItemCount&&i.position+i.height<=n)return t;let r=this.stickyScrollDelegate.constrainStickyScrollNodes(t,this.stickyScrollMaxItemCount,n);if(!r.length)return[];let s=r[r.length-1];if(r.length>this.stickyScrollMaxItemCount||s.position+s.height>n)throw new Error("stickyScrollDelegate violates constraints");return r}getParentNode(t){let n=this.model.getNodeLocation(t),i=this.model.getParentNodeLocation(n);return i?this.model.getNode(i):void 0}nodeIsUncollapsedParent(t){let n=this.model.getNodeLocation(t);return this.model.getListRenderCount(n)>1}getNodeIndex(t){let n=this.model.getNodeLocation(t);return this.model.getListIndex(n)}getNodeRange(t){let n=this.model.getNodeLocation(t),i=this.model.getListIndex(n);if(i<0)throw new Error("Node not found in tree");let r=this.model.getListRenderCount(n),s=i+r-1;return{startIndex:i,endIndex:s}}nodePositionTopBelowWidget(t){let n=[],i=this.getParentNode(t);for(;i;)n.push(i),i=this.getParentNode(i);let r=0;for(let s=0;s<n.length&&s<this.stickyScrollMaxItemCount;s++)r+=this.treeDelegate.getHeight(n[s]);return r}getFocus(){return this._widget.getFocus()}domFocus(){this._widget.domFocus()}focusedLast(){return this._widget.focusedLast()}updateOptions(t={}){if(!t.stickyScrollMaxItemCount)return;let n=this.validateStickySettings(t);this.stickyScrollMaxItemCount!==n.stickyScrollMaxItemCount&&(this.stickyScrollMaxItemCount=n.stickyScrollMaxItemCount,this.update())}validateStickySettings(t){let n=7;return typeof t.stickyScrollMaxItemCount=="number"&&(n=Math.max(t.stickyScrollMaxItemCount,1)),{stickyScrollMaxItemCount:n}}setModel(t){this.model=t}},N1=class{constructor(e,t,n,i,r,s){this.view=t;this.tree=n;this.treeRenderers=i;this.treeDelegate=r;this.accessibilityProvider=s;this._rootDomNode=Ge(".monaco-tree-sticky-container.empty"),e.appendChild(this._rootDomNode);let a=Ge(".monaco-tree-sticky-container-shadow");this._rootDomNode.appendChild(a),this.stickyScrollFocus=new A1(this._rootDomNode,t),this.onDidChangeHasFocus=this.stickyScrollFocus.onDidChangeHasFocus,this.onContextMenu=this.stickyScrollFocus.onContextMenu}_rootDomNode;_previousState;_previousElements=[];_previousStateDisposables=new ee;stickyScrollFocus;onDidChangeHasFocus;onContextMenu;get height(){if(!this._previousState)return 0;let e=this._previousState.stickyNodes[this._previousState.count-1];return e.position+e.height}get count(){return this._previousState?.count??0}getNode(e){return this._previousState?.stickyNodes.find(t=>t.node===e)}setState(e){let t=!!this._previousState&&this._previousState.count>0,n=!!e&&e.count>0;if(!t&&!n||t&&n&&this._previousState.equal(e))return;if(t!==n&&this.setVisible(n),!n){this._previousState=void 0,this._previousElements=[],this._previousStateDisposables.clear();return}let i=e.stickyNodes[e.count-1];if(this._previousState&&e.animationStateChanged(this._previousState))this._previousElements[this._previousState.count-1].style.top=`${i.position}px`;else{this._previousStateDisposables.clear();let r=Array(e.count);for(let s=e.count-1;s>=0;s--){let a=e.stickyNodes[s],{element:l,disposable:d}=this.createElement(a,s,e.count);r[s]=l,this._rootDomNode.appendChild(l),this._previousStateDisposables.add(d)}this.stickyScrollFocus.updateElements(r,e),this._previousElements=r}this._previousState=e,this._rootDomNode.style.height=`${i.position+i.height}px`}createElement(e,t,n){let i=e.startIndex,r=document.createElement("div");r.style.top=`${e.position}px`,this.tree.options.setRowHeight!==!1&&(r.style.height=`${e.height}px`),this.tree.options.setRowLineHeight!==!1&&(r.style.lineHeight=`${e.height}px`),r.classList.add("monaco-tree-sticky-row"),r.classList.add("monaco-list-row"),r.setAttribute("data-index",`${i}`),r.setAttribute("data-parity",i%2===0?"even":"odd"),r.setAttribute("id",this.view.getElementID(i));let s=this.setAccessibilityAttributes(r,e.node.element,t,n),a=this.treeDelegate.getTemplateId(e.node),l=this.treeRenderers.find(p=>p.templateId===a);if(!l)throw new Error(`No renderer found for template id ${a}`);let d=e.node;d===this.tree.getNode(this.tree.getNodeLocation(e.node))&&(d=new Proxy(e.node,{}));let c=l.renderTemplate(r);l.renderElement(d,e.startIndex,c,e.height);let u=le(()=>{s.dispose(),l.disposeElement(d,e.startIndex,c,e.height),l.disposeTemplate(c),r.remove()});return{element:r,disposable:u}}setAccessibilityAttributes(e,t,n,i){if(!this.accessibilityProvider)return F.None;this.accessibilityProvider.getSetSize&&e.setAttribute("aria-setsize",String(this.accessibilityProvider.getSetSize(t,n,i))),this.accessibilityProvider.getPosInSet&&e.setAttribute("aria-posinset",String(this.accessibilityProvider.getPosInSet(t,n))),this.accessibilityProvider.getRole&&e.setAttribute("role",this.accessibilityProvider.getRole(t)??"treeitem");let r=this.accessibilityProvider.getAriaLabel(t),s=r&&typeof r!="string"?r:ud(r),a=rt(d=>{let c=d.readObservable(s);c?e.setAttribute("aria-label",c):e.removeAttribute("aria-label")});typeof r=="string"||r&&e.setAttribute("aria-label",r.get());let l=this.accessibilityProvider.getAriaLevel&&this.accessibilityProvider.getAriaLevel(t);return typeof l=="number"&&e.setAttribute("aria-level",`${l}`),e.setAttribute("aria-selected",String(!1)),a}setVisible(e){this._rootDomNode.classList.toggle("empty",!e),e||this.stickyScrollFocus.updateElements([],void 0)}getFocus(){return this.stickyScrollFocus.getFocus()}domFocus(){this.stickyScrollFocus.domFocus()}focusedLast(){return this.stickyScrollFocus.focusedLast()}dispose(){this.stickyScrollFocus.dispose(),this._previousStateDisposables.dispose(),this._rootDomNode.remove()}},A1=class extends F{constructor(t,n){super();this.container=t;this.view=n;this._register(j(this.container,"focus",()=>this.onFocus())),this._register(j(this.container,"blur",()=>this.onBlur())),this._register(this.view.onDidFocus(()=>this.toggleStickyScrollFocused(!1))),this._register(this.view.onKeyDown(i=>this.onKeyDown(i))),this._register(this.view.onMouseDown(i=>this.onMouseDown(i))),this._register(this.view.onContextMenu(i=>this.handleContextMenu(i)))}focusedIndex=-1;elements=[];state;_onDidChangeHasFocus=new D;onDidChangeHasFocus=this._onDidChangeHasFocus.event;_onContextMenu=new D;onContextMenu=this._onContextMenu.event;_domHasFocus=!1;get domHasFocus(){return this._domHasFocus}set domHasFocus(t){t!==this._domHasFocus&&(this._onDidChangeHasFocus.fire(t),this._domHasFocus=t)}handleContextMenu(t){let n=t.browserEvent.target;if(!um(n)&&!cm(n)){this.focusedLast()&&this.view.domFocus();return}if(!os(t.browserEvent)){if(!this.state)throw new Error("Context menu should not be triggered when state is undefined");let a=this.state.stickyNodes.findIndex(l=>l.node.element===t.element?.element);if(a===-1)throw new Error("Context menu should not be triggered when element is not in sticky scroll widget");this.container.focus(),this.setFocus(a);return}if(!this.state||this.focusedIndex<0)throw new Error("Context menu key should not be triggered when focus is not in sticky scroll widget");let r=this.state.stickyNodes[this.focusedIndex].node.element,s=this.elements[this.focusedIndex];this._onContextMenu.fire({element:r,anchor:s,browserEvent:t.browserEvent,isStickyScroll:!0})}onKeyDown(t){if(this.domHasFocus&&this.state){if(t.key==="ArrowUp")this.setFocusedElement(Math.max(0,this.focusedIndex-1)),t.preventDefault(),t.stopPropagation();else if(t.key==="ArrowDown"||t.key==="ArrowRight"){if(this.focusedIndex>=this.state.count-1){let n=this.state.stickyNodes[this.state.count-1].startIndex+1;this.view.domFocus(),this.view.setFocus([n]),this.scrollNodeUnderWidget(n,this.state)}else this.setFocusedElement(this.focusedIndex+1);t.preventDefault(),t.stopPropagation()}}}onMouseDown(t){let n=t.browserEvent.target;!um(n)&&!cm(n)||(t.browserEvent.preventDefault(),t.browserEvent.stopPropagation())}updateElements(t,n){if(n&&n.count===0)throw new Error("Sticky scroll state must be undefined when there are no sticky nodes");if(n&&n.count!==t.length)throw new Error("Sticky scroll focus received illigel state");let i=this.focusedIndex;if(this.removeFocus(),this.elements=t,this.state=n,n){let r=Ri(i,0,n.count-1);this.setFocus(r)}else this.domHasFocus&&this.view.domFocus();this.container.tabIndex=n?0:-1}setFocusedElement(t){let n=this.state;if(!n)throw new Error("Cannot set focus when state is undefined");if(this.setFocus(t),!(t<n.count-1)&&n.lastNodePartiallyVisible()){let i=n.stickyNodes[t];this.scrollNodeUnderWidget(i.endIndex+1,n)}}scrollNodeUnderWidget(t,n){let i=n.stickyNodes[n.count-1],r=n.count>1?n.stickyNodes[n.count-2]:void 0,s=this.view.getElementTop(t),a=r?r.position+r.height+i.height:i.height;this.view.scrollTop=s-a}getFocus(){if(!(!this.state||this.focusedIndex===-1))return this.state.stickyNodes[this.focusedIndex].node.element}domFocus(){if(!this.state)throw new Error("Cannot focus when state is undefined");this.container.focus()}focusedLast(){return this.state?this.view.getHTMLElement().classList.contains("sticky-scroll-focused"):!1}removeFocus(){this.focusedIndex!==-1&&(this.toggleElementFocus(this.elements[this.focusedIndex],!1),this.focusedIndex=-1)}setFocus(t){if(0>t)throw new Error("addFocus() can not remove focus");if(!this.state&&t>=0)throw new Error("Cannot set focus index when state is undefined");if(this.state&&t>=this.state.count)throw new Error("Cannot set focus index to an index that does not exist");let n=this.focusedIndex;n>=0&&this.toggleElementFocus(this.elements[n],!1),t>=0&&this.toggleElementFocus(this.elements[t],!0),this.focusedIndex=t}toggleElementFocus(t,n){this.toggleElementActiveFocus(t,n&&this.domHasFocus),this.toggleElementPassiveFocus(t,n)}toggleCurrentElementActiveFocus(t){this.focusedIndex!==-1&&this.toggleElementActiveFocus(this.elements[this.focusedIndex],t)}toggleElementActiveFocus(t,n){t.classList.toggle("focused",n)}toggleElementPassiveFocus(t,n){t.classList.toggle("passive-focused",n)}toggleStickyScrollFocused(t){this.view.getHTMLElement().classList.toggle("sticky-scroll-focused",t)}onFocus(){if(!this.state||this.elements.length===0)throw new Error("Cannot focus when state is undefined or elements are empty");this.domHasFocus=!0,this.toggleStickyScrollFocused(!0),this.toggleCurrentElementActiveFocus(!0),this.focusedIndex===-1&&this.setFocus(0)}onBlur(){this.domHasFocus=!1,this.toggleCurrentElementActiveFocus(!1)}dispose(){this.toggleStickyScrollFocused(!1),this._onDidChangeHasFocus.fire(!1),super.dispose()}};function hm(o){let e=0;return yS(o.browserEvent.target,"monaco-tl-twistie","monaco-tl-row")?e=1:yS(o.browserEvent.target,"monaco-tl-contents","monaco-tl-row")?e=2:yS(o.browserEvent.target,"monaco-tree-type-filter","monaco-list")&&(e=3),{browserEvent:o.browserEvent,element:o.element?o.element.element:null,target:e}}function q6(o){let e=um(o.browserEvent.target);return{element:o.element?o.element.element:null,browserEvent:o.browserEvent,anchor:o.anchor,isStickyScroll:e}}function BE(o,e){e(o),o.children.forEach(t=>BE(t,e))}var Zb=class{constructor(e,t){this.getFirstViewElementWithTrait=e;this.identityProvider=t}nodes=[];elements;_onDidChange=new D;onDidChange=this._onDidChange.event;_nodeSet;get nodeSet(){return this._nodeSet||(this._nodeSet=this.createNodeSet()),this._nodeSet}set(e,t){!t?.__forceEvent&&zt(this.nodes,e)||this._set(e,!1,t)}_set(e,t,n){if(this.nodes=[...e],this.elements=void 0,this._nodeSet=void 0,!t){let i=this;this._onDidChange.fire({get elements(){return i.get()},browserEvent:n})}}get(){return this.elements||(this.elements=this.nodes.map(e=>e.element)),[...this.elements]}getNodes(){return this.nodes}has(e){return this.nodeSet.has(e)}onDidModelSplice({insertedNodes:e,deletedNodes:t}){if(!this.identityProvider){let l=this.createNodeSet(),d=c=>l.delete(c);t.forEach(c=>BE(c,d)),this.set([...l.values()]);return}let n=new Set,i=l=>n.add(this.identityProvider.getId(l.element).toString());t.forEach(l=>BE(l,i));let r=new Map,s=l=>r.set(this.identityProvider.getId(l.element).toString(),l);e.forEach(l=>BE(l,s));let a=[];for(let l of this.nodes){let d=this.identityProvider.getId(l.element).toString();if(!n.has(d))a.push(l);else{let u=r.get(d);u&&u.visible&&a.push(u)}}if(this.nodes.length>0&&a.length===0){let l=this.getFirstViewElementWithTrait();l&&a.push(l)}this._set(a,!0)}createNodeSet(){let e=new Set;for(let t of this.nodes)e.add(t);return e}},F1=class extends Kb{constructor(t,n,i){super(t);this.tree=n;this.stickyScrollProvider=i}onViewPointer(t){if(i1(t.browserEvent.target)||rs(t.browserEvent.target)||lm(t.browserEvent.target)||t.browserEvent.isHandledByList)return;let n=t.element;if(!n)return super.onViewPointer(t);if(this.isSelectionRangeChangeEvent(t)||this.isSelectionSingleChangeEvent(t))return super.onViewPointer(t);let i=t.browserEvent.target,r=i.classList.contains("monaco-tl-twistie")||i.classList.contains("monaco-icon-label")&&i.classList.contains("folder-icon")&&t.browserEvent.offsetX<16,s=cm(t.browserEvent.target),a=!1;if(s?a=!0:typeof this.tree.expandOnlyOnTwistieClick=="function"?a=this.tree.expandOnlyOnTwistieClick(n.element):a=!!this.tree.expandOnlyOnTwistieClick,s)this.handleStickyScrollMouseEvent(t,n);else{if(a&&!r&&t.browserEvent.detail!==2)return super.onViewPointer(t);if(!this.tree.expandOnDoubleClick&&t.browserEvent.detail===2)return super.onViewPointer(t)}if(n.collapsible&&(!s||r)){let l=this.tree.getNodeLocation(n),d=t.browserEvent.altKey;if(this.tree.setFocus([l]),this.tree.toggleCollapsed(l,d),r){t.browserEvent.isHandledByList=!0;return}}s||super.onViewPointer(t)}handleStickyScrollMouseEvent(t,n){if(BW(t.browserEvent.target)||VW(t.browserEvent.target))return;let i=this.stickyScrollProvider();if(!i)throw new Error("Sticky scroll controller not found");let r=this.list.indexOf(n),s=this.list.getElementTop(r),a=i.nodePositionTopBelowWidget(n);this.tree.scrollTop=s-a,this.list.domFocus(),this.list.setFocus([r]),this.list.setSelection([r])}onDoubleClick(t){t.browserEvent.target.classList.contains("monaco-tl-twistie")||!this.tree.expandOnDoubleClick||t.browserEvent.isHandledByList||super.onDoubleClick(t)}onMouseDown(t){let n=t.browserEvent.target;if(!um(n)&&!cm(n)){super.onMouseDown(t);return}}onContextMenu(t){let n=t.browserEvent.target;if(!um(n)&&!cm(n)){super.onContextMenu(t);return}}},B1=class extends ii{constructor(t,n,i,r,s,a,l,d){super(t,n,i,r,d);this.focusTrait=s;this.selectionTrait=a;this.anchorTrait=l}createMouseController(t){return new F1(this,t.tree,t.stickyScrollProvider)}splice(t,n,i=[]){if(super.splice(t,n,i),i.length===0)return;let r=[],s=[],a;i.forEach((l,d)=>{this.focusTrait.has(l)&&r.push(t+d),this.selectionTrait.has(l)&&s.push(t+d),this.anchorTrait.has(l)&&(a=t+d)}),r.length>0&&super.setFocus(Tr([...super.getFocus(),...r])),s.length>0&&super.setSelection(Tr([...super.getSelection(),...s])),typeof a=="number"&&super.setAnchor(a)}setFocus(t,n,i=!1){super.setFocus(t,n),i||this.focusTrait.set(t.map(r=>this.element(r)),n)}setSelection(t,n,i=!1){super.setSelection(t,n),i||this.selectionTrait.set(t.map(r=>this.element(r)),n)}setAnchor(t,n=!1){super.setAnchor(t),n||(typeof t>"u"?this.anchorTrait.set([]):this.anchorTrait.set([this.element(t)]))}};var gm=class{constructor(e,t,n,i,r={}){this._user=e;this._options=r;let s;r.keyboardNavigationLabelProvider&&(s=new D1(this,r.keyboardNavigationLabelProvider,r.filter),r={...r,filter:s},this.disposables.add(s)),this.model=this.createModel(e,r),this.treeDelegate=new mm(n);let a=this.disposables.add(new w1(this.onDidChangeActiveNodesRelay.event)),l=new pl;this.renderers=i.map(d=>new _1(d,this.model,this.onDidChangeCollapseStateRelay.event,a,l,r));for(let d of this.renderers)this.disposables.add(d);if(this.focus=new Zb(()=>this.view.getFocusedElements()[0],r.identityProvider),this.selection=new Zb(()=>this.view.getSelectedElements()[0],r.identityProvider),this.anchor=new Zb(()=>this.view.getAnchorElement(),r.identityProvider),this.view=new B1(e,t,this.treeDelegate,this.renderers,this.focus,this.selection,this.anchor,{...K6(()=>this.model,r),tree:this,stickyScrollProvider:()=>this.stickyScrollController}),this.setupModel(this.model),r.keyboardSupport!==!1){let d=q.chain(this.view.onKeyDown,c=>c.filter(u=>!rs(u.target)).map(u=>new mt(u)));q.chain(d,c=>c.filter(u=>u.keyCode===15))(this.onLeftArrow,this,this.disposables),q.chain(d,c=>c.filter(u=>u.keyCode===17))(this.onRightArrow,this,this.disposables),q.chain(d,c=>c.filter(u=>u.keyCode===10))(this.onSpace,this,this.disposables)}if((r.findWidgetEnabled??!0)&&r.keyboardNavigationLabelProvider&&r.contextViewProvider){let d=this.options.findWidgetStyles?{styles:this.options.findWidgetStyles}:void 0;this.findController=new M1(this,this.view,s,r.contextViewProvider,d),this.focusNavigationFilter=c=>this.findController.shouldAllowFocus(c),this.onDidChangeFindOpenState=this.findController.onDidChangeOpenState,this.disposables.add(this.findController),this.onDidChangeFindMode=this.findController.onDidChangeMode,this.onDidChangeFindMatchType=this.findController.onDidChangeMatchType,this.disposables.add(this.onDidSpliceModelRelay.event(()=>{!this.findController.isOpened()||this.findController.pattern.length===0||(this.refilter(),this.findController.render())}))}else this.onDidChangeFindMode=q.None,this.onDidChangeFindMatchType=q.None;r.enableStickyScroll&&(this.stickyScrollController=new VE(this,this.model,this.view,this.renderers,this.treeDelegate,r),this.onDidChangeStickyScrollFocused=this.stickyScrollController.onDidChangeHasFocus),this.styleElement=ur(this.view.getHTMLElement()),this.getHTMLElement().classList.toggle("always",this._options.renderIndentGuides==="always")}view;renderers;model;treeDelegate;focus;selection;anchor;eventBufferer=new md;findController;onDidChangeFindOpenState=q.None;onDidChangeStickyScrollFocused=q.None;focusNavigationFilter;stickyScrollController;styleElement;disposables=new ee;get onDidScroll(){return this.view.onDidScroll}get onDidChangeFocus(){return this.eventBufferer.wrapEvent(this.focus.onDidChange)}get onDidChangeSelection(){return this.eventBufferer.wrapEvent(this.selection.onDidChange)}get onMouseClick(){return q.map(this.view.onMouseClick,hm)}get onMouseDblClick(){return q.filter(q.map(this.view.onMouseDblClick,hm),e=>e.target!==3)}get onMouseOver(){return q.map(this.view.onMouseOver,hm)}get onMouseOut(){return q.map(this.view.onMouseOut,hm)}get onContextMenu(){return q.any(q.filter(q.map(this.view.onContextMenu,q6),e=>!e.isStickyScroll),this.stickyScrollController?.onContextMenu??q.None)}get onTap(){return q.map(this.view.onTap,hm)}get onPointer(){return q.map(this.view.onPointer,hm)}get onKeyDown(){return this.view.onKeyDown}get onKeyUp(){return this.view.onKeyUp}get onKeyPress(){return this.view.onKeyPress}get onDidFocus(){return this.view.onDidFocus}get onDidBlur(){return this.view.onDidBlur}onDidSwapModel=this.disposables.add(new D);onDidChangeModelRelay=this.disposables.add(new Yr);onDidSpliceModelRelay=this.disposables.add(new Yr);onDidChangeCollapseStateRelay=this.disposables.add(new Yr);onDidChangeRenderNodeCountRelay=this.disposables.add(new Yr);onDidChangeActiveNodesRelay=this.disposables.add(new Yr);get onDidChangeModel(){return q.any(this.onDidChangeModelRelay.event,this.onDidSwapModel.event)}get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}get onDidChangeRenderNodeCount(){return this.model.onDidChangeRenderNodeCount}_onWillRefilter=new D;onWillRefilter=this._onWillRefilter.event;get findMode(){return this.findController?.mode??0}set findMode(e){this.findController&&(this.findController.mode=e)}onDidChangeFindMode;get findMatchType(){return this.findController?.matchType??0}set findMatchType(e){this.findController&&(this.findController.matchType=e)}onDidChangeFindMatchType;get onDidChangeFindPattern(){return this.findController?this.findController.onDidChangePattern:q.None}get expandOnDoubleClick(){return typeof this._options.expandOnDoubleClick>"u"?!0:this._options.expandOnDoubleClick}get expandOnlyOnTwistieClick(){return typeof this._options.expandOnlyOnTwistieClick>"u"?!0:this._options.expandOnlyOnTwistieClick}_onDidUpdateOptions=new D;onDidUpdateOptions=this._onDidUpdateOptions.event;get onDidDispose(){return this.view.onDidDispose}updateOptions(e={}){this._options={...this._options,...e};for(let t of this.renderers)t.updateOptions(e);this.view.updateOptions(this._options),this.findController?.updateOptions(e),this.updateStickyScroll(e),this._onDidUpdateOptions.fire(this._options),this.getHTMLElement().classList.toggle("always",this._options.renderIndentGuides==="always")}get options(){return this._options}updateStickyScroll(e){!this.stickyScrollController&&this._options.enableStickyScroll?(this.stickyScrollController=new VE(this,this.model,this.view,this.renderers,this.treeDelegate,this._options),this.onDidChangeStickyScrollFocused=this.stickyScrollController.onDidChangeHasFocus):this.stickyScrollController&&!this._options.enableStickyScroll&&(this.onDidChangeStickyScrollFocused=q.None,this.stickyScrollController.dispose(),this.stickyScrollController=void 0),this.stickyScrollController?.updateOptions(e)}updateWidth(e){let t=this.model.getListIndex(e);t!==-1&&this.view.updateWidth(t)}getHTMLElement(){return this.view.getHTMLElement()}get contentHeight(){return this.view.contentHeight}get contentWidth(){return this.view.contentWidth}get onDidChangeContentHeight(){return this.view.onDidChangeContentHeight}get onDidChangeContentWidth(){return this.view.onDidChangeContentWidth}get scrollTop(){return this.view.scrollTop}set scrollTop(e){this.view.scrollTop=e}get scrollLeft(){return this.view.scrollLeft}set scrollLeft(e){this.view.scrollLeft=e}get scrollHeight(){return this.view.scrollHeight}get renderHeight(){return this.view.renderHeight}get firstVisibleElement(){let e=this.view.firstVisibleIndex;return this.stickyScrollController&&(e+=this.stickyScrollController.count),e<0||e>=this.view.length?void 0:this.view.element(e).element}get lastVisibleElement(){let e=this.view.lastVisibleIndex;return this.view.element(e).element}get ariaLabel(){return this.view.ariaLabel}set ariaLabel(e){this.view.ariaLabel=e}get selectionSize(){return this.selection.getNodes().length}domFocus(){this.stickyScrollController?.focusedLast()?this.stickyScrollController.domFocus():this.view.domFocus()}isDOMFocused(){return Fr(this.getHTMLElement())}layout(e,t){this.view.layout(e,t),Gi(t)&&this.findController?.layout(t)}style(e){let t=`.${this.view.domId}`,n=[];e.treeIndentGuidesStroke&&(n.push(`.monaco-list${t}:hover .monaco-tl-indent > .indent-guide, .monaco-list${t}.always .monaco-tl-indent > .indent-guide  { border-color: ${e.treeInactiveIndentGuidesStroke}; }`),n.push(`.monaco-list${t} .monaco-tl-indent > .indent-guide.active { border-color: ${e.treeIndentGuidesStroke}; }`));let i=e.treeStickyScrollBackground??e.listBackground;i&&(n.push(`.monaco-list${t} .monaco-scrollable-element .monaco-tree-sticky-container { background-color: ${i}; }`),n.push(`.monaco-list${t} .monaco-scrollable-element .monaco-tree-sticky-container .monaco-tree-sticky-row { background-color: ${i}; }`)),e.treeStickyScrollBorder&&n.push(`.monaco-list${t} .monaco-scrollable-element .monaco-tree-sticky-container { border-bottom: 1px solid ${e.treeStickyScrollBorder}; }`),e.treeStickyScrollShadow&&n.push(`.monaco-list${t} .monaco-scrollable-element .monaco-tree-sticky-container .monaco-tree-sticky-container-shadow { box-shadow: ${e.treeStickyScrollShadow} 0 6px 6px -6px inset; height: 3px; }`),e.listFocusForeground&&(n.push(`.monaco-list${t}.sticky-scroll-focused .monaco-scrollable-element .monaco-tree-sticky-container:focus .monaco-list-row.focused { color: ${e.listFocusForeground}; }`),n.push(`.monaco-list${t}:not(.sticky-scroll-focused) .monaco-scrollable-element .monaco-tree-sticky-container .monaco-list-row.focused { color: inherit; }`));let r=Vr(e.listFocusAndSelectionOutline,Vr(e.listSelectionOutline,e.listFocusOutline??""));r&&(n.push(`.monaco-list${t}.sticky-scroll-focused .monaco-scrollable-element .monaco-tree-sticky-container:focus .monaco-list-row.focused.selected { outline: 1px solid ${r}; outline-offset: -1px;}`),n.push(`.monaco-list${t}:not(.sticky-scroll-focused) .monaco-scrollable-element .monaco-tree-sticky-container .monaco-list-row.focused.selected { outline: inherit;}`)),e.listFocusOutline&&(n.push(`.monaco-list${t}.sticky-scroll-focused .monaco-scrollable-element .monaco-tree-sticky-container:focus .monaco-list-row.focused { outline: 1px solid ${e.listFocusOutline}; outline-offset: -1px; }`),n.push(`.monaco-list${t}:not(.sticky-scroll-focused) .monaco-scrollable-element .monaco-tree-sticky-container .monaco-list-row.focused { outline: inherit; }`),n.push(`.monaco-workbench.context-menu-visible .monaco-list${t}.last-focused.sticky-scroll-focused .monaco-scrollable-element .monaco-tree-sticky-container .monaco-list-row.passive-focused { outline: 1px solid ${e.listFocusOutline}; outline-offset: -1px; }`),n.push(`.monaco-workbench.context-menu-visible .monaco-list${t}.last-focused.sticky-scroll-focused .monaco-list-rows .monaco-list-row.focused { outline: inherit; }`),n.push(`.monaco-workbench.context-menu-visible .monaco-list${t}.last-focused:not(.sticky-scroll-focused) .monaco-tree-sticky-container .monaco-list-rows .monaco-list-row.focused { outline: inherit; }`)),this.styleElement.textContent=n.join(`
`),this.view.style(e)}getParentElement(e){let t=this.model.getParentNodeLocation(e);return this.model.getNode(t).element}getFirstElementChild(e){return this.model.getFirstElementChild(e)}getNode(e){return this.model.getNode(e)}getNodeLocation(e){return this.model.getNodeLocation(e)}collapse(e,t=!1){return this.model.setCollapsed(e,!0,t)}expand(e,t=!1){return this.model.setCollapsed(e,!1,t)}toggleCollapsed(e,t=!1){return this.model.setCollapsed(e,void 0,t)}expandAll(){this.model.setCollapsed(this.model.rootRef,!1,!0)}collapseAll(){this.model.setCollapsed(this.model.rootRef,!0,!0)}isCollapsible(e){return this.model.isCollapsible(e)}setCollapsible(e,t){return this.model.setCollapsible(e,t)}isCollapsed(e){return this.model.isCollapsed(e)}expandTo(e){this.model.expandTo(e)}triggerTypeNavigation(){this.view.triggerTypeNavigation()}openFind(){this.findController?.open()}closeFind(){this.findController?.close()}refilter(){this._onWillRefilter.fire(void 0),this.model.refilter()}setAnchor(e){if(typeof e>"u")return this.view.setAnchor(void 0);this.eventBufferer.bufferEvents(()=>{let t=this.model.getNode(e);this.anchor.set([t]);let n=this.model.getListIndex(e);n>-1&&this.view.setAnchor(n,!0)})}getAnchor(){return this.anchor.get().at(0)}setSelection(e,t){this.eventBufferer.bufferEvents(()=>{let n=e.map(r=>this.model.getNode(r));this.selection.set(n,t);let i=e.map(r=>this.model.getListIndex(r)).filter(r=>r>-1);this.view.setSelection(i,t,!0)})}getSelection(){return this.selection.get()}setFocus(e,t){this.eventBufferer.bufferEvents(()=>{let n=e.map(r=>this.model.getNode(r));this.focus.set(n,t);let i=e.map(r=>this.model.getListIndex(r)).filter(r=>r>-1);this.view.setFocus(i,t,!0)})}focusNext(e=1,t=!1,n,i=os(n)&&n.altKey?void 0:this.focusNavigationFilter){this.view.focusNext(e,t,n,i)}focusPrevious(e=1,t=!1,n,i=os(n)&&n.altKey?void 0:this.focusNavigationFilter){this.view.focusPrevious(e,t,n,i)}focusNextPage(e,t=os(e)&&e.altKey?void 0:this.focusNavigationFilter){return this.view.focusNextPage(e,t)}focusPreviousPage(e,t=os(e)&&e.altKey?void 0:this.focusNavigationFilter){return this.view.focusPreviousPage(e,t,()=>this.stickyScrollController?.height??0)}focusLast(e,t=os(e)&&e.altKey?void 0:this.focusNavigationFilter){this.view.focusLast(e,t)}focusFirst(e,t=os(e)&&e.altKey?void 0:this.focusNavigationFilter){this.view.focusFirst(e,t)}getFocus(){return this.focus.get()}getStickyScrollFocus(){let e=this.stickyScrollController?.getFocus();return e!==void 0?[e]:[]}getFocusedPart(){return this.stickyScrollController?.focusedLast()?1:0}reveal(e,t){this.model.expandTo(e);let n=this.model.getListIndex(e);if(n!==-1)if(!this.stickyScrollController)this.view.reveal(n,t);else{let i=this.stickyScrollController.nodePositionTopBelowWidget(this.getNode(e));this.view.reveal(n,t,i)}}getRelativeTop(e){let t=this.model.getListIndex(e);if(t===-1)return null;let n=this.stickyScrollController?.getNode(this.getNode(e));return this.view.getRelativeTop(t,n?.position??this.stickyScrollController?.height)}getViewState(e=this.options.identityProvider){if(!e)throw new dn(this._user,"Can't get tree view state without an identity provider");let t=s=>e.getId(s).toString(),n=x1.empty(this.scrollTop);for(let s of this.getFocus())n.focus.add(t(s));for(let s of this.getSelection())n.selection.add(t(s));let i=this.model.getNode(),r=[i];for(;r.length>0;){let s=r.shift();s!==i&&s.collapsible&&(n.expanded[t(s.element)]=s.collapsed?0:1),r.push(...s.children)}return n}onLeftArrow(e){e.preventDefault(),e.stopPropagation();let t=this.view.getFocusedElements();if(t.length===0)return;let n=t[0],i=this.model.getNodeLocation(n);if(!this.model.setCollapsed(i,!0)){let s=this.model.getParentNodeLocation(i);if(!s)return;let a=this.model.getListIndex(s);this.view.reveal(a),this.view.setFocus([a])}}onRightArrow(e){e.preventDefault(),e.stopPropagation();let t=this.view.getFocusedElements();if(t.length===0)return;let n=t[0],i=this.model.getNodeLocation(n);if(!this.model.setCollapsed(i,!1)){if(!n.children.some(l=>l.visible))return;let[s]=this.view.getFocus(),a=s+1;this.view.reveal(a),this.view.setFocus([a])}}onSpace(e){e.preventDefault(),e.stopPropagation();let t=this.view.getFocusedElements();if(t.length===0)return;let n=t[0],i=this.model.getNodeLocation(n),r=e.browserEvent.altKey;this.model.setCollapsed(i,void 0,r)}modelDisposables=new ee;setupModel(e){this.modelDisposables.clear(),this.modelDisposables.add(e.onDidSpliceRenderedNodes(({start:r,deleteCount:s,elements:a})=>this.view.splice(r,s,a)));let t=q.forEach(e.onDidSpliceModel,r=>{this.eventBufferer.bufferEvents(()=>{this.focus.onDidModelSplice(r),this.selection.onDidModelSplice(r)})},this.modelDisposables);t(()=>null,null,this.modelDisposables);let n=this.modelDisposables.add(new D),i=this.modelDisposables.add(new Ss(0));this.modelDisposables.add(q.any(t,this.focus.onDidChange,this.selection.onDidChange)(()=>{i.trigger(()=>{let r=new Set;for(let s of this.focus.getNodes())r.add(s);for(let s of this.selection.getNodes())r.add(s);n.fire([...r.values()])})})),this.onDidChangeActiveNodesRelay.input=n.event,this.onDidChangeModelRelay.input=q.signal(e.onDidSpliceModel),this.onDidChangeCollapseStateRelay.input=e.onDidChangeCollapseState,this.onDidChangeRenderNodeCountRelay.input=e.onDidChangeRenderNodeCount}setModel(e){let t=this.model;this.model=e,this.setupModel(e),this.renderers.forEach(n=>n.setModel(e)),this.stickyScrollController?.setModel(e),this.focus.set([]),this.selection.set([]),this.anchor.set([]),this.view.splice(0,t.getListRenderCount(t.rootRef)),this.model.refilter(),this.onDidSwapModel.fire()}getModel(){return this.model}navigate(e){return new V1(this.view,this.model,e)}dispose(){wt(this.disposables),this.stickyScrollController?.dispose(),this.view.dispose(),this.modelDisposables.dispose()}},V1=class{constructor(e,t,n){this.view=e;this.model=t;n?this.index=this.model.getListIndex(n):this.index=-1}index;current(){return this.index<0||this.index>=this.view.length?null:this.view.element(this.index).element}previous(){return this.index--,this.current()}next(){return this.index++,this.current()}first(){return this.index=0,this.current()}last(){return this.index=this.view.length-1,this.current()}};var cc=class{constructor(e,t={}){this.user=e;this.model=new FE(e,null,t),this.onDidSpliceModel=this.model.onDidSpliceModel,this.onDidSpliceRenderedNodes=this.model.onDidSpliceRenderedNodes,this.onDidChangeCollapseState=this.model.onDidChangeCollapseState,this.onDidChangeRenderNodeCount=this.model.onDidChangeRenderNodeCount,t.sorter&&(this.sorter={compare(n,i){return t.sorter.compare(n.element,i.element)}}),this.identityProvider=t.identityProvider}rootRef=null;model;nodes=new Map;nodesByIdentity=new Map;identityProvider;sorter;onDidSpliceModel;onDidSpliceRenderedNodes;onDidChangeCollapseState;onDidChangeRenderNodeCount;get size(){return this.nodes.size}setChildren(e,t=Je.empty(),n={}){let i=this.getElementLocation(e);this._setChildren(i,this.preserveCollapseState(t),n)}_setChildren(e,t=Je.empty(),n){let i=new Set,r=new Set,s=l=>{if(l.element===null)return;let d=l;if(i.add(d.element),this.nodes.set(d.element,d),this.identityProvider){let c=this.identityProvider.getId(d.element).toString();r.add(c),this.nodesByIdentity.set(c,d)}n.onDidCreateNode?.(d)},a=l=>{if(l.element===null)return;let d=l;if(i.has(d.element)||this.nodes.delete(d.element),this.identityProvider){let c=this.identityProvider.getId(d.element).toString();r.has(c)||this.nodesByIdentity.delete(c)}n.onDidDeleteNode?.(d)};this.model.splice([...e,0],Number.MAX_VALUE,t,{...n,onDidCreateNode:s,onDidDeleteNode:a})}preserveCollapseState(e=Je.empty()){return this.sorter&&(e=[...e].sort(this.sorter.compare.bind(this.sorter))),Je.map(e,t=>{let n=this.nodes.get(t.element);if(!n&&this.identityProvider){let s=this.identityProvider.getId(t.element).toString();n=this.nodesByIdentity.get(s)}if(!n){let s;return typeof t.collapsed>"u"?s=void 0:t.collapsed===1||t.collapsed===3?s=!0:t.collapsed===0||t.collapsed===2?s=!1:s=!!t.collapsed,{...t,children:this.preserveCollapseState(t.children),collapsed:s}}let i=typeof t.collapsible=="boolean"?t.collapsible:n.collapsible,r;return typeof t.collapsed>"u"||t.collapsed===3||t.collapsed===2?r=n.collapsed:t.collapsed===1?r=!0:t.collapsed===0?r=!1:r=!!t.collapsed,{...t,collapsible:i,collapsed:r,children:this.preserveCollapseState(t.children)}})}rerender(e){let t=this.getElementLocation(e);this.model.rerender(t)}resort(e=null,t=!0){if(!this.sorter)return;let n=this.getElementLocation(e),i=this.model.getNode(n);this._setChildren(n,this.resortChildren(i,t),{})}resortChildren(e,t,n=!0){let i=[...e.children];return(t||n)&&(i=i.sort(this.sorter.compare.bind(this.sorter))),Je.map(i,r=>({element:r.element,collapsible:r.collapsible,collapsed:r.collapsed,children:this.resortChildren(r,t,!1)}))}getFirstElementChild(e=null){let t=this.getElementLocation(e);return this.model.getFirstElementChild(t)}getLastElementAncestor(e=null){let t=this.getElementLocation(e);return this.model.getLastElementAncestor(t)}has(e){return this.nodes.has(e)}getListIndex(e){let t=this.getElementLocation(e);return this.model.getListIndex(t)}getListRenderCount(e){let t=this.getElementLocation(e);return this.model.getListRenderCount(t)}isCollapsible(e){let t=this.getElementLocation(e);return this.model.isCollapsible(t)}setCollapsible(e,t){let n=this.getElementLocation(e);return this.model.setCollapsible(n,t)}isCollapsed(e){let t=this.getElementLocation(e);return this.model.isCollapsed(t)}setCollapsed(e,t,n){let i=this.getElementLocation(e);return this.model.setCollapsed(i,t,n)}expandTo(e){let t=this.getElementLocation(e);this.model.expandTo(t)}refilter(){this.model.refilter()}getNode(e=null){if(e===null)return this.model.getNode(this.model.rootRef);let t=this.nodes.get(e);if(!t)throw new dn(this.user,`Tree element not found: ${e}`);return t}getNodeLocation(e){return e.element}getParentNodeLocation(e){if(e===null)throw new dn(this.user,"Invalid getParentNodeLocation call");let t=this.nodes.get(e);if(!t)throw new dn(this.user,`Tree element not found: ${e}`);let n=this.model.getNodeLocation(t),i=this.model.getParentNodeLocation(n);return this.model.getNode(i).element}getElementLocation(e){if(e===null)return[];let t=this.nodes.get(e);if(!t)throw new dn(this.user,`Tree element not found: ${e}`);return this.model.getNodeLocation(t)}};function WE(o){let e=[o.element],t=o.incompressible||!1;return{element:{elements:e,incompressible:t},children:Je.map(Je.from(o.children),WE),collapsible:o.collapsible,collapsed:o.collapsed}}function HE(o){let e=[o.element],t=o.incompressible||!1,n,i;for(;[i,n]=Je.consume(Je.from(o.children),2),!(i.length!==1||i[0].incompressible);)o=i[0],e.push(o.element);return{element:{elements:e,incompressible:t},children:Je.map(Je.concat(i,n),HE),collapsible:o.collapsible,collapsed:o.collapsed}}function W1(o,e=0){let t;return e<o.element.elements.length-1?t=[W1(o,e+1)]:t=Je.map(Je.from(o.children),n=>W1(n,0)),e===0&&o.element.incompressible?{element:o.element.elements[e],children:t,incompressible:!0,collapsible:o.collapsible,collapsed:o.collapsed}:{element:o.element.elements[e],children:t,collapsible:o.collapsible,collapsed:o.collapsed}}function nH(o){return W1(o,0)}function iH(o,e,t){return o.element===e?{...o,children:t}:{...o,children:Je.map(Je.from(o.children),n=>iH(n,e,t))}}var Y6=o=>({getId(e){return e.elements.map(t=>o.getId(t).toString()).join("\0")}}),H1=class{constructor(e,t={}){this.user=e;this.model=new cc(e,t),this.enabled=typeof t.compressionEnabled>"u"?!0:t.compressionEnabled,this.identityProvider=t.identityProvider}rootRef=null;get onDidSpliceRenderedNodes(){return this.model.onDidSpliceRenderedNodes}get onDidSpliceModel(){return this.model.onDidSpliceModel}get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}get onDidChangeRenderNodeCount(){return this.model.onDidChangeRenderNodeCount}model;nodes=new Map;enabled;identityProvider;get size(){return this.nodes.size}setChildren(e,t=Je.empty(),n){let i=n.diffIdentityProvider&&Y6(n.diffIdentityProvider);if(e===null){let f=Je.map(t,this.enabled?HE:WE);this._setChildren(null,f,{diffIdentityProvider:i,diffDepth:1/0});return}let r=this.nodes.get(e);if(!r)throw new dn(this.user,"Unknown compressed tree node");let s=this.model.getNode(r),a=this.model.getParentNodeLocation(r),l=this.model.getNode(a),d=nH(s),c=iH(d,e,t),u=(this.enabled?HE:WE)(c),p=n.diffIdentityProvider?(f,g)=>n.diffIdentityProvider.getId(f)===n.diffIdentityProvider.getId(g):void 0;if(zt(u.element.elements,s.element.elements,p)){this._setChildren(r,u.children||Je.empty(),{diffIdentityProvider:i,diffDepth:1});return}let h=l.children.map(f=>f===s?u:f);this._setChildren(l.element,h,{diffIdentityProvider:i,diffDepth:s.depth-l.depth})}isCompressionEnabled(){return this.enabled}setCompressionEnabled(e){if(e===this.enabled)return;this.enabled=e;let n=this.model.getNode().children,i=Je.map(n,nH),r=Je.map(i,e?HE:WE);this._setChildren(null,r,{diffIdentityProvider:this.identityProvider,diffDepth:1/0})}_setChildren(e,t,n){let i=new Set,r=a=>{for(let l of a.element.elements)i.add(l),this.nodes.set(l,a.element)},s=a=>{for(let l of a.element.elements)i.has(l)||this.nodes.delete(l)};this.model.setChildren(e,t,{...n,onDidCreateNode:r,onDidDeleteNode:s})}has(e){return this.nodes.has(e)}getListIndex(e){let t=this.getCompressedNode(e);return this.model.getListIndex(t)}getListRenderCount(e){let t=this.getCompressedNode(e);return this.model.getListRenderCount(t)}getNode(e){if(typeof e>"u")return this.model.getNode();let t=this.getCompressedNode(e);return this.model.getNode(t)}getNodeLocation(e){let t=this.model.getNodeLocation(e);return t===null?null:t.elements[t.elements.length-1]}getParentNodeLocation(e){let t=this.getCompressedNode(e),n=this.model.getParentNodeLocation(t);return n===null?null:n.elements[n.elements.length-1]}getFirstElementChild(e){let t=this.getCompressedNode(e);return this.model.getFirstElementChild(t)}getLastElementAncestor(e){let t=typeof e>"u"?void 0:this.getCompressedNode(e);return this.model.getLastElementAncestor(t)}isCollapsible(e){let t=this.getCompressedNode(e);return this.model.isCollapsible(t)}setCollapsible(e,t){let n=this.getCompressedNode(e);return this.model.setCollapsible(n,t)}isCollapsed(e){let t=this.getCompressedNode(e);return this.model.isCollapsed(t)}setCollapsed(e,t,n){let i=this.getCompressedNode(e);return this.model.setCollapsed(i,t,n)}expandTo(e){let t=this.getCompressedNode(e);this.model.expandTo(t)}rerender(e){let t=this.getCompressedNode(e);this.model.rerender(t)}refilter(){this.model.refilter()}resort(e=null,t=!0){let n=this.getCompressedNode(e);this.model.resort(n,t)}getCompressedNode(e){if(e===null)return null;let t=this.nodes.get(e);if(!t)throw new dn(this.user,`Tree element not found: ${e}`);return t}},Z6=o=>o[o.length-1],U1=class o{constructor(e,t){this.unwrapper=e;this.node=t}get element(){return this.node.element===null?null:this.unwrapper(this.node.element)}get children(){return this.node.children.map(e=>new o(this.unwrapper,e))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}};function X6(o,e){return{...e,identityProvider:e.identityProvider&&{getId(t){return e.identityProvider.getId(o(t))}},sorter:e.sorter&&{compare(t,n){return e.sorter.compare(t.elements[0],n.elements[0])}},filter:e.filter&&{filter(t,n){return e.filter.filter(o(t),n)}}}}var UE=class{rootRef=null;get onDidSpliceModel(){return q.map(this.model.onDidSpliceModel,({insertedNodes:e,deletedNodes:t})=>({insertedNodes:e.map(n=>this.nodeMapper.map(n)),deletedNodes:t.map(n=>this.nodeMapper.map(n))}))}get onDidSpliceRenderedNodes(){return q.map(this.model.onDidSpliceRenderedNodes,({start:e,deleteCount:t,elements:n})=>({start:e,deleteCount:t,elements:n.map(i=>this.nodeMapper.map(i))}))}get onDidChangeCollapseState(){return q.map(this.model.onDidChangeCollapseState,({node:e,deep:t})=>({node:this.nodeMapper.map(e),deep:t}))}get onDidChangeRenderNodeCount(){return q.map(this.model.onDidChangeRenderNodeCount,e=>this.nodeMapper.map(e))}elementMapper;nodeMapper;model;constructor(e,t={}){this.elementMapper=t.elementMapper||Z6;let n=i=>this.elementMapper(i.elements);this.nodeMapper=new Hu(i=>new U1(n,i)),this.model=new H1(e,X6(n,t))}setChildren(e,t=Je.empty(),n={}){this.model.setChildren(e,t,n)}isCompressionEnabled(){return this.model.isCompressionEnabled()}setCompressionEnabled(e){this.model.setCompressionEnabled(e)}has(e){return this.model.has(e)}getListIndex(e){return this.model.getListIndex(e)}getListRenderCount(e){return this.model.getListRenderCount(e)}getNode(e){return this.nodeMapper.map(this.model.getNode(e))}getNodeLocation(e){return e.element}getParentNodeLocation(e){return this.model.getParentNodeLocation(e)}getFirstElementChild(e){let t=this.model.getFirstElementChild(e);return t===null||typeof t>"u"?t:this.elementMapper(t.elements)}getLastElementAncestor(e){let t=this.model.getLastElementAncestor(e);return t===null||typeof t>"u"?t:this.elementMapper(t.elements)}isCollapsible(e){return this.model.isCollapsible(e)}setCollapsible(e,t){return this.model.setCollapsible(e,t)}isCollapsed(e){return this.model.isCollapsed(e)}setCollapsed(e,t,n){return this.model.setCollapsed(e,t,n)}expandTo(e){return this.model.expandTo(e)}rerender(e){return this.model.rerender(e)}refilter(){return this.model.refilter()}resort(e=null,t=!0){return this.model.resort(e,t)}getCompressedTreeNode(e=null){return this.model.getNode(e)}};var zu=class extends gm{constructor(t,n,i,r,s={}){super(t,n,i,r,s);this.user=t}get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}setChildren(t,n=Je.empty(),i){this.model.setChildren(t,n,i)}rerender(t){if(t===void 0){this.view.rerender();return}this.model.rerender(t)}updateElementHeight(t,n){let i=this.model.getListIndex(t);if(i===-1)throw new dn(this.user,"updateElementHeight failed - index not found");this.view.updateElementHeight(i,n)}resort(t,n=!0){this.model.resort(t,n)}hasElement(t){return this.model.has(t)}createModel(t,n){return new cc(t,n)}},zE=class{constructor(e,t,n){this._compressedTreeNodeProvider=e;this.stickyScrollDelegate=t;this.renderer=n;this.templateId=n.templateId,n.onDidChangeTwistieState&&(this.onDidChangeTwistieState=n.onDidChangeTwistieState)}templateId;onDidChangeTwistieState;get compressedTreeNodeProvider(){return this._compressedTreeNodeProvider()}renderTemplate(e){return{compressedTreeNode:void 0,data:this.renderer.renderTemplate(e)}}renderElement(e,t,n,i){let r=this.stickyScrollDelegate.getCompressedNode(e);r||(r=this.compressedTreeNodeProvider.getCompressedTreeNode(e.element)),r.element.elements.length===1?(n.compressedTreeNode=void 0,this.renderer.renderElement(e,t,n.data,i)):(n.compressedTreeNode=r,this.renderer.renderCompressedElements(r,t,n.data,i))}disposeElement(e,t,n,i){n.compressedTreeNode?this.renderer.disposeCompressedElements?.(n.compressedTreeNode,t,n.data,i):this.renderer.disposeElement?.(e,t,n.data,i)}disposeTemplate(e){this.renderer.disposeTemplate(e.data)}renderTwistie(e,t){return this.renderer.renderTwistie?this.renderer.renderTwistie(e,t):!1}};O([he],zE.prototype,"compressedTreeNodeProvider",1);var z1=class{constructor(e){this.modelProvider=e}compressedStickyNodes=new Map;getCompressedNode(e){return this.compressedStickyNodes.get(e)}constrainStickyScrollNodes(e,t,n){if(this.compressedStickyNodes.clear(),e.length===0)return[];for(let i=0;i<e.length;i++){let r=e[i],s=r.position+r.height;if(i+1<e.length&&s+e[i+1].height>n||i>=t-1&&t<e.length){let l=e.slice(0,i),d=e.slice(i),c=this.compressStickyNodes(d);return[...l,c]}}return e}compressStickyNodes(e){if(e.length===0)throw new Error("Can't compress empty sticky nodes");let t=this.modelProvider();if(!t.isCompressionEnabled())return e[0];let n=[];for(let d=0;d<e.length;d++){let c=e[d],u=t.getCompressedTreeNode(c.node.element);if(u.element){if(d!==0&&u.element.incompressible)break;n.push(...u.element.elements)}}if(n.length<2)return e[0];let i=e[e.length-1],r={elements:n,incompressible:!1},s={...i.node,children:[],element:r},a=new Proxy(e[0].node,{}),l={node:a,startIndex:e[0].startIndex,endIndex:i.endIndex,position:e[0].position,height:e[0].height};return this.compressedStickyNodes.set(a,s),l}};function Q6(o,e){return e&&{...e,keyboardNavigationLabelProvider:e.keyboardNavigationLabelProvider&&{getKeyboardNavigationLabel(t){let n;try{n=o().getCompressedTreeNode(t)}catch{return e.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(t)}return n.element.elements.length===1?e.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(t):e.keyboardNavigationLabelProvider.getCompressedNodeKeyboardNavigationLabel(n.element.elements)}}}}var fm=class extends zu{constructor(e,t,n,i,r={}){let s=()=>this,a=new z1(()=>this.model),l=i.map(d=>new zE(s,a,d));super(e,t,n,l,{...Q6(s,r),stickyScrollDelegate:a})}setChildren(e,t=Je.empty(),n){this.model.setChildren(e,t,n)}createModel(e,t){return new UE(e,t)}updateOptions(e={}){super.updateOptions(e),typeof e.compressionEnabled<"u"&&this.model.setCompressionEnabled(e.compressionEnabled)}getCompressedTreeNode(e=null){return this.model.getCompressedTreeNode(e)}};function K1(o){return{...o,children:[],refreshPromise:void 0,stale:!0,slow:!1,forceExpanded:!1}}function j1(o,e){return e.parent?e.parent===o?!0:j1(o,e.parent):!1}function J6(o,e){return o===e||j1(o,e)||j1(e,o)}var q1=class o{constructor(e){this.node=e}get element(){return this.node.element.element}get children(){return this.node.children.map(e=>new o(e))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}},$1=class{constructor(e,t,n){this.renderer=e;this.nodeMapper=t;this.onDidChangeTwistieState=n;this.templateId=e.templateId}templateId;renderedNodes=new Map;renderTemplate(e){return{templateData:this.renderer.renderTemplate(e)}}renderElement(e,t,n,i){this.renderer.renderElement(this.nodeMapper.map(e),t,n.templateData,i)}renderTwistie(e,t){return e.slow?(t.classList.add(...we.asClassNameArray(te.treeItemLoading)),!0):(t.classList.remove(...we.asClassNameArray(te.treeItemLoading)),!1)}disposeElement(e,t,n,i){this.renderer.disposeElement?.(this.nodeMapper.map(e),t,n.templateData,i)}disposeTemplate(e){this.renderer.disposeTemplate(e.templateData)}dispose(){this.renderedNodes.clear()}};function oH(o){return{browserEvent:o.browserEvent,elements:o.elements.map(e=>e.element)}}function KE(o){return{browserEvent:o.browserEvent,element:o.element&&o.element.element,target:o.target}}function eK(o){return{browserEvent:o.browserEvent,element:o.element&&o.element.element,anchor:o.anchor,isStickyScroll:o.isStickyScroll}}var Y1=class extends Pl{constructor(t){super(t.elements.map(n=>n.element));this.data=t}set context(t){this.data.context=t}get context(){return this.data.context}};function G1(o){return o instanceof Pl?new Y1(o):o}var Z1=class{constructor(e){this.dnd=e}getDragURI(e){return this.dnd.getDragURI(e.element)}getDragLabel(e,t){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(e.map(n=>n.element),t)}onDragStart(e,t){this.dnd.onDragStart?.(G1(e),t)}onDragOver(e,t,n,i,r,s=!0){return this.dnd.onDragOver(G1(e),t&&t.element,n,i,r)}drop(e,t,n,i,r){this.dnd.drop(G1(e),t&&t.element,n,i,r)}onDragEnd(e){this.dnd.onDragEnd?.(e)}dispose(){this.dnd.dispose()}};function rH(o){return o&&{...o,collapseByDefault:!0,identityProvider:o.identityProvider&&{getId(e){return o.identityProvider.getId(e.element)}},dnd:o.dnd&&new Z1(o.dnd),multipleSelectionController:o.multipleSelectionController&&{isSelectionSingleChangeEvent(e){return o.multipleSelectionController.isSelectionSingleChangeEvent({...e,element:e.element})},isSelectionRangeChangeEvent(e){return o.multipleSelectionController.isSelectionRangeChangeEvent({...e,element:e.element})}},accessibilityProvider:o.accessibilityProvider&&{...o.accessibilityProvider,getPosInSet:void 0,getSetSize:void 0,getRole:o.accessibilityProvider.getRole?e=>o.accessibilityProvider.getRole(e.element):()=>"treeitem",isChecked:o.accessibilityProvider.isChecked?e=>!!o.accessibilityProvider?.isChecked(e.element):void 0,getAriaLabel(e){return o.accessibilityProvider.getAriaLabel(e.element)},getWidgetAriaLabel(){return o.accessibilityProvider.getWidgetAriaLabel()},getWidgetRole:o.accessibilityProvider.getWidgetRole?()=>o.accessibilityProvider.getWidgetRole():()=>"tree",getAriaLevel:o.accessibilityProvider.getAriaLevel&&(e=>o.accessibilityProvider.getAriaLevel(e.element)),getActiveDescendantId:o.accessibilityProvider.getActiveDescendantId&&(e=>o.accessibilityProvider.getActiveDescendantId(e.element))},filter:o.filter&&{filter(e,t){return o.filter.filter(e.element,t)}},keyboardNavigationLabelProvider:o.keyboardNavigationLabelProvider&&{...o.keyboardNavigationLabelProvider,getKeyboardNavigationLabel(e){return o.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(e.element)}},sorter:void 0,expandOnlyOnTwistieClick:typeof o.expandOnlyOnTwistieClick>"u"?void 0:typeof o.expandOnlyOnTwistieClick!="function"?o.expandOnlyOnTwistieClick:e=>o.expandOnlyOnTwistieClick(e.element),defaultFindVisibility:e=>e.hasChildren&&e.stale?1:typeof o.defaultFindVisibility=="number"?o.defaultFindVisibility:typeof o.defaultFindVisibility>"u"?2:o.defaultFindVisibility(e.element)}}function X1(o,e){e(o),o.children.forEach(t=>X1(t,e))}var Xb=class{constructor(e,t,n,i,r,s={}){this.user=e;this.dataSource=r;this.identityProvider=s.identityProvider,this.autoExpandSingleChildren=typeof s.autoExpandSingleChildren>"u"?!1:s.autoExpandSingleChildren,this.sorter=s.sorter,this.getDefaultCollapseState=a=>s.collapseByDefault?s.collapseByDefault(a)?3:2:void 0,this.tree=this.createTree(e,t,n,i,s),this.onDidChangeFindMode=this.tree.onDidChangeFindMode,this.onDidChangeFindMatchType=this.tree.onDidChangeFindMatchType,this.root=K1({element:void 0,parent:null,hasChildren:!0,defaultCollapseState:void 0}),this.identityProvider&&(this.root={...this.root,id:null}),this.nodes.set(null,this.root),this.tree.onDidChangeCollapseState(this._onDidChangeCollapseState,this,this.disposables)}tree;root;nodes=new Map;sorter;getDefaultCollapseState;subTreeRefreshPromises=new Map;refreshPromises=new Map;identityProvider;autoExpandSingleChildren;_onDidRender=new D;_onDidChangeNodeSlowState=new D;nodeMapper=new Hu(e=>new q1(e));disposables=new ee;get onDidScroll(){return this.tree.onDidScroll}get onDidChangeFocus(){return q.map(this.tree.onDidChangeFocus,oH)}get onDidChangeSelection(){return q.map(this.tree.onDidChangeSelection,oH)}get onKeyDown(){return this.tree.onKeyDown}get onMouseClick(){return q.map(this.tree.onMouseClick,KE)}get onMouseDblClick(){return q.map(this.tree.onMouseDblClick,KE)}get onContextMenu(){return q.map(this.tree.onContextMenu,eK)}get onTap(){return q.map(this.tree.onTap,KE)}get onPointer(){return q.map(this.tree.onPointer,KE)}get onDidFocus(){return this.tree.onDidFocus}get onDidBlur(){return this.tree.onDidBlur}get onDidChangeModel(){return this.tree.onDidChangeModel}get onDidChangeCollapseState(){return this.tree.onDidChangeCollapseState}get onDidUpdateOptions(){return this.tree.onDidUpdateOptions}get onDidChangeFindOpenState(){return this.tree.onDidChangeFindOpenState}get onDidChangeStickyScrollFocused(){return this.tree.onDidChangeStickyScrollFocused}get findMode(){return this.tree.findMode}set findMode(e){this.tree.findMode=e}onDidChangeFindMode;get findMatchType(){return this.tree.findMatchType}set findMatchType(e){this.tree.findMatchType=e}onDidChangeFindMatchType;get expandOnlyOnTwistieClick(){if(typeof this.tree.expandOnlyOnTwistieClick=="boolean")return this.tree.expandOnlyOnTwistieClick;let e=this.tree.expandOnlyOnTwistieClick;return t=>e(this.nodes.get(t===this.root.element?null:t)||null)}get onDidDispose(){return this.tree.onDidDispose}createTree(e,t,n,i,r){let s=new mm(n),a=i.map(d=>new $1(d,this.nodeMapper,this._onDidChangeNodeSlowState.event)),l=rH(r)||{};return new zu(e,t,s,a,l)}updateOptions(e={}){this.tree.updateOptions(e)}get options(){return this.tree.options}getHTMLElement(){return this.tree.getHTMLElement()}get contentHeight(){return this.tree.contentHeight}get contentWidth(){return this.tree.contentWidth}get onDidChangeContentHeight(){return this.tree.onDidChangeContentHeight}get onDidChangeContentWidth(){return this.tree.onDidChangeContentWidth}get scrollTop(){return this.tree.scrollTop}set scrollTop(e){this.tree.scrollTop=e}get scrollLeft(){return this.tree.scrollLeft}set scrollLeft(e){this.tree.scrollLeft=e}get scrollHeight(){return this.tree.scrollHeight}get renderHeight(){return this.tree.renderHeight}get lastVisibleElement(){return this.tree.lastVisibleElement.element}get ariaLabel(){return this.tree.ariaLabel}set ariaLabel(e){this.tree.ariaLabel=e}domFocus(){this.tree.domFocus()}layout(e,t){this.tree.layout(e,t)}style(e){this.tree.style(e)}getInput(){return this.root.element}async setInput(e,t){this.refreshPromises.forEach(i=>i.cancel()),this.refreshPromises.clear(),this.root.element=e;let n=t&&{viewState:t,focus:[],selection:[]};await this._updateChildren(e,!0,!1,n),n&&(this.tree.setFocus(n.focus),this.tree.setSelection(n.selection)),t&&typeof t.scrollTop=="number"&&(this.scrollTop=t.scrollTop)}async updateChildren(e=this.root.element,t=!0,n=!1,i){await this._updateChildren(e,t,n,void 0,i)}async _updateChildren(e=this.root.element,t=!0,n=!1,i,r){if(typeof this.root.element>"u")throw new dn(this.user,"Tree input not set");this.root.refreshPromise&&(await this.root.refreshPromise,await q.toPromise(this._onDidRender.event));let s=this.getDataNode(e);if(await this.refreshAndRenderNode(s,t,i,r),n)try{this.tree.rerender(s)}catch{}}resort(e=this.root.element,t=!0){this.tree.resort(this.getDataNode(e),t)}hasNode(e){return e===this.root.element||this.nodes.has(e)}rerender(e){if(e===void 0||e===this.root.element){this.tree.rerender();return}let t=this.getDataNode(e);this.tree.rerender(t)}updateElementHeight(e,t){let n=this.getDataNode(e);this.tree.updateElementHeight(n,t)}updateWidth(e){let t=this.getDataNode(e);this.tree.updateWidth(t)}getNode(e=this.root.element){let t=this.getDataNode(e),n=this.tree.getNode(t===this.root?null:t);return this.nodeMapper.map(n)}collapse(e,t=!1){let n=this.getDataNode(e);return this.tree.collapse(n===this.root?null:n,t)}async expand(e,t=!1){if(typeof this.root.element>"u")throw new dn(this.user,"Tree input not set");this.root.refreshPromise&&(await this.root.refreshPromise,await q.toPromise(this._onDidRender.event));let n=this.getDataNode(e);if(this.tree.hasElement(n)&&!this.tree.isCollapsible(n)||(n.refreshPromise&&(await this.root.refreshPromise,await q.toPromise(this._onDidRender.event)),n!==this.root&&!n.refreshPromise&&!this.tree.isCollapsed(n)))return!1;let i=this.tree.expand(n===this.root?null:n,t);return n.refreshPromise&&(await this.root.refreshPromise,await q.toPromise(this._onDidRender.event)),i}toggleCollapsed(e,t=!1){return this.tree.toggleCollapsed(this.getDataNode(e),t)}expandAll(){this.tree.expandAll()}async expandTo(e){if(!this.dataSource.getParent)throw new Error("Can't expand to element without getParent method");let t=[];for(;!this.hasNode(e);)e=this.dataSource.getParent(e),e!==this.root.element&&t.push(e);for(let n of Je.reverse(t))await this.expand(n);this.tree.expandTo(this.getDataNode(e))}collapseAll(){this.tree.collapseAll()}isCollapsible(e){return this.tree.isCollapsible(this.getDataNode(e))}isCollapsed(e){return this.tree.isCollapsed(this.getDataNode(e))}triggerTypeNavigation(){this.tree.triggerTypeNavigation()}openFind(){this.tree.openFind()}closeFind(){this.tree.closeFind()}refilter(){this.tree.refilter()}setAnchor(e){this.tree.setAnchor(typeof e>"u"?void 0:this.getDataNode(e))}getAnchor(){return this.tree.getAnchor()?.element}setSelection(e,t){let n=e.map(i=>this.getDataNode(i));this.tree.setSelection(n,t)}getSelection(){return this.tree.getSelection().map(t=>t.element)}setFocus(e,t){let n=e.map(i=>this.getDataNode(i));this.tree.setFocus(n,t)}focusNext(e=1,t=!1,n){this.tree.focusNext(e,t,n)}focusPrevious(e=1,t=!1,n){this.tree.focusPrevious(e,t,n)}focusNextPage(e){return this.tree.focusNextPage(e)}focusPreviousPage(e){return this.tree.focusPreviousPage(e)}focusLast(e){this.tree.focusLast(e)}focusFirst(e){this.tree.focusFirst(e)}getFocus(){return this.tree.getFocus().map(t=>t.element)}getStickyScrollFocus(){return this.tree.getStickyScrollFocus().map(t=>t.element)}getFocusedPart(){return this.tree.getFocusedPart()}reveal(e,t){this.tree.reveal(this.getDataNode(e),t)}getRelativeTop(e){return this.tree.getRelativeTop(this.getDataNode(e))}getParentElement(e){let t=this.tree.getParentElement(this.getDataNode(e));return t&&t.element}getFirstElementChild(e=this.root.element){let t=this.getDataNode(e),n=this.tree.getFirstElementChild(t===this.root?null:t);return n&&n.element}getDataNode(e){let t=this.nodes.get(e===this.root.element?null:e);if(!t)throw new dn(this.user,`Data tree node not found: ${e}`);return t}async refreshAndRenderNode(e,t,n,i){await this.refreshNode(e,t,n),!this.disposables.isDisposed&&this.render(e,n,i)}async refreshNode(e,t,n){let i;if(this.subTreeRefreshPromises.forEach((r,s)=>{!i&&J6(s,e)&&(i=r.then(()=>this.refreshNode(e,t,n)))}),i)return i;if(e!==this.root&&this.tree.getNode(e).collapsed){e.hasChildren=!!this.dataSource.hasChildren(e.element),e.stale=!0,this.setChildren(e,[],t,n);return}return this.doRefreshSubTree(e,t,n)}async doRefreshSubTree(e,t,n){let i;e.refreshPromise=new Promise(r=>i=r),this.subTreeRefreshPromises.set(e,e.refreshPromise),e.refreshPromise.finally(()=>{e.refreshPromise=void 0,this.subTreeRefreshPromises.delete(e)});try{let r=await this.doRefreshNode(e,t,n);e.stale=!1,await Po.settled(r.map(s=>this.doRefreshSubTree(s,t,n)))}finally{i()}}async doRefreshNode(e,t,n){e.hasChildren=!!this.dataSource.hasChildren(e.element);let i;if(!e.hasChildren)i=Promise.resolve(Je.empty());else{let r=this.doGetChildren(e);if(iL(r))i=Promise.resolve(r);else{let s=wi(800);s.then(()=>{e.slow=!0,this._onDidChangeNodeSlowState.fire(e)},a=>null),i=r.finally(()=>s.cancel())}}try{let r=await i;return this.setChildren(e,r,t,n)}catch(r){if(e!==this.root&&this.tree.hasElement(e)&&this.tree.collapse(e),Sy(r))return[];throw r}finally{e.slow&&(e.slow=!1,this._onDidChangeNodeSlowState.fire(e))}}doGetChildren(e){let t=this.refreshPromises.get(e);if(t)return t;let n=this.dataSource.getChildren(e.element);return iL(n)?this.processChildren(n):(t=Sl(async()=>this.processChildren(await n)),this.refreshPromises.set(e,t),t.finally(()=>{this.refreshPromises.delete(e)}))}_onDidChangeCollapseState({node:e,deep:t}){e.element!==null&&!e.collapsed&&e.element.stale&&(t?this.collapse(e.element.element):this.refreshAndRenderNode(e.element,!1).catch(qe))}setChildren(e,t,n,i){let r=[...t];if(e.children.length===0&&r.length===0)return[];let s=new Map,a=new Map;for(let c of e.children)s.set(c.element,c),this.identityProvider&&a.set(c.id,{node:c,collapsed:this.tree.hasElement(c)&&this.tree.isCollapsed(c)});let l=[],d=r.map(c=>{let u=!!this.dataSource.hasChildren(c);if(!this.identityProvider){let g=K1({element:c,parent:e,hasChildren:u,defaultCollapseState:this.getDefaultCollapseState(c)});return u&&g.defaultCollapseState===2&&l.push(g),g}let p=this.identityProvider.getId(c).toString(),h=a.get(p);if(h){let g=h.node;return s.delete(g.element),this.nodes.delete(g.element),this.nodes.set(c,g),g.element=c,g.hasChildren=u,n?h.collapsed?(g.children.forEach(b=>X1(b,v=>this.nodes.delete(v.element))),g.children.splice(0,g.children.length),g.stale=!0):l.push(g):u&&!h.collapsed&&l.push(g),g}let f=K1({element:c,parent:e,id:p,hasChildren:u,defaultCollapseState:this.getDefaultCollapseState(c)});return i&&i.viewState.focus&&i.viewState.focus.indexOf(p)>-1&&i.focus.push(f),i&&i.viewState.selection&&i.viewState.selection.indexOf(p)>-1&&i.selection.push(f),(i&&i.viewState.expanded&&i.viewState.expanded.indexOf(p)>-1||u&&f.defaultCollapseState===2)&&l.push(f),f});for(let c of s.values())X1(c,u=>this.nodes.delete(u.element));for(let c of d)this.nodes.set(c.element,c);return e.children.splice(0,e.children.length,...d),e!==this.root&&this.autoExpandSingleChildren&&d.length===1&&l.length===0&&(d[0].forceExpanded=!0,l.push(d[0])),l}render(e,t,n){let i=e.children.map(s=>this.asTreeElement(s,t)),r=n&&{...n,diffIdentityProvider:n.diffIdentityProvider&&{getId(s){return n.diffIdentityProvider.getId(s.element)}}};this.tree.setChildren(e===this.root?null:e,i,r),e!==this.root&&this.tree.setCollapsible(e,e.hasChildren),this._onDidRender.fire()}asTreeElement(e,t){if(e.stale)return{element:e,collapsible:e.hasChildren,collapsed:!0};let n;return t&&t.viewState.expanded&&e.id&&t.viewState.expanded.indexOf(e.id)>-1?n=!1:e.forceExpanded?(n=!1,e.forceExpanded=!1):n=e.defaultCollapseState,{element:e,children:e.hasChildren?Je.map(e.children,i=>this.asTreeElement(i,t)):[],collapsible:e.hasChildren,collapsed:n}}processChildren(e){return this.sorter&&(e=[...e].sort(this.sorter.compare.bind(this.sorter))),e}getViewState(){if(!this.identityProvider)throw new dn(this.user,"Can't get tree view state without an identity provider");let e=a=>this.identityProvider.getId(a).toString(),t=this.getFocus().map(e),n=this.getSelection().map(e),i=[],r=this.tree.getNode(),s=[r];for(;s.length>0;){let a=s.pop();a!==r&&a.collapsible&&!a.collapsed&&i.push(e(a.element.element)),s.push(...a.children)}return{focus:t,selection:n,expanded:i,scrollTop:this.scrollTop}}dispose(){this.disposables.dispose(),this.tree.dispose()}},Q1=class o{constructor(e){this.node=e}get element(){return{elements:this.node.element.elements.map(e=>e.element),incompressible:this.node.element.incompressible}}get children(){return this.node.children.map(e=>new o(e))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}},J1=class{constructor(e,t,n,i){this.renderer=e;this.nodeMapper=t;this.compressibleNodeMapperProvider=n;this.onDidChangeTwistieState=i;this.templateId=e.templateId}templateId;renderedNodes=new Map;disposables=[];renderTemplate(e){return{templateData:this.renderer.renderTemplate(e)}}renderElement(e,t,n,i){this.renderer.renderElement(this.nodeMapper.map(e),t,n.templateData,i)}renderCompressedElements(e,t,n,i){this.renderer.renderCompressedElements(this.compressibleNodeMapperProvider().map(e),t,n.templateData,i)}renderTwistie(e,t){return e.slow?(t.classList.add(...we.asClassNameArray(te.treeItemLoading)),!0):(t.classList.remove(...we.asClassNameArray(te.treeItemLoading)),!1)}disposeElement(e,t,n,i){this.renderer.disposeElement?.(this.nodeMapper.map(e),t,n.templateData,i)}disposeCompressedElements(e,t,n,i){this.renderer.disposeCompressedElements?.(this.compressibleNodeMapperProvider().map(e),t,n.templateData,i)}disposeTemplate(e){this.renderer.disposeTemplate(e.templateData)}dispose(){this.renderedNodes.clear(),this.disposables=wt(this.disposables)}};function tK(o){let e=o&&rH(o);return e&&{...e,keyboardNavigationLabelProvider:e.keyboardNavigationLabelProvider&&{...e.keyboardNavigationLabelProvider,getCompressedNodeKeyboardNavigationLabel(t){return o.keyboardNavigationLabelProvider.getCompressedNodeKeyboardNavigationLabel(t.map(n=>n.element))}}}}var GE=class extends Xb{constructor(t,n,i,r,s,a,l={}){super(t,n,i,s,a,l);this.compressionDelegate=r;this.filter=l.filter}compressibleNodeMapper=new Hu(t=>new Q1(t));filter;createTree(t,n,i,r,s){let a=new mm(i),l=r.map(c=>new J1(c,this.nodeMapper,()=>this.compressibleNodeMapper,this._onDidChangeNodeSlowState.event)),d=tK(s)||{};return new fm(t,n,a,l,d)}asTreeElement(t,n){return{incompressible:this.compressionDelegate.isIncompressible(t.element),...super.asTreeElement(t,n)}}updateOptions(t={}){this.tree.updateOptions(t)}getViewState(){if(!this.identityProvider)throw new dn(this.user,"Can't get tree view state without an identity provider");let t=l=>this.identityProvider.getId(l).toString(),n=this.getFocus().map(t),i=this.getSelection().map(t),r=[],s=this.tree.getCompressedTreeNode(),a=[s];for(;a.length>0;){let l=a.pop();if(l!==s&&l.collapsible&&!l.collapsed)for(let d of l.element.elements)r.push(t(d.element));a.push(...l.children)}return{focus:n,selection:i,expanded:r,scrollTop:this.scrollTop}}render(t,n,i){if(!this.identityProvider)return super.render(t,n);let r=f=>this.identityProvider.getId(f).toString(),s=f=>{let g=new Set;for(let b of f){let v=this.tree.getCompressedTreeNode(b===this.root?null:b);if(v.element)for(let y of v.element.elements)g.add(r(y.element))}return g},a=s(this.tree.getSelection()),l=s(this.tree.getFocus());super.render(t,n,i);let d=this.getSelection(),c=!1,u=this.getFocus(),p=!1,h=f=>{let g=f.element;if(g)for(let b=0;b<g.elements.length;b++){let v=r(g.elements[b].element),y=g.elements[g.elements.length-1].element;a.has(v)&&d.indexOf(y)===-1&&(d.push(y),c=!0),l.has(v)&&u.indexOf(y)===-1&&(u.push(y),p=!0)}f.children.forEach(h)};h(this.tree.getCompressedTreeNode(t===this.root?null:t)),c&&this.setSelection(d),p&&this.setFocus(u)}processChildren(t){return this.filter&&(t=Je.filter(t,n=>{let i=this.filter.filter(n,1),r=nK(i);if(r===2)throw new Error("Recursive tree visibility not supported in async data compressed trees");return r===1})),super.processChildren(t)}};function nK(o){return typeof o=="boolean"?o?1:0:Yb(o)?Uu(o.visibility):Uu(o)}var jE=class extends gm{constructor(t,n,i,r,s,a={}){super(t,n,i,r,a);this.user=t;this.dataSource=s;this.identityProvider=a.identityProvider}input;identityProvider;nodesByIdentity=new Map;getInput(){return this.input}setInput(t,n){if(n&&!this.identityProvider)throw new dn(this.user,"Can't restore tree view state without an identity provider");if(this.input=t,!t){this.nodesByIdentity.clear(),this.model.setChildren(null,Je.empty());return}if(!n){this._refresh(t);return}let i=[],r=[],s=l=>{let d=this.identityProvider.getId(l).toString();return!n.expanded[d]},a=l=>{let d=this.identityProvider.getId(l.element).toString();n.focus.has(d)&&i.push(l.element),n.selection.has(d)&&r.push(l.element)};this._refresh(t,s,a),this.setFocus(i),this.setSelection(r),n&&typeof n.scrollTop=="number"&&(this.scrollTop=n.scrollTop)}updateChildren(t=this.input){if(typeof this.input>"u")throw new dn(this.user,"Tree input not set");let n;this.identityProvider&&(n=i=>{let r=this.identityProvider.getId(i).toString(),s=this.nodesByIdentity.get(r);if(s)return s.collapsed}),this._refresh(t,n)}resort(t=this.input,n=!0){this.model.resort(t===this.input?null:t,n)}refresh(t){if(t===void 0){this.view.rerender();return}this.model.rerender(t)}_refresh(t,n,i){let r;if(this.identityProvider){let s=new Set,a=i;i=l=>{let d=this.identityProvider.getId(l.element).toString();s.add(d),this.nodesByIdentity.set(d,l),a?.(l)},r=l=>{let d=this.identityProvider.getId(l.element).toString();s.has(d)||this.nodesByIdentity.delete(d)}}this.model.setChildren(t===this.input?null:t,this.iterate(t,n).elements,{onDidCreateNode:i,onDidDeleteNode:r})}iterate(t,n){let i=[...this.dataSource.getChildren(t)];return{elements:Je.map(i,s=>{let{elements:a,size:l}=this.iterate(s,n),d=this.dataSource.hasChildren?this.dataSource.hasChildren(s):void 0,c=l===0?void 0:n&&n(s);return{element:s,children:a,collapsible:d,collapsed:c}}),size:i.length}}createModel(t,n){return new cc(t,n)}};var q5e=new $("isMac",Ve,m("isMac","Whether the operating system is macOS")),$5e=new $("isLinux",At,m("isLinux","Whether the operating system is Linux")),Y5e=new $("isWindows",pt,m("isWindows","Whether the operating system is Windows")),Z5e=new $("isWeb",Hn,m("isWeb","Whether the platform is a web browser")),X5e=new $("isMacNative",Ve&&!Hn,m("isMacNative","Whether the operating system is macOS on a non-browser platform")),Q5e=new $("isIOS",jr,m("isIOS","Whether the operating system is iOS")),J5e=new $("isMobile",ky,m("isMobile","Whether the platform is a mobile web browser")),eze=new $("isDevelopment",!1,!0),tze=new $("productQualityType","",m("productQualityType","Quality type of VS Code")),eM="inputFocus",nze=new $(eM,!1,m("inputFocus","Whether keyboard focus is inside an input box"));var qE=Y("contextViewService"),Al=Y("contextMenuService");var oi=Y("keybindingService");var tM=class extends ko{_element;boxContainer;_label;contents;visible;_onDidChangeVisibility=this._register(new D);onDidChangeVisibility=this._onDidChangeVisibility.event;hover;constructor(e,t){super(),this._element=dt(e,Ge(".monaco-dropdown")),this._label=dt(this._element,Ge(".dropdown-label"));let n=t.labelRenderer;n||(n=r=>(r.textContent=t.label||"",null));for(let r of[me.CLICK,me.MOUSE_DOWN,Et.Tap])this._register(j(this.element,r,s=>st.stop(s,!0)));for(let r of[me.MOUSE_DOWN,Et.Tap])this._register(j(this._label,r,s=>{CS(s)&&(s.detail>1||s.button!==0)||(this.visible?this.hide():this.show())}));this._register(j(this._label,me.KEY_UP,r=>{let s=new mt(r);(s.equals(3)||s.equals(10))&&(st.stop(r,!0),this.visible?this.hide():this.show())}));let i=n(this._label);i&&this._register(i),this._register(An.addTarget(this._label))}get element(){return this._element}get label(){return this._label}set tooltip(e){this._label&&(!this.hover&&e!==""?this.hover=this._register(xo().setupManagedHover(Fn("mouse"),this._label,e)):this.hover&&this.hover.update(e))}show(){this.visible||(this.visible=!0,this._onDidChangeVisibility.fire(!0))}hide(){this.visible&&(this.visible=!1,this._onDidChangeVisibility.fire(!1))}isVisible(){return!!this.visible}onEvent(e,t){this.hide()}dispose(){super.dispose(),this.hide(),this.boxContainer&&(this.boxContainer.remove(),this.boxContainer=void 0),this.contents&&(this.contents.remove(),this.contents=void 0),this._label&&(this._label.remove(),this._label=void 0)}},$E=class extends tM{constructor(t,n){super(t,n);this._options=n;this.actions=n.actions||[]}_menuOptions;_actions=[];set menuOptions(t){this._menuOptions=t}get menuOptions(){return this._menuOptions}get actions(){return this._options.actionProvider?this._options.actionProvider.getActions():this._actions}set actions(t){this._actions=t}show(){super.show(),this.element.classList.add("active"),this._options.contextMenuProvider.showContextMenu({getAnchor:()=>this.element,getActions:()=>this.actions,getActionsContext:()=>this.menuOptions?this.menuOptions.context:null,getActionViewItem:(t,n)=>this.menuOptions&&this.menuOptions.actionViewItemProvider?this.menuOptions.actionViewItemProvider(t,n):void 0,getKeyBinding:t=>this.menuOptions&&this.menuOptions.getKeyBinding?this.menuOptions.getKeyBinding(t):void 0,getMenuClassName:()=>this._options.menuClassName||"",onHide:()=>this.onHide(),actionRunner:this.menuOptions?this.menuOptions.actionRunner:void 0,anchorAlignment:this.menuOptions?this.menuOptions.anchorAlignment:0,domForShadowRoot:this._options.menuAsChild?this.element:void 0,skipTelemetry:this._options.skipTelemetry})}hide(){super.hide()}onHide(){this.hide(),this.element.classList.remove("active")}};var s8e={buttonBackground:"#0E639C",buttonHoverBackground:"#006BB3",buttonSeparator:H.white.toString(),buttonForeground:H.white.toString(),buttonBorder:void 0,buttonSecondaryBackground:void 0,buttonSecondaryForeground:void 0,buttonSecondaryHoverBackground:void 0};var bm=class{modifierLabels;constructor(e,t,n=t){this.modifierLabels=[null],this.modifierLabels[2]=e,this.modifierLabels[1]=t,this.modifierLabels[3]=n}toLabel(e,t,n){if(t.length===0)return null;let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r],l=n(a);if(l===null)return null;i[r]=oK(a,l,this.modifierLabels[e])}return i.join(" ")}},nM=new bm({ctrlKey:"\u2303",shiftKey:"\u21E7",altKey:"\u2325",metaKey:"\u2318",separator:""},{ctrlKey:m({key:"ctrlKey",comment:["This is the short form for the Control key on the keyboard"]},"Ctrl"),shiftKey:m({key:"shiftKey",comment:["This is the short form for the Shift key on the keyboard"]},"Shift"),altKey:m({key:"altKey",comment:["This is the short form for the Alt key on the keyboard"]},"Alt"),metaKey:m({key:"windowsKey",comment:["This is the short form for the Windows key on the keyboard"]},"Windows"),separator:"+"},{ctrlKey:m({key:"ctrlKey",comment:["This is the short form for the Control key on the keyboard"]},"Ctrl"),shiftKey:m({key:"shiftKey",comment:["This is the short form for the Shift key on the keyboard"]},"Shift"),altKey:m({key:"altKey",comment:["This is the short form for the Alt key on the keyboard"]},"Alt"),metaKey:m({key:"superKey",comment:["This is the short form for the Super key on the keyboard"]},"Super"),separator:"+"}),u8e=new bm({ctrlKey:m({key:"ctrlKey.long",comment:["This is the long form for the Control key on the keyboard"]},"Control"),shiftKey:m({key:"shiftKey.long",comment:["This is the long form for the Shift key on the keyboard"]},"Shift"),altKey:m({key:"optKey.long",comment:["This is the long form for the Alt/Option key on the keyboard"]},"Option"),metaKey:m({key:"cmdKey.long",comment:["This is the long form for the Command key on the keyboard"]},"Command"),separator:"+"},{ctrlKey:m({key:"ctrlKey.long",comment:["This is the long form for the Control key on the keyboard"]},"Control"),shiftKey:m({key:"shiftKey.long",comment:["This is the long form for the Shift key on the keyboard"]},"Shift"),altKey:m({key:"altKey.long",comment:["This is the long form for the Alt key on the keyboard"]},"Alt"),metaKey:m({key:"windowsKey.long",comment:["This is the long form for the Windows key on the keyboard"]},"Windows"),separator:"+"},{ctrlKey:m({key:"ctrlKey.long",comment:["This is the long form for the Control key on the keyboard"]},"Control"),shiftKey:m({key:"shiftKey.long",comment:["This is the long form for the Shift key on the keyboard"]},"Shift"),altKey:m({key:"altKey.long",comment:["This is the long form for the Alt key on the keyboard"]},"Alt"),metaKey:m({key:"superKey.long",comment:["This is the long form for the Super key on the keyboard"]},"Super"),separator:"+"}),p8e=new bm({ctrlKey:"Ctrl",shiftKey:"Shift",altKey:"Alt",metaKey:"Cmd",separator:"+"},{ctrlKey:"Ctrl",shiftKey:"Shift",altKey:"Alt",metaKey:"Super",separator:"+"}),h8e=new bm({ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"cmd",separator:"+"},{ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"win",separator:"+"},{ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"meta",separator:"+"});function oK(o,e,t){if(e===null)return"";let n=[];return o.ctrlKey&&n.push(t.ctrlKey),o.shiftKey&&n.push(t.shiftKey),o.altKey&&n.push(t.altKey),o.metaKey&&n.push(t.metaKey),e!==""&&n.push(e),n.join(t.separator)}var aH="\u2026",Qb="\\\\",Jb="~";function lH(o,e=ui){let t=new Array(o.length),n=!1;for(let i=0;i<o.length;i++){let r=o[i];if(r===""){t[i]=`.${e}`;continue}if(!r){t[i]=r;continue}n=!0;let s="",a=r;a.indexOf(Qb)===0?(s=a.substr(0,a.indexOf(Qb)+Qb.length),a=a.substr(a.indexOf(Qb)+Qb.length)):a.indexOf(e)===0?(s=a.substr(0,a.indexOf(e)+e.length),a=a.substr(a.indexOf(e)+e.length)):a.indexOf(Jb)===0&&(s=a.substr(0,a.indexOf(Jb)+Jb.length),a=a.substr(a.indexOf(Jb)+Jb.length));let l=a.split(e);for(let d=1;n&&d<=l.length;d++)for(let c=l.length-d;n&&c>=0;c--){n=!1;let u=l.slice(c,c+d).join(e);for(let p=0;!n&&p<o.length;p++)if(p!==i&&o[p]&&o[p].indexOf(u)>-1){let h=c+d===l.length,f=c>0&&o[p].indexOf(e)>-1?e+u:u,g=o[p].endsWith(f);n=!h||g}if(!n){let p="";(l[0].endsWith(":")||s!=="")&&(c===1&&(c=0,d++,u=l[0]+e+u),c>0&&(p=l[0]+e),p=s+p),c>0&&(p=p+aH+e),p=p+u,c+d<l.length&&(p=p+e+aH),t[i]=p}}n&&(t[i]=r)}return t}function sK(o,e){let t={...e};for(let n in o){let i=o[n];t[n]=i!==void 0?ce(i):void 0}return t}var F6e={keybindingLabelBackground:ce(j2),keybindingLabelForeground:ce(q2),keybindingLabelBorder:ce($2),keybindingLabelBottomBorder:ce(Y2),keybindingLabelShadow:ce(Xh)};var B6e={buttonForeground:ce(Fk),buttonSeparator:ce(M2),buttonBackground:ce(Qh),buttonHoverBackground:ce(P2),buttonSecondaryForeground:ce(N2),buttonSecondaryBackground:ce(BS),buttonSecondaryHoverBackground:ce(A2),buttonBorder:ce(O2)};var V6e={progressBarBackground:ce(ZV)};var aK={inputActiveOptionBorder:ce(Ok),inputActiveOptionForeground:ce(Ak),inputActiveOptionBackground:ce(Nk)},W6e={activeForeground:ce(Jh),activeBackground:ce(F2),activeBorder:ce(B2),inactiveForeground:ce(V2),inactiveBackground:ce(W2),inactiveBorder:ce(H2),inactiveHoverBackground:ce(U2)};var H6e={checkboxBackground:ce(z2),checkboxBorder:ce(G2),checkboxForeground:ce(K2)};var U6e={dialogBackground:ce(ki),dialogForeground:ce(La),dialogShadow:ce(Xh),dialogBorder:ce(Ee),errorIconForeground:ce(m2),warningIconForeground:ce(g2),infoIconForeground:ce(f2),textLinkForeground:ce(MS)};var lK={inputBackground:ce(I2),inputForeground:ce(C2),inputBorder:ce(em),inputValidationInfoBorder:ce(T2),inputValidationInfoBackground:ce(S2),inputValidationInfoForeground:ce(E2),inputValidationWarningBorder:ce(_2),inputValidationWarningBackground:ce(x2),inputValidationWarningForeground:ce(w2),inputValidationErrorBorder:ce(R2),inputValidationErrorBackground:ce(D2),inputValidationErrorForeground:ce(L2)};var dH={listFilterWidgetBackground:ce(aW),listFilterWidgetOutline:ce(lW),listFilterWidgetNoMatchesOutline:ce(dW),listFilterWidgetShadow:ce(cW),inputBoxStyles:lK,toggleStyles:aK},z6e={badgeBackground:ce(Gh),badgeForeground:ce(YV),badgeBorder:ce(Ee)};var K6e={breadcrumbsBackground:ce(u2),breadcrumbsForeground:ce(c2),breadcrumbsHoverForeground:ce(kk),breadcrumbsFocusForeground:ce(kk),breadcrumbsFocusAndSelectionForeground:ce(p2)};var vm={listBackground:void 0,listInactiveFocusForeground:void 0,listFocusBackground:ce(Z2),listFocusForeground:ce(X2),listFocusOutline:ce(Q2),listActiveSelectionBackground:ce(zo),listActiveSelectionForeground:ce(Ra),listActiveSelectionIconForeground:ce(WS),listFocusAndSelectionOutline:ce(J2),listFocusAndSelectionBackground:ce(zo),listFocusAndSelectionForeground:ce(Ra),listInactiveSelectionBackground:ce(eW),listInactiveSelectionIconForeground:ce(nW),listInactiveSelectionForeground:ce(tW),listInactiveFocusBackground:ce(iW),listInactiveFocusOutline:ce(oW),listHoverBackground:ce(Bk),listHoverForeground:ce(Vk),listDropOverBackground:ce(rW),listDropBetweenBackground:ce(sW),listSelectionOutline:ce(Pt),listHoverOutline:ce(Pt),treeIndentGuidesStroke:ce(nm),treeInactiveIndentGuidesStroke:ce(uW),treeStickyScrollBackground:void 0,treeStickyScrollBorder:void 0,treeStickyScrollShadow:ce(Jd),tableColumnsBorder:ce(pW),tableOddRowsBackgroundColor:ce(hW)};function ev(o){return sK(o,vm)}var cH={selectBackground:ce(tm),selectListBackground:ce(k2),selectForeground:ce(Ob),decoratorRightForeground:ce(SW),selectBorder:ce(Nb),focusBorder:ce(so),listFocusBackground:ce(xW),listInactiveSelectionIconForeground:ce(TW),listFocusForeground:ce(EW),listFocusOutline:GV(Pt,H.transparent.toString()),listHoverBackground:ce(Bk),listHoverForeground:ce(Vk),listHoverOutline:ce(Pt),selectListBorder:ce(Rk),listBackground:void 0,listActiveSelectionBackground:void 0,listActiveSelectionForeground:void 0,listActiveSelectionIconForeground:void 0,listFocusAndSelectionBackground:void 0,listDropOverBackground:void 0,listDropBetweenBackground:void 0,listInactiveSelectionBackground:void 0,listInactiveSelectionForeground:void 0,listInactiveFocusBackground:void 0,listInactiveFocusOutline:void 0,listSelectionOutline:void 0,listFocusAndSelectionForeground:void 0,listFocusAndSelectionOutline:void 0,listInactiveFocusForeground:void 0,tableColumnsBorder:void 0,tableOddRowsBackgroundColor:void 0,treeIndentGuidesStroke:void 0,treeInactiveIndentGuidesStroke:void 0,treeStickyScrollBackground:void 0,treeStickyScrollBorder:void 0,treeStickyScrollShadow:void 0};var G6e={shadowColor:ce(Xh),borderColor:ce(mW),foregroundColor:ce(gW),backgroundColor:ce(fW),selectionForegroundColor:ce(bW),selectionBackgroundColor:ce(vW),selectionBorderColor:ce(yW),separatorColor:ce(IW),scrollbarShadow:ce(Jd),scrollbarSliderBackground:ce(PS),scrollbarSliderHoverBackground:ce(OS),scrollbarSliderActiveBackground:ce(NS)};var Va=Y("listService");var tv=new $("listScrollAtBoundary","none"),pGe=Kt.or(tv.isEqualTo("top"),tv.isEqualTo("both")),hGe=Kt.or(tv.isEqualTo("bottom"),tv.isEqualTo("both")),uH=new $("listFocus",!0),pH=new $("treestickyScrollFocused",!1),cT=new $("listSupportsMultiselect",!0),mGe=Kt.and(uH,Kt.not(eM),pH.negate()),sM=new $("listHasSelectionOrFocus",!1),aM=new $("listDoubleSelection",!1),lM=new $("listMultiSelection",!1),uT=new $("listSelectionNavigation",!1),dK=new $("listSupportsFind",!0),cK=new $("treeElementCanCollapse",!1),uK=new $("treeElementHasParent",!1),pK=new $("treeElementCanExpand",!1),hK=new $("treeElementHasChild",!1),mK=new $("treeFindOpen",!1),hH="listTypeNavigationMode",mH="listAutomaticKeyboardNavigation";function pT(o,e){let t=o.createScoped(e.getHTMLElement());return uH.bindTo(t),t}function hT(o,e){let t=tv.bindTo(o),n=()=>{let i=e.scrollTop===0,r=e.scrollHeight-e.renderHeight-e.scrollTop<1;i&&r?t.set("both"):i?t.set("top"):r?t.set("bottom"):t.set("none")};return n(),e.onDidScroll(n)}var Ku="workbench.list.multiSelectModifier",iT="workbench.list.openMode",Wr="workbench.list.horizontalScrolling",dM="workbench.list.defaultFindMode",cM="workbench.list.typeNavigationMode",oT="workbench.list.keyboardNavigation",Hs="workbench.list.scrollByPage",uM="workbench.list.defaultFindMatchType",nv="workbench.tree.indent",rT="workbench.tree.renderIndentGuides",Us="workbench.list.smoothScrolling",Aa="workbench.list.mouseWheelScrollSensitivity",Fa="workbench.list.fastScrollSensitivity",sT="workbench.tree.expandMode",aT="workbench.tree.enableStickyScroll",lT="workbench.tree.stickyScrollMaxItemCount";function Ba(o){return o.getValue(Ku)==="alt"}var iM=class extends F{constructor(t){super();this.configurationService=t;this.useAltAsMultipleSelectionModifier=Ba(t),this.registerListeners()}useAltAsMultipleSelectionModifier;registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(t=>{t.affectsConfiguration(Ku)&&(this.useAltAsMultipleSelectionModifier=Ba(this.configurationService))}))}isSelectionSingleChangeEvent(t){return this.useAltAsMultipleSelectionModifier?t.browserEvent.altKey:o1(t)}isSelectionRangeChangeEvent(t){return r1(t)}};function mT(o,e){let t=o.get(ut),n=o.get(oi),i=new ee;return[{...e,keyboardNavigationDelegate:{mightProducePrintableCharacter(s){return n.mightProducePrintableCharacter(s)}},smoothScrolling:!!t.getValue(Us),mouseWheelScrollSensitivity:t.getValue(Aa),fastScrollSensitivity:t.getValue(Fa),multipleSelectionController:e.multipleSelectionController??i.add(new iM(t)),keyboardNavigationEventFilter:gK(n),scrollByPage:!!t.getValue(Hs)},i]}var YE=class extends ii{contextKeyService;listSupportsMultiSelect;listHasSelectionOrFocus;listDoubleSelection;listMultiSelection;horizontalScrolling;_useAltAsMultipleSelectionModifier;navigator;get onDidOpen(){return this.navigator.onDidOpen}constructor(e,t,n,i,r,s,a,l,d){let c=typeof r.horizontalScrolling<"u"?r.horizontalScrolling:!!l.getValue(Wr),[u,p]=d.invokeFunction(mT,r);super(e,t,n,i,{keyboardSupport:!1,...u,horizontalScrolling:c}),this.disposables.add(p),this.contextKeyService=pT(s,this),this.disposables.add(hT(this.contextKeyService,this)),this.listSupportsMultiSelect=cT.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(r.multipleSelectionSupport!==!1),uT.bindTo(this.contextKeyService).set(!!r.selectionNavigation),this.listHasSelectionOrFocus=sM.bindTo(this.contextKeyService),this.listDoubleSelection=aM.bindTo(this.contextKeyService),this.listMultiSelection=lM.bindTo(this.contextKeyService),this.horizontalScrolling=r.horizontalScrolling,this._useAltAsMultipleSelectionModifier=Ba(l),this.disposables.add(this.contextKeyService),this.disposables.add(a.register(this)),this.updateStyles(r.overrideStyles),this.disposables.add(this.onDidChangeSelection(()=>{let f=this.getSelection(),g=this.getFocus();this.contextKeyService.bufferChangeEvents(()=>{this.listHasSelectionOrFocus.set(f.length>0||g.length>0),this.listMultiSelection.set(f.length>1),this.listDoubleSelection.set(f.length===2)})})),this.disposables.add(this.onDidChangeFocus(()=>{let f=this.getSelection(),g=this.getFocus();this.listHasSelectionOrFocus.set(f.length>0||g.length>0)})),this.disposables.add(l.onDidChangeConfiguration(f=>{f.affectsConfiguration(Ku)&&(this._useAltAsMultipleSelectionModifier=Ba(l));let g={};if(f.affectsConfiguration(Wr)&&this.horizontalScrolling===void 0){let b=!!l.getValue(Wr);g={...g,horizontalScrolling:b}}if(f.affectsConfiguration(Hs)){let b=!!l.getValue(Hs);g={...g,scrollByPage:b}}if(f.affectsConfiguration(Us)){let b=!!l.getValue(Us);g={...g,smoothScrolling:b}}if(f.affectsConfiguration(Aa)){let b=l.getValue(Aa);g={...g,mouseWheelScrollSensitivity:b}}if(f.affectsConfiguration(Fa)){let b=l.getValue(Fa);g={...g,fastScrollSensitivity:b}}Object.keys(g).length>0&&this.updateOptions(g)})),this.navigator=new dT(this,{configurationService:l,...r}),this.disposables.add(this.navigator)}updateOptions(e){super.updateOptions(e),e.overrideStyles!==void 0&&this.updateStyles(e.overrideStyles),e.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!e.multipleSelectionSupport)}updateStyles(e){this.style(e?ev(e):vm)}get useAltAsMultipleSelectionModifier(){return this._useAltAsMultipleSelectionModifier}};YE=O([x(5,_t),x(6,Va),x(7,ut),x(8,Oe)],YE);var ZE=class extends yE{contextKeyService;disposables;listSupportsMultiSelect;_useAltAsMultipleSelectionModifier;horizontalScrolling;navigator;get onDidOpen(){return this.navigator.onDidOpen}constructor(e,t,n,i,r,s,a,l,d){let c=typeof r.horizontalScrolling<"u"?r.horizontalScrolling:!!l.getValue(Wr),[u,p]=d.invokeFunction(mT,r);super(e,t,n,i,{keyboardSupport:!1,...u,horizontalScrolling:c}),this.disposables=new ee,this.disposables.add(p),this.contextKeyService=pT(s,this),this.disposables.add(hT(this.contextKeyService,this.widget)),this.horizontalScrolling=r.horizontalScrolling,this.listSupportsMultiSelect=cT.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(r.multipleSelectionSupport!==!1),uT.bindTo(this.contextKeyService).set(!!r.selectionNavigation),this._useAltAsMultipleSelectionModifier=Ba(l),this.disposables.add(this.contextKeyService),this.disposables.add(a.register(this)),this.updateStyles(r.overrideStyles),this.disposables.add(l.onDidChangeConfiguration(f=>{f.affectsConfiguration(Ku)&&(this._useAltAsMultipleSelectionModifier=Ba(l));let g={};if(f.affectsConfiguration(Wr)&&this.horizontalScrolling===void 0){let b=!!l.getValue(Wr);g={...g,horizontalScrolling:b}}if(f.affectsConfiguration(Hs)){let b=!!l.getValue(Hs);g={...g,scrollByPage:b}}if(f.affectsConfiguration(Us)){let b=!!l.getValue(Us);g={...g,smoothScrolling:b}}if(f.affectsConfiguration(Aa)){let b=l.getValue(Aa);g={...g,mouseWheelScrollSensitivity:b}}if(f.affectsConfiguration(Fa)){let b=l.getValue(Fa);g={...g,fastScrollSensitivity:b}}Object.keys(g).length>0&&this.updateOptions(g)})),this.navigator=new dT(this,{configurationService:l,...r}),this.disposables.add(this.navigator)}updateOptions(e){super.updateOptions(e),e.overrideStyles!==void 0&&this.updateStyles(e.overrideStyles),e.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!e.multipleSelectionSupport)}updateStyles(e){this.style(e?ev(e):vm)}get useAltAsMultipleSelectionModifier(){return this._useAltAsMultipleSelectionModifier}dispose(){this.disposables.dispose(),super.dispose()}};ZE=O([x(5,_t),x(6,Va),x(7,ut),x(8,Oe)],ZE);var XE=class extends SE{contextKeyService;listSupportsMultiSelect;listHasSelectionOrFocus;listDoubleSelection;listMultiSelection;horizontalScrolling;_useAltAsMultipleSelectionModifier;navigator;get onDidOpen(){return this.navigator.onDidOpen}constructor(e,t,n,i,r,s,a,l,d,c){let u=typeof s.horizontalScrolling<"u"?s.horizontalScrolling:!!d.getValue(Wr),[p,h]=c.invokeFunction(mT,s);super(e,t,n,i,r,{keyboardSupport:!1,...p,horizontalScrolling:u}),this.disposables.add(h),this.contextKeyService=pT(a,this),this.disposables.add(hT(this.contextKeyService,this)),this.listSupportsMultiSelect=cT.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(s.multipleSelectionSupport!==!1),uT.bindTo(this.contextKeyService).set(!!s.selectionNavigation),this.listHasSelectionOrFocus=sM.bindTo(this.contextKeyService),this.listDoubleSelection=aM.bindTo(this.contextKeyService),this.listMultiSelection=lM.bindTo(this.contextKeyService),this.horizontalScrolling=s.horizontalScrolling,this._useAltAsMultipleSelectionModifier=Ba(d),this.disposables.add(this.contextKeyService),this.disposables.add(l.register(this)),this.updateStyles(s.overrideStyles),this.disposables.add(this.onDidChangeSelection(()=>{let g=this.getSelection(),b=this.getFocus();this.contextKeyService.bufferChangeEvents(()=>{this.listHasSelectionOrFocus.set(g.length>0||b.length>0),this.listMultiSelection.set(g.length>1),this.listDoubleSelection.set(g.length===2)})})),this.disposables.add(this.onDidChangeFocus(()=>{let g=this.getSelection(),b=this.getFocus();this.listHasSelectionOrFocus.set(g.length>0||b.length>0)})),this.disposables.add(d.onDidChangeConfiguration(g=>{g.affectsConfiguration(Ku)&&(this._useAltAsMultipleSelectionModifier=Ba(d));let b={};if(g.affectsConfiguration(Wr)&&this.horizontalScrolling===void 0){let v=!!d.getValue(Wr);b={...b,horizontalScrolling:v}}if(g.affectsConfiguration(Hs)){let v=!!d.getValue(Hs);b={...b,scrollByPage:v}}if(g.affectsConfiguration(Us)){let v=!!d.getValue(Us);b={...b,smoothScrolling:v}}if(g.affectsConfiguration(Aa)){let v=d.getValue(Aa);b={...b,mouseWheelScrollSensitivity:v}}if(g.affectsConfiguration(Fa)){let v=d.getValue(Fa);b={...b,fastScrollSensitivity:v}}Object.keys(b).length>0&&this.updateOptions(b)})),this.navigator=new oM(this,{configurationService:d,...s}),this.disposables.add(this.navigator)}updateOptions(e){super.updateOptions(e),e.overrideStyles!==void 0&&this.updateStyles(e.overrideStyles),e.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!e.multipleSelectionSupport)}updateStyles(e){this.style(e?ev(e):vm)}get useAltAsMultipleSelectionModifier(){return this._useAltAsMultipleSelectionModifier}dispose(){this.disposables.dispose(),super.dispose()}};XE=O([x(6,_t),x(7,Va),x(8,ut),x(9,Oe)],XE);var iv=class extends F{constructor(t,n){super();this.widget=t;this._register(q.filter(this.widget.onDidChangeSelection,i=>os(i.browserEvent))(i=>this.onSelectionFromKeyboard(i))),this._register(this.widget.onPointer(i=>this.onPointer(i.element,i.browserEvent))),this._register(this.widget.onMouseDblClick(i=>this.onMouseDblClick(i.element,i.browserEvent))),typeof n?.openOnSingleClick!="boolean"&&n?.configurationService?(this.openOnSingleClick=n?.configurationService.getValue(iT)!=="doubleClick",this._register(n?.configurationService.onDidChangeConfiguration(i=>{i.affectsConfiguration(iT)&&(this.openOnSingleClick=n?.configurationService.getValue(iT)!=="doubleClick")}))):this.openOnSingleClick=n?.openOnSingleClick??!0}openOnSingleClick;_onDidOpen=this._register(new D);onDidOpen=this._onDidOpen.event;onSelectionFromKeyboard(t){if(t.elements.length!==1)return;let n=t.browserEvent,i=typeof n.preserveFocus=="boolean"?n.preserveFocus:!0,r=typeof n.pinned=="boolean"?n.pinned:!i;this._open(this.getSelectedElement(),i,r,!1,t.browserEvent)}onPointer(t,n){if(!this.openOnSingleClick||n.detail===2)return;let r=n.button===1,s=!0,a=r,l=n.ctrlKey||n.metaKey||n.altKey;this._open(t,s,a,l,n)}onMouseDblClick(t,n){if(!n)return;let i=n.target;if(i.classList.contains("monaco-tl-twistie")||i.classList.contains("monaco-icon-label")&&i.classList.contains("folder-icon")&&n.offsetX<16)return;let s=!1,a=!0,l=n.ctrlKey||n.metaKey||n.altKey;this._open(t,s,a,l,n)}_open(t,n,i,r,s){t&&this._onDidOpen.fire({editorOptions:{preserveFocus:n,pinned:i,revealIfVisible:!0},sideBySide:r,element:t,browserEvent:s})}},dT=class extends iv{widget;constructor(e,t){super(e,t),this.widget=e}getSelectedElement(){return this.widget.getSelectedElements()[0]}},oM=class extends iv{constructor(e,t){super(e,t)}getSelectedElement(){return this.widget.getSelectedElements()[0]}},rM=class extends iv{constructor(e,t){super(e,t)}getSelectedElement(){return this.widget.getSelection()[0]??void 0}};function gK(o){let e=!1;return t=>{if(t.toKeyCodeChord().isModifierKey())return!1;if(e)return e=!1,!1;let n=o.softDispatch(t,t.target);return n.kind===1?(e=!0,!1):(e=!1,n.kind===0)}}var QE=class extends zu{internals;get contextKeyService(){return this.internals.contextKeyService}get useAltAsMultipleSelectionModifier(){return this.internals.useAltAsMultipleSelectionModifier}get onDidOpen(){return this.internals.onDidOpen}constructor(e,t,n,i,r,s,a,l,d){let{options:c,getTypeNavigationMode:u,disposable:p}=s.invokeFunction(ov,r);super(e,t,n,i,c),this.disposables.add(p),this.internals=new Fl(this,r,u,r.overrideStyles,a,l,d),this.disposables.add(this.internals)}updateOptions(e){super.updateOptions(e),this.internals.updateOptions(e)}};QE=O([x(5,Oe),x(6,_t),x(7,Va),x(8,ut)],QE);var JE=class extends fm{internals;get contextKeyService(){return this.internals.contextKeyService}get useAltAsMultipleSelectionModifier(){return this.internals.useAltAsMultipleSelectionModifier}get onDidOpen(){return this.internals.onDidOpen}constructor(e,t,n,i,r,s,a,l,d){let{options:c,getTypeNavigationMode:u,disposable:p}=s.invokeFunction(ov,r);super(e,t,n,i,c),this.disposables.add(p),this.internals=new Fl(this,r,u,r.overrideStyles,a,l,d),this.disposables.add(this.internals)}updateOptions(e={}){super.updateOptions(e),e.overrideStyles&&this.internals.updateStyleOverrides(e.overrideStyles),this.internals.updateOptions(e)}};JE=O([x(5,Oe),x(6,_t),x(7,Va),x(8,ut)],JE);var eT=class extends jE{internals;get contextKeyService(){return this.internals.contextKeyService}get useAltAsMultipleSelectionModifier(){return this.internals.useAltAsMultipleSelectionModifier}get onDidOpen(){return this.internals.onDidOpen}constructor(e,t,n,i,r,s,a,l,d,c){let{options:u,getTypeNavigationMode:p,disposable:h}=a.invokeFunction(ov,s);super(e,t,n,i,r,u),this.disposables.add(h),this.internals=new Fl(this,s,p,s.overrideStyles,l,d,c),this.disposables.add(this.internals)}updateOptions(e={}){super.updateOptions(e),e.overrideStyles!==void 0&&this.internals.updateStyleOverrides(e.overrideStyles),this.internals.updateOptions(e)}};eT=O([x(6,Oe),x(7,_t),x(8,Va),x(9,ut)],eT);var tT=class extends Xb{internals;get contextKeyService(){return this.internals.contextKeyService}get useAltAsMultipleSelectionModifier(){return this.internals.useAltAsMultipleSelectionModifier}get onDidOpen(){return this.internals.onDidOpen}constructor(e,t,n,i,r,s,a,l,d,c){let{options:u,getTypeNavigationMode:p,disposable:h}=a.invokeFunction(ov,s);super(e,t,n,i,r,u),this.disposables.add(h),this.internals=new Fl(this,s,p,s.overrideStyles,l,d,c),this.disposables.add(this.internals)}updateOptions(e={}){super.updateOptions(e),e.overrideStyles&&this.internals.updateStyleOverrides(e.overrideStyles),this.internals.updateOptions(e)}};tT=O([x(6,Oe),x(7,_t),x(8,Va),x(9,ut)],tT);var nT=class extends GE{internals;get contextKeyService(){return this.internals.contextKeyService}get useAltAsMultipleSelectionModifier(){return this.internals.useAltAsMultipleSelectionModifier}get onDidOpen(){return this.internals.onDidOpen}constructor(e,t,n,i,r,s,a,l,d,c,u){let{options:p,getTypeNavigationMode:h,disposable:f}=l.invokeFunction(ov,a);super(e,t,n,i,r,s,p),this.disposables.add(f),this.internals=new Fl(this,a,h,a.overrideStyles,d,c,u),this.disposables.add(this.internals)}updateOptions(e){super.updateOptions(e),this.internals.updateOptions(e)}};nT=O([x(7,Oe),x(8,_t),x(9,Va),x(10,ut)],nT);function gH(o){let e=o.getValue(dM);if(e==="highlight")return 0;if(e==="filter")return 1;let t=o.getValue(oT);if(t==="simple"||t==="highlight")return 0;if(t==="filter")return 1}function fH(o){let e=o.getValue(uM);if(e==="fuzzy")return 0;if(e==="contiguous")return 1}function ov(o,e){let t=o.get(ut),n=o.get(qE),i=o.get(_t),r=o.get(Oe),s=()=>{let p=i.getContextKeyValue(hH);if(p==="automatic")return 0;if(p==="trigger")return 1;if(i.getContextKeyValue(mH)===!1)return 1;let f=t.getValue(cM);if(f==="automatic")return 0;if(f==="trigger")return 1},a=e.horizontalScrolling!==void 0?e.horizontalScrolling:!!t.getValue(Wr),[l,d]=r.invokeFunction(mT,e),c=e.paddingBottom,u=e.renderIndentGuides!==void 0?e.renderIndentGuides:t.getValue(rT);return{getTypeNavigationMode:s,disposable:d,options:{keyboardSupport:!1,...l,indent:typeof t.getValue(nv)=="number"?t.getValue(nv):void 0,renderIndentGuides:u,smoothScrolling:!!t.getValue(Us),defaultFindMode:gH(t),defaultFindMatchType:fH(t),horizontalScrolling:a,scrollByPage:!!t.getValue(Hs),paddingBottom:c,hideTwistiesOfChildlessElements:e.hideTwistiesOfChildlessElements,expandOnlyOnTwistieClick:e.expandOnlyOnTwistieClick??t.getValue(sT)==="doubleClick",contextViewProvider:n,findWidgetStyles:dH,enableStickyScroll:!!t.getValue(aT),stickyScrollMaxItemCount:Number(t.getValue(lT))}}}var Fl=class{constructor(e,t,n,i,r,s,a){this.tree=e;this.contextKeyService=pT(r,e),this.disposables.push(hT(this.contextKeyService,e)),this.listSupportsMultiSelect=cT.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(t.multipleSelectionSupport!==!1),uT.bindTo(this.contextKeyService).set(!!t.selectionNavigation),this.listSupportFindWidget=dK.bindTo(this.contextKeyService),this.listSupportFindWidget.set(t.findWidgetEnabled??!0),this.hasSelectionOrFocus=sM.bindTo(this.contextKeyService),this.hasDoubleSelection=aM.bindTo(this.contextKeyService),this.hasMultiSelection=lM.bindTo(this.contextKeyService),this.treeElementCanCollapse=cK.bindTo(this.contextKeyService),this.treeElementHasParent=uK.bindTo(this.contextKeyService),this.treeElementCanExpand=pK.bindTo(this.contextKeyService),this.treeElementHasChild=hK.bindTo(this.contextKeyService),this.treeFindOpen=mK.bindTo(this.contextKeyService),this.treeStickyScrollFocused=pH.bindTo(this.contextKeyService),this._useAltAsMultipleSelectionModifier=Ba(a),this.updateStyleOverrides(i);let d=()=>{let u=e.getFocus()[0];if(!u)return;let p=e.getNode(u);this.treeElementCanCollapse.set(p.collapsible&&!p.collapsed),this.treeElementHasParent.set(!!e.getParentElement(u)),this.treeElementCanExpand.set(p.collapsible&&p.collapsed),this.treeElementHasChild.set(!!e.getFirstElementChild(u))},c=new Set;c.add(hH),c.add(mH),this.disposables.push(this.contextKeyService,s.register(e),e.onDidChangeSelection(()=>{let u=e.getSelection(),p=e.getFocus();this.contextKeyService.bufferChangeEvents(()=>{this.hasSelectionOrFocus.set(u.length>0||p.length>0),this.hasMultiSelection.set(u.length>1),this.hasDoubleSelection.set(u.length===2)})}),e.onDidChangeFocus(()=>{let u=e.getSelection(),p=e.getFocus();this.hasSelectionOrFocus.set(u.length>0||p.length>0),d()}),e.onDidChangeCollapseState(d),e.onDidChangeModel(d),e.onDidChangeFindOpenState(u=>this.treeFindOpen.set(u)),e.onDidChangeStickyScrollFocused(u=>this.treeStickyScrollFocused.set(u)),a.onDidChangeConfiguration(u=>{let p={};if(u.affectsConfiguration(Ku)&&(this._useAltAsMultipleSelectionModifier=Ba(a)),u.affectsConfiguration(nv)){let h=a.getValue(nv);p={...p,indent:h}}if(u.affectsConfiguration(rT)&&t.renderIndentGuides===void 0){let h=a.getValue(rT);p={...p,renderIndentGuides:h}}if(u.affectsConfiguration(Us)){let h=!!a.getValue(Us);p={...p,smoothScrolling:h}}if(u.affectsConfiguration(dM)||u.affectsConfiguration(oT)){let h=gH(a);p={...p,defaultFindMode:h}}if(u.affectsConfiguration(cM)||u.affectsConfiguration(oT)){let h=n();p={...p,typeNavigationMode:h}}if(u.affectsConfiguration(uM)){let h=fH(a);p={...p,defaultFindMatchType:h}}if(u.affectsConfiguration(Wr)&&t.horizontalScrolling===void 0){let h=!!a.getValue(Wr);p={...p,horizontalScrolling:h}}if(u.affectsConfiguration(Hs)){let h=!!a.getValue(Hs);p={...p,scrollByPage:h}}if(u.affectsConfiguration(sT)&&t.expandOnlyOnTwistieClick===void 0&&(p={...p,expandOnlyOnTwistieClick:a.getValue(sT)==="doubleClick"}),u.affectsConfiguration(aT)){let h=a.getValue(aT);p={...p,enableStickyScroll:h}}if(u.affectsConfiguration(lT)){let h=Math.max(1,a.getValue(lT));p={...p,stickyScrollMaxItemCount:h}}if(u.affectsConfiguration(Aa)){let h=a.getValue(Aa);p={...p,mouseWheelScrollSensitivity:h}}if(u.affectsConfiguration(Fa)){let h=a.getValue(Fa);p={...p,fastScrollSensitivity:h}}Object.keys(p).length>0&&e.updateOptions(p)}),this.contextKeyService.onDidChangeContext(u=>{u.affectsSome(c)&&e.updateOptions({typeNavigationMode:n()})})),this.navigator=new rM(e,{configurationService:a,...t}),this.disposables.push(this.navigator)}contextKeyService;listSupportsMultiSelect;listSupportFindWidget;hasSelectionOrFocus;hasDoubleSelection;hasMultiSelection;treeElementCanCollapse;treeElementHasParent;treeElementCanExpand;treeElementHasChild;treeFindOpen;treeStickyScrollFocused;_useAltAsMultipleSelectionModifier;disposables=[];navigator;get onDidOpen(){return this.navigator.onDidOpen}get useAltAsMultipleSelectionModifier(){return this._useAltAsMultipleSelectionModifier}updateOptions(e){e.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!e.multipleSelectionSupport)}updateStyleOverrides(e){this.tree.style(e?ev(e):vm)}dispose(){this.disposables=wt(this.disposables)}};Fl=O([x(4,_t),x(5,Va),x(6,ut)],Fl);var fK=et.as(Ao.Configuration);fK.registerConfiguration({id:"workbench",order:7,title:m("workbenchConfigurationTitle","Workbench"),type:"object",properties:{[Ku]:{type:"string",enum:["ctrlCmd","alt"],markdownEnumDescriptions:[m("multiSelectModifier.ctrlCmd","Maps to `Control` on Windows and Linux and to `Command` on macOS."),m("multiSelectModifier.alt","Maps to `Alt` on Windows and Linux and to `Option` on macOS.")],default:"ctrlCmd",description:m({key:"multiSelectModifier",comment:["- `ctrlCmd` refers to a value the setting can take and should not be localized.","- `Control` and `Command` refer to the modifier keys Ctrl or Cmd on the keyboard and can be localized."]},"The modifier to be used to add an item in trees and lists to a multi-selection with the mouse (for example in the explorer, open editors and scm view). The 'Open to Side' mouse gestures - if supported - will adapt such that they do not conflict with the multiselect modifier.")},[iT]:{type:"string",enum:["singleClick","doubleClick"],default:"singleClick",description:m({key:"openModeModifier",comment:["`singleClick` and `doubleClick` refers to a value the setting can take and should not be localized."]},"Controls how to open items in trees and lists using the mouse (if supported). Note that some trees and lists might choose to ignore this setting if it is not applicable.")},[Wr]:{type:"boolean",default:!1,description:m("horizontalScrolling setting","Controls whether lists and trees support horizontal scrolling in the workbench. Warning: turning on this setting has a performance implication.")},[Hs]:{type:"boolean",default:!1,description:m("list.scrollByPage","Controls whether clicks in the scrollbar scroll page by page.")},[nv]:{type:"number",default:8,minimum:4,maximum:40,description:m("tree indent setting","Controls tree indentation in pixels.")},[rT]:{type:"string",enum:["none","onHover","always"],default:"onHover",description:m("render tree indent guides","Controls whether the tree should render indent guides.")},[Us]:{type:"boolean",default:!1,description:m("list smoothScrolling setting","Controls whether lists and trees have smooth scrolling.")},[Aa]:{type:"number",default:1,markdownDescription:m("Mouse Wheel Scroll Sensitivity","A multiplier to be used on the `deltaX` and `deltaY` of mouse wheel scroll events.")},[Fa]:{type:"number",default:5,markdownDescription:m("Fast Scroll Sensitivity","Scrolling speed multiplier when pressing `Alt`.")},[dM]:{type:"string",enum:["highlight","filter"],enumDescriptions:[m("defaultFindModeSettingKey.highlight","Highlight elements when searching. Further up and down navigation will traverse only the highlighted elements."),m("defaultFindModeSettingKey.filter","Filter elements when searching.")],default:"highlight",description:m("defaultFindModeSettingKey","Controls the default find mode for lists and trees in the workbench.")},[oT]:{type:"string",enum:["simple","highlight","filter"],enumDescriptions:[m("keyboardNavigationSettingKey.simple","Simple keyboard navigation focuses elements which match the keyboard input. Matching is done only on prefixes."),m("keyboardNavigationSettingKey.highlight","Highlight keyboard navigation highlights elements which match the keyboard input. Further up and down navigation will traverse only the highlighted elements."),m("keyboardNavigationSettingKey.filter","Filter keyboard navigation will filter out and hide all the elements which do not match the keyboard input.")],default:"highlight",description:m("keyboardNavigationSettingKey","Controls the keyboard navigation style for lists and trees in the workbench. Can be simple, highlight and filter."),deprecated:!0,deprecationMessage:m("keyboardNavigationSettingKeyDeprecated","Please use 'workbench.list.defaultFindMode' and	'workbench.list.typeNavigationMode' instead.")},[uM]:{type:"string",enum:["fuzzy","contiguous"],enumDescriptions:[m("defaultFindMatchTypeSettingKey.fuzzy","Use fuzzy matching when searching."),m("defaultFindMatchTypeSettingKey.contiguous","Use contiguous matching when searching.")],default:"fuzzy",description:m("defaultFindMatchTypeSettingKey","Controls the type of matching used when searching lists and trees in the workbench.")},[sT]:{type:"string",enum:["singleClick","doubleClick"],default:"singleClick",description:m("expand mode","Controls how tree folders are expanded when clicking the folder names. Note that some trees and lists might choose to ignore this setting if it is not applicable.")},[aT]:{type:"boolean",default:!0,description:m("sticky scroll","Controls whether sticky scrolling is enabled in trees.")},[lT]:{type:"number",minimum:1,default:7,markdownDescription:m("sticky scroll maximum items","Controls the number of sticky elements displayed in the tree when {0} is enabled.","`#workbench.tree.enableStickyScroll#`")},[cM]:{type:"string",enum:["automatic","trigger"],default:"automatic",markdownDescription:m("typeNavigationMode2","Controls how type navigation works in lists and trees in the workbench. When set to `trigger`, type navigation begins once the `list.triggerTypeNavigation` command is run.")}}});var rv=Y("openerService");var bK={Quickaccess:"workbench.contributions.quickaccess"},pM=class{providers=[];defaultProvider=void 0;registerQuickAccessProvider(e){return e.prefix.length===0?this.defaultProvider=e:this.providers.push(e),this.providers.sort((t,n)=>n.prefix.length-t.prefix.length),le(()=>{this.providers.splice(this.providers.indexOf(e),1),this.defaultProvider===e&&(this.defaultProvider=void 0)})}getQuickAccessProviders(){return Er([this.defaultProvider,...this.providers])}getQuickAccessProvider(e){return e&&this.providers.find(n=>e.startsWith(n.prefix))||void 0||this.defaultProvider}clear(){let e=[...this.providers],t=this.defaultProvider;return this.providers=[],this.defaultProvider=void 0,()=>{this.providers=e,this.defaultProvider=t}}};et.add(bK.Quickaccess,new pM);var bH=new Qn(()=>{let o=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"});return{collator:o,collatorIsNumeric:o.resolvedOptions().numeric}}),zGe=new Qn(()=>({collator:new Intl.Collator(void 0,{numeric:!0})})),KGe=new Qn(()=>({collator:new Intl.Collator(void 0,{numeric:!0,sensitivity:"accent"})}));function vK(o,e,t=!1){let n=o||"",i=e||"",r=bH.value.collator.compare(n,i);return bH.value.collatorIsNumeric&&r===0&&n!==i?n<i?-1:1:r}function gT(o,e,t){let n=o.toLowerCase(),i=e.toLowerCase(),r=yK(o,e,t);if(r)return r;let s=n.endsWith(t),a=i.endsWith(t);if(s!==a)return s?-1:1;let l=vK(n,i);return l!==0?l:n.localeCompare(i)}function yK(o,e,t){let n=o.toLowerCase(),i=e.toLowerCase(),r=n.startsWith(t),s=i.startsWith(t);if(r!==s)return r?-1:1;if(r&&s){if(n.length<i.length)return-1;if(n.length>i.length)return 1}return 0}var bT=0,vH=[bT,[]];function yH(o,e,t,n){if(!o||!e)return vH;let i=o.length,r=e.length;if(i<r)return vH;let s=o.toLowerCase();return IK(e,t,r,o,s,i,n)}function IK(o,e,t,n,i,r,s){let a=[],l=[];for(let p=0;p<t;p++){let h=p*r,f=h-r,g=p>0,b=o[p],v=e[p];for(let y=0;y<r;y++){let S=y>0,E=h+y,C=E-1,w=f+y-1,_=S?a[C]:0,L=g&&S?a[w]:0,k=g&&S?l[w]:0,W;!L&&g?W=0:W=CK(b,v,n,i,y,k),W&&L+W>=_&&(s||g||i.startsWith(e,y))?(l[E]=k+1,a[E]=L+W):(l[E]=bT,a[E]=_)}}let d=[],c=t-1,u=r-1;for(;c>=0&&u>=0;){let p=c*r+u;l[p]===bT||(d.push(u),c--),u--}return[a[t*r-1],d.reverse()]}function CK(o,e,t,n,i,r){let s=0;if(!SK(e,n[i]))return s;if(s+=1,r>0&&(s+=r*5),o===t[i]&&(s+=1),i===0)s+=8;else{let a=EK(t.charCodeAt(i-1));a?s+=a:Qp(t.charCodeAt(i))&&r===0&&(s+=2)}return s}function SK(o,e){return o===e?!0:o==="/"||o==="\\"?e==="/"||e==="\\":!1}function EK(o){switch(o){case 47:case 92:return 5;case 95:case 45:case 46:case 32:case 39:case 34:case 58:return 4;default:return 0}}var vT=Object.freeze({score:0}),fT=1<<18,hM=1<<17,mM=65536;function TK(o,e,t,n){let i=n.values?n.values:[n];return Zr({[n.normalized]:{values:i.map(s=>({value:s.normalized,expectContiguousMatch:s.expectContiguousMatch})),label:o,description:e,allowNonContiguousMatches:t}})}function yT(o,e,t,n,i){if(!o||!e.normalized)return vT;let r=n.getItemLabel(o);if(!r)return vT;let s=n.getItemDescription(o),a=TK(r,s,t,e),l=i[a];if(l)return l;let d=xK(r,s,n.getItemPath(o),e,t);return i[a]=d,d}function xK(o,e,t,n,i){let r=!t||!n.containsPathSeparator;return t&&(At?n.pathNormalized===t:tr(n.pathNormalized,t))?{score:fT,labelMatch:[{start:0,end:o.length}],descriptionMatch:e?[{start:0,end:e.length}]:void 0}:n.values&&n.values.length>1?wK(o,e,t,n.values,r,i):xH(o,e,t,n,r,i)}function wK(o,e,t,n,i,r){let s=0,a=[],l=[];for(let d of n){let{score:c,labelMatch:u,descriptionMatch:p}=xH(o,e,t,d,i,r);if(c===bT)return vT;s+=c,u&&a.push(...u),p&&l.push(...p)}return{score:s,labelMatch:CH(a),descriptionMatch:CH(l)}}function xH(o,e,t,n,i,r){if(i||!e){let[s,a]=yH(o,n.normalized,n.normalizedLowercase,r&&!n.expectContiguousMatch);if(s){let l=Jc(n.normalized,o),d;if(l){d=hM;let c=Math.round(n.normalized.length/o.length*100);d+=c}else d=mM;return{score:d+s,labelMatch:l||IH(a)}}}if(e){let s=e;t&&(s=`${e}${ui}`);let a=s.length,l=`${s}${o}`,[d,c]=yH(l,n.normalized,n.normalizedLowercase,r&&!n.expectContiguousMatch);if(d){let u=IH(c),p=[],h=[];return u.forEach(f=>{f.start<a&&f.end>a?(p.push({start:0,end:f.end-a}),h.push({start:f.start,end:a})):f.start>=a?p.push({start:f.start-a,end:f.end-a}):h.push(f)}),{score:d,labelMatch:p,descriptionMatch:h}}}return vT}function IH(o){let e=[];if(!o)return e;let t;for(let n of o)t&&t.end===n?t.end+=1:(t={start:n,end:n+1},e.push(t));return e}function CH(o){let e=o.sort((i,r)=>i.start-r.start),t=[],n;for(let i of e)!n||!_K(n,i)?(n=i,t.push(i)):(n.start=Math.min(n.start,i.start),n.end=Math.max(n.end,i.end));return t}function _K(o,e){return!(o.end<e.start||e.end<o.start)}function wH(o,e,t,n,i,r){let s=yT(o,t,n,i,r),a=yT(e,t,n,i,r),l=s.score,d=a.score;if((l===fT||d===fT)&&l!==d)return l===fT?-1:1;if(l>mM||d>mM){if(l!==d)return l>d?-1:1;if(l<hM&&d<hM){let b=DK(s.labelMatch,a.labelMatch);if(b!==0)return b}let f=i.getItemLabel(o)||"",g=i.getItemLabel(e)||"";if(f.length!==g.length)return f.length-g.length}if(l!==d)return l>d?-1:1;let c=Array.isArray(s.labelMatch)&&s.labelMatch.length>0,u=Array.isArray(a.labelMatch)&&a.labelMatch.length>0;if(c&&!u)return-1;if(u&&!c)return 1;let p=SH(o,s,i),h=SH(e,a,i);return p&&h&&p!==h?h>p?-1:1:LK(o,e,t,i)}function SH(o,e,t){let n=-1,i=-1;if(e.descriptionMatch&&e.descriptionMatch.length?n=e.descriptionMatch[0].start:e.labelMatch&&e.labelMatch.length&&(n=e.labelMatch[0].start),e.labelMatch&&e.labelMatch.length){if(i=e.labelMatch[e.labelMatch.length-1].end,e.descriptionMatch&&e.descriptionMatch.length){let r=t.getItemDescription(o);r&&(i+=r.length)}}else e.descriptionMatch&&e.descriptionMatch.length&&(i=e.descriptionMatch[e.descriptionMatch.length-1].end);return i-n}function DK(o,e){if(!o&&!e||(!o||!o.length)&&(!e||!e.length))return 0;if(!e||!e.length)return-1;if(!o||!o.length)return 1;let t=o[0].start,i=o[o.length-1].end-t,r=e[0].start,a=e[e.length-1].end-r;return i===a?0:a<i?1:-1}function LK(o,e,t,n){let i=n.getItemLabel(o)||"",r=n.getItemLabel(e)||"",s=n.getItemDescription(o),a=n.getItemDescription(e),l=i.length+(s?s.length:0),d=r.length+(a?a.length:0);if(l!==d)return l-d;let c=n.getItemPath(o),u=n.getItemPath(e);return c&&u&&c.length!==u.length?c.length-u.length:i!==r?gT(i,r,t.normalized):s&&a&&s!==a?gT(s,a,t.normalized):c&&u&&c!==u?gT(c,u,t.normalized):0}function EH(o){return o.startsWith('"')&&o.endsWith('"')}var RK=" ";function _H(o){typeof o!="string"&&(o="");let e=o.toLowerCase(),{pathNormalized:t,normalized:n,normalizedLowercase:i}=TH(o),r=t.indexOf(ui)>=0,s=EH(o),a,l=o.split(RK);if(l.length>1)for(let d of l){let c=EH(d),{pathNormalized:u,normalized:p,normalizedLowercase:h}=TH(d);p&&(a||(a=[]),a.push({original:d,originalLowercase:d.toLowerCase(),pathNormalized:u,normalized:p,normalizedLowercase:h,expectContiguousMatch:c}))}return{original:o,originalLowercase:e,pathNormalized:t,normalized:n,normalizedLowercase:i,values:a,containsPathSeparator:r,expectContiguousMatch:s}}function TH(o){let e;pt?e=o.replace(/\//g,ui):e=o.replace(/\\/g,ui);let t=WA(e).replace(/\s|"/g,"");return{pathNormalized:e,normalized:t,normalizedLowercase:t.toLowerCase()}}var gM=class{constructor(e){this.options=e}getItemLabel(e){return e.label}getItemDescription(e){if(!this.options?.skipDescription)return e.description}getItemPath(e){if(!this.options?.skipPath)return e.resource?.scheme===Le.file?e.resource.fsPath:e.resource?.path}},fM=new gM,kK=Y("quickInputService");function bM(o){let e=o;return Array.isArray(e.items)}function DH(o){let e=o;return!!e.picks&&e.additionalPicks instanceof Promise}var IT=class extends F{constructor(t,n){super();this.prefix=t;this.options=n}provide(t,n,i){let r=new ee;t.canAcceptInBackground=!!this.options?.canAcceptInBackground,t.matchOnLabel=t.matchOnDescription=t.matchOnDetail=t.sortByLabel=!1;let s,a=r.add(new un),l=async()=>{let c=a.value=new ee;s?.dispose(!0),t.busy=!1,s=new zn(n);let u=s.token,p=t.value.substring(this.prefix.length);this.options?.shouldSkipTrimPickFilter||(p=p.trim());let h=this._getPicks(p,c,u,i),f=(b,v)=>{let y,S;if(bM(b)?(y=b.items,S=b.active):y=b,y.length===0){if(v)return!1;(p.length>0||t.hideInput)&&this.options?.noResultsPick&&($c(this.options.noResultsPick)?y=[this.options.noResultsPick(p)]:y=[this.options.noResultsPick])}return t.items=y,S&&(t.activeItems=[S]),!0},g=async b=>{let v=!1,y=!1;await Promise.all([(async()=>{typeof b.mergeDelay=="number"&&(await wi(b.mergeDelay),u.isCancellationRequested)||y||(v=f(b.picks,!0))})(),(async()=>{t.busy=!0;try{let S=await b.additionalPicks;if(u.isCancellationRequested)return;let E,C;bM(b.picks)?(E=b.picks.items,C=b.picks.active):E=b.picks;let w,_;if(bM(S)?(w=S.items,_=S.active):w=S,w.length>0||!v){let L;if(!C&&!_){let k=t.activeItems[0];k&&E.indexOf(k)!==-1&&(L=k)}f({items:[...E,...w],active:C||_||L})}}finally{u.isCancellationRequested||(t.busy=!1),y=!0}})()])};if(h!==null)if(DH(h))await g(h);else if(!(h instanceof Promise))f(h);else{t.busy=!0;try{let b=await h;if(u.isCancellationRequested)return;DH(b)?await g(b):f(b)}finally{u.isCancellationRequested||(t.busy=!1)}}};r.add(t.onDidChangeValue(()=>l())),l(),r.add(t.onDidAccept(c=>{if(i?.handleAccept){c.inBackground||t.hide(),i.handleAccept?.(t.activeItems[0]);return}let[u]=t.selectedItems;typeof u?.accept=="function"&&(c.inBackground||t.hide(),u.accept(t.keyMods,c))}));let d=async(c,u)=>{if(typeof u.trigger!="function")return;let p=u.buttons?.indexOf(c)??-1;if(p>=0){let h=u.trigger(p,t.keyMods),f=typeof h=="number"?h:await h;if(n.isCancellationRequested)return;switch(f){case 0:break;case 1:t.hide();break;case 2:l();break;case 3:{let g=t.items.indexOf(u);if(g!==-1){let b=t.items.slice(),v=b.splice(g,1),y=t.activeItems.filter(E=>E!==v[0]),S=t.keepScrollPosition;t.keepScrollPosition=!0,t.items=b,y&&(t.activeItems=y),t.keepScrollPosition=S}break}}}};return r.add(t.onDidTriggerItemButton(({button:c,item:u})=>d(c,u))),r.add(t.onDidTriggerSeparatorButton(({button:c,separator:u})=>d(c,u))),r}};var MK=Y("textModelService");var LH="";var ls=Y("modelService");var CT=Y("ILanguageDetectionService"),vM="languageDetection";var zs=class extends xa{constructor(t,n,i,r,s){super();this.modelService=t;this.languageService=n;this.languageDetectionService=i;this.accessibilityService=r;s&&this.handleExistingModel(s)}static AUTO_DETECT_LANGUAGE_THROTTLE_DELAY=600;textEditorModelHandle=void 0;createdEditorModel;modelDisposeListener=this._register(new un);autoDetectLanguageThrottler=this._register(new Zp(zs.AUTO_DETECT_LANGUAGE_THROTTLE_DELAY));handleExistingModel(t){let n=this.modelService.getModel(t);if(!n)throw new Error(`Document with resource ${t.toString(!0)} does not exist`);this.textEditorModelHandle=t,this.registerModelDisposeListener(n)}registerModelDisposeListener(t){this.modelDisposeListener.value=t.onWillDispose(()=>{this.textEditorModelHandle=void 0,this.dispose()})}get textEditorModel(){return this.textEditorModelHandle?this.modelService.getModel(this.textEditorModelHandle):null}isReadonly(){return!0}_hasLanguageSetExplicitly=!1;get hasLanguageSetExplicitly(){return this._hasLanguageSetExplicitly}setLanguageId(t,n){this._hasLanguageSetExplicitly=!0,this.setLanguageIdInternal(t,n)}setLanguageIdInternal(t,n){this.isResolved()&&(!t||t===this.textEditorModel.getLanguageId()||this.textEditorModel.setLanguage(this.languageService.createById(t),n))}installModelListeners(t){let n=this._register(t.onDidChangeLanguage(i=>{i.source!==vM&&(this._hasLanguageSetExplicitly=!0,n.dispose())}))}getLanguageId(){return this.textEditorModel?.getLanguageId()}autoDetectLanguage(){return this.autoDetectLanguageThrottler.trigger(()=>this.doAutoDetectLanguage())}async doAutoDetectLanguage(){if(this.hasLanguageSetExplicitly||!this.textEditorModelHandle||!this.languageDetectionService.isEnabledForLanguage(this.getLanguageId()??Ls))return;let t=await this.languageDetectionService.detectLanguage(this.textEditorModelHandle),n=this.getLanguageId();if(t&&t!==n&&!this.isDisposed()){this.setLanguageIdInternal(t,vM);let i=this.languageService.getLanguageName(t);this.accessibilityService.alert(m("languageAutoDetected","Language {0} was automatically detected and set as the language mode.",i??t))}}createTextEditorModel(t,n,i){let r=this.getFirstLineText(t),s=this.getOrCreateLanguage(n,this.languageService,i,r);return this.doCreateTextEditorModel(t,s,n)}doCreateTextEditorModel(t,n,i){let r=i&&this.modelService.getModel(i);return r?this.updateTextEditorModel(t,n.languageId):(r=this.modelService.createModel(t,n,i),this.createdEditorModel=!0,this.registerModelDisposeListener(r)),this.textEditorModelHandle=r.uri,r}getFirstLineText(t){let n=t;return typeof n.getFirstLineText=="function"?n.getFirstLineText(1e3):t.getLineContent(1).substr(0,1e3)}getOrCreateLanguage(t,n,i,r){return!i||i===Ls?n.createByFilepathOrFirstLine(t??null,r):n.createById(i)}updateTextEditorModel(t,n){this.isResolved()&&(t&&this.modelService.updateModel(this.textEditorModel,t),n&&n!==Ls&&this.textEditorModel.getLanguageId()!==n&&this.textEditorModel.setLanguage(this.languageService.createById(n)))}createSnapshot(){return this.textEditorModel?this.textEditorModel.createSnapshot(!0):null}isResolved(){return!!this.textEditorModelHandle}dispose(){this.modelDisposeListener.dispose(),this.textEditorModelHandle&&this.createdEditorModel&&this.modelService.destroyModel(this.textEditorModelHandle),this.textEditorModelHandle=void 0,this.createdEditorModel=!1,super.dispose()}};zs=O([x(0,ls),x(1,Di),x(2,CT),x(3,vo)],zs);var ST=Y("workingCopyBackupService");var Hr=Y("textResourceConfigurationService"),k$e=Y("textResourcePropertiesService");var ds=class o{constructor(e,t,n){this.startOffset=e;this.endOffset=t;this.newLength=n}static fromModelContentChanges(e){return e.map(n=>{let i=P.lift(n.range);return new o(Od(i.getStartPosition()),Od(i.getEndPosition()),hB(n.text))}).reverse()}toString(){return`[${to(this.startOffset)}...${to(this.endOffset)}) -> ${to(this.newLength)}`}},ET=class{nextEditIdx=0;deltaOldToNewLineCount=0;deltaOldToNewColumnCount=0;deltaLineIdxInOld=-1;edits;constructor(e){this.edits=e.map(t=>yM.from(t))}getOffsetBeforeChange(e){return this.adjustNextEdit(e),this.translateCurToOld(e)}getDistanceToNextChange(e){this.adjustNextEdit(e);let t=this.edits[this.nextEditIdx],n=t?this.translateOldToCur(t.offsetObj):null;return n===null?null:lu(e,n)}translateOldToCur(e){return e.lineCount===this.deltaLineIdxInOld?Qt(e.lineCount+this.deltaOldToNewLineCount,e.columnCount+this.deltaOldToNewColumnCount):Qt(e.lineCount+this.deltaOldToNewLineCount,e.columnCount)}translateCurToOld(e){let t=to(e);return t.lineCount-this.deltaOldToNewLineCount===this.deltaLineIdxInOld?Qt(t.lineCount-this.deltaOldToNewLineCount,t.columnCount-this.deltaOldToNewColumnCount):Qt(t.lineCount-this.deltaOldToNewLineCount,t.columnCount)}adjustNextEdit(e){for(;this.nextEditIdx<this.edits.length;){let t=this.edits[this.nextEditIdx],n=this.translateOldToCur(t.endOffsetAfterObj);if(Pd(n,e)){this.nextEditIdx++;let i=to(n),r=to(this.translateOldToCur(t.endOffsetBeforeObj)),s=i.lineCount-r.lineCount;this.deltaOldToNewLineCount+=s;let a=this.deltaLineIdxInOld===t.endOffsetBeforeObj.lineCount?this.deltaOldToNewColumnCount:0,l=i.columnCount-r.columnCount;this.deltaOldToNewColumnCount=a+l,this.deltaLineIdxInOld=t.endOffsetBeforeObj.lineCount}else break}}},yM=class o{static from(e){return new o(e.startOffset,e.endOffset,e.newLength)}endOffsetBeforeObj;endOffsetAfterObj;offsetObj;constructor(e,t,n){this.endOffsetBeforeObj=to(t),this.endOffsetAfterObj=to(jt(e,n)),this.offsetObj=to(e)}};function MH(o){if(o.length===0)return null;if(o.length===1)return o[0];let e=0;function t(){if(e>=o.length)return null;let s=e,a=o[s].listHeight;for(e++;e<o.length&&o[e].listHeight===a;)e++;return e-s>=2?CM(s===0&&e===o.length?o:o.slice(s,e),!1):o[s]}let n=t(),i=t();if(!i)return n;for(let s=t();s;s=t())RH(n,i)<=RH(i,s)?(n=IM(n,i),i=s):i=IM(i,s);return IM(n,i)}function CM(o,e=!1){if(o.length===0)return null;if(o.length===1)return o[0];let t=o.length;for(;t>3;){let n=t>>1;for(let i=0;i<n;i++){let r=i<<1;o[i]=dr.create23(o[r],o[r+1],r+3===t?o[r+2]:null,e)}t=n}return dr.create23(o[0],o[1],t>=3?o[2]:null,e)}function RH(o,e){return Math.abs(o.listHeight-e.listHeight)}function IM(o,e){return o.listHeight===e.listHeight?dr.create23(o,e,null,!1):o.listHeight>e.listHeight?PK(o,e):OK(e,o)}function PK(o,e){o=o.toMutable();let t=o,n=[],i;for(;;){if(e.listHeight===t.listHeight){i=e;break}if(t.kind!==4)throw new Error("unexpected");n.push(t),t=t.makeLastElementMutable()}for(let r=n.length-1;r>=0;r--){let s=n[r];i?s.childrenLength>=3?i=dr.create23(s.unappendChild(),i,null,!1):(s.appendChildOfSameHeight(i),i=void 0):s.handleChildrenChanged()}return i?dr.create23(o,i,null,!1):o}function OK(o,e){o=o.toMutable();let t=o,n=[];for(;e.listHeight!==t.listHeight;){if(t.kind!==4)throw new Error("unexpected");n.push(t),t=t.makeFirstElementMutable()}let i=e;for(let r=n.length-1;r>=0;r--){let s=n[r];i?s.childrenLength>=3?i=dr.create23(i,s.unprependChild(),null,!1):(s.prependChildOfSameHeight(i),i=void 0):s.handleChildrenChanged()}return i?dr.create23(i,o,null,!1):o}var TT=class{nextNodes;offsets;idxs;lastOffset=ei;constructor(e){this.nextNodes=[e],this.offsets=[ei],this.idxs=[]}readLongestNodeAt(e,t){if(Tl(e,this.lastOffset))throw new Error("Invalid offset");for(this.lastOffset=e;;){let n=sv(this.nextNodes);if(!n)return;let i=sv(this.offsets);if(Tl(e,i))return;if(Tl(i,e))if(jt(i,n.length)<=e)this.nextNodeAfterCurrent();else{let r=SM(n);r!==-1?(this.nextNodes.push(n.getChild(r)),this.offsets.push(i),this.idxs.push(r)):this.nextNodeAfterCurrent()}else{if(t(n))return this.nextNodeAfterCurrent(),n;{let r=SM(n);if(r===-1){this.nextNodeAfterCurrent();return}else this.nextNodes.push(n.getChild(r)),this.offsets.push(i),this.idxs.push(r)}}}}nextNodeAfterCurrent(){for(;;){let e=sv(this.offsets),t=sv(this.nextNodes);if(this.nextNodes.pop(),this.offsets.pop(),this.idxs.length===0)break;let n=sv(this.nextNodes),i=SM(n,this.idxs[this.idxs.length-1]);if(i!==-1){this.nextNodes.push(n.getChild(i)),this.offsets.push(jt(e,t.length)),this.idxs[this.idxs.length-1]=i;break}else this.idxs.pop()}}};function SM(o,e=-1){for(;;){if(e++,e>=o.childrenLength)return-1;if(o.getChild(e))return e}}function sv(o){return o.length>0?o[o.length-1]:void 0}function TM(o,e,t,n){return new EM(o,e,t,n).parseDocument()}var EM=class{constructor(e,t,n,i){this.tokenizer=e;this.createImmutableLists=i;if(n&&i)throw new Error("Not supported");this.oldNodeReader=n?new TT(n):void 0,this.positionMapper=new ET(t)}oldNodeReader;positionMapper;_itemsConstructed=0;_itemsFromCache=0;get nodesConstructed(){return this._itemsConstructed}get nodesReused(){return this._itemsFromCache}parseDocument(){this._itemsConstructed=0,this._itemsFromCache=0;let e=this.parseList(Li.getEmpty(),0);return e||(e=dr.getEmpty()),e}parseList(e,t){let n=[];for(;;){let r=this.tryReadChildFromCache(e);if(!r){let s=this.tokenizer.peek();if(!s||s.kind===2&&s.bracketIds.intersects(e))break;r=this.parseChild(e,t+1)}r.kind===4&&r.childrenLength===0||n.push(r)}return this.oldNodeReader?MH(n):CM(n,this.createImmutableLists)}tryReadChildFromCache(e){if(this.oldNodeReader){let t=this.positionMapper.getDistanceToNextChange(this.tokenizer.offset);if(t===null||!sh(t)){let n=this.oldNodeReader.readLongestNodeAt(this.positionMapper.getOffsetBeforeChange(this.tokenizer.offset),i=>t!==null&&!Tl(i.length,t)?!1:i.canBeReused(e));if(n)return this._itemsFromCache++,this.tokenizer.skip(n.length),n}}}parseChild(e,t){this._itemsConstructed++;let n=this.tokenizer.read();switch(n.kind){case 2:return new DC(n.bracketIds,n.length);case 0:return n.astNode;case 1:{if(t>300)return new ks(n.length);let i=e.merge(n.bracketIds),r=this.parseList(i,t+1),s=this.tokenizer.peek();return s&&s.kind===2&&(s.bracketId===n.bracketId||s.bracketIds.intersects(n.bracketIds))?(this.tokenizer.read(),Xf.create(n.astNode,r,s.astNode)):Xf.create(n.astNode,r,null)}default:throw new Error("unexpected")}}};function ym(o,e){if(o.length===0)return e;if(e.length===0)return o;let t=new Wi(PH(o)),n=PH(e);n.push({modified:!1,lengthBefore:void 0,lengthAfter:void 0});let i=t.dequeue();function r(d){if(d===void 0){let u=t.takeWhile(p=>!0)||[];return i&&u.unshift(i),u}let c=[];for(;i&&!sh(d);){let[u,p]=i.splitAt(d);c.push(u),d=lu(u.lengthAfter,d),i=p??t.dequeue()}return sh(d)||c.push(new av(!1,d,d)),c}let s=[];function a(d,c,u){if(s.length>0&&dR(s[s.length-1].endOffset,d)){let p=s[s.length-1];s[s.length-1]=new ds(p.startOffset,c,jt(p.newLength,u))}else s.push({startOffset:d,endOffset:c,newLength:u})}let l=ei;for(let d of n){let c=r(d.lengthBefore);if(d.modified){let u=pB(c,h=>h.lengthBefore),p=jt(l,u);a(l,p,d.lengthAfter),l=p}else for(let u of c){let p=l;l=jt(l,u.lengthBefore),u.modified&&a(p,l,u.lengthAfter)}}return s}var av=class o{constructor(e,t,n){this.modified=e;this.lengthBefore=t;this.lengthAfter=n}splitAt(e){let t=lu(e,this.lengthAfter);return dR(t,ei)?[this,void 0]:this.modified?[new o(this.modified,this.lengthBefore,e),new o(this.modified,ei,t)]:[new o(this.modified,e,e),new o(this.modified,t,t)]}toString(){return`${this.modified?"M":"U"}:${to(this.lengthBefore)} -> ${to(this.lengthAfter)}`}};function PH(o){let e=[],t=ei;for(let n of o){let i=lu(t,n.startOffset);sh(i)||e.push(new av(!1,i,i));let r=lu(n.startOffset,n.endOffset);e.push(new av(!0,r,n.newLength)),t=n.endOffset}return e}var xT=class extends F{constructor(t,n){super();this.textModel=t;this.getLanguageConfiguration=n;if(t.tokenization.hasTokens)t.tokenization.backgroundTokenizationState===2?(this.initialAstWithoutTokens=void 0,this.astWithTokens=this.parseDocumentFromTextBuffer([],void 0,!1)):(this.initialAstWithoutTokens=this.parseDocumentFromTextBuffer([],void 0,!0),this.astWithTokens=this.initialAstWithoutTokens);else{let i=this.brackets.getSingleLanguageBracketTokens(this.textModel.getLanguageId()),r=new wC(this.textModel.getValue(),i);this.initialAstWithoutTokens=TM(r,[],void 0,!0),this.astWithTokens=this.initialAstWithoutTokens}}didChangeEmitter=new D;initialAstWithoutTokens;astWithTokens;denseKeyProvider=new oC;brackets=new TC(this.denseKeyProvider,this.getLanguageConfiguration);didLanguageChange(t){return this.brackets.didLanguageChange(t)}onDidChange=this.didChangeEmitter.event;queuedTextEditsForInitialAstWithoutTokens=[];queuedTextEdits=[];handleDidChangeBackgroundTokenizationState(){if(this.textModel.tokenization.backgroundTokenizationState===2){let t=this.initialAstWithoutTokens===void 0;this.initialAstWithoutTokens=void 0,t||this.didChangeEmitter.fire()}}handleDidChangeTokens({ranges:t}){let n=t.map(i=>new ds(Qt(i.fromLineNumber-1,0),Qt(i.toLineNumber,0),Qt(i.toLineNumber-i.fromLineNumber+1,0)));this.handleEdits(n,!0),this.initialAstWithoutTokens||this.didChangeEmitter.fire()}handleContentChanged(t){let n=ds.fromModelContentChanges(t.changes);this.handleEdits(n,!1)}handleEdits(t,n){let i=ym(this.queuedTextEdits,t);this.queuedTextEdits=i,this.initialAstWithoutTokens&&!n&&(this.queuedTextEditsForInitialAstWithoutTokens=ym(this.queuedTextEditsForInitialAstWithoutTokens,t))}flushQueue(){this.queuedTextEdits.length>0&&(this.astWithTokens=this.parseDocumentFromTextBuffer(this.queuedTextEdits,this.astWithTokens,!1),this.queuedTextEdits=[]),this.queuedTextEditsForInitialAstWithoutTokens.length>0&&(this.initialAstWithoutTokens&&(this.initialAstWithoutTokens=this.parseDocumentFromTextBuffer(this.queuedTextEditsForInitialAstWithoutTokens,this.initialAstWithoutTokens,!1)),this.queuedTextEditsForInitialAstWithoutTokens=[])}parseDocumentFromTextBuffer(t,n,i){let s=n,a=new xC(this.textModel,this.brackets);return TM(a,t,s,i)}getBracketsInRange(t,n){this.flushQueue();let i=Qt(t.startLineNumber-1,t.startColumn-1),r=Qt(t.endLineNumber-1,t.endColumn-1);return new dl(s=>{let a=this.initialAstWithoutTokens||this.astWithTokens;xM(a,ei,a.length,i,r,s,0,0,new Map,n)})}getBracketPairsInRange(t,n){this.flushQueue();let i=Od(t.getStartPosition()),r=Od(t.getEndPosition());return new dl(s=>{let a=this.initialAstWithoutTokens||this.astWithTokens,l=new wM(s,n,this.textModel);_M(a,ei,a.length,i,r,l,0,new Map)})}getFirstBracketAfter(t){this.flushQueue();let n=this.initialAstWithoutTokens||this.astWithTokens;return NH(n,ei,n.length,Od(t))}getFirstBracketBefore(t){this.flushQueue();let n=this.initialAstWithoutTokens||this.astWithTokens;return OH(n,ei,n.length,Od(t))}};function OH(o,e,t,n){if(o.kind===4||o.kind===2){let i=[];for(let r of o.children)t=jt(e,r.length),i.push({nodeOffsetStart:e,nodeOffsetEnd:t}),e=t;for(let r=i.length-1;r>=0;r--){let{nodeOffsetStart:s,nodeOffsetEnd:a}=i[r];if(Tl(s,n)){let l=OH(o.children[r],s,a,n);if(l)return l}}return null}else{if(o.kind===3)return null;if(o.kind===1){let i=Nd(e,t);return{bracketInfo:o.bracketInfo,range:i}}}return null}function NH(o,e,t,n){if(o.kind===4||o.kind===2){for(let i of o.children){if(t=jt(e,i.length),Tl(n,t)){let r=NH(i,e,t,n);if(r)return r}e=t}return null}else{if(o.kind===3)return null;if(o.kind===1){let i=Nd(e,t);return{bracketInfo:o.bracketInfo,range:i}}}return null}function xM(o,e,t,n,i,r,s,a,l,d,c=!1){if(s>200)return!0;e:for(;;)switch(o.kind){case 4:{let u=o.childrenLength;for(let p=0;p<u;p++){let h=o.getChild(p);if(h){if(t=jt(e,h.length),Pd(e,i)&&ah(t,n)){if(ah(t,i)){o=h;continue e}if(!xM(h,e,t,n,i,r,s,0,l,d))return!1}e=t}}return!0}case 2:{let u=!d||!o.closingBracket||o.closingBracket.bracketInfo.closesColorized(o.openingBracket.bracketInfo),p=0;if(l){let f=l.get(o.openingBracket.text);f===void 0&&(f=0),p=f,u&&(f++,l.set(o.openingBracket.text,f))}let h=o.childrenLength;for(let f=0;f<h;f++){let g=o.getChild(f);if(g){if(t=jt(e,g.length),Pd(e,i)&&ah(t,n)){if(ah(t,i)&&g.kind!==1){o=g,u?(s++,a=p+1):a=p;continue e}if((u||g.kind!==1||!o.closingBracket)&&!xM(g,e,t,n,i,r,u?s+1:s,u?p+1:p,l,d,!o.closingBracket))return!1}e=t}}return l?.set(o.openingBracket.text,p),!0}case 3:{let u=Nd(e,t);return r(new tb(u,s-1,0,!0))}case 1:{let u=Nd(e,t);return r(new tb(u,s-1,a-1,c))}case 0:return!0}}var wM=class{constructor(e,t,n){this.push=e;this.includeMinIndentation=t;this.textModel=n}};function _M(o,e,t,n,i,r,s,a){if(s>200)return!0;let l=!0;if(o.kind===2){let d=0;if(a){let p=a.get(o.openingBracket.text);p===void 0&&(p=0),d=p,p++,a.set(o.openingBracket.text,p)}let c=jt(e,o.openingBracket.length),u=-1;if(r.includeMinIndentation&&(u=o.computeMinIndentation(e,r.textModel)),l=r.push(new LC(Nd(e,t),Nd(e,c),o.closingBracket?Nd(jt(c,o.child?.length||ei),t):void 0,s,d,o,u)),e=c,l&&o.child){let p=o.child;if(t=jt(e,p.length),Pd(e,i)&&ah(t,n)&&(l=_M(p,e,t,n,i,r,s+1,a),!l))return!1}a?.set(o.openingBracket.text,d)}else{let d=e;for(let c of o.children){let u=d;if(d=jt(d,c.length),Pd(u,i)&&Pd(n,d)&&(l=_M(c,u,d,n,i,r,s,a),!l))return!1}}return l}var _T=class extends F{constructor(t,n){super();this.textModel=t;this.languageConfigurationService=n}bracketPairsTree=this._register(new un);onDidChangeEmitter=new D;onDidChange=this.onDidChangeEmitter.event;get canBuildAST(){return this.textModel.getValueLength()<=5e6}bracketsRequested=!1;handleLanguageConfigurationServiceChange(t){(!t.languageId||this.bracketPairsTree.value?.object.didLanguageChange(t.languageId))&&(this.bracketPairsTree.clear(),this.updateBracketPairsTree())}handleDidChangeOptions(t){this.bracketPairsTree.clear(),this.updateBracketPairsTree()}handleDidChangeLanguage(t){this.bracketPairsTree.clear(),this.updateBracketPairsTree()}handleDidChangeContent(t){this.bracketPairsTree.value?.object.handleContentChanged(t)}handleDidChangeBackgroundTokenizationState(){this.bracketPairsTree.value?.object.handleDidChangeBackgroundTokenizationState()}handleDidChangeTokens(t){this.bracketPairsTree.value?.object.handleDidChangeTokens(t)}updateBracketPairsTree(){if(this.bracketsRequested&&this.canBuildAST){if(!this.bracketPairsTree.value){let t=new ee;this.bracketPairsTree.value=NK(t.add(new xT(this.textModel,n=>this.languageConfigurationService.getLanguageConfiguration(n))),t),t.add(this.bracketPairsTree.value.object.onDidChange(n=>this.onDidChangeEmitter.fire(n))),this.onDidChangeEmitter.fire()}}else this.bracketPairsTree.value&&(this.bracketPairsTree.clear(),this.onDidChangeEmitter.fire())}getBracketPairsInRange(t){return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getBracketPairsInRange(t,!1)||dl.empty}getBracketPairsInRangeWithMinIndentation(t){return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getBracketPairsInRange(t,!0)||dl.empty}getBracketsInRange(t,n=!1){return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getBracketsInRange(t,n)||dl.empty}findMatchingBracketUp(t,n,i){let r=this.textModel.validatePosition(n),s=this.textModel.getLanguageIdAtPosition(r.lineNumber,r.column);if(this.canBuildAST){let a=this.languageConfigurationService.getLanguageConfiguration(s).bracketsNew.getClosingBracketInfo(t);if(!a)return null;let l=this.getBracketPairsInRange(P.fromPositions(n,n)).findLast(d=>a.closes(d.openingBracketInfo));return l?l.openingBracketRange:null}else{let a=t.toLowerCase(),l=this.languageConfigurationService.getLanguageConfiguration(s).brackets;if(!l)return null;let d=l.textIsBracket[a];return d?wT(this._findMatchingBracketUp(d,r,LM(i))):null}}matchBracket(t,n){if(this.canBuildAST){let i=this.getBracketPairsInRange(P.fromPositions(t,t)).filter(r=>r.closingBracketRange!==void 0&&(r.openingBracketRange.containsPosition(t)||r.closingBracketRange.containsPosition(t))).findLastMaxBy(mo(r=>r.openingBracketRange.containsPosition(t)?r.openingBracketRange:r.closingBracketRange,P.compareRangesUsingStarts));return i?[i.openingBracketRange,i.closingBracketRange]:null}else{let i=LM(n);return this._matchBracket(this.textModel.validatePosition(t),i)}}_establishBracketSearchOffsets(t,n,i,r){let s=n.getCount(),a=n.getLanguageId(r),l=Math.max(0,t.column-1-i.maxBracketLength);for(let c=r-1;c>=0;c--){let u=n.getEndOffset(c);if(u<=l)break;if(Qr(n.getStandardTokenType(c))||n.getLanguageId(c)!==a){l=u;break}}let d=Math.min(n.getLineContent().length,t.column-1+i.maxBracketLength);for(let c=r+1;c<s;c++){let u=n.getStartOffset(c);if(u>=d)break;if(Qr(n.getStandardTokenType(c))||n.getLanguageId(c)!==a){d=u;break}}return{searchStartOffset:l,searchEndOffset:d}}_matchBracket(t,n){let i=t.lineNumber,r=this.textModel.tokenization.getLineTokens(i),s=this.textModel.getLineContent(i),a=r.findTokenIndexAtOffset(t.column-1);if(a<0)return null;let l=this.languageConfigurationService.getLanguageConfiguration(r.getLanguageId(a)).brackets;if(l&&!Qr(r.getStandardTokenType(a))){let{searchStartOffset:d,searchEndOffset:c}=this._establishBracketSearchOffsets(t,r,l,a),u=null;for(;;){let p=bo.findNextBracketInRange(l.forwardRegex,i,s,d,c);if(!p)break;if(p.startColumn<=t.column&&t.column<=p.endColumn){let h=s.substring(p.startColumn-1,p.endColumn-1).toLowerCase(),f=this._matchFoundBracket(p,l.textIsBracket[h],l.textIsOpenBracket[h],n);if(f){if(f instanceof Bl)return null;u=f}}d=p.endColumn-1}if(u)return u}if(a>0&&r.getStartOffset(a)===t.column-1){let d=a-1,c=this.languageConfigurationService.getLanguageConfiguration(r.getLanguageId(d)).brackets;if(c&&!Qr(r.getStandardTokenType(d))){let{searchStartOffset:u,searchEndOffset:p}=this._establishBracketSearchOffsets(t,r,c,d),h=bo.findPrevBracketInRange(c.reversedRegex,i,s,u,p);if(h&&h.startColumn<=t.column&&t.column<=h.endColumn){let f=s.substring(h.startColumn-1,h.endColumn-1).toLowerCase(),g=this._matchFoundBracket(h,c.textIsBracket[f],c.textIsOpenBracket[f],n);if(g)return g instanceof Bl?null:g}}}return null}_matchFoundBracket(t,n,i,r){if(!n)return null;let s=i?this._findMatchingBracketDown(n,t.getEndPosition(),r):this._findMatchingBracketUp(n,t.getStartPosition(),r);return s?s instanceof Bl?s:[t,s]:null}_findMatchingBracketUp(t,n,i){let r=t.languageId,s=t.reversedRegex,a=-1,l=0,d=(c,u,p,h)=>{for(;;){if(i&&++l%100===0&&!i())return Bl.INSTANCE;let f=bo.findPrevBracketInRange(s,c,u,p,h);if(!f)break;let g=u.substring(f.startColumn-1,f.endColumn-1).toLowerCase();if(t.isOpen(g)?a++:t.isClose(g)&&a--,a===0)return f;h=f.startColumn-1}return null};for(let c=n.lineNumber;c>=1;c--){let u=this.textModel.tokenization.getLineTokens(c),p=u.getCount(),h=this.textModel.getLineContent(c),f=p-1,g=h.length,b=h.length;c===n.lineNumber&&(f=u.findTokenIndexAtOffset(n.column-1),g=n.column-1,b=n.column-1);let v=!0;for(;f>=0;f--){let y=u.getLanguageId(f)===r&&!Qr(u.getStandardTokenType(f));if(y)v?g=u.getStartOffset(f):(g=u.getStartOffset(f),b=u.getEndOffset(f));else if(v&&g!==b){let S=d(c,h,g,b);if(S)return S}v=y}if(v&&g!==b){let y=d(c,h,g,b);if(y)return y}}return null}_findMatchingBracketDown(t,n,i){let r=t.languageId,s=t.forwardRegex,a=1,l=0,d=(u,p,h,f)=>{for(;;){if(i&&++l%100===0&&!i())return Bl.INSTANCE;let g=bo.findNextBracketInRange(s,u,p,h,f);if(!g)break;let b=p.substring(g.startColumn-1,g.endColumn-1).toLowerCase();if(t.isOpen(b)?a++:t.isClose(b)&&a--,a===0)return g;h=g.endColumn-1}return null},c=this.textModel.getLineCount();for(let u=n.lineNumber;u<=c;u++){let p=this.textModel.tokenization.getLineTokens(u),h=p.getCount(),f=this.textModel.getLineContent(u),g=0,b=0,v=0;u===n.lineNumber&&(g=p.findTokenIndexAtOffset(n.column-1),b=n.column-1,v=n.column-1);let y=!0;for(;g<h;g++){let S=p.getLanguageId(g)===r&&!Qr(p.getStandardTokenType(g));if(S)y||(b=p.getStartOffset(g)),v=p.getEndOffset(g);else if(y&&b!==v){let E=d(u,f,b,v);if(E)return E}y=S}if(y&&b!==v){let S=d(u,f,b,v);if(S)return S}}return null}findPrevBracket(t){let n=this.textModel.validatePosition(t);if(this.canBuildAST)return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getFirstBracketBefore(n)||null;let i=null,r=null,s=null;for(let a=n.lineNumber;a>=1;a--){let l=this.textModel.tokenization.getLineTokens(a),d=l.getCount(),c=this.textModel.getLineContent(a),u=d-1,p=c.length,h=c.length;if(a===n.lineNumber){u=l.findTokenIndexAtOffset(n.column-1),p=n.column-1,h=n.column-1;let g=l.getLanguageId(u);i!==g&&(i=g,r=this.languageConfigurationService.getLanguageConfiguration(i).brackets,s=this.languageConfigurationService.getLanguageConfiguration(i).bracketsNew)}let f=!0;for(;u>=0;u--){let g=l.getLanguageId(u);if(i!==g){if(r&&s&&f&&p!==h){let v=bo.findPrevBracketInRange(r.reversedRegex,a,c,p,h);if(v)return this._toFoundBracket(s,v);f=!1}i=g,r=this.languageConfigurationService.getLanguageConfiguration(i).brackets,s=this.languageConfigurationService.getLanguageConfiguration(i).bracketsNew}let b=!!r&&!Qr(l.getStandardTokenType(u));if(b)f?p=l.getStartOffset(u):(p=l.getStartOffset(u),h=l.getEndOffset(u));else if(s&&r&&f&&p!==h){let v=bo.findPrevBracketInRange(r.reversedRegex,a,c,p,h);if(v)return this._toFoundBracket(s,v)}f=b}if(s&&r&&f&&p!==h){let g=bo.findPrevBracketInRange(r.reversedRegex,a,c,p,h);if(g)return this._toFoundBracket(s,g)}}return null}findNextBracket(t){let n=this.textModel.validatePosition(t);if(this.canBuildAST)return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getFirstBracketAfter(n)||null;let i=this.textModel.getLineCount(),r=null,s=null,a=null;for(let l=n.lineNumber;l<=i;l++){let d=this.textModel.tokenization.getLineTokens(l),c=d.getCount(),u=this.textModel.getLineContent(l),p=0,h=0,f=0;if(l===n.lineNumber){p=d.findTokenIndexAtOffset(n.column-1),h=n.column-1,f=n.column-1;let b=d.getLanguageId(p);r!==b&&(r=b,s=this.languageConfigurationService.getLanguageConfiguration(r).brackets,a=this.languageConfigurationService.getLanguageConfiguration(r).bracketsNew)}let g=!0;for(;p<c;p++){let b=d.getLanguageId(p);if(r!==b){if(a&&s&&g&&h!==f){let y=bo.findNextBracketInRange(s.forwardRegex,l,u,h,f);if(y)return this._toFoundBracket(a,y);g=!1}r=b,s=this.languageConfigurationService.getLanguageConfiguration(r).brackets,a=this.languageConfigurationService.getLanguageConfiguration(r).bracketsNew}let v=!!s&&!Qr(d.getStandardTokenType(p));if(v)g||(h=d.getStartOffset(p)),f=d.getEndOffset(p);else if(a&&s&&g&&h!==f){let y=bo.findNextBracketInRange(s.forwardRegex,l,u,h,f);if(y)return this._toFoundBracket(a,y)}g=v}if(a&&s&&g&&h!==f){let b=bo.findNextBracketInRange(s.forwardRegex,l,u,h,f);if(b)return this._toFoundBracket(a,b)}}return null}findEnclosingBrackets(t,n){let i=this.textModel.validatePosition(t);if(this.canBuildAST){let f=P.fromPositions(i),g=this.getBracketPairsInRange(P.fromPositions(i,i)).findLast(b=>b.closingBracketRange!==void 0&&b.range.strictContainsRange(f));return g?[g.openingBracketRange,g.closingBracketRange]:null}let r=LM(n),s=this.textModel.getLineCount(),a=new Map,l=[],d=(f,g)=>{if(!a.has(f)){let b=[];for(let v=0,y=g?g.brackets.length:0;v<y;v++)b[v]=0;a.set(f,b)}l=a.get(f)},c=0,u=(f,g,b,v,y)=>{for(;;){if(r&&++c%100===0&&!r())return Bl.INSTANCE;let S=bo.findNextBracketInRange(f.forwardRegex,g,b,v,y);if(!S)break;let E=b.substring(S.startColumn-1,S.endColumn-1).toLowerCase(),C=f.textIsBracket[E];if(C&&(C.isOpen(E)?l[C.index]++:C.isClose(E)&&l[C.index]--,l[C.index]===-1))return this._matchFoundBracket(S,C,!1,r);v=S.endColumn-1}return null},p=null,h=null;for(let f=i.lineNumber;f<=s;f++){let g=this.textModel.tokenization.getLineTokens(f),b=g.getCount(),v=this.textModel.getLineContent(f),y=0,S=0,E=0;if(f===i.lineNumber){y=g.findTokenIndexAtOffset(i.column-1),S=i.column-1,E=i.column-1;let w=g.getLanguageId(y);p!==w&&(p=w,h=this.languageConfigurationService.getLanguageConfiguration(p).brackets,d(p,h))}let C=!0;for(;y<b;y++){let w=g.getLanguageId(y);if(p!==w){if(h&&C&&S!==E){let L=u(h,f,v,S,E);if(L)return wT(L);C=!1}p=w,h=this.languageConfigurationService.getLanguageConfiguration(p).brackets,d(p,h)}let _=!!h&&!Qr(g.getStandardTokenType(y));if(_)C||(S=g.getStartOffset(y)),E=g.getEndOffset(y);else if(h&&C&&S!==E){let L=u(h,f,v,S,E);if(L)return wT(L)}C=_}if(h&&C&&S!==E){let w=u(h,f,v,S,E);if(w)return wT(w)}}return null}_toFoundBracket(t,n){if(!n)return null;let i=this.textModel.getValueInRange(n);i=i.toLowerCase();let r=t.getBracketInfo(i);return r?{range:n,bracketInfo:r}:null}};function NK(o,e){return{object:o,dispose:()=>e?.dispose()}}function LM(o){if(typeof o>"u")return()=>!0;{let e=Date.now();return()=>Date.now()-e<=o}}var Bl=class o{static INSTANCE=new o;_searchCanceledBrand=void 0;constructor(){}};function wT(o){return o instanceof Bl?null:o}var RM=T("editor.lineHighlightBackground",null,m("lineHighlight","Background color for the highlight of line at the cursor position.")),kM=T("editor.lineHighlightBorder",{dark:"#282828",light:"#eeeeee",hcDark:"#f38518",hcLight:Ee},m("lineHighlightBorderBox","Background color for the border around the line at the cursor position.")),AZe=T("editor.rangeHighlightBackground",{dark:"#ffffff0b",light:"#fdff0033",hcDark:null,hcLight:null},m("rangeHighlight","Background color of highlighted ranges, like by quick open and find features. The color must not be opaque so as not to hide underlying decorations."),!0),FZe=T("editor.rangeHighlightBorder",{dark:null,light:null,hcDark:Pt,hcLight:Pt},m("rangeHighlightBorder","Background color of the border around highlighted ranges.")),BZe=T("editor.symbolHighlightBackground",{dark:Ws,light:Ws,hcDark:null,hcLight:null},m("symbolHighlight","Background color of highlighted symbol, like for go to definition or go next/previous symbol. The color must not be opaque so as not to hide underlying decorations."),!0),VZe=T("editor.symbolHighlightBorder",{dark:null,light:null,hcDark:Pt,hcLight:Pt},m("symbolHighlightBorder","Background color of the border around highlighted symbols.")),Im=T("editorCursor.foreground",{dark:"#AEAFAD",light:H.black,hcDark:H.white,hcLight:"#0F4A85"},m("caret","Color of the editor cursor.")),DT=T("editorCursor.background",null,m("editorCursorBackground","The background color of the editor cursor. Allows customizing the color of a character overlapped by a block cursor.")),LT=T("editorMultiCursor.primary.foreground",Im,m("editorMultiCursorPrimaryForeground","Color of the primary editor cursor when multiple cursors are present.")),AH=T("editorMultiCursor.primary.background",DT,m("editorMultiCursorPrimaryBackground","The background color of the primary editor cursor when multiple cursors are present. Allows customizing the color of a character overlapped by a block cursor.")),RT=T("editorMultiCursor.secondary.foreground",Im,m("editorMultiCursorSecondaryForeground","Color of secondary editor cursors when multiple cursors are present.")),FH=T("editorMultiCursor.secondary.background",DT,m("editorMultiCursorSecondaryBackground","The background color of secondary editor cursors when multiple cursors are present. Allows customizing the color of a character overlapped by a block cursor.")),kT=T("editorWhitespace.foreground",{dark:"#e3e4e229",light:"#33333333",hcDark:"#e3e4e229",hcLight:"#CCCCCC"},m("editorWhitespaces","Color of whitespace characters in the editor.")),BH=T("editorLineNumber.foreground",{dark:"#858585",light:"#237893",hcDark:H.white,hcLight:"#292929"},m("editorLineNumbers","Color of editor line numbers.")),AK=T("editorIndentGuide.background",kT,m("editorIndentGuides","Color of the editor indentation guides."),!1,m("deprecatedEditorIndentGuides","'editorIndentGuide.background' is deprecated. Use 'editorIndentGuide.background1' instead.")),FK=T("editorIndentGuide.activeBackground",kT,m("editorActiveIndentGuide","Color of the active editor indentation guides."),!1,m("deprecatedEditorActiveIndentGuide","'editorIndentGuide.activeBackground' is deprecated. Use 'editorIndentGuide.activeBackground1' instead.")),VH=T("editorIndentGuide.background1",AK,m("editorIndentGuides1","Color of the editor indentation guides (1).")),WH=T("editorIndentGuide.background2","#00000000",m("editorIndentGuides2","Color of the editor indentation guides (2).")),HH=T("editorIndentGuide.background3","#00000000",m("editorIndentGuides3","Color of the editor indentation guides (3).")),UH=T("editorIndentGuide.background4","#00000000",m("editorIndentGuides4","Color of the editor indentation guides (4).")),zH=T("editorIndentGuide.background5","#00000000",m("editorIndentGuides5","Color of the editor indentation guides (5).")),KH=T("editorIndentGuide.background6","#00000000",m("editorIndentGuides6","Color of the editor indentation guides (6).")),GH=T("editorIndentGuide.activeBackground1",FK,m("editorActiveIndentGuide1","Color of the active editor indentation guides (1).")),jH=T("editorIndentGuide.activeBackground2","#00000000",m("editorActiveIndentGuide2","Color of the active editor indentation guides (2).")),qH=T("editorIndentGuide.activeBackground3","#00000000",m("editorActiveIndentGuide3","Color of the active editor indentation guides (3).")),$H=T("editorIndentGuide.activeBackground4","#00000000",m("editorActiveIndentGuide4","Color of the active editor indentation guides (4).")),YH=T("editorIndentGuide.activeBackground5","#00000000",m("editorActiveIndentGuide5","Color of the active editor indentation guides (5).")),ZH=T("editorIndentGuide.activeBackground6","#00000000",m("editorActiveIndentGuide6","Color of the active editor indentation guides (6).")),BK=T("editorActiveLineNumber.foreground",{dark:"#c6c6c6",light:"#0B216F",hcDark:Pt,hcLight:Pt},m("editorActiveLineNumber","Color of editor active line number"),!1,m("deprecatedEditorActiveLineNumber","Id is deprecated. Use 'editorLineNumber.activeForeground' instead.")),WZe=T("editorLineNumber.activeForeground",BK,m("editorActiveLineNumber","Color of editor active line number")),XH=T("editorLineNumber.dimmedForeground",null,m("editorDimmedLineNumber","Color of the final editor line when editor.renderFinalNewline is set to dimmed.")),HZe=T("editorRuler.foreground",{dark:"#5A5A5A",light:H.lightgrey,hcDark:H.white,hcLight:"#292929"},m("editorRuler","Color of the editor rulers.")),UZe=T("editorCodeLens.foreground",{dark:"#999999",light:"#919191",hcDark:"#999999",hcLight:"#292929"},m("editorCodeLensForeground","Foreground color of editor CodeLens")),zZe=T("editorBracketMatch.background",{dark:"#0064001a",light:"#0064001a",hcDark:"#0064001a",hcLight:"#0000"},m("editorBracketMatchBackground","Background color behind matching brackets")),KZe=T("editorBracketMatch.border",{dark:"#888",light:"#B9B9B9",hcDark:Ee,hcLight:Ee},m("editorBracketMatchBorder","Color for matching brackets boxes")),QH=T("editorOverviewRuler.border",{dark:"#7f7f7f4d",light:"#7f7f7f4d",hcDark:"#7f7f7f4d",hcLight:"#666666"},m("editorOverviewRulerBorder","Color of the overview ruler border.")),JH=T("editorOverviewRuler.background",null,m("editorOverviewRulerBackground","Background color of the editor overview ruler.")),GZe=T("editorGutter.background",ss,m("editorGutter","Background color of the editor gutter. The gutter contains the glyph margins and the line numbers.")),jZe=T("editorUnnecessaryCode.border",{dark:null,light:null,hcDark:H.fromHex("#fff").transparent(.8),hcLight:Ee},m("unnecessaryCodeBorder","Border color of unnecessary (unused) source code in the editor.")),eU=T("editorUnnecessaryCode.opacity",{dark:H.fromHex("#000a"),light:H.fromHex("#0007"),hcDark:null,hcLight:null},m("unnecessaryCodeOpacity",`Opacity of unnecessary (unused) source code in the editor. For example, "#000000c0" will render the code with 75% opacity. For high contrast themes, use the  'editorUnnecessaryCode.border' theme color to underline unnecessary code instead of fading it out.`)),qZe=T("editorGhostText.border",{dark:null,light:null,hcDark:H.fromHex("#fff").transparent(.8),hcLight:H.fromHex("#292929").transparent(.8)},m("editorGhostTextBorder","Border color of ghost text in the editor.")),$Ze=T("editorGhostText.foreground",{dark:H.fromHex("#ffffff56"),light:H.fromHex("#0007"),hcDark:null,hcLight:null},m("editorGhostTextForeground","Foreground color of the ghost text in the editor.")),YZe=T("editorGhostText.background",null,m("editorGhostTextBackground","Background color of the ghost text in the editor.")),VK=new H(new tt(0,122,204,.6)),ZZe=T("editorOverviewRuler.rangeHighlightForeground",VK,m("overviewRulerRangeHighlight","Overview ruler marker color for range highlights. The color must not be opaque so as not to hide underlying decorations."),!0),XZe=T("editorOverviewRuler.errorForeground",{dark:new H(new tt(255,18,18,.7)),light:new H(new tt(255,18,18,.7)),hcDark:new H(new tt(255,50,50,1)),hcLight:"#B5200D"},m("overviewRuleError","Overview ruler marker color for errors.")),QZe=T("editorOverviewRuler.warningForeground",{dark:Eo,light:Eo,hcDark:Yh,hcLight:Yh},m("overviewRuleWarning","Overview ruler marker color for warnings.")),JZe=T("editorOverviewRuler.infoForeground",{dark:mr,light:mr,hcDark:Zh,hcLight:Zh},m("overviewRuleInfo","Overview ruler marker color for infos.")),MT=T("editorBracketHighlight.foreground1",{dark:"#FFD700",light:"#0431FAFF",hcDark:"#FFD700",hcLight:"#0431FAFF"},m("editorBracketHighlightForeground1","Foreground color of brackets (1). Requires enabling bracket pair colorization.")),PT=T("editorBracketHighlight.foreground2",{dark:"#DA70D6",light:"#319331FF",hcDark:"#DA70D6",hcLight:"#319331FF"},m("editorBracketHighlightForeground2","Foreground color of brackets (2). Requires enabling bracket pair colorization.")),OT=T("editorBracketHighlight.foreground3",{dark:"#179FFF",light:"#7B3814FF",hcDark:"#87CEFA",hcLight:"#7B3814FF"},m("editorBracketHighlightForeground3","Foreground color of brackets (3). Requires enabling bracket pair colorization.")),NT=T("editorBracketHighlight.foreground4","#00000000",m("editorBracketHighlightForeground4","Foreground color of brackets (4). Requires enabling bracket pair colorization.")),AT=T("editorBracketHighlight.foreground5","#00000000",m("editorBracketHighlightForeground5","Foreground color of brackets (5). Requires enabling bracket pair colorization.")),FT=T("editorBracketHighlight.foreground6","#00000000",m("editorBracketHighlightForeground6","Foreground color of brackets (6). Requires enabling bracket pair colorization.")),tU=T("editorBracketHighlight.unexpectedBracket.foreground",{dark:new H(new tt(255,18,18,.8)),light:new H(new tt(255,18,18,.8)),hcDark:"new Color(new RGBA(255, 50, 50, 1))",hcLight:"#B5200D"},m("editorBracketHighlightUnexpectedBracketForeground","Foreground color of unexpected brackets.")),nU=T("editorBracketPairGuide.background1","#00000000",m("editorBracketPairGuide.background1","Background color of inactive bracket pair guides (1). Requires enabling bracket pair guides.")),iU=T("editorBracketPairGuide.background2","#00000000",m("editorBracketPairGuide.background2","Background color of inactive bracket pair guides (2). Requires enabling bracket pair guides.")),oU=T("editorBracketPairGuide.background3","#00000000",m("editorBracketPairGuide.background3","Background color of inactive bracket pair guides (3). Requires enabling bracket pair guides.")),rU=T("editorBracketPairGuide.background4","#00000000",m("editorBracketPairGuide.background4","Background color of inactive bracket pair guides (4). Requires enabling bracket pair guides.")),sU=T("editorBracketPairGuide.background5","#00000000",m("editorBracketPairGuide.background5","Background color of inactive bracket pair guides (5). Requires enabling bracket pair guides.")),aU=T("editorBracketPairGuide.background6","#00000000",m("editorBracketPairGuide.background6","Background color of inactive bracket pair guides (6). Requires enabling bracket pair guides.")),lU=T("editorBracketPairGuide.activeBackground1","#00000000",m("editorBracketPairGuide.activeBackground1","Background color of active bracket pair guides (1). Requires enabling bracket pair guides.")),dU=T("editorBracketPairGuide.activeBackground2","#00000000",m("editorBracketPairGuide.activeBackground2","Background color of active bracket pair guides (2). Requires enabling bracket pair guides.")),cU=T("editorBracketPairGuide.activeBackground3","#00000000",m("editorBracketPairGuide.activeBackground3","Background color of active bracket pair guides (3). Requires enabling bracket pair guides.")),uU=T("editorBracketPairGuide.activeBackground4","#00000000",m("editorBracketPairGuide.activeBackground4","Background color of active bracket pair guides (4). Requires enabling bracket pair guides.")),pU=T("editorBracketPairGuide.activeBackground5","#00000000",m("editorBracketPairGuide.activeBackground5","Background color of active bracket pair guides (5). Requires enabling bracket pair guides.")),hU=T("editorBracketPairGuide.activeBackground6","#00000000",m("editorBracketPairGuide.activeBackground6","Background color of active bracket pair guides (6). Requires enabling bracket pair guides.")),eXe=T("editorUnicodeHighlight.border",Eo,m("editorUnicodeHighlight.border","Border color used to highlight unicode characters.")),tXe=T("editorUnicodeHighlight.background",t2,m("editorUnicodeHighlight.background","Background color used to highlight unicode characters."));To((o,e)=>{let t=o.getColor(ss),n=o.getColor(RM),i=n&&!n.isTransparent()?n:t;i&&e.addRule(`.monaco-editor .inputarea.ime-input { background-color: ${i}; }`)});var BT=class extends F{constructor(t){super();this.textModel=t;this.colorizationOptions=t.getOptions().bracketPairColorizationOptions,this._register(t.bracketPairs.onDidChange(n=>{this.onDidChangeEmitter.fire()}))}colorizationOptions;colorProvider=new VT;onDidChangeEmitter=new D;onDidChange=this.onDidChangeEmitter.event;handleDidChangeOptions(t){this.colorizationOptions=this.textModel.getOptions().bracketPairColorizationOptions}getDecorationsInRange(t,n,i,r){return r?[]:n===void 0?[]:this.colorizationOptions.enabled?this.textModel.bracketPairs.getBracketsInRange(t,!0).map(a=>({id:`bracket${a.range.toString()}-${a.nestingLevel}`,options:{description:"BracketPairColorization",inlineClassName:this.colorProvider.getInlineClassName(a,this.colorizationOptions.independentColorPoolPerBracketType)},ownerId:0,range:a.range})).toArray():[]}getAllDecorations(t,n){return t===void 0?[]:this.colorizationOptions.enabled?this.getDecorationsInRange(new P(1,1,this.textModel.getLineCount(),1),t,n):[]}},VT=class{unexpectedClosingBracketClassName="unexpected-closing-bracket";getInlineClassName(e,t){return e.isInvalid?this.unexpectedClosingBracketClassName:this.getInlineClassNameOfLevel(t?e.nestingLevelOfEqualBracketType:e.nestingLevel)}getInlineClassNameOfLevel(e){return`bracket-highlighting-${e%30}`}};To((o,e)=>{let t=[MT,PT,OT,NT,AT,FT],n=new VT;e.addRule(`.monaco-editor .${n.unexpectedClosingBracketClassName} { color: ${o.getColor(tU)}; }`);let i=t.map(r=>o.getColor(r)).filter(r=>!!r).filter(r=>!r.isTransparent());for(let r=0;r<30;r++){let s=i[r%i.length];e.addRule(`.monaco-editor .${n.getInlineClassNameOfLevel(r)} { color: ${s}; }`)}});function Cm(o){return o.toString()}var Go=class o{constructor(e,t,n,i,r,s,a){this.beforeVersionId=e;this.afterVersionId=t;this.beforeEOL=n;this.afterEOL=i;this.beforeCursorState=r;this.afterCursorState=s;this.changes=a}static create(e,t){let n=e.getAlternativeVersionId(),i=OM(e);return new o(n,n,i,i,t,t,[])}append(e,t,n,i,r){t.length>0&&(this.changes=nB(this.changes,t)),this.afterEOL=n,this.afterVersionId=i,this.afterCursorState=r}static _writeSelectionsSize(e){return 4+4*4*(e?e.length:0)}static _writeSelections(e,t,n){if(hi(e,t?t.length:0,n),n+=4,t)for(let i of t)hi(e,i.selectionStartLineNumber,n),n+=4,hi(e,i.selectionStartColumn,n),n+=4,hi(e,i.positionLineNumber,n),n+=4,hi(e,i.positionColumn,n),n+=4;return n}static _readSelections(e,t,n){let i=pi(e,t);t+=4;for(let r=0;r<i;r++){let s=pi(e,t);t+=4;let a=pi(e,t);t+=4;let l=pi(e,t);t+=4;let d=pi(e,t);t+=4,n.push(new $e(s,a,l,d))}return t}serialize(){let e=10+o._writeSelectionsSize(this.beforeCursorState)+o._writeSelectionsSize(this.afterCursorState)+4;for(let i of this.changes)e+=i.writeSize();let t=new Uint8Array(e),n=0;hi(t,this.beforeVersionId,n),n+=4,hi(t,this.afterVersionId,n),n+=4,II(t,this.beforeEOL,n),n+=1,II(t,this.afterEOL,n),n+=1,n=o._writeSelections(t,this.beforeCursorState,n),n=o._writeSelections(t,this.afterCursorState,n),hi(t,this.changes.length,n),n+=4;for(let i of this.changes)n=i.write(t,n);return t.buffer}static deserialize(e){let t=new Uint8Array(e),n=0,i=pi(t,n);n+=4;let r=pi(t,n);n+=4;let s=yI(t,n);n+=1;let a=yI(t,n);n+=1;let l=[];n=o._readSelections(t,n,l);let d=[];n=o._readSelections(t,n,d);let c=pi(t,n);n+=4;let u=[];for(let p=0;p<c;p++)n=sr.read(t,n,u);return new o(i,r,s,a,l,d,u)}},WT=class{constructor(e,t,n,i){this.label=e;this.code=t;this.model=n,this._data=Go.create(n,i)}model;_data;get type(){return 0}get resource(){return J.isUri(this.model)?this.model:this.model.uri}toString(){return(this._data instanceof Go?this._data:Go.deserialize(this._data)).changes.map(t=>t.toString()).join(", ")}matchesResource(e){return(J.isUri(this.model)?this.model:this.model.uri).toString()===e.toString()}setModel(e){this.model=e}canAppend(e){return this.model===e&&this._data instanceof Go}append(e,t,n,i,r){this._data instanceof Go&&this._data.append(e,t,n,i,r)}close(){this._data instanceof Go&&(this._data=this._data.serialize())}open(){this._data instanceof Go||(this._data=Go.deserialize(this._data))}undo(){if(J.isUri(this.model))throw new Error("Invalid SingleModelEditStackElement");this._data instanceof Go&&(this._data=this._data.serialize());let e=Go.deserialize(this._data);this.model._applyUndo(e.changes,e.beforeEOL,e.beforeVersionId,e.beforeCursorState)}redo(){if(J.isUri(this.model))throw new Error("Invalid SingleModelEditStackElement");this._data instanceof Go&&(this._data=this._data.serialize());let e=Go.deserialize(this._data);this.model._applyRedo(e.changes,e.afterEOL,e.afterVersionId,e.afterCursorState)}heapSize(){return this._data instanceof Go&&(this._data=this._data.serialize()),this._data.byteLength+168}},PM=class{constructor(e,t,n){this.label=e;this.code=t;this._isOpen=!0,this._editStackElementsArr=n.slice(0),this._editStackElementsMap=new Map;for(let i of this._editStackElementsArr){let r=Cm(i.resource);this._editStackElementsMap.set(r,i)}this._delegate=null}type=1;_isOpen;_editStackElementsArr;_editStackElementsMap;_delegate;get resources(){return this._editStackElementsArr.map(e=>e.resource)}setDelegate(e){this._delegate=e}prepareUndoRedo(){if(this._delegate)return this._delegate.prepareUndoRedo(this)}getMissingModels(){let e=[];for(let t of this._editStackElementsArr)J.isUri(t.model)&&e.push(t.model);return e}matchesResource(e){let t=Cm(e);return this._editStackElementsMap.has(t)}setModel(e){let t=Cm(J.isUri(e)?e:e.uri);this._editStackElementsMap.has(t)&&this._editStackElementsMap.get(t).setModel(e)}canAppend(e){if(!this._isOpen)return!1;let t=Cm(e.uri);return this._editStackElementsMap.has(t)?this._editStackElementsMap.get(t).canAppend(e):!1}append(e,t,n,i,r){let s=Cm(e.uri);this._editStackElementsMap.get(s).append(e,t,n,i,r)}close(){this._isOpen=!1}open(){}undo(){this._isOpen=!1;for(let e of this._editStackElementsArr)e.undo()}redo(){for(let e of this._editStackElementsArr)e.redo()}heapSize(e){let t=Cm(e);return this._editStackElementsMap.has(t)?this._editStackElementsMap.get(t).heapSize():0}split(){return this._editStackElementsArr}toString(){let e=[];for(let t of this._editStackElementsArr)e.push(`${go(t.resource)}: ${t}`);return`{${e.join(", ")}}`}};function OM(o){return o.getEOL()===`
`?0:1}function MM(o){return o?o instanceof WT||o instanceof PM:!1}var HT=class o{_model;_undoRedoService;constructor(e,t){this._model=e,this._undoRedoService=t}pushStackElement(){let e=this._undoRedoService.getLastElement(this._model.uri);MM(e)&&e.close()}popStackElement(){let e=this._undoRedoService.getLastElement(this._model.uri);MM(e)&&e.open()}clear(){this._undoRedoService.removeElements(this._model.uri)}_getOrCreateEditStackElement(e,t){let n=this._undoRedoService.getLastElement(this._model.uri);if(MM(n)&&n.canAppend(this._model))return n;let i=new WT(m("edit","Typing"),"undoredo.textBufferEdit",this._model,e);return this._undoRedoService.pushElement(i,t),i}pushEOL(e){let t=this._getOrCreateEditStackElement(null,void 0);this._model.setEOL(e),t.append(this._model,[],OM(this._model),this._model.getAlternativeVersionId(),null)}pushEditOperation(e,t,n,i){let r=this._getOrCreateEditStackElement(e,i),s=this._model.applyEdits(t,!0),a=o._computeCursorState(n,s),l=s.map((d,c)=>({index:c,textChange:d.textChange}));return l.sort((d,c)=>d.textChange.oldPosition===c.textChange.oldPosition?d.index-c.index:d.textChange.oldPosition-c.textChange.oldPosition),r.append(this._model,l.map(d=>d.textChange),OM(this._model),this._model.getAlternativeVersionId(),a),a}static _computeCursorState(e,t){try{return e?e(t):null}catch(n){return qe(n),null}}};var Sm=class extends F{_isDisposed=!1;dispose(){super.dispose(),this._isDisposed=!0}assertNotDisposed(){if(this._isDisposed)throw new Error("TextModelPart is disposed!")}};function gU(o,e){let t=0,n=0,i=o.length;for(;n<i;){let r=o.charCodeAt(n);if(r===32)t++;else if(r===9)t=t-t%e+e;else break;n++}return n===i?-1:t}var UT=class extends Sm{constructor(t,n){super();this.textModel=t;this.languageConfigurationService=n}getLanguageConfiguration(t){return this.languageConfigurationService.getLanguageConfiguration(t)}_computeIndentLevel(t){return gU(this.textModel.getLineContent(t+1),this.textModel.getOptions().tabSize)}getActiveIndentGuide(t,n,i){this.assertNotDisposed();let r=this.textModel.getLineCount();if(t<1||t>r)throw new Ye("Illegal value for lineNumber");let s=this.getLanguageConfiguration(this.textModel.getLanguageId()).foldingRules,a=!!(s&&s.offSide),l=-2,d=-1,c=-2,u=-1,p=L=>{if(l!==-1&&(l===-2||l>L-1)){l=-1,d=-1;for(let k=L-2;k>=0;k--){let W=this._computeIndentLevel(k);if(W>=0){l=k,d=W;break}}}if(c===-2){c=-1,u=-1;for(let k=L;k<r;k++){let W=this._computeIndentLevel(k);if(W>=0){c=k,u=W;break}}}},h=-2,f=-1,g=-2,b=-1,v=L=>{if(h===-2){h=-1,f=-1;for(let k=L-2;k>=0;k--){let W=this._computeIndentLevel(k);if(W>=0){h=k,f=W;break}}}if(g!==-1&&(g===-2||g<L-1)){g=-1,b=-1;for(let k=L;k<r;k++){let W=this._computeIndentLevel(k);if(W>=0){g=k,b=W;break}}}},y=0,S=!0,E=0,C=!0,w=0,_=0;for(let L=0;S||C;L++){let k=t-L,W=t+L;L>1&&(k<1||k<n)&&(S=!1),L>1&&(W>r||W>i)&&(C=!1),L>5e4&&(S=!1,C=!1);let K=-1;if(S&&k>=1){let oe=this._computeIndentLevel(k-1);oe>=0?(c=k-1,u=oe,K=Math.ceil(oe/this.textModel.getOptions().indentSize)):(p(k),K=this._getIndentLevelForWhitespaceLine(a,d,u))}let U=-1;if(C&&W<=r){let oe=this._computeIndentLevel(W-1);oe>=0?(h=W-1,f=oe,U=Math.ceil(oe/this.textModel.getOptions().indentSize)):(v(W),U=this._getIndentLevelForWhitespaceLine(a,f,b))}if(L===0){_=K;continue}if(L===1){if(W<=r&&U>=0&&_+1===U){S=!1,y=W,E=W,w=U;continue}if(k>=1&&K>=0&&K-1===_){C=!1,y=k,E=k,w=K;continue}if(y=t,E=t,w=_,w===0)return{startLineNumber:y,endLineNumber:E,indent:w}}S&&(K>=w?y=k:S=!1),C&&(U>=w?E=W:C=!1)}return{startLineNumber:y,endLineNumber:E,indent:w}}getLinesBracketGuides(t,n,i,r){let s=[];for(let p=t;p<=n;p++)s.push([]);let a=!0,l=this.textModel.bracketPairs.getBracketPairsInRangeWithMinIndentation(new P(t,1,n,this.textModel.getLineMaxColumn(n))).toArray(),d;if(i&&l.length>0){let p=(t<=i.lineNumber&&i.lineNumber<=n?l:this.textModel.bracketPairs.getBracketPairsInRange(P.fromPositions(i)).toArray()).filter(h=>P.strictContainsPosition(h.range,i));d=Vc(p,h=>a||h.range.startLineNumber!==h.range.endLineNumber)?.range}let c=this.textModel.getOptions().bracketPairColorizationOptions.independentColorPoolPerBracketType,u=new lv;for(let p of l){if(!p.closingBracketRange)continue;let h=d&&p.range.equalsRange(d);if(!h&&!r.includeInactive)continue;let f=u.getInlineClassName(p.nestingLevel,p.nestingLevelOfEqualBracketType,c)+(r.highlightActive&&h?" "+u.activeClassName:""),g=p.openingBracketRange.getStartPosition(),b=p.closingBracketRange.getStartPosition(),v=r.horizontalGuides===2||r.horizontalGuides===1&&h;if(p.range.startLineNumber===p.range.endLineNumber){a&&v&&s[p.range.startLineNumber-t].push(new ts(-1,p.openingBracketRange.getEndPosition().column,f,new wl(!1,b.column),-1,-1));continue}let y=this.getVisibleColumnFromPosition(b),S=this.getVisibleColumnFromPosition(p.openingBracketRange.getStartPosition()),E=Math.min(S,y,p.minVisibleColumnIndentation+1),C=!1;Cn(this.textModel.getLineContent(p.closingBracketRange.startLineNumber))<p.closingBracketRange.startColumn-1&&(C=!0);let L=Math.max(g.lineNumber,t),k=Math.min(b.lineNumber,n),W=C?1:0;for(let K=L;K<k+W;K++)s[K-t].push(new ts(E,-1,f,null,K===g.lineNumber?g.column:-1,K===b.lineNumber?b.column:-1));v&&(g.lineNumber>=t&&S>E&&s[g.lineNumber-t].push(new ts(E,-1,f,new wl(!1,g.column),-1,-1)),b.lineNumber<=n&&y>E&&s[b.lineNumber-t].push(new ts(E,-1,f,new wl(!C,b.column),-1,-1)))}for(let p of s)p.sort((h,f)=>h.visibleColumn-f.visibleColumn);return s}getVisibleColumnFromPosition(t){return Vt.visibleColumnFromColumn(this.textModel.getLineContent(t.lineNumber),t.column,this.textModel.getOptions().tabSize)+1}getLinesIndentGuides(t,n){this.assertNotDisposed();let i=this.textModel.getLineCount();if(t<1||t>i)throw new Error("Illegal value for startLineNumber");if(n<1||n>i)throw new Error("Illegal value for endLineNumber");let r=this.textModel.getOptions(),s=this.getLanguageConfiguration(this.textModel.getLanguageId()).foldingRules,a=!!(s&&s.offSide),l=new Array(n-t+1),d=-2,c=-1,u=-2,p=-1;for(let h=t;h<=n;h++){let f=h-t,g=this._computeIndentLevel(h-1);if(g>=0){d=h-1,c=g,l[f]=Math.ceil(g/r.indentSize);continue}if(d===-2){d=-1,c=-1;for(let b=h-2;b>=0;b--){let v=this._computeIndentLevel(b);if(v>=0){d=b,c=v;break}}}if(u!==-1&&(u===-2||u<h-1)){u=-1,p=-1;for(let b=h;b<i;b++){let v=this._computeIndentLevel(b);if(v>=0){u=b,p=v;break}}}l[f]=this._getIndentLevelForWhitespaceLine(a,c,p)}return l}_getIndentLevelForWhitespaceLine(t,n,i){let r=this.textModel.getOptions();return n===-1||i===-1?0:n<i?1+Math.floor(n/r.indentSize):n===i||t?Math.ceil(i/r.indentSize):1+Math.floor(i/r.indentSize)}},lv=class{activeClassName="indent-active";getInlineClassName(e,t,n){return this.getInlineClassNameOfLevel(n?t:e)}getInlineClassNameOfLevel(e){return`bracket-indent-guide lvl-${e%30}`}};var NM=class{spacesDiff=0;looksLikeAlignment=!1};function HK(o,e,t,n,i){i.spacesDiff=0,i.looksLikeAlignment=!1;let r;for(r=0;r<e&&r<n;r++){let p=o.charCodeAt(r),h=t.charCodeAt(r);if(p!==h)break}let s=0,a=0;for(let p=r;p<e;p++)o.charCodeAt(p)===32?s++:a++;let l=0,d=0;for(let p=r;p<n;p++)t.charCodeAt(p)===32?l++:d++;if(s>0&&a>0||l>0&&d>0)return;let c=Math.abs(a-d),u=Math.abs(s-l);if(c===0){i.spacesDiff=u,u>0&&0<=l-1&&l-1<o.length&&l<t.length&&t.charCodeAt(l)!==32&&o.charCodeAt(l-1)===32&&o.charCodeAt(o.length-1)===44&&(i.looksLikeAlignment=!0);return}if(u%c===0){i.spacesDiff=u/c;return}}function AM(o,e,t){let n=Math.min(o.getLineCount(),1e4),i=0,r=0,s="",a=0,l=[2,4,6,8,3,5,7],d=8,c=[0,0,0,0,0,0,0,0,0],u=new NM;for(let f=1;f<=n;f++){let g=o.getLineLength(f),b=o.getLineContent(f),v=g<=65536,y=!1,S=0,E=0,C=0;for(let _=0,L=g;_<L;_++){let k=v?b.charCodeAt(_):o.getLineCharCode(f,_);if(k===9)C++;else if(k===32)E++;else{y=!0,S=_;break}}if(!y||(C>0?i++:E>1&&r++,HK(s,a,b,S,u),u.looksLikeAlignment&&!(t&&e===u.spacesDiff)))continue;let w=u.spacesDiff;w<=d&&c[w]++,s=b,a=S}let p=t;i!==r&&(p=i<r);let h=e;if(p){let f=p?0:.1*n;l.forEach(g=>{let b=c[g];b>f&&(f=b,h=g)}),h===4&&c[4]>0&&c[2]>0&&c[2]>=c[4]/2&&(h=2)}return{insertSpaces:p,tabSize:h}}function wo(o){return(o.metadata&1)>>>0}function Wt(o,e){o.metadata=o.metadata&254|e<<0}function vi(o){return(o.metadata&2)>>>1===1}function Ot(o,e){o.metadata=o.metadata&253|(e?1:0)<<1}function EU(o){return(o.metadata&4)>>>2===1}function fU(o,e){o.metadata=o.metadata&251|(e?1:0)<<2}function TU(o){return(o.metadata&64)>>>6===1}function bU(o,e){o.metadata=o.metadata&191|(e?1:0)<<6}function UK(o){return(o.metadata&24)>>>3}function vU(o,e){o.metadata=o.metadata&231|e<<3}function zK(o){return(o.metadata&32)>>>5===1}function yU(o,e){o.metadata=o.metadata&223|(e?1:0)<<5}var uv=class{metadata;parent;left;right;start;end;delta;maxEnd;id;ownerId;options;cachedVersionId;cachedAbsoluteStart;cachedAbsoluteEnd;range;constructor(e,t,n){this.metadata=0,this.parent=this,this.left=this,this.right=this,Wt(this,1),this.start=t,this.end=n,this.delta=0,this.maxEnd=n,this.id=e,this.ownerId=0,this.options=null,fU(this,!1),bU(this,!1),vU(this,1),yU(this,!1),this.cachedVersionId=0,this.cachedAbsoluteStart=t,this.cachedAbsoluteEnd=n,this.range=null,Ot(this,!1)}reset(e,t,n,i){this.start=t,this.end=n,this.maxEnd=n,this.cachedVersionId=e,this.cachedAbsoluteStart=t,this.cachedAbsoluteEnd=n,this.range=i}setOptions(e){this.options=e;let t=this.options.className;fU(this,t==="squiggly-error"||t==="squiggly-warning"||t==="squiggly-info"),bU(this,this.options.glyphMarginClassName!==null),vU(this,this.options.stickiness),yU(this,this.options.collapseOnReplaceEdit)}setCachedOffsets(e,t,n){this.cachedVersionId!==n&&(this.range=null),this.cachedVersionId=n,this.cachedAbsoluteStart=e,this.cachedAbsoluteEnd=t}detach(){this.parent=null,this.left=null,this.right=null}},Qe=new uv(null,0,0);Qe.parent=Qe;Qe.left=Qe;Qe.right=Qe;Wt(Qe,0);var Tm=class{root;requestNormalizeDelta;constructor(){this.root=Qe,this.requestNormalizeDelta=!1}intervalSearch(e,t,n,i,r,s){return this.root===Qe?[]:ZK(this,e,t,n,i,r,s)}search(e,t,n,i){return this.root===Qe?[]:IU(this,e,t,n,i)}collectNodesFromOwner(e){return $K(this,e)}collectNodesPostOrder(){return YK(this)}insert(e){CU(this,e),this._normalizeDeltaIfNecessary()}delete(e){SU(this,e),this._normalizeDeltaIfNecessary()}resolveNode(e,t){let n=e,i=0;for(;e!==this.root;)e===e.parent.right&&(i+=e.parent.delta),e=e.parent;let r=n.start+i,s=n.end+i;n.setCachedOffsets(r,s,t)}acceptReplace(e,t,n,i){let r=jK(this,e,e+t);for(let s=0,a=r.length;s<a;s++){let l=r[s];SU(this,l)}this._normalizeDeltaIfNecessary(),qK(this,e,e+t,n),this._normalizeDeltaIfNecessary();for(let s=0,a=r.length;s<a;s++){let l=r[s];l.start=l.cachedAbsoluteStart,l.end=l.cachedAbsoluteEnd,GK(l,e,e+t,n,i),l.maxEnd=l.end,CU(this,l)}this._normalizeDeltaIfNecessary()}getAllInOrder(){return IU(this,0,!1,0,!1)}_normalizeDeltaIfNecessary(){this.requestNormalizeDelta&&(this.requestNormalizeDelta=!1,KK(this))}};function KK(o){let e=o.root,t=0;for(;e!==Qe;){if(e.left!==Qe&&!vi(e.left)){e=e.left;continue}if(e.right!==Qe&&!vi(e.right)){t+=e.delta,e=e.right;continue}e.start=t+e.start,e.end=t+e.end,e.delta=0,Vl(e),Ot(e,!0),Ot(e.left,!1),Ot(e.right,!1),e===e.parent.right&&(t-=e.parent.delta),e=e.parent}Ot(o.root,!1)}function Em(o,e,t,n){return o<t?!0:o>t||n===1?!1:n===2?!0:e}function GK(o,e,t,n,i){let r=UK(o),s=r===0||r===2,a=r===1||r===2,l=t-e,d=n,c=Math.min(l,d),u=o.start,p=!1,h=o.end,f=!1;e<=u&&h<=t&&zK(o)&&(o.start=e,p=!0,o.end=e,f=!0);{let b=i?1:l>0?2:0;!p&&Em(u,s,e,b)&&(p=!0),!f&&Em(h,a,e,b)&&(f=!0)}if(c>0&&!i){let b=l>d?2:0;!p&&Em(u,s,e+c,b)&&(p=!0),!f&&Em(h,a,e+c,b)&&(f=!0)}{let b=i?1:0;!p&&Em(u,s,t,b)&&(o.start=e+d,p=!0),!f&&Em(h,a,t,b)&&(o.end=e+d,f=!0)}let g=d-l;p||(o.start=Math.max(0,u+g)),f||(o.end=Math.max(0,h+g)),o.start>o.end&&(o.end=o.start)}function jK(o,e,t){let n=o.root,i=0,r=0,s=0,a=0,l=[],d=0;for(;n!==Qe;){if(vi(n)){Ot(n.left,!1),Ot(n.right,!1),n===n.parent.right&&(i-=n.parent.delta),n=n.parent;continue}if(!vi(n.left)){if(r=i+n.maxEnd,r<e){Ot(n,!0);continue}if(n.left!==Qe){n=n.left;continue}}if(s=i+n.start,s>t){Ot(n,!0);continue}if(a=i+n.end,a>=e&&(n.setCachedOffsets(s,a,0),l[d++]=n),Ot(n,!0),n.right!==Qe&&!vi(n.right)){i+=n.delta,n=n.right;continue}}return Ot(o.root,!1),l}function qK(o,e,t,n){let i=o.root,r=0,s=0,a=0,l=n-(t-e);for(;i!==Qe;){if(vi(i)){Ot(i.left,!1),Ot(i.right,!1),i===i.parent.right&&(r-=i.parent.delta),Vl(i),i=i.parent;continue}if(!vi(i.left)){if(s=r+i.maxEnd,s<e){Ot(i,!0);continue}if(i.left!==Qe){i=i.left;continue}}if(a=r+i.start,a>t){i.start+=l,i.end+=l,i.delta+=l,(i.delta<-1073741824||i.delta>1073741824)&&(o.requestNormalizeDelta=!0),Ot(i,!0);continue}if(Ot(i,!0),i.right!==Qe&&!vi(i.right)){r+=i.delta,i=i.right;continue}}Ot(o.root,!1)}function $K(o,e){let t=o.root,n=[],i=0;for(;t!==Qe;){if(vi(t)){Ot(t.left,!1),Ot(t.right,!1),t=t.parent;continue}if(t.left!==Qe&&!vi(t.left)){t=t.left;continue}if(t.ownerId===e&&(n[i++]=t),Ot(t,!0),t.right!==Qe&&!vi(t.right)){t=t.right;continue}}return Ot(o.root,!1),n}function YK(o){let e=o.root,t=[],n=0;for(;e!==Qe;){if(vi(e)){Ot(e.left,!1),Ot(e.right,!1),e=e.parent;continue}if(e.left!==Qe&&!vi(e.left)){e=e.left;continue}if(e.right!==Qe&&!vi(e.right)){e=e.right;continue}t[n++]=e,Ot(e,!0)}return Ot(o.root,!1),t}function IU(o,e,t,n,i){let r=o.root,s=0,a=0,l=0,d=[],c=0;for(;r!==Qe;){if(vi(r)){Ot(r.left,!1),Ot(r.right,!1),r===r.parent.right&&(s-=r.parent.delta),r=r.parent;continue}if(r.left!==Qe&&!vi(r.left)){r=r.left;continue}a=s+r.start,l=s+r.end,r.setCachedOffsets(a,l,n);let u=!0;if(e&&r.ownerId&&r.ownerId!==e&&(u=!1),t&&EU(r)&&(u=!1),i&&!TU(r)&&(u=!1),u&&(d[c++]=r),Ot(r,!0),r.right!==Qe&&!vi(r.right)){s+=r.delta,r=r.right;continue}}return Ot(o.root,!1),d}function ZK(o,e,t,n,i,r,s){let a=o.root,l=0,d=0,c=0,u=0,p=[],h=0;for(;a!==Qe;){if(vi(a)){Ot(a.left,!1),Ot(a.right,!1),a===a.parent.right&&(l-=a.parent.delta),a=a.parent;continue}if(!vi(a.left)){if(d=l+a.maxEnd,d<e){Ot(a,!0);continue}if(a.left!==Qe){a=a.left;continue}}if(c=l+a.start,c>t){Ot(a,!0);continue}if(u=l+a.end,u>=e){a.setCachedOffsets(c,u,r);let f=!0;n&&a.ownerId&&a.ownerId!==n&&(f=!1),i&&EU(a)&&(f=!1),s&&!TU(a)&&(f=!1),f&&(p[h++]=a)}if(Ot(a,!0),a.right!==Qe&&!vi(a.right)){l+=a.delta,a=a.right;continue}}return Ot(o.root,!1),p}function CU(o,e){if(o.root===Qe)return e.parent=Qe,e.left=Qe,e.right=Qe,Wt(e,0),o.root=e,o.root;XK(o,e),uc(e.parent);let t=e;for(;t!==o.root&&wo(t.parent)===1;)if(t.parent===t.parent.parent.left){let n=t.parent.parent.right;wo(n)===1?(Wt(t.parent,0),Wt(n,0),Wt(t.parent.parent,1),t=t.parent.parent):(t===t.parent.right&&(t=t.parent,dv(o,t)),Wt(t.parent,0),Wt(t.parent.parent,1),cv(o,t.parent.parent))}else{let n=t.parent.parent.left;wo(n)===1?(Wt(t.parent,0),Wt(n,0),Wt(t.parent.parent,1),t=t.parent.parent):(t===t.parent.left&&(t=t.parent,cv(o,t)),Wt(t.parent,0),Wt(t.parent.parent,1),dv(o,t.parent.parent))}return Wt(o.root,0),e}function XK(o,e){let t=0,n=o.root,i=e.start,r=e.end;for(;;)if(JK(i,r,n.start+t,n.end+t)<0)if(n.left===Qe){e.start-=t,e.end-=t,e.maxEnd-=t,n.left=e;break}else n=n.left;else if(n.right===Qe){e.start-=t+n.delta,e.end-=t+n.delta,e.maxEnd-=t+n.delta,n.right=e;break}else t+=n.delta,n=n.right;e.parent=n,e.left=Qe,e.right=Qe,Wt(e,1)}function SU(o,e){let t,n;if(e.left===Qe?(t=e.right,n=e,t.delta+=e.delta,(t.delta<-1073741824||t.delta>1073741824)&&(o.requestNormalizeDelta=!0),t.start+=e.delta,t.end+=e.delta):e.right===Qe?(t=e.left,n=e):(n=QK(e.right),t=n.right,t.start+=n.delta,t.end+=n.delta,t.delta+=n.delta,(t.delta<-1073741824||t.delta>1073741824)&&(o.requestNormalizeDelta=!0),n.start+=e.delta,n.end+=e.delta,n.delta=e.delta,(n.delta<-1073741824||n.delta>1073741824)&&(o.requestNormalizeDelta=!0)),n===o.root){o.root=t,Wt(t,0),e.detach(),FM(),Vl(t),o.root.parent=Qe;return}let i=wo(n)===1;if(n===n.parent.left?n.parent.left=t:n.parent.right=t,n===e?t.parent=n.parent:(n.parent===e?t.parent=n:t.parent=n.parent,n.left=e.left,n.right=e.right,n.parent=e.parent,Wt(n,wo(e)),e===o.root?o.root=n:e===e.parent.left?e.parent.left=n:e.parent.right=n,n.left!==Qe&&(n.left.parent=n),n.right!==Qe&&(n.right.parent=n)),e.detach(),i){uc(t.parent),n!==e&&(uc(n),uc(n.parent)),FM();return}uc(t),uc(t.parent),n!==e&&(uc(n),uc(n.parent));let r;for(;t!==o.root&&wo(t)===0;)t===t.parent.left?(r=t.parent.right,wo(r)===1&&(Wt(r,0),Wt(t.parent,1),dv(o,t.parent),r=t.parent.right),wo(r.left)===0&&wo(r.right)===0?(Wt(r,1),t=t.parent):(wo(r.right)===0&&(Wt(r.left,0),Wt(r,1),cv(o,r),r=t.parent.right),Wt(r,wo(t.parent)),Wt(t.parent,0),Wt(r.right,0),dv(o,t.parent),t=o.root)):(r=t.parent.left,wo(r)===1&&(Wt(r,0),Wt(t.parent,1),cv(o,t.parent),r=t.parent.left),wo(r.left)===0&&wo(r.right)===0?(Wt(r,1),t=t.parent):(wo(r.left)===0&&(Wt(r.right,0),Wt(r,1),dv(o,r),r=t.parent.left),Wt(r,wo(t.parent)),Wt(t.parent,0),Wt(r.left,0),cv(o,t.parent),t=o.root));Wt(t,0),FM()}function QK(o){for(;o.left!==Qe;)o=o.left;return o}function FM(){Qe.parent=Qe,Qe.delta=0,Qe.start=0,Qe.end=0}function dv(o,e){let t=e.right;t.delta+=e.delta,(t.delta<-1073741824||t.delta>1073741824)&&(o.requestNormalizeDelta=!0),t.start+=e.delta,t.end+=e.delta,e.right=t.left,t.left!==Qe&&(t.left.parent=e),t.parent=e.parent,e.parent===Qe?o.root=t:e===e.parent.left?e.parent.left=t:e.parent.right=t,t.left=e,e.parent=t,Vl(e),Vl(t)}function cv(o,e){let t=e.left;e.delta-=t.delta,(e.delta<-1073741824||e.delta>1073741824)&&(o.requestNormalizeDelta=!0),e.start-=t.delta,e.end-=t.delta,e.left=t.right,t.right!==Qe&&(t.right.parent=e),t.parent=e.parent,e.parent===Qe?o.root=t:e===e.parent.right?e.parent.right=t:e.parent.left=t,t.right=e,e.parent=t,Vl(e),Vl(t)}function xU(o){let e=o.end;if(o.left!==Qe){let t=o.left.maxEnd;t>e&&(e=t)}if(o.right!==Qe){let t=o.right.maxEnd+o.delta;t>e&&(e=t)}return e}function Vl(o){o.maxEnd=xU(o)}function uc(o){for(;o!==Qe;){let e=xU(o);if(o.maxEnd===e)return;o.maxEnd=e,o=o.parent}}function JK(o,e,t,n){return o===t?e-n:o-t}var xm=class{parent;left;right;color;piece;size_left;lf_left;constructor(e,t){this.piece=e,this.color=t,this.size_left=0,this.lf_left=0,this.parent=this,this.left=this,this.right=this}next(){if(this.right!==Be)return KT(this.right);let e=this;for(;e.parent!==Be&&e.parent.left!==e;)e=e.parent;return e.parent===Be?Be:e.parent}prev(){if(this.left!==Be)return VM(this.left);let e=this;for(;e.parent!==Be&&e.parent.right!==e;)e=e.parent;return e.parent===Be?Be:e.parent}detach(){this.parent=null,this.left=null,this.right=null}};var Be=new xm(null,0);Be.parent=Be;Be.left=Be;Be.right=Be;Be.color=0;function KT(o){for(;o.left!==Be;)o=o.left;return o}function VM(o){for(;o.right!==Be;)o=o.right;return o}function WM(o){return o===Be?0:o.size_left+o.piece.length+WM(o.right)}function HM(o){return o===Be?0:o.lf_left+o.piece.lineFeedCnt+HM(o.right)}function BM(){Be.parent=Be}function hv(o,e){let t=e.right;t.size_left+=e.size_left+(e.piece?e.piece.length:0),t.lf_left+=e.lf_left+(e.piece?e.piece.lineFeedCnt:0),e.right=t.left,t.left!==Be&&(t.left.parent=e),t.parent=e.parent,e.parent===Be?o.root=t:e.parent.left===e?e.parent.left=t:e.parent.right=t,t.left=e,e.parent=t}function mv(o,e){let t=e.left;e.left=t.right,t.right!==Be&&(t.right.parent=e),t.parent=e.parent,e.size_left-=t.size_left+(t.piece?t.piece.length:0),e.lf_left-=t.lf_left+(t.piece?t.piece.lineFeedCnt:0),e.parent===Be?o.root=t:e===e.parent.right?e.parent.right=t:e.parent.left=t,t.right=e,e.parent=t}function gv(o,e){let t,n;if(e.left===Be?(n=e,t=n.right):e.right===Be?(n=e,t=n.left):(n=KT(e.right),t=n.right),n===o.root){o.root=t,t.color=0,e.detach(),BM(),o.root.parent=Be;return}let i=n.color===1;if(n===n.parent.left?n.parent.left=t:n.parent.right=t,n===e?(t.parent=n.parent,pv(o,t)):(n.parent===e?t.parent=n:t.parent=n.parent,pv(o,t),n.left=e.left,n.right=e.right,n.parent=e.parent,n.color=e.color,e===o.root?o.root=n:e===e.parent.left?e.parent.left=n:e.parent.right=n,n.left!==Be&&(n.left.parent=n),n.right!==Be&&(n.right.parent=n),n.size_left=e.size_left,n.lf_left=e.lf_left,pv(o,n)),e.detach(),t.parent.left===t){let s=WM(t),a=HM(t);if(s!==t.parent.size_left||a!==t.parent.lf_left){let l=s-t.parent.size_left,d=a-t.parent.lf_left;t.parent.size_left=s,t.parent.lf_left=a,Wa(o,t.parent,l,d)}}if(pv(o,t.parent),i){BM();return}let r;for(;t!==o.root&&t.color===0;)t===t.parent.left?(r=t.parent.right,r.color===1&&(r.color=0,t.parent.color=1,hv(o,t.parent),r=t.parent.right),r.left.color===0&&r.right.color===0?(r.color=1,t=t.parent):(r.right.color===0&&(r.left.color=0,r.color=1,mv(o,r),r=t.parent.right),r.color=t.parent.color,t.parent.color=0,r.right.color=0,hv(o,t.parent),t=o.root)):(r=t.parent.left,r.color===1&&(r.color=0,t.parent.color=1,mv(o,t.parent),r=t.parent.left),r.left.color===0&&r.right.color===0?(r.color=1,t=t.parent):(r.left.color===0&&(r.right.color=0,r.color=1,hv(o,r),r=t.parent.left),r.color=t.parent.color,t.parent.color=0,r.left.color=0,mv(o,t.parent),t=o.root));t.color=0,BM()}function UM(o,e){for(pv(o,e);e!==o.root&&e.parent.color===1;)if(e.parent===e.parent.parent.left){let t=e.parent.parent.right;t.color===1?(e.parent.color=0,t.color=0,e.parent.parent.color=1,e=e.parent.parent):(e===e.parent.right&&(e=e.parent,hv(o,e)),e.parent.color=0,e.parent.parent.color=1,mv(o,e.parent.parent))}else{let t=e.parent.parent.left;t.color===1?(e.parent.color=0,t.color=0,e.parent.parent.color=1,e=e.parent.parent):(e===e.parent.left&&(e=e.parent,mv(o,e)),e.parent.color=0,e.parent.parent.color=1,hv(o,e.parent.parent))}o.root.color=0}function Wa(o,e,t,n){for(;e!==o.root&&e!==Be;)e.parent.left===e&&(e.parent.size_left+=t,e.parent.lf_left+=n),e=e.parent}function pv(o,e){let t=0,n=0;if(e!==o.root){for(;e!==o.root&&e===e.parent.right;)e=e.parent;if(e!==o.root)for(e=e.parent,t=WM(e.left)-e.size_left,n=HM(e.left)-e.lf_left,e.size_left+=t,e.lf_left+=n;e!==o.root&&(t!==0||n!==0);)e.parent.left===e&&(e.parent.size_left+=t,e.parent.lf_left+=n),e=e.parent}}var eG=999,Hl=class{searchString;isRegex;matchCase;wordSeparators;constructor(e,t,n,i){this.searchString=e,this.isRegex=t,this.matchCase=n,this.wordSeparators=i}parseSearchRequest(){if(this.searchString==="")return null;let e;this.isRegex?e=tG(this.searchString):e=this.searchString.indexOf(`
`)>=0;let t=null;try{t=sI(this.searchString,this.isRegex,{matchCase:this.matchCase,wholeWord:!1,multiline:e,global:!0,unicode:!0})}catch{return null}if(!t)return null;let n=!this.isRegex&&!e;return n&&this.searchString.toLowerCase()!==this.searchString.toUpperCase()&&(n=this.matchCase),new NC(t,this.wordSeparators?ya(this.wordSeparators,[]):null,n?this.searchString:null)}};function tG(o){if(!o||o.length===0)return!1;for(let e=0,t=o.length;e<t;e++){let n=o.charCodeAt(e);if(n===10)return!0;if(n===92){if(e++,e>=t)break;let i=o.charCodeAt(e);if(i===110||i===114||i===87)return!0}}return!1}function pc(o,e,t){if(!t)return new Wd(o,null);let n=[];for(let i=0,r=e.length;i<r;i++)n[i]=e[i];return new Wd(o,n)}var GT=class{_lineFeedsOffsets;constructor(e){let t=[],n=0;for(let i=0,r=e.length;i<r;i++)e.charCodeAt(i)===10&&(t[n++]=i);this._lineFeedsOffsets=t}findLineFeedCountBeforeOffset(e){let t=this._lineFeedsOffsets,n=0,i=t.length-1;if(i===-1||e<=t[0])return 0;for(;n<i;){let r=n+((i-n)/2>>0);t[r]>=e?i=r-1:t[r+1]>=e?(n=r,i=r):n=r+1}return n+1}},Gu=class{static findMatches(e,t,n,i,r){let s=t.parseSearchRequest();return s?s.regex.multiline?this._doFindMatchesMultiline(e,n,new Wl(s.wordSeparators,s.regex),i,r):this._doFindMatchesLineByLine(e,n,s,i,r):[]}static _getMultilineMatchRange(e,t,n,i,r,s){let a,l=0;i?(l=i.findLineFeedCountBeforeOffset(r),a=t+r+l):a=t+r;let d;if(i){let h=i.findLineFeedCountBeforeOffset(r+s.length)-l;d=a+s.length+h}else d=a+s.length;let c=e.getPositionAt(a),u=e.getPositionAt(d);return new P(c.lineNumber,c.column,u.lineNumber,u.column)}static _doFindMatchesMultiline(e,t,n,i,r){let s=e.getOffsetAt(t.getStartPosition()),a=e.getValueInRange(t,1),l=e.getEOL()===`\r
`?new GT(a):null,d=[],c=0,u;for(n.reset(0);u=n.next(a);)if(d[c++]=pc(this._getMultilineMatchRange(e,s,a,l,u.index,u[0]),u,i),c>=r)return d;return d}static _doFindMatchesLineByLine(e,t,n,i,r){let s=[],a=0;if(t.startLineNumber===t.endLineNumber){let d=e.getLineContent(t.startLineNumber).substring(t.startColumn-1,t.endColumn-1);return a=this._findMatchesInLine(n,d,t.startLineNumber,t.startColumn-1,a,s,i,r),s}let l=e.getLineContent(t.startLineNumber).substring(t.startColumn-1);a=this._findMatchesInLine(n,l,t.startLineNumber,t.startColumn-1,a,s,i,r);for(let d=t.startLineNumber+1;d<t.endLineNumber&&a<r;d++)a=this._findMatchesInLine(n,e.getLineContent(d),d,0,a,s,i,r);if(a<r){let d=e.getLineContent(t.endLineNumber).substring(0,t.endColumn-1);a=this._findMatchesInLine(n,d,t.endLineNumber,0,a,s,i,r)}return s}static _findMatchesInLine(e,t,n,i,r,s,a,l){let d=e.wordSeparators;if(!a&&e.simpleSearch){let p=e.simpleSearch,h=p.length,f=t.length,g=-h;for(;(g=t.indexOf(p,g+h))!==-1;)if((!d||jT(d,t,f,g,h))&&(s[r++]=new Wd(new P(n,g+1+i,n,g+1+h+i),null),r>=l))return r;return r}let c=new Wl(e.wordSeparators,e.regex),u;c.reset(0);do if(u=c.next(t),u&&(s[r++]=pc(new P(n,u.index+1+i,n,u.index+1+u[0].length+i),u,a),r>=l))return r;while(u);return r}static findNextMatch(e,t,n,i){let r=t.parseSearchRequest();if(!r)return null;let s=new Wl(r.wordSeparators,r.regex);return r.regex.multiline?this._doFindNextMatchMultiline(e,n,s,i):this._doFindNextMatchLineByLine(e,n,s,i)}static _doFindNextMatchMultiline(e,t,n,i){let r=new A(t.lineNumber,1),s=e.getOffsetAt(r),a=e.getLineCount(),l=e.getValueInRange(new P(r.lineNumber,r.column,a,e.getLineMaxColumn(a)),1),d=e.getEOL()===`\r
`?new GT(l):null;n.reset(t.column-1);let c=n.next(l);return c?pc(this._getMultilineMatchRange(e,s,l,d,c.index,c[0]),c,i):t.lineNumber!==1||t.column!==1?this._doFindNextMatchMultiline(e,new A(1,1),n,i):null}static _doFindNextMatchLineByLine(e,t,n,i){let r=e.getLineCount(),s=t.lineNumber,a=e.getLineContent(s),l=this._findFirstMatchInLine(n,a,s,t.column,i);if(l)return l;for(let d=1;d<=r;d++){let c=(s+d-1)%r,u=e.getLineContent(c+1),p=this._findFirstMatchInLine(n,u,c+1,1,i);if(p)return p}return null}static _findFirstMatchInLine(e,t,n,i,r){e.reset(i-1);let s=e.next(t);return s?pc(new P(n,s.index+1,n,s.index+1+s[0].length),s,r):null}static findPreviousMatch(e,t,n,i){let r=t.parseSearchRequest();if(!r)return null;let s=new Wl(r.wordSeparators,r.regex);return r.regex.multiline?this._doFindPreviousMatchMultiline(e,n,s,i):this._doFindPreviousMatchLineByLine(e,n,s,i)}static _doFindPreviousMatchMultiline(e,t,n,i){let r=this._doFindMatchesMultiline(e,new P(1,1,t.lineNumber,t.column),n,i,10*eG);if(r.length>0)return r[r.length-1];let s=e.getLineCount();return t.lineNumber!==s||t.column!==e.getLineMaxColumn(s)?this._doFindPreviousMatchMultiline(e,new A(s,e.getLineMaxColumn(s)),n,i):null}static _doFindPreviousMatchLineByLine(e,t,n,i){let r=e.getLineCount(),s=t.lineNumber,a=e.getLineContent(s).substring(0,t.column-1),l=this._findLastMatchInLine(n,a,s,i);if(l)return l;for(let d=1;d<=r;d++){let c=(r+s-d-1)%r,u=e.getLineContent(c+1),p=this._findLastMatchInLine(n,u,c+1,i);if(p)return p}return null}static _findLastMatchInLine(e,t,n,i){let r=null,s;for(e.reset(0);s=e.next(t);)r=pc(new P(n,s.index+1,n,s.index+1+s[0].length),s,i);return r}};function nG(o,e,t,n,i){if(n===0)return!0;let r=e.charCodeAt(n-1);if(o.get(r)!==0||r===13||r===10)return!0;if(i>0){let s=e.charCodeAt(n);if(o.get(s)!==0)return!0}return!1}function iG(o,e,t,n,i){if(n+i===t)return!0;let r=e.charCodeAt(n+i);if(o.get(r)!==0||r===13||r===10)return!0;if(i>0){let s=e.charCodeAt(n+i-1);if(o.get(s)!==0)return!0}return!1}function jT(o,e,t,n,i){return nG(o,e,t,n,i)&&iG(o,e,t,n,i)}var Wl=class{_wordSeparators;_searchRegex;_prevMatchStartIndex;_prevMatchLength;constructor(e,t){this._wordSeparators=e,this._searchRegex=t,this._prevMatchStartIndex=-1,this._prevMatchLength=0}reset(e){this._searchRegex.lastIndex=e,this._prevMatchStartIndex=-1,this._prevMatchLength=0}next(e){let t=e.length,n;do{if(this._prevMatchStartIndex+this._prevMatchLength===t||(n=this._searchRegex.exec(e),!n))return null;let i=n.index,r=n[0].length;if(i===this._prevMatchStartIndex&&r===this._prevMatchLength){if(r===0){qp(e,t,this._searchRegex.lastIndex)>65535?this._searchRegex.lastIndex+=2:this._searchRegex.lastIndex+=1;continue}return null}if(this._prevMatchStartIndex=i,this._prevMatchLength=r,!this._wordSeparators||jT(this._wordSeparators,e,t,i,r))return n}while(n);return null}};var Ul=65535;function wU(o){let e;return o[o.length-1]<65536?e=new Uint16Array(o.length):e=new Uint32Array(o.length),e.set(o,0),e}var KM=class{constructor(e,t,n,i,r){this.lineStarts=e;this.cr=t;this.lf=n;this.crlf=i;this.isBasicASCII=r}};function Ha(o,e=!0){let t=[0],n=1;for(let i=0,r=o.length;i<r;i++){let s=o.charCodeAt(i);s===13?i+1<r&&o.charCodeAt(i+1)===10?(t[n++]=i+2,i++):t[n++]=i+1:s===10&&(t[n++]=i+1)}return e?wU(t):t}function _U(o,e){o.length=0,o[0]=0;let t=1,n=0,i=0,r=0,s=!0;for(let l=0,d=e.length;l<d;l++){let c=e.charCodeAt(l);c===13?l+1<d&&e.charCodeAt(l+1)===10?(r++,o[t++]=l+2,l++):(n++,o[t++]=l+1):c===10?(i++,o[t++]=l+1):s&&c!==9&&(c<32||c>126)&&(s=!1)}let a=new KM(wU(o),n,i,r,s);return o.length=0,a}var uo=class{bufferIndex;start;end;length;lineFeedCnt;constructor(e,t,n,i,r){this.bufferIndex=e,this.start=t,this.end=n,this.lineFeedCnt=i,this.length=r}},Ua=class{buffer;lineStarts;constructor(e,t){this.buffer=e,this.lineStarts=t}},GM=class{_pieces;_index;_tree;_BOM;constructor(e,t){this._pieces=[],this._tree=e,this._BOM=t,this._index=0,e.root!==Be&&e.iterate(e.root,n=>(n!==Be&&this._pieces.push(n.piece),!0))}read(){return this._pieces.length===0?this._index===0?(this._index++,this._BOM):null:this._index>this._pieces.length-1?null:this._index===0?this._BOM+this._tree.getPieceContent(this._pieces[this._index++]):this._tree.getPieceContent(this._pieces[this._index++])}},jM=class{_limit;_cache;constructor(e){this._limit=e,this._cache=[]}get(e){for(let t=this._cache.length-1;t>=0;t--){let n=this._cache[t];if(n.nodeStartOffset<=e&&n.nodeStartOffset+n.node.piece.length>=e)return n}return null}get2(e){for(let t=this._cache.length-1;t>=0;t--){let n=this._cache[t];if(n.nodeStartLineNumber&&n.nodeStartLineNumber<e&&n.nodeStartLineNumber+n.node.piece.lineFeedCnt>=e)return n}return null}set(e){this._cache.length>=this._limit&&this._cache.shift(),this._cache.push(e)}validate(e){let t=!1,n=this._cache;for(let i=0;i<n.length;i++){let r=n[i];if(r.node.parent===null||r.nodeStartOffset>=e){n[i]=null,t=!0;continue}}if(t){let i=[];for(let r of n)r!==null&&i.push(r);this._cache=i}}},qT=class{root;_buffers;_lineCnt;_length;_EOL;_EOLLength;_EOLNormalized;_lastChangeBufferPos;_searchCache;_lastVisitedLine;constructor(e,t,n){this.create(e,t,n)}create(e,t,n){this._buffers=[new Ua("",[0])],this._lastChangeBufferPos={line:0,column:0},this.root=Be,this._lineCnt=1,this._length=0,this._EOL=t,this._EOLLength=t.length,this._EOLNormalized=n;let i=null;for(let r=0,s=e.length;r<s;r++)if(e[r].buffer.length>0){e[r].lineStarts||(e[r].lineStarts=Ha(e[r].buffer));let a=new uo(r+1,{line:0,column:0},{line:e[r].lineStarts.length-1,column:e[r].buffer.length-e[r].lineStarts[e[r].lineStarts.length-1]},e[r].lineStarts.length-1,e[r].buffer.length);this._buffers.push(e[r]),i=this.rbInsertRight(i,a)}this._searchCache=new jM(1),this._lastVisitedLine={lineNumber:0,value:""},this.computeBufferMetadata()}normalizeEOL(e){let t=Ul,n=t-Math.floor(t/3),i=n*2,r="",s=0,a=[];if(this.iterate(this.root,l=>{let d=this.getNodeContent(l),c=d.length;if(s<=n||s+c<i)return r+=d,s+=c,!0;let u=r.replace(/\r\n|\r|\n/g,e);return a.push(new Ua(u,Ha(u))),r=d,s=c,!0}),s>0){let l=r.replace(/\r\n|\r|\n/g,e);a.push(new Ua(l,Ha(l)))}this.create(a,e,!0)}getEOL(){return this._EOL}setEOL(e){this._EOL=e,this._EOLLength=this._EOL.length,this.normalizeEOL(e)}createSnapshot(e){return new GM(this,e)}equal(e){if(this.getLength()!==e.getLength()||this.getLineCount()!==e.getLineCount())return!1;let t=0;return this.iterate(this.root,i=>{if(i===Be)return!0;let r=this.getNodeContent(i),s=r.length,a=e.nodeAt(t),l=e.nodeAt(t+s),d=e.getValueInRange2(a,l);return t+=s,r===d})}getOffsetAt(e,t){let n=0,i=this.root;for(;i!==Be;)if(i.left!==Be&&i.lf_left+1>=e)i=i.left;else if(i.lf_left+i.piece.lineFeedCnt+1>=e){n+=i.size_left;let r=this.getAccumulatedValue(i,e-i.lf_left-2);return n+=r+t-1}else e-=i.lf_left+i.piece.lineFeedCnt,n+=i.size_left+i.piece.length,i=i.right;return n}getPositionAt(e){e=Math.floor(e),e=Math.max(0,e);let t=this.root,n=0,i=e;for(;t!==Be;)if(t.size_left!==0&&t.size_left>=e)t=t.left;else if(t.size_left+t.piece.length>=e){let r=this.getIndexOf(t,e-t.size_left);if(n+=t.lf_left+r.index,r.index===0){let s=this.getOffsetAt(n+1,1),a=i-s;return new A(n+1,a+1)}return new A(n+1,r.remainder+1)}else if(e-=t.size_left+t.piece.length,n+=t.lf_left+t.piece.lineFeedCnt,t.right===Be){let r=this.getOffsetAt(n+1,1),s=i-e-r;return new A(n+1,s+1)}else t=t.right;return new A(1,1)}getValueInRange(e,t){if(e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn)return"";let n=this.nodeAt2(e.startLineNumber,e.startColumn),i=this.nodeAt2(e.endLineNumber,e.endColumn),r=this.getValueInRange2(n,i);return t?t!==this._EOL||!this._EOLNormalized?r.replace(/\r\n|\r|\n/g,t):t===this.getEOL()&&this._EOLNormalized?r:r.replace(/\r\n|\r|\n/g,t):r}getValueInRange2(e,t){if(e.node===t.node){let a=e.node,l=this._buffers[a.piece.bufferIndex].buffer,d=this.offsetInBuffer(a.piece.bufferIndex,a.piece.start);return l.substring(d+e.remainder,d+t.remainder)}let n=e.node,i=this._buffers[n.piece.bufferIndex].buffer,r=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start),s=i.substring(r+e.remainder,r+n.piece.length);for(n=n.next();n!==Be;){let a=this._buffers[n.piece.bufferIndex].buffer,l=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);if(n===t.node){s+=a.substring(l,l+t.remainder);break}else s+=a.substr(l,n.piece.length);n=n.next()}return s}getLinesContent(){let e=[],t=0,n="",i=!1;return this.iterate(this.root,r=>{if(r===Be)return!0;let s=r.piece,a=s.length;if(a===0)return!0;let l=this._buffers[s.bufferIndex].buffer,d=this._buffers[s.bufferIndex].lineStarts,c=s.start.line,u=s.end.line,p=d[c]+s.start.column;if(i&&(l.charCodeAt(p)===10&&(p++,a--),e[t++]=n,n="",i=!1,a===0))return!0;if(c===u)return!this._EOLNormalized&&l.charCodeAt(p+a-1)===13?(i=!0,n+=l.substr(p,a-1)):n+=l.substr(p,a),!0;n+=this._EOLNormalized?l.substring(p,Math.max(p,d[c+1]-this._EOLLength)):l.substring(p,d[c+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=n;for(let h=c+1;h<u;h++)n=this._EOLNormalized?l.substring(d[h],d[h+1]-this._EOLLength):l.substring(d[h],d[h+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=n;return!this._EOLNormalized&&l.charCodeAt(d[u]+s.end.column-1)===13?(i=!0,s.end.column===0?t--:n=l.substr(d[u],s.end.column-1)):n=l.substr(d[u],s.end.column),!0}),i&&(e[t++]=n,n=""),e[t++]=n,e}getLength(){return this._length}getLineCount(){return this._lineCnt}getLineContent(e){return this._lastVisitedLine.lineNumber===e?this._lastVisitedLine.value:(this._lastVisitedLine.lineNumber=e,e===this._lineCnt?this._lastVisitedLine.value=this.getLineRawContent(e):this._EOLNormalized?this._lastVisitedLine.value=this.getLineRawContent(e,this._EOLLength):this._lastVisitedLine.value=this.getLineRawContent(e).replace(/(\r\n|\r|\n)$/,""),this._lastVisitedLine.value)}_getCharCode(e){if(e.remainder===e.node.piece.length){let t=e.node.next();if(!t)return 0;let n=this._buffers[t.piece.bufferIndex],i=this.offsetInBuffer(t.piece.bufferIndex,t.piece.start);return n.buffer.charCodeAt(i)}else{let t=this._buffers[e.node.piece.bufferIndex],i=this.offsetInBuffer(e.node.piece.bufferIndex,e.node.piece.start)+e.remainder;return t.buffer.charCodeAt(i)}}getLineCharCode(e,t){let n=this.nodeAt2(e,t+1);return this._getCharCode(n)}getLineLength(e){if(e===this.getLineCount()){let t=this.getOffsetAt(e,1);return this.getLength()-t}return this.getOffsetAt(e+1,1)-this.getOffsetAt(e,1)-this._EOLLength}getCharCode(e){let t=this.nodeAt(e);return this._getCharCode(t)}getNearestChunk(e){let t=this.nodeAt(e);if(t.remainder===t.node.piece.length){let n=t.node.next();if(!n||n===Be)return"";let i=this._buffers[n.piece.bufferIndex],r=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);return i.buffer.substring(r,r+n.piece.length)}else{let n=this._buffers[t.node.piece.bufferIndex],i=this.offsetInBuffer(t.node.piece.bufferIndex,t.node.piece.start),r=i+t.remainder,s=i+t.node.piece.length;return n.buffer.substring(r,s)}}findMatchesInNode(e,t,n,i,r,s,a,l,d,c,u){let p=this._buffers[e.piece.bufferIndex],h=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start),f=this.offsetInBuffer(e.piece.bufferIndex,r),g=this.offsetInBuffer(e.piece.bufferIndex,s),b,v={line:0,column:0},y,S;t._wordSeparators?(y=p.buffer.substring(f,g),S=E=>E+f,t.reset(0)):(y=p.buffer,S=E=>E,t.reset(f));do if(b=t.next(y),b){if(S(b.index)>=g)return c;this.positionInBuffer(e,S(b.index)-h,v);let E=this.getLineFeedCnt(e.piece.bufferIndex,r,v),C=v.line===r.line?v.column-r.column+i:v.column+1,w=C+b[0].length;if(u[c++]=pc(new P(n+E,C,n+E,w),b,l),S(b.index)+b[0].length>=g||c>=d)return c}while(b);return c}findMatchesLineByLine(e,t,n,i){let r=[],s=0,a=new Wl(t.wordSeparators,t.regex),l=this.nodeAt2(e.startLineNumber,e.startColumn);if(l===null)return[];let d=this.nodeAt2(e.endLineNumber,e.endColumn);if(d===null)return[];let c=this.positionInBuffer(l.node,l.remainder),u=this.positionInBuffer(d.node,d.remainder);if(l.node===d.node)return this.findMatchesInNode(l.node,a,e.startLineNumber,e.startColumn,c,u,t,n,i,s,r),r;let p=e.startLineNumber,h=l.node;for(;h!==d.node;){let g=this.getLineFeedCnt(h.piece.bufferIndex,c,h.piece.end);if(g>=1){let v=this._buffers[h.piece.bufferIndex].lineStarts,y=this.offsetInBuffer(h.piece.bufferIndex,h.piece.start),S=v[c.line+g],E=p===e.startLineNumber?e.startColumn:1;if(s=this.findMatchesInNode(h,a,p,E,c,this.positionInBuffer(h,S-y),t,n,i,s,r),s>=i)return r;p+=g}let b=p===e.startLineNumber?e.startColumn-1:0;if(p===e.endLineNumber){let v=this.getLineContent(p).substring(b,e.endColumn-1);return s=this._findMatchesInLine(t,a,v,e.endLineNumber,b,s,r,n,i),r}if(s=this._findMatchesInLine(t,a,this.getLineContent(p).substr(b),p,b,s,r,n,i),s>=i)return r;p++,l=this.nodeAt2(p,1),h=l.node,c=this.positionInBuffer(l.node,l.remainder)}if(p===e.endLineNumber){let g=p===e.startLineNumber?e.startColumn-1:0,b=this.getLineContent(p).substring(g,e.endColumn-1);return s=this._findMatchesInLine(t,a,b,e.endLineNumber,g,s,r,n,i),r}let f=p===e.startLineNumber?e.startColumn:1;return s=this.findMatchesInNode(d.node,a,p,f,c,u,t,n,i,s,r),r}_findMatchesInLine(e,t,n,i,r,s,a,l,d){let c=e.wordSeparators;if(!l&&e.simpleSearch){let p=e.simpleSearch,h=p.length,f=n.length,g=-h;for(;(g=n.indexOf(p,g+h))!==-1;)if((!c||jT(c,n,f,g,h))&&(a[s++]=new Wd(new P(i,g+1+r,i,g+1+h+r),null),s>=d))return s;return s}let u;t.reset(0);do if(u=t.next(n),u&&(a[s++]=pc(new P(i,u.index+1+r,i,u.index+1+u[0].length+r),u,l),s>=d))return s;while(u);return s}insert(e,t,n=!1){if(this._EOLNormalized=this._EOLNormalized&&n,this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",this.root!==Be){let{node:i,remainder:r,nodeStartOffset:s}=this.nodeAt(e),a=i.piece,l=a.bufferIndex,d=this.positionInBuffer(i,r);if(i.piece.bufferIndex===0&&a.end.line===this._lastChangeBufferPos.line&&a.end.column===this._lastChangeBufferPos.column&&s+a.length===e&&t.length<Ul){this.appendToNode(i,t),this.computeBufferMetadata();return}if(s===e)this.insertContentToNodeLeft(t,i),this._searchCache.validate(e);else if(s+i.piece.length>e){let c=[],u=new uo(a.bufferIndex,d,a.end,this.getLineFeedCnt(a.bufferIndex,d,a.end),this.offsetInBuffer(l,a.end)-this.offsetInBuffer(l,d));if(this.shouldCheckCRLF()&&this.endWithCR(t)&&this.nodeCharCodeAt(i,r)===10){let g={line:u.start.line+1,column:0};u=new uo(u.bufferIndex,g,u.end,this.getLineFeedCnt(u.bufferIndex,g,u.end),u.length-1),t+=`
`}if(this.shouldCheckCRLF()&&this.startWithLF(t))if(this.nodeCharCodeAt(i,r-1)===13){let g=this.positionInBuffer(i,r-1);this.deleteNodeTail(i,g),t="\r"+t,i.piece.length===0&&c.push(i)}else this.deleteNodeTail(i,d);else this.deleteNodeTail(i,d);let p=this.createNewPieces(t);u.length>0&&this.rbInsertRight(i,u);let h=i;for(let f=0;f<p.length;f++)h=this.rbInsertRight(h,p[f]);this.deleteNodes(c)}else this.insertContentToNodeRight(t,i)}else{let i=this.createNewPieces(t),r=this.rbInsertLeft(null,i[0]);for(let s=1;s<i.length;s++)r=this.rbInsertRight(r,i[s])}this.computeBufferMetadata()}delete(e,t){if(this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",t<=0||this.root===Be)return;let n=this.nodeAt(e),i=this.nodeAt(e+t),r=n.node,s=i.node;if(r===s){let p=this.positionInBuffer(r,n.remainder),h=this.positionInBuffer(r,i.remainder);if(n.nodeStartOffset===e){if(t===r.piece.length){let f=r.next();gv(this,r),this.validateCRLFWithPrevNode(f),this.computeBufferMetadata();return}this.deleteNodeHead(r,h),this._searchCache.validate(e),this.validateCRLFWithPrevNode(r),this.computeBufferMetadata();return}if(n.nodeStartOffset+r.piece.length===e+t){this.deleteNodeTail(r,p),this.validateCRLFWithNextNode(r),this.computeBufferMetadata();return}this.shrinkNode(r,p,h),this.computeBufferMetadata();return}let a=[],l=this.positionInBuffer(r,n.remainder);this.deleteNodeTail(r,l),this._searchCache.validate(e),r.piece.length===0&&a.push(r);let d=this.positionInBuffer(s,i.remainder);this.deleteNodeHead(s,d),s.piece.length===0&&a.push(s);let c=r.next();for(let p=c;p!==Be&&p!==s;p=p.next())a.push(p);let u=r.piece.length===0?r.prev():r;this.deleteNodes(a),this.validateCRLFWithNextNode(u),this.computeBufferMetadata()}insertContentToNodeLeft(e,t){let n=[];if(this.shouldCheckCRLF()&&this.endWithCR(e)&&this.startWithLF(t)){let s=t.piece,a={line:s.start.line+1,column:0},l=new uo(s.bufferIndex,a,s.end,this.getLineFeedCnt(s.bufferIndex,a,s.end),s.length-1);t.piece=l,e+=`
`,Wa(this,t,-1,-1),t.piece.length===0&&n.push(t)}let i=this.createNewPieces(e),r=this.rbInsertLeft(t,i[i.length-1]);for(let s=i.length-2;s>=0;s--)r=this.rbInsertLeft(r,i[s]);this.validateCRLFWithPrevNode(r),this.deleteNodes(n)}insertContentToNodeRight(e,t){this.adjustCarriageReturnFromNext(e,t)&&(e+=`
`);let n=this.createNewPieces(e),i=this.rbInsertRight(t,n[0]),r=i;for(let s=1;s<n.length;s++)r=this.rbInsertRight(r,n[s]);this.validateCRLFWithPrevNode(i)}positionInBuffer(e,t,n){let i=e.piece,r=e.piece.bufferIndex,s=this._buffers[r].lineStarts,l=s[i.start.line]+i.start.column+t,d=i.start.line,c=i.end.line,u=0,p=0,h=0;for(;d<=c&&(u=d+(c-d)/2|0,h=s[u],u!==c);)if(p=s[u+1],l<h)c=u-1;else if(l>=p)d=u+1;else break;return n?(n.line=u,n.column=l-h,null):{line:u,column:l-h}}getLineFeedCnt(e,t,n){if(n.column===0)return n.line-t.line;let i=this._buffers[e].lineStarts;if(n.line===i.length-1)return n.line-t.line;let r=i[n.line+1],s=i[n.line]+n.column;if(r>s+1)return n.line-t.line;let a=s-1;return this._buffers[e].buffer.charCodeAt(a)===13?n.line-t.line+1:n.line-t.line}offsetInBuffer(e,t){return this._buffers[e].lineStarts[t.line]+t.column}deleteNodes(e){for(let t=0;t<e.length;t++)gv(this,e[t])}createNewPieces(e){if(e.length>Ul){let c=[];for(;e.length>Ul;){let p=e.charCodeAt(Ul-1),h;p===13||p>=55296&&p<=56319?(h=e.substring(0,Ul-1),e=e.substring(Ul-1)):(h=e.substring(0,Ul),e=e.substring(Ul));let f=Ha(h);c.push(new uo(this._buffers.length,{line:0,column:0},{line:f.length-1,column:h.length-f[f.length-1]},f.length-1,h.length)),this._buffers.push(new Ua(h,f))}let u=Ha(e);return c.push(new uo(this._buffers.length,{line:0,column:0},{line:u.length-1,column:e.length-u[u.length-1]},u.length-1,e.length)),this._buffers.push(new Ua(e,u)),c}let t=this._buffers[0].buffer.length,n=Ha(e,!1),i=this._lastChangeBufferPos;if(this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-1]===t&&t!==0&&this.startWithLF(e)&&this.endWithCR(this._buffers[0].buffer)){this._lastChangeBufferPos={line:this._lastChangeBufferPos.line,column:this._lastChangeBufferPos.column+1},i=this._lastChangeBufferPos;for(let c=0;c<n.length;c++)n[c]+=t+1;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(n.slice(1)),this._buffers[0].buffer+="_"+e,t+=1}else{if(t!==0)for(let c=0;c<n.length;c++)n[c]+=t;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(n.slice(1)),this._buffers[0].buffer+=e}let r=this._buffers[0].buffer.length,s=this._buffers[0].lineStarts.length-1,a=r-this._buffers[0].lineStarts[s],l={line:s,column:a},d=new uo(0,i,l,this.getLineFeedCnt(0,i,l),r-t);return this._lastChangeBufferPos=l,[d]}getLinesRawContent(){return this.getContentOfSubTree(this.root)}getLineRawContent(e,t=0){let n=this.root,i="",r=this._searchCache.get2(e);if(r){n=r.node;let s=this.getAccumulatedValue(n,e-r.nodeStartLineNumber-1),a=this._buffers[n.piece.bufferIndex].buffer,l=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);if(r.nodeStartLineNumber+n.piece.lineFeedCnt===e)i=a.substring(l+s,l+n.piece.length);else{let d=this.getAccumulatedValue(n,e-r.nodeStartLineNumber);return a.substring(l+s,l+d-t)}}else{let s=0,a=e;for(;n!==Be;)if(n.left!==Be&&n.lf_left>=e-1)n=n.left;else if(n.lf_left+n.piece.lineFeedCnt>e-1){let l=this.getAccumulatedValue(n,e-n.lf_left-2),d=this.getAccumulatedValue(n,e-n.lf_left-1),c=this._buffers[n.piece.bufferIndex].buffer,u=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);return s+=n.size_left,this._searchCache.set({node:n,nodeStartOffset:s,nodeStartLineNumber:a-(e-1-n.lf_left)}),c.substring(u+l,u+d-t)}else if(n.lf_left+n.piece.lineFeedCnt===e-1){let l=this.getAccumulatedValue(n,e-n.lf_left-2),d=this._buffers[n.piece.bufferIndex].buffer,c=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);i=d.substring(c+l,c+n.piece.length);break}else e-=n.lf_left+n.piece.lineFeedCnt,s+=n.size_left+n.piece.length,n=n.right}for(n=n.next();n!==Be;){let s=this._buffers[n.piece.bufferIndex].buffer;if(n.piece.lineFeedCnt>0){let a=this.getAccumulatedValue(n,0),l=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);return i+=s.substring(l,l+a-t),i}else{let a=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);i+=s.substr(a,n.piece.length)}n=n.next()}return i}computeBufferMetadata(){let e=this.root,t=1,n=0;for(;e!==Be;)t+=e.lf_left+e.piece.lineFeedCnt,n+=e.size_left+e.piece.length,e=e.right;this._lineCnt=t,this._length=n,this._searchCache.validate(this._length)}getIndexOf(e,t){let n=e.piece,i=this.positionInBuffer(e,t),r=i.line-n.start.line;if(this.offsetInBuffer(n.bufferIndex,n.end)-this.offsetInBuffer(n.bufferIndex,n.start)===t){let s=this.getLineFeedCnt(e.piece.bufferIndex,n.start,i);if(s!==r)return{index:s,remainder:0}}return{index:r,remainder:i.column}}getAccumulatedValue(e,t){if(t<0)return 0;let n=e.piece,i=this._buffers[n.bufferIndex].lineStarts,r=n.start.line+t+1;return r>n.end.line?i[n.end.line]+n.end.column-i[n.start.line]-n.start.column:i[r]-i[n.start.line]-n.start.column}deleteNodeTail(e,t){let n=e.piece,i=n.lineFeedCnt,r=this.offsetInBuffer(n.bufferIndex,n.end),s=t,a=this.offsetInBuffer(n.bufferIndex,s),l=this.getLineFeedCnt(n.bufferIndex,n.start,s),d=l-i,c=a-r,u=n.length+c;e.piece=new uo(n.bufferIndex,n.start,s,l,u),Wa(this,e,c,d)}deleteNodeHead(e,t){let n=e.piece,i=n.lineFeedCnt,r=this.offsetInBuffer(n.bufferIndex,n.start),s=t,a=this.getLineFeedCnt(n.bufferIndex,s,n.end),l=this.offsetInBuffer(n.bufferIndex,s),d=a-i,c=r-l,u=n.length+c;e.piece=new uo(n.bufferIndex,s,n.end,a,u),Wa(this,e,c,d)}shrinkNode(e,t,n){let i=e.piece,r=i.start,s=i.end,a=i.length,l=i.lineFeedCnt,d=t,c=this.getLineFeedCnt(i.bufferIndex,i.start,d),u=this.offsetInBuffer(i.bufferIndex,t)-this.offsetInBuffer(i.bufferIndex,r);e.piece=new uo(i.bufferIndex,i.start,d,c,u),Wa(this,e,u-a,c-l);let p=new uo(i.bufferIndex,n,s,this.getLineFeedCnt(i.bufferIndex,n,s),this.offsetInBuffer(i.bufferIndex,s)-this.offsetInBuffer(i.bufferIndex,n)),h=this.rbInsertRight(e,p);this.validateCRLFWithPrevNode(h)}appendToNode(e,t){this.adjustCarriageReturnFromNext(t,e)&&(t+=`
`);let n=this.shouldCheckCRLF()&&this.startWithLF(t)&&this.endWithCR(e),i=this._buffers[0].buffer.length;this._buffers[0].buffer+=t;let r=Ha(t,!1);for(let h=0;h<r.length;h++)r[h]+=i;if(n){let h=this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-2];this._buffers[0].lineStarts.pop(),this._lastChangeBufferPos={line:this._lastChangeBufferPos.line-1,column:i-h}}this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(r.slice(1));let s=this._buffers[0].lineStarts.length-1,a=this._buffers[0].buffer.length-this._buffers[0].lineStarts[s],l={line:s,column:a},d=e.piece.length+t.length,c=e.piece.lineFeedCnt,u=this.getLineFeedCnt(0,e.piece.start,l),p=u-c;e.piece=new uo(e.piece.bufferIndex,e.piece.start,l,u,d),this._lastChangeBufferPos=l,Wa(this,e,t.length,p)}nodeAt(e){let t=this.root,n=this._searchCache.get(e);if(n)return{node:n.node,nodeStartOffset:n.nodeStartOffset,remainder:e-n.nodeStartOffset};let i=0;for(;t!==Be;)if(t.size_left>e)t=t.left;else if(t.size_left+t.piece.length>=e){i+=t.size_left;let r={node:t,remainder:e-t.size_left,nodeStartOffset:i};return this._searchCache.set(r),r}else e-=t.size_left+t.piece.length,i+=t.size_left+t.piece.length,t=t.right;return null}nodeAt2(e,t){let n=this.root,i=0;for(;n!==Be;)if(n.left!==Be&&n.lf_left>=e-1)n=n.left;else if(n.lf_left+n.piece.lineFeedCnt>e-1){let r=this.getAccumulatedValue(n,e-n.lf_left-2),s=this.getAccumulatedValue(n,e-n.lf_left-1);return i+=n.size_left,{node:n,remainder:Math.min(r+t-1,s),nodeStartOffset:i}}else if(n.lf_left+n.piece.lineFeedCnt===e-1){let r=this.getAccumulatedValue(n,e-n.lf_left-2);if(r+t-1<=n.piece.length)return{node:n,remainder:r+t-1,nodeStartOffset:i};t-=n.piece.length-r;break}else e-=n.lf_left+n.piece.lineFeedCnt,i+=n.size_left+n.piece.length,n=n.right;for(n=n.next();n!==Be;){if(n.piece.lineFeedCnt>0){let r=this.getAccumulatedValue(n,0),s=this.offsetOfNode(n);return{node:n,remainder:Math.min(t-1,r),nodeStartOffset:s}}else if(n.piece.length>=t-1){let r=this.offsetOfNode(n);return{node:n,remainder:t-1,nodeStartOffset:r}}else t-=n.piece.length;n=n.next()}return null}nodeCharCodeAt(e,t){if(e.piece.lineFeedCnt<1)return-1;let n=this._buffers[e.piece.bufferIndex],i=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start)+t;return n.buffer.charCodeAt(i)}offsetOfNode(e){if(!e)return 0;let t=e.size_left;for(;e!==this.root;)e.parent.right===e&&(t+=e.parent.size_left+e.parent.piece.length),e=e.parent;return t}shouldCheckCRLF(){return!(this._EOLNormalized&&this._EOL===`
`)}startWithLF(e){if(typeof e=="string")return e.charCodeAt(0)===10;if(e===Be||e.piece.lineFeedCnt===0)return!1;let t=e.piece,n=this._buffers[t.bufferIndex].lineStarts,i=t.start.line,r=n[i]+t.start.column;return i===n.length-1||n[i+1]>r+1?!1:this._buffers[t.bufferIndex].buffer.charCodeAt(r)===10}endWithCR(e){return typeof e=="string"?e.charCodeAt(e.length-1)===13:e===Be||e.piece.lineFeedCnt===0?!1:this.nodeCharCodeAt(e,e.piece.length-1)===13}validateCRLFWithPrevNode(e){if(this.shouldCheckCRLF()&&this.startWithLF(e)){let t=e.prev();this.endWithCR(t)&&this.fixCRLF(t,e)}}validateCRLFWithNextNode(e){if(this.shouldCheckCRLF()&&this.endWithCR(e)){let t=e.next();this.startWithLF(t)&&this.fixCRLF(e,t)}}fixCRLF(e,t){let n=[],i=this._buffers[e.piece.bufferIndex].lineStarts,r;e.piece.end.column===0?r={line:e.piece.end.line-1,column:i[e.piece.end.line]-i[e.piece.end.line-1]-1}:r={line:e.piece.end.line,column:e.piece.end.column-1};let s=e.piece.length-1,a=e.piece.lineFeedCnt-1;e.piece=new uo(e.piece.bufferIndex,e.piece.start,r,a,s),Wa(this,e,-1,-1),e.piece.length===0&&n.push(e);let l={line:t.piece.start.line+1,column:0},d=t.piece.length-1,c=this.getLineFeedCnt(t.piece.bufferIndex,l,t.piece.end);t.piece=new uo(t.piece.bufferIndex,l,t.piece.end,c,d),Wa(this,t,-1,-1),t.piece.length===0&&n.push(t);let u=this.createNewPieces(`\r
`);this.rbInsertRight(e,u[0]);for(let p=0;p<n.length;p++)gv(this,n[p])}adjustCarriageReturnFromNext(e,t){if(this.shouldCheckCRLF()&&this.endWithCR(e)){let n=t.next();if(this.startWithLF(n)){if(e+=`
`,n.piece.length===1)gv(this,n);else{let i=n.piece,r={line:i.start.line+1,column:0},s=i.length-1,a=this.getLineFeedCnt(i.bufferIndex,r,i.end);n.piece=new uo(i.bufferIndex,r,i.end,a,s),Wa(this,n,-1,-1)}return!0}}return!1}iterate(e,t){if(e===Be)return t(Be);let n=this.iterate(e.left,t);return n&&t(e)&&this.iterate(e.right,t)}getNodeContent(e){if(e===Be)return"";let t=this._buffers[e.piece.bufferIndex],n=e.piece,i=this.offsetInBuffer(n.bufferIndex,n.start),r=this.offsetInBuffer(n.bufferIndex,n.end);return t.buffer.substring(i,r)}getPieceContent(e){let t=this._buffers[e.bufferIndex],n=this.offsetInBuffer(e.bufferIndex,e.start),i=this.offsetInBuffer(e.bufferIndex,e.end);return t.buffer.substring(n,i)}rbInsertRight(e,t){let n=new xm(t,1);if(n.left=Be,n.right=Be,n.parent=Be,n.size_left=0,n.lf_left=0,this.root===Be)this.root=n,n.color=0;else if(e.right===Be)e.right=n,n.parent=e;else{let r=KT(e.right);r.left=n,n.parent=r}return UM(this,n),n}rbInsertLeft(e,t){let n=new xm(t,1);if(n.left=Be,n.right=Be,n.parent=Be,n.size_left=0,n.lf_left=0,this.root===Be)this.root=n,n.color=0;else if(e.left===Be)e.left=n,n.parent=e;else{let i=VM(e.left);i.right=n,n.parent=i}return UM(this,n),n}getContentOfSubTree(e){let t="";return this.iterate(e,n=>(t+=this.getNodeContent(n),!0)),t}};var wm=class o extends F{_pieceTree;_BOM;_mightContainRTL;_mightContainUnusualLineTerminators;_mightContainNonBasicASCII;_onDidChangeContent=this._register(new D);onDidChangeContent=this._onDidChangeContent.event;constructor(e,t,n,i,r,s,a){super(),this._BOM=t,this._mightContainNonBasicASCII=!s,this._mightContainRTL=i,this._mightContainUnusualLineTerminators=r,this._pieceTree=new qT(e,n,a)}equals(e){return!(e instanceof o)||this._BOM!==e._BOM||this.getEOL()!==e.getEOL()?!1:this._pieceTree.equal(e._pieceTree)}mightContainRTL(){return this._mightContainRTL}mightContainUnusualLineTerminators(){return this._mightContainUnusualLineTerminators}resetMightContainUnusualLineTerminators(){this._mightContainUnusualLineTerminators=!1}mightContainNonBasicASCII(){return this._mightContainNonBasicASCII}getBOM(){return this._BOM}getEOL(){return this._pieceTree.getEOL()}createSnapshot(e){return this._pieceTree.createSnapshot(e?this._BOM:"")}getOffsetAt(e,t){return this._pieceTree.getOffsetAt(e,t)}getPositionAt(e){return this._pieceTree.getPositionAt(e)}getRangeAt(e,t){let n=e+t,i=this.getPositionAt(e),r=this.getPositionAt(n);return new P(i.lineNumber,i.column,r.lineNumber,r.column)}getValueInRange(e,t=0){if(e.isEmpty())return"";let n=this._getEndOfLine(t);return this._pieceTree.getValueInRange(e,n)}getValueLengthInRange(e,t=0){if(e.isEmpty())return 0;if(e.startLineNumber===e.endLineNumber)return e.endColumn-e.startColumn;let n=this.getOffsetAt(e.startLineNumber,e.startColumn),i=this.getOffsetAt(e.endLineNumber,e.endColumn),r=0,s=this._getEndOfLine(t),a=this.getEOL();if(s.length!==a.length){let l=s.length-a.length,d=e.endLineNumber-e.startLineNumber;r=l*d}return i-n+r}getCharacterCountInRange(e,t=0){if(this._mightContainNonBasicASCII){let n=0,i=e.startLineNumber,r=e.endLineNumber;for(let s=i;s<=r;s++){let a=this.getLineContent(s),l=s===i?e.startColumn-1:0,d=s===r?e.endColumn-1:a.length;for(let c=l;c<d;c++)ln(a.charCodeAt(c))?(n=n+1,c=c+1):n=n+1}return n+=this._getEndOfLine(t).length*(r-i),n}return this.getValueLengthInRange(e,t)}getNearestChunk(e){return this._pieceTree.getNearestChunk(e)}getLength(){return this._pieceTree.getLength()}getLineCount(){return this._pieceTree.getLineCount()}getLinesContent(){return this._pieceTree.getLinesContent()}getLineContent(e){return this._pieceTree.getLineContent(e)}getLineCharCode(e,t){return this._pieceTree.getLineCharCode(e,t)}getCharCode(e){return this._pieceTree.getCharCode(e)}getLineLength(e){return this._pieceTree.getLineLength(e)}getLineMinColumn(e){return 1}getLineMaxColumn(e){return this.getLineLength(e)+1}getLineFirstNonWhitespaceColumn(e){let t=Cn(this.getLineContent(e));return t===-1?0:t+1}getLineLastNonWhitespaceColumn(e){let t=Lr(this.getLineContent(e));return t===-1?0:t+2}_getEndOfLine(e){switch(e){case 1:return`
`;case 2:return`\r
`;case 0:return this.getEOL();default:throw new Error("Unknown EOL preference")}}setEOL(e){this._pieceTree.setEOL(e)}applyEdits(e,t,n){let i=this._mightContainRTL,r=this._mightContainUnusualLineTerminators,s=this._mightContainNonBasicASCII,a=!0,l=[];for(let g=0;g<e.length;g++){let b=e[g];a&&b._isTracked&&(a=!1);let v=b.range;if(b.text){let w=!0;s||(w=!bf(b.text),s=w),!i&&w&&(i=yl(b.text)),!r&&w&&(r=cI(b.text))}let y="",S=0,E=0,C=0;if(b.text){let w;[S,E,C,w]=Bo(b.text);let _=this.getEOL(),L=_===`\r
`?2:1;w===0||w===L?y=b.text:y=b.text.replace(/\r\n|\r|\n/g,_)}l[g]={sortIndex:g,identifier:b.identifier||null,range:v,rangeOffset:this.getOffsetAt(v.startLineNumber,v.startColumn),rangeLength:this.getValueLengthInRange(v),text:y,eolCount:S,firstLineLength:E,lastLineLength:C,forceMoveMarkers:!!b.forceMoveMarkers,isAutoWhitespaceEdit:b.isAutoWhitespaceEdit||!1}}l.sort(o._sortOpsAscending);let d=!1;for(let g=0,b=l.length-1;g<b;g++){let v=l[g].range.getEndPosition(),y=l[g+1].range.getStartPosition();if(y.isBeforeOrEqual(v)){if(y.isBefore(v))throw new Error("Overlapping ranges are not allowed!");d=!0}}a&&(l=this._reduceOperations(l));let c=n||t?o._getInverseEditRanges(l):[],u=[];if(t)for(let g=0;g<l.length;g++){let b=l[g],v=c[g];if(b.isAutoWhitespaceEdit&&b.range.isEmpty())for(let y=v.startLineNumber;y<=v.endLineNumber;y++){let S="";y===v.startLineNumber&&(S=this.getLineContent(b.range.startLineNumber),Cn(S)!==-1)||u.push({lineNumber:y,oldContent:S})}}let p=null;if(n){let g=0;p=[];for(let b=0;b<l.length;b++){let v=l[b],y=c[b],S=this.getValueInRange(v.range),E=v.rangeOffset+g;g+=v.text.length-S.length,p[b]={sortIndex:v.sortIndex,identifier:v.identifier,range:y,text:S,textChange:new sr(v.rangeOffset,S,E,v.text)}}d||p.sort((b,v)=>b.sortIndex-v.sortIndex)}this._mightContainRTL=i,this._mightContainUnusualLineTerminators=r,this._mightContainNonBasicASCII=s;let h=this._doApplyEdits(l),f=null;if(t&&u.length>0){u.sort((g,b)=>b.lineNumber-g.lineNumber),f=[];for(let g=0,b=u.length;g<b;g++){let v=u[g].lineNumber;if(g>0&&u[g-1].lineNumber===v)continue;let y=u[g].oldContent,S=this.getLineContent(v);S.length===0||S===y||Cn(S)!==-1||f.push(v)}}return this._onDidChangeContent.fire(),new AC(p,h,f)}_reduceOperations(e){return e.length<1e3?e:[this._toSingleEditOperation(e)]}_toSingleEditOperation(e){let t=!1,n=e[0].range,i=e[e.length-1].range,r=new P(n.startLineNumber,n.startColumn,i.endLineNumber,i.endColumn),s=n.startLineNumber,a=n.startColumn,l=[];for(let h=0,f=e.length;h<f;h++){let g=e[h],b=g.range;t=t||g.forceMoveMarkers,l.push(this.getValueInRange(new P(s,a,b.startLineNumber,b.startColumn))),g.text.length>0&&l.push(g.text),s=b.endLineNumber,a=b.endColumn}let d=l.join(""),[c,u,p]=Bo(d);return{sortIndex:0,identifier:e[0].identifier,range:r,rangeOffset:this.getOffsetAt(r.startLineNumber,r.startColumn),rangeLength:this.getValueLengthInRange(r,0),text:d,eolCount:c,firstLineLength:u,lastLineLength:p,forceMoveMarkers:t,isAutoWhitespaceEdit:!1}}_doApplyEdits(e){e.sort(o._sortOpsDescending);let t=[];for(let n=0;n<e.length;n++){let i=e[n],r=i.range.startLineNumber,s=i.range.startColumn,a=i.range.endLineNumber,l=i.range.endColumn;if(r===a&&s===l&&i.text.length===0)continue;i.text?(this._pieceTree.delete(i.rangeOffset,i.rangeLength),this._pieceTree.insert(i.rangeOffset,i.text,!0)):this._pieceTree.delete(i.rangeOffset,i.rangeLength);let d=new P(r,s,a,l);t.push({range:d,rangeLength:i.rangeLength,text:i.text,rangeOffset:i.rangeOffset,forceMoveMarkers:i.forceMoveMarkers})}return t}findMatchesLineByLine(e,t,n,i){return this._pieceTree.findMatchesLineByLine(e,t,n,i)}getPieceTree(){return this._pieceTree}static _getInverseEditRange(e,t){let n=e.startLineNumber,i=e.startColumn,[r,s,a]=Bo(t),l;if(t.length>0){let d=r+1;d===1?l=new P(n,i,n,i+s):l=new P(n,i,n+d-1,a+1)}else l=new P(n,i,n,i);return l}static _getInverseEditRanges(e){let t=[],n=0,i=0,r=null;for(let s=0,a=e.length;s<a;s++){let l=e[s],d,c;r?r.range.endLineNumber===l.range.startLineNumber?(d=n,c=i+(l.range.startColumn-r.range.endColumn)):(d=n+(l.range.startLineNumber-r.range.endLineNumber),c=l.range.startColumn):(d=l.range.startLineNumber,c=l.range.startColumn);let u;if(l.text.length>0){let p=l.eolCount+1;p===1?u=new P(d,c,d,c+l.firstLineLength):u=new P(d,c,d+p-1,l.lastLineLength+1)}else u=new P(d,c,d,c);n=u.endLineNumber,i=u.endColumn,t.push(u),r=l}return t}static _sortOpsAscending(e,t){let n=P.compareRangesUsingEnds(e.range,t.range);return n===0?e.sortIndex-t.sortIndex:n}static _sortOpsDescending(e,t){let n=P.compareRangesUsingEnds(e.range,t.range);return n===0?t.sortIndex-e.sortIndex:-n}};var qM=class{constructor(e,t,n,i,r,s,a,l,d){this._chunks=e;this._bom=t;this._cr=n;this._lf=i;this._crlf=r;this._containsRTL=s;this._containsUnusualLineTerminators=a;this._isBasicASCII=l;this._normalizeEOL=d}_getEOL(e){let t=this._cr+this._lf+this._crlf,n=this._cr+this._crlf;return t===0?e===1?`
`:`\r
`:n>t/2?`\r
`:`
`}create(e){let t=this._getEOL(e),n=this._chunks;if(this._normalizeEOL&&(t===`\r
`&&(this._cr>0||this._lf>0)||t===`
`&&(this._cr>0||this._crlf>0)))for(let r=0,s=n.length;r<s;r++){let a=n[r].buffer.replace(/\r\n|\r|\n/g,t),l=Ha(a);n[r]=new Ua(a,l)}let i=new wm(n,this._bom,t,this._containsRTL,this._containsUnusualLineTerminators,this._isBasicASCII,this._normalizeEOL);return{textBuffer:i,disposable:i}}getFirstLineText(e){return this._chunks[0].buffer.substr(0,e).split(/\r\n|\r|\n/)[0]}},_m=class{chunks;BOM;_hasPreviousChar;_previousChar;_tmpLineStarts;cr;lf;crlf;containsRTL;containsUnusualLineTerminators;isBasicASCII;constructor(){this.chunks=[],this.BOM="",this._hasPreviousChar=!1,this._previousChar=0,this._tmpLineStarts=[],this.cr=0,this.lf=0,this.crlf=0,this.containsRTL=!1,this.containsUnusualLineTerminators=!1,this.isBasicASCII=!0}acceptChunk(e){if(e.length===0)return;this.chunks.length===0&&zA(e)&&(this.BOM=UA,e=e.substr(1));let t=e.charCodeAt(e.length-1);t===13||t>=55296&&t<=56319?(this._acceptChunk1(e.substr(0,e.length-1),!1),this._hasPreviousChar=!0,this._previousChar=t):(this._acceptChunk1(e,!1),this._hasPreviousChar=!1,this._previousChar=t)}_acceptChunk1(e,t){!t&&e.length===0||(this._hasPreviousChar?this._acceptChunk2(String.fromCharCode(this._previousChar)+e):this._acceptChunk2(e))}_acceptChunk2(e){let t=_U(this._tmpLineStarts,e);this.chunks.push(new Ua(e,t.lineStarts)),this.cr+=t.cr,this.lf+=t.lf,this.crlf+=t.crlf,t.isBasicASCII||(this.isBasicASCII=!1,this.containsRTL||(this.containsRTL=yl(e)),this.containsUnusualLineTerminators||(this.containsUnusualLineTerminators=cI(e)))}finish(e=!0){return this._finish(),new qM(this.chunks,this.BOM,this.cr,this.lf,this.crlf,this.containsRTL,this.containsUnusualLineTerminators,this.isBasicASCII,e)}_finish(){if(this.chunks.length===0&&this._acceptChunk1("",!0),this._hasPreviousChar){this._hasPreviousChar=!1;let e=this.chunks[this.chunks.length-1];e.buffer+=String.fromCharCode(this._previousChar);let t=Ha(e.buffer);e.lineStarts=t,this._previousChar===13&&this.cr++}}};var DU=new class{clone(){return this}equals(o){return this===o}};function $M(o,e){let t=new Uint32Array(2);return t[0]=0,t[1]=(o<<0|0|0|32768|2<<24)>>>0,new VC(t,e===null?DU:e)}var $T=class{constructor(e){this._default=e}_store=[];get(e){return e<this._store.length?this._store[e]:this._default}set(e,t){for(;e>=this._store.length;)this._store[this._store.length]=this._default;this._store[e]=t}replace(e,t,n){if(e>=this._store.length)return;if(t===0){this.insert(e,n);return}else if(n===0){this.delete(e,t);return}let i=this._store.slice(0,e),r=this._store.slice(e+t),s=rG(n,this._default);this._store=i.concat(s,r)}delete(e,t){t===0||e>=this._store.length||this._store.splice(e,t)}insert(e,t){if(t===0||e>=this._store.length)return;let n=[];for(let i=0;i<t;i++)n[i]=this._default;this._store=sa(this._store,e,n)}};function rG(o,e){let t=[];for(let n=0;n<o;n++)t[n]=e;return t}var qu=class{static deserialize(e){let t=0,n=pi(e,t);t+=4;let i=[];for(let r=0;r<n;r++)t=ob.deserialize(e,t,i);return i}_tokens;constructor(){this._tokens=[]}add(e,t){if(this._tokens.length>0){let n=this._tokens[this._tokens.length-1];if(n.endLineNumber+1===e){n.appendLineTokens(t);return}}this._tokens.push(new ob(e,[t]))}finalize(){return this._tokens}serialize(){let e=this._serializeSize(),t=new Uint8Array(e);return this._serialize(t),t}_serializeSize(){let e=0;e+=4;for(let t=0;t<this._tokens.length;t++)e+=this._tokens[t].serializeSize();return e}_serialize(e){let t=0;hi(e,this._tokens.length,t),t+=4;for(let n=0;n<this._tokens.length;n++)t=this._tokens[n].serialize(e,t)}};var YM=class{constructor(e,t){this.tokenizationSupport=t;this.store=new Lm(e)}initialState=this.tokenizationSupport.getInitialState();store;getStartState(e){return this.store.getStartState(e,this.initialState)}getFirstInvalidLine(){return this.store.getFirstInvalidLine(this.initialState)}},YT=class extends YM{constructor(t,n,i,r){super(t,n);this._textModel=i;this._languageIdCodec=r}updateTokensUntilLine(t,n){let i=this._textModel.getLanguageId();for(;;){let r=this.getFirstInvalidLine();if(!r||r.lineNumber>n)break;let s=this._textModel.getLineContent(r.lineNumber),a=Dm(this._languageIdCodec,i,this.tokenizationSupport,s,!0,r.startState);t.add(r.lineNumber,a.tokens),this.store.setEndState(r.lineNumber,a.endState)}}getTokenTypeIfInsertingCharacter(t,n){let i=this.getStartState(t.lineNumber);if(!i)return 0;let r=this._textModel.getLanguageId(),s=this._textModel.getLineContent(t.lineNumber),a=s.substring(0,t.column-1)+n+s.substring(t.column-1),l=Dm(this._languageIdCodec,r,this.tokenizationSupport,a,!0,i),d=new Sn(l.tokens,a,this._languageIdCodec);if(d.getCount()===0)return 0;let c=d.findTokenIndexAtOffset(t.column-1);return d.getStandardTokenType(c)}tokenizeLineWithEdit(t,n){let i=this.getStartState(t);if(!i)return{mainLineTokens:null,additionalLines:null};let r=this._textModel.getLineContent(t),s=n.lineEdit.apply(r),a=this._textModel.getLanguageIdAtPosition(t,0),l=Dm(this._languageIdCodec,a,this.tokenizationSupport,s,!0,i),d=null;if(n.additionalLines){d=[];let u=l.endState;for(let p of n.additionalLines){let h=Dm(this._languageIdCodec,a,this.tokenizationSupport,p,!0,u);d.push(new Sn(h.tokens,p,this._languageIdCodec)),u=h.endState}}return{mainLineTokens:new Sn(l.tokens,s,this._languageIdCodec),additionalLines:d}}hasAccurateTokensForLine(t){let n=this.store.getFirstInvalidEndStateLineNumberOrMax();return t<n}isCheapToTokenize(t){let n=this.store.getFirstInvalidEndStateLineNumberOrMax();return t<n||t===n&&this._textModel.getLineLength(t)<2048}tokenizeHeuristically(t,n,i){if(i<=this.store.getFirstInvalidEndStateLineNumberOrMax())return{heuristicTokens:!1};if(n<=this.store.getFirstInvalidEndStateLineNumberOrMax())return this.updateTokensUntilLine(t,i),{heuristicTokens:!1};let r=this.guessStartState(n),s=this._textModel.getLanguageId();for(let a=n;a<=i;a++){let l=this._textModel.getLineContent(a),d=Dm(this._languageIdCodec,s,this.tokenizationSupport,l,!0,r);t.add(a,d.tokens),r=d.endState}return{heuristicTokens:!0}}guessStartState(t){let n=this._textModel.getLineFirstNonWhitespaceColumn(t),i=[],r=null;for(let l=t-1;n>1&&l>=1;l--){let d=this._textModel.getLineFirstNonWhitespaceColumn(l);if(d!==0&&d<n&&(i.push(this._textModel.getLineContent(l)),n=d,r=this.getStartState(l),r))break}r||(r=this.tokenizationSupport.getInitialState()),i.reverse();let s=this._textModel.getLanguageId(),a=r;for(let l of i)a=Dm(this._languageIdCodec,s,this.tokenizationSupport,l,!1,a).endState;return a}},Lm=class{constructor(e){this.lineCount=e;this._invalidEndStatesLineNumbers.addRange(new ke(1,e+1))}_tokenizationStateStore=new ZM;_invalidEndStatesLineNumbers=new XM;getEndState(e){return this._tokenizationStateStore.getEndState(e)}setEndState(e,t){if(!t)throw new Ye("Cannot set null/undefined state");this._invalidEndStatesLineNumbers.delete(e);let n=this._tokenizationStateStore.setEndState(e,t);return n&&e<this.lineCount&&this._invalidEndStatesLineNumbers.addRange(new ke(e+1,e+2)),n}acceptChange(e,t){this.lineCount+=t-e.length,this._tokenizationStateStore.acceptChange(e,t),this._invalidEndStatesLineNumbers.addRangeAndResize(new ke(e.startLineNumber,e.endLineNumberExclusive),t)}acceptChanges(e){for(let t of e){let[n]=Bo(t.text);this.acceptChange(new Re(t.range.startLineNumber,t.range.endLineNumber+1),n+1)}}invalidateEndStateRange(e){this._invalidEndStatesLineNumbers.addRange(new ke(e.startLineNumber,e.endLineNumberExclusive))}getFirstInvalidEndStateLineNumber(){return this._invalidEndStatesLineNumbers.min}getFirstInvalidEndStateLineNumberOrMax(){return this.getFirstInvalidEndStateLineNumber()||Number.MAX_SAFE_INTEGER}allStatesValid(){return this._invalidEndStatesLineNumbers.min===null}getStartState(e,t){return e===1?t:this.getEndState(e-1)}getFirstInvalidLine(e){let t=this.getFirstInvalidEndStateLineNumber();if(t===null)return null;let n=this.getStartState(t,e);if(!n)throw new Ye("Start state must be defined");return{lineNumber:t,startState:n}}},ZM=class{_lineEndStates=new $T(null);getEndState(e){return this._lineEndStates.get(e)}setEndState(e,t){let n=this._lineEndStates.get(e);return n&&n.equals(t)?!1:(this._lineEndStates.set(e,t),!0)}acceptChange(e,t){let n=e.length;t>0&&n>0&&(n--,t--),this._lineEndStates.replace(e.startLineNumber,n,t)}acceptChanges(e){for(let t of e){let[n]=Bo(t.text);this.acceptChange(new Re(t.range.startLineNumber,t.range.endLineNumber+1),n+1)}}},XM=class{_ranges=[];getRanges(){return this._ranges}get min(){return this._ranges.length===0?null:this._ranges[0].start}removeMin(){if(this._ranges.length===0)return null;let e=this._ranges[0];return e.start+1===e.endExclusive?this._ranges.shift():this._ranges[0]=new ke(e.start+1,e.endExclusive),e.start}delete(e){let t=this._ranges.findIndex(n=>n.contains(e));if(t!==-1){let n=this._ranges[t];n.start===e?n.endExclusive===e+1?this._ranges.splice(t,1):this._ranges[t]=new ke(e+1,n.endExclusive):n.endExclusive===e+1?this._ranges[t]=new ke(n.start,e):this._ranges.splice(t,1,new ke(n.start,e),new ke(e+1,n.endExclusive))}}addRange(e){ke.addRange(e,this._ranges)}addRangeAndResize(e,t){let n=0;for(;!(n>=this._ranges.length||e.start<=this._ranges[n].endExclusive);)n++;let i=n;for(;!(i>=this._ranges.length||e.endExclusive<this._ranges[i].start);)i++;let r=t-e.length;for(let s=i;s<this._ranges.length;s++)this._ranges[s]=this._ranges[s].delta(r);if(n===i){let s=new ke(e.start,e.start+t);s.isEmpty||this._ranges.splice(n,0,s)}else{let s=Math.min(e.start,this._ranges[n].start),a=Math.max(e.endExclusive,this._ranges[i-1].endExclusive),l=new ke(s,a+r);l.isEmpty?this._ranges.splice(n,i-n):this._ranges.splice(n,i-n,l)}}toString(){return this._ranges.map(e=>e.toString()).join(" + ")}};function Dm(o,e,t,n,i,r){let s=null;if(t)try{s=t.tokenizeEncoded(n,i,r.clone())}catch(a){qe(a)}return s||(s=$M(o.encodeLanguageId(e),r)),Sn.convertToEndOffset(s.tokens,n.length),s}var ZT=class{constructor(e,t){this._tokenizerWithStateStore=e;this._backgroundTokenStore=t}_isDisposed=!1;dispose(){this._isDisposed=!0}handleChanges(){this._beginBackgroundTokenization()}_isScheduled=!1;_beginBackgroundTokenization(){this._isScheduled||!this._tokenizerWithStateStore._textModel.isAttachedToEditor()||!this._hasLinesToTokenize()||(this._isScheduled=!0,Td(e=>{this._isScheduled=!1,this._backgroundTokenizeWithDeadline(e)}))}_backgroundTokenizeWithDeadline(e){let t=Date.now()+e.timeRemaining(),n=()=>{this._isDisposed||!this._tokenizerWithStateStore._textModel.isAttachedToEditor()||!this._hasLinesToTokenize()||(this._backgroundTokenizeForAtLeast1ms(),Date.now()<t?My(n):this._beginBackgroundTokenization())};n()}_backgroundTokenizeForAtLeast1ms(){let e=this._tokenizerWithStateStore._textModel.getLineCount(),t=new qu,n=Cs.create(!1);do if(n.elapsed()>1||this._tokenizeOneInvalidLine(t)>=e)break;while(this._hasLinesToTokenize());this._backgroundTokenStore.setTokens(t.finalize()),this.checkFinished()}_hasLinesToTokenize(){return this._tokenizerWithStateStore?!this._tokenizerWithStateStore.store.allStatesValid():!1}_tokenizeOneInvalidLine(e){let t=this._tokenizerWithStateStore?.getFirstInvalidLine();return t?(this._tokenizerWithStateStore.updateTokensUntilLine(e,t.lineNumber),t.lineNumber):this._tokenizerWithStateStore._textModel.getLineCount()+1}checkFinished(){this._isDisposed||this._tokenizerWithStateStore.store.allStatesValid()&&this._backgroundTokenStore.backgroundTokenizationFinished()}requestTokens(e,t){this._tokenizerWithStateStore.store.invalidateEndStateRange(new Re(e,t))}};var XT=class{_onDidChangeVisibleRanges=new D;onDidChangeVisibleRanges=this._onDidChangeVisibleRanges.event;_views=new Set;attachView(){let e=new QM(t=>{this._onDidChangeVisibleRanges.fire({view:e,state:t})});return this._views.add(e),e}detachView(e){this._views.delete(e),this._onDidChangeVisibleRanges.fire({view:e,state:void 0})}},QM=class{constructor(e){this.handleStateChange=e}setVisibleLines(e,t){let n=e.map(i=>new Re(i.startLineNumber,i.endLineNumber+1));this.handleStateChange({visibleLineRanges:n,stabilized:t})}},QT=class extends F{constructor(t){super();this._refreshTokens=t}runner=this._register(new nn(()=>this.update(),50));_computedLineRanges=[];_lineRanges=[];get lineRanges(){return this._lineRanges}update(){zt(this._computedLineRanges,this._lineRanges,(t,n)=>t.equals(n))||(this._computedLineRanges=this._lineRanges,this._refreshTokens())}handleStateChange(t){this._lineRanges=t.visibleLineRanges,t.stabilized?(this.runner.cancel(),this.update()):this.runner.schedule()}},Rm=class extends F{constructor(t,n,i){super();this._languageIdCodec=t;this._textModel=n;this.getLanguageId=i}_backgroundTokenizationState=1;get backgroundTokenizationState(){return this._backgroundTokenizationState}_onDidChangeBackgroundTokenizationState=this._register(new D);onDidChangeBackgroundTokenizationState=this._onDidChangeBackgroundTokenizationState.event;_onDidChangeTokens=this._register(new D);onDidChangeTokens=this._onDidChangeTokens.event;tokenizeIfCheap(t){this.isCheapToTokenize(t)&&this.forceTokenization(t)}};var LU=Y("treeSitterParserService");var fv=class extends Rm{constructor(t,n,i,r){super(n,i,r);this._treeSitterService=t;this._initialize()}_tokenizationSupport=null;_lastLanguageId;_initialize(){let t=this.getLanguageId();(!this._tokenizationSupport||this._lastLanguageId!==t)&&(this._lastLanguageId=t,this._tokenizationSupport=sb.get(t))}getLineTokens(t){let n=this._textModel.getLineContent(t);if(this._tokenizationSupport){let i=this._tokenizationSupport.tokenizeEncoded(t,this._textModel);if(i)return new Sn(i,n,this._languageIdCodec)}return Sn.createEmpty(n,this._languageIdCodec)}resetTokenization(t=!0){t&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]}),this._initialize()}handleDidChangeAttached(){}handleDidChangeContent(t){t.isFlush&&this.resetTokenization(!1)}forceTokenization(t){}hasAccurateTokensForLine(t){return!0}isCheapToTokenize(t){return!0}getTokenTypeIfInsertingCharacter(t,n,i){return 0}tokenizeLineWithEdit(t,n){return{mainLineTokens:null,additionalLines:null}}get hasTokens(){return this._treeSitterService.getParseResult(this._textModel)!==void 0}};var bv=class o{_lineTokens;_len;_languageIdCodec;constructor(e){this._lineTokens=[],this._len=0,this._languageIdCodec=e}flush(){this._lineTokens=[],this._len=0}get hasTokens(){return this._lineTokens.length>0}getTokens(e,t,n){let i=null;if(t<this._len&&(i=this._lineTokens[t]),i!==null&&i!==Ea)return new Sn(Ta(i),n,this._languageIdCodec);let r=new Uint32Array(2);return r[0]=n.length,r[1]=RU(this._languageIdCodec.encodeLanguageId(e)),new Sn(r,n,this._languageIdCodec)}static _massageTokens(e,t,n){let i=n?Ta(n):null;if(t===0){let r=!1;if(i&&i.length>1&&(r=rr.getLanguageId(i[1])!==e),!r)return Ea}if(!i||i.length===0){let r=new Uint32Array(2);return r[0]=t,r[1]=RU(e),r.buffer}return i[i.length-2]=t,i.byteOffset===0&&i.byteLength===i.buffer.byteLength?i.buffer:i}_ensureLine(e){for(;e>=this._len;)this._lineTokens[this._len]=null,this._len++}_deleteLines(e,t){t!==0&&(e+t>this._len&&(t=this._len-e),this._lineTokens.splice(e,t),this._len-=t)}_insertLines(e,t){if(t===0)return;let n=[];for(let i=0;i<t;i++)n[i]=null;this._lineTokens=sa(this._lineTokens,e,n),this._len+=t}setTokens(e,t,n,i,r){let s=o._massageTokens(this._languageIdCodec.encodeLanguageId(e),n,i);this._ensureLine(t);let a=this._lineTokens[t];return this._lineTokens[t]=s,r?!o._equals(a,s):!1}static _equals(e,t){if(!e||!t)return!e&&!t;let n=Ta(e),i=Ta(t);if(n.length!==i.length)return!1;for(let r=0,s=n.length;r<s;r++)if(n[r]!==i[r])return!1;return!0}acceptEdit(e,t,n){this._acceptDeleteRange(e),this._acceptInsertText(new A(e.startLineNumber,e.startColumn),t,n)}_acceptDeleteRange(e){let t=e.startLineNumber-1;if(t>=this._len)return;if(e.startLineNumber===e.endLineNumber){if(e.startColumn===e.endColumn)return;this._lineTokens[t]=mi.delete(this._lineTokens[t],e.startColumn-1,e.endColumn-1);return}this._lineTokens[t]=mi.deleteEnding(this._lineTokens[t],e.startColumn-1);let n=e.endLineNumber-1,i=null;n<this._len&&(i=mi.deleteBeginning(this._lineTokens[n],e.endColumn-1)),this._lineTokens[t]=mi.append(this._lineTokens[t],i),this._deleteLines(e.startLineNumber,e.endLineNumber-e.startLineNumber)}_acceptInsertText(e,t,n){if(t===0&&n===0)return;let i=e.lineNumber-1;if(!(i>=this._len)){if(t===0){this._lineTokens[i]=mi.insert(this._lineTokens[i],e.column-1,n);return}this._lineTokens[i]=mi.deleteEnding(this._lineTokens[i],e.column-1),this._lineTokens[i]=mi.insert(this._lineTokens[i],e.column-1,n),this._insertLines(e.lineNumber,t)}}setMultilineTokens(e,t){if(e.length===0)return{changes:[]};let n=[];for(let i=0,r=e.length;i<r;i++){let s=e[i],a=0,l=0,d=!1;for(let c=s.startLineNumber;c<=s.endLineNumber;c++)d?(this.setTokens(t.getLanguageId(),c-1,t.getLineLength(c),s.getLineTokens(c),!1),l=c):this.setTokens(t.getLanguageId(),c-1,t.getLineLength(c),s.getLineTokens(c),!0)&&(d=!0,a=c,l=c);d&&n.push({fromLineNumber:a,toLineNumber:l})}return{changes:n}}};function RU(o){return(o<<0|0|0|32768|2<<24|1024)>>>0}var JT=class o{_pieces;_isComplete;_languageIdCodec;constructor(e){this._pieces=[],this._isComplete=!1,this._languageIdCodec=e}flush(){this._pieces=[],this._isComplete=!1}isEmpty(){return this._pieces.length===0}set(e,t){this._pieces=e||[],this._isComplete=t}setPartial(e,t){let n=e;if(t.length>0){let r=t[0].getRange(),s=t[t.length-1].getRange();if(!r||!s)return e;n=e.plusRange(r).plusRange(s)}let i=null;for(let r=0,s=this._pieces.length;r<s;r++){let a=this._pieces[r];if(a.endLineNumber<n.startLineNumber)continue;if(a.startLineNumber>n.endLineNumber){i=i||{index:r};break}if(a.removeTokens(n),a.isEmpty()){this._pieces.splice(r,1),r--,s--;continue}if(a.endLineNumber<n.startLineNumber)continue;if(a.startLineNumber>n.endLineNumber){i=i||{index:r};continue}let[l,d]=a.split(n);if(l.isEmpty()){i=i||{index:r};continue}d.isEmpty()||(this._pieces.splice(r,1,l,d),r++,s++,i=i||{index:r})}return i=i||{index:this._pieces.length},t.length>0&&(this._pieces=sa(this._pieces,i.index,t)),n}isComplete(){return this._isComplete}addSparseTokens(e,t){if(t.getLineContent().length===0)return t;let n=this._pieces;if(n.length===0)return t;let i=o._findFirstPieceWithLine(n,e),r=n[i].getLineTokens(e);if(!r)return t;let s=t.getCount(),a=r.getCount(),l=0,d=[],c=0,u=0,p=(h,f)=>{h!==u&&(u=h,d[c++]=h,d[c++]=f)};for(let h=0;h<a;h++){let f=r.getStartCharacter(h),g=r.getEndCharacter(h),b=r.getMetadata(h),v=((b&1?2048:0)|(b&2?4096:0)|(b&4?8192:0)|(b&8?16384:0)|(b&16?16744448:0)|(b&32?4278190080:0))>>>0,y=~v>>>0;for(;l<s&&t.getEndOffset(l)<=f;)p(t.getEndOffset(l),t.getMetadata(l)),l++;for(l<s&&t.getStartOffset(l)<f&&p(f,t.getMetadata(l));l<s&&t.getEndOffset(l)<g;)p(t.getEndOffset(l),t.getMetadata(l)&y|b&v),l++;if(l<s)p(g,t.getMetadata(l)&y|b&v),t.getEndOffset(l)===g&&l++;else{let S=Math.min(Math.max(0,l-1),s-1);p(g,t.getMetadata(S)&y|b&v)}}for(;l<s;)p(t.getEndOffset(l),t.getMetadata(l)),l++;return new Sn(new Uint32Array(d),t.getLineContent(),this._languageIdCodec)}static _findFirstPieceWithLine(e,t){let n=0,i=e.length-1;for(;n<i;){let r=n+Math.floor((i-n)/2);if(e[r].endLineNumber<t)n=r+1;else if(e[r].startLineNumber>t)i=r-1;else{for(;r>n&&e[r-1].startLineNumber<=t&&t<=e[r-1].endLineNumber;)r--;return r}}return n}acceptEdit(e,t,n,i,r){for(let s of this._pieces)s.acceptEdit(e,t,n,i,r)}};var zl=class extends Sm{constructor(t,n,i,r,s,a,l){super();this._textModel=t;this._bracketPairsTextModelPart=n;this._languageId=i;this._attachedViews=r;this._languageService=s;this._languageConfigurationService=a;this._treeSitterService=l;this._register(this._languageConfigurationService.onDidChange(d=>{d.affects(this._languageId)&&this._onDidChangeLanguageConfiguration.fire({})})),this._register(q.filter(sb.onDidChange,d=>d.changedLanguages.includes(this._languageId))(()=>{this.createPreferredTokenProvider()})),this.createPreferredTokenProvider()}_semanticTokens=new JT(this._languageService.languageIdCodec);_onDidChangeLanguage=this._register(new D);onDidChangeLanguage=this._onDidChangeLanguage.event;_onDidChangeLanguageConfiguration=this._register(new D);onDidChangeLanguageConfiguration=this._onDidChangeLanguageConfiguration.event;_onDidChangeTokens=this._register(new D);onDidChangeTokens=this._onDidChangeTokens.event;_tokens;_tokensDisposables=this._register(new ee);createGrammarTokens(){return this._register(new ex(this._languageService.languageIdCodec,this._textModel,()=>this._languageId,this._attachedViews))}createTreeSitterTokens(){return this._register(new fv(this._treeSitterService,this._languageService.languageIdCodec,this._textModel,()=>this._languageId))}createTokens(t){let n=this._tokens!==void 0;this._tokens?.dispose(),this._tokens=t?this.createTreeSitterTokens():this.createGrammarTokens(),this._tokensDisposables.clear(),this._tokensDisposables.add(this._tokens.onDidChangeTokens(i=>{this._emitModelTokensChangedEvent(i)})),this._tokensDisposables.add(this._tokens.onDidChangeBackgroundTokenizationState(i=>{this._bracketPairsTextModelPart.handleDidChangeBackgroundTokenizationState()})),n&&this._tokens.resetTokenization()}createPreferredTokenProvider(){sb.get(this._languageId)?this._tokens instanceof fv||this.createTokens(!0):this._tokens instanceof ex||this.createTokens(!1)}_hasListeners(){return this._onDidChangeLanguage.hasListeners()||this._onDidChangeLanguageConfiguration.hasListeners()||this._onDidChangeTokens.hasListeners()}handleLanguageConfigurationServiceChange(t){t.affects(this._languageId)&&this._onDidChangeLanguageConfiguration.fire({})}handleDidChangeContent(t){if(t.isFlush)this._semanticTokens.flush();else if(!t.isEolChange)for(let n of t.changes){let[i,r,s]=Bo(n.text);this._semanticTokens.acceptEdit(n.range,i,r,s,n.text.length>0?n.text.charCodeAt(0):0)}this._tokens.handleDidChangeContent(t)}handleDidChangeAttached(){this._tokens.handleDidChangeAttached()}getLineTokens(t){this.validateLineNumber(t);let n=this._tokens.getLineTokens(t);return this._semanticTokens.addSparseTokens(t,n)}_emitModelTokensChangedEvent(t){this._textModel._isDisposing()||(this._bracketPairsTextModelPart.handleDidChangeTokens(t),this._onDidChangeTokens.fire(t))}validateLineNumber(t){if(t<1||t>this._textModel.getLineCount())throw new Ye("Illegal value for lineNumber")}get hasTokens(){return this._tokens.hasTokens}resetTokenization(){this._tokens.resetTokenization()}get backgroundTokenizationState(){return this._tokens.backgroundTokenizationState}forceTokenization(t){this.validateLineNumber(t),this._tokens.forceTokenization(t)}hasAccurateTokensForLine(t){return this.validateLineNumber(t),this._tokens.hasAccurateTokensForLine(t)}isCheapToTokenize(t){return this.validateLineNumber(t),this._tokens.isCheapToTokenize(t)}tokenizeIfCheap(t){this.validateLineNumber(t),this._tokens.tokenizeIfCheap(t)}getTokenTypeIfInsertingCharacter(t,n,i){return this._tokens.getTokenTypeIfInsertingCharacter(t,n,i)}tokenizeLineWithEdit(t,n){return this._tokens.tokenizeLineWithEdit(t,n)}setSemanticTokens(t,n){this._semanticTokens.set(t,n),this._emitModelTokensChangedEvent({semanticTokensApplied:t!==null,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]})}hasCompleteSemanticTokens(){return this._semanticTokens.isComplete()}hasSomeSemanticTokens(){return!this._semanticTokens.isEmpty()}setPartialSemanticTokens(t,n){if(this.hasCompleteSemanticTokens())return;let i=this._textModel.validateRange(this._semanticTokens.setPartial(t,n));this._emitModelTokensChangedEvent({semanticTokensApplied:!0,ranges:[{fromLineNumber:i.startLineNumber,toLineNumber:i.endLineNumber}]})}getWordAtPosition(t){this.assertNotDisposed();let n=this._textModel.validatePosition(t),i=this._textModel.getLineContent(n.lineNumber),r=this.getLineTokens(n.lineNumber),s=r.findTokenIndexAtOffset(n.column-1),[a,l]=zl._findLanguageBoundaries(r,s),d=Wf(n.column,this.getLanguageConfiguration(r.getLanguageId(s)).getWordDefinition(),i.substring(a,l),a);if(d&&d.startColumn<=t.column&&t.column<=d.endColumn)return d;if(s>0&&a===n.column-1){let[c,u]=zl._findLanguageBoundaries(r,s-1),p=Wf(n.column,this.getLanguageConfiguration(r.getLanguageId(s-1)).getWordDefinition(),i.substring(c,u),c);if(p&&p.startColumn<=t.column&&t.column<=p.endColumn)return p}return null}getLanguageConfiguration(t){return this._languageConfigurationService.getLanguageConfiguration(t)}static _findLanguageBoundaries(t,n){let i=t.getLanguageId(n),r=0;for(let a=n;a>=0&&t.getLanguageId(a)===i;a--)r=t.getStartOffset(a);let s=t.getLineContent().length;for(let a=n,l=t.getCount();a<l&&t.getLanguageId(a)===i;a++)s=t.getEndOffset(a);return[r,s]}getWordUntilPosition(t){let n=this.getWordAtPosition(t);return n?{word:n.word.substr(0,t.column-n.startColumn),startColumn:n.startColumn,endColumn:t.column}:{word:"",startColumn:t.column,endColumn:t.column}}getLanguageId(){return this._languageId}getLanguageIdAtPosition(t,n){let i=this._textModel.validatePosition(new A(t,n)),r=this.getLineTokens(i.lineNumber);return r.getLanguageId(r.findTokenIndexAtOffset(i.column-1))}setLanguageId(t,n="api"){if(this._languageId===t)return;let i={oldLanguage:this._languageId,newLanguage:t,source:n};this._languageId=t,this._bracketPairsTextModelPart.handleDidChangeLanguage(i),this._tokens.resetTokenization(),this.createPreferredTokenProvider(),this._onDidChangeLanguage.fire(i),this._onDidChangeLanguageConfiguration.fire({})}};zl=O([x(4,Di),x(5,xl),x(6,LU)],zl);var ex=class extends Rm{_tokenizer=null;_defaultBackgroundTokenizer=null;_backgroundTokenizer=this._register(new un);_tokens=new bv(this._languageIdCodec);_debugBackgroundTokens;_debugBackgroundStates;_debugBackgroundTokenizer=this._register(new un);_attachedViewStates=this._register(new Lo);constructor(e,t,n,i){super(e,t,n),this._register(cr.onDidChange(r=>{let s=this.getLanguageId();r.changedLanguages.indexOf(s)!==-1&&this.resetTokenization()})),this.resetTokenization(),this._register(i.onDidChangeVisibleRanges(({view:r,state:s})=>{if(s){let a=this._attachedViewStates.get(r);a||(a=new QT(()=>this.refreshRanges(a.lineRanges)),this._attachedViewStates.set(r,a)),a.handleStateChange(s)}else this._attachedViewStates.deleteAndDispose(r)}))}resetTokenization(e=!0){this._tokens.flush(),this._debugBackgroundTokens?.flush(),this._debugBackgroundStates&&(this._debugBackgroundStates=new Lm(this._textModel.getLineCount())),e&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]});let t=()=>{if(this._textModel.isTooLargeForTokenization())return[null,null];let r=cr.get(this.getLanguageId());if(!r)return[null,null];let s;try{s=r.getInitialState()}catch(a){return qe(a),[null,null]}return[r,s]},[n,i]=t();if(n&&i?this._tokenizer=new YT(this._textModel.getLineCount(),n,this._textModel,this._languageIdCodec):this._tokenizer=null,this._backgroundTokenizer.clear(),this._defaultBackgroundTokenizer=null,this._tokenizer){let r={setTokens:s=>{this.setTokens(s)},backgroundTokenizationFinished:()=>{if(this._backgroundTokenizationState===2)return;let s=2;this._backgroundTokenizationState=s,this._onDidChangeBackgroundTokenizationState.fire()},setEndState:(s,a)=>{if(!this._tokenizer)return;let l=this._tokenizer.store.getFirstInvalidEndStateLineNumber();l!==null&&s>=l&&this._tokenizer?.store.setEndState(s,a)}};n&&n.createBackgroundTokenizer&&!n.backgroundTokenizerShouldOnlyVerifyTokens&&(this._backgroundTokenizer.value=n.createBackgroundTokenizer(this._textModel,r)),!this._backgroundTokenizer.value&&!this._textModel.isTooLargeForTokenization()&&(this._backgroundTokenizer.value=this._defaultBackgroundTokenizer=new ZT(this._tokenizer,r),this._defaultBackgroundTokenizer.handleChanges()),n?.backgroundTokenizerShouldOnlyVerifyTokens&&n.createBackgroundTokenizer?(this._debugBackgroundTokens=new bv(this._languageIdCodec),this._debugBackgroundStates=new Lm(this._textModel.getLineCount()),this._debugBackgroundTokenizer.clear(),this._debugBackgroundTokenizer.value=n.createBackgroundTokenizer(this._textModel,{setTokens:s=>{this._debugBackgroundTokens?.setMultilineTokens(s,this._textModel)},backgroundTokenizationFinished(){},setEndState:(s,a)=>{this._debugBackgroundStates?.setEndState(s,a)}})):(this._debugBackgroundTokens=void 0,this._debugBackgroundStates=void 0,this._debugBackgroundTokenizer.value=void 0)}this.refreshAllVisibleLineTokens()}handleDidChangeAttached(){this._defaultBackgroundTokenizer?.handleChanges()}handleDidChangeContent(e){if(e.isFlush)this.resetTokenization(!1);else if(!e.isEolChange){for(let t of e.changes){let[n,i]=Bo(t.text);this._tokens.acceptEdit(t.range,n,i),this._debugBackgroundTokens?.acceptEdit(t.range,n,i)}this._debugBackgroundStates?.acceptChanges(e.changes),this._tokenizer&&this._tokenizer.store.acceptChanges(e.changes),this._defaultBackgroundTokenizer?.handleChanges()}}setTokens(e){let{changes:t}=this._tokens.setMultilineTokens(e,this._textModel);return t.length>0&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:t}),{changes:t}}refreshAllVisibleLineTokens(){let e=Re.joinMany([...this._attachedViewStates].map(([t,n])=>n.lineRanges));this.refreshRanges(e)}refreshRanges(e){for(let t of e)this.refreshRange(t.startLineNumber,t.endLineNumberExclusive-1)}refreshRange(e,t){if(!this._tokenizer)return;e=Math.max(1,Math.min(this._textModel.getLineCount(),e)),t=Math.min(this._textModel.getLineCount(),t);let n=new qu,{heuristicTokens:i}=this._tokenizer.tokenizeHeuristically(n,e,t),r=this.setTokens(n.finalize());if(i)for(let s of r.changes)this._backgroundTokenizer.value?.requestTokens(s.fromLineNumber,s.toLineNumber+1);this._defaultBackgroundTokenizer?.checkFinished()}forceTokenization(e){let t=new qu;this._tokenizer?.updateTokensUntilLine(t,e),this.setTokens(t.finalize()),this._defaultBackgroundTokenizer?.checkFinished()}hasAccurateTokensForLine(e){return this._tokenizer?this._tokenizer.hasAccurateTokensForLine(e):!0}isCheapToTokenize(e){return this._tokenizer?this._tokenizer.isCheapToTokenize(e):!0}getLineTokens(e){let t=this._textModel.getLineContent(e),n=this._tokens.getTokens(this._textModel.getLanguageId(),e-1,t);if(this._debugBackgroundTokens&&this._debugBackgroundStates&&this._tokenizer&&this._debugBackgroundStates.getFirstInvalidEndStateLineNumberOrMax()>e&&this._tokenizer.store.getFirstInvalidEndStateLineNumberOrMax()>e){let i=this._debugBackgroundTokens.getTokens(this._textModel.getLanguageId(),e-1,t);!n.equals(i)&&this._debugBackgroundTokenizer.value?.reportMismatchingTokens&&this._debugBackgroundTokenizer.value.reportMismatchingTokens(e)}return n}getTokenTypeIfInsertingCharacter(e,t,n){if(!this._tokenizer)return 0;let i=this._textModel.validatePosition(new A(e,t));return this.forceTokenization(i.lineNumber),this._tokenizer.getTokenTypeIfInsertingCharacter(i,n)}tokenizeLineWithEdit(e,t){return this._tokenizer?(this.forceTokenization(e),this._tokenizer.tokenizeLineWithEdit(e,t)):{mainLineTokens:null,additionalLines:null}}get hasTokens(){return this._tokens.hasTokens}};function sP(o){let e=new _m;return e.acceptChunk(o),e.finish()}function OU(o){return new Promise((e,t)=>{let n=new _m,i=!1;IL(o,{onData:r=>{n.acceptChunk(typeof r=="string"?r:r.toString())},onError:r=>{i||(i=!0,t(r))},onEnd:()=>{i||(i=!0,e(n.finish()))}})})}function sG(o){let e=new _m,t;for(;typeof(t=o.read())=="string";)e.acceptChunk(t);return e.finish()}function kU(o,e){let t;return typeof o=="string"?t=sP(o):wB(o)?t=sG(o):t=o,t.create(e)}var tx=0,aG=999,lG=1e4,eP=class{_source;_eos;constructor(e){this._source=e,this._eos=!1}read(){if(this._eos)return null;let e=[],t=0,n=0;do{let i=this._source.read();if(i===null)return this._eos=!0,t===0?null:e.join("");if(i.length>0&&(e[t++]=i,n+=i.length),n>=64*1024)return e.join("")}while(!0)}},vv=()=>{throw new Error("Invalid change accessor")};var Ka=class extends F{constructor(t,n,i,r=null,s,a,l,d){super();this._undoRedoService=s;this._languageService=a;this._languageConfigurationService=l;this.instantiationService=d;tx++,this.id="$model"+tx,this.isForSimpleWidget=i.isForSimpleWidget,typeof r>"u"||r===null?this._associatedResource=J.parse("inmemory://model/"+tx):this._associatedResource=r,this._attachedEditorCount=0;let{textBuffer:c,disposable:u}=kU(t,i.defaultEOL);this._buffer=c,this._bufferDisposable=u,this._options=Ka.resolveOptions(this._buffer,i);let p=typeof n=="string"?n:n.languageId;typeof n!="string"&&(this._languageSelectionListener.value=n.onDidChange(()=>this._setLanguage(n.languageId))),this._bracketPairs=this._register(new _T(this,this._languageConfigurationService)),this._guidesTextModelPart=this._register(new UT(this,this._languageConfigurationService)),this._decorationProvider=this._register(new BT(this)),this._tokenizationTextModelPart=this.instantiationService.createInstance(zl,this,this._bracketPairs,p,this._attachedViews);let h=this._buffer.getLineCount(),f=this._buffer.getValueLengthInRange(new P(1,1,h,this._buffer.getLineLength(h)+1),0);i.largeFileOptimizations?(this._isTooLargeForTokenization=f>Ka.LARGE_FILE_SIZE_THRESHOLD||h>Ka.LARGE_FILE_LINE_COUNT_THRESHOLD,this._isTooLargeForHeapOperation=f>Ka.LARGE_FILE_HEAP_OPERATION_THRESHOLD):(this._isTooLargeForTokenization=!1,this._isTooLargeForHeapOperation=!1),this._isTooLargeForSyncing=f>Ka._MODEL_SYNC_LIMIT,this._versionId=1,this._alternativeVersionId=1,this._initialUndoRedoSnapshot=null,this._isDisposed=!1,this.__isDisposing=!1,this._instanceId=uI(tx),this._lastDecorationId=0,this._decorations=Object.create(null),this._decorationsTree=new ix,this._commandManager=new HT(this,this._undoRedoService),this._isUndoing=!1,this._isRedoing=!1,this._trimAutoWhitespaceLines=null,this._register(this._decorationProvider.onDidChange(()=>{this._onDidChangeDecorations.beginDeferredEmit(),this._onDidChangeDecorations.fire(),this._onDidChangeDecorations.endDeferredEmit()})),this._languageService.requestRichLanguageFeatures(p),this._register(this._languageConfigurationService.onDidChange(g=>{this._bracketPairs.handleLanguageConfigurationServiceChange(g),this._tokenizationTextModelPart.handleLanguageConfigurationServiceChange(g)}))}static _MODEL_SYNC_LIMIT=50*1024*1024;static LARGE_FILE_SIZE_THRESHOLD=20*1024*1024;static LARGE_FILE_LINE_COUNT_THRESHOLD=300*1e3;static LARGE_FILE_HEAP_OPERATION_THRESHOLD=256*1024*1024;static DEFAULT_CREATION_OPTIONS={isForSimpleWidget:!1,tabSize:Sa.tabSize,indentSize:Sa.indentSize,insertSpaces:Sa.insertSpaces,detectIndentation:!1,defaultEOL:1,trimAutoWhitespace:Sa.trimAutoWhitespace,largeFileOptimizations:Sa.largeFileOptimizations,bracketPairColorizationOptions:Sa.bracketPairColorizationOptions};static resolveOptions(t,n){if(n.detectIndentation){let i=AM(t,n.tabSize,n.insertSpaces);return new bh({tabSize:i.tabSize,indentSize:"tabSize",insertSpaces:i.insertSpaces,trimAutoWhitespace:n.trimAutoWhitespace,defaultEOL:n.defaultEOL,bracketPairColorizationOptions:n.bracketPairColorizationOptions})}return new bh(n)}_onWillDispose=this._register(new D);onWillDispose=this._onWillDispose.event;_onDidChangeDecorations=this._register(new oP(t=>this.handleBeforeFireDecorationsChangedEvent(t)));onDidChangeDecorations=this._onDidChangeDecorations.event;get onDidChangeLanguage(){return this._tokenizationTextModelPart.onDidChangeLanguage}get onDidChangeLanguageConfiguration(){return this._tokenizationTextModelPart.onDidChangeLanguageConfiguration}get onDidChangeTokens(){return this._tokenizationTextModelPart.onDidChangeTokens}_onDidChangeOptions=this._register(new D);onDidChangeOptions=this._onDidChangeOptions.event;_onDidChangeAttached=this._register(new D);onDidChangeAttached=this._onDidChangeAttached.event;_onDidChangeInjectedText=this._register(new D);_eventEmitter=this._register(new rP);onDidChangeContent(t){return this._eventEmitter.slowEvent(n=>t(n.contentChangedEvent))}onDidChangeContentOrInjectedText(t){return Ro(this._eventEmitter.fastEvent(n=>t(n)),this._onDidChangeInjectedText.event(n=>t(n)))}id;isForSimpleWidget;_associatedResource;_attachedEditorCount;_buffer;_bufferDisposable;_options;_languageSelectionListener=this._register(new un);_isDisposed;__isDisposing;_isDisposing(){return this.__isDisposing}_versionId;_alternativeVersionId;_initialUndoRedoSnapshot;_isTooLargeForSyncing;_isTooLargeForTokenization;_isTooLargeForHeapOperation;_commandManager;_isUndoing;_isRedoing;_trimAutoWhitespaceLines;_instanceId;_deltaDecorationCallCnt=0;_lastDecorationId;_decorations;_decorationsTree;_decorationProvider;_tokenizationTextModelPart;get tokenization(){return this._tokenizationTextModelPart}_bracketPairs;get bracketPairs(){return this._bracketPairs}_guidesTextModelPart;get guides(){return this._guidesTextModelPart}_attachedViews=new XT;dispose(){this.__isDisposing=!0,this._onWillDispose.fire(),this._tokenizationTextModelPart.dispose(),this._isDisposed=!0,super.dispose(),this._bufferDisposable.dispose(),this.__isDisposing=!1;let t=new wm([],"",`
`,!1,!1,!0,!0);t.dispose(),this._buffer=t,this._bufferDisposable=F.None}_hasListeners(){return this._onWillDispose.hasListeners()||this._onDidChangeDecorations.hasListeners()||this._tokenizationTextModelPart._hasListeners()||this._onDidChangeOptions.hasListeners()||this._onDidChangeAttached.hasListeners()||this._onDidChangeInjectedText.hasListeners()||this._eventEmitter.hasListeners()}_assertNotDisposed(){if(this._isDisposed)throw new Ye("Model is disposed!")}equalsTextBuffer(t){return this._assertNotDisposed(),this._buffer.equals(t)}getTextBuffer(){return this._assertNotDisposed(),this._buffer}_emitContentChangedEvent(t,n){this.__isDisposing||(this._tokenizationTextModelPart.handleDidChangeContent(n),this._bracketPairs.handleDidChangeContent(n),this._eventEmitter.fire(new Vd(t,n)))}setValue(t){if(this._assertNotDisposed(),t==null)throw Wc();let{textBuffer:n,disposable:i}=kU(t,this._options.defaultEOL);this._setValueFromTextBuffer(n,i)}_createContentChanged2(t,n,i,r,s,a,l,d){return{changes:[{range:t,rangeOffset:n,rangeLength:i,text:r}],eol:this._buffer.getEOL(),isEolChange:d,versionId:this.getVersionId(),isUndoing:s,isRedoing:a,isFlush:l}}_setValueFromTextBuffer(t,n){this._assertNotDisposed();let i=this.getFullModelRange(),r=this.getValueLengthInRange(i),s=this.getLineCount(),a=this.getLineMaxColumn(s);this._buffer=t,this._bufferDisposable.dispose(),this._bufferDisposable=n,this._increaseVersionId(),this._decorations=Object.create(null),this._decorationsTree=new ix,this._commandManager.clear(),this._trimAutoWhitespaceLines=null,this._emitContentChangedEvent(new gu([new RC],this._versionId,!1,!1),this._createContentChanged2(new P(1,1,s,a),0,r,this.getValue(),!1,!1,!0,!1))}setEOL(t){this._assertNotDisposed();let n=t===1?`\r
`:`
`;if(this._buffer.getEOL()===n)return;let i=this.getFullModelRange(),r=this.getValueLengthInRange(i),s=this.getLineCount(),a=this.getLineMaxColumn(s);this._onBeforeEOLChange(),this._buffer.setEOL(n),this._increaseVersionId(),this._onAfterEOLChange(),this._emitContentChangedEvent(new gu([new PC],this._versionId,!1,!1),this._createContentChanged2(new P(1,1,s,a),0,r,this.getValue(),!1,!1,!1,!0))}_onBeforeEOLChange(){this._decorationsTree.ensureAllNodesHaveRanges(this)}_onAfterEOLChange(){let t=this.getVersionId(),n=this._decorationsTree.collectNodesPostOrder();for(let i=0,r=n.length;i<r;i++){let s=n[i],a=s.range,l=s.cachedAbsoluteStart-s.start,d=this._buffer.getOffsetAt(a.startLineNumber,a.startColumn),c=this._buffer.getOffsetAt(a.endLineNumber,a.endColumn);s.cachedAbsoluteStart=d,s.cachedAbsoluteEnd=c,s.cachedVersionId=t,s.start=d-l,s.end=c-l,Vl(s)}}onBeforeAttached(){return this._attachedEditorCount++,this._attachedEditorCount===1&&(this._tokenizationTextModelPart.handleDidChangeAttached(),this._onDidChangeAttached.fire(void 0)),this._attachedViews.attachView()}onBeforeDetached(t){this._attachedEditorCount--,this._attachedEditorCount===0&&(this._tokenizationTextModelPart.handleDidChangeAttached(),this._onDidChangeAttached.fire(void 0)),this._attachedViews.detachView(t)}isAttachedToEditor(){return this._attachedEditorCount>0}getAttachedEditorCount(){return this._attachedEditorCount}isTooLargeForSyncing(){return this._isTooLargeForSyncing}isTooLargeForTokenization(){return this._isTooLargeForTokenization}isTooLargeForHeapOperation(){return this._isTooLargeForHeapOperation}isDisposed(){return this._isDisposed}isDominatedByLongLines(){if(this._assertNotDisposed(),this.isTooLargeForTokenization())return!1;let t=0,n=0,i=this._buffer.getLineCount();for(let r=1;r<=i;r++){let s=this._buffer.getLineLength(r);s>=lG?n+=s:t+=s}return n>t}get uri(){return this._associatedResource}getOptions(){return this._assertNotDisposed(),this._options}getFormattingOptions(){return{tabSize:this._options.indentSize,insertSpaces:this._options.insertSpaces}}updateOptions(t){this._assertNotDisposed();let n=typeof t.tabSize<"u"?t.tabSize:this._options.tabSize,i=typeof t.indentSize<"u"?t.indentSize:this._options.originalIndentSize,r=typeof t.insertSpaces<"u"?t.insertSpaces:this._options.insertSpaces,s=typeof t.trimAutoWhitespace<"u"?t.trimAutoWhitespace:this._options.trimAutoWhitespace,a=typeof t.bracketColorizationOptions<"u"?t.bracketColorizationOptions:this._options.bracketPairColorizationOptions,l=new bh({tabSize:n,indentSize:i,insertSpaces:r,defaultEOL:this._options.defaultEOL,trimAutoWhitespace:s,bracketPairColorizationOptions:a});if(this._options.equals(l))return;let d=this._options.createChangeEvent(l);this._options=l,this._bracketPairs.handleDidChangeOptions(d),this._decorationProvider.handleDidChangeOptions(d),this._onDidChangeOptions.fire(d)}detectIndentation(t,n){this._assertNotDisposed();let i=AM(this._buffer,n,t);this.updateOptions({insertSpaces:i.insertSpaces,tabSize:i.tabSize,indentSize:i.tabSize})}normalizeIndentation(t){return this._assertNotDisposed(),RS(t,this._options.indentSize,this._options.insertSpaces)}getVersionId(){return this._assertNotDisposed(),this._versionId}mightContainRTL(){return this._buffer.mightContainRTL()}mightContainUnusualLineTerminators(){return this._buffer.mightContainUnusualLineTerminators()}removeUnusualLineTerminators(t=null){let n=this.findMatches(uL.source,!1,!0,!1,null,!1,1073741824);this._buffer.resetMightContainUnusualLineTerminators(),this.pushEditOperations(t,n.map(i=>({range:i.range,text:null})),()=>null)}mightContainNonBasicASCII(){return this._buffer.mightContainNonBasicASCII()}getAlternativeVersionId(){return this._assertNotDisposed(),this._alternativeVersionId}getInitialUndoRedoSnapshot(){return this._assertNotDisposed(),this._initialUndoRedoSnapshot}getOffsetAt(t){this._assertNotDisposed();let n=this._validatePosition(t.lineNumber,t.column,0);return this._buffer.getOffsetAt(n.lineNumber,n.column)}getPositionAt(t){this._assertNotDisposed();let n=Math.min(this._buffer.getLength(),Math.max(0,t));return this._buffer.getPositionAt(n)}_increaseVersionId(){this._versionId=this._versionId+1,this._alternativeVersionId=this._versionId}_overwriteVersionId(t){this._versionId=t}_overwriteAlternativeVersionId(t){this._alternativeVersionId=t}_overwriteInitialUndoRedoSnapshot(t){this._initialUndoRedoSnapshot=t}getValue(t,n=!1){if(this._assertNotDisposed(),this.isTooLargeForHeapOperation())throw new Ye("Operation would exceed heap memory limits");let i=this.getFullModelRange(),r=this.getValueInRange(i,t);return n?this._buffer.getBOM()+r:r}createSnapshot(t=!1){return new eP(this._buffer.createSnapshot(t))}getValueLength(t,n=!1){this._assertNotDisposed();let i=this.getFullModelRange(),r=this.getValueLengthInRange(i,t);return n?this._buffer.getBOM().length+r:r}getValueInRange(t,n=0){return this._assertNotDisposed(),this._buffer.getValueInRange(this.validateRange(t),n)}getValueLengthInRange(t,n=0){return this._assertNotDisposed(),this._buffer.getValueLengthInRange(this.validateRange(t),n)}getCharacterCountInRange(t,n=0){return this._assertNotDisposed(),this._buffer.getCharacterCountInRange(this.validateRange(t),n)}getLineCount(){return this._assertNotDisposed(),this._buffer.getLineCount()}getLineContent(t){if(this._assertNotDisposed(),t<1||t>this.getLineCount())throw new Ye("Illegal value for lineNumber");return this._buffer.getLineContent(t)}getLineLength(t){if(this._assertNotDisposed(),t<1||t>this.getLineCount())throw new Ye("Illegal value for lineNumber");return this._buffer.getLineLength(t)}getLinesContent(){if(this._assertNotDisposed(),this.isTooLargeForHeapOperation())throw new Ye("Operation would exceed heap memory limits");return this._buffer.getLinesContent()}getEOL(){return this._assertNotDisposed(),this._buffer.getEOL()}getEndOfLineSequence(){return this._assertNotDisposed(),this._buffer.getEOL()===`
`?0:1}getLineMinColumn(t){return this._assertNotDisposed(),1}getLineMaxColumn(t){if(this._assertNotDisposed(),t<1||t>this.getLineCount())throw new Ye("Illegal value for lineNumber");return this._buffer.getLineLength(t)+1}getLineFirstNonWhitespaceColumn(t){if(this._assertNotDisposed(),t<1||t>this.getLineCount())throw new Ye("Illegal value for lineNumber");return this._buffer.getLineFirstNonWhitespaceColumn(t)}getLineLastNonWhitespaceColumn(t){if(this._assertNotDisposed(),t<1||t>this.getLineCount())throw new Ye("Illegal value for lineNumber");return this._buffer.getLineLastNonWhitespaceColumn(t)}_validateRangeRelaxedNoAllocations(t){let n=this._buffer.getLineCount(),i=t.startLineNumber,r=t.startColumn,s=Math.floor(typeof i=="number"&&!isNaN(i)?i:1),a=Math.floor(typeof r=="number"&&!isNaN(r)?r:1);if(s<1)s=1,a=1;else if(s>n)s=n,a=this.getLineMaxColumn(s);else if(a<=1)a=1;else{let p=this.getLineMaxColumn(s);a>=p&&(a=p)}let l=t.endLineNumber,d=t.endColumn,c=Math.floor(typeof l=="number"&&!isNaN(l)?l:1),u=Math.floor(typeof d=="number"&&!isNaN(d)?d:1);if(c<1)c=1,u=1;else if(c>n)c=n,u=this.getLineMaxColumn(c);else if(u<=1)u=1;else{let p=this.getLineMaxColumn(c);u>=p&&(u=p)}return i===s&&r===a&&l===c&&d===u&&t instanceof P&&!(t instanceof $e)?t:new P(s,a,c,u)}_isValidPosition(t,n,i){if(typeof t!="number"||typeof n!="number"||isNaN(t)||isNaN(n)||t<1||n<1||(t|0)!==t||(n|0)!==n)return!1;let r=this._buffer.getLineCount();if(t>r)return!1;if(n===1)return!0;let s=this.getLineMaxColumn(t);if(n>s)return!1;if(i===1){let a=this._buffer.getLineCharCode(t,n-2);if(ln(a))return!1}return!0}_validatePosition(t,n,i){let r=Math.floor(typeof t=="number"&&!isNaN(t)?t:1),s=Math.floor(typeof n=="number"&&!isNaN(n)?n:1),a=this._buffer.getLineCount();if(r<1)return new A(1,1);if(r>a)return new A(a,this.getLineMaxColumn(a));if(s<=1)return new A(r,1);let l=this.getLineMaxColumn(r);if(s>=l)return new A(r,l);if(i===1){let d=this._buffer.getLineCharCode(r,s-2);if(ln(d))return new A(r,s-1)}return new A(r,s)}validatePosition(t){let n=1;return this._assertNotDisposed(),t instanceof A&&this._isValidPosition(t.lineNumber,t.column,n)?t:this._validatePosition(t.lineNumber,t.column,n)}_isValidRange(t,n){let i=t.startLineNumber,r=t.startColumn,s=t.endLineNumber,a=t.endColumn;if(!this._isValidPosition(i,r,0)||!this._isValidPosition(s,a,0))return!1;if(n===1){let l=r>1?this._buffer.getLineCharCode(i,r-2):0,d=a>1&&a<=this._buffer.getLineLength(s)?this._buffer.getLineCharCode(s,a-2):0,c=ln(l),u=ln(d);return!c&&!u}return!0}validateRange(t){let n=1;if(this._assertNotDisposed(),t instanceof P&&!(t instanceof $e)&&this._isValidRange(t,n))return t;let i=this._validatePosition(t.startLineNumber,t.startColumn,0),r=this._validatePosition(t.endLineNumber,t.endColumn,0),s=i.lineNumber,a=i.column,l=r.lineNumber,d=r.column;if(n===1){let c=a>1?this._buffer.getLineCharCode(s,a-2):0,u=d>1&&d<=this._buffer.getLineLength(l)?this._buffer.getLineCharCode(l,d-2):0,p=ln(c),h=ln(u);return!p&&!h?new P(s,a,l,d):s===l&&a===d?new P(s,a-1,l,d-1):p&&h?new P(s,a-1,l,d+1):p?new P(s,a-1,l,d):new P(s,a,l,d+1)}return new P(s,a,l,d)}modifyPosition(t,n){this._assertNotDisposed();let i=this.getOffsetAt(t)+n;return this.getPositionAt(Math.min(this._buffer.getLength(),Math.max(0,i)))}getFullModelRange(){this._assertNotDisposed();let t=this.getLineCount();return new P(1,1,t,this.getLineMaxColumn(t))}findMatchesLineByLine(t,n,i,r){return this._buffer.findMatchesLineByLine(t,n,i,r)}findMatches(t,n,i,r,s,a,l=aG){this._assertNotDisposed();let d=null;n!==null&&(Array.isArray(n)||(n=[n]),n.every(p=>P.isIRange(p))&&(d=n.map(p=>this.validateRange(p)))),d===null&&(d=[this.getFullModelRange()]),d=d.sort((p,h)=>p.startLineNumber-h.startLineNumber||p.startColumn-h.startColumn);let c=[];c.push(d.reduce((p,h)=>P.areIntersecting(p,h)?p.plusRange(h):(c.push(p),h)));let u;if(!i&&t.indexOf(`
`)<0){let h=new Hl(t,i,r,s).parseSearchRequest();if(!h)return[];u=f=>this.findMatchesLineByLine(f,h,a,l)}else u=p=>Gu.findMatches(this,new Hl(t,i,r,s),p,a,l);return c.map(u).reduce((p,h)=>p.concat(h),[])}findNextMatch(t,n,i,r,s,a){this._assertNotDisposed();let l=this.validatePosition(n);if(!i&&t.indexOf(`
`)<0){let c=new Hl(t,i,r,s).parseSearchRequest();if(!c)return null;let u=this.getLineCount(),p=new P(l.lineNumber,l.column,u,this.getLineMaxColumn(u)),h=this.findMatchesLineByLine(p,c,a,1);return Gu.findNextMatch(this,new Hl(t,i,r,s),l,a),h.length>0||(p=new P(1,1,l.lineNumber,this.getLineMaxColumn(l.lineNumber)),h=this.findMatchesLineByLine(p,c,a,1),h.length>0)?h[0]:null}return Gu.findNextMatch(this,new Hl(t,i,r,s),l,a)}findPreviousMatch(t,n,i,r,s,a){this._assertNotDisposed();let l=this.validatePosition(n);return Gu.findPreviousMatch(this,new Hl(t,i,r,s),l,a)}pushStackElement(){this._commandManager.pushStackElement()}popStackElement(){this._commandManager.popStackElement()}pushEOL(t){if((this.getEOL()===`
`?0:1)!==t)try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._initialUndoRedoSnapshot===null&&(this._initialUndoRedoSnapshot=this._undoRedoService.createSnapshot(this.uri)),this._commandManager.pushEOL(t)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_validateEditOperation(t){return t instanceof vh?t:new vh(t.identifier||null,this.validateRange(t.range),t.text,t.forceMoveMarkers||!1,t.isAutoWhitespaceEdit||!1,t._isTracked||!1)}_validateEditOperations(t){let n=[];for(let i=0,r=t.length;i<r;i++)n[i]=this._validateEditOperation(t[i]);return n}pushEditOperations(t,n,i,r){try{return this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._pushEditOperations(t,this._validateEditOperations(n),i,r)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_pushEditOperations(t,n,i,r){if(this._options.trimAutoWhitespace&&this._trimAutoWhitespaceLines){let s=n.map(l=>({range:this.validateRange(l.range),text:l.text})),a=!0;if(t)for(let l=0,d=t.length;l<d;l++){let c=t[l],u=!1;for(let p=0,h=s.length;p<h;p++){let f=s[p].range,g=f.startLineNumber>c.endLineNumber,b=c.startLineNumber>f.endLineNumber;if(!g&&!b){u=!0;break}}if(!u){a=!1;break}}if(a)for(let l=0,d=this._trimAutoWhitespaceLines.length;l<d;l++){let c=this._trimAutoWhitespaceLines[l],u=this.getLineMaxColumn(c),p=!0;for(let h=0,f=s.length;h<f;h++){let g=s[h].range,b=s[h].text;if(!(c<g.startLineNumber||c>g.endLineNumber)&&!(c===g.startLineNumber&&g.startColumn===u&&g.isEmpty()&&b&&b.length>0&&b.charAt(0)===`
`)&&!(c===g.startLineNumber&&g.startColumn===1&&g.isEmpty()&&b&&b.length>0&&b.charAt(b.length-1)===`
`)){p=!1;break}}if(p){let h=new P(c,1,c,u);n.push(new vh(null,h,null,!1,!1,!1))}}this._trimAutoWhitespaceLines=null}return this._initialUndoRedoSnapshot===null&&(this._initialUndoRedoSnapshot=this._undoRedoService.createSnapshot(this.uri)),this._commandManager.pushEditOperation(t,n,i,r)}_applyUndo(t,n,i,r){let s=t.map(a=>{let l=this.getPositionAt(a.newPosition),d=this.getPositionAt(a.newEnd);return{range:new P(l.lineNumber,l.column,d.lineNumber,d.column),text:a.oldText}});this._applyUndoRedoEdits(s,n,!0,!1,i,r)}_applyRedo(t,n,i,r){let s=t.map(a=>{let l=this.getPositionAt(a.oldPosition),d=this.getPositionAt(a.oldEnd);return{range:new P(l.lineNumber,l.column,d.lineNumber,d.column),text:a.newText}});this._applyUndoRedoEdits(s,n,!1,!0,i,r)}_applyUndoRedoEdits(t,n,i,r,s,a){try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._isUndoing=i,this._isRedoing=r,this.applyEdits(t,!1),this.setEOL(n),this._overwriteAlternativeVersionId(s)}finally{this._isUndoing=!1,this._isRedoing=!1,this._eventEmitter.endDeferredEmit(a),this._onDidChangeDecorations.endDeferredEmit()}}applyEdits(t,n=!1){try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit();let i=this._validateEditOperations(t);return this._doApplyEdits(i,n)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_doApplyEdits(t,n){let i=this._buffer.getLineCount(),r=this._buffer.applyEdits(t,this._options.trimAutoWhitespace,n),s=this._buffer.getLineCount(),a=r.changes;if(this._trimAutoWhitespaceLines=r.trimAutoWhitespaceLineNumbers,a.length!==0){for(let c=0,u=a.length;c<u;c++){let p=a[c];this._decorationsTree.acceptReplace(p.rangeOffset,p.rangeLength,p.text.length,p.forceMoveMarkers)}let l=[];this._increaseVersionId();let d=i;for(let c=0,u=a.length;c<u;c++){let p=a[c],[h]=Bo(p.text);this._onDidChangeDecorations.fire();let f=p.range.startLineNumber,g=p.range.endLineNumber,b=g-f,v=h,y=Math.min(b,v),S=v-b,E=s-d-S+f,C=E,w=E+v,_=this._decorationsTree.getInjectedTextInInterval(this,this.getOffsetAt(new A(C,1)),this.getOffsetAt(new A(w,this.getLineMaxColumn(w))),0),L=Fo.fromDecorations(_),k=new Wi(L);for(let W=y;W>=0;W--){let K=f+W,U=E+W;k.takeFromEndWhile(Se=>Se.lineNumber>U);let oe=k.takeFromEndWhile(Se=>Se.lineNumber===U);l.push(new nb(K,this.getLineContent(U),oe))}if(y<b){let W=f+y;l.push(new kC(W+1,g))}if(y<v){let W=new Wi(L),K=f+y,U=v-y,oe=s-d-U+K+1,Se=[],ne=[];for(let Q=0;Q<U;Q++){let de=oe+Q;ne[Q]=this.getLineContent(de),W.takeWhile(se=>se.lineNumber<de),Se[Q]=W.takeWhile(se=>se.lineNumber===de)}l.push(new MC(K+1,f+v,ne,Se))}d+=S}this._emitContentChangedEvent(new gu(l,this.getVersionId(),this._isUndoing,this._isRedoing),{changes:a,eol:this._buffer.getEOL(),isEolChange:!1,versionId:this.getVersionId(),isUndoing:this._isUndoing,isRedoing:this._isRedoing,isFlush:!1})}return r.reverseEdits===null?void 0:r.reverseEdits}undo(){return this._undoRedoService.undo(this.uri)}canUndo(){return this._undoRedoService.canUndo(this.uri)}redo(){return this._undoRedoService.redo(this.uri)}canRedo(){return this._undoRedoService.canRedo(this.uri)}handleBeforeFireDecorationsChangedEvent(t){if(t===null||t.size===0)return;let i=Array.from(t).map(r=>new nb(r,this.getLineContent(r),this._getInjectedTextInLine(r)));this._onDidChangeInjectedText.fire(new fh(i))}changeDecorations(t,n=0){this._assertNotDisposed();try{return this._onDidChangeDecorations.beginDeferredEmit(),this._changeDecorations(n,t)}finally{this._onDidChangeDecorations.endDeferredEmit()}}_changeDecorations(t,n){let i={addDecoration:(s,a)=>this._deltaDecorationsImpl(t,[],[{range:s,options:a}])[0],changeDecoration:(s,a)=>{this._changeDecorationImpl(s,a)},changeDecorationOptions:(s,a)=>{this._changeDecorationOptionsImpl(s,PU(a))},removeDecoration:s=>{this._deltaDecorationsImpl(t,[s],[])},deltaDecorations:(s,a)=>s.length===0&&a.length===0?[]:this._deltaDecorationsImpl(t,s,a)},r=null;try{r=n(i)}catch(s){qe(s)}return i.addDecoration=vv,i.changeDecoration=vv,i.changeDecorationOptions=vv,i.removeDecoration=vv,i.deltaDecorations=vv,r}deltaDecorations(t,n,i=0){if(this._assertNotDisposed(),t||(t=[]),t.length===0&&n.length===0)return[];try{return this._deltaDecorationCallCnt++,this._deltaDecorationCallCnt>1&&(console.warn("Invoking deltaDecorations recursively could lead to leaking decorations."),qe(new Error("Invoking deltaDecorations recursively could lead to leaking decorations."))),this._onDidChangeDecorations.beginDeferredEmit(),this._deltaDecorationsImpl(i,t,n)}finally{this._onDidChangeDecorations.endDeferredEmit(),this._deltaDecorationCallCnt--}}_getTrackedRange(t){return this.getDecorationRange(t)}_setTrackedRange(t,n,i){let r=t?this._decorations[t]:null;if(!r)return n?this._deltaDecorationsImpl(0,[],[{range:n,options:MU[i]}],!0)[0]:null;if(!n)return this._decorationsTree.delete(r),delete this._decorations[r.id],null;let s=this._validateRangeRelaxedNoAllocations(n),a=this._buffer.getOffsetAt(s.startLineNumber,s.startColumn),l=this._buffer.getOffsetAt(s.endLineNumber,s.endColumn);return this._decorationsTree.delete(r),r.reset(this.getVersionId(),a,l,s),r.setOptions(MU[i]),this._decorationsTree.insert(r),r.id}removeAllDecorationsWithOwnerId(t){if(this._isDisposed)return;let n=this._decorationsTree.collectNodesFromOwner(t);for(let i=0,r=n.length;i<r;i++){let s=n[i];this._decorationsTree.delete(s),delete this._decorations[s.id]}}getDecorationOptions(t){let n=this._decorations[t];return n?n.options:null}getDecorationRange(t){let n=this._decorations[t];return n?this._decorationsTree.getNodeRange(this,n):null}getLineDecorations(t,n=0,i=!1){return t<1||t>this.getLineCount()?[]:this.getLinesDecorations(t,t,n,i)}getLinesDecorations(t,n,i=0,r=!1,s=!1){let a=this.getLineCount(),l=Math.min(a,Math.max(1,t)),d=Math.min(a,Math.max(1,n)),c=this.getLineMaxColumn(d),u=new P(l,1,d,c),p=this._getDecorationsInRange(u,i,r,s);return jg(p,this._decorationProvider.getDecorationsInRange(u,i,r)),p}getDecorationsInRange(t,n=0,i=!1,r=!1,s=!1){let a=this.validateRange(t),l=this._getDecorationsInRange(a,n,i,s);return jg(l,this._decorationProvider.getDecorationsInRange(a,n,i,r)),l}getOverviewRulerDecorations(t=0,n=!1){return this._decorationsTree.getAll(this,t,n,!0,!1)}getInjectedTextDecorations(t=0){return this._decorationsTree.getAllInjectedText(this,t)}_getInjectedTextInLine(t){let n=this._buffer.getOffsetAt(t,1),i=n+this._buffer.getLineLength(t),r=this._decorationsTree.getInjectedTextInInterval(this,n,i,0);return Fo.fromDecorations(r).filter(s=>s.lineNumber===t)}getAllDecorations(t=0,n=!1){let i=this._decorationsTree.getAll(this,t,n,!1,!1);return i=i.concat(this._decorationProvider.getAllDecorations(t,n)),i}getAllMarginDecorations(t=0){return this._decorationsTree.getAll(this,t,!1,!1,!0)}_getDecorationsInRange(t,n,i,r){let s=this._buffer.getOffsetAt(t.startLineNumber,t.startColumn),a=this._buffer.getOffsetAt(t.endLineNumber,t.endColumn);return this._decorationsTree.getAllInInterval(this,s,a,n,i,r)}getRangeAt(t,n){return this._buffer.getRangeAt(t,n-t)}_changeDecorationImpl(t,n){let i=this._decorations[t];if(!i)return;if(i.options.after){let l=this.getDecorationRange(t);this._onDidChangeDecorations.recordLineAffectedByInjectedText(l.endLineNumber)}if(i.options.before){let l=this.getDecorationRange(t);this._onDidChangeDecorations.recordLineAffectedByInjectedText(l.startLineNumber)}let r=this._validateRangeRelaxedNoAllocations(n),s=this._buffer.getOffsetAt(r.startLineNumber,r.startColumn),a=this._buffer.getOffsetAt(r.endLineNumber,r.endColumn);this._decorationsTree.delete(i),i.reset(this.getVersionId(),s,a,r),this._decorationsTree.insert(i),this._onDidChangeDecorations.checkAffectedAndFire(i.options),i.options.after&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(r.endLineNumber),i.options.before&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(r.startLineNumber)}_changeDecorationOptionsImpl(t,n){let i=this._decorations[t];if(!i)return;let r=!!(i.options.overviewRuler&&i.options.overviewRuler.color),s=!!(n.overviewRuler&&n.overviewRuler.color);if(this._onDidChangeDecorations.checkAffectedAndFire(i.options),this._onDidChangeDecorations.checkAffectedAndFire(n),i.options.after||n.after){let d=this._decorationsTree.getNodeRange(this,i);this._onDidChangeDecorations.recordLineAffectedByInjectedText(d.endLineNumber)}if(i.options.before||n.before){let d=this._decorationsTree.getNodeRange(this,i);this._onDidChangeDecorations.recordLineAffectedByInjectedText(d.startLineNumber)}let a=r!==s,l=cG(n)!==nx(i);a||l?(this._decorationsTree.delete(i),i.setOptions(n),this._decorationsTree.insert(i)):i.setOptions(n)}_deltaDecorationsImpl(t,n,i,r=!1){let s=this.getVersionId(),a=n.length,l=0,d=i.length,c=0;this._onDidChangeDecorations.beginDeferredEmit();try{let u=new Array(d);for(;l<a||c<d;){let p=null;if(l<a){do p=this._decorations[n[l++]];while(!p&&l<a);if(p){if(p.options.after){let h=this._decorationsTree.getNodeRange(this,p);this._onDidChangeDecorations.recordLineAffectedByInjectedText(h.endLineNumber)}if(p.options.before){let h=this._decorationsTree.getNodeRange(this,p);this._onDidChangeDecorations.recordLineAffectedByInjectedText(h.startLineNumber)}this._decorationsTree.delete(p),r||this._onDidChangeDecorations.checkAffectedAndFire(p.options)}}if(c<d){if(!p){let y=++this._lastDecorationId,S=`${this._instanceId};${y}`;p=new uv(S,0,0),this._decorations[S]=p}let h=i[c],f=this._validateRangeRelaxedNoAllocations(h.range),g=PU(h.options),b=this._buffer.getOffsetAt(f.startLineNumber,f.startColumn),v=this._buffer.getOffsetAt(f.endLineNumber,f.endColumn);p.ownerId=t,p.reset(s,b,v,f),p.setOptions(g),p.options.after&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(f.endLineNumber),p.options.before&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(f.startLineNumber),r||this._onDidChangeDecorations.checkAffectedAndFire(g),this._decorationsTree.insert(p),u[c]=p.id,c++}else p&&delete this._decorations[p.id]}return u}finally{this._onDidChangeDecorations.endDeferredEmit()}}getLanguageId(){return this.tokenization.getLanguageId()}setLanguage(t,n){typeof t=="string"?(this._languageSelectionListener.clear(),this._setLanguage(t,n)):(this._languageSelectionListener.value=t.onDidChange(()=>this._setLanguage(t.languageId,n)),this._setLanguage(t.languageId,n))}_setLanguage(t,n){this.tokenization.setLanguageId(t,n),this._languageService.requestRichLanguageFeatures(t)}getLanguageIdAtPosition(t,n){return this.tokenization.getLanguageIdAtPosition(t,n)}getWordAtPosition(t){return this._tokenizationTextModelPart.getWordAtPosition(t)}getWordUntilPosition(t){return this._tokenizationTextModelPart.getWordUntilPosition(t)}normalizePosition(t,n){return t}getLineIndentColumn(t){return dG(this.getLineContent(t))+1}};Ka=O([x(4,xB),x(5,Di),x(6,xl),x(7,Oe)],Ka);function dG(o){let e=0;for(let t of o)if(t===" "||t==="	")e++;else break;return e}function JM(o){return!!(o.options.overviewRuler&&o.options.overviewRuler.color)}function cG(o){return!!o.after||!!o.before}function nx(o){return!!o.options.after||!!o.options.before}var ix=class{_decorationsTree0;_decorationsTree1;_injectedTextDecorationsTree;constructor(){this._decorationsTree0=new Tm,this._decorationsTree1=new Tm,this._injectedTextDecorationsTree=new Tm}ensureAllNodesHaveRanges(e){this.getAll(e,0,!1,!1,!1)}_ensureNodesHaveRanges(e,t){for(let n of t)n.range===null&&(n.range=e.getRangeAt(n.cachedAbsoluteStart,n.cachedAbsoluteEnd));return t}getAllInInterval(e,t,n,i,r,s){let a=e.getVersionId(),l=this._intervalSearch(t,n,i,r,a,s);return this._ensureNodesHaveRanges(e,l)}_intervalSearch(e,t,n,i,r,s){let a=this._decorationsTree0.intervalSearch(e,t,n,i,r,s),l=this._decorationsTree1.intervalSearch(e,t,n,i,r,s),d=this._injectedTextDecorationsTree.intervalSearch(e,t,n,i,r,s);return a.concat(l).concat(d)}getInjectedTextInInterval(e,t,n,i){let r=e.getVersionId(),s=this._injectedTextDecorationsTree.intervalSearch(t,n,i,!1,r,!1);return this._ensureNodesHaveRanges(e,s).filter(a=>a.options.showIfCollapsed||!a.range.isEmpty())}getAllInjectedText(e,t){let n=e.getVersionId(),i=this._injectedTextDecorationsTree.search(t,!1,n,!1);return this._ensureNodesHaveRanges(e,i).filter(r=>r.options.showIfCollapsed||!r.range.isEmpty())}getAll(e,t,n,i,r){let s=e.getVersionId(),a=this._search(t,n,i,s,r);return this._ensureNodesHaveRanges(e,a)}_search(e,t,n,i,r){if(n)return this._decorationsTree1.search(e,t,i,r);{let s=this._decorationsTree0.search(e,t,i,r),a=this._decorationsTree1.search(e,t,i,r),l=this._injectedTextDecorationsTree.search(e,t,i,r);return s.concat(a).concat(l)}}collectNodesFromOwner(e){let t=this._decorationsTree0.collectNodesFromOwner(e),n=this._decorationsTree1.collectNodesFromOwner(e),i=this._injectedTextDecorationsTree.collectNodesFromOwner(e);return t.concat(n).concat(i)}collectNodesPostOrder(){let e=this._decorationsTree0.collectNodesPostOrder(),t=this._decorationsTree1.collectNodesPostOrder(),n=this._injectedTextDecorationsTree.collectNodesPostOrder();return e.concat(t).concat(n)}insert(e){nx(e)?this._injectedTextDecorationsTree.insert(e):JM(e)?this._decorationsTree1.insert(e):this._decorationsTree0.insert(e)}delete(e){nx(e)?this._injectedTextDecorationsTree.delete(e):JM(e)?this._decorationsTree1.delete(e):this._decorationsTree0.delete(e)}getNodeRange(e,t){let n=e.getVersionId();return t.cachedVersionId!==n&&this._resolveNode(t,n),t.range===null&&(t.range=e.getRangeAt(t.cachedAbsoluteStart,t.cachedAbsoluteEnd)),t.range}_resolveNode(e,t){nx(e)?this._injectedTextDecorationsTree.resolveNode(e,t):JM(e)?this._decorationsTree1.resolveNode(e,t):this._decorationsTree0.resolveNode(e,t)}acceptReplace(e,t,n,i){this._decorationsTree0.acceptReplace(e,t,n,i),this._decorationsTree1.acceptReplace(e,t,n,i),this._injectedTextDecorationsTree.acceptReplace(e,t,n,i)}};function za(o){return o.replace(/[^a-z0-9\-_]/gi," ")}var ox=class{color;darkColor;constructor(e){this.color=e.color||"",this.darkColor=e.darkColor||""}},tP=class extends ox{position;_resolvedColor;constructor(e){super(e),this._resolvedColor=null,this.position=typeof e.position=="number"?e.position:2}getColor(e){return this._resolvedColor||(e.type!=="light"&&this.darkColor?this._resolvedColor=this._resolveColor(this.darkColor,e):this._resolvedColor=this._resolveColor(this.color,e)),this._resolvedColor}invalidateCachedColor(){this._resolvedColor=null}_resolveColor(e,t){if(typeof e=="string")return e;let n=e?t.getColor(e.id):null;return n?n.toString():""}},nP=class{position;persistLane;constructor(e){this.position=e?.position??2,this.persistLane=e?.persistLane}},iP=class extends ox{position;sectionHeaderStyle;sectionHeaderText;_resolvedColor;constructor(e){super(e),this.position=e.position,this.sectionHeaderStyle=e.sectionHeaderStyle??null,this.sectionHeaderText=e.sectionHeaderText??null}getColor(e){return this._resolvedColor||(e.type!=="light"&&this.darkColor?this._resolvedColor=this._resolveColor(this.darkColor,e):this._resolvedColor=this._resolveColor(this.color,e)),this._resolvedColor}invalidateCachedColor(){this._resolvedColor=void 0}_resolveColor(e,t){return typeof e=="string"?H.fromHex(e):t.getColor(e.id)}},rx=class o{static from(e){return e instanceof o?e:new o(e)}content;tokens;inlineClassName;inlineClassNameAffectsLetterSpacing;attachedData;cursorStops;constructor(e){this.content=e.content||"",this.tokens=e.tokens??null,this.inlineClassName=e.inlineClassName||null,this.inlineClassNameAffectsLetterSpacing=e.inlineClassNameAffectsLetterSpacing||!1,this.attachedData=e.attachedData||null,this.cursorStops=e.cursorStops||null}},En=class o{static EMPTY;static register(e){return new o(e)}static createDynamic(e){return new o(e)}description;blockClassName;blockIsAfterEnd;blockDoesNotCollapse;blockPadding;stickiness;zIndex;className;shouldFillLineOnLineBreak;hoverMessage;glyphMarginHoverMessage;isWholeLine;showIfCollapsed;collapseOnReplaceEdit;overviewRuler;minimap;glyphMargin;glyphMarginClassName;linesDecorationsClassName;lineNumberClassName;lineNumberHoverMessage;linesDecorationsTooltip;firstLineDecorationClassName;marginClassName;inlineClassName;inlineClassNameAffectsLetterSpacing;beforeContentClassName;afterContentClassName;after;before;hideInCommentTokens;hideInStringTokens;constructor(e){this.description=e.description,this.blockClassName=e.blockClassName?za(e.blockClassName):null,this.blockDoesNotCollapse=e.blockDoesNotCollapse??null,this.blockIsAfterEnd=e.blockIsAfterEnd??null,this.blockPadding=e.blockPadding??null,this.stickiness=e.stickiness||0,this.zIndex=e.zIndex||0,this.className=e.className?za(e.className):null,this.shouldFillLineOnLineBreak=e.shouldFillLineOnLineBreak??null,this.hoverMessage=e.hoverMessage||null,this.glyphMarginHoverMessage=e.glyphMarginHoverMessage||null,this.lineNumberHoverMessage=e.lineNumberHoverMessage||null,this.isWholeLine=e.isWholeLine||!1,this.showIfCollapsed=e.showIfCollapsed||!1,this.collapseOnReplaceEdit=e.collapseOnReplaceEdit||!1,this.overviewRuler=e.overviewRuler?new tP(e.overviewRuler):null,this.minimap=e.minimap?new iP(e.minimap):null,this.glyphMargin=e.glyphMarginClassName?new nP(e.glyphMargin):null,this.glyphMarginClassName=e.glyphMarginClassName?za(e.glyphMarginClassName):null,this.linesDecorationsClassName=e.linesDecorationsClassName?za(e.linesDecorationsClassName):null,this.lineNumberClassName=e.lineNumberClassName?za(e.lineNumberClassName):null,this.linesDecorationsTooltip=e.linesDecorationsTooltip?VA(e.linesDecorationsTooltip):null,this.firstLineDecorationClassName=e.firstLineDecorationClassName?za(e.firstLineDecorationClassName):null,this.marginClassName=e.marginClassName?za(e.marginClassName):null,this.inlineClassName=e.inlineClassName?za(e.inlineClassName):null,this.inlineClassNameAffectsLetterSpacing=e.inlineClassNameAffectsLetterSpacing||!1,this.beforeContentClassName=e.beforeContentClassName?za(e.beforeContentClassName):null,this.afterContentClassName=e.afterContentClassName?za(e.afterContentClassName):null,this.after=e.after?rx.from(e.after):null,this.before=e.before?rx.from(e.before):null,this.hideInCommentTokens=e.hideInCommentTokens??!1,this.hideInStringTokens=e.hideInStringTokens??!1}};En.EMPTY=En.register({description:"empty"});var MU=[En.register({description:"tracked-range-always-grows-when-typing-at-edges",stickiness:0}),En.register({description:"tracked-range-never-grows-when-typing-at-edges",stickiness:1}),En.register({description:"tracked-range-grows-only-when-typing-before",stickiness:2}),En.register({description:"tracked-range-grows-only-when-typing-after",stickiness:3})];function PU(o){return o instanceof En?o:En.createDynamic(o)}var oP=class extends F{constructor(t){super();this.handleBeforeFire=t;this._deferredCnt=0,this._shouldFireDeferred=!1,this._affectsMinimap=!1,this._affectsOverviewRuler=!1,this._affectsGlyphMargin=!1,this._affectsLineNumber=!1}_actual=this._register(new D);event=this._actual.event;_deferredCnt;_shouldFireDeferred;_affectsMinimap;_affectsOverviewRuler;_affectedInjectedTextLines=null;_affectsGlyphMargin;_affectsLineNumber;hasListeners(){return this._actual.hasListeners()}beginDeferredEmit(){this._deferredCnt++}endDeferredEmit(){this._deferredCnt--,this._deferredCnt===0&&(this._shouldFireDeferred&&this.doFire(),this._affectedInjectedTextLines?.clear(),this._affectedInjectedTextLines=null)}recordLineAffectedByInjectedText(t){this._affectedInjectedTextLines||(this._affectedInjectedTextLines=new Set),this._affectedInjectedTextLines.add(t)}checkAffectedAndFire(t){this._affectsMinimap||=!!t.minimap?.position,this._affectsOverviewRuler||=!!t.overviewRuler?.color,this._affectsGlyphMargin||=!!t.glyphMarginClassName,this._affectsLineNumber||=!!t.lineNumberClassName,this.tryFire()}fire(){this._affectsMinimap=!0,this._affectsOverviewRuler=!0,this._affectsGlyphMargin=!0,this.tryFire()}tryFire(){this._deferredCnt===0?this.doFire():this._shouldFireDeferred=!0}doFire(){this.handleBeforeFire(this._affectedInjectedTextLines);let t={affectsMinimap:this._affectsMinimap,affectsOverviewRuler:this._affectsOverviewRuler,affectsGlyphMargin:this._affectsGlyphMargin,affectsLineNumber:this._affectsLineNumber};this._shouldFireDeferred=!1,this._affectsMinimap=!1,this._affectsOverviewRuler=!1,this._affectsGlyphMargin=!1,this._actual.fire(t)}},rP=class extends F{_fastEmitter=this._register(new D);fastEvent=this._fastEmitter.event;_slowEmitter=this._register(new D);slowEvent=this._slowEmitter.event;_deferredCnt;_deferredEvent;constructor(){super(),this._deferredCnt=0,this._deferredEvent=null}hasListeners(){return this._fastEmitter.hasListeners()||this._slowEmitter.hasListeners()}beginDeferredEmit(){this._deferredCnt++}endDeferredEmit(e=null){if(this._deferredCnt--,this._deferredCnt===0&&this._deferredEvent!==null){this._deferredEvent.rawContentChangedEvent.resultingSelection=e;let t=this._deferredEvent;this._deferredEvent=null,this._fastEmitter.fire(t),this._slowEmitter.fire(t)}}fire(e){if(this._deferredCnt>0){this._deferredEvent?this._deferredEvent=this._deferredEvent.merge(e):this._deferredEvent=e;return}this._fastEmitter.fire(e),this._slowEmitter.fire(e)}};var hc=Y("workingCopyService"),aP=class extends F{_onDidRegister=this._register(new D);onDidRegister=this._onDidRegister.event;_onDidUnregister=this._register(new D);onDidUnregister=this._onDidUnregister.event;_onDidChangeDirty=this._register(new D);onDidChangeDirty=this._onDidChangeDirty.event;_onDidChangeContent=this._register(new D);onDidChangeContent=this._onDidChangeContent.event;_onDidSave=this._register(new D);onDidSave=this._onDidSave.event;get workingCopies(){return Array.from(this._workingCopies.values())}_workingCopies=new Set;mapResourceToWorkingCopies=new Ui;mapWorkingCopyToListeners=this._register(new Lo);registerWorkingCopy(e){let t=this.mapResourceToWorkingCopies.get(e.resource);if(t?.has(e.typeId))throw new Error(`Cannot register more than one working copy with the same resource ${e.resource.toString()} and type ${e.typeId}.`);this._workingCopies.add(e),t||(t=new Map,this.mapResourceToWorkingCopies.set(e.resource,t)),t.set(e.typeId,e);let n=new ee;return n.add(e.onDidChangeContent(()=>this._onDidChangeContent.fire(e))),n.add(e.onDidChangeDirty(()=>this._onDidChangeDirty.fire(e))),n.add(e.onDidSave(i=>this._onDidSave.fire({workingCopy:e,...i}))),this.mapWorkingCopyToListeners.set(e,n),this._onDidRegister.fire(e),e.isDirty()&&this._onDidChangeDirty.fire(e),le(()=>{this.unregisterWorkingCopy(e),this._onDidUnregister.fire(e)})}unregisterWorkingCopy(e){this._workingCopies.delete(e);let t=this.mapResourceToWorkingCopies.get(e.resource);t?.delete(e.typeId)&&t.size===0&&this.mapResourceToWorkingCopies.delete(e.resource),e.isDirty()&&this._onDidChangeDirty.fire(e),this.mapWorkingCopyToListeners.deleteAndDispose(e)}has(e){return J.isUri(e)?this.mapResourceToWorkingCopies.has(e):this.mapResourceToWorkingCopies.get(e.resource)?.has(e.typeId)??!1}get(e){return this.mapResourceToWorkingCopies.get(e.resource)?.get(e.typeId)}getAll(e){let t=this.mapResourceToWorkingCopies.get(e);if(t)return Array.from(t.values())}get hasDirty(){for(let e of this._workingCopies)if(e.isDirty())return!0;return!1}get dirtyCount(){let e=0;for(let t of this._workingCopies)t.isDirty()&&e++;return e}get dirtyWorkingCopies(){return this.workingCopies.filter(e=>e.isDirty())}get modifiedCount(){let e=0;for(let t of this._workingCopies)t.isModified()&&e++;return e}get modifiedWorkingCopies(){return this.workingCopies.filter(e=>e.isModified())}isDirty(e,t){let n=this.mapResourceToWorkingCopies.get(e);if(n){if(typeof t=="string")return n.get(t)?.isDirty()??!1;for(let[,i]of n)if(i.isDirty())return!0}return!1}};$i(hc,aP,1);var ax=Y("labelService");var $u=Y("dialogService");var Oot=Y("fileDialogService");var Kl=class extends yv{_onDidChangeDirty=this._register(new D);_onDidChangeLabel=this._register(new D);_onDidChangeCapabilities=this._register(new D);_onWillDispose=this._register(new D);onDidChangeDirty=this._onDidChangeDirty.event;onDidChangeLabel=this._onDidChangeLabel.event;onDidChangeCapabilities=this._onDidChangeCapabilities.event;onWillDispose=this._onWillDispose.event;closeHandler;get editorId(){}get capabilities(){return 2}hasCapability(e){return e===0?this.capabilities===0:(this.capabilities&e)!==0}isReadonly(){return this.hasCapability(2)}getName(){return`Editor ${this.typeId}`}getDescription(e){}getTitle(e){return this.getName()}getLabelExtraClasses(){return[]}getAriaLabel(){return this.getTitle(0)}getIcon(){}getTelemetryDescriptor(){return{typeId:this.typeId}}isDirty(){return!1}isModified(){return this.isDirty()}isSaving(){return!1}async resolve(){return null}async save(e,t){return this}async saveAs(e,t){return this}async revert(e,t){}async rename(e,t){}copy(){return this}canMove(e,t){return!0}matches(e){if(yi(e))return this===e;let t=e.options?.override;return this.editorId!==t&&t!==void 0&&this.editorId!==void 0?!1:nr(this.resource,Ks.getCanonicalUri(e))}prefersEditorPane(e){return e.at(0)}toUntyped(e){}isDisposed(){return this._store.isDisposed}dispose(){this.isDisposed()||this._onWillDispose.fire(),super.dispose()}};var Ii=class extends Kl{constructor(t,n,i,r,s){super();this.preferredName=t;this.preferredDescription=n;this.secondary=i;this.primary=r;this.editorService=s;this.registerListeners()}static ID="workbench.editorinputs.sidebysideEditorInput";get typeId(){return Ii.ID}get capabilities(){let t=this.primary.capabilities;return t&=-33,this.secondary.hasCapability(16)&&(t|=16),this.secondary.hasCapability(8)&&(t|=8),t|=256,t}get resource(){if(this.hasIdenticalSides)return this.primary.resource}hasIdenticalSides=this.primary.matches(this.secondary);registerListeners(){this._register(q.once(q.any(this.primary.onWillDispose,this.secondary.onWillDispose))(()=>{this.isDisposed()||this.dispose()})),this._register(this.primary.onDidChangeDirty(()=>this._onDidChangeDirty.fire())),this._register(this.primary.onDidChangeCapabilities(()=>this._onDidChangeCapabilities.fire())),this._register(this.secondary.onDidChangeCapabilities(()=>this._onDidChangeCapabilities.fire())),this._register(this.primary.onDidChangeLabel(()=>this._onDidChangeLabel.fire())),this._register(this.secondary.onDidChangeLabel(()=>this._onDidChangeLabel.fire()))}getName(){let t=this.getPreferredName();return t||(this.hasIdenticalSides?this.primary.getName():m("sideBySideLabels","{0} - {1}",this.secondary.getName(),this.primary.getName()))}getPreferredName(){return this.preferredName}getDescription(t){let n=this.getPreferredDescription();return n||(this.hasIdenticalSides?this.primary.getDescription(t):super.getDescription(t))}getPreferredDescription(){return this.preferredDescription}getTitle(t){let n;this.hasIdenticalSides?n=this.primary.getTitle(t)??this.getName():n=super.getTitle(t);let i=this.getPreferredTitle();return i&&(n=`${i} (${n})`),n}getPreferredTitle(){if(this.preferredName&&this.preferredDescription)return`${this.preferredName} ${this.preferredDescription}`;if(this.preferredName||this.preferredDescription)return this.preferredName??this.preferredDescription}getLabelExtraClasses(){return this.hasIdenticalSides?this.primary.getLabelExtraClasses():super.getLabelExtraClasses()}getAriaLabel(){return this.hasIdenticalSides?this.primary.getAriaLabel():super.getAriaLabel()}getTelemetryDescriptor(){return{...this.primary.getTelemetryDescriptor(),...super.getTelemetryDescriptor()}}isDirty(){return this.primary.isDirty()}isSaving(){return this.primary.isSaving()}async save(t,n){let i=await this.primary.save(t,n);return this.saveResultToEditor(i)}async saveAs(t,n){let i=await this.primary.saveAs(t,n);return this.saveResultToEditor(i)}saveResultToEditor(t){if(!t||!this.hasIdenticalSides)return t;if(this.primary.matches(t))return this;if(t instanceof Kl)return new Ii(this.preferredName,this.preferredDescription,t,t,this.editorService);if(!Gs(t)&&!km(t)&&!mc(t)&&!gc(t))return{primary:t,secondary:t,label:this.preferredName,description:this.preferredDescription}}revert(t,n){return this.primary.revert(t,n)}async rename(t,n){if(!this.hasIdenticalSides)return;let i=await this.primary.rename(t,n);if(i){if(yi(i.editor))return{editor:new Ii(this.preferredName,this.preferredDescription,i.editor,i.editor,this.editorService),options:{...i.options,viewState:lx(this,t,this.editorService)}};if(NU(i.editor))return{editor:{label:this.preferredName,description:this.preferredDescription,primary:i.editor,secondary:i.editor,options:{...i.options,viewState:lx(this,t,this.editorService)}}}}}isReadonly(){return this.primary.isReadonly()}toUntyped(t){let n=this.primary.toUntyped(t),i=this.secondary.toUntyped(t);if(n&&i&&!Gs(n)&&!Gs(i)&&!km(n)&&!km(i)&&!mc(n)&&!mc(i)&&!gc(n)&&!gc(i)){let r={label:this.preferredName,description:this.preferredDescription,primary:n,secondary:i};return typeof t?.preserveViewState=="number"&&(r.options={viewState:lx(this,t.preserveViewState,this.editorService)}),r}}matches(t){return this===t?!0:dP(t)||Gs(t)?!1:t instanceof Ii?this.primary.matches(t.primary)&&this.secondary.matches(t.secondary):mc(t)?this.primary.matches(t.primary)&&this.secondary.matches(t.secondary):!1}};Ii=O([x(4,Tn)],Ii);var cP={LEFT:"left",RIGHT:"right",FIRST:"first",LAST:"last"};function pG(o){let e=o;return!!(e&&typeof e=="object"&&Array.isArray(e.editors)&&Array.isArray(e.mru))}var Ga=class extends F{constructor(t,n,i){super();this.instantiationService=n;this.configurationService=i;pG(t)?this._id=this.deserialize(t):this._id=Ga.IDS++,this.onConfigurationUpdated(),this.registerListeners()}static IDS=0;_onDidModelChange=this._register(new D({leakWarningThreshold:500}));onDidModelChange=this._onDidModelChange.event;_id;get id(){return this._id}editors=[];mru=[];editorListeners=new Set;locked=!1;selection=[];get active(){return this.selection[0]??null}preview=null;sticky=-1;transient=new Set;editorOpenPositioning;focusRecentEditorAfterClose;registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(t=>this.onConfigurationUpdated(t)))}onConfigurationUpdated(t){t&&!t.affectsConfiguration("workbench.editor.openPositioning")&&!t.affectsConfiguration("workbench.editor.focusRecentEditorAfterClose")||(this.editorOpenPositioning=this.configurationService.getValue("workbench.editor.openPositioning"),this.focusRecentEditorAfterClose=this.configurationService.getValue("workbench.editor.focusRecentEditorAfterClose"))}get count(){return this.editors.length}get stickyCount(){return this.sticky+1}getEditors(t,n){let i=t===0?this.mru.slice(0):this.editors.slice(0);return n?.excludeSticky?t===0?i.filter(r=>!this.isSticky(r)):i.slice(this.sticky+1):i}getEditorByIndex(t){return this.editors[t]}get activeEditor(){return this.active}isActive(t){return this.matches(this.active,t)}get previewEditor(){return this.preview}openEditor(t,n){let i=n?.sticky||typeof n?.index=="number"&&this.isSticky(n.index),r=n?.pinned||n?.sticky,s=!!n?.transient,a=n?.active||!this.activeEditor||!r&&this.preview===this.activeEditor,l=this.findEditor(t,n);if(l){let[d,c]=l;return this.doSetTransient(d,c,s===!1?!1:this.isTransient(d)),r&&this.doPin(d,c),this.setSelection(a?d:this.activeEditor,n?.inactiveSelection??[]),n&&typeof n.index=="number"&&this.moveEditor(d,n.index),i&&this.doStick(d,this.indexOf(d)),{editor:d,isNew:!1}}else{let d=t,c=this.indexOf(this.active),u;if(n&&typeof n.index=="number"?u=n.index:this.editorOpenPositioning===cP.FIRST?(u=0,!i&&this.isSticky(u)&&(u=this.sticky+1)):this.editorOpenPositioning===cP.LAST?u=this.editors.length:(this.editorOpenPositioning===cP.LEFT?c===0||!this.editors.length?u=0:u=c:u=c+1,!i&&this.isSticky(u)&&(u=this.sticky+1)),i&&(this.sticky++,this.isSticky(u)||(u=this.sticky)),(r||!this.preview)&&this.splice(u,!1,d),s&&this.doSetTransient(d,u,!0),!r){if(this.preview){let h=this.indexOf(this.preview);u>h&&u--,this.replaceEditor(this.preview,d,u,!a)}this.preview=d}this.registerEditorListeners(d);let p={kind:5,editor:d,editorIndex:u};return this._onDidModelChange.fire(p),this.setSelection(a?d:this.activeEditor,n?.inactiveSelection??[]),{editor:d,isNew:!0}}}registerEditorListeners(t){let n=new ee;this.editorListeners.add(n),n.add(q.once(t.onWillDispose)(()=>{let i=this.editors.indexOf(t);if(i>=0){let r={kind:15,editor:t,editorIndex:i};this._onDidModelChange.fire(r)}})),n.add(t.onDidChangeDirty(()=>{let i={kind:14,editor:t,editorIndex:this.editors.indexOf(t)};this._onDidModelChange.fire(i)})),n.add(t.onDidChangeLabel(()=>{let i={kind:9,editor:t,editorIndex:this.editors.indexOf(t)};this._onDidModelChange.fire(i)})),n.add(t.onDidChangeCapabilities(()=>{let i={kind:10,editor:t,editorIndex:this.editors.indexOf(t)};this._onDidModelChange.fire(i)})),n.add(this.onDidModelChange(i=>{i.kind===6&&i.editor?.matches(t)&&(wt(n),this.editorListeners.delete(n))}))}replaceEditor(t,n,i,r=!0){let s=this.doCloseEditor(t,1,r);if(this.splice(i,!1,n),s){let a={kind:6,...s};this._onDidModelChange.fire(a)}}closeEditor(t,n=0,i=!0){let r=this.doCloseEditor(t,n,i);if(r){let s={kind:6,...r};return this._onDidModelChange.fire(s),r}}doCloseEditor(t,n,i){let r=this.indexOf(t);if(r===-1)return;let s=this.editors[r],a=this.isSticky(r),l=this.active===s;if(i&&l)if(this.mru.length>1){let d;this.focusRecentEditorAfterClose?d=this.mru[1]:r===this.editors.length-1?d=this.editors[r-1]:d=this.editors[r+1];let c=this.selection.filter(u=>u!==s&&u!==d);this.doSetSelection(d,this.editors.indexOf(d),c)}else this.doSetSelection(null,void 0,[]);else if(!l&&this.doIsSelected(s)){let d=this.selection.filter(c=>c!==s&&c!==this.activeEditor);this.doSetSelection(this.activeEditor,this.indexOf(this.activeEditor),d)}return this.preview===s&&(this.preview=null),this.transient.delete(s),this.splice(r,!0),{editor:s,sticky:a,editorIndex:r,context:n}}moveEditor(t,n){n>=this.editors.length?n=this.editors.length-1:n<0&&(n=0);let i=this.indexOf(t);if(i<0||n===i)return;let r=this.editors[i],s=this.sticky;this.isSticky(i)&&n>this.sticky?this.sticky--:!this.isSticky(i)&&n<=this.sticky&&this.sticky++,this.editors.splice(i,1),this.editors.splice(n,0,r);let a={kind:7,editor:r,oldEditorIndex:i,editorIndex:n};if(this._onDidModelChange.fire(a),s!==this.sticky){let l={kind:13,editor:r,editorIndex:n};this._onDidModelChange.fire(l)}return r}setActive(t){let n;return t?n=this.setEditorActive(t):this.setGroupActive(),n}setGroupActive(){this._onDidModelChange.fire({kind:0})}setEditorActive(t){let n=this.findEditor(t);if(!n)return;let[i,r]=n;return this.doSetSelection(i,r,[]),i}get selectedEditors(){return this.editors.filter(t=>this.doIsSelected(t))}isSelected(t){let n;return typeof t=="number"?n=this.editors[t]:n=this.findEditor(t)?.[0],!!n&&this.doIsSelected(n)}doIsSelected(t){return this.selection.includes(t)}setSelection(t,n){let i=this.findEditor(t);if(!i)return;let[r,s]=i,a=new Set;for(let l of n){let d=this.findEditor(l);if(!d)return;let[c]=d;c!==r&&a.add(c)}this.doSetSelection(r,s,Array.from(a))}doSetSelection(t,n,i){let r=this.activeEditor,s=this.selection,a;t?a=[t,...i]:a=[],this.selection=a;let l=t&&typeof n=="number"&&r!==t;if(l){let d=this.indexOf(t,this.mru);this.mru.splice(d,1),this.mru.unshift(t);let c={kind:8,editor:t,editorIndex:n};this._onDidModelChange.fire(c)}if(l||s.length!==a.length||s.some(d=>!a.includes(d))){let d={kind:4};this._onDidModelChange.fire(d)}}setIndex(t){this._onDidModelChange.fire({kind:1})}setLabel(t){this._onDidModelChange.fire({kind:2})}pin(t){let n=this.findEditor(t);if(!n)return;let[i,r]=n;return this.doPin(i,r),i}doPin(t,n){if(this.isPinned(t))return;this.setTransient(t,!1),this.preview=null;let i={kind:11,editor:t,editorIndex:n};this._onDidModelChange.fire(i)}unpin(t){let n=this.findEditor(t);if(!n)return;let[i,r]=n;return this.doUnpin(i,r),i}doUnpin(t,n){if(!this.isPinned(t))return;let i=this.preview;this.preview=t;let r={kind:11,editor:t,editorIndex:n};this._onDidModelChange.fire(r),i&&this.closeEditor(i,3)}isPinned(t){let n;return typeof t=="number"?n=this.editors[t]:n=t,!this.matches(this.preview,n)}stick(t){let n=this.findEditor(t);if(!n)return;let[i,r]=n;return this.doStick(i,r),i}doStick(t,n){if(this.isSticky(n))return;this.pin(t);let i=this.sticky+1;this.moveEditor(t,i),this.sticky++;let r={kind:13,editor:t,editorIndex:i};this._onDidModelChange.fire(r)}unstick(t){let n=this.findEditor(t);if(!n)return;let[i,r]=n;return this.doUnstick(i,r),i}doUnstick(t,n){if(!this.isSticky(n))return;let i=this.sticky;this.moveEditor(t,i),this.sticky--;let r={kind:13,editor:t,editorIndex:i};this._onDidModelChange.fire(r)}isSticky(t){if(this.sticky<0)return!1;let n;return typeof t=="number"?n=t:n=this.indexOf(t),n<0?!1:n<=this.sticky}setTransient(t,n){if(!n&&this.transient.size===0)return;let i=this.findEditor(t);if(!i)return;let[r,s]=i;return this.doSetTransient(r,s,n),r}doSetTransient(t,n,i){if(i){if(this.transient.has(t))return;this.transient.add(t)}else{if(!this.transient.has(t))return;this.transient.delete(t)}let r={kind:12,editor:t,editorIndex:n};this._onDidModelChange.fire(r)}isTransient(t){if(this.transient.size===0)return!1;let n;return typeof t=="number"?n=this.editors[t]:n=this.findEditor(t)?.[0],!!n&&this.transient.has(n)}splice(t,n,i){let r=this.editors[t];if(n&&this.isSticky(t)&&this.sticky--,i?this.editors.splice(t,n?1:0,i):this.editors.splice(t,n?1:0),!n&&i)this.mru.length===0?this.mru.push(i):this.mru.splice(1,0,i);else{let s=this.indexOf(r,this.mru);n&&!i?this.mru.splice(s,1):n&&i&&this.mru.splice(s,1,i)}}indexOf(t,n=this.editors,i){let r=-1;if(!t)return r;for(let s=0;s<n.length;s++){let a=n[s];if(this.matches(a,t,i))if(i?.supportSideBySide&&a instanceof Ii&&!(t instanceof Ii))r=s;else{r=s;break}}return r}findEditor(t,n){let i=this.indexOf(t,this.editors,n);if(i!==-1)return[this.editors[i],i]}isFirst(t,n=this.editors){return this.matches(n[0],t)}isLast(t,n=this.editors){return this.matches(n[n.length-1],t)}contains(t,n){return this.indexOf(t,this.editors,n)!==-1}matches(t,n,i){if(!t||!n)return!1;if(i?.supportSideBySide&&t instanceof Ii&&!(n instanceof Ii))switch(i.supportSideBySide){case 4:if(this.matches(t.primary,n,i)||this.matches(t.secondary,n,i))return!0;break;case 3:if(this.matches(t.primary,n,i)&&this.matches(t.secondary,n,i))return!0;break}let r=t===n;return i?.strictEquals?r:r||t.matches(n)}get isLocked(){return this.locked}lock(t){this.isLocked!==t&&(this.locked=t,this._onDidModelChange.fire({kind:3}))}clone(){let t=this.instantiationService.createInstance(Ga,void 0);t.editors=this.editors.slice(0),t.mru=this.mru.slice(0),t.preview=this.preview,t.selection=this.selection.slice(0),t.sticky=this.sticky;for(let n of t.editors)t.registerEditorListeners(n);return t}serialize(){let t=et.as(js.EditorFactory),n=[],i=[],r,s=this.sticky;for(let l=0;l<this.editors.length;l++){let d=this.editors[l],c=!1,u=t.getEditorSerializer(d);if(u){let p=u.canSerialize(d)?u.serialize(d):void 0;typeof p=="string"?(c=!0,i.push({id:d.typeId,value:p}),n.push(d),this.preview===d&&(r=n.length-1)):c=!1}!c&&this.isSticky(l)&&s--}let a=this.mru.map(l=>this.indexOf(l,n)).filter(l=>l>=0);return{id:this.id,locked:this.locked?!0:void 0,editors:i,mru:a,preview:r,sticky:s>=0?s:void 0}}deserialize(t){let n=et.as(js.EditorFactory);return typeof t.id=="number"?(this._id=t.id,Ga.IDS=Math.max(t.id+1,Ga.IDS)):this._id=Ga.IDS++,t.locked&&(this.locked=!0),this.editors=Er(t.editors.map((i,r)=>{let s,a=n.getEditorSerializer(i.id);if(a){let l=a.deserialize(this.instantiationService,i.value);l instanceof Kl&&(s=l,this.registerEditorListeners(s))}return!s&&typeof t.sticky=="number"&&r<=t.sticky&&t.sticky--,s})),this.mru=Er(t.mru.map(i=>this.editors[i])),this.selection=this.mru.length>0?[this.mru[0]]:[],typeof t.preview=="number"&&(this.preview=this.editors[t.preview]),typeof t.sticky=="number"&&(this.sticky=t.sticky),this._id}dispose(){wt(Array.from(this.editorListeners)),this.editorListeners.clear(),this.transient.clear(),super.dispose()}};Ga=O([x(1,Oe),x(2,ut)],Ga);var Tn=Y("editorService");var dx=-2;var pP=class{constructor(e,t,n){this.id=e;this.dependencies=t;this.callback=n}};var AU=class o{static INSTANCE=new o;_isWebWorker=typeof self=="object"&&self.constructor&&self.constructor.name==="DedicatedWorkerGlobalScope";_isRenderer=typeof document=="object";_defineCalls=[];_state=1;_amdPolicy;constructor(){}_initialize(){if(this._state===1){if(globalThis.define){console.log("[amdX] AMD loader already present externally"),this._state=3;return}}else return;this._state=2,globalThis.define=(e,t,n)=>{typeof e!="string"&&(n=t,t=e,e=null),(typeof t!="object"||!Array.isArray(t))&&(n=t,t=null),this._defineCalls.push(new pP(e,t,n))},globalThis.define.amd=!0,this._isRenderer?this._amdPolicy=globalThis._VSCODE_WEB_PACKAGE_TTP??window.trustedTypes?.createPolicy("amdLoader",{createScriptURL(e){if(e.startsWith(window.location.origin)||e.startsWith(`${Le.vscodeFileResource}://${bL}`))return e;throw new Error(`[trusted_script_src] Invalid script url: ${e}`)}}):this._isWebWorker&&(this._amdPolicy=globalThis._VSCODE_WEB_PACKAGE_TTP??globalThis.trustedTypes?.createPolicy("amdLoader",{createScriptURL(e){return e}}))}async load(e){if(this._initialize(),this._state===3)return new Promise(s=>{let a=Mr();console.log(`[amdX] Using external define("${a}", ["${e}"])`),globalThis.define(a,[e],function(l){console.log(`[amdX] Got a result for ${a}: ${!!l}`),s(l)})});let t=await(this._isWebWorker?this._workerLoadScript(e):this._isRenderer?this._rendererLoadScript(e):this._nodeJSLoadScript(e));if(!t){console.warn(`Did not receive a define call from script ${e}`);return}let n={},i=[],r=[];if(Array.isArray(t.dependencies))for(let s of t.dependencies)s==="exports"?i.push(n):r.push(s);if(r.length>0)throw new Error(`Cannot resolve dependencies for script ${e}. The dependencies are: ${r.join(", ")}`);return typeof t.callback=="function"?t.callback(...i)??n:t.callback}_rendererLoadScript(e){return new Promise((t,n)=>{let i=document.createElement("script");i.setAttribute("async","async"),i.setAttribute("type","text/javascript");let r=()=>{i.removeEventListener("load",s),i.removeEventListener("error",a)},s=l=>{r(),t(this._defineCalls.pop())},a=l=>{r(),n(l)};i.addEventListener("load",s),i.addEventListener("error",a),this._amdPolicy&&(e=this._amdPolicy.createScriptURL(e)),i.setAttribute("src",e),window.document.getElementsByTagName("head")[0].appendChild(i)})}async _workerLoadScript(e){return this._amdPolicy&&(e=this._amdPolicy.createScriptURL(e)),await import(e),this._defineCalls.pop()}async _nodeJSLoadScript(e){try{let t=(await import("fs")).default,n=(await import("vm")).default,i=(await import("module")).default,r=J.parse(e).fsPath,s=t.readFileSync(r).toString(),a=i.wrap(s.replace(/^#!.*/,""));return new n.Script(a).runInThisContext().apply(),this._defineCalls.pop()}catch(t){throw t}}};var mP="utf8";var iat=512*8,oat=512*128;var hP={utf8:{labelLong:"UTF-8",labelShort:"UTF-8",order:1,alias:"utf8bom",guessableName:"UTF-8"},utf8bom:{labelLong:"UTF-8 with BOM",labelShort:"UTF-8 with BOM",encodeOnly:!0,order:2,alias:"utf8"},utf16le:{labelLong:"UTF-16 LE",labelShort:"UTF-16 LE",order:3,guessableName:"UTF-16LE"},utf16be:{labelLong:"UTF-16 BE",labelShort:"UTF-16 BE",order:4,guessableName:"UTF-16BE"},windows1252:{labelLong:"Western (Windows 1252)",labelShort:"Windows 1252",order:5,guessableName:"windows-1252"},iso88591:{labelLong:"Western (ISO 8859-1)",labelShort:"ISO 8859-1",order:6},iso88593:{labelLong:"Western (ISO 8859-3)",labelShort:"ISO 8859-3",order:7},iso885915:{labelLong:"Western (ISO 8859-15)",labelShort:"ISO 8859-15",order:8},macroman:{labelLong:"Western (Mac Roman)",labelShort:"Mac Roman",order:9},cp437:{labelLong:"DOS (CP 437)",labelShort:"CP437",order:10},windows1256:{labelLong:"Arabic (Windows 1256)",labelShort:"Windows 1256",order:11},iso88596:{labelLong:"Arabic (ISO 8859-6)",labelShort:"ISO 8859-6",order:12},windows1257:{labelLong:"Baltic (Windows 1257)",labelShort:"Windows 1257",order:13},iso88594:{labelLong:"Baltic (ISO 8859-4)",labelShort:"ISO 8859-4",order:14},iso885914:{labelLong:"Celtic (ISO 8859-14)",labelShort:"ISO 8859-14",order:15},windows1250:{labelLong:"Central European (Windows 1250)",labelShort:"Windows 1250",order:16,guessableName:"windows-1250"},iso88592:{labelLong:"Central European (ISO 8859-2)",labelShort:"ISO 8859-2",order:17,guessableName:"ISO-8859-2"},cp852:{labelLong:"Central European (CP 852)",labelShort:"CP 852",order:18},windows1251:{labelLong:"Cyrillic (Windows 1251)",labelShort:"Windows 1251",order:19,guessableName:"windows-1251"},cp866:{labelLong:"Cyrillic (CP 866)",labelShort:"CP 866",order:20,guessableName:"IBM866"},iso88595:{labelLong:"Cyrillic (ISO 8859-5)",labelShort:"ISO 8859-5",order:21,guessableName:"ISO-8859-5"},koi8r:{labelLong:"Cyrillic (KOI8-R)",labelShort:"KOI8-R",order:22,guessableName:"KOI8-R"},koi8u:{labelLong:"Cyrillic (KOI8-U)",labelShort:"KOI8-U",order:23},iso885913:{labelLong:"Estonian (ISO 8859-13)",labelShort:"ISO 8859-13",order:24},windows1253:{labelLong:"Greek (Windows 1253)",labelShort:"Windows 1253",order:25,guessableName:"windows-1253"},iso88597:{labelLong:"Greek (ISO 8859-7)",labelShort:"ISO 8859-7",order:26,guessableName:"ISO-8859-7"},windows1255:{labelLong:"Hebrew (Windows 1255)",labelShort:"Windows 1255",order:27,guessableName:"windows-1255"},iso88598:{labelLong:"Hebrew (ISO 8859-8)",labelShort:"ISO 8859-8",order:28,guessableName:"ISO-8859-8"},iso885910:{labelLong:"Nordic (ISO 8859-10)",labelShort:"ISO 8859-10",order:29},iso885916:{labelLong:"Romanian (ISO 8859-16)",labelShort:"ISO 8859-16",order:30},windows1254:{labelLong:"Turkish (Windows 1254)",labelShort:"Windows 1254",order:31},iso88599:{labelLong:"Turkish (ISO 8859-9)",labelShort:"ISO 8859-9",order:32},windows1258:{labelLong:"Vietnamese (Windows 1258)",labelShort:"Windows 1258",order:33},gbk:{labelLong:"Simplified Chinese (GBK)",labelShort:"GBK",order:34},gb18030:{labelLong:"Simplified Chinese (GB18030)",labelShort:"GB18030",order:35},cp950:{labelLong:"Traditional Chinese (Big5)",labelShort:"Big5",order:36,guessableName:"Big5"},big5hkscs:{labelLong:"Traditional Chinese (Big5-HKSCS)",labelShort:"Big5-HKSCS",order:37},shiftjis:{labelLong:"Japanese (Shift JIS)",labelShort:"Shift JIS",order:38,guessableName:"SHIFT_JIS"},eucjp:{labelLong:"Japanese (EUC-JP)",labelShort:"EUC-JP",order:39,guessableName:"EUC-JP"},euckr:{labelLong:"Korean (EUC-KR)",labelShort:"EUC-KR",order:40,guessableName:"EUC-KR"},windows874:{labelLong:"Thai (Windows 874)",labelShort:"Windows 874",order:41},iso885911:{labelLong:"Latin/Thai (ISO 8859-11)",labelShort:"ISO 8859-11",order:42},koi8ru:{labelLong:"Cyrillic (KOI8-RU)",labelShort:"KOI8-RU",order:43},koi8t:{labelLong:"Tajik (KOI8-T)",labelShort:"KOI8-T",order:44},gb2312:{labelLong:"Simplified Chinese (GB 2312)",labelShort:"GB 2312",order:45,guessableName:"GB2312"},cp865:{labelLong:"Nordic DOS (CP 865)",labelShort:"CP 865",order:46},cp850:{labelLong:"Western European DOS (CP 850)",labelShort:"CP 850",order:47}},rat=(()=>{let o={};for(let e in hP)hP[e].guessableName&&(o[e]=hP[e]);return o})();var qs=class extends zs{constructor(t,n,i,r,s,a,l,d,c,u,p,h,f,g,b){super(l,a,g,b);this.resource=t;this.hasAssociatedFilePath=n;this.initialValue=i;this.preferredLanguageId=r;this.preferredEncoding=s;this.workingCopyBackupService=d;this.textResourceConfigurationService=c;this.workingCopyService=u;this.textFileService=p;this.labelService=h;this.editorService=f;this._register(this.workingCopyService.registerWorkingCopy(this)),r&&this.setLanguageId(r),this.onConfigurationChange(void 0,!1),this.registerListeners()}static FIRST_LINE_NAME_MAX_LENGTH=40;static FIRST_LINE_NAME_CANDIDATE_MAX_LENGTH=this.FIRST_LINE_NAME_MAX_LENGTH*10;static ACTIVE_EDITOR_LANGUAGE_ID="${activeEditorLanguage}";_onDidChangeContent=this._register(new D);onDidChangeContent=this._onDidChangeContent.event;_onDidChangeName=this._register(new D);onDidChangeName=this._onDidChangeName.event;_onDidChangeDirty=this._register(new D);onDidChangeDirty=this._onDidChangeDirty.event;_onDidChangeEncoding=this._register(new D);onDidChangeEncoding=this._onDidChangeEncoding.event;_onDidSave=this._register(new D);onDidSave=this._onDidSave.event;_onDidRevert=this._register(new D);onDidRevert=this._onDidRevert.event;typeId=LH;capabilities=2;configuredLabelFormat="content";cachedModelFirstLineWords=void 0;get name(){return this.configuredLabelFormat==="content"&&!this.hasAssociatedFilePath&&this.cachedModelFirstLineWords?this.cachedModelFirstLineWords:this.labelService.getUriBasenameLabel(this.resource)}registerListeners(){this._register(this.textResourceConfigurationService.onDidChangeConfiguration(t=>this.onConfigurationChange(t,!0)))}onConfigurationChange(t,n){if(!t||t.affectsConfiguration(this.resource,"files.encoding")){let i=this.textResourceConfigurationService.getValue(this.resource,"files.encoding");this.configuredEncoding!==i&&typeof i=="string"&&(this.configuredEncoding=i,n&&!this.preferredEncoding&&this._onDidChangeEncoding.fire())}if(!t||t.affectsConfiguration(this.resource,"workbench.editor.untitled.labelFormat")){let i=this.textResourceConfigurationService.getValue(this.resource,"workbench.editor.untitled.labelFormat");this.configuredLabelFormat!==i&&(i==="content"||i==="name")&&(this.configuredLabelFormat=i,n&&this._onDidChangeName.fire())}}setLanguageId(t,n){let i=t===qs.ACTIVE_EDITOR_LANGUAGE_ID?this.editorService.activeTextEditorLanguageId:t;this.preferredLanguageId=i,i&&super.setLanguageId(i,n)}getLanguageId(){return this.textEditorModel?this.textEditorModel.getLanguageId():this.preferredLanguageId}configuredEncoding;getEncoding(){return this.preferredEncoding||this.configuredEncoding}async setEncoding(t){let n=this.getEncoding();this.preferredEncoding=t,n!==this.preferredEncoding&&this._onDidChangeEncoding.fire()}dirty=this.hasAssociatedFilePath||!!this.initialValue;isDirty(){return this.dirty}isModified(){return this.isDirty()}setDirty(t){this.dirty!==t&&(this.dirty=t,this._onDidChangeDirty.fire())}async save(t){let n=await this.textFileService.save(this.resource,t);return n&&this._onDidSave.fire({reason:t?.reason,source:t?.source}),!!n}async revert(){this.ignoreDirtyOnModelContentChange=!0;try{this.updateTextEditorModel(sP(""))}finally{this.ignoreDirtyOnModelContentChange=!1}this.setDirty(!1),this._onDidRevert.fire()}async backup(t){let n;return this.isResolved()?n=await this.textFileService.getEncodedReadable(this.resource,this.createSnapshot()??void 0,{encoding:mP}):typeof this.initialValue=="string"&&(n=aF(vt.fromString(this.initialValue))),{content:n}}ignoreDirtyOnModelContentChange=!1;async resolve(){let t=!1,n=!1;if(this.textEditorModel)this.updateTextEditorModel(void 0,this.preferredLanguageId);else{let r,s=await this.workingCopyBackupService.resolve(this);s?(r=s.value,n=!0):r=lF(vt.fromString(this.initialValue||""));let a=await OU(await this.textFileService.getDecodedStream(this.resource,r,{encoding:mP}));this.createTextEditorModel(a,this.resource,this.preferredLanguageId),t=!0}let i=fn(this.textEditorModel);return this.installModelListeners(i),t&&((n||this.initialValue)&&this.updateNameFromFirstLine(i),this.setDirty(this.hasAssociatedFilePath||!!n||!!this.initialValue),(n||this.initialValue)&&this._onDidChangeContent.fire()),super.resolve()}installModelListeners(t){this._register(t.onDidChangeContent(n=>this.onModelContentChanged(t,n))),this._register(t.onDidChangeLanguage(()=>this.onConfigurationChange(void 0,!0))),super.installModelListeners(t)}onModelContentChanged(t,n){this.ignoreDirtyOnModelContentChange||(!this.hasAssociatedFilePath&&t.getLineCount()===1&&t.getLineLength(1)===0?this.setDirty(!1):this.setDirty(!0)),n.changes.some(i=>(i.range.startLineNumber===1||i.range.endLineNumber===1)&&i.range.startColumn<=qs.FIRST_LINE_NAME_CANDIDATE_MAX_LENGTH)&&this.updateNameFromFirstLine(t),this._onDidChangeContent.fire(),this.autoDetectLanguage()}updateNameFromFirstLine(t){if(this.hasAssociatedFilePath)return;let n,i=t.getValueInRange({startLineNumber:1,endLineNumber:1,startColumn:1,endColumn:qs.FIRST_LINE_NAME_CANDIDATE_MAX_LENGTH+1}).trim().replace(/\s+/g," ").replace(/\u202E/g,"");i=i.substr(0,dI(i,qs.FIRST_LINE_NAME_MAX_LENGTH)[0]),i&&Vf().exec(i)&&(n=i),n!==this.cachedModelFirstLineWords&&(this.cachedModelFirstLineWords=n,this._onDidChangeName.fire())}isReadonly(){return!1}};qs=O([x(5,Di),x(6,ls),x(7,ST),x(8,Hr),x(9,hc),x(10,BU),x(11,ax),x(12,Tn),x(13,CT),x(14,vo)],qs);var VU=Y("untitledTextEditorService"),Yu=class extends F{constructor(t,n){super();this.instantiationService=t;this.configurationService=n}static UNTITLED_WITHOUT_ASSOCIATED_RESOURCE_REGEX=/Untitled-\d+/;_onDidChangeDirty=this._register(new D);onDidChangeDirty=this._onDidChangeDirty.event;_onDidChangeEncoding=this._register(new D);onDidChangeEncoding=this._onDidChangeEncoding.event;_onDidCreate=this._register(new D);onDidCreate=this._onDidCreate.event;_onWillDispose=this._register(new D);onWillDispose=this._onWillDispose.event;_onDidChangeLabel=this._register(new D);onDidChangeLabel=this._onDidChangeLabel.event;mapResourceToModel=new Ui;get(t){return this.mapResourceToModel.get(t)}getValue(t){return this.get(t)?.textEditorModel?.getValue()}async resolve(t){let n=this.doCreateOrGet(t);return await n.resolve(),n}create(t){return this.doCreateOrGet(t)}doCreateOrGet(t=Object.create(null)){let n=this.massageOptions(t);return n.untitledResource&&this.mapResourceToModel.has(n.untitledResource)?this.mapResourceToModel.get(n.untitledResource):this.doCreate(n)}massageOptions(t){let n=Object.create(null);if(t.associatedResource?(n.untitledResource=J.from({scheme:Le.untitled,authority:t.associatedResource.authority,fragment:t.associatedResource.fragment,path:t.associatedResource.path,query:t.associatedResource.query}),n.associatedResource=t.associatedResource):t.untitledResource?.scheme===Le.untitled&&(n.untitledResource=t.untitledResource),t.languageId)n.languageId=t.languageId;else if(!n.associatedResource){let i=this.configurationService.getValue();i.files?.defaultLanguage&&(n.languageId=i.files.defaultLanguage)}return n.encoding=t.encoding,n.initialValue=t.initialValue,n}doCreate(t){let n=t.untitledResource;if(!n){let r=1;do n=J.from({scheme:Le.untitled,path:`Untitled-${r}`}),r++;while(this.mapResourceToModel.has(n))}let i=this._register(this.instantiationService.createInstance(qs,n,!!t.associatedResource,t.initialValue,t.languageId,t.encoding));return this.registerModel(i),i}registerModel(t){let n=new ee;n.add(t.onDidChangeDirty(()=>this._onDidChangeDirty.fire(t))),n.add(t.onDidChangeName(()=>this._onDidChangeLabel.fire(t))),n.add(t.onDidChangeEncoding(()=>this._onDidChangeEncoding.fire(t))),n.add(t.onWillDispose(()=>this._onWillDispose.fire(t))),q.once(t.onWillDispose)(()=>{this.mapResourceToModel.delete(t.resource),n.dispose()}),this.mapResourceToModel.set(t.resource,t),this._onDidCreate.fire(t),t.isDirty()&&this._onDidChangeDirty.fire(t)}isUntitledWithAssociatedResource(t){return t.scheme===Le.untitled&&t.path.length>1&&!Yu.UNTITLED_WITHOUT_ASSOCIATED_RESOURCE_REGEX.test(t.path)}canDispose(t){return t.isDisposed()?!0:this.doCanDispose(t)}async doCanDispose(t){return t.isDirty()?(await q.toPromise(t.onDidChangeDirty),this.canDispose(t)):!0}};Yu=O([x(0,Oe),x(1,ut)],Yu);$i(VU,Yu,1);var Mm=class extends F{constructor(t,n){super();this.logService=t;this.configurationService=n}participants=new zi;addFileOperationParticipant(t){let n=this.participants.push(t);return le(()=>n())}async participate(t,n,i,r){let s=this.configurationService.getValue("files.participants.timeout");if(!(typeof s!="number"||s<=0))for(let a of this.participants)try{await a.participate(t,n,i,s,r)}catch(l){this.logService.warn(l)}}dispose(){this.participants.clear(),super.dispose()}};Mm=O([x(0,Gt),x(1,ut)],Mm);var jo=class extends F{constructor(t,n,i,r){super();this.getExpression=t;this.shouldUpdate=n;this.contextService=i;this.configurationService=r;this.updateExpressions(!1),this.registerListeners()}static NO_FOLDER=null;_onExpressionChange=this._register(new D);onExpressionChange=this._onExpressionChange.event;mapFolderToParsedExpression=new Map;mapFolderToConfiguredExpression=new Map;registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(t=>{this.shouldUpdate(t)&&this.updateExpressions(!0)})),this._register(this.contextService.onDidChangeWorkspaceFolders(()=>this.updateExpressions(!0)))}updateExpressions(t){let n=!1;for(let a of this.contextService.getWorkspace().folders){let l=a.uri.toString(),d=this.doGetExpression(a.uri),c=this.mapFolderToConfiguredExpression.get(l);d?(!c||!Mn(c.expression,d.expression))&&(n=!0,this.mapFolderToParsedExpression.set(l,_L(d.expression)),this.mapFolderToConfiguredExpression.set(l,d)):c&&(n=!0,this.mapFolderToParsedExpression.delete(l),this.mapFolderToConfiguredExpression.delete(l))}let i=new Ap(this.contextService.getWorkspace().folders.map(a=>a.uri));for(let[a]of this.mapFolderToConfiguredExpression)a!==jo.NO_FOLDER&&(i.has(J.parse(a))||(this.mapFolderToParsedExpression.delete(a),this.mapFolderToConfiguredExpression.delete(a),n=!0));let r=this.doGetExpression(void 0),s=this.mapFolderToConfiguredExpression.get(jo.NO_FOLDER);r?(!s||!Mn(s.expression,r.expression))&&(n=!0,this.mapFolderToParsedExpression.set(jo.NO_FOLDER,_L(r.expression)),this.mapFolderToConfiguredExpression.set(jo.NO_FOLDER,r)):s&&(n=!0,this.mapFolderToParsedExpression.delete(jo.NO_FOLDER),this.mapFolderToConfiguredExpression.delete(jo.NO_FOLDER)),t&&n&&this._onExpressionChange.fire()}doGetExpression(t){let n=this.getExpression(t);if(!n)return;let i=Object.keys(n);if(i.length===0)return;let r=!1,s=Object.create(null);for(let a of i){r||(r=ND(a));let l=a,d=QA(l,!0);if(d){let c=d.toLowerCase();d!==d.toLowerCase()&&(l=`${c}${l.substring(1)}`)}s[l]=n[a]}return{expression:s,hasAbsolutePath:r}}matches(t,n){if(this.mapFolderToParsedExpression.size===0)return!1;let i=this.contextService.getWorkspaceFolder(t),r,s;if(i&&this.mapFolderToParsedExpression.has(i.uri.toString())?(r=this.mapFolderToParsedExpression.get(i.uri.toString()),s=this.mapFolderToConfiguredExpression.get(i.uri.toString())):(r=this.mapFolderToParsedExpression.get(jo.NO_FOLDER),s=this.mapFolderToConfiguredExpression.get(jo.NO_FOLDER)),!r)return!1;let a;return i?a=fI(i.uri,t):a=this.uriToPath(t),typeof a=="string"&&r(a,void 0,n)?!0:a!==this.uriToPath(t)&&s?.hasAbsolutePath?!!r(this.uriToPath(t),void 0,n):!1}uriToPath(t){return t.scheme===Le.file?t.fsPath:t.path}};jo=O([x(2,Dd),x(3,ut)],jo);var fG=new $("autoSaveAfterShortDelayContext",!1,!0);var gP=Y("filesConfigurationService"),qo=class extends F{constructor(t,n,i,r,s,a,l,d){super();this.contextKeyService=t;this.configurationService=n;this.contextService=i;this.environmentService=r;this.uriIdentityService=s;this.fileService=a;this.markerService=l;this.textResourceConfigurationService=d;let c=n.getValue();this.currentGlobalAutoSaveConfiguration=this.computeAutoSaveConfiguration(void 0,c.files),this.currentFilesAssociationConfiguration=c?.files?.associations,this.currentHotExitConfiguration=c?.files?.hotExit||Jp.ON_EXIT,this.onFilesConfigurationChange(c,!1),this.registerListeners()}static DEFAULT_AUTO_SAVE_MODE=Hn?Ts.AFTER_DELAY:Ts.OFF;static DEFAULT_AUTO_SAVE_DELAY=1e3;static READONLY_MESSAGES={providerReadonly:{value:m("providerReadonly","Editor is read-only because the file system of the file is read-only."),isTrusted:!0},sessionReadonly:{value:m({key:"sessionReadonly",comment:['Please do not translate the word "command", it is part of our internal syntax which must not change','{Locked="](command:{0})"}']},"Editor is read-only because the file was set read-only in this session. [Click here](command:{0}) to set writeable.","workbench.action.files.setActiveEditorWriteableInSession"),isTrusted:!0},configuredReadonly:{value:m({key:"configuredReadonly",comment:['Please do not translate the word "command", it is part of our internal syntax which must not change','{Locked="](command:{0})"}']},"Editor is read-only because the file was set read-only via settings. [Click here](command:{0}) to configure or [toggle for this session](command:{1}).",`workbench.action.openSettings?${encodeURIComponent('["files.readonly"]')}`,"workbench.action.files.toggleActiveEditorReadonlyInSession"),isTrusted:!0},fileLocked:{value:m({key:"fileLocked",comment:['Please do not translate the word "command", it is part of our internal syntax which must not change','{Locked="](command:{0})"}']},"Editor is read-only because of file permissions. [Click here](command:{0}) to set writeable anyway.","workbench.action.files.setActiveEditorWriteableInSession"),isTrusted:!0},fileReadonly:{value:m("fileReadonly","Editor is read-only because the file is read-only."),isTrusted:!0}};_onDidChangeAutoSaveConfiguration=this._register(new D);onDidChangeAutoSaveConfiguration=this._onDidChangeAutoSaveConfiguration.event;_onDidChangeAutoSaveDisabled=this._register(new D);onDidChangeAutoSaveDisabled=this._onDidChangeAutoSaveDisabled.event;_onDidChangeFilesAssociation=this._register(new D);onDidChangeFilesAssociation=this._onDidChangeFilesAssociation.event;_onDidChangeReadonly=this._register(new D);onDidChangeReadonly=this._onDidChangeReadonly.event;currentGlobalAutoSaveConfiguration;currentFilesAssociationConfiguration;currentHotExitConfiguration;autoSaveConfigurationCache=new Jo(1e3);autoSaveDisabledOverrides=new Ui;autoSaveAfterShortDelayContext=fG.bindTo(this.contextKeyService);readonlyIncludeMatcher=this._register(new Tf(()=>this.createReadonlyMatcher(AF)));readonlyExcludeMatcher=this._register(new Tf(()=>this.createReadonlyMatcher(FF)));configuredReadonlyFromPermissions;sessionReadonlyOverrides=new Ui(t=>this.uriIdentityService.extUri.getComparisonKey(t));createReadonlyMatcher(t){let n=this._register(new jo(i=>this.configurationService.getValue(t,{resource:i}),i=>i.affectsConfiguration(t),this.contextService,this.configurationService));return this._register(n.onExpressionChange(()=>this._onDidChangeReadonly.fire())),n}isReadonly(t,n){let i=this.fileService.getProvider(t.scheme);if(i&&OF(i))return i.readOnlyMessage??qo.READONLY_MESSAGES.providerReadonly;let r=this.sessionReadonlyOverrides.get(t);return typeof r=="boolean"?r===!0?qo.READONLY_MESSAGES.sessionReadonly:!1:this.uriIdentityService.extUri.isEqualOrParent(t,this.environmentService.userRoamingDataHome)||this.uriIdentityService.extUri.isEqual(t,this.contextService.getWorkspace().configuration??void 0)?!1:this.readonlyIncludeMatcher.value.matches(t)?this.readonlyExcludeMatcher.value.matches(t)?!1:qo.READONLY_MESSAGES.configuredReadonly:this.configuredReadonlyFromPermissions&&n?.locked?qo.READONLY_MESSAGES.fileLocked:n?.readonly?qo.READONLY_MESSAGES.fileReadonly:!1}async updateReadonly(t,n){if(n==="toggle"){let i;try{i=await this.fileService.resolve(t,{resolveMetadata:!0})}catch{}n=!this.isReadonly(t,i)}n==="reset"?this.sessionReadonlyOverrides.delete(t):this.sessionReadonlyOverrides.set(t,n),this._onDidChangeReadonly.fire()}registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(t=>{t.affectsConfiguration("files")&&this.onFilesConfigurationChange(this.configurationService.getValue(),!0)}))}onFilesConfigurationChange(t,n){this.currentGlobalAutoSaveConfiguration=this.computeAutoSaveConfiguration(void 0,t.files),this.autoSaveConfigurationCache.clear(),this.autoSaveAfterShortDelayContext.set(this.getAutoSaveMode(void 0).mode===1),n&&this._onDidChangeAutoSaveConfiguration.fire();let i=t?.files?.associations;Mn(this.currentFilesAssociationConfiguration,i)||(this.currentFilesAssociationConfiguration=i,n&&this._onDidChangeFilesAssociation.fire());let r=t?.files?.hotExit;r===Jp.OFF||r===Jp.ON_EXIT_AND_WINDOW_CLOSE?this.currentHotExitConfiguration=r:this.currentHotExitConfiguration=Jp.ON_EXIT;let s=!!t?.files?.readonlyFromPermissions;s!==!!this.configuredReadonlyFromPermissions&&(this.configuredReadonlyFromPermissions=s,n&&this._onDidChangeReadonly.fire())}getAutoSaveConfiguration(t){let n=this.toResource(t);if(n){let i=this.autoSaveConfigurationCache.get(n);return i||(i=this.computeAutoSaveConfiguration(n,this.textResourceConfigurationService.getValue(n,"files")),this.autoSaveConfigurationCache.set(n,i)),i}return this.currentGlobalAutoSaveConfiguration}computeAutoSaveConfiguration(t,n){let i,r,s,a,l,d;switch(n?.autoSave??qo.DEFAULT_AUTO_SAVE_MODE){case Ts.AFTER_DELAY:{i="afterDelay",r=typeof n?.autoSaveDelay=="number"&&n.autoSaveDelay>=0?n.autoSaveDelay:qo.DEFAULT_AUTO_SAVE_DELAY,d=r<=qo.DEFAULT_AUTO_SAVE_DELAY;break}case Ts.ON_FOCUS_CHANGE:i="onFocusChange";break;case Ts.ON_WINDOW_CHANGE:i="onWindowChange";break}return n?.autoSaveWorkspaceFilesOnly===!0&&(s=!0,t&&!this.contextService.isInsideWorkspace(t)&&(l=!0,d=void 0)),n?.autoSaveWhenNoErrors===!0&&(a=!0,d=void 0),{autoSave:i,autoSaveDelay:r,autoSaveWorkspaceFilesOnly:s,autoSaveWhenNoErrors:a,isOutOfWorkspace:l,isShortAutoSaveDelay:d}}toResource(t){return t instanceof Kl?Ks.getOriginalUri(t,{supportSideBySide:1}):t}hasShortAutoSaveDelay(t){let n=this.toResource(t);return this.getAutoSaveConfiguration(n).isShortAutoSaveDelay?!n||!this.autoSaveDisabledOverrides.has(n):!1}getAutoSaveMode(t,n){let i=this.toResource(t);if(i&&this.autoSaveDisabledOverrides.has(i))return{mode:0,reason:4};let r=this.getAutoSaveConfiguration(i);if(typeof r.autoSave>"u")return{mode:0,reason:1};if(typeof n=="number"&&(r.autoSave==="afterDelay"&&n!==2||r.autoSave==="onFocusChange"&&n!==3&&n!==4||r.autoSave==="onWindowChange"&&n!==4))return{mode:0,reason:1};if(i){if(r.autoSaveWorkspaceFilesOnly&&r.isOutOfWorkspace)return{mode:0,reason:2};if(r.autoSaveWhenNoErrors&&this.markerService.read({resource:i,take:1,severities:8}).length>0)return{mode:0,reason:3}}switch(r.autoSave){case"afterDelay":return typeof r.autoSaveDelay=="number"&&r.autoSaveDelay<=qo.DEFAULT_AUTO_SAVE_DELAY?{mode:r.autoSaveWhenNoErrors?2:1}:{mode:2};case"onFocusChange":return{mode:3};case"onWindowChange":return{mode:4}}}async toggleAutoSave(){let t=this.configurationService.getValue("files.autoSave"),n;return[Ts.AFTER_DELAY,Ts.ON_FOCUS_CHANGE,Ts.ON_WINDOW_CHANGE].some(i=>i===t)?n=Ts.OFF:n=Ts.AFTER_DELAY,this.configurationService.updateValue("files.autoSave",n)}disableAutoSave(t){let n=this.toResource(t);if(!n)return F.None;let i=this.autoSaveDisabledOverrides.get(n)??0;return this.autoSaveDisabledOverrides.set(n,i+1),i===0&&this._onDidChangeAutoSaveDisabled.fire(n),le(()=>{let r=this.autoSaveDisabledOverrides.get(n)??0;r<=1?(this.autoSaveDisabledOverrides.delete(n),this._onDidChangeAutoSaveDisabled.fire(n)):this.autoSaveDisabledOverrides.set(n,r-1)})}get isHotExitEnabled(){return this.contextService.getWorkspace().transient?!1:this.currentHotExitConfiguration!==Jp.OFF}get hotExitConfiguration(){return this.currentHotExitConfiguration}preventSaveConflicts(t,n){return this.configurationService.getValue("files.saveConflictResolution",{resource:t,overrideIdentifier:n})!=="overwriteFileOnDisk"}};qo=O([x(0,_t),x(1,ut),x(2,Dd),x(3,Mo),x(4,eo),x(5,Bt),x(6,_B),x(7,Hr)],qo);$i(gP,qo,0);var fP=Y("workingCopyEditorService"),Cv=class extends F{constructor(t){super();this.editorService=t}_onDidRegisterHandler=this._register(new D);onDidRegisterHandler=this._onDidRegisterHandler.event;handlers=new Set;registerHandler(t){return this.handlers.add(t),this._onDidRegisterHandler.fire(t),le(()=>this.handlers.delete(t))}findEditor(t){for(let n of this.editorService.getEditors(0))if(this.isOpen(t,n.editor))return n}isOpen(t,n){for(let i of this.handlers)if(i.isOpen(t,n))return!0;return!1}};Cv=O([x(0,Tn)],Cv);$i(fP,Cv,1);var WU=Y("elevatedFileService");var Pm=class extends F{constructor(t,n){super();this.resource=t;this.fileService=n;this._register(this.fileService.onDidFilesChange(i=>this.onDidFilesChange(i)))}_onDidChangeOrphaned=this._register(new D);onDidChangeOrphaned=this._onDidChangeOrphaned.event;orphaned=!1;isOrphaned(){return this.orphaned}async onDidFilesChange(t){let n=!1,i;if(this.orphaned?t.contains(this.resource,1)&&(i=!1,n=!0):t.contains(this.resource,2)&&(i=!0,n=!0),n&&this.orphaned!==i){let r=!1;i&&(await wi(100,sn.None),this.isDisposed()?r=!0:r=!await this.fileService.exists(this.resource)),this.orphaned!==r&&!this.isDisposed()&&this.setOrphaned(r)}}setOrphaned(t){this.orphaned!==t&&(this.orphaned=t,this._onDidChangeOrphaned.fire())}_onWillDispose=this._register(new D);onWillDispose=this._onWillDispose.event;isDisposed(){return this._store.isDisposed}dispose(){this.orphaned=!1,this._onWillDispose.fire(),super.dispose()}isModified(){return this.isDirty()}};Pm=O([x(1,Bt)],Pm);var Zu=class extends Pm{constructor(t,n,i,r,s,a,l,d,c,u,p,h,f,g,b,v){super(n,a);this.typeId=t;this.name=i;this.modelFactory=r;this.externalResolver=s;this.logService=l;this.workingCopyFileService=d;this.filesConfigurationService=c;this.workingCopyBackupService=u;this.notificationService=h;this.workingCopyEditorService=f;this.editorService=g;this.elevatedFileService=b;this.progressService=v;this._register(p.registerWorkingCopy(this)),this.registerListeners()}capabilities=0;_model=void 0;get model(){return this._model}_onDidChangeContent=this._register(new D);onDidChangeContent=this._onDidChangeContent.event;_onDidResolve=this._register(new D);onDidResolve=this._onDidResolve.event;_onDidChangeDirty=this._register(new D);onDidChangeDirty=this._onDidChangeDirty.event;_onDidSaveError=this._register(new D);onDidSaveError=this._onDidSaveError.event;_onDidSave=this._register(new D);onDidSave=this._onDidSave.event;_onDidRevert=this._register(new D);onDidRevert=this._onDidRevert.event;_onDidChangeReadonly=this._register(new D);onDidChangeReadonly=this._onDidChangeReadonly.event;registerListeners(){this._register(this.filesConfigurationService.onDidChangeReadonly(()=>this._onDidChangeReadonly.fire()))}dirty=!1;savedVersionId;isDirty(){return this.dirty}markModified(){this.setDirty(!0)}setDirty(t){if(!this.isResolved())return;let n=this.dirty;this.doSetDirty(t),t!==n&&this._onDidChangeDirty.fire()}doSetDirty(t){let n=this.dirty,i=this.inConflictMode,r=this.inErrorMode,s=this.savedVersionId;return t?this.dirty=!0:(this.dirty=!1,this.inConflictMode=!1,this.inErrorMode=!1,this.isResolved()&&(this.savedVersionId=this.model.versionId)),()=>{this.dirty=n,this.inConflictMode=i,this.inErrorMode=r,this.savedVersionId=s}}lastResolvedFileStat;isResolved(){return!!this.model}async resolve(t){if(this.trace("resolve() - enter"),this.isDisposed()){this.trace("resolve() - exit - without resolving because file working copy is disposed");return}if(!t?.contents&&(this.dirty||this.saveSequentializer.isRunning())){this.trace("resolve() - exit - without resolving because file working copy is dirty or being saved");return}return this.doResolve(t)}async doResolve(t){if(t?.contents)return this.resolveFromBuffer(t.contents);if(!(!this.isResolved()&&await this.resolveFromBackup()))return this.resolveFromFile(t)}async resolveFromBuffer(t){this.trace("resolveFromBuffer()");let n,i,r,s;try{let a=await this.fileService.stat(this.resource);n=a.mtime,i=a.ctime,r=a.size,s=a.etag,this.setOrphaned(!1)}catch(a){n=Date.now(),i=Date.now(),r=0,s=Lf,this.setOrphaned(a.fileOperationResult===1)}return this.resolveFromContent({resource:this.resource,name:this.name,mtime:n,ctime:i,size:r,etag:s,value:t,readonly:!1,locked:!1},!0)}async resolveFromBackup(){let t=await this.workingCopyBackupService.resolve(this);return this.isResolved()?(this.trace("resolveFromBackup() - exit - withoutresolving because previously new file working copy got created meanwhile"),!0):t?(await this.doResolveFromBackup(t),!0):!1}async doResolveFromBackup(t){this.trace("doResolveFromBackup()"),await this.resolveFromContent({resource:this.resource,name:this.name,mtime:t.meta?t.meta.mtime:Date.now(),ctime:t.meta?t.meta.ctime:Date.now(),size:t.meta?t.meta.size:0,etag:t.meta?t.meta.etag:Lf,value:t.value,readonly:!1,locked:!1},!0),t.meta&&t.meta.orphaned&&this.setOrphaned(!0)}async resolveFromFile(t){this.trace("resolveFromFile()");let n=t?.forceReadFromFile,i;n?i=Lf:this.lastResolvedFileStat&&(i=this.lastResolvedFileStat.etag);let r=this.versionId;try{let s=await this.fileService.readFileStream(this.resource,{etag:i,limits:t?.limits});if(this.setOrphaned(!1),r!==this.versionId){this.trace("resolveFromFile() - exit - without resolving because file working copy content changed");return}await this.resolveFromContent(s,!1)}catch(s){let a=s.fileOperationResult;if(this.setOrphaned(a===1),this.isResolved()&&a===2){s instanceof NI&&this.updateLastResolvedFileStat(s.stat);return}if(this.isResolved()&&a===1&&!n)return;throw s}}async resolveFromContent(t,n){if(this.trace("resolveFromContent() - enter"),this.isDisposed()){this.trace("resolveFromContent() - exit - because working copy is disposed");return}this.updateLastResolvedFileStat({resource:this.resource,name:t.name,mtime:t.mtime,ctime:t.ctime,size:t.size,etag:t.etag,readonly:t.readonly,locked:t.locked,isFile:!0,isDirectory:!1,isSymbolicLink:!1,children:void 0}),this.isResolved()?await this.doUpdateModel(t.value):await this.doCreateModel(t.value),this.setDirty(!!n),this._onDidResolve.fire()}async doCreateModel(t){this.trace("doCreateModel()"),this._model=this._register(await this.modelFactory.createModel(this.resource,t,sn.None)),this.installModelListeners(this._model)}ignoreDirtyOnModelContentChange=!1;async doUpdateModel(t){this.trace("doUpdateModel()"),this.ignoreDirtyOnModelContentChange=!0;try{await this.model?.update(t,sn.None)}finally{this.ignoreDirtyOnModelContentChange=!1}}installModelListeners(t){this._register(t.onDidChangeContent(n=>this.onModelContentChanged(t,n.isUndoing||n.isRedoing))),this._register(t.onWillDispose(()=>this.dispose()))}onModelContentChanged(t,n){if(this.trace("onModelContentChanged() - enter"),this.versionId++,this.trace(`onModelContentChanged() - new versionId ${this.versionId}`),n&&(this.lastContentChangeFromUndoRedo=Date.now()),!this.ignoreDirtyOnModelContentChange&&!this.isReadonly())if(t.versionId===this.savedVersionId){this.trace("onModelContentChanged() - model content changed back to last saved version");let i=this.dirty;this.setDirty(!1),i&&this._onDidRevert.fire()}else this.trace("onModelContentChanged() - model content changed and marked as dirty"),this.setDirty(!0);this._onDidChangeContent.fire()}async forceResolveFromFile(){this.isDisposed()||await this.externalResolver({forceReadFromFile:!0})}get backupDelay(){return this.model?.configuration?.backupDelay}async backup(t){let n;this.lastResolvedFileStat&&(n={mtime:this.lastResolvedFileStat.mtime,ctime:this.lastResolvedFileStat.ctime,size:this.lastResolvedFileStat.size,etag:this.lastResolvedFileStat.etag,orphaned:this.isOrphaned()});let i;return this.isResolved()&&(i=await xf(this.model.snapshot(2,t),t)),{meta:n,content:i}}versionId=0;static UNDO_REDO_SAVE_PARTICIPANTS_AUTO_SAVE_THROTTLE_THRESHOLD=500;lastContentChangeFromUndoRedo=void 0;saveSequentializer=new EI;ignoreSaveFromSaveParticipants=!1;async save(t=Object.create(null)){return this.isResolved()?this.isReadonly()?(this.trace("save() - ignoring request for readonly resource"),!1):(this.hasState(3)||this.hasState(5))&&(t.reason===2||t.reason===3||t.reason===4)?(this.trace("save() - ignoring auto save request for file working copy that is in conflict or error"),!1):(this.trace("save() - enter"),await this.doSave(t),this.trace("save() - exit"),this.hasState(0)):!1}async doSave(t){typeof t.reason!="number"&&(t.reason=1);let n=this.versionId;if(this.trace(`doSave(${n}) - enter with versionId ${n}`),this.ignoreSaveFromSaveParticipants){this.trace(`doSave(${n}) - exit - refusing to save() recursively from save participant`);return}if(this.saveSequentializer.isRunning(n))return this.trace(`doSave(${n}) - exit - found a running save for versionId ${n}`),this.saveSequentializer.running;if(!t.force&&!this.dirty){this.trace(`doSave(${n}) - exit - because not dirty and/or versionId is different (this.isDirty: ${this.dirty}, this.versionId: ${this.versionId})`);return}if(this.saveSequentializer.isRunning())return this.trace(`doSave(${n}) - exit - because busy saving`),this.saveSequentializer.cancelRunning(),this.saveSequentializer.queue(()=>this.doSave(t));this.isResolved()&&this.model.pushStackElement();let i=new zn;return this.progressService.withProgress({title:m("saveParticipants","Saving '{0}'",this.name),location:10,cancellable:!0,delay:this.isDirty()?3e3:5e3},r=>this.doSaveSequential(n,t,r,i),()=>{i.cancel()}).finally(()=>{i.dispose()})}doSaveSequential(t,n,i,r){return this.saveSequentializer.run(t,(async()=>{if(this.isResolved()&&!n.skipSaveParticipants&&this.workingCopyFileService.hasSaveParticipants)try{if(n.reason===2&&typeof this.lastContentChangeFromUndoRedo=="number"){let l=Date.now()-this.lastContentChangeFromUndoRedo;l<Zu.UNDO_REDO_SAVE_PARTICIPANTS_AUTO_SAVE_THROTTLE_THRESHOLD&&await wi(Zu.UNDO_REDO_SAVE_PARTICIPANTS_AUTO_SAVE_THROTTLE_THRESHOLD-l)}if(!r.token.isCancellationRequested){this.ignoreSaveFromSaveParticipants=!0;try{await this.workingCopyFileService.runSaveParticipants(this,{reason:n.reason??1,savedFrom:n.from},i,r.token)}finally{this.ignoreSaveFromSaveParticipants=!1}}}catch(l){this.logService.error(`[stored file working copy] runSaveParticipants(${t}) - resulted in an error: ${l.toString()}`,this.resource.toString(),this.typeId)}if(r.token.isCancellationRequested||this.isDisposed()||!this.isResolved())return;t=this.versionId,this.inErrorMode=!1,i.report({message:m("saveTextFile","Writing into file...")}),this.trace(`doSave(${t}) - before write()`);let s=fn(this.lastResolvedFileStat),a=this;return this.saveSequentializer.run(t,(async()=>{try{let l={mtime:s.mtime,etag:n.ignoreModifiedSince||!this.filesConfigurationService.preventSaveConflicts(s.resource)?Lf:s.etag,unlock:n.writeUnlock},d;if(typeof a.model.save=="function")try{d=await a.model.save(l,r.token)}catch(c){if(r.token.isCancellationRequested)return;throw c}else{let c=await xf(a.model.snapshot(1,r.token),r.token);if(r.token.isCancellationRequested)return;r.dispose(),n?.writeElevated&&this.elevatedFileService.isSupported(s.resource)?d=await this.elevatedFileService.writeFileElevated(s.resource,fn(c),l):d=await this.fileService.writeFile(s.resource,fn(c),l)}this.handleSaveSuccess(d,t,n)}catch(l){this.handleSaveError(l,t,n)}})(),()=>r.cancel())})(),()=>r.cancel())}handleSaveSuccess(t,n,i){this.updateLastResolvedFileStat(t),n===this.versionId?(this.trace(`handleSaveSuccess(${n}) - setting dirty to false because versionId did not change`),this.setDirty(!1)):this.trace(`handleSaveSuccess(${n}) - not setting dirty to false because versionId did change meanwhile`),this.setOrphaned(!1),this._onDidSave.fire({reason:i.reason,stat:t,source:i.source})}handleSaveError(t,n,i){if((i.ignoreErrorHandler?this.logService.trace:this.logService.error).apply(this.logService,[`[stored file working copy] handleSaveError(${n}) - exit - resulted in a save error: ${t.toString()}`,this.resource.toString(),this.typeId]),i.ignoreErrorHandler)throw t;this.setDirty(!0),this.inErrorMode=!0,t.fileOperationResult===3&&(this.inConflictMode=!0),this.doHandleSaveError(t,i),this._onDidSaveError.fire()}doHandleSaveError(t,n){let i=t,r=[],s;if(i.fileOperationResult===3)s=m("staleSaveError","Failed to save '{0}': The content of the file is newer. Do you want to overwrite the file with your changes?",this.name),r.push(xi({id:"fileWorkingCopy.overwrite",label:m("overwrite","Overwrite"),run:()=>this.save({...n,ignoreModifiedSince:!0,reason:1})})),r.push(xi({id:"fileWorkingCopy.revert",label:m("revert","Revert"),run:()=>this.revert()}));else{let d=i.fileOperationResult===5,c=d&&i.options?.unlock,u=i.fileOperationResult===6,p=this.elevatedFileService.isSupported(this.resource);BL(t)&&r.push(...t.actions),p&&(u||c)?r.push(xi({id:"fileWorkingCopy.saveElevated",label:c?pt?m("overwriteElevated","Overwrite as Admin..."):m("overwriteElevatedSudo","Overwrite as Sudo..."):pt?m("saveElevated","Retry as Admin..."):m("saveElevatedSudo","Retry as Sudo..."),run:()=>{this.save({...n,writeElevated:!0,writeUnlock:c,reason:1})}})):d?r.push(xi({id:"fileWorkingCopy.unlock",label:m("overwrite","Overwrite"),run:()=>this.save({...n,writeUnlock:!0,reason:1})})):r.push(xi({id:"fileWorkingCopy.retry",label:m("retry","Retry"),run:()=>this.save({...n,reason:1})})),r.push(xi({id:"fileWorkingCopy.saveAs",label:m("saveAs","Save As..."),run:async()=>{let h=this.workingCopyEditorService.findEditor(this);h&&((await this.editorService.save(h,{saveAs:!0,reason:1})).success||this.doHandleSaveError(t,n))}})),r.push(xi({id:"fileWorkingCopy.revert",label:m("revert","Revert"),run:()=>this.revert()})),d?c&&p?s=pt?m("readonlySaveErrorAdmin","Failed to save '{0}': File is read-only. Select 'Overwrite as Admin' to retry as administrator.",this.name):m("readonlySaveErrorSudo","Failed to save '{0}': File is read-only. Select 'Overwrite as Sudo' to retry as superuser.",this.name):s=m("readonlySaveError","Failed to save '{0}': File is read-only. Select 'Overwrite' to attempt to make it writeable.",this.name):p&&u?s=pt?m("permissionDeniedSaveError","Failed to save '{0}': Insufficient permissions. Select 'Retry as Admin' to retry as administrator.",this.name):m("permissionDeniedSaveErrorSudo","Failed to save '{0}': Insufficient permissions. Select 'Retry as Sudo' to retry as superuser.",this.name):s=m({key:"genericSaveError",comment:["{0} is the resource that failed to save and {1} the error message"]},"Failed to save '{0}': {1}",this.name,FI(t,!1))}let a=this.notificationService.notify({id:`${Zr(this.resource.toString())}`,severity:UC.Error,message:s,actions:{primary:r}}),l=this._register(q.once(q.any(this.onDidSave,this.onDidRevert))(()=>a.close()));this._register(q.once(a.onDidClose)(()=>l.dispose()))}updateLastResolvedFileStat(t){let n=this.isReadonly();this.lastResolvedFileStat?this.lastResolvedFileStat.mtime<=t.mtime?this.lastResolvedFileStat=t:this.lastResolvedFileStat={...this.lastResolvedFileStat,readonly:t.readonly,locked:t.locked}:this.lastResolvedFileStat=t,this.isReadonly()!==n&&this._onDidChangeReadonly.fire()}async revert(t){if(!this.isResolved()||!this.dirty&&!t?.force)return;this.trace("revert()");let n=this.dirty,i=this.doSetDirty(!1);if(!t?.soft)try{await this.forceResolveFromFile()}catch(s){if(s.fileOperationResult!==1)throw i(),s}this._onDidRevert.fire(),n&&this._onDidChangeDirty.fire()}inConflictMode=!1;inErrorMode=!1;hasState(t){switch(t){case 3:return this.inConflictMode;case 1:return this.dirty;case 5:return this.inErrorMode;case 4:return this.isOrphaned();case 2:return this.saveSequentializer.isRunning();case 0:return!this.dirty}}async joinState(t){return this.saveSequentializer.running}isReadonly(){return this.filesConfigurationService.isReadonly(this.resource,this.lastResolvedFileStat)}trace(t){this.logService.trace(`[stored file working copy] ${t}`,this.resource.toString(),this.typeId)}dispose(){this.trace("dispose()"),this.inConflictMode=!1,this.inErrorMode=!1,this._model=void 0,super.dispose()}};Zu=O([x(5,Bt),x(6,Gt),x(7,bP),x(8,gP),x(9,ST),x(10,hc),x(11,fu),x(12,fP),x(13,Tn),x(14,WU),x(15,b0)],Zu);var Om=class extends F{constructor(t){super();this.logService=t}saveParticipants=[];get length(){return this.saveParticipants.length}addSaveParticipant(t){let n=wy(this.saveParticipants,t);return le(()=>n())}async participate(t,n,i,r){t.model?.pushStackElement();for(let s of this.saveParticipants){if(r.isCancellationRequested||t.isDisposed())break;try{let a=s.participate(t,n,i,r);await xf(a,r)}catch(a){this.logService.warn(a)}}t.model?.pushStackElement()}dispose(){this.saveParticipants.splice(0,this.saveParticipants.length),super.dispose()}};Om=O([x(0,Gt)],Om);var bP=Y("workingCopyFileService"),Sv=class extends F{constructor(t,n,i,r){super();this.fileService=t;this.workingCopyService=n;this.instantiationService=i;this.uriIdentityService=r;this._register(this.registerWorkingCopyProvider(s=>this.workingCopyService.workingCopies.filter(a=>this.fileService.hasProvider(s)?this.uriIdentityService.extUri.isEqualOrParent(a.resource,s):this.uriIdentityService.extUri.isEqual(a.resource,s))))}_onWillRunWorkingCopyFileOperation=this._register(new Kp);onWillRunWorkingCopyFileOperation=this._onWillRunWorkingCopyFileOperation.event;_onDidFailWorkingCopyFileOperation=this._register(new Kp);onDidFailWorkingCopyFileOperation=this._onDidFailWorkingCopyFileOperation.event;_onDidRunWorkingCopyFileOperation=this._register(new Kp);onDidRunWorkingCopyFileOperation=this._onDidRunWorkingCopyFileOperation.event;correlationIds=0;create(t,n,i){return this.doCreateFileOrFolder(t,!0,n,i)}createFolder(t,n,i){return this.doCreateFileOrFolder(t,!1,n,i)}async doCreateFileOrFolder(t,n,i,r){if(t.length===0)return[];if(n){let c=(await Po.settled(t.map(u=>this.fileService.canCreateFile(u.resource,{overwrite:u.overwrite})))).find(u=>u instanceof Error);if(c instanceof Error)throw c}let s=t.map(d=>({target:d.resource}));await this.runFileOperationParticipants(s,0,r,i);let a={correlationId:this.correlationIds++,operation:0,files:s};await this._onWillRunWorkingCopyFileOperation.fireAsync(a,sn.None);let l;try{n?l=await Po.settled(t.map(d=>this.fileService.createFile(d.resource,d.contents,{overwrite:d.overwrite}))):l=await Po.settled(t.map(d=>this.fileService.createFolder(d.resource)))}catch(d){throw await this._onDidFailWorkingCopyFileOperation.fireAsync(a,sn.None),d}return await this._onDidRunWorkingCopyFileOperation.fireAsync(a,sn.None),l}async move(t,n,i){return this.doMoveOrCopy(t,!0,n,i)}async copy(t,n,i){return this.doMoveOrCopy(t,!1,n,i)}async doMoveOrCopy(t,n,i,r){let s=[];for(let{file:{source:d,target:c},overwrite:u}of t){let p=await(n?this.fileService.canMove(d,c,u):this.fileService.canCopy(d,c,u));if(p instanceof Error)throw p}let a=t.map(d=>d.file);await this.runFileOperationParticipants(a,n?2:3,r,i);let l={correlationId:this.correlationIds++,operation:n?2:3,files:a};await this._onWillRunWorkingCopyFileOperation.fireAsync(l,sn.None);try{for(let{file:{source:d,target:c},overwrite:u}of t){if(!this.uriIdentityService.extUri.isEqual(d,c)){let p=n?[...this.getDirty(d),...this.getDirty(c)]:this.getDirty(c);await Po.settled(p.map(h=>h.revert({soft:!0})))}n?s.push(await this.fileService.move(d,c,u)):s.push(await this.fileService.copy(d,c,u))}}catch(d){throw await this._onDidFailWorkingCopyFileOperation.fireAsync(l,sn.None),d}return await this._onDidRunWorkingCopyFileOperation.fireAsync(l,sn.None),s}async delete(t,n,i){for(let a of t){let l=await this.fileService.canDelete(a.resource,{recursive:a.recursive,useTrash:a.useTrash});if(l instanceof Error)throw l}let r=t.map(a=>({target:a.resource}));await this.runFileOperationParticipants(r,1,i,n);let s={correlationId:this.correlationIds++,operation:1,files:r};await this._onWillRunWorkingCopyFileOperation.fireAsync(s,sn.None);for(let a of t){let l=this.getDirty(a.resource);await Po.settled(l.map(d=>d.revert({soft:!0})))}try{for(let a of t)await this.fileService.del(a.resource,{recursive:a.recursive,useTrash:a.useTrash})}catch(a){throw await this._onDidFailWorkingCopyFileOperation.fireAsync(s,sn.None),a}await this._onDidRunWorkingCopyFileOperation.fireAsync(s,sn.None)}fileOperationParticipants=this._register(this.instantiationService.createInstance(Mm));addFileOperationParticipant(t){return this.fileOperationParticipants.addFileOperationParticipant(t)}runFileOperationParticipants(t,n,i,r){return this.fileOperationParticipants.participate(t,n,i,r)}saveParticipants=this._register(this.instantiationService.createInstance(Om));get hasSaveParticipants(){return this.saveParticipants.length>0}addSaveParticipant(t){return this.saveParticipants.addSaveParticipant(t)}runSaveParticipants(t,n,i,r){return this.saveParticipants.participate(t,n,i,r)}workingCopyProviders=[];registerWorkingCopyProvider(t){let n=wy(this.workingCopyProviders,t);return le(n)}getDirty(t){let n=new Set;for(let i of this.workingCopyProviders)for(let r of i(t))r.isDirty()&&n.add(r);return Array.from(n)}};Sv=O([x(0,Bt),x(1,hc),x(2,Oe),x(3,eo)],Sv);$i(bP,Sv,1);var BU=Y("textFileService");var vP={WIDTH:400,WIDTH_WITH_VERTICAL_PANEL:600,HEIGHT:270};var yP=".vscode",yG="settings",lmt=`${yP}/${yG}.json`;var dmt=[1],cmt=[2,3,4,5,6],IG=[3,4,5],umt=[1,...IG],pmt=[2,3,4,5,6],CG=[3,4,5,6],SG=[4,5,6],cx="tasks",HU="launch",UU=Object.create(null);UU[cx]=`${yP}/${cx}.json`;UU[HU]=`${yP}/${HU}.json`;var EG=Object.create(null);EG[cx]=`${cx}.json`;var hmt=ut;var IP=class extends xa{_currentResultGroups=new Map;updateResultGroup(e,t){return t?this._currentResultGroups.set(e,t):this._currentResultGroups.delete(e),this.removeDuplicateResults(),this.update()}removeDuplicateResults(){let e=new Set;[...this._currentResultGroups.keys()].sort((t,n)=>this._currentResultGroups.get(t).order-this._currentResultGroups.get(n).order).forEach(t=>{let n=this._currentResultGroups.get(t);n.result.filterMatches=n.result.filterMatches.filter(i=>!e.has(i.setting.key)),n.result.filterMatches.forEach(i=>e.add(i.setting.key))})}filterSettings(e,t,n){let i=this.filterGroups,r=[];for(let s of i){let a=t(s);for(let l of s.sections)for(let d of l.settings){let c=n(d,s);(a||c)&&r.push({setting:d,matches:c&&c.matches,matchType:c?.matchType??0,score:c?.score??0})}}return r}getPreference(e){for(let t of this.settingsGroups)for(let n of t.sections)for(let i of n.settings)if(e===i.key)return i}collectMetadata(e){let t=Object.create(null),n=!1;return e.forEach(i=>{i.result.metadata&&(t[i.id]=i.result.metadata,n=!0)}),n?t:null}get filterGroups(){return this.settingsGroups}};var ux=class extends IP{constructor(t,n){super();this._defaultSettings=t;this._register(n.onDidChangeConfiguration(i=>{i.source===7&&(this.dirty=!0,this._onDidChangeGroups.fire())})),this._register(et.as(Ao.Configuration).onDidSchemaChange(i=>{this.dirty=!0,this._onDidChangeGroups.fire()}))}_onDidChangeGroups=this._register(new D);onDidChangeGroups=this._onDidChangeGroups.event;additionalGroups=[];dirty=!1;get filterGroups(){return this.settingsGroups.slice(1)}get settingsGroups(){let t=this._defaultSettings.getSettingsGroups(this.dirty);return this.dirty=!1,[...t,...this.additionalGroups]}setAdditionalGroups(t){this.additionalGroups=t}findValueMatches(t,n){return[]}update(){throw new Error("Not supported")}};ux=O([x(1,ut)],ux);function xG(o){return"// "+m("defaultKeybindingsHeader","Override key bindings by placing them into your key bindings file.")+`
`+o.getDefaultKeybindingsContent()}var px=class{constructor(e,t){this._uri=e;this.keybindingService=t}_content;get uri(){return this._uri}get content(){return this._content||(this._content=xG(this.keybindingService)),this._content}getPreference(){return null}dispose(){}};px=O([x(1,oi)],px);var zU=Y("preferencesService");var js={EditorPane:"workbench.contributions.editors",EditorFactory:"workbench.contributions.editor.inputFactories"},KU={id:"default",displayName:m("promptOpenWith.defaultEditor.displayName","Text Editor"),providerDisplayName:m("builtinProviderDisplayName","Built-in")},GU="workbench.editor.sidebysideEditor",hx="workbench.editors.textDiffEditor",jU="workbench.editors.binaryResourceDiffEditor";function TP(o){let e=o;return!!e&&typeof e.getSelection=="function"&&!!e.onDidChangeSelection}function lx(o,e,t){for(let n of t.visibleEditorPanes)if(n.group.id===e&&o.matches(n.input))return n.getViewState()}function NU(o){if(yi(o))return!1;let e=o;return J.isUri(e?.resource)}function Gs(o){if(yi(o))return!1;let e=o;return e?.original!==void 0&&e.modified!==void 0}function km(o){if(yi(o))return!1;let e=o;return!e||e.resources&&!Array.isArray(e.resources)?!1:!!e.resources||!!e.multiDiffSource}function mc(o){if(yi(o)||Gs(o))return!1;let e=o;return e?.primary!==void 0&&e.secondary!==void 0}function gc(o){if(yi(o))return!1;let e=o;return J.isUri(e?.base?.resource)&&J.isUri(e?.input1?.resource)&&J.isUri(e?.input2?.resource)&&J.isUri(e?.result?.resource)}var CP=class{mapIdToSaveSource=new Map;registerSource(e,t){let n=this.mapIdToSaveSource.get(e);return n||(n={source:e,label:t},this.mapIdToSaveSource.set(e,n)),n.source}getSourceLabel(e){return this.mapIdToSaveSource.get(e)?.label??e}},ibt=new CP;var yv=class extends F{};function yi(o){return o instanceof yv}function _G(o){let e=o;return J.isUri(e?.preferredResource)}function DG(o){let e=o;return yi(e?.primary)&&yi(e?.secondary)}function dP(o){let e=o;return yi(e?.modified)&&yi(e?.original)}function qU(o,e,t,n,i){return LG(n,[xi({id:"workbench.action.openLargeFile",label:m("openLargeFile","Open Anyway"),run:()=>{let r={...t,limits:{size:Number.MAX_VALUE}};o.openEditor(e,r)}}),xi({id:"workbench.action.configureEditorLargeFileConfirmation",label:m("configureEditorLargeFileConfirmation","Configure Limit"),run:()=>i.openUserSettings({query:"workbench.editorLargeFileConfirmation"})})],{forceMessage:!0,forceSeverity:gi.Warning})}var SP=class{getOriginalUri(e,t){if(!e)return;if(gc(e))return Ks.getOriginalUri(e.result,t);if(t?.supportSideBySide){let{primary:i,secondary:r}=this.getSideEditors(e);if(i&&r){if(t?.supportSideBySide===3)return{primary:this.getOriginalUri(i,{filterByScheme:t.filterByScheme}),secondary:this.getOriginalUri(r,{filterByScheme:t.filterByScheme})};if(t?.supportSideBySide===4)return this.getOriginalUri(i,{filterByScheme:t.filterByScheme})??this.getOriginalUri(r,{filterByScheme:t.filterByScheme});e=t.supportSideBySide===1?i:r}}if(Gs(e)||km(e)||mc(e)||gc(e))return;let n=_G(e)?e.preferredResource:e.resource;return!n||!t||!t.filterByScheme?n:this.filterUri(n,t.filterByScheme)}getSideEditors(e){return DG(e)||mc(e)?{primary:e.primary,secondary:e.secondary}:dP(e)||Gs(e)?{primary:e.modified,secondary:e.original}:{primary:void 0,secondary:void 0}}getCanonicalUri(e,t){if(!e)return;if(gc(e))return Ks.getCanonicalUri(e.result,t);if(t?.supportSideBySide){let{primary:i,secondary:r}=this.getSideEditors(e);if(i&&r){if(t?.supportSideBySide===3)return{primary:this.getCanonicalUri(i,{filterByScheme:t.filterByScheme}),secondary:this.getCanonicalUri(r,{filterByScheme:t.filterByScheme})};if(t?.supportSideBySide===4)return this.getCanonicalUri(i,{filterByScheme:t.filterByScheme})??this.getCanonicalUri(r,{filterByScheme:t.filterByScheme});e=t.supportSideBySide===1?i:r}}if(Gs(e)||km(e)||mc(e)||gc(e))return;let n=e.resource;return!n||!t||!t.filterByScheme?n:this.filterUri(n,t.filterByScheme)}filterUri(e,t){if(Array.isArray(t)){if(t.some(n=>e.scheme===n))return e}else if(t===e.scheme)return e}};var Ks=new SP;var EP=class{instantiationService;fileEditorFactory;editorSerializerConstructors=new Map;editorSerializerInstances=new Map;start(e){let t=this.instantiationService=e.get(Oe);for(let[n,i]of this.editorSerializerConstructors)this.createEditorSerializer(n,i,t);this.editorSerializerConstructors.clear()}createEditorSerializer(e,t,n){let i=n.createInstance(t);this.editorSerializerInstances.set(e,i)}registerFileEditorFactory(e){if(this.fileEditorFactory)throw new Error("Can only register one file editor factory.");this.fileEditorFactory=e}getFileEditorFactory(){return fn(this.fileEditorFactory)}registerEditorSerializer(e,t){if(this.editorSerializerConstructors.has(e)||this.editorSerializerInstances.has(e))throw new Error(`A editor serializer with type ID '${e}' was already registered.`);return this.instantiationService?this.createEditorSerializer(e,t,this.instantiationService):this.editorSerializerConstructors.set(e,t),le(()=>{this.editorSerializerConstructors.delete(e),this.editorSerializerInstances.delete(e)})}getEditorSerializer(e){return this.editorSerializerInstances.get(typeof e=="string"?e:e.typeId)}};et.add(js.EditorFactory,new EP);function Ev(o){let e=o;if(!e)return!1;let t=e;if(t.modified)return Ev(t.modified);let n=e;return!!(n.contributionsState&&n.viewState&&Array.isArray(n.cursorState))}function LG(o,e,t){let n=WF(o,e);return n.forceMessage=t?.forceMessage,n.forceSeverity=t?.forceSeverity,n.allowDialog=t?.allowDialog,n}var br=Y("editorGroupsService");var RG=/(?:\/|^)(?:([^\/]+)\/)?([^\/]+)$/;function $U(o,e,t,n,i){if(we.isThemeIcon(i))return[`codicon-${i.id}`,"predefined-file-icon"];if(J.isUri(i))return[];let r=n===2?["rootfolder-icon"]:n===1?["folder-icon"]:["file-icon"];if(t){let s;if(t.scheme===Le.data)s=$p.parseMetaData(t).get($p.META_DATA_LABEL);else{let a=t.path.match(RG);a?(s=mx(a[2].toLowerCase()),a[1]&&r.push(`${mx(a[1].toLowerCase())}-name-dir-icon`)):s=mx(t.authority.toLowerCase())}if(n===2)r.push(`${s}-root-name-folder-icon`);else if(n===1)r.push(`${s}-name-folder-icon`);else{if(s){if(r.push(`${s}-name-file-icon`),r.push("name-file-icon"),s.length<=255){let l=s.split(".");for(let d=1;d<l.length;d++)r.push(`${l.slice(d).join(".")}-ext-file-icon`)}r.push("ext-file-icon")}let a=kG(o,e,t);a&&r.push(`${mx(a)}-lang-file-icon`)}}return r}function kG(o,e,t){if(!t)return null;let n=null;if(t.scheme===Le.data){let r=$p.parseMetaData(t).get($p.META_DATA_MIME);r&&(n=e.getLanguageIdByMimeType(r))}else{let i=o.getModel(t);i&&(n=i.getLanguageId())}return n&&n!==Ls?n:e.guessLanguageIdByFilepathOrFirstLine(t)}function mx(o){return o.replace(/[\s]/g,"/")}var Xu=class extends IT{constructor(t,n,i,r,s){super(t,{canAcceptInBackground:!0,noResultsPick:{label:m("noViewResults","No matching editors"),groupId:-1}});this.editorGroupService=n;this.editorService=i;this.modelService=r;this.languageService=s}pickState=new class{scorerCache=Object.create(null);isQuickNavigating=void 0;reset(t){t||(this.scorerCache=Object.create(null)),this.isQuickNavigating=t}};provide(t,n){return this.pickState.reset(!!t.quickNavigate),super.provide(t,n)}_getPicks(t){let n=_H(t),i=this.doGetEditorPickItems().filter(s=>{if(!n.normalized)return!0;let a=yT(s,n,!0,fM,this.pickState.scorerCache);return a.score?(s.highlights={label:a.labelMatch,description:a.descriptionMatch},!0):!1});if(n.normalized){let s=this.editorGroupService.getGroups(2).map(a=>a.id);i.sort((a,l)=>a.groupId!==l.groupId?s.indexOf(a.groupId)-s.indexOf(l.groupId):wH(a,l,n,!0,fM,this.pickState.scorerCache))}let r=[];if(this.editorGroupService.count>1){let s;for(let a of i){if(typeof s!="number"||s!==a.groupId){let l=this.editorGroupService.getGroup(a.groupId);l&&r.push({type:"separator",label:l.label}),s=a.groupId}r.push(a)}}else r.push(...i);return r}doGetEditorPickItems(){let t=this.doGetEditors(),n=new Map;for(let{groupId:i}of t)if(!n.has(i)){let r=this.editorGroupService.getGroup(i);r&&n.set(i,r.ariaLabel)}return this.doGetEditors().map(({editor:i,groupId:r})=>{let s=Ks.getOriginalUri(i,{supportSideBySide:1}),a=i.isDirty()&&!i.isSaving(),l=i.getDescription(),d=l?`${i.getName()} ${l}`:i.getName();return{groupId:r,resource:s,label:i.getName(),ariaLabel:n.size>1?a?m("entryAriaLabelWithGroupDirty","{0}, unsaved changes, {1}",d,n.get(r)):m("entryAriaLabelWithGroup","{0}, {1}",d,n.get(r)):a?m("entryAriaLabelDirty","{0}, unsaved changes",d):d,description:l,iconClasses:$U(this.modelService,this.languageService,s,void 0,i.getIcon()).concat(i.getLabelExtraClasses()),italic:!this.editorGroupService.getGroup(r)?.isPinned(i),buttons:[{iconClass:a?"dirty-editor "+we.asClassName(te.closeDirty):we.asClassName(te.close),tooltip:m("closeEditor","Close Editor"),alwaysVisible:a}],trigger:async()=>{let c=this.editorGroupService.getGroup(r);return c&&(await c.closeEditor(i,{preserveFocus:!0}),!c.contains(i))?3:0},accept:(c,u)=>this.editorGroupService.getGroup(r)?.openEditor(i,{preserveFocus:u.inBackground})}})}};Xu=O([x(1,br),x(2,Tn),x(3,ls),x(4,Di)],Xu);var Qu=class extends Xu{static PREFIX="edt active ";constructor(e,t,n,i){super(Qu.PREFIX,e,t,n,i)}doGetEditors(){let e=this.editorGroupService.activeGroup;return e.getEditors(0).map(t=>({editor:t,groupId:e.id}))}};Qu=O([x(0,br),x(1,Tn),x(2,ls),x(3,Di)],Qu);var Nm=class extends Xu{static PREFIX="edt ";constructor(e,t,n,i){super(Nm.PREFIX,e,t,n,i)}doGetEditors(){let e=[];for(let t of this.editorGroupService.getGroups(2))for(let n of t.getEditors(1))e.push({editor:n,groupId:t.id});return e}};Nm=O([x(0,br),x(1,Tn),x(2,ls),x(3,Di)],Nm);var Am=class extends Xu{static PREFIX="edt mru ";constructor(e,t,n,i){super(Am.PREFIX,e,t,n,i)}doGetEditors(){let e=[];for(let t of this.editorService.getEditors(0))e.push(t);return e}};Am=O([x(0,br),x(1,Tn),x(2,ls),x(3,Di)],Am);var gx=class o{constructor(e,t){this.storageService=t;this.id=o.COMMON_PREFIX+e}static applicationMementos=new Map;static profileMementos=new Map;static workspaceMementos=new Map;static COMMON_PREFIX="memento/";id;getMemento(e,t){switch(e){case 1:{let n=o.workspaceMementos.get(this.id);return n||(n=new Tv(this.id,e,t,this.storageService),o.workspaceMementos.set(this.id,n)),n.getMemento()}case 0:{let n=o.profileMementos.get(this.id);return n||(n=new Tv(this.id,e,t,this.storageService),o.profileMementos.set(this.id,n)),n.getMemento()}case-1:{let n=o.applicationMementos.get(this.id);return n||(n=new Tv(this.id,e,t,this.storageService),o.applicationMementos.set(this.id,n)),n.getMemento()}}}onDidChangeValue(e,t){return this.storageService.onDidChangeValue(e,this.id,t)}saveMemento(){o.workspaceMementos.get(this.id)?.save(),o.profileMementos.get(this.id)?.save(),o.applicationMementos.get(this.id)?.save()}reloadMemento(e){let t;switch(e){case-1:t=o.applicationMementos.get(this.id);break;case 0:t=o.profileMementos.get(this.id);break;case 1:t=o.workspaceMementos.get(this.id);break}t?.reload()}static clear(e){switch(e){case 1:o.workspaceMementos.clear();break;case 0:o.profileMementos.clear();break;case-1:o.applicationMementos.clear();break}}},Tv=class{constructor(e,t,n,i){this.id=e;this.scope=t;this.target=n;this.storageService=i;this.mementoObj=this.doLoad()}mementoObj;doLoad(){try{return this.storageService.getObject(this.id,this.scope,{})}catch(e){qe(`[memento]: failed to parse contents: ${e} (id: ${this.id}, scope: ${this.scope}, contents: ${this.storageService.get(this.id,this.scope)})`)}return{}}getMemento(){return this.mementoObj}reload(){for(let e of Object.getOwnPropertyNames(this.mementoObj))delete this.mementoObj[e];Object.assign(this.mementoObj,this.doLoad())}save(){qc(this.mementoObj)?this.storageService.remove(this.id,this.scope):this.storageService.store(this.id,this.mementoObj,this.scope,this.target)}};var xv=class extends HS{constructor(t,n,i){super(n);this.id=t;this.memento=new gx(this.id,i),this._register(i.onWillSaveState(()=>{this.saveState(),this.memento.saveMemento()}))}memento;getId(){return this.id}getMemento(t,n){return this.memento.getMemento(t,n)}reloadMemento(t){return this.memento.reloadMemento(t)}onDidChangeMementoValue(t,n){return this.memento.onDidChangeValue(t,n)}saveState(){}};var fx=class extends xv{constructor(t,n,i,r){super(t,i,r);this.telemetryService=n}_onTitleAreaUpdate=this._register(new D);onTitleAreaUpdate=this._onTitleAreaUpdate.event;_onDidFocus;get onDidFocus(){return this._onDidFocus||(this._onDidFocus=this.registerFocusTrackEvents().onDidFocus),this._onDidFocus.event}_onDidBlur;get onDidBlur(){return this._onDidBlur||(this._onDidBlur=this.registerFocusTrackEvents().onDidBlur),this._onDidBlur.event}_hasFocus=!1;hasFocus(){return this._hasFocus}registerFocusTrackEvents(){let t=fn(this.getContainer()),n=this._register(_l(t)),i=this._onDidFocus=this._register(new D);this._register(n.onDidFocus(()=>{this._hasFocus=!0,i.fire()}));let r=this._onDidBlur=this._register(new D);return this._register(n.onDidBlur(()=>{this._hasFocus=!1,r.fire()})),{onDidFocus:i,onDidBlur:r}}actionRunner;visible=!1;parent;getTitle(){}create(t){this.parent=t}getContainer(){return this.parent}setVisible(t){this.visible!==!!t&&(this.visible=t)}focus(){}getMenuIds(){return[]}getActions(){return[]}getSecondaryActions(){return[]}getContextMenuActions(){return[]}getActionViewItem(t,n){}getActionsContext(){return null}getActionRunner(){return this.actionRunner||(this.actionRunner=this._register(new ko)),this.actionRunner}updateTitleArea(){this._onTitleAreaUpdate.fire()}isVisible(){return this.visible}getControl(){}};var aIt={separatorBorder:H.transparent};var PG;(i=>{i.Distribute={type:"distribute"},i.Split={type:"split"},i.Auto={type:"auto"};function n(r){return{type:"invisible",cachedVisibleSize:r}}i.Invisible=n})(PG||={});async function XU(o){let e=navigator.usb;if(!e)return;let t=await e.requestDevice({filters:o?.filters??[]});if(t)return{deviceClass:t.deviceClass,deviceProtocol:t.deviceProtocol,deviceSubclass:t.deviceSubclass,deviceVersionMajor:t.deviceVersionMajor,deviceVersionMinor:t.deviceVersionMinor,deviceVersionSubminor:t.deviceVersionSubminor,manufacturerName:t.manufacturerName,productId:t.productId,productName:t.productName,serialNumber:t.serialNumber,usbVersionMajor:t.usbVersionMajor,usbVersionMinor:t.usbVersionMinor,usbVersionSubminor:t.usbVersionSubminor,vendorId:t.vendorId}}async function QU(o){let e=navigator.serial;if(!e)return;let t=await e.requestPort({filters:o?.filters??[]});if(!t)return;let n=t.getInfo();return{usbVendorId:n.usbVendorId,usbProductId:n.usbProductId}}async function JU(o){let e=navigator.hid;if(!e)return;let t=await e.requestDevice({filters:o?.filters??[]});if(!t.length)return;let n=t[0];return{opened:n.opened,vendorId:n.vendorId,productId:n.productId,productName:n.productName,collections:n.collections}}var Ju=Mo;var OG=60,NG=OG*60,xP=NG*24,WIt=xP*7,HIt=xP*30,UIt=xP*365;function e4(o){return o.getFullYear()+"-"+String(o.getMonth()+1).padStart(2,"0")+"-"+String(o.getDate()).padStart(2,"0")+"T"+String(o.getHours()).padStart(2,"0")+":"+String(o.getMinutes()).padStart(2,"0")+":"+String(o.getSeconds()).padStart(2,"0")+"."+(o.getMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}var wv=/^([^.]+\..+)[:=](.+)$/,$t=class{constructor(e,t,n){this._args=e;this.paths=t;this.productService=n}get appRoot(){return By(ma.asFileUri("").fsPath)}get userHome(){return J.file(this.paths.homeDir)}get userDataPath(){return this.paths.userDataDir}get appSettingsHome(){return J.file(_r(this.userDataPath,"User"))}get tmpDir(){return J.file(this.paths.tmpDir)}get cacheHome(){return J.file(this.userDataPath)}get stateResource(){return Ct(this.appSettingsHome,"globalStorage","storage.json")}get userRoamingDataHome(){return this.appSettingsHome.with({scheme:Le.vscodeUserData})}get userDataSyncHome(){return Ct(this.appSettingsHome,"sync")}get logsHome(){if(!this.args.logsPath){let e=e4(new Date).replace(/-|:|\.\d+Z$/g,"");this.args.logsPath=_r(this.userDataPath,"logs",e)}return J.file(this.args.logsPath)}get sync(){return this.args.sync}get machineSettingsResource(){return Ct(J.file(_r(this.userDataPath,"Machine")),"settings.json")}get workspaceStorageHome(){return Ct(this.appSettingsHome,"workspaceStorage")}get localHistoryHome(){return Ct(this.appSettingsHome,"History")}get keyboardLayoutResource(){return Ct(this.userRoamingDataHome,"keyboardLayout.json")}get argvResource(){let e=$r.VSCODE_PORTABLE;return e?J.file(_r(e,"argv.json")):Ct(this.userHome,this.productService.dataFolderName,"argv.json")}get isExtensionDevelopment(){return!!this.args.extensionDevelopmentPath}get untitledWorkspacesHome(){return J.file(_r(this.userDataPath,"Workspaces"))}get builtinExtensionsPath(){let e=this.args["builtin-extensions-dir"];return e?Np(e):ad(_r(ma.asFileUri("").fsPath,"..","extensions"))}get extensionsDownloadLocation(){let e=this.args["extensions-download-dir"];return e?J.file(Np(e)):J.file(_r(this.userDataPath,"CachedExtensionVSIXs"))}get extensionsPath(){let e=this.args["extensions-dir"];if(e)return Np(e);let t=$r.VSCODE_EXTENSIONS;if(t)return t;let n=$r.VSCODE_PORTABLE;return n?_r(n,"extensions"):Ct(this.userHome,this.productService.dataFolderName,"extensions").fsPath}get extensionDevelopmentLocationURI(){let e=this.args.extensionDevelopmentPath;if(Array.isArray(e))return e.map(t=>/^[^:/?#]+?:\/\//.test(t)?J.parse(t):J.file(ad(t)))}get extensionDevelopmentKind(){return this.args.extensionDevelopmentKind?.map(e=>e==="ui"||e==="workspace"||e==="web"?e:"workspace")}get extensionTestsLocationURI(){let e=this.args.extensionTestsPath;if(e)return/^[^:/?#]+?:\/\//.test(e)?J.parse(e):J.file(ad(e))}get disableExtensions(){if(this.args["disable-extensions"])return!0;let e=this.args["disable-extension"];if(e){if(typeof e=="string")return[e];if(Array.isArray(e)&&e.length>0)return e}return!1}get debugExtensionHost(){return AG(this.args,this.isBuilt)}get debugRenderer(){return!!this.args.debugRenderer}get isBuilt(){return!$r.VSCODE_DEV}get verbose(){return!!this.args.verbose}get logLevel(){return this.args.log?.find(e=>!wv.test(e))}get extensionLogLevel(){let e=[];for(let t of this.args.log||[]){let n=wv.exec(t);n&&n[1]&&n[2]&&e.push([n[1],n[2]])}return e.length?e:void 0}get serviceMachineIdResource(){return Ct(J.file(this.userDataPath),"machineid")}get crashReporterId(){return this.args["crash-reporter-id"]}get crashReporterDirectory(){return this.args["crash-reporter-directory"]}get disableTelemetry(){return!!this.args["disable-telemetry"]}get disableWorkspaceTrust(){return!!this.args["disable-workspace-trust"]}get useInMemorySecretStorage(){return!!this.args["use-inmemory-secretstorage"]}get policyFile(){if(this.args["__enable-file-policy"]){let e=$r.VSCODE_PORTABLE;return e?J.file(_r(e,"policy.json")):Ct(this.userHome,this.productService.dataFolderName,"policy.json")}}editSessionId=this.args.editSessionId;get continueOn(){return this.args.continueOn}set continueOn(e){this.args.continueOn=e}get args(){return this._args}};O([he],$t.prototype,"appRoot",1),O([he],$t.prototype,"userHome",1),O([he],$t.prototype,"userDataPath",1),O([he],$t.prototype,"appSettingsHome",1),O([he],$t.prototype,"tmpDir",1),O([he],$t.prototype,"cacheHome",1),O([he],$t.prototype,"stateResource",1),O([he],$t.prototype,"userRoamingDataHome",1),O([he],$t.prototype,"userDataSyncHome",1),O([he],$t.prototype,"sync",1),O([he],$t.prototype,"machineSettingsResource",1),O([he],$t.prototype,"workspaceStorageHome",1),O([he],$t.prototype,"localHistoryHome",1),O([he],$t.prototype,"keyboardLayoutResource",1),O([he],$t.prototype,"argvResource",1),O([he],$t.prototype,"isExtensionDevelopment",1),O([he],$t.prototype,"untitledWorkspacesHome",1),O([he],$t.prototype,"builtinExtensionsPath",1),O([he],$t.prototype,"extensionsPath",1),O([he],$t.prototype,"extensionDevelopmentLocationURI",1),O([he],$t.prototype,"extensionDevelopmentKind",1),O([he],$t.prototype,"extensionTestsLocationURI",1),O([he],$t.prototype,"debugExtensionHost",1),O([he],$t.prototype,"logLevel",1),O([he],$t.prototype,"extensionLogLevel",1),O([he],$t.prototype,"serviceMachineIdResource",1),O([he],$t.prototype,"disableTelemetry",1),O([he],$t.prototype,"disableWorkspaceTrust",1),O([he],$t.prototype,"useInMemorySecretStorage",1),O([he],$t.prototype,"policyFile",1);function AG(o,e){return FG(o["inspect-extensions"],o["inspect-brk-extensions"],5870,e,o.debugId,o.extensionEnvironment)}function FG(o,e,t,n,i,r){let a=Number(e||o)||(n?null:t),l=a?!!e:!1,d;if(r)try{d=JSON.parse(r)}catch{}return{port:a,break:l,debugId:i,env:d}}var t4=Mo,ht=class{constructor(e,t,n,i){this.workspaceId=e;this.logsHome=t;this.options=n;this.productService=i;if(n.workspaceProvider&&Array.isArray(n.workspaceProvider.payload))try{this.payload=new Map(n.workspaceProvider.payload)}catch(r){qe(r)}}get remoteAuthority(){return this.options.remoteAuthority}get expectsResolverExtension(){return!!this.options.remoteAuthority?.includes("+")&&!this.options.webSocketFactory}get isBuilt(){return!!this.productService.commit}get logLevel(){let e=this.payload?.get("logLevel");return e?e.split(",").find(t=>!wv.test(t)):this.options.developmentOptions?.logLevel!==void 0?UI(this.options.developmentOptions?.logLevel):void 0}get extensionLogLevel(){let e=this.payload?.get("logLevel");if(e){let t=[];for(let n of e.split(",")){let i=wv.exec(n);i&&i[1]&&i[2]&&t.push([i[1],i[2]])}return t.length?t:void 0}return this.options.developmentOptions?.extensionLogLevel!==void 0?this.options.developmentOptions?.extensionLogLevel.map(([t,n])=>[t,UI(n)]):void 0}get profDurationMarkers(){let e=this.payload?.get("profDurationMarkers");if(e){let t=[];for(let n of e.split(","))t.push(n);return t.length===2?t:void 0}}get windowLogsPath(){return this.logsHome}get logFile(){return Ct(this.windowLogsPath,"window.log")}get userRoamingDataHome(){return J.file("/User").with({scheme:Le.vscodeUserData})}get argvResource(){return Ct(this.userRoamingDataHome,"argv.json")}get cacheHome(){return Ct(this.userRoamingDataHome,"caches")}get workspaceStorageHome(){return Ct(this.userRoamingDataHome,"workspaceStorage")}get localHistoryHome(){return Ct(this.userRoamingDataHome,"History")}get stateResource(){return Ct(this.userRoamingDataHome,"State","storage.json")}get userDataSyncHome(){return Ct(this.userRoamingDataHome,"sync",this.workspaceId)}get sync(){}get keyboardLayoutResource(){return Ct(this.userRoamingDataHome,"keyboardLayout.json")}get untitledWorkspacesHome(){return Ct(this.userRoamingDataHome,"Workspaces")}get serviceMachineIdResource(){return Ct(this.userRoamingDataHome,"machineid")}get extHostLogsPath(){return Ct(this.logsHome,"exthost")}get extHostTelemetryLogFile(){return Ct(this.extHostLogsPath,"extensionTelemetry.log")}extensionHostDebugEnvironment=void 0;get debugExtensionHost(){return this.extensionHostDebugEnvironment||(this.extensionHostDebugEnvironment=this.resolveExtensionHostDebugEnvironment()),this.extensionHostDebugEnvironment.params}get isExtensionDevelopment(){return this.extensionHostDebugEnvironment||(this.extensionHostDebugEnvironment=this.resolveExtensionHostDebugEnvironment()),this.extensionHostDebugEnvironment.isExtensionDevelopment}get extensionDevelopmentLocationURI(){return this.extensionHostDebugEnvironment||(this.extensionHostDebugEnvironment=this.resolveExtensionHostDebugEnvironment()),this.extensionHostDebugEnvironment.extensionDevelopmentLocationURI}get extensionDevelopmentLocationKind(){return this.extensionHostDebugEnvironment||(this.extensionHostDebugEnvironment=this.resolveExtensionHostDebugEnvironment()),this.extensionHostDebugEnvironment.extensionDevelopmentKind}get extensionTestsLocationURI(){return this.extensionHostDebugEnvironment||(this.extensionHostDebugEnvironment=this.resolveExtensionHostDebugEnvironment()),this.extensionHostDebugEnvironment.extensionTestsLocationURI}get extensionEnabledProposedApi(){return this.extensionHostDebugEnvironment||(this.extensionHostDebugEnvironment=this.resolveExtensionHostDebugEnvironment()),this.extensionHostDebugEnvironment.extensionEnabledProposedApi}get debugRenderer(){return this.extensionHostDebugEnvironment||(this.extensionHostDebugEnvironment=this.resolveExtensionHostDebugEnvironment()),this.extensionHostDebugEnvironment.debugRenderer}get enableSmokeTestDriver(){return this.options.developmentOptions?.enableSmokeTestDriver}get disableExtensions(){return this.payload?.get("disableExtensions")==="true"}get enableExtensions(){return this.options.enabledExtensions}get webviewExternalEndpoint(){let e=this.options.webviewEndpoint||this.productService.webviewContentExternalBaseUrlTemplate||"https://{{uuid}}.vscode-cdn.net/{{quality}}/{{commit}}/out/vs/workbench/contrib/webview/browser/pre/",t=this.payload?.get("webviewExternalEndpointCommit");return e.replace("{{commit}}",t??this.productService.commit??"ef65ac1ba57f57f2a3961bfe94aa20481caca4c6").replace("{{quality}}",(t?"insider":this.productService.quality)??"insider")}get extensionTelemetryLogResource(){return Ct(this.logsHome,"extensionTelemetry.log")}get disableTelemetry(){return!1}get verbose(){return this.payload?.get("verbose")==="true"}get logExtensionHostCommunication(){return this.payload?.get("logExtensionHostCommunication")==="true"}get skipReleaseNotes(){return this.payload?.get("skipReleaseNotes")==="true"}get skipWelcome(){return this.payload?.get("skipWelcome")==="true"}get disableWorkspaceTrust(){return!this.options.enableWorkspaceTrust}get profile(){return this.payload?.get("profile")}editSessionId=this.options.editSessionId;payload;resolveExtensionHostDebugEnvironment(){let e={params:{port:null,break:!1},debugRenderer:!1,isExtensionDevelopment:!1,extensionDevelopmentLocationURI:void 0,extensionDevelopmentKind:void 0};if(this.payload)for(let[n,i]of this.payload)switch(n){case"extensionDevelopmentPath":e.extensionDevelopmentLocationURI||(e.extensionDevelopmentLocationURI=[]),e.extensionDevelopmentLocationURI.push(J.parse(i)),e.isExtensionDevelopment=!0;break;case"extensionDevelopmentKind":e.extensionDevelopmentKind=[i];break;case"extensionTestsPath":e.extensionTestsLocationURI=J.parse(i);break;case"debugRenderer":e.debugRenderer=i==="true";break;case"debugId":e.params.debugId=i;break;case"inspect-brk-extensions":e.params.port=parseInt(i),e.params.break=!0;break;case"inspect-extensions":e.params.port=parseInt(i);break;case"enableProposedApi":e.extensionEnabledProposedApi=[];break}let t=this.options.developmentOptions;return t&&!e.isExtensionDevelopment&&(t.extensions?.length&&(e.extensionDevelopmentLocationURI=t.extensions.map(n=>J.revive(n)),e.isExtensionDevelopment=!0),t.extensionTestsPath&&(e.extensionTestsLocationURI=J.revive(t.extensionTestsPath))),e}get filesToOpenOrCreate(){if(this.payload){let e=this.payload.get("openFile");if(e){let t=J.parse(e);if(this.payload.has("gotoLineMode")){let n=eF(t.path);return[{fileUri:t.with({path:n.path}),options:{selection:Kn(n.line)?void 0:{startLineNumber:n.line,startColumn:n.column||1}}}]}return[{fileUri:t}]}}}get filesToDiff(){if(this.payload){let e=this.payload.get("diffFilePrimary"),t=this.payload.get("diffFileSecondary");if(e&&t)return[{fileUri:J.parse(t)},{fileUri:J.parse(e)}]}}get filesToMerge(){if(this.payload){let e=this.payload.get("mergeFile1"),t=this.payload.get("mergeFile2"),n=this.payload.get("mergeFileBase"),i=this.payload.get("mergeFileResult");if(e&&t&&n&&i)return[{fileUri:J.parse(e)},{fileUri:J.parse(t)},{fileUri:J.parse(n)},{fileUri:J.parse(i)}]}}};O([he],ht.prototype,"remoteAuthority",1),O([he],ht.prototype,"expectsResolverExtension",1),O([he],ht.prototype,"isBuilt",1),O([he],ht.prototype,"logLevel",1),O([he],ht.prototype,"windowLogsPath",1),O([he],ht.prototype,"logFile",1),O([he],ht.prototype,"userRoamingDataHome",1),O([he],ht.prototype,"argvResource",1),O([he],ht.prototype,"cacheHome",1),O([he],ht.prototype,"workspaceStorageHome",1),O([he],ht.prototype,"localHistoryHome",1),O([he],ht.prototype,"stateResource",1),O([he],ht.prototype,"userDataSyncHome",1),O([he],ht.prototype,"sync",1),O([he],ht.prototype,"keyboardLayoutResource",1),O([he],ht.prototype,"untitledWorkspacesHome",1),O([he],ht.prototype,"serviceMachineIdResource",1),O([he],ht.prototype,"extHostLogsPath",1),O([he],ht.prototype,"extHostTelemetryLogFile",1),O([he],ht.prototype,"debugExtensionHost",1),O([he],ht.prototype,"isExtensionDevelopment",1),O([he],ht.prototype,"extensionDevelopmentLocationURI",1),O([he],ht.prototype,"extensionDevelopmentLocationKind",1),O([he],ht.prototype,"extensionTestsLocationURI",1),O([he],ht.prototype,"extensionEnabledProposedApi",1),O([he],ht.prototype,"debugRenderer",1),O([he],ht.prototype,"enableSmokeTestDriver",1),O([he],ht.prototype,"disableExtensions",1),O([he],ht.prototype,"enableExtensions",1),O([he],ht.prototype,"webviewExternalEndpoint",1),O([he],ht.prototype,"extensionTelemetryLogResource",1),O([he],ht.prototype,"disableTelemetry",1),O([he],ht.prototype,"verbose",1),O([he],ht.prototype,"logExtensionHostCommunication",1),O([he],ht.prototype,"skipReleaseNotes",1),O([he],ht.prototype,"skipWelcome",1),O([he],ht.prototype,"disableWorkspaceTrust",1),O([he],ht.prototype,"profile",1),O([he],ht.prototype,"filesToOpenOrCreate",1),O([he],ht.prototype,"filesToDiff",1),O([he],ht.prototype,"filesToMerge",1);var n4=Y("layoutService");var vx=n4;function bx(o){switch(o){case 0:return"left";case 1:return"right";case 2:return"bottom";case 3:return"top";default:return"bottom"}}var PSt={[bx(0)]:0,[bx(1)]:1,[bx(2)]:2,[bx(3)]:3};function wP(o){switch(o){case 0:return"always";case 1:return"never";case 2:return"preserve";default:return"preserve"}}var OSt={[wP(0)]:0,[wP(1)]:1,[wP(2)]:2};var fc=Y("lifecycleService");function i4(o){switch(o){case 1:return"Starting";case 2:return"Ready";case 3:return"Restored";case 4:return"Eventually"}}var ja=class extends F{constructor(t,n){super();this.logService=t;this.storageService=n;this._startupKind=this.resolveStartupKind(),this._register(this.storageService.onWillSaveState(i=>{i.reason===1&&this.storageService.store(ja.LAST_SHUTDOWN_REASON_KEY,this.shutdownReason,1,1)}))}static LAST_SHUTDOWN_REASON_KEY="lifecyle.lastShutdownReason";_onBeforeShutdown=this._register(new D);onBeforeShutdown=this._onBeforeShutdown.event;_onWillShutdown=this._register(new D);onWillShutdown=this._onWillShutdown.event;_onDidShutdown=this._register(new D);onDidShutdown=this._onDidShutdown.event;_onBeforeShutdownError=this._register(new D);onBeforeShutdownError=this._onBeforeShutdownError.event;_onShutdownVeto=this._register(new D);onShutdownVeto=this._onShutdownVeto.event;_startupKind;get startupKind(){return this._startupKind}_phase=1;get phase(){return this._phase}phaseWhen=new Map;shutdownReason;resolveStartupKind(){let t=this.doResolveStartupKind()??1;return this.logService.trace(`[lifecycle] starting up (startup kind: ${t})`),t}doResolveStartupKind(){let t=this.storageService.getNumber(ja.LAST_SHUTDOWN_REASON_KEY,1);this.storageService.remove(ja.LAST_SHUTDOWN_REASON_KEY,1);let n;switch(t){case 3:n=3;break;case 4:n=4;break}return n}set phase(t){if(t<this.phase)throw new Error("Lifecycle cannot go backwards");if(this._phase===t)return;this.logService.trace(`lifecycle: phase changed (value: ${t})`),this._phase=t,ti(`code/LifecyclePhase/${i4(t)}`);let n=this.phaseWhen.get(this._phase);n&&(n.open(),this.phaseWhen.delete(this._phase))}async when(t){if(t<=this._phase)return;let n=this.phaseWhen.get(t);n||(n=new Xp,this.phaseWhen.set(t,n)),await n.wait()}};ja=O([x(0,Gt),x(1,Ln)],ja);var _v=class extends ja{beforeUnloadListener=void 0;unloadListener=void 0;ignoreBeforeUnload=!1;didUnload=!1;constructor(e,t){super(e,t),this.registerListeners()}registerListeners(){this.beforeUnloadListener=j(Ne,me.BEFORE_UNLOAD,e=>this.onBeforeUnload(e)),this.unloadListener=j(Ne,me.PAGE_HIDE,()=>this.onUnload())}onBeforeUnload(e){this.ignoreBeforeUnload?(this.logService.info("[lifecycle] onBeforeUnload triggered but ignored once"),this.ignoreBeforeUnload=!1):(this.logService.info("[lifecycle] onBeforeUnload triggered and handled with veto support"),this.doShutdown(()=>this.vetoBeforeUnload(e)))}vetoBeforeUnload(e){e.preventDefault(),e.returnValue=m("lifecycleVeto","Changes that you made may not be saved. Please check press 'Cancel' and try again.")}withExpectedShutdown(e,t){if(typeof e=="number")return this.shutdownReason=e,this.storageService.flush(1);this.ignoreBeforeUnload=!0;try{t?.()}finally{this.ignoreBeforeUnload=!1}}async shutdown(){this.logService.info("[lifecycle] shutdown triggered"),this.beforeUnloadListener?.dispose(),this.unloadListener?.dispose(),await this.storageService.flush(1),this.doShutdown()}doShutdown(e){let t=this.logService;this.storageService.flush(1);let n=!1;function i(r,s){typeof e=="function"&&(r instanceof Promise&&(t.error(`[lifecycle] Long running operations before shutdown are unsupported in the web (id: ${s})`),n=!0),r===!0&&(t.info(`[lifecycle]: Unload was prevented (id: ${s})`),n=!0))}return this._onBeforeShutdown.fire({reason:2,veto(r,s){i(r,s)},finalVeto(r,s){i(r(),s)}}),n&&typeof e=="function"?e():this.onUnload()}onUnload(){if(this.didUnload)return;this.didUnload=!0,this._register(j(Ne,me.PAGE_SHOW,t=>this.onLoadAfterUnload(t)));let e=this.logService;this._onWillShutdown.fire({reason:2,joiners:()=>[],token:sn.None,join(t,n){e.error(`[lifecycle] Long running operations during shutdown are unsupported in the web (id: ${n.id})`)},force:()=>{}}),this._onDidShutdown.fire()}onLoadAfterUnload(e){e.persisted&&this.withExpectedShutdown({disableShutdownHandling:!0},()=>Ne.location.reload())}doResolveStartupKind(){let e=super.doResolveStartupKind();return typeof e!="number"&&performance.getEntriesByType("navigation").at(0)?.type==="reload"&&(e=3),e}};_v=O([x(0,Gt),x(1,Ln)],_v);$i(fc,_v,0);var bc=Y("hostService");var WG=m("open","open"),HG=m("close","close"),UG=m("find","find"),yx={open:WG,close:HG,find:UG};async function s4(o,e){let t=[];return await a4(o,t,e.logsHome,e.logsHome),t}async function a4(o,e,t,n){let i=await o.resolve(t);for(let{resource:r,isDirectory:s}of i.children||[])if(s)await a4(o,e,r,n);else{let a=(await o.readFile(r)).value.toString();if(a){let l=fI(n,r);l&&e.push({relativePath:l,contents:a})}}}var l4=Y("editorPaneService");var Ix;(e=>e.Workbench="workbench.contributions.kind")(Ix||={});var ep=(i=>(i[i.BlockStartup=1]="BlockStartup",i[i.BlockRestore=2]="BlockRestore",i[i.AfterRestored=3]="AfterRestored",i[i.Eventually=4]="Eventually",i))(ep||{});function d4(o){let e=o;return!!e&&typeof e.editorTypeId=="string"}function zG(o){switch(o){case 3:return ep.AfterRestored;case 4:return ep.Eventually}}function c4(o){switch(o){case ep.BlockStartup:return 1;case ep.BlockRestore:return 2;case ep.AfterRestored:return 3;case ep.Eventually:return 4}}var tp=class o extends F{static INSTANCE=new o;static BLOCK_BEFORE_RESTORE_WARN_THRESHOLD=20;static BLOCK_AFTER_RESTORE_WARN_THRESHOLD=100;instantiationService;lifecycleService;logService;environmentService;editorPaneService;contributionsByPhase=new Map;contributionsByEditor=new Map;contributionsById=new Map;instancesById=new Map;instanceDisposables=this._register(new ee);timingsByPhase=new Map;get timings(){return this.timingsByPhase}pendingRestoredContributions=new Ed;whenRestored=this.pendingRestoredContributions.p;registerWorkbenchContribution2(e,t,n){let i={id:e,ctor:t};this.instantiationService&&this.lifecycleService&&this.logService&&this.environmentService&&this.editorPaneService&&(typeof n=="number"&&this.lifecycleService.phase>=n||typeof e=="string"&&d4(n)&&this.editorPaneService.didInstantiateEditorPane(n.editorTypeId))?this.safeCreateContribution(this.instantiationService,this.logService,this.environmentService,i,typeof n=="number"?c4(n):this.lifecycleService.phase):(typeof n=="number"&&tf(this.contributionsByPhase,c4(n),[]).push(i),typeof e=="string"&&(this.contributionsById.has(e)?console.error(`IWorkbenchContributionsRegistry#registerWorkbenchContribution(): Can't register multiple contributions with same id '${e}'`):this.contributionsById.set(e,i),d4(n)&&tf(this.contributionsByEditor,n.editorTypeId,[]).push(i)))}registerWorkbenchContribution(e,t){this.registerWorkbenchContribution2(void 0,e,zG(t))}getWorkbenchContribution(e){if(this.instancesById.has(e))return this.instancesById.get(e);let t=this.instantiationService,n=this.lifecycleService,i=this.logService,r=this.environmentService;if(!t||!n||!i||!r)throw new Error(`IWorkbenchContributionsRegistry#getContribution('${e}'): cannot be called before registry started`);let s=this.contributionsById.get(e);if(!s)throw new Error(`IWorkbenchContributionsRegistry#getContribution('${e}'): contribution with that identifier is unknown.`);n.phase<3&&i.warn(`IWorkbenchContributionsRegistry#getContribution('${e}'): contribution instantiated before LifecyclePhase.Restored!`),this.safeCreateContribution(t,i,r,s,n.phase);let a=this.instancesById.get(e);if(!a)throw new Error(`IWorkbenchContributionsRegistry#getContribution('${e}'): failed to create contribution.`);return a}start(e){let t=this.instantiationService=e.get(Oe),n=this.lifecycleService=e.get(fc),i=this.logService=e.get(Gt),r=this.environmentService=e.get(Mo),s=this.editorPaneService=e.get(l4);this._register(n.onDidShutdown(()=>{this.instanceDisposables.clear()}));for(let a of[1,2,3,4])this.instantiateByPhase(t,n,i,r,a);for(let a of this.contributionsByEditor.keys())s.didInstantiateEditorPane(a)&&this.onEditor(a,t,n,i,r);this._register(s.onWillInstantiateEditorPane(a=>this.onEditor(a.typeId,t,n,i,r)))}onEditor(e,t,n,i,r){let s=this.contributionsByEditor.get(e);if(s){this.contributionsByEditor.delete(e);for(let a of s)this.safeCreateContribution(t,i,r,a,n.phase)}}instantiateByPhase(e,t,n,i,r){t.phase>=r?this.doInstantiateByPhase(e,n,i,r):t.when(r).then(()=>this.doInstantiateByPhase(e,n,i,r))}async doInstantiateByPhase(e,t,n,i){let r=this.contributionsByPhase.get(i);if(r)switch(this.contributionsByPhase.delete(i),i){case 1:case 2:{ti(`code/willCreateWorkbenchContributions/${i}`);for(let s of r)this.safeCreateContribution(e,t,n,s,i);ti(`code/didCreateWorkbenchContributions/${i}`);break}case 3:case 4:{i===4&&await this.pendingRestoredContributions.p,this.doInstantiateWhenIdle(r,e,t,n,i);break}}}doInstantiateWhenIdle(e,t,n,i,r){ti(`code/willCreateWorkbenchContributions/${r}`);let s=0,a=r===4?3e3:500,l=d=>{for(;s<e.length;){let c=e[s++];if(this.safeCreateContribution(t,n,i,c,r),d.timeRemaining()<1){Td(l,a);break}}s===e.length&&(ti(`code/didCreateWorkbenchContributions/${r}`),r===3&&this.pendingRestoredContributions.complete())};Td(l,a)}safeCreateContribution(e,t,n,i,r){if(typeof i.id=="string"&&this.instancesById.has(i.id))return;let s=Date.now();try{typeof i.id=="string"&&ti(`code/willCreateWorkbenchContribution/${r}/${i.id}`);let a=e.createInstance(i.ctor);typeof i.id=="string"&&(this.instancesById.set(i.id,a),this.contributionsById.delete(i.id)),Hy(a)&&this.instanceDisposables.add(a)}catch(a){t.error(`Unable to create workbench contribution '${i.id??i.ctor.name}'.`,a)}finally{typeof i.id=="string"&&ti(`code/didCreateWorkbenchContribution/${r}/${i.id}`)}if(typeof i.id=="string"||!n.isBuilt){let a=Date.now()-s;if(a>(r<3?o.BLOCK_BEFORE_RESTORE_WARN_THRESHOLD:o.BLOCK_AFTER_RESTORE_WARN_THRESHOLD)&&t.warn(`Creation of workbench contribution '${i.id??i.ctor.name}' took ${a}ms.`),typeof i.id=="string"){let l=this.timingsByPhase.get(r);l||(l=[],this.timingsByPhase.set(r,l)),l.push([i.id,a])}}}},rTt=tp.INSTANCE.registerWorkbenchContribution2.bind(tp.INSTANCE),sTt=tp.INSTANCE.getWorkbenchContribution.bind(tp.INSTANCE);et.add(Ix.Workbench,tp.INSTANCE);var Dv=class{constructor(e,t,n,i){this.fileService=e;this.environmentService=t;this.lifecycleService=n;this.logService=i}async getLogs(){return s4(this.fileService,this.environmentService)}async whenWorkbenchRestored(){this.logService.info("[driver] Waiting for restored lifecycle phase..."),await this.lifecycleService.when(3),this.logService.info("[driver] Restored lifecycle phase reached. Waiting for contributions..."),await et.as(Ix.Workbench).whenRestored,this.logService.info("[driver] Workbench contributions created.")}async setValue(e,t){let n=Ne.document.querySelector(e);if(!n)return Promise.reject(new Error(`Element not found: ${e}`));let i=n;i.value=t;let r=new Event("input",{bubbles:!0,cancelable:!0});i.dispatchEvent(r)}async isActiveElement(e){if(Ne.document.querySelector(e)!==Ne.document.activeElement){let n=[],i=Ne.document.activeElement;for(;i;){let r=i.tagName,s=i.id?`#${i.id}`:"",a=Er(i.className.split(/\s+/g).map(l=>l.trim())).map(l=>`.${l}`).join("");n.unshift(`${r}${s}${a}`),i=i.parentElement}throw new Error(`Active element not found. Current active element is '${n.join(" > ")}'. Looking for ${e}`)}return!0}async getElements(e,t){let n=Ne.document.querySelectorAll(e),i=[];for(let r=0;r<n.length;r++){let s=n.item(r);i.push(this.serializeElement(s,t))}return i}serializeElement(e,t){let n=Object.create(null);for(let a=0;a<e.attributes.length;a++){let l=e.attributes.item(a);l&&(n[l.name]=l.value)}let i=[];if(t)for(let a=0;a<e.children.length;a++){let l=e.children.item(a);l&&i.push(this.serializeElement(l,!0))}let{left:r,top:s}=Eb(e);return{tagName:e.tagName,className:e.className,textContent:e.textContent||"",attributes:n,children:i,left:r,top:s}}async getElementXY(e,t,n){let i=typeof t=="number"&&typeof n=="number"?{x:t,y:n}:void 0;return this._getElementXY(e,i)}async typeInEditor(e,t){let n=Ne.document.querySelector(e);if(!n)throw new Error(`Editor not found: ${e}`);let i=n,r=i.selectionStart,s=r+t.length,a=i.value,l=a.substr(0,r)+t+a.substr(r);i.value=l,i.setSelectionRange(s,s);let d=new Event("input",{bubbles:!0,cancelable:!0});i.dispatchEvent(d)}async getTerminalBuffer(e){let t=Ne.document.querySelector(e);if(!t)throw new Error(`Terminal not found: ${e}`);let n=t.xterm;if(!n)throw new Error(`Xterm not found: ${e}`);let i=[];for(let r=0;r<n.buffer.active.length;r++)i.push(n.buffer.active.getLine(r).translateToString(!0));return i}async writeInTerminal(e,t){let n=Ne.document.querySelector(e);if(!n)throw new Error(`Element not found: ${e}`);let i=n.xterm;if(!i)throw new Error(`Xterm not found: ${e}`);i.input(t)}getLocaleInfo(){return Promise.resolve({language:la,locale:nA})}getLocalizedStrings(){return Promise.resolve({open:yx.open,close:yx.close,find:yx.find})}async _getElementXY(e,t){let n=Ne.document.querySelector(e);if(!n)return Promise.reject(new Error(`Element not found: ${e}`));let{left:i,top:r}=Eb(n),{width:s,height:a}=Su(n),l,d;return t?(l=i+t.x,d=r+t.y):(l=i+s/2,d=r+a/2),l=Math.round(l),d=Math.round(d),{x:l,y:d}}async exitApplication(){}};Dv=O([x(0,Bt),x(1,Mo),x(2,fc),x(3,Gt)],Dv);function u4(o){Object.assign(Ne,{driver:o.createInstance(Dv)})}var Ur=class extends F{constructor(t,n={getWindowsCount:fS,getWindows:Cb},i,r){super();this.hostService=i;this.environmentService=r;this.enableWindowFocusOnElementFocus(t),this.enableMultiWindowAwareTimeout(t,n),this.registerFullScreenListeners(t.vscodeWindowId)}static TIMEOUT_HANDLES=Number.MIN_SAFE_INTEGER;static TIMEOUT_DISPOSABLES=new Map;enableWindowFocusOnElementFocus(t){let n=t.HTMLElement.prototype.focus,i=this;t.HTMLElement.prototype.focus=function(r){i.onElementFocus(Ce(this)),n.apply(this,[r])}}onElementFocus(t){let n=Zd();n!==t&&n.document.hasFocus()&&(t.focus(),!this.environmentService.extensionTestsLocationURI&&!t.document.hasFocus()&&this.hostService.focus(t))}enableMultiWindowAwareTimeout(t,n={getWindowsCount:fS,getWindows:Cb}){let i=t.setTimeout;Object.defineProperty(t,"vscodeOriginalSetTimeout",{get:()=>i});let r=t.clearTimeout;Object.defineProperty(t,"vscodeOriginalClearTimeout",{get:()=>r}),t.setTimeout=function(s,a=0,...l){if(n.getWindowsCount()===1||typeof s=="string"||a===0)return i.apply(this,[s,a,...l]);let d=new Set,c=Ur.TIMEOUT_HANDLES++;Ur.TIMEOUT_DISPOSABLES.set(c,d);let u=bs(s,()=>{wt(d),Ur.TIMEOUT_DISPOSABLES.delete(c)});for(let{window:p,disposables:h}of n.getWindows()){if(K0(p)&&p.document.visibilityState==="hidden")continue;let f=!1,g=p.vscodeOriginalSetTimeout.apply(this,[(...v)=>{f||u(...v)},a,...l]),b=le(()=>{f=!0,p.vscodeOriginalClearTimeout(g),d.delete(b)});h.add(b),d.add(b)}return c},t.clearTimeout=function(s){let a=typeof s=="number"?Ur.TIMEOUT_DISPOSABLES.get(s):void 0;a?(wt(a),Ur.TIMEOUT_DISPOSABLES.delete(s)):r.apply(this,[s])}}registerFullScreenListeners(t){this._register(this.hostService.onDidChangeFullScreen(({windowId:n,fullscreen:i})=>{if(n===t){let r=Cu(t);r&&XB(i,r.window)}}))}static async confirmOnShutdown(t,n){let i=t.get($u),r=t.get(ut),s=n===2?Ve?m("quitMessageMac","Are you sure you want to quit?"):m("quitMessage","Are you sure you want to exit?"):m("closeWindowMessage","Are you sure you want to close the window?"),a=n===2?Ve?m({key:"quitButtonLabel",comment:["&& denotes a mnemonic"]},"&&Quit"):m({key:"exitButtonLabel",comment:["&& denotes a mnemonic"]},"&&Exit"):m({key:"closeWindowButtonLabel",comment:["&& denotes a mnemonic"]},"&&Close Window"),l=await i.confirm({message:s,primaryButton:a,checkbox:{label:m("doNotAskAgain","Do not ask me again")}});return l.confirmed&&l.checkboxChecked&&await r.updateValue("window.confirmBeforeClose","never"),l.confirmed}};Ur=O([x(2,bc),x(3,Ju)],Ur);var Cx=class extends Ur{constructor(t,n,i,r,s,a,l,d,c){super(Ne,void 0,c,a);this.openerService=t;this.lifecycleService=n;this.dialogService=i;this.labelService=r;this.productService=s;this.browserEnvironmentService=a;this.layoutService=l;this.instantiationService=d;this.registerListeners(),this.create()}registerListeners(){this._register(this.lifecycleService.onWillShutdown(()=>this.onWillShutdown()));let t=jr&&Ne.visualViewport?Ne.visualViewport:Ne;this._register(j(t,me.RESIZE,()=>{this.layoutService.layout(),jr&&Ne.scrollTo(0,0)})),this._register(j(this.layoutService.mainContainer,me.WHEEL,n=>n.preventDefault(),{passive:!1})),this._register(j(this.layoutService.mainContainer,me.CONTEXT_MENU,n=>st.stop(n,!0))),this._register(j(this.layoutService.mainContainer,me.DROP,n=>st.stop(n,!0)))}onWillShutdown(){q.toPromise(q.any(q.once(new Ae(Ne.document.body,me.KEY_DOWN,!0).event),q.once(new Ae(Ne.document.body,me.MOUSE_DOWN,!0).event))).then(async()=>{await wi(3e3),await this.dialogService.prompt({type:gi.Error,message:m("shutdownError","An unexpected error occurred that requires a reload of this page."),detail:m("shutdownErrorDetail","The workbench was unexpectedly disposed while running."),buttons:[{label:m({key:"reload",comment:["&& denotes a mnemonic"]},"&&Reload"),run:()=>Ne.location.reload()}]})})}create(){this.setupOpenHandlers(),this.registerLabelFormatters(),this.registerCommands(),this.setupDriver()}setupDriver(){this.environmentService.enableSmokeTestDriver&&u4(this.instantiationService)}setupOpenHandlers(){this.openerService.setDefaultExternalOpener({openExternal:async t=>{let n=!1;if(this.browserEnvironmentService.options?.openerAllowedExternalUrlPrefixes){for(let i of this.browserEnvironmentService.options.openerAllowedExternalUrlPrefixes)if(t.startsWith(i)){n=!0;break}}if(Cf(t,Le.http)||Cf(t,Le.https))Wo?kV(t,!n)||await this.dialogService.prompt({type:gi.Warning,message:m("unableToOpenExternal","The browser interrupted the opening of a new tab or window. Press 'Open' to open it anyway."),detail:t,buttons:[{label:m({key:"open",comment:["&& denotes a mnemonic"]},"&&Open"),run:()=>n?lk(t):ak(t)},{label:m({key:"learnMore",comment:["&& denotes a mnemonic"]},"&&Learn More"),run:()=>this.openerService.open(J.parse("https://aka.ms/allow-vscode-popup"))}],cancelButton:!0}):n?lk(t):ak(t);else{let i=()=>{this.lifecycleService.withExpectedShutdown({disableShutdownHandling:!0},()=>Ne.location.href=t)};i();let r=async()=>{let{downloadUrl:s}=this.productService,a,l=[{label:m({key:"openExternalDialogButtonRetry.v2",comment:["&& denotes a mnemonic"]},"&&Try Again"),run:()=>i()}];s!==void 0?(a=m("openExternalDialogDetail.v2",`We launched {0} on your computer.

If {1} did not launch, try again or install it below.`,this.productService.nameLong,this.productService.nameLong),l.push({label:m({key:"openExternalDialogButtonInstall.v3",comment:["&& denotes a mnemonic"]},"&&Install"),run:async()=>{await this.openerService.open(J.parse(s)),r()}})):a=m("openExternalDialogDetailNoInstall",`We launched {0} on your computer.

If {1} did not launch, try again below.`,this.productService.nameLong,this.productService.nameLong),await this.hostService.withExpectedShutdown(()=>this.dialogService.prompt({type:gi.Info,message:m("openExternalDialogTitle","All done. You can close this tab now."),detail:a,buttons:l,cancelButton:!0}))};Cf(t,this.productService.urlProtocol)&&await r()}return!0}})}registerLabelFormatters(){this._register(this.labelService.registerFormatter({scheme:Le.vscodeUserData,priority:!0,formatting:{label:"(Settings) ${path}",separator:"/"}}))}registerCommands(){Xr.registerCommand("workbench.experimental.requestUsbDevice",async(t,n)=>XU(n)),Xr.registerCommand("workbench.experimental.requestSerialPort",async(t,n)=>QU(n)),Xr.registerCommand("workbench.experimental.requestHidDevice",async(t,n)=>JU(n))}};Cx=O([x(0,rv),x(1,fc),x(2,$u),x(3,ax),x(4,Ch),x(5,t4),x(6,vx),x(7,Oe),x(8,bc)],Cx);var KG=Y("auxiliaryWindowService");var Lv=class extends Ur{constructor(t,n,i,r,s,a){super(t,void 0,s,a);this.window=t;this.container=n;this.configurationService=r;this.whenStylesHaveLoaded=i.wait().then(()=>{}),this.registerListeners()}_onWillLayout=this._register(new D);onWillLayout=this._onWillLayout.event;_onDidLayout=this._register(new D);onDidLayout=this._onDidLayout.event;_onBeforeUnload=this._register(new D);onBeforeUnload=this._onBeforeUnload.event;_onUnload=this._register(new D);onUnload=this._onUnload.event;_onWillDispose=this._register(new D);onWillDispose=this._onWillDispose.event;whenStylesHaveLoaded;registerListeners(){this._register(j(this.window,me.BEFORE_UNLOAD,t=>this.handleBeforeUnload(t))),this._register(j(this.window,me.UNLOAD,()=>this.handleUnload())),this._register(j(this.window,"unhandledrejection",t=>{qe(t.reason),t.preventDefault()})),this._register(j(this.window,me.RESIZE,()=>this.layout())),this._register(j(this.container,me.SCROLL,()=>this.container.scrollTop=0)),Hn?(this._register(j(this.container,me.DROP,t=>st.stop(t,!0))),this._register(j(this.container,me.WHEEL,t=>t.preventDefault(),{passive:!1})),this._register(j(this.container,me.CONTEXT_MENU,t=>st.stop(t,!0)))):(this._register(j(this.window.document.body,me.DRAG_OVER,t=>st.stop(t))),this._register(j(this.window.document.body,me.DROP,t=>st.stop(t))))}handleBeforeUnload(t){let n;if(this._onBeforeUnload.fire({veto(s){s&&(n=s)}}),n){this.handleVetoBeforeClose(t,n);return}let i=this.configurationService.getValue("window.confirmBeforeClose");(i==="always"||i==="keyboardOnly"&&Ph.getInstance().isModifierPressed)&&this.confirmBeforeClose(t)}handleVetoBeforeClose(t,n){this.preventUnload(t)}preventUnload(t){t.preventDefault(),t.returnValue=m("lifecycleVeto","Changes that you made may not be saved. Please check press 'Cancel' and try again.")}confirmBeforeClose(t){this.preventUnload(t)}handleUnload(){this._onUnload.fire()}layout(){let t=Su(this.window.document.body,this.container);this._onWillLayout.fire(t),this._onDidLayout.fire(t)}createState(){return{bounds:{x:this.window.screenX,y:this.window.screenY,width:this.window.outerWidth,height:this.window.outerHeight},zoomLevel:YB(this.window)}}dispose(){this._store.isDisposed||(this._onWillDispose.fire(),super.dispose())}};Lv=O([x(3,ut),x(4,bc),x(5,Ju)],Lv);var Gl=class extends F{constructor(t,n,i,r,s,a){super();this.layoutService=t;this.dialogService=n;this.configurationService=i;this.telemetryService=r;this.hostService=s;this.environmentService=a}static DEFAULT_SIZE={width:800,height:600};static WINDOW_IDS=$d(Ne)+1;_onDidOpenAuxiliaryWindow=this._register(new D);onDidOpenAuxiliaryWindow=this._onDidOpenAuxiliaryWindow.event;windows=new Map;async open(t){ti("code/auxiliaryWindow/willOpen");let n=await this.openWindow(t);if(!n)throw new Error(m("unableToOpenWindowError","Unable to open a new window."));let i=await this.resolveWindowId(n);rS(n,i);let r=new ee,{container:s,stylesLoaded:a}=this.createContainer(n,r,t),l=this.createAuxiliaryWindow(n,s,a),d=new ee;this.windows.set(n.vscodeWindowId,l),d.add(le(()=>this.windows.delete(n.vscodeWindowId)));let c=new ee;return q.once(l.onWillDispose)(()=>{n.close(),r.dispose(),d.dispose(),c.dispose()}),d.add(fV(n)),this._onDidOpenAuxiliaryWindow.fire({window:l,disposables:c}),ti("code/auxiliaryWindow/didOpen"),this.telemetryService.publicLog2("auxiliaryWindowOpen",{bounds:!!t?.bounds}),l}createAuxiliaryWindow(t,n,i){return new Lv(t,n,i,this.configurationService,this.hostService,this.environmentService)}async openWindow(t){let n=Zd(),i={x:n.screenX,y:n.screenY,width:n.outerWidth,height:n.outerHeight},r=Math.max(t?.bounds?.width??Gl.DEFAULT_SIZE.width,vP.WIDTH),s=Math.max(t?.bounds?.height??Gl.DEFAULT_SIZE.height,vP.HEIGHT),a={x:t?.bounds?.x??Math.max(i.x+i.width/2-r/2,0),y:t?.bounds?.y??Math.max(i.y+i.height/2-s/2,0),width:r,height:s};!t?.bounds&&a.x===i.x&&a.y===i.y&&(a={...a,x:a.x+30,y:a.y+30});let l=Er(["popup=yes",`left=${a.x}`,`top=${a.y}`,`width=${a.width}`,`height=${a.height}`,t?.nativeTitlebar?"window-native-titlebar=yes":void 0,t?.disableFullscreen?"window-disable-fullscreen=yes":void 0,t?.mode===0?"window-maximized=yes":void 0,t?.mode===2?"window-fullscreen=yes":void 0]),d=Ne.open(Op?"":"about:blank",void 0,l.join(","));return!d&&Hn?(await this.dialogService.prompt({type:gi.Warning,message:m("unableToOpenWindow","The browser interrupted the opening of a new window. Press 'Retry' to try again."),detail:m("unableToOpenWindowDetail","To avoid this problem in the future, please ensure to allow popups for this website."),buttons:[{label:m({key:"retry",comment:["&& denotes a mnemonic"]},"&&Retry"),run:()=>this.openWindow(t)}],cancelButton:!0})).result:d?.window}async resolveWindowId(t){return Gl.WINDOW_IDS++}createContainer(t,n,i){t.document.createElement=function(){throw new Error('Not allowed to create elements in child window JavaScript context. Always use the main window so that "xyz instanceof HTMLElement" continues to work.')},this.applyMeta(t);let{stylesLoaded:r}=this.applyCSS(t,n),s=this.applyHTML(t,n);return{stylesLoaded:r,container:s}}applyMeta(t){for(let i of['meta[charset="utf-8"]','meta[http-equiv="Content-Security-Policy"]','meta[name="viewport"]','meta[name="theme-color"]']){let r=Ne.document.querySelector(i);if(r){let s=TV(t.document.head);if(SS(r,s),i==='meta[http-equiv="Content-Security-Policy"]'){let a=s.getAttribute("content");a&&s.setAttribute("content",a.replace(/(script-src[^\;]*)/,"script-src 'none'"))}}}let n=Ne.document.querySelector('link[rel="icon"]');if(n){let i=xV(t.document.head);SS(n,i)}}applyCSS(t,n){ti("code/auxiliaryWindow/willApplyCSS");let i=new Map,r=new Xp;r.wait().then(()=>ti("code/auxiliaryWindow/didLoadCSSStyles"));let s=n.add(new ee),a=0;function l(){--a===0&&(s.dispose(),r.open())}function d(c){if(CV(c))return;let u=t.document.head.appendChild(c.cloneNode(!0));c.tagName.toLowerCase()==="link"&&(a++,s.add(j(u,"load",l)),s.add(j(u,"error",l))),i.set(c,u)}a++;try{for(let c of Ne.document.head.querySelectorAll('link[rel="stylesheet"], style'))d(c)}finally{l()}return n.add(SV(t)),n.add(IS.observe(Ne.document.head,n,{childList:!0,subtree:!0})(c=>{for(let u of c)if(!(u.type!=="childList"||u.target.nodeName.toLowerCase()==="title"||u.target.nodeName.toLowerCase()==="script"||u.target.nodeName.toLowerCase()==="meta")){for(let p of u.addedNodes)if(Nn(p)&&(p.tagName.toLowerCase()==="style"||p.tagName.toLowerCase()==="link"))d(p);else if(p.nodeType===Node.TEXT_NODE&&p.parentNode){let h=i.get(p.parentNode);h&&(h.textContent=p.textContent)}for(let p of u.removedNodes){let h=i.get(p);h&&(h.parentNode?.removeChild(h),i.delete(p))}}})),ti("code/auxiliaryWindow/didApplyCSS"),{stylesLoaded:r}}applyHTML(t,n){ti("code/auxiliaryWindow/willApplyHTML");let i=document.createElement("div");return i.setAttribute("role","application"),yV(i,0,0,0,0,"relative"),i.style.display="flex",i.style.height="100%",i.style.flexDirection="column",t.document.body.append(i),n.add(ES(Ne.document.documentElement,t.document.documentElement)),n.add(ES(Ne.document.body,t.document.body)),n.add(ES(this.layoutService.mainContainer,i,["class"])),ti("code/auxiliaryWindow/didApplyHTML"),i}getWindow(t){return this.windows.get(t)}};Gl=O([x(0,vx),x(1,$u),x(2,ut),x(3,Xn),x(4,bc),x(5,Ju)],Gl);$i(KG,Gl,1);var vc=new no(220,70),_P=new no(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY);var Sx=class o extends fx{constructor(t,n,i,r,s){super(t,i,r,s);this.group=n}onDidChangeSizeConstraints=q.None;_onDidChangeControl=this._register(new D);onDidChangeControl=this._onDidChangeControl.event;static EDITOR_MEMENTOS=new Map;get minimumWidth(){return vc.width}get maximumWidth(){return _P.width}get minimumHeight(){return vc.height}get maximumHeight(){return _P.height}_input;get input(){return this._input}_options;get options(){return this._options}get window(){return Cu(this.group.windowId,!0).window}get scopedContextKeyService(){}create(t){super.create(t),this.createEditor(t)}async setInput(t,n,i,r){this._input=t,this._options=n}clearInput(){this._input=void 0,this._options=void 0}setOptions(t){this._options=t}setVisible(t){super.setVisible(t),this.setEditorVisible(t)}setEditorVisible(t){}setBoundarySashes(t){}getEditorMemento(t,n,i,r=10){let s=`${this.getId()}${i}`,a=o.EDITOR_MEMENTOS.get(s);return a||(a=this._register(new DP(this.getId(),i,this.getMemento(1,1),r,t,n)),o.EDITOR_MEMENTOS.set(s,a)),a}getViewState(){}saveState(){for(let[,t]of o.EDITOR_MEMENTOS)t.id===this.getId()&&t.saveState();super.saveState()}dispose(){this._input=void 0,this._options=void 0,super.dispose()}},DP=class o extends F{constructor(t,n,i,r,s,a){super();this.id=t;this.key=n;this.memento=i;this.limit=r;this.editorGroupService=s;this.configurationService=a;this.updateConfiguration(void 0),this.registerListeners()}static SHARED_EDITOR_STATE=-1;cache;cleanedUp=!1;editorDisposables;shareEditorState=!1;registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(t=>this.updateConfiguration(t)))}updateConfiguration(t){(!t||t.affectsConfiguration(void 0,"workbench.editor.sharedViewState"))&&(this.shareEditorState=this.configurationService.getValue(void 0,"workbench.editor.sharedViewState")===!0)}saveEditorState(t,n,i){let r=this.doGetResource(n);if(!r||!t)return;let s=this.doLoad(),a=s.get(r.toString());a||(a=Object.create(null),s.set(r.toString(),a)),a[t.id]=i,this.shareEditorState&&(a[o.SHARED_EDITOR_STATE]=i),yi(n)&&this.clearEditorStateOnDispose(r,n)}loadEditorState(t,n){let i=this.doGetResource(n);if(!i||!t)return;let s=this.doLoad().get(i.toString());if(s){let a=s[t.id];if(a)return a;if(this.shareEditorState)return s[o.SHARED_EDITOR_STATE]}}clearEditorState(t,n){yi(t)&&this.editorDisposables?.delete(t);let i=this.doGetResource(t);if(i){let r=this.doLoad();if(n){let s=r.get(i.toString());s&&(delete s[n.id],qc(s)&&r.delete(i.toString()))}else r.delete(i.toString())}}clearEditorStateOnDispose(t,n){this.editorDisposables||(this.editorDisposables=new Map),this.editorDisposables.has(n)||this.editorDisposables.set(n,q.once(n.onWillDispose)(()=>{this.clearEditorState(t),this.editorDisposables?.delete(n)}))}moveEditorState(t,n,i){let r=this.doLoad(),s=[...r.keys()];for(let a of s){let l=J.parse(a);if(!i.isEqualOrParent(l,t))continue;let d;if(nr(t,l))d=n;else{let u=JA(l.path,t.path);d=Ct(n,l.path.substr(u+t.path.length+1))}let c=r.get(a,0);c&&(r.delete(a),r.set(d.toString(),c))}}doGetResource(t){return yi(t)?t.resource:t}doLoad(){if(!this.cache){this.cache=new Jo(this.limit);let t=this.memento[this.key];Array.isArray(t)&&this.cache.fromJSON(t)}return this.cache}saveState(){let t=this.doLoad();this.cleanedUp||(this.cleanUp(),this.cleanedUp=!0),this.memento[this.key]=t.toJSON()}cleanUp(){let t=this.doLoad(),n=[...t.entries()];for(let[i,r]of n)for(let s of Object.keys(r)){let a=Number(s);a===o.SHARED_EDITOR_STATE&&this.shareEditorState||this.editorGroupService.getGroup(a)||(delete r[a],qc(r)&&t.delete(i))}}};var p4=class o{constructor(e,t,n){this.ctor=e;this.typeId=t;this.name=n}static instantiatedEditorPanes=new Set;static didInstantiateEditorPane(e){return o.instantiatedEditorPanes.has(e)}static _onWillInstantiateEditorPane=new D;static onWillInstantiateEditorPane=o._onWillInstantiateEditorPane.event;static create(e,t,n){return new o(e,t,n)}instantiate(e,t){o._onWillInstantiateEditorPane.fire({typeId:this.typeId});let n=e.createInstance(this.ctor,t);return o.instantiatedEditorPanes.add(this.typeId),n}describes(e){return e.getId()===this.typeId}},LP=class{mapEditorPanesToEditors=new Map;registerEditorPane(e,t){return this.mapEditorPanesToEditors.set(e,t),le(()=>{this.mapEditorPanesToEditors.delete(e)})}getEditorPane(e){let t=this.findEditorPaneDescriptors(e);if(t.length!==0)return t.length===1?t[0]:e.prefersEditorPane(t)}findEditorPaneDescriptors(e,t){let n=[];for(let i of this.mapEditorPanesToEditors.keys()){let r=this.mapEditorPanesToEditors.get(i)||[];for(let s of r){let a=s.ctor;if(!t&&e.constructor===a){n.push(i);break}else if(t&&e instanceof a){n.push(i);break}}}return!t&&n.length===0?this.findEditorPaneDescriptors(e,!0):n}getEditorPaneByType(e){return Je.find(this.mapEditorPanesToEditors.keys(),t=>t.typeId===e)}getEditorPanes(){return Array.from(this.mapEditorPanesToEditors.keys())}getEditors(){let e=[];for(let t of this.mapEditorPanesToEditors.keys()){let n=this.mapEditorPanesToEditors.get(t);n&&e.push(...n.map(i=>i.ctor))}return e}};et.add(js.EditorPane,new LP);function h4(o,e,t,n){let i=o.getAriaLabel();return t&&!t.isPinned(o)&&(i=m("preview","{0}, preview",i)),t?.isSticky(e??o)&&(i=m("pinned","{0}, pinned",i)),t&&typeof n=="number"&&n>1&&(i=`${i}, ${t.ariaLabel}`),i}var S4=T("tab.activeBackground",ss,m("tabActiveBackground","Active tab background color in an active group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),uDt=T("tab.unfocusedActiveBackground",S4,m("tabUnfocusedActiveBackground","Active tab background color in an unfocused group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),GG=T("tab.inactiveBackground",{dark:"#2D2D2D",light:"#ECECEC",hcDark:null,hcLight:null},m("tabInactiveBackground","Inactive tab background color in an active group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),pDt=T("tab.unfocusedInactiveBackground",GG,m("tabUnfocusedInactiveBackground","Inactive tab background color in an unfocused group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),np=T("tab.activeForeground",{dark:H.white,light:"#333333",hcDark:H.white,hcLight:"#292929"},m("tabActiveForeground","Active tab foreground color in an active group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),m4=T("tab.inactiveForeground",{dark:ye(np,.5),light:ye(np,.7),hcDark:H.white,hcLight:"#292929"},m("tabInactiveForeground","Inactive tab foreground color in an active group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),hDt=T("tab.unfocusedActiveForeground",{dark:ye(np,.5),light:ye(np,.7),hcDark:H.white,hcLight:"#292929"},m("tabUnfocusedActiveForeground","Active tab foreground color in an unfocused group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),mDt=T("tab.unfocusedInactiveForeground",{dark:ye(m4,.5),light:ye(m4,.5),hcDark:H.white,hcLight:"#292929"},m("tabUnfocusedInactiveForeground","Inactive tab foreground color in an unfocused group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),g4=T("tab.hoverBackground",null,m("tabHoverBackground","Tab background color when hovering. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),gDt=T("tab.unfocusedHoverBackground",{dark:ye(g4,.5),light:ye(g4,.7),hcDark:null,hcLight:null},m("tabUnfocusedHoverBackground","Tab background color in an unfocused group when hovering. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),f4=T("tab.hoverForeground",null,m("tabHoverForeground","Tab foreground color when hovering. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),fDt=T("tab.unfocusedHoverForeground",{dark:ye(f4,.5),light:ye(f4,.5),hcDark:null,hcLight:null},m("tabUnfocusedHoverForeground","Tab foreground color in an unfocused group when hovering. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),bDt=T("tab.border",{dark:"#252526",light:"#F3F3F3",hcDark:Ee,hcLight:Ee},m("tabBorder","Border to separate tabs from each other. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),vDt=T("tab.lastPinnedBorder",{dark:nm,light:nm,hcDark:Ee,hcLight:Ee},m("lastPinnedTabBorder","Border to separate pinned tabs from other tabs. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),b4=T("tab.activeBorder",null,m("tabActiveBorder","Border on the bottom of an active tab. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),yDt=T("tab.unfocusedActiveBorder",{dark:ye(b4,.5),light:ye(b4,.7),hcDark:null,hcLight:null},m("tabActiveUnfocusedBorder","Border on the bottom of an active tab in an unfocused group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),RP=T("tab.activeBorderTop",{dark:null,light:null,hcDark:null,hcLight:"#B5200D"},m("tabActiveBorderTop","Border to the top of an active tab. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),IDt=T("tab.unfocusedActiveBorderTop",{dark:ye(RP,.5),light:ye(RP,.7),hcDark:null,hcLight:"#B5200D"},m("tabActiveUnfocusedBorderTop","Border to the top of an active tab in an unfocused group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),CDt=T("tab.selectedBorderTop",RP,m("tabSelectedBorderTop","Border to the top of a selected tab. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),SDt=T("tab.selectedBackground",S4,m("tabSelectedBackground","Background of a selected tab. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),EDt=T("tab.selectedForeground",np,m("tabSelectedForeground","Foreground of a selected tab. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),v4=T("tab.hoverBorder",null,m("tabHoverBorder","Border to highlight tabs when hovering. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),TDt=T("tab.unfocusedHoverBorder",{dark:ye(v4,.5),light:ye(v4,.7),hcDark:null,hcLight:Ee},m("tabUnfocusedHoverBorder","Border to highlight tabs in an unfocused group when hovering. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),xDt=T("tab.dragAndDropBorder",{dark:np,light:np,hcDark:Pt,hcLight:Pt},m("tabDragAndDropBorder","Border between tabs to indicate that a tab can be inserted between two tabs. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),Tx=T("tab.activeModifiedBorder",{dark:"#3399CC",light:"#33AAEE",hcDark:null,hcLight:Ee},m("tabActiveModifiedBorder","Border on the top of modified active tabs in an active group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),y4=T("tab.inactiveModifiedBorder",{dark:ye(Tx,.5),light:ye(Tx,.5),hcDark:H.white,hcLight:Ee},m("tabInactiveModifiedBorder","Border on the top of modified inactive tabs in an active group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),wDt=T("tab.unfocusedActiveModifiedBorder",{dark:ye(Tx,.5),light:ye(Tx,.7),hcDark:H.white,hcLight:Ee},m("unfocusedActiveModifiedBorder","Border on the top of modified active tabs in an unfocused group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),_Dt=T("tab.unfocusedInactiveModifiedBorder",{dark:ye(y4,.5),light:ye(y4,.5),hcDark:H.white,hcLight:Ee},m("unfocusedINactiveModifiedBorder","Border on the top of modified inactive tabs in an unfocused group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),DDt=T("editorPane.background",ss,m("editorPaneBackground","Background color of the editor pane visible on the left and right side of the centered editor layout.")),LDt=T("editorGroup.emptyBackground",null,m("editorGroupEmptyBackground","Background color of an empty editor group. Editor groups are the containers of editors.")),RDt=T("editorGroup.focusedEmptyBorder",{dark:null,light:null,hcDark:so,hcLight:so},m("editorGroupFocusedEmptyBorder","Border color of an empty editor group that is focused. Editor groups are the containers of editors.")),kDt=T("editorGroupHeader.tabsBackground",{dark:"#252526",light:"#F3F3F3",hcDark:null,hcLight:null},m("tabsContainerBackground","Background color of the editor group title header when tabs are enabled. Editor groups are the containers of editors.")),MDt=T("editorGroupHeader.tabsBorder",null,m("tabsContainerBorder","Border color of the editor group title header when tabs are enabled. Editor groups are the containers of editors.")),PDt=T("editorGroupHeader.noTabsBackground",ss,m("editorGroupHeaderBackground",'Background color of the editor group title header when (`"workbench.editor.showTabs": "single"`). Editor groups are the containers of editors.')),ODt=T("editorGroupHeader.border",{dark:null,light:null,hcDark:Ee,hcLight:Ee},m("editorTitleContainerBorder","Border color of the editor group title header. Editor groups are the containers of editors.")),E4=T("editorGroup.border",{dark:"#444444",light:"#E7E7E7",hcDark:Ee,hcLight:Ee},m("editorGroupBorder","Color to separate multiple editor groups from each other. Editor groups are the containers of editors.")),T4=T("editorGroup.dropBackground",{dark:H.fromHex("#53595D").transparent(.5),light:H.fromHex("#2677CB").transparent(.18),hcDark:null,hcLight:H.fromHex("#0F4A85").transparent(.5)},m("editorDragAndDropBackground","Background color when dragging editors around. The color should have transparency so that the editor contents can still shine through.")),NDt=T("editorGroup.dropIntoPromptForeground",La,m("editorDropIntoPromptForeground","Foreground color of text shown over editors when dragging files. This text informs the user that they can hold shift to drop into the editor.")),ADt=T("editorGroup.dropIntoPromptBackground",ki,m("editorDropIntoPromptBackground","Background color of text shown over editors when dragging files. This text informs the user that they can hold shift to drop into the editor.")),FDt=T("editorGroup.dropIntoPromptBorder",{dark:null,light:null,hcDark:Ee,hcLight:Ee},m("editorDropIntoPromptBorder","Border color of text shown over editors when dragging files. This text informs the user that they can hold shift to drop into the editor.")),x4=T("sideBySideEditor.horizontalBorder",E4,m("sideBySideEditor.horizontalBorder","Color to separate two editors from each other when shown side by side in an editor group from top to bottom.")),w4=T("sideBySideEditor.verticalBorder",E4,m("sideBySideEditor.verticalBorder","Color to separate two editors from each other when shown side by side in an editor group from left to right.")),jG=T("panel.background",ss,m("panelBackground","Panel background color. Panels are shown below the editor area and contain views like output and integrated terminal.")),qG=T("panel.border",{dark:H.fromHex("#808080").transparent(.35),light:H.fromHex("#808080").transparent(.35),hcDark:Ee,hcLight:Ee},m("panelBorder","Panel border color to separate the panel from the editor. Panels are shown below the editor area and contain views like output and integrated terminal.")),Rv=T("panelTitle.activeForeground",{dark:"#E7E7E7",light:"#424242",hcDark:H.white,hcLight:Da},m("panelActiveTitleForeground","Title color for the active panel. Panels are shown below the editor area and contain views like output and integrated terminal.")),BDt=T("panelTitle.inactiveForeground",{dark:ye(Rv,.6),light:ye(Rv,.75),hcDark:H.white,hcLight:Da},m("panelInactiveTitleForeground","Title color for the inactive panel. Panels are shown below the editor area and contain views like output and integrated terminal.")),VDt=T("panelTitle.activeBorder",{dark:Rv,light:Rv,hcDark:Ee,hcLight:"#B5200D"},m("panelActiveTitleBorder","Border color for the active panel title. Panels are shown below the editor area and contain views like output and integrated terminal.")),WDt=T("panelInput.border",{dark:em,light:H.fromHex("#ddd"),hcDark:em,hcLight:em},m("panelInputBorder","Input box border for inputs in the panel.")),HDt=T("panel.dropBorder",Rv,m("panelDragAndDropBorder","Drag and drop feedback color for the panel titles. Panels are shown below the editor area and contain views like output and integrated terminal.")),UDt=T("panelSection.dropBackground",T4,m("panelSectionDragAndDropBackground","Drag and drop feedback color for the panel sections. The color should have transparency so that the panel sections can still shine through. Panels are shown below the editor area and contain views like output and integrated terminal. Panel sections are views nested within the panels.")),zDt=T("panelSectionHeader.background",{dark:H.fromHex("#808080").transparent(.2),light:H.fromHex("#808080").transparent(.2),hcDark:null,hcLight:null},m("panelSectionHeaderBackground","Panel section header background color. Panels are shown below the editor area and contain views like output and integrated terminal. Panel sections are views nested within the panels.")),KDt=T("panelSectionHeader.foreground",null,m("panelSectionHeaderForeground","Panel section header foreground color. Panels are shown below the editor area and contain views like output and integrated terminal. Panel sections are views nested within the panels.")),GDt=T("panelSectionHeader.border",Ee,m("panelSectionHeaderBorder","Panel section header border color used when multiple views are stacked vertically in the panel. Panels are shown below the editor area and contain views like output and integrated terminal. Panel sections are views nested within the panels.")),jDt=T("panelSection.border",qG,m("panelSectionBorder","Panel section border color used when multiple views are stacked horizontally in the panel. Panels are shown below the editor area and contain views like output and integrated terminal. Panel sections are views nested within the panels.")),qDt=T("panelStickyScroll.background",jG,m("panelStickyScrollBackground","Background color of sticky scroll in the panel.")),$Dt=T("panelStickyScroll.border",null,m("panelStickyScrollBorder","Border color of sticky scroll in the panel.")),YDt=T("panelStickyScroll.shadow",Jd,m("panelStickyScrollShadow","Shadow color of sticky scroll in the panel.")),$G=T("outputView.background",null,m("outputViewBackground","Output view background color."));T("outputViewStickyScroll.background",$G,m("outputViewStickyScrollBackground","Output view sticky scroll background color."));var ZDt=T("banner.background",{dark:zo,light:ro(zo,.3),hcDark:zo,hcLight:zo},m("banner.background","Banner background color. The banner is shown under the title bar of the window.")),XDt=T("banner.foreground",Ra,m("banner.foreground","Banner foreground color. The banner is shown under the title bar of the window.")),QDt=T("banner.iconForeground",mr,m("banner.iconForeground","Banner icon color. The banner is shown under the title bar of the window.")),yc=T("statusBar.foreground",{dark:"#FFFFFF",light:"#FFFFFF",hcDark:"#FFFFFF",hcLight:Da},m("statusBarForeground","Status bar foreground color when a workspace or folder is opened. The status bar is shown in the bottom of the window.")),JDt=T("statusBar.noFolderForeground",yc,m("statusBarNoFolderForeground","Status bar foreground color when no folder is opened. The status bar is shown in the bottom of the window.")),eLt=T("statusBar.background",{dark:"#007ACC",light:"#007ACC",hcDark:null,hcLight:null},m("statusBarBackground","Status bar background color when a workspace or folder is opened. The status bar is shown in the bottom of the window.")),tLt=T("statusBar.noFolderBackground",{dark:"#68217A",light:"#68217A",hcDark:null,hcLight:null},m("statusBarNoFolderBackground","Status bar background color when no folder is opened. The status bar is shown in the bottom of the window.")),YG=T("statusBar.border",{dark:null,light:null,hcDark:Ee,hcLight:Ee},m("statusBarBorder","Status bar border color separating to the sidebar and editor. The status bar is shown in the bottom of the window.")),nLt=T("statusBar.focusBorder",{dark:yc,light:yc,hcDark:null,hcLight:yc},m("statusBarFocusBorder","Status bar border color when focused on keyboard navigation. The status bar is shown in the bottom of the window.")),iLt=T("statusBar.noFolderBorder",YG,m("statusBarNoFolderBorder","Status bar border color separating to the sidebar and editor when no folder is opened. The status bar is shown in the bottom of the window.")),oLt=T("statusBarItem.activeBackground",{dark:H.white.transparent(.18),light:H.white.transparent(.18),hcDark:H.white.transparent(.18),hcLight:H.black.transparent(.18)},m("statusBarItemActiveBackground","Status bar item background color when clicking. The status bar is shown in the bottom of the window.")),rLt=T("statusBarItem.focusBorder",{dark:yc,light:yc,hcDark:null,hcLight:Pt},m("statusBarItemFocusBorder","Status bar item border color when focused on keyboard navigation. The status bar is shown in the bottom of the window.")),Ic=T("statusBarItem.hoverBackground",{dark:H.white.transparent(.12),light:H.white.transparent(.12),hcDark:H.white.transparent(.12),hcLight:H.black.transparent(.12)},m("statusBarItemHoverBackground","Status bar item background color when hovering. The status bar is shown in the bottom of the window.")),Mv=T("statusBarItem.hoverForeground",yc,m("statusBarItemHoverForeground","Status bar item foreground color when hovering. The status bar is shown in the bottom of the window.")),sLt=T("statusBarItem.compactHoverBackground",{dark:H.white.transparent(.2),light:H.white.transparent(.2),hcDark:H.white.transparent(.2),hcLight:H.black.transparent(.2)},m("statusBarItemCompactHoverBackground","Status bar item background color when hovering an item that contains two hovers. The status bar is shown in the bottom of the window.")),aLt=T("statusBarItem.prominentForeground",yc,m("statusBarProminentItemForeground","Status bar prominent items foreground color. Prominent items stand out from other status bar entries to indicate importance. The status bar is shown in the bottom of the window.")),lLt=T("statusBarItem.prominentBackground",H.black.transparent(.5),m("statusBarProminentItemBackground","Status bar prominent items background color. Prominent items stand out from other status bar entries to indicate importance. The status bar is shown in the bottom of the window.")),dLt=T("statusBarItem.prominentHoverForeground",Mv,m("statusBarProminentItemHoverForeground","Status bar prominent items foreground color when hovering. Prominent items stand out from other status bar entries to indicate importance. The status bar is shown in the bottom of the window.")),cLt=T("statusBarItem.prominentHoverBackground",{dark:H.black.transparent(.3),light:H.black.transparent(.3),hcDark:H.black.transparent(.3),hcLight:null},m("statusBarProminentItemHoverBackground","Status bar prominent items background color when hovering. Prominent items stand out from other status bar entries to indicate importance. The status bar is shown in the bottom of the window.")),uLt=T("statusBarItem.errorBackground",{dark:ro(wk,.4),light:ro(wk,.4),hcDark:null,hcLight:"#B5200D"},m("statusBarErrorItemBackground","Status bar error items background color. Error items stand out from other status bar entries to indicate error conditions. The status bar is shown in the bottom of the window.")),pLt=T("statusBarItem.errorForeground",H.white,m("statusBarErrorItemForeground","Status bar error items foreground color. Error items stand out from other status bar entries to indicate error conditions. The status bar is shown in the bottom of the window.")),hLt=T("statusBarItem.errorHoverForeground",Mv,m("statusBarErrorItemHoverForeground","Status bar error items foreground color when hovering. Error items stand out from other status bar entries to indicate error conditions. The status bar is shown in the bottom of the window.")),mLt=T("statusBarItem.errorHoverBackground",Ic,m("statusBarErrorItemHoverBackground","Status bar error items background color when hovering. Error items stand out from other status bar entries to indicate error conditions. The status bar is shown in the bottom of the window.")),gLt=T("statusBarItem.warningBackground",{dark:ro(Eo,.4),light:ro(Eo,.4),hcDark:null,hcLight:"#895503"},m("statusBarWarningItemBackground","Status bar warning items background color. Warning items stand out from other status bar entries to indicate warning conditions. The status bar is shown in the bottom of the window.")),fLt=T("statusBarItem.warningForeground",H.white,m("statusBarWarningItemForeground","Status bar warning items foreground color. Warning items stand out from other status bar entries to indicate warning conditions. The status bar is shown in the bottom of the window.")),bLt=T("statusBarItem.warningHoverForeground",Mv,m("statusBarWarningItemHoverForeground","Status bar warning items foreground color when hovering. Warning items stand out from other status bar entries to indicate warning conditions. The status bar is shown in the bottom of the window.")),vLt=T("statusBarItem.warningHoverBackground",Ic,m("statusBarWarningItemHoverBackground","Status bar warning items background color when hovering. Warning items stand out from other status bar entries to indicate warning conditions. The status bar is shown in the bottom of the window.")),yLt=T("activityBar.background",{dark:"#333333",light:"#2C2C2C",hcDark:"#000000",hcLight:"#FFFFFF"},m("activityBarBackground","Activity bar background color. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),Fm=T("activityBar.foreground",{dark:H.white,light:H.white,hcDark:H.white,hcLight:Da},m("activityBarForeground","Activity bar item foreground color when it is active. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),ILt=T("activityBar.inactiveForeground",{dark:ye(Fm,.4),light:ye(Fm,.4),hcDark:H.white,hcLight:Da},m("activityBarInActiveForeground","Activity bar item foreground color when it is inactive. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),CLt=T("activityBar.border",{dark:null,light:null,hcDark:Ee,hcLight:Ee},m("activityBarBorder","Activity bar border color separating to the side bar. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),SLt=T("activityBar.activeBorder",{dark:Fm,light:Fm,hcDark:Ee,hcLight:Ee},m("activityBarActiveBorder","Activity bar border color for the active item. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),ELt=T("activityBar.activeFocusBorder",{dark:null,light:null,hcDark:null,hcLight:"#B5200D"},m("activityBarActiveFocusBorder","Activity bar focus border color for the active item. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),TLt=T("activityBar.activeBackground",null,m("activityBarActiveBackground","Activity bar background color for the active item. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),xLt=T("activityBar.dropBorder",{dark:Fm,light:Fm,hcDark:null,hcLight:null},m("activityBarDragAndDropBorder","Drag and drop feedback color for the activity bar items. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),_4=T("activityBarBadge.background",{dark:"#007ACC",light:"#007ACC",hcDark:"#000000",hcLight:"#0F4A85"},m("activityBarBadgeBackground","Activity notification badge background color. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),D4=T("activityBarBadge.foreground",H.white,m("activityBarBadgeForeground","Activity notification badge foreground color. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),kv=T("activityBarTop.foreground",{dark:"#E7E7E7",light:"#424242",hcDark:H.white,hcLight:Da},m("activityBarTop","Active foreground color of the item in the Activity bar when it is on top / bottom. The activity allows to switch between views of the side bar.")),wLt=T("activityBarTop.activeBorder",{dark:kv,light:kv,hcDark:Ee,hcLight:"#B5200D"},m("activityBarTopActiveFocusBorder","Focus border color for the active item in the Activity bar when it is on top / bottom. The activity allows to switch between views of the side bar.")),_Lt=T("activityBarTop.activeBackground",null,m("activityBarTopActiveBackground","Background color for the active item in the Activity bar when it is on top / bottom. The activity allows to switch between views of the side bar.")),DLt=T("activityBarTop.inactiveForeground",{dark:ye(kv,.6),light:ye(kv,.75),hcDark:H.white,hcLight:Da},m("activityBarTopInActiveForeground","Inactive foreground color of the item in the Activity bar when it is on top / bottom. The activity allows to switch between views of the side bar.")),LLt=T("activityBarTop.dropBorder",kv,m("activityBarTopDragAndDropBorder","Drag and drop feedback color for the items in the Activity bar when it is on top / bottom. The activity allows to switch between views of the side bar.")),RLt=T("activityBarTop.background",null,m("activityBarTopBackground","Background color of the activity bar when set to top / bottom.")),kLt=T("profileBadge.background",{dark:"#4D4D4D",light:"#C4C4C4",hcDark:H.white,hcLight:H.black},m("profileBadgeBackground","Profile badge background color. The profile badge shows on top of the settings gear icon in the activity bar.")),MLt=T("profileBadge.foreground",{dark:H.white,light:"#333333",hcDark:H.black,hcLight:H.white},m("profileBadgeForeground","Profile badge foreground color. The profile badge shows on top of the settings gear icon in the activity bar.")),PLt=T("statusBarItem.remoteBackground",_4,m("statusBarItemHostBackground","Background color for the remote indicator on the status bar.")),ZG=T("statusBarItem.remoteForeground",D4,m("statusBarItemHostForeground","Foreground color for the remote indicator on the status bar.")),OLt=T("statusBarItem.remoteHoverForeground",Mv,m("statusBarRemoteItemHoverForeground","Foreground color for the remote indicator on the status bar when hovering.")),NLt=T("statusBarItem.remoteHoverBackground",{dark:Ic,light:Ic,hcDark:Ic,hcLight:null},m("statusBarRemoteItemHoverBackground","Background color for the remote indicator on the status bar when hovering.")),ALt=T("statusBarItem.offlineBackground","#6c1717",m("statusBarItemOfflineBackground","Status bar item background color when the workbench is offline.")),FLt=T("statusBarItem.offlineForeground",ZG,m("statusBarItemOfflineForeground","Status bar item foreground color when the workbench is offline.")),BLt=T("statusBarItem.offlineHoverForeground",Mv,m("statusBarOfflineItemHoverForeground","Status bar item foreground hover color when the workbench is offline.")),VLt=T("statusBarItem.offlineHoverBackground",{dark:Ic,light:Ic,hcDark:Ic,hcLight:null},m("statusBarOfflineItemHoverBackground","Status bar item background hover color when the workbench is offline.")),WLt=T("extensionBadge.remoteBackground",_4,m("extensionBadge.remoteBackground","Background color for the remote badge in the extensions view.")),HLt=T("extensionBadge.remoteForeground",D4,m("extensionBadge.remoteForeground","Foreground color for the remote badge in the extensions view.")),L4=T("sideBar.background",{dark:"#252526",light:"#F3F3F3",hcDark:"#000000",hcLight:"#FFFFFF"},m("sideBarBackground","Side bar background color. The side bar is the container for views like explorer and search.")),R4=T("sideBar.foreground",null,m("sideBarForeground","Side bar foreground color. The side bar is the container for views like explorer and search.")),ULt=T("sideBar.border",{dark:null,light:null,hcDark:Ee,hcLight:Ee},m("sideBarBorder","Side bar border color on the side separating to the editor. The side bar is the container for views like explorer and search.")),zLt=T("sideBarTitle.background",L4,m("sideBarTitleBackground","Side bar title background color. The side bar is the container for views like explorer and search.")),KLt=T("sideBarTitle.foreground",R4,m("sideBarTitleForeground","Side bar title foreground color. The side bar is the container for views like explorer and search.")),GLt=T("sideBar.dropBackground",T4,m("sideBarDragAndDropBackground","Drag and drop feedback color for the side bar sections. The color should have transparency so that the side bar sections can still shine through. The side bar is the container for views like explorer and search. Side bar sections are views nested within the side bar.")),jLt=T("sideBarSectionHeader.background",{dark:H.fromHex("#808080").transparent(.2),light:H.fromHex("#808080").transparent(.2),hcDark:null,hcLight:null},m("sideBarSectionHeaderBackground","Side bar section header background color. The side bar is the container for views like explorer and search. Side bar sections are views nested within the side bar.")),qLt=T("sideBarSectionHeader.foreground",R4,m("sideBarSectionHeaderForeground","Side bar section header foreground color. The side bar is the container for views like explorer and search. Side bar sections are views nested within the side bar.")),XG=T("sideBarSectionHeader.border",Ee,m("sideBarSectionHeaderBorder","Side bar section header border color. The side bar is the container for views like explorer and search. Side bar sections are views nested within the side bar.")),$Lt=T("sideBarActivityBarTop.border",XG,m("sideBarActivityBarTopBorder","Border color between the activity bar at the top/bottom and the views.")),YLt=T("sideBarStickyScroll.background",L4,m("sideBarStickyScrollBackground","Background color of sticky scroll in the side bar.")),ZLt=T("sideBarStickyScroll.border",null,m("sideBarStickyScrollBorder","Border color of sticky scroll in the side bar.")),XLt=T("sideBarStickyScroll.shadow",Jd,m("sideBarStickyScrollShadow","Shadow color of sticky scroll in the side bar.")),qa=T("titleBar.activeForeground",{dark:"#CCCCCC",light:"#333333",hcDark:"#FFFFFF",hcLight:"#292929"},m("titleBarActiveForeground","Title bar foreground when the window is active.")),k4=T("titleBar.inactiveForeground",{dark:ye(qa,.6),light:ye(qa,.6),hcDark:null,hcLight:"#292929"},m("titleBarInactiveForeground","Title bar foreground when the window is inactive.")),I4=T("titleBar.activeBackground",{dark:"#3C3C3C",light:"#DDDDDD",hcDark:"#000000",hcLight:"#FFFFFF"},m("titleBarActiveBackground","Title bar background when the window is active.")),QLt=T("titleBar.inactiveBackground",{dark:ye(I4,.6),light:ye(I4,.6),hcDark:null,hcLight:null},m("titleBarInactiveBackground","Title bar background when the window is inactive.")),JLt=T("titleBar.border",{dark:null,light:null,hcDark:Ee,hcLight:Ee},m("titleBarBorder","Title bar border color.")),QG=T("menubar.selectionForeground",qa,m("menubarSelectionForeground","Foreground color of the selected menu item in the menubar.")),C4=T("menubar.selectionBackground",{dark:Mb,light:Mb,hcDark:null,hcLight:null},m("menubarSelectionBackground","Background color of the selected menu item in the menubar.")),eRt=T("menubar.selectionBorder",{dark:null,light:null,hcDark:Pt,hcLight:Pt},m("menubarSelectionBorder","Border color of the selected menu item in the menubar.")),tRt=T("commandCenter.foreground",qa,m("commandCenter-foreground","Foreground color of the command center"),!1),nRt=T("commandCenter.activeForeground",QG,m("commandCenter-activeForeground","Active foreground color of the command center"),!1),iRt=T("commandCenter.inactiveForeground",k4,m("commandCenter-inactiveForeground","Foreground color of the command center when the window is inactive"),!1),oRt=T("commandCenter.background",{dark:H.white.transparent(.05),hcDark:null,light:H.black.transparent(.05),hcLight:null},m("commandCenter-background","Background color of the command center"),!1),rRt=T("commandCenter.activeBackground",{dark:H.white.transparent(.08),hcDark:C4,light:H.black.transparent(.08),hcLight:C4},m("commandCenter-activeBackground","Active background color of the command center"),!1),sRt=T("commandCenter.border",{dark:ye(qa,.2),hcDark:Ee,light:ye(qa,.2),hcLight:Ee},m("commandCenter-border","Border color of the command center"),!1),aRt=T("commandCenter.activeBorder",{dark:ye(qa,.3),hcDark:qa,light:ye(qa,.3),hcLight:qa},m("commandCenter-activeBorder","Active border color of the command center"),!1),lRt=T("commandCenter.inactiveBorder",ye(k4,.25),m("commandCenter-inactiveBorder","Border color of the command center when the window is inactive"),!1),dRt=T("notificationCenter.border",{dark:Pb,light:Pb,hcDark:Ee,hcLight:Ee},m("notificationCenterBorder","Notifications center border color. Notifications slide in from the bottom right of the window.")),cRt=T("notificationToast.border",{dark:Pb,light:Pb,hcDark:Ee,hcLight:Ee},m("notificationToastBorder","Notification toast border color. Notifications slide in from the bottom right of the window.")),uRt=T("notifications.foreground",La,m("notificationsForeground","Notifications foreground color. Notifications slide in from the bottom right of the window.")),Ex=T("notifications.background",ki,m("notificationsBackground","Notifications background color. Notifications slide in from the bottom right of the window.")),pRt=T("notificationLink.foreground",MS,m("notificationsLink","Notification links foreground color. Notifications slide in from the bottom right of the window.")),hRt=T("notificationCenterHeader.foreground",null,m("notificationCenterHeaderForeground","Notifications center header foreground color. Notifications slide in from the bottom right of the window.")),JG=T("notificationCenterHeader.background",{dark:So(Ex,.3),light:ro(Ex,.05),hcDark:Ex,hcLight:Ex},m("notificationCenterHeaderBackground","Notifications center header background color. Notifications slide in from the bottom right of the window.")),mRt=T("notifications.border",JG,m("notificationsBorder","Notifications border color separating from other notifications in the notifications center. Notifications slide in from the bottom right of the window.")),gRt=T("notificationsErrorIcon.foreground",Mu,m("notificationsErrorIconForeground","The color used for the icon of error notifications. Notifications slide in from the bottom right of the window.")),fRt=T("notificationsWarningIcon.foreground",Eo,m("notificationsWarningIconForeground","The color used for the icon of warning notifications. Notifications slide in from the bottom right of the window.")),bRt=T("notificationsInfoIcon.foreground",mr,m("notificationsInfoIconForeground","The color used for the icon of info notifications. Notifications slide in from the bottom right of the window.")),vRt=T("window.activeBorder",{dark:null,light:null,hcDark:Ee,hcLight:Ee},m("windowActiveBorder","The color used for the border of the window when it is active. Only supported in the macOS and Linux desktop client when using the custom title bar.")),yRt=T("window.inactiveBorder",{dark:null,light:null,hcDark:Ee,hcLight:Ee},m("windowInactiveBorder","The color used for the border of the window when it is inactive. Only supported in the macOS and Linux desktop client when using the custom title bar."));var Cc=class extends Sx{constructor(t,n,i,r,s,a,l,d,c,u){super(t,n,r,d,a);this.instantiationService=s;this.textResourceConfigurationService=l;this.editorService=c;this.editorGroupService=u;this.viewState=this.getEditorMemento(u,l,i,100)}viewState;groupListener=this._register(new un);editorViewStateDisposables;setEditorVisible(t){this.groupListener.value=this.group.onWillCloseEditor(n=>this.onWillCloseEditor(n)),super.setEditorVisible(t)}onWillCloseEditor(t){let n=t.editor;n===this.input&&this.updateEditorViewState(n)}clearInput(){this.updateEditorViewState(this.input),super.clearInput()}saveState(){this.updateEditorViewState(this.input),super.saveState()}updateEditorViewState(t){if(!t||!this.tracksEditorViewState(t))return;let n=this.toEditorViewStateResource(t);n&&(this.tracksDisposedEditorViewState()||(this.editorViewStateDisposables||(this.editorViewStateDisposables=new Map),this.editorViewStateDisposables.has(t)||this.editorViewStateDisposables.set(t,q.once(t.onWillDispose)(()=>{this.clearEditorViewState(n,this.group),this.editorViewStateDisposables?.delete(t)}))),t.isDisposed()&&!this.tracksDisposedEditorViewState()||!this.shouldRestoreEditorViewState(t)&&!this.group.contains(t)?this.clearEditorViewState(n,this.group):t.isDisposed()||this.saveEditorViewState(n))}shouldRestoreEditorViewState(t,n){return n?.newInGroup?this.textResourceConfigurationService.getValue(Ks.getOriginalUri(t,{supportSideBySide:1}),"workbench.editor.restoreViewState")!==!1:!0}getViewState(){let t=this.input;if(!t||!this.tracksEditorViewState(t))return;let n=this.toEditorViewStateResource(t);if(n)return this.computeEditorViewState(n)}saveEditorViewState(t){let n=this.computeEditorViewState(t);n&&this.viewState.saveEditorState(this.group,t,n)}loadEditorViewState(t,n){if(!t||!this.tracksEditorViewState(t)||!this.shouldRestoreEditorViewState(t,n))return;let i=this.toEditorViewStateResource(t);if(i)return this.viewState.loadEditorState(this.group,i)}moveEditorViewState(t,n,i){return this.viewState.moveEditorState(t,n,i)}clearEditorViewState(t,n){this.viewState.clearEditorState(t,n)}dispose(){if(super.dispose(),this.editorViewStateDisposables){for(let[,t]of this.editorViewStateDisposables)t.dispose();this.editorViewStateDisposables=void 0}}tracksDisposedEditorViewState(){return!1}};Cc=O([x(3,Xn),x(4,Oe),x(5,Ln),x(6,Hr),x(7,Ko),x(8,Tn),x(9,br)],Cc);function tj(o){let e=o;return typeof e?.primary=="object"&&typeof e.secondary=="object"}var $s=class extends Cc{constructor(t,n,i,r,s,a,l,d,c){super($s.ID,t,$s.VIEW_STATE_PREFERENCE_KEY,n,i,s,l,r,d,c);this.configurationService=a;this.registerListeners()}static ID=GU;static SIDE_BY_SIDE_LAYOUT_SETTING="workbench.editor.splitInGroupLayout";static VIEW_STATE_PREFERENCE_KEY="sideBySideEditorViewState";get minimumPrimaryWidth(){return this.primaryEditorPane?this.primaryEditorPane.minimumWidth:0}get maximumPrimaryWidth(){return this.primaryEditorPane?this.primaryEditorPane.maximumWidth:Number.POSITIVE_INFINITY}get minimumPrimaryHeight(){return this.primaryEditorPane?this.primaryEditorPane.minimumHeight:0}get maximumPrimaryHeight(){return this.primaryEditorPane?this.primaryEditorPane.maximumHeight:Number.POSITIVE_INFINITY}get minimumSecondaryWidth(){return this.secondaryEditorPane?this.secondaryEditorPane.minimumWidth:0}get maximumSecondaryWidth(){return this.secondaryEditorPane?this.secondaryEditorPane.maximumWidth:Number.POSITIVE_INFINITY}get minimumSecondaryHeight(){return this.secondaryEditorPane?this.secondaryEditorPane.minimumHeight:0}get maximumSecondaryHeight(){return this.secondaryEditorPane?this.secondaryEditorPane.maximumHeight:Number.POSITIVE_INFINITY}set minimumWidth(t){}set maximumWidth(t){}set minimumHeight(t){}set maximumHeight(t){}get minimumWidth(){return this.minimumPrimaryWidth+this.minimumSecondaryWidth}get maximumWidth(){return this.maximumPrimaryWidth+this.maximumSecondaryWidth}get minimumHeight(){return this.minimumPrimaryHeight+this.minimumSecondaryHeight}get maximumHeight(){return this.maximumPrimaryHeight+this.maximumSecondaryHeight}_boundarySashes;onDidCreateEditors=this._register(new D);_onDidChangeSizeConstraints=this._register(new Yr);onDidChangeSizeConstraints=q.any(this.onDidCreateEditors.event,this._onDidChangeSizeConstraints.event);_onDidChangeSelection=this._register(new D);onDidChangeSelection=this._onDidChangeSelection.event;primaryEditorPane=void 0;secondaryEditorPane=void 0;primaryEditorContainer;secondaryEditorContainer;splitview;splitviewDisposables=this._register(new ee);editorDisposables=this._register(new ee);orientation=this.configurationService.getValue($s.SIDE_BY_SIDE_LAYOUT_SETTING)==="vertical"?0:1;dimension=new no(0,0);lastFocusedSide=void 0;registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(t=>this.onConfigurationUpdated(t)))}onConfigurationUpdated(t){t.affectsConfiguration($s.SIDE_BY_SIDE_LAYOUT_SETTING)&&(this.orientation=this.configurationService.getValue($s.SIDE_BY_SIDE_LAYOUT_SETTING)==="vertical"?0:1,this.splitview&&this.recreateSplitview())}recreateSplitview(){let t=fn(this.getContainer()),n=this.getSplitViewRatio();this.splitview&&(this.splitview.el.remove(),this.splitviewDisposables.clear()),this.createSplitView(t,n),this.layout(this.dimension)}getSplitViewRatio(){let t;if(this.splitview){let n=this.splitview.getViewSize(0),i=this.splitview.getViewSize(1);if(Math.abs(n-i)>1){let r=this.splitview.orientation===1?this.dimension.width:this.dimension.height;t=n/r}}return t}createEditor(t){t.classList.add("side-by-side-editor"),this.secondaryEditorContainer=Ge(".side-by-side-editor-container.editor-instance"),this.primaryEditorContainer=Ge(".side-by-side-editor-container.editor-instance"),this.createSplitView(t)}createSplitView(t,n){this.splitview=this.splitviewDisposables.add(new Vu(t,{orientation:this.orientation})),this.splitviewDisposables.add(this.splitview.onDidSashReset(()=>this.splitview?.distributeViewSizes())),this.orientation===1?this.splitview.orthogonalEndSash=this._boundarySashes?.bottom:(this.splitview.orthogonalStartSash=this._boundarySashes?.left,this.splitview.orthogonalEndSash=this._boundarySashes?.right);let i=ac.Distribute,r=ac.Distribute;if(n){let l=this.splitview.orientation===1?this.dimension.width:this.dimension.height;i=Math.round(l*n),r=l-i,this.splitview.layout(this.orientation===1?this.dimension.width:this.dimension.height)}let s=fn(this.secondaryEditorContainer);this.splitview.addView({element:s,layout:l=>this.layoutPane(this.secondaryEditorPane,l),minimumSize:this.orientation===1?vc.width:vc.height,maximumSize:Number.POSITIVE_INFINITY,onDidChange:q.None},i);let a=fn(this.primaryEditorContainer);this.splitview.addView({element:a,layout:l=>this.layoutPane(this.primaryEditorPane,l),minimumSize:this.orientation===1?vc.width:vc.height,maximumSize:Number.POSITIVE_INFINITY,onDidChange:q.None},r),this.updateStyles()}getTitle(){return this.input?this.input.getName():m("sideBySideEditor","Side by Side Editor")}async setInput(t,n,i,r){let s=this.input;await super.setInput(t,n,i,r),(!s||!t.matches(s))&&(s&&this.disposeEditors(),this.createEditors(t));let{primary:a,secondary:l,viewState:d}=this.loadViewState(t,n,i);if(this.lastFocusedSide=d?.focus,typeof d?.ratio=="number"&&this.splitview){let c=this.splitview.orientation===1?this.dimension.width:this.dimension.height;this.splitview.resizeView(0,Math.round(c*d.ratio))}else this.splitview?.distributeViewSizes();await Promise.all([this.secondaryEditorPane?.setInput(t.secondary,l,i,r),this.primaryEditorPane?.setInput(t.primary,a,i,r)]),typeof n?.target=="number"&&(this.lastFocusedSide=n.target)}loadViewState(t,n,i){let r=tj(n?.viewState)?n?.viewState:this.loadEditorViewState(t,i),s=Object.create(null),a;return n?.target===2?a={...n}:s={...n},s.viewState=r?.primary,r?.secondary&&(a?a.viewState=r?.secondary:a={viewState:r.secondary}),{primary:s,secondary:a,viewState:r}}createEditors(t){this.secondaryEditorPane=this.doCreateEditor(t.secondary,fn(this.secondaryEditorContainer)),this.primaryEditorPane=this.doCreateEditor(t.primary,fn(this.primaryEditorContainer)),this.layout(this.dimension),this._onDidChangeSizeConstraints.input=q.any(q.map(this.secondaryEditorPane.onDidChangeSizeConstraints,()=>{}),q.map(this.primaryEditorPane.onDidChangeSizeConstraints,()=>{})),this.onDidCreateEditors.fire(void 0),this.editorDisposables.add(this.primaryEditorPane.onDidFocus(()=>this.onDidFocusChange(1))),this.editorDisposables.add(this.secondaryEditorPane.onDidFocus(()=>this.onDidFocusChange(2)))}doCreateEditor(t,n){let i=et.as(js.EditorPane).getEditorPane(t);if(!i)throw new Error("No editor pane descriptor for editor found");let r=i.instantiate(this.instantiationService,this.group);return r.create(n),r.setVisible(this.isVisible()),TP(r)&&this.editorDisposables.add(r.onDidChangeSelection(s=>this._onDidChangeSelection.fire(s))),this.editorDisposables.add(r),r}onDidFocusChange(t){this.lastFocusedSide=t,this._onDidChangeControl.fire()}getSelection(){let t=this.getLastFocusedEditorPane();if(TP(t)){let n=t.getSelection();if(n)return new kP(n,t===this.primaryEditorPane?1:2)}}setOptions(t){super.setOptions(t),typeof t?.target=="number"&&(this.lastFocusedSide=t.target),this.getLastFocusedEditorPane()?.setOptions(t)}setEditorVisible(t){this.primaryEditorPane?.setVisible(t),this.secondaryEditorPane?.setVisible(t),super.setEditorVisible(t)}clearInput(){super.clearInput(),this.primaryEditorPane?.clearInput(),this.secondaryEditorPane?.clearInput(),this.disposeEditors()}focus(){super.focus(),this.getLastFocusedEditorPane()?.focus()}getLastFocusedEditorPane(){return this.lastFocusedSide===2?this.secondaryEditorPane:this.primaryEditorPane}layout(t){this.dimension=t,fn(this.splitview).layout(this.orientation===1?t.width:t.height)}setBoundarySashes(t){this._boundarySashes=t,this.splitview&&(this.splitview.orthogonalEndSash=t.bottom)}layoutPane(t,n){t?.layout(this.orientation===1?new no(n,this.dimension.height):new no(this.dimension.width,n))}getControl(){return this.getLastFocusedEditorPane()?.getControl()}getPrimaryEditorPane(){return this.primaryEditorPane}getSecondaryEditorPane(){return this.secondaryEditorPane}tracksEditorViewState(t){return t instanceof Ii}computeEditorViewState(t){if(!this.input||!nr(t,this.toEditorViewStateResource(this.input)))return;let n=this.primaryEditorPane?.getViewState(),i=this.secondaryEditorPane?.getViewState();if(!(!n||!i))return{primary:n,secondary:i,focus:this.lastFocusedSide,ratio:this.getSplitViewRatio()}}toEditorViewStateResource(t){let n,i;if(t instanceof Ii&&(n=t.primary.resource,i=t.secondary.resource),!(!i||!n))return J.from({scheme:"sideBySide",path:`${Ah(i.toString())}${Ah(n.toString())}`})}updateStyles(){super.updateStyles(),this.primaryEditorContainer&&(this.orientation===1?(this.primaryEditorContainer.style.borderLeftWidth="1px",this.primaryEditorContainer.style.borderLeftStyle="solid",this.primaryEditorContainer.style.borderLeftColor=this.getColor(w4)??"",this.primaryEditorContainer.style.borderTopWidth="0"):(this.primaryEditorContainer.style.borderTopWidth="1px",this.primaryEditorContainer.style.borderTopStyle="solid",this.primaryEditorContainer.style.borderTopColor=this.getColor(x4)??"",this.primaryEditorContainer.style.borderLeftWidth="0"))}dispose(){this.disposeEditors(),super.dispose()}disposeEditors(){this.editorDisposables.clear(),this.secondaryEditorPane=void 0,this.primaryEditorPane=void 0,this.lastFocusedSide=void 0,this.secondaryEditorContainer&&fi(this.secondaryEditorContainer),this.primaryEditorContainer&&fi(this.primaryEditorContainer)}};$s=O([x(1,Xn),x(2,Oe),x(3,Ko),x(4,Ln),x(5,ut),x(6,Hr),x(7,Tn),x(8,br)],$s);var kP=class o{constructor(e,t){this.selection=e;this.side=t}compare(e){return e instanceof o?this.side!==e.side?3:this.selection.compare(e.selection):3}restore(e){let t={...e,target:this.side};return this.selection.restore(t)}};var Sc=class extends Cc{constructor(t,n,i,r,s,a,l,d,c,u){super(t,n,Sc.VIEW_STATE_PREFERENCE_KEY,i,r,s,a,l,d,c);this.fileService=u;this._register(this.textResourceConfigurationService.onDidChangeConfiguration(p=>this.handleConfigurationChangeEvent(p))),this._register(q.any(this.editorGroupService.onDidAddGroup,this.editorGroupService.onDidRemoveGroup)(()=>{let p=this.computeAriaLabel();this.editorContainer?.setAttribute("aria-label",p),this.updateEditorControlOptions({ariaLabel:p})})),this._register(this.fileService.onDidChangeFileSystemProviderCapabilities(p=>this.onDidChangeFileSystemProvider(p.scheme))),this._register(this.fileService.onDidChangeFileSystemProviderRegistrations(p=>this.onDidChangeFileSystemProvider(p.scheme)))}static VIEW_STATE_PREFERENCE_KEY="textEditorViewState";_onDidChangeSelection=this._register(new D);onDidChangeSelection=this._onDidChangeSelection.event;_onDidChangeScroll=this._register(new D);onDidChangeScroll=this._onDidChangeScroll.event;editorContainer;hasPendingConfigurationChange;lastAppliedEditorOptions;inputListener=this._register(new un);handleConfigurationChangeEvent(t){let n=this.getActiveResource();this.shouldHandleConfigurationChangeEvent(t,n)&&(this.isVisible()?this.updateEditorConfiguration(n):this.hasPendingConfigurationChange=!0)}shouldHandleConfigurationChangeEvent(t,n){return t.affectsConfiguration(n,"editor")||t.affectsConfiguration(n,"problems.visibility")}consumePendingConfigurationChangeEvent(){this.hasPendingConfigurationChange&&(this.updateEditorConfiguration(),this.hasPendingConfigurationChange=!1)}computeConfiguration(t){let n=an(t.editor)?Md(t.editor):Object.create(null);return Object.assign(n,this.getConfigurationOverrides(t)),n.ariaLabel=this.computeAriaLabel(),n}computeAriaLabel(){return this.input?h4(this.input,void 0,this.group,this.editorGroupService.count):m("editor","Editor")}onDidChangeFileSystemProvider(t){this.input&&this.getActiveResource()?.scheme===t&&this.updateReadonly(this.input)}onDidChangeInputCapabilities(t){this.input===t&&this.updateReadonly(t)}updateReadonly(t){this.updateEditorControlOptions({...this.getReadonlyConfiguration(t.isReadonly())})}getReadonlyConfiguration(t){return{readOnly:!!t,readOnlyMessage:typeof t!="boolean"?t:void 0}}getConfigurationOverrides(t){return{overviewRulerLanes:3,lineNumbersMinChars:3,fixedOverflowWidgets:!0,...this.getReadonlyConfiguration(this.input?.isReadonly()),renderValidationDecorations:t.problems?.visibility!==!1?"on":"off"}}createEditor(t){this.editorContainer=t,this.createEditorControl(t,this.computeConfiguration(this.textResourceConfigurationService.getValue(this.getActiveResource()))),this.registerCodeEditorListeners()}registerCodeEditorListeners(){let t=this.getMainControl();t&&(this._register(t.onDidChangeModelLanguage(()=>this.updateEditorConfiguration())),this._register(t.onDidChangeModel(()=>this.updateEditorConfiguration())),this._register(t.onDidChangeCursorPosition(n=>this._onDidChangeSelection.fire({reason:this.toEditorPaneSelectionChangeReason(n)}))),this._register(t.onDidChangeModelContent(()=>this._onDidChangeSelection.fire({reason:3}))),this._register(t.onDidScrollChange(()=>this._onDidChangeScroll.fire())))}toEditorPaneSelectionChangeReason(t){switch(t.source){case"api":return 1;case"code.navigation":return 4;case"code.jump":return 5;default:return 2}}getSelection(){let t=this.getMainControl();if(t){let n=t.getSelection();if(n)return new MP(n)}}async setInput(t,n,i,r){await super.setInput(t,n,i,r),this.inputListener.value=t.onDidChangeCapabilities(()=>this.onDidChangeInputCapabilities(t)),this.updateEditorConfiguration(),fn(this.editorContainer).setAttribute("aria-label",this.computeAriaLabel())}clearInput(){this.inputListener.clear(),super.clearInput()}getScrollPosition(){let t=this.getMainControl();if(!t)throw new Error("Control has not yet been initialized");return{scrollTop:t.getScrollTop()-t.getTopForLineNumber(1),scrollLeft:t.getScrollLeft()}}setScrollPosition(t){let n=this.getMainControl();if(!n)throw new Error("Control has not yet been initialized");n.setScrollTop(t.scrollTop),t.scrollLeft&&n.setScrollLeft(t.scrollLeft)}setEditorVisible(t){t&&this.consumePendingConfigurationChangeEvent(),super.setEditorVisible(t)}toEditorViewStateResource(t){return t.resource}updateEditorConfiguration(t=this.getActiveResource()){let n;if(t&&(n=this.textResourceConfigurationService.getValue(t)),!n)return;let i=this.computeConfiguration(n),r=i;this.lastAppliedEditorOptions&&(r=JF(this.lastAppliedEditorOptions,r)),Object.keys(r).length>0&&(this.lastAppliedEditorOptions=i,this.updateEditorControlOptions(r))}getActiveResource(){let t=this.getMainControl();if(t){let n=t.getModel();if(n)return n.uri}if(this.input)return this.input.resource}dispose(){this.lastAppliedEditorOptions=void 0,super.dispose()}};Sc=O([x(2,Xn),x(3,Oe),x(4,Ln),x(5,Hr),x(6,Ko),x(7,Tn),x(8,br),x(9,Bt)],Sc);var MP=class o{constructor(e){this.textSelection=e}static TEXT_EDITOR_SELECTION_THRESHOLD=10;compare(e){if(!(e instanceof o))return 3;let t=Math.min(this.textSelection.selectionStartLineNumber,this.textSelection.positionLineNumber),n=Math.min(e.textSelection.selectionStartLineNumber,e.textSelection.positionLineNumber);return t===n?1:Math.abs(t-n)<o.TEXT_EDITOR_SELECTION_THRESHOLD?2:3}restore(e){return{...e,selection:this.textSelection,selectionRevealType:1}}log(){return`line: ${this.textSelection.startLineNumber}-${this.textSelection.endLineNumber}, col:  ${this.textSelection.startColumn}-${this.textSelection.endColumn}`}};function PP(o,e,t){let n=!1,i=oj(o);if(Ev(i)&&(e.restoreViewState(i),n=!0),o.selection){let r={startLineNumber:o.selection.startLineNumber,startColumn:o.selection.startColumn,endLineNumber:o.selection.endLineNumber??o.selection.startLineNumber,endColumn:o.selection.endColumn??o.selection.startColumn};e.setSelection(r,o.selectionSource??"code.navigation"),o.selectionRevealType===2?e.revealRangeNearTop(r,t):o.selectionRevealType===3?e.revealRangeNearTopIfOutsideViewport(r,t):o.selectionRevealType===1?e.revealRangeInCenterIfOutsideViewport(r,t):e.revealRangeInCenter(r,t),n=!0}return n}function oj(o){if(!o.selection||!o.viewState)return o.viewState;let e=o.viewState;if(e.modified)return e.modified.cursorState=[],e;let t=o.viewState;return t.cursorState&&(t.cursorState=[]),t}var Bm=class extends xa{_originalModel;get originalModel(){return this._originalModel}_modifiedModel;get modifiedModel(){return this._modifiedModel}constructor(e,t){super(),this._originalModel=e,this._modifiedModel=t}async resolve(){await Promise.all([this._originalModel?.resolve(),this._modifiedModel?.resolve()])}isResolved(){return!!(this._originalModel?.isResolved()&&this._modifiedModel?.isResolved())}dispose(){super.dispose()}};var Vm=class extends Bm{_originalModel;get originalModel(){return this._originalModel}_modifiedModel;get modifiedModel(){return this._modifiedModel}_textDiffEditorModel=void 0;get textDiffEditorModel(){return this._textDiffEditorModel}constructor(e,t){super(e,t),this._originalModel=e,this._modifiedModel=t,this.updateTextDiffEditorModel()}async resolve(){await super.resolve(),this.updateTextDiffEditorModel()}updateTextDiffEditorModel(){this.originalModel?.isResolved()&&this.modifiedModel?.isResolved()&&(this._textDiffEditorModel?(this._textDiffEditorModel.original=this.originalModel.textEditorModel,this._textDiffEditorModel.modified=this.modifiedModel.textEditorModel):this._textDiffEditorModel={original:this.originalModel.textEditorModel,modified:this.modifiedModel.textEditorModel})}isResolved(){return!!this._textDiffEditorModel}isReadonly(){return!!this.modifiedModel&&this.modifiedModel.isReadonly()}dispose(){this._textDiffEditorModel=void 0,super.dispose()}};var $o=class extends Ii{constructor(t,n,i,r,s,a){super(t,n,i,r,a);this.original=i;this.modified=r;this.forceOpenAsBinary=s}static ID="workbench.editors.diffEditorInput";get typeId(){return $o.ID}get editorId(){return this.modified.editorId===this.original.editorId?this.modified.editorId:void 0}get capabilities(){let t=super.capabilities;return this.labels.forceDescription&&(t|=64),t}cachedModel=void 0;labels=this.computeLabels();computeLabels(){let t,n=!1;if(this.preferredName)t=this.preferredName;else{let u=this.original.getName(),p=this.modified.getName();t=m("sideBySideLabels","{0} \u2194 {1}",u,p),n=u===p}let i,r,s;if(this.preferredDescription)i=this.preferredDescription,r=this.preferredDescription,s=this.preferredDescription;else{i=this.computeLabel(this.original.getDescription(0),this.modified.getDescription(0)),s=this.computeLabel(this.original.getDescription(2),this.modified.getDescription(2));let u=this.original.getDescription(1),p=this.modified.getDescription(1);if(typeof u=="string"&&typeof p=="string"&&(u||p)){let[h,f]=lH([u,p]);r=this.computeLabel(h,f)}}let a=this.computeLabel(this.original.getTitle(0)??this.original.getName(),this.modified.getTitle(0)??this.modified.getName()," \u2194 "),l=this.computeLabel(this.original.getTitle(1)??this.original.getName(),this.modified.getTitle(1)??this.modified.getName()," \u2194 "),d=this.computeLabel(this.original.getTitle(2)??this.original.getName(),this.modified.getTitle(2)??this.modified.getName()," \u2194 "),c=this.getPreferredTitle();return c&&(a=`${c} (${a})`,l=`${c} (${l})`,d=`${c} (${d})`),{name:t,shortDescription:i,mediumDescription:r,longDescription:s,forceDescription:n,shortTitle:a,mediumTitle:l,longTitle:d}}computeLabel(t,n,i=" - "){if(!(!t||!n))return t===n?n:`${t}${i}${n}`}getName(){return this.labels.name}getDescription(t=1){switch(t){case 0:return this.labels.shortDescription;case 2:return this.labels.longDescription;case 1:default:return this.labels.mediumDescription}}getTitle(t){switch(t){case 0:return this.labels.shortTitle;case 2:return this.labels.longTitle;default:case 1:return this.labels.mediumTitle}}async resolve(){let t=await this.createModel();return this.cachedModel?.dispose(),this.cachedModel=t,this.cachedModel}prefersEditorPane(t){return this.forceOpenAsBinary?t.find(n=>n.typeId===jU):t.find(n=>n.typeId===hx)}async createModel(){let[t,n]=await Promise.all([this.original.resolve(),this.modified.resolve()]);return n instanceof zs&&t instanceof zs?new Vm(t,n):new Bm(Uk(t)?t:void 0,Uk(n)?n:void 0)}toUntyped(t){let n=super.toUntyped(t);if(n)return{...n,modified:n.primary,original:n.secondary}}matches(t){return this===t?!0:t instanceof $o?this.modified.matches(t.modified)&&this.original.matches(t.original)&&t.forceOpenAsBinary===this.forceOpenAsBinary:Gs(t)?this.modified.matches(t.modified)&&this.original.matches(t.original):!1}dispose(){this.cachedModel&&(this.cachedModel.dispose(),this.cachedModel=void 0),super.dispose()}};$o=O([x(5,Tn)],$o);var $a=Y("codeEditorService");var ip=class{id;precondition;_kbOpts;_menuOpts;metadata;constructor(e){this.id=e.id,this.precondition=e.precondition,this._kbOpts=e.kbOpts,this._menuOpts=e.menuOpts,this.metadata=e.metadata}register(){if(Array.isArray(this._menuOpts)?this._menuOpts.forEach(this._registerMenuItem,this):this._menuOpts&&this._registerMenuItem(this._menuOpts),this._kbOpts){let e=Array.isArray(this._kbOpts)?this._kbOpts:[this._kbOpts];for(let t of e){let n=t.kbExpr;this.precondition&&(n?n=Kt.and(n,this.precondition):n=this.precondition);let i={id:this.id,weight:t.weight,args:t.args,when:n,primary:t.primary,secondary:t.secondary,win:t.win,linux:t.linux,mac:t.mac};Hd.registerKeybindingRule(i)}}Xr.registerCommand({id:this.id,handler:(e,t)=>this.runCommand(e,t),metadata:this.metadata})}_registerMenuItem(e){_u.appendMenuItem(e.menuId,{group:e.group,command:{id:this.id,title:e.title,icon:e.icon,precondition:this.precondition},when:e.when,order:e.order})}},Pv=class extends ip{_implementations=[];addImplementation(e,t,n,i){return this._implementations.push({priority:e,name:t,implementation:n,when:i}),this._implementations.sort((r,s)=>s.priority-r.priority),{dispose:()=>{for(let r=0;r<this._implementations.length;r++)if(this._implementations[r].implementation===n){this._implementations.splice(r,1);return}}}}runCommand(e,t){let n=e.get(Gt),i=e.get(_t);n.trace(`Executing Command '${this.id}' which has ${this._implementations.length} bound.`);for(let r of this._implementations){if(r.when){let a=i.getContext(Io());if(!r.when.evaluate(a))continue}let s=r.implementation(e,t);if(s)return n.trace(`Command '${this.id}' was handled by '${r.name}'.`),typeof s=="boolean"?void 0:s}n.trace(`The Command '${this.id}' was not handled by any implementation.`)}},xx=class extends ip{constructor(t,n){super(n);this.command=t}runCommand(t,n){return this.command.runCommand(t,n)}},Ov=class o extends ip{static bindToContribution(e){return class extends o{_callback;constructor(n){super(n),this._callback=n.handler}runEditorCommand(n,i,r){let s=e(i);s&&this._callback(s,r)}}}static runEditorCommand(e,t,n,i){let r=e.get($a),s=r.getFocusedCodeEditor()||r.getActiveCodeEditor();if(s)return s.invokeWithinContext(a=>{if(a.get(_t).contextMatchesRules(n??void 0))return i(a,s,t)})}runCommand(e,t){return o.runEditorCommand(e,t,this.precondition,(n,i,r)=>this.runEditorCommand(n,i,r))}};function je(o){return Ya.INSTANCE.registerEditorCommand(o),o}function M4(o,e,t){Ya.INSTANCE.registerEditorContribution(o,e,t)}var op;(r=>{function o(s){return Ya.INSTANCE.getEditorCommand(s)}r.getEditorCommand=o;function e(){return Ya.INSTANCE.getEditorActions()}r.getEditorActions=e;function t(){return Ya.INSTANCE.getEditorContributions()}r.getEditorContributions=t;function n(s){return Ya.INSTANCE.getEditorContributions().filter(a=>s.indexOf(a.id)>=0)}r.getSomeEditorContributions=n;function i(){return Ya.INSTANCE.getDiffEditorContributions()}r.getDiffEditorContributions=i})(op||={});var sj={EditorCommonContributions:"editor.contributions"},Ya=class o{static INSTANCE=new o;editorContributions=[];diffEditorContributions=[];editorActions=[];editorCommands=Object.create(null);constructor(){}registerEditorContribution(e,t,n){this.editorContributions.push({id:e,ctor:t,instantiation:n})}getEditorContributions(){return this.editorContributions.slice(0)}registerDiffEditorContribution(e,t){this.diffEditorContributions.push({id:e,ctor:t})}getDiffEditorContributions(){return this.diffEditorContributions.slice(0)}registerEditorAction(e){e.register(),this.editorActions.push(e)}getEditorActions(){return this.editorActions}registerEditorCommand(e){e.register(),this.editorCommands[e.id]=e}getEditorCommand(e){return this.editorCommands[e]||null}};et.add(sj.EditorCommonContributions,Ya.INSTANCE);function Nv(o){return o.register(),o}var NP=Nv(new Pv({id:"undo",precondition:void 0,kbOpts:{weight:0,primary:2104},menuOpts:[{menuId:bi.MenubarEditMenu,group:"1_do",title:m({key:"miUndo",comment:["&& denotes a mnemonic"]},"&&Undo"),order:1},{menuId:bi.CommandPalette,group:"",title:m("undo","Undo"),order:1}]}));Nv(new xx(NP,{id:"default:undo",precondition:void 0}));var AP=Nv(new Pv({id:"redo",precondition:void 0,kbOpts:{weight:0,primary:2103,secondary:[3128],mac:{primary:3128}},menuOpts:[{menuId:bi.MenubarEditMenu,group:"1_do",title:m({key:"miRedo",comment:["&& denotes a mnemonic"]},"&&Redo"),order:2},{menuId:bi.CommandPalette,group:"",title:m("redo","Redo"),order:1}]}));Nv(new xx(AP,{id:"default:redo",precondition:void 0}));var P4=Nv(new Pv({id:"editor.action.selectAll",precondition:void 0,kbOpts:{weight:0,kbExpr:null,primary:2079},menuOpts:[{menuId:bi.MenubarSelectionMenu,group:"1_basic",title:m({key:"miSelectAll",comment:["&& denotes a mnemonic"]},"&&Select All"),order:1},{menuId:bi.CommandPalette,group:"",title:m("selectAll","Select All"),order:1}]}));var wx=class o{constructor(e,t,n,i,r){this._initialScrollTop=e;this._initialContentHeight=t;this._visiblePosition=n;this._visiblePositionScrollDelta=i;this._cursorPosition=r}static capture(e){if(e.getScrollTop()===0||e.hasPendingScrollAnimation())return new o(e.getScrollTop(),e.getContentHeight(),null,0,null);let t=null,n=0,i=e.getVisibleRanges();if(i.length>0){t=i[0].getStartPosition();let r=e.getTopForPosition(t.lineNumber,t.column);n=e.getScrollTop()-r}return new o(e.getScrollTop(),e.getContentHeight(),t,n,e.getPosition())}restore(e){if(!(this._initialContentHeight===e.getContentHeight()&&this._initialScrollTop===e.getScrollTop())&&this._visiblePosition){let t=e.getTopForPosition(this._visiblePosition.lineNumber,this._visiblePosition.column);e.setScrollTop(t+this._visiblePositionScrollDelta)}}restoreRelativeVerticalPositionOfCursor(e){if(this._initialContentHeight===e.getContentHeight()&&this._initialScrollTop===e.getScrollTop())return;let t=e.getPosition();if(!this._cursorPosition||!t)return;let n=e.getTopForLineNumber(t.lineNumber)-e.getTopForLineNumber(this._cursorPosition.lineNumber);e.setScrollTop(e.getScrollTop()+n,1)}};var O4=Y("markerDecorationsService");var Wm=class{static ID="editor.contrib.markerDecorations";constructor(e,t){}dispose(){}};Wm=O([x(1,O4)],Wm);M4(Wm.ID,Wm,0);var jl;(_=>{let o={total:0,min:Number.MAX_VALUE,max:0},e={...o},t={...o},n={...o},i=0,r;(K=>(K[K.Before=0]="Before",K[K.InProgress=1]="InProgress",K[K.Finished=2]="Finished"))(r||={});let s={keydown:0,input:0,render:0};function a(){v(),performance.mark("inputlatency/start"),performance.mark("keydown/start"),s.keydown=1,queueMicrotask(l)}_.onKeyDown=a;function l(){s.keydown===1&&(performance.mark("keydown/end"),s.keydown=2)}function d(){performance.mark("input/start"),s.input=1,b()}_.onBeforeInput=d;function c(){s.input===0&&d(),queueMicrotask(u)}_.onInput=c;function u(){s.input===1&&(performance.mark("input/end"),s.input=2)}function p(){v()}_.onKeyUp=p;function h(){v()}_.onSelectionChange=h;function f(){s.keydown===2&&s.input===2&&s.render===0&&(performance.mark("render/start"),s.render=1,queueMicrotask(g),b())}_.onRenderStart=f;function g(){s.render===1&&(performance.mark("render/end"),s.render=2)}function b(){setTimeout(v)}function v(){s.keydown===2&&s.input===2&&s.render===2&&(performance.mark("inputlatency/end"),performance.measure("keydown","keydown/start","keydown/end"),performance.measure("input","input/start","input/end"),performance.measure("render","render/start","render/end"),performance.measure("inputlatency","inputlatency/start","inputlatency/end"),y("keydown",o),y("input",e),y("render",t),y("inputlatency",n),i++,S())}function y(L,k){let W=performance.getEntriesByName(L)[0].duration;k.total+=W,k.min=Math.min(k.min,W),k.max=Math.max(k.max,W)}function S(){performance.clearMarks("keydown/start"),performance.clearMarks("keydown/end"),performance.clearMarks("input/start"),performance.clearMarks("input/end"),performance.clearMarks("render/start"),performance.clearMarks("render/end"),performance.clearMarks("inputlatency/start"),performance.clearMarks("inputlatency/end"),performance.clearMeasures("keydown"),performance.clearMeasures("input"),performance.clearMeasures("render"),performance.clearMeasures("inputlatency"),s.keydown=0,s.input=0,s.render=0}function E(){if(i===0)return;let L={keydown:C(o),input:C(e),render:C(t),total:C(n),sampleCount:i};return w(o),w(e),w(t),w(n),i=0,L}_.getAndClearMeasurements=E;function C(L){return{average:L.total/i,max:L.max,min:L.min}}function w(L){L.total=0,L.min=Number.MAX_VALUE,L.max=0}})(jl||={});var Ec=class{constructor(e,t){this.x=e;this.y=t}_pageCoordinatesBrand=void 0;toClientCoordinates(e){return new Av(this.x-e.scrollX,this.y-e.scrollY)}},Av=class{constructor(e,t){this.clientX=e;this.clientY=t}_clientCoordinatesBrand=void 0;toPageCoordinates(e){return new Ec(this.clientX+e.scrollX,this.clientY+e.scrollY)}},FP=class{constructor(e,t,n,i){this.x=e;this.y=t;this.width=n;this.height=i}_editorPagePositionBrand=void 0},BP=class{constructor(e,t){this.x=e;this.y=t}_positionRelativeToEditorBrand=void 0};function Rx(o){let e=io(o);return new FP(e.left,e.top,e.width,e.height)}function kx(o,e,t){let n=e.width/o.offsetWidth,i=e.height/o.offsetHeight,r=(t.x-e.x)/n,s=(t.y-e.y)/i;return new BP(r,s)}var cs=class extends Yi{_editorMouseEventBrand=void 0;isFromPointerCapture;pos;editorPos;relativePos;constructor(e,t,n){super(Ce(n),e),this.isFromPointerCapture=t,this.pos=new Ec(this.posx,this.posy),this.editorPos=Rx(n),this.relativePos=kx(n,this.editorPos,this.pos)}},_x=class{_editorViewDomNode;constructor(e){this._editorViewDomNode=e}_create(e){return new cs(e,!1,this._editorViewDomNode)}onContextMenu(e,t){return j(e,"contextmenu",n=>{t(this._create(n))})}onMouseUp(e,t){return j(e,"mouseup",n=>{t(this._create(n))})}onMouseDown(e,t){return j(e,me.MOUSE_DOWN,n=>{t(this._create(n))})}onPointerDown(e,t){return j(e,me.POINTER_DOWN,n=>{t(this._create(n),n.pointerId)})}onMouseLeave(e,t){return j(e,me.MOUSE_LEAVE,n=>{t(this._create(n))})}onMouseMove(e,t){return j(e,"mousemove",n=>t(this._create(n)))}},Dx=class{_editorViewDomNode;constructor(e){this._editorViewDomNode=e}_create(e){return new cs(e,!1,this._editorViewDomNode)}onPointerUp(e,t){return j(e,"pointerup",n=>{t(this._create(n))})}onPointerDown(e,t){return j(e,me.POINTER_DOWN,n=>{t(this._create(n),n.pointerId)})}onPointerLeave(e,t){return j(e,me.POINTER_LEAVE,n=>{t(this._create(n))})}onPointerMove(e,t){return j(e,"pointermove",n=>t(this._create(n)))}},Lx=class extends F{_editorViewDomNode;_globalPointerMoveMonitor;_keydownListener;constructor(e){super(),this._editorViewDomNode=e,this._globalPointerMoveMonitor=this._register(new Pa),this._keydownListener=null}startMonitoring(e,t,n,i,r){this._keydownListener=bn(e.ownerDocument,"keydown",s=>{s.toKeyCodeChord().isModifierKey()||this._globalPointerMoveMonitor.stopMonitoring(!0,s.browserEvent)},!0),this._globalPointerMoveMonitor.startMonitoring(e,t,n,s=>{i(new cs(s,!0,this._editorViewDomNode))},s=>{this._keydownListener.dispose(),r(s)})}stopMonitoring(){this._globalPointerMoveMonitor.stopMonitoring(!0)}};var Mx=class{selections;startLineNumber;endLineNumber;relativeVerticalOffset;visibleRange;bigNumbersDelta;whitespaceViewportData;_model;lineHeight;constructor(e,t,n,i){this.selections=e,this.startLineNumber=t.startLineNumber|0,this.endLineNumber=t.endLineNumber|0,this.relativeVerticalOffset=t.relativeVerticalOffset,this.bigNumbersDelta=t.bigNumbersDelta|0,this.lineHeight=t.lineHeight|0,this.whitespaceViewportData=n,this._model=i,this.visibleRange=new P(t.startLineNumber,this._model.getLineMinColumn(t.startLineNumber),t.endLineNumber,this._model.getLineMaxColumn(t.endLineNumber))}getViewLineRenderingData(e){return this._model.getViewportViewLineRenderingData(this.visibleRange,e)}getDecorationsInViewport(){return this._model.getDecorationsInViewport(this.visibleRange)}};var VP=class{_restrictedRenderingContextBrand=void 0;viewportData;scrollWidth;scrollHeight;visibleRange;bigNumbersDelta;scrollTop;scrollLeft;viewportWidth;viewportHeight;_viewLayout;constructor(e,t){this._viewLayout=e,this.viewportData=t,this.scrollWidth=this._viewLayout.getScrollWidth(),this.scrollHeight=this._viewLayout.getScrollHeight(),this.visibleRange=this.viewportData.visibleRange,this.bigNumbersDelta=this.viewportData.bigNumbersDelta;let n=this._viewLayout.getCurrentViewport();this.scrollTop=n.top,this.scrollLeft=n.left,this.viewportWidth=n.width,this.viewportHeight=n.height}getScrolledTopFromAbsoluteTop(e){return e-this.scrollTop}getVerticalOffsetForLineNumber(e,t){return this._viewLayout.getVerticalOffsetForLineNumber(e,t)}getVerticalOffsetAfterLineNumber(e,t){return this._viewLayout.getVerticalOffsetAfterLineNumber(e,t)}getDecorationsInViewport(){return this.viewportData.getDecorationsInViewport()}},Px=class extends VP{_renderingContextBrand=void 0;_viewLines;constructor(e,t,n){super(e,t),this._viewLines=n}linesVisibleRangesForRange(e,t){return this._viewLines.linesVisibleRangesForRange(e,t)}visibleRangeForPosition(e){return this._viewLines.visibleRangeForPosition(e)}},Ox=class{constructor(e,t,n,i){this.outsideRenderedLine=e;this.lineNumber=t;this.ranges=n;this.continuesOnNextLine=i}static firstLine(e){if(!e)return null;let t=null;for(let n of e)(!t||n.lineNumber<t.lineNumber)&&(t=n);return t}static lastLine(e){if(!e)return null;let t=null;for(let n of e)(!t||n.lineNumber>t.lineNumber)&&(t=n);return t}},Hm=class o{_horizontalRangeBrand=void 0;left;width;static from(e){let t=new Array(e.length);for(let n=0,i=e.length;n<i;n++){let r=e[n];t[n]=new o(r.left,r.width)}return t}constructor(e,t){this.left=Math.round(e),this.width=Math.round(t)}toString(){return`[${this.left},${this.width}]`}},Ys=class{_floatHorizontalRangeBrand=void 0;left;width;constructor(e,t){this.left=e,this.width=t}toString(){return`[${this.left},${this.width}]`}static compare(e,t){return e.left-t.left}},Nx=class{outsideRenderedLine;left;originalLeft;constructor(e,t){this.outsideRenderedLine=e,this.originalLeft=t,this.left=Math.round(this.originalLeft)}},Fv=class{constructor(e,t){this.outsideRenderedLine=e;this.ranges=t}};var Ax=class{configuration;viewModel;viewLayout;theme;constructor(e,t,n){this.configuration=e,this.theme=new US(t),this.viewModel=n,this.viewLayout=n.viewLayout}addEventHandler(e){this.viewModel.addViewEventHandler(e)}removeEventHandler(e){this.viewModel.removeViewEventHandler(e)}};var Yt=class extends as{_context;constructor(e){super(),this._context=e,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}};var ri=class{static write(e,t){e.setAttribute("data-mprt",String(t))}static read(e){let t=e.getAttribute("data-mprt");return t===null?0:parseInt(t,10)}static collect(e,t){let n=[],i=0;for(;e&&e!==e.ownerDocument.body&&e!==t;)e.nodeType===e.ELEMENT_NODE&&(n[i++]=this.read(e)),e=e.parentElement;let r=new Uint8Array(i);for(let s=0;s<i;s++)r[s]=n[i-s-1];return r}};function Tc(o,e){let t=globalThis.MonacoEnvironment;if(t?.createTrustedTypesPolicy)try{return t.createTrustedTypesPolicy(o,e)}catch(n){qe(n);return}try{return globalThis.trustedTypes?.createPolicy(o,e)}catch(n){qe(n);return}}var Bv=class{constructor(e){this._lineFactory=e;this._set(1,[])}_lines;_rendLineNumberStart;flush(){this._set(1,[])}_set(e,t){this._lines=t,this._rendLineNumberStart=e}_get(){return{rendLineNumberStart:this._rendLineNumberStart,lines:this._lines}}getStartLineNumber(){return this._rendLineNumberStart}getEndLineNumber(){return this._rendLineNumberStart+this._lines.length-1}getCount(){return this._lines.length}getLine(e){let t=e-this._rendLineNumberStart;if(t<0||t>=this._lines.length)throw new Ye("Illegal value for lineNumber");return this._lines[t]}onLinesDeleted(e,t){if(this.getCount()===0)return null;let n=this.getStartLineNumber(),i=this.getEndLineNumber();if(t<n){let l=t-e+1;return this._rendLineNumberStart-=l,null}if(e>i)return null;let r=0,s=0;for(let l=n;l<=i;l++){let d=l-this._rendLineNumberStart;e<=l&&l<=t&&(s===0?(r=d,s=1):s++)}if(e<n){let l=0;t<n?l=t-e+1:l=n-e,this._rendLineNumberStart-=l}return this._lines.splice(r,s)}onLinesChanged(e,t){let n=e+t-1;if(this.getCount()===0)return!1;let i=this.getStartLineNumber(),r=this.getEndLineNumber(),s=!1;for(let a=e;a<=n;a++)a>=i&&a<=r&&(this._lines[a-this._rendLineNumberStart].onContentChanged(),s=!0);return s}onLinesInserted(e,t){if(this.getCount()===0)return null;let n=t-e+1,i=this.getStartLineNumber(),r=this.getEndLineNumber();if(e<=i)return this._rendLineNumberStart+=n,null;if(e>r)return null;if(n+e>r)return this._lines.splice(e-this._rendLineNumberStart,r-e+1);let s=[];for(let u=0;u<n;u++)s[u]=this._lineFactory.createLine();let a=e-this._rendLineNumberStart,l=this._lines.slice(0,a),d=this._lines.slice(a,this._lines.length-n),c=this._lines.slice(this._lines.length-n,this._lines.length);return this._lines=l.concat(s).concat(d),c}onTokensChanged(e){if(this.getCount()===0)return!1;let t=this.getStartLineNumber(),n=this.getEndLineNumber(),i=!1;for(let r=0,s=e.length;r<s;r++){let a=e[r];if(a.toLineNumber<t||a.fromLineNumber>n)continue;let l=Math.max(t,a.fromLineNumber),d=Math.min(n,a.toLineNumber);for(let c=l;c<=d;c++){let u=c-this._rendLineNumberStart;this._lines[u].onTokensChanged(),i=!0}}return i}},Um=class{constructor(e){this._lineFactory=e}domNode=this._createDomNode();_linesCollection=new Bv(this._lineFactory);_createDomNode(){let e=We(document.createElement("div"));return e.setClassName("view-layer"),e.setPosition("absolute"),e.domNode.setAttribute("role","presentation"),e.domNode.setAttribute("aria-hidden","true"),e}onConfigurationChanged(e){return!!e.hasChanged(147)}onFlushed(e){return this._linesCollection.flush(),!0}onLinesChanged(e){return this._linesCollection.onLinesChanged(e.fromLineNumber,e.count)}onLinesDeleted(e){let t=this._linesCollection.onLinesDeleted(e.fromLineNumber,e.toLineNumber);if(t)for(let n=0,i=t.length;n<i;n++)t[n].getDomNode()?.remove();return!0}onLinesInserted(e){let t=this._linesCollection.onLinesInserted(e.fromLineNumber,e.toLineNumber);if(t)for(let n=0,i=t.length;n<i;n++)t[n].getDomNode()?.remove();return!0}onScrollChanged(e){return e.scrollTopChanged}onTokensChanged(e){return this._linesCollection.onTokensChanged(e.ranges)}onZonesChanged(e){return!0}getStartLineNumber(){return this._linesCollection.getStartLineNumber()}getEndLineNumber(){return this._linesCollection.getEndLineNumber()}getVisibleLine(e){return this._linesCollection.getLine(e)}renderLines(e){let t=this._linesCollection._get(),n=new WP(this.domNode.domNode,this._lineFactory,e),i={rendLineNumberStart:t.rendLineNumberStart,lines:t.lines,linesLength:t.lines.length},r=n.render(i,e.startLineNumber,e.endLineNumber,e.relativeVerticalOffset);this._linesCollection._set(r.rendLineNumberStart,r.lines)}},WP=class o{constructor(e,t,n){this._domNode=e;this._lineFactory=t;this._viewportData=n}static _ttPolicy=Tc("editorViewLayer",{createHTML:e=>e});render(e,t,n,i){let r={rendLineNumberStart:e.rendLineNumberStart,lines:e.lines.slice(0),linesLength:e.linesLength};if(r.rendLineNumberStart+r.linesLength-1<t||n<r.rendLineNumberStart){r.rendLineNumberStart=t,r.linesLength=n-t+1,r.lines=[];for(let s=t;s<=n;s++)r.lines[s-t]=this._lineFactory.createLine();return this._finishRendering(r,!0,i),r}if(this._renderUntouchedLines(r,Math.max(t-r.rendLineNumberStart,0),Math.min(n-r.rendLineNumberStart,r.linesLength-1),i,t),r.rendLineNumberStart>t){let s=t,a=Math.min(n,r.rendLineNumberStart-1);s<=a&&(this._insertLinesBefore(r,s,a,i,t),r.linesLength+=a-s+1)}else if(r.rendLineNumberStart<t){let s=Math.min(r.linesLength,t-r.rendLineNumberStart);s>0&&(this._removeLinesBefore(r,s),r.linesLength-=s)}if(r.rendLineNumberStart=t,r.rendLineNumberStart+r.linesLength-1<n){let s=r.rendLineNumberStart+r.linesLength,a=n;s<=a&&(this._insertLinesAfter(r,s,a,i,t),r.linesLength+=a-s+1)}else if(r.rendLineNumberStart+r.linesLength-1>n){let s=Math.max(0,n-r.rendLineNumberStart+1),l=r.linesLength-1-s+1;l>0&&(this._removeLinesAfter(r,l),r.linesLength-=l)}return this._finishRendering(r,!1,i),r}_renderUntouchedLines(e,t,n,i,r){let s=e.rendLineNumberStart,a=e.lines;for(let l=t;l<=n;l++){let d=s+l;a[l].layoutLine(d,i[d-r],this._viewportData.lineHeight)}}_insertLinesBefore(e,t,n,i,r){let s=[],a=0;for(let l=t;l<=n;l++)s[a++]=this._lineFactory.createLine();e.lines=s.concat(e.lines)}_removeLinesBefore(e,t){for(let n=0;n<t;n++)e.lines[n].getDomNode()?.remove();e.lines.splice(0,t)}_insertLinesAfter(e,t,n,i,r){let s=[],a=0;for(let l=t;l<=n;l++)s[a++]=this._lineFactory.createLine();e.lines=e.lines.concat(s)}_removeLinesAfter(e,t){let n=e.linesLength-t;for(let i=0;i<t;i++)e.lines[n+i].getDomNode()?.remove();e.lines.splice(n,t)}_finishRenderingNewLines(e,t,n,i){o._ttPolicy&&(n=o._ttPolicy.createHTML(n));let r=this._domNode.lastChild;t||!r?this._domNode.innerHTML=n:r.insertAdjacentHTML("afterend",n);let s=this._domNode.lastChild;for(let a=e.linesLength-1;a>=0;a--){let l=e.lines[a];i[a]&&(l.setDomNode(s),s=s.previousSibling)}}_finishRenderingInvalidLines(e,t,n){let i=document.createElement("div");o._ttPolicy&&(t=o._ttPolicy.createHTML(t)),i.innerHTML=t;for(let r=0;r<e.linesLength;r++){let s=e.lines[r];if(n[r]){let a=i.firstChild,l=s.getDomNode();l.parentNode.replaceChild(a,l),s.setDomNode(a)}}}static _sb=new va(1e5);_finishRendering(e,t,n){let i=o._sb,r=e.linesLength,s=e.lines,a=e.rendLineNumberStart,l=[];{i.reset();let d=!1;for(let c=0;c<r;c++){let u=s[c];l[c]=!1,!(u.getDomNode()||!u.renderLine(c+a,n[c],this._viewportData.lineHeight,this._viewportData,i))&&(l[c]=!0,d=!0)}d&&this._finishRenderingNewLines(e,t,i.build(),l)}{i.reset();let d=!1,c=[];for(let u=0;u<r;u++){let p=s[u];c[u]=!1,!(l[u]||!p.renderLine(u+a,n[u],this._viewportData.lineHeight,this._viewportData,i))&&(c[u]=!0,d=!0)}d&&this._finishRenderingInvalidLines(e,i.build(),c)}}};var zm=class{constructor(e,t){this._domNode=e;this.endNode=t}_didDomLayout=!1;_clientRectDeltaLeft=0;_clientRectScale=1;_clientRectRead=!1;get didDomLayout(){return this._didDomLayout}readClientRect(){if(!this._clientRectRead){this._clientRectRead=!0;let e=this._domNode.getBoundingClientRect();this.markDidDomLayout(),this._clientRectDeltaLeft=e.left,this._clientRectScale=e.width/this._domNode.offsetWidth}}get clientRectDeltaLeft(){return this._clientRectRead||this.readClientRect(),this._clientRectDeltaLeft}get clientRectScale(){return this._clientRectRead||this.readClientRect(),this._clientRectScale}markDidDomLayout(){this._didDomLayout=!0}};var rp=class{static _handyReadyRange;static _createRange(){return this._handyReadyRange||(this._handyReadyRange=document.createRange()),this._handyReadyRange}static _detachRange(e,t){e.selectNodeContents(t)}static _readClientRects(e,t,n,i,r){let s=this._createRange();try{return s.setStart(e,t),s.setEnd(n,i),s.getClientRects()}catch{return null}finally{this._detachRange(s,r)}}static _mergeAdjacentRanges(e){if(e.length===1)return e;e.sort(Ys.compare);let t=[],n=0,i=e[0];for(let r=1,s=e.length;r<s;r++){let a=e[r];i.left+i.width+.9>=a.left?i.width=Math.max(i.width,a.left+a.width-i.left):(t[n++]=i,i=a)}return t[n++]=i,t}static _createHorizontalRangesFromClientRects(e,t,n){if(!e||e.length===0)return null;let i=[];for(let r=0,s=e.length;r<s;r++){let a=e[r];i[r]=new Ys(Math.max(0,(a.left-t)/n),a.width/n)}return this._mergeAdjacentRanges(i)}static readHorizontalRanges(e,t,n,i,r,s){let l=e.children.length-1;if(0>l)return null;if(t=Math.min(l,Math.max(0,t)),i=Math.min(l,Math.max(0,i)),t===i&&n===r&&n===0&&!e.children[t].firstChild){let p=e.children[t].getClientRects();return s.markDidDomLayout(),this._createHorizontalRangesFromClientRects(p,s.clientRectDeltaLeft,s.clientRectScale)}t!==i&&i>0&&r===0&&(i--,r=1073741824);let d=e.children[t].firstChild,c=e.children[i].firstChild;if((!d||!c)&&(!d&&n===0&&t>0&&(d=e.children[t-1].firstChild,n=1073741824),!c&&r===0&&i>0&&(c=e.children[i-1].firstChild,r=1073741824)),!d||!c)return null;n=Math.min(d.textContent.length,Math.max(0,n)),r=Math.min(c.textContent.length,Math.max(0,r));let u=this._readClientRects(d,n,c,r,s.endNode);return s.markDidDomLayout(),this._createHorizontalRangesFromClientRects(u,s.clientRectDeltaLeft,s.clientRectScale)}};var Rn=class{constructor(e,t,n,i){this.endIndex=e;this.type=t;this.metadata=n;this.containsRTL=i}_linePartBrand=void 0;isWhitespace(){return!!(this.metadata&1)}isPseudoAfter(){return!!(this.metadata&4)}};var us=class o{constructor(e,t,n,i){this.startColumn=e;this.endColumn=t;this.className=n;this.type=i}_lineDecorationBrand=void 0;static _equals(e,t){return e.startColumn===t.startColumn&&e.endColumn===t.endColumn&&e.className===t.className&&e.type===t.type}static equalsArr(e,t){let n=e.length,i=t.length;if(n!==i)return!1;for(let r=0;r<n;r++)if(!o._equals(e[r],t[r]))return!1;return!0}static extractWrapped(e,t,n){if(e.length===0)return e;let i=t+1,r=n+1,s=n-t,a=[],l=0;for(let d of e)d.endColumn<=i||d.startColumn>=r||(a[l++]=new o(Math.max(1,d.startColumn-i+1),Math.min(s+1,d.endColumn-i+1),d.className,d.type));return a}static filter(e,t,n,i){if(e.length===0)return[];let r=[],s=0;for(let a=0,l=e.length;a<l;a++){let d=e[a],c=d.range;if(c.endLineNumber<t||c.startLineNumber>t||c.isEmpty()&&(d.type===0||d.type===3))continue;let u=c.startLineNumber===t?c.startColumn:n,p=c.endLineNumber===t?c.endColumn:i;r[s++]=new o(u,p,d.inlineClassName,d.type)}return r}static _typeCompare(e,t){let n=[2,0,1,3];return n[e]-n[t]}static compare(e,t){if(e.startColumn!==t.startColumn)return e.startColumn-t.startColumn;if(e.endColumn!==t.endColumn)return e.endColumn-t.endColumn;let n=o._typeCompare(e.type,t.type);return n!==0?n:e.className!==t.className?e.className<t.className?-1:1:0}},Fx=class{startOffset;endOffset;className;metadata;constructor(e,t,n,i){this.startOffset=e,this.endOffset=t,this.className=n,this.metadata=i}},HP=class o{count;stopOffsets;classNames;metadata;constructor(){this.stopOffsets=[],this.classNames=[],this.metadata=[],this.count=0}static _metadata(e){let t=0;for(let n=0,i=e.length;n<i;n++)t|=e[n];return t}consumeLowerThan(e,t,n){for(;this.count>0&&this.stopOffsets[0]<e;){let i=0;for(;i+1<this.count&&this.stopOffsets[i]===this.stopOffsets[i+1];)i++;n.push(new Fx(t,this.stopOffsets[i],this.classNames.join(" "),o._metadata(this.metadata))),t=this.stopOffsets[i]+1,this.stopOffsets.splice(0,i+1),this.classNames.splice(0,i+1),this.metadata.splice(0,i+1),this.count-=i+1}return this.count>0&&t<e&&(n.push(new Fx(t,e-1,this.classNames.join(" "),o._metadata(this.metadata))),t=e),t}insert(e,t,n){if(this.count===0||this.stopOffsets[this.count-1]<=e)this.stopOffsets.push(e),this.classNames.push(t),this.metadata.push(n);else for(let i=0;i<this.count;i++)if(this.stopOffsets[i]>=e){this.stopOffsets.splice(i,0,e),this.classNames.splice(i,0,t),this.metadata.splice(i,0,n);break}this.count++}},Bx=class{static normalize(e,t){if(t.length===0)return[];let n=[],i=new HP,r=0;for(let s=0,a=t.length;s<a;s++){let l=t[s],d=l.startColumn,c=l.endColumn,u=l.className,p=l.type===1?2:l.type===2?4:0;if(d>1){let g=e.charCodeAt(d-2);ln(g)&&d--}if(c>1){let g=e.charCodeAt(c-2);ln(g)&&c--}let h=d-1,f=c-2;r=i.consumeLowerThan(h,r,n),i.count===0&&(r=h),i.insert(f,u,p)}return i.consumeLowerThan(1073741824,r,n),n}};var Km=class{startOffset;endOffset;constructor(e,t){this.startOffset=e,this.endOffset=t}equals(e){return this.startOffset===e.startOffset&&this.endOffset===e.endOffset}},xc=class{useMonospaceOptimizations;canUseHalfwidthRightwardsArrow;lineContent;continuesWithWrappedLine;isBasicASCII;containsRTL;fauxIndentLength;lineTokens;lineDecorations;tabSize;startVisibleColumn;spaceWidth;renderSpaceWidth;renderSpaceCharCode;stopRenderingLineAfter;renderWhitespace;renderControlCharacters;fontLigatures;selectionsOnLine;constructor(e,t,n,i,r,s,a,l,d,c,u,p,h,f,g,b,v,y,S){this.useMonospaceOptimizations=e,this.canUseHalfwidthRightwardsArrow=t,this.lineContent=n,this.continuesWithWrappedLine=i,this.isBasicASCII=r,this.containsRTL=s,this.fauxIndentLength=a,this.lineTokens=l,this.lineDecorations=d.sort(us.compare),this.tabSize=c,this.startVisibleColumn=u,this.spaceWidth=p,this.stopRenderingLineAfter=g,this.renderWhitespace=b==="all"?4:b==="boundary"?1:b==="selection"?2:b==="trailing"?3:0,this.renderControlCharacters=v,this.fontLigatures=y,this.selectionsOnLine=S&&S.sort((w,_)=>w.startOffset<_.startOffset?-1:1);let E=Math.abs(f-p),C=Math.abs(h-p);E<C?(this.renderSpaceWidth=f,this.renderSpaceCharCode=11825):(this.renderSpaceWidth=h,this.renderSpaceCharCode=183)}sameSelection(e){if(this.selectionsOnLine===null)return e===null;if(e===null||e.length!==this.selectionsOnLine.length)return!1;for(let t=0;t<this.selectionsOnLine.length;t++)if(!this.selectionsOnLine[t].equals(e[t]))return!1;return!0}equals(e){return this.useMonospaceOptimizations===e.useMonospaceOptimizations&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.lineContent===e.lineContent&&this.continuesWithWrappedLine===e.continuesWithWrappedLine&&this.isBasicASCII===e.isBasicASCII&&this.containsRTL===e.containsRTL&&this.fauxIndentLength===e.fauxIndentLength&&this.tabSize===e.tabSize&&this.startVisibleColumn===e.startVisibleColumn&&this.spaceWidth===e.spaceWidth&&this.renderSpaceWidth===e.renderSpaceWidth&&this.renderSpaceCharCode===e.renderSpaceCharCode&&this.stopRenderingLineAfter===e.stopRenderingLineAfter&&this.renderWhitespace===e.renderWhitespace&&this.renderControlCharacters===e.renderControlCharacters&&this.fontLigatures===e.fontLigatures&&us.equalsArr(this.lineDecorations,e.lineDecorations)&&this.lineTokens.equals(e.lineTokens)&&this.sameSelection(e.selectionsOnLine)}};var Vv=class{constructor(e,t){this.partIndex=e;this.charIndex=t}},Wv=class o{static getPartIndex(e){return(e&4294901760)>>>16}static getCharIndex(e){return(e&65535)>>>0}length;_data;_horizontalOffset;constructor(e,t){this.length=e,this._data=new Uint32Array(this.length),this._horizontalOffset=new Uint32Array(this.length)}setColumnInfo(e,t,n,i){let r=(t<<16|n<<0)>>>0;this._data[e-1]=r,this._horizontalOffset[e-1]=i}getHorizontalOffset(e){return this._horizontalOffset.length===0?0:this._horizontalOffset[e-1]}charOffsetToPartData(e){return this.length===0?0:e<0?this._data[0]:e>=this.length?this._data[this.length-1]:this._data[e]}getDomPosition(e){let t=this.charOffsetToPartData(e-1),n=o.getPartIndex(t),i=o.getCharIndex(t);return new Vv(n,i)}getColumn(e,t){return this.partDataToCharOffset(e.partIndex,t,e.charIndex)+1}partDataToCharOffset(e,t,n){if(this.length===0)return 0;let i=(e<<16|n<<0)>>>0,r=0,s=this.length-1;for(;r+1<s;){let g=r+s>>>1,b=this._data[g];if(b===i)return g;b>i?s=g:r=g}if(r===s)return r;let a=this._data[r],l=this._data[s];if(a===i)return r;if(l===i)return s;let d=o.getPartIndex(a),c=o.getCharIndex(a),u=o.getPartIndex(l),p;d!==u?p=t:p=o.getCharIndex(l);let h=n-c,f=p-n;return h<=f?r:s}inflate(){let e=[];for(let t=0;t<this.length;t++){let n=this._data[t],i=o.getPartIndex(n),r=o.getCharIndex(n),s=this._horizontalOffset[t];e.push([i,r,s])}return e}};var Hv=class{_renderLineOutputBrand=void 0;characterMapping;containsRTL;containsForeignElements;constructor(e,t,n){this.characterMapping=e,this.containsRTL=t,this.containsForeignElements=n}};function Uv(o,e){if(o.lineContent.length===0){if(o.lineDecorations.length>0){e.appendString("<span>");let t=0,n=0,i=0;for(let s of o.lineDecorations)(s.type===1||s.type===2)&&(e.appendString('<span class="'),e.appendString(s.className),e.appendString('"></span>'),s.type===1&&(i|=1,t++),s.type===2&&(i|=2,n++));e.appendString("</span>");let r=new Wv(1,t+n);return r.setColumnInfo(1,t,0,0),new Hv(r,!1,i)}return e.appendString("<span><span></span></span>"),new Hv(new Wv(0,0),!1,0)}return gj(dj(o),e)}var UP=class{constructor(e,t,n,i){this.characterMapping=e;this.html=t;this.containsRTL=n;this.containsForeignElements=i}};function N4(o){let e=new va(1e4),t=Uv(o,e);return new UP(t.characterMapping,e.build(),t.containsRTL,t.containsForeignElements)}var zP=class{constructor(e,t,n,i,r,s,a,l,d,c,u,p,h,f,g,b){this.fontIsMonospace=e;this.canUseHalfwidthRightwardsArrow=t;this.lineContent=n;this.len=i;this.isOverflowing=r;this.overflowingCharCount=s;this.parts=a;this.containsForeignElements=l;this.fauxIndentLength=d;this.tabSize=c;this.startVisibleColumn=u;this.containsRTL=p;this.spaceWidth=h;this.renderSpaceCharCode=f;this.renderWhitespace=g;this.renderControlCharacters=b}};function dj(o){let e=o.lineContent,t,n,i;o.stopRenderingLineAfter!==-1&&o.stopRenderingLineAfter<e.length?(t=!0,n=e.length-o.stopRenderingLineAfter,i=o.stopRenderingLineAfter):(t=!1,n=0,i=e.length);let r=cj(e,o.containsRTL,o.lineTokens,o.fauxIndentLength,i);o.renderControlCharacters&&!o.isBasicASCII&&(r=pj(e,r)),(o.renderWhitespace===4||o.renderWhitespace===1||o.renderWhitespace===2&&o.selectionsOnLine||o.renderWhitespace===3&&!o.continuesWithWrappedLine)&&(r=hj(o,e,i,r));let s=0;if(o.lineDecorations.length>0){for(let a=0,l=o.lineDecorations.length;a<l;a++){let d=o.lineDecorations[a];d.type===3||d.type===1?s|=1:d.type===2&&(s|=2)}r=mj(e,i,r,o.lineDecorations)}return o.containsRTL||(r=uj(e,r,!o.isBasicASCII||o.fontLigatures)),new zP(o.useMonospaceOptimizations,o.canUseHalfwidthRightwardsArrow,e,i,t,n,r,s,o.fauxIndentLength,o.tabSize,o.startVisibleColumn,o.containsRTL,o.spaceWidth,o.renderSpaceCharCode,o.renderWhitespace,o.renderControlCharacters)}function cj(o,e,t,n,i){let r=[],s=0;n>0&&(r[s++]=new Rn(n,"",0,!1));let a=n;for(let l=0,d=t.getCount();l<d;l++){let c=t.getEndOffset(l);if(c<=n)continue;let u=t.getClassName(l);if(c>=i){let h=e?yl(o.substring(a,i)):!1;r[s++]=new Rn(i,u,0,h);break}let p=e?yl(o.substring(a,c)):!1;r[s++]=new Rn(c,u,0,p),a=c}return r}function uj(o,e,t){let n=0,i=[],r=0;if(t)for(let s=0,a=e.length;s<a;s++){let l=e[s],d=l.endIndex;if(n+50<d){let c=l.type,u=l.metadata,p=l.containsRTL,h=-1,f=n;for(let g=n;g<d;g++)o.charCodeAt(g)===32&&(h=g),h!==-1&&g-f>=50&&(i[r++]=new Rn(h+1,c,u,p),f=h+1,h=-1);f!==d&&(i[r++]=new Rn(d,c,u,p))}else i[r++]=l;n=d}else for(let s=0,a=e.length;s<a;s++){let l=e[s],d=l.endIndex,c=d-n;if(c>50){let u=l.type,p=l.metadata,h=l.containsRTL,f=Math.ceil(c/50);for(let g=1;g<f;g++){let b=n+g*50;i[r++]=new Rn(b,u,p,h)}i[r++]=new Rn(d,u,p,h)}else i[r++]=l;n=d}return i}function A4(o){return o<32?o!==9:o===127||o>=8234&&o<=8238||o>=8294&&o<=8297||o>=8206&&o<=8207||o===1564}function pj(o,e){let t=[],n=new Rn(0,"",0,!1),i=0;for(let r of e){let s=r.endIndex;for(;i<s;i++){let a=o.charCodeAt(i);A4(a)&&(i>n.endIndex&&(n=new Rn(i,r.type,r.metadata,r.containsRTL),t.push(n)),n=new Rn(i+1,"mtkcontrol",r.metadata,!1),t.push(n))}i>n.endIndex&&(n=new Rn(s,r.type,r.metadata,r.containsRTL),t.push(n))}return t}function hj(o,e,t,n){let i=o.continuesWithWrappedLine,r=o.fauxIndentLength,s=o.tabSize,a=o.startVisibleColumn,l=o.useMonospaceOptimizations,d=o.selectionsOnLine,c=o.renderWhitespace===1,u=o.renderWhitespace===3,p=o.renderSpaceWidth!==o.spaceWidth,h=[],f=0,g=0,b=n[g].type,v=n[g].containsRTL,y=n[g].endIndex,S=n.length,E=!1,C=Cn(e),w;C===-1?(E=!0,C=t,w=t):w=Lr(e);let _=!1,L=0,k=d&&d[L],W=a%s;for(let U=r;U<t;U++){let oe=e.charCodeAt(U);k&&U>=k.endOffset&&(L++,k=d&&d[L]);let Se;if(U<C||U>w)Se=!0;else if(oe===9)Se=!0;else if(oe===32)if(c)if(_)Se=!0;else{let ne=U+1<t?e.charCodeAt(U+1):0;Se=ne===32||ne===9}else Se=!0;else Se=!1;if(Se&&d&&(Se=!!k&&k.startOffset<=U&&k.endOffset>U),Se&&u&&(Se=E||U>w),Se&&v&&U>=C&&U<=w&&(Se=!1),_){if(!Se||!l&&W>=s){if(p){let ne=f>0?h[f-1].endIndex:r;for(let Q=ne+1;Q<=U;Q++)h[f++]=new Rn(Q,"mtkw",1,!1)}else h[f++]=new Rn(U,"mtkw",1,!1);W=W%s}}else(U===y||Se&&U>r)&&(h[f++]=new Rn(U,b,0,v),W=W%s);for(oe===9?W=s:Rr(oe)?W+=2:W++,_=Se;U===y&&(g++,g<S);)b=n[g].type,v=n[g].containsRTL,y=n[g].endIndex}let K=!1;if(_)if(i&&c){let U=t>0?e.charCodeAt(t-1):0,oe=t>1?e.charCodeAt(t-2):0;U===32&&oe!==32&&oe!==9||(K=!0)}else K=!0;if(K)if(p){let U=f>0?h[f-1].endIndex:r;for(let oe=U+1;oe<=t;oe++)h[f++]=new Rn(oe,"mtkw",1,!1)}else h[f++]=new Rn(t,"mtkw",1,!1);else h[f++]=new Rn(t,b,0,v);return h}function mj(o,e,t,n){n.sort(us.compare);let i=Bx.normalize(o,n),r=i.length,s=0,a=[],l=0,d=0;for(let u=0,p=t.length;u<p;u++){let h=t[u],f=h.endIndex,g=h.type,b=h.metadata,v=h.containsRTL;for(;s<r&&i[s].startOffset<f;){let y=i[s];if(y.startOffset>d&&(d=y.startOffset,a[l++]=new Rn(d,g,b,v)),y.endOffset+1<=f)d=y.endOffset+1,a[l++]=new Rn(d,g+" "+y.className,b|y.metadata,v),s++;else{d=f,a[l++]=new Rn(d,g+" "+y.className,b|y.metadata,v);break}}f>d&&(d=f,a[l++]=new Rn(d,g,b,v))}let c=t[t.length-1].endIndex;if(s<r&&i[s].startOffset===c)for(;s<r&&i[s].startOffset===c;){let u=i[s];a[l++]=new Rn(d,u.className,u.metadata,!1),s++}return a}function gj(o,e){let t=o.fontIsMonospace,n=o.canUseHalfwidthRightwardsArrow,i=o.containsForeignElements,r=o.lineContent,s=o.len,a=o.isOverflowing,l=o.overflowingCharCount,d=o.parts,c=o.fauxIndentLength,u=o.tabSize,p=o.startVisibleColumn,h=o.containsRTL,f=o.spaceWidth,g=o.renderSpaceCharCode,b=o.renderWhitespace,v=o.renderControlCharacters,y=new Wv(s+1,d.length),S=!1,E=0,C=p,w=0,_=0,L=0;h?e.appendString('<span dir="ltr">'):e.appendString("<span>");for(let k=0,W=d.length;k<W;k++){let K=d[k],U=K.endIndex,oe=K.type,Se=K.containsRTL,ne=b!==0&&K.isWhitespace(),Q=ne&&!t&&(oe==="mtkw"||!i),de=E===U&&K.isPseudoAfter();if(w=0,e.appendString("<span "),Se&&e.appendString('style="unicode-bidi:isolate" '),e.appendString('class="'),e.appendString(Q?"mtkz":oe),e.appendASCIICharCode(34),ne){let se=0;{let ie=E,Te=C;for(;ie<U;ie++){let Xe=(r.charCodeAt(ie)===9?u-Te%u:1)|0;se+=Xe,ie>=c&&(Te+=Xe)}}for(Q&&(e.appendString(' style="width:'),e.appendString(String(f*se)),e.appendString('px"')),e.appendASCIICharCode(62);E<U;E++){y.setColumnInfo(E+1,k-L,w,_),L=0;let ie=r.charCodeAt(E),Te,ue;if(ie===9){Te=u-C%u|0,ue=Te,!n||ue>1?e.appendCharCode(8594):e.appendCharCode(65515);for(let Xe=2;Xe<=ue;Xe++)e.appendCharCode(160)}else Te=2,ue=1,e.appendCharCode(g),e.appendCharCode(8204);w+=Te,_+=ue,E>=c&&(C+=ue)}}else for(e.appendASCIICharCode(62);E<U;E++){y.setColumnInfo(E+1,k-L,w,_),L=0;let se=r.charCodeAt(E),ie=1,Te=1;switch(se){case 9:ie=u-C%u,Te=ie;for(let ue=1;ue<=ie;ue++)e.appendCharCode(160);break;case 32:e.appendCharCode(160);break;case 60:e.appendString("&lt;");break;case 62:e.appendString("&gt;");break;case 38:e.appendString("&amp;");break;case 0:v?e.appendCharCode(9216):e.appendString("&#00;");break;case 65279:case 8232:case 8233:case 133:e.appendCharCode(65533);break;default:Rr(se)&&Te++,v&&se<32?e.appendCharCode(9216+se):v&&se===127?e.appendCharCode(9249):v&&A4(se)?(e.appendString("[U+"),e.appendString(fj(se)),e.appendString("]"),ie=8,Te=ie):e.appendCharCode(se)}w+=ie,_+=Te,E>=c&&(C+=Te)}de?L++:L=0,E>=s&&!S&&K.isPseudoAfter()&&(S=!0,y.setColumnInfo(E+1,k,w,_)),e.appendString("</span>")}return S||y.setColumnInfo(s+1,d.length-1,w,_),a&&(e.appendString('<span class="mtkoverflow">'),e.appendString(m("showMore","Show more ({0})",bj(l))),e.appendString("</span>")),e.appendString("</span>"),new Hv(y,h,i)}function fj(o){return o.toString(16).toUpperCase().padStart(4,"0")}function bj(o){return o<1024?m("overflow.chars","{0} chars",o):o<1024*1024?`${(o/1024).toFixed(1)} KB`:`${(o/1024/1024).toFixed(1)} MB`}var vj=function(){return ca?!0:!(At||Gn||Wo)}(),jm=!0,zv=class{themeType;renderWhitespace;renderControlCharacters;spaceWidth;middotWidth;wsmiddotWidth;useMonospaceOptimizations;canUseHalfwidthRightwardsArrow;lineHeight;stopRenderingLineAfter;fontLigatures;constructor(e,t){this.themeType=t;let n=e.options,i=n.get(51);n.get(39)==="off"?this.renderWhitespace=n.get(101):this.renderWhitespace="none",this.renderControlCharacters=n.get(96),this.spaceWidth=i.spaceWidth,this.middotWidth=i.middotWidth,this.wsmiddotWidth=i.wsmiddotWidth,this.useMonospaceOptimizations=i.isMonospace&&!n.get(33),this.canUseHalfwidthRightwardsArrow=i.canUseHalfwidthRightwardsArrow,this.lineHeight=n.get(68),this.stopRenderingLineAfter=n.get(119),this.fontLigatures=n.get(52)}equals(e){return this.themeType===e.themeType&&this.renderWhitespace===e.renderWhitespace&&this.renderControlCharacters===e.renderControlCharacters&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.useMonospaceOptimizations===e.useMonospaceOptimizations&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.lineHeight===e.lineHeight&&this.stopRenderingLineAfter===e.stopRenderingLineAfter&&this.fontLigatures===e.fontLigatures}},Zs=class o{static CLASS_NAME="view-line";_options;_isMaybeInvalid;_renderedViewLine;constructor(e){this._options=e,this._isMaybeInvalid=!0,this._renderedViewLine=null}getDomNode(){return this._renderedViewLine&&this._renderedViewLine.domNode?this._renderedViewLine.domNode.domNode:null}setDomNode(e){if(this._renderedViewLine)this._renderedViewLine.domNode=We(e);else throw new Error("I have no rendered view line to set the dom node to...")}onContentChanged(){this._isMaybeInvalid=!0}onTokensChanged(){this._isMaybeInvalid=!0}onDecorationsChanged(){this._isMaybeInvalid=!0}onOptionsChanged(e){this._isMaybeInvalid=!0,this._options=e}onSelectionChanged(){return tc(this._options.themeType)||this._options.renderWhitespace==="selection"?(this._isMaybeInvalid=!0,!0):!1}renderLine(e,t,n,i,r){if(this._isMaybeInvalid===!1)return!1;this._isMaybeInvalid=!1;let s=i.getViewLineRenderingData(e),a=this._options,l=us.filter(s.inlineDecorations,e,s.minColumn,s.maxColumn),d=null;if(tc(a.themeType)||this._options.renderWhitespace==="selection"){let h=i.selections;for(let f of h){if(f.endLineNumber<e||f.startLineNumber>e)continue;let g=f.startLineNumber===e?f.startColumn:s.minColumn,b=f.endLineNumber===e?f.endColumn:s.maxColumn;g<b&&(tc(a.themeType)&&l.push(new us(g,b,"inline-selected-text",0)),this._options.renderWhitespace==="selection"&&(d||(d=[]),d.push(new Km(g-1,b-1))))}}let c=new xc(a.useMonospaceOptimizations,a.canUseHalfwidthRightwardsArrow,s.content,s.continuesWithWrappedLine,s.isBasicASCII,s.containsRTL,s.minColumn-1,s.tokens,l,s.tabSize,s.startVisibleColumn,a.spaceWidth,a.middotWidth,a.wsmiddotWidth,a.stopRenderingLineAfter,a.renderWhitespace,a.renderControlCharacters,a.fontLigatures!==_s.OFF,d);if(this._renderedViewLine&&this._renderedViewLine.input.equals(c))return!1;r.appendString('<div style="top:'),r.appendString(String(t)),r.appendString("px;height:"),r.appendString(String(n)),r.appendString('px;" class="'),r.appendString(o.CLASS_NAME),r.appendString('">');let u=Uv(c,r);r.appendString("</div>");let p=null;return jm&&vj&&s.isBasicASCII&&a.useMonospaceOptimizations&&u.containsForeignElements===0&&(p=new Gm(this._renderedViewLine?this._renderedViewLine.domNode:null,c,u.characterMapping)),p||(p=F4(this._renderedViewLine?this._renderedViewLine.domNode:null,c,u.characterMapping,u.containsRTL,u.containsForeignElements)),this._renderedViewLine=p,!0}layoutLine(e,t,n){this._renderedViewLine&&this._renderedViewLine.domNode&&(this._renderedViewLine.domNode.setTop(t),this._renderedViewLine.domNode.setHeight(n))}getWidth(e){return this._renderedViewLine?this._renderedViewLine.getWidth(e):0}getWidthIsFast(){return this._renderedViewLine?this._renderedViewLine.getWidthIsFast():!0}needsMonospaceFontCheck(){return this._renderedViewLine?this._renderedViewLine instanceof Gm:!1}monospaceAssumptionsAreValid(){return this._renderedViewLine&&this._renderedViewLine instanceof Gm?this._renderedViewLine.monospaceAssumptionsAreValid():jm}onMonospaceAssumptionsInvalidated(){this._renderedViewLine&&this._renderedViewLine instanceof Gm&&(this._renderedViewLine=this._renderedViewLine.toSlowRenderedLine())}getVisibleRangesForRange(e,t,n,i){if(!this._renderedViewLine)return null;t=Math.min(this._renderedViewLine.input.lineContent.length+1,Math.max(1,t)),n=Math.min(this._renderedViewLine.input.lineContent.length+1,Math.max(1,n));let r=this._renderedViewLine.input.stopRenderingLineAfter;if(r!==-1&&t>r+1&&n>r+1)return new Fv(!0,[new Ys(this.getWidth(i),0)]);r!==-1&&t>r+1&&(t=r+1),r!==-1&&n>r+1&&(n=r+1);let s=this._renderedViewLine.getVisibleRangesForRange(e,t,n,i);return s&&s.length>0?new Fv(!1,s):null}getColumnOfNodeOffset(e,t){return this._renderedViewLine?this._renderedViewLine.getColumnOfNodeOffset(e,t):1}};var Gm=class{domNode;input;_characterMapping;_charWidth;_keyColumnPixelOffsetCache;_cachedWidth=-1;constructor(e,t,n){this.domNode=e,this.input=t;let i=Math.floor(t.lineContent.length/300);if(i>0){this._keyColumnPixelOffsetCache=new Float32Array(i);for(let r=0;r<i;r++)this._keyColumnPixelOffsetCache[r]=-1}else this._keyColumnPixelOffsetCache=null;this._characterMapping=n,this._charWidth=t.spaceWidth}getWidth(e){if(!this.domNode||this.input.lineContent.length<300){let t=this._characterMapping.getHorizontalOffset(this._characterMapping.length);return Math.round(this._charWidth*t)}return this._cachedWidth===-1&&(this._cachedWidth=this._getReadingTarget(this.domNode).offsetWidth,e?.markDidDomLayout()),this._cachedWidth}getWidthIsFast(){return this.input.lineContent.length<300||this._cachedWidth!==-1}monospaceAssumptionsAreValid(){if(!this.domNode)return jm;if(this.input.lineContent.length<300){let e=this.getWidth(null),t=this.domNode.domNode.firstChild.offsetWidth;Math.abs(e-t)>=2&&(console.warn("monospace assumptions have been violated, therefore disabling monospace optimizations!"),jm=!1)}return jm}toSlowRenderedLine(){return F4(this.domNode,this.input,this._characterMapping,!1,0)}getVisibleRangesForRange(e,t,n,i){let r=this._getColumnPixelOffset(e,t,i),s=this._getColumnPixelOffset(e,n,i);return[new Ys(r,s-r)]}_getColumnPixelOffset(e,t,n){if(t<=300){let d=this._characterMapping.getHorizontalOffset(t);return this._charWidth*d}let i=Math.floor((t-1)/300)-1,r=(i+1)*300+1,s=-1;if(this._keyColumnPixelOffsetCache&&(s=this._keyColumnPixelOffsetCache[i],s===-1&&(s=this._actualReadPixelOffset(e,r,n),this._keyColumnPixelOffsetCache[i]=s)),s===-1){let d=this._characterMapping.getHorizontalOffset(t);return this._charWidth*d}let a=this._characterMapping.getHorizontalOffset(r),l=this._characterMapping.getHorizontalOffset(t);return s+this._charWidth*(l-a)}_getReadingTarget(e){return e.domNode.firstChild}_actualReadPixelOffset(e,t,n){if(!this.domNode)return-1;let i=this._characterMapping.getDomPosition(t),r=rp.readHorizontalRanges(this._getReadingTarget(this.domNode),i.partIndex,i.charIndex,i.partIndex,i.charIndex,n);return!r||r.length===0?-1:r[0].left}getColumnOfNodeOffset(e,t){return B4(this._characterMapping,e,t)}},Wx=class{domNode;input;_characterMapping;_isWhitespaceOnly;_containsForeignElements;_cachedWidth;_pixelOffsetCache;constructor(e,t,n,i,r){if(this.domNode=e,this.input=t,this._characterMapping=n,this._isWhitespaceOnly=/^\s*$/.test(t.lineContent),this._containsForeignElements=r,this._cachedWidth=-1,this._pixelOffsetCache=null,!i||this._characterMapping.length===0){this._pixelOffsetCache=new Float32Array(Math.max(2,this._characterMapping.length+1));for(let s=0,a=this._characterMapping.length;s<=a;s++)this._pixelOffsetCache[s]=-1}}_getReadingTarget(e){return e.domNode.firstChild}getWidth(e){return this.domNode?(this._cachedWidth===-1&&(this._cachedWidth=this._getReadingTarget(this.domNode).offsetWidth,e?.markDidDomLayout()),this._cachedWidth):0}getWidthIsFast(){return this._cachedWidth!==-1}getVisibleRangesForRange(e,t,n,i){if(!this.domNode)return null;if(this._pixelOffsetCache!==null){let r=this._readPixelOffset(this.domNode,e,t,i);if(r===-1)return null;let s=this._readPixelOffset(this.domNode,e,n,i);return s===-1?null:[new Ys(r,s-r)]}return this._readVisibleRangesForRange(this.domNode,e,t,n,i)}_readVisibleRangesForRange(e,t,n,i,r){if(n===i){let s=this._readPixelOffset(e,t,n,r);return s===-1?null:[new Ys(s,0)]}else return this._readRawVisibleRangesForRange(e,n,i,r)}_readPixelOffset(e,t,n,i){if(this._characterMapping.length===0){if(this._containsForeignElements===0||this._containsForeignElements===2)return 0;if(this._containsForeignElements===1)return this.getWidth(i);let r=this._getReadingTarget(e);return r.firstChild?(i.markDidDomLayout(),r.firstChild.offsetWidth):0}if(this._pixelOffsetCache!==null){let r=this._pixelOffsetCache[n];if(r!==-1)return r;let s=this._actualReadPixelOffset(e,t,n,i);return this._pixelOffsetCache[n]=s,s}return this._actualReadPixelOffset(e,t,n,i)}_actualReadPixelOffset(e,t,n,i){if(this._characterMapping.length===0){let l=rp.readHorizontalRanges(this._getReadingTarget(e),0,0,0,0,i);return!l||l.length===0?-1:l[0].left}if(n===this._characterMapping.length&&this._isWhitespaceOnly&&this._containsForeignElements===0)return this.getWidth(i);let r=this._characterMapping.getDomPosition(n),s=rp.readHorizontalRanges(this._getReadingTarget(e),r.partIndex,r.charIndex,r.partIndex,r.charIndex,i);if(!s||s.length===0)return-1;let a=s[0].left;if(this.input.isBasicASCII){let l=this._characterMapping.getHorizontalOffset(n),d=Math.round(this.input.spaceWidth*l);if(Math.abs(d-a)<=1)return d}return a}_readRawVisibleRangesForRange(e,t,n,i){if(t===1&&n===this._characterMapping.length)return[new Ys(0,this.getWidth(i))];let r=this._characterMapping.getDomPosition(t),s=this._characterMapping.getDomPosition(n);return rp.readHorizontalRanges(this._getReadingTarget(e),r.partIndex,r.charIndex,s.partIndex,s.charIndex,i)}getColumnOfNodeOffset(e,t){return B4(this._characterMapping,e,t)}},KP=class extends Wx{_readVisibleRangesForRange(e,t,n,i,r){let s=super._readVisibleRangesForRange(e,t,n,i,r);if(!s||s.length===0||n===i||n===1&&i===this._characterMapping.length)return s;if(!this.input.containsRTL){let a=this._readPixelOffset(e,t,i,r);if(a!==-1){let l=s[s.length-1];l.left<a&&(l.width=a-l.left)}}return s}},F4=function(){return Ps?yj:Ij}();function yj(o,e,t,n,i){return new KP(o,e,t,n,i)}function Ij(o,e,t,n,i){return new Wx(o,e,t,n,i)}function B4(o,e,t){let n=e.textContent.length,i=-1;for(;e;)e=e.previousSibling,i++;return o.getColumn(new Vv(i,t),n)}var ql="monaco-mouse-cursor-text";var Hx=class{constructor(e,t,n,i,r,s,a){this.top=e;this.left=t;this.paddingLeft=n;this.width=i;this.height=r;this.textContent=s;this.textContentClassName=a}};var Kv=class{_context;_domNode;_cursorStyle;_lineCursorWidth;_lineHeight;_typicalHalfwidthCharacterWidth;_isVisible;_position;_pluralityClass;_lastRenderedContent;_renderData;constructor(e,t){this._context=e;let n=this._context.configuration.options,i=n.get(51);this._cursorStyle=n.get(28),this._lineHeight=n.get(68),this._typicalHalfwidthCharacterWidth=i.typicalHalfwidthCharacterWidth,this._lineCursorWidth=Math.min(n.get(31),this._typicalHalfwidthCharacterWidth),this._isVisible=!0,this._domNode=We(document.createElement("div")),this._domNode.setClassName(`cursor ${ql}`),this._domNode.setHeight(this._lineHeight),this._domNode.setTop(0),this._domNode.setLeft(0),on(this._domNode,i),this._domNode.setDisplay("none"),this._position=new A(1,1),this._pluralityClass="",this.setPlurality(t),this._lastRenderedContent="",this._renderData=null}getDomNode(){return this._domNode}getPosition(){return this._position}setPlurality(e){switch(e){default:case 0:this._pluralityClass="";break;case 1:this._pluralityClass="cursor-primary";break;case 2:this._pluralityClass="cursor-secondary";break}}show(){this._isVisible||(this._domNode.setVisibility("inherit"),this._isVisible=!0)}hide(){this._isVisible&&(this._domNode.setVisibility("hidden"),this._isVisible=!1)}onConfigurationChanged(e){let t=this._context.configuration.options,n=t.get(51);return this._cursorStyle=t.get(28),this._lineHeight=t.get(68),this._typicalHalfwidthCharacterWidth=n.typicalHalfwidthCharacterWidth,this._lineCursorWidth=Math.min(t.get(31),this._typicalHalfwidthCharacterWidth),on(this._domNode,n),!0}onCursorPositionChanged(e,t){return t?this._domNode.domNode.style.transitionProperty="none":this._domNode.domNode.style.transitionProperty="",this._position=e,!0}_getGraphemeAwarePosition(){let{lineNumber:e,column:t}=this._position,n=this._context.viewModel.getLineContent(e),[i,r]=dI(n,t-1);return[new A(e,i+1),n.substring(i,r)]}_prepareRender(e){let t="",n="",[i,r]=this._getGraphemeAwarePosition();if(this._cursorStyle===1||this._cursorStyle===4){let p=e.visibleRangeForPosition(i);if(!p||p.outsideRenderedLine)return null;let h=Ce(this._domNode.domNode),f;this._cursorStyle===1?(f=sk(h,this._lineCursorWidth>0?this._lineCursorWidth:2),f>2&&(t=r,n=this._getTokenClassName(i))):f=sk(h,1);let g=p.left,b=0;f>=2&&g>=1&&(b=1,g-=b);let v=e.getVerticalOffsetForLineNumber(i.lineNumber)-e.bigNumbersDelta;return new Hx(v,g,b,f,this._lineHeight,t,n)}let s=e.linesVisibleRangesForRange(new P(i.lineNumber,i.column,i.lineNumber,i.column+r.length),!1);if(!s||s.length===0)return null;let a=s[0];if(a.outsideRenderedLine||a.ranges.length===0)return null;let l=a.ranges[0],d=r==="	"?this._typicalHalfwidthCharacterWidth:l.width<1?this._typicalHalfwidthCharacterWidth:l.width;this._cursorStyle===2&&(t=r,n=this._getTokenClassName(i));let c=e.getVerticalOffsetForLineNumber(i.lineNumber)-e.bigNumbersDelta,u=this._lineHeight;return(this._cursorStyle===3||this._cursorStyle===6)&&(c+=this._lineHeight-2,u=2),new Hx(c,l.left,0,d,u,t,n)}_getTokenClassName(e){let t=this._context.viewModel.getViewLineData(e.lineNumber),n=t.tokens.findTokenIndexAtOffset(e.column-1);return t.tokens.getClassName(n)}prepareRender(e){this._renderData=this._prepareRender(e)}render(e){return this._renderData?(this._lastRenderedContent!==this._renderData.textContent&&(this._lastRenderedContent=this._renderData.textContent,this._domNode.domNode.textContent=this._lastRenderedContent),this._domNode.setClassName(`cursor ${this._pluralityClass} ${ql} ${this._renderData.textContentClassName}`),this._domNode.setDisplay("block"),this._domNode.setTop(this._renderData.top),this._domNode.setLeft(this._renderData.left),this._domNode.setPaddingLeft(this._renderData.paddingLeft),this._domNode.setWidth(this._renderData.width),this._domNode.setLineHeight(this._renderData.height),this._domNode.setHeight(this._renderData.height),{domNode:this._domNode.domNode,position:this._position,contentLeft:this._renderData.left,height:this._renderData.height,width:2}):(this._domNode.setDisplay("none"),null)}};var sp=class o{static whitespaceVisibleColumn(e,t,n){let i=e.length,r=0,s=-1,a=-1;for(let l=0;l<i;l++){if(l===t)return[s,a,r];switch(r%n===0&&(s=l,a=r),e.charCodeAt(l)){case 32:r+=1;break;case 9:r=Vt.nextRenderTabStop(r,n);break;default:return[-1,-1,-1]}}return t===i?[s,a,r]:[-1,-1,-1]}static atomicPosition(e,t,n,i){let r=e.length,[s,a,l]=o.whitespaceVisibleColumn(e,t,n);if(l===-1)return-1;let d;switch(i){case 0:d=!0;break;case 1:d=!1;break;case 2:if(l%n===0)return t;d=l%n<=n/2;break}if(d){if(s===-1)return-1;let p=a;for(let h=s;h<r;++h){if(p===a+n)return s;switch(e.charCodeAt(h)){case 32:p+=1;break;case 9:p=Vt.nextRenderTabStop(p,n);break;default:return-1}}return p===a+n?s:-1}let c=Vt.nextRenderTabStop(l,n),u=l;for(let p=t;p<r;p++){if(u===c)return p;switch(e.charCodeAt(p)){case 32:u+=1;break;case 9:u=Vt.nextRenderTabStop(u,n);break;default:return-1}}return u===c?r:-1}};var Za=class{constructor(e=null){this.hitTarget=e}type=0},Ux=class{constructor(e,t,n){this.position=e;this.spanNode=t;this.injectedText=n}type=1;get hitTarget(){return this.spanNode}},qm;(e=>{function o(t,n,i){let r=t.getPositionFromDOMInfo(n,i);return r?new Ux(r,n,null):new Za(n)}e.createFromDOMInfo=o})(qm||={});var zx=class{constructor(e,t){this.lastViewCursorsRenderData=e;this.lastTextareaPosition=t}},si=class{static _deduceRage(e,t=null){return!t&&e?new P(e.lineNumber,e.column,e.lineNumber,e.column):t??null}static createUnknown(e,t,n){return{type:0,element:e,mouseColumn:t,position:n,range:this._deduceRage(n)}}static createTextarea(e,t){return{type:1,element:e,mouseColumn:t,position:null,range:null}}static createMargin(e,t,n,i,r,s){return{type:e,element:t,mouseColumn:n,position:i,range:r,detail:s}}static createViewZone(e,t,n,i,r){return{type:e,element:t,mouseColumn:n,position:i,range:this._deduceRage(i),detail:r}}static createContentText(e,t,n,i,r){return{type:6,element:e,mouseColumn:t,position:n,range:this._deduceRage(n,i),detail:r}}static createContentEmpty(e,t,n,i){return{type:7,element:e,mouseColumn:t,position:n,range:this._deduceRage(n),detail:i}}static createContentWidget(e,t,n){return{type:9,element:e,mouseColumn:t,position:null,range:null,detail:n}}static createScrollbar(e,t,n){return{type:11,element:e,mouseColumn:t,position:n,range:this._deduceRage(n)}}static createOverlayWidget(e,t,n){return{type:12,element:e,mouseColumn:t,position:null,range:null,detail:n}}static createOutsideEditor(e,t,n,i){return{type:13,element:null,mouseColumn:e,position:t,range:this._deduceRage(t),outsidePosition:n,outsideDistance:i}}static _typeToString(e){return e===1?"TEXTAREA":e===2?"GUTTER_GLYPH_MARGIN":e===3?"GUTTER_LINE_NUMBERS":e===4?"GUTTER_LINE_DECORATIONS":e===5?"GUTTER_VIEW_ZONE":e===6?"CONTENT_TEXT":e===7?"CONTENT_EMPTY":e===8?"CONTENT_VIEW_ZONE":e===9?"CONTENT_WIDGET":e===10?"OVERVIEW_RULER":e===11?"SCROLLBAR":e===12?"OVERLAY_WIDGET":"UNKNOWN"}static toString(e){return this._typeToString(e.type)+": "+e.position+" - "+e.range+" - "+JSON.stringify(e.detail)}},Pi=class{static isTextArea(e){return e.length===2&&e[0]===3&&e[1]===7}static isChildOfViewLines(e){return e.length>=4&&e[0]===3&&e[3]===8}static isStrictChildOfViewLines(e){return e.length>4&&e[0]===3&&e[3]===8}static isChildOfScrollableElement(e){return e.length>=2&&e[0]===3&&e[1]===6}static isChildOfMinimap(e){return e.length>=2&&e[0]===3&&e[1]===9}static isChildOfContentWidgets(e){return e.length>=4&&e[0]===3&&e[3]===1}static isChildOfOverflowGuard(e){return e.length>=1&&e[0]===3}static isChildOfOverflowingContentWidgets(e){return e.length>=1&&e[0]===2}static isChildOfOverlayWidgets(e){return e.length>=2&&e[0]===3&&e[1]===4}static isChildOfOverflowingOverlayWidgets(e){return e.length>=1&&e[0]===5}},$m=class o{viewModel;layoutInfo;viewDomNode;lineHeight;stickyTabStops;typicalHalfwidthCharacterWidth;lastRenderData;_context;_viewHelper;constructor(e,t,n){this.viewModel=e.viewModel;let i=e.configuration.options;this.layoutInfo=i.get(147),this.viewDomNode=t.viewDomNode,this.lineHeight=i.get(68),this.stickyTabStops=i.get(118),this.typicalHalfwidthCharacterWidth=i.get(51).typicalHalfwidthCharacterWidth,this.lastRenderData=n,this._context=e,this._viewHelper=t}getZoneAtCoord(e){return o.getZoneAtCoord(this._context,e)}static getZoneAtCoord(e,t){let n=e.viewLayout.getWhitespaceAtVerticalOffset(t);if(n){let i=n.verticalOffset+n.height/2,r=e.viewModel.getLineCount(),s=null,a,l=null;return n.afterLineNumber!==r&&(l=new A(n.afterLineNumber+1,1)),n.afterLineNumber>0&&(s=new A(n.afterLineNumber,e.viewModel.getLineMaxColumn(n.afterLineNumber))),l===null?a=s:s===null?a=l:t<i?a=s:a=l,{viewZoneId:n.id,afterLineNumber:n.afterLineNumber,positionBefore:s,positionAfter:l,position:a}}return null}getFullLineRangeAtCoord(e){if(this._context.viewLayout.isAfterLines(e)){let i=this._context.viewModel.getLineCount(),r=this._context.viewModel.getLineMaxColumn(i);return{range:new P(i,r,i,r),isAfterLines:!0}}let t=this._context.viewLayout.getLineNumberAtVerticalOffset(e),n=this._context.viewModel.getLineMaxColumn(t);return{range:new P(t,1,t,n),isAfterLines:!1}}getLineNumberAtVerticalOffset(e){return this._context.viewLayout.getLineNumberAtVerticalOffset(e)}isAfterLines(e){return this._context.viewLayout.isAfterLines(e)}isInTopPadding(e){return this._context.viewLayout.isInTopPadding(e)}isInBottomPadding(e){return this._context.viewLayout.isInBottomPadding(e)}getVerticalOffsetForLineNumber(e){return this._context.viewLayout.getVerticalOffsetForLineNumber(e)}findAttribute(e,t){return o._findAttribute(e,t,this._viewHelper.viewDomNode)}static _findAttribute(e,t,n){for(;e&&e!==e.ownerDocument.body;){if(e.hasAttribute&&e.hasAttribute(t))return e.getAttribute(t);if(e===n)return null;e=e.parentNode}return null}getLineWidth(e){return this._viewHelper.getLineWidth(e)}visibleRangeForPosition(e,t){return this._viewHelper.visibleRangeForPosition(e,t)}getPositionFromDOMInfo(e,t){return this._viewHelper.getPositionFromDOMInfo(e,t)}getCurrentScrollTop(){return this._context.viewLayout.getCurrentScrollTop()}getCurrentScrollLeft(){return this._context.viewLayout.getCurrentScrollLeft()}},jP=class{editorPos;pos;relativePos;mouseVerticalOffset;isInMarginArea;isInContentArea;mouseContentHorizontalOffset;mouseColumn;constructor(e,t,n,i){this.editorPos=t,this.pos=n,this.relativePos=i,this.mouseVerticalOffset=Math.max(0,e.getCurrentScrollTop()+this.relativePos.y),this.mouseContentHorizontalOffset=e.getCurrentScrollLeft()+this.relativePos.x-e.layoutInfo.contentLeft,this.isInMarginArea=this.relativePos.x<e.layoutInfo.contentLeft&&this.relativePos.x>=e.layoutInfo.glyphMarginLeft,this.isInContentArea=!this.isInMarginArea,this.mouseColumn=Math.max(0,Ym._getMouseColumn(this.mouseContentHorizontalOffset,e.typicalHalfwidthCharacterWidth))}},qP=class extends jP{_ctx;_eventTarget;hitTestResult=new Qn(()=>Ym.doHitTest(this._ctx,this));_useHitTestTarget;_targetPathCacheElement=null;_targetPathCacheValue=new Uint8Array(0);get target(){return this._useHitTestTarget?this.hitTestResult.value.hitTarget:this._eventTarget}get targetPath(){return this._targetPathCacheElement!==this.target&&(this._targetPathCacheElement=this.target,this._targetPathCacheValue=ri.collect(this.target,this._ctx.viewDomNode)),this._targetPathCacheValue}constructor(e,t,n,i,r){super(e,t,n,i),this._ctx=e,this._eventTarget=r;let s=!!this._eventTarget;this._useHitTestTarget=!s}toString(){return`pos(${this.pos.x},${this.pos.y}), editorPos(${this.editorPos.x},${this.editorPos.y}), relativePos(${this.relativePos.x},${this.relativePos.y}), mouseVerticalOffset: ${this.mouseVerticalOffset}, mouseContentHorizontalOffset: ${this.mouseContentHorizontalOffset}
	target: ${this.target?this.target.outerHTML:null}`}get wouldBenefitFromHitTestTargetSwitch(){return!this._useHitTestTarget&&this.hitTestResult.value.hitTarget!==null&&this.target!==this.hitTestResult.value.hitTarget}switchToHitTestTarget(){this._useHitTestTarget=!0}_getMouseColumn(e=null){return e&&e.column<this._ctx.viewModel.getLineMaxColumn(e.lineNumber)?Vt.visibleColumnFromColumn(this._ctx.viewModel.getLineContent(e.lineNumber),e.column,this._ctx.viewModel.model.getOptions().tabSize)+1:this.mouseColumn}fulfillUnknown(e=null){return si.createUnknown(this.target,this._getMouseColumn(e),e)}fulfillTextarea(){return si.createTextarea(this.target,this._getMouseColumn())}fulfillMargin(e,t,n,i){return si.createMargin(e,this.target,this._getMouseColumn(t),t,n,i)}fulfillViewZone(e,t,n){return si.createViewZone(e,this.target,this._getMouseColumn(t),t,n)}fulfillContentText(e,t,n){return si.createContentText(this.target,this._getMouseColumn(e),e,t,n)}fulfillContentEmpty(e,t){return si.createContentEmpty(this.target,this._getMouseColumn(e),e,t)}fulfillContentWidget(e){return si.createContentWidget(this.target,this._getMouseColumn(),e)}fulfillScrollbar(e){return si.createScrollbar(this.target,this._getMouseColumn(e),e)}fulfillOverlayWidget(e){return si.createOverlayWidget(this.target,this._getMouseColumn(),e)}},V4={isAfterLines:!0};function GP(o){return{isAfterLines:!1,horizontalDistanceToText:o}}var Ym=class o{_context;_viewHelper;constructor(e,t){this._context=e,this._viewHelper=t}mouseTargetIsWidget(e){let t=e.target,n=ri.collect(t,this._viewHelper.viewDomNode);return!!(Pi.isChildOfContentWidgets(n)||Pi.isChildOfOverflowingContentWidgets(n)||Pi.isChildOfOverlayWidgets(n)||Pi.isChildOfOverflowingOverlayWidgets(n))}createMouseTarget(e,t,n,i,r){let s=new $m(this._context,this._viewHelper,e),a=new qP(s,t,n,i,r);try{let l=o._createMouseTarget(s,a);if(l.type===6&&s.stickyTabStops&&l.position!==null){let d=o._snapToSoftTabBoundary(l.position,s.viewModel),c=P.fromPositions(d,d).plusRange(l.range);return a.fulfillContentText(d,c,l.detail)}return l}catch{return a.fulfillUnknown()}}static _createMouseTarget(e,t){if(t.target===null)return t.fulfillUnknown();let n=t,i=null;return!Pi.isChildOfOverflowGuard(t.targetPath)&&!Pi.isChildOfOverflowingContentWidgets(t.targetPath)&&!Pi.isChildOfOverflowingOverlayWidgets(t.targetPath)&&(i=i||t.fulfillUnknown()),i=i||o._hitTestContentWidget(e,n),i=i||o._hitTestOverlayWidget(e,n),i=i||o._hitTestMinimap(e,n),i=i||o._hitTestScrollbarSlider(e,n),i=i||o._hitTestViewZone(e,n),i=i||o._hitTestMargin(e,n),i=i||o._hitTestViewCursor(e,n),i=i||o._hitTestTextArea(e,n),i=i||o._hitTestViewLines(e,n),i=i||o._hitTestScrollbar(e,n),i||t.fulfillUnknown()}static _hitTestContentWidget(e,t){if(Pi.isChildOfContentWidgets(t.targetPath)||Pi.isChildOfOverflowingContentWidgets(t.targetPath)){let n=e.findAttribute(t.target,"widgetId");return n?t.fulfillContentWidget(n):t.fulfillUnknown()}return null}static _hitTestOverlayWidget(e,t){if(Pi.isChildOfOverlayWidgets(t.targetPath)||Pi.isChildOfOverflowingOverlayWidgets(t.targetPath)){let n=e.findAttribute(t.target,"widgetId");return n?t.fulfillOverlayWidget(n):t.fulfillUnknown()}return null}static _hitTestViewCursor(e,t){if(t.target){let n=e.lastRenderData.lastViewCursorsRenderData;for(let i of n)if(t.target===i.domNode)return t.fulfillContentText(i.position,null,{mightBeForeignElement:!1,injectedText:null})}if(t.isInContentArea){let n=e.lastRenderData.lastViewCursorsRenderData,i=t.mouseContentHorizontalOffset,r=t.mouseVerticalOffset;for(let s of n){if(i<s.contentLeft||i>s.contentLeft+s.width)continue;let a=e.getVerticalOffsetForLineNumber(s.position.lineNumber);if(a<=r&&r<=a+s.height)return t.fulfillContentText(s.position,null,{mightBeForeignElement:!1,injectedText:null})}}return null}static _hitTestViewZone(e,t){let n=e.getZoneAtCoord(t.mouseVerticalOffset);if(n){let i=t.isInContentArea?8:5;return t.fulfillViewZone(i,n.position,n)}return null}static _hitTestTextArea(e,t){return Pi.isTextArea(t.targetPath)?e.lastRenderData.lastTextareaPosition?t.fulfillContentText(e.lastRenderData.lastTextareaPosition,null,{mightBeForeignElement:!1,injectedText:null}):t.fulfillTextarea():null}static _hitTestMargin(e,t){if(t.isInMarginArea){let n=e.getFullLineRangeAtCoord(t.mouseVerticalOffset),i=n.range.getStartPosition(),r=Math.abs(t.relativePos.x),s={isAfterLines:n.isAfterLines,glyphMarginLeft:e.layoutInfo.glyphMarginLeft,glyphMarginWidth:e.layoutInfo.glyphMarginWidth,lineNumbersWidth:e.layoutInfo.lineNumbersWidth,offsetX:r};if(r-=e.layoutInfo.glyphMarginLeft,r<=e.layoutInfo.glyphMarginWidth){let a=e.viewModel.coordinatesConverter.convertViewPositionToModelPosition(n.range.getStartPosition()),l=e.viewModel.glyphLanes.getLanesAtLine(a.lineNumber);return s.glyphMarginLane=l[Math.floor(r/e.lineHeight)],t.fulfillMargin(2,i,n.range,s)}return r-=e.layoutInfo.glyphMarginWidth,r<=e.layoutInfo.lineNumbersWidth?t.fulfillMargin(3,i,n.range,s):(r-=e.layoutInfo.lineNumbersWidth,t.fulfillMargin(4,i,n.range,s))}return null}static _hitTestViewLines(e,t){if(!Pi.isChildOfViewLines(t.targetPath))return null;if(e.isInTopPadding(t.mouseVerticalOffset))return t.fulfillContentEmpty(new A(1,1),V4);if(e.isAfterLines(t.mouseVerticalOffset)||e.isInBottomPadding(t.mouseVerticalOffset)){let i=e.viewModel.getLineCount(),r=e.viewModel.getLineMaxColumn(i);return t.fulfillContentEmpty(new A(i,r),V4)}if(Pi.isStrictChildOfViewLines(t.targetPath)){let i=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset);if(e.viewModel.getLineLength(i)===0){let s=e.getLineWidth(i),a=GP(t.mouseContentHorizontalOffset-s);return t.fulfillContentEmpty(new A(i,1),a)}let r=e.getLineWidth(i);if(t.mouseContentHorizontalOffset>=r){let s=GP(t.mouseContentHorizontalOffset-r),a=new A(i,e.viewModel.getLineMaxColumn(i));return t.fulfillContentEmpty(a,s)}}let n=t.hitTestResult.value;return n.type===1?o.createMouseTargetFromHitTestPosition(e,t,n.spanNode,n.position,n.injectedText):t.wouldBenefitFromHitTestTargetSwitch?(t.switchToHitTestTarget(),this._createMouseTarget(e,t)):t.fulfillUnknown()}static _hitTestMinimap(e,t){if(Pi.isChildOfMinimap(t.targetPath)){let n=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),i=e.viewModel.getLineMaxColumn(n);return t.fulfillScrollbar(new A(n,i))}return null}static _hitTestScrollbarSlider(e,t){if(Pi.isChildOfScrollableElement(t.targetPath)&&t.target&&t.target.nodeType===1){let n=t.target.className;if(n&&/\b(slider|scrollbar)\b/.test(n)){let i=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),r=e.viewModel.getLineMaxColumn(i);return t.fulfillScrollbar(new A(i,r))}}return null}static _hitTestScrollbar(e,t){if(Pi.isChildOfScrollableElement(t.targetPath)){let n=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),i=e.viewModel.getLineMaxColumn(n);return t.fulfillScrollbar(new A(n,i))}return null}getMouseColumn(e){let t=this._context.configuration.options,n=t.get(147),i=this._context.viewLayout.getCurrentScrollLeft()+e.x-n.contentLeft;return o._getMouseColumn(i,t.get(51).typicalHalfwidthCharacterWidth)}static _getMouseColumn(e,t){return e<0?1:Math.round(e/t)+1}static createMouseTargetFromHitTestPosition(e,t,n,i,r){let s=i.lineNumber,a=i.column,l=e.getLineWidth(s);if(t.mouseContentHorizontalOffset>l){let v=GP(t.mouseContentHorizontalOffset-l);return t.fulfillContentEmpty(i,v)}let d=e.visibleRangeForPosition(s,a);if(!d)return t.fulfillUnknown(i);let c=d.left;if(Math.abs(t.mouseContentHorizontalOffset-c)<1)return t.fulfillContentText(i,null,{mightBeForeignElement:!!r,injectedText:r});let u=[];if(u.push({offset:d.left,column:a}),a>1){let v=e.visibleRangeForPosition(s,a-1);v&&u.push({offset:v.left,column:a-1})}let p=e.viewModel.getLineMaxColumn(s);if(a<p){let v=e.visibleRangeForPosition(s,a+1);v&&u.push({offset:v.left,column:a+1})}u.sort((v,y)=>v.offset-y.offset);let h=t.pos.toClientCoordinates(Ce(e.viewDomNode)),f=n.getBoundingClientRect(),g=f.left<=h.clientX&&h.clientX<=f.right,b=null;for(let v=1;v<u.length;v++){let y=u[v-1],S=u[v];if(y.offset<=t.mouseContentHorizontalOffset&&t.mouseContentHorizontalOffset<=S.offset){b=new P(s,y.column,s,S.column);let E=Math.abs(y.offset-t.mouseContentHorizontalOffset),C=Math.abs(S.offset-t.mouseContentHorizontalOffset);i=E<C?new A(s,y.column):new A(s,S.column);break}}return t.fulfillContentText(i,b,{mightBeForeignElement:!g||!!r,injectedText:r})}static _doHitTestWithCaretRangeFromPoint(e,t){let n=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),i=e.getVerticalOffsetForLineNumber(n),r=i+e.lineHeight;if(!(n===e.viewModel.getLineCount()&&t.mouseVerticalOffset>r)){let a=Math.floor((i+r)/2),l=t.pos.y+(a-t.mouseVerticalOffset);l<=t.editorPos.y&&(l=t.editorPos.y+1),l>=t.editorPos.y+t.editorPos.height&&(l=t.editorPos.y+t.editorPos.height-1);let d=new Ec(t.pos.x,l),c=this._actualDoHitTestWithCaretRangeFromPoint(e,d.toClientCoordinates(Ce(e.viewDomNode)));if(c.type===1)return c}return this._actualDoHitTestWithCaretRangeFromPoint(e,t.pos.toClientCoordinates(Ce(e.viewDomNode)))}static _actualDoHitTestWithCaretRangeFromPoint(e,t){let n=Yd(e.viewDomNode),i;if(n?typeof n.caretRangeFromPoint>"u"?i=Ej(n,t.clientX,t.clientY):i=n.caretRangeFromPoint(t.clientX,t.clientY):i=e.viewDomNode.ownerDocument.caretRangeFromPoint(t.clientX,t.clientY),!i||!i.startContainer)return new Za;let r=i.startContainer;if(r.nodeType===r.TEXT_NODE){let s=r.parentNode,a=s?s.parentNode:null,l=a?a.parentNode:null;return(l&&l.nodeType===l.ELEMENT_NODE?l.className:null)===Zs.CLASS_NAME?qm.createFromDOMInfo(e,s,i.startOffset):new Za(r.parentNode)}else if(r.nodeType===r.ELEMENT_NODE){let s=r.parentNode,a=s?s.parentNode:null;return(a&&a.nodeType===a.ELEMENT_NODE?a.className:null)===Zs.CLASS_NAME?qm.createFromDOMInfo(e,r,r.textContent.length):new Za(r)}return new Za}static _doHitTestWithCaretPositionFromPoint(e,t){let n=e.viewDomNode.ownerDocument.caretPositionFromPoint(t.clientX,t.clientY);if(n.offsetNode.nodeType===n.offsetNode.TEXT_NODE){let i=n.offsetNode.parentNode,r=i?i.parentNode:null,s=r?r.parentNode:null;return(s&&s.nodeType===s.ELEMENT_NODE?s.className:null)===Zs.CLASS_NAME?qm.createFromDOMInfo(e,n.offsetNode.parentNode,n.offset):new Za(n.offsetNode.parentNode)}if(n.offsetNode.nodeType===n.offsetNode.ELEMENT_NODE){let i=n.offsetNode.parentNode,r=i&&i.nodeType===i.ELEMENT_NODE?i.className:null,s=i?i.parentNode:null,a=s&&s.nodeType===s.ELEMENT_NODE?s.className:null;if(r===Zs.CLASS_NAME){let l=n.offsetNode.childNodes[Math.min(n.offset,n.offsetNode.childNodes.length-1)];if(l)return qm.createFromDOMInfo(e,l,0)}else if(a===Zs.CLASS_NAME)return qm.createFromDOMInfo(e,n.offsetNode,0)}return new Za(n.offsetNode)}static _snapToSoftTabBoundary(e,t){let n=t.getLineContent(e.lineNumber),{tabSize:i}=t.model.getOptions(),r=sp.atomicPosition(n,e.column-1,i,2);return r!==-1?new A(e.lineNumber,r+1):e}static doHitTest(e,t){let n=new Za;if(typeof e.viewDomNode.ownerDocument.caretRangeFromPoint=="function"?n=this._doHitTestWithCaretRangeFromPoint(e,t):e.viewDomNode.ownerDocument.caretPositionFromPoint&&(n=this._doHitTestWithCaretPositionFromPoint(e,t.pos.toClientCoordinates(Ce(e.viewDomNode)))),n.type===1){let i=e.viewModel.getInjectedTextAt(n.position),r=e.viewModel.normalizePosition(n.position,2);(i||!r.equals(n.position))&&(n=new Ux(r,n.spanNode,i))}return n}};function Ej(o,e,t){let n=document.createRange(),i=o.elementFromPoint(e,t);if(i!==null){for(;i&&i.firstChild&&i.firstChild.nodeType!==i.firstChild.TEXT_NODE&&i.lastChild&&i.lastChild.firstChild;)i=i.lastChild;let r=i.getBoundingClientRect(),s=Ce(i),a=s.getComputedStyle(i,null).getPropertyValue("font-style"),l=s.getComputedStyle(i,null).getPropertyValue("font-variant"),d=s.getComputedStyle(i,null).getPropertyValue("font-weight"),c=s.getComputedStyle(i,null).getPropertyValue("font-size"),u=s.getComputedStyle(i,null).getPropertyValue("line-height"),p=s.getComputedStyle(i,null).getPropertyValue("font-family"),h=`${a} ${l} ${d} ${c}/${u} ${p}`,f=i.innerText,g=r.left,b=0,v;if(e>r.left+r.width)b=f.length;else{let y=$P.getInstance();for(let S=0;S<f.length+1;S++){if(v=y.getCharWidth(f.charAt(S),h)/2,g+=v,e<g){b=S;break}g+=v}}n.setStart(i.firstChild,b),n.setEnd(i.firstChild,b)}return n}var $P=class o{static _INSTANCE=null;static getInstance(){return o._INSTANCE||(o._INSTANCE=new o),o._INSTANCE}_cache;_canvas;constructor(){this._cache={},this._canvas=document.createElement("canvas")}getCharWidth(e,t){let n=e+t;if(this._cache[n])return this._cache[n];let i=this._canvas.getContext("2d");i.font=t;let s=i.measureText(e).width;return this._cache[n]=s,s}};var wc=class o{static columnSelect(e,t,n,i,r,s){let a=Math.abs(r-n)+1,l=n>r,d=i>s,c=i<s,u=[];for(let p=0;p<a;p++){let h=n+(l?-p:p),f=e.columnFromVisibleColumn(t,h,i),g=e.columnFromVisibleColumn(t,h,s),b=e.visibleColumnFromColumn(t,new A(h,f)),v=e.visibleColumnFromColumn(t,new A(h,g));c&&(b>s||v<i)||d&&(v>i||b<s)||u.push(new Pn(new P(h,f,h,f),0,0,new A(h,g),0))}if(u.length===0)for(let p=0;p<a;p++){let h=n+(l?-p:p),f=t.getLineMaxColumn(h);u.push(new Pn(new P(h,f,h,f),0,0,new A(h,f),0))}return{viewStates:u,reversed:l,fromLineNumber:n,fromVisualColumn:i,toLineNumber:r,toVisualColumn:s}}static columnSelectLeft(e,t,n){let i=n.toViewVisualColumn;return i>0&&i--,o.columnSelect(e,t,n.fromViewLineNumber,n.fromViewVisualColumn,n.toViewLineNumber,i)}static columnSelectRight(e,t,n){let i=0,r=Math.min(n.fromViewLineNumber,n.toViewLineNumber),s=Math.max(n.fromViewLineNumber,n.toViewLineNumber);for(let l=r;l<=s;l++){let d=t.getLineMaxColumn(l),c=e.visibleColumnFromColumn(t,new A(l,d));i=Math.max(i,c)}let a=n.toViewVisualColumn;return a<i&&a++,this.columnSelect(e,t,n.fromViewLineNumber,n.fromViewVisualColumn,n.toViewLineNumber,a)}static columnSelectUp(e,t,n,i){let r=i?e.pageSize:1,s=Math.max(1,n.toViewLineNumber-r);return this.columnSelect(e,t,n.fromViewLineNumber,n.fromViewVisualColumn,s,n.toViewVisualColumn)}static columnSelectDown(e,t,n,i){let r=i?e.pageSize:1,s=Math.min(t.getLineCount(),n.toViewLineNumber+r);return this.columnSelect(e,t,n.fromViewLineNumber,n.fromViewVisualColumn,s,n.toViewVisualColumn)}};var Oi=class{_range;_text;insertsAutoWhitespace;constructor(e,t,n=!1){this._range=e,this._text=t,this.insertsAutoWhitespace=n}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){let i=t.getInverseEditOperations()[0].range;return $e.fromPositions(i.getEndPosition())}};var lp=class{_range;_text;insertsAutoWhitespace;constructor(e,t,n=!1){this._range=e,this._text=t,this.insertsAutoWhitespace=n}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){let i=t.getInverseEditOperations()[0].range;return $e.fromPositions(i.getStartPosition())}},dp=class{_range;_text;_columnDeltaOffset;_lineNumberDeltaOffset;insertsAutoWhitespace;constructor(e,t,n,i,r=!1){this._range=e,this._text=t,this._columnDeltaOffset=i,this._lineNumberDeltaOffset=n,this.insertsAutoWhitespace=r}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){let i=t.getInverseEditOperations()[0].range;return $e.fromPositions(i.getEndPosition().delta(this._lineNumberDeltaOffset,this._columnDeltaOffset))}},jx=class{_range;_text;_initialSelection;_forceMoveMarkers;_selectionId;constructor(e,t,n,i=!1){this._range=e,this._text=t,this._initialSelection=n,this._forceMoveMarkers=i,this._selectionId=null}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text,this._forceMoveMarkers),this._selectionId=t.trackSelection(this._initialSelection)}computeCursorState(e,t){return t.getTrackedSelection(this._selectionId)}};var Gv=class{_cursorPositionBrand=void 0;lineNumber;column;leftoverVisibleColumns;constructor(e,t,n){this.lineNumber=e,this.column=t,this.leftoverVisibleColumns=n}},pn=class o{static leftPosition(e,t){if(t.column>e.getLineMinColumn(t.lineNumber))return t.delta(void 0,-cL(e.getLineContent(t.lineNumber),t.column-1));if(t.lineNumber>1){let n=t.lineNumber-1;return new A(n,e.getLineMaxColumn(n))}else return t}static leftPositionAtomicSoftTabs(e,t,n){if(t.column<=e.getLineIndentColumn(t.lineNumber)){let i=e.getLineMinColumn(t.lineNumber),r=e.getLineContent(t.lineNumber),s=sp.atomicPosition(r,t.column-1,n,0);if(s!==-1&&s+1>=i)return new A(t.lineNumber,s+1)}return this.leftPosition(e,t)}static left(e,t,n){let i=e.stickyTabStops?o.leftPositionAtomicSoftTabs(t,n,e.tabSize):o.leftPosition(t,n);return new Gv(i.lineNumber,i.column,0)}static moveLeft(e,t,n,i,r){let s,a;if(n.hasSelection()&&!i)s=n.selection.startLineNumber,a=n.selection.startColumn;else{let l=n.position.delta(void 0,-(r-1)),d=t.normalizePosition(o.clipPositionColumn(l,t),0),c=o.left(e,t,d);s=c.lineNumber,a=c.column}return n.move(i,s,a,0)}static clipPositionColumn(e,t){return new A(e.lineNumber,o.clipRange(e.column,t.getLineMinColumn(e.lineNumber),t.getLineMaxColumn(e.lineNumber)))}static clipRange(e,t,n){return e<t?t:e>n?n:e}static rightPosition(e,t,n){return n<e.getLineMaxColumn(t)?n=n+ff(e.getLineContent(t),n-1):t<e.getLineCount()&&(t=t+1,n=e.getLineMinColumn(t)),new A(t,n)}static rightPositionAtomicSoftTabs(e,t,n,i,r){if(n<e.getLineIndentColumn(t)){let s=e.getLineContent(t),a=sp.atomicPosition(s,n-1,i,1);if(a!==-1)return new A(t,a+1)}return this.rightPosition(e,t,n)}static right(e,t,n){let i=e.stickyTabStops?o.rightPositionAtomicSoftTabs(t,n.lineNumber,n.column,e.tabSize,e.indentSize):o.rightPosition(t,n.lineNumber,n.column);return new Gv(i.lineNumber,i.column,0)}static moveRight(e,t,n,i,r){let s,a;if(n.hasSelection()&&!i)s=n.selection.endLineNumber,a=n.selection.endColumn;else{let l=n.position.delta(void 0,r-1),d=t.normalizePosition(o.clipPositionColumn(l,t),1),c=o.right(e,t,d);s=c.lineNumber,a=c.column}return n.move(i,s,a,0)}static vertical(e,t,n,i,r,s,a,l){let d=Vt.visibleColumnFromColumn(t.getLineContent(n),i,e.tabSize)+r,c=t.getLineCount(),u=n===1&&i===1,p=n===c&&i===t.getLineMaxColumn(n),h=s<n?u:p;if(n=s,n<1?(n=1,a?i=t.getLineMinColumn(n):i=Math.min(t.getLineMaxColumn(n),i)):n>c?(n=c,a?i=t.getLineMaxColumn(n):i=Math.min(t.getLineMaxColumn(n),i)):i=e.columnFromVisibleColumn(t,n,d),h?r=0:r=d-Vt.visibleColumnFromColumn(t.getLineContent(n),i,e.tabSize),l!==void 0){let f=new A(n,i),g=t.normalizePosition(f,l);r=r+(i-g.column),n=g.lineNumber,i=g.column}return new Gv(n,i,r)}static down(e,t,n,i,r,s,a){return this.vertical(e,t,n,i,r,n+s,a,4)}static moveDown(e,t,n,i,r){let s,a;n.hasSelection()&&!i?(s=n.selection.endLineNumber,a=n.selection.endColumn):(s=n.position.lineNumber,a=n.position.column);let l=0,d;do if(d=o.down(e,t,s+l,a,n.leftoverVisibleColumns,r,!0),t.normalizePosition(new A(d.lineNumber,d.column),2).lineNumber>s)break;while(l++<10&&s+l<t.getLineCount());return n.move(i,d.lineNumber,d.column,d.leftoverVisibleColumns)}static translateDown(e,t,n){let i=n.selection,r=o.down(e,t,i.selectionStartLineNumber,i.selectionStartColumn,n.selectionStartLeftoverVisibleColumns,1,!1),s=o.down(e,t,i.positionLineNumber,i.positionColumn,n.leftoverVisibleColumns,1,!1);return new Pn(new P(r.lineNumber,r.column,r.lineNumber,r.column),0,r.leftoverVisibleColumns,new A(s.lineNumber,s.column),s.leftoverVisibleColumns)}static up(e,t,n,i,r,s,a){return this.vertical(e,t,n,i,r,n-s,a,3)}static moveUp(e,t,n,i,r){let s,a;n.hasSelection()&&!i?(s=n.selection.startLineNumber,a=n.selection.startColumn):(s=n.position.lineNumber,a=n.position.column);let l=o.up(e,t,s,a,n.leftoverVisibleColumns,r,!0);return n.move(i,l.lineNumber,l.column,l.leftoverVisibleColumns)}static translateUp(e,t,n){let i=n.selection,r=o.up(e,t,i.selectionStartLineNumber,i.selectionStartColumn,n.selectionStartLeftoverVisibleColumns,1,!1),s=o.up(e,t,i.positionLineNumber,i.positionColumn,n.leftoverVisibleColumns,1,!1);return new Pn(new P(r.lineNumber,r.column,r.lineNumber,r.column),0,r.leftoverVisibleColumns,new A(s.lineNumber,s.column),s.leftoverVisibleColumns)}static _isBlankLine(e,t){return e.getLineFirstNonWhitespaceColumn(t)===0}static moveToPrevBlankLine(e,t,n,i){let r=n.position.lineNumber;for(;r>1&&this._isBlankLine(t,r);)r--;for(;r>1&&!this._isBlankLine(t,r);)r--;return n.move(i,r,t.getLineMinColumn(r),0)}static moveToNextBlankLine(e,t,n,i){let r=t.getLineCount(),s=n.position.lineNumber;for(;s<r&&this._isBlankLine(t,s);)s++;for(;s<r&&!this._isBlankLine(t,s);)s++;return n.move(i,s,t.getLineMinColumn(s),0)}static moveToBeginningOfLine(e,t,n,i){let r=n.position.lineNumber,s=t.getLineMinColumn(r),a=t.getLineFirstNonWhitespaceColumn(r)||s,l;return n.position.column===a?l=s:l=a,n.move(i,r,l,0)}static moveToEndOfLine(e,t,n,i,r){let s=n.position.lineNumber,a=t.getLineMaxColumn(s);return n.move(i,s,a,r?1073741824-a:0)}static moveToBeginningOfBuffer(e,t,n,i){return n.move(i,1,1,0)}static moveToEndOfBuffer(e,t,n,i){let r=t.getLineCount(),s=t.getLineMaxColumn(r);return n.move(i,r,s,0)}};var $l=class o{static deleteRight(e,t,n,i){let r=[],s=e!==3;for(let a=0,l=i.length;a<l;a++){let d=i[a],c=d;if(c.isEmpty()){let u=d.getPosition(),p=pn.right(t,n,u);c=new P(p.lineNumber,p.column,u.lineNumber,u.column)}if(c.isEmpty()){r[a]=null;continue}c.startLineNumber!==c.endLineNumber&&(s=!0),r[a]=new Oi(c,"")}return[s,r]}static isAutoClosingPairDelete(e,t,n,i,r,s,a){if(t==="never"&&n==="never"||e==="never")return!1;for(let l=0,d=s.length;l<d;l++){let c=s[l],u=c.getPosition();if(!c.isEmpty())return!1;let p=r.getLineContent(u.lineNumber);if(u.column<2||u.column>=p.length+1)return!1;let h=p.charAt(u.column-2),f=i.get(h);if(!f)return!1;if(Bs(h)){if(n==="never")return!1}else if(t==="never")return!1;let g=p.charAt(u.column-1),b=!1;for(let v of f)v.open===h&&v.close===g&&(b=!0);if(!b)return!1;if(e==="auto"){let v=!1;for(let y=0,S=a.length;y<S;y++){let E=a[y];if(u.lineNumber===E.startLineNumber&&u.column===E.startColumn){v=!0;break}}if(!v)return!1}}return!0}static _runAutoClosingPairDelete(e,t,n){let i=[];for(let r=0,s=n.length;r<s;r++){let a=n[r].getPosition(),l=new P(a.lineNumber,a.column-1,a.lineNumber,a.column+1);i[r]=new Oi(l,"")}return[!0,i]}static deleteLeft(e,t,n,i,r){if(this.isAutoClosingPairDelete(t.autoClosingDelete,t.autoClosingBrackets,t.autoClosingQuotes,t.autoClosingPairs.autoClosingPairsOpenByEnd,n,i,r))return this._runAutoClosingPairDelete(t,n,i);let s=[],a=e!==2;for(let l=0,d=i.length;l<d;l++){let c=o.getDeleteRange(i[l],n,t);if(c.isEmpty()){s[l]=null;continue}c.startLineNumber!==c.endLineNumber&&(a=!0),s[l]=new Oi(c,"")}return[a,s]}static getDeleteRange(e,t,n){if(!e.isEmpty())return e;let i=e.getPosition();if(n.useTabStops&&i.column>1){let r=t.getLineContent(i.lineNumber),s=Cn(r),a=s===-1?r.length+1:s+1;if(i.column<=a){let l=n.visibleColumnFromColumn(t,i),d=Vt.prevIndentTabStop(l,n.indentSize),c=n.columnFromVisibleColumn(t,i.lineNumber,d);return new P(i.lineNumber,c,i.lineNumber,i.column)}}return P.fromPositions(o.getPositionAfterDeleteLeft(i,t),i)}static getPositionAfterDeleteLeft(e,t){if(e.column>1){let n=KA(e.column-1,t.getLineContent(e.lineNumber));return e.with(void 0,n+1)}else if(e.lineNumber>1){let n=e.lineNumber-1;return new A(n,t.getLineMaxColumn(n))}else return e}static cut(e,t,n){let i=[],r=null;n.sort((s,a)=>A.compare(s.getStartPosition(),a.getEndPosition()));for(let s=0,a=n.length;s<a;s++){let l=n[s];if(l.isEmpty())if(e.emptySelectionClipboard){let d=l.getPosition(),c,u,p,h;d.lineNumber<t.getLineCount()?(c=d.lineNumber,u=1,p=d.lineNumber+1,h=1):d.lineNumber>1&&r?.endLineNumber!==d.lineNumber?(c=d.lineNumber-1,u=t.getLineMaxColumn(d.lineNumber-1),p=d.lineNumber,h=t.getLineMaxColumn(d.lineNumber)):(c=d.lineNumber,u=1,p=d.lineNumber,h=t.getLineMaxColumn(d.lineNumber));let f=new P(c,u,p,h);r=f,f.isEmpty()?i[s]=null:i[s]=new Oi(f,"")}else i[s]=null;else i[s]=new Oi(l,"")}return new jn(0,i,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}};var Zm=class o{static _createWord(e,t,n,i,r){return{start:i,end:r,wordType:t,nextCharClass:n}}static _createIntlWord(e,t){return{start:e.index,end:e.index+e.segment.length,wordType:1,nextCharClass:t}}static _findPreviousWordOnLine(e,t,n){let i=t.getLineContent(n.lineNumber);return this._doFindPreviousWordOnLine(i,e,n)}static _doFindPreviousWordOnLine(e,t,n){let i=0,r=t.findPrevIntlWordBeforeOrAtOffset(e,n.column-2);for(let s=n.column-2;s>=0;s--){let a=e.charCodeAt(s),l=t.get(a);if(r&&s===r.index)return this._createIntlWord(r,l);if(l===0){if(i===2)return this._createWord(e,i,l,s+1,this._findEndOfWord(e,t,i,s+1));i=1}else if(l===2){if(i===1)return this._createWord(e,i,l,s+1,this._findEndOfWord(e,t,i,s+1));i=2}else if(l===1&&i!==0)return this._createWord(e,i,l,s+1,this._findEndOfWord(e,t,i,s+1))}return i!==0?this._createWord(e,i,1,0,this._findEndOfWord(e,t,i,0)):null}static _findEndOfWord(e,t,n,i){let r=t.findNextIntlWordAtOrAfterOffset(e,i),s=e.length;for(let a=i;a<s;a++){let l=e.charCodeAt(a),d=t.get(l);if(r&&a===r.index+r.segment.length||d===1||n===1&&d===2||n===2&&d===0)return a}return s}static _findNextWordOnLine(e,t,n){let i=t.getLineContent(n.lineNumber);return this._doFindNextWordOnLine(i,e,n)}static _doFindNextWordOnLine(e,t,n){let i=0,r=e.length,s=t.findNextIntlWordAtOrAfterOffset(e,n.column-1);for(let a=n.column-1;a<r;a++){let l=e.charCodeAt(a),d=t.get(l);if(s&&a===s.index)return this._createIntlWord(s,d);if(d===0){if(i===2)return this._createWord(e,i,d,this._findStartOfWord(e,t,i,a-1),a);i=1}else if(d===2){if(i===1)return this._createWord(e,i,d,this._findStartOfWord(e,t,i,a-1),a);i=2}else if(d===1&&i!==0)return this._createWord(e,i,d,this._findStartOfWord(e,t,i,a-1),a)}return i!==0?this._createWord(e,i,1,this._findStartOfWord(e,t,i,r-1),r):null}static _findStartOfWord(e,t,n,i){let r=t.findPrevIntlWordBeforeOrAtOffset(e,i);for(let s=i;s>=0;s--){let a=e.charCodeAt(s),l=t.get(a);if(r&&s===r.index)return s;if(l===1||n===1&&l===2||n===2&&l===0)return s+1}return 0}static moveWordLeft(e,t,n,i,r){let s=n.lineNumber,a=n.column;a===1&&s>1&&(s=s-1,a=t.getLineMaxColumn(s));let l=o._findPreviousWordOnLine(e,t,new A(s,a));if(i===0)return new A(s,l?l.start+1:1);if(i===1)return!r&&l&&l.wordType===2&&l.end-l.start===1&&l.nextCharClass===0&&(l=o._findPreviousWordOnLine(e,t,new A(s,l.start+1))),new A(s,l?l.start+1:1);if(i===3){for(;l&&l.wordType===2;)l=o._findPreviousWordOnLine(e,t,new A(s,l.start+1));return new A(s,l?l.start+1:1)}return l&&a<=l.end+1&&(l=o._findPreviousWordOnLine(e,t,new A(s,l.start+1))),new A(s,l?l.end+1:1)}static _moveWordPartLeft(e,t){let n=t.lineNumber,i=e.getLineMaxColumn(n);if(t.column===1)return n>1?new A(n-1,e.getLineMaxColumn(n-1)):t;let r=e.getLineContent(n);for(let s=t.column-1;s>1;s--){let a=r.charCodeAt(s-2),l=r.charCodeAt(s-1);if(a===95&&l!==95)return new A(n,s);if(a===45&&l!==45)return new A(n,s);if((Zc(a)||hf(a))&&ha(l))return new A(n,s);if(ha(a)&&ha(l)&&s+1<i){let d=r.charCodeAt(s);if(Zc(d)||hf(d))return new A(n,s)}}return new A(n,1)}static moveWordRight(e,t,n,i){let r=n.lineNumber,s=n.column,a=!1;s===t.getLineMaxColumn(r)&&r<t.getLineCount()&&(a=!0,r=r+1,s=1);let l=o._findNextWordOnLine(e,t,new A(r,s));if(i===2)l&&l.wordType===2&&l.end-l.start===1&&l.nextCharClass===0&&(l=o._findNextWordOnLine(e,t,new A(r,l.end+1))),l?s=l.end+1:s=t.getLineMaxColumn(r);else if(i===3){for(a&&(s=0);l&&(l.wordType===2||l.start+1<=s);)l=o._findNextWordOnLine(e,t,new A(r,l.end+1));l?s=l.start+1:s=t.getLineMaxColumn(r)}else l&&!a&&s>=l.start+1&&(l=o._findNextWordOnLine(e,t,new A(r,l.end+1))),l?s=l.start+1:s=t.getLineMaxColumn(r);return new A(r,s)}static _moveWordPartRight(e,t){let n=t.lineNumber,i=e.getLineMaxColumn(n);if(t.column===i)return n<e.getLineCount()?new A(n+1,1):t;let r=e.getLineContent(n);for(let s=t.column+1;s<i;s++){let a=r.charCodeAt(s-2),l=r.charCodeAt(s-1);if(a!==95&&l===95)return new A(n,s);if(a!==45&&l===45)return new A(n,s);if((Zc(a)||hf(a))&&ha(l))return new A(n,s);if(ha(a)&&ha(l)&&s+1<i){let d=r.charCodeAt(s);if(Zc(d)||hf(d))return new A(n,s)}}return new A(n,i)}static _deleteWordLeftWhitespace(e,t){let n=e.getLineContent(t.lineNumber),i=t.column-2,r=Lr(n,i);return r+1<i?new P(t.lineNumber,r+2,t.lineNumber,t.column):null}static deleteWordLeft(e,t){let n=e.wordSeparators,i=e.model,r=e.selection,s=e.whitespaceHeuristics;if(!r.isEmpty())return r;if($l.isAutoClosingPairDelete(e.autoClosingDelete,e.autoClosingBrackets,e.autoClosingQuotes,e.autoClosingPairs.autoClosingPairsOpenByEnd,e.model,[e.selection],e.autoClosedCharacters)){let u=e.selection.getPosition();return new P(u.lineNumber,u.column-1,u.lineNumber,u.column+1)}let a=new A(r.positionLineNumber,r.positionColumn),l=a.lineNumber,d=a.column;if(l===1&&d===1)return null;if(s){let u=this._deleteWordLeftWhitespace(i,a);if(u)return u}let c=o._findPreviousWordOnLine(n,i,a);return t===0?c?d=c.start+1:d>1?d=1:(l--,d=i.getLineMaxColumn(l)):(c&&d<=c.end+1&&(c=o._findPreviousWordOnLine(n,i,new A(l,c.start+1))),c?d=c.end+1:d>1?d=1:(l--,d=i.getLineMaxColumn(l))),new P(l,d,a.lineNumber,a.column)}static deleteInsideWord(e,t,n){if(!n.isEmpty())return n;let i=new A(n.positionLineNumber,n.positionColumn),r=this._deleteInsideWordWhitespace(t,i);return r||this._deleteInsideWordDetermineDeleteRange(e,t,i)}static _charAtIsWhitespace(e,t){let n=e.charCodeAt(t);return n===32||n===9}static _deleteInsideWordWhitespace(e,t){let n=e.getLineContent(t.lineNumber),i=n.length;if(i===0)return null;let r=Math.max(t.column-2,0);if(!this._charAtIsWhitespace(n,r))return null;let s=Math.min(t.column-1,i-1);if(!this._charAtIsWhitespace(n,s))return null;for(;r>0&&this._charAtIsWhitespace(n,r-1);)r--;for(;s+1<i&&this._charAtIsWhitespace(n,s+1);)s++;return new P(t.lineNumber,r+1,t.lineNumber,s+2)}static _deleteInsideWordDetermineDeleteRange(e,t,n){let i=t.getLineContent(n.lineNumber),r=i.length;if(r===0)return n.lineNumber>1?new P(n.lineNumber-1,t.getLineMaxColumn(n.lineNumber-1),n.lineNumber,1):n.lineNumber<t.getLineCount()?new P(n.lineNumber,1,n.lineNumber+1,1):new P(n.lineNumber,1,n.lineNumber,1);let s=u=>u.start+1<=n.column&&n.column<=u.end+1,a=(u,p)=>(u=Math.min(u,n.column),p=Math.max(p,n.column),new P(n.lineNumber,u,n.lineNumber,p)),l=u=>{let p=u.start+1,h=u.end+1,f=!1;for(;h-1<r&&this._charAtIsWhitespace(i,h-1);)f=!0,h++;if(!f)for(;p>1&&this._charAtIsWhitespace(i,p-2);)p--;return a(p,h)},d=o._findPreviousWordOnLine(e,t,n);if(d&&s(d))return l(d);let c=o._findNextWordOnLine(e,t,n);return c&&s(c)?l(c):d&&c?a(d.end+1,c.start+1):d?a(d.start+1,d.end+1):c?a(c.start+1,c.end+1):a(1,r+1)}static _deleteWordPartLeft(e,t){if(!t.isEmpty())return t;let n=t.getPosition(),i=o._moveWordPartLeft(e,n);return new P(n.lineNumber,n.column,i.lineNumber,i.column)}static _findFirstNonWhitespaceChar(e,t){let n=e.length;for(let i=t;i<n;i++){let r=e.charAt(i);if(r!==" "&&r!=="	")return i}return n}static _deleteWordRightWhitespace(e,t){let n=e.getLineContent(t.lineNumber),i=t.column-1,r=this._findFirstNonWhitespaceChar(n,i);return i+1<r?new P(t.lineNumber,t.column,t.lineNumber,r+1):null}static deleteWordRight(e,t){let n=e.wordSeparators,i=e.model,r=e.selection,s=e.whitespaceHeuristics;if(!r.isEmpty())return r;let a=new A(r.positionLineNumber,r.positionColumn),l=a.lineNumber,d=a.column,c=i.getLineCount(),u=i.getLineMaxColumn(l);if(l===c&&d===u)return null;if(s){let h=this._deleteWordRightWhitespace(i,a);if(h)return h}let p=o._findNextWordOnLine(n,i,a);return t===2?p?d=p.end+1:d<u||l===c?d=u:(l++,p=o._findNextWordOnLine(n,i,new A(l,1)),p?d=p.start+1:d=i.getLineMaxColumn(l)):(p&&d>=p.start+1&&(p=o._findNextWordOnLine(n,i,new A(l,p.end+1))),p?d=p.start+1:d<u||l===c?d=u:(l++,p=o._findNextWordOnLine(n,i,new A(l,1)),p?d=p.start+1:d=i.getLineMaxColumn(l))),new P(l,d,a.lineNumber,a.column)}static _deleteWordPartRight(e,t){if(!t.isEmpty())return t;let n=t.getPosition(),i=o._moveWordPartRight(e,n);return new P(n.lineNumber,n.column,i.lineNumber,i.column)}static _createWordAtPosition(e,t,n){let i=new P(t,n.start+1,t,n.end+1);return{word:e.getValueInRange(i),startColumn:i.startColumn,endColumn:i.endColumn}}static getWordAtPosition(e,t,n,i){let r=ya(t,n),s=o._findPreviousWordOnLine(r,e,i);if(s&&s.wordType===1&&s.start<=i.column-1&&i.column-1<=s.end)return o._createWordAtPosition(e,i.lineNumber,s);let a=o._findNextWordOnLine(r,e,i);return a&&a.wordType===1&&a.start<=i.column-1&&i.column-1<=a.end?o._createWordAtPosition(e,i.lineNumber,a):null}static word(e,t,n,i,r){let s=ya(e.wordSeparators,e.wordSegmenterLocales),a=o._findPreviousWordOnLine(s,t,r),l=o._findNextWordOnLine(s,t,r);if(!i){let h,f;return a&&a.wordType===1&&a.start<=r.column-1&&r.column-1<=a.end?(h=a.start+1,f=a.end+1):l&&l.wordType===1&&l.start<=r.column-1&&r.column-1<=l.end?(h=l.start+1,f=l.end+1):(a?h=a.end+1:h=1,l?f=l.start+1:f=t.getLineMaxColumn(r.lineNumber)),new Pn(new P(r.lineNumber,h,r.lineNumber,f),1,0,new A(r.lineNumber,f),0)}let d,c;a&&a.wordType===1&&a.start<r.column-1&&r.column-1<a.end?(d=a.start+1,c=a.end+1):l&&l.wordType===1&&l.start<r.column-1&&r.column-1<l.end?(d=l.start+1,c=l.end+1):(d=r.column,c=r.column);let u=r.lineNumber,p;if(n.selectionStart.containsPosition(r))p=n.selectionStart.endColumn;else if(r.isBeforeOrEqual(n.selectionStart.getStartPosition())){p=d;let h=new A(u,p);n.selectionStart.containsPosition(h)&&(p=n.selectionStart.endColumn)}else{p=c;let h=new A(u,p);n.selectionStart.containsPosition(h)&&(p=n.selectionStart.startColumn)}return n.move(!0,u,p,0)}};var ai=class{static addCursorDown(e,t,n){let i=[],r=0;for(let s=0,a=t.length;s<a;s++){let l=t[s];i[r++]=new Ze(l.modelState,l.viewState),n?i[r++]=Ze.fromModelState(pn.translateDown(e.cursorConfig,e.model,l.modelState)):i[r++]=Ze.fromViewState(pn.translateDown(e.cursorConfig,e,l.viewState))}return i}static addCursorUp(e,t,n){let i=[],r=0;for(let s=0,a=t.length;s<a;s++){let l=t[s];i[r++]=new Ze(l.modelState,l.viewState),n?i[r++]=Ze.fromModelState(pn.translateUp(e.cursorConfig,e.model,l.modelState)):i[r++]=Ze.fromViewState(pn.translateUp(e.cursorConfig,e,l.viewState))}return i}static moveToBeginningOfLine(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r];i[r]=this._moveToLineStart(e,a,n)}return i}static _moveToLineStart(e,t,n){let i=t.viewState.position.column,r=t.modelState.position.column,s=i===r,a=t.viewState.position.lineNumber,l=e.getLineFirstNonWhitespaceColumn(a);return!s&&!(i===l)?this._moveToLineStartByView(e,t,n):this._moveToLineStartByModel(e,t,n)}static _moveToLineStartByView(e,t,n){return Ze.fromViewState(pn.moveToBeginningOfLine(e.cursorConfig,e,t.viewState,n))}static _moveToLineStartByModel(e,t,n){return Ze.fromModelState(pn.moveToBeginningOfLine(e.cursorConfig,e.model,t.modelState,n))}static moveToEndOfLine(e,t,n,i){let r=[];for(let s=0,a=t.length;s<a;s++){let l=t[s];r[s]=this._moveToLineEnd(e,l,n,i)}return r}static _moveToLineEnd(e,t,n,i){let r=t.viewState.position,s=e.getLineMaxColumn(r.lineNumber),a=r.column===s,l=t.modelState.position,d=e.model.getLineMaxColumn(l.lineNumber),c=s-r.column===d-l.column;return a||c?this._moveToLineEndByModel(e,t,n,i):this._moveToLineEndByView(e,t,n,i)}static _moveToLineEndByView(e,t,n,i){return Ze.fromViewState(pn.moveToEndOfLine(e.cursorConfig,e,t.viewState,n,i))}static _moveToLineEndByModel(e,t,n,i){return Ze.fromModelState(pn.moveToEndOfLine(e.cursorConfig,e.model,t.modelState,n,i))}static expandLineSelection(e,t){let n=[];for(let i=0,r=t.length;i<r;i++){let s=t[i],a=s.modelState.selection.startLineNumber,l=e.model.getLineCount(),d=s.modelState.selection.endLineNumber,c;d===l?c=e.model.getLineMaxColumn(l):(d++,c=1),n[i]=Ze.fromModelState(new Pn(new P(a,1,a,1),0,0,new A(d,c),0))}return n}static moveToBeginningOfBuffer(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r];i[r]=Ze.fromModelState(pn.moveToBeginningOfBuffer(e.cursorConfig,e.model,a.modelState,n))}return i}static moveToEndOfBuffer(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r];i[r]=Ze.fromModelState(pn.moveToEndOfBuffer(e.cursorConfig,e.model,a.modelState,n))}return i}static selectAll(e,t){let n=e.model.getLineCount(),i=e.model.getLineMaxColumn(n);return Ze.fromModelState(new Pn(new P(1,1,1,1),0,0,new A(n,i),0))}static line(e,t,n,i,r){let s=e.model.validatePosition(i),a=r?e.coordinatesConverter.validateViewPosition(new A(r.lineNumber,r.column),s):e.coordinatesConverter.convertModelPositionToViewPosition(s);if(!n){let d=e.model.getLineCount(),c=s.lineNumber+1,u=1;return c>d&&(c=d,u=e.model.getLineMaxColumn(c)),Ze.fromModelState(new Pn(new P(s.lineNumber,1,c,u),2,0,new A(c,u),0))}let l=t.modelState.selectionStart.getStartPosition().lineNumber;if(s.lineNumber<l)return Ze.fromViewState(t.viewState.move(!0,a.lineNumber,1,0));if(s.lineNumber>l){let d=e.getLineCount(),c=a.lineNumber+1,u=1;return c>d&&(c=d,u=e.getLineMaxColumn(c)),Ze.fromViewState(t.viewState.move(!0,c,u,0))}else{let d=t.modelState.selectionStart.getEndPosition();return Ze.fromModelState(t.modelState.move(!0,d.lineNumber,d.column,0))}}static word(e,t,n,i){let r=e.model.validatePosition(i);return Ze.fromModelState(Zm.word(e.cursorConfig,e.model,t.modelState,n,r))}static cancelSelection(e,t){if(!t.modelState.hasSelection())return new Ze(t.modelState,t.viewState);let n=t.viewState.position.lineNumber,i=t.viewState.position.column;return Ze.fromViewState(new Pn(new P(n,i,n,i),0,0,new A(n,i),0))}static moveTo(e,t,n,i,r){if(n){if(t.modelState.selectionStartKind===1)return this.word(e,t,n,i);if(t.modelState.selectionStartKind===2)return this.line(e,t,n,i,r)}let s=e.model.validatePosition(i),a=r?e.coordinatesConverter.validateViewPosition(new A(r.lineNumber,r.column),s):e.coordinatesConverter.convertModelPositionToViewPosition(s);return Ze.fromViewState(t.viewState.move(n,a.lineNumber,a.column,0))}static simpleMove(e,t,n,i,r,s){switch(n){case Ue.Direction.Left:return s===Ue.Unit.HalfLine?this._moveHalfLineLeft(e,t,i):this._moveLeft(e,t,i,r);case Ue.Direction.Right:return s===Ue.Unit.HalfLine?this._moveHalfLineRight(e,t,i):this._moveRight(e,t,i,r);case Ue.Direction.Up:return s===Ue.Unit.WrappedLine?this._moveUpByViewLines(e,t,i,r):this._moveUpByModelLines(e,t,i,r);case Ue.Direction.Down:return s===Ue.Unit.WrappedLine?this._moveDownByViewLines(e,t,i,r):this._moveDownByModelLines(e,t,i,r);case Ue.Direction.PrevBlankLine:return s===Ue.Unit.WrappedLine?t.map(a=>Ze.fromViewState(pn.moveToPrevBlankLine(e.cursorConfig,e,a.viewState,i))):t.map(a=>Ze.fromModelState(pn.moveToPrevBlankLine(e.cursorConfig,e.model,a.modelState,i)));case Ue.Direction.NextBlankLine:return s===Ue.Unit.WrappedLine?t.map(a=>Ze.fromViewState(pn.moveToNextBlankLine(e.cursorConfig,e,a.viewState,i))):t.map(a=>Ze.fromModelState(pn.moveToNextBlankLine(e.cursorConfig,e.model,a.modelState,i)));case Ue.Direction.WrappedLineStart:return this._moveToViewMinColumn(e,t,i);case Ue.Direction.WrappedLineFirstNonWhitespaceCharacter:return this._moveToViewFirstNonWhitespaceColumn(e,t,i);case Ue.Direction.WrappedLineColumnCenter:return this._moveToViewCenterColumn(e,t,i);case Ue.Direction.WrappedLineEnd:return this._moveToViewMaxColumn(e,t,i);case Ue.Direction.WrappedLineLastNonWhitespaceCharacter:return this._moveToViewLastNonWhitespaceColumn(e,t,i);default:return null}}static viewportMove(e,t,n,i,r){let s=e.getCompletelyVisibleViewRange(),a=e.coordinatesConverter.convertViewRangeToModelRange(s);switch(n){case Ue.Direction.ViewPortTop:{let l=this._firstLineNumberInRange(e.model,a,r),d=e.model.getLineFirstNonWhitespaceColumn(l);return[this._moveToModelPosition(e,t[0],i,l,d)]}case Ue.Direction.ViewPortBottom:{let l=this._lastLineNumberInRange(e.model,a,r),d=e.model.getLineFirstNonWhitespaceColumn(l);return[this._moveToModelPosition(e,t[0],i,l,d)]}case Ue.Direction.ViewPortCenter:{let l=Math.round((a.startLineNumber+a.endLineNumber)/2),d=e.model.getLineFirstNonWhitespaceColumn(l);return[this._moveToModelPosition(e,t[0],i,l,d)]}case Ue.Direction.ViewPortIfOutside:{let l=[];for(let d=0,c=t.length;d<c;d++){let u=t[d];l[d]=this.findPositionInViewportIfOutside(e,u,s,i)}return l}default:return null}}static findPositionInViewportIfOutside(e,t,n,i){let r=t.viewState.position.lineNumber;if(n.startLineNumber<=r&&r<=n.endLineNumber-1)return new Ze(t.modelState,t.viewState);{let s;r>n.endLineNumber-1?s=n.endLineNumber-1:r<n.startLineNumber?s=n.startLineNumber:s=r;let a=pn.vertical(e.cursorConfig,e,r,t.viewState.position.column,t.viewState.leftoverVisibleColumns,s,!1);return Ze.fromViewState(t.viewState.move(i,a.lineNumber,a.column,a.leftoverVisibleColumns))}}static _firstLineNumberInRange(e,t,n){let i=t.startLineNumber;return t.startColumn!==e.getLineMinColumn(i)&&i++,Math.min(t.endLineNumber,i+n-1)}static _lastLineNumberInRange(e,t,n){let i=t.startLineNumber;return t.startColumn!==e.getLineMinColumn(i)&&i++,Math.max(i,t.endLineNumber-n+1)}static _moveLeft(e,t,n,i){return t.map(r=>Ze.fromViewState(pn.moveLeft(e.cursorConfig,e,r.viewState,n,i)))}static _moveHalfLineLeft(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r],l=a.viewState.position.lineNumber,d=Math.round(e.getLineLength(l)/2);i[r]=Ze.fromViewState(pn.moveLeft(e.cursorConfig,e,a.viewState,n,d))}return i}static _moveRight(e,t,n,i){return t.map(r=>Ze.fromViewState(pn.moveRight(e.cursorConfig,e,r.viewState,n,i)))}static _moveHalfLineRight(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r],l=a.viewState.position.lineNumber,d=Math.round(e.getLineLength(l)/2);i[r]=Ze.fromViewState(pn.moveRight(e.cursorConfig,e,a.viewState,n,d))}return i}static _moveDownByViewLines(e,t,n,i){let r=[];for(let s=0,a=t.length;s<a;s++){let l=t[s];r[s]=Ze.fromViewState(pn.moveDown(e.cursorConfig,e,l.viewState,n,i))}return r}static _moveDownByModelLines(e,t,n,i){let r=[];for(let s=0,a=t.length;s<a;s++){let l=t[s];r[s]=Ze.fromModelState(pn.moveDown(e.cursorConfig,e.model,l.modelState,n,i))}return r}static _moveUpByViewLines(e,t,n,i){let r=[];for(let s=0,a=t.length;s<a;s++){let l=t[s];r[s]=Ze.fromViewState(pn.moveUp(e.cursorConfig,e,l.viewState,n,i))}return r}static _moveUpByModelLines(e,t,n,i){let r=[];for(let s=0,a=t.length;s<a;s++){let l=t[s];r[s]=Ze.fromModelState(pn.moveUp(e.cursorConfig,e.model,l.modelState,n,i))}return r}static _moveToViewPosition(e,t,n,i,r){return Ze.fromViewState(t.viewState.move(n,i,r,0))}static _moveToModelPosition(e,t,n,i,r){return Ze.fromModelState(t.modelState.move(n,i,r,0))}static _moveToViewMinColumn(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r],l=a.viewState.position.lineNumber,d=e.getLineMinColumn(l);i[r]=this._moveToViewPosition(e,a,n,l,d)}return i}static _moveToViewFirstNonWhitespaceColumn(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r],l=a.viewState.position.lineNumber,d=e.getLineFirstNonWhitespaceColumn(l);i[r]=this._moveToViewPosition(e,a,n,l,d)}return i}static _moveToViewCenterColumn(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r],l=a.viewState.position.lineNumber,d=Math.round((e.getLineMaxColumn(l)+e.getLineMinColumn(l))/2);i[r]=this._moveToViewPosition(e,a,n,l,d)}return i}static _moveToViewMaxColumn(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r],l=a.viewState.position.lineNumber,d=e.getLineMaxColumn(l);i[r]=this._moveToViewPosition(e,a,n,l,d)}return i}static _moveToViewLastNonWhitespaceColumn(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r],l=a.viewState.position.lineNumber,d=e.getLineLastNonWhitespaceColumn(l);i[r]=this._moveToViewPosition(e,a,n,l,d)}return i}},Ue;(a=>{let o=function(l){if(!an(l))return!1;let d=l;return!(!In(d.to)||!Kn(d.select)&&!nI(d.select)||!Kn(d.by)&&!In(d.by)||!Kn(d.value)&&!Gi(d.value))};a.metadata={description:"Move cursor to a logical position in the view",args:[{name:"Cursor move argument object",description:`Property-value pairs that can be passed through this argument:
					* 'to': A mandatory logical position value providing where to move the cursor.
						\`\`\`
						'left', 'right', 'up', 'down', 'prevBlankLine', 'nextBlankLine',
						'wrappedLineStart', 'wrappedLineEnd', 'wrappedLineColumnCenter'
						'wrappedLineFirstNonWhitespaceCharacter', 'wrappedLineLastNonWhitespaceCharacter'
						'viewPortTop', 'viewPortCenter', 'viewPortBottom', 'viewPortIfOutside'
						\`\`\`
					* 'by': Unit to move. Default is computed based on 'to' value.
						\`\`\`
						'line', 'wrappedLine', 'character', 'halfLine'
						\`\`\`
					* 'value': Number of units to move. Default is '1'.
					* 'select': If 'true' makes the selection. Default is 'false'.
				`,constraint:o,schema:{type:"object",required:["to"],properties:{to:{type:"string",enum:["left","right","up","down","prevBlankLine","nextBlankLine","wrappedLineStart","wrappedLineEnd","wrappedLineColumnCenter","wrappedLineFirstNonWhitespaceCharacter","wrappedLineLastNonWhitespaceCharacter","viewPortTop","viewPortCenter","viewPortBottom","viewPortIfOutside"]},by:{type:"string",enum:["line","wrappedLine","character","halfLine"]},value:{type:"number",default:1},select:{type:"boolean",default:!1}}}}]},a.RawDirection={Left:"left",Right:"right",Up:"up",Down:"down",PrevBlankLine:"prevBlankLine",NextBlankLine:"nextBlankLine",WrappedLineStart:"wrappedLineStart",WrappedLineFirstNonWhitespaceCharacter:"wrappedLineFirstNonWhitespaceCharacter",WrappedLineColumnCenter:"wrappedLineColumnCenter",WrappedLineEnd:"wrappedLineEnd",WrappedLineLastNonWhitespaceCharacter:"wrappedLineLastNonWhitespaceCharacter",ViewPortTop:"viewPortTop",ViewPortCenter:"viewPortCenter",ViewPortBottom:"viewPortBottom",ViewPortIfOutside:"viewPortIfOutside"},a.RawUnit={Line:"line",WrappedLine:"wrappedLine",Character:"character",HalfLine:"halfLine"};function i(l){if(!l.to)return null;let d;switch(l.to){case a.RawDirection.Left:d=0;break;case a.RawDirection.Right:d=1;break;case a.RawDirection.Up:d=2;break;case a.RawDirection.Down:d=3;break;case a.RawDirection.PrevBlankLine:d=4;break;case a.RawDirection.NextBlankLine:d=5;break;case a.RawDirection.WrappedLineStart:d=6;break;case a.RawDirection.WrappedLineFirstNonWhitespaceCharacter:d=7;break;case a.RawDirection.WrappedLineColumnCenter:d=8;break;case a.RawDirection.WrappedLineEnd:d=9;break;case a.RawDirection.WrappedLineLastNonWhitespaceCharacter:d=10;break;case a.RawDirection.ViewPortTop:d=11;break;case a.RawDirection.ViewPortBottom:d=13;break;case a.RawDirection.ViewPortCenter:d=12;break;case a.RawDirection.ViewPortIfOutside:d=14;break;default:return null}let c=0;switch(l.by){case a.RawUnit.Line:c=1;break;case a.RawUnit.WrappedLine:c=2;break;case a.RawUnit.Character:c=3;break;case a.RawUnit.HalfLine:c=4;break}return{direction:d,unit:c,select:!!l.select,value:l.value||1}}a.parse=i;let r;(_=>(_[_.Left=0]="Left",_[_.Right=1]="Right",_[_.Up=2]="Up",_[_.Down=3]="Down",_[_.PrevBlankLine=4]="PrevBlankLine",_[_.NextBlankLine=5]="NextBlankLine",_[_.WrappedLineStart=6]="WrappedLineStart",_[_.WrappedLineFirstNonWhitespaceCharacter=7]="WrappedLineFirstNonWhitespaceCharacter",_[_.WrappedLineColumnCenter=8]="WrappedLineColumnCenter",_[_.WrappedLineEnd=9]="WrappedLineEnd",_[_.WrappedLineLastNonWhitespaceCharacter=10]="WrappedLineLastNonWhitespaceCharacter",_[_.ViewPortTop=11]="ViewPortTop",_[_.ViewPortCenter=12]="ViewPortCenter",_[_.ViewPortBottom=13]="ViewPortBottom",_[_.ViewPortIfOutside=14]="ViewPortIfOutside"))(r=a.Direction||={});let s;(h=>(h[h.None=0]="None",h[h.Line=1]="Line",h[h.WrappedLine=2]="WrappedLine",h[h.Character=3]="Character",h[h.HalfLine=4]="HalfLine"))(s=a.Unit||={})})(Ue||={});function Tj(o,e,t){let n=o.tokenization.getLanguageIdAtPosition(e,0);if(e>1){let i,r=-1;for(i=e-1;i>=1;i--){if(o.tokenization.getLanguageIdAtPosition(i,0)!==n)return r;let s=o.getLineContent(i);if(t.shouldIgnore(i)||/^\s+$/.test(s)||s===""){r=i;continue}return i}}return-1}function jv(o,e,t,n=!0,i){if(o<4)return null;let r=i.getLanguageConfiguration(e.tokenization.getLanguageId()).indentRulesSupport;if(!r)return null;let s=new $x(e,r,i);if(t<=1)return{indentation:"",action:null};for(let l=t-1;l>0&&e.getLineContent(l)==="";l--)if(l===1)return{indentation:"",action:null};let a=Tj(e,t,s);if(a<0)return null;if(a<1)return{indentation:"",action:null};if(s.shouldIncrease(a)||s.shouldIndentNextLine(a)){let l=e.getLineContent(a);return{indentation:Jn(l),action:1,line:a}}else if(s.shouldDecrease(a)){let l=e.getLineContent(a);return{indentation:Jn(l),action:null,line:a}}else{if(a===1)return{indentation:Jn(e.getLineContent(a)),action:null,line:a};let l=a-1,d=r.getIndentMetadata(e.getLineContent(l));if(!(d&3)&&d&4){let c=0;for(let u=l-1;u>0;u--)if(!s.shouldIndentNextLine(u)){c=u;break}return{indentation:Jn(e.getLineContent(c+1)),action:null,line:c+1}}if(n)return{indentation:Jn(e.getLineContent(a)),action:null,line:a};for(let c=a;c>0;c--){if(s.shouldIncrease(c))return{indentation:Jn(e.getLineContent(c)),action:1,line:c};if(s.shouldIndentNextLine(c)){let u=0;for(let p=c-1;p>0;p--)if(!s.shouldIndentNextLine(c)){u=p;break}return{indentation:Jn(e.getLineContent(u+1)),action:null,line:u+1}}else if(s.shouldDecrease(c))return{indentation:Jn(e.getLineContent(c)),action:null,line:c}}return{indentation:Jn(e.getLineContent(1)),action:null,line:1}}}function H4(o,e,t,n,i){if(o<4)return null;let r=e.getLanguageIdAtPosition(t.startLineNumber,t.startColumn),s=i.getLanguageConfiguration(r).indentRulesSupport;if(!s)return null;e.tokenization.forceTokenization(t.startLineNumber);let l=new cp(e,i).getProcessedTokenContextAroundRange(t),d=l.afterRangeProcessedTokens,c=l.beforeRangeProcessedTokens,u=Jn(c.getLineContent()),p=xj(e,t.startLineNumber,c),h=Yx(e,t.getStartPosition()),f=e.getLineContent(t.startLineNumber),g=Jn(f),b=jv(o,p,t.startLineNumber+1,void 0,i);if(!b){let y=h?g:u;return{beforeEnter:y,afterEnter:y}}let v=h?g:b.indentation;return b.action===1&&(v=n.shiftIndent(v)),s.shouldDecrease(d.getLineContent())&&(v=n.unshiftIndent(v)),{beforeEnter:h?g:u,afterEnter:v}}function U4(o,e,t,n,i,r){let s=o.autoIndent;if(s<4||Yx(e,t.getStartPosition()))return null;let l=e.getLanguageIdAtPosition(t.startLineNumber,t.startColumn),d=r.getLanguageConfiguration(l).indentRulesSupport;if(!d)return null;let u=new cp(e,r).getProcessedTokenContextAroundRange(t),p=u.beforeRangeProcessedTokens.getLineContent(),h=u.afterRangeProcessedTokens.getLineContent(),f=p+h,g=p+n+h;if(!d.shouldDecrease(f)&&d.shouldDecrease(g)){let v=jv(s,e,t.startLineNumber,!1,r);if(!v)return null;let y=v.indentation;return v.action!==1&&(y=i.unshiftIndent(y)),y}let b=t.startLineNumber-1;if(b>0){let v=e.getLineContent(b);if(d.shouldIndentNextLine(v)&&d.shouldIncrease(g)){let S=jv(s,e,t.startLineNumber,!1,r)?.indentation;if(S!==void 0){let E=e.getLineContent(t.startLineNumber),C=Jn(E),_=i.shiftIndent(S)===C,L=/^\s*$/.test(f),k=o.autoClosingPairs.autoClosingPairsOpenByEnd.get(n),K=k&&k.length>0&&L;if(_&&K)return S}}}return null}function xj(o,e,t){return{tokenization:{getLineTokens:i=>i===e?t:o.tokenization.getLineTokens(i),getLanguageId:()=>o.getLanguageId(),getLanguageIdAtPosition:(i,r)=>o.getLanguageIdAtPosition(i,r)},getLineContent:i=>i===e?t.getLineContent():o.getLineContent(i)}}var $x=class{_indentRulesSupport;_indentationLineProcessor;constructor(e,t,n){this._indentRulesSupport=t,this._indentationLineProcessor=new Zx(e,n)}shouldIncrease(e,t){let n=this._indentationLineProcessor.getProcessedLine(e,t);return this._indentRulesSupport.shouldIncrease(n)}shouldDecrease(e,t){let n=this._indentationLineProcessor.getProcessedLine(e,t);return this._indentRulesSupport.shouldDecrease(n)}shouldIgnore(e,t){let n=this._indentationLineProcessor.getProcessedLine(e,t);return this._indentRulesSupport.shouldIgnore(n)}shouldIndentNextLine(e,t){let n=this._indentationLineProcessor.getProcessedLine(e,t);return this._indentRulesSupport.shouldIndentNextLine(n)}},cp=class{model;indentationLineProcessor;constructor(e,t){this.model=e,this.indentationLineProcessor=new Zx(e,t)}getProcessedTokenContextAroundRange(e){let t=this._getProcessedTokensBeforeRange(e),n=this._getProcessedTokensAfterRange(e),i=this._getProcessedPreviousLineTokens(e);return{beforeRangeProcessedTokens:t,afterRangeProcessedTokens:n,previousLineProcessedTokens:i}}_getProcessedTokensBeforeRange(e){this.model.tokenization.forceTokenization(e.startLineNumber);let t=this.model.tokenization.getLineTokens(e.startLineNumber),n=Ia(t,e.startColumn-1),i;if(Yx(this.model,e.getStartPosition())){let s=e.startColumn-1-n.firstCharOffset,a=n.firstCharOffset,l=a+s;i=t.sliceAndInflate(a,l,0)}else{let s=e.startColumn-1;i=t.sliceAndInflate(0,s,0)}return this.indentationLineProcessor.getProcessedTokens(i)}_getProcessedTokensAfterRange(e){let t=e.isEmpty()?e.getStartPosition():e.getEndPosition();this.model.tokenization.forceTokenization(t.lineNumber);let n=this.model.tokenization.getLineTokens(t.lineNumber),i=Ia(n,t.column-1),r=t.column-1-i.firstCharOffset,s=i.firstCharOffset+r,a=i.firstCharOffset+i.getLineLength(),l=n.sliceAndInflate(s,a,0);return this.indentationLineProcessor.getProcessedTokens(l)}_getProcessedPreviousLineTokens(e){let t=h=>{this.model.tokenization.forceTokenization(h);let f=this.model.tokenization.getLineTokens(h),g=this.model.getLineMaxColumn(h)-1;return Ia(f,g)};this.model.tokenization.forceTokenization(e.startLineNumber);let n=this.model.tokenization.getLineTokens(e.startLineNumber),i=Ia(n,e.startColumn-1),r=Sn.createEmpty("",i.languageIdCodec),s=e.startLineNumber-1;if(s===0||!(i.firstCharOffset===0))return r;let d=t(s);if(!(i.languageId===d.languageId))return r;let u=d.toIViewLineTokens();return this.indentationLineProcessor.getProcessedTokens(u)}},Zx=class{constructor(e,t){this.model=e;this.languageConfigurationService=t}getProcessedLine(e,t){let n=(s,a)=>{let l=Jn(s);return a+s.substring(l.length)};this.model.tokenization.forceTokenization?.(e);let i=this.model.tokenization.getLineTokens(e),r=this.getProcessedTokens(i).getLineContent();return t!==void 0&&(r=n(r,t)),r}getProcessedTokens(e){let t=l=>l===2||l===3||l===1,n=e.getLanguageId(0),r=this.languageConfigurationService.getLanguageConfiguration(n).bracketsNew.getBracketRegExp({global:!0}),s=[];return e.forEach(l=>{let d=e.getStandardTokenType(l),c=e.getTokenText(l);t(d)&&(c=c.replace(r,""));let u=e.getMetadata(l);s.push({text:c,metadata:u})}),Sn.createFromTextAndMetadata(s,e.languageIdCodec)}};function Yx(o,e){o.tokenization.forceTokenization(e.lineNumber);let t=o.tokenization.getLineTokens(e.lineNumber),n=Ia(t,e.column-1),i=n.firstCharOffset===0,r=t.getLanguageId(0)===n.languageId;return!i&&!r}function qv(o,e,t,n){e.tokenization.forceTokenization(t.startLineNumber);let i=e.getLanguageIdAtPosition(t.startLineNumber,t.startColumn),r=n.getLanguageConfiguration(i);if(!r)return null;let a=new cp(e,n).getProcessedTokenContextAroundRange(t),l=a.previousLineProcessedTokens.getLineContent(),d=a.beforeRangeProcessedTokens.getLineContent(),c=a.afterRangeProcessedTokens.getLineContent(),u=r.onEnter(o,l,d,c);if(!u)return null;let p=u.indentAction,h=u.appendText,f=u.removeText||0;h?p===1&&(h="	"+h):p===1||p===2?h="	":h="";let g=EC(e,t.startLineNumber,t.startColumn);return f&&(g=g.substring(0,g.length-f)),{indentAction:p,appendText:h,removeText:f,indentation:g}}var YP=Object.create(null);function up(o,e){if(e<=0)return"";YP[o]||(YP[o]=["",o]);let t=YP[o];for(let n=t.length;n<=e;n++)t[n]=t[n-1]+o;return t[e]}var vr=class{constructor(e,t,n){this._languageConfigurationService=n;this._opts=t,this._selection=e,this._selectionId=null,this._useLastEditRangeForCursorEndPosition=!1,this._selectionStartColumnStaysPut=!1}static unshiftIndent(e,t,n,i,r){let s=Vt.visibleColumnFromColumn(e,t,n);if(r){let a=up(" ",i),d=Vt.prevIndentTabStop(s,i)/i;return up(a,d)}else{let a="	",d=Vt.prevRenderTabStop(s,n)/n;return up(a,d)}}static shiftIndent(e,t,n,i,r){let s=Vt.visibleColumnFromColumn(e,t,n);if(r){let a=up(" ",i),d=Vt.nextIndentTabStop(s,i)/i;return up(a,d)}else{let a="	",d=Vt.nextRenderTabStop(s,n)/n;return up(a,d)}}_opts;_selection;_selectionId;_useLastEditRangeForCursorEndPosition;_selectionStartColumnStaysPut;_addEditOperation(e,t,n){this._useLastEditRangeForCursorEndPosition?e.addTrackedEditOperation(t,n):e.addEditOperation(t,n)}getEditOperations(e,t){let n=this._selection.startLineNumber,i=this._selection.endLineNumber;this._selection.endColumn===1&&n!==i&&(i=i-1);let{tabSize:r,indentSize:s,insertSpaces:a}=this._opts,l=n===i;if(this._opts.useTabStops){this._selection.isEmpty()&&/^\s*$/.test(e.getLineContent(n))&&(this._useLastEditRangeForCursorEndPosition=!0);let d=0,c=0;for(let u=n;u<=i;u++,d=c){c=0;let p=e.getLineContent(u),h=Cn(p);if(this._opts.isUnshift&&(p.length===0||h===0)||!l&&!this._opts.isUnshift&&p.length===0)continue;if(h===-1&&(h=p.length),u>1&&Vt.visibleColumnFromColumn(p,h+1,r)%s!==0&&e.tokenization.isCheapToTokenize(u-1)){let b=qv(this._opts.autoIndent,e,new P(u-1,e.getLineMaxColumn(u-1),u-1,e.getLineMaxColumn(u-1)),this._languageConfigurationService);if(b){if(c=d,b.appendText)for(let v=0,y=b.appendText.length;v<y&&c<s&&b.appendText.charCodeAt(v)===32;v++)c++;b.removeText&&(c=Math.max(0,c-b.removeText));for(let v=0;v<c&&!(h===0||p.charCodeAt(h-1)!==32);v++)h--}}if(this._opts.isUnshift&&h===0)continue;let f;this._opts.isUnshift?f=vr.unshiftIndent(p,h+1,r,s,a):f=vr.shiftIndent(p,h+1,r,s,a),this._addEditOperation(t,new P(u,1,u,h+1),f),u===n&&!this._selection.isEmpty()&&(this._selectionStartColumnStaysPut=this._selection.startColumn<=h+1)}}else{!this._opts.isUnshift&&this._selection.isEmpty()&&e.getLineLength(n)===0&&(this._useLastEditRangeForCursorEndPosition=!0);let d=a?up(" ",s):"	";for(let c=n;c<=i;c++){let u=e.getLineContent(c),p=Cn(u);if(!(this._opts.isUnshift&&(u.length===0||p===0))&&!(!l&&!this._opts.isUnshift&&u.length===0)&&(p===-1&&(p=u.length),!(this._opts.isUnshift&&p===0)))if(this._opts.isUnshift){p=Math.min(p,s);for(let h=0;h<p;h++)if(u.charCodeAt(h)===9){p=h+1;break}this._addEditOperation(t,new P(c,1,c,p+1),"")}else this._addEditOperation(t,new P(c,1,c,1),d),c===n&&!this._selection.isEmpty()&&(this._selectionStartColumnStaysPut=this._selection.startColumn===1)}}this._selectionId=t.trackSelection(this._selection)}computeCursorState(e,t){if(this._useLastEditRangeForCursorEndPosition){let i=t.getInverseEditOperations()[0];return new $e(i.range.endLineNumber,i.range.endColumn,i.range.endLineNumber,i.range.endColumn)}let n=t.getTrackedSelection(this._selectionId);if(this._selectionStartColumnStaysPut){let i=this._selection.startColumn;return n.startColumn<=i?n:n.getDirection()===0?new $e(n.startLineNumber,i,n.endLineNumber,n.endColumn):new $e(n.endLineNumber,n.endColumn,n.startLineNumber,i)}return n}};vr=O([x(2,xl)],vr);var Xx=class{_range;_charBeforeSelection;_charAfterSelection;constructor(e,t,n){this._range=e,this._charBeforeSelection=t,this._charAfterSelection=n}getEditOperations(e,t){t.addTrackedEditOperation(new P(this._range.startLineNumber,this._range.startColumn,this._range.startLineNumber,this._range.startColumn),this._charBeforeSelection),t.addTrackedEditOperation(new P(this._range.endLineNumber,this._range.endColumn,this._range.endLineNumber,this._range.endColumn),this._charAfterSelection)}computeCursorState(e,t){let n=t.getInverseEditOperations(),i=n[0].range,r=n[1].range;return new $e(i.endLineNumber,i.endColumn,r.endLineNumber,r.endColumn-this._charAfterSelection.length)}},Qx=class{constructor(e,t,n){this._position=e;this._text=t;this._charAfter=n}getEditOperations(e,t){t.addTrackedEditOperation(new P(this._position.lineNumber,this._position.column,this._position.lineNumber,this._position.column),this._text+this._charAfter)}computeCursorState(e,t){let i=t.getInverseEditOperations()[0].range;return new $e(i.endLineNumber,i.startColumn,i.endLineNumber,i.endColumn-this._charAfter.length)}};var Jx=class{static getEdits(e,t,n,i,r){if(!r&&this._isAutoIndentType(e,t,n)){let s=[];for(let l of n){let d=this._findActualIndentationForSelection(e,t,l,i);if(d===null)return;s.push({selection:l,indentation:d})}let a=Xm.getAutoClosingPairClose(e,t,n,i,!1);return this._getIndentationAndAutoClosingPairEdits(e,t,s,i,a)}}static _isAutoIndentType(e,t,n){if(e.autoIndent<4)return!1;for(let i=0,r=n.length;i<r;i++)if(!t.tokenization.isCheapToTokenize(n[i].getEndPosition().lineNumber))return!1;return!0}static _findActualIndentationForSelection(e,t,n,i){let r=U4(e,t,n,i,{shiftIndent:a=>$v(e,a),unshiftIndent:a=>eg(e,a)},e.languageConfigurationService);if(r===null)return null;let s=EC(t,n.startLineNumber,n.startColumn);return r===e.normalizeIndentation(s)?null:r}static _getIndentationAndAutoClosingPairEdits(e,t,n,i,r){let s=n.map(({selection:l,indentation:d})=>{if(r!==null){let c=this._getEditFromIndentationAndSelection(e,t,d,l,i,!1);return new XP(c,l,i,r)}else{let c=this._getEditFromIndentationAndSelection(e,t,d,l,i,!0);return pp(c.range,c.text,!1)}}),a={shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1};return new jn(4,s,a)}static _getEditFromIndentationAndSelection(e,t,n,i,r,s=!0){let a=i.startLineNumber,l=t.getLineFirstNonWhitespaceColumn(a),d=e.normalizeIndentation(n);if(l!==0){let u=t.getLineContent(a);d+=u.substring(l-1,i.startColumn-1)}return d+=s?r:"",{range:new P(a,1,i.endLineNumber,i.endColumn),text:d}}},ew=class{static getEdits(e,t,n,i,r,s){if(G4(t,n,i,r,s))return this._runAutoClosingOvertype(e,i,s)}static _runAutoClosingOvertype(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let l=t[r].getPosition(),d=new P(l.lineNumber,l.column,l.lineNumber,l.column+1);i[r]=new Oi(d,n)}return new jn(4,i,{shouldPushStackElementBefore:dw(e,4),shouldPushStackElementAfter:!1})}},tw=class{static getEdits(e,t,n,i,r){if(G4(e,t,n,i,r)){let s=n.map(a=>new Oi(new P(a.positionLineNumber,a.positionColumn,a.positionLineNumber,a.positionColumn+1),"",!1));return new jn(4,s,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}}},Xm=class{static getEdits(e,t,n,i,r,s){if(!s){let a=this.getAutoClosingPairClose(e,t,n,i,r);if(a!==null)return this._runAutoClosingOpenCharType(n,i,r,a)}}static _runAutoClosingOpenCharType(e,t,n,i){let r=[];for(let s=0,a=e.length;s<a;s++){let l=e[s];r[s]=new ZP(l,t,!n,i)}return new jn(4,r,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}static getAutoClosingPairClose(e,t,n,i,r){for(let f of n)if(!f.isEmpty())return null;let s=n.map(f=>{let g=f.getPosition();return r?{lineNumber:g.lineNumber,beforeColumn:g.column-i.length,afterColumn:g.column}:{lineNumber:g.lineNumber,beforeColumn:g.column,afterColumn:g.column}}),a=this._findAutoClosingPairOpen(e,t,s.map(f=>new A(f.lineNumber,f.beforeColumn)),i);if(!a)return null;let l,d;if(Bs(i)?(l=e.autoClosingQuotes,d=e.shouldAutoCloseBefore.quote):(e.blockCommentStartToken?a.open.includes(e.blockCommentStartToken):!1)?(l=e.autoClosingComments,d=e.shouldAutoCloseBefore.comment):(l=e.autoClosingBrackets,d=e.shouldAutoCloseBefore.bracket),l==="never")return null;let u=this._findContainedAutoClosingPair(e,a),p=u?u.close:"",h=!0;for(let f of s){let{lineNumber:g,beforeColumn:b,afterColumn:v}=f,y=t.getLineContent(g),S=y.substring(0,b-1),E=y.substring(v-1);if(E.startsWith(p)||(h=!1),E.length>0){let L=E.charAt(0);if(!this._isBeforeClosingBrace(e,E)&&!d(L))return null}if(a.open.length===1&&(i==="'"||i==='"')&&l!=="always"){let L=ya(e.wordSeparators,[]);if(S.length>0){let k=S.charCodeAt(S.length-1);if(L.get(k)===0)return null}}if(!t.tokenization.isCheapToTokenize(g))return null;t.tokenization.forceTokenization(g);let C=t.tokenization.getLineTokens(g),w=Ia(C,b-1);if(!a.shouldAutoClose(w,b-w.firstCharOffset))return null;let _=a.findNeutralCharacter();if(_){let L=t.tokenization.getTokenTypeIfInsertingCharacter(g,b,_);if(!a.isOK(L))return null}}return h?a.close.substring(0,a.close.length-p.length):a.close}static _findContainedAutoClosingPair(e,t){if(t.open.length<=1)return null;let n=t.close.charAt(t.close.length-1),i=e.autoClosingPairs.autoClosingPairsCloseByEnd.get(n)||[],r=null;for(let s of i)s.open!==t.open&&t.open.includes(s.open)&&t.close.endsWith(s.close)&&(!r||s.open.length>r.open.length)&&(r=s);return r}static _findAutoClosingPairOpen(e,t,n,i){let r=e.autoClosingPairs.autoClosingPairsOpenByEnd.get(i);if(!r)return null;let s=null;for(let a of r)if(s===null||a.open.length>s.open.length){let l=!0;for(let d of n)if(t.getValueInRange(new P(d.lineNumber,d.column-a.open.length+1,d.lineNumber,d.column))+i!==a.open){l=!1;break}l&&(s=a)}return s}static _isBeforeClosingBrace(e,t){let n=t.charAt(0),i=e.autoClosingPairs.autoClosingPairsOpenByStart.get(n)||[],r=e.autoClosingPairs.autoClosingPairsCloseByStart.get(n)||[],s=i.some(l=>t.startsWith(l.open)),a=r.some(l=>t.startsWith(l.close));return!s&&a}},nw=class{static getEdits(e,t,n,i,r){if(!r&&this._isSurroundSelectionType(e,t,n,i))return this._runSurroundSelectionType(e,n,i)}static _runSurroundSelectionType(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r],l=e.surroundingPairs[n];i[r]=new Xx(a,n,l)}return new jn(0,i,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _isSurroundSelectionType(e,t,n,i){if(!JP(e,i)||!e.surroundingPairs.hasOwnProperty(i))return!1;let r=Bs(i);for(let s of n){if(s.isEmpty())return!1;let a=!0;for(let l=s.startLineNumber;l<=s.endLineNumber;l++){let d=t.getLineContent(l),c=l===s.startLineNumber?s.startColumn-1:0,u=l===s.endLineNumber?s.endColumn-1:d.length,p=d.substring(c,u);if(/[^ \t]/.test(p)){a=!1;break}}if(a)return!1;if(r&&s.startLineNumber===s.endLineNumber&&s.startColumn+1===s.endColumn){let l=t.getValueInRange(s);if(Bs(l))return!1}}return!0}},iw=class{static getEdits(e,t,n,i,r,s){if(!s&&this._isTypeInterceptorElectricChar(t,n,i)){let a=this._typeInterceptorElectricChar(e,t,n,i[0],r);if(a)return a}}static _isTypeInterceptorElectricChar(e,t,n){return!!(n.length===1&&t.tokenization.isCheapToTokenize(n[0].getEndPosition().lineNumber))}static _typeInterceptorElectricChar(e,t,n,i,r){if(!t.electricChars.hasOwnProperty(r)||!i.isEmpty())return null;let s=i.getPosition();n.tokenization.forceTokenization(s.lineNumber);let a=n.tokenization.getLineTokens(s.lineNumber),l;try{l=t.onElectricCharacter(r,a,s.column)}catch(d){return qe(d),null}if(!l)return null;if(l.matchOpenBracket){let d=(a.getLineContent()+r).lastIndexOf(l.matchOpenBracket)+1,c=n.bracketPairs.findMatchingBracketUp(l.matchOpenBracket,{lineNumber:s.lineNumber,column:d},500);if(c){if(c.startLineNumber===s.lineNumber)return null;let u=n.getLineContent(c.startLineNumber),p=Jn(u),h=t.normalizeIndentation(p),f=n.getLineContent(s.lineNumber),g=n.getLineFirstNonWhitespaceColumn(s.lineNumber)||s.column,b=f.substring(g-1,s.column-1),v=h+b+r,y=new P(s.lineNumber,1,s.lineNumber,s.column),S=new Oi(y,v);return new jn(QP(v,e),[S],{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!0})}}return null}},ow=class{static getEdits(e,t,n){let i=[];for(let s=0,a=t.length;s<a;s++)i[s]=new Oi(t[s],n);let r=QP(n,e);return new jn(r,i,{shouldPushStackElementBefore:dw(e,r),shouldPushStackElementAfter:!1})}},Qm=class{static getEdits(e,t,n,i,r){if(!r&&i===`
`){let s=[];for(let a=0,l=n.length;a<l;a++)s[a]=this._enter(e,t,!1,n[a]);return new jn(4,s,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}}static _enter(e,t,n,i){if(e.autoIndent===0)return pp(i,`
`,n);if(!t.tokenization.isCheapToTokenize(i.getStartPosition().lineNumber)||e.autoIndent===1){let l=t.getLineContent(i.startLineNumber),d=Jn(l).substring(0,i.startColumn-1);return pp(i,`
`+e.normalizeIndentation(d),n)}let r=qv(e.autoIndent,t,i,e.languageConfigurationService);if(r){if(r.indentAction===0)return pp(i,`
`+e.normalizeIndentation(r.indentation+r.appendText),n);if(r.indentAction===1)return pp(i,`
`+e.normalizeIndentation(r.indentation+r.appendText),n);if(r.indentAction===2){let l=e.normalizeIndentation(r.indentation),d=e.normalizeIndentation(r.indentation+r.appendText),c=`
`+d+`
`+l;return n?new lp(i,c,!0):new dp(i,c,-1,d.length-l.length,!0)}else if(r.indentAction===3){let l=eg(e,r.indentation);return pp(i,`
`+e.normalizeIndentation(l+r.appendText),n)}}let s=t.getLineContent(i.startLineNumber),a=Jn(s).substring(0,i.startColumn-1);if(e.autoIndent>=4){let l=H4(e.autoIndent,t,i,{unshiftIndent:d=>eg(e,d),shiftIndent:d=>$v(e,d),normalizeIndentation:d=>e.normalizeIndentation(d)},e.languageConfigurationService);if(l){let d=e.visibleColumnFromColumn(t,i.getEndPosition()),c=i.endColumn,u=t.getLineContent(i.endLineNumber),p=Cn(u);if(p>=0?i=i.setEndPosition(i.endLineNumber,Math.max(i.endColumn,p+1)):i=i.setEndPosition(i.endLineNumber,t.getLineMaxColumn(i.endLineNumber)),n)return new lp(i,`
`+e.normalizeIndentation(l.afterEnter),!0);{let h=0;return c<=p+1&&(e.insertSpaces||(d=Math.ceil(d/e.indentSize)),h=Math.min(d+1-e.normalizeIndentation(l.afterEnter).length-1,0)),new dp(i,`
`+e.normalizeIndentation(l.afterEnter),0,h,!0)}}}return pp(i,`
`+e.normalizeIndentation(a),n)}static lineInsertBefore(e,t,n){if(t===null||n===null)return[];let i=[];for(let r=0,s=n.length;r<s;r++){let a=n[r].positionLineNumber;if(a===1)i[r]=new lp(new P(1,1,1,1),`
`);else{a--;let l=t.getLineMaxColumn(a);i[r]=this._enter(e,t,!1,new P(a,l,a,l))}}return i}static lineInsertAfter(e,t,n){if(t===null||n===null)return[];let i=[];for(let r=0,s=n.length;r<s;r++){let a=n[r].positionLineNumber,l=t.getLineMaxColumn(a);i[r]=this._enter(e,t,!1,new P(a,l,a,l))}return i}static lineBreakInsert(e,t,n){let i=[];for(let r=0,s=n.length;r<s;r++)i[r]=this._enter(e,t,!0,n[r]);return i}},rw=class{static getEdits(e,t,n,i,r,s){let a=this._distributePasteToCursors(e,n,i,r,s);return a?(n=n.sort(P.compareRangesUsingStarts),this._distributedPaste(e,t,n,a)):this._simplePaste(e,t,n,i,r)}static _distributePasteToCursors(e,t,n,i,r){if(i||t.length===1)return null;if(r&&r.length===t.length)return r;if(e.multiCursorPaste==="spread"){n.charCodeAt(n.length-1)===10&&(n=n.substring(0,n.length-1)),n.charCodeAt(n.length-1)===13&&(n=n.substring(0,n.length-1));let s=pf(n);if(s.length===t.length)return s}return null}static _distributedPaste(e,t,n,i){let r=[];for(let s=0,a=n.length;s<a;s++)r[s]=new Oi(n[s],i[s]);return new jn(0,r,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _simplePaste(e,t,n,i,r){let s=[];for(let a=0,l=n.length;a<l;a++){let d=n[a],c=d.getPosition();if(r&&!d.isEmpty()&&(r=!1),r&&i.indexOf(`
`)!==i.length-1&&(r=!1),r){let u=new P(c.lineNumber,1,c.lineNumber,1);s[a]=new jx(u,i,d,!0)}else s[a]=new Oi(d,i)}return new jn(0,s,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}},sw=class{static getEdits(e,t,n,i,r,s,a,l){let d=i.map(c=>this._compositionType(n,c,r,s,a,l));return new jn(4,d,{shouldPushStackElementBefore:dw(e,4),shouldPushStackElementAfter:!1})}static _compositionType(e,t,n,i,r,s){if(!t.isEmpty())return null;let a=t.getPosition(),l=Math.max(1,a.column-i),d=Math.min(e.getLineMaxColumn(a.lineNumber),a.column+r),c=new P(a.lineNumber,l,a.lineNumber,d);return e.getValueInRange(c)===n&&s===0?null:new dp(c,n,0,s)}},aw=class{static getEdits(e,t,n){let i=[];for(let s=0,a=t.length;s<a;s++)i[s]=new Oi(t[s],n);let r=QP(n,e);return new jn(r,i,{shouldPushStackElementBefore:dw(e,r),shouldPushStackElementAfter:!1})}},lw=class{static getCommands(e,t,n){let i=[];for(let r=0,s=n.length;r<s;r++){let a=n[r];if(a.isEmpty()){let l=t.getLineContent(a.startLineNumber);if(/^\s*$/.test(l)&&t.tokenization.isCheapToTokenize(a.startLineNumber)){let d=this._goodIndentForLine(e,t,a.startLineNumber);d=d||"	";let c=e.normalizeIndentation(d);if(!l.startsWith(c)){i[r]=new Oi(new P(a.startLineNumber,1,a.startLineNumber,l.length+1),c,!0);continue}}i[r]=this._replaceJumpToNextIndent(e,t,a,!0)}else{if(a.startLineNumber===a.endLineNumber){let l=t.getLineMaxColumn(a.startLineNumber);if(a.startColumn!==1||a.endColumn!==l){i[r]=this._replaceJumpToNextIndent(e,t,a,!1);continue}}i[r]=new vr(a,{isUnshift:!1,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent},e.languageConfigurationService)}}return i}static _goodIndentForLine(e,t,n){let i=null,r="",s=jv(e.autoIndent,t,n,!1,e.languageConfigurationService);if(s)i=s.action,r=s.indentation;else if(n>1){let a;for(a=n-1;a>=1;a--){let c=t.getLineContent(a);if(Lr(c)>=0)break}if(a<1)return null;let l=t.getLineMaxColumn(a),d=qv(e.autoIndent,t,new P(a,l,a,l),e.languageConfigurationService);d&&(r=d.indentation+d.appendText)}return i&&(i===1&&(r=$v(e,r)),i===3&&(r=eg(e,r)),r=e.normalizeIndentation(r)),r||null}static _replaceJumpToNextIndent(e,t,n,i){let r="",s=n.getStartPosition();if(e.insertSpaces){let a=e.visibleColumnFromColumn(t,s),l=e.indentSize,d=l-a%l;for(let c=0;c<d;c++)r+=" "}else r="	";return new Oi(n,r,i)}},Jm=class extends dp{_openCharacter;_closeCharacter;closeCharacterRange;enclosingRange;constructor(e,t,n,i,r,s){super(e,t,n,i),this._openCharacter=r,this._closeCharacter=s,this.closeCharacterRange=null,this.enclosingRange=null}_computeCursorStateWithRange(e,t,n){return this.closeCharacterRange=new P(t.startLineNumber,t.endColumn-this._closeCharacter.length,t.endLineNumber,t.endColumn),this.enclosingRange=new P(t.startLineNumber,t.endColumn-this._openCharacter.length-this._closeCharacter.length,t.endLineNumber,t.endColumn),super.computeCursorState(e,n)}},ZP=class extends Jm{constructor(e,t,n,i){let r=(n?t:"")+i,s=0,a=-i.length;super(e,r,s,a,t,i)}computeCursorState(e,t){let i=t.getInverseEditOperations()[0].range;return this._computeCursorStateWithRange(e,i,t)}},XP=class extends Jm{_autoIndentationEdit;_autoClosingEdit;constructor(e,t,n,i){let r=n+i,s=0,a=n.length;super(t,r,s,a,n,i),this._autoIndentationEdit=e,this._autoClosingEdit={range:t,text:r}}getEditOperations(e,t){t.addTrackedEditOperation(this._autoIndentationEdit.range,this._autoIndentationEdit.text),t.addTrackedEditOperation(this._autoClosingEdit.range,this._autoClosingEdit.text)}computeCursorState(e,t){let n=t.getInverseEditOperations();if(n.length!==2)throw new Error("There should be two inverse edit operations!");let i=n[0].range,r=n[1].range,s=i.plusRange(r);return this._computeCursorStateWithRange(e,s,t)}};function QP(o,e){return o===" "?e===5||e===6?6:5:4}function dw(o,e){return K4(o)&&!K4(e)?!0:o===5?!1:z4(o)!==z4(e)}function z4(o){return o===6||o===5?"space":o}function K4(o){return o===4||o===5||o===6}function G4(o,e,t,n,i){if(o.autoClosingOvertype==="never"||!o.autoClosingPairs.autoClosingPairsCloseSingleChar.has(i))return!1;for(let r=0,s=t.length;r<s;r++){let a=t[r];if(!a.isEmpty())return!1;let l=a.getPosition(),d=e.getLineContent(l.lineNumber);if(d.charAt(l.column-1)!==i)return!1;let u=Bs(i);if((l.column>2?d.charCodeAt(l.column-2):0)===92&&u)return!1;if(o.autoClosingOvertype==="auto"){let h=!1;for(let f=0,g=n.length;f<g;f++){let b=n[f];if(l.lineNumber===b.startLineNumber&&l.column===b.startColumn){h=!0;break}}if(!h)return!1}}return!0}function pp(o,e,t){return t?new lp(o,e,!0):new Oi(o,e,!0)}function $v(o,e,t){return t=t||1,vr.shiftIndent(e,e.length+t,o.tabSize,o.indentSize,o.insertSpaces)}function eg(o,e,t){return t=t||1,vr.unshiftIndent(e,e.length+t,o.tabSize,o.indentSize,o.insertSpaces)}function JP(o,e){return Bs(e)?o.autoSurround==="quotes"||o.autoSurround==="languageDefined":o.autoSurround==="brackets"||o.autoSurround==="languageDefined"}var Xs=class{static indent(e,t,n){if(t===null||n===null)return[];let i=[];for(let r=0,s=n.length;r<s;r++)i[r]=new vr(n[r],{isUnshift:!1,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent},e.languageConfigurationService);return i}static outdent(e,t,n){let i=[];for(let r=0,s=n.length;r<s;r++)i[r]=new vr(n[r],{isUnshift:!0,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent},e.languageConfigurationService);return i}static shiftIndent(e,t,n){return $v(e,t,n)}static unshiftIndent(e,t,n){return eg(e,t,n)}static paste(e,t,n,i,r,s){return rw.getEdits(e,t,n,i,r,s)}static tab(e,t,n){return lw.getCommands(e,t,n)}static compositionType(e,t,n,i,r,s,a,l){return sw.getEdits(e,t,n,i,r,s,a,l)}static compositionEndWithInterceptors(e,t,n,i,r,s){if(!i)return null;let a=null;for(let p of i)if(a===null)a=p.insertedText;else if(a!==p.insertedText)return null;if(!a||a.length!==1)return null;let l=a,d=!1;for(let p of i)if(p.deletedText.length!==0){d=!0;break}if(d){if(!JP(t,l)||!t.surroundingPairs.hasOwnProperty(l))return null;let p=Bs(l);for(let g of i)if(g.deletedSelectionStart!==0||g.deletedSelectionEnd!==g.deletedText.length||/^[ \t]+$/.test(g.deletedText)||p&&Bs(g.deletedText))return null;let h=[];for(let g of r){if(!g.isEmpty())return null;h.push(g.getPosition())}if(h.length!==i.length)return null;let f=[];for(let g=0,b=h.length;g<b;g++)f.push(new Qx(h[g],i[g].deletedText,t.surroundingPairs[l]));return new jn(4,f,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}let c=tw.getEdits(t,n,r,s,l);if(c!==void 0)return c;let u=Xm.getEdits(t,n,r,l,!0,!1);return u!==void 0?u:null}static typeWithInterceptors(e,t,n,i,r,s,a){let l=Qm.getEdits(n,i,r,a,e);if(l!==void 0)return l;let d=Jx.getEdits(n,i,r,a,e);if(d!==void 0)return d;let c=ew.getEdits(t,n,i,r,s,a);if(c!==void 0)return c;let u=Xm.getEdits(n,i,r,a,!1,e);if(u!==void 0)return u;let p=nw.getEdits(n,i,r,a,e);if(p!==void 0)return p;let h=iw.getEdits(t,n,i,r,a,e);return h!==void 0?h:ow.getEdits(t,r,a)}static typeWithoutInterceptors(e,t,n,i,r){return aw.getEdits(e,i,r)}},cw=class{constructor(e,t,n,i,r,s){this.deletedText=e;this.deletedSelectionStart=t;this.deletedSelectionEnd=n;this.insertedText=i;this.insertedSelectionStart=r;this.insertedSelectionEnd=s}};var ct=0,tn=class extends Ov{runEditorCommand(e,t,n){let i=t._getViewModel();i&&this.runCoreEditorCommand(i,n||{})}},Ni;(a=>{let o=function(l){if(!an(l))return!1;let d=l;return!(!In(d.to)||!Kn(d.by)&&!In(d.by)||!Kn(d.value)&&!Gi(d.value)||!Kn(d.revealCursor)&&!nI(d.revealCursor))};a.metadata={description:"Scroll editor in the given direction",args:[{name:"Editor scroll argument object",description:"Property-value pairs that can be passed through this argument:\n					* 'to': A mandatory direction value.\n						```\n						'up', 'down'\n						```\n					* 'by': Unit to move. Default is computed based on 'to' value.\n						```\n						'line', 'wrappedLine', 'page', 'halfPage', 'editor'\n						```\n					* 'value': Number of units to move. Default is '1'.\n					* 'revealCursor': If 'true' reveals the cursor if it is outside view port.\n				",constraint:o,schema:{type:"object",required:["to"],properties:{to:{type:"string",enum:["up","down"]},by:{type:"string",enum:["line","wrappedLine","page","halfPage","editor"]},value:{type:"number",default:1},revealCursor:{type:"boolean"}}}}]},a.RawDirection={Up:"up",Right:"right",Down:"down",Left:"left"},a.RawUnit={Line:"line",WrappedLine:"wrappedLine",Page:"page",HalfPage:"halfPage",Editor:"editor",Column:"column"};function i(l){let d;switch(l.to){case a.RawDirection.Up:d=1;break;case a.RawDirection.Right:d=2;break;case a.RawDirection.Down:d=3;break;case a.RawDirection.Left:d=4;break;default:return null}let c;switch(l.by){case a.RawUnit.Line:c=1;break;case a.RawUnit.WrappedLine:c=2;break;case a.RawUnit.Page:c=3;break;case a.RawUnit.HalfPage:c=4;break;case a.RawUnit.Editor:c=5;break;case a.RawUnit.Column:c=6;break;default:c=2}let u=Math.floor(l.value||1),p=!!l.revealCursor;return{direction:d,unit:c,value:u,revealCursor:p,select:!!l.select}}a.parse=i;let r;(p=>(p[p.Up=1]="Up",p[p.Right=2]="Right",p[p.Down=3]="Down",p[p.Left=4]="Left"))(r=a.Direction||={});let s;(f=>(f[f.Line=1]="Line",f[f.WrappedLine=2]="WrappedLine",f[f.Page=3]="Page",f[f.HalfPage=4]="HalfPage",f[f.Editor=5]="Editor",f[f.Column=6]="Column"))(s=a.Unit||={})})(Ni||={});var Yv;(n=>{let o=function(i){if(!an(i))return!1;let r=i;return!(!Gi(r.lineNumber)&&!In(r.lineNumber)||!Kn(r.at)&&!In(r.at))};n.metadata={description:"Reveal the given line at the given logical position",args:[{name:"Reveal line argument object",description:"Property-value pairs that can be passed through this argument:\n					* 'lineNumber': A mandatory line number value.\n					* 'at': Logical position at which line has to be revealed.\n						```\n						'top', 'center', 'bottom'\n						```\n				",constraint:o,schema:{type:"object",required:["lineNumber"],properties:{lineNumber:{type:["number","string"]},at:{type:"string",enum:["top","center","bottom"]}}}}]},n.RawAtArgument={Top:"top",Center:"center",Bottom:"bottom"}})(Yv||={});var Zv=class{constructor(e){e.addImplementation(1e4,"code-editor",(t,n)=>{let i=t.get($a).getFocusedCodeEditor();return i&&i.hasTextFocus()?this._runEditorCommand(t,i,n):!1}),e.addImplementation(1e3,"generic-dom-input-textarea",(t,n)=>{let i=Io();return i&&rs(i)?(this.runDOMCommand(i),!0):!1}),e.addImplementation(0,"generic-dom",(t,n)=>{let i=t.get($a).getActiveCodeEditor();return i?(i.focus(),this._runEditorCommand(t,i,n)):!1})}_runEditorCommand(e,t,n){let i=this.runEditorCommand(e,t,n);return i||!0}};var qn;(ve=>{class o extends tn{_inSelectionMode;constructor(B){super(B),this._inSelectionMode=B.inSelectionMode}runCoreEditorCommand(B,ae){if(!ae.position)return;B.model.pushStackElement(),B.setCursorStates(ae.source,3,[ai.moveTo(B,B.getPrimaryCursorState(),this._inSelectionMode,ae.position,ae.viewPosition)])&&ae.revealType!==2&&B.revealAllCursors(ae.source,!0,!0)}}ve.MoveTo=je(new o({id:"_moveTo",inSelectionMode:!1,precondition:void 0})),ve.MoveToSelect=je(new o({id:"_moveToSelect",inSelectionMode:!0,precondition:void 0}));class n extends tn{runCoreEditorCommand(B,ae){B.model.pushStackElement();let fe=this._getColumnSelectResult(B,B.getPrimaryCursorState(),B.getCursorColumnSelectData(),ae);fe!==null&&(B.setCursorStates(ae.source,3,fe.viewStates.map(nt=>Ze.fromViewState(nt))),B.setCursorColumnSelectData({isReal:!0,fromViewLineNumber:fe.fromLineNumber,fromViewVisualColumn:fe.fromVisualColumn,toViewLineNumber:fe.toLineNumber,toViewVisualColumn:fe.toVisualColumn}),fe.reversed?B.revealTopMostCursor(ae.source):B.revealBottomMostCursor(ae.source))}}ve.ColumnSelect=je(new class extends n{constructor(){super({id:"columnSelect",precondition:void 0})}_getColumnSelectResult(pe,B,ae,fe){if(typeof fe.position>"u"||typeof fe.viewPosition>"u"||typeof fe.mouseColumn>"u")return null;let nt=pe.model.validatePosition(fe.position),Rt=pe.coordinatesConverter.validateViewPosition(new A(fe.viewPosition.lineNumber,fe.viewPosition.column),nt),ci=fe.doColumnSelect?ae.fromViewLineNumber:Rt.lineNumber,Bi=fe.doColumnSelect?ae.fromViewVisualColumn:fe.mouseColumn-1;return wc.columnSelect(pe.cursorConfig,pe,ci,Bi,Rt.lineNumber,fe.mouseColumn-1)}}),ve.CursorColumnSelectLeft=je(new class extends n{constructor(){super({id:"cursorColumnSelectLeft",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:3599,linux:{primary:0}}})}_getColumnSelectResult(pe,B,ae,fe){return wc.columnSelectLeft(pe.cursorConfig,pe,ae)}}),ve.CursorColumnSelectRight=je(new class extends n{constructor(){super({id:"cursorColumnSelectRight",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:3601,linux:{primary:0}}})}_getColumnSelectResult(pe,B,ae,fe){return wc.columnSelectRight(pe.cursorConfig,pe,ae)}});class a extends n{_isPaged;constructor(B){super(B),this._isPaged=B.isPaged}_getColumnSelectResult(B,ae,fe,nt){return wc.columnSelectUp(B.cursorConfig,B,fe,this._isPaged)}}ve.CursorColumnSelectUp=je(new a({isPaged:!1,id:"cursorColumnSelectUp",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:3600,linux:{primary:0}}})),ve.CursorColumnSelectPageUp=je(new a({isPaged:!0,id:"cursorColumnSelectPageUp",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:3595,linux:{primary:0}}}));class c extends n{_isPaged;constructor(B){super(B),this._isPaged=B.isPaged}_getColumnSelectResult(B,ae,fe,nt){return wc.columnSelectDown(B.cursorConfig,B,fe,this._isPaged)}}ve.CursorColumnSelectDown=je(new c({isPaged:!1,id:"cursorColumnSelectDown",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:3602,linux:{primary:0}}})),ve.CursorColumnSelectPageDown=je(new c({isPaged:!0,id:"cursorColumnSelectPageDown",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:3596,linux:{primary:0}}}));class h extends tn{constructor(){super({id:"cursorMove",precondition:void 0,metadata:Ue.metadata})}runCoreEditorCommand(B,ae){let fe=Ue.parse(ae);fe&&this._runCursorMove(B,ae.source,fe)}_runCursorMove(B,ae,fe){B.model.pushStackElement(),B.setCursorStates(ae,3,h._move(B,B.getCursorStates(),fe)),B.revealAllCursors(ae,!0)}static _move(B,ae,fe){let nt=fe.select,Rt=fe.value;switch(fe.direction){case Ue.Direction.Left:case Ue.Direction.Right:case Ue.Direction.Up:case Ue.Direction.Down:case Ue.Direction.PrevBlankLine:case Ue.Direction.NextBlankLine:case Ue.Direction.WrappedLineStart:case Ue.Direction.WrappedLineFirstNonWhitespaceCharacter:case Ue.Direction.WrappedLineColumnCenter:case Ue.Direction.WrappedLineEnd:case Ue.Direction.WrappedLineLastNonWhitespaceCharacter:return ai.simpleMove(B,ae,fe.direction,nt,Rt,fe.unit);case Ue.Direction.ViewPortTop:case Ue.Direction.ViewPortBottom:case Ue.Direction.ViewPortCenter:case Ue.Direction.ViewPortIfOutside:return ai.viewportMove(B,ae,fe.direction,nt,Rt);default:return null}}}ve.CursorMoveImpl=h,ve.CursorMove=je(new h);let g;(B=>B[B.PAGE_SIZE_MARKER=-1]="PAGE_SIZE_MARKER")(g||={});class b extends tn{_staticArgs;constructor(B){super(B),this._staticArgs=B.args}runCoreEditorCommand(B,ae){let fe=this._staticArgs;this._staticArgs.value===-1&&(fe={direction:this._staticArgs.direction,unit:this._staticArgs.unit,select:this._staticArgs.select,value:ae.pageSize||B.cursorConfig.pageSize}),B.model.pushStackElement(),B.setCursorStates(ae.source,3,ai.simpleMove(B,B.getCursorStates(),fe.direction,fe.select,fe.value,fe.unit)),B.revealAllCursors(ae.source,!0)}}ve.CursorLeft=je(new b({args:{direction:Ue.Direction.Left,unit:Ue.Unit.None,select:!1,value:1},id:"cursorLeft",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:15,mac:{primary:15,secondary:[288]}}})),ve.CursorLeftSelect=je(new b({args:{direction:Ue.Direction.Left,unit:Ue.Unit.None,select:!0,value:1},id:"cursorLeftSelect",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:1039}})),ve.CursorRight=je(new b({args:{direction:Ue.Direction.Right,unit:Ue.Unit.None,select:!1,value:1},id:"cursorRight",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:17,mac:{primary:17,secondary:[292]}}})),ve.CursorRightSelect=je(new b({args:{direction:Ue.Direction.Right,unit:Ue.Unit.None,select:!0,value:1},id:"cursorRightSelect",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:1041}})),ve.CursorUp=je(new b({args:{direction:Ue.Direction.Up,unit:Ue.Unit.WrappedLine,select:!1,value:1},id:"cursorUp",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:16,mac:{primary:16,secondary:[302]}}})),ve.CursorUpSelect=je(new b({args:{direction:Ue.Direction.Up,unit:Ue.Unit.WrappedLine,select:!0,value:1},id:"cursorUpSelect",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:1040,secondary:[3088],mac:{primary:1040},linux:{primary:1040}}})),ve.CursorPageUp=je(new b({args:{direction:Ue.Direction.Up,unit:Ue.Unit.WrappedLine,select:!1,value:-1},id:"cursorPageUp",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:11}})),ve.CursorPageUpSelect=je(new b({args:{direction:Ue.Direction.Up,unit:Ue.Unit.WrappedLine,select:!0,value:-1},id:"cursorPageUpSelect",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:1035}})),ve.CursorDown=je(new b({args:{direction:Ue.Direction.Down,unit:Ue.Unit.WrappedLine,select:!1,value:1},id:"cursorDown",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:18,mac:{primary:18,secondary:[300]}}})),ve.CursorDownSelect=je(new b({args:{direction:Ue.Direction.Down,unit:Ue.Unit.WrappedLine,select:!0,value:1},id:"cursorDownSelect",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:1042,secondary:[3090],mac:{primary:1042},linux:{primary:1042}}})),ve.CursorPageDown=je(new b({args:{direction:Ue.Direction.Down,unit:Ue.Unit.WrappedLine,select:!1,value:-1},id:"cursorPageDown",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:12}})),ve.CursorPageDownSelect=je(new b({args:{direction:Ue.Direction.Down,unit:Ue.Unit.WrappedLine,select:!0,value:-1},id:"cursorPageDownSelect",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:1036}})),ve.CreateCursor=je(new class extends tn{constructor(){super({id:"createCursor",precondition:void 0})}runCoreEditorCommand(pe,B){if(!B.position)return;let ae;B.wholeLine?ae=ai.line(pe,pe.getPrimaryCursorState(),!1,B.position,B.viewPosition):ae=ai.moveTo(pe,pe.getPrimaryCursorState(),!1,B.position,B.viewPosition);let fe=pe.getCursorStates();if(fe.length>1){let nt=ae.modelState?ae.modelState.position:null,Rt=ae.viewState?ae.viewState.position:null;for(let ci=0,Bi=fe.length;ci<Bi;ci++){let Ke=fe[ci];if(!(nt&&!Ke.modelState.selection.containsPosition(nt))&&!(Rt&&!Ke.viewState.selection.containsPosition(Rt))){fe.splice(ci,1),pe.model.pushStackElement(),pe.setCursorStates(B.source,3,fe);return}}}fe.push(ae),pe.model.pushStackElement(),pe.setCursorStates(B.source,3,fe)}}),ve.LastCursorMoveToSelect=je(new class extends tn{constructor(){super({id:"_lastCursorMoveToSelect",precondition:void 0})}runCoreEditorCommand(pe,B){if(!B.position)return;let ae=pe.getLastAddedCursorIndex(),fe=pe.getCursorStates(),nt=fe.slice(0);nt[ae]=ai.moveTo(pe,fe[ae],!0,B.position,B.viewPosition),pe.model.pushStackElement(),pe.setCursorStates(B.source,3,nt)}});class ne extends tn{_inSelectionMode;constructor(B){super(B),this._inSelectionMode=B.inSelectionMode}runCoreEditorCommand(B,ae){B.model.pushStackElement(),B.setCursorStates(ae.source,3,ai.moveToBeginningOfLine(B,B.getCursorStates(),this._inSelectionMode)),B.revealAllCursors(ae.source,!0)}}ve.CursorHome=je(new ne({inSelectionMode:!1,id:"cursorHome",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:14,mac:{primary:14,secondary:[2063]}}})),ve.CursorHomeSelect=je(new ne({inSelectionMode:!0,id:"cursorHomeSelect",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:1038,mac:{primary:1038,secondary:[3087]}}}));class se extends tn{_inSelectionMode;constructor(B){super(B),this._inSelectionMode=B.inSelectionMode}runCoreEditorCommand(B,ae){B.model.pushStackElement(),B.setCursorStates(ae.source,3,this._exec(B.getCursorStates())),B.revealAllCursors(ae.source,!0)}_exec(B){let ae=[];for(let fe=0,nt=B.length;fe<nt;fe++){let Rt=B[fe],ci=Rt.modelState.position.lineNumber;ae[fe]=Ze.fromModelState(Rt.modelState.move(this._inSelectionMode,ci,1,0))}return ae}}ve.CursorLineStart=je(new se({inSelectionMode:!1,id:"cursorLineStart",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:0,mac:{primary:287}}})),ve.CursorLineStartSelect=je(new se({inSelectionMode:!0,id:"cursorLineStartSelect",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:0,mac:{primary:1311}}}));class ue extends tn{_inSelectionMode;constructor(B){super(B),this._inSelectionMode=B.inSelectionMode}runCoreEditorCommand(B,ae){B.model.pushStackElement(),B.setCursorStates(ae.source,3,ai.moveToEndOfLine(B,B.getCursorStates(),this._inSelectionMode,ae.sticky||!1)),B.revealAllCursors(ae.source,!0)}}ve.CursorEnd=je(new ue({inSelectionMode:!1,id:"cursorEnd",precondition:void 0,kbOpts:{args:{sticky:!1},weight:ct,kbExpr:ge.textInputFocus,primary:13,mac:{primary:13,secondary:[2065]}},metadata:{description:"Go to End",args:[{name:"args",schema:{type:"object",properties:{sticky:{description:m("stickydesc","Stick to the end even when going to longer lines"),type:"boolean",default:!1}}}}]}})),ve.CursorEndSelect=je(new ue({inSelectionMode:!0,id:"cursorEndSelect",precondition:void 0,kbOpts:{args:{sticky:!1},weight:ct,kbExpr:ge.textInputFocus,primary:1037,mac:{primary:1037,secondary:[3089]}},metadata:{description:"Select to End",args:[{name:"args",schema:{type:"object",properties:{sticky:{description:m("stickydesc","Stick to the end even when going to longer lines"),type:"boolean",default:!1}}}}]}}));class _e extends tn{_inSelectionMode;constructor(B){super(B),this._inSelectionMode=B.inSelectionMode}runCoreEditorCommand(B,ae){B.model.pushStackElement(),B.setCursorStates(ae.source,3,this._exec(B,B.getCursorStates())),B.revealAllCursors(ae.source,!0)}_exec(B,ae){let fe=[];for(let nt=0,Rt=ae.length;nt<Rt;nt++){let ci=ae[nt],Bi=ci.modelState.position.lineNumber,Ke=B.model.getLineMaxColumn(Bi);fe[nt]=Ze.fromModelState(ci.modelState.move(this._inSelectionMode,Bi,Ke,0))}return fe}}ve.CursorLineEnd=je(new _e({inSelectionMode:!1,id:"cursorLineEnd",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:0,mac:{primary:291}}})),ve.CursorLineEndSelect=je(new _e({inSelectionMode:!0,id:"cursorLineEndSelect",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:0,mac:{primary:1315}}}));class Bn extends tn{_inSelectionMode;constructor(B){super(B),this._inSelectionMode=B.inSelectionMode}runCoreEditorCommand(B,ae){B.model.pushStackElement(),B.setCursorStates(ae.source,3,ai.moveToBeginningOfBuffer(B,B.getCursorStates(),this._inSelectionMode)),B.revealAllCursors(ae.source,!0)}}ve.CursorTop=je(new Bn({inSelectionMode:!1,id:"cursorTop",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:2062,mac:{primary:2064}}})),ve.CursorTopSelect=je(new Bn({inSelectionMode:!0,id:"cursorTopSelect",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:3086,mac:{primary:3088}}}));class Nt extends tn{_inSelectionMode;constructor(B){super(B),this._inSelectionMode=B.inSelectionMode}runCoreEditorCommand(B,ae){B.model.pushStackElement(),B.setCursorStates(ae.source,3,ai.moveToEndOfBuffer(B,B.getCursorStates(),this._inSelectionMode)),B.revealAllCursors(ae.source,!0)}}ve.CursorBottom=je(new Nt({inSelectionMode:!1,id:"cursorBottom",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:2061,mac:{primary:2066}}})),ve.CursorBottomSelect=je(new Nt({inSelectionMode:!0,id:"cursorBottomSelect",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:3085,mac:{primary:3090}}}));class Jl extends tn{constructor(){super({id:"editorScroll",precondition:void 0,metadata:Ni.metadata})}determineScrollMethod(B){let ae=[6],fe=[1,2,3,4,5,6],nt=[4,2],Rt=[1,3];return ae.includes(B.unit)&&nt.includes(B.direction)?this._runHorizontalEditorScroll.bind(this):fe.includes(B.unit)&&Rt.includes(B.direction)?this._runVerticalEditorScroll.bind(this):null}runCoreEditorCommand(B,ae){let fe=Ni.parse(ae);if(!fe)return;let nt=this.determineScrollMethod(fe);nt&&nt(B,ae.source,fe)}_runVerticalEditorScroll(B,ae,fe){let nt=this._computeDesiredScrollTop(B,fe);if(fe.revealCursor){let Rt=B.getCompletelyVisibleViewRangeAtScrollTop(nt);B.setCursorStates(ae,3,[ai.findPositionInViewportIfOutside(B,B.getPrimaryCursorState(),Rt,fe.select)])}B.viewLayout.setScrollPosition({scrollTop:nt},0)}_computeDesiredScrollTop(B,ae){if(ae.unit===1){let Rt=B.viewLayout.getFutureViewport(),ci=B.getCompletelyVisibleViewRangeAtScrollTop(Rt.top),Bi=B.coordinatesConverter.convertViewRangeToModelRange(ci),Ke;ae.direction===1?Ke=Math.max(1,Bi.startLineNumber-ae.value):Ke=Math.min(B.model.getLineCount(),Bi.startLineNumber+ae.value);let R=B.coordinatesConverter.convertModelPositionToViewPosition(new A(Ke,1));return B.viewLayout.getVerticalOffsetForLineNumber(R.lineNumber)}if(ae.unit===5){let Rt=0;return ae.direction===3&&(Rt=B.model.getLineCount()-B.cursorConfig.pageSize),B.viewLayout.getVerticalOffsetForLineNumber(Rt)}let fe;ae.unit===3?fe=B.cursorConfig.pageSize*ae.value:ae.unit===4?fe=Math.round(B.cursorConfig.pageSize/2)*ae.value:fe=ae.value;let nt=(ae.direction===1?-1:1)*fe;return B.viewLayout.getCurrentScrollTop()+nt*B.cursorConfig.lineHeight}_runHorizontalEditorScroll(B,ae,fe){let nt=this._computeDesiredScrollLeft(B,fe);B.viewLayout.setScrollPosition({scrollLeft:nt},0)}_computeDesiredScrollLeft(B,ae){let fe=(ae.direction===4?-1:1)*ae.value;return B.viewLayout.getCurrentScrollLeft()+fe*B.cursorConfig.typicalHalfwidthCharacterWidth}}ve.EditorScrollImpl=Jl,ve.EditorScroll=je(new Jl),ve.ScrollLineUp=je(new class extends tn{constructor(){super({id:"scrollLineUp",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:2064,mac:{primary:267}}})}runCoreEditorCommand(pe,B){ve.EditorScroll.runCoreEditorCommand(pe,{to:Ni.RawDirection.Up,by:Ni.RawUnit.WrappedLine,value:1,revealCursor:!1,select:!1,source:B.source})}}),ve.ScrollPageUp=je(new class extends tn{constructor(){super({id:"scrollPageUp",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:2059,win:{primary:523},linux:{primary:523}}})}runCoreEditorCommand(pe,B){ve.EditorScroll.runCoreEditorCommand(pe,{to:Ni.RawDirection.Up,by:Ni.RawUnit.Page,value:1,revealCursor:!1,select:!1,source:B.source})}}),ve.ScrollEditorTop=je(new class extends tn{constructor(){super({id:"scrollEditorTop",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus}})}runCoreEditorCommand(pe,B){ve.EditorScroll.runCoreEditorCommand(pe,{to:Ni.RawDirection.Up,by:Ni.RawUnit.Editor,value:1,revealCursor:!1,select:!1,source:B.source})}}),ve.ScrollLineDown=je(new class extends tn{constructor(){super({id:"scrollLineDown",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:2066,mac:{primary:268}}})}runCoreEditorCommand(pe,B){ve.EditorScroll.runCoreEditorCommand(pe,{to:Ni.RawDirection.Down,by:Ni.RawUnit.WrappedLine,value:1,revealCursor:!1,select:!1,source:B.source})}}),ve.ScrollPageDown=je(new class extends tn{constructor(){super({id:"scrollPageDown",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:2060,win:{primary:524},linux:{primary:524}}})}runCoreEditorCommand(pe,B){ve.EditorScroll.runCoreEditorCommand(pe,{to:Ni.RawDirection.Down,by:Ni.RawUnit.Page,value:1,revealCursor:!1,select:!1,source:B.source})}}),ve.ScrollEditorBottom=je(new class extends tn{constructor(){super({id:"scrollEditorBottom",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus}})}runCoreEditorCommand(pe,B){ve.EditorScroll.runCoreEditorCommand(pe,{to:Ni.RawDirection.Down,by:Ni.RawUnit.Editor,value:1,revealCursor:!1,select:!1,source:B.source})}}),ve.ScrollLeft=je(new class extends tn{constructor(){super({id:"scrollLeft",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus}})}runCoreEditorCommand(pe,B){ve.EditorScroll.runCoreEditorCommand(pe,{to:Ni.RawDirection.Left,by:Ni.RawUnit.Column,value:2,revealCursor:!1,select:!1,source:B.source})}}),ve.ScrollRight=je(new class extends tn{constructor(){super({id:"scrollRight",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus}})}runCoreEditorCommand(pe,B){ve.EditorScroll.runCoreEditorCommand(pe,{to:Ni.RawDirection.Right,by:Ni.RawUnit.Column,value:2,revealCursor:!1,select:!1,source:B.source})}});class Gr extends tn{_inSelectionMode;constructor(B){super(B),this._inSelectionMode=B.inSelectionMode}runCoreEditorCommand(B,ae){ae.position&&(B.model.pushStackElement(),B.setCursorStates(ae.source,3,[ai.word(B,B.getPrimaryCursorState(),this._inSelectionMode,ae.position)]),ae.revealType!==2&&B.revealAllCursors(ae.source,!0,!0))}}ve.WordSelect=je(new Gr({inSelectionMode:!1,id:"_wordSelect",precondition:void 0})),ve.WordSelectDrag=je(new Gr({inSelectionMode:!0,id:"_wordSelectDrag",precondition:void 0})),ve.LastCursorWordSelect=je(new class extends tn{constructor(){super({id:"lastCursorWordSelect",precondition:void 0})}runCoreEditorCommand(pe,B){if(!B.position)return;let ae=pe.getLastAddedCursorIndex(),fe=pe.getCursorStates(),nt=fe.slice(0),Rt=fe[ae];nt[ae]=ai.word(pe,Rt,Rt.modelState.hasSelection(),B.position),pe.model.pushStackElement(),pe.setCursorStates(B.source,3,nt)}});class na extends tn{_inSelectionMode;constructor(B){super(B),this._inSelectionMode=B.inSelectionMode}runCoreEditorCommand(B,ae){ae.position&&(B.model.pushStackElement(),B.setCursorStates(ae.source,3,[ai.line(B,B.getPrimaryCursorState(),this._inSelectionMode,ae.position,ae.viewPosition)]),ae.revealType!==2&&B.revealAllCursors(ae.source,!1,!0))}}ve.LineSelect=je(new na({inSelectionMode:!1,id:"_lineSelect",precondition:void 0})),ve.LineSelectDrag=je(new na({inSelectionMode:!0,id:"_lineSelectDrag",precondition:void 0}));class Cr extends tn{_inSelectionMode;constructor(B){super(B),this._inSelectionMode=B.inSelectionMode}runCoreEditorCommand(B,ae){if(!ae.position)return;let fe=B.getLastAddedCursorIndex(),nt=B.getCursorStates(),Rt=nt.slice(0);Rt[fe]=ai.line(B,nt[fe],this._inSelectionMode,ae.position,ae.viewPosition),B.model.pushStackElement(),B.setCursorStates(ae.source,3,Rt)}}ve.LastCursorLineSelect=je(new Cr({inSelectionMode:!1,id:"lastCursorLineSelect",precondition:void 0})),ve.LastCursorLineSelectDrag=je(new Cr({inSelectionMode:!0,id:"lastCursorLineSelectDrag",precondition:void 0})),ve.CancelSelection=je(new class extends tn{constructor(){super({id:"cancelSelection",precondition:ge.hasNonEmptySelection,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:9,secondary:[1033]}})}runCoreEditorCommand(pe,B){pe.model.pushStackElement(),pe.setCursorStates(B.source,3,[ai.cancelSelection(pe,pe.getPrimaryCursorState())]),pe.revealAllCursors(B.source,!0)}}),ve.RemoveSecondaryCursors=je(new class extends tn{constructor(){super({id:"removeSecondaryCursors",precondition:ge.hasMultipleSelections,kbOpts:{weight:ct+1,kbExpr:ge.textInputFocus,primary:9,secondary:[1033]}})}runCoreEditorCommand(pe,B){pe.model.pushStackElement(),pe.setCursorStates(B.source,3,[pe.getPrimaryCursorState()]),pe.revealAllCursors(B.source,!0),Ub(m("removedCursor","Removed secondary cursors"))}}),ve.RevealLine=je(new class extends tn{constructor(){super({id:"revealLine",precondition:void 0,metadata:Yv.metadata})}runCoreEditorCommand(pe,B){let ae=B,fe=ae.lineNumber||0,nt=typeof fe=="number"?fe+1:parseInt(fe)+1;nt<1&&(nt=1);let Rt=pe.model.getLineCount();nt>Rt&&(nt=Rt);let ci=new P(nt,1,nt,pe.model.getLineMaxColumn(nt)),Bi=0;if(ae.at)switch(ae.at){case Yv.RawAtArgument.Top:Bi=3;break;case Yv.RawAtArgument.Center:Bi=1;break;case Yv.RawAtArgument.Bottom:Bi=4;break;default:break}let Ke=pe.coordinatesConverter.convertModelRangeToViewRange(ci);pe.revealRange(B.source,!1,Ke,Bi,0)}}),ve.SelectAll=new class extends Zv{constructor(){super(P4)}runDOMCommand(pe){Gn&&(pe.focus(),pe.select()),pe.ownerDocument.execCommand("selectAll")}runEditorCommand(pe,B,ae){let fe=B._getViewModel();fe&&this.runCoreEditorCommand(fe,ae)}runCoreEditorCommand(pe,B){pe.model.pushStackElement(),pe.setCursorStates("keyboard",3,[ai.selectAll(pe,pe.getPrimaryCursorState())])}},ve.SetSelection=je(new class extends tn{constructor(){super({id:"setSelection",precondition:void 0})}runCoreEditorCommand(pe,B){B.selection&&(pe.model.pushStackElement(),pe.setCursorStates(B.source,3,[Ze.fromModelSelection(B.selection)]))}})})(qn||={});var _j=Kt.and(ge.textInputFocus,ge.columnSelection);function ng(o,e){Hd.registerKeybindingRule({id:o,primary:e,when:_j,weight:ct+1})}ng(qn.CursorColumnSelectLeft.id,1039);ng(qn.CursorColumnSelectRight.id,1041);ng(qn.CursorColumnSelectUp.id,1040);ng(qn.CursorColumnSelectPageUp.id,1035);ng(qn.CursorColumnSelectDown.id,1042);ng(qn.CursorColumnSelectPageDown.id,1036);function j4(o){return o.register(),o}var Dj;(l=>{class o extends Ov{runEditorCommand(c,u,p){let h=u._getViewModel();h&&this.runCoreEditingCommand(u,h,p||{})}}l.CoreEditingCommand=o,l.LineBreakInsert=je(new class extends o{constructor(){super({id:"lineBreakInsert",precondition:ge.writable,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:0,mac:{primary:301}}})}runCoreEditingCommand(d,c,u){d.pushUndoStop(),d.executeCommands(this.id,Qm.lineBreakInsert(c.cursorConfig,c.model,c.getCursorStates().map(p=>p.modelState.selection)))}}),l.Outdent=je(new class extends o{constructor(){super({id:"outdent",precondition:ge.writable,kbOpts:{weight:ct,kbExpr:Kt.and(ge.editorTextFocus,ge.tabDoesNotMoveFocus),primary:1026}})}runCoreEditingCommand(d,c,u){d.pushUndoStop(),d.executeCommands(this.id,Xs.outdent(c.cursorConfig,c.model,c.getCursorStates().map(p=>p.modelState.selection))),d.pushUndoStop()}}),l.Tab=je(new class extends o{constructor(){super({id:"tab",precondition:ge.writable,kbOpts:{weight:ct,kbExpr:Kt.and(ge.editorTextFocus,ge.tabDoesNotMoveFocus),primary:2}})}runCoreEditingCommand(d,c,u){d.pushUndoStop(),d.executeCommands(this.id,Xs.tab(c.cursorConfig,c.model,c.getCursorStates().map(p=>p.modelState.selection))),d.pushUndoStop()}}),l.DeleteLeft=je(new class extends o{constructor(){super({id:"deleteLeft",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:1,secondary:[1025],mac:{primary:1,secondary:[1025,294,257]}}})}runCoreEditingCommand(d,c,u){let[p,h]=$l.deleteLeft(c.getPrevEditOperationType(),c.cursorConfig,c.model,c.getCursorStates().map(f=>f.modelState.selection),c.getCursorAutoClosedCharacters());p&&d.pushUndoStop(),d.executeCommands(this.id,h),c.setPrevEditOperationType(2)}}),l.DeleteRight=je(new class extends o{constructor(){super({id:"deleteRight",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:20,mac:{primary:20,secondary:[290,276]}}})}runCoreEditingCommand(d,c,u){let[p,h]=$l.deleteRight(c.getPrevEditOperationType(),c.cursorConfig,c.model,c.getCursorStates().map(f=>f.modelState.selection));p&&d.pushUndoStop(),d.executeCommands(this.id,h),c.setPrevEditOperationType(3)}}),l.Undo=new class extends Zv{constructor(){super(NP)}runDOMCommand(d){d.ownerDocument.execCommand("undo")}runEditorCommand(d,c,u){if(!(!c.hasModel()||c.getOption(93)===!0))return c.getModel().undo()}},l.Redo=new class extends Zv{constructor(){super(AP)}runDOMCommand(d){d.ownerDocument.execCommand("redo")}runEditorCommand(d,c,u){if(!(!c.hasModel()||c.getOption(93)===!0))return c.getModel().redo()}}})(Dj||={});var uw=class extends ip{_handlerId;constructor(e,t,n){super({id:e,precondition:void 0,metadata:n}),this._handlerId=t}runCommand(e,t){let n=e.get($a).getFocusedCodeEditor();n&&n.trigger("keyboard",this._handlerId,t)}};function mp(o,e){j4(new uw("default:"+o,o)),j4(new uw(o,o,e))}mp("type",{description:"Type",args:[{name:"args",schema:{type:"object",required:["text"],properties:{text:{type:"string"}}}}]});mp("replacePreviousChar");mp("compositionType");mp("compositionStart");mp("compositionEnd");mp("paste");mp("cut");var ig=class o{onKeyDown=null;onKeyUp=null;onContextMenu=null;onMouseMove=null;onMouseLeave=null;onMouseDown=null;onMouseUp=null;onMouseDrag=null;onMouseDrop=null;onMouseDropCanceled=null;onMouseWheel=null;_coordinatesConverter;constructor(e){this._coordinatesConverter=e}emitKeyDown(e){this.onKeyDown?.(e)}emitKeyUp(e){this.onKeyUp?.(e)}emitContextMenu(e){this.onContextMenu?.(this._convertViewToModelMouseEvent(e))}emitMouseMove(e){this.onMouseMove?.(this._convertViewToModelMouseEvent(e))}emitMouseLeave(e){this.onMouseLeave?.(this._convertViewToModelMouseEvent(e))}emitMouseDown(e){this.onMouseDown?.(this._convertViewToModelMouseEvent(e))}emitMouseUp(e){this.onMouseUp?.(this._convertViewToModelMouseEvent(e))}emitMouseDrag(e){this.onMouseDrag?.(this._convertViewToModelMouseEvent(e))}emitMouseDrop(e){this.onMouseDrop?.(this._convertViewToModelMouseEvent(e))}emitMouseDropCanceled(){this.onMouseDropCanceled?.()}emitMouseWheel(e){this.onMouseWheel?.(e)}_convertViewToModelMouseEvent(e){return e.target?{event:e.event,target:this._convertViewToModelMouseTarget(e.target)}:e}_convertViewToModelMouseTarget(e){return o.convertViewToModelMouseTarget(e,this._coordinatesConverter)}static convertViewToModelMouseTarget(e,t){let n={...e};return n.position&&(n.position=t.convertViewPositionToModelPosition(n.position)),n.range&&(n.range=t.convertViewRangeToModelRange(n.range)),(n.type===5||n.type===8)&&(n.detail=this.convertViewToModelViewZoneData(n.detail,t)),n}static convertViewToModelViewZoneData(e,t){return{viewZoneId:e.viewZoneId,positionBefore:e.positionBefore?t.convertViewPositionToModelPosition(e.positionBefore):e.positionBefore,positionAfter:e.positionAfter?t.convertViewPositionToModelPosition(e.positionAfter):e.positionAfter,position:t.convertViewPositionToModelPosition(e.position),afterLineNumber:t.convertViewPositionToModelPosition(new A(e.afterLineNumber,1)).lineNumber}}};var pw=class{configuration;viewModel;userInputEvents;commandDelegate;constructor(e,t,n,i){this.configuration=e,this.viewModel=t,this.userInputEvents=n,this.commandDelegate=i}paste(e,t,n,i){this.commandDelegate.paste(e,t,n,i)}type(e){this.commandDelegate.type(e)}compositionType(e,t,n,i){this.commandDelegate.compositionType(e,t,n,i)}compositionStart(){this.commandDelegate.startComposition()}compositionEnd(){this.commandDelegate.endComposition()}cut(){this.commandDelegate.cut()}setSelection(e){qn.SetSelection.runCoreEditorCommand(this.viewModel,{source:"keyboard",selection:e})}_validateViewColumn(e){let t=this.viewModel.getLineMinColumn(e.lineNumber);return e.column<t?new A(e.lineNumber,t):e}_hasMulticursorModifier(e){switch(this.configuration.options.get(79)){case"altKey":return e.altKey;case"ctrlKey":return e.ctrlKey;case"metaKey":return e.metaKey;default:return!1}}_hasNonMulticursorModifier(e){switch(this.configuration.options.get(79)){case"altKey":return e.ctrlKey||e.metaKey;case"ctrlKey":return e.altKey||e.metaKey;case"metaKey":return e.ctrlKey||e.altKey;default:return!1}}dispatchMouse(e){let t=this.configuration.options,n=At&&t.get(109),i=t.get(22);e.middleButton&&!n?this._columnSelect(e.position,e.mouseColumn,e.inSelectionMode):e.startedOnLineNumbers?this._hasMulticursorModifier(e)?e.inSelectionMode?this._lastCursorLineSelect(e.position,e.revealType):this._createCursor(e.position,!0):e.inSelectionMode?this._lineSelectDrag(e.position,e.revealType):this._lineSelect(e.position,e.revealType):e.mouseDownCount>=4?this._selectAll():e.mouseDownCount===3?this._hasMulticursorModifier(e)?e.inSelectionMode?this._lastCursorLineSelectDrag(e.position,e.revealType):this._lastCursorLineSelect(e.position,e.revealType):e.inSelectionMode?this._lineSelectDrag(e.position,e.revealType):this._lineSelect(e.position,e.revealType):e.mouseDownCount===2?e.onInjectedText||(this._hasMulticursorModifier(e)?this._lastCursorWordSelect(e.position,e.revealType):e.inSelectionMode?this._wordSelectDrag(e.position,e.revealType):this._wordSelect(e.position,e.revealType)):this._hasMulticursorModifier(e)?this._hasNonMulticursorModifier(e)||(e.shiftKey?this._columnSelect(e.position,e.mouseColumn,!0):e.inSelectionMode?this._lastCursorMoveToSelect(e.position,e.revealType):this._createCursor(e.position,!1)):e.inSelectionMode?e.altKey?this._columnSelect(e.position,e.mouseColumn,!0):i?this._columnSelect(e.position,e.mouseColumn,!0):this._moveToSelect(e.position,e.revealType):this.moveTo(e.position,e.revealType)}_usualArgs(e,t){return e=this._validateViewColumn(e),{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,revealType:t}}moveTo(e,t){qn.MoveTo.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_moveToSelect(e,t){qn.MoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_columnSelect(e,t,n){e=this._validateViewColumn(e),qn.ColumnSelect.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,mouseColumn:t,doColumnSelect:n})}_createCursor(e,t){e=this._validateViewColumn(e),qn.CreateCursor.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,wholeLine:t})}_lastCursorMoveToSelect(e,t){qn.LastCursorMoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_wordSelect(e,t){qn.WordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_wordSelectDrag(e,t){qn.WordSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lastCursorWordSelect(e,t){qn.LastCursorWordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lineSelect(e,t){qn.LineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lineSelectDrag(e,t){qn.LineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lastCursorLineSelect(e,t){qn.LastCursorLineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lastCursorLineSelectDrag(e,t){qn.LastCursorLineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_selectAll(){qn.SelectAll.runCoreEditorCommand(this.viewModel,{source:"mouse"})}_convertViewToModelPosition(e){return this.viewModel.coordinatesConverter.convertViewPositionToModelPosition(e)}emitKeyDown(e){this.userInputEvents.emitKeyDown(e)}emitKeyUp(e){this.userInputEvents.emitKeyUp(e)}emitContextMenu(e){this.userInputEvents.emitContextMenu(e)}emitMouseMove(e){this.userInputEvents.emitMouseMove(e)}emitMouseLeave(e){this.userInputEvents.emitMouseLeave(e)}emitMouseUp(e){this.userInputEvents.emitMouseUp(e)}emitMouseDown(e){this.userInputEvents.emitMouseDown(e)}emitMouseDrag(e){this.userInputEvents.emitMouseDrag(e)}emitMouseDrop(e){this.userInputEvents.emitMouseDrop(e)}emitMouseDropCanceled(){this.userInputEvents.emitMouseDropCanceled()}emitMouseWheel(e){this.userInputEvents.emitMouseWheel(e)}};var og=class extends as{_context;viewController;viewHelper;mouseTargetFactory;_mouseDownOperation;lastMouseLeaveTime;_height;_mouseLeaveMonitor=null;constructor(e,t,n){super(),this._context=e,this.viewController=t,this.viewHelper=n,this.mouseTargetFactory=new Ym(this._context,n),this._mouseDownOperation=this._register(new eO(this._context,this.viewController,this.viewHelper,this.mouseTargetFactory,(s,a)=>this._createMouseTarget(s,a),s=>this._getMouseColumn(s))),this.lastMouseLeaveTime=-1,this._height=this._context.configuration.options.get(147).height;let i=new _x(this.viewHelper.viewDomNode);this._register(i.onContextMenu(this.viewHelper.viewDomNode,s=>this._onContextMenu(s,!0))),this._register(i.onMouseMove(this.viewHelper.viewDomNode,s=>{this._onMouseMove(s),this._mouseLeaveMonitor||(this._mouseLeaveMonitor=j(this.viewHelper.viewDomNode.ownerDocument,"mousemove",a=>{this.viewHelper.viewDomNode.contains(a.target)||this._onMouseLeave(new cs(a,!1,this.viewHelper.viewDomNode))}))})),this._register(i.onMouseUp(this.viewHelper.viewDomNode,s=>this._onMouseUp(s))),this._register(i.onMouseLeave(this.viewHelper.viewDomNode,s=>this._onMouseLeave(s)));let r=0;this._register(i.onPointerDown(this.viewHelper.viewDomNode,(s,a)=>{r=a})),this._register(j(this.viewHelper.viewDomNode,me.POINTER_UP,s=>{this._mouseDownOperation.onPointerUp()})),this._register(i.onMouseDown(this.viewHelper.viewDomNode,s=>this._onMouseDown(s,r))),this._setupMouseWheelZoomListener(),this._context.addEventHandler(this)}_setupMouseWheelZoomListener(){let e=Wb.INSTANCE,t=0,n=Ca.getZoomLevel(),i=!1,r=0,s=l=>{if(this.viewController.emitMouseWheel(l),!this._context.configuration.options.get(77))return;let d=new Nr(l);if(e.acceptStandardWheelEvent(d),e.isPhysicalMouseWheel()){if(a(l)){let c=Ca.getZoomLevel(),u=d.deltaY>0?1:-1;Ca.setZoomLevel(c+u),d.preventDefault(),d.stopPropagation()}}else Date.now()-t>50&&(n=Ca.getZoomLevel(),i=a(l),r=0),t=Date.now(),r+=d.deltaY,i&&(Ca.setZoomLevel(n+r/5),d.preventDefault(),d.stopPropagation())};this._register(j(this.viewHelper.viewDomNode,me.MOUSE_WHEEL,s,{capture:!0,passive:!1}));function a(l){return Ve?(l.metaKey||l.ctrlKey)&&!l.shiftKey&&!l.altKey:l.ctrlKey&&!l.metaKey&&!l.shiftKey&&!l.altKey}}dispose(){this._context.removeEventHandler(this),this._mouseLeaveMonitor&&(this._mouseLeaveMonitor.dispose(),this._mouseLeaveMonitor=null),super.dispose()}onConfigurationChanged(e){if(e.hasChanged(147)){let t=this._context.configuration.options.get(147).height;this._height!==t&&(this._height=t,this._mouseDownOperation.onHeightChanged())}return!1}onCursorStateChanged(e){return this._mouseDownOperation.onCursorStateChanged(e),!1}onFocusChanged(e){return!1}getTargetAtClientPoint(e,t){let i=new Av(e,t).toPageCoordinates(Ce(this.viewHelper.viewDomNode)),r=Rx(this.viewHelper.viewDomNode);if(i.y<r.y||i.y>r.y+r.height||i.x<r.x||i.x>r.x+r.width)return null;let s=kx(this.viewHelper.viewDomNode,r,i);return this.mouseTargetFactory.createMouseTarget(this.viewHelper.getLastRenderData(),r,i,s,null)}_createMouseTarget(e,t){let n=e.target;if(!this.viewHelper.viewDomNode.contains(n)){let i=Yd(this.viewHelper.viewDomNode);i&&(n=i.elementsFromPoint(e.posx,e.posy).find(r=>this.viewHelper.viewDomNode.contains(r)))}return this.mouseTargetFactory.createMouseTarget(this.viewHelper.getLastRenderData(),e.editorPos,e.pos,e.relativePos,t?n:null)}_getMouseColumn(e){return this.mouseTargetFactory.getMouseColumn(e.relativePos)}_onContextMenu(e,t){this.viewController.emitContextMenu({event:e,target:this._createMouseTarget(e,t)})}_onMouseMove(e){this.mouseTargetFactory.mouseTargetIsWidget(e)||e.preventDefault(),!(this._mouseDownOperation.isActive()||e.timestamp<this.lastMouseLeaveTime)&&this.viewController.emitMouseMove({event:e,target:this._createMouseTarget(e,!0)})}_onMouseLeave(e){this._mouseLeaveMonitor&&(this._mouseLeaveMonitor.dispose(),this._mouseLeaveMonitor=null),this.lastMouseLeaveTime=new Date().getTime(),this.viewController.emitMouseLeave({event:e,target:null})}_onMouseUp(e){this.viewController.emitMouseUp({event:e,target:this._createMouseTarget(e,!0)})}_onMouseDown(e,t){let n=this._createMouseTarget(e,!0),i=n.type===6||n.type===7,r=n.type===2||n.type===3||n.type===4,s=n.type===3,a=this._context.configuration.options.get(111),l=n.type===8||n.type===5,d=n.type===9,c=e.leftButton||e.middleButton;Ve&&e.leftButton&&e.ctrlKey&&(c=!1);let u=()=>{e.preventDefault(),this.viewHelper.focusTextArea()};if(c&&(i||s&&a))u(),this._mouseDownOperation.start(n.type,e,t);else if(r)e.preventDefault();else if(l){let p=n.detail;c&&this.viewHelper.shouldSuppressMouseDownOnViewZone(p.viewZoneId)&&(u(),this._mouseDownOperation.start(n.type,e,t),e.preventDefault())}else d&&this.viewHelper.shouldSuppressMouseDownOnWidget(n.detail)&&(u(),e.preventDefault());this.viewController.emitMouseDown({event:e,target:n})}_onMouseWheel(e){this.viewController.emitMouseWheel(e)}},eO=class extends F{constructor(t,n,i,r,s,a){super();this._context=t;this._viewController=n;this._viewHelper=i;this._mouseTargetFactory=r;this._createMouseTarget=s,this._getMouseColumn=a,this._mouseMoveMonitor=this._register(new Lx(this._viewHelper.viewDomNode)),this._topBottomDragScrolling=this._register(new tO(this._context,this._viewHelper,this._mouseTargetFactory,(l,d,c)=>this._dispatchMouse(l,d,c))),this._mouseState=new iO,this._currentSelection=new $e(1,1,1,1),this._isActive=!1,this._lastMouseEvent=null}_createMouseTarget;_getMouseColumn;_mouseMoveMonitor;_topBottomDragScrolling;_mouseState;_currentSelection;_isActive;_lastMouseEvent;dispose(){super.dispose()}isActive(){return this._isActive}_onMouseDownThenMove(t){this._lastMouseEvent=t,this._mouseState.setModifiers(t);let n=this._findMousePosition(t,!1);n&&(this._mouseState.isDragAndDrop?this._viewController.emitMouseDrag({event:t,target:n}):n.type===13&&(n.outsidePosition==="above"||n.outsidePosition==="below")?this._topBottomDragScrolling.start(n,t):(this._topBottomDragScrolling.stop(),this._dispatchMouse(n,!0,1)))}start(t,n,i){this._lastMouseEvent=n,this._mouseState.setStartedOnLineNumbers(t===3),this._mouseState.setStartButtons(n),this._mouseState.setModifiers(n);let r=this._findMousePosition(n,!0);if(!r||!r.position)return;this._mouseState.trySetCount(n.detail,r.position),n.detail=this._mouseState.count;let s=this._context.configuration.options;if(!s.get(93)&&s.get(35)&&!s.get(22)&&!this._mouseState.altKey&&n.detail<2&&!this._isActive&&!this._currentSelection.isEmpty()&&r.type===6&&r.position&&this._currentSelection.containsPosition(r.position)){this._mouseState.isDragAndDrop=!0,this._isActive=!0,this._mouseMoveMonitor.startMonitoring(this._viewHelper.viewLinesDomNode,i,n.buttons,a=>this._onMouseDownThenMove(a),a=>{let l=this._findMousePosition(this._lastMouseEvent,!1);os(a)?this._viewController.emitMouseDropCanceled():this._viewController.emitMouseDrop({event:this._lastMouseEvent,target:l?this._createMouseTarget(this._lastMouseEvent,!0):null}),this._stop()});return}this._mouseState.isDragAndDrop=!1,this._dispatchMouse(r,n.shiftKey,1),this._isActive||(this._isActive=!0,this._mouseMoveMonitor.startMonitoring(this._viewHelper.viewLinesDomNode,i,n.buttons,a=>this._onMouseDownThenMove(a),()=>this._stop()))}_stop(){this._isActive=!1,this._topBottomDragScrolling.stop()}onHeightChanged(){this._mouseMoveMonitor.stopMonitoring()}onPointerUp(){this._mouseMoveMonitor.stopMonitoring()}onCursorStateChanged(t){this._currentSelection=t.selections[0]}_getPositionOutsideEditor(t){let n=t.editorPos,i=this._context.viewModel,r=this._context.viewLayout,s=this._getMouseColumn(t);if(t.posy<n.y){let l=n.y-t.posy,d=Math.max(r.getCurrentScrollTop()-l,0),c=$m.getZoneAtCoord(this._context,d);if(c){let p=this._helpPositionJumpOverViewZone(c);if(p)return si.createOutsideEditor(s,p,"above",l)}let u=r.getLineNumberAtVerticalOffset(d);return si.createOutsideEditor(s,new A(u,1),"above",l)}if(t.posy>n.y+n.height){let l=t.posy-n.y-n.height,d=r.getCurrentScrollTop()+t.relativePos.y,c=$m.getZoneAtCoord(this._context,d);if(c){let p=this._helpPositionJumpOverViewZone(c);if(p)return si.createOutsideEditor(s,p,"below",l)}let u=r.getLineNumberAtVerticalOffset(d);return si.createOutsideEditor(s,new A(u,i.getLineMaxColumn(u)),"below",l)}let a=r.getLineNumberAtVerticalOffset(r.getCurrentScrollTop()+t.relativePos.y);if(t.posx<n.x){let l=n.x-t.posx;return si.createOutsideEditor(s,new A(a,1),"left",l)}if(t.posx>n.x+n.width){let l=t.posx-n.x-n.width;return si.createOutsideEditor(s,new A(a,i.getLineMaxColumn(a)),"right",l)}return null}_findMousePosition(t,n){let i=this._getPositionOutsideEditor(t);if(i)return i;let r=this._createMouseTarget(t,n);if(!r.position)return null;if(r.type===8||r.type===5){let a=this._helpPositionJumpOverViewZone(r.detail);if(a)return si.createViewZone(r.type,r.element,r.mouseColumn,a,r.detail)}return r}_helpPositionJumpOverViewZone(t){let n=new A(this._currentSelection.selectionStartLineNumber,this._currentSelection.selectionStartColumn),i=t.positionBefore,r=t.positionAfter;return i&&r?i.isBefore(n)?i:r:null}_dispatchMouse(t,n,i){t.position&&this._viewController.dispatchMouse({position:t.position,mouseColumn:t.mouseColumn,startedOnLineNumbers:this._mouseState.startedOnLineNumbers,revealType:i,inSelectionMode:n,mouseDownCount:this._mouseState.count,altKey:this._mouseState.altKey,ctrlKey:this._mouseState.ctrlKey,metaKey:this._mouseState.metaKey,shiftKey:this._mouseState.shiftKey,leftButton:this._mouseState.leftButton,middleButton:this._mouseState.middleButton,onInjectedText:t.type===6&&t.detail.injectedText!==null})}},tO=class extends F{constructor(t,n,i,r){super();this._context=t;this._viewHelper=n;this._mouseTargetFactory=i;this._dispatchMouse=r;this._operation=null}_operation;dispose(){super.dispose(),this.stop()}start(t,n){this._operation?this._operation.setPosition(t,n):this._operation=new nO(this._context,this._viewHelper,this._mouseTargetFactory,this._dispatchMouse,t,n)}stop(){this._operation&&(this._operation.dispose(),this._operation=null)}},nO=class extends F{constructor(t,n,i,r,s,a){super();this._context=t;this._viewHelper=n;this._mouseTargetFactory=i;this._dispatchMouse=r;this._position=s,this._mouseEvent=a,this._lastTime=Date.now(),this._animationFrameDisposable=ni(Ce(a.browserEvent),()=>this._execute())}_position;_mouseEvent;_lastTime;_animationFrameDisposable;dispose(){this._animationFrameDisposable.dispose(),super.dispose()}setPosition(t,n){this._position=t,this._mouseEvent=n}_tick(){let t=Date.now(),n=t-this._lastTime;return this._lastTime=t,n}_getScrollSpeed(){let t=this._context.configuration.options.get(68),n=this._context.configuration.options.get(147).height/t,i=this._position.outsideDistance/t;return i<=1.5?Math.max(30,n*(1+i)):i<=3?Math.max(60,n*(2+i)):Math.max(200,n*(7+i))}_execute(){let t=this._context.configuration.options.get(68),n=this._getScrollSpeed(),i=this._tick(),r=n*(i/1e3)*t,s=this._position.outsidePosition==="above"?-r:r;this._context.viewModel.viewLayout.deltaScrollNow(0,s),this._viewHelper.renderNow();let a=this._context.viewLayout.getLinesViewportData(),l=this._position.outsidePosition==="above"?a.startLineNumber:a.endLineNumber,d;{let c=Rx(this._viewHelper.viewDomNode),u=this._context.configuration.options.get(147).horizontalScrollbarHeight,p=new Ec(this._mouseEvent.pos.x,c.y+c.height-u-.1),h=kx(this._viewHelper.viewDomNode,c,p);d=this._mouseTargetFactory.createMouseTarget(this._viewHelper.getLastRenderData(),c,p,h,null)}(!d.position||d.position.lineNumber!==l)&&(this._position.outsidePosition==="above"?d=si.createOutsideEditor(this._position.mouseColumn,new A(l,1),"above",this._position.outsideDistance):d=si.createOutsideEditor(this._position.mouseColumn,new A(l,this._context.viewModel.getLineMaxColumn(l)),"below",this._position.outsideDistance)),this._dispatchMouse(d,!0,2),this._animationFrameDisposable=ni(Ce(d.element),()=>this._execute())}},iO=class o{static CLEAR_MOUSE_DOWN_COUNT_TIME=400;_altKey;get altKey(){return this._altKey}_ctrlKey;get ctrlKey(){return this._ctrlKey}_metaKey;get metaKey(){return this._metaKey}_shiftKey;get shiftKey(){return this._shiftKey}_leftButton;get leftButton(){return this._leftButton}_middleButton;get middleButton(){return this._middleButton}_startedOnLineNumbers;get startedOnLineNumbers(){return this._startedOnLineNumbers}_lastMouseDownPosition;_lastMouseDownPositionEqualCount;_lastMouseDownCount;_lastSetMouseDownCountTime;isDragAndDrop;constructor(){this._altKey=!1,this._ctrlKey=!1,this._metaKey=!1,this._shiftKey=!1,this._leftButton=!1,this._middleButton=!1,this._startedOnLineNumbers=!1,this._lastMouseDownPosition=null,this._lastMouseDownPositionEqualCount=0,this._lastMouseDownCount=0,this._lastSetMouseDownCountTime=0,this.isDragAndDrop=!1}get count(){return this._lastMouseDownCount}setModifiers(e){this._altKey=e.altKey,this._ctrlKey=e.ctrlKey,this._metaKey=e.metaKey,this._shiftKey=e.shiftKey}setStartButtons(e){this._leftButton=e.leftButton,this._middleButton=e.middleButton}setStartedOnLineNumbers(e){this._startedOnLineNumbers=e}trySetCount(e,t){let n=new Date().getTime();n-this._lastSetMouseDownCountTime>o.CLEAR_MOUSE_DOWN_COUNT_TIME&&(e=1),this._lastSetMouseDownCountTime=n,e>this._lastMouseDownCount+1&&(e=this._lastMouseDownCount+1),this._lastMouseDownPosition&&this._lastMouseDownPosition.equals(t)?this._lastMouseDownPositionEqualCount++:this._lastMouseDownPositionEqualCount=1,this._lastMouseDownPosition=t,this._lastMouseDownCount=Math.min(e,this._lastMouseDownPositionEqualCount)}};function hw(o,e,t,n){let i=o.getPlainTextToCopy(e,t,pt),r=o.model.getEOL(),s=t&&e.length===1&&e[0].isEmpty(),a=Array.isArray(i)?i:null,l=Array.isArray(i)?i.join(r):i,d,c=null;if(Rj.forceCopyWithSyntaxHighlighting||n&&l.length<65536){let p=o.getRichTextToCopy(e,t);p&&(d=p.html,c=p.mode)}return{isFromEmptySelection:s,multicursorText:a,text:l,html:d,mode:c}}var gp=class o{static INSTANCE=new o;_lastState;constructor(){this._lastState=null}set(e,t){this._lastState={lastCopiedValue:e,data:t}}get(e){return this._lastState&&this._lastState.lastCopiedValue===e?this._lastState.data:(this._lastState=null,null)}},Rj={forceCopyWithSyntaxHighlighting:!1};var rg=class o{static _getPageOfLine(e,t){return Math.floor((e-1)/t)}static _getRangeForPage(e,t){let n=e*t,i=n+1,r=n+t;return new P(i,1,r+1,1)}static fromEditorSelection(e,t,n,i){let s=o._getPageOfLine(t.startLineNumber,n),a=o._getRangeForPage(s,n),l=o._getPageOfLine(t.endLineNumber,n),d=o._getRangeForPage(l,n),c=a.intersectRanges(new P(1,1,t.startLineNumber,t.startColumn));if(i&&e.getValueLengthInRange(c,1)>500){let v=e.modifyPosition(c.getEndPosition(),-500);c=P.fromPositions(v,c.getEndPosition())}let u=e.getValueInRange(c,1),p=e.getLineCount(),h=e.getLineMaxColumn(p),f=d.intersectRanges(new P(t.endLineNumber,t.endColumn,p,h));if(i&&e.getValueLengthInRange(f,1)>500){let v=e.modifyPosition(f.getStartPosition(),500);f=P.fromPositions(f.getStartPosition(),v)}let g=e.getValueInRange(f,1),b;if(s===l||s+1===l)b=e.getValueInRange(t,1);else{let v=a.intersectRanges(t),y=d.intersectRanges(t);b=e.getValueInRange(v,1)+"\u2026"+e.getValueInRange(y,1)}return i&&b.length>2*500&&(b=b.substring(0,500)+"\u2026"+b.substring(b.length-500,b.length)),{value:u+b+g,selection:t,selectionStart:u.length,selectionEnd:u.length+b.length,newlineCountBeforeSelection:c.endLineNumber-c.startLineNumber}}};function Xv(o,e){if(o.get(2)===1){let n=e.lookupKeybinding("editor.action.toggleScreenReaderAccessibilityMode")?.getAriaLabel(),i=e.lookupKeybinding("workbench.action.showCommands")?.getAriaLabel(),r=e.lookupKeybinding("workbench.action.openGlobalKeybindings")?.getAriaLabel(),s=m("accessibilityModeOff","The editor is not accessible at this time.");return n?m("accessibilityOffAriaLabel","{0} To enable screen reader optimized mode, use {1}",s,n):i?m("accessibilityOffAriaLabelNoKb","{0} To enable screen reader optimized mode, open the quick pick with {1} and run the command Toggle Screen Reader Accessibility Mode, which is currently not triggerable via keyboard.",s,i):r?m("accessibilityOffAriaLabelNoKbs","{0} Please assign a keybinding for the command Toggle Screen Reader Accessibility Mode by accessing the keybindings editor with {1} and run it.",s,r):s}return o.get(4)}function Qv(o){let e=0,t=-1;do{if(t=o.indexOf(`
`,t+1),t===-1)break;e++}while(!0);return e}var Yo=!1,li=class o{constructor(e,t,n,i,r){this.value=e;this.selectionStart=t;this.selectionEnd=n;this.selection=i;this.newlineCountBeforeSelection=r}static EMPTY=new o("",0,0,null,void 0);toString(){return`[ <${this.value}>, selectionStart: ${this.selectionStart}, selectionEnd: ${this.selectionEnd}]`}static readFromTextArea(e,t){let n=e.getValue(),i=e.getSelectionStart(),r=e.getSelectionEnd(),s;if(t){let a=n.substring(0,i),l=t.value.substring(0,t.selectionStart);a===l&&(s=t.newlineCountBeforeSelection)}return new o(n,i,r,null,s)}collapseSelection(){return this.selectionStart===this.value.length?this:new o(this.value,this.value.length,this.value.length,null,void 0)}writeToTextArea(e,t,n){Yo&&console.log(`writeToTextArea ${e}: ${this.toString()}`),t.setValue(e,this.value),n&&t.setSelectionRange(e,this.selectionStart,this.selectionEnd)}deduceEditorPosition(e){if(e<=this.selectionStart){let i=this.value.substring(e,this.selectionStart);return this._finishDeduceEditorPosition(this.selection?.getStartPosition()??null,i,-1)}if(e>=this.selectionEnd){let i=this.value.substring(this.selectionEnd,e);return this._finishDeduceEditorPosition(this.selection?.getEndPosition()??null,i,1)}let t=this.value.substring(this.selectionStart,e);if(t.indexOf("\u2026")===-1)return this._finishDeduceEditorPosition(this.selection?.getStartPosition()??null,t,1);let n=this.value.substring(e,this.selectionEnd);return this._finishDeduceEditorPosition(this.selection?.getEndPosition()??null,n,-1)}_finishDeduceEditorPosition(e,t,n){let i=0,r=-1;for(;(r=t.indexOf(`
`,r+1))!==-1;)i++;return[e,n*t.length,i]}static deduceInput(e,t,n){if(!e)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0};Yo&&(console.log("------------------------deduceInput"),console.log(`PREVIOUS STATE: ${e.toString()}`),console.log(`CURRENT STATE: ${t.toString()}`));let i=Math.min(mf(e.value,t.value),e.selectionStart,t.selectionStart),r=Math.min(gf(e.value,t.value),e.value.length-e.selectionEnd,t.value.length-t.selectionEnd),s=e.value.substring(i,e.value.length-r),a=t.value.substring(i,t.value.length-r),l=e.selectionStart-i,d=e.selectionEnd-i,c=t.selectionStart-i,u=t.selectionEnd-i;if(Yo&&(console.log(`AFTER DIFFING PREVIOUS STATE: <${s}>, selectionStart: ${l}, selectionEnd: ${d}`),console.log(`AFTER DIFFING CURRENT STATE: <${a}>, selectionStart: ${c}, selectionEnd: ${u}`)),c===u){let h=e.selectionStart-i;return Yo&&console.log(`REMOVE PREVIOUS: ${h} chars`),{text:a,replacePrevCharCnt:h,replaceNextCharCnt:0,positionDelta:0}}let p=d-l;return{text:a,replacePrevCharCnt:p,replaceNextCharCnt:0,positionDelta:0}}static deduceAndroidCompositionInput(e,t){if(!e)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0};if(Yo&&(console.log("------------------------deduceAndroidCompositionInput"),console.log(`PREVIOUS STATE: ${e.toString()}`),console.log(`CURRENT STATE: ${t.toString()}`)),e.value===t.value)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:t.selectionEnd-e.selectionEnd};let n=Math.min(mf(e.value,t.value),e.selectionEnd),i=Math.min(gf(e.value,t.value),e.value.length-e.selectionEnd),r=e.value.substring(n,e.value.length-i),s=t.value.substring(n,t.value.length-i),a=e.selectionStart-n,l=e.selectionEnd-n,d=t.selectionStart-n,c=t.selectionEnd-n;return Yo&&(console.log(`AFTER DIFFING PREVIOUS STATE: <${r}>, selectionStart: ${a}, selectionEnd: ${l}`),console.log(`AFTER DIFFING CURRENT STATE: <${s}>, selectionStart: ${d}, selectionEnd: ${c}`)),{text:s,replacePrevCharCnt:l,replaceNextCharCnt:r.length-l,positionDelta:c-s.length}}static fromScreenReaderContentState(e){return new o(e.value,e.selectionStart,e.selectionEnd,e.selection,e.newlineCountBeforeSelection)}};var gw;(e=>e.Tap="-monaco-textarea-synthetic-tap")(gw||={});var oO=class{_lastTypeTextLength;constructor(){this._lastTypeTextLength=0}handleCompositionUpdate(e){e=e||"";let t={text:e,replacePrevCharCnt:this._lastTypeTextLength,replaceNextCharCnt:0,positionDelta:0};return this._lastTypeTextLength=e.length,t}},sg=class extends F{constructor(t,n,i,r,s,a){super();this._host=t;this._textArea=n;this._OS=i;this._browser=r;this._accessibilityService=s;this._logService=a;this._asyncTriggerCut=this._register(new nn(()=>this._onCut.fire(),0)),this._textAreaState=li.EMPTY,this._selectionChangeListener=null,this._accessibilityService.isScreenReaderOptimized()&&this.writeNativeTextAreaContent("ctor"),this._register(q.runAndSubscribe(this._accessibilityService.onDidChangeScreenReaderOptimized,()=>{this._accessibilityService.isScreenReaderOptimized()&&!this._asyncFocusGainWriteScreenReaderContent.value?this._asyncFocusGainWriteScreenReaderContent.value=this._register(new nn(()=>this.writeNativeTextAreaContent("asyncFocusGain"),0)):this._asyncFocusGainWriteScreenReaderContent.clear()})),this._hasFocus=!1,this._currentComposition=null;let l=null;this._register(this._textArea.onKeyDown(d=>{let c=new mt(d);(c.keyCode===114||this._currentComposition&&c.keyCode===1)&&c.stopPropagation(),c.equals(9)&&c.preventDefault(),l=c,this._onKeyDown.fire(c)})),this._register(this._textArea.onKeyUp(d=>{let c=new mt(d);this._onKeyUp.fire(c)})),this._register(this._textArea.onCompositionStart(d=>{Yo&&console.log("[compositionstart]",d);let c=new oO;if(this._currentComposition){this._currentComposition=c;return}if(this._currentComposition=c,this._OS===2&&l&&l.equals(114)&&this._textAreaState.selectionStart===this._textAreaState.selectionEnd&&this._textAreaState.selectionStart>0&&this._textAreaState.value.substr(this._textAreaState.selectionStart-1,1)===d.data&&(l.code==="ArrowRight"||l.code==="ArrowLeft")){Yo&&console.log("[compositionstart] Handling long press case on macOS + arrow key",d),c.handleCompositionUpdate("x"),this._onCompositionStart.fire({data:d.data});return}if(this._browser.isAndroid){this._onCompositionStart.fire({data:d.data});return}this._onCompositionStart.fire({data:d.data})})),this._register(this._textArea.onCompositionUpdate(d=>{Yo&&console.log("[compositionupdate]",d);let c=this._currentComposition;if(!c)return;if(this._browser.isAndroid){let p=li.readFromTextArea(this._textArea,this._textAreaState),h=li.deduceAndroidCompositionInput(this._textAreaState,p);this._textAreaState=p,this._onType.fire(h),this._onCompositionUpdate.fire(d);return}let u=c.handleCompositionUpdate(d.data);this._textAreaState=li.readFromTextArea(this._textArea,this._textAreaState),this._onType.fire(u),this._onCompositionUpdate.fire(d)})),this._register(this._textArea.onCompositionEnd(d=>{Yo&&console.log("[compositionend]",d);let c=this._currentComposition;if(!c)return;if(this._currentComposition=null,this._browser.isAndroid){let p=li.readFromTextArea(this._textArea,this._textAreaState),h=li.deduceAndroidCompositionInput(this._textAreaState,p);this._textAreaState=p,this._onType.fire(h),this._onCompositionEnd.fire();return}let u=c.handleCompositionUpdate(d.data);this._textAreaState=li.readFromTextArea(this._textArea,this._textAreaState),this._onType.fire(u),this._onCompositionEnd.fire()})),this._register(this._textArea.onInput(d=>{if(Yo&&console.log("[input]",d),this._textArea.setIgnoreSelectionChangeTime("received input event"),this._currentComposition)return;let c=li.readFromTextArea(this._textArea,this._textAreaState),u=li.deduceInput(this._textAreaState,c,this._OS===2);u.replacePrevCharCnt===0&&u.text.length===1&&(ln(u.text.charCodeAt(0))||u.text.charCodeAt(0)===127)||(this._textAreaState=c,(u.text!==""||u.replacePrevCharCnt!==0||u.replaceNextCharCnt!==0||u.positionDelta!==0)&&this._onType.fire(u))})),this._register(this._textArea.onCut(d=>{this._textArea.setIgnoreSelectionChangeTime("received cut event"),this._ensureClipboardGetsEditorSelection(d),this._asyncTriggerCut.schedule()})),this._register(this._textArea.onCopy(d=>{this._ensureClipboardGetsEditorSelection(d)})),this._register(this._textArea.onPaste(d=>{if(this._textArea.setIgnoreSelectionChangeTime("received paste event"),d.preventDefault(),!d.clipboardData)return;let[c,u]=q4.getTextData(d.clipboardData);c&&(u=u||gp.INSTANCE.get(c),this._onPaste.fire({text:c,metadata:u}))})),this._register(this._textArea.onFocus(()=>{let d=this._hasFocus;this._setHasFocus(!0),this._accessibilityService.isScreenReaderOptimized()&&this._browser.isSafari&&!d&&this._hasFocus&&(this._asyncFocusGainWriteScreenReaderContent.value||(this._asyncFocusGainWriteScreenReaderContent.value=new nn(()=>this.writeNativeTextAreaContent("asyncFocusGain"),0)),this._asyncFocusGainWriteScreenReaderContent.value.schedule())})),this._register(this._textArea.onBlur(()=>{this._currentComposition&&(this._currentComposition=null,this.writeNativeTextAreaContent("blurWithoutCompositionEnd"),this._onCompositionEnd.fire()),this._setHasFocus(!1)})),this._register(this._textArea.onSyntheticTap(()=>{this._browser.isAndroid&&this._currentComposition&&(this._currentComposition=null,this.writeNativeTextAreaContent("tapWithoutCompositionEnd"),this._onCompositionEnd.fire())}))}_onFocus=this._register(new D);onFocus=this._onFocus.event;_onBlur=this._register(new D);onBlur=this._onBlur.event;_onKeyDown=this._register(new D);onKeyDown=this._onKeyDown.event;_onKeyUp=this._register(new D);onKeyUp=this._onKeyUp.event;_onCut=this._register(new D);onCut=this._onCut.event;_onPaste=this._register(new D);onPaste=this._onPaste.event;_onType=this._register(new D);onType=this._onType.event;_onCompositionStart=this._register(new D);onCompositionStart=this._onCompositionStart.event;_onCompositionUpdate=this._register(new D);onCompositionUpdate=this._onCompositionUpdate.event;_onCompositionEnd=this._register(new D);onCompositionEnd=this._onCompositionEnd.event;_onSelectionChangeRequest=this._register(new D);onSelectionChangeRequest=this._onSelectionChangeRequest.event;_asyncTriggerCut;_asyncFocusGainWriteScreenReaderContent=this._register(new un);_textAreaState;get textAreaState(){return this._textAreaState}_selectionChangeListener;_hasFocus;_currentComposition;_initializeFromTest(){this._hasFocus=!0,this._textAreaState=li.readFromTextArea(this._textArea,null)}_installSelectionChangeListener(){let t=0;return j(this._textArea.ownerDocument,"selectionchange",n=>{if(jl.onSelectionChange(),!this._hasFocus||this._currentComposition||!this._browser.isChrome)return;let i=Date.now(),r=i-t;if(t=i,r<5)return;let s=i-this._textArea.getIgnoreSelectionChangeTime();if(this._textArea.resetSelectionChangeTime(),s<100||!this._textAreaState.selection)return;let a=this._textArea.getValue();if(this._textAreaState.value!==a)return;let l=this._textArea.getSelectionStart(),d=this._textArea.getSelectionEnd();if(this._textAreaState.selectionStart===l&&this._textAreaState.selectionEnd===d)return;let c=this._textAreaState.deduceEditorPosition(l),u=this._host.deduceModelPosition(c[0],c[1],c[2]),p=this._textAreaState.deduceEditorPosition(d),h=this._host.deduceModelPosition(p[0],p[1],p[2]),f=new $e(u.lineNumber,u.column,h.lineNumber,h.column);this._onSelectionChangeRequest.fire(f)})}dispose(){super.dispose(),this._selectionChangeListener&&(this._selectionChangeListener.dispose(),this._selectionChangeListener=null)}focusTextArea(){this._setHasFocus(!0),this.refreshFocusState()}isFocused(){return this._hasFocus}refreshFocusState(){this._setHasFocus(this._textArea.hasFocus())}_setHasFocus(t){this._hasFocus!==t&&(this._hasFocus=t,this._selectionChangeListener&&(this._selectionChangeListener.dispose(),this._selectionChangeListener=null),this._hasFocus&&(this._selectionChangeListener=this._installSelectionChangeListener()),this._hasFocus&&this.writeNativeTextAreaContent("focusgain"),this._hasFocus?this._onFocus.fire():this._onBlur.fire())}_setAndWriteTextAreaState(t,n){this._hasFocus||(n=n.collapseSelection()),n.writeToTextArea(t,this._textArea,this._hasFocus),this._textAreaState=n}writeNativeTextAreaContent(t){!this._accessibilityService.isScreenReaderOptimized()&&t==="render"||this._currentComposition||(this._logService.trace(`writeTextAreaState(reason: ${t})`),this._setAndWriteTextAreaState(t,this._host.getScreenReaderContent()))}_ensureClipboardGetsEditorSelection(t){let n=this._host.getDataToCopy(),i={version:1,isFromEmptySelection:n.isFromEmptySelection,multicursorText:n.multicursorText,mode:n.mode};gp.INSTANCE.set(this._browser.isFirefox?n.text.replace(/\r\n/g,`
`):n.text,i),t.preventDefault(),t.clipboardData&&q4.setTextData(t.clipboardData,n.text,n.html,i)}};sg=O([x(4,vo),x(5,Gt)],sg);var q4={getTextData(o){let e=o.getData(mu.text),t=null,n=o.getData("vscode-editor-data");if(typeof n=="string")try{t=JSON.parse(n),t.version!==1&&(t=null)}catch{}return e.length===0&&t===null&&o.files.length>0?[Array.prototype.slice.call(o.files,0).map(r=>r.name).join(`
`),null]:[e,t]},setTextData(o,e,t,n){o.setData(mu.text,e),typeof t=="string"&&o.setData("text/html",t),o.setData("vscode-editor-data",JSON.stringify(n))}},mw=class extends F{constructor(t){super();this._actual=t;this._ignoreSelectionChangeTime=0,this._register(this.onKeyDown(()=>jl.onKeyDown())),this._register(this.onBeforeInput(()=>jl.onBeforeInput())),this._register(this.onInput(()=>jl.onInput())),this._register(this.onKeyUp(()=>jl.onKeyUp())),this._register(j(this._actual,gw.Tap,()=>this._onSyntheticTap.fire()))}onKeyDown=this._register(new Ae(this._actual,"keydown")).event;onKeyPress=this._register(new Ae(this._actual,"keypress")).event;onKeyUp=this._register(new Ae(this._actual,"keyup")).event;onCompositionStart=this._register(new Ae(this._actual,"compositionstart")).event;onCompositionUpdate=this._register(new Ae(this._actual,"compositionupdate")).event;onCompositionEnd=this._register(new Ae(this._actual,"compositionend")).event;onBeforeInput=this._register(new Ae(this._actual,"beforeinput")).event;onInput=this._register(new Ae(this._actual,"input")).event;onCut=this._register(new Ae(this._actual,"cut")).event;onCopy=this._register(new Ae(this._actual,"copy")).event;onPaste=this._register(new Ae(this._actual,"paste")).event;onFocus=this._register(new Ae(this._actual,"focus")).event;onBlur=this._register(new Ae(this._actual,"blur")).event;get ownerDocument(){return this._actual.ownerDocument}_onSyntheticTap=this._register(new D);onSyntheticTap=this._onSyntheticTap.event;_ignoreSelectionChangeTime;hasFocus(){let t=Yd(this._actual);return t?t.activeElement===this._actual:this._actual.isConnected?Io()===this._actual:!1}setIgnoreSelectionChangeTime(t){this._ignoreSelectionChangeTime=Date.now()}getIgnoreSelectionChangeTime(){return this._ignoreSelectionChangeTime}resetSelectionChangeTime(){this._ignoreSelectionChangeTime=0}getValue(){return this._actual.value}setValue(t,n){let i=this._actual;i.value!==n&&(this.setIgnoreSelectionChangeTime("setValue"),i.value=n)}getSelectionStart(){return this._actual.selectionDirection==="backward"?this._actual.selectionEnd:this._actual.selectionStart}getSelectionEnd(){return this._actual.selectionDirection==="backward"?this._actual.selectionStart:this._actual.selectionEnd}setSelectionRange(t,n,i){let r=this._actual,s=null,a=Yd(r);a?s=a.activeElement:s=Io();let l=Ce(s),d=s===r,c=r.selectionStart,u=r.selectionEnd;if(d&&c===n&&u===i){Gn&&l.parent!==l&&r.focus();return}if(d){this.setIgnoreSelectionChangeTime("setSelectionRange"),r.setSelectionRange(n,i),Gn&&l.parent!==l&&r.focus();return}try{let p=DV(r);this.setIgnoreSelectionChangeTime("setSelectionRange"),r.focus(),r.setSelectionRange(n,i),LV(r,p)}catch{}}};var rO=class extends og{_lastPointerType;constructor(e,t,n){super(e,t,n),this._register(An.addTarget(this.viewHelper.linesContentDomNode)),this._register(j(this.viewHelper.linesContentDomNode,Et.Tap,r=>this.onTap(r))),this._register(j(this.viewHelper.linesContentDomNode,Et.Change,r=>this.onChange(r))),this._register(j(this.viewHelper.linesContentDomNode,Et.Contextmenu,r=>this._onContextMenu(new cs(r,!1,this.viewHelper.viewDomNode),!1))),this._lastPointerType="mouse",this._register(j(this.viewHelper.linesContentDomNode,"pointerdown",r=>{let s=r.pointerType;if(s==="mouse"){this._lastPointerType="mouse";return}else s==="touch"?this._lastPointerType="touch":this._lastPointerType="pen"}));let i=new Dx(this.viewHelper.viewDomNode);this._register(i.onPointerMove(this.viewHelper.viewDomNode,r=>this._onMouseMove(r))),this._register(i.onPointerUp(this.viewHelper.viewDomNode,r=>this._onMouseUp(r))),this._register(i.onPointerLeave(this.viewHelper.viewDomNode,r=>this._onMouseLeave(r))),this._register(i.onPointerDown(this.viewHelper.viewDomNode,(r,s)=>this._onMouseDown(r,s)))}onTap(e){!e.initialTarget||!this.viewHelper.linesContentDomNode.contains(e.initialTarget)||(e.preventDefault(),this.viewHelper.focusTextArea(),this._dispatchGesture(e,!1))}onChange(e){this._lastPointerType==="touch"&&this._context.viewModel.viewLayout.deltaScrollNow(-e.translationX,-e.translationY),this._lastPointerType==="pen"&&this._dispatchGesture(e,!0)}_dispatchGesture(e,t){let n=this._createMouseTarget(new cs(e,!1,this.viewHelper.viewDomNode),!1);n.position&&this.viewController.dispatchMouse({position:n.position,mouseColumn:n.position.column,startedOnLineNumbers:!1,revealType:1,mouseDownCount:e.tapCount,inSelectionMode:t,altKey:!1,ctrlKey:!1,metaKey:!1,shiftKey:!1,leftButton:!1,middleButton:!1,onInjectedText:n.type===6&&n.detail.injectedText!==null})}_onMouseDown(e,t){e.browserEvent.pointerType!=="touch"&&super._onMouseDown(e,t)}},sO=class extends og{constructor(e,t,n){super(e,t,n),this._register(An.addTarget(this.viewHelper.linesContentDomNode)),this._register(j(this.viewHelper.linesContentDomNode,Et.Tap,i=>this.onTap(i))),this._register(j(this.viewHelper.linesContentDomNode,Et.Change,i=>this.onChange(i))),this._register(j(this.viewHelper.linesContentDomNode,Et.Contextmenu,i=>this._onContextMenu(new cs(i,!1,this.viewHelper.viewDomNode),!1)))}onTap(e){e.preventDefault(),this.viewHelper.focusTextArea();let t=this._createMouseTarget(new cs(e,!1,this.viewHelper.viewDomNode),!1);if(t.position){let n=document.createEvent("CustomEvent");n.initEvent(gw.Tap,!1,!0),this.viewHelper.dispatchTextAreaEvent(n),this.viewController.moveTo(t.position,1)}}onChange(e){this._context.viewModel.viewLayout.deltaScrollNow(-e.translationX,-e.translationY)}},fw=class extends F{handler;constructor(e,t,n){super(),(jr||Ny&&ky)&&lS.pointerEvents?this.handler=this._register(new rO(e,t,n)):Ne.TouchEvent?this.handler=this._register(new sO(e,t,n)):this.handler=this._register(new og(e,t,n))}getTargetAtClientPoint(e,t){return this.handler.getTargetAtClientPoint(e,t)}};var _o=class extends as{};var bw=class extends Yt{_visibleLines;domNode;_dynamicOverlays=[];_isFocused=!1;constructor(e){super(e),this._visibleLines=new Um({createLine:()=>new aO(this._dynamicOverlays)}),this.domNode=this._visibleLines.domNode;let n=this._context.configuration.options.get(51);on(this.domNode,n),this.domNode.setClassName("view-overlays")}shouldRender(){if(super.shouldRender())return!0;for(let e=0,t=this._dynamicOverlays.length;e<t;e++)if(this._dynamicOverlays[e].shouldRender())return!0;return!1}dispose(){super.dispose();for(let e=0,t=this._dynamicOverlays.length;e<t;e++)this._dynamicOverlays[e].dispose();this._dynamicOverlays=[]}getDomNode(){return this.domNode}addDynamicOverlay(e){this._dynamicOverlays.push(e)}onConfigurationChanged(e){this._visibleLines.onConfigurationChanged(e);let n=this._context.configuration.options.get(51);return on(this.domNode,n),!0}onFlushed(e){return this._visibleLines.onFlushed(e)}onFocusChanged(e){return this._isFocused=e.isFocused,!0}onLinesChanged(e){return this._visibleLines.onLinesChanged(e)}onLinesDeleted(e){return this._visibleLines.onLinesDeleted(e)}onLinesInserted(e){return this._visibleLines.onLinesInserted(e)}onScrollChanged(e){return this._visibleLines.onScrollChanged(e)||!0}onTokensChanged(e){return this._visibleLines.onTokensChanged(e)}onZonesChanged(e){return this._visibleLines.onZonesChanged(e)}prepareRender(e){let t=this._dynamicOverlays.filter(n=>n.shouldRender());for(let n=0,i=t.length;n<i;n++){let r=t[n];r.prepareRender(e),r.onDidRender()}}render(e){this._viewOverlaysRender(e),this.domNode.toggleClassName("focused",this._isFocused)}_viewOverlaysRender(e){this._visibleLines.renderLines(e.viewportData)}},aO=class{_dynamicOverlays;_domNode;_renderedContent;constructor(e){this._dynamicOverlays=e,this._domNode=null,this._renderedContent=null}getDomNode(){return this._domNode?this._domNode.domNode:null}setDomNode(e){this._domNode=We(e)}onContentChanged(){}onTokensChanged(){}renderLine(e,t,n,i,r){let s="";for(let a=0,l=this._dynamicOverlays.length;a<l;a++){let d=this._dynamicOverlays[a];s+=d.render(i.startLineNumber,e)}return this._renderedContent===s?!1:(this._renderedContent=s,r.appendString('<div style="top:'),r.appendString(String(t)),r.appendString("px;height:"),r.appendString(String(n)),r.appendString('px;">'),r.appendString(s),r.appendString("</div>"),!0)}layoutLine(e,t,n){this._domNode&&(this._domNode.setTop(t),this._domNode.setHeight(n))}},vw=class extends bw{_contentWidth;constructor(e){super(e);let n=this._context.configuration.options.get(147);this._contentWidth=n.contentWidth,this.domNode.setHeight(0)}onConfigurationChanged(e){let n=this._context.configuration.options.get(147);return this._contentWidth=n.contentWidth,super.onConfigurationChanged(e)||!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollWidthChanged}_viewOverlaysRender(e){super._viewOverlaysRender(e),this.domNode.setWidth(Math.max(e.scrollWidth,this._contentWidth))}},yw=class extends bw{_contentLeft;constructor(e){super(e);let t=this._context.configuration.options,n=t.get(147);this._contentLeft=n.contentLeft,this.domNode.setClassName("margin-view-overlays"),this.domNode.setWidth(1),on(this.domNode,t.get(51))}onConfigurationChanged(e){let t=this._context.configuration.options;on(this.domNode,t.get(51));let n=t.get(147);return this._contentLeft=n.contentLeft,super.onConfigurationChanged(e)||!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollHeightChanged}_viewOverlaysRender(e){super._viewOverlaysRender(e);let t=Math.min(e.scrollHeight,1e6);this.domNode.setHeight(t),this.domNode.setWidth(this._contentLeft)}};var Iw=class extends Yt{domNode;blocks=[];contentWidth=-1;contentLeft=0;constructor(e){super(e),this.domNode=We(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.domNode.setClassName("blockDecorations-container"),this.update()}update(){let e=!1,n=this._context.configuration.options.get(147),i=n.contentWidth-n.verticalScrollbarWidth;this.contentWidth!==i&&(this.contentWidth=i,e=!0);let r=n.contentLeft;return this.contentLeft!==r&&(this.contentLeft=r,e=!0),e}dispose(){super.dispose()}onConfigurationChanged(e){return this.update()}onScrollChanged(e){return e.scrollTopChanged||e.scrollLeftChanged}onDecorationsChanged(e){return!0}onZonesChanged(e){return!0}prepareRender(e){}render(e){let t=0,n=e.getDecorationsInViewport();for(let i of n){if(!i.options.blockClassName)continue;let r=this.blocks[t];r||(r=this.blocks[t]=We(document.createElement("div")),this.domNode.appendChild(r));let s,a;i.options.blockIsAfterEnd?(s=e.getVerticalOffsetAfterLineNumber(i.range.endLineNumber,!1),a=e.getVerticalOffsetAfterLineNumber(i.range.endLineNumber,!0)):(s=e.getVerticalOffsetForLineNumber(i.range.startLineNumber,!0),a=i.range.isEmpty()&&!i.options.blockDoesNotCollapse?e.getVerticalOffsetForLineNumber(i.range.startLineNumber,!1):e.getVerticalOffsetAfterLineNumber(i.range.endLineNumber,!0));let[l,d,c,u]=i.options.blockPadding??[0,0,0,0];r.setClassName("blockDecorations-block "+i.options.blockClassName),r.setLeft(this.contentLeft-u),r.setWidth(this.contentWidth+u+d),r.setTop(s-e.scrollTop-l),r.setHeight(a-s+l+c),t++}for(let i=t;i<this.blocks.length;i++)this.blocks[i].domNode.remove();this.blocks.length=t}};var Cw=class extends Yt{_viewDomNode;_widgets;domNode;overflowingContentWidgetsDomNode;constructor(e,t){super(e),this._viewDomNode=t,this._widgets={},this.domNode=We(document.createElement("div")),ri.write(this.domNode,1),this.domNode.setClassName("contentWidgets"),this.domNode.setPosition("absolute"),this.domNode.setTop(0),this.overflowingContentWidgetsDomNode=We(document.createElement("div")),ri.write(this.overflowingContentWidgetsDomNode,2),this.overflowingContentWidgetsDomNode.setClassName("overflowingContentWidgets")}dispose(){super.dispose(),this._widgets={}}onConfigurationChanged(e){let t=Object.keys(this._widgets);for(let n of t)this._widgets[n].onConfigurationChanged(e);return!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLineMappingChanged(e){return this._updateAnchorsViewPositions(),!0}onLinesChanged(e){return this._updateAnchorsViewPositions(),!0}onLinesDeleted(e){return this._updateAnchorsViewPositions(),!0}onLinesInserted(e){return this._updateAnchorsViewPositions(),!0}onScrollChanged(e){return!0}onZonesChanged(e){return!0}_updateAnchorsViewPositions(){let e=Object.keys(this._widgets);for(let t of e)this._widgets[t].updateAnchorViewPosition()}addWidget(e){let t=new dO(this._context,this._viewDomNode,e);this._widgets[t.id]=t,t.allowEditorOverflow?this.overflowingContentWidgetsDomNode.appendChild(t.domNode):this.domNode.appendChild(t.domNode),this.setShouldRender()}setWidgetPosition(e,t,n,i,r){this._widgets[e.getId()].setPosition(t,n,i,r),this.setShouldRender()}removeWidget(e){let t=e.getId();if(this._widgets.hasOwnProperty(t)){let n=this._widgets[t];delete this._widgets[t];let i=n.domNode.domNode;i.remove(),i.removeAttribute("monaco-visible-content-widget"),this.setShouldRender()}}shouldSuppressMouseDownOnWidget(e){return this._widgets.hasOwnProperty(e)?this._widgets[e].suppressMouseDown:!1}onBeforeRender(e){let t=Object.keys(this._widgets);for(let n of t)this._widgets[n].onBeforeRender(e)}prepareRender(e){let t=Object.keys(this._widgets);for(let n of t)this._widgets[n].prepareRender(e)}render(e){let t=Object.keys(this._widgets);for(let n of t)this._widgets[n].render(e)}},dO=class{_context;_viewDomNode;_actual;domNode;id;allowEditorOverflow;suppressMouseDown;_fixedOverflowWidgets;_contentWidth;_contentLeft;_lineHeight;_primaryAnchor=new fp(null,null);_secondaryAnchor=new fp(null,null);_affinity;_preference;_cachedDomNodeOffsetWidth;_cachedDomNodeOffsetHeight;_maxWidth;_isVisible;_renderData;constructor(e,t,n){this._context=e,this._viewDomNode=t,this._actual=n,this.domNode=We(this._actual.getDomNode()),this.id=this._actual.getId(),this.allowEditorOverflow=this._actual.allowEditorOverflow||!1,this.suppressMouseDown=this._actual.suppressMouseDown||!1;let i=this._context.configuration.options,r=i.get(147);this._fixedOverflowWidgets=i.get(43),this._contentWidth=r.contentWidth,this._contentLeft=r.contentLeft,this._lineHeight=i.get(68),this._affinity=null,this._preference=[],this._cachedDomNodeOffsetWidth=-1,this._cachedDomNodeOffsetHeight=-1,this._maxWidth=this._getMaxWidth(),this._isVisible=!1,this._renderData=null,this.domNode.setPosition(this._fixedOverflowWidgets&&this.allowEditorOverflow?"fixed":"absolute"),this.domNode.setDisplay("none"),this.domNode.setVisibility("hidden"),this.domNode.setAttribute("widgetId",this.id),this.domNode.setMaxWidth(this._maxWidth)}onConfigurationChanged(e){let t=this._context.configuration.options;if(this._lineHeight=t.get(68),e.hasChanged(147)){let n=t.get(147);this._contentLeft=n.contentLeft,this._contentWidth=n.contentWidth,this._maxWidth=this._getMaxWidth()}}updateAnchorViewPosition(){this._setPosition(this._affinity,this._primaryAnchor.modelPosition,this._secondaryAnchor.modelPosition)}_setPosition(e,t,n){this._affinity=e,this._primaryAnchor=i(t,this._context.viewModel,this._affinity),this._secondaryAnchor=i(n,this._context.viewModel,this._affinity);function i(r,s,a){if(!r)return new fp(null,null);let l=s.model.validatePosition(r);if(s.coordinatesConverter.modelPositionIsVisible(l)){let d=s.coordinatesConverter.convertModelPositionToViewPosition(l,a??void 0);return new fp(r,d)}return new fp(r,null)}}_getMaxWidth(){let e=this.domNode.domNode.ownerDocument,t=e.defaultView;return this.allowEditorOverflow?t?.innerWidth||e.documentElement.offsetWidth||e.body.offsetWidth:this._contentWidth}setPosition(e,t,n,i){this._setPosition(i,e,t),this._preference=n,this._primaryAnchor.viewPosition&&this._preference&&this._preference.length>0?this.domNode.setDisplay("block"):this.domNode.setDisplay("none"),this._cachedDomNodeOffsetWidth=-1,this._cachedDomNodeOffsetHeight=-1}_layoutBoxInViewport(e,t,n,i){let r=e.top,s=r,a=e.top+e.height,l=i.viewportHeight-a,d=r-n,c=s>=n,u=a,p=l>=n,h=e.left;return h+t>i.scrollLeft+i.viewportWidth&&(h=i.scrollLeft+i.viewportWidth-t),h<i.scrollLeft&&(h=i.scrollLeft),{fitsAbove:c,aboveTop:d,fitsBelow:p,belowTop:u,left:h}}_layoutHorizontalSegmentInPage(e,t,n,i){let a=Math.max(15,t.left-i),l=Math.min(t.left+t.width+i,e.width-15),c=this._viewDomNode.domNode.ownerDocument.defaultView,u=t.left+n-(c?.scrollX??0);if(u+i>l){let p=u-(l-i);u-=p,n-=p}if(u<a){let p=u-a;u-=p,n-=p}return[n,u]}_layoutBoxInPage(e,t,n,i){let r=e.top-n,s=e.top+e.height,a=io(this._viewDomNode.domNode),l=this._viewDomNode.domNode.ownerDocument,d=l.defaultView,c=a.top+r-(d?.scrollY??0),u=a.top+s-(d?.scrollY??0),p=Su(l.body),[h,f]=this._layoutHorizontalSegmentInPage(p,a,e.left-i.scrollLeft+this._contentLeft,t),g=22,b=22,v=c>=g,y=u+n<=p.height-b;return this._fixedOverflowWidgets?{fitsAbove:v,aboveTop:Math.max(c,g),fitsBelow:y,belowTop:u,left:f}:{fitsAbove:v,aboveTop:r,fitsBelow:y,belowTop:s,left:h}}_prepareRenderWidgetAtExactPositionOverflowing(e){return new bp(e.top,e.left+this._contentLeft)}_getAnchorsCoordinates(e){let t=r(this._primaryAnchor.viewPosition,this._affinity,this._lineHeight),n=this._secondaryAnchor.viewPosition?.lineNumber===this._primaryAnchor.viewPosition?.lineNumber?this._secondaryAnchor.viewPosition:null,i=r(n,this._affinity,this._lineHeight);return{primary:t,secondary:i};function r(s,a,l){if(!s)return null;let d=e.visibleRangeForPosition(s);if(!d)return null;let c=s.column===1&&a===3?0:d.left,u=e.getVerticalOffsetForLineNumber(s.lineNumber)-e.scrollTop;return new Sw(u,c,l)}}_reduceAnchorCoordinates(e,t,n){if(!t)return e;let i=this._context.configuration.options.get(51),r=t.left;return r<e.left?r=Math.max(r,e.left-n+i.typicalFullwidthCharacterWidth):r=Math.min(r,e.left+n-i.typicalFullwidthCharacterWidth),new Sw(e.top,r,e.height)}_prepareRenderWidget(e){if(!this._preference||this._preference.length===0)return null;let{primary:t,secondary:n}=this._getAnchorsCoordinates(e);if(!t)return{kind:"offViewport",preserveFocus:this.domNode.domNode.contains(this.domNode.domNode.ownerDocument.activeElement)};if(this._cachedDomNodeOffsetWidth===-1||this._cachedDomNodeOffsetHeight===-1){let s=null;if(typeof this._actual.beforeRender=="function"&&(s=lO(this._actual.beforeRender,this._actual)),s)this._cachedDomNodeOffsetWidth=s.width,this._cachedDomNodeOffsetHeight=s.height;else{let l=this.domNode.domNode.getBoundingClientRect();this._cachedDomNodeOffsetWidth=Math.round(l.width),this._cachedDomNodeOffsetHeight=Math.round(l.height)}}let i=this._reduceAnchorCoordinates(t,n,this._cachedDomNodeOffsetWidth),r;this.allowEditorOverflow?r=this._layoutBoxInPage(i,this._cachedDomNodeOffsetWidth,this._cachedDomNodeOffsetHeight,e):r=this._layoutBoxInViewport(i,this._cachedDomNodeOffsetWidth,this._cachedDomNodeOffsetHeight,e);for(let s=1;s<=2;s++)for(let a of this._preference)if(a===1){if(!r)return null;if(s===2||r.fitsAbove)return{kind:"inViewport",coordinate:new bp(r.aboveTop,r.left),position:1}}else if(a===2){if(!r)return null;if(s===2||r.fitsBelow)return{kind:"inViewport",coordinate:new bp(r.belowTop,r.left),position:2}}else return this.allowEditorOverflow?{kind:"inViewport",coordinate:this._prepareRenderWidgetAtExactPositionOverflowing(new bp(i.top,i.left)),position:0}:{kind:"inViewport",coordinate:new bp(i.top,i.left),position:0};return null}onBeforeRender(e){!this._primaryAnchor.viewPosition||!this._preference||this._primaryAnchor.viewPosition.lineNumber<e.startLineNumber||this._primaryAnchor.viewPosition.lineNumber>e.endLineNumber||this.domNode.setMaxWidth(this._maxWidth)}prepareRender(e){this._renderData=this._prepareRenderWidget(e)}render(e){if(!this._renderData||this._renderData.kind==="offViewport"){this._isVisible&&(this.domNode.removeAttribute("monaco-visible-content-widget"),this._isVisible=!1,this._renderData?.kind==="offViewport"&&this._renderData.preserveFocus?this.domNode.setTop(-1e3):this.domNode.setVisibility("hidden")),typeof this._actual.afterRender=="function"&&lO(this._actual.afterRender,this._actual,null);return}this.allowEditorOverflow?(this.domNode.setTop(this._renderData.coordinate.top),this.domNode.setLeft(this._renderData.coordinate.left)):(this.domNode.setTop(this._renderData.coordinate.top+e.scrollTop-e.bigNumbersDelta),this.domNode.setLeft(this._renderData.coordinate.left)),this._isVisible||(this.domNode.setVisibility("inherit"),this.domNode.setAttribute("monaco-visible-content-widget","true"),this._isVisible=!0),typeof this._actual.afterRender=="function"&&lO(this._actual.afterRender,this._actual,this._renderData.position)}},fp=class{constructor(e,t){this.modelPosition=e;this.viewPosition=t}},bp=class{constructor(e,t){this.top=e;this.left=t}_coordinateBrand=void 0},Sw=class{constructor(e,t,n){this.top=e;this.left=t;this.height=n}_anchorCoordinateBrand=void 0};function lO(o,e,...t){try{return o.call(e,...t)}catch{return null}}var Ew=class extends _o{_context;_renderLineHighlight;_wordWrap;_contentLeft;_contentWidth;_selectionIsEmpty;_renderLineHighlightOnlyWhenFocus;_focused;_cursorLineNumbers;_selections;_renderData;constructor(e){super(),this._context=e;let t=this._context.configuration.options,n=t.get(147);this._renderLineHighlight=t.get(98),this._renderLineHighlightOnlyWhenFocus=t.get(99),this._wordWrap=n.isViewportWrapping,this._contentLeft=n.contentLeft,this._contentWidth=n.contentWidth,this._selectionIsEmpty=!0,this._focused=!1,this._cursorLineNumbers=[1],this._selections=[new $e(1,1,1,1)],this._renderData=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}_readFromSelections(){let e=!1,t=new Set;for(let r of this._selections)t.add(r.positionLineNumber);let n=Array.from(t);n.sort((r,s)=>r-s),zt(this._cursorLineNumbers,n)||(this._cursorLineNumbers=n,e=!0);let i=this._selections.every(r=>r.isEmpty());return this._selectionIsEmpty!==i&&(this._selectionIsEmpty=i,e=!0),e}onThemeChanged(e){return this._readFromSelections()}onConfigurationChanged(e){let t=this._context.configuration.options,n=t.get(147);return this._renderLineHighlight=t.get(98),this._renderLineHighlightOnlyWhenFocus=t.get(99),this._wordWrap=n.isViewportWrapping,this._contentLeft=n.contentLeft,this._contentWidth=n.contentWidth,!0}onCursorStateChanged(e){return this._selections=e.selections,this._readFromSelections()}onFlushed(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollWidthChanged||e.scrollTopChanged}onZonesChanged(e){return!0}onFocusChanged(e){return this._renderLineHighlightOnlyWhenFocus?(this._focused=e.isFocused,!0):!1}prepareRender(e){if(!this._shouldRenderThis()){this._renderData=null;return}let t=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber,i=[];for(let s=t;s<=n;s++){let a=s-t;i[a]=""}if(this._wordWrap){let s=this._renderOne(e,!1);for(let a of this._cursorLineNumbers){let l=this._context.viewModel.coordinatesConverter,d=l.convertViewPositionToModelPosition(new A(a,1)).lineNumber,c=l.convertModelPositionToViewPosition(new A(d,1)).lineNumber,u=l.convertModelPositionToViewPosition(new A(d,this._context.viewModel.model.getLineMaxColumn(d))).lineNumber,p=Math.max(c,t),h=Math.min(u,n);for(let f=p;f<=h;f++){let g=f-t;i[g]=s}}}let r=this._renderOne(e,!0);for(let s of this._cursorLineNumbers){if(s<t||s>n)continue;let a=s-t;i[a]=r}this._renderData=i}render(e,t){if(!this._renderData)return"";let n=t-e;return n>=this._renderData.length?"":this._renderData[n]}_shouldRenderInMargin(){return(this._renderLineHighlight==="gutter"||this._renderLineHighlight==="all")&&(!this._renderLineHighlightOnlyWhenFocus||this._focused)}_shouldRenderInContent(){return(this._renderLineHighlight==="line"||this._renderLineHighlight==="all")&&this._selectionIsEmpty&&(!this._renderLineHighlightOnlyWhenFocus||this._focused)}},Tw=class extends Ew{_renderOne(e,t){return`<div class="${"current-line"+(this._shouldRenderInMargin()?" current-line-both":"")+(t?" current-line-exact":"")}" style="width:${Math.max(e.scrollWidth,this._contentWidth)}px;"></div>`}_shouldRenderThis(){return this._shouldRenderInContent()}_shouldRenderOther(){return this._shouldRenderInMargin()}},xw=class extends Ew{_renderOne(e,t){return`<div class="${"current-line"+(this._shouldRenderInMargin()?" current-line-margin":"")+(this._shouldRenderOther()?" current-line-margin-both":"")+(this._shouldRenderInMargin()&&t?" current-line-exact-margin":"")}" style="width:${this._contentLeft}px"></div>`}_shouldRenderThis(){return!0}_shouldRenderOther(){return this._shouldRenderInContent()}};To((o,e)=>{let t=o.getColor(RM);if(t&&(e.addRule(`.monaco-editor .view-overlays .current-line { background-color: ${t}; }`),e.addRule(`.monaco-editor .margin-view-overlays .current-line-margin { background-color: ${t}; border: none; }`)),!t||t.isTransparent()||o.defines(kM)){let n=o.getColor(kM);n&&(e.addRule(`.monaco-editor .view-overlays .current-line-exact { border: 2px solid ${n}; }`),e.addRule(`.monaco-editor .margin-view-overlays .current-line-exact-margin { border: 2px solid ${n}; }`),tc(o.type)&&(e.addRule(".monaco-editor .view-overlays .current-line-exact { border-width: 1px; }"),e.addRule(".monaco-editor .margin-view-overlays .current-line-exact-margin { border-width: 1px; }")))}});var ww=class extends _o{_context;_typicalHalfwidthCharacterWidth;_renderResult;constructor(e){super(),this._context=e;let t=this._context.configuration.options;this._typicalHalfwidthCharacterWidth=t.get(51).typicalHalfwidthCharacterWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){let t=this._context.configuration.options;return this._typicalHalfwidthCharacterWidth=t.get(51).typicalHalfwidthCharacterWidth,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged||e.scrollWidthChanged}onZonesChanged(e){return!0}prepareRender(e){let t=e.getDecorationsInViewport(),n=[],i=0;for(let l=0,d=t.length;l<d;l++){let c=t[l];c.options.className&&(n[i++]=c)}n=n.sort((l,d)=>{if(l.options.zIndex<d.options.zIndex)return-1;if(l.options.zIndex>d.options.zIndex)return 1;let c=l.options.className,u=d.options.className;return c<u?-1:c>u?1:P.compareRangesUsingStarts(l.range,d.range)});let r=e.visibleRange.startLineNumber,s=e.visibleRange.endLineNumber,a=[];for(let l=r;l<=s;l++){let d=l-r;a[d]=""}this._renderWholeLineDecorations(e,n,a),this._renderNormalDecorations(e,n,a),this._renderResult=a}_renderWholeLineDecorations(e,t,n){let i=e.visibleRange.startLineNumber,r=e.visibleRange.endLineNumber;for(let s=0,a=t.length;s<a;s++){let l=t[s];if(!l.options.isWholeLine)continue;let d='<div class="cdr '+l.options.className+'" style="left:0;width:100%;"></div>',c=Math.max(l.range.startLineNumber,i),u=Math.min(l.range.endLineNumber,r);for(let p=c;p<=u;p++){let h=p-i;n[h]+=d}}}_renderNormalDecorations(e,t,n){let i=e.visibleRange.startLineNumber,r=null,s=!1,a=null,l=!1;for(let d=0,c=t.length;d<c;d++){let u=t[d];if(u.options.isWholeLine)continue;let p=u.options.className,h=!!u.options.showIfCollapsed,f=u.range;if(h&&f.endColumn===1&&f.endLineNumber!==f.startLineNumber&&(f=new P(f.startLineNumber,f.startColumn,f.endLineNumber-1,this._context.viewModel.getLineMaxColumn(f.endLineNumber-1))),r===p&&s===h&&P.areIntersectingOrTouching(a,f)){a=P.plusRange(a,f);continue}r!==null&&this._renderNormalDecoration(e,a,r,l,s,i,n),r=p,s=h,a=f,l=u.options.shouldFillLineOnLineBreak??!1}r!==null&&this._renderNormalDecoration(e,a,r,l,s,i,n)}_renderNormalDecoration(e,t,n,i,r,s,a){let l=e.linesVisibleRangesForRange(t,n==="findMatch");if(l)for(let d=0,c=l.length;d<c;d++){let u=l[d];if(u.outsideRenderedLine)continue;let p=u.lineNumber-s;if(r&&u.ranges.length===1){let h=u.ranges[0];if(h.width<this._typicalHalfwidthCharacterWidth){let f=Math.round(h.left+h.width/2),g=Math.max(0,Math.round(f-this._typicalHalfwidthCharacterWidth/2));u.ranges[0]=new Hm(g,this._typicalHalfwidthCharacterWidth)}}for(let h=0,f=u.ranges.length;h<f;h++){let g=i&&u.continuesOnNextLine&&f===1,b=u.ranges[h],v='<div class="cdr '+n+'" style="left:'+String(b.left)+"px;width:"+(g?"100%;":String(b.width)+"px;")+'"></div>';a[p]+=v}}}render(e,t){if(!this._renderResult)return"";let n=t-e;return n<0||n>=this._renderResult.length?"":this._renderResult[n]}};var _w=class extends Yt{scrollbar;scrollbarDomNode;constructor(e,t,n,i){super(e);let r=this._context.configuration.options,s=r.get(105),a=r.get(76),l=r.get(41),d=r.get(108),c={listenOnDomNode:n.domNode,className:"editor-scrollable "+Ab(e.theme.type),useShadows:!1,lazyRender:!0,vertical:s.vertical,horizontal:s.horizontal,verticalHasArrows:s.verticalHasArrows,horizontalHasArrows:s.horizontalHasArrows,verticalScrollbarSize:s.verticalScrollbarSize,verticalSliderSize:s.verticalSliderSize,horizontalScrollbarSize:s.horizontalScrollbarSize,horizontalSliderSize:s.horizontalSliderSize,handleMouseWheel:s.handleMouseWheel,alwaysConsumeMouseWheel:s.alwaysConsumeMouseWheel,arrowSize:s.arrowSize,mouseWheelScrollSensitivity:a,fastScrollSensitivity:l,scrollPredominantAxis:d,scrollByPage:s.scrollByPage};this.scrollbar=this._register(new oc(t.domNode,c,this._context.viewLayout.getScrollable())),ri.write(this.scrollbar.getDomNode(),6),this.scrollbarDomNode=We(this.scrollbar.getDomNode()),this.scrollbarDomNode.setPosition("absolute"),this._setLayout();let u=(p,h,f)=>{let g={};if(h){let b=p.scrollTop;b&&(g.scrollTop=this._context.viewLayout.getCurrentScrollTop()+b,p.scrollTop=0)}if(f){let b=p.scrollLeft;b&&(g.scrollLeft=this._context.viewLayout.getCurrentScrollLeft()+b,p.scrollLeft=0)}this._context.viewModel.viewLayout.setScrollPosition(g,1)};this._register(j(n.domNode,"scroll",p=>u(n.domNode,!0,!0))),this._register(j(t.domNode,"scroll",p=>u(t.domNode,!0,!1))),this._register(j(i.domNode,"scroll",p=>u(i.domNode,!0,!1))),this._register(j(this.scrollbarDomNode.domNode,"scroll",p=>u(this.scrollbarDomNode.domNode,!0,!1)))}dispose(){super.dispose()}_setLayout(){let e=this._context.configuration.options,t=e.get(147);this.scrollbarDomNode.setLeft(t.contentLeft),e.get(74).side==="right"?this.scrollbarDomNode.setWidth(t.contentWidth+t.minimap.minimapWidth):this.scrollbarDomNode.setWidth(t.contentWidth),this.scrollbarDomNode.setHeight(t.height)}getOverviewRulerLayoutInfo(){return this.scrollbar.getOverviewRulerLayoutInfo()}getDomNode(){return this.scrollbarDomNode}delegateVerticalScrollbarPointerDown(e){this.scrollbar.delegateVerticalScrollbarPointerDown(e)}delegateScrollFromMouseWheelEvent(e){this.scrollbar.delegateScrollFromMouseWheelEvent(e)}onConfigurationChanged(e){if(e.hasChanged(105)||e.hasChanged(76)||e.hasChanged(41)){let t=this._context.configuration.options,n=t.get(105),i=t.get(76),r=t.get(41),s=t.get(108),a={vertical:n.vertical,horizontal:n.horizontal,verticalScrollbarSize:n.verticalScrollbarSize,horizontalScrollbarSize:n.horizontalScrollbarSize,scrollByPage:n.scrollByPage,handleMouseWheel:n.handleMouseWheel,mouseWheelScrollSensitivity:i,fastScrollSensitivity:r,scrollPredominantAxis:s};this.scrollbar.updateOptions(a)}return e.hasChanged(147)&&this._setLayout(),!0}onScrollChanged(e){return!0}onThemeChanged(e){return this.scrollbar.updateClassName("editor-scrollable "+Ab(this._context.theme.type)),!0}prepareRender(e){}render(e){this.scrollbar.renderNow()}};var vp=class{constructor(e,t,n,i,r){this.startLineNumber=e;this.endLineNumber=t;this.className=n;this.tooltip=i;this.zIndex=r??0}_decorationToRenderBrand=void 0;zIndex},cO=class{constructor(e,t,n){this.className=e;this.zIndex=t;this.tooltip=n}},uO=class{decorations=[];add(e){this.decorations.push(e)}getDecorations(){return this.decorations}},ag=class extends _o{_render(e,t,n){let i=[];for(let a=e;a<=t;a++){let l=a-e;i[l]=new uO}if(n.length===0)return i;n.sort((a,l)=>a.className===l.className?a.startLineNumber===l.startLineNumber?a.endLineNumber-l.endLineNumber:a.startLineNumber-l.startLineNumber:a.className<l.className?-1:1);let r=null,s=0;for(let a=0,l=n.length;a<l;a++){let d=n[a],c=d.className,u=d.zIndex,p=Math.max(d.startLineNumber,e)-e,h=Math.min(d.endLineNumber,t)-e;r===c?(p=Math.max(s+1,p),s=Math.max(s,h)):(r=c,s=h);for(let f=p;f<=s;f++)i[f].add(new cO(c,u,d.tooltip))}return i}},Dw=class extends Yt{domNode;_lineHeight;_glyphMargin;_glyphMarginLeft;_glyphMarginWidth;_glyphMarginDecorationLaneCount;_managedDomNodes;_decorationGlyphsToRender;_widgets={};constructor(e){super(e),this._context=e;let t=this._context.configuration.options,n=t.get(147);this.domNode=We(document.createElement("div")),this.domNode.setClassName("glyph-margin-widgets"),this.domNode.setPosition("absolute"),this.domNode.setTop(0),this._lineHeight=t.get(68),this._glyphMargin=t.get(58),this._glyphMarginLeft=n.glyphMarginLeft,this._glyphMarginWidth=n.glyphMarginWidth,this._glyphMarginDecorationLaneCount=n.glyphMarginDecorationLaneCount,this._managedDomNodes=[],this._decorationGlyphsToRender=[]}dispose(){this._managedDomNodes=[],this._decorationGlyphsToRender=[],this._widgets={},super.dispose()}getWidgets(){return Object.values(this._widgets)}onConfigurationChanged(e){let t=this._context.configuration.options,n=t.get(147);return this._lineHeight=t.get(68),this._glyphMargin=t.get(58),this._glyphMarginLeft=n.glyphMarginLeft,this._glyphMarginWidth=n.glyphMarginWidth,this._glyphMarginDecorationLaneCount=n.glyphMarginDecorationLaneCount,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}addWidget(e){let t=We(e.getDomNode());this._widgets[e.getId()]={widget:e,preference:e.getPosition(),domNode:t,renderInfo:null},t.setPosition("absolute"),t.setDisplay("none"),t.setAttribute("widgetId",e.getId()),this.domNode.appendChild(t),this.setShouldRender()}setWidgetPosition(e,t){let n=this._widgets[e.getId()];return n.preference.lane===t.lane&&n.preference.zIndex===t.zIndex&&P.equalsRange(n.preference.range,t.range)?!1:(n.preference=t,this.setShouldRender(),!0)}removeWidget(e){let t=e.getId();if(this._widgets[t]){let i=this._widgets[t].domNode.domNode;delete this._widgets[t],i.remove(),this.setShouldRender()}}_collectDecorationBasedGlyphRenderRequest(e,t){let n=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,r=e.getDecorationsInViewport();for(let s of r){let a=s.options.glyphMarginClassName;if(!a)continue;let l=Math.max(s.range.startLineNumber,n),d=Math.min(s.range.endLineNumber,i),c=s.options.glyphMargin?.position??2,u=s.options.zIndex??0;for(let p=l;p<=d;p++){let h=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new A(p,0)),f=this._context.viewModel.glyphLanes.getLanesAtLine(h.lineNumber).indexOf(c);t.push(new pO(p,f,u,a))}}}_collectWidgetBasedGlyphRenderRequest(e,t){let n=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber;for(let r of Object.values(this._widgets)){let s=r.preference.range,{startLineNumber:a,endLineNumber:l}=this._context.viewModel.coordinatesConverter.convertModelRangeToViewRange(P.lift(s));if(!a||!l||l<n||a>i)continue;let d=Math.max(a,n),c=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new A(d,0)),u=this._context.viewModel.glyphLanes.getLanesAtLine(c.lineNumber).indexOf(r.preference.lane);t.push(new hO(d,u,r.preference.zIndex,r))}}_collectSortedGlyphRenderRequests(e){let t=[];return this._collectDecorationBasedGlyphRenderRequest(e,t),this._collectWidgetBasedGlyphRenderRequest(e,t),t.sort((n,i)=>n.lineNumber===i.lineNumber?n.laneIndex===i.laneIndex?n.zIndex===i.zIndex?i.type===n.type?n.type===0&&i.type===0?n.className<i.className?-1:1:0:i.type-n.type:i.zIndex-n.zIndex:n.laneIndex-i.laneIndex:n.lineNumber-i.lineNumber),t}prepareRender(e){if(!this._glyphMargin){this._decorationGlyphsToRender=[];return}for(let i of Object.values(this._widgets))i.renderInfo=null;let t=new Wi(this._collectSortedGlyphRenderRequests(e)),n=[];for(;t.length>0;){let i=t.peek();if(!i)break;let r=t.takeWhile(a=>a.lineNumber===i.lineNumber&&a.laneIndex===i.laneIndex);if(!r||r.length===0)break;let s=r[0];if(s.type===0){let a=[];for(let l of r){if(l.zIndex!==s.zIndex||l.type!==s.type)break;(a.length===0||a[a.length-1]!==l.className)&&a.push(l.className)}n.push(s.accept(a.join(" ")))}else s.widget.renderInfo={lineNumber:s.lineNumber,laneIndex:s.laneIndex}}this._decorationGlyphsToRender=n}render(e){if(!this._glyphMargin){for(let n of Object.values(this._widgets))n.domNode.setDisplay("none");for(;this._managedDomNodes.length>0;)this._managedDomNodes.pop()?.domNode.remove();return}let t=Math.round(this._glyphMarginWidth/this._glyphMarginDecorationLaneCount);for(let n of Object.values(this._widgets))if(!n.renderInfo)n.domNode.setDisplay("none");else{let i=e.viewportData.relativeVerticalOffset[n.renderInfo.lineNumber-e.viewportData.startLineNumber],r=this._glyphMarginLeft+n.renderInfo.laneIndex*this._lineHeight;n.domNode.setDisplay("block"),n.domNode.setTop(i),n.domNode.setLeft(r),n.domNode.setWidth(t),n.domNode.setHeight(this._lineHeight)}for(let n=0;n<this._decorationGlyphsToRender.length;n++){let i=this._decorationGlyphsToRender[n],r=e.viewportData.relativeVerticalOffset[i.lineNumber-e.viewportData.startLineNumber],s=this._glyphMarginLeft+i.laneIndex*this._lineHeight,a;n<this._managedDomNodes.length?a=this._managedDomNodes[n]:(a=We(document.createElement("div")),this._managedDomNodes.push(a),this.domNode.appendChild(a)),a.setClassName("cgmr codicon "+i.combinedClassName),a.setPosition("absolute"),a.setTop(r),a.setLeft(s),a.setWidth(t),a.setHeight(this._lineHeight)}for(;this._managedDomNodes.length>this._decorationGlyphsToRender.length;)this._managedDomNodes.pop()?.domNode.remove()}};var pO=class{constructor(e,t,n,i){this.lineNumber=e;this.laneIndex=t;this.zIndex=n;this.className=i}type=0;accept(e){return new mO(this.lineNumber,this.laneIndex,e)}},hO=class{constructor(e,t,n,i){this.lineNumber=e;this.laneIndex=t;this.zIndex=n;this.widget=i}type=1},mO=class{constructor(e,t,n){this.lineNumber=e;this.laneIndex=t;this.combinedClassName=n}};var Lw=class extends _o{_context;_primaryPosition;_spaceWidth;_renderResult;_maxIndentLeft;_bracketPairGuideOptions;constructor(e){super(),this._context=e,this._primaryPosition=null;let t=this._context.configuration.options,n=t.get(148),i=t.get(51);this._spaceWidth=i.spaceWidth,this._maxIndentLeft=n.wrappingColumn===-1?-1:n.wrappingColumn*i.typicalHalfwidthCharacterWidth,this._bracketPairGuideOptions=t.get(16),this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){let t=this._context.configuration.options,n=t.get(148),i=t.get(51);return this._spaceWidth=i.spaceWidth,this._maxIndentLeft=n.wrappingColumn===-1?-1:n.wrappingColumn*i.typicalHalfwidthCharacterWidth,this._bracketPairGuideOptions=t.get(16),!0}onCursorStateChanged(e){let n=e.selections[0].getPosition();return this._primaryPosition?.equals(n)?!1:(this._primaryPosition=n,!0)}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}onLanguageConfigurationChanged(e){return!0}prepareRender(e){if(!this._bracketPairGuideOptions.indentation&&this._bracketPairGuideOptions.bracketPairs===!1){this._renderResult=null;return}let t=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber,i=e.scrollWidth,r=this._primaryPosition,s=this.getGuidesByLine(t,Math.min(n+1,this._context.viewModel.getLineCount()),r),a=[];for(let l=t;l<=n;l++){let d=l-t,c=s[d],u="",p=e.visibleRangeForPosition(new A(l,1))?.left??0;for(let h of c){let f=h.column===-1?p+(h.visibleColumn-1)*this._spaceWidth:e.visibleRangeForPosition(new A(l,h.column)).left;if(f>i||this._maxIndentLeft>0&&f>this._maxIndentLeft)break;let g=h.horizontalLine?h.horizontalLine.top?"horizontal-top":"horizontal-bottom":"vertical",b=h.horizontalLine?(e.visibleRangeForPosition(new A(l,h.horizontalLine.endColumn))?.left??f+this._spaceWidth)-f:this._spaceWidth;u+=`<div class="core-guide ${h.className} ${g}" style="left:${f}px;width:${b}px"></div>`}a[d]=u}this._renderResult=a}getGuidesByLine(e,t,n){let i=this._bracketPairGuideOptions.bracketPairs!==!1?this._context.viewModel.getBracketGuidesInRangeByLine(e,t,n,{highlightActive:this._bracketPairGuideOptions.highlightActiveBracketPair,horizontalGuides:this._bracketPairGuideOptions.bracketPairsHorizontal===!0?2:this._bracketPairGuideOptions.bracketPairsHorizontal==="active"?1:0,includeInactive:this._bracketPairGuideOptions.bracketPairs===!0}):null,r=this._bracketPairGuideOptions.indentation?this._context.viewModel.getLinesIndentGuides(e,t):null,s=0,a=0,l=0;if(this._bracketPairGuideOptions.highlightActiveIndentation!==!1&&n){let u=this._context.viewModel.getActiveIndentGuide(n.lineNumber,e,t);s=u.startLineNumber,a=u.endLineNumber,l=u.indent}let{indentSize:d}=this._context.viewModel.model.getOptions(),c=[];for(let u=e;u<=t;u++){let p=new Array;c.push(p);let h=i?i[u-e]:[],f=new Wi(h),g=r?r[u-e]:0;for(let b=1;b<=g;b++){let v=(b-1)*d+1,y=(this._bracketPairGuideOptions.highlightActiveIndentation==="always"||h.length===0)&&s<=u&&u<=a&&b===l;p.push(...f.takeWhile(E=>E.visibleColumn<v)||[]);let S=f.peek();(!S||S.visibleColumn!==v||S.horizontalLine)&&p.push(new ts(v,-1,`core-guide-indent lvl-${(b-1)%30}`+(y?" indent-active":""),null,-1,-1))}p.push(...f.takeWhile(b=>!0)||[])}return c}render(e,t){if(!this._renderResult)return"";let n=t-e;return n<0||n>=this._renderResult.length?"":this._renderResult[n]}};function lg(o){if(!(o&&o.isTransparent()))return o}To((o,e)=>{let t=[{bracketColor:MT,guideColor:nU,guideColorActive:lU},{bracketColor:PT,guideColor:iU,guideColorActive:dU},{bracketColor:OT,guideColor:oU,guideColorActive:cU},{bracketColor:NT,guideColor:rU,guideColorActive:uU},{bracketColor:AT,guideColor:sU,guideColorActive:pU},{bracketColor:FT,guideColor:aU,guideColorActive:hU}],n=new lv,i=[{indentColor:VH,indentColorActive:GH},{indentColor:WH,indentColorActive:jH},{indentColor:HH,indentColorActive:qH},{indentColor:UH,indentColorActive:$H},{indentColor:zH,indentColorActive:YH},{indentColor:KH,indentColorActive:ZH}],r=t.map(a=>{let l=o.getColor(a.bracketColor),d=o.getColor(a.guideColor),c=o.getColor(a.guideColorActive),u=lg(lg(d)??l?.transparent(.3)),p=lg(lg(c)??l);if(!(!u||!p))return{guideColor:u,guideColorActive:p}}).filter(bl),s=i.map(a=>{let l=o.getColor(a.indentColor),d=o.getColor(a.indentColorActive),c=lg(l),u=lg(d);if(!(!c||!u))return{indentColor:c,indentColorActive:u}}).filter(bl);if(r.length>0){for(let a=0;a<30;a++){let l=r[a%r.length];e.addRule(`.monaco-editor .${n.getInlineClassNameOfLevel(a).replace(/ /g,".")} { --guide-color: ${l.guideColor}; --guide-color-active: ${l.guideColorActive}; }`)}e.addRule(".monaco-editor .vertical { box-shadow: 1px 0 0 0 var(--guide-color) inset; }"),e.addRule(".monaco-editor .horizontal-top { border-top: 1px solid var(--guide-color); }"),e.addRule(".monaco-editor .horizontal-bottom { border-bottom: 1px solid var(--guide-color); }"),e.addRule(`.monaco-editor .vertical.${n.activeClassName} { box-shadow: 1px 0 0 0 var(--guide-color-active) inset; }`),e.addRule(`.monaco-editor .horizontal-top.${n.activeClassName} { border-top: 1px solid var(--guide-color-active); }`),e.addRule(`.monaco-editor .horizontal-bottom.${n.activeClassName} { border-bottom: 1px solid var(--guide-color-active); }`)}if(s.length>0){for(let a=0;a<30;a++){let l=s[a%s.length];e.addRule(`.monaco-editor .lines-content .core-guide-indent.lvl-${a} { --indent-color: ${l.indentColor}; --indent-color-active: ${l.indentColorActive}; }`)}e.addRule(".monaco-editor .lines-content .core-guide-indent { box-shadow: 1px 0 0 0 var(--indent-color) inset; }"),e.addRule(".monaco-editor .lines-content .core-guide-indent.indent-active { box-shadow: 1px 0 0 0 var(--indent-color-active) inset; }")}});var dg=class o extends _o{static CLASS_NAME="line-numbers";_context;_lineHeight;_renderLineNumbers;_renderCustomLineNumbers;_renderFinalNewline;_lineNumbersLeft;_lineNumbersWidth;_lastCursorModelPosition;_renderResult;_activeLineNumber;constructor(e){super(),this._context=e,this._readConfig(),this._lastCursorModelPosition=new A(1,1),this._renderResult=null,this._activeLineNumber=1,this._context.addEventHandler(this)}_readConfig(){let e=this._context.configuration.options;this._lineHeight=e.get(68);let t=e.get(69);this._renderLineNumbers=t.renderType,this._renderCustomLineNumbers=t.renderFn,this._renderFinalNewline=e.get(97);let n=e.get(147);this._lineNumbersLeft=n.lineNumbersLeft,this._lineNumbersWidth=n.lineNumbersWidth}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){return this._readConfig(),!0}onCursorStateChanged(e){let t=e.selections[0].getPosition();this._lastCursorModelPosition=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(t);let n=!1;return this._activeLineNumber!==t.lineNumber&&(this._activeLineNumber=t.lineNumber,n=!0),(this._renderLineNumbers===2||this._renderLineNumbers===3)&&(n=!0),n}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}onDecorationsChanged(e){return e.affectsLineNumber}_getLineRenderLineNumber(e){let t=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new A(e,1));if(t.column!==1)return"";let n=t.lineNumber;if(this._renderCustomLineNumbers)return this._renderCustomLineNumbers(n);if(this._renderLineNumbers===2){let i=Math.abs(this._lastCursorModelPosition.lineNumber-n);return i===0?'<span class="relative-current-line-number">'+n+"</span>":String(i)}if(this._renderLineNumbers===3){if(this._lastCursorModelPosition.lineNumber===n||n%10===0)return String(n);let i=this._context.viewModel.getLineCount();return n===i?String(n):""}return String(n)}prepareRender(e){if(this._renderLineNumbers===0){this._renderResult=null;return}let t=At?this._lineHeight%2===0?" lh-even":" lh-odd":"",n=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,r=this._context.viewModel.getDecorationsInViewport(e.visibleRange).filter(d=>!!d.options.lineNumberClassName);r.sort((d,c)=>P.compareRangesUsingEnds(d.range,c.range));let s=0,a=this._context.viewModel.getLineCount(),l=[];for(let d=n;d<=i;d++){let c=d-n,u=this._getLineRenderLineNumber(d),p="";for(;s<r.length&&r[s].range.endLineNumber<d;)s++;for(let h=s;h<r.length;h++){let{range:f,options:g}=r[h];f.startLineNumber<=d&&(p+=" "+g.lineNumberClassName)}if(!u&&!p){l[c]="";continue}d===a&&this._context.viewModel.getLineLength(d)===0&&(this._renderFinalNewline==="off"&&(u=""),this._renderFinalNewline==="dimmed"&&(p+=" dimmed-line-number")),d===this._activeLineNumber&&(p+=" active-line-number"),l[c]=`<div class="${o.CLASS_NAME}${t}${p}" style="left:${this._lineNumbersLeft}px;width:${this._lineNumbersWidth}px;">${u}</div>`}this._renderResult=l}render(e,t){if(!this._renderResult)return"";let n=t-e;return n<0||n>=this._renderResult.length?"":this._renderResult[n]}};To((o,e)=>{let t=o.getColor(BH),n=o.getColor(XH);n?e.addRule(`.monaco-editor .line-numbers.dimmed-line-number { color: ${n}; }`):t&&e.addRule(`.monaco-editor .line-numbers.dimmed-line-number { color: ${t.transparent(.4)}; }`)});var gO=class{_currentVisibleRange;constructor(){this._currentVisibleRange=new P(1,1,1,1)}getCurrentVisibleRange(){return this._currentVisibleRange}setCurrentVisibleRange(e){this._currentVisibleRange=e}},fO=class{constructor(e,t,n,i,r,s,a){this.minimalReveal=e;this.lineNumber=t;this.startColumn=n;this.endColumn=i;this.startScrollTop=r;this.stopScrollTop=s;this.scrollType=a;this.minLineNumber=t,this.maxLineNumber=t}type="range";minLineNumber;maxLineNumber},bO=class{constructor(e,t,n,i,r){this.minimalReveal=e;this.selections=t;this.startScrollTop=n;this.stopScrollTop=i;this.scrollType=r;let s=t[0].startLineNumber,a=t[0].endLineNumber;for(let l=1,d=t.length;l<d;l++){let c=t[l];s=Math.min(s,c.startLineNumber),a=Math.max(a,c.endLineNumber)}this.minLineNumber=s,this.maxLineNumber=a}type="selections";minLineNumber;maxLineNumber},Rw=class o extends Yt{static HORIZONTAL_EXTRA_PX=30;_linesContent;_textRangeRestingSpot;_visibleLines;domNode;_lineHeight;_typicalHalfwidthCharacterWidth;_isViewportWrapping;_revealHorizontalRightPadding;_cursorSurroundingLines;_cursorSurroundingLinesStyle;_canUseLayerHinting;_viewLineOptions;_maxLineWidth;_asyncUpdateLineWidths;_asyncCheckMonospaceFontAssumptions;_horizontalRevealRequest;_lastRenderedData;_stickyScrollEnabled;_maxNumberStickyLines;constructor(e,t){super(e);let n=this._context.configuration,i=this._context.configuration.options,r=i.get(51),s=i.get(148);this._lineHeight=i.get(68),this._typicalHalfwidthCharacterWidth=r.typicalHalfwidthCharacterWidth,this._isViewportWrapping=s.isViewportWrapping,this._revealHorizontalRightPadding=i.get(102),this._cursorSurroundingLines=i.get(29),this._cursorSurroundingLinesStyle=i.get(30),this._canUseLayerHinting=!i.get(32),this._viewLineOptions=new zv(n,this._context.theme.type),this._linesContent=t,this._textRangeRestingSpot=document.createElement("div"),this._visibleLines=new Um({createLine:()=>new Zs(this._viewLineOptions)}),this.domNode=this._visibleLines.domNode,ri.write(this.domNode,8),this.domNode.setClassName(`view-lines ${ql}`),on(this.domNode,r),this._maxLineWidth=0,this._asyncUpdateLineWidths=new nn(()=>{this._updateLineWidthsSlow()},200),this._asyncCheckMonospaceFontAssumptions=new nn(()=>{this._checkMonospaceFontAssumptions()},2e3),this._lastRenderedData=new gO,this._horizontalRevealRequest=null,this._stickyScrollEnabled=i.get(117).enabled,this._maxNumberStickyLines=i.get(117).maxLineCount}dispose(){this._asyncUpdateLineWidths.dispose(),this._asyncCheckMonospaceFontAssumptions.dispose(),super.dispose()}getDomNode(){return this.domNode}onConfigurationChanged(e){this._visibleLines.onConfigurationChanged(e),e.hasChanged(148)&&(this._maxLineWidth=0);let t=this._context.configuration.options,n=t.get(51),i=t.get(148);return this._lineHeight=t.get(68),this._typicalHalfwidthCharacterWidth=n.typicalHalfwidthCharacterWidth,this._isViewportWrapping=i.isViewportWrapping,this._revealHorizontalRightPadding=t.get(102),this._cursorSurroundingLines=t.get(29),this._cursorSurroundingLinesStyle=t.get(30),this._canUseLayerHinting=!t.get(32),this._stickyScrollEnabled=t.get(117).enabled,this._maxNumberStickyLines=t.get(117).maxLineCount,on(this.domNode,n),this._onOptionsMaybeChanged(),e.hasChanged(147)&&(this._maxLineWidth=0),!0}_onOptionsMaybeChanged(){let e=this._context.configuration,t=new zv(e,this._context.theme.type);if(!this._viewLineOptions.equals(t)){this._viewLineOptions=t;let n=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();for(let r=n;r<=i;r++)this._visibleLines.getVisibleLine(r).onOptionsChanged(this._viewLineOptions);return!0}return!1}onCursorStateChanged(e){let t=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber(),i=!1;for(let r=t;r<=n;r++)i=this._visibleLines.getVisibleLine(r).onSelectionChanged()||i;return i}onDecorationsChanged(e){{let t=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber();for(let i=t;i<=n;i++)this._visibleLines.getVisibleLine(i).onDecorationsChanged()}return!0}onFlushed(e){let t=this._visibleLines.onFlushed(e);return this._maxLineWidth=0,t}onLinesChanged(e){return this._visibleLines.onLinesChanged(e)}onLinesDeleted(e){return this._visibleLines.onLinesDeleted(e)}onLinesInserted(e){return this._visibleLines.onLinesInserted(e)}onRevealRangeRequest(e){let t=this._computeScrollTopToRevealRange(this._context.viewLayout.getFutureViewport(),e.source,e.minimalReveal,e.range,e.selections,e.verticalType);if(t===-1)return!1;let n=this._context.viewLayout.validateScrollPosition({scrollTop:t});e.revealHorizontal?e.range&&e.range.startLineNumber!==e.range.endLineNumber?n={scrollTop:n.scrollTop,scrollLeft:0}:e.range?this._horizontalRevealRequest=new fO(e.minimalReveal,e.range.startLineNumber,e.range.startColumn,e.range.endColumn,this._context.viewLayout.getCurrentScrollTop(),n.scrollTop,e.scrollType):e.selections&&e.selections.length>0&&(this._horizontalRevealRequest=new bO(e.minimalReveal,e.selections,this._context.viewLayout.getCurrentScrollTop(),n.scrollTop,e.scrollType)):this._horizontalRevealRequest=null;let r=Math.abs(this._context.viewLayout.getCurrentScrollTop()-n.scrollTop)<=this._lineHeight?1:e.scrollType;return this._context.viewModel.viewLayout.setScrollPosition(n,r),!0}onScrollChanged(e){if(this._horizontalRevealRequest&&e.scrollLeftChanged&&(this._horizontalRevealRequest=null),this._horizontalRevealRequest&&e.scrollTopChanged){let t=Math.min(this._horizontalRevealRequest.startScrollTop,this._horizontalRevealRequest.stopScrollTop),n=Math.max(this._horizontalRevealRequest.startScrollTop,this._horizontalRevealRequest.stopScrollTop);(e.scrollTop<t||e.scrollTop>n)&&(this._horizontalRevealRequest=null)}return this.domNode.setWidth(e.scrollWidth),this._visibleLines.onScrollChanged(e)||!0}onTokensChanged(e){return this._visibleLines.onTokensChanged(e)}onZonesChanged(e){return this._context.viewModel.viewLayout.setMaxLineWidth(this._maxLineWidth),this._visibleLines.onZonesChanged(e)}onThemeChanged(e){return this._onOptionsMaybeChanged()}getPositionFromDOMInfo(e,t){let n=this._getViewLineDomNode(e);if(n===null)return null;let i=this._getLineNumberFor(n);if(i===-1||i<1||i>this._context.viewModel.getLineCount())return null;if(this._context.viewModel.getLineMaxColumn(i)===1)return new A(i,1);let r=this._visibleLines.getStartLineNumber(),s=this._visibleLines.getEndLineNumber();if(i<r||i>s)return null;let a=this._visibleLines.getVisibleLine(i).getColumnOfNodeOffset(e,t),l=this._context.viewModel.getLineMinColumn(i);return a<l&&(a=l),new A(i,a)}_getViewLineDomNode(e){for(;e&&e.nodeType===1;){if(e.className===Zs.CLASS_NAME)return e;e=e.parentElement}return null}_getLineNumberFor(e){let t=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber();for(let i=t;i<=n;i++){let r=this._visibleLines.getVisibleLine(i);if(e===r.getDomNode())return i}return-1}getLineWidth(e){let t=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber();if(e<t||e>n)return-1;let i=new zm(this.domNode.domNode,this._textRangeRestingSpot),r=this._visibleLines.getVisibleLine(e).getWidth(i);return this._updateLineWidthsSlowIfDomDidLayout(i),r}linesVisibleRangesForRange(e,t){if(this.shouldRender())return null;let n=e.endLineNumber,i=P.intersectRanges(e,this._lastRenderedData.getCurrentVisibleRange());if(!i)return null;let r=[],s=0,a=new zm(this.domNode.domNode,this._textRangeRestingSpot),l=0;t&&(l=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new A(i.startLineNumber,1)).lineNumber);let d=this._visibleLines.getStartLineNumber(),c=this._visibleLines.getEndLineNumber();for(let u=i.startLineNumber;u<=i.endLineNumber;u++){if(u<d||u>c)continue;let p=u===i.startLineNumber?i.startColumn:1,h=u!==i.endLineNumber,f=h?this._context.viewModel.getLineMaxColumn(u):i.endColumn,g=this._visibleLines.getVisibleLine(u).getVisibleRangesForRange(u,p,f,a);if(g){if(t&&u<n){let b=l;l=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new A(u+1,1)).lineNumber,b!==l&&(g.ranges[g.ranges.length-1].width+=this._typicalHalfwidthCharacterWidth)}r[s++]=new Ox(g.outsideRenderedLine,u,Hm.from(g.ranges),h)}}return this._updateLineWidthsSlowIfDomDidLayout(a),s===0?null:r}_visibleRangesForLineRange(e,t,n){if(this.shouldRender()||e<this._visibleLines.getStartLineNumber()||e>this._visibleLines.getEndLineNumber())return null;let i=new zm(this.domNode.domNode,this._textRangeRestingSpot),r=this._visibleLines.getVisibleLine(e).getVisibleRangesForRange(e,t,n,i);return this._updateLineWidthsSlowIfDomDidLayout(i),r}visibleRangeForPosition(e){let t=this._visibleRangesForLineRange(e.lineNumber,e.column,e.column);return t?new Nx(t.outsideRenderedLine,t.ranges[0].left):null}updateLineWidths(){this._updateLineWidths(!1)}_updateLineWidthsFast(){return this._updateLineWidths(!0)}_updateLineWidthsSlow(){this._updateLineWidths(!1)}_updateLineWidthsSlowIfDomDidLayout(e){e.didDomLayout&&(this._asyncUpdateLineWidths.isScheduled()||(this._asyncUpdateLineWidths.cancel(),this._updateLineWidthsSlow()))}_updateLineWidths(e){let t=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber(),i=1,r=!0;for(let s=t;s<=n;s++){let a=this._visibleLines.getVisibleLine(s);if(e&&!a.getWidthIsFast()){r=!1;continue}i=Math.max(i,a.getWidth(null))}return r&&t===1&&n===this._context.viewModel.getLineCount()&&(this._maxLineWidth=0),this._ensureMaxLineWidth(i),r}_checkMonospaceFontAssumptions(){let e=-1,t=-1,n=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();for(let r=n;r<=i;r++){let s=this._visibleLines.getVisibleLine(r);if(s.needsMonospaceFontCheck()){let a=s.getWidth(null);a>t&&(t=a,e=r)}}if(e!==-1&&!this._visibleLines.getVisibleLine(e).monospaceAssumptionsAreValid())for(let r=n;r<=i;r++)this._visibleLines.getVisibleLine(r).onMonospaceAssumptionsInvalidated()}prepareRender(){throw new Error("Not supported")}render(){throw new Error("Not supported")}renderText(e){if(this._visibleLines.renderLines(e),this._lastRenderedData.setCurrentVisibleRange(e.visibleRange),this.domNode.setWidth(this._context.viewLayout.getScrollWidth()),this.domNode.setHeight(Math.min(this._context.viewLayout.getScrollHeight(),1e6)),this._horizontalRevealRequest){let n=this._horizontalRevealRequest;if(e.startLineNumber<=n.minLineNumber&&n.maxLineNumber<=e.endLineNumber){this._horizontalRevealRequest=null,this.onDidRender();let i=this._computeScrollLeftToReveal(n);i&&(this._isViewportWrapping||this._ensureMaxLineWidth(i.maxHorizontalOffset),this._context.viewModel.viewLayout.setScrollPosition({scrollLeft:i.scrollLeft},n.scrollType))}}if(this._updateLineWidthsFast()?this._asyncUpdateLineWidths.cancel():this._asyncUpdateLineWidths.schedule(),At&&!this._asyncCheckMonospaceFontAssumptions.isScheduled()){let n=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();for(let r=n;r<=i;r++)if(this._visibleLines.getVisibleLine(r).needsMonospaceFontCheck()){this._asyncCheckMonospaceFontAssumptions.schedule();break}}this._linesContent.setLayerHinting(this._canUseLayerHinting),this._linesContent.setContain("strict");let t=this._context.viewLayout.getCurrentScrollTop()-e.bigNumbersDelta;this._linesContent.setTop(-t),this._linesContent.setLeft(-this._context.viewLayout.getCurrentScrollLeft())}_ensureMaxLineWidth(e){let t=Math.ceil(e);this._maxLineWidth<t&&(this._maxLineWidth=t,this._context.viewModel.viewLayout.setMaxLineWidth(this._maxLineWidth))}_computeScrollTopToRevealRange(e,t,n,i,r,s){let a=e.top,l=e.height,d=a+l,c,u,p;if(r&&r.length>0){let v=r[0].startLineNumber,y=r[0].endLineNumber;for(let S=1,E=r.length;S<E;S++){let C=r[S];v=Math.min(v,C.startLineNumber),y=Math.max(y,C.endLineNumber)}c=!1,u=this._context.viewLayout.getVerticalOffsetForLineNumber(v),p=this._context.viewLayout.getVerticalOffsetForLineNumber(y)+this._lineHeight}else if(i)c=!0,u=this._context.viewLayout.getVerticalOffsetForLineNumber(i.startLineNumber),p=this._context.viewLayout.getVerticalOffsetForLineNumber(i.endLineNumber)+this._lineHeight;else return-1;let h=(t==="mouse"||n)&&this._cursorSurroundingLinesStyle==="default",f=0,g=0;if(h)n||(f=this._lineHeight);else{let v=l/this._lineHeight,y=Math.max(this._cursorSurroundingLines,this._stickyScrollEnabled?this._maxNumberStickyLines:0),S=Math.min(v/2,y);f=S*this._lineHeight,g=Math.max(0,S-1)*this._lineHeight}n||(s===0||s===4)&&(g+=this._lineHeight),u-=f,p+=g;let b;if(p-u>l){if(!c)return-1;b=u}else if(s===5||s===6)if(s===6&&a<=u&&p<=d)b=a;else{let v=Math.max(5*this._lineHeight,l*.2),y=u-v,S=p-l;b=Math.max(S,y)}else if(s===1||s===2)if(s===2&&a<=u&&p<=d)b=a;else{let v=(u+p)/2;b=Math.max(0,v-l/2)}else b=this._computeMinimumScrolling(a,d,u,p,s===3,s===4);return b}_computeScrollLeftToReveal(e){let t=this._context.viewLayout.getCurrentViewport(),n=this._context.configuration.options.get(147),i=t.left,r=i+t.width-n.verticalScrollbarWidth,s=1073741824,a=0;if(e.type==="range"){let d=this._visibleRangesForLineRange(e.lineNumber,e.startColumn,e.endColumn);if(!d)return null;for(let c of d.ranges)s=Math.min(s,Math.round(c.left)),a=Math.max(a,Math.round(c.left+c.width))}else for(let d of e.selections){if(d.startLineNumber!==d.endLineNumber)return null;let c=this._visibleRangesForLineRange(d.startLineNumber,d.startColumn,d.endColumn);if(!c)return null;for(let u of c.ranges)s=Math.min(s,Math.round(u.left)),a=Math.max(a,Math.round(u.left+u.width))}return e.minimalReveal||(s=Math.max(0,s-o.HORIZONTAL_EXTRA_PX),a+=this._revealHorizontalRightPadding),e.type==="selections"&&a-s>t.width?null:{scrollLeft:this._computeMinimumScrolling(i,r,s,a),maxHorizontalOffset:a}}_computeMinimumScrolling(e,t,n,i,r,s){e=e|0,t=t|0,n=n|0,i=i|0,r=!!r,s=!!s;let a=t-e;if(i-n<a){if(r)return n;if(s)return Math.max(0,i-a);if(n<e)return n;if(i>t)return Math.max(0,i-a)}else return n;return e}};var kw=class extends ag{_context;_decorationsLeft;_decorationsWidth;_renderResult;constructor(e){super(),this._context=e;let n=this._context.configuration.options.get(147);this._decorationsLeft=n.decorationsLeft,this._decorationsWidth=n.decorationsWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){let n=this._context.configuration.options.get(147);return this._decorationsLeft=n.decorationsLeft,this._decorationsWidth=n.decorationsWidth,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_getDecorations(e){let t=e.getDecorationsInViewport(),n=[],i=0;for(let r=0,s=t.length;r<s;r++){let a=t[r],l=a.options.linesDecorationsClassName,d=a.options.zIndex;l&&(n[i++]=new vp(a.range.startLineNumber,a.range.endLineNumber,l,a.options.linesDecorationsTooltip??null,d));let c=a.options.firstLineDecorationClassName;c&&(n[i++]=new vp(a.range.startLineNumber,a.range.startLineNumber,c,a.options.linesDecorationsTooltip??null,d))}return n}prepareRender(e){let t=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber,i=this._render(t,n,this._getDecorations(e)),r=this._decorationsLeft.toString(),s=this._decorationsWidth.toString(),a='" style="left:'+r+"px;width:"+s+'px;"></div>',l=[];for(let d=t;d<=n;d++){let c=d-t,u=i[c].getDecorations(),p="";for(let h of u){let f='<div class="cldr '+h.className;h.tooltip!==null&&(f+='" title="'+h.tooltip),f+=a,p+=f}l[c]=p}this._renderResult=l}render(e,t){return this._renderResult?this._renderResult[t-e]:""}};var cg=class o extends Yt{static CLASS_NAME="glyph-margin";static OUTER_CLASS_NAME="margin";_domNode;_canUseLayerHinting;_contentLeft;_glyphMarginLeft;_glyphMarginWidth;_glyphMarginBackgroundDomNode;constructor(e){super(e);let t=this._context.configuration.options,n=t.get(147);this._canUseLayerHinting=!t.get(32),this._contentLeft=n.contentLeft,this._glyphMarginLeft=n.glyphMarginLeft,this._glyphMarginWidth=n.glyphMarginWidth,this._domNode=We(document.createElement("div")),this._domNode.setClassName(o.OUTER_CLASS_NAME),this._domNode.setPosition("absolute"),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._glyphMarginBackgroundDomNode=We(document.createElement("div")),this._glyphMarginBackgroundDomNode.setClassName(o.CLASS_NAME),this._domNode.appendChild(this._glyphMarginBackgroundDomNode)}dispose(){super.dispose()}getDomNode(){return this._domNode}onConfigurationChanged(e){let t=this._context.configuration.options,n=t.get(147);return this._canUseLayerHinting=!t.get(32),this._contentLeft=n.contentLeft,this._glyphMarginLeft=n.glyphMarginLeft,this._glyphMarginWidth=n.glyphMarginWidth,!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollTopChanged}prepareRender(e){}render(e){this._domNode.setLayerHinting(this._canUseLayerHinting),this._domNode.setContain("strict");let t=e.scrollTop-e.bigNumbersDelta;this._domNode.setTop(-t);let n=Math.min(e.scrollHeight,1e6);this._domNode.setHeight(n),this._domNode.setWidth(this._contentLeft),this._glyphMarginBackgroundDomNode.setLeft(this._glyphMarginLeft),this._glyphMarginBackgroundDomNode.setWidth(this._glyphMarginWidth),this._glyphMarginBackgroundDomNode.setHeight(n)}};var Mw=class extends ag{_context;_renderResult;constructor(e){super(),this._context=e,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){return!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_getDecorations(e){let t=e.getDecorationsInViewport(),n=[],i=0;for(let r=0,s=t.length;r<s;r++){let a=t[r],l=a.options.marginClassName,d=a.options.zIndex;l&&(n[i++]=new vp(a.range.startLineNumber,a.range.endLineNumber,l,null,d))}return n}prepareRender(e){let t=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber,i=this._render(t,n,this._getDecorations(e)),r=[];for(let s=t;s<=n;s++){let a=s-t,l=i[a].getDecorations(),d="";for(let c of l)d+='<div class="cmdr '+c.className+'" style=""></div>';r[a]=d}this._renderResult=r}render(e,t){return this._renderResult?this._renderResult[t-e]:""}};var Qs=class o{_rgba8Brand=void 0;static Empty=new o(0,0,0,0);r;g;b;a;constructor(e,t,n,i){this.r=o._clamp(e),this.g=o._clamp(t),this.b=o._clamp(n),this.a=o._clamp(i)}equals(e){return this.r===e.r&&this.g===e.g&&this.b===e.b&&this.a===e.a}static _clamp(e){return e<0?0:e>255?255:e|0}};var $4=(()=>{let o=[];for(let e=32;e<=126;e++)o.push(e);return o.push(65533),o})(),Y4=(o,e)=>(o-=32,o<0||o>96?e<=2?(o+96)%96:95:o);var Jv=class o{constructor(e,t){this.scale=t;this.charDataNormal=o.soften(e,12/15),this.charDataLight=o.soften(e,50/60)}_minimapCharRendererBrand=void 0;charDataNormal;charDataLight;static soften(e,t){let n=new Uint8ClampedArray(e.length);for(let i=0,r=e.length;i<r;i++)n[i]=Yc(e[i]*t);return n}renderChar(e,t,n,i,r,s,a,l,d,c,u){let p=1*this.scale,h=2*this.scale,f=u?1:h;if(t+p>e.width||n+f>e.height){console.warn("bad render request outside image data");return}let g=c?this.charDataLight:this.charDataNormal,b=Y4(i,d),v=e.width*4,y=a.r,S=a.g,E=a.b,C=r.r-y,w=r.g-S,_=r.b-E,L=Math.max(s,l),k=e.data,W=b*p*h,K=n*v+t*4;for(let U=0;U<f;U++){let oe=K;for(let Se=0;Se<p;Se++){let ne=g[W++]/255*(s/255);k[oe++]=y+C*ne,k[oe++]=S+w*ne,k[oe++]=E+_*ne,k[oe++]=L}K+=v}}blockRenderChar(e,t,n,i,r,s,a,l){let d=1*this.scale,c=2*this.scale,u=l?1:c;if(t+d>e.width||n+u>e.height){console.warn("bad render request outside image data");return}let p=e.width*4,h=.5*(r/255),f=s.r,g=s.g,b=s.b,v=i.r-f,y=i.g-g,S=i.b-b,E=f+v*h,C=g+y*h,w=b+S*h,_=Math.max(r,a),L=e.data,k=n*p+t*4;for(let W=0;W<u;W++){let K=k;for(let U=0;U<d;U++)L[K++]=E,L[K++]=C,L[K++]=w,L[K++]=_;k+=p}}};var ug=class o extends F{static _INSTANCE=null;static getInstance(){return this._INSTANCE||(this._INSTANCE=dd(new o)),this._INSTANCE}_colors;_backgroundIsLight;_onDidChange=new D;onDidChange=this._onDidChange.event;constructor(){super(),this._updateColorMap(),this._register(cr.onDidChange(e=>{e.changedColorMap&&this._updateColorMap()}))}_updateColorMap(){let e=cr.getColorMap();if(!e){this._colors=[Qs.Empty],this._backgroundIsLight=!0;return}this._colors=[Qs.Empty];for(let n=1;n<e.length;n++){let i=e[n].rgba;this._colors[n]=new Qs(i.r,i.g,i.b,Math.round(i.a*255))}let t=e[2].getRelativeLuminance();this._backgroundIsLight=t>=.5,this._onDidChange.fire(void 0)}getColor(e){return(e<1||e>=this._colors.length)&&(e=2),this._colors[e]}backgroundIsLight(){return this._backgroundIsLight}};var X4={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15},Q4=o=>{let e=new Uint8ClampedArray(o.length/2);for(let t=0;t<o.length;t+=2)e[t>>1]=X4[o[t]]<<4|X4[o[t+1]]&15;return e},vO={1:bs(()=>Q4("0000511D6300CF609C709645A78432005642574171487021003C451900274D35D762755E8B629C5BA856AF57BA649530C167D1512A272A3F6038604460398526BCA2A968DB6F8957C768BE5FBE2FB467CF5D8D5B795DC7625B5DFF50DE64C466DB2FC47CD860A65E9A2EB96CB54CE06DA763AB2EA26860524D3763536601005116008177A8705E53AB738E6A982F88BAA35B5F5B626D9C636B449B737E5B7B678598869A662F6B5B8542706C704C80736A607578685B70594A49715A4522E792")),2:bs(()=>Q4("000000000000000055394F383D2800008B8B1F210002000081B1CBCBCC820000847AAF6B9AAF2119BE08B8881AD60000A44FD07DCCF107015338130C00000000385972265F390B406E2437634B4B48031B12B8A0847000001E15B29A402F0000000000004B33460B00007A752C2A0000000000004D3900000084394B82013400ABA5CFC7AD9C0302A45A3E5A98AB000089A43382D97900008BA54AA087A70A0248A6A7AE6DBE0000BF6F94987EA40A01A06DCFA7A7A9030496C32F77891D0000A99FB1A0AFA80603B29AB9CA75930D010C0948354D3900000C0948354F37460D0028BE673D8400000000AF9D7B6E00002B007AA8933400007AA642675C2700007984CFB9C3985B768772A8A6B7B20000CAAECAAFC4B700009F94A6009F840009D09F9BA4CA9C0000CC8FC76DC87F0000C991C472A2000000A894A48CA7B501079BA2C9C69BA20000B19A5D3FA89000005CA6009DA2960901B0A7F0669FB200009D009E00B7890000DAD0F5D092820000D294D4C48BD10000B5A7A4A3B1A50402CAB6CBA6A2000000B5A7A4A3B1A8044FCDADD19D9CB00000B7778F7B8AAE0803C9AB5D3F5D3F00009EA09EA0BAB006039EA0989A8C7900009B9EF4D6B7C00000A9A7816CACA80000ABAC84705D3F000096DA635CDC8C00006F486F266F263D4784006124097B00374F6D2D6D2D6D4A3A95872322000000030000000000008D8939130000000000002E22A5C9CBC70600AB25C0B5C9B400061A2DB04CA67001082AA6BEBEBFC606002321DACBC19E03087AA08B6768380000282FBAC0B8CA7A88AD25BBA5A29900004C396C5894A6000040485A6E356E9442A32CD17EADA70000B4237923628600003E2DE9C1D7B500002F25BBA5A2990000231DB6AFB4A804023025C0B5CAB588062B2CBDBEC0C706882435A75CA20000002326BD6A82A908048B4B9A5A668000002423A09CB4BB060025259C9D8A7900001C1FCAB2C7C700002A2A9387ABA200002626A4A47D6E9D14333163A0C87500004B6F9C2D643A257049364936493647358A34438355497F1A0000A24C1D590000D38DFFBDD4CD3126"))};var Pw=class o{static lastCreated;static lastFontFamily;static create(e,t){if(this.lastCreated&&e===this.lastCreated.scale&&t===this.lastFontFamily)return this.lastCreated;let n;return vO[e]?n=new Jv(vO[e](),e):n=o.createFromSampleData(o.createSampleData(t).data,e),this.lastFontFamily=t,this.lastCreated=n,n}static createSampleData(e){let t=document.createElement("canvas"),n=t.getContext("2d");t.style.height="16px",t.height=16,t.width=96*10,t.style.width=96*10+"px",n.fillStyle="#ffffff",n.font=`bold 16px ${e}`,n.textBaseline="middle";let i=0;for(let r of $4)n.fillText(String.fromCharCode(r),i,16/2),i+=10;return n.getImageData(0,0,96*10,16)}static createFromSampleData(e,t){let n=16*10*4*96;if(e.length!==n)throw new Error("Unexpected source in MinimapCharRenderer");let i=o._downsample(e,t);return new Jv(i,t)}static _downsampleChar(e,t,n,i,r){let s=1*r,a=2*r,l=i,d=0;for(let c=0;c<a;c++){let u=c/a*16,p=(c+1)/a*16;for(let h=0;h<s;h++){let f=h/s*10,g=(h+1)/s*10,b=0,v=0;for(let S=u;S<p;S++){let E=t+Math.floor(S)*3840,C=1-(S-Math.floor(S));for(let w=f;w<g;w++){let _=1-(w-Math.floor(w)),L=E+Math.floor(w)*4,k=_*C;v+=k,b+=e[L]*e[L+3]/255*k}}let y=b/v;d=Math.max(d,y),n[l++]=Yc(y)}}return d}static _downsample(e,t){let n=2*t*1*t,i=n*96,r=new Uint8ClampedArray(i),s=0,a=0,l=0;for(let d=0;d<96;d++)l=Math.max(l,this._downsampleChar(e,a,r,s,t)),s+=n,a+=10*4;if(l>0){let d=255/l;for(let c=0;c<i;c++)r[c]*=d}return r}};var J4=pt?'"Segoe WPC", "Segoe UI", sans-serif':Ve?"-apple-system, BlinkMacSystemFont, sans-serif":'system-ui, "Ubuntu", "Droid Sans", sans-serif';var Mj=140,Pj=2,Ow=class o{renderMinimap;size;minimapHeightIsEditorHeight;scrollBeyondLastLine;paddingTop;paddingBottom;showSlider;autohide;pixelRatio;typicalHalfwidthCharacterWidth;lineHeight;minimapLeft;minimapWidth;minimapHeight;canvasInnerWidth;canvasInnerHeight;canvasOuterWidth;canvasOuterHeight;isSampling;editorHeight;fontScale;minimapLineHeight;minimapCharWidth;sectionHeaderFontFamily;sectionHeaderFontSize;sectionHeaderLetterSpacing;sectionHeaderFontColor;charRenderer;defaultBackgroundColor;backgroundColor;foregroundAlpha;constructor(e,t,n){let i=e.options,r=i.get(145),s=i.get(147),a=s.minimap,l=i.get(51),d=i.get(74);this.renderMinimap=a.renderMinimap,this.size=d.size,this.minimapHeightIsEditorHeight=a.minimapHeightIsEditorHeight,this.scrollBeyondLastLine=i.get(107),this.paddingTop=i.get(85).top,this.paddingBottom=i.get(85).bottom,this.showSlider=d.showSlider,this.autohide=d.autohide,this.pixelRatio=r,this.typicalHalfwidthCharacterWidth=l.typicalHalfwidthCharacterWidth,this.lineHeight=i.get(68),this.minimapLeft=a.minimapLeft,this.minimapWidth=a.minimapWidth,this.minimapHeight=s.height,this.canvasInnerWidth=a.minimapCanvasInnerWidth,this.canvasInnerHeight=a.minimapCanvasInnerHeight,this.canvasOuterWidth=a.minimapCanvasOuterWidth,this.canvasOuterHeight=a.minimapCanvasOuterHeight,this.isSampling=a.minimapIsSampling,this.editorHeight=s.height,this.fontScale=a.minimapScale,this.minimapLineHeight=a.minimapLineHeight,this.minimapCharWidth=1*this.fontScale,this.sectionHeaderFontFamily=J4,this.sectionHeaderFontSize=d.sectionHeaderFontSize*r,this.sectionHeaderLetterSpacing=d.sectionHeaderLetterSpacing,this.sectionHeaderFontColor=o._getSectionHeaderColor(t,n.getColor(1)),this.charRenderer=bs(()=>Pw.create(this.fontScale,l.fontFamily)),this.defaultBackgroundColor=n.getColor(2),this.backgroundColor=o._getMinimapBackground(t,this.defaultBackgroundColor),this.foregroundAlpha=o._getMinimapForegroundOpacity(t)}static _getMinimapBackground(e,t){let n=e.getColor(v2);return n?new Qs(n.rgba.r,n.rgba.g,n.rgba.b,Math.round(255*n.rgba.a)):t}static _getMinimapForegroundOpacity(e){let t=e.getColor(y2);return t?Qs._clamp(Math.round(255*t.rgba.a)):255}static _getSectionHeaderColor(e,t){let n=e.getColor(Da);return n?new Qs(n.rgba.r,n.rgba.g,n.rgba.b,Math.round(255*n.rgba.a)):t}equals(e){return this.renderMinimap===e.renderMinimap&&this.size===e.size&&this.minimapHeightIsEditorHeight===e.minimapHeightIsEditorHeight&&this.scrollBeyondLastLine===e.scrollBeyondLastLine&&this.paddingTop===e.paddingTop&&this.paddingBottom===e.paddingBottom&&this.showSlider===e.showSlider&&this.autohide===e.autohide&&this.pixelRatio===e.pixelRatio&&this.typicalHalfwidthCharacterWidth===e.typicalHalfwidthCharacterWidth&&this.lineHeight===e.lineHeight&&this.minimapLeft===e.minimapLeft&&this.minimapWidth===e.minimapWidth&&this.minimapHeight===e.minimapHeight&&this.canvasInnerWidth===e.canvasInnerWidth&&this.canvasInnerHeight===e.canvasInnerHeight&&this.canvasOuterWidth===e.canvasOuterWidth&&this.canvasOuterHeight===e.canvasOuterHeight&&this.isSampling===e.isSampling&&this.editorHeight===e.editorHeight&&this.fontScale===e.fontScale&&this.minimapLineHeight===e.minimapLineHeight&&this.minimapCharWidth===e.minimapCharWidth&&this.sectionHeaderFontSize===e.sectionHeaderFontSize&&this.sectionHeaderLetterSpacing===e.sectionHeaderLetterSpacing&&this.defaultBackgroundColor&&this.defaultBackgroundColor.equals(e.defaultBackgroundColor)&&this.backgroundColor&&this.backgroundColor.equals(e.backgroundColor)&&this.foregroundAlpha===e.foregroundAlpha}},yO=class o{constructor(e,t,n,i,r,s,a,l,d){this.scrollTop=e;this.scrollHeight=t;this.sliderNeeded=n;this._computedSliderRatio=i;this.sliderTop=r;this.sliderHeight=s;this.topPaddingLineCount=a;this.startLineNumber=l;this.endLineNumber=d}getDesiredScrollTopFromDelta(e){return Math.round(this.scrollTop+e/this._computedSliderRatio)}getDesiredScrollTopFromTouchLocation(e){return Math.round((e-this.sliderHeight/2)/this._computedSliderRatio)}intersectWithViewport(e){let t=Math.max(this.startLineNumber,e.startLineNumber),n=Math.min(this.endLineNumber,e.endLineNumber);return t>n?null:[t,n]}getYForLineNumber(e,t){return+(e-this.startLineNumber+this.topPaddingLineCount)*t}static create(e,t,n,i,r,s,a,l,d,c,u){let p=e.pixelRatio,h=e.minimapLineHeight,f=Math.floor(e.canvasInnerHeight/h),g=e.lineHeight;if(e.minimapHeightIsEditorHeight){let w=l*e.lineHeight+e.paddingTop+e.paddingBottom;e.scrollBeyondLastLine&&(w+=Math.max(0,r-e.lineHeight-e.paddingBottom));let _=Math.max(1,Math.floor(r*r/w)),L=Math.max(0,e.minimapHeight-_),k=L/(c-r),W=d*k,K=L>0,U=Math.floor(e.canvasInnerHeight/e.minimapLineHeight),oe=Math.floor(e.paddingTop/e.lineHeight);return new o(d,c,K,k,W,_,oe,1,Math.min(a,U))}let b;if(s&&n!==a){let w=n-t+1;b=Math.floor(w*h/p)}else{let w=r/g;b=Math.floor(w*h/p)}let v=Math.floor(e.paddingTop/g),y=Math.floor(e.paddingBottom/g);if(e.scrollBeyondLastLine){let w=r/g;y=Math.max(y,w-1)}let S;if(y>0){let w=r/g;S=(v+a+y-w-1)*h/p}else S=Math.max(0,(v+a)*h/p-b);S=Math.min(e.minimapHeight-b,S);let E=S/(c-r),C=d*E;if(f>=v+a+y){let w=S>0;return new o(d,c,w,E,C,b,v,1,a)}else{let w;t>1?w=t+v:w=Math.max(1,d/g);let _,L=Math.max(1,Math.floor(w-C*p/h));L<v?(_=v-L+1,L=1):(_=0,L=Math.max(1,L-v)),u&&u.scrollHeight===c&&(u.scrollTop>d&&(L=Math.min(L,u.startLineNumber),_=Math.max(_,u.topPaddingLineCount)),u.scrollTop<d&&(L=Math.max(L,u.startLineNumber),_=Math.min(_,u.topPaddingLineCount)));let k=Math.min(a,L-_+f-1),W=(d-i)/g,K;return d>=e.paddingTop?K=(t-L+_+W)*h/p:K=d/e.paddingTop*(_+W)*h/p,new o(d,c,!0,E,K,b,_,L,k)}}},Nw=class o{static INVALID=new o(-1);dy;constructor(e){this.dy=e}onContentChanged(){this.dy=-1}onTokensChanged(){this.dy=-1}},Aw=class{renderedLayout;_imageData;_renderedLines;constructor(e,t,n){this.renderedLayout=e,this._imageData=t,this._renderedLines=new Bv({createLine:()=>Nw.INVALID}),this._renderedLines._set(e.startLineNumber,n)}linesEquals(e){if(!this.scrollEquals(e))return!1;let n=this._renderedLines._get().lines;for(let i=0,r=n.length;i<r;i++)if(n[i].dy===-1)return!1;return!0}scrollEquals(e){return this.renderedLayout.startLineNumber===e.startLineNumber&&this.renderedLayout.endLineNumber===e.endLineNumber}_get(){let e=this._renderedLines._get();return{imageData:this._imageData,rendLineNumberStart:e.rendLineNumberStart,lines:e.lines}}onLinesChanged(e,t){return this._renderedLines.onLinesChanged(e,t)}onLinesDeleted(e,t){this._renderedLines.onLinesDeleted(e,t)}onLinesInserted(e,t){this._renderedLines.onLinesInserted(e,t)}onTokensChanged(e){return this._renderedLines.onTokensChanged(e)}},IO=class o{_backgroundFillData;_buffers;_lastUsedBuffer;constructor(e,t,n,i){this._backgroundFillData=o._createBackgroundFillData(t,n,i),this._buffers=[e.createImageData(t,n),e.createImageData(t,n)],this._lastUsedBuffer=0}getBuffer(){this._lastUsedBuffer=1-this._lastUsedBuffer;let e=this._buffers[this._lastUsedBuffer];return e.data.set(this._backgroundFillData),e}static _createBackgroundFillData(e,t,n){let i=n.r,r=n.g,s=n.b,a=n.a,l=new Uint8ClampedArray(e*t*4),d=0;for(let c=0;c<t;c++)for(let u=0;u<e;u++)l[d]=i,l[d+1]=r,l[d+2]=s,l[d+3]=a,d+=4;return l}},Fw=class o{constructor(e,t){this.samplingRatio=e;this.minimapLines=t}static compute(e,t,n){if(e.renderMinimap===0||!e.isSampling)return[null,[]];let{minimapLineCount:i}=jf.computeContainedMinimapLineCount({viewLineCount:t,scrollBeyondLastLine:e.scrollBeyondLastLine,paddingTop:e.paddingTop,paddingBottom:e.paddingBottom,height:e.editorHeight,lineHeight:e.lineHeight,pixelRatio:e.pixelRatio}),r=t/i,s=r/2;if(!n||n.minimapLines.length===0){let b=[];if(b[0]=1,i>1){for(let v=0,y=i-1;v<y;v++)b[v]=Math.round(v*r+s);b[i-1]=t}return[new o(r,b),[]]}let a=n.minimapLines,l=a.length,d=[],c=0,u=0,p=1,h=10,f=[],g=null;for(let b=0;b<i;b++){let v=Math.max(p,Math.round(b*r)),y=Math.max(v,Math.round((b+1)*r));for(;c<l&&a[c]<v;){if(f.length<h){let E=c+1+u;g&&g.type==="deleted"&&g._oldIndex===c-1?g.deleteToLineNumber++:(g={type:"deleted",_oldIndex:c,deleteFromLineNumber:E,deleteToLineNumber:E},f.push(g)),u--}c++}let S;if(c<l&&a[c]<=y)S=a[c],c++;else if(b===0?S=1:b+1===i?S=t:S=Math.round(b*r+s),f.length<h){let E=c+1+u;g&&g.type==="inserted"&&g._i===b-1?g.insertToLineNumber++:(g={type:"inserted",_i:b,insertFromLineNumber:E,insertToLineNumber:E},f.push(g)),u++}d[b]=S,p=S}if(f.length<h)for(;c<l;){let b=c+1+u;g&&g.type==="deleted"&&g._oldIndex===c-1?g.deleteToLineNumber++:(g={type:"deleted",_oldIndex:c,deleteFromLineNumber:b,deleteToLineNumber:b},f.push(g)),u--,c++}else f=[{type:"flush"}];return[new o(r,d),f]}modelLineToMinimapLine(e){return Math.min(this.minimapLines.length,Math.max(1,Math.round(e/this.samplingRatio)))}modelLineRangeToMinimapLineRange(e,t){let n=this.modelLineToMinimapLine(e)-1;for(;n>0&&this.minimapLines[n-1]>=e;)n--;let i=this.modelLineToMinimapLine(t)-1;for(;i+1<this.minimapLines.length&&this.minimapLines[i+1]<=t;)i++;if(n===i){let r=this.minimapLines[n];if(r<e||r>t)return null}return[n+1,i+1]}decorationLineRangeToMinimapLineRange(e,t){let n=this.modelLineToMinimapLine(e),i=this.modelLineToMinimapLine(t);return e!==t&&i===n&&(i===this.minimapLines.length?n>1&&n--:i++),[n,i]}onLinesDeleted(e){let t=e.toLineNumber-e.fromLineNumber+1,n=this.minimapLines.length,i=0;for(let r=this.minimapLines.length-1;r>=0&&!(this.minimapLines[r]<e.fromLineNumber);r--)this.minimapLines[r]<=e.toLineNumber?(this.minimapLines[r]=Math.max(1,e.fromLineNumber-1),n=Math.min(n,r),i=Math.max(i,r)):this.minimapLines[r]-=t;return[n,i]}onLinesInserted(e){let t=e.toLineNumber-e.fromLineNumber+1;for(let n=this.minimapLines.length-1;n>=0&&!(this.minimapLines[n]<e.fromLineNumber);n--)this.minimapLines[n]+=t}},Bw=class extends Yt{tokensColorTracker;_selections;_minimapSelections;options;_samplingState;_shouldCheckSampling;_sectionHeaderCache=new Jo(10,1.5);_actual;constructor(e){super(e),this.tokensColorTracker=ug.getInstance(),this._selections=[],this._minimapSelections=null,this.options=new Ow(this._context.configuration,this._context.theme,this.tokensColorTracker);let[t]=Fw.compute(this.options,this._context.viewModel.getLineCount(),null);this._samplingState=t,this._shouldCheckSampling=!1,this._actual=new CO(e.theme,this)}dispose(){this._actual.dispose(),super.dispose()}getDomNode(){return this._actual.getDomNode()}_onOptionsMaybeChanged(){let e=new Ow(this._context.configuration,this._context.theme,this.tokensColorTracker);return this.options.equals(e)?!1:(this.options=e,this._recreateLineSampling(),this._actual.onDidChangeOptions(),!0)}onConfigurationChanged(e){return this._onOptionsMaybeChanged()}onCursorStateChanged(e){return this._selections=e.selections,this._minimapSelections=null,this._actual.onSelectionChanged()}onDecorationsChanged(e){return e.affectsMinimap?this._actual.onDecorationsChanged():!1}onFlushed(e){return this._samplingState&&(this._shouldCheckSampling=!0),this._actual.onFlushed()}onLinesChanged(e){if(this._samplingState){let t=this._samplingState.modelLineRangeToMinimapLineRange(e.fromLineNumber,e.fromLineNumber+e.count-1);return t?this._actual.onLinesChanged(t[0],t[1]-t[0]+1):!1}else return this._actual.onLinesChanged(e.fromLineNumber,e.count)}onLinesDeleted(e){if(this._samplingState){let[t,n]=this._samplingState.onLinesDeleted(e);return t<=n&&this._actual.onLinesChanged(t+1,n-t+1),this._shouldCheckSampling=!0,!0}else return this._actual.onLinesDeleted(e.fromLineNumber,e.toLineNumber)}onLinesInserted(e){return this._samplingState?(this._samplingState.onLinesInserted(e),this._shouldCheckSampling=!0,!0):this._actual.onLinesInserted(e.fromLineNumber,e.toLineNumber)}onScrollChanged(e){return this._actual.onScrollChanged()}onThemeChanged(e){return this._actual.onThemeChanged(),this._onOptionsMaybeChanged(),!0}onTokensChanged(e){if(this._samplingState){let t=[];for(let n of e.ranges){let i=this._samplingState.modelLineRangeToMinimapLineRange(n.fromLineNumber,n.toLineNumber);i&&t.push({fromLineNumber:i[0],toLineNumber:i[1]})}return t.length?this._actual.onTokensChanged(t):!1}else return this._actual.onTokensChanged(e.ranges)}onTokensColorsChanged(e){return this._onOptionsMaybeChanged(),this._actual.onTokensColorsChanged()}onZonesChanged(e){return this._actual.onZonesChanged()}prepareRender(e){this._shouldCheckSampling&&(this._shouldCheckSampling=!1,this._recreateLineSampling())}render(e){let t=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber;this._samplingState&&(t=this._samplingState.modelLineToMinimapLine(t),n=this._samplingState.modelLineToMinimapLine(n));let i={viewportContainsWhitespaceGaps:e.viewportData.whitespaceViewportData.length>0,scrollWidth:e.scrollWidth,scrollHeight:e.scrollHeight,viewportStartLineNumber:t,viewportEndLineNumber:n,viewportStartLineNumberVerticalOffset:e.getVerticalOffsetForLineNumber(t),scrollTop:e.scrollTop,scrollLeft:e.scrollLeft,viewportWidth:e.viewportWidth,viewportHeight:e.viewportHeight};this._actual.render(i)}_recreateLineSampling(){this._minimapSelections=null;let e=!!this._samplingState,[t,n]=Fw.compute(this.options,this._context.viewModel.getLineCount(),this._samplingState);if(this._samplingState=t,e&&this._samplingState)for(let i of n)switch(i.type){case"deleted":this._actual.onLinesDeleted(i.deleteFromLineNumber,i.deleteToLineNumber);break;case"inserted":this._actual.onLinesInserted(i.insertFromLineNumber,i.insertToLineNumber);break;case"flush":this._actual.onFlushed();break}}getLineCount(){return this._samplingState?this._samplingState.minimapLines.length:this._context.viewModel.getLineCount()}getRealLineCount(){return this._context.viewModel.getLineCount()}getLineContent(e){return this._samplingState?this._context.viewModel.getLineContent(this._samplingState.minimapLines[e-1]):this._context.viewModel.getLineContent(e)}getLineMaxColumn(e){return this._samplingState?this._context.viewModel.getLineMaxColumn(this._samplingState.minimapLines[e-1]):this._context.viewModel.getLineMaxColumn(e)}getMinimapLinesRenderingData(e,t,n){if(this._samplingState){let i=[];for(let r=0,s=t-e+1;r<s;r++)n[r]?i[r]=this._context.viewModel.getViewLineData(this._samplingState.minimapLines[e+r-1]):i[r]=null;return i}return this._context.viewModel.getMinimapLinesRenderingData(e,t,n).data}getSelections(){if(this._minimapSelections===null)if(this._samplingState){this._minimapSelections=[];for(let e of this._selections){let[t,n]=this._samplingState.decorationLineRangeToMinimapLineRange(e.startLineNumber,e.endLineNumber);this._minimapSelections.push(new $e(t,e.startColumn,n,e.endColumn))}}else this._minimapSelections=this._selections;return this._minimapSelections}getMinimapDecorationsInViewport(e,t){let n=this._getMinimapDecorationsInViewport(e,t).filter(i=>!i.options.minimap?.sectionHeaderStyle);if(this._samplingState){let i=[];for(let r of n){if(!r.options.minimap)continue;let s=r.range,a=this._samplingState.modelLineToMinimapLine(s.startLineNumber),l=this._samplingState.modelLineToMinimapLine(s.endLineNumber);i.push(new sm(new P(a,s.startColumn,l,s.endColumn),r.options))}return i}return n}getSectionHeaderDecorationsInViewport(e,t){let n=this.options.minimapLineHeight,r=this.options.sectionHeaderFontSize/n;return e=Math.floor(Math.max(1,e-r)),this._getMinimapDecorationsInViewport(e,t).filter(s=>!!s.options.minimap?.sectionHeaderStyle)}_getMinimapDecorationsInViewport(e,t){let n;if(this._samplingState){let i=this._samplingState.minimapLines[e-1],r=this._samplingState.minimapLines[t-1];n=new P(i,1,r,this._context.viewModel.getLineMaxColumn(r))}else n=new P(e,1,t,this._context.viewModel.getLineMaxColumn(t));return this._context.viewModel.getMinimapDecorationsInRange(n)}getSectionHeaderText(e,t){let n=e.options.minimap?.sectionHeaderText;if(!n)return null;let i=this._sectionHeaderCache.get(n);if(i)return i;let r=t(n);return this._sectionHeaderCache.set(n,r),r}getOptions(){return this._context.viewModel.model.getOptions()}revealLineNumber(e){this._samplingState&&(e=this._samplingState.minimapLines[e-1]),this._context.viewModel.revealRange("mouse",!1,new P(e,1,e,1),1,0)}setScrollTop(e){this._context.viewModel.viewLayout.setScrollPosition({scrollTop:e},1)}},CO=class o extends F{_theme;_model;_domNode;_shadow;_canvas;_decorationsCanvas;_slider;_sliderHorizontal;_pointerDownListener;_sliderPointerMoveMonitor;_sliderPointerDownListener;_gestureDisposable;_sliderTouchStartListener;_sliderTouchMoveListener;_sliderTouchEndListener;_lastRenderData;_selectionColor;_renderDecorations=!1;_gestureInProgress=!1;_buffers;constructor(e,t){super(),this._theme=e,this._model=t,this._lastRenderData=null,this._buffers=null,this._selectionColor=this._theme.getColor(Pk),this._domNode=We(document.createElement("div")),ri.write(this._domNode,9),this._domNode.setClassName(this._getMinimapDomNodeClassName()),this._domNode.setPosition("absolute"),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._shadow=We(document.createElement("div")),this._shadow.setClassName("minimap-shadow-hidden"),this._domNode.appendChild(this._shadow),this._canvas=We(document.createElement("canvas")),this._canvas.setPosition("absolute"),this._canvas.setLeft(0),this._domNode.appendChild(this._canvas),this._decorationsCanvas=We(document.createElement("canvas")),this._decorationsCanvas.setPosition("absolute"),this._decorationsCanvas.setClassName("minimap-decorations-layer"),this._decorationsCanvas.setLeft(0),this._domNode.appendChild(this._decorationsCanvas),this._slider=We(document.createElement("div")),this._slider.setPosition("absolute"),this._slider.setClassName("minimap-slider"),this._slider.setLayerHinting(!0),this._slider.setContain("strict"),this._domNode.appendChild(this._slider),this._sliderHorizontal=We(document.createElement("div")),this._sliderHorizontal.setPosition("absolute"),this._sliderHorizontal.setClassName("minimap-slider-horizontal"),this._slider.appendChild(this._sliderHorizontal),this._applyLayout(),this._pointerDownListener=bn(this._domNode.domNode,me.POINTER_DOWN,n=>{if(n.preventDefault(),this._model.options.renderMinimap===0||!this._lastRenderData)return;if(this._model.options.size!=="proportional"){if(n.button===0&&this._lastRenderData){let d=io(this._slider.domNode),c=d.top+d.height/2;this._startSliderDragging(n,c,this._lastRenderData.renderedLayout)}return}let r=this._model.options.minimapLineHeight,s=this._model.options.canvasInnerHeight/this._model.options.canvasOuterHeight*n.offsetY,l=Math.floor(s/r)+this._lastRenderData.renderedLayout.startLineNumber-this._lastRenderData.renderedLayout.topPaddingLineCount;l=Math.min(l,this._model.getLineCount()),this._model.revealLineNumber(l)}),this._sliderPointerMoveMonitor=new Pa,this._sliderPointerDownListener=bn(this._slider.domNode,me.POINTER_DOWN,n=>{n.preventDefault(),n.stopPropagation(),n.button===0&&this._lastRenderData&&this._startSliderDragging(n,n.pageY,this._lastRenderData.renderedLayout)}),this._gestureDisposable=An.addTarget(this._domNode.domNode),this._sliderTouchStartListener=j(this._domNode.domNode,Et.Start,n=>{n.preventDefault(),n.stopPropagation(),this._lastRenderData&&(this._slider.toggleClassName("active",!0),this._gestureInProgress=!0,this.scrollDueToTouchEvent(n))},{passive:!1}),this._sliderTouchMoveListener=j(this._domNode.domNode,Et.Change,n=>{n.preventDefault(),n.stopPropagation(),this._lastRenderData&&this._gestureInProgress&&this.scrollDueToTouchEvent(n)},{passive:!1}),this._sliderTouchEndListener=bn(this._domNode.domNode,Et.End,n=>{n.preventDefault(),n.stopPropagation(),this._gestureInProgress=!1,this._slider.toggleClassName("active",!1)})}_startSliderDragging(e,t,n){if(!e.target||!(e.target instanceof Element))return;let i=e.pageX;this._slider.toggleClassName("active",!0);let r=(s,a)=>{let l=io(this._domNode.domNode),d=Math.min(Math.abs(a-i),Math.abs(a-l.left),Math.abs(a-l.left-l.width));if(pt&&d>Mj){this._model.setScrollTop(n.scrollTop);return}let c=s-t;this._model.setScrollTop(n.getDesiredScrollTopFromDelta(c))};e.pageY!==t&&r(e.pageY,i),this._sliderPointerMoveMonitor.startMonitoring(e.target,e.pointerId,e.buttons,s=>r(s.pageY,s.pageX),()=>{this._slider.toggleClassName("active",!1)})}scrollDueToTouchEvent(e){let t=this._domNode.domNode.getBoundingClientRect().top,n=this._lastRenderData.renderedLayout.getDesiredScrollTopFromTouchLocation(e.pageY-t);this._model.setScrollTop(n)}dispose(){this._pointerDownListener.dispose(),this._sliderPointerMoveMonitor.dispose(),this._sliderPointerDownListener.dispose(),this._gestureDisposable.dispose(),this._sliderTouchStartListener.dispose(),this._sliderTouchMoveListener.dispose(),this._sliderTouchEndListener.dispose(),super.dispose()}_getMinimapDomNodeClassName(){let e=["minimap"];return this._model.options.showSlider==="always"?e.push("slider-always"):e.push("slider-mouseover"),this._model.options.autohide&&e.push("autohide"),e.join(" ")}getDomNode(){return this._domNode}_applyLayout(){this._domNode.setLeft(this._model.options.minimapLeft),this._domNode.setWidth(this._model.options.minimapWidth),this._domNode.setHeight(this._model.options.minimapHeight),this._shadow.setHeight(this._model.options.minimapHeight),this._canvas.setWidth(this._model.options.canvasOuterWidth),this._canvas.setHeight(this._model.options.canvasOuterHeight),this._canvas.domNode.width=this._model.options.canvasInnerWidth,this._canvas.domNode.height=this._model.options.canvasInnerHeight,this._decorationsCanvas.setWidth(this._model.options.canvasOuterWidth),this._decorationsCanvas.setHeight(this._model.options.canvasOuterHeight),this._decorationsCanvas.domNode.width=this._model.options.canvasInnerWidth,this._decorationsCanvas.domNode.height=this._model.options.canvasInnerHeight,this._slider.setWidth(this._model.options.minimapWidth)}_getBuffer(){return this._buffers||this._model.options.canvasInnerWidth>0&&this._model.options.canvasInnerHeight>0&&(this._buffers=new IO(this._canvas.domNode.getContext("2d"),this._model.options.canvasInnerWidth,this._model.options.canvasInnerHeight,this._model.options.backgroundColor)),this._buffers?this._buffers.getBuffer():null}onDidChangeOptions(){this._lastRenderData=null,this._buffers=null,this._applyLayout(),this._domNode.setClassName(this._getMinimapDomNodeClassName())}onSelectionChanged(){return this._renderDecorations=!0,!0}onDecorationsChanged(){return this._renderDecorations=!0,!0}onFlushed(){return this._lastRenderData=null,!0}onLinesChanged(e,t){return this._lastRenderData?this._lastRenderData.onLinesChanged(e,t):!1}onLinesDeleted(e,t){return this._lastRenderData?.onLinesDeleted(e,t),!0}onLinesInserted(e,t){return this._lastRenderData?.onLinesInserted(e,t),!0}onScrollChanged(){return this._renderDecorations=!0,!0}onThemeChanged(){return this._selectionColor=this._theme.getColor(Pk),this._renderDecorations=!0,!0}onTokensChanged(e){return this._lastRenderData?this._lastRenderData.onTokensChanged(e):!1}onTokensColorsChanged(){return this._lastRenderData=null,this._buffers=null,!0}onZonesChanged(){return this._lastRenderData=null,!0}render(e){if(this._model.options.renderMinimap===0){this._shadow.setClassName("minimap-shadow-hidden"),this._sliderHorizontal.setWidth(0),this._sliderHorizontal.setHeight(0);return}e.scrollLeft+e.viewportWidth>=e.scrollWidth?this._shadow.setClassName("minimap-shadow-hidden"):this._shadow.setClassName("minimap-shadow-visible");let n=yO.create(this._model.options,e.viewportStartLineNumber,e.viewportEndLineNumber,e.viewportStartLineNumberVerticalOffset,e.viewportHeight,e.viewportContainsWhitespaceGaps,this._model.getLineCount(),this._model.getRealLineCount(),e.scrollTop,e.scrollHeight,this._lastRenderData?this._lastRenderData.renderedLayout:null);this._slider.setDisplay(n.sliderNeeded?"block":"none"),this._slider.setTop(n.sliderTop),this._slider.setHeight(n.sliderHeight),this._sliderHorizontal.setLeft(0),this._sliderHorizontal.setWidth(this._model.options.minimapWidth),this._sliderHorizontal.setTop(0),this._sliderHorizontal.setHeight(n.sliderHeight),this.renderDecorations(n),this._lastRenderData=this.renderLines(n)}renderDecorations(e){if(this._renderDecorations){this._renderDecorations=!1;let t=this._model.getSelections();t.sort(P.compareRangesUsingStarts);let n=this._model.getMinimapDecorationsInViewport(e.startLineNumber,e.endLineNumber);n.sort((p,h)=>(p.options.zIndex||0)-(h.options.zIndex||0));let{canvasInnerWidth:i,canvasInnerHeight:r}=this._model.options,s=this._model.options.minimapLineHeight,a=this._model.options.minimapCharWidth,l=this._model.getOptions().tabSize,d=this._decorationsCanvas.domNode.getContext("2d");d.clearRect(0,0,i,r);let c=new Vw(e.startLineNumber,e.endLineNumber,!1);this._renderSelectionLineHighlights(d,t,c,e,s),this._renderDecorationsLineHighlights(d,n,c,e,s);let u=new Vw(e.startLineNumber,e.endLineNumber,null);this._renderSelectionsHighlights(d,t,u,e,s,l,a,i),this._renderDecorationsHighlights(d,n,u,e,s,l,a,i),this._renderSectionHeaders(e)}}_renderSelectionLineHighlights(e,t,n,i,r){if(!this._selectionColor||this._selectionColor.isTransparent())return;e.fillStyle=this._selectionColor.transparent(.5).toString();let s=0,a=0;for(let l of t){let d=i.intersectWithViewport(l);if(!d)continue;let[c,u]=d;for(let f=c;f<=u;f++)n.set(f,!0);let p=i.getYForLineNumber(c,r),h=i.getYForLineNumber(u,r);a>=p||(a>s&&e.fillRect(Ds,s,e.canvas.width,a-s),s=p),a=h}a>s&&e.fillRect(Ds,s,e.canvas.width,a-s)}_renderDecorationsLineHighlights(e,t,n,i,r){let s=new Map;for(let a=t.length-1;a>=0;a--){let l=t[a],d=l.options.minimap;if(!d||d.position!==1)continue;let c=i.intersectWithViewport(l.range);if(!c)continue;let[u,p]=c,h=d.getColor(this._theme.value);if(!h||h.isTransparent())continue;let f=s.get(h.toString());f||(f=h.transparent(.5).toString(),s.set(h.toString(),f)),e.fillStyle=f;for(let g=u;g<=p;g++){if(n.has(g))continue;n.set(g,!0);let b=i.getYForLineNumber(u,r);e.fillRect(Ds,b,e.canvas.width,r)}}}_renderSelectionsHighlights(e,t,n,i,r,s,a,l){if(!(!this._selectionColor||this._selectionColor.isTransparent()))for(let d of t){let c=i.intersectWithViewport(d);if(!c)continue;let[u,p]=c;for(let h=u;h<=p;h++)this.renderDecorationOnLine(e,n,d,this._selectionColor,i,h,r,r,s,a,l)}}_renderDecorationsHighlights(e,t,n,i,r,s,a,l){for(let d of t){let c=d.options.minimap;if(!c)continue;let u=i.intersectWithViewport(d.range);if(!u)continue;let[p,h]=u,f=c.getColor(this._theme.value);if(!(!f||f.isTransparent()))for(let g=p;g<=h;g++)switch(c.position){case 1:this.renderDecorationOnLine(e,n,d.range,f,i,g,r,r,s,a,l);continue;case 2:{let b=i.getYForLineNumber(g,r);this.renderDecoration(e,f,2,b,Pj,r);continue}}}}renderDecorationOnLine(e,t,n,i,r,s,a,l,d,c,u){let p=r.getYForLineNumber(s,l);if(p+a<0||p>this._model.options.canvasInnerHeight)return;let{startLineNumber:h,endLineNumber:f}=n,g=h===s?n.startColumn:1,b=f===s?n.endColumn:this._model.getLineMaxColumn(s),v=this.getXOffsetForPosition(t,s,g,d,c,u),y=this.getXOffsetForPosition(t,s,b,d,c,u);this.renderDecoration(e,i,v,p,y-v,a)}getXOffsetForPosition(e,t,n,i,r,s){if(n===1)return Ds;if((n-1)*r>=s)return s;let l=e.get(t);if(!l){let d=this._model.getLineContent(t);l=[Ds];let c=Ds;for(let u=1;u<d.length+1;u++){let p=d.charCodeAt(u-1),h=p===9?i*r:Rr(p)?2*r:r,f=c+h;if(f>=s){l[u]=s;break}l[u]=f,c=f}e.set(t,l)}return n-1<l.length?l[n-1]:s}renderDecoration(e,t,n,i,r,s){e.fillStyle=t&&t.toString()||"",e.fillRect(n,i,r,s)}_renderSectionHeaders(e){let t=this._model.options.minimapLineHeight,n=this._model.options.sectionHeaderFontSize,i=this._model.options.sectionHeaderLetterSpacing,r=n*1.5,{canvasInnerWidth:s}=this._model.options,a=this._model.options.backgroundColor,l=`rgb(${a.r} ${a.g} ${a.b} / .7)`,d=this._model.options.sectionHeaderFontColor,c=`rgb(${d.r} ${d.g} ${d.b})`,u=c,p=this._decorationsCanvas.domNode.getContext("2d");p.letterSpacing=i+"px",p.font="500 "+n+"px "+this._model.options.sectionHeaderFontFamily,p.strokeStyle=u,p.lineWidth=.2;let h=this._model.getSectionHeaderDecorationsInViewport(e.startLineNumber,e.endLineNumber);h.sort((g,b)=>g.range.startLineNumber-b.range.startLineNumber);let f=o._fitSectionHeader.bind(null,p,s-Ds);for(let g of h){let b=e.getYForLineNumber(g.range.startLineNumber,t)+n,v=b-n,y=v+2,S=this._model.getSectionHeaderText(g,f);o._renderSectionLabel(p,S,g.options.minimap?.sectionHeaderStyle===2,l,c,s,v,r,b,y)}}static _fitSectionHeader(e,t,n){if(!n)return n;let i="\u2026",r=e.measureText(n).width,s=e.measureText(i).width;if(r<=t||r<=s)return n;let a=n.length,l=r/n.length,d=Math.floor((t-s)/l)-1,c=Math.ceil(d/2);for(;c>0&&/\s/.test(n[c-1]);)--c;return n.substring(0,c)+i+n.substring(a-(d-c))}static _renderSectionLabel(e,t,n,i,r,s,a,l,d,c){t&&(e.fillStyle=i,e.fillRect(0,a,s,l),e.fillStyle=r,e.fillText(t,Ds,d)),n&&(e.beginPath(),e.moveTo(0,c),e.lineTo(s,c),e.closePath(),e.stroke())}renderLines(e){let t=e.startLineNumber,n=e.endLineNumber,i=this._model.options.minimapLineHeight;if(this._lastRenderData&&this._lastRenderData.linesEquals(e)){let ne=this._lastRenderData._get();return new Aw(e,ne.imageData,ne.lines)}let r=this._getBuffer();if(!r)return null;let[s,a,l]=o._renderUntouchedLines(r,e.topPaddingLineCount,t,n,i,this._lastRenderData),d=this._model.getMinimapLinesRenderingData(t,n,l),c=this._model.getOptions().tabSize,u=this._model.options.defaultBackgroundColor,p=this._model.options.backgroundColor,h=this._model.options.foregroundAlpha,f=this._model.tokensColorTracker,g=f.backgroundIsLight(),b=this._model.options.renderMinimap,v=this._model.options.charRenderer(),y=this._model.options.fontScale,S=this._model.options.minimapCharWidth,C=(b===1?2:3)*y,w=i>C?Math.floor((i-C)/2):0,_=p.a/255,L=new Qs(Math.round((p.r-u.r)*_+u.r),Math.round((p.g-u.g)*_+u.g),Math.round((p.b-u.b)*_+u.b),255),k=e.topPaddingLineCount*i,W=[];for(let ne=0,Q=n-t+1;ne<Q;ne++)l[ne]&&o._renderLine(r,L,p.a,g,b,S,f,h,v,k,w,c,d[ne],y,i),W[ne]=new Nw(k),k+=i;let K=s===-1?0:s,oe=(a===-1?r.height:a)-K;return this._canvas.domNode.getContext("2d").putImageData(r,0,0,0,K,r.width,oe),new Aw(e,r,W)}static _renderUntouchedLines(e,t,n,i,r,s){let a=[];if(!s){for(let k=0,W=i-n+1;k<W;k++)a[k]=!0;return[-1,-1,a]}let l=s._get(),d=l.imageData.data,c=l.rendLineNumberStart,u=l.lines,p=u.length,h=e.width,f=e.data,g=(i-n+1)*r*h*4,b=-1,v=-1,y=-1,S=-1,E=-1,C=-1,w=t*r;for(let k=n;k<=i;k++){let W=k-n,K=k-c,U=K>=0&&K<p?u[K].dy:-1;if(U===-1){a[W]=!0,w+=r;continue}let oe=U*h*4,Se=(U+r)*h*4,ne=w*h*4,Q=(w+r)*h*4;S===oe&&C===ne?(S=Se,C=Q):(y!==-1&&(f.set(d.subarray(y,S),E),b===-1&&y===0&&y===E&&(b=S),v===-1&&S===g&&y===E&&(v=y)),y=oe,S=Se,E=ne,C=Q),a[W]=!1,w+=r}y!==-1&&(f.set(d.subarray(y,S),E),b===-1&&y===0&&y===E&&(b=S),v===-1&&S===g&&y===E&&(v=y));let _=b===-1?-1:b/(h*4),L=v===-1?-1:v/(h*4);return[_,L,a]}static _renderLine(e,t,n,i,r,s,a,l,d,c,u,p,h,f,g){let b=h.content,v=h.tokens,y=e.width-s,S=g===1,E=Ds,C=0,w=0;for(let _=0,L=v.getCount();_<L;_++){let k=v.getEndOffset(_),W=v.getForeground(_),K=a.getColor(W);for(;C<k;C++){if(E>y)return;let U=b.charCodeAt(C);if(U===9){let oe=p-(C+w)%p;w+=oe-1,E+=oe*s}else if(U===32)E+=s;else{let oe=Rr(U)?2:1;for(let Se=0;Se<oe;Se++)if(r===2?d.blockRenderChar(e,E,c+u,K,l,t,n,S):d.renderChar(e,E,c+u,U,K,l,t,n,f,i,S),E+=s,E>y)return}}}}},Vw=class{_startLineNumber;_endLineNumber;_defaultValue;_values;constructor(e,t,n){this._startLineNumber=e,this._endLineNumber=t,this._defaultValue=n,this._values=[];for(let i=0,r=this._endLineNumber-this._startLineNumber+1;i<r;i++)this._values[i]=n}has(e){return this.get(e)!==this._defaultValue}set(e,t){e<this._startLineNumber||e>this._endLineNumber||(this._values[e-this._startLineNumber]=t)}get(e){return e<this._startLineNumber||e>this._endLineNumber?this._defaultValue:this._values[e-this._startLineNumber]}};var Ww=class extends Yt{_viewDomNode;_widgets;_viewDomNodeRect;_domNode;overflowingOverlayWidgetsDomNode;_verticalScrollbarWidth;_minimapWidth;_horizontalScrollbarHeight;_editorHeight;_editorWidth;constructor(e,t){super(e),this._viewDomNode=t;let i=this._context.configuration.options.get(147);this._widgets={},this._verticalScrollbarWidth=i.verticalScrollbarWidth,this._minimapWidth=i.minimap.minimapWidth,this._horizontalScrollbarHeight=i.horizontalScrollbarHeight,this._editorHeight=i.height,this._editorWidth=i.width,this._viewDomNodeRect={top:0,left:0,width:0,height:0},this._domNode=We(document.createElement("div")),ri.write(this._domNode,4),this._domNode.setClassName("overlayWidgets"),this.overflowingOverlayWidgetsDomNode=We(document.createElement("div")),ri.write(this.overflowingOverlayWidgetsDomNode,5),this.overflowingOverlayWidgetsDomNode.setClassName("overflowingOverlayWidgets")}dispose(){super.dispose(),this._widgets={}}getDomNode(){return this._domNode}onConfigurationChanged(e){let n=this._context.configuration.options.get(147);return this._verticalScrollbarWidth=n.verticalScrollbarWidth,this._minimapWidth=n.minimap.minimapWidth,this._horizontalScrollbarHeight=n.horizontalScrollbarHeight,this._editorHeight=n.height,this._editorWidth=n.width,!0}addWidget(e){let t=We(e.getDomNode());this._widgets[e.getId()]={widget:e,preference:null,domNode:t},t.setPosition("absolute"),t.setAttribute("widgetId",e.getId()),e.allowEditorOverflow?this.overflowingOverlayWidgetsDomNode.appendChild(t):this._domNode.appendChild(t),this.setShouldRender(),this._updateMaxMinWidth()}setWidgetPosition(e,t){let n=this._widgets[e.getId()],i=t?t.preference:null,r=t?.stackOridinal;return n.preference===i&&n.stack===r?(this._updateMaxMinWidth(),!1):(n.preference=i,n.stack=r,this.setShouldRender(),this._updateMaxMinWidth(),!0)}removeWidget(e){let t=e.getId();if(this._widgets.hasOwnProperty(t)){let i=this._widgets[t].domNode.domNode;delete this._widgets[t],i.remove(),this.setShouldRender(),this._updateMaxMinWidth()}}_updateMaxMinWidth(){let e=0,t=Object.keys(this._widgets);for(let n=0,i=t.length;n<i;n++){let r=t[n],a=this._widgets[r].widget.getMinContentWidthInPx?.();typeof a<"u"&&(e=Math.max(e,a))}this._context.viewLayout.setOverlayWidgetsMinWidth(e)}_renderWidget(e,t){let n=e.domNode;if(e.preference===null){n.setTop("");return}let i=2*this._verticalScrollbarWidth+this._minimapWidth;if(e.preference===0||e.preference===1){if(e.preference===1){let r=n.domNode.clientHeight;n.setTop(this._editorHeight-r-2*this._horizontalScrollbarHeight)}else n.setTop(0);e.stack!==void 0?(n.setTop(t[e.preference]),t[e.preference]+=n.domNode.clientWidth):n.setRight(i)}else if(e.preference===2)n.domNode.style.right="50%",e.stack!==void 0?(n.setTop(t[2]),t[2]+=n.domNode.clientHeight):n.setTop(0);else{let{top:r,left:s}=e.preference;if(this._context.configuration.options.get(43)&&e.widget.allowEditorOverflow){let l=this._viewDomNodeRect;n.setTop(r+l.top),n.setLeft(s+l.left),n.setPosition("fixed")}else n.setTop(r),n.setLeft(s),n.setPosition("absolute")}}prepareRender(e){this._viewDomNodeRect=io(this._viewDomNode.domNode)}render(e){this._domNode.setWidth(this._editorWidth);let t=Object.keys(this._widgets),n=Array.from({length:3},()=>0);t.sort((i,r)=>(this._widgets[i].stack||0)-(this._widgets[r].stack||0));for(let i=0,r=t.length;i<r;i++){let s=t[i];this._renderWidget(this._widgets[s],n)}}};var SO=class{lineHeight;pixelRatio;overviewRulerLanes;renderBorder;borderColor;hideCursor;cursorColorSingle;cursorColorPrimary;cursorColorSecondary;themeType;backgroundColor;top;right;domWidth;domHeight;canvasWidth;canvasHeight;x;w;constructor(e,t){let n=e.options;this.lineHeight=n.get(68),this.pixelRatio=n.get(145),this.overviewRulerLanes=n.get(84),this.renderBorder=n.get(83);let i=t.getColor(QH);this.borderColor=i?i.toString():null,this.hideCursor=n.get(60);let r=t.getColor(Im);this.cursorColorSingle=r?r.transparent(.7).toString():null;let s=t.getColor(LT);this.cursorColorPrimary=s?s.transparent(.7).toString():null;let a=t.getColor(RT);this.cursorColorSecondary=a?a.transparent(.7).toString():null,this.themeType=t.type;let l=n.get(74),d=l.enabled,c=l.side,u=t.getColor(JH),p=cr.getDefaultBackground();u?this.backgroundColor=u:d&&c==="right"?this.backgroundColor=p:this.backgroundColor=null;let f=n.get(147).overviewRuler;this.top=f.top,this.right=f.right,this.domWidth=f.width,this.domHeight=f.height,this.overviewRulerLanes===0?(this.canvasWidth=0,this.canvasHeight=0):(this.canvasWidth=this.domWidth*this.pixelRatio|0,this.canvasHeight=this.domHeight*this.pixelRatio|0);let[g,b]=this._initLanes(1,this.canvasWidth,this.overviewRulerLanes);this.x=g,this.w=b}_initLanes(e,t,n){let i=t-e;if(n>=3){let r=Math.floor(i/3),s=Math.floor(i/3),a=i-r-s,l=e,d=l+r,c=l+r+a;return[[0,l,d,l,c,l,d,l],[0,r,a,r+a,s,r+a+s,a+s,r+a+s]]}else if(n===2){let r=Math.floor(i/2),s=i-r,a=e,l=a+r;return[[0,a,a,a,l,a,a,a],[0,r,r,r,s,r+s,r+s,r+s]]}else{let r=e,s=i;return[[0,r,r,r,r,r,r,r],[0,s,s,s,s,s,s,s]]}}equals(e){return this.lineHeight===e.lineHeight&&this.pixelRatio===e.pixelRatio&&this.overviewRulerLanes===e.overviewRulerLanes&&this.renderBorder===e.renderBorder&&this.borderColor===e.borderColor&&this.hideCursor===e.hideCursor&&this.cursorColorSingle===e.cursorColorSingle&&this.cursorColorPrimary===e.cursorColorPrimary&&this.cursorColorSecondary===e.cursorColorSecondary&&this.themeType===e.themeType&&H.equals(this.backgroundColor,e.backgroundColor)&&this.top===e.top&&this.right===e.right&&this.domWidth===e.domWidth&&this.domHeight===e.domHeight&&this.canvasWidth===e.canvasWidth&&this.canvasHeight===e.canvasHeight}};var Hw=class extends Yt{_actualShouldRender=0;_tokensColorTrackerListener;_domNode;_settings;_cursorPositions;_renderedDecorations=[];_renderedCursorPositions=[];constructor(e){super(e),this._domNode=We(document.createElement("canvas")),this._domNode.setClassName("decorationsOverviewRuler"),this._domNode.setPosition("absolute"),this._domNode.setLayerHinting(!0),this._domNode.setContain("strict"),this._domNode.setAttribute("aria-hidden","true"),this._updateSettings(!1),this._tokensColorTrackerListener=cr.onDidChange(t=>{t.changedColorMap&&this._updateSettings(!0)}),this._cursorPositions=[{position:new A(1,1),color:this._settings.cursorColorSingle}]}dispose(){super.dispose(),this._tokensColorTrackerListener.dispose()}_updateSettings(e){let t=new SO(this._context.configuration,this._context.theme);return this._settings&&this._settings.equals(t)?!1:(this._settings=t,this._domNode.setTop(this._settings.top),this._domNode.setRight(this._settings.right),this._domNode.setWidth(this._settings.domWidth),this._domNode.setHeight(this._settings.domHeight),this._domNode.domNode.width=this._settings.canvasWidth,this._domNode.domNode.height=this._settings.canvasHeight,e&&this._render(),!0)}_markRenderingIsNeeded(){return this._actualShouldRender=2,!0}_markRenderingIsMaybeNeeded(){return this._actualShouldRender=1,!0}onConfigurationChanged(e){return this._updateSettings(!1)?this._markRenderingIsNeeded():!1}onCursorStateChanged(e){this._cursorPositions=[];for(let t=0,n=e.selections.length;t<n;t++){let i=this._settings.cursorColorSingle;n>1&&(i=t===0?this._settings.cursorColorPrimary:this._settings.cursorColorSecondary),this._cursorPositions.push({position:e.selections[t].getPosition(),color:i})}return this._cursorPositions.sort((t,n)=>A.compare(t.position,n.position)),this._markRenderingIsMaybeNeeded()}onDecorationsChanged(e){return e.affectsOverviewRuler?this._markRenderingIsMaybeNeeded():!1}onFlushed(e){return this._markRenderingIsNeeded()}onScrollChanged(e){return e.scrollHeightChanged?this._markRenderingIsNeeded():!1}onZonesChanged(e){return this._markRenderingIsNeeded()}onThemeChanged(e){return this._updateSettings(!1)?this._markRenderingIsNeeded():!1}getDomNode(){return this._domNode.domNode}prepareRender(e){}render(e){this._render(),this._actualShouldRender=0}_render(){let e=this._settings.backgroundColor;if(this._settings.overviewRulerLanes===0){this._domNode.setBackgroundColor(e?H.Format.CSS.formatHexA(e):""),this._domNode.setDisplay("none");return}let t=this._context.viewModel.getAllOverviewRulerDecorations(this._context.theme);if(t.sort(Au.compareByRenderingProps),this._actualShouldRender===1&&!Au.equalsArr(this._renderedDecorations,t)&&(this._actualShouldRender=2),this._actualShouldRender===1&&!zt(this._renderedCursorPositions,this._cursorPositions,(f,g)=>f.position.lineNumber===g.position.lineNumber&&f.color===g.color)&&(this._actualShouldRender=2),this._actualShouldRender===1)return;this._renderedDecorations=t,this._renderedCursorPositions=this._cursorPositions,this._domNode.setDisplay("block");let n=this._settings.canvasWidth,i=this._settings.canvasHeight,r=this._settings.lineHeight,s=this._context.viewLayout,a=this._context.viewLayout.getScrollHeight(),l=i/a,d=6*this._settings.pixelRatio|0,c=d/2|0,u=this._domNode.domNode.getContext("2d");e?e.isOpaque()?(u.fillStyle=H.Format.CSS.formatHexA(e),u.fillRect(0,0,n,i)):(u.clearRect(0,0,n,i),u.fillStyle=H.Format.CSS.formatHexA(e),u.fillRect(0,0,n,i)):u.clearRect(0,0,n,i);let p=this._settings.x,h=this._settings.w;for(let f of t){let g=f.color,b=f.data;u.fillStyle=g;let v=0,y=0,S=0;for(let E=0,C=b.length/3;E<C;E++){let w=b[3*E],_=b[3*E+1],L=b[3*E+2],k=s.getVerticalOffsetForLineNumber(_)*l|0,W=(s.getVerticalOffsetForLineNumber(L)+r)*l|0;if(W-k<d){let U=(k+W)/2|0;U<c?U=c:U+c>i&&(U=i-c),k=U-c,W=U+c}k>S+1||w!==v?(E!==0&&u.fillRect(p[v],y,h[v],S-y),v=w,y=k,S=W):W>S&&(S=W)}u.fillRect(p[v],y,h[v],S-y)}if(!this._settings.hideCursor){let f=2*this._settings.pixelRatio|0,g=f/2|0,b=this._settings.x[7],v=this._settings.w[7],y=-100,S=-100,E=null;for(let C=0,w=this._cursorPositions.length;C<w;C++){let _=this._cursorPositions[C].color;if(!_)continue;let L=this._cursorPositions[C].position,k=s.getVerticalOffsetForLineNumber(L.lineNumber)*l|0;k<g?k=g:k+g>i&&(k=i-g);let W=k-g,K=W+f;W>S+1||_!==E?(C!==0&&E&&u.fillRect(b,y,v,S-y),y=W,S=K):K>S&&(S=K),E=_,u.fillStyle=_}E&&u.fillRect(b,y,v,S-y)}this._settings.renderBorder&&this._settings.borderColor&&this._settings.overviewRulerLanes>0&&(u.beginPath(),u.lineWidth=1,u.strokeStyle=this._settings.borderColor,u.moveTo(0,0),u.lineTo(0,i),u.moveTo(1,0),u.lineTo(n,0),u.stroke())}};var Uw=class extends as{_context;_domNode;_zoneManager;constructor(e,t){super(),this._context=e;let n=this._context.configuration.options;this._domNode=We(document.createElement("canvas")),this._domNode.setClassName(t),this._domNode.setPosition("absolute"),this._domNode.setLayerHinting(!0),this._domNode.setContain("strict"),this._zoneManager=new iE(i=>this._context.viewLayout.getVerticalOffsetForLineNumber(i)),this._zoneManager.setDOMWidth(0),this._zoneManager.setDOMHeight(0),this._zoneManager.setOuterHeight(this._context.viewLayout.getScrollHeight()),this._zoneManager.setLineHeight(n.get(68)),this._zoneManager.setPixelRatio(n.get(145)),this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}onConfigurationChanged(e){let t=this._context.configuration.options;return e.hasChanged(68)&&(this._zoneManager.setLineHeight(t.get(68)),this._render()),e.hasChanged(145)&&(this._zoneManager.setPixelRatio(t.get(145)),this._domNode.setWidth(this._zoneManager.getDOMWidth()),this._domNode.setHeight(this._zoneManager.getDOMHeight()),this._domNode.domNode.width=this._zoneManager.getCanvasWidth(),this._domNode.domNode.height=this._zoneManager.getCanvasHeight(),this._render()),!0}onFlushed(e){return this._render(),!0}onScrollChanged(e){return e.scrollHeightChanged&&(this._zoneManager.setOuterHeight(e.scrollHeight),this._render()),!0}onZonesChanged(e){return this._render(),!0}getDomNode(){return this._domNode.domNode}setLayout(e){this._domNode.setTop(e.top),this._domNode.setRight(e.right);let t=!1;t=this._zoneManager.setDOMWidth(e.width)||t,t=this._zoneManager.setDOMHeight(e.height)||t,t&&(this._domNode.setWidth(this._zoneManager.getDOMWidth()),this._domNode.setHeight(this._zoneManager.getDOMHeight()),this._domNode.domNode.width=this._zoneManager.getCanvasWidth(),this._domNode.domNode.height=this._zoneManager.getCanvasHeight(),this._render())}setZones(e){this._zoneManager.setZones(e),this._render()}_render(){if(this._zoneManager.getOuterHeight()===0)return!1;let e=this._zoneManager.getCanvasWidth(),t=this._zoneManager.getCanvasHeight(),n=this._zoneManager.resolveColorZones(),i=this._zoneManager.getId2Color(),r=this._domNode.domNode.getContext("2d");return r.clearRect(0,0,e,t),n.length>0&&this._renderOneLane(r,n,i,e),!0}_renderOneLane(e,t,n,i){let r=0,s=0,a=0;for(let l of t){let d=l.colorId,c=l.from,u=l.to;d!==r?(e.fillRect(0,s,i,a-s),r=d,e.fillStyle=n[r],s=c,a=u):a>=c?a=Math.max(a,u):(e.fillRect(0,s,i,a-s),s=c,a=u)}e.fillRect(0,s,i,a-s)}};var zw=class extends Yt{domNode;_renderedRulers;_rulers;_typicalHalfwidthCharacterWidth;constructor(e){super(e),this.domNode=We(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.domNode.setClassName("view-rulers"),this._renderedRulers=[];let t=this._context.configuration.options;this._rulers=t.get(104),this._typicalHalfwidthCharacterWidth=t.get(51).typicalHalfwidthCharacterWidth}dispose(){super.dispose()}onConfigurationChanged(e){let t=this._context.configuration.options;return this._rulers=t.get(104),this._typicalHalfwidthCharacterWidth=t.get(51).typicalHalfwidthCharacterWidth,!0}onScrollChanged(e){return e.scrollHeightChanged}prepareRender(e){}_ensureRulersCount(){let e=this._renderedRulers.length,t=this._rulers.length;if(e===t)return;if(e<t){let{tabSize:i}=this._context.viewModel.model.getOptions(),r=i,s=t-e;for(;s>0;){let a=We(document.createElement("div"));a.setClassName("view-ruler"),a.setWidth(r),this.domNode.appendChild(a),this._renderedRulers.push(a),s--}return}let n=e-t;for(;n>0;){let i=this._renderedRulers.pop();this.domNode.removeChild(i),n--}}render(e){this._ensureRulersCount();for(let t=0,n=this._rulers.length;t<n;t++){let i=this._renderedRulers[t],r=this._rulers[t];i.setBoxShadow(r.color?`1px 0 0 0 ${r.color} inset`:""),i.setHeight(Math.min(e.scrollHeight,1e6)),i.setLeft(r.column*this._typicalHalfwidthCharacterWidth)}}};var Kw=class extends Yt{_domNode;_scrollTop;_width;_shouldShow;_useShadows;constructor(e){super(e),this._scrollTop=0,this._width=0,this._updateWidth(),this._shouldShow=!1;let n=this._context.configuration.options.get(105);this._useShadows=n.useShadows,this._domNode=We(document.createElement("div")),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true")}dispose(){super.dispose()}_updateShouldShow(){let e=this._useShadows&&this._scrollTop>0;return this._shouldShow!==e?(this._shouldShow=e,!0):!1}getDomNode(){return this._domNode}_updateWidth(){let t=this._context.configuration.options.get(147);t.minimap.renderMinimap===0||t.minimap.minimapWidth>0&&t.minimap.minimapLeft===0?this._width=t.width:this._width=t.width-t.verticalScrollbarWidth}onConfigurationChanged(e){let n=this._context.configuration.options.get(105);return this._useShadows=n.useShadows,this._updateWidth(),this._updateShouldShow(),!0}onScrollChanged(e){return this._scrollTop=e.scrollTop,this._updateShouldShow()}prepareRender(e){}render(e){this._domNode.setWidth(this._width),this._domNode.setClassName(this._shouldShow?"scroll-decoration":"")}};var EO=class{left;width;startStyle;endStyle;constructor(e){this.left=e.left,this.width=e.width,this.startStyle=null,this.endStyle=null}},TO=class{lineNumber;ranges;constructor(e,t){this.lineNumber=e,this.ranges=t}};function Oj(o){return new EO(o)}function Nj(o){return new TO(o.lineNumber,o.ranges.map(Oj))}var jw=class o extends _o{static SELECTION_CLASS_NAME="selected-text";static SELECTION_TOP_LEFT="top-left-radius";static SELECTION_BOTTOM_LEFT="bottom-left-radius";static SELECTION_TOP_RIGHT="top-right-radius";static SELECTION_BOTTOM_RIGHT="bottom-right-radius";static EDITOR_BACKGROUND_CLASS_NAME="monaco-editor-background";static ROUNDED_PIECE_WIDTH=10;_context;_roundedSelection;_typicalHalfwidthCharacterWidth;_selections;_renderResult;constructor(e){super(),this._context=e;let t=this._context.configuration.options;this._roundedSelection=t.get(103),this._typicalHalfwidthCharacterWidth=t.get(51).typicalHalfwidthCharacterWidth,this._selections=[],this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){let t=this._context.configuration.options;return this._roundedSelection=t.get(103),this._typicalHalfwidthCharacterWidth=t.get(51).typicalHalfwidthCharacterWidth,!0}onCursorStateChanged(e){return this._selections=e.selections.slice(0),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_visibleRangesHaveGaps(e){for(let t=0,n=e.length;t<n;t++)if(e[t].ranges.length>1)return!0;return!1}_enrichVisibleRangesWithStyle(e,t,n){let i=this._typicalHalfwidthCharacterWidth/4,r=null,s=null;if(n&&n.length>0&&t.length>0){let a=t[0].lineNumber;if(a===e.startLineNumber)for(let d=0;!r&&d<n.length;d++)n[d].lineNumber===a&&(r=n[d].ranges[0]);let l=t[t.length-1].lineNumber;if(l===e.endLineNumber)for(let d=n.length-1;!s&&d>=0;d--)n[d].lineNumber===l&&(s=n[d].ranges[0]);r&&!r.startStyle&&(r=null),s&&!s.startStyle&&(s=null)}for(let a=0,l=t.length;a<l;a++){let d=t[a].ranges[0],c=d.left,u=d.left+d.width,p={top:0,bottom:0},h={top:0,bottom:0};if(a>0){let f=t[a-1].ranges[0].left,g=t[a-1].ranges[0].left+t[a-1].ranges[0].width;Gw(c-f)<i?p.top=2:c>f&&(p.top=1),Gw(u-g)<i?h.top=2:f<u&&u<g&&(h.top=1)}else r&&(p.top=r.startStyle.top,h.top=r.endStyle.top);if(a+1<l){let f=t[a+1].ranges[0].left,g=t[a+1].ranges[0].left+t[a+1].ranges[0].width;Gw(c-f)<i?p.bottom=2:f<c&&c<g&&(p.bottom=1),Gw(u-g)<i?h.bottom=2:u<g&&(h.bottom=1)}else s&&(p.bottom=s.startStyle.bottom,h.bottom=s.endStyle.bottom);d.startStyle=p,d.endStyle=h}}_getVisibleRangesWithStyle(e,t,n){let r=(t.linesVisibleRangesForRange(e,!0)||[]).map(Nj);return!this._visibleRangesHaveGaps(r)&&this._roundedSelection&&this._enrichVisibleRangesWithStyle(t.visibleRange,r,n),r}_createSelectionPiece(e,t,n,i,r){return'<div class="cslr '+n+'" style="top:'+e.toString()+"px;bottom:"+t.toString()+"px;left:"+i.toString()+"px;width:"+r.toString()+'px;"></div>'}_actualRenderOneSelection(e,t,n,i){if(i.length===0)return;let r=!!i[0].ranges[0].startStyle,s=i[0].lineNumber,a=i[i.length-1].lineNumber;for(let l=0,d=i.length;l<d;l++){let c=i[l],u=c.lineNumber,p=u-t,h=n&&u===s?1:0,f=n&&u!==s&&u===a?1:0,g="",b="";for(let v=0,y=c.ranges.length;v<y;v++){let S=c.ranges[v];if(r){let C=S.startStyle,w=S.endStyle;if(C.top===1||C.bottom===1){g+=this._createSelectionPiece(h,f,o.SELECTION_CLASS_NAME,S.left-o.ROUNDED_PIECE_WIDTH,o.ROUNDED_PIECE_WIDTH);let _=o.EDITOR_BACKGROUND_CLASS_NAME;C.top===1&&(_+=" "+o.SELECTION_TOP_RIGHT),C.bottom===1&&(_+=" "+o.SELECTION_BOTTOM_RIGHT),g+=this._createSelectionPiece(h,f,_,S.left-o.ROUNDED_PIECE_WIDTH,o.ROUNDED_PIECE_WIDTH)}if(w.top===1||w.bottom===1){g+=this._createSelectionPiece(h,f,o.SELECTION_CLASS_NAME,S.left+S.width,o.ROUNDED_PIECE_WIDTH);let _=o.EDITOR_BACKGROUND_CLASS_NAME;w.top===1&&(_+=" "+o.SELECTION_TOP_LEFT),w.bottom===1&&(_+=" "+o.SELECTION_BOTTOM_LEFT),g+=this._createSelectionPiece(h,f,_,S.left+S.width,o.ROUNDED_PIECE_WIDTH)}}let E=o.SELECTION_CLASS_NAME;if(r){let C=S.startStyle,w=S.endStyle;C.top===0&&(E+=" "+o.SELECTION_TOP_LEFT),C.bottom===0&&(E+=" "+o.SELECTION_BOTTOM_LEFT),w.top===0&&(E+=" "+o.SELECTION_TOP_RIGHT),w.bottom===0&&(E+=" "+o.SELECTION_BOTTOM_RIGHT)}b+=this._createSelectionPiece(h,f,E,S.left,S.width)}e[p][0]+=g,e[p][1]+=b}}_previousFrameVisibleRangesWithStyle=[];prepareRender(e){let t=[],n=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber;for(let s=n;s<=i;s++){let a=s-n;t[a]=["",""]}let r=[];for(let s=0,a=this._selections.length;s<a;s++){let l=this._selections[s];if(l.isEmpty()){r[s]=null;continue}let d=this._getVisibleRangesWithStyle(l,e,this._previousFrameVisibleRangesWithStyle[s]);r[s]=d,this._actualRenderOneSelection(t,n,this._selections.length>1,d)}this._previousFrameVisibleRangesWithStyle=r,this._renderResult=t.map(([s,a])=>s+a)}render(e,t){if(!this._renderResult)return"";let n=t-e;return n<0||n>=this._renderResult.length?"":this._renderResult[n]}};To((o,e)=>{let t=o.getColor(i2);t&&!t.isTransparent()&&e.addRule(`.monaco-editor .view-line span.inline-selected-text { color: ${t}; }`)});function Gw(o){return o<0?-o:o}var qw=class o extends Yt{static BLINK_INTERVAL=500;_readOnly;_cursorBlinking;_cursorStyle;_cursorSmoothCaretAnimation;_selectionIsEmpty;_isComposingInput;_isVisible;_domNode;_startCursorBlinkAnimation;_cursorFlatBlinkInterval;_blinkingEnabled;_editorHasFocus;_primaryCursor;_secondaryCursors;_renderData;constructor(e){super(e);let t=this._context.configuration.options;this._readOnly=t.get(93),this._cursorBlinking=t.get(26),this._cursorStyle=t.get(28),this._cursorSmoothCaretAnimation=t.get(27),this._selectionIsEmpty=!0,this._isComposingInput=!1,this._isVisible=!1,this._primaryCursor=new Kv(this._context,0),this._secondaryCursors=[],this._renderData=[],this._domNode=We(document.createElement("div")),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._updateDomClassName(),this._domNode.appendChild(this._primaryCursor.getDomNode()),this._startCursorBlinkAnimation=new Es,this._cursorFlatBlinkInterval=new Mh,this._blinkingEnabled=!1,this._editorHasFocus=!1,this._updateBlinking()}dispose(){super.dispose(),this._startCursorBlinkAnimation.dispose(),this._cursorFlatBlinkInterval.dispose()}getDomNode(){return this._domNode}onCompositionStart(e){return this._isComposingInput=!0,this._updateBlinking(),!0}onCompositionEnd(e){return this._isComposingInput=!1,this._updateBlinking(),!0}onConfigurationChanged(e){let t=this._context.configuration.options;this._readOnly=t.get(93),this._cursorBlinking=t.get(26),this._cursorStyle=t.get(28),this._cursorSmoothCaretAnimation=t.get(27),this._updateBlinking(),this._updateDomClassName(),this._primaryCursor.onConfigurationChanged(e);for(let n=0,i=this._secondaryCursors.length;n<i;n++)this._secondaryCursors[n].onConfigurationChanged(e);return!0}_onCursorPositionChanged(e,t,n){let i=this._secondaryCursors.length!==t.length||this._cursorSmoothCaretAnimation==="explicit"&&n!==3;if(this._primaryCursor.setPlurality(t.length?1:0),this._primaryCursor.onCursorPositionChanged(e,i),this._updateBlinking(),this._secondaryCursors.length<t.length){let r=t.length-this._secondaryCursors.length;for(let s=0;s<r;s++){let a=new Kv(this._context,2);this._domNode.domNode.insertBefore(a.getDomNode().domNode,this._primaryCursor.getDomNode().domNode.nextSibling),this._secondaryCursors.push(a)}}else if(this._secondaryCursors.length>t.length){let r=this._secondaryCursors.length-t.length;for(let s=0;s<r;s++)this._domNode.removeChild(this._secondaryCursors[0].getDomNode()),this._secondaryCursors.splice(0,1)}for(let r=0;r<t.length;r++)this._secondaryCursors[r].onCursorPositionChanged(t[r],i)}onCursorStateChanged(e){let t=[];for(let i=0,r=e.selections.length;i<r;i++)t[i]=e.selections[i].getPosition();this._onCursorPositionChanged(t[0],t.slice(1),e.reason);let n=e.selections[0].isEmpty();return this._selectionIsEmpty!==n&&(this._selectionIsEmpty=n,this._updateDomClassName()),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onFocusChanged(e){return this._editorHasFocus=e.isFocused,this._updateBlinking(),!1}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return!0}onTokensChanged(e){let t=n=>{for(let i=0,r=e.ranges.length;i<r;i++)if(e.ranges[i].fromLineNumber<=n.lineNumber&&n.lineNumber<=e.ranges[i].toLineNumber)return!0;return!1};if(t(this._primaryCursor.getPosition()))return!0;for(let n of this._secondaryCursors)if(t(n.getPosition()))return!0;return!1}onZonesChanged(e){return!0}_getCursorBlinking(){return this._isComposingInput?0:this._editorHasFocus?this._readOnly?5:this._cursorBlinking:0}_updateBlinking(){this._startCursorBlinkAnimation.cancel(),this._cursorFlatBlinkInterval.cancel();let e=this._getCursorBlinking(),t=e===0,n=e===5;t?this._hide():this._show(),this._blinkingEnabled=!1,this._updateDomClassName(),!t&&!n&&(e===1?this._cursorFlatBlinkInterval.cancelAndSet(()=>{this._isVisible?this._hide():this._show()},o.BLINK_INTERVAL,Ce(this._domNode.domNode)):this._startCursorBlinkAnimation.setIfNotSet(()=>{this._blinkingEnabled=!0,this._updateDomClassName()},o.BLINK_INTERVAL))}_updateDomClassName(){this._domNode.setClassName(this._getClassName())}_getClassName(){let e="cursors-layer";switch(this._selectionIsEmpty||(e+=" has-selection"),this._cursorStyle){case 1:e+=" cursor-line-style";break;case 2:e+=" cursor-block-style";break;case 3:e+=" cursor-underline-style";break;case 4:e+=" cursor-line-thin-style";break;case 5:e+=" cursor-block-outline-style";break;case 6:e+=" cursor-underline-thin-style";break;default:e+=" cursor-line-style"}if(this._blinkingEnabled)switch(this._getCursorBlinking()){case 1:e+=" cursor-blink";break;case 2:e+=" cursor-smooth";break;case 3:e+=" cursor-phase";break;case 4:e+=" cursor-expand";break;case 5:e+=" cursor-solid";break;default:e+=" cursor-solid"}else e+=" cursor-solid";return(this._cursorSmoothCaretAnimation==="on"||this._cursorSmoothCaretAnimation==="explicit")&&(e+=" cursor-smooth-caret-animation"),e}_show(){this._primaryCursor.show();for(let e=0,t=this._secondaryCursors.length;e<t;e++)this._secondaryCursors[e].show();this._isVisible=!0}_hide(){this._primaryCursor.hide();for(let e=0,t=this._secondaryCursors.length;e<t;e++)this._secondaryCursors[e].hide();this._isVisible=!1}prepareRender(e){this._primaryCursor.prepareRender(e);for(let t=0,n=this._secondaryCursors.length;t<n;t++)this._secondaryCursors[t].prepareRender(e)}render(e){let t=[],n=0,i=this._primaryCursor.render(e);i&&(t[n++]=i);for(let r=0,s=this._secondaryCursors.length;r<s;r++){let a=this._secondaryCursors[r].render(e);a&&(t[n++]=a)}this._renderData=t}getLastRenderData(){return this._renderData}};To((o,e)=>{let t=[{class:".cursor",foreground:Im,background:DT},{class:".cursor-primary",foreground:LT,background:AH},{class:".cursor-secondary",foreground:RT,background:FH}];for(let n of t){let i=o.getColor(n.foreground);if(i){let r=o.getColor(n.background);r||(r=i.opposite()),e.addRule(`.monaco-editor .cursors-layer ${n.class} { background-color: ${i}; border-color: ${i}; color: ${r}; }`),tc(o.type)&&e.addRule(`.monaco-editor .cursors-layer.has-selection ${n.class} { border-left: 1px solid ${r}; border-right: 1px solid ${r}; }`)}}});var xO=()=>{throw new Error("Invalid change accessor")},$w=class extends Yt{_zones;_lineHeight;_contentWidth;_contentLeft;domNode;marginDomNode;constructor(e){super(e);let t=this._context.configuration.options,n=t.get(147);this._lineHeight=t.get(68),this._contentWidth=n.contentWidth,this._contentLeft=n.contentLeft,this.domNode=We(document.createElement("div")),this.domNode.setClassName("view-zones"),this.domNode.setPosition("absolute"),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.marginDomNode=We(document.createElement("div")),this.marginDomNode.setClassName("margin-view-zones"),this.marginDomNode.setPosition("absolute"),this.marginDomNode.setAttribute("role","presentation"),this.marginDomNode.setAttribute("aria-hidden","true"),this._zones={}}dispose(){super.dispose(),this._zones={}}_recomputeWhitespacesProps(){let e=this._context.viewLayout.getWhitespaces(),t=new Map;for(let i of e)t.set(i.id,i);let n=!1;return this._context.viewModel.changeWhitespace(i=>{let r=Object.keys(this._zones);for(let s=0,a=r.length;s<a;s++){let l=r[s],d=this._zones[l],c=this._computeWhitespaceProps(d.delegate);d.isInHiddenArea=c.isInHiddenArea;let u=t.get(l);u&&(u.afterLineNumber!==c.afterViewLineNumber||u.height!==c.heightInPx)&&(i.changeOneWhitespace(l,c.afterViewLineNumber,c.heightInPx),this._safeCallOnComputedHeight(d.delegate,c.heightInPx),n=!0)}}),n}onConfigurationChanged(e){let t=this._context.configuration.options,n=t.get(147);return this._lineHeight=t.get(68),this._contentWidth=n.contentWidth,this._contentLeft=n.contentLeft,e.hasChanged(68)&&this._recomputeWhitespacesProps(),!0}onLineMappingChanged(e){return this._recomputeWhitespacesProps()}onLinesDeleted(e){return!0}onScrollChanged(e){return e.scrollTopChanged||e.scrollWidthChanged}onZonesChanged(e){return!0}onLinesInserted(e){return!0}_getZoneOrdinal(e){return e.ordinal??e.afterColumn??1e4}_computeWhitespaceProps(e){if(e.afterLineNumber===0)return{isInHiddenArea:!1,afterViewLineNumber:0,heightInPx:this._heightInPixels(e),minWidthInPx:this._minWidthInPixels(e)};let t;if(typeof e.afterColumn<"u")t=this._context.viewModel.model.validatePosition({lineNumber:e.afterLineNumber,column:e.afterColumn});else{let s=this._context.viewModel.model.validatePosition({lineNumber:e.afterLineNumber,column:1}).lineNumber;t=new A(s,this._context.viewModel.model.getLineMaxColumn(s))}let n;t.column===this._context.viewModel.model.getLineMaxColumn(t.lineNumber)?n=this._context.viewModel.model.validatePosition({lineNumber:t.lineNumber+1,column:1}):n=this._context.viewModel.model.validatePosition({lineNumber:t.lineNumber,column:t.column+1});let i=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(t,e.afterColumnAffinity,!0),r=e.showInHiddenAreas||this._context.viewModel.coordinatesConverter.modelPositionIsVisible(n);return{isInHiddenArea:!r,afterViewLineNumber:i.lineNumber,heightInPx:r?this._heightInPixels(e):0,minWidthInPx:this._minWidthInPixels(e)}}changeViewZones(e){let t=!1;return this._context.viewModel.changeWhitespace(n=>{let i={addZone:r=>(t=!0,this._addZone(n,r)),removeZone:r=>{r&&(t=this._removeZone(n,r)||t)},layoutZone:r=>{r&&(t=this._layoutZone(n,r)||t)}};Aj(e,i),i.addZone=xO,i.removeZone=xO,i.layoutZone=xO}),t}_addZone(e,t){let n=this._computeWhitespaceProps(t),r={whitespaceId:e.insertWhitespace(n.afterViewLineNumber,this._getZoneOrdinal(t),n.heightInPx,n.minWidthInPx),delegate:t,isInHiddenArea:n.isInHiddenArea,isVisible:!1,domNode:We(t.domNode),marginDomNode:t.marginDomNode?We(t.marginDomNode):null};return this._safeCallOnComputedHeight(r.delegate,n.heightInPx),r.domNode.setPosition("absolute"),r.domNode.domNode.style.width="100%",r.domNode.setDisplay("none"),r.domNode.setAttribute("monaco-view-zone",r.whitespaceId),this.domNode.appendChild(r.domNode),r.marginDomNode&&(r.marginDomNode.setPosition("absolute"),r.marginDomNode.domNode.style.width="100%",r.marginDomNode.setDisplay("none"),r.marginDomNode.setAttribute("monaco-view-zone",r.whitespaceId),this.marginDomNode.appendChild(r.marginDomNode)),this._zones[r.whitespaceId]=r,this.setShouldRender(),r.whitespaceId}_removeZone(e,t){if(this._zones.hasOwnProperty(t)){let n=this._zones[t];return delete this._zones[t],e.removeWhitespace(n.whitespaceId),n.domNode.removeAttribute("monaco-visible-view-zone"),n.domNode.removeAttribute("monaco-view-zone"),n.domNode.domNode.remove(),n.marginDomNode&&(n.marginDomNode.removeAttribute("monaco-visible-view-zone"),n.marginDomNode.removeAttribute("monaco-view-zone"),n.marginDomNode.domNode.remove()),this.setShouldRender(),!0}return!1}_layoutZone(e,t){if(this._zones.hasOwnProperty(t)){let n=this._zones[t],i=this._computeWhitespaceProps(n.delegate);return n.isInHiddenArea=i.isInHiddenArea,e.changeOneWhitespace(n.whitespaceId,i.afterViewLineNumber,i.heightInPx),this._safeCallOnComputedHeight(n.delegate,i.heightInPx),this.setShouldRender(),!0}return!1}shouldSuppressMouseDownOnViewZone(e){return this._zones.hasOwnProperty(e)?!!this._zones[e].delegate.suppressMouseDown:!1}_heightInPixels(e){return typeof e.heightInPx=="number"?e.heightInPx:typeof e.heightInLines=="number"?this._lineHeight*e.heightInLines:this._lineHeight}_minWidthInPixels(e){return typeof e.minWidthInPx=="number"?e.minWidthInPx:0}_safeCallOnComputedHeight(e,t){if(typeof e.onComputedHeight=="function")try{e.onComputedHeight(t)}catch(n){qe(n)}}_safeCallOnDomNodeTop(e,t){if(typeof e.onDomNodeTop=="function")try{e.onDomNodeTop(t)}catch(n){qe(n)}}prepareRender(e){}render(e){let t=e.viewportData.whitespaceViewportData,n={},i=!1;for(let s of t)this._zones[s.id].isInHiddenArea||(n[s.id]=s,i=!0);let r=Object.keys(this._zones);for(let s=0,a=r.length;s<a;s++){let l=r[s],d=this._zones[l],c=0,u=0,p="none";n.hasOwnProperty(l)?(c=n[l].verticalOffset-e.bigNumbersDelta,u=n[l].height,p="block",d.isVisible||(d.domNode.setAttribute("monaco-visible-view-zone","true"),d.isVisible=!0),this._safeCallOnDomNodeTop(d.delegate,e.getScrolledTopFromAbsoluteTop(n[l].verticalOffset))):(d.isVisible&&(d.domNode.removeAttribute("monaco-visible-view-zone"),d.isVisible=!1),this._safeCallOnDomNodeTop(d.delegate,e.getScrolledTopFromAbsoluteTop(-1e6))),d.domNode.setTop(c),d.domNode.setHeight(u),d.domNode.setDisplay(p),d.marginDomNode&&(d.marginDomNode.setTop(c),d.marginDomNode.setHeight(u),d.marginDomNode.setDisplay(p))}i&&(this.domNode.setWidth(Math.max(e.scrollWidth,this._contentWidth)),this.marginDomNode.setWidth(this._contentLeft))}};function Aj(o,e){try{return o(e)}catch(t){qe(t)}}var Yw=class extends _o{_context;_options;_selection;_renderResult;constructor(e){super(),this._context=e,this._options=new Zw(this._context.configuration),this._selection=[],this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){let t=new Zw(this._context.configuration);return this._options.equals(t)?e.hasChanged(147):(this._options=t,!0)}onCursorStateChanged(e){return this._selection=e.selections,this._options.renderWhitespace==="selection"}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}prepareRender(e){if(this._options.renderWhitespace==="none"){this._renderResult=null;return}let t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber-t+1,r=new Array(i);for(let a=0;a<i;a++)r[a]=!0;let s=this._context.viewModel.getMinimapLinesRenderingData(e.viewportData.startLineNumber,e.viewportData.endLineNumber,r);this._renderResult=[];for(let a=e.viewportData.startLineNumber;a<=e.viewportData.endLineNumber;a++){let l=a-e.viewportData.startLineNumber,d=s.data[l],c=null;if(this._options.renderWhitespace==="selection"){let u=this._selection;for(let p of u){if(p.endLineNumber<a||p.startLineNumber>a)continue;let h=p.startLineNumber===a?p.startColumn:d.minColumn,f=p.endLineNumber===a?p.endColumn:d.maxColumn;h<f&&(c||(c=[]),c.push(new Km(h-1,f-1)))}}this._renderResult[l]=this._applyRenderWhitespace(e,a,c,d)}}_applyRenderWhitespace(e,t,n,i){if(this._options.renderWhitespace==="selection"&&!n||this._options.renderWhitespace==="trailing"&&i.continuesWithWrappedLine)return"";let r=this._context.theme.getColor(kT),s=this._options.renderWithSVG,a=i.content,l=this._options.stopRenderingLineAfter===-1?a.length:Math.min(this._options.stopRenderingLineAfter,a.length),d=i.continuesWithWrappedLine,c=i.minColumn-1,u=this._options.renderWhitespace==="boundary",p=this._options.renderWhitespace==="trailing",h=this._options.lineHeight,f=this._options.middotWidth,g=this._options.wsmiddotWidth,b=this._options.spaceWidth,v=Math.abs(g-b),y=Math.abs(f-b),S=v<y?11825:183,E=this._options.canUseHalfwidthRightwardsArrow,C="",w=!1,_=Cn(a),L;_===-1?(w=!0,_=l,L=l):L=Lr(a);let k=0,W=n&&n[k],K=0;for(let U=c;U<l;U++){let oe=a.charCodeAt(U);if(W&&U>=W.endOffset&&(k++,W=n&&n[k]),oe!==9&&oe!==32||p&&!w&&U<=L)continue;if(u&&U>=_&&U<=L&&oe===32){let ne=U-1>=0?a.charCodeAt(U-1):0,Q=U+1<l?a.charCodeAt(U+1):0;if(ne!==32&&Q!==32)continue}if(u&&d&&U===l-1){let ne=U-1>=0?a.charCodeAt(U-1):0;if(oe===32&&ne!==32&&ne!==9)continue}if(n&&(!W||W.startOffset>U||W.endOffset<=U))continue;let Se=e.visibleRangeForPosition(new A(t,U+1));Se&&(s?(K=Math.max(K,Se.left),oe===9?C+=this._renderArrow(h,b,Se.left):C+=`<circle cx="${(Se.left+b/2).toFixed(2)}" cy="${(h/2).toFixed(2)}" r="${(b/7).toFixed(2)}" />`):oe===9?C+=`<div class="mwh" style="left:${Se.left}px;height:${h}px;">${E?"\uFFEB":"\u2192"}</div>`:C+=`<div class="mwh" style="left:${Se.left}px;height:${h}px;">${String.fromCharCode(S)}</div>`)}return s?(K=Math.round(K+b),`<svg style="bottom:0;position:absolute;width:${K}px;height:${h}px" viewBox="0 0 ${K} ${h}" xmlns="http://www.w3.org/2000/svg" fill="${r}">`+C+"</svg>"):C}_renderArrow(e,t,n){let i=t/7,r=t,s=e/2,a=n,l={x:0,y:i/2},d={x:100/125*r,y:l.y},c={x:d.x-.2*d.x,y:d.y+.2*d.x},u={x:c.x+.1*d.x,y:c.y+.1*d.x},p={x:u.x+.35*d.x,y:u.y-.35*d.x},h={x:p.x,y:-p.y},f={x:u.x,y:-u.y},g={x:c.x,y:-c.y},b={x:d.x,y:-d.y},v={x:l.x,y:-l.y};return`<path d="M ${[l,d,c,u,p,h,f,g,b,v].map(E=>`${(a+E.x).toFixed(2)} ${(s+E.y).toFixed(2)}`).join(" L ")}" />`}render(e,t){if(!this._renderResult)return"";let n=t-e;return n<0||n>=this._renderResult.length?"":this._renderResult[n]}},Zw=class{renderWhitespace;renderWithSVG;spaceWidth;middotWidth;wsmiddotWidth;canUseHalfwidthRightwardsArrow;lineHeight;stopRenderingLineAfter;constructor(e){let t=e.options,n=t.get(51),i=t.get(39);i==="off"?(this.renderWhitespace="none",this.renderWithSVG=!1):i==="svg"?(this.renderWhitespace=t.get(101),this.renderWithSVG=!0):(this.renderWhitespace=t.get(101),this.renderWithSVG=!1),this.spaceWidth=n.spaceWidth,this.middotWidth=n.middotWidth,this.wsmiddotWidth=n.wsmiddotWidth,this.canUseHalfwidthRightwardsArrow=n.canUseHalfwidthRightwardsArrow,this.lineHeight=t.get(68),this.stopRenderingLineAfter=t.get(119)}equals(e){return this.renderWhitespace===e.renderWhitespace&&this.renderWithSVG===e.renderWithSVG&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.lineHeight===e.lineHeight&&this.stopRenderingLineAfter===e.stopRenderingLineAfter}};var pg=class extends Yt{};var wO=class{_onDidChange=new D;onDidChange=this._onDidChange.event;_enabled=!0;get enabled(){return this._enabled}enable(){this._enabled=!0,this._onDidChange.fire()}disable(){this._enabled=!1,this._onDidChange.fire()}},_O=new wO;var LO=class{constructor(e,t,n,i,r){this._context=e;this.modelLineNumber=t;this.distanceToModelLineStart=n;this.widthOfHiddenLineTextBefore=i;this.distanceToModelLineEnd=r}_visibleTextAreaBrand=void 0;startPosition=null;endPosition=null;visibleTextareaStart=null;visibleTextareaEnd=null;_previousPresentation=null;prepareRender(e){let t=new A(this.modelLineNumber,this.distanceToModelLineStart+1),n=new A(this.modelLineNumber,this._context.viewModel.model.getLineMaxColumn(this.modelLineNumber)-this.distanceToModelLineEnd);this.startPosition=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(t),this.endPosition=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(n),this.startPosition.lineNumber===this.endPosition.lineNumber?(this.visibleTextareaStart=e.visibleRangeForPosition(this.startPosition),this.visibleTextareaEnd=e.visibleRangeForPosition(this.endPosition)):(this.visibleTextareaStart=null,this.visibleTextareaEnd=null)}definePresentation(e){return this._previousPresentation||(e?this._previousPresentation=e:this._previousPresentation={foreground:1,italic:!1,bold:!1,underline:!1,strikethrough:!1}),this._previousPresentation}},DO=Gn,hg=class extends pg{constructor(t,n,i,r,s){super(t);this._keybindingService=r;this._instantiationService=s;this._viewController=n,this._visibleRangeProvider=i,this._scrollLeft=0,this._scrollTop=0;let a=this._context.configuration.options,l=a.get(147);this._setAccessibilityOptions(a),this._contentLeft=l.contentLeft,this._contentWidth=l.contentWidth,this._contentHeight=l.height,this._fontInfo=a.get(51),this._lineHeight=a.get(68),this._emptySelectionClipboard=a.get(38),this._copyWithSyntaxHighlighting=a.get(25),this._visibleTextArea=null,this._selections=[new $e(1,1,1,1)],this._modelSelections=[new $e(1,1,1,1)],this._lastRenderPosition=null,this.textArea=We(document.createElement("textarea")),ri.write(this.textArea,7),this.textArea.setClassName(`inputarea ${ql}`),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off");let{tabSize:d}=this._context.viewModel.model.getOptions();this.textArea.domNode.style.tabSize=`${d*this._fontInfo.spaceWidth}px`,this.textArea.setAttribute("autocorrect","off"),this.textArea.setAttribute("autocapitalize","off"),this.textArea.setAttribute("autocomplete","off"),this.textArea.setAttribute("spellcheck","false"),this.textArea.setAttribute("aria-label",Xv(a,this._keybindingService)),this.textArea.setAttribute("aria-required",a.get(5)?"true":"false"),this.textArea.setAttribute("tabindex",String(a.get(126))),this.textArea.setAttribute("role","textbox"),this.textArea.setAttribute("aria-roledescription",m("editor","editor")),this.textArea.setAttribute("aria-multiline","true"),this.textArea.setAttribute("aria-autocomplete",a.get(93)?"none":"both"),this._ensureReadOnlyAttribute(),this.textAreaCover=We(document.createElement("div")),this.textAreaCover.setPosition("absolute");let c={getLineCount:()=>this._context.viewModel.getLineCount(),getLineMaxColumn:h=>this._context.viewModel.getLineMaxColumn(h),getValueInRange:(h,f)=>this._context.viewModel.getValueInRange(h,f),getValueLengthInRange:(h,f)=>this._context.viewModel.getValueLengthInRange(h,f),modifyPosition:(h,f)=>this._context.viewModel.modifyPosition(h,f)},u={getDataToCopy:()=>hw(this._context.viewModel,this._modelSelections,this._emptySelectionClipboard,this._copyWithSyntaxHighlighting),getScreenReaderContent:()=>{if(this._accessibilitySupport===1){let f=this._selections[0];if(Ve&&f.isEmpty()){let b=f.getStartPosition(),v=this._getWordBeforePosition(b);if(v.length===0&&(v=this._getCharacterBeforePosition(b)),v.length>0)return new li(v,v.length,v.length,P.fromPositions(b),0)}if(Ve&&!f.isEmpty()&&c.getValueLengthInRange(f,0)<500){let b=c.getValueInRange(f,0);return new li(b,0,b.length,f,0)}if(Wo&&!f.isEmpty()){let b="vscode-placeholder";return new li(b,0,b.length,null,void 0)}return li.EMPTY}if(G0){let f=this._selections[0];if(f.isEmpty()){let g=f.getStartPosition(),[b,v]=this._getAndroidWordAtPosition(g);if(b.length>0)return new li(b,v,v,P.fromPositions(g),0)}return li.EMPTY}let h=rg.fromEditorSelection(c,this._selections[0],this._accessibilityPageSize,this._accessibilitySupport===0);return li.fromScreenReaderContentState(h)},deduceModelPosition:(h,f,g)=>this._context.viewModel.deduceModelPositionRelativeToViewPosition(h,f,g)},p=this._register(new mw(this.textArea.domNode));this._textAreaInput=this._register(this._instantiationService.createInstance(sg,u,p,qr,{isAndroid:G0,isChrome:jd,isFirefox:Gn,isSafari:Wo})),this._register(this._textAreaInput.onKeyDown(h=>{this._viewController.emitKeyDown(h)})),this._register(this._textAreaInput.onKeyUp(h=>{this._viewController.emitKeyUp(h)})),this._register(this._textAreaInput.onPaste(h=>{let f=!1,g=null,b=null;h.metadata&&(f=this._emptySelectionClipboard&&!!h.metadata.isFromEmptySelection,g=typeof h.metadata.multicursorText<"u"?h.metadata.multicursorText:null,b=h.metadata.mode),this._viewController.paste(h.text,f,g,b)})),this._register(this._textAreaInput.onCut(()=>{this._viewController.cut()})),this._register(this._textAreaInput.onType(h=>{h.replacePrevCharCnt||h.replaceNextCharCnt||h.positionDelta?(Yo&&console.log(` => compositionType: <<${h.text}>>, ${h.replacePrevCharCnt}, ${h.replaceNextCharCnt}, ${h.positionDelta}`),this._viewController.compositionType(h.text,h.replacePrevCharCnt,h.replaceNextCharCnt,h.positionDelta)):(Yo&&console.log(` => type: <<${h.text}>>`),this._viewController.type(h.text))})),this._register(this._textAreaInput.onSelectionChangeRequest(h=>{this._viewController.setSelection(h)})),this._register(this._textAreaInput.onCompositionStart(h=>{let f=this.textArea.domNode,g=this._modelSelections[0],{distanceToModelLineStart:b,widthOfHiddenTextBefore:v}=(()=>{let S=f.value.substring(0,Math.min(f.selectionStart,f.selectionEnd)),E=S.lastIndexOf(`
`),C=S.substring(E+1),w=C.lastIndexOf("	"),_=C.length-w-1,L=g.getStartPosition(),k=Math.min(L.column-1,_),W=L.column-1-k,K=C.substring(0,C.length-k),{tabSize:U}=this._context.viewModel.model.getOptions(),oe=Fj(this.textArea.domNode.ownerDocument,K,this._fontInfo,U);return{distanceToModelLineStart:W,widthOfHiddenTextBefore:oe}})(),{distanceToModelLineEnd:y}=(()=>{let S=f.value.substring(Math.max(f.selectionStart,f.selectionEnd)),E=S.indexOf(`
`),C=E===-1?S:S.substring(0,E),w=C.indexOf("	"),_=w===-1?C.length:C.length-w-1,L=g.getEndPosition(),k=Math.min(this._context.viewModel.model.getLineMaxColumn(L.lineNumber)-L.column,_);return{distanceToModelLineEnd:this._context.viewModel.model.getLineMaxColumn(L.lineNumber)-L.column-k}})();this._context.viewModel.revealRange("keyboard",!0,P.fromPositions(this._selections[0].getStartPosition()),0,1),this._visibleTextArea=new LO(this._context,g.startLineNumber,b,v,y),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off"),this._visibleTextArea.prepareRender(this._visibleRangeProvider),this._render(),this.textArea.setClassName(`inputarea ${ql} ime-input`),this._viewController.compositionStart(),this._context.viewModel.onCompositionStart()})),this._register(this._textAreaInput.onCompositionUpdate(h=>{this._visibleTextArea&&(this._visibleTextArea.prepareRender(this._visibleRangeProvider),this._render())})),this._register(this._textAreaInput.onCompositionEnd(()=>{this._visibleTextArea=null,this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off"),this._render(),this.textArea.setClassName(`inputarea ${ql}`),this._viewController.compositionEnd(),this._context.viewModel.onCompositionEnd()})),this._register(this._textAreaInput.onFocus(()=>{this._context.viewModel.setHasFocus(!0)})),this._register(this._textAreaInput.onBlur(()=>{this._context.viewModel.setHasFocus(!1)})),this._register(_O.onDidChange(()=>{this._ensureReadOnlyAttribute()}))}_viewController;_visibleRangeProvider;_scrollLeft;_scrollTop;_accessibilitySupport;_accessibilityPageSize;_textAreaWrapping;_textAreaWidth;_contentLeft;_contentWidth;_contentHeight;_fontInfo;_lineHeight;_emptySelectionClipboard;_copyWithSyntaxHighlighting;_visibleTextArea;_selections;_modelSelections;_lastRenderPosition;textArea;textAreaCover;_textAreaInput;get domNode(){return this.textArea}appendTo(t){t.appendChild(this.textArea),t.appendChild(this.textAreaCover)}writeScreenReaderContent(t){this._textAreaInput.writeNativeTextAreaContent(t)}dispose(){super.dispose(),this.textArea.domNode.remove(),this.textAreaCover.domNode.remove()}_getAndroidWordAtPosition(t){let n='`~!@#$%^&*()-=+[{]}\\|;:",.<>/?',i=this._context.viewModel.getLineContent(t.lineNumber),r=ya(n,[]),s=!0,a=t.column,l=!0,d=t.column,c=0;for(;c<50&&(s||l);){if(s&&a<=1&&(s=!1),s){let u=i.charCodeAt(a-2);r.get(u)!==0?s=!1:a--}if(l&&d>i.length&&(l=!1),l){let u=i.charCodeAt(d-1);r.get(u)!==0?l=!1:d++}c++}return[i.substring(a-1,d-1),t.column-a]}_getWordBeforePosition(t){let n=this._context.viewModel.getLineContent(t.lineNumber),i=ya(this._context.configuration.options.get(133),[]),r=t.column,s=0;for(;r>1;){let a=n.charCodeAt(r-2);if(i.get(a)!==0||s>50)return n.substring(r-1,t.column-1);s++,r--}return n.substring(0,t.column-1)}_getCharacterBeforePosition(t){if(t.column>1){let i=this._context.viewModel.getLineContent(t.lineNumber).charAt(t.column-2);if(!ln(i.charCodeAt(0)))return i}return""}_setAccessibilityOptions(t){this._accessibilitySupport=t.get(2);let n=t.get(3);this._accessibilitySupport===2&&n===Jr.accessibilityPageSize.defaultValue?this._accessibilityPageSize=500:this._accessibilityPageSize=n;let r=t.get(147).wrappingColumn;if(r!==-1&&this._accessibilitySupport!==1){let s=t.get(51);this._textAreaWrapping=!0,this._textAreaWidth=Math.round(r*s.typicalHalfwidthCharacterWidth)}else this._textAreaWrapping=!1,this._textAreaWidth=DO?0:1}onConfigurationChanged(t){let n=this._context.configuration.options,i=n.get(147);this._setAccessibilityOptions(n),this._contentLeft=i.contentLeft,this._contentWidth=i.contentWidth,this._contentHeight=i.height,this._fontInfo=n.get(51),this._lineHeight=n.get(68),this._emptySelectionClipboard=n.get(38),this._copyWithSyntaxHighlighting=n.get(25),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off");let{tabSize:r}=this._context.viewModel.model.getOptions();return this.textArea.domNode.style.tabSize=`${r*this._fontInfo.spaceWidth}px`,this.textArea.setAttribute("aria-label",Xv(n,this._keybindingService)),this.textArea.setAttribute("aria-required",n.get(5)?"true":"false"),this.textArea.setAttribute("tabindex",String(n.get(126))),(t.hasChanged(34)||t.hasChanged(93))&&this._ensureReadOnlyAttribute(),t.hasChanged(2)&&this._textAreaInput.writeNativeTextAreaContent("strategy changed"),!0}onCursorStateChanged(t){return this._selections=t.selections.slice(0),this._modelSelections=t.modelSelections.slice(0),this._textAreaInput.writeNativeTextAreaContent("selection changed"),!0}onDecorationsChanged(t){return!0}onFlushed(t){return!0}onLinesChanged(t){return!0}onLinesDeleted(t){return!0}onLinesInserted(t){return!0}onScrollChanged(t){return this._scrollLeft=t.scrollLeft,this._scrollTop=t.scrollTop,!0}onZonesChanged(t){return!0}isFocused(){return this._textAreaInput.isFocused()}focus(){this._textAreaInput.focusTextArea()}refreshFocusState(){this._textAreaInput.refreshFocusState()}getLastRenderData(){return this._lastRenderPosition}setAriaOptions(t){t.activeDescendant?(this.textArea.setAttribute("aria-haspopup","true"),this.textArea.setAttribute("aria-autocomplete","list"),this.textArea.setAttribute("aria-activedescendant",t.activeDescendant)):(this.textArea.setAttribute("aria-haspopup","false"),this.textArea.setAttribute("aria-autocomplete","both"),this.textArea.removeAttribute("aria-activedescendant")),t.role&&this.textArea.setAttribute("role",t.role)}_ensureReadOnlyAttribute(){let t=this._context.configuration.options;!_O.enabled||t.get(34)&&t.get(93)?this.textArea.setAttribute("readonly","true"):this.textArea.removeAttribute("readonly")}_primaryCursorPosition=new A(1,1);_primaryCursorVisibleRange=null;prepareRender(t){this._primaryCursorPosition=new A(this._selections[0].positionLineNumber,this._selections[0].positionColumn),this._primaryCursorVisibleRange=t.visibleRangeForPosition(this._primaryCursorPosition),this._visibleTextArea?.prepareRender(t)}render(t){this._textAreaInput.writeNativeTextAreaContent("render"),this._render()}_render(){if(this._visibleTextArea){let i=this._visibleTextArea.visibleTextareaStart,r=this._visibleTextArea.visibleTextareaEnd,s=this._visibleTextArea.startPosition,a=this._visibleTextArea.endPosition;if(s&&a&&i&&r&&r.left>=this._scrollLeft&&i.left<=this._scrollLeft+this._contentWidth){let l=this._context.viewLayout.getVerticalOffsetForLineNumber(this._primaryCursorPosition.lineNumber)-this._scrollTop,d=Qv(this.textArea.domNode.value.substr(0,this.textArea.domNode.selectionStart)),c=this._visibleTextArea.widthOfHiddenLineTextBefore,u=this._contentLeft+i.left-this._scrollLeft,p=r.left-i.left+1;if(u<this._contentLeft){let y=this._contentLeft-u;u+=y,c+=y,p-=y}p>this._contentWidth&&(p=this._contentWidth);let h=this._context.viewModel.getViewLineData(s.lineNumber),f=h.tokens.findTokenIndexAtOffset(s.column-1),g=h.tokens.findTokenIndexAtOffset(a.column-1),b=f===g,v=this._visibleTextArea.definePresentation(b?h.tokens.getPresentation(f):null);this.textArea.domNode.scrollTop=d*this._lineHeight,this.textArea.domNode.scrollLeft=c,this._doRender({lastRenderPosition:null,top:l,left:u,width:p,height:this._lineHeight,useCover:!1,color:(cr.getColorMap()||[])[v.foreground],italic:v.italic,bold:v.bold,underline:v.underline,strikethrough:v.strikethrough})}return}if(!this._primaryCursorVisibleRange){this._renderAtTopLeft();return}let t=this._contentLeft+this._primaryCursorVisibleRange.left-this._scrollLeft;if(t<this._contentLeft||t>this._contentLeft+this._contentWidth){this._renderAtTopLeft();return}let n=this._context.viewLayout.getVerticalOffsetForLineNumber(this._selections[0].positionLineNumber)-this._scrollTop;if(n<0||n>this._contentHeight){this._renderAtTopLeft();return}if(Ve||this._accessibilitySupport===2){this._doRender({lastRenderPosition:this._primaryCursorPosition,top:n,left:this._textAreaWrapping?this._contentLeft:t,width:this._textAreaWidth,height:this._lineHeight,useCover:!1}),this.textArea.domNode.scrollLeft=this._primaryCursorVisibleRange.left;let i=this._textAreaInput.textAreaState.newlineCountBeforeSelection??Qv(this.textArea.domNode.value.substring(0,this.textArea.domNode.selectionStart));this.textArea.domNode.scrollTop=i*this._lineHeight;return}this._doRender({lastRenderPosition:this._primaryCursorPosition,top:n,left:this._textAreaWrapping?this._contentLeft:t,width:this._textAreaWidth,height:DO?0:1,useCover:!1})}_renderAtTopLeft(){this._doRender({lastRenderPosition:null,top:0,left:0,width:this._textAreaWidth,height:DO?0:1,useCover:!0})}_doRender(t){this._lastRenderPosition=t.lastRenderPosition;let n=this.textArea,i=this.textAreaCover;on(n,this._fontInfo),n.setTop(t.top),n.setLeft(t.left),n.setWidth(t.width),n.setHeight(t.height),n.setColor(t.color?H.Format.CSS.formatHex(t.color):""),n.setFontStyle(t.italic?"italic":""),t.bold&&n.setFontWeight("bold"),n.setTextDecoration(`${t.underline?" underline":""}${t.strikethrough?" line-through":""}`),i.setTop(t.useCover?t.top:0),i.setLeft(t.useCover?t.left:0),i.setWidth(t.useCover?t.width:0),i.setHeight(t.useCover?t.height:0);let r=this._context.configuration.options;r.get(58)?i.setClassName("monaco-editor-background textAreaCover "+cg.OUTER_CLASS_NAME):r.get(69).renderType!==0?i.setClassName("monaco-editor-background textAreaCover "+dg.CLASS_NAME):i.setClassName("monaco-editor-background textAreaCover")}};hg=O([x(3,oi),x(4,Oe)],hg);function Fj(o,e,t,n){if(e.length===0)return 0;let i=o.createElement("div");i.style.position="absolute",i.style.top="-50000px",i.style.width="50000px";let r=o.createElement("span");on(r,t),r.style.whiteSpace="pre",r.style.tabSize=`${n*t.spaceWidth}px`,r.append(e),i.appendChild(r),o.body.appendChild(i);let s=r.offsetWidth;return i.remove(),s}var Xw=Y("clipboardService");var Qw=class extends F{constructor(t,n){super();this._domNode=t;this._onFocusChange=n;this._register(j(this._domNode,"focus",()=>this._handleFocusedChanged(!0))),this._register(j(this._domNode,"blur",()=>this._handleFocusedChanged(!1)))}_isFocused=!1;_handleFocusedChanged(t){this._isFocused!==t&&(this._isFocused=t,this._onFocusChange(this._isFocused))}focus(){this._domNode.focus()}get isFocused(){return this._isFocused}};function mg(o,e,t,n){return o.addEventListener(e,t,n),{dispose(){o.removeEventListener(e,t)}}}var gg=class{constructor(e,t,n){this._domNode=e;this._context=t;this._keybindingService=n;this._updateConfigurationSettings(),this._updateDomAttributes()}_contentLeft=1;_contentWidth=1;_lineHeight=1;_fontInfo;_accessibilitySupport=0;_accessibilityPageSize=1;_primarySelection=new $e(1,1,1,1);_screenReaderContentState;onConfigurationChanged(e){this._updateConfigurationSettings(),this._updateDomAttributes(),e.hasChanged(2)&&this.writeScreenReaderContent()}_updateConfigurationSettings(){let e=this._context.configuration.options,t=e.get(147);this._contentLeft=t.contentLeft,this._contentWidth=t.contentWidth,this._fontInfo=e.get(51),this._lineHeight=e.get(68),this._accessibilitySupport=e.get(2),this._accessibilityPageSize=e.get(3)}_updateDomAttributes(){let e=this._context.configuration.options;this._domNode.domNode.setAttribute("aria-label",Xv(e,this._keybindingService));let t=this._context.viewModel.model.getOptions().tabSize,n=e.get(51).spaceWidth;this._domNode.domNode.style.tabSize=`${t*n}px`}onCursorStateChanged(e){this._primarySelection=e.selections[0]??new $e(1,1,1,1)}prepareRender(e){this.writeScreenReaderContent()}render(e){if(!this._screenReaderContentState)return;on(this._domNode,this._fontInfo);let t=this._context.viewLayout.getVerticalOffsetForLineNumber(this._primarySelection.positionLineNumber),n=this._context.viewLayout.getCurrentScrollTop(),i=t-n;this._domNode.setTop(i),this._domNode.setLeft(this._contentLeft),this._domNode.setWidth(this._contentWidth),this._domNode.setHeight(this._lineHeight);let r=this._screenReaderContentState.value.substring(0,this._screenReaderContentState.selectionStart),s=Qv(r);this._domNode.domNode.scrollTop=s*this._lineHeight}setAriaOptions(){}writeScreenReaderContent(){this._screenReaderContentState=this._getScreenReaderContentState(),this._screenReaderContentState&&(this._domNode.domNode.textContent!==this._screenReaderContentState.value&&(this._domNode.domNode.textContent=this._screenReaderContentState.value),this._setSelectionOfScreenReaderContent(this._screenReaderContentState.selectionStart,this._screenReaderContentState.selectionEnd))}_getScreenReaderContentState(){let e=this._accessibilitySupport===1?1:this._accessibilityPageSize,t={getLineCount:()=>this._context.viewModel.getLineCount(),getLineMaxColumn:n=>this._context.viewModel.getLineMaxColumn(n),getValueInRange:(n,i)=>this._context.viewModel.getValueInRange(n,i),getValueLengthInRange:(n,i)=>this._context.viewModel.getValueLengthInRange(n,i),modifyPosition:(n,i)=>this._context.viewModel.modifyPosition(n,i)};return rg.fromEditorSelection(t,this._primarySelection,e,this._accessibilitySupport===0)}_setSelectionOfScreenReaderContent(e,t){let i=Zd().document.getSelection();if(!i)return;let r=this._domNode.domNode.firstChild;if(!r)return;let s=Zd().document.activeElement,a=new globalThis.Range;a.setStart(r,e),a.setEnd(r,t),i.removeAllRanges(),i.addRange(a),Nn(s)&&s.focus()}};gg=O([x(2,oi)],gg);var fg=class extends pg{domNode;_editContext;_screenReaderSupport;_parent;_decorations=[];_renderingContext;_primarySelection=new $e(1,1,1,1);_textStartPositionWithinEditor=new A(1,1);_compositionRangeWithinEditor;_focusTracker;constructor(e,t,n,i){super(e),this.domNode=new Tu(document.createElement("div")),this.domNode.setClassName("native-edit-context"),this._updateDomAttributes(),this._focusTracker=this._register(new Qw(this.domNode.domNode,r=>this._context.viewModel.setHasFocus(r))),this._editContext=new EditContext,this.domNode.domNode.editContext=this._editContext,this._screenReaderSupport=n.createInstance(gg,this.domNode,e),this._register(j(this.domNode.domNode,"copy",()=>this._ensureClipboardGetsEditorSelection(i))),this._register(j(this.domNode.domNode,"cut",()=>{this._ensureClipboardGetsEditorSelection(i),t.cut()})),this._register(j(this.domNode.domNode,"keyup",r=>t.emitKeyUp(new mt(r)))),this._register(j(this.domNode.domNode,"keydown",async r=>{let s=new mt(r);s.keyCode===114&&s.stopPropagation(),s.keyCode===3&&this._onType(t,{text:`
`,replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0}),t.emitKeyDown(s)})),this._register(mg(this._editContext,"textformatupdate",r=>this._handleTextFormatUpdate(r))),this._register(mg(this._editContext,"characterboundsupdate",r=>this._updateCharacterBounds())),this._register(mg(this._editContext,"textupdate",r=>{let s=this._compositionRangeWithinEditor;if(s){let a=this._context.viewModel.getPrimaryCursorState().modelState.position,l=P.fromPositions(s.getStartPosition(),a);this._compositionRangeWithinEditor=l}this._emitTypeEvent(t,r),this._screenReaderSupport.writeScreenReaderContent()})),this._register(mg(this._editContext,"compositionstart",r=>{let s=this._context.viewModel.getPrimaryCursorState().modelState.position,a=P.fromPositions(s,s);this._compositionRangeWithinEditor=a,t.compositionStart(),this._context.viewModel.onCompositionStart()})),this._register(mg(this._editContext,"compositionend",r=>{this._compositionRangeWithinEditor=void 0,t.compositionEnd(),this._context.viewModel.onCompositionEnd()}))}dispose(){super.dispose(),this.domNode.domNode.remove()}appendTo(e){e.appendChild(this.domNode),this._parent=e.domNode}setAriaOptions(){this._screenReaderSupport.setAriaOptions()}getLastRenderData(){return this._primarySelection.getPosition()}prepareRender(e){this._renderingContext=e,this._screenReaderSupport.prepareRender(e),this._updateEditContext(),this._updateSelectionAndControlBounds(),this._updateCharacterBounds()}render(e){this._screenReaderSupport.render(e)}onCursorStateChanged(e){return this._primarySelection=e.modelSelections[0]??new $e(1,1,1,1),this._screenReaderSupport.onCursorStateChanged(e),!0}onConfigurationChanged(e){return this._screenReaderSupport.onConfigurationChanged(e),this._updateDomAttributes(),!0}writeScreenReaderContent(){this._screenReaderSupport.writeScreenReaderContent()}isFocused(){return this._focusTracker.isFocused}focus(){this._focusTracker.focus()}refreshFocusState(){}_updateDomAttributes(){let e=this._context.configuration.options;this.domNode.domNode.setAttribute("tabindex",String(e.get(126)))}_updateEditContext(){let e=this._getNewEditContextState();this._editContext.updateText(0,Number.MAX_SAFE_INTEGER,e.text),this._editContext.updateSelection(e.selectionStartOffset,e.selectionEndOffset),this._textStartPositionWithinEditor=e.textStartPositionWithinEditor}_emitTypeEvent(e,t){if(!this._editContext)return;let n=this._context.viewModel.model,i=n.getOffsetAt(this._textStartPositionWithinEditor),r=n.getOffsetAt(this._primarySelection.getEndPosition()),s=n.getOffsetAt(this._primarySelection.getStartPosition()),a=r-i,l=s-i,d=0,c=0;t.updateRangeEnd>a&&(d=t.updateRangeEnd-a),t.updateRangeStart<l&&(c=l-t.updateRangeStart);let u="";l<t.updateRangeStart&&(u+=this._editContext.text.substring(l,t.updateRangeStart)),u+=t.text,a>t.updateRangeEnd&&(u+=this._editContext.text.substring(t.updateRangeEnd,a));let p={text:u,replacePrevCharCnt:c,replaceNextCharCnt:d,positionDelta:0};this._onType(e,p);let h=l-c+u.length;this._updateCursorStatesAfterType(h,t.selectionStart,t.selectionEnd)}_onType(e,t){t.replacePrevCharCnt||t.replaceNextCharCnt||t.positionDelta?e.compositionType(t.text,t.replacePrevCharCnt,t.replaceNextCharCnt,t.positionDelta):e.type(t.text)}_updateCursorStatesAfterType(e,t,n){let i=t-e,r=n-e,l=this._context.viewModel.getCursorStates().map(d=>d.modelState.position).map(d=>{let c=d.lineNumber,u=d.column;return new $e(c,u+i,c,u+r)}).map(d=>Ze.fromModelSelection(d));this._context.viewModel.setCursorStates("editContext",3,l)}_getNewEditContextState(){let e=this._primarySelection.startColumn-1,t=0;for(let a=this._primarySelection.startLineNumber;a<=this._primarySelection.endLineNumber;a++)a===this._primarySelection.endLineNumber?t+=this._primarySelection.endColumn-1:t+=this._context.viewModel.model.getLineMaxColumn(a);let n=this._context.viewModel.model.getLineMaxColumn(this._primarySelection.endLineNumber),i=new P(this._primarySelection.startLineNumber,1,this._primarySelection.endLineNumber,n),r=this._context.viewModel.model.getValueInRange(i,0),s=i.getStartPosition();return{text:r,selectionStartOffset:e,selectionEndOffset:t,textStartPositionWithinEditor:s}}_handleTextFormatUpdate(e){if(!this._editContext)return;let t=e.getTextFormats(),n=this._textStartPositionWithinEditor,i=[];t.forEach(r=>{let s=this._context.viewModel.model,a=s.getOffsetAt(n),l=s.getPositionAt(a+r.rangeStart),d=s.getPositionAt(a+r.rangeEnd),c=P.fromPositions(l,d),u=["edit-context-format-decoration",`underline-style-${r.underlineStyle.toLowerCase()}`,`underline-thickness-${r.underlineThickness.toLowerCase()}`];i.push({range:c,options:{description:"textFormatDecoration",inlineClassName:u.join(" ")}})}),this._decorations=this._context.viewModel.model.deltaDecorations(this._decorations,i)}_updateSelectionAndControlBounds(){if(!this._parent)return;let e=this._context.configuration.options,t=e.get(68),n=e.get(147).contentLeft,i=this._parent.getBoundingClientRect(),r=this._context.viewLayout.getVerticalOffsetForLineNumber(this._primarySelection.startLineNumber),s=this._context.viewLayout.getCurrentScrollTop(),a=i.top+r-s,l=(this._primarySelection.endLineNumber-this._primarySelection.startLineNumber+1)*t,d=i.left+n,c;if(this._primarySelection.isEmpty()){if(this._renderingContext){let h=this._renderingContext.linesVisibleRangesForRange(this._primarySelection,!0)??[];h.length>0&&(d+=Math.min(...h.map(f=>Math.min(...f.ranges.map(g=>g.left)))))}c=e.get(51).typicalHalfwidthCharacterWidth/2}else c=i.width-n;let u=new DOMRect(d,a,c,l),p=u;this._editContext.updateControlBounds(p),this._editContext.updateSelectionBounds(u)}_updateCharacterBounds(){if(!this._parent||!this._compositionRangeWithinEditor)return;let e=this._context.configuration.options,t=e.get(68),n=e.get(147).contentLeft,i=this._parent.getBoundingClientRect(),r=this._compositionRangeWithinEditor,s=this._context.viewLayout.getVerticalOffsetForLineNumber(r.startLineNumber),a=this._context.viewLayout.getCurrentScrollTop(),l=i.top+s-a,d=[];if(this._renderingContext){let f=this._renderingContext.linesVisibleRangesForRange(r,!0)??[];for(let g of f)for(let b of g.ranges)d.push(new DOMRect(i.left+n+b.left,l,b.width,t))}let c=this._context.viewModel.model,u=c.getOffsetAt(this._textStartPositionWithinEditor),h=c.getOffsetAt(r.getStartPosition())-u;this._editContext.updateCharacterBounds(h,d)}_ensureClipboardGetsEditorSelection(e){let t=this._context.configuration.options,n=t.get(38),i=t.get(25),r=this._context.viewModel.getCursorStates().map(l=>l.modelState.selection),s=hw(this._context.viewModel,r,n,i),a={version:1,isFromEmptySelection:s.isFromEmptySelection,multicursorText:s.multicursorText,mode:s.mode};gp.INSTANCE.set(Gn?s.text.replace(/\r\n/g,`
`):s.text,a),e.writeText(s.text)}};fg=O([x(2,Oe),x(3,Xw)],fg);var bg=class extends as{constructor(t,n,i,r,s,a,l){super();this._instantiationService=l;this._selections=[new $e(1,1,1,1)],this._renderAnimationFrame=null;let d=new pw(n,r,s,t);this._context=new Ax(n,i,r),this._context.addEventHandler(this),this._viewParts=[];let c=this._context.configuration.options.get(37);this._editContext=c?this._instantiationService.createInstance(fg,this._context,d):this._instantiationService.createInstance(hg,this._context,d,this._createTextAreaHandlerHelper()),this._viewParts.push(this._editContext),this._linesContent=We(document.createElement("div")),this._linesContent.setClassName("lines-content monaco-editor-background"),this._linesContent.setPosition("absolute"),this.domNode=We(document.createElement("div")),this.domNode.setClassName(this._getEditorClassName()),this.domNode.setAttribute("role","code"),this._overflowGuardContainer=We(document.createElement("div")),ri.write(this._overflowGuardContainer,3),this._overflowGuardContainer.setClassName("overflow-guard"),this._scrollbar=new _w(this._context,this._linesContent,this.domNode,this._overflowGuardContainer),this._viewParts.push(this._scrollbar),this._viewLines=new Rw(this._context,this._linesContent),this._viewZones=new $w(this._context),this._viewParts.push(this._viewZones);let u=new Hw(this._context);this._viewParts.push(u);let p=new Kw(this._context);this._viewParts.push(p);let h=new vw(this._context);this._viewParts.push(h),h.addDynamicOverlay(new Tw(this._context)),h.addDynamicOverlay(new jw(this._context)),h.addDynamicOverlay(new Lw(this._context)),h.addDynamicOverlay(new ww(this._context)),h.addDynamicOverlay(new Yw(this._context));let f=new yw(this._context);this._viewParts.push(f),f.addDynamicOverlay(new xw(this._context)),f.addDynamicOverlay(new Mw(this._context)),f.addDynamicOverlay(new kw(this._context)),f.addDynamicOverlay(new dg(this._context)),this._glyphMarginWidgets=new Dw(this._context),this._viewParts.push(this._glyphMarginWidgets);let g=new cg(this._context);g.getDomNode().appendChild(this._viewZones.marginDomNode),g.getDomNode().appendChild(f.getDomNode()),g.getDomNode().appendChild(this._glyphMarginWidgets.domNode),this._viewParts.push(g),this._contentWidgets=new Cw(this._context,this.domNode),this._viewParts.push(this._contentWidgets),this._viewCursors=new qw(this._context),this._viewParts.push(this._viewCursors),this._overlayWidgets=new Ww(this._context,this.domNode),this._viewParts.push(this._overlayWidgets);let b=new zw(this._context);this._viewParts.push(b);let v=new Iw(this._context);this._viewParts.push(v);let y=new Bw(this._context);if(this._viewParts.push(y),u){let S=this._scrollbar.getOverviewRulerLayoutInfo();S.parent.insertBefore(u.getDomNode(),S.insertBefore)}this._linesContent.appendChild(h.getDomNode()),this._linesContent.appendChild(b.domNode),this._linesContent.appendChild(this._viewZones.domNode),this._linesContent.appendChild(this._viewLines.getDomNode()),this._linesContent.appendChild(this._contentWidgets.domNode),this._linesContent.appendChild(this._viewCursors.getDomNode()),this._overflowGuardContainer.appendChild(g.getDomNode()),this._overflowGuardContainer.appendChild(this._scrollbar.getDomNode()),this._overflowGuardContainer.appendChild(p.getDomNode()),this._editContext.appendTo(this._overflowGuardContainer),this._overflowGuardContainer.appendChild(this._overlayWidgets.getDomNode()),this._overflowGuardContainer.appendChild(y.getDomNode()),this._overflowGuardContainer.appendChild(v.domNode),this.domNode.appendChild(this._overflowGuardContainer),a?(a.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode.domNode),a.appendChild(this._overlayWidgets.overflowingOverlayWidgetsDomNode.domNode)):(this.domNode.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode),this.domNode.appendChild(this._overlayWidgets.overflowingOverlayWidgetsDomNode)),this._applyLayout(),this._pointerHandler=this._register(new fw(this._context,d,this._createPointerHandlerHelper()))}_scrollbar;_context;_selections;_viewLines;_viewZones;_contentWidgets;_overlayWidgets;_glyphMarginWidgets;_viewCursors;_viewParts;_editContext;_pointerHandler;_linesContent;domNode;_overflowGuardContainer;_shouldRecomputeGlyphMarginLanes=!1;_renderAnimationFrame;_computeGlyphMarginLanes(){let t=this._context.viewModel.model,n=this._context.viewModel.glyphLanes,i=[],r=0;i=i.concat(t.getAllMarginDecorations().map(s=>{let a=s.options.glyphMargin?.position??2;return r=Math.max(r,s.range.endLineNumber),{range:s.range,lane:a,persist:s.options.glyphMargin?.persistLane}})),i=i.concat(this._glyphMarginWidgets.getWidgets().map(s=>{let a=t.validateRange(s.preference.range);return r=Math.max(r,a.endLineNumber),{range:a,lane:s.preference.lane}})),i.sort((s,a)=>P.compareRangesUsingStarts(s.range,a.range)),n.reset(r);for(let s of i)n.push(s.lane,s.range,s.persist);return n}_createPointerHandlerHelper(){return{viewDomNode:this.domNode.domNode,linesContentDomNode:this._linesContent.domNode,viewLinesDomNode:this._viewLines.getDomNode().domNode,focusTextArea:()=>{this.focus()},dispatchTextAreaEvent:t=>{this._editContext.domNode.domNode.dispatchEvent(t)},getLastRenderData:()=>{let t=this._viewCursors.getLastRenderData()||[],n=this._editContext.getLastRenderData();return new zx(t,n)},renderNow:()=>{this.render(!0,!1)},shouldSuppressMouseDownOnViewZone:t=>this._viewZones.shouldSuppressMouseDownOnViewZone(t),shouldSuppressMouseDownOnWidget:t=>this._contentWidgets.shouldSuppressMouseDownOnWidget(t),getPositionFromDOMInfo:(t,n)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.getPositionFromDOMInfo(t,n)),visibleRangeForPosition:(t,n)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.visibleRangeForPosition(new A(t,n))),getLineWidth:t=>(this._flushAccumulatedAndRenderNow(),this._viewLines.getLineWidth(t))}}_createTextAreaHandlerHelper(){return{visibleRangeForPosition:t=>(this._flushAccumulatedAndRenderNow(),this._viewLines.visibleRangeForPosition(t))}}_applyLayout(){let n=this._context.configuration.options.get(147);this.domNode.setWidth(n.width),this.domNode.setHeight(n.height),this._overflowGuardContainer.setWidth(n.width),this._overflowGuardContainer.setHeight(n.height),this._linesContent.setWidth(16777216),this._linesContent.setHeight(16777216)}_getEditorClassName(){let t=this._editContext.isFocused()?" focused":"";return this._context.configuration.options.get(144)+" "+Ab(this._context.theme.type)+t}handleEvents(t){super.handleEvents(t),this._scheduleRender()}onConfigurationChanged(t){return this.domNode.setClassName(this._getEditorClassName()),this._applyLayout(),!1}onCursorStateChanged(t){return this._selections=t.selections,!1}onDecorationsChanged(t){return t.affectsGlyphMargin&&(this._shouldRecomputeGlyphMarginLanes=!0),!1}onFocusChanged(t){return this.domNode.setClassName(this._getEditorClassName()),!1}onThemeChanged(t){return this._context.theme.update(t.theme),this.domNode.setClassName(this._getEditorClassName()),!1}dispose(){this._renderAnimationFrame!==null&&(this._renderAnimationFrame.dispose(),this._renderAnimationFrame=null),this._contentWidgets.overflowingContentWidgetsDomNode.domNode.remove(),this._context.removeEventHandler(this),this._viewLines.dispose();for(let t of this._viewParts)t.dispose();super.dispose()}_scheduleRender(){if(this._store.isDisposed)throw new Ye;if(this._renderAnimationFrame===null){let t=this._createCoordinatedRendering();this._renderAnimationFrame=RO.INSTANCE.scheduleCoordinatedRendering({window:Ce(this.domNode?.domNode),prepareRenderText:()=>{if(this._store.isDisposed)throw new Ye;try{return t.prepareRenderText()}finally{this._renderAnimationFrame=null}},renderText:()=>{if(this._store.isDisposed)throw new Ye;return t.renderText()},prepareRender:(n,i)=>{if(this._store.isDisposed)throw new Ye;return t.prepareRender(n,i)},render:(n,i)=>{if(this._store.isDisposed)throw new Ye;return t.render(n,i)}})}}_flushAccumulatedAndRenderNow(){let t=this._createCoordinatedRendering();_c(()=>t.prepareRenderText());let n=_c(()=>t.renderText());if(n){let[i,r]=n;_c(()=>t.prepareRender(i,r)),_c(()=>t.render(i,r))}}_getViewPartsToRender(){let t=[],n=0;for(let i of this._viewParts)i.shouldRender()&&(t[n++]=i);return t}_createCoordinatedRendering(){return{prepareRenderText:()=>{if(this._shouldRecomputeGlyphMarginLanes){this._shouldRecomputeGlyphMarginLanes=!1;let t=this._computeGlyphMarginLanes();this._context.configuration.setGlyphMarginDecorationLaneCount(t.requiredLanes)}jl.onRenderStart()},renderText:()=>{if(!this.domNode.domNode.isConnected)return null;let t=this._getViewPartsToRender();if(!this._viewLines.shouldRender()&&t.length===0)return null;let n=this._context.viewLayout.getLinesViewportData();this._context.viewModel.setViewport(n.startLineNumber,n.endLineNumber,n.centeredLineNumber);let i=new Mx(this._selections,n,this._context.viewLayout.getWhitespaceViewportData(),this._context.viewModel);return this._contentWidgets.shouldRender()&&this._contentWidgets.onBeforeRender(i),this._viewLines.shouldRender()&&(this._viewLines.renderText(i),this._viewLines.onDidRender(),t=this._getViewPartsToRender()),[t,new Px(this._context.viewLayout,i,this._viewLines)]},prepareRender:(t,n)=>{for(let i of t)i.prepareRender(n)},render:(t,n)=>{for(let i of t)i.render(n),i.onDidRender()}}}delegateVerticalScrollbarPointerDown(t){this._scrollbar.delegateVerticalScrollbarPointerDown(t)}delegateScrollFromMouseWheelEvent(t){this._scrollbar.delegateScrollFromMouseWheelEvent(t)}restoreState(t){this._context.viewModel.viewLayout.setScrollPosition({scrollTop:t.scrollTop,scrollLeft:t.scrollLeft},1),this._context.viewModel.visibleLinesStabilized()}getOffsetForColumn(t,n){let i=this._context.viewModel.model.validatePosition({lineNumber:t,column:n}),r=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(i);this._flushAccumulatedAndRenderNow();let s=this._viewLines.visibleRangeForPosition(new A(r.lineNumber,r.column));return s?s.left:-1}getTargetAtClientPoint(t,n){let i=this._pointerHandler.getTargetAtClientPoint(t,n);return i?ig.convertViewToModelMouseTarget(i,this._context.viewModel.coordinatesConverter):null}createOverviewRuler(t){return new Uw(this._context,t)}change(t){this._viewZones.changeViewZones(t),this._scheduleRender()}render(t,n){if(n){this._viewLines.forceShouldRender();for(let i of this._viewParts)i.forceShouldRender()}t?this._flushAccumulatedAndRenderNow():this._scheduleRender()}writeScreenReaderContent(t){this._editContext.writeScreenReaderContent(t)}focus(){this._editContext.focus()}isFocused(){return this._editContext.isFocused()}refreshFocusState(){this._editContext.refreshFocusState()}setAriaOptions(t){this._editContext.setAriaOptions(t)}addContentWidget(t){this._contentWidgets.addWidget(t.widget),this.layoutContentWidget(t),this._scheduleRender()}layoutContentWidget(t){this._contentWidgets.setWidgetPosition(t.widget,t.position?.position??null,t.position?.secondaryPosition??null,t.position?.preference??null,t.position?.positionAffinity??null),this._scheduleRender()}removeContentWidget(t){this._contentWidgets.removeWidget(t.widget),this._scheduleRender()}addOverlayWidget(t){this._overlayWidgets.addWidget(t.widget),this.layoutOverlayWidget(t),this._scheduleRender()}layoutOverlayWidget(t){this._overlayWidgets.setWidgetPosition(t.widget,t.position)&&this._scheduleRender()}removeOverlayWidget(t){this._overlayWidgets.removeWidget(t.widget),this._scheduleRender()}addGlyphMarginWidget(t){this._glyphMarginWidgets.addWidget(t.widget),this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender()}layoutGlyphMarginWidget(t){let n=t.position;this._glyphMarginWidgets.setWidgetPosition(t.widget,n)&&(this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender())}removeGlyphMarginWidget(t){this._glyphMarginWidgets.removeWidget(t.widget),this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender()}};bg=O([x(6,Oe)],bg);function _c(o){try{return o()}catch(e){return qe(e),null}}var RO=class o{static INSTANCE=new o;_coordinatedRenderings=[];_animationFrameRunners=new Map;constructor(){}scheduleCoordinatedRendering(e){return this._coordinatedRenderings.push(e),this._scheduleRender(e.window),{dispose:()=>{let t=this._coordinatedRenderings.indexOf(e);if(t!==-1&&(this._coordinatedRenderings.splice(t,1),this._coordinatedRenderings.length===0)){for(let[n,i]of this._animationFrameRunners)i.dispose();this._animationFrameRunners.clear()}}}}_scheduleRender(e){if(!this._animationFrameRunners.has(e)){let t=()=>{this._animationFrameRunners.delete(e),this._onRenderScheduled()};this._animationFrameRunners.set(e,nk(e,t,100))}}_onRenderScheduled(){let e=this._coordinatedRenderings.slice(0);this._coordinatedRenderings=[];for(let n of e)_c(()=>n.prepareRenderText());let t=[];for(let n=0,i=e.length;n<i;n++){let r=e[n];t[n]=_c(()=>r.renderText())}for(let n=0,i=e.length;n<i;n++){let r=e[n],s=t[n];if(!s)continue;let[a,l]=s;_c(()=>r.prepareRender(a,l))}for(let n=0,i=e.length;n<i;n++){let r=e[n],s=t[n];if(!s)continue;let[a,l]=s;_c(()=>r.render(a,l))}}};var Vj=Tc("domLineBreaksComputer",{createHTML:o=>o}),Jw=class o{constructor(e){this.targetWindow=e}static create(e){return new o(new WeakRef(e))}createLineBreaksComputer(e,t,n,i,r){let s=[],a=[];return{addRequest:(l,d,c)=>{s.push(l),a.push(d)},finalize:()=>Wj(fn(this.targetWindow.deref()),s,e,t,n,i,r,a)}}};function Wj(o,e,t,n,i,r,s,a){function l(k){let W=a[k];if(W){let K=Fo.applyInjectedText(e[k],W),U=W.map(Se=>Se.options),oe=W.map(Se=>Se.column-1);return new Ll(oe,U,[K.length],[],0)}else return null}if(i===-1){let k=[];for(let W=0,K=e.length;W<K;W++)k[W]=l(W);return k}let d=Math.round(i*t.typicalHalfwidthCharacterWidth),c=r===3?2:r===2?1:0,u=Math.round(n*c),p=Math.ceil(t.spaceWidth*u),h=document.createElement("div");on(h,t);let f=new va(1e4),g=[],b=[],v=[],y=[],S=[];for(let k=0;k<e.length;k++){let W=Fo.applyInjectedText(e[k],a[k]),K=0,U=0,oe=d;if(r!==0)if(K=Cn(W),K===-1)K=0;else{for(let de=0;de<K;de++){let se=W.charCodeAt(de)===9?n-U%n:1;U+=se}let Q=Math.ceil(t.spaceWidth*U);Q+t.typicalFullwidthCharacterWidth>d?(K=0,U=0):oe=d-Q}let Se=W.substr(K),ne=Hj(Se,U,n,oe,f,p);g[k]=K,b[k]=U,v[k]=Se,y[k]=ne[0],S[k]=ne[1]}let E=f.build(),C=Vj?.createHTML(E)??E;h.innerHTML=C,h.style.position="absolute",h.style.top="10000",s==="keepAll"?(h.style.wordBreak="keep-all",h.style.overflowWrap="anywhere"):(h.style.wordBreak="inherit",h.style.overflowWrap="break-word"),o.document.body.appendChild(h);let w=document.createRange(),_=Array.prototype.slice.call(h.children,0),L=[];for(let k=0;k<e.length;k++){let W=_[k],K=Uj(w,W,v[k],y[k]);if(K===null){L[k]=l(k);continue}let U=g[k],oe=b[k]+u,Se=S[k],ne=[];for(let ie=0,Te=K.length;ie<Te;ie++)ne[ie]=Se[K[ie]];if(U!==0)for(let ie=0,Te=K.length;ie<Te;ie++)K[ie]+=U;let Q,de,se=a[k];se?(Q=se.map(ie=>ie.options),de=se.map(ie=>ie.column-1)):(Q=null,de=null),L[k]=new Ll(de,Q,K,ne,oe)}return h.remove(),L}function Hj(o,e,t,n,i,r){if(r!==0){let p=String(r);i.appendString('<div style="text-indent: -'),i.appendString(p),i.appendString("px; padding-left: "),i.appendString(p),i.appendString("px; box-sizing: border-box; width:")}else i.appendString('<div style="width:');i.appendString(String(n)),i.appendString('px;">');let s=o.length,a=e,l=0,d=[],c=[],u=0<s?o.charCodeAt(0):0;i.appendString("<span>");for(let p=0;p<s;p++){p!==0&&p%16384===0&&i.appendString("</span><span>"),d[p]=l,c[p]=a;let h=u;u=p+1<s?o.charCodeAt(p+1):0;let f=1,g=1;switch(h){case 9:f=t-a%t,g=f;for(let b=1;b<=f;b++)b<f?i.appendCharCode(160):i.appendASCIICharCode(32);break;case 32:u===32?i.appendCharCode(160):i.appendASCIICharCode(32);break;case 60:i.appendString("&lt;");break;case 62:i.appendString("&gt;");break;case 38:i.appendString("&amp;");break;case 0:i.appendString("&#00;");break;case 65279:case 8232:case 8233:case 133:i.appendCharCode(65533);break;default:Rr(h)&&g++,h<32?i.appendCharCode(9216+h):i.appendCharCode(h)}l+=f,a+=g}return i.appendString("</span>"),d[o.length]=l,c[o.length]=a,i.appendString("</div>"),[d,c]}function Uj(o,e,t,n){if(t.length<=1)return null;let i=Array.prototype.slice.call(e.children,0),r=[];try{MO(o,i,n,0,null,t.length-1,null,r)}catch(s){return console.log(s),null}return r.length===0?null:(r.push(t.length),r)}function MO(o,e,t,n,i,r,s,a){if(n===r||(i=i||kO(o,e,t[n],t[n+1]),s=s||kO(o,e,t[r],t[r+1]),Math.abs(i[0].top-s[0].top)<=.1))return;if(n+1===r){a.push(r);return}let l=n+(r-n)/2|0,d=kO(o,e,t[l],t[l+1]);MO(o,e,t,n,i,l,d,a),MO(o,e,t,l,d,r,s,a)}function kO(o,e,t,n){return o.setStart(e[t/16384|0].firstChild,t%16384),o.setEnd(e[n/16384|0].firstChild,n%16384),o.getClientRects()}var e_=class extends F{_editor=null;_instantiationService=null;_instances=this._register(new Lo);_pending=new Map;_finishedInstantiation=[];constructor(){super(),this._finishedInstantiation[0]=!1,this._finishedInstantiation[1]=!1,this._finishedInstantiation[2]=!1,this._finishedInstantiation[3]=!1}initialize(e,t,n){this._editor=e,this._instantiationService=n;for(let i of t){if(this._pending.has(i.id)){qe(new Error(`Cannot have two contributions with the same id ${i.id}`));continue}this._pending.set(i.id,i)}this._instantiateSome(0),this._register(Sb(Ce(this._editor.getDomNode()),()=>{this._instantiateSome(1)})),this._register(Sb(Ce(this._editor.getDomNode()),()=>{this._instantiateSome(2)})),this._register(Sb(Ce(this._editor.getDomNode()),()=>{this._instantiateSome(3)},5e3))}saveViewState(){let e={};for(let[t,n]of this._instances)typeof n.saveViewState=="function"&&(e[t]=n.saveViewState());return e}restoreViewState(e){for(let[t,n]of this._instances)typeof n.restoreViewState=="function"&&n.restoreViewState(e[t])}get(e){return this._instantiateById(e),this._instances.get(e)||null}set(e,t){this._instances.set(e,t)}onBeforeInteractionEvent(){this._instantiateSome(2)}onAfterModelAttached(){return Sb(Ce(this._editor?.getDomNode()),()=>{this._instantiateSome(1)},50)}_instantiateSome(e){if(this._finishedInstantiation[e])return;this._finishedInstantiation[e]=!0;let t=this._findPendingContributionsByInstantiation(e);for(let n of t)this._instantiateById(n.id)}_findPendingContributionsByInstantiation(e){let t=[];for(let[,n]of this._pending)n.instantiation===e&&t.push(n);return t}_instantiateById(e){let t=this._pending.get(e);if(t){if(this._pending.delete(e),!this._instantiationService||!this._editor)throw new Error("Cannot instantiate contributions before being initialized!");try{let n=this._instantiationService.createInstance(t.ctor,this._editor);this._instances.set(t.id,n),typeof n.restoreViewState=="function"&&t.instantiation!==0&&console.warn(`Editor contribution '${t.id}' should be eager instantiated because it uses saveViewState / restoreViewState.`)}catch(n){qe(n)}}}};var t_=class{constructor(e,t,n,i,r,s,a){this.id=e;this.label=t;this.alias=n;this.metadata=i;this._precondition=r;this._run=s;this._contextKeyService=a}isSupported(){return this._contextKeyService.contextMatchesRules(this._precondition)}run(e){return this.isSupported()?this._run(e):Promise.resolve(void 0)}};var e5=Y("ILanguageFeaturesService");var n_=class o{static create(e){return new o(e.get(136),e.get(135))}classifier;constructor(e,t){this.classifier=new PO(e,t)}createLineBreaksComputer(e,t,n,i,r){let s=[],a=[],l=[];return{addRequest:(d,c,u)=>{s.push(d),a.push(c),l.push(u)},finalize:()=>{let d=e.typicalFullwidthCharacterWidth/e.typicalHalfwidthCharacterWidth,c=[];for(let u=0,p=s.length;u<p;u++){let h=a[u],f=l[u];f&&!f.injectionOptions&&!h?c[u]=zj(this.classifier,f,s[u],t,n,d,i,r):c[u]=Kj(this.classifier,s[u],h,t,n,d,i,r)}return OO.length=0,NO.length=0,c}}}};var PO=class extends ih{constructor(e,t){super(0);for(let n=0;n<e.length;n++)this.set(e.charCodeAt(n),1);for(let n=0;n<t.length;n++)this.set(t.charCodeAt(n),2)}get(e){return e>=0&&e<256?this._asciiMap[e]:e>=12352&&e<=12543||e>=13312&&e<=19903||e>=19968&&e<=40959?3:this._map.get(e)||this._defaultValue}},OO=[],NO=[];function zj(o,e,t,n,i,r,s,a){if(i===-1)return null;let l=t.length;if(l<=1)return null;let d=a==="keepAll",c=e.breakOffsets,u=e.breakOffsetsVisibleColumn,p=n5(t,n,i,r,s),h=i-p,f=OO,g=NO,b=0,v=0,y=0,S=i,E=c.length,C=0;if(C>=0){let w=Math.abs(u[C]-S);for(;C+1<E;){let _=Math.abs(u[C+1]-S);if(_>=w)break;w=_,C++}}for(;C<E;){let w=C<0?0:c[C],_=C<0?0:u[C];v>w&&(w=v,_=y);let L=0,k=0,W=0,K=0;if(_<=S){let oe=_,Se=w===0?0:t.charCodeAt(w-1),ne=w===0?0:o.get(Se),Q=!0;for(let de=w;de<l;de++){let se=de,ie=t.charCodeAt(de),Te,ue;if(ln(ie)?(de++,Te=0,ue=2):(Te=o.get(ie),ue=ey(ie,oe,n,r)),se>v&&AO(Se,ne,ie,Te,d)&&(L=se,k=oe),oe+=ue,oe>S){se>v?(W=se,K=oe-ue):(W=de+1,K=oe),oe-k>h&&(L=0),Q=!1;break}Se=ie,ne=Te}if(Q){b>0&&(f[b]=c[c.length-1],g[b]=u[c.length-1],b++);break}}if(L===0){let oe=_,Se=t.charCodeAt(w),ne=o.get(Se),Q=!1;for(let de=w-1;de>=v;de--){let se=de+1,ie=t.charCodeAt(de);if(ie===9){Q=!0;break}let Te,ue;if(Id(ie)?(de--,Te=0,ue=2):(Te=o.get(ie),ue=Rr(ie)?r:1),oe<=S){if(W===0&&(W=se,K=oe),oe<=S-h)break;if(AO(ie,Te,Se,ne,d)){L=se,k=oe;break}}oe-=ue,Se=ie,ne=Te}if(L!==0){let de=h-(K-k);if(de<=n){let se=t.charCodeAt(W),ie;ln(se)?ie=2:ie=ey(se,K,n,r),de-ie<0&&(L=0)}}if(Q){C--;continue}}if(L===0&&(L=W,k=K),L<=v){let oe=t.charCodeAt(v);ln(oe)?(L=v+2,k=y+2):(L=v+1,k=y+ey(oe,y,n,r))}for(v=L,f[b]=L,y=k,g[b]=k,b++,S=k+h;C<0||C<E&&u[C]<k;)C++;let U=Math.abs(u[C]-S);for(;C+1<E;){let oe=Math.abs(u[C+1]-S);if(oe>=U)break;U=oe,C++}}return b===0?null:(f.length=b,g.length=b,OO=e.breakOffsets,NO=e.breakOffsetsVisibleColumn,e.breakOffsets=f,e.breakOffsetsVisibleColumn=g,e.wrappedTextIndentLength=p,e)}function Kj(o,e,t,n,i,r,s,a){let l=Fo.applyInjectedText(e,t),d,c;if(t&&t.length>0?(d=t.map(k=>k.options),c=t.map(k=>k.column-1)):(d=null,c=null),i===-1)return d?new Ll(c,d,[l.length],[],0):null;let u=l.length;if(u<=1)return d?new Ll(c,d,[l.length],[],0):null;let p=a==="keepAll",h=n5(l,n,i,r,s),f=i-h,g=[],b=[],v=0,y=0,S=0,E=i,C=l.charCodeAt(0),w=o.get(C),_=ey(C,0,n,r),L=1;ln(C)&&(_+=1,C=l.charCodeAt(1),w=o.get(C),L++);for(let k=L;k<u;k++){let W=k,K=l.charCodeAt(k),U,oe;ln(K)?(k++,U=0,oe=2):(U=o.get(K),oe=ey(K,_,n,r)),AO(C,w,K,U,p)&&(y=W,S=_),_+=oe,_>E&&((y===0||_-S>f)&&(y=W,S=_-oe),g[v]=y,b[v]=S,v++,E=S+f,y=0),C=K,w=U}return v===0&&(!t||t.length===0)?null:(g[v]=u,b[v]=_,new Ll(c,d,g,b,h))}function ey(o,e,t,n){return o===9?t-e%t:Rr(o)||o<32?n:1}function t5(o,e){return e-o%e}function AO(o,e,t,n,i){return t!==32&&(e===2&&n!==2||e!==1&&n===1||!i&&e===3&&n!==2||!i&&n===3&&e!==1)}function n5(o,e,t,n,i){let r=0;if(i!==0){let s=Cn(o);if(s!==-1){for(let l=0;l<s;l++){let d=o.charCodeAt(l)===9?t5(r,e):1;r+=d}let a=i===3?2:i===2?1:0;for(let l=0;l<a;l++){let d=t5(r,e);r+=d}r+n>t&&(r=0)}}return r}var ty=class{_cursorContextBrand=void 0;model;viewModel;coordinatesConverter;cursorConfig;constructor(e,t,n,i){this.model=e,this.viewModel=t,this.coordinatesConverter=n,this.cursorConfig=i}};var ny=class o{modelState;viewState;_selTrackedRange;_trackSelection;constructor(e){this._selTrackedRange=null,this._trackSelection=!0,this._setState(e,new Pn(new P(1,1,1,1),0,0,new A(1,1),0),new Pn(new P(1,1,1,1),0,0,new A(1,1),0))}dispose(e){this._removeTrackedRange(e)}startTrackingSelection(e){this._trackSelection=!0,this._updateTrackedRange(e)}stopTrackingSelection(e){this._trackSelection=!1,this._removeTrackedRange(e)}_updateTrackedRange(e){this._trackSelection&&(this._selTrackedRange=e.model._setTrackedRange(this._selTrackedRange,this.modelState.selection,0))}_removeTrackedRange(e){this._selTrackedRange=e.model._setTrackedRange(this._selTrackedRange,null,0)}asCursorState(){return new Ze(this.modelState,this.viewState)}readSelectionFromMarkers(e){let t=e.model._getTrackedRange(this._selTrackedRange);return this.modelState.selection.isEmpty()&&!t.isEmpty()?$e.fromRange(t.collapseToEnd(),this.modelState.selection.getDirection()):$e.fromRange(t,this.modelState.selection.getDirection())}ensureValidState(e){this._setState(e,this.modelState,this.viewState)}setState(e,t,n){this._setState(e,t,n)}static _validatePositionWithCache(e,t,n,i){return t.equals(n)?i:e.normalizePosition(t,2)}static _validateViewState(e,t){let n=t.position,i=t.selectionStart.getStartPosition(),r=t.selectionStart.getEndPosition(),s=e.normalizePosition(n,2),a=this._validatePositionWithCache(e,i,n,s),l=this._validatePositionWithCache(e,r,i,a);return n.equals(s)&&i.equals(a)&&r.equals(l)?t:new Pn(P.fromPositions(a,l),t.selectionStartKind,t.selectionStartLeftoverVisibleColumns+i.column-a.column,s,t.leftoverVisibleColumns+n.column-s.column)}_setState(e,t,n){if(n&&(n=o._validateViewState(e.viewModel,n)),t){let i=e.model.validateRange(t.selectionStart),r=t.selectionStart.equalsRange(i)?t.selectionStartLeftoverVisibleColumns:0,s=e.model.validatePosition(t.position),a=t.position.equals(s)?t.leftoverVisibleColumns:0;t=new Pn(i,t.selectionStartKind,r,s,a)}else{if(!n)return;let i=e.model.validateRange(e.coordinatesConverter.convertViewRangeToModelRange(n.selectionStart)),r=e.model.validatePosition(e.coordinatesConverter.convertViewPositionToModelPosition(n.position));t=new Pn(i,n.selectionStartKind,n.selectionStartLeftoverVisibleColumns,r,n.leftoverVisibleColumns)}if(n){let i=e.coordinatesConverter.validateViewRange(n.selectionStart,t.selectionStart),r=e.coordinatesConverter.validateViewPosition(n.position,t.position);n=new Pn(i,t.selectionStartKind,t.selectionStartLeftoverVisibleColumns,r,t.leftoverVisibleColumns)}else{let i=e.coordinatesConverter.convertModelPositionToViewPosition(new A(t.selectionStart.startLineNumber,t.selectionStart.startColumn)),r=e.coordinatesConverter.convertModelPositionToViewPosition(new A(t.selectionStart.endLineNumber,t.selectionStart.endColumn)),s=new P(i.lineNumber,i.column,r.lineNumber,r.column),a=e.coordinatesConverter.convertModelPositionToViewPosition(t.position);n=new Pn(s,t.selectionStartKind,t.selectionStartLeftoverVisibleColumns,a,t.leftoverVisibleColumns)}this.modelState=t,this.viewState=n,this._updateTrackedRange(e)}};var iy=class{context;cursors;lastAddedCursorIndex;constructor(e){this.context=e,this.cursors=[new ny(e)],this.lastAddedCursorIndex=0}dispose(){for(let e of this.cursors)e.dispose(this.context)}startTrackingSelections(){for(let e of this.cursors)e.startTrackingSelection(this.context)}stopTrackingSelections(){for(let e of this.cursors)e.stopTrackingSelection(this.context)}updateContext(e){this.context=e}ensureValidState(){for(let e of this.cursors)e.ensureValidState(this.context)}readSelectionFromMarkers(){return this.cursors.map(e=>e.readSelectionFromMarkers(this.context))}getAll(){return this.cursors.map(e=>e.asCursorState())}getViewPositions(){return this.cursors.map(e=>e.viewState.position)}getTopMostViewPosition(){return AN(this.cursors,mo(e=>e.viewState.position,A.compare)).viewState.position}getBottomMostViewPosition(){return NN(this.cursors,mo(e=>e.viewState.position,A.compare)).viewState.position}getSelections(){return this.cursors.map(e=>e.modelState.selection)}getViewSelections(){return this.cursors.map(e=>e.viewState.selection)}setSelections(e){this.setStates(Ze.fromModelSelections(e))}getPrimaryCursor(){return this.cursors[0].asCursorState()}setStates(e){e!==null&&(this.cursors[0].setState(this.context,e[0].modelState,e[0].viewState),this._setSecondaryStates(e.slice(1)))}_setSecondaryStates(e){let t=this.cursors.length-1,n=e.length;if(t<n){let i=n-t;for(let r=0;r<i;r++)this._addSecondaryCursor()}else if(t>n){let i=t-n;for(let r=0;r<i;r++)this._removeSecondaryCursor(this.cursors.length-2)}for(let i=0;i<n;i++)this.cursors[i+1].setState(this.context,e[i].modelState,e[i].viewState)}killSecondaryCursors(){this._setSecondaryStates([])}_addSecondaryCursor(){this.cursors.push(new ny(this.context)),this.lastAddedCursorIndex=this.cursors.length-1}getLastAddedCursorIndex(){return this.cursors.length===1||this.lastAddedCursorIndex===0?0:this.lastAddedCursorIndex}_removeSecondaryCursor(e){this.lastAddedCursorIndex>=e+1&&this.lastAddedCursorIndex--,this.cursors[e+1].dispose(this.context),this.cursors.splice(e+1,1)}normalize(){if(this.cursors.length===1)return;let e=this.cursors.slice(0),t=[];for(let n=0,i=e.length;n<i;n++)t.push({index:n,selection:e[n].modelState.selection});t.sort(mo(n=>n.selection,P.compareRangesUsingStarts));for(let n=0;n<t.length-1;n++){let i=t[n],r=t[n+1],s=i.selection,a=r.selection;if(!this.context.cursorConfig.multiCursorMergeOverlapping)continue;let l;if(a.isEmpty()||s.isEmpty()?l=a.getStartPosition().isBeforeOrEqual(s.getEndPosition()):l=a.getStartPosition().isBefore(s.getEndPosition()),l){let d=i.index<r.index?n:n+1,c=i.index<r.index?n+1:n,u=t[c].index,p=t[d].index,h=t[c].selection,f=t[d].selection;if(!h.equalsSelection(f)){let g=h.plusRange(f),b=h.selectionStartLineNumber===h.startLineNumber&&h.selectionStartColumn===h.startColumn,v=f.selectionStartLineNumber===f.startLineNumber&&f.selectionStartColumn===f.startColumn,y;u===this.lastAddedCursorIndex?(y=b,this.lastAddedCursorIndex=p):y=v;let S;y?S=new $e(g.startLineNumber,g.startColumn,g.endLineNumber,g.endColumn):S=new $e(g.endLineNumber,g.endColumn,g.startLineNumber,g.startColumn),t[d].selection=S;let E=Ze.fromModelSelection(S);e[p].setState(this.context,E.modelState,E.viewState)}for(let g of t)g.index>u&&g.index--;e.splice(u,1),t.splice(c,1),this._removeSecondaryCursor(u-1),n--}}}};var i_=class extends F{_onEvent=this._register(new D);onEvent=this._onEvent.event;_eventHandlers;_viewEventQueue;_isConsumingViewEventQueue;_collector;_collectorCnt;_outgoingEvents;constructor(){super(),this._eventHandlers=[],this._viewEventQueue=null,this._isConsumingViewEventQueue=!1,this._collector=null,this._collectorCnt=0,this._outgoingEvents=[]}emitOutgoingEvent(e){this._addOutgoingEvent(e),this._emitOutgoingEvents()}_addOutgoingEvent(e){for(let t=0,n=this._outgoingEvents.length;t<n;t++){let i=this._outgoingEvents[t].kind===e.kind?this._outgoingEvents[t].attemptToMerge(e):null;if(i){this._outgoingEvents[t]=i;return}}this._outgoingEvents.push(e)}_emitOutgoingEvents(){for(;this._outgoingEvents.length>0;){if(this._collector||this._isConsumingViewEventQueue)return;let e=this._outgoingEvents.shift();e.isNoOp()||this._onEvent.fire(e)}}addViewEventHandler(e){for(let t=0,n=this._eventHandlers.length;t<n;t++)this._eventHandlers[t]===e&&console.warn("Detected duplicate listener in ViewEventDispatcher",e);this._eventHandlers.push(e)}removeViewEventHandler(e){for(let t=0;t<this._eventHandlers.length;t++)if(this._eventHandlers[t]===e){this._eventHandlers.splice(t,1);break}}beginEmitViewEvents(){return this._collectorCnt++,this._collectorCnt===1&&(this._collector=new FO),this._collector}endEmitViewEvents(){if(this._collectorCnt--,this._collectorCnt===0){let e=this._collector.outgoingEvents,t=this._collector.viewEvents;this._collector=null;for(let n of e)this._addOutgoingEvent(n);t.length>0&&this._emitMany(t)}this._emitOutgoingEvents()}emitSingleViewEvent(e){try{this.beginEmitViewEvents().emitViewEvent(e)}finally{this.endEmitViewEvents()}}_emitMany(e){this._viewEventQueue?this._viewEventQueue=this._viewEventQueue.concat(e):this._viewEventQueue=e,this._isConsumingViewEventQueue||this._consumeViewEventQueue()}_consumeViewEventQueue(){try{this._isConsumingViewEventQueue=!0,this._doConsumeQueue()}finally{this._isConsumingViewEventQueue=!1}}_doConsumeQueue(){for(;this._viewEventQueue;){let e=this._viewEventQueue;this._viewEventQueue=null;let t=this._eventHandlers.slice(0);for(let n of t)n.handleEvents(e)}}},FO=class{viewEvents;outgoingEvents;constructor(){this.viewEvents=[],this.outgoingEvents=[]}emitViewEvent(e){this.viewEvents.push(e)}emitOutgoingEvent(e){this.outgoingEvents.push(e)}};var o_=class o{kind=0;_oldContentWidth;_oldContentHeight;contentWidth;contentHeight;contentWidthChanged;contentHeightChanged;constructor(e,t,n,i){this._oldContentWidth=e,this._oldContentHeight=t,this.contentWidth=n,this.contentHeight=i,this.contentWidthChanged=this._oldContentWidth!==this.contentWidth,this.contentHeightChanged=this._oldContentHeight!==this.contentHeight}isNoOp(){return!this.contentWidthChanged&&!this.contentHeightChanged}attemptToMerge(e){return e.kind!==this.kind?null:new o(this._oldContentWidth,this._oldContentHeight,e.contentWidth,e.contentHeight)}},r_=class o{kind=1;oldHasFocus;hasFocus;constructor(e,t){this.oldHasFocus=e,this.hasFocus=t}isNoOp(){return this.oldHasFocus===this.hasFocus}attemptToMerge(e){return e.kind!==this.kind?null:new o(this.oldHasFocus,e.hasFocus)}},s_=class o{kind=2;_oldScrollWidth;_oldScrollLeft;_oldScrollHeight;_oldScrollTop;scrollWidth;scrollLeft;scrollHeight;scrollTop;scrollWidthChanged;scrollLeftChanged;scrollHeightChanged;scrollTopChanged;constructor(e,t,n,i,r,s,a,l){this._oldScrollWidth=e,this._oldScrollLeft=t,this._oldScrollHeight=n,this._oldScrollTop=i,this.scrollWidth=r,this.scrollLeft=s,this.scrollHeight=a,this.scrollTop=l,this.scrollWidthChanged=this._oldScrollWidth!==this.scrollWidth,this.scrollLeftChanged=this._oldScrollLeft!==this.scrollLeft,this.scrollHeightChanged=this._oldScrollHeight!==this.scrollHeight,this.scrollTopChanged=this._oldScrollTop!==this.scrollTop}isNoOp(){return!this.scrollWidthChanged&&!this.scrollLeftChanged&&!this.scrollHeightChanged&&!this.scrollTopChanged}attemptToMerge(e){return e.kind!==this.kind?null:new o(this._oldScrollWidth,this._oldScrollLeft,this._oldScrollHeight,this._oldScrollTop,e.scrollWidth,e.scrollLeft,e.scrollHeight,e.scrollTop)}},a_=class{kind=3;constructor(){}isNoOp(){return!1}attemptToMerge(e){return e.kind!==this.kind?null:this}},l_=class{kind=4;constructor(){}isNoOp(){return!1}attemptToMerge(e){return e.kind!==this.kind?null:this}},d_=class o{kind=6;oldSelections;selections;oldModelVersionId;modelVersionId;source;reason;reachedMaxCursorCount;constructor(e,t,n,i,r,s,a){this.oldSelections=e,this.selections=t,this.oldModelVersionId=n,this.modelVersionId=i,this.source=r,this.reason=s,this.reachedMaxCursorCount=a}static _selectionsAreEqual(e,t){if(!e&&!t)return!0;if(!e||!t)return!1;let n=e.length,i=t.length;if(n!==i)return!1;for(let r=0;r<n;r++)if(!e[r].equalsSelection(t[r]))return!1;return!0}isNoOp(){return o._selectionsAreEqual(this.oldSelections,this.selections)&&this.oldModelVersionId===this.modelVersionId}attemptToMerge(e){return e.kind!==this.kind?null:new o(this.oldSelections,e.selections,this.oldModelVersionId,e.modelVersionId,e.source,e.reason,this.reachedMaxCursorCount||e.reachedMaxCursorCount)}},c_=class{kind=5;constructor(){}isNoOp(){return!1}attemptToMerge(e){return e.kind!==this.kind?null:this}},u_=class{constructor(e){this.event=e}kind=7;isNoOp(){return!1}attemptToMerge(e){return null}},p_=class{constructor(e){this.event=e}kind=8;isNoOp(){return!1}attemptToMerge(e){return null}},h_=class{constructor(e){this.event=e}kind=9;isNoOp(){return!1}attemptToMerge(e){return null}},m_=class{constructor(e){this.event=e}kind=10;isNoOp(){return!1}attemptToMerge(e){return null}},g_=class{constructor(e){this.event=e}kind=11;isNoOp(){return!1}attemptToMerge(e){return null}},f_=class{constructor(e){this.event=e}kind=12;isNoOp(){return!1}attemptToMerge(e){return null}};var b_=class extends F{_model;_knownModelVersionId;_viewModel;_coordinatesConverter;context;_cursors;_hasFocus;_isHandling;_compositionState;_columnSelectData;_autoClosedActions;_prevEditOperationType;constructor(e,t,n,i){super(),this._model=e,this._knownModelVersionId=this._model.getVersionId(),this._viewModel=t,this._coordinatesConverter=n,this.context=new ty(this._model,this._viewModel,this._coordinatesConverter,i),this._cursors=new iy(this.context),this._hasFocus=!1,this._isHandling=!1,this._compositionState=null,this._columnSelectData=null,this._autoClosedActions=[],this._prevEditOperationType=0}dispose(){this._cursors.dispose(),this._autoClosedActions=wt(this._autoClosedActions),super.dispose()}updateConfiguration(e){this.context=new ty(this._model,this._viewModel,this._coordinatesConverter,e),this._cursors.updateContext(this.context)}onLineMappingChanged(e){this._knownModelVersionId===this._model.getVersionId()&&this.setStates(e,"viewModel",0,this.getCursorStates())}setHasFocus(e){this._hasFocus=e}_validateAutoClosedActions(){if(this._autoClosedActions.length>0){let e=this._cursors.getSelections();for(let t=0;t<this._autoClosedActions.length;t++){let n=this._autoClosedActions[t];n.isValid(e)||(n.dispose(),this._autoClosedActions.splice(t,1),t--)}}}getPrimaryCursorState(){return this._cursors.getPrimaryCursor()}getLastAddedCursorIndex(){return this._cursors.getLastAddedCursorIndex()}getCursorStates(){return this._cursors.getAll()}setStates(e,t,n,i){let r=!1,s=this.context.cursorConfig.multiCursorLimit;i!==null&&i.length>s&&(i=i.slice(0,s),r=!0);let a=oy.from(this._model,this);return this._cursors.setStates(i),this._cursors.normalize(),this._columnSelectData=null,this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(e,t,n,a,r)}setCursorColumnSelectData(e){this._columnSelectData=e}revealAll(e,t,n,i,r,s){let a=this._cursors.getViewPositions(),l=null,d=null;a.length>1?d=this._cursors.getViewSelections():l=P.fromPositions(a[0],a[0]),e.emitViewEvent(new kl(t,n,l,d,i,r,s))}revealPrimary(e,t,n,i,r,s){let l=[this._cursors.getPrimaryCursor().viewState.selection];e.emitViewEvent(new kl(t,n,null,l,i,r,s))}saveState(){let e=[],t=this._cursors.getSelections();for(let n=0,i=t.length;n<i;n++){let r=t[n];e.push({inSelectionMode:!r.isEmpty(),selectionStart:{lineNumber:r.selectionStartLineNumber,column:r.selectionStartColumn},position:{lineNumber:r.positionLineNumber,column:r.positionColumn}})}return e}restoreState(e,t){let n=[];for(let i=0,r=t.length;i<r;i++){let s=t[i],a=1,l=1;s.position&&s.position.lineNumber&&(a=s.position.lineNumber),s.position&&s.position.column&&(l=s.position.column);let d=a,c=l;s.selectionStart&&s.selectionStart.lineNumber&&(d=s.selectionStart.lineNumber),s.selectionStart&&s.selectionStart.column&&(c=s.selectionStart.column),n.push({selectionStartLineNumber:d,selectionStartColumn:c,positionLineNumber:a,positionColumn:l})}this.setStates(e,"restoreState",0,Ze.fromModelSelections(n)),this.revealAll(e,"restoreState",!1,0,!0,1)}onModelContentChanged(e,t){if(t instanceof fh){if(this._isHandling)return;this._isHandling=!0;try{this.setStates(e,"modelChange",0,this.getCursorStates())}finally{this._isHandling=!1}}else{let n=t.rawContentChangedEvent;if(this._knownModelVersionId=n.versionId,this._isHandling)return;let i=n.containsEvent(1);if(this._prevEditOperationType=0,i)this._cursors.dispose(),this._cursors=new iy(this.context),this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(e,"model",1,null,!1);else if(this._hasFocus&&n.resultingSelection&&n.resultingSelection.length>0){let r=Ze.fromModelSelections(n.resultingSelection);this.setStates(e,"modelChange",n.isUndoing?5:n.isRedoing?6:2,r)&&this.revealAll(e,"modelChange",!1,0,!0,0)}else{let r=this._cursors.readSelectionFromMarkers();this.setStates(e,"modelChange",2,Ze.fromModelSelections(r))}}}getSelection(){return this._cursors.getPrimaryCursor().modelState.selection}getTopMostViewPosition(){return this._cursors.getTopMostViewPosition()}getBottomMostViewPosition(){return this._cursors.getBottomMostViewPosition()}getCursorColumnSelectData(){if(this._columnSelectData)return this._columnSelectData;let e=this._cursors.getPrimaryCursor(),t=e.viewState.selectionStart.getStartPosition(),n=e.viewState.position;return{isReal:!1,fromViewLineNumber:t.lineNumber,fromViewVisualColumn:this.context.cursorConfig.visibleColumnFromColumn(this._viewModel,t),toViewLineNumber:n.lineNumber,toViewVisualColumn:this.context.cursorConfig.visibleColumnFromColumn(this._viewModel,n)}}getSelections(){return this._cursors.getSelections()}getPosition(){return this._cursors.getPrimaryCursor().modelState.position}setSelections(e,t,n,i){this.setStates(e,t,i,Ze.fromModelSelections(n))}getPrevEditOperationType(){return this._prevEditOperationType}setPrevEditOperationType(e){this._prevEditOperationType=e}_pushAutoClosedAction(e,t){let n=[],i=[];for(let a=0,l=e.length;a<l;a++)n.push({range:e[a],options:{description:"auto-closed-character",inlineClassName:"auto-closed-character",stickiness:1}}),i.push({range:t[a],options:{description:"auto-closed-enclosing",stickiness:1}});let r=this._model.deltaDecorations([],n),s=this._model.deltaDecorations([],i);this._autoClosedActions.push(new v_(this._model,r,s))}_executeEditOperation(e){if(!e)return;e.shouldPushStackElementBefore&&this._model.pushStackElement();let t=BO.executeCommands(this._model,this._cursors.getSelections(),e.commands);if(t){this._interpretCommandResult(t);let n=[],i=[];for(let r=0;r<e.commands.length;r++){let s=e.commands[r];s instanceof Jm&&s.enclosingRange&&s.closeCharacterRange&&(n.push(s.closeCharacterRange),i.push(s.enclosingRange))}n.length>0&&this._pushAutoClosedAction(n,i),this._prevEditOperationType=e.type}e.shouldPushStackElementAfter&&this._model.pushStackElement()}_interpretCommandResult(e){(!e||e.length===0)&&(e=this._cursors.readSelectionFromMarkers()),this._columnSelectData=null,this._cursors.setSelections(e),this._cursors.normalize()}_emitStateChangedIfNecessary(e,t,n,i,r){let s=oy.from(this._model,this);if(s.equals(i))return!1;let a=this._cursors.getSelections(),l=this._cursors.getViewSelections();if(e.emitViewEvent(new jS(l,a,n)),!i||i.cursorState.length!==s.cursorState.length||s.cursorState.some((d,c)=>!d.modelState.equals(i.cursorState[c].modelState))){let d=i?i.cursorState.map(u=>u.modelState.selection):null,c=i?i.modelVersionId:0;e.emitOutgoingEvent(new d_(d,a,c,s.modelVersionId,t||"keyboard",n,r))}return!0}_findAutoClosingPairs(e){if(!e.length)return null;let t=[];for(let n=0,i=e.length;n<i;n++){let r=e[n];if(!r.text||r.text.indexOf(`
`)>=0)return null;let s=r.text.match(/([)\]}>'"`])([^)\]}>'"`]*)$/);if(!s)return null;let a=s[1],l=this.context.cursorConfig.autoClosingPairs.autoClosingPairsCloseSingleChar.get(a);if(!l||l.length!==1)return null;let d=l[0].open,c=r.text.length-s[2].length-1,u=r.text.lastIndexOf(d,c-1);if(u===-1)return null;t.push([u,c])}return t}executeEdits(e,t,n,i){let r=null;t==="snippet"&&(r=this._findAutoClosingPairs(n)),r&&(n[0]._isTracked=!0);let s=[],a=[],l=this._model.pushEditOperations(this.getSelections(),n,d=>{if(r)for(let u=0,p=r.length;u<p;u++){let[h,f]=r[u],g=d[u],b=g.range.startLineNumber,v=g.range.startColumn-1+h,y=g.range.startColumn-1+f;s.push(new P(b,y+1,b,y+2)),a.push(new P(b,v+1,b,y+2))}let c=i(d);return c&&(this._isHandling=!0),c});l&&(this._isHandling=!1,this.setSelections(e,t,l,0)),s.length>0&&this._pushAutoClosedAction(s,a)}_executeEdit(e,t,n,i=0){if(this.context.cursorConfig.readOnly)return;let r=oy.from(this._model,this);this._cursors.stopTrackingSelections(),this._isHandling=!0;try{this._cursors.ensureValidState(),e()}catch(s){qe(s)}this._isHandling=!1,this._cursors.startTrackingSelections(),this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(t,n,i,r,!1)&&this.revealAll(t,n,!1,0,!0,0)}getAutoClosedCharacters(){return v_.getAllAutoClosedCharacters(this._autoClosedActions)}startComposition(e){this._compositionState=new WO(this._model,this.getSelections())}endComposition(e,t){let n=this._compositionState?this._compositionState.deduceOutcome(this._model,this.getSelections()):null;this._compositionState=null,this._executeEdit(()=>{t==="keyboard"&&this._executeEditOperation(Xs.compositionEndWithInterceptors(this._prevEditOperationType,this.context.cursorConfig,this._model,n,this.getSelections(),this.getAutoClosedCharacters()))},e,t)}type(e,t,n){this._executeEdit(()=>{if(n==="keyboard"){let i=t.length,r=0;for(;r<i;){let s=ff(t,r),a=t.substr(r,s);this._executeEditOperation(Xs.typeWithInterceptors(!!this._compositionState,this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),this.getAutoClosedCharacters(),a)),r+=s}}else this._executeEditOperation(Xs.typeWithoutInterceptors(this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),t))},e,n)}compositionType(e,t,n,i,r,s){if(t.length===0&&n===0&&i===0){if(r!==0){let a=this.getSelections().map(l=>{let d=l.getPosition();return new $e(d.lineNumber,d.column+r,d.lineNumber,d.column+r)});this.setSelections(e,s,a,0)}return}this._executeEdit(()=>{this._executeEditOperation(Xs.compositionType(this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),t,n,i,r))},e,s)}paste(e,t,n,i,r){this._executeEdit(()=>{this._executeEditOperation(Xs.paste(this.context.cursorConfig,this._model,this.getSelections(),t,n,i||[]))},e,r,4)}cut(e,t){this._executeEdit(()=>{this._executeEditOperation($l.cut(this.context.cursorConfig,this._model,this.getSelections()))},e,t)}executeCommand(e,t,n){this._executeEdit(()=>{this._cursors.killSecondaryCursors(),this._executeEditOperation(new jn(0,[t],{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!1}))},e,n)}executeCommands(e,t,n){this._executeEdit(()=>{this._executeEditOperation(new jn(0,t,{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!1}))},e,n)}},oy=class o{constructor(e,t){this.modelVersionId=e;this.cursorState=t}static from(e,t){return new o(e.getVersionId(),t.getCursorStates())}equals(e){if(!e||this.modelVersionId!==e.modelVersionId||this.cursorState.length!==e.cursorState.length)return!1;for(let t=0,n=this.cursorState.length;t<n;t++)if(!this.cursorState[t].equals(e.cursorState[t]))return!1;return!0}},v_=class{static getAllAutoClosedCharacters(e){let t=[];for(let n of e)t=t.concat(n.getAutoClosedCharactersRanges());return t}_model;_autoClosedCharactersDecorations;_autoClosedEnclosingDecorations;constructor(e,t,n){this._model=e,this._autoClosedCharactersDecorations=t,this._autoClosedEnclosingDecorations=n}dispose(){this._autoClosedCharactersDecorations=this._model.deltaDecorations(this._autoClosedCharactersDecorations,[]),this._autoClosedEnclosingDecorations=this._model.deltaDecorations(this._autoClosedEnclosingDecorations,[])}getAutoClosedCharactersRanges(){let e=[];for(let t=0;t<this._autoClosedCharactersDecorations.length;t++){let n=this._model.getDecorationRange(this._autoClosedCharactersDecorations[t]);n&&e.push(n)}return e}isValid(e){let t=[];for(let n=0;n<this._autoClosedEnclosingDecorations.length;n++){let i=this._model.getDecorationRange(this._autoClosedEnclosingDecorations[n]);if(i&&(t.push(i),i.startLineNumber!==i.endLineNumber))return!1}t.sort(P.compareRangesUsingStarts),e.sort(P.compareRangesUsingStarts);for(let n=0;n<e.length;n++)if(n>=t.length||!t[n].strictContainsRange(e[n]))return!1;return!0}},BO=class{static executeCommands(e,t,n){let i={model:e,selectionsBefore:t,trackedRanges:[],trackedRangesDirection:[]},r=this._innerExecuteCommands(i,n);for(let s=0,a=i.trackedRanges.length;s<a;s++)i.model._setTrackedRange(i.trackedRanges[s],null,0);return r}static _innerExecuteCommands(e,t){if(this._arrayIsEmpty(t))return null;let n=this._getEditOperations(e,t);if(n.operations.length===0)return null;let i=n.operations,r=this._getLoserCursorMap(i);if(r.hasOwnProperty("0"))return console.warn("Ignoring commands"),null;let s=[];for(let d=0,c=i.length;d<c;d++)r.hasOwnProperty(i[d].identifier.major.toString())||s.push(i[d]);n.hadTrackedEditOperation&&s.length>0&&(s[0]._isTracked=!0);let a=e.model.pushEditOperations(e.selectionsBefore,s,d=>{let c=[];for(let h=0;h<e.selectionsBefore.length;h++)c[h]=[];for(let h of d)h.identifier&&c[h.identifier.major].push(h);let u=(h,f)=>h.identifier.minor-f.identifier.minor,p=[];for(let h=0;h<e.selectionsBefore.length;h++)c[h].length>0?(c[h].sort(u),p[h]=t[h].computeCursorState(e.model,{getInverseEditOperations:()=>c[h],getTrackedSelection:f=>{let g=parseInt(f,10),b=e.model._getTrackedRange(e.trackedRanges[g]);return e.trackedRangesDirection[g]===0?new $e(b.startLineNumber,b.startColumn,b.endLineNumber,b.endColumn):new $e(b.endLineNumber,b.endColumn,b.startLineNumber,b.startColumn)}})):p[h]=e.selectionsBefore[h];return p});a||(a=e.selectionsBefore);let l=[];for(let d in r)r.hasOwnProperty(d)&&l.push(parseInt(d,10));l.sort((d,c)=>c-d);for(let d of l)a.splice(d,1);return a}static _arrayIsEmpty(e){for(let t=0,n=e.length;t<n;t++)if(e[t])return!1;return!0}static _getEditOperations(e,t){let n=[],i=!1;for(let r=0,s=t.length;r<s;r++){let a=t[r];if(a){let l=this._getEditOperationsFromCommand(e,r,a);n=n.concat(l.operations),i=i||l.hadTrackedEditOperation}}return{operations:n,hadTrackedEditOperation:i}}static _getEditOperationsFromCommand(e,t,n){let i=[],r=0,s=(u,p,h=!1)=>{P.isEmpty(u)&&p===""||i.push({identifier:{major:t,minor:r++},range:u,text:p,forceMoveMarkers:h,isAutoWhitespaceEdit:n.insertsAutoWhitespace})},a=!1,c={addEditOperation:s,addTrackedEditOperation:(u,p,h)=>{a=!0,s(u,p,h)},trackSelection:(u,p)=>{let h=$e.liftSelection(u),f;if(h.isEmpty())if(typeof p=="boolean")p?f=2:f=3;else{let v=e.model.getLineMaxColumn(h.startLineNumber);h.startColumn===v?f=2:f=3}else f=1;let g=e.trackedRanges.length,b=e.model._setTrackedRange(null,h,f);return e.trackedRanges[g]=b,e.trackedRangesDirection[g]=h.getDirection(),g.toString()}};try{n.getEditOperations(e.model,c)}catch(u){return qe(u),{operations:[],hadTrackedEditOperation:!1}}return{operations:i,hadTrackedEditOperation:a}}static _getLoserCursorMap(e){e=e.slice(0),e.sort((n,i)=>-P.compareRangesUsingEnds(n.range,i.range));let t={};for(let n=1;n<e.length;n++){let i=e[n-1],r=e[n];if(P.getStartPosition(i.range).isBefore(P.getEndPosition(r.range))){let s;i.identifier.major>r.identifier.major?s=i.identifier.major:s=r.identifier.major,t[s.toString()]=!0;for(let a=0;a<e.length;a++)e[a].identifier.major===s&&(e.splice(a,1),a<n&&n--,a--);n>0&&n--}}return t}},VO=class{constructor(e,t,n){this.text=e;this.startSelection=t;this.endSelection=n}},WO=class o{_original;static _capture(e,t){let n=[];for(let i of t){if(i.startLineNumber!==i.endLineNumber)return null;n.push(new VO(e.getLineContent(i.startLineNumber),i.startColumn-1,i.endColumn-1))}return n}constructor(e,t){this._original=o._capture(e,t)}deduceOutcome(e,t){if(!this._original)return null;let n=o._capture(e,t);if(!n||this._original.length!==n.length)return null;let i=[];for(let r=0,s=this._original.length;r<s;r++)i.push(o._deduceOutcome(this._original[r],n[r]));return i}static _deduceOutcome(e,t){let n=Math.min(e.startSelection,t.startSelection,mf(e.text,t.text)),i=Math.min(e.text.length-e.endSelection,t.text.length-t.endSelection,gf(e.text,t.text)),r=e.text.substring(n,e.text.length-i),s=t.text.substring(n,t.text.length-i);return new cw(r,e.startSelection-n,e.endSelection-n,s,t.startSelection-n,t.endSelection-n)}};function i5(o,e,t,n,i,r,s){let a="<div>",l=n,d=0,c=!0;for(let u=0,p=e.getCount();u<p;u++){let h=e.getEndOffset(u);if(h<=n)continue;let f="";for(;l<h&&l<i;l++){let g=o.charCodeAt(l);switch(g){case 9:{let b=r-(l+d)%r;for(d+=b-1;b>0;)s&&c?(f+="&#160;",c=!1):(f+=" ",c=!0),b--;break}case 60:f+="&lt;",c=!1;break;case 62:f+="&gt;",c=!1;break;case 38:f+="&amp;",c=!1;break;case 0:f+="&#00;",c=!1;break;case 65279:case 8232:case 8233:case 133:f+="\uFFFD",c=!1;break;case 13:f+="&#8203",c=!1;break;case 32:s&&c?(f+="&#160;",c=!1):(f+=" ",c=!0);break;default:f+=String.fromCharCode(g),c=!1}}if(a+=`<span style="${e.getInlineStyle(u,t)}">${f}</span>`,h>i||l>=i)break}return a+="</div>",a}var HO=class{_hasPending;_inserts;_changes;_removes;constructor(){this._hasPending=!1,this._inserts=[],this._changes=[],this._removes=[]}insert(e){this._hasPending=!0,this._inserts.push(e)}change(e){this._hasPending=!0,this._changes.push(e)}remove(e){this._hasPending=!0,this._removes.push(e)}mustCommit(){return this._hasPending}commit(e){if(!this._hasPending)return;let t=this._inserts,n=this._changes,i=this._removes;this._hasPending=!1,this._inserts=[],this._changes=[],this._removes=[],e._commitPendingChanges(t,n,i)}},UO=class{id;afterLineNumber;ordinal;height;minWidth;prefixSum;constructor(e,t,n,i,r){this.id=e,this.afterLineNumber=t,this.ordinal=n,this.height=i,this.minWidth=r,this.prefixSum=0}},y_=class o{static INSTANCE_COUNT=0;_instanceId;_pendingChanges;_lastWhitespaceId;_arr;_prefixSumValidIndex;_minWidth;_lineCount;_lineHeight;_paddingTop;_paddingBottom;constructor(e,t,n,i){this._instanceId=uI(++o.INSTANCE_COUNT),this._pendingChanges=new HO,this._lastWhitespaceId=0,this._arr=[],this._prefixSumValidIndex=-1,this._minWidth=-1,this._lineCount=e,this._lineHeight=t,this._paddingTop=n,this._paddingBottom=i}static findInsertionIndex(e,t,n){let i=0,r=e.length;for(;i<r;){let s=i+r>>>1;t===e[s].afterLineNumber?n<e[s].ordinal?r=s:i=s+1:t<e[s].afterLineNumber?r=s:i=s+1}return i}setLineHeight(e){this._checkPendingChanges(),this._lineHeight=e}setPadding(e,t){this._paddingTop=e,this._paddingBottom=t}onFlushed(e){this._checkPendingChanges(),this._lineCount=e}changeWhitespace(e){let t=!1;try{e({insertWhitespace:(i,r,s,a)=>{t=!0,i=i|0,r=r|0,s=s|0,a=a|0;let l=this._instanceId+ ++this._lastWhitespaceId;return this._pendingChanges.insert(new UO(l,i,r,s,a)),l},changeOneWhitespace:(i,r,s)=>{t=!0,r=r|0,s=s|0,this._pendingChanges.change({id:i,newAfterLineNumber:r,newHeight:s})},removeWhitespace:i=>{t=!0,this._pendingChanges.remove({id:i})}})}finally{this._pendingChanges.commit(this)}return t}_commitPendingChanges(e,t,n){if((e.length>0||n.length>0)&&(this._minWidth=-1),e.length+t.length+n.length<=1){for(let l of e)this._insertWhitespace(l);for(let l of t)this._changeOneWhitespace(l.id,l.newAfterLineNumber,l.newHeight);for(let l of n){let d=this._findWhitespaceIndex(l.id);d!==-1&&this._removeWhitespace(d)}return}let i=new Set;for(let l of n)i.add(l.id);let r=new Map;for(let l of t)r.set(l.id,l);let s=l=>{let d=[];for(let c of l)if(!i.has(c.id)){if(r.has(c.id)){let u=r.get(c.id);c.afterLineNumber=u.newAfterLineNumber,c.height=u.newHeight}d.push(c)}return d},a=s(this._arr).concat(s(e));a.sort((l,d)=>l.afterLineNumber===d.afterLineNumber?l.ordinal-d.ordinal:l.afterLineNumber-d.afterLineNumber),this._arr=a,this._prefixSumValidIndex=-1}_checkPendingChanges(){this._pendingChanges.mustCommit()&&this._pendingChanges.commit(this)}_insertWhitespace(e){let t=o.findInsertionIndex(this._arr,e.afterLineNumber,e.ordinal);this._arr.splice(t,0,e),this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,t-1)}_findWhitespaceIndex(e){let t=this._arr;for(let n=0,i=t.length;n<i;n++)if(t[n].id===e)return n;return-1}_changeOneWhitespace(e,t,n){let i=this._findWhitespaceIndex(e);if(i!==-1&&(this._arr[i].height!==n&&(this._arr[i].height=n,this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,i-1)),this._arr[i].afterLineNumber!==t)){let r=this._arr[i];this._removeWhitespace(i),r.afterLineNumber=t,this._insertWhitespace(r)}}_removeWhitespace(e){this._arr.splice(e,1),this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,e-1)}onLinesDeleted(e,t){this._checkPendingChanges(),e=e|0,t=t|0,this._lineCount-=t-e+1;for(let n=0,i=this._arr.length;n<i;n++){let r=this._arr[n].afterLineNumber;e<=r&&r<=t?this._arr[n].afterLineNumber=e-1:r>t&&(this._arr[n].afterLineNumber-=t-e+1)}}onLinesInserted(e,t){this._checkPendingChanges(),e=e|0,t=t|0,this._lineCount+=t-e+1;for(let n=0,i=this._arr.length;n<i;n++){let r=this._arr[n].afterLineNumber;e<=r&&(this._arr[n].afterLineNumber+=t-e+1)}}getWhitespacesTotalHeight(){return this._checkPendingChanges(),this._arr.length===0?0:this.getWhitespacesAccumulatedHeight(this._arr.length-1)}getWhitespacesAccumulatedHeight(e){this._checkPendingChanges(),e=e|0;let t=Math.max(0,this._prefixSumValidIndex+1);t===0&&(this._arr[0].prefixSum=this._arr[0].height,t++);for(let n=t;n<=e;n++)this._arr[n].prefixSum=this._arr[n-1].prefixSum+this._arr[n].height;return this._prefixSumValidIndex=Math.max(this._prefixSumValidIndex,e),this._arr[e].prefixSum}getLinesTotalHeight(){this._checkPendingChanges();let e=this._lineHeight*this._lineCount,t=this.getWhitespacesTotalHeight();return e+t+this._paddingTop+this._paddingBottom}getWhitespaceAccumulatedHeightBeforeLineNumber(e){this._checkPendingChanges(),e=e|0;let t=this._findLastWhitespaceBeforeLineNumber(e);return t===-1?0:this.getWhitespacesAccumulatedHeight(t)}_findLastWhitespaceBeforeLineNumber(e){e=e|0;let t=this._arr,n=0,i=t.length-1;for(;n<=i;){let s=(i-n|0)/2|0,a=n+s|0;if(t[a].afterLineNumber<e){if(a+1>=t.length||t[a+1].afterLineNumber>=e)return a;n=a+1|0}else i=a-1|0}return-1}_findFirstWhitespaceAfterLineNumber(e){e=e|0;let n=this._findLastWhitespaceBeforeLineNumber(e)+1;return n<this._arr.length?n:-1}getFirstWhitespaceIndexAfterLineNumber(e){return this._checkPendingChanges(),e=e|0,this._findFirstWhitespaceAfterLineNumber(e)}getVerticalOffsetForLineNumber(e,t=!1){this._checkPendingChanges(),e=e|0;let n;e>1?n=this._lineHeight*(e-1):n=0;let i=this.getWhitespaceAccumulatedHeightBeforeLineNumber(e-(t?1:0));return n+i+this._paddingTop}getVerticalOffsetAfterLineNumber(e,t=!1){this._checkPendingChanges(),e=e|0;let n=this._lineHeight*e,i=this.getWhitespaceAccumulatedHeightBeforeLineNumber(e+(t?1:0));return n+i+this._paddingTop}hasWhitespace(){return this._checkPendingChanges(),this.getWhitespacesCount()>0}getWhitespaceMinWidth(){if(this._checkPendingChanges(),this._minWidth===-1){let e=0;for(let t=0,n=this._arr.length;t<n;t++)e=Math.max(e,this._arr[t].minWidth);this._minWidth=e}return this._minWidth}isAfterLines(e){this._checkPendingChanges();let t=this.getLinesTotalHeight();return e>t}isInTopPadding(e){return this._paddingTop===0?!1:(this._checkPendingChanges(),e<this._paddingTop)}isInBottomPadding(e){if(this._paddingBottom===0)return!1;this._checkPendingChanges();let t=this.getLinesTotalHeight();return e>=t-this._paddingBottom}getLineNumberAtOrAfterVerticalOffset(e){if(this._checkPendingChanges(),e=e|0,e<0)return 1;let t=this._lineCount|0,n=this._lineHeight,i=1,r=t;for(;i<r;){let s=(i+r)/2|0,a=this.getVerticalOffsetForLineNumber(s)|0;if(e>=a+n)i=s+1;else{if(e>=a)return s;r=s}}return i>t?t:i}getLinesViewportData(e,t){this._checkPendingChanges(),e=e|0,t=t|0;let n=this._lineHeight,i=this.getLineNumberAtOrAfterVerticalOffset(e)|0,r=this.getVerticalOffsetForLineNumber(i)|0,s=this._lineCount|0,a=this.getFirstWhitespaceIndexAfterLineNumber(i)|0,l=this.getWhitespacesCount()|0,d,c;a===-1?(a=l,c=s+1,d=0):(c=this.getAfterLineNumberForWhitespaceIndex(a)|0,d=this.getHeightForWhitespaceIndex(a)|0);let u=r,p=u,h=5e5,f=0;r>=h&&(f=Math.floor(r/h)*h,f=Math.floor(f/n)*n,p-=f);let g=[],b=e+(t-e)/2,v=-1;for(let C=i;C<=s;C++){if(v===-1){let w=u,_=u+n;(w<=b&&b<_||w>b)&&(v=C)}for(u+=n,g[C-i]=p,p+=n;c===C;)p+=d,u+=d,a++,a>=l?c=s+1:(c=this.getAfterLineNumberForWhitespaceIndex(a)|0,d=this.getHeightForWhitespaceIndex(a)|0);if(u>=t){s=C;break}}v===-1&&(v=s);let y=this.getVerticalOffsetForLineNumber(s)|0,S=i,E=s;return S<E&&r<e&&S++,S<E&&y+n>t&&E--,{bigNumbersDelta:f,startLineNumber:i,endLineNumber:s,relativeVerticalOffset:g,centeredLineNumber:v,completelyVisibleStartLineNumber:S,completelyVisibleEndLineNumber:E,lineHeight:this._lineHeight}}getVerticalOffsetForWhitespaceIndex(e){this._checkPendingChanges(),e=e|0;let t=this.getAfterLineNumberForWhitespaceIndex(e),n;t>=1?n=this._lineHeight*t:n=0;let i;return e>0?i=this.getWhitespacesAccumulatedHeight(e-1):i=0,n+i+this._paddingTop}getWhitespaceIndexAtOrAfterVerticallOffset(e){this._checkPendingChanges(),e=e|0;let t=0,n=this.getWhitespacesCount()-1;if(n<0)return-1;let i=this.getVerticalOffsetForWhitespaceIndex(n),r=this.getHeightForWhitespaceIndex(n);if(e>=i+r)return-1;for(;t<n;){let s=Math.floor((t+n)/2),a=this.getVerticalOffsetForWhitespaceIndex(s),l=this.getHeightForWhitespaceIndex(s);if(e>=a+l)t=s+1;else{if(e>=a)return s;n=s}}return t}getWhitespaceAtVerticalOffset(e){this._checkPendingChanges(),e=e|0;let t=this.getWhitespaceIndexAtOrAfterVerticallOffset(e);if(t<0||t>=this.getWhitespacesCount())return null;let n=this.getVerticalOffsetForWhitespaceIndex(t);if(n>e)return null;let i=this.getHeightForWhitespaceIndex(t),r=this.getIdForWhitespaceIndex(t),s=this.getAfterLineNumberForWhitespaceIndex(t);return{id:r,afterLineNumber:s,verticalOffset:n,height:i}}getWhitespaceViewportData(e,t){this._checkPendingChanges(),e=e|0,t=t|0;let n=this.getWhitespaceIndexAtOrAfterVerticallOffset(e),i=this.getWhitespacesCount()-1;if(n<0)return[];let r=[];for(let s=n;s<=i;s++){let a=this.getVerticalOffsetForWhitespaceIndex(s),l=this.getHeightForWhitespaceIndex(s);if(a>=t)break;r.push({id:this.getIdForWhitespaceIndex(s),afterLineNumber:this.getAfterLineNumberForWhitespaceIndex(s),verticalOffset:a,height:l})}return r}getWhitespaces(){return this._checkPendingChanges(),this._arr.slice(0)}getWhitespacesCount(){return this._checkPendingChanges(),this._arr.length}getIdForWhitespaceIndex(e){return this._checkPendingChanges(),e=e|0,this._arr[e].id}getAfterLineNumberForWhitespaceIndex(e){return this._checkPendingChanges(),e=e|0,this._arr[e].afterLineNumber}getHeightForWhitespaceIndex(e){return this._checkPendingChanges(),e=e|0,this._arr[e].height}};var jj=125,yp=class{width;contentWidth;scrollWidth;height;contentHeight;scrollHeight;constructor(e,t,n,i){e=e|0,t=t|0,n=n|0,i=i|0,e<0&&(e=0),t<0&&(t=0),n<0&&(n=0),i<0&&(i=0),this.width=e,this.contentWidth=t,this.scrollWidth=Math.max(e,t),this.height=n,this.contentHeight=i,this.scrollHeight=Math.max(n,i)}equals(e){return this.width===e.width&&this.contentWidth===e.contentWidth&&this.height===e.height&&this.contentHeight===e.contentHeight}},zO=class extends F{_scrollable;_dimensions;onDidScroll;_onDidContentSizeChange=this._register(new D);onDidContentSizeChange=this._onDidContentSizeChange.event;constructor(e,t){super(),this._dimensions=new yp(0,0,0,0),this._scrollable=this._register(new xs({forceIntegerValues:!0,smoothScrollDuration:e,scheduleAtNextAnimationFrame:t})),this.onDidScroll=this._scrollable.onScroll}getScrollable(){return this._scrollable}setSmoothScrollDuration(e){this._scrollable.setSmoothScrollDuration(e)}validateScrollPosition(e){return this._scrollable.validateScrollPosition(e)}getScrollDimensions(){return this._dimensions}setScrollDimensions(e){if(this._dimensions.equals(e))return;let t=this._dimensions;this._dimensions=e,this._scrollable.setScrollDimensions({width:e.width,scrollWidth:e.scrollWidth,height:e.height,scrollHeight:e.scrollHeight},!0);let n=t.contentWidth!==e.contentWidth,i=t.contentHeight!==e.contentHeight;(n||i)&&this._onDidContentSizeChange.fire(new o_(t.contentWidth,t.contentHeight,e.contentWidth,e.contentHeight))}getFutureScrollPosition(){return this._scrollable.getFutureScrollPosition()}getCurrentScrollPosition(){return this._scrollable.getCurrentScrollPosition()}setScrollPositionNow(e){this._scrollable.setScrollPositionNow(e)}setScrollPositionSmooth(e){this._scrollable.setScrollPositionSmooth(e)}hasPendingScrollAnimation(){return this._scrollable.hasPendingScrollAnimation()}},I_=class extends F{_configuration;_linesLayout;_maxLineWidth;_overlayWidgetsMinWidth;_scrollable;onDidScroll;onDidContentSizeChange;constructor(e,t,n){super(),this._configuration=e;let i=this._configuration.options,r=i.get(147),s=i.get(85);this._linesLayout=new y_(t,i.get(68),s.top,s.bottom),this._maxLineWidth=0,this._overlayWidgetsMinWidth=0,this._scrollable=this._register(new zO(0,n)),this._configureSmoothScrollDuration(),this._scrollable.setScrollDimensions(new yp(r.contentWidth,0,r.height,0)),this.onDidScroll=this._scrollable.onDidScroll,this.onDidContentSizeChange=this._scrollable.onDidContentSizeChange,this._updateHeight()}dispose(){super.dispose()}getScrollable(){return this._scrollable.getScrollable()}onHeightMaybeChanged(){this._updateHeight()}_configureSmoothScrollDuration(){this._scrollable.setSmoothScrollDuration(this._configuration.options.get(116)?jj:0)}onConfigurationChanged(e){let t=this._configuration.options;if(e.hasChanged(68)&&this._linesLayout.setLineHeight(t.get(68)),e.hasChanged(85)){let n=t.get(85);this._linesLayout.setPadding(n.top,n.bottom)}if(e.hasChanged(147)){let n=t.get(147),i=n.contentWidth,r=n.height,s=this._scrollable.getScrollDimensions(),a=s.contentWidth;this._scrollable.setScrollDimensions(new yp(i,s.contentWidth,r,this._getContentHeight(i,r,a)))}else this._updateHeight();e.hasChanged(116)&&this._configureSmoothScrollDuration()}onFlushed(e){this._linesLayout.onFlushed(e)}onLinesDeleted(e,t){this._linesLayout.onLinesDeleted(e,t)}onLinesInserted(e,t){this._linesLayout.onLinesInserted(e,t)}_getHorizontalScrollbarHeight(e,t){let i=this._configuration.options.get(105);return i.horizontal===2||e>=t?0:i.horizontalScrollbarSize}_getContentHeight(e,t,n){let i=this._configuration.options,r=this._linesLayout.getLinesTotalHeight();return i.get(107)?r+=Math.max(0,t-i.get(68)-i.get(85).bottom):i.get(105).ignoreHorizontalScrollbarInContentHeight||(r+=this._getHorizontalScrollbarHeight(e,n)),r}_updateHeight(){let e=this._scrollable.getScrollDimensions(),t=e.width,n=e.height,i=e.contentWidth;this._scrollable.setScrollDimensions(new yp(t,e.contentWidth,n,this._getContentHeight(t,n,i)))}getCurrentViewport(){let e=this._scrollable.getScrollDimensions(),t=this._scrollable.getCurrentScrollPosition();return new Bb(t.scrollTop,t.scrollLeft,e.width,e.height)}getFutureViewport(){let e=this._scrollable.getScrollDimensions(),t=this._scrollable.getFutureScrollPosition();return new Bb(t.scrollTop,t.scrollLeft,e.width,e.height)}_computeContentWidth(){let e=this._configuration.options,t=this._maxLineWidth,n=e.get(148),i=e.get(51),r=e.get(147);if(n.isViewportWrapping){let s=e.get(74);return t>r.contentWidth+i.typicalHalfwidthCharacterWidth&&s.enabled&&s.side==="right"?t+r.verticalScrollbarWidth:t}else{let s=e.get(106)*i.typicalHalfwidthCharacterWidth,a=this._linesLayout.getWhitespaceMinWidth();return Math.max(t+s+r.verticalScrollbarWidth,a,this._overlayWidgetsMinWidth)}}setMaxLineWidth(e){this._maxLineWidth=e,this._updateContentWidth()}setOverlayWidgetsMinWidth(e){this._overlayWidgetsMinWidth=e,this._updateContentWidth()}_updateContentWidth(){let e=this._scrollable.getScrollDimensions();this._scrollable.setScrollDimensions(new yp(e.width,this._computeContentWidth(),e.height,e.contentHeight)),this._updateHeight()}saveState(){let e=this._scrollable.getFutureScrollPosition(),t=e.scrollTop,n=this._linesLayout.getLineNumberAtOrAfterVerticalOffset(t),i=this._linesLayout.getWhitespaceAccumulatedHeightBeforeLineNumber(n);return{scrollTop:t,scrollTopWithoutViewZones:t-i,scrollLeft:e.scrollLeft}}changeWhitespace(e){let t=this._linesLayout.changeWhitespace(e);return t&&this.onHeightMaybeChanged(),t}getVerticalOffsetForLineNumber(e,t=!1){return this._linesLayout.getVerticalOffsetForLineNumber(e,t)}getVerticalOffsetAfterLineNumber(e,t=!1){return this._linesLayout.getVerticalOffsetAfterLineNumber(e,t)}isAfterLines(e){return this._linesLayout.isAfterLines(e)}isInTopPadding(e){return this._linesLayout.isInTopPadding(e)}isInBottomPadding(e){return this._linesLayout.isInBottomPadding(e)}getLineNumberAtVerticalOffset(e){return this._linesLayout.getLineNumberAtOrAfterVerticalOffset(e)}getWhitespaceAtVerticalOffset(e){return this._linesLayout.getWhitespaceAtVerticalOffset(e)}getLinesViewportData(){let e=this.getCurrentViewport();return this._linesLayout.getLinesViewportData(e.top,e.top+e.height)}getLinesViewportDataAtScrollTop(e){let t=this._scrollable.getScrollDimensions();return e+t.height>t.scrollHeight&&(e=t.scrollHeight-t.height),e<0&&(e=0),this._linesLayout.getLinesViewportData(e,e+t.height)}getWhitespaceViewportData(){let e=this.getCurrentViewport();return this._linesLayout.getWhitespaceViewportData(e.top,e.top+e.height)}getWhitespaces(){return this._linesLayout.getWhitespaces()}getContentWidth(){return this._scrollable.getScrollDimensions().contentWidth}getScrollWidth(){return this._scrollable.getScrollDimensions().scrollWidth}getContentHeight(){return this._scrollable.getScrollDimensions().contentHeight}getScrollHeight(){return this._scrollable.getScrollDimensions().scrollHeight}getCurrentScrollLeft(){return this._scrollable.getCurrentScrollPosition().scrollLeft}getCurrentScrollTop(){return this._scrollable.getCurrentScrollPosition().scrollTop}validateScrollPosition(e){return this._scrollable.validateScrollPosition(e)}setScrollPosition(e,t){t===1?this._scrollable.setScrollPositionNow(e):this._scrollable.setScrollPositionSmooth(e)}hasPendingScrollAnimation(){return this._scrollable.hasPendingScrollAnimation()}deltaScrollNow(e,t){let n=this._scrollable.getCurrentScrollPosition();this._scrollable.setScrollPositionNow({scrollLeft:n.scrollLeft+e,scrollTop:n.scrollTop+t})}};function E_(o,e){return o===null?e?C_.INSTANCE:S_.INSTANCE:new GO(o,e)}var GO=class{_projectionData;_isVisible;constructor(e,t){this._projectionData=e,this._isVisible=t}isVisible(){return this._isVisible}setVisible(e){return this._isVisible=e,this}getProjectionData(){return this._projectionData}getViewLineCount(){return this._isVisible?this._projectionData.getOutputLineCount():0}getViewLineContent(e,t,n){this._assertVisible();let i=n>0?this._projectionData.breakOffsets[n-1]:0,r=this._projectionData.breakOffsets[n],s;if(this._projectionData.injectionOffsets!==null){let a=this._projectionData.injectionOffsets.map((d,c)=>new Fo(0,0,d+1,this._projectionData.injectionOptions[c],0));s=Fo.applyInjectedText(e.getLineContent(t),a).substring(i,r)}else s=e.getValueInRange({startLineNumber:t,startColumn:i+1,endLineNumber:t,endColumn:r+1});return n>0&&(s=o5(this._projectionData.wrappedTextIndentLength)+s),s}getViewLineLength(e,t,n){return this._assertVisible(),this._projectionData.getLineLength(n)}getViewLineMinColumn(e,t,n){return this._assertVisible(),this._projectionData.getMinOutputOffset(n)+1}getViewLineMaxColumn(e,t,n){return this._assertVisible(),this._projectionData.getMaxOutputOffset(n)+1}getViewLineData(e,t,n){let i=new Array;return this.getViewLinesData(e,t,n,1,0,[!0],i),i[0]}getViewLinesData(e,t,n,i,r,s,a){this._assertVisible();let l=this._projectionData,d=l.injectionOffsets,c=l.injectionOptions,u=null;if(d){u=[];let h=0,f=0;for(let g=0;g<l.getOutputLineCount();g++){let b=new Array;u[g]=b;let v=g>0?l.breakOffsets[g-1]:0,y=l.breakOffsets[g];for(;f<d.length;){let S=c[f].content.length,E=d[f]+h,C=E+S;if(E>y)break;if(v<C){let w=c[f];if(w.inlineClassName){let _=g>0?l.wrappedTextIndentLength:0,L=_+Math.max(E-v,0),k=_+Math.min(C-v,y-v);L!==k&&b.push(new tE(L,k,w.inlineClassName,w.inlineClassNameAffectsLetterSpacing))}}if(C<=y)h+=S,f++;else break}}}let p;if(d){let h=[];for(let f=0;f<d.length;f++){let g=d[f],b=c[f].tokens;b?b.forEach((v,y)=>{h.push({offset:g,text:v.substring(c[f].content),tokenMetadata:y.metadata})}):h.push({offset:g,text:c[f].content,tokenMetadata:Sn.defaultTokenMetadata})}p=e.tokenization.getLineTokens(t).withInserted(h)}else p=e.tokenization.getLineTokens(t);for(let h=n;h<n+i;h++){let f=r+h-n;if(!s[f]){a[f]=null;continue}a[f]=this._getViewLineData(p,u?u[h]:null,h)}}_getViewLineData(e,t,n){this._assertVisible();let i=this._projectionData,r=n>0?i.wrappedTextIndentLength:0,s=n>0?i.breakOffsets[n-1]:0,a=i.breakOffsets[n],l=e.sliceAndInflate(s,a,r),d=l.getLineContent();n>0&&(d=o5(i.wrappedTextIndentLength)+d);let c=this._projectionData.getMinOutputOffset(n)+1,u=d.length+1,p=n+1<this.getViewLineCount(),h=n===0?0:i.breakOffsetsVisibleColumn[n-1];return new Nu(d,p,c,u,h,l,t)}getModelColumnOfViewPosition(e,t){return this._assertVisible(),this._projectionData.translateToInputOffset(e,t-1)+1}getViewPositionOfModelPosition(e,t,n=2){return this._assertVisible(),this._projectionData.translateToOutputPosition(t-1,n).toPosition(e)}getViewLineNumberOfModelPosition(e,t){this._assertVisible();let n=this._projectionData.translateToOutputPosition(t-1);return e+n.outputLineIndex}normalizePosition(e,t,n){let i=t.lineNumber-e;return this._projectionData.normalizeOutputPosition(e,t.column-1,n).toPosition(i)}getInjectedTextAt(e,t){return this._projectionData.getInjectedText(e,t-1)}_assertVisible(){if(!this._isVisible)throw new Error("Not supported")}},C_=class o{static INSTANCE=new o;constructor(){}isVisible(){return!0}setVisible(e){return e?this:S_.INSTANCE}getProjectionData(){return null}getViewLineCount(){return 1}getViewLineContent(e,t,n){return e.getLineContent(t)}getViewLineLength(e,t,n){return e.getLineLength(t)}getViewLineMinColumn(e,t,n){return e.getLineMinColumn(t)}getViewLineMaxColumn(e,t,n){return e.getLineMaxColumn(t)}getViewLineData(e,t,n){let i=e.tokenization.getLineTokens(t),r=i.getLineContent();return new Nu(r,!1,1,r.length+1,0,i.inflate(),null)}getViewLinesData(e,t,n,i,r,s,a){if(!s[r]){a[r]=null;return}a[r]=this.getViewLineData(e,t,0)}getModelColumnOfViewPosition(e,t){return t}getViewPositionOfModelPosition(e,t){return new A(e,t)}getViewLineNumberOfModelPosition(e,t){return e}normalizePosition(e,t,n){return t}getInjectedTextAt(e,t){return null}},S_=class o{static INSTANCE=new o;constructor(){}isVisible(){return!1}setVisible(e){return e?C_.INSTANCE:this}getProjectionData(){return null}getViewLineCount(){return 0}getViewLineContent(e,t,n){throw new Error("Not supported")}getViewLineLength(e,t,n){throw new Error("Not supported")}getViewLineMinColumn(e,t,n){throw new Error("Not supported")}getViewLineMaxColumn(e,t,n){throw new Error("Not supported")}getViewLineData(e,t,n){throw new Error("Not supported")}getViewLinesData(e,t,n,i,r,s,a){throw new Error("Not supported")}getModelColumnOfViewPosition(e,t){throw new Error("Not supported")}getViewPositionOfModelPosition(e,t){throw new Error("Not supported")}getViewLineNumberOfModelPosition(e,t){throw new Error("Not supported")}normalizePosition(e,t,n){throw new Error("Not supported")}getInjectedTextAt(e,t){throw new Error("Not supported")}},KO=[""];function o5(o){if(o>=KO.length)for(let e=1;e<=o;e++)KO[e]=qj(e);return KO[o]}function qj(o){return new Array(o+1).join(" ")}var T_=class{_values;_isValid;_validEndIndex;_prefixSum;_indexBySum;constructor(e){this._values=e,this._isValid=!1,this._validEndIndex=-1,this._prefixSum=[],this._indexBySum=[]}getTotalSum(){return this._ensureValid(),this._indexBySum.length}getPrefixSum(e){return this._ensureValid(),e===0?0:this._prefixSum[e-1]}getIndexOf(e){this._ensureValid();let t=this._indexBySum[e],n=t>0?this._prefixSum[t-1]:0;return new jO(t,e-n)}removeValues(e,t){this._values.splice(e,t),this._invalidate(e)}insertValues(e,t){this._values=sa(this._values,e,t),this._invalidate(e)}_invalidate(e){this._isValid=!1,this._validEndIndex=Math.min(this._validEndIndex,e-1)}_ensureValid(){if(!this._isValid){for(let e=this._validEndIndex+1,t=this._values.length;e<t;e++){let n=this._values[e],i=e>0?this._prefixSum[e-1]:0;this._prefixSum[e]=i+n;for(let r=0;r<n;r++)this._indexBySum[i+r]=e}this._prefixSum.length=this._values.length,this._indexBySum.length=this._prefixSum[this._prefixSum.length-1],this._isValid=!0,this._validEndIndex=this._values.length-1}}setValue(e,t){this._values[e]!==t&&(this._values[e]=t,this._invalidate(e))}},jO=class{constructor(e,t){this.index=e;this.remainder=t;this.index=e,this.remainder=t}_prefixSumIndexOfResultBrand=void 0};var x_=class{_editorId;model;_validModelVersionId;_domLineBreaksComputerFactory;_monospaceLineBreaksComputerFactory;fontInfo;tabSize;wrappingColumn;wrappingIndent;wordBreak;wrappingStrategy;modelLineProjections;projectedModelLineLineCounts;hiddenAreasDecorationIds;constructor(e,t,n,i,r,s,a,l,d,c){this._editorId=e,this.model=t,this._validModelVersionId=-1,this._domLineBreaksComputerFactory=n,this._monospaceLineBreaksComputerFactory=i,this.fontInfo=r,this.tabSize=s,this.wrappingStrategy=a,this.wrappingColumn=l,this.wrappingIndent=d,this.wordBreak=c,this._constructLines(!0,null)}dispose(){this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,[])}createCoordinatesConverter(){return new qO(this)}_constructLines(e,t){this.modelLineProjections=[],e&&(this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,[]));let n=this.model.getLinesContent(),i=this.model.getInjectedTextDecorations(this._editorId),r=n.length,s=this.createLineBreaksComputer(),a=new Wi(Fo.fromDecorations(i));for(let g=0;g<r;g++){let b=a.takeWhile(v=>v.lineNumber===g+1);s.addRequest(n[g],b,t?t[g]:null)}let l=s.finalize(),d=[],c=this.hiddenAreasDecorationIds.map(g=>this.model.getDecorationRange(g)).sort(P.compareRangesUsingStarts),u=1,p=0,h=-1,f=h+1<c.length?p+1:r+2;for(let g=0;g<r;g++){let b=g+1;b===f&&(h++,u=c[h].startLineNumber,p=c[h].endLineNumber,f=h+1<c.length?p+1:r+2);let v=b>=u&&b<=p,y=E_(l[g],!v);d[g]=y.getViewLineCount(),this.modelLineProjections[g]=y}this._validModelVersionId=this.model.getVersionId(),this.projectedModelLineLineCounts=new T_(d)}getHiddenAreas(){return this.hiddenAreasDecorationIds.map(e=>this.model.getDecorationRange(e))}setHiddenAreas(e){let t=e.map(p=>this.model.validateRange(p)),n=$j(t),i=this.hiddenAreasDecorationIds.map(p=>this.model.getDecorationRange(p)).sort(P.compareRangesUsingStarts);if(n.length===i.length){let p=!1;for(let h=0;h<n.length;h++)if(!n[h].equalsRange(i[h])){p=!0;break}if(!p)return!1}let r=n.map(p=>({range:p,options:En.EMPTY}));this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,r);let s=n,a=1,l=0,d=-1,c=d+1<s.length?l+1:this.modelLineProjections.length+2,u=!1;for(let p=0;p<this.modelLineProjections.length;p++){let h=p+1;h===c&&(d++,a=s[d].startLineNumber,l=s[d].endLineNumber,c=d+1<s.length?l+1:this.modelLineProjections.length+2);let f=!1;if(h>=a&&h<=l?this.modelLineProjections[p].isVisible()&&(this.modelLineProjections[p]=this.modelLineProjections[p].setVisible(!1),f=!0):(u=!0,this.modelLineProjections[p].isVisible()||(this.modelLineProjections[p]=this.modelLineProjections[p].setVisible(!0),f=!0)),f){let g=this.modelLineProjections[p].getViewLineCount();this.projectedModelLineLineCounts.setValue(p,g)}}return u||this.setHiddenAreas([]),!0}modelPositionIsVisible(e,t){return e<1||e>this.modelLineProjections.length?!1:this.modelLineProjections[e-1].isVisible()}getModelLineViewLineCount(e){return e<1||e>this.modelLineProjections.length?1:this.modelLineProjections[e-1].getViewLineCount()}setTabSize(e){return this.tabSize===e?!1:(this.tabSize=e,this._constructLines(!1,null),!0)}setWrappingSettings(e,t,n,i,r){let s=this.fontInfo.equals(e),a=this.wrappingStrategy===t,l=this.wrappingColumn===n,d=this.wrappingIndent===i,c=this.wordBreak===r;if(s&&a&&l&&d&&c)return!1;let u=s&&a&&!l&&d&&c;this.fontInfo=e,this.wrappingStrategy=t,this.wrappingColumn=n,this.wrappingIndent=i,this.wordBreak=r;let p=null;if(u){p=[];for(let h=0,f=this.modelLineProjections.length;h<f;h++)p[h]=this.modelLineProjections[h].getProjectionData()}return this._constructLines(!1,p),!0}createLineBreaksComputer(){return(this.wrappingStrategy==="advanced"?this._domLineBreaksComputerFactory:this._monospaceLineBreaksComputerFactory).createLineBreaksComputer(this.fontInfo,this.tabSize,this.wrappingColumn,this.wrappingIndent,this.wordBreak)}onModelFlushed(){this._constructLines(!0,null)}onModelLinesDeleted(e,t,n){if(!e||e<=this._validModelVersionId)return null;let i=t===1?1:this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,r=this.projectedModelLineLineCounts.getPrefixSum(n);return this.modelLineProjections.splice(t-1,n-t+1),this.projectedModelLineLineCounts.removeValues(t-1,n-t+1),new im(i,r)}onModelLinesInserted(e,t,n,i){if(!e||e<=this._validModelVersionId)return null;let r=t>2&&!this.modelLineProjections[t-2].isVisible(),s=t===1?1:this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,a=0,l=[],d=[];for(let c=0,u=i.length;c<u;c++){let p=E_(i[c],!r);l.push(p);let h=p.getViewLineCount();a+=h,d[c]=h}return this.modelLineProjections=this.modelLineProjections.slice(0,t-1).concat(l).concat(this.modelLineProjections.slice(t-1)),this.projectedModelLineLineCounts.insertValues(t-1,d),new om(s,s+a-1)}onModelLineChanged(e,t,n){if(e!==null&&e<=this._validModelVersionId)return[!1,null,null,null];let i=t-1,r=this.modelLineProjections[i].getViewLineCount(),s=this.modelLineProjections[i].isVisible(),a=E_(n,s);this.modelLineProjections[i]=a;let l=this.modelLineProjections[i].getViewLineCount(),d=!1,c=0,u=-1,p=0,h=-1,f=0,g=-1;r>l?(c=this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,u=c+l-1,f=u+1,g=f+(r-l)-1,d=!0):r<l?(c=this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,u=c+r-1,p=u+1,h=p+(l-r)-1,d=!0):(c=this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,u=c+l-1),this.projectedModelLineLineCounts.setValue(i,l);let b=c<=u?new Fb(c,u-c+1):null,v=p<=h?new om(p,h):null,y=f<=g?new im(f,g):null;return[d,b,v,y]}acceptVersionId(e){this._validModelVersionId=e,this.modelLineProjections.length===1&&!this.modelLineProjections[0].isVisible()&&this.setHiddenAreas([])}getViewLineCount(){return this.projectedModelLineLineCounts.getTotalSum()}_toValidViewLineNumber(e){if(e<1)return 1;let t=this.getViewLineCount();return e>t?t:e|0}getActiveIndentGuide(e,t,n){e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t),n=this._toValidViewLineNumber(n);let i=this.convertViewPositionToModelPosition(e,this.getViewLineMinColumn(e)),r=this.convertViewPositionToModelPosition(t,this.getViewLineMinColumn(t)),s=this.convertViewPositionToModelPosition(n,this.getViewLineMinColumn(n)),a=this.model.guides.getActiveIndentGuide(i.lineNumber,r.lineNumber,s.lineNumber),l=this.convertModelPositionToViewPosition(a.startLineNumber,1),d=this.convertModelPositionToViewPosition(a.endLineNumber,this.model.getLineMaxColumn(a.endLineNumber));return{startLineNumber:l.lineNumber,endLineNumber:d.lineNumber,indent:a.indent}}getViewLineInfo(e){e=this._toValidViewLineNumber(e);let t=this.projectedModelLineLineCounts.getIndexOf(e-1),n=t.index,i=t.remainder;return new w_(n+1,i)}getMinColumnOfViewLine(e){return this.modelLineProjections[e.modelLineNumber-1].getViewLineMinColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx)}getMaxColumnOfViewLine(e){return this.modelLineProjections[e.modelLineNumber-1].getViewLineMaxColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx)}getModelStartPositionOfViewLine(e){let t=this.modelLineProjections[e.modelLineNumber-1],n=t.getViewLineMinColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx),i=t.getModelColumnOfViewPosition(e.modelLineWrappedLineIdx,n);return new A(e.modelLineNumber,i)}getModelEndPositionOfViewLine(e){let t=this.modelLineProjections[e.modelLineNumber-1],n=t.getViewLineMaxColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx),i=t.getModelColumnOfViewPosition(e.modelLineWrappedLineIdx,n);return new A(e.modelLineNumber,i)}getViewLineInfosGroupedByModelRanges(e,t){let n=this.getViewLineInfo(e),i=this.getViewLineInfo(t),r=new Array,s=this.getModelStartPositionOfViewLine(n),a=new Array;for(let l=n.modelLineNumber;l<=i.modelLineNumber;l++){let d=this.modelLineProjections[l-1];if(d.isVisible()){let c=l===n.modelLineNumber?n.modelLineWrappedLineIdx:0,u=l===i.modelLineNumber?i.modelLineWrappedLineIdx+1:d.getViewLineCount();for(let p=c;p<u;p++)a.push(new w_(l,p))}if(!d.isVisible()&&s){let c=new A(l-1,this.model.getLineMaxColumn(l-1)+1),u=P.fromPositions(s,c);r.push(new __(u,a)),a=[],s=null}else d.isVisible()&&!s&&(s=new A(l,1))}if(s){let l=P.fromPositions(s,this.getModelEndPositionOfViewLine(i));r.push(new __(l,a))}return r}getViewLinesBracketGuides(e,t,n,i){let r=n?this.convertViewPositionToModelPosition(n.lineNumber,n.column):null,s=[];for(let a of this.getViewLineInfosGroupedByModelRanges(e,t)){let l=a.modelRange.startLineNumber,d=this.model.guides.getLinesBracketGuides(l,a.modelRange.endLineNumber,r,i);for(let c of a.viewLines){let p=d[c.modelLineNumber-l].map(h=>{if(h.forWrappedLinesAfterColumn!==-1&&this.modelLineProjections[c.modelLineNumber-1].getViewPositionOfModelPosition(0,h.forWrappedLinesAfterColumn).lineNumber>=c.modelLineWrappedLineIdx||h.forWrappedLinesBeforeOrAtColumn!==-1&&this.modelLineProjections[c.modelLineNumber-1].getViewPositionOfModelPosition(0,h.forWrappedLinesBeforeOrAtColumn).lineNumber<c.modelLineWrappedLineIdx)return;if(!h.horizontalLine)return h;let f=-1;if(h.column!==-1){let v=this.modelLineProjections[c.modelLineNumber-1].getViewPositionOfModelPosition(0,h.column);if(v.lineNumber===c.modelLineWrappedLineIdx)f=v.column;else if(v.lineNumber<c.modelLineWrappedLineIdx)f=this.getMinColumnOfViewLine(c);else if(v.lineNumber>c.modelLineWrappedLineIdx)return}let g=this.convertModelPositionToViewPosition(c.modelLineNumber,h.horizontalLine.endColumn),b=this.modelLineProjections[c.modelLineNumber-1].getViewPositionOfModelPosition(0,h.horizontalLine.endColumn);return b.lineNumber===c.modelLineWrappedLineIdx?new ts(h.visibleColumn,f,h.className,new wl(h.horizontalLine.top,g.column),-1,-1):b.lineNumber<c.modelLineWrappedLineIdx||h.visibleColumn!==-1?void 0:new ts(h.visibleColumn,f,h.className,new wl(h.horizontalLine.top,this.getMaxColumnOfViewLine(c)),-1,-1)});s.push(p.filter(h=>!!h))}}return s}getViewLinesIndentGuides(e,t){e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t);let n=this.convertViewPositionToModelPosition(e,this.getViewLineMinColumn(e)),i=this.convertViewPositionToModelPosition(t,this.getViewLineMaxColumn(t)),r=[],s=[],a=[],l=n.lineNumber-1,d=i.lineNumber-1,c=null;for(let f=l;f<=d;f++){let g=this.modelLineProjections[f];if(g.isVisible()){let b=g.getViewLineNumberOfModelPosition(0,f===l?n.column:1),v=g.getViewLineNumberOfModelPosition(0,this.model.getLineMaxColumn(f+1)),y=v-b+1,S=0;y>1&&g.getViewLineMinColumn(this.model,f+1,v)===1&&(S=b===0?1:2),s.push(y),a.push(S),c===null&&(c=new A(f+1,0))}else c!==null&&(r=r.concat(this.model.guides.getLinesIndentGuides(c.lineNumber,f)),c=null)}c!==null&&(r=r.concat(this.model.guides.getLinesIndentGuides(c.lineNumber,i.lineNumber)),c=null);let u=t-e+1,p=new Array(u),h=0;for(let f=0,g=r.length;f<g;f++){let b=r[f],v=Math.min(u-h,s[f]),y=a[f],S;y===2?S=0:y===1?S=1:S=v;for(let E=0;E<v;E++)E===S&&(b=0),p[h++]=b}return p}getViewLineContent(e){let t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineContent(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineLength(e){let t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineLength(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineMinColumn(e){let t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineMinColumn(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineMaxColumn(e){let t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineMaxColumn(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineData(e){let t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineData(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLinesData(e,t,n){e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t);let i=this.projectedModelLineLineCounts.getIndexOf(e-1),r=e,s=i.index,a=i.remainder,l=[];for(let d=s,c=this.model.getLineCount();d<c;d++){let u=this.modelLineProjections[d];if(!u.isVisible())continue;let p=d===s?a:0,h=u.getViewLineCount()-p,f=!1;if(r+h>t&&(f=!0,h=t-r+1),u.getViewLinesData(this.model,d+1,p,h,r-e,n,l),r+=h,f)break}return l}validateViewPosition(e,t,n){e=this._toValidViewLineNumber(e);let i=this.projectedModelLineLineCounts.getIndexOf(e-1),r=i.index,s=i.remainder,a=this.modelLineProjections[r],l=a.getViewLineMinColumn(this.model,r+1,s),d=a.getViewLineMaxColumn(this.model,r+1,s);t<l&&(t=l),t>d&&(t=d);let c=a.getModelColumnOfViewPosition(s,t);return this.model.validatePosition(new A(r+1,c)).equals(n)?new A(e,t):this.convertModelPositionToViewPosition(n.lineNumber,n.column)}validateViewRange(e,t){let n=this.validateViewPosition(e.startLineNumber,e.startColumn,t.getStartPosition()),i=this.validateViewPosition(e.endLineNumber,e.endColumn,t.getEndPosition());return new P(n.lineNumber,n.column,i.lineNumber,i.column)}convertViewPositionToModelPosition(e,t){let n=this.getViewLineInfo(e),i=this.modelLineProjections[n.modelLineNumber-1].getModelColumnOfViewPosition(n.modelLineWrappedLineIdx,t);return this.model.validatePosition(new A(n.modelLineNumber,i))}convertViewRangeToModelRange(e){let t=this.convertViewPositionToModelPosition(e.startLineNumber,e.startColumn),n=this.convertViewPositionToModelPosition(e.endLineNumber,e.endColumn);return new P(t.lineNumber,t.column,n.lineNumber,n.column)}convertModelPositionToViewPosition(e,t,n=2,i=!1,r=!1){let s=this.model.validatePosition(new A(e,t)),a=s.lineNumber,l=s.column,d=a-1,c=!1;if(r)for(;d<this.modelLineProjections.length&&!this.modelLineProjections[d].isVisible();)d++,c=!0;else for(;d>0&&!this.modelLineProjections[d].isVisible();)d--,c=!0;if(d===0&&!this.modelLineProjections[d].isVisible())return new A(i?0:1,1);let u=1+this.projectedModelLineLineCounts.getPrefixSum(d),p;return c?r?p=this.modelLineProjections[d].getViewPositionOfModelPosition(u,1,n):p=this.modelLineProjections[d].getViewPositionOfModelPosition(u,this.model.getLineMaxColumn(d+1),n):p=this.modelLineProjections[a-1].getViewPositionOfModelPosition(u,l,n),p}convertModelRangeToViewRange(e,t=0){if(e.isEmpty()){let n=this.convertModelPositionToViewPosition(e.startLineNumber,e.startColumn,t);return P.fromPositions(n)}else{let n=this.convertModelPositionToViewPosition(e.startLineNumber,e.startColumn,1),i=this.convertModelPositionToViewPosition(e.endLineNumber,e.endColumn,0);return new P(n.lineNumber,n.column,i.lineNumber,i.column)}}getViewLineNumberOfModelPosition(e,t){let n=e-1;if(this.modelLineProjections[n].isVisible()){let r=1+this.projectedModelLineLineCounts.getPrefixSum(n);return this.modelLineProjections[n].getViewLineNumberOfModelPosition(r,t)}for(;n>0&&!this.modelLineProjections[n].isVisible();)n--;if(n===0&&!this.modelLineProjections[n].isVisible())return 1;let i=1+this.projectedModelLineLineCounts.getPrefixSum(n);return this.modelLineProjections[n].getViewLineNumberOfModelPosition(i,this.model.getLineMaxColumn(n+1))}getDecorationsInRange(e,t,n,i,r){let s=this.convertViewPositionToModelPosition(e.startLineNumber,e.startColumn),a=this.convertViewPositionToModelPosition(e.endLineNumber,e.endColumn);if(a.lineNumber-s.lineNumber<=e.endLineNumber-e.startLineNumber)return this.model.getDecorationsInRange(new P(s.lineNumber,1,a.lineNumber,a.column),t,n,i,r);let l=[],d=s.lineNumber-1,c=a.lineNumber-1,u=null;for(let g=d;g<=c;g++)if(this.modelLineProjections[g].isVisible())u===null&&(u=new A(g+1,g===d?s.column:1));else if(u!==null){let v=this.model.getLineMaxColumn(g);l=l.concat(this.model.getDecorationsInRange(new P(u.lineNumber,u.column,g,v),t,n,i)),u=null}u!==null&&(l=l.concat(this.model.getDecorationsInRange(new P(u.lineNumber,u.column,a.lineNumber,a.column),t,n,i)),u=null),l.sort((g,b)=>{let v=P.compareRangesUsingStarts(g.range,b.range);return v===0?g.id<b.id?-1:g.id>b.id?1:0:v});let p=[],h=0,f=null;for(let g of l){let b=g.id;f!==b&&(f=b,p[h++]=g)}return p}getInjectedTextAt(e){let t=this.getViewLineInfo(e.lineNumber);return this.modelLineProjections[t.modelLineNumber-1].getInjectedTextAt(t.modelLineWrappedLineIdx,e.column)}normalizePosition(e,t){let n=this.getViewLineInfo(e.lineNumber);return this.modelLineProjections[n.modelLineNumber-1].normalizePosition(n.modelLineWrappedLineIdx,e,t)}getLineIndentColumn(e){let t=this.getViewLineInfo(e);return t.modelLineWrappedLineIdx===0?this.model.getLineIndentColumn(t.modelLineNumber):0}};function $j(o){if(o.length===0)return[];let e=o.slice();e.sort(P.compareRangesUsingStarts);let t=[],n=e[0].startLineNumber,i=e[0].endLineNumber;for(let r=1,s=e.length;r<s;r++){let a=e[r];a.startLineNumber>i+1?(t.push(new P(n,1,i,1)),n=a.startLineNumber,i=a.endLineNumber):a.endLineNumber>i&&(i=a.endLineNumber)}return t.push(new P(n,1,i,1)),t}var w_=class{constructor(e,t){this.modelLineNumber=e;this.modelLineWrappedLineIdx=t}get isWrappedLineContinuation(){return this.modelLineWrappedLineIdx>0}},__=class{constructor(e,t){this.modelRange=e;this.viewLines=t}},qO=class{_lines;constructor(e){this._lines=e}convertViewPositionToModelPosition(e){return this._lines.convertViewPositionToModelPosition(e.lineNumber,e.column)}convertViewRangeToModelRange(e){return this._lines.convertViewRangeToModelRange(e)}validateViewPosition(e,t){return this._lines.validateViewPosition(e.lineNumber,e.column,t)}validateViewRange(e,t){return this._lines.validateViewRange(e,t)}convertModelPositionToViewPosition(e,t,n,i){return this._lines.convertModelPositionToViewPosition(e.lineNumber,e.column,t,n,i)}convertModelRangeToViewRange(e,t){return this._lines.convertModelRangeToViewRange(e,t)}modelPositionIsVisible(e){return this._lines.modelPositionIsVisible(e.lineNumber,e.column)}getModelLineViewLineCount(e){return this._lines.getModelLineViewLineCount(e)}getViewLineNumberOfModelPosition(e,t){return this._lines.getViewLineNumberOfModelPosition(e,t)}};var D_=class{model;constructor(e){this.model=e}dispose(){}createCoordinatesConverter(){return new $O(this)}getHiddenAreas(){return[]}setHiddenAreas(e){return!1}setTabSize(e){return!1}setWrappingSettings(e,t,n,i){return!1}createLineBreaksComputer(){let e=[];return{addRequest:(t,n,i)=>{e.push(null)},finalize:()=>e}}onModelFlushed(){}onModelLinesDeleted(e,t,n){return new im(t,n)}onModelLinesInserted(e,t,n,i){return new om(t,n)}onModelLineChanged(e,t,n){return[!1,new Fb(t,1),null,null]}acceptVersionId(e){}getViewLineCount(){return this.model.getLineCount()}getActiveIndentGuide(e,t,n){return{startLineNumber:e,endLineNumber:e,indent:0}}getViewLinesBracketGuides(e,t,n){return new Array(t-e+1).fill([])}getViewLinesIndentGuides(e,t){let n=t-e+1,i=new Array(n);for(let r=0;r<n;r++)i[r]=0;return i}getViewLineContent(e){return this.model.getLineContent(e)}getViewLineLength(e){return this.model.getLineLength(e)}getViewLineMinColumn(e){return this.model.getLineMinColumn(e)}getViewLineMaxColumn(e){return this.model.getLineMaxColumn(e)}getViewLineData(e){let t=this.model.tokenization.getLineTokens(e),n=t.getLineContent();return new Nu(n,!1,1,n.length+1,0,t.inflate(),null)}getViewLinesData(e,t,n){let i=this.model.getLineCount();e=Math.min(Math.max(1,e),i),t=Math.min(Math.max(1,t),i);let r=[];for(let s=e;s<=t;s++){let a=s-e;r[a]=n[a]?this.getViewLineData(s):null}return r}getDecorationsInRange(e,t,n,i,r){return this.model.getDecorationsInRange(e,t,n,i,r)}normalizePosition(e,t){return this.model.normalizePosition(e,t)}getLineIndentColumn(e){return this.model.getLineIndentColumn(e)}getInjectedTextAt(e){return null}},$O=class{_lines;constructor(e){this._lines=e}_validPosition(e){return this._lines.model.validatePosition(e)}_validRange(e){return this._lines.model.validateRange(e)}convertViewPositionToModelPosition(e){return this._validPosition(e)}convertViewRangeToModelRange(e){return this._validRange(e)}validateViewPosition(e,t){return this._validPosition(t)}validateViewRange(e,t){return this._validRange(t)}convertModelPositionToViewPosition(e){return this._validPosition(e)}convertModelRangeToViewRange(e){return this._validRange(e)}modelPositionIsVisible(e){let t=this._lines.model.getLineCount();return!(e.lineNumber<1||e.lineNumber>t)}modelRangeIsVisible(e){let t=this._lines.model.getLineCount();return!(e.startLineNumber<1||e.startLineNumber>t||e.endLineNumber<1||e.endLineNumber>t)}getModelLineViewLineCount(e){return 1}getViewLineNumberOfModelPosition(e,t){return e}};var L_=class{editorId;model;configuration;_linesCollection;_coordinatesConverter;_decorationsCache;_cachedModelDecorationsResolver;_cachedModelDecorationsResolverViewRange;constructor(e,t,n,i,r){this.editorId=e,this.model=t,this.configuration=n,this._linesCollection=i,this._coordinatesConverter=r,this._decorationsCache=Object.create(null),this._cachedModelDecorationsResolver=null,this._cachedModelDecorationsResolverViewRange=null}_clearCachedModelDecorationsResolver(){this._cachedModelDecorationsResolver=null,this._cachedModelDecorationsResolverViewRange=null}dispose(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}reset(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}onModelDecorationsChanged(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}onLineMappingChanged(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}_getOrCreateViewModelDecoration(e){let t=e.id,n=this._decorationsCache[t];if(!n){let i=e.range,r=e.options,s;if(r.isWholeLine){let a=this._coordinatesConverter.convertModelPositionToViewPosition(new A(i.startLineNumber,1),0,!1,!0),l=this._coordinatesConverter.convertModelPositionToViewPosition(new A(i.endLineNumber,this.model.getLineMaxColumn(i.endLineNumber)),1);s=new P(a.lineNumber,a.column,l.lineNumber,l.column)}else s=this._coordinatesConverter.convertModelRangeToViewRange(i,1);n=new sm(s,r),this._decorationsCache[t]=n}return n}getMinimapDecorationsInRange(e){return this._getDecorationsInRange(e,!0,!1).decorations}getDecorationsViewportData(e){let t=this._cachedModelDecorationsResolver!==null;return t=t&&e.equalsRange(this._cachedModelDecorationsResolverViewRange),t||(this._cachedModelDecorationsResolver=this._getDecorationsInRange(e,!1,!1),this._cachedModelDecorationsResolverViewRange=e),this._cachedModelDecorationsResolver}getInlineDecorationsOnLine(e,t=!1,n=!1){let i=new P(e,this._linesCollection.getViewLineMinColumn(e),e,this._linesCollection.getViewLineMaxColumn(e));return this._getDecorationsInRange(i,t,n).inlineDecorations[0]}_getDecorationsInRange(e,t,n){let i=this._linesCollection.getDecorationsInRange(e,this.editorId,hu(this.configuration.options),t,n),r=e.startLineNumber,s=e.endLineNumber,a=[],l=0,d=[];for(let c=r;c<=s;c++)d[c-r]=[];for(let c=0,u=i.length;c<u;c++){let p=i[c],h=p.options;if(!Yj(this.model,p))continue;let f=this._getOrCreateViewModelDecoration(p),g=f.range;if(a[l++]=f,h.inlineClassName){let b=new Ml(g,h.inlineClassName,h.inlineClassNameAffectsLetterSpacing?3:0),v=Math.max(r,g.startLineNumber),y=Math.min(s,g.endLineNumber);for(let S=v;S<=y;S++)d[S-r].push(b)}if(h.beforeContentClassName&&r<=g.startLineNumber&&g.startLineNumber<=s){let b=new Ml(new P(g.startLineNumber,g.startColumn,g.startLineNumber,g.startColumn),h.beforeContentClassName,1);d[g.startLineNumber-r].push(b)}if(h.afterContentClassName&&r<=g.endLineNumber&&g.endLineNumber<=s){let b=new Ml(new P(g.endLineNumber,g.endColumn,g.endLineNumber,g.endColumn),h.afterContentClassName,2);d[g.endLineNumber-r].push(b)}}return{decorations:a,inlineDecorations:d}}};function Yj(o,e){return!(e.options.hideInCommentTokens&&Zj(o,e)||e.options.hideInStringTokens&&Xj(o,e))}function Zj(o,e){return r5(o,e.range,t=>t===1)}function Xj(o,e){return r5(o,e.range,t=>t===2)}function r5(o,e,t){for(let n=e.startLineNumber;n<=e.endLineNumber;n++){let i=o.tokenization.getLineTokens(n),r=n===e.startLineNumber,s=n===e.endLineNumber,a=r?i.findTokenIndexAtOffset(e.startColumn-1):0;for(;a<i.getCount()&&!(s&&i.getStartOffset(a)>e.endColumn-1);){if(!t(i.getStandardTokenType(a)))return!1;a++}}return!0}var Ip=3,R_=class{lanes;persist=0;_requiredLanes=1;constructor(e){this.lanes=new Uint8Array(Math.ceil((e+1)*Ip/8))}reset(e){let t=Math.ceil((e+1)*Ip/8);this.lanes.length<t?this.lanes=new Uint8Array(t):this.lanes.fill(0),this._requiredLanes=1}get requiredLanes(){return this._requiredLanes}push(e,t,n){n&&(this.persist|=1<<e-1);for(let i=t.startLineNumber;i<=t.endLineNumber;i++){let r=Ip*i+(e-1);this.lanes[r>>>3]|=1<<r%8,this._requiredLanes=Math.max(this._requiredLanes,this.countAtLine(i))}}getLanesAtLine(e){let t=[],n=Ip*e;for(let i=0;i<Ip;i++)(this.persist&1<<i||this.lanes[n>>>3]&1<<n%8)&&t.push(i+1),n++;return t.length?t:[2]}countAtLine(e){let t=Ip*e,n=0;for(let i=0;i<Ip;i++)(this.persist&1<<i||this.lanes[t>>>3]&1<<t%8)&&n++,t++;return n}};var Qj=!0,k_=class extends F{constructor(t,n,i,r,s,a,l,d,c,u){super();this.languageConfigurationService=l;this._themeService=d;this._attachedView=c;this._transactionalTarget=u;if(this._editorId=t,this._configuration=n,this.model=i,this._eventDispatcher=new i_,this.onEvent=this._eventDispatcher.onEvent,this.cursorConfig=new Rl(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._updateConfigurationViewLineCount=this._register(new nn(()=>this._updateConfigurationViewLineCountNow(),0)),this._hasFocus=!1,this._viewportStart=YO.create(this.model),this.glyphLanes=new R_(0),Qj&&this.model.isTooLargeForTokenization())this._lines=new D_(this.model);else{let p=this._configuration.options,h=p.get(51),f=p.get(141),g=p.get(148),b=p.get(140),v=p.get(131);this._lines=new x_(this._editorId,this.model,r,s,h,this.model.getOptions().tabSize,f,g.wrappingColumn,b,v)}this.coordinatesConverter=this._lines.createCoordinatesConverter(),this._cursor=this._register(new b_(i,this,this.coordinatesConverter,this.cursorConfig)),this.viewLayout=this._register(new I_(this._configuration,this.getLineCount(),a)),this._register(this.viewLayout.onDidScroll(p=>{p.scrollTopChanged&&this._handleVisibleLinesChanged(),p.scrollTopChanged&&this._viewportStart.invalidate(),this._eventDispatcher.emitSingleViewEvent(new YS(p)),this._eventDispatcher.emitOutgoingEvent(new s_(p.oldScrollWidth,p.oldScrollLeft,p.oldScrollHeight,p.oldScrollTop,p.scrollWidth,p.scrollLeft,p.scrollHeight,p.scrollTop))})),this._register(this.viewLayout.onDidContentSizeChange(p=>{this._eventDispatcher.emitOutgoingEvent(p)})),this._decorations=new L_(this._editorId,this.model,this._configuration,this._lines,this.coordinatesConverter),this._registerModelEvents(),this._register(this._configuration.onDidChangeFast(p=>{try{let h=this._eventDispatcher.beginEmitViewEvents();this._onConfigurationChanged(h,p)}finally{this._eventDispatcher.endEmitViewEvents()}})),this._register(ug.getInstance().onDidChange(()=>{this._eventDispatcher.emitSingleViewEvent(new QS)})),this._register(this._themeService.onDidColorThemeChange(p=>{this._invalidateDecorationsColorCache(),this._eventDispatcher.emitSingleViewEvent(new ZS(p))})),this._updateConfigurationViewLineCountNow()}_editorId;_configuration;model;_eventDispatcher;onEvent;cursorConfig;_updateConfigurationViewLineCount;_hasFocus;_viewportStart;_lines;coordinatesConverter;viewLayout;_cursor;_decorations;glyphLanes;dispose(){super.dispose(),this._decorations.dispose(),this._lines.dispose(),this._viewportStart.dispose(),this._eventDispatcher.dispose()}createLineBreaksComputer(){return this._lines.createLineBreaksComputer()}addViewEventHandler(t){this._eventDispatcher.addViewEventHandler(t)}removeViewEventHandler(t){this._eventDispatcher.removeViewEventHandler(t)}_updateConfigurationViewLineCountNow(){this._configuration.setViewLineCount(this._lines.getViewLineCount())}getModelVisibleRanges(){let t=this.viewLayout.getLinesViewportData(),n=new P(t.startLineNumber,this.getLineMinColumn(t.startLineNumber),t.endLineNumber,this.getLineMaxColumn(t.endLineNumber));return this._toModelVisibleRanges(n)}visibleLinesStabilized(){let t=this.getModelVisibleRanges();this._attachedView.setVisibleLines(t,!0)}_handleVisibleLinesChanged(){let t=this.getModelVisibleRanges();this._attachedView.setVisibleLines(t,!1)}setHasFocus(t){this._hasFocus=t,this._cursor.setHasFocus(t),this._eventDispatcher.emitSingleViewEvent(new qS(t)),this._eventDispatcher.emitOutgoingEvent(new r_(!t,t))}onCompositionStart(){this._eventDispatcher.emitSingleViewEvent(new zS)}onCompositionEnd(){this._eventDispatcher.emitSingleViewEvent(new KS)}_captureStableViewport(){if(this._viewportStart.isValid&&this.viewLayout.getCurrentScrollTop()>0){let t=new A(this._viewportStart.viewLineNumber,this.getLineMinColumn(this._viewportStart.viewLineNumber)),n=this.coordinatesConverter.convertViewPositionToModelPosition(t);return new M_(n,this._viewportStart.startLineDelta)}return new M_(null,0)}_onConfigurationChanged(t,n){let i=this._captureStableViewport(),r=this._configuration.options,s=r.get(51),a=r.get(141),l=r.get(148),d=r.get(140),c=r.get(131);this._lines.setWrappingSettings(s,a,l.wrappingColumn,d,c)&&(t.emitViewEvent(new Pu),t.emitViewEvent(new Ou),t.emitViewEvent(new ka(null)),this._cursor.onLineMappingChanged(t),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount()),this._updateConfigurationViewLineCount.schedule()),n.hasChanged(93)&&(this._decorations.reset(),t.emitViewEvent(new ka(null))),n.hasChanged(100)&&(this._decorations.reset(),t.emitViewEvent(new ka(null))),t.emitViewEvent(new GS(n)),this.viewLayout.onConfigurationChanged(n),i.recoverViewportStart(this.coordinatesConverter,this.viewLayout),Rl.shouldRecreate(n)&&(this.cursorConfig=new Rl(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig))}_registerModelEvents(){this._register(this.model.onDidChangeContentOrInjectedText(t=>{try{let i=this._eventDispatcher.beginEmitViewEvents(),r=!1,s=!1,a=t instanceof Vd?t.rawContentChangedEvent.changes:t.changes,l=t instanceof Vd?t.rawContentChangedEvent.versionId:null,d=this._lines.createLineBreaksComputer();for(let p of a)switch(p.changeType){case 4:{for(let h=0;h<p.detail.length;h++){let f=p.detail[h],g=p.injectedTexts[h];g&&(g=g.filter(b=>!b.ownerId||b.ownerId===this._editorId)),d.addRequest(f,g,null)}break}case 2:{let h=null;p.injectedText&&(h=p.injectedText.filter(f=>!f.ownerId||f.ownerId===this._editorId)),d.addRequest(p.detail,h,null);break}}let c=d.finalize(),u=new Wi(c);for(let p of a)switch(p.changeType){case 1:{this._lines.onModelFlushed(),i.emitViewEvent(new Pu),this._decorations.reset(),this.viewLayout.onFlushed(this.getLineCount()),r=!0;break}case 3:{let h=this._lines.onModelLinesDeleted(l,p.fromLineNumber,p.toLineNumber);h!==null&&(i.emitViewEvent(h),this.viewLayout.onLinesDeleted(h.fromLineNumber,h.toLineNumber)),r=!0;break}case 4:{let h=u.takeCount(p.detail.length),f=this._lines.onModelLinesInserted(l,p.fromLineNumber,p.toLineNumber,h);f!==null&&(i.emitViewEvent(f),this.viewLayout.onLinesInserted(f.fromLineNumber,f.toLineNumber)),r=!0;break}case 2:{let h=u.dequeue(),[f,g,b,v]=this._lines.onModelLineChanged(l,p.lineNumber,h);s=f,g&&i.emitViewEvent(g),b&&(i.emitViewEvent(b),this.viewLayout.onLinesInserted(b.fromLineNumber,b.toLineNumber)),v&&(i.emitViewEvent(v),this.viewLayout.onLinesDeleted(v.fromLineNumber,v.toLineNumber));break}case 5:break}l!==null&&this._lines.acceptVersionId(l),this.viewLayout.onHeightMaybeChanged(),!r&&s&&(i.emitViewEvent(new Ou),i.emitViewEvent(new ka(null)),this._cursor.onLineMappingChanged(i),this._decorations.onLineMappingChanged())}finally{this._eventDispatcher.endEmitViewEvents()}let n=this._viewportStart.isValid;if(this._viewportStart.invalidate(),this._configuration.setModelLineCount(this.model.getLineCount()),this._updateConfigurationViewLineCountNow(),!this._hasFocus&&this.model.getAttachedEditorCount()>=2&&n){let i=this.model._getTrackedRange(this._viewportStart.modelTrackedRange);if(i){let r=this.coordinatesConverter.convertModelPositionToViewPosition(i.getStartPosition()),s=this.viewLayout.getVerticalOffsetForLineNumber(r.lineNumber);this.viewLayout.setScrollPosition({scrollTop:s+this._viewportStart.startLineDelta},1)}}try{let i=this._eventDispatcher.beginEmitViewEvents();t instanceof Vd&&i.emitOutgoingEvent(new m_(t.contentChangedEvent)),this._cursor.onModelContentChanged(i,t)}finally{this._eventDispatcher.endEmitViewEvents()}this._handleVisibleLinesChanged()})),this._register(this.model.onDidChangeTokens(t=>{let n=[];for(let i=0,r=t.ranges.length;i<r;i++){let s=t.ranges[i],a=this.coordinatesConverter.convertModelPositionToViewPosition(new A(s.fromLineNumber,1)).lineNumber,l=this.coordinatesConverter.convertModelPositionToViewPosition(new A(s.toLineNumber,this.model.getLineMaxColumn(s.toLineNumber))).lineNumber;n[i]={fromLineNumber:a,toLineNumber:l}}this._eventDispatcher.emitSingleViewEvent(new XS(n)),this._eventDispatcher.emitOutgoingEvent(new f_(t))})),this._register(this.model.onDidChangeLanguageConfiguration(t=>{this._eventDispatcher.emitSingleViewEvent(new $S),this.cursorConfig=new Rl(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new h_(t))})),this._register(this.model.onDidChangeLanguage(t=>{this.cursorConfig=new Rl(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new p_(t))})),this._register(this.model.onDidChangeOptions(t=>{if(this._lines.setTabSize(this.model.getOptions().tabSize)){try{let n=this._eventDispatcher.beginEmitViewEvents();n.emitViewEvent(new Pu),n.emitViewEvent(new Ou),n.emitViewEvent(new ka(null)),this._cursor.onLineMappingChanged(n),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount())}finally{this._eventDispatcher.endEmitViewEvents()}this._updateConfigurationViewLineCount.schedule()}this.cursorConfig=new Rl(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new g_(t))})),this._register(this.model.onDidChangeDecorations(t=>{this._decorations.onModelDecorationsChanged(),this._eventDispatcher.emitSingleViewEvent(new ka(t)),this._eventDispatcher.emitOutgoingEvent(new u_(t))}))}hiddenAreasModel=new XO;previousHiddenAreas=[];setHiddenAreas(t,n){this.hiddenAreasModel.setHiddenAreas(n,t);let i=this.hiddenAreasModel.getMergedRanges();if(i===this.previousHiddenAreas)return;this.previousHiddenAreas=i;let r=this._captureStableViewport(),s=!1;try{let a=this._eventDispatcher.beginEmitViewEvents();s=this._lines.setHiddenAreas(i),s&&(a.emitViewEvent(new Pu),a.emitViewEvent(new Ou),a.emitViewEvent(new ka(null)),this._cursor.onLineMappingChanged(a),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount()),this.viewLayout.onHeightMaybeChanged());let l=r.viewportStartModelPosition?.lineNumber;l&&i.some(c=>c.startLineNumber<=l&&l<=c.endLineNumber)||r.recoverViewportStart(this.coordinatesConverter,this.viewLayout)}finally{this._eventDispatcher.endEmitViewEvents()}this._updateConfigurationViewLineCount.schedule(),s&&this._eventDispatcher.emitOutgoingEvent(new l_)}getVisibleRangesPlusViewportAboveBelow(){let t=this._configuration.options.get(147),n=this._configuration.options.get(68),i=Math.max(20,Math.round(t.height/n)),r=this.viewLayout.getLinesViewportData(),s=Math.max(1,r.completelyVisibleStartLineNumber-i),a=Math.min(this.getLineCount(),r.completelyVisibleEndLineNumber+i);return this._toModelVisibleRanges(new P(s,this.getLineMinColumn(s),a,this.getLineMaxColumn(a)))}getVisibleRanges(){let t=this.getCompletelyVisibleViewRange();return this._toModelVisibleRanges(t)}getHiddenAreas(){return this._lines.getHiddenAreas()}_toModelVisibleRanges(t){let n=this.coordinatesConverter.convertViewRangeToModelRange(t),i=this._lines.getHiddenAreas();if(i.length===0)return[n];let r=[],s=0,a=n.startLineNumber,l=n.startColumn,d=n.endLineNumber,c=n.endColumn;for(let u=0,p=i.length;u<p;u++){let h=i[u].startLineNumber,f=i[u].endLineNumber;f<a||h>d||(a<h&&(r[s++]=new P(a,l,h-1,this.model.getLineMaxColumn(h-1))),a=f+1,l=1)}return(a<d||a===d&&l<c)&&(r[s++]=new P(a,l,d,c)),r}getCompletelyVisibleViewRange(){let t=this.viewLayout.getLinesViewportData(),n=t.completelyVisibleStartLineNumber,i=t.completelyVisibleEndLineNumber;return new P(n,this.getLineMinColumn(n),i,this.getLineMaxColumn(i))}getCompletelyVisibleViewRangeAtScrollTop(t){let n=this.viewLayout.getLinesViewportDataAtScrollTop(t),i=n.completelyVisibleStartLineNumber,r=n.completelyVisibleEndLineNumber;return new P(i,this.getLineMinColumn(i),r,this.getLineMaxColumn(r))}saveState(){let t=this.viewLayout.saveState(),n=t.scrollTop,i=this.viewLayout.getLineNumberAtVerticalOffset(n),r=this.coordinatesConverter.convertViewPositionToModelPosition(new A(i,this.getLineMinColumn(i))),s=this.viewLayout.getVerticalOffsetForLineNumber(i)-n;return{scrollLeft:t.scrollLeft,firstPosition:r,firstPositionDeltaTop:s}}reduceRestoreState(t){if(typeof t.firstPosition>"u")return this._reduceRestoreStateCompatibility(t);let n=this.model.validatePosition(t.firstPosition),i=this.coordinatesConverter.convertModelPositionToViewPosition(n),r=this.viewLayout.getVerticalOffsetForLineNumber(i.lineNumber)-t.firstPositionDeltaTop;return{scrollLeft:t.scrollLeft,scrollTop:r}}_reduceRestoreStateCompatibility(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTopWithoutViewZones}}getTabSize(){return this.model.getOptions().tabSize}getLineCount(){return this._lines.getViewLineCount()}setViewport(t,n,i){this._viewportStart.update(this,t)}getActiveIndentGuide(t,n,i){return this._lines.getActiveIndentGuide(t,n,i)}getLinesIndentGuides(t,n){return this._lines.getViewLinesIndentGuides(t,n)}getBracketGuidesInRangeByLine(t,n,i,r){return this._lines.getViewLinesBracketGuides(t,n,i,r)}getLineContent(t){return this._lines.getViewLineContent(t)}getLineLength(t){return this._lines.getViewLineLength(t)}getLineMinColumn(t){return this._lines.getViewLineMinColumn(t)}getLineMaxColumn(t){return this._lines.getViewLineMaxColumn(t)}getLineFirstNonWhitespaceColumn(t){let n=Cn(this.getLineContent(t));return n===-1?0:n+1}getLineLastNonWhitespaceColumn(t){let n=Lr(this.getLineContent(t));return n===-1?0:n+2}getMinimapDecorationsInRange(t){return this._decorations.getMinimapDecorationsInRange(t)}getDecorationsInViewport(t){return this._decorations.getDecorationsViewportData(t).decorations}getInjectedTextAt(t){return this._lines.getInjectedTextAt(t)}getViewportViewLineRenderingData(t,n){let r=this._decorations.getDecorationsViewportData(t).inlineDecorations[n-t.startLineNumber];return this._getViewLineRenderingData(n,r)}getViewLineRenderingData(t){let n=this._decorations.getInlineDecorationsOnLine(t);return this._getViewLineRenderingData(t,n)}_getViewLineRenderingData(t,n){let i=this.model.mightContainRTL(),r=this.model.mightContainNonBasicASCII(),s=this.getTabSize(),a=this._lines.getViewLineData(t);return a.inlineDecorations&&(n=[...n,...a.inlineDecorations.map(l=>l.toInlineDecoration(t))]),new Ma(a.minColumn,a.maxColumn,a.content,a.continuesWithWrappedLine,i,r,a.tokens,n,s,a.startVisibleColumn)}getViewLineData(t){return this._lines.getViewLineData(t)}getMinimapLinesRenderingData(t,n,i){let r=this._lines.getViewLinesData(t,n,i);return new eE(this.getTabSize(),r)}getAllOverviewRulerDecorations(t){let n=this.model.getOverviewRulerDecorations(this._editorId,hu(this._configuration.options)),i=new ZO;for(let r of n){let s=r.options,a=s.overviewRuler;if(!a)continue;let l=a.position;if(l===0)continue;let d=a.getColor(t.value),c=this.coordinatesConverter.getViewLineNumberOfModelPosition(r.range.startLineNumber,r.range.startColumn),u=this.coordinatesConverter.getViewLineNumberOfModelPosition(r.range.endLineNumber,r.range.endColumn);i.accept(d,s.zIndex,c,u,l)}return i.asArray}_invalidateDecorationsColorCache(){let t=this.model.getOverviewRulerDecorations();for(let n of t)n.options.overviewRuler?.invalidateCachedColor(),n.options.minimap?.invalidateCachedColor()}getValueInRange(t,n){let i=this.coordinatesConverter.convertViewRangeToModelRange(t);return this.model.getValueInRange(i,n)}getValueLengthInRange(t,n){let i=this.coordinatesConverter.convertViewRangeToModelRange(t);return this.model.getValueLengthInRange(i,n)}modifyPosition(t,n){let i=this.coordinatesConverter.convertViewPositionToModelPosition(t),r=this.model.modifyPosition(i,n);return this.coordinatesConverter.convertModelPositionToViewPosition(r)}deduceModelPositionRelativeToViewPosition(t,n,i){let r=this.coordinatesConverter.convertViewPositionToModelPosition(t);this.model.getEOL().length===2&&(n<0?n-=i:n+=i);let a=this.model.getOffsetAt(r)+n;return this.model.getPositionAt(a)}getPlainTextToCopy(t,n,i){let r=i?`\r
`:this.model.getEOL();t=t.slice(0),t.sort(P.compareRangesUsingStarts);let s=!1,a=!1;for(let d of t)d.isEmpty()?s=!0:a=!0;if(!a){if(!n)return"";let d=t.map(u=>u.startLineNumber),c="";for(let u=0;u<d.length;u++)u>0&&d[u-1]===d[u]||(c+=this.model.getLineContent(d[u])+r);return c}if(s&&n){let d=[],c=0;for(let u of t){let p=u.startLineNumber;u.isEmpty()?p!==c&&d.push(this.model.getLineContent(p)):d.push(this.model.getValueInRange(u,i?2:0)),c=p}return d.length===1?d[0]:d}let l=[];for(let d of t)d.isEmpty()||l.push(this.model.getValueInRange(d,i?2:0));return l.length===1?l[0]:l}getRichTextToCopy(t,n){let i=this.model.getLanguageId();if(i===Ls||t.length!==1)return null;let r=t[0];if(r.isEmpty()){if(!n)return null;let u=r.startLineNumber;r=new P(u,this.model.getLineMinColumn(u),u,this.model.getLineMaxColumn(u))}let s=this._configuration.options.get(51),a=this._getColorMap(),d=/[:;\\\/<>]/.test(s.fontFamily)||s.fontFamily===No.fontFamily,c;return d?c=No.fontFamily:(c=s.fontFamily,c=c.replace(/"/g,"'"),/[,']/.test(c)||/[+ ]/.test(c)&&(c=`'${c}'`),c=`${c}, ${No.fontFamily}`),{mode:i,html:`<div style="color: ${a[1]};background-color: ${a[2]};font-family: ${c};font-weight: ${s.fontWeight};font-size: ${s.fontSize}px;line-height: ${s.lineHeight}px;white-space: pre;">`+this._getHTMLToCopy(r,a)+"</div>"}}_getHTMLToCopy(t,n){let i=t.startLineNumber,r=t.startColumn,s=t.endLineNumber,a=t.endColumn,l=this.getTabSize(),d="";for(let c=i;c<=s;c++){let u=this.model.tokenization.getLineTokens(c),p=u.getLineContent(),h=c===i?r-1:0,f=c===s?a-1:p.length;p===""?d+="<br>":d+=i5(p,u.inflate(),n,h,f,l,pt)}return d}_getColorMap(){let t=cr.getColorMap(),n=["#000000"];if(t)for(let i=1,r=t.length;i<r;i++)n[i]=H.Format.CSS.formatHex(t[i]);return n}getPrimaryCursorState(){return this._cursor.getPrimaryCursorState()}getLastAddedCursorIndex(){return this._cursor.getLastAddedCursorIndex()}getCursorStates(){return this._cursor.getCursorStates()}setCursorStates(t,n,i){return this._withViewEventsCollector(r=>this._cursor.setStates(r,t,n,i))}getCursorColumnSelectData(){return this._cursor.getCursorColumnSelectData()}getCursorAutoClosedCharacters(){return this._cursor.getAutoClosedCharacters()}setCursorColumnSelectData(t){this._cursor.setCursorColumnSelectData(t)}getPrevEditOperationType(){return this._cursor.getPrevEditOperationType()}setPrevEditOperationType(t){this._cursor.setPrevEditOperationType(t)}getSelection(){return this._cursor.getSelection()}getSelections(){return this._cursor.getSelections()}getPosition(){return this._cursor.getPrimaryCursorState().modelState.position}setSelections(t,n,i=0){this._withViewEventsCollector(r=>this._cursor.setSelections(r,t,n,i))}saveCursorState(){return this._cursor.saveState()}restoreCursorState(t){this._withViewEventsCollector(n=>this._cursor.restoreState(n,t))}_executeCursorEdit(t){if(this._cursor.context.cursorConfig.readOnly){this._eventDispatcher.emitOutgoingEvent(new c_);return}this._withViewEventsCollector(t)}executeEdits(t,n,i){this._executeCursorEdit(r=>this._cursor.executeEdits(r,t,n,i))}startComposition(){this._executeCursorEdit(t=>this._cursor.startComposition(t))}endComposition(t){this._executeCursorEdit(n=>this._cursor.endComposition(n,t))}type(t,n){this._executeCursorEdit(i=>this._cursor.type(i,t,n))}compositionType(t,n,i,r,s){this._executeCursorEdit(a=>this._cursor.compositionType(a,t,n,i,r,s))}paste(t,n,i,r){this._executeCursorEdit(s=>this._cursor.paste(s,t,n,i,r))}cut(t){this._executeCursorEdit(n=>this._cursor.cut(n,t))}executeCommand(t,n){this._executeCursorEdit(i=>this._cursor.executeCommand(i,t,n))}executeCommands(t,n){this._executeCursorEdit(i=>this._cursor.executeCommands(i,t,n))}revealAllCursors(t,n,i=!1){this._withViewEventsCollector(r=>this._cursor.revealAll(r,t,i,0,n,0))}revealPrimaryCursor(t,n,i=!1){this._withViewEventsCollector(r=>this._cursor.revealPrimary(r,t,i,0,n,0))}revealTopMostCursor(t){let n=this._cursor.getTopMostViewPosition(),i=new P(n.lineNumber,n.column,n.lineNumber,n.column);this._withViewEventsCollector(r=>r.emitViewEvent(new kl(t,!1,i,null,0,!0,0)))}revealBottomMostCursor(t){let n=this._cursor.getBottomMostViewPosition(),i=new P(n.lineNumber,n.column,n.lineNumber,n.column);this._withViewEventsCollector(r=>r.emitViewEvent(new kl(t,!1,i,null,0,!0,0)))}revealRange(t,n,i,r,s){this._withViewEventsCollector(a=>a.emitViewEvent(new kl(t,!1,i,null,r,n,s)))}changeWhitespace(t){this.viewLayout.changeWhitespace(t)&&(this._eventDispatcher.emitSingleViewEvent(new JS),this._eventDispatcher.emitOutgoingEvent(new a_))}_withViewEventsCollector(t){return this._transactionalTarget.batchChanges(()=>{try{let n=this._eventDispatcher.beginEmitViewEvents();return t(n)}finally{this._eventDispatcher.endEmitViewEvents()}})}batchEvents(t){this._withViewEventsCollector(()=>{t()})}normalizePosition(t,n){return this._lines.normalizePosition(t,n)}getLineIndentColumn(t){return this._lines.getLineIndentColumn(t)}},YO=class o{constructor(e,t,n,i,r){this._model=e;this._viewLineNumber=t;this._isValid=n;this._modelTrackedRange=i;this._startLineDelta=r}static create(e){let t=e._setTrackedRange(null,new P(1,1,1,1),1);return new o(e,1,!1,t,0)}get viewLineNumber(){return this._viewLineNumber}get isValid(){return this._isValid}get modelTrackedRange(){return this._modelTrackedRange}get startLineDelta(){return this._startLineDelta}dispose(){this._model._setTrackedRange(this._modelTrackedRange,null,1)}update(e,t){let n=e.coordinatesConverter.convertViewPositionToModelPosition(new A(t,e.getLineMinColumn(t))),i=e.model._setTrackedRange(this._modelTrackedRange,new P(n.lineNumber,n.column,n.lineNumber,n.column),1),r=e.viewLayout.getVerticalOffsetForLineNumber(t),s=e.viewLayout.getCurrentScrollTop();this._viewLineNumber=t,this._isValid=!0,this._modelTrackedRange=i,this._startLineDelta=s-r}invalidate(){this._isValid=!1}},ZO=class{_asMap=Object.create(null);asArray=[];accept(e,t,n,i,r){let s=this._asMap[e];if(s){let a=s.data,l=a[a.length-3],d=a[a.length-1];if(l===r&&d+1>=n){i>d&&(a[a.length-1]=i);return}a.push(r,n,i)}else{let a=new Au(e,t,[r,n,i]);this._asMap[e]=a,this.asArray.push(a)}}},XO=class{hiddenAreas=new Map;shouldRecompute=!1;ranges=[];setHiddenAreas(e,t){let n=this.hiddenAreas.get(e);n&&s5(n,t)||(this.hiddenAreas.set(e,t),this.shouldRecompute=!0)}getMergedRanges(){if(!this.shouldRecompute)return this.ranges;this.shouldRecompute=!1;let e=Array.from(this.hiddenAreas.values()).reduce((t,n)=>Jj(t,n),[]);return s5(this.ranges,e)?this.ranges:(this.ranges=e,this.ranges)}};function Jj(o,e){let t=[],n=0,i=0;for(;n<o.length&&i<e.length;){let r=o[n],s=e[i];if(r.endLineNumber<s.startLineNumber-1)t.push(o[n++]);else if(s.endLineNumber<r.startLineNumber-1)t.push(e[i++]);else{let a=Math.min(r.startLineNumber,s.startLineNumber),l=Math.max(r.endLineNumber,s.endLineNumber);t.push(new P(a,1,l,1)),n++,i++}}for(;n<o.length;)t.push(o[n++]);for(;i<e.length;)t.push(e[i++]);return t}function s5(o,e){if(o.length!==e.length)return!1;for(let t=0;t<o.length;t++)if(!o[t].equalsRange(e[t]))return!1;return!0}var M_=class{constructor(e,t){this.viewportStartModelPosition=e;this.startLineDelta=t}recoverViewportStart(e,t){if(!this.viewportStartModelPosition)return;let n=e.convertModelPositionToViewPosition(this.viewportStartModelPosition),i=t.getVerticalOffsetForLineNumber(n.lineNumber);t.setScrollPosition({scrollTop:i+this.startLineDelta},1)}};var ps=class extends F{constructor(t,n,i,r,s,a,l,d,c,u,p,h){super();this.languageConfigurationService=p;s.willCreateCodeEditor();let f={...n};this._domElement=t,this._overflowWidgetsDomNode=f.overflowWidgetsDomNode,delete f.overflowWidgetsDomNode,this._id=++eq,this._decorationTypeKeysToIds={},this._decorationTypeSubtypes={},this._telemetryData=i.telemetryData,this._configuration=this._register(this._createConfiguration(i.isSimpleWidget||!1,i.contextMenuId??(i.isSimpleWidget?bi.SimpleEditorContext:bi.EditorContext),f,u)),this._register(this._configuration.onDidChange(v=>{this._onDidChangeConfiguration.fire(v);let y=this._configuration.options;if(v.hasChanged(147)){let S=y.get(147);this._onDidLayoutChange.fire(S)}})),this._contextKeyService=this._register(l.createScoped(this._domElement)),this._notificationService=c,this._codeEditorService=s,this._commandService=a,this._themeService=d,this._register(new eN(this,this._contextKeyService)),this._register(new tN(this,this._contextKeyService,h)),this._instantiationService=this._register(r.createChild(new gd([_t,this._contextKeyService]))),this._modelData=null,this._focusTracker=new nN(t,this._overflowWidgetsDomNode),this._register(this._focusTracker.onChange(()=>{this._editorWidgetFocus.setValue(this._focusTracker.hasFocus())})),this._contentWidgets={},this._overlayWidgets={},this._glyphMarginWidgets={};let g;Array.isArray(i.contributions)?g=i.contributions:g=op.getEditorContributions(),this._contributions.initialize(this,g,this._instantiationService);for(let v of op.getEditorActions()){if(this._actions.has(v.id)){qe(new Error(`Cannot have two actions with the same id ${v.id}`));continue}let y=new t_(v.id,v.label,v.alias,v.metadata,v.precondition??void 0,S=>this._instantiationService.invokeFunction(E=>Promise.resolve(v.runEditorCommand(E,this,S))),this._contextKeyService);this._actions.set(y.id,y)}let b=()=>!this._configuration.options.get(93)&&this._configuration.options.get(36).enabled;this._register(new gS(this._domElement,{onDragOver:v=>{if(!b())return;let y=this.getTargetAtClientPoint(v.clientX,v.clientY);y?.position&&this.showDropIndicatorAt(y.position)},onDrop:async v=>{if(!b()||(this.removeDropIndicator(),!v.dataTransfer))return;let y=this.getTargetAtClientPoint(v.clientX,v.clientY);y?.position&&this._onDropIntoEditor.fire({position:y.position,event:v})},onDragLeave:()=>{this.removeDropIndicator()},onDragEnd:()=>{this.removeDropIndicator()}})),this._codeEditorService.addCodeEditor(this)}static dropIntoEditorDecorationOptions=En.register({description:"workbench-dnd-target",className:"dnd-target"});_deliveryQueue=MA();_contributions=this._register(new e_);_onDidDispose=this._register(new D);onDidDispose=this._onDidDispose.event;_onDidChangeModelContent=this._register(new D({deliveryQueue:this._deliveryQueue}));onDidChangeModelContent=this._onDidChangeModelContent.event;_onDidChangeModelLanguage=this._register(new D({deliveryQueue:this._deliveryQueue}));onDidChangeModelLanguage=this._onDidChangeModelLanguage.event;_onDidChangeModelLanguageConfiguration=this._register(new D({deliveryQueue:this._deliveryQueue}));onDidChangeModelLanguageConfiguration=this._onDidChangeModelLanguageConfiguration.event;_onDidChangeModelOptions=this._register(new D({deliveryQueue:this._deliveryQueue}));onDidChangeModelOptions=this._onDidChangeModelOptions.event;_onDidChangeModelDecorations=this._register(new D({deliveryQueue:this._deliveryQueue}));onDidChangeModelDecorations=this._onDidChangeModelDecorations.event;_onDidChangeModelTokens=this._register(new D({deliveryQueue:this._deliveryQueue}));onDidChangeModelTokens=this._onDidChangeModelTokens.event;_onDidChangeConfiguration=this._register(new D({deliveryQueue:this._deliveryQueue}));onDidChangeConfiguration=this._onDidChangeConfiguration.event;_onWillChangeModel=this._register(new D({deliveryQueue:this._deliveryQueue}));onWillChangeModel=this._onWillChangeModel.event;_onDidChangeModel=this._register(new D({deliveryQueue:this._deliveryQueue}));onDidChangeModel=this._onDidChangeModel.event;_onDidChangeCursorPosition=this._register(new D({deliveryQueue:this._deliveryQueue}));onDidChangeCursorPosition=this._onDidChangeCursorPosition.event;_onDidChangeCursorSelection=this._register(new D({deliveryQueue:this._deliveryQueue}));onDidChangeCursorSelection=this._onDidChangeCursorSelection.event;_onDidAttemptReadOnlyEdit=this._register(new Ci(this._contributions,this._deliveryQueue));onDidAttemptReadOnlyEdit=this._onDidAttemptReadOnlyEdit.event;_onDidLayoutChange=this._register(new D({deliveryQueue:this._deliveryQueue}));onDidLayoutChange=this._onDidLayoutChange.event;_editorTextFocus=this._register(new P_({deliveryQueue:this._deliveryQueue}));onDidFocusEditorText=this._editorTextFocus.onDidChangeToTrue;onDidBlurEditorText=this._editorTextFocus.onDidChangeToFalse;_editorWidgetFocus=this._register(new P_({deliveryQueue:this._deliveryQueue}));onDidFocusEditorWidget=this._editorWidgetFocus.onDidChangeToTrue;onDidBlurEditorWidget=this._editorWidgetFocus.onDidChangeToFalse;_onWillType=this._register(new Ci(this._contributions,this._deliveryQueue));onWillType=this._onWillType.event;_onDidType=this._register(new Ci(this._contributions,this._deliveryQueue));onDidType=this._onDidType.event;_onDidCompositionStart=this._register(new Ci(this._contributions,this._deliveryQueue));onDidCompositionStart=this._onDidCompositionStart.event;_onDidCompositionEnd=this._register(new Ci(this._contributions,this._deliveryQueue));onDidCompositionEnd=this._onDidCompositionEnd.event;_onDidPaste=this._register(new Ci(this._contributions,this._deliveryQueue));onDidPaste=this._onDidPaste.event;_onMouseUp=this._register(new Ci(this._contributions,this._deliveryQueue));onMouseUp=this._onMouseUp.event;_onMouseDown=this._register(new Ci(this._contributions,this._deliveryQueue));onMouseDown=this._onMouseDown.event;_onMouseDrag=this._register(new Ci(this._contributions,this._deliveryQueue));onMouseDrag=this._onMouseDrag.event;_onMouseDrop=this._register(new Ci(this._contributions,this._deliveryQueue));onMouseDrop=this._onMouseDrop.event;_onMouseDropCanceled=this._register(new Ci(this._contributions,this._deliveryQueue));onMouseDropCanceled=this._onMouseDropCanceled.event;_onDropIntoEditor=this._register(new Ci(this._contributions,this._deliveryQueue));onDropIntoEditor=this._onDropIntoEditor.event;_onContextMenu=this._register(new Ci(this._contributions,this._deliveryQueue));onContextMenu=this._onContextMenu.event;_onMouseMove=this._register(new Ci(this._contributions,this._deliveryQueue));onMouseMove=this._onMouseMove.event;_onMouseLeave=this._register(new Ci(this._contributions,this._deliveryQueue));onMouseLeave=this._onMouseLeave.event;_onMouseWheel=this._register(new Ci(this._contributions,this._deliveryQueue));onMouseWheel=this._onMouseWheel.event;_onKeyUp=this._register(new Ci(this._contributions,this._deliveryQueue));onKeyUp=this._onKeyUp.event;_onKeyDown=this._register(new Ci(this._contributions,this._deliveryQueue));onKeyDown=this._onKeyDown.event;_onDidContentSizeChange=this._register(new D({deliveryQueue:this._deliveryQueue}));onDidContentSizeChange=this._onDidContentSizeChange.event;_onDidScrollChange=this._register(new D({deliveryQueue:this._deliveryQueue}));onDidScrollChange=this._onDidScrollChange.event;_onDidChangeViewZones=this._register(new D({deliveryQueue:this._deliveryQueue}));onDidChangeViewZones=this._onDidChangeViewZones.event;_onDidChangeHiddenAreas=this._register(new D({deliveryQueue:this._deliveryQueue}));onDidChangeHiddenAreas=this._onDidChangeHiddenAreas.event;_updateCounter=0;_onBeginUpdate=this._register(new D);onBeginUpdate=this._onBeginUpdate.event;_onEndUpdate=this._register(new D);onEndUpdate=this._onEndUpdate.event;get isSimpleWidget(){return this._configuration.isSimpleWidget}get contextMenuId(){return this._configuration.contextMenuId}_telemetryData;_domElement;_overflowWidgetsDomNode;_id;_configuration;_contributionsDisposable;_actions=new Map;_modelData;_instantiationService;_contextKeyService;get contextKeyService(){return this._contextKeyService}_notificationService;_codeEditorService;_commandService;_themeService;_focusTracker;_contentWidgets;_overlayWidgets;_glyphMarginWidgets;_decorationTypeKeysToIds;_decorationTypeSubtypes;_bannerDomNode=null;_dropIntoEditorDecorations=this.createDecorationsCollection();writeScreenReaderContent(t){this._modelData?.view.writeScreenReaderContent(t)}_createConfiguration(t,n,i,r){return new Uh(t,n,i,this._domElement,r)}getId(){return this.getEditorType()+":"+this._id}getEditorType(){return Rb.ICodeEditor}dispose(){this._codeEditorService.removeCodeEditor(this),this._focusTracker.dispose(),this._actions.clear(),this._contentWidgets={},this._overlayWidgets={},this._removeDecorationTypes(),this._postDetachModelCleanup(this._detachModel()),this._onDidDispose.fire(),super.dispose()}invokeWithinContext(t){return this._instantiationService.invokeFunction(t)}updateOptions(t){this._configuration.updateOptions(t||{})}getOptions(){return this._configuration.options}getOption(t){return this._configuration.options.get(t)}getRawOptions(){return this._configuration.getRawOptions()}getOverflowWidgetsDomNode(){return this._overflowWidgetsDomNode}getConfiguredWordAtPosition(t){return this._modelData?Zm.getWordAtPosition(this._modelData.model,this._configuration.options.get(133),this._configuration.options.get(132),t):null}getValue(t=null){if(!this._modelData)return"";let n=!!(t&&t.preserveBOM),i=0;return t&&t.lineEnding&&t.lineEnding===`
`?i=1:t&&t.lineEnding&&t.lineEnding===`\r
`&&(i=2),this._modelData.model.getValue(i,n)}setValue(t){try{if(this._beginUpdate(),!this._modelData)return;this._modelData.model.setValue(t)}finally{this._endUpdate()}}getModel(){return this._modelData?this._modelData.model:null}setModel(t=null){try{this._beginUpdate();let n=t;if(this._modelData===null&&n===null||this._modelData&&this._modelData.model===n)return;let i={oldModelUrl:this._modelData?.model.uri||null,newModelUrl:n?.uri||null};this._onWillChangeModel.fire(i);let r=this.hasTextFocus(),s=this._detachModel();this._attachModel(n),r&&this.hasModel()&&this.focus(),this._removeDecorationTypes(),this._onDidChangeModel.fire(i),this._postDetachModelCleanup(s),this._contributionsDisposable=this._contributions.onAfterModelAttached()}finally{this._endUpdate()}}_removeDecorationTypes(){if(this._decorationTypeKeysToIds={},this._decorationTypeSubtypes){for(let t in this._decorationTypeSubtypes){let n=this._decorationTypeSubtypes[t];for(let i in n)this._removeDecorationType(t+"-"+i)}this._decorationTypeSubtypes={}}}getVisibleRanges(){return this._modelData?this._modelData.viewModel.getVisibleRanges():[]}getVisibleRangesPlusViewportAboveBelow(){return this._modelData?this._modelData.viewModel.getVisibleRangesPlusViewportAboveBelow():[]}getWhitespaces(){return this._modelData?this._modelData.viewModel.viewLayout.getWhitespaces():[]}static _getVerticalOffsetAfterPosition(t,n,i,r){let s=t.model.validatePosition({lineNumber:n,column:i}),a=t.viewModel.coordinatesConverter.convertModelPositionToViewPosition(s);return t.viewModel.viewLayout.getVerticalOffsetAfterLineNumber(a.lineNumber,r)}getTopForLineNumber(t,n=!1){return this._modelData?ps._getVerticalOffsetForPosition(this._modelData,t,1,n):-1}getTopForPosition(t,n){return this._modelData?ps._getVerticalOffsetForPosition(this._modelData,t,n,!1):-1}static _getVerticalOffsetForPosition(t,n,i,r=!1){let s=t.model.validatePosition({lineNumber:n,column:i}),a=t.viewModel.coordinatesConverter.convertModelPositionToViewPosition(s);return t.viewModel.viewLayout.getVerticalOffsetForLineNumber(a.lineNumber,r)}getBottomForLineNumber(t,n=!1){if(!this._modelData)return-1;let i=this._modelData.model.getLineMaxColumn(t);return ps._getVerticalOffsetAfterPosition(this._modelData,t,i,n)}setHiddenAreas(t,n){this._modelData?.viewModel.setHiddenAreas(t.map(i=>P.lift(i)),n)}getVisibleColumnFromPosition(t){if(!this._modelData)return t.column;let n=this._modelData.model.validatePosition(t),i=this._modelData.model.getOptions().tabSize;return Vt.visibleColumnFromColumn(this._modelData.model.getLineContent(n.lineNumber),n.column,i)+1}getStatusbarColumn(t){if(!this._modelData)return t.column;let n=this._modelData.model.validatePosition(t),i=this._modelData.model.getOptions().tabSize;return Vt.toStatusbarColumn(this._modelData.model.getLineContent(n.lineNumber),n.column,i)}getPosition(){return this._modelData?this._modelData.viewModel.getPosition():null}setPosition(t,n="api"){if(this._modelData){if(!A.isIPosition(t))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(n,[{selectionStartLineNumber:t.lineNumber,selectionStartColumn:t.column,positionLineNumber:t.lineNumber,positionColumn:t.column}])}}_sendRevealRange(t,n,i,r){if(!this._modelData)return;if(!P.isIRange(t))throw new Error("Invalid arguments");let s=this._modelData.model.validateRange(t),a=this._modelData.viewModel.coordinatesConverter.convertModelRangeToViewRange(s);this._modelData.viewModel.revealRange("api",i,a,n,r)}revealLine(t,n=0){this._revealLine(t,0,n)}revealLineInCenter(t,n=0){this._revealLine(t,1,n)}revealLineInCenterIfOutsideViewport(t,n=0){this._revealLine(t,2,n)}revealLineNearTop(t,n=0){this._revealLine(t,5,n)}_revealLine(t,n,i){if(typeof t!="number")throw new Error("Invalid arguments");this._sendRevealRange(new P(t,1,t,1),n,!1,i)}revealPosition(t,n=0){this._revealPosition(t,0,!0,n)}revealPositionInCenter(t,n=0){this._revealPosition(t,1,!0,n)}revealPositionInCenterIfOutsideViewport(t,n=0){this._revealPosition(t,2,!0,n)}revealPositionNearTop(t,n=0){this._revealPosition(t,5,!0,n)}_revealPosition(t,n,i,r){if(!A.isIPosition(t))throw new Error("Invalid arguments");this._sendRevealRange(new P(t.lineNumber,t.column,t.lineNumber,t.column),n,i,r)}getSelection(){return this._modelData?this._modelData.viewModel.getSelection():null}getSelections(){return this._modelData?this._modelData.viewModel.getSelections():null}setSelection(t,n="api"){let i=$e.isISelection(t),r=P.isIRange(t);if(!i&&!r)throw new Error("Invalid arguments");if(i)this._setSelectionImpl(t,n);else if(r){let s={selectionStartLineNumber:t.startLineNumber,selectionStartColumn:t.startColumn,positionLineNumber:t.endLineNumber,positionColumn:t.endColumn};this._setSelectionImpl(s,n)}}_setSelectionImpl(t,n){if(!this._modelData)return;let i=new $e(t.selectionStartLineNumber,t.selectionStartColumn,t.positionLineNumber,t.positionColumn);this._modelData.viewModel.setSelections(n,[i])}revealLines(t,n,i=0){this._revealLines(t,n,0,i)}revealLinesInCenter(t,n,i=0){this._revealLines(t,n,1,i)}revealLinesInCenterIfOutsideViewport(t,n,i=0){this._revealLines(t,n,2,i)}revealLinesNearTop(t,n,i=0){this._revealLines(t,n,5,i)}_revealLines(t,n,i,r){if(typeof t!="number"||typeof n!="number")throw new Error("Invalid arguments");this._sendRevealRange(new P(t,1,n,1),i,!1,r)}revealRange(t,n=0,i=!1,r=!0){this._revealRange(t,i?1:0,r,n)}revealRangeInCenter(t,n=0){this._revealRange(t,1,!0,n)}revealRangeInCenterIfOutsideViewport(t,n=0){this._revealRange(t,2,!0,n)}revealRangeNearTop(t,n=0){this._revealRange(t,5,!0,n)}revealRangeNearTopIfOutsideViewport(t,n=0){this._revealRange(t,6,!0,n)}revealRangeAtTop(t,n=0){this._revealRange(t,3,!0,n)}_revealRange(t,n,i,r){if(!P.isIRange(t))throw new Error("Invalid arguments");this._sendRevealRange(P.lift(t),n,i,r)}setSelections(t,n="api",i=0){if(this._modelData){if(!t||t.length===0)throw new Error("Invalid arguments");for(let r=0,s=t.length;r<s;r++)if(!$e.isISelection(t[r]))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(n,t,i)}}getContentWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getContentWidth():-1}getScrollWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollWidth():-1}getScrollLeft(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollLeft():-1}getContentHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getContentHeight():-1}getScrollHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollHeight():-1}getScrollTop(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollTop():-1}setScrollLeft(t,n=1){if(this._modelData){if(typeof t!="number")throw new Error("Invalid arguments");this._modelData.viewModel.viewLayout.setScrollPosition({scrollLeft:t},n)}}setScrollTop(t,n=1){if(this._modelData){if(typeof t!="number")throw new Error("Invalid arguments");this._modelData.viewModel.viewLayout.setScrollPosition({scrollTop:t},n)}}setScrollPosition(t,n=1){this._modelData&&this._modelData.viewModel.viewLayout.setScrollPosition(t,n)}hasPendingScrollAnimation(){return this._modelData?this._modelData.viewModel.viewLayout.hasPendingScrollAnimation():!1}saveViewState(){if(!this._modelData)return null;let t=this._contributions.saveViewState(),n=this._modelData.viewModel.saveCursorState(),i=this._modelData.viewModel.saveState();return{cursorState:n,viewState:i,contributionsState:t}}restoreViewState(t){if(!this._modelData||!this._modelData.hasRealView)return;let n=t;if(n&&n.cursorState&&n.viewState){let i=n.cursorState;Array.isArray(i)?i.length>0&&this._modelData.viewModel.restoreCursorState(i):this._modelData.viewModel.restoreCursorState([i]),this._contributions.restoreViewState(n.contributionsState||{});let r=this._modelData.viewModel.reduceRestoreState(n.viewState);this._modelData.view.restoreState(r)}}handleInitialized(){this._getViewModel()?.visibleLinesStabilized()}onVisible(){this._modelData?.view.refreshFocusState()}onHide(){this._modelData?.view.refreshFocusState(),this._focusTracker.refreshState()}getContribution(t){return this._contributions.get(t)}getActions(){return Array.from(this._actions.values())}getSupportedActions(){let t=this.getActions();return t=t.filter(n=>n.isSupported()),t}getAction(t){return this._actions.get(t)||null}trigger(t,n,i){i=i||{};try{switch(this._beginUpdate(),n){case"compositionStart":this._startComposition();return;case"compositionEnd":this._endComposition(t);return;case"type":{let s=i;this._type(t,s.text||"");return}case"replacePreviousChar":{let s=i;this._compositionType(t,s.text||"",s.replaceCharCnt||0,0,0);return}case"compositionType":{let s=i;this._compositionType(t,s.text||"",s.replacePrevCharCnt||0,s.replaceNextCharCnt||0,s.positionDelta||0);return}case"paste":{let s=i;this._paste(t,s.text||"",s.pasteOnNewLine||!1,s.multicursorText||null,s.mode||null,s.clipboardEvent);return}case"cut":this._cut(t);return}let r=this.getAction(n);if(r){Promise.resolve(r.run(i)).then(void 0,qe);return}if(!this._modelData||this._triggerEditorCommand(t,n,i))return;this._triggerCommand(n,i)}finally{this._endUpdate()}}_triggerCommand(t,n){this._commandService.executeCommand(t,n)}_startComposition(){this._modelData&&(this._modelData.viewModel.startComposition(),this._onDidCompositionStart.fire())}_endComposition(t){this._modelData&&(this._modelData.viewModel.endComposition(t),this._onDidCompositionEnd.fire())}_type(t,n){!this._modelData||n.length===0||(t==="keyboard"&&this._onWillType.fire(n),this._modelData.viewModel.type(n,t),t==="keyboard"&&this._onDidType.fire(n))}_compositionType(t,n,i,r,s){this._modelData&&this._modelData.viewModel.compositionType(n,i,r,s,t)}_paste(t,n,i,r,s,a){if(!this._modelData)return;let l=this._modelData.viewModel,d=l.getSelection().getStartPosition();l.paste(n,i,r,t);let c=l.getSelection().getStartPosition();t==="keyboard"&&this._onDidPaste.fire({clipboardEvent:a,range:new P(d.lineNumber,d.column,c.lineNumber,c.column),languageId:s})}_cut(t){this._modelData&&this._modelData.viewModel.cut(t)}_triggerEditorCommand(t,n,i){let r=op.getEditorCommand(n);return r?(i=i||{},i.source=t,this._instantiationService.invokeFunction(s=>{Promise.resolve(r.runEditorCommand(s,this,i)).then(void 0,qe)}),!0):!1}_getViewModel(){return this._modelData?this._modelData.viewModel:null}pushUndoStop(){return!this._modelData||this._configuration.options.get(93)?!1:(this._modelData.model.pushStackElement(),!0)}popUndoStop(){return!this._modelData||this._configuration.options.get(93)?!1:(this._modelData.model.popStackElement(),!0)}executeEdits(t,n,i){if(!this._modelData||this._configuration.options.get(93))return!1;let r;return i?Array.isArray(i)?r=()=>i:r=i:r=()=>null,this._modelData.viewModel.executeEdits(t,n,r),!0}executeCommand(t,n){this._modelData&&this._modelData.viewModel.executeCommand(n,t)}executeCommands(t,n){this._modelData&&this._modelData.viewModel.executeCommands(n,t)}createDecorationsCollection(t){return new iN(this,t)}changeDecorations(t){return this._modelData?this._modelData.model.changeDecorations(t,this._id):null}getLineDecorations(t){return this._modelData?this._modelData.model.getLineDecorations(t,this._id,hu(this._configuration.options)):null}getDecorationsInRange(t){return this._modelData?this._modelData.model.getDecorationsInRange(t,this._id,hu(this._configuration.options)):null}deltaDecorations(t,n){return this._modelData?t.length===0&&n.length===0?t:this._modelData.model.deltaDecorations(t,n,this._id):[]}removeDecorations(t){!this._modelData||t.length===0||this._modelData.model.changeDecorations(n=>{n.deltaDecorations(t,[])})}setDecorationsByType(t,n,i){let r={},s=this._decorationTypeSubtypes[n]||{};this._decorationTypeSubtypes[n]=r;let a=[];for(let d of i){let c=n;if(d.renderOptions){let p=Zr(d.renderOptions).toString(16);c=n+"-"+p,!s[p]&&!r[p]&&this._registerDecorationType(t,c,d.renderOptions,n),r[p]=!0}let u=this._resolveDecorationOptions(c,!!d.hoverMessage);d.hoverMessage&&(u.hoverMessage=d.hoverMessage),a.push({range:d.range,options:u})}for(let d in s)r[d]||this._removeDecorationType(n+"-"+d);let l=this._decorationTypeKeysToIds[n]||[];this.changeDecorations(d=>this._decorationTypeKeysToIds[n]=d.deltaDecorations(l,a))}setDecorationsByTypeFast(t,n){let i=this._decorationTypeSubtypes[t]||{};for(let l in i)this._removeDecorationType(t+"-"+l);this._decorationTypeSubtypes[t]={};let r=En.createDynamic(this._resolveDecorationOptions(t,!1)),s=new Array(n.length);for(let l=0,d=n.length;l<d;l++)s[l]={range:n[l],options:r};let a=this._decorationTypeKeysToIds[t]||[];this.changeDecorations(l=>this._decorationTypeKeysToIds[t]=l.deltaDecorations(a,s))}removeDecorationsByType(t){let n=this._decorationTypeKeysToIds[t];n&&this.changeDecorations(i=>i.deltaDecorations(n,[])),this._decorationTypeKeysToIds.hasOwnProperty(t)&&delete this._decorationTypeKeysToIds[t],this._decorationTypeSubtypes.hasOwnProperty(t)&&delete this._decorationTypeSubtypes[t]}getLayoutInfo(){return this._configuration.options.get(147)}createOverviewRuler(t){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.createOverviewRuler(t)}getContainerDomNode(){return this._domElement}getDomNode(){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.domNode.domNode}delegateVerticalScrollbarPointerDown(t){!this._modelData||!this._modelData.hasRealView||this._modelData.view.delegateVerticalScrollbarPointerDown(t)}delegateScrollFromMouseWheelEvent(t){!this._modelData||!this._modelData.hasRealView||this._modelData.view.delegateScrollFromMouseWheelEvent(t)}layout(t,n=!1){this._configuration.observeContainer(t),n||this.render()}focus(){!this._modelData||!this._modelData.hasRealView||this._modelData.view.focus()}hasTextFocus(){return!this._modelData||!this._modelData.hasRealView?!1:this._modelData.view.isFocused()}hasWidgetFocus(){return this._focusTracker&&this._focusTracker.hasFocus()}addContentWidget(t){let n={widget:t,position:t.getPosition()};this._contentWidgets.hasOwnProperty(t.getId())&&console.warn("Overwriting a content widget with the same id:"+t.getId()),this._contentWidgets[t.getId()]=n,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addContentWidget(n)}layoutContentWidget(t){let n=t.getId();if(this._contentWidgets.hasOwnProperty(n)){let i=this._contentWidgets[n];i.position=t.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutContentWidget(i)}}removeContentWidget(t){let n=t.getId();if(this._contentWidgets.hasOwnProperty(n)){let i=this._contentWidgets[n];delete this._contentWidgets[n],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeContentWidget(i)}}addOverlayWidget(t){let n={widget:t,position:t.getPosition()};this._overlayWidgets.hasOwnProperty(t.getId())&&console.warn("Overwriting an overlay widget with the same id."),this._overlayWidgets[t.getId()]=n,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addOverlayWidget(n)}layoutOverlayWidget(t){let n=t.getId();if(this._overlayWidgets.hasOwnProperty(n)){let i=this._overlayWidgets[n];i.position=t.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutOverlayWidget(i)}}removeOverlayWidget(t){let n=t.getId();if(this._overlayWidgets.hasOwnProperty(n)){let i=this._overlayWidgets[n];delete this._overlayWidgets[n],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeOverlayWidget(i)}}addGlyphMarginWidget(t){let n={widget:t,position:t.getPosition()};this._glyphMarginWidgets.hasOwnProperty(t.getId())&&console.warn("Overwriting a glyph margin widget with the same id."),this._glyphMarginWidgets[t.getId()]=n,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addGlyphMarginWidget(n)}layoutGlyphMarginWidget(t){let n=t.getId();if(this._glyphMarginWidgets.hasOwnProperty(n)){let i=this._glyphMarginWidgets[n];i.position=t.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutGlyphMarginWidget(i)}}removeGlyphMarginWidget(t){let n=t.getId();if(this._glyphMarginWidgets.hasOwnProperty(n)){let i=this._glyphMarginWidgets[n];delete this._glyphMarginWidgets[n],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeGlyphMarginWidget(i)}}changeViewZones(t){!this._modelData||!this._modelData.hasRealView||this._modelData.view.change(t)}getTargetAtClientPoint(t,n){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.getTargetAtClientPoint(t,n)}getScrolledVisiblePosition(t){if(!this._modelData||!this._modelData.hasRealView)return null;let n=this._modelData.model.validatePosition(t),i=this._configuration.options,r=i.get(147),s=ps._getVerticalOffsetForPosition(this._modelData,n.lineNumber,n.column)-this.getScrollTop(),a=this._modelData.view.getOffsetForColumn(n.lineNumber,n.column)+r.glyphMarginWidth+r.lineNumbersWidth+r.decorationsWidth-this.getScrollLeft();return{top:s,left:a,height:i.get(68)}}getOffsetForColumn(t,n){return!this._modelData||!this._modelData.hasRealView?-1:this._modelData.view.getOffsetForColumn(t,n)}render(t=!1){!this._modelData||!this._modelData.hasRealView||this._modelData.viewModel.batchEvents(()=>{this._modelData.view.render(!0,t)})}setAriaOptions(t){!this._modelData||!this._modelData.hasRealView||this._modelData.view.setAriaOptions(t)}applyFontInfo(t){on(t,this._configuration.options.get(51))}setBanner(t,n){this._bannerDomNode&&this._domElement.contains(this._bannerDomNode)&&this._bannerDomNode.remove(),this._bannerDomNode=t,this._configuration.setReservedHeight(t?n:0),this._bannerDomNode&&this._domElement.prepend(this._bannerDomNode)}_attachModel(t){if(!t){this._modelData=null;return}let n=[];this._domElement.setAttribute("data-mode-id",t.getLanguageId()),this._configuration.setIsDominatedByLongLines(t.isDominatedByLongLines()),this._configuration.setModelLineCount(t.getLineCount());let i=t.onBeforeAttached(),r=new k_(this._id,this._configuration,t,Jw.create(Ce(this._domElement)),n_.create(this._configuration.options),l=>ni(Ce(this._domElement),l),this.languageConfigurationService,this._themeService,i,{batchChanges:l=>{try{return this._beginUpdate(),l()}finally{this._endUpdate()}}});n.push(t.onWillDispose(()=>this.setModel(null))),n.push(r.onEvent(l=>{switch(l.kind){case 0:this._onDidContentSizeChange.fire(l);break;case 1:this._editorTextFocus.setValue(l.hasFocus);break;case 2:this._onDidScrollChange.fire(l);break;case 3:this._onDidChangeViewZones.fire();break;case 4:this._onDidChangeHiddenAreas.fire();break;case 5:this._onDidAttemptReadOnlyEdit.fire();break;case 6:{if(l.reachedMaxCursorCount){let p=this.getOption(81),h=m("cursors.maximum","The number of cursors has been limited to {0}. Consider using [find and replace](https://code.visualstudio.com/docs/editor/codebasics#_find-and-replace) for larger changes or increase the editor multi cursor limit setting.",p);this._notificationService.prompt(UC.Warning,h,[{label:"Find and Replace",run:()=>{this._commandService.executeCommand("editor.action.startFindReplaceAction")}},{label:m("goToSetting","Increase Multi Cursor Limit"),run:()=>{this._commandService.executeCommand("workbench.action.openSettings2",{query:"editor.multiCursorLimit"})}}])}let d=[];for(let p=0,h=l.selections.length;p<h;p++)d[p]=l.selections[p].getPosition();let c={position:d[0],secondaryPositions:d.slice(1),reason:l.reason,source:l.source};this._onDidChangeCursorPosition.fire(c);let u={selection:l.selections[0],secondarySelections:l.selections.slice(1),modelVersionId:l.modelVersionId,oldSelections:l.oldSelections,oldModelVersionId:l.oldModelVersionId,source:l.source,reason:l.reason};this._onDidChangeCursorSelection.fire(u);break}case 7:this._onDidChangeModelDecorations.fire(l.event);break;case 8:this._domElement.setAttribute("data-mode-id",t.getLanguageId()),this._onDidChangeModelLanguage.fire(l.event);break;case 9:this._onDidChangeModelLanguageConfiguration.fire(l.event);break;case 10:this._onDidChangeModelContent.fire(l.event);break;case 11:this._onDidChangeModelOptions.fire(l.event);break;case 12:this._onDidChangeModelTokens.fire(l.event);break}}));let[s,a]=this._createView(r);if(a){this._domElement.appendChild(s.domNode.domNode);let l=Object.keys(this._contentWidgets);for(let d=0,c=l.length;d<c;d++){let u=l[d];s.addContentWidget(this._contentWidgets[u])}l=Object.keys(this._overlayWidgets);for(let d=0,c=l.length;d<c;d++){let u=l[d];s.addOverlayWidget(this._overlayWidgets[u])}l=Object.keys(this._glyphMarginWidgets);for(let d=0,c=l.length;d<c;d++){let u=l[d];s.addGlyphMarginWidget(this._glyphMarginWidgets[u])}s.render(!1,!0),s.domNode.domNode.setAttribute("data-uri",t.uri.toString())}this._modelData=new JO(t,r,s,a,n,i)}_createView(t){let n;this.isSimpleWidget?n={paste:(s,a,l,d)=>{this._paste("keyboard",s,a,l,d)},type:s=>{this._type("keyboard",s)},compositionType:(s,a,l,d)=>{this._compositionType("keyboard",s,a,l,d)},startComposition:()=>{this._startComposition()},endComposition:()=>{this._endComposition("keyboard")},cut:()=>{this._cut("keyboard")}}:n={paste:(s,a,l,d)=>{let c={text:s,pasteOnNewLine:a,multicursorText:l,mode:d};this._commandService.executeCommand("paste",c)},type:s=>{let a={text:s};this._commandService.executeCommand("type",a)},compositionType:(s,a,l,d)=>{if(l||d){let c={text:s,replacePrevCharCnt:a,replaceNextCharCnt:l,positionDelta:d};this._commandService.executeCommand("compositionType",c)}else{let c={text:s,replaceCharCnt:a};this._commandService.executeCommand("replacePreviousChar",c)}},startComposition:()=>{this._commandService.executeCommand("compositionStart",{})},endComposition:()=>{this._commandService.executeCommand("compositionEnd",{})},cut:()=>{this._commandService.executeCommand("cut",{})}};let i=new ig(t.coordinatesConverter);return i.onKeyDown=s=>this._onKeyDown.fire(s),i.onKeyUp=s=>this._onKeyUp.fire(s),i.onContextMenu=s=>this._onContextMenu.fire(s),i.onMouseMove=s=>this._onMouseMove.fire(s),i.onMouseLeave=s=>this._onMouseLeave.fire(s),i.onMouseDown=s=>this._onMouseDown.fire(s),i.onMouseUp=s=>this._onMouseUp.fire(s),i.onMouseDrag=s=>this._onMouseDrag.fire(s),i.onMouseDrop=s=>this._onMouseDrop.fire(s),i.onMouseDropCanceled=s=>this._onMouseDropCanceled.fire(s),i.onMouseWheel=s=>this._onMouseWheel.fire(s),[new bg(n,this._configuration,this._themeService.getColorTheme(),t,i,this._overflowWidgetsDomNode,this._instantiationService),!0]}_postDetachModelCleanup(t){t?.removeAllDecorationsWithOwnerId(this._id)}_detachModel(){if(this._contributionsDisposable?.dispose(),this._contributionsDisposable=void 0,!this._modelData)return null;let t=this._modelData.model,n=this._modelData.hasRealView?this._modelData.view.domNode.domNode:null;return this._modelData.dispose(),this._modelData=null,this._domElement.removeAttribute("data-mode-id"),n&&this._domElement.contains(n)&&n.remove(),this._bannerDomNode&&this._domElement.contains(this._bannerDomNode)&&this._bannerDomNode.remove(),t}_registerDecorationType(t,n,i,r){this._codeEditorService.registerDecorationType(t,n,i,r,this)}_removeDecorationType(t){this._codeEditorService.removeDecorationType(t)}_resolveDecorationOptions(t,n){return this._codeEditorService.resolveDecorationOptions(t,n)}getTelemetryData(){return this._telemetryData}hasModel(){return this._modelData!==null}showDropIndicatorAt(t){let n=[{range:new P(t.lineNumber,t.column,t.lineNumber,t.column),options:ps.dropIntoEditorDecorationOptions}];this._dropIntoEditorDecorations.set(n),this.revealPosition(t,1)}removeDropIndicator(){this._dropIntoEditorDecorations.clear()}setContextValue(t,n){this._contextKeyService.createKey(t,n)}_beginUpdate(){this._updateCounter++,this._updateCounter===1&&this._onBeginUpdate.fire()}_endUpdate(){this._updateCounter--,this._updateCounter===0&&this._onEndUpdate.fire()}};ps=O([x(3,Oe),x(4,$a),x(5,Ji),x(6,_t),x(7,Ko),x(8,fu),x(9,vo),x(10,xl),x(11,e5)],ps);var eq=0,JO=class{constructor(e,t,n,i,r,s){this.model=e;this.viewModel=t;this.view=n;this.hasRealView=i;this.listenersToRemove=r;this.attachedView=s}dispose(){wt(this.listenersToRemove),this.model.onBeforeDetached(this.attachedView),this.hasRealView&&this.view.dispose(),this.viewModel.dispose()}};var P_=class extends F{constructor(t){super();this._emitterOptions=t;this._value=0}_onDidChangeToTrue=this._register(new D(this._emitterOptions));onDidChangeToTrue=this._onDidChangeToTrue.event;_onDidChangeToFalse=this._register(new D(this._emitterOptions));onDidChangeToFalse=this._onDidChangeToFalse.event;_value;setValue(t){let n=t?2:1;this._value!==n&&(this._value=n,this._value===2?this._onDidChangeToTrue.fire():this._value===1&&this._onDidChangeToFalse.fire())}},Ci=class extends D{constructor(t,n){super({deliveryQueue:n});this._contributions=t}fire(t){this._contributions.onBeforeInteractionEvent(),super.fire(t)}},eN=class extends F{_editor;_editorSimpleInput;_editorFocus;_textInputFocus;_editorTextFocus;_tabMovesFocus;_editorReadonly;_inDiffEditor;_editorColumnSelection;_hasMultipleSelections;_hasNonEmptySelection;_canUndo;_canRedo;constructor(e,t){super(),this._editor=e,t.createKey("editorId",e.getId()),this._editorSimpleInput=ge.editorSimpleInput.bindTo(t),this._editorFocus=ge.focus.bindTo(t),this._textInputFocus=ge.textInputFocus.bindTo(t),this._editorTextFocus=ge.editorTextFocus.bindTo(t),this._tabMovesFocus=ge.tabMovesFocus.bindTo(t),this._editorReadonly=ge.readOnly.bindTo(t),this._inDiffEditor=ge.inDiffEditor.bindTo(t),this._editorColumnSelection=ge.columnSelection.bindTo(t),this._hasMultipleSelections=ge.hasMultipleSelections.bindTo(t),this._hasNonEmptySelection=ge.hasNonEmptySelection.bindTo(t),this._canUndo=ge.canUndo.bindTo(t),this._canRedo=ge.canRedo.bindTo(t),this._register(this._editor.onDidChangeConfiguration(()=>this._updateFromConfig())),this._register(this._editor.onDidChangeCursorSelection(()=>this._updateFromSelection())),this._register(this._editor.onDidFocusEditorWidget(()=>this._updateFromFocus())),this._register(this._editor.onDidBlurEditorWidget(()=>this._updateFromFocus())),this._register(this._editor.onDidFocusEditorText(()=>this._updateFromFocus())),this._register(this._editor.onDidBlurEditorText(()=>this._updateFromFocus())),this._register(this._editor.onDidChangeModel(()=>this._updateFromModel())),this._register(this._editor.onDidChangeConfiguration(()=>this._updateFromModel())),this._register(Wh.onDidChangeTabFocus(n=>this._tabMovesFocus.set(n))),this._updateFromConfig(),this._updateFromSelection(),this._updateFromFocus(),this._updateFromModel(),this._editorSimpleInput.set(this._editor.isSimpleWidget)}_updateFromConfig(){let e=this._editor.getOptions();this._tabMovesFocus.set(Wh.getTabFocusMode()),this._editorReadonly.set(e.get(93)),this._inDiffEditor.set(e.get(62)),this._editorColumnSelection.set(e.get(22))}_updateFromSelection(){let e=this._editor.getSelections();e?(this._hasMultipleSelections.set(e.length>1),this._hasNonEmptySelection.set(e.some(t=>!t.isEmpty()))):(this._hasMultipleSelections.reset(),this._hasNonEmptySelection.reset())}_updateFromFocus(){this._editorFocus.set(this._editor.hasWidgetFocus()&&!this._editor.isSimpleWidget),this._editorTextFocus.set(this._editor.hasTextFocus()&&!this._editor.isSimpleWidget),this._textInputFocus.set(this._editor.hasTextFocus())}_updateFromModel(){let e=this._editor.getModel();this._canUndo.set(!!(e&&e.canUndo())),this._canRedo.set(!!(e&&e.canRedo()))}},tN=class extends F{constructor(t,n,i){super();this._editor=t;this._contextKeyService=n;this._languageFeaturesService=i;this._langId=ge.languageId.bindTo(n),this._hasCompletionItemProvider=ge.hasCompletionItemProvider.bindTo(n),this._hasCodeActionsProvider=ge.hasCodeActionsProvider.bindTo(n),this._hasCodeLensProvider=ge.hasCodeLensProvider.bindTo(n),this._hasDefinitionProvider=ge.hasDefinitionProvider.bindTo(n),this._hasDeclarationProvider=ge.hasDeclarationProvider.bindTo(n),this._hasImplementationProvider=ge.hasImplementationProvider.bindTo(n),this._hasTypeDefinitionProvider=ge.hasTypeDefinitionProvider.bindTo(n),this._hasHoverProvider=ge.hasHoverProvider.bindTo(n),this._hasDocumentHighlightProvider=ge.hasDocumentHighlightProvider.bindTo(n),this._hasDocumentSymbolProvider=ge.hasDocumentSymbolProvider.bindTo(n),this._hasReferenceProvider=ge.hasReferenceProvider.bindTo(n),this._hasRenameProvider=ge.hasRenameProvider.bindTo(n),this._hasSignatureHelpProvider=ge.hasSignatureHelpProvider.bindTo(n),this._hasInlayHintsProvider=ge.hasInlayHintsProvider.bindTo(n),this._hasDocumentFormattingProvider=ge.hasDocumentFormattingProvider.bindTo(n),this._hasDocumentSelectionFormattingProvider=ge.hasDocumentSelectionFormattingProvider.bindTo(n),this._hasMultipleDocumentFormattingProvider=ge.hasMultipleDocumentFormattingProvider.bindTo(n),this._hasMultipleDocumentSelectionFormattingProvider=ge.hasMultipleDocumentSelectionFormattingProvider.bindTo(n),this._isInEmbeddedEditor=ge.isInEmbeddedEditor.bindTo(n);let r=()=>this._update();this._register(t.onDidChangeModel(r)),this._register(t.onDidChangeModelLanguage(r)),this._register(i.completionProvider.onDidChange(r)),this._register(i.codeActionProvider.onDidChange(r)),this._register(i.codeLensProvider.onDidChange(r)),this._register(i.definitionProvider.onDidChange(r)),this._register(i.declarationProvider.onDidChange(r)),this._register(i.implementationProvider.onDidChange(r)),this._register(i.typeDefinitionProvider.onDidChange(r)),this._register(i.hoverProvider.onDidChange(r)),this._register(i.documentHighlightProvider.onDidChange(r)),this._register(i.documentSymbolProvider.onDidChange(r)),this._register(i.referenceProvider.onDidChange(r)),this._register(i.renameProvider.onDidChange(r)),this._register(i.documentFormattingEditProvider.onDidChange(r)),this._register(i.documentRangeFormattingEditProvider.onDidChange(r)),this._register(i.signatureHelpProvider.onDidChange(r)),this._register(i.inlayHintsProvider.onDidChange(r)),r()}_langId;_hasCompletionItemProvider;_hasCodeActionsProvider;_hasCodeLensProvider;_hasDefinitionProvider;_hasDeclarationProvider;_hasImplementationProvider;_hasTypeDefinitionProvider;_hasHoverProvider;_hasDocumentHighlightProvider;_hasDocumentSymbolProvider;_hasReferenceProvider;_hasRenameProvider;_hasDocumentFormattingProvider;_hasDocumentSelectionFormattingProvider;_hasMultipleDocumentFormattingProvider;_hasMultipleDocumentSelectionFormattingProvider;_hasSignatureHelpProvider;_hasInlayHintsProvider;_isInEmbeddedEditor;dispose(){super.dispose()}reset(){this._contextKeyService.bufferChangeEvents(()=>{this._langId.reset(),this._hasCompletionItemProvider.reset(),this._hasCodeActionsProvider.reset(),this._hasCodeLensProvider.reset(),this._hasDefinitionProvider.reset(),this._hasDeclarationProvider.reset(),this._hasImplementationProvider.reset(),this._hasTypeDefinitionProvider.reset(),this._hasHoverProvider.reset(),this._hasDocumentHighlightProvider.reset(),this._hasDocumentSymbolProvider.reset(),this._hasReferenceProvider.reset(),this._hasRenameProvider.reset(),this._hasDocumentFormattingProvider.reset(),this._hasDocumentSelectionFormattingProvider.reset(),this._hasSignatureHelpProvider.reset(),this._isInEmbeddedEditor.reset()})}_update(){let t=this._editor.getModel();if(!t){this.reset();return}this._contextKeyService.bufferChangeEvents(()=>{this._langId.set(t.getLanguageId()),this._hasCompletionItemProvider.set(this._languageFeaturesService.completionProvider.has(t)),this._hasCodeActionsProvider.set(this._languageFeaturesService.codeActionProvider.has(t)),this._hasCodeLensProvider.set(this._languageFeaturesService.codeLensProvider.has(t)),this._hasDefinitionProvider.set(this._languageFeaturesService.definitionProvider.has(t)),this._hasDeclarationProvider.set(this._languageFeaturesService.declarationProvider.has(t)),this._hasImplementationProvider.set(this._languageFeaturesService.implementationProvider.has(t)),this._hasTypeDefinitionProvider.set(this._languageFeaturesService.typeDefinitionProvider.has(t)),this._hasHoverProvider.set(this._languageFeaturesService.hoverProvider.has(t)),this._hasDocumentHighlightProvider.set(this._languageFeaturesService.documentHighlightProvider.has(t)),this._hasDocumentSymbolProvider.set(this._languageFeaturesService.documentSymbolProvider.has(t)),this._hasReferenceProvider.set(this._languageFeaturesService.referenceProvider.has(t)),this._hasRenameProvider.set(this._languageFeaturesService.renameProvider.has(t)),this._hasSignatureHelpProvider.set(this._languageFeaturesService.signatureHelpProvider.has(t)),this._hasInlayHintsProvider.set(this._languageFeaturesService.inlayHintsProvider.has(t)),this._hasDocumentFormattingProvider.set(this._languageFeaturesService.documentFormattingEditProvider.has(t)||this._languageFeaturesService.documentRangeFormattingEditProvider.has(t)),this._hasDocumentSelectionFormattingProvider.set(this._languageFeaturesService.documentRangeFormattingEditProvider.has(t)),this._hasMultipleDocumentFormattingProvider.set(this._languageFeaturesService.documentFormattingEditProvider.all(t).length+this._languageFeaturesService.documentRangeFormattingEditProvider.all(t).length>1),this._hasMultipleDocumentSelectionFormattingProvider.set(this._languageFeaturesService.documentRangeFormattingEditProvider.all(t).length>1),this._isInEmbeddedEditor.set(t.uri.scheme===Le.walkThroughSnippet||t.uri.scheme===Le.vscodeChatCodeBlock)})}},nN=class extends F{_hasDomElementFocus;_domFocusTracker;_overflowWidgetsDomNode;_onChange=this._register(new D);onChange=this._onChange.event;_overflowWidgetsDomNodeHasFocus;_hadFocus=void 0;constructor(e,t){super(),this._hasDomElementFocus=!1,this._domFocusTracker=this._register(_l(e)),this._overflowWidgetsDomNodeHasFocus=!1,this._register(this._domFocusTracker.onDidFocus(()=>{this._hasDomElementFocus=!0,this._update()})),this._register(this._domFocusTracker.onDidBlur(()=>{this._hasDomElementFocus=!1,this._update()})),t&&(this._overflowWidgetsDomNode=this._register(_l(t)),this._register(this._overflowWidgetsDomNode.onDidFocus(()=>{this._overflowWidgetsDomNodeHasFocus=!0,this._update()})),this._register(this._overflowWidgetsDomNode.onDidBlur(()=>{this._overflowWidgetsDomNodeHasFocus=!1,this._update()})))}_update(){let e=this._hasDomElementFocus||this._overflowWidgetsDomNodeHasFocus;this._hadFocus!==e&&(this._hadFocus=e,this._onChange.fire(void 0))}hasFocus(){return this._hadFocus??!1}refreshState(){this._domFocusTracker.refreshState(),this._overflowWidgetsDomNode?.refreshState?.()}},iN=class{constructor(e,t){this._editor=e;Array.isArray(t)&&t.length>0&&this.set(t)}_decorationIds=[];_isChangingDecorations=!1;get length(){return this._decorationIds.length}onDidChange(e,t,n){return this._editor.onDidChangeModelDecorations(i=>{this._isChangingDecorations||e.call(t,i)},n)}getRange(e){return!this._editor.hasModel()||e>=this._decorationIds.length?null:this._editor.getModel().getDecorationRange(this._decorationIds[e])}getRanges(){if(!this._editor.hasModel())return[];let e=this._editor.getModel(),t=[];for(let n of this._decorationIds){let i=e.getDecorationRange(n);i&&t.push(i)}return t}has(e){return this._decorationIds.includes(e.id)}clear(){this._decorationIds.length!==0&&this.set([])}set(e){try{this._isChangingDecorations=!0,this._editor.changeDecorations(t=>{this._decorationIds=t.deltaDecorations(this._decorationIds,e)})}finally{this._isChangingDecorations=!1}return this._decorationIds}append(e){let t=[];try{this._isChangingDecorations=!0,this._editor.changeDecorations(n=>{t=n.deltaDecorations([],e),this._decorationIds=this._decorationIds.concat(t)})}finally{this._isChangingDecorations=!1}return t}},tq=encodeURIComponent("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 6 3' enable-background='new 0 0 6 3' height='3' width='6'><g fill='"),nq=encodeURIComponent("'><polygon points='5.5,0 2.5,3 1.1,3 4.1,0'/><polygon points='4,0 6,2 6,0.6 5.4,0'/><polygon points='0,2 1,3 2.4,3 0,0.6'/></g></svg>");function QO(o){return tq+encodeURIComponent(o.toString())+nq}var iq=encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" height="3" width="12"><g fill="'),oq=encodeURIComponent('"><circle cx="1" cy="1" r="1"/><circle cx="5" cy="1" r="1"/><circle cx="9" cy="1" r="1"/></g></svg>');function rq(o){return iq+encodeURIComponent(o.toString())+oq}To((o,e)=>{let t=o.getColor(Mu);t&&e.addRule(`.monaco-editor .squiggly-error { background: url("data:image/svg+xml,${QO(t)}") repeat-x bottom left; }`);let n=o.getColor(Eo);n&&e.addRule(`.monaco-editor .squiggly-warning { background: url("data:image/svg+xml,${QO(n)}") repeat-x bottom left; }`);let i=o.getColor(mr);i&&e.addRule(`.monaco-editor .squiggly-info { background: url("data:image/svg+xml,${QO(i)}") repeat-x bottom left; }`);let r=o.getColor(n2);r&&e.addRule(`.monaco-editor .squiggly-hint { background: url("data:image/svg+xml,${rq(r)}") no-repeat bottom left; }`);let s=o.getColor(eU);s&&e.addRule(`.monaco-editor.showUnused .squiggly-inline-unnecessary { opacity: ${s.rgba.a}; }`)});function a5(o,e,t,n){if(o.length===0)return e;if(e.length===0)return o;let i=[],r=0,s=0;for(;r<o.length&&s<e.length;){let a=o[r],l=e[s],d=t(a),c=t(l);d<c?(i.push(a),r++):d>c?(i.push(l),s++):(i.push(n(a,l)),r++,s++)}for(;r<o.length;)i.push(o[r]),r++;for(;s<e.length;)i.push(e[s]),s++;return i}function vg(o,e){let t=new ee,n=o.createDecorationsCollection();return t.add(hl({debugName:()=>`Apply decorations from ${e.debugName}`},i=>{let r=e.read(i);n.set(r)})),t.add({dispose:()=>{n.clear()}}),t}function Ep(o,e){return o.appendChild(e),le(()=>{e.remove()})}function l5(o,e){return o.prepend(e),le(()=>{e.remove()})}var O_=class extends F{elementSizeObserver;_width;get width(){return this._width}_height;get height(){return this._height}_automaticLayout=!1;get automaticLayout(){return this._automaticLayout}constructor(e,t){super(),this.elementSizeObserver=this._register(new Bh(e,t)),this._width=at(this,this.elementSizeObserver.getWidth()),this._height=at(this,this.elementSizeObserver.getHeight()),this._register(this.elementSizeObserver.onDidChange(n=>Xt(i=>{this._width.set(this.elementSizeObserver.getWidth(),i),this._height.set(this.elementSizeObserver.getHeight(),i)})))}observe(e){this.elementSizeObserver.observe(e)}setAutomaticLayout(e){this._automaticLayout=e,e?this.elementSizeObserver.startObserving():this.elementSizeObserver.stopObserving()}};function sN(o,e,t){let n=e.get(),i=n,r=n,s=at("animatedValue",n),a=-1,l=300,d;t.add(cd({createEmptyChangeSummary:()=>({animate:!1}),handleChange:(u,p)=>(u.didChange(e)&&(p.animate=p.animate||u.change),!0)},(u,p)=>{d!==void 0&&(o.cancelAnimationFrame(d),d=void 0),i=r,n=e.read(u),a=Date.now()-(p.animate?0:l),c()}));function c(){let u=Date.now()-a;r=Math.floor(sq(u,i,n-i,l)),u<l?d=o.requestAnimationFrame(c):r=n,s.set(r,void 0)}return s}function sq(o,e,t,n){return o===n?e+t:t*(-Math.pow(2,-10*o/n)+1)+e}var Cp=class extends F{constructor(e,t,n){super(),this._register(new oN(e,n)),this._register(Kr(n,{height:t.actualHeight,top:t.actualTop}))}},Xa=class{constructor(e,t){this._afterLineNumber=e;this.heightInPx=t}domNode=document.createElement("div");_actualTop=at(this,void 0);_actualHeight=at(this,void 0);actualTop=this._actualTop;actualHeight=this._actualHeight;showInHiddenAreas=!0;get afterLineNumber(){return this._afterLineNumber.get()}onChange=this._afterLineNumber;onDomNodeTop=e=>{this._actualTop.set(e,void 0)};onComputedHeight=e=>{this._actualHeight.set(e,void 0)}},oN=class o{constructor(e,t){this._editor=e;this._domElement=t;this._editor.addOverlayWidget(this._overlayWidget)}static _counter=0;_overlayWidgetId=`managedOverlayWidget-${o._counter++}`;_overlayWidget={getId:()=>this._overlayWidgetId,getDomNode:()=>this._domElement,getPosition:()=>null};dispose(){this._editor.removeOverlayWidget(this._overlayWidget)}};function Kr(o,e){return rt(t=>{for(let[n,i]of Object.entries(e))i&&typeof i=="object"&&"read"in i&&(i=i.read(t)),typeof i=="number"&&(i=`${i}px`),n=n.replace(/[A-Z]/g,r=>"-"+r.toLowerCase()),o.style[n]=i})}function yg(o,e,t,n){let i=new ee,r=[];return i.add(Ei((s,a)=>{let l=e.read(s),d=new Map,c=new Map;t&&t(!0),o.changeViewZones(u=>{for(let p of r)u.removeZone(p),n?.delete(p);r.length=0;for(let p of l){let h=u.addZone(p);p.setZoneId&&p.setZoneId(h),r.push(h),n?.add(h),d.set(p,h)}}),t&&t(!1),a.add(cd({createEmptyChangeSummary(){return{zoneIds:[]}},handleChange(u,p){let h=c.get(u.changedObservable);return h!==void 0&&p.zoneIds.push(h),!0}},(u,p)=>{for(let h of l)h.onChange&&(c.set(h.onChange,d.get(h)),h.onChange.read(u));t&&t(!0),o.changeViewZones(h=>{for(let f of p.zoneIds)h.layoutZone(f)}),t&&t(!1)}))})),i.add({dispose(){t&&t(!0),o.changeViewZones(s=>{for(let a of r)s.removeZone(a)}),n?.clear(),t&&t(!1)}}),i}function aN(o,e){let t=Vc(e,i=>i.original.startLineNumber<=o.lineNumber);if(!t)return P.fromPositions(o);if(t.original.endLineNumberExclusive<=o.lineNumber){let i=o.lineNumber-t.original.endLineNumberExclusive+t.modified.endLineNumberExclusive;return P.fromPositions(new A(i,o.column))}if(!t.innerChanges)return P.fromPositions(new A(t.modified.startLineNumber,1));let n=Vc(t.innerChanges,i=>i.originalRange.getStartPosition().isBeforeOrEqual(o));if(!n){let i=o.lineNumber-t.original.startLineNumber+t.modified.startLineNumber;return P.fromPositions(new A(i,o.column))}if(n.originalRange.containsPosition(o))return n.modifiedRange;{let i=aq(n.originalRange.getEndPosition(),o);return P.fromPositions(i.addToPosition(n.modifiedRange.getEndPosition()))}}function aq(o,e){return o.lineNumber===e.lineNumber?new Oo(0,e.column-o.column):new Oo(e.lineNumber-o.lineNumber,e.column-1)}function d5(o,e){let t;return o.filter(n=>{let i=e(n,t);return t=n,i})}var Sp=class{static create(e,t=void 0){return new ry(e,e,t)}static createWithDisposable(e,t,n=void 0){let i=new ee;return i.add(t),i.add(e),new ry(e,i,n)}static createOfNonDisposable(e,t,n=void 0){return new ry(e,t,n)}},ry=class extends Sp{constructor(t,n,i){super();this.object=t;this._disposable=n;this._debugOwner=i;i&&this._addOwner(i)}_refCount=1;_isDisposed=!1;_owners=[];_addOwner(t){t&&this._owners.push(t)}createNewRef(t){return this._refCount++,t&&this._addOwner(t),new rN(this,t)}dispose(){this._isDisposed||(this._isDisposed=!0,this._decreaseRefCount(this._debugOwner))}_decreaseRefCount(t){if(this._refCount--,this._refCount===0&&this._disposable.dispose(),t){let n=this._owners.indexOf(t);n!==-1&&this._owners.splice(n,1)}}},rN=class extends Sp{constructor(t,n){super();this._base=t;this._debugOwner=n}_isDisposed=!1;get object(){return this._base.object}createNewRef(t){return this._base.createNewRef(t)}dispose(){this._isDisposed||(this._isDisposed=!0,this._base._decreaseRefCount(this._debugOwner))}};function c5(o,e,t){return yA({debugName:()=>`Configuration Key "${o}"`},n=>t.onDidChangeConfiguration(i=>{i.affectsConfiguration(o)&&n(i)}),()=>t.getValue(o)??e)}function Qa(o,e,t){let n=o.bindTo(e);return hl({debugName:()=>`Set Context Key "${o.key}"`},i=>{n.set(t(i))})}var A_=Y("accessibilitySignalService"),$in=Symbol("AcknowledgeDocCommentsToken"),N_=class extends F{constructor(t,n,i){super();this.configurationService=t;this.accessibilityService=n;this.telemetryService=i}_serviceBrand;sounds=new Map;screenReaderAttached=Lt(this,this.accessibilityService.onDidChangeScreenReaderOptimized,()=>this.accessibilityService.isScreenReaderOptimized());sentTelemetry=new Set;getEnabledState(t,n,i){return new qy(this._signalEnabledState.get({signal:t,userGesture:n,modality:i}))}async playSignal(t,n={}){let i=n.modality==="announcement"||n.modality===void 0,r=t.announcementMessage;i&&this.isAnnouncementEnabled(t,n.userGesture)&&r&&this.accessibilityService.status(r),(n.modality==="sound"||n.modality===void 0)&&this.isSoundEnabled(t,n.userGesture)&&(this.sendSignalTelemetry(t,n.source),await this.playSound(t.sound.getSound(),n.allowManyInParallel))}async playSignals(t){for(let s of t)this.sendSignalTelemetry("signal"in s?s.signal:s,"source"in s?s.source:void 0);let n=t.map(s=>"signal"in s?s.signal:s),i=n.filter(s=>this.isAnnouncementEnabled(s)).map(s=>s.announcementMessage);i.length&&this.accessibilityService.status(i.join(", "));let r=new Set(n.filter(s=>this.isSoundEnabled(s)).map(s=>s.sound.getSound()));await Promise.all(Array.from(r).map(s=>this.playSound(s,!0)))}sendSignalTelemetry(t,n){let i=this.accessibilityService.isScreenReaderOptimized(),r=t.name+(n?`::${n}`:"")+(i?"{screenReaderOptimized}":"");this.sentTelemetry.has(r)||this.getVolumeInPercent()===0||(this.sentTelemetry.add(r),this.telemetryService.publicLog2("signal.played",{signal:t.name,source:n??"",isScreenReaderOptimized:i}))}getVolumeInPercent(){let t=this.configurationService.getValue("accessibility.signalOptions.volume");return typeof t!="number"?50:Math.max(Math.min(t,100),0)}playingSounds=new Set;async playSound(t,n=!1){if(!n&&this.playingSounds.has(t))return;this.playingSounds.add(t);let i=ma.asBrowserUri(`vs/platform/accessibilitySignal/browser/media/${t.fileName}`).toString(!0);try{let r=this.sounds.get(i);if(r)r.volume=this.getVolumeInPercent()/100,r.currentTime=0,await r.play();else{let s=await lq(i,this.getVolumeInPercent()/100);this.sounds.set(i,s)}}catch(r){r.message.includes("play() can only be initiated by a user gesture")||console.error("Error while playing sound",r)}finally{this.playingSounds.delete(t)}}playSignalLoop(t,n){let i=!0,r=()=>{i&&this.playSignal(t,{allowManyInParallel:!0}).finally(()=>{setTimeout(()=>{i&&r()},n)})};return r(),le(()=>i=!1)}_signalConfigValue=new bd(t=>c5(t.settingsKey,{sound:"off",announcement:"off"},this.configurationService));_signalEnabledState=new bd({getCacheKey:hA},t=>Pe(n=>{let i=this._signalConfigValue.get(t.signal).read(n);return!!((t.modality==="sound"||t.modality===void 0)&&u5(i.sound,()=>this.screenReaderAttached.read(n),t.userGesture)||(t.modality==="announcement"||t.modality===void 0)&&u5(i.announcement,()=>this.screenReaderAttached.read(n),t.userGesture))}).recomputeInitiallyAndOnChange(this._store));isAnnouncementEnabled(t,n){return t.announcementMessage?this._signalEnabledState.get({signal:t,userGesture:!!n,modality:"announcement"}).get():!1}isSoundEnabled(t,n){return this._signalEnabledState.get({signal:t,userGesture:!!n,modality:"sound"}).get()}onSoundEnabledChanged(t){return this.getEnabledState(t,!1).onDidChange}getDelayMs(t,n,i){if(!this.configurationService.getValue("accessibility.signalOptions.debouncePositionChanges"))return 0;let r;return t.name===yr.errorAtPosition.name&&i==="positional"?r=this.configurationService.getValue("accessibility.signalOptions.experimental.delays.errorAtPosition"):t.name===yr.warningAtPosition.name&&i==="positional"?r=this.configurationService.getValue("accessibility.signalOptions.experimental.delays.warningAtPosition"):r=this.configurationService.getValue("accessibility.signalOptions.experimental.delays.general"),n==="sound"?r.sound:r.announcement}};N_=O([x(0,ut),x(1,vo),x(2,Xn)],N_);function u5(o,e,t){return o==="on"||o==="always"||o==="auto"&&e()||o==="userGesture"&&t}function lq(o,e){return new Promise((t,n)=>{let i=new Audio(o);i.volume=e,i.addEventListener("ended",()=>{t(i)}),i.addEventListener("error",r=>{n(r.error)}),i.play().catch(r=>{n(r)})})}var Ut=class o{constructor(e){this.fileName=e}static register(e){return new o(e.fileName)}static error=o.register({fileName:"error.mp3"});static warning=o.register({fileName:"warning.mp3"});static success=o.register({fileName:"success.mp3"});static foldedArea=o.register({fileName:"foldedAreas.mp3"});static break=o.register({fileName:"break.mp3"});static quickFixes=o.register({fileName:"quickFixes.mp3"});static taskCompleted=o.register({fileName:"taskCompleted.mp3"});static taskFailed=o.register({fileName:"taskFailed.mp3"});static terminalBell=o.register({fileName:"terminalBell.mp3"});static diffLineInserted=o.register({fileName:"diffLineInserted.mp3"});static diffLineDeleted=o.register({fileName:"diffLineDeleted.mp3"});static diffLineModified=o.register({fileName:"diffLineModified.mp3"});static chatRequestSent=o.register({fileName:"chatRequestSent.mp3"});static chatResponseReceived1=o.register({fileName:"chatResponseReceived1.mp3"});static chatResponseReceived2=o.register({fileName:"chatResponseReceived2.mp3"});static chatResponseReceived3=o.register({fileName:"chatResponseReceived3.mp3"});static chatResponseReceived4=o.register({fileName:"chatResponseReceived4.mp3"});static clear=o.register({fileName:"clear.mp3"});static save=o.register({fileName:"save.mp3"});static format=o.register({fileName:"format.mp3"});static voiceRecordingStarted=o.register({fileName:"voiceRecordingStarted.mp3"});static voiceRecordingStopped=o.register({fileName:"voiceRecordingStopped.mp3"});static progress=o.register({fileName:"progress.mp3"})},lN=class{constructor(e){this.randomOneOf=e}getSound(e=!1){if(e||this.randomOneOf.length===1)return this.randomOneOf[0];{let t=Math.floor(Math.random()*this.randomOneOf.length);return this.randomOneOf[t]}}},yr=class o{constructor(e,t,n,i,r,s){this.sound=e;this.name=t;this.legacySoundSettingsKey=n;this.settingsKey=i;this.legacyAnnouncementSettingsKey=r;this.announcementMessage=s}static _signals=new Set;static register(e){let t=new lN("randomOneOf"in e.sound?e.sound.randomOneOf:[e.sound]),n=new o(t,e.name,e.legacySoundSettingsKey,e.settingsKey,e.legacyAnnouncementSettingsKey,e.announcementMessage);return o._signals.add(n),n}static get allAccessibilitySignals(){return[...this._signals]}static errorAtPosition=o.register({name:m("accessibilitySignals.positionHasError.name","Error at Position"),sound:Ut.error,announcementMessage:m("accessibility.signals.positionHasError","Error"),settingsKey:"accessibility.signals.positionHasError",delaySettingsKey:"accessibility.signalOptions.delays.errorAtPosition"});static warningAtPosition=o.register({name:m("accessibilitySignals.positionHasWarning.name","Warning at Position"),sound:Ut.warning,announcementMessage:m("accessibility.signals.positionHasWarning","Warning"),settingsKey:"accessibility.signals.positionHasWarning",delaySettingsKey:"accessibility.signalOptions.delays.warningAtPosition"});static errorOnLine=o.register({name:m("accessibilitySignals.lineHasError.name","Error on Line"),sound:Ut.error,legacySoundSettingsKey:"audioCues.lineHasError",legacyAnnouncementSettingsKey:"accessibility.alert.error",announcementMessage:m("accessibility.signals.lineHasError","Error on Line"),settingsKey:"accessibility.signals.lineHasError"});static warningOnLine=o.register({name:m("accessibilitySignals.lineHasWarning.name","Warning on Line"),sound:Ut.warning,legacySoundSettingsKey:"audioCues.lineHasWarning",legacyAnnouncementSettingsKey:"accessibility.alert.warning",announcementMessage:m("accessibility.signals.lineHasWarning","Warning on Line"),settingsKey:"accessibility.signals.lineHasWarning"});static foldedArea=o.register({name:m("accessibilitySignals.lineHasFoldedArea.name","Folded Area on Line"),sound:Ut.foldedArea,legacySoundSettingsKey:"audioCues.lineHasFoldedArea",legacyAnnouncementSettingsKey:"accessibility.alert.foldedArea",announcementMessage:m("accessibility.signals.lineHasFoldedArea","Folded"),settingsKey:"accessibility.signals.lineHasFoldedArea"});static break=o.register({name:m("accessibilitySignals.lineHasBreakpoint.name","Breakpoint on Line"),sound:Ut.break,legacySoundSettingsKey:"audioCues.lineHasBreakpoint",legacyAnnouncementSettingsKey:"accessibility.alert.breakpoint",announcementMessage:m("accessibility.signals.lineHasBreakpoint","Breakpoint"),settingsKey:"accessibility.signals.lineHasBreakpoint"});static inlineSuggestion=o.register({name:m("accessibilitySignals.lineHasInlineSuggestion.name","Inline Suggestion on Line"),sound:Ut.quickFixes,legacySoundSettingsKey:"audioCues.lineHasInlineSuggestion",settingsKey:"accessibility.signals.lineHasInlineSuggestion"});static terminalQuickFix=o.register({name:m("accessibilitySignals.terminalQuickFix.name","Terminal Quick Fix"),sound:Ut.quickFixes,legacySoundSettingsKey:"audioCues.terminalQuickFix",legacyAnnouncementSettingsKey:"accessibility.alert.terminalQuickFix",announcementMessage:m("accessibility.signals.terminalQuickFix","Quick Fix"),settingsKey:"accessibility.signals.terminalQuickFix"});static onDebugBreak=o.register({name:m("accessibilitySignals.onDebugBreak.name","Debugger Stopped on Breakpoint"),sound:Ut.break,legacySoundSettingsKey:"audioCues.onDebugBreak",legacyAnnouncementSettingsKey:"accessibility.alert.onDebugBreak",announcementMessage:m("accessibility.signals.onDebugBreak","Breakpoint"),settingsKey:"accessibility.signals.onDebugBreak"});static noInlayHints=o.register({name:m("accessibilitySignals.noInlayHints","No Inlay Hints on Line"),sound:Ut.error,legacySoundSettingsKey:"audioCues.noInlayHints",legacyAnnouncementSettingsKey:"accessibility.alert.noInlayHints",announcementMessage:m("accessibility.signals.noInlayHints","No Inlay Hints"),settingsKey:"accessibility.signals.noInlayHints"});static taskCompleted=o.register({name:m("accessibilitySignals.taskCompleted","Task Completed"),sound:Ut.taskCompleted,legacySoundSettingsKey:"audioCues.taskCompleted",legacyAnnouncementSettingsKey:"accessibility.alert.taskCompleted",announcementMessage:m("accessibility.signals.taskCompleted","Task Completed"),settingsKey:"accessibility.signals.taskCompleted"});static taskFailed=o.register({name:m("accessibilitySignals.taskFailed","Task Failed"),sound:Ut.taskFailed,legacySoundSettingsKey:"audioCues.taskFailed",legacyAnnouncementSettingsKey:"accessibility.alert.taskFailed",announcementMessage:m("accessibility.signals.taskFailed","Task Failed"),settingsKey:"accessibility.signals.taskFailed"});static terminalCommandFailed=o.register({name:m("accessibilitySignals.terminalCommandFailed","Terminal Command Failed"),sound:Ut.error,legacySoundSettingsKey:"audioCues.terminalCommandFailed",legacyAnnouncementSettingsKey:"accessibility.alert.terminalCommandFailed",announcementMessage:m("accessibility.signals.terminalCommandFailed","Command Failed"),settingsKey:"accessibility.signals.terminalCommandFailed"});static terminalCommandSucceeded=o.register({name:m("accessibilitySignals.terminalCommandSucceeded","Terminal Command Succeeded"),sound:Ut.success,announcementMessage:m("accessibility.signals.terminalCommandSucceeded","Command Succeeded"),settingsKey:"accessibility.signals.terminalCommandSucceeded"});static terminalBell=o.register({name:m("accessibilitySignals.terminalBell","Terminal Bell"),sound:Ut.terminalBell,legacySoundSettingsKey:"audioCues.terminalBell",legacyAnnouncementSettingsKey:"accessibility.alert.terminalBell",announcementMessage:m("accessibility.signals.terminalBell","Terminal Bell"),settingsKey:"accessibility.signals.terminalBell"});static notebookCellCompleted=o.register({name:m("accessibilitySignals.notebookCellCompleted","Notebook Cell Completed"),sound:Ut.taskCompleted,legacySoundSettingsKey:"audioCues.notebookCellCompleted",legacyAnnouncementSettingsKey:"accessibility.alert.notebookCellCompleted",announcementMessage:m("accessibility.signals.notebookCellCompleted","Notebook Cell Completed"),settingsKey:"accessibility.signals.notebookCellCompleted"});static notebookCellFailed=o.register({name:m("accessibilitySignals.notebookCellFailed","Notebook Cell Failed"),sound:Ut.taskFailed,legacySoundSettingsKey:"audioCues.notebookCellFailed",legacyAnnouncementSettingsKey:"accessibility.alert.notebookCellFailed",announcementMessage:m("accessibility.signals.notebookCellFailed","Notebook Cell Failed"),settingsKey:"accessibility.signals.notebookCellFailed"});static diffLineInserted=o.register({name:m("accessibilitySignals.diffLineInserted","Diff Line Inserted"),sound:Ut.diffLineInserted,legacySoundSettingsKey:"audioCues.diffLineInserted",settingsKey:"accessibility.signals.diffLineInserted"});static diffLineDeleted=o.register({name:m("accessibilitySignals.diffLineDeleted","Diff Line Deleted"),sound:Ut.diffLineDeleted,legacySoundSettingsKey:"audioCues.diffLineDeleted",settingsKey:"accessibility.signals.diffLineDeleted"});static diffLineModified=o.register({name:m("accessibilitySignals.diffLineModified","Diff Line Modified"),sound:Ut.diffLineModified,legacySoundSettingsKey:"audioCues.diffLineModified",settingsKey:"accessibility.signals.diffLineModified"});static chatRequestSent=o.register({name:m("accessibilitySignals.chatRequestSent","Chat Request Sent"),sound:Ut.chatRequestSent,legacySoundSettingsKey:"audioCues.chatRequestSent",legacyAnnouncementSettingsKey:"accessibility.alert.chatRequestSent",announcementMessage:m("accessibility.signals.chatRequestSent","Chat Request Sent"),settingsKey:"accessibility.signals.chatRequestSent"});static chatResponseReceived=o.register({name:m("accessibilitySignals.chatResponseReceived","Chat Response Received"),legacySoundSettingsKey:"audioCues.chatResponseReceived",sound:{randomOneOf:[Ut.chatResponseReceived1,Ut.chatResponseReceived2,Ut.chatResponseReceived3,Ut.chatResponseReceived4]},settingsKey:"accessibility.signals.chatResponseReceived"});static progress=o.register({name:m("accessibilitySignals.progress","Progress"),sound:Ut.progress,legacySoundSettingsKey:"audioCues.chatResponsePending",legacyAnnouncementSettingsKey:"accessibility.alert.progress",announcementMessage:m("accessibility.signals.progress","Progress"),settingsKey:"accessibility.signals.progress"});static clear=o.register({name:m("accessibilitySignals.clear","Clear"),sound:Ut.clear,legacySoundSettingsKey:"audioCues.clear",legacyAnnouncementSettingsKey:"accessibility.alert.clear",announcementMessage:m("accessibility.signals.clear","Clear"),settingsKey:"accessibility.signals.clear"});static save=o.register({name:m("accessibilitySignals.save","Save"),sound:Ut.save,legacySoundSettingsKey:"audioCues.save",legacyAnnouncementSettingsKey:"accessibility.alert.save",announcementMessage:m("accessibility.signals.save","Save"),settingsKey:"accessibility.signals.save"});static format=o.register({name:m("accessibilitySignals.format","Format"),sound:Ut.format,legacySoundSettingsKey:"audioCues.format",legacyAnnouncementSettingsKey:"accessibility.alert.format",announcementMessage:m("accessibility.signals.format","Format"),settingsKey:"accessibility.signals.format"});static voiceRecordingStarted=o.register({name:m("accessibilitySignals.voiceRecordingStarted","Voice Recording Started"),sound:Ut.voiceRecordingStarted,legacySoundSettingsKey:"audioCues.voiceRecordingStarted",settingsKey:"accessibility.signals.voiceRecordingStarted"});static voiceRecordingStopped=o.register({name:m("accessibilitySignals.voiceRecordingStopped","Voice Recording Stopped"),sound:Ut.voiceRecordingStopped,legacySoundSettingsKey:"audioCues.voiceRecordingStopped",settingsKey:"accessibility.signals.voiceRecordingStopped"})};function Tp(o){return dN.get(o)}var dN=class o extends F{constructor(t){super();this.editor=t;this._register(this.editor.onBeginUpdate(()=>this._beginUpdate())),this._register(this.editor.onEndUpdate(()=>this._endUpdate())),this._register(this.editor.onDidChangeModel(()=>{this._beginUpdate();try{this._model.set(this.editor.getModel(),this._currentTransaction),this._forceUpdate()}finally{this._endUpdate()}})),this._register(this.editor.onDidType(n=>{this._beginUpdate();try{this._forceUpdate(),this.onDidType.trigger(this._currentTransaction,n)}finally{this._endUpdate()}})),this._register(this.editor.onDidChangeModelContent(n=>{this._beginUpdate();try{this._versionId.set(this.editor.getModel()?.getVersionId()??null,this._currentTransaction,n),this._forceUpdate()}finally{this._endUpdate()}})),this._register(this.editor.onDidChangeCursorSelection(n=>{this._beginUpdate();try{this._selections.set(this.editor.getSelections(),this._currentTransaction,n),this._forceUpdate()}finally{this._endUpdate()}}))}static _map=new Map;static get(t){let n=o._map.get(t);if(!n){n=new o(t),o._map.set(t,n);let i=t.onDidDispose(()=>{let r=o._map.get(t);r&&(o._map.delete(t),r.dispose(),i.dispose())})}return n}_updateCounter=0;_currentTransaction=void 0;_beginUpdate(){this._updateCounter++,this._updateCounter===1&&(this._currentTransaction=new pd(()=>{}))}_endUpdate(){if(this._updateCounter--,this._updateCounter===0){let t=this._currentTransaction;this._currentTransaction=void 0,t.finish()}}forceUpdate(t){this._beginUpdate();try{return this._forceUpdate(),t?t(this._currentTransaction):void 0}finally{this._endUpdate()}}_forceUpdate(){this._beginUpdate();try{this._model.set(this.editor.getModel(),this._currentTransaction),this._versionId.set(this.editor.getModel()?.getVersionId()??null,this._currentTransaction,void 0),this._selections.set(this.editor.getSelections(),this._currentTransaction,void 0)}finally{this._endUpdate()}}_model=at(this,this.editor.getModel());model=this._model;isReadonly=Lt(this,this.editor.onDidChangeConfiguration,()=>this.editor.getOption(93));_versionId=Zy({owner:this,lazy:!0},this.editor.getModel()?.getVersionId()??null);versionId=this._versionId;_selections=Zy({owner:this,equalsFn:Uy(zD($e.selectionsEqual)),lazy:!0},this.editor.getSelections()??null);selections=this._selections;positions=ua({owner:this,equalsFn:Uy(zD(A.equals))},t=>this.selections.read(t)?.map(n=>n.getStartPosition())??null);isFocused=Lt(this,t=>{let n=this.editor.onDidFocusEditorWidget(t),i=this.editor.onDidBlurEditorWidget(t);return{dispose(){n.dispose(),i.dispose()}}},()=>this.editor.hasWidgetFocus());value=Vp(this,t=>(this.versionId.read(t),this.model.read(t)?.getValue()??""),(t,n)=>{let i=this.model.get();i!==null&&t!==i.getValue()&&i.setValue(t)});valueIsEmpty=Pe(this,t=>(this.versionId.read(t),this.editor.getModel()?.getValueLength()===0));cursorSelection=ua({owner:this,equalsFn:Uy($e.selectionsEqual)},t=>this.selections.read(t)?.[0]??null);cursorPosition=ua({owner:this,equalsFn:A.equals},t=>this.selections.read(t)?.[0]?.getPosition()??null);onDidType=Gc(this);scrollTop=Lt(this.editor.onDidScrollChange,()=>this.editor.getScrollTop());scrollLeft=Lt(this.editor.onDidScrollChange,()=>this.editor.getScrollLeft());layoutInfo=Lt(this.editor.onDidLayoutChange,()=>this.editor.getLayoutInfo());layoutInfoContentLeft=this.layoutInfo.map(t=>t.contentLeft);layoutInfoDecorationsLeft=this.layoutInfo.map(t=>t.decorationsLeft);contentWidth=Lt(this.editor.onDidContentSizeChange,()=>this.editor.getContentWidth());getOption(t){return Lt(this,n=>this.editor.onDidChangeConfiguration(i=>{i.hasChanged(t)&&n(void 0)}),()=>this.editor.getOption(t))}setDecorations(t){let n=new ee,i=this.editor.createDecorationsCollection();return n.add(hl({owner:this,debugName:()=>`Apply decorations from ${t.debugName}`},r=>{let s=t.read(r);i.set(s)})),n.add({dispose:()=>{i.clear()}}),n}_overlayWidgetCounter=0;createOverlayWidget(t){let n="observableOverlayWidget"+this._overlayWidgetCounter++,i={getDomNode:()=>t.domNode,getPosition:()=>t.position.get(),getId:()=>n,allowEditorOverflow:t.allowEditorOverflow,getMinContentWidthInPx:()=>t.minContentWidthInPx.get()};this.editor.addOverlayWidget(i);let r=rt(s=>{t.position.read(s),t.minContentWidthInPx.read(s),this.editor.layoutOverlayWidget(i)});return le(()=>{r.dispose(),this.editor.removeOverlayWidget(i)})}};var jon=new RegExp("\\bMARK:\\s*(.*)$","d");var p5=Y("editorWorkerService");var cN=Y("diffProviderFactoryService"),sy=class{constructor(e){this.instantiationService=e}_serviceBrand;createDiffProvider(e){return this.instantiationService.createInstance(Js,e)}};sy=O([x(0,Oe)],sy);$i(cN,sy,1);var Js=class{constructor(e,t,n){this.editorWorkerService=t;this.telemetryService=n;this.setOptions(e)}onDidChangeEventEmitter=new D;onDidChange=this.onDidChangeEventEmitter.event;diffAlgorithm="advanced";diffAlgorithmOnDidChangeSubscription=void 0;static diffCache=new Map;dispose(){this.diffAlgorithmOnDidChangeSubscription?.dispose()}async computeDiff(e,t,n,i){if(typeof this.diffAlgorithm!="string")return this.diffAlgorithm.computeDiff(e,t,n,i);if(e.isDisposed()||t.isDisposed())return{changes:[],identical:!0,quitEarly:!1,moves:[]};if(e.getLineCount()===1&&e.getLineMaxColumn(1)===1)return t.getLineCount()===1&&t.getLineMaxColumn(1)===1?{changes:[],identical:!0,quitEarly:!1,moves:[]}:{changes:[new hr(new Re(1,2),new Re(1,t.getLineCount()+1),[new oo(e.getFullModelRange(),t.getFullModelRange())])],identical:!1,quitEarly:!1,moves:[]};let r=JSON.stringify([e.uri.toString(),t.uri.toString()]),s=JSON.stringify([e.id,t.id,e.getAlternativeVersionId(),t.getAlternativeVersionId(),JSON.stringify(n)]),a=Js.diffCache.get(r);if(a&&a.context===s)return a.result;let l=Cs.create(),d=await this.editorWorkerService.computeDiff(e.uri,t.uri,n,this.diffAlgorithm),c=l.elapsed();if(this.telemetryService.publicLog2("diffEditor.computeDiff",{timeMs:c,timedOut:d?.quitEarly??!0,detectedMoves:n.computeMoves?d?.moves.length??0:-1}),i.isCancellationRequested)return{changes:[],identical:!1,quitEarly:!0,moves:[]};if(!d)throw new Error("no diff result available");return Js.diffCache.size>10&&Js.diffCache.delete(Js.diffCache.keys().next().value),Js.diffCache.set(r,{result:d,context:s}),d}setOptions(e){let t=!1;e.diffAlgorithm&&this.diffAlgorithm!==e.diffAlgorithm&&(this.diffAlgorithmOnDidChangeSubscription?.dispose(),this.diffAlgorithmOnDidChangeSubscription=void 0,this.diffAlgorithm=e.diffAlgorithm,typeof e.diffAlgorithm!="string"&&(this.diffAlgorithmOnDidChangeSubscription=e.diffAlgorithm.onDidChange(()=>this.onDidChangeEventEmitter.fire())),t=!0),t&&this.onDidChangeEventEmitter.fire()}};Js=O([x(1,p5),x(2,Xn)],Js);function B_(){return $r&&!!$r.VSCODE_DEV}function uN(o){if(B_()){let e=dq();return e.add(o),{dispose(){e.delete(o)}}}else return{dispose(){}}}function dq(){F_||(F_=new Set);let o=globalThis;return o.$hotReload_applyNewExports||(o.$hotReload_applyNewExports=e=>{let t={config:{mode:void 0},...e},n=[];for(let i of F_){let r=i(t);r&&n.push(r)}if(n.length>0)return i=>{let r=!1;for(let s of n)s(i)&&(r=!0);return r}}),F_}var F_;B_()&&uN(({oldExports:o,newSrc:e,config:t})=>{if(t.mode==="patch-prototype")return n=>{for(let i in n){let r=n[i];if(console.log(`[hot-reload] Patching prototype methods of '${i}'`,{exportedItem:r}),typeof r=="function"&&r.prototype){let s=o[i];if(s){for(let a of Object.getOwnPropertyNames(r.prototype)){let l=Object.getOwnPropertyDescriptor(r.prototype,a),d=Object.getOwnPropertyDescriptor(s.prototype,a);l?.value?.toString()!==d?.value?.toString()&&console.log(`[hot-reload] Patching prototype method '${i}.${a}'`),Object.defineProperty(s.prototype,a,l)}n[i]=s}}}return!0}});function hs(o,e){return cq([o],e),o}function cq(o,e){B_()&&Ti("reload",n=>uN(({oldExports:i})=>{if([...Object.values(i)].some(r=>o.includes(r)))return r=>(n(void 0),!0)})).read(e)}var el=class o{constructor(e,t){this.diffs=e;this.hitTimeout=t}static trivial(e,t){return new o([new xn(ke.ofLength(e.length),ke.ofLength(t.length))],!1)}static trivialTimedOut(e,t){return new o([new xn(ke.ofLength(e.length),ke.ofLength(t.length))],!0)}},xn=class o{constructor(e,t){this.seq1Range=e;this.seq2Range=t}static invert(e,t){let n=[];return xy(e,(i,r)=>{n.push(o.fromOffsetPairs(i?i.getEndExclusives():Ja.zero,r?r.getStarts():new Ja(t,(i?i.seq2Range.endExclusive-i.seq1Range.endExclusive:0)+t)))}),n}static fromOffsetPairs(e,t){return new o(new ke(e.offset1,t.offset1),new ke(e.offset2,t.offset2))}static assertSorted(e){let t;for(let n of e){if(t&&!(t.seq1Range.endExclusive<=n.seq1Range.start&&t.seq2Range.endExclusive<=n.seq2Range.start))throw new Ye("Sequence diffs must be sorted");t=n}}swap(){return new o(this.seq2Range,this.seq1Range)}toString(){return`${this.seq1Range} <-> ${this.seq2Range}`}join(e){return new o(this.seq1Range.join(e.seq1Range),this.seq2Range.join(e.seq2Range))}delta(e){return e===0?this:new o(this.seq1Range.delta(e),this.seq2Range.delta(e))}deltaStart(e){return e===0?this:new o(this.seq1Range.deltaStart(e),this.seq2Range.deltaStart(e))}deltaEnd(e){return e===0?this:new o(this.seq1Range.deltaEnd(e),this.seq2Range.deltaEnd(e))}intersectsOrTouches(e){return this.seq1Range.intersectsOrTouches(e.seq1Range)||this.seq2Range.intersectsOrTouches(e.seq2Range)}intersect(e){let t=this.seq1Range.intersect(e.seq1Range),n=this.seq2Range.intersect(e.seq2Range);if(!(!t||!n))return new o(t,n)}getStarts(){return new Ja(this.seq1Range.start,this.seq2Range.start)}getEndExclusives(){return new Ja(this.seq1Range.endExclusive,this.seq2Range.endExclusive)}},Ja=class o{constructor(e,t){this.offset1=e;this.offset2=t}static zero=new o(0,0);static max=new o(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER);toString(){return`${this.offset1} <-> ${this.offset2}`}delta(e){return e===0?this:new o(this.offset1+e,this.offset2+e)}equals(e){return this.offset1===e.offset1&&this.offset2===e.offset2}},Dc=class o{static instance=new o;isValid(){return!0}},V_=class{constructor(e){this.timeout=e;if(e<=0)throw new Ye("timeout must be positive")}startTime=Date.now();valid=!0;isValid(){return!(Date.now()-this.startTime<this.timeout)&&this.valid&&(this.valid=!1),this.valid}disable(){this.timeout=Number.MAX_SAFE_INTEGER,this.isValid=()=>!0,this.valid=!0}};var Ig=class{constructor(e,t){this.width=e;this.height=t;this.array=new Array(e*t)}array=[];get(e,t){return this.array[e+t*this.width]}set(e,t,n){this.array[e+t*this.width]=n}};function ly(o){return o===32||o===9}var ay=class o{constructor(e,t,n){this.range=e;this.lines=t;this.source=n;let i=0;for(let r=e.startLineNumber-1;r<e.endLineNumberExclusive-1;r++){let s=t[r];for(let l=0;l<s.length;l++){i++;let d=s[l],c=o.getKey(d);this.histogram[c]=(this.histogram[c]||0)+1}i++;let a=o.getKey(`
`);this.histogram[a]=(this.histogram[a]||0)+1}this.totalCount=i}static chrKeys=new Map;static getKey(e){let t=this.chrKeys.get(e);return t===void 0&&(t=this.chrKeys.size,this.chrKeys.set(e,t)),t}totalCount;histogram=[];computeSimilarity(e){let t=0,n=Math.max(this.histogram.length,e.histogram.length);for(let i=0;i<n;i++)t+=Math.abs((this.histogram[i]??0)-(e.histogram[i]??0));return 1-t/(this.totalCount+e.totalCount)}};var W_=class{compute(e,t,n=Dc.instance,i){if(e.length===0||t.length===0)return el.trivial(e,t);let r=new Ig(e.length,t.length),s=new Ig(e.length,t.length),a=new Ig(e.length,t.length);for(let f=0;f<e.length;f++)for(let g=0;g<t.length;g++){if(!n.isValid())return el.trivialTimedOut(e,t);let b=f===0?0:r.get(f-1,g),v=g===0?0:r.get(f,g-1),y;e.getElement(f)===t.getElement(g)?(f===0||g===0?y=0:y=r.get(f-1,g-1),f>0&&g>0&&s.get(f-1,g-1)===3&&(y+=a.get(f-1,g-1)),y+=i?i(f,g):1):y=-1;let S=Math.max(b,v,y);if(S===y){let E=f>0&&g>0?a.get(f-1,g-1):0;a.set(f,g,E+1),s.set(f,g,3)}else S===b?(a.set(f,g,0),s.set(f,g,1)):S===v&&(a.set(f,g,0),s.set(f,g,2));r.set(f,g,S)}let l=[],d=e.length,c=t.length;function u(f,g){(f+1!==d||g+1!==c)&&l.push(new xn(new ke(f+1,d),new ke(g+1,c))),d=f,c=g}let p=e.length-1,h=t.length-1;for(;p>=0&&h>=0;)s.get(p,h)===3?(u(p,h),p--,h--):s.get(p,h)===1?p--:h--;return u(-1,-1),l.reverse(),new el(l,!1)}};var Cg=class{compute(e,t,n=Dc.instance){if(e.length===0||t.length===0)return el.trivial(e,t);let i=e,r=t;function s(g,b){for(;g<i.length&&b<r.length&&i.getElement(g)===r.getElement(b);)g++,b++;return g}let a=0,l=new pN;l.set(0,s(0,0));let d=new hN;d.set(0,l.get(0)===0?null:new H_(null,0,0,l.get(0)));let c=0;e:for(;;){if(a++,!n.isValid())return el.trivialTimedOut(i,r);let g=-Math.min(a,r.length+a%2),b=Math.min(a,i.length+a%2);for(c=g;c<=b;c+=2){let v=0,y=c===b?-1:l.get(c+1),S=c===g?-1:l.get(c-1)+1;v++;let E=Math.min(Math.max(y,S),i.length),C=E-c;if(v++,E>i.length||C>r.length)continue;let w=s(E,C);l.set(c,w);let _=E===y?d.get(c+1):d.get(c-1);if(d.set(c,w!==E?new H_(_,E,C,w-E):_),l.get(c)===i.length&&l.get(c)-c===r.length)break e}}let u=d.get(c),p=[],h=i.length,f=r.length;for(;;){let g=u?u.x+u.length:0,b=u?u.y+u.length:0;if((g!==h||b!==f)&&p.push(new xn(new ke(g,h),new ke(b,f))),!u)break;h=u.x,f=u.y,u=u.prev}return p.reverse(),new el(p,!1)}},H_=class{constructor(e,t,n,i){this.prev=e;this.x=t;this.y=n;this.length=i}},pN=class{positiveArr=new Int32Array(10);negativeArr=new Int32Array(10);get(e){return e<0?(e=-e-1,this.negativeArr[e]):this.positiveArr[e]}set(e,t){if(e<0){if(e=-e-1,e>=this.negativeArr.length){let n=this.negativeArr;this.negativeArr=new Int32Array(n.length*2),this.negativeArr.set(n)}this.negativeArr[e]=t}else{if(e>=this.positiveArr.length){let n=this.positiveArr;this.positiveArr=new Int32Array(n.length*2),this.positiveArr.set(n)}this.positiveArr[e]=t}}},hN=class{positiveArr=[];negativeArr=[];get(e){return e<0?(e=-e-1,this.negativeArr[e]):this.positiveArr[e]}set(e,t){e<0?(e=-e-1,this.negativeArr[e]=t):this.positiveArr[e]=t}};var Lc=class{constructor(e,t,n){this.lines=e;this.range=t;this.considerWhitespaceChanges=n;this.firstElementOffsetByLineIdx.push(0);for(let i=this.range.startLineNumber;i<=this.range.endLineNumber;i++){let r=e[i-1],s=0;i===this.range.startLineNumber&&this.range.startColumn>1&&(s=this.range.startColumn-1,r=r.substring(s)),this.lineStartOffsets.push(s);let a=0;if(!n){let d=r.trimStart();a=r.length-d.length,r=d.trimEnd()}this.trimmedWsLengthsByLineIdx.push(a);let l=i===this.range.endLineNumber?Math.min(this.range.endColumn-1-s-a,r.length):r.length;for(let d=0;d<l;d++)this.elements.push(r.charCodeAt(d));i<this.range.endLineNumber&&(this.elements.push(10),this.firstElementOffsetByLineIdx.push(this.elements.length))}}elements=[];firstElementOffsetByLineIdx=[];lineStartOffsets=[];trimmedWsLengthsByLineIdx=[];toString(){return`Slice: "${this.text}"`}get text(){return this.getText(new ke(0,this.length))}getText(e){return this.elements.slice(e.start,e.endExclusive).map(t=>String.fromCharCode(t)).join("")}getElement(e){return this.elements[e]}get length(){return this.elements.length}getBoundaryScore(e){let t=m5(e>0?this.elements[e-1]:-1),n=m5(e<this.elements.length?this.elements[e]:-1);if(t===7&&n===8)return 0;if(t===8)return 150;let i=0;return t!==n&&(i+=10,t===0&&n===1&&(i+=1)),i+=h5(t),i+=h5(n),i}translateOffset(e,t="right"){let n=al(this.firstElementOffsetByLineIdx,r=>r<=e),i=e-this.firstElementOffsetByLineIdx[n];return new A(this.range.startLineNumber+n,1+this.lineStartOffsets[n]+i+(i===0&&t==="left"?0:this.trimmedWsLengthsByLineIdx[n]))}translateRange(e){let t=this.translateOffset(e.start,"right"),n=this.translateOffset(e.endExclusive,"left");return n.isBefore(t)?P.fromPositions(n,n):P.fromPositions(t,n)}findWordContaining(e){if(e<0||e>=this.elements.length||!mN(this.elements[e]))return;let t=e;for(;t>0&&mN(this.elements[t-1]);)t--;let n=e;for(;n<this.elements.length&&mN(this.elements[n]);)n++;return new ke(t,n)}countLinesIn(e){return this.translateOffset(e.endExclusive).lineNumber-this.translateOffset(e.start).lineNumber}isStronglyEqual(e,t){return this.elements[e]===this.elements[t]}extendToFullLines(e){let t=sl(this.firstElementOffsetByLineIdx,i=>i<=e.start)??0,n=ON(this.firstElementOffsetByLineIdx,i=>e.endExclusive<=i)??this.elements.length;return new ke(t,n)}};function mN(o){return o>=97&&o<=122||o>=65&&o<=90||o>=48&&o<=57}var uq={0:0,1:0,2:0,3:10,4:2,5:30,6:3,7:10,8:10};function h5(o){return uq[o]}function m5(o){return o===10?8:o===13?7:ly(o)?6:o>=97&&o<=122?0:o>=65&&o<=90?1:o>=48&&o<=57?2:o===-1?3:o===44||o===59?5:4}function f5(o,e,t,n,i,r){let{moves:s,excludedChanges:a}=hq(o,e,t,r);if(!r.isValid())return[];let l=o.filter(c=>!a.has(c)),d=mq(l,n,i,e,t,r);return jg(s,d),s=gq(s),s=s.filter(c=>{let u=c.original.toOffsetRange().slice(e).map(h=>h.trim());return u.join(`
`).length>=15&&pq(u,h=>h.length>=2)>=2}),s=fq(o,s),s}function pq(o,e){let t=0;for(let n of o)e(n)&&t++;return t}function hq(o,e,t,n){let i=[],r=o.filter(l=>l.modified.isEmpty&&l.original.length>=3).map(l=>new ay(l.original,e,l)),s=new Set(o.filter(l=>l.original.isEmpty&&l.modified.length>=3).map(l=>new ay(l.modified,t,l))),a=new Set;for(let l of r){let d=-1,c;for(let u of s){let p=l.computeSimilarity(u);p>d&&(d=p,c=u)}if(d>.9&&c&&(s.delete(c),i.push(new Xi(l.range,c.range)),a.add(l.source),a.add(c.source)),!n.isValid())return{moves:i,excludedChanges:a}}return{moves:i,excludedChanges:a}}function mq(o,e,t,n,i,r){let s=[],a=new pl;for(let p of o)for(let h=p.original.startLineNumber;h<p.original.endLineNumberExclusive-2;h++){let f=`${e[h-1]}:${e[h+1-1]}:${e[h+2-1]}`;a.add(f,{range:new Re(h,h+3)})}let l=[];o.sort(mo(p=>p.modified.startLineNumber,aa));for(let p of o){let h=[];for(let f=p.modified.startLineNumber;f<p.modified.endLineNumberExclusive-2;f++){let g=`${t[f-1]}:${t[f+1-1]}:${t[f+2-1]}`,b=new Re(f,f+3),v=[];a.forEach(g,({range:y})=>{for(let E of h)if(E.originalLineRange.endLineNumberExclusive+1===y.endLineNumberExclusive&&E.modifiedLineRange.endLineNumberExclusive+1===b.endLineNumberExclusive){E.originalLineRange=new Re(E.originalLineRange.startLineNumber,y.endLineNumberExclusive),E.modifiedLineRange=new Re(E.modifiedLineRange.startLineNumber,b.endLineNumberExclusive),v.push(E);return}let S={modifiedLineRange:b,originalLineRange:y};l.push(S),v.push(S)}),h=v}if(!r.isValid())return[]}l.sort(jN(mo(p=>p.modifiedLineRange.length,aa)));let d=new Pr,c=new Pr;for(let p of l){let h=p.modifiedLineRange.startLineNumber-p.originalLineRange.startLineNumber,f=d.subtractFrom(p.modifiedLineRange),g=c.subtractFrom(p.originalLineRange).getWithDelta(h),b=f.getIntersection(g);for(let v of b.ranges){if(v.length<3)continue;let y=v,S=v.delta(-h);s.push(new Xi(S,y)),d.addRange(y),c.addRange(S)}}s.sort(mo(p=>p.original.startLineNumber,aa));let u=new zg(o);for(let p=0;p<s.length;p++){let h=s[p],f=u.findLastMonotonous(w=>w.original.startLineNumber<=h.original.startLineNumber),g=sl(o,w=>w.modified.startLineNumber<=h.modified.startLineNumber),b=Math.max(h.original.startLineNumber-f.original.startLineNumber,h.modified.startLineNumber-g.modified.startLineNumber),v=u.findLastMonotonous(w=>w.original.startLineNumber<h.original.endLineNumberExclusive),y=sl(o,w=>w.modified.startLineNumber<h.modified.endLineNumberExclusive),S=Math.max(v.original.endLineNumberExclusive-h.original.endLineNumberExclusive,y.modified.endLineNumberExclusive-h.modified.endLineNumberExclusive),E;for(E=0;E<b;E++){let w=h.original.startLineNumber-E-1,_=h.modified.startLineNumber-E-1;if(w>n.length||_>i.length||d.contains(_)||c.contains(w)||!g5(n[w-1],i[_-1],r))break}E>0&&(c.addRange(new Re(h.original.startLineNumber-E,h.original.startLineNumber)),d.addRange(new Re(h.modified.startLineNumber-E,h.modified.startLineNumber)));let C;for(C=0;C<S;C++){let w=h.original.endLineNumberExclusive+C,_=h.modified.endLineNumberExclusive+C;if(w>n.length||_>i.length||d.contains(_)||c.contains(w)||!g5(n[w-1],i[_-1],r))break}C>0&&(c.addRange(new Re(h.original.endLineNumberExclusive,h.original.endLineNumberExclusive+C)),d.addRange(new Re(h.modified.endLineNumberExclusive,h.modified.endLineNumberExclusive+C))),(E>0||C>0)&&(s[p]=new Xi(new Re(h.original.startLineNumber-E,h.original.endLineNumberExclusive+C),new Re(h.modified.startLineNumber-E,h.modified.endLineNumberExclusive+C)))}return s}function g5(o,e,t){if(o.trim()===e.trim())return!0;if(o.length>300&&e.length>300)return!1;let i=new Cg().compute(new Lc([o],new P(1,1,1,o.length),!1),new Lc([e],new P(1,1,1,e.length),!1),t),r=0,s=xn.invert(i.diffs,o.length);for(let c of s)c.seq1Range.forEach(u=>{ly(o.charCodeAt(u))||r++});function a(c){let u=0;for(let p=0;p<o.length;p++)ly(c.charCodeAt(p))||u++;return u}let l=a(o.length>e.length?o:e);return r/l>.6&&l>10}function gq(o){if(o.length===0)return o;o.sort(mo(t=>t.original.startLineNumber,aa));let e=[o[0]];for(let t=1;t<o.length;t++){let n=e[e.length-1],i=o[t],r=i.original.startLineNumber-n.original.endLineNumberExclusive,s=i.modified.startLineNumber-n.modified.endLineNumberExclusive;if(r>=0&&s>=0&&r+s<=2){e[e.length-1]=n.join(i);continue}e.push(i)}return e}function fq(o,e){let t=new zg(o);return e=e.filter(n=>{let i=t.findLastMonotonous(a=>a.original.startLineNumber<n.original.endLineNumberExclusive)||new Xi(new Re(1,1),new Re(1,1)),r=sl(o,a=>a.modified.startLineNumber<n.modified.endLineNumberExclusive);return i!==r}),e}var dy=class{constructor(e,t){this.trimmedHash=e;this.lines=t}getElement(e){return this.trimmedHash[e]}get length(){return this.trimmedHash.length}getBoundaryScore(e){let t=e===0?0:b5(this.lines[e-1]),n=e===this.lines.length?0:b5(this.lines[e]);return 1e3-(t+n)}getText(e){return this.lines.slice(e.start,e.endExclusive).join(`
`)}isStronglyEqual(e,t){return this.lines[e]===this.lines[t]}};function b5(o){let e=0;for(;e<o.length&&(o.charCodeAt(e)===32||o.charCodeAt(e)===9);)e++;return e}function cy(o,e,t){let n=t;return n=v5(o,e,n),n=v5(o,e,n),n=bq(o,e,n),n}function v5(o,e,t){if(t.length===0)return t;let n=[];n.push(t[0]);for(let r=1;r<t.length;r++){let s=n[n.length-1],a=t[r];if(a.seq1Range.isEmpty||a.seq2Range.isEmpty){let l=a.seq1Range.start-s.seq1Range.endExclusive,d;for(d=1;d<=l&&!(o.getElement(a.seq1Range.start-d)!==o.getElement(a.seq1Range.endExclusive-d)||e.getElement(a.seq2Range.start-d)!==e.getElement(a.seq2Range.endExclusive-d));d++);if(d--,d===l){n[n.length-1]=new xn(new ke(s.seq1Range.start,a.seq1Range.endExclusive-l),new ke(s.seq2Range.start,a.seq2Range.endExclusive-l));continue}a=a.delta(-d)}n.push(a)}let i=[];for(let r=0;r<n.length-1;r++){let s=n[r+1],a=n[r];if(a.seq1Range.isEmpty||a.seq2Range.isEmpty){let l=s.seq1Range.start-a.seq1Range.endExclusive,d;for(d=0;d<l&&!(!o.isStronglyEqual(a.seq1Range.start+d,a.seq1Range.endExclusive+d)||!e.isStronglyEqual(a.seq2Range.start+d,a.seq2Range.endExclusive+d));d++);if(d===l){n[r+1]=new xn(new ke(a.seq1Range.start+l,s.seq1Range.endExclusive),new ke(a.seq2Range.start+l,s.seq2Range.endExclusive));continue}d>0&&(a=a.delta(d))}i.push(a)}return n.length>0&&i.push(n[n.length-1]),i}function bq(o,e,t){if(!o.getBoundaryScore||!e.getBoundaryScore)return t;for(let n=0;n<t.length;n++){let i=n>0?t[n-1]:void 0,r=t[n],s=n+1<t.length?t[n+1]:void 0,a=new ke(i?i.seq1Range.endExclusive+1:0,s?s.seq1Range.start-1:o.length),l=new ke(i?i.seq2Range.endExclusive+1:0,s?s.seq2Range.start-1:e.length);r.seq1Range.isEmpty?t[n]=y5(r,o,e,a,l):r.seq2Range.isEmpty&&(t[n]=y5(r.swap(),e,o,l,a).swap())}return t}function y5(o,e,t,n,i){let s=1;for(;o.seq1Range.start-s>=n.start&&o.seq2Range.start-s>=i.start&&t.isStronglyEqual(o.seq2Range.start-s,o.seq2Range.endExclusive-s)&&s<100;)s++;s--;let a=0;for(;o.seq1Range.start+a<n.endExclusive&&o.seq2Range.endExclusive+a<i.endExclusive&&t.isStronglyEqual(o.seq2Range.start+a,o.seq2Range.endExclusive+a)&&a<100;)a++;if(s===0&&a===0)return o;let l=0,d=-1;for(let c=-s;c<=a;c++){let u=o.seq2Range.start+c,p=o.seq2Range.endExclusive+c,h=o.seq1Range.start+c,f=e.getBoundaryScore(h)+t.getBoundaryScore(u)+t.getBoundaryScore(p);f>d&&(d=f,l=c)}return o.delta(l)}function I5(o,e,t){let n=[];for(let i of t){let r=n[n.length-1];if(!r){n.push(i);continue}i.seq1Range.start-r.seq1Range.endExclusive<=2||i.seq2Range.start-r.seq2Range.endExclusive<=2?n[n.length-1]=new xn(r.seq1Range.join(i.seq1Range),r.seq2Range.join(i.seq2Range)):n.push(i)}return n}function C5(o,e,t){let n=xn.invert(t,o.length),i=[],r=new Ja(0,0);function s(l,d){if(l.offset1<r.offset1||l.offset2<r.offset2)return;let c=o.findWordContaining(l.offset1),u=e.findWordContaining(l.offset2);if(!c||!u)return;let p=new xn(c,u),h=p.intersect(d),f=h.seq1Range.length,g=h.seq2Range.length;for(;n.length>0;){let b=n[0];if(!(b.seq1Range.intersects(p.seq1Range)||b.seq2Range.intersects(p.seq2Range)))break;let y=o.findWordContaining(b.seq1Range.start),S=e.findWordContaining(b.seq2Range.start),E=new xn(y,S),C=E.intersect(b);if(f+=C.seq1Range.length,g+=C.seq2Range.length,p=p.join(E),p.seq1Range.endExclusive>=b.seq1Range.endExclusive)n.shift();else break}f+g<(p.seq1Range.length+p.seq2Range.length)*2/3&&i.push(p),r=p.getEndExclusives()}for(;n.length>0;){let l=n.shift();l.seq1Range.isEmpty||(s(l.getStarts(),l),s(l.getEndExclusives().delta(-1),l))}return vq(t,i)}function vq(o,e){let t=[];for(;o.length>0||e.length>0;){let n=o[0],i=e[0],r;n&&(!i||n.seq1Range.start<i.seq1Range.start)?r=o.shift():r=e.shift(),t.length>0&&t[t.length-1].seq1Range.endExclusive>=r.seq1Range.start?t[t.length-1]=t[t.length-1].join(r):t.push(r)}return t}function S5(o,e,t){let n=t;if(n.length===0)return n;let i=0,r;do{r=!1;let a=[n[0]];for(let l=1;l<n.length;l++){let u=function(h,f){let g=new ke(c.seq1Range.endExclusive,d.seq1Range.start);return o.getText(g).replace(/\s/g,"").length<=4&&(h.seq1Range.length+h.seq2Range.length>5||f.seq1Range.length+f.seq2Range.length>5)};var s=u;let d=n[l],c=a[a.length-1];u(c,d)?(r=!0,a[a.length-1]=a[a.length-1].join(d)):a.push(d)}n=a}while(i++<10&&r);return n}function E5(o,e,t){let n=t;if(n.length===0)return n;let i=0,r;do{r=!1;let l=[n[0]];for(let d=1;d<n.length;d++){let p=function(f,g){let b=new ke(u.seq1Range.endExclusive,c.seq1Range.start);if(o.countLinesIn(b)>5||b.length>500)return!1;let y=o.getText(b).trim();if(y.length>20||y.split(/\r\n|\r|\n/).length>1)return!1;let S=o.countLinesIn(f.seq1Range),E=f.seq1Range.length,C=e.countLinesIn(f.seq2Range),w=f.seq2Range.length,_=o.countLinesIn(g.seq1Range),L=g.seq1Range.length,k=e.countLinesIn(g.seq2Range),W=g.seq2Range.length,K=2*40+50;function U(oe){return Math.min(oe,K)}return Math.pow(Math.pow(U(S*40+E),1.5)+Math.pow(U(C*40+w),1.5),1.5)+Math.pow(Math.pow(U(_*40+L),1.5)+Math.pow(U(k*40+W),1.5),1.5)>(K**1.5)**1.5*1.3};var a=p;let c=n[d],u=l[l.length-1];p(u,c)?(r=!0,l[l.length-1]=l[l.length-1].join(c)):l.push(c)}n=l}while(i++<10&&r);let s=[];return UN(n,(l,d,c)=>{let u=d;function p(y){return y.length>0&&y.trim().length<=3&&d.seq1Range.length+d.seq2Range.length>100}let h=o.extendToFullLines(d.seq1Range),f=o.getText(new ke(h.start,d.seq1Range.start));p(f)&&(u=u.deltaStart(-f.length));let g=o.getText(new ke(d.seq1Range.endExclusive,h.endExclusive));p(g)&&(u=u.deltaEnd(g.length));let b=xn.fromOffsetPairs(l?l.getEndExclusives():Ja.zero,c?c.getStarts():Ja.max),v=u.intersect(b);s.length>0&&v.getStarts().equals(s[s.length-1].getEndExclusives())?s[s.length-1]=s[s.length-1].join(v):s.push(v)}),s}var U_=class{dynamicProgrammingDiffing=new W_;myersDiffingAlgorithm=new Cg;computeDiff(e,t,n){if(e.length<=1&&zt(e,t,(C,w)=>C===w))return new Ru([],[],!1);if(e.length===1&&e[0].length===0||t.length===1&&t[0].length===0)return new Ru([new hr(new Re(1,e.length+1),new Re(1,t.length+1),[new oo(new P(1,1,e.length,e[e.length-1].length+1),new P(1,1,t.length,t[t.length-1].length+1))])],[],!1);let i=n.maxComputationTimeMs===0?Dc.instance:new V_(n.maxComputationTimeMs),r=!n.ignoreTrimWhitespace,s=new Map;function a(C){let w=s.get(C);return w===void 0&&(w=s.size,s.set(C,w)),w}let l=e.map(C=>a(C.trim())),d=t.map(C=>a(C.trim())),c=new dy(l,e),u=new dy(d,t),p=c.length+u.length<1700?this.dynamicProgrammingDiffing.compute(c,u,i,(C,w)=>e[C]===t[w]?t[w].length===0?.1:1+Math.log(1+t[w].length):.99):this.myersDiffingAlgorithm.compute(c,u,i),h=p.diffs,f=p.hitTimeout;h=cy(c,u,h),h=S5(c,u,h);let g=[],b=C=>{if(r)for(let w=0;w<C;w++){let _=v+w,L=y+w;if(e[_]!==t[L]){let k=this.refineDiff(e,t,new xn(new ke(_,_+1),new ke(L,L+1)),i,r);for(let W of k.mappings)g.push(W);k.hitTimeout&&(f=!0)}}},v=0,y=0;for(let C of h){vs(()=>C.seq1Range.start-v===C.seq2Range.start-y);let w=C.seq1Range.start-v;b(w),v=C.seq1Range.endExclusive,y=C.seq2Range.endExclusive;let _=this.refineDiff(e,t,C,i,r);_.hitTimeout&&(f=!0);for(let L of _.mappings)g.push(L)}b(e.length-v);let S=T5(g,e,t),E=[];return n.computeMoves&&(E=this.computeMoves(S,e,t,l,d,i,r)),vs(()=>{function C(_,L){if(_.lineNumber<1||_.lineNumber>L.length)return!1;let k=L[_.lineNumber-1];return!(_.column<1||_.column>k.length+1)}function w(_,L){return!(_.startLineNumber<1||_.startLineNumber>L.length+1||_.endLineNumberExclusive<1||_.endLineNumberExclusive>L.length+1)}for(let _ of S){if(!_.innerChanges)return!1;for(let L of _.innerChanges)if(!(C(L.modifiedRange.getStartPosition(),t)&&C(L.modifiedRange.getEndPosition(),t)&&C(L.originalRange.getStartPosition(),e)&&C(L.originalRange.getEndPosition(),e)))return!1;if(!w(_.modified,t)||!w(_.original,e))return!1}return!0}),new Ru(S,E,f)}computeMoves(e,t,n,i,r,s,a){return f5(e,t,n,i,r,s).map(c=>{let u=this.refineDiff(t,n,new xn(c.original.toOffsetRange(),c.modified.toOffsetRange()),s,a),p=T5(u.mappings,t,n,!0);return new LS(c,p)})}refineDiff(e,t,n,i,r){let a=Iq(n).toRangeMapping2(e,t),l=new Lc(e,a.originalRange,r),d=new Lc(t,a.modifiedRange,r),c=l.length+d.length<500?this.dynamicProgrammingDiffing.compute(l,d,i):this.myersDiffingAlgorithm.compute(l,d,i),u=!1,p=c.diffs;u&&xn.assertSorted(p),p=cy(l,d,p),u&&xn.assertSorted(p),p=C5(l,d,p),u&&xn.assertSorted(p),p=I5(l,d,p),u&&xn.assertSorted(p),p=E5(l,d,p),u&&xn.assertSorted(p);let h=p.map(f=>new oo(l.translateRange(f.seq1Range),d.translateRange(f.seq2Range)));return u&&oo.assertSorted(h),{mappings:h,hitTimeout:c.hitTimeout}}};function T5(o,e,t,n=!1){let i=[];for(let r of kp(o.map(s=>yq(s,e,t)),(s,a)=>s.original.overlapOrTouch(a.original)||s.modified.overlapOrTouch(a.modified))){let s=r[0],a=r[r.length-1];i.push(new hr(s.original.join(a.original),s.modified.join(a.modified),r.map(l=>l.innerChanges[0])))}return vs(()=>!n&&i.length>0&&(i[0].modified.startLineNumber!==i[0].original.startLineNumber||t.length-i[i.length-1].modified.endLineNumberExclusive!==e.length-i[i.length-1].original.endLineNumberExclusive)?!1:rf(i,(r,s)=>s.original.startLineNumber-r.original.endLineNumberExclusive===s.modified.startLineNumber-r.modified.endLineNumberExclusive&&r.original.endLineNumberExclusive<s.original.startLineNumber&&r.modified.endLineNumberExclusive<s.modified.startLineNumber)),i}function yq(o,e,t){let n=0,i=0;o.modifiedRange.endColumn===1&&o.originalRange.endColumn===1&&o.originalRange.startLineNumber+n<=o.originalRange.endLineNumber&&o.modifiedRange.startLineNumber+n<=o.modifiedRange.endLineNumber&&(i=-1),o.modifiedRange.startColumn-1>=t[o.modifiedRange.startLineNumber-1].length&&o.originalRange.startColumn-1>=e[o.originalRange.startLineNumber-1].length&&o.originalRange.startLineNumber<=o.originalRange.endLineNumber+i&&o.modifiedRange.startLineNumber<=o.modifiedRange.endLineNumber+i&&(n=1);let r=new Re(o.originalRange.startLineNumber+n,o.originalRange.endLineNumber+1+i),s=new Re(o.modifiedRange.startLineNumber+n,o.modifiedRange.endLineNumber+1+i);return new hr(r,s,[o])}function Iq(o){return new Xi(new Re(o.seq1Range.start+1,o.seq1Range.endExclusive+1),new Re(o.seq2Range.start+1,o.seq2Range.endExclusive+1))}var San=T("diffEditor.move.border","#8b8b8b9c",m("diffEditor.move.border","The border color for text that got moved in the diff editor.")),Ean=T("diffEditor.moveActive.border","#FFA500",m("diffEditor.moveActive.border","The active border color for text that got moved in the diff editor.")),Tan=T("diffEditor.unchangedRegionShadow",{dark:"#000000",light:"#737373BF",hcDark:"#000000",hcLight:"#737373BF"},m("diffEditor.unchangedRegionShadow","The color of the shadow around unchanged region widgets.")),Cq=or("diff-insert",te.add,m("diffInsertIcon","Line decoration for inserts in the diff editor.")),gN=or("diff-remove",te.remove,m("diffRemoveIcon","Line decoration for removals in the diff editor.")),fN=En.register({className:"line-insert",description:"line-insert",isWholeLine:!0,linesDecorationsClassName:"insert-sign "+we.asClassName(Cq),marginClassName:"gutter-insert"}),bN=En.register({className:"line-delete",description:"line-delete",isWholeLine:!0,linesDecorationsClassName:"delete-sign "+we.asClassName(gN),marginClassName:"gutter-delete"}),vN=En.register({className:"line-insert",description:"line-insert",isWholeLine:!0,marginClassName:"gutter-insert"}),yN=En.register({className:"line-delete",description:"line-delete",isWholeLine:!0,marginClassName:"gutter-delete"}),IN=En.register({className:"char-insert",description:"char-insert",shouldFillLineOnLineBreak:!0}),x5=En.register({className:"char-insert",description:"char-insert",isWholeLine:!0}),w5=En.register({className:"char-insert diff-range-empty",description:"char-insert diff-range-empty"}),uy=En.register({className:"char-delete",description:"char-delete",shouldFillLineOnLineBreak:!0}),_5=En.register({className:"char-delete",description:"char-delete",isWholeLine:!0}),D5=En.register({className:"char-delete diff-range-empty",description:"char-delete diff-range-empty"});var z_=class extends F{constructor(t,n,i,r,s,a,l,d,c){super();this._getViewZoneId=t;this._marginDomNode=n;this._modifiedEditor=i;this._diff=r;this._editor=s;this._viewLineCounts=a;this._originalTextModel=l;this._contextMenuService=d;this._clipboardService=c;this._marginDomNode.style.zIndex="10",this._diffActions=document.createElement("div"),this._diffActions.className=we.asClassName(te.lightBulb)+" lightbulb-glyph",this._diffActions.style.position="absolute";let u=this._modifiedEditor.getOption(68);this._diffActions.style.right="0px",this._diffActions.style.visibility="hidden",this._diffActions.style.height=`${u}px`,this._diffActions.style.lineHeight=`${u}px`,this._marginDomNode.appendChild(this._diffActions);let p=0,h=i.getOption(129)&&!jr,f=(g,b)=>{this._contextMenuService.showContextMenu({domForShadowRoot:h?i.getDomNode()??void 0:void 0,getAnchor:()=>({x:g,y:b}),getActions:()=>{let v=[],y=r.modified.isEmpty;return v.push(new Ht("diff.clipboard.copyDeletedContent",y?r.original.length>1?m("diff.clipboard.copyDeletedLinesContent.label","Copy deleted lines"):m("diff.clipboard.copyDeletedLinesContent.single.label","Copy deleted line"):r.original.length>1?m("diff.clipboard.copyChangedLinesContent.label","Copy changed lines"):m("diff.clipboard.copyChangedLinesContent.single.label","Copy changed line"),void 0,!0,async()=>{let E=this._originalTextModel.getValueInRange(r.original.toExclusiveRange());await this._clipboardService.writeText(E)})),r.original.length>1&&v.push(new Ht("diff.clipboard.copyDeletedLineContent",y?m("diff.clipboard.copyDeletedLineContent.label","Copy deleted line ({0})",r.original.startLineNumber+p):m("diff.clipboard.copyChangedLineContent.label","Copy changed line ({0})",r.original.startLineNumber+p),void 0,!0,async()=>{let E=this._originalTextModel.getLineContent(r.original.startLineNumber+p);E===""&&(E=this._originalTextModel.getEndOfLineSequence()===0?`
`:`\r
`),await this._clipboardService.writeText(E)})),i.getOption(93)||v.push(new Ht("diff.inline.revertChange",m("diff.inline.revertChange.label","Revert this change"),void 0,!0,async()=>{this._editor.revert(this._diff)})),v},autoSelectFirstItem:!0})};this._register(bn(this._diffActions,"mousedown",g=>{if(!g.leftButton)return;let{top:b,height:v}=io(this._diffActions),y=Math.floor(u/3);g.preventDefault(),f(g.posx,b+v+y)})),this._register(i.onMouseMove(g=>{(g.target.type===8||g.target.type===5)&&g.target.detail.viewZoneId===this._getViewZoneId()?(p=this._updateLightBulbPosition(this._marginDomNode,g.event.browserEvent.y,u),this.visibility=!0):this.visibility=!1})),this._register(i.onMouseDown(g=>{g.event.leftButton&&(g.target.type===8||g.target.type===5)&&g.target.detail.viewZoneId===this._getViewZoneId()&&(g.event.preventDefault(),p=this._updateLightBulbPosition(this._marginDomNode,g.event.browserEvent.y,u),f(g.event.posx,g.event.posy+u))}))}_diffActions;_visibility=!1;get visibility(){return this._visibility}set visibility(t){this._visibility!==t&&(this._visibility=t,this._diffActions.style.visibility=t?"visible":"hidden")}_updateLightBulbPosition(t,n,i){let{top:r}=io(t),s=n-r,a=Math.floor(s/i),l=a*i;if(this._diffActions.style.top=`${l}px`,this._viewLineCounts){let d=0;for(let c=0;c<this._viewLineCounts.length;c++)if(d+=this._viewLineCounts[c],a<d)return c}return a}};var L5=Tc("diffEditorWidget",{createHTML:o=>o});function k5(o,e,t,n){on(n,e.fontInfo);let i=t.length>0,r=new va(1e4),s=0,a=0,l=[];for(let p=0;p<o.lineTokens.length;p++){let h=p+1,f=o.lineTokens[p],g=o.lineBreakData[p],b=us.filter(t,h,1,Number.MAX_SAFE_INTEGER);if(g){let v=0;for(let y of g.breakOffsets){let S=f.sliceAndInflate(v,y,0);s=Math.max(s,R5(a,S,us.extractWrapped(b,v,y),i,o.mightContainNonBasicASCII,o.mightContainRTL,e,r)),a++,v=y}l.push(g.breakOffsets.length)}else l.push(1),s=Math.max(s,R5(a,f,b,i,o.mightContainNonBasicASCII,o.mightContainRTL,e,r)),a++}s+=e.scrollBeyondLastColumn;let d=r.build(),c=L5?L5.createHTML(d):d;n.innerHTML=c;let u=s*e.typicalHalfwidthCharacterWidth;return{heightInLines:a,minWidthInPx:u,viewLineCounts:l}}var K_=class{constructor(e,t,n,i){this.lineTokens=e;this.lineBreakData=t;this.mightContainNonBasicASCII=n;this.mightContainRTL=i}},G_=class o{constructor(e,t,n,i,r,s,a,l,d,c,u){this.tabSize=e;this.fontInfo=t;this.disableMonospaceOptimizations=n;this.typicalHalfwidthCharacterWidth=i;this.scrollBeyondLastColumn=r;this.lineHeight=s;this.lineDecorationsWidth=a;this.stopRenderingLineAfter=l;this.renderWhitespace=d;this.renderControlCharacters=c;this.fontLigatures=u}static fromEditor(e){let t=e.getOptions(),n=t.get(51),i=t.get(147);return new o(e.getModel()?.getOptions().tabSize||0,n,t.get(33),n.typicalHalfwidthCharacterWidth,t.get(106),t.get(68),i.decorationsWidth,t.get(119),t.get(101),t.get(96),t.get(52))}};function R5(o,e,t,n,i,r,s,a){a.appendString('<div class="view-line'),n||a.appendString(" char-delete"),a.appendString('" style="top:'),a.appendString(String(o*s.lineHeight)),a.appendString('px;width:1000000px;">');let l=e.getLineContent(),d=Ma.isBasicASCII(l,i),c=Ma.containsRTL(l,d,r),u=Uv(new xc(s.fontInfo.isMonospace&&!s.disableMonospaceOptimizations,s.fontInfo.canUseHalfwidthRightwardsArrow,l,!1,d,c,0,e,t,s.tabSize,0,s.fontInfo.spaceWidth,s.fontInfo.middotWidth,s.fontInfo.wsmiddotWidth,s.stopRenderingLineAfter,s.renderWhitespace,s.renderControlCharacters,s.fontLigatures!==_s.OFF,null),a);return a.appendString("</div>"),u.characterMapping.getHorizontalOffset(u.characterMapping.length)}var Sg=class extends F{constructor(t,n,i,r,s,a,l,d,c,u){super();this._targetWindow=t;this._editors=n;this._diffModel=i;this._options=r;this._diffEditorWidget=s;this._canIgnoreViewZoneUpdateEvent=a;this._origViewZonesToIgnore=l;this._modViewZonesToIgnore=d;this._clipboardService=c;this._contextMenuService=u;let p=at("invalidateAlignmentsState",0),h=this._register(new nn(()=>{p.set(p.get()+1,void 0)},0));this._register(this._editors.original.onDidChangeViewZones(E=>{this._canIgnoreViewZoneUpdateEvent()||h.schedule()})),this._register(this._editors.modified.onDidChangeViewZones(E=>{this._canIgnoreViewZoneUpdateEvent()||h.schedule()})),this._register(this._editors.original.onDidChangeConfiguration(E=>{(E.hasChanged(148)||E.hasChanged(68))&&h.schedule()})),this._register(this._editors.modified.onDidChangeConfiguration(E=>{(E.hasChanged(148)||E.hasChanged(68))&&h.schedule()}));let f=this._diffModel.map(E=>E?Lt(this,E.model.original.onDidChangeTokens,()=>E.model.original.tokenization.backgroundTokenizationState===2):void 0).map((E,C)=>E?.read(C)),g=Pe(E=>{let C=this._diffModel.read(E),w=C?.diff.read(E);if(!C||!w)return null;p.read(E);let L=this._options.renderSideBySide.read(E);return M5(this._editors.original,this._editors.modified,w.mappings,this._origViewZonesToIgnore,this._modViewZonesToIgnore,L)}),b=Pe(E=>{let C=this._diffModel.read(E)?.movedTextToCompare.read(E);if(!C)return null;p.read(E);let w=C.changes.map(_=>new hy(_));return M5(this._editors.original,this._editors.modified,w,this._origViewZonesToIgnore,this._modViewZonesToIgnore,!0)});function v(){let E=document.createElement("div");return E.className="diagonal-fill",E}let y=this._register(new ee);this.viewZones=gl(this,(E,C)=>{y.clear();let w=g.read(E)||[],_=[],L=[],k=this._modifiedTopPadding.read(E);k>0&&L.push({afterLineNumber:0,domNode:document.createElement("div"),heightInPx:k,showInHiddenAreas:!0,suppressMouseDown:!0});let W=this._originalTopPadding.read(E);W>0&&_.push({afterLineNumber:0,domNode:document.createElement("div"),heightInPx:W,showInHiddenAreas:!0,suppressMouseDown:!0});let K=this._options.renderSideBySide.read(E),U=K?void 0:this._editors.modified._getViewModel()?.createLineBreaksComputer();if(U){let ue=this._editors.original.getModel();for(let Xe of w)if(Xe.diff)for(let ze=Xe.originalRange.startLineNumber;ze<Xe.originalRange.endLineNumberExclusive;ze++){if(ze>ue.getLineCount())return{orig:_,mod:L};U?.addRequest(ue.getLineContent(ze),null,null)}}let oe=U?.finalize()??[],Se=0,ne=this._editors.modified.getOption(68),Q=this._diffModel.read(E)?.movedTextToCompare.read(E),de=this._editors.original.getModel()?.mightContainNonBasicASCII()??!1,se=this._editors.original.getModel()?.mightContainRTL()??!1,ie=G_.fromEditor(this._editors.modified);for(let ue of w)if(ue.diff&&!K&&(!this._options.useTrueInlineDiffRendering.read(E)||!py(ue.diff))){if(!ue.originalRange.isEmpty){f.read(E);let ze=document.createElement("div");ze.classList.add("view-lines","line-delete","monaco-mouse-cursor-text");let _e=this._editors.original.getModel();if(ue.originalRange.endLineNumberExclusive-1>_e.getLineCount())return{orig:_,mod:L};let vn=new K_(ue.originalRange.mapToLineArray(Nt=>_e.tokenization.getLineTokens(Nt)),ue.originalRange.mapToLineArray(Nt=>oe[Se++]),de,se),cn=[];for(let Nt of ue.diff.innerChanges||[])cn.push(new Ml(Nt.originalRange.delta(-(ue.diff.original.startLineNumber-1)),uy.className,0));let Bn=k5(vn,ie,cn,ze),di=document.createElement("div");if(di.className="inline-deleted-margin-view-zone",on(di,ie.fontInfo),this._options.renderIndicators.read(E))for(let Nt=0;Nt<Bn.heightInLines;Nt++){let Ai=document.createElement("div");Ai.className=`delete-sign ${we.asClassName(gN)}`,Ai.setAttribute("style",`position:absolute;top:${Nt*ne}px;width:${ie.lineDecorationsWidth}px;height:${ne}px;right:0;`),di.appendChild(Ai)}let ms;y.add(new z_(()=>fn(ms),di,this._editors.modified,ue.diff,this._diffEditorWidget,Bn.viewLineCounts,this._editors.original.getModel(),this._contextMenuService,this._clipboardService));for(let Nt=0;Nt<Bn.viewLineCounts.length;Nt++){let Ai=Bn.viewLineCounts[Nt];Ai>1&&_.push({afterLineNumber:ue.originalRange.startLineNumber+Nt,domNode:v(),heightInPx:(Ai-1)*ne,showInHiddenAreas:!0,suppressMouseDown:!0})}L.push({afterLineNumber:ue.modifiedRange.startLineNumber-1,domNode:ze,heightInPx:Bn.heightInLines*ne,minWidthInPx:Bn.minWidthInPx,marginDomNode:di,setZoneId(Nt){ms=Nt},showInHiddenAreas:!0,suppressMouseDown:!0})}let Xe=document.createElement("div");Xe.className="gutter-delete",_.push({afterLineNumber:ue.originalRange.endLineNumberExclusive-1,domNode:v(),heightInPx:ue.modifiedHeightInPx,marginDomNode:Xe,showInHiddenAreas:!0,suppressMouseDown:!0})}else{let Xe=ue.modifiedHeightInPx-ue.originalHeightInPx;if(Xe>0){if(Q?.lineRangeMapping.original.delta(-1).deltaLength(2).contains(ue.originalRange.endLineNumberExclusive-1))continue;_.push({afterLineNumber:ue.originalRange.endLineNumberExclusive-1,domNode:v(),heightInPx:Xe,showInHiddenAreas:!0,suppressMouseDown:!0})}else{let ze=function(){let vn=document.createElement("div");return vn.className="arrow-revert-change "+we.asClassName(te.arrowRight),C.add(j(vn,"mousedown",cn=>cn.stopPropagation())),C.add(j(vn,"click",cn=>{cn.stopPropagation(),s.revert(ue.diff)})),Ge("div",{},vn)};var Te=ze;if(Q?.lineRangeMapping.modified.delta(-1).deltaLength(2).contains(ue.modifiedRange.endLineNumberExclusive-1))continue;let _e;ue.diff&&ue.diff.modified.isEmpty&&this._options.shouldRenderOldRevertArrows.read(E)&&(_e=ze()),L.push({afterLineNumber:ue.modifiedRange.endLineNumberExclusive-1,domNode:v(),heightInPx:-Xe,marginDomNode:_e,showInHiddenAreas:!0,suppressMouseDown:!0})}}for(let ue of b.read(E)??[]){if(!Q?.lineRangeMapping.original.intersect(ue.originalRange)||!Q?.lineRangeMapping.modified.intersect(ue.modifiedRange))continue;let Xe=ue.modifiedHeightInPx-ue.originalHeightInPx;Xe>0?_.push({afterLineNumber:ue.originalRange.endLineNumberExclusive-1,domNode:v(),heightInPx:Xe,showInHiddenAreas:!0,suppressMouseDown:!0}):L.push({afterLineNumber:ue.modifiedRange.endLineNumberExclusive-1,domNode:v(),heightInPx:-Xe,showInHiddenAreas:!0,suppressMouseDown:!0})}return{orig:_,mod:L}});let S=!1;this._register(this._editors.original.onDidScrollChange(E=>{E.scrollLeftChanged&&!S&&(S=!0,this._editors.modified.setScrollLeft(E.scrollLeft),S=!1)})),this._register(this._editors.modified.onDidScrollChange(E=>{E.scrollLeftChanged&&!S&&(S=!0,this._editors.original.setScrollLeft(E.scrollLeft),S=!1)})),this._originalScrollTop=Lt(this._editors.original.onDidScrollChange,()=>this._editors.original.getScrollTop()),this._modifiedScrollTop=Lt(this._editors.modified.onDidScrollChange,()=>this._editors.modified.getScrollTop()),this._register(rt(E=>{let C=this._originalScrollTop.read(E)-(this._originalScrollOffsetAnimated.get()-this._modifiedScrollOffsetAnimated.read(E))-(this._originalTopPadding.get()-this._modifiedTopPadding.read(E));C!==this._editors.modified.getScrollTop()&&this._editors.modified.setScrollTop(C,1)})),this._register(rt(E=>{let C=this._modifiedScrollTop.read(E)-(this._modifiedScrollOffsetAnimated.get()-this._originalScrollOffsetAnimated.read(E))-(this._modifiedTopPadding.get()-this._originalTopPadding.read(E));C!==this._editors.original.getScrollTop()&&this._editors.original.setScrollTop(C,1)})),this._register(rt(E=>{let C=this._diffModel.read(E)?.movedTextToCompare.read(E),w=0;if(C){let _=this._editors.original.getTopForLineNumber(C.lineRangeMapping.original.startLineNumber,!0)-this._originalTopPadding.get();w=this._editors.modified.getTopForLineNumber(C.lineRangeMapping.modified.startLineNumber,!0)-this._modifiedTopPadding.get()-_}w>0?(this._modifiedTopPadding.set(0,void 0),this._originalTopPadding.set(w,void 0)):w<0?(this._modifiedTopPadding.set(-w,void 0),this._originalTopPadding.set(0,void 0)):setTimeout(()=>{this._modifiedTopPadding.set(0,void 0),this._originalTopPadding.set(0,void 0)},400),this._editors.modified.hasTextFocus()?this._originalScrollOffset.set(this._modifiedScrollOffset.get()-w,void 0,!0):this._modifiedScrollOffset.set(this._originalScrollOffset.get()+w,void 0,!0)}))}_originalTopPadding=at(this,0);_originalScrollTop;_originalScrollOffset=at(this,0);_originalScrollOffsetAnimated=sN(this._targetWindow,this._originalScrollOffset,this._store);_modifiedTopPadding=at(this,0);_modifiedScrollTop;_modifiedScrollOffset=at(this,0);_modifiedScrollOffsetAnimated=sN(this._targetWindow,this._modifiedScrollOffset,this._store);viewZones};Sg=O([x(8,Xw),x(9,Al)],Sg);function M5(o,e,t,n,i,r){let s=new Wi(P5(o,n)),a=new Wi(P5(e,i)),l=o.getOption(68),d=e.getOption(68),c=[],u=0,p=0;function h(g,b){for(;;){let v=s.peek(),y=a.peek();if(v&&v.lineNumber>=g&&(v=void 0),y&&y.lineNumber>=b&&(y=void 0),!v&&!y)break;let S=v?v.lineNumber-u:Number.MAX_VALUE,E=y?y.lineNumber-p:Number.MAX_VALUE;S<E?(s.dequeue(),y={lineNumber:v.lineNumber-u+p,heightInPx:0}):S>E?(a.dequeue(),v={lineNumber:y.lineNumber-p+u,heightInPx:0}):(s.dequeue(),a.dequeue()),c.push({originalRange:Re.ofLength(v.lineNumber,1),modifiedRange:Re.ofLength(y.lineNumber,1),originalHeightInPx:l+v.heightInPx,modifiedHeightInPx:d+y.heightInPx,diff:void 0})}}for(let g of t){let E=function(C,w,_=!1){if(C<S||w<y)return;if(v)v=!1;else if(!_&&(C===S||w===y))return;let L=new Re(S,C),k=new Re(y,w);if(L.isEmpty&&k.isEmpty)return;let W=s.takeWhile(U=>U.lineNumber<C)?.reduce((U,oe)=>U+oe.heightInPx,0)??0,K=a.takeWhile(U=>U.lineNumber<w)?.reduce((U,oe)=>U+oe.heightInPx,0)??0;c.push({originalRange:L,modifiedRange:k,originalHeightInPx:L.length*l+W,modifiedHeightInPx:k.length*d+K,diff:g.lineRangeMapping}),S=C,y=w};var f=E;let b=g.lineRangeMapping;h(b.original.startLineNumber,b.modified.startLineNumber);let v=!0,y=b.modified.startLineNumber,S=b.original.startLineNumber;if(r)for(let C of b.innerChanges||[]){C.originalRange.startColumn>1&&C.modifiedRange.startColumn>1&&E(C.originalRange.startLineNumber,C.modifiedRange.startLineNumber);let w=o.getModel(),_=C.originalRange.endLineNumber<=w.getLineCount()?w.getLineMaxColumn(C.originalRange.endLineNumber):Number.MAX_SAFE_INTEGER;C.originalRange.endColumn<_&&E(C.originalRange.endLineNumber,C.modifiedRange.endLineNumber)}E(b.original.endLineNumberExclusive,b.modified.endLineNumberExclusive,!0),u=b.original.endLineNumberExclusive,p=b.modified.endLineNumberExclusive}return h(Number.MAX_VALUE,Number.MAX_VALUE),c}function P5(o,e){let t=[],n=[],i=o.getOption(148).wrappingColumn!==-1,r=o._getViewModel().coordinatesConverter,s=o.getOption(68);if(i)for(let l=1;l<=o.getModel().getLineCount();l++){let d=r.getModelLineViewLineCount(l);d>1&&n.push({lineNumber:l,heightInPx:s*(d-1)})}for(let l of o.getWhitespaces()){if(e.has(l.id))continue;let d=l.afterLineNumber===0?0:r.convertViewPositionToModelPosition(new A(l.afterLineNumber,1)).lineNumber;t.push({lineNumber:d,heightInPx:l.height})}return a5(t,n,l=>l.lineNumber,(l,d)=>({lineNumber:l.lineNumber,heightInPx:l.heightInPx+d.heightInPx}))}function py(o){return o.innerChanges?o.innerChanges.every(e=>O5(e.modifiedRange)&&O5(e.originalRange)||e.originalRange.equalsRange(new P(1,1,1,1))):!1}function O5(o){return o.startLineNumber===o.endLineNumber}var N5={enableSplitViewResizing:!0,splitViewDefaultRatio:.5,renderSideBySide:!0,renderMarginRevertIcon:!0,renderGutterMenu:!0,maxComputationTime:5e3,maxFileSize:50,ignoreTrimWhitespace:!0,renderIndicators:!0,originalEditable:!1,diffCodeLens:!1,renderOverviewRuler:!0,diffWordWrap:"inherit",diffAlgorithm:"advanced",accessibilityVerbose:!1,experimental:{showMoves:!1,showEmptyDecorations:!0,useTrueInlineView:!1},hideUnchangedRegions:{enabled:!1,contextLineCount:3,minimumLineCount:3,revealLineCount:20},isInEmbeddedEditor:!1,onlyShowAccessibleDiffViewer:!1,renderSideBySideInlineBreakpoint:900,useInlineViewWhenSpaceIsLimited:!0,compactMode:!1};var Eg=class{constructor(e,t){this._accessibilityService=t;let n={...e,...A5(e,N5)};this._options=at(this,n)}_options;get editorOptions(){return this._options}_diffEditorWidth=at(this,0);_screenReaderMode=Lt(this,this._accessibilityService.onDidChangeScreenReaderOptimized,()=>this._accessibilityService.isScreenReaderOptimized());couldShowInlineViewBecauseOfSize=Pe(this,e=>this._options.read(e).renderSideBySide&&this._diffEditorWidth.read(e)<=this._options.read(e).renderSideBySideInlineBreakpoint);renderOverviewRuler=Pe(this,e=>this._options.read(e).renderOverviewRuler);renderSideBySide=Pe(this,e=>this.compactMode.read(e)&&this.shouldRenderInlineViewInSmartMode.read(e)?!1:this._options.read(e).renderSideBySide&&!(this._options.read(e).useInlineViewWhenSpaceIsLimited&&this.couldShowInlineViewBecauseOfSize.read(e)&&!this._screenReaderMode.read(e)));readOnly=Pe(this,e=>this._options.read(e).readOnly);shouldRenderOldRevertArrows=Pe(this,e=>!(!this._options.read(e).renderMarginRevertIcon||!this.renderSideBySide.read(e)||this.readOnly.read(e)||this.shouldRenderGutterMenu.read(e)));shouldRenderGutterMenu=Pe(this,e=>this._options.read(e).renderGutterMenu);renderIndicators=Pe(this,e=>this._options.read(e).renderIndicators);enableSplitViewResizing=Pe(this,e=>this._options.read(e).enableSplitViewResizing);splitViewDefaultRatio=Pe(this,e=>this._options.read(e).splitViewDefaultRatio);ignoreTrimWhitespace=Pe(this,e=>this._options.read(e).ignoreTrimWhitespace);maxComputationTimeMs=Pe(this,e=>this._options.read(e).maxComputationTime);showMoves=Pe(this,e=>this._options.read(e).experimental.showMoves&&this.renderSideBySide.read(e));isInEmbeddedEditor=Pe(this,e=>this._options.read(e).isInEmbeddedEditor);diffWordWrap=Pe(this,e=>this._options.read(e).diffWordWrap);originalEditable=Pe(this,e=>this._options.read(e).originalEditable);diffCodeLens=Pe(this,e=>this._options.read(e).diffCodeLens);accessibilityVerbose=Pe(this,e=>this._options.read(e).accessibilityVerbose);diffAlgorithm=Pe(this,e=>this._options.read(e).diffAlgorithm);showEmptyDecorations=Pe(this,e=>this._options.read(e).experimental.showEmptyDecorations);onlyShowAccessibleDiffViewer=Pe(this,e=>this._options.read(e).onlyShowAccessibleDiffViewer);compactMode=Pe(this,e=>this._options.read(e).compactMode);trueInlineDiffRenderingEnabled=Pe(this,e=>this._options.read(e).experimental.useTrueInlineView);useTrueInlineDiffRendering=Pe(this,e=>!this.renderSideBySide.read(e)&&this.trueInlineDiffRenderingEnabled.read(e));hideUnchangedRegions=Pe(this,e=>this._options.read(e).hideUnchangedRegions.enabled);hideUnchangedRegionsRevealLineCount=Pe(this,e=>this._options.read(e).hideUnchangedRegions.revealLineCount);hideUnchangedRegionsContextLineCount=Pe(this,e=>this._options.read(e).hideUnchangedRegions.contextLineCount);hideUnchangedRegionsMinimumLineCount=Pe(this,e=>this._options.read(e).hideUnchangedRegions.minimumLineCount);updateOptions(e){let t=A5(e,this._options.get()),n={...this._options.get(),...e,...t};this._options.set(n,void 0,{changedOptions:e})}setWidth(e){this._diffEditorWidth.set(e,void 0)}_model=at(this,void 0);setModel(e){this._model.set(e,void 0)}shouldRenderInlineViewInSmartMode=this._model.map(this,e=>SA(this,t=>{let n=e?.diff.read(t);return n?Sq(n,this.trueInlineDiffRenderingEnabled.read(t)):void 0})).flatten().map(this,e=>!!e);inlineViewHideOriginalLineNumbers=this.compactMode};Eg=O([x(1,vo)],Eg);function Sq(o,e){return o.mappings.every(t=>Eq(t.lineRangeMapping)||Tq(t.lineRangeMapping)||e&&py(t.lineRangeMapping))}function Eq(o){return o.original.length===0}function Tq(o){return o.modified.length===0}function A5(o,e){return{enableSplitViewResizing:be(o.enableSplitViewResizing,e.enableSplitViewResizing),splitViewDefaultRatio:vB(o.splitViewDefaultRatio,.5,.1,.9),renderSideBySide:be(o.renderSideBySide,e.renderSideBySide),renderMarginRevertIcon:be(o.renderMarginRevertIcon,e.renderMarginRevertIcon),maxComputationTime:Fd(o.maxComputationTime,e.maxComputationTime,0,1073741824),maxFileSize:Fd(o.maxFileSize,e.maxFileSize,0,1073741824),ignoreTrimWhitespace:be(o.ignoreTrimWhitespace,e.ignoreTrimWhitespace),renderIndicators:be(o.renderIndicators,e.renderIndicators),originalEditable:be(o.originalEditable,e.originalEditable),diffCodeLens:be(o.diffCodeLens,e.diffCodeLens),renderOverviewRuler:be(o.renderOverviewRuler,e.renderOverviewRuler),diffWordWrap:Jt(o.diffWordWrap,e.diffWordWrap,["off","on","inherit"]),diffAlgorithm:Jt(o.diffAlgorithm,e.diffAlgorithm,["legacy","advanced"],{smart:"legacy",experimental:"advanced"}),accessibilityVerbose:be(o.accessibilityVerbose,e.accessibilityVerbose),experimental:{showMoves:be(o.experimental?.showMoves,e.experimental.showMoves),showEmptyDecorations:be(o.experimental?.showEmptyDecorations,e.experimental.showEmptyDecorations),useTrueInlineView:be(o.experimental?.useTrueInlineView,e.experimental.useTrueInlineView)},hideUnchangedRegions:{enabled:be(o.hideUnchangedRegions?.enabled??o.experimental?.collapseUnchangedRegions,e.hideUnchangedRegions.enabled),contextLineCount:Fd(o.hideUnchangedRegions?.contextLineCount,e.hideUnchangedRegions.contextLineCount,0,1073741824),minimumLineCount:Fd(o.hideUnchangedRegions?.minimumLineCount,e.hideUnchangedRegions.minimumLineCount,0,1073741824),revealLineCount:Fd(o.hideUnchangedRegions?.revealLineCount,e.hideUnchangedRegions.revealLineCount,0,1073741824)},isInEmbeddedEditor:be(o.isInEmbeddedEditor,e.isInEmbeddedEditor),onlyShowAccessibleDiffViewer:be(o.onlyShowAccessibleDiffViewer,e.onlyShowAccessibleDiffViewer),renderSideBySideInlineBreakpoint:Fd(o.renderSideBySideInlineBreakpoint,e.renderSideBySideInlineBreakpoint,0,1073741824),useInlineViewWhenSpaceIsLimited:be(o.useInlineViewWhenSpaceIsLimited,e.useInlineViewWhenSpaceIsLimited),renderGutterMenu:be(o.renderGutterMenu,e.renderGutterMenu),compactMode:be(o.compactMode,e.compactMode)}}var Tg=class extends F{constructor(t,n,i){super();this.model=t;this._options=n;this._diffProviderFactoryService=i;this._register(le(()=>this._cancellationTokenSource.cancel()));let r=Gc("contentChangedSignal"),s=this._register(new nn(()=>r.trigger(void 0),200));this._register(rt(l=>{let d=this._unchangedRegions.read(l);if(!d||d.regions.some(g=>g.isDragged.read(l)))return;let c=d.originalDecorationIds.map(g=>t.original.getDecorationRange(g)).map(g=>g?Re.fromRangeInclusive(g):void 0),u=d.modifiedDecorationIds.map(g=>t.modified.getDecorationRange(g)).map(g=>g?Re.fromRangeInclusive(g):void 0),p=d.regions.map((g,b)=>!c[b]||!u[b]?void 0:new xg(c[b].startLineNumber,u[b].startLineNumber,c[b].length,g.visibleLineCountTop.read(l),g.visibleLineCountBottom.read(l))).filter(bl),h=[],f=!1;for(let g of kp(p,(b,v)=>b.getHiddenModifiedRange(l).endLineNumberExclusive===v.getHiddenModifiedRange(l).startLineNumber))if(g.length>1){f=!0;let b=g.reduce((y,S)=>y+S.lineCount,0),v=new xg(g[0].originalLineNumber,g[0].modifiedLineNumber,b,g[0].visibleLineCountTop.get(),g[g.length-1].visibleLineCountBottom.get());h.push(v)}else h.push(g[0]);if(f){let g=t.original.deltaDecorations(d.originalDecorationIds,h.map(v=>({range:v.originalUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}}))),b=t.modified.deltaDecorations(d.modifiedDecorationIds,h.map(v=>({range:v.modifiedUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}})));Xt(v=>{this._unchangedRegions.set({regions:h,originalDecorationIds:g,modifiedDecorationIds:b},v)})}}));let a=(l,d,c)=>{let u=xg.fromDiffs(l.changes,t.original.getLineCount(),t.modified.getLineCount(),this._options.hideUnchangedRegionsMinimumLineCount.read(c),this._options.hideUnchangedRegionsContextLineCount.read(c)),p,h=this._unchangedRegions.get();if(h){let v=h.originalDecorationIds.map(C=>t.original.getDecorationRange(C)).map(C=>C?Re.fromRangeInclusive(C):void 0),y=h.modifiedDecorationIds.map(C=>t.modified.getDecorationRange(C)).map(C=>C?Re.fromRangeInclusive(C):void 0),E=d5(h.regions.map((C,w)=>{if(!v[w]||!y[w])return;let _=v[w].length;return new xg(v[w].startLineNumber,y[w].startLineNumber,_,Math.min(C.visibleLineCountTop.get(),_),Math.min(C.visibleLineCountBottom.get(),_-C.visibleLineCountTop.get()))}).filter(bl),(C,w)=>!w||C.modifiedLineNumber>=w.modifiedLineNumber+w.lineCount&&C.originalLineNumber>=w.originalLineNumber+w.lineCount).map(C=>new Xi(C.getHiddenOriginalRange(c),C.getHiddenModifiedRange(c)));E=Xi.clip(E,Re.ofLength(1,t.original.getLineCount()),Re.ofLength(1,t.modified.getLineCount())),p=Xi.inverse(E,t.original.getLineCount(),t.modified.getLineCount())}let f=[];if(p)for(let v of u){let y=p.filter(S=>S.original.intersectsStrict(v.originalUnchangedRange)&&S.modified.intersectsStrict(v.modifiedUnchangedRange));f.push(...v.setVisibleRanges(y,d))}else f.push(...u);let g=t.original.deltaDecorations(h?.originalDecorationIds||[],f.map(v=>({range:v.originalUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}}))),b=t.modified.deltaDecorations(h?.modifiedDecorationIds||[],f.map(v=>({range:v.modifiedUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}})));this._unchangedRegions.set({regions:f,originalDecorationIds:g,modifiedDecorationIds:b},d)};this._register(t.modified.onDidChangeContent(l=>{if(this._diff.get()){let c=ds.fromModelContentChanges(l.changes),u=(this._lastDiff,t.original,t.modified,void 0);u&&(this._lastDiff=u,Xt(p=>{this._diff.set(my.fromDiffResult(this._lastDiff),p),a(u,p);let h=this.movedTextToCompare.get();this.movedTextToCompare.set(h?this._lastDiff.moves.find(f=>f.lineRangeMapping.modified.intersect(h.lineRangeMapping.modified)):void 0,p)}))}this._isDiffUpToDate.set(!1,void 0),s.schedule()})),this._register(t.original.onDidChangeContent(l=>{if(this._diff.get()){let c=ds.fromModelContentChanges(l.changes),u=(this._lastDiff,t.original,t.modified,void 0);u&&(this._lastDiff=u,Xt(p=>{this._diff.set(my.fromDiffResult(this._lastDiff),p),a(u,p);let h=this.movedTextToCompare.get();this.movedTextToCompare.set(h?this._lastDiff.moves.find(f=>f.lineRangeMapping.modified.intersect(h.lineRangeMapping.modified)):void 0,p)}))}this._isDiffUpToDate.set(!1,void 0),s.schedule()})),this._register(Ei(async(l,d)=>{this._options.hideUnchangedRegionsMinimumLineCount.read(l),this._options.hideUnchangedRegionsContextLineCount.read(l),s.cancel(),r.read(l);let c=this._diffProvider.read(l);c.onChangeSignal.read(l),hs(U_,l),hs(cy,l),this._isDiffUpToDate.set(!1,void 0);let u=[];d.add(t.original.onDidChangeContent(f=>{let g=ds.fromModelContentChanges(f.changes);u=ym(u,g)}));let p=[];d.add(t.modified.onDidChangeContent(f=>{let g=ds.fromModelContentChanges(f.changes);p=ym(p,g)}));let h=await c.diffProvider.computeDiff(t.original,t.modified,{ignoreTrimWhitespace:this._options.ignoreTrimWhitespace.read(l),maxComputationTimeMs:this._options.maxComputationTimeMs.read(l),computeMoves:this._options.showMoves.read(l)},this._cancellationTokenSource.token);this._cancellationTokenSource.token.isCancellationRequested||t.original.isDisposed()||t.modified.isDisposed()||(h=xq(h,t.original,t.modified),h=(t.original,t.modified,void 0)??h,h=(t.original,t.modified,void 0)??h,Xt(f=>{a(h,f),this._lastDiff=h;let g=my.fromDiffResult(h);this._diff.set(g,f),this._isDiffUpToDate.set(!0,f);let b=this.movedTextToCompare.get();this.movedTextToCompare.set(b?this._lastDiff.moves.find(v=>v.lineRangeMapping.modified.intersect(b.lineRangeMapping.modified)):void 0,f)}))}))}_isDiffUpToDate=at(this,!1);isDiffUpToDate=this._isDiffUpToDate;_lastDiff;_diff=at(this,void 0);diff=this._diff;_unchangedRegions=at(this,void 0);unchangedRegions=Pe(this,t=>this._options.hideUnchangedRegions.read(t)?this._unchangedRegions.read(t)?.regions??[]:(Xt(n=>{for(let i of this._unchangedRegions.get()?.regions||[])i.collapseAll(n)}),[]));movedTextToCompare=at(this,void 0);_activeMovedText=at(this,void 0);_hoveredMovedText=at(this,void 0);activeMovedText=Pe(this,t=>this.movedTextToCompare.read(t)??this._hoveredMovedText.read(t)??this._activeMovedText.read(t));setActiveMovedText(t){this._activeMovedText.set(t,void 0)}setHoveredMovedText(t){this._hoveredMovedText.set(t,void 0)}_cancellationTokenSource=new zn;_diffProvider=Pe(this,t=>{let n=this._diffProviderFactoryService.createDiffProvider({diffAlgorithm:this._options.diffAlgorithm.read(t)}),i=Ti("onDidChange",n.onDidChange);return{diffProvider:n,onChangeSignal:i}});ensureModifiedLineIsVisible(t,n,i){if(this.diff.get()?.mappings.length===0)return;let r=this._unchangedRegions.get()?.regions||[];for(let s of r)if(s.getHiddenModifiedRange(void 0).contains(t)){s.showModifiedLine(t,n,i);return}}ensureOriginalLineIsVisible(t,n,i){if(this.diff.get()?.mappings.length===0)return;let r=this._unchangedRegions.get()?.regions||[];for(let s of r)if(s.getHiddenOriginalRange(void 0).contains(t)){s.showOriginalLine(t,n,i);return}}async waitForDiff(){await QD(this.isDiffUpToDate,t=>t)}serializeState(){return{collapsedRegions:this._unchangedRegions.get()?.regions.map(n=>({range:n.getHiddenModifiedRange(void 0).serialize()}))}}restoreSerializedState(t){let n=t.collapsedRegions?.map(r=>Re.deserialize(r.range)),i=this._unchangedRegions.get();!i||!n||Xt(r=>{for(let s of i.regions)for(let a of n)if(s.modifiedUnchangedRange.intersect(a)){s.setHiddenModifiedRange(a,r);break}})}};Tg=O([x(2,cN)],Tg);function xq(o,e,t){return{changes:o.changes.map(n=>new hr(n.original,n.modified,n.innerChanges?n.innerChanges.map(i=>wq(i,e,t)):void 0)),moves:o.moves,identical:o.identical,quitEarly:o.quitEarly}}function wq(o,e,t){let n=o.originalRange,i=o.modifiedRange;return n.startColumn===1&&i.startColumn===1&&(n.endColumn!==1||i.endColumn!==1)&&n.endColumn===e.getLineMaxColumn(n.endLineNumber)&&i.endColumn===t.getLineMaxColumn(i.endLineNumber)&&n.endLineNumber<e.getLineCount()&&i.endLineNumber<t.getLineCount()&&(n=n.setEndPosition(n.endLineNumber+1,1),i=i.setEndPosition(i.endLineNumber+1,1)),new oo(n,i)}var my=class o{constructor(e,t,n,i){this.mappings=e;this.movedTexts=t;this.identical=n;this.quitEarly=i}static fromDiffResult(e){return new o(e.changes.map(t=>new hy(t)),e.moves||[],e.identical,e.quitEarly)}},hy=class{constructor(e){this.lineRangeMapping=e}},xg=class o{constructor(e,t,n,i,r){this.originalLineNumber=e;this.modifiedLineNumber=t;this.lineCount=n;let s=Math.max(Math.min(i,this.lineCount),0),a=Math.max(Math.min(r,this.lineCount-i),0);GD(i===s),GD(r===a),this._visibleLineCountTop.set(s,void 0),this._visibleLineCountBottom.set(a,void 0)}static fromDiffs(e,t,n,i,r){let s=hr.inverse(e,t,n),a=[];for(let l of s){let d=l.original.startLineNumber,c=l.modified.startLineNumber,u=l.original.length,p=d===1&&c===1,h=d+u===t+1&&c+u===n+1;(p||h)&&u>=r+i?(p&&!h&&(u-=r),h&&!p&&(d+=r,c+=r,u-=r),a.push(new o(d,c,u,0,0))):u>=r*2+i&&(d+=r,c+=r,u-=r*2,a.push(new o(d,c,u,0,0)))}return a}get originalUnchangedRange(){return Re.ofLength(this.originalLineNumber,this.lineCount)}get modifiedUnchangedRange(){return Re.ofLength(this.modifiedLineNumber,this.lineCount)}_visibleLineCountTop=at(this,0);visibleLineCountTop=this._visibleLineCountTop;_visibleLineCountBottom=at(this,0);visibleLineCountBottom=this._visibleLineCountBottom;_shouldHideControls=Pe(this,e=>this.visibleLineCountTop.read(e)+this.visibleLineCountBottom.read(e)===this.lineCount&&!this.isDragged.read(e));isDragged=at(this,void 0);setVisibleRanges(e,t){let n=[],i=new Pr(e.map(l=>l.modified)).subtractFrom(this.modifiedUnchangedRange),r=this.originalLineNumber,s=this.modifiedLineNumber,a=this.modifiedLineNumber+this.lineCount;if(i.ranges.length===0)this.showAll(t),n.push(this);else{let l=0;for(let d of i.ranges){let c=l===i.ranges.length-1;l++;let u=(c?a:d.endLineNumberExclusive)-s,p=new o(r,s,u,0,0);p.setHiddenModifiedRange(d,t),n.push(p),r=p.originalUnchangedRange.endLineNumberExclusive,s=p.modifiedUnchangedRange.endLineNumberExclusive}}return n}shouldHideControls(e){return this._shouldHideControls.read(e)}getHiddenOriginalRange(e){return Re.ofLength(this.originalLineNumber+this._visibleLineCountTop.read(e),this.lineCount-this._visibleLineCountTop.read(e)-this._visibleLineCountBottom.read(e))}getHiddenModifiedRange(e){return Re.ofLength(this.modifiedLineNumber+this._visibleLineCountTop.read(e),this.lineCount-this._visibleLineCountTop.read(e)-this._visibleLineCountBottom.read(e))}setHiddenModifiedRange(e,t){let n=e.startLineNumber-this.modifiedLineNumber,i=this.modifiedLineNumber+this.lineCount-e.endLineNumberExclusive;this.setState(n,i,t)}getMaxVisibleLineCountTop(){return this.lineCount-this._visibleLineCountBottom.get()}getMaxVisibleLineCountBottom(){return this.lineCount-this._visibleLineCountTop.get()}showMoreAbove(e=10,t){let n=this.getMaxVisibleLineCountTop();this._visibleLineCountTop.set(Math.min(this._visibleLineCountTop.get()+e,n),t)}showMoreBelow(e=10,t){let n=this.lineCount-this._visibleLineCountTop.get();this._visibleLineCountBottom.set(Math.min(this._visibleLineCountBottom.get()+e,n),t)}showAll(e){this._visibleLineCountBottom.set(this.lineCount-this._visibleLineCountTop.get(),e)}showModifiedLine(e,t,n){let i=e+1-(this.modifiedLineNumber+this._visibleLineCountTop.get()),r=this.modifiedLineNumber-this._visibleLineCountBottom.get()+this.lineCount-e;t===0&&i<r||t===1?this._visibleLineCountTop.set(this._visibleLineCountTop.get()+i,n):this._visibleLineCountBottom.set(this._visibleLineCountBottom.get()+r,n)}showOriginalLine(e,t,n){let i=e-this.originalLineNumber,r=this.originalLineNumber+this.lineCount-e;t===0&&i<r||t===1?this._visibleLineCountTop.set(Math.min(this._visibleLineCountTop.get()+r-i,this.getMaxVisibleLineCountTop()),n):this._visibleLineCountBottom.set(Math.min(this._visibleLineCountBottom.get()+i-r,this.getMaxVisibleLineCountBottom()),n)}collapseAll(e){this._visibleLineCountTop.set(0,e),this._visibleLineCountBottom.set(0,e)}setState(e,t,n){e=Math.max(Math.min(e,this.lineCount),0),t=Math.max(Math.min(t,this.lineCount-e),0),this._visibleLineCountTop.set(e,n),this._visibleLineCountBottom.set(t,n)}};var Si=class extends F{constructor(t,n,i,r,s,a,l){super();this._editors=t;this._rootElement=n;this._diffModel=i;this._rootWidth=r;this._rootHeight=s;this._modifiedEditorLayoutInfo=a;this._themeService=l;let d=Lt(this._themeService.onDidColorThemeChange,()=>this._themeService.getColorTheme()),c=Pe(h=>{let f=d.read(h),g=f.getColor(l2)||(f.getColor(s2)||AS).transparent(2),b=f.getColor(d2)||(f.getColor(a2)||FS).transparent(2);return{insertColor:g,removeColor:b}}),u=We(document.createElement("div"));u.setClassName("diffViewport"),u.setPosition("absolute");let p=yt("div.diffOverview",{style:{position:"absolute",top:"0px",width:Si.ENTIRE_DIFF_OVERVIEW_WIDTH+"px"}}).root;this._register(Ep(p,u.domNode)),this._register(bn(p,me.POINTER_DOWN,h=>{this._editors.modified.delegateVerticalScrollbarPointerDown(h)})),this._register(j(p,me.MOUSE_WHEEL,h=>{this._editors.modified.delegateScrollFromMouseWheelEvent(h)},{passive:!1})),this._register(Ep(this._rootElement,p)),this._register(Ei((h,f)=>{let g=this._diffModel.read(h),b=this._editors.original.createOverviewRuler("original diffOverviewRuler");b&&(f.add(b),f.add(Ep(p,b.getDomNode())));let v=this._editors.modified.createOverviewRuler("modified diffOverviewRuler");if(v&&(f.add(v),f.add(Ep(p,v.getDomNode()))),!b||!v)return;let y=Ti("viewZoneChanged",this._editors.original.onDidChangeViewZones),S=Ti("viewZoneChanged",this._editors.modified.onDidChangeViewZones),E=Ti("hiddenRangesChanged",this._editors.original.onDidChangeHiddenAreas),C=Ti("hiddenRangesChanged",this._editors.modified.onDidChangeHiddenAreas);f.add(rt(w=>{y.read(w),S.read(w),E.read(w),C.read(w);let _=c.read(w),L=g?.diff.read(w)?.mappings;function k(U,oe,Se){let ne=Se._getViewModel();return ne?U.filter(Q=>Q.length>0).map(Q=>{let de=ne.coordinatesConverter.convertModelPositionToViewPosition(new A(Q.startLineNumber,1)),se=ne.coordinatesConverter.convertModelPositionToViewPosition(new A(Q.endLineNumberExclusive,1)),ie=se.lineNumber-de.lineNumber;return new Vb(de.lineNumber,se.lineNumber,ie,oe.toString())}):[]}let W=k((L||[]).map(U=>U.lineRangeMapping.original),_.removeColor,this._editors.original),K=k((L||[]).map(U=>U.lineRangeMapping.modified),_.insertColor,this._editors.modified);b?.setZones(W),v?.setZones(K)})),f.add(rt(w=>{let _=this._rootHeight.read(w),L=this._rootWidth.read(w),k=this._modifiedEditorLayoutInfo.read(w);if(k){let W=Si.ENTIRE_DIFF_OVERVIEW_WIDTH-2*Si.ONE_OVERVIEW_WIDTH;b.setLayout({top:0,height:_,right:W+Si.ONE_OVERVIEW_WIDTH,width:Si.ONE_OVERVIEW_WIDTH}),v.setLayout({top:0,height:_,right:0,width:Si.ONE_OVERVIEW_WIDTH});let K=this._editors.modifiedScrollTop.read(w),U=this._editors.modifiedScrollHeight.read(w),oe=this._editors.modified.getOption(105),Se=new ic(oe.verticalHasArrows?oe.arrowSize:0,oe.verticalScrollbarSize,0,k.height,U,K);u.setTop(Se.getSliderPosition()),u.setHeight(Se.getSliderSize())}else u.setTop(0),u.setHeight(0);p.style.height=_+"px",p.style.left=L-Si.ENTIRE_DIFF_OVERVIEW_WIDTH+"px",u.setWidth(Si.ENTIRE_DIFF_OVERVIEW_WIDTH)}))}))}static ONE_OVERVIEW_WIDTH=15;static ENTIRE_DIFF_OVERVIEW_WIDTH=this.ONE_OVERVIEW_WIDTH*2;width=Si.ENTIRE_DIFF_OVERVIEW_WIDTH};Si=O([x(6,Ko)],Si);var wg=class extends F{constructor(t,n,i,r,s,a,l){super();this.originalEditorElement=t;this.modifiedEditorElement=n;this._options=i;this._argCodeEditorWidgetOptions=r;this._createInnerEditor=s;this._instantiationService=a;this._keybindingService=l;this._argCodeEditorWidgetOptions=null,this._register(cd({createEmptyChangeSummary:()=>({}),handleChange:(d,c)=>(d.didChange(i.editorOptions)&&Object.assign(c,d.change.changedOptions),!0)},(d,c)=>{i.editorOptions.read(d),this._options.renderSideBySide.read(d),this.modified.updateOptions(this._adjustOptionsForRightHandSide(d,c)),this.original.updateOptions(this._adjustOptionsForLeftHandSide(d,c))}))}original=this._register(this._createLeftHandSideEditor(this._options.editorOptions.get(),this._argCodeEditorWidgetOptions.originalEditor||{}));modified=this._register(this._createRightHandSideEditor(this._options.editorOptions.get(),this._argCodeEditorWidgetOptions.modifiedEditor||{}));_onDidContentSizeChange=this._register(new D);get onDidContentSizeChange(){return this._onDidContentSizeChange.event}modifiedScrollTop=Lt(this,this.modified.onDidScrollChange,()=>this.modified.getScrollTop());modifiedScrollHeight=Lt(this,this.modified.onDidScrollChange,()=>this.modified.getScrollHeight());modifiedObs=Tp(this.modified);originalObs=Tp(this.original);modifiedModel=this.modifiedObs.model;modifiedSelections=Lt(this,this.modified.onDidChangeCursorSelection,()=>this.modified.getSelections()??[]);modifiedCursor=ua({owner:this,equalsFn:A.equals},t=>this.modifiedSelections.read(t)[0]?.getPosition()??new A(1,1));originalCursor=Lt(this,this.original.onDidChangeCursorPosition,()=>this.original.getPosition()??new A(1,1));isOriginalFocused=Tp(this.original).isFocused;isModifiedFocused=Tp(this.modified).isFocused;isFocused=Pe(this,t=>this.isOriginalFocused.read(t)||this.isModifiedFocused.read(t));_createLeftHandSideEditor(t,n){let i=this._adjustOptionsForLeftHandSide(void 0,t),r=this._constructInnerEditor(this._instantiationService,this.originalEditorElement,i,n);return r.setContextValue("isInDiffLeftEditor",!0),r}_createRightHandSideEditor(t,n){let i=this._adjustOptionsForRightHandSide(void 0,t),r=this._constructInnerEditor(this._instantiationService,this.modifiedEditorElement,i,n);return r.setContextValue("isInDiffRightEditor",!0),r}_constructInnerEditor(t,n,i,r){let s=this._createInnerEditor(t,n,i,r);return this._register(s.onDidContentSizeChange(a=>{let l=this.original.getContentWidth()+this.modified.getContentWidth()+Si.ENTIRE_DIFF_OVERVIEW_WIDTH,d=Math.max(this.modified.getContentHeight(),this.original.getContentHeight());this._onDidContentSizeChange.fire({contentHeight:d,contentWidth:l,contentHeightChanged:a.contentHeightChanged,contentWidthChanged:a.contentWidthChanged})})),s}_adjustOptionsForLeftHandSide(t,n){let i=this._adjustOptionsForSubEditor(n);return this._options.renderSideBySide.get()?(i.unicodeHighlight=this._options.editorOptions.get().unicodeHighlight||{},i.wordWrapOverride1=this._options.diffWordWrap.get()):(i.wordWrapOverride1="off",i.wordWrapOverride2="off",i.stickyScroll={enabled:!1},i.unicodeHighlight={nonBasicASCII:!1,ambiguousCharacters:!1,invisibleCharacters:!1}),i.glyphMargin=this._options.renderSideBySide.get(),n.originalAriaLabel&&(i.ariaLabel=n.originalAriaLabel),i.ariaLabel=this._updateAriaLabel(i.ariaLabel),i.readOnly=!this._options.originalEditable.get(),i.dropIntoEditor={enabled:!i.readOnly},i.extraEditorClassName="original-in-monaco-diff-editor",i}_adjustOptionsForRightHandSide(t,n){let i=this._adjustOptionsForSubEditor(n);return n.modifiedAriaLabel&&(i.ariaLabel=n.modifiedAriaLabel),i.ariaLabel=this._updateAriaLabel(i.ariaLabel),i.wordWrapOverride1=this._options.diffWordWrap.get(),i.revealHorizontalRightPadding=Jr.revealHorizontalRightPadding.defaultValue+Si.ENTIRE_DIFF_OVERVIEW_WIDTH,i.scrollbar.verticalHasArrows=!1,i.extraEditorClassName="modified-in-monaco-diff-editor",i}_adjustOptionsForSubEditor(t){let n={...t,dimension:{height:0,width:0}};return n.inDiffEditor=!0,n.automaticLayout=!1,n.scrollbar={...n.scrollbar||{}},n.folding=!1,n.codeLens=this._options.diffCodeLens.get(),n.fixedOverflowWidgets=!0,n.minimap={...n.minimap||{}},n.minimap.enabled=!1,this._options.hideUnchangedRegions.get()?n.stickyScroll={enabled:!1}:n.stickyScroll=this._options.editorOptions.get().stickyScroll,n}_updateAriaLabel(t){t||(t="");let n=m("diff-aria-navigation-tip"," use {0} to open the accessibility help.",this._keybindingService.lookupKeybinding("editor.action.accessibilityHelp")?.getAriaLabel());return this._options.accessibilityVerbose.get()?t+n:t?t.replaceAll(n,""):""}};wg=O([x(5,Oe),x(6,oi)],wg);var _q=or("diff-review-insert",te.add,m("accessibleDiffViewerInsertIcon","Icon for 'Insert' in accessible diff viewer.")),Dq=or("diff-review-remove",te.remove,m("accessibleDiffViewerRemoveIcon","Icon for 'Remove' in accessible diff viewer.")),Lq=or("diff-review-close",te.close,m("accessibleDiffViewerCloseIcon","Icon for 'Close' in accessible diff viewer.")),tl=class extends F{constructor(t,n,i,r,s,a,l,d,c){super();this._parentNode=t;this._visible=n;this._setVisible=i;this._canClose=r;this._width=s;this._height=a;this._diffs=l;this._models=d;this._instantiationService=c}static _ttPolicy=Tc("diffReview",{createHTML:t=>t});_state=gl(this,(t,n)=>{let i=this._visible.read(t);if(this._parentNode.style.visibility=i?"visible":"hidden",!i)return null;let r=n.add(this._instantiationService.createInstance(fy,this._diffs,this._models,this._setVisible,this._canClose)),s=n.add(this._instantiationService.createInstance(by,this._parentNode,r,this._width,this._height,this._models));return{model:r,view:s}}).recomputeInitiallyAndOnChange(this._store);next(){Xt(t=>{let n=this._visible.get();this._setVisible(!0,t),n&&this._state.get().model.nextGroup(t)})}prev(){Xt(t=>{this._setVisible(!0,t),this._state.get().model.previousGroup(t)})}close(){Xt(t=>{this._setVisible(!1,t)})}};tl=O([x(8,Oe)],tl);var fy=class extends F{constructor(t,n,i,r,s){super();this._diffs=t;this._models=n;this._setVisible=i;this.canClose=r;this._accessibilitySignalService=s;this._register(rt(a=>{let l=this._diffs.read(a);if(!l){this._groups.set([],void 0);return}let d=Rq(l,this._models.getOriginalModel().getLineCount(),this._models.getModifiedModel().getLineCount());Xt(c=>{let u=this._models.getModifiedPosition();if(u){let p=d.findIndex(h=>u?.lineNumber<h.range.modified.endLineNumberExclusive);p!==-1&&this._currentGroupIdx.set(p,c)}this._groups.set(d,c)})})),this._register(rt(a=>{let l=this.currentElement.read(a);l?.type===2?this._accessibilitySignalService.playSignal(yr.diffLineDeleted,{source:"accessibleDiffViewer.currentElementChanged"}):l?.type===3&&this._accessibilitySignalService.playSignal(yr.diffLineInserted,{source:"accessibleDiffViewer.currentElementChanged"})})),this._register(rt(a=>{let l=this.currentElement.read(a);if(l&&l.type!==0){let d=l.modifiedLineNumber??l.diff.modified.startLineNumber;this._models.modifiedSetSelection(P.fromPositions(new A(d,1)))}}))}_groups=at(this,[]);_currentGroupIdx=at(this,0);_currentElementIdx=at(this,0);groups=this._groups;currentGroup=this._currentGroupIdx.map((t,n)=>this._groups.read(n)[t]);currentGroupIndex=this._currentGroupIdx;currentElement=this._currentElementIdx.map((t,n)=>this.currentGroup.read(n)?.lines[t]);_goToGroupDelta(t,n){let i=this.groups.get();!i||i.length<=1||jc(n,r=>{this._currentGroupIdx.set(ke.ofLength(i.length).clipCyclic(this._currentGroupIdx.get()+t),r),this._currentElementIdx.set(0,r)})}nextGroup(t){this._goToGroupDelta(1,t)}previousGroup(t){this._goToGroupDelta(-1,t)}_goToLineDelta(t){let n=this.currentGroup.get();!n||n.lines.length<=1||Xt(i=>{this._currentElementIdx.set(ke.ofLength(n.lines.length).clip(this._currentElementIdx.get()+t),i)})}goToNextLine(){this._goToLineDelta(1)}goToPreviousLine(){this._goToLineDelta(-1)}goToLine(t){let n=this.currentGroup.get();if(!n)return;let i=n.lines.indexOf(t);i!==-1&&Xt(r=>{this._currentElementIdx.set(i,r)})}revealCurrentElementInEditor(){if(!this.canClose.get())return;this._setVisible(!1,void 0);let t=this.currentElement.get();t&&(t.type===2?this._models.originalReveal(P.fromPositions(new A(t.originalLineNumber,1))):this._models.modifiedReveal(t.type!==0?P.fromPositions(new A(t.modifiedLineNumber,1)):void 0))}close(){this.canClose.get()&&(this._setVisible(!1,void 0),this._models.modifiedFocus())}};fy=O([x(4,A_)],fy);var gy=3;function Rq(o,e,t){let n=[];for(let i of kp(o,(r,s)=>s.modified.startLineNumber-r.modified.endLineNumberExclusive<2*gy)){let r=[];r.push(new SN);let s=new Re(Math.max(1,i[0].original.startLineNumber-gy),Math.min(i[i.length-1].original.endLineNumberExclusive+gy,e+1)),a=new Re(Math.max(1,i[0].modified.startLineNumber-gy),Math.min(i[i.length-1].modified.endLineNumberExclusive+gy,t+1));xy(i,(c,u)=>{let p=new Re(c?c.original.endLineNumberExclusive:s.startLineNumber,u?u.original.startLineNumber:s.endLineNumberExclusive),h=new Re(c?c.modified.endLineNumberExclusive:a.startLineNumber,u?u.modified.startLineNumber:a.endLineNumberExclusive);p.forEach(f=>{r.push(new xN(f,h.startLineNumber+(f-p.startLineNumber)))}),u&&(u.original.forEach(f=>{r.push(new EN(u,f))}),u.modified.forEach(f=>{r.push(new TN(u,f))}))});let l=i[0].modified.join(i[i.length-1].modified),d=i[0].original.join(i[i.length-1].original);n.push(new CN(new Xi(l,d),r))}return n}var CN=class{constructor(e,t){this.range=e;this.lines=t}},SN=class{type=0},EN=class{constructor(e,t){this.diff=e;this.originalLineNumber=t}type=2;modifiedLineNumber=void 0},TN=class{constructor(e,t){this.diff=e;this.modifiedLineNumber=t}type=3;originalLineNumber=void 0},xN=class{constructor(e,t){this.originalLineNumber=e;this.modifiedLineNumber=t}type=1},by=class extends F{constructor(t,n,i,r,s,a){super();this._element=t;this._model=n;this._width=i;this._height=r;this._models=s;this._languageService=a;this.domNode=this._element,this.domNode.className="monaco-component diff-review monaco-editor-background";let l=document.createElement("div");l.className="diff-review-actions",this._actionBar=this._register(new fr(l)),this._register(rt(d=>{this._actionBar.clear(),this._model.canClose.read(d)&&this._actionBar.push(new Ht("diffreview.close",m("label.close","Close"),"close-diff-review "+we.asClassName(Lq),!0,async()=>n.close()),{label:!1,icon:!0})})),this._content=document.createElement("div"),this._content.className="diff-review-content",this._content.setAttribute("role","code"),this._scrollbar=this._register(new Fu(this._content,{})),Br(this.domNode,this._scrollbar.getDomNode(),l),this._register(rt(d=>{this._height.read(d),this._width.read(d),this._scrollbar.scanDomNode()})),this._register(le(()=>{Br(this.domNode)})),this._register(Kr(this.domNode,{width:this._width,height:this._height})),this._register(Kr(this._content,{width:this._width,height:this._height})),this._register(Ei((d,c)=>{this._model.currentGroup.read(d),this._render(c)})),this._register(bn(this.domNode,"keydown",d=>{(d.equals(18)||d.equals(2066)||d.equals(530))&&(d.preventDefault(),this._model.goToNextLine()),(d.equals(16)||d.equals(2064)||d.equals(528))&&(d.preventDefault(),this._model.goToPreviousLine()),(d.equals(9)||d.equals(2057)||d.equals(521)||d.equals(1033))&&(d.preventDefault(),this._model.close()),(d.equals(10)||d.equals(3))&&(d.preventDefault(),this._model.revealCurrentElementInEditor())}))}domNode;_content;_scrollbar;_actionBar;_render(t){let n=this._models.getOriginalOptions(),i=this._models.getModifiedOptions(),r=document.createElement("div");r.className="diff-review-table",r.setAttribute("role","list"),r.setAttribute("aria-label",m("ariaLabel","Accessible Diff Viewer. Use arrow up and down to navigate.")),on(r,i.get(51)),Br(this._content,r);let s=this._models.getOriginalModel(),a=this._models.getModifiedModel();if(!s||!a)return;let l=s.getOptions(),d=a.getOptions(),c=i.get(68),u=this._model.currentGroup.get();for(let p of u?.lines||[]){if(!u)break;let h;if(p.type===0){let g=document.createElement("div");g.className="diff-review-row",g.setAttribute("role","listitem");let b=u.range,v=this._model.currentGroupIndex.get(),y=this._model.groups.get().length,S=_=>_===0?m("no_lines_changed","no lines changed"):_===1?m("one_line_changed","1 line changed"):m("more_lines_changed","{0} lines changed",_),E=S(b.original.length),C=S(b.modified.length);g.setAttribute("aria-label",m({key:"header",comment:["This is the ARIA label for a git diff header.","A git diff header looks like this: @@ -154,12 +159,39 @@.","That encodes that at original line 154 (which is now line 159), 12 lines were removed/changed with 39 lines.","Variables 0 and 1 refer to the diff index out of total number of diffs.","Variables 2 and 4 will be numbers (a line number).",'Variables 3 and 5 will be "no lines changed", "1 line changed" or "X lines changed", localized separately.']},"Difference {0} of {1}: original line {2}, {3}, modified line {4}, {5}",v+1,y,b.original.startLineNumber,E,b.modified.startLineNumber,C));let w=document.createElement("div");w.className="diff-review-cell diff-review-summary",w.appendChild(document.createTextNode(`${v+1}/${y}: @@ -${b.original.startLineNumber},${b.original.length} +${b.modified.startLineNumber},${b.modified.length} @@`)),g.appendChild(w),h=g}else h=this._createRow(p,c,this._width.get(),n,s,l,i,a,d);r.appendChild(h);let f=Pe(g=>this._model.currentElement.read(g)===p);t.add(rt(g=>{let b=f.read(g);h.tabIndex=b?0:-1,b&&h.focus()})),t.add(j(h,"focus",()=>{this._model.goToLine(p)}))}this._scrollbar.scanDomNode()}_createRow(t,n,i,r,s,a,l,d,c){let u=r.get(147),p=u.glyphMarginWidth+u.lineNumbersWidth,h=l.get(147),f=10+h.glyphMarginWidth+h.lineNumbersWidth,g="diff-review-row",b="",v="diff-review-spacer",y=null;switch(t.type){case 3:g="diff-review-row line-insert",b=" char-insert",y=_q;break;case 2:g="diff-review-row line-delete",b=" char-delete",y=Dq;break}let S=document.createElement("div");S.style.minWidth=i+"px",S.className=g,S.setAttribute("role","listitem"),S.ariaLevel="";let E=document.createElement("div");E.className="diff-review-cell",E.style.height=`${n}px`,S.appendChild(E);let C=document.createElement("span");C.style.width=p+"px",C.style.minWidth=p+"px",C.className="diff-review-line-number"+b,t.originalLineNumber!==void 0?C.appendChild(document.createTextNode(String(t.originalLineNumber))):C.innerText="\xA0",E.appendChild(C);let w=document.createElement("span");w.style.width=f+"px",w.style.minWidth=f+"px",w.style.paddingRight="10px",w.className="diff-review-line-number"+b,t.modifiedLineNumber!==void 0?w.appendChild(document.createTextNode(String(t.modifiedLineNumber))):w.innerText="\xA0",E.appendChild(w);let _=document.createElement("span");if(_.className=v,y){let W=document.createElement("span");W.className=we.asClassName(y),W.innerText="\xA0\xA0",_.appendChild(W)}else _.innerText="\xA0\xA0";E.appendChild(_);let L;if(t.modifiedLineNumber!==void 0){let W=this._getLineHtml(d,l,c.tabSize,t.modifiedLineNumber,this._languageService.languageIdCodec);tl._ttPolicy&&(W=tl._ttPolicy.createHTML(W)),E.insertAdjacentHTML("beforeend",W),L=d.getLineContent(t.modifiedLineNumber)}else{let W=this._getLineHtml(s,r,a.tabSize,t.originalLineNumber,this._languageService.languageIdCodec);tl._ttPolicy&&(W=tl._ttPolicy.createHTML(W)),E.insertAdjacentHTML("beforeend",W),L=s.getLineContent(t.originalLineNumber)}L.length===0&&(L=m("blankLine","blank"));let k="";switch(t.type){case 1:t.originalLineNumber===t.modifiedLineNumber?k=m({key:"unchangedLine",comment:["The placeholders are contents of the line and should not be translated."]},"{0} unchanged line {1}",L,t.originalLineNumber):k=m("equalLine","{0} original line {1} modified line {2}",L,t.originalLineNumber,t.modifiedLineNumber);break;case 3:k=m("insertLine","+ {0} modified line {1}",L,t.modifiedLineNumber);break;case 2:k=m("deleteLine","- {0} original line {1}",L,t.originalLineNumber);break}return S.setAttribute("aria-label",k),S}_getLineHtml(t,n,i,r,s){let a=t.getLineContent(r),l=n.get(51),d=Sn.createEmpty(a,s),c=Ma.isBasicASCII(a,t.mightContainNonBasicASCII()),u=Ma.containsRTL(a,c,t.mightContainRTL());return N4(new xc(l.isMonospace&&!n.get(33),l.canUseHalfwidthRightwardsArrow,a,!1,c,u,0,d,[],i,0,l.spaceWidth,l.middotWidth,l.wsmiddotWidth,n.get(119),n.get(101),n.get(96),n.get(52)!==_s.OFF,null)).html}};by=O([x(5,Di)],by);var j_=class{constructor(e){this.editors=e}getOriginalModel(){return this.editors.original.getModel()}getOriginalOptions(){return this.editors.original.getOptions()}originalReveal(e){this.editors.original.revealRange(e),this.editors.original.setSelection(e),this.editors.original.focus()}getModifiedModel(){return this.editors.modified.getModel()}getModifiedOptions(){return this.editors.modified.getOptions()}modifiedReveal(e){e&&(this.editors.modified.revealRange(e),this.editors.modified.setSelection(e)),this.editors.modified.focus()}modifiedSetSelection(e){this.editors.modified.setSelection(e)}modifiedFocus(){this.editors.modified.focus()}getModifiedPosition(){return this.editors.modified.getPosition()??void 0}};var Rc=class o extends F{constructor(t,n,i,r,s){super();this._rootElement=t;this._diffModel=n;this._originalEditorLayoutInfo=i;this._modifiedEditorLayoutInfo=r;this._editors=s;this._element=document.createElementNS("http://www.w3.org/2000/svg","svg"),this._element.setAttribute("class","moved-blocks-lines"),this._rootElement.appendChild(this._element),this._register(le(()=>this._element.remove())),this._register(rt(u=>{let p=this._originalEditorLayoutInfo.read(u),h=this._modifiedEditorLayoutInfo.read(u);!p||!h||(this._element.style.left=`${p.width-p.verticalScrollbarWidth}px`,this._element.style.height=`${p.height}px`,this._element.style.width=`${p.verticalScrollbarWidth+p.contentLeft-o.movedCodeBlockPadding+this.width.read(u)}px`)})),this._register(Wp(this._state));let a=Pe(u=>{let h=this._diffModel.read(u)?.diff.read(u);return h?h.movedTexts.map(f=>({move:f,original:new Xa(ud(f.lineRangeMapping.original.startLineNumber-1),18),modified:new Xa(ud(f.lineRangeMapping.modified.startLineNumber-1),18)})):[]});this._register(yg(this._editors.original,a.map(u=>u.map(p=>p.original)))),this._register(yg(this._editors.modified,a.map(u=>u.map(p=>p.modified)))),this._register(Ei((u,p)=>{let h=a.read(u);for(let f of h)p.add(new q_(this._editors.original,f.original,f.move,"original",this._diffModel.get())),p.add(new q_(this._editors.modified,f.modified,f.move,"modified",this._diffModel.get()))}));let l=Ti("original.onDidFocusEditorWidget",u=>this._editors.original.onDidFocusEditorWidget(()=>setTimeout(()=>u(void 0),0))),d=Ti("modified.onDidFocusEditorWidget",u=>this._editors.modified.onDidFocusEditorWidget(()=>setTimeout(()=>u(void 0),0))),c="modified";this._register(cd({createEmptyChangeSummary:()=>{},handleChange:(u,p)=>(u.didChange(l)&&(c="original"),u.didChange(d)&&(c="modified"),!0)},u=>{l.read(u),d.read(u);let p=this._diffModel.read(u);if(!p)return;let h=p.diff.read(u),f;if(h&&c==="original"){let g=this._editors.originalCursor.read(u);g&&(f=h.movedTexts.find(b=>b.lineRangeMapping.original.contains(g.lineNumber)))}if(h&&c==="modified"){let g=this._editors.modifiedCursor.read(u);g&&(f=h.movedTexts.find(b=>b.lineRangeMapping.modified.contains(g.lineNumber)))}f!==p.movedTextToCompare.get()&&p.movedTextToCompare.set(void 0,void 0),p.setActiveMovedText(f)}))}static movedCodeBlockPadding=4;_element;_originalScrollTop=Lt(this,this._editors.original.onDidScrollChange,()=>this._editors.original.getScrollTop());_modifiedScrollTop=Lt(this,this._editors.modified.onDidScrollChange,()=>this._editors.modified.getScrollTop());_viewZonesChanged=Ti("onDidChangeViewZones",this._editors.modified.onDidChangeViewZones);width=at(this,0);_modifiedViewZonesChangedSignal=Ti("modified.onDidChangeViewZones",this._editors.modified.onDidChangeViewZones);_originalViewZonesChangedSignal=Ti("original.onDidChangeViewZones",this._editors.original.onDidChangeViewZones);_state=gl(this,(t,n)=>{this._element.replaceChildren();let i=this._diffModel.read(t),r=i?.diff.read(t)?.movedTexts;if(!r||r.length===0){this.width.set(0,void 0);return}this._viewZonesChanged.read(t);let s=this._originalEditorLayoutInfo.read(t),a=this._modifiedEditorLayoutInfo.read(t);if(!s||!a){this.width.set(0,void 0);return}this._modifiedViewZonesChangedSignal.read(t),this._originalViewZonesChangedSignal.read(t);let l=r.map(g=>{function b(k,W){let K=W.getTopForLineNumber(k.startLineNumber,!0),U=W.getTopForLineNumber(k.endLineNumberExclusive,!0);return(K+U)/2}let v=b(g.lineRangeMapping.original,this._editors.original),y=this._originalScrollTop.read(t),S=b(g.lineRangeMapping.modified,this._editors.modified),E=this._modifiedScrollTop.read(t),C=v-y,w=S-E,_=Math.min(v,S),L=Math.max(v,S);return{range:new ke(_,L),from:C,to:w,fromWithoutScroll:v,toWithoutScroll:S,move:g}});l.sort(KN(mo(g=>g.fromWithoutScroll>g.toWithoutScroll,GN),mo(g=>g.fromWithoutScroll>g.toWithoutScroll?g.fromWithoutScroll:-g.toWithoutScroll,aa)));let d=wN.compute(l.map(g=>g.range)),c=10,u=s.verticalScrollbarWidth,p=(d.getTrackCount()-1)*10+c*2,h=u+p+(a.contentLeft-o.movedCodeBlockPadding),f=0;for(let g of l){let b=d.getTrack(f),v=u+c+b*10,y=15,S=15,E=h,C=a.glyphMarginWidth+a.lineNumbersWidth,w=18,_=document.createElementNS("http://www.w3.org/2000/svg","rect");_.classList.add("arrow-rectangle"),_.setAttribute("x",`${E-C}`),_.setAttribute("y",`${g.to-w/2}`),_.setAttribute("width",`${C}`),_.setAttribute("height",`${w}`),this._element.appendChild(_);let L=document.createElementNS("http://www.w3.org/2000/svg","g"),k=document.createElementNS("http://www.w3.org/2000/svg","path");k.setAttribute("d",`M 0 ${g.from} L ${v} ${g.from} L ${v} ${g.to} L ${E-S} ${g.to}`),k.setAttribute("fill","none"),L.appendChild(k);let W=document.createElementNS("http://www.w3.org/2000/svg","polygon");W.classList.add("arrow"),n.add(rt(K=>{k.classList.toggle("currentMove",g.move===i.activeMovedText.read(K)),W.classList.toggle("currentMove",g.move===i.activeMovedText.read(K))})),W.setAttribute("points",`${E-S},${g.to-y/2} ${E},${g.to} ${E-S},${g.to+y/2}`),L.appendChild(W),this._element.appendChild(L),f++}this.width.set(p,void 0)})},wN=class o{constructor(e,t){this._trackCount=e;this.trackPerLineIdx=t}static compute(e){let t=[],n=[];for(let i of e){let r=t.findIndex(s=>!s.intersectsStrict(i));r===-1&&(t.length>=6?r=FN(t,mo(a=>a.intersectWithRangeLength(i),aa)):(r=t.length,t.push(new YI))),t[r].addRange(i),n.push(r)}return new o(t.length,n)}getTrack(e){return this.trackPerLineIdx[e]}getTrackCount(){return this._trackCount}},q_=class extends Cp{constructor(t,n,i,r,s){let a=yt("div.diff-hidden-lines-widget");super(t,n,a.root);this._editor=t;this._move=i;this._kind=r;this._diffModel=s;a.root.appendChild(this._nodes.root);let l=Lt(this._editor.onDidLayoutChange,()=>this._editor.getLayoutInfo());this._register(Kr(this._nodes.root,{paddingRight:l.map(h=>h.verticalScrollbarWidth)}));let d;i.changes.length>0?d=this._kind==="original"?m("codeMovedToWithChanges","Code moved with changes to line {0}-{1}",this._move.lineRangeMapping.modified.startLineNumber,this._move.lineRangeMapping.modified.endLineNumberExclusive-1):m("codeMovedFromWithChanges","Code moved with changes from line {0}-{1}",this._move.lineRangeMapping.original.startLineNumber,this._move.lineRangeMapping.original.endLineNumberExclusive-1):d=this._kind==="original"?m("codeMovedTo","Code moved to line {0}-{1}",this._move.lineRangeMapping.modified.startLineNumber,this._move.lineRangeMapping.modified.endLineNumberExclusive-1):m("codeMovedFrom","Code moved from line {0}-{1}",this._move.lineRangeMapping.original.startLineNumber,this._move.lineRangeMapping.original.endLineNumberExclusive-1);let c=this._register(new fr(this._nodes.actionBar,{highlightToggledItems:!0})),u=new Ht("",d,"",!1);c.push(u,{icon:!1,label:!0});let p=new Ht("","Compare",we.asClassName(te.compareChanges),!0,()=>{this._editor.focus(),this._diffModel.movedTextToCompare.set(this._diffModel.movedTextToCompare.get()===i?void 0:this._move,void 0)});this._register(rt(h=>{let f=this._diffModel.movedTextToCompare.read(h)===i;p.checked=f})),c.push(p,{icon:!1,label:!0})}_nodes=yt("div.diff-moved-code-block",{style:{marginRight:"4px"}},[yt("div.text-content@textContent"),yt("div.action-bar@actionBar")])};var $_=class extends F{constructor(t,n,i,r){super();this._editors=t;this._diffModel=n;this._options=i;this._register(vg(this._editors.original,this._decorations.map(s=>s?.originalDecorations||[]))),this._register(vg(this._editors.modified,this._decorations.map(s=>s?.modifiedDecorations||[])))}_decorations=Pe(this,t=>{let n=this._diffModel.read(t),i=n?.diff.read(t);if(!i)return null;let r=this._diffModel.read(t).movedTextToCompare.read(t),s=this._options.renderIndicators.read(t),a=this._options.showEmptyDecorations.read(t),l=[],d=[];if(!r)for(let u of i.mappings)if(u.lineRangeMapping.original.isEmpty||l.push({range:u.lineRangeMapping.original.toInclusiveRange(),options:s?bN:yN}),u.lineRangeMapping.modified.isEmpty||d.push({range:u.lineRangeMapping.modified.toInclusiveRange(),options:s?fN:vN}),u.lineRangeMapping.modified.isEmpty||u.lineRangeMapping.original.isEmpty)u.lineRangeMapping.original.isEmpty||l.push({range:u.lineRangeMapping.original.toInclusiveRange(),options:_5}),u.lineRangeMapping.modified.isEmpty||d.push({range:u.lineRangeMapping.modified.toInclusiveRange(),options:x5});else{let p=this._options.useTrueInlineDiffRendering.read(t)&&py(u.lineRangeMapping);for(let h of u.lineRangeMapping.innerChanges||[])if(u.lineRangeMapping.original.contains(h.originalRange.startLineNumber)&&l.push({range:h.originalRange,options:h.originalRange.isEmpty()&&a?D5:uy}),u.lineRangeMapping.modified.contains(h.modifiedRange.startLineNumber)&&d.push({range:h.modifiedRange,options:h.modifiedRange.isEmpty()&&a&&!p?w5:IN}),p){let f=n.model.original.getValueInRange(h.originalRange);d.push({range:h.modifiedRange,options:{description:"deleted-text",before:{content:f,inlineClassName:"inline-deleted-text"},zIndex:1e5,showIfCollapsed:!0}})}}if(r)for(let u of r.changes){let p=u.original.toInclusiveRange();p&&l.push({range:p,options:s?bN:yN});let h=u.modified.toInclusiveRange();h&&d.push({range:h,options:s?fN:vN});for(let f of u.innerChanges||[])l.push({range:f.originalRange,options:uy}),d.push({range:f.modifiedRange,options:IN})}let c=this._diffModel.read(t).activeMovedText.read(t);for(let u of i.movedTexts)l.push({range:u.lineRangeMapping.original.toInclusiveRange(),options:{description:"moved",blockClassName:"movedOriginal"+(u===c?" currentMove":""),blockPadding:[Rc.movedCodeBlockPadding,0,Rc.movedCodeBlockPadding,Rc.movedCodeBlockPadding]}}),d.push({range:u.lineRangeMapping.modified.toInclusiveRange(),options:{description:"moved",blockClassName:"movedModified"+(u===c?" currentMove":""),blockPadding:[4,0,4,4]}});return{originalDecorations:l,modifiedDecorations:d}})};var Y_=class{constructor(e,t){this._options=e;this.dimensions=t}sashLeft=Vp(this,e=>{let t=this._sashRatio.read(e)??this._options.splitViewDefaultRatio.read(e);return this._computeSashLeft(t,e)},(e,t)=>{let n=this.dimensions.width.get();this._sashRatio.set(e/n,t)});_sashRatio=at(this,void 0);resetSash(){this._sashRatio.set(void 0,void 0)}_computeSashLeft(e,t){let n=this.dimensions.width.read(t),i=Math.floor(this._options.splitViewDefaultRatio.read(t)*n),r=this._options.enableSplitViewResizing.read(t)?Math.floor(e*n):i,s=100;return n<=s*2?i:r<s?s:r>n-s?n-s:r}},_g=class extends F{constructor(t,n,i,r,s,a){super();this._domNode=t;this._dimensions=n;this._enabled=i;this._boundarySashes=r;this.sashLeft=s;this._resetSash=a;this._register(this._sash.onDidStart(()=>{this._startSashPosition=this.sashLeft.get()})),this._register(this._sash.onDidChange(l=>{this.sashLeft.set(this._startSashPosition+(l.currentX-l.startX),void 0)})),this._register(this._sash.onDidEnd(()=>this._sash.layout())),this._register(this._sash.onDidReset(()=>this._resetSash())),this._register(rt(l=>{let d=this._boundarySashes.read(l);d&&(this._sash.orthogonalEndSash=d.bottom)})),this._register(rt(l=>{let d=this._enabled.read(l);this._sash.state=d?3:0,this.sashLeft.read(l),this._dimensions.height.read(l),this._sash.layout()}))}_sash=this._register(new Eu(this._domNode,{getVerticalSashTop:t=>0,getVerticalSashLeft:t=>this.sashLeft.get(),getVerticalSashHeight:t=>this._dimensions.height.get()},{orientation:0}));_startSashPosition=void 0};var Z_=class extends F{constructor(t,n,i){super();this._editor=t;this._domNode=n;this.itemProvider=i;this._domNode.className="gutter monaco-editor";let r=this._domNode.appendChild(yt("div.scroll-decoration",{role:"presentation",ariaHidden:"true",style:{width:"100%"}}).root),s=new ResizeObserver(()=>{Xt(a=>{this.domNodeSizeChanged.trigger(a)})});s.observe(this._domNode),this._register(le(()=>s.disconnect())),this._register(rt(a=>{r.className=this.isScrollTopZero.read(a)?"":"scroll-decoration"})),this._register(rt(a=>this.render(a)))}scrollTop=Lt(this,this._editor.onDidScrollChange,t=>this._editor.getScrollTop());isScrollTopZero=this.scrollTop.map(t=>t===0);modelAttached=Lt(this,this._editor.onDidChangeModel,t=>this._editor.hasModel());editorOnDidChangeViewZones=Ti("onDidChangeViewZones",this._editor.onDidChangeViewZones);editorOnDidContentSizeChange=Ti("onDidContentSizeChange",this._editor.onDidContentSizeChange);domNodeSizeChanged=Gc("domNodeSizeChanged");dispose(){super.dispose(),Br(this._domNode)}views=new Map;render(t){if(!this.modelAttached.read(t))return;this.domNodeSizeChanged.read(t),this.editorOnDidChangeViewZones.read(t),this.editorOnDidContentSizeChange.read(t);let n=this.scrollTop.read(t),i=this._editor.getVisibleRanges(),r=new Set(this.views.keys()),s=ke.ofStartAndLength(0,this._domNode.clientHeight);if(!s.isEmpty)for(let a of i){let l=new Re(a.startLineNumber,a.endLineNumber+1),d=this.itemProvider.getIntersectingGutterItems(l,t);Xt(c=>{for(let u of d){if(!u.range.intersect(l))continue;r.delete(u.id);let p=this.views.get(u.id);if(p)p.item.set(u,c);else{let b=document.createElement("div");this._domNode.appendChild(b);let v=at("item",u),y=this.itemProvider.createView(v,b);p=new _N(v,y,b),this.views.set(u.id,p)}let h=u.range.startLineNumber<=this._editor.getModel().getLineCount()?this._editor.getTopForLineNumber(u.range.startLineNumber,!0)-n:this._editor.getBottomForLineNumber(u.range.startLineNumber-1,!1)-n,g=(u.range.endLineNumberExclusive===1?Math.max(h,this._editor.getTopForLineNumber(u.range.startLineNumber,!1)-n):Math.max(h,this._editor.getBottomForLineNumber(u.range.endLineNumberExclusive-1,!0)-n))-h;p.domNode.style.top=`${h}px`,p.domNode.style.height=`${g}px`,p.gutterItemView.layout(ke.ofStartAndLength(h,g),s)}})}for(let a of r){let l=this.views.get(a);l.gutterItemView.dispose(),l.domNode.remove(),this.views.delete(a)}}},_N=class{constructor(e,t,n){this.item=e;this.gutterItemView=t;this.domNode=n}};var X_=class extends ko{constructor(t){super();this._getContext=t}runAction(t,n){let i=this._getContext();return super.runAction(t,i)}};var vy=class extends Lb{constructor(t){super();this._textModel=t}getValueOfRange(t){return this._textModel.getValueInRange(t)}get length(){let t=this._textModel.getLineCount(),n=this._textModel.getLineLength(t);return new Oo(t-1,n)}};var kc=class extends co{menuActionsOrProvider;dropdownMenu;contextMenuProvider;actionItem=null;_onDidChangeVisibility=this._register(new D);onDidChangeVisibility=this._onDidChangeVisibility.event;options;constructor(e,t,n,i=Object.create(null)){super(null,e,i),this.menuActionsOrProvider=t,this.contextMenuProvider=n,this.options=i,this.options.actionRunner&&(this.actionRunner=this.options.actionRunner)}render(e){this.actionItem=e;let t=r=>{this.element=dt(r,Ge("a.action-label"));let s=[];return typeof this.options.classNames=="string"?s=this.options.classNames.split(/\s+/g).filter(a=>!!a):this.options.classNames&&(s=this.options.classNames),s.find(a=>a==="icon")||s.push("codicon"),this.element.classList.add(...s),this.element.setAttribute("role","button"),this.element.setAttribute("aria-haspopup","true"),this.element.setAttribute("aria-expanded","false"),this._action.label&&this._register(xo().setupManagedHover(this.options.hoverDelegate??Fn("mouse"),this.element,this._action.label)),this.element.ariaLabel=this._action.label||"",null},n=Array.isArray(this.menuActionsOrProvider),i={contextMenuProvider:this.contextMenuProvider,labelRenderer:t,menuAsChild:this.options.menuAsChild,actions:n?this.menuActionsOrProvider:void 0,actionProvider:n?void 0:this.menuActionsOrProvider,skipTelemetry:this.options.skipTelemetry};if(this.dropdownMenu=this._register(new $E(e,i)),this._register(this.dropdownMenu.onDidChangeVisibility(r=>{this.element?.setAttribute("aria-expanded",`${r}`),this._onDidChangeVisibility.fire(r)})),this.dropdownMenu.menuOptions={actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,getKeyBinding:this.options.keybindingProvider,context:this._context},this.options.anchorAlignmentProvider){let r=this;this.dropdownMenu.menuOptions={...this.dropdownMenu.menuOptions,get anchorAlignment(){return r.options.anchorAlignmentProvider()}}}this.updateTooltip(),this.updateEnabled()}getTooltip(){let e=null;return this.action.tooltip?e=this.action.tooltip:this.action.label&&(e=this.action.label),e??void 0}setActionContext(e){super.setActionContext(e),this.dropdownMenu&&(this.dropdownMenu.menuOptions?this.dropdownMenu.menuOptions.context=e:this.dropdownMenu.menuOptions={context:e})}show(){this.dropdownMenu?.show()}updateEnabled(){let e=!this.action.enabled;this.actionItem?.classList.toggle("disabled",e),this.element?.classList.toggle("disabled",e)}};var Q_=class extends F{options;actionBar;toggleMenuAction;toggleMenuActionViewItem;submenuActionViewItems=[];hasSecondaryActions=!1;element;_onDidChangeDropdownVisibility=this._register(new cf);onDidChangeDropdownVisibility=this._onDidChangeDropdownVisibility.event;disposables=this._register(new ee);constructor(e,t,n={orientation:0}){super(),n.hoverDelegate=n.hoverDelegate??this._register(Ol()),this.options=n,this.toggleMenuAction=this._register(new Dg(()=>this.toggleMenuActionViewItem?.show(),n.toggleMenuTitle)),this.element=document.createElement("div"),this.element.className="monaco-toolbar",e.appendChild(this.element),this.actionBar=this._register(new fr(this.element,{orientation:n.orientation,ariaLabel:n.ariaLabel,actionRunner:n.actionRunner,allowContextMenu:n.allowContextMenu,highlightToggledItems:n.highlightToggledItems,hoverDelegate:n.hoverDelegate,actionViewItemProvider:(i,r)=>{if(i.id===Dg.ID)return this.toggleMenuActionViewItem=new kc(i,i.menuActions,t,{actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,keybindingProvider:this.options.getKeyBinding,classNames:we.asClassNameArray(n.moreIcon??te.toolBarMore),anchorAlignmentProvider:this.options.anchorAlignmentProvider,menuAsChild:!!this.options.renderDropdownAsChildElement,skipTelemetry:this.options.skipTelemetry,isMenu:!0,hoverDelegate:this.options.hoverDelegate}),this.toggleMenuActionViewItem.setActionContext(this.actionBar.context),this.disposables.add(this._onDidChangeDropdownVisibility.add(this.toggleMenuActionViewItem.onDidChangeVisibility)),this.toggleMenuActionViewItem;if(n.actionViewItemProvider){let s=n.actionViewItemProvider(i,r);if(s)return s}if(i instanceof fl){let s=new kc(i,i.actions,t,{actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,keybindingProvider:this.options.getKeyBinding,classNames:i.class,anchorAlignmentProvider:this.options.anchorAlignmentProvider,menuAsChild:!!this.options.renderDropdownAsChildElement,skipTelemetry:this.options.skipTelemetry,hoverDelegate:this.options.hoverDelegate});return s.setActionContext(this.actionBar.context),this.submenuActionViewItems.push(s),this.disposables.add(this._onDidChangeDropdownVisibility.add(s.onDidChangeVisibility)),s}}}))}set actionRunner(e){this.actionBar.actionRunner=e}get actionRunner(){return this.actionBar.actionRunner}set context(e){this.actionBar.context=e,this.toggleMenuActionViewItem?.setActionContext(e);for(let t of this.submenuActionViewItems)t.setActionContext(e)}getElement(){return this.element}focus(){this.actionBar.focus()}getItemsWidth(){let e=0;for(let t=0;t<this.actionBar.length();t++)e+=this.actionBar.getWidth(t);return e}getItemAction(e){return this.actionBar.getAction(e)}getItemWidth(e){return this.actionBar.getWidth(e)}getItemsLength(){return this.actionBar.length()}setAriaLabel(e){this.actionBar.setAriaLabel(e)}setActions(e,t){this.clear();let n=e?e.slice(0):[];this.hasSecondaryActions=!!(t&&t.length>0),this.hasSecondaryActions&&t&&(this.toggleMenuAction.menuActions=t.slice(0),n.push(this.toggleMenuAction)),n.forEach(i=>{this.actionBar.push(i,{icon:this.options.icon??!0,label:this.options.label??!1,keybinding:this.getKeybindingLabel(i)})})}isEmpty(){return this.actionBar.isEmpty()}getKeybindingLabel(e){return this.options.getKeyBinding?.(e)?.getLabel()??void 0}clear(){this.submenuActionViewItems=[],this.disposables.clear(),this.actionBar.clear()}dispose(){this.clear(),this.disposables.dispose(),super.dispose()}},Dg=class o extends Ht{static ID="toolbar.toggle.more";_menuActions;toggleDropdownMenu;constructor(e,t){t=t||m("moreActions","More Actions..."),super(o.ID,t,void 0,!0),this._menuActions=[],this.toggleDropdownMenu=e}async run(){this.toggleDropdownMenu()}get menuActions(){return this._menuActions}set menuActions(e){this._menuActions=e}};function F5(o,e,t,n,i,r){let s,a,l,d,c;if(Array.isArray(o))c=o,s=e,a=t,l=n,d=i;else{let p=e;c=o.getActions(p),s=t,a=n,l=i,d=r}kq(c,s,!1,typeof a=="string"?p=>p===a:a,l,d)}function kq(o,e,t,n=s=>s==="navigation",i=()=>!1,r=!1){let s,a;Array.isArray(e)?(s=e,a=e):(s=e.primary,a=e.secondary);let l=new Set;for(let[d,c]of o){let u;n(d)?(u=s,u.length>0&&r&&u.push(new Zn)):(u=a,u.length>0&&u.push(new Zn));for(let p of c){t&&(p=p instanceof Co&&p.alt?p.alt:p);let h=u.push(p);p instanceof fl&&l.add({group:d,action:p,index:h-1})}}for(let{group:d,action:c,index:u}of l){let p=n(d)?s:a,h=c.actions;i(c,d,p.length)&&p.splice(u,1,...h)}}var Lg=class extends dc{constructor(t,n,i,r,s,a,l,d){super(void 0,t,{icon:!!(t.class||t.item.icon),label:!t.class&&!t.item.icon,draggable:n?.draggable,keybinding:n?.keybinding,hoverDelegate:n?.hoverDelegate});this._options=n;this._keybindingService=i;this._notificationService=r;this._contextKeyService=s;this._themeService=a;this._contextMenuService=l;this._accessibilityService=d;this._altKey=Ph.getInstance()}_wantsAltCommand=!1;_itemClassDispose=this._register(new un);_altKey;get _menuItemAction(){return this._action}get _commandAction(){return this._wantsAltCommand&&this._menuItemAction.alt||this._menuItemAction}async onClick(t){t.preventDefault(),t.stopPropagation();try{await this.actionRunner.run(this._commandAction,this._context)}catch(n){this._notificationService.error(n)}}render(t){if(super.render(t),t.classList.add("menu-entry"),this.options.icon&&this._updateItemClass(this._menuItemAction.item),this._menuItemAction.alt){let n=!1,i=()=>{let r=!!this._menuItemAction.alt?.enabled&&(!this._accessibilityService.isMotionReduced()||n)&&(this._altKey.keyStatus.altKey||this._altKey.keyStatus.shiftKey&&n);r!==this._wantsAltCommand&&(this._wantsAltCommand=r,this.updateLabel(),this.updateTooltip(),this.updateClass())};this._register(this._altKey.event(i)),this._register(j(t,"mouseleave",r=>{n=!1,i()})),this._register(j(t,"mouseenter",r=>{n=!0,i()})),i()}}updateLabel(){this.options.label&&this.label&&(this.label.textContent=this._commandAction.label)}getTooltip(){let t=this._keybindingService.lookupKeybinding(this._commandAction.id,this._contextKeyService),n=t&&t.getLabel(),i=this._commandAction.tooltip||this._commandAction.label,r=n?m("titleAndKb","{0} ({1})",i,n):i;if(!this._wantsAltCommand&&this._menuItemAction.alt?.enabled){let s=this._menuItemAction.alt.tooltip||this._menuItemAction.alt.label,a=this._keybindingService.lookupKeybinding(this._menuItemAction.alt.id,this._contextKeyService),l=a&&a.getLabel(),d=l?m("titleAndKb","{0} ({1})",s,l):s;r=m("titleAndKbAndAlt",`{0}
[{1}] {2}`,r,nM.modifierLabels[qr].altKey,d)}return r}updateClass(){this.options.icon&&(this._commandAction!==this._menuItemAction?this._menuItemAction.alt&&this._updateItemClass(this._menuItemAction.alt.item):this._updateItemClass(this._menuItemAction.item))}_updateItemClass(t){this._itemClassDispose.value=void 0;let{element:n,label:i}=this;if(!n||!i)return;let r=this._commandAction.checked&&jF(t.toggled)&&t.toggled.icon?t.toggled.icon:t.icon;if(r)if(we.isThemeIcon(r)){let s=we.asClassNameArray(r);i.classList.add(...s),this._itemClassDispose.value=le(()=>{i.classList.remove(...s)})}else i.style.backgroundImage=Wk(this._themeService.getColorTheme().type)?Tb(r.dark):Tb(r.light),i.classList.add("icon"),this._itemClassDispose.value=Ro(le(()=>{i.style.backgroundImage="",i.classList.remove("icon")}),this._themeService.onDidColorThemeChange(()=>{this.updateClass()}))}};Lg=O([x(2,oi),x(3,fu),x(4,_t),x(5,Ko),x(6,Al),x(7,vo)],Lg);var J_=class extends kc{constructor(t,n,i,r,s){let a={...n,menuAsChild:n?.menuAsChild??!1,classNames:n?.classNames??(we.isThemeIcon(t.item.icon)?we.asClassName(t.item.icon):void 0),keybindingProvider:n?.keybindingProvider??(l=>i.lookupKeybinding(l.id))};super(t,{getActions:()=>t.actions},r,a);this._keybindingService=i;this._contextMenuService=r;this._themeService=s}render(t){super.render(t),Gp(this.element),t.classList.add("menu-entry");let n=this._action,{icon:i}=n.item;if(i&&!we.isThemeIcon(i)){this.element.classList.add("icon");let r=()=>{this.element&&(this.element.style.backgroundImage=Wk(this._themeService.getColorTheme().type)?Tb(i.dark):Tb(i.light))};r(),this._register(this._themeService.onDidColorThemeChange(()=>{r()}))}}};J_=O([x(2,oi),x(3,Al),x(4,Ko)],J_);var eD=class extends co{constructor(t,n,i,r,s,a,l,d){super(null,t);this._keybindingService=i;this._notificationService=r;this._contextMenuService=s;this._menuService=a;this._instaService=l;this._storageService=d;this._options=n,this._storageKey=`${t.item.submenu.id}_lastActionId`;let c,u=n?.persistLastActionId?d.get(this._storageKey,1):void 0;u&&(c=t.actions.find(h=>u===h.id)),c||(c=t.actions[0]),this._defaultAction=this._instaService.createInstance(Lg,c,{keybinding:this._getDefaultActionKeybindingLabel(c)});let p={keybindingProvider:h=>this._keybindingService.lookupKeybinding(h.id),...n,menuAsChild:n?.menuAsChild??!0,classNames:n?.classNames??["codicon","codicon-chevron-down"],actionRunner:n?.actionRunner??new ko};this._dropdown=new kc(t,t.actions,this._contextMenuService,p),this._register(this._dropdown.actionRunner.onDidRun(h=>{h.action instanceof Co&&this.update(h.action)}))}_options;_defaultAction;_dropdown;_container=null;_storageKey;get onDidChangeDropdownVisibility(){return this._dropdown.onDidChangeVisibility}update(t){this._options?.persistLastActionId&&this._storageService.store(this._storageKey,t.id,1,1),this._defaultAction.dispose(),this._defaultAction=this._instaService.createInstance(Lg,t,{keybinding:this._getDefaultActionKeybindingLabel(t)}),this._defaultAction.actionRunner=new class extends ko{async runAction(n,i){await n.run(void 0)}},this._container&&this._defaultAction.render(rk(this._container,Ge(".action-container")))}_getDefaultActionKeybindingLabel(t){let n;if(this._options?.renderKeybindingWithDefaultActionLabel){let i=this._keybindingService.lookupKeybinding(t.id);i&&(n=`(${i.getLabel()})`)}return n}setActionContext(t){super.setActionContext(t),this._defaultAction.setActionContext(t),this._dropdown.setActionContext(t)}render(t){this._container=t,super.render(this._container),this._container.classList.add("monaco-dropdown-with-default");let n=Ge(".action-container");this._defaultAction.render(dt(this._container,n)),this._register(j(n,me.KEY_DOWN,r=>{let s=new mt(r);s.equals(17)&&(this._defaultAction.element.tabIndex=-1,this._dropdown.focus(),s.stopPropagation())}));let i=Ge(".dropdown-action-container");this._dropdown.render(dt(this._container,i)),this._register(j(i,me.KEY_DOWN,r=>{let s=new mt(r);s.equals(15)&&(this._defaultAction.element.tabIndex=0,this._dropdown.setFocusable(!1),this._defaultAction.element?.focus(),s.stopPropagation())}))}focus(t){t?this._dropdown.focus():(this._defaultAction.element.tabIndex=0,this._defaultAction.element.focus())}blur(){this._defaultAction.element.tabIndex=-1,this._dropdown.blur(),this._container.blur()}setFocusable(t){t?this._defaultAction.element.tabIndex=0:(this._defaultAction.element.tabIndex=-1,this._dropdown.setFocusable(!1))}dispose(){this._defaultAction.dispose(),this._dropdown.dispose(),super.dispose()}};eD=O([x(2,oi),x(3,fu),x(4,Al),x(5,wu),x(6,Oe),x(7,Ln)],eD);var tD=class extends DE{constructor(e,t){super(null,e,e.actions.map(n=>({text:n.id===Zn.ID?"\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500":n.label,isDisabled:!n.enabled})),0,t,cH,{ariaLabel:e.tooltip,optionsAsChildren:!0}),this.select(Math.max(0,e.actions.findIndex(n=>n.checked)))}render(e){super.render(e),e.style.borderColor=ce(Nb)}runAction(e,t){let n=this.action.actions[t];n&&this.actionRunner.run(n)}};tD=O([x(1,qE)],tD);var nD=class{constructor(e,t,n){this._commandService=e;this._keybindingService=t;this._hiddenStates=new nl(n)}_hiddenStates;createMenu(e,t,n){return new Rg(e,this._hiddenStates,{emitEventsForSubmenuChanges:!1,eventDebounceDelay:50,...n},this._commandService,this._keybindingService,t)}getMenuActions(e,t,n){let i=new Rg(e,this._hiddenStates,{emitEventsForSubmenuChanges:!1,eventDebounceDelay:50,...n},this._commandService,this._keybindingService,t),r=i.getActions(n);return i.dispose(),r}getMenuContexts(e){let t=new iD(e,!1);return new Set([...t.structureContextKeys,...t.preconditionContextKeys,...t.toggledContextKeys])}resetHiddenStates(e){this._hiddenStates.reset(e)}};nD=O([x(0,Ji),x(1,oi),x(2,Ln)],nD);var nl=class{constructor(e){this._storageService=e;try{let t=e.get(nl._key,0,"{}");this._data=JSON.parse(t)}catch{this._data=Object.create(null)}this._disposables.add(e.onDidChangeValue(0,nl._key,this._disposables)(()=>{if(!this._ignoreChangeEvent)try{let t=e.get(nl._key,0,"{}");this._data=JSON.parse(t)}catch(t){console.log("FAILED to read storage after UPDATE",t)}this._onDidChange.fire()}))}static _key="menu.hiddenCommands";_disposables=new ee;_onDidChange=new D;onDidChange=this._onDidChange.event;_ignoreChangeEvent=!1;_data;_hiddenByDefaultCache=new Map;dispose(){this._onDidChange.dispose(),this._disposables.dispose()}_isHiddenByDefault(e,t){return this._hiddenByDefaultCache.get(`${e.id}/${t}`)??!1}setDefaultState(e,t,n){this._hiddenByDefaultCache.set(`${e.id}/${t}`,n)}isHidden(e,t){let n=this._isHiddenByDefault(e,t),i=this._data[e.id]?.includes(t)??!1;return n?!i:i}updateHidden(e,t,n){this._isHiddenByDefault(e,t)&&(n=!n);let r=this._data[e.id];if(n)r?r.indexOf(t)<0&&r.push(t):this._data[e.id]=[t];else if(r){let s=r.indexOf(t);s>=0&&WN(r,s),r.length===0&&delete this._data[e.id]}this._persist()}reset(e){if(e===void 0)this._data=Object.create(null),this._persist();else{for(let{id:t}of e)this._data[t]&&delete this._data[t];this._persist()}}_persist(){try{this._ignoreChangeEvent=!0;let e=JSON.stringify(this._data);this._storageService.store(nl._key,e,0,0)}finally{this._ignoreChangeEvent=!1}}};nl=O([x(0,Ln)],nl);var iD=class o{constructor(e,t){this._id=e;this._collectContextKeysForSubmenus=t;this.refresh()}_menuGroups=[];_allMenuIds=new Set;_structureContextKeys=new Set;_preconditionContextKeys=new Set;_toggledContextKeys=new Set;get allMenuIds(){return this._allMenuIds}get structureContextKeys(){return this._structureContextKeys}get preconditionContextKeys(){return this._preconditionContextKeys}get toggledContextKeys(){return this._toggledContextKeys}refresh(){this._menuGroups.length=0,this._allMenuIds.clear(),this._structureContextKeys.clear(),this._preconditionContextKeys.clear(),this._toggledContextKeys.clear();let e=this._sort(_u.getMenuItems(this._id)),t;for(let n of e){let i=n.group||"";(!t||t[0]!==i)&&(t=[i,[]],this._menuGroups.push(t)),t[1].push(n),this._collectContextKeysAndSubmenuIds(n)}this._allMenuIds.add(this._id)}_sort(e){return e}_collectContextKeysAndSubmenuIds(e){if(o._fillInKbExprKeys(e.when,this._structureContextKeys),Hh(e)){if(e.command.precondition&&o._fillInKbExprKeys(e.command.precondition,this._preconditionContextKeys),e.command.toggled){let t=e.command.toggled.condition||e.command.toggled;o._fillInKbExprKeys(t,this._toggledContextKeys)}}else this._collectContextKeysForSubmenus&&(_u.getMenuItems(e.submenu).forEach(this._collectContextKeysAndSubmenuIds,this),this._allMenuIds.add(e.submenu))}static _fillInKbExprKeys(e,t){if(e)for(let n of e.keys())t.add(n)}},Yl=class extends iD{constructor(t,n,i,r,s,a){super(t,i);this._hiddenStates=n;this._commandService=r;this._keybindingService=s;this._contextKeyService=a;this.refresh()}createActionGroups(t){let n=[];for(let i of this._menuGroups){let[r,s]=i,a;for(let l of s)if(this._contextKeyService.contextMatchesRules(l.when)){let d=Hh(l);d&&this._hiddenStates.setDefaultState(this._id,l.command.id,!!l.isHiddenByDefault);let c=Mq(this._id,d?l.command:l,this._hiddenStates);if(d){let u=DN(this._commandService,this._keybindingService,l.command.id,l.when);(a??=[]).push(new Co(l.command,l.alt,t,c,u,this._contextKeyService,this._commandService))}else{let u=new Yl(l.submenu,this._hiddenStates,this._collectContextKeysForSubmenus,this._commandService,this._keybindingService,this._contextKeyService).createActionGroups(t),p=Zn.join(...u.map(h=>h[1]));p.length>0&&(a??=[]).push(new Dl(l,c,p))}}a&&a.length>0&&n.push([r,a])}return n}_sort(t){return t.sort(Yl._compareMenuItems)}static _compareMenuItems(t,n){let i=t.group,r=n.group;if(i!==r){if(i){if(!r)return-1}else return 1;if(i==="navigation")return-1;if(r==="navigation")return 1;let l=i.localeCompare(r);if(l!==0)return l}let s=t.order||0,a=n.order||0;return s<a?-1:s>a?1:Yl._compareTitles(Hh(t)?t.command.title:t.title,Hh(n)?n.command.title:n.title)}static _compareTitles(t,n){let i=typeof t=="string"?t:t.original,r=typeof n=="string"?n:n.original;return i.localeCompare(r)}};Yl=O([x(3,Ji),x(4,oi),x(5,_t)],Yl);var Rg=class{_menuInfo;_disposables=new ee;_onDidChange;onDidChange;constructor(e,t,n,i,r,s){this._menuInfo=new Yl(e,t,n.emitEventsForSubmenuChanges,i,r,s);let a=new nn(()=>{this._menuInfo.refresh(),this._onDidChange.fire({menu:this,isStructuralChange:!0,isEnablementChange:!0,isToggleChange:!0})},n.eventDebounceDelay);this._disposables.add(a),this._disposables.add(_u.onDidChangeMenu(u=>{for(let p of this._menuInfo.allMenuIds)if(u.has(p)){a.schedule();break}}));let l=this._disposables.add(new ee),d=u=>{let p=!1,h=!1,f=!1;for(let g of u)if(p=p||g.isStructuralChange,h=h||g.isEnablementChange,f=f||g.isToggleChange,p&&h&&f)break;return{menu:this,isStructuralChange:p,isEnablementChange:h,isToggleChange:f}},c=()=>{l.add(s.onDidChangeContext(u=>{let p=u.affectsSome(this._menuInfo.structureContextKeys),h=u.affectsSome(this._menuInfo.preconditionContextKeys),f=u.affectsSome(this._menuInfo.toggledContextKeys);(p||h||f)&&this._onDidChange.fire({menu:this,isStructuralChange:p,isEnablementChange:h,isToggleChange:f})})),l.add(t.onDidChange(u=>{this._onDidChange.fire({menu:this,isStructuralChange:!0,isEnablementChange:!1,isToggleChange:!1})}))};this._onDidChange=new eI({onWillAddFirstListener:c,onDidRemoveLastListener:l.clear.bind(l),delay:n.eventDebounceDelay,merge:d}),this.onDidChange=this._onDidChange.event}getActions(e){return this._menuInfo.createActionGroups(e)}dispose(){this._disposables.dispose(),this._onDidChange.dispose()}};Rg=O([x(3,Ji),x(4,oi),x(5,_t)],Rg);function Mq(o,e,t){let n=BV(e)?e.submenu.id:e.id,i=typeof e.title=="string"?e.title:e.title.value,r=xi({id:`hide/${o.id}/${n}`,label:m("hide.label","Hide '{0}'",i),run(){t.updateHidden(o,n,!0)}}),s=xi({id:`toggle/${o.id}/${n}`,label:i,get checked(){return!t.isHidden(o,n)},run(){t.updateHidden(o,n,!!this.checked)}});return{hide:r,toggle:s,get isHidden(){return!s.checked}}}function DN(o,e,t,n=void 0,i=!0){return xi({id:`configureKeybinding/${t}`,label:m("configure keybinding","Configure Keybinding"),enabled:i,run(){let s=!!!e.lookupKeybinding(t)&&n?n.serialize():void 0;o.executeCommand("workbench.action.openGlobalKeybindings",`@command:${t}`+(s?` +when:${s}`:""))}})}var yy=class extends Q_{constructor(t,n,i,r,s,a,l,d){super(t,s,{getKeyBinding:u=>a.lookupKeybinding(u.id)??void 0,...n,allowContextMenu:!0,skipTelemetry:typeof n?.telemetrySource=="string"});this._options=n;this._menuService=i;this._contextKeyService=r;this._contextMenuService=s;this._keybindingService=a;this._commandService=l;let c=n?.telemetrySource;c&&this._store.add(this.actionBar.onDidRun(u=>d.publicLog2("workbenchActionExecuted",{id:u.action.id,from:c})))}_sessionDisposables=this._store.add(new ee);setActions(t,n=[],i){this._sessionDisposables.clear();let r=t.slice(),s=n.slice(),a=[],l=0,d=[],c=!1;if(this._options?.hiddenItemStrategy!==-1)for(let u=0;u<r.length;u++){let p=r[u];!(p instanceof Co)&&!(p instanceof Dl)||p.hideActions&&(a.push(p.hideActions.toggle),p.hideActions.toggle.checked&&l++,p.hideActions.isHidden&&(c=!0,r[u]=void 0,this._options?.hiddenItemStrategy!==0&&(d[u]=p)))}if(this._options?.overflowBehavior!==void 0){let u=qN(new Set(this._options.overflowBehavior.exempted),Je.map(r,f=>f?.id)),p=this._options.overflowBehavior.maxItems-u.size,h=0;for(let f=0;f<r.length;f++){let g=r[f];g&&(h++,!u.has(g.id)&&h>=p&&(r[f]=void 0,d[f]=g))}}wD(r),wD(d),super.setActions(r,Zn.join(d,s)),(a.length>0||r.length>0)&&this._sessionDisposables.add(j(this.getElement(),"contextmenu",u=>{let p=new Yi(Ce(this.getElement()),u),h=this.getItemAction(p.target);if(!h)return;p.preventDefault(),p.stopPropagation();let f=[];if(h instanceof Co&&h.menuKeybinding)f.push(h.menuKeybinding);else if(!(h instanceof Dl||h instanceof Dg)){let b=!!this._keybindingService.lookupKeybinding(h.id);f.push(DN(this._commandService,this._keybindingService,h.id,void 0,b))}if(a.length>0){let b=!1;if(l===1&&this._options?.hiddenItemStrategy===0){b=!0;for(let v=0;v<a.length;v++)if(a[v].checked){a[v]=xi({id:h.id,label:h.label,checked:!0,enabled:!1,run(){}});break}}if(!b&&(h instanceof Co||h instanceof Dl)){if(!h.hideActions)return;f.push(h.hideActions.hide)}else f.push(xi({id:"label",label:m("hide","Hide"),enabled:!1,run(){}}))}let g=Zn.join(f,a);this._options?.resetMenu&&!i&&(i=[this._options.resetMenu]),c&&i&&(g.push(new Zn),g.push(xi({id:"resetThisMenu",label:m("resetThisMenu","Reset Menu"),run:()=>this._menuService.resetHiddenStates(i)}))),g.length!==0&&this._contextMenuService.showContextMenu({getAnchor:()=>p,getActions:()=>g,menuId:this._options?.contextMenu,menuActionOptions:{renderShortTitle:!0,...this._options?.menuOptions},skipTelemetry:typeof this._options?.telemetrySource=="string",contextKeyService:this._contextKeyService})}))}};yy=O([x(2,wu),x(3,_t),x(4,Al),x(5,oi),x(6,Ji),x(7,Xn)],yy);var kg=class extends yy{_onDidChangeMenuItems=this._store.add(new D);onDidChangeMenuItems=this._onDidChangeMenuItems.event;constructor(e,t,n,i,r,s,a,l,d){super(e,{resetMenu:t,...n},i,r,s,a,l,d);let c=this._store.add(i.createMenu(t,r,{emitEventsForSubmenuChanges:!0})),u=()=>{let p=[],h=[];F5(c,n?.menuOptions,{primary:p,secondary:h},n?.toolbarOptions?.primaryGroup,n?.toolbarOptions?.shouldInlineSubmenu,n?.toolbarOptions?.useSeparatorsInPrimaryActions),e.classList.toggle("has-no-actions",p.length===0&&h.length===0),super.setActions(p,h)};this._store.add(c.onDidChange(()=>{u(),this._onDidChangeMenuItems.fire(this)})),u()}setActions(){throw new Ye("This toolbar is populated from a menu.")}};kg=O([x(3,wu),x(4,_t),x(5,Al),x(6,oi),x(7,Ji),x(8,Xn)],kg);var Pq=Y("hoverService"),Mg=class extends F{constructor(t,n,i={},r,s){super();this.placement=t;this.instantHover=n;this.overrideOptions=i;this.configurationService=r;this.hoverService=s;this._delay=this.configurationService.getValue("workbench.hover.delay"),this._register(this.configurationService.onDidChangeConfiguration(a=>{a.affectsConfiguration("workbench.hover.delay")&&(this._delay=this.configurationService.getValue("workbench.hover.delay"))}))}lastHoverHideTime=0;timeLimit=200;_delay;get delay(){return this.isInstantlyHovering()?0:this._delay}hoverDisposables=this._register(new ee);showHover(t,n){let i=typeof this.overrideOptions=="function"?this.overrideOptions(t,n):this.overrideOptions;this.hoverDisposables.clear();let r=Nn(t.target)?[t.target]:t.target.targetElements;for(let a of r)this.hoverDisposables.add(bn(a,"keydown",l=>{l.equals(9)&&this.hoverService.hideHover()}));let s=Nn(t.content)?void 0:t.content.toString();return this.hoverService.showHover({...t,...i,persistence:{hideOnKeyDown:!0,...i.persistence},id:s,appearance:{...t.appearance,compact:!0,skipFadeInAnimation:this.isInstantlyHovering(),...i.appearance}},n)}isInstantlyHovering(){return this.instantHover&&Date.now()-this.lastHoverHideTime<this.timeLimit}setInstantHoverTimeLimit(t){if(!this.instantHover)throw new Error("Instant hover is not enabled");this.timeLimit=t}onDidHideHover(){this.hoverDisposables.clear(),this.instantHover&&(this.lastHoverHideTime=Date.now())}};Mg=O([x(3,ut),x(4,Pq)],Mg);var LN=[],oD=35,Pg=class extends F{constructor(t,n,i,r,s,a,l,d,c){super();this._diffModel=n;this._editors=i;this._options=r;this._sashLayout=s;this._boundarySashes=a;this._instantiationService=l;this._contextKeyService=d;this._menuService=c;this._register(l5(t,this.elements.root)),this._register(j(this.elements.root,"click",()=>{this._editors.modified.focus()})),this._register(Kr(this.elements.root,{display:this._hasActions.map(p=>p?"block":"none")})),Dr(this,p=>this._showSash.read(p)?new _g(t,this._sashLayout.dimensions,this._options.enableSplitViewResizing,this._boundarySashes,Vp(this,f=>this._sashLayout.sashLeft.read(f)-oD,(f,g)=>this._sashLayout.sashLeft.set(f+oD,g)),()=>this._sashLayout.resetSash()):void 0).recomputeInitiallyAndOnChange(this._store);let u=Pe(this,p=>{let h=this._diffModel.read(p);if(!h)return[];let f=h.diff.read(p);if(!f)return[];let g=this._selectedDiffs.read(p);if(g.length>0){let v=hr.fromRangeMappings(g.flatMap(y=>y.rangeMappings));return[new rD(v,!0,bi.DiffEditorSelectionToolbar,void 0,h.model.original.uri,h.model.modified.uri)]}let b=this._currentDiff.read(p);return f.mappings.map(v=>new rD(v.lineRangeMapping.withInnerChangesFromLineRanges(),v.lineRangeMapping===b?.lineRangeMapping,bi.DiffEditorHunkToolbar,void 0,h.model.original.uri,h.model.modified.uri))});this._register(new Z_(this._editors.modified,this.elements.root,{getIntersectingGutterItems:(p,h)=>u.read(h),createView:(p,h)=>this._instantiationService.createInstance(Iy,p,h,this)})),this._register(j(this.elements.gutter,me.MOUSE_WHEEL,p=>{this._editors.modified.getOption(105).handleMouseWheel&&this._editors.modified.delegateScrollFromMouseWheelEvent(p)},{passive:!1}))}_menu=this._register(this._menuService.createMenu(bi.DiffEditorHunkToolbar,this._contextKeyService));_actions=Lt(this,this._menu.onDidChange,()=>this._menu.getActions());_hasActions=this._actions.map(t=>t.length>0);_showSash=Pe(this,t=>this._options.renderSideBySide.read(t)&&this._hasActions.read(t));width=Pe(this,t=>this._hasActions.read(t)?oD:0);elements=yt("div.gutter@gutter",{style:{position:"absolute",height:"100%",width:oD+"px"}},[]);computeStagedValue(t){let n=t.innerChanges??[],i=new vy(this._editors.modifiedModel.get()),r=new vy(this._editors.original.getModel());return new DS(n.map(l=>l.toTextEdit(i))).apply(r)}_currentDiff=Pe(this,t=>{let n=this._diffModel.read(t);if(!n)return;let i=n.diff.read(t)?.mappings,r=this._editors.modifiedCursor.read(t);if(r)return i?.find(s=>s.lineRangeMapping.modified.contains(r.lineNumber))});_selectedDiffs=Pe(this,t=>{let i=this._diffModel.read(t)?.diff.read(t);if(!i)return LN;let r=this._editors.modifiedSelections.read(t);if(r.every(d=>d.isEmpty()))return LN;let s=new Pr(r.map(d=>Re.fromRangeInclusive(d))),l=i.mappings.filter(d=>d.lineRangeMapping.innerChanges&&s.intersects(d.lineRangeMapping.modified)).map(d=>({mapping:d,rangeMappings:d.lineRangeMapping.innerChanges.filter(c=>r.some(u=>P.areIntersecting(c.modifiedRange,u)))}));return l.length===0||l.every(d=>d.rangeMappings.length===0)?LN:l});layout(t){this.elements.gutter.style.left=t+"px"}};Pg=O([x(6,Oe),x(7,_t),x(8,wu)],Pg);var rD=class{constructor(e,t,n,i,r,s){this.mapping=e;this.showAlways=t;this.menuId=n;this.rangeOverride=i;this.originalUri=r;this.modifiedUri=s}get id(){return this.mapping.modified.toString()}get range(){return this.rangeOverride??this.mapping.modified}},Iy=class extends F{constructor(t,n,i,r){super();this._item=t;let s=this._register(r.createInstance(Mg,"element",!0,{position:{hoverPosition:1}}));this._register(Ep(n,this._elements.root)),this._register(rt(a=>{let l=this._showAlways.read(a);this._elements.root.classList.toggle("noTransition",!0),this._elements.root.classList.toggle("showAlways",l),setTimeout(()=>{this._elements.root.classList.toggle("noTransition",!1)},0)})),this._register(Ei((a,l)=>{this._elements.buttons.replaceChildren();let d=l.add(r.createInstance(kg,this._elements.buttons,this._menuId.read(a),{orientation:1,hoverDelegate:s,toolbarOptions:{primaryGroup:c=>c.startsWith("primary")},overflowBehavior:{maxItems:this._isSmall.read(a)?1:3},hiddenItemStrategy:0,actionRunner:new X_(()=>{let c=this._item.get(),u=c.mapping;return{mapping:u,originalWithModifiedChanges:i.computeStagedValue(u),originalUri:c.originalUri,modifiedUri:c.modifiedUri}}),menuOptions:{shouldForwardArgs:!0}}));l.add(d.onDidChangeMenuItems(()=>{this._lastItemRange&&this.layout(this._lastItemRange,this._lastViewRange)}))}))}_elements=yt("div.gutterItem",{style:{height:"20px",width:"34px"}},[yt("div.background@background",{},[]),yt("div.buttons@buttons",{},[])]);_showAlways=this._item.map(this,t=>t.showAlways);_menuId=this._item.map(this,t=>t.menuId);_isSmall=at(this,!1);_lastItemRange=void 0;_lastViewRange=void 0;layout(t,n){this._lastItemRange=t,this._lastViewRange=n;let i=this._elements.buttons.clientHeight;this._isSmall.set(this._item.get().mapping.original.startLineNumber===1&&t.length<30,void 0),i=this._elements.buttons.clientHeight;let r=t.length/2-i/2,s=i,a=t.start+r,l=ke.tryCreate(s,n.endExclusive-s-i),d=ke.tryCreate(t.start+s,t.endExclusive-i-s);d&&l&&d.start<d.endExclusive&&(a=l.clip(a),a=d.clip(a)),this._elements.buttons.style.top=`${a-t.start}px`}};Iy=O([x(3,Oe)],Iy);var Zl=class extends F{constructor(t,n,i,r){super();this._editors=t;this._diffModel=n;this._options=i;this._instantiationService=r;this._register(this._editors.original.onDidChangeCursorPosition(d=>{if(d.reason===1)return;let c=this._diffModel.get();Xt(u=>{for(let p of this._editors.original.getSelections()||[])c?.ensureOriginalLineIsVisible(p.getStartPosition().lineNumber,0,u),c?.ensureOriginalLineIsVisible(p.getEndPosition().lineNumber,0,u)})})),this._register(this._editors.modified.onDidChangeCursorPosition(d=>{if(d.reason===1)return;let c=this._diffModel.get();Xt(u=>{for(let p of this._editors.modified.getSelections()||[])c?.ensureModifiedLineIsVisible(p.getStartPosition().lineNumber,0,u),c?.ensureModifiedLineIsVisible(p.getEndPosition().lineNumber,0,u)})}));let s=this._diffModel.map((d,c)=>{let u=d?.unchangedRegions.read(c)??[];return u.length===1&&u[0].modifiedLineNumber===1&&u[0].lineCount===this._editors.modifiedModel.read(c)?.getLineCount()?[]:u});this.viewZones=gl(this,(d,c)=>{let u=this._modifiedOutlineSource.read(d);if(!u)return{origViewZones:[],modViewZones:[]};let p=[],h=[],f=this._options.renderSideBySide.read(d),g=this._options.compactMode.read(d),b=s.read(d);for(let v=0;v<b.length;v++){let y=b[v];if(!y.shouldHideControls(d)&&!(g&&(v===0||v===b.length-1)))if(g){{let S=Pe(this,C=>y.getHiddenOriginalRange(C).startLineNumber-1),E=new Xa(S,12);p.push(E),c.add(new sD(this._editors.original,E,y,!f))}{let S=Pe(this,C=>y.getHiddenModifiedRange(C).startLineNumber-1),E=new Xa(S,12);h.push(E),c.add(new sD(this._editors.modified,E,y))}}else{{let S=Pe(this,C=>y.getHiddenOriginalRange(C).startLineNumber-1),E=new Xa(S,24);p.push(E),c.add(new aD(this._editors.original,E,y,y.originalUnchangedRange,!f,u,C=>this._diffModel.get().ensureModifiedLineIsVisible(C,2,void 0),this._options))}{let S=Pe(this,C=>y.getHiddenModifiedRange(C).startLineNumber-1),E=new Xa(S,24);h.push(E),c.add(new aD(this._editors.modified,E,y,y.modifiedUnchangedRange,!1,u,C=>this._diffModel.get().ensureModifiedLineIsVisible(C,2,void 0),this._options))}}}return{origViewZones:p,modViewZones:h}});let a={description:"unchanged lines",className:"diff-unchanged-lines",isWholeLine:!0},l={description:"Fold Unchanged",glyphMarginHoverMessage:new kI(void 0,{isTrusted:!0,supportThemeIcons:!0}).appendMarkdown(m("foldUnchanged","Fold Unchanged Region")),glyphMarginClassName:"fold-unchanged "+we.asClassName(te.fold),zIndex:10001};this._register(vg(this._editors.original,Pe(this,d=>{let c=s.read(d),u=c.map(p=>({range:p.originalUnchangedRange.toInclusiveRange(),options:a}));for(let p of c)p.shouldHideControls(d)&&u.push({range:P.fromPositions(new A(p.originalLineNumber,1)),options:l});return u}))),this._register(vg(this._editors.modified,Pe(this,d=>{let c=s.read(d),u=c.map(p=>({range:p.modifiedUnchangedRange.toInclusiveRange(),options:a}));for(let p of c)p.shouldHideControls(d)&&u.push({range:Re.ofLength(p.modifiedLineNumber,1).toInclusiveRange(),options:l});return u}))),this._register(rt(d=>{let c=s.read(d);this._isUpdatingHiddenAreas=!0;try{this._editors.original.setHiddenAreas(c.map(u=>u.getHiddenOriginalRange(d).toInclusiveRange()).filter(bl)),this._editors.modified.setHiddenAreas(c.map(u=>u.getHiddenModifiedRange(d).toInclusiveRange()).filter(bl))}finally{this._isUpdatingHiddenAreas=!1}})),this._register(this._editors.modified.onMouseUp(d=>{if(!d.event.rightButton&&d.target.position&&d.target.element?.className.includes("fold-unchanged")){let c=d.target.position.lineNumber,u=this._diffModel.get();if(!u)return;let p=u.unchangedRegions.get().find(h=>h.modifiedUnchangedRange.includes(c));if(!p)return;p.collapseAll(void 0),d.event.stopPropagation(),d.event.preventDefault()}})),this._register(this._editors.original.onMouseUp(d=>{if(!d.event.rightButton&&d.target.position&&d.target.element?.className.includes("fold-unchanged")){let c=d.target.position.lineNumber,u=this._diffModel.get();if(!u)return;let p=u.unchangedRegions.get().find(h=>h.originalUnchangedRange.includes(c));if(!p)return;p.collapseAll(void 0),d.event.stopPropagation(),d.event.preventDefault()}}))}static _breadcrumbsSourceFactory=at(Zl,()=>({dispose(){},getBreadcrumbItems(t,n){return[]}}));static setBreadcrumbsSourceFactory(t){this._breadcrumbsSourceFactory.set(t,void 0)}_modifiedOutlineSource=Dr(this,t=>{let n=this._editors.modifiedModel.read(t),i=Zl._breadcrumbsSourceFactory.read(t);return!n||!i?void 0:i(n,this._instantiationService)});viewZones;_isUpdatingHiddenAreas=!1;get isUpdatingHiddenAreas(){return this._isUpdatingHiddenAreas}};Zl=O([x(3,Oe)],Zl);var sD=class extends Cp{constructor(t,n,i,r=!1){let s=yt("div.diff-hidden-lines-widget");super(t,n,s.root);this._unchangedRegion=i;this._hide=r;s.root.appendChild(this._nodes.root),this._hide&&this._nodes.root.replaceChildren(),this._register(rt(a=>{if(!this._hide){let l=this._unchangedRegion.getHiddenModifiedRange(a).length,d=m("hiddenLines","{0} hidden lines",l);this._nodes.text.innerText=d}}))}_nodes=yt("div.diff-hidden-lines-compact",[yt("div.line-left",[]),yt("div.text@text",[]),yt("div.line-right",[])])},aD=class extends Cp{constructor(t,n,i,r,s,a,l,d){let c=yt("div.diff-hidden-lines-widget");super(t,n,c.root);this._editor=t;this._unchangedRegion=i;this._unchangedRegionRange=r;this._hide=s;this._modifiedOutlineSource=a;this._revealModifiedHiddenLine=l;this._options=d;c.root.appendChild(this._nodes.root),this._hide?Br(this._nodes.first):this._register(Kr(this._nodes.first,{width:Tp(this._editor).layoutInfoContentLeft})),this._register(rt(p=>{let h=this._unchangedRegion.visibleLineCountTop.read(p)+this._unchangedRegion.visibleLineCountBottom.read(p)===this._unchangedRegion.lineCount;this._nodes.bottom.classList.toggle("canMoveTop",!h),this._nodes.bottom.classList.toggle("canMoveBottom",this._unchangedRegion.visibleLineCountBottom.read(p)>0),this._nodes.top.classList.toggle("canMoveTop",this._unchangedRegion.visibleLineCountTop.read(p)>0),this._nodes.top.classList.toggle("canMoveBottom",!h);let f=this._unchangedRegion.isDragged.read(p),g=this._editor.getDomNode();g&&(g.classList.toggle("draggingUnchangedRegion",!!f),f==="top"?(g.classList.toggle("canMoveTop",this._unchangedRegion.visibleLineCountTop.read(p)>0),g.classList.toggle("canMoveBottom",!h)):f==="bottom"?(g.classList.toggle("canMoveTop",!h),g.classList.toggle("canMoveBottom",this._unchangedRegion.visibleLineCountBottom.read(p)>0)):(g.classList.toggle("canMoveTop",!1),g.classList.toggle("canMoveBottom",!1)))}));let u=this._editor;this._register(j(this._nodes.top,"mousedown",p=>{if(p.button!==0)return;this._nodes.top.classList.toggle("dragging",!0),this._nodes.root.classList.toggle("dragging",!0),p.preventDefault();let h=p.clientY,f=!1,g=this._unchangedRegion.visibleLineCountTop.get();this._unchangedRegion.isDragged.set("top",void 0);let b=Ce(this._nodes.top),v=j(b,"mousemove",S=>{let C=S.clientY-h;f=f||Math.abs(C)>2;let w=Math.round(C/u.getOption(68)),_=Math.max(0,Math.min(g+w,this._unchangedRegion.getMaxVisibleLineCountTop()));this._unchangedRegion.visibleLineCountTop.set(_,void 0)}),y=j(b,"mouseup",S=>{f||this._unchangedRegion.showMoreAbove(this._options.hideUnchangedRegionsRevealLineCount.get(),void 0),this._nodes.top.classList.toggle("dragging",!1),this._nodes.root.classList.toggle("dragging",!1),this._unchangedRegion.isDragged.set(void 0,void 0),v.dispose(),y.dispose()})})),this._register(j(this._nodes.bottom,"mousedown",p=>{if(p.button!==0)return;this._nodes.bottom.classList.toggle("dragging",!0),this._nodes.root.classList.toggle("dragging",!0),p.preventDefault();let h=p.clientY,f=!1,g=this._unchangedRegion.visibleLineCountBottom.get();this._unchangedRegion.isDragged.set("bottom",void 0);let b=Ce(this._nodes.bottom),v=j(b,"mousemove",S=>{let C=S.clientY-h;f=f||Math.abs(C)>2;let w=Math.round(C/u.getOption(68)),_=Math.max(0,Math.min(g-w,this._unchangedRegion.getMaxVisibleLineCountBottom())),L=this._unchangedRegionRange.endLineNumberExclusive>u.getModel().getLineCount()?u.getContentHeight():u.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);this._unchangedRegion.visibleLineCountBottom.set(_,void 0);let k=this._unchangedRegionRange.endLineNumberExclusive>u.getModel().getLineCount()?u.getContentHeight():u.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);u.setScrollTop(u.getScrollTop()+(k-L))}),y=j(b,"mouseup",S=>{if(this._unchangedRegion.isDragged.set(void 0,void 0),!f){let E=u.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);this._unchangedRegion.showMoreBelow(this._options.hideUnchangedRegionsRevealLineCount.get(),void 0);let C=u.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);u.setScrollTop(u.getScrollTop()+(C-E))}this._nodes.bottom.classList.toggle("dragging",!1),this._nodes.root.classList.toggle("dragging",!1),v.dispose(),y.dispose()})})),this._register(rt(p=>{let h=[];if(!this._hide){let f=i.getHiddenModifiedRange(p).length,g=m("hiddenLines","{0} hidden lines",f),b=Ge("span",{title:m("diff.hiddenLines.expandAll","Double click to unfold")},g);b.addEventListener("dblclick",S=>{S.button===0&&(S.preventDefault(),this._unchangedRegion.showAll(void 0))}),h.push(b);let v=this._unchangedRegion.getHiddenModifiedRange(p),y=this._modifiedOutlineSource.getBreadcrumbItems(v,p);if(y.length>0){h.push(Ge("span",void 0,"\xA0\xA0|\xA0\xA0"));for(let S=0;S<y.length;S++){let E=y[S],C=c0.toIcon(E.kind),w=yt("div.breadcrumb-item",{style:{display:"flex",alignItems:"center"}},[pm(C),"\xA0",E.name,...S===y.length-1?[]:[pm(te.chevronRight)]]).root;h.push(w),w.onclick=()=>{this._revealModifiedHiddenLine(E.startLineNumber)}}}}Br(this._nodes.others,...h)}))}_nodes=yt("div.diff-hidden-lines",[yt("div.top@top",{title:m("diff.hiddenLines.top","Click or drag to show more above")}),yt("div.center@content",{style:{display:"flex"}},[yt("div@first",{style:{display:"flex",justifyContent:"center",alignItems:"center",flexShrink:"0"}},[Ge("a",{title:m("showUnchangedRegion","Show Unchanged Region"),role:"button",onclick:()=>{this._unchangedRegion.showAll(void 0)}},...jb("$(unfold)"))]),yt("div@others",{style:{display:"flex",justifyContent:"center",alignItems:"center"}})]),yt("div.bottom@bottom",{title:m("diff.bottom","Click or drag to show more below"),role:"button"})])};var RN=[],lD=class extends F{constructor(t,n,i,r){super();this._editors=t;this._diffModel=n;this._options=i;this._widget=r;this._register(Ei((s,a)=>{if(!this._options.shouldRenderOldRevertArrows.read(s))return;let l=this._diffModel.read(s),d=l?.diff.read(s);if(!l||!d||l.movedTextToCompare.read(s))return;let c=[],u=this._selectedDiffs.read(s),p=new Set(u.map(h=>h.mapping));if(u.length>0){let h=this._editors.modifiedSelections.read(s),f=a.add(new dD(h[h.length-1].positionLineNumber,this._widget,u.flatMap(g=>g.rangeMappings),!0));this._editors.modified.addGlyphMarginWidget(f),c.push(f)}for(let h of d.mappings)if(!p.has(h)&&!h.lineRangeMapping.modified.isEmpty&&h.lineRangeMapping.innerChanges){let f=a.add(new dD(h.lineRangeMapping.modified.startLineNumber,this._widget,h.lineRangeMapping,!1));this._editors.modified.addGlyphMarginWidget(f),c.push(f)}a.add(le(()=>{for(let h of c)this._editors.modified.removeGlyphMarginWidget(h)}))}))}_selectedDiffs=Pe(this,t=>{let i=this._diffModel.read(t)?.diff.read(t);if(!i)return RN;let r=this._editors.modifiedSelections.read(t);if(r.every(d=>d.isEmpty()))return RN;let s=new Pr(r.map(d=>Re.fromRangeInclusive(d))),l=i.mappings.filter(d=>d.lineRangeMapping.innerChanges&&s.intersects(d.lineRangeMapping.modified)).map(d=>({mapping:d,rangeMappings:d.lineRangeMapping.innerChanges.filter(c=>r.some(u=>P.areIntersecting(c.modifiedRange,u)))}));return l.length===0||l.every(d=>d.rangeMappings.length===0)?RN:l})},dD=class o extends F{constructor(t,n,i,r){super();this._lineNumber=t;this._widget=n;this._diffs=i;this._revertSelection=r;this._register(j(this._domNode,me.MOUSE_DOWN,s=>{s.button!==2&&(s.stopPropagation(),s.preventDefault())})),this._register(j(this._domNode,me.MOUSE_UP,s=>{s.stopPropagation(),s.preventDefault()})),this._register(j(this._domNode,me.CLICK,s=>{this._diffs instanceof Xi?this._widget.revert(this._diffs):this._widget.revertRangeMappings(this._diffs),s.stopPropagation(),s.preventDefault()}))}static counter=0;_id=`revertButton${o.counter++}`;getId(){return this._id}_domNode=yt("div.revertButton",{title:this._revertSelection?m("revertSelectedChanges","Revert Selected Changes"):m("revertChange","Revert Change")},[pm(te.arrowRight)]).root;getDomNode(){return this._domNode}getPosition(){return{lane:3,range:{startColumn:1,startLineNumber:this._lineNumber,endColumn:1,endLineNumber:this._lineNumber},zIndex:10001}}};var cD=class o extends F{static idCounter=0;_id=++o.idCounter;_onDidDispose=this._register(new D);onDidDispose=this._onDidDispose.event;getId(){return this.getEditorType()+":v2:"+this._id}getVisibleColumnFromPosition(e){return this._targetEditor.getVisibleColumnFromPosition(e)}getStatusbarColumn(e){return this._targetEditor.getStatusbarColumn(e)}getPosition(){return this._targetEditor.getPosition()}setPosition(e,t="api"){this._targetEditor.setPosition(e,t)}revealLine(e,t=0){this._targetEditor.revealLine(e,t)}revealLineInCenter(e,t=0){this._targetEditor.revealLineInCenter(e,t)}revealLineInCenterIfOutsideViewport(e,t=0){this._targetEditor.revealLineInCenterIfOutsideViewport(e,t)}revealLineNearTop(e,t=0){this._targetEditor.revealLineNearTop(e,t)}revealPosition(e,t=0){this._targetEditor.revealPosition(e,t)}revealPositionInCenter(e,t=0){this._targetEditor.revealPositionInCenter(e,t)}revealPositionInCenterIfOutsideViewport(e,t=0){this._targetEditor.revealPositionInCenterIfOutsideViewport(e,t)}revealPositionNearTop(e,t=0){this._targetEditor.revealPositionNearTop(e,t)}getSelection(){return this._targetEditor.getSelection()}getSelections(){return this._targetEditor.getSelections()}setSelection(e,t="api"){this._targetEditor.setSelection(e,t)}setSelections(e,t="api"){this._targetEditor.setSelections(e,t)}revealLines(e,t,n=0){this._targetEditor.revealLines(e,t,n)}revealLinesInCenter(e,t,n=0){this._targetEditor.revealLinesInCenter(e,t,n)}revealLinesInCenterIfOutsideViewport(e,t,n=0){this._targetEditor.revealLinesInCenterIfOutsideViewport(e,t,n)}revealLinesNearTop(e,t,n=0){this._targetEditor.revealLinesNearTop(e,t,n)}revealRange(e,t=0,n=!1,i=!0){this._targetEditor.revealRange(e,t,n,i)}revealRangeInCenter(e,t=0){this._targetEditor.revealRangeInCenter(e,t)}revealRangeInCenterIfOutsideViewport(e,t=0){this._targetEditor.revealRangeInCenterIfOutsideViewport(e,t)}revealRangeNearTop(e,t=0){this._targetEditor.revealRangeNearTop(e,t)}revealRangeNearTopIfOutsideViewport(e,t=0){this._targetEditor.revealRangeNearTopIfOutsideViewport(e,t)}revealRangeAtTop(e,t=0){this._targetEditor.revealRangeAtTop(e,t)}getSupportedActions(){return this._targetEditor.getSupportedActions()}focus(){this._targetEditor.focus()}trigger(e,t,n){this._targetEditor.trigger(e,t,n)}createDecorationsCollection(e){return this._targetEditor.createDecorationsCollection(e)}changeDecorations(e){return this._targetEditor.changeDecorations(e)}};var xp=class extends cD{constructor(t,n,i,r,s,a,l,d){super();this._domElement=t;this._parentContextKeyService=r;this._parentInstantiationService=s;this._accessibilitySignalService=l;this._editorProgressService=d;a.willCreateDiffEditor(),this._contextKeyService.createKey("isInDiffEditor",!0),this._domElement.appendChild(this.elements.root),this._register(le(()=>this.elements.root.remove())),this._rootSizeObserver=this._register(new O_(this.elements.root,n.dimension)),this._rootSizeObserver.setAutomaticLayout(n.automaticLayout??!1),this._options=this._instantiationService.createInstance(Eg,n),this._register(rt(C=>{this._options.setWidth(this._rootSizeObserver.width.read(C))})),this._contextKeyService.createKey(ge.isEmbeddedDiffEditor.key,!1),this._register(Qa(ge.isEmbeddedDiffEditor,this._contextKeyService,C=>this._options.isInEmbeddedEditor.read(C))),this._register(Qa(ge.comparingMovedCode,this._contextKeyService,C=>!!this._diffModel.read(C)?.movedTextToCompare.read(C))),this._register(Qa(ge.diffEditorRenderSideBySideInlineBreakpointReached,this._contextKeyService,C=>this._options.couldShowInlineViewBecauseOfSize.read(C))),this._register(Qa(ge.diffEditorInlineMode,this._contextKeyService,C=>!this._options.renderSideBySide.read(C))),this._register(Qa(ge.hasChanges,this._contextKeyService,C=>(this._diffModel.read(C)?.diff.read(C)?.mappings.length??0)>0)),this._editors=this._register(this._instantiationService.createInstance(wg,this.elements.original,this.elements.modified,this._options,i,(C,w,_,L)=>this._createInnerEditor(C,w,_,L))),this._register(Qa(ge.diffEditorOriginalWritable,this._contextKeyService,C=>this._options.originalEditable.read(C))),this._register(Qa(ge.diffEditorModifiedWritable,this._contextKeyService,C=>!this._options.readOnly.read(C))),this._register(Qa(ge.diffEditorOriginalUri,this._contextKeyService,C=>this._diffModel.read(C)?.model.original.uri.toString()??"")),this._register(Qa(ge.diffEditorModifiedUri,this._contextKeyService,C=>this._diffModel.read(C)?.model.modified.uri.toString()??"")),this._overviewRulerPart=Dr(this,C=>this._options.renderOverviewRuler.read(C)?this._instantiationService.createInstance(hs(Si,C),this._editors,this.elements.root,this._diffModel,this._rootSizeObserver.width,this._rootSizeObserver.height,this._layoutInfo.map(w=>w.modifiedEditor)):void 0).recomputeInitiallyAndOnChange(this._store);let c={height:this._rootSizeObserver.height,width:this._rootSizeObserver.width.map((C,w)=>C-(this._overviewRulerPart.read(w)?.width??0))};this._sashLayout=new Y_(this._options,c),this._sash=Dr(this,C=>{let w=this._options.renderSideBySide.read(C);return this.elements.root.classList.toggle("side-by-side",w),w?new _g(this.elements.root,c,this._options.enableSplitViewResizing,this._boundarySashes,this._sashLayout.sashLeft,()=>this._sashLayout.resetSash()):void 0}).recomputeInitiallyAndOnChange(this._store);let u=Dr(this,C=>this._instantiationService.createInstance(hs(Zl,C),this._editors,this._diffModel,this._options)).recomputeInitiallyAndOnChange(this._store);Dr(this,C=>this._instantiationService.createInstance(hs($_,C),this._editors,this._diffModel,this._options,this)).recomputeInitiallyAndOnChange(this._store);let p=new Set,h=new Set,f=!1,g=Dr(this,C=>this._instantiationService.createInstance(hs(Sg,C),Ce(this._domElement),this._editors,this._diffModel,this._options,this,()=>f||u.get().isUpdatingHiddenAreas,p,h)).recomputeInitiallyAndOnChange(this._store),b=Pe(this,C=>{let w=g.read(C).viewZones.read(C).orig,_=u.read(C).viewZones.read(C).origViewZones;return w.concat(_)}),v=Pe(this,C=>{let w=g.read(C).viewZones.read(C).mod,_=u.read(C).viewZones.read(C).modViewZones;return w.concat(_)});this._register(yg(this._editors.original,b,C=>{f=C},p));let y;this._register(yg(this._editors.modified,v,C=>{f=C,f?y=wx.capture(this._editors.modified):(y?.restore(this._editors.modified),y=void 0)},h)),this._accessibleDiffViewer=Dr(this,C=>this._instantiationService.createInstance(hs(tl,C),this.elements.accessibleDiffViewer,this._accessibleDiffViewerVisible,(w,_)=>this._accessibleDiffViewerShouldBeVisible.set(w,_),this._options.onlyShowAccessibleDiffViewer.map(w=>!w),this._rootSizeObserver.width,this._rootSizeObserver.height,this._diffModel.map((w,_)=>w?.diff.read(_)?.mappings.map(L=>L.lineRangeMapping)),new j_(this._editors))).recomputeInitiallyAndOnChange(this._store);let S=this._accessibleDiffViewerVisible.map(C=>C?"hidden":"visible");this._register(Kr(this.elements.modified,{visibility:S})),this._register(Kr(this.elements.original,{visibility:S})),this._createDiffEditorContributions(),a.addDiffEditor(this),this._gutter=Dr(this,C=>this._options.shouldRenderGutterMenu.read(C)?this._instantiationService.createInstance(hs(Pg,C),this.elements.root,this._diffModel,this._editors,this._options,this._sashLayout,this._boundarySashes):void 0),this._register(Wp(this._layoutInfo)),Dr(this,C=>new(hs(Rc,C))(this.elements.root,this._diffModel,this._layoutInfo.map(w=>w.originalEditor),this._layoutInfo.map(w=>w.modifiedEditor),this._editors)).recomputeInitiallyAndOnChange(this._store,C=>{this._movedBlocksLinesPart.set(C,void 0)}),this._register(q.runAndSubscribe(this._editors.modified.onDidChangeCursorPosition,C=>this._handleCursorPositionChange(C,!0))),this._register(q.runAndSubscribe(this._editors.original.onDidChangeCursorPosition,C=>this._handleCursorPositionChange(C,!1)));let E=this._diffModel.map(this,(C,w)=>{if(C)return C.diff.read(w)===void 0&&!C.isDiffUpToDate.read(w)});this._register(Ei((C,w)=>{if(E.read(C)===!0){let _=this._editorProgressService.show(!0,1e3);w.add(le(()=>_.done()))}})),this._register(Ei((C,w)=>{w.add(new(hs(lD,C))(this._editors,this._diffModel,this._options,this))})),this._register(Ei((C,w)=>{let _=this._diffModel.read(C);if(_)for(let L of[_.model.original,_.model.modified])w.add(L.onWillDispose(k=>{qe(new Ye("TextModel got disposed before DiffEditorWidget model got reset")),this.setModel(null)}))})),this._register(rt(C=>{this._options.setModel(this._diffModel.read(C))}))}static ENTIRE_DIFF_OVERVIEW_WIDTH=Si.ENTIRE_DIFF_OVERVIEW_WIDTH;elements=yt("div.monaco-diff-editor.side-by-side",{style:{position:"relative",height:"100%"}},[yt("div.editor.original@original",{style:{position:"absolute",height:"100%"}}),yt("div.editor.modified@modified",{style:{position:"absolute",height:"100%"}}),yt("div.accessibleDiffViewer@accessibleDiffViewer",{style:{position:"absolute",height:"100%"}})]);_diffModelSrc=this._register(XD(this,void 0));_diffModel=Pe(this,t=>this._diffModelSrc.read(t)?.object);onDidChangeModel=q.fromObservableLight(this._diffModel);get onDidContentSizeChange(){return this._editors.onDidContentSizeChange}_contextKeyService=this._register(this._parentContextKeyService.createScoped(this._domElement));_instantiationService=this._register(this._parentInstantiationService.createChild(new gd([_t,this._contextKeyService])));_rootSizeObserver;_sashLayout;_sash;_boundarySashes=at(this,void 0);_accessibleDiffViewerShouldBeVisible=at(this,!1);_accessibleDiffViewerVisible=Pe(this,t=>this._options.onlyShowAccessibleDiffViewer.read(t)?!0:this._accessibleDiffViewerShouldBeVisible.read(t));_accessibleDiffViewer;_options;_editors;_overviewRulerPart;_movedBlocksLinesPart=at(this,void 0);_gutter;get collapseUnchangedRegions(){return this._options.hideUnchangedRegions.get()}getViewWidth(){return this._rootSizeObserver.width.get()}getContentHeight(){return this._editors.modified.getContentHeight()}_createInnerEditor(t,n,i,r){return t.createInstance(ps,n,i,r)}_layoutInfo=Pe(this,t=>{let n=this._rootSizeObserver.width.read(t),i=this._rootSizeObserver.height.read(t);this._rootSizeObserver.automaticLayout?this.elements.root.style.height="100%":this.elements.root.style.height=i+"px";let r=this._sash.read(t),s=this._gutter.read(t),a=s?.width.read(t)??0,l=this._overviewRulerPart.read(t)?.width??0,d,c,u,p,h;if(!!r){let g=r.sashLeft.read(t),b=this._movedBlocksLinesPart.read(t)?.width.read(t)??0;d=0,c=g-a-b,h=g-a,u=g,p=n-u-l}else{h=0;let g=this._options.inlineViewHideOriginalLineNumbers.read(t);d=a,g?c=0:c=Math.max(5,this._editors.originalObs.layoutInfoDecorationsLeft.read(t)),u=a+c,p=n-u-l}return this.elements.original.style.left=d+"px",this.elements.original.style.width=c+"px",this._editors.original.layout({width:c,height:i},!0),s?.layout(h),this.elements.modified.style.left=u+"px",this.elements.modified.style.width=p+"px",this._editors.modified.layout({width:p,height:i},!0),{modifiedEditor:this._editors.modified.getLayoutInfo(),originalEditor:this._editors.original.getLayoutInfo()}});_createDiffEditorContributions(){let t=op.getDiffEditorContributions();for(let n of t)try{this._register(this._instantiationService.createInstance(n.ctor,this))}catch(i){qe(i)}}get _targetEditor(){return this._editors.modified}getEditorType(){return Rb.IDiffEditor}onVisible(){this._editors.original.onVisible(),this._editors.modified.onVisible()}onHide(){this._editors.original.onHide(),this._editors.modified.onHide()}layout(t){this._rootSizeObserver.observe(t)}hasTextFocus(){return this._editors.original.hasTextFocus()||this._editors.modified.hasTextFocus()}saveViewState(){let t=this._editors.original.saveViewState(),n=this._editors.modified.saveViewState();return{original:t,modified:n,modelState:this._diffModel.get()?.serializeState()}}restoreViewState(t){if(t&&t.original&&t.modified){let n=t;this._editors.original.restoreViewState(n.original),this._editors.modified.restoreViewState(n.modified),n.modelState&&this._diffModel.get()?.restoreSerializedState(n.modelState)}}handleInitialized(){this._editors.original.handleInitialized(),this._editors.modified.handleInitialized()}createViewModel(t){return this._instantiationService.createInstance(Tg,t,this._options)}getModel(){return this._diffModel.get()?.model??null}setModel(t){let n=t?"model"in t?Sp.create(t).createNewRef(this):Sp.create(this.createViewModel(t),this):null;this.setDiffModel(n)}setDiffModel(t,n){let i=this._diffModel.get();!t&&i&&this._accessibleDiffViewer.get().close(),this._diffModel.get()!==t?.object&&jc(n,r=>{let s=t?.object;Lt.batchEventsGlobally(r,()=>{this._editors.original.setModel(s?s.model.original:null),this._editors.modified.setModel(s?s.model.modified:null)});let a=this._diffModelSrc.get()?.createNewRef(this);this._diffModelSrc.set(t?.createNewRef(this),r),setTimeout(()=>{a?.dispose()},0)})}updateOptions(t){this._options.updateOptions(t)}getContainerDomNode(){return this._domElement}getOriginalEditor(){return this._editors.original}getModifiedEditor(){return this._editors.modified}setBoundarySashes(t){this._boundarySashes.set(t,void 0)}_diffValue=this._diffModel.map((t,n)=>t?.diff.read(n));onDidUpdateDiff=q.fromObservableLight(this._diffValue);get ignoreTrimWhitespace(){return this._options.ignoreTrimWhitespace.get()}get maxComputationTime(){return this._options.maxComputationTimeMs.get()}get renderSideBySide(){return this._options.renderSideBySide.get()}getLineChanges(){let t=this._diffModel.get()?.diff.get();return t?Oq(t):null}getDiffComputationResult(){let t=this._diffModel.get()?.diff.get();return t?{changes:this.getLineChanges(),changes2:t.mappings.map(n=>n.lineRangeMapping),identical:t.identical,quitEarly:t.quitEarly}:null}revert(t){let n=this._diffModel.get();!n||!n.isDiffUpToDate.get()||this._editors.modified.executeEdits("diffEditor",[{range:t.modified.toExclusiveRange(),text:n.model.original.getValueInRange(t.original.toExclusiveRange())}])}revertRangeMappings(t){let n=this._diffModel.get();if(!n||!n.isDiffUpToDate.get())return;let i=t.map(r=>({range:r.modifiedRange,text:n.model.original.getValueInRange(r.originalRange)}));this._editors.modified.executeEdits("diffEditor",i)}_goTo(t){this._editors.modified.setPosition(new A(t.lineRangeMapping.modified.startLineNumber,1)),this._editors.modified.revealRangeInCenter(t.lineRangeMapping.modified.toExclusiveRange())}goToDiff(t){let n=this._diffModel.get()?.diff.get()?.mappings;if(!n||n.length===0)return;let i=this._editors.modified.getPosition().lineNumber,r;t==="next"?r=n.find(s=>s.lineRangeMapping.modified.startLineNumber>i)??n[0]:r=Vc(n,s=>s.lineRangeMapping.modified.startLineNumber<i)??n[n.length-1],this._goTo(r),r.lineRangeMapping.modified.isEmpty?this._accessibilitySignalService.playSignal(yr.diffLineDeleted,{source:"diffEditor.goToDiff"}):r.lineRangeMapping.original.isEmpty?this._accessibilitySignalService.playSignal(yr.diffLineInserted,{source:"diffEditor.goToDiff"}):r&&this._accessibilitySignalService.playSignal(yr.diffLineModified,{source:"diffEditor.goToDiff"})}revealFirstDiff(){let t=this._diffModel.get();t&&this.waitForDiff().then(()=>{let n=t.diff.get()?.mappings;!n||n.length===0||this._goTo(n[0])})}accessibleDiffViewerNext(){this._accessibleDiffViewer.get().next()}accessibleDiffViewerPrev(){this._accessibleDiffViewer.get().prev()}async waitForDiff(){let t=this._diffModel.get();t&&await t.waitForDiff()}mapToOtherSide(){let t=this._editors.modified.hasWidgetFocus(),n=t?this._editors.modified:this._editors.original,i=t?this._editors.original:this._editors.modified,r,s=n.getSelection();if(s){let a=this._diffModel.get()?.diff.get()?.mappings.map(l=>t?l.lineRangeMapping.flip():l.lineRangeMapping);if(a){let l=aN(s.getStartPosition(),a),d=aN(s.getEndPosition(),a);r=P.plusRange(l,d)}}return{destination:i,destinationSelection:r}}switchSide(){let{destination:t,destinationSelection:n}=this.mapToOtherSide();t.focus(),n&&t.setSelection(n)}exitCompareMove(){let t=this._diffModel.get();t&&t.movedTextToCompare.set(void 0,void 0)}collapseAllUnchangedRegions(){let t=this._diffModel.get()?.unchangedRegions.get();t&&Xt(n=>{for(let i of t)i.collapseAll(n)})}showAllUnchangedRegions(){let t=this._diffModel.get()?.unchangedRegions.get();t&&Xt(n=>{for(let i of t)i.showAll(n)})}_handleCursorPositionChange(t,n){if(t?.reason===3){let i=this._diffModel.get()?.diff.get()?.mappings.find(r=>n?r.lineRangeMapping.modified.contains(t.position.lineNumber):r.lineRangeMapping.original.contains(t.position.lineNumber));i?.lineRangeMapping.modified.isEmpty?this._accessibilitySignalService.playSignal(yr.diffLineDeleted,{source:"diffEditor.cursorPositionChanged"}):i?.lineRangeMapping.original.isEmpty?this._accessibilitySignalService.playSignal(yr.diffLineInserted,{source:"diffEditor.cursorPositionChanged"}):i&&this._accessibilitySignalService.playSignal(yr.diffLineModified,{source:"diffEditor.cursorPositionChanged"})}}};xp=O([x(3,_t),x(4,Oe),x(5,$a),x(6,A_),x(7,kB)],xp);function Oq(o){return o.mappings.map(e=>{let t=e.lineRangeMapping,n,i,r,s,a=t.innerChanges;return t.original.isEmpty?(n=t.original.startLineNumber-1,i=0,a=void 0):(n=t.original.startLineNumber,i=t.original.endLineNumberExclusive-1),t.modified.isEmpty?(r=t.modified.startLineNumber-1,s=0,a=void 0):(r=t.modified.startLineNumber,s=t.modified.endLineNumberExclusive-1),{originalStartLineNumber:n,originalEndLineNumber:i,modifiedStartLineNumber:r,modifiedEndLineNumber:s,charChanges:a?.map(l=>({originalStartLineNumber:l.originalRange.startLineNumber,originalStartColumn:l.originalRange.startColumn,originalEndLineNumber:l.originalRange.endLineNumber,originalEndColumn:l.originalRange.endColumn,modifiedStartLineNumber:l.modifiedRange.startLineNumber,modifiedStartColumn:l.modifiedRange.startColumn,modifiedEndLineNumber:l.modifiedRange.endLineNumber,modifiedEndColumn:l.modifiedRange.endColumn}))}})}var Mc=class extends Sc{constructor(t,n,i,r,s,a,l,d,c,u){super(Mc.ID,t,n,i,r,s,l,a,d,c);this.preferencesService=u}static ID=hx;diffEditorControl=void 0;inputLifecycleStopWatch=void 0;get scopedContextKeyService(){if(!this.diffEditorControl)return;let t=this.diffEditorControl.getOriginalEditor(),n=this.diffEditorControl.getModifiedEditor();return(t.hasTextFocus()?t:n).invokeWithinContext(i=>i.get(_t))}getTitle(){return this.input?this.input.getName():m("textDiffEditor","Text Diff Editor")}createEditorControl(t,n){this.diffEditorControl=this._register(this.instantiationService.createInstance(xp,t,n,{}))}updateEditorControlOptions(t){this.diffEditorControl?.updateOptions(t)}getMainControl(){return this.diffEditorControl?.getModifiedEditor()}_previousViewModel=null;async setInput(t,n,i,r){this._previousViewModel&&(this._previousViewModel.dispose(),this._previousViewModel=null),this.inputLifecycleStopWatch=void 0,await super.setInput(t,n,i,r);try{let s=await t.resolve();if(r.isCancellationRequested)return;if(!(s instanceof Vm)){this.openAsBinary(t,n);return}let a=fn(this.diffEditorControl),l=s,d=l.textDiffEditorModel?a.createViewModel(l.textDiffEditorModel):null;this._previousViewModel=d,await d?.waitForDiff(),a.setModel(d);let c=!1;Ev(n?.viewState)||(c=this.restoreTextDiffEditorViewState(t,n,i,a));let u=!1;n&&(u=PP(n,a,1)),!u&&!c&&a.revealFirstDiff(),a.updateOptions({...this.getReadonlyConfiguration(l.modifiedModel?.isReadonly()),originalEditable:!l.originalModel?.isReadonly()}),a.handleInitialized(),this.inputLifecycleStopWatch=new Cs(!1)}catch(s){await this.handleSetInputError(s,t,n)}}async handleSetInputError(t,n,i){if(this.isFileBinaryError(t))return this.openAsBinary(n,i);if(t.fileOperationResult===7){let r;throw t instanceof OI?r=m("fileTooLargeForHeapErrorWithSize","At least one file is not displayed in the text compare editor because it is very large ({0}).",AI.formatSize(t.size)):r=m("fileTooLargeForHeapErrorWithoutSize","At least one file is not displayed in the text compare editor because it is very large."),qU(this.group,n,i,r,this.preferencesService)}throw t}restoreTextDiffEditorViewState(t,n,i,r){let s=this.loadEditorViewState(t,i);return s?(n?.selection&&s.modified&&(s.modified.cursorState=[]),r.restoreViewState(s),n?.revealIfVisible&&r.revealFirstDiff(),!0):!1}openAsBinary(t,n){let i=t.original,r=t.modified,s=this.instantiationService.createInstance($o,t.getName(),t.getDescription(),i,r,!0),a=et.as(js.EditorFactory).getFileEditorFactory();a.isFileEditor(i)&&i.setForceOpenAsBinary(),a.isFileEditor(r)&&r.setForceOpenAsBinary(),this.group.replaceEditors([{editor:t,replacement:s,options:{...n,activation:3,pinned:this.group.isPinned(t),sticky:this.group.isSticky(t)}}])}setOptions(t){super.setOptions(t),t&&PP(t,fn(this.diffEditorControl),0)}shouldHandleConfigurationChangeEvent(t,n){return super.shouldHandleConfigurationChangeEvent(t,n)?!0:t.affectsConfiguration(n,"diffEditor")||t.affectsConfiguration(n,"accessibility.verbosity.diffEditor")}computeConfiguration(t){let n=super.computeConfiguration(t);if(an(t.diffEditor)){let r=Md(t.diffEditor);r.diffCodeLens=r.codeLens,delete r.codeLens,r.diffWordWrap=r.wordWrap,delete r.wordWrap,Object.assign(n,r)}let i=t.accessibility?.verbosity?.diffEditor??!1;return n.accessibilityVerbose=i,n}getConfigurationOverrides(t){return{...super.getConfigurationOverrides(t),...this.getReadonlyConfiguration(this.input?.isReadonly()),originalEditable:this.input instanceof $o&&!this.input.original.isReadonly(),lineDecorationsWidth:"2ch"}}updateReadonly(t){t instanceof $o?this.diffEditorControl?.updateOptions({...this.getReadonlyConfiguration(t.isReadonly()),originalEditable:!t.original.isReadonly()}):super.updateReadonly(t)}isFileBinaryError(t){return Array.isArray(t)?t.some(i=>this.isFileBinaryError(i)):t.textFileOperationResult===0}clearInput(){this._previousViewModel&&(this._previousViewModel.dispose(),this._previousViewModel=null),super.clearInput();let t=this.inputLifecycleStopWatch?.elapsed();this.inputLifecycleStopWatch=void 0,typeof t=="number"&&this.logInputLifecycleTelemetry(t,this.getControl()?.getModel()?.modified?.getLanguageId()),this.diffEditorControl?.setModel(null)}logInputLifecycleTelemetry(t,n){let i=!1;this.diffEditorControl instanceof xp&&(i=this.diffEditorControl.collapseUnchangedRegions),this.telemetryService.publicLog2("diffEditor.editorVisibleTime",{editorVisibleTimeMs:t,languageId:n??"",collapseUnchangedRegions:i})}getControl(){return this.diffEditorControl}focus(){super.focus(),this.diffEditorControl?.focus()}hasFocus(){return this.diffEditorControl?.hasTextFocus()||super.hasFocus()}setEditorVisible(t){super.setEditorVisible(t),t?this.diffEditorControl?.onVisible():this.diffEditorControl?.onHide()}layout(t){this.diffEditorControl?.layout(t)}setBoundarySashes(t){this.diffEditorControl?.setBoundarySashes(t)}tracksEditorViewState(t){return t instanceof $o}computeEditorViewState(t){if(!this.diffEditorControl)return;let n=this.diffEditorControl.getModel();if(!n||!n.modified||!n.original)return;let i=this.toEditorViewStateResource(n);if(i&&nr(i,t))return this.diffEditorControl.saveViewState()??void 0}toEditorViewStateResource(t){let n,i;if(t instanceof $o?(n=t.original.resource,i=t.modified.resource):yi(t)||(n=t.original.uri,i=t.modified.uri),!(!n||!i))return J.from({scheme:"diff",path:`${Ah(n.toString())}${Ah(i.toString())}`})}};Mc=O([x(1,Xn),x(2,Oe),x(3,Ln),x(4,Hr),x(5,Tn),x(6,Ko),x(7,br),x(8,Bt),x(9,zU)],Mc);var Nq="diagnosticsService",ICn=Y(Nq);var Aq;(s=>{s.enableDiagnostics=!1,s.records=[];let t=new WeakMap,n=0;function i(a,l){if(!t.has(a)){let d=String(++n);t.set(a,d)}return t.get(a)}function r(a,l,d,c){}s.traceSocketEvent=r})(Aq||={});var BCn=Y("remoteAuthorityResolverService");var YCn=Y("remoteSocketFactoryService");var Fq="signService",QCn=Y(Fq);var LSn=30*1e3;var uD=Y("remoteAgentService"),YSn=new class{maxSampleCount=5;sampleDelay=2e3;initial=[];maxInitialCount=3;average=[];maxAverageCount=100;highLatencyMultiple=2;highLatencyMinThreshold=500;highLatencyMaxThreshold=1500;lastMeasurement=void 0;get latency(){return this.lastMeasurement}async measure(o){let e=1/0;for(let n=0;n<this.maxSampleCount;n++){let i=await o.getRoundTripTime();if(i===void 0)return;e=Math.min(e,i/2),await wi(this.sampleDelay)}this.average.push(e),this.average.length>this.maxAverageCount&&this.average.shift();let t;return this.initial.length<this.maxInitialCount?this.initial.push(e):t=this.initial.reduce((n,i)=>n+i,0)/this.initial.length,this.lastMeasurement={initial:t,current:e,average:this.average.reduce((n,i)=>n+i,0)/this.average.length,high:typeof t>"u"?!1:e>this.highLatencyMaxThreshold||e>this.highLatencyMinThreshold&&e>t*this.highLatencyMultiple},this.lastMeasurement}};var CEn=Object.freeze({id:"application",order:100,title:m("applicationConfigurationTitle","Application"),type:"object"}),B5=Object.freeze({id:"workbench",order:7,title:m("workbenchConfigurationTitle","Workbench"),type:"object"}),Bq=Object.freeze({id:"security",scope:1,title:m("securityConfigurationTitle","Security"),type:"object",order:7}),SEn=Object.freeze({id:"problems",title:m("problemsConfigurationTitle","Problems"),type:"object",order:101}),Vq=Object.freeze({id:"window",order:8,title:m("windowConfigurationTitle","Window"),type:"object"}),Wq={ConfigurationMigration:"base.contributions.configuration.migration"},kN=class{migrations=[];_onDidRegisterConfigurationMigrations=new D;onDidRegisterConfigurationMigration=this._onDidRegisterConfigurationMigrations.event;registerConfigurationMigrations(e){this.migrations.push(...e)}},gD=new kN;et.add(Wq.ConfigurationMigration,gD);var pD=class extends F{constructor(t,n){super();this.configurationService=t;this.workspaceService=n;this._register(this.workspaceService.onDidChangeWorkspaceFolders(async i=>{for(let r of i.added)await this.migrateConfigurationsForFolder(r,gD.migrations)})),this.migrateConfigurations(gD.migrations),this._register(gD.onDidRegisterConfigurationMigration(i=>this.migrateConfigurations(i)))}static ID="workbench.contrib.configurationMigration";async migrateConfigurations(t){await this.migrateConfigurationsForFolder(void 0,t);for(let n of this.workspaceService.getWorkspace().folders)await this.migrateConfigurationsForFolder(n,t)}async migrateConfigurationsForFolder(t,n){await Promise.all([n.map(i=>this.migrateConfigurationsForFolderAndOverride(i,t?.uri))])}async migrateConfigurationsForFolderAndOverride(t,n){let i=this.configurationService.inspect(t.key,{resource:n}),r=this.workspaceService.getWorkbenchState()===3?[["user",2],["userLocal",3],["userRemote",4],["workspace",5],["workspaceFolder",6]]:[["user",2],["userLocal",3],["userRemote",4],["workspace",5]];for(let[s,a]of r){let l=i[s];if(!l)continue;let d=[];if(l.value!==void 0){let c=await this.runMigration(t,s,l.value,n,void 0);for(let u of c??[])d.push([u,[]])}for(let{identifiers:c,value:u}of l.overrides??[])if(u!==void 0){let p=await this.runMigration(t,s,u,n,c);for(let h of p??[])d.push([h,c])}d.length&&await Promise.allSettled(d.map(async([[c,u],p])=>this.configurationService.updateValue(c,u.value,{resource:n,overrideIdentifiers:p},a)))}}async runMigration(t,n,i,r,s){let a=d=>{let u=this.configurationService.inspect(d,{resource:r})[n];if(u)return s?u.overrides?.find(({identifiers:p})=>Mn(p,s))?.value:u.value},l=await t.migrateFn(i,a);return Array.isArray(l)?l:[[t.key,l]]}};pD=O([x(0,ut),x(1,Dd)],pD);var hD=class extends F{constructor(t){super();this.remoteAgentService=t;this.create()}static ID="workbench.contrib.dynamicWorkbenchSecurityConfiguration";_ready=new Ed;ready=this._ready.p;async create(){try{await this.doCreate()}finally{this._ready.complete()}}async doCreate(){if(!pt&&(await this.remoteAgentService.getEnvironment())?.os!==1)return;et.as(Ao.Configuration).registerConfiguration({...Bq,properties:{"security.allowedUNCHosts":{type:"array",items:{type:"string",pattern:"^[^\\\\]+$",patternErrorMessage:m("security.allowedUNCHosts.patternErrorMessage","UNC host names must not contain backslashes.")},default:[],markdownDescription:m("security.allowedUNCHosts","A set of UNC host names (without leading or trailing backslash, for example `192.168.0.1` or `my-server`) to allow without user confirmation. If a UNC host is being accessed that is not allowed via this setting or has not been acknowledged via user confirmation, an error will occur and the operation stopped. A restart is required when changing this setting. Find out more about this setting at https://aka.ms/vscode-windows-unc."),scope:2},"security.restrictUNCAccess":{type:"boolean",default:!0,markdownDescription:m("security.restrictUNCAccess","If enabled, only allows access to UNC host names that are allowed by the `#security.allowedUNCHosts#` setting or after user confirmation. Find out more about this setting at https://aka.ms/vscode-windows-unc."),scope:2}}})}};hD=O([x(0,uD)],hD);var ea="window.newWindowProfile",mD=class extends F{constructor(t,n){super();this.userDataProfilesService=t;this.configurationService=n;this.registerNewWindowProfileConfiguration(),this._register(this.userDataProfilesService.onDidChangeProfiles(i=>this.registerNewWindowProfileConfiguration())),this.setNewWindowProfile(),this.checkAndResetNewWindowProfileConfig(),this._register(n.onDidChangeConfiguration(i=>{i.source!==7&&i.affectsConfiguration(ea)&&this.setNewWindowProfile()})),this._register(this.userDataProfilesService.onDidChangeProfiles(()=>this.checkAndResetNewWindowProfileConfig()))}static ID="workbench.contrib.dynamicWindowConfiguration";configurationNode;newWindowProfile;registerNewWindowProfileConfiguration(){let t=et.as(Ao.Configuration),n={...Vq,properties:{[ea]:{type:["string","null"],default:null,enum:[...this.userDataProfilesService.profiles.map(i=>i.name),null],enumItemLabels:[...this.userDataProfilesService.profiles.map(i=>""),m("active window","Active Window")],description:m("newWindowProfile","Specifies the profile to use when opening a new window. If a profile name is provided, the new window will use that profile. If no profile name is provided, the new window will use the profile of the active window or the Default profile if no active window exists."),scope:1}}};this.configurationNode?t.updateConfigurations({add:[n],remove:[this.configurationNode]}):t.registerConfiguration(n),this.configurationNode=n}setNewWindowProfile(){let t=this.configurationService.getValue(ea);this.newWindowProfile=t?this.userDataProfilesService.profiles.find(n=>n.name===t):void 0}checkAndResetNewWindowProfileConfig(){let t=this.configurationService.getValue(ea);if(!t)return;let n=this.newWindowProfile?this.userDataProfilesService.profiles.find(i=>i.id===this.newWindowProfile.id):void 0;t!==n?.name&&this.configurationService.updateValue(ea,n?.name)}};mD=O([x(0,su),x(1,ut)],mD);var Hq=Y("editorResolverService");var Uq=et.as(Ao.Configuration),zq={...B5,properties:{"workbench.editorAssociations":{type:"object",markdownDescription:m("editor.editorAssociations",'Configure [glob patterns](https://aka.ms/vscode-glob-patterns) to editors (for example `"*.hex": "hexEditor.hexedit"`). These have precedence over the default behavior.'),additionalProperties:{type:"string"}}}};Uq.registerConfiguration(zq);var STn=new $("workbenchState",void 0,{type:"string",description:m("workbenchState","The kind of workspace opened in the window, either 'empty' (no workspace), 'folder' (single folder) or 'workspace' (multi-root workspace)")}),ETn=new $("workspaceFolderCount",0,m("workspaceFolderCount","The number of root folders in the workspace")),TTn=new $("openFolderWorkspaceSupport",!0,!0),xTn=new $("enterMultiRootWorkspaceSupport",!0,!0),wTn=new $("emptyWorkspaceSupport",!0,!0),_Tn=new $("dirtyWorkingCopies",!1,m("dirtyWorkingCopies","Whether there are any working copies with unsaved changes")),DTn=new $("remoteName","",m("remoteName","The name of the remote the window is connected to or an empty string if not connected to any remote")),LTn=new $("virtualWorkspace","",m("virtualWorkspace","The scheme of the current workspace is from a virtual file system or an empty string.")),RTn=new $("temporaryWorkspace",!1,m("temporaryWorkspace","The scheme of the current workspace is from a temporary file system.")),kTn=new $("isFullscreen",!1,m("isFullscreen","Whether the main window is in fullscreen mode")),MTn=new $("isAuxiliaryWindowFocusedContext",!1,m("isAuxiliaryWindowFocusedContext","Whether an auxiliary window is focused")),PTn=new $("hasWebFileSystemAccess",!1,!0),OTn=new $("embedderIdentifier",void 0,m("embedderIdentifier","The identifier of the embedder according to the product service, if one is defined")),NTn=new $("activeEditorIsDirty",!1,m("activeEditorIsDirty","Whether the active editor has unsaved changes")),ATn=new $("activeEditorIsNotPreview",!1,m("activeEditorIsNotPreview","Whether the active editor is not in preview mode")),FTn=new $("activeEditorIsFirstInGroup",!1,m("activeEditorIsFirstInGroup","Whether the active editor is the first one in its group")),BTn=new $("activeEditorIsLastInGroup",!1,m("activeEditorIsLastInGroup","Whether the active editor is the last one in its group")),Kq=new $("activeEditorIsPinned",!1,m("activeEditorIsPinned","Whether the active editor is pinned")),VTn=new $("activeEditorIsReadonly",!1,m("activeEditorIsReadonly","Whether the active editor is read-only")),Gq=new $("activeCompareEditorCanSwap",!1,m("activeCompareEditorCanSwap","Whether the active compare editor can swap sides")),WTn=new $("activeEditorCanToggleReadonly",!0,m("activeEditorCanToggleReadonly","Whether the active editor can toggle between being read-only or writeable")),HTn=new $("activeEditorCanRevert",!1,m("activeEditorCanRevert","Whether the active editor can revert")),jq=new $("activeEditorCanSplitInGroup",!0),UTn=new $("activeEditor",null,{type:"string",description:m("activeEditor","The identifier of the active editor")}),zTn=new $("activeEditorAvailableEditorIds","",m("activeEditorAvailableEditorIds","The available editor identifiers that are usable for the active editor")),qq=new $("textCompareEditorVisible",!1,m("textCompareEditorVisible","Whether a text compare editor is visible")),V5=new $("textCompareEditorActive",!1,m("textCompareEditorActive","Whether a text compare editor is active")),$q=new $("sideBySideEditorActive",!1,m("sideBySideEditorActive","Whether a side by side editor is active")),KTn=new $("groupEditorsCount",0,m("groupEditorsCount","The number of opened editor groups")),Yq=new $("activeEditorGroupEmpty",!1,m("activeEditorGroupEmpty","Whether the active editor group is empty")),GTn=new $("activeEditorGroupIndex",0,m("activeEditorGroupIndex","The index of the active editor group")),jTn=new $("activeEditorGroupLast",!1,m("activeEditorGroupLast","Whether the active editor group is the last group")),Zq=new $("activeEditorGroupLocked",!1,m("activeEditorGroupLocked","Whether the active editor group is locked")),W5=new $("multipleEditorGroups",!1,m("multipleEditorGroups","Whether there are multiple editor groups opened")),qTn=W5.toNegated(),$Tn=new $("multipleEditorsSelectedInGroup",!1,m("multipleEditorsSelectedInGroup","Whether multiple editors have been selected in an editor group")),YTn=new $("twoEditorsSelectedInGroup",!1,m("twoEditorsSelectedInGroup","Whether exactly two editors have been selected in an editor group")),ZTn=new $("SelectedEditorsInGroupFileOrUntitledResourceContextKey",!0,m("SelectedEditorsInGroupFileOrUntitledResourceContextKey","Whether all selected editors in a group have a file or untitled resource associated")),Xq=new $("editorPartMultipleEditorGroups",!1,m("editorPartMultipleEditorGroups","Whether there are multiple editor groups opened in an editor part")),XTn=Xq.toNegated(),QTn=new $("editorPartMaximizedEditorGroup",!1,m("editorPartEditorGroupMaximized","Editor Part has a maximized group")),JTn=new $("isAuxiliaryEditorPart",!1,m("isAuxiliaryEditorPart","Editor Part is in an auxiliary window")),exn=new $("editorIsOpen",!1,m("editorIsOpen","Whether an editor is open")),txn=new $("inZenMode",!1,m("inZenMode","Whether Zen mode is enabled")),nxn=new $("isCenteredLayout",!1,m("isMainEditorCenteredLayout","Whether centered layout is enabled for the main editor")),ixn=new $("splitEditorsVertically",!1,m("splitEditorsVertically","Whether editors split vertically")),oxn=new $("mainEditorAreaVisible",!0,m("mainEditorAreaVisible","Whether the editor area in the main window is visible")),rxn=new $("editorTabsVisible",!0,m("editorTabsVisible","Whether editor tabs are visible")),sxn=new $("sideBarVisible",!1,m("sideBarVisible","Whether the sidebar is visible")),axn=new $("sideBarFocus",!1,m("sideBarFocus","Whether the sidebar has keyboard focus")),lxn=new $("activeViewlet","",m("activeViewlet","The identifier of the active viewlet")),dxn=new $("statusBarFocused",!1,m("statusBarFocused","Whether the status bar has keyboard focus")),cxn=new $("titleBarStyle",At?"native":"custom",m("titleBarStyle","Style of the window title bar")),uxn=new $("titleBarVisible",!1,m("titleBarVisible","Whether the title bar is visible")),pxn=new $("bannerFocused",!1,m("bannerFocused","Whether the banner has keyboard focus")),hxn=new $("notificationFocus",!0,m("notificationFocus","Whether a notification has keyboard focus")),mxn=new $("notificationCenterVisible",!1,m("notificationCenterVisible","Whether the notifications center is visible")),gxn=new $("notificationToastsVisible",!1,m("notificationToastsVisible","Whether a notification toast is visible")),fxn=new $("activeAuxiliary","",m("activeAuxiliary","The identifier of the active auxiliary panel")),bxn=new $("auxiliaryBarFocus",!1,m("auxiliaryBarFocus","Whether the auxiliary bar has keyboard focus")),vxn=new $("auxiliaryBarVisible",!1,m("auxiliaryBarVisible","Whether the auxiliary bar is visible")),yxn=new $("activePanel","",m("activePanel","The identifier of the active panel")),Ixn=new $("panelFocus",!1,m("panelFocus","Whether the panel has keyboard focus")),Cxn=new $("panelPosition","bottom",m("panelPosition","The position of the panel, always 'bottom'")),Sxn=new $("panelAlignment","center",m("panelAlignment","The alignment of the panel, either 'center', 'left', 'right' or 'justify'")),Exn=new $("panelVisible",!1,m("panelVisible","Whether the panel is visible")),Txn=new $("panelMaximized",!1,m("panelMaximized","Whether the panel is maximized")),xxn=new $("focusedView","",m("focusedView","The identifier of the view that has keyboard focus"));var Ir=class{constructor(e,t,n,i){this._contextKeyService=e;this._fileService=t;this._languageService=n;this._modelService=i;this._schemeKey=Ir.Scheme.bindTo(this._contextKeyService),this._filenameKey=Ir.Filename.bindTo(this._contextKeyService),this._dirnameKey=Ir.Dirname.bindTo(this._contextKeyService),this._pathKey=Ir.Path.bindTo(this._contextKeyService),this._langIdKey=Ir.LangId.bindTo(this._contextKeyService),this._resourceKey=Ir.Resource.bindTo(this._contextKeyService),this._extensionKey=Ir.Extension.bindTo(this._contextKeyService),this._hasResource=Ir.HasResource.bindTo(this._contextKeyService),this._isFileSystemResource=Ir.IsFileSystemResource.bindTo(this._contextKeyService),this._disposables.add(t.onDidChangeFileSystemProviderRegistrations(()=>{let r=this.get();this._isFileSystemResource.set(!!(r&&t.hasProvider(r)))})),this._disposables.add(i.onModelAdded(r=>{nr(r.uri,this.get())&&this._setLangId()})),this._disposables.add(i.onModelLanguageChanged(r=>{nr(r.model.uri,this.get())&&this._setLangId()}))}static Scheme=new $("resourceScheme",void 0,{type:"string",description:m("resourceScheme","The scheme of the resource")});static Filename=new $("resourceFilename",void 0,{type:"string",description:m("resourceFilename","The file name of the resource")});static Dirname=new $("resourceDirname",void 0,{type:"string",description:m("resourceDirname","The folder name the resource is contained in")});static Path=new $("resourcePath",void 0,{type:"string",description:m("resourcePath","The full path of the resource")});static LangId=new $("resourceLangId",void 0,{type:"string",description:m("resourceLangId","The language identifier of the resource")});static Resource=new $("resource",void 0,{type:"URI",description:m("resource","The full value of the resource including scheme and path")});static Extension=new $("resourceExtname",void 0,{type:"string",description:m("resourceExtname","The extension name of the resource")});static HasResource=new $("resourceSet",void 0,{type:"boolean",description:m("resourceSet","Whether a resource is present or not")});static IsFileSystemResource=new $("isFileSystemResource",void 0,{type:"boolean",description:m("isFileSystemResource","Whether the resource is backed by a file system provider")});_disposables=new ee;_value;_resourceKey;_schemeKey;_filenameKey;_dirnameKey;_pathKey;_langIdKey;_extensionKey;_hasResource;_isFileSystemResource;dispose(){this._disposables.dispose()}_setLangId(){let e=this.get();if(!e){this._langIdKey.set(null);return}let t=this._modelService.getModel(e)?.getLanguageId()??this._languageService.guessLanguageIdByFilepathOrFirstLine(e);this._langIdKey.set(t)}set(e){e=e??void 0,!nr(this._value,e)&&(this._value=e,this._contextKeyService.bufferChangeEvents(()=>{this._resourceKey.set(e?e.toString():null),this._schemeKey.set(e?e.scheme:null),this._filenameKey.set(e?go(e):null),this._dirnameKey.set(e?this.uriToPath(Sd(e)):null),this._pathKey.set(e?this.uriToPath(e):null),this._setLangId(),this._extensionKey.set(e?gI(e):null),this._hasResource.set(!!e),this._isFileSystemResource.set(e?this._fileService.hasProvider(e):!1)}))}uriToPath(e){return e.scheme===Le.file?e.fsPath:e.path}reset(){this._value=void 0,this._contextKeyService.bufferChangeEvents(()=>{this._resourceKey.reset(),this._schemeKey.reset(),this._filenameKey.reset(),this._dirnameKey.reset(),this._pathKey.reset(),this._langIdKey.reset(),this._extensionKey.reset(),this._hasResource.reset(),this._isFileSystemResource.reset()})}get(){return this._value}};Ir=O([x(0,_t),x(1,Bt),x(2,Di),x(3,ls)],Ir);function H5(o){return o.scheme!==Le.file&&o.scheme!==Le.vscodeRemote}function Jq(o){if(o.folders.length)return o.folders.every(e=>H5(e.uri))?o.folders[0].uri:void 0;if(o.configuration&&H5(o.configuration))return o.configuration}function U5(o){return Jq(o)?.scheme}var e$=Y("pathService"),Og=class{constructor(e,t,n,i){this.localUserHome=e;this.remoteAgentService=t;this.environmentService=n;this.contextService=i;this.resolveOS=(async()=>(await this.remoteAgentService.getEnvironment())?.os||qr)(),this.resolveUserHome=(async()=>{let r=await this.remoteAgentService.getEnvironment();return this.maybeUnresolvedUserHome=r?.userHome??e})()}resolveOS;resolveUserHome;maybeUnresolvedUserHome;hasValidBasename(e,t,n){return typeof t=="string"||typeof t>"u"?this.resolveOS.then(i=>this.doHasValidBasename(e,i,t)):this.doHasValidBasename(e,t,n)}doHasValidBasename(e,t,n){return e.scheme===Le.file||e.scheme===Le.vscodeRemote?YA(n??go(e),t===1):!0}get defaultUriScheme(){return Og.findDefaultUriScheme(this.environmentService,this.contextService)}static findDefaultUriScheme(e,t){if(e.remoteAuthority)return Le.vscodeRemote;let n=U5(t.getWorkspace());if(n)return n;let i=t.getWorkspace().folders[0];if(i)return i.uri.scheme;let r=t.getWorkspace().configuration;return r?r.scheme:Le.file}userHome(e){return e?.preferLocal?this.localUserHome:this.resolveUserHome}get resolvedUserHome(){return this.maybeUnresolvedUserHome}get path(){return this.resolveOS.then(e=>e===1?wn:bt)}async fileURI(e){let t="";if(await this.resolveOS===1&&(e=e.replace(/\\/g,"/")),e[0]==="/"&&e[1]==="/"){let i=e.indexOf("/",2);i===-1?(t=e.substring(2),e="/"):(t=e.substring(2,i),e=e.substring(i)||"/")}return J.from({scheme:Le.file,authority:t,path:e,query:"",fragment:""})}};Og=O([x(1,uD),x(2,Ju),x(3,Dd)],Og);var il="_workbench.open";var fD=class{constructor(e,t,n){this.userDataProfileService=e;this.fileService=t;this.logService=n}async initialize(e){let t=JSON.parse(e);if(t.settings===null){this.logService.info("Initializing Profile: No settings to apply...");return}await this.fileService.writeFile(this.userDataProfileService.currentProfile.settingsResource,vt.fromString(t.settings))}};fD=O([x(0,Or),x(1,Bt),x(2,Gt)],fD);var Pc=class{constructor(e,t,n){this.fileService=e;this.userDataSyncUtilService=t;this.logService=n}async getContent(e){let t=await this.getSettingsContent(e);return JSON.stringify(t)}async getSettingsContent(e){let t=await this.getLocalFileContent(e);if(t===null)return{settings:null};{let n=this.getIgnoredSettings(),i=await this.userDataSyncUtilService.resolveFormattingOptions(e.settingsResource);return{settings:z0(t||"{}","{}",n,i)}}}async apply(e,t){let n=JSON.parse(e);if(n.settings===null){this.logService.info(`Importing Profile (${t.name}): No settings to apply...`);return}let i=await this.getLocalFileContent(t),r=await this.userDataSyncUtilService.resolveFormattingOptions(t.settingsResource),s=z0(n.settings,i||"{}",this.getIgnoredSettings(),r);await this.fileService.writeFile(t.settingsResource,vt.fromString(s))}getIgnoredSettings(){let e=et.as(Ao.Configuration).getConfigurationProperties();return Object.keys(e).filter(n=>e[n]?.scope===2||e[n]?.scope===6)}async getLocalFileContent(e){try{return(await this.fileService.readFile(e.settingsResource)).value.toString()}catch(t){if(t instanceof ir&&t.fileOperationResult===1)return null;throw t}}};Pc=O([x(0,Bt),x(1,$B),x(2,Gt)],Pc);var Ng=class{constructor(e,t,n){this.profile=e;this.uriIdentityService=t;this.instantiationService=n}type="settings";handle="settings";label={label:m("settings","Settings")};collapsibleState=2;checkbox;async getChildren(){return[{handle:this.profile.settingsResource.toString(),resourceUri:this.profile.settingsResource,collapsibleState:0,parent:this,accessibilityInformation:{label:this.uriIdentityService.extUri.basename(this.profile.settingsResource)},command:{id:il,title:"",arguments:[this.profile.settingsResource,void 0,void 0]}}]}async hasContent(){return(await this.instantiationService.createInstance(Pc).getSettingsContent(this.profile)).settings!==null}async getContent(){return this.instantiationService.createInstance(Pc).getContent(this.profile)}isFromDefaultProfile(){return!this.profile.isDefault&&!!this.profile.useDefaultFlags?.settings}};Ng=O([x(1,eo),x(2,Oe)],Ng);var bD=class{constructor(e,t,n){this.userDataProfileService=e;this.fileService=t;this.logService=n}async initialize(e){let t=JSON.parse(e);if(t.keybindings===null){this.logService.info("Initializing Profile: No keybindings to apply...");return}await this.fileService.writeFile(this.userDataProfileService.currentProfile.keybindingsResource,vt.fromString(t.keybindings))}};bD=O([x(0,Or),x(1,Bt),x(2,Gt)],bD);var Oc=class{constructor(e,t){this.fileService=e;this.logService=t}async getContent(e){let t=await this.getKeybindingsResourceContent(e);return JSON.stringify(t)}async getKeybindingsResourceContent(e){return{keybindings:await this.getKeybindingsContent(e),platform:Pp}}async apply(e,t){let n=JSON.parse(e);if(n.keybindings===null){this.logService.info(`Importing Profile (${t.name}): No keybindings to apply...`);return}await this.fileService.writeFile(t.keybindingsResource,vt.fromString(n.keybindings))}async getKeybindingsContent(e){try{return(await this.fileService.readFile(e.keybindingsResource)).value.toString()}catch(t){if(t instanceof ir&&t.fileOperationResult===1)return null;throw t}}};Oc=O([x(0,Bt),x(1,Gt)],Oc);var Ag=class{constructor(e,t,n){this.profile=e;this.uriIdentityService=t;this.instantiationService=n}type="keybindings";handle="keybindings";label={label:m("keybindings","Keyboard Shortcuts")};collapsibleState=2;checkbox;isFromDefaultProfile(){return!this.profile.isDefault&&!!this.profile.useDefaultFlags?.keybindings}async getChildren(){return[{handle:this.profile.keybindingsResource.toString(),resourceUri:this.profile.keybindingsResource,collapsibleState:0,parent:this,accessibilityInformation:{label:this.uriIdentityService.extUri.basename(this.profile.settingsResource)},command:{id:il,title:"",arguments:[this.profile.keybindingsResource,void 0,void 0]}}]}async hasContent(){return(await this.instantiationService.createInstance(Oc).getKeybindingsResourceContent(this.profile)).keybindings!==null}async getContent(){return this.instantiationService.createInstance(Oc).getContent(this.profile)}};Ag=O([x(1,eo),x(2,Oe)],Ag);var vD=class{constructor(e,t,n){this.userDataProfileService=e;this.fileService=t;this.logService=n}async initialize(e){let t=JSON.parse(e);if(!t.tasks){this.logService.info("Initializing Profile: No tasks to apply...");return}await this.fileService.writeFile(this.userDataProfileService.currentProfile.tasksResource,vt.fromString(t.tasks))}};vD=O([x(0,Or),x(1,Bt),x(2,Gt)],vD);var Nc=class{constructor(e,t){this.fileService=e;this.logService=t}async getContent(e){let t=await this.getTasksResourceContent(e);return JSON.stringify(t)}async getTasksResourceContent(e){return{tasks:await this.getTasksContent(e)}}async apply(e,t){let n=JSON.parse(e);if(!n.tasks){this.logService.info(`Importing Profile (${t.name}): No tasks to apply...`);return}await this.fileService.writeFile(t.tasksResource,vt.fromString(n.tasks))}async getTasksContent(e){try{return(await this.fileService.readFile(e.tasksResource)).value.toString()}catch(t){if(t instanceof ir&&t.fileOperationResult===1)return null;throw t}}};Nc=O([x(0,Bt),x(1,Gt)],Nc);var Fg=class{constructor(e,t,n){this.profile=e;this.uriIdentityService=t;this.instantiationService=n}type="tasks";handle="tasks";label={label:m("tasks","Tasks")};collapsibleState=2;checkbox;async getChildren(){return[{handle:this.profile.tasksResource.toString(),resourceUri:this.profile.tasksResource,collapsibleState:0,parent:this,accessibilityInformation:{label:this.uriIdentityService.extUri.basename(this.profile.settingsResource)},command:{id:il,title:"",arguments:[this.profile.tasksResource,void 0,void 0]}}]}async hasContent(){return(await this.instantiationService.createInstance(Nc).getTasksResourceContent(this.profile)).tasks!==null}async getContent(){return this.instantiationService.createInstance(Nc).getContent(this.profile)}isFromDefaultProfile(){return!this.profile.isDefault&&!!this.profile.useDefaultFlags?.tasks}};Fg=O([x(1,eo),x(2,Oe)],Fg);var yD=class{constructor(e,t,n){this.userDataProfileService=e;this.fileService=t;this.uriIdentityService=n}async initialize(e){let t=JSON.parse(e);for(let n in t.snippets){let i=this.uriIdentityService.extUri.joinPath(this.userDataProfileService.currentProfile.snippetsHome,n);await this.fileService.writeFile(i,vt.fromString(t.snippets[n]))}}};yD=O([x(0,Or),x(1,Bt),x(2,eo)],yD);var Xl=class{constructor(e,t){this.fileService=e;this.uriIdentityService=t}async getContent(e,t){let n=await this.getSnippets(e,t);return JSON.stringify({snippets:n})}async apply(e,t){let n=JSON.parse(e);for(let i in n.snippets){let r=this.uriIdentityService.extUri.joinPath(t.snippetsHome,i);await this.fileService.writeFile(r,vt.fromString(n.snippets[i]))}}async getSnippets(e,t){let n={},i=await this.getSnippetsResources(e,t);for(let r of i){let s=this.uriIdentityService.extUri.relativePath(e.snippetsHome,r),a=await this.fileService.readFile(r);n[s]=a.value.toString()}return n}async getSnippetsResources(e,t){let n=[],i;try{i=await this.fileService.resolve(e.snippetsHome)}catch(r){if(r instanceof ir&&r.fileOperationResult===1)return n;throw r}for(let{resource:r}of i.children||[]){if(t?.has(r))continue;let s=this.uriIdentityService.extUri.extname(r);(s===".json"||s===".code-snippets")&&n.push(r)}return n}};Xl=O([x(0,Bt),x(1,eo)],Xl);var Bg=class{constructor(e,t,n){this.profile=e;this.instantiationService=t;this.uriIdentityService=n}type="snippets";handle=this.profile.snippetsHome.toString();label={label:m("snippets","Snippets")};collapsibleState=1;checkbox;excludedSnippets=new Ap;async getChildren(){let e=await this.instantiationService.createInstance(Xl).getSnippetsResources(this.profile),t=this;return e.map(n=>({handle:n.toString(),parent:t,resourceUri:n,collapsibleState:0,accessibilityInformation:{label:this.uriIdentityService.extUri.basename(n)},checkbox:t.checkbox?{get isChecked(){return!t.excludedSnippets.has(n)},set isChecked(i){i?t.excludedSnippets.delete(n):t.excludedSnippets.add(n)},accessibilityInformation:{label:m("exclude","Select Snippet {0}",this.uriIdentityService.extUri.basename(n))}}:void 0,command:{id:il,title:"",arguments:[n,void 0,void 0]}}))}async hasContent(){return(await this.instantiationService.createInstance(Xl).getSnippetsResources(this.profile)).length>0}async getContent(){return this.instantiationService.createInstance(Xl).getContent(this.profile,this.excludedSnippets)}isFromDefaultProfile(){return!this.profile.isDefault&&!!this.profile.useDefaultFlags?.snippets}};Bg=O([x(1,Oe),x(2,eo)],Bg);var ID=class{type;ctime;mtime;size;name;data;constructor(e){this.type=1,this.ctime=Date.now(),this.mtime=Date.now(),this.size=0,this.name=e}},wp=class{type;ctime;mtime;size;name;entries;constructor(e){this.type=2,this.ctime=Date.now(),this.mtime=Date.now(),this.size=0,this.name=e,this.entries=new Map}},CD=class extends F{memoryFdCounter=0;fdMemory=new Map;_onDidChangeCapabilities=this._register(new D);onDidChangeCapabilities=this._onDidChangeCapabilities.event;_capabilities=1026;get capabilities(){return this._capabilities}setReadOnly(e){let t=!!(this._capabilities&2048);e!==t&&(this._capabilities=e?3074:1026,this._onDidChangeCapabilities.fire())}root=new wp("");async stat(e){return this._lookup(e,!1)}async readdir(e){let t=this._lookupAsDirectory(e,!1),n=[];return t.entries.forEach((i,r)=>n.push([r,i.type])),n}async readFile(e){let t=this._lookupAsFile(e,!1).data;if(t)return t;throw kr("file not found","EntryNotFound")}readFileStream(e){let t=this._lookupAsFile(e,!1).data,n=Ef(i=>vt.concat(i.map(r=>vt.wrap(r))).buffer);return n.end(t),n}async writeFile(e,t,n){let i=go(e),r=this._lookupParentDirectory(e),s=r.entries.get(i);if(s instanceof wp)throw kr("file is directory","EntryIsADirectory");if(!s&&!n.create)throw kr("file not found","EntryNotFound");if(s&&n.create&&!n.overwrite)throw kr("file exists already","EntryExists");s||(s=new ID(i),r.entries.set(i,s),this._fireSoon({type:1,resource:e})),s.mtime=Date.now(),s.size=t.byteLength,s.data=t,this._fireSoon({type:0,resource:e})}open(e,t){let n=this._lookupAsFile(e,!1).data;if(n){let i=this.memoryFdCounter++;return this.fdMemory.set(i,n),Promise.resolve(i)}throw kr("file not found","EntryNotFound")}close(e){return this.fdMemory.delete(e),Promise.resolve()}read(e,t,n,i,r){let s=this.fdMemory.get(e);if(!s)throw kr("No file with that descriptor open","Unavailable");let a=vt.wrap(s).slice(t,t+r);return n.set(a.buffer,i),Promise.resolve(a.byteLength)}write(e,t,n,i,r){let s=this.fdMemory.get(e);if(!s)throw kr("No file with that descriptor open","Unavailable");let a=vt.wrap(n).slice(i,i+r);return s.set(a.buffer,t),Promise.resolve(a.byteLength)}async rename(e,t,n){if(!n.overwrite&&this._lookup(t,!0))throw kr("file exists already","EntryExists");let i=this._lookup(e,!1),r=this._lookupParentDirectory(e),s=this._lookupParentDirectory(t),a=go(t);r.entries.delete(i.name),i.name=a,s.entries.set(a,i),this._fireSoon({type:2,resource:e},{type:1,resource:t})}async delete(e,t){let n=Sd(e),i=go(e),r=this._lookupAsDirectory(n,!1);r.entries.has(i)&&(r.entries.delete(i),r.mtime=Date.now(),r.size-=1,this._fireSoon({type:0,resource:n},{resource:e,type:2}))}async mkdir(e){if(this._lookup(e,!0))throw kr("file exists already","EntryExists");let t=go(e),n=Sd(e),i=this._lookupAsDirectory(n,!1),r=new wp(t);i.entries.set(r.name,r),i.mtime=Date.now(),i.size+=1,this._fireSoon({type:0,resource:n},{type:1,resource:e})}_lookup(e,t){let n=e.path.split("/"),i=this.root;for(let r of n){if(!r)continue;let s;if(i instanceof wp&&(s=i.entries.get(r)),!s){if(t)return;throw kr("file not found","EntryNotFound")}i=s}return i}_lookupAsDirectory(e,t){let n=this._lookup(e,t);if(n instanceof wp)return n;throw kr("file not a directory","EntryNotADirectory")}_lookupAsFile(e,t){let n=this._lookup(e,t);if(n instanceof ID)return n;throw kr("file is a directory","EntryIsADirectory")}_lookupParentDirectory(e){let t=Sd(e);return this._lookupAsDirectory(t,!1)}_onDidChangeFile=this._register(new D);onDidChangeFile=this._onDidChangeFile.event;_bufferedChanges=[];_fireSoonHandle;watch(e,t){return F.None}_fireSoon(...e){this._bufferedChanges.push(...e),this._fireSoonHandle&&clearTimeout(this._fireSoonHandle),this._fireSoonHandle=setTimeout(()=>{this._onDidChangeFile.fire(this._bufferedChanges),this._bufferedChanges.length=0},5)}dispose(){super.dispose(),this.fdMemory.clear()}};function YRn(o){return o.resourceType!==void 0}function ZRn(o){return o.label!==void 0}var Vg=class extends F{constructor(t,n,i,r,s,a,l,d){super();this.userDataProfileManagementService=s;this.userDataProfilesService=a;this.commandService=l;this.instantiationService=d;this._name=t,this._icon=n,this._flags=i,this._active=r,this._register(this.onDidChange(c=>{c.message||this.validate(),this.save()}))}_onDidChange=this._register(new D);onDidChange=this._onDidChange.event;saveScheduler=this._register(new nn(()=>this.doSave(),500));_name="";get name(){return this._name}set name(t){t=t.trim(),this._name!==t&&(this._name=t,this._onDidChange.fire({name:!0}))}_icon;get icon(){return this._icon}set icon(t){this._icon!==t&&(this._icon=t,this._onDidChange.fire({icon:!0}))}_flags;get flags(){return this._flags}set flags(t){Mn(this._flags,t)||(this._flags=t,this._onDidChange.fire({flags:!0}))}_active=!1;get active(){return this._active}set active(t){this._active!==t&&(this._active=t,this._onDidChange.fire({active:!0}))}_message;get message(){return this._message}set message(t){this._message!==t&&(this._message=t,this._onDidChange.fire({message:!0}))}_disabled=!1;get disabled(){return this._disabled}set disabled(t){this._disabled!==t&&(this._disabled=t,this._onDidChange.fire({disabled:!0}))}getFlag(t){return this.flags?.[t]??!1}setFlag(t,n){let i=this.flags?{...this.flags}:{};n?i[t]=!0:delete i[t],this.flags=i}validate(){if(!this.name){this.message=m("name required","Profile name is required and must be a non-empty value.");return}if(this.shouldValidateName()&&this.name!==this.getInitialName()&&this.userDataProfilesService.profiles.some(t=>t.name===this.name)){this.message=m("profileExists","Profile with name {0} already exists.",this.name);return}if(this.flags&&this.flags.settings&&this.flags.keybindings&&this.flags.tasks&&this.flags.snippets&&this.flags.extensions){this.message=m("invalid configurations","The profile should contain at least one configuration.");return}this.message=void 0}async getChildren(t){if(t===void 0){let n=["settings","keybindings","tasks","snippets","extensions"];return Promise.all(n.map(async i=>{let r=i==="settings"||i==="keybindings"||i==="tasks"?await this.getChildrenForResourceType(i):[];return{handle:i,checkbox:void 0,resourceType:i,action:r.length?new Ht("_open",m("open","Open to the Side"),we.asClassName(te.goToFile),!0,()=>r[0]?.action?.run()):void 0}}))}return this.getChildrenForResourceType(t)}async getChildrenForResourceType(t){return[]}async getChildrenFromProfile(t,n){t=this.getFlag(n)?this.userDataProfilesService.defaultProfile:t;let i=[];switch(n){case"settings":i=await this.instantiationService.createInstance(Ng,t).getChildren();break;case"keybindings":i=await this.instantiationService.createInstance(Ag,t).getChildren();break;case"snippets":i=await this.instantiationService.createInstance(Bg,t).getChildren()??[];break;case"tasks":i=await this.instantiationService.createInstance(Fg,t).getChildren();break;case"extensions":i=await this.instantiationService.createInstance(wh,t).getChildren();break}return i.map(r=>this.toUserDataProfileResourceChildElement(r))}toUserDataProfileResourceChildElement(t){return{handle:t.handle,checkbox:t.checkbox,label:t.label?.label??"",resource:J.revive(t.resourceUri),icon:t.themeIcon,action:new Ht("_openChild",m("open","Open to the Side"),we.asClassName(te.goToFile),!0,async()=>{t.parent.type==="extensions"?await this.commandService.executeCommand("extension.open",t.handle,void 0,!0,void 0,!0):t.resourceUri&&await this.commandService.executeCommand(il,t.resourceUri,[dx],void 0)})}}getInitialName(){return""}shouldValidateName(){return!0}save(){this.saveScheduler.schedule()}hasUnsavedChanges(t){return this.name!==t.name||this.icon!==t.icon||!Mn(this.flags??{},t.useDefaultFlags??{})}async saveProfile(t){if(!this.hasUnsavedChanges(t)||(this.validate(),this.message))return;let n=this.flags?this.flags.settings&&this.flags.keybindings&&this.flags.tasks&&this.flags.globalState&&this.flags.extensions?void 0:this.flags:void 0;return await this.userDataProfileManagementService.updateProfile(t,{name:this.name,icon:this.icon,useDefaultFlags:t.useDefaultFlags&&!n?{}:n})}};Vg=O([x(4,cb),x(5,su),x(6,Ji),x(7,Oe)],Vg);var Ac=class extends Vg{constructor(t,n,i,r,s,a,l,d,c){super(t.name,t.icon,t.useDefaultFlags,r.currentProfile.id===t.id,a,l,d,c);this._profile=t;this.titleButtons=n;this.actions=i;this.userDataProfileService=r;this.configurationService=s;this._isNewWindowProfile=this.configurationService.getValue(ea)===this.profile.name,this._register(s.onDidChangeConfiguration(u=>{u.affectsConfiguration(ea)&&(this.isNewWindowProfile=this.configurationService.getValue(ea)===this.profile.name)})),this._register(this.userDataProfileService.onDidChangeCurrentProfile(()=>this.active=this.userDataProfileService.currentProfile.id===this.profile.id)),this._register(this.userDataProfilesService.onDidChangeProfiles(({updated:u})=>{let p=u.find(h=>h.id===this.profile.id);p&&(this._profile=p,this.reset(),this._onDidChange.fire({profile:!0}))}))}get profile(){return this._profile}reset(){this.name=this._profile.name,this.icon=this._profile.icon,this.flags=this._profile.useDefaultFlags}async toggleNewWindowProfile(){this._isNewWindowProfile?await this.configurationService.updateValue(ea,null):await this.configurationService.updateValue(ea,this.profile.name)}_isNewWindowProfile=!1;get isNewWindowProfile(){return this._isNewWindowProfile}set isNewWindowProfile(t){this._isNewWindowProfile!==t&&(this._isNewWindowProfile=t,this._onDidChange.fire({newWindowProfile:!0}))}async toggleCurrentWindowProfile(){this.userDataProfileService.currentProfile.id===this.profile.id?await this.userDataProfileManagementService.switchProfile(this.userDataProfilesService.defaultProfile):await this.userDataProfileManagementService.switchProfile(this.profile)}async doSave(){await this.saveProfile(this.profile)}async getChildrenForResourceType(t){return this.getChildrenFromProfile(this.profile,t)}getInitialName(){return this.profile.name}};Ac=O([x(3,Or),x(4,ut),x(5,cb),x(6,su),x(7,Ji),x(8,Oe)],Ac);var MN="userdataprofiletemplatepreview",_p=class extends Vg{constructor(t,n,i,r,s,a,l,d,c,u){super(t,void 0,void 0,!1,l,d,c,u);this.titleButtons=i;this.actions=r;this.fileService=s;this.userDataProfileImportExportService=a;this.defaultName=t,this._copyFrom=n,this._copyFlags=this.getCopyFlagsFrom(n),this.initialize(),this._register(this.fileService.registerProvider(MN,this._register(new CD)))}_copyFromTemplates=new Ui;get copyFromTemplates(){return this._copyFromTemplates}templatePromise;template=null;defaultName;defaultIcon;_copyFrom;get copyFrom(){return this._copyFrom}set copyFrom(t){this._copyFrom!==t&&(this._copyFrom=t,this._onDidChange.fire({copyFrom:!0}),this.flags=void 0,this.copyFlags=this.getCopyFlagsFrom(t),t instanceof J&&(this.templatePromise?.cancel(),this.templatePromise=void 0),this.initialize())}_copyFlags;get copyFlags(){return this._copyFlags}set copyFlags(t){Mn(this._copyFlags,t)||(this._copyFlags=t,this._onDidChange.fire({copyFlags:!0}))}_previewProfile;get previewProfile(){return this._previewProfile}set previewProfile(t){this._previewProfile!==t&&(this._previewProfile=t,this._onDidChange.fire({preview:!0}))}getCopyFlagsFrom(t){return t?{settings:!0,keybindings:!0,snippets:!0,tasks:!0,extensions:!0}:void 0}async initialize(){this.disabled=!0;try{if(this.copyFrom instanceof J){await this.resolveTemplate(this.copyFrom),this.template&&(this.copyFromTemplates.set(this.copyFrom,this.template.name),this.defaultName===this.name&&(this.name=this.defaultName=this.template.name??""),this.defaultIcon===this.icon&&(this.icon=this.defaultIcon=this.template.icon),this.setCopyFlag("settings",!!this.template.settings),this.setCopyFlag("keybindings",!!this.template.keybindings),this.setCopyFlag("tasks",!!this.template.tasks),this.setCopyFlag("snippets",!!this.template.snippets),this.setCopyFlag("extensions",!!this.template.extensions),this._onDidChange.fire({copyFromInfo:!0}));return}if(ba(this.copyFrom)){this.defaultName===this.name&&(this.name=this.defaultName=m("copy from","{0} (Copy)",this.copyFrom.name)),this.defaultIcon===this.icon&&(this.icon=this.defaultIcon=this.copyFrom.icon),this.setCopyFlag("settings",!0),this.setCopyFlag("keybindings",!0),this.setCopyFlag("tasks",!0),this.setCopyFlag("snippets",!0),this.setCopyFlag("extensions",!0),this._onDidChange.fire({copyFromInfo:!0});return}this.defaultName===this.name&&(this.name=this.defaultName=m("untitled","Untitled")),this.defaultIcon===this.icon&&(this.icon=this.defaultIcon=void 0),this.setCopyFlag("settings",!1),this.setCopyFlag("keybindings",!1),this.setCopyFlag("tasks",!1),this.setCopyFlag("snippets",!1),this.setCopyFlag("extensions",!1),this._onDidChange.fire({copyFromInfo:!0})}finally{this.disabled=!1}}async resolveTemplate(t){return this.templatePromise||(this.templatePromise=Sl(async n=>{let i=await this.userDataProfileImportExportService.resolveProfileTemplate(t);n.isCancellationRequested||(this.template=i)})),await this.templatePromise,this.template}hasResource(t){if(this.template)switch(t){case"settings":return!!this.template.settings;case"keybindings":return!!this.template.keybindings;case"snippets":return!!this.template.snippets;case"tasks":return!!this.template.tasks;case"extensions":return!!this.template.extensions}return!0}getCopyFlag(t){return this.copyFlags?.[t]??!1}setCopyFlag(t,n){let i=this.copyFlags?{...this.copyFlags}:{};i[t]=n,this.copyFlags=i}getCopyFromName(){if(ba(this.copyFrom))return this.copyFrom.name;if(this.copyFrom instanceof J)return this.copyFromTemplates.get(this.copyFrom)}async getChildrenForResourceType(t){return this.getFlag(t)?this.getChildrenFromProfile(this.userDataProfilesService.defaultProfile,t):this.getCopyFlag(t)?this.copyFrom instanceof J?(await this.resolveTemplate(this.copyFrom),this.template?this.getChildrenFromProfileTemplate(this.template,t):[]):this.copyFrom?this.getChildrenFromProfile(this.copyFrom,t):[]:[]}async getChildrenFromProfileTemplate(t,n){let i=ou(Mr(),this.name,J.file("/root").with({scheme:MN}),J.file("/cache").with({scheme:MN}));switch(n){case"settings":return t.settings?(await this.instantiationService.createInstance(Pc).apply(t.settings,i),this.getChildrenFromProfile(i,n)):[];case"keybindings":return t.keybindings?(await this.instantiationService.createInstance(Oc).apply(t.keybindings,i),this.getChildrenFromProfile(i,n)):[];case"snippets":return t.snippets?(await this.instantiationService.createInstance(Xl).apply(t.snippets,i),this.getChildrenFromProfile(i,n)):[];case"tasks":return t.tasks?(await this.instantiationService.createInstance(Nc).apply(t.tasks,i),this.getChildrenFromProfile(i,n)):[];case"extensions":return t.extensions?(await this.instantiationService.createInstance(_h,t.extensions).getChildren()).map(s=>this.toUserDataProfileResourceChildElement(s)):[]}return[]}shouldValidateName(){return!this.copyFrom}getInitialName(){return this.previewProfile?.name??""}async doSave(){if(this.previewProfile){let t=await this.saveProfile(this.previewProfile);t&&(this.previewProfile=t)}}};_p=O([x(4,Bt),x(5,C0),x(6,cb),x(7,su),x(8,Ji),x(9,Oe)],_p);var Ql=class extends xa{constructor(t,n,i,r,s,a,l,d,c,u){super();this.userDataProfileService=t;this.userDataProfilesService=n;this.userDataProfileManagementService=i;this.userDataProfileImportExportService=r;this.dialogService=s;this.telemetryService=a;this.hostService=l;this.productService=d;this.openerService=c;this.instantiationService=u;for(let p of n.profiles)p.isTransient||this._profiles.push(this.createProfileElement(p));this._register(le(()=>this._profiles.splice(0,this._profiles.length).map(([,p])=>p.dispose()))),this._register(n.onDidChangeProfiles(p=>this.onDidChangeProfiles(p)))}static INSTANCE;static getInstance(t){return Ql.INSTANCE||(Ql.INSTANCE=t.createInstance(Ql)),Ql.INSTANCE}_profiles=[];get profiles(){return this._profiles.map(([t])=>t).sort((t,n)=>t instanceof _p?1:n instanceof _p||t instanceof Ac&&t.profile.isDefault?-1:n instanceof Ac&&n.profile.isDefault?1:t.name.localeCompare(n.name))}newProfileElement;_onDidChange=this._register(new D);onDidChange=this._onDidChange.event;templates;onDidChangeProfiles(t){let n=!1;for(let i of t.added)!i.isTransient&&i.name!==this.newProfileElement?.name&&(n=!0,this._profiles.push(this.createProfileElement(i)));for(let i of t.removed){i.id===this.newProfileElement?.previewProfile?.id&&(this.newProfileElement.previewProfile=void 0);let r=this._profiles.findIndex(([s])=>s instanceof Ac&&s.profile.id===i.id);r!==-1&&(n=!0,this._profiles.splice(r,1).map(([,s])=>s.dispose()))}n&&this._onDidChange.fire(void 0)}getTemplates(){return this.templates||(this.templates=this.userDataProfileManagementService.getBuiltinProfileTemplates()),this.templates}createProfileElement(t){let n=new ee,i=n.add(new Ht("userDataProfile.activate",m("active","Use this Profile for Current Window"),we.asClassName(te.check),!0,()=>this.userDataProfileManagementService.switchProfile(u.profile))),r=n.add(new Ht("userDataProfile.copyFromProfile",m("copyFromProfile","Duplicate..."),we.asClassName(te.copy),!0,()=>this.createNewProfile(u.profile))),s=n.add(new Ht("userDataProfile.export",m("export","Export..."),we.asClassName(te.export),!0,()=>this.userDataProfileImportExportService.exportProfile(t))),a=n.add(new Ht("userDataProfile.delete",m("delete","Delete"),we.asClassName(te.trash),!0,()=>this.removeProfile(u.profile))),l=n.add(new Ht("userDataProfile.newWindow",m("open new window","Open New Window with this Profile"),we.asClassName(te.emptyWindow),!0,()=>this.openWindow(u.profile))),d=[];d.push(i),d.push(l);let c=[];c.push(r),c.push(s),t.isDefault||(c.push(new Zn),c.push(a));let u=n.add(this.instantiationService.createInstance(Ac,t,[[],[]],[d,c]));return i.enabled=this.userDataProfileService.currentProfile.id!==u.profile.id,n.add(this.userDataProfileService.onDidChangeCurrentProfile(()=>i.enabled=this.userDataProfileService.currentProfile.id!==u.profile.id)),[u,n]}async createNewProfile(t){if(this.newProfileElement){if(!(await this.dialogService.confirm({type:"info",message:m("new profile exists","A new profile is already being created. Do you want to discard it and create a new one?"),primaryButton:m("discard","Discard & Create"),cancelButton:m("cancel","Cancel")})).confirmed)return;this.revert()}if(t instanceof J)try{await this.userDataProfileImportExportService.resolveProfileTemplate(t)}catch(n){this.dialogService.error(xD(n));return}if(!this.newProfileElement){let n=new ee,i=new zn;n.add(le(()=>i.dispose(!0)));let r=[],s=[],a=n.add(new Ht("userDataProfile.create",m("create","Create"),void 0,!0,()=>this.saveNewProfile(!1,i.token)));r.push(a),Hn&&t instanceof J&&MB(t)&&r.push(new Ht("userDataProfile.createInDesktop",m("import in desktop","Create in {0}",this.productService.nameLong),void 0,!0,()=>this.openerService.open(t,{openExternal:!0})));let l=n.add(new Ht("userDataProfile.cancel",m("cancel","Cancel"),we.asClassName(te.trash),!0,()=>this.discardNewProfile()));s.push(l);let d=n.add(new Ht("userDataProfile.preview",m("preview","Preview"),we.asClassName(te.openPreview),!0,()=>this.previewNewProfile(i.token)));Hn||s.push(d);let c=n.add(new Ht("userDataProfile.export",m("export","Export..."),we.asClassName(te.export),ba(t),()=>this.exportNewProfile(i.token)));this.newProfileElement=n.add(this.instantiationService.createInstance(_p,t?"":m("untitled","Untitled"),t,[r,s],[[l],[c]]));let u=()=>{a.enabled&&(this.newProfileElement?.copyFrom&&this.userDataProfilesService.profiles.some(p=>p.name===this.newProfileElement?.name)?a.label=m("replace","Replace"):a.label=m("create","Create"))};u(),n.add(this.newProfileElement.onDidChange(p=>{p.preview&&(d.checked=!!this.newProfileElement?.previewProfile),(p.disabled||p.message)&&(d.enabled=a.enabled=!this.newProfileElement?.disabled&&!this.newProfileElement?.message),(p.name||p.copyFrom)&&(u(),c.enabled=ba(this.newProfileElement?.copyFrom))})),n.add(this.userDataProfilesService.onDidChangeProfiles(p=>{u(),this.newProfileElement?.validate()})),this._profiles.push([this.newProfileElement,n]),this._onDidChange.fire(this.newProfileElement)}return this.newProfileElement}revert(){this.removeNewProfile(),this._onDidChange.fire(void 0)}removeNewProfile(){if(this.newProfileElement){let t=this._profiles.findIndex(([n])=>n===this.newProfileElement);t!==-1&&this._profiles.splice(t,1).map(([,n])=>n.dispose()),this.newProfileElement=void 0}}async previewNewProfile(t){if(!this.newProfileElement||this.newProfileElement.previewProfile)return;let n=await this.saveNewProfile(!0,t);n&&(this.newProfileElement.previewProfile=n,await this.openWindow(n))}async exportNewProfile(t){if(!this.newProfileElement||!ba(this.newProfileElement.copyFrom))return;let n=ou(Mr(),this.newProfileElement.name,this.newProfileElement.copyFrom.location,this.newProfileElement.copyFrom.cacheHome,{icon:this.newProfileElement.icon,useDefaultFlags:this.newProfileElement.flags},this.userDataProfilesService.defaultProfile);await this.userDataProfileImportExportService.exportProfile(n,this.newProfileElement.copyFlags)}async saveNewProfile(t,n){if(!this.newProfileElement||(this.newProfileElement.validate(),this.newProfileElement.message))return;this.newProfileElement.disabled=!0;let i;try{if(this.newProfileElement.previewProfile)t||(i=await this.userDataProfileManagementService.updateProfile(this.newProfileElement.previewProfile,{transient:!1}));else{let{flags:r,icon:s,name:a,copyFrom:l}=this.newProfileElement,d=r?r.settings&&r.keybindings&&r.tasks&&r.globalState&&r.extensions?void 0:r:void 0,c={source:l instanceof J?"template":ba(l)?"profile":l?"external":void 0};if(l instanceof J){let u=await this.newProfileElement.resolveTemplate(l);u&&(this.telemetryService.publicLog2("userDataProfile.createFromTemplate",c),i=await this.userDataProfileImportExportService.createProfileFromTemplate(u,{name:a,useDefaultFlags:d,icon:s,resourceTypeFlags:this.newProfileElement.copyFlags,transient:t},n??sn.None))}else ba(l)?(this.telemetryService.publicLog2("userDataProfile.createFromProfile",c),i=await this.userDataProfileImportExportService.createFromProfile(l,{name:a,useDefaultFlags:d,icon:s,resourceTypeFlags:this.newProfileElement.copyFlags,transient:t},n??sn.None)):(this.telemetryService.publicLog2("userDataProfile.createEmptyProfile",c),i=await this.userDataProfileManagementService.createProfile(a,{useDefaultFlags:d,icon:s,transient:t}))}}finally{this.newProfileElement&&(this.newProfileElement.disabled=!1)}if(n?.isCancellationRequested){if(i)try{await this.userDataProfileManagementService.removeProfile(i)}catch{}return}if(i&&!i.isTransient&&this.newProfileElement){this.removeNewProfile();let r=this._profiles.find(([s])=>s.name===i.name);r?this._onDidChange.fire(r[0]):this.onDidChangeProfiles({added:[i],removed:[],updated:[],all:this.userDataProfilesService.profiles})}return i}async discardNewProfile(){this.newProfileElement&&(this.newProfileElement.previewProfile&&await this.userDataProfileManagementService.removeProfile(this.newProfileElement.previewProfile),this.removeNewProfile(),this._onDidChange.fire(void 0))}async removeProfile(t){(await this.dialogService.confirm({type:"info",message:m("deleteProfile","Are you sure you want to delete the profile '{0}'?",t.name),primaryButton:m("delete","Delete"),cancelButton:m("cancel","Cancel")})).confirmed&&await this.userDataProfileManagementService.removeProfile(t)}async openWindow(t){await this.hostService.openWindow({forceProfile:t.name})}};Ql=O([x(0,Or),x(1,su),x(2,cb),x(3,C0),x(4,$u),x(5,Xn),x(6,bc),x(7,Ch),x(8,rv),x(9,Oe)],Ql);export{Vg as AbstractUserDataProfileElement,_p as NewProfileElement,Ac as UserDataProfileElement,Ql as UserDataProfilesEditorModel,ZRn as isProfileResourceChildElement,YRn as isProfileResourceTypeElement};
