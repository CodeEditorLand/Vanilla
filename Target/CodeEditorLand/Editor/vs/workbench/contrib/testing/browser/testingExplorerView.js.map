{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/testing/browser/testingExplorerView.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as dom from \"../../../../base/browser/dom.js\";\nimport type { IKeyboardEvent } from \"../../../../base/browser/keyboardEvent.js\";\nimport type { IActionViewItemOptions } from \"../../../../base/browser/ui/actionbar/actionViewItems.js\";\nimport {\n\tActionBar,\n\ttype IActionViewItem,\n} from \"../../../../base/browser/ui/actionbar/actionbar.js\";\nimport { Button } from \"../../../../base/browser/ui/button/button.js\";\nimport type { IManagedHover } from \"../../../../base/browser/ui/hover/hover.js\";\nimport { getDefaultHoverDelegate } from \"../../../../base/browser/ui/hover/hoverDelegateFactory.js\";\nimport { renderLabelWithIcons } from \"../../../../base/browser/ui/iconLabel/iconLabels.js\";\nimport type {\n\tIIdentityProvider,\n\tIKeyboardNavigationLabelProvider,\n\tIListVirtualDelegate,\n} from \"../../../../base/browser/ui/list/list.js\";\nimport {\n\tDefaultKeyboardNavigationDelegate,\n\ttype IListAccessibilityProvider,\n} from \"../../../../base/browser/ui/list/listWidget.js\";\nimport {\n\ttype ITreeContextMenuEvent,\n\ttype ITreeFilter,\n\ttype ITreeNode,\n\ttype ITreeRenderer,\n\ttype ITreeSorter,\n\ttype TreeFilterResult,\n\tTreeVisibility,\n} from \"../../../../base/browser/ui/tree/tree.js\";\nimport {\n\tAction,\n\tActionRunner,\n\ttype IAction,\n\tSeparator,\n} from \"../../../../base/common/actions.js\";\nimport { mapFindFirst } from \"../../../../base/common/arraysFind.js\";\nimport {\n\tRunOnceScheduler,\n\tdisposableTimeout,\n} from \"../../../../base/common/async.js\";\nimport { Color, RGBA } from \"../../../../base/common/color.js\";\nimport { Emitter, Event } from \"../../../../base/common/event.js\";\nimport type { FuzzyScore } from \"../../../../base/common/filters.js\";\nimport { KeyCode } from \"../../../../base/common/keyCodes.js\";\nimport {\n\tDisposable,\n\tDisposableStore,\n\tMutableDisposable,\n} from \"../../../../base/common/lifecycle.js\";\nimport {\n\tautorun,\n\tobservableFromEvent,\n} from \"../../../../base/common/observable.js\";\nimport { fuzzyContains } from \"../../../../base/common/strings.js\";\nimport { ThemeIcon } from \"../../../../base/common/themables.js\";\nimport { isDefined } from \"../../../../base/common/types.js\";\nimport type { URI } from \"../../../../base/common/uri.js\";\nimport \"./media/testing.css\";\nimport { MarkdownRenderer } from \"../../../../editor/browser/widget/markdownRenderer/browser/markdownRenderer.js\";\nimport { localize } from \"../../../../nls.js\";\nimport { DropdownWithPrimaryActionViewItem } from \"../../../../platform/actions/browser/dropdownWithPrimaryActionViewItem.js\";\nimport {\n\tMenuEntryActionViewItem,\n\tcreateActionViewItem,\n\tcreateAndFillInActionBarActions,\n\tcreateAndFillInContextMenuActions,\n} from \"../../../../platform/actions/browser/menuEntryActionViewItem.js\";\nimport {\n\tIMenuService,\n\tMenuId,\n\tMenuItemAction,\n} from \"../../../../platform/actions/common/actions.js\";\nimport { ICommandService } from \"../../../../platform/commands/common/commands.js\";\nimport { IConfigurationService } from \"../../../../platform/configuration/common/configuration.js\";\nimport { IContextKeyService } from \"../../../../platform/contextkey/common/contextkey.js\";\nimport { IContextMenuService } from \"../../../../platform/contextview/browser/contextView.js\";\nimport { IHoverService } from \"../../../../platform/hover/browser/hover.js\";\nimport { IInstantiationService } from \"../../../../platform/instantiation/common/instantiation.js\";\nimport { IKeybindingService } from \"../../../../platform/keybinding/common/keybinding.js\";\nimport { IOpenerService } from \"../../../../platform/opener/common/opener.js\";\nimport { UnmanagedProgress } from \"../../../../platform/progress/common/progress.js\";\nimport {\n\tIStorageService,\n\tStorageScope,\n\tStorageTarget,\n\tWillSaveStateReason,\n} from \"../../../../platform/storage/common/storage.js\";\nimport { ITelemetryService } from \"../../../../platform/telemetry/common/telemetry.js\";\nimport { defaultButtonStyles } from \"../../../../platform/theme/browser/defaultStyles.js\";\nimport { foreground } from \"../../../../platform/theme/common/colorRegistry.js\";\nimport { spinningLoading } from \"../../../../platform/theme/common/iconRegistry.js\";\nimport {\n\tIThemeService,\n\tregisterThemingParticipant,\n} from \"../../../../platform/theme/common/themeService.js\";\nimport { IUriIdentityService } from \"../../../../platform/uriIdentity/common/uriIdentity.js\";\nimport { registerNavigableContainer } from \"../../../browser/actions/widgetNavigationCommands.js\";\nimport { ViewPane } from \"../../../browser/parts/views/viewPane.js\";\nimport type { IViewletViewOptions } from \"../../../browser/parts/views/viewsViewlet.js\";\nimport { DiffEditorInput } from \"../../../common/editor/diffEditorInput.js\";\nimport { IViewDescriptorService } from \"../../../common/views.js\";\nimport {\n\tIActivityService,\n\tIconBadge,\n\tNumberBadge,\n} from \"../../../services/activity/common/activity.js\";\nimport { IEditorGroupsService } from \"../../../services/editor/common/editorGroupsService.js\";\nimport { IEditorService } from \"../../../services/editor/common/editorService.js\";\nimport {\n\tTestingConfigKeys,\n\tTestingCountBadge,\n\tgetTestingConfiguration,\n} from \"../common/configuration.js\";\nimport {\n\tTestCommandId,\n\tTestExplorerViewMode,\n\tTestExplorerViewSorting,\n\tTesting,\n\tlabelForTestInState,\n} from \"../common/constants.js\";\nimport { StoredValue } from \"../common/storedValue.js\";\nimport {\n\tITestExplorerFilterState,\n\ttype TestExplorerFilterState,\n\tTestFilterTerm,\n} from \"../common/testExplorerFilterState.js\";\nimport { TestId } from \"../common/testId.js\";\nimport {\n\tITestProfileService,\n\tcanUseProfileWithTest,\n} from \"../common/testProfileService.js\";\nimport {\n\tLiveTestResult,\n\tTestResultItemChangeReason,\n} from \"../common/testResult.js\";\nimport { ITestResultService } from \"../common/testResultService.js\";\nimport {\n\ttype IMainThreadTestCollection,\n\tITestService,\n\ttestCollectionIsEmpty,\n} from \"../common/testService.js\";\nimport {\n\ttype ITestRunProfile,\n\ttype InternalTestItem,\n\tTestControllerCapability,\n\tTestItemExpandState,\n\tTestResultState,\n\tTestRunProfileBitset,\n} from \"../common/testTypes.js\";\nimport { TestingContextKeys } from \"../common/testingContextKeys.js\";\nimport { ITestingContinuousRunService } from \"../common/testingContinuousRunService.js\";\nimport { ITestingPeekOpener } from \"../common/testingPeekOpener.js\";\nimport {\n\tcmpPriority,\n\tisFailedState,\n\tisStateWithResult,\n\tstatesInOrder,\n} from \"../common/testingStates.js\";\nimport {\n\ttype ITestTreeProjection,\n\ttype TestExplorerTreeElement,\n\tTestItemTreeElement,\n\tTestTreeErrorMessage,\n} from \"./explorerProjections/index.js\";\nimport { ListProjection } from \"./explorerProjections/listProjection.js\";\nimport { getTestItemContextOverlay } from \"./explorerProjections/testItemContextOverlay.js\";\nimport { TestingObjectTree } from \"./explorerProjections/testingObjectTree.js\";\nimport type { ISerializedTestTreeCollapseState } from \"./explorerProjections/testingViewState.js\";\nimport { TreeProjection } from \"./explorerProjections/treeProjection.js\";\nimport * as icons from \"./icons.js\";\nimport { DebugLastRun, ReRunLastRun } from \"./testExplorerActions.js\";\nimport { TestingExplorerFilter } from \"./testingExplorerFilter.js\";\nimport {\n\ttype CountSummary,\n\tcollectTestStateCounts,\n\tgetTestProgressText,\n} from \"./testingProgressUiService.js\";\n\nenum LastFocusState {\n\tInput = 0,\n\tTree = 1,\n}\n\nexport class TestingExplorerView extends ViewPane {\n\tpublic viewModel!: TestingExplorerViewModel;\n\tprivate readonly filterActionBar = this._register(new MutableDisposable());\n\tprivate container!: HTMLElement;\n\tprivate treeHeader!: HTMLElement;\n\tprivate readonly discoveryProgress = this._register(\n\t\tnew MutableDisposable<UnmanagedProgress>(),\n\t);\n\tprivate readonly filter = this._register(\n\t\tnew MutableDisposable<TestingExplorerFilter>(),\n\t);\n\tprivate readonly filterFocusListener = this._register(\n\t\tnew MutableDisposable(),\n\t);\n\tprivate readonly dimensions = { width: 0, height: 0 };\n\tprivate lastFocusState = LastFocusState.Input;\n\n\tpublic get focusedTreeElements() {\n\t\treturn this.viewModel.tree.getFocus().filter(isDefined);\n\t}\n\n\tconstructor(\n\t\toptions: IViewletViewOptions,\n\t\t@IContextMenuService contextMenuService: IContextMenuService,\n\t\t@IKeybindingService keybindingService: IKeybindingService,\n\t\t@IConfigurationService configurationService: IConfigurationService,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@IViewDescriptorService viewDescriptorService: IViewDescriptorService,\n\t\t@IContextKeyService contextKeyService: IContextKeyService,\n\t\t@IOpenerService openerService: IOpenerService,\n\t\t@IThemeService themeService: IThemeService,\n\t\t@ITestService private readonly testService: ITestService,\n\t\t@ITelemetryService telemetryService: ITelemetryService,\n\t\t@IHoverService hoverService: IHoverService,\n\t\t@ITestProfileService private readonly testProfileService: ITestProfileService,\n\t\t@ICommandService private readonly commandService: ICommandService,\n\t\t@IMenuService private readonly menuService: IMenuService,\n\t) {\n\t\tsuper(options, keybindingService, contextMenuService, configurationService, contextKeyService, viewDescriptorService, instantiationService, openerService, themeService, telemetryService, hoverService);\n\n\t\tconst relayout = this._register(new RunOnceScheduler(() => this.layoutBody(), 1));\n\t\tthis._register(this.onDidChangeViewWelcomeState(() => {\n\t\t\tif (!this.shouldShowWelcome()) {\n\t\t\t\trelayout.schedule();\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(testService.collection.onBusyProvidersChange(busy => {\n\t\t\tthis.updateDiscoveryProgress(busy);\n\t\t}));\n\n\t\tthis._register(testProfileService.onDidChange(() => this.updateActions()));\n\t}\n\n\tpublic override shouldShowWelcome() {\n\t\treturn (\n\t\t\tthis.viewModel?.welcomeExperience === WelcomeExperience.ForWorkspace\n\t\t);\n\t}\n\n\tpublic override focus() {\n\t\tsuper.focus();\n\t\tif (this.lastFocusState === LastFocusState.Tree) {\n\t\t\tthis.viewModel.tree.domFocus();\n\t\t} else {\n\t\t\tthis.filter.value?.focus();\n\t\t}\n\t}\n\n\t/**\n\t * Gets include/exclude items in the tree, based either on visible tests\n\t * or a use selection.\n\t */\n\tpublic getTreeIncludeExclude(\n\t\twithinItems?: InternalTestItem[],\n\t\tprofile?: ITestRunProfile,\n\t\tfilterToType: \"visible\" | \"selected\" = \"visible\",\n\t) {\n\t\tconst projection = this.viewModel.projection.value;\n\t\tif (!projection) {\n\t\t\treturn { include: [], exclude: [] };\n\t\t}\n\n\t\t// To calculate includes and excludes, we include the first children that\n\t\t// have a majority of their items included too, and then apply exclusions.\n\t\tconst include = new Set<InternalTestItem>();\n\t\tconst exclude: InternalTestItem[] = [];\n\n\t\tconst attempt = (\n\t\t\telement: TestExplorerTreeElement,\n\t\t\talreadyIncluded: boolean,\n\t\t) => {\n\t\t\t// sanity check hasElement since updates are debounced and they may exist\n\t\t\t// but not be rendered yet\n\t\t\tif (\n\t\t\t\t!(element instanceof TestItemTreeElement) ||\n\t\t\t\t!this.viewModel.tree.hasElement(element)\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// If the current node is not visible or runnable in the current profile, it's excluded\n\t\t\tconst inTree = this.viewModel.tree.getNode(element);\n\t\t\tif (!inTree.visible) {\n\t\t\t\tif (alreadyIncluded) {\n\t\t\t\t\texclude.push(element.test);\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// If it's not already included but most of its children are, then add it\n\t\t\t// if it can be run under the current profile (when specified)\n\t\t\tif (\n\t\t\t\t// If it's not already included...\n\t\t\t\t!alreadyIncluded &&\n\t\t\t\t// And it can be run using the current profile (if any)\n\t\t\t\t(!profile || canUseProfileWithTest(profile, element.test)) &&\n\t\t\t\t// And either it's a leaf node or most children are included, the  include it.\n\t\t\t\t(inTree.children.length === 0 ||\n\t\t\t\t\tinTree.visibleChildrenCount * 2 >=\n\t\t\t\t\t\tinTree.children.length) &&\n\t\t\t\t// And not if we're only showing a single of its children, since it\n\t\t\t\t// probably fans out later. (Worse case we'll directly include its single child)\n\t\t\t\tinTree.visibleChildrenCount !== 1\n\t\t\t) {\n\t\t\t\tinclude.add(element.test);\n\t\t\t\talreadyIncluded = true;\n\t\t\t}\n\n\t\t\t// Recurse \u2728\n\t\t\tfor (const child of element.children) {\n\t\t\t\tattempt(child, alreadyIncluded);\n\t\t\t}\n\t\t};\n\n\t\tif (filterToType === \"selected\") {\n\t\t\tconst sel = this.viewModel.tree.getSelection().filter(isDefined);\n\t\t\tif (sel.length) {\n\t\t\t\tL: for (const node of sel) {\n\t\t\t\t\tif (node instanceof TestItemTreeElement) {\n\t\t\t\t\t\t// avoid adding an item if its parent is already included\n\t\t\t\t\t\tfor (\n\t\t\t\t\t\t\tlet i: TestItemTreeElement | null = node;\n\t\t\t\t\t\t\ti;\n\t\t\t\t\t\t\ti = i.parent\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tif (include.has(i.test)) {\n\t\t\t\t\t\t\t\tcontinue L;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tinclude.add(node.test);\n\t\t\t\t\t\tnode.children.forEach((c) => attempt(c, true));\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn { include: [...include], exclude };\n\t\t\t}\n\t\t}\n\n\t\tfor (const root of withinItems ||\n\t\t\tthis.testService.collection.rootItems) {\n\t\t\tconst element = projection.getElementByTestId(root.item.extId);\n\t\t\tif (!element) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (profile && !canUseProfileWithTest(profile, root)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// single controllers won't have visible root ID nodes, handle that  case specially\n\t\t\tif (this.viewModel.tree.hasElement(element)) {\n\t\t\t\tattempt(element, false);\n\t\t\t} else {\n\t\t\t\tconst visibleChildren = [...element.children].reduce(\n\t\t\t\t\t(acc, c) =>\n\t\t\t\t\t\tthis.viewModel.tree.hasElement(c) &&\n\t\t\t\t\t\tthis.viewModel.tree.getNode(c).visible\n\t\t\t\t\t\t\t? acc + 1\n\t\t\t\t\t\t\t: acc,\n\t\t\t\t\t0,\n\t\t\t\t);\n\n\t\t\t\t// note we intentionally check children > 0 here, unlike above, since\n\t\t\t\t// we don't want to bother dispatching to controllers who have no discovered tests\n\t\t\t\tif (\n\t\t\t\t\telement.children.size > 0 &&\n\t\t\t\t\tvisibleChildren * 2 >= element.children.size\n\t\t\t\t) {\n\t\t\t\t\tinclude.add(element.test);\n\t\t\t\t\telement.children.forEach((c) => attempt(c, true));\n\t\t\t\t} else {\n\t\t\t\t\telement.children.forEach((c) => attempt(c, false));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn { include: [...include], exclude };\n\t}\n\n\toverride render(): void {\n\t\tsuper.render();\n\t\tthis._register(\n\t\t\tregisterNavigableContainer({\n\t\t\t\tname: \"testingExplorerView\",\n\t\t\t\tfocusNotifiers: [this],\n\t\t\t\tfocusNextWidget: () => {\n\t\t\t\t\tif (!this.viewModel.tree.isDOMFocused()) {\n\t\t\t\t\t\tthis.viewModel.tree.domFocus();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tfocusPreviousWidget: () => {\n\t\t\t\t\tif (this.viewModel.tree.isDOMFocused()) {\n\t\t\t\t\t\tthis.filter.value?.focus();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t}),\n\t\t);\n\t}\n\n\t/**\n\t * @override\n\t */\n\tprotected override renderBody(container: HTMLElement): void {\n\t\tsuper.renderBody(container);\n\n\t\tthis.container = dom.append(container, dom.$(\".test-explorer\"));\n\t\tthis.treeHeader = dom.append(\n\t\t\tthis.container,\n\t\t\tdom.$(\".test-explorer-header\"),\n\t\t);\n\t\tthis.filterActionBar.value = this.createFilterActionBar();\n\n\t\tconst messagesContainer = dom.append(\n\t\t\tthis.treeHeader,\n\t\t\tdom.$(\".result-summary-container\"),\n\t\t);\n\t\tthis._register(\n\t\t\tthis.instantiationService.createInstance(\n\t\t\t\tResultSummaryView,\n\t\t\t\tmessagesContainer,\n\t\t\t),\n\t\t);\n\n\t\tconst listContainer = dom.append(\n\t\t\tthis.container,\n\t\t\tdom.$(\".test-explorer-tree\"),\n\t\t);\n\t\tthis.viewModel = this.instantiationService.createInstance(\n\t\t\tTestingExplorerViewModel,\n\t\t\tlistContainer,\n\t\t\tthis.onDidChangeBodyVisibility,\n\t\t);\n\t\tthis._register(\n\t\t\tthis.viewModel.tree.onDidFocus(\n\t\t\t\t() => (this.lastFocusState = LastFocusState.Tree),\n\t\t\t),\n\t\t);\n\t\tthis._register(\n\t\t\tthis.viewModel.onChangeWelcomeVisibility(() =>\n\t\t\t\tthis._onDidChangeViewWelcomeState.fire(),\n\t\t\t),\n\t\t);\n\t\tthis._register(this.viewModel);\n\t\tthis._onDidChangeViewWelcomeState.fire();\n\t}\n\n\t/** @override  */\n\tpublic override getActionViewItem(\n\t\taction: IAction,\n\t\toptions: IActionViewItemOptions,\n\t): IActionViewItem | undefined {\n\t\tswitch (action.id) {\n\t\t\tcase TestCommandId.FilterAction:\n\t\t\t\tthis.filter.value = this.instantiationService.createInstance(\n\t\t\t\t\tTestingExplorerFilter,\n\t\t\t\t\taction,\n\t\t\t\t\toptions,\n\t\t\t\t);\n\t\t\t\tthis.filterFocusListener.value = this.filter.value.onDidFocus(\n\t\t\t\t\t() => (this.lastFocusState = LastFocusState.Input),\n\t\t\t\t);\n\t\t\t\treturn this.filter.value;\n\t\t\tcase TestCommandId.RunSelectedAction:\n\t\t\t\treturn this.getRunGroupDropdown(\n\t\t\t\t\tTestRunProfileBitset.Run,\n\t\t\t\t\taction,\n\t\t\t\t\toptions,\n\t\t\t\t);\n\t\t\tcase TestCommandId.DebugSelectedAction:\n\t\t\t\treturn this.getRunGroupDropdown(\n\t\t\t\t\tTestRunProfileBitset.Debug,\n\t\t\t\t\taction,\n\t\t\t\t\toptions,\n\t\t\t\t);\n\t\t\tdefault:\n\t\t\t\treturn super.getActionViewItem(action, options);\n\t\t}\n\t}\n\n\t/** @inheritdoc */\n\tprivate getTestConfigGroupActions(group: TestRunProfileBitset) {\n\t\tconst profileActions: IAction[] = [];\n\n\t\tlet participatingGroups = 0;\n\t\tlet hasConfigurable = false;\n\t\tconst defaults = this.testProfileService.getGroupDefaultProfiles(group);\n\t\tfor (const { profiles, controller } of this.testProfileService.all()) {\n\t\t\tlet hasAdded = false;\n\n\t\t\tfor (const profile of profiles) {\n\t\t\t\tif (profile.group !== group) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (!hasAdded) {\n\t\t\t\t\thasAdded = true;\n\t\t\t\t\tparticipatingGroups++;\n\t\t\t\t\tprofileActions.push(\n\t\t\t\t\t\tnew Action(\n\t\t\t\t\t\t\t`${controller.id}.$root`,\n\t\t\t\t\t\t\tcontroller.label.get(),\n\t\t\t\t\t\t\tundefined,\n\t\t\t\t\t\t\tfalse,\n\t\t\t\t\t\t),\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\thasConfigurable =\n\t\t\t\t\thasConfigurable || profile.hasConfigurationHandler;\n\t\t\t\tprofileActions.push(\n\t\t\t\t\tnew Action(\n\t\t\t\t\t\t`${controller.id}.${profile.profileId}`,\n\t\t\t\t\t\tdefaults.includes(profile)\n\t\t\t\t\t\t\t? localize(\n\t\t\t\t\t\t\t\t\t\"defaultTestProfile\",\n\t\t\t\t\t\t\t\t\t\"{0} (Default)\",\n\t\t\t\t\t\t\t\t\tprofile.label,\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t: profile.label,\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\t() => {\n\t\t\t\t\t\t\tconst { include, exclude } =\n\t\t\t\t\t\t\t\tthis.getTreeIncludeExclude(undefined, profile);\n\t\t\t\t\t\t\tthis.testService.runResolvedTests({\n\t\t\t\t\t\t\t\texclude: exclude.map((e) => e.item.extId),\n\t\t\t\t\t\t\t\tgroup: profile.group,\n\t\t\t\t\t\t\t\ttargets: [\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tprofileId: profile.profileId,\n\t\t\t\t\t\t\t\t\t\tcontrollerId: profile.controllerId,\n\t\t\t\t\t\t\t\t\t\ttestIds: include.map(\n\t\t\t\t\t\t\t\t\t\t\t(i) => i.item.extId,\n\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t},\n\t\t\t\t\t),\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tconst menuActions: IAction[] = [];\n\t\tconst contextKeys: [string, unknown][] = [];\n\t\t// allow extension author to define context for when to show the test menu actions for run or debug menus\n\t\tif (group === TestRunProfileBitset.Run) {\n\t\t\tcontextKeys.push([\"testing.profile.context.group\", \"run\"]);\n\t\t}\n\t\tif (group === TestRunProfileBitset.Debug) {\n\t\t\tcontextKeys.push([\"testing.profile.context.group\", \"debug\"]);\n\t\t}\n\t\tif (group === TestRunProfileBitset.Coverage) {\n\t\t\tcontextKeys.push([\"testing.profile.context.group\", \"coverage\"]);\n\t\t}\n\t\tconst key = this.contextKeyService.createOverlay(contextKeys);\n\t\tconst menu = this.menuService.getMenuActions(\n\t\t\tMenuId.TestProfilesContext,\n\t\t\tkey,\n\t\t);\n\n\t\t// fill if there are any actions\n\t\tcreateAndFillInContextMenuActions(menu, menuActions);\n\n\t\tconst postActions: IAction[] = [];\n\t\tif (profileActions.length > 1) {\n\t\t\tpostActions.push(\n\t\t\t\tnew Action(\n\t\t\t\t\t\"selectDefaultTestConfigurations\",\n\t\t\t\t\tlocalize(\"selectDefaultConfigs\", \"Select Default Profile\"),\n\t\t\t\t\tundefined,\n\t\t\t\t\tundefined,\n\t\t\t\t\t() =>\n\t\t\t\t\t\tthis.commandService.executeCommand<ITestRunProfile>(\n\t\t\t\t\t\t\tTestCommandId.SelectDefaultTestProfiles,\n\t\t\t\t\t\t\tgroup,\n\t\t\t\t\t\t),\n\t\t\t\t),\n\t\t\t);\n\t\t}\n\n\t\tif (hasConfigurable) {\n\t\t\tpostActions.push(\n\t\t\t\tnew Action(\n\t\t\t\t\t\"configureTestProfiles\",\n\t\t\t\t\tlocalize(\n\t\t\t\t\t\t\"configureTestProfiles\",\n\t\t\t\t\t\t\"Configure Test Profiles\",\n\t\t\t\t\t),\n\t\t\t\t\tundefined,\n\t\t\t\t\tundefined,\n\t\t\t\t\t() =>\n\t\t\t\t\t\tthis.commandService.executeCommand<ITestRunProfile>(\n\t\t\t\t\t\t\tTestCommandId.ConfigureTestProfilesAction,\n\t\t\t\t\t\t\tgroup,\n\t\t\t\t\t\t),\n\t\t\t\t),\n\t\t\t);\n\t\t}\n\n\t\t// show menu actions if there are any otherwise don't\n\t\treturn menuActions.length > 0\n\t\t\t? Separator.join(profileActions, menuActions, postActions)\n\t\t\t: Separator.join(profileActions, postActions);\n\t}\n\n\t/**\n\t * @override\n\t */\n\tpublic override saveState() {\n\t\tthis.filter.value?.saveState();\n\t\tsuper.saveState();\n\t}\n\n\tprivate getRunGroupDropdown(\n\t\tgroup: TestRunProfileBitset,\n\t\tdefaultAction: IAction,\n\t\toptions: IActionViewItemOptions,\n\t) {\n\t\tconst dropdownActions = this.getTestConfigGroupActions(group);\n\t\tif (dropdownActions.length < 2) {\n\t\t\treturn super.getActionViewItem(defaultAction, options);\n\t\t}\n\n\t\tconst primaryAction = this.instantiationService.createInstance(\n\t\t\tMenuItemAction,\n\t\t\t{\n\t\t\t\tid: defaultAction.id,\n\t\t\t\ttitle: defaultAction.label,\n\t\t\t\ticon:\n\t\t\t\t\tgroup === TestRunProfileBitset.Run\n\t\t\t\t\t\t? icons.testingRunAllIcon\n\t\t\t\t\t\t: icons.testingDebugAllIcon,\n\t\t\t},\n\t\t\tundefined,\n\t\t\tundefined,\n\t\t\tundefined,\n\t\t\tundefined,\n\t\t);\n\n\t\tconst dropdownAction = new Action(\n\t\t\t\"selectRunConfig\",\n\t\t\t\"Select Configuration...\",\n\t\t\t\"codicon-chevron-down\",\n\t\t\ttrue,\n\t\t);\n\n\t\treturn this.instantiationService.createInstance(\n\t\t\tDropdownWithPrimaryActionViewItem,\n\t\t\tprimaryAction,\n\t\t\tdropdownAction,\n\t\t\tdropdownActions,\n\t\t\t\"\",\n\t\t\tthis.contextMenuService,\n\t\t\toptions,\n\t\t);\n\t}\n\n\tprivate createFilterActionBar() {\n\t\tconst bar = new ActionBar(this.treeHeader, {\n\t\t\tactionViewItemProvider: (action, options) =>\n\t\t\t\tthis.getActionViewItem(action, options),\n\t\t\ttriggerKeys: { keyDown: false, keys: [] },\n\t\t});\n\t\tbar.push(new Action(TestCommandId.FilterAction));\n\t\tbar.getContainer().classList.add(\"testing-filter-action-bar\");\n\t\treturn bar;\n\t}\n\n\tprivate updateDiscoveryProgress(busy: number) {\n\t\tif (!busy && this.discoveryProgress) {\n\t\t\tthis.discoveryProgress.clear();\n\t\t} else if (busy && !this.discoveryProgress.value) {\n\t\t\tthis.discoveryProgress.value =\n\t\t\t\tthis.instantiationService.createInstance(UnmanagedProgress, {\n\t\t\t\t\tlocation: this.getProgressLocation(),\n\t\t\t\t});\n\t\t}\n\t}\n\n\t/**\n\t * @override\n\t */\n\tprotected override layoutBody(\n\t\theight = this.dimensions.height,\n\t\twidth = this.dimensions.width,\n\t): void {\n\t\tsuper.layoutBody(height, width);\n\t\tthis.dimensions.height = height;\n\t\tthis.dimensions.width = width;\n\t\tthis.container.style.height = `${height}px`;\n\t\tthis.viewModel?.layout(height - this.treeHeader.clientHeight, width);\n\t\tthis.filter.value?.layout(width);\n\t}\n}\n\nconst SUMMARY_RENDER_INTERVAL = 200;\n\nclass ResultSummaryView extends Disposable {\n\tprivate elementsWereAttached = false;\n\tprivate badgeType: TestingCountBadge;\n\tprivate lastBadge?: NumberBadge | IconBadge;\n\tprivate countHover: IManagedHover;\n\tprivate readonly badgeDisposable = this._register(new MutableDisposable());\n\tprivate readonly renderLoop = this._register(\n\t\tnew RunOnceScheduler(() => this.render(), SUMMARY_RENDER_INTERVAL),\n\t);\n\tprivate readonly elements = dom.h(\"div.result-summary\", [\n\t\tdom.h(\"div@status\"),\n\t\tdom.h(\"div@count\"),\n\t\tdom.h(\"div@count\"),\n\t\tdom.h(\"span\"),\n\t\tdom.h(\"duration@duration\"),\n\t\tdom.h(\"a@rerun\"),\n\t]);\n\n\tconstructor(\n\t\tprivate readonly container: HTMLElement,\n\t\t@ITestResultService private readonly resultService: ITestResultService,\n\t\t@IActivityService private readonly activityService: IActivityService,\n\t\t@ITestingContinuousRunService private readonly crService: ITestingContinuousRunService,\n\t\t@IConfigurationService configurationService: IConfigurationService,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@IHoverService hoverService: IHoverService,\n\t) {\n\t\tsuper();\n\n\t\tthis.badgeType = configurationService.getValue<TestingCountBadge>(TestingConfigKeys.CountBadge);\n\t\tthis._register(resultService.onResultsChanged(this.render, this));\n\t\tthis._register(configurationService.onDidChangeConfiguration(e => {\n\t\t\tif (e.affectsConfiguration(TestingConfigKeys.CountBadge)) {\n\t\t\t\tthis.badgeType = configurationService.getValue(TestingConfigKeys.CountBadge);\n\t\t\t\tthis.render();\n\t\t\t}\n\t\t}));\n\n\t\tthis.countHover = this._register(hoverService.setupManagedHover(getDefaultHoverDelegate('mouse'), this.elements.count, ''));\n\n\t\tconst ab = this._register(new ActionBar(this.elements.rerun, {\n\t\t\tactionViewItemProvider: (action, options) => createActionViewItem(instantiationService, action, options),\n\t\t}));\n\t\tab.push(instantiationService.createInstance(MenuItemAction,\n\t\t\t{ ...new ReRunLastRun().desc, icon: icons.testingRerunIcon },\n\t\t\t{ ...new DebugLastRun().desc, icon: icons.testingDebugIcon },\n\t\t\t{},\n\t\t\tundefined, undefined\n\t\t), { icon: true, label: false });\n\n\t\tthis.render();\n\t}\n\n\tprivate render() {\n\t\tconst { results } = this.resultService;\n\t\tconst { count, root, status, duration, rerun } = this.elements;\n\t\tif (!results.length) {\n\t\t\tif (this.elementsWereAttached) {\n\t\t\t\troot.remove();\n\t\t\t\tthis.elementsWereAttached = false;\n\t\t\t}\n\t\t\tthis.container.innerText = localize(\n\t\t\t\t\"noResults\",\n\t\t\t\t\"No test results yet.\",\n\t\t\t);\n\t\t\tthis.badgeDisposable.clear();\n\t\t\treturn;\n\t\t}\n\n\t\tconst live = results.filter((r) => !r.completedAt) as LiveTestResult[];\n\t\tlet counts: CountSummary;\n\t\tif (live.length) {\n\t\t\tstatus.className = ThemeIcon.asClassName(spinningLoading);\n\t\t\tcounts = collectTestStateCounts(true, live);\n\t\t\tthis.renderLoop.schedule();\n\n\t\t\tconst last = live[live.length - 1];\n\t\t\tduration.textContent = formatDuration(Date.now() - last.startedAt);\n\t\t\trerun.style.display = \"none\";\n\t\t} else {\n\t\t\tconst last = results[0];\n\t\t\tconst dominantState = mapFindFirst(statesInOrder, (s) =>\n\t\t\t\tlast.counts[s] > 0 ? s : undefined,\n\t\t\t);\n\t\t\tstatus.className = ThemeIcon.asClassName(\n\t\t\t\ticons.testingStatesToIcons.get(\n\t\t\t\t\tdominantState ?? TestResultState.Unset,\n\t\t\t\t)!,\n\t\t\t);\n\t\t\tcounts = collectTestStateCounts(false, [last]);\n\t\t\tduration.textContent =\n\t\t\t\tlast instanceof LiveTestResult\n\t\t\t\t\t? formatDuration(last.completedAt! - last.startedAt)\n\t\t\t\t\t: \"\";\n\t\t\trerun.style.display = \"block\";\n\t\t}\n\n\t\tcount.textContent = `${counts.passed}/${counts.totalWillBeRun}`;\n\t\tthis.countHover.update(getTestProgressText(counts));\n\t\tthis.renderActivityBadge(counts);\n\n\t\tif (!this.elementsWereAttached) {\n\t\t\tdom.clearNode(this.container);\n\t\t\tthis.container.appendChild(root);\n\t\t\tthis.elementsWereAttached = true;\n\t\t}\n\t}\n\n\tprivate renderActivityBadge(countSummary: CountSummary) {\n\t\tif (\n\t\t\tcountSummary &&\n\t\t\tthis.badgeType !== TestingCountBadge.Off &&\n\t\t\tcountSummary[this.badgeType] !== 0\n\t\t) {\n\t\t\tif (\n\t\t\t\tthis.lastBadge instanceof NumberBadge &&\n\t\t\t\tthis.lastBadge.number === countSummary[this.badgeType]\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.lastBadge = new NumberBadge(\n\t\t\t\tcountSummary[this.badgeType],\n\t\t\t\t(num) => this.getLocalizedBadgeString(this.badgeType, num),\n\t\t\t);\n\t\t} else if (this.crService.isEnabled()) {\n\t\t\tif (\n\t\t\t\tthis.lastBadge instanceof IconBadge &&\n\t\t\t\tthis.lastBadge.icon === icons.testingContinuousIsOn\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.lastBadge = new IconBadge(icons.testingContinuousIsOn, () =>\n\t\t\t\tlocalize(\n\t\t\t\t\t\"testingContinuousBadge\",\n\t\t\t\t\t\"Tests are being watched for changes\",\n\t\t\t\t),\n\t\t\t);\n\t\t} else {\n\t\t\tif (!this.lastBadge) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.lastBadge = undefined;\n\t\t}\n\n\t\tthis.badgeDisposable.value =\n\t\t\tthis.lastBadge &&\n\t\t\tthis.activityService.showViewActivity(Testing.ExplorerViewId, {\n\t\t\t\tbadge: this.lastBadge,\n\t\t\t});\n\t}\n\n\tprivate getLocalizedBadgeString(\n\t\tcountBadgeType: TestingCountBadge,\n\t\tcount: number,\n\t): string {\n\t\tswitch (countBadgeType) {\n\t\t\tcase TestingCountBadge.Passed:\n\t\t\t\treturn localize(\n\t\t\t\t\t\"testingCountBadgePassed\",\n\t\t\t\t\t\"{0} passed tests\",\n\t\t\t\t\tcount,\n\t\t\t\t);\n\t\t\tcase TestingCountBadge.Skipped:\n\t\t\t\treturn localize(\n\t\t\t\t\t\"testingCountBadgeSkipped\",\n\t\t\t\t\t\"{0} skipped tests\",\n\t\t\t\t\tcount,\n\t\t\t\t);\n\t\t\tdefault:\n\t\t\t\treturn localize(\n\t\t\t\t\t\"testingCountBadgeFailed\",\n\t\t\t\t\t\"{0} failed tests\",\n\t\t\t\t\tcount,\n\t\t\t\t);\n\t\t}\n\t}\n}\n\nenum WelcomeExperience {\n\tNone = 0,\n\tForWorkspace = 1,\n\tForDocument = 2,\n}\n\nclass TestingExplorerViewModel extends Disposable {\n\tpublic tree: TestingObjectTree<FuzzyScore>;\n\tprivate filter: TestsFilter;\n\tpublic readonly projection = this._register(\n\t\tnew MutableDisposable<ITestTreeProjection>(),\n\t);\n\n\tprivate readonly revealTimeout = new MutableDisposable();\n\tprivate readonly _viewMode = TestingContextKeys.viewMode.bindTo(\n\t\tthis.contextKeyService,\n\t);\n\tprivate readonly _viewSorting = TestingContextKeys.viewSorting.bindTo(\n\t\tthis.contextKeyService,\n\t);\n\tprivate readonly welcomeVisibilityEmitter =\n\t\tnew Emitter<WelcomeExperience>();\n\tprivate readonly actionRunner = new TestExplorerActionRunner(() =>\n\t\tthis.tree.getSelection().filter(isDefined),\n\t);\n\tprivate readonly lastViewState = this._register(\n\t\tnew StoredValue<ISerializedTestTreeCollapseState>(\n\t\t\t{\n\t\t\t\tkey: \"testing.treeState\",\n\t\t\t\tscope: StorageScope.WORKSPACE,\n\t\t\t\ttarget: StorageTarget.MACHINE,\n\t\t\t},\n\t\t\tthis.storageService,\n\t\t),\n\t);\n\tprivate readonly noTestForDocumentWidget: NoTestsForDocumentWidget;\n\n\t/**\n\t * Whether there's a reveal request which has not yet been delivered. This\n\t * can happen if the user asks to reveal before the test tree is loaded.\n\t * We check to see if the reveal request is present on each tree update,\n\t * and do it then if so.\n\t */\n\tprivate hasPendingReveal = false;\n\t/**\n\t * Fires when the visibility of the placeholder state changes.\n\t */\n\tpublic readonly onChangeWelcomeVisibility =\n\t\tthis.welcomeVisibilityEmitter.event;\n\n\t/**\n\t * Gets whether the welcome should be visible.\n\t */\n\tpublic welcomeExperience = WelcomeExperience.None;\n\n\tpublic get viewMode() {\n\t\treturn this._viewMode.get() ?? TestExplorerViewMode.Tree;\n\t}\n\n\tpublic set viewMode(newMode: TestExplorerViewMode) {\n\t\tif (newMode === this._viewMode.get()) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._viewMode.set(newMode);\n\t\tthis.updatePreferredProjection();\n\t\tthis.storageService.store(\n\t\t\t\"testing.viewMode\",\n\t\t\tnewMode,\n\t\t\tStorageScope.WORKSPACE,\n\t\t\tStorageTarget.MACHINE,\n\t\t);\n\t}\n\n\tpublic get viewSorting() {\n\t\treturn this._viewSorting.get() ?? TestExplorerViewSorting.ByStatus;\n\t}\n\n\tpublic set viewSorting(newSorting: TestExplorerViewSorting) {\n\t\tif (newSorting === this._viewSorting.get()) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._viewSorting.set(newSorting);\n\t\tthis.tree.resort(null);\n\t\tthis.storageService.store(\n\t\t\t\"testing.viewSorting\",\n\t\t\tnewSorting,\n\t\t\tStorageScope.WORKSPACE,\n\t\t\tStorageTarget.MACHINE,\n\t\t);\n\t}\n\n\tconstructor(\n\t\tlistContainer: HTMLElement,\n\t\tonDidChangeVisibility: Event<boolean>,\n\t\t@IConfigurationService configurationService: IConfigurationService,\n\t\t@IEditorService editorService: IEditorService,\n\t\t@IEditorGroupsService editorGroupsService: IEditorGroupsService,\n\t\t@IMenuService private readonly menuService: IMenuService,\n\t\t@IContextMenuService private readonly contextMenuService: IContextMenuService,\n\t\t@ITestService private readonly testService: ITestService,\n\t\t@ITestExplorerFilterState private readonly filterState: TestExplorerFilterState,\n\t\t@IInstantiationService private readonly instantiationService: IInstantiationService,\n\t\t@IStorageService private readonly storageService: IStorageService,\n\t\t@IContextKeyService private readonly contextKeyService: IContextKeyService,\n\t\t@ITestResultService private readonly testResults: ITestResultService,\n\t\t@ITestingPeekOpener private readonly peekOpener: ITestingPeekOpener,\n\t\t@ITestProfileService private readonly testProfileService: ITestProfileService,\n\t\t@ITestingContinuousRunService private readonly crService: ITestingContinuousRunService,\n\t\t@ICommandService commandService: ICommandService,\n\t) {\n\t\tsuper();\n\n\t\tthis.hasPendingReveal = !!filterState.reveal.value;\n\t\tthis.noTestForDocumentWidget = this._register(instantiationService.createInstance(NoTestsForDocumentWidget, listContainer));\n\t\tthis._viewMode.set(this.storageService.get('testing.viewMode', StorageScope.WORKSPACE, TestExplorerViewMode.Tree) as TestExplorerViewMode);\n\t\tthis._viewSorting.set(this.storageService.get('testing.viewSorting', StorageScope.WORKSPACE, TestExplorerViewSorting.ByLocation) as TestExplorerViewSorting);\n\n\t\tthis.reevaluateWelcomeState();\n\t\tthis.filter = this.instantiationService.createInstance(TestsFilter, testService.collection);\n\t\tthis.tree = instantiationService.createInstance(\n\t\t\tTestingObjectTree,\n\t\t\t'Test Explorer List',\n\t\t\tlistContainer,\n\t\t\tnew ListDelegate(),\n\t\t\t[\n\t\t\t\tinstantiationService.createInstance(TestItemRenderer, this.actionRunner),\n\t\t\t\tinstantiationService.createInstance(ErrorRenderer),\n\t\t\t],\n\t\t\t{\n\t\t\t\tidentityProvider: instantiationService.createInstance(IdentityProvider),\n\t\t\t\thideTwistiesOfChildlessElements: false,\n\t\t\t\tsorter: instantiationService.createInstance(TreeSorter, this),\n\t\t\t\tkeyboardNavigationLabelProvider: instantiationService.createInstance(TreeKeyboardNavigationLabelProvider),\n\t\t\t\taccessibilityProvider: instantiationService.createInstance(ListAccessibilityProvider),\n\t\t\t\tfilter: this.filter,\n\t\t\t\tfindWidgetEnabled: false,\n\t\t\t\topenOnSingleClick: false,\n\t\t\t}) as TestingObjectTree<FuzzyScore>;\n\n\n\t\t// saves the collapse state so that if items are removed or refreshed, they\n\t\t// retain the same state (#170169)\n\t\tconst collapseStateSaver = this._register(new RunOnceScheduler(() => {\n\t\t\t// reuse the last view state to avoid making a bunch of object garbage:\n\t\t\tconst state = this.tree.getOptimizedViewState(this.lastViewState.get({}));\n\t\t\tconst projection = this.projection.value;\n\t\t\tif (projection) {\n\t\t\t\tprojection.lastState = state;\n\t\t\t}\n\t\t}, 3000));\n\n\t\tthis._register(this.tree.onDidChangeCollapseState(evt => {\n\t\t\tif (evt.node.element instanceof TestItemTreeElement) {\n\t\t\t\tif (!evt.node.collapsed) {\n\t\t\t\t\tthis.projection.value?.expandElement(evt.node.element, evt.deep ? Number.POSITIVE_INFINITY : 0);\n\t\t\t\t}\n\t\t\t\tcollapseStateSaver.schedule();\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(this.crService.onDidChange(testId => {\n\t\t\tif (testId) {\n\t\t\t\t// a continuous run test will sort to the top:\n\t\t\t\tconst elem = this.projection.value?.getElementByTestId(testId);\n\t\t\t\tthis.tree.resort(elem?.parent && this.tree.hasElement(elem.parent) ? elem.parent : null, false);\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(onDidChangeVisibility(visible => {\n\t\t\tif (visible) {\n\t\t\t\tthis.ensureProjection();\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(this.tree.onContextMenu(e => this.onContextMenu(e)));\n\n\t\tthis._register(Event.any(\n\t\t\tfilterState.text.onDidChange,\n\t\t\tfilterState.fuzzy.onDidChange,\n\t\t\ttestService.excluded.onTestExclusionsChanged,\n\t\t)(this.tree.refilter, this.tree));\n\n\t\tthis._register(this.tree.onDidOpen(e => {\n\t\t\tif (e.element instanceof TestItemTreeElement && !e.element.children.size && e.element.test.item.uri) {\n\t\t\t\tcommandService.executeCommand('vscode.revealTest', e.element.test.item.extId);\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(this.tree);\n\n\t\tthis._register(this.onChangeWelcomeVisibility(e => {\n\t\t\tthis.noTestForDocumentWidget.setVisible(e === WelcomeExperience.ForDocument);\n\t\t}));\n\n\t\tthis._register(dom.addStandardDisposableListener(this.tree.getHTMLElement(), 'keydown', evt => {\n\t\t\tif (evt.equals(KeyCode.Enter)) {\n\t\t\t\tthis.handleExecuteKeypress(evt);\n\t\t\t} else if (DefaultKeyboardNavigationDelegate.mightProducePrintableCharacter(evt)) {\n\t\t\t\tfilterState.text.value = evt.browserEvent.key;\n\t\t\t\tfilterState.focusInput();\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(filterState.reveal.onDidChange(id => this.revealById(id, undefined, false)));\n\n\t\tthis._register(onDidChangeVisibility(visible => {\n\t\t\tif (visible) {\n\t\t\t\tfilterState.focusInput();\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(this.tree.onDidChangeSelection(evt => {\n\t\t\tif (dom.isMouseEvent(evt.browserEvent) && (evt.browserEvent.altKey || evt.browserEvent.shiftKey)) {\n\t\t\t\treturn; // don't focus when alt-clicking to multi select\n\t\t\t}\n\n\t\t\tconst selected = evt.elements[0];\n\t\t\tif (selected && evt.browserEvent && selected instanceof TestItemTreeElement\n\t\t\t\t&& selected.children.size === 0 && selected.test.expand === TestItemExpandState.NotExpandable) {\n\t\t\t\tthis.tryPeekError(selected);\n\t\t\t}\n\t\t}));\n\n\t\tlet followRunningTests = getTestingConfiguration(configurationService, TestingConfigKeys.FollowRunningTest);\n\t\tthis._register(configurationService.onDidChangeConfiguration(e => {\n\t\t\tif (e.affectsConfiguration(TestingConfigKeys.FollowRunningTest)) {\n\t\t\t\tfollowRunningTests = getTestingConfiguration(configurationService, TestingConfigKeys.FollowRunningTest);\n\t\t\t}\n\t\t}));\n\n\t\tlet alwaysRevealTestAfterStateChange = getTestingConfiguration(configurationService, TestingConfigKeys.AlwaysRevealTestOnStateChange);\n\t\tthis._register(configurationService.onDidChangeConfiguration(e => {\n\t\t\tif (e.affectsConfiguration(TestingConfigKeys.AlwaysRevealTestOnStateChange)) {\n\t\t\t\talwaysRevealTestAfterStateChange = getTestingConfiguration(configurationService, TestingConfigKeys.AlwaysRevealTestOnStateChange);\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(testResults.onTestChanged(evt => {\n\t\t\tif (!followRunningTests) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (evt.reason !== TestResultItemChangeReason.OwnStateChange) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.tree.selectionSize > 1) {\n\t\t\t\treturn; // don't change a multi-selection #180950\n\t\t\t}\n\n\t\t\t// follow running tests, or tests whose state changed. Tests that\n\t\t\t// complete very fast may not enter the running state at all.\n\t\t\tif (evt.item.ownComputedState !== TestResultState.Running && !(evt.previousState === TestResultState.Queued && isStateWithResult(evt.item.ownComputedState))) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.revealById(evt.item.item.extId, alwaysRevealTestAfterStateChange, false);\n\t\t}));\n\n\t\tthis._register(testResults.onResultsChanged(() => {\n\t\t\tthis.tree.resort(null);\n\t\t}));\n\n\t\tthis._register(this.testProfileService.onDidChange(() => {\n\t\t\tthis.tree.rerender();\n\t\t}));\n\n\t\tconst allOpenEditorInputs = observableFromEvent(this,\n\t\t\teditorService.onDidEditorsChange,\n\t\t\t() => new Set(editorGroupsService.groups.flatMap(g => g.editors).map(e => e.resource).filter(isDefined)),\n\t\t);\n\n\t\tconst activeResource = observableFromEvent(this, editorService.onDidActiveEditorChange, () => {\n\t\t\tif (editorService.activeEditor instanceof DiffEditorInput) {\n\t\t\t\treturn editorService.activeEditor.primary.resource;\n\t\t\t} else {\n\t\t\t\treturn editorService.activeEditor?.resource;\n\t\t\t}\n\t\t});\n\n\t\tconst filterText = observableFromEvent(this.filterState.text.onDidChange, () => this.filterState.text);\n\t\tthis._register(autorun(reader => {\n\t\t\tfilterText.read(reader);\n\t\t\tif (this.filterState.isFilteringFor(TestFilterTerm.OpenedFiles)) {\n\t\t\t\tthis.filter.filterToDocumentUri([...allOpenEditorInputs.read(reader)]);\n\t\t\t} else {\n\t\t\t\tthis.filter.filterToDocumentUri([activeResource.read(reader)].filter(isDefined));\n\t\t\t}\n\n\t\t\tif (this.filterState.isFilteringFor(TestFilterTerm.CurrentDoc) || this.filterState.isFilteringFor(TestFilterTerm.OpenedFiles)) {\n\t\t\t\tthis.tree.refilter();\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(this.storageService.onWillSaveState(({ reason, }) => {\n\t\t\tif (reason === WillSaveStateReason.SHUTDOWN) {\n\t\t\t\tthis.lastViewState.store(this.tree.getOptimizedViewState());\n\t\t\t}\n\t\t}));\n\t}\n\n\t/**\n\t * Re-layout the tree.\n\t */\n\tpublic layout(height?: number, width?: number): void {\n\t\tthis.tree.layout(height, width);\n\t}\n\n\t/**\n\t * Tries to reveal by extension ID. Queues the request if the extension\n\t * ID is not currently available.\n\t */\n\tprivate revealById(id: string | undefined, expand = true, focus = true) {\n\t\tif (!id) {\n\t\t\tthis.hasPendingReveal = false;\n\t\t\treturn;\n\t\t}\n\n\t\tconst projection = this.ensureProjection();\n\n\t\t// If the item itself is visible in the tree, show it. Otherwise, expand\n\t\t// its closest parent.\n\t\tlet expandToLevel = 0;\n\t\tconst idPath = [...TestId.fromString(id).idsFromRoot()];\n\t\tfor (let i = idPath.length - 1; i >= expandToLevel; i--) {\n\t\t\tconst element = projection.getElementByTestId(idPath[i].toString());\n\t\t\t// Skip all elements that aren't in the tree.\n\t\t\tif (!element || !this.tree.hasElement(element)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// If this 'if' is true, we're at the closest-visible parent to the node\n\t\t\t// we want to expand. Expand that, and then start the loop again because\n\t\t\t// we might already have children for it.\n\t\t\tif (i < idPath.length - 1) {\n\t\t\t\tif (expand) {\n\t\t\t\t\tthis.tree.expand(element);\n\t\t\t\t\texpandToLevel = i + 1; // avoid an infinite loop if the test does not exist\n\t\t\t\t\ti = idPath.length - 1; // restart the loop since new children may now be visible\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Otherwise, we've arrived!\n\n\t\t\t// If the node or any of its children are excluded, flip on the 'show\n\t\t\t// excluded tests' checkbox automatically. If we didn't expand, then set\n\t\t\t// target focus target to the first collapsed element.\n\n\t\t\tlet focusTarget = element;\n\t\t\tfor (\n\t\t\t\tlet n: TestItemTreeElement | null = element;\n\t\t\t\tn instanceof TestItemTreeElement;\n\t\t\t\tn = n.parent\n\t\t\t) {\n\t\t\t\tif (n.test && this.testService.excluded.contains(n.test)) {\n\t\t\t\t\tthis.filterState.toggleFilteringFor(\n\t\t\t\t\t\tTestFilterTerm.Hidden,\n\t\t\t\t\t\ttrue,\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tif (\n\t\t\t\t\t!expand &&\n\t\t\t\t\tthis.tree.hasElement(n) &&\n\t\t\t\t\tthis.tree.isCollapsed(n)\n\t\t\t\t) {\n\t\t\t\t\tfocusTarget = n;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.filterState.reveal.value = undefined;\n\t\t\tthis.hasPendingReveal = false;\n\t\t\tif (focus) {\n\t\t\t\tthis.tree.domFocus();\n\t\t\t}\n\n\t\t\tif (this.tree.getRelativeTop(focusTarget) === null) {\n\t\t\t\tthis.tree.reveal(focusTarget, 0.5);\n\t\t\t}\n\n\t\t\tthis.revealTimeout.value = disposableTimeout(() => {\n\t\t\t\tthis.tree.setFocus([focusTarget]);\n\t\t\t\tthis.tree.setSelection([focusTarget]);\n\t\t\t}, 1);\n\n\t\t\treturn;\n\t\t}\n\n\t\t// If here, we've expanded all parents we can. Waiting on data to come\n\t\t// in to possibly show the revealed test.\n\t\tthis.hasPendingReveal = true;\n\t}\n\n\t/**\n\t * Collapse all items in the tree.\n\t */\n\tpublic async collapseAll() {\n\t\tthis.tree.collapseAll();\n\t}\n\n\t/**\n\t * Tries to peek the first test error, if the item is in a failed state.\n\t */\n\tprivate tryPeekError(item: TestItemTreeElement) {\n\t\tconst lookup =\n\t\t\titem.test && this.testResults.getStateById(item.test.item.extId);\n\t\treturn lookup && lookup[1].tasks.some((s) => isFailedState(s.state))\n\t\t\t? this.peekOpener.tryPeekFirstError(lookup[0], lookup[1], {\n\t\t\t\t\tpreserveFocus: true,\n\t\t\t\t})\n\t\t\t: false;\n\t}\n\n\tprivate onContextMenu(\n\t\tevt: ITreeContextMenuEvent<TestExplorerTreeElement | null>,\n\t) {\n\t\tconst element = evt.element;\n\t\tif (!(element instanceof TestItemTreeElement)) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst { actions } = getActionableElementActions(\n\t\t\tthis.contextKeyService,\n\t\t\tthis.menuService,\n\t\t\tthis.testService,\n\t\t\tthis.crService,\n\t\t\tthis.testProfileService,\n\t\t\telement,\n\t\t);\n\t\tthis.contextMenuService.showContextMenu({\n\t\t\tgetAnchor: () => evt.anchor,\n\t\t\tgetActions: () => actions.secondary,\n\t\t\tgetActionsContext: () => element,\n\t\t\tactionRunner: this.actionRunner,\n\t\t});\n\t}\n\n\tprivate handleExecuteKeypress(evt: IKeyboardEvent) {\n\t\tconst focused = this.tree.getFocus();\n\t\tconst selected = this.tree.getSelection();\n\t\tlet targeted: (TestExplorerTreeElement | null)[];\n\t\tif (focused.length === 1 && selected.includes(focused[0])) {\n\t\t\tevt.browserEvent?.preventDefault();\n\t\t\ttargeted = selected;\n\t\t} else {\n\t\t\ttargeted = focused;\n\t\t}\n\n\t\tconst toRun = targeted.filter(\n\t\t\t(e): e is TestItemTreeElement => e instanceof TestItemTreeElement,\n\t\t);\n\n\t\tif (toRun.length) {\n\t\t\tthis.testService.runTests({\n\t\t\t\tgroup: TestRunProfileBitset.Run,\n\t\t\t\ttests: toRun.map((t) => t.test),\n\t\t\t});\n\t\t}\n\t}\n\n\tprivate reevaluateWelcomeState() {\n\t\tconst shouldShowWelcome =\n\t\t\tthis.testService.collection.busyProviders === 0 &&\n\t\t\ttestCollectionIsEmpty(this.testService.collection);\n\t\tconst welcomeExperience = shouldShowWelcome\n\t\t\t? this.filterState.isFilteringFor(TestFilterTerm.CurrentDoc)\n\t\t\t\t? WelcomeExperience.ForDocument\n\t\t\t\t: WelcomeExperience.ForWorkspace\n\t\t\t: WelcomeExperience.None;\n\n\t\tif (welcomeExperience !== this.welcomeExperience) {\n\t\t\tthis.welcomeExperience = welcomeExperience;\n\t\t\tthis.welcomeVisibilityEmitter.fire(welcomeExperience);\n\t\t}\n\t}\n\n\tprivate ensureProjection() {\n\t\treturn this.projection.value ?? this.updatePreferredProjection();\n\t}\n\n\tprivate updatePreferredProjection() {\n\t\tthis.projection.clear();\n\n\t\tconst lastState = this.lastViewState.get({});\n\t\tif (this._viewMode.get() === TestExplorerViewMode.List) {\n\t\t\tthis.projection.value = this.instantiationService.createInstance(\n\t\t\t\tListProjection,\n\t\t\t\tlastState,\n\t\t\t);\n\t\t} else {\n\t\t\tthis.projection.value = this.instantiationService.createInstance(\n\t\t\t\tTreeProjection,\n\t\t\t\tlastState,\n\t\t\t);\n\t\t}\n\n\t\tconst scheduler = this._register(\n\t\t\tnew RunOnceScheduler(() => this.applyProjectionChanges(), 200),\n\t\t);\n\t\tthis.projection.value.onUpdate(() => {\n\t\t\tif (!scheduler.isScheduled()) {\n\t\t\t\tscheduler.schedule();\n\t\t\t}\n\t\t});\n\n\t\tthis.applyProjectionChanges();\n\t\treturn this.projection.value;\n\t}\n\n\tprivate applyProjectionChanges() {\n\t\tthis.reevaluateWelcomeState();\n\t\tthis.projection.value?.applyTo(this.tree);\n\n\t\tthis.tree.refilter();\n\n\t\tif (this.hasPendingReveal) {\n\t\t\tthis.revealById(this.filterState.reveal.value);\n\t\t}\n\t}\n\n\t/**\n\t * Gets the selected tests from the tree.\n\t */\n\tpublic getSelectedTests() {\n\t\treturn this.tree.getSelection();\n\t}\n}\n\nenum FilterResult {\n\tExclude = 0,\n\tInherit = 1,\n\tInclude = 2,\n}\n\nconst hasNodeInOrParentOfUri = (\n\tcollection: IMainThreadTestCollection,\n\tident: IUriIdentityService,\n\ttestUri: URI,\n\tfromNode?: string,\n) => {\n\tconst queue: Iterable<string>[] = [\n\t\tfromNode ? [fromNode] : collection.rootIds,\n\t];\n\twhile (queue.length) {\n\t\tfor (const id of queue.pop()!) {\n\t\t\tconst node = collection.getNodeById(id);\n\t\t\tif (!node) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\t!node.item.uri ||\n\t\t\t\t!ident.extUri.isEqualOrParent(testUri, node.item.uri)\n\t\t\t) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// Only show nodes that can be expanded (and might have a child with\n\t\t\t// a range) or ones that have a physical location.\n\t\t\tif (\n\t\t\t\tnode.item.range ||\n\t\t\t\tnode.expand === TestItemExpandState.Expandable\n\t\t\t) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tqueue.push(node.children);\n\t\t}\n\t}\n\n\treturn false;\n};\n\nclass TestsFilter implements ITreeFilter<TestExplorerTreeElement> {\n\tprivate documentUris: URI[] = [];\n\n\tconstructor(\n\t\tprivate readonly collection: IMainThreadTestCollection,\n\t\t@ITestExplorerFilterState private readonly state: ITestExplorerFilterState,\n\t\t@ITestService private readonly testService: ITestService,\n\t\t@IUriIdentityService private readonly uriIdentityService: IUriIdentityService,\n\t) { }\n\n\t/**\n\t * @inheritdoc\n\t */\n\tpublic filter(element: TestItemTreeElement): TreeFilterResult<void> {\n\t\tif (element instanceof TestTreeErrorMessage) {\n\t\t\treturn TreeVisibility.Visible;\n\t\t}\n\n\t\tif (\n\t\t\telement.test &&\n\t\t\t!this.state.isFilteringFor(TestFilterTerm.Hidden) &&\n\t\t\tthis.testService.excluded.contains(element.test)\n\t\t) {\n\t\t\treturn TreeVisibility.Hidden;\n\t\t}\n\n\t\tswitch (\n\t\t\tMath.min(\n\t\t\t\tthis.testFilterText(element),\n\t\t\t\tthis.testLocation(element),\n\t\t\t\tthis.testState(element),\n\t\t\t\tthis.testTags(element),\n\t\t\t)\n\t\t) {\n\t\t\tcase FilterResult.Exclude:\n\t\t\t\treturn TreeVisibility.Hidden;\n\t\t\tcase FilterResult.Include:\n\t\t\t\treturn TreeVisibility.Visible;\n\t\t\tdefault:\n\t\t\t\treturn TreeVisibility.Recurse;\n\t\t}\n\t}\n\n\tpublic filterToDocumentUri(uris: readonly URI[]) {\n\t\tthis.documentUris = [...uris];\n\t}\n\n\tprivate testTags(element: TestItemTreeElement): FilterResult {\n\t\tif (!this.state.includeTags.size && !this.state.excludeTags.size) {\n\t\t\treturn FilterResult.Include;\n\t\t}\n\n\t\treturn (this.state.includeTags.size\n\t\t\t? element.test.item.tags.some((t) => this.state.includeTags.has(t))\n\t\t\t: true) &&\n\t\t\telement.test.item.tags.every((t) => !this.state.excludeTags.has(t))\n\t\t\t? FilterResult.Include\n\t\t\t: FilterResult.Inherit;\n\t}\n\n\tprivate testState(element: TestItemTreeElement): FilterResult {\n\t\tif (this.state.isFilteringFor(TestFilterTerm.Failed)) {\n\t\t\treturn isFailedState(element.state)\n\t\t\t\t? FilterResult.Include\n\t\t\t\t: FilterResult.Inherit;\n\t\t}\n\n\t\tif (this.state.isFilteringFor(TestFilterTerm.Executed)) {\n\t\t\treturn element.state !== TestResultState.Unset\n\t\t\t\t? FilterResult.Include\n\t\t\t\t: FilterResult.Inherit;\n\t\t}\n\n\t\treturn FilterResult.Include;\n\t}\n\n\tprivate testLocation(element: TestItemTreeElement): FilterResult {\n\t\tif (this.documentUris.length === 0) {\n\t\t\treturn FilterResult.Include;\n\t\t}\n\n\t\tif (\n\t\t\t(!this.state.isFilteringFor(TestFilterTerm.CurrentDoc) &&\n\t\t\t\t!this.state.isFilteringFor(TestFilterTerm.OpenedFiles)) ||\n\t\t\t!(element instanceof TestItemTreeElement)\n\t\t) {\n\t\t\treturn FilterResult.Include;\n\t\t}\n\n\t\tif (\n\t\t\tthis.documentUris.some((uri) =>\n\t\t\t\thasNodeInOrParentOfUri(\n\t\t\t\t\tthis.collection,\n\t\t\t\t\tthis.uriIdentityService,\n\t\t\t\t\turi,\n\t\t\t\t\telement.test.item.extId,\n\t\t\t\t),\n\t\t\t)\n\t\t) {\n\t\t\treturn FilterResult.Include;\n\t\t}\n\n\t\treturn FilterResult.Inherit;\n\t}\n\n\tprivate testFilterText(element: TestItemTreeElement) {\n\t\tif (this.state.globList.length === 0) {\n\t\t\treturn FilterResult.Include;\n\t\t}\n\n\t\tconst fuzzy = this.state.fuzzy.value;\n\t\tfor (let e: TestItemTreeElement | null = element; e; e = e.parent) {\n\t\t\t// start as included if the first glob is a negation\n\t\t\tlet included =\n\t\t\t\tthis.state.globList[0].include === false\n\t\t\t\t\t? FilterResult.Include\n\t\t\t\t\t: FilterResult.Inherit;\n\t\t\tconst data = e.test.item.label.toLowerCase();\n\n\t\t\tfor (const { include, text } of this.state.globList) {\n\t\t\t\tif (fuzzy ? fuzzyContains(data, text) : data.includes(text)) {\n\t\t\t\t\tincluded = include\n\t\t\t\t\t\t? FilterResult.Include\n\t\t\t\t\t\t: FilterResult.Exclude;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (included !== FilterResult.Inherit) {\n\t\t\t\treturn included;\n\t\t\t}\n\t\t}\n\n\t\treturn FilterResult.Inherit;\n\t}\n}\n\nclass TreeSorter implements ITreeSorter<TestExplorerTreeElement> {\n\tconstructor(private readonly viewModel: TestingExplorerViewModel) {}\n\n\tpublic compare(\n\t\ta: TestExplorerTreeElement,\n\t\tb: TestExplorerTreeElement,\n\t): number {\n\t\tif (\n\t\t\ta instanceof TestTreeErrorMessage ||\n\t\t\tb instanceof TestTreeErrorMessage\n\t\t) {\n\t\t\treturn (\n\t\t\t\t(a instanceof TestTreeErrorMessage ? -1 : 0) +\n\t\t\t\t(b instanceof TestTreeErrorMessage ? 1 : 0)\n\t\t\t);\n\t\t}\n\n\t\tconst durationDelta = (b.duration || 0) - (a.duration || 0);\n\t\tif (\n\t\t\tthis.viewModel.viewSorting === TestExplorerViewSorting.ByDuration &&\n\t\t\tdurationDelta !== 0\n\t\t) {\n\t\t\treturn durationDelta;\n\t\t}\n\n\t\tconst stateDelta = cmpPriority(a.state, b.state);\n\t\tif (\n\t\t\tthis.viewModel.viewSorting === TestExplorerViewSorting.ByStatus &&\n\t\t\tstateDelta !== 0\n\t\t) {\n\t\t\treturn stateDelta;\n\t\t}\n\n\t\tlet inSameLocation = false;\n\t\tif (\n\t\t\ta instanceof TestItemTreeElement &&\n\t\t\tb instanceof TestItemTreeElement &&\n\t\t\ta.test.item.uri &&\n\t\t\tb.test.item.uri &&\n\t\t\ta.test.item.uri.toString() === b.test.item.uri.toString() &&\n\t\t\ta.test.item.range &&\n\t\t\tb.test.item.range\n\t\t) {\n\t\t\tinSameLocation = true;\n\n\t\t\tconst delta =\n\t\t\t\ta.test.item.range.startLineNumber -\n\t\t\t\tb.test.item.range.startLineNumber;\n\t\t\tif (delta !== 0) {\n\t\t\t\treturn delta;\n\t\t\t}\n\t\t}\n\n\t\tconst sa = a.test.item.sortText;\n\t\tconst sb = b.test.item.sortText;\n\t\t// If tests are in the same location and there's no preferred sortText,\n\t\t// keep the extension's insertion order (#163449).\n\t\treturn inSameLocation && !sa && !sb\n\t\t\t? 0\n\t\t\t: (sa || a.test.item.label).localeCompare(sb || b.test.item.label);\n\t}\n}\n\nclass NoTestsForDocumentWidget extends Disposable {\n\tprivate readonly el: HTMLElement;\n\tconstructor(\n\t\tcontainer: HTMLElement,\n\t\t@ITestExplorerFilterState filterState: ITestExplorerFilterState,\n\t) {\n\t\tsuper();\n\t\tconst el = (this.el = dom.append(\n\t\t\tcontainer,\n\t\t\tdom.$(\".testing-no-test-placeholder\"),\n\t\t));\n\t\tconst emptyParagraph = dom.append(el, dom.$(\"p\"));\n\t\temptyParagraph.innerText = localize(\n\t\t\t\"testingNoTest\",\n\t\t\t\"No tests were found in this file.\",\n\t\t);\n\t\tconst buttonLabel = localize(\n\t\t\t\"testingFindExtension\",\n\t\t\t\"Show Workspace Tests\",\n\t\t);\n\t\tconst button = this._register(\n\t\t\tnew Button(el, { title: buttonLabel, ...defaultButtonStyles }),\n\t\t);\n\t\tbutton.label = buttonLabel;\n\t\tthis._register(\n\t\t\tbutton.onDidClick(() =>\n\t\t\t\tfilterState.toggleFilteringFor(\n\t\t\t\t\tTestFilterTerm.CurrentDoc,\n\t\t\t\t\tfalse,\n\t\t\t\t),\n\t\t\t),\n\t\t);\n\t}\n\n\tpublic setVisible(isVisible: boolean) {\n\t\tthis.el.classList.toggle(\"visible\", isVisible);\n\t}\n}\n\nclass TestExplorerActionRunner extends ActionRunner {\n\tconstructor(\n\t\tprivate getSelectedTests: () => ReadonlyArray<TestExplorerTreeElement>,\n\t) {\n\t\tsuper();\n\t}\n\n\tprotected override async runAction(\n\t\taction: IAction,\n\t\tcontext: TestExplorerTreeElement,\n\t): Promise<any> {\n\t\tif (!(action instanceof MenuItemAction)) {\n\t\t\treturn super.runAction(action, context);\n\t\t}\n\n\t\tconst selection = this.getSelectedTests();\n\t\tconst contextIsSelected = selection.some((s) => s === context);\n\t\tconst actualContext = contextIsSelected ? selection : [context];\n\t\tconst actionable = actualContext.filter(\n\t\t\t(t): t is TestItemTreeElement => t instanceof TestItemTreeElement,\n\t\t);\n\t\tawait action.run(...actionable);\n\t}\n}\n\nconst getLabelForTestTreeElement = (element: TestItemTreeElement) => {\n\tlet label = labelForTestInState(\n\t\telement.description || element.test.item.label,\n\t\telement.state,\n\t);\n\n\tif (element instanceof TestItemTreeElement) {\n\t\tif (element.duration !== undefined) {\n\t\t\tlabel = localize(\n\t\t\t\t{\n\t\t\t\t\tkey: \"testing.treeElementLabelDuration\",\n\t\t\t\t\tcomment: [\n\t\t\t\t\t\t\"{0} is the original label in testing.treeElementLabel, {1} is a duration\",\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\t\"{0}, in {1}\",\n\t\t\t\tlabel,\n\t\t\t\tformatDuration(element.duration),\n\t\t\t);\n\t\t}\n\n\t\tif (element.retired) {\n\t\t\tlabel = localize(\n\t\t\t\t{\n\t\t\t\t\tkey: \"testing.treeElementLabelOutdated\",\n\t\t\t\t\tcomment: [\n\t\t\t\t\t\t\"{0} is the original label in testing.treeElementLabel\",\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\t\"{0}, outdated result\",\n\t\t\t\tlabel,\n\t\t\t);\n\t\t}\n\t}\n\n\treturn label;\n};\n\nclass ListAccessibilityProvider\n\timplements IListAccessibilityProvider<TestExplorerTreeElement>\n{\n\tgetWidgetAriaLabel(): string {\n\t\treturn localize(\"testExplorer\", \"Test Explorer\");\n\t}\n\n\tgetAriaLabel(element: TestExplorerTreeElement): string {\n\t\treturn element instanceof TestTreeErrorMessage\n\t\t\t? element.description\n\t\t\t: getLabelForTestTreeElement(element);\n\t}\n}\n\nclass TreeKeyboardNavigationLabelProvider\n\timplements IKeyboardNavigationLabelProvider<TestExplorerTreeElement>\n{\n\tgetKeyboardNavigationLabel(element: TestExplorerTreeElement) {\n\t\treturn element instanceof TestTreeErrorMessage\n\t\t\t? element.message\n\t\t\t: element.test.item.label;\n\t}\n}\n\nclass ListDelegate implements IListVirtualDelegate<TestExplorerTreeElement> {\n\tgetHeight(element: TestExplorerTreeElement) {\n\t\treturn element instanceof TestTreeErrorMessage ? 17 + 10 : 22;\n\t}\n\n\tgetTemplateId(element: TestExplorerTreeElement) {\n\t\tif (element instanceof TestTreeErrorMessage) {\n\t\t\treturn ErrorRenderer.ID;\n\t\t}\n\n\t\treturn TestItemRenderer.ID;\n\t}\n}\n\nclass IdentityProvider implements IIdentityProvider<TestExplorerTreeElement> {\n\tpublic getId(element: TestExplorerTreeElement) {\n\t\treturn element.treeId;\n\t}\n}\n\ninterface IErrorTemplateData {\n\tlabel: HTMLElement;\n\tdisposable: DisposableStore;\n}\n\nclass ErrorRenderer\n\timplements\n\t\tITreeRenderer<TestTreeErrorMessage, FuzzyScore, IErrorTemplateData>\n{\n\tstatic readonly ID = \"error\";\n\n\tprivate readonly renderer: MarkdownRenderer;\n\n\tconstructor(\n\t\t@IHoverService private readonly hoverService: IHoverService,\n\t\t@IInstantiationService instantionService: IInstantiationService,\n\t) {\n\t\tthis.renderer = instantionService.createInstance(MarkdownRenderer, {});\n\t}\n\n\tget templateId(): string {\n\t\treturn ErrorRenderer.ID;\n\t}\n\n\trenderTemplate(container: HTMLElement): IErrorTemplateData {\n\t\tconst label = dom.append(container, dom.$(\".error\"));\n\t\treturn { label, disposable: new DisposableStore() };\n\t}\n\n\trenderElement(\n\t\t{ element }: ITreeNode<TestTreeErrorMessage, FuzzyScore>,\n\t\t_: number,\n\t\tdata: IErrorTemplateData,\n\t): void {\n\t\tdom.clearNode(data.label);\n\n\t\tif (typeof element.message === \"string\") {\n\t\t\tdata.label.innerText = element.message;\n\t\t} else {\n\t\t\tconst result = this.renderer.render(element.message, {\n\t\t\t\tinline: true,\n\t\t\t});\n\t\t\tdata.label.appendChild(result.element);\n\t\t}\n\t\tdata.disposable.add(\n\t\t\tthis.hoverService.setupManagedHover(\n\t\t\t\tgetDefaultHoverDelegate(\"mouse\"),\n\t\t\t\tdata.label,\n\t\t\t\telement.description,\n\t\t\t),\n\t\t);\n\t}\n\n\tdisposeTemplate(data: IErrorTemplateData): void {\n\t\tdata.disposable.dispose();\n\t}\n}\n\ninterface ITestElementTemplateData {\n\tcurrent?: TestItemTreeElement;\n\tlabel: HTMLElement;\n\ticon: HTMLElement;\n\twrapper: HTMLElement;\n\tactionBar: ActionBar;\n\telementDisposable: DisposableStore;\n\ttemplateDisposable: DisposableStore;\n}\n\nclass TestItemRenderer\n\textends Disposable\n\timplements\n\t\tITreeRenderer<TestItemTreeElement, FuzzyScore, ITestElementTemplateData>\n{\n\tpublic static readonly ID = \"testItem\";\n\n\tconstructor(\n\t\tprivate readonly actionRunner: TestExplorerActionRunner,\n\t\t@IMenuService private readonly menuService: IMenuService,\n\t\t@ITestService protected readonly testService: ITestService,\n\t\t@ITestProfileService protected readonly profiles: ITestProfileService,\n\t\t@IContextKeyService private readonly contextKeyService: IContextKeyService,\n\t\t@IInstantiationService private readonly instantiationService: IInstantiationService,\n\t\t@ITestingContinuousRunService private readonly crService: ITestingContinuousRunService,\n\t\t@IHoverService private readonly hoverService: IHoverService,\n\t) {\n\t\tsuper();\n\t}\n\n\t/**\n\t * @inheritdoc\n\t */\n\tpublic readonly templateId = TestItemRenderer.ID;\n\n\t/**\n\t * @inheritdoc\n\t */\n\tpublic renderTemplate(container: HTMLElement): ITestElementTemplateData {\n\t\tconst wrapper = dom.append(container, dom.$(\".test-item\"));\n\n\t\tconst icon = dom.append(wrapper, dom.$(\".computed-state\"));\n\t\tconst label = dom.append(wrapper, dom.$(\".label\"));\n\t\tconst disposable = new DisposableStore();\n\n\t\tdom.append(\n\t\t\twrapper,\n\t\t\tdom.$(ThemeIcon.asCSSSelector(icons.testingHiddenIcon)),\n\t\t);\n\t\tconst actionBar = disposable.add(\n\t\t\tnew ActionBar(wrapper, {\n\t\t\t\tactionRunner: this.actionRunner,\n\t\t\t\tactionViewItemProvider: (action, options) =>\n\t\t\t\t\taction instanceof MenuItemAction\n\t\t\t\t\t\t? this.instantiationService.createInstance(\n\t\t\t\t\t\t\t\tMenuEntryActionViewItem,\n\t\t\t\t\t\t\t\taction,\n\t\t\t\t\t\t\t\t{ hoverDelegate: options.hoverDelegate },\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t: undefined,\n\t\t\t}),\n\t\t);\n\n\t\tdisposable.add(\n\t\t\tthis.crService.onDidChange((changed) => {\n\t\t\t\tconst id = templateData.current?.test.item.extId;\n\t\t\t\tif (\n\t\t\t\t\tid &&\n\t\t\t\t\t(!changed || changed === id || TestId.isChild(id, changed))\n\t\t\t\t) {\n\t\t\t\t\tthis.fillActionBar(templateData.current!, templateData);\n\t\t\t\t}\n\t\t\t}),\n\t\t);\n\n\t\tconst templateData: ITestElementTemplateData = {\n\t\t\twrapper,\n\t\t\tlabel,\n\t\t\tactionBar,\n\t\t\ticon,\n\t\t\telementDisposable: new DisposableStore(),\n\t\t\ttemplateDisposable: disposable,\n\t\t};\n\t\treturn templateData;\n\t}\n\n\t/**\n\t * @inheritdoc\n\t */\n\tdisposeTemplate(templateData: ITestElementTemplateData): void {\n\t\ttemplateData.templateDisposable.clear();\n\t}\n\n\t/**\n\t * @inheritdoc\n\t */\n\tdisposeElement(\n\t\t_element: ITreeNode<TestItemTreeElement, FuzzyScore>,\n\t\t_: number,\n\t\ttemplateData: ITestElementTemplateData,\n\t): void {\n\t\ttemplateData.elementDisposable.clear();\n\t}\n\n\tprivate fillActionBar(\n\t\telement: TestItemTreeElement,\n\t\tdata: ITestElementTemplateData,\n\t) {\n\t\tconst { actions, contextOverlay } = getActionableElementActions(\n\t\t\tthis.contextKeyService,\n\t\t\tthis.menuService,\n\t\t\tthis.testService,\n\t\t\tthis.crService,\n\t\t\tthis.profiles,\n\t\t\telement,\n\t\t);\n\t\tconst crSelf = !!contextOverlay.getContextKeyValue(\n\t\t\tTestingContextKeys.isContinuousModeOn.key,\n\t\t);\n\t\tconst crChild =\n\t\t\t!crSelf &&\n\t\t\tthis.crService.isEnabledForAChildOf(element.test.item.extId);\n\t\tdata.actionBar.domNode.classList.toggle(\n\t\t\t\"testing-is-continuous-run\",\n\t\t\tcrSelf || crChild,\n\t\t);\n\t\tdata.actionBar.clear();\n\t\tdata.actionBar.context = element;\n\t\tdata.actionBar.push(actions.primary, { icon: true, label: false });\n\t}\n\n\t/**\n\t * @inheritdoc\n\t */\n\tpublic renderElement(\n\t\tnode: ITreeNode<TestItemTreeElement, FuzzyScore>,\n\t\t_depth: number,\n\t\tdata: ITestElementTemplateData,\n\t): void {\n\t\tdata.elementDisposable.clear();\n\t\tdata.current = node.element;\n\t\tthis.fillActionBar(node.element, data);\n\n\t\tdata.elementDisposable.add(\n\t\t\tnode.element.onChange(() => this._renderElement(node, data)),\n\t\t);\n\t\tthis._renderElement(node, data);\n\t}\n\n\tpublic _renderElement(\n\t\tnode: ITreeNode<TestItemTreeElement, FuzzyScore>,\n\t\tdata: ITestElementTemplateData,\n\t): void {\n\t\tconst testHidden = this.testService.excluded.contains(\n\t\t\tnode.element.test,\n\t\t);\n\t\tdata.wrapper.classList.toggle(\"test-is-hidden\", testHidden);\n\n\t\tconst icon = icons.testingStatesToIcons.get(\n\t\t\tnode.element.test.expand === TestItemExpandState.BusyExpanding ||\n\t\t\t\tnode.element.test.item.busy\n\t\t\t\t? TestResultState.Running\n\t\t\t\t: node.element.state,\n\t\t);\n\n\t\tdata.icon.className =\n\t\t\t\"computed-state \" + (icon ? ThemeIcon.asClassName(icon) : \"\");\n\t\tif (node.element.retired) {\n\t\t\tdata.icon.className += \" retired\";\n\t\t}\n\n\t\tdata.elementDisposable.add(\n\t\t\tthis.hoverService.setupManagedHover(\n\t\t\t\tgetDefaultHoverDelegate(\"mouse\"),\n\t\t\t\tdata.label,\n\t\t\t\tgetLabelForTestTreeElement(node.element),\n\t\t\t),\n\t\t);\n\t\tif (node.element.test.item.label.trim()) {\n\t\t\tdom.reset(\n\t\t\t\tdata.label,\n\t\t\t\t...renderLabelWithIcons(node.element.test.item.label),\n\t\t\t);\n\t\t} else {\n\t\t\tdata.label.textContent = String.fromCharCode(0xa0); // &nbsp;\n\t\t}\n\n\t\tlet description = node.element.description;\n\t\tif (node.element.duration !== undefined) {\n\t\t\tdescription = description\n\t\t\t\t? `${description}: ${formatDuration(node.element.duration)}`\n\t\t\t\t: formatDuration(node.element.duration);\n\t\t}\n\n\t\tif (description) {\n\t\t\tdom.append(\n\t\t\t\tdata.label,\n\t\t\t\tdom.$(\"span.test-label-description\", {}, description),\n\t\t\t);\n\t\t}\n\t}\n}\n\nconst formatDuration = (ms: number) => {\n\tif (ms < 10) {\n\t\treturn `${ms.toFixed(1)}ms`;\n\t}\n\n\tif (ms < 1_000) {\n\t\treturn `${ms.toFixed(0)}ms`;\n\t}\n\n\treturn `${(ms / 1000).toFixed(1)}s`;\n};\n\nconst getActionableElementActions = (\n\tcontextKeyService: IContextKeyService,\n\tmenuService: IMenuService,\n\ttestService: ITestService,\n\tcrService: ITestingContinuousRunService,\n\tprofiles: ITestProfileService,\n\telement: TestItemTreeElement,\n) => {\n\tconst test =\n\t\telement instanceof TestItemTreeElement ? element.test : undefined;\n\tconst contextKeys: [string, unknown][] = getTestItemContextOverlay(\n\t\ttest,\n\t\ttest ? profiles.capabilitiesForTest(test.item) : 0,\n\t);\n\tcontextKeys.push([\"view\", Testing.ExplorerViewId]);\n\tif (test) {\n\t\tconst ctrl = testService.getTestController(test.controllerId);\n\t\tconst supportsCr =\n\t\t\t!!ctrl &&\n\t\t\tprofiles\n\t\t\t\t.getControllerProfiles(ctrl.id)\n\t\t\t\t.some((p) => p.supportsContinuousRun);\n\t\tcontextKeys.push(\n\t\t\t[\n\t\t\t\tTestingContextKeys.canRefreshTests.key,\n\t\t\t\tctrl &&\n\t\t\t\t\t!!(\n\t\t\t\t\t\tctrl.capabilities.get() &\n\t\t\t\t\t\tTestControllerCapability.Refresh\n\t\t\t\t\t) &&\n\t\t\t\t\tTestId.isRoot(test.item.extId),\n\t\t\t],\n\t\t\t[\n\t\t\t\tTestingContextKeys.testItemIsHidden.key,\n\t\t\t\ttestService.excluded.contains(test),\n\t\t\t],\n\t\t\t[\n\t\t\t\tTestingContextKeys.isContinuousModeOn.key,\n\t\t\t\tsupportsCr &&\n\t\t\t\t\tcrService.isSpecificallyEnabledFor(test.item.extId),\n\t\t\t],\n\t\t\t[\n\t\t\t\tTestingContextKeys.isParentRunningContinuously.key,\n\t\t\t\tsupportsCr && crService.isEnabledForAParentOf(test.item.extId),\n\t\t\t],\n\t\t\t[TestingContextKeys.supportsContinuousRun.key, supportsCr],\n\t\t);\n\t}\n\n\tconst contextOverlay = contextKeyService.createOverlay(contextKeys);\n\tconst menu = menuService.getMenuActions(MenuId.TestItem, contextOverlay, {\n\t\tshouldForwardArgs: true,\n\t});\n\n\tconst primary: IAction[] = [];\n\tconst secondary: IAction[] = [];\n\tconst result = { primary, secondary };\n\tcreateAndFillInActionBarActions(menu, result, \"inline\");\n\n\treturn { actions: result, contextOverlay };\n};\n\nregisterThemingParticipant((theme, collector) => {\n\tif (theme.type === \"dark\") {\n\t\tconst foregroundColor = theme.getColor(foreground);\n\t\tif (foregroundColor) {\n\t\t\tconst fgWithOpacity = new Color(\n\t\t\t\tnew RGBA(\n\t\t\t\t\tforegroundColor.rgba.r,\n\t\t\t\t\tforegroundColor.rgba.g,\n\t\t\t\t\tforegroundColor.rgba.b,\n\t\t\t\t\t0.65,\n\t\t\t\t),\n\t\t\t);\n\t\t\tcollector.addRule(\n\t\t\t\t`.test-explorer .test-explorer-messages { color: ${fgWithOpacity}; }`,\n\t\t\t);\n\t\t}\n\t}\n});\n"],
  "mappings": "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",
  "names": ["LastFocusState", "WelcomeExperience", "FilterResult"]
}
