import{assertNever as f}from"../../../../base/common/assert.js";import{clamp as u}from"../../../../base/common/numbers.js";import{localize as a}from"../../../../nls.js";import{chartsGreen as d,chartsRed as h,chartsYellow as C}from"../../../../platform/theme/common/colorRegistry.js";import{asCssVariableName as l}from"../../../../platform/theme/common/colorUtils.js";import"./testCoverageBars.js";import{TestingDisplayedCoveragePercent as m}from"../common/configuration.js";import{getTotalCoveragePercent as T}from"../common/testCoverage.js";import"../common/testId.js";import"../common/testResult.js";import"../common/testTypes.js";const c=e=>u(e.total===0?1:e.covered/e.total,0,1),p=[{color:`var(${l(h)})`,key:"red"},{color:`var(${l(C)})`,key:"yellow"},{color:`var(${l(d)})`,key:"green"}],A=(e,r)=>{let t=p[0].color,n=e;for(const{key:i,color:o}of p){const s=r[i]/100;s&&e>=s&&e-s<n&&(t=o,n=e-s)}return t},v=1e-7,x=(e,r=2)=>{const t=(e*100).toFixed(r);return e<1-v&&t==="100"?`${100-10**-r}%`:`${t}%`},G=(e,r)=>{switch(r){case m.Statement:return c(e.statement);case m.Minimum:{let t=c(e.statement);return e.branch&&(t=Math.min(t,c(e.branch))),e.declaration&&(t=Math.min(t,c(e.declaration))),t}case m.TotalCoverage:return T(e.statement,e.branch,e.declaration);default:f(r)}};function V(e,r,t){const n=[];for(const i of r.idsFromRoot()){const o=e.getTestById(i.toString());if(!o)break;n.push(o.label)}return n.slice(t).join(" \u203A ")}var y;(o=>(o.showingFilterFor=s=>a("testing.coverageForTest",'Showing "{0}"',s),o.clickToChangeFiltering=a("changePerTestFilter","Click to view coverage for a single test"),o.percentCoverage=(s,g)=>a("testing.percentCoverage","{0} Coverage",x(s,g)),o.allTests=a("testing.allTests","All tests"),o.pickShowCoverage=a("testing.pickTest","Pick a test to show coverage for")))(y||={});export{G as calculateDisplayedStat,x as displayPercent,A as getCoverageColor,V as getLabelForItem,y as labels,c as percent};
