import{KeyCode as s,KeyMod as o}from"../../../../base/common/keyCodes.js";import{EditorAction as v,registerEditorAction as y}from"../../../../editor/browser/editorExtensions.js";import{EditorContextKeys as i}from"../../../../editor/common/editorContextKeys.js";import{ILanguageFeaturesService as S}from"../../../../editor/common/services/languageFeatures.js";import*as t from"../../../../nls.js";import{ICommandService as b}from"../../../../platform/commands/common/commands.js";import{ContextKeyExpr as h}from"../../../../platform/contextkey/common/contextkey.js";import{IDialogService as C}from"../../../../platform/dialogs/common/dialogs.js";import{KeybindingWeight as x}from"../../../../platform/keybinding/common/keybindingsRegistry.js";import{INotificationService as F}from"../../../../platform/notification/common/notification.js";import{IExtensionsWorkbenchService as E}from"../../extensions/common/extensions.js";y(class extends v{constructor(){super({id:"editor.action.formatDocument.none",label:t.localize("formatDocument.label.multiple","Format Document"),alias:"Format Document",precondition:h.and(i.writable,i.hasDocumentFormattingProvider.toNegated()),kbOpts:{kbExpr:i.editorTextFocus,primary:o.Shift|o.Alt|s.KeyF,linux:{primary:o.CtrlCmd|o.Shift|s.KeyI},weight:x.EditorContrib}})}async run(e,n){if(!n.hasModel())return;const m=e.get(b),l=e.get(E),d=e.get(F),f=e.get(C),g=e.get(S),r=n.getModel(),a=g.documentFormattingEditProvider.all(r).length;if(a>1)return m.executeCommand("editor.action.formatDocument.multiple");if(a===1)return m.executeCommand("editor.action.formatDocument");if(r.isTooLargeForSyncing())d.warn(t.localize("too.large","This file cannot be formatted because it is too large"));else{const c=r.getLanguageId(),u=t.localize("no.provider","There is no formatter for '{0}' files installed.",c),{confirmed:p}=await f.confirm({message:u,primaryButton:t.localize({key:"install.formatter",comment:["&& denotes a mnemonic"]},"&&Install Formatter...")});p&&l.openSearch(`category:formatters ${c}`)}}});
