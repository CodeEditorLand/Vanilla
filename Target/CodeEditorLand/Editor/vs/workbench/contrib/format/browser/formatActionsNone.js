import{KeyCode as l,KeyMod as t}from"../../../../base/common/keyCodes.js";import"../../../../editor/browser/editorBrowser.js";import{EditorAction as v,registerEditorAction as S}from"../../../../editor/browser/editorExtensions.js";import{EditorContextKeys as n}from"../../../../editor/common/editorContextKeys.js";import*as i from"../../../../nls.js";import{ContextKeyExpr as y}from"../../../../platform/contextkey/common/contextkey.js";import{KeybindingWeight as I}from"../../../../platform/keybinding/common/keybindingsRegistry.js";import{ICommandService as E}from"../../../../platform/commands/common/commands.js";import{INotificationService as x}from"../../../../platform/notification/common/notification.js";import{VIEWLET_ID as h}from"../../extensions/common/extensions.js";import{IDialogService as w}from"../../../../platform/dialogs/common/dialogs.js";import{IPaneCompositePartService as F}from"../../../services/panecomposite/browser/panecomposite.js";import{ViewContainerLocation as P}from"../../../common/views.js";import{ILanguageFeaturesService as b}from"../../../../editor/common/services/languageFeatures.js";async function D(a,e){const o=await a.openPaneComposite(h,P.Sidebar,!0);o&&(o?.getViewPaneContainer()).search(e)}S(class extends v{constructor(){super({id:"editor.action.formatDocument.none",label:i.localize("formatDocument.label.multiple","Format Document"),alias:"Format Document",precondition:y.and(n.writable,n.hasDocumentFormattingProvider.toNegated()),kbOpts:{kbExpr:n.editorTextFocus,primary:t.Shift|t.Alt|l.KeyF,linux:{primary:t.CtrlCmd|t.Shift|l.KeyI},weight:I.EditorContrib}})}async run(e,o){if(!o.hasModel())return;const m=e.get(E),d=e.get(F),f=e.get(x),u=e.get(w),g=e.get(b),r=o.getModel(),c=g.documentFormattingEditProvider.all(r).length;if(c>1)return m.executeCommand("editor.action.formatDocument.multiple");if(c===1)return m.executeCommand("editor.action.formatDocument");if(r.isTooLargeForSyncing())f.warn(i.localize("too.large","This file cannot be formatted because it is too large"));else{const s=r.getLanguageId(),p=i.localize("no.provider","There is no formatter for '{0}' files installed.",s),{confirmed:C}=await u.confirm({message:p,primaryButton:i.localize({key:"install.formatter",comment:["&& denotes a mnemonic"]},"&&Install Formatter...")});C&&D(d,`category:formatters ${s}`)}}});
