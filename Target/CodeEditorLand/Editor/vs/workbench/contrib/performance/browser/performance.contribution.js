import{EventProfiling as l}from"../../../../base/common/event.js";import{localize2 as i}from"../../../../nls.js";import{Categories as o}from"../../../../platform/action/common/actionCommonCategories.js";import{Action2 as n,registerAction2 as s}from"../../../../platform/actions/common/actions.js";import{IInstantiationService as u}from"../../../../platform/instantiation/common/instantiation.js";import{InstantiationService as v,Trace as m}from"../../../../platform/instantiation/common/instantiationService.js";import{Registry as p}from"../../../../platform/registry/common/platform.js";import{Extensions as g,registerWorkbenchContribution2 as y}from"../../../common/contributions.js";import{EditorExtensions as d}from"../../../common/editor.js";import{IEditorService as S}from"../../../services/editor/common/editorService.js";import{LifecyclePhase as E}from"../../../services/lifecycle/common/lifecycle.js";import{InputLatencyContrib as b}from"./inputLatencyContrib.js";import{PerfviewContrib as c,PerfviewInput as f}from"./perfviewEditor.js";y(c.ID,c,{lazy:!0}),p.as(d.EditorFactory).registerEditorSerializer(f.Id,class{canSerialize(){return!0}serialize(){return""}deserialize(e){return e.createInstance(f)}}),s(class extends n{constructor(){super({id:"perfview.show",title:i("show.label","Startup Performance"),category:o.Developer,f1:!0})}run(e){const r=e.get(S),t=c.get();return r.openEditor(t.getEditorInput(),{pinned:!0})}}),s(class extends n{constructor(){super({id:"perf.insta.printAsyncCycles",title:i("cycles","Print Service Cycles"),category:o.Developer,f1:!0})}run(r){const t=r.get(u);if(t instanceof v){const a=t._globalGraph?.findCycleSlow()}}}),s(class extends n{constructor(){super({id:"perf.insta.printTraces",title:i("insta.trace","Print Service Traces"),category:o.Developer,f1:!0})}run(){if(m.all.size!==0)for(const r of m.all);}}),s(class extends n{constructor(){super({id:"perf.event.profiling",title:i("emitter","Print Emitter Profiles"),category:o.Developer,f1:!0})}run(){if(l.all.size!==0)for(const r of l.all);}}),p.as(g.Workbench).registerWorkbenchContribution(b,E.Eventually);
