{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/extensions/browser/deprecatedExtensionsChecker.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IExtensionsWorkbenchService } from '../common/extensions.js';\nimport { IWorkbenchContribution } from '../../../common/contributions.js';\nimport { INotificationService, Severity } from '../../../../platform/notification/common/notification.js';\nimport { IStorageService, StorageScope, StorageTarget } from '../../../../platform/storage/common/storage.js';\nimport { localize } from '../../../../nls.js';\nimport { distinct } from '../../../../base/common/arrays.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { IExtensionManagementService } from '../../../../platform/extensionManagement/common/extensionManagement.js';\nimport { areSameExtensions } from '../../../../platform/extensionManagement/common/extensionManagementUtil.js';\nimport { IWorkbenchExtensionEnablementService } from '../../../services/extensionManagement/common/extensionManagement.js';\n\nexport class DeprecatedExtensionsChecker extends Disposable implements IWorkbenchContribution {\n\n\tconstructor(\n\t\t@IExtensionsWorkbenchService private readonly extensionsWorkbenchService: IExtensionsWorkbenchService,\n\t\t@IExtensionManagementService extensionManagementService: IExtensionManagementService,\n\t\t@IWorkbenchExtensionEnablementService private readonly extensionEnablementService: IWorkbenchExtensionEnablementService,\n\t\t@IStorageService private readonly storageService: IStorageService,\n\t\t@INotificationService private readonly notificationService: INotificationService,\n\t) {\n\t\tsuper();\n\t\tthis.checkForDeprecatedExtensions();\n\t\tthis._register(extensionManagementService.onDidInstallExtensions(e => {\n\t\t\tconst ids: string[] = [];\n\t\t\tfor (const { local } of e) {\n\t\t\t\tif (local && extensionsWorkbenchService.local.find(extension => areSameExtensions(extension.identifier, local.identifier))?.deprecationInfo) {\n\t\t\t\t\tids.push(local.identifier.id.toLowerCase());\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (ids.length) {\n\t\t\t\tthis.setNotifiedDeprecatedExtensions(ids);\n\t\t\t}\n\t\t}));\n\t}\n\n\tprivate async checkForDeprecatedExtensions(): Promise<void> {\n\t\tif (this.storageService.getBoolean('extensionsAssistant/doNotCheckDeprecated', StorageScope.PROFILE, false)) {\n\t\t\treturn;\n\t\t}\n\t\tconst local = await this.extensionsWorkbenchService.queryLocal();\n\t\tconst previouslyNotified = this.getNotifiedDeprecatedExtensions();\n\t\tconst toNotify = local.filter(e => !!e.deprecationInfo && e.local && this.extensionEnablementService.isEnabled(e.local)).filter(e => !previouslyNotified.includes(e.identifier.id.toLowerCase()));\n\t\tif (toNotify.length) {\n\t\t\tthis.notificationService.prompt(\n\t\t\t\tSeverity.Warning,\n\t\t\t\tlocalize('deprecated extensions', \"You have deprecated extensions installed. We recommend to review them and migrate to alternatives.\"),\n\t\t\t\t[{\n\t\t\t\t\tlabel: localize('showDeprecated', \"Show Deprecated Extensions\"),\n\t\t\t\t\trun: async () => {\n\t\t\t\t\t\tthis.setNotifiedDeprecatedExtensions(toNotify.map(e => e.identifier.id.toLowerCase()));\n\t\t\t\t\t\tawait this.extensionsWorkbenchService.openSearch(toNotify.map(extension => `@id:${extension.identifier.id}`).join(' '));\n\t\t\t\t\t}\n\t\t\t\t}, {\n\t\t\t\t\tlabel: localize('neverShowAgain', \"Don't Show Again\"),\n\t\t\t\t\tisSecondary: true,\n\t\t\t\t\trun: () => this.storageService.store('extensionsAssistant/doNotCheckDeprecated', true, StorageScope.PROFILE, StorageTarget.USER)\n\t\t\t\t}]\n\t\t\t);\n\t\t}\n\t}\n\n\tprivate getNotifiedDeprecatedExtensions(): string[] {\n\t\treturn JSON.parse(this.storageService.get('extensionsAssistant/deprecated', StorageScope.PROFILE, '[]'));\n\t}\n\n\tprivate setNotifiedDeprecatedExtensions(notified: string[]): void {\n\t\tthis.storageService.store('extensionsAssistant/deprecated', JSON.stringify(distinct([...this.getNotifiedDeprecatedExtensions(), ...notified])), StorageScope.PROFILE, StorageTarget.USER);\n\t}\n}\n"],
  "mappings": ";;;;;;;;;;;;AAKA,SAAS,mCAAmC;AAC5C,SAAS,8BAA8B;AACvC,SAAS,sBAAsB,gBAAgB;AAC/C,SAAS,iBAAiB,cAAc,qBAAqB;AAC7D,SAAS,gBAAgB;AACzB,SAAS,gBAAgB;AACzB,SAAS,kBAAkB;AAC3B,SAAS,mCAAmC;AAC5C,SAAS,yBAAyB;AAClC,SAAS,4CAA4C;AAE9C,IAAM,8BAAN,cAA0C,WAA6C;AAAA,EAE7F,YAC+C,4BACjB,4BAC0B,4BACrB,gBACK,qBACtC;AACD,UAAM;AANwC;AAES;AACrB;AACK;AAGvC,SAAK,6BAA6B;AAClC,SAAK,UAAU,2BAA2B,uBAAuB,OAAK;AACrE,YAAM,MAAgB,CAAC;AACvB,iBAAW,EAAE,MAAM,KAAK,GAAG;AAC1B,YAAI,SAAS,2BAA2B,MAAM,KAAK,eAAa,kBAAkB,UAAU,YAAY,MAAM,UAAU,CAAC,GAAG,iBAAiB;AAC5I,cAAI,KAAK,MAAM,WAAW,GAAG,YAAY,CAAC;AAAA,QAC3C;AAAA,MACD;AACA,UAAI,IAAI,QAAQ;AACf,aAAK,gCAAgC,GAAG;AAAA,MACzC;AAAA,IACD,CAAC,CAAC;AAAA,EACH;AAAA,EAtCD,OAgB8F;AAAA;AAAA;AAAA,EAwB7F,MAAc,+BAA8C;AAC3D,QAAI,KAAK,eAAe,WAAW,4CAA4C,aAAa,SAAS,KAAK,GAAG;AAC5G;AAAA,IACD;AACA,UAAM,QAAQ,MAAM,KAAK,2BAA2B,WAAW;AAC/D,UAAM,qBAAqB,KAAK,gCAAgC;AAChE,UAAM,WAAW,MAAM,OAAO,OAAK,CAAC,CAAC,EAAE,mBAAmB,EAAE,SAAS,KAAK,2BAA2B,UAAU,EAAE,KAAK,CAAC,EAAE,OAAO,OAAK,CAAC,mBAAmB,SAAS,EAAE,WAAW,GAAG,YAAY,CAAC,CAAC;AAChM,QAAI,SAAS,QAAQ;AACpB,WAAK,oBAAoB;AAAA,QACxB,SAAS;AAAA,QACT,SAAS,yBAAyB,oGAAoG;AAAA,QACtI,CAAC;AAAA,UACA,OAAO,SAAS,kBAAkB,4BAA4B;AAAA,UAC9D,KAAK,mCAAY;AAChB,iBAAK,gCAAgC,SAAS,IAAI,OAAK,EAAE,WAAW,GAAG,YAAY,CAAC,CAAC;AACrF,kBAAM,KAAK,2BAA2B,WAAW,SAAS,IAAI,eAAa,OAAO,UAAU,WAAW,EAAE,EAAE,EAAE,KAAK,GAAG,CAAC;AAAA,UACvH,GAHK;AAAA,QAIN,GAAG;AAAA,UACF,OAAO,SAAS,kBAAkB,kBAAkB;AAAA,UACpD,aAAa;AAAA,UACb,KAAK,6BAAM,KAAK,eAAe,MAAM,4CAA4C,MAAM,aAAa,SAAS,cAAc,IAAI,GAA1H;AAAA,QACN,CAAC;AAAA,MACF;AAAA,IACD;AAAA,EACD;AAAA,EAEQ,kCAA4C;AACnD,WAAO,KAAK,MAAM,KAAK,eAAe,IAAI,kCAAkC,aAAa,SAAS,IAAI,CAAC;AAAA,EACxG;AAAA,EAEQ,gCAAgC,UAA0B;AACjE,SAAK,eAAe,MAAM,kCAAkC,KAAK,UAAU,SAAS,CAAC,GAAG,KAAK,gCAAgC,GAAG,GAAG,QAAQ,CAAC,CAAC,GAAG,aAAa,SAAS,cAAc,IAAI;AAAA,EACzL;AACD;AAzDa,8BAAN;AAAA,EAGJ;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,GAPU;",
  "names": []
}
