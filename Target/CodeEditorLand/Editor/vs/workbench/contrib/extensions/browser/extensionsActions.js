var Ht=Object.defineProperty;var qt=Object.getOwnPropertyDescriptor;var u=(c,a,e,t)=>{for(var n=t>1?void 0:t?qt(a,e):a,o=c.length-1,r;o>=0;o--)(r=c[o])&&(n=(t?r(a,e,n):r(n))||n);return t&&n&&Ht(a,e,n),n},i=(c,a)=>(e,t)=>a(e,t,c);import"./media/extensionActions.css";import"../../../../base/browser/contextmenu.js";import*as Qt from"../../../../base/browser/dom.js";import{ActionViewItem as Kt}from"../../../../base/browser/ui/actionbar/actionViewItems.js";import{alert as L}from"../../../../base/browser/ui/aria/aria.js";import{ActionWithDropdownActionViewItem as Xt}from"../../../../base/browser/ui/dropdown/dropdownActionViewItem.js";import{Action as k,Separator as Ct,SubmenuAction as jt}from"../../../../base/common/actions.js";import{Delayer as rt,Promises as be,Throttler as ot}from"../../../../base/common/async.js";import{CancellationToken as le}from"../../../../base/common/cancellation.js";import{fromNow as Jt}from"../../../../base/common/date.js";import{getErrorMessage as at,isCancellationError as wt}from"../../../../base/common/errors.js";import{Emitter as Lt,Event as Ce}from"../../../../base/common/event.js";import{escapeMarkdownSyntaxTokens as Oe,MarkdownString as m}from"../../../../base/common/htmlContent.js";import*as lt from"../../../../base/common/json.js";import{disposeIfDisposable as Yt}from"../../../../base/common/lifecycle.js";import{isIOS as zt,isWeb as ct,language as dt}from"../../../../base/common/platform.js";import{ThemeIcon as I}from"../../../../base/common/themables.js";import{isString as Tt}from"../../../../base/common/types.js";import{URI as ee}from"../../../../base/common/uri.js";import{ITextModelService as ht}from"../../../../editor/common/services/resolverService.js";import{localize as s,localize2 as fe}from"../../../../nls.js";import{IMenuService as Zt,MenuId as en}from"../../../../platform/actions/common/actions.js";import{CommandsRegistry as Pt,ICommandService as ut}from"../../../../platform/commands/common/commands.js";import{IConfigurationService as Mt}from"../../../../platform/configuration/common/configuration.js";import{IContextKeyService as tn}from"../../../../platform/contextkey/common/contextkey.js";import{IContextMenuService as nn}from"../../../../platform/contextview/browser/contextView.js";import{IDialogService as we}from"../../../../platform/dialogs/common/dialogs.js";import"../../../../platform/editor/common/editor.js";import{ExtensionManagementErrorCode as te,IExtensionGalleryService as Ve,InstallOperation as Le,TargetPlatformToString as sn}from"../../../../platform/extensionManagement/common/extensionManagement.js";import{areSameExtensions as T,getExtensionId as Wt}from"../../../../platform/extensionManagement/common/extensionManagementUtil.js";import{ExtensionIdentifier as Dt,ExtensionType as Nt,getWorkspaceSupportTypeMessage as Ue,isApplicationScopedExtension as rn,isLanguagePackExtension as At,TargetPlatform as _e}from"../../../../platform/extensions/common/extensions.js";import{IFileService as Te}from"../../../../platform/files/common/files.js";import{IInstantiationService as E}from"../../../../platform/instantiation/common/instantiation.js";import{ILabelService as Rt}from"../../../../platform/label/common/label.js";import{getLocale as pt}from"../../../../platform/languagePacks/common/languagePacks.js";import{ILogService as vt}from"../../../../platform/log/common/log.js";import{INotificationService as Pe,Severity as H}from"../../../../platform/notification/common/notification.js";import{IOpenerService as $t}from"../../../../platform/opener/common/opener.js";import{IProductService as xt}from"../../../../platform/product/common/productService.js";import{IProgressService as mt,ProgressLocation as on}from"../../../../platform/progress/common/progress.js";import{IQuickInputService as q}from"../../../../platform/quickinput/common/quickInput.js";import{Registry as an}from"../../../../platform/registry/common/platform.js";import{ITelemetryService as Bt}from"../../../../platform/telemetry/common/telemetry.js";import{buttonBackground as Fe,buttonForeground as Ge,buttonHoverBackground as He,buttonSeparator as ln,editorErrorForeground as cn,editorInfoForeground as dn,editorWarningForeground as hn,registerColor as ce}from"../../../../platform/theme/common/colorRegistry.js";import{registerThemingParticipant as un}from"../../../../platform/theme/common/themeService.js";import{IUpdateService as pn}from"../../../../platform/update/common/update.js";import{IUserDataSyncEnablementService as vn}from"../../../../platform/userDataSync/common/userDataSync.js";import{isVirtualWorkspace as xn}from"../../../../platform/workspace/common/virtualWorkspace.js";import{IWorkspaceContextService as ge,WorkbenchState as qe}from"../../../../platform/workspace/common/workspace.js";import{IWorkspaceTrustEnablementService as mn,IWorkspaceTrustManagementService as Sn}from"../../../../platform/workspace/common/workspaceTrust.js";import{PICK_WORKSPACE_FOLDER_COMMAND_ID as bn}from"../../../browser/actions/workspaceCommands.js";import{ViewContainerLocation as Me}from"../../../common/views.js";import{IJSONEditingService as St}from"../../../services/configuration/common/jsonEditing.js";import{IEditorService as bt}from"../../../services/editor/common/editorService.js";import{Extensions as fn,IExtensionFeaturesManagementService as gn}from"../../../services/extensionManagement/common/extensionFeatures.js";import{EnablementState as b,IExtensionManagementServerService as B,IWorkbenchExtensionEnablementService as P,IWorkbenchExtensionManagementService as In}from"../../../services/extensionManagement/common/extensionManagement.js";import{ExtensionRecommendationReason as En,IExtensionIgnoredRecommendationsService as ft,IExtensionRecommendationsService as yn}from"../../../services/extensionRecommendations/common/extensionRecommendations.js";import{EXTENSIONS_CONFIG as Ot}from"../../../services/extensionRecommendations/common/workspaceExtensionsConfig.js";import{IExtensionManifestPropertiesService as Ie}from"../../../services/extensions/common/extensionManifestPropertiesService.js";import{IExtensionService as W,toExtension as Vt,toExtensionDescription as Qe}from"../../../services/extensions/common/extensions.js";import{IHostService as Ut}from"../../../services/host/browser/host.js";import{ILocaleService as kn}from"../../../services/localization/common/locale.js";import{showWindowLogActionId as Cn}from"../../../services/log/common/logConstants.js";import{IPaneCompositePartService as We}from"../../../services/panecomposite/browser/panecomposite.js";import{IPreferencesService as wn}from"../../../services/preferences/common/preferences.js";import{ITextFileService as gt}from"../../../services/textfile/common/textfiles.js";import{IWorkbenchThemeService as De}from"../../../services/themes/common/workbenchThemeService.js";import{AutoUpdateConfigurationKey as Ln,ExtensionEditorTab as It,ExtensionRuntimeActionType as O,ExtensionState as v,IExtensionsWorkbenchService as S,INSTALL_ACTIONS_GROUP as Tn,SELECT_INSTALL_VSIX_EXTENSION_COMMAND_ID as Pn,THEME_ACTIONS_GROUP as Mn,TOGGLE_IGNORE_EXTENSION_ACTION_ID as Wn,UPDATE_ACTIONS_GROUP as Dn,VIEWLET_ID as Ne}from"../common/extensions.js";import{ExtensionsConfigurationInitialContent as _t}from"../common/extensionsFileTemplate.js";import{errorIcon as Q,infoIcon as M,manageExtensionIcon as Ft,syncEnabledIcon as Nn,syncIgnoredIcon as An,trustIcon as de,warningIcon as f}from"./extensionsIcons.js";let ne=class extends k{constructor(e,t,n,o,r,l,d,x,p,g,it,st,kt,Z){super("extension.promptExtensionInstallFailure");this.extension=e;this.version=t;this.installOperation=n;this.error=o;this.productService=r;this.openerService=l;this.notificationService=d;this.dialogService=x;this.commandService=p;this.logService=g;this.extensionManagementServerService=it;this.instantiationService=st;this.galleryService=kt;this.extensionManifestPropertiesService=Z}async run(){if(wt(this.error))return;if(this.logService.error(this.error),this.error.name===te.Unsupported){const l=ct?s("VS Code for Web","{0} for the Web",this.productService.nameLong):this.productService.nameLong,d=s("cannot be installed","The '{0}' extension is not available in {1}. Click 'More Information' to learn more.",this.extension.displayName||this.extension.identifier.id,l),{confirmed:x}=await this.dialogService.confirm({type:H.Info,message:d,primaryButton:s({key:"more information",comment:["&& denotes a mnemonic"]},"&&More Information"),cancelButton:s("close","Close")});x&&this.openerService.open(ct?ee.parse("https://aka.ms/vscode-web-extensions-guide"):ee.parse("https://aka.ms/vscode-remote"));return}if(te.ReleaseVersionNotFound===this.error.name){await this.dialogService.prompt({type:"error",message:at(this.error),buttons:[{label:s("install prerelease","Install Pre-Release"),run:()=>{const l=this.instantiationService.createInstance(C,{installPreReleaseVersion:!0});return l.extension=this.extension,l.run()}}],cancelButton:s("cancel","Cancel")});return}if([te.Incompatible,te.IncompatibleApi,te.IncompatibleTargetPlatform,te.Malicious,te.Deprecated].includes(this.error.name)){await this.dialogService.info(at(this.error));return}if(te.Signature===this.error.name){await this.dialogService.prompt({type:"error",message:s("signature verification failed","{0} cannot verify the '{1}' extension. Are you sure you want to install it?",this.productService.nameLong,this.extension.displayName||this.extension.identifier.id),buttons:[{label:s("install anyway","Install Anyway"),run:()=>{const l=this.instantiationService.createInstance(C,{donotVerifySignature:!0});return l.extension=this.extension,l.run()}}],cancelButton:s("cancel","Cancel")});return}const e=this.installOperation===Le.Update?s("update operation","Error while updating '{0}' extension.",this.extension.displayName||this.extension.identifier.id):s("install operation","Error while installing '{0}' extension.",this.extension.displayName||this.extension.identifier.id);let t;const n=[],o=await this.getDownloadUrl();o&&(t=s("check logs","Please check the [log]({0}) for more details.",`command:${Cn}`),n.push({label:s("download","Try Downloading Manually..."),run:()=>this.openerService.open(o).then(()=>{this.notificationService.prompt(H.Info,s("install vsix","Once downloaded, please manually install the downloaded VSIX of '{0}'.",this.extension.identifier.id),[{label:s("installVSIX","Install from VSIX..."),run:()=>this.commandService.executeCommand(Pn)}])})}));const r=`${e}${t?` ${t}`:""}`;this.notificationService.prompt(H.Error,r,n)}async getDownloadUrl(){if(zt||!this.extension.gallery||!this.productService.extensionsGallery||!this.extensionManagementServerService.localExtensionManagementServer&&!this.extensionManagementServerService.remoteExtensionManagementServer)return;let e=this.extension.gallery.properties.targetPlatform;if(e!==_e.UNIVERSAL&&e!==_e.UNDEFINED&&this.extensionManagementServerService.remoteExtensionManagementServer)try{const t=await this.galleryService.getManifest(this.extension.gallery,le.None);t&&this.extensionManifestPropertiesService.prefersExecuteOnWorkspace(t)&&(e=await this.extensionManagementServerService.remoteExtensionManagementServer.extensionManagementService.getTargetPlatform())}catch(t){this.logService.error(t);return}if(e!==_e.UNKNOWN)return ee.parse(`${this.productService.extensionsGallery.serviceUrl}/publishers/${this.extension.publisher}/vsextensions/${this.extension.name}/${this.version}/vspackage${e!==_e.UNDEFINED?`?targetPlatform=${e}`:""}`)}};ne=u([i(4,xt),i(5,$t),i(6,Pe),i(7,we),i(8,ut),i(9,vt),i(10,B),i(11,E),i(12,Ve),i(13,Ie)],ne);class h extends k{_onDidChange=this._register(new Lt);onDidChange=this._onDidChange.event;static EXTENSION_ACTION_CLASS="extension-action";static TEXT_ACTION_CLASS=`${h.EXTENSION_ACTION_CLASS} text`;static LABEL_ACTION_CLASS=`${h.EXTENSION_ACTION_CLASS} label`;static PROMINENT_LABEL_ACTION_CLASS=`${h.LABEL_ACTION_CLASS} prominent`;static ICON_ACTION_CLASS=`${h.EXTENSION_ACTION_CLASS} icon`;_extension=null;get extension(){return this._extension}set extension(a){this._extension=a,this.update()}_hidden=!1;get hidden(){return this._hidden}set hidden(a){this._hidden!==a&&(this._hidden=a,this._onDidChange.fire({hidden:a}))}_setEnabled(a){super._setEnabled(a),this.hideOnDisabled&&(this.hidden=!a)}hideOnDisabled=!0}class Et extends h{constructor(e,t,n){t=`${t} action-dropdown`;super(e,void 0,t);this.actionsGroups=n;this.menuActionClassNames=t.split(" "),this.hideOnDisabled=!1,this.extensionActions=n.flat(),this.update(),this._register(Ce.any(...this.extensionActions.map(o=>o.onDidChange))(()=>this.update(!0))),this.extensionActions.forEach(o=>this._register(o))}primaryAction;menuActionClassNames=[];_menuActions=[];get menuActions(){return[...this._menuActions]}get extension(){return super.extension}set extension(e){this.extensionActions.forEach(t=>t.extension=e),super.extension=e}extensionActions;update(e){e||this.extensionActions.forEach(o=>o.update());const t=this.actionsGroups.map(o=>o.filter(r=>!r.hidden));let n=[];for(const o of t)o.length&&(n=[...n,...o,new Ct]);n=n.length?n.slice(0,n.length-1):n,this.primaryAction=n[0],this._menuActions=n.length>1?n:[],this._onDidChange.fire({menuActions:this._menuActions}),this.primaryAction?(this.hidden=!1,this.enabled=this.primaryAction.enabled,this.label=this.getLabel(this.primaryAction),this.tooltip=this.primaryAction.tooltip):(this.hidden=!0,this.enabled=!1)}async run(){this.enabled&&await this.primaryAction?.run()}getLabel(e){return e.label}}class Ds extends Xt{constructor(a,e,t){super(null,a,e,t),this._register(a.onDidChange(n=>{(n.hidden!==void 0||n.menuActions!==void 0)&&this.updateClass()}))}render(a){super.render(a),this.updateClass()}updateClass(){if(super.updateClass(),this.element&&this.dropdownMenuActionViewItem?.element){this.element.classList.toggle("hide",this._action.hidden);const a=this._action.menuActions.length===0;this.element.classList.toggle("empty",a),this.dropdownMenuActionViewItem.element.classList.toggle("hide",a)}}}let C=class extends h{constructor(e,t,n,o,r,l,d,x,p,g){super("extensions.install",s("install","Install"),C.CLASS,!1);this.extensionsWorkbenchService=t;this.instantiationService=n;this.runtimeExtensionService=o;this.workbenchThemeService=r;this.labelService=l;this.dialogService=d;this.preferencesService=x;this.telemetryService=p;this.contextService=g;this.hideOnDisabled=!1,this.options={isMachineScoped:!1,...e},this.update(),this._register(this.labelService.onDidChangeFormatters(()=>this.updateLabel(),this))}static CLASS=`${this.LABEL_ACTION_CLASS} prominent install`;static HIDE=`${this.CLASS} hide`;_manifest=null;set manifest(e){this._manifest=e,this.updateLabel()}updateThrottler=new ot;options;update(){this.updateThrottler.queue(()=>this.computeAndUpdateEnablement())}async computeAndUpdateEnablement(){this.enabled=!1,this.class=C.HIDE,this.hidden=!0,this.extension&&(this.extension.isBuiltin||this.extensionsWorkbenchService.canSetLanguage(this.extension)||this.extension.state===v.Uninstalled&&(this.options.installPreReleaseVersion&&!this.extension.hasPreReleaseVersion||!this.options.installPreReleaseVersion&&!this.extension.hasReleaseVersion||(this.hidden=!1,this.class=C.CLASS,await this.extensionsWorkbenchService.canInstall(this.extension)&&(this.enabled=!0,this.updateLabel()))))}async run(){if(!this.extension)return;if(this.extension.deprecationInfo){let t=s("deprecated message","This extension is deprecated as it is no longer being maintained."),n;(g=>(g[g.InstallAnyway=0]="InstallAnyway",g[g.ShowAlternateExtension=1]="ShowAlternateExtension",g[g.ConfigureSettings=2]="ConfigureSettings",g[g.Cancel=3]="Cancel"))(n||={});const o=[{label:s("install anyway","Install Anyway"),run:()=>0}];if(this.extension.deprecationInfo.extension){t=s("deprecated with alternate extension message","This extension is deprecated. Use the {0} extension instead.",this.extension.deprecationInfo.extension.displayName);const l=this.extension.deprecationInfo.extension;o.push({label:s({key:"Show alternate extension",comment:["&& denotes a mnemonic"]},"&&Open {0}",this.extension.deprecationInfo.extension.displayName),run:async()=>{const[d]=await this.extensionsWorkbenchService.getExtensions([{id:l.id,preRelease:l.preRelease}],le.None);return await this.extensionsWorkbenchService.open(d),1}})}else if(this.extension.deprecationInfo.settings){t=s("deprecated with alternate settings message","This extension is deprecated as this functionality is now built-in to VS Code.");const l=this.extension.deprecationInfo.settings;o.push({label:s({key:"configure in settings",comment:["&& denotes a mnemonic"]},"&&Configure Settings"),run:async()=>(await this.preferencesService.openSettings({query:l.map(d=>`@id:${d}`).join(" ")}),2)})}else this.extension.deprecationInfo.additionalInfo&&(t=new m(`${t} ${this.extension.deprecationInfo.additionalInfo}`));const{result:r}=await this.dialogService.prompt({type:H.Warning,message:s("install confirmation","Are you sure you want to install '{0}'?",this.extension.displayName),detail:Tt(t)?t:void 0,custom:Tt(t)?void 0:{markdownDetails:[{markdown:t}]},buttons:o,cancelButton:{run:()=>3}});if(r!==0)return}this.extensionsWorkbenchService.open(this.extension,{showPreReleaseVersion:this.options.installPreReleaseVersion}),L(s("installExtensionStart","Installing extension {0} started. An editor is now open with more details on this extension",this.extension.displayName)),this.telemetryService.publicLog("extensions:action:install",{...this.extension.telemetryData,actionId:this.id});const e=await this.install(this.extension);if(e?.local){L(s("installExtensionComplete","Installing extension {0} is completed.",this.extension.displayName));const t=await this.getRunningExtension(e.local);if(t&&!(t.activationEvents&&t.activationEvents.some(n=>n.startsWith("onLanguage")))){const n=await this.getThemeAction(e);if(n){n.extension=e;try{return n.run({showCurrentTheme:!0,ignoreFocusLost:!0})}finally{n.dispose()}}}}}async getThemeAction(e){if((await this.workbenchThemeService.getColorThemes()).some(r=>V(r,e)))return this.instantiationService.createInstance(A);if((await this.workbenchThemeService.getFileIconThemes()).some(r=>V(r,e)))return this.instantiationService.createInstance(R);if((await this.workbenchThemeService.getProductIconThemes()).some(r=>V(r,e)))return this.instantiationService.createInstance($)}async install(e){try{return await this.extensionsWorkbenchService.install(e,this.options)}catch(t){await this.instantiationService.createInstance(ne,e,e.latestVersion,Le.Install,t).run();return}}async getRunningExtension(e){const t=await this.runtimeExtensionService.getExtension(e.identifier.id);return t||(this.runtimeExtensionService.canAddExtension(Qe(e))?new Promise((n,o)=>{const r=this.runtimeExtensionService.onDidChangeExtensions(async()=>{const l=await this.runtimeExtensionService.getExtension(e.identifier.id);l&&(r.dispose(),n(l))})}):null)}updateLabel(){this.label=this.getLabel()}getLabel(e){return this.extension?.isWorkspaceScoped&&this.extension.resourceExtension&&this.contextService.isInsideWorkspace(this.extension.resourceExtension.location)?s("install workspace version","Install Workspace Extension"):this.options.installPreReleaseVersion&&this.extension?.hasPreReleaseVersion?e?s("install pre-release","Install Pre-Release"):s("install pre-release version","Install Pre-Release Version"):this.extension?.hasPreReleaseVersion?e?s("install","Install"):s("install release version","Install Release Version"):s("install","Install")}};C=u([i(1,S),i(2,E),i(3,W),i(4,De),i(5,Rt),i(6,we),i(7,wn),i(8,Bt),i(9,ge)],C);let Ke=class extends Et{set manifest(a){this.extensionActions.forEach(e=>e.manifest=a),this.update()}constructor(a,e){super("extensions.installActions",C.CLASS,[[a.createInstance(C,{installPreReleaseVersion:e.preferPreReleases}),a.createInstance(C,{installPreReleaseVersion:!e.preferPreReleases})]])}getLabel(a){return a.getLabel(!0)}};Ke=u([i(0,E),i(1,S)],Ke);class nt extends h{static LABEL=s("installing","Installing");static CLASS=`${h.LABEL_ACTION_CLASS} install installing`;constructor(){super("extension.installing",nt.LABEL,nt.CLASS,!1)}update(){this.class=`${nt.CLASS}${this.extension&&this.extension.state===v.Installing?"":" hide"}`}}let y=class extends h{constructor(e,t,n,o,r,l){super(e,y.INSTALL_LABEL,y.Class,!1);this.server=t;this.canInstallAnyWhere=n;this.extensionsWorkbenchService=o;this.extensionManagementServerService=r;this.extensionManifestPropertiesService=l;this.update()}static INSTALL_LABEL=s("install","Install");static INSTALLING_LABEL=s("installing","Installing");static Class=`${h.LABEL_ACTION_CLASS} prominent install-other-server`;static InstallingClass=`${h.LABEL_ACTION_CLASS} install-other-server installing`;updateWhenCounterExtensionChanges=!0;update(){if(this.enabled=!1,this.class=y.Class,this.canInstall()){const e=this.extensionsWorkbenchService.installed.filter(t=>T(t.identifier,this.extension.identifier)&&t.server===this.server)[0];e?e.state===v.Installing&&!e.local&&(this.enabled=!0,this.label=y.INSTALLING_LABEL,this.class=y.InstallingClass):(this.enabled=!0,this.label=this.getInstallLabel())}}canInstall(){return!this.extension||!this.server||!this.extension.local||this.extension.state!==v.Installed||this.extension.type!==Nt.User||this.extension.enablementState===b.DisabledByEnvironment||this.extension.enablementState===b.DisabledByTrustRequirement||this.extension.enablementState===b.DisabledByVirtualWorkspace?!1:!!(At(this.extension.local.manifest)||this.server===this.extensionManagementServerService.localExtensionManagementServer&&this.extensionManifestPropertiesService.prefersExecuteOnUI(this.extension.local.manifest)||this.server===this.extensionManagementServerService.remoteExtensionManagementServer&&this.extensionManifestPropertiesService.prefersExecuteOnWorkspace(this.extension.local.manifest)||this.server===this.extensionManagementServerService.webExtensionManagementServer&&this.extensionManifestPropertiesService.prefersExecuteOnWeb(this.extension.local.manifest)||this.canInstallAnyWhere&&(this.server===this.extensionManagementServerService.localExtensionManagementServer&&this.extensionManifestPropertiesService.canExecuteOnUI(this.extension.local.manifest)||this.server===this.extensionManagementServerService.remoteExtensionManagementServer&&this.extensionManifestPropertiesService.canExecuteOnWorkspace(this.extension.local.manifest)))}async run(){if(this.extension?.local&&this.extension?.server&&this.server)return this.extensionsWorkbenchService.open(this.extension),L(s("installExtensionStart","Installing extension {0} started. An editor is now open with more details on this extension",this.extension.displayName)),this.extensionsWorkbenchService.installInServer(this.extension,this.server)}};y=u([i(3,S),i(4,B),i(5,Ie)],y);let Ae=class extends y{constructor(a,e,t,n){super("extensions.remoteinstall",t.remoteExtensionManagementServer,a,e,t,n)}getInstallLabel(){return this.extensionManagementServerService.remoteExtensionManagementServer?s({key:"install in remote",comment:["This is the name of the action to install an extension in remote server. Placeholder is for the name of remote server."]},"Install in {0}",this.extensionManagementServerService.remoteExtensionManagementServer.label):y.INSTALL_LABEL}};Ae=u([i(1,S),i(2,B),i(3,Ie)],Ae);let Xe=class extends y{constructor(a,e,t){super("extensions.localinstall",e.localExtensionManagementServer,!1,a,e,t)}getInstallLabel(){return s("install locally","Install Locally")}};Xe=u([i(0,S),i(1,B),i(2,Ie)],Xe);let je=class extends y{constructor(a,e,t){super("extensions.webInstall",e.webExtensionManagementServer,!1,a,e,t)}getInstallLabel(){return s("install browser","Install in Browser")}};je=u([i(0,S),i(1,B),i(2,Ie)],je);let w=class extends h{constructor(e,t){super("extensions.uninstall",w.UninstallLabel,w.UninstallClass,!1);this.extensionsWorkbenchService=e;this.dialogService=t;this.update()}static UninstallLabel=s("uninstallAction","Uninstall");static UninstallingLabel=s("Uninstalling","Uninstalling");static UninstallClass=`${h.LABEL_ACTION_CLASS} uninstall`;static UnInstallingClass=`${h.LABEL_ACTION_CLASS} uninstall uninstalling`;update(){if(!this.extension){this.enabled=!1;return}const e=this.extension.state;if(e===v.Uninstalling){this.label=w.UninstallingLabel,this.class=w.UnInstallingClass,this.enabled=!1;return}if(this.label=w.UninstallLabel,this.class=w.UninstallClass,this.tooltip=w.UninstallLabel,e!==v.Installed){this.enabled=!1;return}if(this.extension.isBuiltin){this.enabled=!1;return}this.enabled=!0}async run(){if(this.extension){L(s("uninstallExtensionStart","Uninstalling extension {0} started.",this.extension.displayName));try{await this.extensionsWorkbenchService.uninstall(this.extension),L(s("uninstallExtensionComplete","Please reload Visual Studio Code to complete the uninstallation of the extension {0}.",this.extension.displayName))}catch(e){wt(e)||this.dialogService.error(at(e))}}}};w=u([i(0,S),i(1,we)],w);let Y=class extends h{constructor(e,t,n,o,r){super("extensions.update",s("update","Update"),Y.DisabledClass,!1);this.verbose=e;this.extensionsWorkbenchService=t;this.dialogService=n;this.openerService=o;this.instantiationService=r;this.update()}static EnabledClass=`${this.LABEL_ACTION_CLASS} prominent update`;static DisabledClass=`${this.EnabledClass} disabled`;updateThrottler=new ot;update(){this.updateThrottler.queue(()=>this.computeAndUpdateEnablement()),this.extension&&(this.label=this.verbose?s("update to","Update to v{0}",this.extension.latestVersion):s("update","Update"))}async computeAndUpdateEnablement(){if(this.enabled=!1,this.class=Y.DisabledClass,!this.extension||this.extension.deprecationInfo)return;const e=await this.extensionsWorkbenchService.canInstall(this.extension),t=this.extension.state===v.Installed;this.enabled=e&&t&&this.extension.outdated,this.class=this.enabled?Y.EnabledClass:Y.DisabledClass}async run(){if(!this.extension)return;const e=await this.extensionsWorkbenchService.shouldRequireConsentToUpdate(this.extension);if(e){const{result:t}=await this.dialogService.prompt({type:"warning",title:s("updateExtensionConsentTitle","Update {0} Extension",this.extension.displayName),message:s("updateExtensionConsent",`{0}

Would you like to update the extension?`,e),buttons:[{label:s("update","Update"),run:()=>"update"},{label:s("review","Review"),run:()=>"review"},{label:s("cancel","Cancel"),run:()=>"cancel"}]});if(t==="cancel")return;if(t==="review")return this.extension.hasChangelog()?this.extensionsWorkbenchService.open(this.extension,{tab:It.Changelog}):this.extension.repository?this.openerService.open(this.extension.repository):this.extensionsWorkbenchService.open(this.extension)}return L(s("updateExtensionStart","Updating extension {0} to version {1} started.",this.extension.displayName,this.extension.latestVersion)),this.install(this.extension)}async install(e){try{await this.extensionsWorkbenchService.install(e,e.local?.preRelease?{installPreReleaseVersion:!0}:void 0),L(s("updateExtensionComplete","Updating extension {0} to version {1} completed.",e.displayName,e.latestVersion))}catch(t){this.instantiationService.createInstance(ne,e,e.latestVersion,Le.Update,t).run()}}};Y=u([i(1,S),i(2,we),i(3,$t),i(4,E)],Y);let N=class extends h{constructor(e,t,n){super(N.ID,N.LABEL.value,N.DisabledClass);this.extensionsWorkbenchService=e;this.extensionEnablementService=t;this._register(n.onDidChangeConfiguration(o=>{o.affectsConfiguration(Ln)&&this.update()})),this.update()}static ID="workbench.extensions.action.toggleAutoUpdateForExtension";static LABEL=fe("enableAutoUpdateLabel","Auto Update");static EnabledClass=`${h.EXTENSION_ACTION_CLASS} auto-update`;static DisabledClass=`${this.EnabledClass} hide`;update(){this.enabled=!1,this.class=N.DisabledClass,this.extension&&(this.extension.isBuiltin||this.extension.deprecationInfo?.disallowInstall||this.extensionsWorkbenchService.getAutoUpdateValue()==="onlyEnabledExtensions"&&!this.extensionEnablementService.isEnabledEnablementState(this.extension.enablementState)||(this.enabled=!0,this.class=N.EnabledClass,this.checked=this.extensionsWorkbenchService.isAutoUpdateEnabledFor(this.extension)))}async run(){if(!this.extension)return;const e=!this.extensionsWorkbenchService.isAutoUpdateEnabledFor(this.extension);await this.extensionsWorkbenchService.updateAutoUpdateEnablementFor(this.extension,e),e?L(s("enableAutoUpdate","Enabled auto updates for",this.extension.displayName)):L(s("disableAutoUpdate","Disabled auto updates for",this.extension.displayName))}};N=u([i(0,S),i(1,P),i(2,Mt)],N);let ie=class extends h{constructor(e){super(ie.ID,ie.LABEL);this.extensionsWorkbenchService=e}static ID="workbench.extensions.action.toggleAutoUpdatesForPublisher";static LABEL=s("toggleAutoUpdatesForPublisherLabel","Auto Update All (From Publisher)");update(){}async run(){if(!this.extension)return;L(s("ignoreExtensionUpdatePublisher","Ignoring updates published by {0}.",this.extension.publisherDisplayName));const e=!this.extensionsWorkbenchService.isAutoUpdateEnabledFor(this.extension.publisher);await this.extensionsWorkbenchService.updateAutoUpdateEnablementFor(this.extension.publisher,e),e?L(s("enableAutoUpdate","Enabled auto updates for",this.extension.displayName)):L(s("disableAutoUpdate","Disabled auto updates for",this.extension.displayName))}};ie=u([i(0,S)],ie);let se=class extends h{constructor(e,t){super("extensionsAction.migrateDeprecatedExtension",s("migrateExtension","Migrate"),se.DisabledClass,!1);this.small=e;this.extensionsWorkbenchService=t;this.update()}static EnabledClass=`${h.LABEL_ACTION_CLASS} migrate`;static DisabledClass=`${this.EnabledClass} disabled`;update(){if(this.enabled=!1,this.class=se.DisabledClass,!this.extension?.local||this.extension.state!==v.Installed||!this.extension.deprecationInfo?.extension)return;const e=this.extension.deprecationInfo.extension.id;this.extensionsWorkbenchService.local.some(t=>T(t.identifier,{id:e}))||(this.enabled=!0,this.class=se.EnabledClass,this.tooltip=s("migrate to","Migrate to {0}",this.extension.deprecationInfo.extension.displayName),this.label=this.small?s("migrate","Migrate"):this.tooltip)}async run(){if(!this.extension?.deprecationInfo?.extension)return;const e=this.extension.local;await this.extensionsWorkbenchService.uninstall(this.extension);const[t]=await this.extensionsWorkbenchService.getExtensions([{id:this.extension.deprecationInfo.extension.id,preRelease:this.extension.deprecationInfo?.extension?.preRelease}],le.None);await this.extensionsWorkbenchService.install(t,{isMachineScoped:e?.isMachineScoped})}};se=u([i(1,S)],se);let he=class extends h{constructor(e,t,n,o,r){super(e,t,n,o);this.instantiationService=r}_actionViewItem=null;createActionViewItem(e){return this._actionViewItem=this.instantiationService.createInstance(Re,this,e),this._actionViewItem}run({actionGroups:e,disposeActionsOnHide:t}){return this._actionViewItem?.showMenu(e,t),Promise.resolve()}};he=u([i(4,E)],he);let Re=class extends Kt{constructor(e,t,n){super(null,e,{...t,icon:!0,label:!0});this.contextMenuService=n}showMenu(e,t){if(this.element){const n=this.getActions(e),o=Qt.getDomNodePagePosition(this.element),r={x:o.left,y:o.top+o.height+10};this.contextMenuService.showContextMenu({getAnchor:()=>r,getActions:()=>n,actionRunner:this.actionRunner,onHide:()=>{t&&Yt(n)}})}}getActions(e){let t=[];for(const n of e)t=[...t,...n,new Ct];return t.length?t.slice(0,t.length-1):t}};Re=u([i(2,nn)],Re);async function Gt(c,a,e){return e.invokeFunction(async t=>{const n=t.get(S),o=t.get(P),r=t.get(Zt),l=t.get(yn),d=t.get(ft),x=t.get(De),p=[];if(c){switch(p.push(["extension",c.identifier.id]),p.push(["isBuiltinExtension",c.isBuiltin]),p.push(["isDefaultApplicationScopedExtension",c.local&&rn(c.local.manifest)]),p.push(["isApplicationScopedExtension",c.local&&c.local.isApplicationScoped]),p.push(["isWorkspaceScopedExtension",c.isWorkspaceScoped]),p.push(["isGalleryExtension",!!c.identifier.uuid]),c.local&&p.push(["extensionSource",c.local.source]),p.push(["extensionHasConfiguration",c.local&&!!c.local.manifest.contributes&&!!c.local.manifest.contributes.configuration]),p.push(["extensionHasKeybindings",c.local&&!!c.local.manifest.contributes&&!!c.local.manifest.contributes.keybindings]),p.push(["extensionHasCommands",c.local&&!!c.local.manifest.contributes&&!!c.local.manifest.contributes?.commands]),p.push(["isExtensionRecommended",!!l.getAllRecommendationsWithReason()[c.identifier.id.toLowerCase()]]),p.push(["isExtensionWorkspaceRecommended",l.getAllRecommendationsWithReason()[c.identifier.id.toLowerCase()]?.reasonId===En.Workspace]),p.push(["isUserIgnoredRecommendation",d.globalIgnoredRecommendations.some(Z=>Z===c.identifier.id.toLowerCase())]),p.push(["isExtensionPinned",c.pinned]),p.push(["isExtensionEnabled",o.isEnabledEnablementState(c.enablementState)]),c.state){case v.Installing:p.push(["extensionStatus","installing"]);break;case v.Installed:p.push(["extensionStatus","installed"]);break;case v.Uninstalling:p.push(["extensionStatus","uninstalling"]);break;case v.Uninstalled:p.push(["extensionStatus","uninstalled"]);break}p.push(["installedExtensionIsPreReleaseVersion",!!c.local?.isPreReleaseVersion]),p.push(["installedExtensionIsOptedToPreRelease",!!c.local?.preRelease]),p.push(["galleryExtensionIsPreReleaseVersion",!!c.gallery?.properties.isPreReleaseVersion]),p.push(["galleryExtensionHasPreReleaseVersion",c.gallery?.hasPreReleaseVersion]),p.push(["extensionHasPreReleaseVersion",c.hasPreReleaseVersion]),p.push(["extensionHasReleaseVersion",c.hasReleaseVersion]),p.push(["extensionDisallowInstall",!!c.deprecationInfo?.disallowInstall]);const[it,st,kt]=await Promise.all([x.getColorThemes(),x.getFileIconThemes(),x.getProductIconThemes()]);p.push(["extensionHasColorThemes",it.some(Z=>V(Z,c))]),p.push(["extensionHasFileIconThemes",st.some(Z=>V(Z,c))]),p.push(["extensionHasProductIconThemes",kt.some(Z=>V(Z,c))]),p.push(["canSetLanguage",n.canSetLanguage(c)]),p.push(["isActiveLanguagePackExtension",c.gallery&&dt===pt(c.gallery)])}return r.getMenuActions(en.ExtensionContext,a.createOverlay(p),{shouldForwardArgs:!0})})}function $e(c,a){const e=[];for(const[,t]of c)e.push(t.map(n=>n instanceof jt?n:a.createInstance(Be,n)));return e}async function Rn(c,a,e){const t=await Gt(c,a,e);return $e(t,e)}let z=class extends he{constructor(e,t,n){super(z.ID,"","",!0,e);this.extensionService=t;this.contextKeyService=n;this.tooltip=s("manage","Manage"),this.update()}static ID="extensions.manage";static Class=`${h.ICON_ACTION_CLASS} manage `+I.asClassName(Ft);static HideManageExtensionClass=`${this.Class} hide`;async getActionGroups(){const e=[],t=await Gt(this.extension,this.contextKeyService,this.instantiationService),n=[],o=[],r=[],l=[];for(const[d,x]of t)d===Tn?o.push(...$e([[d,x]],this.instantiationService)[0]):d===Dn?r.push(...$e([[d,x]],this.instantiationService)[0]):d===Mn?n.push(...$e([[d,x]],this.instantiationService)[0]):l.push(...$e([[d,x]],this.instantiationService));return n.length&&e.push(n),e.push([this.instantiationService.createInstance(X),this.instantiationService.createInstance(K)]),e.push([this.instantiationService.createInstance(J),this.instantiationService.createInstance(j)]),r.length&&e.push(r),e.push([...o.length?o:[],this.instantiationService.createInstance(U,this.extension,!1),this.instantiationService.createInstance(w)]),l.forEach(d=>e.push(d)),e.forEach(d=>d.forEach(x=>{x instanceof h&&(x.extension=this.extension)})),e}async run(){return await this.extensionService.whenInstalledExtensionsRegistered(),super.run({actionGroups:await this.getActionGroups(),disposeActionsOnHide:!0})}update(){if(this.class=z.HideManageExtensionClass,this.enabled=!1,this.extension){const e=this.extension.state;this.enabled=e===v.Installed,this.class=this.enabled||e===v.Uninstalling?z.Class:z.HideManageExtensionClass}}};z=u([i(0,E),i(1,W),i(2,tn)],z);class Ns extends he{constructor(e,t){super("extensionEditor.manageExtension","",`${h.ICON_ACTION_CLASS} manage ${I.asClassName(Ft)}`,!0,t);this.contextKeyService=e;this.tooltip=s("manage","Manage")}update(){}async run(){const e=[];return(await Rn(this.extension,this.contextKeyService,this.instantiationService)).forEach(t=>e.push(t)),e.forEach(t=>t.forEach(n=>{n instanceof h&&(n.extension=this.extension)})),super.run({actionGroups:e,disposeActionsOnHide:!0})}}let Be=class extends h{constructor(e,t){super(e.id,e.label);this.action=e;this.extensionsWorkbenchService=t}get enabled(){return this.action.enabled}set enabled(e){this.action.enabled=e}update(){this.extension&&(this.action.id===Wn?this.checked=!this.extensionsWorkbenchService.isExtensionIgnoredToSync(this.extension):this.action.id===N.ID?this.checked=this.extensionsWorkbenchService.isAutoUpdateEnabledFor(this.extension):this.action.id===ie.ID?this.checked=this.extensionsWorkbenchService.isAutoUpdateEnabledFor(this.extension.publisher):this.checked=this.action.checked)}async run(){if(this.extension){const e=this.extension.local?Wt(this.extension.local.manifest.publisher,this.extension.local.manifest.name):this.extension.gallery?Wt(this.extension.gallery.publisher,this.extension.gallery.name):this.extension.identifier.id,t={id:this.extension.identifier.id,version:this.extension.version,location:this.extension.local?.location};await this.action.run(e,t)}}};Be=u([i(1,S)],Be);let _=class extends h{constructor(e){super(_.ID,_.LABEL,_.DisabledClass);this.extensionsWorkbenchService=e;this.update()}static ID="workbench.extensions.action.togglePreRlease";static LABEL=s("togglePreRleaseLabel","Pre-Release");static EnabledClass=`${h.LABEL_ACTION_CLASS} pre-release`;static DisabledClass=`${this.EnabledClass} hide`;update(){this.enabled=!1,this.class=_.DisabledClass,this.extension&&(this.extension.isBuiltin||this.extension.state===v.Installed&&this.extension.hasPreReleaseVersion&&this.extension.gallery&&(this.extension.preRelease&&!this.extension.isPreReleaseVersion||!this.extension.preRelease&&!this.extension.gallery.hasPreReleaseVersion||(this.enabled=!0,this.class=_.EnabledClass,this.extension.preRelease?(this.label=s("togglePreRleaseDisableLabel","Switch to Release Version"),this.tooltip=s("togglePreRleaseDisableTooltip","This will switch and enable updates to release versions")):(this.label=s("switchToPreReleaseLabel","Switch to Pre-Release Version"),this.tooltip=s("switchToPreReleaseTooltip","This will switch to pre-release version and enable updates to latest version always")))))}async run(){this.extension&&(this.extensionsWorkbenchService.open(this.extension,{showPreReleaseVersion:!this.extension.preRelease}),await this.extensionsWorkbenchService.togglePreRelease(this.extension))}};_=u([i(0,S)],_);let U=class extends h{constructor(e,t,n,o,r,l,d,x){super(U.ID,U.LABEL,h.LABEL_ACTION_CLASS);this.whenInstalled=t;this.extensionsWorkbenchService=n;this.extensionManagementService=o;this.extensionGalleryService=r;this.quickInputService=l;this.instantiationService=d;this.dialogService=x;this.extension=e,this.update()}static ID="workbench.extensions.action.install.anotherVersion";static LABEL=s("install another version","Install Specific Version...");update(){this.enabled=!!this.extension&&!this.extension.isBuiltin&&!!this.extension.identifier.uuid&&!this.extension.deprecationInfo,this.enabled&&this.whenInstalled&&(this.enabled=!!this.extension?.local&&!!this.extension.server&&this.extension.state===v.Installed)}async run(){if(!this.enabled||!this.extension)return;const e=this.extension.server?await this.extension.server.extensionManagementService.getTargetPlatform():await this.extensionManagementService.getTargetPlatform(),t=await this.extensionGalleryService.getAllCompatibleVersions(this.extension.identifier,this.extension.local?.preRelease??this.extension.gallery?.properties.isPreReleaseVersion??!1,e);if(!t.length){await this.dialogService.info(s("no versions","This extension has no other versions."));return}const n=t.map((r,l)=>({id:r.version,label:r.version,description:`${Jt(new Date(Date.parse(r.date)),!0)}${r.isPreReleaseVersion?` (${s("pre-release","pre-release")})`:""}${r.version===this.extension?.local?.manifest.version?` (${s("current","current")})`:""}`,ariaLabel:`${r.isPreReleaseVersion?"Pre-Release version":"Release version"} ${r.version}`,isPreReleaseVersion:r.isPreReleaseVersion})),o=await this.quickInputService.pick(n,{placeHolder:s("selectVersion","Select Version to Install"),matchOnDetail:!0});if(o){if(this.extension.local?.manifest.version===o.id)return;try{await this.extensionsWorkbenchService.install(this.extension,{installPreReleaseVersion:o.isPreReleaseVersion,version:o.id})}catch(r){this.instantiationService.createInstance(ne,this.extension,o.id,Le.Install,r).run()}}return null}};U=u([i(2,S),i(3,In),i(4,Ve),i(5,q),i(6,E),i(7,we)],U);let K=class extends h{constructor(e,t){super(K.ID,K.LABEL,h.LABEL_ACTION_CLASS);this.extensionsWorkbenchService=e;this.extensionEnablementService=t;this.tooltip=s("enableForWorkspaceActionToolTip","Enable this extension only in this workspace"),this.update()}static ID="extensions.enableForWorkspace";static LABEL=s("enableForWorkspaceAction","Enable (Workspace)");update(){this.enabled=!1,this.extension&&this.extension.local&&!this.extension.isWorkspaceScoped&&(this.enabled=this.extension.state===v.Installed&&!this.extensionEnablementService.isEnabled(this.extension.local)&&this.extensionEnablementService.canChangeWorkspaceEnablement(this.extension.local))}async run(){if(this.extension)return this.extensionsWorkbenchService.setEnablement(this.extension,b.EnabledWorkspace)}};K=u([i(0,S),i(1,P)],K);let X=class extends h{constructor(e,t){super(X.ID,X.LABEL,h.LABEL_ACTION_CLASS);this.extensionsWorkbenchService=e;this.extensionEnablementService=t;this.tooltip=s("enableGloballyActionToolTip","Enable this extension"),this.update()}static ID="extensions.enableGlobally";static LABEL=s("enableGloballyAction","Enable");update(){this.enabled=!1,this.extension&&this.extension.local&&!this.extension.isWorkspaceScoped&&(this.enabled=this.extension.state===v.Installed&&this.extensionEnablementService.isDisabledGlobally(this.extension.local)&&this.extensionEnablementService.canChangeEnablement(this.extension.local))}async run(){if(this.extension)return this.extensionsWorkbenchService.setEnablement(this.extension,b.EnabledGlobally)}};X=u([i(0,S),i(1,P)],X);let j=class extends h{constructor(e,t,n,o){super(j.ID,j.LABEL,h.LABEL_ACTION_CLASS);this.workspaceContextService=e;this.extensionsWorkbenchService=t;this.extensionEnablementService=n;this.extensionService=o;this.tooltip=s("disableForWorkspaceActionToolTip","Disable this extension only in this workspace"),this.update(),this._register(this.extensionService.onDidChangeExtensions(()=>this.update()))}static ID="extensions.disableForWorkspace";static LABEL=s("disableForWorkspaceAction","Disable (Workspace)");update(){this.enabled=!1,this.extension&&this.extension.local&&!this.extension.isWorkspaceScoped&&this.extensionService.extensions.some(e=>T({id:e.identifier.value,uuid:e.uuid},this.extension.identifier)&&this.workspaceContextService.getWorkbenchState()!==qe.EMPTY)&&(this.enabled=this.extension.state===v.Installed&&(this.extension.enablementState===b.EnabledGlobally||this.extension.enablementState===b.EnabledWorkspace)&&this.extensionEnablementService.canChangeWorkspaceEnablement(this.extension.local))}async run(){if(this.extension)return this.extensionsWorkbenchService.setEnablement(this.extension,b.DisabledWorkspace)}};j=u([i(0,ge),i(1,S),i(2,P),i(3,W)],j);let J=class extends h{constructor(e,t,n){super(J.ID,J.LABEL,h.LABEL_ACTION_CLASS);this.extensionsWorkbenchService=e;this.extensionEnablementService=t;this.extensionService=n;this.tooltip=s("disableGloballyActionToolTip","Disable this extension"),this.update(),this._register(this.extensionService.onDidChangeExtensions(()=>this.update()))}static ID="extensions.disableGlobally";static LABEL=s("disableGloballyAction","Disable");update(){this.enabled=!1,this.extension&&this.extension.local&&!this.extension.isWorkspaceScoped&&this.extensionService.extensions.some(e=>T({id:e.identifier.value,uuid:e.uuid},this.extension.identifier))&&(this.enabled=this.extension.state===v.Installed&&(this.extension.enablementState===b.EnabledGlobally||this.extension.enablementState===b.EnabledWorkspace)&&this.extensionEnablementService.canChangeEnablement(this.extension.local))}async run(){if(this.extension)return this.extensionsWorkbenchService.setEnablement(this.extension,b.DisabledGlobally)}};J=u([i(0,S),i(1,P),i(2,W)],J);let Je=class extends Et{constructor(a){super("extensions.enable",h.LABEL_ACTION_CLASS,[[a.createInstance(X),a.createInstance(K)]])}};Je=u([i(0,E)],Je);let Ye=class extends Et{constructor(a){super("extensions.disable",h.LABEL_ACTION_CLASS,[[a.createInstance(J),a.createInstance(j)]])}};Ye=u([i(0,E)],Ye);let re=class extends h{constructor(e,t,n,o,r,l){super("extensions.runtimeState","",re.DisabledClass,!1);this.hostService=e;this.extensionsWorkbenchService=t;this.updateService=n;this.extensionService=o;this.productService=r;this.telemetryService=l;this._register(this.extensionService.onDidChangeExtensions(()=>this.update())),this.update()}static EnabledClass=`${h.LABEL_ACTION_CLASS} reload`;static DisabledClass=`${this.EnabledClass} disabled`;updateWhenCounterExtensionChanges=!0;update(){if(this.enabled=!1,this.tooltip="",this.class=re.DisabledClass,!this.extension)return;const e=this.extension.state;if(e===v.Installing||e===v.Uninstalling||this.extension.local&&this.extension.local.manifest&&this.extension.local.manifest.contributes&&this.extension.local.manifest.contributes.localizations&&this.extension.local.manifest.contributes.localizations.length>0)return;const t=this.extension.runtimeState;t&&(this.enabled=!0,this.class=re.EnabledClass,this.tooltip=t.reason,this.label=t.action===O.ReloadWindow?s("reload window","Reload Window"):t.action===O.RestartExtensions?s("restart extensions","Restart Extensions"):t.action===O.QuitAndInstall?s("restart product","Restart to Update"):t.action===O.ApplyUpdate||t.action===O.DownloadUpdate?s("update product","Update {0}",this.productService.nameShort):"")}async run(){const e=this.extension?.runtimeState;if(e?.action){if(this.telemetryService.publicLog2("extensions:runtimestate:action",{action:e.action}),e?.action===O.ReloadWindow)return this.hostService.reload();if(e?.action===O.RestartExtensions)return this.extensionsWorkbenchService.updateRunningExtensions();if(e?.action===O.DownloadUpdate)return this.updateService.downloadUpdate();if(e?.action===O.ApplyUpdate)return this.updateService.applyUpdate();if(e?.action===O.QuitAndInstall)return this.updateService.quitAndInstall()}}};re=u([i(0,Ut),i(1,S),i(2,pn),i(3,W),i(4,xt),i(5,Bt)],re);function V(c,a){return!!(a&&c.extensionData&&Dt.equals(c.extensionData.extensionId,a.identifier.id))}function yt(c,a,e,t){const n=[];for(const o of c)V(o,e)&&!(t&&o===a)&&n.push({label:o.label,id:o.id});return t&&(n.push({type:"separator",label:s("current","current")}),n.push({label:a.label,id:a.id})),n}let A=class extends h{constructor(e,t,n,o){super(A.ID,A.TITLE.value,A.DisabledClass,!1);this.workbenchThemeService=t;this.quickInputService=n;this.extensionEnablementService=o;this._register(Ce.any(e.onDidChangeExtensions,t.onDidColorThemeChange)(()=>this.update(),this)),this.update()}static ID="workbench.extensions.action.setColorTheme";static TITLE=fe("workbench.extensions.action.setColorTheme","Set Color Theme");static EnabledClass=`${h.LABEL_ACTION_CLASS} theme`;static DisabledClass=`${this.EnabledClass} disabled`;update(){this.workbenchThemeService.getColorThemes().then(e=>{this.enabled=this.computeEnablement(e),this.class=this.enabled?A.EnabledClass:A.DisabledClass})}computeEnablement(e){return!!this.extension&&this.extension.state===v.Installed&&this.extensionEnablementService.isEnabledEnablementState(this.extension.enablementState)&&e.some(t=>V(t,this.extension))}async run({showCurrentTheme:e,ignoreFocusLost:t}={showCurrentTheme:!1,ignoreFocusLost:!1}){const n=await this.workbenchThemeService.getColorThemes();if(!this.computeEnablement(n))return;const o=this.workbenchThemeService.getColorTheme(),r=new rt(100),l=yt(n,o,this.extension,e),d=await this.quickInputService.pick(l,{placeHolder:s("select color theme","Select Color Theme"),onDidFocus:x=>r.trigger(()=>this.workbenchThemeService.setColorTheme(x.id,void 0)),ignoreFocusLost:t});return this.workbenchThemeService.setColorTheme(d?d.id:o.id,"auto")}};A=u([i(0,W),i(1,De),i(2,q),i(3,P)],A);let R=class extends h{constructor(e,t,n,o){super(R.ID,R.TITLE.value,R.DisabledClass,!1);this.workbenchThemeService=t;this.quickInputService=n;this.extensionEnablementService=o;this._register(Ce.any(e.onDidChangeExtensions,t.onDidFileIconThemeChange)(()=>this.update(),this)),this.update()}static ID="workbench.extensions.action.setFileIconTheme";static TITLE=fe("workbench.extensions.action.setFileIconTheme","Set File Icon Theme");static EnabledClass=`${h.LABEL_ACTION_CLASS} theme`;static DisabledClass=`${this.EnabledClass} disabled`;update(){this.workbenchThemeService.getFileIconThemes().then(e=>{this.enabled=this.computeEnablement(e),this.class=this.enabled?R.EnabledClass:R.DisabledClass})}computeEnablement(e){return!!this.extension&&this.extension.state===v.Installed&&this.extensionEnablementService.isEnabledEnablementState(this.extension.enablementState)&&e.some(t=>V(t,this.extension))}async run({showCurrentTheme:e,ignoreFocusLost:t}={showCurrentTheme:!1,ignoreFocusLost:!1}){const n=await this.workbenchThemeService.getFileIconThemes();if(!this.computeEnablement(n))return;const o=this.workbenchThemeService.getFileIconTheme(),r=new rt(100),l=yt(n,o,this.extension,e),d=await this.quickInputService.pick(l,{placeHolder:s("select file icon theme","Select File Icon Theme"),onDidFocus:x=>r.trigger(()=>this.workbenchThemeService.setFileIconTheme(x.id,void 0)),ignoreFocusLost:t});return this.workbenchThemeService.setFileIconTheme(d?d.id:o.id,"auto")}};R=u([i(0,W),i(1,De),i(2,q),i(3,P)],R);let $=class extends h{constructor(e,t,n,o){super($.ID,$.TITLE.value,$.DisabledClass,!1);this.workbenchThemeService=t;this.quickInputService=n;this.extensionEnablementService=o;this._register(Ce.any(e.onDidChangeExtensions,t.onDidProductIconThemeChange)(()=>this.update(),this)),this.update()}static ID="workbench.extensions.action.setProductIconTheme";static TITLE=fe("workbench.extensions.action.setProductIconTheme","Set Product Icon Theme");static EnabledClass=`${h.LABEL_ACTION_CLASS} theme`;static DisabledClass=`${this.EnabledClass} disabled`;update(){this.workbenchThemeService.getProductIconThemes().then(e=>{this.enabled=this.computeEnablement(e),this.class=this.enabled?$.EnabledClass:$.DisabledClass})}computeEnablement(e){return!!this.extension&&this.extension.state===v.Installed&&this.extensionEnablementService.isEnabledEnablementState(this.extension.enablementState)&&e.some(t=>V(t,this.extension))}async run({showCurrentTheme:e,ignoreFocusLost:t}={showCurrentTheme:!1,ignoreFocusLost:!1}){const n=await this.workbenchThemeService.getProductIconThemes();if(!this.computeEnablement(n))return;const o=this.workbenchThemeService.getProductIconTheme(),r=new rt(100),l=yt(n,o,this.extension,e),d=await this.quickInputService.pick(l,{placeHolder:s("select product icon theme","Select Product Icon Theme"),onDidFocus:x=>r.trigger(()=>this.workbenchThemeService.setProductIconTheme(x.id,void 0)),ignoreFocusLost:t});return this.workbenchThemeService.setProductIconTheme(d?d.id:o.id,"auto")}};$=u([i(0,W),i(1,De),i(2,q),i(3,P)],$);let F=class extends h{constructor(e){super(F.ID,F.TITLE.value,F.DisabledClass,!1);this.extensionsWorkbenchService=e;this.update()}static ID="workbench.extensions.action.setDisplayLanguage";static TITLE=fe("workbench.extensions.action.setDisplayLanguage","Set Display Language");static EnabledClass=`${h.LABEL_ACTION_CLASS} language`;static DisabledClass=`${this.EnabledClass} disabled`;update(){this.enabled=!1,this.class=F.DisabledClass,this.extension&&this.extensionsWorkbenchService.canSetLanguage(this.extension)&&(this.extension.gallery&&dt===pt(this.extension.gallery)||(this.enabled=!0,this.class=F.EnabledClass))}async run(){return this.extension&&this.extensionsWorkbenchService.setLanguage(this.extension)}};F=u([i(0,S)],F);let G=class extends h{constructor(e,t){super(G.ID,G.TITLE.value,G.DisabledClass,!1);this.extensionsWorkbenchService=e;this.localeService=t;this.update()}static ID="workbench.extensions.action.clearLanguage";static TITLE=fe("workbench.extensions.action.clearLanguage","Clear Display Language");static EnabledClass=`${h.LABEL_ACTION_CLASS} language`;static DisabledClass=`${this.EnabledClass} disabled`;update(){this.enabled=!1,this.class=G.DisabledClass,this.extension&&this.extensionsWorkbenchService.canSetLanguage(this.extension)&&(this.extension.gallery&&dt!==pt(this.extension.gallery)||(this.enabled=!0,this.class=G.EnabledClass))}async run(){return this.extension&&this.localeService.clearLocalePreference()}};G=u([i(0,S),i(1,kn)],G);let ue=class extends k{constructor(e,t,n){super(ue.ID,ue.LABEL,void 0,!1);this.paneCompositeService=t;this.extensionWorkbenchService=n;this.extensionId=e}static ID="workbench.extensions.action.showRecommendedExtension";static LABEL=s("showRecommendedExtension","Show Recommended Extension");extensionId;async run(){const t=(await this.paneCompositeService.openPaneComposite(Ne,Me.Sidebar,!0))?.getViewPaneContainer();t.search(`@id:${this.extensionId}`),t.focus();const[n]=await this.extensionWorkbenchService.getExtensions([{id:this.extensionId}],{source:"install-recommendation"},le.None);return n?this.extensionWorkbenchService.open(n):null}};ue=u([i(1,We),i(2,S)],ue);let pe=class extends k{constructor(e,t,n,o){super(pe.ID,pe.LABEL,void 0,!1);this.paneCompositeService=t;this.instantiationService=n;this.extensionWorkbenchService=o;this.extensionId=e}static ID="workbench.extensions.action.installRecommendedExtension";static LABEL=s("installRecommendedExtension","Install Recommended Extension");extensionId;async run(){const t=(await this.paneCompositeService.openPaneComposite(Ne,Me.Sidebar,!0))?.getViewPaneContainer();t.search(`@id:${this.extensionId}`),t.focus();const[n]=await this.extensionWorkbenchService.getExtensions([{id:this.extensionId}],{source:"install-recommendation"},le.None);if(n){await this.extensionWorkbenchService.open(n);try{await this.extensionWorkbenchService.install(n)}catch(o){this.instantiationService.createInstance(ne,n,n.latestVersion,Le.Install,o).run()}}}};pe=u([i(1,We),i(2,E),i(3,S)],pe);let ve=class extends k{constructor(e,t){super(ve.ID,"Ignore Recommendation");this.extension=e;this.extensionRecommendationsManagementService=t;this.class=ve.Class,this.tooltip=s("ignoreExtensionRecommendation","Do not recommend this extension again"),this.enabled=!0}static ID="extensions.ignore";static Class=`${h.LABEL_ACTION_CLASS} ignore`;run(){return this.extensionRecommendationsManagementService.toggleGlobalIgnoredRecommendation(this.extension.identifier.id,!0),Promise.resolve()}};ve=u([i(1,ft)],ve);let xe=class extends k{constructor(e,t){super(xe.ID,"Undo");this.extension=e;this.extensionRecommendationsManagementService=t;this.class=xe.Class,this.tooltip=s("undo","Undo"),this.enabled=!0}static ID="extensions.ignore";static Class=`${h.LABEL_ACTION_CLASS} undo-ignore`;run(){return this.extensionRecommendationsManagementService.toggleGlobalIgnoredRecommendation(this.extension.identifier.id,!1),Promise.resolve()}};xe=u([i(1,ft)],xe);let Ee=class extends k{constructor(e,t){super("extensions.searchExtensions",s("search recommendations","Search Extensions"),void 0,!0);this.searchValue=e;this.paneCompositeService=t}async run(){const e=(await this.paneCompositeService.openPaneComposite(Ne,Me.Sidebar,!0))?.getViewPaneContainer();e.search(this.searchValue),e.focus()}};Ee=u([i(1,We)],Ee);let ye=class extends k{constructor(e,t,n,o,r,l,d,x){super(e,t);this.contextService=n;this.fileService=o;this.textFileService=r;this.editorService=l;this.jsonEditingService=d;this.textModelResolverService=x}openExtensionsFile(e){return this.getOrCreateExtensionsFile(e).then(({created:t,content:n})=>this.getSelectionPosition(n,e,["recommendations"]).then(o=>this.editorService.openEditor({resource:e,options:{pinned:t,selection:o}})),t=>Promise.reject(new Error(s("OpenExtensionsFile.failed","Unable to create 'extensions.json' file inside the '.vscode' folder ({0}).",t))))}openWorkspaceConfigurationFile(e){return this.getOrUpdateWorkspaceConfigurationFile(e).then(t=>this.getSelectionPosition(t.value.toString(),t.resource,["extensions","recommendations"])).then(t=>this.editorService.openEditor({resource:e,options:{selection:t,forceReload:!0}}))}getOrUpdateWorkspaceConfigurationFile(e){return Promise.resolve(this.fileService.readFile(e)).then(t=>{const n=lt.parse(t.value.toString()).extensions;return!n||!n.recommendations?this.jsonEditingService.write(e,[{path:["extensions"],value:{recommendations:[]}}],!0).then(()=>this.fileService.readFile(e)):t})}getSelectionPosition(e,t,n){const o=lt.parseTree(e),r=lt.findNodeAtLocation(o,n);if(r&&r.parent&&r.parent.children){const l=r.parent.children[1],d=l.children&&l.children.length?l.children[l.children.length-1]:null,x=d?d.offset+d.length:l.offset+1;return Promise.resolve(this.textModelResolverService.createModelReference(t)).then(p=>{const g=p.object.textEditorModel.getPositionAt(x);return p.dispose(),{startLineNumber:g.lineNumber,startColumn:g.column,endLineNumber:g.lineNumber,endColumn:g.column}})}return Promise.resolve(void 0)}getOrCreateExtensionsFile(e){return Promise.resolve(this.fileService.readFile(e)).then(t=>({created:!1,extensionsFileResource:e,content:t.value.toString()}),t=>this.textFileService.write(e,_t).then(()=>({created:!0,extensionsFileResource:e,content:_t})))}};ye=u([i(2,ge),i(3,Te),i(4,gt),i(5,bt),i(6,St),i(7,ht)],ye);let ze=class extends ye{static ID="workbench.extensions.action.configureWorkspaceRecommendedExtensions";static LABEL=s("configureWorkspaceRecommendedExtensions","Configure Recommended Extensions (Workspace)");constructor(a,e,t,n,o,r,l,d){super(a,e,o,t,n,r,l,d),this._register(this.contextService.onDidChangeWorkbenchState(()=>this.update(),this)),this.update()}update(){this.enabled=this.contextService.getWorkbenchState()!==qe.EMPTY}run(){switch(this.contextService.getWorkbenchState()){case qe.FOLDER:return this.openExtensionsFile(this.contextService.getWorkspace().folders[0].toResource(Ot));case qe.WORKSPACE:return this.openWorkspaceConfigurationFile(this.contextService.getWorkspace().configuration)}return Promise.resolve()}};ze=u([i(2,Te),i(3,gt),i(4,ge),i(5,bt),i(6,St),i(7,ht)],ze);let Ze=class extends ye{constructor(e,t,n,o,r,l,d,x,p){super(e,t,r,n,o,l,d,x);this.commandService=p}static ID="workbench.extensions.action.configureWorkspaceFolderRecommendedExtensions";static LABEL=s("configureWorkspaceFolderRecommendedExtensions","Configure Recommended Extensions (Workspace Folder)");run(){const t=this.contextService.getWorkspace().folders.length===1?Promise.resolve(this.contextService.getWorkspace().folders[0]):this.commandService.executeCommand(bn);return Promise.resolve(t).then(n=>n?this.openExtensionsFile(n.toResource(Ot)):null)}};Ze=u([i(2,Te),i(3,gt),i(4,ge),i(5,bt),i(6,St),i(7,ht),i(8,ut)],Ze);let oe=class extends k{constructor(e,t,n){super("extensions.action.statusLabel","",oe.DISABLED_CLASS,!1);this.extensionService=e;this.extensionManagementServerService=t;this.extensionEnablementService=n}static ENABLED_CLASS=`${h.TEXT_ACTION_CLASS} extension-status-label`;static DISABLED_CLASS=`${this.ENABLED_CLASS} hide`;initialStatus=null;status=null;version=null;enablementState=null;_extension=null;get extension(){return this._extension}set extension(e){this._extension&&e&&T(this._extension.identifier,e.identifier)||(this.initialStatus=null,this.status=null,this.enablementState=null),this._extension=e,this.update()}update(){const e=this.computeLabel();this.label=e||"",this.class=e?oe.ENABLED_CLASS:oe.DISABLED_CLASS}computeLabel(){if(!this.extension)return null;const e=this.status,t=this.version,n=this.enablementState;this.status=this.extension.state,this.version=this.extension.version,this.initialStatus===null&&(this.initialStatus=this.status),this.enablementState=this.extension.enablementState;const o=()=>{const l=this.extensionService.extensions.filter(d=>T({id:d.identifier.value,uuid:d.uuid},this.extension.identifier))[0];return this.extension.local?l&&this.extension.version===l.version?!0:this.extensionService.canAddExtension(Qe(this.extension.local)):!1},r=()=>this.extension.local?this.extensionService.extensions.every(l=>!(T({id:l.identifier.value,uuid:l.uuid},this.extension.identifier)&&this.extension.server===this.extensionManagementServerService.getExtensionManagementServer(Vt(l))))?!0:this.extensionService.canRemoveExtension(Qe(this.extension.local)):!1;if(e!==null){if(e===v.Installing&&this.status===v.Installed)return o()?this.initialStatus===v.Installed&&this.version!==t?s("updated","Updated"):s("installed","Installed"):null;if(e===v.Uninstalling&&this.status===v.Uninstalled)return this.initialStatus=this.status,r()?s("uninstalled","Uninstalled"):null}if(n!==null){const l=this.extensionEnablementService.isEnabledEnablementState(n),d=this.extensionEnablementService.isEnabledEnablementState(this.enablementState);if(!l&&d)return o()?s("enabled","Enabled"):null;if(l&&!d)return r()?s("disabled","Disabled"):null}return null}run(){return Promise.resolve()}};oe=u([i(0,W),i(1,B),i(2,P)],oe);let ae=class extends he{constructor(e,t,n,o){super("extensions.sync","",ae.SYNC_CLASS,!1,o);this.configurationService=e;this.extensionsWorkbenchService=t;this.userDataSyncEnablementService=n;this._register(Ce.filter(this.configurationService.onDidChangeConfiguration,r=>r.affectsConfiguration("settingsSync.ignoredExtensions"))(()=>this.update())),this._register(n.onDidChangeEnablement(()=>this.update())),this.update()}static IGNORED_SYNC_CLASS=`${h.ICON_ACTION_CLASS} extension-sync ${I.asClassName(An)}`;static SYNC_CLASS=`${this.ICON_ACTION_CLASS} extension-sync ${I.asClassName(Nn)}`;update(){if(this.enabled=!!this.extension&&this.userDataSyncEnablementService.isEnabled()&&this.extension.state===v.Installed,this.extension){const e=this.extensionsWorkbenchService.isExtensionIgnoredToSync(this.extension);this.class=e?ae.IGNORED_SYNC_CLASS:ae.SYNC_CLASS,this.tooltip=e?s("ignored","This extension is ignored during sync"):s("synced","This extension is synced")}}async run(){return super.run({actionGroups:[[new k("extensions.syncignore",this.extensionsWorkbenchService.isExtensionIgnoredToSync(this.extension)?s("sync","Sync this extension"):s("do not sync","Do not sync this extension"),void 0,!0,()=>this.extensionsWorkbenchService.toggleExtensionIgnoredToSync(this.extension))]],disposeActionsOnHide:!0})}};ae=u([i(0,Mt),i(1,S),i(2,vn),i(3,E)],ae);let D=class extends h{constructor(e,t,n,o,r,l,d,x,p,g,it,st){super("extensions.status","",`${D.CLASS} hide`,!1);this.extensionManagementServerService=e;this.labelService=t;this.commandService=n;this.workspaceTrustEnablementService=o;this.workspaceTrustService=r;this.extensionsWorkbenchService=l;this.extensionService=d;this.extensionManifestPropertiesService=x;this.contextService=p;this.productService=g;this.workbenchExtensionEnablementService=it;this.extensionFeaturesManagementService=st;this._register(this.labelService.onDidChangeFormatters(()=>this.update(),this)),this._register(this.extensionService.onDidChangeExtensions(()=>this.update())),this._register(this.extensionFeaturesManagementService.onDidChangeAccessData(()=>this.update())),this.update()}static CLASS=`${h.ICON_ACTION_CLASS} extension-status`;updateWhenCounterExtensionChanges=!0;_status=[];get status(){return this._status}_onDidChangeStatus=this._register(new Lt);onDidChangeStatus=this._onDidChangeStatus.event;updateThrottler=new ot;update(){this.updateThrottler.queue(()=>this.computeAndUpdateStatus())}async computeAndUpdateStatus(){if(this.updateStatus(void 0,!0),this.enabled=!1,!this.extension)return;if(this.extension.isMalicious){this.updateStatus({icon:f,message:new m(s("malicious tooltip","This extension was reported to be problematic."))},!0);return}if(this.extension.deprecationInfo){if(this.extension.deprecationInfo.extension){const r=`[${this.extension.deprecationInfo.extension.displayName}](${ee.parse(`command:extension.open?${encodeURIComponent(JSON.stringify([this.extension.deprecationInfo.extension.id]))}`)})`;this.updateStatus({icon:f,message:new m(s("deprecated with alternate extension tooltip","This extension is deprecated. Use the {0} extension instead.",r))},!0)}else if(this.extension.deprecationInfo.settings){const r=`[${s("settings","settings")}](${ee.parse(`command:workbench.action.openSettings?${encodeURIComponent(JSON.stringify([this.extension.deprecationInfo.settings.map(l=>`@id:${l}`).join(" ")]))}`)})`;this.updateStatus({icon:f,message:new m(s("deprecated with alternate settings tooltip","This extension is deprecated as this functionality is now built-in to VS Code. Configure these {0} to use this functionality.",r))},!0)}else{const r=new m(s("deprecated tooltip","This extension is deprecated as it is no longer being maintained."));this.extension.deprecationInfo.additionalInfo&&r.appendMarkdown(` ${this.extension.deprecationInfo.additionalInfo}`),this.updateStatus({icon:f,message:r},!0)}return}if(this.extensionsWorkbenchService.canSetLanguage(this.extension))return;if(this.extension.outdated&&this.extensionsWorkbenchService.isAutoUpdateEnabledFor(this.extension)){const r=await this.extensionsWorkbenchService.shouldRequireConsentToUpdate(this.extension);if(r){const l=new m;l.appendMarkdown(`${r} `),l.appendMarkdown(s("auto update message","Please [review the extension]({0}) and update it manually.",this.extension.hasChangelog()?ee.parse(`command:extension.open?${encodeURIComponent(JSON.stringify([this.extension.identifier.id,It.Changelog]))}`).toString():this.extension.repository?this.extension.repository:ee.parse(`command:extension.open?${encodeURIComponent(JSON.stringify([this.extension.identifier.id]))}`).toString())),this.updateStatus({icon:f,message:l},!0)}}if(this.extension.gallery&&this.extension.state===v.Uninstalled&&!await this.extensionsWorkbenchService.canInstall(this.extension)){if(this.extensionManagementServerService.localExtensionManagementServer||this.extensionManagementServerService.remoteExtensionManagementServer){const r=await(this.extensionManagementServerService.localExtensionManagementServer?this.extensionManagementServerService.localExtensionManagementServer.extensionManagementService.getTargetPlatform():this.extensionManagementServerService.remoteExtensionManagementServer.extensionManagementService.getTargetPlatform()),l=new m(`${s("incompatible platform","The '{0}' extension is not available in {1} for {2}.",this.extension.displayName||this.extension.identifier.id,this.productService.nameLong,sn(r))} [${s("learn more","Learn More")}](https://aka.ms/vscode-platform-specific-extensions)`);this.updateStatus({icon:f,message:l},!0);return}if(this.extensionManagementServerService.webExtensionManagementServer){const r=s("VS Code for Web","{0} for the Web",this.productService.nameLong),l=new m(`${s("not web tooltip","The '{0}' extension is not available in {1}.",this.extension.displayName||this.extension.identifier.id,r)} [${s("learn why","Learn Why")}](https://aka.ms/vscode-web-extensions-guide)`);this.updateStatus({icon:f,message:l},!0);return}}if(!this.extension.local||!this.extension.server||this.extension.state!==v.Installed)return;if(this.extension.enablementState===b.DisabledByEnvironment){this.updateStatus({message:new m(s("disabled by environment","This extension is disabled by the environment."))},!0);return}if(this.extension.enablementState===b.EnabledByEnvironment){this.updateStatus({message:new m(s("enabled by environment","This extension is enabled because it is required in the current environment."))},!0);return}if(this.extension.enablementState===b.DisabledByVirtualWorkspace){const r=Ue(this.extension.local.manifest.capabilities?.virtualWorkspaces);this.updateStatus({icon:M,message:new m(r?Oe(r):s("disabled because of virtual workspace","This extension has been disabled because it does not support virtual workspaces."))},!0);return}if(xn(this.contextService.getWorkspace())){const r=this.extensionManifestPropertiesService.getExtensionVirtualWorkspaceSupportType(this.extension.local.manifest),l=Ue(this.extension.local.manifest.capabilities?.virtualWorkspaces);if(r==="limited"||l){this.updateStatus({icon:f,message:new m(l?Oe(l):s("extension limited because of virtual workspace","This extension has limited features because the current workspace is virtual."))},!0);return}}if(this.extension.enablementState===b.DisabledByTrustRequirement||this.extension.enablementState===b.DisabledByExtensionDependency&&this.workbenchExtensionEnablementService.getDependenciesEnablementStates(this.extension.local).every(([,r])=>this.workbenchExtensionEnablementService.isEnabledEnablementState(r)||r===b.DisabledByTrustRequirement)){this.enabled=!0;const r=Ue(this.extension.local.manifest.capabilities?.untrustedWorkspaces);this.updateStatus({icon:de,message:new m(r?Oe(r):s("extension disabled because of trust requirement","This extension has been disabled because the current workspace is not trusted."))},!0);return}if(this.workspaceTrustEnablementService.isWorkspaceTrustEnabled()&&!this.workspaceTrustService.isWorkspaceTrusted()){const r=this.extensionManifestPropertiesService.getExtensionUntrustedWorkspaceSupportType(this.extension.local.manifest),l=Ue(this.extension.local.manifest.capabilities?.untrustedWorkspaces);if(r==="limited"||l){this.enabled=!0,this.updateStatus({icon:de,message:new m(l?Oe(l):s("extension limited because of trust requirement","This extension has limited features because the current workspace is not trusted."))},!0);return}}if(this.extension.enablementState===b.DisabledByExtensionKind&&!this.extensionsWorkbenchService.installed.some(r=>T(r.identifier,this.extension.identifier)&&r.server!==this.extension.server)){let r;this.extensionManagementServerService.localExtensionManagementServer===this.extension.server?this.extensionManifestPropertiesService.prefersExecuteOnWorkspace(this.extension.local.manifest)&&this.extensionManagementServerService.remoteExtensionManagementServer&&(r=new m(`${s("Install in remote server to enable","This extension is disabled in this workspace because it is defined to run in the Remote Extension Host. Please install the extension in '{0}' to enable.",this.extensionManagementServerService.remoteExtensionManagementServer.label)} [${s("learn more","Learn More")}](https://code.visualstudio.com/api/advanced-topics/remote-extensions#architecture-and-extension-kinds)`)):this.extensionManagementServerService.remoteExtensionManagementServer===this.extension.server?this.extensionManifestPropertiesService.prefersExecuteOnUI(this.extension.local.manifest)&&(this.extensionManagementServerService.localExtensionManagementServer?r=new m(`${s("Install in local server to enable","This extension is disabled in this workspace because it is defined to run in the Local Extension Host. Please install the extension locally to enable.",this.extensionManagementServerService.remoteExtensionManagementServer.label)} [${s("learn more","Learn More")}](https://code.visualstudio.com/api/advanced-topics/remote-extensions#architecture-and-extension-kinds)`):ct&&(r=new m(`${s("Defined to run in desktop","This extension is disabled because it is defined to run only in {0} for the Desktop.",this.productService.nameLong)} [${s("learn more","Learn More")}](https://code.visualstudio.com/api/advanced-topics/remote-extensions#architecture-and-extension-kinds)`))):this.extensionManagementServerService.webExtensionManagementServer===this.extension.server&&(r=new m(`${s("Cannot be enabled","This extension is disabled because it is not supported in {0} for the Web.",this.productService.nameLong)} [${s("learn more","Learn More")}](https://code.visualstudio.com/api/advanced-topics/remote-extensions#architecture-and-extension-kinds)`)),r&&this.updateStatus({icon:f,message:r},!0);return}const e=new Dt(this.extension.identifier.id),t=an.as(fn.ExtensionFeaturesRegistry).getExtensionFeatures();for(const r of t){const l=this.extensionFeaturesManagementService.getAccessData(e,r.id)?.current?.status,d=`[${s("manage access","Manage Access")}](${ee.parse(`command:extension.open?${encodeURIComponent(JSON.stringify([this.extension.identifier.id,It.Features,!1,r.id]))}`)})`;if(l?.severity===H.Error){this.updateStatus({icon:Q,message:new m().appendText(l.message).appendMarkdown(` ${d}`)},!0);return}if(l?.severity===H.Warning){this.updateStatus({icon:f,message:new m().appendText(l.message).appendMarkdown(` ${d}`)},!0);return}}if(this.extensionManagementServerService.remoteExtensionManagementServer){if(At(this.extension.local.manifest)){if(!this.extensionsWorkbenchService.installed.some(d=>T(d.identifier,this.extension.identifier)&&d.server!==this.extension.server)){const d=this.extension.server===this.extensionManagementServerService.localExtensionManagementServer?new m(s("Install language pack also in remote server","Install the language pack extension on '{0}' to enable it there also.",this.extensionManagementServerService.remoteExtensionManagementServer.label)):new m(s("Install language pack also locally","Install the language pack extension locally to enable it there also."));this.updateStatus({icon:M,message:d},!0)}return}const r=this.extensionService.extensions.filter(d=>T({id:d.identifier.value,uuid:d.uuid},this.extension.identifier))[0],l=r?this.extensionManagementServerService.getExtensionManagementServer(Vt(r)):null;if(this.extension.server===this.extensionManagementServerService.localExtensionManagementServer&&l===this.extensionManagementServerService.remoteExtensionManagementServer){this.extensionManifestPropertiesService.prefersExecuteOnWorkspace(this.extension.local.manifest)&&this.updateStatus({icon:M,message:new m(`${s("enabled remotely","This extension is enabled in the Remote Extension Host because it prefers to run there.")} [${s("learn more","Learn More")}](https://code.visualstudio.com/api/advanced-topics/remote-extensions#architecture-and-extension-kinds)`)},!0);return}if(this.extension.server===this.extensionManagementServerService.remoteExtensionManagementServer&&l===this.extensionManagementServerService.localExtensionManagementServer){this.extensionManifestPropertiesService.prefersExecuteOnUI(this.extension.local.manifest)&&this.updateStatus({icon:M,message:new m(`${s("enabled locally","This extension is enabled in the Local Extension Host because it prefers to run there.")} [${s("learn more","Learn More")}](https://code.visualstudio.com/api/advanced-topics/remote-extensions#architecture-and-extension-kinds)`)},!0);return}if(this.extension.server===this.extensionManagementServerService.remoteExtensionManagementServer&&l===this.extensionManagementServerService.webExtensionManagementServer){this.extensionManifestPropertiesService.canExecuteOnWeb(this.extension.local.manifest)&&this.updateStatus({icon:M,message:new m(`${s("enabled in web worker","This extension is enabled in the Web Worker Extension Host because it prefers to run there.")} [${s("learn more","Learn More")}](https://code.visualstudio.com/api/advanced-topics/remote-extensions#architecture-and-extension-kinds)`)},!0);return}}if(this.extension.enablementState===b.DisabledByExtensionDependency){this.updateStatus({icon:f,message:new m(s("extension disabled because of dependency","This extension has been disabled because it depends on an extension that is disabled."))},!0);return}const n=this.workbenchExtensionEnablementService.isEnabled(this.extension.local),o=this.extensionService.extensions.some(r=>T({id:r.identifier.value,uuid:r.uuid},this.extension.identifier));if(!this.extension.isWorkspaceScoped&&n&&o){if(this.extension.enablementState===b.EnabledWorkspace){this.updateStatus({message:new m(s("workspace enabled","This extension is enabled for this workspace by the user."))},!0);return}if(this.extensionManagementServerService.localExtensionManagementServer&&this.extensionManagementServerService.remoteExtensionManagementServer&&this.extension.server===this.extensionManagementServerService.remoteExtensionManagementServer){this.updateStatus({message:new m(s("extension enabled on remote","Extension is enabled on '{0}'",this.extension.server.label))},!0);return}if(this.extension.enablementState===b.EnabledGlobally)return}if(!n&&!o){if(this.extension.enablementState===b.DisabledGlobally){this.updateStatus({message:new m(s("globally disabled","This extension is disabled globally by the user."))},!0);return}if(this.extension.enablementState===b.DisabledWorkspace){this.updateStatus({message:new m(s("workspace disabled","This extension is disabled for this workspace by the user."))},!0);return}}if(n&&!o&&!this.extension.local.isValid){const r=this.extension.local.validations.filter(([l])=>l===H.Error).map(([,l])=>l);this.updateStatus({icon:Q,message:new m(r.join(" ").trim())},!0)}}updateStatus(e,t){if(e){if(this._status.some(n=>n.message.value===e.message.value&&n.icon?.id===e.icon?.id))return}else{if(this._status.length===0)return;this._status=[]}e&&(this._status.push(e),this._status.sort((n,o)=>o.icon===de?-1:n.icon===de?1:o.icon===Q?-1:n.icon===Q?1:o.icon===f?-1:n.icon===f?1:o.icon===M?-1:n.icon===M?1:0)),t&&(e?.icon===Q?this.class=`${D.CLASS} extension-status-error ${I.asClassName(Q)}`:e?.icon===f?this.class=`${D.CLASS} extension-status-warning ${I.asClassName(f)}`:e?.icon===M?this.class=`${D.CLASS} extension-status-info ${I.asClassName(M)}`:e?.icon===de?this.class=`${D.CLASS} ${I.asClassName(de)}`:this.class=`${D.CLASS} hide`),this._onDidChangeStatus.fire()}async run(){if(this._status[0]?.icon===de)return this.commandService.executeCommand("workbench.trust.manage")}};D=u([i(0,B),i(1,Rt),i(2,ut),i(3,mn),i(4,Sn),i(5,S),i(6,W),i(7,Ie),i(8,ge),i(9,xt),i(10,P),i(11,gn)],D);let me=class extends k{constructor(e=me.ID,t=me.LABEL,n,o,r,l,d,x,p){super(e,t);this.extensionsWorkbenchService=n;this.extensionManagementServerService=o;this.quickInputService=r;this.notificationService=l;this.hostService=d;this.instantiationService=x;this.extensionService=p}static ID="workbench.extensions.action.reinstall";static LABEL=s("reinstall","Reinstall Extension...");get enabled(){return this.extensionsWorkbenchService.local.filter(e=>!e.isBuiltin&&e.local).length>0}run(){return this.quickInputService.pick(this.getEntries(),{placeHolder:s("selectExtensionToReinstall","Select Extension to Reinstall")}).then(e=>e&&this.reinstallExtension(e.extension))}getEntries(){return this.extensionsWorkbenchService.queryLocal().then(e=>e.filter(n=>!n.isBuiltin&&n.server!==this.extensionManagementServerService.webExtensionManagementServer).map(n=>({id:n.identifier.id,label:n.displayName,description:n.identifier.id,extension:n})))}reinstallExtension(e){return this.instantiationService.createInstance(Ee,"@installed ").run().then(()=>this.extensionsWorkbenchService.reinstall(e).then(t=>{const n=!(t.local&&this.extensionService.canAddExtension(Qe(t.local))),o=n?s("ReinstallAction.successReload","Please reload Visual Studio Code to complete reinstalling the extension {0}.",t.identifier.id):s("ReinstallAction.success","Reinstalling the extension {0} is completed.",t.identifier.id),r=n?[{label:s("InstallVSIXAction.reloadNow","Reload Now"),run:()=>this.hostService.reload()}]:[];this.notificationService.prompt(H.Info,o,r,{sticky:!0})},t=>this.notificationService.error(t)))}};me=u([i(2,S),i(3,B),i(4,q),i(5,Pe),i(6,Ut),i(7,E),i(8,W)],me);let Se=class extends k{constructor(e=Se.ID,t=Se.LABEL,n,o,r,l){super(e,t);this.extensionsWorkbenchService=n;this.quickInputService=o;this.instantiationService=r;this.extensionEnablementService=l}static ID="workbench.extensions.action.install.specificVersion";static LABEL=s("install previous version","Install Specific Version of Extension...");get enabled(){return this.extensionsWorkbenchService.local.some(e=>this.isEnabled(e))}async run(){const e=await this.quickInputService.pick(this.getExtensionEntries(),{placeHolder:s("selectExtension","Select Extension"),matchOnDetail:!0});e&&e.extension&&(await this.instantiationService.createInstance(U,e.extension,!0).run(),await this.instantiationService.createInstance(Ee,e.extension.identifier.id).run())}isEnabled(e){return this.instantiationService.createInstance(U,e,!0).enabled&&!!e.local&&this.extensionEnablementService.isEnabled(e.local)}async getExtensionEntries(){const e=await this.extensionsWorkbenchService.queryLocal(),t=[];for(const n of e)this.isEnabled(n)&&t.push({id:n.identifier.id,label:n.displayName||n.identifier.id,description:n.identifier.id,extension:n});return t.sort((n,o)=>n.extension.displayName.localeCompare(o.extension.displayName))}};Se=u([i(2,S),i(3,q),i(4,E),i(5,P)],Se);let ke=class extends k{constructor(e,t,n,o,r){super(e);this.extensionsWorkbenchService=t;this.quickInputService=n;this.notificationService=o;this.progressService=r;this.update(),this.extensionsWorkbenchService.queryLocal().then(()=>this.updateExtensions()),this._register(this.extensionsWorkbenchService.onChange(()=>{this.extensions&&this.updateExtensions()}))}extensions=void 0;updateExtensions(){this.extensions=this.extensionsWorkbenchService.local,this.update()}update(){this.enabled=!!this.extensions&&this.getExtensionsToInstall(this.extensions).length>0,this.tooltip=this.label}async run(){return this.selectAndInstallExtensions()}async queryExtensionsToInstall(){const e=await this.extensionsWorkbenchService.queryLocal();return this.getExtensionsToInstall(e)}async selectAndInstallExtensions(){const e=this.quickInputService.createQuickPick();e.busy=!0;const t=e.onDidAccept(()=>{t.dispose(),e.hide(),e.dispose(),this.onDidAccept(e.selectedItems)});e.show();const n=await this.queryExtensionsToInstall();e.busy=!1,n.length?(e.title=this.getQuickPickTitle(),e.placeholder=s("select extensions to install","Select extensions to install"),e.canSelectMany=!0,n.sort((o,r)=>o.displayName.localeCompare(r.displayName)),e.items=n.map(o=>({extension:o,label:o.displayName,description:o.version}))):(e.hide(),e.dispose(),this.notificationService.notify({severity:H.Info,message:s("no local extensions","There are no extensions to install.")}))}async onDidAccept(e){if(e.length){const t=e.filter(n=>!!n.extension).map(n=>n.extension);t.length&&(await this.progressService.withProgress({location:on.Notification,title:s("installing extensions","Installing Extensions...")},()=>this.installExtensions(t)),this.notificationService.info(s("finished installing","Successfully installed extensions.")))}}};ke=u([i(1,S),i(2,q),i(3,Pe),i(4,mt)],ke);let et=class extends ke{constructor(e,t,n,o,r,l,d,x,p){super("workbench.extensions.actions.installLocalExtensionsInRemote",e,t,o,n);this.extensionManagementServerService=r;this.extensionGalleryService=l;this.instantiationService=d;this.fileService=x;this.logService=p}get label(){return this.extensionManagementServerService&&this.extensionManagementServerService.remoteExtensionManagementServer?s("select and install local extensions","Install Local Extensions in '{0}'...",this.extensionManagementServerService.remoteExtensionManagementServer.label):""}getQuickPickTitle(){return s("install local extensions title","Install Local Extensions in '{0}'",this.extensionManagementServerService.remoteExtensionManagementServer.label)}getExtensionsToInstall(e){return e.filter(t=>{const n=this.instantiationService.createInstance(Ae,!0);return n.extension=t,n.enabled})}async installExtensions(e){const t=[],n=[],o=await this.extensionManagementServerService.remoteExtensionManagementServer.extensionManagementService.getTargetPlatform();await be.settled(e.map(async r=>{if(this.extensionGalleryService.isEnabled()){const d=(await this.extensionGalleryService.getExtensions([{...r.identifier,preRelease:!!r.local?.preRelease}],{targetPlatform:o,compatible:!0},le.None))[0];if(d){t.push(d);return}}const l=await this.extensionManagementServerService.localExtensionManagementServer.extensionManagementService.zip(r.local);n.push(l)})),await be.settled(t.map(r=>this.extensionManagementServerService.remoteExtensionManagementServer.extensionManagementService.installFromGallery(r)));try{await be.settled(n.map(r=>this.extensionManagementServerService.remoteExtensionManagementServer.extensionManagementService.install(r)))}finally{try{await Promise.allSettled(n.map(r=>this.fileService.del(r)))}catch(r){this.logService.error(r)}}}};et=u([i(0,S),i(1,q),i(2,mt),i(3,Pe),i(4,B),i(5,Ve),i(6,E),i(7,Te),i(8,vt)],et);let tt=class extends ke{constructor(e,t,n,o,r,l,d,x,p){super(e,t,n,r,o);this.extensionManagementServerService=l;this.extensionGalleryService=d;this.fileService=x;this.logService=p}get label(){return s("select and install remote extensions","Install Remote Extensions Locally...")}getQuickPickTitle(){return s("install remote extensions","Install Remote Extensions Locally")}getExtensionsToInstall(e){return e.filter(t=>t.type===Nt.User&&t.server!==this.extensionManagementServerService.localExtensionManagementServer&&!this.extensionsWorkbenchService.installed.some(n=>n.server===this.extensionManagementServerService.localExtensionManagementServer&&T(n.identifier,t.identifier)))}async installExtensions(e){const t=[],n=[],o=await this.extensionManagementServerService.localExtensionManagementServer.extensionManagementService.getTargetPlatform();await be.settled(e.map(async r=>{if(this.extensionGalleryService.isEnabled()){const d=(await this.extensionGalleryService.getExtensions([{...r.identifier,preRelease:!!r.local?.preRelease}],{targetPlatform:o,compatible:!0},le.None))[0];if(d){t.push(d);return}}const l=await this.extensionManagementServerService.remoteExtensionManagementServer.extensionManagementService.zip(r.local);n.push(l)})),await be.settled(t.map(r=>this.extensionManagementServerService.localExtensionManagementServer.extensionManagementService.installFromGallery(r)));try{await be.settled(n.map(r=>this.extensionManagementServerService.localExtensionManagementServer.extensionManagementService.install(r)))}finally{try{await Promise.allSettled(n.map(r=>this.fileService.del(r)))}catch(r){this.logService.error(r)}}}};tt=u([i(1,S),i(2,q),i(3,mt),i(4,Pe),i(5,B),i(6,Ve),i(7,Te),i(8,vt)],tt),Pt.registerCommand("workbench.extensions.action.showExtensionsForLanguage",function(c,a){return c.get(We).openPaneComposite(Ne,Me.Sidebar,!0).then(t=>t?.getViewPaneContainer()).then(t=>{t.search(`ext:${a.replace(/^\./,"")}`),t.focus()})});const $n="workbench.extensions.action.showExtensionsWithIds";Pt.registerCommand($n,function(c,a){return c.get(We).openPaneComposite(Ne,Me.Sidebar,!0).then(t=>t?.getViewPaneContainer()).then(t=>{const n=a.map(o=>`@id:${o}`).join(" ");t.search(n),t.focus()})}),ce("extensionButton.background",{dark:Fe,light:Fe,hcDark:null,hcLight:null},s("extensionButtonBackground","Button background color for extension actions.")),ce("extensionButton.foreground",{dark:Ge,light:Ge,hcDark:null,hcLight:null},s("extensionButtonForeground","Button foreground color for extension actions.")),ce("extensionButton.hoverBackground",{dark:He,light:He,hcDark:null,hcLight:null},s("extensionButtonHoverBackground","Button background hover color for extension actions.")),ce("extensionButton.separator",ln,s("extensionButtonSeparator","Button separator color for extension actions"));const As=ce("extensionButton.prominentBackground",{dark:Fe,light:Fe,hcDark:null,hcLight:null},s("extensionButtonProminentBackground","Button background color for extension actions that stand out (e.g. install button)."));ce("extensionButton.prominentForeground",{dark:Ge,light:Ge,hcDark:null,hcLight:null},s("extensionButtonProminentForeground","Button foreground color for extension actions that stand out (e.g. install button).")),ce("extensionButton.prominentHoverBackground",{dark:He,light:He,hcDark:null,hcLight:null},s("extensionButtonProminentHoverBackground","Button background hover color for extension actions that stand out (e.g. install button).")),un((c,a)=>{const e=c.getColor(cn);e&&(a.addRule(`.extension-editor .header .actions-status-container > .status ${I.asCSSSelector(Q)} { color: ${e}; }`),a.addRule(`.extension-editor .body .subcontent .runtime-status ${I.asCSSSelector(Q)} { color: ${e}; }`),a.addRule(`.monaco-hover.extension-hover .markdown-hover .hover-contents ${I.asCSSSelector(Q)} { color: ${e}; }`));const t=c.getColor(hn);t&&(a.addRule(`.extension-editor .header .actions-status-container > .status ${I.asCSSSelector(f)} { color: ${t}; }`),a.addRule(`.extension-editor .body .subcontent .runtime-status ${I.asCSSSelector(f)} { color: ${t}; }`),a.addRule(`.monaco-hover.extension-hover .markdown-hover .hover-contents ${I.asCSSSelector(f)} { color: ${t}; }`));const n=c.getColor(dn);n&&(a.addRule(`.extension-editor .header .actions-status-container > .status ${I.asCSSSelector(M)} { color: ${n}; }`),a.addRule(`.extension-editor .body .subcontent .runtime-status ${I.asCSSSelector(M)} { color: ${n}; }`),a.addRule(`.monaco-hover.extension-hover .markdown-hover .hover-contents ${I.asCSSSelector(M)} { color: ${n}; }`))});export{ye as AbstractConfigureRecommendedExtensionsAction,ke as AbstractInstallExtensionsInServerAction,Et as ButtonWithDropDownExtensionAction,Ds as ButtonWithDropdownExtensionActionViewItem,G as ClearLanguageAction,Ze as ConfigureWorkspaceFolderRecommendedExtensionsAction,ze as ConfigureWorkspaceRecommendedExtensionsAction,Ye as DisableDropDownAction,j as DisableForWorkspaceAction,J as DisableGloballyAction,he as DropDownExtensionAction,Re as DropDownExtensionActionViewItem,Je as EnableDropDownAction,K as EnableForWorkspaceAction,X as EnableGloballyAction,h as ExtensionAction,Ns as ExtensionEditorManageExtensionAction,re as ExtensionRuntimeStateAction,D as ExtensionStatusAction,oe as ExtensionStatusLabelAction,ve as IgnoreExtensionRecommendationAction,C as InstallAction,U as InstallAnotherVersionAction,Ke as InstallDropdownAction,y as InstallInOtherServerAction,et as InstallLocalExtensionsInRemoteAction,pe as InstallRecommendedExtensionAction,tt as InstallRemoteExtensionsInLocalAction,Se as InstallSpecificVersionOfExtensionAction,nt as InstallingLabelAction,Xe as LocalInstallAction,z as ManageExtensionAction,Be as MenuItemExtensionAction,se as MigrateDeprecatedExtensionAction,ne as PromptExtensionInstallFailureAction,me as ReinstallAction,Ae as RemoteInstallAction,Ee as SearchExtensionsAction,A as SetColorThemeAction,R as SetFileIconThemeAction,F as SetLanguageAction,$ as SetProductIconThemeAction,ue as ShowRecommendedExtensionAction,N as ToggleAutoUpdateForExtensionAction,ie as ToggleAutoUpdatesForPublisherAction,_ as TogglePreReleaseExtensionAction,ae as ToggleSyncExtensionAction,xe as UndoIgnoreExtensionRecommendationAction,w as UninstallAction,Y as UpdateAction,je as WebInstallAction,As as extensionButtonProminentBackground,Rn as getContextMenuActions,$n as showExtensionsWithIdsCommandId};
