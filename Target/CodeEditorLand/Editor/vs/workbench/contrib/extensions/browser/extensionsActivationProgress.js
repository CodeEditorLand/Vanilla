var a=Object.defineProperty;var f=Object.getOwnPropertyDescriptor;var p=(s,i,t,r)=>{for(var e=r>1?void 0:r?f(i,t):i,o=s.length-1,n;o>=0;o--)(n=s[o])&&(e=(r?n(i,t,e):n(e))||e);return r&&e&&a(i,t,e),e},c=(s,i)=>(t,r)=>i(t,r,s);import{DeferredPromise as d,timeout as v}from"../../../../base/common/async.js";import{CancellationToken as I}from"../../../../base/common/cancellation.js";import{localize as u}from"../../../../nls.js";import{ILogService as b}from"../../../../platform/log/common/log.js";import{IProgressService as y,ProgressLocation as S}from"../../../../platform/progress/common/progress.js";import{IExtensionService as h}from"../../../services/extensions/common/extensions.js";let m=class{_listener;constructor(i,t,r){const e={location:S.Window,title:u("activation","Activating Extensions...")};let o,n=0;this._listener=i.onWillActivateByEvent(l=>{r.trace("onWillActivateByEvent: ",l.event),o||(o=new d,t.withProgress(e,W=>o.p)),n++,Promise.race([l.activation,v(5e3,I.None)]).finally(()=>{--n===0&&(o.complete(void 0),o=void 0)})})}dispose(){this._listener.dispose()}};m=p([c(0,h),c(1,y),c(2,b)],m);export{m as ExtensionActivationProgress};
