var U=Object.defineProperty;var _=Object.getOwnPropertyDescriptor;var T=(l,e,i,t)=>{for(var r=t>1?void 0:t?_(e,i):e,a=l.length-1,n;a>=0;a--)(n=l[a])&&(r=(t?n(e,i,r):n(r))||r);return t&&r&&U(e,i,r),r},p=(l,e)=>(i,t)=>e(i,t,l);import"./media/extension.css";import{$ as s,addDisposableListener as z,append as o}from"../../../../base/browser/dom.js";import{ActionBar as $}from"../../../../base/browser/ui/actionbar/actionbar.js";import"../../../../base/browser/ui/actionbar/actionViewItems.js";import"../../../../base/browser/ui/hover/hoverWidget.js";import"../../../../base/browser/ui/list/list.js";import"../../../../base/browser/ui/list/listPaging.js";import"../../../../base/common/actions.js";import{Event as G}from"../../../../base/common/event.js";import{combinedDisposable as K,dispose as I}from"../../../../base/common/lifecycle.js";import{ThemeIcon as j}from"../../../../base/common/themables.js";import{IContextMenuService as q}from"../../../../platform/contextview/browser/contextView.js";import{areSameExtensions as v}from"../../../../platform/extensionManagement/common/extensionManagementUtil.js";import{IInstantiationService as X}from"../../../../platform/instantiation/common/instantiation.js";import{INotificationService as J}from"../../../../platform/notification/common/notification.js";import{registerThemingParticipant as Q}from"../../../../platform/theme/common/themeService.js";import{WORKBENCH_BACKGROUND as Y}from"../../../common/theme.js";import{IWorkbenchExtensionEnablementService as Z}from"../../../services/extensionManagement/common/extensionManagement.js";import{IExtensionService as ee}from"../../../services/extensions/common/extensions.js";import{ExtensionContainers as te,ExtensionState as W,IExtensionsWorkbenchService as ie}from"../common/extensions.js";import{ButtonWithDropDownExtensionAction as ne,ButtonWithDropdownExtensionActionViewItem as se,ClearLanguageAction as oe,DropDownExtensionAction as re,ExtensionRuntimeStateAction as ae,ExtensionStatusAction as ce,ExtensionStatusLabelAction as le,InstallDropdownAction as pe,InstallingLabelAction as me,LocalInstallAction as de,ManageExtensionAction as Ie,MigrateDeprecatedExtensionAction as ue,RemoteInstallAction as ve,SetLanguageAction as he,UpdateAction as be,WebInstallAction as ge}from"./extensionsActions.js";import{verifiedPublisherIcon as xe}from"./extensionsIcons.js";import{ExtensionActivationStatusWidget as Se,ExtensionHoverWidget as fe,ExtensionPackCountWidget as Ee,extensionVerifiedPublisherIconColor as De,InstallCountWidget as ye,PreReleaseBookmarkWidget as Ce,RatingsWidget as Ae,RecommendationWidget as Le,RemoteBadgeWidget as P,SyncIgnoredWidget as Te,VerifiedPublisherWidget as We}from"./extensionsWidgets.js";const Pe=72;class pt{getHeight(){return Pe}getTemplateId(){return"extension"}}let h=class{constructor(e,i,t,r,a,n,u,x){this.extensionViewState=e;this.options=i;this.instantiationService=t;this.notificationService=r;this.extensionService=a;this.extensionsWorkbenchService=n;this.extensionEnablementService=u;this.contextMenuService=x}get templateId(){return"extension"}renderTemplate(e){const i=this.instantiationService.createInstance(Le,o(e,s(".extension-bookmark-container"))),t=this.instantiationService.createInstance(Ce,o(e,s(".extension-bookmark-container"))),r=o(e,s(".extension-list-item")),a=o(r,s(".icon-container")),n=o(a,s("img.icon",{alt:""})),u=this.instantiationService.createInstance(P,a,!1),x=this.instantiationService.createInstance(Ee,a),b=o(r,s(".details")),k=o(b,s(".header-container")),m=o(k,s(".header")),w=o(m,s("span.name")),S=o(m,s("span.install-count")),f=o(m,s("span.ratings")),H=o(m,s("span.sync-ignored")),M=o(m,s("span.activation-status")),N=this.instantiationService.createInstance(P,m,!1),V=o(b,s(".description.ellipsis")),E=o(b,s(".footer")),D=o(E,s(".author.ellipsis")),B=this.instantiationService.createInstance(We,o(D,s(".verified-publisher")),!0),R=o(D,s(".publisher-name.ellipsis")),d=new $(E,{actionViewItemProvider:(c,L)=>{if(c instanceof ne)return new se(c,{...L,icon:!0,label:!0,menuActionsOrProvider:{getActions:()=>c.menuActions},menuActionClassNames:c.menuActionClassNames},this.contextMenuService);if(c instanceof re)return c.createActionViewItem(L)},focusOnlyEnabledItems:!0});d.setFocusable(!1),d.onDidRun(({error:c})=>c&&this.notificationService.error(c));const y=this.instantiationService.createInstance(ce),g=[this.instantiationService.createInstance(le),this.instantiationService.createInstance(ue,!0),this.instantiationService.createInstance(ae),this.instantiationService.createInstance(be,!1),this.instantiationService.createInstance(pe),this.instantiationService.createInstance(me),this.instantiationService.createInstance(he),this.instantiationService.createInstance(oe),this.instantiationService.createInstance(ve,!1),this.instantiationService.createInstance(de),this.instantiationService.createInstance(ge),y,this.instantiationService.createInstance(Ie)],O=this.instantiationService.createInstance(fe,{target:e,position:this.options.hoverOptions.position},y),C=[i,t,u,x,N,B,O,this.instantiationService.createInstance(Te,H),this.instantiationService.createInstance(Se,M,!0),this.instantiationService.createInstance(ye,S,!0),this.instantiationService.createInstance(Ae,f,!0)],A=this.instantiationService.createInstance(te,[...g,...C]);d.push(g,{icon:!0,label:!0});const F=K(...g,...C,d,A);return{root:e,element:r,icon:n,name:w,installCount:S,ratings:f,description:V,publisherDisplayName:R,disposables:[F],actionbar:d,extensionDisposables:[],set extension(c){A.extension=c}}}renderPlaceholder(e,i){i.element.classList.add("loading"),i.root.removeAttribute("aria-label"),i.root.removeAttribute("data-extension-id"),i.extensionDisposables=I(i.extensionDisposables),i.icon.src="",i.name.textContent="",i.description.textContent="",i.publisherDisplayName.textContent="",i.installCount.style.display="none",i.ratings.style.display="none",i.extension=null}renderElement(e,i,t){t.element.classList.remove("loading"),t.root.setAttribute("data-extension-id",e.identifier.id),e.state!==W.Uninstalled&&!e.server&&(e=this.extensionsWorkbenchService.local.filter(n=>n.server===e.server&&v(n.identifier,e.identifier))[0]||e),t.extensionDisposables=I(t.extensionDisposables);const r=()=>{const n=e.state===W.Installed&&e.local&&!this.extensionEnablementService.isEnabled(e.local),u=!!e.deprecationInfo;t.element.classList.toggle("deprecated",u),t.root.classList.toggle("disabled",n)};r(),this.extensionService.onDidChangeExtensions(()=>r(),this,t.extensionDisposables),t.extensionDisposables.push(z(t.icon,"error",()=>t.icon.src=e.iconUrlFallback,{once:!0})),t.icon.src=e.iconUrl,t.icon.complete?t.icon.style.visibility="inherit":(t.icon.style.visibility="hidden",t.icon.onload=()=>t.icon.style.visibility="inherit"),t.name.textContent=e.displayName,t.description.textContent=e.description;const a=()=>{t.publisherDisplayName.textContent=!e.resourceExtension&&e.local?.source!=="resource"?e.publisherDisplayName:""};a(),G.filter(this.extensionsWorkbenchService.onChange,n=>!!n&&v(n.identifier,e.identifier))(()=>a(),this,t.extensionDisposables),t.installCount.style.display="",t.ratings.style.display="",t.extension=e,e.gallery&&e.gallery.properties&&e.gallery.properties.localizedLanguages&&e.gallery.properties.localizedLanguages.length&&(t.description.textContent=e.gallery.properties.localizedLanguages.map(n=>n[0].toLocaleUpperCase()+n.slice(1)).join(", ")),this.extensionViewState.onFocus(n=>{v(e.identifier,n.identifier)&&t.actionbar.setFocusable(!0)},this,t.extensionDisposables),this.extensionViewState.onBlur(n=>{v(e.identifier,n.identifier)&&t.actionbar.setFocusable(!1)},this,t.extensionDisposables)}disposeElement(e,i,t){t.extensionDisposables=I(t.extensionDisposables)}disposeTemplate(e){e.extensionDisposables=I(e.extensionDisposables),e.disposables=I(e.disposables)}};h=T([p(2,X),p(3,J),p(4,ee),p(5,ie),p(6,Z),p(7,q)],h),Q((l,e)=>{const i=l.getColor(De);if(i){const t=i.transparent(.5).makeOpaque(Y(l));e.addRule(`.extensions-list .monaco-list .monaco-list-row.disabled:not(.selected) .author .verified-publisher ${j.asCSSSelector(xe)} { color: ${t}; }`)}});export{pt as Delegate,h as Renderer};
