var U=Object.defineProperty;var _=Object.getOwnPropertyDescriptor;var T=(l,e,i,t)=>{for(var r=t>1?void 0:t?_(e,i):e,a=l.length-1,n;a>=0;a--)(n=l[a])&&(r=(t?n(e,i,r):n(r))||r);return t&&r&&U(e,i,r),r},p=(l,e)=>(i,t)=>e(i,t,l);import"./media/extension.css";import{append as s,$ as o,addDisposableListener as z}from"../../../../base/browser/dom.js";import{dispose as I,combinedDisposable as $}from"../../../../base/common/lifecycle.js";import"../../../../base/common/actions.js";import{ActionBar as G}from"../../../../base/browser/ui/actionbar/actionbar.js";import{IInstantiationService as K}from"../../../../platform/instantiation/common/instantiation.js";import"../../../../base/browser/ui/list/list.js";import"../../../../base/browser/ui/list/listPaging.js";import{Event as j}from"../../../../base/common/event.js";import{ExtensionContainers as q,ExtensionState as W,IExtensionsWorkbenchService as X}from"../common/extensions.js";import{ManageExtensionAction as J,ExtensionRuntimeStateAction as Q,ExtensionStatusLabelAction as Y,RemoteInstallAction as Z,ExtensionStatusAction as ee,LocalInstallAction as te,ButtonWithDropDownExtensionAction as ie,InstallDropdownAction as ne,InstallingLabelAction as se,ButtonWithDropdownExtensionActionViewItem as oe,DropDownExtensionAction as re,WebInstallAction as ae,MigrateDeprecatedExtensionAction as ce,SetLanguageAction as le,ClearLanguageAction as pe,UpdateAction as me}from"./extensionsActions.js";import{areSameExtensions as v}from"../../../../platform/extensionManagement/common/extensionManagementUtil.js";import{RatingsWidget as de,InstallCountWidget as Ie,RecommendationWidget as ue,RemoteBadgeWidget as P,ExtensionPackCountWidget as ve,SyncIgnoredWidget as he,ExtensionHoverWidget as be,ExtensionActivationStatusWidget as ge,PreReleaseBookmarkWidget as xe,extensionVerifiedPublisherIconColor as Se,VerifiedPublisherWidget as fe}from"./extensionsWidgets.js";import{IExtensionService as Ee}from"../../../services/extensions/common/extensions.js";import{IWorkbenchExtensionEnablementService as De}from"../../../services/extensionManagement/common/extensionManagement.js";import{INotificationService as ye}from"../../../../platform/notification/common/notification.js";import{registerThemingParticipant as Ce}from"../../../../platform/theme/common/themeService.js";import{ThemeIcon as Ae}from"../../../../base/common/themables.js";import{WORKBENCH_BACKGROUND as Le}from"../../../common/theme.js";import{IContextMenuService as Te}from"../../../../platform/contextview/browser/contextView.js";import"../../../../base/browser/ui/hover/hoverWidget.js";import{verifiedPublisherIcon as We}from"./extensionsIcons.js";import"../../../../base/browser/ui/actionbar/actionViewItems.js";const Pe=72;class pt{getHeight(){return Pe}getTemplateId(){return"extension"}}let h=class{constructor(e,i,t,r,a,n,u,x){this.extensionViewState=e;this.options=i;this.instantiationService=t;this.notificationService=r;this.extensionService=a;this.extensionsWorkbenchService=n;this.extensionEnablementService=u;this.contextMenuService=x}get templateId(){return"extension"}renderTemplate(e){const i=this.instantiationService.createInstance(ue,s(e,o(".extension-bookmark-container"))),t=this.instantiationService.createInstance(xe,s(e,o(".extension-bookmark-container"))),r=s(e,o(".extension-list-item")),a=s(r,o(".icon-container")),n=s(a,o("img.icon",{alt:""})),u=this.instantiationService.createInstance(P,a,!1),x=this.instantiationService.createInstance(ve,a),b=s(r,o(".details")),k=s(b,o(".header-container")),m=s(k,o(".header")),w=s(m,o("span.name")),S=s(m,o("span.install-count")),f=s(m,o("span.ratings")),H=s(m,o("span.sync-ignored")),M=s(m,o("span.activation-status")),N=this.instantiationService.createInstance(P,m,!1),V=s(b,o(".description.ellipsis")),E=s(b,o(".footer")),D=s(E,o(".author.ellipsis")),B=this.instantiationService.createInstance(fe,s(D,o(".verified-publisher")),!0),R=s(D,o(".publisher-name.ellipsis")),d=new G(E,{actionViewItemProvider:(c,L)=>{if(c instanceof ie)return new oe(c,{...L,icon:!0,label:!0,menuActionsOrProvider:{getActions:()=>c.menuActions},menuActionClassNames:c.menuActionClassNames},this.contextMenuService);if(c instanceof re)return c.createActionViewItem(L)},focusOnlyEnabledItems:!0});d.setFocusable(!1),d.onDidRun(({error:c})=>c&&this.notificationService.error(c));const y=this.instantiationService.createInstance(ee),g=[this.instantiationService.createInstance(Y),this.instantiationService.createInstance(ce,!0),this.instantiationService.createInstance(Q),this.instantiationService.createInstance(me,!1),this.instantiationService.createInstance(ne),this.instantiationService.createInstance(se),this.instantiationService.createInstance(le),this.instantiationService.createInstance(pe),this.instantiationService.createInstance(Z,!1),this.instantiationService.createInstance(te),this.instantiationService.createInstance(ae),y,this.instantiationService.createInstance(J)],O=this.instantiationService.createInstance(be,{target:e,position:this.options.hoverOptions.position},y),C=[i,t,u,x,N,B,O,this.instantiationService.createInstance(he,H),this.instantiationService.createInstance(ge,M,!0),this.instantiationService.createInstance(Ie,S,!0),this.instantiationService.createInstance(de,f,!0)],A=this.instantiationService.createInstance(q,[...g,...C]);d.push(g,{icon:!0,label:!0});const F=$(...g,...C,d,A);return{root:e,element:r,icon:n,name:w,installCount:S,ratings:f,description:V,publisherDisplayName:R,disposables:[F],actionbar:d,extensionDisposables:[],set extension(c){A.extension=c}}}renderPlaceholder(e,i){i.element.classList.add("loading"),i.root.removeAttribute("aria-label"),i.root.removeAttribute("data-extension-id"),i.extensionDisposables=I(i.extensionDisposables),i.icon.src="",i.name.textContent="",i.description.textContent="",i.publisherDisplayName.textContent="",i.installCount.style.display="none",i.ratings.style.display="none",i.extension=null}renderElement(e,i,t){t.element.classList.remove("loading"),t.root.setAttribute("data-extension-id",e.identifier.id),e.state!==W.Uninstalled&&!e.server&&(e=this.extensionsWorkbenchService.local.filter(n=>n.server===e.server&&v(n.identifier,e.identifier))[0]||e),t.extensionDisposables=I(t.extensionDisposables);const r=()=>{const n=e.state===W.Installed&&e.local&&!this.extensionEnablementService.isEnabled(e.local),u=!!e.deprecationInfo;t.element.classList.toggle("deprecated",u),t.root.classList.toggle("disabled",n)};r(),this.extensionService.onDidChangeExtensions(()=>r(),this,t.extensionDisposables),t.extensionDisposables.push(z(t.icon,"error",()=>t.icon.src=e.iconUrlFallback,{once:!0})),t.icon.src=e.iconUrl,t.icon.complete?t.icon.style.visibility="inherit":(t.icon.style.visibility="hidden",t.icon.onload=()=>t.icon.style.visibility="inherit"),t.name.textContent=e.displayName,t.description.textContent=e.description;const a=()=>{t.publisherDisplayName.textContent=!e.resourceExtension&&e.local?.source!=="resource"?e.publisherDisplayName:""};a(),j.filter(this.extensionsWorkbenchService.onChange,n=>!!n&&v(n.identifier,e.identifier))(()=>a(),this,t.extensionDisposables),t.installCount.style.display="",t.ratings.style.display="",t.extension=e,e.gallery&&e.gallery.properties&&e.gallery.properties.localizedLanguages&&e.gallery.properties.localizedLanguages.length&&(t.description.textContent=e.gallery.properties.localizedLanguages.map(n=>n[0].toLocaleUpperCase()+n.slice(1)).join(", ")),this.extensionViewState.onFocus(n=>{v(e.identifier,n.identifier)&&t.actionbar.setFocusable(!0)},this,t.extensionDisposables),this.extensionViewState.onBlur(n=>{v(e.identifier,n.identifier)&&t.actionbar.setFocusable(!1)},this,t.extensionDisposables)}disposeElement(e,i,t){t.extensionDisposables=I(t.extensionDisposables)}disposeTemplate(e){e.extensionDisposables=I(e.extensionDisposables),e.disposables=I(e.disposables)}};h=T([p(2,K),p(3,ye),p(4,Ee),p(5,X),p(6,De),p(7,Te)],h),Ce((l,e)=>{const i=l.getColor(Se);if(i){const t=i.transparent(.5).makeOpaque(Le(l));e.addRule(`.extensions-list .monaco-list .monaco-list-row.disabled:not(.selected) .author .verified-publisher ${Ae.asCSSSelector(We)} { color: ${t}; }`)}});export{pt as Delegate,h as Renderer};
