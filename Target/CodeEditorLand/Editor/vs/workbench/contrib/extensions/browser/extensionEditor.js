var Se=Object.defineProperty;var Ce=Object.getOwnPropertyDescriptor;var oe=(m,a,e,t)=>{for(var n=t>1?void 0:t?Ce(a,e):a,i=m.length-1,s;i>=0;i--)(s=m[i])&&(n=(t?s(a,e,n):s(n))||n);return t&&n&&Se(a,e,n),n},v=(m,a)=>(e,t)=>a(e,t,m);import{$ as o,addDisposableListener as we,append as r,setParentFlowTo as De}from"../../../../base/browser/dom.js";import{ActionBar as se}from"../../../../base/browser/ui/actionbar/actionbar.js";import{getDefaultHoverDelegate as f}from"../../../../base/browser/ui/hover/hoverDelegateFactory.js";import{DomScrollableElement as K}from"../../../../base/browser/ui/scrollbar/scrollableElement.js";import{CheckboxActionViewItem as Pe}from"../../../../base/browser/ui/toggle/toggle.js";import{Action as ke}from"../../../../base/common/actions.js";import*as C from"../../../../base/common/arrays.js";import{Cache as O}from"../../../../base/common/cache.js";import{CancellationToken as Me,CancellationTokenSource as re}from"../../../../base/common/cancellation.js";import{isCancellationError as Re}from"../../../../base/common/errors.js";import{Emitter as Le,Event as H}from"../../../../base/common/event.js";import{KeyCode as _,KeyMod as ae}from"../../../../base/common/keyCodes.js";import{Disposable as Ae,DisposableStore as ce,MutableDisposable as Te,dispose as He,toDisposable as x}from"../../../../base/common/lifecycle.js";import{Schemas as W,matchesScheme as N}from"../../../../base/common/network.js";import{language as We}from"../../../../base/common/platform.js";import*as Ne from"../../../../base/common/semver/semver.js";import{isUndefined as le}from"../../../../base/common/types.js";import{URI as k}from"../../../../base/common/uri.js";import{generateUuid as de}from"../../../../base/common/uuid.js";import"./media/extensionEditor.css";import{EditorContextKeys as Ge}from"../../../../editor/common/editorContextKeys.js";import{TokenizationRegistry as Fe}from"../../../../editor/common/languages.js";import{ILanguageService as Ve}from"../../../../editor/common/languages/language.js";import{generateTokensCSSForColorMap as Ze}from"../../../../editor/common/languages/supports/tokenization.js";import{localize as c}from"../../../../nls.js";import{Action2 as B,registerAction2 as U}from"../../../../platform/actions/common/actions.js";import{ContextKeyExpr as G,IContextKeyService as Ke,RawContextKey as Oe}from"../../../../platform/contextkey/common/contextkey.js";import{IContextMenuService as _e}from"../../../../platform/contextview/browser/contextView.js";import{IExtensionGalleryService as Be}from"../../../../platform/extensionManagement/common/extensionManagement.js";import{areSameExtensions as Ue}from"../../../../platform/extensionManagement/common/extensionManagementUtil.js";import{ExtensionType as ue}from"../../../../platform/extensions/common/extensions.js";import{IInstantiationService as ze}from"../../../../platform/instantiation/common/instantiation.js";import{KeybindingWeight as z}from"../../../../platform/keybinding/common/keybindingsRegistry.js";import{INotificationService as je}from"../../../../platform/notification/common/notification.js";import{IOpenerService as Ye}from"../../../../platform/opener/common/opener.js";import{IStorageService as $e}from"../../../../platform/storage/common/storage.js";import{ITelemetryService as Je}from"../../../../platform/telemetry/common/telemetry.js";import{defaultCheckboxStyles as Xe}from"../../../../platform/theme/browser/defaultStyles.js";import{buttonForeground as Qe,buttonHoverBackground as qe,editorBackground as et,textLinkActiveForeground as tt,textLinkForeground as nt}from"../../../../platform/theme/common/colorRegistry.js";import{IThemeService as it,registerThemingParticipant as ot}from"../../../../platform/theme/common/themeService.js";import{IWorkspaceContextService as st}from"../../../../platform/workspace/common/workspace.js";import{EditorPane as rt}from"../../../browser/parts/editor/editorPane.js";import{ExtensionFeaturesTab as at}from"./extensionFeaturesTab.js";import{ButtonWithDropDownExtensionAction as he,ClearLanguageAction as ct,DisableDropDownAction as lt,EnableDropDownAction as dt,ButtonWithDropdownExtensionActionViewItem as ut,DropDownExtensionAction as ht,ExtensionEditorManageExtensionAction as pt,ExtensionStatusAction as vt,ExtensionStatusLabelAction as mt,InstallAnotherVersionAction as gt,InstallDropdownAction as bt,InstallingLabelAction as It,LocalInstallAction as Et,MigrateDeprecatedExtensionAction as ft,ExtensionRuntimeStateAction as xt,RemoteInstallAction as yt,SetColorThemeAction as St,SetFileIconThemeAction as Ct,SetLanguageAction as wt,SetProductIconThemeAction as Dt,ToggleAutoUpdateForExtensionAction as pe,UninstallAction as ve,UpdateAction as Pt,WebInstallAction as kt,TogglePreReleaseExtensionAction as Mt}from"./extensionsActions.js";import{Delegate as Rt}from"./extensionsList.js";import{ExtensionData as Lt,ExtensionsGridView as At,ExtensionsTree as Tt,getExtensions as Ht}from"./extensionsViewer.js";import{ExtensionRecommendationWidget as Wt,ExtensionStatusWidget as Nt,ExtensionWidget as me,InstallCountWidget as Gt,RatingsWidget as Ft,RemoteBadgeWidget as Vt,SponsorWidget as Zt,VerifiedPublisherWidget as Kt,onClick as M}from"./extensionsWidgets.js";import{ExtensionContainers as Ot,ExtensionEditorTab as b,ExtensionState as _t,IExtensionsWorkbenchService as Bt}from"../common/extensions.js";import{IExplorerService as Ut}from"../../files/browser/files.js";import{DEFAULT_MARKDOWN_STYLES as zt,renderMarkdownDocument as jt}from"../../markdown/browser/markdownDocumentRenderer.js";import{IWebviewService as Yt,KEYBINDING_CONTEXT_WEBVIEW_FIND_WIDGET_FOCUSED as ge}from"../../webview/browser/webview.js";import{IEditorService as $t}from"../../../services/editor/common/editorService.js";import{IExtensionRecommendationsService as Jt}from"../../../services/extensionRecommendations/common/extensionRecommendations.js";import{IExtensionService as Xt}from"../../../services/extensions/common/extensions.js";import{IViewsService as Qt}from"../../../services/views/common/viewsService.js";import{VIEW_ID as qt}from"../../files/common/files.js";import{IUriIdentityService as en}from"../../../../platform/uriIdentity/common/uriIdentity.js";import{IHoverService as tn}from"../../../../platform/hover/browser/hover.js";class nn extends Ae{_onChange=this._register(new Le);get onChange(){return this._onChange.event}_currentId=null;get currentId(){return this._currentId}actions;actionbar;constructor(a){super();const e=r(a,o(".navbar"));this.actions=[],this.actionbar=this._register(new se(e))}push(a,e,t){const n=new ke(a,e,void 0,!0,()=>this.update(a,!0));n.tooltip=t,this.actions.push(n),this.actionbar.push(n),this.actions.length===1&&this.update(a)}clear(){this.actions=He(this.actions),this.actionbar.clear()}switch(a){const e=this.actions.find(t=>t.id===a);return e?(e.run(),!0):!1}update(a,e){this._currentId=a,this._onChange.fire({id:a,focus:!!e}),this.actions.forEach(t=>t.checked=t.id===a)}}var on=(e=>(e[e.Readme=0]="Readme",e[e.Changelog=1]="Changelog",e))(on||{});const sn=new Oe("showPreReleaseVersion",!1);class rn extends me{_gallery=null;get gallery(){return this._gallery}set gallery(a){this.extension&&a&&!Ue(this.extension.identifier,a.identifier)||(this._gallery=a,this.update())}}class an extends rn{element;constructor(a,e){super(),this.element=r(a,o("code.version")),this._register(e.setupManagedHover(f("mouse"),this.element,c("extension version","Extension Version"))),this.render()}render(){!this.extension||!Ne.valid(this.extension.version)||(this.element.textContent=`v${this.gallery?.version??this.extension.version}${this.extension.isPreReleaseVersion?" (pre-release)":""}`)}}let y=class extends rt{constructor(e,t,n,i,s,l,u,h,d,I,S,g,w,D,$,J,F,L,X,R){super(y.ID,e,t,l,I);this.instantiationService=n;this.extensionsWorkbenchService=i;this.extensionGalleryService=s;this.notificationService=u;this.openerService=h;this.extensionRecommendationsService=d;this.extensionService=S;this.webviewService=g;this.languageService=w;this.contextMenuService=D;this.contextKeyService=$;this.contextService=J;this.explorerService=F;this.viewsService=L;this.uriIdentityService=X;this.hoverService=R;this.extensionReadme=null,this.extensionChangelog=null,this.extensionManifest=null}static ID="workbench.editor.extension";_scopedContextKeyService=this._register(new Te);template;extensionReadme;extensionChangelog;extensionManifest;initialScrollProgress=new Map;currentIdentifier="";layoutParticipants=[];contentDisposables=this._register(new ce);transientDisposables=this._register(new ce);activeElement=null;dimension;showPreReleaseVersionContextKey;get scopedContextKeyService(){return this._scopedContextKeyService.value}createEditor(e){const t=r(e,o(".extension-editor"));this._scopedContextKeyService.value=this.contextKeyService.createScoped(t),this._scopedContextKeyService.value.createKey("inExtensionEditor",!0),this.showPreReleaseVersionContextKey=sn.bindTo(this._scopedContextKeyService.value),t.tabIndex=0,t.style.outline="none",t.setAttribute("role","document");const n=r(t,o(".header")),i=r(n,o(".icon-container")),s=r(i,o("img.icon",{draggable:!1,alt:""})),l=this.instantiationService.createInstance(Vt,i,!0),u=r(n,o(".details")),h=r(u,o(".title")),d=r(h,o("span.name.clickable",{role:"heading",tabIndex:0}));this._register(this.hoverService.setupManagedHover(f("mouse"),d,c("name","Extension name")));const I=new an(h,this.hoverService),S=r(h,o("span.preview"));this._register(this.hoverService.setupManagedHover(f("mouse"),S,c("preview","Preview"))),S.textContent=c("preview","Preview");const g=r(h,o("span.builtin"));g.textContent=c("builtin","Built-in");const w=r(u,o(".subtitle")),D=r(r(w,o(".subtitle-entry")),o(".publisher.clickable",{tabIndex:0}));this._register(this.hoverService.setupManagedHover(f("mouse"),D,c("publisher","Publisher"))),D.setAttribute("role","button");const $=r(D,o(".publisher-name")),J=this.instantiationService.createInstance(Kt,r(D,o(".verified-publisher")),!1),F=r(r(w,o(".subtitle-entry.resource")),o("",{tabIndex:0}));F.setAttribute("role","button");const L=r(r(w,o(".subtitle-entry")),o("span.install",{tabIndex:0}));this._register(this.hoverService.setupManagedHover(f("mouse"),L,c("install count","Install count")));const X=this.instantiationService.createInstance(Gt,L,!1),R=r(r(w,o(".subtitle-entry")),o("span.rating.clickable",{tabIndex:0}));this._register(this.hoverService.setupManagedHover(f("mouse"),R,c("rating","Rating"))),R.setAttribute("role","link");const be=this.instantiationService.createInstance(Ft,R,!1),Ie=this.instantiationService.createInstance(Zt,r(w,o(".subtitle-entry"))),V=[l,I,J,X,be,Ie],Ee=r(u,o(".description")),Q=this.instantiationService.createInstance(bt),A=[this.instantiationService.createInstance(xt),this.instantiationService.createInstance(mt),this.instantiationService.createInstance(Pt,!0),this.instantiationService.createInstance(St),this.instantiationService.createInstance(Ct),this.instantiationService.createInstance(Dt),this.instantiationService.createInstance(wt),this.instantiationService.createInstance(ct),this.instantiationService.createInstance(dt),this.instantiationService.createInstance(lt),this.instantiationService.createInstance(yt,!1),this.instantiationService.createInstance(Et),this.instantiationService.createInstance(kt),Q,this.instantiationService.createInstance(It),this.instantiationService.createInstance(he,"extensions.uninstall",ve.UninstallClass,[[this.instantiationService.createInstance(ft,!1),this.instantiationService.createInstance(ve),this.instantiationService.createInstance(gt,null,!0)]]),this.instantiationService.createInstance(Mt),this.instantiationService.createInstance(pe),new pt(this.scopedContextKeyService||this.contextKeyService,this.instantiationService)],T=r(u,o(".actions-status-container")),P=this._register(new se(T,{actionViewItemProvider:(p,E)=>{if(p instanceof ht)return p.createActionViewItem(E);if(p instanceof he)return new ut(p,{...E,icon:!0,label:!0,menuActionsOrProvider:{getActions:()=>p.menuActions},menuActionClassNames:p.menuActionClassNames},this.contextMenuService);if(p instanceof pe)return new Pe(void 0,p,{...E,icon:!0,label:!0,checkboxStyles:Xe})},focusOnlyEnabledItems:!0}));P.push(A,{icon:!0,label:!0}),P.setFocusable(!0),this._register(H.any(...A.map(p=>H.filter(p.onDidChange,E=>E.enabled!==void 0)))(()=>{P.setFocusable(!1),P.setFocusable(!0)}));const Z=[],q=this.instantiationService.createInstance(vt),fe=this._register(this.instantiationService.createInstance(Nt,r(T,o(".status")),q));Z.push(q,new class extends me{render(){T.classList.toggle("list-layout",this.extension?.state===_t.Installed)}});const ee=this.instantiationService.createInstance(Wt,r(u,o(".recommendation")));V.push(ee),this._register(H.any(fe.onDidRender,ee.onDidRender)(()=>{this.dimension&&this.layout(this.dimension)}));const te=this.instantiationService.createInstance(Ot,[...A,...V,...Z]);for(const p of[...A,...V,...Z,te])this._register(p);const xe=H.chain(P.onDidRun,p=>p.map(({error:E})=>E).filter(E=>!!E));this._register(xe(this.onError,this));const ne=r(t,o(".body")),ye=new nn(ne),ie=r(ne,o(".content"));ie.id=de(),this.template={builtin:g,content:ie,description:Ee,header:n,icon:s,iconContainer:i,installCount:L,name:d,navbar:ye,preview:S,publisher:D,publisherDisplayName:$,resource:F,rating:R,actionsAndStatusContainer:T,extensionActionBar:P,set extension(p){te.extension=p},set gallery(p){I.gallery=p},set manifest(p){Q.manifest=p}}}async setInput(e,t,n,i){await super.setInput(e,t,n,i),this.updatePreReleaseVersionContext(),this.template&&await this.render(e.extension,this.template,!!t?.preserveFocus)}setOptions(e){const t=this.options;if(super.setOptions(e),this.updatePreReleaseVersionContext(),this.input&&this.template&&t?.showPreReleaseVersion!==e?.showPreReleaseVersion){this.render(this.input.extension,this.template,!!e?.preserveFocus);return}e?.tab&&this.template?.navbar.switch(e.tab)}updatePreReleaseVersionContext(){let e=this.options?.showPreReleaseVersion;le(e)&&(e=!!this.input.extension.gallery?.properties.isPreReleaseVersion),this.showPreReleaseVersionContextKey?.set(e)}async openTab(e){!this.input||!this.template||this.template.navbar.switch(e)||e===b.ExtensionPack&&this.template.navbar.switch(b.Readme)}async getGalleryVersionToShow(e,t){return e.resourceExtension||e.local?.source==="resource"||le(t)||t===e.gallery?.properties.isPreReleaseVersion||t&&!e.hasPreReleaseVersion||!t&&!e.hasReleaseVersion?null:(await this.extensionGalleryService.getExtensions([{...e.identifier,preRelease:t,hasPreRelease:e.hasPreReleaseVersion}],Me.None))[0]||null}async render(e,t,n){this.activeElement=null,this.transientDisposables.clear();const i=this.transientDisposables.add(new re).token,s=await this.getGalleryVersionToShow(e,this.options?.showPreReleaseVersion);if(i.isCancellationRequested)return;this.extensionReadme=new O(()=>s?this.extensionGalleryService.getReadme(s,i):e.getReadme(i)),this.extensionChangelog=new O(()=>s?this.extensionGalleryService.getChangelog(s,i):e.getChangelog(i)),this.extensionManifest=new O(()=>s?this.extensionGalleryService.getManifest(s,i):e.getManifest(i)),t.extension=e,t.gallery=s,t.manifest=null,this.transientDisposables.add(we(t.icon,"error",()=>t.icon.src=e.iconUrlFallback,{once:!0})),t.icon.src=e.iconUrl,t.name.textContent=e.displayName,t.name.classList.toggle("clickable",!!e.url),t.name.classList.toggle("deprecated",!!e.deprecationInfo),t.preview.style.display=e.preview?"inherit":"none",t.builtin.style.display=e.isBuiltin?"inherit":"none",t.description.textContent=e.description,t.publisher.classList.toggle("clickable",!!e.url),t.publisherDisplayName.textContent=e.publisherDisplayName,t.publisher.parentElement?.classList.toggle("hide",!!e.resourceExtension||e.local?.source==="resource");const l=e.resourceExtension?.location??(e.local?.source==="resource"?e.local?.location:void 0);if(t.resource.parentElement?.classList.toggle("hide",!l),l){const I=this.contextService.getWorkspaceFolder(l);I&&e.isWorkspaceScoped?(t.resource.parentElement?.classList.add("clickable"),this.transientDisposables.add(this.hoverService.setupManagedHover(f("mouse"),t.resource,this.uriIdentityService.extUri.relativePath(I.uri,l))),t.resource.textContent=c("workspace extension","Workspace Extension"),this.transientDisposables.add(M(t.resource,()=>{this.viewsService.openView(qt,!0).then(()=>this.explorerService.select(l,!0))}))):(t.resource.parentElement?.classList.remove("clickable"),this.transientDisposables.add(this.hoverService.setupManagedHover(f("mouse"),t.resource,l.path)),t.resource.textContent=c("local extension","Local Extension"))}t.installCount.parentElement?.classList.toggle("hide",!e.url),t.rating.parentElement?.classList.toggle("hide",!e.url),t.rating.classList.toggle("clickable",!!e.url),e.url&&(this.transientDisposables.add(M(t.name,()=>this.openerService.open(k.parse(e.url)))),this.transientDisposables.add(M(t.rating,()=>this.openerService.open(k.parse(`${e.url}&ssr=false#review-details`)))),this.transientDisposables.add(M(t.publisher,()=>this.extensionsWorkbenchService.openSearch(`publisher:"${e.publisherDisplayName}"`))));const u=await this.extensionManifest.get().promise;if(i.isCancellationRequested)return;u&&(t.manifest=u),this.renderNavbar(e,u,t,n);const h=this.extensionRecommendationsService.getAllRecommendationsWithReason();let d={};h[e.identifier.id.toLowerCase()]&&(d={recommendationReason:h[e.identifier.id.toLowerCase()].reasonId}),this.telemetryService.publicLog("extensionGallery:openExtension",{...e.telemetryData,...d})}renderNavbar(e,t,n,i){n.content.innerText="",n.navbar.clear(),this.currentIdentifier!==e.identifier.id&&(this.initialScrollProgress.clear(),this.currentIdentifier=e.identifier.id),n.navbar.push(b.Readme,c("details","Details"),c("detailstooltip","Extension details, rendered from the extension's 'README.md' file")),t&&n.navbar.push(b.Features,c("features","Features"),c("featurestooltip","Lists features contributed by this extension")),e.hasChangelog()&&n.navbar.push(b.Changelog,c("changelog","Changelog"),c("changelogtooltip","Extension update history, rendered from the extension's 'CHANGELOG.md' file")),e.dependencies.length&&n.navbar.push(b.Dependencies,c("dependencies","Dependencies"),c("dependenciestooltip","Lists extensions this extension depends on")),t&&t.extensionPack?.length&&!this.shallRenderAsExtensionPack(t)&&n.navbar.push(b.ExtensionPack,c("extensionpack","Extension Pack"),c("extensionpacktooltip","Lists extensions those will be installed together with this extension")),this.options?.tab&&n.navbar.switch(this.options.tab),n.navbar.currentId&&this.onNavbarChange(e,{id:n.navbar.currentId,focus:!i},n),n.navbar.onChange(s=>this.onNavbarChange(e,s,n),this,this.transientDisposables)}clearInput(){this.contentDisposables.clear(),this.transientDisposables.clear(),super.clearInput()}focus(){super.focus(),this.activeElement?.focus()}showFind(){this.activeWebview?.showFind()}runFindAction(e){this.activeWebview?.runFindAction(e)}get activeWebview(){if(!(!this.activeElement||!this.activeElement.runFindAction))return this.activeElement}onNavbarChange(e,{id:t,focus:n},i){if(this.contentDisposables.clear(),i.content.innerText="",this.activeElement=null,t){const s=new re;this.contentDisposables.add(x(()=>s.dispose(!0))),this.open(t,e,i,s.token).then(l=>{s.token.isCancellationRequested||(this.activeElement=l,n&&this.focus())})}}open(e,t,n,i){switch(e){case b.Readme:return this.openDetails(t,n,i);case b.Features:return this.openFeatures(n,i);case b.Changelog:return this.openChangelog(t,n,i);case b.Dependencies:return this.openExtensionDependencies(t,n,i);case b.ExtensionPack:return this.openExtensionPack(t,n,i)}return Promise.resolve(null)}async openMarkdown(e,t,n,i,s,l,u){try{const h=await this.renderMarkdown(e,t,i,u);if(u.isCancellationRequested)return Promise.resolve(null);const d=this.contentDisposables.add(this.webviewService.createWebviewOverlay({title:l,options:{enableFindWidget:!0,tryRestoreScrollPosition:!0,disableServiceWorker:!0},contentOptions:{},extension:void 0}));d.initialScrollProgress=this.initialScrollProgress.get(s)||0,d.claim(this,this.window,this.scopedContextKeyService),De(d.container,i),d.layoutWebviewOverElement(i),d.setHtml(h),d.claim(this,this.window,void 0),this.contentDisposables.add(d.onDidFocus(()=>this._onDidFocus?.fire())),this.contentDisposables.add(d.onDidScroll(()=>this.initialScrollProgress.set(s,d.initialScrollProgress)));const I=C.insert(this.layoutParticipants,{layout:()=>{d.layoutWebviewOverElement(i)}});this.contentDisposables.add(x(I));let S=!1;return this.contentDisposables.add(x(()=>{S=!0})),this.contentDisposables.add(this.themeService.onDidColorThemeChange(async()=>{const g=await this.renderMarkdown(e,t,i);S||d.setHtml(g)})),this.contentDisposables.add(d.onDidClickLink(g=>{g&&((N(g,W.http)||N(g,W.https)||N(g,W.mailto))&&this.openerService.open(g),N(g,W.command)&&e.type===ue.System&&this.openerService.open(g,{allowCommands:!0}))})),d}catch{const d=r(i,o("p.nocontent"));return d.textContent=n,d}}async renderMarkdown(e,t,n,i){const s=await this.loadContents(()=>t,n);if(i?.isCancellationRequested)return"";const l=await jt(s,this.extensionService,this.languageService,{shouldSanitize:e.type!==ue.System,token:i});return i?.isCancellationRequested?"":this.renderBody(l)}renderBody(e){const t=de(),n=Fe.getColorMap(),i=n?Ze(n):"";return`<!DOCTYPE html>
		<html>
			<head>
				<meta http-equiv="Content-type" content="text/html;charset=UTF-8">
				<meta http-equiv="Content-Security-Policy" content="default-src 'none'; img-src https: data:; media-src https:; script-src 'none'; style-src 'nonce-${t}';">
				<style nonce="${t}">
					${zt}

					/* prevent scroll-to-top button from blocking the body text */
					body {
						padding-bottom: 75px;
					}

					#scroll-to-top {
						position: fixed;
						width: 32px;
						height: 32px;
						right: 25px;
						bottom: 25px;
						background-color: var(--vscode-button-secondaryBackground);
						border-color: var(--vscode-button-border);
						border-radius: 50%;
						cursor: pointer;
						box-shadow: 1px 1px 1px rgba(0,0,0,.25);
						outline: none;
						display: flex;
						justify-content: center;
						align-items: center;
					}

					#scroll-to-top:hover {
						background-color: var(--vscode-button-secondaryHoverBackground);
						box-shadow: 2px 2px 2px rgba(0,0,0,.25);
					}

					body.vscode-high-contrast #scroll-to-top {
						border-width: 2px;
						border-style: solid;
						box-shadow: none;
					}

					#scroll-to-top span.icon::before {
						content: "";
						display: block;
						background: var(--vscode-button-secondaryForeground);
						/* Chevron up icon */
						webkit-mask-image: url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDE5LjIuMCwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IgoJIHZpZXdCb3g9IjAgMCAxNiAxNiIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgMTYgMTY7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4KPHN0eWxlIHR5cGU9InRleHQvY3NzIj4KCS5zdDB7ZmlsbDojRkZGRkZGO30KCS5zdDF7ZmlsbDpub25lO30KPC9zdHlsZT4KPHRpdGxlPnVwY2hldnJvbjwvdGl0bGU+CjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik04LDUuMWwtNy4zLDcuM0wwLDExLjZsOC04bDgsOGwtMC43LDAuN0w4LDUuMXoiLz4KPHJlY3QgY2xhc3M9InN0MSIgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2Ii8+Cjwvc3ZnPgo=');
						-webkit-mask-image: url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDE5LjIuMCwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IgoJIHZpZXdCb3g9IjAgMCAxNiAxNiIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgMTYgMTY7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4KPHN0eWxlIHR5cGU9InRleHQvY3NzIj4KCS5zdDB7ZmlsbDojRkZGRkZGO30KCS5zdDF7ZmlsbDpub25lO30KPC9zdHlsZT4KPHRpdGxlPnVwY2hldnJvbjwvdGl0bGU+CjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik04LDUuMWwtNy4zLDcuM0wwLDExLjZsOC04bDgsOGwtMC43LDAuN0w4LDUuMXoiLz4KPHJlY3QgY2xhc3M9InN0MSIgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2Ii8+Cjwvc3ZnPgo=');
						width: 16px;
						height: 16px;
					}
					${i}
				</style>
			</head>
			<body>
				<a id="scroll-to-top" role="button" aria-label="scroll to top" href="#"><span class="icon"></span></a>
				${e}
			</body>
		</html>`}async openDetails(e,t,n){const i=r(t.content,o(".details")),s=r(i,o(".readme-container")),l=r(i,o(".additional-details-container")),u=()=>i.classList.toggle("narrow",this.dimension&&this.dimension.width<500);u(),this.contentDisposables.add(x(C.insert(this.layoutParticipants,{layout:u})));let h=null;const d=await this.extensionManifest.get().promise;return d&&d.extensionPack?.length&&this.shallRenderAsExtensionPack(d)?h=await this.openExtensionPackReadme(e,d,s,n):h=await this.openMarkdown(e,this.extensionReadme.get(),c("noReadme","No README available."),s,0,c("Readme title","Readme"),n),this.renderAdditionalDetails(l,e),h}shallRenderAsExtensionPack(e){return!!e.categories?.some(t=>t.toLowerCase()==="extension packs")}async openExtensionPackReadme(e,t,n,i){if(i.isCancellationRequested)return Promise.resolve(null);const s=r(n,o("div",{class:"extension-pack-readme"}));s.style.margin="0 auto",s.style.maxWidth="882px";const l=r(s,o("div",{class:"extension-pack"}));t.extensionPack.length<=3?s.classList.add("one-row"):t.extensionPack.length<=6?s.classList.add("two-rows"):t.extensionPack.length<=9?s.classList.add("three-rows"):s.classList.add("more-rows");const u=r(l,o("div.header"));u.textContent=c("extension pack","Extension Pack ({0})",t.extensionPack.length);const h=r(l,o("div",{class:"extension-pack-content"}));h.setAttribute("tabindex","0"),r(l,o("div.footer"));const d=r(s,o("div.readme-content"));return await Promise.all([this.renderExtensionPack(t,h,i),this.openMarkdown(e,this.extensionReadme.get(),c("noReadme","No README available."),d,0,c("Readme title","Readme"),i)]),{focus:()=>h.focus()}}renderAdditionalDetails(e,t){const n=o("div",{class:"additional-details-content",tabindex:"0"}),i=new K(n,{}),s=()=>i.scanDomNode(),l=C.insert(this.layoutParticipants,{layout:s});this.contentDisposables.add(x(l)),this.contentDisposables.add(i),this.renderCategories(n,t),this.renderExtensionResources(n,t),this.renderMoreInfo(n,t),r(e,i.getDomNode()),i.scanDomNode()}renderCategories(e,t){if(t.categories.length){const n=r(e,o(".categories-container.additional-details-element"));r(n,o(".additional-details-title",void 0,c("categories","Categories")));const i=r(n,o(".categories"));for(const s of t.categories)this.transientDisposables.add(M(r(i,o("span.category",{tabindex:"0"},s)),()=>this.extensionsWorkbenchService.openSearch(`@category:"${s}"`)))}}renderExtensionResources(e,t){const n=[];if(t.url&&n.push([c("Marketplace","Marketplace"),k.parse(t.url)]),t.url&&t.supportUrl)try{n.push([c("issues","Issues"),k.parse(t.supportUrl)])}catch{}if(t.repository)try{n.push([c("repository","Repository"),k.parse(t.repository)])}catch{}if(t.url&&t.licenseUrl)try{n.push([c("license","License"),k.parse(t.licenseUrl)])}catch{}if(t.publisherUrl&&n.push([t.publisherDisplayName,t.publisherUrl]),n.length||t.publisherSponsorLink){const i=r(e,o(".resources-container.additional-details-element"));r(i,o(".additional-details-title",void 0,c("resources","Resources")));const s=r(i,o(".resources"));for(const[l,u]of n){const h=r(s,o("a.resource",{tabindex:"0"},l));this.transientDisposables.add(M(h,()=>this.openerService.open(u))),this.transientDisposables.add(this.hoverService.setupManagedHover(f("mouse"),h,u.toString()))}}}renderMoreInfo(e,t){const n=t.gallery,i=r(e,o(".more-info-container.additional-details-element"));r(i,o(".additional-details-title",void 0,c("Marketplace Info","More Info")));const s=r(i,o(".more-info")),l=u=>`${u.getFullYear()}-${String(u.getMonth()+1).padStart(2,"0")}-${String(u.getDate()).padStart(2,"0")}, ${u.toLocaleTimeString(We,{hourCycle:"h23"})}`;n&&r(s,o(".more-info-entry",void 0,o("div",void 0,c("published","Published")),o("div",void 0,l(new Date(n.releaseDate)))),o(".more-info-entry",void 0,o("div",void 0,c("last released","Last released")),o("div",void 0,l(new Date(n.lastUpdated))))),t.local&&t.local.installedTimestamp&&r(s,o(".more-info-entry",void 0,o("div",void 0,c("last updated","Last updated")),o("div",void 0,l(new Date(t.local.installedTimestamp))))),r(s,o(".more-info-entry",void 0,o("div",void 0,c("id","Identifier")),o("code",void 0,t.identifier.id)))}openChangelog(e,t,n){return this.openMarkdown(e,this.extensionChangelog.get(),c("noChangelog","No Changelog available."),t.content,1,c("Changelog title","Changelog"),n)}async openFeatures(e,t){const n=await this.loadContents(()=>this.extensionManifest.get(),e.content);if(t.isCancellationRequested||!n)return null;const i=this.contentDisposables.add(this.instantiationService.createInstance(at,n,this.options?.feature)),s=()=>i.layout(e.content.clientHeight,e.content.clientWidth),l=C.insert(this.layoutParticipants,{layout:s});return this.contentDisposables.add(x(l)),r(e.content,i.domNode),s(),i.domNode}openExtensionDependencies(e,t,n){if(n.isCancellationRequested)return Promise.resolve(null);if(C.isFalsyOrEmpty(e.dependencies))return r(t.content,o("p.nocontent")).textContent=c("noDependencies","No Dependencies"),Promise.resolve(t.content);const i=o("div",{class:"subcontent"}),s=new K(i,{});r(t.content,s.getDomNode()),this.contentDisposables.add(s);const l=this.instantiationService.createInstance(Tt,new Lt(e,null,d=>d.dependencies||[],this.extensionsWorkbenchService),i,{listBackground:et}),u=()=>{s.scanDomNode();const d=s.getScrollDimensions();l.layout(d.height)},h=C.insert(this.layoutParticipants,{layout:u});return this.contentDisposables.add(x(h)),this.contentDisposables.add(l),s.scanDomNode(),Promise.resolve({focus(){l.domFocus()}})}async openExtensionPack(e,t,n){if(n.isCancellationRequested)return Promise.resolve(null);const i=await this.loadContents(()=>this.extensionManifest.get(),t.content);return n.isCancellationRequested||!i?null:this.renderExtensionPack(i,t.content,n)}async renderExtensionPack(e,t,n){if(n.isCancellationRequested)return null;const i=o("div",{class:"subcontent"}),s=new K(i,{useShadows:!1});r(t,s.getDomNode());const l=this.instantiationService.createInstance(At,i,new Rt),u=await Ht(e.extensionPack,this.extensionsWorkbenchService);return l.setExtensions(u),s.scanDomNode(),this.contentDisposables.add(s),this.contentDisposables.add(l),this.contentDisposables.add(x(C.insert(this.layoutParticipants,{layout:()=>s.scanDomNode()}))),i}loadContents(e,t){t.classList.add("loading");const n=this.contentDisposables.add(e()),i=()=>t.classList.remove("loading");return n.promise.then(i,i),n.promise}layout(e){this.dimension=e,this.layoutParticipants.forEach(t=>t.layout())}onError(e){Re(e)||this.notificationService.error(e)}};y=oe([v(1,Je),v(2,ze),v(3,Bt),v(4,Be),v(5,it),v(6,je),v(7,Ye),v(8,Jt),v(9,$e),v(10,Xt),v(11,Yt),v(12,Ve),v(13,_e),v(14,Ke),v(15,st),v(16,Ut),v(17,Qt),v(18,en),v(19,tn)],y);const j=G.and(G.equals("activeEditor",y.ID),Ge.focus.toNegated());U(class extends B{constructor(){super({id:"editor.action.extensioneditor.showfind",title:c("find","Find"),keybinding:{when:j,weight:z.EditorContrib,primary:ae.CtrlCmd|_.KeyF}})}run(a){Y(a)?.showFind()}}),U(class extends B{constructor(){super({id:"editor.action.extensioneditor.findNext",title:c("find next","Find Next"),keybinding:{when:G.and(j,ge),primary:_.Enter,weight:z.EditorContrib}})}run(a){Y(a)?.runFindAction(!1)}}),U(class extends B{constructor(){super({id:"editor.action.extensioneditor.findPrevious",title:c("find previous","Find Previous"),keybinding:{when:G.and(j,ge),primary:ae.Shift|_.Enter,weight:z.EditorContrib}})}run(a){Y(a)?.runFindAction(!0)}}),ot((m,a)=>{const e=m.getColor(nt);e&&(a.addRule(`.monaco-workbench .extension-editor .content .details .additional-details-container .resources-container a.resource { color: ${e}; }`),a.addRule(`.monaco-workbench .extension-editor .content .feature-contributions a { color: ${e}; }`));const t=m.getColor(tt);t&&(a.addRule(`.monaco-workbench .extension-editor .content .details .additional-details-container .resources-container a.resource:hover,
			.monaco-workbench .extension-editor .content .details .additional-details-container .resources-container a.resource:active { color: ${t}; }`),a.addRule(`.monaco-workbench .extension-editor .content .feature-contributions a:hover,
			.monaco-workbench .extension-editor .content .feature-contributions a:active { color: ${t}; }`));const n=m.getColor(qe);n&&(a.addRule(`.monaco-workbench .extension-editor .content > .details > .additional-details-container .categories-container > .categories > .category:hover { background-color: ${n}; border-color: ${n}; }`),a.addRule(`.monaco-workbench .extension-editor .content > .details > .additional-details-container .tags-container > .tags > .tag:hover { background-color: ${n}; border-color: ${n}; }`));const i=m.getColor(Qe);i&&(a.addRule(`.monaco-workbench .extension-editor .content > .details > .additional-details-container .categories-container > .categories > .category:hover { color: ${i}; }`),a.addRule(`.monaco-workbench .extension-editor .content > .details > .additional-details-container .tags-container > .tags > .tag:hover { color: ${i}; }`))});function Y(m){const a=m.get($t).activeEditorPane;return a instanceof y?a:null}export{y as ExtensionEditor};
