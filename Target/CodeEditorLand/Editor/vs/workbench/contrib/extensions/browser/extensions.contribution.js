var Ze=Object.defineProperty;var Je=Object.getOwnPropertyDescriptor;var ne=(x,m,n,o)=>{for(var i=o>1?void 0:o?Je(m,n):m,a=x.length-1,r;a>=0;a--)(r=x[a])&&(i=(o?r(m,n,i):r(i))||i);return o&&i&&Ze(m,n,i),i},A=(x,m)=>(n,o)=>m(n,o,x);import{localize as t,localize2 as u}from"../../../../nls.js";import{KeyMod as ve,KeyCode as Ye}from"../../../../base/common/keyCodes.js";import{Registry as D}from"../../../../platform/registry/common/platform.js";import{MenuRegistry as L,MenuId as s,registerAction2 as ye,Action2 as en}from"../../../../platform/actions/common/actions.js";import{InstantiationType as te,registerSingleton as ie}from"../../../../platform/instantiation/common/extensions.js";import{ExtensionsLocalizedLabel as h,IExtensionManagementService as Ie,IExtensionGalleryService as ke,PreferencesLocalizedLabel as Ae,InstallOperation as nn,EXTENSION_INSTALL_SOURCE_CONTEXT as Ce,ExtensionInstallSource as Re}from"../../../../platform/extensionManagement/common/extensionManagement.js";import{EnablementState as O,IExtensionManagementServerService as tn,IWorkbenchExtensionEnablementService as on,IWorkbenchExtensionManagementService as We,extensionsConfigurationNodeBase as sn}from"../../../services/extensionManagement/common/extensionManagement.js";import{IExtensionIgnoredRecommendationsService as Te,IExtensionRecommendationsService as rn}from"../../../services/extensionRecommendations/common/extensionRecommendations.js";import{Extensions as an}from"../../../common/contributions.js";import{SyncDescriptor as Pe}from"../../../../platform/instantiation/common/descriptors.js";import{VIEWLET_ID as v,IExtensionsWorkbenchService as E,TOGGLE_IGNORE_EXTENSION_ACTION_ID as cn,INSTALL_EXTENSION_FROM_VSIX_COMMAND_ID as Ve,WORKSPACE_RECOMMENDATIONS_VIEW_ID as oe,AutoUpdateConfigurationKey as _,HasOutdatedExtensionsContext as ln,SELECT_INSTALL_VSIX_EXTENSION_COMMAND_ID as dn,LIST_WORKSPACE_UNSUPPORTED_EXTENSIONS_COMMAND_ID as un,THEME_ACTIONS_GROUP as se,INSTALL_ACTIONS_GROUP as U,OUTDATED_EXTENSIONS_VIEW_ID as xn,CONTEXT_HAS_GALLERY as p,extensionsSearchActionsMenu as De,UPDATE_ACTIONS_GROUP as _e,ExtensionRuntimeActionType as Me}from"../common/extensions.js";import{ReinstallAction as q,InstallSpecificVersionOfExtensionAction as F,ConfigureWorkspaceRecommendedExtensionsAction as X,ConfigureWorkspaceFolderRecommendedExtensionsAction as B,PromptExtensionInstallFailureAction as mn,SetColorThemeAction as re,SetFileIconThemeAction as ae,SetProductIconThemeAction as ce,ClearLanguageAction as le,ToggleAutoUpdateForExtensionAction as de,ToggleAutoUpdatesForPublisherAction as ue,TogglePreReleaseExtensionAction as Le,InstallAnotherVersionAction as xe,InstallAction as Ne}from"./extensionsActions.js";import{ExtensionsInput as me}from"../common/extensionsInput.js";import{ExtensionEditor as he}from"./extensionEditor.js";import{StatusUpdater as hn,MaliciousExtensionChecker as pn,ExtensionsViewletViewsContribution as gn,ExtensionsViewPaneContainer as En,BuiltInExtensionsContext as G,SearchMarketplaceExtensionsContext as bn,RecommendedExtensionsContext as fn,DefaultViewsContext as Oe,ExtensionsSortByContext as Sn,SearchHasTextContext as wn}from"./extensionsViewlet.js";import{Extensions as vn,ConfigurationScope as z}from"../../../../platform/configuration/common/configurationRegistry.js";import*as yn from"../../../../platform/jsonschemas/common/jsonContributionRegistry.js";import{ExtensionsConfigurationSchema as In,ExtensionsConfigurationSchemaId as kn}from"../common/extensionsFileTemplate.js";import{CommandsRegistry as H,ICommandService as pe}from"../../../../platform/commands/common/commands.js";import{IInstantiationService as C}from"../../../../platform/instantiation/common/instantiation.js";import{KeymapExtensions as An}from"../common/extensionsUtils.js";import{areSameExtensions as y,getIdAndVersion as Cn}from"../../../../platform/extensionManagement/common/extensionManagementUtil.js";import{EditorPaneDescriptor as Rn}from"../../../browser/editor.js";import{LifecyclePhase as R}from"../../../services/lifecycle/common/lifecycle.js";import{URI as ge}from"../../../../base/common/uri.js";import{ExtensionActivationProgress as Wn}from"./extensionsActivationProgress.js";import{onUnexpectedError as Ue}from"../../../../base/common/errors.js";import{ExtensionDependencyChecker as Tn}from"./extensionsDependencyChecker.js";import{CancellationToken as V}from"../../../../base/common/cancellation.js";import{ViewContainerLocation as Pn,Extensions as Vn}from"../../../common/views.js";import{IViewsService as K}from"../../../services/views/common/viewsService.js";import{IClipboardService as qe}from"../../../../platform/clipboard/common/clipboardService.js";import{IPreferencesService as Fe}from"../../../services/preferences/common/preferences.js";import{ContextKeyExpr as e,IContextKeyService as Dn,RawContextKey as Ee}from"../../../../platform/contextkey/common/contextkey.js";import{Extensions as Xe}from"../../../../platform/quickinput/common/quickAccess.js";import{InstallExtensionQuickAccessProvider as Be,ManageExtensionsQuickAccessProvider as Ge}from"./extensionsQuickAccess.js";import{ExtensionRecommendationsService as _n}from"./extensionRecommendationsService.js";import{CONTEXT_SYNC_ENABLEMENT as be}from"../../../services/userDataSync/common/userDataSync.js";import{CopyAction as Mn,CutAction as Ln,PasteAction as Nn}from"../../../../editor/contrib/clipboard/browser/clipboard.js";import{IEditorService as fe}from"../../../services/editor/common/editorService.js";import{ExtensionsWorkbenchService as On}from"./extensionsWorkbenchService.js";import{Categories as He}from"../../../../platform/action/common/actionCommonCategories.js";import{IExtensionRecommendationNotificationService as Un}from"../../../../platform/extensionRecommendations/common/extensionRecommendations.js";import{ExtensionRecommendationNotificationService as qn}from"./extensionRecommendationNotificationService.js";import{INotificationService as Fn,Severity as Se}from"../../../../platform/notification/common/notification.js";import{IHostService as Xn}from"../../../services/host/browser/host.js";import{ResourceContextKey as Bn,WorkbenchStateContext as P}from"../../../common/contextkeys.js";import{IWorkspaceExtensionsConfigService as Z}from"../../../services/extensionRecommendations/common/workspaceExtensionsConfig.js";import{Schemas as J}from"../../../../base/common/network.js";import{ShowRuntimeExtensionsAction as Gn}from"./abstractRuntimeExtensionsEditor.js";import{ExtensionEnablementWorkspaceTrustTransitionParticipant as Hn}from"./extensionEnablementWorkspaceTrustTransitionParticipant.js";import{clearSearchResultsIcon as Kn,configureRecommendedIcon as Qn,extensionsViewIcon as jn,filterIcon as $n,installWorkspaceRecommendedIcon as Ke,refreshIcon as zn}from"./extensionsIcons.js";import{EXTENSION_CATEGORIES as Zn}from"../../../../platform/extensions/common/extensions.js";import{Disposable as Jn,DisposableStore as Qe,isDisposable as Yn}from"../../../../base/common/lifecycle.js";import{IDialogService as et,IFileDialogService as je}from"../../../../platform/dialogs/common/dialogs.js";import{mnemonicButtonLabel as nt}from"../../../../base/common/labels.js";import{Query as $e}from"../common/extensionQuery.js";import{EditorExtensions as tt}from"../../../common/editor.js";import{WORKSPACE_TRUST_EXTENSION_SUPPORT as it}from"../../../services/workspaces/common/workspaceTrust.js";import{ExtensionsCompletionItemsProvider as ot}from"./extensionsCompletionItemsProvider.js";import{IQuickInputService as st}from"../../../../platform/quickinput/common/quickInput.js";import{Event as rt}from"../../../../base/common/event.js";import{UnsupportedExtensionsMigrationContrib as at}from"./unsupportedExtensionsMigrationContribution.js";import{isWeb as ze}from"../../../../base/common/platform.js";import{ExtensionStorageService as ct}from"../../../../platform/extensionManagement/common/extensionStorage.js";import{IStorageService as lt}from"../../../../platform/storage/common/storage.js";import{CONTEXT_KEYBINDINGS_EDITOR as dt}from"../../preferences/common/preferences.js";import{DeprecatedExtensionsChecker as ut}from"./deprecatedExtensionsChecker.js";import{ProgressLocation as xt}from"../../../../platform/progress/common/progress.js";import{IUriIdentityService as mt}from"../../../../platform/uriIdentity/common/uriIdentity.js";import{Extensions as ht}from"../../../common/configuration.js";ie(E,On,te.Eager),ie(Un,qn,te.Delayed),ie(rn,_n,te.Eager),D.as(Xe.Quickaccess).registerQuickAccessProvider({ctor:Ge,prefix:Ge.PREFIX,placeholder:t("manageExtensionsQuickAccessPlaceholder","Press Enter to manage extensions."),helpEntries:[{description:t("manageExtensionsHelp","Manage Extensions")}]}),D.as(tt.EditorPane).registerEditorPane(Rn.create(he,he.ID,t("extension","Extension")),[new Pe(me)]),D.as(Vn.ViewContainersRegistry).registerViewContainer({id:v,title:u("extensions","Extensions"),openCommandActionDescriptor:{id:v,mnemonicTitle:t({key:"miViewExtensions",comment:["&& denotes a mnemonic"]},"E&&xtensions"),keybindings:{primary:ve.CtrlCmd|ve.Shift|Ye.KeyX},order:4},ctorDescriptor:new Pe(En),icon:jn,order:4,rejectAddedViews:!0,alwaysUseContainerInfo:!0},Pn.Sidebar),D.as(vn.Configuration).registerConfiguration({...sn,properties:{"extensions.autoUpdate":{enum:[!0,"onlyEnabledExtensions",!1],enumItemLabels:[t("all","All Extensions"),t("enabled","Only Enabled Extensions"),t("none","None")],enumDescriptions:[t("extensions.autoUpdate.true","Download and install updates automatically for all extensions."),t("extensions.autoUpdate.enabled","Download and install updates automatically only for enabled extensions."),t("extensions.autoUpdate.false","Extensions are not automatically updated.")],description:t("extensions.autoUpdate","Controls the automatic update behavior of extensions. The updates are fetched from a Microsoft online service."),default:!0,scope:z.APPLICATION,tags:["usesOnlineServices"]},"extensions.autoCheckUpdates":{type:"boolean",description:t("extensionsCheckUpdates","When enabled, automatically checks extensions for updates. If an extension has an update, it is marked as outdated in the Extensions view. The updates are fetched from a Microsoft online service."),default:!0,scope:z.APPLICATION,tags:["usesOnlineServices"]},"extensions.ignoreRecommendations":{type:"boolean",description:t("extensionsIgnoreRecommendations","When enabled, the notifications for extension recommendations will not be shown."),default:!1},"extensions.showRecommendationsOnlyOnDemand":{type:"boolean",deprecationMessage:t("extensionsShowRecommendationsOnlyOnDemand_Deprecated","This setting is deprecated. Use extensions.ignoreRecommendations setting to control recommendation notifications. Use Extensions view's visibility actions to hide Recommended view by default."),default:!1,tags:["usesOnlineServices"]},"extensions.closeExtensionDetailsOnViewChange":{type:"boolean",description:t("extensionsCloseExtensionDetailsOnViewChange","When enabled, editors with extension details will be automatically closed upon navigating away from the Extensions View."),default:!1},"extensions.confirmedUriHandlerExtensionIds":{type:"array",items:{type:"string"},description:t("handleUriConfirmedExtensions","When an extension is listed here, a confirmation prompt will not be shown when that extension handles a URI."),default:[],scope:z.APPLICATION},"extensions.webWorker":{type:["boolean","string"],enum:[!0,!1,"auto"],enumDescriptions:[t("extensionsWebWorker.true","The Web Worker Extension Host will always be launched."),t("extensionsWebWorker.false","The Web Worker Extension Host will never be launched."),t("extensionsWebWorker.auto","The Web Worker Extension Host will be launched when a web extension needs it.")],description:t("extensionsWebWorker","Enable web worker extension host."),default:"auto"},"extensions.supportVirtualWorkspaces":{type:"object",markdownDescription:t("extensions.supportVirtualWorkspaces","Override the virtual workspaces support of an extension."),patternProperties:{"([a-z0-9A-Z][a-z0-9-A-Z]*)\\.([a-z0-9A-Z][a-z0-9-A-Z]*)$":{type:"boolean",default:!1}},additionalProperties:!1,default:{},defaultSnippets:[{body:{"pub.name":!1}}]},"extensions.experimental.affinity":{type:"object",markdownDescription:t("extensions.affinity","Configure an extension to execute in a different extension host process."),patternProperties:{"([a-z0-9A-Z][a-z0-9-A-Z]*)\\.([a-z0-9A-Z][a-z0-9-A-Z]*)$":{type:"integer",default:1}},additionalProperties:!1,default:{},defaultSnippets:[{body:{"pub.name":1}}]},[it]:{type:"object",scope:z.APPLICATION,markdownDescription:t("extensions.supportUntrustedWorkspaces","Override the untrusted workspace support of an extension. Extensions using `true` will always be enabled. Extensions using `limited` will always be enabled, and the extension will hide functionality that requires trust. Extensions using `false` will only be enabled only when the workspace is trusted."),patternProperties:{"([a-z0-9A-Z][a-z0-9-A-Z]*)\\.([a-z0-9A-Z][a-z0-9-A-Z]*)$":{type:"object",properties:{supported:{type:["boolean","string"],enum:[!0,!1,"limited"],enumDescriptions:[t("extensions.supportUntrustedWorkspaces.true","Extension will always be enabled."),t("extensions.supportUntrustedWorkspaces.false","Extension will only be enabled only when the workspace is trusted."),t("extensions.supportUntrustedWorkspaces.limited","Extension will always be enabled, and the extension will hide functionality requiring trust.")],description:t("extensions.supportUntrustedWorkspaces.supported","Defines the untrusted workspace support setting for the extension.")},version:{type:"string",description:t("extensions.supportUntrustedWorkspaces.version","Defines the version of the extension for which the override should be applied. If not specified, the override will be applied independent of the extension version.")}}}}},"extensions.experimental.deferredStartupFinishedActivation":{type:"boolean",description:t("extensionsDeferredStartupFinishedActivation","When enabled, extensions which declare the `onStartupFinished` activation event will be activated after a timeout."),default:!1},"extensions.experimental.issueQuickAccess":{type:"boolean",description:t("extensionsInQuickAccess","When enabled, extensions can be searched for via Quick Access and report issues from there."),default:!0}}});const pt=D.as(yn.Extensions.JSONContribution);pt.registerSchema(kn,In),H.registerCommand("_extensions.manage",(x,m,n,o,i)=>{const a=x.get(E),r=a.local.find(l=>y(l.identifier,{id:m}));if(r)a.open(r,{tab:n,preserveFocus:o,feature:i});else throw new Error(t("notFound","Extension '{0}' not found.",m))}),H.registerCommand("extension.open",async(x,m,n,o,i,a)=>{const r=x.get(E),l=x.get(pe),[c]=await r.getExtensions([{id:m}],V.None);return c?r.open(c,{tab:n,preserveFocus:o,feature:i,sideByside:a}):l.executeCommand("_extensions.manage",m,n,o,i)}),H.registerCommand({id:"workbench.extensions.installExtension",metadata:{description:t("workbench.extensions.installExtension.description","Install the given extension"),args:[{name:"extensionIdOrVSIXUri",description:t("workbench.extensions.installExtension.arg.decription","Extension id or VSIX resource uri"),constraint:x=>typeof x=="string"||x instanceof ge},{name:"options",description:"(optional) Options for installing the extension. Object with the following properties: `installOnlyNewlyAddedFromExtensionPackVSIX`: When enabled, VS Code installs only newly added extensions from the extension pack VSIX. This option is considered only when installing VSIX. ",isOptional:!0,schema:{type:"object",properties:{installOnlyNewlyAddedFromExtensionPackVSIX:{type:"boolean",description:t("workbench.extensions.installExtension.option.installOnlyNewlyAddedFromExtensionPackVSIX","When enabled, VS Code installs only newly added extensions from the extension pack VSIX. This option is considered only while installing a VSIX."),default:!1},installPreReleaseVersion:{type:"boolean",description:t("workbench.extensions.installExtension.option.installPreReleaseVersion","When enabled, VS Code installs the pre-release version of the extension if available."),default:!1},donotSync:{type:"boolean",description:t("workbench.extensions.installExtension.option.donotSync","When enabled, VS Code do not sync this extension when Settings Sync is on."),default:!1},justification:{type:["string","object"],description:t("workbench.extensions.installExtension.option.justification","Justification for installing the extension. This is a string or an object that can be used to pass any information to the installation handlers. i.e. `{reason: 'This extension wants to open a URI', action: 'Open URI'}` will show a message box with the reason and action upon install.")},enable:{type:"boolean",description:t("workbench.extensions.installExtension.option.enable","When enabled, the extension will be enabled if it is installed but disabled. If the extension is already enabled, this has no effect."),default:!1},context:{type:"object",description:t("workbench.extensions.installExtension.option.context","Context for the installation. This is a JSON object that can be used to pass any information to the installation handlers. i.e. `{skipWalkthrough: true}` will skip opening the walkthrough upon install.")}}}}]},handler:async(x,m,n)=>{const o=x.get(E),i=x.get(We),a=x.get(ke);try{if(typeof m=="string"){const[r,l]=Cn(m);if(o.local.find(d=>y(d.identifier,{id:r,uuid:l}))?.enablementState===O.DisabledByExtensionKind){const[d]=await a.getExtensions([{id:r,preRelease:n?.installPreReleaseVersion}],V.None);if(!d)throw new Error(t("notFound","Extension '{0}' not found.",m));await i.installFromGallery(d,{isMachineScoped:n?.donotSync?!0:void 0,installPreReleaseVersion:n?.installPreReleaseVersion,installGivenVersion:!!l,context:{...n?.context,[Ce]:Re.COMMAND}})}else await o.install(m,{version:l,installPreReleaseVersion:n?.installPreReleaseVersion,context:{...n?.context,[Ce]:Re.COMMAND},justification:n?.justification,enable:n?.enable,isMachineScoped:n?.donotSync?!0:void 0},xt.Notification)}else{const r=ge.revive(m);await o.install(r,{installOnlyNewlyAddedFromExtensionPack:n?.installOnlyNewlyAddedFromExtensionPackVSIX,installGivenVersion:!0})}}catch(r){throw Ue(r),r}}}),H.registerCommand({id:"workbench.extensions.uninstallExtension",metadata:{description:t("workbench.extensions.uninstallExtension.description","Uninstall the given extension"),args:[{name:t("workbench.extensions.uninstallExtension.arg.name","Id of the extension to uninstall"),schema:{type:"string"}}]},handler:async(x,m)=>{if(!m)throw new Error(t("id required","Extension id required."));const n=x.get(Ie),o=await n.getInstalled(),[i]=o.filter(a=>y(a.identifier,{id:m}));if(!i)throw new Error(t("notInstalled","Extension '{0}' is not installed. Make sure you use the full extension ID, including the publisher, e.g.: ms-dotnettools.csharp.",m));if(i.isBuiltin)throw new Error(t("builtin","Extension '{0}' is a Built-in extension and cannot be installed",m));try{await n.uninstall(i)}catch(a){throw Ue(a),a}}}),H.registerCommand({id:"workbench.extensions.search",metadata:{description:t("workbench.extensions.search.description","Search for a specific extension"),args:[{name:t("workbench.extensions.search.arg.name","Query to use in search"),schema:{type:"string"}}]},handler:async(x,m="")=>x.get(E).openSearch(m)});function we(x,m){x?.addImplementation(105,"extensions-editor",n=>{const i=n.get(fe).activeEditorPane;return i instanceof he&&i.activeWebview?.isFocused?(m(i.activeWebview),!0):!1})}we(Mn,x=>x.copy()),we(Ln,x=>x.cut()),we(Nn,x=>x.paste());const f=new Ee("hasLocalServer",!1),S=new Ee("hasRemoteServer",!1),k=new Ee("hasWebServer",!1);async function Q(x){try{await x.run()}finally{Yn(x)&&x.dispose()}}let j=class extends Jn{constructor(n,o,i,a,r,l,c,d,b){super();this.extensionManagementServerService=n;this.viewsService=a;this.extensionsWorkbenchService=r;this.extensionEnablementService=l;this.instantiationService=c;this.dialogService=d;this.commandService=b;const g=p.bindTo(i);o.isEnabled()&&g.set(!0);const I=f.bindTo(i);this.extensionManagementServerService.localExtensionManagementServer&&I.set(!0);const T=S.bindTo(i);this.extensionManagementServerService.remoteExtensionManagementServer&&T.set(!0);const w=k.bindTo(i);this.extensionManagementServerService.webExtensionManagementServer&&w.set(!0),this.registerGlobalActions(),this.registerContextMenuActions(),this.registerQuickAccessProvider()}registerQuickAccessProvider(){(this.extensionManagementServerService.localExtensionManagementServer||this.extensionManagementServerService.remoteExtensionManagementServer||this.extensionManagementServerService.webExtensionManagementServer)&&D.as(Xe.Quickaccess).registerQuickAccessProvider({ctor:Be,prefix:Be.PREFIX,placeholder:t("installExtensionQuickAccessPlaceholder","Type the name of an extension to install or search."),helpEntries:[{description:t("installExtensionQuickAccessHelp","Install or Search Extensions")}]})}registerGlobalActions(){this._register(L.appendMenuItem(s.MenubarPreferencesMenu,{command:{id:v,title:t({key:"miPreferencesExtensions",comment:["&& denotes a mnemonic"]},"&&Extensions")},group:"2_configuration",order:3})),this._register(L.appendMenuItem(s.GlobalActivity,{command:{id:v,title:t("showExtensions","Extensions")},group:"2_configuration",order:3})),this.registerExtensionAction({id:"workbench.extensions.action.focusExtensionsView",title:u("focusExtensions","Focus on Extensions View"),category:h,f1:!0,run:async c=>{await c.get(E).openSearch("")}}),this.registerExtensionAction({id:"workbench.extensions.action.installExtensions",title:u("installExtensions","Install Extensions"),category:h,menu:{id:s.CommandPalette,when:e.and(p,e.or(f,S,k))},run:async c=>{c.get(K).openViewContainer(v,!0)}}),this.registerExtensionAction({id:"workbench.extensions.action.showRecommendedKeymapExtensions",title:u("showRecommendedKeymapExtensionsShort","Keymaps"),category:Ae,menu:[{id:s.CommandPalette,when:p},{id:s.EditorTitle,when:e.and(dt,p),group:"2_keyboard_discover_actions"}],menuTitles:{[s.EditorTitle.id]:t("importKeyboardShortcutsFroms","Migrate Keyboard Shortcuts from...")},run:()=>this.extensionsWorkbenchService.openSearch("@recommended:keymaps ")}),this.registerExtensionAction({id:"workbench.extensions.action.showLanguageExtensions",title:u("showLanguageExtensionsShort","Language Extensions"),category:Ae,menu:{id:s.CommandPalette,when:p},run:()=>this.extensionsWorkbenchService.openSearch("@recommended:languages ")}),this.registerExtensionAction({id:"workbench.extensions.action.checkForUpdates",title:u("checkForUpdates","Check for Extension Updates"),category:h,menu:[{id:s.CommandPalette,when:e.and(p,e.or(f,S,k))},{id:s.ViewContainerTitle,when:e.and(e.equals("viewContainer",v),p),group:"1_updates",order:1}],run:async()=>(await this.extensionsWorkbenchService.checkForUpdates(),this.extensionsWorkbenchService.outdated.length?this.extensionsWorkbenchService.openSearch("@outdated "):this.dialogService.info(t("noUpdatesAvailable","All extensions are up to date.")))});const n=e.equals(`config.${_}`,!1);this.registerExtensionAction({id:"workbench.extensions.action.enableAutoUpdate",title:u("enableAutoUpdate","Enable Auto Update for All Extensions"),category:h,precondition:n,menu:[{id:s.ViewContainerTitle,order:5,group:"1_updates",when:e.and(e.equals("viewContainer",v),n)},{id:s.CommandPalette}],run:c=>c.get(E).updateAutoUpdateForAllExtensions(!0)});const o=e.notEquals(`config.${_}`,!1);this.registerExtensionAction({id:"workbench.extensions.action.disableAutoUpdate",title:u("disableAutoUpdate","Disable Auto Update for All Extensions"),precondition:o,category:h,menu:[{id:s.ViewContainerTitle,order:5,group:"1_updates",when:e.and(e.equals("viewContainer",v),o)},{id:s.CommandPalette}],run:c=>c.get(E).updateAutoUpdateForAllExtensions(!1)}),this.registerExtensionAction({id:"workbench.extensions.action.updateAllExtensions",title:u("updateAll","Update All Extensions"),category:h,precondition:ln,menu:[{id:s.CommandPalette,when:e.and(p,e.or(f,S,k))},{id:s.ViewContainerTitle,when:e.and(e.equals("viewContainer",v),e.or(e.has(`config.${_}`).negate(),e.equals(`config.${_}`,"onlyEnabledExtensions"))),group:"1_updates",order:2},{id:s.ViewTitle,when:e.equals("view",xn),group:"navigation",order:1}],icon:Ke,run:async()=>{const c=this.extensionsWorkbenchService.outdated;(await this.extensionsWorkbenchService.updateAll()).forEach(b=>{if(b.error){const g=c.find(I=>y(I.identifier,b.identifier));g&&Q(this.instantiationService.createInstance(mn,g,g.latestVersion,nn.Update,b.error))}})}}),this.registerExtensionAction({id:"workbench.extensions.action.enableAll",title:u("enableAll","Enable All Extensions"),category:h,menu:[{id:s.CommandPalette,when:e.or(f,S,k)},{id:s.ViewContainerTitle,when:e.equals("viewContainer",v),group:"2_enablement",order:1}],run:async()=>{const c=this.extensionsWorkbenchService.local.filter(d=>!!d.local&&this.extensionEnablementService.canChangeEnablement(d.local)&&!this.extensionEnablementService.isEnabled(d.local));c.length&&await this.extensionsWorkbenchService.setEnablement(c,O.EnabledGlobally)}}),this.registerExtensionAction({id:"workbench.extensions.action.enableAllWorkspace",title:u("enableAllWorkspace","Enable All Extensions for this Workspace"),category:h,menu:{id:s.CommandPalette,when:e.and(P.notEqualsTo("empty"),e.or(f,S,k))},run:async()=>{const c=this.extensionsWorkbenchService.local.filter(d=>!!d.local&&this.extensionEnablementService.canChangeEnablement(d.local)&&!this.extensionEnablementService.isEnabled(d.local));c.length&&await this.extensionsWorkbenchService.setEnablement(c,O.EnabledWorkspace)}}),this.registerExtensionAction({id:"workbench.extensions.action.disableAll",title:u("disableAll","Disable All Installed Extensions"),category:h,menu:[{id:s.CommandPalette,when:e.or(f,S,k)},{id:s.ViewContainerTitle,when:e.equals("viewContainer",v),group:"2_enablement",order:2}],run:async()=>{const c=this.extensionsWorkbenchService.local.filter(d=>!d.isBuiltin&&!!d.local&&this.extensionEnablementService.isEnabled(d.local)&&this.extensionEnablementService.canChangeEnablement(d.local));c.length&&await this.extensionsWorkbenchService.setEnablement(c,O.DisabledGlobally)}}),this.registerExtensionAction({id:"workbench.extensions.action.disableAllWorkspace",title:u("disableAllWorkspace","Disable All Installed Extensions for this Workspace"),category:h,menu:{id:s.CommandPalette,when:e.and(P.notEqualsTo("empty"),e.or(f,S,k))},run:async()=>{const c=this.extensionsWorkbenchService.local.filter(d=>!d.isBuiltin&&!!d.local&&this.extensionEnablementService.isEnabled(d.local)&&this.extensionEnablementService.canChangeEnablement(d.local));c.length&&await this.extensionsWorkbenchService.setEnablement(c,O.DisabledWorkspace)}}),this.registerExtensionAction({id:dn,title:u("InstallFromVSIX","Install from VSIX..."),category:h,menu:[{id:s.CommandPalette,when:e.or(f,S)},{id:s.ViewContainerTitle,when:e.and(e.equals("viewContainer",v),e.or(f,S)),group:"3_install",order:1}],run:async c=>{const d=c.get(je),b=c.get(pe),g=await d.showOpenDialog({title:t("installFromVSIX","Install from VSIX"),filters:[{name:"VSIX Extensions",extensions:["vsix"]}],canSelectFiles:!0,canSelectMany:!0,openLabel:nt(t({key:"installButton",comment:["&& denotes a mnemonic"]},"&&Install"))});g&&await b.executeCommand(Ve,g)}}),this.registerExtensionAction({id:Ve,title:t("installVSIX","Install Extension VSIX"),menu:[{id:s.ExplorerContext,group:"extensions",when:e.and(Bn.Extension.isEqualTo(".vsix"),e.or(f,S))}],run:async(c,d)=>{const b=c.get(E),g=c.get(Xn),I=c.get(Fn),T=Array.isArray(d)?d:[d],w=await Promise.allSettled(T.map(async M=>await b.install(M,{installGivenVersion:!0})));let N,Y=!1,ee=!1;for(const M of w){if(M.status==="rejected"){N=new Error(M.reason);break}Y=Y||M.value.runtimeState?.action===Me.ReloadWindow,ee=ee||M.value.runtimeState?.action===Me.RestartExtensions}if(N)throw N;Y?I.prompt(Se.Info,t("InstallVSIXAction.successReload","Completed installing extension from VSIX. Please reload Visual Studio Code to enable it."),[{label:t("InstallVSIXAction.reloadNow","Reload Now"),run:()=>g.reload()}]):ee?I.prompt(Se.Info,t("InstallVSIXAction.successRestart","Completed installing extension from VSIX. Please restart extensions to enable it."),[{label:t("InstallVSIXAction.restartExtensions","Restart Extensions"),run:()=>b.updateRunningExtensions()}]):I.prompt(Se.Info,t("InstallVSIXAction.successNoReload","Completed installing extension."),[])}}),this.registerExtensionAction({id:"workbench.extensions.action.installExtensionFromLocation",title:u("installExtensionFromLocation","Install Extension from Location..."),category:He.Developer,menu:[{id:s.CommandPalette,when:e.or(k,f)}],run:async c=>{const d=c.get(We);if(ze)return new Promise((b,g)=>{const I=c.get(st),T=new Qe,w=T.add(I.createQuickPick());w.title=t("installFromLocation","Install Extension from Location"),w.customButton=!0,w.customLabel=t("install button","Install"),w.placeholder=t("installFromLocationPlaceHolder","Location of the web extension"),w.ignoreFocusOut=!0,T.add(rt.any(w.onDidAccept,w.onDidCustom)(async()=>{if(w.hide(),w.value)try{await d.installFromLocation(ge.parse(w.value))}catch(N){g(N);return}b()})),T.add(w.onDidHide(()=>T.dispose())),w.show()});{const g=await c.get(je).showOpenDialog({canSelectFolders:!0,canSelectFiles:!1,canSelectMany:!1,title:t("installFromLocation","Install Extension from Location")});g?.[0]&&await d.installFromLocation(g[0])}}});const i=new s("extensionsFilterSubMenu");L.appendMenuItem(De,{submenu:i,title:t("filterExtensions","Filter Extensions..."),group:"navigation",order:2,icon:$n});const a="extensions.filter.featured";this.registerExtensionAction({id:a,title:u("showFeaturedExtensions","Show Featured Extensions"),category:h,menu:[{id:s.CommandPalette,when:p},{id:i,when:p,group:"1_predefined",order:1}],menuTitles:{[i.id]:t("featured filter","Featured")},run:()=>this.extensionsWorkbenchService.openSearch("@featured ")}),this.registerExtensionAction({id:"workbench.extensions.action.showPopularExtensions",title:u("showPopularExtensions","Show Popular Extensions"),category:h,menu:[{id:s.CommandPalette,when:p},{id:i,when:p,group:"1_predefined",order:2}],menuTitles:{[i.id]:t("most popular filter","Most Popular")},run:()=>this.extensionsWorkbenchService.openSearch("@popular ")}),this.registerExtensionAction({id:"workbench.extensions.action.showRecommendedExtensions",title:u("showRecommendedExtensions","Show Recommended Extensions"),category:h,menu:[{id:s.CommandPalette,when:p},{id:i,when:p,group:"1_predefined",order:2}],menuTitles:{[i.id]:t("most popular recommended","Recommended")},run:()=>this.extensionsWorkbenchService.openSearch("@recommended ")}),this.registerExtensionAction({id:"workbench.extensions.action.recentlyPublishedExtensions",title:u("recentlyPublishedExtensions","Show Recently Published Extensions"),category:h,menu:[{id:s.CommandPalette,when:p},{id:i,when:p,group:"1_predefined",order:2}],menuTitles:{[i.id]:t("recently published filter","Recently Published")},run:()=>this.extensionsWorkbenchService.openSearch("@recentlyPublished ")});const r=new s("extensionsCategoryFilterSubMenu");L.appendMenuItem(i,{submenu:r,title:t("filter by category","Category"),when:p,group:"2_categories",order:1}),Zn.forEach((c,d)=>{this.registerExtensionAction({id:`extensions.actions.searchByCategory.${c}`,title:c,menu:[{id:r,when:p,order:d}],run:()=>this.extensionsWorkbenchService.openSearch(`@category:"${c.toLowerCase()}"`)})}),this.registerExtensionAction({id:"workbench.extensions.action.listBuiltInExtensions",title:u("showBuiltInExtensions","Show Built-in Extensions"),category:h,menu:[{id:s.CommandPalette,when:e.or(f,S,k)},{id:i,group:"3_installed",order:2}],menuTitles:{[i.id]:t("builtin filter","Built-in")},run:()=>this.extensionsWorkbenchService.openSearch("@builtin ")}),this.registerExtensionAction({id:"workbench.extensions.action.extensionUpdates",title:u("extensionUpdates","Show Extension Updates"),category:h,precondition:p,f1:!0,menu:[{id:i,group:"3_installed",when:p,order:1}],menuTitles:{[i.id]:t("extension updates filter","Updates")},run:()=>this.extensionsWorkbenchService.openSearch("@updates")}),this.registerExtensionAction({id:un,title:u("showWorkspaceUnsupportedExtensions","Show Extensions Unsupported By Workspace"),category:h,menu:[{id:s.CommandPalette,when:e.or(f,S)},{id:i,group:"3_installed",order:5,when:e.or(f,S)}],menuTitles:{[i.id]:t("workspace unsupported filter","Workspace Unsupported")},run:()=>this.extensionsWorkbenchService.openSearch("@workspaceUnsupported")}),this.registerExtensionAction({id:"workbench.extensions.action.showEnabledExtensions",title:u("showEnabledExtensions","Show Enabled Extensions"),category:h,menu:[{id:s.CommandPalette,when:e.or(f,S,k)},{id:i,group:"3_installed",order:3}],menuTitles:{[i.id]:t("enabled filter","Enabled")},run:()=>this.extensionsWorkbenchService.openSearch("@enabled ")}),this.registerExtensionAction({id:"workbench.extensions.action.showDisabledExtensions",title:u("showDisabledExtensions","Show Disabled Extensions"),category:h,menu:[{id:s.CommandPalette,when:e.or(f,S,k)},{id:i,group:"3_installed",order:4}],menuTitles:{[i.id]:t("disabled filter","Disabled")},run:()=>this.extensionsWorkbenchService.openSearch("@disabled ")});const l=new s("extensionsSortSubMenu");L.appendMenuItem(i,{submenu:l,title:t("sorty by","Sort By"),when:e.and(e.or(p,Oe)),group:"4_sort",order:1}),[{id:"installs",title:t("sort by installs","Install Count"),precondition:G.negate()},{id:"rating",title:t("sort by rating","Rating"),precondition:G.negate()},{id:"name",title:t("sort by name","Name"),precondition:G.negate()},{id:"publishedDate",title:t("sort by published date","Published Date"),precondition:G.negate()},{id:"updateDate",title:t("sort by update date","Updated Date"),precondition:e.and(bn.negate(),fn.negate(),G.negate())}].map(({id:c,title:d,precondition:b},g)=>{this.registerExtensionAction({id:`extensions.sort.${c}`,title:d,precondition:b,menu:[{id:l,when:e.or(p,Oe),order:g}],toggled:Sn.isEqualTo(c),run:async()=>{const I=(await this.viewsService.openViewContainer(v,!0))?.getViewPaneContainer(),T=$e.parse(I?.searchValue??"");I?.search(new $e(T.value,c).toString()),I?.focus()}})}),this.registerExtensionAction({id:"workbench.extensions.action.clearExtensionsSearchResults",title:u("clearExtensionsSearchResults","Clear Extensions Search Results"),category:h,icon:Kn,f1:!0,precondition:wn,menu:{id:De,group:"navigation",order:1},run:async c=>{const d=c.get(K).getActiveViewPaneContainerWithId(v);if(d){const b=d;b.search(""),b.focus()}}}),this.registerExtensionAction({id:"workbench.extensions.action.refreshExtension",title:u("refreshExtension","Refresh"),category:h,icon:zn,f1:!0,menu:{id:s.ViewContainerTitle,when:e.equals("viewContainer",v),group:"navigation",order:2},run:async c=>{const d=c.get(K).getActiveViewPaneContainerWithId(v);d&&await d.refresh()}}),this.registerExtensionAction({id:"workbench.extensions.action.installWorkspaceRecommendedExtensions",title:t("installWorkspaceRecommendedExtensions","Install Workspace Recommended Extensions"),icon:Ke,menu:{id:s.ViewTitle,when:e.equals("view",oe),group:"navigation",order:1},run:async c=>c.get(K).getActiveViewWithId(oe).installWorkspaceRecommendations()}),this.registerExtensionAction({id:B.ID,title:B.LABEL,icon:Qn,menu:[{id:s.CommandPalette,when:P.notEqualsTo("empty")},{id:s.ViewTitle,when:e.equals("view",oe),group:"navigation",order:2}],run:()=>Q(this.instantiationService.createInstance(B,B.ID,B.LABEL))}),this.registerExtensionAction({id:F.ID,title:{value:F.LABEL,original:"Install Specific Version of Extension..."},category:h,menu:{id:s.CommandPalette,when:e.and(p,e.or(f,S,k))},run:()=>Q(this.instantiationService.createInstance(F,F.ID,F.LABEL))}),this.registerExtensionAction({id:q.ID,title:{value:q.LABEL,original:"Reinstall Extension..."},category:He.Developer,menu:{id:s.CommandPalette,when:e.and(p,e.or(f,S))},run:()=>Q(this.instantiationService.createInstance(q,q.ID,q.LABEL))})}registerContextMenuActions(){this.registerExtensionAction({id:re.ID,title:re.TITLE,menu:{id:s.ExtensionContext,group:se,order:0,when:e.and(e.not("inExtensionEditor"),e.equals("extensionStatus","installed"),e.has("extensionHasColorThemes"))},run:async(n,o)=>{const i=n.get(E),a=n.get(C),r=i.local.find(l=>y(l.identifier,{id:o}));if(r){const l=a.createInstance(re);return l.extension=r,l.run()}}}),this.registerExtensionAction({id:ae.ID,title:ae.TITLE,menu:{id:s.ExtensionContext,group:se,order:0,when:e.and(e.not("inExtensionEditor"),e.equals("extensionStatus","installed"),e.has("extensionHasFileIconThemes"))},run:async(n,o)=>{const i=n.get(E),a=n.get(C),r=i.local.find(l=>y(l.identifier,{id:o}));if(r){const l=a.createInstance(ae);return l.extension=r,l.run()}}}),this.registerExtensionAction({id:ce.ID,title:ce.TITLE,menu:{id:s.ExtensionContext,group:se,order:0,when:e.and(e.not("inExtensionEditor"),e.equals("extensionStatus","installed"),e.has("extensionHasProductIconThemes"))},run:async(n,o)=>{const i=n.get(E),a=n.get(C),r=i.local.find(l=>y(l.identifier,{id:o}));if(r){const l=a.createInstance(ce);return l.extension=r,l.run()}}}),this.registerExtensionAction({id:"workbench.extensions.action.showPreReleaseVersion",title:u("show pre-release version","Show Pre-Release Version"),menu:{id:s.ExtensionContext,group:U,order:0,when:e.and(e.has("inExtensionEditor"),e.has("galleryExtensionHasPreReleaseVersion"),e.not("showPreReleaseVersion"),e.not("isBuiltinExtension"))},run:async(n,o)=>{const i=n.get(E),a=(await i.getExtensions([{id:o}],V.None))[0];i.open(a,{showPreReleaseVersion:!0})}}),this.registerExtensionAction({id:"workbench.extensions.action.showReleasedVersion",title:u("show released version","Show Release Version"),menu:{id:s.ExtensionContext,group:U,order:1,when:e.and(e.has("inExtensionEditor"),e.has("galleryExtensionHasPreReleaseVersion"),e.has("extensionHasReleaseVersion"),e.has("showPreReleaseVersion"),e.not("isBuiltinExtension"))},run:async(n,o)=>{const i=n.get(E),a=(await i.getExtensions([{id:o}],V.None))[0];i.open(a,{showPreReleaseVersion:!1})}}),this.registerExtensionAction({id:de.ID,title:de.LABEL,category:h,precondition:e.and(e.or(e.notEquals(`config.${_}`,"onlyEnabledExtensions"),e.equals("isExtensionEnabled",!0)),e.not("extensionDisallowInstall")),menu:{id:s.ExtensionContext,group:_e,order:1,when:e.and(e.not("inExtensionEditor"),e.equals("extensionStatus","installed"),e.not("isBuiltinExtension"))},run:async(n,o)=>{const i=n.get(C),r=n.get(E).local.find(l=>y(l.identifier,{id:o}));if(r){const l=i.createInstance(de);return l.extension=r,l.run()}}}),this.registerExtensionAction({id:ue.ID,title:{value:ue.LABEL,original:"Auto Update (Publisher)"},category:h,precondition:e.equals(`config.${_}`,!1),menu:{id:s.ExtensionContext,group:_e,order:2,when:e.and(e.equals("extensionStatus","installed"),e.not("isBuiltinExtension"))},run:async(n,o)=>{const i=n.get(C),r=n.get(E).local.find(l=>y(l.identifier,{id:o}));if(r){const l=i.createInstance(ue);return l.extension=r,l.run()}}}),this.registerExtensionAction({id:"workbench.extensions.action.switchToPreRlease",title:t("enablePreRleaseLabel","Switch to Pre-Release Version"),category:h,menu:{id:s.ExtensionContext,group:U,order:2,when:e.and(p,e.has("galleryExtensionHasPreReleaseVersion"),e.not("installedExtensionIsOptedToPreRelease"),e.not("inExtensionEditor"),e.equals("extensionStatus","installed"),e.not("isBuiltinExtension"))},run:async(n,o)=>{const i=n.get(C),r=n.get(E).local.find(l=>y(l.identifier,{id:o}));if(r){const l=i.createInstance(Le);return l.extension=r,l.run()}}}),this.registerExtensionAction({id:"workbench.extensions.action.switchToRelease",title:t("disablePreRleaseLabel","Switch to Release Version"),category:h,menu:{id:s.ExtensionContext,group:U,order:2,when:e.and(p,e.has("galleryExtensionHasPreReleaseVersion"),e.has("installedExtensionIsOptedToPreRelease"),e.not("inExtensionEditor"),e.equals("extensionStatus","installed"),e.not("isBuiltinExtension"))},run:async(n,o)=>{const i=n.get(C),r=n.get(E).local.find(l=>y(l.identifier,{id:o}));if(r){const l=i.createInstance(Le);return l.extension=r,l.run()}}}),this.registerExtensionAction({id:le.ID,title:le.TITLE,menu:{id:s.ExtensionContext,group:U,order:0,when:e.and(e.not("inExtensionEditor"),e.has("canSetLanguage"),e.has("isActiveLanguagePackExtension"))},run:async(n,o)=>{const i=n.get(C),r=(await n.get(E).getExtensions([{id:o}],V.None))[0],l=i.createInstance(le);return l.extension=r,l.run()}}),this.registerExtensionAction({id:"workbench.extensions.action.installAndDonotSync",title:t("install installAndDonotSync","Install (Do not Sync)"),menu:{id:s.ExtensionContext,group:"0_install",when:e.and(e.equals("extensionStatus","uninstalled"),e.has("isGalleryExtension"),e.not("extensionDisallowInstall"),be),order:1},run:async(n,o)=>{const i=n.get(C),a=this.extensionsWorkbenchService.local.filter(r=>y(r.identifier,{id:o}))[0]||(await this.extensionsWorkbenchService.getExtensions([{id:o}],V.None))[0];if(a){const r=i.createInstance(Ne,{isMachineScoped:!0});return r.extension=a,r.run()}}}),this.registerExtensionAction({id:"workbench.extensions.action.installPrereleaseAndDonotSync",title:t("installPrereleaseAndDonotSync","Install Pre-Release (Do not Sync)"),menu:{id:s.ExtensionContext,group:"0_install",when:e.and(e.equals("extensionStatus","uninstalled"),e.has("isGalleryExtension"),e.has("extensionHasPreReleaseVersion"),e.not("extensionDisallowInstall"),be),order:2},run:async(n,o)=>{const i=n.get(C),a=this.extensionsWorkbenchService.local.filter(r=>y(r.identifier,{id:o}))[0]||(await this.extensionsWorkbenchService.getExtensions([{id:o}],V.None))[0];if(a){const r=i.createInstance(Ne,{isMachineScoped:!0,preRelease:!0});return r.extension=a,r.run()}}}),this.registerExtensionAction({id:xe.ID,title:xe.LABEL,menu:{id:s.ExtensionContext,group:"0_install",when:e.and(e.equals("extensionStatus","uninstalled"),e.has("isGalleryExtension"),e.not("extensionDisallowInstall")),order:3},run:async(n,o)=>{const i=n.get(C),a=this.extensionsWorkbenchService.local.filter(r=>y(r.identifier,{id:o}))[0]||(await this.extensionsWorkbenchService.getExtensions([{id:o}],V.None))[0];if(a)return i.createInstance(xe,a,!1).run()}}),this.registerExtensionAction({id:"workbench.extensions.action.copyExtension",title:u("workbench.extensions.action.copyExtension","Copy"),menu:{id:s.ExtensionContext,group:"1_copy"},run:async(n,o)=>{const i=n.get(qe),a=this.extensionsWorkbenchService.local.filter(r=>y(r.identifier,{id:o}))[0]||(await this.extensionsWorkbenchService.getExtensions([{id:o}],V.None))[0];if(a){const r=t("extensionInfoName","Name: {0}",a.displayName),l=t("extensionInfoId","Id: {0}",o),c=t("extensionInfoDescription","Description: {0}",a.description),d=t("extensionInfoVersion","Version: {0}",a.version),b=t("extensionInfoPublisher","Publisher: {0}",a.publisherDisplayName),g=a.url?t("extensionInfoVSMarketplaceLink","VS Marketplace Link: {0}",`${a.url}`):null,I=`${r}
${l}
${c}
${d}
${b}${g?`
`+g:""}`;await i.writeText(I)}}}),this.registerExtensionAction({id:"workbench.extensions.action.copyExtensionId",title:u("workbench.extensions.action.copyExtensionId","Copy Extension ID"),menu:{id:s.ExtensionContext,group:"1_copy"},run:async(n,o)=>n.get(qe).writeText(o)}),this.registerExtensionAction({id:"workbench.extensions.action.configure",title:u("workbench.extensions.action.configure","Extension Settings"),menu:{id:s.ExtensionContext,group:"2_configure",when:e.and(e.equals("extensionStatus","installed"),e.has("extensionHasConfiguration")),order:1},run:async(n,o)=>n.get(Fe).openSettings({jsonEditor:!1,query:`@ext:${o}`})}),this.registerExtensionAction({id:"workbench.extensions.action.configureKeybindings",title:u("workbench.extensions.action.configureKeybindings","Extension Keyboard Shortcuts"),menu:{id:s.ExtensionContext,group:"2_configure",when:e.and(e.equals("extensionStatus","installed"),e.has("extensionHasKeybindings")),order:2},run:async(n,o)=>n.get(Fe).openGlobalKeybindingSettings(!1,{query:`@ext:${o}`})}),this.registerExtensionAction({id:"workbench.extensions.action.toggleApplyToAllProfiles",title:u("workbench.extensions.action.toggleApplyToAllProfiles","Apply Extension to all Profiles"),toggled:e.has("isApplicationScopedExtension"),menu:{id:s.ExtensionContext,group:"2_configure",when:e.and(e.equals("extensionStatus","installed"),e.has("isDefaultApplicationScopedExtension").negate(),e.has("isBuiltinExtension").negate(),e.equals("isWorkspaceScopedExtension",!1)),order:3},run:async(n,o,i)=>{const a=n.get(mt),r=i.location?this.extensionsWorkbenchService.installed.find(l=>a.extUri.isEqual(l.local?.location,i.location)):void 0;if(r)return this.extensionsWorkbenchService.toggleApplyExtensionToAllProfiles(r)}}),this.registerExtensionAction({id:cn,title:u("workbench.extensions.action.toggleIgnoreExtension","Sync This Extension"),menu:{id:s.ExtensionContext,group:"2_configure",when:e.and(e.equals("extensionStatus","installed"),be,e.equals("isWorkspaceScopedExtension",!1)),order:4},run:async(n,o)=>{const i=this.extensionsWorkbenchService.local.find(a=>y({id:o},a.identifier));if(i)return this.extensionsWorkbenchService.toggleExtensionIgnoredToSync(i)}}),this.registerExtensionAction({id:"workbench.extensions.action.ignoreRecommendation",title:u("workbench.extensions.action.ignoreRecommendation","Ignore Recommendation"),menu:{id:s.ExtensionContext,group:"3_recommendations",when:e.has("isExtensionRecommended"),order:1},run:async(n,o)=>n.get(Te).toggleGlobalIgnoredRecommendation(o,!0)}),this.registerExtensionAction({id:"workbench.extensions.action.undoIgnoredRecommendation",title:u("workbench.extensions.action.undoIgnoredRecommendation","Undo Ignored Recommendation"),menu:{id:s.ExtensionContext,group:"3_recommendations",when:e.has("isUserIgnoredRecommendation"),order:1},run:async(n,o)=>n.get(Te).toggleGlobalIgnoredRecommendation(o,!1)}),this.registerExtensionAction({id:"workbench.extensions.action.addExtensionToWorkspaceRecommendations",title:u("workbench.extensions.action.addExtensionToWorkspaceRecommendations","Add to Workspace Recommendations"),menu:{id:s.ExtensionContext,group:"3_recommendations",when:e.and(P.notEqualsTo("empty"),e.has("isBuiltinExtension").negate(),e.has("isExtensionWorkspaceRecommended").negate(),e.has("isUserIgnoredRecommendation").negate(),e.notEquals("extensionSource","resource")),order:2},run:(n,o)=>n.get(Z).toggleRecommendation(o)}),this.registerExtensionAction({id:"workbench.extensions.action.removeExtensionFromWorkspaceRecommendations",title:u("workbench.extensions.action.removeExtensionFromWorkspaceRecommendations","Remove from Workspace Recommendations"),menu:{id:s.ExtensionContext,group:"3_recommendations",when:e.and(P.notEqualsTo("empty"),e.has("isBuiltinExtension").negate(),e.has("isExtensionWorkspaceRecommended")),order:2},run:(n,o)=>n.get(Z).toggleRecommendation(o)}),this.registerExtensionAction({id:"workbench.extensions.action.addToWorkspaceRecommendations",title:u("workbench.extensions.action.addToWorkspaceRecommendations","Add Extension to Workspace Recommendations"),category:t("extensions","Extensions"),menu:{id:s.CommandPalette,when:e.and(P.isEqualTo("workspace"),e.equals("resourceScheme",J.extension))},async run(n){const o=n.get(fe),i=n.get(Z);if(!(o.activeEditor instanceof me))return;const a=o.activeEditor.extension.identifier.id.toLowerCase();(await i.getRecommendations()).includes(a)||await i.toggleRecommendation(a)}}),this.registerExtensionAction({id:"workbench.extensions.action.addToWorkspaceFolderRecommendations",title:u("workbench.extensions.action.addToWorkspaceFolderRecommendations","Add Extension to Workspace Folder Recommendations"),category:t("extensions","Extensions"),menu:{id:s.CommandPalette,when:e.and(P.isEqualTo("folder"),e.equals("resourceScheme",J.extension))},run:()=>this.commandService.executeCommand("workbench.extensions.action.addToWorkspaceRecommendations")}),this.registerExtensionAction({id:"workbench.extensions.action.addToWorkspaceIgnoredRecommendations",title:u("workbench.extensions.action.addToWorkspaceIgnoredRecommendations","Add Extension to Workspace Ignored Recommendations"),category:t("extensions","Extensions"),menu:{id:s.CommandPalette,when:e.and(P.isEqualTo("workspace"),e.equals("resourceScheme",J.extension))},async run(n){const o=n.get(fe),i=n.get(Z);if(!(o.activeEditor instanceof me))return;const a=o.activeEditor.extension.identifier.id.toLowerCase();(await i.getUnwantedRecommendations()).includes(a)||await i.toggleUnwantedRecommendation(a)}}),this.registerExtensionAction({id:"workbench.extensions.action.addToWorkspaceFolderIgnoredRecommendations",title:u("workbench.extensions.action.addToWorkspaceFolderIgnoredRecommendations","Add Extension to Workspace Folder Ignored Recommendations"),category:t("extensions","Extensions"),menu:{id:s.CommandPalette,when:e.and(P.isEqualTo("folder"),e.equals("resourceScheme",J.extension))},run:()=>this.commandService.executeCommand("workbench.extensions.action.addToWorkspaceIgnoredRecommendations")}),this.registerExtensionAction({id:X.ID,title:{value:X.LABEL,original:"Configure Recommended Extensions (Workspace)"},category:t("extensions","Extensions"),menu:{id:s.CommandPalette,when:P.isEqualTo("workspace")},run:()=>Q(this.instantiationService.createInstance(X,X.ID,X.LABEL))})}registerExtensionAction(n){const o=n.menu?Array.isArray(n.menu)?n.menu:[n.menu]:[];let i=[];const a=[];if(n.menuTitles)for(let l=0;l<o.length;l++){const c=o[l],d=n.menuTitles[c.id.id];d?a.push({id:c.id,item:{...c,command:{id:n.id,title:d}}}):i.push(c)}else i=o;const r=new Qe;return r.add(ye(class extends en{constructor(){super({...n,menu:i})}run(l,...c){return n.run(l,...c)}})),a.length&&r.add(L.appendMenuItems(a)),r}};j=ne([A(0,tn),A(1,ke),A(2,Dn),A(3,K),A(4,E),A(5,on),A(6,C),A(7,et),A(8,pe)],j);let $=class{constructor(m,n){ct.removeOutdatedExtensionVersions(m,n)}};$=ne([A(0,Ie),A(1,lt)],$);const W=D.as(an.Workbench);W.registerWorkbenchContribution(j,R.Restored),W.registerWorkbenchContribution(hn,R.Eventually),W.registerWorkbenchContribution(pn,R.Eventually),W.registerWorkbenchContribution(An,R.Restored),W.registerWorkbenchContribution(gn,R.Restored),W.registerWorkbenchContribution(Wn,R.Eventually),W.registerWorkbenchContribution(Tn,R.Eventually),W.registerWorkbenchContribution(Hn,R.Restored),W.registerWorkbenchContribution(ot,R.Restored),W.registerWorkbenchContribution(at,R.Eventually),W.registerWorkbenchContribution(ut,R.Eventually),ze&&W.registerWorkbenchContribution($,R.Eventually),ye(Gn),D.as(ht.ConfigurationMigration).registerConfigurationMigrations([{key:_,migrateFn:(x,m)=>x==="onlySelectedExtensions"?{value:!1}:[]}]);export{f as CONTEXT_HAS_LOCAL_SERVER,S as CONTEXT_HAS_REMOTE_SERVER,k as CONTEXT_HAS_WEB_SERVER};
