var P=Object.defineProperty;var k=Object.getOwnPropertyDescriptor;var C=(i,e,t,n)=>{for(var o=n>1?void 0:n?k(e,t):e,v=i.length-1,D;v>=0;v--)(D=i[v])&&(o=(n?D(e,t,o):D(o))||o);return n&&o&&P(e,t,o),o},b=(i,e)=>(t,n)=>e(t,n,i);import{localize as x}from"../../../../nls.js";import{Registry as R}from"../../../../platform/registry/common/platform.js";import{MenuRegistry as m,MenuId as d,registerAction2 as y}from"../../../../platform/actions/common/actions.js";import{Extensions as W}from"../../../common/contributions.js";import{SyncDescriptor as N}from"../../../../platform/instantiation/common/descriptors.js";import{CommandsRegistry as u}from"../../../../platform/commands/common/commands.js";import{IInstantiationService as l}from"../../../../platform/instantiation/common/instantiation.js";import{EditorPaneDescriptor as w}from"../../../browser/editor.js";import{LifecyclePhase as g}from"../../../services/lifecycle/common/lifecycle.js";import{RuntimeExtensionsEditor as r,StartExtensionHostProfileAction as s,StopExtensionHostProfileAction as a,CONTEXT_PROFILE_SESSION_STATE as T,CONTEXT_EXTENSION_HOST_PROFILE_RECORDED as z,SaveExtensionHostProfileAction as c,IExtensionHostProfileService as O}from"./runtimeExtensionsEditor.js";import{DebugExtensionHostAction as E,DebugExtensionsContribution as _}from"./debugExtensionHostAction.js";import{EditorExtensions as L}from"../../../common/editor.js";import{ActiveEditorContext as S}from"../../../common/contextkeys.js";import"../../../common/editor/editorInput.js";import{RuntimeExtensionsInput as A}from"../common/runtimeExtensionsInput.js";import{ContextKeyExpr as h}from"../../../../platform/contextkey/common/contextkey.js";import{CleanUpExtensionsFolderAction as F,OpenExtensionsFolderAction as H}from"./extensionsActions.js";import{IExtensionRecommendationNotificationService as B}from"../../../../platform/extensionRecommendations/common/extensionRecommendations.js";import{ISharedProcessService as M}from"../../../../platform/ipc/electron-sandbox/services.js";import{ExtensionRecommendationNotificationServiceChannel as q}from"../../../../platform/extensionRecommendations/common/extensionRecommendationsIpc.js";import{Codicon as p}from"../../../../base/common/codicons.js";import{RemoteExtensionsInitializerContribution as X}from"./remoteExtensionsInit.js";import{InstantiationType as K,registerSingleton as U}from"../../../../platform/instantiation/common/extensions.js";import{ExtensionHostProfileService as j}from"./extensionProfileService.js";import{ExtensionsAutoProfiler as G}from"./extensionsAutoProfiler.js";import{Disposable as J}from"../../../../base/common/lifecycle.js";U(O,j,K.Delayed),R.as(L.EditorPane).registerEditorPane(w.create(r,r.ID,x("runtimeExtension","Running Extensions")),[new N(A)]);class Q{canSerialize(e){return!0}serialize(e){return""}deserialize(e){return A.instance}}R.as(L.EditorFactory).registerEditorSerializer(A.ID,Q);let I=class extends J{constructor(e,t){super(),t.registerChannel("extensionRecommendationNotification",new q(e)),this._register(y(H)),this._register(y(F))}};I=C([b(0,B),b(1,M)],I);const f=R.as(W.Workbench);f.registerWorkbenchContribution(I,g.Restored),f.registerWorkbenchContribution(G,g.Eventually),f.registerWorkbenchContribution(X,g.Restored),f.registerWorkbenchContribution(_,g.Restored),u.registerCommand(E.ID,(i,...e)=>i.get(l).createInstance(E).run(e)),u.registerCommand(s.ID,i=>{i.get(l).createInstance(s,s.ID,s.LABEL).run()}),u.registerCommand(a.ID,i=>{i.get(l).createInstance(a,a.ID,a.LABEL).run()}),u.registerCommand(c.ID,i=>{i.get(l).createInstance(c,c.ID,c.LABEL).run()}),m.appendMenuItem(d.EditorTitle,{command:{id:E.ID,title:E.LABEL,icon:p.debugStart},group:"navigation",when:S.isEqualTo(r.ID)}),m.appendMenuItem(d.CommandPalette,{command:{id:E.ID,title:x("debugExtensionHost","Debug Extensions In New Window"),category:x("developer","Developer"),icon:p.debugStart}}),m.appendMenuItem(d.EditorTitle,{command:{id:s.ID,title:s.LABEL,icon:p.circleFilled},group:"navigation",when:h.and(S.isEqualTo(r.ID),T.notEqualsTo("running"))}),m.appendMenuItem(d.EditorTitle,{command:{id:a.ID,title:a.LABEL,icon:p.debugStop},group:"navigation",when:h.and(S.isEqualTo(r.ID),T.isEqualTo("running"))}),m.appendMenuItem(d.EditorTitle,{command:{id:c.ID,title:c.LABEL,icon:p.saveAll,precondition:z},group:"navigation",when:h.and(S.isEqualTo(r.ID))});
