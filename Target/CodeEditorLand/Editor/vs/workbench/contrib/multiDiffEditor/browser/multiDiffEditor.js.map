{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/multiDiffEditor/browser/multiDiffEditor.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as DOM from '../../../../base/browser/dom.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { MultiDiffEditorWidget } from '../../../../editor/browser/widget/multiDiffEditor/multiDiffEditorWidget.js';\nimport { IResourceLabel, IWorkbenchUIElementFactory } from '../../../../editor/browser/widget/multiDiffEditor/workbenchUIElementFactory.js';\nimport { ITextResourceConfigurationService } from '../../../../editor/common/services/textResourceConfiguration.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { InstantiationService } from '../../../../platform/instantiation/common/instantiationService.js';\nimport { IStorageService } from '../../../../platform/storage/common/storage.js';\nimport { ITelemetryService } from '../../../../platform/telemetry/common/telemetry.js';\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\nimport { ResourceLabel } from '../../../browser/labels.js';\nimport { AbstractEditorWithViewState } from '../../../browser/parts/editor/editorWithViewState.js';\nimport { ICompositeControl } from '../../../common/composite.js';\nimport { IEditorOpenContext } from '../../../common/editor.js';\nimport { EditorInput } from '../../../common/editor/editorInput.js';\nimport { IDocumentDiffItemWithMultiDiffEditorItem, MultiDiffEditorInput } from './multiDiffEditorInput.js';\nimport { IEditorGroup, IEditorGroupsService } from '../../../services/editor/common/editorGroupsService.js';\nimport { IEditorService } from '../../../services/editor/common/editorService.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { MultiDiffEditorViewModel } from '../../../../editor/browser/widget/multiDiffEditor/multiDiffEditorViewModel.js';\nimport { IMultiDiffEditorOptions, IMultiDiffEditorViewState } from '../../../../editor/browser/widget/multiDiffEditor/multiDiffEditorWidgetImpl.js';\nimport { ICodeEditor } from '../../../../editor/browser/editorBrowser.js';\nimport { IDiffEditor } from '../../../../editor/common/editorCommon.js';\nimport { Range } from '../../../../editor/common/core/range.js';\nimport { MultiDiffEditorItem } from './multiDiffSourceResolverService.js';\n\nexport class MultiDiffEditor extends AbstractEditorWithViewState<IMultiDiffEditorViewState> {\n\tstatic readonly ID = 'multiDiffEditor';\n\n\tprivate _multiDiffEditorWidget: MultiDiffEditorWidget | undefined = undefined;\n\tprivate _viewModel: MultiDiffEditorViewModel | undefined;\n\n\tpublic get viewModel(): MultiDiffEditorViewModel | undefined {\n\t\treturn this._viewModel;\n\t}\n\n\tconstructor(\n\t\tgroup: IEditorGroup,\n\t\t@IInstantiationService instantiationService: InstantiationService,\n\t\t@ITelemetryService telemetryService: ITelemetryService,\n\t\t@IThemeService themeService: IThemeService,\n\t\t@IStorageService storageService: IStorageService,\n\t\t@IEditorService editorService: IEditorService,\n\t\t@IEditorGroupsService editorGroupService: IEditorGroupsService,\n\t\t@ITextResourceConfigurationService textResourceConfigurationService: ITextResourceConfigurationService,\n\t) {\n\t\tsuper(\n\t\t\tMultiDiffEditor.ID,\n\t\t\tgroup,\n\t\t\t'multiDiffEditor',\n\t\t\ttelemetryService,\n\t\t\tinstantiationService,\n\t\t\tstorageService,\n\t\t\ttextResourceConfigurationService,\n\t\t\tthemeService,\n\t\t\teditorService,\n\t\t\teditorGroupService\n\t\t);\n\t}\n\n\tprotected createEditor(parent: HTMLElement): void {\n\t\tthis._multiDiffEditorWidget = this._register(this.instantiationService.createInstance(\n\t\t\tMultiDiffEditorWidget,\n\t\t\tparent,\n\t\t\tthis.instantiationService.createInstance(WorkbenchUIElementFactory),\n\t\t));\n\n\t\tthis._register(this._multiDiffEditorWidget.onDidChangeActiveControl(() => {\n\t\t\tthis._onDidChangeControl.fire();\n\t\t}));\n\t}\n\n\toverride async setInput(input: MultiDiffEditorInput, options: IMultiDiffEditorOptions | undefined, context: IEditorOpenContext, token: CancellationToken): Promise<void> {\n\t\tawait super.setInput(input, options, context, token);\n\t\tthis._viewModel = await input.getViewModel();\n\t\tthis._multiDiffEditorWidget!.setViewModel(this._viewModel);\n\n\t\tconst viewState = this.loadEditorViewState(input, context);\n\t\tif (viewState) {\n\t\t\tthis._multiDiffEditorWidget!.setViewState(viewState);\n\t\t}\n\t\tthis._applyOptions(options);\n\t}\n\n\toverride setOptions(options: IMultiDiffEditorOptions | undefined): void {\n\t\tthis._applyOptions(options);\n\t}\n\n\tprivate _applyOptions(options: IMultiDiffEditorOptions | undefined): void {\n\t\tconst viewState = options?.viewState;\n\t\tif (!viewState || !viewState.revealData) {\n\t\t\treturn;\n\t\t}\n\t\tthis._multiDiffEditorWidget?.reveal(viewState.revealData.resource, {\n\t\t\trange: viewState.revealData.range ? Range.lift(viewState.revealData.range) : undefined,\n\t\t\thighlight: true\n\t\t});\n\t}\n\n\toverride async clearInput(): Promise<void> {\n\t\tawait super.clearInput();\n\t\tthis._multiDiffEditorWidget!.setViewModel(undefined);\n\t}\n\n\tlayout(dimension: DOM.Dimension): void {\n\t\tthis._multiDiffEditorWidget!.layout(dimension);\n\t}\n\n\toverride getControl(): ICompositeControl | undefined {\n\t\treturn this._multiDiffEditorWidget!.getActiveControl();\n\t}\n\n\toverride focus(): void {\n\t\tsuper.focus();\n\n\t\tthis._multiDiffEditorWidget?.getActiveControl()?.focus();\n\t}\n\n\toverride hasFocus(): boolean {\n\t\treturn this._multiDiffEditorWidget?.getActiveControl()?.hasTextFocus() || super.hasFocus();\n\t}\n\n\tprotected override computeEditorViewState(resource: URI): IMultiDiffEditorViewState | undefined {\n\t\treturn this._multiDiffEditorWidget!.getViewState();\n\t}\n\n\tprotected override tracksEditorViewState(input: EditorInput): boolean {\n\t\treturn input instanceof MultiDiffEditorInput;\n\t}\n\n\tprotected override toEditorViewStateResource(input: EditorInput): URI | undefined {\n\t\treturn (input as MultiDiffEditorInput).resource;\n\t}\n\n\tpublic tryGetCodeEditor(resource: URI): { diffEditor: IDiffEditor; editor: ICodeEditor } | undefined {\n\t\treturn this._multiDiffEditorWidget!.tryGetCodeEditor(resource);\n\t}\n\n\tpublic findDocumentDiffItem(resource: URI): MultiDiffEditorItem | undefined {\n\t\tconst i = this._multiDiffEditorWidget!.findDocumentDiffItem(resource);\n\t\tif (!i) { return undefined; }\n\t\tconst i2 = i as IDocumentDiffItemWithMultiDiffEditorItem;\n\t\treturn i2.multiDiffEditorItem;\n\t}\n}\n\n\nclass WorkbenchUIElementFactory implements IWorkbenchUIElementFactory {\n\tconstructor(\n\t\t@IInstantiationService private readonly _instantiationService: IInstantiationService,\n\t) { }\n\n\tcreateResourceLabel(element: HTMLElement): IResourceLabel {\n\t\tconst label = this._instantiationService.createInstance(ResourceLabel, element, {});\n\t\treturn {\n\t\t\tsetUri(uri, options = {}) {\n\t\t\t\tif (!uri) {\n\t\t\t\t\tlabel.element.clear();\n\t\t\t\t} else {\n\t\t\t\t\tlabel.element.setFile(uri, { strikethrough: options.strikethrough });\n\t\t\t\t}\n\t\t\t},\n\t\t\tdispose() {\n\t\t\t\tlabel.dispose();\n\t\t\t}\n\t\t};\n\t}\n}\n"],
  "mappings": "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",
  "names": []
}
