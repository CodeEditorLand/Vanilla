{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/multiDiffEditor/browser/multiDiffEditor.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport type * as DOM from \"../../../../base/browser/dom.js\";\nimport type { CancellationToken } from \"../../../../base/common/cancellation.js\";\nimport type { URI } from \"../../../../base/common/uri.js\";\nimport type { ICodeEditor } from \"../../../../editor/browser/editorBrowser.js\";\nimport type { MultiDiffEditorViewModel } from \"../../../../editor/browser/widget/multiDiffEditor/multiDiffEditorViewModel.js\";\nimport { MultiDiffEditorWidget } from \"../../../../editor/browser/widget/multiDiffEditor/multiDiffEditorWidget.js\";\nimport type {\n\tIMultiDiffEditorOptions,\n\tIMultiDiffEditorViewState,\n} from \"../../../../editor/browser/widget/multiDiffEditor/multiDiffEditorWidgetImpl.js\";\nimport type {\n\tIResourceLabel,\n\tIWorkbenchUIElementFactory,\n} from \"../../../../editor/browser/widget/multiDiffEditor/workbenchUIElementFactory.js\";\nimport { Range } from \"../../../../editor/common/core/range.js\";\nimport type { IDiffEditor } from \"../../../../editor/common/editorCommon.js\";\nimport { ITextResourceConfigurationService } from \"../../../../editor/common/services/textResourceConfiguration.js\";\nimport { IInstantiationService } from \"../../../../platform/instantiation/common/instantiation.js\";\nimport type { InstantiationService } from \"../../../../platform/instantiation/common/instantiationService.js\";\nimport { IStorageService } from \"../../../../platform/storage/common/storage.js\";\nimport { ITelemetryService } from \"../../../../platform/telemetry/common/telemetry.js\";\nimport { IThemeService } from \"../../../../platform/theme/common/themeService.js\";\nimport { ResourceLabel } from \"../../../browser/labels.js\";\nimport { AbstractEditorWithViewState } from \"../../../browser/parts/editor/editorWithViewState.js\";\nimport type { ICompositeControl } from \"../../../common/composite.js\";\nimport type { IEditorOpenContext } from \"../../../common/editor.js\";\nimport type { EditorInput } from \"../../../common/editor/editorInput.js\";\nimport {\n\ttype IEditorGroup,\n\tIEditorGroupsService,\n} from \"../../../services/editor/common/editorGroupsService.js\";\nimport { IEditorService } from \"../../../services/editor/common/editorService.js\";\nimport {\n\ttype IDocumentDiffItemWithMultiDiffEditorItem,\n\tMultiDiffEditorInput,\n} from \"./multiDiffEditorInput.js\";\nimport type { MultiDiffEditorItem } from \"./multiDiffSourceResolverService.js\";\n\nexport class MultiDiffEditor extends AbstractEditorWithViewState<IMultiDiffEditorViewState> {\n\tstatic readonly ID = \"multiDiffEditor\";\n\n\tprivate _multiDiffEditorWidget: MultiDiffEditorWidget | undefined =\n\t\tundefined;\n\tprivate _viewModel: MultiDiffEditorViewModel | undefined;\n\n\tpublic get viewModel(): MultiDiffEditorViewModel | undefined {\n\t\treturn this._viewModel;\n\t}\n\n\tconstructor(\n\t\tgroup: IEditorGroup,\n\t\t@IInstantiationService instantiationService: InstantiationService,\n\t\t@ITelemetryService telemetryService: ITelemetryService,\n\t\t@IThemeService themeService: IThemeService,\n\t\t@IStorageService storageService: IStorageService,\n\t\t@IEditorService editorService: IEditorService,\n\t\t@IEditorGroupsService editorGroupService: IEditorGroupsService,\n\t\t@ITextResourceConfigurationService\n\t\ttextResourceConfigurationService: ITextResourceConfigurationService,\n\t) {\n\t\tsuper(\n\t\t\tMultiDiffEditor.ID,\n\t\t\tgroup,\n\t\t\t\"multiDiffEditor\",\n\t\t\ttelemetryService,\n\t\t\tinstantiationService,\n\t\t\tstorageService,\n\t\t\ttextResourceConfigurationService,\n\t\t\tthemeService,\n\t\t\teditorService,\n\t\t\teditorGroupService,\n\t\t);\n\t}\n\n\tprotected createEditor(parent: HTMLElement): void {\n\t\tthis._multiDiffEditorWidget = this._register(\n\t\t\tthis.instantiationService.createInstance(\n\t\t\t\tMultiDiffEditorWidget,\n\t\t\t\tparent,\n\t\t\t\tthis.instantiationService.createInstance(\n\t\t\t\t\tWorkbenchUIElementFactory,\n\t\t\t\t),\n\t\t\t),\n\t\t);\n\n\t\tthis._register(\n\t\t\tthis._multiDiffEditorWidget.onDidChangeActiveControl(() => {\n\t\t\t\tthis._onDidChangeControl.fire();\n\t\t\t}),\n\t\t);\n\t}\n\n\toverride async setInput(\n\t\tinput: MultiDiffEditorInput,\n\t\toptions: IMultiDiffEditorOptions | undefined,\n\t\tcontext: IEditorOpenContext,\n\t\ttoken: CancellationToken,\n\t): Promise<void> {\n\t\tawait super.setInput(input, options, context, token);\n\t\tthis._viewModel = await input.getViewModel();\n\t\tthis._multiDiffEditorWidget!.setViewModel(this._viewModel);\n\n\t\tconst viewState = this.loadEditorViewState(input, context);\n\t\tif (viewState) {\n\t\t\tthis._multiDiffEditorWidget!.setViewState(viewState);\n\t\t}\n\t\tthis._applyOptions(options);\n\t}\n\n\toverride setOptions(options: IMultiDiffEditorOptions | undefined): void {\n\t\tthis._applyOptions(options);\n\t}\n\n\tprivate _applyOptions(options: IMultiDiffEditorOptions | undefined): void {\n\t\tconst viewState = options?.viewState;\n\t\tif (!viewState || !viewState.revealData) {\n\t\t\treturn;\n\t\t}\n\t\tthis._multiDiffEditorWidget?.reveal(viewState.revealData.resource, {\n\t\t\trange: viewState.revealData.range\n\t\t\t\t? Range.lift(viewState.revealData.range)\n\t\t\t\t: undefined,\n\t\t\thighlight: true,\n\t\t});\n\t}\n\n\toverride async clearInput(): Promise<void> {\n\t\tawait super.clearInput();\n\t\tthis._multiDiffEditorWidget!.setViewModel(undefined);\n\t}\n\n\tlayout(dimension: DOM.Dimension): void {\n\t\tthis._multiDiffEditorWidget!.layout(dimension);\n\t}\n\n\toverride getControl(): ICompositeControl | undefined {\n\t\treturn this._multiDiffEditorWidget!.getActiveControl();\n\t}\n\n\toverride focus(): void {\n\t\tsuper.focus();\n\n\t\tthis._multiDiffEditorWidget?.getActiveControl()?.focus();\n\t}\n\n\toverride hasFocus(): boolean {\n\t\treturn (\n\t\t\tthis._multiDiffEditorWidget?.getActiveControl()?.hasTextFocus() ||\n\t\t\tsuper.hasFocus()\n\t\t);\n\t}\n\n\tprotected override computeEditorViewState(\n\t\tresource: URI,\n\t): IMultiDiffEditorViewState | undefined {\n\t\treturn this._multiDiffEditorWidget!.getViewState();\n\t}\n\n\tprotected override tracksEditorViewState(input: EditorInput): boolean {\n\t\treturn input instanceof MultiDiffEditorInput;\n\t}\n\n\tprotected override toEditorViewStateResource(\n\t\tinput: EditorInput,\n\t): URI | undefined {\n\t\treturn (input as MultiDiffEditorInput).resource;\n\t}\n\n\tpublic tryGetCodeEditor(\n\t\tresource: URI,\n\t): { diffEditor: IDiffEditor; editor: ICodeEditor } | undefined {\n\t\treturn this._multiDiffEditorWidget!.tryGetCodeEditor(resource);\n\t}\n\n\tpublic findDocumentDiffItem(\n\t\tresource: URI,\n\t): MultiDiffEditorItem | undefined {\n\t\tconst i = this._multiDiffEditorWidget!.findDocumentDiffItem(resource);\n\t\tif (!i) {\n\t\t\treturn undefined;\n\t\t}\n\t\tconst i2 = i as IDocumentDiffItemWithMultiDiffEditorItem;\n\t\treturn i2.multiDiffEditorItem;\n\t}\n}\n\nclass WorkbenchUIElementFactory implements IWorkbenchUIElementFactory {\n\tconstructor(\n\t\t@IInstantiationService\n\t\tprivate readonly _instantiationService: IInstantiationService,\n\t) {}\n\n\tcreateResourceLabel(element: HTMLElement): IResourceLabel {\n\t\tconst label = this._instantiationService.createInstance(\n\t\t\tResourceLabel,\n\t\t\telement,\n\t\t\t{},\n\t\t);\n\t\treturn {\n\t\t\tsetUri(uri, options = {}) {\n\t\t\t\tif (uri) {\n\t\t\t\t\tlabel.element.setFile(uri, {\n\t\t\t\t\t\tstrikethrough: options.strikethrough,\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tlabel.element.clear();\n\t\t\t\t}\n\t\t\t},\n\t\t\tdispose() {\n\t\t\t\tlabel.dispose();\n\t\t\t},\n\t\t};\n\t}\n}\n"],
  "mappings": "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",
  "names": []
}
