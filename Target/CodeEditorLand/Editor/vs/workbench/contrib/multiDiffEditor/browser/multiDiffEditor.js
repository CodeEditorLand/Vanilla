var p=Object.defineProperty;var I=Object.getOwnPropertyDescriptor;var a=(f,t,i,e)=>{for(var o=e>1?void 0:e?I(t,i):t,d=f.length-1,s;d>=0;d--)(s=f[d])&&(o=(e?s(t,i,o):s(o))||o);return e&&o&&p(t,i,o),o},r=(f,t)=>(i,e)=>t(i,e,f);import{MultiDiffEditorWidget as E}from"../../../../editor/browser/widget/multiDiffEditor/multiDiffEditorWidget.js";import{Range as v}from"../../../../editor/common/core/range.js";import{ITextResourceConfigurationService as D}from"../../../../editor/common/services/textResourceConfiguration.js";import{IInstantiationService as u}from"../../../../platform/instantiation/common/instantiation.js";import{IStorageService as g}from"../../../../platform/storage/common/storage.js";import{ITelemetryService as h}from"../../../../platform/telemetry/common/telemetry.js";import{IThemeService as w}from"../../../../platform/theme/common/themeService.js";import{ResourceLabel as S}from"../../../browser/labels.js";import{AbstractEditorWithViewState as M}from"../../../browser/parts/editor/editorWithViewState.js";import{IEditorGroupsService as y}from"../../../services/editor/common/editorGroupsService.js";import{IEditorService as _}from"../../../services/editor/common/editorService.js";import{MultiDiffEditorInput as C}from"./multiDiffEditorInput.js";let n=class extends M{static ID="multiDiffEditor";_multiDiffEditorWidget=void 0;_viewModel;get viewModel(){return this._viewModel}constructor(t,i,e,o,d,s,l,c){super(n.ID,t,"multiDiffEditor",e,i,d,c,o,s,l)}createEditor(t){this._multiDiffEditorWidget=this._register(this.instantiationService.createInstance(E,t,this.instantiationService.createInstance(m))),this._register(this._multiDiffEditorWidget.onDidChangeActiveControl(()=>{this._onDidChangeControl.fire()}))}async setInput(t,i,e,o){await super.setInput(t,i,e,o),this._viewModel=await t.getViewModel(),this._multiDiffEditorWidget.setViewModel(this._viewModel);const d=this.loadEditorViewState(t,e);d&&this._multiDiffEditorWidget.setViewState(d),this._applyOptions(i)}setOptions(t){this._applyOptions(t)}_applyOptions(t){const i=t?.viewState;!i||!i.revealData||this._multiDiffEditorWidget?.reveal(i.revealData.resource,{range:i.revealData.range?v.lift(i.revealData.range):void 0,highlight:!0})}async clearInput(){await super.clearInput(),this._multiDiffEditorWidget.setViewModel(void 0)}layout(t){this._multiDiffEditorWidget.layout(t)}getControl(){return this._multiDiffEditorWidget.getActiveControl()}focus(){super.focus(),this._multiDiffEditorWidget?.getActiveControl()?.focus()}hasFocus(){return this._multiDiffEditorWidget?.getActiveControl()?.hasTextFocus()||super.hasFocus()}computeEditorViewState(t){return this._multiDiffEditorWidget.getViewState()}tracksEditorViewState(t){return t instanceof C}toEditorViewStateResource(t){return t.resource}tryGetCodeEditor(t){return this._multiDiffEditorWidget.tryGetCodeEditor(t)}findDocumentDiffItem(t){const i=this._multiDiffEditorWidget.findDocumentDiffItem(t);return i?i.multiDiffEditorItem:void 0}};n=a([r(1,u),r(2,h),r(3,w),r(4,g),r(5,_),r(6,y),r(7,D)],n);let m=class{constructor(t){this._instantiationService=t}createResourceLabel(t){const i=this._instantiationService.createInstance(S,t,{});return{setUri(e,o={}){e?i.element.setFile(e,{strikethrough:o.strikethrough}):i.element.clear()},dispose(){i.dispose()}}}};m=a([r(0,u)],m);export{n as MultiDiffEditor};
