var p=Object.defineProperty;var I=Object.getOwnPropertyDescriptor;var a=(f,t,i,e)=>{for(var r=e>1?void 0:e?I(t,i):t,d=f.length-1,s;d>=0;d--)(s=f[d])&&(r=(e?s(t,i,r):s(r))||r);return e&&r&&p(t,i,r),r},o=(f,t)=>(i,e)=>t(i,e,f);import{MultiDiffEditorWidget as v}from"../../../../editor/browser/widget/multiDiffEditor/multiDiffEditorWidget.js";import{ITextResourceConfigurationService as E}from"../../../../editor/common/services/textResourceConfiguration.js";import{IInstantiationService as m}from"../../../../platform/instantiation/common/instantiation.js";import{IStorageService as D}from"../../../../platform/storage/common/storage.js";import{ITelemetryService as h}from"../../../../platform/telemetry/common/telemetry.js";import{IThemeService as g}from"../../../../platform/theme/common/themeService.js";import{ResourceLabel as S}from"../../../browser/labels.js";import{AbstractEditorWithViewState as M}from"../../../browser/parts/editor/editorWithViewState.js";import{MultiDiffEditorInput as w}from"./multiDiffEditorInput.js";import{IEditorGroupsService as _}from"../../../services/editor/common/editorGroupsService.js";import{IEditorService as C}from"../../../services/editor/common/editorService.js";import{Range as W}from"../../../../editor/common/core/range.js";let n=class extends M{static ID="multiDiffEditor";_multiDiffEditorWidget=void 0;_viewModel;get viewModel(){return this._viewModel}constructor(t,i,e,r,d,s,l,c){super(n.ID,t,"multiDiffEditor",e,i,d,c,r,s,l)}createEditor(t){this._multiDiffEditorWidget=this._register(this.instantiationService.createInstance(v,t,this.instantiationService.createInstance(u))),this._register(this._multiDiffEditorWidget.onDidChangeActiveControl(()=>{this._onDidChangeControl.fire()}))}async setInput(t,i,e,r){await super.setInput(t,i,e,r),this._viewModel=await t.getViewModel(),this._multiDiffEditorWidget.setViewModel(this._viewModel);const d=this.loadEditorViewState(t,e);d&&this._multiDiffEditorWidget.setViewState(d),this._applyOptions(i)}setOptions(t){this._applyOptions(t)}_applyOptions(t){const i=t?.viewState;!i||!i.revealData||this._multiDiffEditorWidget?.reveal(i.revealData.resource,{range:i.revealData.range?W.lift(i.revealData.range):void 0,highlight:!0})}async clearInput(){await super.clearInput(),this._multiDiffEditorWidget.setViewModel(void 0)}layout(t){this._multiDiffEditorWidget.layout(t)}getControl(){return this._multiDiffEditorWidget.getActiveControl()}focus(){super.focus(),this._multiDiffEditorWidget?.getActiveControl()?.focus()}hasFocus(){return this._multiDiffEditorWidget?.getActiveControl()?.hasTextFocus()||super.hasFocus()}computeEditorViewState(t){return this._multiDiffEditorWidget.getViewState()}tracksEditorViewState(t){return t instanceof w}toEditorViewStateResource(t){return t.resource}tryGetCodeEditor(t){return this._multiDiffEditorWidget.tryGetCodeEditor(t)}findDocumentDiffItem(t){const i=this._multiDiffEditorWidget.findDocumentDiffItem(t);return i?i.multiDiffEditorItem:void 0}};n=a([o(1,m),o(2,h),o(3,g),o(4,D),o(5,C),o(6,_),o(7,E)],n);let u=class{constructor(t){this._instantiationService=t}createResourceLabel(t){const i=this._instantiationService.createInstance(S,t,{});return{setUri(e,r={}){e?i.element.setFile(e,{strikethrough:r.strikethrough}):i.element.clear()},dispose(){i.dispose()}}}};u=a([o(0,m)],u);export{n as MultiDiffEditor};
