var C=Object.defineProperty;var I=Object.getOwnPropertyDescriptor;var g=(h,r,t,o)=>{for(var n=o>1?void 0:o?I(r,t):r,e=h.length-1,i;e>=0;e--)(i=h[e])&&(n=(o?i(r,t,n):i(n))||n);return o&&n&&C(r,t,n),n},m=(h,r)=>(t,o)=>r(t,o,h);import*as p from"../../../../base/browser/dom.js";import{status as E}from"../../../../base/browser/ui/aria/aria.js";import{KeybindingLabel as N}from"../../../../base/browser/ui/keybindingLabel/keybindingLabel.js";import{Event as x}from"../../../../base/common/event.js";import"../../../../base/common/keybindings.js";import{Disposable as L}from"../../../../base/common/lifecycle.js";import{OS as S}from"../../../../base/common/platform.js";import{ContentWidgetPositionPreference as k}from"../../../../editor/browser/editorBrowser.js";import{EditorOption as K}from"../../../../editor/common/config/editorOptions.js";import{localize as c}from"../../../../nls.js";import{IConfigurationService as H}from"../../../../platform/configuration/common/configuration.js";import{IKeybindingService as D}from"../../../../platform/keybinding/common/keybinding.js";import{AccessibilityVerbositySettingId as y}from"../../accessibility/browser/accessibilityConfiguration.js";import{AccessibilityCommandId as P}from"../../accessibility/common/accessibilityCommands.js";import{InteractiveWindowSetting as b}from"./interactiveCommon.js";let s=class extends L{constructor(t,o,n){super();this.editor=t;this.configurationService=o;this.keybindingService=n;this._register(this.editor.onDidChangeConfiguration(i=>{this.domNode&&i.hasChanged(K.fontInfo)&&this.editor.applyFontInfo(this.domNode)}));const e=x.debounce(this.editor.onDidFocusEditorText,()=>{},500);this._register(e(()=>{this.editor.hasTextFocus()&&this.ariaLabel&&o.getValue(y.ReplInputHint)&&E(this.ariaLabel)})),this._register(o.onDidChangeConfiguration(i=>{i.affectsConfiguration(b.executeWithShiftEnter)&&this.setHint()})),this.editor.addContentWidget(this)}static ID="replInput.widget.emptyHint";domNode;ariaLabel="";getId(){return s.ID}getPosition(){return{position:{lineNumber:1,column:1},preference:[k.EXACT]}}getDomNode(){return this.domNode||(this.domNode=p.$(".empty-editor-hint"),this.domNode.style.width="max-content",this.domNode.style.paddingLeft="4px",this.setHint(),this._register(p.addDisposableListener(this.domNode,"click",()=>{this.editor.focus()})),this.editor.applyFontInfo(this.domNode)),this.domNode}setHint(){if(!this.domNode)return;for(;this.domNode.firstChild;)this.domNode.removeChild(this.domNode.firstChild);const t=p.$("div.empty-hint-text");t.style.cursor="text",t.style.whiteSpace="nowrap";const o=this.getKeybinding(),n=o?.getLabel();if(o&&n){const e=c("emptyHintText","Press {0} to execute. ",n),[i,d]=e.split(n).map(v=>{const f=p.$("span",void 0,v);return f.style.fontStyle="italic",f});t.appendChild(i);const a=new N(t,S);a.set(o),a.element.style.width="min-content",a.element.style.display="inline",t.appendChild(d),this.domNode.append(t);const l=this.keybindingService.lookupKeybinding(P.OpenAccessibilityHelp)?.getLabel(),u=l?c("ReplInputAriaLabelHelp","Use {0} for accessibility help. ",l):c("ReplInputAriaLabelHelpNoKb","Run the Open Accessibility Help command for more information. ");this.ariaLabel=u.concat(e,c("disableHint"," Toggle {0} in settings to disable this hint.",y.ReplInputHint))}}getKeybinding(){const t=this.keybindingService.lookupKeybindings("interactive.execute"),o=this.configurationService.getValue(b.executeWithShiftEnter),n=(e,i="")=>{const d=e.getDispatchChords(),a=i+"Enter",l=i+"[Enter]";return d.length===1&&(d[0]===a||d[0]===l)};if(o){const e=t.find(i=>n(i,"shift+"));if(e)return e}else{let e=t.find(i=>n(i));if(e||(e=this.keybindingService.lookupKeybindings("python.execInREPLEnter").find(i=>n(i)),e))return e}return t?.[0]}dispose(){super.dispose(),this.editor.removeContentWidget(this)}};s=g([m(1,H),m(2,D)],s);export{s as ReplInputHintContentWidget};
