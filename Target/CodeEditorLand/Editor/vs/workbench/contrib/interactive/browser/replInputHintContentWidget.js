var b=Object.defineProperty;var v=Object.getOwnPropertyDescriptor;var f=(h,r,i,n)=>{for(var o=n>1?void 0:n?v(r,i):r,e=h.length-1,t;e>=0;e--)(t=h[e])&&(o=(n?t(r,i,o):t(o))||o);return n&&o&&b(r,i,o),o},p=(h,r)=>(i,n)=>r(i,n,h);import*as m from"../../../../base/browser/dom.js";import{status as C}from"../../../../base/browser/ui/aria/aria.js";import{KeybindingLabel as E}from"../../../../base/browser/ui/keybindingLabel/keybindingLabel.js";import{Event as I}from"../../../../base/common/event.js";import{Disposable as N}from"../../../../base/common/lifecycle.js";import{OS as x}from"../../../../base/common/platform.js";import{ContentWidgetPositionPreference as S}from"../../../../editor/browser/editorBrowser.js";import{EditorOption as k}from"../../../../editor/common/config/editorOptions.js";import{localize as g}from"../../../../nls.js";import{IConfigurationService as L}from"../../../../platform/configuration/common/configuration.js";import{IKeybindingService as D}from"../../../../platform/keybinding/common/keybinding.js";import{AccessibilityVerbositySettingId as y}from"../../accessibility/browser/accessibilityConfiguration.js";import{InteractiveWindowSetting as u}from"./interactiveCommon.js";let s=class extends N{constructor(i,n,o){super();this.editor=i;this.configurationService=n;this.keybindingService=o;this._register(this.editor.onDidChangeConfiguration(t=>{this.domNode&&t.hasChanged(k.fontInfo)&&this.editor.applyFontInfo(this.domNode)}));const e=I.debounce(this.editor.onDidFocusEditorText,()=>{},500);this._register(e(()=>{this.editor.hasTextFocus()&&this.ariaLabel&&n.getValue(y.ReplInputHint)&&C(this.ariaLabel)})),this._register(n.onDidChangeConfiguration(t=>{t.affectsConfiguration(u.executeWithShiftEnter)&&this.setHint()})),this.editor.addContentWidget(this)}static ID="replInput.widget.emptyHint";domNode;ariaLabel="";getId(){return s.ID}getPosition(){return{position:{lineNumber:1,column:1},preference:[S.EXACT]}}getDomNode(){return this.domNode||(this.domNode=m.$(".empty-editor-hint"),this.domNode.style.width="max-content",this.domNode.style.paddingLeft="4px",this.setHint(),this._register(m.addDisposableListener(this.domNode,"click",()=>{this.editor.focus()})),this.editor.applyFontInfo(this.domNode)),this.domNode}setHint(){if(!this.domNode)return;for(;this.domNode.firstChild;)this.domNode.removeChild(this.domNode.firstChild);const i=m.$("div.empty-hint-text");i.style.cursor="text",i.style.whiteSpace="nowrap";const n=this.getKeybinding(),o=n?.getLabel();if(n&&o){const e=g("emptyHintText","Press {0} to execute. ",o),[t,d]=e.split(o).map(l=>{const c=m.$("span",void 0,l);return c.style.fontStyle="italic",c});i.appendChild(t);const a=new E(i,x);a.set(n),a.element.style.width="min-content",a.element.style.display="inline",i.appendChild(d),this.domNode.append(i),this.ariaLabel=e.concat(g("disableHint"," Toggle {0} in settings to disable this hint.",y.ReplInputHint))}}getKeybinding(){const i=this.keybindingService.lookupKeybindings("interactive.execute"),n=this.configurationService.getValue(u.executeWithShiftEnter),o=(e,t="")=>{const d=e.getDispatchChords(),a=t+"Enter",l=t+"[Enter]";return d.length===1&&(d[0]===a||d[0]===l)};if(n){const e=i.find(t=>o(t,"shift+"));if(e)return e}else{let e=i.find(t=>o(t));if(e||(e=this.keybindingService.lookupKeybindings("python.execInREPLEnter").find(t=>o(t)),e))return e}return i?.[0]}dispose(){super.dispose(),this.editor.removeContentWidget(this)}};s=f([p(1,L),p(2,D)],s);export{s as ReplInputHintContentWidget};
