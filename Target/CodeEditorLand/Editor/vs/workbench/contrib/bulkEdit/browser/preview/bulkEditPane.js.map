{
  "version": 3,
  "sources": ["../../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/bulkEdit/browser/preview/bulkEditPane.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { ButtonBar } from \"../../../../../base/browser/ui/button/button.js\";\nimport type { IAsyncDataTreeViewState } from \"../../../../../base/browser/ui/tree/asyncDataTree.js\";\nimport type { ITreeContextMenuEvent } from \"../../../../../base/browser/ui/tree/tree.js\";\nimport {\n\tCachedFunction,\n\tLRUCachedFunction,\n} from \"../../../../../base/common/cache.js\";\nimport type { CancellationToken } from \"../../../../../base/common/cancellation.js\";\nimport type { FuzzyScore } from \"../../../../../base/common/filters.js\";\nimport { DisposableStore } from \"../../../../../base/common/lifecycle.js\";\nimport type { Mutable } from \"../../../../../base/common/types.js\";\nimport { URI } from \"../../../../../base/common/uri.js\";\nimport \"./bulkEdit.css\";\nimport type { ResourceEdit } from \"../../../../../editor/browser/services/bulkEditService.js\";\nimport type {\n\tIMultiDiffEditorOptions,\n\tIMultiDiffResourceId,\n} from \"../../../../../editor/browser/widget/multiDiffEditor/multiDiffEditorWidgetImpl.js\";\nimport type { IRange } from \"../../../../../editor/common/core/range.js\";\nimport { ITextModelService } from \"../../../../../editor/common/services/resolverService.js\";\nimport { localize } from \"../../../../../nls.js\";\nimport { MenuId } from \"../../../../../platform/actions/common/actions.js\";\nimport { IConfigurationService } from \"../../../../../platform/configuration/common/configuration.js\";\nimport {\n\ttype IContextKey,\n\tIContextKeyService,\n\tRawContextKey,\n} from \"../../../../../platform/contextkey/common/contextkey.js\";\nimport { IContextMenuService } from \"../../../../../platform/contextview/browser/contextView.js\";\nimport { IDialogService } from \"../../../../../platform/dialogs/common/dialogs.js\";\nimport { IHoverService } from \"../../../../../platform/hover/browser/hover.js\";\nimport { IInstantiationService } from \"../../../../../platform/instantiation/common/instantiation.js\";\nimport { IKeybindingService } from \"../../../../../platform/keybinding/common/keybinding.js\";\nimport { ILabelService } from \"../../../../../platform/label/common/label.js\";\nimport {\n\ttype IOpenEvent,\n\tWorkbenchAsyncDataTree,\n} from \"../../../../../platform/list/browser/listService.js\";\nimport { IOpenerService } from \"../../../../../platform/opener/common/opener.js\";\nimport {\n\tIStorageService,\n\tStorageScope,\n\tStorageTarget,\n} from \"../../../../../platform/storage/common/storage.js\";\nimport { ITelemetryService } from \"../../../../../platform/telemetry/common/telemetry.js\";\nimport { defaultButtonStyles } from \"../../../../../platform/theme/browser/defaultStyles.js\";\nimport { IThemeService } from \"../../../../../platform/theme/common/themeService.js\";\nimport { ResourceLabels } from \"../../../../browser/labels.js\";\nimport { ViewPane } from \"../../../../browser/parts/views/viewPane.js\";\nimport type { IViewletViewOptions } from \"../../../../browser/parts/views/viewsViewlet.js\";\nimport type {\n\tIMultiDiffEditorResource,\n\tIResourceDiffEditorInput,\n} from \"../../../../common/editor.js\";\nimport { IViewDescriptorService } from \"../../../../common/views.js\";\nimport {\n\tACTIVE_GROUP,\n\tIEditorService,\n\tSIDE_GROUP,\n} from \"../../../../services/editor/common/editorService.js\";\nimport {\n\tBulkEditPreviewProvider,\n\ttype BulkFileOperation,\n\tBulkFileOperationType,\n\tBulkFileOperations,\n} from \"./bulkEditPreview.js\";\nimport {\n\tBulkEditAccessibilityProvider,\n\tBulkEditDataSource,\n\tBulkEditDelegate,\n\ttype BulkEditElement,\n\tBulkEditIdentityProvider,\n\tBulkEditNaviLabelProvider,\n\tBulkEditSorter,\n\tCategoryElement,\n\tCategoryElementRenderer,\n\tFileElement,\n\tFileElementRenderer,\n\tTextEditElement,\n\tTextEditElementRenderer,\n\tcompareBulkFileOperations,\n} from \"./bulkEditTree.js\";\n\nenum State {\n\tData = \"data\",\n\tMessage = \"message\",\n}\n\nexport class BulkEditPane extends ViewPane {\n\tstatic readonly ID = \"refactorPreview\";\n\tstatic readonly Schema = \"vscode-bulkeditpreview-multieditor\";\n\n\tstatic readonly ctxHasCategories = new RawContextKey(\n\t\t\"refactorPreview.hasCategories\",\n\t\tfalse,\n\t);\n\tstatic readonly ctxGroupByFile = new RawContextKey(\n\t\t\"refactorPreview.groupByFile\",\n\t\ttrue,\n\t);\n\tstatic readonly ctxHasCheckedChanges = new RawContextKey(\n\t\t\"refactorPreview.hasCheckedChanges\",\n\t\ttrue,\n\t);\n\n\tprivate static readonly _memGroupByFile = `${this.ID}.groupByFile`;\n\n\tprivate _tree!: WorkbenchAsyncDataTree<\n\t\tBulkFileOperations,\n\t\tBulkEditElement,\n\t\tFuzzyScore\n\t>;\n\tprivate _treeDataSource!: BulkEditDataSource;\n\tprivate _treeViewStates = new Map<boolean, IAsyncDataTreeViewState>();\n\tprivate _message!: HTMLSpanElement;\n\n\tprivate readonly _ctxHasCategories: IContextKey<boolean>;\n\tprivate readonly _ctxGroupByFile: IContextKey<boolean>;\n\tprivate readonly _ctxHasCheckedChanges: IContextKey<boolean>;\n\n\tprivate readonly _disposables = new DisposableStore();\n\tprivate readonly _sessionDisposables = new DisposableStore();\n\tprivate _currentResolve?: (edit?: ResourceEdit[]) => void;\n\tprivate _currentInput?: BulkFileOperations;\n\tprivate _currentProvider?: BulkEditPreviewProvider;\n\n\tconstructor(\n\t\toptions: IViewletViewOptions,\n\t\t@IInstantiationService\n\t\tprivate readonly _instaService: IInstantiationService,\n\t\t@IEditorService private readonly _editorService: IEditorService,\n\t\t@ILabelService private readonly _labelService: ILabelService,\n\t\t@ITextModelService\n\t\tprivate readonly _textModelService: ITextModelService,\n\t\t@IDialogService private readonly _dialogService: IDialogService,\n\t\t@IContextMenuService\n\t\tprivate readonly _contextMenuService: IContextMenuService,\n\t\t@IStorageService private readonly _storageService: IStorageService,\n\t\t@IContextKeyService contextKeyService: IContextKeyService,\n\t\t@IViewDescriptorService viewDescriptorService: IViewDescriptorService,\n\t\t@IKeybindingService keybindingService: IKeybindingService,\n\t\t@IContextMenuService contextMenuService: IContextMenuService,\n\t\t@IConfigurationService configurationService: IConfigurationService,\n\t\t@IOpenerService openerService: IOpenerService,\n\t\t@IThemeService themeService: IThemeService,\n\t\t@ITelemetryService telemetryService: ITelemetryService,\n\t\t@IHoverService hoverService: IHoverService,\n\t) {\n\t\tsuper(\n\t\t\t{ ...options, titleMenuId: MenuId.BulkEditTitle },\n\t\t\tkeybindingService,\n\t\t\tcontextMenuService,\n\t\t\tconfigurationService,\n\t\t\tcontextKeyService,\n\t\t\tviewDescriptorService,\n\t\t\t_instaService,\n\t\t\topenerService,\n\t\t\tthemeService,\n\t\t\ttelemetryService,\n\t\t\thoverService,\n\t\t);\n\n\t\tthis.element.classList.add(\"bulk-edit-panel\", \"show-file-icons\");\n\t\tthis._ctxHasCategories =\n\t\t\tBulkEditPane.ctxHasCategories.bindTo(contextKeyService);\n\t\tthis._ctxGroupByFile =\n\t\t\tBulkEditPane.ctxGroupByFile.bindTo(contextKeyService);\n\t\tthis._ctxHasCheckedChanges =\n\t\t\tBulkEditPane.ctxHasCheckedChanges.bindTo(contextKeyService);\n\t\t// telemetry\n\t\ttype BulkEditPaneOpened = {\n\t\t\towner: \"aiday-mar\";\n\t\t\tcomment: \"Report when the bulk edit pane has been opened\";\n\t\t};\n\t\tthis.telemetryService.publicLog2<{}, BulkEditPaneOpened>(\n\t\t\t\"views.bulkEditPane\",\n\t\t);\n\t}\n\n\toverride dispose(): void {\n\t\tthis._tree.dispose();\n\t\tthis._disposables.dispose();\n\t\tsuper.dispose();\n\t}\n\n\tprotected override renderBody(parent: HTMLElement): void {\n\t\tsuper.renderBody(parent);\n\n\t\tconst resourceLabels = this._instaService.createInstance(\n\t\t\tResourceLabels,\n\t\t\t{ onDidChangeVisibility: this.onDidChangeBodyVisibility },\n\t\t);\n\t\tthis._disposables.add(resourceLabels);\n\n\t\tconst contentContainer = document.createElement(\"div\");\n\t\tcontentContainer.className = \"content\";\n\t\tparent.appendChild(contentContainer);\n\n\t\t// tree\n\t\tconst treeContainer = document.createElement(\"div\");\n\t\tcontentContainer.appendChild(treeContainer);\n\n\t\tthis._treeDataSource =\n\t\t\tthis._instaService.createInstance(BulkEditDataSource);\n\t\tthis._treeDataSource.groupByFile = this._storageService.getBoolean(\n\t\t\tBulkEditPane._memGroupByFile,\n\t\t\tStorageScope.PROFILE,\n\t\t\ttrue,\n\t\t);\n\t\tthis._ctxGroupByFile.set(this._treeDataSource.groupByFile);\n\n\t\tthis._tree = <\n\t\t\tWorkbenchAsyncDataTree<\n\t\t\t\tBulkFileOperations,\n\t\t\t\tBulkEditElement,\n\t\t\t\tFuzzyScore\n\t\t\t>\n\t\t>this._instaService.createInstance(\n\t\t\tWorkbenchAsyncDataTree,\n\t\t\tthis.id,\n\t\t\ttreeContainer,\n\t\t\tnew BulkEditDelegate(),\n\t\t\t[\n\t\t\t\tthis._instaService.createInstance(TextEditElementRenderer),\n\t\t\t\tthis._instaService.createInstance(\n\t\t\t\t\tFileElementRenderer,\n\t\t\t\t\tresourceLabels,\n\t\t\t\t),\n\t\t\t\tthis._instaService.createInstance(CategoryElementRenderer),\n\t\t\t],\n\t\t\tthis._treeDataSource,\n\t\t\t{\n\t\t\t\taccessibilityProvider: this._instaService.createInstance(\n\t\t\t\t\tBulkEditAccessibilityProvider,\n\t\t\t\t),\n\t\t\t\tidentityProvider: new BulkEditIdentityProvider(),\n\t\t\t\texpandOnlyOnTwistieClick: true,\n\t\t\t\tmultipleSelectionSupport: false,\n\t\t\t\tkeyboardNavigationLabelProvider:\n\t\t\t\t\tnew BulkEditNaviLabelProvider(),\n\t\t\t\tsorter: new BulkEditSorter(),\n\t\t\t\tselectionNavigation: true,\n\t\t\t},\n\t\t);\n\n\t\tthis._disposables.add(\n\t\t\tthis._tree.onContextMenu(this._onContextMenu, this),\n\t\t);\n\t\tthis._disposables.add(\n\t\t\tthis._tree.onDidOpen((e) => this._openElementInMultiDiffEditor(e)),\n\t\t);\n\n\t\t// buttons\n\t\tconst buttonsContainer = document.createElement(\"div\");\n\t\tbuttonsContainer.className = \"buttons\";\n\t\tcontentContainer.appendChild(buttonsContainer);\n\t\tconst buttonBar = new ButtonBar(buttonsContainer);\n\t\tthis._disposables.add(buttonBar);\n\n\t\tconst btnConfirm = buttonBar.addButton({\n\t\t\tsupportIcons: true,\n\t\t\t...defaultButtonStyles,\n\t\t});\n\t\tbtnConfirm.label = localize(\"ok\", \"Apply\");\n\t\tbtnConfirm.onDidClick(() => this.accept(), this, this._disposables);\n\n\t\tconst btnCancel = buttonBar.addButton({\n\t\t\t...defaultButtonStyles,\n\t\t\tsecondary: true,\n\t\t});\n\t\tbtnCancel.label = localize(\"cancel\", \"Discard\");\n\t\tbtnCancel.onDidClick(() => this.discard(), this, this._disposables);\n\n\t\t// message\n\t\tthis._message = document.createElement(\"span\");\n\t\tthis._message.className = \"message\";\n\t\tthis._message.innerText = localize(\n\t\t\t\"empty.msg\",\n\t\t\t\"Invoke a code action, like rename, to see a preview of its changes here.\",\n\t\t);\n\t\tparent.appendChild(this._message);\n\n\t\t//\n\t\tthis._setState(State.Message);\n\t}\n\n\tprotected override layoutBody(height: number, width: number): void {\n\t\tsuper.layoutBody(height, width);\n\t\tconst treeHeight = height - 50;\n\t\tthis._tree.getHTMLElement().parentElement!.style.height =\n\t\t\t`${treeHeight}px`;\n\t\tthis._tree.layout(treeHeight, width);\n\t}\n\n\tprivate _setState(state: State): void {\n\t\tthis.element.dataset[\"state\"] = state;\n\t}\n\n\tasync setInput(\n\t\tedit: ResourceEdit[],\n\t\ttoken: CancellationToken,\n\t): Promise<ResourceEdit[] | undefined> {\n\t\tthis._setState(State.Data);\n\t\tthis._sessionDisposables.clear();\n\t\tthis._treeViewStates.clear();\n\n\t\tif (this._currentResolve) {\n\t\t\tthis._currentResolve(undefined);\n\t\t\tthis._currentResolve = undefined;\n\t\t}\n\n\t\tconst input = await this._instaService.invokeFunction(\n\t\t\tBulkFileOperations.create,\n\t\t\tedit,\n\t\t);\n\t\tthis._currentProvider = this._instaService.createInstance(\n\t\t\tBulkEditPreviewProvider,\n\t\t\tinput,\n\t\t);\n\t\tthis._sessionDisposables.add(this._currentProvider);\n\t\tthis._sessionDisposables.add(input);\n\n\t\t//\n\t\tconst hasCategories = input.categories.length > 1;\n\t\tthis._ctxHasCategories.set(hasCategories);\n\t\tthis._treeDataSource.groupByFile =\n\t\t\t!hasCategories || this._treeDataSource.groupByFile;\n\t\tthis._ctxHasCheckedChanges.set(input.checked.checkedCount > 0);\n\n\t\tthis._currentInput = input;\n\n\t\treturn new Promise<ResourceEdit[] | undefined>((resolve) => {\n\t\t\ttoken.onCancellationRequested(() => resolve(undefined));\n\n\t\t\tthis._currentResolve = resolve;\n\t\t\tthis._setTreeInput(input);\n\n\t\t\t// refresh when check state changes\n\t\t\tthis._sessionDisposables.add(\n\t\t\t\tinput.checked.onDidChange(() => {\n\t\t\t\t\tthis._tree.updateChildren();\n\t\t\t\t\tthis._ctxHasCheckedChanges.set(\n\t\t\t\t\t\tinput.checked.checkedCount > 0,\n\t\t\t\t\t);\n\t\t\t\t}),\n\t\t\t);\n\t\t});\n\t}\n\n\thasInput(): boolean {\n\t\treturn Boolean(this._currentInput);\n\t}\n\n\tprivate async _setTreeInput(input: BulkFileOperations) {\n\t\tconst viewState = this._treeViewStates.get(\n\t\t\tthis._treeDataSource.groupByFile,\n\t\t);\n\t\tawait this._tree.setInput(input, viewState);\n\t\tthis._tree.domFocus();\n\n\t\tif (viewState) {\n\t\t\treturn;\n\t\t}\n\n\t\t// async expandAll (max=10) is the default when no view state is given\n\t\tconst expand = [...this._tree.getNode(input).children].slice(0, 10);\n\t\twhile (expand.length > 0) {\n\t\t\tconst { element } = expand.shift()!;\n\t\t\tif (element instanceof FileElement) {\n\t\t\t\tawait this._tree.expand(element, true);\n\t\t\t}\n\t\t\tif (element instanceof CategoryElement) {\n\t\t\t\tawait this._tree.expand(element, true);\n\t\t\t\texpand.push(...this._tree.getNode(element).children);\n\t\t\t}\n\t\t}\n\t}\n\n\taccept(): void {\n\t\tconst conflicts = this._currentInput?.conflicts.list();\n\n\t\tif (!conflicts || conflicts.length === 0) {\n\t\t\tthis._done(true);\n\t\t\treturn;\n\t\t}\n\n\t\tlet message: string;\n\t\tif (conflicts.length === 1) {\n\t\t\tmessage = localize(\n\t\t\t\t\"conflict.1\",\n\t\t\t\t\"Cannot apply refactoring because '{0}' has changed in the meantime.\",\n\t\t\t\tthis._labelService.getUriLabel(conflicts[0], {\n\t\t\t\t\trelative: true,\n\t\t\t\t}),\n\t\t\t);\n\t\t} else {\n\t\t\tmessage = localize(\n\t\t\t\t\"conflict.N\",\n\t\t\t\t\"Cannot apply refactoring because {0} other files have changed in the meantime.\",\n\t\t\t\tconflicts.length,\n\t\t\t);\n\t\t}\n\n\t\tthis._dialogService.warn(message).finally(() => this._done(false));\n\t}\n\n\tdiscard() {\n\t\tthis._done(false);\n\t}\n\n\tprivate _done(accept: boolean): void {\n\t\tthis._currentResolve?.(\n\t\t\taccept ? this._currentInput?.getWorkspaceEdit() : undefined,\n\t\t);\n\t\tthis._currentInput = undefined;\n\t\tthis._setState(State.Message);\n\t\tthis._sessionDisposables.clear();\n\t}\n\n\ttoggleChecked() {\n\t\tconst [first] = this._tree.getFocus();\n\t\tif (\n\t\t\t(first instanceof FileElement ||\n\t\t\t\tfirst instanceof TextEditElement) &&\n\t\t\t!first.isDisabled()\n\t\t) {\n\t\t\tfirst.setChecked(!first.isChecked());\n\t\t} else if (first instanceof CategoryElement) {\n\t\t\tfirst.setChecked(!first.isChecked());\n\t\t}\n\t}\n\n\tgroupByFile(): void {\n\t\tif (!this._treeDataSource.groupByFile) {\n\t\t\tthis.toggleGrouping();\n\t\t}\n\t}\n\n\tgroupByType(): void {\n\t\tif (this._treeDataSource.groupByFile) {\n\t\t\tthis.toggleGrouping();\n\t\t}\n\t}\n\n\ttoggleGrouping() {\n\t\tconst input = this._tree.getInput();\n\t\tif (input) {\n\t\t\t// (1) capture view state\n\t\t\tconst oldViewState = this._tree.getViewState();\n\t\t\tthis._treeViewStates.set(\n\t\t\t\tthis._treeDataSource.groupByFile,\n\t\t\t\toldViewState,\n\t\t\t);\n\n\t\t\t// (2) toggle and update\n\t\t\tthis._treeDataSource.groupByFile =\n\t\t\t\t!this._treeDataSource.groupByFile;\n\t\t\tthis._setTreeInput(input);\n\n\t\t\t// (3) remember preference\n\t\t\tthis._storageService.store(\n\t\t\t\tBulkEditPane._memGroupByFile,\n\t\t\t\tthis._treeDataSource.groupByFile,\n\t\t\t\tStorageScope.PROFILE,\n\t\t\t\tStorageTarget.USER,\n\t\t\t);\n\t\t\tthis._ctxGroupByFile.set(this._treeDataSource.groupByFile);\n\t\t}\n\t}\n\n\tprivate async _openElementInMultiDiffEditor(\n\t\te: IOpenEvent<BulkEditElement | undefined>,\n\t): Promise<void> {\n\t\tconst fileOperations = this._currentInput?.fileOperations;\n\t\tif (!fileOperations) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet selection: IRange | undefined;\n\t\tlet fileElement: FileElement;\n\t\tif (e.element instanceof TextEditElement) {\n\t\t\tfileElement = e.element.parent;\n\t\t\tselection = e.element.edit.textEdit.textEdit.range;\n\t\t} else if (e.element instanceof FileElement) {\n\t\t\tfileElement = e.element;\n\t\t\tselection = e.element.edit.textEdits[0]?.textEdit.textEdit.range;\n\t\t} else {\n\t\t\t// invalid event\n\t\t\treturn;\n\t\t}\n\n\t\tconst result =\n\t\t\tawait this._computeResourceDiffEditorInputs.get(fileOperations);\n\t\tconst resourceId = await result.getResourceDiffEditorInputIdOfOperation(\n\t\t\tfileElement.edit,\n\t\t);\n\t\tconst options: Mutable<IMultiDiffEditorOptions> = {\n\t\t\t...e.editorOptions,\n\t\t\tviewState: {\n\t\t\t\trevealData: {\n\t\t\t\t\tresource: resourceId,\n\t\t\t\t\trange: selection,\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t\tconst multiDiffSource = URI.from({ scheme: BulkEditPane.Schema });\n\t\tconst label = \"Refactor Preview\";\n\t\tthis._editorService.openEditor(\n\t\t\t{\n\t\t\t\tmultiDiffSource,\n\t\t\t\tlabel,\n\t\t\t\toptions,\n\t\t\t\tisTransient: true,\n\t\t\t\tdescription: label,\n\t\t\t\tresources: result.resources,\n\t\t\t},\n\t\t\te.sideBySide ? SIDE_GROUP : ACTIVE_GROUP,\n\t\t);\n\t}\n\n\tprivate readonly _computeResourceDiffEditorInputs = new LRUCachedFunction<\n\t\tBulkFileOperation[],\n\t\tPromise<{\n\t\t\tresources: IMultiDiffEditorResource[];\n\t\t\tgetResourceDiffEditorInputIdOfOperation: (\n\t\t\t\toperation: BulkFileOperation,\n\t\t\t) => Promise<IMultiDiffResourceId>;\n\t\t}>\n\t>(async (fileOperations) => {\n\t\tconst computeDiffEditorInput = new CachedFunction<\n\t\t\tBulkFileOperation,\n\t\t\tPromise<IMultiDiffEditorResource>\n\t\t>(async (fileOperation) => {\n\t\t\tconst fileOperationUri = fileOperation.uri;\n\t\t\tconst previewUri =\n\t\t\t\tthis._currentProvider!.asPreviewUri(fileOperationUri);\n\t\t\t// delete\n\t\t\tif (fileOperation.type & BulkFileOperationType.Delete) {\n\t\t\t\treturn {\n\t\t\t\t\toriginal: { resource: URI.revive(previewUri) },\n\t\t\t\t\tmodified: { resource: undefined },\n\t\t\t\t\tgoToFileResource: fileOperation.uri,\n\t\t\t\t} satisfies IMultiDiffEditorResource;\n\t\t\t}\n\t\t\t// rename, create, edits\n\t\t\telse {\n\t\t\t\tlet leftResource: URI | undefined;\n\t\t\t\ttry {\n\t\t\t\t\t(\n\t\t\t\t\t\tawait this._textModelService.createModelReference(\n\t\t\t\t\t\t\tfileOperationUri,\n\t\t\t\t\t\t)\n\t\t\t\t\t).dispose();\n\t\t\t\t\tleftResource = fileOperationUri;\n\t\t\t\t} catch {\n\t\t\t\t\tleftResource = BulkEditPreviewProvider.emptyPreview;\n\t\t\t\t}\n\t\t\t\treturn {\n\t\t\t\t\toriginal: { resource: URI.revive(leftResource) },\n\t\t\t\t\tmodified: { resource: URI.revive(previewUri) },\n\t\t\t\t\tgoToFileResource: leftResource,\n\t\t\t\t} satisfies IMultiDiffEditorResource;\n\t\t\t}\n\t\t});\n\n\t\tconst sortedFileOperations = fileOperations\n\t\t\t.slice()\n\t\t\t.sort(compareBulkFileOperations);\n\t\tconst resources: IResourceDiffEditorInput[] = [];\n\t\tfor (const operation of sortedFileOperations) {\n\t\t\tresources.push(await computeDiffEditorInput.get(operation));\n\t\t}\n\t\tconst getResourceDiffEditorInputIdOfOperation = async (\n\t\t\toperation: BulkFileOperation,\n\t\t): Promise<IMultiDiffResourceId> => {\n\t\t\tconst resource = await computeDiffEditorInput.get(operation);\n\t\t\treturn {\n\t\t\t\toriginal: resource.original.resource,\n\t\t\t\tmodified: resource.modified.resource,\n\t\t\t};\n\t\t};\n\t\treturn {\n\t\t\tresources,\n\t\t\tgetResourceDiffEditorInputIdOfOperation,\n\t\t};\n\t});\n\n\tprivate _onContextMenu(e: ITreeContextMenuEvent<any>): void {\n\t\tthis._contextMenuService.showContextMenu({\n\t\t\tmenuId: MenuId.BulkEditContext,\n\t\t\tcontextKeyService: this.contextKeyService,\n\t\t\tgetAnchor: () => e.anchor,\n\t\t});\n\t}\n}\n"],
  "mappings": "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",
  "names": ["State"]
}
