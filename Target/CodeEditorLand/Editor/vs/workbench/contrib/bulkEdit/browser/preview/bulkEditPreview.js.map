{
  "version": 3,
  "sources": ["../../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/bulkEdit/browser/preview/bulkEditPreview.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { ITextModelContentProvider, ITextModelService } from '../../../../../editor/common/services/resolverService.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { ILanguageService } from '../../../../../editor/common/languages/language.js';\nimport { IModelService } from '../../../../../editor/common/services/model.js';\nimport { createTextBufferFactoryFromSnapshot } from '../../../../../editor/common/model/textModel.js';\nimport { WorkspaceEditMetadata } from '../../../../../editor/common/languages.js';\nimport { DisposableStore } from '../../../../../base/common/lifecycle.js';\nimport { coalesceInPlace } from '../../../../../base/common/arrays.js';\nimport { Range } from '../../../../../editor/common/core/range.js';\nimport { EditOperation, ISingleEditOperation } from '../../../../../editor/common/core/editOperation.js';\nimport { ServicesAccessor, IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { IFileService } from '../../../../../platform/files/common/files.js';\nimport { Emitter, Event } from '../../../../../base/common/event.js';\nimport { ConflictDetector } from '../conflicts.js';\nimport { ResourceMap } from '../../../../../base/common/map.js';\nimport { localize } from '../../../../../nls.js';\nimport { extUri } from '../../../../../base/common/resources.js';\nimport { ResourceEdit, ResourceFileEdit, ResourceTextEdit } from '../../../../../editor/browser/services/bulkEditService.js';\nimport { Codicon } from '../../../../../base/common/codicons.js';\nimport { generateUuid } from '../../../../../base/common/uuid.js';\nimport { SnippetParser } from '../../../../../editor/contrib/snippet/browser/snippetParser.js';\nimport { MicrotaskDelay } from '../../../../../base/common/symbols.js';\n\nexport class CheckedStates<T extends object> {\n\n\tprivate readonly _states = new WeakMap<T, boolean>();\n\tprivate _checkedCount: number = 0;\n\n\tprivate readonly _onDidChange = new Emitter<T>();\n\treadonly onDidChange: Event<T> = this._onDidChange.event;\n\n\tdispose(): void {\n\t\tthis._onDidChange.dispose();\n\t}\n\n\tget checkedCount() {\n\t\treturn this._checkedCount;\n\t}\n\n\tisChecked(obj: T): boolean {\n\t\treturn this._states.get(obj) ?? false;\n\t}\n\n\tupdateChecked(obj: T, value: boolean): void {\n\t\tconst valueNow = this._states.get(obj);\n\t\tif (valueNow === value) {\n\t\t\treturn;\n\t\t}\n\t\tif (valueNow === undefined) {\n\t\t\tif (value) {\n\t\t\t\tthis._checkedCount += 1;\n\t\t\t}\n\t\t} else {\n\t\t\tif (value) {\n\t\t\t\tthis._checkedCount += 1;\n\t\t\t} else {\n\t\t\t\tthis._checkedCount -= 1;\n\t\t\t}\n\t\t}\n\t\tthis._states.set(obj, value);\n\t\tthis._onDidChange.fire(obj);\n\t}\n}\n\nexport class BulkTextEdit {\n\n\tconstructor(\n\t\treadonly parent: BulkFileOperation,\n\t\treadonly textEdit: ResourceTextEdit\n\t) { }\n}\n\nexport const enum BulkFileOperationType {\n\tTextEdit = 1,\n\tCreate = 2,\n\tDelete = 4,\n\tRename = 8,\n}\n\nexport class BulkFileOperation {\n\n\ttype = 0;\n\ttextEdits: BulkTextEdit[] = [];\n\toriginalEdits = new Map<number, ResourceTextEdit | ResourceFileEdit>();\n\tnewUri?: URI;\n\n\tconstructor(\n\t\treadonly uri: URI,\n\t\treadonly parent: BulkFileOperations\n\t) { }\n\n\taddEdit(index: number, type: BulkFileOperationType, edit: ResourceTextEdit | ResourceFileEdit) {\n\t\tthis.type |= type;\n\t\tthis.originalEdits.set(index, edit);\n\t\tif (edit instanceof ResourceTextEdit) {\n\t\t\tthis.textEdits.push(new BulkTextEdit(this, edit));\n\n\t\t} else if (type === BulkFileOperationType.Rename) {\n\t\t\tthis.newUri = edit.newResource;\n\t\t}\n\t}\n\n\tneedsConfirmation(): boolean {\n\t\tfor (const [, edit] of this.originalEdits) {\n\t\t\tif (!this.parent.checked.isChecked(edit)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n}\n\nexport class BulkCategory {\n\n\tprivate static readonly _defaultMetadata = Object.freeze({\n\t\tlabel: localize('default', \"Other\"),\n\t\ticon: Codicon.symbolFile,\n\t\tneedsConfirmation: false\n\t});\n\n\tstatic keyOf(metadata?: WorkspaceEditMetadata) {\n\t\treturn metadata?.label || '<default>';\n\t}\n\n\treadonly operationByResource = new Map<string, BulkFileOperation>();\n\n\tconstructor(readonly metadata: WorkspaceEditMetadata = BulkCategory._defaultMetadata) { }\n\n\tget fileOperations(): IterableIterator<BulkFileOperation> {\n\t\treturn this.operationByResource.values();\n\t}\n}\n\nexport class BulkFileOperations {\n\n\tstatic async create(accessor: ServicesAccessor, bulkEdit: ResourceEdit[]): Promise<BulkFileOperations> {\n\t\tconst result = accessor.get(IInstantiationService).createInstance(BulkFileOperations, bulkEdit);\n\t\treturn await result._init();\n\t}\n\n\treadonly checked = new CheckedStates<ResourceEdit>();\n\n\treadonly fileOperations: BulkFileOperation[] = [];\n\treadonly categories: BulkCategory[] = [];\n\treadonly conflicts: ConflictDetector;\n\n\tconstructor(\n\t\tprivate readonly _bulkEdit: ResourceEdit[],\n\t\t@IFileService private readonly _fileService: IFileService,\n\t\t@IInstantiationService instaService: IInstantiationService,\n\t) {\n\t\tthis.conflicts = instaService.createInstance(ConflictDetector, _bulkEdit);\n\t}\n\n\tdispose(): void {\n\t\tthis.checked.dispose();\n\t\tthis.conflicts.dispose();\n\t}\n\n\tasync _init() {\n\t\tconst operationByResource = new Map<string, BulkFileOperation>();\n\t\tconst operationByCategory = new Map<string, BulkCategory>();\n\n\t\tconst newToOldUri = new ResourceMap<URI>();\n\n\t\tfor (let idx = 0; idx < this._bulkEdit.length; idx++) {\n\t\t\tconst edit = this._bulkEdit[idx];\n\n\t\t\tlet uri: URI;\n\t\t\tlet type: BulkFileOperationType;\n\n\t\t\t// store inital checked state\n\t\t\tthis.checked.updateChecked(edit, !edit.metadata?.needsConfirmation);\n\n\t\t\tif (edit instanceof ResourceTextEdit) {\n\t\t\t\ttype = BulkFileOperationType.TextEdit;\n\t\t\t\turi = edit.resource;\n\n\t\t\t} else if (edit instanceof ResourceFileEdit) {\n\t\t\t\tif (edit.newResource && edit.oldResource) {\n\t\t\t\t\ttype = BulkFileOperationType.Rename;\n\t\t\t\t\turi = edit.oldResource;\n\t\t\t\t\tif (edit.options?.overwrite === undefined && edit.options?.ignoreIfExists && await this._fileService.exists(uri)) {\n\t\t\t\t\t\t// noop -> \"soft\" rename to something that already exists\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\t// map newResource onto oldResource so that text-edit appear for\n\t\t\t\t\t// the same file element\n\t\t\t\t\tnewToOldUri.set(edit.newResource, uri);\n\n\t\t\t\t} else if (edit.oldResource) {\n\t\t\t\t\ttype = BulkFileOperationType.Delete;\n\t\t\t\t\turi = edit.oldResource;\n\t\t\t\t\tif (edit.options?.ignoreIfNotExists && !await this._fileService.exists(uri)) {\n\t\t\t\t\t\t// noop -> \"soft\" delete something that doesn't exist\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t} else if (edit.newResource) {\n\t\t\t\t\ttype = BulkFileOperationType.Create;\n\t\t\t\t\turi = edit.newResource;\n\t\t\t\t\tif (edit.options?.overwrite === undefined && edit.options?.ignoreIfExists && await this._fileService.exists(uri)) {\n\t\t\t\t\t\t// noop -> \"soft\" create something that already exists\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\t\t\t\t\t// invalid edit -> skip\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t} else {\n\t\t\t\t// unsupported edit\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst insert = (uri: URI, map: Map<string, BulkFileOperation>) => {\n\t\t\t\tlet key = extUri.getComparisonKey(uri, true);\n\t\t\t\tlet operation = map.get(key);\n\n\t\t\t\t// rename\n\t\t\t\tif (!operation && newToOldUri.has(uri)) {\n\t\t\t\t\turi = newToOldUri.get(uri)!;\n\t\t\t\t\tkey = extUri.getComparisonKey(uri, true);\n\t\t\t\t\toperation = map.get(key);\n\t\t\t\t}\n\n\t\t\t\tif (!operation) {\n\t\t\t\t\toperation = new BulkFileOperation(uri, this);\n\t\t\t\t\tmap.set(key, operation);\n\t\t\t\t}\n\t\t\t\toperation.addEdit(idx, type, edit);\n\t\t\t};\n\n\t\t\tinsert(uri, operationByResource);\n\n\t\t\t// insert into \"this\" category\n\t\t\tconst key = BulkCategory.keyOf(edit.metadata);\n\t\t\tlet category = operationByCategory.get(key);\n\t\t\tif (!category) {\n\t\t\t\tcategory = new BulkCategory(edit.metadata);\n\t\t\t\toperationByCategory.set(key, category);\n\t\t\t}\n\t\t\tinsert(uri, category.operationByResource);\n\t\t}\n\n\t\toperationByResource.forEach(value => this.fileOperations.push(value));\n\t\toperationByCategory.forEach(value => this.categories.push(value));\n\n\t\t// \"correct\" invalid parent-check child states that is\n\t\t// unchecked file edits (rename, create, delete) uncheck\n\t\t// all edits for a file, e.g no text change without rename\n\t\tfor (const file of this.fileOperations) {\n\t\t\tif (file.type !== BulkFileOperationType.TextEdit) {\n\t\t\t\tlet checked = true;\n\t\t\t\tfor (const edit of file.originalEdits.values()) {\n\t\t\t\t\tif (edit instanceof ResourceFileEdit) {\n\t\t\t\t\t\tchecked = checked && this.checked.isChecked(edit);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (!checked) {\n\t\t\t\t\tfor (const edit of file.originalEdits.values()) {\n\t\t\t\t\t\tthis.checked.updateChecked(edit, checked);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// sort (once) categories atop which have unconfirmed edits\n\t\tthis.categories.sort((a, b) => {\n\t\t\tif (a.metadata.needsConfirmation === b.metadata.needsConfirmation) {\n\t\t\t\treturn a.metadata.label.localeCompare(b.metadata.label);\n\t\t\t} else if (a.metadata.needsConfirmation) {\n\t\t\t\treturn -1;\n\t\t\t} else {\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t});\n\n\t\treturn this;\n\t}\n\n\tgetWorkspaceEdit(): ResourceEdit[] {\n\t\tconst result: ResourceEdit[] = [];\n\t\tlet allAccepted = true;\n\n\t\tfor (let i = 0; i < this._bulkEdit.length; i++) {\n\t\t\tconst edit = this._bulkEdit[i];\n\t\t\tif (this.checked.isChecked(edit)) {\n\t\t\t\tresult[i] = edit;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tallAccepted = false;\n\t\t}\n\n\t\tif (allAccepted) {\n\t\t\treturn this._bulkEdit;\n\t\t}\n\n\t\t// not all edits have been accepted\n\t\tcoalesceInPlace(result);\n\t\treturn result;\n\t}\n\n\tprivate async getFileEditOperation(edit: ResourceFileEdit): Promise<ISingleEditOperation | undefined> {\n\t\tconst content = await edit.options.contents;\n\t\tif (!content) { return undefined; }\n\t\treturn EditOperation.replaceMove(Range.lift({ startLineNumber: 0, startColumn: 0, endLineNumber: Number.MAX_VALUE, endColumn: 0 }), content.toString());\n\t}\n\n\tasync getFileEdits(uri: URI): Promise<ISingleEditOperation[]> {\n\n\t\tfor (const file of this.fileOperations) {\n\t\t\tif (file.uri.toString() === uri.toString()) {\n\n\t\t\t\tconst result: Promise<ISingleEditOperation | undefined>[] = [];\n\t\t\t\tlet ignoreAll = false;\n\n\t\t\t\tfor (const edit of file.originalEdits.values()) {\n\t\t\t\t\tif (edit instanceof ResourceFileEdit) {\n\t\t\t\t\t\tresult.push(this.getFileEditOperation(edit));\n\t\t\t\t\t} else if (edit instanceof ResourceTextEdit) {\n\t\t\t\t\t\tif (this.checked.isChecked(edit)) {\n\t\t\t\t\t\t\tresult.push(Promise.resolve(EditOperation.replaceMove(Range.lift(edit.textEdit.range), !edit.textEdit.insertAsSnippet ? edit.textEdit.text : SnippetParser.asInsertText(edit.textEdit.text))));\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else if (!this.checked.isChecked(edit)) {\n\t\t\t\t\t\t// UNCHECKED WorkspaceFileEdit disables all text edits\n\t\t\t\t\t\tignoreAll = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (ignoreAll) {\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn (await Promise.all(result)).filter(r => r !== undefined).sort((a, b) => Range.compareRangesUsingStarts(a.range, b.range));\n\t\t\t}\n\t\t}\n\t\treturn [];\n\t}\n\n\tgetUriOfEdit(edit: ResourceEdit): URI {\n\t\tfor (const file of this.fileOperations) {\n\t\t\tfor (const value of file.originalEdits.values()) {\n\t\t\t\tif (value === edit) {\n\t\t\t\t\treturn file.uri;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthrow new Error('invalid edit');\n\t}\n}\n\nexport class BulkEditPreviewProvider implements ITextModelContentProvider {\n\n\tprivate static readonly Schema = 'vscode-bulkeditpreview-editor';\n\n\tstatic emptyPreview = URI.from({ scheme: this.Schema, fragment: 'empty' });\n\n\n\tstatic fromPreviewUri(uri: URI): URI {\n\t\treturn URI.parse(uri.query);\n\t}\n\n\tprivate readonly _disposables = new DisposableStore();\n\tprivate readonly _ready: Promise<any>;\n\tprivate readonly _modelPreviewEdits = new Map<string, ISingleEditOperation[]>();\n\tprivate readonly _instanceId = generateUuid();\n\n\tconstructor(\n\t\tprivate readonly _operations: BulkFileOperations,\n\t\t@ILanguageService private readonly _languageService: ILanguageService,\n\t\t@IModelService private readonly _modelService: IModelService,\n\t\t@ITextModelService private readonly _textModelResolverService: ITextModelService\n\t) {\n\t\tthis._disposables.add(this._textModelResolverService.registerTextModelContentProvider(BulkEditPreviewProvider.Schema, this));\n\t\tthis._ready = this._init();\n\t}\n\n\tdispose(): void {\n\t\tthis._disposables.dispose();\n\t}\n\n\tasPreviewUri(uri: URI): URI {\n\t\treturn URI.from({ scheme: BulkEditPreviewProvider.Schema, authority: this._instanceId, path: uri.path, query: uri.toString() });\n\t}\n\n\tprivate async _init() {\n\t\tfor (const operation of this._operations.fileOperations) {\n\t\t\tawait this._applyTextEditsToPreviewModel(operation.uri);\n\t\t}\n\t\tthis._disposables.add(Event.debounce(this._operations.checked.onDidChange, (_last, e) => e, MicrotaskDelay)(e => {\n\t\t\tconst uri = this._operations.getUriOfEdit(e);\n\t\t\tthis._applyTextEditsToPreviewModel(uri);\n\t\t}));\n\t}\n\n\tprivate async _applyTextEditsToPreviewModel(uri: URI) {\n\t\tconst model = await this._getOrCreatePreviewModel(uri);\n\n\t\t// undo edits that have been done before\n\t\tconst undoEdits = this._modelPreviewEdits.get(model.id);\n\t\tif (undoEdits) {\n\t\t\tmodel.applyEdits(undoEdits);\n\t\t}\n\t\t// apply new edits and keep (future) undo edits\n\t\tconst newEdits = await this._operations.getFileEdits(uri);\n\t\tconst newUndoEdits = model.applyEdits(newEdits, true);\n\t\tthis._modelPreviewEdits.set(model.id, newUndoEdits);\n\t}\n\n\tprivate async _getOrCreatePreviewModel(uri: URI) {\n\t\tconst previewUri = this.asPreviewUri(uri);\n\t\tlet model = this._modelService.getModel(previewUri);\n\t\tif (!model) {\n\t\t\ttry {\n\t\t\t\t// try: copy existing\n\t\t\t\tconst ref = await this._textModelResolverService.createModelReference(uri);\n\t\t\t\tconst sourceModel = ref.object.textEditorModel;\n\t\t\t\tmodel = this._modelService.createModel(\n\t\t\t\t\tcreateTextBufferFactoryFromSnapshot(sourceModel.createSnapshot()),\n\t\t\t\t\tthis._languageService.createById(sourceModel.getLanguageId()),\n\t\t\t\t\tpreviewUri\n\t\t\t\t);\n\t\t\t\tref.dispose();\n\n\t\t\t} catch {\n\t\t\t\t// create NEW model\n\t\t\t\tmodel = this._modelService.createModel(\n\t\t\t\t\t'',\n\t\t\t\t\tthis._languageService.createByFilepathOrFirstLine(previewUri),\n\t\t\t\t\tpreviewUri\n\t\t\t\t);\n\t\t\t}\n\t\t\t// this is a little weird but otherwise editors and other cusomers\n\t\t\t// will dispose my models before they should be disposed...\n\t\t\t// And all of this is off the eventloop to prevent endless recursion\n\t\t\tqueueMicrotask(async () => {\n\t\t\t\tthis._disposables.add(await this._textModelResolverService.createModelReference(model!.uri));\n\t\t\t});\n\t\t}\n\t\treturn model;\n\t}\n\n\tasync provideTextContent(previewUri: URI) {\n\t\tif (previewUri.toString() === BulkEditPreviewProvider.emptyPreview.toString()) {\n\t\t\treturn this._modelService.createModel('', null, previewUri);\n\t\t}\n\t\tawait this._ready;\n\t\treturn this._modelService.getModel(previewUri);\n\t}\n}\n"],
  "mappings": "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",
  "names": ["BulkFileOperationType", "uri", "key"]
}
