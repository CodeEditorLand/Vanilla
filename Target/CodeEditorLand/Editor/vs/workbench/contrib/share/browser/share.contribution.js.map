{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/share/browser/share.contribution.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport './share.css';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { MarkdownString } from '../../../../base/common/htmlContent.js';\nimport { KeyCode, KeyMod } from '../../../../base/common/keyCodes.js';\nimport { localize, localize2 } from '../../../../nls.js';\nimport { Action2, MenuId, MenuRegistry, registerAction2 } from '../../../../platform/actions/common/actions.js';\nimport { IClipboardService } from '../../../../platform/clipboard/common/clipboardService.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nimport { EditorResourceAccessor, SideBySideEditor } from '../../../common/editor.js';\nimport { IDialogService } from '../../../../platform/dialogs/common/dialogs.js';\nimport { InstantiationType, registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { ServicesAccessor } from '../../../../platform/instantiation/common/instantiation.js';\nimport { KeybindingWeight } from '../../../../platform/keybinding/common/keybindingsRegistry.js';\nimport { Severity } from '../../../../platform/notification/common/notification.js';\nimport { IOpenerService } from '../../../../platform/opener/common/opener.js';\nimport { Registry } from '../../../../platform/registry/common/platform.js';\nimport { IWorkspaceContextService } from '../../../../platform/workspace/common/workspace.js';\nimport { WorkspaceFolderCountContext } from '../../../common/contextkeys.js';\nimport { Extensions, IWorkbenchContributionsRegistry } from '../../../common/contributions.js';\nimport { ShareProviderCountContext, ShareService } from './shareService.js';\nimport { IShareService } from '../common/share.js';\nimport { LifecyclePhase } from '../../../services/lifecycle/common/lifecycle.js';\nimport { IEditorService } from '../../../services/editor/common/editorService.js';\nimport { IProgressService, ProgressLocation } from '../../../../platform/progress/common/progress.js';\nimport { ICodeEditorService } from '../../../../editor/browser/services/codeEditorService.js';\nimport { IConfigurationRegistry, Extensions as ConfigurationExtensions } from '../../../../platform/configuration/common/configurationRegistry.js';\nimport { workbenchConfigurationNodeBase } from '../../../common/configuration.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\n\nconst targetMenus = [\n\tMenuId.EditorContextShare,\n\tMenuId.SCMResourceContextShare,\n\tMenuId.OpenEditorsContextShare,\n\tMenuId.EditorTitleContextShare,\n\tMenuId.MenubarShare,\n\t// MenuId.EditorLineNumberContext, // todo@joyceerhl add share\n\tMenuId.ExplorerContextShare\n];\n\nclass ShareWorkbenchContribution {\n\tprivate static SHARE_ENABLED_SETTING = 'workbench.experimental.share.enabled';\n\n\tprivate _disposables: DisposableStore | undefined;\n\n\tconstructor(\n\t\t@IShareService private readonly shareService: IShareService,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService\n\t) {\n\t\tif (this.configurationService.getValue<boolean>(ShareWorkbenchContribution.SHARE_ENABLED_SETTING)) {\n\t\t\tthis.registerActions();\n\t\t}\n\t\tthis.configurationService.onDidChangeConfiguration(e => {\n\t\t\tif (e.affectsConfiguration(ShareWorkbenchContribution.SHARE_ENABLED_SETTING)) {\n\t\t\t\tconst settingValue = this.configurationService.getValue<boolean>(ShareWorkbenchContribution.SHARE_ENABLED_SETTING);\n\t\t\t\tif (settingValue === true && this._disposables === undefined) {\n\t\t\t\t\tthis.registerActions();\n\t\t\t\t} else if (settingValue === false && this._disposables !== undefined) {\n\t\t\t\t\tthis._disposables?.clear();\n\t\t\t\t\tthis._disposables = undefined;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate registerActions() {\n\t\tif (!this._disposables) {\n\t\t\tthis._disposables = new DisposableStore();\n\t\t}\n\n\t\tthis._disposables.add(\n\t\t\tregisterAction2(class ShareAction extends Action2 {\n\t\t\t\tstatic readonly ID = 'workbench.action.share';\n\t\t\t\tstatic readonly LABEL = localize2('share', 'Share...');\n\n\t\t\t\tconstructor() {\n\t\t\t\t\tsuper({\n\t\t\t\t\t\tid: ShareAction.ID,\n\t\t\t\t\t\ttitle: ShareAction.LABEL,\n\t\t\t\t\t\tf1: true,\n\t\t\t\t\t\ticon: Codicon.linkExternal,\n\t\t\t\t\t\tprecondition: ContextKeyExpr.and(ShareProviderCountContext.notEqualsTo(0), WorkspaceFolderCountContext.notEqualsTo(0)),\n\t\t\t\t\t\tkeybinding: {\n\t\t\t\t\t\t\tweight: KeybindingWeight.WorkbenchContrib,\n\t\t\t\t\t\t\tprimary: KeyMod.Alt | KeyMod.CtrlCmd | KeyCode.KeyS,\n\t\t\t\t\t\t},\n\t\t\t\t\t\tmenu: [\n\t\t\t\t\t\t\t{ id: MenuId.CommandCenter, order: 1000 }\n\t\t\t\t\t\t]\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\toverride async run(accessor: ServicesAccessor, ...args: any[]): Promise<void> {\n\t\t\t\t\tconst shareService = accessor.get(IShareService);\n\t\t\t\t\tconst activeEditor = accessor.get(IEditorService)?.activeEditor;\n\t\t\t\t\tconst resourceUri = (activeEditor && EditorResourceAccessor.getOriginalUri(activeEditor, { supportSideBySide: SideBySideEditor.PRIMARY }))\n\t\t\t\t\t\t?? accessor.get(IWorkspaceContextService).getWorkspace().folders[0].uri;\n\t\t\t\t\tconst clipboardService = accessor.get(IClipboardService);\n\t\t\t\t\tconst dialogService = accessor.get(IDialogService);\n\t\t\t\t\tconst urlService = accessor.get(IOpenerService);\n\t\t\t\t\tconst progressService = accessor.get(IProgressService);\n\t\t\t\t\tconst selection = accessor.get(ICodeEditorService).getActiveCodeEditor()?.getSelection() ?? undefined;\n\n\t\t\t\t\tconst result = await progressService.withProgress({\n\t\t\t\t\t\tlocation: ProgressLocation.Window,\n\t\t\t\t\t\tdetail: localize('generating link', 'Generating link...')\n\t\t\t\t\t}, async () => shareService.provideShare({ resourceUri, selection }, CancellationToken.None));\n\n\t\t\t\t\tif (result) {\n\t\t\t\t\t\tconst uriText = result.toString();\n\t\t\t\t\t\tconst isResultText = typeof result === 'string';\n\t\t\t\t\t\tawait clipboardService.writeText(uriText);\n\n\t\t\t\t\t\tdialogService.prompt(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttype: Severity.Info,\n\t\t\t\t\t\t\t\tmessage: isResultText ? localize('shareTextSuccess', 'Copied text to clipboard!') : localize('shareSuccess', 'Copied link to clipboard!'),\n\t\t\t\t\t\t\t\tcustom: {\n\t\t\t\t\t\t\t\t\ticon: Codicon.check,\n\t\t\t\t\t\t\t\t\tmarkdownDetails: [{\n\t\t\t\t\t\t\t\t\t\tmarkdown: new MarkdownString(`<div aria-label='${uriText}'>${uriText}</div>`, { supportHtml: true }),\n\t\t\t\t\t\t\t\t\t\tclasses: [isResultText ? 'share-dialog-input-text' : 'share-dialog-input-link']\n\t\t\t\t\t\t\t\t\t}]\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tcancelButton: localize('close', 'Close'),\n\t\t\t\t\t\t\t\tbuttons: isResultText ? [] : [{ label: localize('open link', 'Open Link'), run: () => { urlService.open(result, { openExternal: true }); } }]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t);\n\n\t\tconst actions = this.shareService.getShareActions();\n\t\tfor (const menuId of targetMenus) {\n\t\t\tfor (const action of actions) {\n\t\t\t\t// todo@joyceerhl avoid duplicates\n\t\t\t\tthis._disposables.add(MenuRegistry.appendMenuItem(menuId, action));\n\t\t\t}\n\t\t}\n\t}\n}\n\nregisterSingleton(IShareService, ShareService, InstantiationType.Delayed);\nconst workbenchContributionsRegistry = Registry.as<IWorkbenchContributionsRegistry>(Extensions.Workbench);\nworkbenchContributionsRegistry.registerWorkbenchContribution(ShareWorkbenchContribution, LifecyclePhase.Eventually);\n\nRegistry.as<IConfigurationRegistry>(ConfigurationExtensions.Configuration).registerConfiguration({\n\t...workbenchConfigurationNodeBase,\n\tproperties: {\n\t\t'workbench.experimental.share.enabled': {\n\t\t\ttype: 'boolean',\n\t\t\tdefault: false,\n\t\t\ttags: ['experimental'],\n\t\t\tmarkdownDescription: localize('experimental.share.enabled', \"Controls whether to render the Share action next to the command center when {0} is {1}.\", '`#window.commandCenter#`', '`true`'),\n\t\t\trestricted: false,\n\t\t}\n\t}\n});\n"],
  "mappings": "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",
  "names": []
}
