var m=Object.defineProperty;var h=Object.getOwnPropertyDescriptor;var p=(c,e,i,t)=>{for(var r=t>1?void 0:t?h(e,i):e,a=c.length-1,o;a>=0;a--)(o=c[a])&&(r=(t?o(e,i,r):o(r))||r);return t&&r&&m(e,i,r),r},s=(c,e)=>(i,t)=>e(i,t,c);import{ICodeEditorService as u}from"../../../../editor/browser/services/codeEditorService.js";import{score as I}from"../../../../editor/common/languageSelector.js";import{localize as v}from"../../../../nls.js";import{IContextKeyService as S,RawContextKey as y}from"../../../../platform/contextkey/common/contextkey.js";import{ILabelService as f}from"../../../../platform/label/common/label.js";import{IQuickInputService as b}from"../../../../platform/quickinput/common/quickInput.js";import{ITelemetryService as C}from"../../../../platform/telemetry/common/telemetry.js";const g=new y("shareProviderCount",0,v("shareProviderCount","The number of available share providers"));let d=class{constructor(e,i,t,r,a){this.contextKeyService=e;this.labelService=i;this.quickInputService=t;this.codeEditorService=r;this.telemetryService=a;this.providerCount=g.bindTo(this.contextKeyService)}_serviceBrand;providerCount;_providers=new Set;registerShareProvider(e){return this._providers.add(e),this.providerCount.set(this._providers.size),{dispose:()=>{this._providers.delete(e),this.providerCount.set(this._providers.size)}}}getShareActions(){return[]}async provideShare(e,i){const t=this.codeEditorService.getActiveCodeEditor()?.getModel()?.getLanguageId()??"",r=[...this._providers.values()].filter(n=>I(n.selector,e.resourceUri,t,!0,void 0,void 0)>0).sort((n,l)=>n.priority-l.priority);if(r.length===0)return;if(r.length===1)return this.telemetryService.publicLog2("shareService.share",{providerId:r[0].id}),r[0].provideShare(e,i);const a=r.map(n=>({label:n.label,provider:n})),o=await this.quickInputService.pick(a,{canPickMany:!1,placeHolder:v("type to filter","Choose how to share {0}",this.labelService.getUriLabel(e.resourceUri))},i);if(o!==void 0)return this.telemetryService.publicLog2("shareService.share",{providerId:o.provider.id}),o.provider.provideShare(e,i)}};d=p([s(0,S),s(1,f),s(2,b),s(3,u),s(4,C)],d);export{g as ShareProviderCountContext,d as ShareService};
