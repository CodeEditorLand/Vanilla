var CB=Object.defineProperty;var SB=Object.getOwnPropertyDescriptor;var R=(o,e,t,n)=>{for(var i=n>1?void 0:n?SB(e,t):e,r=o.length-1,s;r>=0;r--)(s=o[r])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&CB(e,t,i),i},S=(o,e)=>(t,n)=>e(t,n,o);function Ww(){return globalThis._VSCODE_NLS_MESSAGES}function fp(){return globalThis._VSCODE_NLS_LANGUAGE}var wB=fp()==="pseudo"||typeof document<"u"&&document.location&&document.location.hash.indexOf("pseudo=true")>=0;function yf(o,e){let t;return e.length===0?t=o:t=o.replace(/\{(\d+)\}/g,(n,i)=>{let r=i[0],s=e[r],a=n;return typeof s=="string"?a=s:(typeof s=="number"||typeof s=="boolean"||s===void 0||s===null)&&(a=String(s)),a}),wB&&(t="\uFF3B"+t.replace(/[aouei]/g,"$&$&")+"\uFF3D"),t}function p(o,e,...t){return yf(typeof o=="number"?p1(o,e):e,t)}function p1(o,e){let t=Ww()?.[o];if(typeof t!="string"){if(typeof e=="string")return e;throw new Error(`!!! NLS MISSING: ${o} !!!`)}return t}function Xl(o,e,...t){let n;typeof o=="number"?n=p1(o,e):n=e;let i=yf(n,t);return{value:i,original:e===n?i:yf(e,t)}}function If(o,e){let t=o;typeof t.vscodeWindowId!="number"&&Object.defineProperty(t,"vscodeWindowId",{get:()=>e})}var De=window;function Hw(o){return o===De?!1:typeof o?.vscodeWindowId=="number"}function m1(o,e){let t=xB(o,e);if(t!==-1)return o[t]}function xB(o,e,t=o.length-1){for(let n=t;n>=0;n--){let i=o[n];if(e(i))return n}return-1}function Uw(o,e){let t=bp(o,e);return t===-1?void 0:o[t]}function bp(o,e,t=0,n=o.length){let i=t,r=n;for(;i<r;){let s=Math.floor((i+r)/2);e(o[s])?i=s+1:r=s}return i-1}function Cf(o,e,t=0,n=o.length){let i=t,r=n;for(;i<r;){let s=Math.floor((i+r)/2);e(o[s])?r=s:i=s+1}return i}function EB(o,e){if(o.length===0)return;let t=o[0];for(let n=1;n<o.length;n++){let i=o[n];e(i,t)>0&&(t=i)}return t}function g1(o,e){if(o.length===0)return;let t=o[0];for(let n=1;n<o.length;n++){let i=o[n];e(i,t)>=0&&(t=i)}return t}function f1(o,e){return EB(o,(t,n)=>-e(t,n))}var zw=class{unexpectedErrorHandler;listeners;constructor(){this.listeners=[],this.unexpectedErrorHandler=function(e){setTimeout(()=>{throw e.stack?Ys.isErrorNoTelemetry(e)?new Ys(e.message+`

`+e.stack):new Error(e.message+`

`+e.stack):e},0)}}addListener(e){return this.listeners.push(e),()=>{this._removeListener(e)}}emit(e){this.listeners.forEach(t=>{t(e)})}_removeListener(e){this.listeners.splice(this.listeners.indexOf(e),1)}setUnexpectedErrorHandler(e){this.unexpectedErrorHandler=e}getUnexpectedErrorHandler(){return this.unexpectedErrorHandler}onUnexpectedError(e){this.unexpectedErrorHandler(e),this.emit(e)}onUnexpectedExternalError(e){this.unexpectedErrorHandler(e)}},b1=new zw;function Ac(o){b1.onUnexpectedError(o)}function je(o){v1(o)||b1.onUnexpectedError(o)}var Kw="Canceled";function v1(o){return o instanceof $i?!0:o instanceof Error&&o.name===Kw&&o.message===Kw}var $i=class extends Error{constructor(){super(Kw),this.name=this.message}};function Ql(o){return o?new Error(`Illegal argument: ${o}`):new Error("Illegal argument")}function y1(o){return o?new Error(`Illegal state: ${o}`):new Error("Illegal state")}var Sf=class extends Error{constructor(e){super("NotSupported"),e&&(this.message=e)}};var Ys=class o extends Error{name;constructor(e){super(e),this.name="CodeExpectedError"}static fromError(e){if(e instanceof o)return e;let t=new o;return t.message=e.message,t.stack=e.stack,t}static isErrorNoTelemetry(e){return e.name==="CodeExpectedError"}},Qe=class o extends Error{constructor(e){super(e||"An unexpected bug occurred."),Object.setPrototypeOf(this,o.prototype)}};function Yi(o,e=0){return o[o.length-(1+e)]}function on(o,e,t=(n,i)=>n===i){if(o===e)return!0;if(!o||!e||o.length!==e.length)return!1;for(let n=0,i=o.length;n<i;n++)if(!t(o[n],e[n]))return!1;return!0}function I1(o,e){let t=o.length-1;e<t&&(o[e]=o[t]),o.pop()}function C1(o,e,t){return TB(o.length,n=>t(o[n],e))}function TB(o,e){let t=0,n=o-1;for(;t<=n;){let i=(t+n)/2|0,r=e(i);if(r<0)t=i+1;else if(r>0)n=i-1;else return i}return-(t+1)}function fr(o){return o.filter(e=>!!e)}function Gw(o){let e=0;for(let t=0;t<o.length;t++)o[t]&&(o[e]=o[t],e+=1);o.length=e}function Xs(o,e=t=>t){let t=new Set;return o.filter(n=>{let i=e(n);return t.has(i)?!1:(t.add(i),!0)})}function vp(o,e){let t=typeof e=="number"?o:0;typeof e=="number"?t=o:(t=0,e=o);let n=[];if(t<=e)for(let i=t;i<e;i++)n.push(i);else for(let i=t;i>e;i--)n.push(i);return n}function wf(o,e){return o.push(e),()=>LB(o,e)}function LB(o,e){let t=o.indexOf(e);if(t>-1)return o.splice(t,1),e}function ns(o,e,t){let n=o.slice(0,e),i=o.slice(e);return n.concat(t,i)}function jw(o,e){for(let t of e)o.push(t)}var S1;(a=>{function o(l){return l<0}a.isLessThan=o;function e(l){return l<=0}a.isLessThanOrEqual=e;function t(l){return l>0}a.isGreaterThan=t;function n(l){return l===0}a.isNeitherLessOrGreaterThan=n,a.greaterThan=1,a.lessThan=-1,a.neitherLessOrGreaterThan=0})(S1||={});function Jl(o,e){return(t,n)=>e(o(t),o(n))}var qi=class{constructor(e){this.items=e}firstIdx=0;lastIdx=this.items.length-1;get length(){return this.lastIdx-this.firstIdx+1}takeWhile(e){let t=this.firstIdx;for(;t<this.items.length&&e(this.items[t]);)t++;let n=t===this.firstIdx?null:this.items.slice(this.firstIdx,t);return this.firstIdx=t,n}takeFromEndWhile(e){let t=this.lastIdx;for(;t>=0&&e(this.items[t]);)t--;let n=t===this.lastIdx?null:this.items.slice(t+1,this.lastIdx+1);return this.lastIdx=t,n}peek(){if(this.length!==0)return this.items[this.firstIdx]}peekLast(){if(this.length!==0)return this.items[this.lastIdx]}dequeue(){let e=this.items[this.firstIdx];return this.firstIdx++,e}removeLast(){let e=this.items[this.lastIdx];return this.lastIdx--,e}takeCount(e){let t=this.items.slice(this.firstIdx,this.firstIdx+e);return this.firstIdx+=e,t}},Zs=class o{constructor(e){this.iterate=e}static empty=new o(e=>{});forEach(e){this.iterate(t=>(e(t),!0))}toArray(){let e=[];return this.iterate(t=>(e.push(t),!0)),e}filter(e){return new o(t=>this.iterate(n=>e(n)?t(n):!0))}map(e){return new o(t=>this.iterate(n=>t(e(n))))}some(e){let t=!1;return this.iterate(n=>(t=e(n),!t)),t}findFirst(e){let t;return this.iterate(n=>e(n)?(t=n,!1):!0),t}findLast(e){let t;return this.iterate(n=>(e(n)&&(t=n),!0)),t}findLastMaxBy(e){let t,n=!0;return this.iterate(i=>((n||S1.isGreaterThan(e(i,t)))&&(n=!1,t=i),!0)),t}};function w1(o,e){let t=new Set;for(let n of e)o.has(n)&&t.add(n);return t}var Oc="en",Cp=!1,Sp=!1,Ip=!1,DB=!1,T1=!1,qw=!1,kB=!1,Yw=!1,RB=!1,L1=!1,yp,xf=Oc,x1=Oc,MB,Qs,Js=globalThis,Oo;typeof Js.vscode<"u"&&typeof Js.vscode.process<"u"?Oo=Js.vscode.process:typeof process<"u"&&typeof process?.versions?.node=="string"&&(Oo=process);var D1=typeof Oo?.versions?.electron=="string",AB=D1&&Oo?.type==="renderer";if(typeof Oo=="object"){Cp=Oo.platform==="win32",Sp=Oo.platform==="darwin",Ip=Oo.platform==="linux",DB=Ip&&!!Oo.env.SNAP&&!!Oo.env.SNAP_REVISION,kB=D1,RB=!!Oo.env.CI||!!Oo.env.BUILD_ARTIFACTSTAGINGDIRECTORY,yp=Oc,xf=Oc;let o=Oo.env.VSCODE_NLS_CONFIG;if(o)try{let e=JSON.parse(o);yp=e.userLocale,x1=e.osLocale,xf=e.resolvedLanguage||Oc,MB=e.languagePack?.translationsConfigFile}catch{}T1=!0}else typeof navigator=="object"&&!AB?(Qs=navigator.userAgent,Cp=Qs.indexOf("Windows")>=0,Sp=Qs.indexOf("Macintosh")>=0,Yw=(Qs.indexOf("Macintosh")>=0||Qs.indexOf("iPad")>=0||Qs.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,Ip=Qs.indexOf("Linux")>=0,L1=Qs?.indexOf("Mobi")>=0,qw=!0,xf=fp()||Oc,yp=navigator.language.toLowerCase(),x1=yp):console.error("Unable to resolve platform.");var $w=0;Sp?$w=1:Cp?$w=3:Ip&&($w=2);var mt=Cp,Be=Sp,Wt=Ip;var rs=T1;var Zi=qw,OB=qw&&typeof Js.importScripts=="function",k1=OB?Js.origin:void 0,Va=Yw,R1=L1;var os=Qs,is=xf,NB;(n=>{function o(){return is}n.value=o;function e(){return is.length===2?is==="en":is.length>=3?is[0]==="e"&&is[1]==="n"&&is[2]==="-":!1}n.isDefaultVariant=e;function t(){return is==="en"}n.isDefault=t})(NB||={});var M1=yp;var PB=typeof Js.postMessage=="function"&&!Js.importScripts,Ef=(()=>{if(PB){let o=[];Js.addEventListener("message",t=>{if(t.data&&t.data.vscodeScheduleAsyncWork)for(let n=0,i=o.length;n<i;n++){let r=o[n];if(r.id===t.data.vscodeScheduleAsyncWork){o.splice(n,1),r.callback();return}}});let e=0;return t=>{let n=++e;o.push({id:n,callback:t}),Js.postMessage({vscodeScheduleAsyncWork:n},"*")}}return o=>setTimeout(o)})();var Zo=Sp||Yw?2:Cp?1:3,E1=!0,_1=!1;function A1(){if(!_1){_1=!0;let o=new Uint8Array(2);o[0]=1,o[1]=2,E1=new Uint16Array(o.buffer)[0]===513}return E1}var Zw=!!(os&&os.indexOf("Chrome")>=0),_f=!!(os&&os.indexOf("Firefox")>=0),O1=!!(!Zw&&os&&os.indexOf("Safari")>=0),N1=!!(os&&os.indexOf("Edg/")>=0),P1=!!(os&&os.indexOf("Android")>=0);var ed,Xw=globalThis.vscode;if(typeof Xw<"u"&&typeof Xw.process<"u"){let o=Xw.process;ed={get platform(){return o.platform},get arch(){return o.arch},get env(){return o.env},cwd(){return o.cwd()}}}else typeof process<"u"&&typeof process?.versions?.node=="string"?ed={get platform(){return process.platform},get arch(){return process.arch},get env(){return process.env},cwd(){return process.env.VSCODE_CWD||process.cwd()}}:ed={get platform(){return mt?"win32":Be?"darwin":"linux"},get arch(){},get env(){return{}},cwd(){return"/"}};var wp=ed.cwd,Wa=ed.env,F1=ed.platform,_7=ed.arch;var BB=65,VB=97,WB=90,HB=122,za=46,ci=47,mo=92,Ha=58,UB=63,Tf=class extends Error{code;constructor(e,t,n){let i;typeof t=="string"&&t.indexOf("not ")===0?(i="must not be",t=t.replace(/^not /,"")):i="must be";let r=e.indexOf(".")!==-1?"property":"argument",s=`The "${e}" ${r} ${i} of type ${t}`;s+=`. Received type ${typeof n}`,super(s),this.code="ERR_INVALID_ARG_TYPE"}};function zB(o,e){if(o===null||typeof o!="object")throw new Tf(e,"Object",o)}function vn(o,e){if(typeof o!="string")throw new Tf(e,"string",o)}var go=F1==="win32";function dt(o){return o===ci||o===mo}function Qw(o){return o===ci}function Ua(o){return o>=BB&&o<=WB||o>=VB&&o<=HB}function Lf(o,e,t,n){let i="",r=0,s=-1,a=0,l=0;for(let d=0;d<=o.length;++d){if(d<o.length)l=o.charCodeAt(d);else{if(n(l))break;l=ci}if(n(l)){if(!(s===d-1||a===1))if(a===2){if(i.length<2||r!==2||i.charCodeAt(i.length-1)!==za||i.charCodeAt(i.length-2)!==za){if(i.length>2){let c=i.lastIndexOf(t);c===-1?(i="",r=0):(i=i.slice(0,c),r=i.length-1-i.lastIndexOf(t)),s=d,a=0;continue}else if(i.length!==0){i="",r=0,s=d,a=0;continue}}e&&(i+=i.length>0?`${t}..`:"..",r=2)}else i.length>0?i+=`${t}${o.slice(s+1,d)}`:i=o.slice(s+1,d),r=d-s-1;s=d,a=0}else l===za&&a!==-1?++a:a=-1}return i}function KB(o){return o?`${o[0]==="."?"":"."}${o}`:""}function B1(o,e){zB(e,"pathObject");let t=e.dir||e.root,n=e.base||`${e.name||""}${KB(e.ext)}`;return t?t===e.root?`${t}${n}`:`${t}${o}${n}`:n}var en={resolve(...o){let e="",t="",n=!1;for(let i=o.length-1;i>=-1;i--){let r;if(i>=0){if(r=o[i],vn(r,`paths[${i}]`),r.length===0)continue}else e.length===0?r=wp():(r=Wa[`=${e}`]||wp(),(r===void 0||r.slice(0,2).toLowerCase()!==e.toLowerCase()&&r.charCodeAt(2)===mo)&&(r=`${e}\\`));let s=r.length,a=0,l="",d=!1,c=r.charCodeAt(0);if(s===1)dt(c)&&(a=1,d=!0);else if(dt(c))if(d=!0,dt(r.charCodeAt(1))){let u=2,h=u;for(;u<s&&!dt(r.charCodeAt(u));)u++;if(u<s&&u!==h){let m=r.slice(h,u);for(h=u;u<s&&dt(r.charCodeAt(u));)u++;if(u<s&&u!==h){for(h=u;u<s&&!dt(r.charCodeAt(u));)u++;(u===s||u!==h)&&(l=`\\\\${m}\\${r.slice(h,u)}`,a=u)}}}else a=1;else Ua(c)&&r.charCodeAt(1)===Ha&&(l=r.slice(0,2),a=2,s>2&&dt(r.charCodeAt(2))&&(d=!0,a=3));if(l.length>0)if(e.length>0){if(l.toLowerCase()!==e.toLowerCase())continue}else e=l;if(n){if(e.length>0)break}else if(t=`${r.slice(a)}\\${t}`,n=d,d&&e.length>0)break}return t=Lf(t,!n,"\\",dt),n?`${e}\\${t}`:`${e}${t}`||"."},normalize(o){vn(o,"path");let e=o.length;if(e===0)return".";let t=0,n,i=!1,r=o.charCodeAt(0);if(e===1)return Qw(r)?"\\":o;if(dt(r))if(i=!0,dt(o.charCodeAt(1))){let a=2,l=a;for(;a<e&&!dt(o.charCodeAt(a));)a++;if(a<e&&a!==l){let d=o.slice(l,a);for(l=a;a<e&&dt(o.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&!dt(o.charCodeAt(a));)a++;if(a===e)return`\\\\${d}\\${o.slice(l)}\\`;a!==l&&(n=`\\\\${d}\\${o.slice(l,a)}`,t=a)}}}else t=1;else Ua(r)&&o.charCodeAt(1)===Ha&&(n=o.slice(0,2),t=2,e>2&&dt(o.charCodeAt(2))&&(i=!0,t=3));let s=t<e?Lf(o.slice(t),!i,"\\",dt):"";return s.length===0&&!i&&(s="."),s.length>0&&dt(o.charCodeAt(e-1))&&(s+="\\"),n===void 0?i?`\\${s}`:s:i?`${n}\\${s}`:`${n}${s}`},isAbsolute(o){vn(o,"path");let e=o.length;if(e===0)return!1;let t=o.charCodeAt(0);return dt(t)||e>2&&Ua(t)&&o.charCodeAt(1)===Ha&&dt(o.charCodeAt(2))},join(...o){if(o.length===0)return".";let e,t;for(let r=0;r<o.length;++r){let s=o[r];vn(s,"path"),s.length>0&&(e===void 0?e=t=s:e+=`\\${s}`)}if(e===void 0)return".";let n=!0,i=0;if(typeof t=="string"&&dt(t.charCodeAt(0))){++i;let r=t.length;r>1&&dt(t.charCodeAt(1))&&(++i,r>2&&(dt(t.charCodeAt(2))?++i:n=!1))}if(n){for(;i<e.length&&dt(e.charCodeAt(i));)i++;i>=2&&(e=`\\${e.slice(i)}`)}return en.normalize(e)},relative(o,e){if(vn(o,"from"),vn(e,"to"),o===e)return"";let t=en.resolve(o),n=en.resolve(e);if(t===n||(o=t.toLowerCase(),e=n.toLowerCase(),o===e))return"";let i=0;for(;i<o.length&&o.charCodeAt(i)===mo;)i++;let r=o.length;for(;r-1>i&&o.charCodeAt(r-1)===mo;)r--;let s=r-i,a=0;for(;a<e.length&&e.charCodeAt(a)===mo;)a++;let l=e.length;for(;l-1>a&&e.charCodeAt(l-1)===mo;)l--;let d=l-a,c=s<d?s:d,u=-1,h=0;for(;h<c;h++){let f=o.charCodeAt(i+h);if(f!==e.charCodeAt(a+h))break;f===mo&&(u=h)}if(h!==c){if(u===-1)return n}else{if(d>c){if(e.charCodeAt(a+h)===mo)return n.slice(a+h+1);if(h===2)return n.slice(a+h)}s>c&&(o.charCodeAt(i+h)===mo?u=h:h===2&&(u=3)),u===-1&&(u=0)}let m="";for(h=i+u+1;h<=r;++h)(h===r||o.charCodeAt(h)===mo)&&(m+=m.length===0?"..":"\\..");return a+=u,m.length>0?`${m}${n.slice(a,l)}`:(n.charCodeAt(a)===mo&&++a,n.slice(a,l))},toNamespacedPath(o){if(typeof o!="string"||o.length===0)return o;let e=en.resolve(o);if(e.length<=2)return o;if(e.charCodeAt(0)===mo){if(e.charCodeAt(1)===mo){let t=e.charCodeAt(2);if(t!==UB&&t!==za)return`\\\\?\\UNC\\${e.slice(2)}`}}else if(Ua(e.charCodeAt(0))&&e.charCodeAt(1)===Ha&&e.charCodeAt(2)===mo)return`\\\\?\\${e}`;return o},dirname(o){vn(o,"path");let e=o.length;if(e===0)return".";let t=-1,n=0,i=o.charCodeAt(0);if(e===1)return dt(i)?o:".";if(dt(i)){if(t=n=1,dt(o.charCodeAt(1))){let a=2,l=a;for(;a<e&&!dt(o.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&dt(o.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&!dt(o.charCodeAt(a));)a++;if(a===e)return o;a!==l&&(t=n=a+1)}}}}else Ua(i)&&o.charCodeAt(1)===Ha&&(t=e>2&&dt(o.charCodeAt(2))?3:2,n=t);let r=-1,s=!0;for(let a=e-1;a>=n;--a)if(dt(o.charCodeAt(a))){if(!s){r=a;break}}else s=!1;if(r===-1){if(t===-1)return".";r=t}return o.slice(0,r)},basename(o,e){e!==void 0&&vn(e,"suffix"),vn(o,"path");let t=0,n=-1,i=!0,r;if(o.length>=2&&Ua(o.charCodeAt(0))&&o.charCodeAt(1)===Ha&&(t=2),e!==void 0&&e.length>0&&e.length<=o.length){if(e===o)return"";let s=e.length-1,a=-1;for(r=o.length-1;r>=t;--r){let l=o.charCodeAt(r);if(dt(l)){if(!i){t=r+1;break}}else a===-1&&(i=!1,a=r+1),s>=0&&(l===e.charCodeAt(s)?--s===-1&&(n=r):(s=-1,n=a))}return t===n?n=a:n===-1&&(n=o.length),o.slice(t,n)}for(r=o.length-1;r>=t;--r)if(dt(o.charCodeAt(r))){if(!i){t=r+1;break}}else n===-1&&(i=!1,n=r+1);return n===-1?"":o.slice(t,n)},extname(o){vn(o,"path");let e=0,t=-1,n=0,i=-1,r=!0,s=0;o.length>=2&&o.charCodeAt(1)===Ha&&Ua(o.charCodeAt(0))&&(e=n=2);for(let a=o.length-1;a>=e;--a){let l=o.charCodeAt(a);if(dt(l)){if(!r){n=a+1;break}continue}i===-1&&(r=!1,i=a+1),l===za?t===-1?t=a:s!==1&&(s=1):t!==-1&&(s=-1)}return t===-1||i===-1||s===0||s===1&&t===i-1&&t===n+1?"":o.slice(t,i)},format:B1.bind(null,"\\"),parse(o){vn(o,"path");let e={root:"",dir:"",base:"",ext:"",name:""};if(o.length===0)return e;let t=o.length,n=0,i=o.charCodeAt(0);if(t===1)return dt(i)?(e.root=e.dir=o,e):(e.base=e.name=o,e);if(dt(i)){if(n=1,dt(o.charCodeAt(1))){let u=2,h=u;for(;u<t&&!dt(o.charCodeAt(u));)u++;if(u<t&&u!==h){for(h=u;u<t&&dt(o.charCodeAt(u));)u++;if(u<t&&u!==h){for(h=u;u<t&&!dt(o.charCodeAt(u));)u++;u===t?n=u:u!==h&&(n=u+1)}}}}else if(Ua(i)&&o.charCodeAt(1)===Ha){if(t<=2)return e.root=e.dir=o,e;if(n=2,dt(o.charCodeAt(2))){if(t===3)return e.root=e.dir=o,e;n=3}}n>0&&(e.root=o.slice(0,n));let r=-1,s=n,a=-1,l=!0,d=o.length-1,c=0;for(;d>=n;--d){if(i=o.charCodeAt(d),dt(i)){if(!l){s=d+1;break}continue}a===-1&&(l=!1,a=d+1),i===za?r===-1?r=d:c!==1&&(c=1):r!==-1&&(c=-1)}return a!==-1&&(r===-1||c===0||c===1&&r===a-1&&r===s+1?e.base=e.name=o.slice(s,a):(e.name=o.slice(s,r),e.base=o.slice(s,a),e.ext=o.slice(r,a))),s>0&&s!==n?e.dir=o.slice(0,s-1):e.dir=e.root,e},sep:"\\",delimiter:";",win32:null,posix:null},GB=(()=>{if(go){let o=/\\/g;return()=>{let e=wp().replace(o,"/");return e.slice(e.indexOf("/"))}}return()=>wp()})(),ot={resolve(...o){let e="",t=!1;for(let n=o.length-1;n>=-1&&!t;n--){let i=n>=0?o[n]:GB();vn(i,`paths[${n}]`),i.length!==0&&(e=`${i}/${e}`,t=i.charCodeAt(0)===ci)}return e=Lf(e,!t,"/",Qw),t?`/${e}`:e.length>0?e:"."},normalize(o){if(vn(o,"path"),o.length===0)return".";let e=o.charCodeAt(0)===ci,t=o.charCodeAt(o.length-1)===ci;return o=Lf(o,!e,"/",Qw),o.length===0?e?"/":t?"./":".":(t&&(o+="/"),e?`/${o}`:o)},isAbsolute(o){return vn(o,"path"),o.length>0&&o.charCodeAt(0)===ci},join(...o){if(o.length===0)return".";let e;for(let t=0;t<o.length;++t){let n=o[t];vn(n,"path"),n.length>0&&(e===void 0?e=n:e+=`/${n}`)}return e===void 0?".":ot.normalize(e)},relative(o,e){if(vn(o,"from"),vn(e,"to"),o===e||(o=ot.resolve(o),e=ot.resolve(e),o===e))return"";let t=1,n=o.length,i=n-t,r=1,s=e.length-r,a=i<s?i:s,l=-1,d=0;for(;d<a;d++){let u=o.charCodeAt(t+d);if(u!==e.charCodeAt(r+d))break;u===ci&&(l=d)}if(d===a)if(s>a){if(e.charCodeAt(r+d)===ci)return e.slice(r+d+1);if(d===0)return e.slice(r+d)}else i>a&&(o.charCodeAt(t+d)===ci?l=d:d===0&&(l=0));let c="";for(d=t+l+1;d<=n;++d)(d===n||o.charCodeAt(d)===ci)&&(c+=c.length===0?"..":"/..");return`${c}${e.slice(r+l)}`},toNamespacedPath(o){return o},dirname(o){if(vn(o,"path"),o.length===0)return".";let e=o.charCodeAt(0)===ci,t=-1,n=!0;for(let i=o.length-1;i>=1;--i)if(o.charCodeAt(i)===ci){if(!n){t=i;break}}else n=!1;return t===-1?e?"/":".":e&&t===1?"//":o.slice(0,t)},basename(o,e){e!==void 0&&vn(e,"ext"),vn(o,"path");let t=0,n=-1,i=!0,r;if(e!==void 0&&e.length>0&&e.length<=o.length){if(e===o)return"";let s=e.length-1,a=-1;for(r=o.length-1;r>=0;--r){let l=o.charCodeAt(r);if(l===ci){if(!i){t=r+1;break}}else a===-1&&(i=!1,a=r+1),s>=0&&(l===e.charCodeAt(s)?--s===-1&&(n=r):(s=-1,n=a))}return t===n?n=a:n===-1&&(n=o.length),o.slice(t,n)}for(r=o.length-1;r>=0;--r)if(o.charCodeAt(r)===ci){if(!i){t=r+1;break}}else n===-1&&(i=!1,n=r+1);return n===-1?"":o.slice(t,n)},extname(o){vn(o,"path");let e=-1,t=0,n=-1,i=!0,r=0;for(let s=o.length-1;s>=0;--s){let a=o.charCodeAt(s);if(a===ci){if(!i){t=s+1;break}continue}n===-1&&(i=!1,n=s+1),a===za?e===-1?e=s:r!==1&&(r=1):e!==-1&&(r=-1)}return e===-1||n===-1||r===0||r===1&&e===n-1&&e===t+1?"":o.slice(e,n)},format:B1.bind(null,"/"),parse(o){vn(o,"path");let e={root:"",dir:"",base:"",ext:"",name:""};if(o.length===0)return e;let t=o.charCodeAt(0)===ci,n;t?(e.root="/",n=1):n=0;let i=-1,r=0,s=-1,a=!0,l=o.length-1,d=0;for(;l>=n;--l){let c=o.charCodeAt(l);if(c===ci){if(!a){r=l+1;break}continue}s===-1&&(a=!1,s=l+1),c===za?i===-1?i=l:d!==1&&(d=1):i!==-1&&(d=-1)}if(s!==-1){let c=r===0&&t?1:r;i===-1||d===0||d===1&&i===s-1&&i===r+1?e.base=e.name=o.slice(c,s):(e.name=o.slice(c,i),e.base=o.slice(c,s),e.ext=o.slice(i,s))}return r>0?e.dir=o.slice(0,r-1):t&&(e.dir="/"),e},sep:"/",delimiter:":",win32:null,posix:null};ot.win32=en.win32=en;ot.posix=en.posix=ot;var Ka=go?en.normalize:ot.normalize,xp=go?en.isAbsolute:ot.isAbsolute,No=go?en.join:ot.join,Nc=go?en.resolve:ot.resolve,V1=go?en.relative:ot.relative,Pc=go?en.dirname:ot.dirname,Jw=go?en.basename:ot.basename,Df=go?en.extname:ot.extname,T7=go?en.format:ot.format,W1=go?en.parse:ot.parse,L7=go?en.toNamespacedPath:ot.toNamespacedPath,Po=go?en.sep:ot.sep,D7=go?en.delimiter:ot.delimiter;var $B=/^\w[\w\d+.-]*$/,qB=/^\//,YB=/^\/\//;function ZB(o,e){if(!o.scheme&&e)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${o.authority}", path: "${o.path}", query: "${o.query}", fragment: "${o.fragment}"}`);if(o.scheme&&!$B.test(o.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(o.path){if(o.authority){if(!qB.test(o.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(YB.test(o.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}function XB(o,e){return!o&&!e?"file":o}function QB(o,e){switch(o){case"https":case"http":case"file":e?e[0]!==br&&(e=br+e):e=br;break}return e}var $t="",br="/",JB=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/,ie=class o{static isUri(e){return e instanceof o?!0:e?typeof e.authority=="string"&&typeof e.fragment=="string"&&typeof e.path=="string"&&typeof e.query=="string"&&typeof e.scheme=="string"&&typeof e.fsPath=="string"&&typeof e.with=="function"&&typeof e.toString=="function":!1}scheme;authority;path;query;fragment;constructor(e,t,n,i,r,s=!1){typeof e=="object"?(this.scheme=e.scheme||$t,this.authority=e.authority||$t,this.path=e.path||$t,this.query=e.query||$t,this.fragment=e.fragment||$t):(this.scheme=XB(e,s),this.authority=t||$t,this.path=QB(this.scheme,n||$t),this.query=i||$t,this.fragment=r||$t,ZB(this,s))}get fsPath(){return Ep(this,!1)}with(e){if(!e)return this;let{scheme:t,authority:n,path:i,query:r,fragment:s}=e;return t===void 0?t=this.scheme:t===null&&(t=$t),n===void 0?n=this.authority:n===null&&(n=$t),i===void 0?i=this.path:i===null&&(i=$t),r===void 0?r=this.query:r===null&&(r=$t),s===void 0?s=this.fragment:s===null&&(s=$t),t===this.scheme&&n===this.authority&&i===this.path&&r===this.query&&s===this.fragment?this:new Ga(t,n,i,r,s)}static parse(e,t=!1){let n=JB.exec(e);return n?new Ga(n[2]||$t,kf(n[4]||$t),kf(n[5]||$t),kf(n[7]||$t),kf(n[9]||$t),t):new Ga($t,$t,$t,$t,$t)}static file(e){let t=$t;if(mt&&(e=e.replace(/\\/g,br)),e[0]===br&&e[1]===br){let n=e.indexOf(br,2);n===-1?(t=e.substring(2),e=br):(t=e.substring(2,n),e=e.substring(n)||br)}return new Ga("file",t,e,$t,$t)}static from(e,t){return new Ga(e.scheme,e.authority,e.path,e.query,e.fragment,t)}static joinPath(e,...t){if(!e.path)throw new Error("[UriError]: cannot call joinPath on URI without path");let n;return mt&&e.scheme==="file"?n=o.file(en.join(Ep(e,!0),...t)).path:n=ot.join(e.path,...t),e.with({path:n})}toString(e=!1){return tx(this,e)}toJSON(){return this}static revive(e){if(e){if(e instanceof o)return e;{let t=new Ga(e);return t._formatted=e.external??null,t._fsPath=e._sep===z1?e.fsPath??null:null,t}}else return e}[Symbol.for("debug.description")](){return`URI(${this.toString()})`}};var z1=mt?1:void 0,Ga=class extends ie{_formatted=null;_fsPath=null;get fsPath(){return this._fsPath||(this._fsPath=Ep(this,!1)),this._fsPath}toString(e=!1){return e?tx(this,!0):(this._formatted||(this._formatted=tx(this,!1)),this._formatted)}toJSON(){let e={$mid:1};return this._fsPath&&(e.fsPath=this._fsPath,e._sep=z1),this._formatted&&(e.external=this._formatted),this.path&&(e.path=this.path),this.scheme&&(e.scheme=this.scheme),this.authority&&(e.authority=this.authority),this.query&&(e.query=this.query),this.fragment&&(e.fragment=this.fragment),e}},K1={58:"%3A",47:"%2F",63:"%3F",35:"%23",91:"%5B",93:"%5D",64:"%40",33:"%21",36:"%24",38:"%26",39:"%27",40:"%28",41:"%29",42:"%2A",43:"%2B",44:"%2C",59:"%3B",61:"%3D",32:"%20"};function H1(o,e,t){let n,i=-1;for(let r=0;r<o.length;r++){let s=o.charCodeAt(r);if(s>=97&&s<=122||s>=65&&s<=90||s>=48&&s<=57||s===45||s===46||s===95||s===126||e&&s===47||t&&s===91||t&&s===93||t&&s===58)i!==-1&&(n+=encodeURIComponent(o.substring(i,r)),i=-1),n!==void 0&&(n+=o.charAt(r));else{n===void 0&&(n=o.substr(0,r));let a=K1[s];a!==void 0?(i!==-1&&(n+=encodeURIComponent(o.substring(i,r)),i=-1),n+=a):i===-1&&(i=r)}}return i!==-1&&(n+=encodeURIComponent(o.substring(i))),n!==void 0?n:o}function e2(o){let e;for(let t=0;t<o.length;t++){let n=o.charCodeAt(t);n===35||n===63?(e===void 0&&(e=o.substr(0,t)),e+=K1[n]):e!==void 0&&(e+=o[t])}return e!==void 0?e:o}function Ep(o,e){let t;return o.authority&&o.path.length>1&&o.scheme==="file"?t=`//${o.authority}${o.path}`:o.path.charCodeAt(0)===47&&(o.path.charCodeAt(1)>=65&&o.path.charCodeAt(1)<=90||o.path.charCodeAt(1)>=97&&o.path.charCodeAt(1)<=122)&&o.path.charCodeAt(2)===58?e?t=o.path.substr(1):t=o.path[1].toLowerCase()+o.path.substr(2):t=o.path,mt&&(t=t.replace(/\//g,"\\")),t}function tx(o,e){let t=e?e2:H1,n="",{scheme:i,authority:r,path:s,query:a,fragment:l}=o;if(i&&(n+=i,n+=":"),(r||i==="file")&&(n+=br,n+=br),r){let d=r.indexOf("@");if(d!==-1){let c=r.substr(0,d);r=r.substr(d+1),d=c.lastIndexOf(":"),d===-1?n+=t(c,!1,!1):(n+=t(c.substr(0,d),!1,!1),n+=":",n+=t(c.substr(d+1),!1,!0)),n+="@"}r=r.toLowerCase(),d=r.lastIndexOf(":"),d===-1?n+=t(r,!1,!0):(n+=t(r.substr(0,d),!1,!0),n+=r.substr(d))}if(s){if(s.length>=3&&s.charCodeAt(0)===47&&s.charCodeAt(2)===58){let d=s.charCodeAt(1);d>=65&&d<=90&&(s=`/${String.fromCharCode(d+32)}:${s.substr(3)}`)}else if(s.length>=2&&s.charCodeAt(1)===58){let d=s.charCodeAt(0);d>=65&&d<=90&&(s=`${String.fromCharCode(d+32)}:${s.substr(2)}`)}n+=t(s,!0,!1)}return a&&(n+="?",n+=t(a,!1,!1)),l&&(n+="#",n+=e?l:H1(l,!1,!1)),n}function G1(o){try{return decodeURIComponent(o)}catch{return o.length>3?o.substr(0,3)+G1(o.substr(3)):o}}var U1=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function kf(o){return o.match(U1)?o.replace(U1,e=>G1(e)):o}function _p(o,e,t){let n=o.get(e);return n===void 0&&(n=t,o.set(e,n)),n}var nx=class{constructor(e,t){this.uri=e;this.value=t}};function t2(o){return Array.isArray(o)}var Ai=class o{static defaultToKey=e=>e.toString();[Symbol.toStringTag]="ResourceMap";map;toKey;constructor(e,t){if(e instanceof o)this.map=new Map(e.map),this.toKey=t??o.defaultToKey;else if(t2(e)){this.map=new Map,this.toKey=t??o.defaultToKey;for(let[n,i]of e)this.set(n,i)}else this.map=new Map,this.toKey=e??o.defaultToKey}set(e,t){return this.map.set(this.toKey(e),new nx(e,t)),this}get(e){return this.map.get(this.toKey(e))?.value}has(e){return this.map.has(this.toKey(e))}get size(){return this.map.size}clear(){this.map.clear()}delete(e){return this.map.delete(this.toKey(e))}forEach(e,t){typeof t<"u"&&(e=e.bind(t));for(let[n,i]of this.map)e(i.value,i.uri,this)}*values(){for(let e of this.map.values())yield e.value}*keys(){for(let e of this.map.values())yield e.uri}*entries(){for(let e of this.map.values())yield[e.uri,e.value]}*[Symbol.iterator](){for(let[,e]of this.map)yield[e.uri,e.value]}},Rf=class{[Symbol.toStringTag]="ResourceSet";_map;constructor(e,t){!e||typeof e=="function"?this._map=new Ai(e):(this._map=new Ai(t),e.forEach(this.add,this))}get size(){return this._map.size}add(e){return this._map.set(e,e),this}clear(){this._map.clear()}delete(e){return this._map.delete(e)}forEach(e,t){this._map.forEach((n,i)=>e.call(t,i,i,this))}has(e){return this._map.has(e)}entries(){return this._map.entries()}keys(){return this._map.keys()}values(){return this._map.keys()}[Symbol.iterator](){return this.keys()}};var ix=class{[Symbol.toStringTag]="LinkedMap";_map;_head;_tail;_size;_state;constructor(){this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(e){return this._map.has(e)}get(e,t=0){let n=this._map.get(e);if(n)return t!==0&&this.touch(n,t),n.value}set(e,t,n=0){let i=this._map.get(e);if(i)i.value=t,n!==0&&this.touch(i,n);else{switch(i={key:e,value:t,next:void 0,previous:void 0},n){case 0:this.addItemLast(i);break;case 1:this.addItemFirst(i);break;case 2:this.addItemLast(i);break;default:this.addItemLast(i);break}this._map.set(e,i),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){let t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");let e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){let n=this._state,i=this._head;for(;i;){if(t?e.bind(t)(i.value,i.key,this):e(i.value,i.key,this),this._state!==n)throw new Error("LinkedMap got modified during iteration.");i=i.next}}keys(){let e=this,t=this._state,n=this._head,i={[Symbol.iterator](){return i},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){let r={value:n.key,done:!1};return n=n.next,r}else return{value:void 0,done:!0}}};return i}values(){let e=this,t=this._state,n=this._head,i={[Symbol.iterator](){return i},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){let r={value:n.value,done:!1};return n=n.next,r}else return{value:void 0,done:!0}}};return i}entries(){let e=this,t=this._state,n=this._head,i={[Symbol.iterator](){return i},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){let r={value:[n.key,n.value],done:!1};return n=n.next,r}else return{value:void 0,done:!0}}};return i}[Symbol.iterator](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._head,n=this.size;for(;t&&n>e;)this._map.delete(t.key),t=t.next,n--;this._head=t,this._size=n,t&&(t.previous=void 0),this._state++}trimNew(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._tail,n=this.size;for(;t&&n>e;)this._map.delete(t.key),t=t.previous,n--;this._tail=t,this._size=n,t&&(t.next=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{let t=e.next,n=e.previous;if(!t||!n)throw new Error("Invalid list");t.previous=n,n.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(t!==1&&t!==2)){if(t===1){if(e===this._head)return;let n=e.next,i=e.previous;e===this._tail?(i.next=void 0,this._tail=i):(n.previous=i,i.next=n),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===2){if(e===this._tail)return;let n=e.next,i=e.previous;e===this._head?(n.previous=void 0,this._head=n):(n.previous=i,i.next=n),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){let e=[];return this.forEach((t,n)=>{e.push([n,t])}),e}fromJSON(e){this.clear();for(let[t,n]of e)this.set(t,n)}},Mf=class extends ix{_limit;_ratio;constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,t=2){return super.get(e,t)}peek(e){return super.get(e,0)}set(e,t){return super.set(e,t,2),this}checkTrim(){this.size>this._limit&&this.trim(Math.round(this._limit*this._ratio))}},fo=class extends Mf{constructor(e,t=1){super(e,t)}trim(e){this.trimOld(e)}set(e,t){return super.set(e,t),this.checkTrim(),this}},Af=class extends Mf{constructor(e,t=1){super(e,t)}trim(e){this.trimNew(e)}set(e,t){return this._limit<=this.size&&!this.has(e)&&this.trim(Math.round(this._limit*this._ratio)-1),super.set(e,t),this}};var Fc=class{map=new Map;add(e,t){let n=this.map.get(e);n||(n=new Set,this.map.set(e,n)),n.add(t)}delete(e,t){let n=this.map.get(e);n&&(n.delete(t),n.size===0&&this.map.delete(e))}forEach(e,t){let n=this.map.get(e);n&&n.forEach(t)}get(e){let t=this.map.get(e);return t||new Set}};function vr(o,e){let t=this,n=!1,i;return function(){if(n)return i;if(n=!0,e)try{i=o.apply(t,arguments)}finally{e()}else i=o.apply(t,arguments);return i}}var bo;(x=>{function o(L){return L&&typeof L=="object"&&typeof L[Symbol.iterator]=="function"}x.is=o;let e=Object.freeze([]);function t(){return e}x.empty=t;function*n(L){yield L}x.single=n;function i(L){return o(L)?L:n(L)}x.wrap=i;function r(L){return L||e}x.from=r;function*s(L){for(let k=L.length-1;k>=0;k--)yield L[k]}x.reverse=s;function a(L){return!L||L[Symbol.iterator]().next().done===!0}x.isEmpty=a;function l(L){return L[Symbol.iterator]().next().value}x.first=l;function d(L,k){let O=0;for(let W of L)if(k(W,O++))return!0;return!1}x.some=d;function c(L,k){for(let O of L)if(k(O))return O}x.find=c;function*u(L,k){for(let O of L)k(O)&&(yield O)}x.filter=u;function*h(L,k){let O=0;for(let W of L)yield k(W,O++)}x.map=h;function*m(L,k){let O=0;for(let W of L)yield*k(W,O++)}x.flatMap=m;function*f(...L){for(let k of L)yield*k}x.concat=f;function g(L,k,O){let W=O;for(let z of L)W=k(W,z);return W}x.reduce=g;function*b(L,k,O=L.length){for(k<0&&(k+=L.length),O<0?O+=L.length:O>L.length&&(O=L.length);k<O;k++)yield L[k]}x.slice=b;function y(L,k=Number.POSITIVE_INFINITY){let O=[];if(k===0)return[O,L];let W=L[Symbol.iterator]();for(let z=0;z<k;z++){let B=W.next();if(B.done)return[O,x.empty()];O.push(B.value)}return[O,{[Symbol.iterator](){return W}}]}x.consume=y;async function C(L){let k=[];for await(let O of L)k.push(O);return Promise.resolve(k)}x.asyncToArray=C})(bo||={});var n2=!1,td=null;function i2(o){td=o}if(n2){let o="__is_disposable_tracked__";i2(new class{trackDisposable(e){let t=new Error("Potentially leaked disposable").stack;setTimeout(()=>{e[o]||console.log(t)},3e3)}setParent(e,t){if(e&&e!==V.None)try{e[o]=!0}catch{}}markAsDisposed(e){if(e&&e!==V.None)try{e[o]=!0}catch{}}markAsSingleton(e){}})}function nd(o){return td?.trackDisposable(o),o}function id(o){td?.markAsDisposed(o)}function Tp(o,e){td?.setParent(o,e)}function o2(o,e){if(td)for(let t of o)td.setParent(t,e)}function ja(o){return td?.markAsSingleton(o),o}function j1(o){return typeof o=="object"&&o!==null&&typeof o.dispose=="function"&&o.dispose.length===0}function kt(o){if(bo.is(o)){let e=[];for(let t of o)if(t)try{t.dispose()}catch(n){e.push(n)}if(e.length===1)throw e[0];if(e.length>1)throw new AggregateError(e,"Encountered errors while disposing of store");return Array.isArray(o)?[]:o}else if(o)return o.dispose(),o}function yr(...o){let e=ve(()=>kt(o));return o2(o,e),e}function ve(o){let e=nd({dispose:vr(()=>{id(e),o()})});return e}var he=class o{static DISABLE_DISPOSED_WARNING=!1;_toDispose=new Set;_isDisposed=!1;constructor(){nd(this)}dispose(){this._isDisposed||(id(this),this._isDisposed=!0,this.clear())}get isDisposed(){return this._isDisposed}clear(){if(this._toDispose.size!==0)try{kt(this._toDispose)}finally{this._toDispose.clear()}}add(e){if(!e)return e;if(e===this)throw new Error("Cannot register a disposable on itself!");return Tp(e,this),this._isDisposed?o.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this._toDispose.add(e),e}delete(e){if(e){if(e===this)throw new Error("Cannot dispose a disposable on itself!");this._toDispose.delete(e),e.dispose()}}deleteAndLeak(e){e&&this._toDispose.has(e)&&(this._toDispose.delete(e),Tp(e,null))}},V=class{static None=Object.freeze({dispose(){}});_store=new he;constructor(){nd(this),Tp(this._store,this)}dispose(){id(this),this._store.dispose()}_register(e){if(e===this)throw new Error("Cannot register a disposable on itself!");return this._store.add(e)}},Zt=class{_value;_isDisposed=!1;constructor(){nd(this)}get value(){return this._isDisposed?void 0:this._value}set value(e){this._isDisposed||e===this._value||(this._value?.dispose(),e&&Tp(e,this),this._value=e)}clear(){this.value=void 0}dispose(){this._isDisposed=!0,id(this),this._value?.dispose(),this._value=void 0}clearAndLeak(){let e=this._value;return this._value=void 0,e&&Tp(e,null),e}};var Fo=class{_store=new Map;_isDisposed=!1;constructor(){nd(this)}dispose(){id(this),this._isDisposed=!0,this.clearAndDisposeAll()}clearAndDisposeAll(){if(this._store.size)try{kt(this._store.values())}finally{this._store.clear()}}has(e){return this._store.has(e)}get size(){return this._store.size}get(e){return this._store.get(e)}set(e,t,n=!1){this._isDisposed&&console.warn(new Error("Trying to add a disposable to a DisposableMap that has already been disposed of. The added object will be leaked!").stack),n||this._store.get(e)?.dispose(),this._store.set(e,t)}deleteAndDispose(e){this._store.get(e)?.dispose(),this._store.delete(e)}deleteAndLeak(e){let t=this._store.get(e);return this._store.delete(e),t}keys(){return this._store.keys()}values(){return this._store.values()}[Symbol.iterator](){return this._store[Symbol.iterator]()}};var $1=Object.freeze(function(o,e){let t=setTimeout(o.bind(e),0);return{dispose(){clearTimeout(t)}}}),pn;(n=>{function o(i){return i===n.None||i===n.Cancelled||i instanceof Bc?!0:!i||typeof i!="object"?!1:typeof i.isCancellationRequested=="boolean"&&typeof i.onCancellationRequested=="function"}n.isCancellationToken=o,n.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:oe.None}),n.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:$1})})(pn||={});var Bc=class{_isCancelled=!1;_emitter=null;cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?$1:(this._emitter||(this._emitter=new E),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=null)}},Xo=class{_token=void 0;_parentListener=void 0;constructor(e){this._parentListener=e&&e.onCancellationRequested(this.cancel,this)}get token(){return this._token||(this._token=new Bc),this._token}cancel(){this._token?this._token instanceof Bc&&this._token.cancel():this._token=pn.Cancelled}dispose(e=!1){e&&this.cancel(),this._parentListener?.dispose(),this._token?this._token instanceof Bc&&this._token.dispose():this._token=pn.None}};var tn=class o{static Undefined=new o(void 0);element;next;prev;constructor(e){this.element=e,this.next=o.Undefined,this.prev=o.Undefined}},ui=class{_first=tn.Undefined;_last=tn.Undefined;_size=0;get size(){return this._size}isEmpty(){return this._first===tn.Undefined}clear(){let e=this._first;for(;e!==tn.Undefined;){let t=e.next;e.prev=tn.Undefined,e.next=tn.Undefined,e=t}this._first=tn.Undefined,this._last=tn.Undefined,this._size=0}unshift(e){return this._insert(e,!1)}push(e){return this._insert(e,!0)}_insert(e,t){let n=new tn(e);if(this._first===tn.Undefined)this._first=n,this._last=n;else if(t){let r=this._last;this._last=n,n.prev=r,r.next=n}else{let r=this._first;this._first=n,n.next=r,r.prev=n}this._size+=1;let i=!1;return()=>{i||(i=!0,this._remove(n))}}shift(){if(this._first!==tn.Undefined){let e=this._first.element;return this._remove(this._first),e}}pop(){if(this._last!==tn.Undefined){let e=this._last.element;return this._remove(this._last),e}}_remove(e){if(e.prev!==tn.Undefined&&e.next!==tn.Undefined){let t=e.prev;t.next=e.next,e.next.prev=t}else e.prev===tn.Undefined&&e.next===tn.Undefined?(this._first=tn.Undefined,this._last=tn.Undefined):e.next===tn.Undefined?(this._last=this._last.prev,this._last.next=tn.Undefined):e.prev===tn.Undefined&&(this._first=this._first.next,this._first.prev=tn.Undefined);this._size-=1}*[Symbol.iterator](){let e=this._first;for(;e!==tn.Undefined;)yield e.element,e=e.next}};var od=(o,e)=>o===e;var Ir=class{constructor(e,t,n){this.owner=e;this.debugNameSource=t;this.referenceFn=n}getDebugName(e){return X1(e,this)}},q1=new Map,ox=new WeakMap;function X1(o,e){let t=ox.get(o);if(t)return t;let n=r2(o,e);if(n){let i=q1.get(n)??0;i++,q1.set(n,i);let r=i===1?n:`${n}#${i}`;return ox.set(o,r),r}}function r2(o,e){let t=ox.get(o);if(t)return t;let n=e.owner?a2(e.owner)+".":"",i,r=e.debugNameSource;if(r!==void 0)if(typeof r=="function"){if(i=r(),i!==void 0)return n+i}else return n+r;let s=e.referenceFn;if(s!==void 0&&(i=Of(s),i!==void 0))return n+i;if(e.owner!==void 0){let a=s2(e.owner,o);if(a!==void 0)return n+a}}function s2(o,e){for(let t in o)if(o[t]===e)return t}var Y1=new Map,Z1=new WeakMap;function a2(o){let e=Z1.get(o);if(e)return e;let t=l2(o),n=Y1.get(t)??0;n++,Y1.set(t,n);let i=n===1?t:`${t}#${n}`;return Z1.set(o,i),i}function l2(o){let e=o.constructor;return e?e.name:"Object"}function Of(o){let e=o.toString(),n=/\/\*\*\s*@description\s*([^*]*)\*\//.exec(e);return(n?n[1]:void 0)?.trim()}function Nf(o,e){if(!o)throw new Error(e?`Assertion failed (${e})`:"Assertion Failed")}function Pf(o,e="Unreachable"){throw new Error(e)}function Vc(o){if(!o()){debugger;o(),je(new Qe("Assertion Failed"))}}function $a(o){return new Ff(new Ir(void 0,void 0,o),o,void 0,void 0)}var Ff=class{constructor(e,t,n,i){this._debugNameData=e;this._runFn=t;this.createChangeSummary=n;this._handleChange=i;this.changeSummary=this.createChangeSummary?.(),Bo()?.handleAutorunCreated(this),this._runIfNeeded(),nd(this)}state=2;updateCount=0;disposed=!1;dependencies=new Set;dependenciesToBeRemoved=new Set;changeSummary;get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}dispose(){this.disposed=!0;for(let e of this.dependencies)e.removeObserver(this);this.dependencies.clear(),id(this)}_runIfNeeded(){if(this.state===3)return;let e=this.dependenciesToBeRemoved;this.dependenciesToBeRemoved=this.dependencies,this.dependencies=e,this.state=3;let t=this.disposed;try{if(!t){Bo()?.handleAutorunTriggered(this);let n=this.changeSummary;try{this.changeSummary=this.createChangeSummary?.(),this._runFn(this,n)}catch(i){Ac(i)}}}finally{t||Bo()?.handleAutorunFinished(this);for(let n of this.dependenciesToBeRemoved)n.removeObserver(this);this.dependenciesToBeRemoved.clear()}}toString(){return`Autorun<${this.debugName}>`}beginUpdate(){this.state===3&&(this.state=1),this.updateCount++}endUpdate(){try{if(this.updateCount===1)do{if(this.state===1){this.state=3;for(let e of this.dependencies)if(e.reportChanges(),this.state===2)break}this._runIfNeeded()}while(this.state!==3)}finally{this.updateCount--}Vc(()=>this.updateCount>=0)}handlePossibleChange(e){this.state===3&&this.dependencies.has(e)&&!this.dependenciesToBeRemoved.has(e)&&(this.state=1)}handleChange(e,t){if(this.dependencies.has(e)&&!this.dependenciesToBeRemoved.has(e))try{(this._handleChange?this._handleChange({changedObservable:e,change:t,didChange:i=>i===e},this.changeSummary):!0)&&(this.state=2)}catch(n){Ac(n)}}readObservable(e){if(this.disposed)return e.get();e.addObserver(this);let t=e.get();return this.dependencies.add(e),this.dependenciesToBeRemoved.delete(e),t}};(e=>e.Observer=Ff)($a||={});function rx(o,e){return new Bf(new Ir(o.owner,o.debugName,o.debugReferenceFn),e,void 0,void 0,o.onLastObserverRemoved,o.equalsFn??od)}Q1(rx);var Bf=class extends rd{constructor(t,n,i,r,s=void 0,a){super();this._debugNameData=t;this._computeFn=n;this.createChangeSummary=i;this._handleChange=r;this._handleLastObserverRemoved=s;this._equalityComparator=a;this.changeSummary=this.createChangeSummary?.(),Bo()?.handleDerivedCreated(this)}state=0;value=void 0;updateCount=0;dependencies=new Set;dependenciesToBeRemoved=new Set;changeSummary=void 0;get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}onLastObserverRemoved(){this.state=0,this.value=void 0;for(let t of this.dependencies)t.removeObserver(this);this.dependencies.clear(),this._handleLastObserverRemoved?.()}get(){if(this.observers.size===0){let t=this._computeFn(this,this.createChangeSummary?.());return this.onLastObserverRemoved(),t}else{do{if(this.state===1){for(let t of this.dependencies)if(t.reportChanges(),this.state===2)break}this.state===1&&(this.state=3),this._recomputeIfNeeded()}while(this.state!==3);return this.value}}_recomputeIfNeeded(){if(this.state===3)return;let t=this.dependenciesToBeRemoved;this.dependenciesToBeRemoved=this.dependencies,this.dependencies=t;let n=this.state!==0,i=this.value;this.state=3;let r=!1;try{let s=this.changeSummary;this.changeSummary=this.createChangeSummary?.();try{this.value=this._computeFn(this,s)}finally{for(let a of this.dependenciesToBeRemoved)a.removeObserver(this);this.dependenciesToBeRemoved.clear()}r=n&&!this._equalityComparator(i,this.value),Bo()?.handleDerivedRecomputed(this,{oldValue:i,newValue:this.value,change:void 0,didChange:r,hadValue:n})}catch(s){Ac(s)}if(r)for(let s of this.observers)s.handleChange(this,void 0)}toString(){return`LazyDerived<${this.debugName}>`}beginUpdate(t){this.updateCount++;let n=this.updateCount===1;if(this.state===3&&(this.state=1,!n))for(let i of this.observers)i.handlePossibleChange(this);if(n)for(let i of this.observers)i.beginUpdate(this)}endUpdate(t){if(this.updateCount--,this.updateCount===0){let n=[...this.observers];for(let i of n)i.endUpdate(this)}Vc(()=>this.updateCount>=0)}handlePossibleChange(t){if(this.state===3&&this.dependencies.has(t)&&!this.dependenciesToBeRemoved.has(t)){this.state=1;for(let n of this.observers)n.handlePossibleChange(this)}}handleChange(t,n){if(this.dependencies.has(t)&&!this.dependenciesToBeRemoved.has(t)){let i=!1;try{i=this._handleChange?this._handleChange({changedObservable:t,change:n,didChange:s=>s===t},this.changeSummary):!0}catch(s){Ac(s)}let r=this.state===3;if(i&&(this.state===1||r)&&(this.state=2,r))for(let s of this.observers)s.handlePossibleChange(this)}}readObservable(t){t.addObserver(this);let n=t.get();return this.dependencies.add(t),this.dependenciesToBeRemoved.delete(t),n}addObserver(t){let n=!this.observers.has(t)&&this.updateCount>0;super.addObserver(t),n&&t.beginUpdate(this)}removeObserver(t){let n=this.observers.has(t)&&this.updateCount>0;super.removeObserver(t),n&&t.endUpdate(this)}};function Wf(o){return new sx(o)}var sx=class extends Lp{constructor(t){super();this.value=t}get debugName(){return this.toString()}get(){return this.value}addObserver(t){}removeObserver(t){}toString(){return`Const: ${this.value}`}};function ax(...o){let e,t,n;return o.length===3?[e,t,n]=o:[t,n]=o,new qa(new Ir(e,void 0,n),t,n,()=>qa.globalTransaction,od)}var qa=class extends rd{constructor(t,n,i,r,s){super();this._debugNameData=t;this.event=n;this._getValue=i;this._getTransaction=r;this._equalityComparator=s}static globalTransaction;value;hasValue=!1;subscription;getDebugName(){return this._debugNameData.getDebugName(this)}get debugName(){let t=this.getDebugName();return"From Event"+(t?`: ${t}`:"")}onFirstObserverAdded(){this.subscription=this.event(this.handleEvent)}handleEvent=t=>{let n=this._getValue(t),i=this.value,r=!this.hasValue||!this._equalityComparator(i,n),s=!1;r&&(this.value=n,this.hasValue&&(s=!0,lx(this._getTransaction(),a=>{Bo()?.handleFromEventObservableTriggered(this,{oldValue:i,newValue:n,change:void 0,didChange:r,hadValue:this.hasValue});for(let l of this.observers)a.updateObserver(l,this),l.handleChange(this,void 0)},()=>{let a=this.getDebugName();return"Event fired"+(a?`: ${a}`:"")})),this.hasValue=!0),s||Bo()?.handleFromEventObservableTriggered(this,{oldValue:i,newValue:n,change:void 0,didChange:r,hadValue:this.hasValue})};onLastObserverRemoved(){this.subscription.dispose(),this.subscription=void 0,this.hasValue=!1,this.value=void 0}get(){return this.subscription?(this.hasValue||this.handleEvent(void 0),this.value):this._getValue(void 0)}};(t=>{t.Observer=qa;function e(n,i){let r=!1;qa.globalTransaction===void 0&&(qa.globalTransaction=n,r=!0);try{i()}finally{r&&(qa.globalTransaction=void 0)}}t.batchEventsGlobally=e})(ax||={});function ek(o){let e=new Vf(!1,void 0);return o.addObserver(e),ve(()=>{o.removeObserver(e)})}ik(ek);function tk(o,e){let t=new Vf(!0,e);return o.addObserver(t),e?e(o.get()):o.reportChanges(),ve(()=>{o.removeObserver(t)})}nk(tk);var Vf=class{constructor(e,t){this._forceRecompute=e;this._handleValue=t}_counter=0;beginUpdate(e){this._counter++}endUpdate(e){this._counter--,this._counter===0&&this._forceRecompute&&(this._handleValue?this._handleValue(e.get()):e.reportChanges())}handlePossibleChange(e){}handleChange(e,t){}};var rk;function sk(o){rk=o}function Bo(){return rk}var Uf=class{indentation=0;textToConsoleArgs(e){return h2([Wc(g2("|  ",this.indentation)),e])}formatInfo(e){return e.hadValue?e.didChange?[Wc(" "),Cr(kp(e.oldValue,70),{color:"red",strikeThrough:!0}),Wc(" "),Cr(kp(e.newValue,60),{color:"green"})]:[Wc(" (unchanged)")]:[Wc(" "),Cr(kp(e.newValue,60),{color:"green"}),Wc(" (initial)")]}handleObservableChanged(e,t){console.log(...this.textToConsoleArgs([Dp("observable value changed"),Cr(e.debugName,{color:"BlueViolet"}),...this.formatInfo(t)]))}changedObservablesSets=new WeakMap;formatChanges(e){if(e.size!==0)return Cr(" (changed deps: "+[...e].map(t=>t.debugName).join(", ")+")",{color:"gray"})}handleDerivedCreated(e){let t=e.handleChange;this.changedObservablesSets.set(e,new Set),e.handleChange=(n,i)=>(this.changedObservablesSets.get(e).add(n),t.apply(e,[n,i]))}handleDerivedRecomputed(e,t){let n=this.changedObservablesSets.get(e);console.log(...this.textToConsoleArgs([Dp("derived recomputed"),Cr(e.debugName,{color:"BlueViolet"}),...this.formatInfo(t),this.formatChanges(n),{data:[{fn:e._debugNameData.referenceFn??e._computeFn}]}])),n.clear()}handleFromEventObservableTriggered(e,t){console.log(...this.textToConsoleArgs([Dp("observable from event triggered"),Cr(e.debugName,{color:"BlueViolet"}),...this.formatInfo(t),{data:[{fn:e._getValue}]}]))}handleAutorunCreated(e){let t=e.handleChange;this.changedObservablesSets.set(e,new Set),e.handleChange=(n,i)=>(this.changedObservablesSets.get(e).add(n),t.apply(e,[n,i]))}handleAutorunTriggered(e){let t=this.changedObservablesSets.get(e);console.log(...this.textToConsoleArgs([Dp("autorun"),Cr(e.debugName,{color:"BlueViolet"}),this.formatChanges(t),{data:[{fn:e._debugNameData.referenceFn??e._runFn}]}])),t.clear(),this.indentation++}handleAutorunFinished(e){this.indentation--}handleBeginTransaction(e){let t=e.getDebugName();t===void 0&&(t=""),console.log(...this.textToConsoleArgs([Dp("transaction"),Cr(t,{color:"BlueViolet"}),{data:[{fn:e._fn}]}])),this.indentation++}handleEndTransaction(){this.indentation--}};function h2(o){let e=new Array,t=[],n="";function i(s){if("length"in s)for(let a of s)a&&i(a);else"text"in s?(n+=`%c${s.text}`,e.push(s.style),s.data&&t.push(...s.data)):"data"in s&&t.push(...s.data)}i(o);let r=[n,...e];return r.push(...t),r}function Wc(o){return Cr(o,{color:"black"})}function Dp(o){return Cr(f2(`${o}: `,10),{color:"black",bold:!0})}function Cr(o,e={color:"black"}){function t(i){return Object.entries(i).reduce((r,[s,a])=>`${r}${s}:${a};`,"")}let n={color:e.color};return e.strikeThrough&&(n["text-decoration"]="line-through"),e.bold&&(n["font-weight"]="bold"),{text:o,style:t(n)}}function kp(o,e){switch(typeof o){case"number":return""+o;case"string":return o.length+2<=e?`"${o}"`:`"${o.substr(0,e-7)}"+...`;case"boolean":return o?"true":"false";case"undefined":return"undefined";case"object":return o===null?"null":Array.isArray(o)?p2(o,e):m2(o,e);case"symbol":return o.toString();case"function":return`[[Function${o.name?" "+o.name:""}]]`;default:return""+o}}function p2(o,e){let t="[ ",n=!0;for(let i of o){if(n||(t+=", "),t.length-5>e){t+="...";break}n=!1,t+=`${kp(i,e-t.length)}`}return t+=" ]",t}function m2(o,e){let t="{ ",n=!0;for(let[i,r]of Object.entries(o)){if(n||(t+=", "),t.length-5>e){t+="...";break}n=!1,t+=`${i}: ${kp(r,e-t.length)}`}return t+=" }",t}function g2(o,e){let t="";for(let n=1;n<=e;n++)t+=o;return t}function f2(o,e){for(;o.length<e;)o+=" ";return o}var ak;function nk(o){ak=o}var lk;function ik(o){lk=o}var dx;function Q1(o){dx=o}var Lp=class{get TChange(){return null}reportChanges(){this.get()}read(e){return e?e.readObservable(this):this.get()}map(e,t){let n=t===void 0?void 0:e,i=t===void 0?e:t;return dx({owner:n,debugName:()=>{let r=Of(i);if(r!==void 0)return r;let a=/^\s*\(?\s*([a-zA-Z_$][a-zA-Z_$0-9]*)\s*\)?\s*=>\s*\1(?:\??)\.([a-zA-Z_$][a-zA-Z_$0-9]*)\s*$/.exec(i.toString());if(a)return`${this.debugName}.${a[2]}`;if(!n)return`${this.debugName} (mapped)`},debugReferenceFn:i},r=>i(this.read(r),r))}flatten(){return dx({owner:void 0,debugName:()=>`${this.debugName} (flattened)`},e=>this.read(e).read(e))}recomputeInitiallyAndOnChange(e,t){return e.add(ak(this,t)),this}keepObserved(e){return e.add(lk(this)),this}get debugValue(){return this.get()}},rd=class extends Lp{observers=new Set;addObserver(e){let t=this.observers.size;this.observers.add(e),t===0&&this.onFirstObserverAdded()}removeObserver(e){this.observers.delete(e)&&this.observers.size===0&&this.onLastObserverRemoved()}onFirstObserverAdded(){}onLastObserverRemoved(){}};function Hf(o,e){let t=new zf(o,e);try{o(t)}finally{t.finish()}}function lx(o,e,t){o?e(o):Hf(e,t)}var zf=class{constructor(e,t){this._fn=e;this._getDebugName=t;Bo()?.handleBeginTransaction(this)}updatingObservers=[];getDebugName(){return this._getDebugName?this._getDebugName():Of(this._fn)}updateObserver(e,t){this.updatingObservers.push({observer:e,observable:t}),e.beginUpdate(t)}finish(){let e=this.updatingObservers;for(let t=0;t<e.length;t++){let{observer:n,observable:i}=e[t];n.endUpdate(i)}this.updatingObservers=null,Bo()?.handleEndTransaction()}};var b2=!1;b2&&sk(new Uf);var v2=globalThis.performance&&typeof globalThis.performance.now=="function",sd=class o{_startTime;_stopTime;_now;static create(e){return new o(e)}constructor(e){this._now=v2&&e===!1?Date.now:globalThis.performance.now.bind(globalThis.performance),this._startTime=this._now(),this._stopTime=-1}stop(){this._stopTime=this._now()}reset(){this._startTime=this._now(),this._stopTime=-1}elapsed(){return this._stopTime!==-1?this._stopTime-this._startTime:this._now()-this._startTime}};var cx=Symbol("MicrotaskDelay");var y2=!1,dk=!1,I2=!1,oe;(Ce=>{Ce.None=()=>V.None;function e(te){if(I2){let{onDidAddListener:Z}=te,le=Rp.create(),ne=0;te.onDidAddListener=()=>{++ne===2&&(console.warn("snapshotted emitter LIKELY used public and SHOULD HAVE BEEN created with DisposableStore. snapshotted here"),le.print()),Z?.()}}}function t(te,Z){return m(te,()=>{},0,void 0,!0,void 0,Z)}Ce.defer=t;function n(te){return(Z,le=null,ne)=>{let Q=!1,we;return we=te(xe=>{if(!Q)return we?we.dispose():Q=!0,Z.call(le,xe)},null,ne),Q&&we.dispose(),we}}Ce.once=n;function i(te,Z){return Ce.once(Ce.filter(te,Z))}Ce.onceIf=i;function r(te,Z,le){return u((ne,Q=null,we)=>te(xe=>ne.call(Q,Z(xe)),null,we),le)}Ce.map=r;function s(te,Z,le){return u((ne,Q=null,we)=>te(xe=>{Z(xe),ne.call(Q,xe)},null,we),le)}Ce.forEach=s;function a(te,Z,le){return u((ne,Q=null,we)=>te(xe=>Z(xe)&&ne.call(Q,xe),null,we),le)}Ce.filter=a;function l(te){return te}Ce.signal=l;function d(...te){return(Z,le=null,ne)=>{let Q=yr(...te.map(we=>we(xe=>Z.call(le,xe))));return h(Q,ne)}}Ce.any=d;function c(te,Z,le,ne){let Q=le;return r(te,we=>(Q=Z(Q,we),Q),ne)}Ce.reduce=c;function u(te,Z){let le,ne={onWillAddFirstListener(){le=te(Q.fire,Q)},onDidRemoveLastListener(){le?.dispose()}};Z||e(ne);let Q=new E(ne);return Z?.add(Q),Q.event}function h(te,Z){return Z instanceof Array?Z.push(te):Z&&Z.add(te),te}function m(te,Z,le=100,ne=!1,Q=!1,we,xe){let st,Xe,ke,$n=0,xn,ji={leakWarningThreshold:we,onWillAddFirstListener(){st=te(Aa=>{$n++,Xe=Z(Xe,Aa),ne&&!ke&&(po.fire(Xe),Xe=void 0),xn=()=>{let ai=Xe;Xe=void 0,ke=void 0,(!ne||$n>1)&&po.fire(ai),$n=0},typeof le=="number"?(clearTimeout(ke),ke=setTimeout(xn,le)):ke===void 0&&(ke=0,queueMicrotask(xn))})},onWillRemoveListener(){Q&&$n>0&&xn?.()},onDidRemoveLastListener(){xn=void 0,st.dispose()}};xe||e(ji);let po=new E(ji);return xe?.add(po),po.event}Ce.debounce=m;function f(te,Z=0,le){return Ce.debounce(te,(ne,Q)=>ne?(ne.push(Q),ne):[Q],Z,void 0,!0,void 0,le)}Ce.accumulate=f;function g(te,Z=(ne,Q)=>ne===Q,le){let ne=!0,Q;return a(te,we=>{let xe=ne||!Z(we,Q);return ne=!1,Q=we,xe},le)}Ce.latch=g;function b(te,Z,le){return[Ce.filter(te,Z,le),Ce.filter(te,ne=>!Z(ne),le)]}Ce.split=b;function y(te,Z=!1,le=[],ne){let Q=le.slice(),we=te(Xe=>{Q?Q.push(Xe):st.fire(Xe)});ne&&ne.add(we);let xe=()=>{Q?.forEach(Xe=>st.fire(Xe)),Q=null},st=new E({onWillAddFirstListener(){we||(we=te(Xe=>st.fire(Xe)),ne&&ne.add(we))},onDidAddFirstListener(){Q&&(Z?setTimeout(xe):xe())},onDidRemoveLastListener(){we&&we.dispose(),we=null}});return ne&&ne.add(st),st.event}Ce.buffer=y;function C(te,Z){return(ne,Q,we)=>{let xe=Z(new L);return te(function(st){let Xe=xe.evaluate(st);Xe!==x&&ne.call(Q,Xe)},void 0,we)}}Ce.chain=C;let x=Symbol("HaltChainable");class L{steps=[];map(Z){return this.steps.push(Z),this}forEach(Z){return this.steps.push(le=>(Z(le),le)),this}filter(Z){return this.steps.push(le=>Z(le)?le:x),this}reduce(Z,le){let ne=le;return this.steps.push(Q=>(ne=Z(ne,Q),ne)),this}latch(Z=(le,ne)=>le===ne){let le=!0,ne;return this.steps.push(Q=>{let we=le||!Z(Q,ne);return le=!1,ne=Q,we?Q:x}),this}evaluate(Z){for(let le of this.steps)if(Z=le(Z),Z===x)break;return Z}}function k(te,Z,le=ne=>ne){let ne=(...st)=>xe.fire(le(...st)),Q=()=>te.on(Z,ne),we=()=>te.removeListener(Z,ne),xe=new E({onWillAddFirstListener:Q,onDidRemoveLastListener:we});return xe.event}Ce.fromNodeEventEmitter=k;function O(te,Z,le=ne=>ne){let ne=(...st)=>xe.fire(le(...st)),Q=()=>te.addEventListener(Z,ne),we=()=>te.removeEventListener(Z,ne),xe=new E({onWillAddFirstListener:Q,onDidRemoveLastListener:we});return xe.event}Ce.fromDOMEventEmitter=O;function W(te){return new Promise(Z=>n(te)(Z))}Ce.toPromise=W;function z(te){let Z=new E;return te.then(le=>{Z.fire(le)},()=>{Z.fire(void 0)}).finally(()=>{Z.dispose()}),Z.event}Ce.fromPromise=z;function B(te,Z){return te(le=>Z.fire(le))}Ce.forward=B;function G(te,Z,le){return Z(le),te(ne=>Z(ne))}Ce.runAndSubscribe=G;class q{constructor(Z,le){this._observable=Z;let ne={onWillAddFirstListener:()=>{Z.addObserver(this),this._observable.reportChanges()},onDidRemoveLastListener:()=>{Z.removeObserver(this)}};le||e(ne),this.emitter=new E(ne),le&&le.add(this.emitter)}emitter;_counter=0;_hasChanged=!1;beginUpdate(Z){this._counter++}handlePossibleChange(Z){}handleChange(Z,le){this._hasChanged=!0}endUpdate(Z){this._counter--,this._counter===0&&(this._observable.reportChanges(),this._hasChanged&&(this._hasChanged=!1,this.emitter.fire(this._observable.get())))}}function X(te,Z){return new q(te,Z).emitter.event}Ce.fromObservable=X;function ce(te){return(Z,le,ne)=>{let Q=0,we=!1,xe={beginUpdate(){Q++},endUpdate(){Q--,Q===0&&(te.reportChanges(),we&&(we=!1,Z.call(le)))},handlePossibleChange(){},handleChange(){we=!0}};te.addObserver(xe),te.reportChanges();let st={dispose(){te.removeObserver(xe)}};return ne instanceof he?ne.add(st):Array.isArray(ne)&&ne.push(st),st}}Ce.fromObservableLight=ce})(oe||={});var ux=class o{static all=new Set;static _idPool=0;name;listenerCount=0;invocationCount=0;elapsedOverall=0;durations=[];_stopWatch;constructor(e){this.name=`${e}_${o._idPool++}`,o.all.add(this)}start(e){this._stopWatch=new sd,this.listenerCount=e}stop(){if(this._stopWatch){let e=this._stopWatch.elapsed();this.durations.push(e),this.elapsedOverall+=e,this.invocationCount+=1,this._stopWatch=void 0}}},ck=-1;var hx=class o{constructor(e,t,n=(o._idPool++).toString(16).padStart(3,"0")){this._errorHandler=e;this.threshold=t;this.name=n}static _idPool=1;_stacks;_warnCountdown=0;dispose(){this._stacks?.clear()}check(e,t){let n=this.threshold;if(n<=0||t<n)return;this._stacks||(this._stacks=new Map);let i=this._stacks.get(e.value)||0;if(this._stacks.set(e.value,i+1),this._warnCountdown-=1,this._warnCountdown<=0){this._warnCountdown=n*.5;let[r,s]=this.getMostFrequentStack(),a=`[${this.name}] potential listener LEAK detected, having ${t} listeners already. MOST frequent listener (${s}):`;console.warn(a),console.warn(r);let l=new px(a,r);this._errorHandler(l)}return()=>{let r=this._stacks.get(e.value)||0;this._stacks.set(e.value,r-1)}}getMostFrequentStack(){if(!this._stacks)return;let e,t=0;for(let[n,i]of this._stacks)(!e||t<i)&&(e=[n,i],t=i);return e}},Rp=class o{constructor(e){this.value=e}static create(){let e=new Error;return new o(e.stack??"")}print(){console.warn(this.value.split(`
`).slice(2).join(`
`))}},px=class extends Error{constructor(e,t){super(e),this.name="ListenerLeakError",this.stack=t}},mx=class extends Error{constructor(e,t){super(e),this.name="ListenerRefusalError",this.stack=t}},C2=0,Hc=class{constructor(e){this.value=e}stack;id=C2++},S2=2,uk=(o,e)=>{if(o instanceof Hc)e(o);else for(let t=0;t<o.length;t++){let n=o[t];n&&e(n)}},Kf;if(y2){let o=[];setInterval(()=>{o.length!==0&&(console.warn("[LEAKING LISTENERS] GC'ed these listeners that were NOT yet disposed:"),console.warn(o.join(`
`)),o.length=0)},3e3),Kf=new FinalizationRegistry(e=>{typeof e=="string"&&o.push(e)})}var E=class{_options;_leakageMon;_perfMon;_disposed;_event;_listeners;_deliveryQueue;_size=0;constructor(e){this._options=e,this._leakageMon=ck>0||this._options?.leakWarningThreshold?new hx(e?.onListenerError??je,this._options?.leakWarningThreshold??ck):void 0,this._perfMon=this._options?._profName?new ux(this._options._profName):void 0,this._deliveryQueue=this._options?.deliveryQueue}dispose(){if(!this._disposed){if(this._disposed=!0,this._deliveryQueue?.current===this&&this._deliveryQueue.reset(),this._listeners){if(dk){let e=this._listeners;queueMicrotask(()=>{uk(e,t=>t.stack?.print())})}this._listeners=void 0,this._size=0}this._options?.onDidRemoveLastListener?.(),this._leakageMon?.dispose()}}get event(){return this._event??=(e,t,n)=>{if(this._leakageMon&&this._size>this._leakageMon.threshold**2){let l=`[${this._leakageMon.name}] REFUSES to accept new listeners because it exceeded its threshold by far (${this._size} vs ${this._leakageMon.threshold})`;console.warn(l);let d=this._leakageMon.getMostFrequentStack()??["UNKNOWN stack",-1],c=new mx(`${l}. HINT: Stack shows most frequent listener (${d[1]}-times)`,d[0]);return(this._options?.onListenerError||je)(c),V.None}if(this._disposed)return V.None;t&&(e=e.bind(t));let i=new Hc(e),r,s;this._leakageMon&&this._size>=Math.ceil(this._leakageMon.threshold*.2)&&(i.stack=Rp.create(),r=this._leakageMon.check(i.stack,this._size+1)),dk&&(i.stack=s??Rp.create()),this._listeners?this._listeners instanceof Hc?(this._deliveryQueue??=new Gf,this._listeners=[this._listeners,i]):this._listeners.push(i):(this._options?.onWillAddFirstListener?.(this),this._listeners=i,this._options?.onDidAddFirstListener?.(this)),this._size++;let a=ve(()=>{Kf?.unregister(a),r?.(),this._removeListener(i)});if(n instanceof he?n.add(a):Array.isArray(n)&&n.push(a),Kf){let l=new Error().stack.split(`
`).slice(2,3).join(`
`).trim(),d=/(file:|vscode-file:\/\/vscode-app)?(\/[^:]*:\d+:\d+)/.exec(l);Kf.register(a,d?.[2]??l,a)}return a},this._event}_removeListener(e){if(this._options?.onWillRemoveListener?.(this),!this._listeners)return;if(this._size===1){this._listeners=void 0,this._options?.onDidRemoveLastListener?.(this),this._size=0;return}let t=this._listeners,n=t.indexOf(e);if(n===-1)throw console.log("disposed?",this._disposed),console.log("size?",this._size),console.log("arr?",JSON.stringify(this._listeners)),new Error("Attempted to dispose unknown listener");this._size--,t[n]=void 0;let i=this._deliveryQueue.current===this;if(this._size*S2<=t.length){let r=0;for(let s=0;s<t.length;s++)t[s]?t[r++]=t[s]:i&&(this._deliveryQueue.end--,r<this._deliveryQueue.i&&this._deliveryQueue.i--);t.length=r}}_deliver(e,t){if(!e)return;let n=this._options?.onListenerError||je;if(!n){e.value(t);return}try{e.value(t)}catch(i){n(i)}}_deliverQueue(e){let t=e.current._listeners;for(;e.i<e.end;)this._deliver(t[e.i++],e.value);e.reset()}fire(e){if(this._deliveryQueue?.current&&(this._deliverQueue(this._deliveryQueue),this._perfMon?.stop()),this._perfMon?.start(this._size),this._listeners)if(this._listeners instanceof Hc)this._deliver(this._listeners,e);else{let t=this._deliveryQueue;t.enqueue(this,e,this._listeners.length),this._deliverQueue(t)}this._perfMon?.stop()}hasListeners(){return this._size>0}},hk=()=>new Gf,Gf=class{i=-1;end=0;current;value;enqueue(e,t,n){this.i=0,this.end=n,this.current=e,this.value=t}reset(){this.i=this.end,this.current=void 0,this.value=void 0}},Uc=class extends E{_asyncDeliveryQueue;async fireAsync(e,t,n){if(this._listeners)for(this._asyncDeliveryQueue||(this._asyncDeliveryQueue=new ui),uk(this._listeners,i=>this._asyncDeliveryQueue.push([i.value,e]));this._asyncDeliveryQueue.size>0&&!t.isCancellationRequested;){let[i,r]=this._asyncDeliveryQueue.shift(),s=[],a={...r,token:t,waitUntil:l=>{if(Object.isFrozen(s))throw new Error("waitUntil can NOT be called asynchronous");n&&(l=n(l,i)),s.push(l)}};try{i(a)}catch(l){je(l);continue}Object.freeze(s),await Promise.allSettled(s).then(l=>{for(let d of l)d.status==="rejected"&&je(d.reason)})}}},ad=class extends E{_isPaused=0;_eventQueue=new ui;_mergeFn;get isPaused(){return this._isPaused!==0}constructor(e){super(e),this._mergeFn=e?.merge}pause(){this._isPaused++}resume(){if(this._isPaused!==0&&--this._isPaused===0)if(this._mergeFn){if(this._eventQueue.size>0){let e=Array.from(this._eventQueue);this._eventQueue.clear(),super.fire(this._mergeFn(e))}}else for(;!this._isPaused&&this._eventQueue.size!==0;)super.fire(this._eventQueue.shift())}fire(e){this._size&&(this._isPaused!==0?this._eventQueue.push(e):super.fire(e))}},jf=class extends ad{_delay;_handle;constructor(e){super(e),this._delay=e.delay??100}fire(e){this._handle||(this.pause(),this._handle=setTimeout(()=>{this._handle=void 0,this.resume()},this._delay)),super.fire(e)}},$f=class extends E{_queuedEvents=[];_mergeFn;constructor(e){super(e),this._mergeFn=e?.merge}fire(e){this.hasListeners()&&(this._queuedEvents.push(e),this._queuedEvents.length===1&&queueMicrotask(()=>{this._mergeFn?super.fire(this._mergeFn(this._queuedEvents)):this._queuedEvents.forEach(t=>super.fire(t)),this._queuedEvents=[]}))}},Mp=class{emitter;hasListeners=!1;events=[];constructor(){this.emitter=new E({onWillAddFirstListener:()=>this.onFirstListenerAdd(),onDidRemoveLastListener:()=>this.onLastListenerRemove()})}get event(){return this.emitter.event}add(e){let t={event:e,listener:null};return this.events.push(t),this.hasListeners&&this.hook(t),ve(vr(()=>{this.hasListeners&&this.unhook(t);let i=this.events.indexOf(t);this.events.splice(i,1)}))}onFirstListenerAdd(){this.hasListeners=!0,this.events.forEach(e=>this.hook(e))}onLastListenerRemove(){this.hasListeners=!1,this.events.forEach(e=>this.unhook(e))}hook(e){e.listener=e.event(t=>this.emitter.fire(t))}unhook(e){e.listener?.dispose(),e.listener=null}dispose(){this.emitter.dispose();for(let e of this.events)e.listener?.dispose();this.events=[]}};var zc=class{data=[];wrapEvent(e,t,n){return(i,r,s)=>e(a=>{let l=this.data[this.data.length-1];if(!t){l?l.buffers.push(()=>i.call(r,a)):i.call(r,a);return}let d=l;if(!d){i.call(r,t(n,a));return}d.items??=[],d.items.push(a),d.buffers.length===0&&l.buffers.push(()=>{d.reducedResult??=n?d.items.reduce(t,n):d.items.reduce(t),i.call(r,d.reducedResult)})},void 0,s)}bufferEvents(e){let t={buffers:new Array};this.data.push(t);let n=e();return this.data.pop(),t.buffers.forEach(i=>i()),n}};var ld=class o{static INSTANCE=new o;mapWindowIdToZoomLevel=new Map;_onDidChangeZoomLevel=new E;onDidChangeZoomLevel=this._onDidChangeZoomLevel.event;getZoomLevel(e){return this.mapWindowIdToZoomLevel.get(this.getWindowId(e))??0}setZoomLevel(e,t){if(this.getZoomLevel(t)===e)return;let n=this.getWindowId(t);this.mapWindowIdToZoomLevel.set(n,e),this._onDidChangeZoomLevel.fire(n)}mapWindowIdToZoomFactor=new Map;getZoomFactor(e){return this.mapWindowIdToZoomFactor.get(this.getWindowId(e))??1}setZoomFactor(e,t){this.mapWindowIdToZoomFactor.set(this.getWindowId(t),e)}_onDidChangeFullscreen=new E;onDidChangeFullscreen=this._onDidChangeFullscreen.event;mapWindowIdToFullScreen=new Map;setFullscreen(e,t){if(this.isFullscreen(t)===e)return;let n=this.getWindowId(t);this.mapWindowIdToFullScreen.set(n,e),this._onDidChangeFullscreen.fire(n)}isFullscreen(e){return!!this.mapWindowIdToFullScreen.get(this.getWindowId(e))}getWindowId(e){return e.vscodeWindowId}};function x2(o,e,t){typeof e=="string"&&(e=o.matchMedia(e)),e.addEventListener("change",t)}function pk(o){return ld.INSTANCE.getZoomLevel(o)}var $3=ld.INSTANCE.onDidChangeZoomLevel;function mk(o){return ld.INSTANCE.getZoomFactor(o)}function gk(o,e){ld.INSTANCE.setFullscreen(o,e)}var q3=ld.INSTANCE.onDidChangeFullscreen,Kc=navigator.userAgent,sn=Kc.indexOf("Firefox")>=0,Sr=Kc.indexOf("AppleWebKit")>=0,Ya=Kc.indexOf("Chrome")>=0,Xi=!Ya&&Kc.indexOf("Safari")>=0,fk=!Ya&&!Xi&&Sr,Y3=Kc.indexOf("Electron/")>=0,gx=Kc.indexOf("Android")>=0,qf=!1;if(typeof De.matchMedia=="function"){let o=De.matchMedia("(display-mode: standalone) or (display-mode: window-controls-overlay)"),e=De.matchMedia("(display-mode: fullscreen)");qf=o.matches,x2(De,o,({matches:t})=>{qf&&e.matches||(qf=t)})}function bk(){return qf}var Ap=class{_keyCodeToStr;_strToKeyCode;constructor(){this._keyCodeToStr=[],this._strToKeyCode=Object.create(null)}define(e,t){this._keyCodeToStr[e]=t,this._strToKeyCode[t.toLowerCase()]=e}keyCodeToStr(e){return this._keyCodeToStr[e]}strToKeyCode(e){return this._strToKeyCode[e.toLowerCase()]||0}},Yf=new Ap,fx=new Ap,bx=new Ap,yx=new Array(230),E2={},_2=[],T2=Object.create(null),L2=Object.create(null);var vk=[],vx=[];for(let o=0;o<=193;o++)vk[o]=-1;for(let o=0;o<=132;o++)vx[o]=-1;(function(){let o="",e=[[1,0,"None",0,"unknown",0,"VK_UNKNOWN",o,o],[1,1,"Hyper",0,o,0,o,o,o],[1,2,"Super",0,o,0,o,o,o],[1,3,"Fn",0,o,0,o,o,o],[1,4,"FnLock",0,o,0,o,o,o],[1,5,"Suspend",0,o,0,o,o,o],[1,6,"Resume",0,o,0,o,o,o],[1,7,"Turbo",0,o,0,o,o,o],[1,8,"Sleep",0,o,0,"VK_SLEEP",o,o],[1,9,"WakeUp",0,o,0,o,o,o],[0,10,"KeyA",31,"A",65,"VK_A",o,o],[0,11,"KeyB",32,"B",66,"VK_B",o,o],[0,12,"KeyC",33,"C",67,"VK_C",o,o],[0,13,"KeyD",34,"D",68,"VK_D",o,o],[0,14,"KeyE",35,"E",69,"VK_E",o,o],[0,15,"KeyF",36,"F",70,"VK_F",o,o],[0,16,"KeyG",37,"G",71,"VK_G",o,o],[0,17,"KeyH",38,"H",72,"VK_H",o,o],[0,18,"KeyI",39,"I",73,"VK_I",o,o],[0,19,"KeyJ",40,"J",74,"VK_J",o,o],[0,20,"KeyK",41,"K",75,"VK_K",o,o],[0,21,"KeyL",42,"L",76,"VK_L",o,o],[0,22,"KeyM",43,"M",77,"VK_M",o,o],[0,23,"KeyN",44,"N",78,"VK_N",o,o],[0,24,"KeyO",45,"O",79,"VK_O",o,o],[0,25,"KeyP",46,"P",80,"VK_P",o,o],[0,26,"KeyQ",47,"Q",81,"VK_Q",o,o],[0,27,"KeyR",48,"R",82,"VK_R",o,o],[0,28,"KeyS",49,"S",83,"VK_S",o,o],[0,29,"KeyT",50,"T",84,"VK_T",o,o],[0,30,"KeyU",51,"U",85,"VK_U",o,o],[0,31,"KeyV",52,"V",86,"VK_V",o,o],[0,32,"KeyW",53,"W",87,"VK_W",o,o],[0,33,"KeyX",54,"X",88,"VK_X",o,o],[0,34,"KeyY",55,"Y",89,"VK_Y",o,o],[0,35,"KeyZ",56,"Z",90,"VK_Z",o,o],[0,36,"Digit1",22,"1",49,"VK_1",o,o],[0,37,"Digit2",23,"2",50,"VK_2",o,o],[0,38,"Digit3",24,"3",51,"VK_3",o,o],[0,39,"Digit4",25,"4",52,"VK_4",o,o],[0,40,"Digit5",26,"5",53,"VK_5",o,o],[0,41,"Digit6",27,"6",54,"VK_6",o,o],[0,42,"Digit7",28,"7",55,"VK_7",o,o],[0,43,"Digit8",29,"8",56,"VK_8",o,o],[0,44,"Digit9",30,"9",57,"VK_9",o,o],[0,45,"Digit0",21,"0",48,"VK_0",o,o],[1,46,"Enter",3,"Enter",13,"VK_RETURN",o,o],[1,47,"Escape",9,"Escape",27,"VK_ESCAPE",o,o],[1,48,"Backspace",1,"Backspace",8,"VK_BACK",o,o],[1,49,"Tab",2,"Tab",9,"VK_TAB",o,o],[1,50,"Space",10,"Space",32,"VK_SPACE",o,o],[0,51,"Minus",88,"-",189,"VK_OEM_MINUS","-","OEM_MINUS"],[0,52,"Equal",86,"=",187,"VK_OEM_PLUS","=","OEM_PLUS"],[0,53,"BracketLeft",92,"[",219,"VK_OEM_4","[","OEM_4"],[0,54,"BracketRight",94,"]",221,"VK_OEM_6","]","OEM_6"],[0,55,"Backslash",93,"\\",220,"VK_OEM_5","\\","OEM_5"],[0,56,"IntlHash",0,o,0,o,o,o],[0,57,"Semicolon",85,";",186,"VK_OEM_1",";","OEM_1"],[0,58,"Quote",95,"'",222,"VK_OEM_7","'","OEM_7"],[0,59,"Backquote",91,"`",192,"VK_OEM_3","`","OEM_3"],[0,60,"Comma",87,",",188,"VK_OEM_COMMA",",","OEM_COMMA"],[0,61,"Period",89,".",190,"VK_OEM_PERIOD",".","OEM_PERIOD"],[0,62,"Slash",90,"/",191,"VK_OEM_2","/","OEM_2"],[1,63,"CapsLock",8,"CapsLock",20,"VK_CAPITAL",o,o],[1,64,"F1",59,"F1",112,"VK_F1",o,o],[1,65,"F2",60,"F2",113,"VK_F2",o,o],[1,66,"F3",61,"F3",114,"VK_F3",o,o],[1,67,"F4",62,"F4",115,"VK_F4",o,o],[1,68,"F5",63,"F5",116,"VK_F5",o,o],[1,69,"F6",64,"F6",117,"VK_F6",o,o],[1,70,"F7",65,"F7",118,"VK_F7",o,o],[1,71,"F8",66,"F8",119,"VK_F8",o,o],[1,72,"F9",67,"F9",120,"VK_F9",o,o],[1,73,"F10",68,"F10",121,"VK_F10",o,o],[1,74,"F11",69,"F11",122,"VK_F11",o,o],[1,75,"F12",70,"F12",123,"VK_F12",o,o],[1,76,"PrintScreen",0,o,0,o,o,o],[1,77,"ScrollLock",84,"ScrollLock",145,"VK_SCROLL",o,o],[1,78,"Pause",7,"PauseBreak",19,"VK_PAUSE",o,o],[1,79,"Insert",19,"Insert",45,"VK_INSERT",o,o],[1,80,"Home",14,"Home",36,"VK_HOME",o,o],[1,81,"PageUp",11,"PageUp",33,"VK_PRIOR",o,o],[1,82,"Delete",20,"Delete",46,"VK_DELETE",o,o],[1,83,"End",13,"End",35,"VK_END",o,o],[1,84,"PageDown",12,"PageDown",34,"VK_NEXT",o,o],[1,85,"ArrowRight",17,"RightArrow",39,"VK_RIGHT","Right",o],[1,86,"ArrowLeft",15,"LeftArrow",37,"VK_LEFT","Left",o],[1,87,"ArrowDown",18,"DownArrow",40,"VK_DOWN","Down",o],[1,88,"ArrowUp",16,"UpArrow",38,"VK_UP","Up",o],[1,89,"NumLock",83,"NumLock",144,"VK_NUMLOCK",o,o],[1,90,"NumpadDivide",113,"NumPad_Divide",111,"VK_DIVIDE",o,o],[1,91,"NumpadMultiply",108,"NumPad_Multiply",106,"VK_MULTIPLY",o,o],[1,92,"NumpadSubtract",111,"NumPad_Subtract",109,"VK_SUBTRACT",o,o],[1,93,"NumpadAdd",109,"NumPad_Add",107,"VK_ADD",o,o],[1,94,"NumpadEnter",3,o,0,o,o,o],[1,95,"Numpad1",99,"NumPad1",97,"VK_NUMPAD1",o,o],[1,96,"Numpad2",100,"NumPad2",98,"VK_NUMPAD2",o,o],[1,97,"Numpad3",101,"NumPad3",99,"VK_NUMPAD3",o,o],[1,98,"Numpad4",102,"NumPad4",100,"VK_NUMPAD4",o,o],[1,99,"Numpad5",103,"NumPad5",101,"VK_NUMPAD5",o,o],[1,100,"Numpad6",104,"NumPad6",102,"VK_NUMPAD6",o,o],[1,101,"Numpad7",105,"NumPad7",103,"VK_NUMPAD7",o,o],[1,102,"Numpad8",106,"NumPad8",104,"VK_NUMPAD8",o,o],[1,103,"Numpad9",107,"NumPad9",105,"VK_NUMPAD9",o,o],[1,104,"Numpad0",98,"NumPad0",96,"VK_NUMPAD0",o,o],[1,105,"NumpadDecimal",112,"NumPad_Decimal",110,"VK_DECIMAL",o,o],[0,106,"IntlBackslash",97,"OEM_102",226,"VK_OEM_102",o,o],[1,107,"ContextMenu",58,"ContextMenu",93,o,o,o],[1,108,"Power",0,o,0,o,o,o],[1,109,"NumpadEqual",0,o,0,o,o,o],[1,110,"F13",71,"F13",124,"VK_F13",o,o],[1,111,"F14",72,"F14",125,"VK_F14",o,o],[1,112,"F15",73,"F15",126,"VK_F15",o,o],[1,113,"F16",74,"F16",127,"VK_F16",o,o],[1,114,"F17",75,"F17",128,"VK_F17",o,o],[1,115,"F18",76,"F18",129,"VK_F18",o,o],[1,116,"F19",77,"F19",130,"VK_F19",o,o],[1,117,"F20",78,"F20",131,"VK_F20",o,o],[1,118,"F21",79,"F21",132,"VK_F21",o,o],[1,119,"F22",80,"F22",133,"VK_F22",o,o],[1,120,"F23",81,"F23",134,"VK_F23",o,o],[1,121,"F24",82,"F24",135,"VK_F24",o,o],[1,122,"Open",0,o,0,o,o,o],[1,123,"Help",0,o,0,o,o,o],[1,124,"Select",0,o,0,o,o,o],[1,125,"Again",0,o,0,o,o,o],[1,126,"Undo",0,o,0,o,o,o],[1,127,"Cut",0,o,0,o,o,o],[1,128,"Copy",0,o,0,o,o,o],[1,129,"Paste",0,o,0,o,o,o],[1,130,"Find",0,o,0,o,o,o],[1,131,"AudioVolumeMute",117,"AudioVolumeMute",173,"VK_VOLUME_MUTE",o,o],[1,132,"AudioVolumeUp",118,"AudioVolumeUp",175,"VK_VOLUME_UP",o,o],[1,133,"AudioVolumeDown",119,"AudioVolumeDown",174,"VK_VOLUME_DOWN",o,o],[1,134,"NumpadComma",110,"NumPad_Separator",108,"VK_SEPARATOR",o,o],[0,135,"IntlRo",115,"ABNT_C1",193,"VK_ABNT_C1",o,o],[1,136,"KanaMode",0,o,0,o,o,o],[0,137,"IntlYen",0,o,0,o,o,o],[1,138,"Convert",0,o,0,o,o,o],[1,139,"NonConvert",0,o,0,o,o,o],[1,140,"Lang1",0,o,0,o,o,o],[1,141,"Lang2",0,o,0,o,o,o],[1,142,"Lang3",0,o,0,o,o,o],[1,143,"Lang4",0,o,0,o,o,o],[1,144,"Lang5",0,o,0,o,o,o],[1,145,"Abort",0,o,0,o,o,o],[1,146,"Props",0,o,0,o,o,o],[1,147,"NumpadParenLeft",0,o,0,o,o,o],[1,148,"NumpadParenRight",0,o,0,o,o,o],[1,149,"NumpadBackspace",0,o,0,o,o,o],[1,150,"NumpadMemoryStore",0,o,0,o,o,o],[1,151,"NumpadMemoryRecall",0,o,0,o,o,o],[1,152,"NumpadMemoryClear",0,o,0,o,o,o],[1,153,"NumpadMemoryAdd",0,o,0,o,o,o],[1,154,"NumpadMemorySubtract",0,o,0,o,o,o],[1,155,"NumpadClear",131,"Clear",12,"VK_CLEAR",o,o],[1,156,"NumpadClearEntry",0,o,0,o,o,o],[1,0,o,5,"Ctrl",17,"VK_CONTROL",o,o],[1,0,o,4,"Shift",16,"VK_SHIFT",o,o],[1,0,o,6,"Alt",18,"VK_MENU",o,o],[1,0,o,57,"Meta",91,"VK_COMMAND",o,o],[1,157,"ControlLeft",5,o,0,"VK_LCONTROL",o,o],[1,158,"ShiftLeft",4,o,0,"VK_LSHIFT",o,o],[1,159,"AltLeft",6,o,0,"VK_LMENU",o,o],[1,160,"MetaLeft",57,o,0,"VK_LWIN",o,o],[1,161,"ControlRight",5,o,0,"VK_RCONTROL",o,o],[1,162,"ShiftRight",4,o,0,"VK_RSHIFT",o,o],[1,163,"AltRight",6,o,0,"VK_RMENU",o,o],[1,164,"MetaRight",57,o,0,"VK_RWIN",o,o],[1,165,"BrightnessUp",0,o,0,o,o,o],[1,166,"BrightnessDown",0,o,0,o,o,o],[1,167,"MediaPlay",0,o,0,o,o,o],[1,168,"MediaRecord",0,o,0,o,o,o],[1,169,"MediaFastForward",0,o,0,o,o,o],[1,170,"MediaRewind",0,o,0,o,o,o],[1,171,"MediaTrackNext",124,"MediaTrackNext",176,"VK_MEDIA_NEXT_TRACK",o,o],[1,172,"MediaTrackPrevious",125,"MediaTrackPrevious",177,"VK_MEDIA_PREV_TRACK",o,o],[1,173,"MediaStop",126,"MediaStop",178,"VK_MEDIA_STOP",o,o],[1,174,"Eject",0,o,0,o,o,o],[1,175,"MediaPlayPause",127,"MediaPlayPause",179,"VK_MEDIA_PLAY_PAUSE",o,o],[1,176,"MediaSelect",128,"LaunchMediaPlayer",181,"VK_MEDIA_LAUNCH_MEDIA_SELECT",o,o],[1,177,"LaunchMail",129,"LaunchMail",180,"VK_MEDIA_LAUNCH_MAIL",o,o],[1,178,"LaunchApp2",130,"LaunchApp2",183,"VK_MEDIA_LAUNCH_APP2",o,o],[1,179,"LaunchApp1",0,o,0,"VK_MEDIA_LAUNCH_APP1",o,o],[1,180,"SelectTask",0,o,0,o,o,o],[1,181,"LaunchScreenSaver",0,o,0,o,o,o],[1,182,"BrowserSearch",120,"BrowserSearch",170,"VK_BROWSER_SEARCH",o,o],[1,183,"BrowserHome",121,"BrowserHome",172,"VK_BROWSER_HOME",o,o],[1,184,"BrowserBack",122,"BrowserBack",166,"VK_BROWSER_BACK",o,o],[1,185,"BrowserForward",123,"BrowserForward",167,"VK_BROWSER_FORWARD",o,o],[1,186,"BrowserStop",0,o,0,"VK_BROWSER_STOP",o,o],[1,187,"BrowserRefresh",0,o,0,"VK_BROWSER_REFRESH",o,o],[1,188,"BrowserFavorites",0,o,0,"VK_BROWSER_FAVORITES",o,o],[1,189,"ZoomToggle",0,o,0,o,o,o],[1,190,"MailReply",0,o,0,o,o,o],[1,191,"MailForward",0,o,0,o,o,o],[1,192,"MailSend",0,o,0,o,o,o],[1,0,o,114,"KeyInComposition",229,o,o,o],[1,0,o,116,"ABNT_C2",194,"VK_ABNT_C2",o,o],[1,0,o,96,"OEM_8",223,"VK_OEM_8",o,o],[1,0,o,0,o,0,"VK_KANA",o,o],[1,0,o,0,o,0,"VK_HANGUL",o,o],[1,0,o,0,o,0,"VK_JUNJA",o,o],[1,0,o,0,o,0,"VK_FINAL",o,o],[1,0,o,0,o,0,"VK_HANJA",o,o],[1,0,o,0,o,0,"VK_KANJI",o,o],[1,0,o,0,o,0,"VK_CONVERT",o,o],[1,0,o,0,o,0,"VK_NONCONVERT",o,o],[1,0,o,0,o,0,"VK_ACCEPT",o,o],[1,0,o,0,o,0,"VK_MODECHANGE",o,o],[1,0,o,0,o,0,"VK_SELECT",o,o],[1,0,o,0,o,0,"VK_PRINT",o,o],[1,0,o,0,o,0,"VK_EXECUTE",o,o],[1,0,o,0,o,0,"VK_SNAPSHOT",o,o],[1,0,o,0,o,0,"VK_HELP",o,o],[1,0,o,0,o,0,"VK_APPS",o,o],[1,0,o,0,o,0,"VK_PROCESSKEY",o,o],[1,0,o,0,o,0,"VK_PACKET",o,o],[1,0,o,0,o,0,"VK_DBE_SBCSCHAR",o,o],[1,0,o,0,o,0,"VK_DBE_DBCSCHAR",o,o],[1,0,o,0,o,0,"VK_ATTN",o,o],[1,0,o,0,o,0,"VK_CRSEL",o,o],[1,0,o,0,o,0,"VK_EXSEL",o,o],[1,0,o,0,o,0,"VK_EREOF",o,o],[1,0,o,0,o,0,"VK_PLAY",o,o],[1,0,o,0,o,0,"VK_ZOOM",o,o],[1,0,o,0,o,0,"VK_NONAME",o,o],[1,0,o,0,o,0,"VK_PA1",o,o],[1,0,o,0,o,0,"VK_OEM_CLEAR",o,o]],t=[],n=[];for(let i of e){let[r,s,a,l,d,c,u,h,m]=i;if(n[s]||(n[s]=!0,_2[s]=a,T2[a]=s,L2[a.toLowerCase()]=s,r&&(vk[s]=l,l!==0&&l!==3&&l!==5&&l!==4&&l!==6&&l!==57&&(vx[l]=s))),!t[l]){if(t[l]=!0,!d)throw new Error(`String representation missing for key code ${l} around scan code ${a}`);Yf.define(l,d),fx.define(l,h||d),bx.define(l,m||h||d)}c&&(yx[c]=l),u&&(E2[u]=l)}vx[3]=46})();var Op;(s=>{function o(a){return Yf.keyCodeToStr(a)}s.toString=o;function e(a){return Yf.strToKeyCode(a)}s.fromString=e;function t(a){return fx.keyCodeToStr(a)}s.toUserSettingsUS=t;function n(a){return bx.keyCodeToStr(a)}s.toUserSettingsGeneral=n;function i(a){return fx.strToKeyCode(a)||bx.strToKeyCode(a)}s.fromUserSettings=i;function r(a){if(a>=98&&a<=113)return null;switch(a){case 16:return"Up";case 18:return"Down";case 15:return"Left";case 17:return"Right"}return Yf.keyCodeToStr(a)}s.toElectronAccelerator=r})(Op||={});function Ix(o,e){if(typeof o=="number"){if(o===0)return null;let t=(o&65535)>>>0,n=(o&4294901760)>>>16;return n!==0?new Gc([Zf(t,e),Zf(n,e)]):new Gc([Zf(t,e)])}else{let t=[];for(let n=0;n<o.length;n++)t.push(Zf(o[n],e));return new Gc(t)}}function Zf(o,e){let t=!!(o&2048),n=!!(o&256),i=e===2?n:t,r=!!(o&1024),s=!!(o&512),a=e===2?t:n,l=o&255;return new Np(i,r,s,a,l)}var Np=class o{constructor(e,t,n,i,r){this.ctrlKey=e;this.shiftKey=t;this.altKey=n;this.metaKey=i;this.keyCode=r}equals(e){return e instanceof o&&this.ctrlKey===e.ctrlKey&&this.shiftKey===e.shiftKey&&this.altKey===e.altKey&&this.metaKey===e.metaKey&&this.keyCode===e.keyCode}getHashCode(){let e=this.ctrlKey?"1":"0",t=this.shiftKey?"1":"0",n=this.altKey?"1":"0",i=this.metaKey?"1":"0";return`K${e}${t}${n}${i}${this.keyCode}`}isModifierKey(){return this.keyCode===0||this.keyCode===5||this.keyCode===57||this.keyCode===6||this.keyCode===4}toKeybinding(){return new Gc([this])}isDuplicateModifierCase(){return this.ctrlKey&&this.keyCode===5||this.shiftKey&&this.keyCode===4||this.altKey&&this.keyCode===6||this.metaKey&&this.keyCode===57}};var Gc=class{chords;constructor(e){if(e.length===0)throw Ql("chords");this.chords=e}getHashCode(){let e="";for(let t=0,n=this.chords.length;t<n;t++)t!==0&&(e+=";"),e+=this.chords[t].getHashCode();return e}equals(e){if(e===null||this.chords.length!==e.chords.length)return!1;for(let t=0;t<this.chords.length;t++)if(!this.chords[t].equals(e.chords[t]))return!1;return!0}};function D2(o){if(o.charCode){let t=String.fromCharCode(o.charCode).toUpperCase();return Op.fromString(t)}let e=o.keyCode;if(e===3)return 7;if(sn)switch(e){case 59:return 85;case 60:if(Wt)return 97;break;case 61:return 86;case 107:return 109;case 109:return 111;case 173:return 88;case 224:if(Be)return 57;break}else if(Sr){if(Be&&e===93)return 57;if(!Be&&e===92)return 57}return yx[e]||0}var k2=Be?256:2048,R2=512,M2=1024,A2=Be?2048:256;var nt=class{_standardKeyboardEventBrand=!0;browserEvent;target;ctrlKey;shiftKey;altKey;metaKey;altGraphKey;keyCode;code;_asKeybinding;_asKeyCodeChord;constructor(e){let t=e;this.browserEvent=t,this.target=t.target,this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.altKey=t.altKey,this.metaKey=t.metaKey,this.altGraphKey=t.getModifierState?.("AltGraph"),this.keyCode=D2(t),this.code=t.code,this.ctrlKey=this.ctrlKey||this.keyCode===5,this.altKey=this.altKey||this.keyCode===6,this.shiftKey=this.shiftKey||this.keyCode===4,this.metaKey=this.metaKey||this.keyCode===57,this._asKeybinding=this._computeKeybinding(),this._asKeyCodeChord=this._computeKeyCodeChord()}preventDefault(){this.browserEvent&&this.browserEvent.preventDefault&&this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent&&this.browserEvent.stopPropagation&&this.browserEvent.stopPropagation()}toKeyCodeChord(){return this._asKeyCodeChord}equals(e){return this._asKeybinding===e}_computeKeybinding(){let e=0;this.keyCode!==5&&this.keyCode!==4&&this.keyCode!==6&&this.keyCode!==57&&(e=this.keyCode);let t=0;return this.ctrlKey&&(t|=k2),this.altKey&&(t|=R2),this.shiftKey&&(t|=M2),this.metaKey&&(t|=A2),t|=e,t}_computeKeyCodeChord(){let e=0;return this.keyCode!==5&&this.keyCode!==4&&this.keyCode!==6&&this.keyCode!==57&&(e=this.keyCode),new Np(this.ctrlKey,this.shiftKey,this.altKey,this.metaKey,e)}};var yk=new WeakMap;function O2(o){if(!o.parent||o.parent===o)return null;try{let e=o.location,t=o.parent.location;if(e.origin!=="null"&&t.origin!=="null"&&e.origin!==t.origin)return null}catch{return null}return o.parent}var Xf=class{static getSameOriginWindowChain(e){let t=yk.get(e);if(!t){t=[],yk.set(e,t);let n=e,i;do i=O2(n),i?t.push({window:new WeakRef(n),iframeElement:n.frameElement||null}):t.push({window:new WeakRef(n),iframeElement:null}),n=i;while(n)}return t.slice(0)}static getPositionOfChildWindowRelativeToAncestorWindow(e,t){if(!t||e===t)return{top:0,left:0};let n=0,i=0,r=this.getSameOriginWindowChain(e);for(let s of r){let a=s.window.deref();if(n+=a?.scrollY??0,i+=a?.scrollX??0,a===t||!s.iframeElement)break;let l=s.iframeElement.getBoundingClientRect();n+=l.top,i+=l.left}return{top:n,left:i}}};var hi=class{browserEvent;leftButton;middleButton;rightButton;buttons;target;detail;posx;posy;ctrlKey;shiftKey;altKey;metaKey;timestamp;constructor(e,t){this.timestamp=Date.now(),this.browserEvent=t,this.leftButton=t.button===0,this.middleButton=t.button===1,this.rightButton=t.button===2,this.buttons=t.buttons,this.target=t.target,this.detail=t.detail||1,t.type==="dblclick"&&(this.detail=2),this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.altKey=t.altKey,this.metaKey=t.metaKey,typeof t.pageX=="number"?(this.posx=t.pageX,this.posy=t.pageY):(this.posx=t.clientX+this.target.ownerDocument.body.scrollLeft+this.target.ownerDocument.documentElement.scrollLeft,this.posy=t.clientY+this.target.ownerDocument.body.scrollTop+this.target.ownerDocument.documentElement.scrollTop);let n=Xf.getPositionOfChildWindowRelativeToAncestorWindow(e,t.view);this.posx-=n.left,this.posy-=n.top}preventDefault(){this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent.stopPropagation()}};var Vo=class{browserEvent;deltaY;deltaX;target;constructor(e,t=0,n=0){this.browserEvent=e||null,this.target=e?e.target||e.targetNode||e.srcElement:null,this.deltaY=n,this.deltaX=t;let i=!1;if(Ya){let r=navigator.userAgent.match(/Chrome\/(\d+)/);i=(r?parseInt(r[1]):123)<=122}if(e){let r=e,s=e,a=e.view?.devicePixelRatio||1;if(typeof r.wheelDeltaY<"u")i?this.deltaY=r.wheelDeltaY/(120*a):this.deltaY=r.wheelDeltaY/120;else if(typeof s.VERTICAL_AXIS<"u"&&s.axis===s.VERTICAL_AXIS)this.deltaY=-s.detail/3;else if(e.type==="wheel"){let l=e;l.deltaMode===l.DOM_DELTA_LINE?sn&&!Be?this.deltaY=-e.deltaY/3:this.deltaY=-e.deltaY:this.deltaY=-e.deltaY/40}if(typeof r.wheelDeltaX<"u")Xi&&mt?this.deltaX=-(r.wheelDeltaX/120):i?this.deltaX=r.wheelDeltaX/(120*a):this.deltaX=r.wheelDeltaX/120;else if(typeof s.HORIZONTAL_AXIS<"u"&&s.axis===s.HORIZONTAL_AXIS)this.deltaX=-e.detail/3;else if(e.type==="wheel"){let l=e;l.deltaMode===l.DOM_DELTA_LINE?sn&&!Be?this.deltaX=-e.deltaX/3:this.deltaX=-e.deltaX:this.deltaX=-e.deltaX/40}this.deltaY===0&&this.deltaX===0&&e.wheelDelta&&(i?this.deltaY=e.wheelDelta/(120*a):this.deltaY=e.wheelDelta/120)}}preventDefault(){this.browserEvent?.preventDefault()}stopPropagation(){this.browserEvent?.stopPropagation()}};var Qf={clipboard:{writeText:rs||document.queryCommandSupported&&document.queryCommandSupported("copy")||!!(navigator&&navigator.clipboard&&navigator.clipboard.writeText),readText:rs||!!(navigator&&navigator.clipboard&&navigator.clipboard.readText)},keyboard:rs||bk()?0:navigator.keyboard||Xi?1:2,touch:"ontouchstart"in De||navigator.maxTouchPoints>0,pointerEvents:De.PointerEvent&&("ontouchstart"in De||navigator.maxTouchPoints>0)};function Ik(o){return o}var Jf=class{lastCache=void 0;lastArgKey=void 0;_fn;_computeKey;constructor(e,t){typeof e=="function"?(this._fn=e,this._computeKey=Ik):(this._fn=t,this._computeKey=e.getCacheKey)}get(e){let t=this._computeKey(e);return this.lastArgKey!==t&&(this.lastArgKey=t,this.lastCache=this._fn(e)),this.lastCache}},Fp=class{_map=new Map;_map2=new Map;get cachedValues(){return this._map}_fn;_computeKey;constructor(e,t){typeof e=="function"?(this._fn=e,this._computeKey=Ik):(this._fn=t,this._computeKey=e.getCacheKey)}get(e){let t=this._computeKey(e);if(this._map2.has(t))return this._map2.get(t);let n=this._fn(e);return this._map.set(e,n),this._map2.set(t,n),n}};var vi=class{constructor(e){this.executor=e}_didRun=!1;_value;_error;get hasValue(){return this._didRun}get value(){if(!this._didRun)try{this._value=this.executor()}catch(e){this._error=e}finally{this._didRun=!0}if(this._error)throw this._error;return this._value}get rawValue(){return this._value}};function dd(o){return o<0?0:o>255?255:o|0}function wk(o){return!o||typeof o!="string"?!0:o.trim().length===0}function xk(o){return o.replace(/[<>"'&]/g,e=>{switch(e){case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"'":return"&apos;";case"&":return"&amp;"}return e})}function $c(o){return o.replace(/[<>&]/g,function(e){switch(e){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";default:return e}})}function Qi(o){return o.replace(/[\\\{\}\*\+\?\|\^\$\.\[\]\(\)]/g,"\\$&")}function tb(o,e){if(!o||!e)return o;let t=e.length;if(t===0||o.length===0)return o;let n=0;for(;o.indexOf(e,n)===n;)n=n+t;return o.substring(n)}function nb(o,e,t={}){if(!o)throw new Error("Cannot create regex from empty string");e||(o=Qi(o)),t.wholeWord&&(/\B/.test(o.charAt(0))||(o="\\b"+o),/\B/.test(o.charAt(o.length-1))||(o=o+"\\b"));let n="";return t.global&&(n+="g"),t.matchCase||(n+="i"),t.multiline&&(n+="m"),t.unicode&&(n+="u"),new RegExp(o,n)}function Bp(o){return o.split(/\r\n|\r|\n/)}function Xt(o){for(let e=0,t=o.length;e<t;e++){let n=o.charCodeAt(e);if(n!==32&&n!==9)return e}return-1}function _n(o,e=0,t=o.length){for(let n=e;n<t;n++){let i=o.charCodeAt(n);if(i!==32&&i!==9)return o.substring(e,n)}return o.substring(e,t)}function Wo(o,e=o.length-1){for(let t=e;t>=0;t--){let n=o.charCodeAt(t);if(n!==32&&n!==9)return t}return-1}function Sx(o,e){return o<e?-1:o>e?1:0}function Ek(o,e,t=0,n=o.length,i=0,r=e.length){for(;t<n&&i<r;t++,i++){let l=o.charCodeAt(t),d=e.charCodeAt(i);if(l<d)return-1;if(l>d)return 1}let s=n-t,a=r-i;return s<a?-1:s>a?1:0}function wx(o,e,t=0,n=o.length,i=0,r=e.length){for(;t<n&&i<r;t++,i++){let l=o.charCodeAt(t),d=e.charCodeAt(i);if(l===d)continue;if(l>=128||d>=128)return Ek(o.toLowerCase(),e.toLowerCase(),t,n,i,r);cd(l)&&(l-=32),cd(d)&&(d-=32);let c=l-d;if(c!==0)return c}let s=n-t,a=r-i;return s<a?-1:s>a?1:0}function Vp(o){return o>=48&&o<=57}function cd(o){return o>=97&&o<=122}function ss(o){return o>=65&&o<=90}function wr(o,e){return o.length===e.length&&wx(o,e)===0}function Xa(o,e){let t=e.length;return e.length>o.length?!1:wx(o,e,0,t)===0}function Wp(o,e){let t=Math.min(o.length,e.length),n;for(n=0;n<t;n++)if(o.charCodeAt(n)!==e.charCodeAt(n))return n;return t}function Hp(o,e){let t=Math.min(o.length,e.length),n,i=o.length-1,r=e.length-1;for(n=0;n<t;n++)if(o.charCodeAt(i-n)!==e.charCodeAt(r-n))return n;return t}function Ht(o){return 55296<=o&&o<=56319}function Qa(o){return 56320<=o&&o<=57343}function ib(o,e){return(o-55296<<10)+(e-56320)+65536}function qc(o,e,t){let n=o.charCodeAt(t);if(Ht(n)&&t+1<e){let i=o.charCodeAt(t+1);if(Qa(i))return ib(n,i)}return n}function N2(o,e){let t=o.charCodeAt(e-1);if(Qa(t)&&e>1){let n=o.charCodeAt(e-2);if(Ht(n))return ib(n,t)}return t}var ud=class{_str;_len;_offset;get offset(){return this._offset}constructor(e,t=0){this._str=e,this._len=e.length,this._offset=t}setOffset(e){this._offset=e}prevCodePoint(){let e=N2(this._str,this._offset);return this._offset-=e>=65536?2:1,e}nextCodePoint(){let e=qc(this._str,this._len,this._offset);return this._offset+=e>=65536?2:1,e}eol(){return this._offset>=this._len}},hd=class{_iterator;get offset(){return this._iterator.offset}constructor(e,t=0){this._iterator=new ud(e,t)}nextGraphemeLength(){let e=eb.getInstance(),t=this._iterator,n=t.offset,i=e.getGraphemeBreakType(t.nextCodePoint());for(;!t.eol();){let r=t.offset,s=e.getGraphemeBreakType(t.nextCodePoint());if(Ck(i,s)){t.setOffset(r);break}i=s}return t.offset-n}prevGraphemeLength(){let e=eb.getInstance(),t=this._iterator,n=t.offset,i=e.getGraphemeBreakType(t.prevCodePoint());for(;t.offset>0;){let r=t.offset,s=e.getGraphemeBreakType(t.prevCodePoint());if(Ck(s,i)){t.setOffset(r);break}i=s}return n-t.offset}eol(){return this._iterator.eol()}};function Up(o,e){return new hd(o,e).nextGraphemeLength()}function xx(o,e){return new hd(o,e).prevGraphemeLength()}function ob(o,e){e>0&&Qa(o.charCodeAt(e))&&e--;let t=e+Up(o,e);return[t-xx(o,t),t]}var Cx;function P2(){return/(?:[\u05BE\u05C0\u05C3\u05C6\u05D0-\u05F4\u0608\u060B\u060D\u061B-\u064A\u066D-\u066F\u0671-\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u0710\u0712-\u072F\u074D-\u07A5\u07B1-\u07EA\u07F4\u07F5\u07FA\u07FE-\u0815\u081A\u0824\u0828\u0830-\u0858\u085E-\u088E\u08A0-\u08C9\u200F\uFB1D\uFB1F-\uFB28\uFB2A-\uFD3D\uFD50-\uFDC7\uFDF0-\uFDFC\uFE70-\uFEFC]|\uD802[\uDC00-\uDD1B\uDD20-\uDE00\uDE10-\uDE35\uDE40-\uDEE4\uDEEB-\uDF35\uDF40-\uDFFF]|\uD803[\uDC00-\uDD23\uDE80-\uDEA9\uDEAD-\uDF45\uDF51-\uDF81\uDF86-\uDFF6]|\uD83A[\uDC00-\uDCCF\uDD00-\uDD43\uDD4B-\uDFFF]|\uD83B[\uDC00-\uDEBB])/}function ea(o){return Cx||(Cx=P2()),Cx.test(o)}var F2=/^[\t\n\r\x20-\x7E]*$/;function rb(o){return F2.test(o)}var Ex=/[\u2028\u2029]/;function sb(o){return Ex.test(o)}function Ho(o){return o>=11904&&o<=55215||o>=63744&&o<=64255||o>=65281&&o<=65374}function zp(o){return o>=127462&&o<=127487||o===8986||o===8987||o===9200||o===9203||o>=9728&&o<=10175||o===11088||o===11093||o>=127744&&o<=128591||o>=128640&&o<=128764||o>=128992&&o<=129008||o>=129280&&o<=129535||o>=129648&&o<=129782}var _k=String.fromCharCode(65279);function Tk(o){return!!(o&&o.length>0&&o.charCodeAt(0)===65279)}function ab(o){let e=26;return o=o%(2*e),o<e?String.fromCharCode(97+o):String.fromCharCode(65+o-e)}function Ck(o,e){return o===0?e!==5&&e!==7:o===2&&e===3?!1:o===4||o===2||o===3||e===4||e===2||e===3?!0:!(o===8&&(e===8||e===9||e===11||e===12)||(o===11||o===9)&&(e===9||e===10)||(o===12||o===10)&&e===10||e===5||e===13||e===7||o===1||o===13&&e===14||o===6&&e===6)}var eb=class o{static _INSTANCE=null;static getInstance(){return o._INSTANCE||(o._INSTANCE=new o),o._INSTANCE}_data;constructor(){this._data=B2()}getGraphemeBreakType(e){if(e<32)return e===10?3:e===13?2:4;if(e<127)return 0;let t=this._data,n=t.length/3,i=1;for(;i<=n;)if(e<t[3*i])i=2*i;else if(e>t[3*i+1])i=2*i+1;else return t[3*i+2];return 0}};function B2(){return JSON.parse("[0,0,0,51229,51255,12,44061,44087,12,127462,127487,6,7083,7085,5,47645,47671,12,54813,54839,12,128678,128678,14,3270,3270,5,9919,9923,14,45853,45879,12,49437,49463,12,53021,53047,12,71216,71218,7,128398,128399,14,129360,129374,14,2519,2519,5,4448,4519,9,9742,9742,14,12336,12336,14,44957,44983,12,46749,46775,12,48541,48567,12,50333,50359,12,52125,52151,12,53917,53943,12,69888,69890,5,73018,73018,5,127990,127990,14,128558,128559,14,128759,128760,14,129653,129655,14,2027,2035,5,2891,2892,7,3761,3761,5,6683,6683,5,8293,8293,4,9825,9826,14,9999,9999,14,43452,43453,5,44509,44535,12,45405,45431,12,46301,46327,12,47197,47223,12,48093,48119,12,48989,49015,12,49885,49911,12,50781,50807,12,51677,51703,12,52573,52599,12,53469,53495,12,54365,54391,12,65279,65279,4,70471,70472,7,72145,72147,7,119173,119179,5,127799,127818,14,128240,128244,14,128512,128512,14,128652,128652,14,128721,128722,14,129292,129292,14,129445,129450,14,129734,129743,14,1476,1477,5,2366,2368,7,2750,2752,7,3076,3076,5,3415,3415,5,4141,4144,5,6109,6109,5,6964,6964,5,7394,7400,5,9197,9198,14,9770,9770,14,9877,9877,14,9968,9969,14,10084,10084,14,43052,43052,5,43713,43713,5,44285,44311,12,44733,44759,12,45181,45207,12,45629,45655,12,46077,46103,12,46525,46551,12,46973,46999,12,47421,47447,12,47869,47895,12,48317,48343,12,48765,48791,12,49213,49239,12,49661,49687,12,50109,50135,12,50557,50583,12,51005,51031,12,51453,51479,12,51901,51927,12,52349,52375,12,52797,52823,12,53245,53271,12,53693,53719,12,54141,54167,12,54589,54615,12,55037,55063,12,69506,69509,5,70191,70193,5,70841,70841,7,71463,71467,5,72330,72342,5,94031,94031,5,123628,123631,5,127763,127765,14,127941,127941,14,128043,128062,14,128302,128317,14,128465,128467,14,128539,128539,14,128640,128640,14,128662,128662,14,128703,128703,14,128745,128745,14,129004,129007,14,129329,129330,14,129402,129402,14,129483,129483,14,129686,129704,14,130048,131069,14,173,173,4,1757,1757,1,2200,2207,5,2434,2435,7,2631,2632,5,2817,2817,5,3008,3008,5,3201,3201,5,3387,3388,5,3542,3542,5,3902,3903,7,4190,4192,5,6002,6003,5,6439,6440,5,6765,6770,7,7019,7027,5,7154,7155,7,8205,8205,13,8505,8505,14,9654,9654,14,9757,9757,14,9792,9792,14,9852,9853,14,9890,9894,14,9937,9937,14,9981,9981,14,10035,10036,14,11035,11036,14,42654,42655,5,43346,43347,7,43587,43587,5,44006,44007,7,44173,44199,12,44397,44423,12,44621,44647,12,44845,44871,12,45069,45095,12,45293,45319,12,45517,45543,12,45741,45767,12,45965,45991,12,46189,46215,12,46413,46439,12,46637,46663,12,46861,46887,12,47085,47111,12,47309,47335,12,47533,47559,12,47757,47783,12,47981,48007,12,48205,48231,12,48429,48455,12,48653,48679,12,48877,48903,12,49101,49127,12,49325,49351,12,49549,49575,12,49773,49799,12,49997,50023,12,50221,50247,12,50445,50471,12,50669,50695,12,50893,50919,12,51117,51143,12,51341,51367,12,51565,51591,12,51789,51815,12,52013,52039,12,52237,52263,12,52461,52487,12,52685,52711,12,52909,52935,12,53133,53159,12,53357,53383,12,53581,53607,12,53805,53831,12,54029,54055,12,54253,54279,12,54477,54503,12,54701,54727,12,54925,54951,12,55149,55175,12,68101,68102,5,69762,69762,7,70067,70069,7,70371,70378,5,70720,70721,7,71087,71087,5,71341,71341,5,71995,71996,5,72249,72249,7,72850,72871,5,73109,73109,5,118576,118598,5,121505,121519,5,127245,127247,14,127568,127569,14,127777,127777,14,127872,127891,14,127956,127967,14,128015,128016,14,128110,128172,14,128259,128259,14,128367,128368,14,128424,128424,14,128488,128488,14,128530,128532,14,128550,128551,14,128566,128566,14,128647,128647,14,128656,128656,14,128667,128673,14,128691,128693,14,128715,128715,14,128728,128732,14,128752,128752,14,128765,128767,14,129096,129103,14,129311,129311,14,129344,129349,14,129394,129394,14,129413,129425,14,129466,129471,14,129511,129535,14,129664,129666,14,129719,129722,14,129760,129767,14,917536,917631,5,13,13,2,1160,1161,5,1564,1564,4,1807,1807,1,2085,2087,5,2307,2307,7,2382,2383,7,2497,2500,5,2563,2563,7,2677,2677,5,2763,2764,7,2879,2879,5,2914,2915,5,3021,3021,5,3142,3144,5,3263,3263,5,3285,3286,5,3398,3400,7,3530,3530,5,3633,3633,5,3864,3865,5,3974,3975,5,4155,4156,7,4229,4230,5,5909,5909,7,6078,6085,7,6277,6278,5,6451,6456,7,6744,6750,5,6846,6846,5,6972,6972,5,7074,7077,5,7146,7148,7,7222,7223,5,7416,7417,5,8234,8238,4,8417,8417,5,9000,9000,14,9203,9203,14,9730,9731,14,9748,9749,14,9762,9763,14,9776,9783,14,9800,9811,14,9831,9831,14,9872,9873,14,9882,9882,14,9900,9903,14,9929,9933,14,9941,9960,14,9974,9974,14,9989,9989,14,10006,10006,14,10062,10062,14,10160,10160,14,11647,11647,5,12953,12953,14,43019,43019,5,43232,43249,5,43443,43443,5,43567,43568,7,43696,43696,5,43765,43765,7,44013,44013,5,44117,44143,12,44229,44255,12,44341,44367,12,44453,44479,12,44565,44591,12,44677,44703,12,44789,44815,12,44901,44927,12,45013,45039,12,45125,45151,12,45237,45263,12,45349,45375,12,45461,45487,12,45573,45599,12,45685,45711,12,45797,45823,12,45909,45935,12,46021,46047,12,46133,46159,12,46245,46271,12,46357,46383,12,46469,46495,12,46581,46607,12,46693,46719,12,46805,46831,12,46917,46943,12,47029,47055,12,47141,47167,12,47253,47279,12,47365,47391,12,47477,47503,12,47589,47615,12,47701,47727,12,47813,47839,12,47925,47951,12,48037,48063,12,48149,48175,12,48261,48287,12,48373,48399,12,48485,48511,12,48597,48623,12,48709,48735,12,48821,48847,12,48933,48959,12,49045,49071,12,49157,49183,12,49269,49295,12,49381,49407,12,49493,49519,12,49605,49631,12,49717,49743,12,49829,49855,12,49941,49967,12,50053,50079,12,50165,50191,12,50277,50303,12,50389,50415,12,50501,50527,12,50613,50639,12,50725,50751,12,50837,50863,12,50949,50975,12,51061,51087,12,51173,51199,12,51285,51311,12,51397,51423,12,51509,51535,12,51621,51647,12,51733,51759,12,51845,51871,12,51957,51983,12,52069,52095,12,52181,52207,12,52293,52319,12,52405,52431,12,52517,52543,12,52629,52655,12,52741,52767,12,52853,52879,12,52965,52991,12,53077,53103,12,53189,53215,12,53301,53327,12,53413,53439,12,53525,53551,12,53637,53663,12,53749,53775,12,53861,53887,12,53973,53999,12,54085,54111,12,54197,54223,12,54309,54335,12,54421,54447,12,54533,54559,12,54645,54671,12,54757,54783,12,54869,54895,12,54981,55007,12,55093,55119,12,55243,55291,10,66045,66045,5,68325,68326,5,69688,69702,5,69817,69818,5,69957,69958,7,70089,70092,5,70198,70199,5,70462,70462,5,70502,70508,5,70750,70750,5,70846,70846,7,71100,71101,5,71230,71230,7,71351,71351,5,71737,71738,5,72000,72000,7,72160,72160,5,72273,72278,5,72752,72758,5,72882,72883,5,73031,73031,5,73461,73462,7,94192,94193,7,119149,119149,7,121403,121452,5,122915,122916,5,126980,126980,14,127358,127359,14,127535,127535,14,127759,127759,14,127771,127771,14,127792,127793,14,127825,127867,14,127897,127899,14,127945,127945,14,127985,127986,14,128000,128007,14,128021,128021,14,128066,128100,14,128184,128235,14,128249,128252,14,128266,128276,14,128335,128335,14,128379,128390,14,128407,128419,14,128444,128444,14,128481,128481,14,128499,128499,14,128526,128526,14,128536,128536,14,128543,128543,14,128556,128556,14,128564,128564,14,128577,128580,14,128643,128645,14,128649,128649,14,128654,128654,14,128660,128660,14,128664,128664,14,128675,128675,14,128686,128689,14,128695,128696,14,128705,128709,14,128717,128719,14,128725,128725,14,128736,128741,14,128747,128748,14,128755,128755,14,128762,128762,14,128981,128991,14,129009,129023,14,129160,129167,14,129296,129304,14,129320,129327,14,129340,129342,14,129356,129356,14,129388,129392,14,129399,129400,14,129404,129407,14,129432,129442,14,129454,129455,14,129473,129474,14,129485,129487,14,129648,129651,14,129659,129660,14,129671,129679,14,129709,129711,14,129728,129730,14,129751,129753,14,129776,129782,14,917505,917505,4,917760,917999,5,10,10,3,127,159,4,768,879,5,1471,1471,5,1536,1541,1,1648,1648,5,1767,1768,5,1840,1866,5,2070,2073,5,2137,2139,5,2274,2274,1,2363,2363,7,2377,2380,7,2402,2403,5,2494,2494,5,2507,2508,7,2558,2558,5,2622,2624,7,2641,2641,5,2691,2691,7,2759,2760,5,2786,2787,5,2876,2876,5,2881,2884,5,2901,2902,5,3006,3006,5,3014,3016,7,3072,3072,5,3134,3136,5,3157,3158,5,3260,3260,5,3266,3266,5,3274,3275,7,3328,3329,5,3391,3392,7,3405,3405,5,3457,3457,5,3536,3537,7,3551,3551,5,3636,3642,5,3764,3772,5,3895,3895,5,3967,3967,7,3993,4028,5,4146,4151,5,4182,4183,7,4226,4226,5,4253,4253,5,4957,4959,5,5940,5940,7,6070,6070,7,6087,6088,7,6158,6158,4,6432,6434,5,6448,6449,7,6679,6680,5,6742,6742,5,6754,6754,5,6783,6783,5,6912,6915,5,6966,6970,5,6978,6978,5,7042,7042,7,7080,7081,5,7143,7143,7,7150,7150,7,7212,7219,5,7380,7392,5,7412,7412,5,8203,8203,4,8232,8232,4,8265,8265,14,8400,8412,5,8421,8432,5,8617,8618,14,9167,9167,14,9200,9200,14,9410,9410,14,9723,9726,14,9733,9733,14,9745,9745,14,9752,9752,14,9760,9760,14,9766,9766,14,9774,9774,14,9786,9786,14,9794,9794,14,9823,9823,14,9828,9828,14,9833,9850,14,9855,9855,14,9875,9875,14,9880,9880,14,9885,9887,14,9896,9897,14,9906,9916,14,9926,9927,14,9935,9935,14,9939,9939,14,9962,9962,14,9972,9972,14,9978,9978,14,9986,9986,14,9997,9997,14,10002,10002,14,10017,10017,14,10055,10055,14,10071,10071,14,10133,10135,14,10548,10549,14,11093,11093,14,12330,12333,5,12441,12442,5,42608,42610,5,43010,43010,5,43045,43046,5,43188,43203,7,43302,43309,5,43392,43394,5,43446,43449,5,43493,43493,5,43571,43572,7,43597,43597,7,43703,43704,5,43756,43757,5,44003,44004,7,44009,44010,7,44033,44059,12,44089,44115,12,44145,44171,12,44201,44227,12,44257,44283,12,44313,44339,12,44369,44395,12,44425,44451,12,44481,44507,12,44537,44563,12,44593,44619,12,44649,44675,12,44705,44731,12,44761,44787,12,44817,44843,12,44873,44899,12,44929,44955,12,44985,45011,12,45041,45067,12,45097,45123,12,45153,45179,12,45209,45235,12,45265,45291,12,45321,45347,12,45377,45403,12,45433,45459,12,45489,45515,12,45545,45571,12,45601,45627,12,45657,45683,12,45713,45739,12,45769,45795,12,45825,45851,12,45881,45907,12,45937,45963,12,45993,46019,12,46049,46075,12,46105,46131,12,46161,46187,12,46217,46243,12,46273,46299,12,46329,46355,12,46385,46411,12,46441,46467,12,46497,46523,12,46553,46579,12,46609,46635,12,46665,46691,12,46721,46747,12,46777,46803,12,46833,46859,12,46889,46915,12,46945,46971,12,47001,47027,12,47057,47083,12,47113,47139,12,47169,47195,12,47225,47251,12,47281,47307,12,47337,47363,12,47393,47419,12,47449,47475,12,47505,47531,12,47561,47587,12,47617,47643,12,47673,47699,12,47729,47755,12,47785,47811,12,47841,47867,12,47897,47923,12,47953,47979,12,48009,48035,12,48065,48091,12,48121,48147,12,48177,48203,12,48233,48259,12,48289,48315,12,48345,48371,12,48401,48427,12,48457,48483,12,48513,48539,12,48569,48595,12,48625,48651,12,48681,48707,12,48737,48763,12,48793,48819,12,48849,48875,12,48905,48931,12,48961,48987,12,49017,49043,12,49073,49099,12,49129,49155,12,49185,49211,12,49241,49267,12,49297,49323,12,49353,49379,12,49409,49435,12,49465,49491,12,49521,49547,12,49577,49603,12,49633,49659,12,49689,49715,12,49745,49771,12,49801,49827,12,49857,49883,12,49913,49939,12,49969,49995,12,50025,50051,12,50081,50107,12,50137,50163,12,50193,50219,12,50249,50275,12,50305,50331,12,50361,50387,12,50417,50443,12,50473,50499,12,50529,50555,12,50585,50611,12,50641,50667,12,50697,50723,12,50753,50779,12,50809,50835,12,50865,50891,12,50921,50947,12,50977,51003,12,51033,51059,12,51089,51115,12,51145,51171,12,51201,51227,12,51257,51283,12,51313,51339,12,51369,51395,12,51425,51451,12,51481,51507,12,51537,51563,12,51593,51619,12,51649,51675,12,51705,51731,12,51761,51787,12,51817,51843,12,51873,51899,12,51929,51955,12,51985,52011,12,52041,52067,12,52097,52123,12,52153,52179,12,52209,52235,12,52265,52291,12,52321,52347,12,52377,52403,12,52433,52459,12,52489,52515,12,52545,52571,12,52601,52627,12,52657,52683,12,52713,52739,12,52769,52795,12,52825,52851,12,52881,52907,12,52937,52963,12,52993,53019,12,53049,53075,12,53105,53131,12,53161,53187,12,53217,53243,12,53273,53299,12,53329,53355,12,53385,53411,12,53441,53467,12,53497,53523,12,53553,53579,12,53609,53635,12,53665,53691,12,53721,53747,12,53777,53803,12,53833,53859,12,53889,53915,12,53945,53971,12,54001,54027,12,54057,54083,12,54113,54139,12,54169,54195,12,54225,54251,12,54281,54307,12,54337,54363,12,54393,54419,12,54449,54475,12,54505,54531,12,54561,54587,12,54617,54643,12,54673,54699,12,54729,54755,12,54785,54811,12,54841,54867,12,54897,54923,12,54953,54979,12,55009,55035,12,55065,55091,12,55121,55147,12,55177,55203,12,65024,65039,5,65520,65528,4,66422,66426,5,68152,68154,5,69291,69292,5,69633,69633,5,69747,69748,5,69811,69814,5,69826,69826,5,69932,69932,7,70016,70017,5,70079,70080,7,70095,70095,5,70196,70196,5,70367,70367,5,70402,70403,7,70464,70464,5,70487,70487,5,70709,70711,7,70725,70725,7,70833,70834,7,70843,70844,7,70849,70849,7,71090,71093,5,71103,71104,5,71227,71228,7,71339,71339,5,71344,71349,5,71458,71461,5,71727,71735,5,71985,71989,7,71998,71998,5,72002,72002,7,72154,72155,5,72193,72202,5,72251,72254,5,72281,72283,5,72344,72345,5,72766,72766,7,72874,72880,5,72885,72886,5,73023,73029,5,73104,73105,5,73111,73111,5,92912,92916,5,94095,94098,5,113824,113827,4,119142,119142,7,119155,119162,4,119362,119364,5,121476,121476,5,122888,122904,5,123184,123190,5,125252,125258,5,127183,127183,14,127340,127343,14,127377,127386,14,127491,127503,14,127548,127551,14,127744,127756,14,127761,127761,14,127769,127769,14,127773,127774,14,127780,127788,14,127796,127797,14,127820,127823,14,127869,127869,14,127894,127895,14,127902,127903,14,127943,127943,14,127947,127950,14,127972,127972,14,127988,127988,14,127992,127994,14,128009,128011,14,128019,128019,14,128023,128041,14,128064,128064,14,128102,128107,14,128174,128181,14,128238,128238,14,128246,128247,14,128254,128254,14,128264,128264,14,128278,128299,14,128329,128330,14,128348,128359,14,128371,128377,14,128392,128393,14,128401,128404,14,128421,128421,14,128433,128434,14,128450,128452,14,128476,128478,14,128483,128483,14,128495,128495,14,128506,128506,14,128519,128520,14,128528,128528,14,128534,128534,14,128538,128538,14,128540,128542,14,128544,128549,14,128552,128555,14,128557,128557,14,128560,128563,14,128565,128565,14,128567,128576,14,128581,128591,14,128641,128642,14,128646,128646,14,128648,128648,14,128650,128651,14,128653,128653,14,128655,128655,14,128657,128659,14,128661,128661,14,128663,128663,14,128665,128666,14,128674,128674,14,128676,128677,14,128679,128685,14,128690,128690,14,128694,128694,14,128697,128702,14,128704,128704,14,128710,128714,14,128716,128716,14,128720,128720,14,128723,128724,14,128726,128727,14,128733,128735,14,128742,128744,14,128746,128746,14,128749,128751,14,128753,128754,14,128756,128758,14,128761,128761,14,128763,128764,14,128884,128895,14,128992,129003,14,129008,129008,14,129036,129039,14,129114,129119,14,129198,129279,14,129293,129295,14,129305,129310,14,129312,129319,14,129328,129328,14,129331,129338,14,129343,129343,14,129351,129355,14,129357,129359,14,129375,129387,14,129393,129393,14,129395,129398,14,129401,129401,14,129403,129403,14,129408,129412,14,129426,129431,14,129443,129444,14,129451,129453,14,129456,129465,14,129472,129472,14,129475,129482,14,129484,129484,14,129488,129510,14,129536,129647,14,129652,129652,14,129656,129658,14,129661,129663,14,129667,129670,14,129680,129685,14,129705,129708,14,129712,129718,14,129723,129727,14,129731,129733,14,129744,129750,14,129754,129759,14,129768,129775,14,129783,129791,14,917504,917504,4,917506,917535,4,917632,917759,4,918000,921599,4,0,9,4,11,12,4,14,31,4,169,169,14,174,174,14,1155,1159,5,1425,1469,5,1473,1474,5,1479,1479,5,1552,1562,5,1611,1631,5,1750,1756,5,1759,1764,5,1770,1773,5,1809,1809,5,1958,1968,5,2045,2045,5,2075,2083,5,2089,2093,5,2192,2193,1,2250,2273,5,2275,2306,5,2362,2362,5,2364,2364,5,2369,2376,5,2381,2381,5,2385,2391,5,2433,2433,5,2492,2492,5,2495,2496,7,2503,2504,7,2509,2509,5,2530,2531,5,2561,2562,5,2620,2620,5,2625,2626,5,2635,2637,5,2672,2673,5,2689,2690,5,2748,2748,5,2753,2757,5,2761,2761,7,2765,2765,5,2810,2815,5,2818,2819,7,2878,2878,5,2880,2880,7,2887,2888,7,2893,2893,5,2903,2903,5,2946,2946,5,3007,3007,7,3009,3010,7,3018,3020,7,3031,3031,5,3073,3075,7,3132,3132,5,3137,3140,7,3146,3149,5,3170,3171,5,3202,3203,7,3262,3262,7,3264,3265,7,3267,3268,7,3271,3272,7,3276,3277,5,3298,3299,5,3330,3331,7,3390,3390,5,3393,3396,5,3402,3404,7,3406,3406,1,3426,3427,5,3458,3459,7,3535,3535,5,3538,3540,5,3544,3550,7,3570,3571,7,3635,3635,7,3655,3662,5,3763,3763,7,3784,3789,5,3893,3893,5,3897,3897,5,3953,3966,5,3968,3972,5,3981,3991,5,4038,4038,5,4145,4145,7,4153,4154,5,4157,4158,5,4184,4185,5,4209,4212,5,4228,4228,7,4237,4237,5,4352,4447,8,4520,4607,10,5906,5908,5,5938,5939,5,5970,5971,5,6068,6069,5,6071,6077,5,6086,6086,5,6089,6099,5,6155,6157,5,6159,6159,5,6313,6313,5,6435,6438,7,6441,6443,7,6450,6450,5,6457,6459,5,6681,6682,7,6741,6741,7,6743,6743,7,6752,6752,5,6757,6764,5,6771,6780,5,6832,6845,5,6847,6862,5,6916,6916,7,6965,6965,5,6971,6971,7,6973,6977,7,6979,6980,7,7040,7041,5,7073,7073,7,7078,7079,7,7082,7082,7,7142,7142,5,7144,7145,5,7149,7149,5,7151,7153,5,7204,7211,7,7220,7221,7,7376,7378,5,7393,7393,7,7405,7405,5,7415,7415,7,7616,7679,5,8204,8204,5,8206,8207,4,8233,8233,4,8252,8252,14,8288,8292,4,8294,8303,4,8413,8416,5,8418,8420,5,8482,8482,14,8596,8601,14,8986,8987,14,9096,9096,14,9193,9196,14,9199,9199,14,9201,9202,14,9208,9210,14,9642,9643,14,9664,9664,14,9728,9729,14,9732,9732,14,9735,9741,14,9743,9744,14,9746,9746,14,9750,9751,14,9753,9756,14,9758,9759,14,9761,9761,14,9764,9765,14,9767,9769,14,9771,9773,14,9775,9775,14,9784,9785,14,9787,9791,14,9793,9793,14,9795,9799,14,9812,9822,14,9824,9824,14,9827,9827,14,9829,9830,14,9832,9832,14,9851,9851,14,9854,9854,14,9856,9861,14,9874,9874,14,9876,9876,14,9878,9879,14,9881,9881,14,9883,9884,14,9888,9889,14,9895,9895,14,9898,9899,14,9904,9905,14,9917,9918,14,9924,9925,14,9928,9928,14,9934,9934,14,9936,9936,14,9938,9938,14,9940,9940,14,9961,9961,14,9963,9967,14,9970,9971,14,9973,9973,14,9975,9977,14,9979,9980,14,9982,9985,14,9987,9988,14,9992,9996,14,9998,9998,14,10000,10001,14,10004,10004,14,10013,10013,14,10024,10024,14,10052,10052,14,10060,10060,14,10067,10069,14,10083,10083,14,10085,10087,14,10145,10145,14,10175,10175,14,11013,11015,14,11088,11088,14,11503,11505,5,11744,11775,5,12334,12335,5,12349,12349,14,12951,12951,14,42607,42607,5,42612,42621,5,42736,42737,5,43014,43014,5,43043,43044,7,43047,43047,7,43136,43137,7,43204,43205,5,43263,43263,5,43335,43345,5,43360,43388,8,43395,43395,7,43444,43445,7,43450,43451,7,43454,43456,7,43561,43566,5,43569,43570,5,43573,43574,5,43596,43596,5,43644,43644,5,43698,43700,5,43710,43711,5,43755,43755,7,43758,43759,7,43766,43766,5,44005,44005,5,44008,44008,5,44012,44012,7,44032,44032,11,44060,44060,11,44088,44088,11,44116,44116,11,44144,44144,11,44172,44172,11,44200,44200,11,44228,44228,11,44256,44256,11,44284,44284,11,44312,44312,11,44340,44340,11,44368,44368,11,44396,44396,11,44424,44424,11,44452,44452,11,44480,44480,11,44508,44508,11,44536,44536,11,44564,44564,11,44592,44592,11,44620,44620,11,44648,44648,11,44676,44676,11,44704,44704,11,44732,44732,11,44760,44760,11,44788,44788,11,44816,44816,11,44844,44844,11,44872,44872,11,44900,44900,11,44928,44928,11,44956,44956,11,44984,44984,11,45012,45012,11,45040,45040,11,45068,45068,11,45096,45096,11,45124,45124,11,45152,45152,11,45180,45180,11,45208,45208,11,45236,45236,11,45264,45264,11,45292,45292,11,45320,45320,11,45348,45348,11,45376,45376,11,45404,45404,11,45432,45432,11,45460,45460,11,45488,45488,11,45516,45516,11,45544,45544,11,45572,45572,11,45600,45600,11,45628,45628,11,45656,45656,11,45684,45684,11,45712,45712,11,45740,45740,11,45768,45768,11,45796,45796,11,45824,45824,11,45852,45852,11,45880,45880,11,45908,45908,11,45936,45936,11,45964,45964,11,45992,45992,11,46020,46020,11,46048,46048,11,46076,46076,11,46104,46104,11,46132,46132,11,46160,46160,11,46188,46188,11,46216,46216,11,46244,46244,11,46272,46272,11,46300,46300,11,46328,46328,11,46356,46356,11,46384,46384,11,46412,46412,11,46440,46440,11,46468,46468,11,46496,46496,11,46524,46524,11,46552,46552,11,46580,46580,11,46608,46608,11,46636,46636,11,46664,46664,11,46692,46692,11,46720,46720,11,46748,46748,11,46776,46776,11,46804,46804,11,46832,46832,11,46860,46860,11,46888,46888,11,46916,46916,11,46944,46944,11,46972,46972,11,47000,47000,11,47028,47028,11,47056,47056,11,47084,47084,11,47112,47112,11,47140,47140,11,47168,47168,11,47196,47196,11,47224,47224,11,47252,47252,11,47280,47280,11,47308,47308,11,47336,47336,11,47364,47364,11,47392,47392,11,47420,47420,11,47448,47448,11,47476,47476,11,47504,47504,11,47532,47532,11,47560,47560,11,47588,47588,11,47616,47616,11,47644,47644,11,47672,47672,11,47700,47700,11,47728,47728,11,47756,47756,11,47784,47784,11,47812,47812,11,47840,47840,11,47868,47868,11,47896,47896,11,47924,47924,11,47952,47952,11,47980,47980,11,48008,48008,11,48036,48036,11,48064,48064,11,48092,48092,11,48120,48120,11,48148,48148,11,48176,48176,11,48204,48204,11,48232,48232,11,48260,48260,11,48288,48288,11,48316,48316,11,48344,48344,11,48372,48372,11,48400,48400,11,48428,48428,11,48456,48456,11,48484,48484,11,48512,48512,11,48540,48540,11,48568,48568,11,48596,48596,11,48624,48624,11,48652,48652,11,48680,48680,11,48708,48708,11,48736,48736,11,48764,48764,11,48792,48792,11,48820,48820,11,48848,48848,11,48876,48876,11,48904,48904,11,48932,48932,11,48960,48960,11,48988,48988,11,49016,49016,11,49044,49044,11,49072,49072,11,49100,49100,11,49128,49128,11,49156,49156,11,49184,49184,11,49212,49212,11,49240,49240,11,49268,49268,11,49296,49296,11,49324,49324,11,49352,49352,11,49380,49380,11,49408,49408,11,49436,49436,11,49464,49464,11,49492,49492,11,49520,49520,11,49548,49548,11,49576,49576,11,49604,49604,11,49632,49632,11,49660,49660,11,49688,49688,11,49716,49716,11,49744,49744,11,49772,49772,11,49800,49800,11,49828,49828,11,49856,49856,11,49884,49884,11,49912,49912,11,49940,49940,11,49968,49968,11,49996,49996,11,50024,50024,11,50052,50052,11,50080,50080,11,50108,50108,11,50136,50136,11,50164,50164,11,50192,50192,11,50220,50220,11,50248,50248,11,50276,50276,11,50304,50304,11,50332,50332,11,50360,50360,11,50388,50388,11,50416,50416,11,50444,50444,11,50472,50472,11,50500,50500,11,50528,50528,11,50556,50556,11,50584,50584,11,50612,50612,11,50640,50640,11,50668,50668,11,50696,50696,11,50724,50724,11,50752,50752,11,50780,50780,11,50808,50808,11,50836,50836,11,50864,50864,11,50892,50892,11,50920,50920,11,50948,50948,11,50976,50976,11,51004,51004,11,51032,51032,11,51060,51060,11,51088,51088,11,51116,51116,11,51144,51144,11,51172,51172,11,51200,51200,11,51228,51228,11,51256,51256,11,51284,51284,11,51312,51312,11,51340,51340,11,51368,51368,11,51396,51396,11,51424,51424,11,51452,51452,11,51480,51480,11,51508,51508,11,51536,51536,11,51564,51564,11,51592,51592,11,51620,51620,11,51648,51648,11,51676,51676,11,51704,51704,11,51732,51732,11,51760,51760,11,51788,51788,11,51816,51816,11,51844,51844,11,51872,51872,11,51900,51900,11,51928,51928,11,51956,51956,11,51984,51984,11,52012,52012,11,52040,52040,11,52068,52068,11,52096,52096,11,52124,52124,11,52152,52152,11,52180,52180,11,52208,52208,11,52236,52236,11,52264,52264,11,52292,52292,11,52320,52320,11,52348,52348,11,52376,52376,11,52404,52404,11,52432,52432,11,52460,52460,11,52488,52488,11,52516,52516,11,52544,52544,11,52572,52572,11,52600,52600,11,52628,52628,11,52656,52656,11,52684,52684,11,52712,52712,11,52740,52740,11,52768,52768,11,52796,52796,11,52824,52824,11,52852,52852,11,52880,52880,11,52908,52908,11,52936,52936,11,52964,52964,11,52992,52992,11,53020,53020,11,53048,53048,11,53076,53076,11,53104,53104,11,53132,53132,11,53160,53160,11,53188,53188,11,53216,53216,11,53244,53244,11,53272,53272,11,53300,53300,11,53328,53328,11,53356,53356,11,53384,53384,11,53412,53412,11,53440,53440,11,53468,53468,11,53496,53496,11,53524,53524,11,53552,53552,11,53580,53580,11,53608,53608,11,53636,53636,11,53664,53664,11,53692,53692,11,53720,53720,11,53748,53748,11,53776,53776,11,53804,53804,11,53832,53832,11,53860,53860,11,53888,53888,11,53916,53916,11,53944,53944,11,53972,53972,11,54000,54000,11,54028,54028,11,54056,54056,11,54084,54084,11,54112,54112,11,54140,54140,11,54168,54168,11,54196,54196,11,54224,54224,11,54252,54252,11,54280,54280,11,54308,54308,11,54336,54336,11,54364,54364,11,54392,54392,11,54420,54420,11,54448,54448,11,54476,54476,11,54504,54504,11,54532,54532,11,54560,54560,11,54588,54588,11,54616,54616,11,54644,54644,11,54672,54672,11,54700,54700,11,54728,54728,11,54756,54756,11,54784,54784,11,54812,54812,11,54840,54840,11,54868,54868,11,54896,54896,11,54924,54924,11,54952,54952,11,54980,54980,11,55008,55008,11,55036,55036,11,55064,55064,11,55092,55092,11,55120,55120,11,55148,55148,11,55176,55176,11,55216,55238,9,64286,64286,5,65056,65071,5,65438,65439,5,65529,65531,4,66272,66272,5,68097,68099,5,68108,68111,5,68159,68159,5,68900,68903,5,69446,69456,5,69632,69632,7,69634,69634,7,69744,69744,5,69759,69761,5,69808,69810,7,69815,69816,7,69821,69821,1,69837,69837,1,69927,69931,5,69933,69940,5,70003,70003,5,70018,70018,7,70070,70078,5,70082,70083,1,70094,70094,7,70188,70190,7,70194,70195,7,70197,70197,7,70206,70206,5,70368,70370,7,70400,70401,5,70459,70460,5,70463,70463,7,70465,70468,7,70475,70477,7,70498,70499,7,70512,70516,5,70712,70719,5,70722,70724,5,70726,70726,5,70832,70832,5,70835,70840,5,70842,70842,5,70845,70845,5,70847,70848,5,70850,70851,5,71088,71089,7,71096,71099,7,71102,71102,7,71132,71133,5,71219,71226,5,71229,71229,5,71231,71232,5,71340,71340,7,71342,71343,7,71350,71350,7,71453,71455,5,71462,71462,7,71724,71726,7,71736,71736,7,71984,71984,5,71991,71992,7,71997,71997,7,71999,71999,1,72001,72001,1,72003,72003,5,72148,72151,5,72156,72159,7,72164,72164,7,72243,72248,5,72250,72250,1,72263,72263,5,72279,72280,7,72324,72329,1,72343,72343,7,72751,72751,7,72760,72765,5,72767,72767,5,72873,72873,7,72881,72881,7,72884,72884,7,73009,73014,5,73020,73021,5,73030,73030,1,73098,73102,7,73107,73108,7,73110,73110,7,73459,73460,5,78896,78904,4,92976,92982,5,94033,94087,7,94180,94180,5,113821,113822,5,118528,118573,5,119141,119141,5,119143,119145,5,119150,119154,5,119163,119170,5,119210,119213,5,121344,121398,5,121461,121461,5,121499,121503,5,122880,122886,5,122907,122913,5,122918,122922,5,123566,123566,5,125136,125142,5,126976,126979,14,126981,127182,14,127184,127231,14,127279,127279,14,127344,127345,14,127374,127374,14,127405,127461,14,127489,127490,14,127514,127514,14,127538,127546,14,127561,127567,14,127570,127743,14,127757,127758,14,127760,127760,14,127762,127762,14,127766,127768,14,127770,127770,14,127772,127772,14,127775,127776,14,127778,127779,14,127789,127791,14,127794,127795,14,127798,127798,14,127819,127819,14,127824,127824,14,127868,127868,14,127870,127871,14,127892,127893,14,127896,127896,14,127900,127901,14,127904,127940,14,127942,127942,14,127944,127944,14,127946,127946,14,127951,127955,14,127968,127971,14,127973,127984,14,127987,127987,14,127989,127989,14,127991,127991,14,127995,127999,5,128008,128008,14,128012,128014,14,128017,128018,14,128020,128020,14,128022,128022,14,128042,128042,14,128063,128063,14,128065,128065,14,128101,128101,14,128108,128109,14,128173,128173,14,128182,128183,14,128236,128237,14,128239,128239,14,128245,128245,14,128248,128248,14,128253,128253,14,128255,128258,14,128260,128263,14,128265,128265,14,128277,128277,14,128300,128301,14,128326,128328,14,128331,128334,14,128336,128347,14,128360,128366,14,128369,128370,14,128378,128378,14,128391,128391,14,128394,128397,14,128400,128400,14,128405,128406,14,128420,128420,14,128422,128423,14,128425,128432,14,128435,128443,14,128445,128449,14,128453,128464,14,128468,128475,14,128479,128480,14,128482,128482,14,128484,128487,14,128489,128494,14,128496,128498,14,128500,128505,14,128507,128511,14,128513,128518,14,128521,128525,14,128527,128527,14,128529,128529,14,128533,128533,14,128535,128535,14,128537,128537,14]")}function Lk(o,e){if(o===0)return 0;let t=V2(o,e);if(t!==void 0)return t;let n=new ud(e,o);return n.prevCodePoint(),n.offset}function V2(o,e){let t=new ud(e,o),n=t.prevCodePoint();for(;W2(n)||n===65039||n===8419;){if(t.offset===0)return;n=t.prevCodePoint()}if(!zp(n))return;let i=t.offset;return i>0&&t.prevCodePoint()===8205&&(i=t.offset),i}function W2(o){return 127995<=o&&o<=127999}var Sk=class o{constructor(e){this.confusableDictionary=e}static ambiguousCharacterData=new vi(()=>JSON.parse('{"_common":[8232,32,8233,32,5760,32,8192,32,8193,32,8194,32,8195,32,8196,32,8197,32,8198,32,8200,32,8201,32,8202,32,8287,32,8199,32,8239,32,2042,95,65101,95,65102,95,65103,95,8208,45,8209,45,8210,45,65112,45,1748,45,8259,45,727,45,8722,45,10134,45,11450,45,1549,44,1643,44,8218,44,184,44,42233,44,894,59,2307,58,2691,58,1417,58,1795,58,1796,58,5868,58,65072,58,6147,58,6153,58,8282,58,1475,58,760,58,42889,58,8758,58,720,58,42237,58,451,33,11601,33,660,63,577,63,2429,63,5038,63,42731,63,119149,46,8228,46,1793,46,1794,46,42510,46,68176,46,1632,46,1776,46,42232,46,1373,96,65287,96,8219,96,8242,96,1370,96,1523,96,8175,96,65344,96,900,96,8189,96,8125,96,8127,96,8190,96,697,96,884,96,712,96,714,96,715,96,756,96,699,96,701,96,700,96,702,96,42892,96,1497,96,2036,96,2037,96,5194,96,5836,96,94033,96,94034,96,65339,91,10088,40,10098,40,12308,40,64830,40,65341,93,10089,41,10099,41,12309,41,64831,41,10100,123,119060,123,10101,125,65342,94,8270,42,1645,42,8727,42,66335,42,5941,47,8257,47,8725,47,8260,47,9585,47,10187,47,10744,47,119354,47,12755,47,12339,47,11462,47,20031,47,12035,47,65340,92,65128,92,8726,92,10189,92,10741,92,10745,92,119311,92,119355,92,12756,92,20022,92,12034,92,42872,38,708,94,710,94,5869,43,10133,43,66203,43,8249,60,10094,60,706,60,119350,60,5176,60,5810,60,5120,61,11840,61,12448,61,42239,61,8250,62,10095,62,707,62,119351,62,5171,62,94015,62,8275,126,732,126,8128,126,8764,126,65372,124,65293,45,120784,50,120794,50,120804,50,120814,50,120824,50,130034,50,42842,50,423,50,1000,50,42564,50,5311,50,42735,50,119302,51,120785,51,120795,51,120805,51,120815,51,120825,51,130035,51,42923,51,540,51,439,51,42858,51,11468,51,1248,51,94011,51,71882,51,120786,52,120796,52,120806,52,120816,52,120826,52,130036,52,5070,52,71855,52,120787,53,120797,53,120807,53,120817,53,120827,53,130037,53,444,53,71867,53,120788,54,120798,54,120808,54,120818,54,120828,54,130038,54,11474,54,5102,54,71893,54,119314,55,120789,55,120799,55,120809,55,120819,55,120829,55,130039,55,66770,55,71878,55,2819,56,2538,56,2666,56,125131,56,120790,56,120800,56,120810,56,120820,56,120830,56,130040,56,547,56,546,56,66330,56,2663,57,2920,57,2541,57,3437,57,120791,57,120801,57,120811,57,120821,57,120831,57,130041,57,42862,57,11466,57,71884,57,71852,57,71894,57,9082,97,65345,97,119834,97,119886,97,119938,97,119990,97,120042,97,120094,97,120146,97,120198,97,120250,97,120302,97,120354,97,120406,97,120458,97,593,97,945,97,120514,97,120572,97,120630,97,120688,97,120746,97,65313,65,119808,65,119860,65,119912,65,119964,65,120016,65,120068,65,120120,65,120172,65,120224,65,120276,65,120328,65,120380,65,120432,65,913,65,120488,65,120546,65,120604,65,120662,65,120720,65,5034,65,5573,65,42222,65,94016,65,66208,65,119835,98,119887,98,119939,98,119991,98,120043,98,120095,98,120147,98,120199,98,120251,98,120303,98,120355,98,120407,98,120459,98,388,98,5071,98,5234,98,5551,98,65314,66,8492,66,119809,66,119861,66,119913,66,120017,66,120069,66,120121,66,120173,66,120225,66,120277,66,120329,66,120381,66,120433,66,42932,66,914,66,120489,66,120547,66,120605,66,120663,66,120721,66,5108,66,5623,66,42192,66,66178,66,66209,66,66305,66,65347,99,8573,99,119836,99,119888,99,119940,99,119992,99,120044,99,120096,99,120148,99,120200,99,120252,99,120304,99,120356,99,120408,99,120460,99,7428,99,1010,99,11429,99,43951,99,66621,99,128844,67,71922,67,71913,67,65315,67,8557,67,8450,67,8493,67,119810,67,119862,67,119914,67,119966,67,120018,67,120174,67,120226,67,120278,67,120330,67,120382,67,120434,67,1017,67,11428,67,5087,67,42202,67,66210,67,66306,67,66581,67,66844,67,8574,100,8518,100,119837,100,119889,100,119941,100,119993,100,120045,100,120097,100,120149,100,120201,100,120253,100,120305,100,120357,100,120409,100,120461,100,1281,100,5095,100,5231,100,42194,100,8558,68,8517,68,119811,68,119863,68,119915,68,119967,68,120019,68,120071,68,120123,68,120175,68,120227,68,120279,68,120331,68,120383,68,120435,68,5024,68,5598,68,5610,68,42195,68,8494,101,65349,101,8495,101,8519,101,119838,101,119890,101,119942,101,120046,101,120098,101,120150,101,120202,101,120254,101,120306,101,120358,101,120410,101,120462,101,43826,101,1213,101,8959,69,65317,69,8496,69,119812,69,119864,69,119916,69,120020,69,120072,69,120124,69,120176,69,120228,69,120280,69,120332,69,120384,69,120436,69,917,69,120492,69,120550,69,120608,69,120666,69,120724,69,11577,69,5036,69,42224,69,71846,69,71854,69,66182,69,119839,102,119891,102,119943,102,119995,102,120047,102,120099,102,120151,102,120203,102,120255,102,120307,102,120359,102,120411,102,120463,102,43829,102,42905,102,383,102,7837,102,1412,102,119315,70,8497,70,119813,70,119865,70,119917,70,120021,70,120073,70,120125,70,120177,70,120229,70,120281,70,120333,70,120385,70,120437,70,42904,70,988,70,120778,70,5556,70,42205,70,71874,70,71842,70,66183,70,66213,70,66853,70,65351,103,8458,103,119840,103,119892,103,119944,103,120048,103,120100,103,120152,103,120204,103,120256,103,120308,103,120360,103,120412,103,120464,103,609,103,7555,103,397,103,1409,103,119814,71,119866,71,119918,71,119970,71,120022,71,120074,71,120126,71,120178,71,120230,71,120282,71,120334,71,120386,71,120438,71,1292,71,5056,71,5107,71,42198,71,65352,104,8462,104,119841,104,119945,104,119997,104,120049,104,120101,104,120153,104,120205,104,120257,104,120309,104,120361,104,120413,104,120465,104,1211,104,1392,104,5058,104,65320,72,8459,72,8460,72,8461,72,119815,72,119867,72,119919,72,120023,72,120179,72,120231,72,120283,72,120335,72,120387,72,120439,72,919,72,120494,72,120552,72,120610,72,120668,72,120726,72,11406,72,5051,72,5500,72,42215,72,66255,72,731,105,9075,105,65353,105,8560,105,8505,105,8520,105,119842,105,119894,105,119946,105,119998,105,120050,105,120102,105,120154,105,120206,105,120258,105,120310,105,120362,105,120414,105,120466,105,120484,105,618,105,617,105,953,105,8126,105,890,105,120522,105,120580,105,120638,105,120696,105,120754,105,1110,105,42567,105,1231,105,43893,105,5029,105,71875,105,65354,106,8521,106,119843,106,119895,106,119947,106,119999,106,120051,106,120103,106,120155,106,120207,106,120259,106,120311,106,120363,106,120415,106,120467,106,1011,106,1112,106,65322,74,119817,74,119869,74,119921,74,119973,74,120025,74,120077,74,120129,74,120181,74,120233,74,120285,74,120337,74,120389,74,120441,74,42930,74,895,74,1032,74,5035,74,5261,74,42201,74,119844,107,119896,107,119948,107,120000,107,120052,107,120104,107,120156,107,120208,107,120260,107,120312,107,120364,107,120416,107,120468,107,8490,75,65323,75,119818,75,119870,75,119922,75,119974,75,120026,75,120078,75,120130,75,120182,75,120234,75,120286,75,120338,75,120390,75,120442,75,922,75,120497,75,120555,75,120613,75,120671,75,120729,75,11412,75,5094,75,5845,75,42199,75,66840,75,1472,108,8739,73,9213,73,65512,73,1633,108,1777,73,66336,108,125127,108,120783,73,120793,73,120803,73,120813,73,120823,73,130033,73,65321,73,8544,73,8464,73,8465,73,119816,73,119868,73,119920,73,120024,73,120128,73,120180,73,120232,73,120284,73,120336,73,120388,73,120440,73,65356,108,8572,73,8467,108,119845,108,119897,108,119949,108,120001,108,120053,108,120105,73,120157,73,120209,73,120261,73,120313,73,120365,73,120417,73,120469,73,448,73,120496,73,120554,73,120612,73,120670,73,120728,73,11410,73,1030,73,1216,73,1493,108,1503,108,1575,108,126464,108,126592,108,65166,108,65165,108,1994,108,11599,73,5825,73,42226,73,93992,73,66186,124,66313,124,119338,76,8556,76,8466,76,119819,76,119871,76,119923,76,120027,76,120079,76,120131,76,120183,76,120235,76,120287,76,120339,76,120391,76,120443,76,11472,76,5086,76,5290,76,42209,76,93974,76,71843,76,71858,76,66587,76,66854,76,65325,77,8559,77,8499,77,119820,77,119872,77,119924,77,120028,77,120080,77,120132,77,120184,77,120236,77,120288,77,120340,77,120392,77,120444,77,924,77,120499,77,120557,77,120615,77,120673,77,120731,77,1018,77,11416,77,5047,77,5616,77,5846,77,42207,77,66224,77,66321,77,119847,110,119899,110,119951,110,120003,110,120055,110,120107,110,120159,110,120211,110,120263,110,120315,110,120367,110,120419,110,120471,110,1400,110,1404,110,65326,78,8469,78,119821,78,119873,78,119925,78,119977,78,120029,78,120081,78,120185,78,120237,78,120289,78,120341,78,120393,78,120445,78,925,78,120500,78,120558,78,120616,78,120674,78,120732,78,11418,78,42208,78,66835,78,3074,111,3202,111,3330,111,3458,111,2406,111,2662,111,2790,111,3046,111,3174,111,3302,111,3430,111,3664,111,3792,111,4160,111,1637,111,1781,111,65359,111,8500,111,119848,111,119900,111,119952,111,120056,111,120108,111,120160,111,120212,111,120264,111,120316,111,120368,111,120420,111,120472,111,7439,111,7441,111,43837,111,959,111,120528,111,120586,111,120644,111,120702,111,120760,111,963,111,120532,111,120590,111,120648,111,120706,111,120764,111,11423,111,4351,111,1413,111,1505,111,1607,111,126500,111,126564,111,126596,111,65259,111,65260,111,65258,111,65257,111,1726,111,64428,111,64429,111,64427,111,64426,111,1729,111,64424,111,64425,111,64423,111,64422,111,1749,111,3360,111,4125,111,66794,111,71880,111,71895,111,66604,111,1984,79,2534,79,2918,79,12295,79,70864,79,71904,79,120782,79,120792,79,120802,79,120812,79,120822,79,130032,79,65327,79,119822,79,119874,79,119926,79,119978,79,120030,79,120082,79,120134,79,120186,79,120238,79,120290,79,120342,79,120394,79,120446,79,927,79,120502,79,120560,79,120618,79,120676,79,120734,79,11422,79,1365,79,11604,79,4816,79,2848,79,66754,79,42227,79,71861,79,66194,79,66219,79,66564,79,66838,79,9076,112,65360,112,119849,112,119901,112,119953,112,120005,112,120057,112,120109,112,120161,112,120213,112,120265,112,120317,112,120369,112,120421,112,120473,112,961,112,120530,112,120544,112,120588,112,120602,112,120646,112,120660,112,120704,112,120718,112,120762,112,120776,112,11427,112,65328,80,8473,80,119823,80,119875,80,119927,80,119979,80,120031,80,120083,80,120187,80,120239,80,120291,80,120343,80,120395,80,120447,80,929,80,120504,80,120562,80,120620,80,120678,80,120736,80,11426,80,5090,80,5229,80,42193,80,66197,80,119850,113,119902,113,119954,113,120006,113,120058,113,120110,113,120162,113,120214,113,120266,113,120318,113,120370,113,120422,113,120474,113,1307,113,1379,113,1382,113,8474,81,119824,81,119876,81,119928,81,119980,81,120032,81,120084,81,120188,81,120240,81,120292,81,120344,81,120396,81,120448,81,11605,81,119851,114,119903,114,119955,114,120007,114,120059,114,120111,114,120163,114,120215,114,120267,114,120319,114,120371,114,120423,114,120475,114,43847,114,43848,114,7462,114,11397,114,43905,114,119318,82,8475,82,8476,82,8477,82,119825,82,119877,82,119929,82,120033,82,120189,82,120241,82,120293,82,120345,82,120397,82,120449,82,422,82,5025,82,5074,82,66740,82,5511,82,42211,82,94005,82,65363,115,119852,115,119904,115,119956,115,120008,115,120060,115,120112,115,120164,115,120216,115,120268,115,120320,115,120372,115,120424,115,120476,115,42801,115,445,115,1109,115,43946,115,71873,115,66632,115,65331,83,119826,83,119878,83,119930,83,119982,83,120034,83,120086,83,120138,83,120190,83,120242,83,120294,83,120346,83,120398,83,120450,83,1029,83,1359,83,5077,83,5082,83,42210,83,94010,83,66198,83,66592,83,119853,116,119905,116,119957,116,120009,116,120061,116,120113,116,120165,116,120217,116,120269,116,120321,116,120373,116,120425,116,120477,116,8868,84,10201,84,128872,84,65332,84,119827,84,119879,84,119931,84,119983,84,120035,84,120087,84,120139,84,120191,84,120243,84,120295,84,120347,84,120399,84,120451,84,932,84,120507,84,120565,84,120623,84,120681,84,120739,84,11430,84,5026,84,42196,84,93962,84,71868,84,66199,84,66225,84,66325,84,119854,117,119906,117,119958,117,120010,117,120062,117,120114,117,120166,117,120218,117,120270,117,120322,117,120374,117,120426,117,120478,117,42911,117,7452,117,43854,117,43858,117,651,117,965,117,120534,117,120592,117,120650,117,120708,117,120766,117,1405,117,66806,117,71896,117,8746,85,8899,85,119828,85,119880,85,119932,85,119984,85,120036,85,120088,85,120140,85,120192,85,120244,85,120296,85,120348,85,120400,85,120452,85,1357,85,4608,85,66766,85,5196,85,42228,85,94018,85,71864,85,8744,118,8897,118,65366,118,8564,118,119855,118,119907,118,119959,118,120011,118,120063,118,120115,118,120167,118,120219,118,120271,118,120323,118,120375,118,120427,118,120479,118,7456,118,957,118,120526,118,120584,118,120642,118,120700,118,120758,118,1141,118,1496,118,71430,118,43945,118,71872,118,119309,86,1639,86,1783,86,8548,86,119829,86,119881,86,119933,86,119985,86,120037,86,120089,86,120141,86,120193,86,120245,86,120297,86,120349,86,120401,86,120453,86,1140,86,11576,86,5081,86,5167,86,42719,86,42214,86,93960,86,71840,86,66845,86,623,119,119856,119,119908,119,119960,119,120012,119,120064,119,120116,119,120168,119,120220,119,120272,119,120324,119,120376,119,120428,119,120480,119,7457,119,1121,119,1309,119,1377,119,71434,119,71438,119,71439,119,43907,119,71919,87,71910,87,119830,87,119882,87,119934,87,119986,87,120038,87,120090,87,120142,87,120194,87,120246,87,120298,87,120350,87,120402,87,120454,87,1308,87,5043,87,5076,87,42218,87,5742,120,10539,120,10540,120,10799,120,65368,120,8569,120,119857,120,119909,120,119961,120,120013,120,120065,120,120117,120,120169,120,120221,120,120273,120,120325,120,120377,120,120429,120,120481,120,5441,120,5501,120,5741,88,9587,88,66338,88,71916,88,65336,88,8553,88,119831,88,119883,88,119935,88,119987,88,120039,88,120091,88,120143,88,120195,88,120247,88,120299,88,120351,88,120403,88,120455,88,42931,88,935,88,120510,88,120568,88,120626,88,120684,88,120742,88,11436,88,11613,88,5815,88,42219,88,66192,88,66228,88,66327,88,66855,88,611,121,7564,121,65369,121,119858,121,119910,121,119962,121,120014,121,120066,121,120118,121,120170,121,120222,121,120274,121,120326,121,120378,121,120430,121,120482,121,655,121,7935,121,43866,121,947,121,8509,121,120516,121,120574,121,120632,121,120690,121,120748,121,1199,121,4327,121,71900,121,65337,89,119832,89,119884,89,119936,89,119988,89,120040,89,120092,89,120144,89,120196,89,120248,89,120300,89,120352,89,120404,89,120456,89,933,89,978,89,120508,89,120566,89,120624,89,120682,89,120740,89,11432,89,1198,89,5033,89,5053,89,42220,89,94019,89,71844,89,66226,89,119859,122,119911,122,119963,122,120015,122,120067,122,120119,122,120171,122,120223,122,120275,122,120327,122,120379,122,120431,122,120483,122,7458,122,43923,122,71876,122,66293,90,71909,90,65338,90,8484,90,8488,90,119833,90,119885,90,119937,90,119989,90,120041,90,120197,90,120249,90,120301,90,120353,90,120405,90,120457,90,918,90,120493,90,120551,90,120609,90,120667,90,120725,90,5059,90,42204,90,71849,90,65282,34,65284,36,65285,37,65286,38,65290,42,65291,43,65294,46,65295,47,65296,48,65297,49,65298,50,65299,51,65300,52,65301,53,65302,54,65303,55,65304,56,65305,57,65308,60,65309,61,65310,62,65312,64,65316,68,65318,70,65319,71,65324,76,65329,81,65330,82,65333,85,65334,86,65335,87,65343,95,65346,98,65348,100,65350,102,65355,107,65357,109,65358,110,65361,113,65362,114,65364,116,65365,117,65367,119,65370,122,65371,123,65373,125,119846,109],"_default":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"cs":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"de":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"es":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"fr":[65374,126,65306,58,65281,33,8216,96,8245,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"it":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ja":[8211,45,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65292,44,65307,59],"ko":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pl":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pt-BR":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"qps-ploc":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ru":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,305,105,921,73,1009,112,215,120,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"tr":[160,32,8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"zh-hans":[65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41],"zh-hant":[8211,45,65374,126,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65307,59]}'));static cache=new Jf({getCacheKey:JSON.stringify},e=>{function t(c){let u=new Map;for(let h=0;h<c.length;h+=2)u.set(c[h],c[h+1]);return u}function n(c,u){let h=new Map(c);for(let[m,f]of u)h.set(m,f);return h}function i(c,u){if(!c)return u;let h=new Map;for(let[m,f]of c)u.has(m)&&h.set(m,f);return h}let r=this.ambiguousCharacterData.value,s=e.filter(c=>!c.startsWith("_")&&c in r);s.length===0&&(s=["_default"]);let a;for(let c of s){let u=t(r[c]);a=i(a,u)}let l=t(r._common),d=n(l,a);return new o(d)});static getInstance(e){return o.cache.get(Array.from(e))}static _locales=new vi(()=>Object.keys(o.ambiguousCharacterData.value).filter(e=>!e.startsWith("_")));static getLocales(){return o._locales.value}isAmbiguous(e){return this.confusableDictionary.has(e)}containsAmbiguousCharacter(e){for(let t=0;t<e.length;t++){let n=e.codePointAt(t);if(typeof n=="number"&&this.isAmbiguous(n))return!0}return!1}getPrimaryConfusable(e){return this.confusableDictionary.get(e)}getConfusableCodePoints(){return new Set(this.confusableDictionary.keys())}};function an(o){return typeof o=="string"}function mn(o){return typeof o=="object"&&o!==null&&!Array.isArray(o)&&!(o instanceof RegExp)&&!(o instanceof Date)}function yi(o){return typeof o=="number"&&!isNaN(o)}function lb(o){return o===!0||o===!1}function qn(o){return typeof o>"u"}function _x(o){return!pi(o)}function pi(o){return qn(o)||o===null}function Yc(o,e){if(!o)throw new Error(e?`Unexpected type, expected '${e}'`:"Unexpected type")}function Tn(o){if(pi(o))throw new Error("Assertion Failed: argument is undefined or null");return o}var H2=Object.prototype.hasOwnProperty;function md(o){if(!mn(o))return!1;for(let e in o)if(H2.call(o,e))return!1;return!0}function Kp(o){return typeof o=="function"}function Dk(o,e){let t=Math.min(o.length,e.length);for(let n=0;n<t;n++)U2(o[n],e[n])}function U2(o,e){if(an(e)){if(typeof o!==e)throw new Error(`argument does not match constraint: typeof ${e}`)}else if(Kp(e)){try{if(o instanceof e)return}catch{}if(!pi(o)&&o.constructor===e||e.length===1&&e.call(void 0,o)===!0)return;throw new Error("argument does not match one of these constraints: arg instanceof constraint, arg.constructor === constraint, nor constraint(arg) === true")}}function Ja(o){return o===47||o===92}function db(o){return o.replace(/[\\/]/g,ot.sep)}function Rk(o){return o.indexOf("/")===-1&&(o=db(o)),/^[a-zA-Z]:(\/|$)/.test(o)&&(o="/"+o),o}function Tx(o,e=ot.sep){if(!o)return"";let t=o.length,n=o.charCodeAt(0);if(Ja(n)){if(Ja(o.charCodeAt(1))&&!Ja(o.charCodeAt(2))){let r=3,s=r;for(;r<t&&!Ja(o.charCodeAt(r));r++);if(s!==r&&!Ja(o.charCodeAt(r+1))){for(r+=1;r<t;r++)if(Ja(o.charCodeAt(r)))return o.slice(0,r+1).replace(/[\\/]/g,e)}}return e}else if(Ak(n)&&o.charCodeAt(1)===58)return Ja(o.charCodeAt(2))?o.slice(0,2)+e:o.slice(0,2);let i=o.indexOf("://");if(i!==-1){for(i+=3;i<t;i++)if(Ja(o.charCodeAt(i)))return o.slice(0,i+1)}return""}var z2=/[\\/:\*\?"<>\|]/g,K2=/[/]/g,G2=/^(con|prn|aux|clock\$|nul|lpt[0-9]|com[0-9])(\.(.*?))?$/i;function Mk(o,e=mt){let t=e?z2:K2;return!(!o||o.length===0||/^\s+$/.test(o)||(t.lastIndex=0,t.test(o))||e&&G2.test(o)||o==="."||o===".."||e&&o[o.length-1]==="."||e&&o.length!==o.trim().length||o.length>255)}function Gp(o,e,t,n=Po){if(o===e)return!0;if(!o||!e||e.length>o.length)return!1;if(t){if(!Xa(o,e))return!1;if(e.length===o.length)return!0;let r=e.length;return e.charAt(e.length-1)===n&&r--,o.charAt(r)===n}return e.charAt(e.length-1)!==n&&(e+=n),o.indexOf(e)===0}function Ak(o){return o>=65&&o<=90||o>=97&&o<=122}function Ok(o,e=mt){return e?Ak(o.charCodeAt(0))&&o.charCodeAt(1)===58:!1}function Nk(o,e=mt){return Ok(o,e)?o[0]:void 0}function Pk(o,e,t){return e.length>o.length?-1:o===e?0:(t&&(o=o.toLowerCase(),e=e.toLowerCase()),o.indexOf(e))}function Fk(o){let e=o.split(":"),t,n,i;for(let r of e){let s=Number(r);yi(s)?n===void 0?n=s:i===void 0&&(i=s):t=t?[t,r].join(":"):r}if(!t)throw new Error("Format for `--goto` should be: `FILE:LINE(:COLUMN)`");return{path:t,line:n!==void 0?n:void 0,column:i!==void 0?i:n!==void 0?1:void 0}}var Te;(ke=>(ke.inMemory="inmemory",ke.vscode="vscode",ke.internal="private",ke.walkThrough="walkThrough",ke.walkThroughSnippet="walkThroughSnippet",ke.http="http",ke.https="https",ke.file="file",ke.mailto="mailto",ke.untitled="untitled",ke.data="data",ke.command="command",ke.vscodeRemote="vscode-remote",ke.vscodeRemoteResource="vscode-remote-resource",ke.vscodeManagedRemoteResource="vscode-managed-remote-resource",ke.vscodeUserData="vscode-userdata",ke.vscodeCustomEditor="vscode-custom-editor",ke.vscodeNotebookCell="vscode-notebook-cell",ke.vscodeNotebookCellMetadata="vscode-notebook-cell-metadata",ke.vscodeNotebookCellMetadataDiff="vscode-notebook-cell-metadata-diff",ke.vscodeNotebookCellOutput="vscode-notebook-cell-output",ke.vscodeNotebookCellOutputDiff="vscode-notebook-cell-output-diff",ke.vscodeNotebookMetadata="vscode-notebook-metadata",ke.vscodeInteractiveInput="vscode-interactive-input",ke.vscodeSettings="vscode-settings",ke.vscodeWorkspaceTrust="vscode-workspace-trust",ke.vscodeTerminal="vscode-terminal",ke.vscodeChatCodeBlock="vscode-chat-code-block",ke.vscodeChatCodeCompareBlock="vscode-chat-code-compare-block",ke.vscodeChatSesssion="vscode-chat-editor",ke.webviewPanel="webview-panel",ke.vscodeWebview="vscode-webview",ke.extension="extension",ke.vscodeFileResource="vscode-file",ke.tmp="tmp",ke.vsls="vsls",ke.vscodeSourceControl="vscode-scm",ke.commentsInput="comment",ke.codeSetting="code-setting",ke.outputChannel="output"))(Te||={});function cb(o,e){return ie.isUri(o)?wr(o.scheme,e):Xa(o,e+":")}var $2="tkn",Lx=class{_hosts=Object.create(null);_ports=Object.create(null);_connectionTokens=Object.create(null);_preferredWebSchema="http";_delegate=null;_serverRootPath="/";setPreferredWebSchema(e){this._preferredWebSchema=e}setDelegate(e){this._delegate=e}setServerRootPath(e,t){this._serverRootPath=q2(e,t)}getServerRootPath(){return this._serverRootPath}get _remoteResourcesPath(){return ot.join(this._serverRootPath,Te.vscodeRemoteResource)}set(e,t,n){this._hosts[e]=t,this._ports[e]=n}setConnectionToken(e,t){this._connectionTokens[e]=t}getPreferredWebSchema(){return this._preferredWebSchema}rewrite(e){if(this._delegate)try{return this._delegate(e)}catch(a){return je(a),e}let t=e.authority,n=this._hosts[t];n&&n.indexOf(":")!==-1&&n.indexOf("[")===-1&&(n=`[${n}]`);let i=this._ports[t],r=this._connectionTokens[t],s=`path=${encodeURIComponent(e.path)}`;return typeof r=="string"&&(s+=`&${$2}=${encodeURIComponent(r)}`),ie.from({scheme:Zi?this._preferredWebSchema:Te.vscodeRemoteResource,authority:`${n}:${i}`,path:this._remoteResourcesPath,query:s})}},ub=new Lx;function q2(o,e){return ot.join(e??"/",`${o.quality??"oss"}-${o.commit??"dev"}`)}var kx="vscode-app",Dx=class o{static FALLBACK_AUTHORITY=kx;asBrowserUri(e){let t=this.toUri(e);return this.uriToBrowserUri(t)}uriToBrowserUri(e){return e.scheme===Te.vscodeRemote?ub.rewrite(e):e.scheme===Te.file&&(rs||k1===`${Te.vscodeFileResource}://${o.FALLBACK_AUTHORITY}`)?e.with({scheme:Te.vscodeFileResource,authority:e.authority||o.FALLBACK_AUTHORITY,query:null,fragment:null}):e}asFileUri(e){let t=this.toUri(e);return this.uriToFileUri(t)}uriToFileUri(e){return e.scheme===Te.vscodeFileResource?e.with({scheme:Te.file,authority:e.authority!==o.FALLBACK_AUTHORITY?e.authority:null,query:null,fragment:null}):e}toUri(e,t){if(ie.isUri(e))return e;if(globalThis._VSCODE_FILE_ROOT){let n=globalThis._VSCODE_FILE_ROOT;if(/^\w[\w\d+.-]*:\/\//.test(n))return ie.joinPath(ie.parse(n,!0),e);let i=No(n,e);return ie.file(i)}return ie.parse(t.toUrl(e))}},el=new Dx,Y2;(r=>{let o=new Map([["1",{"Cross-Origin-Opener-Policy":"same-origin"}],["2",{"Cross-Origin-Embedder-Policy":"require-corp"}],["3",{"Cross-Origin-Opener-Policy":"same-origin","Cross-Origin-Embedder-Policy":"require-corp"}]]);r.CoopAndCoep=Object.freeze(o.get("3"));let t="vscode-coi";function n(s){let a;typeof s=="string"?a=new URL(s).searchParams:s instanceof URL?a=s.searchParams:ie.isUri(s)&&(a=new URL(s.toString(!0)).searchParams);let l=a?.get(t);if(l)return o.get(l)}r.getHeadersFromQuery=n;function i(s,a,l){if(!globalThis.crossOriginIsolated)return;let d=a&&l?"3":l?"2":"1";s instanceof URLSearchParams?s.set(t,d):s[t]=d}r.addSearchParam=i})(Y2||={});function na(o){return Ep(o,!0)}var jp=class{constructor(e){this._ignorePathCasing=e}compare(e,t,n=!1){return e===t?0:Sx(this.getComparisonKey(e,n),this.getComparisonKey(t,n))}isEqual(e,t,n=!1){return e===t?!0:!e||!t?!1:this.getComparisonKey(e,n)===this.getComparisonKey(t,n)}getComparisonKey(e,t=!1){return e.with({path:this._ignorePathCasing(e)?e.path.toLowerCase():void 0,fragment:t?null:void 0}).toString()}ignorePathCasing(e){return this._ignorePathCasing(e)}isEqualOrParent(e,t,n=!1){if(e.scheme===t.scheme){if(e.scheme===Te.file)return Gp(na(e),na(t),this._ignorePathCasing(e))&&e.query===t.query&&(n||e.fragment===t.fragment);if(Bk(e.authority,t.authority))return Gp(e.path,t.path,this._ignorePathCasing(e),"/")&&e.query===t.query&&(n||e.fragment===t.fragment)}return!1}joinPath(e,...t){return ie.joinPath(e,...t)}basenameOrAuthority(e){return xr(e)||e.authority}basename(e){return ot.basename(e.path)}extname(e){return ot.extname(e.path)}dirname(e){if(e.path.length===0)return e;let t;return e.scheme===Te.file?t=ie.file(Pc(na(e))).path:(t=ot.dirname(e.path),e.authority&&t.length&&t.charCodeAt(0)!==47&&(console.error(`dirname("${e.toString})) resulted in a relative path`),t="/")),e.with({path:t})}normalizePath(e){if(!e.path.length)return e;let t;return e.scheme===Te.file?t=ie.file(Ka(na(e))).path:t=ot.normalize(e.path),e.with({path:t})}relativePath(e,t){if(e.scheme!==t.scheme||!Bk(e.authority,t.authority))return;if(e.scheme===Te.file){let r=V1(na(e),na(t));return mt?db(r):r}let n=e.path||"/",i=t.path||"/";if(this._ignorePathCasing(e)){let r=0;for(let s=Math.min(n.length,i.length);r<s&&!(n.charCodeAt(r)!==i.charCodeAt(r)&&n.charAt(r).toLowerCase()!==i.charAt(r).toLowerCase());r++);n=i.substr(0,r)+n.substr(r)}return ot.relative(n,i)}resolvePath(e,t){if(e.scheme===Te.file){let n=ie.file(Nc(na(e),t));return e.with({authority:n.authority,path:n.path})}return t=Rk(t),e.with({path:ot.resolve(e.path,t)})}isAbsolutePath(e){return!!e.path&&e.path[0]==="/"}isEqualAuthority(e,t){return e===t||e!==void 0&&t!==void 0&&wr(e,t)}hasTrailingPathSeparator(e,t=Po){if(e.scheme===Te.file){let n=na(e);return n.length>Tx(n).length&&n[n.length-1]===t}else{let n=e.path;return n.length>1&&n.charCodeAt(n.length-1)===47&&!/^[a-zA-Z]:(\/$|\\$)/.test(e.fsPath)}}removeTrailingPathSeparator(e,t=Po){return Vk(e,t)?e.with({path:e.path.substr(0,e.path.length-1)}):e}addTrailingPathSeparator(e,t=Po){let n=!1;if(e.scheme===Te.file){let i=na(e);n=i!==void 0&&i.length===Tx(i).length&&i[i.length-1]===t}else{t="/";let i=e.path;n=i.length===1&&i.charCodeAt(i.length-1)===47}return!n&&!Vk(e,t)?e.with({path:e.path+"/"}):e}},wt=new jp(()=>!1),Z2=new jp(o=>o.scheme===Te.file?!Wt:!0),X2=new jp(o=>!0),Yn=wt.isEqual.bind(wt),O6=wt.isEqualOrParent.bind(wt),N6=wt.getComparisonKey.bind(wt),Q2=wt.basenameOrAuthority.bind(wt),xr=wt.basename.bind(wt),Rx=wt.extname.bind(wt),as=wt.dirname.bind(wt),ht=wt.joinPath.bind(wt),P6=wt.normalizePath.bind(wt),Zc=wt.relativePath.bind(wt),Mx=wt.resolvePath.bind(wt),F6=wt.isAbsolutePath.bind(wt),Bk=wt.isEqualAuthority.bind(wt),Vk=wt.hasTrailingPathSeparator.bind(wt),B6=wt.removeTrailingPathSeparator.bind(wt),V6=wt.addTrailingPathSeparator.bind(wt);var J2;(r=>{r.META_DATA_LABEL="label",r.META_DATA_DESCRIPTION="description",r.META_DATA_SIZE="size",r.META_DATA_MIME="mime";function i(s){let a=new Map;s.path.substring(s.path.indexOf(";")+1,s.path.lastIndexOf(";")).split(";").forEach(c=>{let[u,h]=c.split(":");u&&h&&a.set(u,h)});let d=s.path.substring(0,s.path.indexOf(";"));return d&&a.set(r.META_DATA_MIME,d),a}r.parseMetaData=i})(J2||={});function Wk(o,e,t){if(e){let n=o.path;return n&&n[0]!==ot.sep&&(n=ot.sep+n),o.with({scheme:t,authority:e,path:n})}return o.with({scheme:t})}function gb(o){return!!o&&typeof o.then=="function"}function gd(o){let e=new Xo,t=o(e.token),n=new Promise((i,r)=>{let s=e.token.onCancellationRequested(()=>{s.dispose(),r(new $i)});Promise.resolve(t).then(a=>{s.dispose(),e.dispose(),i(a)},a=>{s.dispose(),e.dispose(),r(a)})});return new class{cancel(){e.cancel(),e.dispose()}then(i,r){return n.then(i,r)}catch(i){return this.then(void 0,i)}finally(i){return n.finally(i)}}}function Yp(o,e,t){return new Promise((n,i)=>{let r=e.onCancellationRequested(()=>{r.dispose(),n(t)});o.then(n,i).finally(()=>r.dispose())})}function Uk(){let o,e;return{promise:new Promise((n,i)=>{o=n,e=i}),resolve:o,reject:e}}var Ax=class{activePromise;queuedPromise;queuedPromiseFactory;isDisposed=!1;constructor(){this.activePromise=null,this.queuedPromise=null,this.queuedPromiseFactory=null}queue(e){if(this.isDisposed)return Promise.reject(new Error("Throttler is disposed"));if(this.activePromise){if(this.queuedPromiseFactory=e,!this.queuedPromise){let t=()=>{if(this.queuedPromise=null,this.isDisposed)return;let n=this.queue(this.queuedPromiseFactory);return this.queuedPromiseFactory=null,n};this.queuedPromise=new Promise(n=>{this.activePromise.then(t,t).then(n)})}return new Promise((t,n)=>{this.queuedPromise.then(t,n)})}return this.activePromise=e(),new Promise((t,n)=>{this.activePromise.then(i=>{this.activePromise=null,t(i)},i=>{this.activePromise=null,n(i)})})}dispose(){this.isDisposed=!0}};var eV=(o,e)=>{let t=!0,n=setTimeout(()=>{t=!1,e()},o);return{isTriggered:()=>t,dispose:()=>{clearTimeout(n),t=!1}}},tV=o=>{let e=!0;return queueMicrotask(()=>{e&&(e=!1,o())}),{isTriggered:()=>e,dispose:()=>{e=!1}}},ls=class{constructor(e){this.defaultDelay=e;this.deferred=null,this.completionPromise=null,this.doResolve=null,this.doReject=null,this.task=null}deferred;completionPromise;doResolve;doReject;task;trigger(e,t=this.defaultDelay){this.task=e,this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise((i,r)=>{this.doResolve=i,this.doReject=r}).then(()=>{if(this.completionPromise=null,this.doResolve=null,this.task){let i=this.task;return this.task=null,i()}}));let n=()=>{this.deferred=null,this.doResolve?.(null)};return this.deferred=t===cx?tV(n):eV(t,n),this.completionPromise}isTriggered(){return!!this.deferred?.isTriggered()}cancel(){this.cancelTimeout(),this.completionPromise&&(this.doReject?.(new $i),this.completionPromise=null)}cancelTimeout(){this.deferred?.dispose(),this.deferred=null}dispose(){this.cancel()}},$p=class{delayer;throttler;constructor(e){this.delayer=new ls(e),this.throttler=new Ax}trigger(e,t){return this.delayer.trigger(()=>this.throttler.queue(e),t)}isTriggered(){return this.delayer.isTriggered()}cancel(){this.delayer.cancel()}dispose(){this.delayer.dispose(),this.throttler.dispose()}},Qc=class{_isOpen;_promise;_completePromise;constructor(){this._isOpen=!1,this._promise=new Promise((e,t)=>{this._completePromise=e})}isOpen(){return this._isOpen}open(){this._isOpen=!0,this._completePromise(!0)}wait(){return this._promise}};function vo(o,e){return e?new Promise((t,n)=>{let i=setTimeout(()=>{r.dispose(),t()},o),r=e.onCancellationRequested(()=>{clearTimeout(i),r.dispose(),n(new $i)})}):gd(t=>vo(o,t))}function fb(o,e=0,t){let n=setTimeout(()=>{o(),t&&i.dispose()},e),i=ve(()=>{clearTimeout(n),t?.deleteAndLeak(i)});return t?.add(i),i}var Er=class{_token;_isDisposed=!1;constructor(e,t){this._token=-1,typeof e=="function"&&typeof t=="number"&&this.setIfNotSet(e,t)}dispose(){this.cancel(),this._isDisposed=!0}cancel(){this._token!==-1&&(clearTimeout(this._token),this._token=-1)}cancelAndSet(e,t){if(this._isDisposed)throw new Qe("Calling 'cancelAndSet' on a disposed TimeoutTimer");this.cancel(),this._token=setTimeout(()=>{this._token=-1,e()},t)}setIfNotSet(e,t){if(this._isDisposed)throw new Qe("Calling 'setIfNotSet' on a disposed TimeoutTimer");this._token===-1&&(this._token=setTimeout(()=>{this._token=-1,e()},t))}},hb=class{disposable=void 0;isDisposed=!1;cancel(){this.disposable?.dispose(),this.disposable=void 0}cancelAndSet(e,t,n=globalThis){if(this.isDisposed)throw new Qe("Calling 'cancelAndSet' on a disposed IntervalTimer");this.cancel();let i=n.setInterval(()=>{e()},t);this.disposable=ve(()=>{n.clearInterval(i),this.disposable=void 0})}dispose(){this.cancel(),this.isDisposed=!0}},Qt=class{runner;timeoutToken;timeout;timeoutHandler;constructor(e,t){this.timeoutToken=-1,this.runner=e,this.timeout=t,this.timeoutHandler=this.onTimeout.bind(this)}dispose(){this.cancel(),this.runner=null}cancel(){this.isScheduled()&&(clearTimeout(this.timeoutToken),this.timeoutToken=-1)}schedule(e=this.timeout){this.cancel(),this.timeoutToken=setTimeout(this.timeoutHandler,e)}get delay(){return this.timeout}set delay(e){this.timeout=e}isScheduled(){return this.timeoutToken!==-1}flush(){this.isScheduled()&&(this.cancel(),this.doRun())}onTimeout(){this.timeoutToken=-1,this.runner&&this.doRun()}doRun(){this.runner?.()}};var nl,Xc;(function(){typeof globalThis.requestIdleCallback!="function"||typeof globalThis.cancelIdleCallback!="function"?Xc=(o,e)=>{Ef(()=>{if(t)return;let n=Date.now()+15;e(Object.freeze({didTimeout:!0,timeRemaining(){return Math.max(0,n-Date.now())}}))});let t=!1;return{dispose(){t||(t=!0)}}}:Xc=(o,e,t)=>{let n=o.requestIdleCallback(e,typeof t=="number"?{timeout:t}:void 0),i=!1;return{dispose(){i||(i=!0,o.cancelIdleCallback(n))}}},nl=o=>Xc(globalThis,o)})();var pb=class{_executor;_handle;_didRun=!1;_value;_error;constructor(e,t){this._executor=()=>{try{this._value=t()}catch(n){this._error=n}finally{this._didRun=!0}},this._handle=Xc(e,()=>this._executor())}dispose(){this._handle.dispose()}get value(){if(this._didRun||(this._handle.dispose(),this._executor()),this._error)throw this._error;return this._value}get isInitialized(){return this._didRun}},qp=class extends pb{constructor(e){super(globalThis,e)}};var mb=class{_running;_queued;isRunning(e){return typeof e=="number"?this._running?.taskId===e:!!this._running}get running(){return this._running?.promise}cancelRunning(){this._running?.cancel()}run(e,t,n){return this._running={taskId:e,cancel:()=>n?.(),promise:t},t.then(()=>this.doneRunning(e),()=>this.doneRunning(e)),t}doneRunning(e){this._running&&e===this._running.taskId&&(this._running=void 0,this.runQueued())}runQueued(){if(this._queued){let e=this._queued;this._queued=void 0,e.run().then(e.promiseResolve,e.promiseReject)}}queue(e){if(this._queued)this._queued.run=e;else{let{promise:t,resolve:n,reject:i}=Uk();this._queued={run:e,promise:t,promiseResolve:n,promiseReject:i}}return this._queued.promise}hasQueued(){return!!this._queued}async join(){return this._queued?.promise??this._running?.promise}};var tl=class{completeCallback;errorCallback;outcome;get isRejected(){return this.outcome?.outcome===1}get isResolved(){return this.outcome?.outcome===0}get isSettled(){return!!this.outcome}get value(){return this.outcome?.outcome===0?this.outcome?.value:void 0}p;constructor(){this.p=new Promise((e,t)=>{this.completeCallback=e,this.errorCallback=t})}complete(e){return new Promise(t=>{this.completeCallback(e),this.outcome={outcome:0,value:e},t()})}error(e){return new Promise(t=>{this.errorCallback(e),this.outcome={outcome:1,value:e},t()})}cancel(){return this.error(new $i)}},Uo;(t=>{async function o(n){let i,r=await Promise.all(n.map(s=>s.then(a=>a,a=>{i||(i=a)})));if(typeof i<"u")throw i;return r}t.settled=o;function e(n){return new Promise(async(i,r)=>{try{await n(i,r)}catch(s){r(s)}})}t.withAsyncBody=e})(Uo||={});var Hk=class o{static fromArray(e){return new o(t=>{t.emitMany(e)})}static fromPromise(e){return new o(async t=>{t.emitMany(await e)})}static fromPromises(e){return new o(async t=>{await Promise.all(e.map(async n=>t.emitOne(await n)))})}static merge(e){return new o(async t=>{await Promise.all(e.map(async n=>{for await(let i of n)t.emitOne(i)}))})}static EMPTY=o.fromArray([]);_state;_results;_error;_onReturn;_onStateChanged;constructor(e,t){this._state=0,this._results=[],this._error=null,this._onReturn=t,this._onStateChanged=new E,queueMicrotask(async()=>{let n={emitOne:i=>this.emitOne(i),emitMany:i=>this.emitMany(i),reject:i=>this.reject(i)};try{await Promise.resolve(e(n)),this.resolve()}catch(i){this.reject(i)}finally{n.emitOne=void 0,n.emitMany=void 0,n.reject=void 0}})}[Symbol.asyncIterator](){let e=0;return{next:async()=>{do{if(this._state===2)throw this._error;if(e<this._results.length)return{done:!1,value:this._results[e++]};if(this._state===1)return{done:!0,value:void 0};await oe.toPromise(this._onStateChanged.event)}while(!0)},return:async()=>(this._onReturn?.(),{done:!0,value:void 0})}}static map(e,t){return new o(async n=>{for await(let i of e)n.emitOne(t(i))})}map(e){return o.map(this,e)}static filter(e,t){return new o(async n=>{for await(let i of e)t(i)&&n.emitOne(i)})}filter(e){return o.filter(this,e)}static coalesce(e){return o.filter(e,t=>!!t)}coalesce(){return o.coalesce(this)}static async toPromise(e){let t=[];for await(let n of e)t.push(n);return t}toPromise(){return o.toPromise(this)}emitOne(e){this._state===0&&(this._results.push(e),this._onStateChanged.fire())}emitMany(e){this._state===0&&(this._results=this._results.concat(e),this._onStateChanged.fire())}resolve(){this._state===0&&(this._state=1,this._onStateChanged.fire())}reject(e){this._state===0&&(this._state=2,this._error=e,this._onStateChanged.fire())}};var{entries:Zk,setPrototypeOf:zk,isFrozen:nV,getPrototypeOf:iV,getOwnPropertyDescriptor:oV}=Object,{freeze:Ji,seal:Tr,create:rV}=Object,{apply:Vx,construct:Wx}=typeof Reflect<"u"&&Reflect;Vx||(Vx=function(e,t,n){return e.apply(t,n)});Ji||(Ji=function(e){return e});Tr||(Tr=function(e){return e});Wx||(Wx=function(e,t){return new e(...t)});var sV=Qo(Array.prototype.forEach),Kk=Qo(Array.prototype.pop),Zp=Qo(Array.prototype.push),yb=Qo(String.prototype.toLowerCase),Ox=Qo(String.prototype.toString),aV=Qo(String.prototype.match),_r=Qo(String.prototype.replace),lV=Qo(String.prototype.indexOf),dV=Qo(String.prototype.trim),zo=Qo(RegExp.prototype.test),Xp=cV(TypeError);function Qo(o){return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return Vx(o,e,n)}}function cV(o){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Wx(o,t)}}function pt(o,e,t){var n;t=(n=t)!==null&&n!==void 0?n:yb,zk&&zk(o,null);let i=e.length;for(;i--;){let r=e[i];if(typeof r=="string"){let s=t(r);s!==r&&(nV(e)||(e[i]=s),r=s)}o[r]=!0}return o}function Jc(o){let e=rV(null);for(let[t,n]of Zk(o))e[t]=n;return e}function bb(o,e){for(;o!==null;){let n=oV(o,e);if(n){if(n.get)return Qo(n.get);if(typeof n.value=="function")return Qo(n.value)}o=iV(o)}function t(n){return console.warn("fallback value for",n),null}return t}var Gk=Ji(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Nx=Ji(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Px=Ji(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),uV=Ji(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Fx=Ji(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),hV=Ji(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),jk=Ji(["#text"]),$k=Ji(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),Bx=Ji(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),qk=Ji(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),vb=Ji(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),pV=Tr(/\{\{[\w\W]*|[\w\W]*\}\}/gm),mV=Tr(/<%[\w\W]*|[\w\W]*%>/gm),gV=Tr(/\${[\w\W]*}/gm),fV=Tr(/^data-[\-\w.\u00B7-\uFFFF]/),bV=Tr(/^aria-[\-\w]+$/),Xk=Tr(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),vV=Tr(/^(?:\w+script|data):/i),yV=Tr(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Qk=Tr(/^html$/i),Yk=Object.freeze({__proto__:null,MUSTACHE_EXPR:pV,ERB_EXPR:mV,TMPLIT_EXPR:gV,DATA_ATTR:fV,ARIA_ATTR:bV,IS_ALLOWED_URI:Xk,IS_SCRIPT_OR_DATA:vV,ATTR_WHITESPACE:yV,DOCTYPE_NAME:Qk}),IV=()=>typeof window>"u"?null:window,CV=function(e,t){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let n=null,i="data-tt-policy-suffix";t&&t.hasAttribute(i)&&(n=t.getAttribute(i));let r="dompurify"+(n?"#"+n:"");try{return e.createPolicy(r,{createHTML(s){return s},createScriptURL(s){return s}})}catch{return console.warn("TrustedTypes policy "+r+" could not be created."),null}};function Jk(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:IV(),e=Re=>Jk(Re);if(e.version="3.0.5",e.removed=[],!o||!o.document||o.document.nodeType!==9)return e.isSupported=!1,e;let t=o.document,n=t.currentScript,{document:i}=o,{DocumentFragment:r,HTMLTemplateElement:s,Node:a,Element:l,NodeFilter:d,NamedNodeMap:c=o.NamedNodeMap||o.MozNamedAttrMap,HTMLFormElement:u,DOMParser:h,trustedTypes:m}=o,f=l.prototype,g=bb(f,"cloneNode"),b=bb(f,"nextSibling"),y=bb(f,"childNodes"),C=bb(f,"parentNode");if(typeof s=="function"){let Re=i.createElement("template");Re.content&&Re.content.ownerDocument&&(i=Re.content.ownerDocument)}let x,L="",{implementation:k,createNodeIterator:O,createDocumentFragment:W,getElementsByTagName:z}=i,{importNode:B}=t,G={};e.isSupported=typeof Zk=="function"&&typeof C=="function"&&k&&k.createHTMLDocument!==void 0;let{MUSTACHE_EXPR:q,ERB_EXPR:X,TMPLIT_EXPR:ce,DATA_ATTR:Ce,ARIA_ATTR:te,IS_SCRIPT_OR_DATA:Z,ATTR_WHITESPACE:le}=Yk,{IS_ALLOWED_URI:ne}=Yk,Q=null,we=pt({},[...Gk,...Nx,...Px,...Fx,...jk]),xe=null,st=pt({},[...$k,...Bx,...qk,...vb]),Xe=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),ke=null,$n=null,xn=!0,ji=!0,po=!1,Aa=!0,ai=!1,mr=!1,Yl=!1,Oa=!1,li=!1,Na=!1,Pa=!1,Rc=!0,Mc=!1,Ae="user-content-",$s=!0,Fa=!1,Xr={},Yo=null,pp=pt({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Zl=null,mp=pt({},["audio","video","img","source","image","track"]),Qr=null,gp=pt({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Jr="http://www.w3.org/1998/Math/MathML",Ro="http://www.w3.org/2000/svg",fn="http://www.w3.org/1999/xhtml",Mo=fn,qs=!1,Ri=null,Ba=pt({},[Jr,Ro,fn],Ox),gr,es=["application/xhtml+xml","text/html"],pe="text/html",se,M=null,ee=i.createElement("form"),ue=function(H){return H instanceof RegExp||H instanceof Function},qe=function(H){if(!(M&&M===H)){if((!H||typeof H!="object")&&(H={}),H=Jc(H),gr=es.indexOf(H.PARSER_MEDIA_TYPE)===-1?gr=pe:gr=H.PARSER_MEDIA_TYPE,se=gr==="application/xhtml+xml"?Ox:yb,Q="ALLOWED_TAGS"in H?pt({},H.ALLOWED_TAGS,se):we,xe="ALLOWED_ATTR"in H?pt({},H.ALLOWED_ATTR,se):st,Ri="ALLOWED_NAMESPACES"in H?pt({},H.ALLOWED_NAMESPACES,Ox):Ba,Qr="ADD_URI_SAFE_ATTR"in H?pt(Jc(gp),H.ADD_URI_SAFE_ATTR,se):gp,Zl="ADD_DATA_URI_TAGS"in H?pt(Jc(mp),H.ADD_DATA_URI_TAGS,se):mp,Yo="FORBID_CONTENTS"in H?pt({},H.FORBID_CONTENTS,se):pp,ke="FORBID_TAGS"in H?pt({},H.FORBID_TAGS,se):{},$n="FORBID_ATTR"in H?pt({},H.FORBID_ATTR,se):{},Xr="USE_PROFILES"in H?H.USE_PROFILES:!1,xn=H.ALLOW_ARIA_ATTR!==!1,ji=H.ALLOW_DATA_ATTR!==!1,po=H.ALLOW_UNKNOWN_PROTOCOLS||!1,Aa=H.ALLOW_SELF_CLOSE_IN_ATTR!==!1,ai=H.SAFE_FOR_TEMPLATES||!1,mr=H.WHOLE_DOCUMENT||!1,li=H.RETURN_DOM||!1,Na=H.RETURN_DOM_FRAGMENT||!1,Pa=H.RETURN_TRUSTED_TYPE||!1,Oa=H.FORCE_BODY||!1,Rc=H.SANITIZE_DOM!==!1,Mc=H.SANITIZE_NAMED_PROPS||!1,$s=H.KEEP_CONTENT!==!1,Fa=H.IN_PLACE||!1,ne=H.ALLOWED_URI_REGEXP||Xk,Mo=H.NAMESPACE||fn,Xe=H.CUSTOM_ELEMENT_HANDLING||{},H.CUSTOM_ELEMENT_HANDLING&&ue(H.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Xe.tagNameCheck=H.CUSTOM_ELEMENT_HANDLING.tagNameCheck),H.CUSTOM_ELEMENT_HANDLING&&ue(H.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Xe.attributeNameCheck=H.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),H.CUSTOM_ELEMENT_HANDLING&&typeof H.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(Xe.allowCustomizedBuiltInElements=H.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),ai&&(ji=!1),Na&&(li=!0),Xr&&(Q=pt({},[...jk]),xe=[],Xr.html===!0&&(pt(Q,Gk),pt(xe,$k)),Xr.svg===!0&&(pt(Q,Nx),pt(xe,Bx),pt(xe,vb)),Xr.svgFilters===!0&&(pt(Q,Px),pt(xe,Bx),pt(xe,vb)),Xr.mathMl===!0&&(pt(Q,Fx),pt(xe,qk),pt(xe,vb))),H.ADD_TAGS&&(Q===we&&(Q=Jc(Q)),pt(Q,H.ADD_TAGS,se)),H.ADD_ATTR&&(xe===st&&(xe=Jc(xe)),pt(xe,H.ADD_ATTR,se)),H.ADD_URI_SAFE_ATTR&&pt(Qr,H.ADD_URI_SAFE_ATTR,se),H.FORBID_CONTENTS&&(Yo===pp&&(Yo=Jc(Yo)),pt(Yo,H.FORBID_CONTENTS,se)),$s&&(Q["#text"]=!0),mr&&pt(Q,["html","head","body"]),Q.table&&(pt(Q,["tbody"]),delete ke.tbody),H.TRUSTED_TYPES_POLICY){if(typeof H.TRUSTED_TYPES_POLICY.createHTML!="function")throw Xp('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof H.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Xp('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');x=H.TRUSTED_TYPES_POLICY,L=x.createHTML("")}else x===void 0&&(x=CV(m,n)),x!==null&&typeof L=="string"&&(L=x.createHTML(""));Ji&&Ji(H),M=H}},yt=pt({},["mi","mo","mn","ms","mtext"]),Pn=pt({},["foreignobject","desc","title","annotation-xml"]),di=pt({},["title","style","font","a","script"]),Pe=pt({},Nx);pt(Pe,Px),pt(Pe,uV);let w=pt({},Fx);pt(w,hV);let _=function(H){let fe=C(H);(!fe||!fe.tagName)&&(fe={namespaceURI:Mo,tagName:"template"});let Le=yb(H.tagName),Nt=yb(fe.tagName);return Ri[H.namespaceURI]?H.namespaceURI===Ro?fe.namespaceURI===fn?Le==="svg":fe.namespaceURI===Jr?Le==="svg"&&(Nt==="annotation-xml"||yt[Nt]):!!Pe[Le]:H.namespaceURI===Jr?fe.namespaceURI===fn?Le==="math":fe.namespaceURI===Ro?Le==="math"&&Pn[Nt]:!!w[Le]:H.namespaceURI===fn?fe.namespaceURI===Ro&&!Pn[Nt]||fe.namespaceURI===Jr&&!yt[Nt]?!1:!w[Le]&&(di[Le]||!Pe[Le]):!!(gr==="application/xhtml+xml"&&Ri[H.namespaceURI]):!1},T=function(H){Zp(e.removed,{element:H});try{H.parentNode.removeChild(H)}catch{H.remove()}},A=function(H,fe){try{Zp(e.removed,{attribute:fe.getAttributeNode(H),from:fe})}catch{Zp(e.removed,{attribute:null,from:fe})}if(fe.removeAttribute(H),H==="is"&&!xe[H])if(li||Na)try{T(fe)}catch{}else try{fe.setAttribute(H,"")}catch{}},F=function(H){let fe,Le;if(Oa)H="<remove></remove>"+H;else{let Mi=aV(H,/^[\r\n\t ]+/);Le=Mi&&Mi[0]}gr==="application/xhtml+xml"&&Mo===fn&&(H='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+H+"</body></html>");let Nt=x?x.createHTML(H):H;if(Mo===fn)try{fe=new h().parseFromString(Nt,gr)}catch{}if(!fe||!fe.documentElement){fe=k.createDocument(Mo,"template",null);try{fe.documentElement.innerHTML=qs?L:Nt}catch{}}let En=fe.body||fe.documentElement;return H&&Le&&En.insertBefore(i.createTextNode(Le),En.childNodes[0]||null),Mo===fn?z.call(fe,mr?"html":"body")[0]:mr?fe.documentElement:En},$=function(H){return O.call(H.ownerDocument||H,H,d.SHOW_ELEMENT|d.SHOW_COMMENT|d.SHOW_TEXT,null,!1)},J=function(H){return H instanceof u&&(typeof H.nodeName!="string"||typeof H.textContent!="string"||typeof H.removeChild!="function"||!(H.attributes instanceof c)||typeof H.removeAttribute!="function"||typeof H.setAttribute!="function"||typeof H.namespaceURI!="string"||typeof H.insertBefore!="function"||typeof H.hasChildNodes!="function")},Se=function(H){return typeof a=="object"?H instanceof a:H&&typeof H=="object"&&typeof H.nodeType=="number"&&typeof H.nodeName=="string"},_e=function(H,fe,Le){G[H]&&sV(G[H],Nt=>{Nt.call(e,fe,Le,M)})},Ze=function(H){let fe;if(_e("beforeSanitizeElements",H,null),J(H))return T(H),!0;let Le=se(H.nodeName);if(_e("uponSanitizeElement",H,{tagName:Le,allowedTags:Q}),H.hasChildNodes()&&!Se(H.firstElementChild)&&(!Se(H.content)||!Se(H.content.firstElementChild))&&zo(/<[/\w]/g,H.innerHTML)&&zo(/<[/\w]/g,H.textContent))return T(H),!0;if(!Q[Le]||ke[Le]){if(!ke[Le]&&Vt(Le)&&(Xe.tagNameCheck instanceof RegExp&&zo(Xe.tagNameCheck,Le)||Xe.tagNameCheck instanceof Function&&Xe.tagNameCheck(Le)))return!1;if($s&&!Yo[Le]){let Nt=C(H)||H.parentNode,En=y(H)||H.childNodes;if(En&&Nt){let Mi=En.length;for(let hn=Mi-1;hn>=0;--hn)Nt.insertBefore(g(En[hn],!0),b(H))}}return T(H),!0}return H instanceof l&&!_(H)||(Le==="noscript"||Le==="noembed"||Le==="noframes")&&zo(/<\/no(script|embed|frames)/i,H.innerHTML)?(T(H),!0):(ai&&H.nodeType===3&&(fe=H.textContent,fe=_r(fe,q," "),fe=_r(fe,X," "),fe=_r(fe,ce," "),H.textContent!==fe&&(Zp(e.removed,{element:H.cloneNode()}),H.textContent=fe)),_e("afterSanitizeElements",H,null),!1)},bt=function(H,fe,Le){if(Rc&&(fe==="id"||fe==="name")&&(Le in i||Le in ee))return!1;if(!(ji&&!$n[fe]&&zo(Ce,fe))){if(!(xn&&zo(te,fe))){if(!xe[fe]||$n[fe]){if(!(Vt(H)&&(Xe.tagNameCheck instanceof RegExp&&zo(Xe.tagNameCheck,H)||Xe.tagNameCheck instanceof Function&&Xe.tagNameCheck(H))&&(Xe.attributeNameCheck instanceof RegExp&&zo(Xe.attributeNameCheck,fe)||Xe.attributeNameCheck instanceof Function&&Xe.attributeNameCheck(fe))||fe==="is"&&Xe.allowCustomizedBuiltInElements&&(Xe.tagNameCheck instanceof RegExp&&zo(Xe.tagNameCheck,Le)||Xe.tagNameCheck instanceof Function&&Xe.tagNameCheck(Le))))return!1}else if(!Qr[fe]){if(!zo(ne,_r(Le,le,""))){if(!((fe==="src"||fe==="xlink:href"||fe==="href")&&H!=="script"&&lV(Le,"data:")===0&&Zl[H])){if(!(po&&!zo(Z,_r(Le,le,"")))){if(Le)return!1}}}}}}return!0},Vt=function(H){return H.indexOf("-")>0},bn=function(H){let fe,Le,Nt,En;_e("beforeSanitizeAttributes",H,null);let{attributes:Mi}=H;if(!Mi)return;let hn={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:xe};for(En=Mi.length;En--;){fe=Mi[En];let{name:ts,namespaceURI:Vw}=fe;if(Le=ts==="value"?fe.value:dV(fe.value),Nt=se(ts),hn.attrName=Nt,hn.attrValue=Le,hn.keepAttr=!0,hn.forceKeepAttr=void 0,_e("uponSanitizeAttribute",H,hn),Le=hn.attrValue,hn.forceKeepAttr||(A(ts,H),!hn.keepAttr))continue;if(!Aa&&zo(/\/>/i,Le)){A(ts,H);continue}ai&&(Le=_r(Le,q," "),Le=_r(Le,X," "),Le=_r(Le,ce," "));let h1=se(H.nodeName);if(bt(h1,Nt,Le)){if(Mc&&(Nt==="id"||Nt==="name")&&(A(ts,H),Le=Ae+Le),x&&typeof m=="object"&&typeof m.getAttributeType=="function"&&!Vw)switch(m.getAttributeType(h1,Nt)){case"TrustedHTML":{Le=x.createHTML(Le);break}case"TrustedScriptURL":{Le=x.createScriptURL(Le);break}}try{Vw?H.setAttributeNS(Vw,ts,Le):H.setAttribute(ts,Le),Kk(e.removed)}catch{}}}_e("afterSanitizeAttributes",H,null)},jt=function Re(H){let fe,Le=$(H);for(_e("beforeSanitizeShadowDOM",H,null);fe=Le.nextNode();)_e("uponSanitizeShadowNode",fe,null),!Ze(fe)&&(fe.content instanceof r&&Re(fe.content),bn(fe));_e("afterSanitizeShadowDOM",H,null)};return e.sanitize=function(Re){let H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},fe,Le,Nt,En;if(qs=!Re,qs&&(Re="<!-->"),typeof Re!="string"&&!Se(Re))if(typeof Re.toString=="function"){if(Re=Re.toString(),typeof Re!="string")throw Xp("dirty is not a string, aborting")}else throw Xp("toString is not a function");if(!e.isSupported)return Re;if(Yl||qe(H),e.removed=[],typeof Re=="string"&&(Fa=!1),Fa){if(Re.nodeName){let ts=se(Re.nodeName);if(!Q[ts]||ke[ts])throw Xp("root node is forbidden and cannot be sanitized in-place")}}else if(Re instanceof a)fe=F("<!---->"),Le=fe.ownerDocument.importNode(Re,!0),Le.nodeType===1&&Le.nodeName==="BODY"||Le.nodeName==="HTML"?fe=Le:fe.appendChild(Le);else{if(!li&&!ai&&!mr&&Re.indexOf("<")===-1)return x&&Pa?x.createHTML(Re):Re;if(fe=F(Re),!fe)return li?null:Pa?L:""}fe&&Oa&&T(fe.firstChild);let Mi=$(Fa?Re:fe);for(;Nt=Mi.nextNode();)Ze(Nt)||(Nt.content instanceof r&&jt(Nt.content),bn(Nt));if(Fa)return Re;if(li){if(Na)for(En=W.call(fe.ownerDocument);fe.firstChild;)En.appendChild(fe.firstChild);else En=fe;return(xe.shadowroot||xe.shadowrootmode)&&(En=B.call(t,En,!0)),En}let hn=mr?fe.outerHTML:fe.innerHTML;return mr&&Q["!doctype"]&&fe.ownerDocument&&fe.ownerDocument.doctype&&fe.ownerDocument.doctype.name&&zo(Qk,fe.ownerDocument.doctype.name)&&(hn="<!DOCTYPE "+fe.ownerDocument.doctype.name+`>
`+hn),ai&&(hn=_r(hn,q," "),hn=_r(hn,X," "),hn=_r(hn,ce," ")),x&&Pa?x.createHTML(hn):hn},e.setConfig=function(Re){qe(Re),Yl=!0},e.clearConfig=function(){M=null,Yl=!1},e.isValidAttribute=function(Re,H,fe){M||qe({});let Le=se(Re),Nt=se(H);return bt(Le,Nt,fe)},e.addHook=function(Re,H){typeof H=="function"&&(G[Re]=G[Re]||[],Zp(G[Re],H))},e.removeHook=function(Re){if(G[Re])return Kk(G[Re])},e.removeHooks=function(Re){G[Re]&&(G[Re]=[])},e.removeAllHooks=function(){G={}},e}var ds=Jk();var iK=ds.version,oK=ds.isSupported,Qp=ds.sanitize,rK=ds.setConfig,sK=ds.clearConfig,aK=ds.isValidAttribute,Ib=ds.addHook,Cb=ds.removeHook,lK=ds.removeHooks,dK=ds.removeAllHooks;function cs(o){return Ux(o,0)}function Ux(o,e){switch(typeof o){case"object":return o===null?ia(349,e):Array.isArray(o)?wV(o,e):xV(o,e);case"string":return zx(o,e);case"boolean":return SV(o,e);case"number":return ia(o,e);case"undefined":return ia(937,e);default:return ia(617,e)}}function ia(o,e){return(e<<5)-e+o|0}function SV(o,e){return ia(o?433:863,e)}function zx(o,e){e=ia(149417,e);for(let t=0,n=o.length;t<n;t++)e=ia(o.charCodeAt(t),e);return e}function wV(o,e){return e=ia(104579,e),o.reduce((t,n)=>Ux(n,t),e)}function xV(o,e){return e=ia(181387,e),Object.keys(o).sort().reduce((t,n)=>(t=zx(n,t),Ux(o[n],t)),e)}function Hx(o,e,t=32){let n=t-e,i=~((1<<n)-1);return(o<<e|(i&o)>>>n)>>>0}function tR(o,e=0,t=o.byteLength,n=0){for(let i=0;i<t;i++)o[e+i]=n}function EV(o,e,t="0"){for(;o.length<e;)o=t+o;return o}function Jp(o,e=32){return o instanceof ArrayBuffer?Array.from(new Uint8Array(o)).map(t=>t.toString(16).padStart(2,"0")).join(""):EV((o>>>0).toString(16),e/4)}var nR=class o{static _bigBlock32=new DataView(new ArrayBuffer(320));_h0=1732584193;_h1=4023233417;_h2=2562383102;_h3=271733878;_h4=3285377520;_buff;_buffDV;_buffLen;_totalLen;_leftoverHighSurrogate;_finished;constructor(){this._buff=new Uint8Array(67),this._buffDV=new DataView(this._buff.buffer),this._buffLen=0,this._totalLen=0,this._leftoverHighSurrogate=0,this._finished=!1}update(e){let t=e.length;if(t===0)return;let n=this._buff,i=this._buffLen,r=this._leftoverHighSurrogate,s,a;for(r!==0?(s=r,a=-1,r=0):(s=e.charCodeAt(0),a=0);;){let l=s;if(Ht(s))if(a+1<t){let d=e.charCodeAt(a+1);Qa(d)?(a++,l=ib(s,d)):l=65533}else{r=s;break}else Qa(s)&&(l=65533);if(i=this._push(n,i,l),a++,a<t)s=e.charCodeAt(a);else break}this._buffLen=i,this._leftoverHighSurrogate=r}_push(e,t,n){return n<128?e[t++]=n:n<2048?(e[t++]=192|(n&1984)>>>6,e[t++]=128|(n&63)>>>0):n<65536?(e[t++]=224|(n&61440)>>>12,e[t++]=128|(n&4032)>>>6,e[t++]=128|(n&63)>>>0):(e[t++]=240|(n&1835008)>>>18,e[t++]=128|(n&258048)>>>12,e[t++]=128|(n&4032)>>>6,e[t++]=128|(n&63)>>>0),t>=64&&(this._step(),t-=64,this._totalLen+=64,e[0]=e[64],e[1]=e[65],e[2]=e[66]),t}digest(){return this._finished||(this._finished=!0,this._leftoverHighSurrogate&&(this._leftoverHighSurrogate=0,this._buffLen=this._push(this._buff,this._buffLen,65533)),this._totalLen+=this._buffLen,this._wrapUp()),Jp(this._h0)+Jp(this._h1)+Jp(this._h2)+Jp(this._h3)+Jp(this._h4)}_wrapUp(){this._buff[this._buffLen++]=128,tR(this._buff,this._buffLen),this._buffLen>56&&(this._step(),tR(this._buff));let e=8*this._totalLen;this._buffDV.setUint32(56,Math.floor(e/4294967296),!1),this._buffDV.setUint32(60,e%4294967296,!1),this._step()}_step(){let e=o._bigBlock32,t=this._buffDV;for(let u=0;u<64;u+=4)e.setUint32(u,t.getUint32(u,!1),!1);for(let u=64;u<320;u+=4)e.setUint32(u,Hx(e.getUint32(u-12,!1)^e.getUint32(u-32,!1)^e.getUint32(u-56,!1)^e.getUint32(u-64,!1),1),!1);let n=this._h0,i=this._h1,r=this._h2,s=this._h3,a=this._h4,l,d,c;for(let u=0;u<80;u++)u<20?(l=i&r|~i&s,d=1518500249):u<40?(l=i^r^s,d=1859775393):u<60?(l=i&r|i&s|r&s,d=2400959708):(l=i^r^s,d=3395469782),c=Hx(n,5)+l+a+d+e.getUint32(u*4,!1)&4294967295,a=s,s=r,r=Hx(i,30),i=n,n=c;this._h0=this._h0+n&4294967295,this._h1=this._h1+i&4294967295,this._h2=this._h2+r&4294967295,this._h3=this._h3+s&4294967295,this._h4=this._h4+a&4294967295}};function eu(o,e,t){return Math.min(Math.max(o,e),t)}var{registerWindow:rR,getWindow:Ie,getDocument:kK,getWindows:tm,getWindowsCount:wb,getWindowId:il,getWindowById:fd,hasWindow:RK,onDidRegisterWindow:$x,onWillUnregisterWindow:MK,onDidUnregisterWindow:sR}=function(){let o=new Map;If(De,1);let e={window:De,disposables:new he};o.set(De.vscodeWindowId,e);let t=new E,n=new E,i=new E;function r(s,a){return(typeof s=="number"?o.get(s):void 0)??(a?e:void 0)}return{onDidRegisterWindow:t.event,onWillUnregisterWindow:i.event,onDidUnregisterWindow:n.event,registerWindow(s){if(o.has(s.vscodeWindowId))return V.None;let a=new he,l={window:s,disposables:a.add(new he)};return o.set(s.vscodeWindowId,l),a.add(ve(()=>{o.delete(s.vscodeWindowId),n.fire(s)})),a.add(U(s,ae.BEFORE_UNLOAD,()=>{i.fire(s)})),t.fire(l),a},getWindows(){return o.values()},getWindowsCount(){return o.size},getWindowId(s){return s.vscodeWindowId},hasWindow(s){return o.has(s)},getWindowById:r,getWindow(s){let a=s;if(a?.ownerDocument?.defaultView)return a.ownerDocument.defaultView.window;let l=s;return l?.view?l.view.window:De},getDocument(s){return Ie(s).document}}}();function Ci(o){for(;o.firstChild;)o.firstChild.remove()}var Gx=class{_handler;_node;_type;_options;constructor(e,t,n,i){this._node=e,this._type=t,this._handler=n,this._options=i||!1,this._node.addEventListener(this._type,this._handler,this._options)}dispose(){this._handler&&(this._node.removeEventListener(this._type,this._handler,this._options),this._node=null,this._handler=null)}};function U(o,e,t,n){return new Gx(o,e,t,n)}function _V(o,e){return function(t){return e(new hi(o,t))}}function TV(o){return function(e){return o(new nt(e))}}var Jt=function(e,t,n,i){let r=n;return t==="click"||t==="mousedown"||t==="contextmenu"?r=_V(Ie(e),n):(t==="keydown"||t==="keypress"||t==="keyup")&&(r=TV(n)),U(e,t,r,i)};function nm(o,e,t){return Xc(o,e,t)}var qx,Fn;var tu=class extends hb{defaultTarget;constructor(e){super(),this.defaultTarget=e&&Ie(e)}cancelAndSet(e,t,n){return super.cancelAndSet(e,t,n??this.defaultTarget)}},em=class{_runner;priority;_canceled;constructor(e,t=0){this._runner=e,this.priority=t,this._canceled=!1}dispose(){this._canceled=!0}execute(){if(!this._canceled)try{this._runner()}catch(e){je(e)}}static sort(e,t){return t.priority-e.priority}};(function(){let o=new Map,e=new Map,t=new Map,n=new Map,i=r=>{t.set(r,!1);let s=o.get(r)??[];for(e.set(r,s),o.set(r,[]),n.set(r,!0);s.length>0;)s.sort(em.sort),s.shift().execute();n.set(r,!1)};Fn=(r,s,a=0)=>{let l=il(r),d=new em(s,a),c=o.get(l);return c||(c=[],o.set(l,c)),c.push(d),t.get(l)||(t.set(l,!0),r.requestAnimationFrame(()=>i(l))),d},qx=(r,s,a)=>{let l=il(r);if(n.get(l)){let d=new em(s,a),c=e.get(l);return c||(c=[],e.set(l,c)),c.push(d),d}else return Fn(r,s,a)}})();function aR(o){return Ie(o).getComputedStyle(o,null)}function bd(o,e){let t=Ie(o),n=t.document;if(o!==n.body)return new Ii(o.clientWidth,o.clientHeight);if(Va&&t?.visualViewport)return new Ii(t.visualViewport.width,t.visualViewport.height);if(t?.innerWidth&&t.innerHeight)return new Ii(t.innerWidth,t.innerHeight);if(n.body&&n.body.clientWidth&&n.body.clientHeight)return new Ii(n.body.clientWidth,n.body.clientHeight);if(n.documentElement&&n.documentElement.clientWidth&&n.documentElement.clientHeight)return new Ii(n.documentElement.clientWidth,n.documentElement.clientHeight);if(e)return bd(e);throw new Error("Unable to figure out browser width and height")}var Oi=class o{static convertToPixels(e,t){return parseFloat(t)||0}static getDimension(e,t,n){let i=aR(e),r=i?i.getPropertyValue(t):"0";return o.convertToPixels(e,r)}static getBorderLeftWidth(e){return o.getDimension(e,"border-left-width","borderLeftWidth")}static getBorderRightWidth(e){return o.getDimension(e,"border-right-width","borderRightWidth")}static getBorderTopWidth(e){return o.getDimension(e,"border-top-width","borderTopWidth")}static getBorderBottomWidth(e){return o.getDimension(e,"border-bottom-width","borderBottomWidth")}static getPaddingLeft(e){return o.getDimension(e,"padding-left","paddingLeft")}static getPaddingRight(e){return o.getDimension(e,"padding-right","paddingRight")}static getPaddingTop(e){return o.getDimension(e,"padding-top","paddingTop")}static getPaddingBottom(e){return o.getDimension(e,"padding-bottom","paddingBottom")}static getMarginLeft(e){return o.getDimension(e,"margin-left","marginLeft")}static getMarginTop(e){return o.getDimension(e,"margin-top","marginTop")}static getMarginRight(e){return o.getDimension(e,"margin-right","marginRight")}static getMarginBottom(e){return o.getDimension(e,"margin-bottom","marginBottom")}},Ii=class o{constructor(e,t){this.width=e;this.height=t}static None=new o(0,0);with(e=this.width,t=this.height){return e!==this.width||t!==this.height?new o(e,t):this}static is(e){return typeof e=="object"&&typeof e.height=="number"&&typeof e.width=="number"}static lift(e){return e instanceof o?e:new o(e.width,e.height)}static equals(e,t){return e===t?!0:!e||!t?!1:e.width===t.width&&e.height===t.height}};function im(o){let e=o.offsetParent,t=o.offsetTop,n=o.offsetLeft;for(;(o=o.parentNode)!==null&&o!==o.ownerDocument.body&&o!==o.ownerDocument.documentElement;){t-=o.scrollTop;let i=cR(o)?null:aR(o);i&&(n-=i.direction!=="rtl"?o.scrollLeft:-o.scrollLeft),o===e&&(n+=Oi.getBorderLeftWidth(o),t+=Oi.getBorderTopWidth(o),t+=o.offsetTop,n+=o.offsetLeft,e=o.offsetParent)}return{left:n,top:t}}function lR(o,e,t,n,i,r="absolute"){typeof e=="number"&&(o.style.top=`${e}px`),typeof t=="number"&&(o.style.right=`${t}px`),typeof n=="number"&&(o.style.bottom=`${n}px`),typeof i=="number"&&(o.style.left=`${i}px`),o.style.position=r}function yo(o){let e=o.getBoundingClientRect(),t=Ie(o);return{left:e.left+t.scrollX,top:e.top+t.scrollY,width:e.width,height:e.height}}function iu(o){let e=Oi.getMarginLeft(o)+Oi.getMarginRight(o);return o.offsetWidth+e}function xb(o){let e=Oi.getBorderLeftWidth(o)+Oi.getBorderRightWidth(o),t=Oi.getPaddingLeft(o)+Oi.getPaddingRight(o);return o.offsetWidth-e-t}function dR(o){let e=Oi.getBorderTopWidth(o)+Oi.getBorderBottomWidth(o),t=Oi.getPaddingTop(o)+Oi.getPaddingBottom(o);return o.offsetHeight-e-t}function Eb(o){let e=Oi.getMarginTop(o)+Oi.getMarginBottom(o);return o.offsetHeight+e}function Jo(o,e){return!!e?.contains(o)}function cR(o){return o&&!!o.host&&!!o.mode}function ol(o){for(;o.parentNode;){if(o===o.ownerDocument?.body)return null;o=o.parentNode}return cR(o)?o:null}function eo(){let o=Yx().activeElement;for(;o?.shadowRoot;)o=o.shadowRoot.activeElement;return o}function er(o){return eo()===o}function Yx(){return wb()<=1?De.document:Array.from(tm()).map(({window:e})=>e.document).find(e=>e.hasFocus())??De.document}function rl(){return Yx().defaultView?.window??De}var _b=new Map;function uR(o){return _b.has(o)}function us(o=De.document.head,e,t){let n=document.createElement("style");if(n.type="text/css",n.media="screen",e?.(n),o.appendChild(n),t&&t.add(ve(()=>n.remove())),o===De.document.head){let i=new Set;_b.set(n,i);for(let{window:r,disposables:s}of tm()){if(r===De)continue;let a=s.add(pR(n,i,r));t?.add(a)}}return n}function hR(o){let e=new he;for(let[t,n]of _b)e.add(pR(t,n,o));return e}function pR(o,e,t){let n=new he,i=o.cloneNode(!0);t.document.head.appendChild(i),n.add(ve(()=>i.remove()));for(let r of DV(o))i.sheet?.insertRule(r.cssText,i.sheet?.cssRules.length);return n.add(Tb.observe(o,n,{childList:!0})(()=>{i.textContent=o.textContent})),e.add(i),n.add(ve(()=>e.delete(i))),n}var Tb=new class{mutationObservers=new Map;observe(o,e,t){let n=this.mutationObservers.get(o);n||(n=new Map,this.mutationObservers.set(o,n));let i=cs(t),r=n.get(i);if(r)r.users+=1;else{let s=new E,a=new MutationObserver(d=>s.fire(d));a.observe(o,t);let l=r={users:1,observer:a,onDidMutate:s.event};e.add(ve(()=>{l.users-=1,l.users===0&&(s.dispose(),a.disconnect(),n?.delete(i),n?.size===0&&this.mutationObservers.delete(o))})),n.set(i,r)}return r.onDidMutate}};function mR(o=De.document.head){return fR("meta",o)}function gR(o=De.document.head){return fR("link",o)}function fR(o,e=De.document.head){let t=document.createElement(o);return e.appendChild(t),t}var Kx=null;function LV(){return Kx||(Kx=us()),Kx}function DV(o){return o?.sheet?.rules?o.sheet.rules:o?.sheet?.cssRules?o.sheet.cssRules:[]}function Zx(o,e,t=LV()){if(!(!t||!e)){t.sheet?.insertRule(`${o} {${e}}`,0);for(let n of _b.get(t)??[])Zx(o,e,n)}}function yn(o){return o instanceof HTMLElement||o instanceof Ie(o).HTMLElement}function bR(o){return o instanceof SVGElement||o instanceof Ie(o).SVGElement}function Lb(o){return o instanceof MouseEvent||o instanceof Ie(o).MouseEvent}function Xx(o){return o instanceof KeyboardEvent||o instanceof Ie(o).KeyboardEvent}var ae={CLICK:"click",AUXCLICK:"auxclick",DBLCLICK:"dblclick",MOUSE_UP:"mouseup",MOUSE_DOWN:"mousedown",MOUSE_OVER:"mouseover",MOUSE_MOVE:"mousemove",MOUSE_OUT:"mouseout",MOUSE_ENTER:"mouseenter",MOUSE_LEAVE:"mouseleave",MOUSE_WHEEL:"wheel",POINTER_UP:"pointerup",POINTER_DOWN:"pointerdown",POINTER_MOVE:"pointermove",POINTER_LEAVE:"pointerleave",CONTEXT_MENU:"contextmenu",WHEEL:"wheel",KEY_DOWN:"keydown",KEY_PRESS:"keypress",KEY_UP:"keyup",LOAD:"load",BEFORE_UNLOAD:"beforeunload",UNLOAD:"unload",PAGE_SHOW:"pageshow",PAGE_HIDE:"pagehide",PASTE:"paste",ABORT:"abort",ERROR:"error",RESIZE:"resize",SCROLL:"scroll",FULLSCREEN_CHANGE:"fullscreenchange",WK_FULLSCREEN_CHANGE:"webkitfullscreenchange",SELECT:"select",CHANGE:"change",SUBMIT:"submit",RESET:"reset",FOCUS:"focus",FOCUS_IN:"focusin",FOCUS_OUT:"focusout",BLUR:"blur",INPUT:"input",STORAGE:"storage",DRAG_START:"dragstart",DRAG:"drag",DRAG_ENTER:"dragenter",DRAG_LEAVE:"dragleave",DRAG_OVER:"dragover",DROP:"drop",DRAG_END:"dragend",ANIMATION_START:Sr?"webkitAnimationStart":"animationstart",ANIMATION_END:Sr?"webkitAnimationEnd":"animationend",ANIMATION_ITERATION:Sr?"webkitAnimationIteration":"animationiteration"};var $e={stop:(o,e)=>(o.preventDefault(),e&&o.stopPropagation(),o)};function vR(o){let e=[];for(let t=0;o&&o.nodeType===o.ELEMENT_NODE;t++)e[t]=o.scrollTop,o=o.parentNode;return e}function yR(o,e){for(let t=0;o&&o.nodeType===o.ELEMENT_NODE;t++)o.scrollTop!==e[t]&&(o.scrollTop=e[t]),o=o.parentNode}var jx=class o extends V{_onDidFocus=this._register(new E);onDidFocus=this._onDidFocus.event;_onDidBlur=this._register(new E);onDidBlur=this._onDidBlur.event;_refreshStateHandler;static hasFocusWithin(e){if(yn(e)){let t=ol(e),n=t?t.activeElement:e.ownerDocument.activeElement;return Jo(n,e)}else{let t=e;return Jo(t.document.activeElement,t.document)}}constructor(e){super();let t=o.hasFocusWithin(e),n=!1,i=()=>{n=!1,t||(t=!0,this._onDidFocus.fire())},r=()=>{t&&(n=!0,(yn(e)?Ie(e):e).setTimeout(()=>{n&&(n=!1,t=!1,this._onDidBlur.fire())},0))};this._refreshStateHandler=()=>{o.hasFocusWithin(e)!==t&&(t?r():i())},this._register(U(e,ae.FOCUS,i,!0)),this._register(U(e,ae.BLUR,r,!0)),yn(e)&&(this._register(U(e,ae.FOCUS_IN,()=>this._refreshStateHandler())),this._register(U(e,ae.FOCUS_OUT,()=>this._refreshStateHandler())))}refreshState(){this._refreshStateHandler()}};function Ni(o){return new jx(o)}function IR(o,e){return o.after(e),e}function Ke(o,...e){if(o.append(...e),e.length===1&&typeof e[0]!="string")return e[0]}function Qx(o,e){return o.insertBefore(e,o.firstChild),e}function oa(o,...e){o.innerText="",Ke(o,...e)}var kV=/([\w\-]+)?(#([\w\-]+))?((\.([\w\-]+))*)/;function CR(o,e,t,...n){let i=kV.exec(e);if(!i)throw new Error("Bad use of emmet");let r=i[1]||"div",s;return o!=="http://www.w3.org/1999/xhtml"?s=document.createElementNS(o,r):s=document.createElement(r),i[3]&&(s.id=i[3]),i[4]&&(s.className=i[4].replace(/\./g," ").trim()),t&&Object.entries(t).forEach(([a,l])=>{typeof l>"u"||(/^on\w+$/.test(a)?s[a]=l:a==="selected"?l&&s.setAttribute(a,"true"):s.setAttribute(a,l))}),s.append(...n),s}function We(o,e,...t){return CR("http://www.w3.org/1999/xhtml",o,e,...t)}We.SVG=function(o,e,...t){return CR("http://www.w3.org/2000/svg",o,e,...t)};function om(...o){for(let e of o)e.style.display="",e.removeAttribute("aria-hidden")}function Db(...o){for(let e of o)e.style.display="none",e.setAttribute("aria-hidden","true")}function Jx(o,e){let t=o.devicePixelRatio*e;return Math.max(1,Math.floor(t))/o.devicePixelRatio}function eE(o){De.open(o,"_blank","noopener")}var iR=780,oR=640;function tE(o){let e=Math.floor(De.screenLeft+De.innerWidth/2-iR/2),t=Math.floor(De.screenTop+De.innerHeight/2-oR/2);De.open(o,"_blank",`width=${iR},height=${oR},top=${t},left=${e}`)}function SR(o,e=!0){let t=De.open();return t?(e&&(t.opener=null),t.location.href=o,!0):!1}function wR(o,e){let t=()=>{e(),n=Fn(o,t)},n=Fn(o,t);return ve(()=>n.dispose())}ub.setPreferredWebSchema(/^https:/.test(De.location.href)?"https":"http");function sl(o){return o?`url('${el.uriToBrowserUri(o).toString(!0).replace(/'/g,"%27")}')`:"url('')"}function Ko(o,e){if(o!==void 0){let t=o.match(/^\s*var\((.+)\)$/);if(t){let n=t[1].split(",",2);return n.length===2&&(e=Ko(n[1].trim(),e)),`var(${n[0]}, ${e})`}return o}return e}function xR(o,e=!1){let t=document.createElement("a");return Ib("afterSanitizeAttributes",n=>{for(let i of["href","src"])if(n.hasAttribute(i)){let r=n.getAttribute(i);if(i==="href"&&r.startsWith("#"))continue;if(t.href=r,!o.includes(t.protocol.replace(/:$/,""))){if(e&&i==="src"&&t.href.startsWith("data:"))continue;n.removeAttribute(i)}}}),ve(()=>{Cb("afterSanitizeAttributes")})}var AK=[Te.http,Te.https,Te.command],ER=Object.freeze(["a","abbr","b","bdo","blockquote","br","caption","cite","code","col","colgroup","dd","del","details","dfn","div","dl","dt","em","figcaption","figure","h1","h2","h3","h4","h5","h6","hr","i","img","input","ins","kbd","label","li","mark","ol","p","pre","q","rp","rt","ruby","samp","small","small","source","span","strike","strong","sub","summary","sup","table","tbody","td","tfoot","th","thead","time","tr","tt","u","ul","var","video","wbr"]),OK=Object.freeze({ALLOWED_TAGS:["a","button","blockquote","code","div","h1","h2","h3","h4","h5","h6","hr","input","label","li","p","pre","select","small","span","strong","textarea","ul","ol"],ALLOWED_ATTR:["href","data-href","data-command","target","title","name","src","alt","class","id","role","tabindex","style","data-code","width","height","align","x-dispatch","required","checked","placeholder","type","start"],RETURN_DOM:!1,RETURN_DOM_FRAGMENT:!1,RETURN_TRUSTED_TYPE:!0});var nu=class o extends E{_subscriptions=new he;_keyStatus;static instance;constructor(){super(),this._keyStatus={altKey:!1,shiftKey:!1,ctrlKey:!1,metaKey:!1},this._subscriptions.add(oe.runAndSubscribe($x,({window:e,disposables:t})=>this.registerListeners(e,t),{window:De,disposables:this._subscriptions}))}registerListeners(e,t){t.add(U(e,"keydown",n=>{if(n.defaultPrevented)return;let i=new nt(n);if(!(i.keyCode===6&&n.repeat)){if(n.altKey&&!this._keyStatus.altKey)this._keyStatus.lastKeyPressed="alt";else if(n.ctrlKey&&!this._keyStatus.ctrlKey)this._keyStatus.lastKeyPressed="ctrl";else if(n.metaKey&&!this._keyStatus.metaKey)this._keyStatus.lastKeyPressed="meta";else if(n.shiftKey&&!this._keyStatus.shiftKey)this._keyStatus.lastKeyPressed="shift";else if(i.keyCode!==6)this._keyStatus.lastKeyPressed=void 0;else return;this._keyStatus.altKey=n.altKey,this._keyStatus.ctrlKey=n.ctrlKey,this._keyStatus.metaKey=n.metaKey,this._keyStatus.shiftKey=n.shiftKey,this._keyStatus.lastKeyPressed&&(this._keyStatus.event=n,this.fire(this._keyStatus))}},!0)),t.add(U(e,"keyup",n=>{n.defaultPrevented||(!n.altKey&&this._keyStatus.altKey?this._keyStatus.lastKeyReleased="alt":!n.ctrlKey&&this._keyStatus.ctrlKey?this._keyStatus.lastKeyReleased="ctrl":!n.metaKey&&this._keyStatus.metaKey?this._keyStatus.lastKeyReleased="meta":!n.shiftKey&&this._keyStatus.shiftKey?this._keyStatus.lastKeyReleased="shift":this._keyStatus.lastKeyReleased=void 0,this._keyStatus.lastKeyPressed!==this._keyStatus.lastKeyReleased&&(this._keyStatus.lastKeyPressed=void 0),this._keyStatus.altKey=n.altKey,this._keyStatus.ctrlKey=n.ctrlKey,this._keyStatus.metaKey=n.metaKey,this._keyStatus.shiftKey=n.shiftKey,this._keyStatus.lastKeyReleased&&(this._keyStatus.event=n,this.fire(this._keyStatus)))},!0)),t.add(U(e.document.body,"mousedown",()=>{this._keyStatus.lastKeyPressed=void 0},!0)),t.add(U(e.document.body,"mouseup",()=>{this._keyStatus.lastKeyPressed=void 0},!0)),t.add(U(e.document.body,"mousemove",n=>{n.buttons&&(this._keyStatus.lastKeyPressed=void 0)},!0)),t.add(U(e,"blur",()=>{this.resetKeyStatus()}))}get keyStatus(){return this._keyStatus}get isModifierPressed(){return this._keyStatus.altKey||this._keyStatus.ctrlKey||this._keyStatus.metaKey||this._keyStatus.shiftKey}resetKeyStatus(){this.doResetKeyStatus(),this.fire(this._keyStatus)}doResetKeyStatus(){this._keyStatus={altKey:!1,shiftKey:!1,ctrlKey:!1,metaKey:!1}}static getInstance(){return o.instance||(o.instance=new o),o.instance}dispose(){super.dispose(),this._subscriptions.dispose()}};var Sb=class extends V{constructor(t,n){super();this.element=t;this.callbacks=n;this.registerListeners()}counter=0;dragStartTime=0;registerListeners(){this.callbacks.onDragStart&&this._register(U(this.element,ae.DRAG_START,t=>{this.callbacks.onDragStart?.(t)})),this.callbacks.onDrag&&this._register(U(this.element,ae.DRAG,t=>{this.callbacks.onDrag?.(t)})),this._register(U(this.element,ae.DRAG_ENTER,t=>{this.counter++,this.dragStartTime=t.timeStamp,this.callbacks.onDragEnter?.(t)})),this._register(U(this.element,ae.DRAG_OVER,t=>{t.preventDefault(),this.callbacks.onDragOver?.(t,t.timeStamp-this.dragStartTime)})),this._register(U(this.element,ae.DRAG_LEAVE,t=>{this.counter--,this.counter===0&&(this.dragStartTime=0,this.callbacks.onDragLeave?.(t))})),this._register(U(this.element,ae.DRAG_END,t=>{this.counter=0,this.dragStartTime=0,this.callbacks.onDragEnd?.(t)})),this._register(U(this.element,ae.DROP,t=>{this.counter=0,this.dragStartTime=0,this.callbacks.onDrop?.(t)}))}};function kb(o,e,t){for(let{name:n,value:i}of o.attributes)(!t||t.includes(n))&&e.setAttribute(n,i)}function RV(o,e,t){let n=o.getAttribute(t);n?e.setAttribute(t,n):e.removeAttribute(t)}function Rb(o,e,t){kb(o,e,t);let n=new he;return n.add(Tb.observe(o,n,{attributes:!0,attributeFilter:t})(i=>{for(let r of i)r.type==="attributes"&&r.attributeName&&RV(o,e,r.attributeName)})),n}function hs(o){return o.tagName.toLowerCase()==="input"||o.tagName.toLowerCase()==="textarea"||yn(o)&&!!o.editContext}function de(o,e,t){let n=null,i=null;if(typeof t.value=="function"?(n="value",i=t.value,i.length!==0&&console.warn("Memoize should only be used in functions with zero parameters")):typeof t.get=="function"&&(n="get",i=t.get),!i)throw new Error("not supported");let r=`$memoize$${e}`;t[n]=function(...s){return this.hasOwnProperty(r)||Object.defineProperty(this,r,{configurable:!1,enumerable:!1,writable:!1,value:i.apply(this,s)}),this[r]}}var at;(r=>(r.Tap="-monaco-gesturetap",r.Change="-monaco-gesturechange",r.Start="-monaco-gesturestart",r.End="-monaco-gesturesend",r.Contextmenu="-monaco-gesturecontextmenu"))(at||={});var mi=class mi extends V{static SCROLL_FRICTION=-.005;static INSTANCE;static HOLD_DELAY=700;dispatched=!1;targets=new ui;ignoreTargets=new ui;handle;activeTouches;_lastSetTapCountTime;static CLEAR_TAP_COUNT_TIME=400;constructor(){super(),this.activeTouches={},this.handle=null,this._lastSetTapCountTime=0,this._register(oe.runAndSubscribe($x,({window:e,disposables:t})=>{t.add(U(e.document,"touchstart",n=>this.onTouchStart(n),{passive:!1})),t.add(U(e.document,"touchend",n=>this.onTouchEnd(e,n))),t.add(U(e.document,"touchmove",n=>this.onTouchMove(n),{passive:!1}))},{window:De,disposables:this._store}))}static addTarget(e){if(!mi.isTouchDevice())return V.None;mi.INSTANCE||(mi.INSTANCE=ja(new mi));let t=mi.INSTANCE.targets.push(e);return ve(t)}static ignoreTarget(e){if(!mi.isTouchDevice())return V.None;mi.INSTANCE||(mi.INSTANCE=ja(new mi));let t=mi.INSTANCE.ignoreTargets.push(e);return ve(t)}static isTouchDevice(){return"ontouchstart"in De||navigator.maxTouchPoints>0}dispose(){this.handle&&(this.handle.dispose(),this.handle=null),super.dispose()}onTouchStart(e){let t=Date.now();this.handle&&(this.handle.dispose(),this.handle=null);for(let n=0,i=e.targetTouches.length;n<i;n++){let r=e.targetTouches.item(n);this.activeTouches[r.identifier]={id:r.identifier,initialTarget:r.target,initialTimeStamp:t,initialPageX:r.pageX,initialPageY:r.pageY,rollingTimestamps:[t],rollingPageX:[r.pageX],rollingPageY:[r.pageY]};let s=this.newGestureEvent(at.Start,r.target);s.pageX=r.pageX,s.pageY=r.pageY,this.dispatchEvent(s)}this.dispatched&&(e.preventDefault(),e.stopPropagation(),this.dispatched=!1)}onTouchEnd(e,t){let n=Date.now(),i=Object.keys(this.activeTouches).length;for(let r=0,s=t.changedTouches.length;r<s;r++){let a=t.changedTouches.item(r);if(!this.activeTouches.hasOwnProperty(String(a.identifier))){console.warn("move of an UNKNOWN touch",a);continue}let l=this.activeTouches[a.identifier],d=Date.now()-l.initialTimeStamp;if(d<mi.HOLD_DELAY&&Math.abs(l.initialPageX-Yi(l.rollingPageX))<30&&Math.abs(l.initialPageY-Yi(l.rollingPageY))<30){let c=this.newGestureEvent(at.Tap,l.initialTarget);c.pageX=Yi(l.rollingPageX),c.pageY=Yi(l.rollingPageY),this.dispatchEvent(c)}else if(d>=mi.HOLD_DELAY&&Math.abs(l.initialPageX-Yi(l.rollingPageX))<30&&Math.abs(l.initialPageY-Yi(l.rollingPageY))<30){let c=this.newGestureEvent(at.Contextmenu,l.initialTarget);c.pageX=Yi(l.rollingPageX),c.pageY=Yi(l.rollingPageY),this.dispatchEvent(c)}else if(i===1){let c=Yi(l.rollingPageX),u=Yi(l.rollingPageY),h=Yi(l.rollingTimestamps)-l.rollingTimestamps[0],m=c-l.rollingPageX[0],f=u-l.rollingPageY[0],g=[...this.targets].filter(b=>l.initialTarget instanceof Node&&b.contains(l.initialTarget));this.inertia(e,g,n,Math.abs(m)/h,m>0?1:-1,c,Math.abs(f)/h,f>0?1:-1,u)}this.dispatchEvent(this.newGestureEvent(at.End,l.initialTarget)),delete this.activeTouches[a.identifier]}this.dispatched&&(t.preventDefault(),t.stopPropagation(),this.dispatched=!1)}newGestureEvent(e,t){let n=document.createEvent("CustomEvent");return n.initEvent(e,!1,!0),n.initialTarget=t,n.tapCount=0,n}dispatchEvent(e){if(e.type===at.Tap){let t=new Date().getTime(),n=0;t-this._lastSetTapCountTime>mi.CLEAR_TAP_COUNT_TIME?n=1:n=2,this._lastSetTapCountTime=t,e.tapCount=n}else(e.type===at.Change||e.type===at.Contextmenu)&&(this._lastSetTapCountTime=0);if(e.initialTarget instanceof Node){for(let n of this.ignoreTargets)if(n.contains(e.initialTarget))return;let t=[];for(let n of this.targets)if(n.contains(e.initialTarget)){let i=0,r=e.initialTarget;for(;r&&r!==n;)i++,r=r.parentElement;t.push([i,n])}t.sort((n,i)=>n[0]-i[0]);for(let[n,i]of t)i.dispatchEvent(e),this.dispatched=!0}}inertia(e,t,n,i,r,s,a,l,d){this.handle=Fn(e,()=>{let c=Date.now(),u=c-n,h=0,m=0,f=!0;i+=mi.SCROLL_FRICTION*u,a+=mi.SCROLL_FRICTION*u,i>0&&(f=!1,h=r*i*u),a>0&&(f=!1,m=l*a*u);let g=this.newGestureEvent(at.Change);g.translationX=h,g.translationY=m,t.forEach(b=>b.dispatchEvent(g)),f||this.inertia(e,t,c,i,r,s+h,a,l,d+m)})}onTouchMove(e){let t=Date.now();for(let n=0,i=e.changedTouches.length;n<i;n++){let r=e.changedTouches.item(n);if(!this.activeTouches.hasOwnProperty(String(r.identifier))){console.warn("end of an UNKNOWN touch",r);continue}let s=this.activeTouches[r.identifier],a=this.newGestureEvent(at.Change,s.initialTarget);a.translationX=r.pageX-Yi(s.rollingPageX),a.translationY=r.pageY-Yi(s.rollingPageY),a.pageX=r.pageX,a.pageY=r.pageY,this.dispatchEvent(a),s.rollingPageX.length>3&&(s.rollingPageX.shift(),s.rollingPageY.shift(),s.rollingTimestamps.shift()),s.rollingPageX.push(r.pageX),s.rollingPageY.push(r.pageY),s.rollingTimestamps.push(t)}this.dispatched&&(e.preventDefault(),e.stopPropagation(),this.dispatched=!1)}};R([de],mi,"isTouchDevice",1);var Yt=mi;var Fe=class{emitter;get event(){return this.emitter.event}constructor(e,t,n){let i=r=>this.emitter.fire(r);this.emitter=new E({onWillAddFirstListener:()=>e.addEventListener(t,i,n),onDidRemoveLastListener:()=>e.removeEventListener(t,i,n)})}dispose(){this.emitter.dispose()}};var uG=new E;var hG=new E;var Mb=class{constructor(e){this.el=e}disposables=new he;get onPointerMove(){return this.disposables.add(new Fe(Ie(this.el),"mousemove")).event}get onPointerUp(){return this.disposables.add(new Fe(Ie(this.el),"mouseup")).event}dispose(){this.disposables.dispose()}};R([de],Mb.prototype,"onPointerMove",1),R([de],Mb.prototype,"onPointerUp",1);var Ab=class{constructor(e){this.el=e}disposables=new he;get onPointerMove(){return this.disposables.add(new Fe(this.el,at.Change)).event}get onPointerUp(){return this.disposables.add(new Fe(this.el,at.End)).event}dispose(){this.disposables.dispose()}};R([de],Ab.prototype,"onPointerMove",1),R([de],Ab.prototype,"onPointerUp",1);var Ob=class{constructor(e){this.factory=e}get onPointerMove(){return this.factory.onPointerMove}get onPointerUp(){return this.factory.onPointerUp}dispose(){}};R([de],Ob.prototype,"onPointerMove",1),R([de],Ob.prototype,"onPointerUp",1);function ou(o){if(!o||typeof o!="object"||o instanceof RegExp)return o;let e=Array.isArray(o)?[]:{};return Object.entries(o).forEach(([t,n])=>{e[t]=n&&typeof n=="object"?ou(n):n}),e}var MV=Object.prototype.hasOwnProperty;function _R(o,e){return nE(o,e,new Set)}function nE(o,e,t){if(pi(o))return o;let n=e(o);if(typeof n<"u")return n;if(Array.isArray(o)){let i=[];for(let r of o)i.push(nE(r,e,t));return i}if(mn(o)){if(t.has(o))throw new Error("Cannot clone recursive data-structure");t.add(o);let i={};for(let r in o)MV.call(o,r)&&(i[r]=nE(o[r],e,t));return t.delete(o),i}return o}function Zn(o,e){if(o===e)return!0;if(o==null||e===null||e===void 0||typeof o!=typeof e||typeof o!="object"||Array.isArray(o)!==Array.isArray(e))return!1;let t,n;if(Array.isArray(o)){if(o.length!==e.length)return!1;for(t=0;t<o.length;t++)if(!Zn(o[t],e[t]))return!1}else{let i=[];for(n in o)i.push(n);i.sort();let r=[];for(n in e)r.push(n);if(r.sort(),!Zn(i,r))return!1;for(t=0;t<i.length;t++)if(!Zn(o[i[t]],e[i[t]]))return!1}return!0}function TR(o,e){let t=Object.create(null);return!o||!e||Object.keys(e).forEach(i=>{let r=o[i],s=e[i];Zn(r,s)||(t[i]=s)}),t}var Nb=class extends V{_onDidChange=this._register(new E);onDidChange=this._onDidChange.event;_referenceDomElement;_width;_height;_resizeObserver;constructor(e,t){super(),this._referenceDomElement=e,this._width=-1,this._height=-1,this._resizeObserver=null,this.measureReferenceDomElement(!1,t)}dispose(){this.stopObserving(),super.dispose()}getWidth(){return this._width}getHeight(){return this._height}startObserving(){if(!this._resizeObserver&&this._referenceDomElement){let e=null,t=()=>{e?this.observe({width:e.width,height:e.height}):this.observe()},n=!1,i=!1,r=()=>{if(n&&!i)try{n=!1,i=!0,t()}finally{Fn(Ie(this._referenceDomElement),()=>{i=!1,r()})}};this._resizeObserver=new ResizeObserver(s=>{s&&s[0]&&s[0].contentRect?e={width:s[0].contentRect.width,height:s[0].contentRect.height}:e=null,n=!0,r()}),this._resizeObserver.observe(this._referenceDomElement)}}stopObserving(){this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=null)}observe(e){this.measureReferenceDomElement(!0,e)}measureReferenceDomElement(e,t){let n=0,i=0;t?(n=t.width,i=t.height):this._referenceDomElement&&(n=this._referenceDomElement.clientWidth,i=this._referenceDomElement.clientHeight),n=Math.max(5,n),i=Math.max(5,i),(this._width!==n||this._height!==i)&&(this._width=n,this._height=i,e&&this._onDidChange.fire())}};var iE=class extends V{_onDidChange=this._register(new E);onDidChange=this._onDidChange.event;_listener;_mediaQueryList;constructor(e){super(),this._listener=()=>this._handleChange(e,!0),this._mediaQueryList=null,this._handleChange(e,!1)}_handleChange(e,t){this._mediaQueryList?.removeEventListener("change",this._listener),this._mediaQueryList=e.matchMedia(`(resolution: ${e.devicePixelRatio}dppx)`),this._mediaQueryList.addEventListener("change",this._listener),t&&this._onDidChange.fire()}},oE=class extends V{_onDidChange=this._register(new E);onDidChange=this._onDidChange.event;_value;get value(){return this._value}constructor(e){super(),this._value=this._getPixelRatio(e);let t=this._register(new iE(e));this._register(t.onDidChange(()=>{this._value=this._getPixelRatio(e),this._onDidChange.fire(this._value)}))}_getPixelRatio(e){let t=document.createElement("canvas").getContext("2d"),n=e.devicePixelRatio||1,i=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return n/i}},rE=class{mapWindowIdToPixelRatioMonitor=new Map;_getOrCreatePixelRatioMonitor(e){let t=il(e),n=this.mapWindowIdToPixelRatioMonitor.get(t);return n||(n=ja(new oE(e)),this.mapWindowIdToPixelRatioMonitor.set(t,n),ja(oe.once(sR)(({vscodeWindowId:i})=>{i===t&&(n?.dispose(),this.mapWindowIdToPixelRatioMonitor.delete(t))}))),n}getInstance(e){return this._getOrCreatePixelRatioMonitor(e)}},ru=new rE;var vd=class{constructor(e){this.domNode=e}_maxWidth="";_width="";_height="";_top="";_left="";_bottom="";_right="";_paddingTop="";_paddingLeft="";_paddingBottom="";_paddingRight="";_fontFamily="";_fontWeight="";_fontSize="";_fontStyle="";_fontFeatureSettings="";_fontVariationSettings="";_textDecoration="";_lineHeight="";_letterSpacing="";_className="";_display="";_position="";_visibility="";_color="";_backgroundColor="";_layerHint=!1;_contain="none";_boxShadow="";setMaxWidth(e){let t=Io(e);this._maxWidth!==t&&(this._maxWidth=t,this.domNode.style.maxWidth=this._maxWidth)}setWidth(e){let t=Io(e);this._width!==t&&(this._width=t,this.domNode.style.width=this._width)}setHeight(e){let t=Io(e);this._height!==t&&(this._height=t,this.domNode.style.height=this._height)}setTop(e){let t=Io(e);this._top!==t&&(this._top=t,this.domNode.style.top=this._top)}setLeft(e){let t=Io(e);this._left!==t&&(this._left=t,this.domNode.style.left=this._left)}setBottom(e){let t=Io(e);this._bottom!==t&&(this._bottom=t,this.domNode.style.bottom=this._bottom)}setRight(e){let t=Io(e);this._right!==t&&(this._right=t,this.domNode.style.right=this._right)}setPaddingTop(e){let t=Io(e);this._paddingTop!==t&&(this._paddingTop=t,this.domNode.style.paddingTop=this._paddingTop)}setPaddingLeft(e){let t=Io(e);this._paddingLeft!==t&&(this._paddingLeft=t,this.domNode.style.paddingLeft=this._paddingLeft)}setPaddingBottom(e){let t=Io(e);this._paddingBottom!==t&&(this._paddingBottom=t,this.domNode.style.paddingBottom=this._paddingBottom)}setPaddingRight(e){let t=Io(e);this._paddingRight!==t&&(this._paddingRight=t,this.domNode.style.paddingRight=this._paddingRight)}setFontFamily(e){this._fontFamily!==e&&(this._fontFamily=e,this.domNode.style.fontFamily=this._fontFamily)}setFontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.domNode.style.fontWeight=this._fontWeight)}setFontSize(e){let t=Io(e);this._fontSize!==t&&(this._fontSize=t,this.domNode.style.fontSize=this._fontSize)}setFontStyle(e){this._fontStyle!==e&&(this._fontStyle=e,this.domNode.style.fontStyle=this._fontStyle)}setFontFeatureSettings(e){this._fontFeatureSettings!==e&&(this._fontFeatureSettings=e,this.domNode.style.fontFeatureSettings=this._fontFeatureSettings)}setFontVariationSettings(e){this._fontVariationSettings!==e&&(this._fontVariationSettings=e,this.domNode.style.fontVariationSettings=this._fontVariationSettings)}setTextDecoration(e){this._textDecoration!==e&&(this._textDecoration=e,this.domNode.style.textDecoration=this._textDecoration)}setLineHeight(e){let t=Io(e);this._lineHeight!==t&&(this._lineHeight=t,this.domNode.style.lineHeight=this._lineHeight)}setLetterSpacing(e){let t=Io(e);this._letterSpacing!==t&&(this._letterSpacing=t,this.domNode.style.letterSpacing=this._letterSpacing)}setClassName(e){this._className!==e&&(this._className=e,this.domNode.className=this._className)}toggleClassName(e,t){this.domNode.classList.toggle(e,t),this._className=this.domNode.className}setDisplay(e){this._display!==e&&(this._display=e,this.domNode.style.display=this._display)}setPosition(e){this._position!==e&&(this._position=e,this.domNode.style.position=this._position)}setVisibility(e){this._visibility!==e&&(this._visibility=e,this.domNode.style.visibility=this._visibility)}setColor(e){this._color!==e&&(this._color=e,this.domNode.style.color=this._color)}setBackgroundColor(e){this._backgroundColor!==e&&(this._backgroundColor=e,this.domNode.style.backgroundColor=this._backgroundColor)}setLayerHinting(e){this._layerHint!==e&&(this._layerHint=e,this.domNode.style.transform=this._layerHint?"translate3d(0px, 0px, 0px)":"")}setBoxShadow(e){this._boxShadow!==e&&(this._boxShadow=e,this.domNode.style.boxShadow=e)}setContain(e){this._contain!==e&&(this._contain=e,this.domNode.style.contain=this._contain)}setAttribute(e,t){this.domNode.setAttribute(e,t)}removeAttribute(e){this.domNode.removeAttribute(e)}appendChild(e){this.domNode.appendChild(e.domNode)}removeChild(e){this.domNode.removeChild(e.domNode)}};function Io(o){return typeof o=="number"?`${o}px`:o}function Oe(o){return new vd(o)}var TG=new Uint32Array(10);var LG=new Uint8Array([114,82,115,101,69,102,97,113,81,116,84,100,119,87,99,122,120,118,103]),DG=new Uint16Array([107,111,105,79,106,112,117,80,104,27496,28520,27752,121,110,27246,28782,27758,98,109,27757,108]),kG=new Uint16Array([114,82,29810,115,30579,26483,101,102,29286,24934,29030,29798,30822,30310,26470,97,113,29809,116,84,100,119,99,122,120,118,103]),RG=new Uint16Array([114,82,29810,115,30579,26483,101,69,102,29286,24934,29030,29798,30822,30310,26470,97,113,81,29809,116,84,100,119,87,99,122,120,118,103,107,111,105,79,106,112,117,80,104,27496,28520,27752,121,110,27246,28782,27758,98,109,27757,108]);function kR(...o){return function(e,t){for(let n=0,i=o.length;n<i;n++){let r=o[n](e,t);if(r)return r}return null}}var BG=RR.bind(void 0,!1),sm=RR.bind(void 0,!0);function RR(o,e,t){if(!t||t.length<e.length)return null;let n;return o?n=Xa(t,e):n=t.indexOf(e)===0,n?e.length>0?[{start:0,end:e.length}]:[]:null}function AV(o,e){let t=e.toLowerCase().indexOf(o.toLowerCase());return t===-1?null:[{start:t,end:t+o.length}]}function OV(o,e){return aE(o.toLowerCase(),e.toLowerCase(),0,0)}function aE(o,e,t,n){if(t===o.length)return[];if(n===e.length)return null;if(o[t]===e[n]){let i=null;return(i=aE(o,e,t+1,n+1))?AR({start:n,end:n+1},i):null}return aE(o,e,t,n+1)}function uE(o){return 97<=o&&o<=122}function Bb(o){return 65<=o&&o<=90}function hE(o){return 48<=o&&o<=57}function NV(o){return o===32||o===9||o===10||o===13}var PV=new Set;"()[]{}<>`'\"-/;:,.?!".split("").forEach(o=>PV.add(o.charCodeAt(0)));function MR(o){return uE(o)||Bb(o)||hE(o)}function AR(o,e){return e.length===0?e=[o]:o.end===e[0].start?e[0].start=o.start:e.unshift(o),e}function OR(o,e){for(let t=e;t<o.length;t++){let n=o.charCodeAt(t);if(Bb(n)||hE(n)||t>0&&!MR(o.charCodeAt(t-1)))return t}return o.length}function lE(o,e,t,n){if(t===o.length)return[];if(n===e.length)return null;if(o[t]!==e[n].toLowerCase())return null;{let i=null,r=n+1;for(i=lE(o,e,t+1,n+1);!i&&(r=OR(e,r))<e.length;)i=lE(o,e,t+1,r),r++;return i===null?null:AR({start:n,end:n+1},i)}}function FV(o){let e=0,t=0,n=0,i=0,r=0;for(let c=0;c<o.length;c++)r=o.charCodeAt(c),Bb(r)&&e++,uE(r)&&t++,MR(r)&&n++,hE(r)&&i++;let s=e/o.length,a=t/o.length,l=n/o.length,d=i/o.length;return{upperPercent:s,lowerPercent:a,alphaPercent:l,numericPercent:d}}function BV(o){let{upperPercent:e,lowerPercent:t}=o;return t===0&&e>.6}function VV(o){let{upperPercent:e,lowerPercent:t,alphaPercent:n,numericPercent:i}=o;return t>.2&&e<.8&&n>.6&&i<.2}function WV(o){let e=0,t=0,n=0,i=0;for(let r=0;r<o.length;r++)n=o.charCodeAt(r),Bb(n)&&e++,uE(n)&&t++,NV(n)&&i++;return(e===0||t===0)&&i===0?o.length<=30:e<=5}function NR(o,e){if(!e||(e=e.trim(),e.length===0)||!WV(o))return null;e.length>60&&(e=e.substring(0,60));let t=FV(e);if(!VV(t)){if(!BV(t))return null;e=e.toLowerCase()}let n=null,i=0;for(o=o.toLowerCase();i<e.length&&(n=lE(o,e,0,i))===null;)i=OR(e,i+1);return n}var VG=kR(sm,NR,AV),WG=kR(sm,NR,OV),HG=new fo(1e4);function PR(o,e){let t=WR(o,o.toLowerCase(),0,e,e.toLowerCase(),0,{firstMatchCanBeWeak:!0,boostFullMatch:!0});return t?HV(t):null}function HV(o){if(typeof o>"u")return[];let e=[],t=o[1];for(let n=o.length-1;n>1;n--){let i=o[n]+t,r=e[e.length-1];r&&r.end===i?r.end=i+1:e.push({start:i,end:i+1})}return e}var ll=128;function pE(){let o=[],e=[];for(let t=0;t<=ll;t++)e[t]=0;for(let t=0;t<=ll;t++)o.push(e.slice(0));return o}function FR(o){let e=[];for(let t=0;t<=o;t++)e[t]=0;return e}var BR=FR(2*ll),dE=FR(2*ll),ps=pE(),al=pE(),rm=pE(),UV=!1;function sE(o,e,t,n,i){function r(a,l,d=" "){for(;a.length<l;)a=d+a;return a}let s=` |   |${n.split("").map(a=>r(a,3)).join("|")}
`;for(let a=0;a<=t;a++)a===0?s+=" |":s+=`${e[a-1]}|`,s+=o[a].slice(0,i+1).map(l=>r(l.toString(),3)).join("|")+`
`;return s}function zV(o,e,t,n){o=o.substr(e),t=t.substr(n),console.log(sE(al,o,o.length,t,t.length)),console.log(sE(rm,o,o.length,t,t.length)),console.log(sE(ps,o,o.length,t,t.length))}function Pb(o,e){if(e<0||e>=o.length)return!1;let t=o.codePointAt(e);switch(t){case 95:case 45:case 46:case 32:case 47:case 92:case 39:case 34:case 58:case 36:case 60:case 62:case 40:case 41:case 91:case 93:case 123:case 125:return!0;case void 0:return!1;default:return!!zp(t)}}function DR(o,e){if(e<0||e>=o.length)return!1;switch(o.charCodeAt(e)){case 32:case 9:return!0;default:return!1}}function Fb(o,e,t){return e[o]!==t[o]}function KV(o,e,t,n,i,r,s=!1){for(;e<t&&i<r;)o[e]===n[i]&&(s&&(BR[e]=i),e+=1),i+=1;return e===t}var VR;(t=>{t.Default=[-100,0];function e(n){return!n||n.length===2&&n[0]===-100&&n[1]===0}t.isDefault=e})(VR||={});var cE=class{constructor(e,t){this.firstMatchCanBeWeak=e;this.boostFullMatch=t}static default={boostFullMatch:!0,firstMatchCanBeWeak:!1}};function WR(o,e,t,n,i,r,s=cE.default){let a=o.length>ll?ll:o.length,l=n.length>ll?ll:n.length;if(t>=a||r>=l||a-t>l-r||!KV(e,t,a,i,r,l,!0))return;GV(a,l,t,r,e,i);let d=1,c=1,u=t,h=r,m=[!1];for(d=1,u=t;u<a;d++,u++){let C=BR[u],x=dE[u],L=u+1<a?dE[u+1]:l;for(c=C-r+1,h=C;h<L;c++,h++){let k=Number.MIN_SAFE_INTEGER,O=!1;h<=x&&(k=jV(o,e,u,t,n,i,h,l,r,ps[d-1][c-1]===0,m));let W=0;k!==Number.MAX_SAFE_INTEGER&&(O=!0,W=k+al[d-1][c-1]);let z=h>C,B=z?al[d][c-1]+(ps[d][c-1]>0?-5:0):0,G=h>C+1&&ps[d][c-1]>0,q=G?al[d][c-2]+(ps[d][c-2]>0?-5:0):0;if(G&&(!z||q>=B)&&(!O||q>=W))al[d][c]=q,rm[d][c]=3,ps[d][c]=0;else if(z&&(!O||B>=W))al[d][c]=B,rm[d][c]=2,ps[d][c]=0;else if(O)al[d][c]=W,rm[d][c]=1,ps[d][c]=ps[d-1][c-1]+1;else throw new Error("not possible")}}if(UV&&zV(o,t,n,r),!m[0]&&!s.firstMatchCanBeWeak)return;d--,c--;let f=[al[d][c],r],g=0,b=0;for(;d>=1;){let C=c;do{let x=rm[d][C];if(x===3)C=C-2;else if(x===2)C=C-1;else break}while(C>=1);g>1&&e[t+d-1]===i[r+c-1]&&!Fb(C+r-1,n,i)&&g+1>ps[d][C]&&(C=c),C===c?g++:g=1,b||(b=C),d--,c=C-1,f.push(c)}l-r===a&&s.boostFullMatch&&(f[0]+=2);let y=b-a;return f[0]-=y,f}function GV(o,e,t,n,i,r){let s=o-1,a=e-1;for(;s>=t&&a>=n;)i[s]===r[a]&&(dE[s]=a,s--),a--}function jV(o,e,t,n,i,r,s,a,l,d,c){if(e[t]!==r[s])return Number.MIN_SAFE_INTEGER;let u=1,h=!1;return s===t-n?u=o[t]===i[s]?7:5:Fb(s,i,r)&&(s===0||!Fb(s-1,i,r))?(u=o[t]===i[s]?7:5,h=!0):Pb(r,s)&&(s===0||!Pb(r,s-1))?u=5:(Pb(r,s-1)||DR(r,s-1))&&(u=5,h=!0),u>1&&t===n&&(c[0]=!0),h||(h=Fb(s,i,r)||Pb(r,s-1)||DR(r,s-1)),t===n?s>l&&(u-=h?3:5):d?u+=h?2:0:u+=h?0:1,s+1===a&&(u-=h?3:5),u}var mE=Object.create(null);function v(o,e){if(an(e)){let t=mE[e];if(t===void 0)throw new Error(`${o} references an unknown codicon: ${e}`);e=t}return mE[o]=e,{id:o}}function gE(){return mE}var HR={add:v("add",6e4),plus:v("plus",6e4),gistNew:v("gist-new",6e4),repoCreate:v("repo-create",6e4),lightbulb:v("lightbulb",60001),lightBulb:v("light-bulb",60001),repo:v("repo",60002),repoDelete:v("repo-delete",60002),gistFork:v("gist-fork",60003),repoForked:v("repo-forked",60003),gitPullRequest:v("git-pull-request",60004),gitPullRequestAbandoned:v("git-pull-request-abandoned",60004),recordKeys:v("record-keys",60005),keyboard:v("keyboard",60005),tag:v("tag",60006),gitPullRequestLabel:v("git-pull-request-label",60006),tagAdd:v("tag-add",60006),tagRemove:v("tag-remove",60006),person:v("person",60007),personFollow:v("person-follow",60007),personOutline:v("person-outline",60007),personFilled:v("person-filled",60007),gitBranch:v("git-branch",60008),gitBranchCreate:v("git-branch-create",60008),gitBranchDelete:v("git-branch-delete",60008),sourceControl:v("source-control",60008),mirror:v("mirror",60009),mirrorPublic:v("mirror-public",60009),star:v("star",60010),starAdd:v("star-add",60010),starDelete:v("star-delete",60010),starEmpty:v("star-empty",60010),comment:v("comment",60011),commentAdd:v("comment-add",60011),alert:v("alert",60012),warning:v("warning",60012),search:v("search",60013),searchSave:v("search-save",60013),logOut:v("log-out",60014),signOut:v("sign-out",60014),logIn:v("log-in",60015),signIn:v("sign-in",60015),eye:v("eye",60016),eyeUnwatch:v("eye-unwatch",60016),eyeWatch:v("eye-watch",60016),circleFilled:v("circle-filled",60017),primitiveDot:v("primitive-dot",60017),closeDirty:v("close-dirty",60017),debugBreakpoint:v("debug-breakpoint",60017),debugBreakpointDisabled:v("debug-breakpoint-disabled",60017),debugHint:v("debug-hint",60017),terminalDecorationSuccess:v("terminal-decoration-success",60017),primitiveSquare:v("primitive-square",60018),edit:v("edit",60019),pencil:v("pencil",60019),info:v("info",60020),issueOpened:v("issue-opened",60020),gistPrivate:v("gist-private",60021),gitForkPrivate:v("git-fork-private",60021),lock:v("lock",60021),mirrorPrivate:v("mirror-private",60021),close:v("close",60022),removeClose:v("remove-close",60022),x:v("x",60022),repoSync:v("repo-sync",60023),sync:v("sync",60023),clone:v("clone",60024),desktopDownload:v("desktop-download",60024),beaker:v("beaker",60025),microscope:v("microscope",60025),vm:v("vm",60026),deviceDesktop:v("device-desktop",60026),file:v("file",60027),fileText:v("file-text",60027),more:v("more",60028),ellipsis:v("ellipsis",60028),kebabHorizontal:v("kebab-horizontal",60028),mailReply:v("mail-reply",60029),reply:v("reply",60029),organization:v("organization",60030),organizationFilled:v("organization-filled",60030),organizationOutline:v("organization-outline",60030),newFile:v("new-file",60031),fileAdd:v("file-add",60031),newFolder:v("new-folder",60032),fileDirectoryCreate:v("file-directory-create",60032),trash:v("trash",60033),trashcan:v("trashcan",60033),history:v("history",60034),clock:v("clock",60034),folder:v("folder",60035),fileDirectory:v("file-directory",60035),symbolFolder:v("symbol-folder",60035),logoGithub:v("logo-github",60036),markGithub:v("mark-github",60036),github:v("github",60036),terminal:v("terminal",60037),console:v("console",60037),repl:v("repl",60037),zap:v("zap",60038),symbolEvent:v("symbol-event",60038),error:v("error",60039),stop:v("stop",60039),variable:v("variable",60040),symbolVariable:v("symbol-variable",60040),array:v("array",60042),symbolArray:v("symbol-array",60042),symbolModule:v("symbol-module",60043),symbolPackage:v("symbol-package",60043),symbolNamespace:v("symbol-namespace",60043),symbolObject:v("symbol-object",60043),symbolMethod:v("symbol-method",60044),symbolFunction:v("symbol-function",60044),symbolConstructor:v("symbol-constructor",60044),symbolBoolean:v("symbol-boolean",60047),symbolNull:v("symbol-null",60047),symbolNumeric:v("symbol-numeric",60048),symbolNumber:v("symbol-number",60048),symbolStructure:v("symbol-structure",60049),symbolStruct:v("symbol-struct",60049),symbolParameter:v("symbol-parameter",60050),symbolTypeParameter:v("symbol-type-parameter",60050),symbolKey:v("symbol-key",60051),symbolText:v("symbol-text",60051),symbolReference:v("symbol-reference",60052),goToFile:v("go-to-file",60052),symbolEnum:v("symbol-enum",60053),symbolValue:v("symbol-value",60053),symbolRuler:v("symbol-ruler",60054),symbolUnit:v("symbol-unit",60054),activateBreakpoints:v("activate-breakpoints",60055),archive:v("archive",60056),arrowBoth:v("arrow-both",60057),arrowDown:v("arrow-down",60058),arrowLeft:v("arrow-left",60059),arrowRight:v("arrow-right",60060),arrowSmallDown:v("arrow-small-down",60061),arrowSmallLeft:v("arrow-small-left",60062),arrowSmallRight:v("arrow-small-right",60063),arrowSmallUp:v("arrow-small-up",60064),arrowUp:v("arrow-up",60065),bell:v("bell",60066),bold:v("bold",60067),book:v("book",60068),bookmark:v("bookmark",60069),debugBreakpointConditionalUnverified:v("debug-breakpoint-conditional-unverified",60070),debugBreakpointConditional:v("debug-breakpoint-conditional",60071),debugBreakpointConditionalDisabled:v("debug-breakpoint-conditional-disabled",60071),debugBreakpointDataUnverified:v("debug-breakpoint-data-unverified",60072),debugBreakpointData:v("debug-breakpoint-data",60073),debugBreakpointDataDisabled:v("debug-breakpoint-data-disabled",60073),debugBreakpointLogUnverified:v("debug-breakpoint-log-unverified",60074),debugBreakpointLog:v("debug-breakpoint-log",60075),debugBreakpointLogDisabled:v("debug-breakpoint-log-disabled",60075),briefcase:v("briefcase",60076),broadcast:v("broadcast",60077),browser:v("browser",60078),bug:v("bug",60079),calendar:v("calendar",60080),caseSensitive:v("case-sensitive",60081),check:v("check",60082),checklist:v("checklist",60083),chevronDown:v("chevron-down",60084),chevronLeft:v("chevron-left",60085),chevronRight:v("chevron-right",60086),chevronUp:v("chevron-up",60087),chromeClose:v("chrome-close",60088),chromeMaximize:v("chrome-maximize",60089),chromeMinimize:v("chrome-minimize",60090),chromeRestore:v("chrome-restore",60091),circleOutline:v("circle-outline",60092),circle:v("circle",60092),debugBreakpointUnverified:v("debug-breakpoint-unverified",60092),terminalDecorationIncomplete:v("terminal-decoration-incomplete",60092),circleSlash:v("circle-slash",60093),circuitBoard:v("circuit-board",60094),clearAll:v("clear-all",60095),clippy:v("clippy",60096),closeAll:v("close-all",60097),cloudDownload:v("cloud-download",60098),cloudUpload:v("cloud-upload",60099),code:v("code",60100),collapseAll:v("collapse-all",60101),colorMode:v("color-mode",60102),commentDiscussion:v("comment-discussion",60103),creditCard:v("credit-card",60105),dash:v("dash",60108),dashboard:v("dashboard",60109),database:v("database",60110),debugContinue:v("debug-continue",60111),debugDisconnect:v("debug-disconnect",60112),debugPause:v("debug-pause",60113),debugRestart:v("debug-restart",60114),debugStart:v("debug-start",60115),debugStepInto:v("debug-step-into",60116),debugStepOut:v("debug-step-out",60117),debugStepOver:v("debug-step-over",60118),debugStop:v("debug-stop",60119),debug:v("debug",60120),deviceCameraVideo:v("device-camera-video",60121),deviceCamera:v("device-camera",60122),deviceMobile:v("device-mobile",60123),diffAdded:v("diff-added",60124),diffIgnored:v("diff-ignored",60125),diffModified:v("diff-modified",60126),diffRemoved:v("diff-removed",60127),diffRenamed:v("diff-renamed",60128),diff:v("diff",60129),diffSidebyside:v("diff-sidebyside",60129),discard:v("discard",60130),editorLayout:v("editor-layout",60131),emptyWindow:v("empty-window",60132),exclude:v("exclude",60133),extensions:v("extensions",60134),eyeClosed:v("eye-closed",60135),fileBinary:v("file-binary",60136),fileCode:v("file-code",60137),fileMedia:v("file-media",60138),filePdf:v("file-pdf",60139),fileSubmodule:v("file-submodule",60140),fileSymlinkDirectory:v("file-symlink-directory",60141),fileSymlinkFile:v("file-symlink-file",60142),fileZip:v("file-zip",60143),files:v("files",60144),filter:v("filter",60145),flame:v("flame",60146),foldDown:v("fold-down",60147),foldUp:v("fold-up",60148),fold:v("fold",60149),folderActive:v("folder-active",60150),folderOpened:v("folder-opened",60151),gear:v("gear",60152),gift:v("gift",60153),gistSecret:v("gist-secret",60154),gist:v("gist",60155),gitCommit:v("git-commit",60156),gitCompare:v("git-compare",60157),compareChanges:v("compare-changes",60157),gitMerge:v("git-merge",60158),githubAction:v("github-action",60159),githubAlt:v("github-alt",60160),globe:v("globe",60161),grabber:v("grabber",60162),graph:v("graph",60163),gripper:v("gripper",60164),heart:v("heart",60165),home:v("home",60166),horizontalRule:v("horizontal-rule",60167),hubot:v("hubot",60168),inbox:v("inbox",60169),issueReopened:v("issue-reopened",60171),issues:v("issues",60172),italic:v("italic",60173),jersey:v("jersey",60174),json:v("json",60175),kebabVertical:v("kebab-vertical",60176),key:v("key",60177),law:v("law",60178),lightbulbAutofix:v("lightbulb-autofix",60179),linkExternal:v("link-external",60180),link:v("link",60181),listOrdered:v("list-ordered",60182),listUnordered:v("list-unordered",60183),liveShare:v("live-share",60184),loading:v("loading",60185),location:v("location",60186),mailRead:v("mail-read",60187),mail:v("mail",60188),markdown:v("markdown",60189),megaphone:v("megaphone",60190),mention:v("mention",60191),milestone:v("milestone",60192),gitPullRequestMilestone:v("git-pull-request-milestone",60192),mortarBoard:v("mortar-board",60193),move:v("move",60194),multipleWindows:v("multiple-windows",60195),mute:v("mute",60196),noNewline:v("no-newline",60197),note:v("note",60198),octoface:v("octoface",60199),openPreview:v("open-preview",60200),package:v("package",60201),paintcan:v("paintcan",60202),pin:v("pin",60203),play:v("play",60204),run:v("run",60204),plug:v("plug",60205),preserveCase:v("preserve-case",60206),preview:v("preview",60207),project:v("project",60208),pulse:v("pulse",60209),question:v("question",60210),quote:v("quote",60211),radioTower:v("radio-tower",60212),reactions:v("reactions",60213),references:v("references",60214),refresh:v("refresh",60215),regex:v("regex",60216),remoteExplorer:v("remote-explorer",60217),remote:v("remote",60218),remove:v("remove",60219),replaceAll:v("replace-all",60220),replace:v("replace",60221),repoClone:v("repo-clone",60222),repoForcePush:v("repo-force-push",60223),repoPull:v("repo-pull",60224),repoPush:v("repo-push",60225),report:v("report",60226),requestChanges:v("request-changes",60227),rocket:v("rocket",60228),rootFolderOpened:v("root-folder-opened",60229),rootFolder:v("root-folder",60230),rss:v("rss",60231),ruby:v("ruby",60232),saveAll:v("save-all",60233),saveAs:v("save-as",60234),save:v("save",60235),screenFull:v("screen-full",60236),screenNormal:v("screen-normal",60237),searchStop:v("search-stop",60238),server:v("server",60240),settingsGear:v("settings-gear",60241),settings:v("settings",60242),shield:v("shield",60243),smiley:v("smiley",60244),sortPrecedence:v("sort-precedence",60245),splitHorizontal:v("split-horizontal",60246),splitVertical:v("split-vertical",60247),squirrel:v("squirrel",60248),starFull:v("star-full",60249),starHalf:v("star-half",60250),symbolClass:v("symbol-class",60251),symbolColor:v("symbol-color",60252),symbolConstant:v("symbol-constant",60253),symbolEnumMember:v("symbol-enum-member",60254),symbolField:v("symbol-field",60255),symbolFile:v("symbol-file",60256),symbolInterface:v("symbol-interface",60257),symbolKeyword:v("symbol-keyword",60258),symbolMisc:v("symbol-misc",60259),symbolOperator:v("symbol-operator",60260),symbolProperty:v("symbol-property",60261),wrench:v("wrench",60261),wrenchSubaction:v("wrench-subaction",60261),symbolSnippet:v("symbol-snippet",60262),tasklist:v("tasklist",60263),telescope:v("telescope",60264),textSize:v("text-size",60265),threeBars:v("three-bars",60266),thumbsdown:v("thumbsdown",60267),thumbsup:v("thumbsup",60268),tools:v("tools",60269),triangleDown:v("triangle-down",60270),triangleLeft:v("triangle-left",60271),triangleRight:v("triangle-right",60272),triangleUp:v("triangle-up",60273),twitter:v("twitter",60274),unfold:v("unfold",60275),unlock:v("unlock",60276),unmute:v("unmute",60277),unverified:v("unverified",60278),verified:v("verified",60279),versions:v("versions",60280),vmActive:v("vm-active",60281),vmOutline:v("vm-outline",60282),vmRunning:v("vm-running",60283),watch:v("watch",60284),whitespace:v("whitespace",60285),wholeWord:v("whole-word",60286),window:v("window",60287),wordWrap:v("word-wrap",60288),zoomIn:v("zoom-in",60289),zoomOut:v("zoom-out",60290),listFilter:v("list-filter",60291),listFlat:v("list-flat",60292),listSelection:v("list-selection",60293),selection:v("selection",60293),listTree:v("list-tree",60294),debugBreakpointFunctionUnverified:v("debug-breakpoint-function-unverified",60295),debugBreakpointFunction:v("debug-breakpoint-function",60296),debugBreakpointFunctionDisabled:v("debug-breakpoint-function-disabled",60296),debugStackframeActive:v("debug-stackframe-active",60297),circleSmallFilled:v("circle-small-filled",60298),debugStackframeDot:v("debug-stackframe-dot",60298),terminalDecorationMark:v("terminal-decoration-mark",60298),debugStackframe:v("debug-stackframe",60299),debugStackframeFocused:v("debug-stackframe-focused",60299),debugBreakpointUnsupported:v("debug-breakpoint-unsupported",60300),symbolString:v("symbol-string",60301),debugReverseContinue:v("debug-reverse-continue",60302),debugStepBack:v("debug-step-back",60303),debugRestartFrame:v("debug-restart-frame",60304),debugAlt:v("debug-alt",60305),callIncoming:v("call-incoming",60306),callOutgoing:v("call-outgoing",60307),menu:v("menu",60308),expandAll:v("expand-all",60309),feedback:v("feedback",60310),gitPullRequestReviewer:v("git-pull-request-reviewer",60310),groupByRefType:v("group-by-ref-type",60311),ungroupByRefType:v("ungroup-by-ref-type",60312),account:v("account",60313),gitPullRequestAssignee:v("git-pull-request-assignee",60313),bellDot:v("bell-dot",60314),debugConsole:v("debug-console",60315),library:v("library",60316),output:v("output",60317),runAll:v("run-all",60318),syncIgnored:v("sync-ignored",60319),pinned:v("pinned",60320),githubInverted:v("github-inverted",60321),serverProcess:v("server-process",60322),serverEnvironment:v("server-environment",60323),pass:v("pass",60324),issueClosed:v("issue-closed",60324),stopCircle:v("stop-circle",60325),playCircle:v("play-circle",60326),record:v("record",60327),debugAltSmall:v("debug-alt-small",60328),vmConnect:v("vm-connect",60329),cloud:v("cloud",60330),merge:v("merge",60331),export:v("export",60332),graphLeft:v("graph-left",60333),magnet:v("magnet",60334),notebook:v("notebook",60335),redo:v("redo",60336),checkAll:v("check-all",60337),pinnedDirty:v("pinned-dirty",60338),passFilled:v("pass-filled",60339),circleLargeFilled:v("circle-large-filled",60340),circleLarge:v("circle-large",60341),circleLargeOutline:v("circle-large-outline",60341),combine:v("combine",60342),gather:v("gather",60342),table:v("table",60343),variableGroup:v("variable-group",60344),typeHierarchy:v("type-hierarchy",60345),typeHierarchySub:v("type-hierarchy-sub",60346),typeHierarchySuper:v("type-hierarchy-super",60347),gitPullRequestCreate:v("git-pull-request-create",60348),runAbove:v("run-above",60349),runBelow:v("run-below",60350),notebookTemplate:v("notebook-template",60351),debugRerun:v("debug-rerun",60352),workspaceTrusted:v("workspace-trusted",60353),workspaceUntrusted:v("workspace-untrusted",60354),workspaceUnknown:v("workspace-unknown",60355),terminalCmd:v("terminal-cmd",60356),terminalDebian:v("terminal-debian",60357),terminalLinux:v("terminal-linux",60358),terminalPowershell:v("terminal-powershell",60359),terminalTmux:v("terminal-tmux",60360),terminalUbuntu:v("terminal-ubuntu",60361),terminalBash:v("terminal-bash",60362),arrowSwap:v("arrow-swap",60363),copy:v("copy",60364),personAdd:v("person-add",60365),filterFilled:v("filter-filled",60366),wand:v("wand",60367),debugLineByLine:v("debug-line-by-line",60368),inspect:v("inspect",60369),layers:v("layers",60370),layersDot:v("layers-dot",60371),layersActive:v("layers-active",60372),compass:v("compass",60373),compassDot:v("compass-dot",60374),compassActive:v("compass-active",60375),azure:v("azure",60376),issueDraft:v("issue-draft",60377),gitPullRequestClosed:v("git-pull-request-closed",60378),gitPullRequestDraft:v("git-pull-request-draft",60379),debugAll:v("debug-all",60380),debugCoverage:v("debug-coverage",60381),runErrors:v("run-errors",60382),folderLibrary:v("folder-library",60383),debugContinueSmall:v("debug-continue-small",60384),beakerStop:v("beaker-stop",60385),graphLine:v("graph-line",60386),graphScatter:v("graph-scatter",60387),pieChart:v("pie-chart",60388),bracket:v("bracket",60175),bracketDot:v("bracket-dot",60389),bracketError:v("bracket-error",60390),lockSmall:v("lock-small",60391),azureDevops:v("azure-devops",60392),verifiedFilled:v("verified-filled",60393),newline:v("newline",60394),layout:v("layout",60395),layoutActivitybarLeft:v("layout-activitybar-left",60396),layoutActivitybarRight:v("layout-activitybar-right",60397),layoutPanelLeft:v("layout-panel-left",60398),layoutPanelCenter:v("layout-panel-center",60399),layoutPanelJustify:v("layout-panel-justify",60400),layoutPanelRight:v("layout-panel-right",60401),layoutPanel:v("layout-panel",60402),layoutSidebarLeft:v("layout-sidebar-left",60403),layoutSidebarRight:v("layout-sidebar-right",60404),layoutStatusbar:v("layout-statusbar",60405),layoutMenubar:v("layout-menubar",60406),layoutCentered:v("layout-centered",60407),target:v("target",60408),indent:v("indent",60409),recordSmall:v("record-small",60410),errorSmall:v("error-small",60411),terminalDecorationError:v("terminal-decoration-error",60411),arrowCircleDown:v("arrow-circle-down",60412),arrowCircleLeft:v("arrow-circle-left",60413),arrowCircleRight:v("arrow-circle-right",60414),arrowCircleUp:v("arrow-circle-up",60415),layoutSidebarRightOff:v("layout-sidebar-right-off",60416),layoutPanelOff:v("layout-panel-off",60417),layoutSidebarLeftOff:v("layout-sidebar-left-off",60418),blank:v("blank",60419),heartFilled:v("heart-filled",60420),map:v("map",60421),mapHorizontal:v("map-horizontal",60421),foldHorizontal:v("fold-horizontal",60421),mapFilled:v("map-filled",60422),mapHorizontalFilled:v("map-horizontal-filled",60422),foldHorizontalFilled:v("fold-horizontal-filled",60422),circleSmall:v("circle-small",60423),bellSlash:v("bell-slash",60424),bellSlashDot:v("bell-slash-dot",60425),commentUnresolved:v("comment-unresolved",60426),gitPullRequestGoToChanges:v("git-pull-request-go-to-changes",60427),gitPullRequestNewChanges:v("git-pull-request-new-changes",60428),searchFuzzy:v("search-fuzzy",60429),commentDraft:v("comment-draft",60430),send:v("send",60431),sparkle:v("sparkle",60432),insert:v("insert",60433),mic:v("mic",60434),thumbsdownFilled:v("thumbsdown-filled",60435),thumbsupFilled:v("thumbsup-filled",60436),coffee:v("coffee",60437),snake:v("snake",60438),game:v("game",60439),vr:v("vr",60440),chip:v("chip",60441),piano:v("piano",60442),music:v("music",60443),micFilled:v("mic-filled",60444),repoFetch:v("repo-fetch",60445),copilot:v("copilot",60446),lightbulbSparkle:v("lightbulb-sparkle",60447),robot:v("robot",60448),sparkleFilled:v("sparkle-filled",60449),diffSingle:v("diff-single",60450),diffMultiple:v("diff-multiple",60451),surroundWith:v("surround-with",60452),share:v("share",60453),gitStash:v("git-stash",60454),gitStashApply:v("git-stash-apply",60455),gitStashPop:v("git-stash-pop",60456),vscode:v("vscode",60457),vscodeInsiders:v("vscode-insiders",60458),codeOss:v("code-oss",60459),runCoverage:v("run-coverage",60460),runAllCoverage:v("run-all-coverage",60461),coverage:v("coverage",60462),githubProject:v("github-project",60463),mapVertical:v("map-vertical",60464),foldVertical:v("fold-vertical",60464),mapVerticalFilled:v("map-vertical-filled",60465),foldVerticalFilled:v("fold-vertical-filled",60465),goToSearch:v("go-to-search",60466),percentage:v("percentage",60467),sortPercentage:v("sort-percentage",60467),attach:v("attach",60468)};var $V={dialogError:v("dialog-error","error"),dialogWarning:v("dialog-warning","warning"),dialogInfo:v("dialog-info","info"),dialogClose:v("dialog-close","close"),treeItemExpanded:v("tree-item-expanded","chevron-down"),treeFilterOnTypeOn:v("tree-filter-on-type-on","list-filter"),treeFilterOnTypeOff:v("tree-filter-on-type-off","list-selection"),treeFilterClear:v("tree-filter-clear","close"),treeItemLoading:v("tree-item-loading","loading"),menuSelection:v("menu-selection","check"),menuSubmenu:v("menu-submenu","chevron-right"),menuBarMore:v("menubar-more","more"),scrollbarButtonLeft:v("scrollbar-button-left","triangle-left"),scrollbarButtonRight:v("scrollbar-button-right","triangle-right"),scrollbarButtonUp:v("scrollbar-button-up","triangle-up"),scrollbarButtonDown:v("scrollbar-button-down","triangle-down"),toolBarMore:v("toolbar-more","more"),quickInputBack:v("quick-input-back","arrow-left"),dropDownButton:v("drop-down-button",60084),symbolCustomColor:v("symbol-customcolor",60252),exportIcon:v("export",60332),workspaceUnspecified:v("workspace-unspecified",60355),newLine:v("newline",60394),thumbsDownFilled:v("thumbsdown-filled",60435),thumbsUpFilled:v("thumbsup-filled",60436),gitFetch:v("git-fetch",60445),lightbulbSparkleAutofix:v("lightbulb-sparkle-autofix",60447),debugBreakpointPending:v("debug-breakpoint-pending",60377)},ge={...HR,...$V};var UR;(e=>{function o(t){return t&&typeof t=="object"&&typeof t.id=="string"}e.isThemeColor=o})(UR||={});var Je;(g=>{g.iconNameSegment="[A-Za-z0-9]+",g.iconNameExpression="[A-Za-z0-9-]+",g.iconModifierExpression="~[A-Za-z]+",g.iconNameCharacter="[A-Za-z0-9~-]";let i=new RegExp(`^(${g.iconNameExpression})(${g.iconModifierExpression})?$`);function r(b){let y=i.exec(b.id);if(!y)return r(ge.error);let[,C,x]=y,L=["codicon","codicon-"+C];return x&&L.push("codicon-modifier-"+x.substring(1)),L}g.asClassNameArray=r;function s(b){return r(b).join(" ")}g.asClassName=s;function a(b){return"."+r(b).join(".")}g.asCSSSelector=a;function l(b){return b&&typeof b=="object"&&typeof b.id=="string"&&(typeof b.color>"u"||UR.isThemeColor(b.color))}g.isThemeIcon=l;let d=new RegExp(`^\\$\\((${g.iconNameExpression}(?:${g.iconModifierExpression})?)\\)$`);function c(b){let y=d.exec(b);if(!y)return;let[,C]=y;return{id:C}}g.fromString=c;function u(b){return{id:b}}g.fromId=u;function h(b,y){let C=b.id,x=C.lastIndexOf("~");return x!==-1&&(C=C.substring(0,x)),y&&(C=`${C}~${y}`),{id:C}}g.modify=h;function m(b){let y=b.id.lastIndexOf("~");if(y!==-1)return b.id.substring(y+1)}g.getModifier=m;function f(b,y){return b.id===y.id&&b.color?.id===y.color?.id}g.isEqual=f})(Je||={});var fE=new RegExp(`\\$\\(${Je.iconNameExpression}(?:${Je.iconModifierExpression})?\\)`,"g"),qV=new RegExp(`(\\\\)?${fE.source}`,"g");function zR(o){return o.replace(qV,(e,t)=>t?e:`\\${e}`)}var YV=new RegExp(`\\\\${fE.source}`,"g");function KR(o){return o.replace(YV,e=>`\\${e}`)}var aj=new RegExp(`(\\s)?(\\\\)?${fE.source}(\\s)?`,"g");var lj=new RegExp(`\\$\\(${Je.iconNameCharacter}+\\)`,"g");var bE=class{value;isTrusted;supportThemeIcons;supportHtml;baseUri;constructor(e="",t=!1){if(this.value=e,typeof this.value!="string")throw Ql("value");typeof t=="boolean"?(this.isTrusted=t,this.supportThemeIcons=!1,this.supportHtml=!1):(this.isTrusted=t.isTrusted??void 0,this.supportThemeIcons=t.supportThemeIcons??!1,this.supportHtml=t.supportHtml??!1)}appendText(e,t=0){return this.value+=ZV(this.supportThemeIcons?zR(e):e).replace(/([ \t]+)/g,(n,i)=>"&nbsp;".repeat(i.length)).replace(/\>/gm,"\\>").replace(/\n/g,t===1?`\\
`:`

`),this}appendMarkdown(e){return this.value+=e,this}appendCodeblock(e,t){return this.value+=`
${XV(t,e)}
`,this}appendLink(e,t,n){return this.value+="[",this.value+=this._escape(t,"]"),this.value+="](",this.value+=this._escape(String(e),")"),n&&(this.value+=` "${this._escape(this._escape(n,'"'),")")}"`),this.value+=")",this}_escape(e,t){let n=new RegExp(Qi(t),"g");return e.replace(n,(i,r)=>e.charAt(r-1)!=="\\"?`\\${i}`:i)}};function Vb(o){return o instanceof bE?!0:o&&typeof o=="object"?typeof o.value=="string"&&(typeof o.isTrusted=="boolean"||typeof o.isTrusted=="object"||o.isTrusted===void 0)&&(typeof o.supportThemeIcons=="boolean"||o.supportThemeIcons===void 0):!1}function GR(o,e){return o===e?!0:!o||!e?!1:o.value===e.value&&o.isTrusted===e.isTrusted&&o.supportThemeIcons===e.supportThemeIcons&&o.supportHtml===e.supportHtml&&(o.baseUri===e.baseUri||!!o.baseUri&&!!e.baseUri&&Yn(ie.from(o.baseUri),ie.from(e.baseUri)))}function ZV(o){return o.replace(/[\\`*_{}[\]()#+\-!~]/g,"\\$&")}function XV(o,e){let t=o.match(/^`+/gm)?.reduce((i,r)=>i.length>r.length?i:r).length??0,n=t>=3?t+1:3;return[`${"`".repeat(n)}${e}`,o,`${"`".repeat(n)}`].join(`
`)}function am(o){return o.replace(/"/g,"&quot;")}function Wb(o){return o&&o.replace(/\\([\\`*_{}[\]()#+\-.!~])/g,"$1")}function jR(o){let e=[],t=o.split("|").map(i=>i.trim());o=t[0];let n=t[1];if(n){let i=/height=(\d+)/.exec(n),r=/width=(\d+)/.exec(n),s=i?i[1]:"",a=r?r[1]:"",l=isFinite(parseInt(a)),d=isFinite(parseInt(s));l&&e.push(`width="${a}"`),d&&e.push(`height="${s}"`)}return{href:o,dimensions:e}}function $R(o){let e=!1,t=new Map,n=new Map;if(QV(o,c=>{if(o===c)return!0;let u=JSON.stringify(c);if(u.length<30)return!0;let h=t.get(u);if(!h){let m={schemas:[c]};return t.set(u,m),n.set(c,m),!0}return h.schemas.push(c),n.set(c,h),e=!0,!1}),t.clear(),!e)return JSON.stringify(o);let r="$defs";for(;o.hasOwnProperty(r);)r+="_";let s=[];function a(c){return JSON.stringify(c,(u,h)=>{if(h!==c){let m=n.get(h);if(m&&m.schemas.length>1)return m.id||(m.id=`_${s.length}`,s.push(m.schemas[0])),{$ref:`#/${r}/${m.id}`}}return h})}let l=a(o),d=[];for(let c=0;c<s.length;c++)d.push(`"_${c}":${a(s[c])}`);return d.length?`${l.substring(0,l.length-1)},"${r}":{${d.join(",")}}}`:l}function su(o){return typeof o=="object"&&o!==null}function QV(o,e){if(!o||typeof o!="object")return;let t=(...l)=>{for(let d of l)su(d)&&s.push(d)},n=(...l)=>{for(let d of l)if(su(d))for(let c in d){let u=d[c];su(u)&&s.push(u)}},i=(...l)=>{for(let d of l)if(Array.isArray(d))for(let c of d)su(c)&&s.push(c)},r=l=>{if(Array.isArray(l))for(let d of l)su(d)&&s.push(d);else su(l)&&s.push(l)},s=[o],a=s.pop();for(;a;)e(a)&&(t(a.additionalItems,a.additionalProperties,a.not,a.contains,a.propertyNames,a.if,a.then,a.else,a.unevaluatedItems,a.unevaluatedProperties),n(a.definitions,a.$defs,a.properties,a.patternProperties,a.dependencies,a.dependentSchemas),i(a.anyOf,a.allOf,a.oneOf,a.prefixItems),r(a.items)),a=s.pop()}var yE=class o{constructor(e,t,n,i,r,s,a){this._forceIntegerValues=e;this._forceIntegerValues&&(t=t|0,n=n|0,i=i|0,r=r|0,s=s|0,a=a|0),this.rawScrollLeft=i,this.rawScrollTop=a,t<0&&(t=0),i+t>n&&(i=n-t),i<0&&(i=0),r<0&&(r=0),a+r>s&&(a=s-r),a<0&&(a=0),this.width=t,this.scrollWidth=n,this.scrollLeft=i,this.height=r,this.scrollHeight=s,this.scrollTop=a}_scrollStateBrand=void 0;rawScrollLeft;rawScrollTop;width;scrollWidth;scrollLeft;height;scrollHeight;scrollTop;equals(e){return this.rawScrollLeft===e.rawScrollLeft&&this.rawScrollTop===e.rawScrollTop&&this.width===e.width&&this.scrollWidth===e.scrollWidth&&this.scrollLeft===e.scrollLeft&&this.height===e.height&&this.scrollHeight===e.scrollHeight&&this.scrollTop===e.scrollTop}withScrollDimensions(e,t){return new o(this._forceIntegerValues,typeof e.width<"u"?e.width:this.width,typeof e.scrollWidth<"u"?e.scrollWidth:this.scrollWidth,t?this.rawScrollLeft:this.scrollLeft,typeof e.height<"u"?e.height:this.height,typeof e.scrollHeight<"u"?e.scrollHeight:this.scrollHeight,t?this.rawScrollTop:this.scrollTop)}withScrollPosition(e){return new o(this._forceIntegerValues,this.width,this.scrollWidth,typeof e.scrollLeft<"u"?e.scrollLeft:this.rawScrollLeft,this.height,this.scrollHeight,typeof e.scrollTop<"u"?e.scrollTop:this.rawScrollTop)}createScrollEvent(e,t){let n=this.width!==e.width,i=this.scrollWidth!==e.scrollWidth,r=this.scrollLeft!==e.scrollLeft,s=this.height!==e.height,a=this.scrollHeight!==e.scrollHeight,l=this.scrollTop!==e.scrollTop;return{inSmoothScrolling:t,oldWidth:e.width,oldScrollWidth:e.scrollWidth,oldScrollLeft:e.scrollLeft,width:this.width,scrollWidth:this.scrollWidth,scrollLeft:this.scrollLeft,oldHeight:e.height,oldScrollHeight:e.scrollHeight,oldScrollTop:e.scrollTop,height:this.height,scrollHeight:this.scrollHeight,scrollTop:this.scrollTop,widthChanged:n,scrollWidthChanged:i,scrollLeftChanged:r,heightChanged:s,scrollHeightChanged:a,scrollTopChanged:l}}},ms=class extends V{_scrollableBrand=void 0;_smoothScrollDuration;_scheduleAtNextAnimationFrame;_state;_smoothScrolling;_onScroll=this._register(new E);onScroll=this._onScroll.event;constructor(e){super(),this._smoothScrollDuration=e.smoothScrollDuration,this._scheduleAtNextAnimationFrame=e.scheduleAtNextAnimationFrame,this._state=new yE(e.forceIntegerValues,0,0,0,0,0,0),this._smoothScrolling=null}dispose(){this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),super.dispose()}setSmoothScrollDuration(e){this._smoothScrollDuration=e}validateScrollPosition(e){return this._state.withScrollPosition(e)}getScrollDimensions(){return this._state}setScrollDimensions(e,t){let n=this._state.withScrollDimensions(e,t);this._setState(n,!!this._smoothScrolling),this._smoothScrolling?.acceptScrollDimensions(this._state)}getFutureScrollPosition(){return this._smoothScrolling?this._smoothScrolling.to:this._state}getCurrentScrollPosition(){return this._state}setScrollPositionNow(e){let t=this._state.withScrollPosition(e);this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),this._setState(t,!1)}setScrollPositionSmooth(e,t){if(this._smoothScrollDuration===0)return this.setScrollPositionNow(e);if(this._smoothScrolling){e={scrollLeft:typeof e.scrollLeft>"u"?this._smoothScrolling.to.scrollLeft:e.scrollLeft,scrollTop:typeof e.scrollTop>"u"?this._smoothScrolling.to.scrollTop:e.scrollTop};let n=this._state.withScrollPosition(e);if(this._smoothScrolling.to.scrollLeft===n.scrollLeft&&this._smoothScrolling.to.scrollTop===n.scrollTop)return;let i;t?i=new Ub(this._smoothScrolling.from,n,this._smoothScrolling.startTime,this._smoothScrolling.duration):i=this._smoothScrolling.combine(this._state,n,this._smoothScrollDuration),this._smoothScrolling.dispose(),this._smoothScrolling=i}else{let n=this._state.withScrollPosition(e);this._smoothScrolling=Ub.start(this._state,n,this._smoothScrollDuration)}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())})}hasPendingScrollAnimation(){return!!this._smoothScrolling}_performSmoothScrolling(){if(!this._smoothScrolling)return;let e=this._smoothScrolling.tick(),t=this._state.withScrollPosition(e);if(this._setState(t,!0),!!this._smoothScrolling){if(e.isDone){this._smoothScrolling.dispose(),this._smoothScrolling=null;return}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())})}}_setState(e,t){let n=this._state;n.equals(e)||(this._state=e,this._onScroll.fire(this._state.createScrollEvent(n,t)))}},Hb=class{scrollLeft;scrollTop;isDone;constructor(e,t,n){this.scrollLeft=e,this.scrollTop=t,this.isDone=n}};function vE(o,e){let t=e-o;return function(n){return o+t*tW(n)}}function JV(o,e,t){return function(n){return n<t?o(n/t):e((n-t)/(1-t))}}var Ub=class o{from;to;duration;startTime;animationFrameDisposable;scrollLeft;scrollTop;constructor(e,t,n,i){this.from=e,this.to=t,this.duration=i,this.startTime=n,this.animationFrameDisposable=null,this._initAnimations()}_initAnimations(){this.scrollLeft=this._initAnimation(this.from.scrollLeft,this.to.scrollLeft,this.to.width),this.scrollTop=this._initAnimation(this.from.scrollTop,this.to.scrollTop,this.to.height)}_initAnimation(e,t,n){if(Math.abs(e-t)>2.5*n){let r,s;return e<t?(r=e+.75*n,s=t-.75*n):(r=e-.75*n,s=t+.75*n),JV(vE(e,r),vE(s,t),.33)}return vE(e,t)}dispose(){this.animationFrameDisposable!==null&&(this.animationFrameDisposable.dispose(),this.animationFrameDisposable=null)}acceptScrollDimensions(e){this.to=e.withScrollPosition(this.to),this._initAnimations()}tick(){return this._tick(Date.now())}_tick(e){let t=(e-this.startTime)/this.duration;if(t<1){let n=this.scrollLeft(t),i=this.scrollTop(t);return new Hb(n,i,!1)}return new Hb(this.to.scrollLeft,this.to.scrollTop,!0)}combine(e,t,n){return o.start(e,t,n)}static start(e,t,n){n=n+10;let i=Date.now()-10;return new o(e,t,i,n)}};function eW(o){return Math.pow(o,3)}function tW(o){return 1-eW(1-o)}var gs={tabSize:4,indentSize:4,insertSpaces:!0,detectIndentation:!0,trimAutoWhitespace:!0,largeFileOptimizations:!0,bracketPairColorizationOptions:{enabled:!0,independentColorPoolPerBracketType:!1}};var IE="`~!@#$%^&*()-=+[{]}\\|;:'\",.<>/?";function nW(o=""){let e="(-?\\d*\\.\\d\\w*)|([^";for(let t of IE)o.indexOf(t)>=0||(e+="\\"+t);return e+="\\s]+)",new RegExp(e,"g")}var CE=nW();function lm(o){let e=CE;if(o&&o instanceof RegExp)if(o.global)e=o;else{let t="g";o.ignoreCase&&(t+="i"),o.multiline&&(t+="m"),o.unicode&&(t+="u"),e=new RegExp(o.source,t)}return e.lastIndex=0,e}var qR=new ui;qR.unshift({maxLen:1e3,windowSize:15,timeBudget:150});function zb(o,e,t,n,i){if(e=lm(e),i||(i=bo.first(qR)),t.length>i.maxLen){let d=o-i.maxLen/2;return d<0?d=0:n+=d,t=t.substring(d,o+i.maxLen/2),zb(o,e,t,n,i)}let r=Date.now(),s=o-1-n,a=-1,l=null;for(let d=1;!(Date.now()-r>=i.timeBudget);d++){let c=s-i.windowSize*d;e.lastIndex=Math.max(0,c);let u=iW(e,t,s,a);if(!u&&l||(l=u,c<=0))break;a=c}if(l){let d={word:l[0],startColumn:n+1+l.index,endColumn:n+1+l.index+l[0].length};return e.lastIndex=0,d}return null}function iW(o,e,t,n){let i;for(;i=o.exec(e);){let r=i.index||0;if(r<=t&&o.lastIndex>=t)return i;if(n>0&&r>n)return null}return null}function SE(...o){switch(o.length){case 1:return p("contextkey.scanner.hint.didYouMean1","Did you mean {0}?",o[0]);case 2:return p("contextkey.scanner.hint.didYouMean2","Did you mean {0} or {1}?",o[0],o[1]);case 3:return p("contextkey.scanner.hint.didYouMean3","Did you mean {0}, {1} or {2}?",o[0],o[1],o[2]);default:return}}var oW=p("contextkey.scanner.hint.didYouForgetToOpenOrCloseQuote","Did you forget to open or close the quote?"),rW=p("contextkey.scanner.hint.didYouForgetToEscapeSlash","Did you forget to escape the '/' (slash) character? Put two backslashes before it to escape, e.g., '\\\\/'."),dl=class o{static getLexeme(e){switch(e.type){case 0:return"(";case 1:return")";case 2:return"!";case 3:return e.isTripleEq?"===":"==";case 4:return e.isTripleEq?"!==":"!=";case 5:return"<";case 6:return"<=";case 7:return">=";case 8:return">=";case 9:return"=~";case 10:return e.lexeme;case 11:return"true";case 12:return"false";case 13:return"in";case 14:return"not";case 15:return"&&";case 16:return"||";case 17:return e.lexeme;case 18:return e.lexeme;case 19:return e.lexeme;case 20:return"EOF";default:throw y1(`unhandled token type: ${JSON.stringify(e)}; have you forgotten to add a case?`)}}static _regexFlags=new Set(["i","g","s","m","y","u"].map(e=>e.charCodeAt(0)));static _keywords=new Map([["not",14],["in",13],["false",12],["true",11]]);_input="";_start=0;_current=0;_tokens=[];_errors=[];get errors(){return this._errors}reset(e){return this._input=e,this._start=0,this._current=0,this._tokens=[],this._errors=[],this}scan(){for(;!this._isAtEnd();)switch(this._start=this._current,this._advance()){case 40:this._addToken(0);break;case 41:this._addToken(1);break;case 33:if(this._match(61)){let t=this._match(61);this._tokens.push({type:4,offset:this._start,isTripleEq:t})}else this._addToken(2);break;case 39:this._quotedString();break;case 47:this._regex();break;case 61:if(this._match(61)){let t=this._match(61);this._tokens.push({type:3,offset:this._start,isTripleEq:t})}else this._match(126)?this._addToken(9):this._error(SE("==","=~"));break;case 60:this._addToken(this._match(61)?6:5);break;case 62:this._addToken(this._match(61)?8:7);break;case 38:this._match(38)?this._addToken(15):this._error(SE("&&"));break;case 124:this._match(124)?this._addToken(16):this._error(SE("||"));break;case 32:case 13:case 9:case 10:case 160:break;default:this._string()}return this._start=this._current,this._addToken(20),Array.from(this._tokens)}_match(e){return this._isAtEnd()||this._input.charCodeAt(this._current)!==e?!1:(this._current++,!0)}_advance(){return this._input.charCodeAt(this._current++)}_peek(){return this._isAtEnd()?0:this._input.charCodeAt(this._current)}_addToken(e){this._tokens.push({type:e,offset:this._start})}_error(e){let t=this._start,n=this._input.substring(this._start,this._current),i={type:19,offset:this._start,lexeme:n};this._errors.push({offset:t,lexeme:n,additionalInfo:e}),this._tokens.push(i)}stringRe=/[a-zA-Z0-9_<>\-\./\\:\*\?\+\[\]\^,#@;"%\$\p{L}-]+/uy;_string(){this.stringRe.lastIndex=this._start;let e=this.stringRe.exec(this._input);if(e){this._current=this._start+e[0].length;let t=this._input.substring(this._start,this._current),n=o._keywords.get(t);n?this._addToken(n):this._tokens.push({type:17,lexeme:t,offset:this._start})}}_quotedString(){for(;this._peek()!==39&&!this._isAtEnd();)this._advance();if(this._isAtEnd()){this._error(oW);return}this._advance(),this._tokens.push({type:18,lexeme:this._input.substring(this._start+1,this._current-1),offset:this._start+1})}_regex(){let e=this._current,t=!1,n=!1;for(;;){if(e>=this._input.length){this._current=e,this._error(rW);return}let r=this._input.charCodeAt(e);if(t)t=!1;else if(r===47&&!n){e++;break}else r===91?n=!0:r===92?t=!0:r===93&&(n=!1);e++}for(;e<this._input.length&&o._regexFlags.has(this._input.charCodeAt(e));)e++;this._current=e;let i=this._input.substring(this._start,this._current);this._tokens.push({type:10,lexeme:i,offset:this._start})}_isAtEnd(){return this._current>=this._input.length}};var dm=class{ctor;staticArguments;supportsDelayedInstantiation;constructor(e,t=[],n=!1){this.ctor=e,this.staticArguments=t,this.supportsDelayedInstantiation=n}};var ra=class{_entries=new Map;constructor(...e){for(let[t,n]of e)this.set(t,n)}set(e,t){let n=this._entries.get(e);return this._entries.set(e,t),n}has(e){return this._entries.has(e)}get(e){return this._entries.get(e)}};var cl;(i=>{i.serviceIds=new Map,i.DI_TARGET="$di$target",i.DI_DEPENDENCIES="$di$dependencies";function n(r){return r[i.DI_DEPENDENCIES]||[]}i.getServiceDependencies=n})(cl||={});var ct=Y("instantiationService");function sW(o,e,t){e[cl.DI_TARGET]===e?e[cl.DI_DEPENDENCIES].push({id:o,index:t}):(e[cl.DI_DEPENDENCIES]=[{id:o,index:t}],e[cl.DI_TARGET]=e)}function Y(o){if(cl.serviceIds.has(o))return cl.serviceIds.get(o);let e=function(t,n,i){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");sW(e,t,i)};return e.toString=()=>o,cl.serviceIds.set(o,e),e}var Xn=new Map;Xn.set("false",!1);Xn.set("true",!0);Xn.set("isMac",Be);Xn.set("isLinux",Wt);Xn.set("isWindows",mt);Xn.set("isWeb",Zi);Xn.set("isMacNative",Be&&!Zi);Xn.set("isEdge",N1);Xn.set("isFirefox",_f);Xn.set("isChrome",Zw);Xn.set("isSafari",O1);var aW=Object.prototype.hasOwnProperty;var lW={regexParsingWithErrorRecovery:!0},dW=p("contextkey.parser.error.emptyString","Empty context key expression"),cW=p("contextkey.parser.error.emptyString.hint","Did you forget to write an expression? You can also put 'false' or 'true' to always evaluate to false or true, respectively."),uW=p("contextkey.parser.error.noInAfterNot","'in' after 'not'."),YR=p("contextkey.parser.error.closingParenthesis","closing parenthesis ')'"),hW=p("contextkey.parser.error.unexpectedToken","Unexpected token"),pW=p("contextkey.parser.error.unexpectedToken.hint","Did you forget to put && or || before the token?"),mW=p("contextkey.parser.error.unexpectedEOF","Unexpected end of expression"),gW=p("contextkey.parser.error.unexpectedEOF.hint","Did you forget to put a context key?"),wE=class o{constructor(e=lW){this._config=e}static _parseError=new Error;_scanner=new dl;_tokens=[];_current=0;_parsingErrors=[];get lexingErrors(){return this._scanner.errors}get parsingErrors(){return this._parsingErrors}parse(e){if(e===""){this._parsingErrors.push({message:dW,offset:0,lexeme:"",additionalInfo:cW});return}this._tokens=this._scanner.reset(e).scan(),this._current=0,this._parsingErrors=[];try{let t=this._expr();if(!this._isAtEnd()){let n=this._peek(),i=n.type===17?pW:void 0;throw this._parsingErrors.push({message:hW,offset:n.offset,lexeme:dl.getLexeme(n),additionalInfo:i}),o._parseError}return t}catch(t){if(t!==o._parseError)throw t;return}}_expr(){return this._or()}_or(){let e=[this._and()];for(;this._matchOne(16);){let t=this._and();e.push(t)}return e.length===1?e[0]:xt.or(...e)}_and(){let e=[this._term()];for(;this._matchOne(15);){let t=this._term();e.push(t)}return e.length===1?e[0]:xt.and(...e)}_term(){if(this._matchOne(2)){let e=this._peek();switch(e.type){case 11:return this._advance(),Si.INSTANCE;case 12:return this._advance(),Pi.INSTANCE;case 0:{this._advance();let t=this._expr();return this._consume(1,YR),t?.negate()}case 17:return this._advance(),Id.create(e.lexeme);default:throw this._errExpectedButGot("KEY | true | false | '(' expression ')'",e)}}return this._primary()}_primary(){let e=this._peek();switch(e.type){case 11:return this._advance(),xt.true();case 12:return this._advance(),xt.false();case 0:{this._advance();let t=this._expr();return this._consume(1,YR),t}case 17:{let t=e.lexeme;if(this._advance(),this._matchOne(9)){let i=this._peek();if(!this._config.regexParsingWithErrorRecovery){if(this._advance(),i.type!==10)throw this._errExpectedButGot("REGEX",i);let r=i.lexeme,s=r.lastIndexOf("/"),a=s===r.length-1?void 0:this._removeFlagsGY(r.substring(s+1)),l;try{l=new RegExp(r.substring(1,s),a)}catch{throw this._errExpectedButGot("REGEX",i)}return bm.create(t,l)}switch(i.type){case 10:case 19:{let r=[i.lexeme];this._advance();let s=this._peek(),a=0;for(let h=0;h<i.lexeme.length;h++)i.lexeme.charCodeAt(h)===40?a++:i.lexeme.charCodeAt(h)===41&&a--;for(;!this._isAtEnd()&&s.type!==15&&s.type!==16;){switch(s.type){case 0:a++;break;case 1:a--;break;case 10:case 18:for(let h=0;h<s.lexeme.length;h++)s.lexeme.charCodeAt(h)===40?a++:i.lexeme.charCodeAt(h)===41&&a--}if(a<0)break;r.push(dl.getLexeme(s)),this._advance(),s=this._peek()}let l=r.join(""),d=l.lastIndexOf("/"),c=d===l.length-1?void 0:this._removeFlagsGY(l.substring(d+1)),u;try{u=new RegExp(l.substring(1,d),c)}catch{throw this._errExpectedButGot("REGEX",i)}return xt.regex(t,u)}case 18:{let r=i.lexeme;this._advance();let s=null;if(!wk(r)){let a=r.indexOf("/"),l=r.lastIndexOf("/");if(a!==l&&a>=0){let d=r.slice(a+1,l),c=r[l+1]==="i"?"i":"";try{s=new RegExp(d,c)}catch{throw this._errExpectedButGot("REGEX",i)}}}if(s===null)throw this._errExpectedButGot("REGEX",i);return bm.create(t,s)}default:throw this._errExpectedButGot("REGEX",this._peek())}}if(this._matchOne(14)){this._consume(13,uW);let i=this._value();return xt.notIn(t,i)}switch(this._peek().type){case 3:{this._advance();let i=this._value();if(this._previous().type===18)return xt.equals(t,i);switch(i){case"true":return xt.has(t);case"false":return xt.not(t);default:return xt.equals(t,i)}}case 4:{this._advance();let i=this._value();if(this._previous().type===18)return xt.notEquals(t,i);switch(i){case"true":return xt.not(t);case"false":return xt.has(t);default:return xt.notEquals(t,i)}}case 5:return this._advance(),gm.create(t,this._value());case 6:return this._advance(),fm.create(t,this._value());case 7:return this._advance(),pm.create(t,this._value());case 8:return this._advance(),mm.create(t,this._value());case 13:return this._advance(),xt.in(t,this._value());default:return xt.has(t)}}case 20:throw this._parsingErrors.push({message:mW,offset:e.offset,lexeme:"",additionalInfo:gW}),o._parseError;default:throw this._errExpectedButGot(`true | false | KEY 
	| KEY '=~' REGEX 
	| KEY ('==' | '!=' | '<' | '<=' | '>' | '>=' | 'in' | 'not' 'in') value`,this._peek())}}_value(){let e=this._peek();switch(e.type){case 17:case 18:return this._advance(),e.lexeme;case 11:return this._advance(),"true";case 12:return this._advance(),"false";case 13:return this._advance(),"in";default:return""}}_flagsGYRe=/g|y/g;_removeFlagsGY(e){return e.replaceAll(this._flagsGYRe,"")}_previous(){return this._tokens[this._current-1]}_matchOne(e){return this._check(e)?(this._advance(),!0):!1}_advance(){return this._isAtEnd()||this._current++,this._previous()}_consume(e,t){if(this._check(e))return this._advance();throw this._errExpectedButGot(t,this._peek())}_errExpectedButGot(e,t,n){let i=p("contextkey.parser.error.expectedButGot",`Expected: {0}
Received: '{1}'.`,e,dl.getLexeme(t)),r=t.offset,s=dl.getLexeme(t);return this._parsingErrors.push({message:i,offset:r,lexeme:s,additionalInfo:n}),o._parseError}_check(e){return this._peek().type===e}_peek(){return this._tokens[this._current]}_isAtEnd(){return this._peek().type===20}},xt=class{static false(){return Si.INSTANCE}static true(){return Pi.INSTANCE}static has(e){return yd.create(e)}static equals(e,t){return um.create(e,t)}static notEquals(e,t){return hm.create(e,t)}static regex(e,t){return bm.create(e,t)}static in(e,t){return Kb.create(e,t)}static notIn(e,t){return Gb.create(e,t)}static not(e){return Id.create(e)}static and(...e){return jb.create(e,null,!0)}static or(...e){return vm.create(e,null,!0)}static greater(e,t){return pm.create(e,t)}static greaterEquals(e,t){return mm.create(e,t)}static smaller(e,t){return gm.create(e,t)}static smallerEquals(e,t){return fm.create(e,t)}static _parser=new wE({regexParsingWithErrorRecovery:!1});static deserialize(e){return e==null?void 0:this._parser.parse(e)}};function cm(o,e){return o.cmp(e)}var Si=class o{static INSTANCE=new o;type=0;constructor(){}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}substituteConstants(){return this}evaluate(e){return!1}serialize(){return"false"}keys(){return[]}map(e){return this}negate(){return Pi.INSTANCE}},Pi=class o{static INSTANCE=new o;type=1;constructor(){}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}substituteConstants(){return this}evaluate(e){return!0}serialize(){return"true"}keys(){return[]}map(e){return this}negate(){return Si.INSTANCE}},yd=class o{constructor(e,t){this.key=e;this.negated=t}static create(e,t=null){let n=Xn.get(e);return typeof n=="boolean"?n?Pi.INSTANCE:Si.INSTANCE:new o(e,t)}type=2;cmp(e){return e.type!==this.type?this.type-e.type:QR(this.key,e.key)}equals(e){return e.type===this.type?this.key===e.key:!1}substituteConstants(){let e=Xn.get(this.key);return typeof e=="boolean"?e?Pi.INSTANCE:Si.INSTANCE:this}evaluate(e){return!!e.getValue(this.key)}serialize(){return this.key}keys(){return[this.key]}map(e){return e.mapDefined(this.key)}negate(){return this.negated||(this.negated=Id.create(this.key,this)),this.negated}},um=class o{constructor(e,t,n){this.key=e;this.value=t;this.negated=n}static create(e,t,n=null){if(typeof t=="boolean")return t?yd.create(e,n):Id.create(e,n);let i=Xn.get(e);return typeof i=="boolean"?t===(i?"true":"false")?Pi.INSTANCE:Si.INSTANCE:new o(e,t,n)}type=4;cmp(e){return e.type!==this.type?this.type-e.type:Cd(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){let e=Xn.get(this.key);if(typeof e=="boolean"){let t=e?"true":"false";return this.value===t?Pi.INSTANCE:Si.INSTANCE}return this}evaluate(e){return e.getValue(this.key)==this.value}serialize(){return`${this.key} == '${this.value}'`}keys(){return[this.key]}map(e){return e.mapEquals(this.key,this.value)}negate(){return this.negated||(this.negated=hm.create(this.key,this.value,this)),this.negated}},Kb=class o{constructor(e,t){this.key=e;this.valueKey=t}static create(e,t){return new o(e,t)}type=10;negated=null;cmp(e){return e.type!==this.type?this.type-e.type:Cd(this.key,this.valueKey,e.key,e.valueKey)}equals(e){return e.type===this.type?this.key===e.key&&this.valueKey===e.valueKey:!1}substituteConstants(){return this}evaluate(e){let t=e.getValue(this.valueKey),n=e.getValue(this.key);return Array.isArray(t)?t.includes(n):typeof n=="string"&&typeof t=="object"&&t!==null?aW.call(t,n):!1}serialize(){return`${this.key} in '${this.valueKey}'`}keys(){return[this.key,this.valueKey]}map(e){return e.mapIn(this.key,this.valueKey)}negate(){return this.negated||(this.negated=Gb.create(this.key,this.valueKey)),this.negated}},Gb=class o{constructor(e,t){this.key=e;this.valueKey=t;this._negated=Kb.create(e,t)}static create(e,t){return new o(e,t)}type=11;_negated;cmp(e){return e.type!==this.type?this.type-e.type:this._negated.cmp(e._negated)}equals(e){return e.type===this.type?this._negated.equals(e._negated):!1}substituteConstants(){return this}evaluate(e){return!this._negated.evaluate(e)}serialize(){return`${this.key} not in '${this.valueKey}'`}keys(){return this._negated.keys()}map(e){return e.mapNotIn(this.key,this.valueKey)}negate(){return this._negated}},hm=class o{constructor(e,t,n){this.key=e;this.value=t;this.negated=n}static create(e,t,n=null){if(typeof t=="boolean")return t?Id.create(e,n):yd.create(e,n);let i=Xn.get(e);return typeof i=="boolean"?t===(i?"true":"false")?Si.INSTANCE:Pi.INSTANCE:new o(e,t,n)}type=5;cmp(e){return e.type!==this.type?this.type-e.type:Cd(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){let e=Xn.get(this.key);if(typeof e=="boolean"){let t=e?"true":"false";return this.value===t?Si.INSTANCE:Pi.INSTANCE}return this}evaluate(e){return e.getValue(this.key)!=this.value}serialize(){return`${this.key} != '${this.value}'`}keys(){return[this.key]}map(e){return e.mapNotEquals(this.key,this.value)}negate(){return this.negated||(this.negated=um.create(this.key,this.value,this)),this.negated}},Id=class o{constructor(e,t){this.key=e;this.negated=t}static create(e,t=null){let n=Xn.get(e);return typeof n=="boolean"?n?Si.INSTANCE:Pi.INSTANCE:new o(e,t)}type=3;cmp(e){return e.type!==this.type?this.type-e.type:QR(this.key,e.key)}equals(e){return e.type===this.type?this.key===e.key:!1}substituteConstants(){let e=Xn.get(this.key);return typeof e=="boolean"?e?Si.INSTANCE:Pi.INSTANCE:this}evaluate(e){return!e.getValue(this.key)}serialize(){return`!${this.key}`}keys(){return[this.key]}map(e){return e.mapNot(this.key)}negate(){return this.negated||(this.negated=yd.create(this.key,this)),this.negated}};function $b(o,e){if(typeof o=="string"){let t=parseFloat(o);isNaN(t)||(o=t)}return typeof o=="string"||typeof o=="number"?e(o):Si.INSTANCE}var pm=class o{constructor(e,t,n){this.key=e;this.value=t;this.negated=n}static create(e,t,n=null){return $b(t,i=>new o(e,i,n))}type=12;cmp(e){return e.type!==this.type?this.type-e.type:Cd(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))>this.value}serialize(){return`${this.key} > ${this.value}`}keys(){return[this.key]}map(e){return e.mapGreater(this.key,this.value)}negate(){return this.negated||(this.negated=fm.create(this.key,this.value,this)),this.negated}},mm=class o{constructor(e,t,n){this.key=e;this.value=t;this.negated=n}static create(e,t,n=null){return $b(t,i=>new o(e,i,n))}type=13;cmp(e){return e.type!==this.type?this.type-e.type:Cd(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))>=this.value}serialize(){return`${this.key} >= ${this.value}`}keys(){return[this.key]}map(e){return e.mapGreaterEquals(this.key,this.value)}negate(){return this.negated||(this.negated=gm.create(this.key,this.value,this)),this.negated}},gm=class o{constructor(e,t,n){this.key=e;this.value=t;this.negated=n}static create(e,t,n=null){return $b(t,i=>new o(e,i,n))}type=14;cmp(e){return e.type!==this.type?this.type-e.type:Cd(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))<this.value}serialize(){return`${this.key} < ${this.value}`}keys(){return[this.key]}map(e){return e.mapSmaller(this.key,this.value)}negate(){return this.negated||(this.negated=mm.create(this.key,this.value,this)),this.negated}},fm=class o{constructor(e,t,n){this.key=e;this.value=t;this.negated=n}static create(e,t,n=null){return $b(t,i=>new o(e,i,n))}type=15;cmp(e){return e.type!==this.type?this.type-e.type:Cd(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))<=this.value}serialize(){return`${this.key} <= ${this.value}`}keys(){return[this.key]}map(e){return e.mapSmallerEquals(this.key,this.value)}negate(){return this.negated||(this.negated=pm.create(this.key,this.value,this)),this.negated}},bm=class o{constructor(e,t){this.key=e;this.regexp=t}static create(e,t){return new o(e,t)}type=7;negated=null;cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.key<e.key)return-1;if(this.key>e.key)return 1;let t=this.regexp?this.regexp.source:"",n=e.regexp?e.regexp.source:"";return t<n?-1:t>n?1:0}equals(e){if(e.type===this.type){let t=this.regexp?this.regexp.source:"",n=e.regexp?e.regexp.source:"";return this.key===e.key&&t===n}return!1}substituteConstants(){return this}evaluate(e){let t=e.getValue(this.key);return this.regexp?this.regexp.test(t):!1}serialize(){let e=this.regexp?`/${this.regexp.source}/${this.regexp.flags}`:"/invalid/";return`${this.key} =~ ${e}`}keys(){return[this.key]}map(e){return e.mapRegex(this.key,this.regexp)}negate(){return this.negated||(this.negated=xE.create(this)),this.negated}},xE=class o{constructor(e){this._actual=e}static create(e){return new o(e)}type=8;cmp(e){return e.type!==this.type?this.type-e.type:this._actual.cmp(e._actual)}equals(e){return e.type===this.type?this._actual.equals(e._actual):!1}substituteConstants(){return this}evaluate(e){return!this._actual.evaluate(e)}serialize(){return`!(${this._actual.serialize()})`}keys(){return this._actual.keys()}map(e){return new o(this._actual.map(e))}negate(){return this._actual}};function XR(o){let e=null;for(let t=0,n=o.length;t<n;t++){let i=o[t].substituteConstants();if(o[t]!==i&&e===null){e=[];for(let r=0;r<t;r++)e[r]=o[r]}e!==null&&(e[t]=i)}return e===null?o:e}var jb=class o{constructor(e,t){this.expr=e;this.negated=t}static create(e,t,n){return o._normalizeArr(e,t,n)}type=6;cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.expr.length<e.expr.length)return-1;if(this.expr.length>e.expr.length)return 1;for(let t=0,n=this.expr.length;t<n;t++){let i=cm(this.expr[t],e.expr[t]);if(i!==0)return i}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length)return!1;for(let t=0,n=this.expr.length;t<n;t++)if(!this.expr[t].equals(e.expr[t]))return!1;return!0}return!1}substituteConstants(){let e=XR(this.expr);return e===this.expr?this:o.create(e,this.negated,!1)}evaluate(e){for(let t=0,n=this.expr.length;t<n;t++)if(!this.expr[t].evaluate(e))return!1;return!0}static _normalizeArr(e,t,n){let i=[],r=!1;for(let s of e)if(s){if(s.type===1){r=!0;continue}if(s.type===0)return Si.INSTANCE;if(s.type===6){i.push(...s.expr);continue}i.push(s)}if(i.length===0&&r)return Pi.INSTANCE;if(i.length!==0){if(i.length===1)return i[0];i.sort(cm);for(let s=1;s<i.length;s++)i[s-1].equals(i[s])&&(i.splice(s,1),s--);if(i.length===1)return i[0];for(;i.length>1;){let s=i[i.length-1];if(s.type!==9)break;i.pop();let a=i.pop(),l=i.length===0,d=vm.create(s.expr.map(c=>o.create([c,a],null,n)),null,l);d&&(i.push(d),i.sort(cm))}if(i.length===1)return i[0];if(n){for(let s=0;s<i.length;s++)for(let a=s+1;a<i.length;a++)if(i[s].negate().equals(i[a]))return Si.INSTANCE;if(i.length===1)return i[0]}return new o(i,t)}}serialize(){return this.expr.map(e=>e.serialize()).join(" && ")}keys(){let e=[];for(let t of this.expr)e.push(...t.keys());return e}map(e){return new o(this.expr.map(t=>t.map(e)),null)}negate(){if(!this.negated){let e=[];for(let t of this.expr)e.push(t.negate());this.negated=vm.create(e,this,!0)}return this.negated}},vm=class o{constructor(e,t){this.expr=e;this.negated=t}static create(e,t,n){return o._normalizeArr(e,t,n)}type=9;cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.expr.length<e.expr.length)return-1;if(this.expr.length>e.expr.length)return 1;for(let t=0,n=this.expr.length;t<n;t++){let i=cm(this.expr[t],e.expr[t]);if(i!==0)return i}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length)return!1;for(let t=0,n=this.expr.length;t<n;t++)if(!this.expr[t].equals(e.expr[t]))return!1;return!0}return!1}substituteConstants(){let e=XR(this.expr);return e===this.expr?this:o.create(e,this.negated,!1)}evaluate(e){for(let t=0,n=this.expr.length;t<n;t++)if(this.expr[t].evaluate(e))return!0;return!1}static _normalizeArr(e,t,n){let i=[],r=!1;if(e){for(let s=0,a=e.length;s<a;s++){let l=e[s];if(l){if(l.type===0){r=!0;continue}if(l.type===1)return Pi.INSTANCE;if(l.type===9){i=i.concat(l.expr);continue}i.push(l)}}if(i.length===0&&r)return Si.INSTANCE;i.sort(cm)}if(i.length!==0){if(i.length===1)return i[0];for(let s=1;s<i.length;s++)i[s-1].equals(i[s])&&(i.splice(s,1),s--);if(i.length===1)return i[0];if(n){for(let s=0;s<i.length;s++)for(let a=s+1;a<i.length;a++)if(i[s].negate().equals(i[a]))return Pi.INSTANCE;if(i.length===1)return i[0]}return new o(i,t)}}serialize(){return this.expr.map(e=>e.serialize()).join(" || ")}keys(){let e=[];for(let t of this.expr)e.push(...t.keys());return e}map(e){return new o(this.expr.map(t=>t.map(e)),null)}negate(){if(!this.negated){let e=[];for(let t of this.expr)e.push(t.negate());for(;e.length>1;){let t=e.shift(),n=e.shift(),i=[];for(let r of ZR(t))for(let s of ZR(n))i.push(jb.create([r,s],null,!1));e.unshift(o.create(i,null,!1))}this.negated=o.create(e,this,!0)}return this.negated}},j=class o extends yd{static _info=[];static all(){return o._info.values()}_defaultValue;constructor(e,t,n){super(e,null),this._defaultValue=t,typeof n=="object"?o._info.push({...n,key:e}):n!==!0&&o._info.push({key:e,description:n,type:t!=null?typeof t:void 0})}bindTo(e){return e.createKey(this.key,this._defaultValue)}getValue(e){return e.getContextKeyValue(this.key)}toNegated(){return this.negate()}isEqualTo(e){return um.create(this.key,e)}notEqualsTo(e){return hm.create(this.key,e)}},ft=Y("contextKeyService");function QR(o,e){return o<e?-1:o>e?1:0}function Cd(o,e,t,n){return o<t?-1:o>t?1:e<n?-1:e>n?1:0}function ZR(o){return o.type===9?o.expr:[o]}var Co=Y("accessibilityService");var d$=new j("accessibilityModeEnabled",!1);var JR="ACCESSIBLE_VIEW_SHOWN_";var Go=Y("environmentService"),S$=Go;var fs=Y("contextService");function Yb(o){let e=o;return typeof e?.id=="string"&&ie.isUri(e.uri)}function Zb(o){let e=o;return typeof e?.id=="string"&&ie.isUri(e.configPath)}var eM="code-workspace",P$=`.${eM}`,F$=[{name:p("codeWorkspace","Code Workspace"),extensions:[eM]}];var Et=Y("configurationService");function tM(o){return o.applicationValue!==void 0||o.userValue!==void 0||o.userLocalValue!==void 0||o.userRemoteValue!==void 0||o.workspaceValue!==void 0||o.workspaceFolderValue!==void 0}function nM(o){return o.replace(/[\[\]]/g,"")}var EE=class{data=new Map;add(e,t){Nf(an(e)),Nf(mn(t)),Nf(!this.data.has(e),"There is already an extension with this id"),this.data.set(e,t)}knows(e){return this.data.has(e)}as(e){return this.data.get(e)||null}},et=new EE;var Sd={JSONContribution:"base.contributions.json"};function bW(o){return o.length>0&&o.charAt(o.length-1)==="#"?o.substring(0,o.length-1):o}var _E=class{schemasById;_onDidChangeSchema=new E;onDidChangeSchema=this._onDidChangeSchema.event;constructor(){this.schemasById={}}registerSchema(e,t){this.schemasById[bW(e)]=t,this._onDidChangeSchema.fire(e)}notifySchemaChanged(e){this._onDidChangeSchema.fire(e)}getSchemaContributions(){return{schemas:this.schemasById}}getSchemaContent(e){let t=this.schemasById[e];return t?$R(t):void 0}hasSchemaContent(e){return!!this.schemasById[e]}},vW=new _E;et.add(Sd.JSONContribution,vW);var oq=Y("policy");var bs={Configuration:"base.contributions.configuration"};var Qb={properties:{},patternProperties:{}},Jb={properties:{},patternProperties:{}},ev={properties:{},patternProperties:{}},tv={properties:{},patternProperties:{}},nv={properties:{},patternProperties:{}},ym={properties:{},patternProperties:{}},wd="vscode://schemas/settings/resourceLanguage";var iv=et.as(Sd.JSONContribution),TE=class{registeredConfigurationDefaults=[];configurationDefaultsOverrides;defaultLanguageConfigurationOverridesNode;configurationContributors;configurationProperties;policyConfigurations;excludedConfigurationProperties;resourceLanguageSettingsSchema;overrideIdentifiers=new Set;_onDidSchemaChange=new E;onDidSchemaChange=this._onDidSchemaChange.event;_onDidUpdateConfiguration=new E;onDidUpdateConfiguration=this._onDidUpdateConfiguration.event;constructor(){this.configurationDefaultsOverrides=new Map,this.defaultLanguageConfigurationOverridesNode={id:"defaultOverrides",title:p("defaultLanguageConfigurationOverrides.title","Default Language Configuration Overrides"),properties:{}},this.configurationContributors=[this.defaultLanguageConfigurationOverridesNode],this.resourceLanguageSettingsSchema={properties:{},patternProperties:{},additionalProperties:!0,allowTrailingCommas:!0,allowComments:!0},this.configurationProperties={},this.policyConfigurations=new Map,this.excludedConfigurationProperties={},iv.registerSchema(wd,this.resourceLanguageSettingsSchema),this.registerOverridePropertyPatternKey()}registerConfiguration(e,t=!0){this.registerConfigurations([e],t)}registerConfigurations(e,t=!0){let n=new Set;this.doRegisterConfigurations(e,t,n),iv.registerSchema(wd,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:n})}deregisterConfigurations(e){let t=new Set;this.doDeregisterConfigurations(e,t),iv.registerSchema(wd,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:t})}updateConfigurations({add:e,remove:t}){let n=new Set;this.doDeregisterConfigurations(t,n),this.doRegisterConfigurations(e,!1,n),iv.registerSchema(wd,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:n})}registerDefaultConfigurations(e){let t=new Set;this.doRegisterDefaultConfigurations(e,t),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:t,defaultsOverrides:!0})}doRegisterDefaultConfigurations(e,t){this.registeredConfigurationDefaults.push(...e);let n=[];for(let{overrides:i,source:r}of e)for(let s in i){t.add(s);let a=this.configurationDefaultsOverrides.get(s)??this.configurationDefaultsOverrides.set(s,{configurationDefaultOverrides:[]}).get(s),l=i[s];if(a.configurationDefaultOverrides.push({value:l,source:r}),au.test(s)){let d=this.mergeDefaultConfigurationsForOverrideIdentifier(s,l,r,a.configurationDefaultOverrideValue);if(!d)continue;a.configurationDefaultOverrideValue=d,this.updateDefaultOverrideProperty(s,d,r),n.push(...yW(s))}else{let d=this.mergeDefaultConfigurationsForConfigurationProperty(s,l,r,a.configurationDefaultOverrideValue);if(!d)continue;a.configurationDefaultOverrideValue=d;let c=this.configurationProperties[s];c&&(this.updatePropertyDefaultValue(s,c),this.updateSchema(s,c))}}this.doRegisterOverrideIdentifiers(n)}deregisterDefaultConfigurations(e){let t=new Set;this.doDeregisterDefaultConfigurations(e,t),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:t,defaultsOverrides:!0})}doDeregisterDefaultConfigurations(e,t){for(let n of e){let i=this.registeredConfigurationDefaults.indexOf(n);i!==-1&&this.registeredConfigurationDefaults.splice(i,1)}for(let{overrides:n,source:i}of e)for(let r in n){let s=this.configurationDefaultsOverrides.get(r);if(!s)continue;let a=s.configurationDefaultOverrides.findIndex(l=>i?l.source?.id===i.id:l.value===n[r]);if(a!==-1){if(s.configurationDefaultOverrides.splice(a,1),s.configurationDefaultOverrides.length===0&&this.configurationDefaultsOverrides.delete(r),au.test(r)){let l;for(let d of s.configurationDefaultOverrides)l=this.mergeDefaultConfigurationsForOverrideIdentifier(r,d.value,d.source,l);l&&!md(l.value)?(s.configurationDefaultOverrideValue=l,this.updateDefaultOverrideProperty(r,l,i)):(this.configurationDefaultsOverrides.delete(r),delete this.configurationProperties[r],delete this.defaultLanguageConfigurationOverridesNode.properties[r])}else{let l;for(let c of s.configurationDefaultOverrides)l=this.mergeDefaultConfigurationsForConfigurationProperty(r,c.value,c.source,l);s.configurationDefaultOverrideValue=l;let d=this.configurationProperties[r];d&&(this.updatePropertyDefaultValue(r,d),this.updateSchema(r,d))}t.add(r)}}this.updateOverridePropertyPatternKey()}updateDefaultOverrideProperty(e,t,n){let i={type:"object",default:t.value,description:p("defaultLanguageConfiguration.description","Configure settings to be overridden for the {0} language.",nM(e)),$ref:wd,defaultDefaultValue:t.value,source:n,defaultValueSource:n};this.configurationProperties[e]=i,this.defaultLanguageConfigurationOverridesNode.properties[e]=i}mergeDefaultConfigurationsForOverrideIdentifier(e,t,n,i){let r=i?.value||{},s=i?.source??new Map;if(!(s instanceof Map)){console.error("objectConfigurationSources is not a Map");return}for(let a of Object.keys(t)){let l=t[a];if(mn(l)&&(qn(r[a])||mn(r[a]))){if(r[a]={...r[a]??{},...l},n)for(let c in l)s.set(`${a}.${c}`,n)}else r[a]=l,n?s.set(a,n):s.delete(a)}return{value:r,source:s}}mergeDefaultConfigurationsForConfigurationProperty(e,t,n,i){let r=this.configurationProperties[e],s=i?.value??r?.defaultDefaultValue,a=n;if(mn(t)&&(r!==void 0&&r.type==="object"||r===void 0&&(qn(s)||mn(s)))){if(a=i?.source??new Map,!(a instanceof Map)){console.error("defaultValueSource is not a Map");return}for(let d in t)n&&a.set(`${e}.${d}`,n);t={...mn(s)?s:{},...t}}return{value:t,source:a}}deltaConfiguration(e){let t=!1,n=new Set;e.removedDefaults&&(this.doDeregisterDefaultConfigurations(e.removedDefaults,n),t=!0),e.addedDefaults&&(this.doRegisterDefaultConfigurations(e.addedDefaults,n),t=!0),e.removedConfigurations&&this.doDeregisterConfigurations(e.removedConfigurations,n),e.addedConfigurations&&this.doRegisterConfigurations(e.addedConfigurations,!1,n),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:n,defaultsOverrides:t})}notifyConfigurationSchemaUpdated(...e){this._onDidSchemaChange.fire()}registerOverrideIdentifiers(e){this.doRegisterOverrideIdentifiers(e),this._onDidSchemaChange.fire()}doRegisterOverrideIdentifiers(e){for(let t of e)this.overrideIdentifiers.add(t);this.updateOverridePropertyPatternKey()}doRegisterConfigurations(e,t,n){e.forEach(i=>{this.validateAndRegisterProperties(i,t,i.extensionInfo,i.restrictedProperties,void 0,n),this.configurationContributors.push(i),this.registerJSONConfiguration(i)})}doDeregisterConfigurations(e,t){let n=i=>{if(i.properties)for(let r in i.properties){t.add(r);let s=this.configurationProperties[r];s?.policy?.name&&this.policyConfigurations.delete(s.policy.name),delete this.configurationProperties[r],this.removeFromSchema(r,i.properties[r])}i.allOf?.forEach(r=>n(r))};for(let i of e){n(i);let r=this.configurationContributors.indexOf(i);r!==-1&&this.configurationContributors.splice(r,1)}}validateAndRegisterProperties(e,t=!0,n,i,r=3,s){r=pi(e.scope)?r:e.scope;let a=e.properties;if(a)for(let d in a){let c=a[d];if(t&&CW(d,c)){delete a[d];continue}if(c.source=n,c.defaultDefaultValue=a[d].default,this.updatePropertyDefaultValue(d,c),au.test(d)?c.scope=void 0:(c.scope=pi(c.scope)?r:c.scope,c.restricted=pi(c.restricted)?!!i?.includes(d):c.restricted),a[d].hasOwnProperty("included")&&!a[d].included){this.excludedConfigurationProperties[d]=a[d],delete a[d];continue}else this.configurationProperties[d]=a[d],a[d].policy?.name&&this.policyConfigurations.set(a[d].policy.name,d);!a[d].deprecationMessage&&a[d].markdownDeprecationMessage&&(a[d].deprecationMessage=a[d].markdownDeprecationMessage),s.add(d)}let l=e.allOf;if(l)for(let d of l)this.validateAndRegisterProperties(d,t,n,i,r,s)}getConfigurations(){return this.configurationContributors}getConfigurationProperties(){return this.configurationProperties}getPolicyConfigurations(){return this.policyConfigurations}getExcludedConfigurationProperties(){return this.excludedConfigurationProperties}getRegisteredDefaultConfigurations(){return[...this.registeredConfigurationDefaults]}getConfigurationDefaultsOverrides(){let e=new Map;for(let[t,n]of this.configurationDefaultsOverrides)n.configurationDefaultOverrideValue&&e.set(t,n.configurationDefaultOverrideValue);return e}registerJSONConfiguration(e){let t=n=>{let i=n.properties;if(i)for(let s in i)this.updateSchema(s,i[s]);n.allOf?.forEach(t)};t(e)}updateSchema(e,t){switch(Qb.properties[e]=t,t.scope){case 1:Jb.properties[e]=t;break;case 2:ev.properties[e]=t;break;case 6:tv.properties[e]=t;break;case 3:nv.properties[e]=t;break;case 4:ym.properties[e]=t;break;case 5:ym.properties[e]=t,this.resourceLanguageSettingsSchema.properties[e]=t;break}}removeFromSchema(e,t){switch(delete Qb.properties[e],t.scope){case 1:delete Jb.properties[e];break;case 2:delete ev.properties[e];break;case 6:delete tv.properties[e];break;case 3:delete nv.properties[e];break;case 4:case 5:delete ym.properties[e],delete this.resourceLanguageSettingsSchema.properties[e];break}}updateOverridePropertyPatternKey(){for(let e of this.overrideIdentifiers.values()){let t=`[${e}]`,n={type:"object",description:p("overrideSettings.defaultDescription","Configure editor settings to be overridden for a language."),errorMessage:p("overrideSettings.errorMessage","This setting does not support per-language configuration."),$ref:wd};this.updatePropertyDefaultValue(t,n),Qb.properties[t]=n,Jb.properties[t]=n,ev.properties[t]=n,tv.properties[t]=n,nv.properties[t]=n,ym.properties[t]=n}}registerOverridePropertyPatternKey(){let e={type:"object",description:p("overrideSettings.defaultDescription","Configure editor settings to be overridden for a language."),errorMessage:p("overrideSettings.errorMessage","This setting does not support per-language configuration."),$ref:wd};Qb.patternProperties[xd]=e,Jb.patternProperties[xd]=e,ev.patternProperties[xd]=e,tv.patternProperties[xd]=e,nv.patternProperties[xd]=e,ym.patternProperties[xd]=e,this._onDidSchemaChange.fire()}updatePropertyDefaultValue(e,t){let n=this.configurationDefaultsOverrides.get(e)?.configurationDefaultOverrideValue,i,r;n&&(!t.disallowConfigurationDefault||!n.source)&&(i=n.value,r=n.source),qn(i)&&(i=t.defaultDefaultValue,r=void 0),qn(i)&&(i=IW(t.type)),t.default=i,t.defaultValueSource=r}},oM="\\[([^\\]]+)\\]",iM=new RegExp(oM,"g"),xd=`^(${oM})+$`,au=new RegExp(xd);function yW(o){let e=[];if(au.test(o)){let t=iM.exec(o);for(;t?.length;){let n=t[1].trim();n&&e.push(n),t=iM.exec(o)}}return Xs(e)}function IW(o){switch(Array.isArray(o)?o[0]:o){case"boolean":return!1;case"integer":case"number":return 0;case"string":return"";case"array":return[];case"object":return{};default:return null}}var ov=new TE;et.add(bs.Configuration,ov);function CW(o,e){return o.trim()?au.test(o)?p("config.property.languageDefault","Cannot register '{0}'. This matches property pattern '\\\\[.*\\\\]$' for describing language specific editor settings. Use 'configurationDefaults' contribution.",o):ov.getConfigurationProperties()[o]!==void 0?p("config.property.duplicate","Cannot register '{0}'. This property is already registered.",o):e.policy?.name&&ov.getPolicyConfigurations().get(e.policy?.name)!==void 0?p("config.policy.duplicate","Cannot register '{0}'. The associated policy {1} is already registered with {2}.",o,e.policy?.name,ov.getPolicyConfigurations().get(e.policy?.name)):null:p("config.property.empty","Cannot register an empty property")}var Dr=8,rv=class{_values;constructor(e){this._values=e}hasChanged(e){return this._values[e]}},Im=class{stableMinimapLayoutInput;stableFitMaxMinimapScale;stableFitRemainingWidth;constructor(){this.stableMinimapLayoutInput=null,this.stableFitMaxMinimapScale=0,this.stableFitRemainingWidth=0}},It=class{id;name;defaultValue;schema;constructor(e,t,n,i){this.id=e,this.name=t,this.defaultValue=n,this.schema=i}applyUpdate(e,t){return av(e,t)}compute(e,t,n){return n}},du=class{constructor(e,t){this.newValue=e;this.didChange=t}};function av(o,e){if(typeof o!="object"||typeof e!="object"||!o||!e)return new du(e,o!==e);if(Array.isArray(o)||Array.isArray(e)){let n=Array.isArray(o)&&Array.isArray(e)&&on(o,e);return new du(e,!n)}let t=!1;for(let n in e)if(e.hasOwnProperty(n)){let i=av(o[n],e[n]);i.didChange&&(o[n]=i.newValue,t=!0)}return new du(o,t)}var _d=class{id;name;defaultValue;schema=void 0;constructor(e){this.id=e,this.name="_never_",this.defaultValue=void 0}applyUpdate(e,t){return av(e,t)}validate(e){return this.defaultValue}},ul=class{id;name;defaultValue;schema;constructor(e,t,n,i){this.id=e,this.name=t,this.defaultValue=n,this.schema=i}applyUpdate(e,t){return av(e,t)}validate(e){return typeof e>"u"?this.defaultValue:e}compute(e,t,n){return n}};function Ee(o,e){return typeof o>"u"?e:o==="false"?!1:!!o}var Ye=class extends ul{constructor(e,t,n,i=void 0){typeof i<"u"&&(i.type="boolean",i.default=n),super(e,t,n,i)}validate(e){return Ee(e,this.defaultValue)}};function SW(o,e,t,n){if(typeof o>"u")return e;let i=parseInt(o,10);return isNaN(i)?e:(i=Math.max(t,i),i=Math.min(n,i),i|0)}var vt=class o extends ul{static clampedInt(e,t,n,i){return SW(e,t,n,i)}minimum;maximum;constructor(e,t,n,i,r,s=void 0){typeof s<"u"&&(s.type="integer",s.default=n,s.minimum=i,s.maximum=r),super(e,t,n,s),this.minimum=i,this.maximum=r}validate(e){return o.clampedInt(e,this.defaultValue,this.minimum,this.maximum)}};var tr=class o extends ul{static clamp(e,t,n){return e<t?t:e>n?n:e}static float(e,t){if(typeof e=="number")return e;if(typeof e>"u")return t;let n=parseFloat(e);return isNaN(n)?t:n}validationFn;constructor(e,t,n,i,r){typeof r<"u"&&(r.type="number",r.default=n),super(e,t,n,r),this.validationFn=i}validate(e){return this.validationFn(o.float(e,this.defaultValue))}},gi=class o extends ul{static string(e,t){return typeof e!="string"?t:e}constructor(e,t,n,i=void 0){typeof i<"u"&&(i.type="string",i.default=n),super(e,t,n,i)}validate(e){return o.string(e,this.defaultValue)}};function Ut(o,e,t,n){return typeof o!="string"?e:n&&o in n?n[o]:t.indexOf(o)===-1?e:o}var Rt=class extends ul{_allowedValues;constructor(e,t,n,i,r=void 0){typeof r<"u"&&(r.type="string",r.enum=i,r.default=n),super(e,t,n,r),this._allowedValues=i}validate(e){return Ut(e,this.defaultValue,this._allowedValues)}},lu=class extends It{_allowedValues;_convert;constructor(e,t,n,i,r,s,a=void 0){typeof a<"u"&&(a.type="string",a.enum=r,a.default=i),super(e,t,n,a),this._allowedValues=r,this._convert=s}validate(e){return typeof e!="string"?this.defaultValue:this._allowedValues.indexOf(e)===-1?this.defaultValue:this._convert(e)}};function wW(o){switch(o){case"none":return 0;case"keep":return 1;case"brackets":return 2;case"advanced":return 3;case"full":return 4}}var LE=class extends It{constructor(){super(2,"accessibilitySupport",0,{type:"string",enum:["auto","on","off"],enumDescriptions:[p("accessibilitySupport.auto","Use platform APIs to detect when a Screen Reader is attached."),p("accessibilitySupport.on","Optimize for usage with a Screen Reader."),p("accessibilitySupport.off","Assume a screen reader is not attached.")],default:"auto",tags:["accessibility"],description:p("accessibilitySupport","Controls if the UI should run in a mode where it is optimized for screen readers.")})}validate(e){switch(e){case"auto":return 0;case"off":return 1;case"on":return 2}return this.defaultValue}compute(e,t,n){return n===0?e.accessibilitySupport:n}},DE=class extends It{constructor(){let e={insertSpace:!0,ignoreEmptyLines:!0};super(23,"comments",e,{"editor.comments.insertSpace":{type:"boolean",default:e.insertSpace,description:p("comments.insertSpace","Controls whether a space character is inserted when commenting.")},"editor.comments.ignoreEmptyLines":{type:"boolean",default:e.ignoreEmptyLines,description:p("comments.ignoreEmptyLines","Controls if empty lines should be ignored with toggle, add or remove actions for line comments.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{insertSpace:Ee(t.insertSpace,this.defaultValue.insertSpace),ignoreEmptyLines:Ee(t.ignoreEmptyLines,this.defaultValue.ignoreEmptyLines)}}};function xW(o){switch(o){case"blink":return 1;case"smooth":return 2;case"phase":return 3;case"expand":return 4;case"solid":return 5}}function EW(o){switch(o){case"line":return 1;case"block":return 2;case"underline":return 3;case"line-thin":return 4;case"block-outline":return 5;case"underline-thin":return 6}}var kE=class extends _d{constructor(){super(144)}compute(e,t,n){let i=["monaco-editor"];return t.get(40)&&i.push(t.get(40)),e.extraEditorClassName&&i.push(e.extraEditorClassName),t.get(75)==="default"?i.push("mouse-default"):t.get(75)==="copy"&&i.push("mouse-copy"),t.get(113)&&i.push("showUnused"),t.get(142)&&i.push("showDeprecated"),i.join(" ")}},RE=class extends Ye{constructor(){super(38,"emptySelectionClipboard",!0,{description:p("emptySelectionClipboard","Controls whether copying without a selection copies the current line.")})}compute(e,t,n){return n&&e.emptySelectionClipboard}},ME=class extends It{constructor(){let e={cursorMoveOnType:!0,seedSearchStringFromSelection:"always",autoFindInSelection:"never",globalFindClipboard:!1,addExtraSpaceOnTop:!0,loop:!0};super(42,"find",e,{"editor.find.cursorMoveOnType":{type:"boolean",default:e.cursorMoveOnType,description:p("find.cursorMoveOnType","Controls whether the cursor should jump to find matches while typing.")},"editor.find.seedSearchStringFromSelection":{type:"string",enum:["never","always","selection"],default:e.seedSearchStringFromSelection,enumDescriptions:[p("editor.find.seedSearchStringFromSelection.never","Never seed search string from the editor selection."),p("editor.find.seedSearchStringFromSelection.always","Always seed search string from the editor selection, including word at cursor position."),p("editor.find.seedSearchStringFromSelection.selection","Only seed search string from the editor selection.")],description:p("find.seedSearchStringFromSelection","Controls whether the search string in the Find Widget is seeded from the editor selection.")},"editor.find.autoFindInSelection":{type:"string",enum:["never","always","multiline"],default:e.autoFindInSelection,enumDescriptions:[p("editor.find.autoFindInSelection.never","Never turn on Find in Selection automatically (default)."),p("editor.find.autoFindInSelection.always","Always turn on Find in Selection automatically."),p("editor.find.autoFindInSelection.multiline","Turn on Find in Selection automatically when multiple lines of content are selected.")],description:p("find.autoFindInSelection","Controls the condition for turning on Find in Selection automatically.")},"editor.find.globalFindClipboard":{type:"boolean",default:e.globalFindClipboard,description:p("find.globalFindClipboard","Controls whether the Find Widget should read or modify the shared find clipboard on macOS."),included:Be},"editor.find.addExtraSpaceOnTop":{type:"boolean",default:e.addExtraSpaceOnTop,description:p("find.addExtraSpaceOnTop","Controls whether the Find Widget should add extra lines on top of the editor. When true, you can scroll beyond the first line when the Find Widget is visible.")},"editor.find.loop":{type:"boolean",default:e.loop,description:p("find.loop","Controls whether the search automatically restarts from the beginning (or the end) when no further matches can be found.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{cursorMoveOnType:Ee(t.cursorMoveOnType,this.defaultValue.cursorMoveOnType),seedSearchStringFromSelection:typeof e.seedSearchStringFromSelection=="boolean"?e.seedSearchStringFromSelection?"always":"never":Ut(t.seedSearchStringFromSelection,this.defaultValue.seedSearchStringFromSelection,["never","always","selection"]),autoFindInSelection:typeof e.autoFindInSelection=="boolean"?e.autoFindInSelection?"always":"never":Ut(t.autoFindInSelection,this.defaultValue.autoFindInSelection,["never","always","multiline"]),globalFindClipboard:Ee(t.globalFindClipboard,this.defaultValue.globalFindClipboard),addExtraSpaceOnTop:Ee(t.addExtraSpaceOnTop,this.defaultValue.addExtraSpaceOnTop),loop:Ee(t.loop,this.defaultValue.loop)}}},Td=class o extends It{static OFF='"liga" off, "calt" off';static ON='"liga" on, "calt" on';constructor(){super(52,"fontLigatures",o.OFF,{anyOf:[{type:"boolean",description:p("fontLigatures","Enables/Disables font ligatures ('calt' and 'liga' font features). Change this to a string for fine-grained control of the 'font-feature-settings' CSS property.")},{type:"string",description:p("fontFeatureSettings","Explicit 'font-feature-settings' CSS property. A boolean can be passed instead if one only needs to turn on/off ligatures.")}],description:p("fontLigaturesGeneral","Configures font ligatures or font features. Can be either a boolean to enable/disable ligatures or a string for the value of the CSS 'font-feature-settings' property."),default:!1})}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e==="false"||e.length===0?o.OFF:e==="true"?o.ON:e:e?o.ON:o.OFF}},uu=class o extends It{static OFF="normal";static TRANSLATE="translate";constructor(){super(55,"fontVariations",o.OFF,{anyOf:[{type:"boolean",description:p("fontVariations","Enables/Disables the translation from font-weight to font-variation-settings. Change this to a string for fine-grained control of the 'font-variation-settings' CSS property.")},{type:"string",description:p("fontVariationSettings","Explicit 'font-variation-settings' CSS property. A boolean can be passed instead if one only needs to translate font-weight to font-variation-settings.")}],description:p("fontVariationsGeneral","Configures font variations. Can be either a boolean to enable/disable the translation from font-weight to font-variation-settings or a string for the value of the CSS 'font-variation-settings' property."),default:!1})}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e==="false"?o.OFF:e==="true"?o.TRANSLATE:e:e?o.TRANSLATE:o.OFF}compute(e,t,n){return e.fontInfo.fontVariationSettings}},AE=class extends _d{constructor(){super(51)}compute(e,t,n){return e.fontInfo}},OE=class extends ul{constructor(){super(53,"fontSize",to.fontSize,{type:"number",minimum:6,maximum:100,default:to.fontSize,description:p("fontSize","Controls the font size in pixels.")})}validate(e){let t=tr.float(e,this.defaultValue);return t===0?to.fontSize:tr.clamp(t,6,100)}compute(e,t,n){return e.fontInfo.fontSize}},NE=class o extends It{static SUGGESTION_VALUES=["normal","bold","100","200","300","400","500","600","700","800","900"];static MINIMUM_VALUE=1;static MAXIMUM_VALUE=1e3;constructor(){super(54,"fontWeight",to.fontWeight,{anyOf:[{type:"number",minimum:o.MINIMUM_VALUE,maximum:o.MAXIMUM_VALUE,errorMessage:p("fontWeightErrorMessage",'Only "normal" and "bold" keywords or numbers between 1 and 1000 are allowed.')},{type:"string",pattern:"^(normal|bold|1000|[1-9][0-9]{0,2})$"},{enum:o.SUGGESTION_VALUES}],default:to.fontWeight,description:p("fontWeight",'Controls the font weight. Accepts "normal" and "bold" keywords or numbers between 1 and 1000.')})}validate(e){return e==="normal"||e==="bold"?e:String(vt.clampedInt(e,to.fontWeight,o.MINIMUM_VALUE,o.MAXIMUM_VALUE))}},PE=class extends It{constructor(){let e={multiple:"peek",multipleDefinitions:"peek",multipleTypeDefinitions:"peek",multipleDeclarations:"peek",multipleImplementations:"peek",multipleReferences:"peek",multipleTests:"peek",alternativeDefinitionCommand:"editor.action.goToReferences",alternativeTypeDefinitionCommand:"editor.action.goToReferences",alternativeDeclarationCommand:"editor.action.goToReferences",alternativeImplementationCommand:"",alternativeReferenceCommand:"",alternativeTestsCommand:""},t={type:"string",enum:["peek","gotoAndPeek","goto"],default:e.multiple,enumDescriptions:[p("editor.gotoLocation.multiple.peek","Show Peek view of the results (default)"),p("editor.gotoLocation.multiple.gotoAndPeek","Go to the primary result and show a Peek view"),p("editor.gotoLocation.multiple.goto","Go to the primary result and enable Peek-less navigation to others")]},n=["","editor.action.referenceSearch.trigger","editor.action.goToReferences","editor.action.peekImplementation","editor.action.goToImplementation","editor.action.peekTypeDefinition","editor.action.goToTypeDefinition","editor.action.peekDeclaration","editor.action.revealDeclaration","editor.action.peekDefinition","editor.action.revealDefinitionAside","editor.action.revealDefinition"];super(59,"gotoLocation",e,{"editor.gotoLocation.multiple":{deprecationMessage:p("editor.gotoLocation.multiple.deprecated","This setting is deprecated, please use separate settings like 'editor.editor.gotoLocation.multipleDefinitions' or 'editor.editor.gotoLocation.multipleImplementations' instead.")},"editor.gotoLocation.multipleDefinitions":{description:p("editor.editor.gotoLocation.multipleDefinitions","Controls the behavior the 'Go to Definition'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleTypeDefinitions":{description:p("editor.editor.gotoLocation.multipleTypeDefinitions","Controls the behavior the 'Go to Type Definition'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleDeclarations":{description:p("editor.editor.gotoLocation.multipleDeclarations","Controls the behavior the 'Go to Declaration'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleImplementations":{description:p("editor.editor.gotoLocation.multipleImplemenattions","Controls the behavior the 'Go to Implementations'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleReferences":{description:p("editor.editor.gotoLocation.multipleReferences","Controls the behavior the 'Go to References'-command when multiple target locations exist."),...t},"editor.gotoLocation.alternativeDefinitionCommand":{type:"string",default:e.alternativeDefinitionCommand,enum:n,description:p("alternativeDefinitionCommand","Alternative command id that is being executed when the result of 'Go to Definition' is the current location.")},"editor.gotoLocation.alternativeTypeDefinitionCommand":{type:"string",default:e.alternativeTypeDefinitionCommand,enum:n,description:p("alternativeTypeDefinitionCommand","Alternative command id that is being executed when the result of 'Go to Type Definition' is the current location.")},"editor.gotoLocation.alternativeDeclarationCommand":{type:"string",default:e.alternativeDeclarationCommand,enum:n,description:p("alternativeDeclarationCommand","Alternative command id that is being executed when the result of 'Go to Declaration' is the current location.")},"editor.gotoLocation.alternativeImplementationCommand":{type:"string",default:e.alternativeImplementationCommand,enum:n,description:p("alternativeImplementationCommand","Alternative command id that is being executed when the result of 'Go to Implementation' is the current location.")},"editor.gotoLocation.alternativeReferenceCommand":{type:"string",default:e.alternativeReferenceCommand,enum:n,description:p("alternativeReferenceCommand","Alternative command id that is being executed when the result of 'Go to Reference' is the current location.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{multiple:Ut(t.multiple,this.defaultValue.multiple,["peek","gotoAndPeek","goto"]),multipleDefinitions:t.multipleDefinitions??Ut(t.multipleDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleTypeDefinitions:t.multipleTypeDefinitions??Ut(t.multipleTypeDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleDeclarations:t.multipleDeclarations??Ut(t.multipleDeclarations,"peek",["peek","gotoAndPeek","goto"]),multipleImplementations:t.multipleImplementations??Ut(t.multipleImplementations,"peek",["peek","gotoAndPeek","goto"]),multipleReferences:t.multipleReferences??Ut(t.multipleReferences,"peek",["peek","gotoAndPeek","goto"]),multipleTests:t.multipleTests??Ut(t.multipleTests,"peek",["peek","gotoAndPeek","goto"]),alternativeDefinitionCommand:gi.string(t.alternativeDefinitionCommand,this.defaultValue.alternativeDefinitionCommand),alternativeTypeDefinitionCommand:gi.string(t.alternativeTypeDefinitionCommand,this.defaultValue.alternativeTypeDefinitionCommand),alternativeDeclarationCommand:gi.string(t.alternativeDeclarationCommand,this.defaultValue.alternativeDeclarationCommand),alternativeImplementationCommand:gi.string(t.alternativeImplementationCommand,this.defaultValue.alternativeImplementationCommand),alternativeReferenceCommand:gi.string(t.alternativeReferenceCommand,this.defaultValue.alternativeReferenceCommand),alternativeTestsCommand:gi.string(t.alternativeTestsCommand,this.defaultValue.alternativeTestsCommand)}}},FE=class extends It{constructor(){let e={enabled:!0,delay:300,hidingDelay:300,sticky:!0,above:!0};super(61,"hover",e,{"editor.hover.enabled":{type:"boolean",default:e.enabled,description:p("hover.enabled","Controls whether the hover is shown.")},"editor.hover.delay":{type:"number",default:e.delay,minimum:0,maximum:1e4,description:p("hover.delay","Controls the delay in milliseconds after which the hover is shown.")},"editor.hover.sticky":{type:"boolean",default:e.sticky,description:p("hover.sticky","Controls whether the hover should remain visible when mouse is moved over it.")},"editor.hover.hidingDelay":{type:"integer",minimum:0,default:e.hidingDelay,description:p("hover.hidingDelay","Controls the delay in milliseconds after which the hover is hidden. Requires `editor.hover.sticky` to be enabled.")},"editor.hover.above":{type:"boolean",default:e.above,description:p("hover.above","Prefer showing hovers above the line, if there's space.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:Ee(t.enabled,this.defaultValue.enabled),delay:vt.clampedInt(t.delay,this.defaultValue.delay,0,1e4),sticky:Ee(t.sticky,this.defaultValue.sticky),hidingDelay:vt.clampedInt(t.hidingDelay,this.defaultValue.hidingDelay,0,6e5),above:Ee(t.above,this.defaultValue.above)}}};var Cm=class o extends _d{constructor(){super(147)}compute(e,t,n){return o.computeLayout(t,{memory:e.memory,outerWidth:e.outerWidth,outerHeight:e.outerHeight,isDominatedByLongLines:e.isDominatedByLongLines,lineHeight:e.fontInfo.lineHeight,viewLineCount:e.viewLineCount,lineNumbersDigitCount:e.lineNumbersDigitCount,typicalHalfwidthCharacterWidth:e.fontInfo.typicalHalfwidthCharacterWidth,maxDigitWidth:e.fontInfo.maxDigitWidth,pixelRatio:e.pixelRatio,glyphMarginDecorationLaneCount:e.glyphMarginDecorationLaneCount})}static computeContainedMinimapLineCount(e){let t=e.height/e.lineHeight,n=Math.floor(e.paddingTop/e.lineHeight),i=Math.floor(e.paddingBottom/e.lineHeight);e.scrollBeyondLastLine&&(i=Math.max(i,t-1));let r=(n+e.viewLineCount+i)/(e.pixelRatio*e.height),s=Math.floor(e.viewLineCount/r);return{typicalViewportLineCount:t,extraLinesBeforeFirstLine:n,extraLinesBeyondLastLine:i,desiredRatio:r,minimapLineCount:s}}static _computeMinimapLayout(e,t){let n=e.outerWidth,i=e.outerHeight,r=e.pixelRatio;if(!e.minimap.enabled)return{renderMinimap:0,minimapLeft:0,minimapWidth:0,minimapHeightIsEditorHeight:!1,minimapIsSampling:!1,minimapScale:1,minimapLineHeight:1,minimapCanvasInnerWidth:0,minimapCanvasInnerHeight:Math.floor(r*i),minimapCanvasOuterWidth:0,minimapCanvasOuterHeight:i};let s=t.stableMinimapLayoutInput,a=s&&e.outerHeight===s.outerHeight&&e.lineHeight===s.lineHeight&&e.typicalHalfwidthCharacterWidth===s.typicalHalfwidthCharacterWidth&&e.pixelRatio===s.pixelRatio&&e.scrollBeyondLastLine===s.scrollBeyondLastLine&&e.paddingTop===s.paddingTop&&e.paddingBottom===s.paddingBottom&&e.minimap.enabled===s.minimap.enabled&&e.minimap.side===s.minimap.side&&e.minimap.size===s.minimap.size&&e.minimap.showSlider===s.minimap.showSlider&&e.minimap.renderCharacters===s.minimap.renderCharacters&&e.minimap.maxColumn===s.minimap.maxColumn&&e.minimap.scale===s.minimap.scale&&e.verticalScrollbarWidth===s.verticalScrollbarWidth&&e.isViewportWrapping===s.isViewportWrapping,l=e.lineHeight,d=e.typicalHalfwidthCharacterWidth,c=e.scrollBeyondLastLine,u=e.minimap.renderCharacters,h=r>=2?Math.round(e.minimap.scale*2):e.minimap.scale,m=e.minimap.maxColumn,f=e.minimap.size,g=e.minimap.side,b=e.verticalScrollbarWidth,y=e.viewLineCount,C=e.remainingWidth,x=e.isViewportWrapping,L=u?2:3,k=Math.floor(r*i),O=k/r,W=!1,z=!1,B=L*h,G=h/r,q=1;if(f==="fill"||f==="fit"){let{typicalViewportLineCount:ne,extraLinesBeforeFirstLine:Q,extraLinesBeyondLastLine:we,desiredRatio:xe,minimapLineCount:st}=o.computeContainedMinimapLineCount({viewLineCount:y,scrollBeyondLastLine:c,paddingTop:e.paddingTop,paddingBottom:e.paddingBottom,height:i,lineHeight:l,pixelRatio:r});if(y/st>1)W=!0,z=!0,h=1,B=1,G=h/r;else{let ke=!1,$n=h+1;if(f==="fit"){let xn=Math.ceil((Q+y+we)*B);x&&a&&C<=t.stableFitRemainingWidth?(ke=!0,$n=t.stableFitMaxMinimapScale):ke=xn>k}if(f==="fill"||ke){W=!0;let xn=h;B=Math.min(l*r,Math.max(1,Math.floor(1/xe))),x&&a&&C<=t.stableFitRemainingWidth&&($n=t.stableFitMaxMinimapScale),h=Math.min($n,Math.max(1,Math.floor(B/L))),h>xn&&(q=Math.min(2,h/xn)),G=h/r/q,k=Math.ceil(Math.max(ne,Q+y+we)*B),x?(t.stableMinimapLayoutInput=e,t.stableFitRemainingWidth=C,t.stableFitMaxMinimapScale=h):(t.stableMinimapLayoutInput=null,t.stableFitRemainingWidth=0)}}}let X=Math.floor(m*G),ce=Math.min(X,Math.max(0,Math.floor((C-b-2)*G/(d+G)))+Dr),Ce=Math.floor(r*ce),te=Ce/r;Ce=Math.floor(Ce*q);let Z=u?1:2,le=g==="left"?0:n-ce-b;return{renderMinimap:Z,minimapLeft:le,minimapWidth:ce,minimapHeightIsEditorHeight:W,minimapIsSampling:z,minimapScale:h,minimapLineHeight:B,minimapCanvasInnerWidth:Ce,minimapCanvasInnerHeight:k,minimapCanvasOuterWidth:te,minimapCanvasOuterHeight:O}}static computeLayout(e,t){let n=t.outerWidth|0,i=t.outerHeight|0,r=t.lineHeight|0,s=t.lineNumbersDigitCount|0,a=t.typicalHalfwidthCharacterWidth,l=t.maxDigitWidth,d=t.pixelRatio,c=t.viewLineCount,u=e.get(139),h=u==="inherit"?e.get(138):u,m=h==="inherit"?e.get(134):h,f=e.get(137),g=t.isDominatedByLongLines,b=e.get(58),y=e.get(69).renderType!==0,C=e.get(70),x=e.get(107),L=e.get(85),k=e.get(74),O=e.get(105),W=O.verticalScrollbarSize,z=O.verticalHasArrows,B=O.arrowSize,G=O.horizontalScrollbarSize,q=e.get(44),X=e.get(112)!=="never",ce=e.get(67);q&&X&&(ce+=16);let Ce=0;if(y){let po=Math.max(s,C);Ce=Math.round(po*l)}let te=0;b&&(te=r*t.glyphMarginDecorationLaneCount);let Z=0,le=Z+te,ne=le+Ce,Q=ne+ce,we=n-te-Ce-ce,xe=!1,st=!1,Xe=-1;h==="inherit"&&g?(xe=!0,st=!0):m==="on"||m==="bounded"?st=!0:m==="wordWrapColumn"&&(Xe=f);let ke=o._computeMinimapLayout({outerWidth:n,outerHeight:i,lineHeight:r,typicalHalfwidthCharacterWidth:a,pixelRatio:d,scrollBeyondLastLine:x,paddingTop:L.top,paddingBottom:L.bottom,minimap:k,verticalScrollbarWidth:W,viewLineCount:c,remainingWidth:we,isViewportWrapping:st},t.memory||new Im);ke.renderMinimap!==0&&ke.minimapLeft===0&&(Z+=ke.minimapWidth,le+=ke.minimapWidth,ne+=ke.minimapWidth,Q+=ke.minimapWidth);let $n=we-ke.minimapWidth,xn=Math.max(1,Math.floor(($n-W-2)/a)),ji=z?B:0;return st&&(Xe=Math.max(1,xn),m==="bounded"&&(Xe=Math.min(Xe,f))),{width:n,height:i,glyphMarginLeft:Z,glyphMarginWidth:te,glyphMarginDecorationLaneCount:t.glyphMarginDecorationLaneCount,lineNumbersLeft:le,lineNumbersWidth:Ce,decorationsLeft:ne,decorationsWidth:ce,contentLeft:Q,contentWidth:$n,minimap:ke,viewportColumn:xn,isWordWrapMinified:xe,isViewportWrapping:st,wrappingColumn:Xe,verticalScrollbarWidth:W,horizontalScrollbarHeight:G,overviewRuler:{top:ji,width:W,height:i-2*ji,right:0}}}},BE=class extends It{constructor(){super(141,"wrappingStrategy","simple",{"editor.wrappingStrategy":{enumDescriptions:[p("wrappingStrategy.simple","Assumes that all characters are of the same width. This is a fast algorithm that works correctly for monospace fonts and certain scripts (like Latin characters) where glyphs are of equal width."),p("wrappingStrategy.advanced","Delegates wrapping points computation to the browser. This is a slow algorithm, that might cause freezes for large files, but it works correctly in all cases.")],type:"string",enum:["simple","advanced"],default:"simple",description:p("wrappingStrategy","Controls the algorithm that computes wrapping points. Note that when in accessibility mode, advanced will be used for the best experience.")}})}validate(e){return Ut(e,"simple",["simple","advanced"])}compute(e,t,n){return t.get(2)===2?"advanced":n}};var VE=class extends It{constructor(){let e={enabled:"onCode"};super(66,"lightbulb",e,{"editor.lightbulb.enabled":{type:"string",tags:["experimental"],enum:["off","onCode","on"],default:e.enabled,enumDescriptions:[p("editor.lightbulb.enabled.off","Disable the code action menu."),p("editor.lightbulb.enabled.onCode","Show the code action menu when the cursor is on lines with code."),p("editor.lightbulb.enabled.on","Show the code action menu when the cursor is on lines with code or on empty lines.")],description:p("enabled","Enables the Code Action lightbulb in the editor.")}})}validate(e){return!e||typeof e!="object"?this.defaultValue:{enabled:Ut(e.enabled,this.defaultValue.enabled,["off","onCode","on"])}}},WE=class extends It{constructor(){let e={enabled:!0,maxLineCount:5,defaultModel:"outlineModel",scrollWithEditor:!0};super(117,"stickyScroll",e,{"editor.stickyScroll.enabled":{type:"boolean",default:e.enabled,description:p("editor.stickyScroll.enabled","Shows the nested current scopes during the scroll at the top of the editor."),tags:["experimental"]},"editor.stickyScroll.maxLineCount":{type:"number",default:e.maxLineCount,minimum:1,maximum:20,description:p("editor.stickyScroll.maxLineCount","Defines the maximum number of sticky lines to show.")},"editor.stickyScroll.defaultModel":{type:"string",enum:["outlineModel","foldingProviderModel","indentationModel"],default:e.defaultModel,description:p("editor.stickyScroll.defaultModel","Defines the model to use for determining which lines to stick. If the outline model does not exist, it will fall back on the folding provider model which falls back on the indentation model. This order is respected in all three cases.")},"editor.stickyScroll.scrollWithEditor":{type:"boolean",default:e.scrollWithEditor,description:p("editor.stickyScroll.scrollWithEditor","Enable scrolling of Sticky Scroll with the editor's horizontal scrollbar.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:Ee(t.enabled,this.defaultValue.enabled),maxLineCount:vt.clampedInt(t.maxLineCount,this.defaultValue.maxLineCount,1,20),defaultModel:Ut(t.defaultModel,this.defaultValue.defaultModel,["outlineModel","foldingProviderModel","indentationModel"]),scrollWithEditor:Ee(t.scrollWithEditor,this.defaultValue.scrollWithEditor)}}},HE=class extends It{constructor(){let e={enabled:"on",fontSize:0,fontFamily:"",padding:!1,maximumLength:43};super(143,"inlayHints",e,{"editor.inlayHints.enabled":{type:"string",default:e.enabled,description:p("inlayHints.enable","Enables the inlay hints in the editor."),enum:["on","onUnlessPressed","offUnlessPressed","off"],markdownEnumDescriptions:[p("editor.inlayHints.on","Inlay hints are enabled"),p("editor.inlayHints.onUnlessPressed","Inlay hints are showing by default and hide when holding {0}",Be?"Ctrl+Option":"Ctrl+Alt"),p("editor.inlayHints.offUnlessPressed","Inlay hints are hidden by default and show when holding {0}",Be?"Ctrl+Option":"Ctrl+Alt"),p("editor.inlayHints.off","Inlay hints are disabled")]},"editor.inlayHints.fontSize":{type:"number",default:e.fontSize,markdownDescription:p("inlayHints.fontSize","Controls font size of inlay hints in the editor. As default the {0} is used when the configured value is less than {1} or greater than the editor font size.","`#editor.fontSize#`","`5`")},"editor.inlayHints.fontFamily":{type:"string",default:e.fontFamily,markdownDescription:p("inlayHints.fontFamily","Controls font family of inlay hints in the editor. When set to empty, the {0} is used.","`#editor.fontFamily#`")},"editor.inlayHints.padding":{type:"boolean",default:e.padding,description:p("inlayHints.padding","Enables the padding around the inlay hints in the editor.")},"editor.inlayHints.maximumLength":{type:"number",default:e.maximumLength,markdownDescription:p("inlayHints.maximumLength","Maximum overall length of inlay hints, for a single line, before they get truncated by the editor. Set to `0` to never truncate")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return typeof t.enabled=="boolean"&&(t.enabled=t.enabled?"on":"off"),{enabled:Ut(t.enabled,this.defaultValue.enabled,["on","off","offUnlessPressed","onUnlessPressed"]),fontSize:vt.clampedInt(t.fontSize,this.defaultValue.fontSize,0,100),fontFamily:gi.string(t.fontFamily,this.defaultValue.fontFamily),padding:Ee(t.padding,this.defaultValue.padding),maximumLength:vt.clampedInt(t.maximumLength,this.defaultValue.maximumLength,0,Number.MAX_SAFE_INTEGER)}}},UE=class extends It{constructor(){super(67,"lineDecorationsWidth",10)}validate(e){return typeof e=="string"&&/^\d+(\.\d+)?ch$/.test(e)?-parseFloat(e.substring(0,e.length-2)):vt.clampedInt(e,this.defaultValue,0,1e3)}compute(e,t,n){return n<0?vt.clampedInt(-n*e.fontInfo.typicalHalfwidthCharacterWidth,this.defaultValue,0,1e3):n}},zE=class extends tr{constructor(){super(68,"lineHeight",to.lineHeight,e=>tr.clamp(e,0,150),{markdownDescription:p("lineHeight",`Controls the line height. 
 - Use 0 to automatically compute the line height from the font size.
 - Values between 0 and 8 will be used as a multiplier with the font size.
 - Values greater than or equal to 8 will be used as effective values.`)})}compute(e,t,n){return e.fontInfo.lineHeight}},KE=class extends It{constructor(){let e={enabled:!0,size:"proportional",side:"right",showSlider:"mouseover",autohide:!1,renderCharacters:!0,maxColumn:120,scale:1,showRegionSectionHeaders:!0,showMarkSectionHeaders:!0,sectionHeaderFontSize:9,sectionHeaderLetterSpacing:1};super(74,"minimap",e,{"editor.minimap.enabled":{type:"boolean",default:e.enabled,description:p("minimap.enabled","Controls whether the minimap is shown.")},"editor.minimap.autohide":{type:"boolean",default:e.autohide,description:p("minimap.autohide","Controls whether the minimap is hidden automatically.")},"editor.minimap.size":{type:"string",enum:["proportional","fill","fit"],enumDescriptions:[p("minimap.size.proportional","The minimap has the same size as the editor contents (and might scroll)."),p("minimap.size.fill","The minimap will stretch or shrink as necessary to fill the height of the editor (no scrolling)."),p("minimap.size.fit","The minimap will shrink as necessary to never be larger than the editor (no scrolling).")],default:e.size,description:p("minimap.size","Controls the size of the minimap.")},"editor.minimap.side":{type:"string",enum:["left","right"],default:e.side,description:p("minimap.side","Controls the side where to render the minimap.")},"editor.minimap.showSlider":{type:"string",enum:["always","mouseover"],default:e.showSlider,description:p("minimap.showSlider","Controls when the minimap slider is shown.")},"editor.minimap.scale":{type:"number",default:e.scale,minimum:1,maximum:3,enum:[1,2,3],description:p("minimap.scale","Scale of content drawn in the minimap: 1, 2 or 3.")},"editor.minimap.renderCharacters":{type:"boolean",default:e.renderCharacters,description:p("minimap.renderCharacters","Render the actual characters on a line as opposed to color blocks.")},"editor.minimap.maxColumn":{type:"number",default:e.maxColumn,description:p("minimap.maxColumn","Limit the width of the minimap to render at most a certain number of columns.")},"editor.minimap.showRegionSectionHeaders":{type:"boolean",default:e.showRegionSectionHeaders,description:p("minimap.showRegionSectionHeaders","Controls whether named regions are shown as section headers in the minimap.")},"editor.minimap.showMarkSectionHeaders":{type:"boolean",default:e.showMarkSectionHeaders,description:p("minimap.showMarkSectionHeaders","Controls whether MARK: comments are shown as section headers in the minimap.")},"editor.minimap.sectionHeaderFontSize":{type:"number",default:e.sectionHeaderFontSize,description:p("minimap.sectionHeaderFontSize","Controls the font size of section headers in the minimap.")},"editor.minimap.sectionHeaderLetterSpacing":{type:"number",default:e.sectionHeaderLetterSpacing,description:p("minimap.sectionHeaderLetterSpacing","Controls the amount of space (in pixels) between characters of section header. This helps the readability of the header in small font sizes.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:Ee(t.enabled,this.defaultValue.enabled),autohide:Ee(t.autohide,this.defaultValue.autohide),size:Ut(t.size,this.defaultValue.size,["proportional","fill","fit"]),side:Ut(t.side,this.defaultValue.side,["right","left"]),showSlider:Ut(t.showSlider,this.defaultValue.showSlider,["always","mouseover"]),renderCharacters:Ee(t.renderCharacters,this.defaultValue.renderCharacters),scale:vt.clampedInt(t.scale,1,1,3),maxColumn:vt.clampedInt(t.maxColumn,this.defaultValue.maxColumn,1,1e4),showRegionSectionHeaders:Ee(t.showRegionSectionHeaders,this.defaultValue.showRegionSectionHeaders),showMarkSectionHeaders:Ee(t.showMarkSectionHeaders,this.defaultValue.showMarkSectionHeaders),sectionHeaderFontSize:tr.clamp(t.sectionHeaderFontSize??this.defaultValue.sectionHeaderFontSize,4,32),sectionHeaderLetterSpacing:tr.clamp(t.sectionHeaderLetterSpacing??this.defaultValue.sectionHeaderLetterSpacing,0,5)}}};function _W(o){return o==="ctrlCmd"?Be?"metaKey":"ctrlKey":"altKey"}var GE=class extends It{constructor(){super(85,"padding",{top:0,bottom:0},{"editor.padding.top":{type:"number",default:0,minimum:0,maximum:1e3,description:p("padding.top","Controls the amount of space between the top edge of the editor and the first line.")},"editor.padding.bottom":{type:"number",default:0,minimum:0,maximum:1e3,description:p("padding.bottom","Controls the amount of space between the bottom edge of the editor and the last line.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{top:vt.clampedInt(t.top,0,0,1e3),bottom:vt.clampedInt(t.bottom,0,0,1e3)}}},jE=class extends It{constructor(){let e={enabled:!0,cycle:!0};super(87,"parameterHints",e,{"editor.parameterHints.enabled":{type:"boolean",default:e.enabled,description:p("parameterHints.enabled","Enables a pop-up that shows parameter documentation and type information as you type.")},"editor.parameterHints.cycle":{type:"boolean",default:e.cycle,description:p("parameterHints.cycle","Controls whether the parameter hints menu cycles or closes when reaching the end of the list.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:Ee(t.enabled,this.defaultValue.enabled),cycle:Ee(t.cycle,this.defaultValue.cycle)}}},$E=class extends _d{constructor(){super(145)}compute(e,t,n){return e.pixelRatio}},qE=class extends It{constructor(){super(89,"placeholder",void 0)}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e:this.defaultValue}},YE=class extends It{defaultValue;constructor(){let e={other:"on",comments:"off",strings:"off"},t=[{type:"boolean"},{type:"string",enum:["on","inline","off"],enumDescriptions:[p("on","Quick suggestions show inside the suggest widget"),p("inline","Quick suggestions show as ghost text"),p("off","Quick suggestions are disabled")]}];super(91,"quickSuggestions",e,{type:"object",additionalProperties:!1,properties:{strings:{anyOf:t,default:e.strings,description:p("quickSuggestions.strings","Enable quick suggestions inside strings.")},comments:{anyOf:t,default:e.comments,description:p("quickSuggestions.comments","Enable quick suggestions inside comments.")},other:{anyOf:t,default:e.other,description:p("quickSuggestions.other","Enable quick suggestions outside of strings and comments.")}},default:e,markdownDescription:p("quickSuggestions","Controls whether suggestions should automatically show up while typing. This can be controlled for typing in comments, strings, and other code. Quick suggestion can be configured to show as ghost text or with the suggest widget. Also be aware of the {0}-setting which controls if suggestions are triggered by special characters.","`#editor.suggestOnTriggerCharacters#`")}),this.defaultValue=e}validate(e){if(typeof e=="boolean"){let d=e?"on":"off";return{comments:d,strings:d,other:d}}if(!e||typeof e!="object")return this.defaultValue;let{other:t,comments:n,strings:i}=e,r=["on","inline","off"],s,a,l;return typeof t=="boolean"?s=t?"on":"off":s=Ut(t,this.defaultValue.other,r),typeof n=="boolean"?a=n?"on":"off":a=Ut(n,this.defaultValue.comments,r),typeof i=="boolean"?l=i?"on":"off":l=Ut(i,this.defaultValue.strings,r),{other:s,comments:a,strings:l}}};var ZE=class extends It{constructor(){super(69,"lineNumbers",{renderType:1,renderFn:null},{type:"string",enum:["off","on","relative","interval"],enumDescriptions:[p("lineNumbers.off","Line numbers are not rendered."),p("lineNumbers.on","Line numbers are rendered as absolute number."),p("lineNumbers.relative","Line numbers are rendered as distance in lines to cursor position."),p("lineNumbers.interval","Line numbers are rendered every 10 lines.")],default:"on",description:p("lineNumbers","Controls the display of line numbers.")})}validate(e){let t=this.defaultValue.renderType,n=this.defaultValue.renderFn;return typeof e<"u"&&(typeof e=="function"?(t=4,n=e):e==="interval"?t=3:e==="relative"?t=2:e==="on"?t=1:t=0),{renderType:t,renderFn:n}}};function Ld(o){let e=o.get(100);return e==="editable"?o.get(93):e!=="on"}var XE=class extends It{constructor(){let e=[],t={type:"number",description:p("rulers.size","Number of monospace characters at which this editor ruler will render.")};super(104,"rulers",e,{type:"array",items:{anyOf:[t,{type:["object"],properties:{column:t,color:{type:"string",description:p("rulers.color","Color of this editor ruler."),format:"color-hex"}}}]},default:e,description:p("rulers","Render vertical rulers after a certain number of monospace characters. Use multiple values for multiple rulers. No rulers are drawn if array is empty.")})}validate(e){if(Array.isArray(e)){let t=[];for(let n of e)if(typeof n=="number")t.push({column:vt.clampedInt(n,0,0,1e4),color:null});else if(n&&typeof n=="object"){let i=n;t.push({column:vt.clampedInt(i.column,0,0,1e4),color:i.color})}return t.sort((n,i)=>n.column-i.column),t}return this.defaultValue}},QE=class extends It{constructor(){super(94,"readOnlyMessage",void 0)}validate(e){return!e||typeof e!="object"?this.defaultValue:e}};function rM(o,e){if(typeof o!="string")return e;switch(o){case"hidden":return 2;case"visible":return 3;default:return 1}}var JE=class extends It{constructor(){let e={vertical:1,horizontal:1,arrowSize:11,useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,horizontalScrollbarSize:12,horizontalSliderSize:12,verticalScrollbarSize:14,verticalSliderSize:14,handleMouseWheel:!0,alwaysConsumeMouseWheel:!0,scrollByPage:!1,ignoreHorizontalScrollbarInContentHeight:!1};super(105,"scrollbar",e,{"editor.scrollbar.vertical":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[p("scrollbar.vertical.auto","The vertical scrollbar will be visible only when necessary."),p("scrollbar.vertical.visible","The vertical scrollbar will always be visible."),p("scrollbar.vertical.fit","The vertical scrollbar will always be hidden.")],default:"auto",description:p("scrollbar.vertical","Controls the visibility of the vertical scrollbar.")},"editor.scrollbar.horizontal":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[p("scrollbar.horizontal.auto","The horizontal scrollbar will be visible only when necessary."),p("scrollbar.horizontal.visible","The horizontal scrollbar will always be visible."),p("scrollbar.horizontal.fit","The horizontal scrollbar will always be hidden.")],default:"auto",description:p("scrollbar.horizontal","Controls the visibility of the horizontal scrollbar.")},"editor.scrollbar.verticalScrollbarSize":{type:"number",default:e.verticalScrollbarSize,description:p("scrollbar.verticalScrollbarSize","The width of the vertical scrollbar.")},"editor.scrollbar.horizontalScrollbarSize":{type:"number",default:e.horizontalScrollbarSize,description:p("scrollbar.horizontalScrollbarSize","The height of the horizontal scrollbar.")},"editor.scrollbar.scrollByPage":{type:"boolean",default:e.scrollByPage,description:p("scrollbar.scrollByPage","Controls whether clicks scroll by page or jump to click position.")},"editor.scrollbar.ignoreHorizontalScrollbarInContentHeight":{type:"boolean",default:e.ignoreHorizontalScrollbarInContentHeight,description:p("scrollbar.ignoreHorizontalScrollbarInContentHeight","When set, the horizontal scrollbar will not increase the size of the editor's content.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e,n=vt.clampedInt(t.horizontalScrollbarSize,this.defaultValue.horizontalScrollbarSize,0,1e3),i=vt.clampedInt(t.verticalScrollbarSize,this.defaultValue.verticalScrollbarSize,0,1e3);return{arrowSize:vt.clampedInt(t.arrowSize,this.defaultValue.arrowSize,0,1e3),vertical:rM(t.vertical,this.defaultValue.vertical),horizontal:rM(t.horizontal,this.defaultValue.horizontal),useShadows:Ee(t.useShadows,this.defaultValue.useShadows),verticalHasArrows:Ee(t.verticalHasArrows,this.defaultValue.verticalHasArrows),horizontalHasArrows:Ee(t.horizontalHasArrows,this.defaultValue.horizontalHasArrows),handleMouseWheel:Ee(t.handleMouseWheel,this.defaultValue.handleMouseWheel),alwaysConsumeMouseWheel:Ee(t.alwaysConsumeMouseWheel,this.defaultValue.alwaysConsumeMouseWheel),horizontalScrollbarSize:n,horizontalSliderSize:vt.clampedInt(t.horizontalSliderSize,n,0,1e3),verticalScrollbarSize:i,verticalSliderSize:vt.clampedInt(t.verticalSliderSize,i,0,1e3),scrollByPage:Ee(t.scrollByPage,this.defaultValue.scrollByPage),ignoreHorizontalScrollbarInContentHeight:Ee(t.ignoreHorizontalScrollbarInContentHeight,this.defaultValue.ignoreHorizontalScrollbarInContentHeight)}}},Lr="inUntrustedWorkspace",Ed={allowedCharacters:"editor.unicodeHighlight.allowedCharacters",invisibleCharacters:"editor.unicodeHighlight.invisibleCharacters",nonBasicASCII:"editor.unicodeHighlight.nonBasicASCII",ambiguousCharacters:"editor.unicodeHighlight.ambiguousCharacters",includeComments:"editor.unicodeHighlight.includeComments",includeStrings:"editor.unicodeHighlight.includeStrings",allowedLocales:"editor.unicodeHighlight.allowedLocales"},e_=class extends It{constructor(){let e={nonBasicASCII:Lr,invisibleCharacters:!0,ambiguousCharacters:!0,includeComments:Lr,includeStrings:!0,allowedCharacters:{},allowedLocales:{_os:!0,_vscode:!0}};super(127,"unicodeHighlight",e,{[Ed.nonBasicASCII]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,Lr],default:e.nonBasicASCII,description:p("unicodeHighlight.nonBasicASCII","Controls whether all non-basic ASCII characters are highlighted. Only characters between U+0020 and U+007E, tab, line-feed and carriage-return are considered basic ASCII.")},[Ed.invisibleCharacters]:{restricted:!0,type:"boolean",default:e.invisibleCharacters,description:p("unicodeHighlight.invisibleCharacters","Controls whether characters that just reserve space or have no width at all are highlighted.")},[Ed.ambiguousCharacters]:{restricted:!0,type:"boolean",default:e.ambiguousCharacters,description:p("unicodeHighlight.ambiguousCharacters","Controls whether characters are highlighted that can be confused with basic ASCII characters, except those that are common in the current user locale.")},[Ed.includeComments]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,Lr],default:e.includeComments,description:p("unicodeHighlight.includeComments","Controls whether characters in comments should also be subject to Unicode highlighting.")},[Ed.includeStrings]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,Lr],default:e.includeStrings,description:p("unicodeHighlight.includeStrings","Controls whether characters in strings should also be subject to Unicode highlighting.")},[Ed.allowedCharacters]:{restricted:!0,type:"object",default:e.allowedCharacters,description:p("unicodeHighlight.allowedCharacters","Defines allowed characters that are not being highlighted."),additionalProperties:{type:"boolean"}},[Ed.allowedLocales]:{restricted:!0,type:"object",additionalProperties:{type:"boolean"},default:e.allowedLocales,description:p("unicodeHighlight.allowedLocales","Unicode characters that are common in allowed locales are not being highlighted.")}})}applyUpdate(e,t){let n=!1;t.allowedCharacters&&e&&(Zn(e.allowedCharacters,t.allowedCharacters)||(e={...e,allowedCharacters:t.allowedCharacters},n=!0)),t.allowedLocales&&e&&(Zn(e.allowedLocales,t.allowedLocales)||(e={...e,allowedLocales:t.allowedLocales},n=!0));let i=super.applyUpdate(e,t);return n?new du(i.newValue,!0):i}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{nonBasicASCII:cu(t.nonBasicASCII,Lr,[!0,!1,Lr]),invisibleCharacters:Ee(t.invisibleCharacters,this.defaultValue.invisibleCharacters),ambiguousCharacters:Ee(t.ambiguousCharacters,this.defaultValue.ambiguousCharacters),includeComments:cu(t.includeComments,Lr,[!0,!1,Lr]),includeStrings:cu(t.includeStrings,Lr,[!0,!1,Lr]),allowedCharacters:this.validateBooleanMap(e.allowedCharacters,this.defaultValue.allowedCharacters),allowedLocales:this.validateBooleanMap(e.allowedLocales,this.defaultValue.allowedLocales)}}validateBooleanMap(e,t){if(typeof e!="object"||!e)return t;let n={};for(let[i,r]of Object.entries(e))r===!0&&(n[i]=!0);return n}},t_=class extends It{constructor(){let e={enabled:!0,mode:"subwordSmart",showToolbar:"onHover",suppressSuggestions:!1,keepOnBlur:!1,fontFamily:"default",syntaxHighlightingEnabled:!1};super(63,"inlineSuggest",e,{"editor.inlineSuggest.enabled":{type:"boolean",default:e.enabled,description:p("inlineSuggest.enabled","Controls whether to automatically show inline suggestions in the editor.")},"editor.inlineSuggest.showToolbar":{type:"string",default:e.showToolbar,enum:["always","onHover","never"],enumDescriptions:[p("inlineSuggest.showToolbar.always","Show the inline suggestion toolbar whenever an inline suggestion is shown."),p("inlineSuggest.showToolbar.onHover","Show the inline suggestion toolbar when hovering over an inline suggestion."),p("inlineSuggest.showToolbar.never","Never show the inline suggestion toolbar.")],description:p("inlineSuggest.showToolbar","Controls when to show the inline suggestion toolbar.")},"editor.inlineSuggest.syntaxHighlightingEnabled":{type:"boolean",default:e.syntaxHighlightingEnabled,description:p("inlineSuggest.syntaxHighlightingEnabled","Controls whether to show syntax highlighting for inline suggestions in the editor.")},"editor.inlineSuggest.suppressSuggestions":{type:"boolean",default:e.suppressSuggestions,description:p("inlineSuggest.suppressSuggestions","Controls how inline suggestions interact with the suggest widget. If enabled, the suggest widget is not shown automatically when inline suggestions are available.")},"editor.inlineSuggest.fontFamily":{type:"string",default:e.fontFamily,description:p("inlineSuggest.fontFamily","Controls the font family of the inline suggestions.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:Ee(t.enabled,this.defaultValue.enabled),mode:Ut(t.mode,this.defaultValue.mode,["prefix","subword","subwordSmart"]),showToolbar:Ut(t.showToolbar,this.defaultValue.showToolbar,["always","onHover","never"]),suppressSuggestions:Ee(t.suppressSuggestions,this.defaultValue.suppressSuggestions),keepOnBlur:Ee(t.keepOnBlur,this.defaultValue.keepOnBlur),fontFamily:gi.string(t.fontFamily,this.defaultValue.fontFamily),syntaxHighlightingEnabled:Ee(t.syntaxHighlightingEnabled,this.defaultValue.syntaxHighlightingEnabled)}}},n_=class extends It{constructor(){let e={enabled:!1,showToolbar:"onHover",fontFamily:"default",keepOnBlur:!1};super(64,"experimentalInlineEdit",e,{"editor.experimentalInlineEdit.enabled":{type:"boolean",default:e.enabled,description:p("inlineEdit.enabled","Controls whether to show inline edits in the editor.")},"editor.experimentalInlineEdit.showToolbar":{type:"string",default:e.showToolbar,enum:["always","onHover","never"],enumDescriptions:[p("inlineEdit.showToolbar.always","Show the inline edit toolbar whenever an inline suggestion is shown."),p("inlineEdit.showToolbar.onHover","Show the inline edit toolbar when hovering over an inline suggestion."),p("inlineEdit.showToolbar.never","Never show the inline edit toolbar.")],description:p("inlineEdit.showToolbar","Controls when to show the inline edit toolbar.")},"editor.experimentalInlineEdit.fontFamily":{type:"string",default:e.fontFamily,description:p("inlineEdit.fontFamily","Controls the font family of the inline edit.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:Ee(t.enabled,this.defaultValue.enabled),showToolbar:Ut(t.showToolbar,this.defaultValue.showToolbar,["always","onHover","never"]),fontFamily:gi.string(t.fontFamily,this.defaultValue.fontFamily),keepOnBlur:Ee(t.keepOnBlur,this.defaultValue.keepOnBlur)}}},i_=class extends It{constructor(){let e={enabled:gs.bracketPairColorizationOptions.enabled,independentColorPoolPerBracketType:gs.bracketPairColorizationOptions.independentColorPoolPerBracketType};super(15,"bracketPairColorization",e,{"editor.bracketPairColorization.enabled":{type:"boolean",default:e.enabled,markdownDescription:p("bracketPairColorization.enabled","Controls whether bracket pair colorization is enabled or not. Use {0} to override the bracket highlight colors.","`#workbench.colorCustomizations#`")},"editor.bracketPairColorization.independentColorPoolPerBracketType":{type:"boolean",default:e.independentColorPoolPerBracketType,description:p("bracketPairColorization.independentColorPoolPerBracketType","Controls whether each bracket type has its own independent color pool.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:Ee(t.enabled,this.defaultValue.enabled),independentColorPoolPerBracketType:Ee(t.independentColorPoolPerBracketType,this.defaultValue.independentColorPoolPerBracketType)}}},o_=class extends It{constructor(){let e={bracketPairs:!1,bracketPairsHorizontal:"active",highlightActiveBracketPair:!0,indentation:!0,highlightActiveIndentation:!0};super(16,"guides",e,{"editor.guides.bracketPairs":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[p("editor.guides.bracketPairs.true","Enables bracket pair guides."),p("editor.guides.bracketPairs.active","Enables bracket pair guides only for the active bracket pair."),p("editor.guides.bracketPairs.false","Disables bracket pair guides.")],default:e.bracketPairs,description:p("editor.guides.bracketPairs","Controls whether bracket pair guides are enabled or not.")},"editor.guides.bracketPairsHorizontal":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[p("editor.guides.bracketPairsHorizontal.true","Enables horizontal guides as addition to vertical bracket pair guides."),p("editor.guides.bracketPairsHorizontal.active","Enables horizontal guides only for the active bracket pair."),p("editor.guides.bracketPairsHorizontal.false","Disables horizontal bracket pair guides.")],default:e.bracketPairsHorizontal,description:p("editor.guides.bracketPairsHorizontal","Controls whether horizontal bracket pair guides are enabled or not.")},"editor.guides.highlightActiveBracketPair":{type:"boolean",default:e.highlightActiveBracketPair,description:p("editor.guides.highlightActiveBracketPair","Controls whether the editor should highlight the active bracket pair.")},"editor.guides.indentation":{type:"boolean",default:e.indentation,description:p("editor.guides.indentation","Controls whether the editor should render indent guides.")},"editor.guides.highlightActiveIndentation":{type:["boolean","string"],enum:[!0,"always",!1],enumDescriptions:[p("editor.guides.highlightActiveIndentation.true","Highlights the active indent guide."),p("editor.guides.highlightActiveIndentation.always","Highlights the active indent guide even if bracket guides are highlighted."),p("editor.guides.highlightActiveIndentation.false","Do not highlight the active indent guide.")],default:e.highlightActiveIndentation,description:p("editor.guides.highlightActiveIndentation","Controls whether the editor should highlight the active indent guide.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{bracketPairs:cu(t.bracketPairs,this.defaultValue.bracketPairs,[!0,!1,"active"]),bracketPairsHorizontal:cu(t.bracketPairsHorizontal,this.defaultValue.bracketPairsHorizontal,[!0,!1,"active"]),highlightActiveBracketPair:Ee(t.highlightActiveBracketPair,this.defaultValue.highlightActiveBracketPair),indentation:Ee(t.indentation,this.defaultValue.indentation),highlightActiveIndentation:cu(t.highlightActiveIndentation,this.defaultValue.highlightActiveIndentation,[!0,!1,"always"])}}};function cu(o,e,t){let n=t.indexOf(o);return n===-1?e:t[n]}var r_=class extends It{constructor(){let e={insertMode:"insert",filterGraceful:!0,snippetsPreventQuickSuggestions:!1,localityBonus:!1,shareSuggestSelections:!1,selectionMode:"always",showIcons:!0,showStatusBar:!1,preview:!1,previewMode:"subwordSmart",showInlineDetails:!0,showMethods:!0,showFunctions:!0,showConstructors:!0,showDeprecated:!0,matchOnWordStartOnly:!0,showFields:!0,showVariables:!0,showClasses:!0,showStructs:!0,showInterfaces:!0,showModules:!0,showProperties:!0,showEvents:!0,showOperators:!0,showUnits:!0,showValues:!0,showConstants:!0,showEnums:!0,showEnumMembers:!0,showKeywords:!0,showWords:!0,showColors:!0,showFiles:!0,showReferences:!0,showFolders:!0,showTypeParameters:!0,showSnippets:!0,showUsers:!0,showIssues:!0};super(120,"suggest",e,{"editor.suggest.insertMode":{type:"string",enum:["insert","replace"],enumDescriptions:[p("suggest.insertMode.insert","Insert suggestion without overwriting text right of the cursor."),p("suggest.insertMode.replace","Insert suggestion and overwrite text right of the cursor.")],default:e.insertMode,description:p("suggest.insertMode","Controls whether words are overwritten when accepting completions. Note that this depends on extensions opting into this feature.")},"editor.suggest.filterGraceful":{type:"boolean",default:e.filterGraceful,description:p("suggest.filterGraceful","Controls whether filtering and sorting suggestions accounts for small typos.")},"editor.suggest.localityBonus":{type:"boolean",default:e.localityBonus,description:p("suggest.localityBonus","Controls whether sorting favors words that appear close to the cursor.")},"editor.suggest.shareSuggestSelections":{type:"boolean",default:e.shareSuggestSelections,markdownDescription:p("suggest.shareSuggestSelections","Controls whether remembered suggestion selections are shared between multiple workspaces and windows (needs `#editor.suggestSelection#`).")},"editor.suggest.selectionMode":{type:"string",enum:["always","never","whenTriggerCharacter","whenQuickSuggestion"],enumDescriptions:[p("suggest.insertMode.always","Always select a suggestion when automatically triggering IntelliSense."),p("suggest.insertMode.never","Never select a suggestion when automatically triggering IntelliSense."),p("suggest.insertMode.whenTriggerCharacter","Select a suggestion only when triggering IntelliSense from a trigger character."),p("suggest.insertMode.whenQuickSuggestion","Select a suggestion only when triggering IntelliSense as you type.")],default:e.selectionMode,markdownDescription:p("suggest.selectionMode","Controls whether a suggestion is selected when the widget shows. Note that this only applies to automatically triggered suggestions ({0} and {1}) and that a suggestion is always selected when explicitly invoked, e.g via `Ctrl+Space`.","`#editor.quickSuggestions#`","`#editor.suggestOnTriggerCharacters#`")},"editor.suggest.snippetsPreventQuickSuggestions":{type:"boolean",default:e.snippetsPreventQuickSuggestions,description:p("suggest.snippetsPreventQuickSuggestions","Controls whether an active snippet prevents quick suggestions.")},"editor.suggest.showIcons":{type:"boolean",default:e.showIcons,description:p("suggest.showIcons","Controls whether to show or hide icons in suggestions.")},"editor.suggest.showStatusBar":{type:"boolean",default:e.showStatusBar,description:p("suggest.showStatusBar","Controls the visibility of the status bar at the bottom of the suggest widget.")},"editor.suggest.preview":{type:"boolean",default:e.preview,description:p("suggest.preview","Controls whether to preview the suggestion outcome in the editor.")},"editor.suggest.showInlineDetails":{type:"boolean",default:e.showInlineDetails,description:p("suggest.showInlineDetails","Controls whether suggest details show inline with the label or only in the details widget.")},"editor.suggest.maxVisibleSuggestions":{type:"number",deprecationMessage:p("suggest.maxVisibleSuggestions.dep","This setting is deprecated. The suggest widget can now be resized.")},"editor.suggest.filteredTypes":{type:"object",deprecationMessage:p("deprecated","This setting is deprecated, please use separate settings like 'editor.suggest.showKeywords' or 'editor.suggest.showSnippets' instead.")},"editor.suggest.showMethods":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showMethods","When enabled IntelliSense shows `method`-suggestions.")},"editor.suggest.showFunctions":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showFunctions","When enabled IntelliSense shows `function`-suggestions.")},"editor.suggest.showConstructors":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showConstructors","When enabled IntelliSense shows `constructor`-suggestions.")},"editor.suggest.showDeprecated":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showDeprecated","When enabled IntelliSense shows `deprecated`-suggestions.")},"editor.suggest.matchOnWordStartOnly":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.matchOnWordStartOnly","When enabled IntelliSense filtering requires that the first character matches on a word start. For example, `c` on `Console` or `WebContext` but _not_ on `description`. When disabled IntelliSense will show more results but still sorts them by match quality.")},"editor.suggest.showFields":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showFields","When enabled IntelliSense shows `field`-suggestions.")},"editor.suggest.showVariables":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showVariables","When enabled IntelliSense shows `variable`-suggestions.")},"editor.suggest.showClasses":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showClasss","When enabled IntelliSense shows `class`-suggestions.")},"editor.suggest.showStructs":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showStructs","When enabled IntelliSense shows `struct`-suggestions.")},"editor.suggest.showInterfaces":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showInterfaces","When enabled IntelliSense shows `interface`-suggestions.")},"editor.suggest.showModules":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showModules","When enabled IntelliSense shows `module`-suggestions.")},"editor.suggest.showProperties":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showPropertys","When enabled IntelliSense shows `property`-suggestions.")},"editor.suggest.showEvents":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showEvents","When enabled IntelliSense shows `event`-suggestions.")},"editor.suggest.showOperators":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showOperators","When enabled IntelliSense shows `operator`-suggestions.")},"editor.suggest.showUnits":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showUnits","When enabled IntelliSense shows `unit`-suggestions.")},"editor.suggest.showValues":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showValues","When enabled IntelliSense shows `value`-suggestions.")},"editor.suggest.showConstants":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showConstants","When enabled IntelliSense shows `constant`-suggestions.")},"editor.suggest.showEnums":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showEnums","When enabled IntelliSense shows `enum`-suggestions.")},"editor.suggest.showEnumMembers":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showEnumMembers","When enabled IntelliSense shows `enumMember`-suggestions.")},"editor.suggest.showKeywords":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showKeywords","When enabled IntelliSense shows `keyword`-suggestions.")},"editor.suggest.showWords":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showTexts","When enabled IntelliSense shows `text`-suggestions.")},"editor.suggest.showColors":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showColors","When enabled IntelliSense shows `color`-suggestions.")},"editor.suggest.showFiles":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showFiles","When enabled IntelliSense shows `file`-suggestions.")},"editor.suggest.showReferences":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showReferences","When enabled IntelliSense shows `reference`-suggestions.")},"editor.suggest.showCustomcolors":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showCustomcolors","When enabled IntelliSense shows `customcolor`-suggestions.")},"editor.suggest.showFolders":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showFolders","When enabled IntelliSense shows `folder`-suggestions.")},"editor.suggest.showTypeParameters":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showTypeParameters","When enabled IntelliSense shows `typeParameter`-suggestions.")},"editor.suggest.showSnippets":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showSnippets","When enabled IntelliSense shows `snippet`-suggestions.")},"editor.suggest.showUsers":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showUsers","When enabled IntelliSense shows `user`-suggestions.")},"editor.suggest.showIssues":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showIssues","When enabled IntelliSense shows `issues`-suggestions.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{insertMode:Ut(t.insertMode,this.defaultValue.insertMode,["insert","replace"]),filterGraceful:Ee(t.filterGraceful,this.defaultValue.filterGraceful),snippetsPreventQuickSuggestions:Ee(t.snippetsPreventQuickSuggestions,this.defaultValue.filterGraceful),localityBonus:Ee(t.localityBonus,this.defaultValue.localityBonus),shareSuggestSelections:Ee(t.shareSuggestSelections,this.defaultValue.shareSuggestSelections),selectionMode:Ut(t.selectionMode,this.defaultValue.selectionMode,["always","never","whenQuickSuggestion","whenTriggerCharacter"]),showIcons:Ee(t.showIcons,this.defaultValue.showIcons),showStatusBar:Ee(t.showStatusBar,this.defaultValue.showStatusBar),preview:Ee(t.preview,this.defaultValue.preview),previewMode:Ut(t.previewMode,this.defaultValue.previewMode,["prefix","subword","subwordSmart"]),showInlineDetails:Ee(t.showInlineDetails,this.defaultValue.showInlineDetails),showMethods:Ee(t.showMethods,this.defaultValue.showMethods),showFunctions:Ee(t.showFunctions,this.defaultValue.showFunctions),showConstructors:Ee(t.showConstructors,this.defaultValue.showConstructors),showDeprecated:Ee(t.showDeprecated,this.defaultValue.showDeprecated),matchOnWordStartOnly:Ee(t.matchOnWordStartOnly,this.defaultValue.matchOnWordStartOnly),showFields:Ee(t.showFields,this.defaultValue.showFields),showVariables:Ee(t.showVariables,this.defaultValue.showVariables),showClasses:Ee(t.showClasses,this.defaultValue.showClasses),showStructs:Ee(t.showStructs,this.defaultValue.showStructs),showInterfaces:Ee(t.showInterfaces,this.defaultValue.showInterfaces),showModules:Ee(t.showModules,this.defaultValue.showModules),showProperties:Ee(t.showProperties,this.defaultValue.showProperties),showEvents:Ee(t.showEvents,this.defaultValue.showEvents),showOperators:Ee(t.showOperators,this.defaultValue.showOperators),showUnits:Ee(t.showUnits,this.defaultValue.showUnits),showValues:Ee(t.showValues,this.defaultValue.showValues),showConstants:Ee(t.showConstants,this.defaultValue.showConstants),showEnums:Ee(t.showEnums,this.defaultValue.showEnums),showEnumMembers:Ee(t.showEnumMembers,this.defaultValue.showEnumMembers),showKeywords:Ee(t.showKeywords,this.defaultValue.showKeywords),showWords:Ee(t.showWords,this.defaultValue.showWords),showColors:Ee(t.showColors,this.defaultValue.showColors),showFiles:Ee(t.showFiles,this.defaultValue.showFiles),showReferences:Ee(t.showReferences,this.defaultValue.showReferences),showFolders:Ee(t.showFolders,this.defaultValue.showFolders),showTypeParameters:Ee(t.showTypeParameters,this.defaultValue.showTypeParameters),showSnippets:Ee(t.showSnippets,this.defaultValue.showSnippets),showUsers:Ee(t.showUsers,this.defaultValue.showUsers),showIssues:Ee(t.showIssues,this.defaultValue.showIssues)}}},s_=class extends It{constructor(){super(115,"smartSelect",{selectLeadingAndTrailingWhitespace:!0,selectSubwords:!0},{"editor.smartSelect.selectLeadingAndTrailingWhitespace":{description:p("selectLeadingAndTrailingWhitespace","Whether leading and trailing whitespace should always be selected."),default:!0,type:"boolean"},"editor.smartSelect.selectSubwords":{description:p("selectSubwords","Whether subwords (like 'foo' in 'fooBar' or 'foo_bar') should be selected."),default:!0,type:"boolean"}})}validate(e){return!e||typeof e!="object"?this.defaultValue:{selectLeadingAndTrailingWhitespace:Ee(e.selectLeadingAndTrailingWhitespace,this.defaultValue.selectLeadingAndTrailingWhitespace),selectSubwords:Ee(e.selectSubwords,this.defaultValue.selectSubwords)}}},a_=class extends It{constructor(){let e=[];super(132,"wordSegmenterLocales",e,{anyOf:[{description:p("wordSegmenterLocales","Locales to be used for word segmentation when doing word related navigations or operations. Specify the BCP 47 language tag of the word you wish to recognize (e.g., ja, zh-CN, zh-Hant-TW, etc.)."),type:"string"},{description:p("wordSegmenterLocales","Locales to be used for word segmentation when doing word related navigations or operations. Specify the BCP 47 language tag of the word you wish to recognize (e.g., ja, zh-CN, zh-Hant-TW, etc.)."),type:"array",items:{type:"string"}}]})}validate(e){if(typeof e=="string"&&(e=[e]),Array.isArray(e)){let t=[];for(let n of e)if(typeof n=="string")try{Intl.Segmenter.supportedLocalesOf(n).length>0&&t.push(n)}catch{}return t}return this.defaultValue}};var l_=class extends It{constructor(){super(140,"wrappingIndent",1,{"editor.wrappingIndent":{type:"string",enum:["none","same","indent","deepIndent"],enumDescriptions:[p("wrappingIndent.none","No indentation. Wrapped lines begin at column 1."),p("wrappingIndent.same","Wrapped lines get the same indentation as the parent."),p("wrappingIndent.indent","Wrapped lines get +1 indentation toward the parent."),p("wrappingIndent.deepIndent","Wrapped lines get +2 indentation toward the parent.")],description:p("wrappingIndent","Controls the indentation of wrapped lines."),default:"same"}})}validate(e){switch(e){case"none":return 0;case"same":return 1;case"indent":return 2;case"deepIndent":return 3}return 1}compute(e,t,n){return t.get(2)===2?0:n}},d_=class extends _d{constructor(){super(148)}compute(e,t,n){let i=t.get(147);return{isDominatedByLongLines:e.isDominatedByLongLines,isWordWrapMinified:i.isWordWrapMinified,isViewportWrapping:i.isViewportWrapping,wrappingColumn:i.wrappingColumn}}},c_=class extends It{constructor(){let e={enabled:!0,showDropSelector:"afterDrop"};super(36,"dropIntoEditor",e,{"editor.dropIntoEditor.enabled":{type:"boolean",default:e.enabled,markdownDescription:p("dropIntoEditor.enabled","Controls whether you can drag and drop a file into a text editor by holding down the `Shift` key (instead of opening the file in an editor).")},"editor.dropIntoEditor.showDropSelector":{type:"string",markdownDescription:p("dropIntoEditor.showDropSelector","Controls if a widget is shown when dropping files into the editor. This widget lets you control how the file is dropped."),enum:["afterDrop","never"],enumDescriptions:[p("dropIntoEditor.showDropSelector.afterDrop","Show the drop selector widget after a file is dropped into the editor."),p("dropIntoEditor.showDropSelector.never","Never show the drop selector widget. Instead the default drop provider is always used.")],default:"afterDrop"}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:Ee(t.enabled,this.defaultValue.enabled),showDropSelector:Ut(t.showDropSelector,this.defaultValue.showDropSelector,["afterDrop","never"])}}},u_=class extends It{constructor(){let e={enabled:!0,showPasteSelector:"afterPaste"};super(86,"pasteAs",e,{"editor.pasteAs.enabled":{type:"boolean",default:e.enabled,markdownDescription:p("pasteAs.enabled","Controls whether you can paste content in different ways.")},"editor.pasteAs.showPasteSelector":{type:"string",markdownDescription:p("pasteAs.showPasteSelector","Controls if a widget is shown when pasting content in to the editor. This widget lets you control how the file is pasted."),enum:["afterPaste","never"],enumDescriptions:[p("pasteAs.showPasteSelector.afterPaste","Show the paste selector widget after content is pasted into the editor."),p("pasteAs.showPasteSelector.never","Never show the paste selector widget. Instead the default pasting behavior is always used.")],default:"afterPaste"}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:Ee(t.enabled,this.defaultValue.enabled),showPasteSelector:Ut(t.showPasteSelector,this.defaultValue.showPasteSelector,["afterPaste","never"])}}},TW="Consolas, 'Courier New', monospace",LW="Menlo, Monaco, 'Courier New', monospace",DW="'Droid Sans Mono', 'monospace', monospace",to={fontFamily:Be?LW:Wt?DW:TW,fontWeight:"normal",fontSize:Be?12:14,lineHeight:0,letterSpacing:0},hu=[];function K(o){return hu[o.id]=o,o}var vs={acceptSuggestionOnCommitCharacter:K(new Ye(0,"acceptSuggestionOnCommitCharacter",!0,{markdownDescription:p("acceptSuggestionOnCommitCharacter","Controls whether suggestions should be accepted on commit characters. For example, in JavaScript, the semi-colon (`;`) can be a commit character that accepts a suggestion and types that character.")})),acceptSuggestionOnEnter:K(new Rt(1,"acceptSuggestionOnEnter","on",["on","smart","off"],{markdownEnumDescriptions:["",p("acceptSuggestionOnEnterSmart","Only accept a suggestion with `Enter` when it makes a textual change."),""],markdownDescription:p("acceptSuggestionOnEnter","Controls whether suggestions should be accepted on `Enter`, in addition to `Tab`. Helps to avoid ambiguity between inserting new lines or accepting suggestions.")})),accessibilitySupport:K(new LE),accessibilityPageSize:K(new vt(3,"accessibilityPageSize",10,1,1073741824,{description:p("accessibilityPageSize","Controls the number of lines in the editor that can be read out by a screen reader at once. When we detect a screen reader we automatically set the default to be 500. Warning: this has a performance implication for numbers larger than the default."),tags:["accessibility"]})),ariaLabel:K(new gi(4,"ariaLabel",p("editorViewAccessibleLabel","Editor content"))),ariaRequired:K(new Ye(5,"ariaRequired",!1,void 0)),screenReaderAnnounceInlineSuggestion:K(new Ye(8,"screenReaderAnnounceInlineSuggestion",!0,{description:p("screenReaderAnnounceInlineSuggestion","Control whether inline suggestions are announced by a screen reader."),tags:["accessibility"]})),autoClosingBrackets:K(new Rt(6,"autoClosingBrackets","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",p("editor.autoClosingBrackets.languageDefined","Use language configurations to determine when to autoclose brackets."),p("editor.autoClosingBrackets.beforeWhitespace","Autoclose brackets only when the cursor is to the left of whitespace."),""],description:p("autoClosingBrackets","Controls whether the editor should automatically close brackets after the user adds an opening bracket.")})),autoClosingComments:K(new Rt(7,"autoClosingComments","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",p("editor.autoClosingComments.languageDefined","Use language configurations to determine when to autoclose comments."),p("editor.autoClosingComments.beforeWhitespace","Autoclose comments only when the cursor is to the left of whitespace."),""],description:p("autoClosingComments","Controls whether the editor should automatically close comments after the user adds an opening comment.")})),autoClosingDelete:K(new Rt(9,"autoClosingDelete","auto",["always","auto","never"],{enumDescriptions:["",p("editor.autoClosingDelete.auto","Remove adjacent closing quotes or brackets only if they were automatically inserted."),""],description:p("autoClosingDelete","Controls whether the editor should remove adjacent closing quotes or brackets when deleting.")})),autoClosingOvertype:K(new Rt(10,"autoClosingOvertype","auto",["always","auto","never"],{enumDescriptions:["",p("editor.autoClosingOvertype.auto","Type over closing quotes or brackets only if they were automatically inserted."),""],description:p("autoClosingOvertype","Controls whether the editor should type over closing quotes or brackets.")})),autoClosingQuotes:K(new Rt(11,"autoClosingQuotes","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",p("editor.autoClosingQuotes.languageDefined","Use language configurations to determine when to autoclose quotes."),p("editor.autoClosingQuotes.beforeWhitespace","Autoclose quotes only when the cursor is to the left of whitespace."),""],description:p("autoClosingQuotes","Controls whether the editor should automatically close quotes after the user adds an opening quote.")})),autoIndent:K(new lu(12,"autoIndent",4,"full",["none","keep","brackets","advanced","full"],wW,{enumDescriptions:[p("editor.autoIndent.none","The editor will not insert indentation automatically."),p("editor.autoIndent.keep","The editor will keep the current line's indentation."),p("editor.autoIndent.brackets","The editor will keep the current line's indentation and honor language defined brackets."),p("editor.autoIndent.advanced","The editor will keep the current line's indentation, honor language defined brackets and invoke special onEnterRules defined by languages."),p("editor.autoIndent.full","The editor will keep the current line's indentation, honor language defined brackets, invoke special onEnterRules defined by languages, and honor indentationRules defined by languages.")],description:p("autoIndent","Controls whether the editor should automatically adjust the indentation when users type, paste, move or indent lines.")})),automaticLayout:K(new Ye(13,"automaticLayout",!1)),autoSurround:K(new Rt(14,"autoSurround","languageDefined",["languageDefined","quotes","brackets","never"],{enumDescriptions:[p("editor.autoSurround.languageDefined","Use language configurations to determine when to automatically surround selections."),p("editor.autoSurround.quotes","Surround with quotes but not brackets."),p("editor.autoSurround.brackets","Surround with brackets but not quotes."),""],description:p("autoSurround","Controls whether the editor should automatically surround selections when typing quotes or brackets.")})),bracketPairColorization:K(new i_),bracketPairGuides:K(new o_),stickyTabStops:K(new Ye(118,"stickyTabStops",!1,{description:p("stickyTabStops","Emulate selection behavior of tab characters when using spaces for indentation. Selection will stick to tab stops.")})),codeLens:K(new Ye(17,"codeLens",!0,{description:p("codeLens","Controls whether the editor shows CodeLens.")})),codeLensFontFamily:K(new gi(18,"codeLensFontFamily","",{description:p("codeLensFontFamily","Controls the font family for CodeLens.")})),codeLensFontSize:K(new vt(19,"codeLensFontSize",0,0,100,{type:"number",default:0,minimum:0,maximum:100,markdownDescription:p("codeLensFontSize","Controls the font size in pixels for CodeLens. When set to 0, 90% of `#editor.fontSize#` is used.")})),colorDecorators:K(new Ye(20,"colorDecorators",!0,{description:p("colorDecorators","Controls whether the editor should render the inline color decorators and color picker.")})),colorDecoratorActivatedOn:K(new Rt(150,"colorDecoratorsActivatedOn","clickAndHover",["clickAndHover","hover","click"],{enumDescriptions:[p("editor.colorDecoratorActivatedOn.clickAndHover","Make the color picker appear both on click and hover of the color decorator"),p("editor.colorDecoratorActivatedOn.hover","Make the color picker appear on hover of the color decorator"),p("editor.colorDecoratorActivatedOn.click","Make the color picker appear on click of the color decorator")],description:p("colorDecoratorActivatedOn","Controls the condition to make a color picker appear from a color decorator")})),colorDecoratorsLimit:K(new vt(21,"colorDecoratorsLimit",500,1,1e6,{markdownDescription:p("colorDecoratorsLimit","Controls the max number of color decorators that can be rendered in an editor at once.")})),columnSelection:K(new Ye(22,"columnSelection",!1,{description:p("columnSelection","Enable that the selection with the mouse and keys is doing column selection.")})),comments:K(new DE),contextmenu:K(new Ye(24,"contextmenu",!0)),copyWithSyntaxHighlighting:K(new Ye(25,"copyWithSyntaxHighlighting",!0,{description:p("copyWithSyntaxHighlighting","Controls whether syntax highlighting should be copied into the clipboard.")})),cursorBlinking:K(new lu(26,"cursorBlinking",1,"blink",["blink","smooth","phase","expand","solid"],xW,{description:p("cursorBlinking","Control the cursor animation style.")})),cursorSmoothCaretAnimation:K(new Rt(27,"cursorSmoothCaretAnimation","off",["off","explicit","on"],{enumDescriptions:[p("cursorSmoothCaretAnimation.off","Smooth caret animation is disabled."),p("cursorSmoothCaretAnimation.explicit","Smooth caret animation is enabled only when the user moves the cursor with an explicit gesture."),p("cursorSmoothCaretAnimation.on","Smooth caret animation is always enabled.")],description:p("cursorSmoothCaretAnimation","Controls whether the smooth caret animation should be enabled.")})),cursorStyle:K(new lu(28,"cursorStyle",1,"line",["line","block","underline","line-thin","block-outline","underline-thin"],EW,{description:p("cursorStyle","Controls the cursor style.")})),cursorSurroundingLines:K(new vt(29,"cursorSurroundingLines",0,0,1073741824,{description:p("cursorSurroundingLines","Controls the minimal number of visible leading lines (minimum 0) and trailing lines (minimum 1) surrounding the cursor. Known as 'scrollOff' or 'scrollOffset' in some other editors.")})),cursorSurroundingLinesStyle:K(new Rt(30,"cursorSurroundingLinesStyle","default",["default","all"],{enumDescriptions:[p("cursorSurroundingLinesStyle.default","`cursorSurroundingLines` is enforced only when triggered via the keyboard or API."),p("cursorSurroundingLinesStyle.all","`cursorSurroundingLines` is enforced always.")],markdownDescription:p("cursorSurroundingLinesStyle","Controls when `#editor.cursorSurroundingLines#` should be enforced.")})),cursorWidth:K(new vt(31,"cursorWidth",0,0,1073741824,{markdownDescription:p("cursorWidth","Controls the width of the cursor when `#editor.cursorStyle#` is set to `line`.")})),disableLayerHinting:K(new Ye(32,"disableLayerHinting",!1)),disableMonospaceOptimizations:K(new Ye(33,"disableMonospaceOptimizations",!1)),domReadOnly:K(new Ye(34,"domReadOnly",!1)),dragAndDrop:K(new Ye(35,"dragAndDrop",!0,{description:p("dragAndDrop","Controls whether the editor should allow moving selections via drag and drop.")})),emptySelectionClipboard:K(new RE),dropIntoEditor:K(new c_),experimentalEditContextEnabled:K(new Ye(37,"experimentalEditContextEnabled",!1,{description:p("experimentalEditContextEnabled","Sets whether the new experimental edit context should be used instead of the text area.")})),stickyScroll:K(new WE),experimentalWhitespaceRendering:K(new Rt(39,"experimentalWhitespaceRendering","svg",["svg","font","off"],{enumDescriptions:[p("experimentalWhitespaceRendering.svg","Use a new rendering method with svgs."),p("experimentalWhitespaceRendering.font","Use a new rendering method with font characters."),p("experimentalWhitespaceRendering.off","Use the stable rendering method.")],description:p("experimentalWhitespaceRendering","Controls whether whitespace is rendered with a new, experimental method.")})),extraEditorClassName:K(new gi(40,"extraEditorClassName","")),fastScrollSensitivity:K(new tr(41,"fastScrollSensitivity",5,o=>o<=0?5:o,{markdownDescription:p("fastScrollSensitivity","Scrolling speed multiplier when pressing `Alt`.")})),find:K(new ME),fixedOverflowWidgets:K(new Ye(43,"fixedOverflowWidgets",!1)),folding:K(new Ye(44,"folding",!0,{description:p("folding","Controls whether the editor has code folding enabled.")})),foldingStrategy:K(new Rt(45,"foldingStrategy","auto",["auto","indentation"],{enumDescriptions:[p("foldingStrategy.auto","Use a language-specific folding strategy if available, else the indentation-based one."),p("foldingStrategy.indentation","Use the indentation-based folding strategy.")],description:p("foldingStrategy","Controls the strategy for computing folding ranges.")})),foldingHighlight:K(new Ye(46,"foldingHighlight",!0,{description:p("foldingHighlight","Controls whether the editor should highlight folded ranges.")})),foldingImportsByDefault:K(new Ye(47,"foldingImportsByDefault",!1,{description:p("foldingImportsByDefault","Controls whether the editor automatically collapses import ranges.")})),foldingMaximumRegions:K(new vt(48,"foldingMaximumRegions",5e3,10,65e3,{description:p("foldingMaximumRegions","The maximum number of foldable regions. Increasing this value may result in the editor becoming less responsive when the current source has a large number of foldable regions.")})),unfoldOnClickAfterEndOfLine:K(new Ye(49,"unfoldOnClickAfterEndOfLine",!1,{description:p("unfoldOnClickAfterEndOfLine","Controls whether clicking on the empty content after a folded line will unfold the line.")})),fontFamily:K(new gi(50,"fontFamily",to.fontFamily,{description:p("fontFamily","Controls the font family.")})),fontInfo:K(new AE),fontLigatures2:K(new Td),fontSize:K(new OE),fontWeight:K(new NE),fontVariations:K(new uu),formatOnPaste:K(new Ye(56,"formatOnPaste",!1,{description:p("formatOnPaste","Controls whether the editor should automatically format the pasted content. A formatter must be available and the formatter should be able to format a range in a document.")})),formatOnType:K(new Ye(57,"formatOnType",!1,{description:p("formatOnType","Controls whether the editor should automatically format the line after typing.")})),glyphMargin:K(new Ye(58,"glyphMargin",!0,{description:p("glyphMargin","Controls whether the editor should render the vertical glyph margin. Glyph margin is mostly used for debugging.")})),gotoLocation:K(new PE),hideCursorInOverviewRuler:K(new Ye(60,"hideCursorInOverviewRuler",!1,{description:p("hideCursorInOverviewRuler","Controls whether the cursor should be hidden in the overview ruler.")})),hover:K(new FE),inDiffEditor:K(new Ye(62,"inDiffEditor",!1)),letterSpacing:K(new tr(65,"letterSpacing",to.letterSpacing,o=>tr.clamp(o,-5,20),{description:p("letterSpacing","Controls the letter spacing in pixels.")})),lightbulb:K(new VE),lineDecorationsWidth:K(new UE),lineHeight:K(new zE),lineNumbers:K(new ZE),lineNumbersMinChars:K(new vt(70,"lineNumbersMinChars",5,1,300)),linkedEditing:K(new Ye(71,"linkedEditing",!1,{description:p("linkedEditing","Controls whether the editor has linked editing enabled. Depending on the language, related symbols such as HTML tags, are updated while editing.")})),links:K(new Ye(72,"links",!0,{description:p("links","Controls whether the editor should detect links and make them clickable.")})),matchBrackets:K(new Rt(73,"matchBrackets","always",["always","near","never"],{description:p("matchBrackets","Highlight matching brackets.")})),minimap:K(new KE),mouseStyle:K(new Rt(75,"mouseStyle","text",["text","default","copy"])),mouseWheelScrollSensitivity:K(new tr(76,"mouseWheelScrollSensitivity",1,o=>o===0?1:o,{markdownDescription:p("mouseWheelScrollSensitivity","A multiplier to be used on the `deltaX` and `deltaY` of mouse wheel scroll events.")})),mouseWheelZoom:K(new Ye(77,"mouseWheelZoom",!1,{markdownDescription:Be?p("mouseWheelZoom.mac","Zoom the font of the editor when using mouse wheel and holding `Cmd`."):p("mouseWheelZoom","Zoom the font of the editor when using mouse wheel and holding `Ctrl`.")})),multiCursorMergeOverlapping:K(new Ye(78,"multiCursorMergeOverlapping",!0,{description:p("multiCursorMergeOverlapping","Merge multiple cursors when they are overlapping.")})),multiCursorModifier:K(new lu(79,"multiCursorModifier","altKey","alt",["ctrlCmd","alt"],_W,{markdownEnumDescriptions:[p("multiCursorModifier.ctrlCmd","Maps to `Control` on Windows and Linux and to `Command` on macOS."),p("multiCursorModifier.alt","Maps to `Alt` on Windows and Linux and to `Option` on macOS.")],markdownDescription:p({key:"multiCursorModifier",comment:["- `ctrlCmd` refers to a value the setting can take and should not be localized.","- `Control` and `Command` refer to the modifier keys Ctrl or Cmd on the keyboard and can be localized."]},"The modifier to be used to add multiple cursors with the mouse. The Go to Definition and Open Link mouse gestures will adapt such that they do not conflict with the [multicursor modifier](https://code.visualstudio.com/docs/editor/codebasics#_multicursor-modifier).")})),multiCursorPaste:K(new Rt(80,"multiCursorPaste","spread",["spread","full"],{markdownEnumDescriptions:[p("multiCursorPaste.spread","Each cursor pastes a single line of the text."),p("multiCursorPaste.full","Each cursor pastes the full text.")],markdownDescription:p("multiCursorPaste","Controls pasting when the line count of the pasted text matches the cursor count.")})),multiCursorLimit:K(new vt(81,"multiCursorLimit",1e4,1,1e5,{markdownDescription:p("multiCursorLimit","Controls the max number of cursors that can be in an active editor at once.")})),occurrencesHighlight:K(new Rt(82,"occurrencesHighlight","singleFile",["off","singleFile","multiFile"],{markdownEnumDescriptions:[p("occurrencesHighlight.off","Does not highlight occurrences."),p("occurrencesHighlight.singleFile","Highlights occurrences only in the current file."),p("occurrencesHighlight.multiFile","Experimental: Highlights occurrences across all valid open files.")],markdownDescription:p("occurrencesHighlight","Controls whether occurrences should be highlighted across open files.")})),overviewRulerBorder:K(new Ye(83,"overviewRulerBorder",!0,{description:p("overviewRulerBorder","Controls whether a border should be drawn around the overview ruler.")})),overviewRulerLanes:K(new vt(84,"overviewRulerLanes",3,0,3)),padding:K(new GE),pasteAs:K(new u_),parameterHints:K(new jE),peekWidgetDefaultFocus:K(new Rt(88,"peekWidgetDefaultFocus","tree",["tree","editor"],{enumDescriptions:[p("peekWidgetDefaultFocus.tree","Focus the tree when opening peek"),p("peekWidgetDefaultFocus.editor","Focus the editor when opening peek")],description:p("peekWidgetDefaultFocus","Controls whether to focus the inline editor or the tree in the peek widget.")})),placeholder:K(new qE),definitionLinkOpensInPeek:K(new Ye(90,"definitionLinkOpensInPeek",!1,{description:p("definitionLinkOpensInPeek","Controls whether the Go to Definition mouse gesture always opens the peek widget.")})),quickSuggestions:K(new YE),quickSuggestionsDelay:K(new vt(92,"quickSuggestionsDelay",10,0,1073741824,{description:p("quickSuggestionsDelay","Controls the delay in milliseconds after which quick suggestions will show up.")})),readOnly:K(new Ye(93,"readOnly",!1)),readOnlyMessage:K(new QE),renameOnType:K(new Ye(95,"renameOnType",!1,{description:p("renameOnType","Controls whether the editor auto renames on type."),markdownDeprecationMessage:p("renameOnTypeDeprecate","Deprecated, use `editor.linkedEditing` instead.")})),renderControlCharacters:K(new Ye(96,"renderControlCharacters",!0,{description:p("renderControlCharacters","Controls whether the editor should render control characters."),restricted:!0})),renderFinalNewline:K(new Rt(97,"renderFinalNewline",Wt?"dimmed":"on",["off","on","dimmed"],{description:p("renderFinalNewline","Render last line number when the file ends with a newline.")})),renderLineHighlight:K(new Rt(98,"renderLineHighlight","line",["none","gutter","line","all"],{enumDescriptions:["","","",p("renderLineHighlight.all","Highlights both the gutter and the current line.")],description:p("renderLineHighlight","Controls how the editor should render the current line highlight.")})),renderLineHighlightOnlyWhenFocus:K(new Ye(99,"renderLineHighlightOnlyWhenFocus",!1,{description:p("renderLineHighlightOnlyWhenFocus","Controls if the editor should render the current line highlight only when the editor is focused.")})),renderValidationDecorations:K(new Rt(100,"renderValidationDecorations","editable",["editable","on","off"])),renderWhitespace:K(new Rt(101,"renderWhitespace","selection",["none","boundary","selection","trailing","all"],{enumDescriptions:["",p("renderWhitespace.boundary","Render whitespace characters except for single spaces between words."),p("renderWhitespace.selection","Render whitespace characters only on selected text."),p("renderWhitespace.trailing","Render only trailing whitespace characters."),""],description:p("renderWhitespace","Controls how the editor should render whitespace characters.")})),revealHorizontalRightPadding:K(new vt(102,"revealHorizontalRightPadding",15,0,1e3)),roundedSelection:K(new Ye(103,"roundedSelection",!0,{description:p("roundedSelection","Controls whether selections should have rounded corners.")})),rulers:K(new XE),scrollbar:K(new JE),scrollBeyondLastColumn:K(new vt(106,"scrollBeyondLastColumn",4,0,1073741824,{description:p("scrollBeyondLastColumn","Controls the number of extra characters beyond which the editor will scroll horizontally.")})),scrollBeyondLastLine:K(new Ye(107,"scrollBeyondLastLine",!0,{description:p("scrollBeyondLastLine","Controls whether the editor will scroll beyond the last line.")})),scrollPredominantAxis:K(new Ye(108,"scrollPredominantAxis",!0,{description:p("scrollPredominantAxis","Scroll only along the predominant axis when scrolling both vertically and horizontally at the same time. Prevents horizontal drift when scrolling vertically on a trackpad.")})),selectionClipboard:K(new Ye(109,"selectionClipboard",!0,{description:p("selectionClipboard","Controls whether the Linux primary clipboard should be supported."),included:Wt})),selectionHighlight:K(new Ye(110,"selectionHighlight",!0,{description:p("selectionHighlight","Controls whether the editor should highlight matches similar to the selection.")})),selectOnLineNumbers:K(new Ye(111,"selectOnLineNumbers",!0)),showFoldingControls:K(new Rt(112,"showFoldingControls","mouseover",["always","never","mouseover"],{enumDescriptions:[p("showFoldingControls.always","Always show the folding controls."),p("showFoldingControls.never","Never show the folding controls and reduce the gutter size."),p("showFoldingControls.mouseover","Only show the folding controls when the mouse is over the gutter.")],description:p("showFoldingControls","Controls when the folding controls on the gutter are shown.")})),showUnused:K(new Ye(113,"showUnused",!0,{description:p("showUnused","Controls fading out of unused code.")})),showDeprecated:K(new Ye(142,"showDeprecated",!0,{description:p("showDeprecated","Controls strikethrough deprecated variables.")})),inlayHints:K(new HE),snippetSuggestions:K(new Rt(114,"snippetSuggestions","inline",["top","bottom","inline","none"],{enumDescriptions:[p("snippetSuggestions.top","Show snippet suggestions on top of other suggestions."),p("snippetSuggestions.bottom","Show snippet suggestions below other suggestions."),p("snippetSuggestions.inline","Show snippets suggestions with other suggestions."),p("snippetSuggestions.none","Do not show snippet suggestions.")],description:p("snippetSuggestions","Controls whether snippets are shown with other suggestions and how they are sorted.")})),smartSelect:K(new s_),smoothScrolling:K(new Ye(116,"smoothScrolling",!1,{description:p("smoothScrolling","Controls whether the editor will scroll using an animation.")})),stopRenderingLineAfter:K(new vt(119,"stopRenderingLineAfter",1e4,-1,1073741824)),suggest:K(new r_),inlineSuggest:K(new t_),inlineEdit:K(new n_),inlineCompletionsAccessibilityVerbose:K(new Ye(151,"inlineCompletionsAccessibilityVerbose",!1,{description:p("inlineCompletionsAccessibilityVerbose","Controls whether the accessibility hint should be provided to screen reader users when an inline completion is shown.")})),suggestFontSize:K(new vt(121,"suggestFontSize",0,0,1e3,{markdownDescription:p("suggestFontSize","Font size for the suggest widget. When set to {0}, the value of {1} is used.","`0`","`#editor.fontSize#`")})),suggestLineHeight:K(new vt(122,"suggestLineHeight",0,0,1e3,{markdownDescription:p("suggestLineHeight","Line height for the suggest widget. When set to {0}, the value of {1} is used. The minimum value is 8.","`0`","`#editor.lineHeight#`")})),suggestOnTriggerCharacters:K(new Ye(123,"suggestOnTriggerCharacters",!0,{description:p("suggestOnTriggerCharacters","Controls whether suggestions should automatically show up when typing trigger characters.")})),suggestSelection:K(new Rt(124,"suggestSelection","first",["first","recentlyUsed","recentlyUsedByPrefix"],{markdownEnumDescriptions:[p("suggestSelection.first","Always select the first suggestion."),p("suggestSelection.recentlyUsed","Select recent suggestions unless further typing selects one, e.g. `console.| -> console.log` because `log` has been completed recently."),p("suggestSelection.recentlyUsedByPrefix","Select suggestions based on previous prefixes that have completed those suggestions, e.g. `co -> console` and `con -> const`.")],description:p("suggestSelection","Controls how suggestions are pre-selected when showing the suggest list.")})),tabCompletion:K(new Rt(125,"tabCompletion","off",["on","off","onlySnippets"],{enumDescriptions:[p("tabCompletion.on","Tab complete will insert the best matching suggestion when pressing tab."),p("tabCompletion.off","Disable tab completions."),p("tabCompletion.onlySnippets","Tab complete snippets when their prefix match. Works best when 'quickSuggestions' aren't enabled.")],description:p("tabCompletion","Enables tab completions.")})),tabIndex:K(new vt(126,"tabIndex",0,-1,1073741824)),unicodeHighlight:K(new e_),unusualLineTerminators:K(new Rt(128,"unusualLineTerminators","prompt",["auto","off","prompt"],{enumDescriptions:[p("unusualLineTerminators.auto","Unusual line terminators are automatically removed."),p("unusualLineTerminators.off","Unusual line terminators are ignored."),p("unusualLineTerminators.prompt","Unusual line terminators prompt to be removed.")],description:p("unusualLineTerminators","Remove unusual line terminators that might cause problems.")})),useShadowDOM:K(new Ye(129,"useShadowDOM",!0)),useTabStops:K(new Ye(130,"useTabStops",!0,{description:p("useTabStops","Spaces and tabs are inserted and deleted in alignment with tab stops.")})),wordBreak:K(new Rt(131,"wordBreak","normal",["normal","keepAll"],{markdownEnumDescriptions:[p("wordBreak.normal","Use the default line break rule."),p("wordBreak.keepAll","Word breaks should not be used for Chinese/Japanese/Korean (CJK) text. Non-CJK text behavior is the same as for normal.")],description:p("wordBreak","Controls the word break rules used for Chinese/Japanese/Korean (CJK) text.")})),wordSegmenterLocales:K(new a_),wordSeparators:K(new gi(133,"wordSeparators",IE,{description:p("wordSeparators","Characters that will be used as word separators when doing word related navigations or operations.")})),wordWrap:K(new Rt(134,"wordWrap","off",["off","on","wordWrapColumn","bounded"],{markdownEnumDescriptions:[p("wordWrap.off","Lines will never wrap."),p("wordWrap.on","Lines will wrap at the viewport width."),p({key:"wordWrap.wordWrapColumn",comment:["- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Lines will wrap at `#editor.wordWrapColumn#`."),p({key:"wordWrap.bounded",comment:["- viewport means the edge of the visible window size.","- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Lines will wrap at the minimum of viewport and `#editor.wordWrapColumn#`.")],description:p({key:"wordWrap",comment:["- 'off', 'on', 'wordWrapColumn' and 'bounded' refer to values the setting can take and should not be localized.","- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Controls how lines should wrap.")})),wordWrapBreakAfterCharacters:K(new gi(135,"wordWrapBreakAfterCharacters"," 	})]?|/&.,;\xA2\xB0\u2032\u2033\u2030\u2103\u3001\u3002\uFF61\uFF64\uFFE0\uFF0C\uFF0E\uFF1A\uFF1B\uFF1F\uFF01\uFF05\u30FB\uFF65\u309D\u309E\u30FD\u30FE\u30FC\u30A1\u30A3\u30A5\u30A7\u30A9\u30C3\u30E3\u30E5\u30E7\u30EE\u30F5\u30F6\u3041\u3043\u3045\u3047\u3049\u3063\u3083\u3085\u3087\u308E\u3095\u3096\u31F0\u31F1\u31F2\u31F3\u31F4\u31F5\u31F6\u31F7\u31F8\u31F9\u31FA\u31FB\u31FC\u31FD\u31FE\u31FF\u3005\u303B\uFF67\uFF68\uFF69\uFF6A\uFF6B\uFF6C\uFF6D\uFF6E\uFF6F\uFF70\u201D\u3009\u300B\u300D\u300F\u3011\u3015\uFF09\uFF3D\uFF5D\uFF63")),wordWrapBreakBeforeCharacters:K(new gi(136,"wordWrapBreakBeforeCharacters","([{\u2018\u201C\u3008\u300A\u300C\u300E\u3010\u3014\uFF08\uFF3B\uFF5B\uFF62\xA3\xA5\uFF04\uFFE1\uFFE5+\uFF0B")),wordWrapColumn:K(new vt(137,"wordWrapColumn",80,1,1073741824,{markdownDescription:p({key:"wordWrapColumn",comment:["- `editor.wordWrap` refers to a different setting and should not be localized.","- 'wordWrapColumn' and 'bounded' refer to values the different setting can take and should not be localized."]},"Controls the wrapping column of the editor when `#editor.wordWrap#` is `wordWrapColumn` or `bounded`.")})),wordWrapOverride1:K(new Rt(138,"wordWrapOverride1","inherit",["off","on","inherit"])),wordWrapOverride2:K(new Rt(139,"wordWrapOverride2","inherit",["off","on","inherit"])),editorClassName:K(new kE),defaultColorDecorators:K(new Ye(149,"defaultColorDecorators",!1,{markdownDescription:p("defaultColorDecorators","Controls whether inline color decorations should be shown using the default document color provider")})),pixelRatio:K(new $E),tabFocusMode:K(new Ye(146,"tabFocusMode",!1,{markdownDescription:p("tabFocusMode","Controls whether the editor receives tabs or defers them to the workbench for navigation.")})),layoutInfo:K(new Cm),wrappingInfo:K(new d_),wrappingIndent:K(new l_),wrappingStrategy:K(new BE)};var ys=new class{_zoomLevel=0;_onDidChangeZoomLevel=new E;onDidChangeZoomLevel=this._onDidChangeZoomLevel.event;getZoomLevel(){return this._zoomLevel}setZoomLevel(o){o=Math.min(Math.max(-5,o),20),this._zoomLevel!==o&&(this._zoomLevel=o,this._onDidChangeZoomLevel.fire(this._zoomLevel))}};var kW=Be?1.5:1.35,h_=8,Sm=class o{_bareFontInfoBrand=void 0;static createFromValidatedSettings(e,t,n){let i=e.get(50),r=e.get(54),s=e.get(53),a=e.get(52),l=e.get(55),d=e.get(68),c=e.get(65);return o._create(i,r,s,a,l,d,c,t,n)}static createFromRawSettings(e,t,n=!1){let i=vs.fontFamily.validate(e.fontFamily),r=vs.fontWeight.validate(e.fontWeight),s=vs.fontSize.validate(e.fontSize),a=vs.fontLigatures2.validate(e.fontLigatures),l=vs.fontVariations.validate(e.fontVariations),d=vs.lineHeight.validate(e.lineHeight),c=vs.letterSpacing.validate(e.letterSpacing);return o._create(i,r,s,a,l,d,c,t,n)}static _create(e,t,n,i,r,s,a,l,d){s===0?s=kW*n:s<h_&&(s=s*n),s=Math.round(s),s<h_&&(s=h_);let c=1+(d?0:ys.getZoomLevel()*.1);return n*=c,s*=c,r===uu.TRANSLATE&&(t==="normal"||t==="bold"?r=uu.OFF:(r=`'wght' ${parseInt(t,10)}`,t="normal")),new o({pixelRatio:l,fontFamily:e,fontWeight:t,fontSize:n,fontFeatureSettings:i,fontVariationSettings:r,lineHeight:s,letterSpacing:a})}pixelRatio;fontFamily;fontWeight;fontSize;fontFeatureSettings;fontVariationSettings;lineHeight;letterSpacing;constructor(e){this.pixelRatio=e.pixelRatio,this.fontFamily=String(e.fontFamily),this.fontWeight=String(e.fontWeight),this.fontSize=e.fontSize,this.fontFeatureSettings=e.fontFeatureSettings,this.fontVariationSettings=e.fontVariationSettings,this.lineHeight=e.lineHeight|0,this.letterSpacing=e.letterSpacing}getId(){return`${this.pixelRatio}-${this.fontFamily}-${this.fontWeight}-${this.fontSize}-${this.fontFeatureSettings}-${this.fontVariationSettings}-${this.lineHeight}-${this.letterSpacing}`}getMassagedFontFamily(){let e=to.fontFamily,t=o._wrapInQuotes(this.fontFamily);return e&&this.fontFamily!==e?`${t}, ${e}`:t}static _wrapInQuotes(e){return/[,"']/.test(e)?e:/[+ ]/.test(e)?`"${e}"`:e}},p_=2,pu=class extends Sm{_editorStylingBrand=void 0;version=p_;isTrusted;isMonospace;typicalHalfwidthCharacterWidth;typicalFullwidthCharacterWidth;canUseHalfwidthRightwardsArrow;spaceWidth;middotWidth;wsmiddotWidth;maxDigitWidth;constructor(e,t){super(e),this.isTrusted=t,this.isMonospace=e.isMonospace,this.typicalHalfwidthCharacterWidth=e.typicalHalfwidthCharacterWidth,this.typicalFullwidthCharacterWidth=e.typicalFullwidthCharacterWidth,this.canUseHalfwidthRightwardsArrow=e.canUseHalfwidthRightwardsArrow,this.spaceWidth=e.spaceWidth,this.middotWidth=e.middotWidth,this.wsmiddotWidth=e.wsmiddotWidth,this.maxDigitWidth=e.maxDigitWidth}equals(e){return this.fontFamily===e.fontFamily&&this.fontWeight===e.fontWeight&&this.fontSize===e.fontSize&&this.fontFeatureSettings===e.fontFeatureSettings&&this.fontVariationSettings===e.fontVariationSettings&&this.lineHeight===e.lineHeight&&this.letterSpacing===e.letterSpacing&&this.typicalHalfwidthCharacterWidth===e.typicalHalfwidthCharacterWidth&&this.typicalFullwidthCharacterWidth===e.typicalFullwidthCharacterWidth&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.maxDigitWidth===e.maxDigitWidth}};function ln(o,e){o instanceof vd?(o.setFontFamily(e.getMassagedFontFamily()),o.setFontWeight(e.fontWeight),o.setFontSize(e.fontSize),o.setFontFeatureSettings(e.fontFeatureSettings),o.setFontVariationSettings(e.fontVariationSettings),o.setLineHeight(e.lineHeight),o.setLetterSpacing(e.letterSpacing)):(o.style.fontFamily=e.getMassagedFontFamily(),o.style.fontWeight=e.fontWeight,o.style.fontSize=e.fontSize+"px",o.style.fontFeatureSettings=e.fontFeatureSettings,o.style.fontVariationSettings=e.fontVariationSettings,o.style.lineHeight=e.lineHeight+"px",o.style.letterSpacing=e.letterSpacing+"px")}var lv=class{chr;type;width;constructor(e,t){this.chr=e,this.type=t,this.width=0}fulfill(e){this.width=e}},m_=class o{_bareFontInfo;_requests;_container;_testElements;constructor(e,t){this._bareFontInfo=e,this._requests=t,this._container=null,this._testElements=null}read(e){this._createDomElements(),e.document.body.appendChild(this._container),this._readFromDomElements(),this._container?.remove(),this._container=null,this._testElements=null}_createDomElements(){let e=document.createElement("div");e.style.position="absolute",e.style.top="-50000px",e.style.width="50000px";let t=document.createElement("div");ln(t,this._bareFontInfo),e.appendChild(t);let n=document.createElement("div");ln(n,this._bareFontInfo),n.style.fontWeight="bold",e.appendChild(n);let i=document.createElement("div");ln(i,this._bareFontInfo),i.style.fontStyle="italic",e.appendChild(i);let r=[];for(let s of this._requests){let a;s.type===0&&(a=t),s.type===2&&(a=n),s.type===1&&(a=i),a.appendChild(document.createElement("br"));let l=document.createElement("span");o._render(l,s),a.appendChild(l),r.push(l)}this._container=e,this._testElements=r}static _render(e,t){if(t.chr===" "){let n="\xA0";for(let i=0;i<8;i++)n+=n;e.innerText=n}else{let n=t.chr;for(let i=0;i<8;i++)n+=n;e.textContent=n}}_readFromDomElements(){for(let e=0,t=this._requests.length;e<t;e++){let n=this._requests[e],i=this._testElements[e];n.fulfill(i.offsetWidth/256)}}};function sM(o,e,t){new m_(e,t).read(o)}var g_=class extends V{_cache=new Map;_evictUntrustedReadingsTimeout=-1;_onDidChange=this._register(new E);onDidChange=this._onDidChange.event;dispose(){this._evictUntrustedReadingsTimeout!==-1&&(clearTimeout(this._evictUntrustedReadingsTimeout),this._evictUntrustedReadingsTimeout=-1),super.dispose()}clearAllFontInfos(){this._cache.clear(),this._onDidChange.fire()}_ensureCache(e){let t=il(e),n=this._cache.get(t);return n||(n=new f_,this._cache.set(t,n)),n}_writeToCache(e,t,n){this._ensureCache(e).put(t,n),!n.isTrusted&&this._evictUntrustedReadingsTimeout===-1&&(this._evictUntrustedReadingsTimeout=e.setTimeout(()=>{this._evictUntrustedReadingsTimeout=-1,this._evictUntrustedReadings(e)},5e3))}_evictUntrustedReadings(e){let t=this._ensureCache(e),n=t.getValues(),i=!1;for(let r of n)r.isTrusted||(i=!0,t.remove(r));i&&this._onDidChange.fire()}serializeFontInfo(e){return this._ensureCache(e).getValues().filter(n=>n.isTrusted)}restoreFontInfo(e,t){for(let n of t){if(n.version!==p_)continue;let i=new pu(n,!1);this._writeToCache(e,i,i)}}readFontInfo(e,t){let n=this._ensureCache(e);if(!n.has(t)){let i=this._actualReadFontInfo(e,t);(i.typicalHalfwidthCharacterWidth<=2||i.typicalFullwidthCharacterWidth<=2||i.spaceWidth<=2||i.maxDigitWidth<=2)&&(i=new pu({pixelRatio:ru.getInstance(e).value,fontFamily:i.fontFamily,fontWeight:i.fontWeight,fontSize:i.fontSize,fontFeatureSettings:i.fontFeatureSettings,fontVariationSettings:i.fontVariationSettings,lineHeight:i.lineHeight,letterSpacing:i.letterSpacing,isMonospace:i.isMonospace,typicalHalfwidthCharacterWidth:Math.max(i.typicalHalfwidthCharacterWidth,5),typicalFullwidthCharacterWidth:Math.max(i.typicalFullwidthCharacterWidth,5),canUseHalfwidthRightwardsArrow:i.canUseHalfwidthRightwardsArrow,spaceWidth:Math.max(i.spaceWidth,5),middotWidth:Math.max(i.middotWidth,5),wsmiddotWidth:Math.max(i.wsmiddotWidth,5),maxDigitWidth:Math.max(i.maxDigitWidth,5)},!1)),this._writeToCache(e,t,i)}return n.get(t)}_createRequest(e,t,n,i){let r=new lv(e,t);return n.push(r),i?.push(r),r}_actualReadFontInfo(e,t){let n=[],i=[],r=this._createRequest("n",0,n,i),s=this._createRequest("\uFF4D",0,n,null),a=this._createRequest(" ",0,n,i),l=this._createRequest("0",0,n,i),d=this._createRequest("1",0,n,i),c=this._createRequest("2",0,n,i),u=this._createRequest("3",0,n,i),h=this._createRequest("4",0,n,i),m=this._createRequest("5",0,n,i),f=this._createRequest("6",0,n,i),g=this._createRequest("7",0,n,i),b=this._createRequest("8",0,n,i),y=this._createRequest("9",0,n,i),C=this._createRequest("\u2192",0,n,i),x=this._createRequest("\uFFEB",0,n,null),L=this._createRequest("\xB7",0,n,i),k=this._createRequest("\u2E31",0,n,null),O="|/-_ilm%";for(let q=0,X=O.length;q<X;q++)this._createRequest(O.charAt(q),0,n,i),this._createRequest(O.charAt(q),1,n,i),this._createRequest(O.charAt(q),2,n,i);sM(e,t,n);let W=Math.max(l.width,d.width,c.width,u.width,h.width,m.width,f.width,g.width,b.width,y.width),z=t.fontFeatureSettings===Td.OFF,B=i[0].width;for(let q=1,X=i.length;z&&q<X;q++){let ce=B-i[q].width;if(ce<-.001||ce>.001){z=!1;break}}let G=!0;return z&&x.width!==B&&(G=!1),x.width>C.width&&(G=!1),new pu({pixelRatio:ru.getInstance(e).value,fontFamily:t.fontFamily,fontWeight:t.fontWeight,fontSize:t.fontSize,fontFeatureSettings:t.fontFeatureSettings,fontVariationSettings:t.fontVariationSettings,lineHeight:t.lineHeight,letterSpacing:t.letterSpacing,isMonospace:z,typicalHalfwidthCharacterWidth:r.width,typicalFullwidthCharacterWidth:s.width,canUseHalfwidthRightwardsArrow:G,spaceWidth:a.width,middotWidth:L.width,wsmiddotWidth:k.width,maxDigitWidth:W},!0)}},f_=class{_keys;_values;constructor(){this._keys=Object.create(null),this._values=Object.create(null)}has(e){let t=e.getId();return!!this._values[t]}get(e){let t=e.getId();return this._values[t]}put(e,t){let n=e.getId();this._keys[n]=e,this._values[n]=t}remove(e){let t=e.getId();delete this._keys[t],delete this._values[t]}getValues(){return Object.keys(this._keys).map(e=>this._values[e])}},b_=new g_;var wm=class o{constructor(e,t){this.key=e;this.migrate=t}static items=[];apply(e){let t=o._read(e,this.key),n=r=>o._read(e,r),i=(r,s)=>o._write(e,r,s);this.migrate(t,n,i)}static _read(e,t){if(typeof e>"u")return;let n=t.indexOf(".");if(n>=0){let i=t.substring(0,n);return this._read(e[i],t.substring(n+1))}return e[t]}static _write(e,t,n){let i=t.indexOf(".");if(i>=0){let r=t.substring(0,i);e[r]=e[r]||{},this._write(e[r],t.substring(i+1),n);return}e[t]=n}};function kr(o,e){wm.items.push(new wm(o,e))}function no(o,e){kr(o,(t,n,i)=>{if(typeof t<"u"){for(let[r,s]of e)if(t===r){i(o,s);return}}})}function aM(o){wm.items.forEach(e=>e.apply(o))}no("wordWrap",[[!0,"on"],[!1,"off"]]);no("lineNumbers",[[!0,"on"],[!1,"off"]]);no("cursorBlinking",[["visible","solid"]]);no("renderWhitespace",[[!0,"boundary"],[!1,"none"]]);no("renderLineHighlight",[[!0,"line"],[!1,"none"]]);no("acceptSuggestionOnEnter",[[!0,"on"],[!1,"off"]]);no("tabCompletion",[[!1,"off"],[!0,"onlySnippets"]]);no("hover",[[!0,{enabled:!0}],[!1,{enabled:!1}]]);no("parameterHints",[[!0,{enabled:!0}],[!1,{enabled:!1}]]);no("autoIndent",[[!1,"advanced"],[!0,"full"]]);no("matchBrackets",[[!0,"always"],[!1,"never"]]);no("renderFinalNewline",[[!0,"on"],[!1,"off"]]);no("cursorSmoothCaretAnimation",[[!0,"on"],[!1,"off"]]);no("occurrencesHighlight",[[!0,"singleFile"],[!1,"off"]]);no("wordBasedSuggestions",[[!0,"matchingDocuments"],[!1,"off"]]);kr("autoClosingBrackets",(o,e,t)=>{o===!1&&(t("autoClosingBrackets","never"),typeof e("autoClosingQuotes")>"u"&&t("autoClosingQuotes","never"),typeof e("autoSurround")>"u"&&t("autoSurround","never"))});kr("renderIndentGuides",(o,e,t)=>{typeof o<"u"&&(t("renderIndentGuides",void 0),typeof e("guides.indentation")>"u"&&t("guides.indentation",!!o))});kr("highlightActiveIndentGuide",(o,e,t)=>{typeof o<"u"&&(t("highlightActiveIndentGuide",void 0),typeof e("guides.highlightActiveIndentation")>"u"&&t("guides.highlightActiveIndentation",!!o))});var RW={method:"showMethods",function:"showFunctions",constructor:"showConstructors",deprecated:"showDeprecated",field:"showFields",variable:"showVariables",class:"showClasses",struct:"showStructs",interface:"showInterfaces",module:"showModules",property:"showProperties",event:"showEvents",operator:"showOperators",unit:"showUnits",value:"showValues",constant:"showConstants",enum:"showEnums",enumMember:"showEnumMembers",keyword:"showKeywords",text:"showWords",color:"showColors",file:"showFiles",reference:"showReferences",folder:"showFolders",typeParameter:"showTypeParameters",snippet:"showSnippets"};kr("suggest.filteredTypes",(o,e,t)=>{if(o&&typeof o=="object"){for(let n of Object.entries(RW))o[n[0]]===!1&&typeof e(`suggest.${n[1]}`)>"u"&&t(`suggest.${n[1]}`,!1);t("suggest.filteredTypes",void 0)}});kr("quickSuggestions",(o,e,t)=>{if(typeof o=="boolean"){let n=o?"on":"off";t("quickSuggestions",{comments:n,strings:n,other:n})}});kr("experimental.stickyScroll.enabled",(o,e,t)=>{typeof o=="boolean"&&(t("experimental.stickyScroll.enabled",void 0),typeof e("stickyScroll.enabled")>"u"&&t("stickyScroll.enabled",o))});kr("experimental.stickyScroll.maxLineCount",(o,e,t)=>{typeof o=="number"&&(t("experimental.stickyScroll.maxLineCount",void 0),typeof e("stickyScroll.maxLineCount")>"u"&&t("stickyScroll.maxLineCount",o))});kr("codeActionsOnSave",(o,e,t)=>{if(o&&typeof o=="object"){let n=!1,i={};for(let r of Object.entries(o))typeof r[1]=="boolean"?(n=!0,i[r[0]]=r[1]?"explicit":"never"):i[r[0]]=r[1];n&&t("codeActionsOnSave",i)}});kr("codeActionWidget.includeNearbyQuickfixes",(o,e,t)=>{typeof o=="boolean"&&(t("codeActionWidget.includeNearbyQuickfixes",void 0),typeof e("codeActionWidget.includeNearbyQuickFixes")>"u"&&t("codeActionWidget.includeNearbyQuickFixes",o))});kr("lightbulb.enabled",(o,e,t)=>{typeof o=="boolean"&&t("lightbulb.enabled",o?void 0:"off")});var v_=class{_tabFocus=!1;_onDidChangeTabFocus=new E;onDidChangeTabFocus=this._onDidChangeTabFocus.event;getTabFocusMode(){return this._tabFocus}setTabFocusMode(e){this._tabFocus=e,this._onDidChangeTabFocus.fire(this._tabFocus)}},mu=new v_;var ir=class extends V{_onDidChange=this._register(new E);onDidChange=this._onDidChange.event;_id;_label;_tooltip;_cssClass;_enabled=!0;_checked;_actionCallback;constructor(e,t="",n="",i=!0,r){super(),this._id=e,this._label=t,this._cssClass=n,this._enabled=i,this._actionCallback=r}get id(){return this._id}get label(){return this._label}set label(e){this._setLabel(e)}_setLabel(e){this._label!==e&&(this._label=e,this._onDidChange.fire({label:e}))}get tooltip(){return this._tooltip||""}set tooltip(e){this._setTooltip(e)}_setTooltip(e){this._tooltip!==e&&(this._tooltip=e,this._onDidChange.fire({tooltip:e}))}get class(){return this._cssClass}set class(e){this._setClass(e)}_setClass(e){this._cssClass!==e&&(this._cssClass=e,this._onDidChange.fire({class:e}))}get enabled(){return this._enabled}set enabled(e){this._setEnabled(e)}_setEnabled(e){this._enabled!==e&&(this._enabled=e,this._onDidChange.fire({enabled:e}))}get checked(){return this._checked}set checked(e){this._setChecked(e)}_setChecked(e){this._checked!==e&&(this._checked=e,this._onDidChange.fire({checked:e}))}async run(e,t){this._actionCallback&&await this._actionCallback(e)}},jo=class extends V{_onWillRun=this._register(new E);onWillRun=this._onWillRun.event;_onDidRun=this._register(new E);onDidRun=this._onDidRun.event;async run(e,t){if(!e.enabled)return;this._onWillRun.fire({action:e});let n;try{await this.runAction(e,t)}catch(i){n=i}this._onDidRun.fire({action:e,error:n})}async runAction(e,t){await e.run(t)}},In=class o{static join(...e){let t=[];for(let n of e)n.length&&(t.length?t=[...t,new o,...n]:t=n);return t}static ID="vs.actions.separator";id=o.ID;label="";tooltip="";class="separator";enabled=!1;checked=!1;async run(){}},sa=class{id;label;class;tooltip="";enabled=!0;checked=void 0;_actions;get actions(){return this._actions}constructor(e,t,n,i){this.id=e,this.label=t,this.class=i,this._actions=n}async run(){}};function wi(o){return{id:o.id,label:o.label,tooltip:o.tooltip??o.label,class:o.class,enabled:o.enabled??!0,checked:o.checked,run:async(...e)=>o.run(...e)}}var vY=Object.freeze({View:Xl("view","View"),Help:Xl("help","Help"),Test:Xl("test","Test"),File:Xl("file","File"),Preferences:Xl("preferences","Preferences"),Developer:Xl({key:"developer",comment:["A developer on Code itself or someone diagnosing issues in Code"]},"Developer")});var or=Y("commandService"),Rr=new class{_commands=new Map;_onDidRegisterCommand=new E;onDidRegisterCommand=this._onDidRegisterCommand.event;registerCommand(o,e){if(!o)throw new Error("invalid command");if(typeof o=="string"){if(!e)throw new Error("invalid command");return this.registerCommand({id:o,handler:e})}if(o.metadata&&Array.isArray(o.metadata.args)){let s=[];for(let l of o.metadata.args)s.push(l.constraint);let a=o.handler;o.handler=function(l,...d){return Dk(d,s),a(l,...d)}}let{id:t}=o,n=this._commands.get(t);n||(n=new ui,this._commands.set(t,n));let i=n.unshift(o),r=ve(()=>{i(),this._commands.get(t)?.isEmpty()&&this._commands.delete(t)});return this._onDidRegisterCommand.fire(t),r}registerCommandAlias(o,e){return Rr.registerCommand(o,(t,...n)=>t.get(or).executeCommand(e,...n))}getCommand(o){let e=this._commands.get(o);if(!(!e||e.isEmpty()))return bo.first(e)}getCommands(){let o=new Map;for(let e of this._commands.keys()){let t=this.getCommand(e);t&&o.set(e,t)}return o}};Rr.registerCommand("noop",()=>{});function lM(o){return o?o.condition!==void 0:!1}var y_=class o{_coreKeybindings;_extensionKeybindings;_cachedMergedKeybindings;constructor(){this._coreKeybindings=new ui,this._extensionKeybindings=[],this._cachedMergedKeybindings=null}static bindToCurrentPlatform(e){if(Zo===1){if(e&&e.win)return e.win}else if(Zo===2){if(e&&e.mac)return e.mac}else if(e&&e.linux)return e.linux;return e}registerKeybindingRule(e){let t=o.bindToCurrentPlatform(e),n=new he;if(t&&t.primary){let i=Ix(t.primary,Zo);i&&n.add(this._registerDefaultKeybinding(i,e.id,e.args,e.weight,0,e.when))}if(t&&Array.isArray(t.secondary))for(let i=0,r=t.secondary.length;i<r;i++){let s=t.secondary[i],a=Ix(s,Zo);a&&n.add(this._registerDefaultKeybinding(a,e.id,e.args,e.weight,-i-1,e.when))}return n}setExtensionKeybindings(e){let t=[],n=0;for(let i of e)i.keybinding&&(t[n++]={keybinding:i.keybinding,command:i.id,commandArgs:i.args,when:i.when,weight1:i.weight,weight2:0,extensionId:i.extensionId||null,isBuiltinExtension:i.isBuiltinExtension||!1});this._extensionKeybindings=t,this._cachedMergedKeybindings=null}registerCommandAndKeybindingRule(e){return yr(this.registerKeybindingRule(e),Rr.registerCommand(e))}_registerDefaultKeybinding(e,t,n,i,r,s){let a=this._coreKeybindings.push({keybinding:e,command:t,commandArgs:n,when:s,weight1:i,weight2:r,extensionId:null,isBuiltinExtension:!1});return this._cachedMergedKeybindings=null,ve(()=>{a(),this._cachedMergedKeybindings=null})}getDefaultKeybindings(){return this._cachedMergedKeybindings||(this._cachedMergedKeybindings=Array.from(this._coreKeybindings).concat(this._extensionKeybindings),this._cachedMergedKeybindings.sort(AW)),this._cachedMergedKeybindings.slice(0)}},aa=new y_,MW={EditorModes:"platform.keybindingsRegistry"};et.add(MW.EditorModes,aa);function AW(o,e){if(o.weight1!==e.weight1)return o.weight1-e.weight1;if(o.command&&e.command){if(o.command<e.command)return-1;if(o.command>e.command)return 1}return o.weight2-e.weight2}function gu(o){return o.command!==void 0}function dM(o){return o.submenu!==void 0}var Ln=class o{static _instances=new Map;static CommandPalette=new o("CommandPalette");static DebugBreakpointsContext=new o("DebugBreakpointsContext");static DebugCallStackContext=new o("DebugCallStackContext");static DebugConsoleContext=new o("DebugConsoleContext");static DebugVariablesContext=new o("DebugVariablesContext");static NotebookVariablesContext=new o("NotebookVariablesContext");static DebugHoverContext=new o("DebugHoverContext");static DebugWatchContext=new o("DebugWatchContext");static DebugToolBar=new o("DebugToolBar");static DebugToolBarStop=new o("DebugToolBarStop");static DebugCallStackToolbar=new o("DebugCallStackToolbar");static DebugCreateConfiguration=new o("DebugCreateConfiguration");static EditorContext=new o("EditorContext");static SimpleEditorContext=new o("SimpleEditorContext");static EditorContent=new o("EditorContent");static EditorLineNumberContext=new o("EditorLineNumberContext");static EditorContextCopy=new o("EditorContextCopy");static EditorContextPeek=new o("EditorContextPeek");static EditorContextShare=new o("EditorContextShare");static EditorTitle=new o("EditorTitle");static EditorTitleRun=new o("EditorTitleRun");static EditorTitleContext=new o("EditorTitleContext");static EditorTitleContextShare=new o("EditorTitleContextShare");static EmptyEditorGroup=new o("EmptyEditorGroup");static EmptyEditorGroupContext=new o("EmptyEditorGroupContext");static EditorTabsBarContext=new o("EditorTabsBarContext");static EditorTabsBarShowTabsSubmenu=new o("EditorTabsBarShowTabsSubmenu");static EditorTabsBarShowTabsZenModeSubmenu=new o("EditorTabsBarShowTabsZenModeSubmenu");static EditorActionsPositionSubmenu=new o("EditorActionsPositionSubmenu");static ExplorerContext=new o("ExplorerContext");static ExplorerContextShare=new o("ExplorerContextShare");static ExtensionContext=new o("ExtensionContext");static ExtensionEditorContextMenu=new o("ExtensionEditorContextMenu");static GlobalActivity=new o("GlobalActivity");static CommandCenter=new o("CommandCenter");static CommandCenterCenter=new o("CommandCenterCenter");static LayoutControlMenuSubmenu=new o("LayoutControlMenuSubmenu");static LayoutControlMenu=new o("LayoutControlMenu");static MenubarMainMenu=new o("MenubarMainMenu");static MenubarAppearanceMenu=new o("MenubarAppearanceMenu");static MenubarDebugMenu=new o("MenubarDebugMenu");static MenubarEditMenu=new o("MenubarEditMenu");static MenubarCopy=new o("MenubarCopy");static MenubarFileMenu=new o("MenubarFileMenu");static MenubarGoMenu=new o("MenubarGoMenu");static MenubarHelpMenu=new o("MenubarHelpMenu");static MenubarLayoutMenu=new o("MenubarLayoutMenu");static MenubarNewBreakpointMenu=new o("MenubarNewBreakpointMenu");static PanelAlignmentMenu=new o("PanelAlignmentMenu");static PanelPositionMenu=new o("PanelPositionMenu");static ActivityBarPositionMenu=new o("ActivityBarPositionMenu");static MenubarPreferencesMenu=new o("MenubarPreferencesMenu");static MenubarRecentMenu=new o("MenubarRecentMenu");static MenubarSelectionMenu=new o("MenubarSelectionMenu");static MenubarShare=new o("MenubarShare");static MenubarSwitchEditorMenu=new o("MenubarSwitchEditorMenu");static MenubarSwitchGroupMenu=new o("MenubarSwitchGroupMenu");static MenubarTerminalMenu=new o("MenubarTerminalMenu");static MenubarViewMenu=new o("MenubarViewMenu");static MenubarHomeMenu=new o("MenubarHomeMenu");static OpenEditorsContext=new o("OpenEditorsContext");static OpenEditorsContextShare=new o("OpenEditorsContextShare");static ProblemsPanelContext=new o("ProblemsPanelContext");static SCMInputBox=new o("SCMInputBox");static SCMChangesContext=new o("SCMChangesContext");static SCMChangeContext=new o("SCMChangeContext");static SCMResourceContext=new o("SCMResourceContext");static SCMResourceContextShare=new o("SCMResourceContextShare");static SCMResourceFolderContext=new o("SCMResourceFolderContext");static SCMResourceGroupContext=new o("SCMResourceGroupContext");static SCMSourceControl=new o("SCMSourceControl");static SCMSourceControlInline=new o("SCMSourceControlInline");static SCMSourceControlTitle=new o("SCMSourceControlTitle");static SCMHistoryTitle=new o("SCMHistoryTitle");static SCMTitle=new o("SCMTitle");static SearchContext=new o("SearchContext");static SearchActionMenu=new o("SearchActionContext");static StatusBarWindowIndicatorMenu=new o("StatusBarWindowIndicatorMenu");static StatusBarRemoteIndicatorMenu=new o("StatusBarRemoteIndicatorMenu");static StickyScrollContext=new o("StickyScrollContext");static TestItem=new o("TestItem");static TestItemGutter=new o("TestItemGutter");static TestProfilesContext=new o("TestProfilesContext");static TestMessageContext=new o("TestMessageContext");static TestMessageContent=new o("TestMessageContent");static TestPeekElement=new o("TestPeekElement");static TestPeekTitle=new o("TestPeekTitle");static TestCallStack=new o("TestCallStack");static TouchBarContext=new o("TouchBarContext");static TitleBarContext=new o("TitleBarContext");static TitleBarTitleContext=new o("TitleBarTitleContext");static TunnelContext=new o("TunnelContext");static TunnelPrivacy=new o("TunnelPrivacy");static TunnelProtocol=new o("TunnelProtocol");static TunnelPortInline=new o("TunnelInline");static TunnelTitle=new o("TunnelTitle");static TunnelLocalAddressInline=new o("TunnelLocalAddressInline");static TunnelOriginInline=new o("TunnelOriginInline");static ViewItemContext=new o("ViewItemContext");static ViewContainerTitle=new o("ViewContainerTitle");static ViewContainerTitleContext=new o("ViewContainerTitleContext");static ViewTitle=new o("ViewTitle");static ViewTitleContext=new o("ViewTitleContext");static CommentEditorActions=new o("CommentEditorActions");static CommentThreadTitle=new o("CommentThreadTitle");static CommentThreadActions=new o("CommentThreadActions");static CommentThreadAdditionalActions=new o("CommentThreadAdditionalActions");static CommentThreadTitleContext=new o("CommentThreadTitleContext");static CommentThreadCommentContext=new o("CommentThreadCommentContext");static CommentTitle=new o("CommentTitle");static CommentActions=new o("CommentActions");static CommentsViewThreadActions=new o("CommentsViewThreadActions");static InteractiveToolbar=new o("InteractiveToolbar");static InteractiveCellTitle=new o("InteractiveCellTitle");static InteractiveCellDelete=new o("InteractiveCellDelete");static InteractiveCellExecute=new o("InteractiveCellExecute");static InteractiveInputExecute=new o("InteractiveInputExecute");static InteractiveInputConfig=new o("InteractiveInputConfig");static ReplInputExecute=new o("ReplInputExecute");static IssueReporter=new o("IssueReporter");static NotebookToolbar=new o("NotebookToolbar");static NotebookStickyScrollContext=new o("NotebookStickyScrollContext");static NotebookCellTitle=new o("NotebookCellTitle");static NotebookCellDelete=new o("NotebookCellDelete");static NotebookCellInsert=new o("NotebookCellInsert");static NotebookCellBetween=new o("NotebookCellBetween");static NotebookCellListTop=new o("NotebookCellTop");static NotebookCellExecute=new o("NotebookCellExecute");static NotebookCellExecuteGoTo=new o("NotebookCellExecuteGoTo");static NotebookCellExecutePrimary=new o("NotebookCellExecutePrimary");static NotebookDiffCellInputTitle=new o("NotebookDiffCellInputTitle");static NotebookDiffCellMetadataTitle=new o("NotebookDiffCellMetadataTitle");static NotebookDiffCellOutputsTitle=new o("NotebookDiffCellOutputsTitle");static NotebookOutputToolbar=new o("NotebookOutputToolbar");static NotebookOutlineFilter=new o("NotebookOutlineFilter");static NotebookOutlineActionMenu=new o("NotebookOutlineActionMenu");static NotebookEditorLayoutConfigure=new o("NotebookEditorLayoutConfigure");static NotebookKernelSource=new o("NotebookKernelSource");static BulkEditTitle=new o("BulkEditTitle");static BulkEditContext=new o("BulkEditContext");static TimelineItemContext=new o("TimelineItemContext");static TimelineTitle=new o("TimelineTitle");static TimelineTitleContext=new o("TimelineTitleContext");static TimelineFilterSubMenu=new o("TimelineFilterSubMenu");static AccountsContext=new o("AccountsContext");static SidebarTitle=new o("SidebarTitle");static PanelTitle=new o("PanelTitle");static AuxiliaryBarTitle=new o("AuxiliaryBarTitle");static AuxiliaryBarHeader=new o("AuxiliaryBarHeader");static TerminalInstanceContext=new o("TerminalInstanceContext");static TerminalEditorInstanceContext=new o("TerminalEditorInstanceContext");static TerminalNewDropdownContext=new o("TerminalNewDropdownContext");static TerminalTabContext=new o("TerminalTabContext");static TerminalTabEmptyAreaContext=new o("TerminalTabEmptyAreaContext");static TerminalStickyScrollContext=new o("TerminalStickyScrollContext");static WebviewContext=new o("WebviewContext");static InlineCompletionsActions=new o("InlineCompletionsActions");static InlineEditsActions=new o("InlineEditsActions");static InlineEditActions=new o("InlineEditActions");static NewFile=new o("NewFile");static MergeInput1Toolbar=new o("MergeToolbar1Toolbar");static MergeInput2Toolbar=new o("MergeToolbar2Toolbar");static MergeBaseToolbar=new o("MergeBaseToolbar");static MergeInputResultToolbar=new o("MergeToolbarResultToolbar");static InlineSuggestionToolbar=new o("InlineSuggestionToolbar");static InlineEditToolbar=new o("InlineEditToolbar");static ChatContext=new o("ChatContext");static ChatCodeBlock=new o("ChatCodeblock");static ChatCompareBlock=new o("ChatCompareBlock");static ChatMessageTitle=new o("ChatMessageTitle");static ChatExecute=new o("ChatExecute");static ChatExecuteSecondary=new o("ChatExecuteSecondary");static ChatInputSide=new o("ChatInputSide");static AccessibleView=new o("AccessibleView");static MultiDiffEditorFileToolbar=new o("MultiDiffEditorFileToolbar");static DiffEditorHunkToolbar=new o("DiffEditorHunkToolbar");static DiffEditorSelectionToolbar=new o("DiffEditorSelectionToolbar");static for(e){return o._instances.get(e)??new o(e)}id;constructor(e){if(o._instances.has(e))throw new TypeError(`MenuId with identifier '${e}' already exists. Use MenuId.for(ident) or a unique identifier`);o._instances.set(e,this),this.id=e}},kd=Y("menuService"),Dd=class o{constructor(e){this.id=e;this.has=t=>t===e}static _all=new Map;static for(e){let t=this._all.get(e);return t||(t=new o(e),this._all.set(e,t)),t}static merge(e){let t=new Set;for(let n of e)n instanceof o&&t.add(n.id);return t}has},hl=new class{_commands=new Map;_menuItems=new Map;_onDidChangeMenu=new $f({merge:Dd.merge});onDidChangeMenu=this._onDidChangeMenu.event;addCommand(o){return this._commands.set(o.id,o),this._onDidChangeMenu.fire(Dd.for(Ln.CommandPalette)),ve(()=>{this._commands.delete(o.id)&&this._onDidChangeMenu.fire(Dd.for(Ln.CommandPalette))})}getCommand(o){return this._commands.get(o)}getCommands(){let o=new Map;return this._commands.forEach((e,t)=>o.set(t,e)),o}appendMenuItem(o,e){let t=this._menuItems.get(o);t||(t=new ui,this._menuItems.set(o,t));let n=t.push(e);return this._onDidChangeMenu.fire(Dd.for(o)),ve(()=>{n(),this._onDidChangeMenu.fire(Dd.for(o))})}appendMenuItems(o){let e=new he;for(let{id:t,item:n}of o)e.add(this.appendMenuItem(t,n));return e}getMenuItems(o){let e;return this._menuItems.has(o)?e=[...this._menuItems.get(o)]:e=[],o===Ln.CommandPalette&&this._appendImplicitItems(e),e}_appendImplicitItems(o){let e=new Set;for(let t of o)gu(t)&&(e.add(t.command.id),t.alt&&e.add(t.alt.id));this._commands.forEach((t,n)=>{e.has(n)||o.push({command:t})})}},Fi=class extends sa{constructor(t,n,i){super(`submenuitem.${t.submenu.id}`,typeof t.title=="string"?t.title:t.title.value,i,"submenu");this.item=t;this.hideActions=n}},xi=class{constructor(e,t,n,i,r,s,a){this.hideActions=i;this.menuKeybinding=r;this._commandService=a;this.id=e.id,this.label=xi.label(e,n),this.tooltip=(typeof e.tooltip=="string"?e.tooltip:e.tooltip?.value)??"",this.enabled=!e.precondition||s.contextMatchesRules(e.precondition),this.checked=void 0;let l;if(e.toggled){let d=e.toggled.condition?e.toggled:{condition:e.toggled};this.checked=s.contextMatchesRules(d.condition),this.checked&&d.tooltip&&(this.tooltip=typeof d.tooltip=="string"?d.tooltip:d.tooltip.value),this.checked&&Je.isThemeIcon(d.icon)&&(l=d.icon),this.checked&&d.title&&(this.label=typeof d.title=="string"?d.title:d.title.value)}l||(l=Je.isThemeIcon(e.icon)?e.icon:void 0),this.item=e,this.alt=t?new xi(t,void 0,n,i,void 0,s,a):void 0,this._options=n,this.class=l&&Je.asClassName(l)}static label(e,t){return t?.renderShortTitle&&e.shortTitle?typeof e.shortTitle=="string"?e.shortTitle:e.shortTitle.value:typeof e.title=="string"?e.title:e.title.value}item;alt;_options;id;label;tooltip;class;enabled;checked;run(...e){let t=[];return this._options?.arg&&(t=[...t,this._options.arg]),this._options?.shouldForwardArgs&&(t=[...t,...e]),this._commandService.executeCommand(this.id,...t)}};xi=R([S(5,ft),S(6,or)],xi);var fu=class extends V{constructor(t,n,i,r,s){super();this._accessibilityService=s;this.isSimpleWidget=t,this.contextMenuId=n,this._containerObserver=this._register(new Nb(r,i.dimension)),this._targetWindowId=Ie(r).vscodeWindowId,this._rawOptions=cM(i),this._validatedOptions=Rd.validateOptions(this._rawOptions),this.options=this._computeOptions(),this.options.get(13)&&this._containerObserver.startObserving(),this._register(ys.onDidChangeZoomLevel(()=>this._recomputeOptions())),this._register(mu.onDidChangeTabFocus(()=>this._recomputeOptions())),this._register(this._containerObserver.onDidChange(()=>this._recomputeOptions())),this._register(b_.onDidChange(()=>this._recomputeOptions())),this._register(ru.getInstance(Ie(r)).onDidChange(()=>this._recomputeOptions())),this._register(this._accessibilityService.onDidChangeScreenReaderOptimized(()=>this._recomputeOptions()))}_onDidChange=this._register(new E);onDidChange=this._onDidChange.event;_onDidChangeFast=this._register(new E);onDidChangeFast=this._onDidChangeFast.event;isSimpleWidget;contextMenuId;_containerObserver;_isDominatedByLongLines=!1;_viewLineCount=1;_lineNumbersDigitCount=1;_reservedHeight=0;_glyphMarginDecorationLaneCount=1;_targetWindowId;_computeOptionsMemory=new Im;_rawOptions;_validatedOptions;options;_recomputeOptions(){let t=this._computeOptions(),n=Rd.checkEquals(this.options,t);n!==null&&(this.options=t,this._onDidChangeFast.fire(n),this._onDidChange.fire(n))}_computeOptions(){let t=this._readEnvConfiguration(),n=Sm.createFromValidatedSettings(this._validatedOptions,t.pixelRatio,this.isSimpleWidget),i=this._readFontInfo(n),r={memory:this._computeOptionsMemory,outerWidth:t.outerWidth,outerHeight:t.outerHeight-this._reservedHeight,fontInfo:i,extraEditorClassName:t.extraEditorClassName,isDominatedByLongLines:this._isDominatedByLongLines,viewLineCount:this._viewLineCount,lineNumbersDigitCount:this._lineNumbersDigitCount,emptySelectionClipboard:t.emptySelectionClipboard,pixelRatio:t.pixelRatio,tabFocusMode:mu.getTabFocusMode(),accessibilitySupport:t.accessibilitySupport,glyphMarginDecorationLaneCount:this._glyphMarginDecorationLaneCount};return Rd.computeOptions(this._validatedOptions,r)}_readEnvConfiguration(){return{extraEditorClassName:NW(),outerWidth:this._containerObserver.getWidth(),outerHeight:this._containerObserver.getHeight(),emptySelectionClipboard:Sr||sn,pixelRatio:ru.getInstance(fd(this._targetWindowId,!0).window).value,accessibilitySupport:this._accessibilityService.isScreenReaderOptimized()?2:this._accessibilityService.getAccessibilitySupport()}}_readFontInfo(t){return b_.readFontInfo(fd(this._targetWindowId,!0).window,t)}getRawOptions(){return this._rawOptions}updateOptions(t){let n=cM(t);Rd.applyUpdate(this._rawOptions,n)&&(this._validatedOptions=Rd.validateOptions(this._rawOptions),this._recomputeOptions())}observeContainer(t){this._containerObserver.observe(t)}setIsDominatedByLongLines(t){this._isDominatedByLongLines!==t&&(this._isDominatedByLongLines=t,this._recomputeOptions())}setModelLineCount(t){let n=OW(t);this._lineNumbersDigitCount!==n&&(this._lineNumbersDigitCount=n,this._recomputeOptions())}setViewLineCount(t){this._viewLineCount!==t&&(this._viewLineCount=t,this._recomputeOptions())}setReservedHeight(t){this._reservedHeight!==t&&(this._reservedHeight=t,this._recomputeOptions())}setGlyphMarginDecorationLaneCount(t){this._glyphMarginDecorationLaneCount!==t&&(this._glyphMarginDecorationLaneCount=t,this._recomputeOptions())}};fu=R([S(4,Co)],fu);function OW(o){let e=0;for(;o;)o=Math.floor(o/10),e++;return e||1}function NW(){let o="";return!Xi&&!fk&&(o+="no-user-select "),Xi&&(o+="no-minimap-shadow ",o+="enable-user-select "),Be&&(o+="mac "),o}var I_=class{_values=[];_read(e){return this._values[e]}get(e){return this._values[e]}_write(e,t){this._values[e]=t}},C_=class{_values=[];_read(e){if(e>=this._values.length)throw new Error("Cannot read uninitialized value");return this._values[e]}get(e){return this._read(e)}_write(e,t){this._values[e]=t}},Rd=class o{static validateOptions(e){let t=new I_;for(let n of hu){let i=n.name==="_never_"?void 0:e[n.name];t._write(n.id,n.validate(i))}return t}static computeOptions(e,t){let n=new C_;for(let i of hu)n._write(i.id,i.compute(t,n,e._read(i.id)));return n}static _deepEquals(e,t){if(typeof e!="object"||typeof t!="object"||!e||!t)return e===t;if(Array.isArray(e)||Array.isArray(t))return Array.isArray(e)&&Array.isArray(t)?on(e,t):!1;if(Object.keys(e).length!==Object.keys(t).length)return!1;for(let n in e)if(!o._deepEquals(e[n],t[n]))return!1;return!0}static checkEquals(e,t){let n=[],i=!1;for(let r of hu){let s=!o._deepEquals(e._read(r.id),t._read(r.id));n[r.id]=s,s&&(i=!0)}return i?new rv(n):null}static applyUpdate(e,t){let n=!1;for(let i of hu)if(t.hasOwnProperty(i.name)){let r=i.applyUpdate(e[i.name],t[i.name]);e[i.name]=r.newValue,n=n||r.didChange}return n}};function cM(o){let e=ou(o);return aM(e),e}var P=class o{lineNumber;column;constructor(e,t){this.lineNumber=e,this.column=t}with(e=this.lineNumber,t=this.column){return e===this.lineNumber&&t===this.column?this:new o(e,t)}delta(e=0,t=0){return this.with(this.lineNumber+e,this.column+t)}equals(e){return o.equals(this,e)}static equals(e,t){return!e&&!t?!0:!!e&&!!t&&e.lineNumber===t.lineNumber&&e.column===t.column}isBefore(e){return o.isBefore(this,e)}static isBefore(e,t){return e.lineNumber<t.lineNumber?!0:t.lineNumber<e.lineNumber?!1:e.column<t.column}isBeforeOrEqual(e){return o.isBeforeOrEqual(this,e)}static isBeforeOrEqual(e,t){return e.lineNumber<t.lineNumber?!0:t.lineNumber<e.lineNumber?!1:e.column<=t.column}static compare(e,t){let n=e.lineNumber|0,i=t.lineNumber|0;if(n===i){let r=e.column|0,s=t.column|0;return r-s}return n-i}clone(){return new o(this.lineNumber,this.column)}toString(){return"("+this.lineNumber+","+this.column+")"}static lift(e){return new o(e.lineNumber,e.column)}static isIPosition(e){return e&&typeof e.lineNumber=="number"&&typeof e.column=="number"}toJSON(){return{lineNumber:this.lineNumber,column:this.column}}};var D=class o{startLineNumber;startColumn;endLineNumber;endColumn;constructor(e,t,n,i){e>n||e===n&&t>i?(this.startLineNumber=n,this.startColumn=i,this.endLineNumber=e,this.endColumn=t):(this.startLineNumber=e,this.startColumn=t,this.endLineNumber=n,this.endColumn=i)}isEmpty(){return o.isEmpty(this)}static isEmpty(e){return e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn}containsPosition(e){return o.containsPosition(this,e)}static containsPosition(e,t){return!(t.lineNumber<e.startLineNumber||t.lineNumber>e.endLineNumber||t.lineNumber===e.startLineNumber&&t.column<e.startColumn||t.lineNumber===e.endLineNumber&&t.column>e.endColumn)}static strictContainsPosition(e,t){return!(t.lineNumber<e.startLineNumber||t.lineNumber>e.endLineNumber||t.lineNumber===e.startLineNumber&&t.column<=e.startColumn||t.lineNumber===e.endLineNumber&&t.column>=e.endColumn)}containsRange(e){return o.containsRange(this,e)}static containsRange(e,t){return!(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber||t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber||t.startLineNumber===e.startLineNumber&&t.startColumn<e.startColumn||t.endLineNumber===e.endLineNumber&&t.endColumn>e.endColumn)}strictContainsRange(e){return o.strictContainsRange(this,e)}static strictContainsRange(e,t){return!(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber||t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber||t.startLineNumber===e.startLineNumber&&t.startColumn<=e.startColumn||t.endLineNumber===e.endLineNumber&&t.endColumn>=e.endColumn)}plusRange(e){return o.plusRange(this,e)}static plusRange(e,t){let n,i,r,s;return t.startLineNumber<e.startLineNumber?(n=t.startLineNumber,i=t.startColumn):t.startLineNumber===e.startLineNumber?(n=t.startLineNumber,i=Math.min(t.startColumn,e.startColumn)):(n=e.startLineNumber,i=e.startColumn),t.endLineNumber>e.endLineNumber?(r=t.endLineNumber,s=t.endColumn):t.endLineNumber===e.endLineNumber?(r=t.endLineNumber,s=Math.max(t.endColumn,e.endColumn)):(r=e.endLineNumber,s=e.endColumn),new o(n,i,r,s)}intersectRanges(e){return o.intersectRanges(this,e)}static intersectRanges(e,t){let n=e.startLineNumber,i=e.startColumn,r=e.endLineNumber,s=e.endColumn,a=t.startLineNumber,l=t.startColumn,d=t.endLineNumber,c=t.endColumn;return n<a?(n=a,i=l):n===a&&(i=Math.max(i,l)),r>d?(r=d,s=c):r===d&&(s=Math.min(s,c)),n>r||n===r&&i>s?null:new o(n,i,r,s)}equalsRange(e){return o.equalsRange(this,e)}static equalsRange(e,t){return!e&&!t?!0:!!e&&!!t&&e.startLineNumber===t.startLineNumber&&e.startColumn===t.startColumn&&e.endLineNumber===t.endLineNumber&&e.endColumn===t.endColumn}getEndPosition(){return o.getEndPosition(this)}static getEndPosition(e){return new P(e.endLineNumber,e.endColumn)}getStartPosition(){return o.getStartPosition(this)}static getStartPosition(e){return new P(e.startLineNumber,e.startColumn)}toString(){return"["+this.startLineNumber+","+this.startColumn+" -> "+this.endLineNumber+","+this.endColumn+"]"}setEndPosition(e,t){return new o(this.startLineNumber,this.startColumn,e,t)}setStartPosition(e,t){return new o(e,t,this.endLineNumber,this.endColumn)}collapseToStart(){return o.collapseToStart(this)}static collapseToStart(e){return new o(e.startLineNumber,e.startColumn,e.startLineNumber,e.startColumn)}collapseToEnd(){return o.collapseToEnd(this)}static collapseToEnd(e){return new o(e.endLineNumber,e.endColumn,e.endLineNumber,e.endColumn)}delta(e){return new o(this.startLineNumber+e,this.startColumn,this.endLineNumber+e,this.endColumn)}static fromPositions(e,t=e){return new o(e.lineNumber,e.column,t.lineNumber,t.column)}static lift(e){return e?new o(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn):null}static isIRange(e){return e&&typeof e.startLineNumber=="number"&&typeof e.startColumn=="number"&&typeof e.endLineNumber=="number"&&typeof e.endColumn=="number"}static areIntersectingOrTouching(e,t){return!(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<t.startColumn||t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<e.startColumn)}static areIntersecting(e,t){return!(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<=t.startColumn||t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<=e.startColumn)}static compareRangesUsingStarts(e,t){if(e&&t){let r=e.startLineNumber|0,s=t.startLineNumber|0;if(r===s){let a=e.startColumn|0,l=t.startColumn|0;if(a===l){let d=e.endLineNumber|0,c=t.endLineNumber|0;if(d===c){let u=e.endColumn|0,h=t.endColumn|0;return u-h}return d-c}return a-l}return r-s}return(e?1:0)-(t?1:0)}static compareRangesUsingEnds(e,t){return e.endLineNumber===t.endLineNumber?e.endColumn===t.endColumn?e.startLineNumber===t.startLineNumber?e.startColumn-t.startColumn:e.startLineNumber-t.startLineNumber:e.endColumn-t.endColumn:e.endLineNumber-t.endLineNumber}static spansMultipleLines(e){return e.endLineNumber>e.startLineNumber}toJSON(){return this}};var He=class o extends D{selectionStartLineNumber;selectionStartColumn;positionLineNumber;positionColumn;constructor(e,t,n,i){super(e,t,n,i),this.selectionStartLineNumber=e,this.selectionStartColumn=t,this.positionLineNumber=n,this.positionColumn=i}toString(){return"["+this.selectionStartLineNumber+","+this.selectionStartColumn+" -> "+this.positionLineNumber+","+this.positionColumn+"]"}equalsSelection(e){return o.selectionsEqual(this,e)}static selectionsEqual(e,t){return e.selectionStartLineNumber===t.selectionStartLineNumber&&e.selectionStartColumn===t.selectionStartColumn&&e.positionLineNumber===t.positionLineNumber&&e.positionColumn===t.positionColumn}getDirection(){return this.selectionStartLineNumber===this.startLineNumber&&this.selectionStartColumn===this.startColumn?0:1}setEndPosition(e,t){return this.getDirection()===0?new o(this.startLineNumber,this.startColumn,e,t):new o(e,t,this.startLineNumber,this.startColumn)}getPosition(){return new P(this.positionLineNumber,this.positionColumn)}getSelectionStart(){return new P(this.selectionStartLineNumber,this.selectionStartColumn)}setStartPosition(e,t){return this.getDirection()===0?new o(e,t,this.endLineNumber,this.endColumn):new o(this.endLineNumber,this.endColumn,e,t)}static fromPositions(e,t=e){return new o(e.lineNumber,e.column,t.lineNumber,t.column)}static fromRange(e,t){return t===0?new o(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn):new o(e.endLineNumber,e.endColumn,e.startLineNumber,e.startColumn)}static liftSelection(e){return new o(e.selectionStartLineNumber,e.selectionStartColumn,e.positionLineNumber,e.positionColumn)}static selectionsArrEqual(e,t){if(e&&!t||!e&&t)return!1;if(!e&&!t)return!0;if(e.length!==t.length)return!1;for(let n=0,i=e.length;n<i;n++)if(!this.selectionsEqual(e[n],t[n]))return!1;return!0}static isISelection(e){return e&&typeof e.selectionStartLineNumber=="number"&&typeof e.selectionStartColumn=="number"&&typeof e.positionLineNumber=="number"&&typeof e.positionColumn=="number"}static createWithDirection(e,t,n,i,r){return r===0?new o(e,t,n,i):new o(n,i,e,t)}};var Pt=class o{constructor(e,t){this.start=e;this.endExclusive=t;if(e>t)throw new Qe(`Invalid range: ${this.toString()}`)}static addRange(e,t){let n=0;for(;n<t.length&&t[n].endExclusive<e.start;)n++;let i=n;for(;i<t.length&&t[i].start<=e.endExclusive;)i++;if(n===i)t.splice(n,0,e);else{let r=Math.min(e.start,t[n].start),s=Math.max(e.endExclusive,t[i-1].endExclusive);t.splice(n,i-n,new o(r,s))}}static tryCreate(e,t){if(!(e>t))return new o(e,t)}static ofLength(e){return new o(0,e)}static ofStartAndLength(e,t){return new o(e,e+t)}static emptyAt(e){return new o(e,e)}get isEmpty(){return this.start===this.endExclusive}delta(e){return new o(this.start+e,this.endExclusive+e)}deltaStart(e){return new o(this.start+e,this.endExclusive)}deltaEnd(e){return new o(this.start,this.endExclusive+e)}get length(){return this.endExclusive-this.start}toString(){return`[${this.start}, ${this.endExclusive})`}equals(e){return this.start===e.start&&this.endExclusive===e.endExclusive}containsRange(e){return this.start<=e.start&&e.endExclusive<=this.endExclusive}contains(e){return this.start<=e&&e<this.endExclusive}join(e){return new o(Math.min(this.start,e.start),Math.max(this.endExclusive,e.endExclusive))}intersect(e){let t=Math.max(this.start,e.start),n=Math.min(this.endExclusive,e.endExclusive);if(t<=n)return new o(t,n)}intersectionLength(e){let t=Math.max(this.start,e.start),n=Math.min(this.endExclusive,e.endExclusive);return Math.max(0,n-t)}intersects(e){let t=Math.max(this.start,e.start),n=Math.min(this.endExclusive,e.endExclusive);return t<n}intersectsOrTouches(e){let t=Math.max(this.start,e.start),n=Math.min(this.endExclusive,e.endExclusive);return t<=n}isBefore(e){return this.endExclusive<=e.start}isAfter(e){return this.start>=e.endExclusive}slice(e){return e.slice(this.start,this.endExclusive)}substring(e){return e.substring(this.start,this.endExclusive)}clip(e){if(this.isEmpty)throw new Qe(`Invalid clipping range: ${this.toString()}`);return Math.max(this.start,Math.min(this.endExclusive-1,e))}clipCyclic(e){if(this.isEmpty)throw new Qe(`Invalid clipping range: ${this.toString()}`);return e<this.start?this.endExclusive-(this.start-e)%this.length:e>=this.endExclusive?this.start+(e-this.start)%this.length:e}map(e){let t=[];for(let n=this.start;n<this.endExclusive;n++)t.push(e(n));return t}forEach(e){for(let t=this.start;t<this.endExclusive;t++)e(t)}};var Ei=class o{static fromRange(e){return new o(e.startLineNumber,e.endLineNumber)}static fromRangeInclusive(e){return new o(e.startLineNumber,e.endLineNumber+1)}static subtract(e,t){return t?e.startLineNumber<t.startLineNumber&&t.endLineNumberExclusive<e.endLineNumberExclusive?[new o(e.startLineNumber,t.startLineNumber),new o(t.endLineNumberExclusive,e.endLineNumberExclusive)]:t.startLineNumber<=e.startLineNumber&&e.endLineNumberExclusive<=t.endLineNumberExclusive?[]:t.endLineNumberExclusive<e.endLineNumberExclusive?[new o(Math.max(t.endLineNumberExclusive,e.startLineNumber),e.endLineNumberExclusive)]:[new o(e.startLineNumber,Math.min(t.startLineNumber,e.endLineNumberExclusive))]:[e]}static joinMany(e){if(e.length===0)return[];let t=new dv(e[0].slice());for(let n=1;n<e.length;n++)t=t.getUnion(new dv(e[n].slice()));return t.ranges}static join(e){if(e.length===0)throw new Qe("lineRanges cannot be empty");let t=e[0].startLineNumber,n=e[0].endLineNumberExclusive;for(let i=1;i<e.length;i++)t=Math.min(t,e[i].startLineNumber),n=Math.max(n,e[i].endLineNumberExclusive);return new o(t,n)}static ofLength(e,t){return new o(e,e+t)}static deserialize(e){return new o(e[0],e[1])}startLineNumber;endLineNumberExclusive;constructor(e,t){if(e>t)throw new Qe(`startLineNumber ${e} cannot be after endLineNumberExclusive ${t}`);this.startLineNumber=e,this.endLineNumberExclusive=t}contains(e){return this.startLineNumber<=e&&e<this.endLineNumberExclusive}get isEmpty(){return this.startLineNumber===this.endLineNumberExclusive}delta(e){return new o(this.startLineNumber+e,this.endLineNumberExclusive+e)}deltaLength(e){return new o(this.startLineNumber,this.endLineNumberExclusive+e)}get length(){return this.endLineNumberExclusive-this.startLineNumber}join(e){return new o(Math.min(this.startLineNumber,e.startLineNumber),Math.max(this.endLineNumberExclusive,e.endLineNumberExclusive))}toString(){return`[${this.startLineNumber},${this.endLineNumberExclusive})`}intersect(e){let t=Math.max(this.startLineNumber,e.startLineNumber),n=Math.min(this.endLineNumberExclusive,e.endLineNumberExclusive);if(t<=n)return new o(t,n)}intersectsStrict(e){return this.startLineNumber<e.endLineNumberExclusive&&e.startLineNumber<this.endLineNumberExclusive}overlapOrTouch(e){return this.startLineNumber<=e.endLineNumberExclusive&&e.startLineNumber<=this.endLineNumberExclusive}equals(e){return this.startLineNumber===e.startLineNumber&&this.endLineNumberExclusive===e.endLineNumberExclusive}toInclusiveRange(){return this.isEmpty?null:new D(this.startLineNumber,1,this.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER)}toExclusiveRange(){return new D(this.startLineNumber,1,this.endLineNumberExclusive,1)}mapToLineArray(e){let t=[];for(let n=this.startLineNumber;n<this.endLineNumberExclusive;n++)t.push(e(n));return t}forEach(e){for(let t=this.startLineNumber;t<this.endLineNumberExclusive;t++)e(t)}serialize(){return[this.startLineNumber,this.endLineNumberExclusive]}includes(e){return this.startLineNumber<=e&&e<this.endLineNumberExclusive}toOffsetRange(){return new Pt(this.startLineNumber-1,this.endLineNumberExclusive-1)}},dv=class o{constructor(e=[]){this._normalizedRanges=e}get ranges(){return this._normalizedRanges}addRange(e){if(e.length===0)return;let t=Cf(this._normalizedRanges,i=>i.endLineNumberExclusive>=e.startLineNumber),n=bp(this._normalizedRanges,i=>i.startLineNumber<=e.endLineNumberExclusive)+1;if(t===n)this._normalizedRanges.splice(t,0,e);else if(t===n-1){let i=this._normalizedRanges[t];this._normalizedRanges[t]=i.join(e)}else{let i=this._normalizedRanges[t].join(this._normalizedRanges[n-1]).join(e);this._normalizedRanges.splice(t,n-t,i)}}contains(e){let t=Uw(this._normalizedRanges,n=>n.startLineNumber<=e);return!!t&&t.endLineNumberExclusive>e}intersects(e){let t=Uw(this._normalizedRanges,n=>n.startLineNumber<e.endLineNumberExclusive);return!!t&&t.endLineNumberExclusive>e.startLineNumber}getUnion(e){if(this._normalizedRanges.length===0)return e;if(e._normalizedRanges.length===0)return this;let t=[],n=0,i=0,r=null;for(;n<this._normalizedRanges.length||i<e._normalizedRanges.length;){let s=null;if(n<this._normalizedRanges.length&&i<e._normalizedRanges.length){let a=this._normalizedRanges[n],l=e._normalizedRanges[i];a.startLineNumber<l.startLineNumber?(s=a,n++):(s=l,i++)}else n<this._normalizedRanges.length?(s=this._normalizedRanges[n],n++):(s=e._normalizedRanges[i],i++);r===null?r=s:r.endLineNumberExclusive>=s.startLineNumber?r=new Ei(r.startLineNumber,Math.max(r.endLineNumberExclusive,s.endLineNumberExclusive)):(t.push(r),r=s)}return r!==null&&t.push(r),new o(t)}subtractFrom(e){let t=Cf(this._normalizedRanges,s=>s.endLineNumberExclusive>=e.startLineNumber),n=bp(this._normalizedRanges,s=>s.startLineNumber<=e.endLineNumberExclusive)+1;if(t===n)return new o([e]);let i=[],r=e.startLineNumber;for(let s=t;s<n;s++){let a=this._normalizedRanges[s];a.startLineNumber>r&&i.push(new Ei(r,a.startLineNumber)),r=a.endLineNumberExclusive}return r<e.endLineNumberExclusive&&i.push(new Ei(r,e.endLineNumberExclusive)),new o(i)}toString(){return this._normalizedRanges.map(e=>e.toString()).join(", ")}getIntersection(e){let t=[],n=0,i=0;for(;n<this._normalizedRanges.length&&i<e._normalizedRanges.length;){let r=this._normalizedRanges[n],s=e._normalizedRanges[i],a=r.intersect(s);a&&!a.isEmpty&&t.push(a),r.endLineNumberExclusive<s.endLineNumberExclusive?n++:i++}return new o(t)}getWithDelta(e){return new o(this._normalizedRanges.map(t=>t.delta(e)))}};var bu=class o{constructor(e,t){this.lineCount=e;this.columnCount=t}static zero=new o(0,0);static lengthDiffNonNegative(e,t){return t.isLessThan(e)?o.zero:e.lineCount===t.lineCount?new o(0,t.columnCount-e.columnCount):new o(t.lineCount-e.lineCount,t.columnCount)}static betweenPositions(e,t){return e.lineNumber===t.lineNumber?new o(0,t.column-e.column):new o(t.lineNumber-e.lineNumber,t.column-1)}static ofRange(e){return o.betweenPositions(e.getStartPosition(),e.getEndPosition())}static ofText(e){let t=0,n=0;for(let i of e)i===`
`?(t++,n=0):n++;return new o(t,n)}isZero(){return this.lineCount===0&&this.columnCount===0}isLessThan(e){return this.lineCount!==e.lineCount?this.lineCount<e.lineCount:this.columnCount<e.columnCount}isGreaterThan(e){return this.lineCount!==e.lineCount?this.lineCount>e.lineCount:this.columnCount>e.columnCount}isGreaterThanOrEqualTo(e){return this.lineCount!==e.lineCount?this.lineCount>e.lineCount:this.columnCount>=e.columnCount}equals(e){return this.lineCount===e.lineCount&&this.columnCount===e.columnCount}compare(e){return this.lineCount!==e.lineCount?this.lineCount-e.lineCount:this.columnCount-e.columnCount}add(e){return e.lineCount===0?new o(this.lineCount,this.columnCount+e.columnCount):new o(this.lineCount+e.lineCount,e.columnCount)}createRange(e){return this.lineCount===0?new D(e.lineNumber,e.column,e.lineNumber,e.column+this.columnCount):new D(e.lineNumber,e.column,e.lineNumber+this.lineCount,this.columnCount+1)}toRange(){return new D(1,1,this.lineCount+1,this.columnCount+1)}addToPosition(e){return this.lineCount===0?new P(e.lineNumber,e.column+this.columnCount):new P(e.lineNumber+this.lineCount,this.columnCount+1)}toString(){return`${this.lineCount},${this.columnCount}`}};function w_(o,e){return new S_(o,e)}var S_=class{constructor(e,t){this.reducer=e;this.options=t}state={flowing:!1,ended:!1,destroyed:!1};buffer={data:[],error:[]};listeners={data:[],error:[],end:[]};pendingWritePromises=[];pause(){this.state.destroyed||(this.state.flowing=!1)}resume(){this.state.destroyed||this.state.flowing||(this.state.flowing=!0,this.flowData(),this.flowErrors(),this.flowEnd())}write(e){if(!this.state.destroyed){if(this.state.flowing)this.emitData(e);else if(this.buffer.data.push(e),typeof this.options?.highWaterMark=="number"&&this.buffer.data.length>this.options.highWaterMark)return new Promise(t=>this.pendingWritePromises.push(t))}}error(e){this.state.destroyed||(this.state.flowing?this.emitError(e):this.buffer.error.push(e))}end(e){this.state.destroyed||(typeof e<"u"&&this.write(e),this.state.flowing?(this.emitEnd(),this.destroy()):this.state.ended=!0)}emitData(e){this.listeners.data.slice(0).forEach(t=>t(e))}emitError(e){this.listeners.error.length===0?je(e):this.listeners.error.slice(0).forEach(t=>t(e))}emitEnd(){this.listeners.end.slice(0).forEach(e=>e())}on(e,t){if(!this.state.destroyed)switch(e){case"data":this.listeners.data.push(t),this.resume();break;case"end":this.listeners.end.push(t),this.state.flowing&&this.flowEnd()&&this.destroy();break;case"error":this.listeners.error.push(t),this.state.flowing&&this.flowErrors();break}}removeListener(e,t){if(this.state.destroyed)return;let n;switch(e){case"data":n=this.listeners.data;break;case"end":n=this.listeners.end;break;case"error":n=this.listeners.error;break}if(n){let i=n.indexOf(t);i>=0&&n.splice(i,1)}}flowData(){if(this.buffer.data.length>0){let e=this.reducer(this.buffer.data);this.emitData(e),this.buffer.data.length=0;let t=[...this.pendingWritePromises];this.pendingWritePromises.length=0,t.forEach(n=>n())}}flowErrors(){if(this.listeners.error.length>0){for(let e of this.buffer.error)this.emitError(e);this.buffer.error.length=0}}flowEnd(){return this.state.ended?(this.emitEnd(),this.listeners.end.length>0):!1}destroy(){this.state.destroyed||(this.state.destroyed=!0,this.state.ended=!0,this.buffer.data.length=0,this.buffer.error.length=0,this.listeners.data.length=0,this.listeners.error.length=0,this.listeners.end.length=0,this.pendingWritePromises.length=0)}};function x_(o,e,t){o.on("error",n=>{t?.isCancellationRequested||e.onError(n)}),o.on("end",()=>{t?.isCancellationRequested||e.onEnd()}),o.on("data",n=>{t?.isCancellationRequested||e.onData(n)})}function uM(o,e){let t=w_(e);return t.end(o),t}function hM(o){let e=!1;return{read:()=>e?null:(e=!0,o)}}var cv=typeof Buffer<"u",VW=new vi(()=>new Uint8Array(256)),E_,__,Cn=class o{static alloc(e){return cv?new o(Buffer.allocUnsafe(e)):new o(new Uint8Array(e))}static wrap(e){return cv&&!Buffer.isBuffer(e)&&(e=Buffer.from(e.buffer,e.byteOffset,e.byteLength)),new o(e)}static fromString(e,t){return!(t?.dontUseNodeBuffer||!1)&&cv?new o(Buffer.from(e)):(E_||(E_=new TextEncoder),new o(E_.encode(e)))}static fromByteArray(e){let t=o.alloc(e.length);for(let n=0,i=e.length;n<i;n++)t.buffer[n]=e[n];return t}static concat(e,t){if(typeof t>"u"){t=0;for(let r=0,s=e.length;r<s;r++)t+=e[r].byteLength}let n=o.alloc(t),i=0;for(let r=0,s=e.length;r<s;r++){let a=e[r];n.set(a,i),i+=a.byteLength}return n}buffer;byteLength;constructor(e){this.buffer=e,this.byteLength=this.buffer.byteLength}clone(){let e=o.alloc(this.byteLength);return e.set(this),e}toString(){return cv?this.buffer.toString():(__||(__=new TextDecoder),__.decode(this.buffer))}slice(e,t){return new o(this.buffer.subarray(e,t))}set(e,t){if(e instanceof o)this.buffer.set(e.buffer,t);else if(e instanceof Uint8Array)this.buffer.set(e,t);else if(e instanceof ArrayBuffer)this.buffer.set(new Uint8Array(e),t);else if(ArrayBuffer.isView(e))this.buffer.set(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),t);else throw new Error("Unknown argument 'array'")}readUInt32BE(e){return Bn(this.buffer,e)}writeUInt32BE(e,t){Vn(this.buffer,e,t)}readUInt32LE(e){return HW(this.buffer,e)}writeUInt32LE(e,t){UW(this.buffer,e,t)}readUInt8(e){return uv(this.buffer,e)}writeUInt8(e,t){hv(this.buffer,e,t)}indexOf(e,t=0){return WW(this.buffer,e instanceof o?e.buffer:e,t)}};function WW(o,e,t=0){let n=e.byteLength,i=o.byteLength;if(n===0)return 0;if(n===1)return o.indexOf(e[0]);if(n>i-t)return-1;let r=VW.value;r.fill(e.length);for(let d=0;d<e.length;d++)r[e[d]]=e.length-d-1;let s=t+e.length-1,a=s,l=-1;for(;s<i;)if(o[s]===e[a]){if(a===0){l=s;break}s--,a--}else s+=Math.max(e.length-a,r[o[s]]),a=e.length-1;return l}function pM(o,e){return o[e+0]<<0>>>0|o[e+1]<<8>>>0}function mM(o,e,t){o[t+0]=e&255,e=e>>>8,o[t+1]=e&255}function Bn(o,e){return o[e]*2**24+o[e+1]*2**16+o[e+2]*2**8+o[e+3]}function Vn(o,e,t){o[t+3]=e,e=e>>>8,o[t+2]=e,e=e>>>8,o[t+1]=e,e=e>>>8,o[t]=e}function HW(o,e){return o[e+0]<<0>>>0|o[e+1]<<8>>>0|o[e+2]<<16>>>0|o[e+3]<<24>>>0}function UW(o,e,t){o[t+0]=e&255,e=e>>>8,o[t+1]=e&255,e=e>>>8,o[t+2]=e&255,e=e>>>8,o[t+3]=e&255}function uv(o,e){return o[e]}function hv(o,e,t){o[t]=e}function gM(o){return hM(o)}function fM(o){return uM(o,e=>Cn.concat(e))}var L_;function bM(){return L_||(L_=new TextDecoder("UTF-16LE")),L_}var D_;function zW(){return D_||(D_=new TextDecoder("UTF-16BE")),D_}var k_;function R_(){return k_||(k_=A1()?bM():zW()),k_}function vM(o,e,t){let n=new Uint16Array(o.buffer,e,t);return t>0&&(n[0]===65279||n[0]===65534)?KW(o,e,t):bM().decode(n)}function KW(o,e,t){let n=[],i=0;for(let r=0;r<t;r++){let s=pM(o,e);e+=2,n[i++]=String.fromCharCode(s)}return n.join("")}var Md=class{_capacity;_buffer;_completedStrings;_bufferLength;constructor(e){this._capacity=e|0,this._buffer=new Uint16Array(this._capacity),this._completedStrings=null,this._bufferLength=0}reset(){this._completedStrings=null,this._bufferLength=0}build(){return this._completedStrings!==null?(this._flushBuffer(),this._completedStrings.join("")):this._buildBuffer()}_buildBuffer(){if(this._bufferLength===0)return"";let e=new Uint16Array(this._buffer.buffer,0,this._bufferLength);return R_().decode(e)}_flushBuffer(){let e=this._buildBuffer();this._bufferLength=0,this._completedStrings===null?this._completedStrings=[e]:this._completedStrings[this._completedStrings.length]=e}appendCharCode(e){let t=this._capacity-this._bufferLength;t<=1&&(t===0||Ht(e))&&this._flushBuffer(),this._buffer[this._bufferLength++]=e}appendASCIICharCode(e){this._bufferLength===this._capacity&&this._flushBuffer(),this._buffer[this._bufferLength++]=e}appendString(e){let t=e.length;if(this._bufferLength+t>=this._capacity){this._flushBuffer(),this._completedStrings[this._completedStrings.length]=e;return}for(let n=0;n<t;n++)this._buffer[this._bufferLength++]=e.charCodeAt(n)}};function pv(o){return o.replace(/\n/g,"\\n").replace(/\r/g,"\\r")}var So=class o{constructor(e,t,n,i){this.oldPosition=e;this.oldText=t;this.newPosition=n;this.newText=i}get oldLength(){return this.oldText.length}get oldEnd(){return this.oldPosition+this.oldText.length}get newLength(){return this.newText.length}get newEnd(){return this.newPosition+this.newText.length}toString(){return this.oldText.length===0?`(insert@${this.oldPosition} "${pv(this.newText)}")`:this.newText.length===0?`(delete@${this.oldPosition} "${pv(this.oldText)}")`:`(replace@${this.oldPosition} "${pv(this.oldText)}" with "${pv(this.newText)}")`}static _writeStringSize(e){return 4+2*e.length}static _writeString(e,t,n){let i=t.length;Vn(e,i,n),n+=4;for(let r=0;r<i;r++)mM(e,t.charCodeAt(r),n),n+=2;return n}static _readString(e,t){let n=Bn(e,t);return t+=4,vM(e,t,n)}writeSize(){return 8+o._writeStringSize(this.oldText)+o._writeStringSize(this.newText)}write(e,t){return Vn(e,this.oldPosition,t),t+=4,Vn(e,this.newPosition,t),t+=4,t=o._writeString(e,this.oldText,t),t=o._writeString(e,this.newText,t),t}static read(e,t,n){let i=Bn(e,t);t+=4;let r=Bn(e,t);t+=4;let s=o._readString(e,t);t+=o._writeStringSize(s);let a=o._readString(e,t);return t+=o._writeStringSize(a),n.push(new o(i,s,r,a)),t}};function yM(o,e){return o===null||o.length===0?e:new M_(o,e).compress()}var M_=class o{_prevEdits;_currEdits;_result;_resultLen;_prevLen;_prevDeltaOffset;_currLen;_currDeltaOffset;constructor(e,t){this._prevEdits=e,this._currEdits=t,this._result=[],this._resultLen=0,this._prevLen=this._prevEdits.length,this._prevDeltaOffset=0,this._currLen=this._currEdits.length,this._currDeltaOffset=0}compress(){let e=0,t=0,n=this._getPrev(e),i=this._getCurr(t);for(;e<this._prevLen||t<this._currLen;){if(n===null){this._acceptCurr(i),i=this._getCurr(++t);continue}if(i===null){this._acceptPrev(n),n=this._getPrev(++e);continue}if(i.oldEnd<=n.newPosition){this._acceptCurr(i),i=this._getCurr(++t);continue}if(n.newEnd<=i.oldPosition){this._acceptPrev(n),n=this._getPrev(++e);continue}if(i.oldPosition<n.newPosition){let[d,c]=o._splitCurr(i,n.newPosition-i.oldPosition);this._acceptCurr(d),i=c;continue}if(n.newPosition<i.oldPosition){let[d,c]=o._splitPrev(n,i.oldPosition-n.newPosition);this._acceptPrev(d),n=c;continue}let a,l;if(i.oldEnd===n.newEnd)a=n,l=i,n=this._getPrev(++e),i=this._getCurr(++t);else if(i.oldEnd<n.newEnd){let[d,c]=o._splitPrev(n,i.oldLength);a=d,l=i,n=c,i=this._getCurr(++t)}else{let[d,c]=o._splitCurr(i,n.newLength);a=n,l=d,n=this._getPrev(++e),i=c}this._result[this._resultLen++]=new So(a.oldPosition,a.oldText,l.newPosition,l.newText),this._prevDeltaOffset+=a.newLength-a.oldLength,this._currDeltaOffset+=l.newLength-l.oldLength}let r=o._merge(this._result);return o._removeNoOps(r)}_acceptCurr(e){this._result[this._resultLen++]=o._rebaseCurr(this._prevDeltaOffset,e),this._currDeltaOffset+=e.newLength-e.oldLength}_getCurr(e){return e<this._currLen?this._currEdits[e]:null}_acceptPrev(e){this._result[this._resultLen++]=o._rebasePrev(this._currDeltaOffset,e),this._prevDeltaOffset+=e.newLength-e.oldLength}_getPrev(e){return e<this._prevLen?this._prevEdits[e]:null}static _rebaseCurr(e,t){return new So(t.oldPosition-e,t.oldText,t.newPosition,t.newText)}static _rebasePrev(e,t){return new So(t.oldPosition,t.oldText,t.newPosition+e,t.newText)}static _splitPrev(e,t){let n=e.newText.substr(0,t),i=e.newText.substr(t);return[new So(e.oldPosition,e.oldText,e.newPosition,n),new So(e.oldEnd,"",e.newPosition+t,i)]}static _splitCurr(e,t){let n=e.oldText.substr(0,t),i=e.oldText.substr(t);return[new So(e.oldPosition,n,e.newPosition,e.newText),new So(e.oldPosition+t,i,e.newEnd,"")]}static _merge(e){if(e.length===0)return e;let t=[],n=0,i=e[0];for(let r=1;r<e.length;r++){let s=e[r];i.oldEnd===s.oldPosition?i=new So(i.oldPosition,i.oldText+s.oldText,i.newPosition,i.newText+s.newText):(t[n++]=i,i=s)}return t[n++]=i,t}static _removeNoOps(e){if(e.length===0)return e;let t=[],n=0;for(let i=0;i<e.length;i++){let r=e[i];r.oldText!==r.newText&&(t[n++]=r)}return t}};var vu=class o{_asciiMap;_map;_defaultValue;constructor(e){let t=dd(e);this._defaultValue=t,this._asciiMap=o._createAsciiMap(t),this._map=new Map}static _createAsciiMap(e){let t=new Uint8Array(256);return t.fill(e),t}set(e,t){let n=dd(t);e>=0&&e<256?this._asciiMap[e]=n:this._map.set(e,n)}get(e){return e>=0&&e<256?this._asciiMap[e]:this._map.get(e)||this._defaultValue}clear(){this._asciiMap.fill(this._defaultValue),this._map.clear()}};var A_=class extends vu{intlSegmenterLocales;_segmenter=null;_cachedLine=null;_cachedSegments=[];constructor(e,t){super(0),this.intlSegmenterLocales=t,this.intlSegmenterLocales.length>0?this._segmenter=new Intl.Segmenter(this.intlSegmenterLocales,{granularity:"word"}):this._segmenter=null;for(let n=0,i=e.length;n<i;n++)this.set(e.charCodeAt(n),2);this.set(32,1),this.set(9,1)}findPrevIntlWordBeforeOrAtOffset(e,t){let n=null;for(let i of this._getIntlSegmenterWordsOnLine(e)){if(i.index>t)break;n=i}return n}findNextIntlWordAtOrAfterOffset(e,t){for(let n of this._getIntlSegmenterWordsOnLine(e))if(!(n.index<t))return n;return null}_getIntlSegmenterWordsOnLine(e){return this._segmenter?this._cachedLine===e?this._cachedSegments:(this._cachedLine=e,this._cachedSegments=this._filterWordSegments(this._segmenter.segment(e)),this._cachedSegments):[]}_filterWordSegments(e){let t=[];for(let n of e)this._isWordLike(n)&&t.push(n);return t}_isWordLike(e){return!!e.isWordLike}},IM=new fo(10);function Is(o,e){let t=`${o}/${e.join(",")}`,n=IM.get(t);return n||(n=new A_(o,e),IM.set(t,n)),n}function ml(o,e){let t=Math.pow(10,e);return Math.round(o*t)/t}var Ge=class{_rgbaBrand=void 0;r;g;b;a;constructor(e,t,n,i=1){this.r=Math.min(255,Math.max(0,e))|0,this.g=Math.min(255,Math.max(0,t))|0,this.b=Math.min(255,Math.max(0,n))|0,this.a=ml(Math.max(Math.min(1,i),0),3)}static equals(e,t){return e.r===t.r&&e.g===t.g&&e.b===t.b&&e.a===t.a}},pl=class o{_hslaBrand=void 0;h;s;l;a;constructor(e,t,n,i){this.h=Math.max(Math.min(360,e),0)|0,this.s=ml(Math.max(Math.min(1,t),0),3),this.l=ml(Math.max(Math.min(1,n),0),3),this.a=ml(Math.max(Math.min(1,i),0),3)}static equals(e,t){return e.h===t.h&&e.s===t.s&&e.l===t.l&&e.a===t.a}static fromRGBA(e){let t=e.r/255,n=e.g/255,i=e.b/255,r=e.a,s=Math.max(t,n,i),a=Math.min(t,n,i),l=0,d=0,c=(a+s)/2,u=s-a;if(u>0){switch(d=Math.min(c<=.5?u/(2*c):u/(2-2*c),1),s){case t:l=(n-i)/u+(n<i?6:0);break;case n:l=(i-t)/u+2;break;case i:l=(t-n)/u+4;break}l*=60,l=Math.round(l)}return new o(l,d,c,r)}static _hue2rgb(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*(2/3-n)*6:e}static toRGBA(e){let t=e.h/360,{s:n,l:i,a:r}=e,s,a,l;if(n===0)s=a=l=i;else{let d=i<.5?i*(1+n):i+n-i*n,c=2*i-d;s=o._hue2rgb(c,d,t+1/3),a=o._hue2rgb(c,d,t),l=o._hue2rgb(c,d,t-1/3)}return new Ge(Math.round(s*255),Math.round(a*255),Math.round(l*255),r)}},yu=class o{_hsvaBrand=void 0;h;s;v;a;constructor(e,t,n,i){this.h=Math.max(Math.min(360,e),0)|0,this.s=ml(Math.max(Math.min(1,t),0),3),this.v=ml(Math.max(Math.min(1,n),0),3),this.a=ml(Math.max(Math.min(1,i),0),3)}static equals(e,t){return e.h===t.h&&e.s===t.s&&e.v===t.v&&e.a===t.a}static fromRGBA(e){let t=e.r/255,n=e.g/255,i=e.b/255,r=Math.max(t,n,i),s=Math.min(t,n,i),a=r-s,l=r===0?0:a/r,d;return a===0?d=0:r===t?d=((n-i)/a%6+6)%6:r===n?d=(i-t)/a+2:d=(t-n)/a+4,new o(Math.round(d*60),l,r,e.a)}static toRGBA(e){let{h:t,s:n,v:i,a:r}=e,s=i*n,a=s*(1-Math.abs(t/60%2-1)),l=i-s,[d,c,u]=[0,0,0];return t<60?(d=s,c=a):t<120?(d=a,c=s):t<180?(c=s,u=a):t<240?(c=a,u=s):t<300?(d=a,u=s):t<=360&&(d=s,u=a),d=Math.round((d+l)*255),c=Math.round((c+l)*255),u=Math.round((u+l)*255),new Ge(d,c,u,r)}},N=class o{static fromHex(e){return o.Format.CSS.parseHex(e)||o.red}static equals(e,t){return!e&&!t?!0:!e||!t?!1:e.equals(t)}rgba;_hsla;get hsla(){return this._hsla?this._hsla:pl.fromRGBA(this.rgba)}_hsva;get hsva(){return this._hsva?this._hsva:yu.fromRGBA(this.rgba)}constructor(e){if(e)if(e instanceof Ge)this.rgba=e;else if(e instanceof pl)this._hsla=e,this.rgba=pl.toRGBA(e);else if(e instanceof yu)this._hsva=e,this.rgba=yu.toRGBA(e);else throw new Error("Invalid color ctor argument");else throw new Error("Color needs a value")}equals(e){return!!e&&Ge.equals(this.rgba,e.rgba)&&pl.equals(this.hsla,e.hsla)&&yu.equals(this.hsva,e.hsva)}getRelativeLuminance(){let e=o._relativeLuminanceForComponent(this.rgba.r),t=o._relativeLuminanceForComponent(this.rgba.g),n=o._relativeLuminanceForComponent(this.rgba.b),i=.2126*e+.7152*t+.0722*n;return ml(i,4)}static _relativeLuminanceForComponent(e){let t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}getContrastRatio(e){let t=this.getRelativeLuminance(),n=e.getRelativeLuminance();return t>n?(t+.05)/(n+.05):(n+.05)/(t+.05)}isDarker(){return(this.rgba.r*299+this.rgba.g*587+this.rgba.b*114)/1e3<128}isLighter(){return(this.rgba.r*299+this.rgba.g*587+this.rgba.b*114)/1e3>=128}isLighterThan(e){let t=this.getRelativeLuminance(),n=e.getRelativeLuminance();return t>n}isDarkerThan(e){let t=this.getRelativeLuminance(),n=e.getRelativeLuminance();return t<n}lighten(e){return new o(new pl(this.hsla.h,this.hsla.s,this.hsla.l+this.hsla.l*e,this.hsla.a))}darken(e){return new o(new pl(this.hsla.h,this.hsla.s,this.hsla.l-this.hsla.l*e,this.hsla.a))}transparent(e){let{r:t,g:n,b:i,a:r}=this.rgba;return new o(new Ge(t,n,i,r*e))}isTransparent(){return this.rgba.a===0}isOpaque(){return this.rgba.a===1}opposite(){return new o(new Ge(255-this.rgba.r,255-this.rgba.g,255-this.rgba.b,this.rgba.a))}blend(e){let t=e.rgba,n=this.rgba.a,i=t.a,r=n+i*(1-n);if(r<1e-6)return o.transparent;let s=this.rgba.r*n/r+t.r*i*(1-n)/r,a=this.rgba.g*n/r+t.g*i*(1-n)/r,l=this.rgba.b*n/r+t.b*i*(1-n)/r;return new o(new Ge(s,a,l,r))}makeOpaque(e){if(this.isOpaque()||e.rgba.a!==1)return this;let{r:t,g:n,b:i,a:r}=this.rgba;return new o(new Ge(e.rgba.r-r*(e.rgba.r-t),e.rgba.g-r*(e.rgba.g-n),e.rgba.b-r*(e.rgba.b-i),1))}flatten(...e){let t=e.reduceRight((n,i)=>o._flatten(i,n));return o._flatten(this,t)}static _flatten(e,t){let n=1-e.rgba.a;return new o(new Ge(n*t.rgba.r+e.rgba.a*e.rgba.r,n*t.rgba.g+e.rgba.a*e.rgba.g,n*t.rgba.b+e.rgba.a*e.rgba.b))}_toString;toString(){return this._toString||(this._toString=o.Format.CSS.format(this)),this._toString}static getLighterColor(e,t,n){if(e.isLighterThan(t))return e;n=n||.5;let i=e.getRelativeLuminance(),r=t.getRelativeLuminance();return n=n*(r-i)/r,e.lighten(n)}static getDarkerColor(e,t,n){if(e.isDarkerThan(t))return e;n=n||.5;let i=e.getRelativeLuminance(),r=t.getRelativeLuminance();return n=n*(i-r)/i,e.darken(n)}static white=new o(new Ge(255,255,255,1));static black=new o(new Ge(0,0,0,1));static red=new o(new Ge(255,0,0,1));static blue=new o(new Ge(0,0,255,1));static green=new o(new Ge(0,255,0,1));static cyan=new o(new Ge(0,255,255,1));static lightgrey=new o(new Ge(211,211,211,1));static transparent=new o(new Ge(0,0,0,0))};(e=>{let o;(n=>{let t;(f=>{function i(g){return g.rgba.a===1?`rgb(${g.rgba.r}, ${g.rgba.g}, ${g.rgba.b})`:e.Format.CSS.formatRGBA(g)}f.formatRGB=i;function r(g){return`rgba(${g.rgba.r}, ${g.rgba.g}, ${g.rgba.b}, ${+g.rgba.a.toFixed(2)})`}f.formatRGBA=r;function s(g){return g.hsla.a===1?`hsl(${g.hsla.h}, ${(g.hsla.s*100).toFixed(2)}%, ${(g.hsla.l*100).toFixed(2)}%)`:e.Format.CSS.formatHSLA(g)}f.formatHSL=s;function a(g){return`hsla(${g.hsla.h}, ${(g.hsla.s*100).toFixed(2)}%, ${(g.hsla.l*100).toFixed(2)}%, ${g.hsla.a.toFixed(2)})`}f.formatHSLA=a;function l(g){let b=g.toString(16);return b.length!==2?"0"+b:b}function d(g){return`#${l(g.rgba.r)}${l(g.rgba.g)}${l(g.rgba.b)}`}f.formatHex=d;function c(g,b=!1){return b&&g.rgba.a===1?e.Format.CSS.formatHex(g):`#${l(g.rgba.r)}${l(g.rgba.g)}${l(g.rgba.b)}${l(Math.round(g.rgba.a*255))}`}f.formatHexA=c;function u(g){return g.isOpaque()?e.Format.CSS.formatHex(g):e.Format.CSS.formatRGBA(g)}f.format=u;function h(g){let b=g.length;if(b===0||g.charCodeAt(0)!==35)return null;if(b===7){let y=16*m(g.charCodeAt(1))+m(g.charCodeAt(2)),C=16*m(g.charCodeAt(3))+m(g.charCodeAt(4)),x=16*m(g.charCodeAt(5))+m(g.charCodeAt(6));return new e(new Ge(y,C,x,1))}if(b===9){let y=16*m(g.charCodeAt(1))+m(g.charCodeAt(2)),C=16*m(g.charCodeAt(3))+m(g.charCodeAt(4)),x=16*m(g.charCodeAt(5))+m(g.charCodeAt(6)),L=16*m(g.charCodeAt(7))+m(g.charCodeAt(8));return new e(new Ge(y,C,x,L/255))}if(b===4){let y=m(g.charCodeAt(1)),C=m(g.charCodeAt(2)),x=m(g.charCodeAt(3));return new e(new Ge(16*y+y,16*C+C,16*x+x))}if(b===5){let y=m(g.charCodeAt(1)),C=m(g.charCodeAt(2)),x=m(g.charCodeAt(3)),L=m(g.charCodeAt(4));return new e(new Ge(16*y+y,16*C+C,16*x+x,(16*L+L)/255))}return null}f.parseHex=h;function m(g){switch(g){case 48:return 0;case 49:return 1;case 50:return 2;case 51:return 3;case 52:return 4;case 53:return 5;case 54:return 6;case 55:return 7;case 56:return 8;case 57:return 9;case 97:return 10;case 65:return 10;case 98:return 11;case 66:return 11;case 99:return 12;case 67:return 12;case 100:return 13;case 68:return 13;case 101:return 14;case 69:return 14;case 102:return 15;case 70:return 15}return 0}})(t=n.CSS||={})})(o=e.Format||={})})(N||={});var Ad=function(){if(typeof crypto=="object"&&typeof crypto.randomUUID=="function")return crypto.randomUUID.bind(crypto);let o;typeof crypto=="object"&&typeof crypto.getRandomValues=="function"?o=crypto.getRandomValues.bind(crypto):o=function(n){for(let i=0;i<n.length;i++)n[i]=Math.floor(Math.random()*256);return n};let e=new Uint8Array(16),t=[];for(let n=0;n<256;n++)t.push(n.toString(16).padStart(2,"0"));return function(){o(e),e[6]=e[6]&15|64,e[8]=e[8]&63|128;let i=0,r="";return r+=t[e[i++]],r+=t[e[i++]],r+=t[e[i++]],r+=t[e[i++]],r+="-",r+=t[e[i++]],r+=t[e[i++]],r+="-",r+=t[e[i++]],r+=t[e[i++]],r+="-",r+=t[e[i++]],r+=t[e[i++]],r+="-",r+=t[e[i++]],r+=t[e[i++]],r+=t[e[i++]],r+=t[e[i++]],r+=t[e[i++]],r+=t[e[i++]],r}}();var jW=Object.freeze({create:o=>Xs(o.map(e=>e.toString())).join(`\r
`),split:o=>o.split(`\r
`),parse:o=>jW.split(o).filter(e=>!e.startsWith("#"))});var CM=class o{constructor(e){this.value=e}static sep=".";static None=new o("@@none@@");static Empty=new o("");equals(e){return this.value===e.value}contains(e){return this.equals(e)||this.value===""||e.value.startsWith(this.value+o.sep)}intersects(e){return this.contains(e)||e.contains(this)}append(...e){return new o((this.value?[this.value,...e]:e).join(o.sep))}};var wo=class{static getLanguageId(e){return(e&255)>>>0}static getTokenType(e){return(e&768)>>>8}static containsBalancedBrackets(e){return(e&1024)!==0}static getFontStyle(e){return(e&30720)>>>11}static getForeground(e){return(e&16744448)>>>15}static getBackground(e){return(e&4278190080)>>>24}static getClassNameFromMetadata(e){let n="mtk"+this.getForeground(e),i=this.getFontStyle(e);return i&1&&(n+=" mtki"),i&2&&(n+=" mtkb"),i&4&&(n+=" mtku"),i&8&&(n+=" mtks"),n}static getInlineStyleFromMetadata(e,t){let n=this.getForeground(e),i=this.getFontStyle(e),r=`color: ${t[n]};`;i&1&&(r+="font-style: italic;"),i&2&&(r+="font-weight: bold;");let s="";return i&4&&(s+=" underline"),i&8&&(s+=" line-through"),s&&(r+=`text-decoration:${s};`),r}static getPresentationFromMetadata(e){let t=this.getForeground(e),n=this.getFontStyle(e);return{foreground:t,italic:!!(n&1),bold:!!(n&2),underline:!!(n&4),strikethrough:!!(n&8)}}};var mv="**",SM="/",gv="[/\\\\]",fv="[^/\\\\]",$W=/\//g;function wM(o,e){switch(o){case 0:return"";case 1:return`${fv}*?`;default:return`(?:${gv}|${fv}+${gv}${e?`|${gv}${fv}+`:""})*?`}}function xM(o,e){if(!o)return[];let t=[],n=!1,i=!1,r="";for(let s of o){switch(s){case e:if(!n&&!i){t.push(r),r="";continue}break;case"{":n=!0;break;case"}":n=!1;break;case"[":i=!0;break;case"]":i=!1;break}r+=s}return r&&t.push(r),t}function DM(o){if(!o)return"";let e="",t=xM(o,SM);if(t.every(n=>n===mv))e=".*";else{let n=!1;t.forEach((i,r)=>{if(i===mv){if(n)return;e+=wM(2,r===t.length-1)}else{let s=!1,a="",l=!1,d="";for(let c of i){if(c!=="}"&&s){a+=c;continue}if(l&&(c!=="]"||!d)){let u;c==="-"?u=c:(c==="^"||c==="!")&&!d?u="^":c===SM?u="":u=Qi(c),d+=u;continue}switch(c){case"{":s=!0;continue;case"[":l=!0;continue;case"}":{let h=`(?:${xM(a,",").map(m=>DM(m)).join("|")})`;e+=h,s=!1,a="";break}case"]":{e+="["+d+"]",l=!1,d="";break}case"?":e+=fv;continue;case"*":e+=wM(1);continue;default:e+=Qi(c)}}r<t.length-1&&(t[r+1]!==mv||r+2<t.length)&&(e+=gv)}n=i===mv})}return e}var qW=/^\*\*\/\*\.[\w\.-]+$/,YW=/^\*\*\/([\w\.-]+)\/?$/,ZW=/^{\*\*\/\*?[\w\.-]+\/?(,\*\*\/\*?[\w\.-]+\/?)*}$/,XW=/^{\*\*\/\*?[\w\.-]+(\/(\*\*)?)?(,\*\*\/\*?[\w\.-]+(\/(\*\*)?)?)*}$/,QW=/^\*\*((\/[\w\.-]+)+)\/?$/,JW=/^([\w\.-]+(\/[\w\.-]+)*)\/?$/,EM=new fo(1e4),_M=function(){return!1},Cs=function(){return null};function N_(o,e){if(!o)return Cs;let t;typeof o!="string"?t=o.pattern:t=o,t=t.trim();let n=`${t}_${!!e.trimForExclusions}`,i=EM.get(n);if(i)return TM(i,o);let r;return qW.test(t)?i=eH(t.substr(4),t):(r=YW.exec(O_(t,e)))?i=tH(r[1],t):(e.trimForExclusions?XW:ZW).test(t)?i=nH(t,e):(r=QW.exec(O_(t,e)))?i=LM(r[1].substr(1),t,!0):(r=JW.exec(O_(t,e)))?i=LM(r[1],t,!1):i=iH(t),EM.set(n,i),TM(i,o)}function TM(o,e){if(typeof e=="string")return o;let t=function(n,i){return Gp(n,e.base,!Wt)?o(tb(n.substr(e.base.length),Po),i):null};return t.allBasenames=o.allBasenames,t.allPaths=o.allPaths,t.basenames=o.basenames,t.patterns=o.patterns,t}function O_(o,e){return e.trimForExclusions&&o.endsWith("/**")?o.substr(0,o.length-2):o}function eH(o,e){return function(t,n){return typeof t=="string"&&t.endsWith(o)?e:null}}function tH(o,e){let t=`/${o}`,n=`\\${o}`,i=function(s,a){return typeof s!="string"?null:a?a===o?e:null:s===o||s.endsWith(t)||s.endsWith(n)?e:null},r=[o];return i.basenames=r,i.patterns=[e],i.allBasenames=r,i}function nH(o,e){let t=kM(o.slice(1,-1).split(",").map(a=>N_(a,e)).filter(a=>a!==Cs),o),n=t.length;if(!n)return Cs;if(n===1)return t[0];let i=function(a,l){for(let d=0,c=t.length;d<c;d++)if(t[d](a,l))return o;return null},r=t.find(a=>!!a.allBasenames);r&&(i.allBasenames=r.allBasenames);let s=t.reduce((a,l)=>l.allPaths?a.concat(l.allPaths):a,[]);return s.length&&(i.allPaths=s),i}function LM(o,e,t){let n=Po===ot.sep,i=n?o:o.replace($W,Po),r=Po+i,s=ot.sep+o,a;return t?a=function(l,d){return typeof l=="string"&&(l===i||l.endsWith(r)||!n&&(l===o||l.endsWith(s)))?e:null}:a=function(l,d){return typeof l=="string"&&(l===i||!n&&l===o)?e:null},a.allPaths=[(t?"*/":"./")+o],a}function iH(o){try{let e=new RegExp(`^${DM(o)}$`);return function(t){return e.lastIndex=0,typeof t=="string"&&e.test(t)?o:null}}catch{return Cs}}function xm(o,e={}){if(!o)return _M;if(typeof o=="string"||oH(o)){let t=N_(o,e);if(t===Cs)return _M;let n=function(i,r){return!!t(i,r)};return t.allBasenames&&(n.allBasenames=t.allBasenames),t.allPaths&&(n.allPaths=t.allPaths),n}return rH(o,e)}function oH(o){let e=o;return e?typeof e.base=="string"&&typeof e.pattern=="string":!1}function rH(o,e){let t=kM(Object.getOwnPropertyNames(o).map(a=>sH(a,o[a],e)).filter(a=>a!==Cs)),n=t.length;if(!n)return Cs;if(!t.some(a=>!!a.requiresSiblings)){if(n===1)return t[0];let a=function(c,u){let h;for(let m=0,f=t.length;m<f;m++){let g=t[m](c,u);if(typeof g=="string")return g;gb(g)&&(h||(h=[]),h.push(g))}return h?(async()=>{for(let m of h){let f=await m;if(typeof f=="string")return f}return null})():null},l=t.find(c=>!!c.allBasenames);l&&(a.allBasenames=l.allBasenames);let d=t.reduce((c,u)=>u.allPaths?c.concat(u.allPaths):c,[]);return d.length&&(a.allPaths=d),a}let i=function(a,l,d){let c,u;for(let h=0,m=t.length;h<m;h++){let f=t[h];f.requiresSiblings&&d&&(l||(l=Jw(a)),c||(c=l.substr(0,l.length-Df(a).length)));let g=f(a,l,c,d);if(typeof g=="string")return g;gb(g)&&(u||(u=[]),u.push(g))}return u?(async()=>{for(let h of u){let m=await h;if(typeof m=="string")return m}return null})():null},r=t.find(a=>!!a.allBasenames);r&&(i.allBasenames=r.allBasenames);let s=t.reduce((a,l)=>l.allPaths?a.concat(l.allPaths):a,[]);return s.length&&(i.allPaths=s),i}function sH(o,e,t){if(e===!1)return Cs;let n=N_(o,t);if(n===Cs)return Cs;if(typeof e=="boolean")return n;if(e){let i=e.when;if(typeof i=="string"){let r=(s,a,l,d)=>{if(!d||!n(s,a))return null;let c=i.replace("$(basename)",()=>l),u=d(c);return gb(u)?u.then(h=>h?o:null):u?o:null};return r.requiresSiblings=!0,r}}return n}function kM(o,e){let t=o.filter(a=>!!a.basenames);if(t.length<2)return o;let n=t.reduce((a,l)=>{let d=l.basenames;return d?a.concat(d):a},[]),i;if(e){i=[];for(let a=0,l=n.length;a<l;a++)i.push(e)}else i=t.reduce((a,l)=>{let d=l.patterns;return d?a.concat(d):a},[]);let r=function(a,l){if(typeof a!="string")return null;if(!l){let c;for(c=a.length;c>0;c--){let u=a.charCodeAt(c-1);if(u===47||u===92)break}l=a.substr(c)}let d=n.indexOf(l);return d!==-1?i[d]:null};r.basenames=n,r.patterns=i,r.allBasenames=n;let s=o.filter(a=>!a.basenames);return s.push(r),s}var Em=class{_tokenizationSupports=new Map;_factories=new Map;_onDidChange=new E;onDidChange=this._onDidChange.event;_colorMap;constructor(){this._colorMap=null}handleChange(e){this._onDidChange.fire({changedLanguages:e,changedColorMap:!1})}register(e,t){return this._tokenizationSupports.set(e,t),this.handleChange([e]),ve(()=>{this._tokenizationSupports.get(e)===t&&(this._tokenizationSupports.delete(e),this.handleChange([e]))})}get(e){return this._tokenizationSupports.get(e)||null}registerFactory(e,t){this._factories.get(e)?.dispose();let n=new P_(this,e,t);return this._factories.set(e,n),ve(()=>{let i=this._factories.get(e);!i||i!==n||(this._factories.delete(e),i.dispose())})}async getOrCreate(e){let t=this.get(e);if(t)return t;let n=this._factories.get(e);return!n||n.isResolved?null:(await n.resolve(),this.get(e))}isResolved(e){if(this.get(e))return!0;let n=this._factories.get(e);return!!(!n||n.isResolved)}setColorMap(e){this._colorMap=e,this._onDidChange.fire({changedLanguages:Array.from(this._tokenizationSupports.keys()),changedColorMap:!0})}getColorMap(){return this._colorMap}getDefaultBackground(){return this._colorMap&&this._colorMap.length>2?this._colorMap[2]:null}},P_=class extends V{constructor(t,n,i){super();this._registry=t;this._languageId=n;this._factory=i}_isDisposed=!1;_resolvePromise=null;_isResolved=!1;get isResolved(){return this._isResolved}dispose(){this._isDisposed=!0,super.dispose()}async resolve(){return this._resolvePromise||(this._resolvePromise=this._create()),this._resolvePromise}async _create(){let t=await this._factory.tokenizationSupport;this._isResolved=!0,t&&!this._isDisposed&&this._register(this._registry.register(this._languageId,t))}};function io(o){let e=0,t=0,n=0,i=0;for(let r=0,s=o.length;r<s;r++){let a=o.charCodeAt(r);a===13?(e===0&&(t=r),e++,r+1<s&&o.charCodeAt(r+1)===10?(i|=2,r++):i|=3,n=r+1):a===10&&(i|=1,e===0&&(t=r),e++,n=r+1)}return e===0&&(t=o.length),[e,t,o.length-n,i]}var F_=class o{constructor(e){this._tokenInfo=e}static create(e){return new o(e)}forEach(e){let t=0;for(let n of this._tokenInfo){let i=new Pt(t,t+n.length);e(i,n),t+=n.length}}slice(e){let t=[],n=0;for(let i of this._tokenInfo){let r=n,s=r+i.length;if(s>e.start){if(r>=e.endExclusive)break;let a=Math.max(0,e.start-r),l=Math.max(0,s-e.endExclusive);t.push(new bv(i.length-a-l,i.metadata))}n+=i.length}return o.create(t)}},bv=class{constructor(e,t){this.length=e;this.metadata=t}},vv=class{_tokens=[];add(e,t){this._tokens.push(new bv(e,t))}build(){return F_.create(this._tokens)}};var dn=class o{static createEmpty(e,t){let n=o.defaultTokenMetadata,i=new Uint32Array(2);return i[0]=e.length,i[1]=n,new o(i,e,t)}static createFromTextAndMetadata(e,t){let n=0,i="",r=new Array;for(let{text:s,metadata:a}of e)r.push(n+s.length,a),n+=s.length,i+=s;return new o(new Uint32Array(r),i,t)}static convertToEndOffset(e,t){let i=(e.length>>>1)-1;for(let r=0;r<i;r++)e[r<<1]=e[r+1<<1];e[i<<1]=t}static findIndexInTokensArray(e,t){if(e.length<=2)return 0;let n=0,i=(e.length>>>1)-1;for(;n<i;){let r=n+Math.floor((i-n)/2),s=e[r<<1];if(s===t)return r+1;s<t?n=r+1:s>t&&(i=r)}return n}_lineTokensBrand=void 0;_tokens;_tokensCount;_text;languageIdCodec;static defaultTokenMetadata=(32768|2<<24)>>>0;constructor(e,t,n){this._tokens=e,this._tokensCount=this._tokens.length>>>1,this._text=t,this.languageIdCodec=n}equals(e){return e instanceof o?this.slicedEquals(e,0,this._tokensCount):!1}slicedEquals(e,t,n){if(this._text!==e._text||this._tokensCount!==e._tokensCount)return!1;let i=t<<1,r=i+(n<<1);for(let s=i;s<r;s++)if(this._tokens[s]!==e._tokens[s])return!1;return!0}getLineContent(){return this._text}getCount(){return this._tokensCount}getStartOffset(e){return e>0?this._tokens[e-1<<1]:0}getMetadata(e){return this._tokens[(e<<1)+1]}getLanguageId(e){let t=this._tokens[(e<<1)+1],n=wo.getLanguageId(t);return this.languageIdCodec.decodeLanguageId(n)}getStandardTokenType(e){let t=this._tokens[(e<<1)+1];return wo.getTokenType(t)}getForeground(e){let t=this._tokens[(e<<1)+1];return wo.getForeground(t)}getClassName(e){let t=this._tokens[(e<<1)+1];return wo.getClassNameFromMetadata(t)}getInlineStyle(e,t){let n=this._tokens[(e<<1)+1];return wo.getInlineStyleFromMetadata(n,t)}getPresentation(e){let t=this._tokens[(e<<1)+1];return wo.getPresentationFromMetadata(t)}getEndOffset(e){return this._tokens[e<<1]}findTokenIndexAtOffset(e){return o.findIndexInTokensArray(this._tokens,e)}inflate(){return this}sliceAndInflate(e,t,n){return new B_(this,e,t,n)}withInserted(e){if(e.length===0)return this;let t=0,n=0,i="",r=new Array,s=0;for(;;){let a=t<this._tokensCount?this._tokens[t<<1]:-1,l=n<e.length?e[n]:null;if(a!==-1&&(l===null||a<=l.offset)){i+=this._text.substring(s,a);let d=this._tokens[(t<<1)+1];r.push(i.length,d),t++,s=a}else if(l){if(l.offset>s){i+=this._text.substring(s,l.offset);let d=this._tokens[(t<<1)+1];r.push(i.length,d),s=l.offset}i+=l.text,r.push(i.length,l.tokenMetadata),n++}else break}return new o(new Uint32Array(r),i,this.languageIdCodec)}getTokensInRange(e){let t=new vv,n=this.findTokenIndexAtOffset(e.start),i=this.findTokenIndexAtOffset(e.endExclusive);for(let r=n;r<=i;r++){let a=new Pt(this.getStartOffset(r),this.getEndOffset(r)).intersectionLength(e);a>0&&t.add(a,this.getMetadata(r))}return t.build()}getTokenText(e){let t=this.getStartOffset(e),n=this.getEndOffset(e);return this._text.substring(t,n)}forEach(e){let t=this.getCount();for(let n=0;n<t;n++)e(n)}},B_=class o{_source;_startOffset;_endOffset;_deltaOffset;_firstTokenIndex;_tokensCount;languageIdCodec;constructor(e,t,n,i){this._source=e,this._startOffset=t,this._endOffset=n,this._deltaOffset=i,this._firstTokenIndex=e.findTokenIndexAtOffset(t),this.languageIdCodec=e.languageIdCodec,this._tokensCount=0;for(let r=this._firstTokenIndex,s=e.getCount();r<s&&!(e.getStartOffset(r)>=n);r++)this._tokensCount++}getMetadata(e){return this._source.getMetadata(this._firstTokenIndex+e)}getLanguageId(e){return this._source.getLanguageId(this._firstTokenIndex+e)}getLineContent(){return this._source.getLineContent().substring(this._startOffset,this._endOffset)}equals(e){return e instanceof o?this._startOffset===e._startOffset&&this._endOffset===e._endOffset&&this._deltaOffset===e._deltaOffset&&this._source.slicedEquals(e._source,this._firstTokenIndex,this._tokensCount):!1}getCount(){return this._tokensCount}getStandardTokenType(e){return this._source.getStandardTokenType(this._firstTokenIndex+e)}getForeground(e){return this._source.getForeground(this._firstTokenIndex+e)}getEndOffset(e){let t=this._source.getEndOffset(this._firstTokenIndex+e);return Math.min(this._endOffset,t)-this._startOffset+this._deltaOffset}getClassName(e){return this._source.getClassName(this._firstTokenIndex+e)}getInlineStyle(e,t){return this._source.getInlineStyle(this._firstTokenIndex+e,t)}getPresentation(e){return this._source.getPresentation(this._firstTokenIndex+e)}findTokenIndexAtOffset(e){return this._source.findTokenIndexAtOffset(e+this._startOffset-this._deltaOffset)-this._firstTokenIndex}getTokenText(e){let t=this._firstTokenIndex+e,n=this._source.getStartOffset(t),i=this._source.getEndOffset(t),r=this._source.getTokenText(t);return n<this._startOffset&&(r=r.substring(this._startOffset-n)),i>this._endOffset&&(r=r.substring(0,r.length-(i-this._endOffset))),r}forEach(e){for(let t=0;t<this.getCount();t++)e(t)}};var Ss=new Uint32Array(0).buffer,Wn=class o{static deleteBeginning(e,t){return e===null||e===Ss?e:o.delete(e,0,t)}static deleteEnding(e,t){if(e===null||e===Ss)return e;let n=ws(e),i=n[n.length-2];return o.delete(e,t,i)}static delete(e,t,n){if(e===null||e===Ss||t===n)return e;let i=ws(e),r=i.length>>>1;if(t===0&&i[i.length-2]===n)return Ss;let s=dn.findIndexInTokensArray(i,t),a=s>0?i[s-1<<1]:0,l=i[s<<1];if(n<l){let m=n-t;for(let f=s;f<r;f++)i[f<<1]-=m;return e}let d,c;a!==t?(i[s<<1]=t,d=s+1<<1,c=t):(d=s<<1,c=a);let u=n-t;for(let m=s+1;m<r;m++){let f=i[m<<1]-u;f>c&&(i[d++]=f,i[d++]=i[(m<<1)+1],c=f)}if(d===i.length)return e;let h=new Uint32Array(d);return h.set(i.subarray(0,d),0),h.buffer}static append(e,t){if(t===Ss)return e;if(e===Ss)return t;if(e===null)return e;if(t===null)return null;let n=ws(e),i=ws(t),r=i.length>>>1,s=new Uint32Array(n.length+i.length);s.set(n,0);let a=n.length,l=n[n.length-2];for(let d=0;d<r;d++)s[a++]=i[d<<1]+l,s[a++]=i[(d<<1)+1];return s.buffer}static insert(e,t,n){if(e===null||e===Ss)return e;let i=ws(e),r=i.length>>>1,s=dn.findIndexInTokensArray(i,t);s>0&&i[s-1<<1]===t&&s--;for(let a=s;a<r;a++)i[a<<1]+=n;return e}};function ws(o){return o instanceof Uint32Array?o:new Uint32Array(o)}var _m=class o{static deserialize(e,t,n){let i=new Uint32Array(e.buffer),r=Bn(e,t);t+=4;let s=Bn(e,t);t+=4;let a=[];for(let l=0;l<s;l++){let d=Bn(e,t);t+=4,a.push(i.subarray(t/4,t/4+d/4)),t+=d}return n.push(new o(r,a)),t}_startLineNumber;_tokens;get startLineNumber(){return this._startLineNumber}get endLineNumber(){return this._startLineNumber+this._tokens.length-1}constructor(e,t){this._startLineNumber=e,this._tokens=t}getLineRange(){return new Ei(this._startLineNumber,this._startLineNumber+this._tokens.length)}getLineTokens(e){return this._tokens[e-this._startLineNumber]}appendLineTokens(e){this._tokens.push(e)}serializeSize(){let e=0;e+=4,e+=4;for(let t=0;t<this._tokens.length;t++){let n=this._tokens[t];if(!(n instanceof Uint32Array))throw new Error("Not supported!");e+=4,e+=n.byteLength}return e}serialize(e,t){Vn(e,this._startLineNumber,t),t+=4,Vn(e,this._tokens.length,t),t+=4;for(let n=0;n<this._tokens.length;n++){let i=this._tokens[n];if(!(i instanceof Uint32Array))throw new Error("Not supported!");Vn(e,i.byteLength,t),t+=4,e.set(new Uint8Array(i.buffer),t),t+=i.byteLength}return t}applyEdit(e,t){let[n,i]=io(t);this._acceptDeleteRange(e),this._acceptInsertText(new P(e.startLineNumber,e.startColumn),n,i)}_acceptDeleteRange(e){if(e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn)return;let t=e.startLineNumber-this._startLineNumber,n=e.endLineNumber-this._startLineNumber;if(n<0){let i=n-t;this._startLineNumber-=i;return}if(!(t>=this._tokens.length)){if(t<0&&n>=this._tokens.length){this._startLineNumber=0,this._tokens=[];return}if(t===n){this._tokens[t]=Wn.delete(this._tokens[t],e.startColumn-1,e.endColumn-1);return}if(t>=0)if(this._tokens[t]=Wn.deleteEnding(this._tokens[t],e.startColumn-1),n<this._tokens.length){let i=Wn.deleteBeginning(this._tokens[n],e.endColumn-1);this._tokens[t]=Wn.append(this._tokens[t],i),this._tokens.splice(t+1,n-t)}else this._tokens[t]=Wn.append(this._tokens[t],null),this._tokens=this._tokens.slice(0,t+1);else{let i=-t;this._startLineNumber-=i,this._tokens[n]=Wn.deleteBeginning(this._tokens[n],e.endColumn-1),this._tokens=this._tokens.slice(n)}}}_acceptInsertText(e,t,n){if(t===0&&n===0)return;let i=e.lineNumber-this._startLineNumber;if(i<0){this._startLineNumber+=t;return}if(!(i>=this._tokens.length)){if(t===0){this._tokens[i]=Wn.insert(this._tokens[i],e.column-1,n);return}this._tokens[i]=Wn.deleteEnding(this._tokens[i],e.column-1),this._tokens[i]=Wn.insert(this._tokens[i],e.column-1,n),this._insertLines(e.lineNumber,t)}}_insertLines(e,t){if(t===0)return;let n=[];for(let i=0;i<t;i++)n[i]=null;this._tokens=ns(this._tokens,e,n)}};var yv=(i=>(i[i.Ignore=0]="Ignore",i[i.Info=1]="Info",i[i.Warning=2]="Warning",i[i.Error=3]="Error",i))(yv||{});(a=>{let o="error",e="warning",t="warn",n="info",i="ignore";function r(l){return l?wr(o,l)?3:wr(e,l)||wr(t,l)?2:wr(n,l)?1:0:0}a.fromValue=r;function s(l){switch(l){case 3:return o;case 2:return e;case 1:return n;default:return i}}a.toString=s})(yv||={});var Qn=yv;var Lee=Y("IBuiltinExtensionsScannerService");var Tm=(i=>(i[i.Hint=1]="Hint",i[i.Info=2]="Info",i[i.Warning=4]="Warning",i[i.Error=8]="Error",i))(Tm||{});(r=>{function o(s,a){return a-s}r.compare=o;let e=Object.create(null);e[8]=p("sev.error","Error"),e[4]=p("sev.warning","Warning"),e[2]=p("sev.info","Info");function t(s){return e[s]||""}r.toString=t;function n(s){switch(s){case Qn.Error:return 8;case Qn.Warning:return 4;case Qn.Info:return 2;case Qn.Ignore:return 1}}r.fromSeverity=n;function i(s){switch(s){case 8:return Qn.Error;case 4:return Qn.Warning;case 2:return Qn.Info;case 1:return Qn.Ignore}}r.toSeverity=i})(Tm||={});var dH;(n=>{let o="";function e(i){return t(i,!0)}n.makeKey=e;function t(i,r){let s=[o];return i.source?s.push(i.source.replace("\xA6","\\\xA6")):s.push(o),i.code?typeof i.code=="string"?s.push(i.code.replace("\xA6","\\\xA6")):s.push(i.code.value.replace("\xA6","\\\xA6")):s.push(o),i.severity!==void 0&&i.severity!==null?s.push(Tm.toString(i.severity)):s.push(o),i.message&&r?s.push(i.message.replace("\xA6","\\\xA6")):s.push(o),i.startLineNumber!==void 0&&i.startLineNumber!==null?s.push(i.startLineNumber.toString()):s.push(o),i.startColumn!==void 0&&i.startColumn!==null?s.push(i.startColumn.toString()):s.push(o),i.endLineNumber!==void 0&&i.endLineNumber!==null?s.push(i.endLineNumber.toString()):s.push(o),i.endColumn!==void 0&&i.endColumn!==null?s.push(i.endColumn.toString()):s.push(o),s.push(o),s.join("\xA6")}n.makeKeyOptionalMessage=t})(dH||={});var MM=Y("markerService");var Iv=class{constructor(e,t){this.tokens=e;this.endState=t}_encodedTokenizationResultBrand=void 0};var cH;(i=>{let o=new Map;o.set(0,ge.symbolMethod),o.set(1,ge.symbolFunction),o.set(2,ge.symbolConstructor),o.set(3,ge.symbolField),o.set(4,ge.symbolVariable),o.set(5,ge.symbolClass),o.set(6,ge.symbolStruct),o.set(7,ge.symbolInterface),o.set(8,ge.symbolModule),o.set(9,ge.symbolProperty),o.set(10,ge.symbolEvent),o.set(11,ge.symbolOperator),o.set(12,ge.symbolUnit),o.set(13,ge.symbolValue),o.set(15,ge.symbolEnum),o.set(14,ge.symbolConstant),o.set(15,ge.symbolEnum),o.set(16,ge.symbolEnumMember),o.set(17,ge.symbolKeyword),o.set(27,ge.symbolSnippet),o.set(18,ge.symbolText),o.set(19,ge.symbolColor),o.set(20,ge.symbolFile),o.set(21,ge.symbolReference),o.set(22,ge.symbolCustomColor),o.set(23,ge.symbolFolder),o.set(24,ge.symbolTypeParameter),o.set(25,ge.account),o.set(26,ge.issues);function e(r){let s=o.get(r);return s||(console.info("No codicon found for CompletionItemKind "+r),s=ge.symbolProperty),s}i.toIcon=e;let t=new Map;t.set("method",0),t.set("function",1),t.set("constructor",2),t.set("field",3),t.set("variable",4),t.set("class",5),t.set("struct",6),t.set("interface",7),t.set("module",8),t.set("property",9),t.set("event",10),t.set("operator",11),t.set("unit",12),t.set("value",13),t.set("constant",14),t.set("enum",15),t.set("enum-member",16),t.set("enumMember",16),t.set("keyword",17),t.set("snippet",27),t.set("text",18),t.set("color",19),t.set("file",20),t.set("reference",21),t.set("customcolor",22),t.set("folder",23),t.set("type-parameter",24),t.set("typeParameter",24),t.set("account",25),t.set("issue",26);function n(r,s){let a=t.get(r);return typeof a>"u"&&!s&&(a=9),a}i.fromString=n})(cH||={});var Lte={17:p("Array","array"),16:p("Boolean","boolean"),4:p("Class","class"),13:p("Constant","constant"),8:p("Constructor","constructor"),9:p("Enum","enumeration"),21:p("EnumMember","enumeration member"),23:p("Event","event"),7:p("Field","field"),0:p("File","file"),11:p("Function","function"),10:p("Interface","interface"),19:p("Key","key"),5:p("Method","method"),1:p("Module","module"),2:p("Namespace","namespace"),20:p("Null","null"),15:p("Number","number"),18:p("Object","object"),24:p("Operator","operator"),3:p("Package","package"),6:p("Property","property"),14:p("String","string"),22:p("Struct","struct"),25:p("TypeParameter","type parameter"),12:p("Variable","variable")};var uH;(t=>{let o=new Map;o.set(0,ge.symbolFile),o.set(1,ge.symbolModule),o.set(2,ge.symbolNamespace),o.set(3,ge.symbolPackage),o.set(4,ge.symbolClass),o.set(5,ge.symbolMethod),o.set(6,ge.symbolProperty),o.set(7,ge.symbolField),o.set(8,ge.symbolConstructor),o.set(9,ge.symbolEnum),o.set(10,ge.symbolInterface),o.set(11,ge.symbolFunction),o.set(12,ge.symbolVariable),o.set(13,ge.symbolConstant),o.set(14,ge.symbolString),o.set(15,ge.symbolNumber),o.set(16,ge.symbolBoolean),o.set(17,ge.symbolArray),o.set(18,ge.symbolObject),o.set(19,ge.symbolKey),o.set(20,ge.symbolNull),o.set(21,ge.symbolEnumMember),o.set(22,ge.symbolStruct),o.set(23,ge.symbolEvent),o.set(24,ge.symbolOperator),o.set(25,ge.symbolTypeParameter);function e(n){let i=o.get(n);return i||(console.info("No codicon found for SymbolKind "+n),i=ge.symbolProperty),i}t.toIcon=e})(uH||={});var AM=class o{constructor(e){this.value=e}static Comment=new o("comment");static Imports=new o("imports");static Region=new o("region");static fromValue(e){switch(e){case"comment":return o.Comment;case"imports":return o.Imports;case"region":return o.Region}return new o(e)}};var hH;(e=>{function o(t){return!t||typeof t!="object"?!1:typeof t.id=="string"&&typeof t.title=="string"}e.is=o})(hH||={});var xo=new Em,Lm=new Em;var Bi=Y("languageService");function xs(o,e){let t=o.getCount(),n=o.findTokenIndexAtOffset(e),i=o.getLanguageId(n),r=n;for(;r+1<t&&o.getLanguageId(r+1)===i;)r++;let s=n;for(;s>0&&o.getLanguageId(s-1)===i;)s--;return new W_(o,i,s,r+1,o.getStartOffset(s),o.getEndOffset(r))}var W_=class{_scopedLineTokensBrand=void 0;languageIdCodec;languageId;_actual;_firstTokenIndex;_lastTokenIndex;firstCharOffset;_lastCharOffset;constructor(e,t,n,i,r,s){this._actual=e,this.languageId=t,this._firstTokenIndex=n,this._lastTokenIndex=i,this.firstCharOffset=r,this._lastCharOffset=s,this.languageIdCodec=e.languageIdCodec}getLineContent(){return this._actual.getLineContent().substring(this.firstCharOffset,this._lastCharOffset)}getLineLength(){return this._lastCharOffset-this.firstCharOffset}getActualLineContentBefore(e){return this._actual.getLineContent().substring(0,this.firstCharOffset+e)}getTokenCount(){return this._lastTokenIndex-this._firstTokenIndex}findTokenIndexAtOffset(e){return this._actual.findTokenIndexAtOffset(e+this.firstCharOffset)-this._firstTokenIndex}getStandardTokenType(e){return this._actual.getStandardTokenType(e+this._firstTokenIndex)}toIViewLineTokens(){return this._actual.sliceAndInflate(this.firstCharOffset,this._lastCharOffset,0)}},OM=(e=>(e[e.value=3]="value",e))(OM||{});function rr(o){return(o&OM.value)!==0}var Iu=class{open;close;_inString;_inComment;_inRegEx;_neutralCharacter=null;_neutralCharacterSearched=!1;constructor(e){if(this.open=e.open,this.close=e.close,this._inString=!0,this._inComment=!0,this._inRegEx=!0,Array.isArray(e.notIn))for(let t=0,n=e.notIn.length;t<n;t++)switch(e.notIn[t]){case"string":this._inString=!1;break;case"comment":this._inComment=!1;break;case"regex":this._inRegEx=!1;break}}isOK(e){switch(e){case 0:return!0;case 1:return this._inComment;case 2:return this._inString;case 3:return this._inRegEx}}shouldAutoClose(e,t){if(e.getTokenCount()===0)return!0;let n=e.findTokenIndexAtOffset(t-2),i=e.getStandardTokenType(n);return this.isOK(i)}_findNeutralCharacterInRange(e,t){for(let n=e;n<=t;n++){let i=String.fromCharCode(n);if(!this.open.includes(i)&&!this.close.includes(i))return i}return null}findNeutralCharacter(){return this._neutralCharacterSearched||(this._neutralCharacterSearched=!0,this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(48,57)),this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(97,122)),this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(65,90))),this._neutralCharacter}},Cv=class{autoClosingPairsOpenByStart;autoClosingPairsOpenByEnd;autoClosingPairsCloseByStart;autoClosingPairsCloseByEnd;autoClosingPairsCloseSingleChar;constructor(e){this.autoClosingPairsOpenByStart=new Map,this.autoClosingPairsOpenByEnd=new Map,this.autoClosingPairsCloseByStart=new Map,this.autoClosingPairsCloseByEnd=new Map,this.autoClosingPairsCloseSingleChar=new Map;for(let t of e)Dm(this.autoClosingPairsOpenByStart,t.open.charAt(0),t),Dm(this.autoClosingPairsOpenByEnd,t.open.charAt(t.open.length-1),t),Dm(this.autoClosingPairsCloseByStart,t.close.charAt(0),t),Dm(this.autoClosingPairsCloseByEnd,t.close.charAt(t.close.length-1),t),t.close.length===1&&t.open.length===1&&Dm(this.autoClosingPairsCloseSingleChar,t.close,t)}};function Dm(o,e,t){o.has(e)?o.get(e).push(t):o.set(e,[t])}var H_=class o{_richEditBracketBrand=void 0;languageId;index;open;close;forwardRegex;reversedRegex;_openSet;_closeSet;constructor(e,t,n,i,r,s){this.languageId=e,this.index=t,this.open=n,this.close=i,this.forwardRegex=r,this.reversedRegex=s,this._openSet=o._toSet(this.open),this._closeSet=o._toSet(this.close)}isOpen(e){return this._openSet.has(e)}isClose(e){return this._closeSet.has(e)}static _toSet(e){let t=new Set;for(let n of e)t.add(n);return t}};function pH(o){let e=o.length;o=o.map(s=>[s[0].toLowerCase(),s[1].toLowerCase()]);let t=[];for(let s=0;s<e;s++)t[s]=s;let n=(s,a)=>{let[l,d]=s,[c,u]=a;return l===c||l===u||d===c||d===u},i=(s,a)=>{let l=Math.min(s,a),d=Math.max(s,a);for(let c=0;c<e;c++)t[c]===d&&(t[c]=l)};for(let s=0;s<e;s++){let a=o[s];for(let l=s+1;l<e;l++){let d=o[l];n(a,d)&&i(t[s],t[l])}}let r=[];for(let s=0;s<e;s++){let a=[],l=[];for(let d=0;d<e;d++)if(t[d]===s){let[c,u]=o[d];a.push(c),l.push(u)}a.length>0&&r.push({open:a,close:l})}return r}var Sv=class{_richEditBracketsBrand=void 0;brackets;forwardRegex;reversedRegex;maxBracketLength;textIsBracket;textIsOpenBracket;constructor(e,t){let n=pH(t);this.brackets=n.map((i,r)=>new H_(e,r,i.open,i.close,mH(i.open,i.close,n,r),gH(i.open,i.close,n,r))),this.forwardRegex=fH(this.brackets),this.reversedRegex=bH(this.brackets),this.textIsBracket={},this.textIsOpenBracket={},this.maxBracketLength=0;for(let i of this.brackets){for(let r of i.open)this.textIsBracket[r]=i,this.textIsOpenBracket[r]=!0,this.maxBracketLength=Math.max(this.maxBracketLength,r.length);for(let r of i.close)this.textIsBracket[r]=i,this.textIsOpenBracket[r]=!1,this.maxBracketLength=Math.max(this.maxBracketLength,r.length)}}};function NM(o,e,t,n){for(let i=0,r=e.length;i<r;i++){if(i===t)continue;let s=e[i];for(let a of s.open)a.indexOf(o)>=0&&n.push(a);for(let a of s.close)a.indexOf(o)>=0&&n.push(a)}}function PM(o,e){return o.length-e.length}function wv(o){if(o.length<=1)return o;let e=[],t=new Set;for(let n of o)t.has(n)||(e.push(n),t.add(n));return e}function mH(o,e,t,n){let i=[];i=i.concat(o),i=i.concat(e);for(let r=0,s=i.length;r<s;r++)NM(i[r],t,n,i);return i=wv(i),i.sort(PM),i.reverse(),Cu(i)}function gH(o,e,t,n){let i=[];i=i.concat(o),i=i.concat(e);for(let r=0,s=i.length;r<s;r++)NM(i[r],t,n,i);return i=wv(i),i.sort(PM),i.reverse(),Cu(i.map(U_))}function fH(o){let e=[];for(let t of o){for(let n of t.open)e.push(n);for(let n of t.close)e.push(n)}return e=wv(e),Cu(e)}function bH(o){let e=[];for(let t of o){for(let n of t.open)e.push(n);for(let n of t.close)e.push(n)}return e=wv(e),Cu(e.map(U_))}function vH(o){let e=/^[\w ]+$/.test(o);return o=Qi(o),e?`\\b${o}\\b`:o}function Cu(o,e){let t=`(${o.map(vH).join(")|(")})`;return nb(t,!0,e)}var U_=function(){function o(n){let i=new Uint16Array(n.length),r=0;for(let s=n.length-1;s>=0;s--)i[r++]=n.charCodeAt(s);return R_().decode(i)}let e=null,t=null;return function(i){return e!==i&&(e=i,t=o(e)),t}}(),Vi=class{static _findPrevBracketInText(e,t,n,i){let r=n.match(e);if(!r)return null;let s=n.length-(r.index||0),a=r[0].length,l=i+s;return new D(t,l-a+1,t,l+1)}static findPrevBracketInRange(e,t,n,i,r){let a=U_(n).substring(n.length-r,n.length-i);return this._findPrevBracketInText(e,t,a,i)}static findNextBracketInText(e,t,n,i){let r=n.match(e);if(!r)return null;let s=r.index||0,a=r[0].length;if(a===0)return null;let l=i+s;return new D(t,l+1,t,l+1+a)}static findNextBracketInRange(e,t,n,i,r){let s=n.substring(i,r);return this.findNextBracketInText(e,t,s,i)}};var xv=class{constructor(e,t){this.languageId=e;let n=t.brackets?FM(t.brackets):[],i=new Fp(a=>{let l=new Set;return{info:new z_(this,a,l),closing:l}}),r=new Fp(a=>{let l=new Set,d=new Set;return{info:new K_(this,a,l,d),opening:l,openingColorized:d}});for(let[a,l]of n){let d=i.get(a),c=r.get(l);d.closing.add(c.info),c.opening.add(d.info)}let s=t.colorizedBracketPairs?FM(t.colorizedBracketPairs):n.filter(a=>!(a[0]==="<"&&a[1]===">"));for(let[a,l]of s){let d=i.get(a),c=r.get(l);d.closing.add(c.info),c.openingColorized.add(d.info),c.opening.add(d.info)}this._openingBrackets=new Map([...i.cachedValues].map(([a,l])=>[a,l.info])),this._closingBrackets=new Map([...r.cachedValues].map(([a,l])=>[a,l.info]))}_openingBrackets;_closingBrackets;get openingBrackets(){return[...this._openingBrackets.values()]}get closingBrackets(){return[...this._closingBrackets.values()]}getOpeningBracketInfo(e){return this._openingBrackets.get(e)}getClosingBracketInfo(e){return this._closingBrackets.get(e)}getBracketInfo(e){return this.getOpeningBracketInfo(e)||this.getClosingBracketInfo(e)}getBracketRegExp(e){let t=Array.from([...this._openingBrackets.keys(),...this._closingBrackets.keys()]);return Cu(t,e)}};function FM(o){return o.filter(([e,t])=>e!==""&&t!=="")}var Ev=class{constructor(e,t){this.config=e;this.bracketText=t}get languageId(){return this.config.languageId}},z_=class extends Ev{constructor(t,n,i){super(t,n);this.openedBrackets=i}isOpeningBracket=!0},K_=class extends Ev{constructor(t,n,i,r){super(t,n);this.openingBrackets=i;this.openingColorizedBrackets=r}isOpeningBracket=!1;closes(t){return t.config!==this.config?!1:this.openingBrackets.has(t)}closesColorized(t){return t.config!==this.config?!1:this.openingColorizedBrackets.has(t)}getOpeningBrackets(){return[...this.openingBrackets]}};var _t=class o{static _nextVisibleColumn(e,t,n){return e===9?o.nextRenderTabStop(t,n):Ho(e)||zp(e)?t+2:t+1}static visibleColumnFromColumn(e,t,n){let i=Math.min(t-1,e.length),r=e.substring(0,i),s=new hd(r),a=0;for(;!s.eol();){let l=qc(r,i,s.offset);s.nextGraphemeLength(),a=this._nextVisibleColumn(l,a,n)}return a}static toStatusbarColumn(e,t,n){let i=e.substring(0,Math.min(t-1,e.length)),r=new ud(i),s=0;for(;!r.eol();)r.nextCodePoint()===9?s=o.nextRenderTabStop(s,n):s=s+1;return s+1}static columnFromVisibleColumn(e,t,n){if(t<=0)return 1;let i=e.length,r=new hd(e),s=0,a=1;for(;!r.eol();){let l=qc(e,i,r.offset);r.nextGraphemeLength();let d=this._nextVisibleColumn(l,s,n),c=r.offset+1;if(d>=t){let u=t-s;return d-t<u?c:a}s=d,a=c}return i+1}static nextRenderTabStop(e,t){return e+t-e%t}static nextIndentTabStop(e,t){return e+t-e%t}static prevRenderTabStop(e,t){return Math.max(0,e-1-(e-1)%t)}static prevIndentTabStop(e,t){return Math.max(0,e-1-(e-1)%t)}};function BM(o,e,t,n){return o!==t?Ft(t-o,n):Ft(0,n-e)}var Dn=0;function Su(o){return o===0}var Eo=2**26;function Ft(o,e){return o*Eo+e}function _i(o){let e=o,t=Math.floor(e/Eo),n=e-t*Eo;return new bu(t,n)}function VM(o){return Math.floor(o/Eo)}function Mt(o,e){let t=o+e;return e>=Eo&&(t=t-o%Eo),t}function WM(o,e){return o.reduce((t,n)=>Mt(t,e(n)),Dn)}function G_(o,e){return o===e}function Nd(o,e){let t=o,n=e;if(n-t<=0)return Dn;let r=Math.floor(t/Eo),s=Math.floor(n/Eo),a=n-s*Eo;if(r===s){let l=t-r*Eo;return Ft(0,a-l)}else return Ft(s-r,a)}function da(o,e){return o<e}function gl(o,e){return o<=e}function wu(o,e){return o>=e}function fl(o){return Ft(o.lineNumber-1,o.column-1)}function bl(o,e){let t=o,n=Math.floor(t/Eo),i=t-n*Eo,r=e,s=Math.floor(r/Eo),a=r-s*Eo;return new D(n+1,i+1,s+1,a+1)}function HM(o){let e=Bp(o);return Ft(e.length-1,e[e.length-1].length)}var _v=[],Jn=class o{constructor(e,t){this.items=e;this.additionalItems=t}static cache=new Array(129);static create(e,t){if(e<=128&&t.length===0){let n=o.cache[e];return n||(n=new o(e,t),o.cache[e]=n),n}return new o(e,t)}static empty=o.create(0,_v);static getEmpty(){return this.empty}add(e,t){let n=t.getKey(e),i=n>>5;if(i===0){let s=1<<n|this.items;return s===this.items?this:o.create(s,this.additionalItems)}i--;let r=this.additionalItems.slice(0);for(;r.length<i;)r.push(0);return r[i]|=1<<(n&31),o.create(this.items,r)}has(e,t){let n=t.getKey(e),i=n>>5;return i===0?(this.items&1<<n)!==0:(i--,((this.additionalItems[i]||0)&1<<(n&31))!==0)}merge(e){let t=this.items|e.items;if(this.additionalItems===_v&&e.additionalItems===_v)return t===this.items?this:t===e.items?e:o.create(t,_v);let n=[];for(let i=0;i<Math.max(this.additionalItems.length,e.additionalItems.length);i++){let r=this.additionalItems[i]||0,s=e.additionalItems[i]||0;n.push(r|s)}return o.create(t,n)}intersects(e){if(this.items&e.items)return!0;for(let t=0;t<Math.min(this.additionalItems.length,e.additionalItems.length);t++)if(this.additionalItems[t]&e.additionalItems[t])return!0;return!1}equals(e){if(this.items!==e.items||this.additionalItems.length!==e.additionalItems.length)return!1;for(let t=0;t<this.additionalItems.length;t++)if(this.additionalItems[t]!==e.additionalItems[t])return!1;return!0}},j_={getKey(o){return o}},Tv=class{items=new Map;getKey(e){let t=this.items.get(e);return t===void 0&&(t=this.items.size,this.items.set(e,t)),t}reverseLookup(e){return[...this.items].find(([t,n])=>n===e)?.[0]}reverseLookupSet(e){let t=[];for(let[n]of this.items)e.has(n,this)&&t.push(n);return t}keys(){return this.items.keys()}};var Lv=class o{static DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_QUOTES=`;:.,=}])> 
	`;static DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_BRACKETS=`'"\`;:.,=}])> 
	`;static DEFAULT_AUTOCLOSE_BEFORE_WHITESPACE=` 
	`;_autoClosingPairs;_surroundingPairs;_autoCloseBeforeForQuotes;_autoCloseBeforeForBrackets;constructor(e){if(e.autoClosingPairs?this._autoClosingPairs=e.autoClosingPairs.map(t=>new Iu(t)):e.brackets?this._autoClosingPairs=e.brackets.map(t=>new Iu({open:t[0],close:t[1]})):this._autoClosingPairs=[],e.__electricCharacterSupport&&e.__electricCharacterSupport.docComment){let t=e.__electricCharacterSupport.docComment;this._autoClosingPairs.push(new Iu({open:t.open,close:t.close||""}))}this._autoCloseBeforeForQuotes=typeof e.autoCloseBefore=="string"?e.autoCloseBefore:o.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_QUOTES,this._autoCloseBeforeForBrackets=typeof e.autoCloseBefore=="string"?e.autoCloseBefore:o.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_BRACKETS,this._surroundingPairs=e.surroundingPairs||this._autoClosingPairs}getAutoClosingPairs(){return this._autoClosingPairs}getAutoCloseBeforeSet(e){return e?this._autoCloseBeforeForQuotes:this._autoCloseBeforeForBrackets}getSurroundingPairs(){return this._surroundingPairs}};var Dv=class{_richEditBrackets;constructor(e){this._richEditBrackets=e}getElectricCharacters(){let e=[];if(this._richEditBrackets)for(let t of this._richEditBrackets.brackets)for(let n of t.close){let i=n.charAt(n.length-1);e.push(i)}return Xs(e)}onElectricCharacter(e,t,n){if(!this._richEditBrackets||this._richEditBrackets.brackets.length===0)return null;let i=t.findTokenIndexAtOffset(n-1);if(rr(t.getStandardTokenType(i)))return null;let r=this._richEditBrackets.reversedRegex,s=t.getLineContent().substring(0,n-1)+e,a=Vi.findPrevBracketInRange(r,1,s,0,s.length);if(!a)return null;let l=s.substring(a.startColumn-1,a.endColumn-1).toLowerCase();if(this._richEditBrackets.textIsOpenBracket[l])return null;let c=t.getActualLineContentBefore(a.startColumn-1);return/^\s*$/.test(c)?{matchOpenBracket:l}:null}};function kv(o){return o.global&&(o.lastIndex=0),!0}var Rv=class{_indentationRules;constructor(e){this._indentationRules=e}shouldIncrease(e){return!!(this._indentationRules&&this._indentationRules.increaseIndentPattern&&kv(this._indentationRules.increaseIndentPattern)&&this._indentationRules.increaseIndentPattern.test(e))}shouldDecrease(e){return!!(this._indentationRules&&this._indentationRules.decreaseIndentPattern&&kv(this._indentationRules.decreaseIndentPattern)&&this._indentationRules.decreaseIndentPattern.test(e))}shouldIndentNextLine(e){return!!(this._indentationRules&&this._indentationRules.indentNextLinePattern&&kv(this._indentationRules.indentNextLinePattern)&&this._indentationRules.indentNextLinePattern.test(e))}shouldIgnore(e){return!!(this._indentationRules&&this._indentationRules.unIndentedLinePattern&&kv(this._indentationRules.unIndentedLinePattern)&&this._indentationRules.unIndentedLinePattern.test(e))}getIndentMetadata(e){let t=0;return this.shouldIncrease(e)&&(t+=1),this.shouldDecrease(e)&&(t+=2),this.shouldIndentNextLine(e)&&(t+=4),this.shouldIgnore(e)&&(t+=8),t}};var Mv=class o{_brackets;_regExpRules;constructor(e){e=e||{},e.brackets=e.brackets||[["(",")"],["{","}"],["[","]"]],this._brackets=[],e.brackets.forEach(t=>{let n=o._createOpenBracketRegExp(t[0]),i=o._createCloseBracketRegExp(t[1]);n&&i&&this._brackets.push({open:t[0],openRegExp:n,close:t[1],closeRegExp:i})}),this._regExpRules=e.onEnterRules||[]}onEnter(e,t,n,i){if(e>=3)for(let r=0,s=this._regExpRules.length;r<s;r++){let a=this._regExpRules[r];if([{reg:a.beforeText,text:n},{reg:a.afterText,text:i},{reg:a.previousLineText,text:t}].every(d=>d.reg?(d.reg.lastIndex=0,d.reg.test(d.text)):!0))return a.action}if(e>=2&&n.length>0&&i.length>0)for(let r=0,s=this._brackets.length;r<s;r++){let a=this._brackets[r];if(a.openRegExp.test(n)&&a.closeRegExp.test(i))return{indentAction:2}}if(e>=2&&n.length>0){for(let r=0,s=this._brackets.length;r<s;r++)if(this._brackets[r].openRegExp.test(n))return{indentAction:1}}return null}static _createOpenBracketRegExp(e){let t=Qi(e);return/\B/.test(t.charAt(0))||(t="\\b"+t),t+="\\s*$",o._safeRegExp(t)}static _createCloseBracketRegExp(e){let t=Qi(e);return/\B/.test(t.charAt(t.length-1))||(t=t+"\\b"),t="^\\s*"+t,o._safeRegExp(t)}static _safeRegExp(e){try{return new RegExp(e)}catch(t){return je(t),null}}};var yH=[];function fi(o,e,t){e instanceof dm||(e=new dm(e,[],!!t)),yH.push([o,e])}var Pd=Object.freeze({text:"text/plain",binary:"application/octet-stream",unknown:"application/unknown",markdown:"text/markdown",latex:"text/latex",uriList:"text/uri-list"});var IH={ModesRegistry:"editor.modesRegistry"},q_=class{_languages;_onDidChangeLanguages=new E;onDidChangeLanguages=this._onDidChangeLanguages.event;constructor(){this._languages=[]}registerLanguage(e){return this._languages.push(e),this._onDidChangeLanguages.fire(void 0),{dispose:()=>{for(let t=0,n=this._languages.length;t<n;t++)if(this._languages[t]===e){this._languages.splice(t,1);return}}}}getLanguages(){return this._languages}},zM=new q_;et.add(IH.ModesRegistry,zM);var sr="plaintext",CH=".txt";zM.registerLanguage({id:sr,extensions:[CH],aliases:[p("plainText.alias","Plain Text"),"text"],mimetypes:[Pd.text]});et.as(bs.Configuration).registerDefaultConfigurations([{overrides:{"[plaintext]":{"editor.unicodeHighlight.ambiguousCharacters":!1,"editor.unicodeHighlight.invisibleCharacters":!1}}}]);var Rm=class{constructor(e){this.languageId=e}affects(e){return this.languageId?this.languageId===e:!0}},ca=Y("languageConfigurationService"),km=class extends V{constructor(t,n){super();this.configurationService=t;this.languageService=n;let i=new Set(Object.values(Y_));this._register(this.configurationService.onDidChangeConfiguration(r=>{let s=r.change.keys.some(l=>i.has(l)),a=r.change.overrides.filter(([l,d])=>d.some(c=>i.has(c))).map(([l])=>l);if(s)this.configurations.clear(),this.onDidChangeEmitter.fire(new Rm(void 0));else for(let l of a)this.languageService.isRegisteredLanguageId(l)&&(this.configurations.delete(l),this.onDidChangeEmitter.fire(new Rm(l)))})),this._register(this._registry.onDidChange(r=>{this.configurations.delete(r.languageId),this.onDidChangeEmitter.fire(new Rm(r.languageId))}))}_serviceBrand;_registry=this._register(new X_);onDidChangeEmitter=this._register(new E);onDidChange=this.onDidChangeEmitter.event;configurations=new Map;register(t,n,i){return this._registry.register(t,n,i)}getLanguageConfiguration(t){let n=this.configurations.get(t);return n||(n=SH(t,this._registry,this.configurationService,this.languageService),this.configurations.set(t,n)),n}};km=R([S(0,Et),S(1,Bi)],km);function SH(o,e,t,n){let i=e.getLanguageConfiguration(o);if(!i){if(!n.isRegisteredLanguageId(o))return new xu(o,{});i=new xu(o,{})}let r=wH(i.languageId,t),s=GM([i.underlyingConfig,r]);return new xu(i.languageId,s)}var Y_={brackets:"editor.language.brackets",colorizedBracketPairs:"editor.language.colorizedBracketPairs"};function wH(o,e){let t=e.getValue(Y_.brackets,{overrideIdentifier:o}),n=e.getValue(Y_.colorizedBracketPairs,{overrideIdentifier:o});return{brackets:KM(t),colorizedBracketPairs:KM(n)}}function KM(o){if(Array.isArray(o))return o.map(e=>{if(!(!Array.isArray(e)||e.length!==2))return[e[0],e[1]]}).filter(e=>!!e)}function Nv(o,e,t){let n=o.getLineContent(e),i=_n(n);return i.length>t-1&&(i=i.substring(0,t-1)),i}var Z_=class{constructor(e){this.languageId=e;this._entries=[],this._order=0,this._resolved=null}_entries;_order;_resolved=null;register(e,t){let n=new Av(e,t,++this._order);return this._entries.push(n),this._resolved=null,ve(()=>{for(let i=0;i<this._entries.length;i++)if(this._entries[i]===n){this._entries.splice(i,1),this._resolved=null;break}})}getResolvedConfiguration(){if(!this._resolved){let e=this._resolve();e&&(this._resolved=new xu(this.languageId,e))}return this._resolved}_resolve(){return this._entries.length===0?null:(this._entries.sort(Av.cmp),GM(this._entries.map(e=>e.configuration)))}};function GM(o){let e={comments:void 0,brackets:void 0,wordPattern:void 0,indentationRules:void 0,onEnterRules:void 0,autoClosingPairs:void 0,surroundingPairs:void 0,autoCloseBefore:void 0,folding:void 0,colorizedBracketPairs:void 0,__electricCharacterSupport:void 0};for(let t of o)e={comments:t.comments||e.comments,brackets:t.brackets||e.brackets,wordPattern:t.wordPattern||e.wordPattern,indentationRules:t.indentationRules||e.indentationRules,onEnterRules:t.onEnterRules||e.onEnterRules,autoClosingPairs:t.autoClosingPairs||e.autoClosingPairs,surroundingPairs:t.surroundingPairs||e.surroundingPairs,autoCloseBefore:t.autoCloseBefore||e.autoCloseBefore,folding:t.folding||e.folding,colorizedBracketPairs:t.colorizedBracketPairs||e.colorizedBracketPairs,__electricCharacterSupport:t.__electricCharacterSupport||e.__electricCharacterSupport};return e}var Av=class{constructor(e,t,n){this.configuration=e;this.priority=t;this.order=n}static cmp(e,t){return e.priority===t.priority?e.order-t.order:e.priority-t.priority}},Ov=class{constructor(e){this.languageId=e}},X_=class extends V{_entries=new Map;_onDidChange=this._register(new E);onDidChange=this._onDidChange.event;constructor(){super(),this._register(this.register(sr,{brackets:[["(",")"],["[","]"],["{","}"]],surroundingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:"<",close:">"},{open:'"',close:'"'},{open:"'",close:"'"},{open:"`",close:"`"}],colorizedBracketPairs:[],folding:{offSide:!0}},0))}register(e,t,n=0){let i=this._entries.get(e);i||(i=new Z_(e),this._entries.set(e,i));let r=i.register(t,n);return this._onDidChange.fire(new Ov(e)),ve(()=>{r.dispose(),this._onDidChange.fire(new Ov(e))})}getLanguageConfiguration(e){return this._entries.get(e)?.getResolvedConfiguration()||null}},xu=class o{constructor(e,t){this.languageId=e;this.underlyingConfig=t;this._brackets=null,this._electricCharacter=null,this._onEnterSupport=this.underlyingConfig.brackets||this.underlyingConfig.indentationRules||this.underlyingConfig.onEnterRules?new Mv(this.underlyingConfig):null,this.comments=o._handleComments(this.underlyingConfig),this.characterPair=new Lv(this.underlyingConfig),this.wordDefinition=this.underlyingConfig.wordPattern||CE,this.indentationRules=this.underlyingConfig.indentationRules,this.underlyingConfig.indentationRules?this.indentRulesSupport=new Rv(this.underlyingConfig.indentationRules):this.indentRulesSupport=null,this.foldingRules=this.underlyingConfig.folding||{},this.bracketsNew=new xv(e,this.underlyingConfig)}_brackets;_electricCharacter;_onEnterSupport;comments;characterPair;wordDefinition;indentRulesSupport;indentationRules;foldingRules;bracketsNew;getWordDefinition(){return lm(this.wordDefinition)}get brackets(){return!this._brackets&&this.underlyingConfig.brackets&&(this._brackets=new Sv(this.languageId,this.underlyingConfig.brackets)),this._brackets}get electricCharacter(){return this._electricCharacter||(this._electricCharacter=new Dv(this.brackets)),this._electricCharacter}onEnter(e,t,n,i){return this._onEnterSupport?this._onEnterSupport.onEnter(e,t,n,i):null}getAutoClosingPairs(){return new Cv(this.characterPair.getAutoClosingPairs())}getAutoCloseBeforeSet(e){return this.characterPair.getAutoCloseBeforeSet(e)}getSurroundingPairs(){return this.characterPair.getSurroundingPairs()}static _handleComments(e){let t=e.comments;if(!t)return null;let n={};if(t.lineComment&&(n.lineCommentToken=t.lineComment),t.blockComment){let[i,r]=t.blockComment;n.blockCommentStartToken=i,n.blockCommentEndToken=r}return n}};fi(ca,km,1);var Q_=class o{constructor(e){this.map=e}static createFromLanguage(e,t){function n(r){return t.getKey(`${r.languageId}:::${r.bracketText}`)}let i=new Map;for(let r of e.bracketsNew.openingBrackets){let s=Ft(0,r.bracketText.length),a=n(r),l=Jn.getEmpty().add(a,j_);i.set(r.bracketText,new Mr(s,1,a,l,Mm.create(s,r,l)))}for(let r of e.bracketsNew.closingBrackets){let s=Ft(0,r.bracketText.length),a=Jn.getEmpty(),l=r.getOpeningBrackets();for(let d of l)a=a.add(n(d),j_);i.set(r.bracketText,new Mr(s,2,n(l[0]),a,Mm.create(s,r,a)))}return new o(i)}hasRegExp=!1;_regExpGlobal=null;getRegExpStr(){if(this.isEmpty)return null;{let e=[...this.map.keys()];return e.sort(),e.reverse(),e.map(t=>xH(t)).join("|")}}get regExpGlobal(){if(!this.hasRegExp){let e=this.getRegExpStr();this._regExpGlobal=e?new RegExp(e,"gi"):null,this.hasRegExp=!0}return this._regExpGlobal}getToken(e){return this.map.get(e.toLowerCase())}findClosingTokenText(e){for(let[t,n]of this.map)if(n.kind===2&&n.bracketIds.intersects(e))return t}get isEmpty(){return this.map.size===0}};function xH(o){let e=Qi(o);return/^[\w ]+/.test(o)&&(e=`\\b${e}`),/[\w ]+$/.test(o)&&(e=`${e}\\b`),e}var Pv=class{constructor(e,t){this.denseKeyProvider=e;this.getLanguageConfiguration=t}languageIdToBracketTokens=new Map;didLanguageChange(e){return this.languageIdToBracketTokens.has(e)}getSingleLanguageBracketTokens(e){let t=this.languageIdToBracketTokens.get(e);return t||(t=Q_.createFromLanguage(this.getLanguageConfiguration(e),this.denseKeyProvider),this.languageIdToBracketTokens.set(e,t)),t}getToken(e,t){return this.getSingleLanguageBracketTokens(t).getToken(e)}};var Mr=class{constructor(e,t,n,i,r){this.length=e;this.kind=t;this.bracketId=n;this.bracketIds=i;this.astNode=r}},Fv=class{constructor(e,t){this.textModel=e;this.bracketTokens=t;this.textBufferLineCount=e.getLineCount(),this.textBufferLastLineLength=e.getLineLength(this.textBufferLineCount)}textBufferLineCount;textBufferLastLineLength;reader=new J_(this.textModel,this.bracketTokens);_offset=Dn;get offset(){return this._offset}get length(){return Ft(this.textBufferLineCount-1,this.textBufferLastLineLength)}getText(){return this.textModel.getValue()}skip(e){this.didPeek=!1,this._offset=Mt(this._offset,e);let t=_i(this._offset);this.reader.setPosition(t.lineCount,t.columnCount)}didPeek=!1;peeked=null;read(){let e;return this.peeked?(this.didPeek=!1,e=this.peeked):e=this.reader.read(),e&&(this._offset=Mt(this._offset,e.length)),e}peek(){return this.didPeek||(this.peeked=this.reader.read(),this.didPeek=!0),this.peeked}},J_=class{constructor(e,t){this.textModel=e;this.bracketTokens=t;this.textBufferLineCount=e.getLineCount(),this.textBufferLastLineLength=e.getLineLength(this.textBufferLineCount)}textBufferLineCount;textBufferLastLineLength;lineIdx=0;line=null;lineCharOffset=0;lineTokens=null;lineTokenOffset=0;setPosition(e,t){e===this.lineIdx?(this.lineCharOffset=t,this.line!==null&&(this.lineTokenOffset=this.lineCharOffset===0?0:this.lineTokens.findTokenIndexAtOffset(this.lineCharOffset))):(this.lineIdx=e,this.lineCharOffset=t,this.line=null),this.peekedToken=null}peekedToken=null;read(){if(this.peekedToken){let r=this.peekedToken;return this.peekedToken=null,this.lineCharOffset+=r.length,r}if(this.lineIdx>this.textBufferLineCount-1||this.lineIdx===this.textBufferLineCount-1&&this.lineCharOffset>=this.textBufferLastLineLength)return null;this.line===null&&(this.lineTokens=this.textModel.tokenization.getLineTokens(this.lineIdx+1),this.line=this.lineTokens.getLineContent(),this.lineTokenOffset=this.lineCharOffset===0?0:this.lineTokens.findTokenIndexAtOffset(this.lineCharOffset));let e=this.lineIdx,t=this.lineCharOffset,n=0;for(;;){let r=this.lineTokens,s=r.getCount(),a=null;if(this.lineTokenOffset<s){let l=r.getMetadata(this.lineTokenOffset);for(;this.lineTokenOffset+1<s&&l===r.getMetadata(this.lineTokenOffset+1);)this.lineTokenOffset++;let d=wo.getTokenType(l)===0,c=wo.containsBalancedBrackets(l),u=r.getEndOffset(this.lineTokenOffset);if(c&&d&&this.lineCharOffset<u){let h=r.getLanguageId(this.lineTokenOffset),m=this.line.substring(this.lineCharOffset,u),f=this.bracketTokens.getSingleLanguageBracketTokens(h),g=f.regExpGlobal;if(g){g.lastIndex=0;let b=g.exec(m);b&&(a=f.getToken(b[0]),a&&(this.lineCharOffset+=b.index))}}if(n+=u-this.lineCharOffset,a)if(e!==this.lineIdx||t!==this.lineCharOffset){this.peekedToken=a;break}else return this.lineCharOffset+=a.length,a;else this.lineTokenOffset++,this.lineCharOffset=u}else if(this.lineIdx===this.textBufferLineCount-1||(this.lineIdx++,this.lineTokens=this.textModel.tokenization.getLineTokens(this.lineIdx+1),this.lineTokenOffset=0,this.line=this.lineTokens.getLineContent(),this.lineCharOffset=0,n+=33,n>1e3))break;if(n>1500)break}let i=BM(e,t,this.lineIdx,this.lineCharOffset);return new Mr(i,0,-1,Jn.getEmpty(),new Ar(i))}},Bv=class{constructor(e,t){this.text=e;let n=t.getRegExpStr(),i=n?new RegExp(n+`|
`,"gi"):null,r=[],s,a=0,l=0,d=0,c=0,u=[];for(let f=0;f<60;f++)u.push(new Mr(Ft(0,f),0,-1,Jn.getEmpty(),new Ar(Ft(0,f))));let h=[];for(let f=0;f<60;f++)h.push(new Mr(Ft(1,f),0,-1,Jn.getEmpty(),new Ar(Ft(1,f))));if(i)for(i.lastIndex=0;(s=i.exec(e))!==null;){let f=s.index,g=s[0];if(g===`
`)a++,l=f+1;else{if(d!==f){let b;if(c===a){let y=f-d;if(y<u.length)b=u[y];else{let C=Ft(0,y);b=new Mr(C,0,-1,Jn.getEmpty(),new Ar(C))}}else{let y=a-c,C=f-l;if(y===1&&C<h.length)b=h[C];else{let x=Ft(y,C);b=new Mr(x,0,-1,Jn.getEmpty(),new Ar(x))}}r.push(b)}r.push(t.getToken(g)),d=f+g.length,c=a}}let m=e.length;if(d!==m){let f=c===a?Ft(0,m-d):Ft(a-c,m-l);r.push(new Mr(f,0,-1,Jn.getEmpty(),new Ar(f)))}this.length=Ft(a,m-l),this.tokens=r}_offset=Dn;tokens;idx=0;get offset(){return this._offset}length;read(){return this.tokens[this.idx++]||null}peek(){return this.tokens[this.idx]||null}skip(e){throw new Sf}getText(){return this.text}};var Am=class{_length;get length(){return this._length}constructor(e){this._length=e}},Om=class o extends Am{constructor(t,n,i,r,s){super(t);this.openingBracket=n;this.child=i;this.closingBracket=r;this.missingOpeningBracketIds=s}static create(t,n,i){let r=t.length;return n&&(r=Mt(r,n.length)),i&&(r=Mt(r,i.length)),new o(r,t,n,i,n?n.missingOpeningBracketIds:Jn.getEmpty())}get kind(){return 2}get listHeight(){return 0}get childrenLength(){return 3}getChild(t){switch(t){case 0:return this.openingBracket;case 1:return this.child;case 2:return this.closingBracket}throw new Error("Invalid child index")}get children(){let t=[];return t.push(this.openingBracket),this.child&&t.push(this.child),this.closingBracket&&t.push(this.closingBracket),t}canBeReused(t){return!(this.closingBracket===null||t.intersects(this.missingOpeningBracketIds))}flattenLists(){return o.create(this.openingBracket.flattenLists(),this.child&&this.child.flattenLists(),this.closingBracket&&this.closingBracket.flattenLists())}deepClone(){return new o(this.length,this.openingBracket.deepClone(),this.child&&this.child.deepClone(),this.closingBracket&&this.closingBracket.deepClone(),this.missingOpeningBracketIds)}computeMinIndentation(t,n){return this.child?this.child.computeMinIndentation(Mt(t,this.openingBracket.length),n):Number.MAX_SAFE_INTEGER}},_o=class o extends Am{constructor(t,n,i){super(t);this.listHeight=n;this._missingOpeningBracketIds=i}static create23(t,n,i,r=!1){let s=t.length,a=t.missingOpeningBracketIds;if(t.listHeight!==n.listHeight)throw new Error("Invalid list heights");if(s=Mt(s,n.length),a=a.merge(n.missingOpeningBracketIds),i){if(t.listHeight!==i.listHeight)throw new Error("Invalid list heights");s=Mt(s,i.length),a=a.merge(i.missingOpeningBracketIds)}return r?new eT(s,t.listHeight+1,t,n,i,a):new Nm(s,t.listHeight+1,t,n,i,a)}static create(t,n=!1){if(t.length===0)return this.getEmpty();{let i=t[0].length,r=t[0].missingOpeningBracketIds;for(let s=1;s<t.length;s++)i=Mt(i,t[s].length),r=r.merge(t[s].missingOpeningBracketIds);return n?new Vv(i,t[0].listHeight+1,t,r):new Pm(i,t[0].listHeight+1,t,r)}}static getEmpty(){return new Vv(Dn,0,[],Jn.getEmpty())}get kind(){return 4}get missingOpeningBracketIds(){return this._missingOpeningBracketIds}cachedMinIndentation=-1;throwIfImmutable(){}makeLastElementMutable(){this.throwIfImmutable();let t=this.childrenLength;if(t===0)return;let n=this.getChild(t-1),i=n.kind===4?n.toMutable():n;return n!==i&&this.setChild(t-1,i),i}makeFirstElementMutable(){if(this.throwIfImmutable(),this.childrenLength===0)return;let n=this.getChild(0),i=n.kind===4?n.toMutable():n;return n!==i&&this.setChild(0,i),i}canBeReused(t){if(t.intersects(this.missingOpeningBracketIds)||this.childrenLength===0)return!1;let n=this;for(;n.kind===4;){let i=n.childrenLength;if(i===0)throw new Qe;n=n.getChild(i-1)}return n.canBeReused(t)}handleChildrenChanged(){this.throwIfImmutable();let t=this.childrenLength,n=this.getChild(0).length,i=this.getChild(0).missingOpeningBracketIds;for(let r=1;r<t;r++){let s=this.getChild(r);n=Mt(n,s.length),i=i.merge(s.missingOpeningBracketIds)}this._length=n,this._missingOpeningBracketIds=i,this.cachedMinIndentation=-1}flattenLists(){let t=[];for(let n of this.children){let i=n.flattenLists();i.kind===4?t.push(...i.children):t.push(i)}return o.create(t)}computeMinIndentation(t,n){if(this.cachedMinIndentation!==-1)return this.cachedMinIndentation;let i=Number.MAX_SAFE_INTEGER,r=t;for(let s=0;s<this.childrenLength;s++){let a=this.getChild(s);a&&(i=Math.min(i,a.computeMinIndentation(r,n)),r=Mt(r,a.length))}return this.cachedMinIndentation=i,i}},Nm=class o extends _o{constructor(t,n,i,r,s,a){super(t,n,a);this._item1=i;this._item2=r;this._item3=s}get childrenLength(){return this._item3!==null?3:2}getChild(t){switch(t){case 0:return this._item1;case 1:return this._item2;case 2:return this._item3}throw new Error("Invalid child index")}setChild(t,n){switch(t){case 0:this._item1=n;return;case 1:this._item2=n;return;case 2:this._item3=n;return}throw new Error("Invalid child index")}get children(){return this._item3?[this._item1,this._item2,this._item3]:[this._item1,this._item2]}get item1(){return this._item1}get item2(){return this._item2}get item3(){return this._item3}deepClone(){return new o(this.length,this.listHeight,this._item1.deepClone(),this._item2.deepClone(),this._item3?this._item3.deepClone():null,this.missingOpeningBracketIds)}appendChildOfSameHeight(t){if(this._item3)throw new Error("Cannot append to a full (2,3) tree node");this.throwIfImmutable(),this._item3=t,this.handleChildrenChanged()}unappendChild(){if(!this._item3)throw new Error("Cannot remove from a non-full (2,3) tree node");this.throwIfImmutable();let t=this._item3;return this._item3=null,this.handleChildrenChanged(),t}prependChildOfSameHeight(t){if(this._item3)throw new Error("Cannot prepend to a full (2,3) tree node");this.throwIfImmutable(),this._item3=this._item2,this._item2=this._item1,this._item1=t,this.handleChildrenChanged()}unprependChild(){if(!this._item3)throw new Error("Cannot remove from a non-full (2,3) tree node");this.throwIfImmutable();let t=this._item1;return this._item1=this._item2,this._item2=this._item3,this._item3=null,this.handleChildrenChanged(),t}toMutable(){return this}},eT=class extends Nm{toMutable(){return new Nm(this.length,this.listHeight,this.item1,this.item2,this.item3,this.missingOpeningBracketIds)}throwIfImmutable(){throw new Error("this instance is immutable")}},Pm=class o extends _o{constructor(t,n,i,r){super(t,n,r);this._children=i}get childrenLength(){return this._children.length}getChild(t){return this._children[t]}setChild(t,n){this._children[t]=n}get children(){return this._children}deepClone(){let t=new Array(this._children.length);for(let n=0;n<this._children.length;n++)t[n]=this._children[n].deepClone();return new o(this.length,this.listHeight,t,this.missingOpeningBracketIds)}appendChildOfSameHeight(t){this.throwIfImmutable(),this._children.push(t),this.handleChildrenChanged()}unappendChild(){this.throwIfImmutable();let t=this._children.pop();return this.handleChildrenChanged(),t}prependChildOfSameHeight(t){this.throwIfImmutable(),this._children.unshift(t),this.handleChildrenChanged()}unprependChild(){this.throwIfImmutable();let t=this._children.shift();return this.handleChildrenChanged(),t}toMutable(){return this}},Vv=class extends Pm{toMutable(){return new Pm(this.length,this.listHeight,[...this.children],this.missingOpeningBracketIds)}throwIfImmutable(){throw new Error("this instance is immutable")}},_H=[],Fm=class extends Am{get listHeight(){return 0}get childrenLength(){return 0}getChild(e){return null}get children(){return _H}flattenLists(){return this}deepClone(){return this}},Ar=class extends Fm{get kind(){return 0}get missingOpeningBracketIds(){return Jn.getEmpty()}canBeReused(e){return!0}computeMinIndentation(e,t){let n=_i(e),i=(n.columnCount===0?n.lineCount:n.lineCount+1)+1,r=VM(Mt(e,this.length))+1,s=Number.MAX_SAFE_INTEGER;for(let a=i;a<=r;a++){let l=t.getLineFirstNonWhitespaceColumn(a),d=t.getLineContent(a);if(l===0)continue;let c=_t.visibleColumnFromColumn(d,l,t.getOptions().tabSize);s=Math.min(s,c)}return s}},Mm=class o extends Fm{constructor(t,n,i){super(t);this.bracketInfo=n;this.bracketIds=i}static create(t,n,i){return new o(t,n,i)}get kind(){return 1}get missingOpeningBracketIds(){return Jn.getEmpty()}get text(){return this.bracketInfo.bracketText}get languageId(){return this.bracketInfo.languageId}canBeReused(t){return!1}computeMinIndentation(t,n){return Number.MAX_SAFE_INTEGER}},Wv=class extends Fm{get kind(){return 3}missingOpeningBracketIds;constructor(e,t){super(t),this.missingOpeningBracketIds=e}canBeReused(e){return!e.intersects(this.missingOpeningBracketIds)}computeMinIndentation(e,t){return Number.MAX_SAFE_INTEGER}};var Bm=class{constructor(e,t,n,i){this.range=e;this.nestingLevel=t;this.nestingLevelOfEqualBracketType=n;this.isInvalid=i}},tT=class{constructor(e,t,n,i,r,s){this.range=e;this.openingBracketRange=t;this.closingBracketRange=n;this.nestingLevel=i;this.nestingLevelOfEqualBracketType=r;this.bracketPairNode=s}get openingBracketInfo(){return this.bracketPairNode.openingBracket.bracketInfo}get closingBracketInfo(){return this.bracketPairNode.closingBracket?.bracketInfo}},Hv=class extends tT{constructor(t,n,i,r,s,a,l){super(t,n,i,r,s,a);this.minVisibleColumnIndentation=l}};var Uv=class{changeType=1},oo=class o{constructor(e,t,n,i,r){this.ownerId=e;this.lineNumber=t;this.column=n;this.options=i;this.order=r}static applyInjectedText(e,t){if(!t||t.length===0)return e;let n="",i=0;for(let r of t)n+=e.substring(i,r.column-1),i=r.column-1,n+=r.options.content;return n+=e.substring(i),n}static fromDecorations(e){let t=[];for(let n of e)n.options.before&&n.options.before.content.length>0&&t.push(new o(n.ownerId,n.range.startLineNumber,n.range.startColumn,n.options.before,0)),n.options.after&&n.options.after.content.length>0&&t.push(new o(n.ownerId,n.range.endLineNumber,n.range.endColumn,n.options.after,1));return t.sort((n,i)=>n.lineNumber===i.lineNumber?n.column===i.column?n.order-i.order:n.column-i.column:n.lineNumber-i.lineNumber),t}withText(e){return new o(this.ownerId,this.lineNumber,this.column,{...this.options,content:e},this.order)}},Vm=class{changeType=2;lineNumber;detail;injectedText;constructor(e,t,n){this.lineNumber=e,this.detail=t,this.injectedText=n}},zv=class{changeType=3;fromLineNumber;toLineNumber;constructor(e,t){this.fromLineNumber=e,this.toLineNumber=t}},Kv=class{changeType=4;fromLineNumber;toLineNumber;detail;injectedTexts;constructor(e,t,n,i){this.injectedTexts=i,this.fromLineNumber=e,this.toLineNumber=t,this.detail=n}},Gv=class{changeType=5},Fd=class o{changes;versionId;isUndoing;isRedoing;resultingSelection;constructor(e,t,n,i){this.changes=e,this.versionId=t,this.isUndoing=n,this.isRedoing=i,this.resultingSelection=null}containsEvent(e){for(let t=0,n=this.changes.length;t<n;t++)if(this.changes[t].changeType===e)return!0;return!1}static merge(e,t){let n=[].concat(e.changes).concat(t.changes),i=t.versionId,r=e.isUndoing||t.isUndoing,s=e.isRedoing||t.isRedoing;return new o(n,i,r,s)}},Eu=class{changes;constructor(e){this.changes=e}},yl=class o{constructor(e,t){this.rawContentChangedEvent=e;this.contentChangedEvent=t}merge(e){let t=Fd.merge(this.rawContentChangedEvent,e.rawContentChangedEvent),n=o._mergeChangeEvents(this.contentChangedEvent,e.contentChangedEvent);return new o(t,n)}static _mergeChangeEvents(e,t){let n=[].concat(e.changes).concat(t.changes),i=t.eol,r=t.versionId,s=e.isUndoing||t.isUndoing,a=e.isRedoing||t.isRedoing,l=e.isFlush||t.isFlush,d=e.isEolChange&&t.isEolChange;return{changes:n,eol:i,isEolChange:d,versionId:r,isUndoing:s,isRedoing:a,isFlush:l}}};var ar=class{constructor(e,t,n,i,r,s){this.visibleColumn=e;this.column=t;this.className=n;this.horizontalLine=i;this.forWrappedLinesAfterColumn=r;this.forWrappedLinesBeforeOrAtColumn=s;if(e!==-1==(t!==-1))throw new Error}},ua=class{constructor(e,t){this.top=e;this.endColumn=t}};var jv=class o{constructor(e){this.edits=e;let t=-1;for(let n of e){if(!(n.replaceRange.start>=t))throw new Qe(`Edits must be disjoint and sorted. Found ${n} after ${t}`);t=n.replaceRange.endExclusive}}static empty=new o([]);static fromJson(e){return new o(e.map(Or.fromJson))}static replace(e,t){return new o([new Or(e,t)])}static insert(e,t){return o.replace(Pt.emptyAt(e),t)}normalize(){let e=[],t;for(let n of this.edits)n.newText.length===0&&n.replaceRange.length===0||(t&&t.replaceRange.endExclusive===n.replaceRange.start?t=new Or(t.replaceRange.join(n.replaceRange),t.newText+n.newText):(t&&e.push(t),t=n));return t&&e.push(t),new o(e)}toString(){return`[${this.edits.map(t=>t.toString()).join(", ")}]`}apply(e){let t=[],n=0;for(let i of this.edits)t.push(e.substring(n,i.replaceRange.start)),t.push(i.newText),n=i.replaceRange.endExclusive;return t.push(e.substring(n)),t.join("")}compose(e){return LH(this,e)}inverse(e){let t=[],n=0;for(let i of this.edits)t.push(new Or(Pt.ofStartAndLength(i.replaceRange.start+n,i.newText.length),e.substring(i.replaceRange.start,i.replaceRange.endExclusive))),n+=i.newText.length-i.replaceRange.length;return new o(t)}getNewTextRanges(){let e=[],t=0;for(let n of this.edits)e.push(Pt.ofStartAndLength(n.replaceRange.start+t,n.newText.length)),t+=n.newText.length-n.replaceRange.length;return e}get isEmpty(){return this.edits.length===0}tryRebase(e){let t=[],n=0,i=0,r=0;for(;i<this.edits.length||n<e.edits.length;){let s=e.edits[n],a=this.edits[i];if(a)s?a.replaceRange.intersects(s.replaceRange)?i++:a.replaceRange.start<s.replaceRange.start?(t.push(new Or(a.replaceRange.delta(r),a.newText)),i++):(n++,r+=s.newText.length-s.replaceRange.length):(t.push(new Or(a.replaceRange.delta(r),a.newText)),i++);else break}return new o(t)}applyToOffset(e){let t=0;for(let n of this.edits)if(n.replaceRange.start<=e){if(e<n.replaceRange.endExclusive)return n.replaceRange.start+t;t+=n.newText.length-n.replaceRange.length}else break;return e+t}applyToOffsetRange(e){return new Pt(this.applyToOffset(e.start),this.applyToOffset(e.endExclusive))}applyInverseToOffset(e){let t=0;for(let n of this.edits){let i=n.newText.length;if(n.replaceRange.start<=e-t){if(e-t<n.replaceRange.start+i)return n.replaceRange.start;t+=i-n.replaceRange.length}else break}return e-t}},Or=class o{constructor(e,t){this.replaceRange=e;this.newText=t}static fromJson(e){return new o(Pt.ofStartAndLength(e.pos,e.len),e.txt)}static insert(e,t){return new o(Pt.emptyAt(e),t)}toString(){return`${this.replaceRange} -> "${this.newText}"`}get isEmpty(){return this.newText.length===0&&this.replaceRange.length===0}};function LH(o,e){if(o=o.normalize(),e=e.normalize(),o.isEmpty)return e;if(e.isEmpty)return o;let t=[...o.edits],n=[],i=0;for(let r of e.edits){for(;;){let d=t[0];if(!d||d.replaceRange.start+i+d.newText.length>=r.replaceRange.start)break;t.shift(),n.push(d),i+=d.newText.length-d.replaceRange.length}let s=i,a,l;for(;;){let d=t[0];if(!d||d.replaceRange.start+i>r.replaceRange.endExclusive)break;a||(a=d),l=d,t.shift(),i+=d.newText.length-d.replaceRange.length}if(!a)n.push(new Or(r.replaceRange.delta(-i),r.newText));else{let d="",c=r.replaceRange.start-(a.replaceRange.start+s);c>0&&(d=a.newText.slice(0,c));let u=l.replaceRange.endExclusive+i-r.replaceRange.endExclusive;if(u>0){let f=new Or(Pt.ofStartAndLength(l.replaceRange.endExclusive,0),l.newText.slice(-u));t.unshift(f),i-=f.newText.length-f.replaceRange.length}let h=d+r.newText,m=new Pt(Math.min(a.replaceRange.start,r.replaceRange.start-s),r.replaceRange.endExclusive-i);n.push(new Or(m,h))}}for(;;){let r=t.shift();if(!r)break;n.push(r)}return new jv(n).normalize()}var qM=Y("undoRedoService");var jM=class o{static _ID=0;id;order;constructor(){this.id=o._ID++,this.order=1}nextOrder(){return this.id===0?0:this.order++}static None=new o},$M=class o{static _ID=0;id;order;constructor(){this.id=o._ID++,this.order=1}nextOrder(){return this.id===0?0:this.order++}static None=new o};var _u=class{_textModelResolvedOptionsBrand=void 0;tabSize;indentSize;_indentSizeIsTabSize;insertSpaces;defaultEOL;trimAutoWhitespace;bracketPairColorizationOptions;get originalIndentSize(){return this._indentSizeIsTabSize?"tabSize":this.indentSize}constructor(e){this.tabSize=Math.max(1,e.tabSize|0),e.indentSize==="tabSize"?(this.indentSize=this.tabSize,this._indentSizeIsTabSize=!0):(this.indentSize=Math.max(1,e.indentSize|0),this._indentSizeIsTabSize=!1),this.insertSpaces=!!e.insertSpaces,this.defaultEOL=e.defaultEOL|0,this.trimAutoWhitespace=!!e.trimAutoWhitespace,this.bracketPairColorizationOptions=e.bracketPairColorizationOptions}equals(e){return this.tabSize===e.tabSize&&this._indentSizeIsTabSize===e._indentSizeIsTabSize&&this.indentSize===e.indentSize&&this.insertSpaces===e.insertSpaces&&this.defaultEOL===e.defaultEOL&&this.trimAutoWhitespace===e.trimAutoWhitespace&&Zn(this.bracketPairColorizationOptions,e.bracketPairColorizationOptions)}createChangeEvent(e){return{tabSize:this.tabSize!==e.tabSize,indentSize:this.indentSize!==e.indentSize,insertSpaces:this.insertSpaces!==e.insertSpaces,trimAutoWhitespace:this.trimAutoWhitespace!==e.trimAutoWhitespace}}},Il=class{_findMatchBrand=void 0;range;matches;constructor(e,t){this.range=e,this.matches=t}};function YM(o){return o&&typeof o.read=="function"}var Tu=class{constructor(e,t,n,i,r,s){this.identifier=e;this.range=t;this.text=n;this.forceMoveMarkers=i;this.isAutoWhitespaceEdit=r;this._isTracked=s}},$v=class{regex;wordSeparators;simpleSearch;constructor(e,t,n){this.regex=e,this.wordSeparators=t,this.simpleSearch=n}},qv=class{constructor(e,t,n){this.reverseEdits=e;this.changes=t;this.trimAutoWhitespaceLineNumbers=n}};var nT={ICodeEditor:"vs.editor.ICodeEditor",IDiffEditor:"vs.editor.IDiffEditor"};var ha=class{constructor(e,t,n,i,r){this.injectionOffsets=e;this.injectionOptions=t;this.breakOffsets=n;this.breakOffsetsVisibleColumn=i;this.wrappedTextIndentLength=r}getOutputLineCount(){return this.breakOffsets.length}getMinOutputOffset(e){return e>0?this.wrappedTextIndentLength:0}getLineLength(e){let t=e>0?this.breakOffsets[e-1]:0,i=this.breakOffsets[e]-t;return e>0&&(i+=this.wrappedTextIndentLength),i}getMaxOutputOffset(e){return this.getLineLength(e)}translateToInputOffset(e,t){e>0&&(t=Math.max(0,t-this.wrappedTextIndentLength));let i=e===0?t:this.breakOffsets[e-1]+t;if(this.injectionOffsets!==null)for(let r=0;r<this.injectionOffsets.length&&i>this.injectionOffsets[r];r++)i<this.injectionOffsets[r]+this.injectionOptions[r].content.length?i=this.injectionOffsets[r]:i-=this.injectionOptions[r].content.length;return i}translateToOutputPosition(e,t=2){let n=e;if(this.injectionOffsets!==null)for(let i=0;i<this.injectionOffsets.length&&!(e<this.injectionOffsets[i]||t!==1&&e===this.injectionOffsets[i]);i++)n+=this.injectionOptions[i].content.length;return this.offsetInInputWithInjectionsToOutputPosition(n,t)}offsetInInputWithInjectionsToOutputPosition(e,t=2){let n=0,i=this.breakOffsets.length-1,r=0,s=0;for(;n<=i;){r=n+(i-n)/2|0;let l=this.breakOffsets[r];if(s=r>0?this.breakOffsets[r-1]:0,t===0)if(e<=s)i=r-1;else if(e>l)n=r+1;else break;else if(e<s)i=r-1;else if(e>=l)n=r+1;else break}let a=e-s;return r>0&&(a+=this.wrappedTextIndentLength),new Lu(r,a)}normalizeOutputPosition(e,t,n){if(this.injectionOffsets!==null){let i=this.outputPositionToOffsetInInputWithInjections(e,t),r=this.normalizeOffsetInInputWithInjectionsAroundInjections(i,n);if(r!==i)return this.offsetInInputWithInjectionsToOutputPosition(r,n)}if(n===0){if(e>0&&t===this.getMinOutputOffset(e))return new Lu(e-1,this.getMaxOutputOffset(e-1))}else if(n===1){let i=this.getOutputLineCount()-1;if(e<i&&t===this.getMaxOutputOffset(e))return new Lu(e+1,this.getMinOutputOffset(e+1))}return new Lu(e,t)}outputPositionToOffsetInInputWithInjections(e,t){return e>0&&(t=Math.max(0,t-this.wrappedTextIndentLength)),(e>0?this.breakOffsets[e-1]:0)+t}normalizeOffsetInInputWithInjectionsAroundInjections(e,t){let n=this.getInjectedTextAtOffset(e);if(!n)return e;if(t===2){if(e===n.offsetInInputWithInjections+n.length&&ZM(this.injectionOptions[n.injectedTextIndex].cursorStops))return n.offsetInInputWithInjections+n.length;{let i=n.offsetInInputWithInjections;if(XM(this.injectionOptions[n.injectedTextIndex].cursorStops))return i;let r=n.injectedTextIndex-1;for(;r>=0&&this.injectionOffsets[r]===this.injectionOffsets[n.injectedTextIndex]&&!(ZM(this.injectionOptions[r].cursorStops)||(i-=this.injectionOptions[r].content.length,XM(this.injectionOptions[r].cursorStops)));)r--;return i}}else if(t===1||t===4){let i=n.offsetInInputWithInjections+n.length,r=n.injectedTextIndex;for(;r+1<this.injectionOffsets.length&&this.injectionOffsets[r+1]===this.injectionOffsets[r];)i+=this.injectionOptions[r+1].content.length,r++;return i}else if(t===0||t===3){let i=n.offsetInInputWithInjections,r=n.injectedTextIndex;for(;r-1>=0&&this.injectionOffsets[r-1]===this.injectionOffsets[r];)i-=this.injectionOptions[r-1].content.length,r--;return i}Pf(t)}getInjectedText(e,t){let n=this.outputPositionToOffsetInInputWithInjections(e,t),i=this.getInjectedTextAtOffset(n);return i?{options:this.injectionOptions[i.injectedTextIndex]}:null}getInjectedTextAtOffset(e){let t=this.injectionOffsets,n=this.injectionOptions;if(t!==null){let i=0;for(let r=0;r<t.length;r++){let s=n[r].content.length,a=t[r]+i,l=t[r]+i+s;if(a>e)break;if(e<=l)return{injectedTextIndex:r,offsetInInputWithInjections:a,length:s};i+=s}}}};function ZM(o){return o==null?!0:o===1||o===0}function XM(o){return o==null?!0:o===2||o===0}var Lu=class{outputLineIndex;outputOffset;constructor(e,t){this.outputLineIndex=e,this.outputOffset=t}toString(){return`${this.outputLineIndex}:${this.outputOffset}`}toPosition(e){return new P(e+this.outputLineIndex,this.outputOffset+1)}};function kH(o,e,t){let n=0;for(let r=0;r<o.length;r++)o.charAt(r)==="	"?n=_t.nextIndentTabStop(n,e):n++;let i="";if(!t){let r=Math.floor(n/e);n=n%e;for(let s=0;s<r;s++)i+="	"}for(let r=0;r<n;r++)i+=" ";return i}function Yv(o,e,t){let n=Xt(o);return n===-1&&(n=o.length),kH(o.substring(0,n),e,t)+o.substring(n)}var RH=()=>!0,MH=()=>!1,AH=o=>o===" "||o==="	",pa=class{constructor(e,t,n,i){this.languageConfigurationService=i;this._languageId=e;let r=n.options,s=r.get(147),a=r.get(51);this.readOnly=r.get(93),this.tabSize=t.tabSize,this.indentSize=t.indentSize,this.insertSpaces=t.insertSpaces,this.stickyTabStops=r.get(118),this.lineHeight=a.lineHeight,this.typicalHalfwidthCharacterWidth=a.typicalHalfwidthCharacterWidth,this.pageSize=Math.max(1,Math.floor(s.height/this.lineHeight)-2),this.useTabStops=r.get(130),this.wordSeparators=r.get(133),this.emptySelectionClipboard=r.get(38),this.copyWithSyntaxHighlighting=r.get(25),this.multiCursorMergeOverlapping=r.get(78),this.multiCursorPaste=r.get(80),this.multiCursorLimit=r.get(81),this.autoClosingBrackets=r.get(6),this.autoClosingComments=r.get(7),this.autoClosingQuotes=r.get(11),this.autoClosingDelete=r.get(9),this.autoClosingOvertype=r.get(10),this.autoSurround=r.get(14),this.autoIndent=r.get(12),this.wordSegmenterLocales=r.get(132),this.surroundingPairs={},this._electricChars=null,this.shouldAutoCloseBefore={quote:this._getShouldAutoClose(e,this.autoClosingQuotes,!0),comment:this._getShouldAutoClose(e,this.autoClosingComments,!1),bracket:this._getShouldAutoClose(e,this.autoClosingBrackets,!1)},this.autoClosingPairs=this.languageConfigurationService.getLanguageConfiguration(e).getAutoClosingPairs();let l=this.languageConfigurationService.getLanguageConfiguration(e).getSurroundingPairs();if(l)for(let c of l)this.surroundingPairs[c.open]=c.close;let d=this.languageConfigurationService.getLanguageConfiguration(e).comments;this.blockCommentStartToken=d?.blockCommentStartToken??null}_cursorMoveConfigurationBrand=void 0;readOnly;tabSize;indentSize;insertSpaces;stickyTabStops;pageSize;lineHeight;typicalHalfwidthCharacterWidth;useTabStops;wordSeparators;emptySelectionClipboard;copyWithSyntaxHighlighting;multiCursorMergeOverlapping;multiCursorPaste;multiCursorLimit;autoClosingBrackets;autoClosingComments;autoClosingQuotes;autoClosingDelete;autoClosingOvertype;autoSurround;autoIndent;autoClosingPairs;surroundingPairs;blockCommentStartToken;shouldAutoCloseBefore;wordSegmenterLocales;_languageId;_electricChars;static shouldRecreate(e){return e.hasChanged(147)||e.hasChanged(133)||e.hasChanged(38)||e.hasChanged(78)||e.hasChanged(80)||e.hasChanged(81)||e.hasChanged(6)||e.hasChanged(7)||e.hasChanged(11)||e.hasChanged(9)||e.hasChanged(10)||e.hasChanged(14)||e.hasChanged(130)||e.hasChanged(51)||e.hasChanged(93)||e.hasChanged(132)}get electricChars(){if(!this._electricChars){this._electricChars={};let e=this.languageConfigurationService.getLanguageConfiguration(this._languageId).electricCharacter?.getElectricCharacters();if(e)for(let t of e)this._electricChars[t]=!0}return this._electricChars}onElectricCharacter(e,t,n){let i=xs(t,n-1),r=this.languageConfigurationService.getLanguageConfiguration(i.languageId).electricCharacter;return r?r.onElectricCharacter(e,i,n-i.firstCharOffset):null}normalizeIndentation(e){return Yv(e,this.indentSize,this.insertSpaces)}_getShouldAutoClose(e,t,n){switch(t){case"beforeWhitespace":return AH;case"languageDefined":return this._getLanguageDefinedShouldAutoClose(e,n);case"always":return RH;case"never":return MH}}_getLanguageDefinedShouldAutoClose(e,t){let n=this.languageConfigurationService.getLanguageConfiguration(e).getAutoCloseBeforeSet(t);return i=>n.indexOf(i)!==-1}visibleColumnFromColumn(e,t){return _t.visibleColumnFromColumn(e.getLineContent(t.lineNumber),t.column,this.tabSize)}columnFromVisibleColumn(e,t,n){let i=_t.columnFromVisibleColumn(e.getLineContent(t),n,this.tabSize),r=e.getLineMinColumn(t);if(i<r)return r;let s=e.getLineMaxColumn(t);return i>s?s:i}},Ue=class o{_cursorStateBrand=void 0;static fromModelState(e){return new oT(e)}static fromViewState(e){return new rT(e)}static fromModelSelection(e){let t=He.liftSelection(e),n=new cn(D.fromPositions(t.getSelectionStart()),0,0,t.getPosition(),0);return o.fromModelState(n)}static fromModelSelections(e){let t=[];for(let n=0,i=e.length;n<i;n++)t[n]=this.fromModelSelection(e[n]);return t}modelState;viewState;constructor(e,t){this.modelState=e,this.viewState=t}equals(e){return this.viewState.equals(e.viewState)&&this.modelState.equals(e.modelState)}},oT=class{modelState;viewState;constructor(e){this.modelState=e,this.viewState=null}},rT=class{modelState;viewState;constructor(e){this.modelState=null,this.viewState=e}};var cn=class o{constructor(e,t,n,i,r){this.selectionStart=e;this.selectionStartKind=t;this.selectionStartLeftoverVisibleColumns=n;this.position=i;this.leftoverVisibleColumns=r;this.selection=o._computeSelection(this.selectionStart,this.position)}_singleCursorStateBrand=void 0;selection;equals(e){return this.selectionStartLeftoverVisibleColumns===e.selectionStartLeftoverVisibleColumns&&this.leftoverVisibleColumns===e.leftoverVisibleColumns&&this.selectionStartKind===e.selectionStartKind&&this.position.equals(e.position)&&this.selectionStart.equalsRange(e.selectionStart)}hasSelection(){return!this.selection.isEmpty()||!this.selectionStart.isEmpty()}move(e,t,n,i){return e?new o(this.selectionStart,this.selectionStartKind,this.selectionStartLeftoverVisibleColumns,new P(t,n),i):new o(new D(t,n,t,n),0,i,new P(t,n),i)}static _computeSelection(e,t){return e.isEmpty()||!t.isBeforeOrEqual(e.getStartPosition())?He.fromPositions(e.getStartPosition(),t):He.fromPositions(e.getEndPosition(),t)}},Sn=class{_editOperationResultBrand=void 0;type;commands;shouldPushStackElementBefore;shouldPushStackElementAfter;constructor(e,t,n){this.type=e,this.commands=t,this.shouldPushStackElementBefore=n.shouldPushStackElementBefore,this.shouldPushStackElementAfter=n.shouldPushStackElementAfter}};function Nr(o){return o==="'"||o==='"'||o==="`"}function JM(o){return`--vscode-${o.replace(/\./g,"-")}`}function re(o){return`var(${JM(o)})`}function eA(o,e){return`var(${JM(o)}, ${e})`}function OH(o){return o!==null&&typeof o=="object"&&"light"in o&&"dark"in o}var NH={ColorContribution:"base.contributions.colors"},PH="default",sT=class{_onDidChangeSchema=new E;onDidChangeSchema=this._onDidChangeSchema.event;colorsById;colorSchema={type:"object",properties:{}};colorReferenceSchema={type:"string",enum:[],enumDescriptions:[]};constructor(){this.colorsById={}}notifyThemeUpdate(e){for(let t of Object.keys(this.colorsById)){let n=e.getColor(t);n&&(this.colorSchema.properties[t].oneOf[0].defaultSnippets[0].body=`\${1:${n.toString()}}`)}this._onDidChangeSchema.fire()}registerColor(e,t,n,i=!1,r){let s={id:e,description:n,defaults:t,needsTransparency:i,deprecationMessage:r};this.colorsById[e]=s;let a={type:"string",format:"color-hex",defaultSnippets:[{body:"${1:#ff0000}"}]};return r&&(a.deprecationMessage=r),i&&(a.pattern="^#(?:(?<rgba>[0-9a-fA-f]{3}[0-9a-eA-E])|(?:[0-9a-fA-F]{6}(?:(?![fF]{2})(?:[0-9a-fA-F]{2}))))?$",a.patternErrorMessage=p("transparecyRequired","This color must be transparent or it will obscure content")),this.colorSchema.properties[e]={description:n,oneOf:[a,{type:"string",const:PH,description:p("useDefault","Use the default color.")}]},this.colorReferenceSchema.enum.push(e),this.colorReferenceSchema.enumDescriptions.push(n),this._onDidChangeSchema.fire(),e}deregisterColor(e){delete this.colorsById[e],delete this.colorSchema.properties[e];let t=this.colorReferenceSchema.enum.indexOf(e);t!==-1&&(this.colorReferenceSchema.enum.splice(t,1),this.colorReferenceSchema.enumDescriptions.splice(t,1)),this._onDidChangeSchema.fire()}getColors(){return Object.keys(this.colorsById).map(e=>this.colorsById[e])}resolveDefaultColor(e,t){let n=this.colorsById[e];if(n?.defaults){let i=OH(n.defaults)?n.defaults[t.type]:n.defaults;return Pr(i,t)}}getColorSchema(){return this.colorSchema}getColorReferenceSchema(){return this.colorReferenceSchema}toString(){let e=(t,n)=>{let i=t.indexOf(".")===-1?0:1,r=n.indexOf(".")===-1?0:1;return i!==r?i-r:t.localeCompare(n)};return Object.keys(this.colorsById).sort(e).map(t=>`- \`${t}\`: ${this.colorsById[t].description}`).join(`
`)}},Zv=new sT;et.add(NH.ColorContribution,Zv);function I(o,e,t,n,i){return Zv.registerColor(o,e,t,n,i)}function FH(o,e){switch(o.op){case 0:return Pr(o.value,e)?.darken(o.factor);case 1:return Pr(o.value,e)?.lighten(o.factor);case 2:return Pr(o.value,e)?.transparent(o.factor);case 3:{let t=Pr(o.background,e);return t?Pr(o.value,e)?.makeOpaque(t):Pr(o.value,e)}case 4:for(let t of o.values){let n=Pr(t,e);if(n)return n}return;case 6:return Pr(e.defines(o.if)?o.then:o.else,e);case 5:{let t=Pr(o.value,e);if(!t)return;let n=Pr(o.background,e);return n?t.isDarkerThan(n)?N.getLighterColor(t,n,o.factor).transparent(o.transparency):N.getDarkerColor(t,n,o.factor).transparent(o.transparency):t.transparent(o.factor*o.transparency)}default:throw Pf(o)}}function Ti(o,e){return{op:0,value:o,factor:e}}function Wi(o,e){return{op:1,value:o,factor:e}}function me(o,e){return{op:2,value:o,factor:e}}function aT(...o){return{op:4,values:o}}function tA(o,e,t){return{op:6,if:o,then:e,else:t}}function lT(o,e,t,n){return{op:5,value:o,background:e,factor:t,transparency:n}}function Pr(o,e){if(o!==null){if(typeof o=="string")return o[0]==="#"?N.fromHex(o):e.getColor(o);if(o instanceof N)return o;if(typeof o=="object")return FH(o,e)}}var nA="vscode://schemas/workbench-colors",iA=et.as(Sd.JSONContribution);iA.registerSchema(nA,Zv.getColorSchema());var QM=new Qt(()=>iA.notifySchemaChanged(nA),200);Zv.onDidChangeSchema(()=>{QM.isScheduled()||QM.schedule()});var it=I("foreground",{dark:"#CCCCCC",light:"#616161",hcDark:"#FFFFFF",hcLight:"#292929"},p("foreground","Overall foreground color. This color is only used if not overridden by a component.")),qae=I("disabledForeground",{dark:"#CCCCCC80",light:"#61616180",hcDark:"#A5A5A5",hcLight:"#7F7F7F"},p("disabledForeground","Overall foreground for disabled elements. This color is only used if not overridden by a component.")),dT=I("errorForeground",{dark:"#F48771",light:"#A1260D",hcDark:"#F48771",hcLight:"#B5200D"},p("errorForeground","Overall foreground color for error messages. This color is only used if not overridden by a component.")),Yae=I("descriptionForeground",{light:"#717171",dark:me(it,.7),hcDark:me(it,.7),hcLight:me(it,.7)},p("descriptionForeground","Foreground color for description text providing additional information, for example for a label.")),Wm=I("icon.foreground",{dark:"#C5C5C5",light:"#424242",hcDark:"#FFFFFF",hcLight:"#292929"},p("iconForeground","The default color for icons in the workbench.")),Li=I("focusBorder",{dark:"#007FD4",light:"#0090F1",hcDark:"#F38518",hcLight:"#006BBD"},p("focusBorder","Overall border color for focused elements. This color is only used if not overridden by a component.")),be=I("contrastBorder",{light:null,dark:null,hcDark:"#6FC3DF",hcLight:"#0F4A85"},p("contrastBorder","An extra border around elements to separate them from others for greater contrast.")),Ct=I("contrastActiveBorder",{light:null,dark:null,hcDark:Li,hcLight:Li},p("activeContrastBorder","An extra border around active elements to separate them from others for greater contrast.")),Zae=I("selection.background",null,p("selectionBackground","The background color of text selections in the workbench (e.g. for input fields or text areas). Note that this does not apply to selections within the editor.")),Xv=I("textLink.foreground",{light:"#006AB1",dark:"#3794FF",hcDark:"#21A6FF",hcLight:"#0F4A85"},p("textLinkForeground","Foreground color for links in text.")),Xae=I("textLink.activeForeground",{light:"#006AB1",dark:"#3794FF",hcDark:"#21A6FF",hcLight:"#0F4A85"},p("textLinkActiveForeground","Foreground color for links in text when clicked on and on mouse hover.")),Qae=I("textSeparator.foreground",{light:"#0000002e",dark:"#ffffff2e",hcDark:N.black,hcLight:"#292929"},p("textSeparatorForeground","Color for text separators.")),Jae=I("textPreformat.foreground",{light:"#A31515",dark:"#D7BA7D",hcDark:"#000000",hcLight:"#FFFFFF"},p("textPreformatForeground","Foreground color for preformatted text segments.")),ele=I("textPreformat.background",{light:"#0000001A",dark:"#FFFFFF1A",hcDark:"#FFFFFF",hcLight:"#09345f"},p("textPreformatBackground","Background color for preformatted text segments.")),tle=I("textBlockQuote.background",{light:"#f2f2f2",dark:"#222222",hcDark:null,hcLight:"#F2F2F2"},p("textBlockQuoteBackground","Background color for block quotes in text.")),nle=I("textBlockQuote.border",{light:"#007acc80",dark:"#007acc80",hcDark:N.white,hcLight:"#292929"},p("textBlockQuoteBorder","Border color for block quotes in text.")),ile=I("textCodeBlock.background",{light:"#dcdcdc66",dark:"#0a0a0a66",hcDark:N.black,hcLight:"#F2F2F2"},p("textCodeBlockBackground","Background color for code blocks in text."));var lle=I("sash.hoverBorder",Li,p("sashActiveBorder","Border color of active sashes.")),Cl=I("badge.background",{dark:"#4D4D4D",light:"#C4C4C4",hcDark:N.black,hcLight:"#0F4A85"},p("badgeBackground","Badge background color. Badges are small information labels, e.g. for search results count.")),Qv=I("badge.foreground",{dark:N.white,light:"#333",hcDark:N.white,hcLight:N.white},p("badgeForeground","Badge foreground color. Badges are small information labels, e.g. for search results count.")),Sl=I("scrollbar.shadow",{dark:"#000000",light:"#DDDDDD",hcDark:null,hcLight:null},p("scrollbarShadow","Scrollbar shadow to indicate that the view is scrolled.")),Jv=I("scrollbarSlider.background",{dark:N.fromHex("#797979").transparent(.4),light:N.fromHex("#646464").transparent(.4),hcDark:me(be,.6),hcLight:me(be,.4)},p("scrollbarSliderBackground","Scrollbar slider background color.")),ey=I("scrollbarSlider.hoverBackground",{dark:N.fromHex("#646464").transparent(.7),light:N.fromHex("#646464").transparent(.7),hcDark:me(be,.8),hcLight:me(be,.8)},p("scrollbarSliderHoverBackground","Scrollbar slider background color when hovering.")),ty=I("scrollbarSlider.activeBackground",{dark:N.fromHex("#BFBFBF").transparent(.4),light:N.fromHex("#000000").transparent(.6),hcDark:be,hcLight:be},p("scrollbarSliderActiveBackground","Scrollbar slider background color when clicked on.")),oA=I("progressBar.background",{dark:N.fromHex("#0E70C0"),light:N.fromHex("#0E70C0"),hcDark:be,hcLight:be},p("progressBarBackground","Background color of the progress bar that can show for long running operations."));var lr=I("editor.background",{light:"#ffffff",dark:"#1E1E1E",hcDark:N.black,hcLight:N.white},p("editorBackground","Editor background color.")),Es=I("editor.foreground",{light:"#333333",dark:"#BBBBBB",hcDark:N.white,hcLight:it},p("editorForeground","Editor default foreground color.")),mle=I("editorStickyScroll.background",lr,p("editorStickyScrollBackground","Background color of sticky scroll in the editor")),gle=I("editorStickyScrollHover.background",{dark:"#2A2D2E",light:"#F0F0F0",hcDark:null,hcLight:N.fromHex("#0F4A85").transparent(.1)},p("editorStickyScrollHoverBackground","Background color of sticky scroll on hover in the editor")),fle=I("editorStickyScroll.border",{dark:null,light:null,hcDark:be,hcLight:be},p("editorStickyScrollBorder","Border color of sticky scroll in the editor")),ble=I("editorStickyScroll.shadow",Sl,p("editorStickyScrollShadow"," Shadow color of sticky scroll in the editor")),ei=I("editorWidget.background",{dark:"#252526",light:"#F3F3F3",hcDark:"#0C141F",hcLight:N.white},p("editorWidgetBackground","Background color of editor widgets, such as find/replace.")),_s=I("editorWidget.foreground",it,p("editorWidgetForeground","Foreground color of editor widgets, such as find/replace.")),pT=I("editorWidget.border",{dark:"#454545",light:"#C8C8C8",hcDark:be,hcLight:be},p("editorWidgetBorder","Border color of editor widgets. The color is only used if the widget chooses to have a border and if the color is not overridden by a widget.")),vle=I("editorWidget.resizeBorder",null,p("editorWidgetResizeBorder","Border color of the resize bar of editor widgets. The color is only used if the widget chooses to have a resize border and if the color is not overridden by a widget.")),yle=I("editorError.background",null,p("editorError.background","Background color of error text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0),Vd=I("editorError.foreground",{dark:"#F14C4C",light:"#E51400",hcDark:"#F48771",hcLight:"#B5200D"},p("editorError.foreground","Foreground color of error squigglies in the editor.")),Ile=I("editorError.border",{dark:null,light:null,hcDark:N.fromHex("#E47777").transparent(.8),hcLight:"#B5200D"},p("errorBorder","If set, color of double underlines for errors in the editor.")),uA=I("editorWarning.background",null,p("editorWarning.background","Background color of warning text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0),Hi=I("editorWarning.foreground",{dark:"#CCA700",light:"#BF8803",hcDark:"#FFD370",hcLight:"#895503"},p("editorWarning.foreground","Foreground color of warning squigglies in the editor.")),Mu=I("editorWarning.border",{dark:null,light:null,hcDark:N.fromHex("#FFCC00").transparent(.8),hcLight:N.fromHex("#FFCC00").transparent(.8)},p("warningBorder","If set, color of double underlines for warnings in the editor.")),Cle=I("editorInfo.background",null,p("editorInfo.background","Background color of info text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0),To=I("editorInfo.foreground",{dark:"#3794FF",light:"#1a85ff",hcDark:"#3794FF",hcLight:"#1a85ff"},p("editorInfo.foreground","Foreground color of info squigglies in the editor.")),Au=I("editorInfo.border",{dark:null,light:null,hcDark:N.fromHex("#3794FF").transparent(.8),hcLight:"#292929"},p("infoBorder","If set, color of double underlines for infos in the editor.")),hA=I("editorHint.foreground",{dark:N.fromHex("#eeeeee").transparent(.7),light:"#6c6c6c",hcDark:null,hcLight:null},p("editorHint.foreground","Foreground color of hint squigglies in the editor.")),Sle=I("editorHint.border",{dark:null,light:null,hcDark:N.fromHex("#eeeeee").transparent(.8),hcLight:"#292929"},p("hintBorder","If set, color of double underlines for hints in the editor.")),wle=I("editorLink.activeForeground",{dark:"#4E94CE",light:N.blue,hcDark:N.cyan,hcLight:"#292929"},p("activeLinkForeground","Color of active links.")),Du=I("editor.selectionBackground",{light:"#ADD6FF",dark:"#264F78",hcDark:"#f3f518",hcLight:"#0F4A85"},p("editorSelectionBackground","Color of the editor selection.")),pA=I("editor.selectionForeground",{light:null,dark:null,hcDark:"#000000",hcLight:N.white},p("editorSelectionForeground","Color of the selected text for high contrast.")),xle=I("editor.inactiveSelectionBackground",{light:me(Du,.5),dark:me(Du,.5),hcDark:me(Du,.7),hcLight:me(Du,.5)},p("editorInactiveSelection","Color of the selection in an inactive editor. The color must not be opaque so as not to hide underlying decorations."),!0),Ele=I("editor.selectionHighlightBackground",{light:lT(Du,lr,.3,.6),dark:lT(Du,lr,.3,.6),hcDark:null,hcLight:null},p("editorSelectionHighlight","Color for regions with the same content as the selection. The color must not be opaque so as not to hide underlying decorations."),!0),_le=I("editor.selectionHighlightBorder",{light:null,dark:null,hcDark:Ct,hcLight:Ct},p("editorSelectionHighlightBorder","Border color for regions with the same content as the selection.")),Tle=I("editor.findMatchBackground",{light:"#A8AC94",dark:"#515C6A",hcDark:null,hcLight:null},p("editorFindMatch","Color of the current search match.")),Lle=I("editor.findMatchForeground",null,p("editorFindMatchForeground","Text color of the current search match.")),Fr=I("editor.findMatchHighlightBackground",{light:"#EA5C0055",dark:"#EA5C0055",hcDark:null,hcLight:null},p("findMatchHighlight","Color of the other search matches. The color must not be opaque so as not to hide underlying decorations."),!0),Dle=I("editor.findMatchHighlightForeground",null,p("findMatchHighlightForeground","Foreground color of the other search matches."),!0),kle=I("editor.findRangeHighlightBackground",{dark:"#3a3d4166",light:"#b4b4b44d",hcDark:null,hcLight:null},p("findRangeHighlight","Color of the range limiting the search. The color must not be opaque so as not to hide underlying decorations."),!0),Rle=I("editor.findMatchBorder",{light:null,dark:null,hcDark:Ct,hcLight:Ct},p("editorFindMatchBorder","Border color of the current search match.")),wl=I("editor.findMatchHighlightBorder",{light:null,dark:null,hcDark:Ct,hcLight:Ct},p("findMatchHighlightBorder","Border color of the other search matches.")),Mle=I("editor.findRangeHighlightBorder",{dark:null,light:null,hcDark:me(Ct,.4),hcLight:me(Ct,.4)},p("findRangeHighlightBorder","Border color of the range limiting the search. The color must not be opaque so as not to hide underlying decorations."),!0),Ale=I("editor.hoverHighlightBackground",{light:"#ADD6FF26",dark:"#264f7840",hcDark:"#ADD6FF26",hcLight:null},p("hoverHighlight","Highlight below the word for which a hover is shown. The color must not be opaque so as not to hide underlying decorations."),!0),rA=I("editorHoverWidget.background",ei,p("hoverBackground","Background color of the editor hover.")),Ole=I("editorHoverWidget.foreground",_s,p("hoverForeground","Foreground color of the editor hover.")),Nle=I("editorHoverWidget.border",pT,p("hoverBorder","Border color of the editor hover.")),Ple=I("editorHoverWidget.statusBarBackground",{dark:Wi(rA,.2),light:Ti(rA,.05),hcDark:ei,hcLight:ei},p("statusBarBackground","Background color of the editor hover status bar.")),mA=I("editorInlayHint.foreground",{dark:"#969696",light:"#969696",hcDark:N.white,hcLight:N.black},p("editorInlayHintForeground","Foreground color of inline hints")),gA=I("editorInlayHint.background",{dark:me(Cl,.1),light:me(Cl,.1),hcDark:me(N.white,.1),hcLight:me(Cl,.1)},p("editorInlayHintBackground","Background color of inline hints")),Fle=I("editorInlayHint.typeForeground",mA,p("editorInlayHintForegroundTypes","Foreground color of inline hints for types")),Ble=I("editorInlayHint.typeBackground",gA,p("editorInlayHintBackgroundTypes","Background color of inline hints for types")),Vle=I("editorInlayHint.parameterForeground",mA,p("editorInlayHintForegroundParameter","Foreground color of inline hints for parameters")),Wle=I("editorInlayHint.parameterBackground",gA,p("editorInlayHintBackgroundParameter","Background color of inline hints for parameters")),BH=I("editorLightBulb.foreground",{dark:"#FFCC00",light:"#DDB100",hcDark:"#FFCC00",hcLight:"#007ACC"},p("editorLightBulbForeground","The color used for the lightbulb actions icon.")),Hle=I("editorLightBulbAutoFix.foreground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},p("editorLightBulbAutoFixForeground","The color used for the lightbulb auto fix actions icon.")),Ule=I("editorLightBulbAi.foreground",BH,p("editorLightBulbAiForeground","The color used for the lightbulb AI icon.")),zle=I("editor.snippetTabstopHighlightBackground",{dark:new N(new Ge(124,124,124,.3)),light:new N(new Ge(10,50,100,.2)),hcDark:new N(new Ge(124,124,124,.3)),hcLight:new N(new Ge(10,50,100,.2))},p("snippetTabstopHighlightBackground","Highlight background color of a snippet tabstop.")),Kle=I("editor.snippetTabstopHighlightBorder",null,p("snippetTabstopHighlightBorder","Highlight border color of a snippet tabstop.")),Gle=I("editor.snippetFinalTabstopHighlightBackground",null,p("snippetFinalTabstopHighlightBackground","Highlight background color of the final tabstop of a snippet.")),jle=I("editor.snippetFinalTabstopHighlightBorder",{dark:"#525252",light:new N(new Ge(10,50,100,.5)),hcDark:"#525252",hcLight:"#292929"},p("snippetFinalTabstopHighlightBorder","Highlight border color of the final tabstop of a snippet.")),sA=new N(new Ge(155,185,85,.2)),aA=new N(new Ge(255,0,0,.2)),$le=I("diffEditor.insertedTextBackground",{dark:"#9ccc2c33",light:"#9ccc2c40",hcDark:null,hcLight:null},p("diffEditorInserted","Background color for text that got inserted. The color must not be opaque so as not to hide underlying decorations."),!0),qle=I("diffEditor.removedTextBackground",{dark:"#ff000033",light:"#ff000033",hcDark:null,hcLight:null},p("diffEditorRemoved","Background color for text that got removed. The color must not be opaque so as not to hide underlying decorations."),!0),Yle=I("diffEditor.insertedLineBackground",{dark:sA,light:sA,hcDark:null,hcLight:null},p("diffEditorInsertedLines","Background color for lines that got inserted. The color must not be opaque so as not to hide underlying decorations."),!0),Zle=I("diffEditor.removedLineBackground",{dark:aA,light:aA,hcDark:null,hcLight:null},p("diffEditorRemovedLines","Background color for lines that got removed. The color must not be opaque so as not to hide underlying decorations."),!0),Xle=I("diffEditorGutter.insertedLineBackground",null,p("diffEditorInsertedLineGutter","Background color for the margin where lines got inserted.")),Qle=I("diffEditorGutter.removedLineBackground",null,p("diffEditorRemovedLineGutter","Background color for the margin where lines got removed.")),Jle=I("diffEditorOverview.insertedForeground",null,p("diffEditorOverviewInserted","Diff overview ruler foreground for inserted content.")),ede=I("diffEditorOverview.removedForeground",null,p("diffEditorOverviewRemoved","Diff overview ruler foreground for removed content.")),tde=I("diffEditor.insertedTextBorder",{dark:null,light:null,hcDark:"#33ff2eff",hcLight:"#374E06"},p("diffEditorInsertedOutline","Outline color for the text that got inserted.")),nde=I("diffEditor.removedTextBorder",{dark:null,light:null,hcDark:"#FF008F",hcLight:"#AD0707"},p("diffEditorRemovedOutline","Outline color for text that got removed.")),ide=I("diffEditor.border",{dark:null,light:null,hcDark:be,hcLight:be},p("diffEditorBorder","Border color between the two text editors.")),ode=I("diffEditor.diagonalFill",{dark:"#cccccc33",light:"#22222233",hcDark:null,hcLight:null},p("diffDiagonalFill","Color of the diff editor's diagonal fill. The diagonal fill is used in side-by-side diff views.")),rde=I("diffEditor.unchangedRegionBackground","sideBar.background",p("diffEditor.unchangedRegionBackground","The background color of unchanged blocks in the diff editor.")),sde=I("diffEditor.unchangedRegionForeground","foreground",p("diffEditor.unchangedRegionForeground","The foreground color of unchanged blocks in the diff editor.")),ade=I("diffEditor.unchangedCodeBackground",{dark:"#74747429",light:"#b8b8b829",hcDark:null,hcLight:null},p("diffEditor.unchangedCodeBackground","The background color of unchanged code in the diff editor.")),Ou=I("widget.shadow",{dark:me(N.black,.36),light:me(N.black,.16),hcDark:null,hcLight:null},p("widgetShadow","Shadow color of widgets such as find/replace inside the editor.")),Um=I("widget.border",{dark:null,light:null,hcDark:be,hcLight:be},p("widgetBorder","Border color of widgets such as find/replace inside the editor.")),Hm=I("toolbar.hoverBackground",{dark:"#5a5d5e50",light:"#b8b8b850",hcDark:null,hcLight:null},p("toolbarHoverBackground","Toolbar background when hovering over actions using the mouse")),lde=I("toolbar.hoverOutline",{dark:null,light:null,hcDark:Ct,hcLight:Ct},p("toolbarHoverOutline","Toolbar outline when hovering over actions using the mouse")),dde=I("toolbar.activeBackground",{dark:Wi(Hm,.1),light:Ti(Hm,.1),hcDark:null,hcLight:null},p("toolbarActiveBackground","Toolbar background when holding the mouse over actions")),fA=I("breadcrumb.foreground",me(it,.8),p("breadcrumbsFocusForeground","Color of focused breadcrumb items.")),bA=I("breadcrumb.background",lr,p("breadcrumbsBackground","Background color of breadcrumb items.")),mT=I("breadcrumb.focusForeground",{light:Ti(it,.2),dark:Wi(it,.1),hcDark:Wi(it,.1),hcLight:Wi(it,.1)},p("breadcrumbsFocusForeground","Color of focused breadcrumb items.")),vA=I("breadcrumb.activeSelectionForeground",{light:Ti(it,.2),dark:Wi(it,.1),hcDark:Wi(it,.1),hcLight:Wi(it,.1)},p("breadcrumbsSelectedForeground","Color of selected breadcrumb items.")),cde=I("breadcrumbPicker.background",ei,p("breadcrumbsSelectedBackground","Background color of breadcrumb item picker.")),yA=.5,lA=N.fromHex("#40C8AE").transparent(yA),dA=N.fromHex("#40A6FF").transparent(yA),cA=N.fromHex("#606060").transparent(.4),gT=.4,ku=1,cT=I("merge.currentHeaderBackground",{dark:lA,light:lA,hcDark:null,hcLight:null},p("mergeCurrentHeaderBackground","Current header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),ude=I("merge.currentContentBackground",me(cT,gT),p("mergeCurrentContentBackground","Current content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),uT=I("merge.incomingHeaderBackground",{dark:dA,light:dA,hcDark:null,hcLight:null},p("mergeIncomingHeaderBackground","Incoming header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),hde=I("merge.incomingContentBackground",me(uT,gT),p("mergeIncomingContentBackground","Incoming content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),hT=I("merge.commonHeaderBackground",{dark:cA,light:cA,hcDark:null,hcLight:null},p("mergeCommonHeaderBackground","Common ancestor header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),pde=I("merge.commonContentBackground",me(hT,gT),p("mergeCommonContentBackground","Common ancestor content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),Ru=I("merge.border",{dark:null,light:null,hcDark:"#C3DF6F",hcLight:"#007ACC"},p("mergeBorder","Border color on headers and the splitter in inline merge-conflicts.")),mde=I("editorOverviewRuler.currentContentForeground",{dark:me(cT,ku),light:me(cT,ku),hcDark:Ru,hcLight:Ru},p("overviewRulerCurrentContentForeground","Current overview ruler foreground for inline merge-conflicts.")),gde=I("editorOverviewRuler.incomingContentForeground",{dark:me(uT,ku),light:me(uT,ku),hcDark:Ru,hcLight:Ru},p("overviewRulerIncomingContentForeground","Incoming overview ruler foreground for inline merge-conflicts.")),fde=I("editorOverviewRuler.commonContentForeground",{dark:me(hT,ku),light:me(hT,ku),hcDark:Ru,hcLight:Ru},p("overviewRulerCommonContentForeground","Common ancestor overview ruler foreground for inline merge-conflicts.")),bde=I("editorOverviewRuler.findMatchForeground",{dark:"#d186167e",light:"#d186167e",hcDark:"#AB5A00",hcLight:"#AB5A00"},p("overviewRulerFindMatchForeground","Overview ruler marker color for find matches. The color must not be opaque so as not to hide underlying decorations."),!0),vde=I("editorOverviewRuler.selectionHighlightForeground","#A0A0A0CC",p("overviewRulerSelectionHighlightForeground","Overview ruler marker color for selection highlights. The color must not be opaque so as not to hide underlying decorations."),!0),IA=I("problemsErrorIcon.foreground",Vd,p("problemsErrorIconForeground","The color used for the problems error icon.")),CA=I("problemsWarningIcon.foreground",Hi,p("problemsWarningIconForeground","The color used for the problems warning icon.")),SA=I("problemsInfoIcon.foreground",To,p("problemsInfoIconForeground","The color used for the problems info icon."));var wA=I("minimap.findMatchHighlight",{light:"#d18616",dark:"#d18616",hcDark:"#AB5A00",hcLight:"#0F4A85"},p("minimapFindMatchHighlight","Minimap marker color for find matches."),!0),xde=I("minimap.selectionOccurrenceHighlight",{light:"#c9c9c9",dark:"#676767",hcDark:"#ffffff",hcLight:"#0F4A85"},p("minimapSelectionOccurrenceHighlight","Minimap marker color for repeating editor selections."),!0),fT=I("minimap.selectionHighlight",{light:"#ADD6FF",dark:"#264F78",hcDark:"#ffffff",hcLight:"#0F4A85"},p("minimapSelectionHighlight","Minimap marker color for the editor selection."),!0),Ede=I("minimap.infoHighlight",{dark:To,light:To,hcDark:Au,hcLight:Au},p("minimapInfo","Minimap marker color for infos.")),_de=I("minimap.warningHighlight",{dark:Hi,light:Hi,hcDark:Mu,hcLight:Mu},p("overviewRuleWarning","Minimap marker color for warnings.")),Tde=I("minimap.errorHighlight",{dark:new N(new Ge(255,18,18,.7)),light:new N(new Ge(255,18,18,.7)),hcDark:new N(new Ge(255,50,50,1)),hcLight:"#B5200D"},p("minimapError","Minimap marker color for errors.")),xA=I("minimap.background",null,p("minimapBackground","Minimap background color.")),EA=I("minimap.foregroundOpacity",N.fromHex("#000f"),p("minimapForegroundOpacity",'Opacity of foreground elements rendered in the minimap. For example, "#000000c0" will render the elements with 75% opacity.')),Lde=I("minimapSlider.background",me(Jv,.5),p("minimapSliderBackground","Minimap slider background color.")),Dde=I("minimapSlider.hoverBackground",me(ey,.5),p("minimapSliderHoverBackground","Minimap slider background color when hovering.")),kde=I("minimapSlider.activeBackground",me(ty,.5),p("minimapSliderActiveBackground","Minimap slider background color when clicked on."));var Pde=I("charts.foreground",it,p("chartsForeground","The foreground color used in charts.")),Fde=I("charts.lines",me(it,.5),p("chartsLines","The color used for horizontal lines in charts.")),Bde=I("charts.red",Vd,p("chartsRed","The red color used in chart visualizations.")),Vde=I("charts.blue",To,p("chartsBlue","The blue color used in chart visualizations.")),Wde=I("charts.yellow",Hi,p("chartsYellow","The yellow color used in chart visualizations.")),Hde=I("charts.orange",wA,p("chartsOrange","The orange color used in chart visualizations.")),Ude=I("charts.green",{dark:"#89D185",light:"#388A34",hcDark:"#89D185",hcLight:"#374e06"},p("chartsGreen","The green color used in chart visualizations.")),zde=I("charts.purple",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},p("chartsPurple","The purple color used in chart visualizations."));var _A=I("input.background",{dark:"#3C3C3C",light:N.white,hcDark:N.black,hcLight:N.white},p("inputBoxBackground","Input box background.")),TA=I("input.foreground",it,p("inputBoxForeground","Input box foreground.")),Fu=I("input.border",{dark:null,light:null,hcDark:be,hcLight:be},p("inputBoxBorder","Input box border.")),bT=I("inputOption.activeBorder",{dark:"#007ACC",light:"#007ACC",hcDark:be,hcLight:be},p("inputBoxActiveOptionBorder","Border color of activated options in input fields.")),VH=I("inputOption.hoverBackground",{dark:"#5a5d5e80",light:"#b8b8b850",hcDark:null,hcLight:null},p("inputOption.hoverBackground","Background color of activated options in input fields.")),vT=I("inputOption.activeBackground",{dark:me(Li,.4),light:me(Li,.2),hcDark:N.transparent,hcLight:N.transparent},p("inputOption.activeBackground","Background hover color of options in input fields.")),yT=I("inputOption.activeForeground",{dark:N.white,light:N.black,hcDark:it,hcLight:it},p("inputOption.activeForeground","Foreground color of activated options in input fields.")),Yde=I("input.placeholderForeground",{light:me(it,.5),dark:me(it,.5),hcDark:me(it,.7),hcLight:me(it,.7)},p("inputPlaceholderForeground","Input box foreground color for placeholder text.")),LA=I("inputValidation.infoBackground",{dark:"#063B49",light:"#D6ECF2",hcDark:N.black,hcLight:N.white},p("inputValidationInfoBackground","Input validation background color for information severity.")),DA=I("inputValidation.infoForeground",{dark:null,light:null,hcDark:null,hcLight:it},p("inputValidationInfoForeground","Input validation foreground color for information severity.")),kA=I("inputValidation.infoBorder",{dark:"#007acc",light:"#007acc",hcDark:be,hcLight:be},p("inputValidationInfoBorder","Input validation border color for information severity.")),RA=I("inputValidation.warningBackground",{dark:"#352A05",light:"#F6F5D2",hcDark:N.black,hcLight:N.white},p("inputValidationWarningBackground","Input validation background color for warning severity.")),MA=I("inputValidation.warningForeground",{dark:null,light:null,hcDark:null,hcLight:it},p("inputValidationWarningForeground","Input validation foreground color for warning severity.")),AA=I("inputValidation.warningBorder",{dark:"#B89500",light:"#B89500",hcDark:be,hcLight:be},p("inputValidationWarningBorder","Input validation border color for warning severity.")),OA=I("inputValidation.errorBackground",{dark:"#5A1D1D",light:"#F2DEDE",hcDark:N.black,hcLight:N.white},p("inputValidationErrorBackground","Input validation background color for error severity.")),NA=I("inputValidation.errorForeground",{dark:null,light:null,hcDark:null,hcLight:it},p("inputValidationErrorForeground","Input validation foreground color for error severity.")),PA=I("inputValidation.errorBorder",{dark:"#BE1100",light:"#BE1100",hcDark:be,hcLight:be},p("inputValidationErrorBorder","Input validation border color for error severity.")),Bu=I("dropdown.background",{dark:"#3C3C3C",light:N.white,hcDark:N.black,hcLight:N.white},p("dropdownBackground","Dropdown background.")),FA=I("dropdown.listBackground",{dark:null,light:null,hcDark:N.black,hcLight:N.white},p("dropdownListBackground","Dropdown list background.")),zm=I("dropdown.foreground",{dark:"#F0F0F0",light:it,hcDark:N.white,hcLight:it},p("dropdownForeground","Dropdown foreground.")),Km=I("dropdown.border",{dark:Bu,light:"#CECECE",hcDark:be,hcLight:be},p("dropdownBorder","Dropdown border.")),IT=I("button.foreground",N.white,p("buttonForeground","Button foreground color.")),BA=I("button.separator",me(IT,.4),p("buttonSeparator","Button separator color.")),Nu=I("button.background",{dark:"#0E639C",light:"#007ACC",hcDark:null,hcLight:"#0F4A85"},p("buttonBackground","Button background color.")),VA=I("button.hoverBackground",{dark:Wi(Nu,.2),light:Ti(Nu,.2),hcDark:Nu,hcLight:Nu},p("buttonHoverBackground","Button background color when hovering.")),WA=I("button.border",be,p("buttonBorder","Button border color.")),HA=I("button.secondaryForeground",{dark:N.white,light:N.white,hcDark:N.white,hcLight:it},p("buttonSecondaryForeground","Secondary button foreground color.")),ny=I("button.secondaryBackground",{dark:"#3A3D41",light:"#5F6A79",hcDark:null,hcLight:N.white},p("buttonSecondaryBackground","Secondary button background color.")),UA=I("button.secondaryHoverBackground",{dark:Wi(ny,.2),light:Ti(ny,.2),hcDark:null,hcLight:null},p("buttonSecondaryHoverBackground","Secondary button background color when hovering.")),Pu=I("radio.activeForeground",yT,p("radioActiveForeground","Foreground color of active radio option.")),zA=I("radio.activeBackground",vT,p("radioBackground","Background color of active radio option.")),KA=I("radio.activeBorder",bT,p("radioActiveBorder","Border color of the active radio option.")),GA=I("radio.inactiveForeground",null,p("radioInactiveForeground","Foreground color of inactive radio option.")),jA=I("radio.inactiveBackground",null,p("radioInactiveBackground","Background color of inactive radio option.")),$A=I("radio.inactiveBorder",{light:me(Pu,.2),dark:me(Pu,.2),hcDark:me(Pu,.4),hcLight:me(Pu,.2)},p("radioInactiveBorder","Border color of the inactive radio option.")),qA=I("radio.inactiveHoverBackground",VH,p("radioHoverBackground","Background color of inactive active radio option when hovering.")),YA=I("checkbox.background",Bu,p("checkbox.background","Background color of checkbox widget.")),Zde=I("checkbox.selectBackground",ei,p("checkbox.select.background","Background color of checkbox widget when the element it's in is selected.")),ZA=I("checkbox.foreground",zm,p("checkbox.foreground","Foreground color of checkbox widget.")),XA=I("checkbox.border",Km,p("checkbox.border","Border color of checkbox widget.")),Xde=I("checkbox.selectBorder",Wm,p("checkbox.select.border","Border color of checkbox widget when the element it's in is selected.")),QA=I("keybindingLabel.background",{dark:new N(new Ge(128,128,128,.17)),light:new N(new Ge(221,221,221,.4)),hcDark:N.transparent,hcLight:N.transparent},p("keybindingLabelBackground","Keybinding label background color. The keybinding label is used to represent a keyboard shortcut.")),JA=I("keybindingLabel.foreground",{dark:N.fromHex("#CCCCCC"),light:N.fromHex("#555555"),hcDark:N.white,hcLight:it},p("keybindingLabelForeground","Keybinding label foreground color. The keybinding label is used to represent a keyboard shortcut.")),eO=I("keybindingLabel.border",{dark:new N(new Ge(51,51,51,.6)),light:new N(new Ge(204,204,204,.4)),hcDark:new N(new Ge(111,195,223)),hcLight:be},p("keybindingLabelBorder","Keybinding label border color. The keybinding label is used to represent a keyboard shortcut.")),tO=I("keybindingLabel.bottomBorder",{dark:new N(new Ge(68,68,68,.6)),light:new N(new Ge(187,187,187,.4)),hcDark:new N(new Ge(111,195,223)),hcLight:it},p("keybindingLabelBottomBorder","Keybinding label border bottom color. The keybinding label is used to represent a keyboard shortcut."));var nO=I("list.focusBackground",null,p("listFocusBackground","List/Tree background color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),iO=I("list.focusForeground",null,p("listFocusForeground","List/Tree foreground color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),oO=I("list.focusOutline",{dark:Li,light:Li,hcDark:Ct,hcLight:Ct},p("listFocusOutline","List/Tree outline color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),rO=I("list.focusAndSelectionOutline",null,p("listFocusAndSelectionOutline","List/Tree outline color for the focused item when the list/tree is active and selected. An active list/tree has keyboard focus, an inactive does not.")),ro=I("list.activeSelectionBackground",{dark:"#04395E",light:"#0060C0",hcDark:null,hcLight:N.fromHex("#0F4A85").transparent(.1)},p("listActiveSelectionBackground","List/Tree background color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),Ts=I("list.activeSelectionForeground",{dark:N.white,light:N.white,hcDark:null,hcLight:null},p("listActiveSelectionForeground","List/Tree foreground color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),oy=I("list.activeSelectionIconForeground",null,p("listActiveSelectionIconForeground","List/Tree icon foreground color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),sO=I("list.inactiveSelectionBackground",{dark:"#37373D",light:"#E4E6F1",hcDark:null,hcLight:N.fromHex("#0F4A85").transparent(.1)},p("listInactiveSelectionBackground","List/Tree background color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),aO=I("list.inactiveSelectionForeground",null,p("listInactiveSelectionForeground","List/Tree foreground color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),lO=I("list.inactiveSelectionIconForeground",null,p("listInactiveSelectionIconForeground","List/Tree icon foreground color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),dO=I("list.inactiveFocusBackground",null,p("listInactiveFocusBackground","List/Tree background color for the focused item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),cO=I("list.inactiveFocusOutline",null,p("listInactiveFocusOutline","List/Tree outline color for the focused item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),CT=I("list.hoverBackground",{dark:"#2A2D2E",light:"#F0F0F0",hcDark:N.white.transparent(.1),hcLight:N.fromHex("#0F4A85").transparent(.1)},p("listHoverBackground","List/Tree background when hovering over items using the mouse.")),ST=I("list.hoverForeground",null,p("listHoverForeground","List/Tree foreground when hovering over items using the mouse.")),uO=I("list.dropBackground",{dark:"#062F4A",light:"#D6EBFF",hcDark:null,hcLight:null},p("listDropBackground","List/Tree drag and drop background when moving items over other items when using the mouse.")),hO=I("list.dropBetweenBackground",{dark:Wm,light:Wm,hcDark:null,hcLight:null},p("listDropBetweenBackground","List/Tree drag and drop border color when moving items between items when using the mouse.")),iy=I("list.highlightForeground",{dark:"#2AAAFF",light:"#0066BF",hcDark:Li,hcLight:Li},p("highlight","List/Tree foreground color of the match highlights when searching inside the list/tree.")),ice=I("list.focusHighlightForeground",{dark:iy,light:tA(ro,iy,"#BBE7FF"),hcDark:iy,hcLight:iy},p("listFocusHighlightForeground","List/Tree foreground color of the match highlights on actively focused items when searching inside the list/tree.")),oce=I("list.invalidItemForeground",{dark:"#B89500",light:"#B89500",hcDark:"#B89500",hcLight:"#B5200D"},p("invalidItemForeground","List/Tree foreground color for invalid items, for example an unresolved root in explorer.")),rce=I("list.errorForeground",{dark:"#F88070",light:"#B01011",hcDark:null,hcLight:null},p("listErrorForeground","Foreground color of list items containing errors.")),sce=I("list.warningForeground",{dark:"#CCA700",light:"#855F00",hcDark:null,hcLight:null},p("listWarningForeground","Foreground color of list items containing warnings.")),pO=I("listFilterWidget.background",{light:Ti(ei,0),dark:Wi(ei,0),hcDark:ei,hcLight:ei},p("listFilterWidgetBackground","Background color of the type filter widget in lists and trees.")),mO=I("listFilterWidget.outline",{dark:N.transparent,light:N.transparent,hcDark:"#f38518",hcLight:"#007ACC"},p("listFilterWidgetOutline","Outline color of the type filter widget in lists and trees.")),gO=I("listFilterWidget.noMatchesOutline",{dark:"#BE1100",light:"#BE1100",hcDark:be,hcLight:be},p("listFilterWidgetNoMatchesOutline","Outline color of the type filter widget in lists and trees, when there are no matches.")),fO=I("listFilterWidget.shadow",Ou,p("listFilterWidgetShadow","Shadow color of the type filter widget in lists and trees.")),ace=I("list.filterMatchBackground",{dark:Fr,light:Fr,hcDark:null,hcLight:null},p("listFilterMatchHighlight","Background color of the filtered match.")),lce=I("list.filterMatchBorder",{dark:wl,light:wl,hcDark:be,hcLight:Ct},p("listFilterMatchHighlightBorder","Border color of the filtered match.")),dce=I("list.deemphasizedForeground",{dark:"#8C8C8C",light:"#8E8E90",hcDark:"#A7A8A9",hcLight:"#666666"},p("listDeemphasizedForeground","List/Tree foreground color for items that are deemphasized.")),Vu=I("tree.indentGuidesStroke",{dark:"#585858",light:"#a9a9a9",hcDark:"#a9a9a9",hcLight:"#a5a5a5"},p("treeIndentGuidesStroke","Tree stroke color for the indentation guides.")),bO=I("tree.inactiveIndentGuidesStroke",me(Vu,.4),p("treeInactiveIndentGuidesStroke","Tree stroke color for the indentation guides that are not active.")),vO=I("tree.tableColumnsBorder",{dark:"#CCCCCC20",light:"#61616120",hcDark:null,hcLight:null},p("tableColumnsBorder","Table border color between columns.")),yO=I("tree.tableOddRowsBackground",{dark:me(it,.04),light:me(it,.04),hcDark:null,hcLight:null},p("tableOddRowsBackgroundColor","Background color for odd table rows.")),cce=I("editorActionList.background",ei,p("editorActionListBackground","Action List background color.")),uce=I("editorActionList.foreground",_s,p("editorActionListForeground","Action List foreground color.")),hce=I("editorActionList.focusForeground",Ts,p("editorActionListFocusForeground","Action List foreground color for the focused item.")),pce=I("editorActionList.focusBackground",ro,p("editorActionListFocusBackground","Action List background color for the focused item."));var IO=I("menu.border",{dark:null,light:null,hcDark:be,hcLight:be},p("menuBorder","Border color of menus.")),CO=I("menu.foreground",zm,p("menuForeground","Foreground color of menu items.")),SO=I("menu.background",Bu,p("menuBackground","Background color of menu items.")),wO=I("menu.selectionForeground",Ts,p("menuSelectionForeground","Foreground color of the selected menu item in menus.")),xO=I("menu.selectionBackground",ro,p("menuSelectionBackground","Background color of the selected menu item in menus.")),EO=I("menu.selectionBorder",{dark:null,light:null,hcDark:Ct,hcLight:Ct},p("menuSelectionBorder","Border color of the selected menu item in menus.")),_O=I("menu.separatorBackground",{dark:"#606060",light:"#D4D4D4",hcDark:be,hcLight:be},p("menuSeparatorBackground","Color of a separator menu item in menus."));var xce=I("quickInput.background",ei,p("pickerBackground","Quick picker background color. The quick picker widget is the container for pickers like the command palette.")),Ece=I("quickInput.foreground",_s,p("pickerForeground","Quick picker foreground color. The quick picker widget is the container for pickers like the command palette.")),_ce=I("quickInputTitle.background",{dark:new N(new Ge(255,255,255,.105)),light:new N(new Ge(0,0,0,.06)),hcDark:"#000000",hcLight:N.white},p("pickerTitleBackground","Quick picker title background color. The quick picker widget is the container for pickers like the command palette.")),LO=I("pickerGroup.foreground",{dark:"#3794FF",light:"#0066BF",hcDark:N.white,hcLight:"#0F4A85"},p("pickerGroupForeground","Quick picker color for grouping labels.")),Tce=I("pickerGroup.border",{dark:"#3F3F46",light:"#CCCEDB",hcDark:N.white,hcLight:"#0F4A85"},p("pickerGroupBorder","Quick picker color for grouping borders.")),TO=I("quickInput.list.focusBackground",null,"",void 0,p("quickInput.list.focusBackground deprecation","Please use quickInputList.focusBackground instead")),DO=I("quickInputList.focusForeground",Ts,p("quickInput.listFocusForeground","Quick picker foreground color for the focused item.")),kO=I("quickInputList.focusIconForeground",oy,p("quickInput.listFocusIconForeground","Quick picker icon foreground color for the focused item.")),RO=I("quickInputList.focusBackground",{dark:aT(TO,ro),light:aT(TO,ro),hcDark:null,hcLight:null},p("quickInput.listFocusBackground","Quick picker background color for the focused item."));var Mce=I("search.resultsInfoForeground",{light:it,dark:me(it,.65),hcDark:it,hcLight:it},p("search.resultsInfoForeground","Color of the text in the search viewlet's completion message.")),Ace=I("searchEditor.findMatchBackground",{light:me(Fr,.66),dark:me(Fr,.66),hcDark:Fr,hcLight:Fr},p("searchEditor.queryMatch","Color of the Search Editor query matches.")),Oce=I("searchEditor.findMatchBorder",{light:me(wl,.66),dark:me(wl,.66),hcDark:wl,hcLight:wl},p("searchEditor.editorFindMatchBorder","Border color of the Search Editor query matches."));var WH={IconContribution:"base.contributions.icons"},HH;(e=>{function o(t,n){let i=t.defaults;for(;Je.isThemeIcon(i);){let r=Wu.getIcon(i.id);if(!r)return;i=r.defaults}return i}e.getDefinition=o})(HH||={});var UH;(t=>{function o(n){return{weight:n.weight,style:n.style,src:n.src.map(i=>({format:i.format,location:i.location.toString()}))}}t.toJSONObject=o;function e(n){let i=r=>an(r)?r:void 0;if(n&&Array.isArray(n.src)&&n.src.every(r=>an(r.format)&&an(r.location)))return{weight:i(n.weight),style:i(n.style),src:n.src.map(r=>({format:r.format,location:ie.parse(r.location)}))}}t.fromJSONObject=e})(UH||={});var wT=class{_onDidChange=new E;onDidChange=this._onDidChange.event;iconsById;iconSchema={definitions:{icons:{type:"object",properties:{fontId:{type:"string",description:p("iconDefinition.fontId","The id of the font to use. If not set, the font that is defined first is used.")},fontCharacter:{type:"string",description:p("iconDefinition.fontCharacter","The font character associated with the icon definition.")}},additionalProperties:!1,defaultSnippets:[{body:{fontCharacter:"\\\\e030"}}]}},type:"object",properties:{}};iconReferenceSchema={type:"string",pattern:`^${Je.iconNameExpression}$`,enum:[],enumDescriptions:[]};iconFontsById;constructor(){this.iconsById={},this.iconFontsById={}}registerIcon(e,t,n,i){let r=this.iconsById[e];if(r){if(n&&!r.description){r.description=n,this.iconSchema.properties[e].markdownDescription=`${n} $(${e})`;let l=this.iconReferenceSchema.enum.indexOf(e);l!==-1&&(this.iconReferenceSchema.enumDescriptions[l]=n),this._onDidChange.fire()}return r}let s={id:e,description:n,defaults:t,deprecationMessage:i};this.iconsById[e]=s;let a={$ref:"#/definitions/icons"};return i&&(a.deprecationMessage=i),n&&(a.markdownDescription=`${n}: $(${e})`),this.iconSchema.properties[e]=a,this.iconReferenceSchema.enum.push(e),this.iconReferenceSchema.enumDescriptions.push(n||""),this._onDidChange.fire(),{id:e}}deregisterIcon(e){delete this.iconsById[e],delete this.iconSchema.properties[e];let t=this.iconReferenceSchema.enum.indexOf(e);t!==-1&&(this.iconReferenceSchema.enum.splice(t,1),this.iconReferenceSchema.enumDescriptions.splice(t,1)),this._onDidChange.fire()}getIcons(){return Object.keys(this.iconsById).map(e=>this.iconsById[e])}getIcon(e){return this.iconsById[e]}getIconSchema(){return this.iconSchema}getIconReferenceSchema(){return this.iconReferenceSchema}registerIconFont(e,t){let n=this.iconFontsById[e];return n||(this.iconFontsById[e]=t,this._onDidChange.fire(),t)}deregisterIconFont(e){delete this.iconFontsById[e]}getIconFont(e){return this.iconFontsById[e]}toString(){let e=(r,s)=>r.id.localeCompare(s.id),t=r=>{for(;Je.isThemeIcon(r.defaults);)r=this.iconsById[r.defaults.id];return`codicon codicon-${r?r.id:""}`},n=[];n.push("| preview     | identifier                        | default codicon ID                | description"),n.push("| ----------- | --------------------------------- | --------------------------------- | --------------------------------- |");let i=Object.keys(this.iconsById).map(r=>this.iconsById[r]);for(let r of i.filter(s=>!!s.description).sort(e))n.push(`|<i class="${t(r)}"></i>|${r.id}|${Je.isThemeIcon(r.defaults)?r.defaults.id:r.id}|${r.description||""}|`);n.push("| preview     | identifier                        "),n.push("| ----------- | --------------------------------- |");for(let r of i.filter(s=>!Je.isThemeIcon(s.defaults)).sort(e))n.push(`|<i class="${t(r)}"></i>|${r.id}|`);return n.join(`
`)}},Wu=new wT;et.add(WH.IconContribution,Wu);function xl(o,e,t,n){return Wu.registerIcon(o,e,t,n)}function zH(){let o=gE();for(let e in o){let t="\\"+o[e].toString(16);Wu.registerIcon(e,{fontCharacter:t})}}zH();var AO="vscode://schemas/icons",OO=et.as(Sd.JSONContribution);OO.registerSchema(AO,Wu.getIconSchema());var MO=new Qt(()=>OO.notifySchemaChanged(AO),200);Wu.onDidChange(()=>{MO.isScheduled()||MO.schedule()});var due=xl("widget-close",ge.close,p("widgetClose","Icon for the close action in widgets.")),cue=xl("goto-previous-location",ge.arrowUp,p("previousChangeIcon","Icon for goto previous editor location.")),uue=xl("goto-next-location",ge.arrowDown,p("nextChangeIcon","Icon for goto next editor location.")),hue=Je.modify(ge.sync,"spin"),pue=Je.modify(ge.loading,"spin");function El(o){return o==="hcDark"||o==="hcLight"}function xT(o){return o==="dark"||o==="hcDark"}var bi=Y("themeService");var Mue=ge.file,Aue=ge.folder;function Gm(o){switch(o){case"dark":return"vs-dark";case"hcDark":return"hc-black";case"hcLight":return"hc-light";default:return"vs"}}var GH={ThemingContribution:"base.contributions.theming"},ET=class{themingParticipants=[];onThemingParticipantAddedEmitter;constructor(){this.themingParticipants=[],this.onThemingParticipantAddedEmitter=new E}onColorThemeChange(e){return this.themingParticipants.push(e),this.onThemingParticipantAddedEmitter.fire(e),ve(()=>{let t=this.themingParticipants.indexOf(e);this.themingParticipants.splice(t,1)})}get onThemingParticipantAdded(){return this.onThemingParticipantAddedEmitter.event}getThemingParticipants(){return this.themingParticipants}},NO=new ET;et.add(GH.ThemingContribution,NO);function Ui(o){return NO.onColorThemeChange(o)}var ry=class extends V{constructor(t){super();this.themeService=t;this.theme=t.getColorTheme(),this._register(this.themeService.onDidColorThemeChange(n=>this.onThemeChange(n)))}theme;onThemeChange(t){this.theme=t,this.updateStyles()}updateStyles(){}getColor(t,n){let i=this.theme.getColor(t);return i&&n&&(i=n(i,this.theme)),i?i.toString():null}};var sy=class{_theme;get type(){return this._theme.type}get value(){return this._theme}constructor(e){this._theme=e}update(e){this._theme=e}getColor(e){return this._theme.getColor(e)}};var ay=class{type=0;constructor(){}},ly=class{type=1;constructor(){}},dy=class{type=2;_source;constructor(e){this._source=e}hasChanged(e){return this._source.hasChanged(e)}},cy=class{constructor(e,t,n){this.selections=e;this.modelSelections=t;this.reason=n}type=3},Ls=class{type=4;affectsMinimap;affectsOverviewRuler;affectsGlyphMargin;affectsLineNumber;constructor(e){e?(this.affectsMinimap=e.affectsMinimap,this.affectsOverviewRuler=e.affectsOverviewRuler,this.affectsGlyphMargin=e.affectsGlyphMargin,this.affectsLineNumber=e.affectsLineNumber):(this.affectsMinimap=!0,this.affectsOverviewRuler=!0,this.affectsGlyphMargin=!0,this.affectsLineNumber=!0)}},Wd=class{type=5;constructor(){}},uy=class{type=6;isFocused;constructor(e){this.isFocused=e}},hy=class{type=7},Hd=class{type=8;constructor(){}},jm=class{constructor(e,t){this.fromLineNumber=e;this.count=t}type=9},Hu=class{type=10;fromLineNumber;toLineNumber;constructor(e,t){this.fromLineNumber=e,this.toLineNumber=t}},Uu=class{type=11;fromLineNumber;toLineNumber;constructor(e,t){this.fromLineNumber=e,this.toLineNumber=t}};var ma=class{constructor(e,t,n,i,r,s,a){this.source=e;this.minimalReveal=t;this.range=n;this.selections=i;this.verticalType=r;this.revealHorizontal=s;this.scrollType=a}type=12},py=class{type=13;scrollWidth;scrollLeft;scrollHeight;scrollTop;scrollWidthChanged;scrollLeftChanged;scrollHeightChanged;scrollTopChanged;constructor(e){this.scrollWidth=e.scrollWidth,this.scrollLeft=e.scrollLeft,this.scrollHeight=e.scrollHeight,this.scrollTop=e.scrollTop,this.scrollWidthChanged=e.scrollWidthChanged,this.scrollLeftChanged=e.scrollLeftChanged,this.scrollHeightChanged=e.scrollHeightChanged,this.scrollTopChanged=e.scrollTopChanged}},my=class{constructor(e){this.theme=e}type=14},gy=class{type=15;ranges;constructor(e){this.ranges=e}},fy=class{type=16;constructor(){}},by=class{type=17;constructor(){}};var dr=class extends V{_shouldRender;constructor(){super(),this._shouldRender=!0}shouldRender(){return this._shouldRender}forceShouldRender(){this._shouldRender=!0}setShouldRender(){this._shouldRender=!0}onDidRender(){this._shouldRender=!1}onCompositionStart(e){return!1}onCompositionEnd(e){return!1}onConfigurationChanged(e){return!1}onCursorStateChanged(e){return!1}onDecorationsChanged(e){return!1}onFlushed(e){return!1}onFocusChanged(e){return!1}onLanguageConfigurationChanged(e){return!1}onLineMappingChanged(e){return!1}onLinesChanged(e){return!1}onLinesDeleted(e){return!1}onLinesInserted(e){return!1}onRevealRangeRequest(e){return!1}onScrollChanged(e){return!1}onThemeChanged(e){return!1}onTokensChanged(e){return!1}onTokensColorsChanged(e){return!1}onZonesChanged(e){return!1}handleEvents(e){let t=!1;for(let n=0,i=e.length;n<i;n++){let r=e[n];switch(r.type){case 0:this.onCompositionStart(r)&&(t=!0);break;case 1:this.onCompositionEnd(r)&&(t=!0);break;case 2:this.onConfigurationChanged(r)&&(t=!0);break;case 3:this.onCursorStateChanged(r)&&(t=!0);break;case 4:this.onDecorationsChanged(r)&&(t=!0);break;case 5:this.onFlushed(r)&&(t=!0);break;case 6:this.onFocusChanged(r)&&(t=!0);break;case 7:this.onLanguageConfigurationChanged(r)&&(t=!0);break;case 8:this.onLineMappingChanged(r)&&(t=!0);break;case 9:this.onLinesChanged(r)&&(t=!0);break;case 10:this.onLinesDeleted(r)&&(t=!0);break;case 11:this.onLinesInserted(r)&&(t=!0);break;case 12:this.onRevealRangeRequest(r)&&(t=!0);break;case 13:this.onScrollChanged(r)&&(t=!0);break;case 15:this.onTokensChanged(r)&&(t=!0);break;case 14:this.onThemeChanged(r)&&(t=!0);break;case 16:this.onTokensColorsChanged(r)&&(t=!0);break;case 17:this.onZonesChanged(r)&&(t=!0);break;default:console.info("View received unknown event: "),console.info(r)}}t&&(this._shouldRender=!0)}};var $m=class{_viewportBrand=void 0;top;left;width;height;constructor(e,t,n,i){this.top=e|0,this.left=t|0,this.width=n|0,this.height=i|0}},vy=class{tabSize;data;constructor(e,t){this.tabSize=e,this.data=t}},Ud=class{_viewLineDataBrand=void 0;content;continuesWithWrappedLine;minColumn;maxColumn;startVisibleColumn;tokens;inlineDecorations;constructor(e,t,n,i,r,s,a){this.content=e,this.continuesWithWrappedLine=t,this.minColumn=n,this.maxColumn=i,this.startVisibleColumn=r,this.tokens=s,this.inlineDecorations=a}},yy=class o{minColumn;maxColumn;content;continuesWithWrappedLine;containsRTL;isBasicASCII;tokens;inlineDecorations;tabSize;startVisibleColumn;constructor(e,t,n,i,r,s,a,l,d,c){this.minColumn=e,this.maxColumn=t,this.content=n,this.continuesWithWrappedLine=i,this.isBasicASCII=o.isBasicASCII(n,s),this.containsRTL=o.containsRTL(n,this.isBasicASCII,r),this.tokens=a,this.inlineDecorations=l,this.tabSize=d,this.startVisibleColumn=c}static isBasicASCII(e,t){return t?rb(e):!0}static containsRTL(e,t,n){return!t&&n?ea(e):!1}};var zd=class{constructor(e,t,n){this.range=e;this.inlineClassName=t;this.type=n}},Iy=class{constructor(e,t,n,i){this.startOffset=e;this.endOffset=t;this.inlineClassName=n;this.inlineClassNameAffectsLetterSpacing=i}toInlineDecoration(e){return new zd(new D(e,this.startOffset+1,e,this.endOffset+1),this.inlineClassName,this.inlineClassNameAffectsLetterSpacing?3:0)}},Ku=class{_viewModelDecorationBrand=void 0;range;options;constructor(e,t){this.range=e,this.options=t}},Kd=class o{constructor(e,t,n){this.color=e;this.zIndex=t;this.data=n}static compareByRenderingProps(e,t){return e.zIndex===t.zIndex?e.color<t.color?-1:e.color>t.color?1:0:e.zIndex-t.zIndex}static equals(e,t){return e.color===t.color&&e.zIndex===t.zIndex&&on(e.data,t.data)}static equalsArr(e,t){return on(e,t,o.equals)}};var Cy=class{_colorZoneBrand=void 0;from;to;colorId;constructor(e,t,n){this.from=e|0,this.to=t|0,this.colorId=n|0}static compare(e,t){return e.colorId===t.colorId?e.from===t.from?e.to-t.to:e.from-t.from:e.colorId-t.colorId}},_T=class{_overviewRulerZoneBrand=void 0;startLineNumber;endLineNumber;heightInLines;color;_colorZone;constructor(e,t,n,i){this.startLineNumber=e,this.endLineNumber=t,this.heightInLines=n,this.color=i,this._colorZone=null}static compare(e,t){return e.color===t.color?e.startLineNumber===t.startLineNumber?e.heightInLines===t.heightInLines?e.endLineNumber-t.endLineNumber:e.heightInLines-t.heightInLines:e.startLineNumber-t.startLineNumber:e.color<t.color?-1:1}setColorZone(e){this._colorZone=e}getColorZones(){return this._colorZone}},Sy=class{_getVerticalOffsetForLine;_zones;_colorZonesInvalid;_lineHeight;_domWidth;_domHeight;_outerHeight;_pixelRatio;_lastAssignedId;_color2Id;_id2Color;constructor(e){this._getVerticalOffsetForLine=e,this._zones=[],this._colorZonesInvalid=!1,this._lineHeight=0,this._domWidth=0,this._domHeight=0,this._outerHeight=0,this._pixelRatio=1,this._lastAssignedId=0,this._color2Id=Object.create(null),this._id2Color=[]}getId2Color(){return this._id2Color}setZones(e){this._zones=e,this._zones.sort(_T.compare)}setLineHeight(e){return this._lineHeight===e?!1:(this._lineHeight=e,this._colorZonesInvalid=!0,!0)}setPixelRatio(e){this._pixelRatio=e,this._colorZonesInvalid=!0}getDOMWidth(){return this._domWidth}getCanvasWidth(){return this._domWidth*this._pixelRatio}setDOMWidth(e){return this._domWidth===e?!1:(this._domWidth=e,this._colorZonesInvalid=!0,!0)}getDOMHeight(){return this._domHeight}getCanvasHeight(){return this._domHeight*this._pixelRatio}setDOMHeight(e){return this._domHeight===e?!1:(this._domHeight=e,this._colorZonesInvalid=!0,!0)}getOuterHeight(){return this._outerHeight}setOuterHeight(e){return this._outerHeight===e?!1:(this._outerHeight=e,this._colorZonesInvalid=!0,!0)}resolveColorZones(){let e=this._colorZonesInvalid,t=Math.floor(this._lineHeight),n=Math.floor(this.getCanvasHeight()),i=Math.floor(this._outerHeight),r=n/i,s=Math.floor(4*this._pixelRatio/2),a=[];for(let l=0,d=this._zones.length;l<d;l++){let c=this._zones[l];if(!e){let L=c.getColorZones();if(L){a.push(L);continue}}let u=this._getVerticalOffsetForLine(c.startLineNumber),h=c.heightInLines===0?this._getVerticalOffsetForLine(c.endLineNumber)+t:u+c.heightInLines*t,m=Math.floor(r*u),f=Math.floor(r*h),g=Math.floor((m+f)/2),b=f-g;b<s&&(b=s),g-b<0&&(g=b),g+b>n&&(g=n-b);let y=c.color,C=this._color2Id[y];C||(C=++this._lastAssignedId,this._color2Id[y]=C,this._id2Color[C]=y);let x=new Cy(g-b,g+b,C);c.setColorZone(x),a.push(x)}return this._colorZonesInvalid=!1,a.sort(Cy.compare),a}};var Hn=Y("telemetryService"),cme=Y("customEndpointTelemetryService");var qm={exports:{}};(function(){function e(r){let s=[];typeof r=="number"&&s.push("code/timeOrigin",r);function a(d){s.push(d,Date.now())}function l(){let d=[];for(let c=0;c<s.length;c+=2)d.push({name:s[c],startTime:s[c+1]});return d}return{mark:a,getMarks:l}}function t(){if(typeof performance=="object"&&typeof performance.mark=="function"&&!performance.nodeTiming)return typeof performance.timeOrigin!="number"&&!performance.timing?e():{mark(r){performance.mark(r)},getMarks(){let r=performance.timeOrigin;typeof r!="number"&&(r=performance.timing.navigationStart||performance.timing.redirectStart||performance.timing.fetchStart);let s=[{name:"code/timeOrigin",startTime:Math.round(r)}];for(let a of performance.getEntriesByType("mark"))s.push({name:a.name,startTime:Math.round(r+a.startTime)});return s}};if(typeof process=="object"){let r=performance?.timeOrigin;return e(r)}else return console.trace("perf-util loaded in UNKNOWN environment"),e()}function n(r){return r.MonacoPerformanceMarks||(r.MonacoPerformanceMarks=t()),r.MonacoPerformanceMarks}var i;typeof global=="object"?i=global:typeof self=="object"?i=self:i={},typeof qm=="object"&&typeof qm.exports=="object"?qm.exports=n(i):(console.trace("perf-util defined in UNKNOWN context (neither requirejs or commonjs)"),i.perf=n(i))})();var kn=qm.exports.mark,hme=qm.exports.getMarks;function TT(o){let e=JSON.parse(o);return e=Gu(e),e}function Gu(o,e=0){if(!o||e>200)return o;if(typeof o=="object"){switch(o.$mid){case 1:return ie.revive(o);case 2:return new RegExp(o.source,o.flags);case 17:return new Date(o.source)}if(o instanceof Cn||o instanceof Uint8Array)return o;if(Array.isArray(o))for(let t=0;t<o.length;++t)o[t]=Gu(o[t],e+1);else for(let t in o)Object.hasOwnProperty.call(o,t)&&(o[t]=Gu(o[t],e+1))}return o}var zt=Y("fileService");function PO(o){return!!(o.capabilities&2048)}var LT=class o extends Error{constructor(t,n){super(t);this.code=n}static create(t,n){let i=new o(t.toString(),n);return $H(i,n),i}};function $H(o,e){return o.name=e?`${e} (FileSystemError)`:"FileSystemError",o}function qH(o){if(!o)return"Unknown";if(o instanceof LT)return o.code;let e=/^(.+) \(FileSystemError\)$/.exec(o.name);if(!e)return"Unknown";switch(e[1]){case"EntryExists":return"EntryExists";case"EntryIsADirectory":return"EntryIsADirectory";case"EntryNotADirectory":return"EntryNotADirectory";case"EntryNotFound":return"EntryNotFound";case"EntryTooLarge":return"EntryTooLarge";case"EntryWriteLocked":return"EntryWriteLocked";case"NoPermissions":return"NoPermissions";case"Unavailable":return"Unavailable"}return"Unknown"}function FO(o){if(o instanceof Ym)return o.fileOperationResult;switch(qH(o)){case"EntryNotFound":return 1;case"EntryIsADirectory":return 0;case"EntryNotADirectory":return 9;case"EntryWriteLocked":return 5;case"NoPermissions":return 6;case"EntryExists":return 4;case"EntryTooLarge":return 7;default:return 10}}var Ym=class extends Error{constructor(t,n,i){super(t);this.fileOperationResult=n;this.options=i}};var wy=class extends Ym{constructor(t,n,i){super(t,2,i);this.stat=n}};var Br={OFF:"off",AFTER_DELAY:"afterDelay",ON_FOCUS_CHANGE:"onFocusChange",ON_WINDOW_CHANGE:"onWindowChange"},ju={OFF:"off",ON_EXIT:"onExit",ON_EXIT_AND_WINDOW_CLOSE:"onExitAndWindowClose"};var BO="files.readonlyInclude",VO="files.readonlyExclude";var Zm="";var _l=class o{static KB=1024;static MB=o.KB*o.KB;static GB=o.MB*o.KB;static TB=o.GB*o.KB;static formatSize(e){return yi(e)||(e=0),e<o.KB?p("sizeB","{0}B",e.toFixed(0)):e<o.MB?p("sizeKB","{0}KB",(e/o.KB).toFixed(2)):e<o.GB?p("sizeMB","{0}MB",(e/o.MB).toFixed(2)):e<o.TB?p("sizeGB","{0}GB",(e/o.GB).toFixed(2)):p("sizeTB","{0}TB",(e/o.TB).toFixed(2))}};function WO(o){let e=typeof o=="string"||o?.scheme===Te.vscodeRemote;return typeof o!="string"&&o?.scheme===Te.file?1024*_l.MB:e?10*_l.MB:Zi?50*_l.MB:1024*_l.MB}function DT(o,e){return e&&(o.stack||o.stacktrace)?p("stackTrace.format","{0}: {1}",UO(o),HO(o.stack)||HO(o.stacktrace)):UO(o)}function HO(o){return Array.isArray(o)?o.join(`
`):o}function UO(o){return o.code==="ERR_UNC_HOST_NOT_ALLOWED"?`${o.message}. Please update the 'security.allowedUNCHosts' setting if you want to allow this host.`:typeof o.code=="string"&&typeof o.errno=="number"&&typeof o.syscall=="string"?p("nodeExceptionMessage","A system error occurred ({0})",o.message):o.message||p("error.defaultMessage","An unknown error occurred. Please consult the log for more details.")}function xy(o=null,e=!1){if(!o)return p("error.defaultMessage","An unknown error occurred. Please consult the log for more details.");if(Array.isArray(o)){let t=fr(o),n=xy(t[0],e);return t.length>1?p("error.moreErrors","{0} ({1} errors in total)",n,t.length):n}if(an(o))return o;if(o.detail){let t=o.detail;if(t.error)return DT(t.error,e);if(t.exception)return DT(t.exception,e)}return o.stack?DT(o,e):o.message?o.message:p("error.defaultMessage","An unknown error occurred. Please consult the log for more details.")}function kT(o){let e=o;return e instanceof Error&&Array.isArray(e.actions)}var Un=Y("logService"),Cge=Y("loggerService");function Ey(o){switch(o){case 1:return"trace";case 2:return"debug";case 3:return"info";case 4:return"warn";case 5:return"error";case 0:return"off"}}var Sge=new j("logLevel",Ey(3));var Gd=Y("IUriIdentityService");function KO(o){let e=o;return!!(e&&typeof e=="object"&&typeof e.id=="string"&&typeof e.isDefault=="boolean"&&typeof e.name=="string"&&ie.isUri(e.location)&&ie.isUri(e.globalStorageHome)&&ie.isUri(e.settingsResource)&&ie.isUri(e.keybindingsResource)&&ie.isUri(e.tasksResource)&&ie.isUri(e.snippetsHome)&&ie.isUri(e.extensionsResource))}var GO=Y("IUserDataProfilesService");function _y(o,e,t,n,i,r){return{id:o,name:e,location:t,isDefault:!1,shortName:i?.shortName,icon:i?.icon,globalStorageHome:r&&i?.useDefaultFlags?.globalState?r.globalStorageHome:ht(t,"globalStorage"),settingsResource:r&&i?.useDefaultFlags?.settings?r.settingsResource:ht(t,"settings.json"),keybindingsResource:r&&i?.useDefaultFlags?.keybindings?r.keybindingsResource:ht(t,"keybindings.json"),tasksResource:r&&i?.useDefaultFlags?.tasks?r.tasksResource:ht(t,"tasks.json"),snippetsHome:r&&i?.useDefaultFlags?.snippets?r.snippetsHome:ht(t,"snippets"),extensionsResource:r&&i?.useDefaultFlags?.extensions?r.extensionsResource:ht(t,"extensions.json"),cacheHome:ht(n,o),useDefaultFlags:i?.useDefaultFlags,isTransient:i?.transient}}var Ty=class extends V{constructor(t,n,i,r){super();this.environmentService=t;this.fileService=n;this.uriIdentityService=i;this.logService=r;this.profilesHome=ht(this.environmentService.userRoamingDataHome,"profiles"),this.profilesCacheHome=ht(this.environmentService.cacheHome,"CachedProfilesData")}static PROFILES_KEY="userDataProfiles";static PROFILE_ASSOCIATIONS_KEY="profileAssociations";_serviceBrand;enabled=!0;profilesHome;profilesCacheHome;get defaultProfile(){return this.profiles[0]}get profiles(){return[...this.profilesObject.profiles,...this.transientProfilesObject.profiles]}_onDidChangeProfiles=this._register(new E);onDidChangeProfiles=this._onDidChangeProfiles.event;_onWillCreateProfile=this._register(new E);onWillCreateProfile=this._onWillCreateProfile.event;_onWillRemoveProfile=this._register(new E);onWillRemoveProfile=this._onWillRemoveProfile.event;_onDidResetWorkspaces=this._register(new E);onDidResetWorkspaces=this._onDidResetWorkspaces.event;profileCreationPromises=new Map;transientProfilesObject={profiles:[],folders:new Ai,workspaces:new Ai,emptyWindows:new Map};init(){this._profilesObject=void 0}setEnablement(t){this.enabled!==t&&(this._profilesObject=void 0,this.enabled=t)}isEnabled(){return this.enabled}_profilesObject;get profilesObject(){if(!this._profilesObject){let t=this.createDefaultProfile(),n=[t];if(this.enabled)try{for(let s of this.getStoredProfiles()){if(!s.name||!an(s.name)||!s.location){this.logService.warn("Skipping the invalid stored profile",s.location||s.name);continue}n.push(_y(xr(s.location),s.name,s.location,this.profilesCacheHome,{shortName:s.shortName,icon:s.icon,useDefaultFlags:s.useDefaultFlags},t))}}catch(s){this.logService.error(s)}let i=new Ai,r=new Map;if(n.length)try{let s=this.getStoredProfileAssociations();if(s.workspaces)for(let[a,l]of Object.entries(s.workspaces)){let d=ie.parse(a),c=n.find(u=>u.id===l);c&&i.set(d,c)}if(s.emptyWindows)for(let[a,l]of Object.entries(s.emptyWindows)){let d=n.find(c=>c.id===l);d&&r.set(a,d)}}catch(s){this.logService.error(s)}this._profilesObject={profiles:n,workspaces:i,emptyWindows:r}}return this._profilesObject}createDefaultProfile(){let t=_y("__default__profile__",p("defaultProfile","Default"),this.environmentService.userRoamingDataHome,this.profilesCacheHome);return{...t,extensionsResource:this.getDefaultProfileExtensionsLocation()??t.extensionsResource,isDefault:!0}}async createTransientProfile(t){let n="Temp",i=new RegExp(`${Qi(n)}\\s(\\d+)`),r=0;for(let a of this.profiles){let l=i.exec(a.name),d=l?parseInt(l[1]):0;r=d>r?d:r}let s=`${n} ${r+1}`;return this.createProfile(cs(Ad()).toString(16),s,{transient:!0},t)}async createNamedProfile(t,n,i){return this.createProfile(cs(Ad()).toString(16),t,n,i)}async createProfile(t,n,i,r){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");let s=await this.doCreateProfile(t,n,i);return r&&await this.setProfileForWorkspace(r,s),s}async doCreateProfile(t,n,i){if(!an(n)||!n)throw new Error("Name of the profile is mandatory and must be of type `string`");let r=this.profileCreationPromises.get(n);return r||(r=(async()=>{try{if(this.profiles.find(d=>d.name===n||d.id===t))throw new Error(`Profile with ${n} name already exists`);let a=_y(t,n,ht(this.profilesHome,t),this.profilesCacheHome,i,this.defaultProfile);await this.fileService.createFolder(a.location);let l=[];return this._onWillCreateProfile.fire({profile:a,join(d){l.push(d)}}),await Uo.settled(l),this.updateProfiles([a],[],[]),a}finally{this.profileCreationPromises.delete(n)}})(),this.profileCreationPromises.set(n,r)),r}async updateProfile(t,n){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");let i=this.profiles.find(r=>r.id===t.id);if(!i)throw new Error(`Profile '${t.name}' does not exist`);return i=_y(i.id,n.name??i.name,i.location,this.profilesCacheHome,{shortName:n.shortName??i.shortName,icon:n.icon===null?void 0:n.icon??i.icon,transient:n.transient??i.isTransient,useDefaultFlags:n.useDefaultFlags??i.useDefaultFlags},this.defaultProfile),this.updateProfiles([],[],[i]),i}async removeProfile(t){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");if(t.isDefault)throw new Error("Cannot remove default profile");let n=this.profiles.find(r=>r.id===t.id);if(!n)throw new Error(`Profile '${t.name}' does not exist`);let i=[];this._onWillRemoveProfile.fire({profile:n,join(r){i.push(r)}});try{await Promise.allSettled(i)}catch(r){this.logService.error(r)}for(let r of[...this.profilesObject.emptyWindows.keys()])n.id===this.profilesObject.emptyWindows.get(r)?.id&&this.profilesObject.emptyWindows.delete(r);for(let r of[...this.profilesObject.workspaces.keys()])n.id===this.profilesObject.workspaces.get(r)?.id&&this.profilesObject.workspaces.delete(r);this.updateStoredProfileAssociations(),this.updateProfiles([],[n],[]);try{await this.fileService.del(n.cacheHome,{recursive:!0})}catch(r){FO(r)!==1&&this.logService.error(r)}}async setProfileForWorkspace(t,n){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");let i=this.profiles.find(r=>r.id===n.id);if(!i)throw new Error(`Profile '${n.name}' does not exist`);this.updateWorkspaceAssociation(t,i)}unsetWorkspace(t,n){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");this.updateWorkspaceAssociation(t,void 0,n)}async resetWorkspaces(){this.transientProfilesObject.folders.clear(),this.transientProfilesObject.workspaces.clear(),this.transientProfilesObject.emptyWindows.clear(),this.profilesObject.workspaces.clear(),this.profilesObject.emptyWindows.clear(),this.updateStoredProfileAssociations(),this._onDidResetWorkspaces.fire()}async cleanUp(){if(this.enabled&&await this.fileService.exists(this.profilesHome)){let t=await this.fileService.resolve(this.profilesHome);await Promise.all((t.children||[]).filter(n=>n.isDirectory&&this.profiles.every(i=>!this.uriIdentityService.extUri.isEqual(i.location,n.resource))).map(n=>this.fileService.del(n.resource,{recursive:!0})))}}async cleanUpTransientProfiles(){if(!this.enabled)return;let t=this.transientProfilesObject.profiles.filter(n=>!this.isProfileAssociatedToWorkspace(n));await Promise.allSettled(t.map(n=>this.removeProfile(n)))}getProfileForWorkspace(t){let n=this.getWorkspace(t),i=ie.isUri(n)?this.profilesObject.workspaces.get(n):this.profilesObject.emptyWindows.get(n);return i||(Yb(t)?this.transientProfilesObject.folders.get(t.uri):Zb(t)?this.transientProfilesObject.workspaces.get(t.configPath):this.transientProfilesObject.emptyWindows.get(t.id))}getWorkspace(t){return Yb(t)?t.uri:Zb(t)?t.configPath:t.id}isProfileAssociatedToWorkspace(t){return!!([...this.profilesObject.emptyWindows.values()].some(n=>this.uriIdentityService.extUri.isEqual(n.location,t.location))||[...this.profilesObject.workspaces.values()].some(n=>this.uriIdentityService.extUri.isEqual(n.location,t.location))||[...this.transientProfilesObject.emptyWindows.values()].some(n=>this.uriIdentityService.extUri.isEqual(n.location,t.location))||[...this.transientProfilesObject.workspaces.values()].some(n=>this.uriIdentityService.extUri.isEqual(n.location,t.location))||[...this.transientProfilesObject.folders.values()].some(n=>this.uriIdentityService.extUri.isEqual(n.location,t.location)))}updateProfiles(t,n,i){let r=[...this.profiles,...t],s=[],a=this.transientProfilesObject.profiles;this.transientProfilesObject.profiles=[];for(let l of r){if(l.isDefault||n.some(c=>l.id===c.id))continue;l=i.find(c=>l.id===c.id)??l;let d=a.find(c=>l.id===c.id);if(l.isTransient)this.transientProfilesObject.profiles.push(l);else{if(d){for(let[c,u]of this.transientProfilesObject.emptyWindows.entries())if(l.id===u.id){this.updateWorkspaceAssociation({id:c},l);break}for(let[c,u]of this.transientProfilesObject.workspaces.entries())if(l.id===u.id){this.updateWorkspaceAssociation({id:"",configPath:c},l);break}for(let[c,u]of this.transientProfilesObject.folders.entries())if(l.id===u.id){this.updateWorkspaceAssociation({id:"",uri:c},l);break}}s.push({location:l.location,name:l.name,shortName:l.shortName,icon:l.icon,useDefaultFlags:l.useDefaultFlags})}}this.saveStoredProfiles(s),this._profilesObject=void 0,this.triggerProfilesChanges(t,n,i)}triggerProfilesChanges(t,n,i){this._onDidChangeProfiles.fire({added:t,removed:n,updated:i,all:this.profiles})}updateWorkspaceAssociation(t,n,i){if(i=n?.isTransient?!0:i,i)Yb(t)?(this.transientProfilesObject.folders.delete(t.uri),n&&this.transientProfilesObject.folders.set(t.uri,n)):Zb(t)?(this.transientProfilesObject.workspaces.delete(t.configPath),n&&this.transientProfilesObject.workspaces.set(t.configPath,n)):(this.transientProfilesObject.emptyWindows.delete(t.id),n&&this.transientProfilesObject.emptyWindows.set(t.id,n));else{this.updateWorkspaceAssociation(t,void 0,!0);let r=this.getWorkspace(t);ie.isUri(r)?(this.profilesObject.workspaces.delete(r),n&&this.profilesObject.workspaces.set(r,n)):(this.profilesObject.emptyWindows.delete(r),n&&this.profilesObject.emptyWindows.set(r,n)),this.updateStoredProfileAssociations()}}updateStoredProfileAssociations(){let t={};for(let[i,r]of this.profilesObject.workspaces.entries())t[i.toString()]=r.id;let n={};for(let[i,r]of this.profilesObject.emptyWindows.entries())n[i.toString()]=r.id;this.saveStoredProfileAssociations({workspaces:t,emptyWindows:n}),this._profilesObject=void 0}migrateStoredProfileAssociations(t){let n={},i=this.createDefaultProfile();if(t.workspaces)for(let[s,a]of Object.entries(t.workspaces)){let l=ie.parse(a);n[s]=this.uriIdentityService.extUri.isEqual(l,i.location)?i.id:this.uriIdentityService.extUri.basename(l)}let r={};if(t.emptyWindows)for(let[s,a]of Object.entries(t.emptyWindows)){let l=ie.parse(a);r[s]=this.uriIdentityService.extUri.isEqual(l,i.location)?i.id:this.uriIdentityService.extUri.basename(l)}return{workspaces:n,emptyWindows:r}}getStoredProfiles(){return[]}saveStoredProfiles(t){throw new Error("not implemented")}getStoredProfileAssociations(){return{}}saveStoredProfileAssociations(t){throw new Error("not implemented")}getDefaultProfileExtensionsLocation(){}};Ty=R([S(0,Go),S(1,zt),S(2,Gd),S(3,Un)],Ty);var YH="__$__isNewStorageMarker",Ly="__$__targetStorageMarker",zn=Y("storageService");function ZH(o){let e=o.get(Ly);if(e)try{return JSON.parse(e)}catch{}return Object.create(null)}var jO=class o extends V{constructor(t={flushInterval:o.DEFAULT_FLUSH_INTERVAL}){super();this.options=t}static DEFAULT_FLUSH_INTERVAL=60*1e3;_onDidChangeValue=this._register(new ad);_onDidChangeTarget=this._register(new ad);onDidChangeTarget=this._onDidChangeTarget.event;_onWillSaveState=this._register(new E);onWillSaveState=this._onWillSaveState.event;initializationPromise;flushWhenIdleScheduler=this._register(new Qt(()=>this.doFlushWhenIdle(),this.options.flushInterval));runFlushWhenIdle=this._register(new Zt);onDidChangeValue(t,n,i){return oe.filter(this._onDidChangeValue.event,r=>r.scope===t&&(n===void 0||r.key===n),i)}doFlushWhenIdle(){this.runFlushWhenIdle.value=nl(()=>{this.shouldFlushWhenIdle()&&this.flush(),this.flushWhenIdleScheduler.schedule()})}shouldFlushWhenIdle(){return!0}stopFlushWhenIdle(){kt([this.runFlushWhenIdle,this.flushWhenIdleScheduler])}initialize(){return this.initializationPromise||(this.initializationPromise=(async()=>{kn("code/willInitStorage");try{await this.doInitialize()}finally{kn("code/didInitStorage")}this.flushWhenIdleScheduler.schedule()})()),this.initializationPromise}emitDidChangeValue(t,n){let{key:i,external:r}=n;if(i===Ly){switch(t){case-1:this._applicationKeyTargets=void 0;break;case 0:this._profileKeyTargets=void 0;break;case 1:this._workspaceKeyTargets=void 0;break}this._onDidChangeTarget.fire({scope:t})}else this._onDidChangeValue.fire({scope:t,key:i,target:this.getKeyTargets(t)[i],external:r})}emitWillSaveState(t){this._onWillSaveState.fire({reason:t})}get(t,n,i){return this.getStorage(n)?.get(t,i)}getBoolean(t,n,i){return this.getStorage(n)?.getBoolean(t,i)}getNumber(t,n,i){return this.getStorage(n)?.getNumber(t,i)}getObject(t,n,i){return this.getStorage(n)?.getObject(t,i)}storeAll(t,n){this.withPausedEmitters(()=>{for(let i of t)this.store(i.key,i.value,i.scope,i.target,n)})}store(t,n,i,r,s=!1){if(pi(n)){this.remove(t,i,s);return}this.withPausedEmitters(()=>{this.updateKeyTarget(t,i,r),this.getStorage(i)?.set(t,n,s)})}remove(t,n,i=!1){this.withPausedEmitters(()=>{this.updateKeyTarget(t,n,void 0),this.getStorage(n)?.delete(t,i)})}withPausedEmitters(t){this._onDidChangeValue.pause(),this._onDidChangeTarget.pause();try{t()}finally{this._onDidChangeValue.resume(),this._onDidChangeTarget.resume()}}keys(t,n){let i=[],r=this.getKeyTargets(t);for(let s of Object.keys(r))r[s]===n&&i.push(s);return i}updateKeyTarget(t,n,i,r=!1){let s=this.getKeyTargets(n);typeof i=="number"?s[t]!==i&&(s[t]=i,this.getStorage(n)?.set(Ly,JSON.stringify(s),r)):typeof s[t]=="number"&&(delete s[t],this.getStorage(n)?.set(Ly,JSON.stringify(s),r))}_workspaceKeyTargets=void 0;get workspaceKeyTargets(){return this._workspaceKeyTargets||(this._workspaceKeyTargets=this.loadKeyTargets(1)),this._workspaceKeyTargets}_profileKeyTargets=void 0;get profileKeyTargets(){return this._profileKeyTargets||(this._profileKeyTargets=this.loadKeyTargets(0)),this._profileKeyTargets}_applicationKeyTargets=void 0;get applicationKeyTargets(){return this._applicationKeyTargets||(this._applicationKeyTargets=this.loadKeyTargets(-1)),this._applicationKeyTargets}getKeyTargets(t){switch(t){case-1:return this.applicationKeyTargets;case 0:return this.profileKeyTargets;default:return this.workspaceKeyTargets}}loadKeyTargets(t){let n=this.getStorage(t);return n?ZH(n):Object.create(null)}isNew(t){return this.getBoolean(YH,t)===!0}async flush(t=0){this._onWillSaveState.fire({reason:t});let n=this.getStorage(-1),i=this.getStorage(0),r=this.getStorage(1);switch(t){case 0:await Uo.settled([n?.whenFlushed()??Promise.resolve(),i?.whenFlushed()??Promise.resolve(),r?.whenFlushed()??Promise.resolve()]);break;case 1:await Uo.settled([n?.flush(0)??Promise.resolve(),i?.flush(0)??Promise.resolve(),r?.flush(0)??Promise.resolve()]);break}}async log(){let t=this.getStorage(-1)?.items??new Map,n=this.getStorage(0)?.items??new Map,i=this.getStorage(1)?.items??new Map;return XH(t,n,i,this.getLogDetails(-1)??"",this.getLogDetails(0)??"",this.getLogDetails(1)??"")}async optimize(t){return await this.flush(),this.getStorage(t)?.optimize()}async switch(t,n){return this.emitWillSaveState(0),KO(t)?this.switchToProfile(t,n):this.switchToWorkspace(t,n)}canSwitchProfile(t,n){return!(t.id===n.id||$O(n)&&$O(t))}switchData(t,n,i){this.withPausedEmitters(()=>{let r=new Set;for(let[s,a]of t)r.add(s),n.get(s)!==a&&this.emitDidChangeValue(i,{key:s,external:!0});for(let[s]of n.items)r.has(s)||this.emitDidChangeValue(i,{key:s,external:!0})})}};function $O(o){return o.isDefault||!!o.useDefaultFlags?.globalState}async function XH(o,e,t,n,i,r){let s=g=>{try{return JSON.parse(g)}catch{return g}},a=new Map,l=new Map;o.forEach((g,b)=>{a.set(b,g),l.set(b,s(g))});let d=new Map,c=new Map;e.forEach((g,b)=>{d.set(b,g),c.set(b,s(g))});let u=new Map,h=new Map;t.forEach((g,b)=>{u.set(b,g),h.set(b,s(g))}),console.group(n!==i?`Storage: Application (path: ${n})`:`Storage: Application & Profile (path: ${n}, default profile)`);let m=[];if(a.forEach((g,b)=>{m.push({key:b,value:g})}),console.table(m),console.groupEnd(),console.log(l),n!==i){console.group(`Storage: Profile (path: ${i}, profile specific)`);let g=[];d.forEach((b,y)=>{g.push({key:y,value:b})}),console.table(g),console.groupEnd(),console.log(c)}console.group(`Storage: Workspace (path: ${r})`);let f=[];u.forEach((g,b)=>{f.push({key:b,value:g})}),console.table(f),console.groupEnd(),console.log(h)}var Kn=Y("textResourceConfigurationService"),Dfe=Y("textResourcePropertiesService");var Xm=Y("textModelService");var qO="";var $u=class extends V{_onWillDispose=this._register(new E);onWillDispose=this._onWillDispose.event;resolved=!1;async resolve(){this.resolved=!0}isResolved(){return this.resolved}isDisposed(){return this._store.isDisposed}dispose(){this._onWillDispose.fire(),super.dispose()}};var Vr=Y("modelService");var qu=Y("ILanguageDetectionService"),RT="languageDetection";var cr=class extends $u{constructor(t,n,i,r,s){super();this.modelService=t;this.languageService=n;this.languageDetectionService=i;this.accessibilityService=r;s&&this.handleExistingModel(s)}static AUTO_DETECT_LANGUAGE_THROTTLE_DELAY=600;textEditorModelHandle=void 0;createdEditorModel;modelDisposeListener=this._register(new Zt);autoDetectLanguageThrottler=this._register(new $p(cr.AUTO_DETECT_LANGUAGE_THROTTLE_DELAY));handleExistingModel(t){let n=this.modelService.getModel(t);if(!n)throw new Error(`Document with resource ${t.toString(!0)} does not exist`);this.textEditorModelHandle=t,this.registerModelDisposeListener(n)}registerModelDisposeListener(t){this.modelDisposeListener.value=t.onWillDispose(()=>{this.textEditorModelHandle=void 0,this.dispose()})}get textEditorModel(){return this.textEditorModelHandle?this.modelService.getModel(this.textEditorModelHandle):null}isReadonly(){return!0}_hasLanguageSetExplicitly=!1;get hasLanguageSetExplicitly(){return this._hasLanguageSetExplicitly}setLanguageId(t,n){this._hasLanguageSetExplicitly=!0,this.setLanguageIdInternal(t,n)}setLanguageIdInternal(t,n){this.isResolved()&&(!t||t===this.textEditorModel.getLanguageId()||this.textEditorModel.setLanguage(this.languageService.createById(t),n))}installModelListeners(t){let n=this._register(t.onDidChangeLanguage(i=>{i.source!==RT&&(this._hasLanguageSetExplicitly=!0,n.dispose())}))}getLanguageId(){return this.textEditorModel?.getLanguageId()}autoDetectLanguage(){return this.autoDetectLanguageThrottler.trigger(()=>this.doAutoDetectLanguage())}async doAutoDetectLanguage(){if(this.hasLanguageSetExplicitly||!this.textEditorModelHandle||!this.languageDetectionService.isEnabledForLanguage(this.getLanguageId()??sr))return;let t=await this.languageDetectionService.detectLanguage(this.textEditorModelHandle),n=this.getLanguageId();if(t&&t!==n&&!this.isDisposed()){this.setLanguageIdInternal(t,RT);let i=this.languageService.getLanguageName(t);this.accessibilityService.alert(p("languageAutoDetected","Language {0} was automatically detected and set as the language mode.",i??t))}}createTextEditorModel(t,n,i){let r=this.getFirstLineText(t),s=this.getOrCreateLanguage(n,this.languageService,i,r);return this.doCreateTextEditorModel(t,s,n)}doCreateTextEditorModel(t,n,i){let r=i&&this.modelService.getModel(i);return r?this.updateTextEditorModel(t,n.languageId):(r=this.modelService.createModel(t,n,i),this.createdEditorModel=!0,this.registerModelDisposeListener(r)),this.textEditorModelHandle=r.uri,r}getFirstLineText(t){let n=t;return typeof n.getFirstLineText=="function"?n.getFirstLineText(1e3):t.getLineContent(1).substr(0,1e3)}getOrCreateLanguage(t,n,i,r){return!i||i===sr?n.createByFilepathOrFirstLine(t??null,r):n.createById(i)}updateTextEditorModel(t,n){this.isResolved()&&(t&&this.modelService.updateModel(this.textEditorModel,t),n&&n!==sr&&this.textEditorModel.getLanguageId()!==n&&this.textEditorModel.setLanguage(this.languageService.createById(n)))}createSnapshot(){return this.textEditorModel?this.textEditorModel.createSnapshot(!0):null}isResolved(){return!!this.textEditorModelHandle}dispose(){this.modelDisposeListener.dispose(),this.textEditorModelHandle&&this.createdEditorModel&&this.modelService.destroyModel(this.textEditorModelHandle),this.textEditorModelHandle=void 0,this.createdEditorModel=!1,super.dispose()}};cr=R([S(0,Vr),S(1,Bi),S(2,qu),S(3,Co)],cr);var Dy=Y("workingCopyBackupService");var jd=class o{constructor(e,t,n){this.startOffset=e;this.endOffset=t;this.newLength=n}static fromModelContentChanges(e){return e.map(n=>{let i=D.lift(n.range);return new o(fl(i.getStartPosition()),fl(i.getEndPosition()),HM(n.text))}).reverse()}toString(){return`[${_i(this.startOffset)}...${_i(this.endOffset)}) -> ${_i(this.newLength)}`}},ky=class{nextEditIdx=0;deltaOldToNewLineCount=0;deltaOldToNewColumnCount=0;deltaLineIdxInOld=-1;edits;constructor(e){this.edits=e.map(t=>MT.from(t))}getOffsetBeforeChange(e){return this.adjustNextEdit(e),this.translateCurToOld(e)}getDistanceToNextChange(e){this.adjustNextEdit(e);let t=this.edits[this.nextEditIdx],n=t?this.translateOldToCur(t.offsetObj):null;return n===null?null:Nd(e,n)}translateOldToCur(e){return e.lineCount===this.deltaLineIdxInOld?Ft(e.lineCount+this.deltaOldToNewLineCount,e.columnCount+this.deltaOldToNewColumnCount):Ft(e.lineCount+this.deltaOldToNewLineCount,e.columnCount)}translateCurToOld(e){let t=_i(e);return t.lineCount-this.deltaOldToNewLineCount===this.deltaLineIdxInOld?Ft(t.lineCount-this.deltaOldToNewLineCount,t.columnCount-this.deltaOldToNewColumnCount):Ft(t.lineCount-this.deltaOldToNewLineCount,t.columnCount)}adjustNextEdit(e){for(;this.nextEditIdx<this.edits.length;){let t=this.edits[this.nextEditIdx],n=this.translateOldToCur(t.endOffsetAfterObj);if(gl(n,e)){this.nextEditIdx++;let i=_i(n),r=_i(this.translateOldToCur(t.endOffsetBeforeObj)),s=i.lineCount-r.lineCount;this.deltaOldToNewLineCount+=s;let a=this.deltaLineIdxInOld===t.endOffsetBeforeObj.lineCount?this.deltaOldToNewColumnCount:0,l=i.columnCount-r.columnCount;this.deltaOldToNewColumnCount=a+l,this.deltaLineIdxInOld=t.endOffsetBeforeObj.lineCount}else break}}},MT=class o{static from(e){return new o(e.startOffset,e.endOffset,e.newLength)}endOffsetBeforeObj;endOffsetAfterObj;offsetObj;constructor(e,t,n){this.endOffsetBeforeObj=_i(t),this.endOffsetAfterObj=_i(Mt(e,n)),this.offsetObj=_i(e)}};function XO(o){if(o.length===0)return null;if(o.length===1)return o[0];let e=0;function t(){if(e>=o.length)return null;let s=e,a=o[s].listHeight;for(e++;e<o.length&&o[e].listHeight===a;)e++;return e-s>=2?OT(s===0&&e===o.length?o:o.slice(s,e),!1):o[s]}let n=t(),i=t();if(!i)return n;for(let s=t();s;s=t())YO(n,i)<=YO(i,s)?(n=AT(n,i),i=s):i=AT(i,s);return AT(n,i)}function OT(o,e=!1){if(o.length===0)return null;if(o.length===1)return o[0];let t=o.length;for(;t>3;){let n=t>>1;for(let i=0;i<n;i++){let r=i<<1;o[i]=_o.create23(o[r],o[r+1],r+3===t?o[r+2]:null,e)}t=n}return _o.create23(o[0],o[1],t>=3?o[2]:null,e)}function YO(o,e){return Math.abs(o.listHeight-e.listHeight)}function AT(o,e){return o.listHeight===e.listHeight?_o.create23(o,e,null,!1):o.listHeight>e.listHeight?JH(o,e):e4(e,o)}function JH(o,e){o=o.toMutable();let t=o,n=[],i;for(;;){if(e.listHeight===t.listHeight){i=e;break}if(t.kind!==4)throw new Error("unexpected");n.push(t),t=t.makeLastElementMutable()}for(let r=n.length-1;r>=0;r--){let s=n[r];i?s.childrenLength>=3?i=_o.create23(s.unappendChild(),i,null,!1):(s.appendChildOfSameHeight(i),i=void 0):s.handleChildrenChanged()}return i?_o.create23(o,i,null,!1):o}function e4(o,e){o=o.toMutable();let t=o,n=[];for(;e.listHeight!==t.listHeight;){if(t.kind!==4)throw new Error("unexpected");n.push(t),t=t.makeFirstElementMutable()}let i=e;for(let r=n.length-1;r>=0;r--){let s=n[r];i?s.childrenLength>=3?i=_o.create23(i,s.unprependChild(),null,!1):(s.prependChildOfSameHeight(i),i=void 0):s.handleChildrenChanged()}return i?_o.create23(i,o,null,!1):o}var Ry=class{nextNodes;offsets;idxs;lastOffset=Dn;constructor(e){this.nextNodes=[e],this.offsets=[Dn],this.idxs=[]}readLongestNodeAt(e,t){if(da(e,this.lastOffset))throw new Error("Invalid offset");for(this.lastOffset=e;;){let n=Qm(this.nextNodes);if(!n)return;let i=Qm(this.offsets);if(da(e,i))return;if(da(i,e))if(Mt(i,n.length)<=e)this.nextNodeAfterCurrent();else{let r=NT(n);r!==-1?(this.nextNodes.push(n.getChild(r)),this.offsets.push(i),this.idxs.push(r)):this.nextNodeAfterCurrent()}else{if(t(n))return this.nextNodeAfterCurrent(),n;{let r=NT(n);if(r===-1){this.nextNodeAfterCurrent();return}else this.nextNodes.push(n.getChild(r)),this.offsets.push(i),this.idxs.push(r)}}}}nextNodeAfterCurrent(){for(;;){let e=Qm(this.offsets),t=Qm(this.nextNodes);if(this.nextNodes.pop(),this.offsets.pop(),this.idxs.length===0)break;let n=Qm(this.nextNodes),i=NT(n,this.idxs[this.idxs.length-1]);if(i!==-1){this.nextNodes.push(n.getChild(i)),this.offsets.push(Mt(e,t.length)),this.idxs[this.idxs.length-1]=i;break}else this.idxs.pop()}}};function NT(o,e=-1){for(;;){if(e++,e>=o.childrenLength)return-1;if(o.getChild(e))return e}}function Qm(o){return o.length>0?o[o.length-1]:void 0}function FT(o,e,t,n){return new PT(o,e,t,n).parseDocument()}var PT=class{constructor(e,t,n,i){this.tokenizer=e;this.createImmutableLists=i;if(n&&i)throw new Error("Not supported");this.oldNodeReader=n?new Ry(n):void 0,this.positionMapper=new ky(t)}oldNodeReader;positionMapper;_itemsConstructed=0;_itemsFromCache=0;get nodesConstructed(){return this._itemsConstructed}get nodesReused(){return this._itemsFromCache}parseDocument(){this._itemsConstructed=0,this._itemsFromCache=0;let e=this.parseList(Jn.getEmpty(),0);return e||(e=_o.getEmpty()),e}parseList(e,t){let n=[];for(;;){let r=this.tryReadChildFromCache(e);if(!r){let s=this.tokenizer.peek();if(!s||s.kind===2&&s.bracketIds.intersects(e))break;r=this.parseChild(e,t+1)}r.kind===4&&r.childrenLength===0||n.push(r)}return this.oldNodeReader?XO(n):OT(n,this.createImmutableLists)}tryReadChildFromCache(e){if(this.oldNodeReader){let t=this.positionMapper.getDistanceToNextChange(this.tokenizer.offset);if(t===null||!Su(t)){let n=this.oldNodeReader.readLongestNodeAt(this.positionMapper.getOffsetBeforeChange(this.tokenizer.offset),i=>t!==null&&!da(i.length,t)?!1:i.canBeReused(e));if(n)return this._itemsFromCache++,this.tokenizer.skip(n.length),n}}}parseChild(e,t){this._itemsConstructed++;let n=this.tokenizer.read();switch(n.kind){case 2:return new Wv(n.bracketIds,n.length);case 0:return n.astNode;case 1:{if(t>300)return new Ar(n.length);let i=e.merge(n.bracketIds),r=this.parseList(i,t+1),s=this.tokenizer.peek();return s&&s.kind===2&&(s.bracketId===n.bracketId||s.bracketIds.intersects(n.bracketIds))?(this.tokenizer.read(),Om.create(n.astNode,r,s.astNode)):Om.create(n.astNode,r,null)}default:throw new Error("unexpected")}}};function BT(o,e){if(o.length===0)return e;if(e.length===0)return o;let t=new qi(QO(o)),n=QO(e);n.push({modified:!1,lengthBefore:void 0,lengthAfter:void 0});let i=t.dequeue();function r(d){if(d===void 0){let u=t.takeWhile(h=>!0)||[];return i&&u.unshift(i),u}let c=[];for(;i&&!Su(d);){let[u,h]=i.splitAt(d);c.push(u),d=Nd(u.lengthAfter,d),i=h??t.dequeue()}return Su(d)||c.push(new Jm(!1,d,d)),c}let s=[];function a(d,c,u){if(s.length>0&&G_(s[s.length-1].endOffset,d)){let h=s[s.length-1];s[s.length-1]=new jd(h.startOffset,c,Mt(h.newLength,u))}else s.push({startOffset:d,endOffset:c,newLength:u})}let l=Dn;for(let d of n){let c=r(d.lengthBefore);if(d.modified){let u=WM(c,m=>m.lengthBefore),h=Mt(l,u);a(l,h,d.lengthAfter),l=h}else for(let u of c){let h=l;l=Mt(l,u.lengthBefore),u.modified&&a(h,l,u.lengthAfter)}}return s}var Jm=class o{constructor(e,t,n){this.modified=e;this.lengthBefore=t;this.lengthAfter=n}splitAt(e){let t=Nd(e,this.lengthAfter);return G_(t,Dn)?[this,void 0]:this.modified?[new o(this.modified,this.lengthBefore,e),new o(this.modified,Dn,t)]:[new o(this.modified,e,e),new o(this.modified,t,t)]}toString(){return`${this.modified?"M":"U"}:${_i(this.lengthBefore)} -> ${_i(this.lengthAfter)}`}};function QO(o){let e=[],t=Dn;for(let n of o){let i=Nd(t,n.startOffset);Su(i)||e.push(new Jm(!1,i,i));let r=Nd(n.startOffset,n.endOffset);e.push(new Jm(!0,r,n.newLength)),t=n.endOffset}return e}var My=class extends V{constructor(t,n){super();this.textModel=t;this.getLanguageConfiguration=n;if(t.tokenization.hasTokens)t.tokenization.backgroundTokenizationState===2?(this.initialAstWithoutTokens=void 0,this.astWithTokens=this.parseDocumentFromTextBuffer([],void 0,!1)):(this.initialAstWithoutTokens=this.parseDocumentFromTextBuffer([],void 0,!0),this.astWithTokens=this.initialAstWithoutTokens);else{let i=this.brackets.getSingleLanguageBracketTokens(this.textModel.getLanguageId()),r=new Bv(this.textModel.getValue(),i);this.initialAstWithoutTokens=FT(r,[],void 0,!0),this.astWithTokens=this.initialAstWithoutTokens}}didChangeEmitter=new E;initialAstWithoutTokens;astWithTokens;denseKeyProvider=new Tv;brackets=new Pv(this.denseKeyProvider,this.getLanguageConfiguration);didLanguageChange(t){return this.brackets.didLanguageChange(t)}onDidChange=this.didChangeEmitter.event;queuedTextEditsForInitialAstWithoutTokens=[];queuedTextEdits=[];handleDidChangeBackgroundTokenizationState(){if(this.textModel.tokenization.backgroundTokenizationState===2){let t=this.initialAstWithoutTokens===void 0;this.initialAstWithoutTokens=void 0,t||this.didChangeEmitter.fire()}}handleDidChangeTokens({ranges:t}){let n=t.map(i=>new jd(Ft(i.fromLineNumber-1,0),Ft(i.toLineNumber,0),Ft(i.toLineNumber-i.fromLineNumber+1,0)));this.handleEdits(n,!0),this.initialAstWithoutTokens||this.didChangeEmitter.fire()}handleContentChanged(t){let n=jd.fromModelContentChanges(t.changes);this.handleEdits(n,!1)}handleEdits(t,n){let i=BT(this.queuedTextEdits,t);this.queuedTextEdits=i,this.initialAstWithoutTokens&&!n&&(this.queuedTextEditsForInitialAstWithoutTokens=BT(this.queuedTextEditsForInitialAstWithoutTokens,t))}flushQueue(){this.queuedTextEdits.length>0&&(this.astWithTokens=this.parseDocumentFromTextBuffer(this.queuedTextEdits,this.astWithTokens,!1),this.queuedTextEdits=[]),this.queuedTextEditsForInitialAstWithoutTokens.length>0&&(this.initialAstWithoutTokens&&(this.initialAstWithoutTokens=this.parseDocumentFromTextBuffer(this.queuedTextEditsForInitialAstWithoutTokens,this.initialAstWithoutTokens,!1)),this.queuedTextEditsForInitialAstWithoutTokens=[])}parseDocumentFromTextBuffer(t,n,i){let s=n,a=new Fv(this.textModel,this.brackets);return FT(a,t,s,i)}getBracketsInRange(t,n){this.flushQueue();let i=Ft(t.startLineNumber-1,t.startColumn-1),r=Ft(t.endLineNumber-1,t.endColumn-1);return new Zs(s=>{let a=this.initialAstWithoutTokens||this.astWithTokens;VT(a,Dn,a.length,i,r,s,0,0,new Map,n)})}getBracketPairsInRange(t,n){this.flushQueue();let i=fl(t.getStartPosition()),r=fl(t.getEndPosition());return new Zs(s=>{let a=this.initialAstWithoutTokens||this.astWithTokens,l=new WT(s,n,this.textModel);HT(a,Dn,a.length,i,r,l,0,new Map)})}getFirstBracketAfter(t){this.flushQueue();let n=this.initialAstWithoutTokens||this.astWithTokens;return tN(n,Dn,n.length,fl(t))}getFirstBracketBefore(t){this.flushQueue();let n=this.initialAstWithoutTokens||this.astWithTokens;return eN(n,Dn,n.length,fl(t))}};function eN(o,e,t,n){if(o.kind===4||o.kind===2){let i=[];for(let r of o.children)t=Mt(e,r.length),i.push({nodeOffsetStart:e,nodeOffsetEnd:t}),e=t;for(let r=i.length-1;r>=0;r--){let{nodeOffsetStart:s,nodeOffsetEnd:a}=i[r];if(da(s,n)){let l=eN(o.children[r],s,a,n);if(l)return l}}return null}else{if(o.kind===3)return null;if(o.kind===1){let i=bl(e,t);return{bracketInfo:o.bracketInfo,range:i}}}return null}function tN(o,e,t,n){if(o.kind===4||o.kind===2){for(let i of o.children){if(t=Mt(e,i.length),da(n,t)){let r=tN(i,e,t,n);if(r)return r}e=t}return null}else{if(o.kind===3)return null;if(o.kind===1){let i=bl(e,t);return{bracketInfo:o.bracketInfo,range:i}}}return null}function VT(o,e,t,n,i,r,s,a,l,d,c=!1){if(s>200)return!0;e:for(;;)switch(o.kind){case 4:{let u=o.childrenLength;for(let h=0;h<u;h++){let m=o.getChild(h);if(m){if(t=Mt(e,m.length),gl(e,i)&&wu(t,n)){if(wu(t,i)){o=m;continue e}if(!VT(m,e,t,n,i,r,s,0,l,d))return!1}e=t}}return!0}case 2:{let u=!d||!o.closingBracket||o.closingBracket.bracketInfo.closesColorized(o.openingBracket.bracketInfo),h=0;if(l){let f=l.get(o.openingBracket.text);f===void 0&&(f=0),h=f,u&&(f++,l.set(o.openingBracket.text,f))}let m=o.childrenLength;for(let f=0;f<m;f++){let g=o.getChild(f);if(g){if(t=Mt(e,g.length),gl(e,i)&&wu(t,n)){if(wu(t,i)&&g.kind!==1){o=g,u?(s++,a=h+1):a=h;continue e}if((u||g.kind!==1||!o.closingBracket)&&!VT(g,e,t,n,i,r,u?s+1:s,u?h+1:h,l,d,!o.closingBracket))return!1}e=t}}return l?.set(o.openingBracket.text,h),!0}case 3:{let u=bl(e,t);return r(new Bm(u,s-1,0,!0))}case 1:{let u=bl(e,t);return r(new Bm(u,s-1,a-1,c))}case 0:return!0}}var WT=class{constructor(e,t,n){this.push=e;this.includeMinIndentation=t;this.textModel=n}};function HT(o,e,t,n,i,r,s,a){if(s>200)return!0;let l=!0;if(o.kind===2){let d=0;if(a){let h=a.get(o.openingBracket.text);h===void 0&&(h=0),d=h,h++,a.set(o.openingBracket.text,h)}let c=Mt(e,o.openingBracket.length),u=-1;if(r.includeMinIndentation&&(u=o.computeMinIndentation(e,r.textModel)),l=r.push(new Hv(bl(e,t),bl(e,c),o.closingBracket?bl(Mt(c,o.child?.length||Dn),t):void 0,s,d,o,u)),e=c,l&&o.child){let h=o.child;if(t=Mt(e,h.length),gl(e,i)&&wu(t,n)&&(l=HT(h,e,t,n,i,r,s+1,a),!l))return!1}a?.set(o.openingBracket.text,d)}else{let d=e;for(let c of o.children){let u=d;if(d=Mt(d,c.length),gl(u,i)&&gl(n,d)&&(l=HT(c,u,d,n,i,r,s,a),!l))return!1}}return l}var Oy=class extends V{constructor(t,n){super();this.textModel=t;this.languageConfigurationService=n}bracketPairsTree=this._register(new Zt);onDidChangeEmitter=new E;onDidChange=this.onDidChangeEmitter.event;get canBuildAST(){return this.textModel.getValueLength()<=5e6}bracketsRequested=!1;handleLanguageConfigurationServiceChange(t){(!t.languageId||this.bracketPairsTree.value?.object.didLanguageChange(t.languageId))&&(this.bracketPairsTree.clear(),this.updateBracketPairsTree())}handleDidChangeOptions(t){this.bracketPairsTree.clear(),this.updateBracketPairsTree()}handleDidChangeLanguage(t){this.bracketPairsTree.clear(),this.updateBracketPairsTree()}handleDidChangeContent(t){this.bracketPairsTree.value?.object.handleContentChanged(t)}handleDidChangeBackgroundTokenizationState(){this.bracketPairsTree.value?.object.handleDidChangeBackgroundTokenizationState()}handleDidChangeTokens(t){this.bracketPairsTree.value?.object.handleDidChangeTokens(t)}updateBracketPairsTree(){if(this.bracketsRequested&&this.canBuildAST){if(!this.bracketPairsTree.value){let t=new he;this.bracketPairsTree.value=t4(t.add(new My(this.textModel,n=>this.languageConfigurationService.getLanguageConfiguration(n))),t),t.add(this.bracketPairsTree.value.object.onDidChange(n=>this.onDidChangeEmitter.fire(n))),this.onDidChangeEmitter.fire()}}else this.bracketPairsTree.value&&(this.bracketPairsTree.clear(),this.onDidChangeEmitter.fire())}getBracketPairsInRange(t){return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getBracketPairsInRange(t,!1)||Zs.empty}getBracketPairsInRangeWithMinIndentation(t){return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getBracketPairsInRange(t,!0)||Zs.empty}getBracketsInRange(t,n=!1){return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getBracketsInRange(t,n)||Zs.empty}findMatchingBracketUp(t,n,i){let r=this.textModel.validatePosition(n),s=this.textModel.getLanguageIdAtPosition(r.lineNumber,r.column);if(this.canBuildAST){let a=this.languageConfigurationService.getLanguageConfiguration(s).bracketsNew.getClosingBracketInfo(t);if(!a)return null;let l=this.getBracketPairsInRange(D.fromPositions(n,n)).findLast(d=>a.closes(d.openingBracketInfo));return l?l.openingBracketRange:null}else{let a=t.toLowerCase(),l=this.languageConfigurationService.getLanguageConfiguration(s).brackets;if(!l)return null;let d=l.textIsBracket[a];return d?Ay(this._findMatchingBracketUp(d,r,UT(i))):null}}matchBracket(t,n){if(this.canBuildAST){let i=this.getBracketPairsInRange(D.fromPositions(t,t)).filter(r=>r.closingBracketRange!==void 0&&(r.openingBracketRange.containsPosition(t)||r.closingBracketRange.containsPosition(t))).findLastMaxBy(Jl(r=>r.openingBracketRange.containsPosition(t)?r.openingBracketRange:r.closingBracketRange,D.compareRangesUsingStarts));return i?[i.openingBracketRange,i.closingBracketRange]:null}else{let i=UT(n);return this._matchBracket(this.textModel.validatePosition(t),i)}}_establishBracketSearchOffsets(t,n,i,r){let s=n.getCount(),a=n.getLanguageId(r),l=Math.max(0,t.column-1-i.maxBracketLength);for(let c=r-1;c>=0;c--){let u=n.getEndOffset(c);if(u<=l)break;if(rr(n.getStandardTokenType(c))||n.getLanguageId(c)!==a){l=u;break}}let d=Math.min(n.getLineContent().length,t.column-1+i.maxBracketLength);for(let c=r+1;c<s;c++){let u=n.getStartOffset(c);if(u>=d)break;if(rr(n.getStandardTokenType(c))||n.getLanguageId(c)!==a){d=u;break}}return{searchStartOffset:l,searchEndOffset:d}}_matchBracket(t,n){let i=t.lineNumber,r=this.textModel.tokenization.getLineTokens(i),s=this.textModel.getLineContent(i),a=r.findTokenIndexAtOffset(t.column-1);if(a<0)return null;let l=this.languageConfigurationService.getLanguageConfiguration(r.getLanguageId(a)).brackets;if(l&&!rr(r.getStandardTokenType(a))){let{searchStartOffset:d,searchEndOffset:c}=this._establishBracketSearchOffsets(t,r,l,a),u=null;for(;;){let h=Vi.findNextBracketInRange(l.forwardRegex,i,s,d,c);if(!h)break;if(h.startColumn<=t.column&&t.column<=h.endColumn){let m=s.substring(h.startColumn-1,h.endColumn-1).toLowerCase(),f=this._matchFoundBracket(h,l.textIsBracket[m],l.textIsOpenBracket[m],n);if(f){if(f instanceof ga)return null;u=f}}d=h.endColumn-1}if(u)return u}if(a>0&&r.getStartOffset(a)===t.column-1){let d=a-1,c=this.languageConfigurationService.getLanguageConfiguration(r.getLanguageId(d)).brackets;if(c&&!rr(r.getStandardTokenType(d))){let{searchStartOffset:u,searchEndOffset:h}=this._establishBracketSearchOffsets(t,r,c,d),m=Vi.findPrevBracketInRange(c.reversedRegex,i,s,u,h);if(m&&m.startColumn<=t.column&&t.column<=m.endColumn){let f=s.substring(m.startColumn-1,m.endColumn-1).toLowerCase(),g=this._matchFoundBracket(m,c.textIsBracket[f],c.textIsOpenBracket[f],n);if(g)return g instanceof ga?null:g}}}return null}_matchFoundBracket(t,n,i,r){if(!n)return null;let s=i?this._findMatchingBracketDown(n,t.getEndPosition(),r):this._findMatchingBracketUp(n,t.getStartPosition(),r);return s?s instanceof ga?s:[t,s]:null}_findMatchingBracketUp(t,n,i){let r=t.languageId,s=t.reversedRegex,a=-1,l=0,d=(c,u,h,m)=>{for(;;){if(i&&++l%100===0&&!i())return ga.INSTANCE;let f=Vi.findPrevBracketInRange(s,c,u,h,m);if(!f)break;let g=u.substring(f.startColumn-1,f.endColumn-1).toLowerCase();if(t.isOpen(g)?a++:t.isClose(g)&&a--,a===0)return f;m=f.startColumn-1}return null};for(let c=n.lineNumber;c>=1;c--){let u=this.textModel.tokenization.getLineTokens(c),h=u.getCount(),m=this.textModel.getLineContent(c),f=h-1,g=m.length,b=m.length;c===n.lineNumber&&(f=u.findTokenIndexAtOffset(n.column-1),g=n.column-1,b=n.column-1);let y=!0;for(;f>=0;f--){let C=u.getLanguageId(f)===r&&!rr(u.getStandardTokenType(f));if(C)y?g=u.getStartOffset(f):(g=u.getStartOffset(f),b=u.getEndOffset(f));else if(y&&g!==b){let x=d(c,m,g,b);if(x)return x}y=C}if(y&&g!==b){let C=d(c,m,g,b);if(C)return C}}return null}_findMatchingBracketDown(t,n,i){let r=t.languageId,s=t.forwardRegex,a=1,l=0,d=(u,h,m,f)=>{for(;;){if(i&&++l%100===0&&!i())return ga.INSTANCE;let g=Vi.findNextBracketInRange(s,u,h,m,f);if(!g)break;let b=h.substring(g.startColumn-1,g.endColumn-1).toLowerCase();if(t.isOpen(b)?a++:t.isClose(b)&&a--,a===0)return g;m=g.endColumn-1}return null},c=this.textModel.getLineCount();for(let u=n.lineNumber;u<=c;u++){let h=this.textModel.tokenization.getLineTokens(u),m=h.getCount(),f=this.textModel.getLineContent(u),g=0,b=0,y=0;u===n.lineNumber&&(g=h.findTokenIndexAtOffset(n.column-1),b=n.column-1,y=n.column-1);let C=!0;for(;g<m;g++){let x=h.getLanguageId(g)===r&&!rr(h.getStandardTokenType(g));if(x)C||(b=h.getStartOffset(g)),y=h.getEndOffset(g);else if(C&&b!==y){let L=d(u,f,b,y);if(L)return L}C=x}if(C&&b!==y){let x=d(u,f,b,y);if(x)return x}}return null}findPrevBracket(t){let n=this.textModel.validatePosition(t);if(this.canBuildAST)return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getFirstBracketBefore(n)||null;let i=null,r=null,s=null;for(let a=n.lineNumber;a>=1;a--){let l=this.textModel.tokenization.getLineTokens(a),d=l.getCount(),c=this.textModel.getLineContent(a),u=d-1,h=c.length,m=c.length;if(a===n.lineNumber){u=l.findTokenIndexAtOffset(n.column-1),h=n.column-1,m=n.column-1;let g=l.getLanguageId(u);i!==g&&(i=g,r=this.languageConfigurationService.getLanguageConfiguration(i).brackets,s=this.languageConfigurationService.getLanguageConfiguration(i).bracketsNew)}let f=!0;for(;u>=0;u--){let g=l.getLanguageId(u);if(i!==g){if(r&&s&&f&&h!==m){let y=Vi.findPrevBracketInRange(r.reversedRegex,a,c,h,m);if(y)return this._toFoundBracket(s,y);f=!1}i=g,r=this.languageConfigurationService.getLanguageConfiguration(i).brackets,s=this.languageConfigurationService.getLanguageConfiguration(i).bracketsNew}let b=!!r&&!rr(l.getStandardTokenType(u));if(b)f?h=l.getStartOffset(u):(h=l.getStartOffset(u),m=l.getEndOffset(u));else if(s&&r&&f&&h!==m){let y=Vi.findPrevBracketInRange(r.reversedRegex,a,c,h,m);if(y)return this._toFoundBracket(s,y)}f=b}if(s&&r&&f&&h!==m){let g=Vi.findPrevBracketInRange(r.reversedRegex,a,c,h,m);if(g)return this._toFoundBracket(s,g)}}return null}findNextBracket(t){let n=this.textModel.validatePosition(t);if(this.canBuildAST)return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getFirstBracketAfter(n)||null;let i=this.textModel.getLineCount(),r=null,s=null,a=null;for(let l=n.lineNumber;l<=i;l++){let d=this.textModel.tokenization.getLineTokens(l),c=d.getCount(),u=this.textModel.getLineContent(l),h=0,m=0,f=0;if(l===n.lineNumber){h=d.findTokenIndexAtOffset(n.column-1),m=n.column-1,f=n.column-1;let b=d.getLanguageId(h);r!==b&&(r=b,s=this.languageConfigurationService.getLanguageConfiguration(r).brackets,a=this.languageConfigurationService.getLanguageConfiguration(r).bracketsNew)}let g=!0;for(;h<c;h++){let b=d.getLanguageId(h);if(r!==b){if(a&&s&&g&&m!==f){let C=Vi.findNextBracketInRange(s.forwardRegex,l,u,m,f);if(C)return this._toFoundBracket(a,C);g=!1}r=b,s=this.languageConfigurationService.getLanguageConfiguration(r).brackets,a=this.languageConfigurationService.getLanguageConfiguration(r).bracketsNew}let y=!!s&&!rr(d.getStandardTokenType(h));if(y)g||(m=d.getStartOffset(h)),f=d.getEndOffset(h);else if(a&&s&&g&&m!==f){let C=Vi.findNextBracketInRange(s.forwardRegex,l,u,m,f);if(C)return this._toFoundBracket(a,C)}g=y}if(a&&s&&g&&m!==f){let b=Vi.findNextBracketInRange(s.forwardRegex,l,u,m,f);if(b)return this._toFoundBracket(a,b)}}return null}findEnclosingBrackets(t,n){let i=this.textModel.validatePosition(t);if(this.canBuildAST){let f=D.fromPositions(i),g=this.getBracketPairsInRange(D.fromPositions(i,i)).findLast(b=>b.closingBracketRange!==void 0&&b.range.strictContainsRange(f));return g?[g.openingBracketRange,g.closingBracketRange]:null}let r=UT(n),s=this.textModel.getLineCount(),a=new Map,l=[],d=(f,g)=>{if(!a.has(f)){let b=[];for(let y=0,C=g?g.brackets.length:0;y<C;y++)b[y]=0;a.set(f,b)}l=a.get(f)},c=0,u=(f,g,b,y,C)=>{for(;;){if(r&&++c%100===0&&!r())return ga.INSTANCE;let x=Vi.findNextBracketInRange(f.forwardRegex,g,b,y,C);if(!x)break;let L=b.substring(x.startColumn-1,x.endColumn-1).toLowerCase(),k=f.textIsBracket[L];if(k&&(k.isOpen(L)?l[k.index]++:k.isClose(L)&&l[k.index]--,l[k.index]===-1))return this._matchFoundBracket(x,k,!1,r);y=x.endColumn-1}return null},h=null,m=null;for(let f=i.lineNumber;f<=s;f++){let g=this.textModel.tokenization.getLineTokens(f),b=g.getCount(),y=this.textModel.getLineContent(f),C=0,x=0,L=0;if(f===i.lineNumber){C=g.findTokenIndexAtOffset(i.column-1),x=i.column-1,L=i.column-1;let O=g.getLanguageId(C);h!==O&&(h=O,m=this.languageConfigurationService.getLanguageConfiguration(h).brackets,d(h,m))}let k=!0;for(;C<b;C++){let O=g.getLanguageId(C);if(h!==O){if(m&&k&&x!==L){let z=u(m,f,y,x,L);if(z)return Ay(z);k=!1}h=O,m=this.languageConfigurationService.getLanguageConfiguration(h).brackets,d(h,m)}let W=!!m&&!rr(g.getStandardTokenType(C));if(W)k||(x=g.getStartOffset(C)),L=g.getEndOffset(C);else if(m&&k&&x!==L){let z=u(m,f,y,x,L);if(z)return Ay(z)}k=W}if(m&&k&&x!==L){let O=u(m,f,y,x,L);if(O)return Ay(O)}}return null}_toFoundBracket(t,n){if(!n)return null;let i=this.textModel.getValueInRange(n);i=i.toLowerCase();let r=t.getBracketInfo(i);return r?{range:n,bracketInfo:r}:null}};function t4(o,e){return{object:o,dispose:()=>e?.dispose()}}function UT(o){if(typeof o>"u")return()=>!0;{let e=Date.now();return()=>Date.now()-e<=o}}var ga=class o{static INSTANCE=new o;_searchCanceledBrand=void 0;constructor(){}};function Ay(o){return o instanceof ga?null:o}var zT=I("editor.lineHighlightBackground",null,p("lineHighlight","Background color for the highlight of line at the cursor position.")),KT=I("editor.lineHighlightBorder",{dark:"#282828",light:"#eeeeee",hcDark:"#f38518",hcLight:be},p("lineHighlightBorderBox","Background color for the border around the line at the cursor position.")),yIe=I("editor.rangeHighlightBackground",{dark:"#ffffff0b",light:"#fdff0033",hcDark:null,hcLight:null},p("rangeHighlight","Background color of highlighted ranges, like by quick open and find features. The color must not be opaque so as not to hide underlying decorations."),!0),IIe=I("editor.rangeHighlightBorder",{dark:null,light:null,hcDark:Ct,hcLight:Ct},p("rangeHighlightBorder","Background color of the border around highlighted ranges.")),CIe=I("editor.symbolHighlightBackground",{dark:Fr,light:Fr,hcDark:null,hcLight:null},p("symbolHighlight","Background color of highlighted symbol, like for go to definition or go next/previous symbol. The color must not be opaque so as not to hide underlying decorations."),!0),SIe=I("editor.symbolHighlightBorder",{dark:null,light:null,hcDark:Ct,hcLight:Ct},p("symbolHighlightBorder","Background color of the border around highlighted symbols.")),Yu=I("editorCursor.foreground",{dark:"#AEAFAD",light:N.black,hcDark:N.white,hcLight:"#0F4A85"},p("caret","Color of the editor cursor.")),Ny=I("editorCursor.background",null,p("editorCursorBackground","The background color of the editor cursor. Allows customizing the color of a character overlapped by a block cursor.")),Py=I("editorMultiCursor.primary.foreground",Yu,p("editorMultiCursorPrimaryForeground","Color of the primary editor cursor when multiple cursors are present.")),nN=I("editorMultiCursor.primary.background",Ny,p("editorMultiCursorPrimaryBackground","The background color of the primary editor cursor when multiple cursors are present. Allows customizing the color of a character overlapped by a block cursor.")),Fy=I("editorMultiCursor.secondary.foreground",Yu,p("editorMultiCursorSecondaryForeground","Color of secondary editor cursors when multiple cursors are present.")),iN=I("editorMultiCursor.secondary.background",Ny,p("editorMultiCursorSecondaryBackground","The background color of secondary editor cursors when multiple cursors are present. Allows customizing the color of a character overlapped by a block cursor.")),By=I("editorWhitespace.foreground",{dark:"#e3e4e229",light:"#33333333",hcDark:"#e3e4e229",hcLight:"#CCCCCC"},p("editorWhitespaces","Color of whitespace characters in the editor.")),oN=I("editorLineNumber.foreground",{dark:"#858585",light:"#237893",hcDark:N.white,hcLight:"#292929"},p("editorLineNumbers","Color of editor line numbers.")),n4=I("editorIndentGuide.background",By,p("editorIndentGuides","Color of the editor indentation guides."),!1,p("deprecatedEditorIndentGuides","'editorIndentGuide.background' is deprecated. Use 'editorIndentGuide.background1' instead.")),i4=I("editorIndentGuide.activeBackground",By,p("editorActiveIndentGuide","Color of the active editor indentation guides."),!1,p("deprecatedEditorActiveIndentGuide","'editorIndentGuide.activeBackground' is deprecated. Use 'editorIndentGuide.activeBackground1' instead.")),rN=I("editorIndentGuide.background1",n4,p("editorIndentGuides1","Color of the editor indentation guides (1).")),sN=I("editorIndentGuide.background2","#00000000",p("editorIndentGuides2","Color of the editor indentation guides (2).")),aN=I("editorIndentGuide.background3","#00000000",p("editorIndentGuides3","Color of the editor indentation guides (3).")),lN=I("editorIndentGuide.background4","#00000000",p("editorIndentGuides4","Color of the editor indentation guides (4).")),dN=I("editorIndentGuide.background5","#00000000",p("editorIndentGuides5","Color of the editor indentation guides (5).")),cN=I("editorIndentGuide.background6","#00000000",p("editorIndentGuides6","Color of the editor indentation guides (6).")),uN=I("editorIndentGuide.activeBackground1",i4,p("editorActiveIndentGuide1","Color of the active editor indentation guides (1).")),hN=I("editorIndentGuide.activeBackground2","#00000000",p("editorActiveIndentGuide2","Color of the active editor indentation guides (2).")),pN=I("editorIndentGuide.activeBackground3","#00000000",p("editorActiveIndentGuide3","Color of the active editor indentation guides (3).")),mN=I("editorIndentGuide.activeBackground4","#00000000",p("editorActiveIndentGuide4","Color of the active editor indentation guides (4).")),gN=I("editorIndentGuide.activeBackground5","#00000000",p("editorActiveIndentGuide5","Color of the active editor indentation guides (5).")),fN=I("editorIndentGuide.activeBackground6","#00000000",p("editorActiveIndentGuide6","Color of the active editor indentation guides (6).")),o4=I("editorActiveLineNumber.foreground",{dark:"#c6c6c6",light:"#0B216F",hcDark:Ct,hcLight:Ct},p("editorActiveLineNumber","Color of editor active line number"),!1,p("deprecatedEditorActiveLineNumber","Id is deprecated. Use 'editorLineNumber.activeForeground' instead.")),wIe=I("editorLineNumber.activeForeground",o4,p("editorActiveLineNumber","Color of editor active line number")),bN=I("editorLineNumber.dimmedForeground",null,p("editorDimmedLineNumber","Color of the final editor line when editor.renderFinalNewline is set to dimmed.")),xIe=I("editorRuler.foreground",{dark:"#5A5A5A",light:N.lightgrey,hcDark:N.white,hcLight:"#292929"},p("editorRuler","Color of the editor rulers.")),EIe=I("editorCodeLens.foreground",{dark:"#999999",light:"#919191",hcDark:"#999999",hcLight:"#292929"},p("editorCodeLensForeground","Foreground color of editor CodeLens")),_Ie=I("editorBracketMatch.background",{dark:"#0064001a",light:"#0064001a",hcDark:"#0064001a",hcLight:"#0000"},p("editorBracketMatchBackground","Background color behind matching brackets")),TIe=I("editorBracketMatch.border",{dark:"#888",light:"#B9B9B9",hcDark:be,hcLight:be},p("editorBracketMatchBorder","Color for matching brackets boxes")),vN=I("editorOverviewRuler.border",{dark:"#7f7f7f4d",light:"#7f7f7f4d",hcDark:"#7f7f7f4d",hcLight:"#666666"},p("editorOverviewRulerBorder","Color of the overview ruler border.")),yN=I("editorOverviewRuler.background",null,p("editorOverviewRulerBackground","Background color of the editor overview ruler.")),LIe=I("editorGutter.background",lr,p("editorGutter","Background color of the editor gutter. The gutter contains the glyph margins and the line numbers.")),DIe=I("editorUnnecessaryCode.border",{dark:null,light:null,hcDark:N.fromHex("#fff").transparent(.8),hcLight:be},p("unnecessaryCodeBorder","Border color of unnecessary (unused) source code in the editor.")),IN=I("editorUnnecessaryCode.opacity",{dark:N.fromHex("#000a"),light:N.fromHex("#0007"),hcDark:null,hcLight:null},p("unnecessaryCodeOpacity",`Opacity of unnecessary (unused) source code in the editor. For example, "#000000c0" will render the code with 75% opacity. For high contrast themes, use the  'editorUnnecessaryCode.border' theme color to underline unnecessary code instead of fading it out.`)),kIe=I("editorGhostText.border",{dark:null,light:null,hcDark:N.fromHex("#fff").transparent(.8),hcLight:N.fromHex("#292929").transparent(.8)},p("editorGhostTextBorder","Border color of ghost text in the editor.")),RIe=I("editorGhostText.foreground",{dark:N.fromHex("#ffffff56"),light:N.fromHex("#0007"),hcDark:null,hcLight:null},p("editorGhostTextForeground","Foreground color of the ghost text in the editor.")),MIe=I("editorGhostText.background",null,p("editorGhostTextBackground","Background color of the ghost text in the editor.")),r4=new N(new Ge(0,122,204,.6)),AIe=I("editorOverviewRuler.rangeHighlightForeground",r4,p("overviewRulerRangeHighlight","Overview ruler marker color for range highlights. The color must not be opaque so as not to hide underlying decorations."),!0),OIe=I("editorOverviewRuler.errorForeground",{dark:new N(new Ge(255,18,18,.7)),light:new N(new Ge(255,18,18,.7)),hcDark:new N(new Ge(255,50,50,1)),hcLight:"#B5200D"},p("overviewRuleError","Overview ruler marker color for errors.")),NIe=I("editorOverviewRuler.warningForeground",{dark:Hi,light:Hi,hcDark:Mu,hcLight:Mu},p("overviewRuleWarning","Overview ruler marker color for warnings.")),PIe=I("editorOverviewRuler.infoForeground",{dark:To,light:To,hcDark:Au,hcLight:Au},p("overviewRuleInfo","Overview ruler marker color for infos.")),Vy=I("editorBracketHighlight.foreground1",{dark:"#FFD700",light:"#0431FAFF",hcDark:"#FFD700",hcLight:"#0431FAFF"},p("editorBracketHighlightForeground1","Foreground color of brackets (1). Requires enabling bracket pair colorization.")),Wy=I("editorBracketHighlight.foreground2",{dark:"#DA70D6",light:"#319331FF",hcDark:"#DA70D6",hcLight:"#319331FF"},p("editorBracketHighlightForeground2","Foreground color of brackets (2). Requires enabling bracket pair colorization.")),Hy=I("editorBracketHighlight.foreground3",{dark:"#179FFF",light:"#7B3814FF",hcDark:"#87CEFA",hcLight:"#7B3814FF"},p("editorBracketHighlightForeground3","Foreground color of brackets (3). Requires enabling bracket pair colorization.")),Uy=I("editorBracketHighlight.foreground4","#00000000",p("editorBracketHighlightForeground4","Foreground color of brackets (4). Requires enabling bracket pair colorization.")),zy=I("editorBracketHighlight.foreground5","#00000000",p("editorBracketHighlightForeground5","Foreground color of brackets (5). Requires enabling bracket pair colorization.")),Ky=I("editorBracketHighlight.foreground6","#00000000",p("editorBracketHighlightForeground6","Foreground color of brackets (6). Requires enabling bracket pair colorization.")),CN=I("editorBracketHighlight.unexpectedBracket.foreground",{dark:new N(new Ge(255,18,18,.8)),light:new N(new Ge(255,18,18,.8)),hcDark:"new Color(new RGBA(255, 50, 50, 1))",hcLight:"#B5200D"},p("editorBracketHighlightUnexpectedBracketForeground","Foreground color of unexpected brackets.")),SN=I("editorBracketPairGuide.background1","#00000000",p("editorBracketPairGuide.background1","Background color of inactive bracket pair guides (1). Requires enabling bracket pair guides.")),wN=I("editorBracketPairGuide.background2","#00000000",p("editorBracketPairGuide.background2","Background color of inactive bracket pair guides (2). Requires enabling bracket pair guides.")),xN=I("editorBracketPairGuide.background3","#00000000",p("editorBracketPairGuide.background3","Background color of inactive bracket pair guides (3). Requires enabling bracket pair guides.")),EN=I("editorBracketPairGuide.background4","#00000000",p("editorBracketPairGuide.background4","Background color of inactive bracket pair guides (4). Requires enabling bracket pair guides.")),_N=I("editorBracketPairGuide.background5","#00000000",p("editorBracketPairGuide.background5","Background color of inactive bracket pair guides (5). Requires enabling bracket pair guides.")),TN=I("editorBracketPairGuide.background6","#00000000",p("editorBracketPairGuide.background6","Background color of inactive bracket pair guides (6). Requires enabling bracket pair guides.")),LN=I("editorBracketPairGuide.activeBackground1","#00000000",p("editorBracketPairGuide.activeBackground1","Background color of active bracket pair guides (1). Requires enabling bracket pair guides.")),DN=I("editorBracketPairGuide.activeBackground2","#00000000",p("editorBracketPairGuide.activeBackground2","Background color of active bracket pair guides (2). Requires enabling bracket pair guides.")),kN=I("editorBracketPairGuide.activeBackground3","#00000000",p("editorBracketPairGuide.activeBackground3","Background color of active bracket pair guides (3). Requires enabling bracket pair guides.")),RN=I("editorBracketPairGuide.activeBackground4","#00000000",p("editorBracketPairGuide.activeBackground4","Background color of active bracket pair guides (4). Requires enabling bracket pair guides.")),MN=I("editorBracketPairGuide.activeBackground5","#00000000",p("editorBracketPairGuide.activeBackground5","Background color of active bracket pair guides (5). Requires enabling bracket pair guides.")),AN=I("editorBracketPairGuide.activeBackground6","#00000000",p("editorBracketPairGuide.activeBackground6","Background color of active bracket pair guides (6). Requires enabling bracket pair guides.")),FIe=I("editorUnicodeHighlight.border",Hi,p("editorUnicodeHighlight.border","Border color used to highlight unicode characters.")),BIe=I("editorUnicodeHighlight.background",uA,p("editorUnicodeHighlight.background","Background color used to highlight unicode characters."));Ui((o,e)=>{let t=o.getColor(lr),n=o.getColor(zT),i=n&&!n.isTransparent()?n:t;i&&e.addRule(`.monaco-editor .inputarea.ime-input { background-color: ${i}; }`)});var Gy=class extends V{constructor(t){super();this.textModel=t;this.colorizationOptions=t.getOptions().bracketPairColorizationOptions,this._register(t.bracketPairs.onDidChange(n=>{this.onDidChangeEmitter.fire()}))}colorizationOptions;colorProvider=new jy;onDidChangeEmitter=new E;onDidChange=this.onDidChangeEmitter.event;handleDidChangeOptions(t){this.colorizationOptions=this.textModel.getOptions().bracketPairColorizationOptions}getDecorationsInRange(t,n,i,r){return r?[]:n===void 0?[]:this.colorizationOptions.enabled?this.textModel.bracketPairs.getBracketsInRange(t,!0).map(a=>({id:`bracket${a.range.toString()}-${a.nestingLevel}`,options:{description:"BracketPairColorization",inlineClassName:this.colorProvider.getInlineClassName(a,this.colorizationOptions.independentColorPoolPerBracketType)},ownerId:0,range:a.range})).toArray():[]}getAllDecorations(t,n){return t===void 0?[]:this.colorizationOptions.enabled?this.getDecorationsInRange(new D(1,1,this.textModel.getLineCount(),1),t,n):[]}},jy=class{unexpectedClosingBracketClassName="unexpected-closing-bracket";getInlineClassName(e,t){return e.isInvalid?this.unexpectedClosingBracketClassName:this.getInlineClassNameOfLevel(t?e.nestingLevelOfEqualBracketType:e.nestingLevel)}getInlineClassNameOfLevel(e){return`bracket-highlighting-${e%30}`}};Ui((o,e)=>{let t=[Vy,Wy,Hy,Uy,zy,Ky],n=new jy;e.addRule(`.monaco-editor .${n.unexpectedClosingBracketClassName} { color: ${o.getColor(CN)}; }`);let i=t.map(r=>o.getColor(r)).filter(r=>!!r).filter(r=>!r.isTransparent());for(let r=0;r<30;r++){let s=i[r%i.length];e.addRule(`.monaco-editor .${n.getInlineClassNameOfLevel(r)} { color: ${s}; }`)}});function Zu(o){return o.toString()}var so=class o{constructor(e,t,n,i,r,s,a){this.beforeVersionId=e;this.afterVersionId=t;this.beforeEOL=n;this.afterEOL=i;this.beforeCursorState=r;this.afterCursorState=s;this.changes=a}static create(e,t){let n=e.getAlternativeVersionId(),i=$T(e);return new o(n,n,i,i,t,t,[])}append(e,t,n,i,r){t.length>0&&(this.changes=yM(this.changes,t)),this.afterEOL=n,this.afterVersionId=i,this.afterCursorState=r}static _writeSelectionsSize(e){return 4+4*4*(e?e.length:0)}static _writeSelections(e,t,n){if(Vn(e,t?t.length:0,n),n+=4,t)for(let i of t)Vn(e,i.selectionStartLineNumber,n),n+=4,Vn(e,i.selectionStartColumn,n),n+=4,Vn(e,i.positionLineNumber,n),n+=4,Vn(e,i.positionColumn,n),n+=4;return n}static _readSelections(e,t,n){let i=Bn(e,t);t+=4;for(let r=0;r<i;r++){let s=Bn(e,t);t+=4;let a=Bn(e,t);t+=4;let l=Bn(e,t);t+=4;let d=Bn(e,t);t+=4,n.push(new He(s,a,l,d))}return t}serialize(){let e=10+o._writeSelectionsSize(this.beforeCursorState)+o._writeSelectionsSize(this.afterCursorState)+4;for(let i of this.changes)e+=i.writeSize();let t=new Uint8Array(e),n=0;Vn(t,this.beforeVersionId,n),n+=4,Vn(t,this.afterVersionId,n),n+=4,hv(t,this.beforeEOL,n),n+=1,hv(t,this.afterEOL,n),n+=1,n=o._writeSelections(t,this.beforeCursorState,n),n=o._writeSelections(t,this.afterCursorState,n),Vn(t,this.changes.length,n),n+=4;for(let i of this.changes)n=i.write(t,n);return t.buffer}static deserialize(e){let t=new Uint8Array(e),n=0,i=Bn(t,n);n+=4;let r=Bn(t,n);n+=4;let s=uv(t,n);n+=1;let a=uv(t,n);n+=1;let l=[];n=o._readSelections(t,n,l);let d=[];n=o._readSelections(t,n,d);let c=Bn(t,n);n+=4;let u=[];for(let h=0;h<c;h++)n=So.read(t,n,u);return new o(i,r,s,a,l,d,u)}},$y=class{constructor(e,t,n,i){this.label=e;this.code=t;this.model=n,this._data=so.create(n,i)}model;_data;get type(){return 0}get resource(){return ie.isUri(this.model)?this.model:this.model.uri}toString(){return(this._data instanceof so?this._data:so.deserialize(this._data)).changes.map(t=>t.toString()).join(", ")}matchesResource(e){return(ie.isUri(this.model)?this.model:this.model.uri).toString()===e.toString()}setModel(e){this.model=e}canAppend(e){return this.model===e&&this._data instanceof so}append(e,t,n,i,r){this._data instanceof so&&this._data.append(e,t,n,i,r)}close(){this._data instanceof so&&(this._data=this._data.serialize())}open(){this._data instanceof so||(this._data=so.deserialize(this._data))}undo(){if(ie.isUri(this.model))throw new Error("Invalid SingleModelEditStackElement");this._data instanceof so&&(this._data=this._data.serialize());let e=so.deserialize(this._data);this.model._applyUndo(e.changes,e.beforeEOL,e.beforeVersionId,e.beforeCursorState)}redo(){if(ie.isUri(this.model))throw new Error("Invalid SingleModelEditStackElement");this._data instanceof so&&(this._data=this._data.serialize());let e=so.deserialize(this._data);this.model._applyRedo(e.changes,e.afterEOL,e.afterVersionId,e.afterCursorState)}heapSize(){return this._data instanceof so&&(this._data=this._data.serialize()),this._data.byteLength+168}},jT=class{constructor(e,t,n){this.label=e;this.code=t;this._isOpen=!0,this._editStackElementsArr=n.slice(0),this._editStackElementsMap=new Map;for(let i of this._editStackElementsArr){let r=Zu(i.resource);this._editStackElementsMap.set(r,i)}this._delegate=null}type=1;_isOpen;_editStackElementsArr;_editStackElementsMap;_delegate;get resources(){return this._editStackElementsArr.map(e=>e.resource)}setDelegate(e){this._delegate=e}prepareUndoRedo(){if(this._delegate)return this._delegate.prepareUndoRedo(this)}getMissingModels(){let e=[];for(let t of this._editStackElementsArr)ie.isUri(t.model)&&e.push(t.model);return e}matchesResource(e){let t=Zu(e);return this._editStackElementsMap.has(t)}setModel(e){let t=Zu(ie.isUri(e)?e:e.uri);this._editStackElementsMap.has(t)&&this._editStackElementsMap.get(t).setModel(e)}canAppend(e){if(!this._isOpen)return!1;let t=Zu(e.uri);return this._editStackElementsMap.has(t)?this._editStackElementsMap.get(t).canAppend(e):!1}append(e,t,n,i,r){let s=Zu(e.uri);this._editStackElementsMap.get(s).append(e,t,n,i,r)}close(){this._isOpen=!1}open(){}undo(){this._isOpen=!1;for(let e of this._editStackElementsArr)e.undo()}redo(){for(let e of this._editStackElementsArr)e.redo()}heapSize(e){let t=Zu(e);return this._editStackElementsMap.has(t)?this._editStackElementsMap.get(t).heapSize():0}split(){return this._editStackElementsArr}toString(){let e=[];for(let t of this._editStackElementsArr)e.push(`${xr(t.resource)}: ${t}`);return`{${e.join(", ")}}`}};function $T(o){return o.getEOL()===`
`?0:1}function GT(o){return o?o instanceof $y||o instanceof jT:!1}var qy=class o{_model;_undoRedoService;constructor(e,t){this._model=e,this._undoRedoService=t}pushStackElement(){let e=this._undoRedoService.getLastElement(this._model.uri);GT(e)&&e.close()}popStackElement(){let e=this._undoRedoService.getLastElement(this._model.uri);GT(e)&&e.open()}clear(){this._undoRedoService.removeElements(this._model.uri)}_getOrCreateEditStackElement(e,t){let n=this._undoRedoService.getLastElement(this._model.uri);if(GT(n)&&n.canAppend(this._model))return n;let i=new $y(p("edit","Typing"),"undoredo.textBufferEdit",this._model,e);return this._undoRedoService.pushElement(i,t),i}pushEOL(e){let t=this._getOrCreateEditStackElement(null,void 0);this._model.setEOL(e),t.append(this._model,[],$T(this._model),this._model.getAlternativeVersionId(),null)}pushEditOperation(e,t,n,i){let r=this._getOrCreateEditStackElement(e,i),s=this._model.applyEdits(t,!0),a=o._computeCursorState(n,s),l=s.map((d,c)=>({index:c,textChange:d.textChange}));return l.sort((d,c)=>d.textChange.oldPosition===c.textChange.oldPosition?d.index-c.index:d.textChange.oldPosition-c.textChange.oldPosition),r.append(this._model,l.map(d=>d.textChange),$T(this._model),this._model.getAlternativeVersionId(),a),a}static _computeCursorState(e,t){try{return e?e(t):null}catch(n){return je(n),null}}};var Xu=class extends V{_isDisposed=!1;dispose(){super.dispose(),this._isDisposed=!0}assertNotDisposed(){if(this._isDisposed)throw new Error("TextModelPart is disposed!")}};function ON(o,e){let t=0,n=0,i=o.length;for(;n<i;){let r=o.charCodeAt(n);if(r===32)t++;else if(r===9)t=t-t%e+e;else break;n++}return n===i?-1:t}var Yy=class extends Xu{constructor(t,n){super();this.textModel=t;this.languageConfigurationService=n}getLanguageConfiguration(t){return this.languageConfigurationService.getLanguageConfiguration(t)}_computeIndentLevel(t){return ON(this.textModel.getLineContent(t+1),this.textModel.getOptions().tabSize)}getActiveIndentGuide(t,n,i){this.assertNotDisposed();let r=this.textModel.getLineCount();if(t<1||t>r)throw new Qe("Illegal value for lineNumber");let s=this.getLanguageConfiguration(this.textModel.getLanguageId()).foldingRules,a=!!(s&&s.offSide),l=-2,d=-1,c=-2,u=-1,h=z=>{if(l!==-1&&(l===-2||l>z-1)){l=-1,d=-1;for(let B=z-2;B>=0;B--){let G=this._computeIndentLevel(B);if(G>=0){l=B,d=G;break}}}if(c===-2){c=-1,u=-1;for(let B=z;B<r;B++){let G=this._computeIndentLevel(B);if(G>=0){c=B,u=G;break}}}},m=-2,f=-1,g=-2,b=-1,y=z=>{if(m===-2){m=-1,f=-1;for(let B=z-2;B>=0;B--){let G=this._computeIndentLevel(B);if(G>=0){m=B,f=G;break}}}if(g!==-1&&(g===-2||g<z-1)){g=-1,b=-1;for(let B=z;B<r;B++){let G=this._computeIndentLevel(B);if(G>=0){g=B,b=G;break}}}},C=0,x=!0,L=0,k=!0,O=0,W=0;for(let z=0;x||k;z++){let B=t-z,G=t+z;z>1&&(B<1||B<n)&&(x=!1),z>1&&(G>r||G>i)&&(k=!1),z>5e4&&(x=!1,k=!1);let q=-1;if(x&&B>=1){let ce=this._computeIndentLevel(B-1);ce>=0?(c=B-1,u=ce,q=Math.ceil(ce/this.textModel.getOptions().indentSize)):(h(B),q=this._getIndentLevelForWhitespaceLine(a,d,u))}let X=-1;if(k&&G<=r){let ce=this._computeIndentLevel(G-1);ce>=0?(m=G-1,f=ce,X=Math.ceil(ce/this.textModel.getOptions().indentSize)):(y(G),X=this._getIndentLevelForWhitespaceLine(a,f,b))}if(z===0){W=q;continue}if(z===1){if(G<=r&&X>=0&&W+1===X){x=!1,C=G,L=G,O=X;continue}if(B>=1&&q>=0&&q-1===W){k=!1,C=B,L=B,O=q;continue}if(C=t,L=t,O=W,O===0)return{startLineNumber:C,endLineNumber:L,indent:O}}x&&(q>=O?C=B:x=!1),k&&(X>=O?L=G:k=!1)}return{startLineNumber:C,endLineNumber:L,indent:O}}getLinesBracketGuides(t,n,i,r){let s=[];for(let h=t;h<=n;h++)s.push([]);let a=!0,l=this.textModel.bracketPairs.getBracketPairsInRangeWithMinIndentation(new D(t,1,n,this.textModel.getLineMaxColumn(n))).toArray(),d;if(i&&l.length>0){let h=(t<=i.lineNumber&&i.lineNumber<=n?l:this.textModel.bracketPairs.getBracketPairsInRange(D.fromPositions(i)).toArray()).filter(m=>D.strictContainsPosition(m.range,i));d=m1(h,m=>a||m.range.startLineNumber!==m.range.endLineNumber)?.range}let c=this.textModel.getOptions().bracketPairColorizationOptions.independentColorPoolPerBracketType,u=new eg;for(let h of l){if(!h.closingBracketRange)continue;let m=d&&h.range.equalsRange(d);if(!m&&!r.includeInactive)continue;let f=u.getInlineClassName(h.nestingLevel,h.nestingLevelOfEqualBracketType,c)+(r.highlightActive&&m?" "+u.activeClassName:""),g=h.openingBracketRange.getStartPosition(),b=h.closingBracketRange.getStartPosition(),y=r.horizontalGuides===2||r.horizontalGuides===1&&m;if(h.range.startLineNumber===h.range.endLineNumber){a&&y&&s[h.range.startLineNumber-t].push(new ar(-1,h.openingBracketRange.getEndPosition().column,f,new ua(!1,b.column),-1,-1));continue}let C=this.getVisibleColumnFromPosition(b),x=this.getVisibleColumnFromPosition(h.openingBracketRange.getStartPosition()),L=Math.min(x,C,h.minVisibleColumnIndentation+1),k=!1;Xt(this.textModel.getLineContent(h.closingBracketRange.startLineNumber))<h.closingBracketRange.startColumn-1&&(k=!0);let z=Math.max(g.lineNumber,t),B=Math.min(b.lineNumber,n),G=k?1:0;for(let q=z;q<B+G;q++)s[q-t].push(new ar(L,-1,f,null,q===g.lineNumber?g.column:-1,q===b.lineNumber?b.column:-1));y&&(g.lineNumber>=t&&x>L&&s[g.lineNumber-t].push(new ar(L,-1,f,new ua(!1,g.column),-1,-1)),b.lineNumber<=n&&C>L&&s[b.lineNumber-t].push(new ar(L,-1,f,new ua(!k,b.column),-1,-1)))}for(let h of s)h.sort((m,f)=>m.visibleColumn-f.visibleColumn);return s}getVisibleColumnFromPosition(t){return _t.visibleColumnFromColumn(this.textModel.getLineContent(t.lineNumber),t.column,this.textModel.getOptions().tabSize)+1}getLinesIndentGuides(t,n){this.assertNotDisposed();let i=this.textModel.getLineCount();if(t<1||t>i)throw new Error("Illegal value for startLineNumber");if(n<1||n>i)throw new Error("Illegal value for endLineNumber");let r=this.textModel.getOptions(),s=this.getLanguageConfiguration(this.textModel.getLanguageId()).foldingRules,a=!!(s&&s.offSide),l=new Array(n-t+1),d=-2,c=-1,u=-2,h=-1;for(let m=t;m<=n;m++){let f=m-t,g=this._computeIndentLevel(m-1);if(g>=0){d=m-1,c=g,l[f]=Math.ceil(g/r.indentSize);continue}if(d===-2){d=-1,c=-1;for(let b=m-2;b>=0;b--){let y=this._computeIndentLevel(b);if(y>=0){d=b,c=y;break}}}if(u!==-1&&(u===-2||u<m-1)){u=-1,h=-1;for(let b=m;b<i;b++){let y=this._computeIndentLevel(b);if(y>=0){u=b,h=y;break}}}l[f]=this._getIndentLevelForWhitespaceLine(a,c,h)}return l}_getIndentLevelForWhitespaceLine(t,n,i){let r=this.textModel.getOptions();return n===-1||i===-1?0:n<i?1+Math.floor(n/r.indentSize):n===i||t?Math.ceil(i/r.indentSize):1+Math.floor(i/r.indentSize)}},eg=class{activeClassName="indent-active";getInlineClassName(e,t,n){return this.getInlineClassNameOfLevel(n?t:e)}getInlineClassNameOfLevel(e){return`bracket-indent-guide lvl-${e%30}`}};var qT=class{spacesDiff=0;looksLikeAlignment=!1};function l4(o,e,t,n,i){i.spacesDiff=0,i.looksLikeAlignment=!1;let r;for(r=0;r<e&&r<n;r++){let h=o.charCodeAt(r),m=t.charCodeAt(r);if(h!==m)break}let s=0,a=0;for(let h=r;h<e;h++)o.charCodeAt(h)===32?s++:a++;let l=0,d=0;for(let h=r;h<n;h++)t.charCodeAt(h)===32?l++:d++;if(s>0&&a>0||l>0&&d>0)return;let c=Math.abs(a-d),u=Math.abs(s-l);if(c===0){i.spacesDiff=u,u>0&&0<=l-1&&l-1<o.length&&l<t.length&&t.charCodeAt(l)!==32&&o.charCodeAt(l-1)===32&&o.charCodeAt(o.length-1)===44&&(i.looksLikeAlignment=!0);return}if(u%c===0){i.spacesDiff=u/c;return}}function YT(o,e,t){let n=Math.min(o.getLineCount(),1e4),i=0,r=0,s="",a=0,l=[2,4,6,8,3,5,7],d=8,c=[0,0,0,0,0,0,0,0,0],u=new qT;for(let f=1;f<=n;f++){let g=o.getLineLength(f),b=o.getLineContent(f),y=g<=65536,C=!1,x=0,L=0,k=0;for(let W=0,z=g;W<z;W++){let B=y?b.charCodeAt(W):o.getLineCharCode(f,W);if(B===9)k++;else if(B===32)L++;else{C=!0,x=W;break}}if(!C||(k>0?i++:L>1&&r++,l4(s,a,b,x,u),u.looksLikeAlignment&&!(t&&e===u.spacesDiff)))continue;let O=u.spacesDiff;O<=d&&c[O]++,s=b,a=x}let h=t;i!==r&&(h=i<r);let m=e;if(h){let f=h?0:.1*n;l.forEach(g=>{let b=c[g];b>f&&(f=b,m=g)}),m===4&&c[4]>0&&c[2]>0&&c[2]>=c[4]/2&&(m=2)}return{insertSpaces:h,tabSize:m}}function zi(o){return(o.metadata&1)>>>0}function Tt(o,e){o.metadata=o.metadata&254|e<<0}function Gn(o){return(o.metadata&2)>>>1===1}function St(o,e){o.metadata=o.metadata&253|(e?1:0)<<1}function UN(o){return(o.metadata&4)>>>2===1}function NN(o,e){o.metadata=o.metadata&251|(e?1:0)<<2}function zN(o){return(o.metadata&64)>>>6===1}function PN(o,e){o.metadata=o.metadata&191|(e?1:0)<<6}function d4(o){return(o.metadata&24)>>>3}function FN(o,e){o.metadata=o.metadata&231|e<<3}function c4(o){return(o.metadata&32)>>>5===1}function BN(o,e){o.metadata=o.metadata&223|(e?1:0)<<5}var ig=class{metadata;parent;left;right;start;end;delta;maxEnd;id;ownerId;options;cachedVersionId;cachedAbsoluteStart;cachedAbsoluteEnd;range;constructor(e,t,n){this.metadata=0,this.parent=this,this.left=this,this.right=this,Tt(this,1),this.start=t,this.end=n,this.delta=0,this.maxEnd=n,this.id=e,this.ownerId=0,this.options=null,NN(this,!1),PN(this,!1),FN(this,1),BN(this,!1),this.cachedVersionId=0,this.cachedAbsoluteStart=t,this.cachedAbsoluteEnd=n,this.range=null,St(this,!1)}reset(e,t,n,i){this.start=t,this.end=n,this.maxEnd=n,this.cachedVersionId=e,this.cachedAbsoluteStart=t,this.cachedAbsoluteEnd=n,this.range=i}setOptions(e){this.options=e;let t=this.options.className;NN(this,t==="squiggly-error"||t==="squiggly-warning"||t==="squiggly-info"),PN(this,this.options.glyphMarginClassName!==null),FN(this,this.options.stickiness),BN(this,this.options.collapseOnReplaceEdit)}setCachedOffsets(e,t,n){this.cachedVersionId!==n&&(this.range=null),this.cachedVersionId=n,this.cachedAbsoluteStart=e,this.cachedAbsoluteEnd=t}detach(){this.parent=null,this.left=null,this.right=null}},ze=new ig(null,0,0);ze.parent=ze;ze.left=ze;ze.right=ze;Tt(ze,0);var Ju=class{root;requestNormalizeDelta;constructor(){this.root=ze,this.requestNormalizeDelta=!1}intervalSearch(e,t,n,i,r,s){return this.root===ze?[]:b4(this,e,t,n,i,r,s)}search(e,t,n,i){return this.root===ze?[]:VN(this,e,t,n,i)}collectNodesFromOwner(e){return g4(this,e)}collectNodesPostOrder(){return f4(this)}insert(e){WN(this,e),this._normalizeDeltaIfNecessary()}delete(e){HN(this,e),this._normalizeDeltaIfNecessary()}resolveNode(e,t){let n=e,i=0;for(;e!==this.root;)e===e.parent.right&&(i+=e.parent.delta),e=e.parent;let r=n.start+i,s=n.end+i;n.setCachedOffsets(r,s,t)}acceptReplace(e,t,n,i){let r=p4(this,e,e+t);for(let s=0,a=r.length;s<a;s++){let l=r[s];HN(this,l)}this._normalizeDeltaIfNecessary(),m4(this,e,e+t,n),this._normalizeDeltaIfNecessary();for(let s=0,a=r.length;s<a;s++){let l=r[s];l.start=l.cachedAbsoluteStart,l.end=l.cachedAbsoluteEnd,h4(l,e,e+t,n,i),l.maxEnd=l.end,WN(this,l)}this._normalizeDeltaIfNecessary()}getAllInOrder(){return VN(this,0,!1,0,!1)}_normalizeDeltaIfNecessary(){this.requestNormalizeDelta&&(this.requestNormalizeDelta=!1,u4(this))}};function u4(o){let e=o.root,t=0;for(;e!==ze;){if(e.left!==ze&&!Gn(e.left)){e=e.left;continue}if(e.right!==ze&&!Gn(e.right)){t+=e.delta,e=e.right;continue}e.start=t+e.start,e.end=t+e.end,e.delta=0,fa(e),St(e,!0),St(e.left,!1),St(e.right,!1),e===e.parent.right&&(t-=e.parent.delta),e=e.parent}St(o.root,!1)}function Qu(o,e,t,n){return o<t?!0:o>t||n===1?!1:n===2?!0:e}function h4(o,e,t,n,i){let r=d4(o),s=r===0||r===2,a=r===1||r===2,l=t-e,d=n,c=Math.min(l,d),u=o.start,h=!1,m=o.end,f=!1;e<=u&&m<=t&&c4(o)&&(o.start=e,h=!0,o.end=e,f=!0);{let b=i?1:l>0?2:0;!h&&Qu(u,s,e,b)&&(h=!0),!f&&Qu(m,a,e,b)&&(f=!0)}if(c>0&&!i){let b=l>d?2:0;!h&&Qu(u,s,e+c,b)&&(h=!0),!f&&Qu(m,a,e+c,b)&&(f=!0)}{let b=i?1:0;!h&&Qu(u,s,t,b)&&(o.start=e+d,h=!0),!f&&Qu(m,a,t,b)&&(o.end=e+d,f=!0)}let g=d-l;h||(o.start=Math.max(0,u+g)),f||(o.end=Math.max(0,m+g)),o.start>o.end&&(o.end=o.start)}function p4(o,e,t){let n=o.root,i=0,r=0,s=0,a=0,l=[],d=0;for(;n!==ze;){if(Gn(n)){St(n.left,!1),St(n.right,!1),n===n.parent.right&&(i-=n.parent.delta),n=n.parent;continue}if(!Gn(n.left)){if(r=i+n.maxEnd,r<e){St(n,!0);continue}if(n.left!==ze){n=n.left;continue}}if(s=i+n.start,s>t){St(n,!0);continue}if(a=i+n.end,a>=e&&(n.setCachedOffsets(s,a,0),l[d++]=n),St(n,!0),n.right!==ze&&!Gn(n.right)){i+=n.delta,n=n.right;continue}}return St(o.root,!1),l}function m4(o,e,t,n){let i=o.root,r=0,s=0,a=0,l=n-(t-e);for(;i!==ze;){if(Gn(i)){St(i.left,!1),St(i.right,!1),i===i.parent.right&&(r-=i.parent.delta),fa(i),i=i.parent;continue}if(!Gn(i.left)){if(s=r+i.maxEnd,s<e){St(i,!0);continue}if(i.left!==ze){i=i.left;continue}}if(a=r+i.start,a>t){i.start+=l,i.end+=l,i.delta+=l,(i.delta<-1073741824||i.delta>1073741824)&&(o.requestNormalizeDelta=!0),St(i,!0);continue}if(St(i,!0),i.right!==ze&&!Gn(i.right)){r+=i.delta,i=i.right;continue}}St(o.root,!1)}function g4(o,e){let t=o.root,n=[],i=0;for(;t!==ze;){if(Gn(t)){St(t.left,!1),St(t.right,!1),t=t.parent;continue}if(t.left!==ze&&!Gn(t.left)){t=t.left;continue}if(t.ownerId===e&&(n[i++]=t),St(t,!0),t.right!==ze&&!Gn(t.right)){t=t.right;continue}}return St(o.root,!1),n}function f4(o){let e=o.root,t=[],n=0;for(;e!==ze;){if(Gn(e)){St(e.left,!1),St(e.right,!1),e=e.parent;continue}if(e.left!==ze&&!Gn(e.left)){e=e.left;continue}if(e.right!==ze&&!Gn(e.right)){e=e.right;continue}t[n++]=e,St(e,!0)}return St(o.root,!1),t}function VN(o,e,t,n,i){let r=o.root,s=0,a=0,l=0,d=[],c=0;for(;r!==ze;){if(Gn(r)){St(r.left,!1),St(r.right,!1),r===r.parent.right&&(s-=r.parent.delta),r=r.parent;continue}if(r.left!==ze&&!Gn(r.left)){r=r.left;continue}a=s+r.start,l=s+r.end,r.setCachedOffsets(a,l,n);let u=!0;if(e&&r.ownerId&&r.ownerId!==e&&(u=!1),t&&UN(r)&&(u=!1),i&&!zN(r)&&(u=!1),u&&(d[c++]=r),St(r,!0),r.right!==ze&&!Gn(r.right)){s+=r.delta,r=r.right;continue}}return St(o.root,!1),d}function b4(o,e,t,n,i,r,s){let a=o.root,l=0,d=0,c=0,u=0,h=[],m=0;for(;a!==ze;){if(Gn(a)){St(a.left,!1),St(a.right,!1),a===a.parent.right&&(l-=a.parent.delta),a=a.parent;continue}if(!Gn(a.left)){if(d=l+a.maxEnd,d<e){St(a,!0);continue}if(a.left!==ze){a=a.left;continue}}if(c=l+a.start,c>t){St(a,!0);continue}if(u=l+a.end,u>=e){a.setCachedOffsets(c,u,r);let f=!0;n&&a.ownerId&&a.ownerId!==n&&(f=!1),i&&UN(a)&&(f=!1),s&&!zN(a)&&(f=!1),f&&(h[m++]=a)}if(St(a,!0),a.right!==ze&&!Gn(a.right)){l+=a.delta,a=a.right;continue}}return St(o.root,!1),h}function WN(o,e){if(o.root===ze)return e.parent=ze,e.left=ze,e.right=ze,Tt(e,0),o.root=e,o.root;v4(o,e),Tl(e.parent);let t=e;for(;t!==o.root&&zi(t.parent)===1;)if(t.parent===t.parent.parent.left){let n=t.parent.parent.right;zi(n)===1?(Tt(t.parent,0),Tt(n,0),Tt(t.parent.parent,1),t=t.parent.parent):(t===t.parent.right&&(t=t.parent,tg(o,t)),Tt(t.parent,0),Tt(t.parent.parent,1),ng(o,t.parent.parent))}else{let n=t.parent.parent.left;zi(n)===1?(Tt(t.parent,0),Tt(n,0),Tt(t.parent.parent,1),t=t.parent.parent):(t===t.parent.left&&(t=t.parent,ng(o,t)),Tt(t.parent,0),Tt(t.parent.parent,1),tg(o,t.parent.parent))}return Tt(o.root,0),e}function v4(o,e){let t=0,n=o.root,i=e.start,r=e.end;for(;;)if(I4(i,r,n.start+t,n.end+t)<0)if(n.left===ze){e.start-=t,e.end-=t,e.maxEnd-=t,n.left=e;break}else n=n.left;else if(n.right===ze){e.start-=t+n.delta,e.end-=t+n.delta,e.maxEnd-=t+n.delta,n.right=e;break}else t+=n.delta,n=n.right;e.parent=n,e.left=ze,e.right=ze,Tt(e,1)}function HN(o,e){let t,n;if(e.left===ze?(t=e.right,n=e,t.delta+=e.delta,(t.delta<-1073741824||t.delta>1073741824)&&(o.requestNormalizeDelta=!0),t.start+=e.delta,t.end+=e.delta):e.right===ze?(t=e.left,n=e):(n=y4(e.right),t=n.right,t.start+=n.delta,t.end+=n.delta,t.delta+=n.delta,(t.delta<-1073741824||t.delta>1073741824)&&(o.requestNormalizeDelta=!0),n.start+=e.delta,n.end+=e.delta,n.delta=e.delta,(n.delta<-1073741824||n.delta>1073741824)&&(o.requestNormalizeDelta=!0)),n===o.root){o.root=t,Tt(t,0),e.detach(),ZT(),fa(t),o.root.parent=ze;return}let i=zi(n)===1;if(n===n.parent.left?n.parent.left=t:n.parent.right=t,n===e?t.parent=n.parent:(n.parent===e?t.parent=n:t.parent=n.parent,n.left=e.left,n.right=e.right,n.parent=e.parent,Tt(n,zi(e)),e===o.root?o.root=n:e===e.parent.left?e.parent.left=n:e.parent.right=n,n.left!==ze&&(n.left.parent=n),n.right!==ze&&(n.right.parent=n)),e.detach(),i){Tl(t.parent),n!==e&&(Tl(n),Tl(n.parent)),ZT();return}Tl(t),Tl(t.parent),n!==e&&(Tl(n),Tl(n.parent));let r;for(;t!==o.root&&zi(t)===0;)t===t.parent.left?(r=t.parent.right,zi(r)===1&&(Tt(r,0),Tt(t.parent,1),tg(o,t.parent),r=t.parent.right),zi(r.left)===0&&zi(r.right)===0?(Tt(r,1),t=t.parent):(zi(r.right)===0&&(Tt(r.left,0),Tt(r,1),ng(o,r),r=t.parent.right),Tt(r,zi(t.parent)),Tt(t.parent,0),Tt(r.right,0),tg(o,t.parent),t=o.root)):(r=t.parent.left,zi(r)===1&&(Tt(r,0),Tt(t.parent,1),ng(o,t.parent),r=t.parent.left),zi(r.left)===0&&zi(r.right)===0?(Tt(r,1),t=t.parent):(zi(r.left)===0&&(Tt(r.right,0),Tt(r,1),tg(o,r),r=t.parent.left),Tt(r,zi(t.parent)),Tt(t.parent,0),Tt(r.left,0),ng(o,t.parent),t=o.root));Tt(t,0),ZT()}function y4(o){for(;o.left!==ze;)o=o.left;return o}function ZT(){ze.parent=ze,ze.delta=0,ze.start=0,ze.end=0}function tg(o,e){let t=e.right;t.delta+=e.delta,(t.delta<-1073741824||t.delta>1073741824)&&(o.requestNormalizeDelta=!0),t.start+=e.delta,t.end+=e.delta,e.right=t.left,t.left!==ze&&(t.left.parent=e),t.parent=e.parent,e.parent===ze?o.root=t:e===e.parent.left?e.parent.left=t:e.parent.right=t,t.left=e,e.parent=t,fa(e),fa(t)}function ng(o,e){let t=e.left;e.delta-=t.delta,(e.delta<-1073741824||e.delta>1073741824)&&(o.requestNormalizeDelta=!0),e.start-=t.delta,e.end-=t.delta,e.left=t.right,t.right!==ze&&(t.right.parent=e),t.parent=e.parent,e.parent===ze?o.root=t:e===e.parent.right?e.parent.right=t:e.parent.left=t,t.right=e,e.parent=t,fa(e),fa(t)}function KN(o){let e=o.end;if(o.left!==ze){let t=o.left.maxEnd;t>e&&(e=t)}if(o.right!==ze){let t=o.right.maxEnd+o.delta;t>e&&(e=t)}return e}function fa(o){o.maxEnd=KN(o)}function Tl(o){for(;o!==ze;){let e=KN(o);if(o.maxEnd===e)return;o.maxEnd=e,o=o.parent}}function I4(o,e,t,n){return o===t?e-n:o-t}var eh=class{parent;left;right;color;piece;size_left;lf_left;constructor(e,t){this.piece=e,this.color=t,this.size_left=0,this.lf_left=0,this.parent=this,this.left=this,this.right=this}next(){if(this.right!==Me)return Xy(this.right);let e=this;for(;e.parent!==Me&&e.parent.left!==e;)e=e.parent;return e.parent===Me?Me:e.parent}prev(){if(this.left!==Me)return QT(this.left);let e=this;for(;e.parent!==Me&&e.parent.right!==e;)e=e.parent;return e.parent===Me?Me:e.parent}detach(){this.parent=null,this.left=null,this.right=null}};var Me=new eh(null,0);Me.parent=Me;Me.left=Me;Me.right=Me;Me.color=0;function Xy(o){for(;o.left!==Me;)o=o.left;return o}function QT(o){for(;o.right!==Me;)o=o.right;return o}function JT(o){return o===Me?0:o.size_left+o.piece.length+JT(o.right)}function eL(o){return o===Me?0:o.lf_left+o.piece.lineFeedCnt+eL(o.right)}function XT(){Me.parent=Me}function rg(o,e){let t=e.right;t.size_left+=e.size_left+(e.piece?e.piece.length:0),t.lf_left+=e.lf_left+(e.piece?e.piece.lineFeedCnt:0),e.right=t.left,t.left!==Me&&(t.left.parent=e),t.parent=e.parent,e.parent===Me?o.root=t:e.parent.left===e?e.parent.left=t:e.parent.right=t,t.left=e,e.parent=t}function sg(o,e){let t=e.left;e.left=t.right,t.right!==Me&&(t.right.parent=e),t.parent=e.parent,e.size_left-=t.size_left+(t.piece?t.piece.length:0),e.lf_left-=t.lf_left+(t.piece?t.piece.lineFeedCnt:0),e.parent===Me?o.root=t:e===e.parent.right?e.parent.right=t:e.parent.left=t,t.right=e,e.parent=t}function ag(o,e){let t,n;if(e.left===Me?(n=e,t=n.right):e.right===Me?(n=e,t=n.left):(n=Xy(e.right),t=n.right),n===o.root){o.root=t,t.color=0,e.detach(),XT(),o.root.parent=Me;return}let i=n.color===1;if(n===n.parent.left?n.parent.left=t:n.parent.right=t,n===e?(t.parent=n.parent,og(o,t)):(n.parent===e?t.parent=n:t.parent=n.parent,og(o,t),n.left=e.left,n.right=e.right,n.parent=e.parent,n.color=e.color,e===o.root?o.root=n:e===e.parent.left?e.parent.left=n:e.parent.right=n,n.left!==Me&&(n.left.parent=n),n.right!==Me&&(n.right.parent=n),n.size_left=e.size_left,n.lf_left=e.lf_left,og(o,n)),e.detach(),t.parent.left===t){let s=JT(t),a=eL(t);if(s!==t.parent.size_left||a!==t.parent.lf_left){let l=s-t.parent.size_left,d=a-t.parent.lf_left;t.parent.size_left=s,t.parent.lf_left=a,Ds(o,t.parent,l,d)}}if(og(o,t.parent),i){XT();return}let r;for(;t!==o.root&&t.color===0;)t===t.parent.left?(r=t.parent.right,r.color===1&&(r.color=0,t.parent.color=1,rg(o,t.parent),r=t.parent.right),r.left.color===0&&r.right.color===0?(r.color=1,t=t.parent):(r.right.color===0&&(r.left.color=0,r.color=1,sg(o,r),r=t.parent.right),r.color=t.parent.color,t.parent.color=0,r.right.color=0,rg(o,t.parent),t=o.root)):(r=t.parent.left,r.color===1&&(r.color=0,t.parent.color=1,sg(o,t.parent),r=t.parent.left),r.left.color===0&&r.right.color===0?(r.color=1,t=t.parent):(r.left.color===0&&(r.right.color=0,r.color=1,rg(o,r),r=t.parent.left),r.color=t.parent.color,t.parent.color=0,r.left.color=0,sg(o,t.parent),t=o.root));t.color=0,XT()}function tL(o,e){for(og(o,e);e!==o.root&&e.parent.color===1;)if(e.parent===e.parent.parent.left){let t=e.parent.parent.right;t.color===1?(e.parent.color=0,t.color=0,e.parent.parent.color=1,e=e.parent.parent):(e===e.parent.right&&(e=e.parent,rg(o,e)),e.parent.color=0,e.parent.parent.color=1,sg(o,e.parent.parent))}else{let t=e.parent.parent.left;t.color===1?(e.parent.color=0,t.color=0,e.parent.parent.color=1,e=e.parent.parent):(e===e.parent.left&&(e=e.parent,sg(o,e)),e.parent.color=0,e.parent.parent.color=1,rg(o,e.parent.parent))}o.root.color=0}function Ds(o,e,t,n){for(;e!==o.root&&e!==Me;)e.parent.left===e&&(e.parent.size_left+=t,e.parent.lf_left+=n),e=e.parent}function og(o,e){let t=0,n=0;if(e!==o.root){for(;e!==o.root&&e===e.parent.right;)e=e.parent;if(e!==o.root)for(e=e.parent,t=JT(e.left)-e.size_left,n=eL(e.left)-e.lf_left,e.size_left+=t,e.lf_left+=n;e!==o.root&&(t!==0||n!==0);)e.parent.left===e&&(e.parent.size_left+=t,e.parent.lf_left+=n),e=e.parent}}var C4=999,ba=class{searchString;isRegex;matchCase;wordSeparators;constructor(e,t,n,i){this.searchString=e,this.isRegex=t,this.matchCase=n,this.wordSeparators=i}parseSearchRequest(){if(this.searchString==="")return null;let e;this.isRegex?e=S4(this.searchString):e=this.searchString.indexOf(`
`)>=0;let t=null;try{t=nb(this.searchString,this.isRegex,{matchCase:this.matchCase,wholeWord:!1,multiline:e,global:!0,unicode:!0})}catch{return null}if(!t)return null;let n=!this.isRegex&&!e;return n&&this.searchString.toLowerCase()!==this.searchString.toUpperCase()&&(n=this.matchCase),new $v(t,this.wordSeparators?Is(this.wordSeparators,[]):null,n?this.searchString:null)}};function S4(o){if(!o||o.length===0)return!1;for(let e=0,t=o.length;e<t;e++){let n=o.charCodeAt(e);if(n===10)return!0;if(n===92){if(e++,e>=t)break;let i=o.charCodeAt(e);if(i===110||i===114||i===87)return!0}}return!1}function Ll(o,e,t){if(!t)return new Il(o,null);let n=[];for(let i=0,r=e.length;i<r;i++)n[i]=e[i];return new Il(o,n)}var Qy=class{_lineFeedsOffsets;constructor(e){let t=[],n=0;for(let i=0,r=e.length;i<r;i++)e.charCodeAt(i)===10&&(t[n++]=i);this._lineFeedsOffsets=t}findLineFeedCountBeforeOffset(e){let t=this._lineFeedsOffsets,n=0,i=t.length-1;if(i===-1||e<=t[0])return 0;for(;n<i;){let r=n+((i-n)/2>>0);t[r]>=e?i=r-1:t[r+1]>=e?(n=r,i=r):n=r+1}return n+1}},$d=class{static findMatches(e,t,n,i,r){let s=t.parseSearchRequest();return s?s.regex.multiline?this._doFindMatchesMultiline(e,n,new Dl(s.wordSeparators,s.regex),i,r):this._doFindMatchesLineByLine(e,n,s,i,r):[]}static _getMultilineMatchRange(e,t,n,i,r,s){let a,l=0;i?(l=i.findLineFeedCountBeforeOffset(r),a=t+r+l):a=t+r;let d;if(i){let m=i.findLineFeedCountBeforeOffset(r+s.length)-l;d=a+s.length+m}else d=a+s.length;let c=e.getPositionAt(a),u=e.getPositionAt(d);return new D(c.lineNumber,c.column,u.lineNumber,u.column)}static _doFindMatchesMultiline(e,t,n,i,r){let s=e.getOffsetAt(t.getStartPosition()),a=e.getValueInRange(t,1),l=e.getEOL()===`\r
`?new Qy(a):null,d=[],c=0,u;for(n.reset(0);u=n.next(a);)if(d[c++]=Ll(this._getMultilineMatchRange(e,s,a,l,u.index,u[0]),u,i),c>=r)return d;return d}static _doFindMatchesLineByLine(e,t,n,i,r){let s=[],a=0;if(t.startLineNumber===t.endLineNumber){let d=e.getLineContent(t.startLineNumber).substring(t.startColumn-1,t.endColumn-1);return a=this._findMatchesInLine(n,d,t.startLineNumber,t.startColumn-1,a,s,i,r),s}let l=e.getLineContent(t.startLineNumber).substring(t.startColumn-1);a=this._findMatchesInLine(n,l,t.startLineNumber,t.startColumn-1,a,s,i,r);for(let d=t.startLineNumber+1;d<t.endLineNumber&&a<r;d++)a=this._findMatchesInLine(n,e.getLineContent(d),d,0,a,s,i,r);if(a<r){let d=e.getLineContent(t.endLineNumber).substring(0,t.endColumn-1);a=this._findMatchesInLine(n,d,t.endLineNumber,0,a,s,i,r)}return s}static _findMatchesInLine(e,t,n,i,r,s,a,l){let d=e.wordSeparators;if(!a&&e.simpleSearch){let h=e.simpleSearch,m=h.length,f=t.length,g=-m;for(;(g=t.indexOf(h,g+m))!==-1;)if((!d||Jy(d,t,f,g,m))&&(s[r++]=new Il(new D(n,g+1+i,n,g+1+m+i),null),r>=l))return r;return r}let c=new Dl(e.wordSeparators,e.regex),u;c.reset(0);do if(u=c.next(t),u&&(s[r++]=Ll(new D(n,u.index+1+i,n,u.index+1+u[0].length+i),u,a),r>=l))return r;while(u);return r}static findNextMatch(e,t,n,i){let r=t.parseSearchRequest();if(!r)return null;let s=new Dl(r.wordSeparators,r.regex);return r.regex.multiline?this._doFindNextMatchMultiline(e,n,s,i):this._doFindNextMatchLineByLine(e,n,s,i)}static _doFindNextMatchMultiline(e,t,n,i){let r=new P(t.lineNumber,1),s=e.getOffsetAt(r),a=e.getLineCount(),l=e.getValueInRange(new D(r.lineNumber,r.column,a,e.getLineMaxColumn(a)),1),d=e.getEOL()===`\r
`?new Qy(l):null;n.reset(t.column-1);let c=n.next(l);return c?Ll(this._getMultilineMatchRange(e,s,l,d,c.index,c[0]),c,i):t.lineNumber!==1||t.column!==1?this._doFindNextMatchMultiline(e,new P(1,1),n,i):null}static _doFindNextMatchLineByLine(e,t,n,i){let r=e.getLineCount(),s=t.lineNumber,a=e.getLineContent(s),l=this._findFirstMatchInLine(n,a,s,t.column,i);if(l)return l;for(let d=1;d<=r;d++){let c=(s+d-1)%r,u=e.getLineContent(c+1),h=this._findFirstMatchInLine(n,u,c+1,1,i);if(h)return h}return null}static _findFirstMatchInLine(e,t,n,i,r){e.reset(i-1);let s=e.next(t);return s?Ll(new D(n,s.index+1,n,s.index+1+s[0].length),s,r):null}static findPreviousMatch(e,t,n,i){let r=t.parseSearchRequest();if(!r)return null;let s=new Dl(r.wordSeparators,r.regex);return r.regex.multiline?this._doFindPreviousMatchMultiline(e,n,s,i):this._doFindPreviousMatchLineByLine(e,n,s,i)}static _doFindPreviousMatchMultiline(e,t,n,i){let r=this._doFindMatchesMultiline(e,new D(1,1,t.lineNumber,t.column),n,i,10*C4);if(r.length>0)return r[r.length-1];let s=e.getLineCount();return t.lineNumber!==s||t.column!==e.getLineMaxColumn(s)?this._doFindPreviousMatchMultiline(e,new P(s,e.getLineMaxColumn(s)),n,i):null}static _doFindPreviousMatchLineByLine(e,t,n,i){let r=e.getLineCount(),s=t.lineNumber,a=e.getLineContent(s).substring(0,t.column-1),l=this._findLastMatchInLine(n,a,s,i);if(l)return l;for(let d=1;d<=r;d++){let c=(r+s-d-1)%r,u=e.getLineContent(c+1),h=this._findLastMatchInLine(n,u,c+1,i);if(h)return h}return null}static _findLastMatchInLine(e,t,n,i){let r=null,s;for(e.reset(0);s=e.next(t);)r=Ll(new D(n,s.index+1,n,s.index+1+s[0].length),s,i);return r}};function w4(o,e,t,n,i){if(n===0)return!0;let r=e.charCodeAt(n-1);if(o.get(r)!==0||r===13||r===10)return!0;if(i>0){let s=e.charCodeAt(n);if(o.get(s)!==0)return!0}return!1}function x4(o,e,t,n,i){if(n+i===t)return!0;let r=e.charCodeAt(n+i);if(o.get(r)!==0||r===13||r===10)return!0;if(i>0){let s=e.charCodeAt(n+i-1);if(o.get(s)!==0)return!0}return!1}function Jy(o,e,t,n,i){return w4(o,e,t,n,i)&&x4(o,e,t,n,i)}var Dl=class{_wordSeparators;_searchRegex;_prevMatchStartIndex;_prevMatchLength;constructor(e,t){this._wordSeparators=e,this._searchRegex=t,this._prevMatchStartIndex=-1,this._prevMatchLength=0}reset(e){this._searchRegex.lastIndex=e,this._prevMatchStartIndex=-1,this._prevMatchLength=0}next(e){let t=e.length,n;do{if(this._prevMatchStartIndex+this._prevMatchLength===t||(n=this._searchRegex.exec(e),!n))return null;let i=n.index,r=n[0].length;if(i===this._prevMatchStartIndex&&r===this._prevMatchLength){if(r===0){qc(e,t,this._searchRegex.lastIndex)>65535?this._searchRegex.lastIndex+=2:this._searchRegex.lastIndex+=1;continue}return null}if(this._prevMatchStartIndex=i,this._prevMatchLength=r,!this._wordSeparators||Jy(this._wordSeparators,e,t,i,r))return n}while(n);return null}};var va=65535;function GN(o){let e;return o[o.length-1]<65536?e=new Uint16Array(o.length):e=new Uint32Array(o.length),e.set(o,0),e}var iL=class{constructor(e,t,n,i,r){this.lineStarts=e;this.cr=t;this.lf=n;this.crlf=i;this.isBasicASCII=r}};function ks(o,e=!0){let t=[0],n=1;for(let i=0,r=o.length;i<r;i++){let s=o.charCodeAt(i);s===13?i+1<r&&o.charCodeAt(i+1)===10?(t[n++]=i+2,i++):t[n++]=i+1:s===10&&(t[n++]=i+1)}return e?GN(t):t}function jN(o,e){o.length=0,o[0]=0;let t=1,n=0,i=0,r=0,s=!0;for(let l=0,d=e.length;l<d;l++){let c=e.charCodeAt(l);c===13?l+1<d&&e.charCodeAt(l+1)===10?(r++,o[t++]=l+2,l++):(n++,o[t++]=l+1):c===10?(i++,o[t++]=l+1):s&&c!==9&&(c<32||c>126)&&(s=!1)}let a=new iL(GN(o),n,i,r,s);return o.length=0,a}var Di=class{bufferIndex;start;end;length;lineFeedCnt;constructor(e,t,n,i,r){this.bufferIndex=e,this.start=t,this.end=n,this.lineFeedCnt=i,this.length=r}},Rs=class{buffer;lineStarts;constructor(e,t){this.buffer=e,this.lineStarts=t}},oL=class{_pieces;_index;_tree;_BOM;constructor(e,t){this._pieces=[],this._tree=e,this._BOM=t,this._index=0,e.root!==Me&&e.iterate(e.root,n=>(n!==Me&&this._pieces.push(n.piece),!0))}read(){return this._pieces.length===0?this._index===0?(this._index++,this._BOM):null:this._index>this._pieces.length-1?null:this._index===0?this._BOM+this._tree.getPieceContent(this._pieces[this._index++]):this._tree.getPieceContent(this._pieces[this._index++])}},rL=class{_limit;_cache;constructor(e){this._limit=e,this._cache=[]}get(e){for(let t=this._cache.length-1;t>=0;t--){let n=this._cache[t];if(n.nodeStartOffset<=e&&n.nodeStartOffset+n.node.piece.length>=e)return n}return null}get2(e){for(let t=this._cache.length-1;t>=0;t--){let n=this._cache[t];if(n.nodeStartLineNumber&&n.nodeStartLineNumber<e&&n.nodeStartLineNumber+n.node.piece.lineFeedCnt>=e)return n}return null}set(e){this._cache.length>=this._limit&&this._cache.shift(),this._cache.push(e)}validate(e){let t=!1,n=this._cache;for(let i=0;i<n.length;i++){let r=n[i];if(r.node.parent===null||r.nodeStartOffset>=e){n[i]=null,t=!0;continue}}if(t){let i=[];for(let r of n)r!==null&&i.push(r);this._cache=i}}},eI=class{root;_buffers;_lineCnt;_length;_EOL;_EOLLength;_EOLNormalized;_lastChangeBufferPos;_searchCache;_lastVisitedLine;constructor(e,t,n){this.create(e,t,n)}create(e,t,n){this._buffers=[new Rs("",[0])],this._lastChangeBufferPos={line:0,column:0},this.root=Me,this._lineCnt=1,this._length=0,this._EOL=t,this._EOLLength=t.length,this._EOLNormalized=n;let i=null;for(let r=0,s=e.length;r<s;r++)if(e[r].buffer.length>0){e[r].lineStarts||(e[r].lineStarts=ks(e[r].buffer));let a=new Di(r+1,{line:0,column:0},{line:e[r].lineStarts.length-1,column:e[r].buffer.length-e[r].lineStarts[e[r].lineStarts.length-1]},e[r].lineStarts.length-1,e[r].buffer.length);this._buffers.push(e[r]),i=this.rbInsertRight(i,a)}this._searchCache=new rL(1),this._lastVisitedLine={lineNumber:0,value:""},this.computeBufferMetadata()}normalizeEOL(e){let t=va,n=t-Math.floor(t/3),i=n*2,r="",s=0,a=[];if(this.iterate(this.root,l=>{let d=this.getNodeContent(l),c=d.length;if(s<=n||s+c<i)return r+=d,s+=c,!0;let u=r.replace(/\r\n|\r|\n/g,e);return a.push(new Rs(u,ks(u))),r=d,s=c,!0}),s>0){let l=r.replace(/\r\n|\r|\n/g,e);a.push(new Rs(l,ks(l)))}this.create(a,e,!0)}getEOL(){return this._EOL}setEOL(e){this._EOL=e,this._EOLLength=this._EOL.length,this.normalizeEOL(e)}createSnapshot(e){return new oL(this,e)}equal(e){if(this.getLength()!==e.getLength()||this.getLineCount()!==e.getLineCount())return!1;let t=0;return this.iterate(this.root,i=>{if(i===Me)return!0;let r=this.getNodeContent(i),s=r.length,a=e.nodeAt(t),l=e.nodeAt(t+s),d=e.getValueInRange2(a,l);return t+=s,r===d})}getOffsetAt(e,t){let n=0,i=this.root;for(;i!==Me;)if(i.left!==Me&&i.lf_left+1>=e)i=i.left;else if(i.lf_left+i.piece.lineFeedCnt+1>=e){n+=i.size_left;let r=this.getAccumulatedValue(i,e-i.lf_left-2);return n+=r+t-1}else e-=i.lf_left+i.piece.lineFeedCnt,n+=i.size_left+i.piece.length,i=i.right;return n}getPositionAt(e){e=Math.floor(e),e=Math.max(0,e);let t=this.root,n=0,i=e;for(;t!==Me;)if(t.size_left!==0&&t.size_left>=e)t=t.left;else if(t.size_left+t.piece.length>=e){let r=this.getIndexOf(t,e-t.size_left);if(n+=t.lf_left+r.index,r.index===0){let s=this.getOffsetAt(n+1,1),a=i-s;return new P(n+1,a+1)}return new P(n+1,r.remainder+1)}else if(e-=t.size_left+t.piece.length,n+=t.lf_left+t.piece.lineFeedCnt,t.right===Me){let r=this.getOffsetAt(n+1,1),s=i-e-r;return new P(n+1,s+1)}else t=t.right;return new P(1,1)}getValueInRange(e,t){if(e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn)return"";let n=this.nodeAt2(e.startLineNumber,e.startColumn),i=this.nodeAt2(e.endLineNumber,e.endColumn),r=this.getValueInRange2(n,i);return t?t!==this._EOL||!this._EOLNormalized?r.replace(/\r\n|\r|\n/g,t):t===this.getEOL()&&this._EOLNormalized?r:r.replace(/\r\n|\r|\n/g,t):r}getValueInRange2(e,t){if(e.node===t.node){let a=e.node,l=this._buffers[a.piece.bufferIndex].buffer,d=this.offsetInBuffer(a.piece.bufferIndex,a.piece.start);return l.substring(d+e.remainder,d+t.remainder)}let n=e.node,i=this._buffers[n.piece.bufferIndex].buffer,r=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start),s=i.substring(r+e.remainder,r+n.piece.length);for(n=n.next();n!==Me;){let a=this._buffers[n.piece.bufferIndex].buffer,l=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);if(n===t.node){s+=a.substring(l,l+t.remainder);break}else s+=a.substr(l,n.piece.length);n=n.next()}return s}getLinesContent(){let e=[],t=0,n="",i=!1;return this.iterate(this.root,r=>{if(r===Me)return!0;let s=r.piece,a=s.length;if(a===0)return!0;let l=this._buffers[s.bufferIndex].buffer,d=this._buffers[s.bufferIndex].lineStarts,c=s.start.line,u=s.end.line,h=d[c]+s.start.column;if(i&&(l.charCodeAt(h)===10&&(h++,a--),e[t++]=n,n="",i=!1,a===0))return!0;if(c===u)return!this._EOLNormalized&&l.charCodeAt(h+a-1)===13?(i=!0,n+=l.substr(h,a-1)):n+=l.substr(h,a),!0;n+=this._EOLNormalized?l.substring(h,Math.max(h,d[c+1]-this._EOLLength)):l.substring(h,d[c+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=n;for(let m=c+1;m<u;m++)n=this._EOLNormalized?l.substring(d[m],d[m+1]-this._EOLLength):l.substring(d[m],d[m+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=n;return!this._EOLNormalized&&l.charCodeAt(d[u]+s.end.column-1)===13?(i=!0,s.end.column===0?t--:n=l.substr(d[u],s.end.column-1)):n=l.substr(d[u],s.end.column),!0}),i&&(e[t++]=n,n=""),e[t++]=n,e}getLength(){return this._length}getLineCount(){return this._lineCnt}getLineContent(e){return this._lastVisitedLine.lineNumber===e?this._lastVisitedLine.value:(this._lastVisitedLine.lineNumber=e,e===this._lineCnt?this._lastVisitedLine.value=this.getLineRawContent(e):this._EOLNormalized?this._lastVisitedLine.value=this.getLineRawContent(e,this._EOLLength):this._lastVisitedLine.value=this.getLineRawContent(e).replace(/(\r\n|\r|\n)$/,""),this._lastVisitedLine.value)}_getCharCode(e){if(e.remainder===e.node.piece.length){let t=e.node.next();if(!t)return 0;let n=this._buffers[t.piece.bufferIndex],i=this.offsetInBuffer(t.piece.bufferIndex,t.piece.start);return n.buffer.charCodeAt(i)}else{let t=this._buffers[e.node.piece.bufferIndex],i=this.offsetInBuffer(e.node.piece.bufferIndex,e.node.piece.start)+e.remainder;return t.buffer.charCodeAt(i)}}getLineCharCode(e,t){let n=this.nodeAt2(e,t+1);return this._getCharCode(n)}getLineLength(e){if(e===this.getLineCount()){let t=this.getOffsetAt(e,1);return this.getLength()-t}return this.getOffsetAt(e+1,1)-this.getOffsetAt(e,1)-this._EOLLength}getCharCode(e){let t=this.nodeAt(e);return this._getCharCode(t)}getNearestChunk(e){let t=this.nodeAt(e);if(t.remainder===t.node.piece.length){let n=t.node.next();if(!n||n===Me)return"";let i=this._buffers[n.piece.bufferIndex],r=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);return i.buffer.substring(r,r+n.piece.length)}else{let n=this._buffers[t.node.piece.bufferIndex],i=this.offsetInBuffer(t.node.piece.bufferIndex,t.node.piece.start),r=i+t.remainder,s=i+t.node.piece.length;return n.buffer.substring(r,s)}}findMatchesInNode(e,t,n,i,r,s,a,l,d,c,u){let h=this._buffers[e.piece.bufferIndex],m=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start),f=this.offsetInBuffer(e.piece.bufferIndex,r),g=this.offsetInBuffer(e.piece.bufferIndex,s),b,y={line:0,column:0},C,x;t._wordSeparators?(C=h.buffer.substring(f,g),x=L=>L+f,t.reset(0)):(C=h.buffer,x=L=>L,t.reset(f));do if(b=t.next(C),b){if(x(b.index)>=g)return c;this.positionInBuffer(e,x(b.index)-m,y);let L=this.getLineFeedCnt(e.piece.bufferIndex,r,y),k=y.line===r.line?y.column-r.column+i:y.column+1,O=k+b[0].length;if(u[c++]=Ll(new D(n+L,k,n+L,O),b,l),x(b.index)+b[0].length>=g||c>=d)return c}while(b);return c}findMatchesLineByLine(e,t,n,i){let r=[],s=0,a=new Dl(t.wordSeparators,t.regex),l=this.nodeAt2(e.startLineNumber,e.startColumn);if(l===null)return[];let d=this.nodeAt2(e.endLineNumber,e.endColumn);if(d===null)return[];let c=this.positionInBuffer(l.node,l.remainder),u=this.positionInBuffer(d.node,d.remainder);if(l.node===d.node)return this.findMatchesInNode(l.node,a,e.startLineNumber,e.startColumn,c,u,t,n,i,s,r),r;let h=e.startLineNumber,m=l.node;for(;m!==d.node;){let g=this.getLineFeedCnt(m.piece.bufferIndex,c,m.piece.end);if(g>=1){let y=this._buffers[m.piece.bufferIndex].lineStarts,C=this.offsetInBuffer(m.piece.bufferIndex,m.piece.start),x=y[c.line+g],L=h===e.startLineNumber?e.startColumn:1;if(s=this.findMatchesInNode(m,a,h,L,c,this.positionInBuffer(m,x-C),t,n,i,s,r),s>=i)return r;h+=g}let b=h===e.startLineNumber?e.startColumn-1:0;if(h===e.endLineNumber){let y=this.getLineContent(h).substring(b,e.endColumn-1);return s=this._findMatchesInLine(t,a,y,e.endLineNumber,b,s,r,n,i),r}if(s=this._findMatchesInLine(t,a,this.getLineContent(h).substr(b),h,b,s,r,n,i),s>=i)return r;h++,l=this.nodeAt2(h,1),m=l.node,c=this.positionInBuffer(l.node,l.remainder)}if(h===e.endLineNumber){let g=h===e.startLineNumber?e.startColumn-1:0,b=this.getLineContent(h).substring(g,e.endColumn-1);return s=this._findMatchesInLine(t,a,b,e.endLineNumber,g,s,r,n,i),r}let f=h===e.startLineNumber?e.startColumn:1;return s=this.findMatchesInNode(d.node,a,h,f,c,u,t,n,i,s,r),r}_findMatchesInLine(e,t,n,i,r,s,a,l,d){let c=e.wordSeparators;if(!l&&e.simpleSearch){let h=e.simpleSearch,m=h.length,f=n.length,g=-m;for(;(g=n.indexOf(h,g+m))!==-1;)if((!c||Jy(c,n,f,g,m))&&(a[s++]=new Il(new D(i,g+1+r,i,g+1+m+r),null),s>=d))return s;return s}let u;t.reset(0);do if(u=t.next(n),u&&(a[s++]=Ll(new D(i,u.index+1+r,i,u.index+1+u[0].length+r),u,l),s>=d))return s;while(u);return s}insert(e,t,n=!1){if(this._EOLNormalized=this._EOLNormalized&&n,this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",this.root!==Me){let{node:i,remainder:r,nodeStartOffset:s}=this.nodeAt(e),a=i.piece,l=a.bufferIndex,d=this.positionInBuffer(i,r);if(i.piece.bufferIndex===0&&a.end.line===this._lastChangeBufferPos.line&&a.end.column===this._lastChangeBufferPos.column&&s+a.length===e&&t.length<va){this.appendToNode(i,t),this.computeBufferMetadata();return}if(s===e)this.insertContentToNodeLeft(t,i),this._searchCache.validate(e);else if(s+i.piece.length>e){let c=[],u=new Di(a.bufferIndex,d,a.end,this.getLineFeedCnt(a.bufferIndex,d,a.end),this.offsetInBuffer(l,a.end)-this.offsetInBuffer(l,d));if(this.shouldCheckCRLF()&&this.endWithCR(t)&&this.nodeCharCodeAt(i,r)===10){let g={line:u.start.line+1,column:0};u=new Di(u.bufferIndex,g,u.end,this.getLineFeedCnt(u.bufferIndex,g,u.end),u.length-1),t+=`
`}if(this.shouldCheckCRLF()&&this.startWithLF(t))if(this.nodeCharCodeAt(i,r-1)===13){let g=this.positionInBuffer(i,r-1);this.deleteNodeTail(i,g),t="\r"+t,i.piece.length===0&&c.push(i)}else this.deleteNodeTail(i,d);else this.deleteNodeTail(i,d);let h=this.createNewPieces(t);u.length>0&&this.rbInsertRight(i,u);let m=i;for(let f=0;f<h.length;f++)m=this.rbInsertRight(m,h[f]);this.deleteNodes(c)}else this.insertContentToNodeRight(t,i)}else{let i=this.createNewPieces(t),r=this.rbInsertLeft(null,i[0]);for(let s=1;s<i.length;s++)r=this.rbInsertRight(r,i[s])}this.computeBufferMetadata()}delete(e,t){if(this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",t<=0||this.root===Me)return;let n=this.nodeAt(e),i=this.nodeAt(e+t),r=n.node,s=i.node;if(r===s){let h=this.positionInBuffer(r,n.remainder),m=this.positionInBuffer(r,i.remainder);if(n.nodeStartOffset===e){if(t===r.piece.length){let f=r.next();ag(this,r),this.validateCRLFWithPrevNode(f),this.computeBufferMetadata();return}this.deleteNodeHead(r,m),this._searchCache.validate(e),this.validateCRLFWithPrevNode(r),this.computeBufferMetadata();return}if(n.nodeStartOffset+r.piece.length===e+t){this.deleteNodeTail(r,h),this.validateCRLFWithNextNode(r),this.computeBufferMetadata();return}this.shrinkNode(r,h,m),this.computeBufferMetadata();return}let a=[],l=this.positionInBuffer(r,n.remainder);this.deleteNodeTail(r,l),this._searchCache.validate(e),r.piece.length===0&&a.push(r);let d=this.positionInBuffer(s,i.remainder);this.deleteNodeHead(s,d),s.piece.length===0&&a.push(s);let c=r.next();for(let h=c;h!==Me&&h!==s;h=h.next())a.push(h);let u=r.piece.length===0?r.prev():r;this.deleteNodes(a),this.validateCRLFWithNextNode(u),this.computeBufferMetadata()}insertContentToNodeLeft(e,t){let n=[];if(this.shouldCheckCRLF()&&this.endWithCR(e)&&this.startWithLF(t)){let s=t.piece,a={line:s.start.line+1,column:0},l=new Di(s.bufferIndex,a,s.end,this.getLineFeedCnt(s.bufferIndex,a,s.end),s.length-1);t.piece=l,e+=`
`,Ds(this,t,-1,-1),t.piece.length===0&&n.push(t)}let i=this.createNewPieces(e),r=this.rbInsertLeft(t,i[i.length-1]);for(let s=i.length-2;s>=0;s--)r=this.rbInsertLeft(r,i[s]);this.validateCRLFWithPrevNode(r),this.deleteNodes(n)}insertContentToNodeRight(e,t){this.adjustCarriageReturnFromNext(e,t)&&(e+=`
`);let n=this.createNewPieces(e),i=this.rbInsertRight(t,n[0]),r=i;for(let s=1;s<n.length;s++)r=this.rbInsertRight(r,n[s]);this.validateCRLFWithPrevNode(i)}positionInBuffer(e,t,n){let i=e.piece,r=e.piece.bufferIndex,s=this._buffers[r].lineStarts,l=s[i.start.line]+i.start.column+t,d=i.start.line,c=i.end.line,u=0,h=0,m=0;for(;d<=c&&(u=d+(c-d)/2|0,m=s[u],u!==c);)if(h=s[u+1],l<m)c=u-1;else if(l>=h)d=u+1;else break;return n?(n.line=u,n.column=l-m,null):{line:u,column:l-m}}getLineFeedCnt(e,t,n){if(n.column===0)return n.line-t.line;let i=this._buffers[e].lineStarts;if(n.line===i.length-1)return n.line-t.line;let r=i[n.line+1],s=i[n.line]+n.column;if(r>s+1)return n.line-t.line;let a=s-1;return this._buffers[e].buffer.charCodeAt(a)===13?n.line-t.line+1:n.line-t.line}offsetInBuffer(e,t){return this._buffers[e].lineStarts[t.line]+t.column}deleteNodes(e){for(let t=0;t<e.length;t++)ag(this,e[t])}createNewPieces(e){if(e.length>va){let c=[];for(;e.length>va;){let h=e.charCodeAt(va-1),m;h===13||h>=55296&&h<=56319?(m=e.substring(0,va-1),e=e.substring(va-1)):(m=e.substring(0,va),e=e.substring(va));let f=ks(m);c.push(new Di(this._buffers.length,{line:0,column:0},{line:f.length-1,column:m.length-f[f.length-1]},f.length-1,m.length)),this._buffers.push(new Rs(m,f))}let u=ks(e);return c.push(new Di(this._buffers.length,{line:0,column:0},{line:u.length-1,column:e.length-u[u.length-1]},u.length-1,e.length)),this._buffers.push(new Rs(e,u)),c}let t=this._buffers[0].buffer.length,n=ks(e,!1),i=this._lastChangeBufferPos;if(this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-1]===t&&t!==0&&this.startWithLF(e)&&this.endWithCR(this._buffers[0].buffer)){this._lastChangeBufferPos={line:this._lastChangeBufferPos.line,column:this._lastChangeBufferPos.column+1},i=this._lastChangeBufferPos;for(let c=0;c<n.length;c++)n[c]+=t+1;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(n.slice(1)),this._buffers[0].buffer+="_"+e,t+=1}else{if(t!==0)for(let c=0;c<n.length;c++)n[c]+=t;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(n.slice(1)),this._buffers[0].buffer+=e}let r=this._buffers[0].buffer.length,s=this._buffers[0].lineStarts.length-1,a=r-this._buffers[0].lineStarts[s],l={line:s,column:a},d=new Di(0,i,l,this.getLineFeedCnt(0,i,l),r-t);return this._lastChangeBufferPos=l,[d]}getLinesRawContent(){return this.getContentOfSubTree(this.root)}getLineRawContent(e,t=0){let n=this.root,i="",r=this._searchCache.get2(e);if(r){n=r.node;let s=this.getAccumulatedValue(n,e-r.nodeStartLineNumber-1),a=this._buffers[n.piece.bufferIndex].buffer,l=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);if(r.nodeStartLineNumber+n.piece.lineFeedCnt===e)i=a.substring(l+s,l+n.piece.length);else{let d=this.getAccumulatedValue(n,e-r.nodeStartLineNumber);return a.substring(l+s,l+d-t)}}else{let s=0,a=e;for(;n!==Me;)if(n.left!==Me&&n.lf_left>=e-1)n=n.left;else if(n.lf_left+n.piece.lineFeedCnt>e-1){let l=this.getAccumulatedValue(n,e-n.lf_left-2),d=this.getAccumulatedValue(n,e-n.lf_left-1),c=this._buffers[n.piece.bufferIndex].buffer,u=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);return s+=n.size_left,this._searchCache.set({node:n,nodeStartOffset:s,nodeStartLineNumber:a-(e-1-n.lf_left)}),c.substring(u+l,u+d-t)}else if(n.lf_left+n.piece.lineFeedCnt===e-1){let l=this.getAccumulatedValue(n,e-n.lf_left-2),d=this._buffers[n.piece.bufferIndex].buffer,c=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);i=d.substring(c+l,c+n.piece.length);break}else e-=n.lf_left+n.piece.lineFeedCnt,s+=n.size_left+n.piece.length,n=n.right}for(n=n.next();n!==Me;){let s=this._buffers[n.piece.bufferIndex].buffer;if(n.piece.lineFeedCnt>0){let a=this.getAccumulatedValue(n,0),l=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);return i+=s.substring(l,l+a-t),i}else{let a=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);i+=s.substr(a,n.piece.length)}n=n.next()}return i}computeBufferMetadata(){let e=this.root,t=1,n=0;for(;e!==Me;)t+=e.lf_left+e.piece.lineFeedCnt,n+=e.size_left+e.piece.length,e=e.right;this._lineCnt=t,this._length=n,this._searchCache.validate(this._length)}getIndexOf(e,t){let n=e.piece,i=this.positionInBuffer(e,t),r=i.line-n.start.line;if(this.offsetInBuffer(n.bufferIndex,n.end)-this.offsetInBuffer(n.bufferIndex,n.start)===t){let s=this.getLineFeedCnt(e.piece.bufferIndex,n.start,i);if(s!==r)return{index:s,remainder:0}}return{index:r,remainder:i.column}}getAccumulatedValue(e,t){if(t<0)return 0;let n=e.piece,i=this._buffers[n.bufferIndex].lineStarts,r=n.start.line+t+1;return r>n.end.line?i[n.end.line]+n.end.column-i[n.start.line]-n.start.column:i[r]-i[n.start.line]-n.start.column}deleteNodeTail(e,t){let n=e.piece,i=n.lineFeedCnt,r=this.offsetInBuffer(n.bufferIndex,n.end),s=t,a=this.offsetInBuffer(n.bufferIndex,s),l=this.getLineFeedCnt(n.bufferIndex,n.start,s),d=l-i,c=a-r,u=n.length+c;e.piece=new Di(n.bufferIndex,n.start,s,l,u),Ds(this,e,c,d)}deleteNodeHead(e,t){let n=e.piece,i=n.lineFeedCnt,r=this.offsetInBuffer(n.bufferIndex,n.start),s=t,a=this.getLineFeedCnt(n.bufferIndex,s,n.end),l=this.offsetInBuffer(n.bufferIndex,s),d=a-i,c=r-l,u=n.length+c;e.piece=new Di(n.bufferIndex,s,n.end,a,u),Ds(this,e,c,d)}shrinkNode(e,t,n){let i=e.piece,r=i.start,s=i.end,a=i.length,l=i.lineFeedCnt,d=t,c=this.getLineFeedCnt(i.bufferIndex,i.start,d),u=this.offsetInBuffer(i.bufferIndex,t)-this.offsetInBuffer(i.bufferIndex,r);e.piece=new Di(i.bufferIndex,i.start,d,c,u),Ds(this,e,u-a,c-l);let h=new Di(i.bufferIndex,n,s,this.getLineFeedCnt(i.bufferIndex,n,s),this.offsetInBuffer(i.bufferIndex,s)-this.offsetInBuffer(i.bufferIndex,n)),m=this.rbInsertRight(e,h);this.validateCRLFWithPrevNode(m)}appendToNode(e,t){this.adjustCarriageReturnFromNext(t,e)&&(t+=`
`);let n=this.shouldCheckCRLF()&&this.startWithLF(t)&&this.endWithCR(e),i=this._buffers[0].buffer.length;this._buffers[0].buffer+=t;let r=ks(t,!1);for(let m=0;m<r.length;m++)r[m]+=i;if(n){let m=this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-2];this._buffers[0].lineStarts.pop(),this._lastChangeBufferPos={line:this._lastChangeBufferPos.line-1,column:i-m}}this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(r.slice(1));let s=this._buffers[0].lineStarts.length-1,a=this._buffers[0].buffer.length-this._buffers[0].lineStarts[s],l={line:s,column:a},d=e.piece.length+t.length,c=e.piece.lineFeedCnt,u=this.getLineFeedCnt(0,e.piece.start,l),h=u-c;e.piece=new Di(e.piece.bufferIndex,e.piece.start,l,u,d),this._lastChangeBufferPos=l,Ds(this,e,t.length,h)}nodeAt(e){let t=this.root,n=this._searchCache.get(e);if(n)return{node:n.node,nodeStartOffset:n.nodeStartOffset,remainder:e-n.nodeStartOffset};let i=0;for(;t!==Me;)if(t.size_left>e)t=t.left;else if(t.size_left+t.piece.length>=e){i+=t.size_left;let r={node:t,remainder:e-t.size_left,nodeStartOffset:i};return this._searchCache.set(r),r}else e-=t.size_left+t.piece.length,i+=t.size_left+t.piece.length,t=t.right;return null}nodeAt2(e,t){let n=this.root,i=0;for(;n!==Me;)if(n.left!==Me&&n.lf_left>=e-1)n=n.left;else if(n.lf_left+n.piece.lineFeedCnt>e-1){let r=this.getAccumulatedValue(n,e-n.lf_left-2),s=this.getAccumulatedValue(n,e-n.lf_left-1);return i+=n.size_left,{node:n,remainder:Math.min(r+t-1,s),nodeStartOffset:i}}else if(n.lf_left+n.piece.lineFeedCnt===e-1){let r=this.getAccumulatedValue(n,e-n.lf_left-2);if(r+t-1<=n.piece.length)return{node:n,remainder:r+t-1,nodeStartOffset:i};t-=n.piece.length-r;break}else e-=n.lf_left+n.piece.lineFeedCnt,i+=n.size_left+n.piece.length,n=n.right;for(n=n.next();n!==Me;){if(n.piece.lineFeedCnt>0){let r=this.getAccumulatedValue(n,0),s=this.offsetOfNode(n);return{node:n,remainder:Math.min(t-1,r),nodeStartOffset:s}}else if(n.piece.length>=t-1){let r=this.offsetOfNode(n);return{node:n,remainder:t-1,nodeStartOffset:r}}else t-=n.piece.length;n=n.next()}return null}nodeCharCodeAt(e,t){if(e.piece.lineFeedCnt<1)return-1;let n=this._buffers[e.piece.bufferIndex],i=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start)+t;return n.buffer.charCodeAt(i)}offsetOfNode(e){if(!e)return 0;let t=e.size_left;for(;e!==this.root;)e.parent.right===e&&(t+=e.parent.size_left+e.parent.piece.length),e=e.parent;return t}shouldCheckCRLF(){return!(this._EOLNormalized&&this._EOL===`
`)}startWithLF(e){if(typeof e=="string")return e.charCodeAt(0)===10;if(e===Me||e.piece.lineFeedCnt===0)return!1;let t=e.piece,n=this._buffers[t.bufferIndex].lineStarts,i=t.start.line,r=n[i]+t.start.column;return i===n.length-1||n[i+1]>r+1?!1:this._buffers[t.bufferIndex].buffer.charCodeAt(r)===10}endWithCR(e){return typeof e=="string"?e.charCodeAt(e.length-1)===13:e===Me||e.piece.lineFeedCnt===0?!1:this.nodeCharCodeAt(e,e.piece.length-1)===13}validateCRLFWithPrevNode(e){if(this.shouldCheckCRLF()&&this.startWithLF(e)){let t=e.prev();this.endWithCR(t)&&this.fixCRLF(t,e)}}validateCRLFWithNextNode(e){if(this.shouldCheckCRLF()&&this.endWithCR(e)){let t=e.next();this.startWithLF(t)&&this.fixCRLF(e,t)}}fixCRLF(e,t){let n=[],i=this._buffers[e.piece.bufferIndex].lineStarts,r;e.piece.end.column===0?r={line:e.piece.end.line-1,column:i[e.piece.end.line]-i[e.piece.end.line-1]-1}:r={line:e.piece.end.line,column:e.piece.end.column-1};let s=e.piece.length-1,a=e.piece.lineFeedCnt-1;e.piece=new Di(e.piece.bufferIndex,e.piece.start,r,a,s),Ds(this,e,-1,-1),e.piece.length===0&&n.push(e);let l={line:t.piece.start.line+1,column:0},d=t.piece.length-1,c=this.getLineFeedCnt(t.piece.bufferIndex,l,t.piece.end);t.piece=new Di(t.piece.bufferIndex,l,t.piece.end,c,d),Ds(this,t,-1,-1),t.piece.length===0&&n.push(t);let u=this.createNewPieces(`\r
`);this.rbInsertRight(e,u[0]);for(let h=0;h<n.length;h++)ag(this,n[h])}adjustCarriageReturnFromNext(e,t){if(this.shouldCheckCRLF()&&this.endWithCR(e)){let n=t.next();if(this.startWithLF(n)){if(e+=`
`,n.piece.length===1)ag(this,n);else{let i=n.piece,r={line:i.start.line+1,column:0},s=i.length-1,a=this.getLineFeedCnt(i.bufferIndex,r,i.end);n.piece=new Di(i.bufferIndex,r,i.end,a,s),Ds(this,n,-1,-1)}return!0}}return!1}iterate(e,t){if(e===Me)return t(Me);let n=this.iterate(e.left,t);return n&&t(e)&&this.iterate(e.right,t)}getNodeContent(e){if(e===Me)return"";let t=this._buffers[e.piece.bufferIndex],n=e.piece,i=this.offsetInBuffer(n.bufferIndex,n.start),r=this.offsetInBuffer(n.bufferIndex,n.end);return t.buffer.substring(i,r)}getPieceContent(e){let t=this._buffers[e.bufferIndex],n=this.offsetInBuffer(e.bufferIndex,e.start),i=this.offsetInBuffer(e.bufferIndex,e.end);return t.buffer.substring(n,i)}rbInsertRight(e,t){let n=new eh(t,1);if(n.left=Me,n.right=Me,n.parent=Me,n.size_left=0,n.lf_left=0,this.root===Me)this.root=n,n.color=0;else if(e.right===Me)e.right=n,n.parent=e;else{let r=Xy(e.right);r.left=n,n.parent=r}return tL(this,n),n}rbInsertLeft(e,t){let n=new eh(t,1);if(n.left=Me,n.right=Me,n.parent=Me,n.size_left=0,n.lf_left=0,this.root===Me)this.root=n,n.color=0;else if(e.left===Me)e.left=n,n.parent=e;else{let i=QT(e.left);i.right=n,n.parent=i}return tL(this,n),n}getContentOfSubTree(e){let t="";return this.iterate(e,n=>(t+=this.getNodeContent(n),!0)),t}};var th=class o extends V{_pieceTree;_BOM;_mightContainRTL;_mightContainUnusualLineTerminators;_mightContainNonBasicASCII;_onDidChangeContent=this._register(new E);onDidChangeContent=this._onDidChangeContent.event;constructor(e,t,n,i,r,s,a){super(),this._BOM=t,this._mightContainNonBasicASCII=!s,this._mightContainRTL=i,this._mightContainUnusualLineTerminators=r,this._pieceTree=new eI(e,n,a)}equals(e){return!(e instanceof o)||this._BOM!==e._BOM||this.getEOL()!==e.getEOL()?!1:this._pieceTree.equal(e._pieceTree)}mightContainRTL(){return this._mightContainRTL}mightContainUnusualLineTerminators(){return this._mightContainUnusualLineTerminators}resetMightContainUnusualLineTerminators(){this._mightContainUnusualLineTerminators=!1}mightContainNonBasicASCII(){return this._mightContainNonBasicASCII}getBOM(){return this._BOM}getEOL(){return this._pieceTree.getEOL()}createSnapshot(e){return this._pieceTree.createSnapshot(e?this._BOM:"")}getOffsetAt(e,t){return this._pieceTree.getOffsetAt(e,t)}getPositionAt(e){return this._pieceTree.getPositionAt(e)}getRangeAt(e,t){let n=e+t,i=this.getPositionAt(e),r=this.getPositionAt(n);return new D(i.lineNumber,i.column,r.lineNumber,r.column)}getValueInRange(e,t=0){if(e.isEmpty())return"";let n=this._getEndOfLine(t);return this._pieceTree.getValueInRange(e,n)}getValueLengthInRange(e,t=0){if(e.isEmpty())return 0;if(e.startLineNumber===e.endLineNumber)return e.endColumn-e.startColumn;let n=this.getOffsetAt(e.startLineNumber,e.startColumn),i=this.getOffsetAt(e.endLineNumber,e.endColumn),r=0,s=this._getEndOfLine(t),a=this.getEOL();if(s.length!==a.length){let l=s.length-a.length,d=e.endLineNumber-e.startLineNumber;r=l*d}return i-n+r}getCharacterCountInRange(e,t=0){if(this._mightContainNonBasicASCII){let n=0,i=e.startLineNumber,r=e.endLineNumber;for(let s=i;s<=r;s++){let a=this.getLineContent(s),l=s===i?e.startColumn-1:0,d=s===r?e.endColumn-1:a.length;for(let c=l;c<d;c++)Ht(a.charCodeAt(c))?(n=n+1,c=c+1):n=n+1}return n+=this._getEndOfLine(t).length*(r-i),n}return this.getValueLengthInRange(e,t)}getNearestChunk(e){return this._pieceTree.getNearestChunk(e)}getLength(){return this._pieceTree.getLength()}getLineCount(){return this._pieceTree.getLineCount()}getLinesContent(){return this._pieceTree.getLinesContent()}getLineContent(e){return this._pieceTree.getLineContent(e)}getLineCharCode(e,t){return this._pieceTree.getLineCharCode(e,t)}getCharCode(e){return this._pieceTree.getCharCode(e)}getLineLength(e){return this._pieceTree.getLineLength(e)}getLineMinColumn(e){return 1}getLineMaxColumn(e){return this.getLineLength(e)+1}getLineFirstNonWhitespaceColumn(e){let t=Xt(this.getLineContent(e));return t===-1?0:t+1}getLineLastNonWhitespaceColumn(e){let t=Wo(this.getLineContent(e));return t===-1?0:t+2}_getEndOfLine(e){switch(e){case 1:return`
`;case 2:return`\r
`;case 0:return this.getEOL();default:throw new Error("Unknown EOL preference")}}setEOL(e){this._pieceTree.setEOL(e)}applyEdits(e,t,n){let i=this._mightContainRTL,r=this._mightContainUnusualLineTerminators,s=this._mightContainNonBasicASCII,a=!0,l=[];for(let g=0;g<e.length;g++){let b=e[g];a&&b._isTracked&&(a=!1);let y=b.range;if(b.text){let O=!0;s||(O=!rb(b.text),s=O),!i&&O&&(i=ea(b.text)),!r&&O&&(r=sb(b.text))}let C="",x=0,L=0,k=0;if(b.text){let O;[x,L,k,O]=io(b.text);let W=this.getEOL(),z=W===`\r
`?2:1;O===0||O===z?C=b.text:C=b.text.replace(/\r\n|\r|\n/g,W)}l[g]={sortIndex:g,identifier:b.identifier||null,range:y,rangeOffset:this.getOffsetAt(y.startLineNumber,y.startColumn),rangeLength:this.getValueLengthInRange(y),text:C,eolCount:x,firstLineLength:L,lastLineLength:k,forceMoveMarkers:!!b.forceMoveMarkers,isAutoWhitespaceEdit:b.isAutoWhitespaceEdit||!1}}l.sort(o._sortOpsAscending);let d=!1;for(let g=0,b=l.length-1;g<b;g++){let y=l[g].range.getEndPosition(),C=l[g+1].range.getStartPosition();if(C.isBeforeOrEqual(y)){if(C.isBefore(y))throw new Error("Overlapping ranges are not allowed!");d=!0}}a&&(l=this._reduceOperations(l));let c=n||t?o._getInverseEditRanges(l):[],u=[];if(t)for(let g=0;g<l.length;g++){let b=l[g],y=c[g];if(b.isAutoWhitespaceEdit&&b.range.isEmpty())for(let C=y.startLineNumber;C<=y.endLineNumber;C++){let x="";C===y.startLineNumber&&(x=this.getLineContent(b.range.startLineNumber),Xt(x)!==-1)||u.push({lineNumber:C,oldContent:x})}}let h=null;if(n){let g=0;h=[];for(let b=0;b<l.length;b++){let y=l[b],C=c[b],x=this.getValueInRange(y.range),L=y.rangeOffset+g;g+=y.text.length-x.length,h[b]={sortIndex:y.sortIndex,identifier:y.identifier,range:C,text:x,textChange:new So(y.rangeOffset,x,L,y.text)}}d||h.sort((b,y)=>b.sortIndex-y.sortIndex)}this._mightContainRTL=i,this._mightContainUnusualLineTerminators=r,this._mightContainNonBasicASCII=s;let m=this._doApplyEdits(l),f=null;if(t&&u.length>0){u.sort((g,b)=>b.lineNumber-g.lineNumber),f=[];for(let g=0,b=u.length;g<b;g++){let y=u[g].lineNumber;if(g>0&&u[g-1].lineNumber===y)continue;let C=u[g].oldContent,x=this.getLineContent(y);x.length===0||x===C||Xt(x)!==-1||f.push(y)}}return this._onDidChangeContent.fire(),new qv(h,m,f)}_reduceOperations(e){return e.length<1e3?e:[this._toSingleEditOperation(e)]}_toSingleEditOperation(e){let t=!1,n=e[0].range,i=e[e.length-1].range,r=new D(n.startLineNumber,n.startColumn,i.endLineNumber,i.endColumn),s=n.startLineNumber,a=n.startColumn,l=[];for(let m=0,f=e.length;m<f;m++){let g=e[m],b=g.range;t=t||g.forceMoveMarkers,l.push(this.getValueInRange(new D(s,a,b.startLineNumber,b.startColumn))),g.text.length>0&&l.push(g.text),s=b.endLineNumber,a=b.endColumn}let d=l.join(""),[c,u,h]=io(d);return{sortIndex:0,identifier:e[0].identifier,range:r,rangeOffset:this.getOffsetAt(r.startLineNumber,r.startColumn),rangeLength:this.getValueLengthInRange(r,0),text:d,eolCount:c,firstLineLength:u,lastLineLength:h,forceMoveMarkers:t,isAutoWhitespaceEdit:!1}}_doApplyEdits(e){e.sort(o._sortOpsDescending);let t=[];for(let n=0;n<e.length;n++){let i=e[n],r=i.range.startLineNumber,s=i.range.startColumn,a=i.range.endLineNumber,l=i.range.endColumn;if(r===a&&s===l&&i.text.length===0)continue;i.text?(this._pieceTree.delete(i.rangeOffset,i.rangeLength),this._pieceTree.insert(i.rangeOffset,i.text,!0)):this._pieceTree.delete(i.rangeOffset,i.rangeLength);let d=new D(r,s,a,l);t.push({range:d,rangeLength:i.rangeLength,text:i.text,rangeOffset:i.rangeOffset,forceMoveMarkers:i.forceMoveMarkers})}return t}findMatchesLineByLine(e,t,n,i){return this._pieceTree.findMatchesLineByLine(e,t,n,i)}getPieceTree(){return this._pieceTree}static _getInverseEditRange(e,t){let n=e.startLineNumber,i=e.startColumn,[r,s,a]=io(t),l;if(t.length>0){let d=r+1;d===1?l=new D(n,i,n,i+s):l=new D(n,i,n+d-1,a+1)}else l=new D(n,i,n,i);return l}static _getInverseEditRanges(e){let t=[],n=0,i=0,r=null;for(let s=0,a=e.length;s<a;s++){let l=e[s],d,c;r?r.range.endLineNumber===l.range.startLineNumber?(d=n,c=i+(l.range.startColumn-r.range.endColumn)):(d=n+(l.range.startLineNumber-r.range.endLineNumber),c=l.range.startColumn):(d=l.range.startLineNumber,c=l.range.startColumn);let u;if(l.text.length>0){let h=l.eolCount+1;h===1?u=new D(d,c,d,c+l.firstLineLength):u=new D(d,c,d+h-1,l.lastLineLength+1)}else u=new D(d,c,d,c);n=u.endLineNumber,i=u.endColumn,t.push(u),r=l}return t}static _sortOpsAscending(e,t){let n=D.compareRangesUsingEnds(e.range,t.range);return n===0?e.sortIndex-t.sortIndex:n}static _sortOpsDescending(e,t){let n=D.compareRangesUsingEnds(e.range,t.range);return n===0?t.sortIndex-e.sortIndex:-n}};var sL=class{constructor(e,t,n,i,r,s,a,l,d){this._chunks=e;this._bom=t;this._cr=n;this._lf=i;this._crlf=r;this._containsRTL=s;this._containsUnusualLineTerminators=a;this._isBasicASCII=l;this._normalizeEOL=d}_getEOL(e){let t=this._cr+this._lf+this._crlf,n=this._cr+this._crlf;return t===0?e===1?`
`:`\r
`:n>t/2?`\r
`:`
`}create(e){let t=this._getEOL(e),n=this._chunks;if(this._normalizeEOL&&(t===`\r
`&&(this._cr>0||this._lf>0)||t===`
`&&(this._cr>0||this._crlf>0)))for(let r=0,s=n.length;r<s;r++){let a=n[r].buffer.replace(/\r\n|\r|\n/g,t),l=ks(a);n[r]=new Rs(a,l)}let i=new th(n,this._bom,t,this._containsRTL,this._containsUnusualLineTerminators,this._isBasicASCII,this._normalizeEOL);return{textBuffer:i,disposable:i}}getFirstLineText(e){return this._chunks[0].buffer.substr(0,e).split(/\r\n|\r|\n/)[0]}},nh=class{chunks;BOM;_hasPreviousChar;_previousChar;_tmpLineStarts;cr;lf;crlf;containsRTL;containsUnusualLineTerminators;isBasicASCII;constructor(){this.chunks=[],this.BOM="",this._hasPreviousChar=!1,this._previousChar=0,this._tmpLineStarts=[],this.cr=0,this.lf=0,this.crlf=0,this.containsRTL=!1,this.containsUnusualLineTerminators=!1,this.isBasicASCII=!0}acceptChunk(e){if(e.length===0)return;this.chunks.length===0&&Tk(e)&&(this.BOM=_k,e=e.substr(1));let t=e.charCodeAt(e.length-1);t===13||t>=55296&&t<=56319?(this._acceptChunk1(e.substr(0,e.length-1),!1),this._hasPreviousChar=!0,this._previousChar=t):(this._acceptChunk1(e,!1),this._hasPreviousChar=!1,this._previousChar=t)}_acceptChunk1(e,t){!t&&e.length===0||(this._hasPreviousChar?this._acceptChunk2(String.fromCharCode(this._previousChar)+e):this._acceptChunk2(e))}_acceptChunk2(e){let t=jN(this._tmpLineStarts,e);this.chunks.push(new Rs(e,t.lineStarts)),this.cr+=t.cr,this.lf+=t.lf,this.crlf+=t.crlf,t.isBasicASCII||(this.isBasicASCII=!1,this.containsRTL||(this.containsRTL=ea(e)),this.containsUnusualLineTerminators||(this.containsUnusualLineTerminators=sb(e)))}finish(e=!0){return this._finish(),new sL(this.chunks,this.BOM,this.cr,this.lf,this.crlf,this.containsRTL,this.containsUnusualLineTerminators,this.isBasicASCII,e)}_finish(){if(this.chunks.length===0&&this._acceptChunk1("",!0),this._hasPreviousChar){this._hasPreviousChar=!1;let e=this.chunks[this.chunks.length-1];e.buffer+=String.fromCharCode(this._previousChar);let t=ks(e.buffer);e.lineStarts=t,this._previousChar===13&&this.cr++}}};var $N=new class{clone(){return this}equals(o){return this===o}};function aL(o,e){let t=new Uint32Array(2);return t[0]=0,t[1]=(o<<0|0|0|32768|2<<24)>>>0,new Iv(t,e===null?$N:e)}var tI=class{constructor(e){this._default=e}_store=[];get(e){return e<this._store.length?this._store[e]:this._default}set(e,t){for(;e>=this._store.length;)this._store[this._store.length]=this._default;this._store[e]=t}replace(e,t,n){if(e>=this._store.length)return;if(t===0){this.insert(e,n);return}else if(n===0){this.delete(e,t);return}let i=this._store.slice(0,e),r=this._store.slice(e+t),s=_4(n,this._default);this._store=i.concat(s,r)}delete(e,t){t===0||e>=this._store.length||this._store.splice(e,t)}insert(e,t){if(t===0||e>=this._store.length)return;let n=[];for(let i=0;i<t;i++)n[i]=this._default;this._store=ns(this._store,e,n)}};function _4(o,e){let t=[];for(let n=0;n<o;n++)t[n]=e;return t}var Yd=class{static deserialize(e){let t=0,n=Bn(e,t);t+=4;let i=[];for(let r=0;r<n;r++)t=_m.deserialize(e,t,i);return i}_tokens;constructor(){this._tokens=[]}add(e,t){if(this._tokens.length>0){let n=this._tokens[this._tokens.length-1];if(n.endLineNumber+1===e){n.appendLineTokens(t);return}}this._tokens.push(new _m(e,[t]))}finalize(){return this._tokens}serialize(){let e=this._serializeSize(),t=new Uint8Array(e);return this._serialize(t),t}_serializeSize(){let e=0;e+=4;for(let t=0;t<this._tokens.length;t++)e+=this._tokens[t].serializeSize();return e}_serialize(e){let t=0;Vn(e,this._tokens.length,t),t+=4;for(let n=0;n<this._tokens.length;n++)t=this._tokens[n].serialize(e,t)}};var lL=class{constructor(e,t){this.tokenizationSupport=t;this.store=new oh(e)}initialState=this.tokenizationSupport.getInitialState();store;getStartState(e){return this.store.getStartState(e,this.initialState)}getFirstInvalidLine(){return this.store.getFirstInvalidLine(this.initialState)}},nI=class extends lL{constructor(t,n,i,r){super(t,n);this._textModel=i;this._languageIdCodec=r}updateTokensUntilLine(t,n){let i=this._textModel.getLanguageId();for(;;){let r=this.getFirstInvalidLine();if(!r||r.lineNumber>n)break;let s=this._textModel.getLineContent(r.lineNumber),a=ih(this._languageIdCodec,i,this.tokenizationSupport,s,!0,r.startState);t.add(r.lineNumber,a.tokens),this.store.setEndState(r.lineNumber,a.endState)}}getTokenTypeIfInsertingCharacter(t,n){let i=this.getStartState(t.lineNumber);if(!i)return 0;let r=this._textModel.getLanguageId(),s=this._textModel.getLineContent(t.lineNumber),a=s.substring(0,t.column-1)+n+s.substring(t.column-1),l=ih(this._languageIdCodec,r,this.tokenizationSupport,a,!0,i),d=new dn(l.tokens,a,this._languageIdCodec);if(d.getCount()===0)return 0;let c=d.findTokenIndexAtOffset(t.column-1);return d.getStandardTokenType(c)}tokenizeLineWithEdit(t,n){let i=this.getStartState(t);if(!i)return{mainLineTokens:null,additionalLines:null};let r=this._textModel.getLineContent(t),s=n.lineEdit.apply(r),a=this._textModel.getLanguageIdAtPosition(t,0),l=ih(this._languageIdCodec,a,this.tokenizationSupport,s,!0,i),d=null;if(n.additionalLines){d=[];let u=l.endState;for(let h of n.additionalLines){let m=ih(this._languageIdCodec,a,this.tokenizationSupport,h,!0,u);d.push(new dn(m.tokens,h,this._languageIdCodec)),u=m.endState}}return{mainLineTokens:new dn(l.tokens,s,this._languageIdCodec),additionalLines:d}}hasAccurateTokensForLine(t){let n=this.store.getFirstInvalidEndStateLineNumberOrMax();return t<n}isCheapToTokenize(t){let n=this.store.getFirstInvalidEndStateLineNumberOrMax();return t<n||t===n&&this._textModel.getLineLength(t)<2048}tokenizeHeuristically(t,n,i){if(i<=this.store.getFirstInvalidEndStateLineNumberOrMax())return{heuristicTokens:!1};if(n<=this.store.getFirstInvalidEndStateLineNumberOrMax())return this.updateTokensUntilLine(t,i),{heuristicTokens:!1};let r=this.guessStartState(n),s=this._textModel.getLanguageId();for(let a=n;a<=i;a++){let l=this._textModel.getLineContent(a),d=ih(this._languageIdCodec,s,this.tokenizationSupport,l,!0,r);t.add(a,d.tokens),r=d.endState}return{heuristicTokens:!0}}guessStartState(t){let n=this._textModel.getLineFirstNonWhitespaceColumn(t),i=[],r=null;for(let l=t-1;n>1&&l>=1;l--){let d=this._textModel.getLineFirstNonWhitespaceColumn(l);if(d!==0&&d<n&&(i.push(this._textModel.getLineContent(l)),n=d,r=this.getStartState(l),r))break}r||(r=this.tokenizationSupport.getInitialState()),i.reverse();let s=this._textModel.getLanguageId(),a=r;for(let l of i)a=ih(this._languageIdCodec,s,this.tokenizationSupport,l,!1,a).endState;return a}},oh=class{constructor(e){this.lineCount=e;this._invalidEndStatesLineNumbers.addRange(new Pt(1,e+1))}_tokenizationStateStore=new dL;_invalidEndStatesLineNumbers=new cL;getEndState(e){return this._tokenizationStateStore.getEndState(e)}setEndState(e,t){if(!t)throw new Qe("Cannot set null/undefined state");this._invalidEndStatesLineNumbers.delete(e);let n=this._tokenizationStateStore.setEndState(e,t);return n&&e<this.lineCount&&this._invalidEndStatesLineNumbers.addRange(new Pt(e+1,e+2)),n}acceptChange(e,t){this.lineCount+=t-e.length,this._tokenizationStateStore.acceptChange(e,t),this._invalidEndStatesLineNumbers.addRangeAndResize(new Pt(e.startLineNumber,e.endLineNumberExclusive),t)}acceptChanges(e){for(let t of e){let[n]=io(t.text);this.acceptChange(new Ei(t.range.startLineNumber,t.range.endLineNumber+1),n+1)}}invalidateEndStateRange(e){this._invalidEndStatesLineNumbers.addRange(new Pt(e.startLineNumber,e.endLineNumberExclusive))}getFirstInvalidEndStateLineNumber(){return this._invalidEndStatesLineNumbers.min}getFirstInvalidEndStateLineNumberOrMax(){return this.getFirstInvalidEndStateLineNumber()||Number.MAX_SAFE_INTEGER}allStatesValid(){return this._invalidEndStatesLineNumbers.min===null}getStartState(e,t){return e===1?t:this.getEndState(e-1)}getFirstInvalidLine(e){let t=this.getFirstInvalidEndStateLineNumber();if(t===null)return null;let n=this.getStartState(t,e);if(!n)throw new Qe("Start state must be defined");return{lineNumber:t,startState:n}}},dL=class{_lineEndStates=new tI(null);getEndState(e){return this._lineEndStates.get(e)}setEndState(e,t){let n=this._lineEndStates.get(e);return n&&n.equals(t)?!1:(this._lineEndStates.set(e,t),!0)}acceptChange(e,t){let n=e.length;t>0&&n>0&&(n--,t--),this._lineEndStates.replace(e.startLineNumber,n,t)}acceptChanges(e){for(let t of e){let[n]=io(t.text);this.acceptChange(new Ei(t.range.startLineNumber,t.range.endLineNumber+1),n+1)}}},cL=class{_ranges=[];getRanges(){return this._ranges}get min(){return this._ranges.length===0?null:this._ranges[0].start}removeMin(){if(this._ranges.length===0)return null;let e=this._ranges[0];return e.start+1===e.endExclusive?this._ranges.shift():this._ranges[0]=new Pt(e.start+1,e.endExclusive),e.start}delete(e){let t=this._ranges.findIndex(n=>n.contains(e));if(t!==-1){let n=this._ranges[t];n.start===e?n.endExclusive===e+1?this._ranges.splice(t,1):this._ranges[t]=new Pt(e+1,n.endExclusive):n.endExclusive===e+1?this._ranges[t]=new Pt(n.start,e):this._ranges.splice(t,1,new Pt(n.start,e),new Pt(e+1,n.endExclusive))}}addRange(e){Pt.addRange(e,this._ranges)}addRangeAndResize(e,t){let n=0;for(;!(n>=this._ranges.length||e.start<=this._ranges[n].endExclusive);)n++;let i=n;for(;!(i>=this._ranges.length||e.endExclusive<this._ranges[i].start);)i++;let r=t-e.length;for(let s=i;s<this._ranges.length;s++)this._ranges[s]=this._ranges[s].delta(r);if(n===i){let s=new Pt(e.start,e.start+t);s.isEmpty||this._ranges.splice(n,0,s)}else{let s=Math.min(e.start,this._ranges[n].start),a=Math.max(e.endExclusive,this._ranges[i-1].endExclusive),l=new Pt(s,a+r);l.isEmpty?this._ranges.splice(n,i-n):this._ranges.splice(n,i-n,l)}}toString(){return this._ranges.map(e=>e.toString()).join(" + ")}};function ih(o,e,t,n,i,r){let s=null;if(t)try{s=t.tokenizeEncoded(n,i,r.clone())}catch(a){je(a)}return s||(s=aL(o.encodeLanguageId(e),r)),dn.convertToEndOffset(s.tokens,n.length),s}var iI=class{constructor(e,t){this._tokenizerWithStateStore=e;this._backgroundTokenStore=t}_isDisposed=!1;dispose(){this._isDisposed=!0}handleChanges(){this._beginBackgroundTokenization()}_isScheduled=!1;_beginBackgroundTokenization(){this._isScheduled||!this._tokenizerWithStateStore._textModel.isAttachedToEditor()||!this._hasLinesToTokenize()||(this._isScheduled=!0,nl(e=>{this._isScheduled=!1,this._backgroundTokenizeWithDeadline(e)}))}_backgroundTokenizeWithDeadline(e){let t=Date.now()+e.timeRemaining(),n=()=>{this._isDisposed||!this._tokenizerWithStateStore._textModel.isAttachedToEditor()||!this._hasLinesToTokenize()||(this._backgroundTokenizeForAtLeast1ms(),Date.now()<t?Ef(n):this._beginBackgroundTokenization())};n()}_backgroundTokenizeForAtLeast1ms(){let e=this._tokenizerWithStateStore._textModel.getLineCount(),t=new Yd,n=sd.create(!1);do if(n.elapsed()>1||this._tokenizeOneInvalidLine(t)>=e)break;while(this._hasLinesToTokenize());this._backgroundTokenStore.setTokens(t.finalize()),this.checkFinished()}_hasLinesToTokenize(){return this._tokenizerWithStateStore?!this._tokenizerWithStateStore.store.allStatesValid():!1}_tokenizeOneInvalidLine(e){let t=this._tokenizerWithStateStore?.getFirstInvalidLine();return t?(this._tokenizerWithStateStore.updateTokensUntilLine(e,t.lineNumber),t.lineNumber):this._tokenizerWithStateStore._textModel.getLineCount()+1}checkFinished(){this._isDisposed||this._tokenizerWithStateStore.store.allStatesValid()&&this._backgroundTokenStore.backgroundTokenizationFinished()}requestTokens(e,t){this._tokenizerWithStateStore.store.invalidateEndStateRange(new Ei(e,t))}};var oI=class{_onDidChangeVisibleRanges=new E;onDidChangeVisibleRanges=this._onDidChangeVisibleRanges.event;_views=new Set;attachView(){let e=new uL(t=>{this._onDidChangeVisibleRanges.fire({view:e,state:t})});return this._views.add(e),e}detachView(e){this._views.delete(e),this._onDidChangeVisibleRanges.fire({view:e,state:void 0})}},uL=class{constructor(e){this.handleStateChange=e}setVisibleLines(e,t){let n=e.map(i=>new Ei(i.startLineNumber,i.endLineNumber+1));this.handleStateChange({visibleLineRanges:n,stabilized:t})}},rI=class extends V{constructor(t){super();this._refreshTokens=t}runner=this._register(new Qt(()=>this.update(),50));_computedLineRanges=[];_lineRanges=[];get lineRanges(){return this._lineRanges}update(){on(this._computedLineRanges,this._lineRanges,(t,n)=>t.equals(n))||(this._computedLineRanges=this._lineRanges,this._refreshTokens())}handleStateChange(t){this._lineRanges=t.visibleLineRanges,t.stabilized?(this.runner.cancel(),this.update()):this.runner.schedule()}},rh=class extends V{constructor(t,n,i){super();this._languageIdCodec=t;this._textModel=n;this.getLanguageId=i}_backgroundTokenizationState=1;get backgroundTokenizationState(){return this._backgroundTokenizationState}_onDidChangeBackgroundTokenizationState=this._register(new E);onDidChangeBackgroundTokenizationState=this._onDidChangeBackgroundTokenizationState.event;_onDidChangeTokens=this._register(new E);onDidChangeTokens=this._onDidChangeTokens.event;tokenizeIfCheap(t){this.isCheapToTokenize(t)&&this.forceTokenization(t)}};var qN=Y("treeSitterParserService");var lg=class extends rh{constructor(t,n,i,r){super(n,i,r);this._treeSitterService=t;this._initialize()}_tokenizationSupport=null;_lastLanguageId;_initialize(){let t=this.getLanguageId();(!this._tokenizationSupport||this._lastLanguageId!==t)&&(this._lastLanguageId=t,this._tokenizationSupport=Lm.get(t))}getLineTokens(t){let n=this._textModel.getLineContent(t);if(this._tokenizationSupport){let i=this._tokenizationSupport.tokenizeEncoded(t,this._textModel);if(i)return new dn(i,n,this._languageIdCodec)}return dn.createEmpty(n,this._languageIdCodec)}resetTokenization(t=!0){t&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]}),this._initialize()}handleDidChangeAttached(){}handleDidChangeContent(t){t.isFlush&&this.resetTokenization(!1)}forceTokenization(t){}hasAccurateTokensForLine(t){return!0}isCheapToTokenize(t){return!0}getTokenTypeIfInsertingCharacter(t,n,i){return 0}tokenizeLineWithEdit(t,n){return{mainLineTokens:null,additionalLines:null}}get hasTokens(){return this._treeSitterService.getParseResult(this._textModel)!==void 0}};var dg=class o{_lineTokens;_len;_languageIdCodec;constructor(e){this._lineTokens=[],this._len=0,this._languageIdCodec=e}flush(){this._lineTokens=[],this._len=0}get hasTokens(){return this._lineTokens.length>0}getTokens(e,t,n){let i=null;if(t<this._len&&(i=this._lineTokens[t]),i!==null&&i!==Ss)return new dn(ws(i),n,this._languageIdCodec);let r=new Uint32Array(2);return r[0]=n.length,r[1]=YN(this._languageIdCodec.encodeLanguageId(e)),new dn(r,n,this._languageIdCodec)}static _massageTokens(e,t,n){let i=n?ws(n):null;if(t===0){let r=!1;if(i&&i.length>1&&(r=wo.getLanguageId(i[1])!==e),!r)return Ss}if(!i||i.length===0){let r=new Uint32Array(2);return r[0]=t,r[1]=YN(e),r.buffer}return i[i.length-2]=t,i.byteOffset===0&&i.byteLength===i.buffer.byteLength?i.buffer:i}_ensureLine(e){for(;e>=this._len;)this._lineTokens[this._len]=null,this._len++}_deleteLines(e,t){t!==0&&(e+t>this._len&&(t=this._len-e),this._lineTokens.splice(e,t),this._len-=t)}_insertLines(e,t){if(t===0)return;let n=[];for(let i=0;i<t;i++)n[i]=null;this._lineTokens=ns(this._lineTokens,e,n),this._len+=t}setTokens(e,t,n,i,r){let s=o._massageTokens(this._languageIdCodec.encodeLanguageId(e),n,i);this._ensureLine(t);let a=this._lineTokens[t];return this._lineTokens[t]=s,r?!o._equals(a,s):!1}static _equals(e,t){if(!e||!t)return!e&&!t;let n=ws(e),i=ws(t);if(n.length!==i.length)return!1;for(let r=0,s=n.length;r<s;r++)if(n[r]!==i[r])return!1;return!0}acceptEdit(e,t,n){this._acceptDeleteRange(e),this._acceptInsertText(new P(e.startLineNumber,e.startColumn),t,n)}_acceptDeleteRange(e){let t=e.startLineNumber-1;if(t>=this._len)return;if(e.startLineNumber===e.endLineNumber){if(e.startColumn===e.endColumn)return;this._lineTokens[t]=Wn.delete(this._lineTokens[t],e.startColumn-1,e.endColumn-1);return}this._lineTokens[t]=Wn.deleteEnding(this._lineTokens[t],e.startColumn-1);let n=e.endLineNumber-1,i=null;n<this._len&&(i=Wn.deleteBeginning(this._lineTokens[n],e.endColumn-1)),this._lineTokens[t]=Wn.append(this._lineTokens[t],i),this._deleteLines(e.startLineNumber,e.endLineNumber-e.startLineNumber)}_acceptInsertText(e,t,n){if(t===0&&n===0)return;let i=e.lineNumber-1;if(!(i>=this._len)){if(t===0){this._lineTokens[i]=Wn.insert(this._lineTokens[i],e.column-1,n);return}this._lineTokens[i]=Wn.deleteEnding(this._lineTokens[i],e.column-1),this._lineTokens[i]=Wn.insert(this._lineTokens[i],e.column-1,n),this._insertLines(e.lineNumber,t)}}setMultilineTokens(e,t){if(e.length===0)return{changes:[]};let n=[];for(let i=0,r=e.length;i<r;i++){let s=e[i],a=0,l=0,d=!1;for(let c=s.startLineNumber;c<=s.endLineNumber;c++)d?(this.setTokens(t.getLanguageId(),c-1,t.getLineLength(c),s.getLineTokens(c),!1),l=c):this.setTokens(t.getLanguageId(),c-1,t.getLineLength(c),s.getLineTokens(c),!0)&&(d=!0,a=c,l=c);d&&n.push({fromLineNumber:a,toLineNumber:l})}return{changes:n}}};function YN(o){return(o<<0|0|0|32768|2<<24|1024)>>>0}var sI=class o{_pieces;_isComplete;_languageIdCodec;constructor(e){this._pieces=[],this._isComplete=!1,this._languageIdCodec=e}flush(){this._pieces=[],this._isComplete=!1}isEmpty(){return this._pieces.length===0}set(e,t){this._pieces=e||[],this._isComplete=t}setPartial(e,t){let n=e;if(t.length>0){let r=t[0].getRange(),s=t[t.length-1].getRange();if(!r||!s)return e;n=e.plusRange(r).plusRange(s)}let i=null;for(let r=0,s=this._pieces.length;r<s;r++){let a=this._pieces[r];if(a.endLineNumber<n.startLineNumber)continue;if(a.startLineNumber>n.endLineNumber){i=i||{index:r};break}if(a.removeTokens(n),a.isEmpty()){this._pieces.splice(r,1),r--,s--;continue}if(a.endLineNumber<n.startLineNumber)continue;if(a.startLineNumber>n.endLineNumber){i=i||{index:r};continue}let[l,d]=a.split(n);if(l.isEmpty()){i=i||{index:r};continue}d.isEmpty()||(this._pieces.splice(r,1,l,d),r++,s++,i=i||{index:r})}return i=i||{index:this._pieces.length},t.length>0&&(this._pieces=ns(this._pieces,i.index,t)),n}isComplete(){return this._isComplete}addSparseTokens(e,t){if(t.getLineContent().length===0)return t;let n=this._pieces;if(n.length===0)return t;let i=o._findFirstPieceWithLine(n,e),r=n[i].getLineTokens(e);if(!r)return t;let s=t.getCount(),a=r.getCount(),l=0,d=[],c=0,u=0,h=(m,f)=>{m!==u&&(u=m,d[c++]=m,d[c++]=f)};for(let m=0;m<a;m++){let f=r.getStartCharacter(m),g=r.getEndCharacter(m),b=r.getMetadata(m),y=((b&1?2048:0)|(b&2?4096:0)|(b&4?8192:0)|(b&8?16384:0)|(b&16?16744448:0)|(b&32?4278190080:0))>>>0,C=~y>>>0;for(;l<s&&t.getEndOffset(l)<=f;)h(t.getEndOffset(l),t.getMetadata(l)),l++;for(l<s&&t.getStartOffset(l)<f&&h(f,t.getMetadata(l));l<s&&t.getEndOffset(l)<g;)h(t.getEndOffset(l),t.getMetadata(l)&C|b&y),l++;if(l<s)h(g,t.getMetadata(l)&C|b&y),t.getEndOffset(l)===g&&l++;else{let x=Math.min(Math.max(0,l-1),s-1);h(g,t.getMetadata(x)&C|b&y)}}for(;l<s;)h(t.getEndOffset(l),t.getMetadata(l)),l++;return new dn(new Uint32Array(d),t.getLineContent(),this._languageIdCodec)}static _findFirstPieceWithLine(e,t){let n=0,i=e.length-1;for(;n<i;){let r=n+Math.floor((i-n)/2);if(e[r].endLineNumber<t)n=r+1;else if(e[r].startLineNumber>t)i=r-1;else{for(;r>n&&e[r-1].startLineNumber<=t&&t<=e[r-1].endLineNumber;)r--;return r}}return n}acceptEdit(e,t,n,i,r){for(let s of this._pieces)s.acceptEdit(e,t,n,i,r)}};var ya=class extends Xu{constructor(t,n,i,r,s,a,l){super();this._textModel=t;this._bracketPairsTextModelPart=n;this._languageId=i;this._attachedViews=r;this._languageService=s;this._languageConfigurationService=a;this._treeSitterService=l;this._register(this._languageConfigurationService.onDidChange(d=>{d.affects(this._languageId)&&this._onDidChangeLanguageConfiguration.fire({})})),this._register(oe.filter(Lm.onDidChange,d=>d.changedLanguages.includes(this._languageId))(()=>{this.createPreferredTokenProvider()})),this.createPreferredTokenProvider()}_semanticTokens=new sI(this._languageService.languageIdCodec);_onDidChangeLanguage=this._register(new E);onDidChangeLanguage=this._onDidChangeLanguage.event;_onDidChangeLanguageConfiguration=this._register(new E);onDidChangeLanguageConfiguration=this._onDidChangeLanguageConfiguration.event;_onDidChangeTokens=this._register(new E);onDidChangeTokens=this._onDidChangeTokens.event;_tokens;_tokensDisposables=this._register(new he);createGrammarTokens(){return this._register(new aI(this._languageService.languageIdCodec,this._textModel,()=>this._languageId,this._attachedViews))}createTreeSitterTokens(){return this._register(new lg(this._treeSitterService,this._languageService.languageIdCodec,this._textModel,()=>this._languageId))}createTokens(t){let n=this._tokens!==void 0;this._tokens?.dispose(),this._tokens=t?this.createTreeSitterTokens():this.createGrammarTokens(),this._tokensDisposables.clear(),this._tokensDisposables.add(this._tokens.onDidChangeTokens(i=>{this._emitModelTokensChangedEvent(i)})),this._tokensDisposables.add(this._tokens.onDidChangeBackgroundTokenizationState(i=>{this._bracketPairsTextModelPart.handleDidChangeBackgroundTokenizationState()})),n&&this._tokens.resetTokenization()}createPreferredTokenProvider(){Lm.get(this._languageId)?this._tokens instanceof lg||this.createTokens(!0):this._tokens instanceof aI||this.createTokens(!1)}_hasListeners(){return this._onDidChangeLanguage.hasListeners()||this._onDidChangeLanguageConfiguration.hasListeners()||this._onDidChangeTokens.hasListeners()}handleLanguageConfigurationServiceChange(t){t.affects(this._languageId)&&this._onDidChangeLanguageConfiguration.fire({})}handleDidChangeContent(t){if(t.isFlush)this._semanticTokens.flush();else if(!t.isEolChange)for(let n of t.changes){let[i,r,s]=io(n.text);this._semanticTokens.acceptEdit(n.range,i,r,s,n.text.length>0?n.text.charCodeAt(0):0)}this._tokens.handleDidChangeContent(t)}handleDidChangeAttached(){this._tokens.handleDidChangeAttached()}getLineTokens(t){this.validateLineNumber(t);let n=this._tokens.getLineTokens(t);return this._semanticTokens.addSparseTokens(t,n)}_emitModelTokensChangedEvent(t){this._textModel._isDisposing()||(this._bracketPairsTextModelPart.handleDidChangeTokens(t),this._onDidChangeTokens.fire(t))}validateLineNumber(t){if(t<1||t>this._textModel.getLineCount())throw new Qe("Illegal value for lineNumber")}get hasTokens(){return this._tokens.hasTokens}resetTokenization(){this._tokens.resetTokenization()}get backgroundTokenizationState(){return this._tokens.backgroundTokenizationState}forceTokenization(t){this.validateLineNumber(t),this._tokens.forceTokenization(t)}hasAccurateTokensForLine(t){return this.validateLineNumber(t),this._tokens.hasAccurateTokensForLine(t)}isCheapToTokenize(t){return this.validateLineNumber(t),this._tokens.isCheapToTokenize(t)}tokenizeIfCheap(t){this.validateLineNumber(t),this._tokens.tokenizeIfCheap(t)}getTokenTypeIfInsertingCharacter(t,n,i){return this._tokens.getTokenTypeIfInsertingCharacter(t,n,i)}tokenizeLineWithEdit(t,n){return this._tokens.tokenizeLineWithEdit(t,n)}setSemanticTokens(t,n){this._semanticTokens.set(t,n),this._emitModelTokensChangedEvent({semanticTokensApplied:t!==null,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]})}hasCompleteSemanticTokens(){return this._semanticTokens.isComplete()}hasSomeSemanticTokens(){return!this._semanticTokens.isEmpty()}setPartialSemanticTokens(t,n){if(this.hasCompleteSemanticTokens())return;let i=this._textModel.validateRange(this._semanticTokens.setPartial(t,n));this._emitModelTokensChangedEvent({semanticTokensApplied:!0,ranges:[{fromLineNumber:i.startLineNumber,toLineNumber:i.endLineNumber}]})}getWordAtPosition(t){this.assertNotDisposed();let n=this._textModel.validatePosition(t),i=this._textModel.getLineContent(n.lineNumber),r=this.getLineTokens(n.lineNumber),s=r.findTokenIndexAtOffset(n.column-1),[a,l]=ya._findLanguageBoundaries(r,s),d=zb(n.column,this.getLanguageConfiguration(r.getLanguageId(s)).getWordDefinition(),i.substring(a,l),a);if(d&&d.startColumn<=t.column&&t.column<=d.endColumn)return d;if(s>0&&a===n.column-1){let[c,u]=ya._findLanguageBoundaries(r,s-1),h=zb(n.column,this.getLanguageConfiguration(r.getLanguageId(s-1)).getWordDefinition(),i.substring(c,u),c);if(h&&h.startColumn<=t.column&&t.column<=h.endColumn)return h}return null}getLanguageConfiguration(t){return this._languageConfigurationService.getLanguageConfiguration(t)}static _findLanguageBoundaries(t,n){let i=t.getLanguageId(n),r=0;for(let a=n;a>=0&&t.getLanguageId(a)===i;a--)r=t.getStartOffset(a);let s=t.getLineContent().length;for(let a=n,l=t.getCount();a<l&&t.getLanguageId(a)===i;a++)s=t.getEndOffset(a);return[r,s]}getWordUntilPosition(t){let n=this.getWordAtPosition(t);return n?{word:n.word.substr(0,t.column-n.startColumn),startColumn:n.startColumn,endColumn:t.column}:{word:"",startColumn:t.column,endColumn:t.column}}getLanguageId(){return this._languageId}getLanguageIdAtPosition(t,n){let i=this._textModel.validatePosition(new P(t,n)),r=this.getLineTokens(i.lineNumber);return r.getLanguageId(r.findTokenIndexAtOffset(i.column-1))}setLanguageId(t,n="api"){if(this._languageId===t)return;let i={oldLanguage:this._languageId,newLanguage:t,source:n};this._languageId=t,this._bracketPairsTextModelPart.handleDidChangeLanguage(i),this._tokens.resetTokenization(),this.createPreferredTokenProvider(),this._onDidChangeLanguage.fire(i),this._onDidChangeLanguageConfiguration.fire({})}};ya=R([S(4,Bi),S(5,ca),S(6,qN)],ya);var aI=class extends rh{_tokenizer=null;_defaultBackgroundTokenizer=null;_backgroundTokenizer=this._register(new Zt);_tokens=new dg(this._languageIdCodec);_debugBackgroundTokens;_debugBackgroundStates;_debugBackgroundTokenizer=this._register(new Zt);_attachedViewStates=this._register(new Fo);constructor(e,t,n,i){super(e,t,n),this._register(xo.onDidChange(r=>{let s=this.getLanguageId();r.changedLanguages.indexOf(s)!==-1&&this.resetTokenization()})),this.resetTokenization(),this._register(i.onDidChangeVisibleRanges(({view:r,state:s})=>{if(s){let a=this._attachedViewStates.get(r);a||(a=new rI(()=>this.refreshRanges(a.lineRanges)),this._attachedViewStates.set(r,a)),a.handleStateChange(s)}else this._attachedViewStates.deleteAndDispose(r)}))}resetTokenization(e=!0){this._tokens.flush(),this._debugBackgroundTokens?.flush(),this._debugBackgroundStates&&(this._debugBackgroundStates=new oh(this._textModel.getLineCount())),e&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]});let t=()=>{if(this._textModel.isTooLargeForTokenization())return[null,null];let r=xo.get(this.getLanguageId());if(!r)return[null,null];let s;try{s=r.getInitialState()}catch(a){return je(a),[null,null]}return[r,s]},[n,i]=t();if(n&&i?this._tokenizer=new nI(this._textModel.getLineCount(),n,this._textModel,this._languageIdCodec):this._tokenizer=null,this._backgroundTokenizer.clear(),this._defaultBackgroundTokenizer=null,this._tokenizer){let r={setTokens:s=>{this.setTokens(s)},backgroundTokenizationFinished:()=>{if(this._backgroundTokenizationState===2)return;let s=2;this._backgroundTokenizationState=s,this._onDidChangeBackgroundTokenizationState.fire()},setEndState:(s,a)=>{if(!this._tokenizer)return;let l=this._tokenizer.store.getFirstInvalidEndStateLineNumber();l!==null&&s>=l&&this._tokenizer?.store.setEndState(s,a)}};n&&n.createBackgroundTokenizer&&!n.backgroundTokenizerShouldOnlyVerifyTokens&&(this._backgroundTokenizer.value=n.createBackgroundTokenizer(this._textModel,r)),!this._backgroundTokenizer.value&&!this._textModel.isTooLargeForTokenization()&&(this._backgroundTokenizer.value=this._defaultBackgroundTokenizer=new iI(this._tokenizer,r),this._defaultBackgroundTokenizer.handleChanges()),n?.backgroundTokenizerShouldOnlyVerifyTokens&&n.createBackgroundTokenizer?(this._debugBackgroundTokens=new dg(this._languageIdCodec),this._debugBackgroundStates=new oh(this._textModel.getLineCount()),this._debugBackgroundTokenizer.clear(),this._debugBackgroundTokenizer.value=n.createBackgroundTokenizer(this._textModel,{setTokens:s=>{this._debugBackgroundTokens?.setMultilineTokens(s,this._textModel)},backgroundTokenizationFinished(){},setEndState:(s,a)=>{this._debugBackgroundStates?.setEndState(s,a)}})):(this._debugBackgroundTokens=void 0,this._debugBackgroundStates=void 0,this._debugBackgroundTokenizer.value=void 0)}this.refreshAllVisibleLineTokens()}handleDidChangeAttached(){this._defaultBackgroundTokenizer?.handleChanges()}handleDidChangeContent(e){if(e.isFlush)this.resetTokenization(!1);else if(!e.isEolChange){for(let t of e.changes){let[n,i]=io(t.text);this._tokens.acceptEdit(t.range,n,i),this._debugBackgroundTokens?.acceptEdit(t.range,n,i)}this._debugBackgroundStates?.acceptChanges(e.changes),this._tokenizer&&this._tokenizer.store.acceptChanges(e.changes),this._defaultBackgroundTokenizer?.handleChanges()}}setTokens(e){let{changes:t}=this._tokens.setMultilineTokens(e,this._textModel);return t.length>0&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:t}),{changes:t}}refreshAllVisibleLineTokens(){let e=Ei.joinMany([...this._attachedViewStates].map(([t,n])=>n.lineRanges));this.refreshRanges(e)}refreshRanges(e){for(let t of e)this.refreshRange(t.startLineNumber,t.endLineNumberExclusive-1)}refreshRange(e,t){if(!this._tokenizer)return;e=Math.max(1,Math.min(this._textModel.getLineCount(),e)),t=Math.min(this._textModel.getLineCount(),t);let n=new Yd,{heuristicTokens:i}=this._tokenizer.tokenizeHeuristically(n,e,t),r=this.setTokens(n.finalize());if(i)for(let s of r.changes)this._backgroundTokenizer.value?.requestTokens(s.fromLineNumber,s.toLineNumber+1);this._defaultBackgroundTokenizer?.checkFinished()}forceTokenization(e){let t=new Yd;this._tokenizer?.updateTokensUntilLine(t,e),this.setTokens(t.finalize()),this._defaultBackgroundTokenizer?.checkFinished()}hasAccurateTokensForLine(e){return this._tokenizer?this._tokenizer.hasAccurateTokensForLine(e):!0}isCheapToTokenize(e){return this._tokenizer?this._tokenizer.isCheapToTokenize(e):!0}getLineTokens(e){let t=this._textModel.getLineContent(e),n=this._tokens.getTokens(this._textModel.getLanguageId(),e-1,t);if(this._debugBackgroundTokens&&this._debugBackgroundStates&&this._tokenizer&&this._debugBackgroundStates.getFirstInvalidEndStateLineNumberOrMax()>e&&this._tokenizer.store.getFirstInvalidEndStateLineNumberOrMax()>e){let i=this._debugBackgroundTokens.getTokens(this._textModel.getLanguageId(),e-1,t);!n.equals(i)&&this._debugBackgroundTokenizer.value?.reportMismatchingTokens&&this._debugBackgroundTokenizer.value.reportMismatchingTokens(e)}return n}getTokenTypeIfInsertingCharacter(e,t,n){if(!this._tokenizer)return 0;let i=this._textModel.validatePosition(new P(e,t));return this.forceTokenization(i.lineNumber),this._tokenizer.getTokenTypeIfInsertingCharacter(i,n)}tokenizeLineWithEdit(e,t){return this._tokenizer?(this.forceTokenization(e),this._tokenizer.tokenizeLineWithEdit(e,t)):{mainLineTokens:null,additionalLines:null}}get hasTokens(){return this._tokens.hasTokens}};function ug(o){let e=new nh;return e.acceptChunk(o),e.finish()}function JN(o){return new Promise((e,t)=>{let n=new nh,i=!1;x_(o,{onData:r=>{n.acceptChunk(typeof r=="string"?r:r.toString())},onError:r=>{i||(i=!0,t(r))},onEnd:()=>{i||(i=!0,e(n.finish()))}})})}function T4(o){let e=new nh,t;for(;typeof(t=o.read())=="string";)e.acceptChunk(t);return e.finish()}function ZN(o,e){let t;return typeof o=="string"?t=ug(o):YM(o)?t=T4(o):t=o,t.create(e)}var lI=0,L4=999,D4=1e4,pL=class{_source;_eos;constructor(e){this._source=e,this._eos=!1}read(){if(this._eos)return null;let e=[],t=0,n=0;do{let i=this._source.read();if(i===null)return this._eos=!0,t===0?null:e.join("");if(i.length>0&&(e[t++]=i,n+=i.length),n>=64*1024)return e.join("")}while(!0)}},cg=()=>{throw new Error("Invalid change accessor")};var As=class extends V{constructor(t,n,i,r=null,s,a,l,d){super();this._undoRedoService=s;this._languageService=a;this._languageConfigurationService=l;this.instantiationService=d;lI++,this.id="$model"+lI,this.isForSimpleWidget=i.isForSimpleWidget,typeof r>"u"||r===null?this._associatedResource=ie.parse("inmemory://model/"+lI):this._associatedResource=r,this._attachedEditorCount=0;let{textBuffer:c,disposable:u}=ZN(t,i.defaultEOL);this._buffer=c,this._bufferDisposable=u,this._options=As.resolveOptions(this._buffer,i);let h=typeof n=="string"?n:n.languageId;typeof n!="string"&&(this._languageSelectionListener.value=n.onDidChange(()=>this._setLanguage(n.languageId))),this._bracketPairs=this._register(new Oy(this,this._languageConfigurationService)),this._guidesTextModelPart=this._register(new Yy(this,this._languageConfigurationService)),this._decorationProvider=this._register(new Gy(this)),this._tokenizationTextModelPart=this.instantiationService.createInstance(ya,this,this._bracketPairs,h,this._attachedViews);let m=this._buffer.getLineCount(),f=this._buffer.getValueLengthInRange(new D(1,1,m,this._buffer.getLineLength(m)+1),0);i.largeFileOptimizations?(this._isTooLargeForTokenization=f>As.LARGE_FILE_SIZE_THRESHOLD||m>As.LARGE_FILE_LINE_COUNT_THRESHOLD,this._isTooLargeForHeapOperation=f>As.LARGE_FILE_HEAP_OPERATION_THRESHOLD):(this._isTooLargeForTokenization=!1,this._isTooLargeForHeapOperation=!1),this._isTooLargeForSyncing=f>As._MODEL_SYNC_LIMIT,this._versionId=1,this._alternativeVersionId=1,this._initialUndoRedoSnapshot=null,this._isDisposed=!1,this.__isDisposing=!1,this._instanceId=ab(lI),this._lastDecorationId=0,this._decorations=Object.create(null),this._decorationsTree=new cI,this._commandManager=new qy(this,this._undoRedoService),this._isUndoing=!1,this._isRedoing=!1,this._trimAutoWhitespaceLines=null,this._register(this._decorationProvider.onDidChange(()=>{this._onDidChangeDecorations.beginDeferredEmit(),this._onDidChangeDecorations.fire(),this._onDidChangeDecorations.endDeferredEmit()})),this._languageService.requestRichLanguageFeatures(h),this._register(this._languageConfigurationService.onDidChange(g=>{this._bracketPairs.handleLanguageConfigurationServiceChange(g),this._tokenizationTextModelPart.handleLanguageConfigurationServiceChange(g)}))}static _MODEL_SYNC_LIMIT=50*1024*1024;static LARGE_FILE_SIZE_THRESHOLD=20*1024*1024;static LARGE_FILE_LINE_COUNT_THRESHOLD=300*1e3;static LARGE_FILE_HEAP_OPERATION_THRESHOLD=256*1024*1024;static DEFAULT_CREATION_OPTIONS={isForSimpleWidget:!1,tabSize:gs.tabSize,indentSize:gs.indentSize,insertSpaces:gs.insertSpaces,detectIndentation:!1,defaultEOL:1,trimAutoWhitespace:gs.trimAutoWhitespace,largeFileOptimizations:gs.largeFileOptimizations,bracketPairColorizationOptions:gs.bracketPairColorizationOptions};static resolveOptions(t,n){if(n.detectIndentation){let i=YT(t,n.tabSize,n.insertSpaces);return new _u({tabSize:i.tabSize,indentSize:"tabSize",insertSpaces:i.insertSpaces,trimAutoWhitespace:n.trimAutoWhitespace,defaultEOL:n.defaultEOL,bracketPairColorizationOptions:n.bracketPairColorizationOptions})}return new _u(n)}_onWillDispose=this._register(new E);onWillDispose=this._onWillDispose.event;_onDidChangeDecorations=this._register(new bL(t=>this.handleBeforeFireDecorationsChangedEvent(t)));onDidChangeDecorations=this._onDidChangeDecorations.event;get onDidChangeLanguage(){return this._tokenizationTextModelPart.onDidChangeLanguage}get onDidChangeLanguageConfiguration(){return this._tokenizationTextModelPart.onDidChangeLanguageConfiguration}get onDidChangeTokens(){return this._tokenizationTextModelPart.onDidChangeTokens}_onDidChangeOptions=this._register(new E);onDidChangeOptions=this._onDidChangeOptions.event;_onDidChangeAttached=this._register(new E);onDidChangeAttached=this._onDidChangeAttached.event;_onDidChangeInjectedText=this._register(new E);_eventEmitter=this._register(new vL);onDidChangeContent(t){return this._eventEmitter.slowEvent(n=>t(n.contentChangedEvent))}onDidChangeContentOrInjectedText(t){return yr(this._eventEmitter.fastEvent(n=>t(n)),this._onDidChangeInjectedText.event(n=>t(n)))}id;isForSimpleWidget;_associatedResource;_attachedEditorCount;_buffer;_bufferDisposable;_options;_languageSelectionListener=this._register(new Zt);_isDisposed;__isDisposing;_isDisposing(){return this.__isDisposing}_versionId;_alternativeVersionId;_initialUndoRedoSnapshot;_isTooLargeForSyncing;_isTooLargeForTokenization;_isTooLargeForHeapOperation;_commandManager;_isUndoing;_isRedoing;_trimAutoWhitespaceLines;_instanceId;_deltaDecorationCallCnt=0;_lastDecorationId;_decorations;_decorationsTree;_decorationProvider;_tokenizationTextModelPart;get tokenization(){return this._tokenizationTextModelPart}_bracketPairs;get bracketPairs(){return this._bracketPairs}_guidesTextModelPart;get guides(){return this._guidesTextModelPart}_attachedViews=new oI;dispose(){this.__isDisposing=!0,this._onWillDispose.fire(),this._tokenizationTextModelPart.dispose(),this._isDisposed=!0,super.dispose(),this._bufferDisposable.dispose(),this.__isDisposing=!1;let t=new th([],"",`
`,!1,!1,!0,!0);t.dispose(),this._buffer=t,this._bufferDisposable=V.None}_hasListeners(){return this._onWillDispose.hasListeners()||this._onDidChangeDecorations.hasListeners()||this._tokenizationTextModelPart._hasListeners()||this._onDidChangeOptions.hasListeners()||this._onDidChangeAttached.hasListeners()||this._onDidChangeInjectedText.hasListeners()||this._eventEmitter.hasListeners()}_assertNotDisposed(){if(this._isDisposed)throw new Qe("Model is disposed!")}equalsTextBuffer(t){return this._assertNotDisposed(),this._buffer.equals(t)}getTextBuffer(){return this._assertNotDisposed(),this._buffer}_emitContentChangedEvent(t,n){this.__isDisposing||(this._tokenizationTextModelPart.handleDidChangeContent(n),this._bracketPairs.handleDidChangeContent(n),this._eventEmitter.fire(new yl(t,n)))}setValue(t){if(this._assertNotDisposed(),t==null)throw Ql();let{textBuffer:n,disposable:i}=ZN(t,this._options.defaultEOL);this._setValueFromTextBuffer(n,i)}_createContentChanged2(t,n,i,r,s,a,l,d){return{changes:[{range:t,rangeOffset:n,rangeLength:i,text:r}],eol:this._buffer.getEOL(),isEolChange:d,versionId:this.getVersionId(),isUndoing:s,isRedoing:a,isFlush:l}}_setValueFromTextBuffer(t,n){this._assertNotDisposed();let i=this.getFullModelRange(),r=this.getValueLengthInRange(i),s=this.getLineCount(),a=this.getLineMaxColumn(s);this._buffer=t,this._bufferDisposable.dispose(),this._bufferDisposable=n,this._increaseVersionId(),this._decorations=Object.create(null),this._decorationsTree=new cI,this._commandManager.clear(),this._trimAutoWhitespaceLines=null,this._emitContentChangedEvent(new Fd([new Uv],this._versionId,!1,!1),this._createContentChanged2(new D(1,1,s,a),0,r,this.getValue(),!1,!1,!0,!1))}setEOL(t){this._assertNotDisposed();let n=t===1?`\r
`:`
`;if(this._buffer.getEOL()===n)return;let i=this.getFullModelRange(),r=this.getValueLengthInRange(i),s=this.getLineCount(),a=this.getLineMaxColumn(s);this._onBeforeEOLChange(),this._buffer.setEOL(n),this._increaseVersionId(),this._onAfterEOLChange(),this._emitContentChangedEvent(new Fd([new Gv],this._versionId,!1,!1),this._createContentChanged2(new D(1,1,s,a),0,r,this.getValue(),!1,!1,!1,!0))}_onBeforeEOLChange(){this._decorationsTree.ensureAllNodesHaveRanges(this)}_onAfterEOLChange(){let t=this.getVersionId(),n=this._decorationsTree.collectNodesPostOrder();for(let i=0,r=n.length;i<r;i++){let s=n[i],a=s.range,l=s.cachedAbsoluteStart-s.start,d=this._buffer.getOffsetAt(a.startLineNumber,a.startColumn),c=this._buffer.getOffsetAt(a.endLineNumber,a.endColumn);s.cachedAbsoluteStart=d,s.cachedAbsoluteEnd=c,s.cachedVersionId=t,s.start=d-l,s.end=c-l,fa(s)}}onBeforeAttached(){return this._attachedEditorCount++,this._attachedEditorCount===1&&(this._tokenizationTextModelPart.handleDidChangeAttached(),this._onDidChangeAttached.fire(void 0)),this._attachedViews.attachView()}onBeforeDetached(t){this._attachedEditorCount--,this._attachedEditorCount===0&&(this._tokenizationTextModelPart.handleDidChangeAttached(),this._onDidChangeAttached.fire(void 0)),this._attachedViews.detachView(t)}isAttachedToEditor(){return this._attachedEditorCount>0}getAttachedEditorCount(){return this._attachedEditorCount}isTooLargeForSyncing(){return this._isTooLargeForSyncing}isTooLargeForTokenization(){return this._isTooLargeForTokenization}isTooLargeForHeapOperation(){return this._isTooLargeForHeapOperation}isDisposed(){return this._isDisposed}isDominatedByLongLines(){if(this._assertNotDisposed(),this.isTooLargeForTokenization())return!1;let t=0,n=0,i=this._buffer.getLineCount();for(let r=1;r<=i;r++){let s=this._buffer.getLineLength(r);s>=D4?n+=s:t+=s}return n>t}get uri(){return this._associatedResource}getOptions(){return this._assertNotDisposed(),this._options}getFormattingOptions(){return{tabSize:this._options.indentSize,insertSpaces:this._options.insertSpaces}}updateOptions(t){this._assertNotDisposed();let n=typeof t.tabSize<"u"?t.tabSize:this._options.tabSize,i=typeof t.indentSize<"u"?t.indentSize:this._options.originalIndentSize,r=typeof t.insertSpaces<"u"?t.insertSpaces:this._options.insertSpaces,s=typeof t.trimAutoWhitespace<"u"?t.trimAutoWhitespace:this._options.trimAutoWhitespace,a=typeof t.bracketColorizationOptions<"u"?t.bracketColorizationOptions:this._options.bracketPairColorizationOptions,l=new _u({tabSize:n,indentSize:i,insertSpaces:r,defaultEOL:this._options.defaultEOL,trimAutoWhitespace:s,bracketPairColorizationOptions:a});if(this._options.equals(l))return;let d=this._options.createChangeEvent(l);this._options=l,this._bracketPairs.handleDidChangeOptions(d),this._decorationProvider.handleDidChangeOptions(d),this._onDidChangeOptions.fire(d)}detectIndentation(t,n){this._assertNotDisposed();let i=YT(this._buffer,n,t);this.updateOptions({insertSpaces:i.insertSpaces,tabSize:i.tabSize,indentSize:i.tabSize})}normalizeIndentation(t){return this._assertNotDisposed(),Yv(t,this._options.indentSize,this._options.insertSpaces)}getVersionId(){return this._assertNotDisposed(),this._versionId}mightContainRTL(){return this._buffer.mightContainRTL()}mightContainUnusualLineTerminators(){return this._buffer.mightContainUnusualLineTerminators()}removeUnusualLineTerminators(t=null){let n=this.findMatches(Ex.source,!1,!0,!1,null,!1,1073741824);this._buffer.resetMightContainUnusualLineTerminators(),this.pushEditOperations(t,n.map(i=>({range:i.range,text:null})),()=>null)}mightContainNonBasicASCII(){return this._buffer.mightContainNonBasicASCII()}getAlternativeVersionId(){return this._assertNotDisposed(),this._alternativeVersionId}getInitialUndoRedoSnapshot(){return this._assertNotDisposed(),this._initialUndoRedoSnapshot}getOffsetAt(t){this._assertNotDisposed();let n=this._validatePosition(t.lineNumber,t.column,0);return this._buffer.getOffsetAt(n.lineNumber,n.column)}getPositionAt(t){this._assertNotDisposed();let n=Math.min(this._buffer.getLength(),Math.max(0,t));return this._buffer.getPositionAt(n)}_increaseVersionId(){this._versionId=this._versionId+1,this._alternativeVersionId=this._versionId}_overwriteVersionId(t){this._versionId=t}_overwriteAlternativeVersionId(t){this._alternativeVersionId=t}_overwriteInitialUndoRedoSnapshot(t){this._initialUndoRedoSnapshot=t}getValue(t,n=!1){if(this._assertNotDisposed(),this.isTooLargeForHeapOperation())throw new Qe("Operation would exceed heap memory limits");let i=this.getFullModelRange(),r=this.getValueInRange(i,t);return n?this._buffer.getBOM()+r:r}createSnapshot(t=!1){return new pL(this._buffer.createSnapshot(t))}getValueLength(t,n=!1){this._assertNotDisposed();let i=this.getFullModelRange(),r=this.getValueLengthInRange(i,t);return n?this._buffer.getBOM().length+r:r}getValueInRange(t,n=0){return this._assertNotDisposed(),this._buffer.getValueInRange(this.validateRange(t),n)}getValueLengthInRange(t,n=0){return this._assertNotDisposed(),this._buffer.getValueLengthInRange(this.validateRange(t),n)}getCharacterCountInRange(t,n=0){return this._assertNotDisposed(),this._buffer.getCharacterCountInRange(this.validateRange(t),n)}getLineCount(){return this._assertNotDisposed(),this._buffer.getLineCount()}getLineContent(t){if(this._assertNotDisposed(),t<1||t>this.getLineCount())throw new Qe("Illegal value for lineNumber");return this._buffer.getLineContent(t)}getLineLength(t){if(this._assertNotDisposed(),t<1||t>this.getLineCount())throw new Qe("Illegal value for lineNumber");return this._buffer.getLineLength(t)}getLinesContent(){if(this._assertNotDisposed(),this.isTooLargeForHeapOperation())throw new Qe("Operation would exceed heap memory limits");return this._buffer.getLinesContent()}getEOL(){return this._assertNotDisposed(),this._buffer.getEOL()}getEndOfLineSequence(){return this._assertNotDisposed(),this._buffer.getEOL()===`
`?0:1}getLineMinColumn(t){return this._assertNotDisposed(),1}getLineMaxColumn(t){if(this._assertNotDisposed(),t<1||t>this.getLineCount())throw new Qe("Illegal value for lineNumber");return this._buffer.getLineLength(t)+1}getLineFirstNonWhitespaceColumn(t){if(this._assertNotDisposed(),t<1||t>this.getLineCount())throw new Qe("Illegal value for lineNumber");return this._buffer.getLineFirstNonWhitespaceColumn(t)}getLineLastNonWhitespaceColumn(t){if(this._assertNotDisposed(),t<1||t>this.getLineCount())throw new Qe("Illegal value for lineNumber");return this._buffer.getLineLastNonWhitespaceColumn(t)}_validateRangeRelaxedNoAllocations(t){let n=this._buffer.getLineCount(),i=t.startLineNumber,r=t.startColumn,s=Math.floor(typeof i=="number"&&!isNaN(i)?i:1),a=Math.floor(typeof r=="number"&&!isNaN(r)?r:1);if(s<1)s=1,a=1;else if(s>n)s=n,a=this.getLineMaxColumn(s);else if(a<=1)a=1;else{let h=this.getLineMaxColumn(s);a>=h&&(a=h)}let l=t.endLineNumber,d=t.endColumn,c=Math.floor(typeof l=="number"&&!isNaN(l)?l:1),u=Math.floor(typeof d=="number"&&!isNaN(d)?d:1);if(c<1)c=1,u=1;else if(c>n)c=n,u=this.getLineMaxColumn(c);else if(u<=1)u=1;else{let h=this.getLineMaxColumn(c);u>=h&&(u=h)}return i===s&&r===a&&l===c&&d===u&&t instanceof D&&!(t instanceof He)?t:new D(s,a,c,u)}_isValidPosition(t,n,i){if(typeof t!="number"||typeof n!="number"||isNaN(t)||isNaN(n)||t<1||n<1||(t|0)!==t||(n|0)!==n)return!1;let r=this._buffer.getLineCount();if(t>r)return!1;if(n===1)return!0;let s=this.getLineMaxColumn(t);if(n>s)return!1;if(i===1){let a=this._buffer.getLineCharCode(t,n-2);if(Ht(a))return!1}return!0}_validatePosition(t,n,i){let r=Math.floor(typeof t=="number"&&!isNaN(t)?t:1),s=Math.floor(typeof n=="number"&&!isNaN(n)?n:1),a=this._buffer.getLineCount();if(r<1)return new P(1,1);if(r>a)return new P(a,this.getLineMaxColumn(a));if(s<=1)return new P(r,1);let l=this.getLineMaxColumn(r);if(s>=l)return new P(r,l);if(i===1){let d=this._buffer.getLineCharCode(r,s-2);if(Ht(d))return new P(r,s-1)}return new P(r,s)}validatePosition(t){let n=1;return this._assertNotDisposed(),t instanceof P&&this._isValidPosition(t.lineNumber,t.column,n)?t:this._validatePosition(t.lineNumber,t.column,n)}_isValidRange(t,n){let i=t.startLineNumber,r=t.startColumn,s=t.endLineNumber,a=t.endColumn;if(!this._isValidPosition(i,r,0)||!this._isValidPosition(s,a,0))return!1;if(n===1){let l=r>1?this._buffer.getLineCharCode(i,r-2):0,d=a>1&&a<=this._buffer.getLineLength(s)?this._buffer.getLineCharCode(s,a-2):0,c=Ht(l),u=Ht(d);return!c&&!u}return!0}validateRange(t){let n=1;if(this._assertNotDisposed(),t instanceof D&&!(t instanceof He)&&this._isValidRange(t,n))return t;let i=this._validatePosition(t.startLineNumber,t.startColumn,0),r=this._validatePosition(t.endLineNumber,t.endColumn,0),s=i.lineNumber,a=i.column,l=r.lineNumber,d=r.column;if(n===1){let c=a>1?this._buffer.getLineCharCode(s,a-2):0,u=d>1&&d<=this._buffer.getLineLength(l)?this._buffer.getLineCharCode(l,d-2):0,h=Ht(c),m=Ht(u);return!h&&!m?new D(s,a,l,d):s===l&&a===d?new D(s,a-1,l,d-1):h&&m?new D(s,a-1,l,d+1):h?new D(s,a-1,l,d):new D(s,a,l,d+1)}return new D(s,a,l,d)}modifyPosition(t,n){this._assertNotDisposed();let i=this.getOffsetAt(t)+n;return this.getPositionAt(Math.min(this._buffer.getLength(),Math.max(0,i)))}getFullModelRange(){this._assertNotDisposed();let t=this.getLineCount();return new D(1,1,t,this.getLineMaxColumn(t))}findMatchesLineByLine(t,n,i,r){return this._buffer.findMatchesLineByLine(t,n,i,r)}findMatches(t,n,i,r,s,a,l=L4){this._assertNotDisposed();let d=null;n!==null&&(Array.isArray(n)||(n=[n]),n.every(h=>D.isIRange(h))&&(d=n.map(h=>this.validateRange(h)))),d===null&&(d=[this.getFullModelRange()]),d=d.sort((h,m)=>h.startLineNumber-m.startLineNumber||h.startColumn-m.startColumn);let c=[];c.push(d.reduce((h,m)=>D.areIntersecting(h,m)?h.plusRange(m):(c.push(h),m)));let u;if(!i&&t.indexOf(`
`)<0){let m=new ba(t,i,r,s).parseSearchRequest();if(!m)return[];u=f=>this.findMatchesLineByLine(f,m,a,l)}else u=h=>$d.findMatches(this,new ba(t,i,r,s),h,a,l);return c.map(u).reduce((h,m)=>h.concat(m),[])}findNextMatch(t,n,i,r,s,a){this._assertNotDisposed();let l=this.validatePosition(n);if(!i&&t.indexOf(`
`)<0){let c=new ba(t,i,r,s).parseSearchRequest();if(!c)return null;let u=this.getLineCount(),h=new D(l.lineNumber,l.column,u,this.getLineMaxColumn(u)),m=this.findMatchesLineByLine(h,c,a,1);return $d.findNextMatch(this,new ba(t,i,r,s),l,a),m.length>0||(h=new D(1,1,l.lineNumber,this.getLineMaxColumn(l.lineNumber)),m=this.findMatchesLineByLine(h,c,a,1),m.length>0)?m[0]:null}return $d.findNextMatch(this,new ba(t,i,r,s),l,a)}findPreviousMatch(t,n,i,r,s,a){this._assertNotDisposed();let l=this.validatePosition(n);return $d.findPreviousMatch(this,new ba(t,i,r,s),l,a)}pushStackElement(){this._commandManager.pushStackElement()}popStackElement(){this._commandManager.popStackElement()}pushEOL(t){if((this.getEOL()===`
`?0:1)!==t)try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._initialUndoRedoSnapshot===null&&(this._initialUndoRedoSnapshot=this._undoRedoService.createSnapshot(this.uri)),this._commandManager.pushEOL(t)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_validateEditOperation(t){return t instanceof Tu?t:new Tu(t.identifier||null,this.validateRange(t.range),t.text,t.forceMoveMarkers||!1,t.isAutoWhitespaceEdit||!1,t._isTracked||!1)}_validateEditOperations(t){let n=[];for(let i=0,r=t.length;i<r;i++)n[i]=this._validateEditOperation(t[i]);return n}pushEditOperations(t,n,i,r){try{return this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._pushEditOperations(t,this._validateEditOperations(n),i,r)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_pushEditOperations(t,n,i,r){if(this._options.trimAutoWhitespace&&this._trimAutoWhitespaceLines){let s=n.map(l=>({range:this.validateRange(l.range),text:l.text})),a=!0;if(t)for(let l=0,d=t.length;l<d;l++){let c=t[l],u=!1;for(let h=0,m=s.length;h<m;h++){let f=s[h].range,g=f.startLineNumber>c.endLineNumber,b=c.startLineNumber>f.endLineNumber;if(!g&&!b){u=!0;break}}if(!u){a=!1;break}}if(a)for(let l=0,d=this._trimAutoWhitespaceLines.length;l<d;l++){let c=this._trimAutoWhitespaceLines[l],u=this.getLineMaxColumn(c),h=!0;for(let m=0,f=s.length;m<f;m++){let g=s[m].range,b=s[m].text;if(!(c<g.startLineNumber||c>g.endLineNumber)&&!(c===g.startLineNumber&&g.startColumn===u&&g.isEmpty()&&b&&b.length>0&&b.charAt(0)===`
`)&&!(c===g.startLineNumber&&g.startColumn===1&&g.isEmpty()&&b&&b.length>0&&b.charAt(b.length-1)===`
`)){h=!1;break}}if(h){let m=new D(c,1,c,u);n.push(new Tu(null,m,null,!1,!1,!1))}}this._trimAutoWhitespaceLines=null}return this._initialUndoRedoSnapshot===null&&(this._initialUndoRedoSnapshot=this._undoRedoService.createSnapshot(this.uri)),this._commandManager.pushEditOperation(t,n,i,r)}_applyUndo(t,n,i,r){let s=t.map(a=>{let l=this.getPositionAt(a.newPosition),d=this.getPositionAt(a.newEnd);return{range:new D(l.lineNumber,l.column,d.lineNumber,d.column),text:a.oldText}});this._applyUndoRedoEdits(s,n,!0,!1,i,r)}_applyRedo(t,n,i,r){let s=t.map(a=>{let l=this.getPositionAt(a.oldPosition),d=this.getPositionAt(a.oldEnd);return{range:new D(l.lineNumber,l.column,d.lineNumber,d.column),text:a.newText}});this._applyUndoRedoEdits(s,n,!1,!0,i,r)}_applyUndoRedoEdits(t,n,i,r,s,a){try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._isUndoing=i,this._isRedoing=r,this.applyEdits(t,!1),this.setEOL(n),this._overwriteAlternativeVersionId(s)}finally{this._isUndoing=!1,this._isRedoing=!1,this._eventEmitter.endDeferredEmit(a),this._onDidChangeDecorations.endDeferredEmit()}}applyEdits(t,n=!1){try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit();let i=this._validateEditOperations(t);return this._doApplyEdits(i,n)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_doApplyEdits(t,n){let i=this._buffer.getLineCount(),r=this._buffer.applyEdits(t,this._options.trimAutoWhitespace,n),s=this._buffer.getLineCount(),a=r.changes;if(this._trimAutoWhitespaceLines=r.trimAutoWhitespaceLineNumbers,a.length!==0){for(let c=0,u=a.length;c<u;c++){let h=a[c];this._decorationsTree.acceptReplace(h.rangeOffset,h.rangeLength,h.text.length,h.forceMoveMarkers)}let l=[];this._increaseVersionId();let d=i;for(let c=0,u=a.length;c<u;c++){let h=a[c],[m]=io(h.text);this._onDidChangeDecorations.fire();let f=h.range.startLineNumber,g=h.range.endLineNumber,b=g-f,y=m,C=Math.min(b,y),x=y-b,L=s-d-x+f,k=L,O=L+y,W=this._decorationsTree.getInjectedTextInInterval(this,this.getOffsetAt(new P(k,1)),this.getOffsetAt(new P(O,this.getLineMaxColumn(O))),0),z=oo.fromDecorations(W),B=new qi(z);for(let G=C;G>=0;G--){let q=f+G,X=L+G;B.takeFromEndWhile(Ce=>Ce.lineNumber>X);let ce=B.takeFromEndWhile(Ce=>Ce.lineNumber===X);l.push(new Vm(q,this.getLineContent(X),ce))}if(C<b){let G=f+C;l.push(new zv(G+1,g))}if(C<y){let G=new qi(z),q=f+C,X=y-C,ce=s-d-X+q+1,Ce=[],te=[];for(let Z=0;Z<X;Z++){let le=ce+Z;te[Z]=this.getLineContent(le),G.takeWhile(ne=>ne.lineNumber<le),Ce[Z]=G.takeWhile(ne=>ne.lineNumber===le)}l.push(new Kv(q+1,f+y,te,Ce))}d+=x}this._emitContentChangedEvent(new Fd(l,this.getVersionId(),this._isUndoing,this._isRedoing),{changes:a,eol:this._buffer.getEOL(),isEolChange:!1,versionId:this.getVersionId(),isUndoing:this._isUndoing,isRedoing:this._isRedoing,isFlush:!1})}return r.reverseEdits===null?void 0:r.reverseEdits}undo(){return this._undoRedoService.undo(this.uri)}canUndo(){return this._undoRedoService.canUndo(this.uri)}redo(){return this._undoRedoService.redo(this.uri)}canRedo(){return this._undoRedoService.canRedo(this.uri)}handleBeforeFireDecorationsChangedEvent(t){if(t===null||t.size===0)return;let i=Array.from(t).map(r=>new Vm(r,this.getLineContent(r),this._getInjectedTextInLine(r)));this._onDidChangeInjectedText.fire(new Eu(i))}changeDecorations(t,n=0){this._assertNotDisposed();try{return this._onDidChangeDecorations.beginDeferredEmit(),this._changeDecorations(n,t)}finally{this._onDidChangeDecorations.endDeferredEmit()}}_changeDecorations(t,n){let i={addDecoration:(s,a)=>this._deltaDecorationsImpl(t,[],[{range:s,options:a}])[0],changeDecoration:(s,a)=>{this._changeDecorationImpl(s,a)},changeDecorationOptions:(s,a)=>{this._changeDecorationOptionsImpl(s,QN(a))},removeDecoration:s=>{this._deltaDecorationsImpl(t,[s],[])},deltaDecorations:(s,a)=>s.length===0&&a.length===0?[]:this._deltaDecorationsImpl(t,s,a)},r=null;try{r=n(i)}catch(s){je(s)}return i.addDecoration=cg,i.changeDecoration=cg,i.changeDecorationOptions=cg,i.removeDecoration=cg,i.deltaDecorations=cg,r}deltaDecorations(t,n,i=0){if(this._assertNotDisposed(),t||(t=[]),t.length===0&&n.length===0)return[];try{return this._deltaDecorationCallCnt++,this._deltaDecorationCallCnt>1&&(console.warn("Invoking deltaDecorations recursively could lead to leaking decorations."),je(new Error("Invoking deltaDecorations recursively could lead to leaking decorations."))),this._onDidChangeDecorations.beginDeferredEmit(),this._deltaDecorationsImpl(i,t,n)}finally{this._onDidChangeDecorations.endDeferredEmit(),this._deltaDecorationCallCnt--}}_getTrackedRange(t){return this.getDecorationRange(t)}_setTrackedRange(t,n,i){let r=t?this._decorations[t]:null;if(!r)return n?this._deltaDecorationsImpl(0,[],[{range:n,options:XN[i]}],!0)[0]:null;if(!n)return this._decorationsTree.delete(r),delete this._decorations[r.id],null;let s=this._validateRangeRelaxedNoAllocations(n),a=this._buffer.getOffsetAt(s.startLineNumber,s.startColumn),l=this._buffer.getOffsetAt(s.endLineNumber,s.endColumn);return this._decorationsTree.delete(r),r.reset(this.getVersionId(),a,l,s),r.setOptions(XN[i]),this._decorationsTree.insert(r),r.id}removeAllDecorationsWithOwnerId(t){if(this._isDisposed)return;let n=this._decorationsTree.collectNodesFromOwner(t);for(let i=0,r=n.length;i<r;i++){let s=n[i];this._decorationsTree.delete(s),delete this._decorations[s.id]}}getDecorationOptions(t){let n=this._decorations[t];return n?n.options:null}getDecorationRange(t){let n=this._decorations[t];return n?this._decorationsTree.getNodeRange(this,n):null}getLineDecorations(t,n=0,i=!1){return t<1||t>this.getLineCount()?[]:this.getLinesDecorations(t,t,n,i)}getLinesDecorations(t,n,i=0,r=!1,s=!1){let a=this.getLineCount(),l=Math.min(a,Math.max(1,t)),d=Math.min(a,Math.max(1,n)),c=this.getLineMaxColumn(d),u=new D(l,1,d,c),h=this._getDecorationsInRange(u,i,r,s);return jw(h,this._decorationProvider.getDecorationsInRange(u,i,r)),h}getDecorationsInRange(t,n=0,i=!1,r=!1,s=!1){let a=this.validateRange(t),l=this._getDecorationsInRange(a,n,i,s);return jw(l,this._decorationProvider.getDecorationsInRange(a,n,i,r)),l}getOverviewRulerDecorations(t=0,n=!1){return this._decorationsTree.getAll(this,t,n,!0,!1)}getInjectedTextDecorations(t=0){return this._decorationsTree.getAllInjectedText(this,t)}_getInjectedTextInLine(t){let n=this._buffer.getOffsetAt(t,1),i=n+this._buffer.getLineLength(t),r=this._decorationsTree.getInjectedTextInInterval(this,n,i,0);return oo.fromDecorations(r).filter(s=>s.lineNumber===t)}getAllDecorations(t=0,n=!1){let i=this._decorationsTree.getAll(this,t,n,!1,!1);return i=i.concat(this._decorationProvider.getAllDecorations(t,n)),i}getAllMarginDecorations(t=0){return this._decorationsTree.getAll(this,t,!1,!1,!0)}_getDecorationsInRange(t,n,i,r){let s=this._buffer.getOffsetAt(t.startLineNumber,t.startColumn),a=this._buffer.getOffsetAt(t.endLineNumber,t.endColumn);return this._decorationsTree.getAllInInterval(this,s,a,n,i,r)}getRangeAt(t,n){return this._buffer.getRangeAt(t,n-t)}_changeDecorationImpl(t,n){let i=this._decorations[t];if(!i)return;if(i.options.after){let l=this.getDecorationRange(t);this._onDidChangeDecorations.recordLineAffectedByInjectedText(l.endLineNumber)}if(i.options.before){let l=this.getDecorationRange(t);this._onDidChangeDecorations.recordLineAffectedByInjectedText(l.startLineNumber)}let r=this._validateRangeRelaxedNoAllocations(n),s=this._buffer.getOffsetAt(r.startLineNumber,r.startColumn),a=this._buffer.getOffsetAt(r.endLineNumber,r.endColumn);this._decorationsTree.delete(i),i.reset(this.getVersionId(),s,a,r),this._decorationsTree.insert(i),this._onDidChangeDecorations.checkAffectedAndFire(i.options),i.options.after&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(r.endLineNumber),i.options.before&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(r.startLineNumber)}_changeDecorationOptionsImpl(t,n){let i=this._decorations[t];if(!i)return;let r=!!(i.options.overviewRuler&&i.options.overviewRuler.color),s=!!(n.overviewRuler&&n.overviewRuler.color);if(this._onDidChangeDecorations.checkAffectedAndFire(i.options),this._onDidChangeDecorations.checkAffectedAndFire(n),i.options.after||n.after){let d=this._decorationsTree.getNodeRange(this,i);this._onDidChangeDecorations.recordLineAffectedByInjectedText(d.endLineNumber)}if(i.options.before||n.before){let d=this._decorationsTree.getNodeRange(this,i);this._onDidChangeDecorations.recordLineAffectedByInjectedText(d.startLineNumber)}let a=r!==s,l=R4(n)!==dI(i);a||l?(this._decorationsTree.delete(i),i.setOptions(n),this._decorationsTree.insert(i)):i.setOptions(n)}_deltaDecorationsImpl(t,n,i,r=!1){let s=this.getVersionId(),a=n.length,l=0,d=i.length,c=0;this._onDidChangeDecorations.beginDeferredEmit();try{let u=new Array(d);for(;l<a||c<d;){let h=null;if(l<a){do h=this._decorations[n[l++]];while(!h&&l<a);if(h){if(h.options.after){let m=this._decorationsTree.getNodeRange(this,h);this._onDidChangeDecorations.recordLineAffectedByInjectedText(m.endLineNumber)}if(h.options.before){let m=this._decorationsTree.getNodeRange(this,h);this._onDidChangeDecorations.recordLineAffectedByInjectedText(m.startLineNumber)}this._decorationsTree.delete(h),r||this._onDidChangeDecorations.checkAffectedAndFire(h.options)}}if(c<d){if(!h){let C=++this._lastDecorationId,x=`${this._instanceId};${C}`;h=new ig(x,0,0),this._decorations[x]=h}let m=i[c],f=this._validateRangeRelaxedNoAllocations(m.range),g=QN(m.options),b=this._buffer.getOffsetAt(f.startLineNumber,f.startColumn),y=this._buffer.getOffsetAt(f.endLineNumber,f.endColumn);h.ownerId=t,h.reset(s,b,y,f),h.setOptions(g),h.options.after&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(f.endLineNumber),h.options.before&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(f.startLineNumber),r||this._onDidChangeDecorations.checkAffectedAndFire(g),this._decorationsTree.insert(h),u[c]=h.id,c++}else h&&delete this._decorations[h.id]}return u}finally{this._onDidChangeDecorations.endDeferredEmit()}}getLanguageId(){return this.tokenization.getLanguageId()}setLanguage(t,n){typeof t=="string"?(this._languageSelectionListener.clear(),this._setLanguage(t,n)):(this._languageSelectionListener.value=t.onDidChange(()=>this._setLanguage(t.languageId,n)),this._setLanguage(t.languageId,n))}_setLanguage(t,n){this.tokenization.setLanguageId(t,n),this._languageService.requestRichLanguageFeatures(t)}getLanguageIdAtPosition(t,n){return this.tokenization.getLanguageIdAtPosition(t,n)}getWordAtPosition(t){return this._tokenizationTextModelPart.getWordAtPosition(t)}getWordUntilPosition(t){return this._tokenizationTextModelPart.getWordUntilPosition(t)}normalizePosition(t,n){return t}getLineIndentColumn(t){return k4(this.getLineContent(t))+1}};As=R([S(4,qM),S(5,Bi),S(6,ca),S(7,ct)],As);function k4(o){let e=0;for(let t of o)if(t===" "||t==="	")e++;else break;return e}function hL(o){return!!(o.options.overviewRuler&&o.options.overviewRuler.color)}function R4(o){return!!o.after||!!o.before}function dI(o){return!!o.options.after||!!o.options.before}var cI=class{_decorationsTree0;_decorationsTree1;_injectedTextDecorationsTree;constructor(){this._decorationsTree0=new Ju,this._decorationsTree1=new Ju,this._injectedTextDecorationsTree=new Ju}ensureAllNodesHaveRanges(e){this.getAll(e,0,!1,!1,!1)}_ensureNodesHaveRanges(e,t){for(let n of t)n.range===null&&(n.range=e.getRangeAt(n.cachedAbsoluteStart,n.cachedAbsoluteEnd));return t}getAllInInterval(e,t,n,i,r,s){let a=e.getVersionId(),l=this._intervalSearch(t,n,i,r,a,s);return this._ensureNodesHaveRanges(e,l)}_intervalSearch(e,t,n,i,r,s){let a=this._decorationsTree0.intervalSearch(e,t,n,i,r,s),l=this._decorationsTree1.intervalSearch(e,t,n,i,r,s),d=this._injectedTextDecorationsTree.intervalSearch(e,t,n,i,r,s);return a.concat(l).concat(d)}getInjectedTextInInterval(e,t,n,i){let r=e.getVersionId(),s=this._injectedTextDecorationsTree.intervalSearch(t,n,i,!1,r,!1);return this._ensureNodesHaveRanges(e,s).filter(a=>a.options.showIfCollapsed||!a.range.isEmpty())}getAllInjectedText(e,t){let n=e.getVersionId(),i=this._injectedTextDecorationsTree.search(t,!1,n,!1);return this._ensureNodesHaveRanges(e,i).filter(r=>r.options.showIfCollapsed||!r.range.isEmpty())}getAll(e,t,n,i,r){let s=e.getVersionId(),a=this._search(t,n,i,s,r);return this._ensureNodesHaveRanges(e,a)}_search(e,t,n,i,r){if(n)return this._decorationsTree1.search(e,t,i,r);{let s=this._decorationsTree0.search(e,t,i,r),a=this._decorationsTree1.search(e,t,i,r),l=this._injectedTextDecorationsTree.search(e,t,i,r);return s.concat(a).concat(l)}}collectNodesFromOwner(e){let t=this._decorationsTree0.collectNodesFromOwner(e),n=this._decorationsTree1.collectNodesFromOwner(e),i=this._injectedTextDecorationsTree.collectNodesFromOwner(e);return t.concat(n).concat(i)}collectNodesPostOrder(){let e=this._decorationsTree0.collectNodesPostOrder(),t=this._decorationsTree1.collectNodesPostOrder(),n=this._injectedTextDecorationsTree.collectNodesPostOrder();return e.concat(t).concat(n)}insert(e){dI(e)?this._injectedTextDecorationsTree.insert(e):hL(e)?this._decorationsTree1.insert(e):this._decorationsTree0.insert(e)}delete(e){dI(e)?this._injectedTextDecorationsTree.delete(e):hL(e)?this._decorationsTree1.delete(e):this._decorationsTree0.delete(e)}getNodeRange(e,t){let n=e.getVersionId();return t.cachedVersionId!==n&&this._resolveNode(t,n),t.range===null&&(t.range=e.getRangeAt(t.cachedAbsoluteStart,t.cachedAbsoluteEnd)),t.range}_resolveNode(e,t){dI(e)?this._injectedTextDecorationsTree.resolveNode(e,t):hL(e)?this._decorationsTree1.resolveNode(e,t):this._decorationsTree0.resolveNode(e,t)}acceptReplace(e,t,n,i){this._decorationsTree0.acceptReplace(e,t,n,i),this._decorationsTree1.acceptReplace(e,t,n,i),this._injectedTextDecorationsTree.acceptReplace(e,t,n,i)}};function Ms(o){return o.replace(/[^a-z0-9\-_]/gi," ")}var uI=class{color;darkColor;constructor(e){this.color=e.color||"",this.darkColor=e.darkColor||""}},mL=class extends uI{position;_resolvedColor;constructor(e){super(e),this._resolvedColor=null,this.position=typeof e.position=="number"?e.position:2}getColor(e){return this._resolvedColor||(e.type!=="light"&&this.darkColor?this._resolvedColor=this._resolveColor(this.darkColor,e):this._resolvedColor=this._resolveColor(this.color,e)),this._resolvedColor}invalidateCachedColor(){this._resolvedColor=null}_resolveColor(e,t){if(typeof e=="string")return e;let n=e?t.getColor(e.id):null;return n?n.toString():""}},gL=class{position;persistLane;constructor(e){this.position=e?.position??2,this.persistLane=e?.persistLane}},fL=class extends uI{position;sectionHeaderStyle;sectionHeaderText;_resolvedColor;constructor(e){super(e),this.position=e.position,this.sectionHeaderStyle=e.sectionHeaderStyle??null,this.sectionHeaderText=e.sectionHeaderText??null}getColor(e){return this._resolvedColor||(e.type!=="light"&&this.darkColor?this._resolvedColor=this._resolveColor(this.darkColor,e):this._resolvedColor=this._resolveColor(this.color,e)),this._resolvedColor}invalidateCachedColor(){this._resolvedColor=void 0}_resolveColor(e,t){return typeof e=="string"?N.fromHex(e):t.getColor(e.id)}},hI=class o{static from(e){return e instanceof o?e:new o(e)}content;tokens;inlineClassName;inlineClassNameAffectsLetterSpacing;attachedData;cursorStops;constructor(e){this.content=e.content||"",this.tokens=e.tokens??null,this.inlineClassName=e.inlineClassName||null,this.inlineClassNameAffectsLetterSpacing=e.inlineClassNameAffectsLetterSpacing||!1,this.attachedData=e.attachedData||null,this.cursorStops=e.cursorStops||null}},ao=class o{static EMPTY;static register(e){return new o(e)}static createDynamic(e){return new o(e)}description;blockClassName;blockIsAfterEnd;blockDoesNotCollapse;blockPadding;stickiness;zIndex;className;shouldFillLineOnLineBreak;hoverMessage;glyphMarginHoverMessage;isWholeLine;showIfCollapsed;collapseOnReplaceEdit;overviewRuler;minimap;glyphMargin;glyphMarginClassName;linesDecorationsClassName;lineNumberClassName;lineNumberHoverMessage;linesDecorationsTooltip;firstLineDecorationClassName;marginClassName;inlineClassName;inlineClassNameAffectsLetterSpacing;beforeContentClassName;afterContentClassName;after;before;hideInCommentTokens;hideInStringTokens;constructor(e){this.description=e.description,this.blockClassName=e.blockClassName?Ms(e.blockClassName):null,this.blockDoesNotCollapse=e.blockDoesNotCollapse??null,this.blockIsAfterEnd=e.blockIsAfterEnd??null,this.blockPadding=e.blockPadding??null,this.stickiness=e.stickiness||0,this.zIndex=e.zIndex||0,this.className=e.className?Ms(e.className):null,this.shouldFillLineOnLineBreak=e.shouldFillLineOnLineBreak??null,this.hoverMessage=e.hoverMessage||null,this.glyphMarginHoverMessage=e.glyphMarginHoverMessage||null,this.lineNumberHoverMessage=e.lineNumberHoverMessage||null,this.isWholeLine=e.isWholeLine||!1,this.showIfCollapsed=e.showIfCollapsed||!1,this.collapseOnReplaceEdit=e.collapseOnReplaceEdit||!1,this.overviewRuler=e.overviewRuler?new mL(e.overviewRuler):null,this.minimap=e.minimap?new fL(e.minimap):null,this.glyphMargin=e.glyphMarginClassName?new gL(e.glyphMargin):null,this.glyphMarginClassName=e.glyphMarginClassName?Ms(e.glyphMarginClassName):null,this.linesDecorationsClassName=e.linesDecorationsClassName?Ms(e.linesDecorationsClassName):null,this.lineNumberClassName=e.lineNumberClassName?Ms(e.lineNumberClassName):null,this.linesDecorationsTooltip=e.linesDecorationsTooltip?xk(e.linesDecorationsTooltip):null,this.firstLineDecorationClassName=e.firstLineDecorationClassName?Ms(e.firstLineDecorationClassName):null,this.marginClassName=e.marginClassName?Ms(e.marginClassName):null,this.inlineClassName=e.inlineClassName?Ms(e.inlineClassName):null,this.inlineClassNameAffectsLetterSpacing=e.inlineClassNameAffectsLetterSpacing||!1,this.beforeContentClassName=e.beforeContentClassName?Ms(e.beforeContentClassName):null,this.afterContentClassName=e.afterContentClassName?Ms(e.afterContentClassName):null,this.after=e.after?hI.from(e.after):null,this.before=e.before?hI.from(e.before):null,this.hideInCommentTokens=e.hideInCommentTokens??!1,this.hideInStringTokens=e.hideInStringTokens??!1}};ao.EMPTY=ao.register({description:"empty"});var XN=[ao.register({description:"tracked-range-always-grows-when-typing-at-edges",stickiness:0}),ao.register({description:"tracked-range-never-grows-when-typing-at-edges",stickiness:1}),ao.register({description:"tracked-range-grows-only-when-typing-before",stickiness:2}),ao.register({description:"tracked-range-grows-only-when-typing-after",stickiness:3})];function QN(o){return o instanceof ao?o:ao.createDynamic(o)}var bL=class extends V{constructor(t){super();this.handleBeforeFire=t;this._deferredCnt=0,this._shouldFireDeferred=!1,this._affectsMinimap=!1,this._affectsOverviewRuler=!1,this._affectsGlyphMargin=!1,this._affectsLineNumber=!1}_actual=this._register(new E);event=this._actual.event;_deferredCnt;_shouldFireDeferred;_affectsMinimap;_affectsOverviewRuler;_affectedInjectedTextLines=null;_affectsGlyphMargin;_affectsLineNumber;hasListeners(){return this._actual.hasListeners()}beginDeferredEmit(){this._deferredCnt++}endDeferredEmit(){this._deferredCnt--,this._deferredCnt===0&&(this._shouldFireDeferred&&this.doFire(),this._affectedInjectedTextLines?.clear(),this._affectedInjectedTextLines=null)}recordLineAffectedByInjectedText(t){this._affectedInjectedTextLines||(this._affectedInjectedTextLines=new Set),this._affectedInjectedTextLines.add(t)}checkAffectedAndFire(t){this._affectsMinimap||=!!t.minimap?.position,this._affectsOverviewRuler||=!!t.overviewRuler?.color,this._affectsGlyphMargin||=!!t.glyphMarginClassName,this._affectsLineNumber||=!!t.lineNumberClassName,this.tryFire()}fire(){this._affectsMinimap=!0,this._affectsOverviewRuler=!0,this._affectsGlyphMargin=!0,this.tryFire()}tryFire(){this._deferredCnt===0?this.doFire():this._shouldFireDeferred=!0}doFire(){this.handleBeforeFire(this._affectedInjectedTextLines);let t={affectsMinimap:this._affectsMinimap,affectsOverviewRuler:this._affectsOverviewRuler,affectsGlyphMargin:this._affectsGlyphMargin,affectsLineNumber:this._affectsLineNumber};this._shouldFireDeferred=!1,this._affectsMinimap=!1,this._affectsOverviewRuler=!1,this._affectsGlyphMargin=!1,this._actual.fire(t)}},vL=class extends V{_fastEmitter=this._register(new E);fastEvent=this._fastEmitter.event;_slowEmitter=this._register(new E);slowEvent=this._slowEmitter.event;_deferredCnt;_deferredEvent;constructor(){super(),this._deferredCnt=0,this._deferredEvent=null}hasListeners(){return this._fastEmitter.hasListeners()||this._slowEmitter.hasListeners()}beginDeferredEmit(){this._deferredCnt++}endDeferredEmit(e=null){if(this._deferredCnt--,this._deferredCnt===0&&this._deferredEvent!==null){this._deferredEvent.rawContentChangedEvent.resultingSelection=e;let t=this._deferredEvent;this._deferredEvent=null,this._fastEmitter.fire(t),this._slowEmitter.fire(t)}}fire(e){if(this._deferredCnt>0){this._deferredEvent?this._deferredEvent=this._deferredEvent.merge(e):this._deferredEvent=e;return}this._fastEmitter.fire(e),this._slowEmitter.fire(e)}};var kl=Y("workingCopyService"),IL=class extends V{_onDidRegister=this._register(new E);onDidRegister=this._onDidRegister.event;_onDidUnregister=this._register(new E);onDidUnregister=this._onDidUnregister.event;_onDidChangeDirty=this._register(new E);onDidChangeDirty=this._onDidChangeDirty.event;_onDidChangeContent=this._register(new E);onDidChangeContent=this._onDidChangeContent.event;_onDidSave=this._register(new E);onDidSave=this._onDidSave.event;get workingCopies(){return Array.from(this._workingCopies.values())}_workingCopies=new Set;mapResourceToWorkingCopies=new Ai;mapWorkingCopyToListeners=this._register(new Fo);registerWorkingCopy(e){let t=this.mapResourceToWorkingCopies.get(e.resource);if(t?.has(e.typeId))throw new Error(`Cannot register more than one working copy with the same resource ${e.resource.toString()} and type ${e.typeId}.`);this._workingCopies.add(e),t||(t=new Map,this.mapResourceToWorkingCopies.set(e.resource,t)),t.set(e.typeId,e);let n=new he;return n.add(e.onDidChangeContent(()=>this._onDidChangeContent.fire(e))),n.add(e.onDidChangeDirty(()=>this._onDidChangeDirty.fire(e))),n.add(e.onDidSave(i=>this._onDidSave.fire({workingCopy:e,...i}))),this.mapWorkingCopyToListeners.set(e,n),this._onDidRegister.fire(e),e.isDirty()&&this._onDidChangeDirty.fire(e),ve(()=>{this.unregisterWorkingCopy(e),this._onDidUnregister.fire(e)})}unregisterWorkingCopy(e){this._workingCopies.delete(e);let t=this.mapResourceToWorkingCopies.get(e.resource);t?.delete(e.typeId)&&t.size===0&&this.mapResourceToWorkingCopies.delete(e.resource),e.isDirty()&&this._onDidChangeDirty.fire(e),this.mapWorkingCopyToListeners.deleteAndDispose(e)}has(e){return ie.isUri(e)?this.mapResourceToWorkingCopies.has(e):this.mapResourceToWorkingCopies.get(e.resource)?.has(e.typeId)??!1}get(e){return this.mapResourceToWorkingCopies.get(e.resource)?.get(e.typeId)}getAll(e){let t=this.mapResourceToWorkingCopies.get(e);if(t)return Array.from(t.values())}get hasDirty(){for(let e of this._workingCopies)if(e.isDirty())return!0;return!1}get dirtyCount(){let e=0;for(let t of this._workingCopies)t.isDirty()&&e++;return e}get dirtyWorkingCopies(){return this.workingCopies.filter(e=>e.isDirty())}get modifiedCount(){let e=0;for(let t of this._workingCopies)t.isModified()&&e++;return e}get modifiedWorkingCopies(){return this.workingCopies.filter(e=>e.isModified())}isDirty(e,t){let n=this.mapResourceToWorkingCopies.get(e);if(n){if(typeof t=="string")return n.get(t)?.isDirty()??!1;for(let[,i]of n)if(i.isDirty())return!0}return!1}};fi(kl,IL,1);var Wr=Y("labelService");var eP=Y("productService");var hg=Y("dialogService");var RLe=Y("fileDialogService");var Hr=class extends pg{_onDidChangeDirty=this._register(new E);_onDidChangeLabel=this._register(new E);_onDidChangeCapabilities=this._register(new E);_onWillDispose=this._register(new E);onDidChangeDirty=this._onDidChangeDirty.event;onDidChangeLabel=this._onDidChangeLabel.event;onDidChangeCapabilities=this._onDidChangeCapabilities.event;onWillDispose=this._onWillDispose.event;closeHandler;get editorId(){}get capabilities(){return 2}hasCapability(e){return e===0?this.capabilities===0:(this.capabilities&e)!==0}isReadonly(){return this.hasCapability(2)}getName(){return`Editor ${this.typeId}`}getDescription(e){}getTitle(e){return this.getName()}getLabelExtraClasses(){return[]}getAriaLabel(){return this.getTitle(0)}getIcon(){}getTelemetryDescriptor(){return{typeId:this.typeId}}isDirty(){return!1}isModified(){return this.isDirty()}isSaving(){return!1}async resolve(){return null}async save(e,t){return this}async saveAs(e,t){return this}async revert(e,t){}async rename(e,t){}copy(){return this}canMove(e,t){return!0}matches(e){if(ti(e))return this===e;let t=e.options?.override;return this.editorId!==t&&t!==void 0&&this.editorId!==void 0?!1:Yn(this.resource,Ia.getCanonicalUri(e))}prefersEditorPane(e){return e.at(0)}toUntyped(e){}isDisposed(){return this._store.isDisposed}dispose(){this.isDisposed()||this._onWillDispose.fire(),super.dispose()}};var Lo=class extends Hr{constructor(t,n,i,r,s){super();this.preferredName=t;this.preferredDescription=n;this.secondary=i;this.primary=r;this.editorService=s;this.registerListeners()}static ID="workbench.editorinputs.sidebysideEditorInput";get typeId(){return Lo.ID}get capabilities(){let t=this.primary.capabilities;return t&=-33,this.secondary.hasCapability(16)&&(t|=16),this.secondary.hasCapability(8)&&(t|=8),t|=256,t}get resource(){if(this.hasIdenticalSides)return this.primary.resource}hasIdenticalSides=this.primary.matches(this.secondary);registerListeners(){this._register(oe.once(oe.any(this.primary.onWillDispose,this.secondary.onWillDispose))(()=>{this.isDisposed()||this.dispose()})),this._register(this.primary.onDidChangeDirty(()=>this._onDidChangeDirty.fire())),this._register(this.primary.onDidChangeCapabilities(()=>this._onDidChangeCapabilities.fire())),this._register(this.secondary.onDidChangeCapabilities(()=>this._onDidChangeCapabilities.fire())),this._register(this.primary.onDidChangeLabel(()=>this._onDidChangeLabel.fire())),this._register(this.secondary.onDidChangeLabel(()=>this._onDidChangeLabel.fire()))}getName(){let t=this.getPreferredName();return t||(this.hasIdenticalSides?this.primary.getName():p("sideBySideLabels","{0} - {1}",this.secondary.getName(),this.primary.getName()))}getPreferredName(){return this.preferredName}getDescription(t){let n=this.getPreferredDescription();return n||(this.hasIdenticalSides?this.primary.getDescription(t):super.getDescription(t))}getPreferredDescription(){return this.preferredDescription}getTitle(t){let n;this.hasIdenticalSides?n=this.primary.getTitle(t)??this.getName():n=super.getTitle(t);let i=this.getPreferredTitle();return i&&(n=`${i} (${n})`),n}getPreferredTitle(){if(this.preferredName&&this.preferredDescription)return`${this.preferredName} ${this.preferredDescription}`;if(this.preferredName||this.preferredDescription)return this.preferredName??this.preferredDescription}getLabelExtraClasses(){return this.hasIdenticalSides?this.primary.getLabelExtraClasses():super.getLabelExtraClasses()}getAriaLabel(){return this.hasIdenticalSides?this.primary.getAriaLabel():super.getAriaLabel()}getTelemetryDescriptor(){return{...this.primary.getTelemetryDescriptor(),...super.getTelemetryDescriptor()}}isDirty(){return this.primary.isDirty()}isSaving(){return this.primary.isSaving()}async save(t,n){let i=await this.primary.save(t,n);return this.saveResultToEditor(i)}async saveAs(t,n){let i=await this.primary.saveAs(t,n);return this.saveResultToEditor(i)}saveResultToEditor(t){if(!t||!this.hasIdenticalSides)return t;if(this.primary.matches(t))return this;if(t instanceof Hr)return new Lo(this.preferredName,this.preferredDescription,t,t,this.editorService);if(!Ca(t)&&!ah(t)&&!Rl(t)&&!Ml(t))return{primary:t,secondary:t,label:this.preferredName,description:this.preferredDescription}}revert(t,n){return this.primary.revert(t,n)}async rename(t,n){if(!this.hasIdenticalSides)return;let i=await this.primary.rename(t,n);if(i){if(ti(i.editor))return{editor:new Lo(this.preferredName,this.preferredDescription,i.editor,i.editor,this.editorService),options:{...i.options,viewState:sh(this,t,this.editorService)}};if(pI(i.editor))return{editor:{label:this.preferredName,description:this.preferredDescription,primary:i.editor,secondary:i.editor,options:{...i.options,viewState:sh(this,t,this.editorService)}}}}}isReadonly(){return this.primary.isReadonly()}toUntyped(t){let n=this.primary.toUntyped(t),i=this.secondary.toUntyped(t);if(n&&i&&!Ca(n)&&!Ca(i)&&!ah(n)&&!ah(i)&&!Rl(n)&&!Rl(i)&&!Ml(n)&&!Ml(i)){let r={label:this.preferredName,description:this.preferredDescription,primary:n,secondary:i};return typeof t?.preserveViewState=="number"&&(r.options={viewState:sh(this,t.preserveViewState,this.editorService)}),r}}matches(t){return this===t?!0:CL(t)||Ca(t)?!1:t instanceof Lo?this.primary.matches(t.primary)&&this.secondary.matches(t.secondary):Rl(t)?this.primary.matches(t.primary)&&this.secondary.matches(t.secondary):!1}};Lo=R([S(4,gn)],Lo);var SL={LEFT:"left",RIGHT:"right",FIRST:"first",LAST:"last"};function A4(o){let e=o;return!!(e&&typeof e=="object"&&Array.isArray(e.editors)&&Array.isArray(e.mru))}var Os=class extends V{constructor(t,n,i){super();this.instantiationService=n;this.configurationService=i;A4(t)?this._id=this.deserialize(t):this._id=Os.IDS++,this.onConfigurationUpdated(),this.registerListeners()}static IDS=0;_onDidModelChange=this._register(new E({leakWarningThreshold:500}));onDidModelChange=this._onDidModelChange.event;_id;get id(){return this._id}editors=[];mru=[];editorListeners=new Set;locked=!1;selection=[];get active(){return this.selection[0]??null}preview=null;sticky=-1;transient=new Set;editorOpenPositioning;focusRecentEditorAfterClose;registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(t=>this.onConfigurationUpdated(t)))}onConfigurationUpdated(t){t&&!t.affectsConfiguration("workbench.editor.openPositioning")&&!t.affectsConfiguration("workbench.editor.focusRecentEditorAfterClose")||(this.editorOpenPositioning=this.configurationService.getValue("workbench.editor.openPositioning"),this.focusRecentEditorAfterClose=this.configurationService.getValue("workbench.editor.focusRecentEditorAfterClose"))}get count(){return this.editors.length}get stickyCount(){return this.sticky+1}getEditors(t,n){let i=t===0?this.mru.slice(0):this.editors.slice(0);return n?.excludeSticky?t===0?i.filter(r=>!this.isSticky(r)):i.slice(this.sticky+1):i}getEditorByIndex(t){return this.editors[t]}get activeEditor(){return this.active}isActive(t){return this.matches(this.active,t)}get previewEditor(){return this.preview}openEditor(t,n){let i=n?.sticky||typeof n?.index=="number"&&this.isSticky(n.index),r=n?.pinned||n?.sticky,s=!!n?.transient,a=n?.active||!this.activeEditor||!r&&this.preview===this.activeEditor,l=this.findEditor(t,n);if(l){let[d,c]=l;return this.doSetTransient(d,c,s===!1?!1:this.isTransient(d)),r&&this.doPin(d,c),this.setSelection(a?d:this.activeEditor,n?.inactiveSelection??[]),n&&typeof n.index=="number"&&this.moveEditor(d,n.index),i&&this.doStick(d,this.indexOf(d)),{editor:d,isNew:!1}}else{let d=t,c=this.indexOf(this.active),u;if(n&&typeof n.index=="number"?u=n.index:this.editorOpenPositioning===SL.FIRST?(u=0,!i&&this.isSticky(u)&&(u=this.sticky+1)):this.editorOpenPositioning===SL.LAST?u=this.editors.length:(this.editorOpenPositioning===SL.LEFT?c===0||!this.editors.length?u=0:u=c:u=c+1,!i&&this.isSticky(u)&&(u=this.sticky+1)),i&&(this.sticky++,this.isSticky(u)||(u=this.sticky)),(r||!this.preview)&&this.splice(u,!1,d),s&&this.doSetTransient(d,u,!0),!r){if(this.preview){let m=this.indexOf(this.preview);u>m&&u--,this.replaceEditor(this.preview,d,u,!a)}this.preview=d}this.registerEditorListeners(d);let h={kind:5,editor:d,editorIndex:u};return this._onDidModelChange.fire(h),this.setSelection(a?d:this.activeEditor,n?.inactiveSelection??[]),{editor:d,isNew:!0}}}registerEditorListeners(t){let n=new he;this.editorListeners.add(n),n.add(oe.once(t.onWillDispose)(()=>{let i=this.editors.indexOf(t);if(i>=0){let r={kind:15,editor:t,editorIndex:i};this._onDidModelChange.fire(r)}})),n.add(t.onDidChangeDirty(()=>{let i={kind:14,editor:t,editorIndex:this.editors.indexOf(t)};this._onDidModelChange.fire(i)})),n.add(t.onDidChangeLabel(()=>{let i={kind:9,editor:t,editorIndex:this.editors.indexOf(t)};this._onDidModelChange.fire(i)})),n.add(t.onDidChangeCapabilities(()=>{let i={kind:10,editor:t,editorIndex:this.editors.indexOf(t)};this._onDidModelChange.fire(i)})),n.add(this.onDidModelChange(i=>{i.kind===6&&i.editor?.matches(t)&&(kt(n),this.editorListeners.delete(n))}))}replaceEditor(t,n,i,r=!0){let s=this.doCloseEditor(t,1,r);if(this.splice(i,!1,n),s){let a={kind:6,...s};this._onDidModelChange.fire(a)}}closeEditor(t,n=0,i=!0){let r=this.doCloseEditor(t,n,i);if(r){let s={kind:6,...r};return this._onDidModelChange.fire(s),r}}doCloseEditor(t,n,i){let r=this.indexOf(t);if(r===-1)return;let s=this.editors[r],a=this.isSticky(r),l=this.active===s;if(i&&l)if(this.mru.length>1){let d;this.focusRecentEditorAfterClose?d=this.mru[1]:r===this.editors.length-1?d=this.editors[r-1]:d=this.editors[r+1];let c=this.selection.filter(u=>u!==s&&u!==d);this.doSetSelection(d,this.editors.indexOf(d),c)}else this.doSetSelection(null,void 0,[]);else if(!l&&this.doIsSelected(s)){let d=this.selection.filter(c=>c!==s&&c!==this.activeEditor);this.doSetSelection(this.activeEditor,this.indexOf(this.activeEditor),d)}return this.preview===s&&(this.preview=null),this.transient.delete(s),this.splice(r,!0),{editor:s,sticky:a,editorIndex:r,context:n}}moveEditor(t,n){n>=this.editors.length?n=this.editors.length-1:n<0&&(n=0);let i=this.indexOf(t);if(i<0||n===i)return;let r=this.editors[i],s=this.sticky;this.isSticky(i)&&n>this.sticky?this.sticky--:!this.isSticky(i)&&n<=this.sticky&&this.sticky++,this.editors.splice(i,1),this.editors.splice(n,0,r);let a={kind:7,editor:r,oldEditorIndex:i,editorIndex:n};if(this._onDidModelChange.fire(a),s!==this.sticky){let l={kind:13,editor:r,editorIndex:n};this._onDidModelChange.fire(l)}return r}setActive(t){let n;return t?n=this.setEditorActive(t):this.setGroupActive(),n}setGroupActive(){this._onDidModelChange.fire({kind:0})}setEditorActive(t){let n=this.findEditor(t);if(!n)return;let[i,r]=n;return this.doSetSelection(i,r,[]),i}get selectedEditors(){return this.editors.filter(t=>this.doIsSelected(t))}isSelected(t){let n;return typeof t=="number"?n=this.editors[t]:n=this.findEditor(t)?.[0],!!n&&this.doIsSelected(n)}doIsSelected(t){return this.selection.includes(t)}setSelection(t,n){let i=this.findEditor(t);if(!i)return;let[r,s]=i,a=new Set;for(let l of n){let d=this.findEditor(l);if(!d)return;let[c]=d;c!==r&&a.add(c)}this.doSetSelection(r,s,Array.from(a))}doSetSelection(t,n,i){let r=this.activeEditor,s=this.selection,a;t?a=[t,...i]:a=[],this.selection=a;let l=t&&typeof n=="number"&&r!==t;if(l){let d=this.indexOf(t,this.mru);this.mru.splice(d,1),this.mru.unshift(t);let c={kind:8,editor:t,editorIndex:n};this._onDidModelChange.fire(c)}if(l||s.length!==a.length||s.some(d=>!a.includes(d))){let d={kind:4};this._onDidModelChange.fire(d)}}setIndex(t){this._onDidModelChange.fire({kind:1})}setLabel(t){this._onDidModelChange.fire({kind:2})}pin(t){let n=this.findEditor(t);if(!n)return;let[i,r]=n;return this.doPin(i,r),i}doPin(t,n){if(this.isPinned(t))return;this.setTransient(t,!1),this.preview=null;let i={kind:11,editor:t,editorIndex:n};this._onDidModelChange.fire(i)}unpin(t){let n=this.findEditor(t);if(!n)return;let[i,r]=n;return this.doUnpin(i,r),i}doUnpin(t,n){if(!this.isPinned(t))return;let i=this.preview;this.preview=t;let r={kind:11,editor:t,editorIndex:n};this._onDidModelChange.fire(r),i&&this.closeEditor(i,3)}isPinned(t){let n;return typeof t=="number"?n=this.editors[t]:n=t,!this.matches(this.preview,n)}stick(t){let n=this.findEditor(t);if(!n)return;let[i,r]=n;return this.doStick(i,r),i}doStick(t,n){if(this.isSticky(n))return;this.pin(t);let i=this.sticky+1;this.moveEditor(t,i),this.sticky++;let r={kind:13,editor:t,editorIndex:i};this._onDidModelChange.fire(r)}unstick(t){let n=this.findEditor(t);if(!n)return;let[i,r]=n;return this.doUnstick(i,r),i}doUnstick(t,n){if(!this.isSticky(n))return;let i=this.sticky;this.moveEditor(t,i),this.sticky--;let r={kind:13,editor:t,editorIndex:i};this._onDidModelChange.fire(r)}isSticky(t){if(this.sticky<0)return!1;let n;return typeof t=="number"?n=t:n=this.indexOf(t),n<0?!1:n<=this.sticky}setTransient(t,n){if(!n&&this.transient.size===0)return;let i=this.findEditor(t);if(!i)return;let[r,s]=i;return this.doSetTransient(r,s,n),r}doSetTransient(t,n,i){if(i){if(this.transient.has(t))return;this.transient.add(t)}else{if(!this.transient.has(t))return;this.transient.delete(t)}let r={kind:12,editor:t,editorIndex:n};this._onDidModelChange.fire(r)}isTransient(t){if(this.transient.size===0)return!1;let n;return typeof t=="number"?n=this.editors[t]:n=this.findEditor(t)?.[0],!!n&&this.transient.has(n)}splice(t,n,i){let r=this.editors[t];if(n&&this.isSticky(t)&&this.sticky--,i?this.editors.splice(t,n?1:0,i):this.editors.splice(t,n?1:0),!n&&i)this.mru.length===0?this.mru.push(i):this.mru.splice(1,0,i);else{let s=this.indexOf(r,this.mru);n&&!i?this.mru.splice(s,1):n&&i&&this.mru.splice(s,1,i)}}indexOf(t,n=this.editors,i){let r=-1;if(!t)return r;for(let s=0;s<n.length;s++){let a=n[s];if(this.matches(a,t,i))if(i?.supportSideBySide&&a instanceof Lo&&!(t instanceof Lo))r=s;else{r=s;break}}return r}findEditor(t,n){let i=this.indexOf(t,this.editors,n);if(i!==-1)return[this.editors[i],i]}isFirst(t,n=this.editors){return this.matches(n[0],t)}isLast(t,n=this.editors){return this.matches(n[n.length-1],t)}contains(t,n){return this.indexOf(t,this.editors,n)!==-1}matches(t,n,i){if(!t||!n)return!1;if(i?.supportSideBySide&&t instanceof Lo&&!(n instanceof Lo))switch(i.supportSideBySide){case 4:if(this.matches(t.primary,n,i)||this.matches(t.secondary,n,i))return!0;break;case 3:if(this.matches(t.primary,n,i)&&this.matches(t.secondary,n,i))return!0;break}let r=t===n;return i?.strictEquals?r:r||t.matches(n)}get isLocked(){return this.locked}lock(t){this.isLocked!==t&&(this.locked=t,this._onDidModelChange.fire({kind:3}))}clone(){let t=this.instantiationService.createInstance(Os,void 0);t.editors=this.editors.slice(0),t.mru=this.mru.slice(0),t.preview=this.preview,t.selection=this.selection.slice(0),t.sticky=this.sticky;for(let n of t.editors)t.registerEditorListeners(n);return t}serialize(){let t=et.as(Zd.EditorFactory),n=[],i=[],r,s=this.sticky;for(let l=0;l<this.editors.length;l++){let d=this.editors[l],c=!1,u=t.getEditorSerializer(d);if(u){let h=u.canSerialize(d)?u.serialize(d):void 0;typeof h=="string"?(c=!0,i.push({id:d.typeId,value:h}),n.push(d),this.preview===d&&(r=n.length-1)):c=!1}!c&&this.isSticky(l)&&s--}let a=this.mru.map(l=>this.indexOf(l,n)).filter(l=>l>=0);return{id:this.id,locked:this.locked?!0:void 0,editors:i,mru:a,preview:r,sticky:s>=0?s:void 0}}deserialize(t){let n=et.as(Zd.EditorFactory);return typeof t.id=="number"?(this._id=t.id,Os.IDS=Math.max(t.id+1,Os.IDS)):this._id=Os.IDS++,t.locked&&(this.locked=!0),this.editors=fr(t.editors.map((i,r)=>{let s,a=n.getEditorSerializer(i.id);if(a){let l=a.deserialize(this.instantiationService,i.value);l instanceof Hr&&(s=l,this.registerEditorListeners(s))}return!s&&typeof t.sticky=="number"&&r<=t.sticky&&t.sticky--,s})),this.mru=fr(t.mru.map(i=>this.editors[i])),this.selection=this.mru.length>0?[this.mru[0]]:[],typeof t.preview=="number"&&(this.preview=this.editors[t.preview]),typeof t.sticky=="number"&&(this.sticky=t.sticky),this._id}dispose(){kt(Array.from(this.editorListeners)),this.editorListeners.clear(),this.transient.clear(),super.dispose()}};Os=R([S(1,ct),S(2,Et)],Os);var xL={WIDTH:400,WIDTH_WITH_VERTICAL_PANEL:600,HEIGHT:270};var Sa=Y("editorGroupsService");var gn=Y("editorService");var EL=class{constructor(e,t,n){this.id=e;this.dependencies=t;this.callback=n}};var iP=class o{static INSTANCE=new o;_isWebWorker=typeof self=="object"&&self.constructor&&self.constructor.name==="DedicatedWorkerGlobalScope";_isRenderer=typeof document=="object";_defineCalls=[];_state=1;_amdPolicy;constructor(){}_initialize(){if(this._state===1){if(globalThis.define){console.log("[amdX] AMD loader already present externally"),this._state=3;return}}else return;this._state=2,globalThis.define=(e,t,n)=>{typeof e!="string"&&(n=t,t=e,e=null),(typeof t!="object"||!Array.isArray(t))&&(n=t,t=null),this._defineCalls.push(new EL(e,t,n))},globalThis.define.amd=!0,this._isRenderer?this._amdPolicy=globalThis._VSCODE_WEB_PACKAGE_TTP??window.trustedTypes?.createPolicy("amdLoader",{createScriptURL(e){if(e.startsWith(window.location.origin)||e.startsWith(`${Te.vscodeFileResource}://${kx}`))return e;throw new Error(`[trusted_script_src] Invalid script url: ${e}`)}}):this._isWebWorker&&(this._amdPolicy=globalThis._VSCODE_WEB_PACKAGE_TTP??globalThis.trustedTypes?.createPolicy("amdLoader",{createScriptURL(e){return e}}))}async load(e){if(this._initialize(),this._state===3)return new Promise(s=>{let a=Ad();console.log(`[amdX] Using external define("${a}", ["${e}"])`),globalThis.define(a,[e],function(l){console.log(`[amdX] Got a result for ${a}: ${!!l}`),s(l)})});let t=await(this._isWebWorker?this._workerLoadScript(e):this._isRenderer?this._rendererLoadScript(e):this._nodeJSLoadScript(e));if(!t){console.warn(`Did not receive a define call from script ${e}`);return}let n={},i=[],r=[];if(Array.isArray(t.dependencies))for(let s of t.dependencies)s==="exports"?i.push(n):r.push(s);if(r.length>0)throw new Error(`Cannot resolve dependencies for script ${e}. The dependencies are: ${r.join(", ")}`);return typeof t.callback=="function"?t.callback(...i)??n:t.callback}_rendererLoadScript(e){return new Promise((t,n)=>{let i=document.createElement("script");i.setAttribute("async","async"),i.setAttribute("type","text/javascript");let r=()=>{i.removeEventListener("load",s),i.removeEventListener("error",a)},s=l=>{r(),t(this._defineCalls.pop())},a=l=>{r(),n(l)};i.addEventListener("load",s),i.addEventListener("error",a),this._amdPolicy&&(e=this._amdPolicy.createScriptURL(e)),i.setAttribute("src",e),window.document.getElementsByTagName("head")[0].appendChild(i)})}async _workerLoadScript(e){return this._amdPolicy&&(e=this._amdPolicy.createScriptURL(e)),await import(e),this._defineCalls.pop()}async _nodeJSLoadScript(e){try{let t=(await import("fs")).default,n=(await import("vm")).default,i=(await import("module")).default,r=ie.parse(e).fsPath,s=t.readFileSync(r).toString(),a=i.wrap(s.replace(/^#!.*/,""));return new n.Script(a).runInThisContext().apply(),this._defineCalls.pop()}catch(t){throw t}}};var TL="utf8";var _ke=512*8,Tke=512*128;var _L={utf8:{labelLong:"UTF-8",labelShort:"UTF-8",order:1,alias:"utf8bom",guessableName:"UTF-8"},utf8bom:{labelLong:"UTF-8 with BOM",labelShort:"UTF-8 with BOM",encodeOnly:!0,order:2,alias:"utf8"},utf16le:{labelLong:"UTF-16 LE",labelShort:"UTF-16 LE",order:3,guessableName:"UTF-16LE"},utf16be:{labelLong:"UTF-16 BE",labelShort:"UTF-16 BE",order:4,guessableName:"UTF-16BE"},windows1252:{labelLong:"Western (Windows 1252)",labelShort:"Windows 1252",order:5,guessableName:"windows-1252"},iso88591:{labelLong:"Western (ISO 8859-1)",labelShort:"ISO 8859-1",order:6},iso88593:{labelLong:"Western (ISO 8859-3)",labelShort:"ISO 8859-3",order:7},iso885915:{labelLong:"Western (ISO 8859-15)",labelShort:"ISO 8859-15",order:8},macroman:{labelLong:"Western (Mac Roman)",labelShort:"Mac Roman",order:9},cp437:{labelLong:"DOS (CP 437)",labelShort:"CP437",order:10},windows1256:{labelLong:"Arabic (Windows 1256)",labelShort:"Windows 1256",order:11},iso88596:{labelLong:"Arabic (ISO 8859-6)",labelShort:"ISO 8859-6",order:12},windows1257:{labelLong:"Baltic (Windows 1257)",labelShort:"Windows 1257",order:13},iso88594:{labelLong:"Baltic (ISO 8859-4)",labelShort:"ISO 8859-4",order:14},iso885914:{labelLong:"Celtic (ISO 8859-14)",labelShort:"ISO 8859-14",order:15},windows1250:{labelLong:"Central European (Windows 1250)",labelShort:"Windows 1250",order:16,guessableName:"windows-1250"},iso88592:{labelLong:"Central European (ISO 8859-2)",labelShort:"ISO 8859-2",order:17,guessableName:"ISO-8859-2"},cp852:{labelLong:"Central European (CP 852)",labelShort:"CP 852",order:18},windows1251:{labelLong:"Cyrillic (Windows 1251)",labelShort:"Windows 1251",order:19,guessableName:"windows-1251"},cp866:{labelLong:"Cyrillic (CP 866)",labelShort:"CP 866",order:20,guessableName:"IBM866"},iso88595:{labelLong:"Cyrillic (ISO 8859-5)",labelShort:"ISO 8859-5",order:21,guessableName:"ISO-8859-5"},koi8r:{labelLong:"Cyrillic (KOI8-R)",labelShort:"KOI8-R",order:22,guessableName:"KOI8-R"},koi8u:{labelLong:"Cyrillic (KOI8-U)",labelShort:"KOI8-U",order:23},iso885913:{labelLong:"Estonian (ISO 8859-13)",labelShort:"ISO 8859-13",order:24},windows1253:{labelLong:"Greek (Windows 1253)",labelShort:"Windows 1253",order:25,guessableName:"windows-1253"},iso88597:{labelLong:"Greek (ISO 8859-7)",labelShort:"ISO 8859-7",order:26,guessableName:"ISO-8859-7"},windows1255:{labelLong:"Hebrew (Windows 1255)",labelShort:"Windows 1255",order:27,guessableName:"windows-1255"},iso88598:{labelLong:"Hebrew (ISO 8859-8)",labelShort:"ISO 8859-8",order:28,guessableName:"ISO-8859-8"},iso885910:{labelLong:"Nordic (ISO 8859-10)",labelShort:"ISO 8859-10",order:29},iso885916:{labelLong:"Romanian (ISO 8859-16)",labelShort:"ISO 8859-16",order:30},windows1254:{labelLong:"Turkish (Windows 1254)",labelShort:"Windows 1254",order:31},iso88599:{labelLong:"Turkish (ISO 8859-9)",labelShort:"ISO 8859-9",order:32},windows1258:{labelLong:"Vietnamese (Windows 1258)",labelShort:"Windows 1258",order:33},gbk:{labelLong:"Simplified Chinese (GBK)",labelShort:"GBK",order:34},gb18030:{labelLong:"Simplified Chinese (GB18030)",labelShort:"GB18030",order:35},cp950:{labelLong:"Traditional Chinese (Big5)",labelShort:"Big5",order:36,guessableName:"Big5"},big5hkscs:{labelLong:"Traditional Chinese (Big5-HKSCS)",labelShort:"Big5-HKSCS",order:37},shiftjis:{labelLong:"Japanese (Shift JIS)",labelShort:"Shift JIS",order:38,guessableName:"SHIFT_JIS"},eucjp:{labelLong:"Japanese (EUC-JP)",labelShort:"EUC-JP",order:39,guessableName:"EUC-JP"},euckr:{labelLong:"Korean (EUC-KR)",labelShort:"EUC-KR",order:40,guessableName:"EUC-KR"},windows874:{labelLong:"Thai (Windows 874)",labelShort:"Windows 874",order:41},iso885911:{labelLong:"Latin/Thai (ISO 8859-11)",labelShort:"ISO 8859-11",order:42},koi8ru:{labelLong:"Cyrillic (KOI8-RU)",labelShort:"KOI8-RU",order:43},koi8t:{labelLong:"Tajik (KOI8-T)",labelShort:"KOI8-T",order:44},gb2312:{labelLong:"Simplified Chinese (GB 2312)",labelShort:"GB 2312",order:45,guessableName:"GB2312"},cp865:{labelLong:"Nordic DOS (CP 865)",labelShort:"CP 865",order:46},cp850:{labelLong:"Western European DOS (CP 850)",labelShort:"CP 850",order:47}},Lke=(()=>{let o={};for(let e in _L)_L[e].guessableName&&(o[e]=_L[e]);return o})();var Ur=class extends cr{constructor(t,n,i,r,s,a,l,d,c,u,h,m,f,g,b){super(l,a,g,b);this.resource=t;this.hasAssociatedFilePath=n;this.initialValue=i;this.preferredLanguageId=r;this.preferredEncoding=s;this.workingCopyBackupService=d;this.textResourceConfigurationService=c;this.workingCopyService=u;this.textFileService=h;this.labelService=m;this.editorService=f;this._register(this.workingCopyService.registerWorkingCopy(this)),r&&this.setLanguageId(r),this.onConfigurationChange(void 0,!1),this.registerListeners()}static FIRST_LINE_NAME_MAX_LENGTH=40;static FIRST_LINE_NAME_CANDIDATE_MAX_LENGTH=this.FIRST_LINE_NAME_MAX_LENGTH*10;static ACTIVE_EDITOR_LANGUAGE_ID="${activeEditorLanguage}";_onDidChangeContent=this._register(new E);onDidChangeContent=this._onDidChangeContent.event;_onDidChangeName=this._register(new E);onDidChangeName=this._onDidChangeName.event;_onDidChangeDirty=this._register(new E);onDidChangeDirty=this._onDidChangeDirty.event;_onDidChangeEncoding=this._register(new E);onDidChangeEncoding=this._onDidChangeEncoding.event;_onDidSave=this._register(new E);onDidSave=this._onDidSave.event;_onDidRevert=this._register(new E);onDidRevert=this._onDidRevert.event;typeId=qO;capabilities=2;configuredLabelFormat="content";cachedModelFirstLineWords=void 0;get name(){return this.configuredLabelFormat==="content"&&!this.hasAssociatedFilePath&&this.cachedModelFirstLineWords?this.cachedModelFirstLineWords:this.labelService.getUriBasenameLabel(this.resource)}registerListeners(){this._register(this.textResourceConfigurationService.onDidChangeConfiguration(t=>this.onConfigurationChange(t,!0)))}onConfigurationChange(t,n){if(!t||t.affectsConfiguration(this.resource,"files.encoding")){let i=this.textResourceConfigurationService.getValue(this.resource,"files.encoding");this.configuredEncoding!==i&&typeof i=="string"&&(this.configuredEncoding=i,n&&!this.preferredEncoding&&this._onDidChangeEncoding.fire())}if(!t||t.affectsConfiguration(this.resource,"workbench.editor.untitled.labelFormat")){let i=this.textResourceConfigurationService.getValue(this.resource,"workbench.editor.untitled.labelFormat");this.configuredLabelFormat!==i&&(i==="content"||i==="name")&&(this.configuredLabelFormat=i,n&&this._onDidChangeName.fire())}}setLanguageId(t,n){let i=t===Ur.ACTIVE_EDITOR_LANGUAGE_ID?this.editorService.activeTextEditorLanguageId:t;this.preferredLanguageId=i,i&&super.setLanguageId(i,n)}getLanguageId(){return this.textEditorModel?this.textEditorModel.getLanguageId():this.preferredLanguageId}configuredEncoding;getEncoding(){return this.preferredEncoding||this.configuredEncoding}async setEncoding(t){let n=this.getEncoding();this.preferredEncoding=t,n!==this.preferredEncoding&&this._onDidChangeEncoding.fire()}dirty=this.hasAssociatedFilePath||!!this.initialValue;isDirty(){return this.dirty}isModified(){return this.isDirty()}setDirty(t){this.dirty!==t&&(this.dirty=t,this._onDidChangeDirty.fire())}async save(t){let n=await this.textFileService.save(this.resource,t);return n&&this._onDidSave.fire({reason:t?.reason,source:t?.source}),!!n}async revert(){this.ignoreDirtyOnModelContentChange=!0;try{this.updateTextEditorModel(ug(""))}finally{this.ignoreDirtyOnModelContentChange=!1}this.setDirty(!1),this._onDidRevert.fire()}async backup(t){let n;return this.isResolved()?n=await this.textFileService.getEncodedReadable(this.resource,this.createSnapshot()??void 0,{encoding:TL}):typeof this.initialValue=="string"&&(n=gM(Cn.fromString(this.initialValue))),{content:n}}ignoreDirtyOnModelContentChange=!1;async resolve(){let t=!1,n=!1;if(this.textEditorModel)this.updateTextEditorModel(void 0,this.preferredLanguageId);else{let r,s=await this.workingCopyBackupService.resolve(this);s?(r=s.value,n=!0):r=fM(Cn.fromString(this.initialValue||""));let a=await JN(await this.textFileService.getDecodedStream(this.resource,r,{encoding:TL}));this.createTextEditorModel(a,this.resource,this.preferredLanguageId),t=!0}let i=Tn(this.textEditorModel);return this.installModelListeners(i),t&&((n||this.initialValue)&&this.updateNameFromFirstLine(i),this.setDirty(this.hasAssociatedFilePath||!!n||!!this.initialValue),(n||this.initialValue)&&this._onDidChangeContent.fire()),super.resolve()}installModelListeners(t){this._register(t.onDidChangeContent(n=>this.onModelContentChanged(t,n))),this._register(t.onDidChangeLanguage(()=>this.onConfigurationChange(void 0,!0))),super.installModelListeners(t)}onModelContentChanged(t,n){this.ignoreDirtyOnModelContentChange||(!this.hasAssociatedFilePath&&t.getLineCount()===1&&t.getLineLength(1)===0?this.setDirty(!1):this.setDirty(!0)),n.changes.some(i=>(i.range.startLineNumber===1||i.range.endLineNumber===1)&&i.range.startColumn<=Ur.FIRST_LINE_NAME_CANDIDATE_MAX_LENGTH)&&this.updateNameFromFirstLine(t),this._onDidChangeContent.fire(),this.autoDetectLanguage()}updateNameFromFirstLine(t){if(this.hasAssociatedFilePath)return;let n,i=t.getValueInRange({startLineNumber:1,endLineNumber:1,startColumn:1,endColumn:Ur.FIRST_LINE_NAME_CANDIDATE_MAX_LENGTH+1}).trim().replace(/\s+/g," ").replace(/\u202E/g,"");i=i.substr(0,ob(i,Ur.FIRST_LINE_NAME_MAX_LENGTH)[0]),i&&lm().exec(i)&&(n=i),n!==this.cachedModelFirstLineWords&&(this.cachedModelFirstLineWords=n,this._onDidChangeName.fire())}isReadonly(){return!1}};Ur=R([S(5,Bi),S(6,Vr),S(7,Dy),S(8,Kn),S(9,kl),S(10,Xd),S(11,Wr),S(12,gn),S(13,qu),S(14,Co)],Ur);var B4=Y("untitledTextEditorService"),Qd=class extends V{constructor(t,n){super();this.instantiationService=t;this.configurationService=n}static UNTITLED_WITHOUT_ASSOCIATED_RESOURCE_REGEX=/Untitled-\d+/;_onDidChangeDirty=this._register(new E);onDidChangeDirty=this._onDidChangeDirty.event;_onDidChangeEncoding=this._register(new E);onDidChangeEncoding=this._onDidChangeEncoding.event;_onDidCreate=this._register(new E);onDidCreate=this._onDidCreate.event;_onWillDispose=this._register(new E);onWillDispose=this._onWillDispose.event;_onDidChangeLabel=this._register(new E);onDidChangeLabel=this._onDidChangeLabel.event;mapResourceToModel=new Ai;get(t){return this.mapResourceToModel.get(t)}getValue(t){return this.get(t)?.textEditorModel?.getValue()}async resolve(t){let n=this.doCreateOrGet(t);return await n.resolve(),n}create(t){return this.doCreateOrGet(t)}doCreateOrGet(t=Object.create(null)){let n=this.massageOptions(t);return n.untitledResource&&this.mapResourceToModel.has(n.untitledResource)?this.mapResourceToModel.get(n.untitledResource):this.doCreate(n)}massageOptions(t){let n=Object.create(null);if(t.associatedResource?(n.untitledResource=ie.from({scheme:Te.untitled,authority:t.associatedResource.authority,fragment:t.associatedResource.fragment,path:t.associatedResource.path,query:t.associatedResource.query}),n.associatedResource=t.associatedResource):t.untitledResource?.scheme===Te.untitled&&(n.untitledResource=t.untitledResource),t.languageId)n.languageId=t.languageId;else if(!n.associatedResource){let i=this.configurationService.getValue();i.files?.defaultLanguage&&(n.languageId=i.files.defaultLanguage)}return n.encoding=t.encoding,n.initialValue=t.initialValue,n}doCreate(t){let n=t.untitledResource;if(!n){let r=1;do n=ie.from({scheme:Te.untitled,path:`Untitled-${r}`}),r++;while(this.mapResourceToModel.has(n))}let i=this._register(this.instantiationService.createInstance(Ur,n,!!t.associatedResource,t.initialValue,t.languageId,t.encoding));return this.registerModel(i),i}registerModel(t){let n=new he;n.add(t.onDidChangeDirty(()=>this._onDidChangeDirty.fire(t))),n.add(t.onDidChangeName(()=>this._onDidChangeLabel.fire(t))),n.add(t.onDidChangeEncoding(()=>this._onDidChangeEncoding.fire(t))),n.add(t.onWillDispose(()=>this._onWillDispose.fire(t))),oe.once(t.onWillDispose)(()=>{this.mapResourceToModel.delete(t.resource),n.dispose()}),this.mapResourceToModel.set(t.resource,t),this._onDidCreate.fire(t),t.isDirty()&&this._onDidChangeDirty.fire(t)}isUntitledWithAssociatedResource(t){return t.scheme===Te.untitled&&t.path.length>1&&!Qd.UNTITLED_WITHOUT_ASSOCIATED_RESOURCE_REGEX.test(t.path)}canDispose(t){return t.isDisposed()?!0:this.doCanDispose(t)}async doCanDispose(t){return t.isDirty()?(await oe.toPromise(t.onDidChangeDirty),this.canDispose(t)):!0}};Qd=R([S(0,ct),S(1,Et)],Qd);fi(B4,Qd,1);var mI=Qn,Jd=Y("notificationService");var LL=Y("progressService");var V4=Object.freeze({total(){},worked(){},done(){}}),rP=class{constructor(e){this.callback=e}static None=Object.freeze({report(){}});_value;get value(){return this._value}report(e){this._value=e,this.callback(this._value)}};var gI=class extends V{deferred=new tl;reporter;lastStep;constructor(e,t){super(),t.withProgress(e,n=>(this.reporter=n,this.lastStep&&n.report(this.lastStep),this.deferred.p)),this._register(ve(()=>this.deferred.complete()))}report(e){this.reporter?this.reporter.report(e):this.lastStep=e}};gI=R([S(1,LL)],gI);var ZRe=Y("editorProgressService");var lh=class extends V{constructor(t,n){super();this.logService=t;this.configurationService=n}participants=new ui;addFileOperationParticipant(t){let n=this.participants.push(t);return ve(()=>n())}async participate(t,n,i,r){let s=this.configurationService.getValue("files.participants.timeout");if(!(typeof s!="number"||s<=0))for(let a of this.participants)try{await a.participate(t,n,i,s,r)}catch(l){this.logService.warn(l)}}dispose(){this.participants.clear(),super.dispose()}};lh=R([S(0,Un),S(1,Et)],lh);var lo=class extends V{constructor(t,n,i,r){super();this.getExpression=t;this.shouldUpdate=n;this.contextService=i;this.configurationService=r;this.updateExpressions(!1),this.registerListeners()}static NO_FOLDER=null;_onExpressionChange=this._register(new E);onExpressionChange=this._onExpressionChange.event;mapFolderToParsedExpression=new Map;mapFolderToConfiguredExpression=new Map;registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(t=>{this.shouldUpdate(t)&&this.updateExpressions(!0)})),this._register(this.contextService.onDidChangeWorkspaceFolders(()=>this.updateExpressions(!0)))}updateExpressions(t){let n=!1;for(let a of this.contextService.getWorkspace().folders){let l=a.uri.toString(),d=this.doGetExpression(a.uri),c=this.mapFolderToConfiguredExpression.get(l);d?(!c||!Zn(c.expression,d.expression))&&(n=!0,this.mapFolderToParsedExpression.set(l,xm(d.expression)),this.mapFolderToConfiguredExpression.set(l,d)):c&&(n=!0,this.mapFolderToParsedExpression.delete(l),this.mapFolderToConfiguredExpression.delete(l))}let i=new Rf(this.contextService.getWorkspace().folders.map(a=>a.uri));for(let[a]of this.mapFolderToConfiguredExpression)a!==lo.NO_FOLDER&&(i.has(ie.parse(a))||(this.mapFolderToParsedExpression.delete(a),this.mapFolderToConfiguredExpression.delete(a),n=!0));let r=this.doGetExpression(void 0),s=this.mapFolderToConfiguredExpression.get(lo.NO_FOLDER);r?(!s||!Zn(s.expression,r.expression))&&(n=!0,this.mapFolderToParsedExpression.set(lo.NO_FOLDER,xm(r.expression)),this.mapFolderToConfiguredExpression.set(lo.NO_FOLDER,r)):s&&(n=!0,this.mapFolderToParsedExpression.delete(lo.NO_FOLDER),this.mapFolderToConfiguredExpression.delete(lo.NO_FOLDER)),t&&n&&this._onExpressionChange.fire()}doGetExpression(t){let n=this.getExpression(t);if(!n)return;let i=Object.keys(n);if(i.length===0)return;let r=!1,s=Object.create(null);for(let a of i){r||(r=xp(a));let l=a,d=Nk(l,!0);if(d){let c=d.toLowerCase();d!==d.toLowerCase()&&(l=`${c}${l.substring(1)}`)}s[l]=n[a]}return{expression:s,hasAbsolutePath:r}}matches(t,n){if(this.mapFolderToParsedExpression.size===0)return!1;let i=this.contextService.getWorkspaceFolder(t),r,s;if(i&&this.mapFolderToParsedExpression.has(i.uri.toString())?(r=this.mapFolderToParsedExpression.get(i.uri.toString()),s=this.mapFolderToConfiguredExpression.get(i.uri.toString())):(r=this.mapFolderToParsedExpression.get(lo.NO_FOLDER),s=this.mapFolderToConfiguredExpression.get(lo.NO_FOLDER)),!r)return!1;let a;return i?a=Zc(i.uri,t):a=this.uriToPath(t),typeof a=="string"&&r(a,void 0,n)?!0:a!==this.uriToPath(t)&&s?.hasAbsolutePath?!!r(this.uriToPath(t),void 0,n):!1}uriToPath(t){return t.scheme===Te.file?t.fsPath:t.path}};lo=R([S(2,fs),S(3,Et)],lo);var W4=new j("autoSaveAfterShortDelayContext",!1,!0);var Ns=Y("filesConfigurationService"),co=class extends V{constructor(t,n,i,r,s,a,l,d){super();this.contextKeyService=t;this.configurationService=n;this.contextService=i;this.environmentService=r;this.uriIdentityService=s;this.fileService=a;this.markerService=l;this.textResourceConfigurationService=d;let c=n.getValue();this.currentGlobalAutoSaveConfiguration=this.computeAutoSaveConfiguration(void 0,c.files),this.currentFilesAssociationConfiguration=c?.files?.associations,this.currentHotExitConfiguration=c?.files?.hotExit||ju.ON_EXIT,this.onFilesConfigurationChange(c,!1),this.registerListeners()}static DEFAULT_AUTO_SAVE_MODE=Zi?Br.AFTER_DELAY:Br.OFF;static DEFAULT_AUTO_SAVE_DELAY=1e3;static READONLY_MESSAGES={providerReadonly:{value:p("providerReadonly","Editor is read-only because the file system of the file is read-only."),isTrusted:!0},sessionReadonly:{value:p({key:"sessionReadonly",comment:['Please do not translate the word "command", it is part of our internal syntax which must not change','{Locked="](command:{0})"}']},"Editor is read-only because the file was set read-only in this session. [Click here](command:{0}) to set writeable.","workbench.action.files.setActiveEditorWriteableInSession"),isTrusted:!0},configuredReadonly:{value:p({key:"configuredReadonly",comment:['Please do not translate the word "command", it is part of our internal syntax which must not change','{Locked="](command:{0})"}']},"Editor is read-only because the file was set read-only via settings. [Click here](command:{0}) to configure or [toggle for this session](command:{1}).",`workbench.action.openSettings?${encodeURIComponent('["files.readonly"]')}`,"workbench.action.files.toggleActiveEditorReadonlyInSession"),isTrusted:!0},fileLocked:{value:p({key:"fileLocked",comment:['Please do not translate the word "command", it is part of our internal syntax which must not change','{Locked="](command:{0})"}']},"Editor is read-only because of file permissions. [Click here](command:{0}) to set writeable anyway.","workbench.action.files.setActiveEditorWriteableInSession"),isTrusted:!0},fileReadonly:{value:p("fileReadonly","Editor is read-only because the file is read-only."),isTrusted:!0}};_onDidChangeAutoSaveConfiguration=this._register(new E);onDidChangeAutoSaveConfiguration=this._onDidChangeAutoSaveConfiguration.event;_onDidChangeAutoSaveDisabled=this._register(new E);onDidChangeAutoSaveDisabled=this._onDidChangeAutoSaveDisabled.event;_onDidChangeFilesAssociation=this._register(new E);onDidChangeFilesAssociation=this._onDidChangeFilesAssociation.event;_onDidChangeReadonly=this._register(new E);onDidChangeReadonly=this._onDidChangeReadonly.event;currentGlobalAutoSaveConfiguration;currentFilesAssociationConfiguration;currentHotExitConfiguration;autoSaveConfigurationCache=new fo(1e3);autoSaveDisabledOverrides=new Ai;autoSaveAfterShortDelayContext=W4.bindTo(this.contextKeyService);readonlyIncludeMatcher=this._register(new qp(()=>this.createReadonlyMatcher(BO)));readonlyExcludeMatcher=this._register(new qp(()=>this.createReadonlyMatcher(VO)));configuredReadonlyFromPermissions;sessionReadonlyOverrides=new Ai(t=>this.uriIdentityService.extUri.getComparisonKey(t));createReadonlyMatcher(t){let n=this._register(new lo(i=>this.configurationService.getValue(t,{resource:i}),i=>i.affectsConfiguration(t),this.contextService,this.configurationService));return this._register(n.onExpressionChange(()=>this._onDidChangeReadonly.fire())),n}isReadonly(t,n){let i=this.fileService.getProvider(t.scheme);if(i&&PO(i))return i.readOnlyMessage??co.READONLY_MESSAGES.providerReadonly;let r=this.sessionReadonlyOverrides.get(t);return typeof r=="boolean"?r===!0?co.READONLY_MESSAGES.sessionReadonly:!1:this.uriIdentityService.extUri.isEqualOrParent(t,this.environmentService.userRoamingDataHome)||this.uriIdentityService.extUri.isEqual(t,this.contextService.getWorkspace().configuration??void 0)?!1:this.readonlyIncludeMatcher.value.matches(t)?this.readonlyExcludeMatcher.value.matches(t)?!1:co.READONLY_MESSAGES.configuredReadonly:this.configuredReadonlyFromPermissions&&n?.locked?co.READONLY_MESSAGES.fileLocked:n?.readonly?co.READONLY_MESSAGES.fileReadonly:!1}async updateReadonly(t,n){if(n==="toggle"){let i;try{i=await this.fileService.resolve(t,{resolveMetadata:!0})}catch{}n=!this.isReadonly(t,i)}n==="reset"?this.sessionReadonlyOverrides.delete(t):this.sessionReadonlyOverrides.set(t,n),this._onDidChangeReadonly.fire()}registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(t=>{t.affectsConfiguration("files")&&this.onFilesConfigurationChange(this.configurationService.getValue(),!0)}))}onFilesConfigurationChange(t,n){this.currentGlobalAutoSaveConfiguration=this.computeAutoSaveConfiguration(void 0,t.files),this.autoSaveConfigurationCache.clear(),this.autoSaveAfterShortDelayContext.set(this.getAutoSaveMode(void 0).mode===1),n&&this._onDidChangeAutoSaveConfiguration.fire();let i=t?.files?.associations;Zn(this.currentFilesAssociationConfiguration,i)||(this.currentFilesAssociationConfiguration=i,n&&this._onDidChangeFilesAssociation.fire());let r=t?.files?.hotExit;r===ju.OFF||r===ju.ON_EXIT_AND_WINDOW_CLOSE?this.currentHotExitConfiguration=r:this.currentHotExitConfiguration=ju.ON_EXIT;let s=!!t?.files?.readonlyFromPermissions;s!==!!this.configuredReadonlyFromPermissions&&(this.configuredReadonlyFromPermissions=s,n&&this._onDidChangeReadonly.fire())}getAutoSaveConfiguration(t){let n=this.toResource(t);if(n){let i=this.autoSaveConfigurationCache.get(n);return i||(i=this.computeAutoSaveConfiguration(n,this.textResourceConfigurationService.getValue(n,"files")),this.autoSaveConfigurationCache.set(n,i)),i}return this.currentGlobalAutoSaveConfiguration}computeAutoSaveConfiguration(t,n){let i,r,s,a,l,d;switch(n?.autoSave??co.DEFAULT_AUTO_SAVE_MODE){case Br.AFTER_DELAY:{i="afterDelay",r=typeof n?.autoSaveDelay=="number"&&n.autoSaveDelay>=0?n.autoSaveDelay:co.DEFAULT_AUTO_SAVE_DELAY,d=r<=co.DEFAULT_AUTO_SAVE_DELAY;break}case Br.ON_FOCUS_CHANGE:i="onFocusChange";break;case Br.ON_WINDOW_CHANGE:i="onWindowChange";break}return n?.autoSaveWorkspaceFilesOnly===!0&&(s=!0,t&&!this.contextService.isInsideWorkspace(t)&&(l=!0,d=void 0)),n?.autoSaveWhenNoErrors===!0&&(a=!0,d=void 0),{autoSave:i,autoSaveDelay:r,autoSaveWorkspaceFilesOnly:s,autoSaveWhenNoErrors:a,isOutOfWorkspace:l,isShortAutoSaveDelay:d}}toResource(t){return t instanceof Hr?Ia.getOriginalUri(t,{supportSideBySide:1}):t}hasShortAutoSaveDelay(t){let n=this.toResource(t);return this.getAutoSaveConfiguration(n).isShortAutoSaveDelay?!n||!this.autoSaveDisabledOverrides.has(n):!1}getAutoSaveMode(t,n){let i=this.toResource(t);if(i&&this.autoSaveDisabledOverrides.has(i))return{mode:0,reason:4};let r=this.getAutoSaveConfiguration(i);if(typeof r.autoSave>"u")return{mode:0,reason:1};if(typeof n=="number"&&(r.autoSave==="afterDelay"&&n!==2||r.autoSave==="onFocusChange"&&n!==3&&n!==4||r.autoSave==="onWindowChange"&&n!==4))return{mode:0,reason:1};if(i){if(r.autoSaveWorkspaceFilesOnly&&r.isOutOfWorkspace)return{mode:0,reason:2};if(r.autoSaveWhenNoErrors&&this.markerService.read({resource:i,take:1,severities:8}).length>0)return{mode:0,reason:3}}switch(r.autoSave){case"afterDelay":return typeof r.autoSaveDelay=="number"&&r.autoSaveDelay<=co.DEFAULT_AUTO_SAVE_DELAY?{mode:r.autoSaveWhenNoErrors?2:1}:{mode:2};case"onFocusChange":return{mode:3};case"onWindowChange":return{mode:4}}}async toggleAutoSave(){let t=this.configurationService.getValue("files.autoSave"),n;return[Br.AFTER_DELAY,Br.ON_FOCUS_CHANGE,Br.ON_WINDOW_CHANGE].some(i=>i===t)?n=Br.OFF:n=Br.AFTER_DELAY,this.configurationService.updateValue("files.autoSave",n)}disableAutoSave(t){let n=this.toResource(t);if(!n)return V.None;let i=this.autoSaveDisabledOverrides.get(n)??0;return this.autoSaveDisabledOverrides.set(n,i+1),i===0&&this._onDidChangeAutoSaveDisabled.fire(n),ve(()=>{let r=this.autoSaveDisabledOverrides.get(n)??0;r<=1?(this.autoSaveDisabledOverrides.delete(n),this._onDidChangeAutoSaveDisabled.fire(n)):this.autoSaveDisabledOverrides.set(n,r-1)})}get isHotExitEnabled(){return this.contextService.getWorkspace().transient?!1:this.currentHotExitConfiguration!==ju.OFF}get hotExitConfiguration(){return this.currentHotExitConfiguration}preventSaveConflicts(t,n){return this.configurationService.getValue("files.saveConflictResolution",{resource:t,overrideIdentifier:n})!=="overwriteFileOnDisk"}};co=R([S(0,ft),S(1,Et),S(2,fs),S(3,Go),S(4,Gd),S(5,zt),S(6,MM),S(7,Kn)],co);fi(Ns,co,0);var DL=Y("workingCopyEditorService"),mg=class extends V{constructor(t){super();this.editorService=t}_onDidRegisterHandler=this._register(new E);onDidRegisterHandler=this._onDidRegisterHandler.event;handlers=new Set;registerHandler(t){return this.handlers.add(t),this._onDidRegisterHandler.fire(t),ve(()=>this.handlers.delete(t))}findEditor(t){for(let n of this.editorService.getEditors(0))if(this.isOpen(t,n.editor))return n}isOpen(t,n){for(let i of this.handlers)if(i.isOpen(t,n))return!0;return!1}};mg=R([S(0,gn)],mg);fi(DL,mg,1);var sP=Y("elevatedFileService");var dh=class extends V{constructor(t,n){super();this.resource=t;this.fileService=n;this._register(this.fileService.onDidFilesChange(i=>this.onDidFilesChange(i)))}_onDidChangeOrphaned=this._register(new E);onDidChangeOrphaned=this._onDidChangeOrphaned.event;orphaned=!1;isOrphaned(){return this.orphaned}async onDidFilesChange(t){let n=!1,i;if(this.orphaned?t.contains(this.resource,1)&&(i=!1,n=!0):t.contains(this.resource,2)&&(i=!0,n=!0),n&&this.orphaned!==i){let r=!1;i&&(await vo(100,pn.None),this.isDisposed()?r=!0:r=!await this.fileService.exists(this.resource)),this.orphaned!==r&&!this.isDisposed()&&this.setOrphaned(r)}}setOrphaned(t){this.orphaned!==t&&(this.orphaned=t,this._onDidChangeOrphaned.fire())}_onWillDispose=this._register(new E);onWillDispose=this._onWillDispose.event;isDisposed(){return this._store.isDisposed}dispose(){this.orphaned=!1,this._onWillDispose.fire(),super.dispose()}isModified(){return this.isDirty()}};dh=R([S(1,zt)],dh);var ec=class extends dh{constructor(t,n,i,r,s,a,l,d,c,u,h,m,f,g,b,y){super(n,a);this.typeId=t;this.name=i;this.modelFactory=r;this.externalResolver=s;this.logService=l;this.workingCopyFileService=d;this.filesConfigurationService=c;this.workingCopyBackupService=u;this.notificationService=m;this.workingCopyEditorService=f;this.editorService=g;this.elevatedFileService=b;this.progressService=y;this._register(h.registerWorkingCopy(this)),this.registerListeners()}capabilities=0;_model=void 0;get model(){return this._model}_onDidChangeContent=this._register(new E);onDidChangeContent=this._onDidChangeContent.event;_onDidResolve=this._register(new E);onDidResolve=this._onDidResolve.event;_onDidChangeDirty=this._register(new E);onDidChangeDirty=this._onDidChangeDirty.event;_onDidSaveError=this._register(new E);onDidSaveError=this._onDidSaveError.event;_onDidSave=this._register(new E);onDidSave=this._onDidSave.event;_onDidRevert=this._register(new E);onDidRevert=this._onDidRevert.event;_onDidChangeReadonly=this._register(new E);onDidChangeReadonly=this._onDidChangeReadonly.event;registerListeners(){this._register(this.filesConfigurationService.onDidChangeReadonly(()=>this._onDidChangeReadonly.fire()))}dirty=!1;savedVersionId;isDirty(){return this.dirty}markModified(){this.setDirty(!0)}setDirty(t){if(!this.isResolved())return;let n=this.dirty;this.doSetDirty(t),t!==n&&this._onDidChangeDirty.fire()}doSetDirty(t){let n=this.dirty,i=this.inConflictMode,r=this.inErrorMode,s=this.savedVersionId;return t?this.dirty=!0:(this.dirty=!1,this.inConflictMode=!1,this.inErrorMode=!1,this.isResolved()&&(this.savedVersionId=this.model.versionId)),()=>{this.dirty=n,this.inConflictMode=i,this.inErrorMode=r,this.savedVersionId=s}}lastResolvedFileStat;isResolved(){return!!this.model}async resolve(t){if(this.trace("resolve() - enter"),this.isDisposed()){this.trace("resolve() - exit - without resolving because file working copy is disposed");return}if(!t?.contents&&(this.dirty||this.saveSequentializer.isRunning())){this.trace("resolve() - exit - without resolving because file working copy is dirty or being saved");return}return this.doResolve(t)}async doResolve(t){if(t?.contents)return this.resolveFromBuffer(t.contents);if(!(!this.isResolved()&&await this.resolveFromBackup()))return this.resolveFromFile(t)}async resolveFromBuffer(t){this.trace("resolveFromBuffer()");let n,i,r,s;try{let a=await this.fileService.stat(this.resource);n=a.mtime,i=a.ctime,r=a.size,s=a.etag,this.setOrphaned(!1)}catch(a){n=Date.now(),i=Date.now(),r=0,s=Zm,this.setOrphaned(a.fileOperationResult===1)}return this.resolveFromContent({resource:this.resource,name:this.name,mtime:n,ctime:i,size:r,etag:s,value:t,readonly:!1,locked:!1},!0)}async resolveFromBackup(){let t=await this.workingCopyBackupService.resolve(this);return this.isResolved()?(this.trace("resolveFromBackup() - exit - withoutresolving because previously new file working copy got created meanwhile"),!0):t?(await this.doResolveFromBackup(t),!0):!1}async doResolveFromBackup(t){this.trace("doResolveFromBackup()"),await this.resolveFromContent({resource:this.resource,name:this.name,mtime:t.meta?t.meta.mtime:Date.now(),ctime:t.meta?t.meta.ctime:Date.now(),size:t.meta?t.meta.size:0,etag:t.meta?t.meta.etag:Zm,value:t.value,readonly:!1,locked:!1},!0),t.meta&&t.meta.orphaned&&this.setOrphaned(!0)}async resolveFromFile(t){this.trace("resolveFromFile()");let n=t?.forceReadFromFile,i;n?i=Zm:this.lastResolvedFileStat&&(i=this.lastResolvedFileStat.etag);let r=this.versionId;try{let s=await this.fileService.readFileStream(this.resource,{etag:i,limits:t?.limits});if(this.setOrphaned(!1),r!==this.versionId){this.trace("resolveFromFile() - exit - without resolving because file working copy content changed");return}await this.resolveFromContent(s,!1)}catch(s){let a=s.fileOperationResult;if(this.setOrphaned(a===1),this.isResolved()&&a===2){s instanceof wy&&this.updateLastResolvedFileStat(s.stat);return}if(this.isResolved()&&a===1&&!n)return;throw s}}async resolveFromContent(t,n){if(this.trace("resolveFromContent() - enter"),this.isDisposed()){this.trace("resolveFromContent() - exit - because working copy is disposed");return}this.updateLastResolvedFileStat({resource:this.resource,name:t.name,mtime:t.mtime,ctime:t.ctime,size:t.size,etag:t.etag,readonly:t.readonly,locked:t.locked,isFile:!0,isDirectory:!1,isSymbolicLink:!1,children:void 0}),this.isResolved()?await this.doUpdateModel(t.value):await this.doCreateModel(t.value),this.setDirty(!!n),this._onDidResolve.fire()}async doCreateModel(t){this.trace("doCreateModel()"),this._model=this._register(await this.modelFactory.createModel(this.resource,t,pn.None)),this.installModelListeners(this._model)}ignoreDirtyOnModelContentChange=!1;async doUpdateModel(t){this.trace("doUpdateModel()"),this.ignoreDirtyOnModelContentChange=!0;try{await this.model?.update(t,pn.None)}finally{this.ignoreDirtyOnModelContentChange=!1}}installModelListeners(t){this._register(t.onDidChangeContent(n=>this.onModelContentChanged(t,n.isUndoing||n.isRedoing))),this._register(t.onWillDispose(()=>this.dispose()))}onModelContentChanged(t,n){if(this.trace("onModelContentChanged() - enter"),this.versionId++,this.trace(`onModelContentChanged() - new versionId ${this.versionId}`),n&&(this.lastContentChangeFromUndoRedo=Date.now()),!this.ignoreDirtyOnModelContentChange&&!this.isReadonly())if(t.versionId===this.savedVersionId){this.trace("onModelContentChanged() - model content changed back to last saved version");let i=this.dirty;this.setDirty(!1),i&&this._onDidRevert.fire()}else this.trace("onModelContentChanged() - model content changed and marked as dirty"),this.setDirty(!0);this._onDidChangeContent.fire()}async forceResolveFromFile(){this.isDisposed()||await this.externalResolver({forceReadFromFile:!0})}get backupDelay(){return this.model?.configuration?.backupDelay}async backup(t){let n;this.lastResolvedFileStat&&(n={mtime:this.lastResolvedFileStat.mtime,ctime:this.lastResolvedFileStat.ctime,size:this.lastResolvedFileStat.size,etag:this.lastResolvedFileStat.etag,orphaned:this.isOrphaned()});let i;return this.isResolved()&&(i=await Yp(this.model.snapshot(2,t),t)),{meta:n,content:i}}versionId=0;static UNDO_REDO_SAVE_PARTICIPANTS_AUTO_SAVE_THROTTLE_THRESHOLD=500;lastContentChangeFromUndoRedo=void 0;saveSequentializer=new mb;ignoreSaveFromSaveParticipants=!1;async save(t=Object.create(null)){return this.isResolved()?this.isReadonly()?(this.trace("save() - ignoring request for readonly resource"),!1):(this.hasState(3)||this.hasState(5))&&(t.reason===2||t.reason===3||t.reason===4)?(this.trace("save() - ignoring auto save request for file working copy that is in conflict or error"),!1):(this.trace("save() - enter"),await this.doSave(t),this.trace("save() - exit"),this.hasState(0)):!1}async doSave(t){typeof t.reason!="number"&&(t.reason=1);let n=this.versionId;if(this.trace(`doSave(${n}) - enter with versionId ${n}`),this.ignoreSaveFromSaveParticipants){this.trace(`doSave(${n}) - exit - refusing to save() recursively from save participant`);return}if(this.saveSequentializer.isRunning(n))return this.trace(`doSave(${n}) - exit - found a running save for versionId ${n}`),this.saveSequentializer.running;if(!t.force&&!this.dirty){this.trace(`doSave(${n}) - exit - because not dirty and/or versionId is different (this.isDirty: ${this.dirty}, this.versionId: ${this.versionId})`);return}if(this.saveSequentializer.isRunning())return this.trace(`doSave(${n}) - exit - because busy saving`),this.saveSequentializer.cancelRunning(),this.saveSequentializer.queue(()=>this.doSave(t));this.isResolved()&&this.model.pushStackElement();let i=new Xo;return this.progressService.withProgress({title:p("saveParticipants","Saving '{0}'",this.name),location:10,cancellable:!0,delay:this.isDirty()?3e3:5e3},r=>this.doSaveSequential(n,t,r,i),()=>{i.cancel()}).finally(()=>{i.dispose()})}doSaveSequential(t,n,i,r){return this.saveSequentializer.run(t,(async()=>{if(this.isResolved()&&!n.skipSaveParticipants&&this.workingCopyFileService.hasSaveParticipants)try{if(n.reason===2&&typeof this.lastContentChangeFromUndoRedo=="number"){let l=Date.now()-this.lastContentChangeFromUndoRedo;l<ec.UNDO_REDO_SAVE_PARTICIPANTS_AUTO_SAVE_THROTTLE_THRESHOLD&&await vo(ec.UNDO_REDO_SAVE_PARTICIPANTS_AUTO_SAVE_THROTTLE_THRESHOLD-l)}if(!r.token.isCancellationRequested){this.ignoreSaveFromSaveParticipants=!0;try{await this.workingCopyFileService.runSaveParticipants(this,{reason:n.reason??1,savedFrom:n.from},i,r.token)}finally{this.ignoreSaveFromSaveParticipants=!1}}}catch(l){this.logService.error(`[stored file working copy] runSaveParticipants(${t}) - resulted in an error: ${l.toString()}`,this.resource.toString(),this.typeId)}if(r.token.isCancellationRequested||this.isDisposed()||!this.isResolved())return;t=this.versionId,this.inErrorMode=!1,i.report({message:p("saveTextFile","Writing into file...")}),this.trace(`doSave(${t}) - before write()`);let s=Tn(this.lastResolvedFileStat),a=this;return this.saveSequentializer.run(t,(async()=>{try{let l={mtime:s.mtime,etag:n.ignoreModifiedSince||!this.filesConfigurationService.preventSaveConflicts(s.resource)?Zm:s.etag,unlock:n.writeUnlock},d;if(typeof a.model.save=="function")try{d=await a.model.save(l,r.token)}catch(c){if(r.token.isCancellationRequested)return;throw c}else{let c=await Yp(a.model.snapshot(1,r.token),r.token);if(r.token.isCancellationRequested)return;r.dispose(),n?.writeElevated&&this.elevatedFileService.isSupported(s.resource)?d=await this.elevatedFileService.writeFileElevated(s.resource,Tn(c),l):d=await this.fileService.writeFile(s.resource,Tn(c),l)}this.handleSaveSuccess(d,t,n)}catch(l){this.handleSaveError(l,t,n)}})(),()=>r.cancel())})(),()=>r.cancel())}handleSaveSuccess(t,n,i){this.updateLastResolvedFileStat(t),n===this.versionId?(this.trace(`handleSaveSuccess(${n}) - setting dirty to false because versionId did not change`),this.setDirty(!1)):this.trace(`handleSaveSuccess(${n}) - not setting dirty to false because versionId did change meanwhile`),this.setOrphaned(!1),this._onDidSave.fire({reason:i.reason,stat:t,source:i.source})}handleSaveError(t,n,i){if((i.ignoreErrorHandler?this.logService.trace:this.logService.error).apply(this.logService,[`[stored file working copy] handleSaveError(${n}) - exit - resulted in a save error: ${t.toString()}`,this.resource.toString(),this.typeId]),i.ignoreErrorHandler)throw t;this.setDirty(!0),this.inErrorMode=!0,t.fileOperationResult===3&&(this.inConflictMode=!0),this.doHandleSaveError(t,i),this._onDidSaveError.fire()}doHandleSaveError(t,n){let i=t,r=[],s;if(i.fileOperationResult===3)s=p("staleSaveError","Failed to save '{0}': The content of the file is newer. Do you want to overwrite the file with your changes?",this.name),r.push(wi({id:"fileWorkingCopy.overwrite",label:p("overwrite","Overwrite"),run:()=>this.save({...n,ignoreModifiedSince:!0,reason:1})})),r.push(wi({id:"fileWorkingCopy.revert",label:p("revert","Revert"),run:()=>this.revert()}));else{let d=i.fileOperationResult===5,c=d&&i.options?.unlock,u=i.fileOperationResult===6,h=this.elevatedFileService.isSupported(this.resource);kT(t)&&r.push(...t.actions),h&&(u||c)?r.push(wi({id:"fileWorkingCopy.saveElevated",label:c?mt?p("overwriteElevated","Overwrite as Admin..."):p("overwriteElevatedSudo","Overwrite as Sudo..."):mt?p("saveElevated","Retry as Admin..."):p("saveElevatedSudo","Retry as Sudo..."),run:()=>{this.save({...n,writeElevated:!0,writeUnlock:c,reason:1})}})):d?r.push(wi({id:"fileWorkingCopy.unlock",label:p("overwrite","Overwrite"),run:()=>this.save({...n,writeUnlock:!0,reason:1})})):r.push(wi({id:"fileWorkingCopy.retry",label:p("retry","Retry"),run:()=>this.save({...n,reason:1})})),r.push(wi({id:"fileWorkingCopy.saveAs",label:p("saveAs","Save As..."),run:async()=>{let m=this.workingCopyEditorService.findEditor(this);m&&((await this.editorService.save(m,{saveAs:!0,reason:1})).success||this.doHandleSaveError(t,n))}})),r.push(wi({id:"fileWorkingCopy.revert",label:p("revert","Revert"),run:()=>this.revert()})),d?c&&h?s=mt?p("readonlySaveErrorAdmin","Failed to save '{0}': File is read-only. Select 'Overwrite as Admin' to retry as administrator.",this.name):p("readonlySaveErrorSudo","Failed to save '{0}': File is read-only. Select 'Overwrite as Sudo' to retry as superuser.",this.name):s=p("readonlySaveError","Failed to save '{0}': File is read-only. Select 'Overwrite' to attempt to make it writeable.",this.name):h&&u?s=mt?p("permissionDeniedSaveError","Failed to save '{0}': Insufficient permissions. Select 'Retry as Admin' to retry as administrator.",this.name):p("permissionDeniedSaveErrorSudo","Failed to save '{0}': Insufficient permissions. Select 'Retry as Sudo' to retry as superuser.",this.name):s=p({key:"genericSaveError",comment:["{0} is the resource that failed to save and {1} the error message"]},"Failed to save '{0}': {1}",this.name,xy(t,!1))}let a=this.notificationService.notify({id:`${cs(this.resource.toString())}`,severity:mI.Error,message:s,actions:{primary:r}}),l=this._register(oe.once(oe.any(this.onDidSave,this.onDidRevert))(()=>a.close()));this._register(oe.once(a.onDidClose)(()=>l.dispose()))}updateLastResolvedFileStat(t){let n=this.isReadonly();this.lastResolvedFileStat?this.lastResolvedFileStat.mtime<=t.mtime?this.lastResolvedFileStat=t:this.lastResolvedFileStat={...this.lastResolvedFileStat,readonly:t.readonly,locked:t.locked}:this.lastResolvedFileStat=t,this.isReadonly()!==n&&this._onDidChangeReadonly.fire()}async revert(t){if(!this.isResolved()||!this.dirty&&!t?.force)return;this.trace("revert()");let n=this.dirty,i=this.doSetDirty(!1);if(!t?.soft)try{await this.forceResolveFromFile()}catch(s){if(s.fileOperationResult!==1)throw i(),s}this._onDidRevert.fire(),n&&this._onDidChangeDirty.fire()}inConflictMode=!1;inErrorMode=!1;hasState(t){switch(t){case 3:return this.inConflictMode;case 1:return this.dirty;case 5:return this.inErrorMode;case 4:return this.isOrphaned();case 2:return this.saveSequentializer.isRunning();case 0:return!this.dirty}}async joinState(t){return this.saveSequentializer.running}isReadonly(){return this.filesConfigurationService.isReadonly(this.resource,this.lastResolvedFileStat)}trace(t){this.logService.trace(`[stored file working copy] ${t}`,this.resource.toString(),this.typeId)}dispose(){this.trace("dispose()"),this.inConflictMode=!1,this.inErrorMode=!1,this._model=void 0,super.dispose()}};ec=R([S(5,zt),S(6,Un),S(7,kL),S(8,Ns),S(9,Dy),S(10,kl),S(11,Jd),S(12,DL),S(13,gn),S(14,sP),S(15,LL)],ec);var ch=class extends V{constructor(t){super();this.logService=t}saveParticipants=[];get length(){return this.saveParticipants.length}addSaveParticipant(t){let n=wf(this.saveParticipants,t);return ve(()=>n())}async participate(t,n,i,r){t.model?.pushStackElement();for(let s of this.saveParticipants){if(r.isCancellationRequested||t.isDisposed())break;try{let a=s.participate(t,n,i,r);await Yp(a,r)}catch(a){this.logService.warn(a)}}t.model?.pushStackElement()}dispose(){this.saveParticipants.splice(0,this.saveParticipants.length),super.dispose()}};ch=R([S(0,Un)],ch);var kL=Y("workingCopyFileService"),gg=class extends V{constructor(t,n,i,r){super();this.fileService=t;this.workingCopyService=n;this.instantiationService=i;this.uriIdentityService=r;this._register(this.registerWorkingCopyProvider(s=>this.workingCopyService.workingCopies.filter(a=>this.fileService.hasProvider(s)?this.uriIdentityService.extUri.isEqualOrParent(a.resource,s):this.uriIdentityService.extUri.isEqual(a.resource,s))))}_onWillRunWorkingCopyFileOperation=this._register(new Uc);onWillRunWorkingCopyFileOperation=this._onWillRunWorkingCopyFileOperation.event;_onDidFailWorkingCopyFileOperation=this._register(new Uc);onDidFailWorkingCopyFileOperation=this._onDidFailWorkingCopyFileOperation.event;_onDidRunWorkingCopyFileOperation=this._register(new Uc);onDidRunWorkingCopyFileOperation=this._onDidRunWorkingCopyFileOperation.event;correlationIds=0;create(t,n,i){return this.doCreateFileOrFolder(t,!0,n,i)}createFolder(t,n,i){return this.doCreateFileOrFolder(t,!1,n,i)}async doCreateFileOrFolder(t,n,i,r){if(t.length===0)return[];if(n){let c=(await Uo.settled(t.map(u=>this.fileService.canCreateFile(u.resource,{overwrite:u.overwrite})))).find(u=>u instanceof Error);if(c instanceof Error)throw c}let s=t.map(d=>({target:d.resource}));await this.runFileOperationParticipants(s,0,r,i);let a={correlationId:this.correlationIds++,operation:0,files:s};await this._onWillRunWorkingCopyFileOperation.fireAsync(a,pn.None);let l;try{n?l=await Uo.settled(t.map(d=>this.fileService.createFile(d.resource,d.contents,{overwrite:d.overwrite}))):l=await Uo.settled(t.map(d=>this.fileService.createFolder(d.resource)))}catch(d){throw await this._onDidFailWorkingCopyFileOperation.fireAsync(a,pn.None),d}return await this._onDidRunWorkingCopyFileOperation.fireAsync(a,pn.None),l}async move(t,n,i){return this.doMoveOrCopy(t,!0,n,i)}async copy(t,n,i){return this.doMoveOrCopy(t,!1,n,i)}async doMoveOrCopy(t,n,i,r){let s=[];for(let{file:{source:d,target:c},overwrite:u}of t){let h=await(n?this.fileService.canMove(d,c,u):this.fileService.canCopy(d,c,u));if(h instanceof Error)throw h}let a=t.map(d=>d.file);await this.runFileOperationParticipants(a,n?2:3,r,i);let l={correlationId:this.correlationIds++,operation:n?2:3,files:a};await this._onWillRunWorkingCopyFileOperation.fireAsync(l,pn.None);try{for(let{file:{source:d,target:c},overwrite:u}of t){if(!this.uriIdentityService.extUri.isEqual(d,c)){let h=n?[...this.getDirty(d),...this.getDirty(c)]:this.getDirty(c);await Uo.settled(h.map(m=>m.revert({soft:!0})))}n?s.push(await this.fileService.move(d,c,u)):s.push(await this.fileService.copy(d,c,u))}}catch(d){throw await this._onDidFailWorkingCopyFileOperation.fireAsync(l,pn.None),d}return await this._onDidRunWorkingCopyFileOperation.fireAsync(l,pn.None),s}async delete(t,n,i){for(let a of t){let l=await this.fileService.canDelete(a.resource,{recursive:a.recursive,useTrash:a.useTrash});if(l instanceof Error)throw l}let r=t.map(a=>({target:a.resource}));await this.runFileOperationParticipants(r,1,i,n);let s={correlationId:this.correlationIds++,operation:1,files:r};await this._onWillRunWorkingCopyFileOperation.fireAsync(s,pn.None);for(let a of t){let l=this.getDirty(a.resource);await Uo.settled(l.map(d=>d.revert({soft:!0})))}try{for(let a of t)await this.fileService.del(a.resource,{recursive:a.recursive,useTrash:a.useTrash})}catch(a){throw await this._onDidFailWorkingCopyFileOperation.fireAsync(s,pn.None),a}await this._onDidRunWorkingCopyFileOperation.fireAsync(s,pn.None)}fileOperationParticipants=this._register(this.instantiationService.createInstance(lh));addFileOperationParticipant(t){return this.fileOperationParticipants.addFileOperationParticipant(t)}runFileOperationParticipants(t,n,i,r){return this.fileOperationParticipants.participate(t,n,i,r)}saveParticipants=this._register(this.instantiationService.createInstance(ch));get hasSaveParticipants(){return this.saveParticipants.length>0}addSaveParticipant(t){return this.saveParticipants.addSaveParticipant(t)}runSaveParticipants(t,n,i,r){return this.saveParticipants.participate(t,n,i,r)}workingCopyProviders=[];registerWorkingCopyProvider(t){let n=wf(this.workingCopyProviders,t);return ve(n)}getDirty(t){let n=new Set;for(let i of this.workingCopyProviders)for(let r of i(t))r.isDirty()&&n.add(r);return Array.from(n)}};gg=R([S(0,zt),S(1,kl),S(2,ct),S(3,Gd)],gg);fi(kL,gg,1);var Xd=Y("textFileService");var U4;(e=>e.DEFAULT={allowTrailingComma:!0})(U4||={});var un=Y("keybindingService");var RL=".vscode",z4="settings",QFe=`${RL}/${z4}.json`;var JFe=[1],eBe=[2,3,4,5,6],K4=[3,4,5],tBe=[1,...K4],nBe=[2,3,4,5,6],G4=[3,4,5,6],j4=[4,5,6],fI="tasks",aP="launch",dP=Object.create(null);dP[fI]=`${RL}/${fI}.json`;dP[aP]=`${RL}/${aP}.json`;var $4=Object.create(null);$4[fI]=`${fI}.json`;var iBe=Et;var ML=class extends $u{_currentResultGroups=new Map;updateResultGroup(e,t){return t?this._currentResultGroups.set(e,t):this._currentResultGroups.delete(e),this.removeDuplicateResults(),this.update()}removeDuplicateResults(){let e=new Set;[...this._currentResultGroups.keys()].sort((t,n)=>this._currentResultGroups.get(t).order-this._currentResultGroups.get(n).order).forEach(t=>{let n=this._currentResultGroups.get(t);n.result.filterMatches=n.result.filterMatches.filter(i=>!e.has(i.setting.key)),n.result.filterMatches.forEach(i=>e.add(i.setting.key))})}filterSettings(e,t,n){let i=this.filterGroups,r=[];for(let s of i){let a=t(s);for(let l of s.sections)for(let d of l.settings){let c=n(d,s);(a||c)&&r.push({setting:d,matches:c&&c.matches,matchType:c?.matchType??0,score:c?.score??0})}}return r}getPreference(e){for(let t of this.settingsGroups)for(let n of t.sections)for(let i of n.settings)if(e===i.key)return i}collectMetadata(e){let t=Object.create(null),n=!1;return e.forEach(i=>{i.result.metadata&&(t[i.id]=i.result.metadata,n=!0)}),n?t:null}get filterGroups(){return this.settingsGroups}};var bI=class extends ML{constructor(t,n){super();this._defaultSettings=t;this._register(n.onDidChangeConfiguration(i=>{i.source===7&&(this.dirty=!0,this._onDidChangeGroups.fire())})),this._register(et.as(bs.Configuration).onDidSchemaChange(i=>{this.dirty=!0,this._onDidChangeGroups.fire()}))}_onDidChangeGroups=this._register(new E);onDidChangeGroups=this._onDidChangeGroups.event;additionalGroups=[];dirty=!1;get filterGroups(){return this.settingsGroups.slice(1)}get settingsGroups(){let t=this._defaultSettings.getSettingsGroups(this.dirty);return this.dirty=!1,[...t,...this.additionalGroups]}setAdditionalGroups(t){this.additionalGroups=t}findValueMatches(t,n){return[]}update(){throw new Error("Not supported")}};bI=R([S(1,Et)],bI);function Y4(o){return"// "+p("defaultKeybindingsHeader","Override key bindings by placing them into your key bindings file.")+`
`+o.getDefaultKeybindingsContent()}var vI=class{constructor(e,t){this._uri=e;this.keybindingService=t}_content;get uri(){return this._uri}get content(){return this._content||(this._content=Y4(this.keybindingService)),this._content}getPreference(){return null}dispose(){}};vI=R([S(1,un)],vI);var K2e=Y("preferencesService");var Zd={EditorPane:"workbench.contributions.editors",EditorFactory:"workbench.contributions.editor.inputFactories"},uh={id:"default",displayName:p("promptOpenWith.defaultEditor.displayName","Text Editor"),providerDisplayName:p("builtinProviderDisplayName","Built-in")};function sh(o,e,t){for(let n of t.visibleEditorPanes)if(n.group.id===e&&o.matches(n.input))return n.getViewState()}function pI(o){if(ti(o))return!1;let e=o;return ie.isUri(e?.resource)}function Ca(o){if(ti(o))return!1;let e=o;return e?.original!==void 0&&e.modified!==void 0}function ah(o){if(ti(o))return!1;let e=o;return!e||e.resources&&!Array.isArray(e.resources)?!1:!!e.resources||!!e.multiDiffSource}function Rl(o){if(ti(o)||Ca(o))return!1;let e=o;return e?.primary!==void 0&&e.secondary!==void 0}function cP(o){if(ti(o))return!1;let e=o;return e?e.resource===void 0||e.resource.scheme===Te.untitled||e.forceUntitled===!0:!1}function Ml(o){if(ti(o))return!1;let e=o;return ie.isUri(e?.base?.resource)&&ie.isUri(e?.input1?.resource)&&ie.isUri(e?.input2?.resource)&&ie.isUri(e?.result?.resource)}var AL=class{mapIdToSaveSource=new Map;registerSource(e,t){let n=this.mapIdToSaveSource.get(e);return n||(n={source:e,label:t},this.mapIdToSaveSource.set(e,n)),n.source}getSourceLabel(e){return this.mapIdToSaveSource.get(e)?.label??e}},XVe=new AL;var pg=class extends V{};function ti(o){return o instanceof pg}function Z4(o){let e=o;return ie.isUri(e?.preferredResource)}function X4(o){let e=o;return ti(e?.primary)&&ti(e?.secondary)}function CL(o){let e=o;return ti(e?.modified)&&ti(e?.original)}var OL=class{getOriginalUri(e,t){if(!e)return;if(Ml(e))return Ia.getOriginalUri(e.result,t);if(t?.supportSideBySide){let{primary:i,secondary:r}=this.getSideEditors(e);if(i&&r){if(t?.supportSideBySide===3)return{primary:this.getOriginalUri(i,{filterByScheme:t.filterByScheme}),secondary:this.getOriginalUri(r,{filterByScheme:t.filterByScheme})};if(t?.supportSideBySide===4)return this.getOriginalUri(i,{filterByScheme:t.filterByScheme})??this.getOriginalUri(r,{filterByScheme:t.filterByScheme});e=t.supportSideBySide===1?i:r}}if(Ca(e)||ah(e)||Rl(e)||Ml(e))return;let n=Z4(e)?e.preferredResource:e.resource;return!n||!t||!t.filterByScheme?n:this.filterUri(n,t.filterByScheme)}getSideEditors(e){return X4(e)||Rl(e)?{primary:e.primary,secondary:e.secondary}:CL(e)||Ca(e)?{primary:e.modified,secondary:e.original}:{primary:void 0,secondary:void 0}}getCanonicalUri(e,t){if(!e)return;if(Ml(e))return Ia.getCanonicalUri(e.result,t);if(t?.supportSideBySide){let{primary:i,secondary:r}=this.getSideEditors(e);if(i&&r){if(t?.supportSideBySide===3)return{primary:this.getCanonicalUri(i,{filterByScheme:t.filterByScheme}),secondary:this.getCanonicalUri(r,{filterByScheme:t.filterByScheme})};if(t?.supportSideBySide===4)return this.getCanonicalUri(i,{filterByScheme:t.filterByScheme})??this.getCanonicalUri(r,{filterByScheme:t.filterByScheme});e=t.supportSideBySide===1?i:r}}if(Ca(e)||ah(e)||Rl(e)||Ml(e))return;let n=e.resource;return!n||!t||!t.filterByScheme?n:this.filterUri(n,t.filterByScheme)}filterUri(e,t){if(Array.isArray(t)){if(t.some(n=>e.scheme===n))return e}else if(t===e.scheme)return e}};var Ia=new OL;var NL=class{instantiationService;fileEditorFactory;editorSerializerConstructors=new Map;editorSerializerInstances=new Map;start(e){let t=this.instantiationService=e.get(ct);for(let[n,i]of this.editorSerializerConstructors)this.createEditorSerializer(n,i,t);this.editorSerializerConstructors.clear()}createEditorSerializer(e,t,n){let i=n.createInstance(t);this.editorSerializerInstances.set(e,i)}registerFileEditorFactory(e){if(this.fileEditorFactory)throw new Error("Can only register one file editor factory.");this.fileEditorFactory=e}getFileEditorFactory(){return Tn(this.fileEditorFactory)}registerEditorSerializer(e,t){if(this.editorSerializerConstructors.has(e)||this.editorSerializerInstances.has(e))throw new Error(`A editor serializer with type ID '${e}' was already registered.`);return this.instantiationService?this.createEditorSerializer(e,t,this.instantiationService):this.editorSerializerConstructors.set(e,t),ve(()=>{this.editorSerializerConstructors.delete(e),this.editorSerializerInstances.delete(e)})}getEditorSerializer(e){return this.editorSerializerInstances.get(typeof e=="string"?e:e.typeId)}};et.add(Zd.EditorFactory,new NL);function fg(o){let e=o;if(!e)return!1;let t=e;if(t.modified)return fg(t.modified);let n=e;return!!(n.contributionsState&&n.viewState&&Array.isArray(n.cursorState))}function yI(o,e,t){let n=!1,i=e5(o);if(fg(i)&&(e.restoreViewState(i),n=!0),o.selection){let r={startLineNumber:o.selection.startLineNumber,startColumn:o.selection.startColumn,endLineNumber:o.selection.endLineNumber??o.selection.startLineNumber,endColumn:o.selection.endColumn??o.selection.startColumn};e.setSelection(r,o.selectionSource??"code.navigation"),o.selectionRevealType===2?e.revealRangeNearTop(r,t):o.selectionRevealType===3?e.revealRangeNearTopIfOutsideViewport(r,t):o.selectionRevealType===1?e.revealRangeInCenterIfOutsideViewport(r,t):e.revealRangeInCenter(r,t),n=!0}return n}function e5(o){if(!o.selection||!o.viewState)return o.viewState;let e=o.viewState;if(e.modified)return e.modified.cursorState=[],e;let t=o.viewState;return t.cursorState&&(t.cursorState=[]),t}var Ps=class extends V{constructor(t,n){super();this.configurationService=t;this.workspaceContextService=n;this.storeEnablementState(),this.storeCustomPatterns(),this.registerListeners()}_serviceBrand;static SETTING_ID_PATTERNS="workbench.editor.customLabels.patterns";static SETTING_ID_ENABLED="workbench.editor.customLabels.enabled";_onDidChange=this._register(new E);onDidChange=this._onDidChange.event;patterns=[];enabled=!0;cache=new Af(1e3);registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(t=>{if(t.affectsConfiguration(Ps.SETTING_ID_ENABLED)){let n=this.enabled;this.storeEnablementState(),n!==this.enabled&&this.patterns.length>0&&this._onDidChange.fire()}else t.affectsConfiguration(Ps.SETTING_ID_PATTERNS)&&(this.cache.clear(),this.storeCustomPatterns(),this._onDidChange.fire())}))}storeEnablementState(){this.enabled=this.configurationService.getValue(Ps.SETTING_ID_ENABLED)}_templateRegexValidation=/[a-zA-Z0-9]/;storeCustomPatterns(){this.patterns=[];let t=this.configurationService.getValue(Ps.SETTING_ID_PATTERNS);for(let n in t){let i=t[n];if(!this._templateRegexValidation.test(i))continue;let r=xp(n),s=xm(n);this.patterns.push({pattern:n,template:i,isAbsolutePath:r,parsedPattern:s})}this.patterns.sort((n,i)=>this.patternWeight(i.pattern)-this.patternWeight(n.pattern))}patternWeight(t){let n=0;for(let i of t.split("/"))i==="**"?n+=1:i==="*"?n+=10:i.includes("*")||i.includes("?")?n+=50:i!==""&&(n+=100);return n}getName(t){if(!this.enabled||this.patterns.length===0)return;let n=t.toString(),i=this.cache.get(n);if(i!==void 0)return i??void 0;let r=this.applyPatterns(t);return this.cache.set(n,r??null),r}applyPatterns(t){let n=this.workspaceContextService.getWorkspaceFolder(t),i;for(let r of this.patterns){let s;if(n&&!r.isAbsolutePath?(i||(i=Zc(as(n.uri),t)??t.path),s=i):s=t.path,r.parsedPattern(s))return this.applyTemplate(r.template,t,s)}}_parsedTemplateExpression=/\$\{(dirname|filename|extname|extname\((?<extnameN>[-+]?\d+)\)|dirname\((?<dirnameN>[-+]?\d+)\))\}/g;_filenameCaptureExpression=/(?<filename>^\.*[^.]*)/;applyTemplate(t,n,i){let r;return t.replace(this._parsedTemplateExpression,(s,a,...l)=>{r=r??W1(n.path);let{dirnameN:d="0",extnameN:c="0"}=l.pop();if(a==="filename"){let{filename:u}=this._filenameCaptureExpression.exec(r.base)?.groups??{};if(u)return u}else if(a==="extname"){let u=this.getExtnames(r.base);if(u)return u}else if(a.startsWith("extname")){let u=parseInt(c),h=this.getNthExtname(r.base,u);if(h)return h}else if(a.startsWith("dirname")){let u=parseInt(d),h=this.getNthDirname(Pc(i),u);if(h)return h}return s})}removeLeadingDot(t){let n=t;for(;n.startsWith(".");)n=n.slice(1);return n}getNthDirname(t,n){t=t.startsWith("/")?t.slice(1):t;let i=t.split("/");return this.getNthFragment(i,n)}getExtnames(t){return this.removeLeadingDot(t).split(".").slice(1).join(".")}getNthExtname(t,n){let i=this.removeLeadingDot(t).split(".");return i.shift(),this.getNthFragment(i,n)}getNthFragment(t,n){let i=t.length,r;n<0?r=Math.abs(n)-1:r=i-n-1;let s=t[r];if(!(s===void 0||s===""))return s}};Ps=R([S(0,Et),S(1,fs)],Ps);var Al=Y("ICustomEditorLabelService");fi(Al,Ps,1);var hh=class extends Hr{constructor(t,n,i,r,s,a,l){super();this.resource=t;this.labelService=i;this.fileService=r;this.filesConfigurationService=s;this.textResourceConfigurationService=a;this.customEditorLabelService=l;this._preferredResource=n||t,this.registerListeners()}get capabilities(){let t=32;return this.fileService.hasProvider(this.resource)?this.filesConfigurationService.isReadonly(this.resource)&&(t|=2):t|=4,t&2||(t|=128),t}_preferredResource;get preferredResource(){return this._preferredResource}registerListeners(){this._register(this.labelService.onDidChangeFormatters(t=>this.onLabelEvent(t.scheme))),this._register(this.fileService.onDidChangeFileSystemProviderRegistrations(t=>this.onLabelEvent(t.scheme))),this._register(this.fileService.onDidChangeFileSystemProviderCapabilities(t=>this.onLabelEvent(t.scheme))),this._register(this.customEditorLabelService.onDidChange(()=>this.updateLabel()))}onLabelEvent(t){t===this._preferredResource.scheme&&this.updateLabel()}updateLabel(){this._name=void 0,this._shortDescription=void 0,this._mediumDescription=void 0,this._longDescription=void 0,this._shortTitle=void 0,this._mediumTitle=void 0,this._longTitle=void 0,this._onDidChangeLabel.fire()}setPreferredResource(t){Yn(t,this._preferredResource)||(this._preferredResource=t,this.updateLabel())}_name=void 0;getName(){return typeof this._name!="string"&&(this._name=this.customEditorLabelService.getName(this._preferredResource)??this.labelService.getUriBasenameLabel(this._preferredResource)),this._name}getDescription(t=1){switch(t){case 0:return this.shortDescription;case 2:return this.longDescription;case 1:default:return this.mediumDescription}}_shortDescription=void 0;get shortDescription(){return typeof this._shortDescription!="string"&&(this._shortDescription=this.labelService.getUriBasenameLabel(as(this._preferredResource))),this._shortDescription}_mediumDescription=void 0;get mediumDescription(){return typeof this._mediumDescription!="string"&&(this._mediumDescription=this.labelService.getUriLabel(as(this._preferredResource),{relative:!0})),this._mediumDescription}_longDescription=void 0;get longDescription(){return typeof this._longDescription!="string"&&(this._longDescription=this.labelService.getUriLabel(as(this._preferredResource))),this._longDescription}_shortTitle=void 0;get shortTitle(){return typeof this._shortTitle!="string"&&(this._shortTitle=this.getName()),this._shortTitle}_mediumTitle=void 0;get mediumTitle(){return typeof this._mediumTitle!="string"&&(this._mediumTitle=this.labelService.getUriLabel(this._preferredResource,{relative:!0})),this._mediumTitle}_longTitle=void 0;get longTitle(){return typeof this._longTitle!="string"&&(this._longTitle=this.labelService.getUriLabel(this._preferredResource)),this._longTitle}getTitle(t){switch(t){case 0:return this.shortTitle;case 2:return this.longTitle;default:case 1:return this.mediumTitle}}isReadonly(){return this.filesConfigurationService.isReadonly(this.resource)}ensureLimits(t){if(t?.limits)return t.limits;let n=WO(this.resource),i,r=this.textResourceConfigurationService.inspect(this.resource,null,"workbench.editorLargeFileConfirmation");return tM(r)&&(i=r.value*_l.MB),{size:i??n}}};hh=R([S(2,Wr),S(3,zt),S(4,Ns),S(5,Kn),S(6,Al)],hh);var ph=class extends cr{constructor(e,t,n,i,r){super(n,t,i,r,e)}dispose(){this.textEditorModelHandle&&this.modelService.destroyModel(this.textEditorModelHandle),super.dispose()}};ph=R([S(1,Bi),S(2,Vr),S(3,qu),S(4,Co)],ph);var tc=class extends hh{constructor(t,n,i,r,s,a,l,d,c){super(t,n,s,a,l,d,c);this.editorService=i;this.textFileService=r}save(t,n){return this.resource.scheme!==Te.untitled&&!this.fileService.hasProvider(this.resource)?this.saveAs(t,n):this.doSave(n,!1,t)}saveAs(t,n){return this.doSave(n,!0,t)}async doSave(t,n,i){let r;if(n?r=await this.textFileService.saveAs(this.resource,void 0,{...t,suggestedTarget:this.preferredResource}):r=await this.textFileService.save(this.resource,t),!!r)return{resource:r}}async revert(t,n){await this.textFileService.revert(this.resource,n)}};tc=R([S(2,gn),S(3,Xd),S(4,Wr),S(5,zt),S(6,Ns),S(7,Kn),S(8,Al)],tc);var zr=class extends tc{constructor(t,n,i,r,s,a,l,d,c,u,h,m,f){super(t,void 0,d,l,u,c,h,m,f);this.name=n;this.description=i;this.preferredLanguageId=r;this.preferredContents=s;this.textModelService=a}static ID="workbench.editors.resourceEditorInput";get typeId(){return zr.ID}get editorId(){return uh.id}cachedModel=void 0;modelReference=void 0;getName(){return this.name||super.getName()}setName(t){this.name!==t&&(this.name=t,this._onDidChangeLabel.fire())}getDescription(){return this.description}setDescription(t){this.description!==t&&(this.description=t,this._onDidChangeLabel.fire())}setLanguageId(t,n){this.setPreferredLanguageId(t),this.cachedModel?.setLanguageId(t,n)}setPreferredLanguageId(t){this.preferredLanguageId=t}setPreferredContents(t){this.preferredContents=t}async resolve(){let t=this.preferredContents,n=this.preferredLanguageId;this.preferredContents=void 0,this.preferredLanguageId=void 0,this.modelReference||(this.modelReference=this.textModelService.createModelReference(this.resource));let i=await this.modelReference,r=i.object;if(!(r instanceof ph))throw i.dispose(),this.modelReference=void 0,new Error(`Unexpected model for TextResourceEditorInput: ${this.resource}`);return this.cachedModel=r,(typeof t=="string"||typeof n=="string")&&r.updateTextEditorModel(typeof t=="string"?ug(t):void 0,n),r}matches(t){return this===t?!0:t instanceof zr?Yn(t.resource,this.resource):pI(t)?super.matches(t):!1}dispose(){this.modelReference&&(this.modelReference.then(t=>t.dispose()),this.modelReference=void 0),this.cachedModel=void 0,super.dispose()}};zr=R([S(5,Xm),S(6,Xd),S(7,gn),S(8,zt),S(9,Wr),S(10,Ns),S(11,Kn),S(12,Al)],zr);var wa=Go;function uP(o){return o.scheme!==Te.file&&o.scheme!==Te.vscodeRemote}function t5(o){if(o.folders.length)return o.folders.every(e=>uP(e.uri))?o.folders[0].uri:void 0;if(o.configuration&&uP(o.configuration))return o.configuration}function hP(o){return t5(o)?.scheme}function pP(o){switch(o){case 100:return"req";case 101:return"cancel";case 102:return"subscribe";case 103:return"unsubscribe"}}function mP(o){switch(o){case 200:return"init";case 201:return"reply:";case 202:case 203:return"replyErr:";case 204:return"event:"}}function mh(o){let e=0;for(let t=0;;t+=7){let n=o.read(1);if(e|=(n.buffer[0]&127)<<t,!(n.buffer[0]&128))return e}}var n5=Ol(0);function gh(o,e){if(e===0){o.write(n5);return}let t=0;for(let i=e;i!==0;i=i>>>7)t++;let n=Cn.alloc(t);for(let i=0;e!==0;i++)n.buffer[i]=e&127,e=e>>>7,e>0&&(n.buffer[i]|=128);o.write(n)}var FL=class{constructor(e){this.buffer=e}pos=0;read(e){let t=this.buffer.slice(this.pos,this.pos+e);return this.pos+=t.byteLength,t}},BL=class{buffers=[];get buffer(){return Cn.concat(this.buffers)}write(e){this.buffers.push(e)}};function Ol(o){let e=Cn.alloc(1);return e.writeUInt8(o,0),e}var nc={Undefined:Ol(0),String:Ol(1),Buffer:Ol(2),VSBuffer:Ol(3),Array:Ol(4),Object:Ol(5),Uint:Ol(6)},i5=typeof Buffer<"u";function VL(o,e){if(typeof e>"u")o.write(nc.Undefined);else if(typeof e=="string"){let t=Cn.fromString(e);o.write(nc.String),gh(o,t.byteLength),o.write(t)}else if(i5&&Buffer.isBuffer(e)){let t=Cn.wrap(e);o.write(nc.Buffer),gh(o,t.byteLength),o.write(t)}else if(e instanceof Cn)o.write(nc.VSBuffer),gh(o,e.byteLength),o.write(e);else if(Array.isArray(e)){o.write(nc.Array),gh(o,e.length);for(let t of e)VL(o,t)}else if(typeof e=="number"&&(e|0)===e)o.write(nc.Uint),gh(o,e);else{let t=Cn.fromString(JSON.stringify(e));o.write(nc.Object),gh(o,t.byteLength),o.write(t)}}function WL(o){switch(o.read(1).readUInt8(0)){case 0:return;case 1:return o.read(mh(o)).toString();case 2:return o.read(mh(o)).buffer;case 3:return o.read(mh(o));case 4:{let t=mh(o),n=[];for(let i=0;i<t;i++)n.push(WL(o));return n}case 5:return JSON.parse(o.read(mh(o)).toString());case 6:return mh(o)}}var PL=class{constructor(e,t=null){this.protocol=e;this.protocolListener=this.protocol.onMessage(n=>this.onBuffer(n)),this.logger=t}isDisposed=!1;state=0;activeRequests=new Set;handlers=new Map;lastRequestId=0;protocolListener;logger;_onDidInitialize=new E;onDidInitialize=this._onDidInitialize.event;getChannel(e){let t=this;return{call(n,i,r){return t.isDisposed?Promise.reject(new $i):t.requestPromise(e,n,i,r)},listen(n,i){return t.isDisposed?oe.None:t.requestEvent(e,n,i)}}}requestPromise(e,t,n,i=pn.None){let r=this.lastRequestId++,a={id:r,type:100,channelName:e,name:t,arg:n};if(i.isCancellationRequested)return Promise.reject(new $i);let l;return new Promise((c,u)=>{if(i.isCancellationRequested)return u(new $i);let h=()=>{let b=y=>{switch(y.type){case 201:this.handlers.delete(r),c(y.data);break;case 202:{this.handlers.delete(r);let C=new Error(y.data.message);C.stack=Array.isArray(y.data.stack)?y.data.stack.join(`
`):y.data.stack,C.name=y.data.name,u(C);break}case 203:this.handlers.delete(r),u(y.data);break}};this.handlers.set(r,b),this.sendRequest(a)},m=null;this.state===1?h():(m=gd(b=>this.whenInitialized()),m.then(()=>{m=null,h()}));let f=()=>{m?(m.cancel(),m=null):this.sendRequest({id:r,type:101}),u(new $i)},g=i.onCancellationRequested(f);l=yr(ve(f),g),this.activeRequests.add(l)}).finally(()=>{l.dispose(),this.activeRequests.delete(l)})}requestEvent(e,t,n){let i=this.lastRequestId++,s={id:i,type:102,channelName:e,name:t,arg:n},a=null,l=new E({onWillAddFirstListener:()=>{a=gd(c=>this.whenInitialized()),a.then(()=>{a=null,this.activeRequests.add(l),this.sendRequest(s)})},onDidRemoveLastListener:()=>{a?(a.cancel(),a=null):(this.activeRequests.delete(l),this.sendRequest({id:i,type:103}))}}),d=c=>l.fire(c.data);return this.handlers.set(i,d),l.event}sendRequest(e){switch(e.type){case 100:case 102:{let t=this.send([e.type,e.id,e.channelName,e.name],e.arg);this.logger?.logOutgoing(t,e.id,0,`${pP(e.type)}: ${e.channelName}.${e.name}`,e.arg);return}case 101:case 103:{let t=this.send([e.type,e.id]);this.logger?.logOutgoing(t,e.id,0,pP(e.type));return}}}send(e,t=void 0){let n=new BL;return VL(n,e),VL(n,t),this.sendBuffer(n.buffer)}sendBuffer(e){try{return this.protocol.send(e),e.byteLength}catch{return 0}}onBuffer(e){let t=new FL(e),n=WL(t),i=WL(t),r=n[0];switch(r){case 200:return this.logger?.logIncoming(e.byteLength,0,0,mP(r)),this.onResponse({type:n[0]});case 201:case 202:case 204:case 203:return this.logger?.logIncoming(e.byteLength,n[1],0,mP(r),i),this.onResponse({type:n[0],id:n[1],data:i})}}onResponse(e){if(e.type===200){this.state=1,this._onDidInitialize.fire();return}this.handlers.get(e.id)?.(e)}get onDidInitializePromise(){return oe.toPromise(this.onDidInitialize)}whenInitialized(){return this.state===1?Promise.resolve():this.onDidInitializePromise}dispose(){this.isDisposed=!0,this.protocolListener&&(this.protocolListener.dispose(),this.protocolListener=null),kt(this.activeRequests.values()),this.activeRequests.clear()}};R([de],PL.prototype,"onDidInitializePromise",1);var o5;(i=>{function o(r,s,a){let l=r,d=a&&a.disableMarshalling,c=new Map;for(let u in l)t(u)&&c.set(u,oe.buffer(l[u],!0,void 0,s));return new class{listen(u,h,m){let f=c.get(h);if(f)return f;let g=l[h];if(typeof g=="function"){if(n(h))return g.call(l,m);if(t(h))return c.set(h,oe.buffer(l[h],!0,void 0,s)),c.get(h)}throw new Ys(`Event not found: ${h}`)}call(u,h,m){let f=l[h];if(typeof f=="function"){if(!d&&Array.isArray(m))for(let b=0;b<m.length;b++)m[b]=Gu(m[b]);let g=f.apply(l,m);return g instanceof Promise||(g=Promise.resolve(g)),g}throw new Ys(`Method not found: ${h}`)}}}i.fromService=o;function e(r,s){let a=s&&s.disableMarshalling;return new Proxy({},{get(l,d){if(typeof d=="string")return s?.properties?.has(d)?s.properties.get(d):n(d)?function(c){return r.listen(d,c)}:t(d)?r.listen(d):async function(...c){let u;s&&!pi(s.context)?u=[s.context,...c]:u=c;let h=await r.call(d,u);return a?h:Gu(h)};throw new Ys(`Property not found: ${String(d)}`)}})}i.toService=e;function t(r){return r[0]==="o"&&r[1]==="n"&&ss(r.charCodeAt(2))}function n(r){return/^onDynamic/.test(r)&&ss(r.charCodeAt(9))}})(o5||={});var r5="diagnosticsService",S4e=Y(r5);var s5;(s=>{s.enableDiagnostics=!1,s.records=[];let t=new WeakMap,n=0;function i(a,l){if(!t.has(a)){let d=String(++n);t.set(a,d)}return t.get(a)}function r(a,l,d,c){}s.traceSocketEvent=r})(s5||={});var W4e=Y("remoteAuthorityResolverService");var X4e=Y("remoteSocketFactoryService");var a5="signService",e5e=Y(a5);var R5e=30*1e3;var II=Y("remoteAgentService"),X5e=new class{maxSampleCount=5;sampleDelay=2e3;initial=[];maxInitialCount=3;average=[];maxAverageCount=100;highLatencyMultiple=2;highLatencyMinThreshold=500;highLatencyMaxThreshold=1500;lastMeasurement=void 0;get latency(){return this.lastMeasurement}async measure(o){let e=1/0;for(let n=0;n<this.maxSampleCount;n++){let i=await o.getRoundTripTime();if(i===void 0)return;e=Math.min(e,i/2),await vo(this.sampleDelay)}this.average.push(e),this.average.length>this.maxAverageCount&&this.average.shift();let t;return this.initial.length<this.maxInitialCount?this.initial.push(e):t=this.initial.reduce((n,i)=>n+i,0)/this.initial.length,this.lastMeasurement={initial:t,current:e,average:this.average.reduce((n,i)=>n+i,0)/this.average.length,high:typeof t>"u"?!1:e>this.highLatencyMaxThreshold||e>this.highLatencyMinThreshold&&e>t*this.highLatencyMultiple},this.lastMeasurement}};var fP=Y("pathService"),fh=class{constructor(e,t,n,i){this.localUserHome=e;this.remoteAgentService=t;this.environmentService=n;this.contextService=i;this.resolveOS=(async()=>(await this.remoteAgentService.getEnvironment())?.os||Zo)(),this.resolveUserHome=(async()=>{let r=await this.remoteAgentService.getEnvironment();return this.maybeUnresolvedUserHome=r?.userHome??e})()}resolveOS;resolveUserHome;maybeUnresolvedUserHome;hasValidBasename(e,t,n){return typeof t=="string"||typeof t>"u"?this.resolveOS.then(i=>this.doHasValidBasename(e,i,t)):this.doHasValidBasename(e,t,n)}doHasValidBasename(e,t,n){return e.scheme===Te.file||e.scheme===Te.vscodeRemote?Mk(n??xr(e),t===1):!0}get defaultUriScheme(){return fh.findDefaultUriScheme(this.environmentService,this.contextService)}static findDefaultUriScheme(e,t){if(e.remoteAuthority)return Te.vscodeRemote;let n=hP(t.getWorkspace());if(n)return n;let i=t.getWorkspace().folders[0];if(i)return i.uri.scheme;let r=t.getWorkspace().configuration;return r?r.scheme:Te.file}userHome(e){return e?.preferLocal?this.localUserHome:this.resolveUserHome}get resolvedUserHome(){return this.maybeUnresolvedUserHome}get path(){return this.resolveOS.then(e=>e===1?en:ot)}async fileURI(e){let t="";if(await this.resolveOS===1&&(e=e.replace(/\\/g,"/")),e[0]==="/"&&e[1]==="/"){let i=e.indexOf("/",2);i===-1?(t=e.substring(2),e="/"):(t=e.substring(2,i),e=e.substring(i)||"/")}return ie.from({scheme:Te.file,authority:t,path:e,query:"",fragment:""})}};fh=R([S(1,II),S(2,wa),S(3,fs)],fh);var Kr=class extends tc{constructor(t,n,i,r,s,a,l,d,c,u,h){super(t.resource,void 0,r,n,i,s,d,u,h);this.model=t;this.environmentService=a;this.pathService=l;this.textModelService=c;this.registerModelListeners(t),this._register(this.textFileService.untitled.onDidCreate(m=>this.onDidCreateUntitledModel(m)))}static ID="workbench.editors.untitledEditorInput";get typeId(){return Kr.ID}get editorId(){return uh.id}modelResolve=void 0;modelDisposables=this._register(new he);cachedUntitledTextEditorModelReference=void 0;registerModelListeners(t){this.modelDisposables.clear(),this.modelDisposables.add(t.onDidChangeDirty(()=>this._onDidChangeDirty.fire())),this.modelDisposables.add(t.onDidChangeName(()=>this._onDidChangeLabel.fire())),this.modelDisposables.add(t.onDidRevert(()=>this.dispose()))}onDidCreateUntitledModel(t){Yn(t.resource,this.model.resource)&&t!==this.model&&(this.model=t,this.registerModelListeners(t))}getName(){return this.model.name}getDescription(t=1){if(!this.model.hasAssociatedFilePath){let n=this.resource.path;return n!==this.getName()?n:void 0}return super.getDescription(t)}getTitle(t){if(!this.model.hasAssociatedFilePath){let n=this.getName(),i=this.getDescription();return i&&i!==n?`${n} \u2022 ${i}`:n}return super.getTitle(t)}isDirty(){return this.model.isDirty()}getEncoding(){return this.model.getEncoding()}setEncoding(t,n){return this.model.setEncoding(t)}get hasLanguageSetExplicitly(){return this.model.hasLanguageSetExplicitly}get hasAssociatedFilePath(){return this.model.hasAssociatedFilePath}setLanguageId(t,n){this.model.setLanguageId(t,n)}getLanguageId(){return this.model.getLanguageId()}async resolve(){return this.modelResolve||(this.modelResolve=(async()=>{this.cachedUntitledTextEditorModelReference=await this.textModelService.createModelReference(this.resource)})()),await this.modelResolve,this.isDisposed()&&this.disposeModelReference(),this.model}toUntyped(t){let n={resource:this.model.hasAssociatedFilePath?Wk(this.model.resource,this.environmentService.remoteAuthority,this.pathService.defaultUriScheme):this.resource,forceUntitled:!0,options:{override:this.editorId}};return typeof t?.preserveViewState=="number"&&(n.encoding=this.getEncoding(),n.languageId=this.getLanguageId(),n.contents=this.model.isModified()?this.model.textEditorModel?.getValue():void 0,n.options.viewState=sh(this,t.preserveViewState,this.editorService),typeof n.contents=="string"&&!this.model.hasAssociatedFilePath&&!t.preserveResource&&(n.resource=void 0)),n}matches(t){return this===t?!0:t instanceof Kr?Yn(t.resource,this.resource):cP(t)?super.matches(t):!1}dispose(){this.modelResolve=void 0,this.disposeModelReference(),super.dispose()}disposeModelReference(){kt(this.cachedUntitledTextEditorModelReference),this.cachedUntitledTextEditorModelReference=void 0}};Kr=R([S(1,Xd),S(2,Wr),S(3,gn),S(4,zt),S(5,wa),S(6,fP),S(7,Ns),S(8,Xm),S(9,Kn),S(10,Al)],Kr);var bP=Y("markerDecorationsService");var Nl=Y("codeEditorService");var ic=class{id;precondition;_kbOpts;_menuOpts;metadata;constructor(e){this.id=e.id,this.precondition=e.precondition,this._kbOpts=e.kbOpts,this._menuOpts=e.menuOpts,this.metadata=e.metadata}register(){if(Array.isArray(this._menuOpts)?this._menuOpts.forEach(this._registerMenuItem,this):this._menuOpts&&this._registerMenuItem(this._menuOpts),this._kbOpts){let e=Array.isArray(this._kbOpts)?this._kbOpts:[this._kbOpts];for(let t of e){let n=t.kbExpr;this.precondition&&(n?n=xt.and(n,this.precondition):n=this.precondition);let i={id:this.id,weight:t.weight,args:t.args,when:n,primary:t.primary,secondary:t.secondary,win:t.win,linux:t.linux,mac:t.mac};aa.registerKeybindingRule(i)}}Rr.registerCommand({id:this.id,handler:(e,t)=>this.runCommand(e,t),metadata:this.metadata})}_registerMenuItem(e){hl.appendMenuItem(e.menuId,{group:e.group,command:{id:this.id,title:e.title,icon:e.icon,precondition:this.precondition},when:e.when,order:e.order})}},bg=class extends ic{_implementations=[];addImplementation(e,t,n,i){return this._implementations.push({priority:e,name:t,implementation:n,when:i}),this._implementations.sort((r,s)=>s.priority-r.priority),{dispose:()=>{for(let r=0;r<this._implementations.length;r++)if(this._implementations[r].implementation===n){this._implementations.splice(r,1);return}}}}runCommand(e,t){let n=e.get(Un),i=e.get(ft);n.trace(`Executing Command '${this.id}' which has ${this._implementations.length} bound.`);for(let r of this._implementations){if(r.when){let a=i.getContext(eo());if(!r.when.evaluate(a))continue}let s=r.implementation(e,t);if(s)return n.trace(`Command '${this.id}' was handled by '${r.name}'.`),typeof s=="boolean"?void 0:s}n.trace(`The Command '${this.id}' was not handled by any implementation.`)}},CI=class extends ic{constructor(t,n){super(n);this.command=t}runCommand(t,n){return this.command.runCommand(t,n)}},vg=class o extends ic{static bindToContribution(e){return class extends o{_callback;constructor(n){super(n),this._callback=n.handler}runEditorCommand(n,i,r){let s=e(i);s&&this._callback(s,r)}}}static runEditorCommand(e,t,n,i){let r=e.get(Nl),s=r.getFocusedCodeEditor()||r.getActiveCodeEditor();if(s)return s.invokeWithinContext(a=>{if(a.get(ft).contextMatchesRules(n??void 0))return i(a,s,t)})}runCommand(e,t){return o.runEditorCommand(e,t,this.precondition,(n,i,r)=>this.runEditorCommand(n,i,r))}};function Ve(o){return Fs.INSTANCE.registerEditorCommand(o),o}function yP(o,e,t){Fs.INSTANCE.registerEditorContribution(o,e,t)}var yg;(r=>{function o(s){return Fs.INSTANCE.getEditorCommand(s)}r.getEditorCommand=o;function e(){return Fs.INSTANCE.getEditorActions()}r.getEditorActions=e;function t(){return Fs.INSTANCE.getEditorContributions()}r.getEditorContributions=t;function n(s){return Fs.INSTANCE.getEditorContributions().filter(a=>s.indexOf(a.id)>=0)}r.getSomeEditorContributions=n;function i(){return Fs.INSTANCE.getDiffEditorContributions()}r.getDiffEditorContributions=i})(yg||={});var d5={EditorCommonContributions:"editor.contributions"},Fs=class o{static INSTANCE=new o;editorContributions=[];diffEditorContributions=[];editorActions=[];editorCommands=Object.create(null);constructor(){}registerEditorContribution(e,t,n){this.editorContributions.push({id:e,ctor:t,instantiation:n})}getEditorContributions(){return this.editorContributions.slice(0)}registerDiffEditorContribution(e,t){this.diffEditorContributions.push({id:e,ctor:t})}getDiffEditorContributions(){return this.diffEditorContributions.slice(0)}registerEditorAction(e){e.register(),this.editorActions.push(e)}getEditorActions(){return this.editorActions}registerEditorCommand(e){e.register(),this.editorCommands[e.id]=e}getEditorCommand(e){return this.editorCommands[e]||null}};et.add(d5.EditorCommonContributions,Fs.INSTANCE);function Ig(o){return o.register(),o}var HL=Ig(new bg({id:"undo",precondition:void 0,kbOpts:{weight:0,primary:2104},menuOpts:[{menuId:Ln.MenubarEditMenu,group:"1_do",title:p({key:"miUndo",comment:["&& denotes a mnemonic"]},"&&Undo"),order:1},{menuId:Ln.CommandPalette,group:"",title:p("undo","Undo"),order:1}]}));Ig(new CI(HL,{id:"default:undo",precondition:void 0}));var UL=Ig(new bg({id:"redo",precondition:void 0,kbOpts:{weight:0,primary:2103,secondary:[3128],mac:{primary:3128}},menuOpts:[{menuId:Ln.MenubarEditMenu,group:"1_do",title:p({key:"miRedo",comment:["&& denotes a mnemonic"]},"&&Redo"),order:2},{menuId:Ln.CommandPalette,group:"",title:p("redo","Redo"),order:1}]}));Ig(new CI(UL,{id:"default:redo",precondition:void 0}));var IP=Ig(new bg({id:"editor.action.selectAll",precondition:void 0,kbOpts:{weight:0,kbExpr:null,primary:2079},menuOpts:[{menuId:Ln.MenubarSelectionMenu,group:"1_basic",title:p({key:"miSelectAll",comment:["&& denotes a mnemonic"]},"&&Select All"),order:1},{menuId:Ln.CommandPalette,group:"",title:p("selectAll","Select All"),order:1}]}));var bh=class{static ID="editor.contrib.markerDecorations";constructor(e,t){}dispose(){}};bh=R([S(1,bP)],bh);yP(bh.ID,bh,0);var xa;(W=>{let o={total:0,min:Number.MAX_VALUE,max:0},e={...o},t={...o},n={...o},i=0,r;(q=>(q[q.Before=0]="Before",q[q.InProgress=1]="InProgress",q[q.Finished=2]="Finished"))(r||={});let s={keydown:0,input:0,render:0};function a(){y(),performance.mark("inputlatency/start"),performance.mark("keydown/start"),s.keydown=1,queueMicrotask(l)}W.onKeyDown=a;function l(){s.keydown===1&&(performance.mark("keydown/end"),s.keydown=2)}function d(){performance.mark("input/start"),s.input=1,b()}W.onBeforeInput=d;function c(){s.input===0&&d(),queueMicrotask(u)}W.onInput=c;function u(){s.input===1&&(performance.mark("input/end"),s.input=2)}function h(){y()}W.onKeyUp=h;function m(){y()}W.onSelectionChange=m;function f(){s.keydown===2&&s.input===2&&s.render===0&&(performance.mark("render/start"),s.render=1,queueMicrotask(g),b())}W.onRenderStart=f;function g(){s.render===1&&(performance.mark("render/end"),s.render=2)}function b(){setTimeout(y)}function y(){s.keydown===2&&s.input===2&&s.render===2&&(performance.mark("inputlatency/end"),performance.measure("keydown","keydown/start","keydown/end"),performance.measure("input","input/start","input/end"),performance.measure("render","render/start","render/end"),performance.measure("inputlatency","inputlatency/start","inputlatency/end"),C("keydown",o),C("input",e),C("render",t),C("inputlatency",n),i++,x())}function C(z,B){let G=performance.getEntriesByName(z)[0].duration;B.total+=G,B.min=Math.min(B.min,G),B.max=Math.max(B.max,G)}function x(){performance.clearMarks("keydown/start"),performance.clearMarks("keydown/end"),performance.clearMarks("input/start"),performance.clearMarks("input/end"),performance.clearMarks("render/start"),performance.clearMarks("render/end"),performance.clearMarks("inputlatency/start"),performance.clearMarks("inputlatency/end"),performance.clearMeasures("keydown"),performance.clearMeasures("input"),performance.clearMeasures("render"),performance.clearMeasures("inputlatency"),s.keydown=0,s.input=0,s.render=0}function L(){if(i===0)return;let z={keydown:k(o),input:k(e),render:k(t),total:k(n),sampleCount:i};return O(o),O(e),O(t),O(n),i=0,z}W.getAndClearMeasurements=L;function k(z){return{average:z.total/i,max:z.max,min:z.min}}function O(z){z.total=0,z.min=Number.MAX_VALUE,z.max=0}})(xa||={});var Bs=class{_hooks=new he;_pointerMoveCallback=null;_onStopCallback=null;dispose(){this.stopMonitoring(!1),this._hooks.dispose()}stopMonitoring(e,t){if(!this.isMonitoring())return;this._hooks.clear(),this._pointerMoveCallback=null;let n=this._onStopCallback;this._onStopCallback=null,e&&n&&n(t)}isMonitoring(){return!!this._pointerMoveCallback}startMonitoring(e,t,n,i,r){this.isMonitoring()&&this.stopMonitoring(!1),this._pointerMoveCallback=i,this._onStopCallback=r;let s=e;try{e.setPointerCapture(t),this._hooks.add(ve(()=>{try{e.releasePointerCapture(t)}catch{}}))}catch{s=Ie(e)}this._hooks.add(U(s,ae.POINTER_MOVE,a=>{if(a.buttons!==n){this.stopMonitoring(!0);return}a.preventDefault(),this._pointerMoveCallback(a)})),this._hooks.add(U(s,ae.POINTER_UP,a=>this.stopMonitoring(!0)))}};var Pl=class{constructor(e,t){this.x=e;this.y=t}_pageCoordinatesBrand=void 0;toClientCoordinates(e){return new Cg(this.x-e.scrollX,this.y-e.scrollY)}},Cg=class{constructor(e,t){this.clientX=e;this.clientY=t}_clientCoordinatesBrand=void 0;toPageCoordinates(e){return new Pl(this.clientX+e.scrollX,this.clientY+e.scrollY)}},zL=class{constructor(e,t,n,i){this.x=e;this.y=t;this.width=n;this.height=i}_editorPagePositionBrand=void 0},KL=class{constructor(e,t){this.x=e;this.y=t}_positionRelativeToEditorBrand=void 0};function EI(o){let e=yo(o);return new zL(e.left,e.top,e.width,e.height)}function _I(o,e,t){let n=e.width/o.offsetWidth,i=e.height/o.offsetHeight,r=(t.x-e.x)/n,s=(t.y-e.y)/i;return new KL(r,s)}var ur=class extends hi{_editorMouseEventBrand=void 0;isFromPointerCapture;pos;editorPos;relativePos;constructor(e,t,n){super(Ie(n),e),this.isFromPointerCapture=t,this.pos=new Pl(this.posx,this.posy),this.editorPos=EI(n),this.relativePos=_I(n,this.editorPos,this.pos)}},SI=class{_editorViewDomNode;constructor(e){this._editorViewDomNode=e}_create(e){return new ur(e,!1,this._editorViewDomNode)}onContextMenu(e,t){return U(e,"contextmenu",n=>{t(this._create(n))})}onMouseUp(e,t){return U(e,"mouseup",n=>{t(this._create(n))})}onMouseDown(e,t){return U(e,ae.MOUSE_DOWN,n=>{t(this._create(n))})}onPointerDown(e,t){return U(e,ae.POINTER_DOWN,n=>{t(this._create(n),n.pointerId)})}onMouseLeave(e,t){return U(e,ae.MOUSE_LEAVE,n=>{t(this._create(n))})}onMouseMove(e,t){return U(e,"mousemove",n=>t(this._create(n)))}},wI=class{_editorViewDomNode;constructor(e){this._editorViewDomNode=e}_create(e){return new ur(e,!1,this._editorViewDomNode)}onPointerUp(e,t){return U(e,"pointerup",n=>{t(this._create(n))})}onPointerDown(e,t){return U(e,ae.POINTER_DOWN,n=>{t(this._create(n),n.pointerId)})}onPointerLeave(e,t){return U(e,ae.POINTER_LEAVE,n=>{t(this._create(n))})}onPointerMove(e,t){return U(e,"pointermove",n=>t(this._create(n)))}},xI=class extends V{_editorViewDomNode;_globalPointerMoveMonitor;_keydownListener;constructor(e){super(),this._editorViewDomNode=e,this._globalPointerMoveMonitor=this._register(new Bs),this._keydownListener=null}startMonitoring(e,t,n,i,r){this._keydownListener=Jt(e.ownerDocument,"keydown",s=>{s.toKeyCodeChord().isModifierKey()||this._globalPointerMoveMonitor.stopMonitoring(!0,s.browserEvent)},!0),this._globalPointerMoveMonitor.startMonitoring(e,t,n,s=>{i(new ur(s,!0,this._editorViewDomNode))},s=>{this._keydownListener.dispose(),r(s)})}stopMonitoring(){this._globalPointerMoveMonitor.stopMonitoring(!0)}};var TI=class{selections;startLineNumber;endLineNumber;relativeVerticalOffset;visibleRange;bigNumbersDelta;whitespaceViewportData;_model;lineHeight;constructor(e,t,n,i){this.selections=e,this.startLineNumber=t.startLineNumber|0,this.endLineNumber=t.endLineNumber|0,this.relativeVerticalOffset=t.relativeVerticalOffset,this.bigNumbersDelta=t.bigNumbersDelta|0,this.lineHeight=t.lineHeight|0,this.whitespaceViewportData=n,this._model=i,this.visibleRange=new D(t.startLineNumber,this._model.getLineMinColumn(t.startLineNumber),t.endLineNumber,this._model.getLineMaxColumn(t.endLineNumber))}getViewLineRenderingData(e){return this._model.getViewportViewLineRenderingData(this.visibleRange,e)}getDecorationsInViewport(){return this._model.getDecorationsInViewport(this.visibleRange)}};var GL=class{_restrictedRenderingContextBrand=void 0;viewportData;scrollWidth;scrollHeight;visibleRange;bigNumbersDelta;scrollTop;scrollLeft;viewportWidth;viewportHeight;_viewLayout;constructor(e,t){this._viewLayout=e,this.viewportData=t,this.scrollWidth=this._viewLayout.getScrollWidth(),this.scrollHeight=this._viewLayout.getScrollHeight(),this.visibleRange=this.viewportData.visibleRange,this.bigNumbersDelta=this.viewportData.bigNumbersDelta;let n=this._viewLayout.getCurrentViewport();this.scrollTop=n.top,this.scrollLeft=n.left,this.viewportWidth=n.width,this.viewportHeight=n.height}getScrolledTopFromAbsoluteTop(e){return e-this.scrollTop}getVerticalOffsetForLineNumber(e,t){return this._viewLayout.getVerticalOffsetForLineNumber(e,t)}getVerticalOffsetAfterLineNumber(e,t){return this._viewLayout.getVerticalOffsetAfterLineNumber(e,t)}getDecorationsInViewport(){return this.viewportData.getDecorationsInViewport()}},LI=class extends GL{_renderingContextBrand=void 0;_viewLines;constructor(e,t,n){super(e,t),this._viewLines=n}linesVisibleRangesForRange(e,t){return this._viewLines.linesVisibleRangesForRange(e,t)}visibleRangeForPosition(e){return this._viewLines.visibleRangeForPosition(e)}},DI=class{constructor(e,t,n,i){this.outsideRenderedLine=e;this.lineNumber=t;this.ranges=n;this.continuesOnNextLine=i}static firstLine(e){if(!e)return null;let t=null;for(let n of e)(!t||n.lineNumber<t.lineNumber)&&(t=n);return t}static lastLine(e){if(!e)return null;let t=null;for(let n of e)(!t||n.lineNumber>t.lineNumber)&&(t=n);return t}},vh=class o{_horizontalRangeBrand=void 0;left;width;static from(e){let t=new Array(e.length);for(let n=0,i=e.length;n<i;n++){let r=e[n];t[n]=new o(r.left,r.width)}return t}constructor(e,t){this.left=Math.round(e),this.width=Math.round(t)}toString(){return`[${this.left},${this.width}]`}},Gr=class{_floatHorizontalRangeBrand=void 0;left;width;constructor(e,t){this.left=e,this.width=t}toString(){return`[${this.left},${this.width}]`}static compare(e,t){return e.left-t.left}},kI=class{outsideRenderedLine;left;originalLeft;constructor(e,t){this.outsideRenderedLine=e,this.originalLeft=t,this.left=Math.round(this.originalLeft)}},Sg=class{constructor(e,t){this.outsideRenderedLine=e;this.ranges=t}};var RI=class{configuration;viewModel;viewLayout;theme;constructor(e,t,n){this.configuration=e,this.theme=new sy(t),this.viewModel=n,this.viewLayout=n.viewLayout}addEventHandler(e){this.viewModel.addViewEventHandler(e)}removeEventHandler(e){this.viewModel.removeViewEventHandler(e)}};var At=class extends dr{_context;constructor(e){super(),this._context=e,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}};var Rn=class{static write(e,t){e.setAttribute("data-mprt",String(t))}static read(e){let t=e.getAttribute("data-mprt");return t===null?0:parseInt(t,10)}static collect(e,t){let n=[],i=0;for(;e&&e!==e.ownerDocument.body&&e!==t;)e.nodeType===e.ELEMENT_NODE&&(n[i++]=this.read(e)),e=e.parentElement;let r=new Uint8Array(i);for(let s=0;s<i;s++)r[s]=n[i-s-1];return r}};function MI(o,e){let t=globalThis.MonacoEnvironment;if(t?.createTrustedTypesPolicy)try{return t.createTrustedTypesPolicy(o,e)}catch(n){je(n);return}try{return globalThis.trustedTypes?.createPolicy(o,e)}catch(n){je(n);return}}var wg=class{constructor(e){this._lineFactory=e;this._set(1,[])}_lines;_rendLineNumberStart;flush(){this._set(1,[])}_set(e,t){this._lines=t,this._rendLineNumberStart=e}_get(){return{rendLineNumberStart:this._rendLineNumberStart,lines:this._lines}}getStartLineNumber(){return this._rendLineNumberStart}getEndLineNumber(){return this._rendLineNumberStart+this._lines.length-1}getCount(){return this._lines.length}getLine(e){let t=e-this._rendLineNumberStart;if(t<0||t>=this._lines.length)throw new Qe("Illegal value for lineNumber");return this._lines[t]}onLinesDeleted(e,t){if(this.getCount()===0)return null;let n=this.getStartLineNumber(),i=this.getEndLineNumber();if(t<n){let l=t-e+1;return this._rendLineNumberStart-=l,null}if(e>i)return null;let r=0,s=0;for(let l=n;l<=i;l++){let d=l-this._rendLineNumberStart;e<=l&&l<=t&&(s===0?(r=d,s=1):s++)}if(e<n){let l=0;t<n?l=t-e+1:l=n-e,this._rendLineNumberStart-=l}return this._lines.splice(r,s)}onLinesChanged(e,t){let n=e+t-1;if(this.getCount()===0)return!1;let i=this.getStartLineNumber(),r=this.getEndLineNumber(),s=!1;for(let a=e;a<=n;a++)a>=i&&a<=r&&(this._lines[a-this._rendLineNumberStart].onContentChanged(),s=!0);return s}onLinesInserted(e,t){if(this.getCount()===0)return null;let n=t-e+1,i=this.getStartLineNumber(),r=this.getEndLineNumber();if(e<=i)return this._rendLineNumberStart+=n,null;if(e>r)return null;if(n+e>r)return this._lines.splice(e-this._rendLineNumberStart,r-e+1);let s=[];for(let u=0;u<n;u++)s[u]=this._lineFactory.createLine();let a=e-this._rendLineNumberStart,l=this._lines.slice(0,a),d=this._lines.slice(a,this._lines.length-n),c=this._lines.slice(this._lines.length-n,this._lines.length);return this._lines=l.concat(s).concat(d),c}onTokensChanged(e){if(this.getCount()===0)return!1;let t=this.getStartLineNumber(),n=this.getEndLineNumber(),i=!1;for(let r=0,s=e.length;r<s;r++){let a=e[r];if(a.toLineNumber<t||a.fromLineNumber>n)continue;let l=Math.max(t,a.fromLineNumber),d=Math.min(n,a.toLineNumber);for(let c=l;c<=d;c++){let u=c-this._rendLineNumberStart;this._lines[u].onTokensChanged(),i=!0}}return i}},yh=class{constructor(e){this._lineFactory=e}domNode=this._createDomNode();_linesCollection=new wg(this._lineFactory);_createDomNode(){let e=Oe(document.createElement("div"));return e.setClassName("view-layer"),e.setPosition("absolute"),e.domNode.setAttribute("role","presentation"),e.domNode.setAttribute("aria-hidden","true"),e}onConfigurationChanged(e){return!!e.hasChanged(147)}onFlushed(e){return this._linesCollection.flush(),!0}onLinesChanged(e){return this._linesCollection.onLinesChanged(e.fromLineNumber,e.count)}onLinesDeleted(e){let t=this._linesCollection.onLinesDeleted(e.fromLineNumber,e.toLineNumber);if(t)for(let n=0,i=t.length;n<i;n++)t[n].getDomNode()?.remove();return!0}onLinesInserted(e){let t=this._linesCollection.onLinesInserted(e.fromLineNumber,e.toLineNumber);if(t)for(let n=0,i=t.length;n<i;n++)t[n].getDomNode()?.remove();return!0}onScrollChanged(e){return e.scrollTopChanged}onTokensChanged(e){return this._linesCollection.onTokensChanged(e.ranges)}onZonesChanged(e){return!0}getStartLineNumber(){return this._linesCollection.getStartLineNumber()}getEndLineNumber(){return this._linesCollection.getEndLineNumber()}getVisibleLine(e){return this._linesCollection.getLine(e)}renderLines(e){let t=this._linesCollection._get(),n=new jL(this.domNode.domNode,this._lineFactory,e),i={rendLineNumberStart:t.rendLineNumberStart,lines:t.lines,linesLength:t.lines.length},r=n.render(i,e.startLineNumber,e.endLineNumber,e.relativeVerticalOffset);this._linesCollection._set(r.rendLineNumberStart,r.lines)}},jL=class o{constructor(e,t,n){this._domNode=e;this._lineFactory=t;this._viewportData=n}static _ttPolicy=MI("editorViewLayer",{createHTML:e=>e});render(e,t,n,i){let r={rendLineNumberStart:e.rendLineNumberStart,lines:e.lines.slice(0),linesLength:e.linesLength};if(r.rendLineNumberStart+r.linesLength-1<t||n<r.rendLineNumberStart){r.rendLineNumberStart=t,r.linesLength=n-t+1,r.lines=[];for(let s=t;s<=n;s++)r.lines[s-t]=this._lineFactory.createLine();return this._finishRendering(r,!0,i),r}if(this._renderUntouchedLines(r,Math.max(t-r.rendLineNumberStart,0),Math.min(n-r.rendLineNumberStart,r.linesLength-1),i,t),r.rendLineNumberStart>t){let s=t,a=Math.min(n,r.rendLineNumberStart-1);s<=a&&(this._insertLinesBefore(r,s,a,i,t),r.linesLength+=a-s+1)}else if(r.rendLineNumberStart<t){let s=Math.min(r.linesLength,t-r.rendLineNumberStart);s>0&&(this._removeLinesBefore(r,s),r.linesLength-=s)}if(r.rendLineNumberStart=t,r.rendLineNumberStart+r.linesLength-1<n){let s=r.rendLineNumberStart+r.linesLength,a=n;s<=a&&(this._insertLinesAfter(r,s,a,i,t),r.linesLength+=a-s+1)}else if(r.rendLineNumberStart+r.linesLength-1>n){let s=Math.max(0,n-r.rendLineNumberStart+1),l=r.linesLength-1-s+1;l>0&&(this._removeLinesAfter(r,l),r.linesLength-=l)}return this._finishRendering(r,!1,i),r}_renderUntouchedLines(e,t,n,i,r){let s=e.rendLineNumberStart,a=e.lines;for(let l=t;l<=n;l++){let d=s+l;a[l].layoutLine(d,i[d-r],this._viewportData.lineHeight)}}_insertLinesBefore(e,t,n,i,r){let s=[],a=0;for(let l=t;l<=n;l++)s[a++]=this._lineFactory.createLine();e.lines=s.concat(e.lines)}_removeLinesBefore(e,t){for(let n=0;n<t;n++)e.lines[n].getDomNode()?.remove();e.lines.splice(0,t)}_insertLinesAfter(e,t,n,i,r){let s=[],a=0;for(let l=t;l<=n;l++)s[a++]=this._lineFactory.createLine();e.lines=e.lines.concat(s)}_removeLinesAfter(e,t){let n=e.linesLength-t;for(let i=0;i<t;i++)e.lines[n+i].getDomNode()?.remove();e.lines.splice(n,t)}_finishRenderingNewLines(e,t,n,i){o._ttPolicy&&(n=o._ttPolicy.createHTML(n));let r=this._domNode.lastChild;t||!r?this._domNode.innerHTML=n:r.insertAdjacentHTML("afterend",n);let s=this._domNode.lastChild;for(let a=e.linesLength-1;a>=0;a--){let l=e.lines[a];i[a]&&(l.setDomNode(s),s=s.previousSibling)}}_finishRenderingInvalidLines(e,t,n){let i=document.createElement("div");o._ttPolicy&&(t=o._ttPolicy.createHTML(t)),i.innerHTML=t;for(let r=0;r<e.linesLength;r++){let s=e.lines[r];if(n[r]){let a=i.firstChild,l=s.getDomNode();l.parentNode.replaceChild(a,l),s.setDomNode(a)}}}static _sb=new Md(1e5);_finishRendering(e,t,n){let i=o._sb,r=e.linesLength,s=e.lines,a=e.rendLineNumberStart,l=[];{i.reset();let d=!1;for(let c=0;c<r;c++){let u=s[c];l[c]=!1,!(u.getDomNode()||!u.renderLine(c+a,n[c],this._viewportData.lineHeight,this._viewportData,i))&&(l[c]=!0,d=!0)}d&&this._finishRenderingNewLines(e,t,i.build(),l)}{i.reset();let d=!1,c=[];for(let u=0;u<r;u++){let h=s[u];c[u]=!1,!(l[u]||!h.renderLine(u+a,n[u],this._viewportData.lineHeight,this._viewportData,i))&&(c[u]=!0,d=!0)}d&&this._finishRenderingInvalidLines(e,i.build(),c)}}};var Ih=class{constructor(e,t){this._domNode=e;this.endNode=t}_didDomLayout=!1;_clientRectDeltaLeft=0;_clientRectScale=1;_clientRectRead=!1;get didDomLayout(){return this._didDomLayout}readClientRect(){if(!this._clientRectRead){this._clientRectRead=!0;let e=this._domNode.getBoundingClientRect();this.markDidDomLayout(),this._clientRectDeltaLeft=e.left,this._clientRectScale=e.width/this._domNode.offsetWidth}}get clientRectDeltaLeft(){return this._clientRectRead||this.readClientRect(),this._clientRectDeltaLeft}get clientRectScale(){return this._clientRectRead||this.readClientRect(),this._clientRectScale}markDidDomLayout(){this._didDomLayout=!0}};var oc=class{static _handyReadyRange;static _createRange(){return this._handyReadyRange||(this._handyReadyRange=document.createRange()),this._handyReadyRange}static _detachRange(e,t){e.selectNodeContents(t)}static _readClientRects(e,t,n,i,r){let s=this._createRange();try{return s.setStart(e,t),s.setEnd(n,i),s.getClientRects()}catch{return null}finally{this._detachRange(s,r)}}static _mergeAdjacentRanges(e){if(e.length===1)return e;e.sort(Gr.compare);let t=[],n=0,i=e[0];for(let r=1,s=e.length;r<s;r++){let a=e[r];i.left+i.width+.9>=a.left?i.width=Math.max(i.width,a.left+a.width-i.left):(t[n++]=i,i=a)}return t[n++]=i,t}static _createHorizontalRangesFromClientRects(e,t,n){if(!e||e.length===0)return null;let i=[];for(let r=0,s=e.length;r<s;r++){let a=e[r];i[r]=new Gr(Math.max(0,(a.left-t)/n),a.width/n)}return this._mergeAdjacentRanges(i)}static readHorizontalRanges(e,t,n,i,r,s){let l=e.children.length-1;if(0>l)return null;if(t=Math.min(l,Math.max(0,t)),i=Math.min(l,Math.max(0,i)),t===i&&n===r&&n===0&&!e.children[t].firstChild){let h=e.children[t].getClientRects();return s.markDidDomLayout(),this._createHorizontalRangesFromClientRects(h,s.clientRectDeltaLeft,s.clientRectScale)}t!==i&&i>0&&r===0&&(i--,r=1073741824);let d=e.children[t].firstChild,c=e.children[i].firstChild;if((!d||!c)&&(!d&&n===0&&t>0&&(d=e.children[t-1].firstChild,n=1073741824),!c&&r===0&&i>0&&(c=e.children[i-1].firstChild,r=1073741824)),!d||!c)return null;n=Math.min(d.textContent.length,Math.max(0,n)),r=Math.min(c.textContent.length,Math.max(0,r));let u=this._readClientRects(d,n,c,r,s.endNode);return s.markDidDomLayout(),this._createHorizontalRangesFromClientRects(u,s.clientRectDeltaLeft,s.clientRectScale)}};var nn=class{constructor(e,t,n,i){this.endIndex=e;this.type=t;this.metadata=n;this.containsRTL=i}_linePartBrand=void 0;isWhitespace(){return!!(this.metadata&1)}isPseudoAfter(){return!!(this.metadata&4)}};var Ea=class o{constructor(e,t,n,i){this.startColumn=e;this.endColumn=t;this.className=n;this.type=i}_lineDecorationBrand=void 0;static _equals(e,t){return e.startColumn===t.startColumn&&e.endColumn===t.endColumn&&e.className===t.className&&e.type===t.type}static equalsArr(e,t){let n=e.length,i=t.length;if(n!==i)return!1;for(let r=0;r<n;r++)if(!o._equals(e[r],t[r]))return!1;return!0}static extractWrapped(e,t,n){if(e.length===0)return e;let i=t+1,r=n+1,s=n-t,a=[],l=0;for(let d of e)d.endColumn<=i||d.startColumn>=r||(a[l++]=new o(Math.max(1,d.startColumn-i+1),Math.min(s+1,d.endColumn-i+1),d.className,d.type));return a}static filter(e,t,n,i){if(e.length===0)return[];let r=[],s=0;for(let a=0,l=e.length;a<l;a++){let d=e[a],c=d.range;if(c.endLineNumber<t||c.startLineNumber>t||c.isEmpty()&&(d.type===0||d.type===3))continue;let u=c.startLineNumber===t?c.startColumn:n,h=c.endLineNumber===t?c.endColumn:i;r[s++]=new o(u,h,d.inlineClassName,d.type)}return r}static _typeCompare(e,t){let n=[2,0,1,3];return n[e]-n[t]}static compare(e,t){if(e.startColumn!==t.startColumn)return e.startColumn-t.startColumn;if(e.endColumn!==t.endColumn)return e.endColumn-t.endColumn;let n=o._typeCompare(e.type,t.type);return n!==0?n:e.className!==t.className?e.className<t.className?-1:1:0}},AI=class{startOffset;endOffset;className;metadata;constructor(e,t,n,i){this.startOffset=e,this.endOffset=t,this.className=n,this.metadata=i}},$L=class o{count;stopOffsets;classNames;metadata;constructor(){this.stopOffsets=[],this.classNames=[],this.metadata=[],this.count=0}static _metadata(e){let t=0;for(let n=0,i=e.length;n<i;n++)t|=e[n];return t}consumeLowerThan(e,t,n){for(;this.count>0&&this.stopOffsets[0]<e;){let i=0;for(;i+1<this.count&&this.stopOffsets[i]===this.stopOffsets[i+1];)i++;n.push(new AI(t,this.stopOffsets[i],this.classNames.join(" "),o._metadata(this.metadata))),t=this.stopOffsets[i]+1,this.stopOffsets.splice(0,i+1),this.classNames.splice(0,i+1),this.metadata.splice(0,i+1),this.count-=i+1}return this.count>0&&t<e&&(n.push(new AI(t,e-1,this.classNames.join(" "),o._metadata(this.metadata))),t=e),t}insert(e,t,n){if(this.count===0||this.stopOffsets[this.count-1]<=e)this.stopOffsets.push(e),this.classNames.push(t),this.metadata.push(n);else for(let i=0;i<this.count;i++)if(this.stopOffsets[i]>=e){this.stopOffsets.splice(i,0,e),this.classNames.splice(i,0,t),this.metadata.splice(i,0,n);break}this.count++}},OI=class{static normalize(e,t){if(t.length===0)return[];let n=[],i=new $L,r=0;for(let s=0,a=t.length;s<a;s++){let l=t[s],d=l.startColumn,c=l.endColumn,u=l.className,h=l.type===1?2:l.type===2?4:0;if(d>1){let g=e.charCodeAt(d-2);Ht(g)&&d--}if(c>1){let g=e.charCodeAt(c-2);Ht(g)&&c--}let m=d-1,f=c-2;r=i.consumeLowerThan(m,r,n),i.count===0&&(r=m),i.insert(f,u,h)}return i.consumeLowerThan(1073741824,r,n),n}};var Ch=class{startOffset;endOffset;constructor(e,t){this.startOffset=e,this.endOffset=t}equals(e){return this.startOffset===e.startOffset&&this.endOffset===e.endOffset}},NI=class{useMonospaceOptimizations;canUseHalfwidthRightwardsArrow;lineContent;continuesWithWrappedLine;isBasicASCII;containsRTL;fauxIndentLength;lineTokens;lineDecorations;tabSize;startVisibleColumn;spaceWidth;renderSpaceWidth;renderSpaceCharCode;stopRenderingLineAfter;renderWhitespace;renderControlCharacters;fontLigatures;selectionsOnLine;constructor(e,t,n,i,r,s,a,l,d,c,u,h,m,f,g,b,y,C,x){this.useMonospaceOptimizations=e,this.canUseHalfwidthRightwardsArrow=t,this.lineContent=n,this.continuesWithWrappedLine=i,this.isBasicASCII=r,this.containsRTL=s,this.fauxIndentLength=a,this.lineTokens=l,this.lineDecorations=d.sort(Ea.compare),this.tabSize=c,this.startVisibleColumn=u,this.spaceWidth=h,this.stopRenderingLineAfter=g,this.renderWhitespace=b==="all"?4:b==="boundary"?1:b==="selection"?2:b==="trailing"?3:0,this.renderControlCharacters=y,this.fontLigatures=C,this.selectionsOnLine=x&&x.sort((O,W)=>O.startOffset<W.startOffset?-1:1);let L=Math.abs(f-h),k=Math.abs(m-h);L<k?(this.renderSpaceWidth=f,this.renderSpaceCharCode=11825):(this.renderSpaceWidth=m,this.renderSpaceCharCode=183)}sameSelection(e){if(this.selectionsOnLine===null)return e===null;if(e===null||e.length!==this.selectionsOnLine.length)return!1;for(let t=0;t<this.selectionsOnLine.length;t++)if(!this.selectionsOnLine[t].equals(e[t]))return!1;return!0}equals(e){return this.useMonospaceOptimizations===e.useMonospaceOptimizations&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.lineContent===e.lineContent&&this.continuesWithWrappedLine===e.continuesWithWrappedLine&&this.isBasicASCII===e.isBasicASCII&&this.containsRTL===e.containsRTL&&this.fauxIndentLength===e.fauxIndentLength&&this.tabSize===e.tabSize&&this.startVisibleColumn===e.startVisibleColumn&&this.spaceWidth===e.spaceWidth&&this.renderSpaceWidth===e.renderSpaceWidth&&this.renderSpaceCharCode===e.renderSpaceCharCode&&this.stopRenderingLineAfter===e.stopRenderingLineAfter&&this.renderWhitespace===e.renderWhitespace&&this.renderControlCharacters===e.renderControlCharacters&&this.fontLigatures===e.fontLigatures&&Ea.equalsArr(this.lineDecorations,e.lineDecorations)&&this.lineTokens.equals(e.lineTokens)&&this.sameSelection(e.selectionsOnLine)}};var xg=class{constructor(e,t){this.partIndex=e;this.charIndex=t}},Eg=class o{static getPartIndex(e){return(e&4294901760)>>>16}static getCharIndex(e){return(e&65535)>>>0}length;_data;_horizontalOffset;constructor(e,t){this.length=e,this._data=new Uint32Array(this.length),this._horizontalOffset=new Uint32Array(this.length)}setColumnInfo(e,t,n,i){let r=(t<<16|n<<0)>>>0;this._data[e-1]=r,this._horizontalOffset[e-1]=i}getHorizontalOffset(e){return this._horizontalOffset.length===0?0:this._horizontalOffset[e-1]}charOffsetToPartData(e){return this.length===0?0:e<0?this._data[0]:e>=this.length?this._data[this.length-1]:this._data[e]}getDomPosition(e){let t=this.charOffsetToPartData(e-1),n=o.getPartIndex(t),i=o.getCharIndex(t);return new xg(n,i)}getColumn(e,t){return this.partDataToCharOffset(e.partIndex,t,e.charIndex)+1}partDataToCharOffset(e,t,n){if(this.length===0)return 0;let i=(e<<16|n<<0)>>>0,r=0,s=this.length-1;for(;r+1<s;){let g=r+s>>>1,b=this._data[g];if(b===i)return g;b>i?s=g:r=g}if(r===s)return r;let a=this._data[r],l=this._data[s];if(a===i)return r;if(l===i)return s;let d=o.getPartIndex(a),c=o.getCharIndex(a),u=o.getPartIndex(l),h;d!==u?h=t:h=o.getCharIndex(l);let m=n-c,f=h-n;return m<=f?r:s}inflate(){let e=[];for(let t=0;t<this.length;t++){let n=this._data[t],i=o.getPartIndex(n),r=o.getCharIndex(n),s=this._horizontalOffset[t];e.push([i,r,s])}return e}};var _g=class{_renderLineOutputBrand=void 0;characterMapping;containsRTL;containsForeignElements;constructor(e,t,n){this.characterMapping=e,this.containsRTL=t,this.containsForeignElements=n}};function CP(o,e){if(o.lineContent.length===0){if(o.lineDecorations.length>0){e.appendString("<span>");let t=0,n=0,i=0;for(let s of o.lineDecorations)(s.type===1||s.type===2)&&(e.appendString('<span class="'),e.appendString(s.className),e.appendString('"></span>'),s.type===1&&(i|=1,t++),s.type===2&&(i|=2,n++));e.appendString("</span>");let r=new Eg(1,t+n);return r.setColumnInfo(1,t,0,0),new _g(r,!1,i)}return e.appendString("<span><span></span></span>"),new _g(new Eg(0,0),!1,0)}return y5(p5(o),e)}var YL=class{constructor(e,t,n,i,r,s,a,l,d,c,u,h,m,f,g,b){this.fontIsMonospace=e;this.canUseHalfwidthRightwardsArrow=t;this.lineContent=n;this.len=i;this.isOverflowing=r;this.overflowingCharCount=s;this.parts=a;this.containsForeignElements=l;this.fauxIndentLength=d;this.tabSize=c;this.startVisibleColumn=u;this.containsRTL=h;this.spaceWidth=m;this.renderSpaceCharCode=f;this.renderWhitespace=g;this.renderControlCharacters=b}};function p5(o){let e=o.lineContent,t,n,i;o.stopRenderingLineAfter!==-1&&o.stopRenderingLineAfter<e.length?(t=!0,n=e.length-o.stopRenderingLineAfter,i=o.stopRenderingLineAfter):(t=!1,n=0,i=e.length);let r=m5(e,o.containsRTL,o.lineTokens,o.fauxIndentLength,i);o.renderControlCharacters&&!o.isBasicASCII&&(r=f5(e,r)),(o.renderWhitespace===4||o.renderWhitespace===1||o.renderWhitespace===2&&o.selectionsOnLine||o.renderWhitespace===3&&!o.continuesWithWrappedLine)&&(r=b5(o,e,i,r));let s=0;if(o.lineDecorations.length>0){for(let a=0,l=o.lineDecorations.length;a<l;a++){let d=o.lineDecorations[a];d.type===3||d.type===1?s|=1:d.type===2&&(s|=2)}r=v5(e,i,r,o.lineDecorations)}return o.containsRTL||(r=g5(e,r,!o.isBasicASCII||o.fontLigatures)),new YL(o.useMonospaceOptimizations,o.canUseHalfwidthRightwardsArrow,e,i,t,n,r,s,o.fauxIndentLength,o.tabSize,o.startVisibleColumn,o.containsRTL,o.spaceWidth,o.renderSpaceCharCode,o.renderWhitespace,o.renderControlCharacters)}function m5(o,e,t,n,i){let r=[],s=0;n>0&&(r[s++]=new nn(n,"",0,!1));let a=n;for(let l=0,d=t.getCount();l<d;l++){let c=t.getEndOffset(l);if(c<=n)continue;let u=t.getClassName(l);if(c>=i){let m=e?ea(o.substring(a,i)):!1;r[s++]=new nn(i,u,0,m);break}let h=e?ea(o.substring(a,c)):!1;r[s++]=new nn(c,u,0,h),a=c}return r}function g5(o,e,t){let n=0,i=[],r=0;if(t)for(let s=0,a=e.length;s<a;s++){let l=e[s],d=l.endIndex;if(n+50<d){let c=l.type,u=l.metadata,h=l.containsRTL,m=-1,f=n;for(let g=n;g<d;g++)o.charCodeAt(g)===32&&(m=g),m!==-1&&g-f>=50&&(i[r++]=new nn(m+1,c,u,h),f=m+1,m=-1);f!==d&&(i[r++]=new nn(d,c,u,h))}else i[r++]=l;n=d}else for(let s=0,a=e.length;s<a;s++){let l=e[s],d=l.endIndex,c=d-n;if(c>50){let u=l.type,h=l.metadata,m=l.containsRTL,f=Math.ceil(c/50);for(let g=1;g<f;g++){let b=n+g*50;i[r++]=new nn(b,u,h,m)}i[r++]=new nn(d,u,h,m)}else i[r++]=l;n=d}return i}function SP(o){return o<32?o!==9:o===127||o>=8234&&o<=8238||o>=8294&&o<=8297||o>=8206&&o<=8207||o===1564}function f5(o,e){let t=[],n=new nn(0,"",0,!1),i=0;for(let r of e){let s=r.endIndex;for(;i<s;i++){let a=o.charCodeAt(i);SP(a)&&(i>n.endIndex&&(n=new nn(i,r.type,r.metadata,r.containsRTL),t.push(n)),n=new nn(i+1,"mtkcontrol",r.metadata,!1),t.push(n))}i>n.endIndex&&(n=new nn(s,r.type,r.metadata,r.containsRTL),t.push(n))}return t}function b5(o,e,t,n){let i=o.continuesWithWrappedLine,r=o.fauxIndentLength,s=o.tabSize,a=o.startVisibleColumn,l=o.useMonospaceOptimizations,d=o.selectionsOnLine,c=o.renderWhitespace===1,u=o.renderWhitespace===3,h=o.renderSpaceWidth!==o.spaceWidth,m=[],f=0,g=0,b=n[g].type,y=n[g].containsRTL,C=n[g].endIndex,x=n.length,L=!1,k=Xt(e),O;k===-1?(L=!0,k=t,O=t):O=Wo(e);let W=!1,z=0,B=d&&d[z],G=a%s;for(let X=r;X<t;X++){let ce=e.charCodeAt(X);B&&X>=B.endOffset&&(z++,B=d&&d[z]);let Ce;if(X<k||X>O)Ce=!0;else if(ce===9)Ce=!0;else if(ce===32)if(c)if(W)Ce=!0;else{let te=X+1<t?e.charCodeAt(X+1):0;Ce=te===32||te===9}else Ce=!0;else Ce=!1;if(Ce&&d&&(Ce=!!B&&B.startOffset<=X&&B.endOffset>X),Ce&&u&&(Ce=L||X>O),Ce&&y&&X>=k&&X<=O&&(Ce=!1),W){if(!Ce||!l&&G>=s){if(h){let te=f>0?m[f-1].endIndex:r;for(let Z=te+1;Z<=X;Z++)m[f++]=new nn(Z,"mtkw",1,!1)}else m[f++]=new nn(X,"mtkw",1,!1);G=G%s}}else(X===C||Ce&&X>r)&&(m[f++]=new nn(X,b,0,y),G=G%s);for(ce===9?G=s:Ho(ce)?G+=2:G++,W=Ce;X===C&&(g++,g<x);)b=n[g].type,y=n[g].containsRTL,C=n[g].endIndex}let q=!1;if(W)if(i&&c){let X=t>0?e.charCodeAt(t-1):0,ce=t>1?e.charCodeAt(t-2):0;X===32&&ce!==32&&ce!==9||(q=!0)}else q=!0;if(q)if(h){let X=f>0?m[f-1].endIndex:r;for(let ce=X+1;ce<=t;ce++)m[f++]=new nn(ce,"mtkw",1,!1)}else m[f++]=new nn(t,"mtkw",1,!1);else m[f++]=new nn(t,b,0,y);return m}function v5(o,e,t,n){n.sort(Ea.compare);let i=OI.normalize(o,n),r=i.length,s=0,a=[],l=0,d=0;for(let u=0,h=t.length;u<h;u++){let m=t[u],f=m.endIndex,g=m.type,b=m.metadata,y=m.containsRTL;for(;s<r&&i[s].startOffset<f;){let C=i[s];if(C.startOffset>d&&(d=C.startOffset,a[l++]=new nn(d,g,b,y)),C.endOffset+1<=f)d=C.endOffset+1,a[l++]=new nn(d,g+" "+C.className,b|C.metadata,y),s++;else{d=f,a[l++]=new nn(d,g+" "+C.className,b|C.metadata,y);break}}f>d&&(d=f,a[l++]=new nn(d,g,b,y))}let c=t[t.length-1].endIndex;if(s<r&&i[s].startOffset===c)for(;s<r&&i[s].startOffset===c;){let u=i[s];a[l++]=new nn(d,u.className,u.metadata,!1),s++}return a}function y5(o,e){let t=o.fontIsMonospace,n=o.canUseHalfwidthRightwardsArrow,i=o.containsForeignElements,r=o.lineContent,s=o.len,a=o.isOverflowing,l=o.overflowingCharCount,d=o.parts,c=o.fauxIndentLength,u=o.tabSize,h=o.startVisibleColumn,m=o.containsRTL,f=o.spaceWidth,g=o.renderSpaceCharCode,b=o.renderWhitespace,y=o.renderControlCharacters,C=new Eg(s+1,d.length),x=!1,L=0,k=h,O=0,W=0,z=0;m?e.appendString('<span dir="ltr">'):e.appendString("<span>");for(let B=0,G=d.length;B<G;B++){let q=d[B],X=q.endIndex,ce=q.type,Ce=q.containsRTL,te=b!==0&&q.isWhitespace(),Z=te&&!t&&(ce==="mtkw"||!i),le=L===X&&q.isPseudoAfter();if(O=0,e.appendString("<span "),Ce&&e.appendString('style="unicode-bidi:isolate" '),e.appendString('class="'),e.appendString(Z?"mtkz":ce),e.appendASCIICharCode(34),te){let ne=0;{let Q=L,we=k;for(;Q<X;Q++){let st=(r.charCodeAt(Q)===9?u-we%u:1)|0;ne+=st,Q>=c&&(we+=st)}}for(Z&&(e.appendString(' style="width:'),e.appendString(String(f*ne)),e.appendString('px"')),e.appendASCIICharCode(62);L<X;L++){C.setColumnInfo(L+1,B-z,O,W),z=0;let Q=r.charCodeAt(L),we,xe;if(Q===9){we=u-k%u|0,xe=we,!n||xe>1?e.appendCharCode(8594):e.appendCharCode(65515);for(let st=2;st<=xe;st++)e.appendCharCode(160)}else we=2,xe=1,e.appendCharCode(g),e.appendCharCode(8204);O+=we,W+=xe,L>=c&&(k+=xe)}}else for(e.appendASCIICharCode(62);L<X;L++){C.setColumnInfo(L+1,B-z,O,W),z=0;let ne=r.charCodeAt(L),Q=1,we=1;switch(ne){case 9:Q=u-k%u,we=Q;for(let xe=1;xe<=Q;xe++)e.appendCharCode(160);break;case 32:e.appendCharCode(160);break;case 60:e.appendString("&lt;");break;case 62:e.appendString("&gt;");break;case 38:e.appendString("&amp;");break;case 0:y?e.appendCharCode(9216):e.appendString("&#00;");break;case 65279:case 8232:case 8233:case 133:e.appendCharCode(65533);break;default:Ho(ne)&&we++,y&&ne<32?e.appendCharCode(9216+ne):y&&ne===127?e.appendCharCode(9249):y&&SP(ne)?(e.appendString("[U+"),e.appendString(I5(ne)),e.appendString("]"),Q=8,we=Q):e.appendCharCode(ne)}O+=Q,W+=we,L>=c&&(k+=we)}le?z++:z=0,L>=s&&!x&&q.isPseudoAfter()&&(x=!0,C.setColumnInfo(L+1,B,O,W)),e.appendString("</span>")}return x||C.setColumnInfo(s+1,d.length-1,O,W),a&&(e.appendString('<span class="mtkoverflow">'),e.appendString(p("showMore","Show more ({0})",C5(l))),e.appendString("</span>")),e.appendString("</span>"),new _g(C,m,i)}function I5(o){return o.toString(16).toUpperCase().padStart(4,"0")}function C5(o){return o<1024?p("overflow.chars","{0} chars",o):o<1024*1024?`${(o/1024).toFixed(1)} KB`:`${(o/1024/1024).toFixed(1)} MB`}var S5=function(){return rs?!0:!(Wt||sn||Xi)}(),wh=!0,Tg=class{themeType;renderWhitespace;renderControlCharacters;spaceWidth;middotWidth;wsmiddotWidth;useMonospaceOptimizations;canUseHalfwidthRightwardsArrow;lineHeight;stopRenderingLineAfter;fontLigatures;constructor(e,t){this.themeType=t;let n=e.options,i=n.get(51);n.get(39)==="off"?this.renderWhitespace=n.get(101):this.renderWhitespace="none",this.renderControlCharacters=n.get(96),this.spaceWidth=i.spaceWidth,this.middotWidth=i.middotWidth,this.wsmiddotWidth=i.wsmiddotWidth,this.useMonospaceOptimizations=i.isMonospace&&!n.get(33),this.canUseHalfwidthRightwardsArrow=i.canUseHalfwidthRightwardsArrow,this.lineHeight=n.get(68),this.stopRenderingLineAfter=n.get(119),this.fontLigatures=n.get(52)}equals(e){return this.themeType===e.themeType&&this.renderWhitespace===e.renderWhitespace&&this.renderControlCharacters===e.renderControlCharacters&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.useMonospaceOptimizations===e.useMonospaceOptimizations&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.lineHeight===e.lineHeight&&this.stopRenderingLineAfter===e.stopRenderingLineAfter&&this.fontLigatures===e.fontLigatures}},jr=class o{static CLASS_NAME="view-line";_options;_isMaybeInvalid;_renderedViewLine;constructor(e){this._options=e,this._isMaybeInvalid=!0,this._renderedViewLine=null}getDomNode(){return this._renderedViewLine&&this._renderedViewLine.domNode?this._renderedViewLine.domNode.domNode:null}setDomNode(e){if(this._renderedViewLine)this._renderedViewLine.domNode=Oe(e);else throw new Error("I have no rendered view line to set the dom node to...")}onContentChanged(){this._isMaybeInvalid=!0}onTokensChanged(){this._isMaybeInvalid=!0}onDecorationsChanged(){this._isMaybeInvalid=!0}onOptionsChanged(e){this._isMaybeInvalid=!0,this._options=e}onSelectionChanged(){return El(this._options.themeType)||this._options.renderWhitespace==="selection"?(this._isMaybeInvalid=!0,!0):!1}renderLine(e,t,n,i,r){if(this._isMaybeInvalid===!1)return!1;this._isMaybeInvalid=!1;let s=i.getViewLineRenderingData(e),a=this._options,l=Ea.filter(s.inlineDecorations,e,s.minColumn,s.maxColumn),d=null;if(El(a.themeType)||this._options.renderWhitespace==="selection"){let m=i.selections;for(let f of m){if(f.endLineNumber<e||f.startLineNumber>e)continue;let g=f.startLineNumber===e?f.startColumn:s.minColumn,b=f.endLineNumber===e?f.endColumn:s.maxColumn;g<b&&(El(a.themeType)&&l.push(new Ea(g,b,"inline-selected-text",0)),this._options.renderWhitespace==="selection"&&(d||(d=[]),d.push(new Ch(g-1,b-1))))}}let c=new NI(a.useMonospaceOptimizations,a.canUseHalfwidthRightwardsArrow,s.content,s.continuesWithWrappedLine,s.isBasicASCII,s.containsRTL,s.minColumn-1,s.tokens,l,s.tabSize,s.startVisibleColumn,a.spaceWidth,a.middotWidth,a.wsmiddotWidth,a.stopRenderingLineAfter,a.renderWhitespace,a.renderControlCharacters,a.fontLigatures!==Td.OFF,d);if(this._renderedViewLine&&this._renderedViewLine.input.equals(c))return!1;r.appendString('<div style="top:'),r.appendString(String(t)),r.appendString("px;height:"),r.appendString(String(n)),r.appendString('px;" class="'),r.appendString(o.CLASS_NAME),r.appendString('">');let u=CP(c,r);r.appendString("</div>");let h=null;return wh&&S5&&s.isBasicASCII&&a.useMonospaceOptimizations&&u.containsForeignElements===0&&(h=new Sh(this._renderedViewLine?this._renderedViewLine.domNode:null,c,u.characterMapping)),h||(h=wP(this._renderedViewLine?this._renderedViewLine.domNode:null,c,u.characterMapping,u.containsRTL,u.containsForeignElements)),this._renderedViewLine=h,!0}layoutLine(e,t,n){this._renderedViewLine&&this._renderedViewLine.domNode&&(this._renderedViewLine.domNode.setTop(t),this._renderedViewLine.domNode.setHeight(n))}getWidth(e){return this._renderedViewLine?this._renderedViewLine.getWidth(e):0}getWidthIsFast(){return this._renderedViewLine?this._renderedViewLine.getWidthIsFast():!0}needsMonospaceFontCheck(){return this._renderedViewLine?this._renderedViewLine instanceof Sh:!1}monospaceAssumptionsAreValid(){return this._renderedViewLine&&this._renderedViewLine instanceof Sh?this._renderedViewLine.monospaceAssumptionsAreValid():wh}onMonospaceAssumptionsInvalidated(){this._renderedViewLine&&this._renderedViewLine instanceof Sh&&(this._renderedViewLine=this._renderedViewLine.toSlowRenderedLine())}getVisibleRangesForRange(e,t,n,i){if(!this._renderedViewLine)return null;t=Math.min(this._renderedViewLine.input.lineContent.length+1,Math.max(1,t)),n=Math.min(this._renderedViewLine.input.lineContent.length+1,Math.max(1,n));let r=this._renderedViewLine.input.stopRenderingLineAfter;if(r!==-1&&t>r+1&&n>r+1)return new Sg(!0,[new Gr(this.getWidth(i),0)]);r!==-1&&t>r+1&&(t=r+1),r!==-1&&n>r+1&&(n=r+1);let s=this._renderedViewLine.getVisibleRangesForRange(e,t,n,i);return s&&s.length>0?new Sg(!1,s):null}getColumnOfNodeOffset(e,t){return this._renderedViewLine?this._renderedViewLine.getColumnOfNodeOffset(e,t):1}};var Sh=class{domNode;input;_characterMapping;_charWidth;_keyColumnPixelOffsetCache;_cachedWidth=-1;constructor(e,t,n){this.domNode=e,this.input=t;let i=Math.floor(t.lineContent.length/300);if(i>0){this._keyColumnPixelOffsetCache=new Float32Array(i);for(let r=0;r<i;r++)this._keyColumnPixelOffsetCache[r]=-1}else this._keyColumnPixelOffsetCache=null;this._characterMapping=n,this._charWidth=t.spaceWidth}getWidth(e){if(!this.domNode||this.input.lineContent.length<300){let t=this._characterMapping.getHorizontalOffset(this._characterMapping.length);return Math.round(this._charWidth*t)}return this._cachedWidth===-1&&(this._cachedWidth=this._getReadingTarget(this.domNode).offsetWidth,e?.markDidDomLayout()),this._cachedWidth}getWidthIsFast(){return this.input.lineContent.length<300||this._cachedWidth!==-1}monospaceAssumptionsAreValid(){if(!this.domNode)return wh;if(this.input.lineContent.length<300){let e=this.getWidth(null),t=this.domNode.domNode.firstChild.offsetWidth;Math.abs(e-t)>=2&&(console.warn("monospace assumptions have been violated, therefore disabling monospace optimizations!"),wh=!1)}return wh}toSlowRenderedLine(){return wP(this.domNode,this.input,this._characterMapping,!1,0)}getVisibleRangesForRange(e,t,n,i){let r=this._getColumnPixelOffset(e,t,i),s=this._getColumnPixelOffset(e,n,i);return[new Gr(r,s-r)]}_getColumnPixelOffset(e,t,n){if(t<=300){let d=this._characterMapping.getHorizontalOffset(t);return this._charWidth*d}let i=Math.floor((t-1)/300)-1,r=(i+1)*300+1,s=-1;if(this._keyColumnPixelOffsetCache&&(s=this._keyColumnPixelOffsetCache[i],s===-1&&(s=this._actualReadPixelOffset(e,r,n),this._keyColumnPixelOffsetCache[i]=s)),s===-1){let d=this._characterMapping.getHorizontalOffset(t);return this._charWidth*d}let a=this._characterMapping.getHorizontalOffset(r),l=this._characterMapping.getHorizontalOffset(t);return s+this._charWidth*(l-a)}_getReadingTarget(e){return e.domNode.firstChild}_actualReadPixelOffset(e,t,n){if(!this.domNode)return-1;let i=this._characterMapping.getDomPosition(t),r=oc.readHorizontalRanges(this._getReadingTarget(this.domNode),i.partIndex,i.charIndex,i.partIndex,i.charIndex,n);return!r||r.length===0?-1:r[0].left}getColumnOfNodeOffset(e,t){return xP(this._characterMapping,e,t)}},PI=class{domNode;input;_characterMapping;_isWhitespaceOnly;_containsForeignElements;_cachedWidth;_pixelOffsetCache;constructor(e,t,n,i,r){if(this.domNode=e,this.input=t,this._characterMapping=n,this._isWhitespaceOnly=/^\s*$/.test(t.lineContent),this._containsForeignElements=r,this._cachedWidth=-1,this._pixelOffsetCache=null,!i||this._characterMapping.length===0){this._pixelOffsetCache=new Float32Array(Math.max(2,this._characterMapping.length+1));for(let s=0,a=this._characterMapping.length;s<=a;s++)this._pixelOffsetCache[s]=-1}}_getReadingTarget(e){return e.domNode.firstChild}getWidth(e){return this.domNode?(this._cachedWidth===-1&&(this._cachedWidth=this._getReadingTarget(this.domNode).offsetWidth,e?.markDidDomLayout()),this._cachedWidth):0}getWidthIsFast(){return this._cachedWidth!==-1}getVisibleRangesForRange(e,t,n,i){if(!this.domNode)return null;if(this._pixelOffsetCache!==null){let r=this._readPixelOffset(this.domNode,e,t,i);if(r===-1)return null;let s=this._readPixelOffset(this.domNode,e,n,i);return s===-1?null:[new Gr(r,s-r)]}return this._readVisibleRangesForRange(this.domNode,e,t,n,i)}_readVisibleRangesForRange(e,t,n,i,r){if(n===i){let s=this._readPixelOffset(e,t,n,r);return s===-1?null:[new Gr(s,0)]}else return this._readRawVisibleRangesForRange(e,n,i,r)}_readPixelOffset(e,t,n,i){if(this._characterMapping.length===0){if(this._containsForeignElements===0||this._containsForeignElements===2)return 0;if(this._containsForeignElements===1)return this.getWidth(i);let r=this._getReadingTarget(e);return r.firstChild?(i.markDidDomLayout(),r.firstChild.offsetWidth):0}if(this._pixelOffsetCache!==null){let r=this._pixelOffsetCache[n];if(r!==-1)return r;let s=this._actualReadPixelOffset(e,t,n,i);return this._pixelOffsetCache[n]=s,s}return this._actualReadPixelOffset(e,t,n,i)}_actualReadPixelOffset(e,t,n,i){if(this._characterMapping.length===0){let l=oc.readHorizontalRanges(this._getReadingTarget(e),0,0,0,0,i);return!l||l.length===0?-1:l[0].left}if(n===this._characterMapping.length&&this._isWhitespaceOnly&&this._containsForeignElements===0)return this.getWidth(i);let r=this._characterMapping.getDomPosition(n),s=oc.readHorizontalRanges(this._getReadingTarget(e),r.partIndex,r.charIndex,r.partIndex,r.charIndex,i);if(!s||s.length===0)return-1;let a=s[0].left;if(this.input.isBasicASCII){let l=this._characterMapping.getHorizontalOffset(n),d=Math.round(this.input.spaceWidth*l);if(Math.abs(d-a)<=1)return d}return a}_readRawVisibleRangesForRange(e,t,n,i){if(t===1&&n===this._characterMapping.length)return[new Gr(0,this.getWidth(i))];let r=this._characterMapping.getDomPosition(t),s=this._characterMapping.getDomPosition(n);return oc.readHorizontalRanges(this._getReadingTarget(e),r.partIndex,r.charIndex,s.partIndex,s.charIndex,i)}getColumnOfNodeOffset(e,t){return xP(this._characterMapping,e,t)}},ZL=class extends PI{_readVisibleRangesForRange(e,t,n,i,r){let s=super._readVisibleRangesForRange(e,t,n,i,r);if(!s||s.length===0||n===i||n===1&&i===this._characterMapping.length)return s;if(!this.input.containsRTL){let a=this._readPixelOffset(e,t,i,r);if(a!==-1){let l=s[s.length-1];l.left<a&&(l.width=a-l.left)}}return s}},wP=function(){return Sr?w5:x5}();function w5(o,e,t,n,i){return new ZL(o,e,t,n,i)}function x5(o,e,t,n,i){return new PI(o,e,t,n,i)}function xP(o,e,t){let n=e.textContent.length,i=-1;for(;e;)e=e.previousSibling,i++;return o.getColumn(new xg(i,t),n)}var _a="monaco-mouse-cursor-text";var FI=class{constructor(e,t,n,i,r,s,a){this.top=e;this.left=t;this.paddingLeft=n;this.width=i;this.height=r;this.textContent=s;this.textContentClassName=a}};var Lg=class{_context;_domNode;_cursorStyle;_lineCursorWidth;_lineHeight;_typicalHalfwidthCharacterWidth;_isVisible;_position;_pluralityClass;_lastRenderedContent;_renderData;constructor(e,t){this._context=e;let n=this._context.configuration.options,i=n.get(51);this._cursorStyle=n.get(28),this._lineHeight=n.get(68),this._typicalHalfwidthCharacterWidth=i.typicalHalfwidthCharacterWidth,this._lineCursorWidth=Math.min(n.get(31),this._typicalHalfwidthCharacterWidth),this._isVisible=!0,this._domNode=Oe(document.createElement("div")),this._domNode.setClassName(`cursor ${_a}`),this._domNode.setHeight(this._lineHeight),this._domNode.setTop(0),this._domNode.setLeft(0),ln(this._domNode,i),this._domNode.setDisplay("none"),this._position=new P(1,1),this._pluralityClass="",this.setPlurality(t),this._lastRenderedContent="",this._renderData=null}getDomNode(){return this._domNode}getPosition(){return this._position}setPlurality(e){switch(e){default:case 0:this._pluralityClass="";break;case 1:this._pluralityClass="cursor-primary";break;case 2:this._pluralityClass="cursor-secondary";break}}show(){this._isVisible||(this._domNode.setVisibility("inherit"),this._isVisible=!0)}hide(){this._isVisible&&(this._domNode.setVisibility("hidden"),this._isVisible=!1)}onConfigurationChanged(e){let t=this._context.configuration.options,n=t.get(51);return this._cursorStyle=t.get(28),this._lineHeight=t.get(68),this._typicalHalfwidthCharacterWidth=n.typicalHalfwidthCharacterWidth,this._lineCursorWidth=Math.min(t.get(31),this._typicalHalfwidthCharacterWidth),ln(this._domNode,n),!0}onCursorPositionChanged(e,t){return t?this._domNode.domNode.style.transitionProperty="none":this._domNode.domNode.style.transitionProperty="",this._position=e,!0}_getGraphemeAwarePosition(){let{lineNumber:e,column:t}=this._position,n=this._context.viewModel.getLineContent(e),[i,r]=ob(n,t-1);return[new P(e,i+1),n.substring(i,r)]}_prepareRender(e){let t="",n="",[i,r]=this._getGraphemeAwarePosition();if(this._cursorStyle===1||this._cursorStyle===4){let h=e.visibleRangeForPosition(i);if(!h||h.outsideRenderedLine)return null;let m=Ie(this._domNode.domNode),f;this._cursorStyle===1?(f=Jx(m,this._lineCursorWidth>0?this._lineCursorWidth:2),f>2&&(t=r,n=this._getTokenClassName(i))):f=Jx(m,1);let g=h.left,b=0;f>=2&&g>=1&&(b=1,g-=b);let y=e.getVerticalOffsetForLineNumber(i.lineNumber)-e.bigNumbersDelta;return new FI(y,g,b,f,this._lineHeight,t,n)}let s=e.linesVisibleRangesForRange(new D(i.lineNumber,i.column,i.lineNumber,i.column+r.length),!1);if(!s||s.length===0)return null;let a=s[0];if(a.outsideRenderedLine||a.ranges.length===0)return null;let l=a.ranges[0],d=r==="	"?this._typicalHalfwidthCharacterWidth:l.width<1?this._typicalHalfwidthCharacterWidth:l.width;this._cursorStyle===2&&(t=r,n=this._getTokenClassName(i));let c=e.getVerticalOffsetForLineNumber(i.lineNumber)-e.bigNumbersDelta,u=this._lineHeight;return(this._cursorStyle===3||this._cursorStyle===6)&&(c+=this._lineHeight-2,u=2),new FI(c,l.left,0,d,u,t,n)}_getTokenClassName(e){let t=this._context.viewModel.getViewLineData(e.lineNumber),n=t.tokens.findTokenIndexAtOffset(e.column-1);return t.tokens.getClassName(n)}prepareRender(e){this._renderData=this._prepareRender(e)}render(e){return this._renderData?(this._lastRenderedContent!==this._renderData.textContent&&(this._lastRenderedContent=this._renderData.textContent,this._domNode.domNode.textContent=this._lastRenderedContent),this._domNode.setClassName(`cursor ${this._pluralityClass} ${_a} ${this._renderData.textContentClassName}`),this._domNode.setDisplay("block"),this._domNode.setTop(this._renderData.top),this._domNode.setLeft(this._renderData.left),this._domNode.setPaddingLeft(this._renderData.paddingLeft),this._domNode.setWidth(this._renderData.width),this._domNode.setLineHeight(this._renderData.height),this._domNode.setHeight(this._renderData.height),{domNode:this._domNode.domNode,position:this._position,contentLeft:this._renderData.left,height:this._renderData.height,width:2}):(this._domNode.setDisplay("none"),null)}};var rc=class o{static whitespaceVisibleColumn(e,t,n){let i=e.length,r=0,s=-1,a=-1;for(let l=0;l<i;l++){if(l===t)return[s,a,r];switch(r%n===0&&(s=l,a=r),e.charCodeAt(l)){case 32:r+=1;break;case 9:r=_t.nextRenderTabStop(r,n);break;default:return[-1,-1,-1]}}return t===i?[s,a,r]:[-1,-1,-1]}static atomicPosition(e,t,n,i){let r=e.length,[s,a,l]=o.whitespaceVisibleColumn(e,t,n);if(l===-1)return-1;let d;switch(i){case 0:d=!0;break;case 1:d=!1;break;case 2:if(l%n===0)return t;d=l%n<=n/2;break}if(d){if(s===-1)return-1;let h=a;for(let m=s;m<r;++m){if(h===a+n)return s;switch(e.charCodeAt(m)){case 32:h+=1;break;case 9:h=_t.nextRenderTabStop(h,n);break;default:return-1}}return h===a+n?s:-1}let c=_t.nextRenderTabStop(l,n),u=l;for(let h=t;h<r;h++){if(u===c)return h;switch(e.charCodeAt(h)){case 32:u+=1;break;case 9:u=_t.nextRenderTabStop(u,n);break;default:return-1}}return u===c?r:-1}};var Vs=class{constructor(e=null){this.hitTarget=e}type=0},BI=class{constructor(e,t,n){this.position=e;this.spanNode=t;this.injectedText=n}type=1;get hitTarget(){return this.spanNode}},xh;(e=>{function o(t,n,i){let r=t.getPositionFromDOMInfo(n,i);return r?new BI(r,n,null):new Vs(n)}e.createFromDOMInfo=o})(xh||={});var VI=class{constructor(e,t){this.lastViewCursorsRenderData=e;this.lastTextareaPosition=t}},Mn=class{static _deduceRage(e,t=null){return!t&&e?new D(e.lineNumber,e.column,e.lineNumber,e.column):t??null}static createUnknown(e,t,n){return{type:0,element:e,mouseColumn:t,position:n,range:this._deduceRage(n)}}static createTextarea(e,t){return{type:1,element:e,mouseColumn:t,position:null,range:null}}static createMargin(e,t,n,i,r,s){return{type:e,element:t,mouseColumn:n,position:i,range:r,detail:s}}static createViewZone(e,t,n,i,r){return{type:e,element:t,mouseColumn:n,position:i,range:this._deduceRage(i),detail:r}}static createContentText(e,t,n,i,r){return{type:6,element:e,mouseColumn:t,position:n,range:this._deduceRage(n,i),detail:r}}static createContentEmpty(e,t,n,i){return{type:7,element:e,mouseColumn:t,position:n,range:this._deduceRage(n),detail:i}}static createContentWidget(e,t,n){return{type:9,element:e,mouseColumn:t,position:null,range:null,detail:n}}static createScrollbar(e,t,n){return{type:11,element:e,mouseColumn:t,position:n,range:this._deduceRage(n)}}static createOverlayWidget(e,t,n){return{type:12,element:e,mouseColumn:t,position:null,range:null,detail:n}}static createOutsideEditor(e,t,n,i){return{type:13,element:null,mouseColumn:e,position:t,range:this._deduceRage(t),outsidePosition:n,outsideDistance:i}}static _typeToString(e){return e===1?"TEXTAREA":e===2?"GUTTER_GLYPH_MARGIN":e===3?"GUTTER_LINE_NUMBERS":e===4?"GUTTER_LINE_DECORATIONS":e===5?"GUTTER_VIEW_ZONE":e===6?"CONTENT_TEXT":e===7?"CONTENT_EMPTY":e===8?"CONTENT_VIEW_ZONE":e===9?"CONTENT_WIDGET":e===10?"OVERVIEW_RULER":e===11?"SCROLLBAR":e===12?"OVERLAY_WIDGET":"UNKNOWN"}static toString(e){return this._typeToString(e.type)+": "+e.position+" - "+e.range+" - "+JSON.stringify(e.detail)}},ni=class{static isTextArea(e){return e.length===2&&e[0]===3&&e[1]===7}static isChildOfViewLines(e){return e.length>=4&&e[0]===3&&e[3]===8}static isStrictChildOfViewLines(e){return e.length>4&&e[0]===3&&e[3]===8}static isChildOfScrollableElement(e){return e.length>=2&&e[0]===3&&e[1]===6}static isChildOfMinimap(e){return e.length>=2&&e[0]===3&&e[1]===9}static isChildOfContentWidgets(e){return e.length>=4&&e[0]===3&&e[3]===1}static isChildOfOverflowGuard(e){return e.length>=1&&e[0]===3}static isChildOfOverflowingContentWidgets(e){return e.length>=1&&e[0]===2}static isChildOfOverlayWidgets(e){return e.length>=2&&e[0]===3&&e[1]===4}static isChildOfOverflowingOverlayWidgets(e){return e.length>=1&&e[0]===5}},Eh=class o{viewModel;layoutInfo;viewDomNode;lineHeight;stickyTabStops;typicalHalfwidthCharacterWidth;lastRenderData;_context;_viewHelper;constructor(e,t,n){this.viewModel=e.viewModel;let i=e.configuration.options;this.layoutInfo=i.get(147),this.viewDomNode=t.viewDomNode,this.lineHeight=i.get(68),this.stickyTabStops=i.get(118),this.typicalHalfwidthCharacterWidth=i.get(51).typicalHalfwidthCharacterWidth,this.lastRenderData=n,this._context=e,this._viewHelper=t}getZoneAtCoord(e){return o.getZoneAtCoord(this._context,e)}static getZoneAtCoord(e,t){let n=e.viewLayout.getWhitespaceAtVerticalOffset(t);if(n){let i=n.verticalOffset+n.height/2,r=e.viewModel.getLineCount(),s=null,a,l=null;return n.afterLineNumber!==r&&(l=new P(n.afterLineNumber+1,1)),n.afterLineNumber>0&&(s=new P(n.afterLineNumber,e.viewModel.getLineMaxColumn(n.afterLineNumber))),l===null?a=s:s===null?a=l:t<i?a=s:a=l,{viewZoneId:n.id,afterLineNumber:n.afterLineNumber,positionBefore:s,positionAfter:l,position:a}}return null}getFullLineRangeAtCoord(e){if(this._context.viewLayout.isAfterLines(e)){let i=this._context.viewModel.getLineCount(),r=this._context.viewModel.getLineMaxColumn(i);return{range:new D(i,r,i,r),isAfterLines:!0}}let t=this._context.viewLayout.getLineNumberAtVerticalOffset(e),n=this._context.viewModel.getLineMaxColumn(t);return{range:new D(t,1,t,n),isAfterLines:!1}}getLineNumberAtVerticalOffset(e){return this._context.viewLayout.getLineNumberAtVerticalOffset(e)}isAfterLines(e){return this._context.viewLayout.isAfterLines(e)}isInTopPadding(e){return this._context.viewLayout.isInTopPadding(e)}isInBottomPadding(e){return this._context.viewLayout.isInBottomPadding(e)}getVerticalOffsetForLineNumber(e){return this._context.viewLayout.getVerticalOffsetForLineNumber(e)}findAttribute(e,t){return o._findAttribute(e,t,this._viewHelper.viewDomNode)}static _findAttribute(e,t,n){for(;e&&e!==e.ownerDocument.body;){if(e.hasAttribute&&e.hasAttribute(t))return e.getAttribute(t);if(e===n)return null;e=e.parentNode}return null}getLineWidth(e){return this._viewHelper.getLineWidth(e)}visibleRangeForPosition(e,t){return this._viewHelper.visibleRangeForPosition(e,t)}getPositionFromDOMInfo(e,t){return this._viewHelper.getPositionFromDOMInfo(e,t)}getCurrentScrollTop(){return this._context.viewLayout.getCurrentScrollTop()}getCurrentScrollLeft(){return this._context.viewLayout.getCurrentScrollLeft()}},QL=class{editorPos;pos;relativePos;mouseVerticalOffset;isInMarginArea;isInContentArea;mouseContentHorizontalOffset;mouseColumn;constructor(e,t,n,i){this.editorPos=t,this.pos=n,this.relativePos=i,this.mouseVerticalOffset=Math.max(0,e.getCurrentScrollTop()+this.relativePos.y),this.mouseContentHorizontalOffset=e.getCurrentScrollLeft()+this.relativePos.x-e.layoutInfo.contentLeft,this.isInMarginArea=this.relativePos.x<e.layoutInfo.contentLeft&&this.relativePos.x>=e.layoutInfo.glyphMarginLeft,this.isInContentArea=!this.isInMarginArea,this.mouseColumn=Math.max(0,_h._getMouseColumn(this.mouseContentHorizontalOffset,e.typicalHalfwidthCharacterWidth))}},JL=class extends QL{_ctx;_eventTarget;hitTestResult=new vi(()=>_h.doHitTest(this._ctx,this));_useHitTestTarget;_targetPathCacheElement=null;_targetPathCacheValue=new Uint8Array(0);get target(){return this._useHitTestTarget?this.hitTestResult.value.hitTarget:this._eventTarget}get targetPath(){return this._targetPathCacheElement!==this.target&&(this._targetPathCacheElement=this.target,this._targetPathCacheValue=Rn.collect(this.target,this._ctx.viewDomNode)),this._targetPathCacheValue}constructor(e,t,n,i,r){super(e,t,n,i),this._ctx=e,this._eventTarget=r;let s=!!this._eventTarget;this._useHitTestTarget=!s}toString(){return`pos(${this.pos.x},${this.pos.y}), editorPos(${this.editorPos.x},${this.editorPos.y}), relativePos(${this.relativePos.x},${this.relativePos.y}), mouseVerticalOffset: ${this.mouseVerticalOffset}, mouseContentHorizontalOffset: ${this.mouseContentHorizontalOffset}
	target: ${this.target?this.target.outerHTML:null}`}get wouldBenefitFromHitTestTargetSwitch(){return!this._useHitTestTarget&&this.hitTestResult.value.hitTarget!==null&&this.target!==this.hitTestResult.value.hitTarget}switchToHitTestTarget(){this._useHitTestTarget=!0}_getMouseColumn(e=null){return e&&e.column<this._ctx.viewModel.getLineMaxColumn(e.lineNumber)?_t.visibleColumnFromColumn(this._ctx.viewModel.getLineContent(e.lineNumber),e.column,this._ctx.viewModel.model.getOptions().tabSize)+1:this.mouseColumn}fulfillUnknown(e=null){return Mn.createUnknown(this.target,this._getMouseColumn(e),e)}fulfillTextarea(){return Mn.createTextarea(this.target,this._getMouseColumn())}fulfillMargin(e,t,n,i){return Mn.createMargin(e,this.target,this._getMouseColumn(t),t,n,i)}fulfillViewZone(e,t,n){return Mn.createViewZone(e,this.target,this._getMouseColumn(t),t,n)}fulfillContentText(e,t,n){return Mn.createContentText(this.target,this._getMouseColumn(e),e,t,n)}fulfillContentEmpty(e,t){return Mn.createContentEmpty(this.target,this._getMouseColumn(e),e,t)}fulfillContentWidget(e){return Mn.createContentWidget(this.target,this._getMouseColumn(),e)}fulfillScrollbar(e){return Mn.createScrollbar(this.target,this._getMouseColumn(e),e)}fulfillOverlayWidget(e){return Mn.createOverlayWidget(this.target,this._getMouseColumn(),e)}},EP={isAfterLines:!0};function XL(o){return{isAfterLines:!1,horizontalDistanceToText:o}}var _h=class o{_context;_viewHelper;constructor(e,t){this._context=e,this._viewHelper=t}mouseTargetIsWidget(e){let t=e.target,n=Rn.collect(t,this._viewHelper.viewDomNode);return!!(ni.isChildOfContentWidgets(n)||ni.isChildOfOverflowingContentWidgets(n)||ni.isChildOfOverlayWidgets(n)||ni.isChildOfOverflowingOverlayWidgets(n))}createMouseTarget(e,t,n,i,r){let s=new Eh(this._context,this._viewHelper,e),a=new JL(s,t,n,i,r);try{let l=o._createMouseTarget(s,a);if(l.type===6&&s.stickyTabStops&&l.position!==null){let d=o._snapToSoftTabBoundary(l.position,s.viewModel),c=D.fromPositions(d,d).plusRange(l.range);return a.fulfillContentText(d,c,l.detail)}return l}catch{return a.fulfillUnknown()}}static _createMouseTarget(e,t){if(t.target===null)return t.fulfillUnknown();let n=t,i=null;return!ni.isChildOfOverflowGuard(t.targetPath)&&!ni.isChildOfOverflowingContentWidgets(t.targetPath)&&!ni.isChildOfOverflowingOverlayWidgets(t.targetPath)&&(i=i||t.fulfillUnknown()),i=i||o._hitTestContentWidget(e,n),i=i||o._hitTestOverlayWidget(e,n),i=i||o._hitTestMinimap(e,n),i=i||o._hitTestScrollbarSlider(e,n),i=i||o._hitTestViewZone(e,n),i=i||o._hitTestMargin(e,n),i=i||o._hitTestViewCursor(e,n),i=i||o._hitTestTextArea(e,n),i=i||o._hitTestViewLines(e,n),i=i||o._hitTestScrollbar(e,n),i||t.fulfillUnknown()}static _hitTestContentWidget(e,t){if(ni.isChildOfContentWidgets(t.targetPath)||ni.isChildOfOverflowingContentWidgets(t.targetPath)){let n=e.findAttribute(t.target,"widgetId");return n?t.fulfillContentWidget(n):t.fulfillUnknown()}return null}static _hitTestOverlayWidget(e,t){if(ni.isChildOfOverlayWidgets(t.targetPath)||ni.isChildOfOverflowingOverlayWidgets(t.targetPath)){let n=e.findAttribute(t.target,"widgetId");return n?t.fulfillOverlayWidget(n):t.fulfillUnknown()}return null}static _hitTestViewCursor(e,t){if(t.target){let n=e.lastRenderData.lastViewCursorsRenderData;for(let i of n)if(t.target===i.domNode)return t.fulfillContentText(i.position,null,{mightBeForeignElement:!1,injectedText:null})}if(t.isInContentArea){let n=e.lastRenderData.lastViewCursorsRenderData,i=t.mouseContentHorizontalOffset,r=t.mouseVerticalOffset;for(let s of n){if(i<s.contentLeft||i>s.contentLeft+s.width)continue;let a=e.getVerticalOffsetForLineNumber(s.position.lineNumber);if(a<=r&&r<=a+s.height)return t.fulfillContentText(s.position,null,{mightBeForeignElement:!1,injectedText:null})}}return null}static _hitTestViewZone(e,t){let n=e.getZoneAtCoord(t.mouseVerticalOffset);if(n){let i=t.isInContentArea?8:5;return t.fulfillViewZone(i,n.position,n)}return null}static _hitTestTextArea(e,t){return ni.isTextArea(t.targetPath)?e.lastRenderData.lastTextareaPosition?t.fulfillContentText(e.lastRenderData.lastTextareaPosition,null,{mightBeForeignElement:!1,injectedText:null}):t.fulfillTextarea():null}static _hitTestMargin(e,t){if(t.isInMarginArea){let n=e.getFullLineRangeAtCoord(t.mouseVerticalOffset),i=n.range.getStartPosition(),r=Math.abs(t.relativePos.x),s={isAfterLines:n.isAfterLines,glyphMarginLeft:e.layoutInfo.glyphMarginLeft,glyphMarginWidth:e.layoutInfo.glyphMarginWidth,lineNumbersWidth:e.layoutInfo.lineNumbersWidth,offsetX:r};if(r-=e.layoutInfo.glyphMarginLeft,r<=e.layoutInfo.glyphMarginWidth){let a=e.viewModel.coordinatesConverter.convertViewPositionToModelPosition(n.range.getStartPosition()),l=e.viewModel.glyphLanes.getLanesAtLine(a.lineNumber);return s.glyphMarginLane=l[Math.floor(r/e.lineHeight)],t.fulfillMargin(2,i,n.range,s)}return r-=e.layoutInfo.glyphMarginWidth,r<=e.layoutInfo.lineNumbersWidth?t.fulfillMargin(3,i,n.range,s):(r-=e.layoutInfo.lineNumbersWidth,t.fulfillMargin(4,i,n.range,s))}return null}static _hitTestViewLines(e,t){if(!ni.isChildOfViewLines(t.targetPath))return null;if(e.isInTopPadding(t.mouseVerticalOffset))return t.fulfillContentEmpty(new P(1,1),EP);if(e.isAfterLines(t.mouseVerticalOffset)||e.isInBottomPadding(t.mouseVerticalOffset)){let i=e.viewModel.getLineCount(),r=e.viewModel.getLineMaxColumn(i);return t.fulfillContentEmpty(new P(i,r),EP)}if(ni.isStrictChildOfViewLines(t.targetPath)){let i=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset);if(e.viewModel.getLineLength(i)===0){let s=e.getLineWidth(i),a=XL(t.mouseContentHorizontalOffset-s);return t.fulfillContentEmpty(new P(i,1),a)}let r=e.getLineWidth(i);if(t.mouseContentHorizontalOffset>=r){let s=XL(t.mouseContentHorizontalOffset-r),a=new P(i,e.viewModel.getLineMaxColumn(i));return t.fulfillContentEmpty(a,s)}}let n=t.hitTestResult.value;return n.type===1?o.createMouseTargetFromHitTestPosition(e,t,n.spanNode,n.position,n.injectedText):t.wouldBenefitFromHitTestTargetSwitch?(t.switchToHitTestTarget(),this._createMouseTarget(e,t)):t.fulfillUnknown()}static _hitTestMinimap(e,t){if(ni.isChildOfMinimap(t.targetPath)){let n=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),i=e.viewModel.getLineMaxColumn(n);return t.fulfillScrollbar(new P(n,i))}return null}static _hitTestScrollbarSlider(e,t){if(ni.isChildOfScrollableElement(t.targetPath)&&t.target&&t.target.nodeType===1){let n=t.target.className;if(n&&/\b(slider|scrollbar)\b/.test(n)){let i=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),r=e.viewModel.getLineMaxColumn(i);return t.fulfillScrollbar(new P(i,r))}}return null}static _hitTestScrollbar(e,t){if(ni.isChildOfScrollableElement(t.targetPath)){let n=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),i=e.viewModel.getLineMaxColumn(n);return t.fulfillScrollbar(new P(n,i))}return null}getMouseColumn(e){let t=this._context.configuration.options,n=t.get(147),i=this._context.viewLayout.getCurrentScrollLeft()+e.x-n.contentLeft;return o._getMouseColumn(i,t.get(51).typicalHalfwidthCharacterWidth)}static _getMouseColumn(e,t){return e<0?1:Math.round(e/t)+1}static createMouseTargetFromHitTestPosition(e,t,n,i,r){let s=i.lineNumber,a=i.column,l=e.getLineWidth(s);if(t.mouseContentHorizontalOffset>l){let y=XL(t.mouseContentHorizontalOffset-l);return t.fulfillContentEmpty(i,y)}let d=e.visibleRangeForPosition(s,a);if(!d)return t.fulfillUnknown(i);let c=d.left;if(Math.abs(t.mouseContentHorizontalOffset-c)<1)return t.fulfillContentText(i,null,{mightBeForeignElement:!!r,injectedText:r});let u=[];if(u.push({offset:d.left,column:a}),a>1){let y=e.visibleRangeForPosition(s,a-1);y&&u.push({offset:y.left,column:a-1})}let h=e.viewModel.getLineMaxColumn(s);if(a<h){let y=e.visibleRangeForPosition(s,a+1);y&&u.push({offset:y.left,column:a+1})}u.sort((y,C)=>y.offset-C.offset);let m=t.pos.toClientCoordinates(Ie(e.viewDomNode)),f=n.getBoundingClientRect(),g=f.left<=m.clientX&&m.clientX<=f.right,b=null;for(let y=1;y<u.length;y++){let C=u[y-1],x=u[y];if(C.offset<=t.mouseContentHorizontalOffset&&t.mouseContentHorizontalOffset<=x.offset){b=new D(s,C.column,s,x.column);let L=Math.abs(C.offset-t.mouseContentHorizontalOffset),k=Math.abs(x.offset-t.mouseContentHorizontalOffset);i=L<k?new P(s,C.column):new P(s,x.column);break}}return t.fulfillContentText(i,b,{mightBeForeignElement:!g||!!r,injectedText:r})}static _doHitTestWithCaretRangeFromPoint(e,t){let n=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),i=e.getVerticalOffsetForLineNumber(n),r=i+e.lineHeight;if(!(n===e.viewModel.getLineCount()&&t.mouseVerticalOffset>r)){let a=Math.floor((i+r)/2),l=t.pos.y+(a-t.mouseVerticalOffset);l<=t.editorPos.y&&(l=t.editorPos.y+1),l>=t.editorPos.y+t.editorPos.height&&(l=t.editorPos.y+t.editorPos.height-1);let d=new Pl(t.pos.x,l),c=this._actualDoHitTestWithCaretRangeFromPoint(e,d.toClientCoordinates(Ie(e.viewDomNode)));if(c.type===1)return c}return this._actualDoHitTestWithCaretRangeFromPoint(e,t.pos.toClientCoordinates(Ie(e.viewDomNode)))}static _actualDoHitTestWithCaretRangeFromPoint(e,t){let n=ol(e.viewDomNode),i;if(n?typeof n.caretRangeFromPoint>"u"?i=T5(n,t.clientX,t.clientY):i=n.caretRangeFromPoint(t.clientX,t.clientY):i=e.viewDomNode.ownerDocument.caretRangeFromPoint(t.clientX,t.clientY),!i||!i.startContainer)return new Vs;let r=i.startContainer;if(r.nodeType===r.TEXT_NODE){let s=r.parentNode,a=s?s.parentNode:null,l=a?a.parentNode:null;return(l&&l.nodeType===l.ELEMENT_NODE?l.className:null)===jr.CLASS_NAME?xh.createFromDOMInfo(e,s,i.startOffset):new Vs(r.parentNode)}else if(r.nodeType===r.ELEMENT_NODE){let s=r.parentNode,a=s?s.parentNode:null;return(a&&a.nodeType===a.ELEMENT_NODE?a.className:null)===jr.CLASS_NAME?xh.createFromDOMInfo(e,r,r.textContent.length):new Vs(r)}return new Vs}static _doHitTestWithCaretPositionFromPoint(e,t){let n=e.viewDomNode.ownerDocument.caretPositionFromPoint(t.clientX,t.clientY);if(n.offsetNode.nodeType===n.offsetNode.TEXT_NODE){let i=n.offsetNode.parentNode,r=i?i.parentNode:null,s=r?r.parentNode:null;return(s&&s.nodeType===s.ELEMENT_NODE?s.className:null)===jr.CLASS_NAME?xh.createFromDOMInfo(e,n.offsetNode.parentNode,n.offset):new Vs(n.offsetNode.parentNode)}if(n.offsetNode.nodeType===n.offsetNode.ELEMENT_NODE){let i=n.offsetNode.parentNode,r=i&&i.nodeType===i.ELEMENT_NODE?i.className:null,s=i?i.parentNode:null,a=s&&s.nodeType===s.ELEMENT_NODE?s.className:null;if(r===jr.CLASS_NAME){let l=n.offsetNode.childNodes[Math.min(n.offset,n.offsetNode.childNodes.length-1)];if(l)return xh.createFromDOMInfo(e,l,0)}else if(a===jr.CLASS_NAME)return xh.createFromDOMInfo(e,n.offsetNode,0)}return new Vs(n.offsetNode)}static _snapToSoftTabBoundary(e,t){let n=t.getLineContent(e.lineNumber),{tabSize:i}=t.model.getOptions(),r=rc.atomicPosition(n,e.column-1,i,2);return r!==-1?new P(e.lineNumber,r+1):e}static doHitTest(e,t){let n=new Vs;if(typeof e.viewDomNode.ownerDocument.caretRangeFromPoint=="function"?n=this._doHitTestWithCaretRangeFromPoint(e,t):e.viewDomNode.ownerDocument.caretPositionFromPoint&&(n=this._doHitTestWithCaretPositionFromPoint(e,t.pos.toClientCoordinates(Ie(e.viewDomNode)))),n.type===1){let i=e.viewModel.getInjectedTextAt(n.position),r=e.viewModel.normalizePosition(n.position,2);(i||!r.equals(n.position))&&(n=new BI(r,n.spanNode,i))}return n}};function T5(o,e,t){let n=document.createRange(),i=o.elementFromPoint(e,t);if(i!==null){for(;i&&i.firstChild&&i.firstChild.nodeType!==i.firstChild.TEXT_NODE&&i.lastChild&&i.lastChild.firstChild;)i=i.lastChild;let r=i.getBoundingClientRect(),s=Ie(i),a=s.getComputedStyle(i,null).getPropertyValue("font-style"),l=s.getComputedStyle(i,null).getPropertyValue("font-variant"),d=s.getComputedStyle(i,null).getPropertyValue("font-weight"),c=s.getComputedStyle(i,null).getPropertyValue("font-size"),u=s.getComputedStyle(i,null).getPropertyValue("line-height"),h=s.getComputedStyle(i,null).getPropertyValue("font-family"),m=`${a} ${l} ${d} ${c}/${u} ${h}`,f=i.innerText,g=r.left,b=0,y;if(e>r.left+r.width)b=f.length;else{let C=eD.getInstance();for(let x=0;x<f.length+1;x++){if(y=C.getCharWidth(f.charAt(x),m)/2,g+=y,e<g){b=x;break}g+=y}}n.setStart(i.firstChild,b),n.setEnd(i.firstChild,b)}return n}var eD=class o{static _INSTANCE=null;static getInstance(){return o._INSTANCE||(o._INSTANCE=new o),o._INSTANCE}_cache;_canvas;constructor(){this._cache={},this._canvas=document.createElement("canvas")}getCharWidth(e,t){let n=e+t;if(this._cache[n])return this._cache[n];let i=this._canvas.getContext("2d");i.font=t;let s=i.measureText(e).width;return this._cache[n]=s,s}};var _P=2e4,DP,nD,TP,iD,LP;function Th(o){DP&&(nD.textContent!==o?(Ci(TP),WI(nD,o)):(Ci(nD),WI(TP,o)))}function Dg(o){DP&&(iD.textContent!==o?(Ci(LP),WI(iD,o)):(Ci(iD),WI(LP,o)))}function WI(o,e){Ci(o),e.length>_P&&(e=e.substr(0,_P)),o.textContent=e,o.style.visibility="hidden",o.style.visibility="visible"}var Fl=class o{static columnSelect(e,t,n,i,r,s){let a=Math.abs(r-n)+1,l=n>r,d=i>s,c=i<s,u=[];for(let h=0;h<a;h++){let m=n+(l?-h:h),f=e.columnFromVisibleColumn(t,m,i),g=e.columnFromVisibleColumn(t,m,s),b=e.visibleColumnFromColumn(t,new P(m,f)),y=e.visibleColumnFromColumn(t,new P(m,g));c&&(b>s||y<i)||d&&(y>i||b<s)||u.push(new cn(new D(m,f,m,f),0,0,new P(m,g),0))}if(u.length===0)for(let h=0;h<a;h++){let m=n+(l?-h:h),f=t.getLineMaxColumn(m);u.push(new cn(new D(m,f,m,f),0,0,new P(m,f),0))}return{viewStates:u,reversed:l,fromLineNumber:n,fromVisualColumn:i,toLineNumber:r,toVisualColumn:s}}static columnSelectLeft(e,t,n){let i=n.toViewVisualColumn;return i>0&&i--,o.columnSelect(e,t,n.fromViewLineNumber,n.fromViewVisualColumn,n.toViewLineNumber,i)}static columnSelectRight(e,t,n){let i=0,r=Math.min(n.fromViewLineNumber,n.toViewLineNumber),s=Math.max(n.fromViewLineNumber,n.toViewLineNumber);for(let l=r;l<=s;l++){let d=t.getLineMaxColumn(l),c=e.visibleColumnFromColumn(t,new P(l,d));i=Math.max(i,c)}let a=n.toViewVisualColumn;return a<i&&a++,this.columnSelect(e,t,n.fromViewLineNumber,n.fromViewVisualColumn,n.toViewLineNumber,a)}static columnSelectUp(e,t,n,i){let r=i?e.pageSize:1,s=Math.max(1,n.toViewLineNumber-r);return this.columnSelect(e,t,n.fromViewLineNumber,n.fromViewVisualColumn,s,n.toViewVisualColumn)}static columnSelectDown(e,t,n,i){let r=i?e.pageSize:1,s=Math.min(t.getLineCount(),n.toViewLineNumber+r);return this.columnSelect(e,t,n.fromViewLineNumber,n.fromViewVisualColumn,s,n.toViewVisualColumn)}};var ii=class{_range;_text;insertsAutoWhitespace;constructor(e,t,n=!1){this._range=e,this._text=t,this.insertsAutoWhitespace=n}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){let i=t.getInverseEditOperations()[0].range;return He.fromPositions(i.getEndPosition())}};var ac=class{_range;_text;insertsAutoWhitespace;constructor(e,t,n=!1){this._range=e,this._text=t,this.insertsAutoWhitespace=n}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){let i=t.getInverseEditOperations()[0].range;return He.fromPositions(i.getStartPosition())}},lc=class{_range;_text;_columnDeltaOffset;_lineNumberDeltaOffset;insertsAutoWhitespace;constructor(e,t,n,i,r=!1){this._range=e,this._text=t,this._columnDeltaOffset=i,this._lineNumberDeltaOffset=n,this.insertsAutoWhitespace=r}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){let i=t.getInverseEditOperations()[0].range;return He.fromPositions(i.getEndPosition().delta(this._lineNumberDeltaOffset,this._columnDeltaOffset))}},UI=class{_range;_text;_initialSelection;_forceMoveMarkers;_selectionId;constructor(e,t,n,i=!1){this._range=e,this._text=t,this._initialSelection=n,this._forceMoveMarkers=i,this._selectionId=null}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text,this._forceMoveMarkers),this._selectionId=t.trackSelection(this._initialSelection)}computeCursorState(e,t){return t.getTrackedSelection(this._selectionId)}};var kg=class{_cursorPositionBrand=void 0;lineNumber;column;leftoverVisibleColumns;constructor(e,t,n){this.lineNumber=e,this.column=t,this.leftoverVisibleColumns=n}},Kt=class o{static leftPosition(e,t){if(t.column>e.getLineMinColumn(t.lineNumber))return t.delta(void 0,-xx(e.getLineContent(t.lineNumber),t.column-1));if(t.lineNumber>1){let n=t.lineNumber-1;return new P(n,e.getLineMaxColumn(n))}else return t}static leftPositionAtomicSoftTabs(e,t,n){if(t.column<=e.getLineIndentColumn(t.lineNumber)){let i=e.getLineMinColumn(t.lineNumber),r=e.getLineContent(t.lineNumber),s=rc.atomicPosition(r,t.column-1,n,0);if(s!==-1&&s+1>=i)return new P(t.lineNumber,s+1)}return this.leftPosition(e,t)}static left(e,t,n){let i=e.stickyTabStops?o.leftPositionAtomicSoftTabs(t,n,e.tabSize):o.leftPosition(t,n);return new kg(i.lineNumber,i.column,0)}static moveLeft(e,t,n,i,r){let s,a;if(n.hasSelection()&&!i)s=n.selection.startLineNumber,a=n.selection.startColumn;else{let l=n.position.delta(void 0,-(r-1)),d=t.normalizePosition(o.clipPositionColumn(l,t),0),c=o.left(e,t,d);s=c.lineNumber,a=c.column}return n.move(i,s,a,0)}static clipPositionColumn(e,t){return new P(e.lineNumber,o.clipRange(e.column,t.getLineMinColumn(e.lineNumber),t.getLineMaxColumn(e.lineNumber)))}static clipRange(e,t,n){return e<t?t:e>n?n:e}static rightPosition(e,t,n){return n<e.getLineMaxColumn(t)?n=n+Up(e.getLineContent(t),n-1):t<e.getLineCount()&&(t=t+1,n=e.getLineMinColumn(t)),new P(t,n)}static rightPositionAtomicSoftTabs(e,t,n,i,r){if(n<e.getLineIndentColumn(t)){let s=e.getLineContent(t),a=rc.atomicPosition(s,n-1,i,1);if(a!==-1)return new P(t,a+1)}return this.rightPosition(e,t,n)}static right(e,t,n){let i=e.stickyTabStops?o.rightPositionAtomicSoftTabs(t,n.lineNumber,n.column,e.tabSize,e.indentSize):o.rightPosition(t,n.lineNumber,n.column);return new kg(i.lineNumber,i.column,0)}static moveRight(e,t,n,i,r){let s,a;if(n.hasSelection()&&!i)s=n.selection.endLineNumber,a=n.selection.endColumn;else{let l=n.position.delta(void 0,r-1),d=t.normalizePosition(o.clipPositionColumn(l,t),1),c=o.right(e,t,d);s=c.lineNumber,a=c.column}return n.move(i,s,a,0)}static vertical(e,t,n,i,r,s,a,l){let d=_t.visibleColumnFromColumn(t.getLineContent(n),i,e.tabSize)+r,c=t.getLineCount(),u=n===1&&i===1,h=n===c&&i===t.getLineMaxColumn(n),m=s<n?u:h;if(n=s,n<1?(n=1,a?i=t.getLineMinColumn(n):i=Math.min(t.getLineMaxColumn(n),i)):n>c?(n=c,a?i=t.getLineMaxColumn(n):i=Math.min(t.getLineMaxColumn(n),i)):i=e.columnFromVisibleColumn(t,n,d),m?r=0:r=d-_t.visibleColumnFromColumn(t.getLineContent(n),i,e.tabSize),l!==void 0){let f=new P(n,i),g=t.normalizePosition(f,l);r=r+(i-g.column),n=g.lineNumber,i=g.column}return new kg(n,i,r)}static down(e,t,n,i,r,s,a){return this.vertical(e,t,n,i,r,n+s,a,4)}static moveDown(e,t,n,i,r){let s,a;n.hasSelection()&&!i?(s=n.selection.endLineNumber,a=n.selection.endColumn):(s=n.position.lineNumber,a=n.position.column);let l=0,d;do if(d=o.down(e,t,s+l,a,n.leftoverVisibleColumns,r,!0),t.normalizePosition(new P(d.lineNumber,d.column),2).lineNumber>s)break;while(l++<10&&s+l<t.getLineCount());return n.move(i,d.lineNumber,d.column,d.leftoverVisibleColumns)}static translateDown(e,t,n){let i=n.selection,r=o.down(e,t,i.selectionStartLineNumber,i.selectionStartColumn,n.selectionStartLeftoverVisibleColumns,1,!1),s=o.down(e,t,i.positionLineNumber,i.positionColumn,n.leftoverVisibleColumns,1,!1);return new cn(new D(r.lineNumber,r.column,r.lineNumber,r.column),0,r.leftoverVisibleColumns,new P(s.lineNumber,s.column),s.leftoverVisibleColumns)}static up(e,t,n,i,r,s,a){return this.vertical(e,t,n,i,r,n-s,a,3)}static moveUp(e,t,n,i,r){let s,a;n.hasSelection()&&!i?(s=n.selection.startLineNumber,a=n.selection.startColumn):(s=n.position.lineNumber,a=n.position.column);let l=o.up(e,t,s,a,n.leftoverVisibleColumns,r,!0);return n.move(i,l.lineNumber,l.column,l.leftoverVisibleColumns)}static translateUp(e,t,n){let i=n.selection,r=o.up(e,t,i.selectionStartLineNumber,i.selectionStartColumn,n.selectionStartLeftoverVisibleColumns,1,!1),s=o.up(e,t,i.positionLineNumber,i.positionColumn,n.leftoverVisibleColumns,1,!1);return new cn(new D(r.lineNumber,r.column,r.lineNumber,r.column),0,r.leftoverVisibleColumns,new P(s.lineNumber,s.column),s.leftoverVisibleColumns)}static _isBlankLine(e,t){return e.getLineFirstNonWhitespaceColumn(t)===0}static moveToPrevBlankLine(e,t,n,i){let r=n.position.lineNumber;for(;r>1&&this._isBlankLine(t,r);)r--;for(;r>1&&!this._isBlankLine(t,r);)r--;return n.move(i,r,t.getLineMinColumn(r),0)}static moveToNextBlankLine(e,t,n,i){let r=t.getLineCount(),s=n.position.lineNumber;for(;s<r&&this._isBlankLine(t,s);)s++;for(;s<r&&!this._isBlankLine(t,s);)s++;return n.move(i,s,t.getLineMinColumn(s),0)}static moveToBeginningOfLine(e,t,n,i){let r=n.position.lineNumber,s=t.getLineMinColumn(r),a=t.getLineFirstNonWhitespaceColumn(r)||s,l;return n.position.column===a?l=s:l=a,n.move(i,r,l,0)}static moveToEndOfLine(e,t,n,i,r){let s=n.position.lineNumber,a=t.getLineMaxColumn(s);return n.move(i,s,a,r?1073741824-a:0)}static moveToBeginningOfBuffer(e,t,n,i){return n.move(i,1,1,0)}static moveToEndOfBuffer(e,t,n,i){let r=t.getLineCount(),s=t.getLineMaxColumn(r);return n.move(i,r,s,0)}};var Ta=class o{static deleteRight(e,t,n,i){let r=[],s=e!==3;for(let a=0,l=i.length;a<l;a++){let d=i[a],c=d;if(c.isEmpty()){let u=d.getPosition(),h=Kt.right(t,n,u);c=new D(h.lineNumber,h.column,u.lineNumber,u.column)}if(c.isEmpty()){r[a]=null;continue}c.startLineNumber!==c.endLineNumber&&(s=!0),r[a]=new ii(c,"")}return[s,r]}static isAutoClosingPairDelete(e,t,n,i,r,s,a){if(t==="never"&&n==="never"||e==="never")return!1;for(let l=0,d=s.length;l<d;l++){let c=s[l],u=c.getPosition();if(!c.isEmpty())return!1;let h=r.getLineContent(u.lineNumber);if(u.column<2||u.column>=h.length+1)return!1;let m=h.charAt(u.column-2),f=i.get(m);if(!f)return!1;if(Nr(m)){if(n==="never")return!1}else if(t==="never")return!1;let g=h.charAt(u.column-1),b=!1;for(let y of f)y.open===m&&y.close===g&&(b=!0);if(!b)return!1;if(e==="auto"){let y=!1;for(let C=0,x=a.length;C<x;C++){let L=a[C];if(u.lineNumber===L.startLineNumber&&u.column===L.startColumn){y=!0;break}}if(!y)return!1}}return!0}static _runAutoClosingPairDelete(e,t,n){let i=[];for(let r=0,s=n.length;r<s;r++){let a=n[r].getPosition(),l=new D(a.lineNumber,a.column-1,a.lineNumber,a.column+1);i[r]=new ii(l,"")}return[!0,i]}static deleteLeft(e,t,n,i,r){if(this.isAutoClosingPairDelete(t.autoClosingDelete,t.autoClosingBrackets,t.autoClosingQuotes,t.autoClosingPairs.autoClosingPairsOpenByEnd,n,i,r))return this._runAutoClosingPairDelete(t,n,i);let s=[],a=e!==2;for(let l=0,d=i.length;l<d;l++){let c=o.getDeleteRange(i[l],n,t);if(c.isEmpty()){s[l]=null;continue}c.startLineNumber!==c.endLineNumber&&(a=!0),s[l]=new ii(c,"")}return[a,s]}static getDeleteRange(e,t,n){if(!e.isEmpty())return e;let i=e.getPosition();if(n.useTabStops&&i.column>1){let r=t.getLineContent(i.lineNumber),s=Xt(r),a=s===-1?r.length+1:s+1;if(i.column<=a){let l=n.visibleColumnFromColumn(t,i),d=_t.prevIndentTabStop(l,n.indentSize),c=n.columnFromVisibleColumn(t,i.lineNumber,d);return new D(i.lineNumber,c,i.lineNumber,i.column)}}return D.fromPositions(o.getPositionAfterDeleteLeft(i,t),i)}static getPositionAfterDeleteLeft(e,t){if(e.column>1){let n=Lk(e.column-1,t.getLineContent(e.lineNumber));return e.with(void 0,n+1)}else if(e.lineNumber>1){let n=e.lineNumber-1;return new P(n,t.getLineMaxColumn(n))}else return e}static cut(e,t,n){let i=[],r=null;n.sort((s,a)=>P.compare(s.getStartPosition(),a.getEndPosition()));for(let s=0,a=n.length;s<a;s++){let l=n[s];if(l.isEmpty())if(e.emptySelectionClipboard){let d=l.getPosition(),c,u,h,m;d.lineNumber<t.getLineCount()?(c=d.lineNumber,u=1,h=d.lineNumber+1,m=1):d.lineNumber>1&&r?.endLineNumber!==d.lineNumber?(c=d.lineNumber-1,u=t.getLineMaxColumn(d.lineNumber-1),h=d.lineNumber,m=t.getLineMaxColumn(d.lineNumber)):(c=d.lineNumber,u=1,h=d.lineNumber,m=t.getLineMaxColumn(d.lineNumber));let f=new D(c,u,h,m);r=f,f.isEmpty()?i[s]=null:i[s]=new ii(f,"")}else i[s]=null;else i[s]=new ii(l,"")}return new Sn(0,i,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}};var Lh=class o{static _createWord(e,t,n,i,r){return{start:i,end:r,wordType:t,nextCharClass:n}}static _createIntlWord(e,t){return{start:e.index,end:e.index+e.segment.length,wordType:1,nextCharClass:t}}static _findPreviousWordOnLine(e,t,n){let i=t.getLineContent(n.lineNumber);return this._doFindPreviousWordOnLine(i,e,n)}static _doFindPreviousWordOnLine(e,t,n){let i=0,r=t.findPrevIntlWordBeforeOrAtOffset(e,n.column-2);for(let s=n.column-2;s>=0;s--){let a=e.charCodeAt(s),l=t.get(a);if(r&&s===r.index)return this._createIntlWord(r,l);if(l===0){if(i===2)return this._createWord(e,i,l,s+1,this._findEndOfWord(e,t,i,s+1));i=1}else if(l===2){if(i===1)return this._createWord(e,i,l,s+1,this._findEndOfWord(e,t,i,s+1));i=2}else if(l===1&&i!==0)return this._createWord(e,i,l,s+1,this._findEndOfWord(e,t,i,s+1))}return i!==0?this._createWord(e,i,1,0,this._findEndOfWord(e,t,i,0)):null}static _findEndOfWord(e,t,n,i){let r=t.findNextIntlWordAtOrAfterOffset(e,i),s=e.length;for(let a=i;a<s;a++){let l=e.charCodeAt(a),d=t.get(l);if(r&&a===r.index+r.segment.length||d===1||n===1&&d===2||n===2&&d===0)return a}return s}static _findNextWordOnLine(e,t,n){let i=t.getLineContent(n.lineNumber);return this._doFindNextWordOnLine(i,e,n)}static _doFindNextWordOnLine(e,t,n){let i=0,r=e.length,s=t.findNextIntlWordAtOrAfterOffset(e,n.column-1);for(let a=n.column-1;a<r;a++){let l=e.charCodeAt(a),d=t.get(l);if(s&&a===s.index)return this._createIntlWord(s,d);if(d===0){if(i===2)return this._createWord(e,i,d,this._findStartOfWord(e,t,i,a-1),a);i=1}else if(d===2){if(i===1)return this._createWord(e,i,d,this._findStartOfWord(e,t,i,a-1),a);i=2}else if(d===1&&i!==0)return this._createWord(e,i,d,this._findStartOfWord(e,t,i,a-1),a)}return i!==0?this._createWord(e,i,1,this._findStartOfWord(e,t,i,r-1),r):null}static _findStartOfWord(e,t,n,i){let r=t.findPrevIntlWordBeforeOrAtOffset(e,i);for(let s=i;s>=0;s--){let a=e.charCodeAt(s),l=t.get(a);if(r&&s===r.index)return s;if(l===1||n===1&&l===2||n===2&&l===0)return s+1}return 0}static moveWordLeft(e,t,n,i,r){let s=n.lineNumber,a=n.column;a===1&&s>1&&(s=s-1,a=t.getLineMaxColumn(s));let l=o._findPreviousWordOnLine(e,t,new P(s,a));if(i===0)return new P(s,l?l.start+1:1);if(i===1)return!r&&l&&l.wordType===2&&l.end-l.start===1&&l.nextCharClass===0&&(l=o._findPreviousWordOnLine(e,t,new P(s,l.start+1))),new P(s,l?l.start+1:1);if(i===3){for(;l&&l.wordType===2;)l=o._findPreviousWordOnLine(e,t,new P(s,l.start+1));return new P(s,l?l.start+1:1)}return l&&a<=l.end+1&&(l=o._findPreviousWordOnLine(e,t,new P(s,l.start+1))),new P(s,l?l.end+1:1)}static _moveWordPartLeft(e,t){let n=t.lineNumber,i=e.getLineMaxColumn(n);if(t.column===1)return n>1?new P(n-1,e.getLineMaxColumn(n-1)):t;let r=e.getLineContent(n);for(let s=t.column-1;s>1;s--){let a=r.charCodeAt(s-2),l=r.charCodeAt(s-1);if(a===95&&l!==95)return new P(n,s);if(a===45&&l!==45)return new P(n,s);if((cd(a)||Vp(a))&&ss(l))return new P(n,s);if(ss(a)&&ss(l)&&s+1<i){let d=r.charCodeAt(s);if(cd(d)||Vp(d))return new P(n,s)}}return new P(n,1)}static moveWordRight(e,t,n,i){let r=n.lineNumber,s=n.column,a=!1;s===t.getLineMaxColumn(r)&&r<t.getLineCount()&&(a=!0,r=r+1,s=1);let l=o._findNextWordOnLine(e,t,new P(r,s));if(i===2)l&&l.wordType===2&&l.end-l.start===1&&l.nextCharClass===0&&(l=o._findNextWordOnLine(e,t,new P(r,l.end+1))),l?s=l.end+1:s=t.getLineMaxColumn(r);else if(i===3){for(a&&(s=0);l&&(l.wordType===2||l.start+1<=s);)l=o._findNextWordOnLine(e,t,new P(r,l.end+1));l?s=l.start+1:s=t.getLineMaxColumn(r)}else l&&!a&&s>=l.start+1&&(l=o._findNextWordOnLine(e,t,new P(r,l.end+1))),l?s=l.start+1:s=t.getLineMaxColumn(r);return new P(r,s)}static _moveWordPartRight(e,t){let n=t.lineNumber,i=e.getLineMaxColumn(n);if(t.column===i)return n<e.getLineCount()?new P(n+1,1):t;let r=e.getLineContent(n);for(let s=t.column+1;s<i;s++){let a=r.charCodeAt(s-2),l=r.charCodeAt(s-1);if(a!==95&&l===95)return new P(n,s);if(a!==45&&l===45)return new P(n,s);if((cd(a)||Vp(a))&&ss(l))return new P(n,s);if(ss(a)&&ss(l)&&s+1<i){let d=r.charCodeAt(s);if(cd(d)||Vp(d))return new P(n,s)}}return new P(n,i)}static _deleteWordLeftWhitespace(e,t){let n=e.getLineContent(t.lineNumber),i=t.column-2,r=Wo(n,i);return r+1<i?new D(t.lineNumber,r+2,t.lineNumber,t.column):null}static deleteWordLeft(e,t){let n=e.wordSeparators,i=e.model,r=e.selection,s=e.whitespaceHeuristics;if(!r.isEmpty())return r;if(Ta.isAutoClosingPairDelete(e.autoClosingDelete,e.autoClosingBrackets,e.autoClosingQuotes,e.autoClosingPairs.autoClosingPairsOpenByEnd,e.model,[e.selection],e.autoClosedCharacters)){let u=e.selection.getPosition();return new D(u.lineNumber,u.column-1,u.lineNumber,u.column+1)}let a=new P(r.positionLineNumber,r.positionColumn),l=a.lineNumber,d=a.column;if(l===1&&d===1)return null;if(s){let u=this._deleteWordLeftWhitespace(i,a);if(u)return u}let c=o._findPreviousWordOnLine(n,i,a);return t===0?c?d=c.start+1:d>1?d=1:(l--,d=i.getLineMaxColumn(l)):(c&&d<=c.end+1&&(c=o._findPreviousWordOnLine(n,i,new P(l,c.start+1))),c?d=c.end+1:d>1?d=1:(l--,d=i.getLineMaxColumn(l))),new D(l,d,a.lineNumber,a.column)}static deleteInsideWord(e,t,n){if(!n.isEmpty())return n;let i=new P(n.positionLineNumber,n.positionColumn),r=this._deleteInsideWordWhitespace(t,i);return r||this._deleteInsideWordDetermineDeleteRange(e,t,i)}static _charAtIsWhitespace(e,t){let n=e.charCodeAt(t);return n===32||n===9}static _deleteInsideWordWhitespace(e,t){let n=e.getLineContent(t.lineNumber),i=n.length;if(i===0)return null;let r=Math.max(t.column-2,0);if(!this._charAtIsWhitespace(n,r))return null;let s=Math.min(t.column-1,i-1);if(!this._charAtIsWhitespace(n,s))return null;for(;r>0&&this._charAtIsWhitespace(n,r-1);)r--;for(;s+1<i&&this._charAtIsWhitespace(n,s+1);)s++;return new D(t.lineNumber,r+1,t.lineNumber,s+2)}static _deleteInsideWordDetermineDeleteRange(e,t,n){let i=t.getLineContent(n.lineNumber),r=i.length;if(r===0)return n.lineNumber>1?new D(n.lineNumber-1,t.getLineMaxColumn(n.lineNumber-1),n.lineNumber,1):n.lineNumber<t.getLineCount()?new D(n.lineNumber,1,n.lineNumber+1,1):new D(n.lineNumber,1,n.lineNumber,1);let s=u=>u.start+1<=n.column&&n.column<=u.end+1,a=(u,h)=>(u=Math.min(u,n.column),h=Math.max(h,n.column),new D(n.lineNumber,u,n.lineNumber,h)),l=u=>{let h=u.start+1,m=u.end+1,f=!1;for(;m-1<r&&this._charAtIsWhitespace(i,m-1);)f=!0,m++;if(!f)for(;h>1&&this._charAtIsWhitespace(i,h-2);)h--;return a(h,m)},d=o._findPreviousWordOnLine(e,t,n);if(d&&s(d))return l(d);let c=o._findNextWordOnLine(e,t,n);return c&&s(c)?l(c):d&&c?a(d.end+1,c.start+1):d?a(d.start+1,d.end+1):c?a(c.start+1,c.end+1):a(1,r+1)}static _deleteWordPartLeft(e,t){if(!t.isEmpty())return t;let n=t.getPosition(),i=o._moveWordPartLeft(e,n);return new D(n.lineNumber,n.column,i.lineNumber,i.column)}static _findFirstNonWhitespaceChar(e,t){let n=e.length;for(let i=t;i<n;i++){let r=e.charAt(i);if(r!==" "&&r!=="	")return i}return n}static _deleteWordRightWhitespace(e,t){let n=e.getLineContent(t.lineNumber),i=t.column-1,r=this._findFirstNonWhitespaceChar(n,i);return i+1<r?new D(t.lineNumber,t.column,t.lineNumber,r+1):null}static deleteWordRight(e,t){let n=e.wordSeparators,i=e.model,r=e.selection,s=e.whitespaceHeuristics;if(!r.isEmpty())return r;let a=new P(r.positionLineNumber,r.positionColumn),l=a.lineNumber,d=a.column,c=i.getLineCount(),u=i.getLineMaxColumn(l);if(l===c&&d===u)return null;if(s){let m=this._deleteWordRightWhitespace(i,a);if(m)return m}let h=o._findNextWordOnLine(n,i,a);return t===2?h?d=h.end+1:d<u||l===c?d=u:(l++,h=o._findNextWordOnLine(n,i,new P(l,1)),h?d=h.start+1:d=i.getLineMaxColumn(l)):(h&&d>=h.start+1&&(h=o._findNextWordOnLine(n,i,new P(l,h.end+1))),h?d=h.start+1:d<u||l===c?d=u:(l++,h=o._findNextWordOnLine(n,i,new P(l,1)),h?d=h.start+1:d=i.getLineMaxColumn(l))),new D(l,d,a.lineNumber,a.column)}static _deleteWordPartRight(e,t){if(!t.isEmpty())return t;let n=t.getPosition(),i=o._moveWordPartRight(e,n);return new D(n.lineNumber,n.column,i.lineNumber,i.column)}static _createWordAtPosition(e,t,n){let i=new D(t,n.start+1,t,n.end+1);return{word:e.getValueInRange(i),startColumn:i.startColumn,endColumn:i.endColumn}}static getWordAtPosition(e,t,n,i){let r=Is(t,n),s=o._findPreviousWordOnLine(r,e,i);if(s&&s.wordType===1&&s.start<=i.column-1&&i.column-1<=s.end)return o._createWordAtPosition(e,i.lineNumber,s);let a=o._findNextWordOnLine(r,e,i);return a&&a.wordType===1&&a.start<=i.column-1&&i.column-1<=a.end?o._createWordAtPosition(e,i.lineNumber,a):null}static word(e,t,n,i,r){let s=Is(e.wordSeparators,e.wordSegmenterLocales),a=o._findPreviousWordOnLine(s,t,r),l=o._findNextWordOnLine(s,t,r);if(!i){let m,f;return a&&a.wordType===1&&a.start<=r.column-1&&r.column-1<=a.end?(m=a.start+1,f=a.end+1):l&&l.wordType===1&&l.start<=r.column-1&&r.column-1<=l.end?(m=l.start+1,f=l.end+1):(a?m=a.end+1:m=1,l?f=l.start+1:f=t.getLineMaxColumn(r.lineNumber)),new cn(new D(r.lineNumber,m,r.lineNumber,f),1,0,new P(r.lineNumber,f),0)}let d,c;a&&a.wordType===1&&a.start<r.column-1&&r.column-1<a.end?(d=a.start+1,c=a.end+1):l&&l.wordType===1&&l.start<r.column-1&&r.column-1<l.end?(d=l.start+1,c=l.end+1):(d=r.column,c=r.column);let u=r.lineNumber,h;if(n.selectionStart.containsPosition(r))h=n.selectionStart.endColumn;else if(r.isBeforeOrEqual(n.selectionStart.getStartPosition())){h=d;let m=new P(u,h);n.selectionStart.containsPosition(m)&&(h=n.selectionStart.endColumn)}else{h=c;let m=new P(u,h);n.selectionStart.containsPosition(m)&&(h=n.selectionStart.startColumn)}return n.move(!0,u,h,0)}};var An=class{static addCursorDown(e,t,n){let i=[],r=0;for(let s=0,a=t.length;s<a;s++){let l=t[s];i[r++]=new Ue(l.modelState,l.viewState),n?i[r++]=Ue.fromModelState(Kt.translateDown(e.cursorConfig,e.model,l.modelState)):i[r++]=Ue.fromViewState(Kt.translateDown(e.cursorConfig,e,l.viewState))}return i}static addCursorUp(e,t,n){let i=[],r=0;for(let s=0,a=t.length;s<a;s++){let l=t[s];i[r++]=new Ue(l.modelState,l.viewState),n?i[r++]=Ue.fromModelState(Kt.translateUp(e.cursorConfig,e.model,l.modelState)):i[r++]=Ue.fromViewState(Kt.translateUp(e.cursorConfig,e,l.viewState))}return i}static moveToBeginningOfLine(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r];i[r]=this._moveToLineStart(e,a,n)}return i}static _moveToLineStart(e,t,n){let i=t.viewState.position.column,r=t.modelState.position.column,s=i===r,a=t.viewState.position.lineNumber,l=e.getLineFirstNonWhitespaceColumn(a);return!s&&!(i===l)?this._moveToLineStartByView(e,t,n):this._moveToLineStartByModel(e,t,n)}static _moveToLineStartByView(e,t,n){return Ue.fromViewState(Kt.moveToBeginningOfLine(e.cursorConfig,e,t.viewState,n))}static _moveToLineStartByModel(e,t,n){return Ue.fromModelState(Kt.moveToBeginningOfLine(e.cursorConfig,e.model,t.modelState,n))}static moveToEndOfLine(e,t,n,i){let r=[];for(let s=0,a=t.length;s<a;s++){let l=t[s];r[s]=this._moveToLineEnd(e,l,n,i)}return r}static _moveToLineEnd(e,t,n,i){let r=t.viewState.position,s=e.getLineMaxColumn(r.lineNumber),a=r.column===s,l=t.modelState.position,d=e.model.getLineMaxColumn(l.lineNumber),c=s-r.column===d-l.column;return a||c?this._moveToLineEndByModel(e,t,n,i):this._moveToLineEndByView(e,t,n,i)}static _moveToLineEndByView(e,t,n,i){return Ue.fromViewState(Kt.moveToEndOfLine(e.cursorConfig,e,t.viewState,n,i))}static _moveToLineEndByModel(e,t,n,i){return Ue.fromModelState(Kt.moveToEndOfLine(e.cursorConfig,e.model,t.modelState,n,i))}static expandLineSelection(e,t){let n=[];for(let i=0,r=t.length;i<r;i++){let s=t[i],a=s.modelState.selection.startLineNumber,l=e.model.getLineCount(),d=s.modelState.selection.endLineNumber,c;d===l?c=e.model.getLineMaxColumn(l):(d++,c=1),n[i]=Ue.fromModelState(new cn(new D(a,1,a,1),0,0,new P(d,c),0))}return n}static moveToBeginningOfBuffer(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r];i[r]=Ue.fromModelState(Kt.moveToBeginningOfBuffer(e.cursorConfig,e.model,a.modelState,n))}return i}static moveToEndOfBuffer(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r];i[r]=Ue.fromModelState(Kt.moveToEndOfBuffer(e.cursorConfig,e.model,a.modelState,n))}return i}static selectAll(e,t){let n=e.model.getLineCount(),i=e.model.getLineMaxColumn(n);return Ue.fromModelState(new cn(new D(1,1,1,1),0,0,new P(n,i),0))}static line(e,t,n,i,r){let s=e.model.validatePosition(i),a=r?e.coordinatesConverter.validateViewPosition(new P(r.lineNumber,r.column),s):e.coordinatesConverter.convertModelPositionToViewPosition(s);if(!n){let d=e.model.getLineCount(),c=s.lineNumber+1,u=1;return c>d&&(c=d,u=e.model.getLineMaxColumn(c)),Ue.fromModelState(new cn(new D(s.lineNumber,1,c,u),2,0,new P(c,u),0))}let l=t.modelState.selectionStart.getStartPosition().lineNumber;if(s.lineNumber<l)return Ue.fromViewState(t.viewState.move(!0,a.lineNumber,1,0));if(s.lineNumber>l){let d=e.getLineCount(),c=a.lineNumber+1,u=1;return c>d&&(c=d,u=e.getLineMaxColumn(c)),Ue.fromViewState(t.viewState.move(!0,c,u,0))}else{let d=t.modelState.selectionStart.getEndPosition();return Ue.fromModelState(t.modelState.move(!0,d.lineNumber,d.column,0))}}static word(e,t,n,i){let r=e.model.validatePosition(i);return Ue.fromModelState(Lh.word(e.cursorConfig,e.model,t.modelState,n,r))}static cancelSelection(e,t){if(!t.modelState.hasSelection())return new Ue(t.modelState,t.viewState);let n=t.viewState.position.lineNumber,i=t.viewState.position.column;return Ue.fromViewState(new cn(new D(n,i,n,i),0,0,new P(n,i),0))}static moveTo(e,t,n,i,r){if(n){if(t.modelState.selectionStartKind===1)return this.word(e,t,n,i);if(t.modelState.selectionStartKind===2)return this.line(e,t,n,i,r)}let s=e.model.validatePosition(i),a=r?e.coordinatesConverter.validateViewPosition(new P(r.lineNumber,r.column),s):e.coordinatesConverter.convertModelPositionToViewPosition(s);return Ue.fromViewState(t.viewState.move(n,a.lineNumber,a.column,0))}static simpleMove(e,t,n,i,r,s){switch(n){case Ne.Direction.Left:return s===Ne.Unit.HalfLine?this._moveHalfLineLeft(e,t,i):this._moveLeft(e,t,i,r);case Ne.Direction.Right:return s===Ne.Unit.HalfLine?this._moveHalfLineRight(e,t,i):this._moveRight(e,t,i,r);case Ne.Direction.Up:return s===Ne.Unit.WrappedLine?this._moveUpByViewLines(e,t,i,r):this._moveUpByModelLines(e,t,i,r);case Ne.Direction.Down:return s===Ne.Unit.WrappedLine?this._moveDownByViewLines(e,t,i,r):this._moveDownByModelLines(e,t,i,r);case Ne.Direction.PrevBlankLine:return s===Ne.Unit.WrappedLine?t.map(a=>Ue.fromViewState(Kt.moveToPrevBlankLine(e.cursorConfig,e,a.viewState,i))):t.map(a=>Ue.fromModelState(Kt.moveToPrevBlankLine(e.cursorConfig,e.model,a.modelState,i)));case Ne.Direction.NextBlankLine:return s===Ne.Unit.WrappedLine?t.map(a=>Ue.fromViewState(Kt.moveToNextBlankLine(e.cursorConfig,e,a.viewState,i))):t.map(a=>Ue.fromModelState(Kt.moveToNextBlankLine(e.cursorConfig,e.model,a.modelState,i)));case Ne.Direction.WrappedLineStart:return this._moveToViewMinColumn(e,t,i);case Ne.Direction.WrappedLineFirstNonWhitespaceCharacter:return this._moveToViewFirstNonWhitespaceColumn(e,t,i);case Ne.Direction.WrappedLineColumnCenter:return this._moveToViewCenterColumn(e,t,i);case Ne.Direction.WrappedLineEnd:return this._moveToViewMaxColumn(e,t,i);case Ne.Direction.WrappedLineLastNonWhitespaceCharacter:return this._moveToViewLastNonWhitespaceColumn(e,t,i);default:return null}}static viewportMove(e,t,n,i,r){let s=e.getCompletelyVisibleViewRange(),a=e.coordinatesConverter.convertViewRangeToModelRange(s);switch(n){case Ne.Direction.ViewPortTop:{let l=this._firstLineNumberInRange(e.model,a,r),d=e.model.getLineFirstNonWhitespaceColumn(l);return[this._moveToModelPosition(e,t[0],i,l,d)]}case Ne.Direction.ViewPortBottom:{let l=this._lastLineNumberInRange(e.model,a,r),d=e.model.getLineFirstNonWhitespaceColumn(l);return[this._moveToModelPosition(e,t[0],i,l,d)]}case Ne.Direction.ViewPortCenter:{let l=Math.round((a.startLineNumber+a.endLineNumber)/2),d=e.model.getLineFirstNonWhitespaceColumn(l);return[this._moveToModelPosition(e,t[0],i,l,d)]}case Ne.Direction.ViewPortIfOutside:{let l=[];for(let d=0,c=t.length;d<c;d++){let u=t[d];l[d]=this.findPositionInViewportIfOutside(e,u,s,i)}return l}default:return null}}static findPositionInViewportIfOutside(e,t,n,i){let r=t.viewState.position.lineNumber;if(n.startLineNumber<=r&&r<=n.endLineNumber-1)return new Ue(t.modelState,t.viewState);{let s;r>n.endLineNumber-1?s=n.endLineNumber-1:r<n.startLineNumber?s=n.startLineNumber:s=r;let a=Kt.vertical(e.cursorConfig,e,r,t.viewState.position.column,t.viewState.leftoverVisibleColumns,s,!1);return Ue.fromViewState(t.viewState.move(i,a.lineNumber,a.column,a.leftoverVisibleColumns))}}static _firstLineNumberInRange(e,t,n){let i=t.startLineNumber;return t.startColumn!==e.getLineMinColumn(i)&&i++,Math.min(t.endLineNumber,i+n-1)}static _lastLineNumberInRange(e,t,n){let i=t.startLineNumber;return t.startColumn!==e.getLineMinColumn(i)&&i++,Math.max(i,t.endLineNumber-n+1)}static _moveLeft(e,t,n,i){return t.map(r=>Ue.fromViewState(Kt.moveLeft(e.cursorConfig,e,r.viewState,n,i)))}static _moveHalfLineLeft(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r],l=a.viewState.position.lineNumber,d=Math.round(e.getLineLength(l)/2);i[r]=Ue.fromViewState(Kt.moveLeft(e.cursorConfig,e,a.viewState,n,d))}return i}static _moveRight(e,t,n,i){return t.map(r=>Ue.fromViewState(Kt.moveRight(e.cursorConfig,e,r.viewState,n,i)))}static _moveHalfLineRight(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r],l=a.viewState.position.lineNumber,d=Math.round(e.getLineLength(l)/2);i[r]=Ue.fromViewState(Kt.moveRight(e.cursorConfig,e,a.viewState,n,d))}return i}static _moveDownByViewLines(e,t,n,i){let r=[];for(let s=0,a=t.length;s<a;s++){let l=t[s];r[s]=Ue.fromViewState(Kt.moveDown(e.cursorConfig,e,l.viewState,n,i))}return r}static _moveDownByModelLines(e,t,n,i){let r=[];for(let s=0,a=t.length;s<a;s++){let l=t[s];r[s]=Ue.fromModelState(Kt.moveDown(e.cursorConfig,e.model,l.modelState,n,i))}return r}static _moveUpByViewLines(e,t,n,i){let r=[];for(let s=0,a=t.length;s<a;s++){let l=t[s];r[s]=Ue.fromViewState(Kt.moveUp(e.cursorConfig,e,l.viewState,n,i))}return r}static _moveUpByModelLines(e,t,n,i){let r=[];for(let s=0,a=t.length;s<a;s++){let l=t[s];r[s]=Ue.fromModelState(Kt.moveUp(e.cursorConfig,e.model,l.modelState,n,i))}return r}static _moveToViewPosition(e,t,n,i,r){return Ue.fromViewState(t.viewState.move(n,i,r,0))}static _moveToModelPosition(e,t,n,i,r){return Ue.fromModelState(t.modelState.move(n,i,r,0))}static _moveToViewMinColumn(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r],l=a.viewState.position.lineNumber,d=e.getLineMinColumn(l);i[r]=this._moveToViewPosition(e,a,n,l,d)}return i}static _moveToViewFirstNonWhitespaceColumn(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r],l=a.viewState.position.lineNumber,d=e.getLineFirstNonWhitespaceColumn(l);i[r]=this._moveToViewPosition(e,a,n,l,d)}return i}static _moveToViewCenterColumn(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r],l=a.viewState.position.lineNumber,d=Math.round((e.getLineMaxColumn(l)+e.getLineMinColumn(l))/2);i[r]=this._moveToViewPosition(e,a,n,l,d)}return i}static _moveToViewMaxColumn(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r],l=a.viewState.position.lineNumber,d=e.getLineMaxColumn(l);i[r]=this._moveToViewPosition(e,a,n,l,d)}return i}static _moveToViewLastNonWhitespaceColumn(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r],l=a.viewState.position.lineNumber,d=e.getLineLastNonWhitespaceColumn(l);i[r]=this._moveToViewPosition(e,a,n,l,d)}return i}},Ne;(a=>{let o=function(l){if(!mn(l))return!1;let d=l;return!(!an(d.to)||!qn(d.select)&&!lb(d.select)||!qn(d.by)&&!an(d.by)||!qn(d.value)&&!yi(d.value))};a.metadata={description:"Move cursor to a logical position in the view",args:[{name:"Cursor move argument object",description:`Property-value pairs that can be passed through this argument:
					* 'to': A mandatory logical position value providing where to move the cursor.
						\`\`\`
						'left', 'right', 'up', 'down', 'prevBlankLine', 'nextBlankLine',
						'wrappedLineStart', 'wrappedLineEnd', 'wrappedLineColumnCenter'
						'wrappedLineFirstNonWhitespaceCharacter', 'wrappedLineLastNonWhitespaceCharacter'
						'viewPortTop', 'viewPortCenter', 'viewPortBottom', 'viewPortIfOutside'
						\`\`\`
					* 'by': Unit to move. Default is computed based on 'to' value.
						\`\`\`
						'line', 'wrappedLine', 'character', 'halfLine'
						\`\`\`
					* 'value': Number of units to move. Default is '1'.
					* 'select': If 'true' makes the selection. Default is 'false'.
				`,constraint:o,schema:{type:"object",required:["to"],properties:{to:{type:"string",enum:["left","right","up","down","prevBlankLine","nextBlankLine","wrappedLineStart","wrappedLineEnd","wrappedLineColumnCenter","wrappedLineFirstNonWhitespaceCharacter","wrappedLineLastNonWhitespaceCharacter","viewPortTop","viewPortCenter","viewPortBottom","viewPortIfOutside"]},by:{type:"string",enum:["line","wrappedLine","character","halfLine"]},value:{type:"number",default:1},select:{type:"boolean",default:!1}}}}]},a.RawDirection={Left:"left",Right:"right",Up:"up",Down:"down",PrevBlankLine:"prevBlankLine",NextBlankLine:"nextBlankLine",WrappedLineStart:"wrappedLineStart",WrappedLineFirstNonWhitespaceCharacter:"wrappedLineFirstNonWhitespaceCharacter",WrappedLineColumnCenter:"wrappedLineColumnCenter",WrappedLineEnd:"wrappedLineEnd",WrappedLineLastNonWhitespaceCharacter:"wrappedLineLastNonWhitespaceCharacter",ViewPortTop:"viewPortTop",ViewPortCenter:"viewPortCenter",ViewPortBottom:"viewPortBottom",ViewPortIfOutside:"viewPortIfOutside"},a.RawUnit={Line:"line",WrappedLine:"wrappedLine",Character:"character",HalfLine:"halfLine"};function i(l){if(!l.to)return null;let d;switch(l.to){case a.RawDirection.Left:d=0;break;case a.RawDirection.Right:d=1;break;case a.RawDirection.Up:d=2;break;case a.RawDirection.Down:d=3;break;case a.RawDirection.PrevBlankLine:d=4;break;case a.RawDirection.NextBlankLine:d=5;break;case a.RawDirection.WrappedLineStart:d=6;break;case a.RawDirection.WrappedLineFirstNonWhitespaceCharacter:d=7;break;case a.RawDirection.WrappedLineColumnCenter:d=8;break;case a.RawDirection.WrappedLineEnd:d=9;break;case a.RawDirection.WrappedLineLastNonWhitespaceCharacter:d=10;break;case a.RawDirection.ViewPortTop:d=11;break;case a.RawDirection.ViewPortBottom:d=13;break;case a.RawDirection.ViewPortCenter:d=12;break;case a.RawDirection.ViewPortIfOutside:d=14;break;default:return null}let c=0;switch(l.by){case a.RawUnit.Line:c=1;break;case a.RawUnit.WrappedLine:c=2;break;case a.RawUnit.Character:c=3;break;case a.RawUnit.HalfLine:c=4;break}return{direction:d,unit:c,select:!!l.select,value:l.value||1}}a.parse=i;let r;(W=>(W[W.Left=0]="Left",W[W.Right=1]="Right",W[W.Up=2]="Up",W[W.Down=3]="Down",W[W.PrevBlankLine=4]="PrevBlankLine",W[W.NextBlankLine=5]="NextBlankLine",W[W.WrappedLineStart=6]="WrappedLineStart",W[W.WrappedLineFirstNonWhitespaceCharacter=7]="WrappedLineFirstNonWhitespaceCharacter",W[W.WrappedLineColumnCenter=8]="WrappedLineColumnCenter",W[W.WrappedLineEnd=9]="WrappedLineEnd",W[W.WrappedLineLastNonWhitespaceCharacter=10]="WrappedLineLastNonWhitespaceCharacter",W[W.ViewPortTop=11]="ViewPortTop",W[W.ViewPortCenter=12]="ViewPortCenter",W[W.ViewPortBottom=13]="ViewPortBottom",W[W.ViewPortIfOutside=14]="ViewPortIfOutside"))(r=a.Direction||={});let s;(m=>(m[m.None=0]="None",m[m.Line=1]="Line",m[m.WrappedLine=2]="WrappedLine",m[m.Character=3]="Character",m[m.HalfLine=4]="HalfLine"))(s=a.Unit||={})})(Ne||={});function D5(o,e,t){let n=o.tokenization.getLanguageIdAtPosition(e,0);if(e>1){let i,r=-1;for(i=e-1;i>=1;i--){if(o.tokenization.getLanguageIdAtPosition(i,0)!==n)return r;let s=o.getLineContent(i);if(t.shouldIgnore(i)||/^\s+$/.test(s)||s===""){r=i;continue}return i}}return-1}function Rg(o,e,t,n=!0,i){if(o<4)return null;let r=i.getLanguageConfiguration(e.tokenization.getLanguageId()).indentRulesSupport;if(!r)return null;let s=new KI(e,r,i);if(t<=1)return{indentation:"",action:null};for(let l=t-1;l>0&&e.getLineContent(l)==="";l--)if(l===1)return{indentation:"",action:null};let a=D5(e,t,s);if(a<0)return null;if(a<1)return{indentation:"",action:null};if(s.shouldIncrease(a)||s.shouldIndentNextLine(a)){let l=e.getLineContent(a);return{indentation:_n(l),action:1,line:a}}else if(s.shouldDecrease(a)){let l=e.getLineContent(a);return{indentation:_n(l),action:null,line:a}}else{if(a===1)return{indentation:_n(e.getLineContent(a)),action:null,line:a};let l=a-1,d=r.getIndentMetadata(e.getLineContent(l));if(!(d&3)&&d&4){let c=0;for(let u=l-1;u>0;u--)if(!s.shouldIndentNextLine(u)){c=u;break}return{indentation:_n(e.getLineContent(c+1)),action:null,line:c+1}}if(n)return{indentation:_n(e.getLineContent(a)),action:null,line:a};for(let c=a;c>0;c--){if(s.shouldIncrease(c))return{indentation:_n(e.getLineContent(c)),action:1,line:c};if(s.shouldIndentNextLine(c)){let u=0;for(let h=c-1;h>0;h--)if(!s.shouldIndentNextLine(c)){u=h;break}return{indentation:_n(e.getLineContent(u+1)),action:null,line:u+1}}else if(s.shouldDecrease(c))return{indentation:_n(e.getLineContent(c)),action:null,line:c}}return{indentation:_n(e.getLineContent(1)),action:null,line:1}}}function RP(o,e,t,n,i){if(o<4)return null;let r=e.getLanguageIdAtPosition(t.startLineNumber,t.startColumn),s=i.getLanguageConfiguration(r).indentRulesSupport;if(!s)return null;e.tokenization.forceTokenization(t.startLineNumber);let l=new dc(e,i).getProcessedTokenContextAroundRange(t),d=l.afterRangeProcessedTokens,c=l.beforeRangeProcessedTokens,u=_n(c.getLineContent()),h=k5(e,t.startLineNumber,c),m=GI(e,t.getStartPosition()),f=e.getLineContent(t.startLineNumber),g=_n(f),b=Rg(o,h,t.startLineNumber+1,void 0,i);if(!b){let C=m?g:u;return{beforeEnter:C,afterEnter:C}}let y=m?g:b.indentation;return b.action===1&&(y=n.shiftIndent(y)),s.shouldDecrease(d.getLineContent())&&(y=n.unshiftIndent(y)),{beforeEnter:m?g:u,afterEnter:y}}function MP(o,e,t,n,i,r){let s=o.autoIndent;if(s<4||GI(e,t.getStartPosition()))return null;let l=e.getLanguageIdAtPosition(t.startLineNumber,t.startColumn),d=r.getLanguageConfiguration(l).indentRulesSupport;if(!d)return null;let u=new dc(e,r).getProcessedTokenContextAroundRange(t),h=u.beforeRangeProcessedTokens.getLineContent(),m=u.afterRangeProcessedTokens.getLineContent(),f=h+m,g=h+n+m;if(!d.shouldDecrease(f)&&d.shouldDecrease(g)){let y=Rg(s,e,t.startLineNumber,!1,r);if(!y)return null;let C=y.indentation;return y.action!==1&&(C=i.unshiftIndent(C)),C}let b=t.startLineNumber-1;if(b>0){let y=e.getLineContent(b);if(d.shouldIndentNextLine(y)&&d.shouldIncrease(g)){let x=Rg(s,e,t.startLineNumber,!1,r)?.indentation;if(x!==void 0){let L=e.getLineContent(t.startLineNumber),k=_n(L),W=i.shiftIndent(x)===k,z=/^\s*$/.test(f),B=o.autoClosingPairs.autoClosingPairsOpenByEnd.get(n),q=B&&B.length>0&&z;if(W&&q)return x}}}return null}function k5(o,e,t){return{tokenization:{getLineTokens:i=>i===e?t:o.tokenization.getLineTokens(i),getLanguageId:()=>o.getLanguageId(),getLanguageIdAtPosition:(i,r)=>o.getLanguageIdAtPosition(i,r)},getLineContent:i=>i===e?t.getLineContent():o.getLineContent(i)}}var KI=class{_indentRulesSupport;_indentationLineProcessor;constructor(e,t,n){this._indentRulesSupport=t,this._indentationLineProcessor=new jI(e,n)}shouldIncrease(e,t){let n=this._indentationLineProcessor.getProcessedLine(e,t);return this._indentRulesSupport.shouldIncrease(n)}shouldDecrease(e,t){let n=this._indentationLineProcessor.getProcessedLine(e,t);return this._indentRulesSupport.shouldDecrease(n)}shouldIgnore(e,t){let n=this._indentationLineProcessor.getProcessedLine(e,t);return this._indentRulesSupport.shouldIgnore(n)}shouldIndentNextLine(e,t){let n=this._indentationLineProcessor.getProcessedLine(e,t);return this._indentRulesSupport.shouldIndentNextLine(n)}},dc=class{model;indentationLineProcessor;constructor(e,t){this.model=e,this.indentationLineProcessor=new jI(e,t)}getProcessedTokenContextAroundRange(e){let t=this._getProcessedTokensBeforeRange(e),n=this._getProcessedTokensAfterRange(e),i=this._getProcessedPreviousLineTokens(e);return{beforeRangeProcessedTokens:t,afterRangeProcessedTokens:n,previousLineProcessedTokens:i}}_getProcessedTokensBeforeRange(e){this.model.tokenization.forceTokenization(e.startLineNumber);let t=this.model.tokenization.getLineTokens(e.startLineNumber),n=xs(t,e.startColumn-1),i;if(GI(this.model,e.getStartPosition())){let s=e.startColumn-1-n.firstCharOffset,a=n.firstCharOffset,l=a+s;i=t.sliceAndInflate(a,l,0)}else{let s=e.startColumn-1;i=t.sliceAndInflate(0,s,0)}return this.indentationLineProcessor.getProcessedTokens(i)}_getProcessedTokensAfterRange(e){let t=e.isEmpty()?e.getStartPosition():e.getEndPosition();this.model.tokenization.forceTokenization(t.lineNumber);let n=this.model.tokenization.getLineTokens(t.lineNumber),i=xs(n,t.column-1),r=t.column-1-i.firstCharOffset,s=i.firstCharOffset+r,a=i.firstCharOffset+i.getLineLength(),l=n.sliceAndInflate(s,a,0);return this.indentationLineProcessor.getProcessedTokens(l)}_getProcessedPreviousLineTokens(e){let t=m=>{this.model.tokenization.forceTokenization(m);let f=this.model.tokenization.getLineTokens(m),g=this.model.getLineMaxColumn(m)-1;return xs(f,g)};this.model.tokenization.forceTokenization(e.startLineNumber);let n=this.model.tokenization.getLineTokens(e.startLineNumber),i=xs(n,e.startColumn-1),r=dn.createEmpty("",i.languageIdCodec),s=e.startLineNumber-1;if(s===0||!(i.firstCharOffset===0))return r;let d=t(s);if(!(i.languageId===d.languageId))return r;let u=d.toIViewLineTokens();return this.indentationLineProcessor.getProcessedTokens(u)}},jI=class{constructor(e,t){this.model=e;this.languageConfigurationService=t}getProcessedLine(e,t){let n=(s,a)=>{let l=_n(s);return a+s.substring(l.length)};this.model.tokenization.forceTokenization?.(e);let i=this.model.tokenization.getLineTokens(e),r=this.getProcessedTokens(i).getLineContent();return t!==void 0&&(r=n(r,t)),r}getProcessedTokens(e){let t=l=>l===2||l===3||l===1,n=e.getLanguageId(0),r=this.languageConfigurationService.getLanguageConfiguration(n).bracketsNew.getBracketRegExp({global:!0}),s=[];return e.forEach(l=>{let d=e.getStandardTokenType(l),c=e.getTokenText(l);t(d)&&(c=c.replace(r,""));let u=e.getMetadata(l);s.push({text:c,metadata:u})}),dn.createFromTextAndMetadata(s,e.languageIdCodec)}};function GI(o,e){o.tokenization.forceTokenization(e.lineNumber);let t=o.tokenization.getLineTokens(e.lineNumber),n=xs(t,e.column-1),i=n.firstCharOffset===0,r=t.getLanguageId(0)===n.languageId;return!i&&!r}function Mg(o,e,t,n){e.tokenization.forceTokenization(t.startLineNumber);let i=e.getLanguageIdAtPosition(t.startLineNumber,t.startColumn),r=n.getLanguageConfiguration(i);if(!r)return null;let a=new dc(e,n).getProcessedTokenContextAroundRange(t),l=a.previousLineProcessedTokens.getLineContent(),d=a.beforeRangeProcessedTokens.getLineContent(),c=a.afterRangeProcessedTokens.getLineContent(),u=r.onEnter(o,l,d,c);if(!u)return null;let h=u.indentAction,m=u.appendText,f=u.removeText||0;m?h===1&&(m="	"+m):h===1||h===2?m="	":m="";let g=Nv(e,t.startLineNumber,t.startColumn);return f&&(g=g.substring(0,g.length-f)),{indentAction:h,appendText:m,removeText:f,indentation:g}}var oD=Object.create(null);function cc(o,e){if(e<=0)return"";oD[o]||(oD[o]=["",o]);let t=oD[o];for(let n=t.length;n<=e;n++)t[n]=t[n-1]+o;return t[e]}var Do=class{constructor(e,t,n){this._languageConfigurationService=n;this._opts=t,this._selection=e,this._selectionId=null,this._useLastEditRangeForCursorEndPosition=!1,this._selectionStartColumnStaysPut=!1}static unshiftIndent(e,t,n,i,r){let s=_t.visibleColumnFromColumn(e,t,n);if(r){let a=cc(" ",i),d=_t.prevIndentTabStop(s,i)/i;return cc(a,d)}else{let a="	",d=_t.prevRenderTabStop(s,n)/n;return cc(a,d)}}static shiftIndent(e,t,n,i,r){let s=_t.visibleColumnFromColumn(e,t,n);if(r){let a=cc(" ",i),d=_t.nextIndentTabStop(s,i)/i;return cc(a,d)}else{let a="	",d=_t.nextRenderTabStop(s,n)/n;return cc(a,d)}}_opts;_selection;_selectionId;_useLastEditRangeForCursorEndPosition;_selectionStartColumnStaysPut;_addEditOperation(e,t,n){this._useLastEditRangeForCursorEndPosition?e.addTrackedEditOperation(t,n):e.addEditOperation(t,n)}getEditOperations(e,t){let n=this._selection.startLineNumber,i=this._selection.endLineNumber;this._selection.endColumn===1&&n!==i&&(i=i-1);let{tabSize:r,indentSize:s,insertSpaces:a}=this._opts,l=n===i;if(this._opts.useTabStops){this._selection.isEmpty()&&/^\s*$/.test(e.getLineContent(n))&&(this._useLastEditRangeForCursorEndPosition=!0);let d=0,c=0;for(let u=n;u<=i;u++,d=c){c=0;let h=e.getLineContent(u),m=Xt(h);if(this._opts.isUnshift&&(h.length===0||m===0)||!l&&!this._opts.isUnshift&&h.length===0)continue;if(m===-1&&(m=h.length),u>1&&_t.visibleColumnFromColumn(h,m+1,r)%s!==0&&e.tokenization.isCheapToTokenize(u-1)){let b=Mg(this._opts.autoIndent,e,new D(u-1,e.getLineMaxColumn(u-1),u-1,e.getLineMaxColumn(u-1)),this._languageConfigurationService);if(b){if(c=d,b.appendText)for(let y=0,C=b.appendText.length;y<C&&c<s&&b.appendText.charCodeAt(y)===32;y++)c++;b.removeText&&(c=Math.max(0,c-b.removeText));for(let y=0;y<c&&!(m===0||h.charCodeAt(m-1)!==32);y++)m--}}if(this._opts.isUnshift&&m===0)continue;let f;this._opts.isUnshift?f=Do.unshiftIndent(h,m+1,r,s,a):f=Do.shiftIndent(h,m+1,r,s,a),this._addEditOperation(t,new D(u,1,u,m+1),f),u===n&&!this._selection.isEmpty()&&(this._selectionStartColumnStaysPut=this._selection.startColumn<=m+1)}}else{!this._opts.isUnshift&&this._selection.isEmpty()&&e.getLineLength(n)===0&&(this._useLastEditRangeForCursorEndPosition=!0);let d=a?cc(" ",s):"	";for(let c=n;c<=i;c++){let u=e.getLineContent(c),h=Xt(u);if(!(this._opts.isUnshift&&(u.length===0||h===0))&&!(!l&&!this._opts.isUnshift&&u.length===0)&&(h===-1&&(h=u.length),!(this._opts.isUnshift&&h===0)))if(this._opts.isUnshift){h=Math.min(h,s);for(let m=0;m<h;m++)if(u.charCodeAt(m)===9){h=m+1;break}this._addEditOperation(t,new D(c,1,c,h+1),"")}else this._addEditOperation(t,new D(c,1,c,1),d),c===n&&!this._selection.isEmpty()&&(this._selectionStartColumnStaysPut=this._selection.startColumn===1)}}this._selectionId=t.trackSelection(this._selection)}computeCursorState(e,t){if(this._useLastEditRangeForCursorEndPosition){let i=t.getInverseEditOperations()[0];return new He(i.range.endLineNumber,i.range.endColumn,i.range.endLineNumber,i.range.endColumn)}let n=t.getTrackedSelection(this._selectionId);if(this._selectionStartColumnStaysPut){let i=this._selection.startColumn;return n.startColumn<=i?n:n.getDirection()===0?new He(n.startLineNumber,i,n.endLineNumber,n.endColumn):new He(n.endLineNumber,n.endColumn,n.startLineNumber,i)}return n}};Do=R([S(2,ca)],Do);var $I=class{_range;_charBeforeSelection;_charAfterSelection;constructor(e,t,n){this._range=e,this._charBeforeSelection=t,this._charAfterSelection=n}getEditOperations(e,t){t.addTrackedEditOperation(new D(this._range.startLineNumber,this._range.startColumn,this._range.startLineNumber,this._range.startColumn),this._charBeforeSelection),t.addTrackedEditOperation(new D(this._range.endLineNumber,this._range.endColumn,this._range.endLineNumber,this._range.endColumn),this._charAfterSelection)}computeCursorState(e,t){let n=t.getInverseEditOperations(),i=n[0].range,r=n[1].range;return new He(i.endLineNumber,i.endColumn,r.endLineNumber,r.endColumn-this._charAfterSelection.length)}},qI=class{constructor(e,t,n){this._position=e;this._text=t;this._charAfter=n}getEditOperations(e,t){t.addTrackedEditOperation(new D(this._position.lineNumber,this._position.column,this._position.lineNumber,this._position.column),this._text+this._charAfter)}computeCursorState(e,t){let i=t.getInverseEditOperations()[0].range;return new He(i.endLineNumber,i.startColumn,i.endLineNumber,i.endColumn-this._charAfter.length)}};var YI=class{static getEdits(e,t,n,i,r){if(!r&&this._isAutoIndentType(e,t,n)){let s=[];for(let l of n){let d=this._findActualIndentationForSelection(e,t,l,i);if(d===null)return;s.push({selection:l,indentation:d})}let a=Dh.getAutoClosingPairClose(e,t,n,i,!1);return this._getIndentationAndAutoClosingPairEdits(e,t,s,i,a)}}static _isAutoIndentType(e,t,n){if(e.autoIndent<4)return!1;for(let i=0,r=n.length;i<r;i++)if(!t.tokenization.isCheapToTokenize(n[i].getEndPosition().lineNumber))return!1;return!0}static _findActualIndentationForSelection(e,t,n,i){let r=MP(e,t,n,i,{shiftIndent:a=>Ag(e,a),unshiftIndent:a=>Mh(e,a)},e.languageConfigurationService);if(r===null)return null;let s=Nv(t,n.startLineNumber,n.startColumn);return r===e.normalizeIndentation(s)?null:r}static _getIndentationAndAutoClosingPairEdits(e,t,n,i,r){let s=n.map(({selection:l,indentation:d})=>{if(r!==null){let c=this._getEditFromIndentationAndSelection(e,t,d,l,i,!1);return new sD(c,l,i,r)}else{let c=this._getEditFromIndentationAndSelection(e,t,d,l,i,!0);return uc(c.range,c.text,!1)}}),a={shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1};return new Sn(4,s,a)}static _getEditFromIndentationAndSelection(e,t,n,i,r,s=!0){let a=i.startLineNumber,l=t.getLineFirstNonWhitespaceColumn(a),d=e.normalizeIndentation(n);if(l!==0){let u=t.getLineContent(a);d+=u.substring(l-1,i.startColumn-1)}return d+=s?r:"",{range:new D(a,1,i.endLineNumber,i.endColumn),text:d}}},ZI=class{static getEdits(e,t,n,i,r,s){if(NP(t,n,i,r,s))return this._runAutoClosingOvertype(e,i,s)}static _runAutoClosingOvertype(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let l=t[r].getPosition(),d=new D(l.lineNumber,l.column,l.lineNumber,l.column+1);i[r]=new ii(d,n)}return new Sn(4,i,{shouldPushStackElementBefore:rC(e,4),shouldPushStackElementAfter:!1})}},XI=class{static getEdits(e,t,n,i,r){if(NP(e,t,n,i,r)){let s=n.map(a=>new ii(new D(a.positionLineNumber,a.positionColumn,a.positionLineNumber,a.positionColumn+1),"",!1));return new Sn(4,s,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}}},Dh=class{static getEdits(e,t,n,i,r,s){if(!s){let a=this.getAutoClosingPairClose(e,t,n,i,r);if(a!==null)return this._runAutoClosingOpenCharType(n,i,r,a)}}static _runAutoClosingOpenCharType(e,t,n,i){let r=[];for(let s=0,a=e.length;s<a;s++){let l=e[s];r[s]=new rD(l,t,!n,i)}return new Sn(4,r,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}static getAutoClosingPairClose(e,t,n,i,r){for(let f of n)if(!f.isEmpty())return null;let s=n.map(f=>{let g=f.getPosition();return r?{lineNumber:g.lineNumber,beforeColumn:g.column-i.length,afterColumn:g.column}:{lineNumber:g.lineNumber,beforeColumn:g.column,afterColumn:g.column}}),a=this._findAutoClosingPairOpen(e,t,s.map(f=>new P(f.lineNumber,f.beforeColumn)),i);if(!a)return null;let l,d;if(Nr(i)?(l=e.autoClosingQuotes,d=e.shouldAutoCloseBefore.quote):(e.blockCommentStartToken?a.open.includes(e.blockCommentStartToken):!1)?(l=e.autoClosingComments,d=e.shouldAutoCloseBefore.comment):(l=e.autoClosingBrackets,d=e.shouldAutoCloseBefore.bracket),l==="never")return null;let u=this._findContainedAutoClosingPair(e,a),h=u?u.close:"",m=!0;for(let f of s){let{lineNumber:g,beforeColumn:b,afterColumn:y}=f,C=t.getLineContent(g),x=C.substring(0,b-1),L=C.substring(y-1);if(L.startsWith(h)||(m=!1),L.length>0){let z=L.charAt(0);if(!this._isBeforeClosingBrace(e,L)&&!d(z))return null}if(a.open.length===1&&(i==="'"||i==='"')&&l!=="always"){let z=Is(e.wordSeparators,[]);if(x.length>0){let B=x.charCodeAt(x.length-1);if(z.get(B)===0)return null}}if(!t.tokenization.isCheapToTokenize(g))return null;t.tokenization.forceTokenization(g);let k=t.tokenization.getLineTokens(g),O=xs(k,b-1);if(!a.shouldAutoClose(O,b-O.firstCharOffset))return null;let W=a.findNeutralCharacter();if(W){let z=t.tokenization.getTokenTypeIfInsertingCharacter(g,b,W);if(!a.isOK(z))return null}}return m?a.close.substring(0,a.close.length-h.length):a.close}static _findContainedAutoClosingPair(e,t){if(t.open.length<=1)return null;let n=t.close.charAt(t.close.length-1),i=e.autoClosingPairs.autoClosingPairsCloseByEnd.get(n)||[],r=null;for(let s of i)s.open!==t.open&&t.open.includes(s.open)&&t.close.endsWith(s.close)&&(!r||s.open.length>r.open.length)&&(r=s);return r}static _findAutoClosingPairOpen(e,t,n,i){let r=e.autoClosingPairs.autoClosingPairsOpenByEnd.get(i);if(!r)return null;let s=null;for(let a of r)if(s===null||a.open.length>s.open.length){let l=!0;for(let d of n)if(t.getValueInRange(new D(d.lineNumber,d.column-a.open.length+1,d.lineNumber,d.column))+i!==a.open){l=!1;break}l&&(s=a)}return s}static _isBeforeClosingBrace(e,t){let n=t.charAt(0),i=e.autoClosingPairs.autoClosingPairsOpenByStart.get(n)||[],r=e.autoClosingPairs.autoClosingPairsCloseByStart.get(n)||[],s=i.some(l=>t.startsWith(l.open)),a=r.some(l=>t.startsWith(l.close));return!s&&a}},QI=class{static getEdits(e,t,n,i,r){if(!r&&this._isSurroundSelectionType(e,t,n,i))return this._runSurroundSelectionType(e,n,i)}static _runSurroundSelectionType(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r],l=e.surroundingPairs[n];i[r]=new $I(a,n,l)}return new Sn(0,i,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _isSurroundSelectionType(e,t,n,i){if(!lD(e,i)||!e.surroundingPairs.hasOwnProperty(i))return!1;let r=Nr(i);for(let s of n){if(s.isEmpty())return!1;let a=!0;for(let l=s.startLineNumber;l<=s.endLineNumber;l++){let d=t.getLineContent(l),c=l===s.startLineNumber?s.startColumn-1:0,u=l===s.endLineNumber?s.endColumn-1:d.length,h=d.substring(c,u);if(/[^ \t]/.test(h)){a=!1;break}}if(a)return!1;if(r&&s.startLineNumber===s.endLineNumber&&s.startColumn+1===s.endColumn){let l=t.getValueInRange(s);if(Nr(l))return!1}}return!0}},JI=class{static getEdits(e,t,n,i,r,s){if(!s&&this._isTypeInterceptorElectricChar(t,n,i)){let a=this._typeInterceptorElectricChar(e,t,n,i[0],r);if(a)return a}}static _isTypeInterceptorElectricChar(e,t,n){return!!(n.length===1&&t.tokenization.isCheapToTokenize(n[0].getEndPosition().lineNumber))}static _typeInterceptorElectricChar(e,t,n,i,r){if(!t.electricChars.hasOwnProperty(r)||!i.isEmpty())return null;let s=i.getPosition();n.tokenization.forceTokenization(s.lineNumber);let a=n.tokenization.getLineTokens(s.lineNumber),l;try{l=t.onElectricCharacter(r,a,s.column)}catch(d){return je(d),null}if(!l)return null;if(l.matchOpenBracket){let d=(a.getLineContent()+r).lastIndexOf(l.matchOpenBracket)+1,c=n.bracketPairs.findMatchingBracketUp(l.matchOpenBracket,{lineNumber:s.lineNumber,column:d},500);if(c){if(c.startLineNumber===s.lineNumber)return null;let u=n.getLineContent(c.startLineNumber),h=_n(u),m=t.normalizeIndentation(h),f=n.getLineContent(s.lineNumber),g=n.getLineFirstNonWhitespaceColumn(s.lineNumber)||s.column,b=f.substring(g-1,s.column-1),y=m+b+r,C=new D(s.lineNumber,1,s.lineNumber,s.column),x=new ii(C,y);return new Sn(aD(y,e),[x],{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!0})}}return null}},eC=class{static getEdits(e,t,n){let i=[];for(let s=0,a=t.length;s<a;s++)i[s]=new ii(t[s],n);let r=aD(n,e);return new Sn(r,i,{shouldPushStackElementBefore:rC(e,r),shouldPushStackElementAfter:!1})}},kh=class{static getEdits(e,t,n,i,r){if(!r&&i===`
`){let s=[];for(let a=0,l=n.length;a<l;a++)s[a]=this._enter(e,t,!1,n[a]);return new Sn(4,s,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}}static _enter(e,t,n,i){if(e.autoIndent===0)return uc(i,`
`,n);if(!t.tokenization.isCheapToTokenize(i.getStartPosition().lineNumber)||e.autoIndent===1){let l=t.getLineContent(i.startLineNumber),d=_n(l).substring(0,i.startColumn-1);return uc(i,`
`+e.normalizeIndentation(d),n)}let r=Mg(e.autoIndent,t,i,e.languageConfigurationService);if(r){if(r.indentAction===0)return uc(i,`
`+e.normalizeIndentation(r.indentation+r.appendText),n);if(r.indentAction===1)return uc(i,`
`+e.normalizeIndentation(r.indentation+r.appendText),n);if(r.indentAction===2){let l=e.normalizeIndentation(r.indentation),d=e.normalizeIndentation(r.indentation+r.appendText),c=`
`+d+`
`+l;return n?new ac(i,c,!0):new lc(i,c,-1,d.length-l.length,!0)}else if(r.indentAction===3){let l=Mh(e,r.indentation);return uc(i,`
`+e.normalizeIndentation(l+r.appendText),n)}}let s=t.getLineContent(i.startLineNumber),a=_n(s).substring(0,i.startColumn-1);if(e.autoIndent>=4){let l=RP(e.autoIndent,t,i,{unshiftIndent:d=>Mh(e,d),shiftIndent:d=>Ag(e,d),normalizeIndentation:d=>e.normalizeIndentation(d)},e.languageConfigurationService);if(l){let d=e.visibleColumnFromColumn(t,i.getEndPosition()),c=i.endColumn,u=t.getLineContent(i.endLineNumber),h=Xt(u);if(h>=0?i=i.setEndPosition(i.endLineNumber,Math.max(i.endColumn,h+1)):i=i.setEndPosition(i.endLineNumber,t.getLineMaxColumn(i.endLineNumber)),n)return new ac(i,`
`+e.normalizeIndentation(l.afterEnter),!0);{let m=0;return c<=h+1&&(e.insertSpaces||(d=Math.ceil(d/e.indentSize)),m=Math.min(d+1-e.normalizeIndentation(l.afterEnter).length-1,0)),new lc(i,`
`+e.normalizeIndentation(l.afterEnter),0,m,!0)}}}return uc(i,`
`+e.normalizeIndentation(a),n)}static lineInsertBefore(e,t,n){if(t===null||n===null)return[];let i=[];for(let r=0,s=n.length;r<s;r++){let a=n[r].positionLineNumber;if(a===1)i[r]=new ac(new D(1,1,1,1),`
`);else{a--;let l=t.getLineMaxColumn(a);i[r]=this._enter(e,t,!1,new D(a,l,a,l))}}return i}static lineInsertAfter(e,t,n){if(t===null||n===null)return[];let i=[];for(let r=0,s=n.length;r<s;r++){let a=n[r].positionLineNumber,l=t.getLineMaxColumn(a);i[r]=this._enter(e,t,!1,new D(a,l,a,l))}return i}static lineBreakInsert(e,t,n){let i=[];for(let r=0,s=n.length;r<s;r++)i[r]=this._enter(e,t,!0,n[r]);return i}},tC=class{static getEdits(e,t,n,i,r,s){let a=this._distributePasteToCursors(e,n,i,r,s);return a?(n=n.sort(D.compareRangesUsingStarts),this._distributedPaste(e,t,n,a)):this._simplePaste(e,t,n,i,r)}static _distributePasteToCursors(e,t,n,i,r){if(i||t.length===1)return null;if(r&&r.length===t.length)return r;if(e.multiCursorPaste==="spread"){n.charCodeAt(n.length-1)===10&&(n=n.substring(0,n.length-1)),n.charCodeAt(n.length-1)===13&&(n=n.substring(0,n.length-1));let s=Bp(n);if(s.length===t.length)return s}return null}static _distributedPaste(e,t,n,i){let r=[];for(let s=0,a=n.length;s<a;s++)r[s]=new ii(n[s],i[s]);return new Sn(0,r,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _simplePaste(e,t,n,i,r){let s=[];for(let a=0,l=n.length;a<l;a++){let d=n[a],c=d.getPosition();if(r&&!d.isEmpty()&&(r=!1),r&&i.indexOf(`
`)!==i.length-1&&(r=!1),r){let u=new D(c.lineNumber,1,c.lineNumber,1);s[a]=new UI(u,i,d,!0)}else s[a]=new ii(d,i)}return new Sn(0,s,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}},nC=class{static getEdits(e,t,n,i,r,s,a,l){let d=i.map(c=>this._compositionType(n,c,r,s,a,l));return new Sn(4,d,{shouldPushStackElementBefore:rC(e,4),shouldPushStackElementAfter:!1})}static _compositionType(e,t,n,i,r,s){if(!t.isEmpty())return null;let a=t.getPosition(),l=Math.max(1,a.column-i),d=Math.min(e.getLineMaxColumn(a.lineNumber),a.column+r),c=new D(a.lineNumber,l,a.lineNumber,d);return e.getValueInRange(c)===n&&s===0?null:new lc(c,n,0,s)}},iC=class{static getEdits(e,t,n){let i=[];for(let s=0,a=t.length;s<a;s++)i[s]=new ii(t[s],n);let r=aD(n,e);return new Sn(r,i,{shouldPushStackElementBefore:rC(e,r),shouldPushStackElementAfter:!1})}},oC=class{static getCommands(e,t,n){let i=[];for(let r=0,s=n.length;r<s;r++){let a=n[r];if(a.isEmpty()){let l=t.getLineContent(a.startLineNumber);if(/^\s*$/.test(l)&&t.tokenization.isCheapToTokenize(a.startLineNumber)){let d=this._goodIndentForLine(e,t,a.startLineNumber);d=d||"	";let c=e.normalizeIndentation(d);if(!l.startsWith(c)){i[r]=new ii(new D(a.startLineNumber,1,a.startLineNumber,l.length+1),c,!0);continue}}i[r]=this._replaceJumpToNextIndent(e,t,a,!0)}else{if(a.startLineNumber===a.endLineNumber){let l=t.getLineMaxColumn(a.startLineNumber);if(a.startColumn!==1||a.endColumn!==l){i[r]=this._replaceJumpToNextIndent(e,t,a,!1);continue}}i[r]=new Do(a,{isUnshift:!1,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent},e.languageConfigurationService)}}return i}static _goodIndentForLine(e,t,n){let i=null,r="",s=Rg(e.autoIndent,t,n,!1,e.languageConfigurationService);if(s)i=s.action,r=s.indentation;else if(n>1){let a;for(a=n-1;a>=1;a--){let c=t.getLineContent(a);if(Wo(c)>=0)break}if(a<1)return null;let l=t.getLineMaxColumn(a),d=Mg(e.autoIndent,t,new D(a,l,a,l),e.languageConfigurationService);d&&(r=d.indentation+d.appendText)}return i&&(i===1&&(r=Ag(e,r)),i===3&&(r=Mh(e,r)),r=e.normalizeIndentation(r)),r||null}static _replaceJumpToNextIndent(e,t,n,i){let r="",s=n.getStartPosition();if(e.insertSpaces){let a=e.visibleColumnFromColumn(t,s),l=e.indentSize,d=l-a%l;for(let c=0;c<d;c++)r+=" "}else r="	";return new ii(n,r,i)}},Rh=class extends lc{_openCharacter;_closeCharacter;closeCharacterRange;enclosingRange;constructor(e,t,n,i,r,s){super(e,t,n,i),this._openCharacter=r,this._closeCharacter=s,this.closeCharacterRange=null,this.enclosingRange=null}_computeCursorStateWithRange(e,t,n){return this.closeCharacterRange=new D(t.startLineNumber,t.endColumn-this._closeCharacter.length,t.endLineNumber,t.endColumn),this.enclosingRange=new D(t.startLineNumber,t.endColumn-this._openCharacter.length-this._closeCharacter.length,t.endLineNumber,t.endColumn),super.computeCursorState(e,n)}},rD=class extends Rh{constructor(e,t,n,i){let r=(n?t:"")+i,s=0,a=-i.length;super(e,r,s,a,t,i)}computeCursorState(e,t){let i=t.getInverseEditOperations()[0].range;return this._computeCursorStateWithRange(e,i,t)}},sD=class extends Rh{_autoIndentationEdit;_autoClosingEdit;constructor(e,t,n,i){let r=n+i,s=0,a=n.length;super(t,r,s,a,n,i),this._autoIndentationEdit=e,this._autoClosingEdit={range:t,text:r}}getEditOperations(e,t){t.addTrackedEditOperation(this._autoIndentationEdit.range,this._autoIndentationEdit.text),t.addTrackedEditOperation(this._autoClosingEdit.range,this._autoClosingEdit.text)}computeCursorState(e,t){let n=t.getInverseEditOperations();if(n.length!==2)throw new Error("There should be two inverse edit operations!");let i=n[0].range,r=n[1].range,s=i.plusRange(r);return this._computeCursorStateWithRange(e,s,t)}};function aD(o,e){return o===" "?e===5||e===6?6:5:4}function rC(o,e){return OP(o)&&!OP(e)?!0:o===5?!1:AP(o)!==AP(e)}function AP(o){return o===6||o===5?"space":o}function OP(o){return o===4||o===5||o===6}function NP(o,e,t,n,i){if(o.autoClosingOvertype==="never"||!o.autoClosingPairs.autoClosingPairsCloseSingleChar.has(i))return!1;for(let r=0,s=t.length;r<s;r++){let a=t[r];if(!a.isEmpty())return!1;let l=a.getPosition(),d=e.getLineContent(l.lineNumber);if(d.charAt(l.column-1)!==i)return!1;let u=Nr(i);if((l.column>2?d.charCodeAt(l.column-2):0)===92&&u)return!1;if(o.autoClosingOvertype==="auto"){let m=!1;for(let f=0,g=n.length;f<g;f++){let b=n[f];if(l.lineNumber===b.startLineNumber&&l.column===b.startColumn){m=!0;break}}if(!m)return!1}}return!0}function uc(o,e,t){return t?new ac(o,e,!0):new ii(o,e,!0)}function Ag(o,e,t){return t=t||1,Do.shiftIndent(e,e.length+t,o.tabSize,o.indentSize,o.insertSpaces)}function Mh(o,e,t){return t=t||1,Do.unshiftIndent(e,e.length+t,o.tabSize,o.indentSize,o.insertSpaces)}function lD(o,e){return Nr(e)?o.autoSurround==="quotes"||o.autoSurround==="languageDefined":o.autoSurround==="brackets"||o.autoSurround==="languageDefined"}var $r=class{static indent(e,t,n){if(t===null||n===null)return[];let i=[];for(let r=0,s=n.length;r<s;r++)i[r]=new Do(n[r],{isUnshift:!1,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent},e.languageConfigurationService);return i}static outdent(e,t,n){let i=[];for(let r=0,s=n.length;r<s;r++)i[r]=new Do(n[r],{isUnshift:!0,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent},e.languageConfigurationService);return i}static shiftIndent(e,t,n){return Ag(e,t,n)}static unshiftIndent(e,t,n){return Mh(e,t,n)}static paste(e,t,n,i,r,s){return tC.getEdits(e,t,n,i,r,s)}static tab(e,t,n){return oC.getCommands(e,t,n)}static compositionType(e,t,n,i,r,s,a,l){return nC.getEdits(e,t,n,i,r,s,a,l)}static compositionEndWithInterceptors(e,t,n,i,r,s){if(!i)return null;let a=null;for(let h of i)if(a===null)a=h.insertedText;else if(a!==h.insertedText)return null;if(!a||a.length!==1)return null;let l=a,d=!1;for(let h of i)if(h.deletedText.length!==0){d=!0;break}if(d){if(!lD(t,l)||!t.surroundingPairs.hasOwnProperty(l))return null;let h=Nr(l);for(let g of i)if(g.deletedSelectionStart!==0||g.deletedSelectionEnd!==g.deletedText.length||/^[ \t]+$/.test(g.deletedText)||h&&Nr(g.deletedText))return null;let m=[];for(let g of r){if(!g.isEmpty())return null;m.push(g.getPosition())}if(m.length!==i.length)return null;let f=[];for(let g=0,b=m.length;g<b;g++)f.push(new qI(m[g],i[g].deletedText,t.surroundingPairs[l]));return new Sn(4,f,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}let c=XI.getEdits(t,n,r,s,l);if(c!==void 0)return c;let u=Dh.getEdits(t,n,r,l,!0,!1);return u!==void 0?u:null}static typeWithInterceptors(e,t,n,i,r,s,a){let l=kh.getEdits(n,i,r,a,e);if(l!==void 0)return l;let d=YI.getEdits(n,i,r,a,e);if(d!==void 0)return d;let c=ZI.getEdits(t,n,i,r,s,a);if(c!==void 0)return c;let u=Dh.getEdits(n,i,r,a,!1,e);if(u!==void 0)return u;let h=QI.getEdits(n,i,r,a,e);if(h!==void 0)return h;let m=JI.getEdits(t,n,i,r,a,e);return m!==void 0?m:eC.getEdits(t,r,a)}static typeWithoutInterceptors(e,t,n,i,r){return iC.getEdits(e,i,r)}},sC=class{constructor(e,t,n,i,r,s){this.deletedText=e;this.deletedSelectionStart=t;this.deletedSelectionEnd=n;this.insertedText=i;this.insertedSelectionStart=r;this.insertedSelectionEnd=s}};var ye;(Ae=>(Ae.editorSimpleInput=new j("editorSimpleInput",!1,!0),Ae.editorTextFocus=new j("editorTextFocus",!1,p("editorTextFocus","Whether the editor text has focus (cursor is blinking)")),Ae.focus=new j("editorFocus",!1,p("editorFocus","Whether the editor or an editor widget has focus (e.g. focus is in the find widget)")),Ae.textInputFocus=new j("textInputFocus",!1,p("textInputFocus","Whether an editor or a rich text input has focus (cursor is blinking)")),Ae.readOnly=new j("editorReadonly",!1,p("editorReadonly","Whether the editor is read-only")),Ae.inDiffEditor=new j("inDiffEditor",!1,p("inDiffEditor","Whether the context is a diff editor")),Ae.isEmbeddedDiffEditor=new j("isEmbeddedDiffEditor",!1,p("isEmbeddedDiffEditor","Whether the context is an embedded diff editor")),Ae.multiDiffEditorAllCollapsed=new j("multiDiffEditorAllCollapsed",void 0,p("multiDiffEditorAllCollapsed","Whether all files in multi diff editor are collapsed")),Ae.hasChanges=new j("diffEditorHasChanges",!1,p("diffEditorHasChanges","Whether the diff editor has changes")),Ae.comparingMovedCode=new j("comparingMovedCode",!1,p("comparingMovedCode","Whether a moved code block is selected for comparison")),Ae.accessibleDiffViewerVisible=new j("accessibleDiffViewerVisible",!1,p("accessibleDiffViewerVisible","Whether the accessible diff viewer is visible")),Ae.diffEditorRenderSideBySideInlineBreakpointReached=new j("diffEditorRenderSideBySideInlineBreakpointReached",!1,p("diffEditorRenderSideBySideInlineBreakpointReached","Whether the diff editor render side by side inline breakpoint is reached")),Ae.diffEditorInlineMode=new j("diffEditorInlineMode",!1,p("diffEditorInlineMode","Whether inline mode is active")),Ae.diffEditorOriginalWritable=new j("diffEditorOriginalWritable",!1,p("diffEditorOriginalWritable","Whether modified is writable in the diff editor")),Ae.diffEditorModifiedWritable=new j("diffEditorModifiedWritable",!1,p("diffEditorModifiedWritable","Whether modified is writable in the diff editor")),Ae.diffEditorOriginalUri=new j("diffEditorOriginalUri","",p("diffEditorOriginalUri","The uri of the original document")),Ae.diffEditorModifiedUri=new j("diffEditorModifiedUri","",p("diffEditorModifiedUri","The uri of the modified document")),Ae.columnSelection=new j("editorColumnSelection",!1,p("editorColumnSelection","Whether `editor.columnSelection` is enabled")),Ae.writable=Ae.readOnly.toNegated(),Ae.hasNonEmptySelection=new j("editorHasSelection",!1,p("editorHasSelection","Whether the editor has text selected")),Ae.hasOnlyEmptySelection=Ae.hasNonEmptySelection.toNegated(),Ae.hasMultipleSelections=new j("editorHasMultipleSelections",!1,p("editorHasMultipleSelections","Whether the editor has multiple selections")),Ae.hasSingleSelection=Ae.hasMultipleSelections.toNegated(),Ae.tabMovesFocus=new j("editorTabMovesFocus",!1,p("editorTabMovesFocus","Whether `Tab` will move focus out of the editor")),Ae.tabDoesNotMoveFocus=Ae.tabMovesFocus.toNegated(),Ae.isInEmbeddedEditor=new j("isInEmbeddedEditor",!1,!0),Ae.canUndo=new j("canUndo",!1,!0),Ae.canRedo=new j("canRedo",!1,!0),Ae.hoverVisible=new j("editorHoverVisible",!1,p("editorHoverVisible","Whether the editor hover is visible")),Ae.hoverFocused=new j("editorHoverFocused",!1,p("editorHoverFocused","Whether the editor hover is focused")),Ae.stickyScrollFocused=new j("stickyScrollFocused",!1,p("stickyScrollFocused","Whether the sticky scroll is focused")),Ae.stickyScrollVisible=new j("stickyScrollVisible",!1,p("stickyScrollVisible","Whether the sticky scroll is visible")),Ae.standaloneColorPickerVisible=new j("standaloneColorPickerVisible",!1,p("standaloneColorPickerVisible","Whether the standalone color picker is visible")),Ae.standaloneColorPickerFocused=new j("standaloneColorPickerFocused",!1,p("standaloneColorPickerFocused","Whether the standalone color picker is focused")),Ae.inCompositeEditor=new j("inCompositeEditor",void 0,p("inCompositeEditor","Whether the editor is part of a larger editor (e.g. notebooks)")),Ae.notInCompositeEditor=Ae.inCompositeEditor.toNegated(),Ae.languageId=new j("editorLangId","",p("editorLangId","The language identifier of the editor")),Ae.hasCompletionItemProvider=new j("editorHasCompletionItemProvider",!1,p("editorHasCompletionItemProvider","Whether the editor has a completion item provider")),Ae.hasCodeActionsProvider=new j("editorHasCodeActionsProvider",!1,p("editorHasCodeActionsProvider","Whether the editor has a code actions provider")),Ae.hasCodeLensProvider=new j("editorHasCodeLensProvider",!1,p("editorHasCodeLensProvider","Whether the editor has a code lens provider")),Ae.hasDefinitionProvider=new j("editorHasDefinitionProvider",!1,p("editorHasDefinitionProvider","Whether the editor has a definition provider")),Ae.hasDeclarationProvider=new j("editorHasDeclarationProvider",!1,p("editorHasDeclarationProvider","Whether the editor has a declaration provider")),Ae.hasImplementationProvider=new j("editorHasImplementationProvider",!1,p("editorHasImplementationProvider","Whether the editor has an implementation provider")),Ae.hasTypeDefinitionProvider=new j("editorHasTypeDefinitionProvider",!1,p("editorHasTypeDefinitionProvider","Whether the editor has a type definition provider")),Ae.hasHoverProvider=new j("editorHasHoverProvider",!1,p("editorHasHoverProvider","Whether the editor has a hover provider")),Ae.hasDocumentHighlightProvider=new j("editorHasDocumentHighlightProvider",!1,p("editorHasDocumentHighlightProvider","Whether the editor has a document highlight provider")),Ae.hasDocumentSymbolProvider=new j("editorHasDocumentSymbolProvider",!1,p("editorHasDocumentSymbolProvider","Whether the editor has a document symbol provider")),Ae.hasReferenceProvider=new j("editorHasReferenceProvider",!1,p("editorHasReferenceProvider","Whether the editor has a reference provider")),Ae.hasRenameProvider=new j("editorHasRenameProvider",!1,p("editorHasRenameProvider","Whether the editor has a rename provider")),Ae.hasSignatureHelpProvider=new j("editorHasSignatureHelpProvider",!1,p("editorHasSignatureHelpProvider","Whether the editor has a signature help provider")),Ae.hasInlayHintsProvider=new j("editorHasInlayHintsProvider",!1,p("editorHasInlayHintsProvider","Whether the editor has an inline hints provider")),Ae.hasDocumentFormattingProvider=new j("editorHasDocumentFormattingProvider",!1,p("editorHasDocumentFormattingProvider","Whether the editor has a document formatting provider")),Ae.hasDocumentSelectionFormattingProvider=new j("editorHasDocumentSelectionFormattingProvider",!1,p("editorHasDocumentSelectionFormattingProvider","Whether the editor has a document selection formatting provider")),Ae.hasMultipleDocumentFormattingProvider=new j("editorHasMultipleDocumentFormattingProvider",!1,p("editorHasMultipleDocumentFormattingProvider","Whether the editor has multiple document formatting providers")),Ae.hasMultipleDocumentSelectionFormattingProvider=new j("editorHasMultipleDocumentSelectionFormattingProvider",!1,p("editorHasMultipleDocumentSelectionFormattingProvider","Whether the editor has multiple document selection formatting providers"))))(ye||={});var tt=0,Bt=class extends vg{runEditorCommand(e,t,n){let i=t._getViewModel();i&&this.runCoreEditorCommand(i,n||{})}},oi;(a=>{let o=function(l){if(!mn(l))return!1;let d=l;return!(!an(d.to)||!qn(d.by)&&!an(d.by)||!qn(d.value)&&!yi(d.value)||!qn(d.revealCursor)&&!lb(d.revealCursor))};a.metadata={description:"Scroll editor in the given direction",args:[{name:"Editor scroll argument object",description:"Property-value pairs that can be passed through this argument:\n					* 'to': A mandatory direction value.\n						```\n						'up', 'down'\n						```\n					* 'by': Unit to move. Default is computed based on 'to' value.\n						```\n						'line', 'wrappedLine', 'page', 'halfPage', 'editor'\n						```\n					* 'value': Number of units to move. Default is '1'.\n					* 'revealCursor': If 'true' reveals the cursor if it is outside view port.\n				",constraint:o,schema:{type:"object",required:["to"],properties:{to:{type:"string",enum:["up","down"]},by:{type:"string",enum:["line","wrappedLine","page","halfPage","editor"]},value:{type:"number",default:1},revealCursor:{type:"boolean"}}}}]},a.RawDirection={Up:"up",Right:"right",Down:"down",Left:"left"},a.RawUnit={Line:"line",WrappedLine:"wrappedLine",Page:"page",HalfPage:"halfPage",Editor:"editor",Column:"column"};function i(l){let d;switch(l.to){case a.RawDirection.Up:d=1;break;case a.RawDirection.Right:d=2;break;case a.RawDirection.Down:d=3;break;case a.RawDirection.Left:d=4;break;default:return null}let c;switch(l.by){case a.RawUnit.Line:c=1;break;case a.RawUnit.WrappedLine:c=2;break;case a.RawUnit.Page:c=3;break;case a.RawUnit.HalfPage:c=4;break;case a.RawUnit.Editor:c=5;break;case a.RawUnit.Column:c=6;break;default:c=2}let u=Math.floor(l.value||1),h=!!l.revealCursor;return{direction:d,unit:c,value:u,revealCursor:h,select:!!l.select}}a.parse=i;let r;(h=>(h[h.Up=1]="Up",h[h.Right=2]="Right",h[h.Down=3]="Down",h[h.Left=4]="Left"))(r=a.Direction||={});let s;(f=>(f[f.Line=1]="Line",f[f.WrappedLine=2]="WrappedLine",f[f.Page=3]="Page",f[f.HalfPage=4]="HalfPage",f[f.Editor=5]="Editor",f[f.Column=6]="Column"))(s=a.Unit||={})})(oi||={});var Og;(n=>{let o=function(i){if(!mn(i))return!1;let r=i;return!(!yi(r.lineNumber)&&!an(r.lineNumber)||!qn(r.at)&&!an(r.at))};n.metadata={description:"Reveal the given line at the given logical position",args:[{name:"Reveal line argument object",description:"Property-value pairs that can be passed through this argument:\n					* 'lineNumber': A mandatory line number value.\n					* 'at': Logical position at which line has to be revealed.\n						```\n						'top', 'center', 'bottom'\n						```\n				",constraint:o,schema:{type:"object",required:["lineNumber"],properties:{lineNumber:{type:["number","string"]},at:{type:"string",enum:["top","center","bottom"]}}}}]},n.RawAtArgument={Top:"top",Center:"center",Bottom:"bottom"}})(Og||={});var Ng=class{constructor(e){e.addImplementation(1e4,"code-editor",(t,n)=>{let i=t.get(Nl).getFocusedCodeEditor();return i&&i.hasTextFocus()?this._runEditorCommand(t,i,n):!1}),e.addImplementation(1e3,"generic-dom-input-textarea",(t,n)=>{let i=eo();return i&&hs(i)?(this.runDOMCommand(i),!0):!1}),e.addImplementation(0,"generic-dom",(t,n)=>{let i=t.get(Nl).getActiveCodeEditor();return i?(i.focus(),this._runEditorCommand(t,i,n)):!1})}_runEditorCommand(e,t,n){let i=this.runEditorCommand(e,t,n);return i||!0}};var wn;(pe=>{class o extends Bt{_inSelectionMode;constructor(M){super(M),this._inSelectionMode=M.inSelectionMode}runCoreEditorCommand(M,ee){if(!ee.position)return;M.model.pushStackElement(),M.setCursorStates(ee.source,3,[An.moveTo(M,M.getPrimaryCursorState(),this._inSelectionMode,ee.position,ee.viewPosition)])&&ee.revealType!==2&&M.revealAllCursors(ee.source,!0,!0)}}pe.MoveTo=Ve(new o({id:"_moveTo",inSelectionMode:!1,precondition:void 0})),pe.MoveToSelect=Ve(new o({id:"_moveToSelect",inSelectionMode:!0,precondition:void 0}));class n extends Bt{runCoreEditorCommand(M,ee){M.model.pushStackElement();let ue=this._getColumnSelectResult(M,M.getPrimaryCursorState(),M.getCursorColumnSelectData(),ee);ue!==null&&(M.setCursorStates(ee.source,3,ue.viewStates.map(qe=>Ue.fromViewState(qe))),M.setCursorColumnSelectData({isReal:!0,fromViewLineNumber:ue.fromLineNumber,fromViewVisualColumn:ue.fromVisualColumn,toViewLineNumber:ue.toLineNumber,toViewVisualColumn:ue.toVisualColumn}),ue.reversed?M.revealTopMostCursor(ee.source):M.revealBottomMostCursor(ee.source))}}pe.ColumnSelect=Ve(new class extends n{constructor(){super({id:"columnSelect",precondition:void 0})}_getColumnSelectResult(se,M,ee,ue){if(typeof ue.position>"u"||typeof ue.viewPosition>"u"||typeof ue.mouseColumn>"u")return null;let qe=se.model.validatePosition(ue.position),yt=se.coordinatesConverter.validateViewPosition(new P(ue.viewPosition.lineNumber,ue.viewPosition.column),qe),Pn=ue.doColumnSelect?ee.fromViewLineNumber:yt.lineNumber,di=ue.doColumnSelect?ee.fromViewVisualColumn:ue.mouseColumn-1;return Fl.columnSelect(se.cursorConfig,se,Pn,di,yt.lineNumber,ue.mouseColumn-1)}}),pe.CursorColumnSelectLeft=Ve(new class extends n{constructor(){super({id:"cursorColumnSelectLeft",precondition:void 0,kbOpts:{weight:tt,kbExpr:ye.textInputFocus,primary:3599,linux:{primary:0}}})}_getColumnSelectResult(se,M,ee,ue){return Fl.columnSelectLeft(se.cursorConfig,se,ee)}}),pe.CursorColumnSelectRight=Ve(new class extends n{constructor(){super({id:"cursorColumnSelectRight",precondition:void 0,kbOpts:{weight:tt,kbExpr:ye.textInputFocus,primary:3601,linux:{primary:0}}})}_getColumnSelectResult(se,M,ee,ue){return Fl.columnSelectRight(se.cursorConfig,se,ee)}});class a extends n{_isPaged;constructor(M){super(M),this._isPaged=M.isPaged}_getColumnSelectResult(M,ee,ue,qe){return Fl.columnSelectUp(M.cursorConfig,M,ue,this._isPaged)}}pe.CursorColumnSelectUp=Ve(new a({isPaged:!1,id:"cursorColumnSelectUp",precondition:void 0,kbOpts:{weight:tt,kbExpr:ye.textInputFocus,primary:3600,linux:{primary:0}}})),pe.CursorColumnSelectPageUp=Ve(new a({isPaged:!0,id:"cursorColumnSelectPageUp",precondition:void 0,kbOpts:{weight:tt,kbExpr:ye.textInputFocus,primary:3595,linux:{primary:0}}}));class c extends n{_isPaged;constructor(M){super(M),this._isPaged=M.isPaged}_getColumnSelectResult(M,ee,ue,qe){return Fl.columnSelectDown(M.cursorConfig,M,ue,this._isPaged)}}pe.CursorColumnSelectDown=Ve(new c({isPaged:!1,id:"cursorColumnSelectDown",precondition:void 0,kbOpts:{weight:tt,kbExpr:ye.textInputFocus,primary:3602,linux:{primary:0}}})),pe.CursorColumnSelectPageDown=Ve(new c({isPaged:!0,id:"cursorColumnSelectPageDown",precondition:void 0,kbOpts:{weight:tt,kbExpr:ye.textInputFocus,primary:3596,linux:{primary:0}}}));class m extends Bt{constructor(){super({id:"cursorMove",precondition:void 0,metadata:Ne.metadata})}runCoreEditorCommand(M,ee){let ue=Ne.parse(ee);ue&&this._runCursorMove(M,ee.source,ue)}_runCursorMove(M,ee,ue){M.model.pushStackElement(),M.setCursorStates(ee,3,m._move(M,M.getCursorStates(),ue)),M.revealAllCursors(ee,!0)}static _move(M,ee,ue){let qe=ue.select,yt=ue.value;switch(ue.direction){case Ne.Direction.Left:case Ne.Direction.Right:case Ne.Direction.Up:case Ne.Direction.Down:case Ne.Direction.PrevBlankLine:case Ne.Direction.NextBlankLine:case Ne.Direction.WrappedLineStart:case Ne.Direction.WrappedLineFirstNonWhitespaceCharacter:case Ne.Direction.WrappedLineColumnCenter:case Ne.Direction.WrappedLineEnd:case Ne.Direction.WrappedLineLastNonWhitespaceCharacter:return An.simpleMove(M,ee,ue.direction,qe,yt,ue.unit);case Ne.Direction.ViewPortTop:case Ne.Direction.ViewPortBottom:case Ne.Direction.ViewPortCenter:case Ne.Direction.ViewPortIfOutside:return An.viewportMove(M,ee,ue.direction,qe,yt);default:return null}}}pe.CursorMoveImpl=m,pe.CursorMove=Ve(new m);let g;(M=>M[M.PAGE_SIZE_MARKER=-1]="PAGE_SIZE_MARKER")(g||={});class b extends Bt{_staticArgs;constructor(M){super(M),this._staticArgs=M.args}runCoreEditorCommand(M,ee){let ue=this._staticArgs;this._staticArgs.value===-1&&(ue={direction:this._staticArgs.direction,unit:this._staticArgs.unit,select:this._staticArgs.select,value:ee.pageSize||M.cursorConfig.pageSize}),M.model.pushStackElement(),M.setCursorStates(ee.source,3,An.simpleMove(M,M.getCursorStates(),ue.direction,ue.select,ue.value,ue.unit)),M.revealAllCursors(ee.source,!0)}}pe.CursorLeft=Ve(new b({args:{direction:Ne.Direction.Left,unit:Ne.Unit.None,select:!1,value:1},id:"cursorLeft",precondition:void 0,kbOpts:{weight:tt,kbExpr:ye.textInputFocus,primary:15,mac:{primary:15,secondary:[288]}}})),pe.CursorLeftSelect=Ve(new b({args:{direction:Ne.Direction.Left,unit:Ne.Unit.None,select:!0,value:1},id:"cursorLeftSelect",precondition:void 0,kbOpts:{weight:tt,kbExpr:ye.textInputFocus,primary:1039}})),pe.CursorRight=Ve(new b({args:{direction:Ne.Direction.Right,unit:Ne.Unit.None,select:!1,value:1},id:"cursorRight",precondition:void 0,kbOpts:{weight:tt,kbExpr:ye.textInputFocus,primary:17,mac:{primary:17,secondary:[292]}}})),pe.CursorRightSelect=Ve(new b({args:{direction:Ne.Direction.Right,unit:Ne.Unit.None,select:!0,value:1},id:"cursorRightSelect",precondition:void 0,kbOpts:{weight:tt,kbExpr:ye.textInputFocus,primary:1041}})),pe.CursorUp=Ve(new b({args:{direction:Ne.Direction.Up,unit:Ne.Unit.WrappedLine,select:!1,value:1},id:"cursorUp",precondition:void 0,kbOpts:{weight:tt,kbExpr:ye.textInputFocus,primary:16,mac:{primary:16,secondary:[302]}}})),pe.CursorUpSelect=Ve(new b({args:{direction:Ne.Direction.Up,unit:Ne.Unit.WrappedLine,select:!0,value:1},id:"cursorUpSelect",precondition:void 0,kbOpts:{weight:tt,kbExpr:ye.textInputFocus,primary:1040,secondary:[3088],mac:{primary:1040},linux:{primary:1040}}})),pe.CursorPageUp=Ve(new b({args:{direction:Ne.Direction.Up,unit:Ne.Unit.WrappedLine,select:!1,value:-1},id:"cursorPageUp",precondition:void 0,kbOpts:{weight:tt,kbExpr:ye.textInputFocus,primary:11}})),pe.CursorPageUpSelect=Ve(new b({args:{direction:Ne.Direction.Up,unit:Ne.Unit.WrappedLine,select:!0,value:-1},id:"cursorPageUpSelect",precondition:void 0,kbOpts:{weight:tt,kbExpr:ye.textInputFocus,primary:1035}})),pe.CursorDown=Ve(new b({args:{direction:Ne.Direction.Down,unit:Ne.Unit.WrappedLine,select:!1,value:1},id:"cursorDown",precondition:void 0,kbOpts:{weight:tt,kbExpr:ye.textInputFocus,primary:18,mac:{primary:18,secondary:[300]}}})),pe.CursorDownSelect=Ve(new b({args:{direction:Ne.Direction.Down,unit:Ne.Unit.WrappedLine,select:!0,value:1},id:"cursorDownSelect",precondition:void 0,kbOpts:{weight:tt,kbExpr:ye.textInputFocus,primary:1042,secondary:[3090],mac:{primary:1042},linux:{primary:1042}}})),pe.CursorPageDown=Ve(new b({args:{direction:Ne.Direction.Down,unit:Ne.Unit.WrappedLine,select:!1,value:-1},id:"cursorPageDown",precondition:void 0,kbOpts:{weight:tt,kbExpr:ye.textInputFocus,primary:12}})),pe.CursorPageDownSelect=Ve(new b({args:{direction:Ne.Direction.Down,unit:Ne.Unit.WrappedLine,select:!0,value:-1},id:"cursorPageDownSelect",precondition:void 0,kbOpts:{weight:tt,kbExpr:ye.textInputFocus,primary:1036}})),pe.CreateCursor=Ve(new class extends Bt{constructor(){super({id:"createCursor",precondition:void 0})}runCoreEditorCommand(se,M){if(!M.position)return;let ee;M.wholeLine?ee=An.line(se,se.getPrimaryCursorState(),!1,M.position,M.viewPosition):ee=An.moveTo(se,se.getPrimaryCursorState(),!1,M.position,M.viewPosition);let ue=se.getCursorStates();if(ue.length>1){let qe=ee.modelState?ee.modelState.position:null,yt=ee.viewState?ee.viewState.position:null;for(let Pn=0,di=ue.length;Pn<di;Pn++){let Pe=ue[Pn];if(!(qe&&!Pe.modelState.selection.containsPosition(qe))&&!(yt&&!Pe.viewState.selection.containsPosition(yt))){ue.splice(Pn,1),se.model.pushStackElement(),se.setCursorStates(M.source,3,ue);return}}}ue.push(ee),se.model.pushStackElement(),se.setCursorStates(M.source,3,ue)}}),pe.LastCursorMoveToSelect=Ve(new class extends Bt{constructor(){super({id:"_lastCursorMoveToSelect",precondition:void 0})}runCoreEditorCommand(se,M){if(!M.position)return;let ee=se.getLastAddedCursorIndex(),ue=se.getCursorStates(),qe=ue.slice(0);qe[ee]=An.moveTo(se,ue[ee],!0,M.position,M.viewPosition),se.model.pushStackElement(),se.setCursorStates(M.source,3,qe)}});class te extends Bt{_inSelectionMode;constructor(M){super(M),this._inSelectionMode=M.inSelectionMode}runCoreEditorCommand(M,ee){M.model.pushStackElement(),M.setCursorStates(ee.source,3,An.moveToBeginningOfLine(M,M.getCursorStates(),this._inSelectionMode)),M.revealAllCursors(ee.source,!0)}}pe.CursorHome=Ve(new te({inSelectionMode:!1,id:"cursorHome",precondition:void 0,kbOpts:{weight:tt,kbExpr:ye.textInputFocus,primary:14,mac:{primary:14,secondary:[2063]}}})),pe.CursorHomeSelect=Ve(new te({inSelectionMode:!0,id:"cursorHomeSelect",precondition:void 0,kbOpts:{weight:tt,kbExpr:ye.textInputFocus,primary:1038,mac:{primary:1038,secondary:[3087]}}}));class ne extends Bt{_inSelectionMode;constructor(M){super(M),this._inSelectionMode=M.inSelectionMode}runCoreEditorCommand(M,ee){M.model.pushStackElement(),M.setCursorStates(ee.source,3,this._exec(M.getCursorStates())),M.revealAllCursors(ee.source,!0)}_exec(M){let ee=[];for(let ue=0,qe=M.length;ue<qe;ue++){let yt=M[ue],Pn=yt.modelState.position.lineNumber;ee[ue]=Ue.fromModelState(yt.modelState.move(this._inSelectionMode,Pn,1,0))}return ee}}pe.CursorLineStart=Ve(new ne({inSelectionMode:!1,id:"cursorLineStart",precondition:void 0,kbOpts:{weight:tt,kbExpr:ye.textInputFocus,primary:0,mac:{primary:287}}})),pe.CursorLineStartSelect=Ve(new ne({inSelectionMode:!0,id:"cursorLineStartSelect",precondition:void 0,kbOpts:{weight:tt,kbExpr:ye.textInputFocus,primary:0,mac:{primary:1311}}}));class xe extends Bt{_inSelectionMode;constructor(M){super(M),this._inSelectionMode=M.inSelectionMode}runCoreEditorCommand(M,ee){M.model.pushStackElement(),M.setCursorStates(ee.source,3,An.moveToEndOfLine(M,M.getCursorStates(),this._inSelectionMode,ee.sticky||!1)),M.revealAllCursors(ee.source,!0)}}pe.CursorEnd=Ve(new xe({inSelectionMode:!1,id:"cursorEnd",precondition:void 0,kbOpts:{args:{sticky:!1},weight:tt,kbExpr:ye.textInputFocus,primary:13,mac:{primary:13,secondary:[2065]}},metadata:{description:"Go to End",args:[{name:"args",schema:{type:"object",properties:{sticky:{description:p("stickydesc","Stick to the end even when going to longer lines"),type:"boolean",default:!1}}}}]}})),pe.CursorEndSelect=Ve(new xe({inSelectionMode:!0,id:"cursorEndSelect",precondition:void 0,kbOpts:{args:{sticky:!1},weight:tt,kbExpr:ye.textInputFocus,primary:1037,mac:{primary:1037,secondary:[3089]}},metadata:{description:"Select to End",args:[{name:"args",schema:{type:"object",properties:{sticky:{description:p("stickydesc","Stick to the end even when going to longer lines"),type:"boolean",default:!1}}}}]}}));class ke extends Bt{_inSelectionMode;constructor(M){super(M),this._inSelectionMode=M.inSelectionMode}runCoreEditorCommand(M,ee){M.model.pushStackElement(),M.setCursorStates(ee.source,3,this._exec(M,M.getCursorStates())),M.revealAllCursors(ee.source,!0)}_exec(M,ee){let ue=[];for(let qe=0,yt=ee.length;qe<yt;qe++){let Pn=ee[qe],di=Pn.modelState.position.lineNumber,Pe=M.model.getLineMaxColumn(di);ue[qe]=Ue.fromModelState(Pn.modelState.move(this._inSelectionMode,di,Pe,0))}return ue}}pe.CursorLineEnd=Ve(new ke({inSelectionMode:!1,id:"cursorLineEnd",precondition:void 0,kbOpts:{weight:tt,kbExpr:ye.textInputFocus,primary:0,mac:{primary:291}}})),pe.CursorLineEndSelect=Ve(new ke({inSelectionMode:!0,id:"cursorLineEndSelect",precondition:void 0,kbOpts:{weight:tt,kbExpr:ye.textInputFocus,primary:0,mac:{primary:1315}}}));class ji extends Bt{_inSelectionMode;constructor(M){super(M),this._inSelectionMode=M.inSelectionMode}runCoreEditorCommand(M,ee){M.model.pushStackElement(),M.setCursorStates(ee.source,3,An.moveToBeginningOfBuffer(M,M.getCursorStates(),this._inSelectionMode)),M.revealAllCursors(ee.source,!0)}}pe.CursorTop=Ve(new ji({inSelectionMode:!1,id:"cursorTop",precondition:void 0,kbOpts:{weight:tt,kbExpr:ye.textInputFocus,primary:2062,mac:{primary:2064}}})),pe.CursorTopSelect=Ve(new ji({inSelectionMode:!0,id:"cursorTopSelect",precondition:void 0,kbOpts:{weight:tt,kbExpr:ye.textInputFocus,primary:3086,mac:{primary:3088}}}));class ai extends Bt{_inSelectionMode;constructor(M){super(M),this._inSelectionMode=M.inSelectionMode}runCoreEditorCommand(M,ee){M.model.pushStackElement(),M.setCursorStates(ee.source,3,An.moveToEndOfBuffer(M,M.getCursorStates(),this._inSelectionMode)),M.revealAllCursors(ee.source,!0)}}pe.CursorBottom=Ve(new ai({inSelectionMode:!1,id:"cursorBottom",precondition:void 0,kbOpts:{weight:tt,kbExpr:ye.textInputFocus,primary:2061,mac:{primary:2066}}})),pe.CursorBottomSelect=Ve(new ai({inSelectionMode:!0,id:"cursorBottomSelect",precondition:void 0,kbOpts:{weight:tt,kbExpr:ye.textInputFocus,primary:3085,mac:{primary:3090}}}));class Oa extends Bt{constructor(){super({id:"editorScroll",precondition:void 0,metadata:oi.metadata})}determineScrollMethod(M){let ee=[6],ue=[1,2,3,4,5,6],qe=[4,2],yt=[1,3];return ee.includes(M.unit)&&qe.includes(M.direction)?this._runHorizontalEditorScroll.bind(this):ue.includes(M.unit)&&yt.includes(M.direction)?this._runVerticalEditorScroll.bind(this):null}runCoreEditorCommand(M,ee){let ue=oi.parse(ee);if(!ue)return;let qe=this.determineScrollMethod(ue);qe&&qe(M,ee.source,ue)}_runVerticalEditorScroll(M,ee,ue){let qe=this._computeDesiredScrollTop(M,ue);if(ue.revealCursor){let yt=M.getCompletelyVisibleViewRangeAtScrollTop(qe);M.setCursorStates(ee,3,[An.findPositionInViewportIfOutside(M,M.getPrimaryCursorState(),yt,ue.select)])}M.viewLayout.setScrollPosition({scrollTop:qe},0)}_computeDesiredScrollTop(M,ee){if(ee.unit===1){let yt=M.viewLayout.getFutureViewport(),Pn=M.getCompletelyVisibleViewRangeAtScrollTop(yt.top),di=M.coordinatesConverter.convertViewRangeToModelRange(Pn),Pe;ee.direction===1?Pe=Math.max(1,di.startLineNumber-ee.value):Pe=Math.min(M.model.getLineCount(),di.startLineNumber+ee.value);let w=M.coordinatesConverter.convertModelPositionToViewPosition(new P(Pe,1));return M.viewLayout.getVerticalOffsetForLineNumber(w.lineNumber)}if(ee.unit===5){let yt=0;return ee.direction===3&&(yt=M.model.getLineCount()-M.cursorConfig.pageSize),M.viewLayout.getVerticalOffsetForLineNumber(yt)}let ue;ee.unit===3?ue=M.cursorConfig.pageSize*ee.value:ee.unit===4?ue=Math.round(M.cursorConfig.pageSize/2)*ee.value:ue=ee.value;let qe=(ee.direction===1?-1:1)*ue;return M.viewLayout.getCurrentScrollTop()+qe*M.cursorConfig.lineHeight}_runHorizontalEditorScroll(M,ee,ue){let qe=this._computeDesiredScrollLeft(M,ue);M.viewLayout.setScrollPosition({scrollLeft:qe},0)}_computeDesiredScrollLeft(M,ee){let ue=(ee.direction===4?-1:1)*ee.value;return M.viewLayout.getCurrentScrollLeft()+ue*M.cursorConfig.typicalHalfwidthCharacterWidth}}pe.EditorScrollImpl=Oa,pe.EditorScroll=Ve(new Oa),pe.ScrollLineUp=Ve(new class extends Bt{constructor(){super({id:"scrollLineUp",precondition:void 0,kbOpts:{weight:tt,kbExpr:ye.textInputFocus,primary:2064,mac:{primary:267}}})}runCoreEditorCommand(se,M){pe.EditorScroll.runCoreEditorCommand(se,{to:oi.RawDirection.Up,by:oi.RawUnit.WrappedLine,value:1,revealCursor:!1,select:!1,source:M.source})}}),pe.ScrollPageUp=Ve(new class extends Bt{constructor(){super({id:"scrollPageUp",precondition:void 0,kbOpts:{weight:tt,kbExpr:ye.textInputFocus,primary:2059,win:{primary:523},linux:{primary:523}}})}runCoreEditorCommand(se,M){pe.EditorScroll.runCoreEditorCommand(se,{to:oi.RawDirection.Up,by:oi.RawUnit.Page,value:1,revealCursor:!1,select:!1,source:M.source})}}),pe.ScrollEditorTop=Ve(new class extends Bt{constructor(){super({id:"scrollEditorTop",precondition:void 0,kbOpts:{weight:tt,kbExpr:ye.textInputFocus}})}runCoreEditorCommand(se,M){pe.EditorScroll.runCoreEditorCommand(se,{to:oi.RawDirection.Up,by:oi.RawUnit.Editor,value:1,revealCursor:!1,select:!1,source:M.source})}}),pe.ScrollLineDown=Ve(new class extends Bt{constructor(){super({id:"scrollLineDown",precondition:void 0,kbOpts:{weight:tt,kbExpr:ye.textInputFocus,primary:2066,mac:{primary:268}}})}runCoreEditorCommand(se,M){pe.EditorScroll.runCoreEditorCommand(se,{to:oi.RawDirection.Down,by:oi.RawUnit.WrappedLine,value:1,revealCursor:!1,select:!1,source:M.source})}}),pe.ScrollPageDown=Ve(new class extends Bt{constructor(){super({id:"scrollPageDown",precondition:void 0,kbOpts:{weight:tt,kbExpr:ye.textInputFocus,primary:2060,win:{primary:524},linux:{primary:524}}})}runCoreEditorCommand(se,M){pe.EditorScroll.runCoreEditorCommand(se,{to:oi.RawDirection.Down,by:oi.RawUnit.Page,value:1,revealCursor:!1,select:!1,source:M.source})}}),pe.ScrollEditorBottom=Ve(new class extends Bt{constructor(){super({id:"scrollEditorBottom",precondition:void 0,kbOpts:{weight:tt,kbExpr:ye.textInputFocus}})}runCoreEditorCommand(se,M){pe.EditorScroll.runCoreEditorCommand(se,{to:oi.RawDirection.Down,by:oi.RawUnit.Editor,value:1,revealCursor:!1,select:!1,source:M.source})}}),pe.ScrollLeft=Ve(new class extends Bt{constructor(){super({id:"scrollLeft",precondition:void 0,kbOpts:{weight:tt,kbExpr:ye.textInputFocus}})}runCoreEditorCommand(se,M){pe.EditorScroll.runCoreEditorCommand(se,{to:oi.RawDirection.Left,by:oi.RawUnit.Column,value:2,revealCursor:!1,select:!1,source:M.source})}}),pe.ScrollRight=Ve(new class extends Bt{constructor(){super({id:"scrollRight",precondition:void 0,kbOpts:{weight:tt,kbExpr:ye.textInputFocus}})}runCoreEditorCommand(se,M){pe.EditorScroll.runCoreEditorCommand(se,{to:oi.RawDirection.Right,by:oi.RawUnit.Column,value:2,revealCursor:!1,select:!1,source:M.source})}});class Yo extends Bt{_inSelectionMode;constructor(M){super(M),this._inSelectionMode=M.inSelectionMode}runCoreEditorCommand(M,ee){ee.position&&(M.model.pushStackElement(),M.setCursorStates(ee.source,3,[An.word(M,M.getPrimaryCursorState(),this._inSelectionMode,ee.position)]),ee.revealType!==2&&M.revealAllCursors(ee.source,!0,!0))}}pe.WordSelect=Ve(new Yo({inSelectionMode:!1,id:"_wordSelect",precondition:void 0})),pe.WordSelectDrag=Ve(new Yo({inSelectionMode:!0,id:"_wordSelectDrag",precondition:void 0})),pe.LastCursorWordSelect=Ve(new class extends Bt{constructor(){super({id:"lastCursorWordSelect",precondition:void 0})}runCoreEditorCommand(se,M){if(!M.position)return;let ee=se.getLastAddedCursorIndex(),ue=se.getCursorStates(),qe=ue.slice(0),yt=ue[ee];qe[ee]=An.word(se,yt,yt.modelState.hasSelection(),M.position),se.model.pushStackElement(),se.setCursorStates(M.source,3,qe)}});class Qr extends Bt{_inSelectionMode;constructor(M){super(M),this._inSelectionMode=M.inSelectionMode}runCoreEditorCommand(M,ee){ee.position&&(M.model.pushStackElement(),M.setCursorStates(ee.source,3,[An.line(M,M.getPrimaryCursorState(),this._inSelectionMode,ee.position,ee.viewPosition)]),ee.revealType!==2&&M.revealAllCursors(ee.source,!1,!0))}}pe.LineSelect=Ve(new Qr({inSelectionMode:!1,id:"_lineSelect",precondition:void 0})),pe.LineSelectDrag=Ve(new Qr({inSelectionMode:!0,id:"_lineSelectDrag",precondition:void 0}));class Ro extends Bt{_inSelectionMode;constructor(M){super(M),this._inSelectionMode=M.inSelectionMode}runCoreEditorCommand(M,ee){if(!ee.position)return;let ue=M.getLastAddedCursorIndex(),qe=M.getCursorStates(),yt=qe.slice(0);yt[ue]=An.line(M,qe[ue],this._inSelectionMode,ee.position,ee.viewPosition),M.model.pushStackElement(),M.setCursorStates(ee.source,3,yt)}}pe.LastCursorLineSelect=Ve(new Ro({inSelectionMode:!1,id:"lastCursorLineSelect",precondition:void 0})),pe.LastCursorLineSelectDrag=Ve(new Ro({inSelectionMode:!0,id:"lastCursorLineSelectDrag",precondition:void 0})),pe.CancelSelection=Ve(new class extends Bt{constructor(){super({id:"cancelSelection",precondition:ye.hasNonEmptySelection,kbOpts:{weight:tt,kbExpr:ye.textInputFocus,primary:9,secondary:[1033]}})}runCoreEditorCommand(se,M){se.model.pushStackElement(),se.setCursorStates(M.source,3,[An.cancelSelection(se,se.getPrimaryCursorState())]),se.revealAllCursors(M.source,!0)}}),pe.RemoveSecondaryCursors=Ve(new class extends Bt{constructor(){super({id:"removeSecondaryCursors",precondition:ye.hasMultipleSelections,kbOpts:{weight:tt+1,kbExpr:ye.textInputFocus,primary:9,secondary:[1033]}})}runCoreEditorCommand(se,M){se.model.pushStackElement(),se.setCursorStates(M.source,3,[se.getPrimaryCursorState()]),se.revealAllCursors(M.source,!0),Dg(p("removedCursor","Removed secondary cursors"))}}),pe.RevealLine=Ve(new class extends Bt{constructor(){super({id:"revealLine",precondition:void 0,metadata:Og.metadata})}runCoreEditorCommand(se,M){let ee=M,ue=ee.lineNumber||0,qe=typeof ue=="number"?ue+1:parseInt(ue)+1;qe<1&&(qe=1);let yt=se.model.getLineCount();qe>yt&&(qe=yt);let Pn=new D(qe,1,qe,se.model.getLineMaxColumn(qe)),di=0;if(ee.at)switch(ee.at){case Og.RawAtArgument.Top:di=3;break;case Og.RawAtArgument.Center:di=1;break;case Og.RawAtArgument.Bottom:di=4;break;default:break}let Pe=se.coordinatesConverter.convertModelRangeToViewRange(Pn);se.revealRange(M.source,!1,Pe,di,0)}}),pe.SelectAll=new class extends Ng{constructor(){super(IP)}runDOMCommand(se){sn&&(se.focus(),se.select()),se.ownerDocument.execCommand("selectAll")}runEditorCommand(se,M,ee){let ue=M._getViewModel();ue&&this.runCoreEditorCommand(ue,ee)}runCoreEditorCommand(se,M){se.model.pushStackElement(),se.setCursorStates("keyboard",3,[An.selectAll(se,se.getPrimaryCursorState())])}},pe.SetSelection=Ve(new class extends Bt{constructor(){super({id:"setSelection",precondition:void 0})}runCoreEditorCommand(se,M){M.selection&&(se.model.pushStackElement(),se.setCursorStates(M.source,3,[Ue.fromModelSelection(M.selection)]))}})})(wn||={});var M5=xt.and(ye.textInputFocus,ye.columnSelection);function Nh(o,e){aa.registerKeybindingRule({id:o,primary:e,when:M5,weight:tt+1})}Nh(wn.CursorColumnSelectLeft.id,1039);Nh(wn.CursorColumnSelectRight.id,1041);Nh(wn.CursorColumnSelectUp.id,1040);Nh(wn.CursorColumnSelectPageUp.id,1035);Nh(wn.CursorColumnSelectDown.id,1042);Nh(wn.CursorColumnSelectPageDown.id,1036);function PP(o){return o.register(),o}var A5;(l=>{class o extends vg{runEditorCommand(c,u,h){let m=u._getViewModel();m&&this.runCoreEditingCommand(u,m,h||{})}}l.CoreEditingCommand=o,l.LineBreakInsert=Ve(new class extends o{constructor(){super({id:"lineBreakInsert",precondition:ye.writable,kbOpts:{weight:tt,kbExpr:ye.textInputFocus,primary:0,mac:{primary:301}}})}runCoreEditingCommand(d,c,u){d.pushUndoStop(),d.executeCommands(this.id,kh.lineBreakInsert(c.cursorConfig,c.model,c.getCursorStates().map(h=>h.modelState.selection)))}}),l.Outdent=Ve(new class extends o{constructor(){super({id:"outdent",precondition:ye.writable,kbOpts:{weight:tt,kbExpr:xt.and(ye.editorTextFocus,ye.tabDoesNotMoveFocus),primary:1026}})}runCoreEditingCommand(d,c,u){d.pushUndoStop(),d.executeCommands(this.id,$r.outdent(c.cursorConfig,c.model,c.getCursorStates().map(h=>h.modelState.selection))),d.pushUndoStop()}}),l.Tab=Ve(new class extends o{constructor(){super({id:"tab",precondition:ye.writable,kbOpts:{weight:tt,kbExpr:xt.and(ye.editorTextFocus,ye.tabDoesNotMoveFocus),primary:2}})}runCoreEditingCommand(d,c,u){d.pushUndoStop(),d.executeCommands(this.id,$r.tab(c.cursorConfig,c.model,c.getCursorStates().map(h=>h.modelState.selection))),d.pushUndoStop()}}),l.DeleteLeft=Ve(new class extends o{constructor(){super({id:"deleteLeft",precondition:void 0,kbOpts:{weight:tt,kbExpr:ye.textInputFocus,primary:1,secondary:[1025],mac:{primary:1,secondary:[1025,294,257]}}})}runCoreEditingCommand(d,c,u){let[h,m]=Ta.deleteLeft(c.getPrevEditOperationType(),c.cursorConfig,c.model,c.getCursorStates().map(f=>f.modelState.selection),c.getCursorAutoClosedCharacters());h&&d.pushUndoStop(),d.executeCommands(this.id,m),c.setPrevEditOperationType(2)}}),l.DeleteRight=Ve(new class extends o{constructor(){super({id:"deleteRight",precondition:void 0,kbOpts:{weight:tt,kbExpr:ye.textInputFocus,primary:20,mac:{primary:20,secondary:[290,276]}}})}runCoreEditingCommand(d,c,u){let[h,m]=Ta.deleteRight(c.getPrevEditOperationType(),c.cursorConfig,c.model,c.getCursorStates().map(f=>f.modelState.selection));h&&d.pushUndoStop(),d.executeCommands(this.id,m),c.setPrevEditOperationType(3)}}),l.Undo=new class extends Ng{constructor(){super(HL)}runDOMCommand(d){d.ownerDocument.execCommand("undo")}runEditorCommand(d,c,u){if(!(!c.hasModel()||c.getOption(93)===!0))return c.getModel().undo()}},l.Redo=new class extends Ng{constructor(){super(UL)}runDOMCommand(d){d.ownerDocument.execCommand("redo")}runEditorCommand(d,c,u){if(!(!c.hasModel()||c.getOption(93)===!0))return c.getModel().redo()}}})(A5||={});var aC=class extends ic{_handlerId;constructor(e,t,n){super({id:e,precondition:void 0,metadata:n}),this._handlerId=t}runCommand(e,t){let n=e.get(Nl).getFocusedCodeEditor();n&&n.trigger("keyboard",this._handlerId,t)}};function hc(o,e){PP(new aC("default:"+o,o)),PP(new aC(o,o,e))}hc("type",{description:"Type",args:[{name:"args",schema:{type:"object",required:["text"],properties:{text:{type:"string"}}}}]});hc("replacePreviousChar");hc("compositionType");hc("compositionStart");hc("compositionEnd");hc("paste");hc("cut");var Ph=class o{onKeyDown=null;onKeyUp=null;onContextMenu=null;onMouseMove=null;onMouseLeave=null;onMouseDown=null;onMouseUp=null;onMouseDrag=null;onMouseDrop=null;onMouseDropCanceled=null;onMouseWheel=null;_coordinatesConverter;constructor(e){this._coordinatesConverter=e}emitKeyDown(e){this.onKeyDown?.(e)}emitKeyUp(e){this.onKeyUp?.(e)}emitContextMenu(e){this.onContextMenu?.(this._convertViewToModelMouseEvent(e))}emitMouseMove(e){this.onMouseMove?.(this._convertViewToModelMouseEvent(e))}emitMouseLeave(e){this.onMouseLeave?.(this._convertViewToModelMouseEvent(e))}emitMouseDown(e){this.onMouseDown?.(this._convertViewToModelMouseEvent(e))}emitMouseUp(e){this.onMouseUp?.(this._convertViewToModelMouseEvent(e))}emitMouseDrag(e){this.onMouseDrag?.(this._convertViewToModelMouseEvent(e))}emitMouseDrop(e){this.onMouseDrop?.(this._convertViewToModelMouseEvent(e))}emitMouseDropCanceled(){this.onMouseDropCanceled?.()}emitMouseWheel(e){this.onMouseWheel?.(e)}_convertViewToModelMouseEvent(e){return e.target?{event:e.event,target:this._convertViewToModelMouseTarget(e.target)}:e}_convertViewToModelMouseTarget(e){return o.convertViewToModelMouseTarget(e,this._coordinatesConverter)}static convertViewToModelMouseTarget(e,t){let n={...e};return n.position&&(n.position=t.convertViewPositionToModelPosition(n.position)),n.range&&(n.range=t.convertViewRangeToModelRange(n.range)),(n.type===5||n.type===8)&&(n.detail=this.convertViewToModelViewZoneData(n.detail,t)),n}static convertViewToModelViewZoneData(e,t){return{viewZoneId:e.viewZoneId,positionBefore:e.positionBefore?t.convertViewPositionToModelPosition(e.positionBefore):e.positionBefore,positionAfter:e.positionAfter?t.convertViewPositionToModelPosition(e.positionAfter):e.positionAfter,position:t.convertViewPositionToModelPosition(e.position),afterLineNumber:t.convertViewPositionToModelPosition(new P(e.afterLineNumber,1)).lineNumber}}};var lC=class{configuration;viewModel;userInputEvents;commandDelegate;constructor(e,t,n,i){this.configuration=e,this.viewModel=t,this.userInputEvents=n,this.commandDelegate=i}paste(e,t,n,i){this.commandDelegate.paste(e,t,n,i)}type(e){this.commandDelegate.type(e)}compositionType(e,t,n,i){this.commandDelegate.compositionType(e,t,n,i)}compositionStart(){this.commandDelegate.startComposition()}compositionEnd(){this.commandDelegate.endComposition()}cut(){this.commandDelegate.cut()}setSelection(e){wn.SetSelection.runCoreEditorCommand(this.viewModel,{source:"keyboard",selection:e})}_validateViewColumn(e){let t=this.viewModel.getLineMinColumn(e.lineNumber);return e.column<t?new P(e.lineNumber,t):e}_hasMulticursorModifier(e){switch(this.configuration.options.get(79)){case"altKey":return e.altKey;case"ctrlKey":return e.ctrlKey;case"metaKey":return e.metaKey;default:return!1}}_hasNonMulticursorModifier(e){switch(this.configuration.options.get(79)){case"altKey":return e.ctrlKey||e.metaKey;case"ctrlKey":return e.altKey||e.metaKey;case"metaKey":return e.ctrlKey||e.altKey;default:return!1}}dispatchMouse(e){let t=this.configuration.options,n=Wt&&t.get(109),i=t.get(22);e.middleButton&&!n?this._columnSelect(e.position,e.mouseColumn,e.inSelectionMode):e.startedOnLineNumbers?this._hasMulticursorModifier(e)?e.inSelectionMode?this._lastCursorLineSelect(e.position,e.revealType):this._createCursor(e.position,!0):e.inSelectionMode?this._lineSelectDrag(e.position,e.revealType):this._lineSelect(e.position,e.revealType):e.mouseDownCount>=4?this._selectAll():e.mouseDownCount===3?this._hasMulticursorModifier(e)?e.inSelectionMode?this._lastCursorLineSelectDrag(e.position,e.revealType):this._lastCursorLineSelect(e.position,e.revealType):e.inSelectionMode?this._lineSelectDrag(e.position,e.revealType):this._lineSelect(e.position,e.revealType):e.mouseDownCount===2?e.onInjectedText||(this._hasMulticursorModifier(e)?this._lastCursorWordSelect(e.position,e.revealType):e.inSelectionMode?this._wordSelectDrag(e.position,e.revealType):this._wordSelect(e.position,e.revealType)):this._hasMulticursorModifier(e)?this._hasNonMulticursorModifier(e)||(e.shiftKey?this._columnSelect(e.position,e.mouseColumn,!0):e.inSelectionMode?this._lastCursorMoveToSelect(e.position,e.revealType):this._createCursor(e.position,!1)):e.inSelectionMode?e.altKey?this._columnSelect(e.position,e.mouseColumn,!0):i?this._columnSelect(e.position,e.mouseColumn,!0):this._moveToSelect(e.position,e.revealType):this.moveTo(e.position,e.revealType)}_usualArgs(e,t){return e=this._validateViewColumn(e),{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,revealType:t}}moveTo(e,t){wn.MoveTo.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_moveToSelect(e,t){wn.MoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_columnSelect(e,t,n){e=this._validateViewColumn(e),wn.ColumnSelect.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,mouseColumn:t,doColumnSelect:n})}_createCursor(e,t){e=this._validateViewColumn(e),wn.CreateCursor.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,wholeLine:t})}_lastCursorMoveToSelect(e,t){wn.LastCursorMoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_wordSelect(e,t){wn.WordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_wordSelectDrag(e,t){wn.WordSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lastCursorWordSelect(e,t){wn.LastCursorWordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lineSelect(e,t){wn.LineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lineSelectDrag(e,t){wn.LineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lastCursorLineSelect(e,t){wn.LastCursorLineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lastCursorLineSelectDrag(e,t){wn.LastCursorLineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_selectAll(){wn.SelectAll.runCoreEditorCommand(this.viewModel,{source:"mouse"})}_convertViewToModelPosition(e){return this.viewModel.coordinatesConverter.convertViewPositionToModelPosition(e)}emitKeyDown(e){this.userInputEvents.emitKeyDown(e)}emitKeyUp(e){this.userInputEvents.emitKeyUp(e)}emitContextMenu(e){this.userInputEvents.emitContextMenu(e)}emitMouseMove(e){this.userInputEvents.emitMouseMove(e)}emitMouseLeave(e){this.userInputEvents.emitMouseLeave(e)}emitMouseUp(e){this.userInputEvents.emitMouseUp(e)}emitMouseDown(e){this.userInputEvents.emitMouseDown(e)}emitMouseDrag(e){this.userInputEvents.emitMouseDrag(e)}emitMouseDrop(e){this.userInputEvents.emitMouseDrop(e)}emitMouseDropCanceled(){this.userInputEvents.emitMouseDropCanceled()}emitMouseWheel(e){this.userInputEvents.emitMouseWheel(e)}};var On=class extends V{onclick(e,t){this._register(U(e,ae.CLICK,n=>t(new hi(Ie(e),n))))}onmousedown(e,t){this._register(U(e,ae.MOUSE_DOWN,n=>t(new hi(Ie(e),n))))}onmouseover(e,t){this._register(U(e,ae.MOUSE_OVER,n=>t(new hi(Ie(e),n))))}onmouseleave(e,t){this._register(U(e,ae.MOUSE_LEAVE,n=>t(new hi(Ie(e),n))))}onkeydown(e,t){this._register(U(e,ae.KEY_DOWN,n=>t(new nt(n))))}onkeyup(e,t){this._register(U(e,ae.KEY_UP,n=>t(new nt(n))))}oninput(e,t){this._register(U(e,ae.INPUT,t))}onblur(e,t){this._register(U(e,ae.BLUR,t))}onfocus(e,t){this._register(U(e,ae.FOCUS,t))}onchange(e,t){this._register(U(e,ae.CHANGE,t))}ignoreGesture(e){return Yt.ignoreTarget(e)}};var Bl=11,dC=class extends On{_onActivate;bgDomNode;domNode;_pointerdownRepeatTimer;_pointerdownScheduleRepeatTimer;_pointerMoveMonitor;constructor(e){super(),this._onActivate=e.onActivate,this.bgDomNode=document.createElement("div"),this.bgDomNode.className="arrow-background",this.bgDomNode.style.position="absolute",this.bgDomNode.style.width=e.bgWidth+"px",this.bgDomNode.style.height=e.bgHeight+"px",typeof e.top<"u"&&(this.bgDomNode.style.top="0px"),typeof e.left<"u"&&(this.bgDomNode.style.left="0px"),typeof e.bottom<"u"&&(this.bgDomNode.style.bottom="0px"),typeof e.right<"u"&&(this.bgDomNode.style.right="0px"),this.domNode=document.createElement("div"),this.domNode.className=e.className,this.domNode.classList.add(...Je.asClassNameArray(e.icon)),this.domNode.style.position="absolute",this.domNode.style.width=Bl+"px",this.domNode.style.height=Bl+"px",typeof e.top<"u"&&(this.domNode.style.top=e.top+"px"),typeof e.left<"u"&&(this.domNode.style.left=e.left+"px"),typeof e.bottom<"u"&&(this.domNode.style.bottom=e.bottom+"px"),typeof e.right<"u"&&(this.domNode.style.right=e.right+"px"),this._pointerMoveMonitor=this._register(new Bs),this._register(Jt(this.bgDomNode,ae.POINTER_DOWN,t=>this._arrowPointerDown(t))),this._register(Jt(this.domNode,ae.POINTER_DOWN,t=>this._arrowPointerDown(t))),this._pointerdownRepeatTimer=this._register(new tu),this._pointerdownScheduleRepeatTimer=this._register(new Er)}_arrowPointerDown(e){if(!e.target||!(e.target instanceof Element))return;let t=()=>{this._pointerdownRepeatTimer.cancelAndSet(()=>this._onActivate(),1e3/24,Ie(e))};this._onActivate(),this._pointerdownRepeatTimer.cancel(),this._pointerdownScheduleRepeatTimer.cancelAndSet(t,200),this._pointerMoveMonitor.startMonitoring(e.target,e.pointerId,e.buttons,n=>{},()=>{this._pointerdownRepeatTimer.cancel(),this._pointerdownScheduleRepeatTimer.cancel()}),e.preventDefault()}};var Fh=class o{_scrollbarSize;_oppositeScrollbarSize;_arrowSize;_visibleSize;_scrollSize;_scrollPosition;_computedAvailableSize;_computedIsNeeded;_computedSliderSize;_computedSliderRatio;_computedSliderPosition;constructor(e,t,n,i,r,s){this._scrollbarSize=Math.round(t),this._oppositeScrollbarSize=Math.round(n),this._arrowSize=Math.round(e),this._visibleSize=i,this._scrollSize=r,this._scrollPosition=s,this._computedAvailableSize=0,this._computedIsNeeded=!1,this._computedSliderSize=0,this._computedSliderRatio=0,this._computedSliderPosition=0,this._refreshComputedValues()}clone(){return new o(this._arrowSize,this._scrollbarSize,this._oppositeScrollbarSize,this._visibleSize,this._scrollSize,this._scrollPosition)}setVisibleSize(e){let t=Math.round(e);return this._visibleSize!==t?(this._visibleSize=t,this._refreshComputedValues(),!0):!1}setScrollSize(e){let t=Math.round(e);return this._scrollSize!==t?(this._scrollSize=t,this._refreshComputedValues(),!0):!1}setScrollPosition(e){let t=Math.round(e);return this._scrollPosition!==t?(this._scrollPosition=t,this._refreshComputedValues(),!0):!1}setScrollbarSize(e){this._scrollbarSize=Math.round(e)}setOppositeScrollbarSize(e){this._oppositeScrollbarSize=Math.round(e)}static _computeValues(e,t,n,i,r){let s=Math.max(0,n-e),a=Math.max(0,s-2*t),l=i>0&&i>n;if(!l)return{computedAvailableSize:Math.round(s),computedIsNeeded:l,computedSliderSize:Math.round(a),computedSliderRatio:0,computedSliderPosition:0};let d=Math.round(Math.max(20,Math.floor(n*a/i))),c=(a-d)/(i-n),u=r*c;return{computedAvailableSize:Math.round(s),computedIsNeeded:l,computedSliderSize:Math.round(d),computedSliderRatio:c,computedSliderPosition:Math.round(u)}}_refreshComputedValues(){let e=o._computeValues(this._oppositeScrollbarSize,this._arrowSize,this._visibleSize,this._scrollSize,this._scrollPosition);this._computedAvailableSize=e.computedAvailableSize,this._computedIsNeeded=e.computedIsNeeded,this._computedSliderSize=e.computedSliderSize,this._computedSliderRatio=e.computedSliderRatio,this._computedSliderPosition=e.computedSliderPosition}getArrowSize(){return this._arrowSize}getScrollPosition(){return this._scrollPosition}getRectangleLargeSize(){return this._computedAvailableSize}getRectangleSmallSize(){return this._scrollbarSize}isNeeded(){return this._computedIsNeeded}getSliderSize(){return this._computedSliderSize}getSliderPosition(){return this._computedSliderPosition}getDesiredScrollPositionFromOffset(e){if(!this._computedIsNeeded)return 0;let t=e-this._arrowSize-this._computedSliderSize/2;return Math.round(t/this._computedSliderRatio)}getDesiredScrollPositionFromOffsetPaged(e){if(!this._computedIsNeeded)return 0;let t=e-this._arrowSize,n=this._scrollPosition;return t<this._computedSliderPosition?n-=this._visibleSize:n+=this._visibleSize,n}getDesiredScrollPositionFromDelta(e){if(!this._computedIsNeeded)return 0;let t=this._computedSliderPosition+e;return Math.round(t/this._computedSliderRatio)}};var cC=class extends V{_visibility;_visibleClassName;_invisibleClassName;_domNode;_rawShouldBeVisible;_shouldBeVisible;_isNeeded;_isVisible;_revealTimer;constructor(e,t,n){super(),this._visibility=e,this._visibleClassName=t,this._invisibleClassName=n,this._domNode=null,this._isVisible=!1,this._isNeeded=!1,this._rawShouldBeVisible=!1,this._shouldBeVisible=!1,this._revealTimer=this._register(new Er)}setVisibility(e){this._visibility!==e&&(this._visibility=e,this._updateShouldBeVisible())}setShouldBeVisible(e){this._rawShouldBeVisible=e,this._updateShouldBeVisible()}_applyVisibilitySetting(){return this._visibility===2?!1:this._visibility===3?!0:this._rawShouldBeVisible}_updateShouldBeVisible(){let e=this._applyVisibilitySetting();this._shouldBeVisible!==e&&(this._shouldBeVisible=e,this.ensureVisibility())}setIsNeeded(e){this._isNeeded!==e&&(this._isNeeded=e,this.ensureVisibility())}setDomNode(e){this._domNode=e,this._domNode.setClassName(this._invisibleClassName),this.setShouldBeVisible(!1)}ensureVisibility(){if(!this._isNeeded){this._hide(!1);return}this._shouldBeVisible?this._reveal():this._hide(!0)}_reveal(){this._isVisible||(this._isVisible=!0,this._revealTimer.setIfNotSet(()=>{this._domNode?.setClassName(this._visibleClassName)},0))}_hide(e){this._revealTimer.cancel(),this._isVisible&&(this._isVisible=!1,this._domNode?.setClassName(this._invisibleClassName+(e?" fade":"")))}};var O5=140,Bh=class extends On{_host;_scrollable;_scrollByPage;_lazyRender;_scrollbarState;_visibilityController;_pointerMoveMonitor;domNode;slider;_shouldRender;constructor(e){super(),this._lazyRender=e.lazyRender,this._host=e.host,this._scrollable=e.scrollable,this._scrollByPage=e.scrollByPage,this._scrollbarState=e.scrollbarState,this._visibilityController=this._register(new cC(e.visibility,"visible scrollbar "+e.extraScrollbarClassName,"invisible scrollbar "+e.extraScrollbarClassName)),this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._pointerMoveMonitor=this._register(new Bs),this._shouldRender=!0,this.domNode=Oe(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this._visibilityController.setDomNode(this.domNode),this.domNode.setPosition("absolute"),this._register(U(this.domNode.domNode,ae.POINTER_DOWN,t=>this._domNodePointerDown(t)))}_createArrow(e){let t=this._register(new dC(e));this.domNode.domNode.appendChild(t.bgDomNode),this.domNode.domNode.appendChild(t.domNode)}_createSlider(e,t,n,i){this.slider=Oe(document.createElement("div")),this.slider.setClassName("slider"),this.slider.setPosition("absolute"),this.slider.setTop(e),this.slider.setLeft(t),typeof n=="number"&&this.slider.setWidth(n),typeof i=="number"&&this.slider.setHeight(i),this.slider.setLayerHinting(!0),this.slider.setContain("strict"),this.domNode.domNode.appendChild(this.slider.domNode),this._register(U(this.slider.domNode,ae.POINTER_DOWN,r=>{r.button===0&&(r.preventDefault(),this._sliderPointerDown(r))})),this.onclick(this.slider.domNode,r=>{r.leftButton&&r.stopPropagation()})}_onElementSize(e){return this._scrollbarState.setVisibleSize(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollSize(e){return this._scrollbarState.setScrollSize(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollPosition(e){return this._scrollbarState.setScrollPosition(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}beginReveal(){this._visibilityController.setShouldBeVisible(!0)}beginHide(){this._visibilityController.setShouldBeVisible(!1)}render(){this._shouldRender&&(this._shouldRender=!1,this._renderDomNode(this._scrollbarState.getRectangleLargeSize(),this._scrollbarState.getRectangleSmallSize()),this._updateSlider(this._scrollbarState.getSliderSize(),this._scrollbarState.getArrowSize()+this._scrollbarState.getSliderPosition()))}_domNodePointerDown(e){e.target===this.domNode.domNode&&this._onPointerDown(e)}delegatePointerDown(e){let t=this.domNode.domNode.getClientRects()[0].top,n=t+this._scrollbarState.getSliderPosition(),i=t+this._scrollbarState.getSliderPosition()+this._scrollbarState.getSliderSize(),r=this._sliderPointerPosition(e);n<=r&&r<=i?e.button===0&&(e.preventDefault(),this._sliderPointerDown(e)):this._onPointerDown(e)}_onPointerDown(e){let t,n;if(e.target===this.domNode.domNode&&typeof e.offsetX=="number"&&typeof e.offsetY=="number")t=e.offsetX,n=e.offsetY;else{let r=yo(this.domNode.domNode);t=e.pageX-r.left,n=e.pageY-r.top}let i=this._pointerDownRelativePosition(t,n);this._setDesiredScrollPositionNow(this._scrollByPage?this._scrollbarState.getDesiredScrollPositionFromOffsetPaged(i):this._scrollbarState.getDesiredScrollPositionFromOffset(i)),e.button===0&&(e.preventDefault(),this._sliderPointerDown(e))}_sliderPointerDown(e){if(!e.target||!(e.target instanceof Element))return;let t=this._sliderPointerPosition(e),n=this._sliderOrthogonalPointerPosition(e),i=this._scrollbarState.clone();this.slider.toggleClassName("active",!0),this._pointerMoveMonitor.startMonitoring(e.target,e.pointerId,e.buttons,r=>{let s=this._sliderOrthogonalPointerPosition(r),a=Math.abs(s-n);if(mt&&a>O5){this._setDesiredScrollPositionNow(i.getScrollPosition());return}let d=this._sliderPointerPosition(r)-t;this._setDesiredScrollPositionNow(i.getDesiredScrollPositionFromDelta(d))},()=>{this.slider.toggleClassName("active",!1),this._host.onDragEnd()}),this._host.onDragStart()}_setDesiredScrollPositionNow(e){let t={};this.writeScrollPosition(t,e),this._scrollable.setScrollPositionNow(t)}updateScrollbarSize(e){this._updateScrollbarSize(e),this._scrollbarState.setScrollbarSize(e),this._shouldRender=!0,this._lazyRender||this.render()}isNeeded(){return this._scrollbarState.isNeeded()}};var uC=class extends Bh{constructor(e,t,n){let i=e.getScrollDimensions(),r=e.getCurrentScrollPosition();if(super({lazyRender:t.lazyRender,host:n,scrollbarState:new Fh(t.horizontalHasArrows?t.arrowSize:0,t.horizontal===2?0:t.horizontalScrollbarSize,t.vertical===2?0:t.verticalScrollbarSize,i.width,i.scrollWidth,r.scrollLeft),visibility:t.horizontal,extraScrollbarClassName:"horizontal",scrollable:e,scrollByPage:t.scrollByPage}),t.horizontalHasArrows){let s=(t.arrowSize-Bl)/2,a=(t.horizontalScrollbarSize-Bl)/2;this._createArrow({className:"scra",icon:ge.scrollbarButtonLeft,top:a,left:s,bottom:void 0,right:void 0,bgWidth:t.arrowSize,bgHeight:t.horizontalScrollbarSize,onActivate:()=>this._host.onMouseWheel(new Vo(null,1,0))}),this._createArrow({className:"scra",icon:ge.scrollbarButtonRight,top:a,left:void 0,bottom:void 0,right:s,bgWidth:t.arrowSize,bgHeight:t.horizontalScrollbarSize,onActivate:()=>this._host.onMouseWheel(new Vo(null,-1,0))})}this._createSlider(Math.floor((t.horizontalScrollbarSize-t.horizontalSliderSize)/2),0,void 0,t.horizontalSliderSize)}_updateSlider(e,t){this.slider.setWidth(e),this.slider.setLeft(t)}_renderDomNode(e,t){this.domNode.setWidth(e),this.domNode.setHeight(t),this.domNode.setLeft(0),this.domNode.setBottom(0)}onDidScroll(e){return this._shouldRender=this._onElementScrollSize(e.scrollWidth)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(e.scrollLeft)||this._shouldRender,this._shouldRender=this._onElementSize(e.width)||this._shouldRender,this._shouldRender}_pointerDownRelativePosition(e,t){return e}_sliderPointerPosition(e){return e.pageX}_sliderOrthogonalPointerPosition(e){return e.pageY}_updateScrollbarSize(e){this.slider.setHeight(e)}writeScrollPosition(e,t){e.scrollLeft=t}updateOptions(e){this.updateScrollbarSize(e.horizontal===2?0:e.horizontalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(e.vertical===2?0:e.verticalScrollbarSize),this._visibilityController.setVisibility(e.horizontal),this._scrollByPage=e.scrollByPage}};var hC=class extends Bh{constructor(e,t,n){let i=e.getScrollDimensions(),r=e.getCurrentScrollPosition();if(super({lazyRender:t.lazyRender,host:n,scrollbarState:new Fh(t.verticalHasArrows?t.arrowSize:0,t.vertical===2?0:t.verticalScrollbarSize,0,i.height,i.scrollHeight,r.scrollTop),visibility:t.vertical,extraScrollbarClassName:"vertical",scrollable:e,scrollByPage:t.scrollByPage}),t.verticalHasArrows){let s=(t.arrowSize-Bl)/2,a=(t.verticalScrollbarSize-Bl)/2;this._createArrow({className:"scra",icon:ge.scrollbarButtonUp,top:s,left:a,bottom:void 0,right:void 0,bgWidth:t.verticalScrollbarSize,bgHeight:t.arrowSize,onActivate:()=>this._host.onMouseWheel(new Vo(null,0,1))}),this._createArrow({className:"scra",icon:ge.scrollbarButtonDown,top:void 0,left:a,bottom:s,right:void 0,bgWidth:t.verticalScrollbarSize,bgHeight:t.arrowSize,onActivate:()=>this._host.onMouseWheel(new Vo(null,0,-1))})}this._createSlider(0,Math.floor((t.verticalScrollbarSize-t.verticalSliderSize)/2),t.verticalSliderSize,void 0)}_updateSlider(e,t){this.slider.setHeight(e),this.slider.setTop(t)}_renderDomNode(e,t){this.domNode.setWidth(t),this.domNode.setHeight(e),this.domNode.setRight(0),this.domNode.setTop(0)}onDidScroll(e){return this._shouldRender=this._onElementScrollSize(e.scrollHeight)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(e.scrollTop)||this._shouldRender,this._shouldRender=this._onElementSize(e.height)||this._shouldRender,this._shouldRender}_pointerDownRelativePosition(e,t){return t}_sliderPointerPosition(e){return e.pageY}_sliderOrthogonalPointerPosition(e){return e.pageX}_updateScrollbarSize(e){this.slider.setWidth(e)}writeScrollPosition(e,t){e.scrollTop=t}updateOptions(e){this.updateScrollbarSize(e.vertical===2?0:e.verticalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(0),this._visibilityController.setVisibility(e.vertical),this._scrollByPage=e.scrollByPage}};var N5=500,FP=50,BP=!0,dD=class{timestamp;deltaX;deltaY;score;constructor(e,t,n){this.timestamp=e,this.deltaX=t,this.deltaY=n,this.score=0}},Pg=class o{static INSTANCE=new o;_capacity;_memory;_front;_rear;constructor(){this._capacity=5,this._memory=[],this._front=-1,this._rear=-1}isPhysicalMouseWheel(){if(this._front===-1&&this._rear===-1)return!1;let e=1,t=0,n=1,i=this._rear;do{let r=i===this._front?e:Math.pow(2,-n);if(e-=r,t+=this._memory[i].score*r,i===this._front)break;i=(this._capacity+i-1)%this._capacity,n++}while(!0);return t<=.5}acceptStandardWheelEvent(e){if(Ya){let t=Ie(e.browserEvent),n=mk(t);this.accept(Date.now(),e.deltaX*n,e.deltaY*n)}else this.accept(Date.now(),e.deltaX,e.deltaY)}accept(e,t,n){let i=null,r=new dD(e,t,n);this._front===-1&&this._rear===-1?(this._memory[0]=r,this._front=0,this._rear=0):(i=this._memory[this._rear],this._rear=(this._rear+1)%this._capacity,this._rear===this._front&&(this._front=(this._front+1)%this._capacity),this._memory[this._rear]=r),r.score=this._computeScore(r,i)}_computeScore(e,t){if(Math.abs(e.deltaX)>0&&Math.abs(e.deltaY)>0)return 1;let n=.5;if((!this._isAlmostInt(e.deltaX)||!this._isAlmostInt(e.deltaY))&&(n+=.25),t){let i=Math.abs(e.deltaX),r=Math.abs(e.deltaY),s=Math.abs(t.deltaX),a=Math.abs(t.deltaY),l=Math.max(Math.min(i,s),1),d=Math.max(Math.min(r,a),1),c=Math.max(i,s),u=Math.max(r,a);c%l===0&&u%d===0&&(n-=.5)}return Math.min(Math.max(n,0),1)}_isAlmostInt(e){return Math.abs(Math.round(e)-e)<.01}},Fg=class extends On{_options;_scrollable;_verticalScrollbar;_horizontalScrollbar;_domNode;_leftShadowDomNode;_topShadowDomNode;_topLeftShadowDomNode;_listenOnDomNode;_mouseWheelToDispose;_isDragging;_mouseIsOver;_hideTimeout;_shouldRender;_revealOnScroll;_onScroll=this._register(new E);onScroll=this._onScroll.event;_onWillScroll=this._register(new E);onWillScroll=this._onWillScroll.event;get options(){return this._options}constructor(e,t,n){super(),e.style.overflow="hidden",this._options=P5(t),this._scrollable=n,this._register(this._scrollable.onScroll(r=>{this._onWillScroll.fire(r),this._onDidScroll(r),this._onScroll.fire(r)}));let i={onMouseWheel:r=>this._onMouseWheel(r),onDragStart:()=>this._onDragStart(),onDragEnd:()=>this._onDragEnd()};this._verticalScrollbar=this._register(new hC(this._scrollable,this._options,i)),this._horizontalScrollbar=this._register(new uC(this._scrollable,this._options,i)),this._domNode=document.createElement("div"),this._domNode.className="monaco-scrollable-element "+this._options.className,this._domNode.setAttribute("role","presentation"),this._domNode.style.position="relative",this._domNode.style.overflow="hidden",this._domNode.appendChild(e),this._domNode.appendChild(this._horizontalScrollbar.domNode.domNode),this._domNode.appendChild(this._verticalScrollbar.domNode.domNode),this._options.useShadows?(this._leftShadowDomNode=Oe(document.createElement("div")),this._leftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._leftShadowDomNode.domNode),this._topShadowDomNode=Oe(document.createElement("div")),this._topShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topShadowDomNode.domNode),this._topLeftShadowDomNode=Oe(document.createElement("div")),this._topLeftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topLeftShadowDomNode.domNode)):(this._leftShadowDomNode=null,this._topShadowDomNode=null,this._topLeftShadowDomNode=null),this._listenOnDomNode=this._options.listenOnDomNode||this._domNode,this._mouseWheelToDispose=[],this._setListeningToMouseWheel(this._options.handleMouseWheel),this.onmouseover(this._listenOnDomNode,r=>this._onMouseOver(r)),this.onmouseleave(this._listenOnDomNode,r=>this._onMouseLeave(r)),this._hideTimeout=this._register(new Er),this._isDragging=!1,this._mouseIsOver=!1,this._shouldRender=!0,this._revealOnScroll=!0}dispose(){this._mouseWheelToDispose=kt(this._mouseWheelToDispose),super.dispose()}getDomNode(){return this._domNode}getOverviewRulerLayoutInfo(){return{parent:this._domNode,insertBefore:this._verticalScrollbar.domNode.domNode}}delegateVerticalScrollbarPointerDown(e){this._verticalScrollbar.delegatePointerDown(e)}getScrollDimensions(){return this._scrollable.getScrollDimensions()}setScrollDimensions(e){this._scrollable.setScrollDimensions(e,!1)}updateClassName(e){this._options.className=e,Be&&(this._options.className+=" mac"),this._domNode.className="monaco-scrollable-element "+this._options.className}updateOptions(e){typeof e.handleMouseWheel<"u"&&(this._options.handleMouseWheel=e.handleMouseWheel,this._setListeningToMouseWheel(this._options.handleMouseWheel)),typeof e.mouseWheelScrollSensitivity<"u"&&(this._options.mouseWheelScrollSensitivity=e.mouseWheelScrollSensitivity),typeof e.fastScrollSensitivity<"u"&&(this._options.fastScrollSensitivity=e.fastScrollSensitivity),typeof e.scrollPredominantAxis<"u"&&(this._options.scrollPredominantAxis=e.scrollPredominantAxis),typeof e.horizontal<"u"&&(this._options.horizontal=e.horizontal),typeof e.vertical<"u"&&(this._options.vertical=e.vertical),typeof e.horizontalScrollbarSize<"u"&&(this._options.horizontalScrollbarSize=e.horizontalScrollbarSize),typeof e.verticalScrollbarSize<"u"&&(this._options.verticalScrollbarSize=e.verticalScrollbarSize),typeof e.scrollByPage<"u"&&(this._options.scrollByPage=e.scrollByPage),this._horizontalScrollbar.updateOptions(this._options),this._verticalScrollbar.updateOptions(this._options),this._options.lazyRender||this._render()}setRevealOnScroll(e){this._revealOnScroll=e}delegateScrollFromMouseWheelEvent(e){this._onMouseWheel(new Vo(e))}_setListeningToMouseWheel(e){if(this._mouseWheelToDispose.length>0!==e&&(this._mouseWheelToDispose=kt(this._mouseWheelToDispose),e)){let n=i=>{this._onMouseWheel(new Vo(i))};this._mouseWheelToDispose.push(U(this._listenOnDomNode,ae.MOUSE_WHEEL,n,{passive:!1}))}}_onMouseWheel(e){if(e.browserEvent?.defaultPrevented)return;let t=Pg.INSTANCE;BP&&t.acceptStandardWheelEvent(e);let n=!1;if(e.deltaY||e.deltaX){let r=e.deltaY*this._options.mouseWheelScrollSensitivity,s=e.deltaX*this._options.mouseWheelScrollSensitivity;this._options.scrollPredominantAxis&&(this._options.scrollYToX&&s+r===0?s=r=0:Math.abs(r)>=Math.abs(s)?s=0:r=0),this._options.flipAxes&&([r,s]=[s,r]);let a=!Be&&e.browserEvent&&e.browserEvent.shiftKey;(this._options.scrollYToX||a)&&!s&&(s=r,r=0),e.browserEvent&&e.browserEvent.altKey&&(s=s*this._options.fastScrollSensitivity,r=r*this._options.fastScrollSensitivity);let l=this._scrollable.getFutureScrollPosition(),d={};if(r){let c=FP*r,u=l.scrollTop-(c<0?Math.floor(c):Math.ceil(c));this._verticalScrollbar.writeScrollPosition(d,u)}if(s){let c=FP*s,u=l.scrollLeft-(c<0?Math.floor(c):Math.ceil(c));this._horizontalScrollbar.writeScrollPosition(d,u)}d=this._scrollable.validateScrollPosition(d),(l.scrollLeft!==d.scrollLeft||l.scrollTop!==d.scrollTop)&&(BP&&this._options.mouseWheelSmoothScroll&&t.isPhysicalMouseWheel()?this._scrollable.setScrollPositionSmooth(d):this._scrollable.setScrollPositionNow(d),n=!0)}let i=n;!i&&this._options.alwaysConsumeMouseWheel&&(i=!0),!i&&this._options.consumeMouseWheelIfScrollbarIsNeeded&&(this._verticalScrollbar.isNeeded()||this._horizontalScrollbar.isNeeded())&&(i=!0),i&&(e.preventDefault(),e.stopPropagation())}_onDidScroll(e){this._shouldRender=this._horizontalScrollbar.onDidScroll(e)||this._shouldRender,this._shouldRender=this._verticalScrollbar.onDidScroll(e)||this._shouldRender,this._options.useShadows&&(this._shouldRender=!0),this._revealOnScroll&&this._reveal(),this._options.lazyRender||this._render()}renderNow(){if(!this._options.lazyRender)throw new Error("Please use `lazyRender` together with `renderNow`!");this._render()}_render(){if(this._shouldRender&&(this._shouldRender=!1,this._horizontalScrollbar.render(),this._verticalScrollbar.render(),this._options.useShadows)){let e=this._scrollable.getCurrentScrollPosition(),t=e.scrollTop>0,n=e.scrollLeft>0,i=n?" left":"",r=t?" top":"",s=n||t?" top-left-corner":"";this._leftShadowDomNode.setClassName(`shadow${i}`),this._topShadowDomNode.setClassName(`shadow${r}`),this._topLeftShadowDomNode.setClassName(`shadow${s}${r}${i}`)}}_onDragStart(){this._isDragging=!0,this._reveal()}_onDragEnd(){this._isDragging=!1,this._hide()}_onMouseLeave(e){this._mouseIsOver=!1,this._hide()}_onMouseOver(e){this._mouseIsOver=!0,this._reveal()}_reveal(){this._verticalScrollbar.beginReveal(),this._horizontalScrollbar.beginReveal(),this._scheduleHide()}_hide(){!this._mouseIsOver&&!this._isDragging&&(this._verticalScrollbar.beginHide(),this._horizontalScrollbar.beginHide())}_scheduleHide(){!this._mouseIsOver&&!this._isDragging&&this._hideTimeout.cancelAndSet(()=>this._hide(),N5)}},pC=class extends Fg{constructor(e,t){t=t||{},t.mouseWheelSmoothScroll=!1;let n=new ms({forceIntegerValues:!0,smoothScrollDuration:0,scheduleAtNextAnimationFrame:i=>Fn(Ie(e),i)});super(e,t,n),this._register(n)}setScrollPosition(e){this._scrollable.setScrollPositionNow(e)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}},pc=class extends Fg{constructor(e,t,n){super(e,t,n)}setScrollPosition(e){e.reuseAnimation?this._scrollable.setScrollPositionSmooth(e,e.reuseAnimation):this._scrollable.setScrollPositionNow(e)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}},mc=class extends Fg{_element;constructor(e,t){t=t||{},t.mouseWheelSmoothScroll=!1;let n=new ms({forceIntegerValues:!1,smoothScrollDuration:0,scheduleAtNextAnimationFrame:i=>Fn(Ie(e),i)});super(e,t,n),this._register(n),this._element=e,this._register(this.onScroll(i=>{i.scrollTopChanged&&(this._element.scrollTop=i.scrollTop),i.scrollLeftChanged&&(this._element.scrollLeft=i.scrollLeft)})),this.scanDomNode()}setScrollPosition(e){this._scrollable.setScrollPositionNow(e)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}scanDomNode(){this.setScrollDimensions({width:this._element.clientWidth,scrollWidth:this._element.scrollWidth,height:this._element.clientHeight,scrollHeight:this._element.scrollHeight}),this.setScrollPosition({scrollLeft:this._element.scrollLeft,scrollTop:this._element.scrollTop})}};function P5(o){let e={lazyRender:typeof o.lazyRender<"u"?o.lazyRender:!1,className:typeof o.className<"u"?o.className:"",useShadows:typeof o.useShadows<"u"?o.useShadows:!0,handleMouseWheel:typeof o.handleMouseWheel<"u"?o.handleMouseWheel:!0,flipAxes:typeof o.flipAxes<"u"?o.flipAxes:!1,consumeMouseWheelIfScrollbarIsNeeded:typeof o.consumeMouseWheelIfScrollbarIsNeeded<"u"?o.consumeMouseWheelIfScrollbarIsNeeded:!1,alwaysConsumeMouseWheel:typeof o.alwaysConsumeMouseWheel<"u"?o.alwaysConsumeMouseWheel:!1,scrollYToX:typeof o.scrollYToX<"u"?o.scrollYToX:!1,mouseWheelScrollSensitivity:typeof o.mouseWheelScrollSensitivity<"u"?o.mouseWheelScrollSensitivity:1,fastScrollSensitivity:typeof o.fastScrollSensitivity<"u"?o.fastScrollSensitivity:5,scrollPredominantAxis:typeof o.scrollPredominantAxis<"u"?o.scrollPredominantAxis:!0,mouseWheelSmoothScroll:typeof o.mouseWheelSmoothScroll<"u"?o.mouseWheelSmoothScroll:!0,arrowSize:typeof o.arrowSize<"u"?o.arrowSize:11,listenOnDomNode:typeof o.listenOnDomNode<"u"?o.listenOnDomNode:null,horizontal:typeof o.horizontal<"u"?o.horizontal:1,horizontalScrollbarSize:typeof o.horizontalScrollbarSize<"u"?o.horizontalScrollbarSize:10,horizontalSliderSize:typeof o.horizontalSliderSize<"u"?o.horizontalSliderSize:0,horizontalHasArrows:typeof o.horizontalHasArrows<"u"?o.horizontalHasArrows:!1,vertical:typeof o.vertical<"u"?o.vertical:1,verticalScrollbarSize:typeof o.verticalScrollbarSize<"u"?o.verticalScrollbarSize:10,verticalHasArrows:typeof o.verticalHasArrows<"u"?o.verticalHasArrows:!1,verticalSliderSize:typeof o.verticalSliderSize<"u"?o.verticalSliderSize:0,scrollByPage:typeof o.scrollByPage<"u"?o.scrollByPage:!1};return e.horizontalSliderSize=typeof o.horizontalSliderSize<"u"?o.horizontalSliderSize:e.horizontalScrollbarSize,e.verticalSliderSize=typeof o.verticalSliderSize<"u"?o.verticalSliderSize:e.verticalScrollbarSize,Be&&(e.className+=" mac"),e}var Vh=class extends dr{_context;viewController;viewHelper;mouseTargetFactory;_mouseDownOperation;lastMouseLeaveTime;_height;_mouseLeaveMonitor=null;constructor(e,t,n){super(),this._context=e,this.viewController=t,this.viewHelper=n,this.mouseTargetFactory=new _h(this._context,n),this._mouseDownOperation=this._register(new cD(this._context,this.viewController,this.viewHelper,this.mouseTargetFactory,(s,a)=>this._createMouseTarget(s,a),s=>this._getMouseColumn(s))),this.lastMouseLeaveTime=-1,this._height=this._context.configuration.options.get(147).height;let i=new SI(this.viewHelper.viewDomNode);this._register(i.onContextMenu(this.viewHelper.viewDomNode,s=>this._onContextMenu(s,!0))),this._register(i.onMouseMove(this.viewHelper.viewDomNode,s=>{this._onMouseMove(s),this._mouseLeaveMonitor||(this._mouseLeaveMonitor=U(this.viewHelper.viewDomNode.ownerDocument,"mousemove",a=>{this.viewHelper.viewDomNode.contains(a.target)||this._onMouseLeave(new ur(a,!1,this.viewHelper.viewDomNode))}))})),this._register(i.onMouseUp(this.viewHelper.viewDomNode,s=>this._onMouseUp(s))),this._register(i.onMouseLeave(this.viewHelper.viewDomNode,s=>this._onMouseLeave(s)));let r=0;this._register(i.onPointerDown(this.viewHelper.viewDomNode,(s,a)=>{r=a})),this._register(U(this.viewHelper.viewDomNode,ae.POINTER_UP,s=>{this._mouseDownOperation.onPointerUp()})),this._register(i.onMouseDown(this.viewHelper.viewDomNode,s=>this._onMouseDown(s,r))),this._setupMouseWheelZoomListener(),this._context.addEventHandler(this)}_setupMouseWheelZoomListener(){let e=Pg.INSTANCE,t=0,n=ys.getZoomLevel(),i=!1,r=0,s=l=>{if(this.viewController.emitMouseWheel(l),!this._context.configuration.options.get(77))return;let d=new Vo(l);if(e.acceptStandardWheelEvent(d),e.isPhysicalMouseWheel()){if(a(l)){let c=ys.getZoomLevel(),u=d.deltaY>0?1:-1;ys.setZoomLevel(c+u),d.preventDefault(),d.stopPropagation()}}else Date.now()-t>50&&(n=ys.getZoomLevel(),i=a(l),r=0),t=Date.now(),r+=d.deltaY,i&&(ys.setZoomLevel(n+r/5),d.preventDefault(),d.stopPropagation())};this._register(U(this.viewHelper.viewDomNode,ae.MOUSE_WHEEL,s,{capture:!0,passive:!1}));function a(l){return Be?(l.metaKey||l.ctrlKey)&&!l.shiftKey&&!l.altKey:l.ctrlKey&&!l.metaKey&&!l.shiftKey&&!l.altKey}}dispose(){this._context.removeEventHandler(this),this._mouseLeaveMonitor&&(this._mouseLeaveMonitor.dispose(),this._mouseLeaveMonitor=null),super.dispose()}onConfigurationChanged(e){if(e.hasChanged(147)){let t=this._context.configuration.options.get(147).height;this._height!==t&&(this._height=t,this._mouseDownOperation.onHeightChanged())}return!1}onCursorStateChanged(e){return this._mouseDownOperation.onCursorStateChanged(e),!1}onFocusChanged(e){return!1}getTargetAtClientPoint(e,t){let i=new Cg(e,t).toPageCoordinates(Ie(this.viewHelper.viewDomNode)),r=EI(this.viewHelper.viewDomNode);if(i.y<r.y||i.y>r.y+r.height||i.x<r.x||i.x>r.x+r.width)return null;let s=_I(this.viewHelper.viewDomNode,r,i);return this.mouseTargetFactory.createMouseTarget(this.viewHelper.getLastRenderData(),r,i,s,null)}_createMouseTarget(e,t){let n=e.target;if(!this.viewHelper.viewDomNode.contains(n)){let i=ol(this.viewHelper.viewDomNode);i&&(n=i.elementsFromPoint(e.posx,e.posy).find(r=>this.viewHelper.viewDomNode.contains(r)))}return this.mouseTargetFactory.createMouseTarget(this.viewHelper.getLastRenderData(),e.editorPos,e.pos,e.relativePos,t?n:null)}_getMouseColumn(e){return this.mouseTargetFactory.getMouseColumn(e.relativePos)}_onContextMenu(e,t){this.viewController.emitContextMenu({event:e,target:this._createMouseTarget(e,t)})}_onMouseMove(e){this.mouseTargetFactory.mouseTargetIsWidget(e)||e.preventDefault(),!(this._mouseDownOperation.isActive()||e.timestamp<this.lastMouseLeaveTime)&&this.viewController.emitMouseMove({event:e,target:this._createMouseTarget(e,!0)})}_onMouseLeave(e){this._mouseLeaveMonitor&&(this._mouseLeaveMonitor.dispose(),this._mouseLeaveMonitor=null),this.lastMouseLeaveTime=new Date().getTime(),this.viewController.emitMouseLeave({event:e,target:null})}_onMouseUp(e){this.viewController.emitMouseUp({event:e,target:this._createMouseTarget(e,!0)})}_onMouseDown(e,t){let n=this._createMouseTarget(e,!0),i=n.type===6||n.type===7,r=n.type===2||n.type===3||n.type===4,s=n.type===3,a=this._context.configuration.options.get(111),l=n.type===8||n.type===5,d=n.type===9,c=e.leftButton||e.middleButton;Be&&e.leftButton&&e.ctrlKey&&(c=!1);let u=()=>{e.preventDefault(),this.viewHelper.focusTextArea()};if(c&&(i||s&&a))u(),this._mouseDownOperation.start(n.type,e,t);else if(r)e.preventDefault();else if(l){let h=n.detail;c&&this.viewHelper.shouldSuppressMouseDownOnViewZone(h.viewZoneId)&&(u(),this._mouseDownOperation.start(n.type,e,t),e.preventDefault())}else d&&this.viewHelper.shouldSuppressMouseDownOnWidget(n.detail)&&(u(),e.preventDefault());this.viewController.emitMouseDown({event:e,target:n})}_onMouseWheel(e){this.viewController.emitMouseWheel(e)}},cD=class extends V{constructor(t,n,i,r,s,a){super();this._context=t;this._viewController=n;this._viewHelper=i;this._mouseTargetFactory=r;this._createMouseTarget=s,this._getMouseColumn=a,this._mouseMoveMonitor=this._register(new xI(this._viewHelper.viewDomNode)),this._topBottomDragScrolling=this._register(new uD(this._context,this._viewHelper,this._mouseTargetFactory,(l,d,c)=>this._dispatchMouse(l,d,c))),this._mouseState=new pD,this._currentSelection=new He(1,1,1,1),this._isActive=!1,this._lastMouseEvent=null}_createMouseTarget;_getMouseColumn;_mouseMoveMonitor;_topBottomDragScrolling;_mouseState;_currentSelection;_isActive;_lastMouseEvent;dispose(){super.dispose()}isActive(){return this._isActive}_onMouseDownThenMove(t){this._lastMouseEvent=t,this._mouseState.setModifiers(t);let n=this._findMousePosition(t,!1);n&&(this._mouseState.isDragAndDrop?this._viewController.emitMouseDrag({event:t,target:n}):n.type===13&&(n.outsidePosition==="above"||n.outsidePosition==="below")?this._topBottomDragScrolling.start(n,t):(this._topBottomDragScrolling.stop(),this._dispatchMouse(n,!0,1)))}start(t,n,i){this._lastMouseEvent=n,this._mouseState.setStartedOnLineNumbers(t===3),this._mouseState.setStartButtons(n),this._mouseState.setModifiers(n);let r=this._findMousePosition(n,!0);if(!r||!r.position)return;this._mouseState.trySetCount(n.detail,r.position),n.detail=this._mouseState.count;let s=this._context.configuration.options;if(!s.get(93)&&s.get(35)&&!s.get(22)&&!this._mouseState.altKey&&n.detail<2&&!this._isActive&&!this._currentSelection.isEmpty()&&r.type===6&&r.position&&this._currentSelection.containsPosition(r.position)){this._mouseState.isDragAndDrop=!0,this._isActive=!0,this._mouseMoveMonitor.startMonitoring(this._viewHelper.viewLinesDomNode,i,n.buttons,a=>this._onMouseDownThenMove(a),a=>{let l=this._findMousePosition(this._lastMouseEvent,!1);Xx(a)?this._viewController.emitMouseDropCanceled():this._viewController.emitMouseDrop({event:this._lastMouseEvent,target:l?this._createMouseTarget(this._lastMouseEvent,!0):null}),this._stop()});return}this._mouseState.isDragAndDrop=!1,this._dispatchMouse(r,n.shiftKey,1),this._isActive||(this._isActive=!0,this._mouseMoveMonitor.startMonitoring(this._viewHelper.viewLinesDomNode,i,n.buttons,a=>this._onMouseDownThenMove(a),()=>this._stop()))}_stop(){this._isActive=!1,this._topBottomDragScrolling.stop()}onHeightChanged(){this._mouseMoveMonitor.stopMonitoring()}onPointerUp(){this._mouseMoveMonitor.stopMonitoring()}onCursorStateChanged(t){this._currentSelection=t.selections[0]}_getPositionOutsideEditor(t){let n=t.editorPos,i=this._context.viewModel,r=this._context.viewLayout,s=this._getMouseColumn(t);if(t.posy<n.y){let l=n.y-t.posy,d=Math.max(r.getCurrentScrollTop()-l,0),c=Eh.getZoneAtCoord(this._context,d);if(c){let h=this._helpPositionJumpOverViewZone(c);if(h)return Mn.createOutsideEditor(s,h,"above",l)}let u=r.getLineNumberAtVerticalOffset(d);return Mn.createOutsideEditor(s,new P(u,1),"above",l)}if(t.posy>n.y+n.height){let l=t.posy-n.y-n.height,d=r.getCurrentScrollTop()+t.relativePos.y,c=Eh.getZoneAtCoord(this._context,d);if(c){let h=this._helpPositionJumpOverViewZone(c);if(h)return Mn.createOutsideEditor(s,h,"below",l)}let u=r.getLineNumberAtVerticalOffset(d);return Mn.createOutsideEditor(s,new P(u,i.getLineMaxColumn(u)),"below",l)}let a=r.getLineNumberAtVerticalOffset(r.getCurrentScrollTop()+t.relativePos.y);if(t.posx<n.x){let l=n.x-t.posx;return Mn.createOutsideEditor(s,new P(a,1),"left",l)}if(t.posx>n.x+n.width){let l=t.posx-n.x-n.width;return Mn.createOutsideEditor(s,new P(a,i.getLineMaxColumn(a)),"right",l)}return null}_findMousePosition(t,n){let i=this._getPositionOutsideEditor(t);if(i)return i;let r=this._createMouseTarget(t,n);if(!r.position)return null;if(r.type===8||r.type===5){let a=this._helpPositionJumpOverViewZone(r.detail);if(a)return Mn.createViewZone(r.type,r.element,r.mouseColumn,a,r.detail)}return r}_helpPositionJumpOverViewZone(t){let n=new P(this._currentSelection.selectionStartLineNumber,this._currentSelection.selectionStartColumn),i=t.positionBefore,r=t.positionAfter;return i&&r?i.isBefore(n)?i:r:null}_dispatchMouse(t,n,i){t.position&&this._viewController.dispatchMouse({position:t.position,mouseColumn:t.mouseColumn,startedOnLineNumbers:this._mouseState.startedOnLineNumbers,revealType:i,inSelectionMode:n,mouseDownCount:this._mouseState.count,altKey:this._mouseState.altKey,ctrlKey:this._mouseState.ctrlKey,metaKey:this._mouseState.metaKey,shiftKey:this._mouseState.shiftKey,leftButton:this._mouseState.leftButton,middleButton:this._mouseState.middleButton,onInjectedText:t.type===6&&t.detail.injectedText!==null})}},uD=class extends V{constructor(t,n,i,r){super();this._context=t;this._viewHelper=n;this._mouseTargetFactory=i;this._dispatchMouse=r;this._operation=null}_operation;dispose(){super.dispose(),this.stop()}start(t,n){this._operation?this._operation.setPosition(t,n):this._operation=new hD(this._context,this._viewHelper,this._mouseTargetFactory,this._dispatchMouse,t,n)}stop(){this._operation&&(this._operation.dispose(),this._operation=null)}},hD=class extends V{constructor(t,n,i,r,s,a){super();this._context=t;this._viewHelper=n;this._mouseTargetFactory=i;this._dispatchMouse=r;this._position=s,this._mouseEvent=a,this._lastTime=Date.now(),this._animationFrameDisposable=Fn(Ie(a.browserEvent),()=>this._execute())}_position;_mouseEvent;_lastTime;_animationFrameDisposable;dispose(){this._animationFrameDisposable.dispose(),super.dispose()}setPosition(t,n){this._position=t,this._mouseEvent=n}_tick(){let t=Date.now(),n=t-this._lastTime;return this._lastTime=t,n}_getScrollSpeed(){let t=this._context.configuration.options.get(68),n=this._context.configuration.options.get(147).height/t,i=this._position.outsideDistance/t;return i<=1.5?Math.max(30,n*(1+i)):i<=3?Math.max(60,n*(2+i)):Math.max(200,n*(7+i))}_execute(){let t=this._context.configuration.options.get(68),n=this._getScrollSpeed(),i=this._tick(),r=n*(i/1e3)*t,s=this._position.outsidePosition==="above"?-r:r;this._context.viewModel.viewLayout.deltaScrollNow(0,s),this._viewHelper.renderNow();let a=this._context.viewLayout.getLinesViewportData(),l=this._position.outsidePosition==="above"?a.startLineNumber:a.endLineNumber,d;{let c=EI(this._viewHelper.viewDomNode),u=this._context.configuration.options.get(147).horizontalScrollbarHeight,h=new Pl(this._mouseEvent.pos.x,c.y+c.height-u-.1),m=_I(this._viewHelper.viewDomNode,c,h);d=this._mouseTargetFactory.createMouseTarget(this._viewHelper.getLastRenderData(),c,h,m,null)}(!d.position||d.position.lineNumber!==l)&&(this._position.outsidePosition==="above"?d=Mn.createOutsideEditor(this._position.mouseColumn,new P(l,1),"above",this._position.outsideDistance):d=Mn.createOutsideEditor(this._position.mouseColumn,new P(l,this._context.viewModel.getLineMaxColumn(l)),"below",this._position.outsideDistance)),this._dispatchMouse(d,!0,2),this._animationFrameDisposable=Fn(Ie(d.element),()=>this._execute())}},pD=class o{static CLEAR_MOUSE_DOWN_COUNT_TIME=400;_altKey;get altKey(){return this._altKey}_ctrlKey;get ctrlKey(){return this._ctrlKey}_metaKey;get metaKey(){return this._metaKey}_shiftKey;get shiftKey(){return this._shiftKey}_leftButton;get leftButton(){return this._leftButton}_middleButton;get middleButton(){return this._middleButton}_startedOnLineNumbers;get startedOnLineNumbers(){return this._startedOnLineNumbers}_lastMouseDownPosition;_lastMouseDownPositionEqualCount;_lastMouseDownCount;_lastSetMouseDownCountTime;isDragAndDrop;constructor(){this._altKey=!1,this._ctrlKey=!1,this._metaKey=!1,this._shiftKey=!1,this._leftButton=!1,this._middleButton=!1,this._startedOnLineNumbers=!1,this._lastMouseDownPosition=null,this._lastMouseDownPositionEqualCount=0,this._lastMouseDownCount=0,this._lastSetMouseDownCountTime=0,this.isDragAndDrop=!1}get count(){return this._lastMouseDownCount}setModifiers(e){this._altKey=e.altKey,this._ctrlKey=e.ctrlKey,this._metaKey=e.metaKey,this._shiftKey=e.shiftKey}setStartButtons(e){this._leftButton=e.leftButton,this._middleButton=e.middleButton}setStartedOnLineNumbers(e){this._startedOnLineNumbers=e}trySetCount(e,t){let n=new Date().getTime();n-this._lastSetMouseDownCountTime>o.CLEAR_MOUSE_DOWN_COUNT_TIME&&(e=1),this._lastSetMouseDownCountTime=n,e>this._lastMouseDownCount+1&&(e=this._lastMouseDownCount+1),this._lastMouseDownPosition&&this._lastMouseDownPosition.equals(t)?this._lastMouseDownPositionEqualCount++:this._lastMouseDownPositionEqualCount=1,this._lastMouseDownPosition=t,this._lastMouseDownCount=Math.min(e,this._lastMouseDownPositionEqualCount)}};function mC(o,e,t,n){let i=o.getPlainTextToCopy(e,t,mt),r=o.model.getEOL(),s=t&&e.length===1&&e[0].isEmpty(),a=Array.isArray(i)?i:null,l=Array.isArray(i)?i.join(r):i,d,c=null;if(B5.forceCopyWithSyntaxHighlighting||n&&l.length<65536){let h=o.getRichTextToCopy(e,t);h&&(d=h.html,c=h.mode)}return{isFromEmptySelection:s,multicursorText:a,text:l,html:d,mode:c}}var gc=class o{static INSTANCE=new o;_lastState;constructor(){this._lastState=null}set(e,t){this._lastState={lastCopiedValue:e,data:t}}get(e){return this._lastState&&this._lastState.lastCopiedValue===e?this._lastState.data:(this._lastState=null,null)}},B5={forceCopyWithSyntaxHighlighting:!1};var Wh=class o{static _getPageOfLine(e,t){return Math.floor((e-1)/t)}static _getRangeForPage(e,t){let n=e*t,i=n+1,r=n+t;return new D(i,1,r+1,1)}static fromEditorSelection(e,t,n,i){let s=o._getPageOfLine(t.startLineNumber,n),a=o._getRangeForPage(s,n),l=o._getPageOfLine(t.endLineNumber,n),d=o._getRangeForPage(l,n),c=a.intersectRanges(new D(1,1,t.startLineNumber,t.startColumn));if(i&&e.getValueLengthInRange(c,1)>500){let y=e.modifyPosition(c.getEndPosition(),-500);c=D.fromPositions(y,c.getEndPosition())}let u=e.getValueInRange(c,1),h=e.getLineCount(),m=e.getLineMaxColumn(h),f=d.intersectRanges(new D(t.endLineNumber,t.endColumn,h,m));if(i&&e.getValueLengthInRange(f,1)>500){let y=e.modifyPosition(f.getStartPosition(),500);f=D.fromPositions(f.getStartPosition(),y)}let g=e.getValueInRange(f,1),b;if(s===l||s+1===l)b=e.getValueInRange(t,1);else{let y=a.intersectRanges(t),C=d.intersectRanges(t);b=e.getValueInRange(y,1)+"\u2026"+e.getValueInRange(C,1)}return i&&b.length>2*500&&(b=b.substring(0,500)+"\u2026"+b.substring(b.length-500,b.length)),{value:u+b+g,selection:t,selectionStart:u.length,selectionEnd:u.length+b.length,newlineCountBeforeSelection:c.endLineNumber-c.startLineNumber}}};function Bg(o,e){if(o.get(2)===1){let n=e.lookupKeybinding("editor.action.toggleScreenReaderAccessibilityMode")?.getAriaLabel(),i=e.lookupKeybinding("workbench.action.showCommands")?.getAriaLabel(),r=e.lookupKeybinding("workbench.action.openGlobalKeybindings")?.getAriaLabel(),s=p("accessibilityModeOff","The editor is not accessible at this time.");return n?p("accessibilityOffAriaLabel","{0} To enable screen reader optimized mode, use {1}",s,n):i?p("accessibilityOffAriaLabelNoKb","{0} To enable screen reader optimized mode, open the quick pick with {1} and run the command Toggle Screen Reader Accessibility Mode, which is currently not triggerable via keyboard.",s,i):r?p("accessibilityOffAriaLabelNoKbs","{0} Please assign a keybinding for the command Toggle Screen Reader Accessibility Mode by accessing the keybindings editor with {1} and run it.",s,r):s}return o.get(4)}function Vg(o){let e=0,t=-1;do{if(t=o.indexOf(`
`,t+1),t===-1)break;e++}while(!0);return e}var uo=!1,Nn=class o{constructor(e,t,n,i,r){this.value=e;this.selectionStart=t;this.selectionEnd=n;this.selection=i;this.newlineCountBeforeSelection=r}static EMPTY=new o("",0,0,null,void 0);toString(){return`[ <${this.value}>, selectionStart: ${this.selectionStart}, selectionEnd: ${this.selectionEnd}]`}static readFromTextArea(e,t){let n=e.getValue(),i=e.getSelectionStart(),r=e.getSelectionEnd(),s;if(t){let a=n.substring(0,i),l=t.value.substring(0,t.selectionStart);a===l&&(s=t.newlineCountBeforeSelection)}return new o(n,i,r,null,s)}collapseSelection(){return this.selectionStart===this.value.length?this:new o(this.value,this.value.length,this.value.length,null,void 0)}writeToTextArea(e,t,n){uo&&console.log(`writeToTextArea ${e}: ${this.toString()}`),t.setValue(e,this.value),n&&t.setSelectionRange(e,this.selectionStart,this.selectionEnd)}deduceEditorPosition(e){if(e<=this.selectionStart){let i=this.value.substring(e,this.selectionStart);return this._finishDeduceEditorPosition(this.selection?.getStartPosition()??null,i,-1)}if(e>=this.selectionEnd){let i=this.value.substring(this.selectionEnd,e);return this._finishDeduceEditorPosition(this.selection?.getEndPosition()??null,i,1)}let t=this.value.substring(this.selectionStart,e);if(t.indexOf("\u2026")===-1)return this._finishDeduceEditorPosition(this.selection?.getStartPosition()??null,t,1);let n=this.value.substring(e,this.selectionEnd);return this._finishDeduceEditorPosition(this.selection?.getEndPosition()??null,n,-1)}_finishDeduceEditorPosition(e,t,n){let i=0,r=-1;for(;(r=t.indexOf(`
`,r+1))!==-1;)i++;return[e,n*t.length,i]}static deduceInput(e,t,n){if(!e)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0};uo&&(console.log("------------------------deduceInput"),console.log(`PREVIOUS STATE: ${e.toString()}`),console.log(`CURRENT STATE: ${t.toString()}`));let i=Math.min(Wp(e.value,t.value),e.selectionStart,t.selectionStart),r=Math.min(Hp(e.value,t.value),e.value.length-e.selectionEnd,t.value.length-t.selectionEnd),s=e.value.substring(i,e.value.length-r),a=t.value.substring(i,t.value.length-r),l=e.selectionStart-i,d=e.selectionEnd-i,c=t.selectionStart-i,u=t.selectionEnd-i;if(uo&&(console.log(`AFTER DIFFING PREVIOUS STATE: <${s}>, selectionStart: ${l}, selectionEnd: ${d}`),console.log(`AFTER DIFFING CURRENT STATE: <${a}>, selectionStart: ${c}, selectionEnd: ${u}`)),c===u){let m=e.selectionStart-i;return uo&&console.log(`REMOVE PREVIOUS: ${m} chars`),{text:a,replacePrevCharCnt:m,replaceNextCharCnt:0,positionDelta:0}}let h=d-l;return{text:a,replacePrevCharCnt:h,replaceNextCharCnt:0,positionDelta:0}}static deduceAndroidCompositionInput(e,t){if(!e)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0};if(uo&&(console.log("------------------------deduceAndroidCompositionInput"),console.log(`PREVIOUS STATE: ${e.toString()}`),console.log(`CURRENT STATE: ${t.toString()}`)),e.value===t.value)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:t.selectionEnd-e.selectionEnd};let n=Math.min(Wp(e.value,t.value),e.selectionEnd),i=Math.min(Hp(e.value,t.value),e.value.length-e.selectionEnd),r=e.value.substring(n,e.value.length-i),s=t.value.substring(n,t.value.length-i),a=e.selectionStart-n,l=e.selectionEnd-n,d=t.selectionStart-n,c=t.selectionEnd-n;return uo&&(console.log(`AFTER DIFFING PREVIOUS STATE: <${r}>, selectionStart: ${a}, selectionEnd: ${l}`),console.log(`AFTER DIFFING CURRENT STATE: <${s}>, selectionStart: ${d}, selectionEnd: ${c}`)),{text:s,replacePrevCharCnt:l,replaceNextCharCnt:r.length-l,positionDelta:c-s.length}}static fromScreenReaderContentState(e){return new o(e.value,e.selectionStart,e.selectionEnd,e.selection,e.newlineCountBeforeSelection)}};var fC;(e=>e.Tap="-monaco-textarea-synthetic-tap")(fC||={});var mD=class{_lastTypeTextLength;constructor(){this._lastTypeTextLength=0}handleCompositionUpdate(e){e=e||"";let t={text:e,replacePrevCharCnt:this._lastTypeTextLength,replaceNextCharCnt:0,positionDelta:0};return this._lastTypeTextLength=e.length,t}},Hh=class extends V{constructor(t,n,i,r,s,a){super();this._host=t;this._textArea=n;this._OS=i;this._browser=r;this._accessibilityService=s;this._logService=a;this._asyncTriggerCut=this._register(new Qt(()=>this._onCut.fire(),0)),this._textAreaState=Nn.EMPTY,this._selectionChangeListener=null,this._accessibilityService.isScreenReaderOptimized()&&this.writeNativeTextAreaContent("ctor"),this._register(oe.runAndSubscribe(this._accessibilityService.onDidChangeScreenReaderOptimized,()=>{this._accessibilityService.isScreenReaderOptimized()&&!this._asyncFocusGainWriteScreenReaderContent.value?this._asyncFocusGainWriteScreenReaderContent.value=this._register(new Qt(()=>this.writeNativeTextAreaContent("asyncFocusGain"),0)):this._asyncFocusGainWriteScreenReaderContent.clear()})),this._hasFocus=!1,this._currentComposition=null;let l=null;this._register(this._textArea.onKeyDown(d=>{let c=new nt(d);(c.keyCode===114||this._currentComposition&&c.keyCode===1)&&c.stopPropagation(),c.equals(9)&&c.preventDefault(),l=c,this._onKeyDown.fire(c)})),this._register(this._textArea.onKeyUp(d=>{let c=new nt(d);this._onKeyUp.fire(c)})),this._register(this._textArea.onCompositionStart(d=>{uo&&console.log("[compositionstart]",d);let c=new mD;if(this._currentComposition){this._currentComposition=c;return}if(this._currentComposition=c,this._OS===2&&l&&l.equals(114)&&this._textAreaState.selectionStart===this._textAreaState.selectionEnd&&this._textAreaState.selectionStart>0&&this._textAreaState.value.substr(this._textAreaState.selectionStart-1,1)===d.data&&(l.code==="ArrowRight"||l.code==="ArrowLeft")){uo&&console.log("[compositionstart] Handling long press case on macOS + arrow key",d),c.handleCompositionUpdate("x"),this._onCompositionStart.fire({data:d.data});return}if(this._browser.isAndroid){this._onCompositionStart.fire({data:d.data});return}this._onCompositionStart.fire({data:d.data})})),this._register(this._textArea.onCompositionUpdate(d=>{uo&&console.log("[compositionupdate]",d);let c=this._currentComposition;if(!c)return;if(this._browser.isAndroid){let h=Nn.readFromTextArea(this._textArea,this._textAreaState),m=Nn.deduceAndroidCompositionInput(this._textAreaState,h);this._textAreaState=h,this._onType.fire(m),this._onCompositionUpdate.fire(d);return}let u=c.handleCompositionUpdate(d.data);this._textAreaState=Nn.readFromTextArea(this._textArea,this._textAreaState),this._onType.fire(u),this._onCompositionUpdate.fire(d)})),this._register(this._textArea.onCompositionEnd(d=>{uo&&console.log("[compositionend]",d);let c=this._currentComposition;if(!c)return;if(this._currentComposition=null,this._browser.isAndroid){let h=Nn.readFromTextArea(this._textArea,this._textAreaState),m=Nn.deduceAndroidCompositionInput(this._textAreaState,h);this._textAreaState=h,this._onType.fire(m),this._onCompositionEnd.fire();return}let u=c.handleCompositionUpdate(d.data);this._textAreaState=Nn.readFromTextArea(this._textArea,this._textAreaState),this._onType.fire(u),this._onCompositionEnd.fire()})),this._register(this._textArea.onInput(d=>{if(uo&&console.log("[input]",d),this._textArea.setIgnoreSelectionChangeTime("received input event"),this._currentComposition)return;let c=Nn.readFromTextArea(this._textArea,this._textAreaState),u=Nn.deduceInput(this._textAreaState,c,this._OS===2);u.replacePrevCharCnt===0&&u.text.length===1&&(Ht(u.text.charCodeAt(0))||u.text.charCodeAt(0)===127)||(this._textAreaState=c,(u.text!==""||u.replacePrevCharCnt!==0||u.replaceNextCharCnt!==0||u.positionDelta!==0)&&this._onType.fire(u))})),this._register(this._textArea.onCut(d=>{this._textArea.setIgnoreSelectionChangeTime("received cut event"),this._ensureClipboardGetsEditorSelection(d),this._asyncTriggerCut.schedule()})),this._register(this._textArea.onCopy(d=>{this._ensureClipboardGetsEditorSelection(d)})),this._register(this._textArea.onPaste(d=>{if(this._textArea.setIgnoreSelectionChangeTime("received paste event"),d.preventDefault(),!d.clipboardData)return;let[c,u]=VP.getTextData(d.clipboardData);c&&(u=u||gc.INSTANCE.get(c),this._onPaste.fire({text:c,metadata:u}))})),this._register(this._textArea.onFocus(()=>{let d=this._hasFocus;this._setHasFocus(!0),this._accessibilityService.isScreenReaderOptimized()&&this._browser.isSafari&&!d&&this._hasFocus&&(this._asyncFocusGainWriteScreenReaderContent.value||(this._asyncFocusGainWriteScreenReaderContent.value=new Qt(()=>this.writeNativeTextAreaContent("asyncFocusGain"),0)),this._asyncFocusGainWriteScreenReaderContent.value.schedule())})),this._register(this._textArea.onBlur(()=>{this._currentComposition&&(this._currentComposition=null,this.writeNativeTextAreaContent("blurWithoutCompositionEnd"),this._onCompositionEnd.fire()),this._setHasFocus(!1)})),this._register(this._textArea.onSyntheticTap(()=>{this._browser.isAndroid&&this._currentComposition&&(this._currentComposition=null,this.writeNativeTextAreaContent("tapWithoutCompositionEnd"),this._onCompositionEnd.fire())}))}_onFocus=this._register(new E);onFocus=this._onFocus.event;_onBlur=this._register(new E);onBlur=this._onBlur.event;_onKeyDown=this._register(new E);onKeyDown=this._onKeyDown.event;_onKeyUp=this._register(new E);onKeyUp=this._onKeyUp.event;_onCut=this._register(new E);onCut=this._onCut.event;_onPaste=this._register(new E);onPaste=this._onPaste.event;_onType=this._register(new E);onType=this._onType.event;_onCompositionStart=this._register(new E);onCompositionStart=this._onCompositionStart.event;_onCompositionUpdate=this._register(new E);onCompositionUpdate=this._onCompositionUpdate.event;_onCompositionEnd=this._register(new E);onCompositionEnd=this._onCompositionEnd.event;_onSelectionChangeRequest=this._register(new E);onSelectionChangeRequest=this._onSelectionChangeRequest.event;_asyncTriggerCut;_asyncFocusGainWriteScreenReaderContent=this._register(new Zt);_textAreaState;get textAreaState(){return this._textAreaState}_selectionChangeListener;_hasFocus;_currentComposition;_initializeFromTest(){this._hasFocus=!0,this._textAreaState=Nn.readFromTextArea(this._textArea,null)}_installSelectionChangeListener(){let t=0;return U(this._textArea.ownerDocument,"selectionchange",n=>{if(xa.onSelectionChange(),!this._hasFocus||this._currentComposition||!this._browser.isChrome)return;let i=Date.now(),r=i-t;if(t=i,r<5)return;let s=i-this._textArea.getIgnoreSelectionChangeTime();if(this._textArea.resetSelectionChangeTime(),s<100||!this._textAreaState.selection)return;let a=this._textArea.getValue();if(this._textAreaState.value!==a)return;let l=this._textArea.getSelectionStart(),d=this._textArea.getSelectionEnd();if(this._textAreaState.selectionStart===l&&this._textAreaState.selectionEnd===d)return;let c=this._textAreaState.deduceEditorPosition(l),u=this._host.deduceModelPosition(c[0],c[1],c[2]),h=this._textAreaState.deduceEditorPosition(d),m=this._host.deduceModelPosition(h[0],h[1],h[2]),f=new He(u.lineNumber,u.column,m.lineNumber,m.column);this._onSelectionChangeRequest.fire(f)})}dispose(){super.dispose(),this._selectionChangeListener&&(this._selectionChangeListener.dispose(),this._selectionChangeListener=null)}focusTextArea(){this._setHasFocus(!0),this.refreshFocusState()}isFocused(){return this._hasFocus}refreshFocusState(){this._setHasFocus(this._textArea.hasFocus())}_setHasFocus(t){this._hasFocus!==t&&(this._hasFocus=t,this._selectionChangeListener&&(this._selectionChangeListener.dispose(),this._selectionChangeListener=null),this._hasFocus&&(this._selectionChangeListener=this._installSelectionChangeListener()),this._hasFocus&&this.writeNativeTextAreaContent("focusgain"),this._hasFocus?this._onFocus.fire():this._onBlur.fire())}_setAndWriteTextAreaState(t,n){this._hasFocus||(n=n.collapseSelection()),n.writeToTextArea(t,this._textArea,this._hasFocus),this._textAreaState=n}writeNativeTextAreaContent(t){!this._accessibilityService.isScreenReaderOptimized()&&t==="render"||this._currentComposition||(this._logService.trace(`writeTextAreaState(reason: ${t})`),this._setAndWriteTextAreaState(t,this._host.getScreenReaderContent()))}_ensureClipboardGetsEditorSelection(t){let n=this._host.getDataToCopy(),i={version:1,isFromEmptySelection:n.isFromEmptySelection,multicursorText:n.multicursorText,mode:n.mode};gc.INSTANCE.set(this._browser.isFirefox?n.text.replace(/\r\n/g,`
`):n.text,i),t.preventDefault(),t.clipboardData&&VP.setTextData(t.clipboardData,n.text,n.html,i)}};Hh=R([S(4,Co),S(5,Un)],Hh);var VP={getTextData(o){let e=o.getData(Pd.text),t=null,n=o.getData("vscode-editor-data");if(typeof n=="string")try{t=JSON.parse(n),t.version!==1&&(t=null)}catch{}return e.length===0&&t===null&&o.files.length>0?[Array.prototype.slice.call(o.files,0).map(r=>r.name).join(`
`),null]:[e,t]},setTextData(o,e,t,n){o.setData(Pd.text,e),typeof t=="string"&&o.setData("text/html",t),o.setData("vscode-editor-data",JSON.stringify(n))}},gC=class extends V{constructor(t){super();this._actual=t;this._ignoreSelectionChangeTime=0,this._register(this.onKeyDown(()=>xa.onKeyDown())),this._register(this.onBeforeInput(()=>xa.onBeforeInput())),this._register(this.onInput(()=>xa.onInput())),this._register(this.onKeyUp(()=>xa.onKeyUp())),this._register(U(this._actual,fC.Tap,()=>this._onSyntheticTap.fire()))}onKeyDown=this._register(new Fe(this._actual,"keydown")).event;onKeyPress=this._register(new Fe(this._actual,"keypress")).event;onKeyUp=this._register(new Fe(this._actual,"keyup")).event;onCompositionStart=this._register(new Fe(this._actual,"compositionstart")).event;onCompositionUpdate=this._register(new Fe(this._actual,"compositionupdate")).event;onCompositionEnd=this._register(new Fe(this._actual,"compositionend")).event;onBeforeInput=this._register(new Fe(this._actual,"beforeinput")).event;onInput=this._register(new Fe(this._actual,"input")).event;onCut=this._register(new Fe(this._actual,"cut")).event;onCopy=this._register(new Fe(this._actual,"copy")).event;onPaste=this._register(new Fe(this._actual,"paste")).event;onFocus=this._register(new Fe(this._actual,"focus")).event;onBlur=this._register(new Fe(this._actual,"blur")).event;get ownerDocument(){return this._actual.ownerDocument}_onSyntheticTap=this._register(new E);onSyntheticTap=this._onSyntheticTap.event;_ignoreSelectionChangeTime;hasFocus(){let t=ol(this._actual);return t?t.activeElement===this._actual:this._actual.isConnected?eo()===this._actual:!1}setIgnoreSelectionChangeTime(t){this._ignoreSelectionChangeTime=Date.now()}getIgnoreSelectionChangeTime(){return this._ignoreSelectionChangeTime}resetSelectionChangeTime(){this._ignoreSelectionChangeTime=0}getValue(){return this._actual.value}setValue(t,n){let i=this._actual;i.value!==n&&(this.setIgnoreSelectionChangeTime("setValue"),i.value=n)}getSelectionStart(){return this._actual.selectionDirection==="backward"?this._actual.selectionEnd:this._actual.selectionStart}getSelectionEnd(){return this._actual.selectionDirection==="backward"?this._actual.selectionStart:this._actual.selectionEnd}setSelectionRange(t,n,i){let r=this._actual,s=null,a=ol(r);a?s=a.activeElement:s=eo();let l=Ie(s),d=s===r,c=r.selectionStart,u=r.selectionEnd;if(d&&c===n&&u===i){sn&&l.parent!==l&&r.focus();return}if(d){this.setIgnoreSelectionChangeTime("setSelectionRange"),r.setSelectionRange(n,i),sn&&l.parent!==l&&r.focus();return}try{let h=vR(r);this.setIgnoreSelectionChangeTime("setSelectionRange"),r.focus(),r.setSelectionRange(n,i),yR(r,h)}catch{}}};var gD=class extends Vh{_lastPointerType;constructor(e,t,n){super(e,t,n),this._register(Yt.addTarget(this.viewHelper.linesContentDomNode)),this._register(U(this.viewHelper.linesContentDomNode,at.Tap,r=>this.onTap(r))),this._register(U(this.viewHelper.linesContentDomNode,at.Change,r=>this.onChange(r))),this._register(U(this.viewHelper.linesContentDomNode,at.Contextmenu,r=>this._onContextMenu(new ur(r,!1,this.viewHelper.viewDomNode),!1))),this._lastPointerType="mouse",this._register(U(this.viewHelper.linesContentDomNode,"pointerdown",r=>{let s=r.pointerType;if(s==="mouse"){this._lastPointerType="mouse";return}else s==="touch"?this._lastPointerType="touch":this._lastPointerType="pen"}));let i=new wI(this.viewHelper.viewDomNode);this._register(i.onPointerMove(this.viewHelper.viewDomNode,r=>this._onMouseMove(r))),this._register(i.onPointerUp(this.viewHelper.viewDomNode,r=>this._onMouseUp(r))),this._register(i.onPointerLeave(this.viewHelper.viewDomNode,r=>this._onMouseLeave(r))),this._register(i.onPointerDown(this.viewHelper.viewDomNode,(r,s)=>this._onMouseDown(r,s)))}onTap(e){!e.initialTarget||!this.viewHelper.linesContentDomNode.contains(e.initialTarget)||(e.preventDefault(),this.viewHelper.focusTextArea(),this._dispatchGesture(e,!1))}onChange(e){this._lastPointerType==="touch"&&this._context.viewModel.viewLayout.deltaScrollNow(-e.translationX,-e.translationY),this._lastPointerType==="pen"&&this._dispatchGesture(e,!0)}_dispatchGesture(e,t){let n=this._createMouseTarget(new ur(e,!1,this.viewHelper.viewDomNode),!1);n.position&&this.viewController.dispatchMouse({position:n.position,mouseColumn:n.position.column,startedOnLineNumbers:!1,revealType:1,mouseDownCount:e.tapCount,inSelectionMode:t,altKey:!1,ctrlKey:!1,metaKey:!1,shiftKey:!1,leftButton:!1,middleButton:!1,onInjectedText:n.type===6&&n.detail.injectedText!==null})}_onMouseDown(e,t){e.browserEvent.pointerType!=="touch"&&super._onMouseDown(e,t)}},fD=class extends Vh{constructor(e,t,n){super(e,t,n),this._register(Yt.addTarget(this.viewHelper.linesContentDomNode)),this._register(U(this.viewHelper.linesContentDomNode,at.Tap,i=>this.onTap(i))),this._register(U(this.viewHelper.linesContentDomNode,at.Change,i=>this.onChange(i))),this._register(U(this.viewHelper.linesContentDomNode,at.Contextmenu,i=>this._onContextMenu(new ur(i,!1,this.viewHelper.viewDomNode),!1)))}onTap(e){e.preventDefault(),this.viewHelper.focusTextArea();let t=this._createMouseTarget(new ur(e,!1,this.viewHelper.viewDomNode),!1);if(t.position){let n=document.createEvent("CustomEvent");n.initEvent(fC.Tap,!1,!0),this.viewHelper.dispatchTextAreaEvent(n),this.viewController.moveTo(t.position,1)}}onChange(e){this._context.viewModel.viewLayout.deltaScrollNow(-e.translationX,-e.translationY)}},bC=class extends V{handler;constructor(e,t,n){super(),(Va||P1&&R1)&&Qf.pointerEvents?this.handler=this._register(new gD(e,t,n)):De.TouchEvent?this.handler=this._register(new fD(e,t,n)):this.handler=this._register(new Vh(e,t,n))}getTargetAtClientPoint(e,t){return this.handler.getTargetAtClientPoint(e,t)}};var Ki=class extends dr{};var vC=class extends At{_visibleLines;domNode;_dynamicOverlays=[];_isFocused=!1;constructor(e){super(e),this._visibleLines=new yh({createLine:()=>new bD(this._dynamicOverlays)}),this.domNode=this._visibleLines.domNode;let n=this._context.configuration.options.get(51);ln(this.domNode,n),this.domNode.setClassName("view-overlays")}shouldRender(){if(super.shouldRender())return!0;for(let e=0,t=this._dynamicOverlays.length;e<t;e++)if(this._dynamicOverlays[e].shouldRender())return!0;return!1}dispose(){super.dispose();for(let e=0,t=this._dynamicOverlays.length;e<t;e++)this._dynamicOverlays[e].dispose();this._dynamicOverlays=[]}getDomNode(){return this.domNode}addDynamicOverlay(e){this._dynamicOverlays.push(e)}onConfigurationChanged(e){this._visibleLines.onConfigurationChanged(e);let n=this._context.configuration.options.get(51);return ln(this.domNode,n),!0}onFlushed(e){return this._visibleLines.onFlushed(e)}onFocusChanged(e){return this._isFocused=e.isFocused,!0}onLinesChanged(e){return this._visibleLines.onLinesChanged(e)}onLinesDeleted(e){return this._visibleLines.onLinesDeleted(e)}onLinesInserted(e){return this._visibleLines.onLinesInserted(e)}onScrollChanged(e){return this._visibleLines.onScrollChanged(e)||!0}onTokensChanged(e){return this._visibleLines.onTokensChanged(e)}onZonesChanged(e){return this._visibleLines.onZonesChanged(e)}prepareRender(e){let t=this._dynamicOverlays.filter(n=>n.shouldRender());for(let n=0,i=t.length;n<i;n++){let r=t[n];r.prepareRender(e),r.onDidRender()}}render(e){this._viewOverlaysRender(e),this.domNode.toggleClassName("focused",this._isFocused)}_viewOverlaysRender(e){this._visibleLines.renderLines(e.viewportData)}},bD=class{_dynamicOverlays;_domNode;_renderedContent;constructor(e){this._dynamicOverlays=e,this._domNode=null,this._renderedContent=null}getDomNode(){return this._domNode?this._domNode.domNode:null}setDomNode(e){this._domNode=Oe(e)}onContentChanged(){}onTokensChanged(){}renderLine(e,t,n,i,r){let s="";for(let a=0,l=this._dynamicOverlays.length;a<l;a++){let d=this._dynamicOverlays[a];s+=d.render(i.startLineNumber,e)}return this._renderedContent===s?!1:(this._renderedContent=s,r.appendString('<div style="top:'),r.appendString(String(t)),r.appendString("px;height:"),r.appendString(String(n)),r.appendString('px;">'),r.appendString(s),r.appendString("</div>"),!0)}layoutLine(e,t,n){this._domNode&&(this._domNode.setTop(t),this._domNode.setHeight(n))}},yC=class extends vC{_contentWidth;constructor(e){super(e);let n=this._context.configuration.options.get(147);this._contentWidth=n.contentWidth,this.domNode.setHeight(0)}onConfigurationChanged(e){let n=this._context.configuration.options.get(147);return this._contentWidth=n.contentWidth,super.onConfigurationChanged(e)||!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollWidthChanged}_viewOverlaysRender(e){super._viewOverlaysRender(e),this.domNode.setWidth(Math.max(e.scrollWidth,this._contentWidth))}},IC=class extends vC{_contentLeft;constructor(e){super(e);let t=this._context.configuration.options,n=t.get(147);this._contentLeft=n.contentLeft,this.domNode.setClassName("margin-view-overlays"),this.domNode.setWidth(1),ln(this.domNode,t.get(51))}onConfigurationChanged(e){let t=this._context.configuration.options;ln(this.domNode,t.get(51));let n=t.get(147);return this._contentLeft=n.contentLeft,super.onConfigurationChanged(e)||!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollHeightChanged}_viewOverlaysRender(e){super._viewOverlaysRender(e);let t=Math.min(e.scrollHeight,1e6);this.domNode.setHeight(t),this.domNode.setWidth(this._contentLeft)}};var CC=class extends At{domNode;blocks=[];contentWidth=-1;contentLeft=0;constructor(e){super(e),this.domNode=Oe(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.domNode.setClassName("blockDecorations-container"),this.update()}update(){let e=!1,n=this._context.configuration.options.get(147),i=n.contentWidth-n.verticalScrollbarWidth;this.contentWidth!==i&&(this.contentWidth=i,e=!0);let r=n.contentLeft;return this.contentLeft!==r&&(this.contentLeft=r,e=!0),e}dispose(){super.dispose()}onConfigurationChanged(e){return this.update()}onScrollChanged(e){return e.scrollTopChanged||e.scrollLeftChanged}onDecorationsChanged(e){return!0}onZonesChanged(e){return!0}prepareRender(e){}render(e){let t=0,n=e.getDecorationsInViewport();for(let i of n){if(!i.options.blockClassName)continue;let r=this.blocks[t];r||(r=this.blocks[t]=Oe(document.createElement("div")),this.domNode.appendChild(r));let s,a;i.options.blockIsAfterEnd?(s=e.getVerticalOffsetAfterLineNumber(i.range.endLineNumber,!1),a=e.getVerticalOffsetAfterLineNumber(i.range.endLineNumber,!0)):(s=e.getVerticalOffsetForLineNumber(i.range.startLineNumber,!0),a=i.range.isEmpty()&&!i.options.blockDoesNotCollapse?e.getVerticalOffsetForLineNumber(i.range.startLineNumber,!1):e.getVerticalOffsetAfterLineNumber(i.range.endLineNumber,!0));let[l,d,c,u]=i.options.blockPadding??[0,0,0,0];r.setClassName("blockDecorations-block "+i.options.blockClassName),r.setLeft(this.contentLeft-u),r.setWidth(this.contentWidth+u+d),r.setTop(s-e.scrollTop-l),r.setHeight(a-s+l+c),t++}for(let i=t;i<this.blocks.length;i++)this.blocks[i].domNode.remove();this.blocks.length=t}};var SC=class extends At{_viewDomNode;_widgets;domNode;overflowingContentWidgetsDomNode;constructor(e,t){super(e),this._viewDomNode=t,this._widgets={},this.domNode=Oe(document.createElement("div")),Rn.write(this.domNode,1),this.domNode.setClassName("contentWidgets"),this.domNode.setPosition("absolute"),this.domNode.setTop(0),this.overflowingContentWidgetsDomNode=Oe(document.createElement("div")),Rn.write(this.overflowingContentWidgetsDomNode,2),this.overflowingContentWidgetsDomNode.setClassName("overflowingContentWidgets")}dispose(){super.dispose(),this._widgets={}}onConfigurationChanged(e){let t=Object.keys(this._widgets);for(let n of t)this._widgets[n].onConfigurationChanged(e);return!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLineMappingChanged(e){return this._updateAnchorsViewPositions(),!0}onLinesChanged(e){return this._updateAnchorsViewPositions(),!0}onLinesDeleted(e){return this._updateAnchorsViewPositions(),!0}onLinesInserted(e){return this._updateAnchorsViewPositions(),!0}onScrollChanged(e){return!0}onZonesChanged(e){return!0}_updateAnchorsViewPositions(){let e=Object.keys(this._widgets);for(let t of e)this._widgets[t].updateAnchorViewPosition()}addWidget(e){let t=new yD(this._context,this._viewDomNode,e);this._widgets[t.id]=t,t.allowEditorOverflow?this.overflowingContentWidgetsDomNode.appendChild(t.domNode):this.domNode.appendChild(t.domNode),this.setShouldRender()}setWidgetPosition(e,t,n,i,r){this._widgets[e.getId()].setPosition(t,n,i,r),this.setShouldRender()}removeWidget(e){let t=e.getId();if(this._widgets.hasOwnProperty(t)){let n=this._widgets[t];delete this._widgets[t];let i=n.domNode.domNode;i.remove(),i.removeAttribute("monaco-visible-content-widget"),this.setShouldRender()}}shouldSuppressMouseDownOnWidget(e){return this._widgets.hasOwnProperty(e)?this._widgets[e].suppressMouseDown:!1}onBeforeRender(e){let t=Object.keys(this._widgets);for(let n of t)this._widgets[n].onBeforeRender(e)}prepareRender(e){let t=Object.keys(this._widgets);for(let n of t)this._widgets[n].prepareRender(e)}render(e){let t=Object.keys(this._widgets);for(let n of t)this._widgets[n].render(e)}},yD=class{_context;_viewDomNode;_actual;domNode;id;allowEditorOverflow;suppressMouseDown;_fixedOverflowWidgets;_contentWidth;_contentLeft;_lineHeight;_primaryAnchor=new fc(null,null);_secondaryAnchor=new fc(null,null);_affinity;_preference;_cachedDomNodeOffsetWidth;_cachedDomNodeOffsetHeight;_maxWidth;_isVisible;_renderData;constructor(e,t,n){this._context=e,this._viewDomNode=t,this._actual=n,this.domNode=Oe(this._actual.getDomNode()),this.id=this._actual.getId(),this.allowEditorOverflow=this._actual.allowEditorOverflow||!1,this.suppressMouseDown=this._actual.suppressMouseDown||!1;let i=this._context.configuration.options,r=i.get(147);this._fixedOverflowWidgets=i.get(43),this._contentWidth=r.contentWidth,this._contentLeft=r.contentLeft,this._lineHeight=i.get(68),this._affinity=null,this._preference=[],this._cachedDomNodeOffsetWidth=-1,this._cachedDomNodeOffsetHeight=-1,this._maxWidth=this._getMaxWidth(),this._isVisible=!1,this._renderData=null,this.domNode.setPosition(this._fixedOverflowWidgets&&this.allowEditorOverflow?"fixed":"absolute"),this.domNode.setDisplay("none"),this.domNode.setVisibility("hidden"),this.domNode.setAttribute("widgetId",this.id),this.domNode.setMaxWidth(this._maxWidth)}onConfigurationChanged(e){let t=this._context.configuration.options;if(this._lineHeight=t.get(68),e.hasChanged(147)){let n=t.get(147);this._contentLeft=n.contentLeft,this._contentWidth=n.contentWidth,this._maxWidth=this._getMaxWidth()}}updateAnchorViewPosition(){this._setPosition(this._affinity,this._primaryAnchor.modelPosition,this._secondaryAnchor.modelPosition)}_setPosition(e,t,n){this._affinity=e,this._primaryAnchor=i(t,this._context.viewModel,this._affinity),this._secondaryAnchor=i(n,this._context.viewModel,this._affinity);function i(r,s,a){if(!r)return new fc(null,null);let l=s.model.validatePosition(r);if(s.coordinatesConverter.modelPositionIsVisible(l)){let d=s.coordinatesConverter.convertModelPositionToViewPosition(l,a??void 0);return new fc(r,d)}return new fc(r,null)}}_getMaxWidth(){let e=this.domNode.domNode.ownerDocument,t=e.defaultView;return this.allowEditorOverflow?t?.innerWidth||e.documentElement.offsetWidth||e.body.offsetWidth:this._contentWidth}setPosition(e,t,n,i){this._setPosition(i,e,t),this._preference=n,this._primaryAnchor.viewPosition&&this._preference&&this._preference.length>0?this.domNode.setDisplay("block"):this.domNode.setDisplay("none"),this._cachedDomNodeOffsetWidth=-1,this._cachedDomNodeOffsetHeight=-1}_layoutBoxInViewport(e,t,n,i){let r=e.top,s=r,a=e.top+e.height,l=i.viewportHeight-a,d=r-n,c=s>=n,u=a,h=l>=n,m=e.left;return m+t>i.scrollLeft+i.viewportWidth&&(m=i.scrollLeft+i.viewportWidth-t),m<i.scrollLeft&&(m=i.scrollLeft),{fitsAbove:c,aboveTop:d,fitsBelow:h,belowTop:u,left:m}}_layoutHorizontalSegmentInPage(e,t,n,i){let a=Math.max(15,t.left-i),l=Math.min(t.left+t.width+i,e.width-15),c=this._viewDomNode.domNode.ownerDocument.defaultView,u=t.left+n-(c?.scrollX??0);if(u+i>l){let h=u-(l-i);u-=h,n-=h}if(u<a){let h=u-a;u-=h,n-=h}return[n,u]}_layoutBoxInPage(e,t,n,i){let r=e.top-n,s=e.top+e.height,a=yo(this._viewDomNode.domNode),l=this._viewDomNode.domNode.ownerDocument,d=l.defaultView,c=a.top+r-(d?.scrollY??0),u=a.top+s-(d?.scrollY??0),h=bd(l.body),[m,f]=this._layoutHorizontalSegmentInPage(h,a,e.left-i.scrollLeft+this._contentLeft,t),g=22,b=22,y=c>=g,C=u+n<=h.height-b;return this._fixedOverflowWidgets?{fitsAbove:y,aboveTop:Math.max(c,g),fitsBelow:C,belowTop:u,left:f}:{fitsAbove:y,aboveTop:r,fitsBelow:C,belowTop:s,left:m}}_prepareRenderWidgetAtExactPositionOverflowing(e){return new bc(e.top,e.left+this._contentLeft)}_getAnchorsCoordinates(e){let t=r(this._primaryAnchor.viewPosition,this._affinity,this._lineHeight),n=this._secondaryAnchor.viewPosition?.lineNumber===this._primaryAnchor.viewPosition?.lineNumber?this._secondaryAnchor.viewPosition:null,i=r(n,this._affinity,this._lineHeight);return{primary:t,secondary:i};function r(s,a,l){if(!s)return null;let d=e.visibleRangeForPosition(s);if(!d)return null;let c=s.column===1&&a===3?0:d.left,u=e.getVerticalOffsetForLineNumber(s.lineNumber)-e.scrollTop;return new wC(u,c,l)}}_reduceAnchorCoordinates(e,t,n){if(!t)return e;let i=this._context.configuration.options.get(51),r=t.left;return r<e.left?r=Math.max(r,e.left-n+i.typicalFullwidthCharacterWidth):r=Math.min(r,e.left+n-i.typicalFullwidthCharacterWidth),new wC(e.top,r,e.height)}_prepareRenderWidget(e){if(!this._preference||this._preference.length===0)return null;let{primary:t,secondary:n}=this._getAnchorsCoordinates(e);if(!t)return{kind:"offViewport",preserveFocus:this.domNode.domNode.contains(this.domNode.domNode.ownerDocument.activeElement)};if(this._cachedDomNodeOffsetWidth===-1||this._cachedDomNodeOffsetHeight===-1){let s=null;if(typeof this._actual.beforeRender=="function"&&(s=vD(this._actual.beforeRender,this._actual)),s)this._cachedDomNodeOffsetWidth=s.width,this._cachedDomNodeOffsetHeight=s.height;else{let l=this.domNode.domNode.getBoundingClientRect();this._cachedDomNodeOffsetWidth=Math.round(l.width),this._cachedDomNodeOffsetHeight=Math.round(l.height)}}let i=this._reduceAnchorCoordinates(t,n,this._cachedDomNodeOffsetWidth),r;this.allowEditorOverflow?r=this._layoutBoxInPage(i,this._cachedDomNodeOffsetWidth,this._cachedDomNodeOffsetHeight,e):r=this._layoutBoxInViewport(i,this._cachedDomNodeOffsetWidth,this._cachedDomNodeOffsetHeight,e);for(let s=1;s<=2;s++)for(let a of this._preference)if(a===1){if(!r)return null;if(s===2||r.fitsAbove)return{kind:"inViewport",coordinate:new bc(r.aboveTop,r.left),position:1}}else if(a===2){if(!r)return null;if(s===2||r.fitsBelow)return{kind:"inViewport",coordinate:new bc(r.belowTop,r.left),position:2}}else return this.allowEditorOverflow?{kind:"inViewport",coordinate:this._prepareRenderWidgetAtExactPositionOverflowing(new bc(i.top,i.left)),position:0}:{kind:"inViewport",coordinate:new bc(i.top,i.left),position:0};return null}onBeforeRender(e){!this._primaryAnchor.viewPosition||!this._preference||this._primaryAnchor.viewPosition.lineNumber<e.startLineNumber||this._primaryAnchor.viewPosition.lineNumber>e.endLineNumber||this.domNode.setMaxWidth(this._maxWidth)}prepareRender(e){this._renderData=this._prepareRenderWidget(e)}render(e){if(!this._renderData||this._renderData.kind==="offViewport"){this._isVisible&&(this.domNode.removeAttribute("monaco-visible-content-widget"),this._isVisible=!1,this._renderData?.kind==="offViewport"&&this._renderData.preserveFocus?this.domNode.setTop(-1e3):this.domNode.setVisibility("hidden")),typeof this._actual.afterRender=="function"&&vD(this._actual.afterRender,this._actual,null);return}this.allowEditorOverflow?(this.domNode.setTop(this._renderData.coordinate.top),this.domNode.setLeft(this._renderData.coordinate.left)):(this.domNode.setTop(this._renderData.coordinate.top+e.scrollTop-e.bigNumbersDelta),this.domNode.setLeft(this._renderData.coordinate.left)),this._isVisible||(this.domNode.setVisibility("inherit"),this.domNode.setAttribute("monaco-visible-content-widget","true"),this._isVisible=!0),typeof this._actual.afterRender=="function"&&vD(this._actual.afterRender,this._actual,this._renderData.position)}},fc=class{constructor(e,t){this.modelPosition=e;this.viewPosition=t}},bc=class{constructor(e,t){this.top=e;this.left=t}_coordinateBrand=void 0},wC=class{constructor(e,t,n){this.top=e;this.left=t;this.height=n}_anchorCoordinateBrand=void 0};function vD(o,e,...t){try{return o.call(e,...t)}catch{return null}}var xC=class extends Ki{_context;_renderLineHighlight;_wordWrap;_contentLeft;_contentWidth;_selectionIsEmpty;_renderLineHighlightOnlyWhenFocus;_focused;_cursorLineNumbers;_selections;_renderData;constructor(e){super(),this._context=e;let t=this._context.configuration.options,n=t.get(147);this._renderLineHighlight=t.get(98),this._renderLineHighlightOnlyWhenFocus=t.get(99),this._wordWrap=n.isViewportWrapping,this._contentLeft=n.contentLeft,this._contentWidth=n.contentWidth,this._selectionIsEmpty=!0,this._focused=!1,this._cursorLineNumbers=[1],this._selections=[new He(1,1,1,1)],this._renderData=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}_readFromSelections(){let e=!1,t=new Set;for(let r of this._selections)t.add(r.positionLineNumber);let n=Array.from(t);n.sort((r,s)=>r-s),on(this._cursorLineNumbers,n)||(this._cursorLineNumbers=n,e=!0);let i=this._selections.every(r=>r.isEmpty());return this._selectionIsEmpty!==i&&(this._selectionIsEmpty=i,e=!0),e}onThemeChanged(e){return this._readFromSelections()}onConfigurationChanged(e){let t=this._context.configuration.options,n=t.get(147);return this._renderLineHighlight=t.get(98),this._renderLineHighlightOnlyWhenFocus=t.get(99),this._wordWrap=n.isViewportWrapping,this._contentLeft=n.contentLeft,this._contentWidth=n.contentWidth,!0}onCursorStateChanged(e){return this._selections=e.selections,this._readFromSelections()}onFlushed(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollWidthChanged||e.scrollTopChanged}onZonesChanged(e){return!0}onFocusChanged(e){return this._renderLineHighlightOnlyWhenFocus?(this._focused=e.isFocused,!0):!1}prepareRender(e){if(!this._shouldRenderThis()){this._renderData=null;return}let t=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber,i=[];for(let s=t;s<=n;s++){let a=s-t;i[a]=""}if(this._wordWrap){let s=this._renderOne(e,!1);for(let a of this._cursorLineNumbers){let l=this._context.viewModel.coordinatesConverter,d=l.convertViewPositionToModelPosition(new P(a,1)).lineNumber,c=l.convertModelPositionToViewPosition(new P(d,1)).lineNumber,u=l.convertModelPositionToViewPosition(new P(d,this._context.viewModel.model.getLineMaxColumn(d))).lineNumber,h=Math.max(c,t),m=Math.min(u,n);for(let f=h;f<=m;f++){let g=f-t;i[g]=s}}}let r=this._renderOne(e,!0);for(let s of this._cursorLineNumbers){if(s<t||s>n)continue;let a=s-t;i[a]=r}this._renderData=i}render(e,t){if(!this._renderData)return"";let n=t-e;return n>=this._renderData.length?"":this._renderData[n]}_shouldRenderInMargin(){return(this._renderLineHighlight==="gutter"||this._renderLineHighlight==="all")&&(!this._renderLineHighlightOnlyWhenFocus||this._focused)}_shouldRenderInContent(){return(this._renderLineHighlight==="line"||this._renderLineHighlight==="all")&&this._selectionIsEmpty&&(!this._renderLineHighlightOnlyWhenFocus||this._focused)}},EC=class extends xC{_renderOne(e,t){return`<div class="${"current-line"+(this._shouldRenderInMargin()?" current-line-both":"")+(t?" current-line-exact":"")}" style="width:${Math.max(e.scrollWidth,this._contentWidth)}px;"></div>`}_shouldRenderThis(){return this._shouldRenderInContent()}_shouldRenderOther(){return this._shouldRenderInMargin()}},_C=class extends xC{_renderOne(e,t){return`<div class="${"current-line"+(this._shouldRenderInMargin()?" current-line-margin":"")+(this._shouldRenderOther()?" current-line-margin-both":"")+(this._shouldRenderInMargin()&&t?" current-line-exact-margin":"")}" style="width:${this._contentLeft}px"></div>`}_shouldRenderThis(){return!0}_shouldRenderOther(){return this._shouldRenderInContent()}};Ui((o,e)=>{let t=o.getColor(zT);if(t&&(e.addRule(`.monaco-editor .view-overlays .current-line { background-color: ${t}; }`),e.addRule(`.monaco-editor .margin-view-overlays .current-line-margin { background-color: ${t}; border: none; }`)),!t||t.isTransparent()||o.defines(KT)){let n=o.getColor(KT);n&&(e.addRule(`.monaco-editor .view-overlays .current-line-exact { border: 2px solid ${n}; }`),e.addRule(`.monaco-editor .margin-view-overlays .current-line-exact-margin { border: 2px solid ${n}; }`),El(o.type)&&(e.addRule(".monaco-editor .view-overlays .current-line-exact { border-width: 1px; }"),e.addRule(".monaco-editor .margin-view-overlays .current-line-exact-margin { border-width: 1px; }")))}});var TC=class extends Ki{_context;_typicalHalfwidthCharacterWidth;_renderResult;constructor(e){super(),this._context=e;let t=this._context.configuration.options;this._typicalHalfwidthCharacterWidth=t.get(51).typicalHalfwidthCharacterWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){let t=this._context.configuration.options;return this._typicalHalfwidthCharacterWidth=t.get(51).typicalHalfwidthCharacterWidth,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged||e.scrollWidthChanged}onZonesChanged(e){return!0}prepareRender(e){let t=e.getDecorationsInViewport(),n=[],i=0;for(let l=0,d=t.length;l<d;l++){let c=t[l];c.options.className&&(n[i++]=c)}n=n.sort((l,d)=>{if(l.options.zIndex<d.options.zIndex)return-1;if(l.options.zIndex>d.options.zIndex)return 1;let c=l.options.className,u=d.options.className;return c<u?-1:c>u?1:D.compareRangesUsingStarts(l.range,d.range)});let r=e.visibleRange.startLineNumber,s=e.visibleRange.endLineNumber,a=[];for(let l=r;l<=s;l++){let d=l-r;a[d]=""}this._renderWholeLineDecorations(e,n,a),this._renderNormalDecorations(e,n,a),this._renderResult=a}_renderWholeLineDecorations(e,t,n){let i=e.visibleRange.startLineNumber,r=e.visibleRange.endLineNumber;for(let s=0,a=t.length;s<a;s++){let l=t[s];if(!l.options.isWholeLine)continue;let d='<div class="cdr '+l.options.className+'" style="left:0;width:100%;"></div>',c=Math.max(l.range.startLineNumber,i),u=Math.min(l.range.endLineNumber,r);for(let h=c;h<=u;h++){let m=h-i;n[m]+=d}}}_renderNormalDecorations(e,t,n){let i=e.visibleRange.startLineNumber,r=null,s=!1,a=null,l=!1;for(let d=0,c=t.length;d<c;d++){let u=t[d];if(u.options.isWholeLine)continue;let h=u.options.className,m=!!u.options.showIfCollapsed,f=u.range;if(m&&f.endColumn===1&&f.endLineNumber!==f.startLineNumber&&(f=new D(f.startLineNumber,f.startColumn,f.endLineNumber-1,this._context.viewModel.getLineMaxColumn(f.endLineNumber-1))),r===h&&s===m&&D.areIntersectingOrTouching(a,f)){a=D.plusRange(a,f);continue}r!==null&&this._renderNormalDecoration(e,a,r,l,s,i,n),r=h,s=m,a=f,l=u.options.shouldFillLineOnLineBreak??!1}r!==null&&this._renderNormalDecoration(e,a,r,l,s,i,n)}_renderNormalDecoration(e,t,n,i,r,s,a){let l=e.linesVisibleRangesForRange(t,n==="findMatch");if(l)for(let d=0,c=l.length;d<c;d++){let u=l[d];if(u.outsideRenderedLine)continue;let h=u.lineNumber-s;if(r&&u.ranges.length===1){let m=u.ranges[0];if(m.width<this._typicalHalfwidthCharacterWidth){let f=Math.round(m.left+m.width/2),g=Math.max(0,Math.round(f-this._typicalHalfwidthCharacterWidth/2));u.ranges[0]=new vh(g,this._typicalHalfwidthCharacterWidth)}}for(let m=0,f=u.ranges.length;m<f;m++){let g=i&&u.continuesOnNextLine&&f===1,b=u.ranges[m],y='<div class="cdr '+n+'" style="left:'+String(b.left)+"px;width:"+(g?"100%;":String(b.width)+"px;")+'"></div>';a[h]+=y}}}render(e,t){if(!this._renderResult)return"";let n=t-e;return n<0||n>=this._renderResult.length?"":this._renderResult[n]}};var LC=class extends At{scrollbar;scrollbarDomNode;constructor(e,t,n,i){super(e);let r=this._context.configuration.options,s=r.get(105),a=r.get(76),l=r.get(41),d=r.get(108),c={listenOnDomNode:n.domNode,className:"editor-scrollable "+Gm(e.theme.type),useShadows:!1,lazyRender:!0,vertical:s.vertical,horizontal:s.horizontal,verticalHasArrows:s.verticalHasArrows,horizontalHasArrows:s.horizontalHasArrows,verticalScrollbarSize:s.verticalScrollbarSize,verticalSliderSize:s.verticalSliderSize,horizontalScrollbarSize:s.horizontalScrollbarSize,horizontalSliderSize:s.horizontalSliderSize,handleMouseWheel:s.handleMouseWheel,alwaysConsumeMouseWheel:s.alwaysConsumeMouseWheel,arrowSize:s.arrowSize,mouseWheelScrollSensitivity:a,fastScrollSensitivity:l,scrollPredominantAxis:d,scrollByPage:s.scrollByPage};this.scrollbar=this._register(new pc(t.domNode,c,this._context.viewLayout.getScrollable())),Rn.write(this.scrollbar.getDomNode(),6),this.scrollbarDomNode=Oe(this.scrollbar.getDomNode()),this.scrollbarDomNode.setPosition("absolute"),this._setLayout();let u=(h,m,f)=>{let g={};if(m){let b=h.scrollTop;b&&(g.scrollTop=this._context.viewLayout.getCurrentScrollTop()+b,h.scrollTop=0)}if(f){let b=h.scrollLeft;b&&(g.scrollLeft=this._context.viewLayout.getCurrentScrollLeft()+b,h.scrollLeft=0)}this._context.viewModel.viewLayout.setScrollPosition(g,1)};this._register(U(n.domNode,"scroll",h=>u(n.domNode,!0,!0))),this._register(U(t.domNode,"scroll",h=>u(t.domNode,!0,!1))),this._register(U(i.domNode,"scroll",h=>u(i.domNode,!0,!1))),this._register(U(this.scrollbarDomNode.domNode,"scroll",h=>u(this.scrollbarDomNode.domNode,!0,!1)))}dispose(){super.dispose()}_setLayout(){let e=this._context.configuration.options,t=e.get(147);this.scrollbarDomNode.setLeft(t.contentLeft),e.get(74).side==="right"?this.scrollbarDomNode.setWidth(t.contentWidth+t.minimap.minimapWidth):this.scrollbarDomNode.setWidth(t.contentWidth),this.scrollbarDomNode.setHeight(t.height)}getOverviewRulerLayoutInfo(){return this.scrollbar.getOverviewRulerLayoutInfo()}getDomNode(){return this.scrollbarDomNode}delegateVerticalScrollbarPointerDown(e){this.scrollbar.delegateVerticalScrollbarPointerDown(e)}delegateScrollFromMouseWheelEvent(e){this.scrollbar.delegateScrollFromMouseWheelEvent(e)}onConfigurationChanged(e){if(e.hasChanged(105)||e.hasChanged(76)||e.hasChanged(41)){let t=this._context.configuration.options,n=t.get(105),i=t.get(76),r=t.get(41),s=t.get(108),a={vertical:n.vertical,horizontal:n.horizontal,verticalScrollbarSize:n.verticalScrollbarSize,horizontalScrollbarSize:n.horizontalScrollbarSize,scrollByPage:n.scrollByPage,handleMouseWheel:n.handleMouseWheel,mouseWheelScrollSensitivity:i,fastScrollSensitivity:r,scrollPredominantAxis:s};this.scrollbar.updateOptions(a)}return e.hasChanged(147)&&this._setLayout(),!0}onScrollChanged(e){return!0}onThemeChanged(e){return this.scrollbar.updateClassName("editor-scrollable "+Gm(this._context.theme.type)),!0}prepareRender(e){}render(e){this.scrollbar.renderNow()}};var vc=class{constructor(e,t,n,i,r){this.startLineNumber=e;this.endLineNumber=t;this.className=n;this.tooltip=i;this.zIndex=r??0}_decorationToRenderBrand=void 0;zIndex},ID=class{constructor(e,t,n){this.className=e;this.zIndex=t;this.tooltip=n}},CD=class{decorations=[];add(e){this.decorations.push(e)}getDecorations(){return this.decorations}},Uh=class extends Ki{_render(e,t,n){let i=[];for(let a=e;a<=t;a++){let l=a-e;i[l]=new CD}if(n.length===0)return i;n.sort((a,l)=>a.className===l.className?a.startLineNumber===l.startLineNumber?a.endLineNumber-l.endLineNumber:a.startLineNumber-l.startLineNumber:a.className<l.className?-1:1);let r=null,s=0;for(let a=0,l=n.length;a<l;a++){let d=n[a],c=d.className,u=d.zIndex,h=Math.max(d.startLineNumber,e)-e,m=Math.min(d.endLineNumber,t)-e;r===c?(h=Math.max(s+1,h),s=Math.max(s,m)):(r=c,s=m);for(let f=h;f<=s;f++)i[f].add(new ID(c,u,d.tooltip))}return i}},DC=class extends At{domNode;_lineHeight;_glyphMargin;_glyphMarginLeft;_glyphMarginWidth;_glyphMarginDecorationLaneCount;_managedDomNodes;_decorationGlyphsToRender;_widgets={};constructor(e){super(e),this._context=e;let t=this._context.configuration.options,n=t.get(147);this.domNode=Oe(document.createElement("div")),this.domNode.setClassName("glyph-margin-widgets"),this.domNode.setPosition("absolute"),this.domNode.setTop(0),this._lineHeight=t.get(68),this._glyphMargin=t.get(58),this._glyphMarginLeft=n.glyphMarginLeft,this._glyphMarginWidth=n.glyphMarginWidth,this._glyphMarginDecorationLaneCount=n.glyphMarginDecorationLaneCount,this._managedDomNodes=[],this._decorationGlyphsToRender=[]}dispose(){this._managedDomNodes=[],this._decorationGlyphsToRender=[],this._widgets={},super.dispose()}getWidgets(){return Object.values(this._widgets)}onConfigurationChanged(e){let t=this._context.configuration.options,n=t.get(147);return this._lineHeight=t.get(68),this._glyphMargin=t.get(58),this._glyphMarginLeft=n.glyphMarginLeft,this._glyphMarginWidth=n.glyphMarginWidth,this._glyphMarginDecorationLaneCount=n.glyphMarginDecorationLaneCount,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}addWidget(e){let t=Oe(e.getDomNode());this._widgets[e.getId()]={widget:e,preference:e.getPosition(),domNode:t,renderInfo:null},t.setPosition("absolute"),t.setDisplay("none"),t.setAttribute("widgetId",e.getId()),this.domNode.appendChild(t),this.setShouldRender()}setWidgetPosition(e,t){let n=this._widgets[e.getId()];return n.preference.lane===t.lane&&n.preference.zIndex===t.zIndex&&D.equalsRange(n.preference.range,t.range)?!1:(n.preference=t,this.setShouldRender(),!0)}removeWidget(e){let t=e.getId();if(this._widgets[t]){let i=this._widgets[t].domNode.domNode;delete this._widgets[t],i.remove(),this.setShouldRender()}}_collectDecorationBasedGlyphRenderRequest(e,t){let n=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,r=e.getDecorationsInViewport();for(let s of r){let a=s.options.glyphMarginClassName;if(!a)continue;let l=Math.max(s.range.startLineNumber,n),d=Math.min(s.range.endLineNumber,i),c=s.options.glyphMargin?.position??2,u=s.options.zIndex??0;for(let h=l;h<=d;h++){let m=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new P(h,0)),f=this._context.viewModel.glyphLanes.getLanesAtLine(m.lineNumber).indexOf(c);t.push(new SD(h,f,u,a))}}}_collectWidgetBasedGlyphRenderRequest(e,t){let n=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber;for(let r of Object.values(this._widgets)){let s=r.preference.range,{startLineNumber:a,endLineNumber:l}=this._context.viewModel.coordinatesConverter.convertModelRangeToViewRange(D.lift(s));if(!a||!l||l<n||a>i)continue;let d=Math.max(a,n),c=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new P(d,0)),u=this._context.viewModel.glyphLanes.getLanesAtLine(c.lineNumber).indexOf(r.preference.lane);t.push(new wD(d,u,r.preference.zIndex,r))}}_collectSortedGlyphRenderRequests(e){let t=[];return this._collectDecorationBasedGlyphRenderRequest(e,t),this._collectWidgetBasedGlyphRenderRequest(e,t),t.sort((n,i)=>n.lineNumber===i.lineNumber?n.laneIndex===i.laneIndex?n.zIndex===i.zIndex?i.type===n.type?n.type===0&&i.type===0?n.className<i.className?-1:1:0:i.type-n.type:i.zIndex-n.zIndex:n.laneIndex-i.laneIndex:n.lineNumber-i.lineNumber),t}prepareRender(e){if(!this._glyphMargin){this._decorationGlyphsToRender=[];return}for(let i of Object.values(this._widgets))i.renderInfo=null;let t=new qi(this._collectSortedGlyphRenderRequests(e)),n=[];for(;t.length>0;){let i=t.peek();if(!i)break;let r=t.takeWhile(a=>a.lineNumber===i.lineNumber&&a.laneIndex===i.laneIndex);if(!r||r.length===0)break;let s=r[0];if(s.type===0){let a=[];for(let l of r){if(l.zIndex!==s.zIndex||l.type!==s.type)break;(a.length===0||a[a.length-1]!==l.className)&&a.push(l.className)}n.push(s.accept(a.join(" ")))}else s.widget.renderInfo={lineNumber:s.lineNumber,laneIndex:s.laneIndex}}this._decorationGlyphsToRender=n}render(e){if(!this._glyphMargin){for(let n of Object.values(this._widgets))n.domNode.setDisplay("none");for(;this._managedDomNodes.length>0;)this._managedDomNodes.pop()?.domNode.remove();return}let t=Math.round(this._glyphMarginWidth/this._glyphMarginDecorationLaneCount);for(let n of Object.values(this._widgets))if(!n.renderInfo)n.domNode.setDisplay("none");else{let i=e.viewportData.relativeVerticalOffset[n.renderInfo.lineNumber-e.viewportData.startLineNumber],r=this._glyphMarginLeft+n.renderInfo.laneIndex*this._lineHeight;n.domNode.setDisplay("block"),n.domNode.setTop(i),n.domNode.setLeft(r),n.domNode.setWidth(t),n.domNode.setHeight(this._lineHeight)}for(let n=0;n<this._decorationGlyphsToRender.length;n++){let i=this._decorationGlyphsToRender[n],r=e.viewportData.relativeVerticalOffset[i.lineNumber-e.viewportData.startLineNumber],s=this._glyphMarginLeft+i.laneIndex*this._lineHeight,a;n<this._managedDomNodes.length?a=this._managedDomNodes[n]:(a=Oe(document.createElement("div")),this._managedDomNodes.push(a),this.domNode.appendChild(a)),a.setClassName("cgmr codicon "+i.combinedClassName),a.setPosition("absolute"),a.setTop(r),a.setLeft(s),a.setWidth(t),a.setHeight(this._lineHeight)}for(;this._managedDomNodes.length>this._decorationGlyphsToRender.length;)this._managedDomNodes.pop()?.domNode.remove()}};var SD=class{constructor(e,t,n,i){this.lineNumber=e;this.laneIndex=t;this.zIndex=n;this.className=i}type=0;accept(e){return new xD(this.lineNumber,this.laneIndex,e)}},wD=class{constructor(e,t,n,i){this.lineNumber=e;this.laneIndex=t;this.zIndex=n;this.widget=i}type=1},xD=class{constructor(e,t,n){this.lineNumber=e;this.laneIndex=t;this.combinedClassName=n}};var kC=class extends Ki{_context;_primaryPosition;_spaceWidth;_renderResult;_maxIndentLeft;_bracketPairGuideOptions;constructor(e){super(),this._context=e,this._primaryPosition=null;let t=this._context.configuration.options,n=t.get(148),i=t.get(51);this._spaceWidth=i.spaceWidth,this._maxIndentLeft=n.wrappingColumn===-1?-1:n.wrappingColumn*i.typicalHalfwidthCharacterWidth,this._bracketPairGuideOptions=t.get(16),this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){let t=this._context.configuration.options,n=t.get(148),i=t.get(51);return this._spaceWidth=i.spaceWidth,this._maxIndentLeft=n.wrappingColumn===-1?-1:n.wrappingColumn*i.typicalHalfwidthCharacterWidth,this._bracketPairGuideOptions=t.get(16),!0}onCursorStateChanged(e){let n=e.selections[0].getPosition();return this._primaryPosition?.equals(n)?!1:(this._primaryPosition=n,!0)}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}onLanguageConfigurationChanged(e){return!0}prepareRender(e){if(!this._bracketPairGuideOptions.indentation&&this._bracketPairGuideOptions.bracketPairs===!1){this._renderResult=null;return}let t=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber,i=e.scrollWidth,r=this._primaryPosition,s=this.getGuidesByLine(t,Math.min(n+1,this._context.viewModel.getLineCount()),r),a=[];for(let l=t;l<=n;l++){let d=l-t,c=s[d],u="",h=e.visibleRangeForPosition(new P(l,1))?.left??0;for(let m of c){let f=m.column===-1?h+(m.visibleColumn-1)*this._spaceWidth:e.visibleRangeForPosition(new P(l,m.column)).left;if(f>i||this._maxIndentLeft>0&&f>this._maxIndentLeft)break;let g=m.horizontalLine?m.horizontalLine.top?"horizontal-top":"horizontal-bottom":"vertical",b=m.horizontalLine?(e.visibleRangeForPosition(new P(l,m.horizontalLine.endColumn))?.left??f+this._spaceWidth)-f:this._spaceWidth;u+=`<div class="core-guide ${m.className} ${g}" style="left:${f}px;width:${b}px"></div>`}a[d]=u}this._renderResult=a}getGuidesByLine(e,t,n){let i=this._bracketPairGuideOptions.bracketPairs!==!1?this._context.viewModel.getBracketGuidesInRangeByLine(e,t,n,{highlightActive:this._bracketPairGuideOptions.highlightActiveBracketPair,horizontalGuides:this._bracketPairGuideOptions.bracketPairsHorizontal===!0?2:this._bracketPairGuideOptions.bracketPairsHorizontal==="active"?1:0,includeInactive:this._bracketPairGuideOptions.bracketPairs===!0}):null,r=this._bracketPairGuideOptions.indentation?this._context.viewModel.getLinesIndentGuides(e,t):null,s=0,a=0,l=0;if(this._bracketPairGuideOptions.highlightActiveIndentation!==!1&&n){let u=this._context.viewModel.getActiveIndentGuide(n.lineNumber,e,t);s=u.startLineNumber,a=u.endLineNumber,l=u.indent}let{indentSize:d}=this._context.viewModel.model.getOptions(),c=[];for(let u=e;u<=t;u++){let h=new Array;c.push(h);let m=i?i[u-e]:[],f=new qi(m),g=r?r[u-e]:0;for(let b=1;b<=g;b++){let y=(b-1)*d+1,C=(this._bracketPairGuideOptions.highlightActiveIndentation==="always"||m.length===0)&&s<=u&&u<=a&&b===l;h.push(...f.takeWhile(L=>L.visibleColumn<y)||[]);let x=f.peek();(!x||x.visibleColumn!==y||x.horizontalLine)&&h.push(new ar(y,-1,`core-guide-indent lvl-${(b-1)%30}`+(C?" indent-active":""),null,-1,-1))}h.push(...f.takeWhile(b=>!0)||[])}return c}render(e,t){if(!this._renderResult)return"";let n=t-e;return n<0||n>=this._renderResult.length?"":this._renderResult[n]}};function zh(o){if(!(o&&o.isTransparent()))return o}Ui((o,e)=>{let t=[{bracketColor:Vy,guideColor:SN,guideColorActive:LN},{bracketColor:Wy,guideColor:wN,guideColorActive:DN},{bracketColor:Hy,guideColor:xN,guideColorActive:kN},{bracketColor:Uy,guideColor:EN,guideColorActive:RN},{bracketColor:zy,guideColor:_N,guideColorActive:MN},{bracketColor:Ky,guideColor:TN,guideColorActive:AN}],n=new eg,i=[{indentColor:rN,indentColorActive:uN},{indentColor:sN,indentColorActive:hN},{indentColor:aN,indentColorActive:pN},{indentColor:lN,indentColorActive:mN},{indentColor:dN,indentColorActive:gN},{indentColor:cN,indentColorActive:fN}],r=t.map(a=>{let l=o.getColor(a.bracketColor),d=o.getColor(a.guideColor),c=o.getColor(a.guideColorActive),u=zh(zh(d)??l?.transparent(.3)),h=zh(zh(c)??l);if(!(!u||!h))return{guideColor:u,guideColorActive:h}}).filter(_x),s=i.map(a=>{let l=o.getColor(a.indentColor),d=o.getColor(a.indentColorActive),c=zh(l),u=zh(d);if(!(!c||!u))return{indentColor:c,indentColorActive:u}}).filter(_x);if(r.length>0){for(let a=0;a<30;a++){let l=r[a%r.length];e.addRule(`.monaco-editor .${n.getInlineClassNameOfLevel(a).replace(/ /g,".")} { --guide-color: ${l.guideColor}; --guide-color-active: ${l.guideColorActive}; }`)}e.addRule(".monaco-editor .vertical { box-shadow: 1px 0 0 0 var(--guide-color) inset; }"),e.addRule(".monaco-editor .horizontal-top { border-top: 1px solid var(--guide-color); }"),e.addRule(".monaco-editor .horizontal-bottom { border-bottom: 1px solid var(--guide-color); }"),e.addRule(`.monaco-editor .vertical.${n.activeClassName} { box-shadow: 1px 0 0 0 var(--guide-color-active) inset; }`),e.addRule(`.monaco-editor .horizontal-top.${n.activeClassName} { border-top: 1px solid var(--guide-color-active); }`),e.addRule(`.monaco-editor .horizontal-bottom.${n.activeClassName} { border-bottom: 1px solid var(--guide-color-active); }`)}if(s.length>0){for(let a=0;a<30;a++){let l=s[a%s.length];e.addRule(`.monaco-editor .lines-content .core-guide-indent.lvl-${a} { --indent-color: ${l.indentColor}; --indent-color-active: ${l.indentColorActive}; }`)}e.addRule(".monaco-editor .lines-content .core-guide-indent { box-shadow: 1px 0 0 0 var(--indent-color) inset; }"),e.addRule(".monaco-editor .lines-content .core-guide-indent.indent-active { box-shadow: 1px 0 0 0 var(--indent-color-active) inset; }")}});var Kh=class o extends Ki{static CLASS_NAME="line-numbers";_context;_lineHeight;_renderLineNumbers;_renderCustomLineNumbers;_renderFinalNewline;_lineNumbersLeft;_lineNumbersWidth;_lastCursorModelPosition;_renderResult;_activeLineNumber;constructor(e){super(),this._context=e,this._readConfig(),this._lastCursorModelPosition=new P(1,1),this._renderResult=null,this._activeLineNumber=1,this._context.addEventHandler(this)}_readConfig(){let e=this._context.configuration.options;this._lineHeight=e.get(68);let t=e.get(69);this._renderLineNumbers=t.renderType,this._renderCustomLineNumbers=t.renderFn,this._renderFinalNewline=e.get(97);let n=e.get(147);this._lineNumbersLeft=n.lineNumbersLeft,this._lineNumbersWidth=n.lineNumbersWidth}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){return this._readConfig(),!0}onCursorStateChanged(e){let t=e.selections[0].getPosition();this._lastCursorModelPosition=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(t);let n=!1;return this._activeLineNumber!==t.lineNumber&&(this._activeLineNumber=t.lineNumber,n=!0),(this._renderLineNumbers===2||this._renderLineNumbers===3)&&(n=!0),n}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}onDecorationsChanged(e){return e.affectsLineNumber}_getLineRenderLineNumber(e){let t=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new P(e,1));if(t.column!==1)return"";let n=t.lineNumber;if(this._renderCustomLineNumbers)return this._renderCustomLineNumbers(n);if(this._renderLineNumbers===2){let i=Math.abs(this._lastCursorModelPosition.lineNumber-n);return i===0?'<span class="relative-current-line-number">'+n+"</span>":String(i)}if(this._renderLineNumbers===3){if(this._lastCursorModelPosition.lineNumber===n||n%10===0)return String(n);let i=this._context.viewModel.getLineCount();return n===i?String(n):""}return String(n)}prepareRender(e){if(this._renderLineNumbers===0){this._renderResult=null;return}let t=Wt?this._lineHeight%2===0?" lh-even":" lh-odd":"",n=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,r=this._context.viewModel.getDecorationsInViewport(e.visibleRange).filter(d=>!!d.options.lineNumberClassName);r.sort((d,c)=>D.compareRangesUsingEnds(d.range,c.range));let s=0,a=this._context.viewModel.getLineCount(),l=[];for(let d=n;d<=i;d++){let c=d-n,u=this._getLineRenderLineNumber(d),h="";for(;s<r.length&&r[s].range.endLineNumber<d;)s++;for(let m=s;m<r.length;m++){let{range:f,options:g}=r[m];f.startLineNumber<=d&&(h+=" "+g.lineNumberClassName)}if(!u&&!h){l[c]="";continue}d===a&&this._context.viewModel.getLineLength(d)===0&&(this._renderFinalNewline==="off"&&(u=""),this._renderFinalNewline==="dimmed"&&(h+=" dimmed-line-number")),d===this._activeLineNumber&&(h+=" active-line-number"),l[c]=`<div class="${o.CLASS_NAME}${t}${h}" style="left:${this._lineNumbersLeft}px;width:${this._lineNumbersWidth}px;">${u}</div>`}this._renderResult=l}render(e,t){if(!this._renderResult)return"";let n=t-e;return n<0||n>=this._renderResult.length?"":this._renderResult[n]}};Ui((o,e)=>{let t=o.getColor(oN),n=o.getColor(bN);n?e.addRule(`.monaco-editor .line-numbers.dimmed-line-number { color: ${n}; }`):t&&e.addRule(`.monaco-editor .line-numbers.dimmed-line-number { color: ${t.transparent(.4)}; }`)});var ED=class{_currentVisibleRange;constructor(){this._currentVisibleRange=new D(1,1,1,1)}getCurrentVisibleRange(){return this._currentVisibleRange}setCurrentVisibleRange(e){this._currentVisibleRange=e}},_D=class{constructor(e,t,n,i,r,s,a){this.minimalReveal=e;this.lineNumber=t;this.startColumn=n;this.endColumn=i;this.startScrollTop=r;this.stopScrollTop=s;this.scrollType=a;this.minLineNumber=t,this.maxLineNumber=t}type="range";minLineNumber;maxLineNumber},TD=class{constructor(e,t,n,i,r){this.minimalReveal=e;this.selections=t;this.startScrollTop=n;this.stopScrollTop=i;this.scrollType=r;let s=t[0].startLineNumber,a=t[0].endLineNumber;for(let l=1,d=t.length;l<d;l++){let c=t[l];s=Math.min(s,c.startLineNumber),a=Math.max(a,c.endLineNumber)}this.minLineNumber=s,this.maxLineNumber=a}type="selections";minLineNumber;maxLineNumber},RC=class o extends At{static HORIZONTAL_EXTRA_PX=30;_linesContent;_textRangeRestingSpot;_visibleLines;domNode;_lineHeight;_typicalHalfwidthCharacterWidth;_isViewportWrapping;_revealHorizontalRightPadding;_cursorSurroundingLines;_cursorSurroundingLinesStyle;_canUseLayerHinting;_viewLineOptions;_maxLineWidth;_asyncUpdateLineWidths;_asyncCheckMonospaceFontAssumptions;_horizontalRevealRequest;_lastRenderedData;_stickyScrollEnabled;_maxNumberStickyLines;constructor(e,t){super(e);let n=this._context.configuration,i=this._context.configuration.options,r=i.get(51),s=i.get(148);this._lineHeight=i.get(68),this._typicalHalfwidthCharacterWidth=r.typicalHalfwidthCharacterWidth,this._isViewportWrapping=s.isViewportWrapping,this._revealHorizontalRightPadding=i.get(102),this._cursorSurroundingLines=i.get(29),this._cursorSurroundingLinesStyle=i.get(30),this._canUseLayerHinting=!i.get(32),this._viewLineOptions=new Tg(n,this._context.theme.type),this._linesContent=t,this._textRangeRestingSpot=document.createElement("div"),this._visibleLines=new yh({createLine:()=>new jr(this._viewLineOptions)}),this.domNode=this._visibleLines.domNode,Rn.write(this.domNode,8),this.domNode.setClassName(`view-lines ${_a}`),ln(this.domNode,r),this._maxLineWidth=0,this._asyncUpdateLineWidths=new Qt(()=>{this._updateLineWidthsSlow()},200),this._asyncCheckMonospaceFontAssumptions=new Qt(()=>{this._checkMonospaceFontAssumptions()},2e3),this._lastRenderedData=new ED,this._horizontalRevealRequest=null,this._stickyScrollEnabled=i.get(117).enabled,this._maxNumberStickyLines=i.get(117).maxLineCount}dispose(){this._asyncUpdateLineWidths.dispose(),this._asyncCheckMonospaceFontAssumptions.dispose(),super.dispose()}getDomNode(){return this.domNode}onConfigurationChanged(e){this._visibleLines.onConfigurationChanged(e),e.hasChanged(148)&&(this._maxLineWidth=0);let t=this._context.configuration.options,n=t.get(51),i=t.get(148);return this._lineHeight=t.get(68),this._typicalHalfwidthCharacterWidth=n.typicalHalfwidthCharacterWidth,this._isViewportWrapping=i.isViewportWrapping,this._revealHorizontalRightPadding=t.get(102),this._cursorSurroundingLines=t.get(29),this._cursorSurroundingLinesStyle=t.get(30),this._canUseLayerHinting=!t.get(32),this._stickyScrollEnabled=t.get(117).enabled,this._maxNumberStickyLines=t.get(117).maxLineCount,ln(this.domNode,n),this._onOptionsMaybeChanged(),e.hasChanged(147)&&(this._maxLineWidth=0),!0}_onOptionsMaybeChanged(){let e=this._context.configuration,t=new Tg(e,this._context.theme.type);if(!this._viewLineOptions.equals(t)){this._viewLineOptions=t;let n=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();for(let r=n;r<=i;r++)this._visibleLines.getVisibleLine(r).onOptionsChanged(this._viewLineOptions);return!0}return!1}onCursorStateChanged(e){let t=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber(),i=!1;for(let r=t;r<=n;r++)i=this._visibleLines.getVisibleLine(r).onSelectionChanged()||i;return i}onDecorationsChanged(e){{let t=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber();for(let i=t;i<=n;i++)this._visibleLines.getVisibleLine(i).onDecorationsChanged()}return!0}onFlushed(e){let t=this._visibleLines.onFlushed(e);return this._maxLineWidth=0,t}onLinesChanged(e){return this._visibleLines.onLinesChanged(e)}onLinesDeleted(e){return this._visibleLines.onLinesDeleted(e)}onLinesInserted(e){return this._visibleLines.onLinesInserted(e)}onRevealRangeRequest(e){let t=this._computeScrollTopToRevealRange(this._context.viewLayout.getFutureViewport(),e.source,e.minimalReveal,e.range,e.selections,e.verticalType);if(t===-1)return!1;let n=this._context.viewLayout.validateScrollPosition({scrollTop:t});e.revealHorizontal?e.range&&e.range.startLineNumber!==e.range.endLineNumber?n={scrollTop:n.scrollTop,scrollLeft:0}:e.range?this._horizontalRevealRequest=new _D(e.minimalReveal,e.range.startLineNumber,e.range.startColumn,e.range.endColumn,this._context.viewLayout.getCurrentScrollTop(),n.scrollTop,e.scrollType):e.selections&&e.selections.length>0&&(this._horizontalRevealRequest=new TD(e.minimalReveal,e.selections,this._context.viewLayout.getCurrentScrollTop(),n.scrollTop,e.scrollType)):this._horizontalRevealRequest=null;let r=Math.abs(this._context.viewLayout.getCurrentScrollTop()-n.scrollTop)<=this._lineHeight?1:e.scrollType;return this._context.viewModel.viewLayout.setScrollPosition(n,r),!0}onScrollChanged(e){if(this._horizontalRevealRequest&&e.scrollLeftChanged&&(this._horizontalRevealRequest=null),this._horizontalRevealRequest&&e.scrollTopChanged){let t=Math.min(this._horizontalRevealRequest.startScrollTop,this._horizontalRevealRequest.stopScrollTop),n=Math.max(this._horizontalRevealRequest.startScrollTop,this._horizontalRevealRequest.stopScrollTop);(e.scrollTop<t||e.scrollTop>n)&&(this._horizontalRevealRequest=null)}return this.domNode.setWidth(e.scrollWidth),this._visibleLines.onScrollChanged(e)||!0}onTokensChanged(e){return this._visibleLines.onTokensChanged(e)}onZonesChanged(e){return this._context.viewModel.viewLayout.setMaxLineWidth(this._maxLineWidth),this._visibleLines.onZonesChanged(e)}onThemeChanged(e){return this._onOptionsMaybeChanged()}getPositionFromDOMInfo(e,t){let n=this._getViewLineDomNode(e);if(n===null)return null;let i=this._getLineNumberFor(n);if(i===-1||i<1||i>this._context.viewModel.getLineCount())return null;if(this._context.viewModel.getLineMaxColumn(i)===1)return new P(i,1);let r=this._visibleLines.getStartLineNumber(),s=this._visibleLines.getEndLineNumber();if(i<r||i>s)return null;let a=this._visibleLines.getVisibleLine(i).getColumnOfNodeOffset(e,t),l=this._context.viewModel.getLineMinColumn(i);return a<l&&(a=l),new P(i,a)}_getViewLineDomNode(e){for(;e&&e.nodeType===1;){if(e.className===jr.CLASS_NAME)return e;e=e.parentElement}return null}_getLineNumberFor(e){let t=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber();for(let i=t;i<=n;i++){let r=this._visibleLines.getVisibleLine(i);if(e===r.getDomNode())return i}return-1}getLineWidth(e){let t=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber();if(e<t||e>n)return-1;let i=new Ih(this.domNode.domNode,this._textRangeRestingSpot),r=this._visibleLines.getVisibleLine(e).getWidth(i);return this._updateLineWidthsSlowIfDomDidLayout(i),r}linesVisibleRangesForRange(e,t){if(this.shouldRender())return null;let n=e.endLineNumber,i=D.intersectRanges(e,this._lastRenderedData.getCurrentVisibleRange());if(!i)return null;let r=[],s=0,a=new Ih(this.domNode.domNode,this._textRangeRestingSpot),l=0;t&&(l=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new P(i.startLineNumber,1)).lineNumber);let d=this._visibleLines.getStartLineNumber(),c=this._visibleLines.getEndLineNumber();for(let u=i.startLineNumber;u<=i.endLineNumber;u++){if(u<d||u>c)continue;let h=u===i.startLineNumber?i.startColumn:1,m=u!==i.endLineNumber,f=m?this._context.viewModel.getLineMaxColumn(u):i.endColumn,g=this._visibleLines.getVisibleLine(u).getVisibleRangesForRange(u,h,f,a);if(g){if(t&&u<n){let b=l;l=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new P(u+1,1)).lineNumber,b!==l&&(g.ranges[g.ranges.length-1].width+=this._typicalHalfwidthCharacterWidth)}r[s++]=new DI(g.outsideRenderedLine,u,vh.from(g.ranges),m)}}return this._updateLineWidthsSlowIfDomDidLayout(a),s===0?null:r}_visibleRangesForLineRange(e,t,n){if(this.shouldRender()||e<this._visibleLines.getStartLineNumber()||e>this._visibleLines.getEndLineNumber())return null;let i=new Ih(this.domNode.domNode,this._textRangeRestingSpot),r=this._visibleLines.getVisibleLine(e).getVisibleRangesForRange(e,t,n,i);return this._updateLineWidthsSlowIfDomDidLayout(i),r}visibleRangeForPosition(e){let t=this._visibleRangesForLineRange(e.lineNumber,e.column,e.column);return t?new kI(t.outsideRenderedLine,t.ranges[0].left):null}updateLineWidths(){this._updateLineWidths(!1)}_updateLineWidthsFast(){return this._updateLineWidths(!0)}_updateLineWidthsSlow(){this._updateLineWidths(!1)}_updateLineWidthsSlowIfDomDidLayout(e){e.didDomLayout&&(this._asyncUpdateLineWidths.isScheduled()||(this._asyncUpdateLineWidths.cancel(),this._updateLineWidthsSlow()))}_updateLineWidths(e){let t=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber(),i=1,r=!0;for(let s=t;s<=n;s++){let a=this._visibleLines.getVisibleLine(s);if(e&&!a.getWidthIsFast()){r=!1;continue}i=Math.max(i,a.getWidth(null))}return r&&t===1&&n===this._context.viewModel.getLineCount()&&(this._maxLineWidth=0),this._ensureMaxLineWidth(i),r}_checkMonospaceFontAssumptions(){let e=-1,t=-1,n=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();for(let r=n;r<=i;r++){let s=this._visibleLines.getVisibleLine(r);if(s.needsMonospaceFontCheck()){let a=s.getWidth(null);a>t&&(t=a,e=r)}}if(e!==-1&&!this._visibleLines.getVisibleLine(e).monospaceAssumptionsAreValid())for(let r=n;r<=i;r++)this._visibleLines.getVisibleLine(r).onMonospaceAssumptionsInvalidated()}prepareRender(){throw new Error("Not supported")}render(){throw new Error("Not supported")}renderText(e){if(this._visibleLines.renderLines(e),this._lastRenderedData.setCurrentVisibleRange(e.visibleRange),this.domNode.setWidth(this._context.viewLayout.getScrollWidth()),this.domNode.setHeight(Math.min(this._context.viewLayout.getScrollHeight(),1e6)),this._horizontalRevealRequest){let n=this._horizontalRevealRequest;if(e.startLineNumber<=n.minLineNumber&&n.maxLineNumber<=e.endLineNumber){this._horizontalRevealRequest=null,this.onDidRender();let i=this._computeScrollLeftToReveal(n);i&&(this._isViewportWrapping||this._ensureMaxLineWidth(i.maxHorizontalOffset),this._context.viewModel.viewLayout.setScrollPosition({scrollLeft:i.scrollLeft},n.scrollType))}}if(this._updateLineWidthsFast()?this._asyncUpdateLineWidths.cancel():this._asyncUpdateLineWidths.schedule(),Wt&&!this._asyncCheckMonospaceFontAssumptions.isScheduled()){let n=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();for(let r=n;r<=i;r++)if(this._visibleLines.getVisibleLine(r).needsMonospaceFontCheck()){this._asyncCheckMonospaceFontAssumptions.schedule();break}}this._linesContent.setLayerHinting(this._canUseLayerHinting),this._linesContent.setContain("strict");let t=this._context.viewLayout.getCurrentScrollTop()-e.bigNumbersDelta;this._linesContent.setTop(-t),this._linesContent.setLeft(-this._context.viewLayout.getCurrentScrollLeft())}_ensureMaxLineWidth(e){let t=Math.ceil(e);this._maxLineWidth<t&&(this._maxLineWidth=t,this._context.viewModel.viewLayout.setMaxLineWidth(this._maxLineWidth))}_computeScrollTopToRevealRange(e,t,n,i,r,s){let a=e.top,l=e.height,d=a+l,c,u,h;if(r&&r.length>0){let y=r[0].startLineNumber,C=r[0].endLineNumber;for(let x=1,L=r.length;x<L;x++){let k=r[x];y=Math.min(y,k.startLineNumber),C=Math.max(C,k.endLineNumber)}c=!1,u=this._context.viewLayout.getVerticalOffsetForLineNumber(y),h=this._context.viewLayout.getVerticalOffsetForLineNumber(C)+this._lineHeight}else if(i)c=!0,u=this._context.viewLayout.getVerticalOffsetForLineNumber(i.startLineNumber),h=this._context.viewLayout.getVerticalOffsetForLineNumber(i.endLineNumber)+this._lineHeight;else return-1;let m=(t==="mouse"||n)&&this._cursorSurroundingLinesStyle==="default",f=0,g=0;if(m)n||(f=this._lineHeight);else{let y=l/this._lineHeight,C=Math.max(this._cursorSurroundingLines,this._stickyScrollEnabled?this._maxNumberStickyLines:0),x=Math.min(y/2,C);f=x*this._lineHeight,g=Math.max(0,x-1)*this._lineHeight}n||(s===0||s===4)&&(g+=this._lineHeight),u-=f,h+=g;let b;if(h-u>l){if(!c)return-1;b=u}else if(s===5||s===6)if(s===6&&a<=u&&h<=d)b=a;else{let y=Math.max(5*this._lineHeight,l*.2),C=u-y,x=h-l;b=Math.max(x,C)}else if(s===1||s===2)if(s===2&&a<=u&&h<=d)b=a;else{let y=(u+h)/2;b=Math.max(0,y-l/2)}else b=this._computeMinimumScrolling(a,d,u,h,s===3,s===4);return b}_computeScrollLeftToReveal(e){let t=this._context.viewLayout.getCurrentViewport(),n=this._context.configuration.options.get(147),i=t.left,r=i+t.width-n.verticalScrollbarWidth,s=1073741824,a=0;if(e.type==="range"){let d=this._visibleRangesForLineRange(e.lineNumber,e.startColumn,e.endColumn);if(!d)return null;for(let c of d.ranges)s=Math.min(s,Math.round(c.left)),a=Math.max(a,Math.round(c.left+c.width))}else for(let d of e.selections){if(d.startLineNumber!==d.endLineNumber)return null;let c=this._visibleRangesForLineRange(d.startLineNumber,d.startColumn,d.endColumn);if(!c)return null;for(let u of c.ranges)s=Math.min(s,Math.round(u.left)),a=Math.max(a,Math.round(u.left+u.width))}return e.minimalReveal||(s=Math.max(0,s-o.HORIZONTAL_EXTRA_PX),a+=this._revealHorizontalRightPadding),e.type==="selections"&&a-s>t.width?null:{scrollLeft:this._computeMinimumScrolling(i,r,s,a),maxHorizontalOffset:a}}_computeMinimumScrolling(e,t,n,i,r,s){e=e|0,t=t|0,n=n|0,i=i|0,r=!!r,s=!!s;let a=t-e;if(i-n<a){if(r)return n;if(s)return Math.max(0,i-a);if(n<e)return n;if(i>t)return Math.max(0,i-a)}else return n;return e}};var MC=class extends Uh{_context;_decorationsLeft;_decorationsWidth;_renderResult;constructor(e){super(),this._context=e;let n=this._context.configuration.options.get(147);this._decorationsLeft=n.decorationsLeft,this._decorationsWidth=n.decorationsWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){let n=this._context.configuration.options.get(147);return this._decorationsLeft=n.decorationsLeft,this._decorationsWidth=n.decorationsWidth,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_getDecorations(e){let t=e.getDecorationsInViewport(),n=[],i=0;for(let r=0,s=t.length;r<s;r++){let a=t[r],l=a.options.linesDecorationsClassName,d=a.options.zIndex;l&&(n[i++]=new vc(a.range.startLineNumber,a.range.endLineNumber,l,a.options.linesDecorationsTooltip??null,d));let c=a.options.firstLineDecorationClassName;c&&(n[i++]=new vc(a.range.startLineNumber,a.range.startLineNumber,c,a.options.linesDecorationsTooltip??null,d))}return n}prepareRender(e){let t=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber,i=this._render(t,n,this._getDecorations(e)),r=this._decorationsLeft.toString(),s=this._decorationsWidth.toString(),a='" style="left:'+r+"px;width:"+s+'px;"></div>',l=[];for(let d=t;d<=n;d++){let c=d-t,u=i[c].getDecorations(),h="";for(let m of u){let f='<div class="cldr '+m.className;m.tooltip!==null&&(f+='" title="'+m.tooltip),f+=a,h+=f}l[c]=h}this._renderResult=l}render(e,t){return this._renderResult?this._renderResult[t-e]:""}};var Gh=class o extends At{static CLASS_NAME="glyph-margin";static OUTER_CLASS_NAME="margin";_domNode;_canUseLayerHinting;_contentLeft;_glyphMarginLeft;_glyphMarginWidth;_glyphMarginBackgroundDomNode;constructor(e){super(e);let t=this._context.configuration.options,n=t.get(147);this._canUseLayerHinting=!t.get(32),this._contentLeft=n.contentLeft,this._glyphMarginLeft=n.glyphMarginLeft,this._glyphMarginWidth=n.glyphMarginWidth,this._domNode=Oe(document.createElement("div")),this._domNode.setClassName(o.OUTER_CLASS_NAME),this._domNode.setPosition("absolute"),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._glyphMarginBackgroundDomNode=Oe(document.createElement("div")),this._glyphMarginBackgroundDomNode.setClassName(o.CLASS_NAME),this._domNode.appendChild(this._glyphMarginBackgroundDomNode)}dispose(){super.dispose()}getDomNode(){return this._domNode}onConfigurationChanged(e){let t=this._context.configuration.options,n=t.get(147);return this._canUseLayerHinting=!t.get(32),this._contentLeft=n.contentLeft,this._glyphMarginLeft=n.glyphMarginLeft,this._glyphMarginWidth=n.glyphMarginWidth,!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollTopChanged}prepareRender(e){}render(e){this._domNode.setLayerHinting(this._canUseLayerHinting),this._domNode.setContain("strict");let t=e.scrollTop-e.bigNumbersDelta;this._domNode.setTop(-t);let n=Math.min(e.scrollHeight,1e6);this._domNode.setHeight(n),this._domNode.setWidth(this._contentLeft),this._glyphMarginBackgroundDomNode.setLeft(this._glyphMarginLeft),this._glyphMarginBackgroundDomNode.setWidth(this._glyphMarginWidth),this._glyphMarginBackgroundDomNode.setHeight(n)}};var AC=class extends Uh{_context;_renderResult;constructor(e){super(),this._context=e,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){return!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_getDecorations(e){let t=e.getDecorationsInViewport(),n=[],i=0;for(let r=0,s=t.length;r<s;r++){let a=t[r],l=a.options.marginClassName,d=a.options.zIndex;l&&(n[i++]=new vc(a.range.startLineNumber,a.range.endLineNumber,l,null,d))}return n}prepareRender(e){let t=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber,i=this._render(t,n,this._getDecorations(e)),r=[];for(let s=t;s<=n;s++){let a=s-t,l=i[a].getDecorations(),d="";for(let c of l)d+='<div class="cmdr '+c.className+'" style=""></div>';r[a]=d}this._renderResult=r}render(e,t){return this._renderResult?this._renderResult[t-e]:""}};var Yr=class o{_rgba8Brand=void 0;static Empty=new o(0,0,0,0);r;g;b;a;constructor(e,t,n,i){this.r=o._clamp(e),this.g=o._clamp(t),this.b=o._clamp(n),this.a=o._clamp(i)}equals(e){return this.r===e.r&&this.g===e.g&&this.b===e.b&&this.a===e.a}static _clamp(e){return e<0?0:e>255?255:e|0}};var WP=(()=>{let o=[];for(let e=32;e<=126;e++)o.push(e);return o.push(65533),o})(),HP=(o,e)=>(o-=32,o<0||o>96?e<=2?(o+96)%96:95:o);var Wg=class o{constructor(e,t){this.scale=t;this.charDataNormal=o.soften(e,12/15),this.charDataLight=o.soften(e,50/60)}_minimapCharRendererBrand=void 0;charDataNormal;charDataLight;static soften(e,t){let n=new Uint8ClampedArray(e.length);for(let i=0,r=e.length;i<r;i++)n[i]=dd(e[i]*t);return n}renderChar(e,t,n,i,r,s,a,l,d,c,u){let h=1*this.scale,m=2*this.scale,f=u?1:m;if(t+h>e.width||n+f>e.height){console.warn("bad render request outside image data");return}let g=c?this.charDataLight:this.charDataNormal,b=HP(i,d),y=e.width*4,C=a.r,x=a.g,L=a.b,k=r.r-C,O=r.g-x,W=r.b-L,z=Math.max(s,l),B=e.data,G=b*h*m,q=n*y+t*4;for(let X=0;X<f;X++){let ce=q;for(let Ce=0;Ce<h;Ce++){let te=g[G++]/255*(s/255);B[ce++]=C+k*te,B[ce++]=x+O*te,B[ce++]=L+W*te,B[ce++]=z}q+=y}}blockRenderChar(e,t,n,i,r,s,a,l){let d=1*this.scale,c=2*this.scale,u=l?1:c;if(t+d>e.width||n+u>e.height){console.warn("bad render request outside image data");return}let h=e.width*4,m=.5*(r/255),f=s.r,g=s.g,b=s.b,y=i.r-f,C=i.g-g,x=i.b-b,L=f+y*m,k=g+C*m,O=b+x*m,W=Math.max(r,a),z=e.data,B=n*h+t*4;for(let G=0;G<u;G++){let q=B;for(let X=0;X<d;X++)z[q++]=L,z[q++]=k,z[q++]=O,z[q++]=W;B+=h}}};var jh=class o extends V{static _INSTANCE=null;static getInstance(){return this._INSTANCE||(this._INSTANCE=ja(new o)),this._INSTANCE}_colors;_backgroundIsLight;_onDidChange=new E;onDidChange=this._onDidChange.event;constructor(){super(),this._updateColorMap(),this._register(xo.onDidChange(e=>{e.changedColorMap&&this._updateColorMap()}))}_updateColorMap(){let e=xo.getColorMap();if(!e){this._colors=[Yr.Empty],this._backgroundIsLight=!0;return}this._colors=[Yr.Empty];for(let n=1;n<e.length;n++){let i=e[n].rgba;this._colors[n]=new Yr(i.r,i.g,i.b,Math.round(i.a*255))}let t=e[2].getRelativeLuminance();this._backgroundIsLight=t>=.5,this._onDidChange.fire(void 0)}getColor(e){return(e<1||e>=this._colors.length)&&(e=2),this._colors[e]}backgroundIsLight(){return this._backgroundIsLight}};var zP={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15},KP=o=>{let e=new Uint8ClampedArray(o.length/2);for(let t=0;t<o.length;t+=2)e[t>>1]=zP[o[t]]<<4|zP[o[t+1]]&15;return e},LD={1:vr(()=>KP("0000511D6300CF609C709645A78432005642574171487021003C451900274D35D762755E8B629C5BA856AF57BA649530C167D1512A272A3F6038604460398526BCA2A968DB6F8957C768BE5FBE2FB467CF5D8D5B795DC7625B5DFF50DE64C466DB2FC47CD860A65E9A2EB96CB54CE06DA763AB2EA26860524D3763536601005116008177A8705E53AB738E6A982F88BAA35B5F5B626D9C636B449B737E5B7B678598869A662F6B5B8542706C704C80736A607578685B70594A49715A4522E792")),2:vr(()=>KP("000000000000000055394F383D2800008B8B1F210002000081B1CBCBCC820000847AAF6B9AAF2119BE08B8881AD60000A44FD07DCCF107015338130C00000000385972265F390B406E2437634B4B48031B12B8A0847000001E15B29A402F0000000000004B33460B00007A752C2A0000000000004D3900000084394B82013400ABA5CFC7AD9C0302A45A3E5A98AB000089A43382D97900008BA54AA087A70A0248A6A7AE6DBE0000BF6F94987EA40A01A06DCFA7A7A9030496C32F77891D0000A99FB1A0AFA80603B29AB9CA75930D010C0948354D3900000C0948354F37460D0028BE673D8400000000AF9D7B6E00002B007AA8933400007AA642675C2700007984CFB9C3985B768772A8A6B7B20000CAAECAAFC4B700009F94A6009F840009D09F9BA4CA9C0000CC8FC76DC87F0000C991C472A2000000A894A48CA7B501079BA2C9C69BA20000B19A5D3FA89000005CA6009DA2960901B0A7F0669FB200009D009E00B7890000DAD0F5D092820000D294D4C48BD10000B5A7A4A3B1A50402CAB6CBA6A2000000B5A7A4A3B1A8044FCDADD19D9CB00000B7778F7B8AAE0803C9AB5D3F5D3F00009EA09EA0BAB006039EA0989A8C7900009B9EF4D6B7C00000A9A7816CACA80000ABAC84705D3F000096DA635CDC8C00006F486F266F263D4784006124097B00374F6D2D6D2D6D4A3A95872322000000030000000000008D8939130000000000002E22A5C9CBC70600AB25C0B5C9B400061A2DB04CA67001082AA6BEBEBFC606002321DACBC19E03087AA08B6768380000282FBAC0B8CA7A88AD25BBA5A29900004C396C5894A6000040485A6E356E9442A32CD17EADA70000B4237923628600003E2DE9C1D7B500002F25BBA5A2990000231DB6AFB4A804023025C0B5CAB588062B2CBDBEC0C706882435A75CA20000002326BD6A82A908048B4B9A5A668000002423A09CB4BB060025259C9D8A7900001C1FCAB2C7C700002A2A9387ABA200002626A4A47D6E9D14333163A0C87500004B6F9C2D643A257049364936493647358A34438355497F1A0000A24C1D590000D38DFFBDD4CD3126"))};var OC=class o{static lastCreated;static lastFontFamily;static create(e,t){if(this.lastCreated&&e===this.lastCreated.scale&&t===this.lastFontFamily)return this.lastCreated;let n;return LD[e]?n=new Wg(LD[e](),e):n=o.createFromSampleData(o.createSampleData(t).data,e),this.lastFontFamily=t,this.lastCreated=n,n}static createSampleData(e){let t=document.createElement("canvas"),n=t.getContext("2d");t.style.height="16px",t.height=16,t.width=96*10,t.style.width=96*10+"px",n.fillStyle="#ffffff",n.font=`bold 16px ${e}`,n.textBaseline="middle";let i=0;for(let r of WP)n.fillText(String.fromCharCode(r),i,16/2),i+=10;return n.getImageData(0,0,96*10,16)}static createFromSampleData(e,t){let n=16*10*4*96;if(e.length!==n)throw new Error("Unexpected source in MinimapCharRenderer");let i=o._downsample(e,t);return new Wg(i,t)}static _downsampleChar(e,t,n,i,r){let s=1*r,a=2*r,l=i,d=0;for(let c=0;c<a;c++){let u=c/a*16,h=(c+1)/a*16;for(let m=0;m<s;m++){let f=m/s*10,g=(m+1)/s*10,b=0,y=0;for(let x=u;x<h;x++){let L=t+Math.floor(x)*3840,k=1-(x-Math.floor(x));for(let O=f;O<g;O++){let W=1-(O-Math.floor(O)),z=L+Math.floor(O)*4,B=W*k;y+=B,b+=e[z]*e[z+3]/255*B}}let C=b/y;d=Math.max(d,C),n[l++]=dd(C)}}return d}static _downsample(e,t){let n=2*t*1*t,i=n*96,r=new Uint8ClampedArray(i),s=0,a=0,l=0;for(let d=0;d<96;d++)l=Math.max(l,this._downsampleChar(e,a,r,s,t)),s+=n,a+=10*4;if(l>0){let d=255/l;for(let c=0;c<i;c++)r[c]*=d}return r}};var GP=mt?'"Segoe WPC", "Segoe UI", sans-serif':Be?"-apple-system, BlinkMacSystemFont, sans-serif":'system-ui, "Ubuntu", "Droid Sans", sans-serif';var W5=140,H5=2,NC=class o{renderMinimap;size;minimapHeightIsEditorHeight;scrollBeyondLastLine;paddingTop;paddingBottom;showSlider;autohide;pixelRatio;typicalHalfwidthCharacterWidth;lineHeight;minimapLeft;minimapWidth;minimapHeight;canvasInnerWidth;canvasInnerHeight;canvasOuterWidth;canvasOuterHeight;isSampling;editorHeight;fontScale;minimapLineHeight;minimapCharWidth;sectionHeaderFontFamily;sectionHeaderFontSize;sectionHeaderLetterSpacing;sectionHeaderFontColor;charRenderer;defaultBackgroundColor;backgroundColor;foregroundAlpha;constructor(e,t,n){let i=e.options,r=i.get(145),s=i.get(147),a=s.minimap,l=i.get(51),d=i.get(74);this.renderMinimap=a.renderMinimap,this.size=d.size,this.minimapHeightIsEditorHeight=a.minimapHeightIsEditorHeight,this.scrollBeyondLastLine=i.get(107),this.paddingTop=i.get(85).top,this.paddingBottom=i.get(85).bottom,this.showSlider=d.showSlider,this.autohide=d.autohide,this.pixelRatio=r,this.typicalHalfwidthCharacterWidth=l.typicalHalfwidthCharacterWidth,this.lineHeight=i.get(68),this.minimapLeft=a.minimapLeft,this.minimapWidth=a.minimapWidth,this.minimapHeight=s.height,this.canvasInnerWidth=a.minimapCanvasInnerWidth,this.canvasInnerHeight=a.minimapCanvasInnerHeight,this.canvasOuterWidth=a.minimapCanvasOuterWidth,this.canvasOuterHeight=a.minimapCanvasOuterHeight,this.isSampling=a.minimapIsSampling,this.editorHeight=s.height,this.fontScale=a.minimapScale,this.minimapLineHeight=a.minimapLineHeight,this.minimapCharWidth=1*this.fontScale,this.sectionHeaderFontFamily=GP,this.sectionHeaderFontSize=d.sectionHeaderFontSize*r,this.sectionHeaderLetterSpacing=d.sectionHeaderLetterSpacing,this.sectionHeaderFontColor=o._getSectionHeaderColor(t,n.getColor(1)),this.charRenderer=vr(()=>OC.create(this.fontScale,l.fontFamily)),this.defaultBackgroundColor=n.getColor(2),this.backgroundColor=o._getMinimapBackground(t,this.defaultBackgroundColor),this.foregroundAlpha=o._getMinimapForegroundOpacity(t)}static _getMinimapBackground(e,t){let n=e.getColor(xA);return n?new Yr(n.rgba.r,n.rgba.g,n.rgba.b,Math.round(255*n.rgba.a)):t}static _getMinimapForegroundOpacity(e){let t=e.getColor(EA);return t?Yr._clamp(Math.round(255*t.rgba.a)):255}static _getSectionHeaderColor(e,t){let n=e.getColor(Es);return n?new Yr(n.rgba.r,n.rgba.g,n.rgba.b,Math.round(255*n.rgba.a)):t}equals(e){return this.renderMinimap===e.renderMinimap&&this.size===e.size&&this.minimapHeightIsEditorHeight===e.minimapHeightIsEditorHeight&&this.scrollBeyondLastLine===e.scrollBeyondLastLine&&this.paddingTop===e.paddingTop&&this.paddingBottom===e.paddingBottom&&this.showSlider===e.showSlider&&this.autohide===e.autohide&&this.pixelRatio===e.pixelRatio&&this.typicalHalfwidthCharacterWidth===e.typicalHalfwidthCharacterWidth&&this.lineHeight===e.lineHeight&&this.minimapLeft===e.minimapLeft&&this.minimapWidth===e.minimapWidth&&this.minimapHeight===e.minimapHeight&&this.canvasInnerWidth===e.canvasInnerWidth&&this.canvasInnerHeight===e.canvasInnerHeight&&this.canvasOuterWidth===e.canvasOuterWidth&&this.canvasOuterHeight===e.canvasOuterHeight&&this.isSampling===e.isSampling&&this.editorHeight===e.editorHeight&&this.fontScale===e.fontScale&&this.minimapLineHeight===e.minimapLineHeight&&this.minimapCharWidth===e.minimapCharWidth&&this.sectionHeaderFontSize===e.sectionHeaderFontSize&&this.sectionHeaderLetterSpacing===e.sectionHeaderLetterSpacing&&this.defaultBackgroundColor&&this.defaultBackgroundColor.equals(e.defaultBackgroundColor)&&this.backgroundColor&&this.backgroundColor.equals(e.backgroundColor)&&this.foregroundAlpha===e.foregroundAlpha}},DD=class o{constructor(e,t,n,i,r,s,a,l,d){this.scrollTop=e;this.scrollHeight=t;this.sliderNeeded=n;this._computedSliderRatio=i;this.sliderTop=r;this.sliderHeight=s;this.topPaddingLineCount=a;this.startLineNumber=l;this.endLineNumber=d}getDesiredScrollTopFromDelta(e){return Math.round(this.scrollTop+e/this._computedSliderRatio)}getDesiredScrollTopFromTouchLocation(e){return Math.round((e-this.sliderHeight/2)/this._computedSliderRatio)}intersectWithViewport(e){let t=Math.max(this.startLineNumber,e.startLineNumber),n=Math.min(this.endLineNumber,e.endLineNumber);return t>n?null:[t,n]}getYForLineNumber(e,t){return+(e-this.startLineNumber+this.topPaddingLineCount)*t}static create(e,t,n,i,r,s,a,l,d,c,u){let h=e.pixelRatio,m=e.minimapLineHeight,f=Math.floor(e.canvasInnerHeight/m),g=e.lineHeight;if(e.minimapHeightIsEditorHeight){let O=l*e.lineHeight+e.paddingTop+e.paddingBottom;e.scrollBeyondLastLine&&(O+=Math.max(0,r-e.lineHeight-e.paddingBottom));let W=Math.max(1,Math.floor(r*r/O)),z=Math.max(0,e.minimapHeight-W),B=z/(c-r),G=d*B,q=z>0,X=Math.floor(e.canvasInnerHeight/e.minimapLineHeight),ce=Math.floor(e.paddingTop/e.lineHeight);return new o(d,c,q,B,G,W,ce,1,Math.min(a,X))}let b;if(s&&n!==a){let O=n-t+1;b=Math.floor(O*m/h)}else{let O=r/g;b=Math.floor(O*m/h)}let y=Math.floor(e.paddingTop/g),C=Math.floor(e.paddingBottom/g);if(e.scrollBeyondLastLine){let O=r/g;C=Math.max(C,O-1)}let x;if(C>0){let O=r/g;x=(y+a+C-O-1)*m/h}else x=Math.max(0,(y+a)*m/h-b);x=Math.min(e.minimapHeight-b,x);let L=x/(c-r),k=d*L;if(f>=y+a+C){let O=x>0;return new o(d,c,O,L,k,b,y,1,a)}else{let O;t>1?O=t+y:O=Math.max(1,d/g);let W,z=Math.max(1,Math.floor(O-k*h/m));z<y?(W=y-z+1,z=1):(W=0,z=Math.max(1,z-y)),u&&u.scrollHeight===c&&(u.scrollTop>d&&(z=Math.min(z,u.startLineNumber),W=Math.max(W,u.topPaddingLineCount)),u.scrollTop<d&&(z=Math.max(z,u.startLineNumber),W=Math.min(W,u.topPaddingLineCount)));let B=Math.min(a,z-W+f-1),G=(d-i)/g,q;return d>=e.paddingTop?q=(t-z+W+G)*m/h:q=d/e.paddingTop*(W+G)*m/h,new o(d,c,!0,L,q,b,W,z,B)}}},PC=class o{static INVALID=new o(-1);dy;constructor(e){this.dy=e}onContentChanged(){this.dy=-1}onTokensChanged(){this.dy=-1}},FC=class{renderedLayout;_imageData;_renderedLines;constructor(e,t,n){this.renderedLayout=e,this._imageData=t,this._renderedLines=new wg({createLine:()=>PC.INVALID}),this._renderedLines._set(e.startLineNumber,n)}linesEquals(e){if(!this.scrollEquals(e))return!1;let n=this._renderedLines._get().lines;for(let i=0,r=n.length;i<r;i++)if(n[i].dy===-1)return!1;return!0}scrollEquals(e){return this.renderedLayout.startLineNumber===e.startLineNumber&&this.renderedLayout.endLineNumber===e.endLineNumber}_get(){let e=this._renderedLines._get();return{imageData:this._imageData,rendLineNumberStart:e.rendLineNumberStart,lines:e.lines}}onLinesChanged(e,t){return this._renderedLines.onLinesChanged(e,t)}onLinesDeleted(e,t){this._renderedLines.onLinesDeleted(e,t)}onLinesInserted(e,t){this._renderedLines.onLinesInserted(e,t)}onTokensChanged(e){return this._renderedLines.onTokensChanged(e)}},kD=class o{_backgroundFillData;_buffers;_lastUsedBuffer;constructor(e,t,n,i){this._backgroundFillData=o._createBackgroundFillData(t,n,i),this._buffers=[e.createImageData(t,n),e.createImageData(t,n)],this._lastUsedBuffer=0}getBuffer(){this._lastUsedBuffer=1-this._lastUsedBuffer;let e=this._buffers[this._lastUsedBuffer];return e.data.set(this._backgroundFillData),e}static _createBackgroundFillData(e,t,n){let i=n.r,r=n.g,s=n.b,a=n.a,l=new Uint8ClampedArray(e*t*4),d=0;for(let c=0;c<t;c++)for(let u=0;u<e;u++)l[d]=i,l[d+1]=r,l[d+2]=s,l[d+3]=a,d+=4;return l}},BC=class o{constructor(e,t){this.samplingRatio=e;this.minimapLines=t}static compute(e,t,n){if(e.renderMinimap===0||!e.isSampling)return[null,[]];let{minimapLineCount:i}=Cm.computeContainedMinimapLineCount({viewLineCount:t,scrollBeyondLastLine:e.scrollBeyondLastLine,paddingTop:e.paddingTop,paddingBottom:e.paddingBottom,height:e.editorHeight,lineHeight:e.lineHeight,pixelRatio:e.pixelRatio}),r=t/i,s=r/2;if(!n||n.minimapLines.length===0){let b=[];if(b[0]=1,i>1){for(let y=0,C=i-1;y<C;y++)b[y]=Math.round(y*r+s);b[i-1]=t}return[new o(r,b),[]]}let a=n.minimapLines,l=a.length,d=[],c=0,u=0,h=1,m=10,f=[],g=null;for(let b=0;b<i;b++){let y=Math.max(h,Math.round(b*r)),C=Math.max(y,Math.round((b+1)*r));for(;c<l&&a[c]<y;){if(f.length<m){let L=c+1+u;g&&g.type==="deleted"&&g._oldIndex===c-1?g.deleteToLineNumber++:(g={type:"deleted",_oldIndex:c,deleteFromLineNumber:L,deleteToLineNumber:L},f.push(g)),u--}c++}let x;if(c<l&&a[c]<=C)x=a[c],c++;else if(b===0?x=1:b+1===i?x=t:x=Math.round(b*r+s),f.length<m){let L=c+1+u;g&&g.type==="inserted"&&g._i===b-1?g.insertToLineNumber++:(g={type:"inserted",_i:b,insertFromLineNumber:L,insertToLineNumber:L},f.push(g)),u++}d[b]=x,h=x}if(f.length<m)for(;c<l;){let b=c+1+u;g&&g.type==="deleted"&&g._oldIndex===c-1?g.deleteToLineNumber++:(g={type:"deleted",_oldIndex:c,deleteFromLineNumber:b,deleteToLineNumber:b},f.push(g)),u--,c++}else f=[{type:"flush"}];return[new o(r,d),f]}modelLineToMinimapLine(e){return Math.min(this.minimapLines.length,Math.max(1,Math.round(e/this.samplingRatio)))}modelLineRangeToMinimapLineRange(e,t){let n=this.modelLineToMinimapLine(e)-1;for(;n>0&&this.minimapLines[n-1]>=e;)n--;let i=this.modelLineToMinimapLine(t)-1;for(;i+1<this.minimapLines.length&&this.minimapLines[i+1]<=t;)i++;if(n===i){let r=this.minimapLines[n];if(r<e||r>t)return null}return[n+1,i+1]}decorationLineRangeToMinimapLineRange(e,t){let n=this.modelLineToMinimapLine(e),i=this.modelLineToMinimapLine(t);return e!==t&&i===n&&(i===this.minimapLines.length?n>1&&n--:i++),[n,i]}onLinesDeleted(e){let t=e.toLineNumber-e.fromLineNumber+1,n=this.minimapLines.length,i=0;for(let r=this.minimapLines.length-1;r>=0&&!(this.minimapLines[r]<e.fromLineNumber);r--)this.minimapLines[r]<=e.toLineNumber?(this.minimapLines[r]=Math.max(1,e.fromLineNumber-1),n=Math.min(n,r),i=Math.max(i,r)):this.minimapLines[r]-=t;return[n,i]}onLinesInserted(e){let t=e.toLineNumber-e.fromLineNumber+1;for(let n=this.minimapLines.length-1;n>=0&&!(this.minimapLines[n]<e.fromLineNumber);n--)this.minimapLines[n]+=t}},VC=class extends At{tokensColorTracker;_selections;_minimapSelections;options;_samplingState;_shouldCheckSampling;_sectionHeaderCache=new fo(10,1.5);_actual;constructor(e){super(e),this.tokensColorTracker=jh.getInstance(),this._selections=[],this._minimapSelections=null,this.options=new NC(this._context.configuration,this._context.theme,this.tokensColorTracker);let[t]=BC.compute(this.options,this._context.viewModel.getLineCount(),null);this._samplingState=t,this._shouldCheckSampling=!1,this._actual=new RD(e.theme,this)}dispose(){this._actual.dispose(),super.dispose()}getDomNode(){return this._actual.getDomNode()}_onOptionsMaybeChanged(){let e=new NC(this._context.configuration,this._context.theme,this.tokensColorTracker);return this.options.equals(e)?!1:(this.options=e,this._recreateLineSampling(),this._actual.onDidChangeOptions(),!0)}onConfigurationChanged(e){return this._onOptionsMaybeChanged()}onCursorStateChanged(e){return this._selections=e.selections,this._minimapSelections=null,this._actual.onSelectionChanged()}onDecorationsChanged(e){return e.affectsMinimap?this._actual.onDecorationsChanged():!1}onFlushed(e){return this._samplingState&&(this._shouldCheckSampling=!0),this._actual.onFlushed()}onLinesChanged(e){if(this._samplingState){let t=this._samplingState.modelLineRangeToMinimapLineRange(e.fromLineNumber,e.fromLineNumber+e.count-1);return t?this._actual.onLinesChanged(t[0],t[1]-t[0]+1):!1}else return this._actual.onLinesChanged(e.fromLineNumber,e.count)}onLinesDeleted(e){if(this._samplingState){let[t,n]=this._samplingState.onLinesDeleted(e);return t<=n&&this._actual.onLinesChanged(t+1,n-t+1),this._shouldCheckSampling=!0,!0}else return this._actual.onLinesDeleted(e.fromLineNumber,e.toLineNumber)}onLinesInserted(e){return this._samplingState?(this._samplingState.onLinesInserted(e),this._shouldCheckSampling=!0,!0):this._actual.onLinesInserted(e.fromLineNumber,e.toLineNumber)}onScrollChanged(e){return this._actual.onScrollChanged()}onThemeChanged(e){return this._actual.onThemeChanged(),this._onOptionsMaybeChanged(),!0}onTokensChanged(e){if(this._samplingState){let t=[];for(let n of e.ranges){let i=this._samplingState.modelLineRangeToMinimapLineRange(n.fromLineNumber,n.toLineNumber);i&&t.push({fromLineNumber:i[0],toLineNumber:i[1]})}return t.length?this._actual.onTokensChanged(t):!1}else return this._actual.onTokensChanged(e.ranges)}onTokensColorsChanged(e){return this._onOptionsMaybeChanged(),this._actual.onTokensColorsChanged()}onZonesChanged(e){return this._actual.onZonesChanged()}prepareRender(e){this._shouldCheckSampling&&(this._shouldCheckSampling=!1,this._recreateLineSampling())}render(e){let t=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber;this._samplingState&&(t=this._samplingState.modelLineToMinimapLine(t),n=this._samplingState.modelLineToMinimapLine(n));let i={viewportContainsWhitespaceGaps:e.viewportData.whitespaceViewportData.length>0,scrollWidth:e.scrollWidth,scrollHeight:e.scrollHeight,viewportStartLineNumber:t,viewportEndLineNumber:n,viewportStartLineNumberVerticalOffset:e.getVerticalOffsetForLineNumber(t),scrollTop:e.scrollTop,scrollLeft:e.scrollLeft,viewportWidth:e.viewportWidth,viewportHeight:e.viewportHeight};this._actual.render(i)}_recreateLineSampling(){this._minimapSelections=null;let e=!!this._samplingState,[t,n]=BC.compute(this.options,this._context.viewModel.getLineCount(),this._samplingState);if(this._samplingState=t,e&&this._samplingState)for(let i of n)switch(i.type){case"deleted":this._actual.onLinesDeleted(i.deleteFromLineNumber,i.deleteToLineNumber);break;case"inserted":this._actual.onLinesInserted(i.insertFromLineNumber,i.insertToLineNumber);break;case"flush":this._actual.onFlushed();break}}getLineCount(){return this._samplingState?this._samplingState.minimapLines.length:this._context.viewModel.getLineCount()}getRealLineCount(){return this._context.viewModel.getLineCount()}getLineContent(e){return this._samplingState?this._context.viewModel.getLineContent(this._samplingState.minimapLines[e-1]):this._context.viewModel.getLineContent(e)}getLineMaxColumn(e){return this._samplingState?this._context.viewModel.getLineMaxColumn(this._samplingState.minimapLines[e-1]):this._context.viewModel.getLineMaxColumn(e)}getMinimapLinesRenderingData(e,t,n){if(this._samplingState){let i=[];for(let r=0,s=t-e+1;r<s;r++)n[r]?i[r]=this._context.viewModel.getViewLineData(this._samplingState.minimapLines[e+r-1]):i[r]=null;return i}return this._context.viewModel.getMinimapLinesRenderingData(e,t,n).data}getSelections(){if(this._minimapSelections===null)if(this._samplingState){this._minimapSelections=[];for(let e of this._selections){let[t,n]=this._samplingState.decorationLineRangeToMinimapLineRange(e.startLineNumber,e.endLineNumber);this._minimapSelections.push(new He(t,e.startColumn,n,e.endColumn))}}else this._minimapSelections=this._selections;return this._minimapSelections}getMinimapDecorationsInViewport(e,t){let n=this._getMinimapDecorationsInViewport(e,t).filter(i=>!i.options.minimap?.sectionHeaderStyle);if(this._samplingState){let i=[];for(let r of n){if(!r.options.minimap)continue;let s=r.range,a=this._samplingState.modelLineToMinimapLine(s.startLineNumber),l=this._samplingState.modelLineToMinimapLine(s.endLineNumber);i.push(new Ku(new D(a,s.startColumn,l,s.endColumn),r.options))}return i}return n}getSectionHeaderDecorationsInViewport(e,t){let n=this.options.minimapLineHeight,r=this.options.sectionHeaderFontSize/n;return e=Math.floor(Math.max(1,e-r)),this._getMinimapDecorationsInViewport(e,t).filter(s=>!!s.options.minimap?.sectionHeaderStyle)}_getMinimapDecorationsInViewport(e,t){let n;if(this._samplingState){let i=this._samplingState.minimapLines[e-1],r=this._samplingState.minimapLines[t-1];n=new D(i,1,r,this._context.viewModel.getLineMaxColumn(r))}else n=new D(e,1,t,this._context.viewModel.getLineMaxColumn(t));return this._context.viewModel.getMinimapDecorationsInRange(n)}getSectionHeaderText(e,t){let n=e.options.minimap?.sectionHeaderText;if(!n)return null;let i=this._sectionHeaderCache.get(n);if(i)return i;let r=t(n);return this._sectionHeaderCache.set(n,r),r}getOptions(){return this._context.viewModel.model.getOptions()}revealLineNumber(e){this._samplingState&&(e=this._samplingState.minimapLines[e-1]),this._context.viewModel.revealRange("mouse",!1,new D(e,1,e,1),1,0)}setScrollTop(e){this._context.viewModel.viewLayout.setScrollPosition({scrollTop:e},1)}},RD=class o extends V{_theme;_model;_domNode;_shadow;_canvas;_decorationsCanvas;_slider;_sliderHorizontal;_pointerDownListener;_sliderPointerMoveMonitor;_sliderPointerDownListener;_gestureDisposable;_sliderTouchStartListener;_sliderTouchMoveListener;_sliderTouchEndListener;_lastRenderData;_selectionColor;_renderDecorations=!1;_gestureInProgress=!1;_buffers;constructor(e,t){super(),this._theme=e,this._model=t,this._lastRenderData=null,this._buffers=null,this._selectionColor=this._theme.getColor(fT),this._domNode=Oe(document.createElement("div")),Rn.write(this._domNode,9),this._domNode.setClassName(this._getMinimapDomNodeClassName()),this._domNode.setPosition("absolute"),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._shadow=Oe(document.createElement("div")),this._shadow.setClassName("minimap-shadow-hidden"),this._domNode.appendChild(this._shadow),this._canvas=Oe(document.createElement("canvas")),this._canvas.setPosition("absolute"),this._canvas.setLeft(0),this._domNode.appendChild(this._canvas),this._decorationsCanvas=Oe(document.createElement("canvas")),this._decorationsCanvas.setPosition("absolute"),this._decorationsCanvas.setClassName("minimap-decorations-layer"),this._decorationsCanvas.setLeft(0),this._domNode.appendChild(this._decorationsCanvas),this._slider=Oe(document.createElement("div")),this._slider.setPosition("absolute"),this._slider.setClassName("minimap-slider"),this._slider.setLayerHinting(!0),this._slider.setContain("strict"),this._domNode.appendChild(this._slider),this._sliderHorizontal=Oe(document.createElement("div")),this._sliderHorizontal.setPosition("absolute"),this._sliderHorizontal.setClassName("minimap-slider-horizontal"),this._slider.appendChild(this._sliderHorizontal),this._applyLayout(),this._pointerDownListener=Jt(this._domNode.domNode,ae.POINTER_DOWN,n=>{if(n.preventDefault(),this._model.options.renderMinimap===0||!this._lastRenderData)return;if(this._model.options.size!=="proportional"){if(n.button===0&&this._lastRenderData){let d=yo(this._slider.domNode),c=d.top+d.height/2;this._startSliderDragging(n,c,this._lastRenderData.renderedLayout)}return}let r=this._model.options.minimapLineHeight,s=this._model.options.canvasInnerHeight/this._model.options.canvasOuterHeight*n.offsetY,l=Math.floor(s/r)+this._lastRenderData.renderedLayout.startLineNumber-this._lastRenderData.renderedLayout.topPaddingLineCount;l=Math.min(l,this._model.getLineCount()),this._model.revealLineNumber(l)}),this._sliderPointerMoveMonitor=new Bs,this._sliderPointerDownListener=Jt(this._slider.domNode,ae.POINTER_DOWN,n=>{n.preventDefault(),n.stopPropagation(),n.button===0&&this._lastRenderData&&this._startSliderDragging(n,n.pageY,this._lastRenderData.renderedLayout)}),this._gestureDisposable=Yt.addTarget(this._domNode.domNode),this._sliderTouchStartListener=U(this._domNode.domNode,at.Start,n=>{n.preventDefault(),n.stopPropagation(),this._lastRenderData&&(this._slider.toggleClassName("active",!0),this._gestureInProgress=!0,this.scrollDueToTouchEvent(n))},{passive:!1}),this._sliderTouchMoveListener=U(this._domNode.domNode,at.Change,n=>{n.preventDefault(),n.stopPropagation(),this._lastRenderData&&this._gestureInProgress&&this.scrollDueToTouchEvent(n)},{passive:!1}),this._sliderTouchEndListener=Jt(this._domNode.domNode,at.End,n=>{n.preventDefault(),n.stopPropagation(),this._gestureInProgress=!1,this._slider.toggleClassName("active",!1)})}_startSliderDragging(e,t,n){if(!e.target||!(e.target instanceof Element))return;let i=e.pageX;this._slider.toggleClassName("active",!0);let r=(s,a)=>{let l=yo(this._domNode.domNode),d=Math.min(Math.abs(a-i),Math.abs(a-l.left),Math.abs(a-l.left-l.width));if(mt&&d>W5){this._model.setScrollTop(n.scrollTop);return}let c=s-t;this._model.setScrollTop(n.getDesiredScrollTopFromDelta(c))};e.pageY!==t&&r(e.pageY,i),this._sliderPointerMoveMonitor.startMonitoring(e.target,e.pointerId,e.buttons,s=>r(s.pageY,s.pageX),()=>{this._slider.toggleClassName("active",!1)})}scrollDueToTouchEvent(e){let t=this._domNode.domNode.getBoundingClientRect().top,n=this._lastRenderData.renderedLayout.getDesiredScrollTopFromTouchLocation(e.pageY-t);this._model.setScrollTop(n)}dispose(){this._pointerDownListener.dispose(),this._sliderPointerMoveMonitor.dispose(),this._sliderPointerDownListener.dispose(),this._gestureDisposable.dispose(),this._sliderTouchStartListener.dispose(),this._sliderTouchMoveListener.dispose(),this._sliderTouchEndListener.dispose(),super.dispose()}_getMinimapDomNodeClassName(){let e=["minimap"];return this._model.options.showSlider==="always"?e.push("slider-always"):e.push("slider-mouseover"),this._model.options.autohide&&e.push("autohide"),e.join(" ")}getDomNode(){return this._domNode}_applyLayout(){this._domNode.setLeft(this._model.options.minimapLeft),this._domNode.setWidth(this._model.options.minimapWidth),this._domNode.setHeight(this._model.options.minimapHeight),this._shadow.setHeight(this._model.options.minimapHeight),this._canvas.setWidth(this._model.options.canvasOuterWidth),this._canvas.setHeight(this._model.options.canvasOuterHeight),this._canvas.domNode.width=this._model.options.canvasInnerWidth,this._canvas.domNode.height=this._model.options.canvasInnerHeight,this._decorationsCanvas.setWidth(this._model.options.canvasOuterWidth),this._decorationsCanvas.setHeight(this._model.options.canvasOuterHeight),this._decorationsCanvas.domNode.width=this._model.options.canvasInnerWidth,this._decorationsCanvas.domNode.height=this._model.options.canvasInnerHeight,this._slider.setWidth(this._model.options.minimapWidth)}_getBuffer(){return this._buffers||this._model.options.canvasInnerWidth>0&&this._model.options.canvasInnerHeight>0&&(this._buffers=new kD(this._canvas.domNode.getContext("2d"),this._model.options.canvasInnerWidth,this._model.options.canvasInnerHeight,this._model.options.backgroundColor)),this._buffers?this._buffers.getBuffer():null}onDidChangeOptions(){this._lastRenderData=null,this._buffers=null,this._applyLayout(),this._domNode.setClassName(this._getMinimapDomNodeClassName())}onSelectionChanged(){return this._renderDecorations=!0,!0}onDecorationsChanged(){return this._renderDecorations=!0,!0}onFlushed(){return this._lastRenderData=null,!0}onLinesChanged(e,t){return this._lastRenderData?this._lastRenderData.onLinesChanged(e,t):!1}onLinesDeleted(e,t){return this._lastRenderData?.onLinesDeleted(e,t),!0}onLinesInserted(e,t){return this._lastRenderData?.onLinesInserted(e,t),!0}onScrollChanged(){return this._renderDecorations=!0,!0}onThemeChanged(){return this._selectionColor=this._theme.getColor(fT),this._renderDecorations=!0,!0}onTokensChanged(e){return this._lastRenderData?this._lastRenderData.onTokensChanged(e):!1}onTokensColorsChanged(){return this._lastRenderData=null,this._buffers=null,!0}onZonesChanged(){return this._lastRenderData=null,!0}render(e){if(this._model.options.renderMinimap===0){this._shadow.setClassName("minimap-shadow-hidden"),this._sliderHorizontal.setWidth(0),this._sliderHorizontal.setHeight(0);return}e.scrollLeft+e.viewportWidth>=e.scrollWidth?this._shadow.setClassName("minimap-shadow-hidden"):this._shadow.setClassName("minimap-shadow-visible");let n=DD.create(this._model.options,e.viewportStartLineNumber,e.viewportEndLineNumber,e.viewportStartLineNumberVerticalOffset,e.viewportHeight,e.viewportContainsWhitespaceGaps,this._model.getLineCount(),this._model.getRealLineCount(),e.scrollTop,e.scrollHeight,this._lastRenderData?this._lastRenderData.renderedLayout:null);this._slider.setDisplay(n.sliderNeeded?"block":"none"),this._slider.setTop(n.sliderTop),this._slider.setHeight(n.sliderHeight),this._sliderHorizontal.setLeft(0),this._sliderHorizontal.setWidth(this._model.options.minimapWidth),this._sliderHorizontal.setTop(0),this._sliderHorizontal.setHeight(n.sliderHeight),this.renderDecorations(n),this._lastRenderData=this.renderLines(n)}renderDecorations(e){if(this._renderDecorations){this._renderDecorations=!1;let t=this._model.getSelections();t.sort(D.compareRangesUsingStarts);let n=this._model.getMinimapDecorationsInViewport(e.startLineNumber,e.endLineNumber);n.sort((h,m)=>(h.options.zIndex||0)-(m.options.zIndex||0));let{canvasInnerWidth:i,canvasInnerHeight:r}=this._model.options,s=this._model.options.minimapLineHeight,a=this._model.options.minimapCharWidth,l=this._model.getOptions().tabSize,d=this._decorationsCanvas.domNode.getContext("2d");d.clearRect(0,0,i,r);let c=new WC(e.startLineNumber,e.endLineNumber,!1);this._renderSelectionLineHighlights(d,t,c,e,s),this._renderDecorationsLineHighlights(d,n,c,e,s);let u=new WC(e.startLineNumber,e.endLineNumber,null);this._renderSelectionsHighlights(d,t,u,e,s,l,a,i),this._renderDecorationsHighlights(d,n,u,e,s,l,a,i),this._renderSectionHeaders(e)}}_renderSelectionLineHighlights(e,t,n,i,r){if(!this._selectionColor||this._selectionColor.isTransparent())return;e.fillStyle=this._selectionColor.transparent(.5).toString();let s=0,a=0;for(let l of t){let d=i.intersectWithViewport(l);if(!d)continue;let[c,u]=d;for(let f=c;f<=u;f++)n.set(f,!0);let h=i.getYForLineNumber(c,r),m=i.getYForLineNumber(u,r);a>=h||(a>s&&e.fillRect(Dr,s,e.canvas.width,a-s),s=h),a=m}a>s&&e.fillRect(Dr,s,e.canvas.width,a-s)}_renderDecorationsLineHighlights(e,t,n,i,r){let s=new Map;for(let a=t.length-1;a>=0;a--){let l=t[a],d=l.options.minimap;if(!d||d.position!==1)continue;let c=i.intersectWithViewport(l.range);if(!c)continue;let[u,h]=c,m=d.getColor(this._theme.value);if(!m||m.isTransparent())continue;let f=s.get(m.toString());f||(f=m.transparent(.5).toString(),s.set(m.toString(),f)),e.fillStyle=f;for(let g=u;g<=h;g++){if(n.has(g))continue;n.set(g,!0);let b=i.getYForLineNumber(u,r);e.fillRect(Dr,b,e.canvas.width,r)}}}_renderSelectionsHighlights(e,t,n,i,r,s,a,l){if(!(!this._selectionColor||this._selectionColor.isTransparent()))for(let d of t){let c=i.intersectWithViewport(d);if(!c)continue;let[u,h]=c;for(let m=u;m<=h;m++)this.renderDecorationOnLine(e,n,d,this._selectionColor,i,m,r,r,s,a,l)}}_renderDecorationsHighlights(e,t,n,i,r,s,a,l){for(let d of t){let c=d.options.minimap;if(!c)continue;let u=i.intersectWithViewport(d.range);if(!u)continue;let[h,m]=u,f=c.getColor(this._theme.value);if(!(!f||f.isTransparent()))for(let g=h;g<=m;g++)switch(c.position){case 1:this.renderDecorationOnLine(e,n,d.range,f,i,g,r,r,s,a,l);continue;case 2:{let b=i.getYForLineNumber(g,r);this.renderDecoration(e,f,2,b,H5,r);continue}}}}renderDecorationOnLine(e,t,n,i,r,s,a,l,d,c,u){let h=r.getYForLineNumber(s,l);if(h+a<0||h>this._model.options.canvasInnerHeight)return;let{startLineNumber:m,endLineNumber:f}=n,g=m===s?n.startColumn:1,b=f===s?n.endColumn:this._model.getLineMaxColumn(s),y=this.getXOffsetForPosition(t,s,g,d,c,u),C=this.getXOffsetForPosition(t,s,b,d,c,u);this.renderDecoration(e,i,y,h,C-y,a)}getXOffsetForPosition(e,t,n,i,r,s){if(n===1)return Dr;if((n-1)*r>=s)return s;let l=e.get(t);if(!l){let d=this._model.getLineContent(t);l=[Dr];let c=Dr;for(let u=1;u<d.length+1;u++){let h=d.charCodeAt(u-1),m=h===9?i*r:Ho(h)?2*r:r,f=c+m;if(f>=s){l[u]=s;break}l[u]=f,c=f}e.set(t,l)}return n-1<l.length?l[n-1]:s}renderDecoration(e,t,n,i,r,s){e.fillStyle=t&&t.toString()||"",e.fillRect(n,i,r,s)}_renderSectionHeaders(e){let t=this._model.options.minimapLineHeight,n=this._model.options.sectionHeaderFontSize,i=this._model.options.sectionHeaderLetterSpacing,r=n*1.5,{canvasInnerWidth:s}=this._model.options,a=this._model.options.backgroundColor,l=`rgb(${a.r} ${a.g} ${a.b} / .7)`,d=this._model.options.sectionHeaderFontColor,c=`rgb(${d.r} ${d.g} ${d.b})`,u=c,h=this._decorationsCanvas.domNode.getContext("2d");h.letterSpacing=i+"px",h.font="500 "+n+"px "+this._model.options.sectionHeaderFontFamily,h.strokeStyle=u,h.lineWidth=.2;let m=this._model.getSectionHeaderDecorationsInViewport(e.startLineNumber,e.endLineNumber);m.sort((g,b)=>g.range.startLineNumber-b.range.startLineNumber);let f=o._fitSectionHeader.bind(null,h,s-Dr);for(let g of m){let b=e.getYForLineNumber(g.range.startLineNumber,t)+n,y=b-n,C=y+2,x=this._model.getSectionHeaderText(g,f);o._renderSectionLabel(h,x,g.options.minimap?.sectionHeaderStyle===2,l,c,s,y,r,b,C)}}static _fitSectionHeader(e,t,n){if(!n)return n;let i="\u2026",r=e.measureText(n).width,s=e.measureText(i).width;if(r<=t||r<=s)return n;let a=n.length,l=r/n.length,d=Math.floor((t-s)/l)-1,c=Math.ceil(d/2);for(;c>0&&/\s/.test(n[c-1]);)--c;return n.substring(0,c)+i+n.substring(a-(d-c))}static _renderSectionLabel(e,t,n,i,r,s,a,l,d,c){t&&(e.fillStyle=i,e.fillRect(0,a,s,l),e.fillStyle=r,e.fillText(t,Dr,d)),n&&(e.beginPath(),e.moveTo(0,c),e.lineTo(s,c),e.closePath(),e.stroke())}renderLines(e){let t=e.startLineNumber,n=e.endLineNumber,i=this._model.options.minimapLineHeight;if(this._lastRenderData&&this._lastRenderData.linesEquals(e)){let te=this._lastRenderData._get();return new FC(e,te.imageData,te.lines)}let r=this._getBuffer();if(!r)return null;let[s,a,l]=o._renderUntouchedLines(r,e.topPaddingLineCount,t,n,i,this._lastRenderData),d=this._model.getMinimapLinesRenderingData(t,n,l),c=this._model.getOptions().tabSize,u=this._model.options.defaultBackgroundColor,h=this._model.options.backgroundColor,m=this._model.options.foregroundAlpha,f=this._model.tokensColorTracker,g=f.backgroundIsLight(),b=this._model.options.renderMinimap,y=this._model.options.charRenderer(),C=this._model.options.fontScale,x=this._model.options.minimapCharWidth,k=(b===1?2:3)*C,O=i>k?Math.floor((i-k)/2):0,W=h.a/255,z=new Yr(Math.round((h.r-u.r)*W+u.r),Math.round((h.g-u.g)*W+u.g),Math.round((h.b-u.b)*W+u.b),255),B=e.topPaddingLineCount*i,G=[];for(let te=0,Z=n-t+1;te<Z;te++)l[te]&&o._renderLine(r,z,h.a,g,b,x,f,m,y,B,O,c,d[te],C,i),G[te]=new PC(B),B+=i;let q=s===-1?0:s,ce=(a===-1?r.height:a)-q;return this._canvas.domNode.getContext("2d").putImageData(r,0,0,0,q,r.width,ce),new FC(e,r,G)}static _renderUntouchedLines(e,t,n,i,r,s){let a=[];if(!s){for(let B=0,G=i-n+1;B<G;B++)a[B]=!0;return[-1,-1,a]}let l=s._get(),d=l.imageData.data,c=l.rendLineNumberStart,u=l.lines,h=u.length,m=e.width,f=e.data,g=(i-n+1)*r*m*4,b=-1,y=-1,C=-1,x=-1,L=-1,k=-1,O=t*r;for(let B=n;B<=i;B++){let G=B-n,q=B-c,X=q>=0&&q<h?u[q].dy:-1;if(X===-1){a[G]=!0,O+=r;continue}let ce=X*m*4,Ce=(X+r)*m*4,te=O*m*4,Z=(O+r)*m*4;x===ce&&k===te?(x=Ce,k=Z):(C!==-1&&(f.set(d.subarray(C,x),L),b===-1&&C===0&&C===L&&(b=x),y===-1&&x===g&&C===L&&(y=C)),C=ce,x=Ce,L=te,k=Z),a[G]=!1,O+=r}C!==-1&&(f.set(d.subarray(C,x),L),b===-1&&C===0&&C===L&&(b=x),y===-1&&x===g&&C===L&&(y=C));let W=b===-1?-1:b/(m*4),z=y===-1?-1:y/(m*4);return[W,z,a]}static _renderLine(e,t,n,i,r,s,a,l,d,c,u,h,m,f,g){let b=m.content,y=m.tokens,C=e.width-s,x=g===1,L=Dr,k=0,O=0;for(let W=0,z=y.getCount();W<z;W++){let B=y.getEndOffset(W),G=y.getForeground(W),q=a.getColor(G);for(;k<B;k++){if(L>C)return;let X=b.charCodeAt(k);if(X===9){let ce=h-(k+O)%h;O+=ce-1,L+=ce*s}else if(X===32)L+=s;else{let ce=Ho(X)?2:1;for(let Ce=0;Ce<ce;Ce++)if(r===2?d.blockRenderChar(e,L,c+u,q,l,t,n,x):d.renderChar(e,L,c+u,X,q,l,t,n,f,i,x),L+=s,L>C)return}}}}},WC=class{_startLineNumber;_endLineNumber;_defaultValue;_values;constructor(e,t,n){this._startLineNumber=e,this._endLineNumber=t,this._defaultValue=n,this._values=[];for(let i=0,r=this._endLineNumber-this._startLineNumber+1;i<r;i++)this._values[i]=n}has(e){return this.get(e)!==this._defaultValue}set(e,t){e<this._startLineNumber||e>this._endLineNumber||(this._values[e-this._startLineNumber]=t)}get(e){return e<this._startLineNumber||e>this._endLineNumber?this._defaultValue:this._values[e-this._startLineNumber]}};var HC=class extends At{_viewDomNode;_widgets;_viewDomNodeRect;_domNode;overflowingOverlayWidgetsDomNode;_verticalScrollbarWidth;_minimapWidth;_horizontalScrollbarHeight;_editorHeight;_editorWidth;constructor(e,t){super(e),this._viewDomNode=t;let i=this._context.configuration.options.get(147);this._widgets={},this._verticalScrollbarWidth=i.verticalScrollbarWidth,this._minimapWidth=i.minimap.minimapWidth,this._horizontalScrollbarHeight=i.horizontalScrollbarHeight,this._editorHeight=i.height,this._editorWidth=i.width,this._viewDomNodeRect={top:0,left:0,width:0,height:0},this._domNode=Oe(document.createElement("div")),Rn.write(this._domNode,4),this._domNode.setClassName("overlayWidgets"),this.overflowingOverlayWidgetsDomNode=Oe(document.createElement("div")),Rn.write(this.overflowingOverlayWidgetsDomNode,5),this.overflowingOverlayWidgetsDomNode.setClassName("overflowingOverlayWidgets")}dispose(){super.dispose(),this._widgets={}}getDomNode(){return this._domNode}onConfigurationChanged(e){let n=this._context.configuration.options.get(147);return this._verticalScrollbarWidth=n.verticalScrollbarWidth,this._minimapWidth=n.minimap.minimapWidth,this._horizontalScrollbarHeight=n.horizontalScrollbarHeight,this._editorHeight=n.height,this._editorWidth=n.width,!0}addWidget(e){let t=Oe(e.getDomNode());this._widgets[e.getId()]={widget:e,preference:null,domNode:t},t.setPosition("absolute"),t.setAttribute("widgetId",e.getId()),e.allowEditorOverflow?this.overflowingOverlayWidgetsDomNode.appendChild(t):this._domNode.appendChild(t),this.setShouldRender(),this._updateMaxMinWidth()}setWidgetPosition(e,t){let n=this._widgets[e.getId()],i=t?t.preference:null,r=t?.stackOridinal;return n.preference===i&&n.stack===r?(this._updateMaxMinWidth(),!1):(n.preference=i,n.stack=r,this.setShouldRender(),this._updateMaxMinWidth(),!0)}removeWidget(e){let t=e.getId();if(this._widgets.hasOwnProperty(t)){let i=this._widgets[t].domNode.domNode;delete this._widgets[t],i.remove(),this.setShouldRender(),this._updateMaxMinWidth()}}_updateMaxMinWidth(){let e=0,t=Object.keys(this._widgets);for(let n=0,i=t.length;n<i;n++){let r=t[n],a=this._widgets[r].widget.getMinContentWidthInPx?.();typeof a<"u"&&(e=Math.max(e,a))}this._context.viewLayout.setOverlayWidgetsMinWidth(e)}_renderWidget(e,t){let n=e.domNode;if(e.preference===null){n.setTop("");return}let i=2*this._verticalScrollbarWidth+this._minimapWidth;if(e.preference===0||e.preference===1){if(e.preference===1){let r=n.domNode.clientHeight;n.setTop(this._editorHeight-r-2*this._horizontalScrollbarHeight)}else n.setTop(0);e.stack!==void 0?(n.setTop(t[e.preference]),t[e.preference]+=n.domNode.clientWidth):n.setRight(i)}else if(e.preference===2)n.domNode.style.right="50%",e.stack!==void 0?(n.setTop(t[2]),t[2]+=n.domNode.clientHeight):n.setTop(0);else{let{top:r,left:s}=e.preference;if(this._context.configuration.options.get(43)&&e.widget.allowEditorOverflow){let l=this._viewDomNodeRect;n.setTop(r+l.top),n.setLeft(s+l.left),n.setPosition("fixed")}else n.setTop(r),n.setLeft(s),n.setPosition("absolute")}}prepareRender(e){this._viewDomNodeRect=yo(this._viewDomNode.domNode)}render(e){this._domNode.setWidth(this._editorWidth);let t=Object.keys(this._widgets),n=Array.from({length:3},()=>0);t.sort((i,r)=>(this._widgets[i].stack||0)-(this._widgets[r].stack||0));for(let i=0,r=t.length;i<r;i++){let s=t[i];this._renderWidget(this._widgets[s],n)}}};var MD=class{lineHeight;pixelRatio;overviewRulerLanes;renderBorder;borderColor;hideCursor;cursorColorSingle;cursorColorPrimary;cursorColorSecondary;themeType;backgroundColor;top;right;domWidth;domHeight;canvasWidth;canvasHeight;x;w;constructor(e,t){let n=e.options;this.lineHeight=n.get(68),this.pixelRatio=n.get(145),this.overviewRulerLanes=n.get(84),this.renderBorder=n.get(83);let i=t.getColor(vN);this.borderColor=i?i.toString():null,this.hideCursor=n.get(60);let r=t.getColor(Yu);this.cursorColorSingle=r?r.transparent(.7).toString():null;let s=t.getColor(Py);this.cursorColorPrimary=s?s.transparent(.7).toString():null;let a=t.getColor(Fy);this.cursorColorSecondary=a?a.transparent(.7).toString():null,this.themeType=t.type;let l=n.get(74),d=l.enabled,c=l.side,u=t.getColor(yN),h=xo.getDefaultBackground();u?this.backgroundColor=u:d&&c==="right"?this.backgroundColor=h:this.backgroundColor=null;let f=n.get(147).overviewRuler;this.top=f.top,this.right=f.right,this.domWidth=f.width,this.domHeight=f.height,this.overviewRulerLanes===0?(this.canvasWidth=0,this.canvasHeight=0):(this.canvasWidth=this.domWidth*this.pixelRatio|0,this.canvasHeight=this.domHeight*this.pixelRatio|0);let[g,b]=this._initLanes(1,this.canvasWidth,this.overviewRulerLanes);this.x=g,this.w=b}_initLanes(e,t,n){let i=t-e;if(n>=3){let r=Math.floor(i/3),s=Math.floor(i/3),a=i-r-s,l=e,d=l+r,c=l+r+a;return[[0,l,d,l,c,l,d,l],[0,r,a,r+a,s,r+a+s,a+s,r+a+s]]}else if(n===2){let r=Math.floor(i/2),s=i-r,a=e,l=a+r;return[[0,a,a,a,l,a,a,a],[0,r,r,r,s,r+s,r+s,r+s]]}else{let r=e,s=i;return[[0,r,r,r,r,r,r,r],[0,s,s,s,s,s,s,s]]}}equals(e){return this.lineHeight===e.lineHeight&&this.pixelRatio===e.pixelRatio&&this.overviewRulerLanes===e.overviewRulerLanes&&this.renderBorder===e.renderBorder&&this.borderColor===e.borderColor&&this.hideCursor===e.hideCursor&&this.cursorColorSingle===e.cursorColorSingle&&this.cursorColorPrimary===e.cursorColorPrimary&&this.cursorColorSecondary===e.cursorColorSecondary&&this.themeType===e.themeType&&N.equals(this.backgroundColor,e.backgroundColor)&&this.top===e.top&&this.right===e.right&&this.domWidth===e.domWidth&&this.domHeight===e.domHeight&&this.canvasWidth===e.canvasWidth&&this.canvasHeight===e.canvasHeight}};var UC=class extends At{_actualShouldRender=0;_tokensColorTrackerListener;_domNode;_settings;_cursorPositions;_renderedDecorations=[];_renderedCursorPositions=[];constructor(e){super(e),this._domNode=Oe(document.createElement("canvas")),this._domNode.setClassName("decorationsOverviewRuler"),this._domNode.setPosition("absolute"),this._domNode.setLayerHinting(!0),this._domNode.setContain("strict"),this._domNode.setAttribute("aria-hidden","true"),this._updateSettings(!1),this._tokensColorTrackerListener=xo.onDidChange(t=>{t.changedColorMap&&this._updateSettings(!0)}),this._cursorPositions=[{position:new P(1,1),color:this._settings.cursorColorSingle}]}dispose(){super.dispose(),this._tokensColorTrackerListener.dispose()}_updateSettings(e){let t=new MD(this._context.configuration,this._context.theme);return this._settings&&this._settings.equals(t)?!1:(this._settings=t,this._domNode.setTop(this._settings.top),this._domNode.setRight(this._settings.right),this._domNode.setWidth(this._settings.domWidth),this._domNode.setHeight(this._settings.domHeight),this._domNode.domNode.width=this._settings.canvasWidth,this._domNode.domNode.height=this._settings.canvasHeight,e&&this._render(),!0)}_markRenderingIsNeeded(){return this._actualShouldRender=2,!0}_markRenderingIsMaybeNeeded(){return this._actualShouldRender=1,!0}onConfigurationChanged(e){return this._updateSettings(!1)?this._markRenderingIsNeeded():!1}onCursorStateChanged(e){this._cursorPositions=[];for(let t=0,n=e.selections.length;t<n;t++){let i=this._settings.cursorColorSingle;n>1&&(i=t===0?this._settings.cursorColorPrimary:this._settings.cursorColorSecondary),this._cursorPositions.push({position:e.selections[t].getPosition(),color:i})}return this._cursorPositions.sort((t,n)=>P.compare(t.position,n.position)),this._markRenderingIsMaybeNeeded()}onDecorationsChanged(e){return e.affectsOverviewRuler?this._markRenderingIsMaybeNeeded():!1}onFlushed(e){return this._markRenderingIsNeeded()}onScrollChanged(e){return e.scrollHeightChanged?this._markRenderingIsNeeded():!1}onZonesChanged(e){return this._markRenderingIsNeeded()}onThemeChanged(e){return this._updateSettings(!1)?this._markRenderingIsNeeded():!1}getDomNode(){return this._domNode.domNode}prepareRender(e){}render(e){this._render(),this._actualShouldRender=0}_render(){let e=this._settings.backgroundColor;if(this._settings.overviewRulerLanes===0){this._domNode.setBackgroundColor(e?N.Format.CSS.formatHexA(e):""),this._domNode.setDisplay("none");return}let t=this._context.viewModel.getAllOverviewRulerDecorations(this._context.theme);if(t.sort(Kd.compareByRenderingProps),this._actualShouldRender===1&&!Kd.equalsArr(this._renderedDecorations,t)&&(this._actualShouldRender=2),this._actualShouldRender===1&&!on(this._renderedCursorPositions,this._cursorPositions,(f,g)=>f.position.lineNumber===g.position.lineNumber&&f.color===g.color)&&(this._actualShouldRender=2),this._actualShouldRender===1)return;this._renderedDecorations=t,this._renderedCursorPositions=this._cursorPositions,this._domNode.setDisplay("block");let n=this._settings.canvasWidth,i=this._settings.canvasHeight,r=this._settings.lineHeight,s=this._context.viewLayout,a=this._context.viewLayout.getScrollHeight(),l=i/a,d=6*this._settings.pixelRatio|0,c=d/2|0,u=this._domNode.domNode.getContext("2d");e?e.isOpaque()?(u.fillStyle=N.Format.CSS.formatHexA(e),u.fillRect(0,0,n,i)):(u.clearRect(0,0,n,i),u.fillStyle=N.Format.CSS.formatHexA(e),u.fillRect(0,0,n,i)):u.clearRect(0,0,n,i);let h=this._settings.x,m=this._settings.w;for(let f of t){let g=f.color,b=f.data;u.fillStyle=g;let y=0,C=0,x=0;for(let L=0,k=b.length/3;L<k;L++){let O=b[3*L],W=b[3*L+1],z=b[3*L+2],B=s.getVerticalOffsetForLineNumber(W)*l|0,G=(s.getVerticalOffsetForLineNumber(z)+r)*l|0;if(G-B<d){let X=(B+G)/2|0;X<c?X=c:X+c>i&&(X=i-c),B=X-c,G=X+c}B>x+1||O!==y?(L!==0&&u.fillRect(h[y],C,m[y],x-C),y=O,C=B,x=G):G>x&&(x=G)}u.fillRect(h[y],C,m[y],x-C)}if(!this._settings.hideCursor){let f=2*this._settings.pixelRatio|0,g=f/2|0,b=this._settings.x[7],y=this._settings.w[7],C=-100,x=-100,L=null;for(let k=0,O=this._cursorPositions.length;k<O;k++){let W=this._cursorPositions[k].color;if(!W)continue;let z=this._cursorPositions[k].position,B=s.getVerticalOffsetForLineNumber(z.lineNumber)*l|0;B<g?B=g:B+g>i&&(B=i-g);let G=B-g,q=G+f;G>x+1||W!==L?(k!==0&&L&&u.fillRect(b,C,y,x-C),C=G,x=q):q>x&&(x=q),L=W,u.fillStyle=W}L&&u.fillRect(b,C,y,x-C)}this._settings.renderBorder&&this._settings.borderColor&&this._settings.overviewRulerLanes>0&&(u.beginPath(),u.lineWidth=1,u.strokeStyle=this._settings.borderColor,u.moveTo(0,0),u.lineTo(0,i),u.moveTo(1,0),u.lineTo(n,0),u.stroke())}};var zC=class extends dr{_context;_domNode;_zoneManager;constructor(e,t){super(),this._context=e;let n=this._context.configuration.options;this._domNode=Oe(document.createElement("canvas")),this._domNode.setClassName(t),this._domNode.setPosition("absolute"),this._domNode.setLayerHinting(!0),this._domNode.setContain("strict"),this._zoneManager=new Sy(i=>this._context.viewLayout.getVerticalOffsetForLineNumber(i)),this._zoneManager.setDOMWidth(0),this._zoneManager.setDOMHeight(0),this._zoneManager.setOuterHeight(this._context.viewLayout.getScrollHeight()),this._zoneManager.setLineHeight(n.get(68)),this._zoneManager.setPixelRatio(n.get(145)),this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}onConfigurationChanged(e){let t=this._context.configuration.options;return e.hasChanged(68)&&(this._zoneManager.setLineHeight(t.get(68)),this._render()),e.hasChanged(145)&&(this._zoneManager.setPixelRatio(t.get(145)),this._domNode.setWidth(this._zoneManager.getDOMWidth()),this._domNode.setHeight(this._zoneManager.getDOMHeight()),this._domNode.domNode.width=this._zoneManager.getCanvasWidth(),this._domNode.domNode.height=this._zoneManager.getCanvasHeight(),this._render()),!0}onFlushed(e){return this._render(),!0}onScrollChanged(e){return e.scrollHeightChanged&&(this._zoneManager.setOuterHeight(e.scrollHeight),this._render()),!0}onZonesChanged(e){return this._render(),!0}getDomNode(){return this._domNode.domNode}setLayout(e){this._domNode.setTop(e.top),this._domNode.setRight(e.right);let t=!1;t=this._zoneManager.setDOMWidth(e.width)||t,t=this._zoneManager.setDOMHeight(e.height)||t,t&&(this._domNode.setWidth(this._zoneManager.getDOMWidth()),this._domNode.setHeight(this._zoneManager.getDOMHeight()),this._domNode.domNode.width=this._zoneManager.getCanvasWidth(),this._domNode.domNode.height=this._zoneManager.getCanvasHeight(),this._render())}setZones(e){this._zoneManager.setZones(e),this._render()}_render(){if(this._zoneManager.getOuterHeight()===0)return!1;let e=this._zoneManager.getCanvasWidth(),t=this._zoneManager.getCanvasHeight(),n=this._zoneManager.resolveColorZones(),i=this._zoneManager.getId2Color(),r=this._domNode.domNode.getContext("2d");return r.clearRect(0,0,e,t),n.length>0&&this._renderOneLane(r,n,i,e),!0}_renderOneLane(e,t,n,i){let r=0,s=0,a=0;for(let l of t){let d=l.colorId,c=l.from,u=l.to;d!==r?(e.fillRect(0,s,i,a-s),r=d,e.fillStyle=n[r],s=c,a=u):a>=c?a=Math.max(a,u):(e.fillRect(0,s,i,a-s),s=c,a=u)}e.fillRect(0,s,i,a-s)}};var KC=class extends At{domNode;_renderedRulers;_rulers;_typicalHalfwidthCharacterWidth;constructor(e){super(e),this.domNode=Oe(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.domNode.setClassName("view-rulers"),this._renderedRulers=[];let t=this._context.configuration.options;this._rulers=t.get(104),this._typicalHalfwidthCharacterWidth=t.get(51).typicalHalfwidthCharacterWidth}dispose(){super.dispose()}onConfigurationChanged(e){let t=this._context.configuration.options;return this._rulers=t.get(104),this._typicalHalfwidthCharacterWidth=t.get(51).typicalHalfwidthCharacterWidth,!0}onScrollChanged(e){return e.scrollHeightChanged}prepareRender(e){}_ensureRulersCount(){let e=this._renderedRulers.length,t=this._rulers.length;if(e===t)return;if(e<t){let{tabSize:i}=this._context.viewModel.model.getOptions(),r=i,s=t-e;for(;s>0;){let a=Oe(document.createElement("div"));a.setClassName("view-ruler"),a.setWidth(r),this.domNode.appendChild(a),this._renderedRulers.push(a),s--}return}let n=e-t;for(;n>0;){let i=this._renderedRulers.pop();this.domNode.removeChild(i),n--}}render(e){this._ensureRulersCount();for(let t=0,n=this._rulers.length;t<n;t++){let i=this._renderedRulers[t],r=this._rulers[t];i.setBoxShadow(r.color?`1px 0 0 0 ${r.color} inset`:""),i.setHeight(Math.min(e.scrollHeight,1e6)),i.setLeft(r.column*this._typicalHalfwidthCharacterWidth)}}};var GC=class extends At{_domNode;_scrollTop;_width;_shouldShow;_useShadows;constructor(e){super(e),this._scrollTop=0,this._width=0,this._updateWidth(),this._shouldShow=!1;let n=this._context.configuration.options.get(105);this._useShadows=n.useShadows,this._domNode=Oe(document.createElement("div")),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true")}dispose(){super.dispose()}_updateShouldShow(){let e=this._useShadows&&this._scrollTop>0;return this._shouldShow!==e?(this._shouldShow=e,!0):!1}getDomNode(){return this._domNode}_updateWidth(){let t=this._context.configuration.options.get(147);t.minimap.renderMinimap===0||t.minimap.minimapWidth>0&&t.minimap.minimapLeft===0?this._width=t.width:this._width=t.width-t.verticalScrollbarWidth}onConfigurationChanged(e){let n=this._context.configuration.options.get(105);return this._useShadows=n.useShadows,this._updateWidth(),this._updateShouldShow(),!0}onScrollChanged(e){return this._scrollTop=e.scrollTop,this._updateShouldShow()}prepareRender(e){}render(e){this._domNode.setWidth(this._width),this._domNode.setClassName(this._shouldShow?"scroll-decoration":"")}};var AD=class{left;width;startStyle;endStyle;constructor(e){this.left=e.left,this.width=e.width,this.startStyle=null,this.endStyle=null}},OD=class{lineNumber;ranges;constructor(e,t){this.lineNumber=e,this.ranges=t}};function U5(o){return new AD(o)}function z5(o){return new OD(o.lineNumber,o.ranges.map(U5))}var $C=class o extends Ki{static SELECTION_CLASS_NAME="selected-text";static SELECTION_TOP_LEFT="top-left-radius";static SELECTION_BOTTOM_LEFT="bottom-left-radius";static SELECTION_TOP_RIGHT="top-right-radius";static SELECTION_BOTTOM_RIGHT="bottom-right-radius";static EDITOR_BACKGROUND_CLASS_NAME="monaco-editor-background";static ROUNDED_PIECE_WIDTH=10;_context;_roundedSelection;_typicalHalfwidthCharacterWidth;_selections;_renderResult;constructor(e){super(),this._context=e;let t=this._context.configuration.options;this._roundedSelection=t.get(103),this._typicalHalfwidthCharacterWidth=t.get(51).typicalHalfwidthCharacterWidth,this._selections=[],this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){let t=this._context.configuration.options;return this._roundedSelection=t.get(103),this._typicalHalfwidthCharacterWidth=t.get(51).typicalHalfwidthCharacterWidth,!0}onCursorStateChanged(e){return this._selections=e.selections.slice(0),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_visibleRangesHaveGaps(e){for(let t=0,n=e.length;t<n;t++)if(e[t].ranges.length>1)return!0;return!1}_enrichVisibleRangesWithStyle(e,t,n){let i=this._typicalHalfwidthCharacterWidth/4,r=null,s=null;if(n&&n.length>0&&t.length>0){let a=t[0].lineNumber;if(a===e.startLineNumber)for(let d=0;!r&&d<n.length;d++)n[d].lineNumber===a&&(r=n[d].ranges[0]);let l=t[t.length-1].lineNumber;if(l===e.endLineNumber)for(let d=n.length-1;!s&&d>=0;d--)n[d].lineNumber===l&&(s=n[d].ranges[0]);r&&!r.startStyle&&(r=null),s&&!s.startStyle&&(s=null)}for(let a=0,l=t.length;a<l;a++){let d=t[a].ranges[0],c=d.left,u=d.left+d.width,h={top:0,bottom:0},m={top:0,bottom:0};if(a>0){let f=t[a-1].ranges[0].left,g=t[a-1].ranges[0].left+t[a-1].ranges[0].width;jC(c-f)<i?h.top=2:c>f&&(h.top=1),jC(u-g)<i?m.top=2:f<u&&u<g&&(m.top=1)}else r&&(h.top=r.startStyle.top,m.top=r.endStyle.top);if(a+1<l){let f=t[a+1].ranges[0].left,g=t[a+1].ranges[0].left+t[a+1].ranges[0].width;jC(c-f)<i?h.bottom=2:f<c&&c<g&&(h.bottom=1),jC(u-g)<i?m.bottom=2:u<g&&(m.bottom=1)}else s&&(h.bottom=s.startStyle.bottom,m.bottom=s.endStyle.bottom);d.startStyle=h,d.endStyle=m}}_getVisibleRangesWithStyle(e,t,n){let r=(t.linesVisibleRangesForRange(e,!0)||[]).map(z5);return!this._visibleRangesHaveGaps(r)&&this._roundedSelection&&this._enrichVisibleRangesWithStyle(t.visibleRange,r,n),r}_createSelectionPiece(e,t,n,i,r){return'<div class="cslr '+n+'" style="top:'+e.toString()+"px;bottom:"+t.toString()+"px;left:"+i.toString()+"px;width:"+r.toString()+'px;"></div>'}_actualRenderOneSelection(e,t,n,i){if(i.length===0)return;let r=!!i[0].ranges[0].startStyle,s=i[0].lineNumber,a=i[i.length-1].lineNumber;for(let l=0,d=i.length;l<d;l++){let c=i[l],u=c.lineNumber,h=u-t,m=n&&u===s?1:0,f=n&&u!==s&&u===a?1:0,g="",b="";for(let y=0,C=c.ranges.length;y<C;y++){let x=c.ranges[y];if(r){let k=x.startStyle,O=x.endStyle;if(k.top===1||k.bottom===1){g+=this._createSelectionPiece(m,f,o.SELECTION_CLASS_NAME,x.left-o.ROUNDED_PIECE_WIDTH,o.ROUNDED_PIECE_WIDTH);let W=o.EDITOR_BACKGROUND_CLASS_NAME;k.top===1&&(W+=" "+o.SELECTION_TOP_RIGHT),k.bottom===1&&(W+=" "+o.SELECTION_BOTTOM_RIGHT),g+=this._createSelectionPiece(m,f,W,x.left-o.ROUNDED_PIECE_WIDTH,o.ROUNDED_PIECE_WIDTH)}if(O.top===1||O.bottom===1){g+=this._createSelectionPiece(m,f,o.SELECTION_CLASS_NAME,x.left+x.width,o.ROUNDED_PIECE_WIDTH);let W=o.EDITOR_BACKGROUND_CLASS_NAME;O.top===1&&(W+=" "+o.SELECTION_TOP_LEFT),O.bottom===1&&(W+=" "+o.SELECTION_BOTTOM_LEFT),g+=this._createSelectionPiece(m,f,W,x.left+x.width,o.ROUNDED_PIECE_WIDTH)}}let L=o.SELECTION_CLASS_NAME;if(r){let k=x.startStyle,O=x.endStyle;k.top===0&&(L+=" "+o.SELECTION_TOP_LEFT),k.bottom===0&&(L+=" "+o.SELECTION_BOTTOM_LEFT),O.top===0&&(L+=" "+o.SELECTION_TOP_RIGHT),O.bottom===0&&(L+=" "+o.SELECTION_BOTTOM_RIGHT)}b+=this._createSelectionPiece(m,f,L,x.left,x.width)}e[h][0]+=g,e[h][1]+=b}}_previousFrameVisibleRangesWithStyle=[];prepareRender(e){let t=[],n=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber;for(let s=n;s<=i;s++){let a=s-n;t[a]=["",""]}let r=[];for(let s=0,a=this._selections.length;s<a;s++){let l=this._selections[s];if(l.isEmpty()){r[s]=null;continue}let d=this._getVisibleRangesWithStyle(l,e,this._previousFrameVisibleRangesWithStyle[s]);r[s]=d,this._actualRenderOneSelection(t,n,this._selections.length>1,d)}this._previousFrameVisibleRangesWithStyle=r,this._renderResult=t.map(([s,a])=>s+a)}render(e,t){if(!this._renderResult)return"";let n=t-e;return n<0||n>=this._renderResult.length?"":this._renderResult[n]}};Ui((o,e)=>{let t=o.getColor(pA);t&&!t.isTransparent()&&e.addRule(`.monaco-editor .view-line span.inline-selected-text { color: ${t}; }`)});function jC(o){return o<0?-o:o}var qC=class o extends At{static BLINK_INTERVAL=500;_readOnly;_cursorBlinking;_cursorStyle;_cursorSmoothCaretAnimation;_selectionIsEmpty;_isComposingInput;_isVisible;_domNode;_startCursorBlinkAnimation;_cursorFlatBlinkInterval;_blinkingEnabled;_editorHasFocus;_primaryCursor;_secondaryCursors;_renderData;constructor(e){super(e);let t=this._context.configuration.options;this._readOnly=t.get(93),this._cursorBlinking=t.get(26),this._cursorStyle=t.get(28),this._cursorSmoothCaretAnimation=t.get(27),this._selectionIsEmpty=!0,this._isComposingInput=!1,this._isVisible=!1,this._primaryCursor=new Lg(this._context,0),this._secondaryCursors=[],this._renderData=[],this._domNode=Oe(document.createElement("div")),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._updateDomClassName(),this._domNode.appendChild(this._primaryCursor.getDomNode()),this._startCursorBlinkAnimation=new Er,this._cursorFlatBlinkInterval=new tu,this._blinkingEnabled=!1,this._editorHasFocus=!1,this._updateBlinking()}dispose(){super.dispose(),this._startCursorBlinkAnimation.dispose(),this._cursorFlatBlinkInterval.dispose()}getDomNode(){return this._domNode}onCompositionStart(e){return this._isComposingInput=!0,this._updateBlinking(),!0}onCompositionEnd(e){return this._isComposingInput=!1,this._updateBlinking(),!0}onConfigurationChanged(e){let t=this._context.configuration.options;this._readOnly=t.get(93),this._cursorBlinking=t.get(26),this._cursorStyle=t.get(28),this._cursorSmoothCaretAnimation=t.get(27),this._updateBlinking(),this._updateDomClassName(),this._primaryCursor.onConfigurationChanged(e);for(let n=0,i=this._secondaryCursors.length;n<i;n++)this._secondaryCursors[n].onConfigurationChanged(e);return!0}_onCursorPositionChanged(e,t,n){let i=this._secondaryCursors.length!==t.length||this._cursorSmoothCaretAnimation==="explicit"&&n!==3;if(this._primaryCursor.setPlurality(t.length?1:0),this._primaryCursor.onCursorPositionChanged(e,i),this._updateBlinking(),this._secondaryCursors.length<t.length){let r=t.length-this._secondaryCursors.length;for(let s=0;s<r;s++){let a=new Lg(this._context,2);this._domNode.domNode.insertBefore(a.getDomNode().domNode,this._primaryCursor.getDomNode().domNode.nextSibling),this._secondaryCursors.push(a)}}else if(this._secondaryCursors.length>t.length){let r=this._secondaryCursors.length-t.length;for(let s=0;s<r;s++)this._domNode.removeChild(this._secondaryCursors[0].getDomNode()),this._secondaryCursors.splice(0,1)}for(let r=0;r<t.length;r++)this._secondaryCursors[r].onCursorPositionChanged(t[r],i)}onCursorStateChanged(e){let t=[];for(let i=0,r=e.selections.length;i<r;i++)t[i]=e.selections[i].getPosition();this._onCursorPositionChanged(t[0],t.slice(1),e.reason);let n=e.selections[0].isEmpty();return this._selectionIsEmpty!==n&&(this._selectionIsEmpty=n,this._updateDomClassName()),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onFocusChanged(e){return this._editorHasFocus=e.isFocused,this._updateBlinking(),!1}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return!0}onTokensChanged(e){let t=n=>{for(let i=0,r=e.ranges.length;i<r;i++)if(e.ranges[i].fromLineNumber<=n.lineNumber&&n.lineNumber<=e.ranges[i].toLineNumber)return!0;return!1};if(t(this._primaryCursor.getPosition()))return!0;for(let n of this._secondaryCursors)if(t(n.getPosition()))return!0;return!1}onZonesChanged(e){return!0}_getCursorBlinking(){return this._isComposingInput?0:this._editorHasFocus?this._readOnly?5:this._cursorBlinking:0}_updateBlinking(){this._startCursorBlinkAnimation.cancel(),this._cursorFlatBlinkInterval.cancel();let e=this._getCursorBlinking(),t=e===0,n=e===5;t?this._hide():this._show(),this._blinkingEnabled=!1,this._updateDomClassName(),!t&&!n&&(e===1?this._cursorFlatBlinkInterval.cancelAndSet(()=>{this._isVisible?this._hide():this._show()},o.BLINK_INTERVAL,Ie(this._domNode.domNode)):this._startCursorBlinkAnimation.setIfNotSet(()=>{this._blinkingEnabled=!0,this._updateDomClassName()},o.BLINK_INTERVAL))}_updateDomClassName(){this._domNode.setClassName(this._getClassName())}_getClassName(){let e="cursors-layer";switch(this._selectionIsEmpty||(e+=" has-selection"),this._cursorStyle){case 1:e+=" cursor-line-style";break;case 2:e+=" cursor-block-style";break;case 3:e+=" cursor-underline-style";break;case 4:e+=" cursor-line-thin-style";break;case 5:e+=" cursor-block-outline-style";break;case 6:e+=" cursor-underline-thin-style";break;default:e+=" cursor-line-style"}if(this._blinkingEnabled)switch(this._getCursorBlinking()){case 1:e+=" cursor-blink";break;case 2:e+=" cursor-smooth";break;case 3:e+=" cursor-phase";break;case 4:e+=" cursor-expand";break;case 5:e+=" cursor-solid";break;default:e+=" cursor-solid"}else e+=" cursor-solid";return(this._cursorSmoothCaretAnimation==="on"||this._cursorSmoothCaretAnimation==="explicit")&&(e+=" cursor-smooth-caret-animation"),e}_show(){this._primaryCursor.show();for(let e=0,t=this._secondaryCursors.length;e<t;e++)this._secondaryCursors[e].show();this._isVisible=!0}_hide(){this._primaryCursor.hide();for(let e=0,t=this._secondaryCursors.length;e<t;e++)this._secondaryCursors[e].hide();this._isVisible=!1}prepareRender(e){this._primaryCursor.prepareRender(e);for(let t=0,n=this._secondaryCursors.length;t<n;t++)this._secondaryCursors[t].prepareRender(e)}render(e){let t=[],n=0,i=this._primaryCursor.render(e);i&&(t[n++]=i);for(let r=0,s=this._secondaryCursors.length;r<s;r++){let a=this._secondaryCursors[r].render(e);a&&(t[n++]=a)}this._renderData=t}getLastRenderData(){return this._renderData}};Ui((o,e)=>{let t=[{class:".cursor",foreground:Yu,background:Ny},{class:".cursor-primary",foreground:Py,background:nN},{class:".cursor-secondary",foreground:Fy,background:iN}];for(let n of t){let i=o.getColor(n.foreground);if(i){let r=o.getColor(n.background);r||(r=i.opposite()),e.addRule(`.monaco-editor .cursors-layer ${n.class} { background-color: ${i}; border-color: ${i}; color: ${r}; }`),El(o.type)&&e.addRule(`.monaco-editor .cursors-layer.has-selection ${n.class} { border-left: 1px solid ${r}; border-right: 1px solid ${r}; }`)}}});var ND=()=>{throw new Error("Invalid change accessor")},YC=class extends At{_zones;_lineHeight;_contentWidth;_contentLeft;domNode;marginDomNode;constructor(e){super(e);let t=this._context.configuration.options,n=t.get(147);this._lineHeight=t.get(68),this._contentWidth=n.contentWidth,this._contentLeft=n.contentLeft,this.domNode=Oe(document.createElement("div")),this.domNode.setClassName("view-zones"),this.domNode.setPosition("absolute"),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.marginDomNode=Oe(document.createElement("div")),this.marginDomNode.setClassName("margin-view-zones"),this.marginDomNode.setPosition("absolute"),this.marginDomNode.setAttribute("role","presentation"),this.marginDomNode.setAttribute("aria-hidden","true"),this._zones={}}dispose(){super.dispose(),this._zones={}}_recomputeWhitespacesProps(){let e=this._context.viewLayout.getWhitespaces(),t=new Map;for(let i of e)t.set(i.id,i);let n=!1;return this._context.viewModel.changeWhitespace(i=>{let r=Object.keys(this._zones);for(let s=0,a=r.length;s<a;s++){let l=r[s],d=this._zones[l],c=this._computeWhitespaceProps(d.delegate);d.isInHiddenArea=c.isInHiddenArea;let u=t.get(l);u&&(u.afterLineNumber!==c.afterViewLineNumber||u.height!==c.heightInPx)&&(i.changeOneWhitespace(l,c.afterViewLineNumber,c.heightInPx),this._safeCallOnComputedHeight(d.delegate,c.heightInPx),n=!0)}}),n}onConfigurationChanged(e){let t=this._context.configuration.options,n=t.get(147);return this._lineHeight=t.get(68),this._contentWidth=n.contentWidth,this._contentLeft=n.contentLeft,e.hasChanged(68)&&this._recomputeWhitespacesProps(),!0}onLineMappingChanged(e){return this._recomputeWhitespacesProps()}onLinesDeleted(e){return!0}onScrollChanged(e){return e.scrollTopChanged||e.scrollWidthChanged}onZonesChanged(e){return!0}onLinesInserted(e){return!0}_getZoneOrdinal(e){return e.ordinal??e.afterColumn??1e4}_computeWhitespaceProps(e){if(e.afterLineNumber===0)return{isInHiddenArea:!1,afterViewLineNumber:0,heightInPx:this._heightInPixels(e),minWidthInPx:this._minWidthInPixels(e)};let t;if(typeof e.afterColumn<"u")t=this._context.viewModel.model.validatePosition({lineNumber:e.afterLineNumber,column:e.afterColumn});else{let s=this._context.viewModel.model.validatePosition({lineNumber:e.afterLineNumber,column:1}).lineNumber;t=new P(s,this._context.viewModel.model.getLineMaxColumn(s))}let n;t.column===this._context.viewModel.model.getLineMaxColumn(t.lineNumber)?n=this._context.viewModel.model.validatePosition({lineNumber:t.lineNumber+1,column:1}):n=this._context.viewModel.model.validatePosition({lineNumber:t.lineNumber,column:t.column+1});let i=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(t,e.afterColumnAffinity,!0),r=e.showInHiddenAreas||this._context.viewModel.coordinatesConverter.modelPositionIsVisible(n);return{isInHiddenArea:!r,afterViewLineNumber:i.lineNumber,heightInPx:r?this._heightInPixels(e):0,minWidthInPx:this._minWidthInPixels(e)}}changeViewZones(e){let t=!1;return this._context.viewModel.changeWhitespace(n=>{let i={addZone:r=>(t=!0,this._addZone(n,r)),removeZone:r=>{r&&(t=this._removeZone(n,r)||t)},layoutZone:r=>{r&&(t=this._layoutZone(n,r)||t)}};K5(e,i),i.addZone=ND,i.removeZone=ND,i.layoutZone=ND}),t}_addZone(e,t){let n=this._computeWhitespaceProps(t),r={whitespaceId:e.insertWhitespace(n.afterViewLineNumber,this._getZoneOrdinal(t),n.heightInPx,n.minWidthInPx),delegate:t,isInHiddenArea:n.isInHiddenArea,isVisible:!1,domNode:Oe(t.domNode),marginDomNode:t.marginDomNode?Oe(t.marginDomNode):null};return this._safeCallOnComputedHeight(r.delegate,n.heightInPx),r.domNode.setPosition("absolute"),r.domNode.domNode.style.width="100%",r.domNode.setDisplay("none"),r.domNode.setAttribute("monaco-view-zone",r.whitespaceId),this.domNode.appendChild(r.domNode),r.marginDomNode&&(r.marginDomNode.setPosition("absolute"),r.marginDomNode.domNode.style.width="100%",r.marginDomNode.setDisplay("none"),r.marginDomNode.setAttribute("monaco-view-zone",r.whitespaceId),this.marginDomNode.appendChild(r.marginDomNode)),this._zones[r.whitespaceId]=r,this.setShouldRender(),r.whitespaceId}_removeZone(e,t){if(this._zones.hasOwnProperty(t)){let n=this._zones[t];return delete this._zones[t],e.removeWhitespace(n.whitespaceId),n.domNode.removeAttribute("monaco-visible-view-zone"),n.domNode.removeAttribute("monaco-view-zone"),n.domNode.domNode.remove(),n.marginDomNode&&(n.marginDomNode.removeAttribute("monaco-visible-view-zone"),n.marginDomNode.removeAttribute("monaco-view-zone"),n.marginDomNode.domNode.remove()),this.setShouldRender(),!0}return!1}_layoutZone(e,t){if(this._zones.hasOwnProperty(t)){let n=this._zones[t],i=this._computeWhitespaceProps(n.delegate);return n.isInHiddenArea=i.isInHiddenArea,e.changeOneWhitespace(n.whitespaceId,i.afterViewLineNumber,i.heightInPx),this._safeCallOnComputedHeight(n.delegate,i.heightInPx),this.setShouldRender(),!0}return!1}shouldSuppressMouseDownOnViewZone(e){return this._zones.hasOwnProperty(e)?!!this._zones[e].delegate.suppressMouseDown:!1}_heightInPixels(e){return typeof e.heightInPx=="number"?e.heightInPx:typeof e.heightInLines=="number"?this._lineHeight*e.heightInLines:this._lineHeight}_minWidthInPixels(e){return typeof e.minWidthInPx=="number"?e.minWidthInPx:0}_safeCallOnComputedHeight(e,t){if(typeof e.onComputedHeight=="function")try{e.onComputedHeight(t)}catch(n){je(n)}}_safeCallOnDomNodeTop(e,t){if(typeof e.onDomNodeTop=="function")try{e.onDomNodeTop(t)}catch(n){je(n)}}prepareRender(e){}render(e){let t=e.viewportData.whitespaceViewportData,n={},i=!1;for(let s of t)this._zones[s.id].isInHiddenArea||(n[s.id]=s,i=!0);let r=Object.keys(this._zones);for(let s=0,a=r.length;s<a;s++){let l=r[s],d=this._zones[l],c=0,u=0,h="none";n.hasOwnProperty(l)?(c=n[l].verticalOffset-e.bigNumbersDelta,u=n[l].height,h="block",d.isVisible||(d.domNode.setAttribute("monaco-visible-view-zone","true"),d.isVisible=!0),this._safeCallOnDomNodeTop(d.delegate,e.getScrolledTopFromAbsoluteTop(n[l].verticalOffset))):(d.isVisible&&(d.domNode.removeAttribute("monaco-visible-view-zone"),d.isVisible=!1),this._safeCallOnDomNodeTop(d.delegate,e.getScrolledTopFromAbsoluteTop(-1e6))),d.domNode.setTop(c),d.domNode.setHeight(u),d.domNode.setDisplay(h),d.marginDomNode&&(d.marginDomNode.setTop(c),d.marginDomNode.setHeight(u),d.marginDomNode.setDisplay(h))}i&&(this.domNode.setWidth(Math.max(e.scrollWidth,this._contentWidth)),this.marginDomNode.setWidth(this._contentLeft))}};function K5(o,e){try{return o(e)}catch(t){je(t)}}var ZC=class extends Ki{_context;_options;_selection;_renderResult;constructor(e){super(),this._context=e,this._options=new XC(this._context.configuration),this._selection=[],this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){let t=new XC(this._context.configuration);return this._options.equals(t)?e.hasChanged(147):(this._options=t,!0)}onCursorStateChanged(e){return this._selection=e.selections,this._options.renderWhitespace==="selection"}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}prepareRender(e){if(this._options.renderWhitespace==="none"){this._renderResult=null;return}let t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber-t+1,r=new Array(i);for(let a=0;a<i;a++)r[a]=!0;let s=this._context.viewModel.getMinimapLinesRenderingData(e.viewportData.startLineNumber,e.viewportData.endLineNumber,r);this._renderResult=[];for(let a=e.viewportData.startLineNumber;a<=e.viewportData.endLineNumber;a++){let l=a-e.viewportData.startLineNumber,d=s.data[l],c=null;if(this._options.renderWhitespace==="selection"){let u=this._selection;for(let h of u){if(h.endLineNumber<a||h.startLineNumber>a)continue;let m=h.startLineNumber===a?h.startColumn:d.minColumn,f=h.endLineNumber===a?h.endColumn:d.maxColumn;m<f&&(c||(c=[]),c.push(new Ch(m-1,f-1)))}}this._renderResult[l]=this._applyRenderWhitespace(e,a,c,d)}}_applyRenderWhitespace(e,t,n,i){if(this._options.renderWhitespace==="selection"&&!n||this._options.renderWhitespace==="trailing"&&i.continuesWithWrappedLine)return"";let r=this._context.theme.getColor(By),s=this._options.renderWithSVG,a=i.content,l=this._options.stopRenderingLineAfter===-1?a.length:Math.min(this._options.stopRenderingLineAfter,a.length),d=i.continuesWithWrappedLine,c=i.minColumn-1,u=this._options.renderWhitespace==="boundary",h=this._options.renderWhitespace==="trailing",m=this._options.lineHeight,f=this._options.middotWidth,g=this._options.wsmiddotWidth,b=this._options.spaceWidth,y=Math.abs(g-b),C=Math.abs(f-b),x=y<C?11825:183,L=this._options.canUseHalfwidthRightwardsArrow,k="",O=!1,W=Xt(a),z;W===-1?(O=!0,W=l,z=l):z=Wo(a);let B=0,G=n&&n[B],q=0;for(let X=c;X<l;X++){let ce=a.charCodeAt(X);if(G&&X>=G.endOffset&&(B++,G=n&&n[B]),ce!==9&&ce!==32||h&&!O&&X<=z)continue;if(u&&X>=W&&X<=z&&ce===32){let te=X-1>=0?a.charCodeAt(X-1):0,Z=X+1<l?a.charCodeAt(X+1):0;if(te!==32&&Z!==32)continue}if(u&&d&&X===l-1){let te=X-1>=0?a.charCodeAt(X-1):0;if(ce===32&&te!==32&&te!==9)continue}if(n&&(!G||G.startOffset>X||G.endOffset<=X))continue;let Ce=e.visibleRangeForPosition(new P(t,X+1));Ce&&(s?(q=Math.max(q,Ce.left),ce===9?k+=this._renderArrow(m,b,Ce.left):k+=`<circle cx="${(Ce.left+b/2).toFixed(2)}" cy="${(m/2).toFixed(2)}" r="${(b/7).toFixed(2)}" />`):ce===9?k+=`<div class="mwh" style="left:${Ce.left}px;height:${m}px;">${L?"\uFFEB":"\u2192"}</div>`:k+=`<div class="mwh" style="left:${Ce.left}px;height:${m}px;">${String.fromCharCode(x)}</div>`)}return s?(q=Math.round(q+b),`<svg style="bottom:0;position:absolute;width:${q}px;height:${m}px" viewBox="0 0 ${q} ${m}" xmlns="http://www.w3.org/2000/svg" fill="${r}">`+k+"</svg>"):k}_renderArrow(e,t,n){let i=t/7,r=t,s=e/2,a=n,l={x:0,y:i/2},d={x:100/125*r,y:l.y},c={x:d.x-.2*d.x,y:d.y+.2*d.x},u={x:c.x+.1*d.x,y:c.y+.1*d.x},h={x:u.x+.35*d.x,y:u.y-.35*d.x},m={x:h.x,y:-h.y},f={x:u.x,y:-u.y},g={x:c.x,y:-c.y},b={x:d.x,y:-d.y},y={x:l.x,y:-l.y};return`<path d="M ${[l,d,c,u,h,m,f,g,b,y].map(L=>`${(a+L.x).toFixed(2)} ${(s+L.y).toFixed(2)}`).join(" L ")}" />`}render(e,t){if(!this._renderResult)return"";let n=t-e;return n<0||n>=this._renderResult.length?"":this._renderResult[n]}},XC=class{renderWhitespace;renderWithSVG;spaceWidth;middotWidth;wsmiddotWidth;canUseHalfwidthRightwardsArrow;lineHeight;stopRenderingLineAfter;constructor(e){let t=e.options,n=t.get(51),i=t.get(39);i==="off"?(this.renderWhitespace="none",this.renderWithSVG=!1):i==="svg"?(this.renderWhitespace=t.get(101),this.renderWithSVG=!0):(this.renderWhitespace=t.get(101),this.renderWithSVG=!1),this.spaceWidth=n.spaceWidth,this.middotWidth=n.middotWidth,this.wsmiddotWidth=n.wsmiddotWidth,this.canUseHalfwidthRightwardsArrow=n.canUseHalfwidthRightwardsArrow,this.lineHeight=t.get(68),this.stopRenderingLineAfter=t.get(119)}equals(e){return this.renderWhitespace===e.renderWhitespace&&this.renderWithSVG===e.renderWithSVG&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.lineHeight===e.lineHeight&&this.stopRenderingLineAfter===e.stopRenderingLineAfter}};var $h=class extends At{};var PD=class{_onDidChange=new E;onDidChange=this._onDidChange.event;_enabled=!0;get enabled(){return this._enabled}enable(){this._enabled=!0,this._onDidChange.fire()}disable(){this._enabled=!1,this._onDidChange.fire()}},FD=new PD;var VD=class{constructor(e,t,n,i,r){this._context=e;this.modelLineNumber=t;this.distanceToModelLineStart=n;this.widthOfHiddenLineTextBefore=i;this.distanceToModelLineEnd=r}_visibleTextAreaBrand=void 0;startPosition=null;endPosition=null;visibleTextareaStart=null;visibleTextareaEnd=null;_previousPresentation=null;prepareRender(e){let t=new P(this.modelLineNumber,this.distanceToModelLineStart+1),n=new P(this.modelLineNumber,this._context.viewModel.model.getLineMaxColumn(this.modelLineNumber)-this.distanceToModelLineEnd);this.startPosition=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(t),this.endPosition=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(n),this.startPosition.lineNumber===this.endPosition.lineNumber?(this.visibleTextareaStart=e.visibleRangeForPosition(this.startPosition),this.visibleTextareaEnd=e.visibleRangeForPosition(this.endPosition)):(this.visibleTextareaStart=null,this.visibleTextareaEnd=null)}definePresentation(e){return this._previousPresentation||(e?this._previousPresentation=e:this._previousPresentation={foreground:1,italic:!1,bold:!1,underline:!1,strikethrough:!1}),this._previousPresentation}},BD=sn,qh=class extends $h{constructor(t,n,i,r,s){super(t);this._keybindingService=r;this._instantiationService=s;this._viewController=n,this._visibleRangeProvider=i,this._scrollLeft=0,this._scrollTop=0;let a=this._context.configuration.options,l=a.get(147);this._setAccessibilityOptions(a),this._contentLeft=l.contentLeft,this._contentWidth=l.contentWidth,this._contentHeight=l.height,this._fontInfo=a.get(51),this._lineHeight=a.get(68),this._emptySelectionClipboard=a.get(38),this._copyWithSyntaxHighlighting=a.get(25),this._visibleTextArea=null,this._selections=[new He(1,1,1,1)],this._modelSelections=[new He(1,1,1,1)],this._lastRenderPosition=null,this.textArea=Oe(document.createElement("textarea")),Rn.write(this.textArea,7),this.textArea.setClassName(`inputarea ${_a}`),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off");let{tabSize:d}=this._context.viewModel.model.getOptions();this.textArea.domNode.style.tabSize=`${d*this._fontInfo.spaceWidth}px`,this.textArea.setAttribute("autocorrect","off"),this.textArea.setAttribute("autocapitalize","off"),this.textArea.setAttribute("autocomplete","off"),this.textArea.setAttribute("spellcheck","false"),this.textArea.setAttribute("aria-label",Bg(a,this._keybindingService)),this.textArea.setAttribute("aria-required",a.get(5)?"true":"false"),this.textArea.setAttribute("tabindex",String(a.get(126))),this.textArea.setAttribute("role","textbox"),this.textArea.setAttribute("aria-roledescription",p("editor","editor")),this.textArea.setAttribute("aria-multiline","true"),this.textArea.setAttribute("aria-autocomplete",a.get(93)?"none":"both"),this._ensureReadOnlyAttribute(),this.textAreaCover=Oe(document.createElement("div")),this.textAreaCover.setPosition("absolute");let c={getLineCount:()=>this._context.viewModel.getLineCount(),getLineMaxColumn:m=>this._context.viewModel.getLineMaxColumn(m),getValueInRange:(m,f)=>this._context.viewModel.getValueInRange(m,f),getValueLengthInRange:(m,f)=>this._context.viewModel.getValueLengthInRange(m,f),modifyPosition:(m,f)=>this._context.viewModel.modifyPosition(m,f)},u={getDataToCopy:()=>mC(this._context.viewModel,this._modelSelections,this._emptySelectionClipboard,this._copyWithSyntaxHighlighting),getScreenReaderContent:()=>{if(this._accessibilitySupport===1){let f=this._selections[0];if(Be&&f.isEmpty()){let b=f.getStartPosition(),y=this._getWordBeforePosition(b);if(y.length===0&&(y=this._getCharacterBeforePosition(b)),y.length>0)return new Nn(y,y.length,y.length,D.fromPositions(b),0)}if(Be&&!f.isEmpty()&&c.getValueLengthInRange(f,0)<500){let b=c.getValueInRange(f,0);return new Nn(b,0,b.length,f,0)}if(Xi&&!f.isEmpty()){let b="vscode-placeholder";return new Nn(b,0,b.length,null,void 0)}return Nn.EMPTY}if(gx){let f=this._selections[0];if(f.isEmpty()){let g=f.getStartPosition(),[b,y]=this._getAndroidWordAtPosition(g);if(b.length>0)return new Nn(b,y,y,D.fromPositions(g),0)}return Nn.EMPTY}let m=Wh.fromEditorSelection(c,this._selections[0],this._accessibilityPageSize,this._accessibilitySupport===0);return Nn.fromScreenReaderContentState(m)},deduceModelPosition:(m,f,g)=>this._context.viewModel.deduceModelPositionRelativeToViewPosition(m,f,g)},h=this._register(new gC(this.textArea.domNode));this._textAreaInput=this._register(this._instantiationService.createInstance(Hh,u,h,Zo,{isAndroid:gx,isChrome:Ya,isFirefox:sn,isSafari:Xi})),this._register(this._textAreaInput.onKeyDown(m=>{this._viewController.emitKeyDown(m)})),this._register(this._textAreaInput.onKeyUp(m=>{this._viewController.emitKeyUp(m)})),this._register(this._textAreaInput.onPaste(m=>{let f=!1,g=null,b=null;m.metadata&&(f=this._emptySelectionClipboard&&!!m.metadata.isFromEmptySelection,g=typeof m.metadata.multicursorText<"u"?m.metadata.multicursorText:null,b=m.metadata.mode),this._viewController.paste(m.text,f,g,b)})),this._register(this._textAreaInput.onCut(()=>{this._viewController.cut()})),this._register(this._textAreaInput.onType(m=>{m.replacePrevCharCnt||m.replaceNextCharCnt||m.positionDelta?(uo&&console.log(` => compositionType: <<${m.text}>>, ${m.replacePrevCharCnt}, ${m.replaceNextCharCnt}, ${m.positionDelta}`),this._viewController.compositionType(m.text,m.replacePrevCharCnt,m.replaceNextCharCnt,m.positionDelta)):(uo&&console.log(` => type: <<${m.text}>>`),this._viewController.type(m.text))})),this._register(this._textAreaInput.onSelectionChangeRequest(m=>{this._viewController.setSelection(m)})),this._register(this._textAreaInput.onCompositionStart(m=>{let f=this.textArea.domNode,g=this._modelSelections[0],{distanceToModelLineStart:b,widthOfHiddenTextBefore:y}=(()=>{let x=f.value.substring(0,Math.min(f.selectionStart,f.selectionEnd)),L=x.lastIndexOf(`
`),k=x.substring(L+1),O=k.lastIndexOf("	"),W=k.length-O-1,z=g.getStartPosition(),B=Math.min(z.column-1,W),G=z.column-1-B,q=k.substring(0,k.length-B),{tabSize:X}=this._context.viewModel.model.getOptions(),ce=G5(this.textArea.domNode.ownerDocument,q,this._fontInfo,X);return{distanceToModelLineStart:G,widthOfHiddenTextBefore:ce}})(),{distanceToModelLineEnd:C}=(()=>{let x=f.value.substring(Math.max(f.selectionStart,f.selectionEnd)),L=x.indexOf(`
`),k=L===-1?x:x.substring(0,L),O=k.indexOf("	"),W=O===-1?k.length:k.length-O-1,z=g.getEndPosition(),B=Math.min(this._context.viewModel.model.getLineMaxColumn(z.lineNumber)-z.column,W);return{distanceToModelLineEnd:this._context.viewModel.model.getLineMaxColumn(z.lineNumber)-z.column-B}})();this._context.viewModel.revealRange("keyboard",!0,D.fromPositions(this._selections[0].getStartPosition()),0,1),this._visibleTextArea=new VD(this._context,g.startLineNumber,b,y,C),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off"),this._visibleTextArea.prepareRender(this._visibleRangeProvider),this._render(),this.textArea.setClassName(`inputarea ${_a} ime-input`),this._viewController.compositionStart(),this._context.viewModel.onCompositionStart()})),this._register(this._textAreaInput.onCompositionUpdate(m=>{this._visibleTextArea&&(this._visibleTextArea.prepareRender(this._visibleRangeProvider),this._render())})),this._register(this._textAreaInput.onCompositionEnd(()=>{this._visibleTextArea=null,this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off"),this._render(),this.textArea.setClassName(`inputarea ${_a}`),this._viewController.compositionEnd(),this._context.viewModel.onCompositionEnd()})),this._register(this._textAreaInput.onFocus(()=>{this._context.viewModel.setHasFocus(!0)})),this._register(this._textAreaInput.onBlur(()=>{this._context.viewModel.setHasFocus(!1)})),this._register(FD.onDidChange(()=>{this._ensureReadOnlyAttribute()}))}_viewController;_visibleRangeProvider;_scrollLeft;_scrollTop;_accessibilitySupport;_accessibilityPageSize;_textAreaWrapping;_textAreaWidth;_contentLeft;_contentWidth;_contentHeight;_fontInfo;_lineHeight;_emptySelectionClipboard;_copyWithSyntaxHighlighting;_visibleTextArea;_selections;_modelSelections;_lastRenderPosition;textArea;textAreaCover;_textAreaInput;get domNode(){return this.textArea}appendTo(t){t.appendChild(this.textArea),t.appendChild(this.textAreaCover)}writeScreenReaderContent(t){this._textAreaInput.writeNativeTextAreaContent(t)}dispose(){super.dispose(),this.textArea.domNode.remove(),this.textAreaCover.domNode.remove()}_getAndroidWordAtPosition(t){let n='`~!@#$%^&*()-=+[{]}\\|;:",.<>/?',i=this._context.viewModel.getLineContent(t.lineNumber),r=Is(n,[]),s=!0,a=t.column,l=!0,d=t.column,c=0;for(;c<50&&(s||l);){if(s&&a<=1&&(s=!1),s){let u=i.charCodeAt(a-2);r.get(u)!==0?s=!1:a--}if(l&&d>i.length&&(l=!1),l){let u=i.charCodeAt(d-1);r.get(u)!==0?l=!1:d++}c++}return[i.substring(a-1,d-1),t.column-a]}_getWordBeforePosition(t){let n=this._context.viewModel.getLineContent(t.lineNumber),i=Is(this._context.configuration.options.get(133),[]),r=t.column,s=0;for(;r>1;){let a=n.charCodeAt(r-2);if(i.get(a)!==0||s>50)return n.substring(r-1,t.column-1);s++,r--}return n.substring(0,t.column-1)}_getCharacterBeforePosition(t){if(t.column>1){let i=this._context.viewModel.getLineContent(t.lineNumber).charAt(t.column-2);if(!Ht(i.charCodeAt(0)))return i}return""}_setAccessibilityOptions(t){this._accessibilitySupport=t.get(2);let n=t.get(3);this._accessibilitySupport===2&&n===vs.accessibilityPageSize.defaultValue?this._accessibilityPageSize=500:this._accessibilityPageSize=n;let r=t.get(147).wrappingColumn;if(r!==-1&&this._accessibilitySupport!==1){let s=t.get(51);this._textAreaWrapping=!0,this._textAreaWidth=Math.round(r*s.typicalHalfwidthCharacterWidth)}else this._textAreaWrapping=!1,this._textAreaWidth=BD?0:1}onConfigurationChanged(t){let n=this._context.configuration.options,i=n.get(147);this._setAccessibilityOptions(n),this._contentLeft=i.contentLeft,this._contentWidth=i.contentWidth,this._contentHeight=i.height,this._fontInfo=n.get(51),this._lineHeight=n.get(68),this._emptySelectionClipboard=n.get(38),this._copyWithSyntaxHighlighting=n.get(25),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off");let{tabSize:r}=this._context.viewModel.model.getOptions();return this.textArea.domNode.style.tabSize=`${r*this._fontInfo.spaceWidth}px`,this.textArea.setAttribute("aria-label",Bg(n,this._keybindingService)),this.textArea.setAttribute("aria-required",n.get(5)?"true":"false"),this.textArea.setAttribute("tabindex",String(n.get(126))),(t.hasChanged(34)||t.hasChanged(93))&&this._ensureReadOnlyAttribute(),t.hasChanged(2)&&this._textAreaInput.writeNativeTextAreaContent("strategy changed"),!0}onCursorStateChanged(t){return this._selections=t.selections.slice(0),this._modelSelections=t.modelSelections.slice(0),this._textAreaInput.writeNativeTextAreaContent("selection changed"),!0}onDecorationsChanged(t){return!0}onFlushed(t){return!0}onLinesChanged(t){return!0}onLinesDeleted(t){return!0}onLinesInserted(t){return!0}onScrollChanged(t){return this._scrollLeft=t.scrollLeft,this._scrollTop=t.scrollTop,!0}onZonesChanged(t){return!0}isFocused(){return this._textAreaInput.isFocused()}focus(){this._textAreaInput.focusTextArea()}refreshFocusState(){this._textAreaInput.refreshFocusState()}getLastRenderData(){return this._lastRenderPosition}setAriaOptions(t){t.activeDescendant?(this.textArea.setAttribute("aria-haspopup","true"),this.textArea.setAttribute("aria-autocomplete","list"),this.textArea.setAttribute("aria-activedescendant",t.activeDescendant)):(this.textArea.setAttribute("aria-haspopup","false"),this.textArea.setAttribute("aria-autocomplete","both"),this.textArea.removeAttribute("aria-activedescendant")),t.role&&this.textArea.setAttribute("role",t.role)}_ensureReadOnlyAttribute(){let t=this._context.configuration.options;!FD.enabled||t.get(34)&&t.get(93)?this.textArea.setAttribute("readonly","true"):this.textArea.removeAttribute("readonly")}_primaryCursorPosition=new P(1,1);_primaryCursorVisibleRange=null;prepareRender(t){this._primaryCursorPosition=new P(this._selections[0].positionLineNumber,this._selections[0].positionColumn),this._primaryCursorVisibleRange=t.visibleRangeForPosition(this._primaryCursorPosition),this._visibleTextArea?.prepareRender(t)}render(t){this._textAreaInput.writeNativeTextAreaContent("render"),this._render()}_render(){if(this._visibleTextArea){let i=this._visibleTextArea.visibleTextareaStart,r=this._visibleTextArea.visibleTextareaEnd,s=this._visibleTextArea.startPosition,a=this._visibleTextArea.endPosition;if(s&&a&&i&&r&&r.left>=this._scrollLeft&&i.left<=this._scrollLeft+this._contentWidth){let l=this._context.viewLayout.getVerticalOffsetForLineNumber(this._primaryCursorPosition.lineNumber)-this._scrollTop,d=Vg(this.textArea.domNode.value.substr(0,this.textArea.domNode.selectionStart)),c=this._visibleTextArea.widthOfHiddenLineTextBefore,u=this._contentLeft+i.left-this._scrollLeft,h=r.left-i.left+1;if(u<this._contentLeft){let C=this._contentLeft-u;u+=C,c+=C,h-=C}h>this._contentWidth&&(h=this._contentWidth);let m=this._context.viewModel.getViewLineData(s.lineNumber),f=m.tokens.findTokenIndexAtOffset(s.column-1),g=m.tokens.findTokenIndexAtOffset(a.column-1),b=f===g,y=this._visibleTextArea.definePresentation(b?m.tokens.getPresentation(f):null);this.textArea.domNode.scrollTop=d*this._lineHeight,this.textArea.domNode.scrollLeft=c,this._doRender({lastRenderPosition:null,top:l,left:u,width:h,height:this._lineHeight,useCover:!1,color:(xo.getColorMap()||[])[y.foreground],italic:y.italic,bold:y.bold,underline:y.underline,strikethrough:y.strikethrough})}return}if(!this._primaryCursorVisibleRange){this._renderAtTopLeft();return}let t=this._contentLeft+this._primaryCursorVisibleRange.left-this._scrollLeft;if(t<this._contentLeft||t>this._contentLeft+this._contentWidth){this._renderAtTopLeft();return}let n=this._context.viewLayout.getVerticalOffsetForLineNumber(this._selections[0].positionLineNumber)-this._scrollTop;if(n<0||n>this._contentHeight){this._renderAtTopLeft();return}if(Be||this._accessibilitySupport===2){this._doRender({lastRenderPosition:this._primaryCursorPosition,top:n,left:this._textAreaWrapping?this._contentLeft:t,width:this._textAreaWidth,height:this._lineHeight,useCover:!1}),this.textArea.domNode.scrollLeft=this._primaryCursorVisibleRange.left;let i=this._textAreaInput.textAreaState.newlineCountBeforeSelection??Vg(this.textArea.domNode.value.substring(0,this.textArea.domNode.selectionStart));this.textArea.domNode.scrollTop=i*this._lineHeight;return}this._doRender({lastRenderPosition:this._primaryCursorPosition,top:n,left:this._textAreaWrapping?this._contentLeft:t,width:this._textAreaWidth,height:BD?0:1,useCover:!1})}_renderAtTopLeft(){this._doRender({lastRenderPosition:null,top:0,left:0,width:this._textAreaWidth,height:BD?0:1,useCover:!0})}_doRender(t){this._lastRenderPosition=t.lastRenderPosition;let n=this.textArea,i=this.textAreaCover;ln(n,this._fontInfo),n.setTop(t.top),n.setLeft(t.left),n.setWidth(t.width),n.setHeight(t.height),n.setColor(t.color?N.Format.CSS.formatHex(t.color):""),n.setFontStyle(t.italic?"italic":""),t.bold&&n.setFontWeight("bold"),n.setTextDecoration(`${t.underline?" underline":""}${t.strikethrough?" line-through":""}`),i.setTop(t.useCover?t.top:0),i.setLeft(t.useCover?t.left:0),i.setWidth(t.useCover?t.width:0),i.setHeight(t.useCover?t.height:0);let r=this._context.configuration.options;r.get(58)?i.setClassName("monaco-editor-background textAreaCover "+Gh.OUTER_CLASS_NAME):r.get(69).renderType!==0?i.setClassName("monaco-editor-background textAreaCover "+Kh.CLASS_NAME):i.setClassName("monaco-editor-background textAreaCover")}};qh=R([S(3,un),S(4,ct)],qh);function G5(o,e,t,n){if(e.length===0)return 0;let i=o.createElement("div");i.style.position="absolute",i.style.top="-50000px",i.style.width="50000px";let r=o.createElement("span");ln(r,t),r.style.whiteSpace="pre",r.style.tabSize=`${n*t.spaceWidth}px`,r.append(e),i.appendChild(r),o.body.appendChild(i);let s=r.offsetWidth;return i.remove(),s}var jP=Y("clipboardService");var QC=class extends V{constructor(t,n){super();this._domNode=t;this._onFocusChange=n;this._register(U(this._domNode,"focus",()=>this._handleFocusedChanged(!0))),this._register(U(this._domNode,"blur",()=>this._handleFocusedChanged(!1)))}_isFocused=!1;_handleFocusedChanged(t){this._isFocused!==t&&(this._isFocused=t,this._onFocusChange(this._isFocused))}focus(){this._domNode.focus()}get isFocused(){return this._isFocused}};function Yh(o,e,t,n){return o.addEventListener(e,t,n),{dispose(){o.removeEventListener(e,t)}}}var Zh=class{constructor(e,t,n){this._domNode=e;this._context=t;this._keybindingService=n;this._updateConfigurationSettings(),this._updateDomAttributes()}_contentLeft=1;_contentWidth=1;_lineHeight=1;_fontInfo;_accessibilitySupport=0;_accessibilityPageSize=1;_primarySelection=new He(1,1,1,1);_screenReaderContentState;onConfigurationChanged(e){this._updateConfigurationSettings(),this._updateDomAttributes(),e.hasChanged(2)&&this.writeScreenReaderContent()}_updateConfigurationSettings(){let e=this._context.configuration.options,t=e.get(147);this._contentLeft=t.contentLeft,this._contentWidth=t.contentWidth,this._fontInfo=e.get(51),this._lineHeight=e.get(68),this._accessibilitySupport=e.get(2),this._accessibilityPageSize=e.get(3)}_updateDomAttributes(){let e=this._context.configuration.options;this._domNode.domNode.setAttribute("aria-label",Bg(e,this._keybindingService));let t=this._context.viewModel.model.getOptions().tabSize,n=e.get(51).spaceWidth;this._domNode.domNode.style.tabSize=`${t*n}px`}onCursorStateChanged(e){this._primarySelection=e.selections[0]??new He(1,1,1,1)}prepareRender(e){this.writeScreenReaderContent()}render(e){if(!this._screenReaderContentState)return;ln(this._domNode,this._fontInfo);let t=this._context.viewLayout.getVerticalOffsetForLineNumber(this._primarySelection.positionLineNumber),n=this._context.viewLayout.getCurrentScrollTop(),i=t-n;this._domNode.setTop(i),this._domNode.setLeft(this._contentLeft),this._domNode.setWidth(this._contentWidth),this._domNode.setHeight(this._lineHeight);let r=this._screenReaderContentState.value.substring(0,this._screenReaderContentState.selectionStart),s=Vg(r);this._domNode.domNode.scrollTop=s*this._lineHeight}setAriaOptions(){}writeScreenReaderContent(){this._screenReaderContentState=this._getScreenReaderContentState(),this._screenReaderContentState&&(this._domNode.domNode.textContent!==this._screenReaderContentState.value&&(this._domNode.domNode.textContent=this._screenReaderContentState.value),this._setSelectionOfScreenReaderContent(this._screenReaderContentState.selectionStart,this._screenReaderContentState.selectionEnd))}_getScreenReaderContentState(){let e=this._accessibilitySupport===1?1:this._accessibilityPageSize,t={getLineCount:()=>this._context.viewModel.getLineCount(),getLineMaxColumn:n=>this._context.viewModel.getLineMaxColumn(n),getValueInRange:(n,i)=>this._context.viewModel.getValueInRange(n,i),getValueLengthInRange:(n,i)=>this._context.viewModel.getValueLengthInRange(n,i),modifyPosition:(n,i)=>this._context.viewModel.modifyPosition(n,i)};return Wh.fromEditorSelection(t,this._primarySelection,e,this._accessibilitySupport===0)}_setSelectionOfScreenReaderContent(e,t){let i=rl().document.getSelection();if(!i)return;let r=this._domNode.domNode.firstChild;if(!r)return;let s=rl().document.activeElement,a=new globalThis.Range;a.setStart(r,e),a.setEnd(r,t),i.removeAllRanges(),i.addRange(a),yn(s)&&s.focus()}};Zh=R([S(2,un)],Zh);var Xh=class extends $h{domNode;_editContext;_screenReaderSupport;_parent;_decorations=[];_renderingContext;_primarySelection=new He(1,1,1,1);_textStartPositionWithinEditor=new P(1,1);_compositionRangeWithinEditor;_focusTracker;constructor(e,t,n,i){super(e),this.domNode=new vd(document.createElement("div")),this.domNode.setClassName("native-edit-context"),this._updateDomAttributes(),this._focusTracker=this._register(new QC(this.domNode.domNode,r=>this._context.viewModel.setHasFocus(r))),this._editContext=new EditContext,this.domNode.domNode.editContext=this._editContext,this._screenReaderSupport=n.createInstance(Zh,this.domNode,e),this._register(U(this.domNode.domNode,"copy",()=>this._ensureClipboardGetsEditorSelection(i))),this._register(U(this.domNode.domNode,"cut",()=>{this._ensureClipboardGetsEditorSelection(i),t.cut()})),this._register(U(this.domNode.domNode,"keyup",r=>t.emitKeyUp(new nt(r)))),this._register(U(this.domNode.domNode,"keydown",async r=>{let s=new nt(r);s.keyCode===114&&s.stopPropagation(),s.keyCode===3&&this._onType(t,{text:`
`,replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0}),t.emitKeyDown(s)})),this._register(Yh(this._editContext,"textformatupdate",r=>this._handleTextFormatUpdate(r))),this._register(Yh(this._editContext,"characterboundsupdate",r=>this._updateCharacterBounds())),this._register(Yh(this._editContext,"textupdate",r=>{let s=this._compositionRangeWithinEditor;if(s){let a=this._context.viewModel.getPrimaryCursorState().modelState.position,l=D.fromPositions(s.getStartPosition(),a);this._compositionRangeWithinEditor=l}this._emitTypeEvent(t,r),this._screenReaderSupport.writeScreenReaderContent()})),this._register(Yh(this._editContext,"compositionstart",r=>{let s=this._context.viewModel.getPrimaryCursorState().modelState.position,a=D.fromPositions(s,s);this._compositionRangeWithinEditor=a,t.compositionStart(),this._context.viewModel.onCompositionStart()})),this._register(Yh(this._editContext,"compositionend",r=>{this._compositionRangeWithinEditor=void 0,t.compositionEnd(),this._context.viewModel.onCompositionEnd()}))}dispose(){super.dispose(),this.domNode.domNode.remove()}appendTo(e){e.appendChild(this.domNode),this._parent=e.domNode}setAriaOptions(){this._screenReaderSupport.setAriaOptions()}getLastRenderData(){return this._primarySelection.getPosition()}prepareRender(e){this._renderingContext=e,this._screenReaderSupport.prepareRender(e),this._updateEditContext(),this._updateSelectionAndControlBounds(),this._updateCharacterBounds()}render(e){this._screenReaderSupport.render(e)}onCursorStateChanged(e){return this._primarySelection=e.modelSelections[0]??new He(1,1,1,1),this._screenReaderSupport.onCursorStateChanged(e),!0}onConfigurationChanged(e){return this._screenReaderSupport.onConfigurationChanged(e),this._updateDomAttributes(),!0}writeScreenReaderContent(){this._screenReaderSupport.writeScreenReaderContent()}isFocused(){return this._focusTracker.isFocused}focus(){this._focusTracker.focus()}refreshFocusState(){}_updateDomAttributes(){let e=this._context.configuration.options;this.domNode.domNode.setAttribute("tabindex",String(e.get(126)))}_updateEditContext(){let e=this._getNewEditContextState();this._editContext.updateText(0,Number.MAX_SAFE_INTEGER,e.text),this._editContext.updateSelection(e.selectionStartOffset,e.selectionEndOffset),this._textStartPositionWithinEditor=e.textStartPositionWithinEditor}_emitTypeEvent(e,t){if(!this._editContext)return;let n=this._context.viewModel.model,i=n.getOffsetAt(this._textStartPositionWithinEditor),r=n.getOffsetAt(this._primarySelection.getEndPosition()),s=n.getOffsetAt(this._primarySelection.getStartPosition()),a=r-i,l=s-i,d=0,c=0;t.updateRangeEnd>a&&(d=t.updateRangeEnd-a),t.updateRangeStart<l&&(c=l-t.updateRangeStart);let u="";l<t.updateRangeStart&&(u+=this._editContext.text.substring(l,t.updateRangeStart)),u+=t.text,a>t.updateRangeEnd&&(u+=this._editContext.text.substring(t.updateRangeEnd,a));let h={text:u,replacePrevCharCnt:c,replaceNextCharCnt:d,positionDelta:0};this._onType(e,h);let m=l-c+u.length;this._updateCursorStatesAfterType(m,t.selectionStart,t.selectionEnd)}_onType(e,t){t.replacePrevCharCnt||t.replaceNextCharCnt||t.positionDelta?e.compositionType(t.text,t.replacePrevCharCnt,t.replaceNextCharCnt,t.positionDelta):e.type(t.text)}_updateCursorStatesAfterType(e,t,n){let i=t-e,r=n-e,l=this._context.viewModel.getCursorStates().map(d=>d.modelState.position).map(d=>{let c=d.lineNumber,u=d.column;return new He(c,u+i,c,u+r)}).map(d=>Ue.fromModelSelection(d));this._context.viewModel.setCursorStates("editContext",3,l)}_getNewEditContextState(){let e=this._primarySelection.startColumn-1,t=0;for(let a=this._primarySelection.startLineNumber;a<=this._primarySelection.endLineNumber;a++)a===this._primarySelection.endLineNumber?t+=this._primarySelection.endColumn-1:t+=this._context.viewModel.model.getLineMaxColumn(a);let n=this._context.viewModel.model.getLineMaxColumn(this._primarySelection.endLineNumber),i=new D(this._primarySelection.startLineNumber,1,this._primarySelection.endLineNumber,n),r=this._context.viewModel.model.getValueInRange(i,0),s=i.getStartPosition();return{text:r,selectionStartOffset:e,selectionEndOffset:t,textStartPositionWithinEditor:s}}_handleTextFormatUpdate(e){if(!this._editContext)return;let t=e.getTextFormats(),n=this._textStartPositionWithinEditor,i=[];t.forEach(r=>{let s=this._context.viewModel.model,a=s.getOffsetAt(n),l=s.getPositionAt(a+r.rangeStart),d=s.getPositionAt(a+r.rangeEnd),c=D.fromPositions(l,d),u=["edit-context-format-decoration",`underline-style-${r.underlineStyle.toLowerCase()}`,`underline-thickness-${r.underlineThickness.toLowerCase()}`];i.push({range:c,options:{description:"textFormatDecoration",inlineClassName:u.join(" ")}})}),this._decorations=this._context.viewModel.model.deltaDecorations(this._decorations,i)}_updateSelectionAndControlBounds(){if(!this._parent)return;let e=this._context.configuration.options,t=e.get(68),n=e.get(147).contentLeft,i=this._parent.getBoundingClientRect(),r=this._context.viewLayout.getVerticalOffsetForLineNumber(this._primarySelection.startLineNumber),s=this._context.viewLayout.getCurrentScrollTop(),a=i.top+r-s,l=(this._primarySelection.endLineNumber-this._primarySelection.startLineNumber+1)*t,d=i.left+n,c;if(this._primarySelection.isEmpty()){if(this._renderingContext){let m=this._renderingContext.linesVisibleRangesForRange(this._primarySelection,!0)??[];m.length>0&&(d+=Math.min(...m.map(f=>Math.min(...f.ranges.map(g=>g.left)))))}c=e.get(51).typicalHalfwidthCharacterWidth/2}else c=i.width-n;let u=new DOMRect(d,a,c,l),h=u;this._editContext.updateControlBounds(h),this._editContext.updateSelectionBounds(u)}_updateCharacterBounds(){if(!this._parent||!this._compositionRangeWithinEditor)return;let e=this._context.configuration.options,t=e.get(68),n=e.get(147).contentLeft,i=this._parent.getBoundingClientRect(),r=this._compositionRangeWithinEditor,s=this._context.viewLayout.getVerticalOffsetForLineNumber(r.startLineNumber),a=this._context.viewLayout.getCurrentScrollTop(),l=i.top+s-a,d=[];if(this._renderingContext){let f=this._renderingContext.linesVisibleRangesForRange(r,!0)??[];for(let g of f)for(let b of g.ranges)d.push(new DOMRect(i.left+n+b.left,l,b.width,t))}let c=this._context.viewModel.model,u=c.getOffsetAt(this._textStartPositionWithinEditor),m=c.getOffsetAt(r.getStartPosition())-u;this._editContext.updateCharacterBounds(m,d)}_ensureClipboardGetsEditorSelection(e){let t=this._context.configuration.options,n=t.get(38),i=t.get(25),r=this._context.viewModel.getCursorStates().map(l=>l.modelState.selection),s=mC(this._context.viewModel,r,n,i),a={version:1,isFromEmptySelection:s.isFromEmptySelection,multicursorText:s.multicursorText,mode:s.mode};gc.INSTANCE.set(sn?s.text.replace(/\r\n/g,`
`):s.text,a),e.writeText(s.text)}};Xh=R([S(2,ct),S(3,jP)],Xh);var Qh=class extends dr{constructor(t,n,i,r,s,a,l){super();this._instantiationService=l;this._selections=[new He(1,1,1,1)],this._renderAnimationFrame=null;let d=new lC(n,r,s,t);this._context=new RI(n,i,r),this._context.addEventHandler(this),this._viewParts=[];let c=this._context.configuration.options.get(37);this._editContext=c?this._instantiationService.createInstance(Xh,this._context,d):this._instantiationService.createInstance(qh,this._context,d,this._createTextAreaHandlerHelper()),this._viewParts.push(this._editContext),this._linesContent=Oe(document.createElement("div")),this._linesContent.setClassName("lines-content monaco-editor-background"),this._linesContent.setPosition("absolute"),this.domNode=Oe(document.createElement("div")),this.domNode.setClassName(this._getEditorClassName()),this.domNode.setAttribute("role","code"),this._overflowGuardContainer=Oe(document.createElement("div")),Rn.write(this._overflowGuardContainer,3),this._overflowGuardContainer.setClassName("overflow-guard"),this._scrollbar=new LC(this._context,this._linesContent,this.domNode,this._overflowGuardContainer),this._viewParts.push(this._scrollbar),this._viewLines=new RC(this._context,this._linesContent),this._viewZones=new YC(this._context),this._viewParts.push(this._viewZones);let u=new UC(this._context);this._viewParts.push(u);let h=new GC(this._context);this._viewParts.push(h);let m=new yC(this._context);this._viewParts.push(m),m.addDynamicOverlay(new EC(this._context)),m.addDynamicOverlay(new $C(this._context)),m.addDynamicOverlay(new kC(this._context)),m.addDynamicOverlay(new TC(this._context)),m.addDynamicOverlay(new ZC(this._context));let f=new IC(this._context);this._viewParts.push(f),f.addDynamicOverlay(new _C(this._context)),f.addDynamicOverlay(new AC(this._context)),f.addDynamicOverlay(new MC(this._context)),f.addDynamicOverlay(new Kh(this._context)),this._glyphMarginWidgets=new DC(this._context),this._viewParts.push(this._glyphMarginWidgets);let g=new Gh(this._context);g.getDomNode().appendChild(this._viewZones.marginDomNode),g.getDomNode().appendChild(f.getDomNode()),g.getDomNode().appendChild(this._glyphMarginWidgets.domNode),this._viewParts.push(g),this._contentWidgets=new SC(this._context,this.domNode),this._viewParts.push(this._contentWidgets),this._viewCursors=new qC(this._context),this._viewParts.push(this._viewCursors),this._overlayWidgets=new HC(this._context,this.domNode),this._viewParts.push(this._overlayWidgets);let b=new KC(this._context);this._viewParts.push(b);let y=new CC(this._context);this._viewParts.push(y);let C=new VC(this._context);if(this._viewParts.push(C),u){let x=this._scrollbar.getOverviewRulerLayoutInfo();x.parent.insertBefore(u.getDomNode(),x.insertBefore)}this._linesContent.appendChild(m.getDomNode()),this._linesContent.appendChild(b.domNode),this._linesContent.appendChild(this._viewZones.domNode),this._linesContent.appendChild(this._viewLines.getDomNode()),this._linesContent.appendChild(this._contentWidgets.domNode),this._linesContent.appendChild(this._viewCursors.getDomNode()),this._overflowGuardContainer.appendChild(g.getDomNode()),this._overflowGuardContainer.appendChild(this._scrollbar.getDomNode()),this._overflowGuardContainer.appendChild(h.getDomNode()),this._editContext.appendTo(this._overflowGuardContainer),this._overflowGuardContainer.appendChild(this._overlayWidgets.getDomNode()),this._overflowGuardContainer.appendChild(C.getDomNode()),this._overflowGuardContainer.appendChild(y.domNode),this.domNode.appendChild(this._overflowGuardContainer),a?(a.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode.domNode),a.appendChild(this._overlayWidgets.overflowingOverlayWidgetsDomNode.domNode)):(this.domNode.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode),this.domNode.appendChild(this._overlayWidgets.overflowingOverlayWidgetsDomNode)),this._applyLayout(),this._pointerHandler=this._register(new bC(this._context,d,this._createPointerHandlerHelper()))}_scrollbar;_context;_selections;_viewLines;_viewZones;_contentWidgets;_overlayWidgets;_glyphMarginWidgets;_viewCursors;_viewParts;_editContext;_pointerHandler;_linesContent;domNode;_overflowGuardContainer;_shouldRecomputeGlyphMarginLanes=!1;_renderAnimationFrame;_computeGlyphMarginLanes(){let t=this._context.viewModel.model,n=this._context.viewModel.glyphLanes,i=[],r=0;i=i.concat(t.getAllMarginDecorations().map(s=>{let a=s.options.glyphMargin?.position??2;return r=Math.max(r,s.range.endLineNumber),{range:s.range,lane:a,persist:s.options.glyphMargin?.persistLane}})),i=i.concat(this._glyphMarginWidgets.getWidgets().map(s=>{let a=t.validateRange(s.preference.range);return r=Math.max(r,a.endLineNumber),{range:a,lane:s.preference.lane}})),i.sort((s,a)=>D.compareRangesUsingStarts(s.range,a.range)),n.reset(r);for(let s of i)n.push(s.lane,s.range,s.persist);return n}_createPointerHandlerHelper(){return{viewDomNode:this.domNode.domNode,linesContentDomNode:this._linesContent.domNode,viewLinesDomNode:this._viewLines.getDomNode().domNode,focusTextArea:()=>{this.focus()},dispatchTextAreaEvent:t=>{this._editContext.domNode.domNode.dispatchEvent(t)},getLastRenderData:()=>{let t=this._viewCursors.getLastRenderData()||[],n=this._editContext.getLastRenderData();return new VI(t,n)},renderNow:()=>{this.render(!0,!1)},shouldSuppressMouseDownOnViewZone:t=>this._viewZones.shouldSuppressMouseDownOnViewZone(t),shouldSuppressMouseDownOnWidget:t=>this._contentWidgets.shouldSuppressMouseDownOnWidget(t),getPositionFromDOMInfo:(t,n)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.getPositionFromDOMInfo(t,n)),visibleRangeForPosition:(t,n)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.visibleRangeForPosition(new P(t,n))),getLineWidth:t=>(this._flushAccumulatedAndRenderNow(),this._viewLines.getLineWidth(t))}}_createTextAreaHandlerHelper(){return{visibleRangeForPosition:t=>(this._flushAccumulatedAndRenderNow(),this._viewLines.visibleRangeForPosition(t))}}_applyLayout(){let n=this._context.configuration.options.get(147);this.domNode.setWidth(n.width),this.domNode.setHeight(n.height),this._overflowGuardContainer.setWidth(n.width),this._overflowGuardContainer.setHeight(n.height),this._linesContent.setWidth(16777216),this._linesContent.setHeight(16777216)}_getEditorClassName(){let t=this._editContext.isFocused()?" focused":"";return this._context.configuration.options.get(144)+" "+Gm(this._context.theme.type)+t}handleEvents(t){super.handleEvents(t),this._scheduleRender()}onConfigurationChanged(t){return this.domNode.setClassName(this._getEditorClassName()),this._applyLayout(),!1}onCursorStateChanged(t){return this._selections=t.selections,!1}onDecorationsChanged(t){return t.affectsGlyphMargin&&(this._shouldRecomputeGlyphMarginLanes=!0),!1}onFocusChanged(t){return this.domNode.setClassName(this._getEditorClassName()),!1}onThemeChanged(t){return this._context.theme.update(t.theme),this.domNode.setClassName(this._getEditorClassName()),!1}dispose(){this._renderAnimationFrame!==null&&(this._renderAnimationFrame.dispose(),this._renderAnimationFrame=null),this._contentWidgets.overflowingContentWidgetsDomNode.domNode.remove(),this._context.removeEventHandler(this),this._viewLines.dispose();for(let t of this._viewParts)t.dispose();super.dispose()}_scheduleRender(){if(this._store.isDisposed)throw new Qe;if(this._renderAnimationFrame===null){let t=this._createCoordinatedRendering();this._renderAnimationFrame=WD.INSTANCE.scheduleCoordinatedRendering({window:Ie(this.domNode?.domNode),prepareRenderText:()=>{if(this._store.isDisposed)throw new Qe;try{return t.prepareRenderText()}finally{this._renderAnimationFrame=null}},renderText:()=>{if(this._store.isDisposed)throw new Qe;return t.renderText()},prepareRender:(n,i)=>{if(this._store.isDisposed)throw new Qe;return t.prepareRender(n,i)},render:(n,i)=>{if(this._store.isDisposed)throw new Qe;return t.render(n,i)}})}}_flushAccumulatedAndRenderNow(){let t=this._createCoordinatedRendering();Vl(()=>t.prepareRenderText());let n=Vl(()=>t.renderText());if(n){let[i,r]=n;Vl(()=>t.prepareRender(i,r)),Vl(()=>t.render(i,r))}}_getViewPartsToRender(){let t=[],n=0;for(let i of this._viewParts)i.shouldRender()&&(t[n++]=i);return t}_createCoordinatedRendering(){return{prepareRenderText:()=>{if(this._shouldRecomputeGlyphMarginLanes){this._shouldRecomputeGlyphMarginLanes=!1;let t=this._computeGlyphMarginLanes();this._context.configuration.setGlyphMarginDecorationLaneCount(t.requiredLanes)}xa.onRenderStart()},renderText:()=>{if(!this.domNode.domNode.isConnected)return null;let t=this._getViewPartsToRender();if(!this._viewLines.shouldRender()&&t.length===0)return null;let n=this._context.viewLayout.getLinesViewportData();this._context.viewModel.setViewport(n.startLineNumber,n.endLineNumber,n.centeredLineNumber);let i=new TI(this._selections,n,this._context.viewLayout.getWhitespaceViewportData(),this._context.viewModel);return this._contentWidgets.shouldRender()&&this._contentWidgets.onBeforeRender(i),this._viewLines.shouldRender()&&(this._viewLines.renderText(i),this._viewLines.onDidRender(),t=this._getViewPartsToRender()),[t,new LI(this._context.viewLayout,i,this._viewLines)]},prepareRender:(t,n)=>{for(let i of t)i.prepareRender(n)},render:(t,n)=>{for(let i of t)i.render(n),i.onDidRender()}}}delegateVerticalScrollbarPointerDown(t){this._scrollbar.delegateVerticalScrollbarPointerDown(t)}delegateScrollFromMouseWheelEvent(t){this._scrollbar.delegateScrollFromMouseWheelEvent(t)}restoreState(t){this._context.viewModel.viewLayout.setScrollPosition({scrollTop:t.scrollTop,scrollLeft:t.scrollLeft},1),this._context.viewModel.visibleLinesStabilized()}getOffsetForColumn(t,n){let i=this._context.viewModel.model.validatePosition({lineNumber:t,column:n}),r=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(i);this._flushAccumulatedAndRenderNow();let s=this._viewLines.visibleRangeForPosition(new P(r.lineNumber,r.column));return s?s.left:-1}getTargetAtClientPoint(t,n){let i=this._pointerHandler.getTargetAtClientPoint(t,n);return i?Ph.convertViewToModelMouseTarget(i,this._context.viewModel.coordinatesConverter):null}createOverviewRuler(t){return new zC(this._context,t)}change(t){this._viewZones.changeViewZones(t),this._scheduleRender()}render(t,n){if(n){this._viewLines.forceShouldRender();for(let i of this._viewParts)i.forceShouldRender()}t?this._flushAccumulatedAndRenderNow():this._scheduleRender()}writeScreenReaderContent(t){this._editContext.writeScreenReaderContent(t)}focus(){this._editContext.focus()}isFocused(){return this._editContext.isFocused()}refreshFocusState(){this._editContext.refreshFocusState()}setAriaOptions(t){this._editContext.setAriaOptions(t)}addContentWidget(t){this._contentWidgets.addWidget(t.widget),this.layoutContentWidget(t),this._scheduleRender()}layoutContentWidget(t){this._contentWidgets.setWidgetPosition(t.widget,t.position?.position??null,t.position?.secondaryPosition??null,t.position?.preference??null,t.position?.positionAffinity??null),this._scheduleRender()}removeContentWidget(t){this._contentWidgets.removeWidget(t.widget),this._scheduleRender()}addOverlayWidget(t){this._overlayWidgets.addWidget(t.widget),this.layoutOverlayWidget(t),this._scheduleRender()}layoutOverlayWidget(t){this._overlayWidgets.setWidgetPosition(t.widget,t.position)&&this._scheduleRender()}removeOverlayWidget(t){this._overlayWidgets.removeWidget(t.widget),this._scheduleRender()}addGlyphMarginWidget(t){this._glyphMarginWidgets.addWidget(t.widget),this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender()}layoutGlyphMarginWidget(t){let n=t.position;this._glyphMarginWidgets.setWidgetPosition(t.widget,n)&&(this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender())}removeGlyphMarginWidget(t){this._glyphMarginWidgets.removeWidget(t.widget),this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender()}};Qh=R([S(6,ct)],Qh);function Vl(o){try{return o()}catch(e){return je(e),null}}var WD=class o{static INSTANCE=new o;_coordinatedRenderings=[];_animationFrameRunners=new Map;constructor(){}scheduleCoordinatedRendering(e){return this._coordinatedRenderings.push(e),this._scheduleRender(e.window),{dispose:()=>{let t=this._coordinatedRenderings.indexOf(e);if(t!==-1&&(this._coordinatedRenderings.splice(t,1),this._coordinatedRenderings.length===0)){for(let[n,i]of this._animationFrameRunners)i.dispose();this._animationFrameRunners.clear()}}}}_scheduleRender(e){if(!this._animationFrameRunners.has(e)){let t=()=>{this._animationFrameRunners.delete(e),this._onRenderScheduled()};this._animationFrameRunners.set(e,qx(e,t,100))}}_onRenderScheduled(){let e=this._coordinatedRenderings.slice(0);this._coordinatedRenderings=[];for(let n of e)Vl(()=>n.prepareRenderText());let t=[];for(let n=0,i=e.length;n<i;n++){let r=e[n];t[n]=Vl(()=>r.renderText())}for(let n=0,i=e.length;n<i;n++){let r=e[n],s=t[n];if(!s)continue;let[a,l]=s;Vl(()=>r.prepareRender(a,l))}for(let n=0,i=e.length;n<i;n++){let r=e[n],s=t[n];if(!s)continue;let[a,l]=s;Vl(()=>r.render(a,l))}}};var $5=MI("domLineBreaksComputer",{createHTML:o=>o}),JC=class o{constructor(e){this.targetWindow=e}static create(e){return new o(new WeakRef(e))}createLineBreaksComputer(e,t,n,i,r){let s=[],a=[];return{addRequest:(l,d,c)=>{s.push(l),a.push(d)},finalize:()=>q5(Tn(this.targetWindow.deref()),s,e,t,n,i,r,a)}}};function q5(o,e,t,n,i,r,s,a){function l(B){let G=a[B];if(G){let q=oo.applyInjectedText(e[B],G),X=G.map(Ce=>Ce.options),ce=G.map(Ce=>Ce.column-1);return new ha(ce,X,[q.length],[],0)}else return null}if(i===-1){let B=[];for(let G=0,q=e.length;G<q;G++)B[G]=l(G);return B}let d=Math.round(i*t.typicalHalfwidthCharacterWidth),c=r===3?2:r===2?1:0,u=Math.round(n*c),h=Math.ceil(t.spaceWidth*u),m=document.createElement("div");ln(m,t);let f=new Md(1e4),g=[],b=[],y=[],C=[],x=[];for(let B=0;B<e.length;B++){let G=oo.applyInjectedText(e[B],a[B]),q=0,X=0,ce=d;if(r!==0)if(q=Xt(G),q===-1)q=0;else{for(let le=0;le<q;le++){let ne=G.charCodeAt(le)===9?n-X%n:1;X+=ne}let Z=Math.ceil(t.spaceWidth*X);Z+t.typicalFullwidthCharacterWidth>d?(q=0,X=0):ce=d-Z}let Ce=G.substr(q),te=Y5(Ce,X,n,ce,f,h);g[B]=q,b[B]=X,y[B]=Ce,C[B]=te[0],x[B]=te[1]}let L=f.build(),k=$5?.createHTML(L)??L;m.innerHTML=k,m.style.position="absolute",m.style.top="10000",s==="keepAll"?(m.style.wordBreak="keep-all",m.style.overflowWrap="anywhere"):(m.style.wordBreak="inherit",m.style.overflowWrap="break-word"),o.document.body.appendChild(m);let O=document.createRange(),W=Array.prototype.slice.call(m.children,0),z=[];for(let B=0;B<e.length;B++){let G=W[B],q=Z5(O,G,y[B],C[B]);if(q===null){z[B]=l(B);continue}let X=g[B],ce=b[B]+u,Ce=x[B],te=[];for(let Q=0,we=q.length;Q<we;Q++)te[Q]=Ce[q[Q]];if(X!==0)for(let Q=0,we=q.length;Q<we;Q++)q[Q]+=X;let Z,le,ne=a[B];ne?(Z=ne.map(Q=>Q.options),le=ne.map(Q=>Q.column-1)):(Z=null,le=null),z[B]=new ha(le,Z,q,te,ce)}return m.remove(),z}function Y5(o,e,t,n,i,r){if(r!==0){let h=String(r);i.appendString('<div style="text-indent: -'),i.appendString(h),i.appendString("px; padding-left: "),i.appendString(h),i.appendString("px; box-sizing: border-box; width:")}else i.appendString('<div style="width:');i.appendString(String(n)),i.appendString('px;">');let s=o.length,a=e,l=0,d=[],c=[],u=0<s?o.charCodeAt(0):0;i.appendString("<span>");for(let h=0;h<s;h++){h!==0&&h%16384===0&&i.appendString("</span><span>"),d[h]=l,c[h]=a;let m=u;u=h+1<s?o.charCodeAt(h+1):0;let f=1,g=1;switch(m){case 9:f=t-a%t,g=f;for(let b=1;b<=f;b++)b<f?i.appendCharCode(160):i.appendASCIICharCode(32);break;case 32:u===32?i.appendCharCode(160):i.appendASCIICharCode(32);break;case 60:i.appendString("&lt;");break;case 62:i.appendString("&gt;");break;case 38:i.appendString("&amp;");break;case 0:i.appendString("&#00;");break;case 65279:case 8232:case 8233:case 133:i.appendCharCode(65533);break;default:Ho(m)&&g++,m<32?i.appendCharCode(9216+m):i.appendCharCode(m)}l+=f,a+=g}return i.appendString("</span>"),d[o.length]=l,c[o.length]=a,i.appendString("</div>"),[d,c]}function Z5(o,e,t,n){if(t.length<=1)return null;let i=Array.prototype.slice.call(e.children,0),r=[];try{UD(o,i,n,0,null,t.length-1,null,r)}catch(s){return console.log(s),null}return r.length===0?null:(r.push(t.length),r)}function UD(o,e,t,n,i,r,s,a){if(n===r||(i=i||HD(o,e,t[n],t[n+1]),s=s||HD(o,e,t[r],t[r+1]),Math.abs(i[0].top-s[0].top)<=.1))return;if(n+1===r){a.push(r);return}let l=n+(r-n)/2|0,d=HD(o,e,t[l],t[l+1]);UD(o,e,t,n,i,l,d,a),UD(o,e,t,l,d,r,s,a)}function HD(o,e,t,n){return o.setStart(e[t/16384|0].firstChild,t%16384),o.setEnd(e[n/16384|0].firstChild,n%16384),o.getClientRects()}var eS=class extends V{_editor=null;_instantiationService=null;_instances=this._register(new Fo);_pending=new Map;_finishedInstantiation=[];constructor(){super(),this._finishedInstantiation[0]=!1,this._finishedInstantiation[1]=!1,this._finishedInstantiation[2]=!1,this._finishedInstantiation[3]=!1}initialize(e,t,n){this._editor=e,this._instantiationService=n;for(let i of t){if(this._pending.has(i.id)){je(new Error(`Cannot have two contributions with the same id ${i.id}`));continue}this._pending.set(i.id,i)}this._instantiateSome(0),this._register(nm(Ie(this._editor.getDomNode()),()=>{this._instantiateSome(1)})),this._register(nm(Ie(this._editor.getDomNode()),()=>{this._instantiateSome(2)})),this._register(nm(Ie(this._editor.getDomNode()),()=>{this._instantiateSome(3)},5e3))}saveViewState(){let e={};for(let[t,n]of this._instances)typeof n.saveViewState=="function"&&(e[t]=n.saveViewState());return e}restoreViewState(e){for(let[t,n]of this._instances)typeof n.restoreViewState=="function"&&n.restoreViewState(e[t])}get(e){return this._instantiateById(e),this._instances.get(e)||null}set(e,t){this._instances.set(e,t)}onBeforeInteractionEvent(){this._instantiateSome(2)}onAfterModelAttached(){return nm(Ie(this._editor?.getDomNode()),()=>{this._instantiateSome(1)},50)}_instantiateSome(e){if(this._finishedInstantiation[e])return;this._finishedInstantiation[e]=!0;let t=this._findPendingContributionsByInstantiation(e);for(let n of t)this._instantiateById(n.id)}_findPendingContributionsByInstantiation(e){let t=[];for(let[,n]of this._pending)n.instantiation===e&&t.push(n);return t}_instantiateById(e){let t=this._pending.get(e);if(t){if(this._pending.delete(e),!this._instantiationService||!this._editor)throw new Error("Cannot instantiate contributions before being initialized!");try{let n=this._instantiationService.createInstance(t.ctor,this._editor);this._instances.set(t.id,n),typeof n.restoreViewState=="function"&&t.instantiation!==0&&console.warn(`Editor contribution '${t.id}' should be eager instantiated because it uses saveViewState / restoreViewState.`)}catch(n){je(n)}}}};var tS=class{constructor(e,t,n,i,r,s,a){this.id=e;this.label=t;this.alias=n;this.metadata=i;this._precondition=r;this._run=s;this._contextKeyService=a}isSupported(){return this._contextKeyService.contextMatchesRules(this._precondition)}run(e){return this.isSupported()?this._run(e):Promise.resolve(void 0)}};var $P=Y("ILanguageFeaturesService");var nS=class o{static create(e){return new o(e.get(136),e.get(135))}classifier;constructor(e,t){this.classifier=new zD(e,t)}createLineBreaksComputer(e,t,n,i,r){let s=[],a=[],l=[];return{addRequest:(d,c,u)=>{s.push(d),a.push(c),l.push(u)},finalize:()=>{let d=e.typicalFullwidthCharacterWidth/e.typicalHalfwidthCharacterWidth,c=[];for(let u=0,h=s.length;u<h;u++){let m=a[u],f=l[u];f&&!f.injectionOptions&&!m?c[u]=X5(this.classifier,f,s[u],t,n,d,i,r):c[u]=Q5(this.classifier,s[u],m,t,n,d,i,r)}return KD.length=0,GD.length=0,c}}}};var zD=class extends vu{constructor(e,t){super(0);for(let n=0;n<e.length;n++)this.set(e.charCodeAt(n),1);for(let n=0;n<t.length;n++)this.set(t.charCodeAt(n),2)}get(e){return e>=0&&e<256?this._asciiMap[e]:e>=12352&&e<=12543||e>=13312&&e<=19903||e>=19968&&e<=40959?3:this._map.get(e)||this._defaultValue}},KD=[],GD=[];function X5(o,e,t,n,i,r,s,a){if(i===-1)return null;let l=t.length;if(l<=1)return null;let d=a==="keepAll",c=e.breakOffsets,u=e.breakOffsetsVisibleColumn,h=YP(t,n,i,r,s),m=i-h,f=KD,g=GD,b=0,y=0,C=0,x=i,L=c.length,k=0;if(k>=0){let O=Math.abs(u[k]-x);for(;k+1<L;){let W=Math.abs(u[k+1]-x);if(W>=O)break;O=W,k++}}for(;k<L;){let O=k<0?0:c[k],W=k<0?0:u[k];y>O&&(O=y,W=C);let z=0,B=0,G=0,q=0;if(W<=x){let ce=W,Ce=O===0?0:t.charCodeAt(O-1),te=O===0?0:o.get(Ce),Z=!0;for(let le=O;le<l;le++){let ne=le,Q=t.charCodeAt(le),we,xe;if(Ht(Q)?(le++,we=0,xe=2):(we=o.get(Q),xe=Hg(Q,ce,n,r)),ne>y&&jD(Ce,te,Q,we,d)&&(z=ne,B=ce),ce+=xe,ce>x){ne>y?(G=ne,q=ce-xe):(G=le+1,q=ce),ce-B>m&&(z=0),Z=!1;break}Ce=Q,te=we}if(Z){b>0&&(f[b]=c[c.length-1],g[b]=u[c.length-1],b++);break}}if(z===0){let ce=W,Ce=t.charCodeAt(O),te=o.get(Ce),Z=!1;for(let le=O-1;le>=y;le--){let ne=le+1,Q=t.charCodeAt(le);if(Q===9){Z=!0;break}let we,xe;if(Qa(Q)?(le--,we=0,xe=2):(we=o.get(Q),xe=Ho(Q)?r:1),ce<=x){if(G===0&&(G=ne,q=ce),ce<=x-m)break;if(jD(Q,we,Ce,te,d)){z=ne,B=ce;break}}ce-=xe,Ce=Q,te=we}if(z!==0){let le=m-(q-B);if(le<=n){let ne=t.charCodeAt(G),Q;Ht(ne)?Q=2:Q=Hg(ne,q,n,r),le-Q<0&&(z=0)}}if(Z){k--;continue}}if(z===0&&(z=G,B=q),z<=y){let ce=t.charCodeAt(y);Ht(ce)?(z=y+2,B=C+2):(z=y+1,B=C+Hg(ce,C,n,r))}for(y=z,f[b]=z,C=B,g[b]=B,b++,x=B+m;k<0||k<L&&u[k]<B;)k++;let X=Math.abs(u[k]-x);for(;k+1<L;){let ce=Math.abs(u[k+1]-x);if(ce>=X)break;X=ce,k++}}return b===0?null:(f.length=b,g.length=b,KD=e.breakOffsets,GD=e.breakOffsetsVisibleColumn,e.breakOffsets=f,e.breakOffsetsVisibleColumn=g,e.wrappedTextIndentLength=h,e)}function Q5(o,e,t,n,i,r,s,a){let l=oo.applyInjectedText(e,t),d,c;if(t&&t.length>0?(d=t.map(B=>B.options),c=t.map(B=>B.column-1)):(d=null,c=null),i===-1)return d?new ha(c,d,[l.length],[],0):null;let u=l.length;if(u<=1)return d?new ha(c,d,[l.length],[],0):null;let h=a==="keepAll",m=YP(l,n,i,r,s),f=i-m,g=[],b=[],y=0,C=0,x=0,L=i,k=l.charCodeAt(0),O=o.get(k),W=Hg(k,0,n,r),z=1;Ht(k)&&(W+=1,k=l.charCodeAt(1),O=o.get(k),z++);for(let B=z;B<u;B++){let G=B,q=l.charCodeAt(B),X,ce;Ht(q)?(B++,X=0,ce=2):(X=o.get(q),ce=Hg(q,W,n,r)),jD(k,O,q,X,h)&&(C=G,x=W),W+=ce,W>L&&((C===0||W-x>f)&&(C=G,x=W-ce),g[y]=C,b[y]=x,y++,L=x+f,C=0),k=q,O=X}return y===0&&(!t||t.length===0)?null:(g[y]=u,b[y]=W,new ha(c,d,g,b,m))}function Hg(o,e,t,n){return o===9?t-e%t:Ho(o)||o<32?n:1}function qP(o,e){return e-o%e}function jD(o,e,t,n,i){return t!==32&&(e===2&&n!==2||e!==1&&n===1||!i&&e===3&&n!==2||!i&&n===3&&e!==1)}function YP(o,e,t,n,i){let r=0;if(i!==0){let s=Xt(o);if(s!==-1){for(let l=0;l<s;l++){let d=o.charCodeAt(l)===9?qP(r,e):1;r+=d}let a=i===3?2:i===2?1:0;for(let l=0;l<a;l++){let d=qP(r,e);r+=d}r+n>t&&(r=0)}}return r}var Ug=class{_cursorContextBrand=void 0;model;viewModel;coordinatesConverter;cursorConfig;constructor(e,t,n,i){this.model=e,this.viewModel=t,this.coordinatesConverter=n,this.cursorConfig=i}};var zg=class o{modelState;viewState;_selTrackedRange;_trackSelection;constructor(e){this._selTrackedRange=null,this._trackSelection=!0,this._setState(e,new cn(new D(1,1,1,1),0,0,new P(1,1),0),new cn(new D(1,1,1,1),0,0,new P(1,1),0))}dispose(e){this._removeTrackedRange(e)}startTrackingSelection(e){this._trackSelection=!0,this._updateTrackedRange(e)}stopTrackingSelection(e){this._trackSelection=!1,this._removeTrackedRange(e)}_updateTrackedRange(e){this._trackSelection&&(this._selTrackedRange=e.model._setTrackedRange(this._selTrackedRange,this.modelState.selection,0))}_removeTrackedRange(e){this._selTrackedRange=e.model._setTrackedRange(this._selTrackedRange,null,0)}asCursorState(){return new Ue(this.modelState,this.viewState)}readSelectionFromMarkers(e){let t=e.model._getTrackedRange(this._selTrackedRange);return this.modelState.selection.isEmpty()&&!t.isEmpty()?He.fromRange(t.collapseToEnd(),this.modelState.selection.getDirection()):He.fromRange(t,this.modelState.selection.getDirection())}ensureValidState(e){this._setState(e,this.modelState,this.viewState)}setState(e,t,n){this._setState(e,t,n)}static _validatePositionWithCache(e,t,n,i){return t.equals(n)?i:e.normalizePosition(t,2)}static _validateViewState(e,t){let n=t.position,i=t.selectionStart.getStartPosition(),r=t.selectionStart.getEndPosition(),s=e.normalizePosition(n,2),a=this._validatePositionWithCache(e,i,n,s),l=this._validatePositionWithCache(e,r,i,a);return n.equals(s)&&i.equals(a)&&r.equals(l)?t:new cn(D.fromPositions(a,l),t.selectionStartKind,t.selectionStartLeftoverVisibleColumns+i.column-a.column,s,t.leftoverVisibleColumns+n.column-s.column)}_setState(e,t,n){if(n&&(n=o._validateViewState(e.viewModel,n)),t){let i=e.model.validateRange(t.selectionStart),r=t.selectionStart.equalsRange(i)?t.selectionStartLeftoverVisibleColumns:0,s=e.model.validatePosition(t.position),a=t.position.equals(s)?t.leftoverVisibleColumns:0;t=new cn(i,t.selectionStartKind,r,s,a)}else{if(!n)return;let i=e.model.validateRange(e.coordinatesConverter.convertViewRangeToModelRange(n.selectionStart)),r=e.model.validatePosition(e.coordinatesConverter.convertViewPositionToModelPosition(n.position));t=new cn(i,n.selectionStartKind,n.selectionStartLeftoverVisibleColumns,r,n.leftoverVisibleColumns)}if(n){let i=e.coordinatesConverter.validateViewRange(n.selectionStart,t.selectionStart),r=e.coordinatesConverter.validateViewPosition(n.position,t.position);n=new cn(i,t.selectionStartKind,t.selectionStartLeftoverVisibleColumns,r,t.leftoverVisibleColumns)}else{let i=e.coordinatesConverter.convertModelPositionToViewPosition(new P(t.selectionStart.startLineNumber,t.selectionStart.startColumn)),r=e.coordinatesConverter.convertModelPositionToViewPosition(new P(t.selectionStart.endLineNumber,t.selectionStart.endColumn)),s=new D(i.lineNumber,i.column,r.lineNumber,r.column),a=e.coordinatesConverter.convertModelPositionToViewPosition(t.position);n=new cn(s,t.selectionStartKind,t.selectionStartLeftoverVisibleColumns,a,t.leftoverVisibleColumns)}this.modelState=t,this.viewState=n,this._updateTrackedRange(e)}};var Kg=class{context;cursors;lastAddedCursorIndex;constructor(e){this.context=e,this.cursors=[new zg(e)],this.lastAddedCursorIndex=0}dispose(){for(let e of this.cursors)e.dispose(this.context)}startTrackingSelections(){for(let e of this.cursors)e.startTrackingSelection(this.context)}stopTrackingSelections(){for(let e of this.cursors)e.stopTrackingSelection(this.context)}updateContext(e){this.context=e}ensureValidState(){for(let e of this.cursors)e.ensureValidState(this.context)}readSelectionFromMarkers(){return this.cursors.map(e=>e.readSelectionFromMarkers(this.context))}getAll(){return this.cursors.map(e=>e.asCursorState())}getViewPositions(){return this.cursors.map(e=>e.viewState.position)}getTopMostViewPosition(){return f1(this.cursors,Jl(e=>e.viewState.position,P.compare)).viewState.position}getBottomMostViewPosition(){return g1(this.cursors,Jl(e=>e.viewState.position,P.compare)).viewState.position}getSelections(){return this.cursors.map(e=>e.modelState.selection)}getViewSelections(){return this.cursors.map(e=>e.viewState.selection)}setSelections(e){this.setStates(Ue.fromModelSelections(e))}getPrimaryCursor(){return this.cursors[0].asCursorState()}setStates(e){e!==null&&(this.cursors[0].setState(this.context,e[0].modelState,e[0].viewState),this._setSecondaryStates(e.slice(1)))}_setSecondaryStates(e){let t=this.cursors.length-1,n=e.length;if(t<n){let i=n-t;for(let r=0;r<i;r++)this._addSecondaryCursor()}else if(t>n){let i=t-n;for(let r=0;r<i;r++)this._removeSecondaryCursor(this.cursors.length-2)}for(let i=0;i<n;i++)this.cursors[i+1].setState(this.context,e[i].modelState,e[i].viewState)}killSecondaryCursors(){this._setSecondaryStates([])}_addSecondaryCursor(){this.cursors.push(new zg(this.context)),this.lastAddedCursorIndex=this.cursors.length-1}getLastAddedCursorIndex(){return this.cursors.length===1||this.lastAddedCursorIndex===0?0:this.lastAddedCursorIndex}_removeSecondaryCursor(e){this.lastAddedCursorIndex>=e+1&&this.lastAddedCursorIndex--,this.cursors[e+1].dispose(this.context),this.cursors.splice(e+1,1)}normalize(){if(this.cursors.length===1)return;let e=this.cursors.slice(0),t=[];for(let n=0,i=e.length;n<i;n++)t.push({index:n,selection:e[n].modelState.selection});t.sort(Jl(n=>n.selection,D.compareRangesUsingStarts));for(let n=0;n<t.length-1;n++){let i=t[n],r=t[n+1],s=i.selection,a=r.selection;if(!this.context.cursorConfig.multiCursorMergeOverlapping)continue;let l;if(a.isEmpty()||s.isEmpty()?l=a.getStartPosition().isBeforeOrEqual(s.getEndPosition()):l=a.getStartPosition().isBefore(s.getEndPosition()),l){let d=i.index<r.index?n:n+1,c=i.index<r.index?n+1:n,u=t[c].index,h=t[d].index,m=t[c].selection,f=t[d].selection;if(!m.equalsSelection(f)){let g=m.plusRange(f),b=m.selectionStartLineNumber===m.startLineNumber&&m.selectionStartColumn===m.startColumn,y=f.selectionStartLineNumber===f.startLineNumber&&f.selectionStartColumn===f.startColumn,C;u===this.lastAddedCursorIndex?(C=b,this.lastAddedCursorIndex=h):C=y;let x;C?x=new He(g.startLineNumber,g.startColumn,g.endLineNumber,g.endColumn):x=new He(g.endLineNumber,g.endColumn,g.startLineNumber,g.startColumn),t[d].selection=x;let L=Ue.fromModelSelection(x);e[h].setState(this.context,L.modelState,L.viewState)}for(let g of t)g.index>u&&g.index--;e.splice(u,1),t.splice(c,1),this._removeSecondaryCursor(u-1),n--}}}};var iS=class extends V{_onEvent=this._register(new E);onEvent=this._onEvent.event;_eventHandlers;_viewEventQueue;_isConsumingViewEventQueue;_collector;_collectorCnt;_outgoingEvents;constructor(){super(),this._eventHandlers=[],this._viewEventQueue=null,this._isConsumingViewEventQueue=!1,this._collector=null,this._collectorCnt=0,this._outgoingEvents=[]}emitOutgoingEvent(e){this._addOutgoingEvent(e),this._emitOutgoingEvents()}_addOutgoingEvent(e){for(let t=0,n=this._outgoingEvents.length;t<n;t++){let i=this._outgoingEvents[t].kind===e.kind?this._outgoingEvents[t].attemptToMerge(e):null;if(i){this._outgoingEvents[t]=i;return}}this._outgoingEvents.push(e)}_emitOutgoingEvents(){for(;this._outgoingEvents.length>0;){if(this._collector||this._isConsumingViewEventQueue)return;let e=this._outgoingEvents.shift();e.isNoOp()||this._onEvent.fire(e)}}addViewEventHandler(e){for(let t=0,n=this._eventHandlers.length;t<n;t++)this._eventHandlers[t]===e&&console.warn("Detected duplicate listener in ViewEventDispatcher",e);this._eventHandlers.push(e)}removeViewEventHandler(e){for(let t=0;t<this._eventHandlers.length;t++)if(this._eventHandlers[t]===e){this._eventHandlers.splice(t,1);break}}beginEmitViewEvents(){return this._collectorCnt++,this._collectorCnt===1&&(this._collector=new $D),this._collector}endEmitViewEvents(){if(this._collectorCnt--,this._collectorCnt===0){let e=this._collector.outgoingEvents,t=this._collector.viewEvents;this._collector=null;for(let n of e)this._addOutgoingEvent(n);t.length>0&&this._emitMany(t)}this._emitOutgoingEvents()}emitSingleViewEvent(e){try{this.beginEmitViewEvents().emitViewEvent(e)}finally{this.endEmitViewEvents()}}_emitMany(e){this._viewEventQueue?this._viewEventQueue=this._viewEventQueue.concat(e):this._viewEventQueue=e,this._isConsumingViewEventQueue||this._consumeViewEventQueue()}_consumeViewEventQueue(){try{this._isConsumingViewEventQueue=!0,this._doConsumeQueue()}finally{this._isConsumingViewEventQueue=!1}}_doConsumeQueue(){for(;this._viewEventQueue;){let e=this._viewEventQueue;this._viewEventQueue=null;let t=this._eventHandlers.slice(0);for(let n of t)n.handleEvents(e)}}},$D=class{viewEvents;outgoingEvents;constructor(){this.viewEvents=[],this.outgoingEvents=[]}emitViewEvent(e){this.viewEvents.push(e)}emitOutgoingEvent(e){this.outgoingEvents.push(e)}};var oS=class o{kind=0;_oldContentWidth;_oldContentHeight;contentWidth;contentHeight;contentWidthChanged;contentHeightChanged;constructor(e,t,n,i){this._oldContentWidth=e,this._oldContentHeight=t,this.contentWidth=n,this.contentHeight=i,this.contentWidthChanged=this._oldContentWidth!==this.contentWidth,this.contentHeightChanged=this._oldContentHeight!==this.contentHeight}isNoOp(){return!this.contentWidthChanged&&!this.contentHeightChanged}attemptToMerge(e){return e.kind!==this.kind?null:new o(this._oldContentWidth,this._oldContentHeight,e.contentWidth,e.contentHeight)}},rS=class o{kind=1;oldHasFocus;hasFocus;constructor(e,t){this.oldHasFocus=e,this.hasFocus=t}isNoOp(){return this.oldHasFocus===this.hasFocus}attemptToMerge(e){return e.kind!==this.kind?null:new o(this.oldHasFocus,e.hasFocus)}},sS=class o{kind=2;_oldScrollWidth;_oldScrollLeft;_oldScrollHeight;_oldScrollTop;scrollWidth;scrollLeft;scrollHeight;scrollTop;scrollWidthChanged;scrollLeftChanged;scrollHeightChanged;scrollTopChanged;constructor(e,t,n,i,r,s,a,l){this._oldScrollWidth=e,this._oldScrollLeft=t,this._oldScrollHeight=n,this._oldScrollTop=i,this.scrollWidth=r,this.scrollLeft=s,this.scrollHeight=a,this.scrollTop=l,this.scrollWidthChanged=this._oldScrollWidth!==this.scrollWidth,this.scrollLeftChanged=this._oldScrollLeft!==this.scrollLeft,this.scrollHeightChanged=this._oldScrollHeight!==this.scrollHeight,this.scrollTopChanged=this._oldScrollTop!==this.scrollTop}isNoOp(){return!this.scrollWidthChanged&&!this.scrollLeftChanged&&!this.scrollHeightChanged&&!this.scrollTopChanged}attemptToMerge(e){return e.kind!==this.kind?null:new o(this._oldScrollWidth,this._oldScrollLeft,this._oldScrollHeight,this._oldScrollTop,e.scrollWidth,e.scrollLeft,e.scrollHeight,e.scrollTop)}},aS=class{kind=3;constructor(){}isNoOp(){return!1}attemptToMerge(e){return e.kind!==this.kind?null:this}},lS=class{kind=4;constructor(){}isNoOp(){return!1}attemptToMerge(e){return e.kind!==this.kind?null:this}},dS=class o{kind=6;oldSelections;selections;oldModelVersionId;modelVersionId;source;reason;reachedMaxCursorCount;constructor(e,t,n,i,r,s,a){this.oldSelections=e,this.selections=t,this.oldModelVersionId=n,this.modelVersionId=i,this.source=r,this.reason=s,this.reachedMaxCursorCount=a}static _selectionsAreEqual(e,t){if(!e&&!t)return!0;if(!e||!t)return!1;let n=e.length,i=t.length;if(n!==i)return!1;for(let r=0;r<n;r++)if(!e[r].equalsSelection(t[r]))return!1;return!0}isNoOp(){return o._selectionsAreEqual(this.oldSelections,this.selections)&&this.oldModelVersionId===this.modelVersionId}attemptToMerge(e){return e.kind!==this.kind?null:new o(this.oldSelections,e.selections,this.oldModelVersionId,e.modelVersionId,e.source,e.reason,this.reachedMaxCursorCount||e.reachedMaxCursorCount)}},cS=class{kind=5;constructor(){}isNoOp(){return!1}attemptToMerge(e){return e.kind!==this.kind?null:this}},uS=class{constructor(e){this.event=e}kind=7;isNoOp(){return!1}attemptToMerge(e){return null}},hS=class{constructor(e){this.event=e}kind=8;isNoOp(){return!1}attemptToMerge(e){return null}},pS=class{constructor(e){this.event=e}kind=9;isNoOp(){return!1}attemptToMerge(e){return null}},mS=class{constructor(e){this.event=e}kind=10;isNoOp(){return!1}attemptToMerge(e){return null}},gS=class{constructor(e){this.event=e}kind=11;isNoOp(){return!1}attemptToMerge(e){return null}},fS=class{constructor(e){this.event=e}kind=12;isNoOp(){return!1}attemptToMerge(e){return null}};var bS=class extends V{_model;_knownModelVersionId;_viewModel;_coordinatesConverter;context;_cursors;_hasFocus;_isHandling;_compositionState;_columnSelectData;_autoClosedActions;_prevEditOperationType;constructor(e,t,n,i){super(),this._model=e,this._knownModelVersionId=this._model.getVersionId(),this._viewModel=t,this._coordinatesConverter=n,this.context=new Ug(this._model,this._viewModel,this._coordinatesConverter,i),this._cursors=new Kg(this.context),this._hasFocus=!1,this._isHandling=!1,this._compositionState=null,this._columnSelectData=null,this._autoClosedActions=[],this._prevEditOperationType=0}dispose(){this._cursors.dispose(),this._autoClosedActions=kt(this._autoClosedActions),super.dispose()}updateConfiguration(e){this.context=new Ug(this._model,this._viewModel,this._coordinatesConverter,e),this._cursors.updateContext(this.context)}onLineMappingChanged(e){this._knownModelVersionId===this._model.getVersionId()&&this.setStates(e,"viewModel",0,this.getCursorStates())}setHasFocus(e){this._hasFocus=e}_validateAutoClosedActions(){if(this._autoClosedActions.length>0){let e=this._cursors.getSelections();for(let t=0;t<this._autoClosedActions.length;t++){let n=this._autoClosedActions[t];n.isValid(e)||(n.dispose(),this._autoClosedActions.splice(t,1),t--)}}}getPrimaryCursorState(){return this._cursors.getPrimaryCursor()}getLastAddedCursorIndex(){return this._cursors.getLastAddedCursorIndex()}getCursorStates(){return this._cursors.getAll()}setStates(e,t,n,i){let r=!1,s=this.context.cursorConfig.multiCursorLimit;i!==null&&i.length>s&&(i=i.slice(0,s),r=!0);let a=Gg.from(this._model,this);return this._cursors.setStates(i),this._cursors.normalize(),this._columnSelectData=null,this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(e,t,n,a,r)}setCursorColumnSelectData(e){this._columnSelectData=e}revealAll(e,t,n,i,r,s){let a=this._cursors.getViewPositions(),l=null,d=null;a.length>1?d=this._cursors.getViewSelections():l=D.fromPositions(a[0],a[0]),e.emitViewEvent(new ma(t,n,l,d,i,r,s))}revealPrimary(e,t,n,i,r,s){let l=[this._cursors.getPrimaryCursor().viewState.selection];e.emitViewEvent(new ma(t,n,null,l,i,r,s))}saveState(){let e=[],t=this._cursors.getSelections();for(let n=0,i=t.length;n<i;n++){let r=t[n];e.push({inSelectionMode:!r.isEmpty(),selectionStart:{lineNumber:r.selectionStartLineNumber,column:r.selectionStartColumn},position:{lineNumber:r.positionLineNumber,column:r.positionColumn}})}return e}restoreState(e,t){let n=[];for(let i=0,r=t.length;i<r;i++){let s=t[i],a=1,l=1;s.position&&s.position.lineNumber&&(a=s.position.lineNumber),s.position&&s.position.column&&(l=s.position.column);let d=a,c=l;s.selectionStart&&s.selectionStart.lineNumber&&(d=s.selectionStart.lineNumber),s.selectionStart&&s.selectionStart.column&&(c=s.selectionStart.column),n.push({selectionStartLineNumber:d,selectionStartColumn:c,positionLineNumber:a,positionColumn:l})}this.setStates(e,"restoreState",0,Ue.fromModelSelections(n)),this.revealAll(e,"restoreState",!1,0,!0,1)}onModelContentChanged(e,t){if(t instanceof Eu){if(this._isHandling)return;this._isHandling=!0;try{this.setStates(e,"modelChange",0,this.getCursorStates())}finally{this._isHandling=!1}}else{let n=t.rawContentChangedEvent;if(this._knownModelVersionId=n.versionId,this._isHandling)return;let i=n.containsEvent(1);if(this._prevEditOperationType=0,i)this._cursors.dispose(),this._cursors=new Kg(this.context),this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(e,"model",1,null,!1);else if(this._hasFocus&&n.resultingSelection&&n.resultingSelection.length>0){let r=Ue.fromModelSelections(n.resultingSelection);this.setStates(e,"modelChange",n.isUndoing?5:n.isRedoing?6:2,r)&&this.revealAll(e,"modelChange",!1,0,!0,0)}else{let r=this._cursors.readSelectionFromMarkers();this.setStates(e,"modelChange",2,Ue.fromModelSelections(r))}}}getSelection(){return this._cursors.getPrimaryCursor().modelState.selection}getTopMostViewPosition(){return this._cursors.getTopMostViewPosition()}getBottomMostViewPosition(){return this._cursors.getBottomMostViewPosition()}getCursorColumnSelectData(){if(this._columnSelectData)return this._columnSelectData;let e=this._cursors.getPrimaryCursor(),t=e.viewState.selectionStart.getStartPosition(),n=e.viewState.position;return{isReal:!1,fromViewLineNumber:t.lineNumber,fromViewVisualColumn:this.context.cursorConfig.visibleColumnFromColumn(this._viewModel,t),toViewLineNumber:n.lineNumber,toViewVisualColumn:this.context.cursorConfig.visibleColumnFromColumn(this._viewModel,n)}}getSelections(){return this._cursors.getSelections()}getPosition(){return this._cursors.getPrimaryCursor().modelState.position}setSelections(e,t,n,i){this.setStates(e,t,i,Ue.fromModelSelections(n))}getPrevEditOperationType(){return this._prevEditOperationType}setPrevEditOperationType(e){this._prevEditOperationType=e}_pushAutoClosedAction(e,t){let n=[],i=[];for(let a=0,l=e.length;a<l;a++)n.push({range:e[a],options:{description:"auto-closed-character",inlineClassName:"auto-closed-character",stickiness:1}}),i.push({range:t[a],options:{description:"auto-closed-enclosing",stickiness:1}});let r=this._model.deltaDecorations([],n),s=this._model.deltaDecorations([],i);this._autoClosedActions.push(new vS(this._model,r,s))}_executeEditOperation(e){if(!e)return;e.shouldPushStackElementBefore&&this._model.pushStackElement();let t=qD.executeCommands(this._model,this._cursors.getSelections(),e.commands);if(t){this._interpretCommandResult(t);let n=[],i=[];for(let r=0;r<e.commands.length;r++){let s=e.commands[r];s instanceof Rh&&s.enclosingRange&&s.closeCharacterRange&&(n.push(s.closeCharacterRange),i.push(s.enclosingRange))}n.length>0&&this._pushAutoClosedAction(n,i),this._prevEditOperationType=e.type}e.shouldPushStackElementAfter&&this._model.pushStackElement()}_interpretCommandResult(e){(!e||e.length===0)&&(e=this._cursors.readSelectionFromMarkers()),this._columnSelectData=null,this._cursors.setSelections(e),this._cursors.normalize()}_emitStateChangedIfNecessary(e,t,n,i,r){let s=Gg.from(this._model,this);if(s.equals(i))return!1;let a=this._cursors.getSelections(),l=this._cursors.getViewSelections();if(e.emitViewEvent(new cy(l,a,n)),!i||i.cursorState.length!==s.cursorState.length||s.cursorState.some((d,c)=>!d.modelState.equals(i.cursorState[c].modelState))){let d=i?i.cursorState.map(u=>u.modelState.selection):null,c=i?i.modelVersionId:0;e.emitOutgoingEvent(new dS(d,a,c,s.modelVersionId,t||"keyboard",n,r))}return!0}_findAutoClosingPairs(e){if(!e.length)return null;let t=[];for(let n=0,i=e.length;n<i;n++){let r=e[n];if(!r.text||r.text.indexOf(`
`)>=0)return null;let s=r.text.match(/([)\]}>'"`])([^)\]}>'"`]*)$/);if(!s)return null;let a=s[1],l=this.context.cursorConfig.autoClosingPairs.autoClosingPairsCloseSingleChar.get(a);if(!l||l.length!==1)return null;let d=l[0].open,c=r.text.length-s[2].length-1,u=r.text.lastIndexOf(d,c-1);if(u===-1)return null;t.push([u,c])}return t}executeEdits(e,t,n,i){let r=null;t==="snippet"&&(r=this._findAutoClosingPairs(n)),r&&(n[0]._isTracked=!0);let s=[],a=[],l=this._model.pushEditOperations(this.getSelections(),n,d=>{if(r)for(let u=0,h=r.length;u<h;u++){let[m,f]=r[u],g=d[u],b=g.range.startLineNumber,y=g.range.startColumn-1+m,C=g.range.startColumn-1+f;s.push(new D(b,C+1,b,C+2)),a.push(new D(b,y+1,b,C+2))}let c=i(d);return c&&(this._isHandling=!0),c});l&&(this._isHandling=!1,this.setSelections(e,t,l,0)),s.length>0&&this._pushAutoClosedAction(s,a)}_executeEdit(e,t,n,i=0){if(this.context.cursorConfig.readOnly)return;let r=Gg.from(this._model,this);this._cursors.stopTrackingSelections(),this._isHandling=!0;try{this._cursors.ensureValidState(),e()}catch(s){je(s)}this._isHandling=!1,this._cursors.startTrackingSelections(),this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(t,n,i,r,!1)&&this.revealAll(t,n,!1,0,!0,0)}getAutoClosedCharacters(){return vS.getAllAutoClosedCharacters(this._autoClosedActions)}startComposition(e){this._compositionState=new ZD(this._model,this.getSelections())}endComposition(e,t){let n=this._compositionState?this._compositionState.deduceOutcome(this._model,this.getSelections()):null;this._compositionState=null,this._executeEdit(()=>{t==="keyboard"&&this._executeEditOperation($r.compositionEndWithInterceptors(this._prevEditOperationType,this.context.cursorConfig,this._model,n,this.getSelections(),this.getAutoClosedCharacters()))},e,t)}type(e,t,n){this._executeEdit(()=>{if(n==="keyboard"){let i=t.length,r=0;for(;r<i;){let s=Up(t,r),a=t.substr(r,s);this._executeEditOperation($r.typeWithInterceptors(!!this._compositionState,this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),this.getAutoClosedCharacters(),a)),r+=s}}else this._executeEditOperation($r.typeWithoutInterceptors(this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),t))},e,n)}compositionType(e,t,n,i,r,s){if(t.length===0&&n===0&&i===0){if(r!==0){let a=this.getSelections().map(l=>{let d=l.getPosition();return new He(d.lineNumber,d.column+r,d.lineNumber,d.column+r)});this.setSelections(e,s,a,0)}return}this._executeEdit(()=>{this._executeEditOperation($r.compositionType(this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),t,n,i,r))},e,s)}paste(e,t,n,i,r){this._executeEdit(()=>{this._executeEditOperation($r.paste(this.context.cursorConfig,this._model,this.getSelections(),t,n,i||[]))},e,r,4)}cut(e,t){this._executeEdit(()=>{this._executeEditOperation(Ta.cut(this.context.cursorConfig,this._model,this.getSelections()))},e,t)}executeCommand(e,t,n){this._executeEdit(()=>{this._cursors.killSecondaryCursors(),this._executeEditOperation(new Sn(0,[t],{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!1}))},e,n)}executeCommands(e,t,n){this._executeEdit(()=>{this._executeEditOperation(new Sn(0,t,{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!1}))},e,n)}},Gg=class o{constructor(e,t){this.modelVersionId=e;this.cursorState=t}static from(e,t){return new o(e.getVersionId(),t.getCursorStates())}equals(e){if(!e||this.modelVersionId!==e.modelVersionId||this.cursorState.length!==e.cursorState.length)return!1;for(let t=0,n=this.cursorState.length;t<n;t++)if(!this.cursorState[t].equals(e.cursorState[t]))return!1;return!0}},vS=class{static getAllAutoClosedCharacters(e){let t=[];for(let n of e)t=t.concat(n.getAutoClosedCharactersRanges());return t}_model;_autoClosedCharactersDecorations;_autoClosedEnclosingDecorations;constructor(e,t,n){this._model=e,this._autoClosedCharactersDecorations=t,this._autoClosedEnclosingDecorations=n}dispose(){this._autoClosedCharactersDecorations=this._model.deltaDecorations(this._autoClosedCharactersDecorations,[]),this._autoClosedEnclosingDecorations=this._model.deltaDecorations(this._autoClosedEnclosingDecorations,[])}getAutoClosedCharactersRanges(){let e=[];for(let t=0;t<this._autoClosedCharactersDecorations.length;t++){let n=this._model.getDecorationRange(this._autoClosedCharactersDecorations[t]);n&&e.push(n)}return e}isValid(e){let t=[];for(let n=0;n<this._autoClosedEnclosingDecorations.length;n++){let i=this._model.getDecorationRange(this._autoClosedEnclosingDecorations[n]);if(i&&(t.push(i),i.startLineNumber!==i.endLineNumber))return!1}t.sort(D.compareRangesUsingStarts),e.sort(D.compareRangesUsingStarts);for(let n=0;n<e.length;n++)if(n>=t.length||!t[n].strictContainsRange(e[n]))return!1;return!0}},qD=class{static executeCommands(e,t,n){let i={model:e,selectionsBefore:t,trackedRanges:[],trackedRangesDirection:[]},r=this._innerExecuteCommands(i,n);for(let s=0,a=i.trackedRanges.length;s<a;s++)i.model._setTrackedRange(i.trackedRanges[s],null,0);return r}static _innerExecuteCommands(e,t){if(this._arrayIsEmpty(t))return null;let n=this._getEditOperations(e,t);if(n.operations.length===0)return null;let i=n.operations,r=this._getLoserCursorMap(i);if(r.hasOwnProperty("0"))return console.warn("Ignoring commands"),null;let s=[];for(let d=0,c=i.length;d<c;d++)r.hasOwnProperty(i[d].identifier.major.toString())||s.push(i[d]);n.hadTrackedEditOperation&&s.length>0&&(s[0]._isTracked=!0);let a=e.model.pushEditOperations(e.selectionsBefore,s,d=>{let c=[];for(let m=0;m<e.selectionsBefore.length;m++)c[m]=[];for(let m of d)m.identifier&&c[m.identifier.major].push(m);let u=(m,f)=>m.identifier.minor-f.identifier.minor,h=[];for(let m=0;m<e.selectionsBefore.length;m++)c[m].length>0?(c[m].sort(u),h[m]=t[m].computeCursorState(e.model,{getInverseEditOperations:()=>c[m],getTrackedSelection:f=>{let g=parseInt(f,10),b=e.model._getTrackedRange(e.trackedRanges[g]);return e.trackedRangesDirection[g]===0?new He(b.startLineNumber,b.startColumn,b.endLineNumber,b.endColumn):new He(b.endLineNumber,b.endColumn,b.startLineNumber,b.startColumn)}})):h[m]=e.selectionsBefore[m];return h});a||(a=e.selectionsBefore);let l=[];for(let d in r)r.hasOwnProperty(d)&&l.push(parseInt(d,10));l.sort((d,c)=>c-d);for(let d of l)a.splice(d,1);return a}static _arrayIsEmpty(e){for(let t=0,n=e.length;t<n;t++)if(e[t])return!1;return!0}static _getEditOperations(e,t){let n=[],i=!1;for(let r=0,s=t.length;r<s;r++){let a=t[r];if(a){let l=this._getEditOperationsFromCommand(e,r,a);n=n.concat(l.operations),i=i||l.hadTrackedEditOperation}}return{operations:n,hadTrackedEditOperation:i}}static _getEditOperationsFromCommand(e,t,n){let i=[],r=0,s=(u,h,m=!1)=>{D.isEmpty(u)&&h===""||i.push({identifier:{major:t,minor:r++},range:u,text:h,forceMoveMarkers:m,isAutoWhitespaceEdit:n.insertsAutoWhitespace})},a=!1,c={addEditOperation:s,addTrackedEditOperation:(u,h,m)=>{a=!0,s(u,h,m)},trackSelection:(u,h)=>{let m=He.liftSelection(u),f;if(m.isEmpty())if(typeof h=="boolean")h?f=2:f=3;else{let y=e.model.getLineMaxColumn(m.startLineNumber);m.startColumn===y?f=2:f=3}else f=1;let g=e.trackedRanges.length,b=e.model._setTrackedRange(null,m,f);return e.trackedRanges[g]=b,e.trackedRangesDirection[g]=m.getDirection(),g.toString()}};try{n.getEditOperations(e.model,c)}catch(u){return je(u),{operations:[],hadTrackedEditOperation:!1}}return{operations:i,hadTrackedEditOperation:a}}static _getLoserCursorMap(e){e=e.slice(0),e.sort((n,i)=>-D.compareRangesUsingEnds(n.range,i.range));let t={};for(let n=1;n<e.length;n++){let i=e[n-1],r=e[n];if(D.getStartPosition(i.range).isBefore(D.getEndPosition(r.range))){let s;i.identifier.major>r.identifier.major?s=i.identifier.major:s=r.identifier.major,t[s.toString()]=!0;for(let a=0;a<e.length;a++)e[a].identifier.major===s&&(e.splice(a,1),a<n&&n--,a--);n>0&&n--}}return t}},YD=class{constructor(e,t,n){this.text=e;this.startSelection=t;this.endSelection=n}},ZD=class o{_original;static _capture(e,t){let n=[];for(let i of t){if(i.startLineNumber!==i.endLineNumber)return null;n.push(new YD(e.getLineContent(i.startLineNumber),i.startColumn-1,i.endColumn-1))}return n}constructor(e,t){this._original=o._capture(e,t)}deduceOutcome(e,t){if(!this._original)return null;let n=o._capture(e,t);if(!n||this._original.length!==n.length)return null;let i=[];for(let r=0,s=this._original.length;r<s;r++)i.push(o._deduceOutcome(this._original[r],n[r]));return i}static _deduceOutcome(e,t){let n=Math.min(e.startSelection,t.startSelection,Wp(e.text,t.text)),i=Math.min(e.text.length-e.endSelection,t.text.length-t.endSelection,Hp(e.text,t.text)),r=e.text.substring(n,e.text.length-i),s=t.text.substring(n,t.text.length-i);return new sC(r,e.startSelection-n,e.endSelection-n,s,t.startSelection-n,t.endSelection-n)}};function ZP(o,e,t,n,i,r,s){let a="<div>",l=n,d=0,c=!0;for(let u=0,h=e.getCount();u<h;u++){let m=e.getEndOffset(u);if(m<=n)continue;let f="";for(;l<m&&l<i;l++){let g=o.charCodeAt(l);switch(g){case 9:{let b=r-(l+d)%r;for(d+=b-1;b>0;)s&&c?(f+="&#160;",c=!1):(f+=" ",c=!0),b--;break}case 60:f+="&lt;",c=!1;break;case 62:f+="&gt;",c=!1;break;case 38:f+="&amp;",c=!1;break;case 0:f+="&#00;",c=!1;break;case 65279:case 8232:case 8233:case 133:f+="\uFFFD",c=!1;break;case 13:f+="&#8203",c=!1;break;case 32:s&&c?(f+="&#160;",c=!1):(f+=" ",c=!0);break;default:f+=String.fromCharCode(g),c=!1}}if(a+=`<span style="${e.getInlineStyle(u,t)}">${f}</span>`,m>i||l>=i)break}return a+="</div>",a}var XD=class{_hasPending;_inserts;_changes;_removes;constructor(){this._hasPending=!1,this._inserts=[],this._changes=[],this._removes=[]}insert(e){this._hasPending=!0,this._inserts.push(e)}change(e){this._hasPending=!0,this._changes.push(e)}remove(e){this._hasPending=!0,this._removes.push(e)}mustCommit(){return this._hasPending}commit(e){if(!this._hasPending)return;let t=this._inserts,n=this._changes,i=this._removes;this._hasPending=!1,this._inserts=[],this._changes=[],this._removes=[],e._commitPendingChanges(t,n,i)}},QD=class{id;afterLineNumber;ordinal;height;minWidth;prefixSum;constructor(e,t,n,i,r){this.id=e,this.afterLineNumber=t,this.ordinal=n,this.height=i,this.minWidth=r,this.prefixSum=0}},yS=class o{static INSTANCE_COUNT=0;_instanceId;_pendingChanges;_lastWhitespaceId;_arr;_prefixSumValidIndex;_minWidth;_lineCount;_lineHeight;_paddingTop;_paddingBottom;constructor(e,t,n,i){this._instanceId=ab(++o.INSTANCE_COUNT),this._pendingChanges=new XD,this._lastWhitespaceId=0,this._arr=[],this._prefixSumValidIndex=-1,this._minWidth=-1,this._lineCount=e,this._lineHeight=t,this._paddingTop=n,this._paddingBottom=i}static findInsertionIndex(e,t,n){let i=0,r=e.length;for(;i<r;){let s=i+r>>>1;t===e[s].afterLineNumber?n<e[s].ordinal?r=s:i=s+1:t<e[s].afterLineNumber?r=s:i=s+1}return i}setLineHeight(e){this._checkPendingChanges(),this._lineHeight=e}setPadding(e,t){this._paddingTop=e,this._paddingBottom=t}onFlushed(e){this._checkPendingChanges(),this._lineCount=e}changeWhitespace(e){let t=!1;try{e({insertWhitespace:(i,r,s,a)=>{t=!0,i=i|0,r=r|0,s=s|0,a=a|0;let l=this._instanceId+ ++this._lastWhitespaceId;return this._pendingChanges.insert(new QD(l,i,r,s,a)),l},changeOneWhitespace:(i,r,s)=>{t=!0,r=r|0,s=s|0,this._pendingChanges.change({id:i,newAfterLineNumber:r,newHeight:s})},removeWhitespace:i=>{t=!0,this._pendingChanges.remove({id:i})}})}finally{this._pendingChanges.commit(this)}return t}_commitPendingChanges(e,t,n){if((e.length>0||n.length>0)&&(this._minWidth=-1),e.length+t.length+n.length<=1){for(let l of e)this._insertWhitespace(l);for(let l of t)this._changeOneWhitespace(l.id,l.newAfterLineNumber,l.newHeight);for(let l of n){let d=this._findWhitespaceIndex(l.id);d!==-1&&this._removeWhitespace(d)}return}let i=new Set;for(let l of n)i.add(l.id);let r=new Map;for(let l of t)r.set(l.id,l);let s=l=>{let d=[];for(let c of l)if(!i.has(c.id)){if(r.has(c.id)){let u=r.get(c.id);c.afterLineNumber=u.newAfterLineNumber,c.height=u.newHeight}d.push(c)}return d},a=s(this._arr).concat(s(e));a.sort((l,d)=>l.afterLineNumber===d.afterLineNumber?l.ordinal-d.ordinal:l.afterLineNumber-d.afterLineNumber),this._arr=a,this._prefixSumValidIndex=-1}_checkPendingChanges(){this._pendingChanges.mustCommit()&&this._pendingChanges.commit(this)}_insertWhitespace(e){let t=o.findInsertionIndex(this._arr,e.afterLineNumber,e.ordinal);this._arr.splice(t,0,e),this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,t-1)}_findWhitespaceIndex(e){let t=this._arr;for(let n=0,i=t.length;n<i;n++)if(t[n].id===e)return n;return-1}_changeOneWhitespace(e,t,n){let i=this._findWhitespaceIndex(e);if(i!==-1&&(this._arr[i].height!==n&&(this._arr[i].height=n,this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,i-1)),this._arr[i].afterLineNumber!==t)){let r=this._arr[i];this._removeWhitespace(i),r.afterLineNumber=t,this._insertWhitespace(r)}}_removeWhitespace(e){this._arr.splice(e,1),this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,e-1)}onLinesDeleted(e,t){this._checkPendingChanges(),e=e|0,t=t|0,this._lineCount-=t-e+1;for(let n=0,i=this._arr.length;n<i;n++){let r=this._arr[n].afterLineNumber;e<=r&&r<=t?this._arr[n].afterLineNumber=e-1:r>t&&(this._arr[n].afterLineNumber-=t-e+1)}}onLinesInserted(e,t){this._checkPendingChanges(),e=e|0,t=t|0,this._lineCount+=t-e+1;for(let n=0,i=this._arr.length;n<i;n++){let r=this._arr[n].afterLineNumber;e<=r&&(this._arr[n].afterLineNumber+=t-e+1)}}getWhitespacesTotalHeight(){return this._checkPendingChanges(),this._arr.length===0?0:this.getWhitespacesAccumulatedHeight(this._arr.length-1)}getWhitespacesAccumulatedHeight(e){this._checkPendingChanges(),e=e|0;let t=Math.max(0,this._prefixSumValidIndex+1);t===0&&(this._arr[0].prefixSum=this._arr[0].height,t++);for(let n=t;n<=e;n++)this._arr[n].prefixSum=this._arr[n-1].prefixSum+this._arr[n].height;return this._prefixSumValidIndex=Math.max(this._prefixSumValidIndex,e),this._arr[e].prefixSum}getLinesTotalHeight(){this._checkPendingChanges();let e=this._lineHeight*this._lineCount,t=this.getWhitespacesTotalHeight();return e+t+this._paddingTop+this._paddingBottom}getWhitespaceAccumulatedHeightBeforeLineNumber(e){this._checkPendingChanges(),e=e|0;let t=this._findLastWhitespaceBeforeLineNumber(e);return t===-1?0:this.getWhitespacesAccumulatedHeight(t)}_findLastWhitespaceBeforeLineNumber(e){e=e|0;let t=this._arr,n=0,i=t.length-1;for(;n<=i;){let s=(i-n|0)/2|0,a=n+s|0;if(t[a].afterLineNumber<e){if(a+1>=t.length||t[a+1].afterLineNumber>=e)return a;n=a+1|0}else i=a-1|0}return-1}_findFirstWhitespaceAfterLineNumber(e){e=e|0;let n=this._findLastWhitespaceBeforeLineNumber(e)+1;return n<this._arr.length?n:-1}getFirstWhitespaceIndexAfterLineNumber(e){return this._checkPendingChanges(),e=e|0,this._findFirstWhitespaceAfterLineNumber(e)}getVerticalOffsetForLineNumber(e,t=!1){this._checkPendingChanges(),e=e|0;let n;e>1?n=this._lineHeight*(e-1):n=0;let i=this.getWhitespaceAccumulatedHeightBeforeLineNumber(e-(t?1:0));return n+i+this._paddingTop}getVerticalOffsetAfterLineNumber(e,t=!1){this._checkPendingChanges(),e=e|0;let n=this._lineHeight*e,i=this.getWhitespaceAccumulatedHeightBeforeLineNumber(e+(t?1:0));return n+i+this._paddingTop}hasWhitespace(){return this._checkPendingChanges(),this.getWhitespacesCount()>0}getWhitespaceMinWidth(){if(this._checkPendingChanges(),this._minWidth===-1){let e=0;for(let t=0,n=this._arr.length;t<n;t++)e=Math.max(e,this._arr[t].minWidth);this._minWidth=e}return this._minWidth}isAfterLines(e){this._checkPendingChanges();let t=this.getLinesTotalHeight();return e>t}isInTopPadding(e){return this._paddingTop===0?!1:(this._checkPendingChanges(),e<this._paddingTop)}isInBottomPadding(e){if(this._paddingBottom===0)return!1;this._checkPendingChanges();let t=this.getLinesTotalHeight();return e>=t-this._paddingBottom}getLineNumberAtOrAfterVerticalOffset(e){if(this._checkPendingChanges(),e=e|0,e<0)return 1;let t=this._lineCount|0,n=this._lineHeight,i=1,r=t;for(;i<r;){let s=(i+r)/2|0,a=this.getVerticalOffsetForLineNumber(s)|0;if(e>=a+n)i=s+1;else{if(e>=a)return s;r=s}}return i>t?t:i}getLinesViewportData(e,t){this._checkPendingChanges(),e=e|0,t=t|0;let n=this._lineHeight,i=this.getLineNumberAtOrAfterVerticalOffset(e)|0,r=this.getVerticalOffsetForLineNumber(i)|0,s=this._lineCount|0,a=this.getFirstWhitespaceIndexAfterLineNumber(i)|0,l=this.getWhitespacesCount()|0,d,c;a===-1?(a=l,c=s+1,d=0):(c=this.getAfterLineNumberForWhitespaceIndex(a)|0,d=this.getHeightForWhitespaceIndex(a)|0);let u=r,h=u,m=5e5,f=0;r>=m&&(f=Math.floor(r/m)*m,f=Math.floor(f/n)*n,h-=f);let g=[],b=e+(t-e)/2,y=-1;for(let k=i;k<=s;k++){if(y===-1){let O=u,W=u+n;(O<=b&&b<W||O>b)&&(y=k)}for(u+=n,g[k-i]=h,h+=n;c===k;)h+=d,u+=d,a++,a>=l?c=s+1:(c=this.getAfterLineNumberForWhitespaceIndex(a)|0,d=this.getHeightForWhitespaceIndex(a)|0);if(u>=t){s=k;break}}y===-1&&(y=s);let C=this.getVerticalOffsetForLineNumber(s)|0,x=i,L=s;return x<L&&r<e&&x++,x<L&&C+n>t&&L--,{bigNumbersDelta:f,startLineNumber:i,endLineNumber:s,relativeVerticalOffset:g,centeredLineNumber:y,completelyVisibleStartLineNumber:x,completelyVisibleEndLineNumber:L,lineHeight:this._lineHeight}}getVerticalOffsetForWhitespaceIndex(e){this._checkPendingChanges(),e=e|0;let t=this.getAfterLineNumberForWhitespaceIndex(e),n;t>=1?n=this._lineHeight*t:n=0;let i;return e>0?i=this.getWhitespacesAccumulatedHeight(e-1):i=0,n+i+this._paddingTop}getWhitespaceIndexAtOrAfterVerticallOffset(e){this._checkPendingChanges(),e=e|0;let t=0,n=this.getWhitespacesCount()-1;if(n<0)return-1;let i=this.getVerticalOffsetForWhitespaceIndex(n),r=this.getHeightForWhitespaceIndex(n);if(e>=i+r)return-1;for(;t<n;){let s=Math.floor((t+n)/2),a=this.getVerticalOffsetForWhitespaceIndex(s),l=this.getHeightForWhitespaceIndex(s);if(e>=a+l)t=s+1;else{if(e>=a)return s;n=s}}return t}getWhitespaceAtVerticalOffset(e){this._checkPendingChanges(),e=e|0;let t=this.getWhitespaceIndexAtOrAfterVerticallOffset(e);if(t<0||t>=this.getWhitespacesCount())return null;let n=this.getVerticalOffsetForWhitespaceIndex(t);if(n>e)return null;let i=this.getHeightForWhitespaceIndex(t),r=this.getIdForWhitespaceIndex(t),s=this.getAfterLineNumberForWhitespaceIndex(t);return{id:r,afterLineNumber:s,verticalOffset:n,height:i}}getWhitespaceViewportData(e,t){this._checkPendingChanges(),e=e|0,t=t|0;let n=this.getWhitespaceIndexAtOrAfterVerticallOffset(e),i=this.getWhitespacesCount()-1;if(n<0)return[];let r=[];for(let s=n;s<=i;s++){let a=this.getVerticalOffsetForWhitespaceIndex(s),l=this.getHeightForWhitespaceIndex(s);if(a>=t)break;r.push({id:this.getIdForWhitespaceIndex(s),afterLineNumber:this.getAfterLineNumberForWhitespaceIndex(s),verticalOffset:a,height:l})}return r}getWhitespaces(){return this._checkPendingChanges(),this._arr.slice(0)}getWhitespacesCount(){return this._checkPendingChanges(),this._arr.length}getIdForWhitespaceIndex(e){return this._checkPendingChanges(),e=e|0,this._arr[e].id}getAfterLineNumberForWhitespaceIndex(e){return this._checkPendingChanges(),e=e|0,this._arr[e].afterLineNumber}getHeightForWhitespaceIndex(e){return this._checkPendingChanges(),e=e|0,this._arr[e].height}};var eU=125,yc=class{width;contentWidth;scrollWidth;height;contentHeight;scrollHeight;constructor(e,t,n,i){e=e|0,t=t|0,n=n|0,i=i|0,e<0&&(e=0),t<0&&(t=0),n<0&&(n=0),i<0&&(i=0),this.width=e,this.contentWidth=t,this.scrollWidth=Math.max(e,t),this.height=n,this.contentHeight=i,this.scrollHeight=Math.max(n,i)}equals(e){return this.width===e.width&&this.contentWidth===e.contentWidth&&this.height===e.height&&this.contentHeight===e.contentHeight}},JD=class extends V{_scrollable;_dimensions;onDidScroll;_onDidContentSizeChange=this._register(new E);onDidContentSizeChange=this._onDidContentSizeChange.event;constructor(e,t){super(),this._dimensions=new yc(0,0,0,0),this._scrollable=this._register(new ms({forceIntegerValues:!0,smoothScrollDuration:e,scheduleAtNextAnimationFrame:t})),this.onDidScroll=this._scrollable.onScroll}getScrollable(){return this._scrollable}setSmoothScrollDuration(e){this._scrollable.setSmoothScrollDuration(e)}validateScrollPosition(e){return this._scrollable.validateScrollPosition(e)}getScrollDimensions(){return this._dimensions}setScrollDimensions(e){if(this._dimensions.equals(e))return;let t=this._dimensions;this._dimensions=e,this._scrollable.setScrollDimensions({width:e.width,scrollWidth:e.scrollWidth,height:e.height,scrollHeight:e.scrollHeight},!0);let n=t.contentWidth!==e.contentWidth,i=t.contentHeight!==e.contentHeight;(n||i)&&this._onDidContentSizeChange.fire(new oS(t.contentWidth,t.contentHeight,e.contentWidth,e.contentHeight))}getFutureScrollPosition(){return this._scrollable.getFutureScrollPosition()}getCurrentScrollPosition(){return this._scrollable.getCurrentScrollPosition()}setScrollPositionNow(e){this._scrollable.setScrollPositionNow(e)}setScrollPositionSmooth(e){this._scrollable.setScrollPositionSmooth(e)}hasPendingScrollAnimation(){return this._scrollable.hasPendingScrollAnimation()}},IS=class extends V{_configuration;_linesLayout;_maxLineWidth;_overlayWidgetsMinWidth;_scrollable;onDidScroll;onDidContentSizeChange;constructor(e,t,n){super(),this._configuration=e;let i=this._configuration.options,r=i.get(147),s=i.get(85);this._linesLayout=new yS(t,i.get(68),s.top,s.bottom),this._maxLineWidth=0,this._overlayWidgetsMinWidth=0,this._scrollable=this._register(new JD(0,n)),this._configureSmoothScrollDuration(),this._scrollable.setScrollDimensions(new yc(r.contentWidth,0,r.height,0)),this.onDidScroll=this._scrollable.onDidScroll,this.onDidContentSizeChange=this._scrollable.onDidContentSizeChange,this._updateHeight()}dispose(){super.dispose()}getScrollable(){return this._scrollable.getScrollable()}onHeightMaybeChanged(){this._updateHeight()}_configureSmoothScrollDuration(){this._scrollable.setSmoothScrollDuration(this._configuration.options.get(116)?eU:0)}onConfigurationChanged(e){let t=this._configuration.options;if(e.hasChanged(68)&&this._linesLayout.setLineHeight(t.get(68)),e.hasChanged(85)){let n=t.get(85);this._linesLayout.setPadding(n.top,n.bottom)}if(e.hasChanged(147)){let n=t.get(147),i=n.contentWidth,r=n.height,s=this._scrollable.getScrollDimensions(),a=s.contentWidth;this._scrollable.setScrollDimensions(new yc(i,s.contentWidth,r,this._getContentHeight(i,r,a)))}else this._updateHeight();e.hasChanged(116)&&this._configureSmoothScrollDuration()}onFlushed(e){this._linesLayout.onFlushed(e)}onLinesDeleted(e,t){this._linesLayout.onLinesDeleted(e,t)}onLinesInserted(e,t){this._linesLayout.onLinesInserted(e,t)}_getHorizontalScrollbarHeight(e,t){let i=this._configuration.options.get(105);return i.horizontal===2||e>=t?0:i.horizontalScrollbarSize}_getContentHeight(e,t,n){let i=this._configuration.options,r=this._linesLayout.getLinesTotalHeight();return i.get(107)?r+=Math.max(0,t-i.get(68)-i.get(85).bottom):i.get(105).ignoreHorizontalScrollbarInContentHeight||(r+=this._getHorizontalScrollbarHeight(e,n)),r}_updateHeight(){let e=this._scrollable.getScrollDimensions(),t=e.width,n=e.height,i=e.contentWidth;this._scrollable.setScrollDimensions(new yc(t,e.contentWidth,n,this._getContentHeight(t,n,i)))}getCurrentViewport(){let e=this._scrollable.getScrollDimensions(),t=this._scrollable.getCurrentScrollPosition();return new $m(t.scrollTop,t.scrollLeft,e.width,e.height)}getFutureViewport(){let e=this._scrollable.getScrollDimensions(),t=this._scrollable.getFutureScrollPosition();return new $m(t.scrollTop,t.scrollLeft,e.width,e.height)}_computeContentWidth(){let e=this._configuration.options,t=this._maxLineWidth,n=e.get(148),i=e.get(51),r=e.get(147);if(n.isViewportWrapping){let s=e.get(74);return t>r.contentWidth+i.typicalHalfwidthCharacterWidth&&s.enabled&&s.side==="right"?t+r.verticalScrollbarWidth:t}else{let s=e.get(106)*i.typicalHalfwidthCharacterWidth,a=this._linesLayout.getWhitespaceMinWidth();return Math.max(t+s+r.verticalScrollbarWidth,a,this._overlayWidgetsMinWidth)}}setMaxLineWidth(e){this._maxLineWidth=e,this._updateContentWidth()}setOverlayWidgetsMinWidth(e){this._overlayWidgetsMinWidth=e,this._updateContentWidth()}_updateContentWidth(){let e=this._scrollable.getScrollDimensions();this._scrollable.setScrollDimensions(new yc(e.width,this._computeContentWidth(),e.height,e.contentHeight)),this._updateHeight()}saveState(){let e=this._scrollable.getFutureScrollPosition(),t=e.scrollTop,n=this._linesLayout.getLineNumberAtOrAfterVerticalOffset(t),i=this._linesLayout.getWhitespaceAccumulatedHeightBeforeLineNumber(n);return{scrollTop:t,scrollTopWithoutViewZones:t-i,scrollLeft:e.scrollLeft}}changeWhitespace(e){let t=this._linesLayout.changeWhitespace(e);return t&&this.onHeightMaybeChanged(),t}getVerticalOffsetForLineNumber(e,t=!1){return this._linesLayout.getVerticalOffsetForLineNumber(e,t)}getVerticalOffsetAfterLineNumber(e,t=!1){return this._linesLayout.getVerticalOffsetAfterLineNumber(e,t)}isAfterLines(e){return this._linesLayout.isAfterLines(e)}isInTopPadding(e){return this._linesLayout.isInTopPadding(e)}isInBottomPadding(e){return this._linesLayout.isInBottomPadding(e)}getLineNumberAtVerticalOffset(e){return this._linesLayout.getLineNumberAtOrAfterVerticalOffset(e)}getWhitespaceAtVerticalOffset(e){return this._linesLayout.getWhitespaceAtVerticalOffset(e)}getLinesViewportData(){let e=this.getCurrentViewport();return this._linesLayout.getLinesViewportData(e.top,e.top+e.height)}getLinesViewportDataAtScrollTop(e){let t=this._scrollable.getScrollDimensions();return e+t.height>t.scrollHeight&&(e=t.scrollHeight-t.height),e<0&&(e=0),this._linesLayout.getLinesViewportData(e,e+t.height)}getWhitespaceViewportData(){let e=this.getCurrentViewport();return this._linesLayout.getWhitespaceViewportData(e.top,e.top+e.height)}getWhitespaces(){return this._linesLayout.getWhitespaces()}getContentWidth(){return this._scrollable.getScrollDimensions().contentWidth}getScrollWidth(){return this._scrollable.getScrollDimensions().scrollWidth}getContentHeight(){return this._scrollable.getScrollDimensions().contentHeight}getScrollHeight(){return this._scrollable.getScrollDimensions().scrollHeight}getCurrentScrollLeft(){return this._scrollable.getCurrentScrollPosition().scrollLeft}getCurrentScrollTop(){return this._scrollable.getCurrentScrollPosition().scrollTop}validateScrollPosition(e){return this._scrollable.validateScrollPosition(e)}setScrollPosition(e,t){t===1?this._scrollable.setScrollPositionNow(e):this._scrollable.setScrollPositionSmooth(e)}hasPendingScrollAnimation(){return this._scrollable.hasPendingScrollAnimation()}deltaScrollNow(e,t){let n=this._scrollable.getCurrentScrollPosition();this._scrollable.setScrollPositionNow({scrollLeft:n.scrollLeft+e,scrollTop:n.scrollTop+t})}};function wS(o,e){return o===null?e?CS.INSTANCE:SS.INSTANCE:new t0(o,e)}var t0=class{_projectionData;_isVisible;constructor(e,t){this._projectionData=e,this._isVisible=t}isVisible(){return this._isVisible}setVisible(e){return this._isVisible=e,this}getProjectionData(){return this._projectionData}getViewLineCount(){return this._isVisible?this._projectionData.getOutputLineCount():0}getViewLineContent(e,t,n){this._assertVisible();let i=n>0?this._projectionData.breakOffsets[n-1]:0,r=this._projectionData.breakOffsets[n],s;if(this._projectionData.injectionOffsets!==null){let a=this._projectionData.injectionOffsets.map((d,c)=>new oo(0,0,d+1,this._projectionData.injectionOptions[c],0));s=oo.applyInjectedText(e.getLineContent(t),a).substring(i,r)}else s=e.getValueInRange({startLineNumber:t,startColumn:i+1,endLineNumber:t,endColumn:r+1});return n>0&&(s=XP(this._projectionData.wrappedTextIndentLength)+s),s}getViewLineLength(e,t,n){return this._assertVisible(),this._projectionData.getLineLength(n)}getViewLineMinColumn(e,t,n){return this._assertVisible(),this._projectionData.getMinOutputOffset(n)+1}getViewLineMaxColumn(e,t,n){return this._assertVisible(),this._projectionData.getMaxOutputOffset(n)+1}getViewLineData(e,t,n){let i=new Array;return this.getViewLinesData(e,t,n,1,0,[!0],i),i[0]}getViewLinesData(e,t,n,i,r,s,a){this._assertVisible();let l=this._projectionData,d=l.injectionOffsets,c=l.injectionOptions,u=null;if(d){u=[];let m=0,f=0;for(let g=0;g<l.getOutputLineCount();g++){let b=new Array;u[g]=b;let y=g>0?l.breakOffsets[g-1]:0,C=l.breakOffsets[g];for(;f<d.length;){let x=c[f].content.length,L=d[f]+m,k=L+x;if(L>C)break;if(y<k){let O=c[f];if(O.inlineClassName){let W=g>0?l.wrappedTextIndentLength:0,z=W+Math.max(L-y,0),B=W+Math.min(k-y,C-y);z!==B&&b.push(new Iy(z,B,O.inlineClassName,O.inlineClassNameAffectsLetterSpacing))}}if(k<=C)m+=x,f++;else break}}}let h;if(d){let m=[];for(let f=0;f<d.length;f++){let g=d[f],b=c[f].tokens;b?b.forEach((y,C)=>{m.push({offset:g,text:y.substring(c[f].content),tokenMetadata:C.metadata})}):m.push({offset:g,text:c[f].content,tokenMetadata:dn.defaultTokenMetadata})}h=e.tokenization.getLineTokens(t).withInserted(m)}else h=e.tokenization.getLineTokens(t);for(let m=n;m<n+i;m++){let f=r+m-n;if(!s[f]){a[f]=null;continue}a[f]=this._getViewLineData(h,u?u[m]:null,m)}}_getViewLineData(e,t,n){this._assertVisible();let i=this._projectionData,r=n>0?i.wrappedTextIndentLength:0,s=n>0?i.breakOffsets[n-1]:0,a=i.breakOffsets[n],l=e.sliceAndInflate(s,a,r),d=l.getLineContent();n>0&&(d=XP(i.wrappedTextIndentLength)+d);let c=this._projectionData.getMinOutputOffset(n)+1,u=d.length+1,h=n+1<this.getViewLineCount(),m=n===0?0:i.breakOffsetsVisibleColumn[n-1];return new Ud(d,h,c,u,m,l,t)}getModelColumnOfViewPosition(e,t){return this._assertVisible(),this._projectionData.translateToInputOffset(e,t-1)+1}getViewPositionOfModelPosition(e,t,n=2){return this._assertVisible(),this._projectionData.translateToOutputPosition(t-1,n).toPosition(e)}getViewLineNumberOfModelPosition(e,t){this._assertVisible();let n=this._projectionData.translateToOutputPosition(t-1);return e+n.outputLineIndex}normalizePosition(e,t,n){let i=t.lineNumber-e;return this._projectionData.normalizeOutputPosition(e,t.column-1,n).toPosition(i)}getInjectedTextAt(e,t){return this._projectionData.getInjectedText(e,t-1)}_assertVisible(){if(!this._isVisible)throw new Error("Not supported")}},CS=class o{static INSTANCE=new o;constructor(){}isVisible(){return!0}setVisible(e){return e?this:SS.INSTANCE}getProjectionData(){return null}getViewLineCount(){return 1}getViewLineContent(e,t,n){return e.getLineContent(t)}getViewLineLength(e,t,n){return e.getLineLength(t)}getViewLineMinColumn(e,t,n){return e.getLineMinColumn(t)}getViewLineMaxColumn(e,t,n){return e.getLineMaxColumn(t)}getViewLineData(e,t,n){let i=e.tokenization.getLineTokens(t),r=i.getLineContent();return new Ud(r,!1,1,r.length+1,0,i.inflate(),null)}getViewLinesData(e,t,n,i,r,s,a){if(!s[r]){a[r]=null;return}a[r]=this.getViewLineData(e,t,0)}getModelColumnOfViewPosition(e,t){return t}getViewPositionOfModelPosition(e,t){return new P(e,t)}getViewLineNumberOfModelPosition(e,t){return e}normalizePosition(e,t,n){return t}getInjectedTextAt(e,t){return null}},SS=class o{static INSTANCE=new o;constructor(){}isVisible(){return!1}setVisible(e){return e?CS.INSTANCE:this}getProjectionData(){return null}getViewLineCount(){return 0}getViewLineContent(e,t,n){throw new Error("Not supported")}getViewLineLength(e,t,n){throw new Error("Not supported")}getViewLineMinColumn(e,t,n){throw new Error("Not supported")}getViewLineMaxColumn(e,t,n){throw new Error("Not supported")}getViewLineData(e,t,n){throw new Error("Not supported")}getViewLinesData(e,t,n,i,r,s,a){throw new Error("Not supported")}getModelColumnOfViewPosition(e,t){throw new Error("Not supported")}getViewPositionOfModelPosition(e,t){throw new Error("Not supported")}getViewLineNumberOfModelPosition(e,t){throw new Error("Not supported")}normalizePosition(e,t,n){throw new Error("Not supported")}getInjectedTextAt(e,t){throw new Error("Not supported")}},e0=[""];function XP(o){if(o>=e0.length)for(let e=1;e<=o;e++)e0[e]=tU(e);return e0[o]}function tU(o){return new Array(o+1).join(" ")}var xS=class{_values;_isValid;_validEndIndex;_prefixSum;_indexBySum;constructor(e){this._values=e,this._isValid=!1,this._validEndIndex=-1,this._prefixSum=[],this._indexBySum=[]}getTotalSum(){return this._ensureValid(),this._indexBySum.length}getPrefixSum(e){return this._ensureValid(),e===0?0:this._prefixSum[e-1]}getIndexOf(e){this._ensureValid();let t=this._indexBySum[e],n=t>0?this._prefixSum[t-1]:0;return new n0(t,e-n)}removeValues(e,t){this._values.splice(e,t),this._invalidate(e)}insertValues(e,t){this._values=ns(this._values,e,t),this._invalidate(e)}_invalidate(e){this._isValid=!1,this._validEndIndex=Math.min(this._validEndIndex,e-1)}_ensureValid(){if(!this._isValid){for(let e=this._validEndIndex+1,t=this._values.length;e<t;e++){let n=this._values[e],i=e>0?this._prefixSum[e-1]:0;this._prefixSum[e]=i+n;for(let r=0;r<n;r++)this._indexBySum[i+r]=e}this._prefixSum.length=this._values.length,this._indexBySum.length=this._prefixSum[this._prefixSum.length-1],this._isValid=!0,this._validEndIndex=this._values.length-1}}setValue(e,t){this._values[e]!==t&&(this._values[e]=t,this._invalidate(e))}},n0=class{constructor(e,t){this.index=e;this.remainder=t;this.index=e,this.remainder=t}_prefixSumIndexOfResultBrand=void 0};var ES=class{_editorId;model;_validModelVersionId;_domLineBreaksComputerFactory;_monospaceLineBreaksComputerFactory;fontInfo;tabSize;wrappingColumn;wrappingIndent;wordBreak;wrappingStrategy;modelLineProjections;projectedModelLineLineCounts;hiddenAreasDecorationIds;constructor(e,t,n,i,r,s,a,l,d,c){this._editorId=e,this.model=t,this._validModelVersionId=-1,this._domLineBreaksComputerFactory=n,this._monospaceLineBreaksComputerFactory=i,this.fontInfo=r,this.tabSize=s,this.wrappingStrategy=a,this.wrappingColumn=l,this.wrappingIndent=d,this.wordBreak=c,this._constructLines(!0,null)}dispose(){this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,[])}createCoordinatesConverter(){return new i0(this)}_constructLines(e,t){this.modelLineProjections=[],e&&(this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,[]));let n=this.model.getLinesContent(),i=this.model.getInjectedTextDecorations(this._editorId),r=n.length,s=this.createLineBreaksComputer(),a=new qi(oo.fromDecorations(i));for(let g=0;g<r;g++){let b=a.takeWhile(y=>y.lineNumber===g+1);s.addRequest(n[g],b,t?t[g]:null)}let l=s.finalize(),d=[],c=this.hiddenAreasDecorationIds.map(g=>this.model.getDecorationRange(g)).sort(D.compareRangesUsingStarts),u=1,h=0,m=-1,f=m+1<c.length?h+1:r+2;for(let g=0;g<r;g++){let b=g+1;b===f&&(m++,u=c[m].startLineNumber,h=c[m].endLineNumber,f=m+1<c.length?h+1:r+2);let y=b>=u&&b<=h,C=wS(l[g],!y);d[g]=C.getViewLineCount(),this.modelLineProjections[g]=C}this._validModelVersionId=this.model.getVersionId(),this.projectedModelLineLineCounts=new xS(d)}getHiddenAreas(){return this.hiddenAreasDecorationIds.map(e=>this.model.getDecorationRange(e))}setHiddenAreas(e){let t=e.map(h=>this.model.validateRange(h)),n=nU(t),i=this.hiddenAreasDecorationIds.map(h=>this.model.getDecorationRange(h)).sort(D.compareRangesUsingStarts);if(n.length===i.length){let h=!1;for(let m=0;m<n.length;m++)if(!n[m].equalsRange(i[m])){h=!0;break}if(!h)return!1}let r=n.map(h=>({range:h,options:ao.EMPTY}));this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,r);let s=n,a=1,l=0,d=-1,c=d+1<s.length?l+1:this.modelLineProjections.length+2,u=!1;for(let h=0;h<this.modelLineProjections.length;h++){let m=h+1;m===c&&(d++,a=s[d].startLineNumber,l=s[d].endLineNumber,c=d+1<s.length?l+1:this.modelLineProjections.length+2);let f=!1;if(m>=a&&m<=l?this.modelLineProjections[h].isVisible()&&(this.modelLineProjections[h]=this.modelLineProjections[h].setVisible(!1),f=!0):(u=!0,this.modelLineProjections[h].isVisible()||(this.modelLineProjections[h]=this.modelLineProjections[h].setVisible(!0),f=!0)),f){let g=this.modelLineProjections[h].getViewLineCount();this.projectedModelLineLineCounts.setValue(h,g)}}return u||this.setHiddenAreas([]),!0}modelPositionIsVisible(e,t){return e<1||e>this.modelLineProjections.length?!1:this.modelLineProjections[e-1].isVisible()}getModelLineViewLineCount(e){return e<1||e>this.modelLineProjections.length?1:this.modelLineProjections[e-1].getViewLineCount()}setTabSize(e){return this.tabSize===e?!1:(this.tabSize=e,this._constructLines(!1,null),!0)}setWrappingSettings(e,t,n,i,r){let s=this.fontInfo.equals(e),a=this.wrappingStrategy===t,l=this.wrappingColumn===n,d=this.wrappingIndent===i,c=this.wordBreak===r;if(s&&a&&l&&d&&c)return!1;let u=s&&a&&!l&&d&&c;this.fontInfo=e,this.wrappingStrategy=t,this.wrappingColumn=n,this.wrappingIndent=i,this.wordBreak=r;let h=null;if(u){h=[];for(let m=0,f=this.modelLineProjections.length;m<f;m++)h[m]=this.modelLineProjections[m].getProjectionData()}return this._constructLines(!1,h),!0}createLineBreaksComputer(){return(this.wrappingStrategy==="advanced"?this._domLineBreaksComputerFactory:this._monospaceLineBreaksComputerFactory).createLineBreaksComputer(this.fontInfo,this.tabSize,this.wrappingColumn,this.wrappingIndent,this.wordBreak)}onModelFlushed(){this._constructLines(!0,null)}onModelLinesDeleted(e,t,n){if(!e||e<=this._validModelVersionId)return null;let i=t===1?1:this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,r=this.projectedModelLineLineCounts.getPrefixSum(n);return this.modelLineProjections.splice(t-1,n-t+1),this.projectedModelLineLineCounts.removeValues(t-1,n-t+1),new Hu(i,r)}onModelLinesInserted(e,t,n,i){if(!e||e<=this._validModelVersionId)return null;let r=t>2&&!this.modelLineProjections[t-2].isVisible(),s=t===1?1:this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,a=0,l=[],d=[];for(let c=0,u=i.length;c<u;c++){let h=wS(i[c],!r);l.push(h);let m=h.getViewLineCount();a+=m,d[c]=m}return this.modelLineProjections=this.modelLineProjections.slice(0,t-1).concat(l).concat(this.modelLineProjections.slice(t-1)),this.projectedModelLineLineCounts.insertValues(t-1,d),new Uu(s,s+a-1)}onModelLineChanged(e,t,n){if(e!==null&&e<=this._validModelVersionId)return[!1,null,null,null];let i=t-1,r=this.modelLineProjections[i].getViewLineCount(),s=this.modelLineProjections[i].isVisible(),a=wS(n,s);this.modelLineProjections[i]=a;let l=this.modelLineProjections[i].getViewLineCount(),d=!1,c=0,u=-1,h=0,m=-1,f=0,g=-1;r>l?(c=this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,u=c+l-1,f=u+1,g=f+(r-l)-1,d=!0):r<l?(c=this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,u=c+r-1,h=u+1,m=h+(l-r)-1,d=!0):(c=this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,u=c+l-1),this.projectedModelLineLineCounts.setValue(i,l);let b=c<=u?new jm(c,u-c+1):null,y=h<=m?new Uu(h,m):null,C=f<=g?new Hu(f,g):null;return[d,b,y,C]}acceptVersionId(e){this._validModelVersionId=e,this.modelLineProjections.length===1&&!this.modelLineProjections[0].isVisible()&&this.setHiddenAreas([])}getViewLineCount(){return this.projectedModelLineLineCounts.getTotalSum()}_toValidViewLineNumber(e){if(e<1)return 1;let t=this.getViewLineCount();return e>t?t:e|0}getActiveIndentGuide(e,t,n){e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t),n=this._toValidViewLineNumber(n);let i=this.convertViewPositionToModelPosition(e,this.getViewLineMinColumn(e)),r=this.convertViewPositionToModelPosition(t,this.getViewLineMinColumn(t)),s=this.convertViewPositionToModelPosition(n,this.getViewLineMinColumn(n)),a=this.model.guides.getActiveIndentGuide(i.lineNumber,r.lineNumber,s.lineNumber),l=this.convertModelPositionToViewPosition(a.startLineNumber,1),d=this.convertModelPositionToViewPosition(a.endLineNumber,this.model.getLineMaxColumn(a.endLineNumber));return{startLineNumber:l.lineNumber,endLineNumber:d.lineNumber,indent:a.indent}}getViewLineInfo(e){e=this._toValidViewLineNumber(e);let t=this.projectedModelLineLineCounts.getIndexOf(e-1),n=t.index,i=t.remainder;return new _S(n+1,i)}getMinColumnOfViewLine(e){return this.modelLineProjections[e.modelLineNumber-1].getViewLineMinColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx)}getMaxColumnOfViewLine(e){return this.modelLineProjections[e.modelLineNumber-1].getViewLineMaxColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx)}getModelStartPositionOfViewLine(e){let t=this.modelLineProjections[e.modelLineNumber-1],n=t.getViewLineMinColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx),i=t.getModelColumnOfViewPosition(e.modelLineWrappedLineIdx,n);return new P(e.modelLineNumber,i)}getModelEndPositionOfViewLine(e){let t=this.modelLineProjections[e.modelLineNumber-1],n=t.getViewLineMaxColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx),i=t.getModelColumnOfViewPosition(e.modelLineWrappedLineIdx,n);return new P(e.modelLineNumber,i)}getViewLineInfosGroupedByModelRanges(e,t){let n=this.getViewLineInfo(e),i=this.getViewLineInfo(t),r=new Array,s=this.getModelStartPositionOfViewLine(n),a=new Array;for(let l=n.modelLineNumber;l<=i.modelLineNumber;l++){let d=this.modelLineProjections[l-1];if(d.isVisible()){let c=l===n.modelLineNumber?n.modelLineWrappedLineIdx:0,u=l===i.modelLineNumber?i.modelLineWrappedLineIdx+1:d.getViewLineCount();for(let h=c;h<u;h++)a.push(new _S(l,h))}if(!d.isVisible()&&s){let c=new P(l-1,this.model.getLineMaxColumn(l-1)+1),u=D.fromPositions(s,c);r.push(new TS(u,a)),a=[],s=null}else d.isVisible()&&!s&&(s=new P(l,1))}if(s){let l=D.fromPositions(s,this.getModelEndPositionOfViewLine(i));r.push(new TS(l,a))}return r}getViewLinesBracketGuides(e,t,n,i){let r=n?this.convertViewPositionToModelPosition(n.lineNumber,n.column):null,s=[];for(let a of this.getViewLineInfosGroupedByModelRanges(e,t)){let l=a.modelRange.startLineNumber,d=this.model.guides.getLinesBracketGuides(l,a.modelRange.endLineNumber,r,i);for(let c of a.viewLines){let h=d[c.modelLineNumber-l].map(m=>{if(m.forWrappedLinesAfterColumn!==-1&&this.modelLineProjections[c.modelLineNumber-1].getViewPositionOfModelPosition(0,m.forWrappedLinesAfterColumn).lineNumber>=c.modelLineWrappedLineIdx||m.forWrappedLinesBeforeOrAtColumn!==-1&&this.modelLineProjections[c.modelLineNumber-1].getViewPositionOfModelPosition(0,m.forWrappedLinesBeforeOrAtColumn).lineNumber<c.modelLineWrappedLineIdx)return;if(!m.horizontalLine)return m;let f=-1;if(m.column!==-1){let y=this.modelLineProjections[c.modelLineNumber-1].getViewPositionOfModelPosition(0,m.column);if(y.lineNumber===c.modelLineWrappedLineIdx)f=y.column;else if(y.lineNumber<c.modelLineWrappedLineIdx)f=this.getMinColumnOfViewLine(c);else if(y.lineNumber>c.modelLineWrappedLineIdx)return}let g=this.convertModelPositionToViewPosition(c.modelLineNumber,m.horizontalLine.endColumn),b=this.modelLineProjections[c.modelLineNumber-1].getViewPositionOfModelPosition(0,m.horizontalLine.endColumn);return b.lineNumber===c.modelLineWrappedLineIdx?new ar(m.visibleColumn,f,m.className,new ua(m.horizontalLine.top,g.column),-1,-1):b.lineNumber<c.modelLineWrappedLineIdx||m.visibleColumn!==-1?void 0:new ar(m.visibleColumn,f,m.className,new ua(m.horizontalLine.top,this.getMaxColumnOfViewLine(c)),-1,-1)});s.push(h.filter(m=>!!m))}}return s}getViewLinesIndentGuides(e,t){e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t);let n=this.convertViewPositionToModelPosition(e,this.getViewLineMinColumn(e)),i=this.convertViewPositionToModelPosition(t,this.getViewLineMaxColumn(t)),r=[],s=[],a=[],l=n.lineNumber-1,d=i.lineNumber-1,c=null;for(let f=l;f<=d;f++){let g=this.modelLineProjections[f];if(g.isVisible()){let b=g.getViewLineNumberOfModelPosition(0,f===l?n.column:1),y=g.getViewLineNumberOfModelPosition(0,this.model.getLineMaxColumn(f+1)),C=y-b+1,x=0;C>1&&g.getViewLineMinColumn(this.model,f+1,y)===1&&(x=b===0?1:2),s.push(C),a.push(x),c===null&&(c=new P(f+1,0))}else c!==null&&(r=r.concat(this.model.guides.getLinesIndentGuides(c.lineNumber,f)),c=null)}c!==null&&(r=r.concat(this.model.guides.getLinesIndentGuides(c.lineNumber,i.lineNumber)),c=null);let u=t-e+1,h=new Array(u),m=0;for(let f=0,g=r.length;f<g;f++){let b=r[f],y=Math.min(u-m,s[f]),C=a[f],x;C===2?x=0:C===1?x=1:x=y;for(let L=0;L<y;L++)L===x&&(b=0),h[m++]=b}return h}getViewLineContent(e){let t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineContent(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineLength(e){let t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineLength(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineMinColumn(e){let t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineMinColumn(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineMaxColumn(e){let t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineMaxColumn(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineData(e){let t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineData(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLinesData(e,t,n){e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t);let i=this.projectedModelLineLineCounts.getIndexOf(e-1),r=e,s=i.index,a=i.remainder,l=[];for(let d=s,c=this.model.getLineCount();d<c;d++){let u=this.modelLineProjections[d];if(!u.isVisible())continue;let h=d===s?a:0,m=u.getViewLineCount()-h,f=!1;if(r+m>t&&(f=!0,m=t-r+1),u.getViewLinesData(this.model,d+1,h,m,r-e,n,l),r+=m,f)break}return l}validateViewPosition(e,t,n){e=this._toValidViewLineNumber(e);let i=this.projectedModelLineLineCounts.getIndexOf(e-1),r=i.index,s=i.remainder,a=this.modelLineProjections[r],l=a.getViewLineMinColumn(this.model,r+1,s),d=a.getViewLineMaxColumn(this.model,r+1,s);t<l&&(t=l),t>d&&(t=d);let c=a.getModelColumnOfViewPosition(s,t);return this.model.validatePosition(new P(r+1,c)).equals(n)?new P(e,t):this.convertModelPositionToViewPosition(n.lineNumber,n.column)}validateViewRange(e,t){let n=this.validateViewPosition(e.startLineNumber,e.startColumn,t.getStartPosition()),i=this.validateViewPosition(e.endLineNumber,e.endColumn,t.getEndPosition());return new D(n.lineNumber,n.column,i.lineNumber,i.column)}convertViewPositionToModelPosition(e,t){let n=this.getViewLineInfo(e),i=this.modelLineProjections[n.modelLineNumber-1].getModelColumnOfViewPosition(n.modelLineWrappedLineIdx,t);return this.model.validatePosition(new P(n.modelLineNumber,i))}convertViewRangeToModelRange(e){let t=this.convertViewPositionToModelPosition(e.startLineNumber,e.startColumn),n=this.convertViewPositionToModelPosition(e.endLineNumber,e.endColumn);return new D(t.lineNumber,t.column,n.lineNumber,n.column)}convertModelPositionToViewPosition(e,t,n=2,i=!1,r=!1){let s=this.model.validatePosition(new P(e,t)),a=s.lineNumber,l=s.column,d=a-1,c=!1;if(r)for(;d<this.modelLineProjections.length&&!this.modelLineProjections[d].isVisible();)d++,c=!0;else for(;d>0&&!this.modelLineProjections[d].isVisible();)d--,c=!0;if(d===0&&!this.modelLineProjections[d].isVisible())return new P(i?0:1,1);let u=1+this.projectedModelLineLineCounts.getPrefixSum(d),h;return c?r?h=this.modelLineProjections[d].getViewPositionOfModelPosition(u,1,n):h=this.modelLineProjections[d].getViewPositionOfModelPosition(u,this.model.getLineMaxColumn(d+1),n):h=this.modelLineProjections[a-1].getViewPositionOfModelPosition(u,l,n),h}convertModelRangeToViewRange(e,t=0){if(e.isEmpty()){let n=this.convertModelPositionToViewPosition(e.startLineNumber,e.startColumn,t);return D.fromPositions(n)}else{let n=this.convertModelPositionToViewPosition(e.startLineNumber,e.startColumn,1),i=this.convertModelPositionToViewPosition(e.endLineNumber,e.endColumn,0);return new D(n.lineNumber,n.column,i.lineNumber,i.column)}}getViewLineNumberOfModelPosition(e,t){let n=e-1;if(this.modelLineProjections[n].isVisible()){let r=1+this.projectedModelLineLineCounts.getPrefixSum(n);return this.modelLineProjections[n].getViewLineNumberOfModelPosition(r,t)}for(;n>0&&!this.modelLineProjections[n].isVisible();)n--;if(n===0&&!this.modelLineProjections[n].isVisible())return 1;let i=1+this.projectedModelLineLineCounts.getPrefixSum(n);return this.modelLineProjections[n].getViewLineNumberOfModelPosition(i,this.model.getLineMaxColumn(n+1))}getDecorationsInRange(e,t,n,i,r){let s=this.convertViewPositionToModelPosition(e.startLineNumber,e.startColumn),a=this.convertViewPositionToModelPosition(e.endLineNumber,e.endColumn);if(a.lineNumber-s.lineNumber<=e.endLineNumber-e.startLineNumber)return this.model.getDecorationsInRange(new D(s.lineNumber,1,a.lineNumber,a.column),t,n,i,r);let l=[],d=s.lineNumber-1,c=a.lineNumber-1,u=null;for(let g=d;g<=c;g++)if(this.modelLineProjections[g].isVisible())u===null&&(u=new P(g+1,g===d?s.column:1));else if(u!==null){let y=this.model.getLineMaxColumn(g);l=l.concat(this.model.getDecorationsInRange(new D(u.lineNumber,u.column,g,y),t,n,i)),u=null}u!==null&&(l=l.concat(this.model.getDecorationsInRange(new D(u.lineNumber,u.column,a.lineNumber,a.column),t,n,i)),u=null),l.sort((g,b)=>{let y=D.compareRangesUsingStarts(g.range,b.range);return y===0?g.id<b.id?-1:g.id>b.id?1:0:y});let h=[],m=0,f=null;for(let g of l){let b=g.id;f!==b&&(f=b,h[m++]=g)}return h}getInjectedTextAt(e){let t=this.getViewLineInfo(e.lineNumber);return this.modelLineProjections[t.modelLineNumber-1].getInjectedTextAt(t.modelLineWrappedLineIdx,e.column)}normalizePosition(e,t){let n=this.getViewLineInfo(e.lineNumber);return this.modelLineProjections[n.modelLineNumber-1].normalizePosition(n.modelLineWrappedLineIdx,e,t)}getLineIndentColumn(e){let t=this.getViewLineInfo(e);return t.modelLineWrappedLineIdx===0?this.model.getLineIndentColumn(t.modelLineNumber):0}};function nU(o){if(o.length===0)return[];let e=o.slice();e.sort(D.compareRangesUsingStarts);let t=[],n=e[0].startLineNumber,i=e[0].endLineNumber;for(let r=1,s=e.length;r<s;r++){let a=e[r];a.startLineNumber>i+1?(t.push(new D(n,1,i,1)),n=a.startLineNumber,i=a.endLineNumber):a.endLineNumber>i&&(i=a.endLineNumber)}return t.push(new D(n,1,i,1)),t}var _S=class{constructor(e,t){this.modelLineNumber=e;this.modelLineWrappedLineIdx=t}get isWrappedLineContinuation(){return this.modelLineWrappedLineIdx>0}},TS=class{constructor(e,t){this.modelRange=e;this.viewLines=t}},i0=class{_lines;constructor(e){this._lines=e}convertViewPositionToModelPosition(e){return this._lines.convertViewPositionToModelPosition(e.lineNumber,e.column)}convertViewRangeToModelRange(e){return this._lines.convertViewRangeToModelRange(e)}validateViewPosition(e,t){return this._lines.validateViewPosition(e.lineNumber,e.column,t)}validateViewRange(e,t){return this._lines.validateViewRange(e,t)}convertModelPositionToViewPosition(e,t,n,i){return this._lines.convertModelPositionToViewPosition(e.lineNumber,e.column,t,n,i)}convertModelRangeToViewRange(e,t){return this._lines.convertModelRangeToViewRange(e,t)}modelPositionIsVisible(e){return this._lines.modelPositionIsVisible(e.lineNumber,e.column)}getModelLineViewLineCount(e){return this._lines.getModelLineViewLineCount(e)}getViewLineNumberOfModelPosition(e,t){return this._lines.getViewLineNumberOfModelPosition(e,t)}};var LS=class{model;constructor(e){this.model=e}dispose(){}createCoordinatesConverter(){return new o0(this)}getHiddenAreas(){return[]}setHiddenAreas(e){return!1}setTabSize(e){return!1}setWrappingSettings(e,t,n,i){return!1}createLineBreaksComputer(){let e=[];return{addRequest:(t,n,i)=>{e.push(null)},finalize:()=>e}}onModelFlushed(){}onModelLinesDeleted(e,t,n){return new Hu(t,n)}onModelLinesInserted(e,t,n,i){return new Uu(t,n)}onModelLineChanged(e,t,n){return[!1,new jm(t,1),null,null]}acceptVersionId(e){}getViewLineCount(){return this.model.getLineCount()}getActiveIndentGuide(e,t,n){return{startLineNumber:e,endLineNumber:e,indent:0}}getViewLinesBracketGuides(e,t,n){return new Array(t-e+1).fill([])}getViewLinesIndentGuides(e,t){let n=t-e+1,i=new Array(n);for(let r=0;r<n;r++)i[r]=0;return i}getViewLineContent(e){return this.model.getLineContent(e)}getViewLineLength(e){return this.model.getLineLength(e)}getViewLineMinColumn(e){return this.model.getLineMinColumn(e)}getViewLineMaxColumn(e){return this.model.getLineMaxColumn(e)}getViewLineData(e){let t=this.model.tokenization.getLineTokens(e),n=t.getLineContent();return new Ud(n,!1,1,n.length+1,0,t.inflate(),null)}getViewLinesData(e,t,n){let i=this.model.getLineCount();e=Math.min(Math.max(1,e),i),t=Math.min(Math.max(1,t),i);let r=[];for(let s=e;s<=t;s++){let a=s-e;r[a]=n[a]?this.getViewLineData(s):null}return r}getDecorationsInRange(e,t,n,i,r){return this.model.getDecorationsInRange(e,t,n,i,r)}normalizePosition(e,t){return this.model.normalizePosition(e,t)}getLineIndentColumn(e){return this.model.getLineIndentColumn(e)}getInjectedTextAt(e){return null}},o0=class{_lines;constructor(e){this._lines=e}_validPosition(e){return this._lines.model.validatePosition(e)}_validRange(e){return this._lines.model.validateRange(e)}convertViewPositionToModelPosition(e){return this._validPosition(e)}convertViewRangeToModelRange(e){return this._validRange(e)}validateViewPosition(e,t){return this._validPosition(t)}validateViewRange(e,t){return this._validRange(t)}convertModelPositionToViewPosition(e){return this._validPosition(e)}convertModelRangeToViewRange(e){return this._validRange(e)}modelPositionIsVisible(e){let t=this._lines.model.getLineCount();return!(e.lineNumber<1||e.lineNumber>t)}modelRangeIsVisible(e){let t=this._lines.model.getLineCount();return!(e.startLineNumber<1||e.startLineNumber>t||e.endLineNumber<1||e.endLineNumber>t)}getModelLineViewLineCount(e){return 1}getViewLineNumberOfModelPosition(e,t){return e}};var DS=class{editorId;model;configuration;_linesCollection;_coordinatesConverter;_decorationsCache;_cachedModelDecorationsResolver;_cachedModelDecorationsResolverViewRange;constructor(e,t,n,i,r){this.editorId=e,this.model=t,this.configuration=n,this._linesCollection=i,this._coordinatesConverter=r,this._decorationsCache=Object.create(null),this._cachedModelDecorationsResolver=null,this._cachedModelDecorationsResolverViewRange=null}_clearCachedModelDecorationsResolver(){this._cachedModelDecorationsResolver=null,this._cachedModelDecorationsResolverViewRange=null}dispose(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}reset(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}onModelDecorationsChanged(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}onLineMappingChanged(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}_getOrCreateViewModelDecoration(e){let t=e.id,n=this._decorationsCache[t];if(!n){let i=e.range,r=e.options,s;if(r.isWholeLine){let a=this._coordinatesConverter.convertModelPositionToViewPosition(new P(i.startLineNumber,1),0,!1,!0),l=this._coordinatesConverter.convertModelPositionToViewPosition(new P(i.endLineNumber,this.model.getLineMaxColumn(i.endLineNumber)),1);s=new D(a.lineNumber,a.column,l.lineNumber,l.column)}else s=this._coordinatesConverter.convertModelRangeToViewRange(i,1);n=new Ku(s,r),this._decorationsCache[t]=n}return n}getMinimapDecorationsInRange(e){return this._getDecorationsInRange(e,!0,!1).decorations}getDecorationsViewportData(e){let t=this._cachedModelDecorationsResolver!==null;return t=t&&e.equalsRange(this._cachedModelDecorationsResolverViewRange),t||(this._cachedModelDecorationsResolver=this._getDecorationsInRange(e,!1,!1),this._cachedModelDecorationsResolverViewRange=e),this._cachedModelDecorationsResolver}getInlineDecorationsOnLine(e,t=!1,n=!1){let i=new D(e,this._linesCollection.getViewLineMinColumn(e),e,this._linesCollection.getViewLineMaxColumn(e));return this._getDecorationsInRange(i,t,n).inlineDecorations[0]}_getDecorationsInRange(e,t,n){let i=this._linesCollection.getDecorationsInRange(e,this.editorId,Ld(this.configuration.options),t,n),r=e.startLineNumber,s=e.endLineNumber,a=[],l=0,d=[];for(let c=r;c<=s;c++)d[c-r]=[];for(let c=0,u=i.length;c<u;c++){let h=i[c],m=h.options;if(!iU(this.model,h))continue;let f=this._getOrCreateViewModelDecoration(h),g=f.range;if(a[l++]=f,m.inlineClassName){let b=new zd(g,m.inlineClassName,m.inlineClassNameAffectsLetterSpacing?3:0),y=Math.max(r,g.startLineNumber),C=Math.min(s,g.endLineNumber);for(let x=y;x<=C;x++)d[x-r].push(b)}if(m.beforeContentClassName&&r<=g.startLineNumber&&g.startLineNumber<=s){let b=new zd(new D(g.startLineNumber,g.startColumn,g.startLineNumber,g.startColumn),m.beforeContentClassName,1);d[g.startLineNumber-r].push(b)}if(m.afterContentClassName&&r<=g.endLineNumber&&g.endLineNumber<=s){let b=new zd(new D(g.endLineNumber,g.endColumn,g.endLineNumber,g.endColumn),m.afterContentClassName,2);d[g.endLineNumber-r].push(b)}}return{decorations:a,inlineDecorations:d}}};function iU(o,e){return!(e.options.hideInCommentTokens&&oU(o,e)||e.options.hideInStringTokens&&rU(o,e))}function oU(o,e){return QP(o,e.range,t=>t===1)}function rU(o,e){return QP(o,e.range,t=>t===2)}function QP(o,e,t){for(let n=e.startLineNumber;n<=e.endLineNumber;n++){let i=o.tokenization.getLineTokens(n),r=n===e.startLineNumber,s=n===e.endLineNumber,a=r?i.findTokenIndexAtOffset(e.startColumn-1):0;for(;a<i.getCount()&&!(s&&i.getStartOffset(a)>e.endColumn-1);){if(!t(i.getStandardTokenType(a)))return!1;a++}}return!0}var Ic=3,kS=class{lanes;persist=0;_requiredLanes=1;constructor(e){this.lanes=new Uint8Array(Math.ceil((e+1)*Ic/8))}reset(e){let t=Math.ceil((e+1)*Ic/8);this.lanes.length<t?this.lanes=new Uint8Array(t):this.lanes.fill(0),this._requiredLanes=1}get requiredLanes(){return this._requiredLanes}push(e,t,n){n&&(this.persist|=1<<e-1);for(let i=t.startLineNumber;i<=t.endLineNumber;i++){let r=Ic*i+(e-1);this.lanes[r>>>3]|=1<<r%8,this._requiredLanes=Math.max(this._requiredLanes,this.countAtLine(i))}}getLanesAtLine(e){let t=[],n=Ic*e;for(let i=0;i<Ic;i++)(this.persist&1<<i||this.lanes[n>>>3]&1<<n%8)&&t.push(i+1),n++;return t.length?t:[2]}countAtLine(e){let t=Ic*e,n=0;for(let i=0;i<Ic;i++)(this.persist&1<<i||this.lanes[t>>>3]&1<<t%8)&&n++,t++;return n}};var sU=!0,RS=class extends V{constructor(t,n,i,r,s,a,l,d,c,u){super();this.languageConfigurationService=l;this._themeService=d;this._attachedView=c;this._transactionalTarget=u;if(this._editorId=t,this._configuration=n,this.model=i,this._eventDispatcher=new iS,this.onEvent=this._eventDispatcher.onEvent,this.cursorConfig=new pa(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._updateConfigurationViewLineCount=this._register(new Qt(()=>this._updateConfigurationViewLineCountNow(),0)),this._hasFocus=!1,this._viewportStart=r0.create(this.model),this.glyphLanes=new kS(0),sU&&this.model.isTooLargeForTokenization())this._lines=new LS(this.model);else{let h=this._configuration.options,m=h.get(51),f=h.get(141),g=h.get(148),b=h.get(140),y=h.get(131);this._lines=new ES(this._editorId,this.model,r,s,m,this.model.getOptions().tabSize,f,g.wrappingColumn,b,y)}this.coordinatesConverter=this._lines.createCoordinatesConverter(),this._cursor=this._register(new bS(i,this,this.coordinatesConverter,this.cursorConfig)),this.viewLayout=this._register(new IS(this._configuration,this.getLineCount(),a)),this._register(this.viewLayout.onDidScroll(h=>{h.scrollTopChanged&&this._handleVisibleLinesChanged(),h.scrollTopChanged&&this._viewportStart.invalidate(),this._eventDispatcher.emitSingleViewEvent(new py(h)),this._eventDispatcher.emitOutgoingEvent(new sS(h.oldScrollWidth,h.oldScrollLeft,h.oldScrollHeight,h.oldScrollTop,h.scrollWidth,h.scrollLeft,h.scrollHeight,h.scrollTop))})),this._register(this.viewLayout.onDidContentSizeChange(h=>{this._eventDispatcher.emitOutgoingEvent(h)})),this._decorations=new DS(this._editorId,this.model,this._configuration,this._lines,this.coordinatesConverter),this._registerModelEvents(),this._register(this._configuration.onDidChangeFast(h=>{try{let m=this._eventDispatcher.beginEmitViewEvents();this._onConfigurationChanged(m,h)}finally{this._eventDispatcher.endEmitViewEvents()}})),this._register(jh.getInstance().onDidChange(()=>{this._eventDispatcher.emitSingleViewEvent(new fy)})),this._register(this._themeService.onDidColorThemeChange(h=>{this._invalidateDecorationsColorCache(),this._eventDispatcher.emitSingleViewEvent(new my(h))})),this._updateConfigurationViewLineCountNow()}_editorId;_configuration;model;_eventDispatcher;onEvent;cursorConfig;_updateConfigurationViewLineCount;_hasFocus;_viewportStart;_lines;coordinatesConverter;viewLayout;_cursor;_decorations;glyphLanes;dispose(){super.dispose(),this._decorations.dispose(),this._lines.dispose(),this._viewportStart.dispose(),this._eventDispatcher.dispose()}createLineBreaksComputer(){return this._lines.createLineBreaksComputer()}addViewEventHandler(t){this._eventDispatcher.addViewEventHandler(t)}removeViewEventHandler(t){this._eventDispatcher.removeViewEventHandler(t)}_updateConfigurationViewLineCountNow(){this._configuration.setViewLineCount(this._lines.getViewLineCount())}getModelVisibleRanges(){let t=this.viewLayout.getLinesViewportData(),n=new D(t.startLineNumber,this.getLineMinColumn(t.startLineNumber),t.endLineNumber,this.getLineMaxColumn(t.endLineNumber));return this._toModelVisibleRanges(n)}visibleLinesStabilized(){let t=this.getModelVisibleRanges();this._attachedView.setVisibleLines(t,!0)}_handleVisibleLinesChanged(){let t=this.getModelVisibleRanges();this._attachedView.setVisibleLines(t,!1)}setHasFocus(t){this._hasFocus=t,this._cursor.setHasFocus(t),this._eventDispatcher.emitSingleViewEvent(new uy(t)),this._eventDispatcher.emitOutgoingEvent(new rS(!t,t))}onCompositionStart(){this._eventDispatcher.emitSingleViewEvent(new ay)}onCompositionEnd(){this._eventDispatcher.emitSingleViewEvent(new ly)}_captureStableViewport(){if(this._viewportStart.isValid&&this.viewLayout.getCurrentScrollTop()>0){let t=new P(this._viewportStart.viewLineNumber,this.getLineMinColumn(this._viewportStart.viewLineNumber)),n=this.coordinatesConverter.convertViewPositionToModelPosition(t);return new MS(n,this._viewportStart.startLineDelta)}return new MS(null,0)}_onConfigurationChanged(t,n){let i=this._captureStableViewport(),r=this._configuration.options,s=r.get(51),a=r.get(141),l=r.get(148),d=r.get(140),c=r.get(131);this._lines.setWrappingSettings(s,a,l.wrappingColumn,d,c)&&(t.emitViewEvent(new Wd),t.emitViewEvent(new Hd),t.emitViewEvent(new Ls(null)),this._cursor.onLineMappingChanged(t),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount()),this._updateConfigurationViewLineCount.schedule()),n.hasChanged(93)&&(this._decorations.reset(),t.emitViewEvent(new Ls(null))),n.hasChanged(100)&&(this._decorations.reset(),t.emitViewEvent(new Ls(null))),t.emitViewEvent(new dy(n)),this.viewLayout.onConfigurationChanged(n),i.recoverViewportStart(this.coordinatesConverter,this.viewLayout),pa.shouldRecreate(n)&&(this.cursorConfig=new pa(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig))}_registerModelEvents(){this._register(this.model.onDidChangeContentOrInjectedText(t=>{try{let i=this._eventDispatcher.beginEmitViewEvents(),r=!1,s=!1,a=t instanceof yl?t.rawContentChangedEvent.changes:t.changes,l=t instanceof yl?t.rawContentChangedEvent.versionId:null,d=this._lines.createLineBreaksComputer();for(let h of a)switch(h.changeType){case 4:{for(let m=0;m<h.detail.length;m++){let f=h.detail[m],g=h.injectedTexts[m];g&&(g=g.filter(b=>!b.ownerId||b.ownerId===this._editorId)),d.addRequest(f,g,null)}break}case 2:{let m=null;h.injectedText&&(m=h.injectedText.filter(f=>!f.ownerId||f.ownerId===this._editorId)),d.addRequest(h.detail,m,null);break}}let c=d.finalize(),u=new qi(c);for(let h of a)switch(h.changeType){case 1:{this._lines.onModelFlushed(),i.emitViewEvent(new Wd),this._decorations.reset(),this.viewLayout.onFlushed(this.getLineCount()),r=!0;break}case 3:{let m=this._lines.onModelLinesDeleted(l,h.fromLineNumber,h.toLineNumber);m!==null&&(i.emitViewEvent(m),this.viewLayout.onLinesDeleted(m.fromLineNumber,m.toLineNumber)),r=!0;break}case 4:{let m=u.takeCount(h.detail.length),f=this._lines.onModelLinesInserted(l,h.fromLineNumber,h.toLineNumber,m);f!==null&&(i.emitViewEvent(f),this.viewLayout.onLinesInserted(f.fromLineNumber,f.toLineNumber)),r=!0;break}case 2:{let m=u.dequeue(),[f,g,b,y]=this._lines.onModelLineChanged(l,h.lineNumber,m);s=f,g&&i.emitViewEvent(g),b&&(i.emitViewEvent(b),this.viewLayout.onLinesInserted(b.fromLineNumber,b.toLineNumber)),y&&(i.emitViewEvent(y),this.viewLayout.onLinesDeleted(y.fromLineNumber,y.toLineNumber));break}case 5:break}l!==null&&this._lines.acceptVersionId(l),this.viewLayout.onHeightMaybeChanged(),!r&&s&&(i.emitViewEvent(new Hd),i.emitViewEvent(new Ls(null)),this._cursor.onLineMappingChanged(i),this._decorations.onLineMappingChanged())}finally{this._eventDispatcher.endEmitViewEvents()}let n=this._viewportStart.isValid;if(this._viewportStart.invalidate(),this._configuration.setModelLineCount(this.model.getLineCount()),this._updateConfigurationViewLineCountNow(),!this._hasFocus&&this.model.getAttachedEditorCount()>=2&&n){let i=this.model._getTrackedRange(this._viewportStart.modelTrackedRange);if(i){let r=this.coordinatesConverter.convertModelPositionToViewPosition(i.getStartPosition()),s=this.viewLayout.getVerticalOffsetForLineNumber(r.lineNumber);this.viewLayout.setScrollPosition({scrollTop:s+this._viewportStart.startLineDelta},1)}}try{let i=this._eventDispatcher.beginEmitViewEvents();t instanceof yl&&i.emitOutgoingEvent(new mS(t.contentChangedEvent)),this._cursor.onModelContentChanged(i,t)}finally{this._eventDispatcher.endEmitViewEvents()}this._handleVisibleLinesChanged()})),this._register(this.model.onDidChangeTokens(t=>{let n=[];for(let i=0,r=t.ranges.length;i<r;i++){let s=t.ranges[i],a=this.coordinatesConverter.convertModelPositionToViewPosition(new P(s.fromLineNumber,1)).lineNumber,l=this.coordinatesConverter.convertModelPositionToViewPosition(new P(s.toLineNumber,this.model.getLineMaxColumn(s.toLineNumber))).lineNumber;n[i]={fromLineNumber:a,toLineNumber:l}}this._eventDispatcher.emitSingleViewEvent(new gy(n)),this._eventDispatcher.emitOutgoingEvent(new fS(t))})),this._register(this.model.onDidChangeLanguageConfiguration(t=>{this._eventDispatcher.emitSingleViewEvent(new hy),this.cursorConfig=new pa(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new pS(t))})),this._register(this.model.onDidChangeLanguage(t=>{this.cursorConfig=new pa(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new hS(t))})),this._register(this.model.onDidChangeOptions(t=>{if(this._lines.setTabSize(this.model.getOptions().tabSize)){try{let n=this._eventDispatcher.beginEmitViewEvents();n.emitViewEvent(new Wd),n.emitViewEvent(new Hd),n.emitViewEvent(new Ls(null)),this._cursor.onLineMappingChanged(n),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount())}finally{this._eventDispatcher.endEmitViewEvents()}this._updateConfigurationViewLineCount.schedule()}this.cursorConfig=new pa(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new gS(t))})),this._register(this.model.onDidChangeDecorations(t=>{this._decorations.onModelDecorationsChanged(),this._eventDispatcher.emitSingleViewEvent(new Ls(t)),this._eventDispatcher.emitOutgoingEvent(new uS(t))}))}hiddenAreasModel=new a0;previousHiddenAreas=[];setHiddenAreas(t,n){this.hiddenAreasModel.setHiddenAreas(n,t);let i=this.hiddenAreasModel.getMergedRanges();if(i===this.previousHiddenAreas)return;this.previousHiddenAreas=i;let r=this._captureStableViewport(),s=!1;try{let a=this._eventDispatcher.beginEmitViewEvents();s=this._lines.setHiddenAreas(i),s&&(a.emitViewEvent(new Wd),a.emitViewEvent(new Hd),a.emitViewEvent(new Ls(null)),this._cursor.onLineMappingChanged(a),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount()),this.viewLayout.onHeightMaybeChanged());let l=r.viewportStartModelPosition?.lineNumber;l&&i.some(c=>c.startLineNumber<=l&&l<=c.endLineNumber)||r.recoverViewportStart(this.coordinatesConverter,this.viewLayout)}finally{this._eventDispatcher.endEmitViewEvents()}this._updateConfigurationViewLineCount.schedule(),s&&this._eventDispatcher.emitOutgoingEvent(new lS)}getVisibleRangesPlusViewportAboveBelow(){let t=this._configuration.options.get(147),n=this._configuration.options.get(68),i=Math.max(20,Math.round(t.height/n)),r=this.viewLayout.getLinesViewportData(),s=Math.max(1,r.completelyVisibleStartLineNumber-i),a=Math.min(this.getLineCount(),r.completelyVisibleEndLineNumber+i);return this._toModelVisibleRanges(new D(s,this.getLineMinColumn(s),a,this.getLineMaxColumn(a)))}getVisibleRanges(){let t=this.getCompletelyVisibleViewRange();return this._toModelVisibleRanges(t)}getHiddenAreas(){return this._lines.getHiddenAreas()}_toModelVisibleRanges(t){let n=this.coordinatesConverter.convertViewRangeToModelRange(t),i=this._lines.getHiddenAreas();if(i.length===0)return[n];let r=[],s=0,a=n.startLineNumber,l=n.startColumn,d=n.endLineNumber,c=n.endColumn;for(let u=0,h=i.length;u<h;u++){let m=i[u].startLineNumber,f=i[u].endLineNumber;f<a||m>d||(a<m&&(r[s++]=new D(a,l,m-1,this.model.getLineMaxColumn(m-1))),a=f+1,l=1)}return(a<d||a===d&&l<c)&&(r[s++]=new D(a,l,d,c)),r}getCompletelyVisibleViewRange(){let t=this.viewLayout.getLinesViewportData(),n=t.completelyVisibleStartLineNumber,i=t.completelyVisibleEndLineNumber;return new D(n,this.getLineMinColumn(n),i,this.getLineMaxColumn(i))}getCompletelyVisibleViewRangeAtScrollTop(t){let n=this.viewLayout.getLinesViewportDataAtScrollTop(t),i=n.completelyVisibleStartLineNumber,r=n.completelyVisibleEndLineNumber;return new D(i,this.getLineMinColumn(i),r,this.getLineMaxColumn(r))}saveState(){let t=this.viewLayout.saveState(),n=t.scrollTop,i=this.viewLayout.getLineNumberAtVerticalOffset(n),r=this.coordinatesConverter.convertViewPositionToModelPosition(new P(i,this.getLineMinColumn(i))),s=this.viewLayout.getVerticalOffsetForLineNumber(i)-n;return{scrollLeft:t.scrollLeft,firstPosition:r,firstPositionDeltaTop:s}}reduceRestoreState(t){if(typeof t.firstPosition>"u")return this._reduceRestoreStateCompatibility(t);let n=this.model.validatePosition(t.firstPosition),i=this.coordinatesConverter.convertModelPositionToViewPosition(n),r=this.viewLayout.getVerticalOffsetForLineNumber(i.lineNumber)-t.firstPositionDeltaTop;return{scrollLeft:t.scrollLeft,scrollTop:r}}_reduceRestoreStateCompatibility(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTopWithoutViewZones}}getTabSize(){return this.model.getOptions().tabSize}getLineCount(){return this._lines.getViewLineCount()}setViewport(t,n,i){this._viewportStart.update(this,t)}getActiveIndentGuide(t,n,i){return this._lines.getActiveIndentGuide(t,n,i)}getLinesIndentGuides(t,n){return this._lines.getViewLinesIndentGuides(t,n)}getBracketGuidesInRangeByLine(t,n,i,r){return this._lines.getViewLinesBracketGuides(t,n,i,r)}getLineContent(t){return this._lines.getViewLineContent(t)}getLineLength(t){return this._lines.getViewLineLength(t)}getLineMinColumn(t){return this._lines.getViewLineMinColumn(t)}getLineMaxColumn(t){return this._lines.getViewLineMaxColumn(t)}getLineFirstNonWhitespaceColumn(t){let n=Xt(this.getLineContent(t));return n===-1?0:n+1}getLineLastNonWhitespaceColumn(t){let n=Wo(this.getLineContent(t));return n===-1?0:n+2}getMinimapDecorationsInRange(t){return this._decorations.getMinimapDecorationsInRange(t)}getDecorationsInViewport(t){return this._decorations.getDecorationsViewportData(t).decorations}getInjectedTextAt(t){return this._lines.getInjectedTextAt(t)}getViewportViewLineRenderingData(t,n){let r=this._decorations.getDecorationsViewportData(t).inlineDecorations[n-t.startLineNumber];return this._getViewLineRenderingData(n,r)}getViewLineRenderingData(t){let n=this._decorations.getInlineDecorationsOnLine(t);return this._getViewLineRenderingData(t,n)}_getViewLineRenderingData(t,n){let i=this.model.mightContainRTL(),r=this.model.mightContainNonBasicASCII(),s=this.getTabSize(),a=this._lines.getViewLineData(t);return a.inlineDecorations&&(n=[...n,...a.inlineDecorations.map(l=>l.toInlineDecoration(t))]),new yy(a.minColumn,a.maxColumn,a.content,a.continuesWithWrappedLine,i,r,a.tokens,n,s,a.startVisibleColumn)}getViewLineData(t){return this._lines.getViewLineData(t)}getMinimapLinesRenderingData(t,n,i){let r=this._lines.getViewLinesData(t,n,i);return new vy(this.getTabSize(),r)}getAllOverviewRulerDecorations(t){let n=this.model.getOverviewRulerDecorations(this._editorId,Ld(this._configuration.options)),i=new s0;for(let r of n){let s=r.options,a=s.overviewRuler;if(!a)continue;let l=a.position;if(l===0)continue;let d=a.getColor(t.value),c=this.coordinatesConverter.getViewLineNumberOfModelPosition(r.range.startLineNumber,r.range.startColumn),u=this.coordinatesConverter.getViewLineNumberOfModelPosition(r.range.endLineNumber,r.range.endColumn);i.accept(d,s.zIndex,c,u,l)}return i.asArray}_invalidateDecorationsColorCache(){let t=this.model.getOverviewRulerDecorations();for(let n of t)n.options.overviewRuler?.invalidateCachedColor(),n.options.minimap?.invalidateCachedColor()}getValueInRange(t,n){let i=this.coordinatesConverter.convertViewRangeToModelRange(t);return this.model.getValueInRange(i,n)}getValueLengthInRange(t,n){let i=this.coordinatesConverter.convertViewRangeToModelRange(t);return this.model.getValueLengthInRange(i,n)}modifyPosition(t,n){let i=this.coordinatesConverter.convertViewPositionToModelPosition(t),r=this.model.modifyPosition(i,n);return this.coordinatesConverter.convertModelPositionToViewPosition(r)}deduceModelPositionRelativeToViewPosition(t,n,i){let r=this.coordinatesConverter.convertViewPositionToModelPosition(t);this.model.getEOL().length===2&&(n<0?n-=i:n+=i);let a=this.model.getOffsetAt(r)+n;return this.model.getPositionAt(a)}getPlainTextToCopy(t,n,i){let r=i?`\r
`:this.model.getEOL();t=t.slice(0),t.sort(D.compareRangesUsingStarts);let s=!1,a=!1;for(let d of t)d.isEmpty()?s=!0:a=!0;if(!a){if(!n)return"";let d=t.map(u=>u.startLineNumber),c="";for(let u=0;u<d.length;u++)u>0&&d[u-1]===d[u]||(c+=this.model.getLineContent(d[u])+r);return c}if(s&&n){let d=[],c=0;for(let u of t){let h=u.startLineNumber;u.isEmpty()?h!==c&&d.push(this.model.getLineContent(h)):d.push(this.model.getValueInRange(u,i?2:0)),c=h}return d.length===1?d[0]:d}let l=[];for(let d of t)d.isEmpty()||l.push(this.model.getValueInRange(d,i?2:0));return l.length===1?l[0]:l}getRichTextToCopy(t,n){let i=this.model.getLanguageId();if(i===sr||t.length!==1)return null;let r=t[0];if(r.isEmpty()){if(!n)return null;let u=r.startLineNumber;r=new D(u,this.model.getLineMinColumn(u),u,this.model.getLineMaxColumn(u))}let s=this._configuration.options.get(51),a=this._getColorMap(),d=/[:;\\\/<>]/.test(s.fontFamily)||s.fontFamily===to.fontFamily,c;return d?c=to.fontFamily:(c=s.fontFamily,c=c.replace(/"/g,"'"),/[,']/.test(c)||/[+ ]/.test(c)&&(c=`'${c}'`),c=`${c}, ${to.fontFamily}`),{mode:i,html:`<div style="color: ${a[1]};background-color: ${a[2]};font-family: ${c};font-weight: ${s.fontWeight};font-size: ${s.fontSize}px;line-height: ${s.lineHeight}px;white-space: pre;">`+this._getHTMLToCopy(r,a)+"</div>"}}_getHTMLToCopy(t,n){let i=t.startLineNumber,r=t.startColumn,s=t.endLineNumber,a=t.endColumn,l=this.getTabSize(),d="";for(let c=i;c<=s;c++){let u=this.model.tokenization.getLineTokens(c),h=u.getLineContent(),m=c===i?r-1:0,f=c===s?a-1:h.length;h===""?d+="<br>":d+=ZP(h,u.inflate(),n,m,f,l,mt)}return d}_getColorMap(){let t=xo.getColorMap(),n=["#000000"];if(t)for(let i=1,r=t.length;i<r;i++)n[i]=N.Format.CSS.formatHex(t[i]);return n}getPrimaryCursorState(){return this._cursor.getPrimaryCursorState()}getLastAddedCursorIndex(){return this._cursor.getLastAddedCursorIndex()}getCursorStates(){return this._cursor.getCursorStates()}setCursorStates(t,n,i){return this._withViewEventsCollector(r=>this._cursor.setStates(r,t,n,i))}getCursorColumnSelectData(){return this._cursor.getCursorColumnSelectData()}getCursorAutoClosedCharacters(){return this._cursor.getAutoClosedCharacters()}setCursorColumnSelectData(t){this._cursor.setCursorColumnSelectData(t)}getPrevEditOperationType(){return this._cursor.getPrevEditOperationType()}setPrevEditOperationType(t){this._cursor.setPrevEditOperationType(t)}getSelection(){return this._cursor.getSelection()}getSelections(){return this._cursor.getSelections()}getPosition(){return this._cursor.getPrimaryCursorState().modelState.position}setSelections(t,n,i=0){this._withViewEventsCollector(r=>this._cursor.setSelections(r,t,n,i))}saveCursorState(){return this._cursor.saveState()}restoreCursorState(t){this._withViewEventsCollector(n=>this._cursor.restoreState(n,t))}_executeCursorEdit(t){if(this._cursor.context.cursorConfig.readOnly){this._eventDispatcher.emitOutgoingEvent(new cS);return}this._withViewEventsCollector(t)}executeEdits(t,n,i){this._executeCursorEdit(r=>this._cursor.executeEdits(r,t,n,i))}startComposition(){this._executeCursorEdit(t=>this._cursor.startComposition(t))}endComposition(t){this._executeCursorEdit(n=>this._cursor.endComposition(n,t))}type(t,n){this._executeCursorEdit(i=>this._cursor.type(i,t,n))}compositionType(t,n,i,r,s){this._executeCursorEdit(a=>this._cursor.compositionType(a,t,n,i,r,s))}paste(t,n,i,r){this._executeCursorEdit(s=>this._cursor.paste(s,t,n,i,r))}cut(t){this._executeCursorEdit(n=>this._cursor.cut(n,t))}executeCommand(t,n){this._executeCursorEdit(i=>this._cursor.executeCommand(i,t,n))}executeCommands(t,n){this._executeCursorEdit(i=>this._cursor.executeCommands(i,t,n))}revealAllCursors(t,n,i=!1){this._withViewEventsCollector(r=>this._cursor.revealAll(r,t,i,0,n,0))}revealPrimaryCursor(t,n,i=!1){this._withViewEventsCollector(r=>this._cursor.revealPrimary(r,t,i,0,n,0))}revealTopMostCursor(t){let n=this._cursor.getTopMostViewPosition(),i=new D(n.lineNumber,n.column,n.lineNumber,n.column);this._withViewEventsCollector(r=>r.emitViewEvent(new ma(t,!1,i,null,0,!0,0)))}revealBottomMostCursor(t){let n=this._cursor.getBottomMostViewPosition(),i=new D(n.lineNumber,n.column,n.lineNumber,n.column);this._withViewEventsCollector(r=>r.emitViewEvent(new ma(t,!1,i,null,0,!0,0)))}revealRange(t,n,i,r,s){this._withViewEventsCollector(a=>a.emitViewEvent(new ma(t,!1,i,null,r,n,s)))}changeWhitespace(t){this.viewLayout.changeWhitespace(t)&&(this._eventDispatcher.emitSingleViewEvent(new by),this._eventDispatcher.emitOutgoingEvent(new aS))}_withViewEventsCollector(t){return this._transactionalTarget.batchChanges(()=>{try{let n=this._eventDispatcher.beginEmitViewEvents();return t(n)}finally{this._eventDispatcher.endEmitViewEvents()}})}batchEvents(t){this._withViewEventsCollector(()=>{t()})}normalizePosition(t,n){return this._lines.normalizePosition(t,n)}getLineIndentColumn(t){return this._lines.getLineIndentColumn(t)}},r0=class o{constructor(e,t,n,i,r){this._model=e;this._viewLineNumber=t;this._isValid=n;this._modelTrackedRange=i;this._startLineDelta=r}static create(e){let t=e._setTrackedRange(null,new D(1,1,1,1),1);return new o(e,1,!1,t,0)}get viewLineNumber(){return this._viewLineNumber}get isValid(){return this._isValid}get modelTrackedRange(){return this._modelTrackedRange}get startLineDelta(){return this._startLineDelta}dispose(){this._model._setTrackedRange(this._modelTrackedRange,null,1)}update(e,t){let n=e.coordinatesConverter.convertViewPositionToModelPosition(new P(t,e.getLineMinColumn(t))),i=e.model._setTrackedRange(this._modelTrackedRange,new D(n.lineNumber,n.column,n.lineNumber,n.column),1),r=e.viewLayout.getVerticalOffsetForLineNumber(t),s=e.viewLayout.getCurrentScrollTop();this._viewLineNumber=t,this._isValid=!0,this._modelTrackedRange=i,this._startLineDelta=s-r}invalidate(){this._isValid=!1}},s0=class{_asMap=Object.create(null);asArray=[];accept(e,t,n,i,r){let s=this._asMap[e];if(s){let a=s.data,l=a[a.length-3],d=a[a.length-1];if(l===r&&d+1>=n){i>d&&(a[a.length-1]=i);return}a.push(r,n,i)}else{let a=new Kd(e,t,[r,n,i]);this._asMap[e]=a,this.asArray.push(a)}}},a0=class{hiddenAreas=new Map;shouldRecompute=!1;ranges=[];setHiddenAreas(e,t){let n=this.hiddenAreas.get(e);n&&JP(n,t)||(this.hiddenAreas.set(e,t),this.shouldRecompute=!0)}getMergedRanges(){if(!this.shouldRecompute)return this.ranges;this.shouldRecompute=!1;let e=Array.from(this.hiddenAreas.values()).reduce((t,n)=>aU(t,n),[]);return JP(this.ranges,e)?this.ranges:(this.ranges=e,this.ranges)}};function aU(o,e){let t=[],n=0,i=0;for(;n<o.length&&i<e.length;){let r=o[n],s=e[i];if(r.endLineNumber<s.startLineNumber-1)t.push(o[n++]);else if(s.endLineNumber<r.startLineNumber-1)t.push(e[i++]);else{let a=Math.min(r.startLineNumber,s.startLineNumber),l=Math.max(r.endLineNumber,s.endLineNumber);t.push(new D(a,1,l,1)),n++,i++}}for(;n<o.length;)t.push(o[n++]);for(;i<e.length;)t.push(e[i++]);return t}function JP(o,e){if(o.length!==e.length)return!1;for(let t=0;t<o.length;t++)if(!o[t].equalsRange(e[t]))return!1;return!0}var MS=class{constructor(e,t){this.viewportStartModelPosition=e;this.startLineDelta=t}recoverViewportStart(e,t){if(!this.viewportStartModelPosition)return;let n=e.convertModelPositionToViewPosition(this.viewportStartModelPosition),i=t.getVerticalOffsetForLineNumber(n.lineNumber);t.setScrollPosition({scrollTop:i+this.startLineDelta},1)}};var hr=class extends V{constructor(t,n,i,r,s,a,l,d,c,u,h,m){super();this.languageConfigurationService=h;s.willCreateCodeEditor();let f={...n};this._domElement=t,this._overflowWidgetsDomNode=f.overflowWidgetsDomNode,delete f.overflowWidgetsDomNode,this._id=++lU,this._decorationTypeKeysToIds={},this._decorationTypeSubtypes={},this._telemetryData=i.telemetryData,this._configuration=this._register(this._createConfiguration(i.isSimpleWidget||!1,i.contextMenuId??(i.isSimpleWidget?Ln.SimpleEditorContext:Ln.EditorContext),f,u)),this._register(this._configuration.onDidChange(y=>{this._onDidChangeConfiguration.fire(y);let C=this._configuration.options;if(y.hasChanged(147)){let x=C.get(147);this._onDidLayoutChange.fire(x)}})),this._contextKeyService=this._register(l.createScoped(this._domElement)),this._notificationService=c,this._codeEditorService=s,this._commandService=a,this._themeService=d,this._register(new c0(this,this._contextKeyService)),this._register(new u0(this,this._contextKeyService,m)),this._instantiationService=this._register(r.createChild(new ra([ft,this._contextKeyService]))),this._modelData=null,this._focusTracker=new h0(t,this._overflowWidgetsDomNode),this._register(this._focusTracker.onChange(()=>{this._editorWidgetFocus.setValue(this._focusTracker.hasFocus())})),this._contentWidgets={},this._overlayWidgets={},this._glyphMarginWidgets={};let g;Array.isArray(i.contributions)?g=i.contributions:g=yg.getEditorContributions(),this._contributions.initialize(this,g,this._instantiationService);for(let y of yg.getEditorActions()){if(this._actions.has(y.id)){je(new Error(`Cannot have two actions with the same id ${y.id}`));continue}let C=new tS(y.id,y.label,y.alias,y.metadata,y.precondition??void 0,x=>this._instantiationService.invokeFunction(L=>Promise.resolve(y.runEditorCommand(L,this,x))),this._contextKeyService);this._actions.set(C.id,C)}let b=()=>!this._configuration.options.get(93)&&this._configuration.options.get(36).enabled;this._register(new Sb(this._domElement,{onDragOver:y=>{if(!b())return;let C=this.getTargetAtClientPoint(y.clientX,y.clientY);C?.position&&this.showDropIndicatorAt(C.position)},onDrop:async y=>{if(!b()||(this.removeDropIndicator(),!y.dataTransfer))return;let C=this.getTargetAtClientPoint(y.clientX,y.clientY);C?.position&&this._onDropIntoEditor.fire({position:C.position,event:y})},onDragLeave:()=>{this.removeDropIndicator()},onDragEnd:()=>{this.removeDropIndicator()}})),this._codeEditorService.addCodeEditor(this)}static dropIntoEditorDecorationOptions=ao.register({description:"workbench-dnd-target",className:"dnd-target"});_deliveryQueue=hk();_contributions=this._register(new eS);_onDidDispose=this._register(new E);onDidDispose=this._onDidDispose.event;_onDidChangeModelContent=this._register(new E({deliveryQueue:this._deliveryQueue}));onDidChangeModelContent=this._onDidChangeModelContent.event;_onDidChangeModelLanguage=this._register(new E({deliveryQueue:this._deliveryQueue}));onDidChangeModelLanguage=this._onDidChangeModelLanguage.event;_onDidChangeModelLanguageConfiguration=this._register(new E({deliveryQueue:this._deliveryQueue}));onDidChangeModelLanguageConfiguration=this._onDidChangeModelLanguageConfiguration.event;_onDidChangeModelOptions=this._register(new E({deliveryQueue:this._deliveryQueue}));onDidChangeModelOptions=this._onDidChangeModelOptions.event;_onDidChangeModelDecorations=this._register(new E({deliveryQueue:this._deliveryQueue}));onDidChangeModelDecorations=this._onDidChangeModelDecorations.event;_onDidChangeModelTokens=this._register(new E({deliveryQueue:this._deliveryQueue}));onDidChangeModelTokens=this._onDidChangeModelTokens.event;_onDidChangeConfiguration=this._register(new E({deliveryQueue:this._deliveryQueue}));onDidChangeConfiguration=this._onDidChangeConfiguration.event;_onWillChangeModel=this._register(new E({deliveryQueue:this._deliveryQueue}));onWillChangeModel=this._onWillChangeModel.event;_onDidChangeModel=this._register(new E({deliveryQueue:this._deliveryQueue}));onDidChangeModel=this._onDidChangeModel.event;_onDidChangeCursorPosition=this._register(new E({deliveryQueue:this._deliveryQueue}));onDidChangeCursorPosition=this._onDidChangeCursorPosition.event;_onDidChangeCursorSelection=this._register(new E({deliveryQueue:this._deliveryQueue}));onDidChangeCursorSelection=this._onDidChangeCursorSelection.event;_onDidAttemptReadOnlyEdit=this._register(new jn(this._contributions,this._deliveryQueue));onDidAttemptReadOnlyEdit=this._onDidAttemptReadOnlyEdit.event;_onDidLayoutChange=this._register(new E({deliveryQueue:this._deliveryQueue}));onDidLayoutChange=this._onDidLayoutChange.event;_editorTextFocus=this._register(new AS({deliveryQueue:this._deliveryQueue}));onDidFocusEditorText=this._editorTextFocus.onDidChangeToTrue;onDidBlurEditorText=this._editorTextFocus.onDidChangeToFalse;_editorWidgetFocus=this._register(new AS({deliveryQueue:this._deliveryQueue}));onDidFocusEditorWidget=this._editorWidgetFocus.onDidChangeToTrue;onDidBlurEditorWidget=this._editorWidgetFocus.onDidChangeToFalse;_onWillType=this._register(new jn(this._contributions,this._deliveryQueue));onWillType=this._onWillType.event;_onDidType=this._register(new jn(this._contributions,this._deliveryQueue));onDidType=this._onDidType.event;_onDidCompositionStart=this._register(new jn(this._contributions,this._deliveryQueue));onDidCompositionStart=this._onDidCompositionStart.event;_onDidCompositionEnd=this._register(new jn(this._contributions,this._deliveryQueue));onDidCompositionEnd=this._onDidCompositionEnd.event;_onDidPaste=this._register(new jn(this._contributions,this._deliveryQueue));onDidPaste=this._onDidPaste.event;_onMouseUp=this._register(new jn(this._contributions,this._deliveryQueue));onMouseUp=this._onMouseUp.event;_onMouseDown=this._register(new jn(this._contributions,this._deliveryQueue));onMouseDown=this._onMouseDown.event;_onMouseDrag=this._register(new jn(this._contributions,this._deliveryQueue));onMouseDrag=this._onMouseDrag.event;_onMouseDrop=this._register(new jn(this._contributions,this._deliveryQueue));onMouseDrop=this._onMouseDrop.event;_onMouseDropCanceled=this._register(new jn(this._contributions,this._deliveryQueue));onMouseDropCanceled=this._onMouseDropCanceled.event;_onDropIntoEditor=this._register(new jn(this._contributions,this._deliveryQueue));onDropIntoEditor=this._onDropIntoEditor.event;_onContextMenu=this._register(new jn(this._contributions,this._deliveryQueue));onContextMenu=this._onContextMenu.event;_onMouseMove=this._register(new jn(this._contributions,this._deliveryQueue));onMouseMove=this._onMouseMove.event;_onMouseLeave=this._register(new jn(this._contributions,this._deliveryQueue));onMouseLeave=this._onMouseLeave.event;_onMouseWheel=this._register(new jn(this._contributions,this._deliveryQueue));onMouseWheel=this._onMouseWheel.event;_onKeyUp=this._register(new jn(this._contributions,this._deliveryQueue));onKeyUp=this._onKeyUp.event;_onKeyDown=this._register(new jn(this._contributions,this._deliveryQueue));onKeyDown=this._onKeyDown.event;_onDidContentSizeChange=this._register(new E({deliveryQueue:this._deliveryQueue}));onDidContentSizeChange=this._onDidContentSizeChange.event;_onDidScrollChange=this._register(new E({deliveryQueue:this._deliveryQueue}));onDidScrollChange=this._onDidScrollChange.event;_onDidChangeViewZones=this._register(new E({deliveryQueue:this._deliveryQueue}));onDidChangeViewZones=this._onDidChangeViewZones.event;_onDidChangeHiddenAreas=this._register(new E({deliveryQueue:this._deliveryQueue}));onDidChangeHiddenAreas=this._onDidChangeHiddenAreas.event;_updateCounter=0;_onBeginUpdate=this._register(new E);onBeginUpdate=this._onBeginUpdate.event;_onEndUpdate=this._register(new E);onEndUpdate=this._onEndUpdate.event;get isSimpleWidget(){return this._configuration.isSimpleWidget}get contextMenuId(){return this._configuration.contextMenuId}_telemetryData;_domElement;_overflowWidgetsDomNode;_id;_configuration;_contributionsDisposable;_actions=new Map;_modelData;_instantiationService;_contextKeyService;get contextKeyService(){return this._contextKeyService}_notificationService;_codeEditorService;_commandService;_themeService;_focusTracker;_contentWidgets;_overlayWidgets;_glyphMarginWidgets;_decorationTypeKeysToIds;_decorationTypeSubtypes;_bannerDomNode=null;_dropIntoEditorDecorations=this.createDecorationsCollection();writeScreenReaderContent(t){this._modelData?.view.writeScreenReaderContent(t)}_createConfiguration(t,n,i,r){return new fu(t,n,i,this._domElement,r)}getId(){return this.getEditorType()+":"+this._id}getEditorType(){return nT.ICodeEditor}dispose(){this._codeEditorService.removeCodeEditor(this),this._focusTracker.dispose(),this._actions.clear(),this._contentWidgets={},this._overlayWidgets={},this._removeDecorationTypes(),this._postDetachModelCleanup(this._detachModel()),this._onDidDispose.fire(),super.dispose()}invokeWithinContext(t){return this._instantiationService.invokeFunction(t)}updateOptions(t){this._configuration.updateOptions(t||{})}getOptions(){return this._configuration.options}getOption(t){return this._configuration.options.get(t)}getRawOptions(){return this._configuration.getRawOptions()}getOverflowWidgetsDomNode(){return this._overflowWidgetsDomNode}getConfiguredWordAtPosition(t){return this._modelData?Lh.getWordAtPosition(this._modelData.model,this._configuration.options.get(133),this._configuration.options.get(132),t):null}getValue(t=null){if(!this._modelData)return"";let n=!!(t&&t.preserveBOM),i=0;return t&&t.lineEnding&&t.lineEnding===`
`?i=1:t&&t.lineEnding&&t.lineEnding===`\r
`&&(i=2),this._modelData.model.getValue(i,n)}setValue(t){try{if(this._beginUpdate(),!this._modelData)return;this._modelData.model.setValue(t)}finally{this._endUpdate()}}getModel(){return this._modelData?this._modelData.model:null}setModel(t=null){try{this._beginUpdate();let n=t;if(this._modelData===null&&n===null||this._modelData&&this._modelData.model===n)return;let i={oldModelUrl:this._modelData?.model.uri||null,newModelUrl:n?.uri||null};this._onWillChangeModel.fire(i);let r=this.hasTextFocus(),s=this._detachModel();this._attachModel(n),r&&this.hasModel()&&this.focus(),this._removeDecorationTypes(),this._onDidChangeModel.fire(i),this._postDetachModelCleanup(s),this._contributionsDisposable=this._contributions.onAfterModelAttached()}finally{this._endUpdate()}}_removeDecorationTypes(){if(this._decorationTypeKeysToIds={},this._decorationTypeSubtypes){for(let t in this._decorationTypeSubtypes){let n=this._decorationTypeSubtypes[t];for(let i in n)this._removeDecorationType(t+"-"+i)}this._decorationTypeSubtypes={}}}getVisibleRanges(){return this._modelData?this._modelData.viewModel.getVisibleRanges():[]}getVisibleRangesPlusViewportAboveBelow(){return this._modelData?this._modelData.viewModel.getVisibleRangesPlusViewportAboveBelow():[]}getWhitespaces(){return this._modelData?this._modelData.viewModel.viewLayout.getWhitespaces():[]}static _getVerticalOffsetAfterPosition(t,n,i,r){let s=t.model.validatePosition({lineNumber:n,column:i}),a=t.viewModel.coordinatesConverter.convertModelPositionToViewPosition(s);return t.viewModel.viewLayout.getVerticalOffsetAfterLineNumber(a.lineNumber,r)}getTopForLineNumber(t,n=!1){return this._modelData?hr._getVerticalOffsetForPosition(this._modelData,t,1,n):-1}getTopForPosition(t,n){return this._modelData?hr._getVerticalOffsetForPosition(this._modelData,t,n,!1):-1}static _getVerticalOffsetForPosition(t,n,i,r=!1){let s=t.model.validatePosition({lineNumber:n,column:i}),a=t.viewModel.coordinatesConverter.convertModelPositionToViewPosition(s);return t.viewModel.viewLayout.getVerticalOffsetForLineNumber(a.lineNumber,r)}getBottomForLineNumber(t,n=!1){if(!this._modelData)return-1;let i=this._modelData.model.getLineMaxColumn(t);return hr._getVerticalOffsetAfterPosition(this._modelData,t,i,n)}setHiddenAreas(t,n){this._modelData?.viewModel.setHiddenAreas(t.map(i=>D.lift(i)),n)}getVisibleColumnFromPosition(t){if(!this._modelData)return t.column;let n=this._modelData.model.validatePosition(t),i=this._modelData.model.getOptions().tabSize;return _t.visibleColumnFromColumn(this._modelData.model.getLineContent(n.lineNumber),n.column,i)+1}getStatusbarColumn(t){if(!this._modelData)return t.column;let n=this._modelData.model.validatePosition(t),i=this._modelData.model.getOptions().tabSize;return _t.toStatusbarColumn(this._modelData.model.getLineContent(n.lineNumber),n.column,i)}getPosition(){return this._modelData?this._modelData.viewModel.getPosition():null}setPosition(t,n="api"){if(this._modelData){if(!P.isIPosition(t))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(n,[{selectionStartLineNumber:t.lineNumber,selectionStartColumn:t.column,positionLineNumber:t.lineNumber,positionColumn:t.column}])}}_sendRevealRange(t,n,i,r){if(!this._modelData)return;if(!D.isIRange(t))throw new Error("Invalid arguments");let s=this._modelData.model.validateRange(t),a=this._modelData.viewModel.coordinatesConverter.convertModelRangeToViewRange(s);this._modelData.viewModel.revealRange("api",i,a,n,r)}revealLine(t,n=0){this._revealLine(t,0,n)}revealLineInCenter(t,n=0){this._revealLine(t,1,n)}revealLineInCenterIfOutsideViewport(t,n=0){this._revealLine(t,2,n)}revealLineNearTop(t,n=0){this._revealLine(t,5,n)}_revealLine(t,n,i){if(typeof t!="number")throw new Error("Invalid arguments");this._sendRevealRange(new D(t,1,t,1),n,!1,i)}revealPosition(t,n=0){this._revealPosition(t,0,!0,n)}revealPositionInCenter(t,n=0){this._revealPosition(t,1,!0,n)}revealPositionInCenterIfOutsideViewport(t,n=0){this._revealPosition(t,2,!0,n)}revealPositionNearTop(t,n=0){this._revealPosition(t,5,!0,n)}_revealPosition(t,n,i,r){if(!P.isIPosition(t))throw new Error("Invalid arguments");this._sendRevealRange(new D(t.lineNumber,t.column,t.lineNumber,t.column),n,i,r)}getSelection(){return this._modelData?this._modelData.viewModel.getSelection():null}getSelections(){return this._modelData?this._modelData.viewModel.getSelections():null}setSelection(t,n="api"){let i=He.isISelection(t),r=D.isIRange(t);if(!i&&!r)throw new Error("Invalid arguments");if(i)this._setSelectionImpl(t,n);else if(r){let s={selectionStartLineNumber:t.startLineNumber,selectionStartColumn:t.startColumn,positionLineNumber:t.endLineNumber,positionColumn:t.endColumn};this._setSelectionImpl(s,n)}}_setSelectionImpl(t,n){if(!this._modelData)return;let i=new He(t.selectionStartLineNumber,t.selectionStartColumn,t.positionLineNumber,t.positionColumn);this._modelData.viewModel.setSelections(n,[i])}revealLines(t,n,i=0){this._revealLines(t,n,0,i)}revealLinesInCenter(t,n,i=0){this._revealLines(t,n,1,i)}revealLinesInCenterIfOutsideViewport(t,n,i=0){this._revealLines(t,n,2,i)}revealLinesNearTop(t,n,i=0){this._revealLines(t,n,5,i)}_revealLines(t,n,i,r){if(typeof t!="number"||typeof n!="number")throw new Error("Invalid arguments");this._sendRevealRange(new D(t,1,n,1),i,!1,r)}revealRange(t,n=0,i=!1,r=!0){this._revealRange(t,i?1:0,r,n)}revealRangeInCenter(t,n=0){this._revealRange(t,1,!0,n)}revealRangeInCenterIfOutsideViewport(t,n=0){this._revealRange(t,2,!0,n)}revealRangeNearTop(t,n=0){this._revealRange(t,5,!0,n)}revealRangeNearTopIfOutsideViewport(t,n=0){this._revealRange(t,6,!0,n)}revealRangeAtTop(t,n=0){this._revealRange(t,3,!0,n)}_revealRange(t,n,i,r){if(!D.isIRange(t))throw new Error("Invalid arguments");this._sendRevealRange(D.lift(t),n,i,r)}setSelections(t,n="api",i=0){if(this._modelData){if(!t||t.length===0)throw new Error("Invalid arguments");for(let r=0,s=t.length;r<s;r++)if(!He.isISelection(t[r]))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(n,t,i)}}getContentWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getContentWidth():-1}getScrollWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollWidth():-1}getScrollLeft(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollLeft():-1}getContentHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getContentHeight():-1}getScrollHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollHeight():-1}getScrollTop(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollTop():-1}setScrollLeft(t,n=1){if(this._modelData){if(typeof t!="number")throw new Error("Invalid arguments");this._modelData.viewModel.viewLayout.setScrollPosition({scrollLeft:t},n)}}setScrollTop(t,n=1){if(this._modelData){if(typeof t!="number")throw new Error("Invalid arguments");this._modelData.viewModel.viewLayout.setScrollPosition({scrollTop:t},n)}}setScrollPosition(t,n=1){this._modelData&&this._modelData.viewModel.viewLayout.setScrollPosition(t,n)}hasPendingScrollAnimation(){return this._modelData?this._modelData.viewModel.viewLayout.hasPendingScrollAnimation():!1}saveViewState(){if(!this._modelData)return null;let t=this._contributions.saveViewState(),n=this._modelData.viewModel.saveCursorState(),i=this._modelData.viewModel.saveState();return{cursorState:n,viewState:i,contributionsState:t}}restoreViewState(t){if(!this._modelData||!this._modelData.hasRealView)return;let n=t;if(n&&n.cursorState&&n.viewState){let i=n.cursorState;Array.isArray(i)?i.length>0&&this._modelData.viewModel.restoreCursorState(i):this._modelData.viewModel.restoreCursorState([i]),this._contributions.restoreViewState(n.contributionsState||{});let r=this._modelData.viewModel.reduceRestoreState(n.viewState);this._modelData.view.restoreState(r)}}handleInitialized(){this._getViewModel()?.visibleLinesStabilized()}onVisible(){this._modelData?.view.refreshFocusState()}onHide(){this._modelData?.view.refreshFocusState(),this._focusTracker.refreshState()}getContribution(t){return this._contributions.get(t)}getActions(){return Array.from(this._actions.values())}getSupportedActions(){let t=this.getActions();return t=t.filter(n=>n.isSupported()),t}getAction(t){return this._actions.get(t)||null}trigger(t,n,i){i=i||{};try{switch(this._beginUpdate(),n){case"compositionStart":this._startComposition();return;case"compositionEnd":this._endComposition(t);return;case"type":{let s=i;this._type(t,s.text||"");return}case"replacePreviousChar":{let s=i;this._compositionType(t,s.text||"",s.replaceCharCnt||0,0,0);return}case"compositionType":{let s=i;this._compositionType(t,s.text||"",s.replacePrevCharCnt||0,s.replaceNextCharCnt||0,s.positionDelta||0);return}case"paste":{let s=i;this._paste(t,s.text||"",s.pasteOnNewLine||!1,s.multicursorText||null,s.mode||null,s.clipboardEvent);return}case"cut":this._cut(t);return}let r=this.getAction(n);if(r){Promise.resolve(r.run(i)).then(void 0,je);return}if(!this._modelData||this._triggerEditorCommand(t,n,i))return;this._triggerCommand(n,i)}finally{this._endUpdate()}}_triggerCommand(t,n){this._commandService.executeCommand(t,n)}_startComposition(){this._modelData&&(this._modelData.viewModel.startComposition(),this._onDidCompositionStart.fire())}_endComposition(t){this._modelData&&(this._modelData.viewModel.endComposition(t),this._onDidCompositionEnd.fire())}_type(t,n){!this._modelData||n.length===0||(t==="keyboard"&&this._onWillType.fire(n),this._modelData.viewModel.type(n,t),t==="keyboard"&&this._onDidType.fire(n))}_compositionType(t,n,i,r,s){this._modelData&&this._modelData.viewModel.compositionType(n,i,r,s,t)}_paste(t,n,i,r,s,a){if(!this._modelData)return;let l=this._modelData.viewModel,d=l.getSelection().getStartPosition();l.paste(n,i,r,t);let c=l.getSelection().getStartPosition();t==="keyboard"&&this._onDidPaste.fire({clipboardEvent:a,range:new D(d.lineNumber,d.column,c.lineNumber,c.column),languageId:s})}_cut(t){this._modelData&&this._modelData.viewModel.cut(t)}_triggerEditorCommand(t,n,i){let r=yg.getEditorCommand(n);return r?(i=i||{},i.source=t,this._instantiationService.invokeFunction(s=>{Promise.resolve(r.runEditorCommand(s,this,i)).then(void 0,je)}),!0):!1}_getViewModel(){return this._modelData?this._modelData.viewModel:null}pushUndoStop(){return!this._modelData||this._configuration.options.get(93)?!1:(this._modelData.model.pushStackElement(),!0)}popUndoStop(){return!this._modelData||this._configuration.options.get(93)?!1:(this._modelData.model.popStackElement(),!0)}executeEdits(t,n,i){if(!this._modelData||this._configuration.options.get(93))return!1;let r;return i?Array.isArray(i)?r=()=>i:r=i:r=()=>null,this._modelData.viewModel.executeEdits(t,n,r),!0}executeCommand(t,n){this._modelData&&this._modelData.viewModel.executeCommand(n,t)}executeCommands(t,n){this._modelData&&this._modelData.viewModel.executeCommands(n,t)}createDecorationsCollection(t){return new p0(this,t)}changeDecorations(t){return this._modelData?this._modelData.model.changeDecorations(t,this._id):null}getLineDecorations(t){return this._modelData?this._modelData.model.getLineDecorations(t,this._id,Ld(this._configuration.options)):null}getDecorationsInRange(t){return this._modelData?this._modelData.model.getDecorationsInRange(t,this._id,Ld(this._configuration.options)):null}deltaDecorations(t,n){return this._modelData?t.length===0&&n.length===0?t:this._modelData.model.deltaDecorations(t,n,this._id):[]}removeDecorations(t){!this._modelData||t.length===0||this._modelData.model.changeDecorations(n=>{n.deltaDecorations(t,[])})}setDecorationsByType(t,n,i){let r={},s=this._decorationTypeSubtypes[n]||{};this._decorationTypeSubtypes[n]=r;let a=[];for(let d of i){let c=n;if(d.renderOptions){let h=cs(d.renderOptions).toString(16);c=n+"-"+h,!s[h]&&!r[h]&&this._registerDecorationType(t,c,d.renderOptions,n),r[h]=!0}let u=this._resolveDecorationOptions(c,!!d.hoverMessage);d.hoverMessage&&(u.hoverMessage=d.hoverMessage),a.push({range:d.range,options:u})}for(let d in s)r[d]||this._removeDecorationType(n+"-"+d);let l=this._decorationTypeKeysToIds[n]||[];this.changeDecorations(d=>this._decorationTypeKeysToIds[n]=d.deltaDecorations(l,a))}setDecorationsByTypeFast(t,n){let i=this._decorationTypeSubtypes[t]||{};for(let l in i)this._removeDecorationType(t+"-"+l);this._decorationTypeSubtypes[t]={};let r=ao.createDynamic(this._resolveDecorationOptions(t,!1)),s=new Array(n.length);for(let l=0,d=n.length;l<d;l++)s[l]={range:n[l],options:r};let a=this._decorationTypeKeysToIds[t]||[];this.changeDecorations(l=>this._decorationTypeKeysToIds[t]=l.deltaDecorations(a,s))}removeDecorationsByType(t){let n=this._decorationTypeKeysToIds[t];n&&this.changeDecorations(i=>i.deltaDecorations(n,[])),this._decorationTypeKeysToIds.hasOwnProperty(t)&&delete this._decorationTypeKeysToIds[t],this._decorationTypeSubtypes.hasOwnProperty(t)&&delete this._decorationTypeSubtypes[t]}getLayoutInfo(){return this._configuration.options.get(147)}createOverviewRuler(t){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.createOverviewRuler(t)}getContainerDomNode(){return this._domElement}getDomNode(){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.domNode.domNode}delegateVerticalScrollbarPointerDown(t){!this._modelData||!this._modelData.hasRealView||this._modelData.view.delegateVerticalScrollbarPointerDown(t)}delegateScrollFromMouseWheelEvent(t){!this._modelData||!this._modelData.hasRealView||this._modelData.view.delegateScrollFromMouseWheelEvent(t)}layout(t,n=!1){this._configuration.observeContainer(t),n||this.render()}focus(){!this._modelData||!this._modelData.hasRealView||this._modelData.view.focus()}hasTextFocus(){return!this._modelData||!this._modelData.hasRealView?!1:this._modelData.view.isFocused()}hasWidgetFocus(){return this._focusTracker&&this._focusTracker.hasFocus()}addContentWidget(t){let n={widget:t,position:t.getPosition()};this._contentWidgets.hasOwnProperty(t.getId())&&console.warn("Overwriting a content widget with the same id:"+t.getId()),this._contentWidgets[t.getId()]=n,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addContentWidget(n)}layoutContentWidget(t){let n=t.getId();if(this._contentWidgets.hasOwnProperty(n)){let i=this._contentWidgets[n];i.position=t.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutContentWidget(i)}}removeContentWidget(t){let n=t.getId();if(this._contentWidgets.hasOwnProperty(n)){let i=this._contentWidgets[n];delete this._contentWidgets[n],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeContentWidget(i)}}addOverlayWidget(t){let n={widget:t,position:t.getPosition()};this._overlayWidgets.hasOwnProperty(t.getId())&&console.warn("Overwriting an overlay widget with the same id."),this._overlayWidgets[t.getId()]=n,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addOverlayWidget(n)}layoutOverlayWidget(t){let n=t.getId();if(this._overlayWidgets.hasOwnProperty(n)){let i=this._overlayWidgets[n];i.position=t.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutOverlayWidget(i)}}removeOverlayWidget(t){let n=t.getId();if(this._overlayWidgets.hasOwnProperty(n)){let i=this._overlayWidgets[n];delete this._overlayWidgets[n],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeOverlayWidget(i)}}addGlyphMarginWidget(t){let n={widget:t,position:t.getPosition()};this._glyphMarginWidgets.hasOwnProperty(t.getId())&&console.warn("Overwriting a glyph margin widget with the same id."),this._glyphMarginWidgets[t.getId()]=n,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addGlyphMarginWidget(n)}layoutGlyphMarginWidget(t){let n=t.getId();if(this._glyphMarginWidgets.hasOwnProperty(n)){let i=this._glyphMarginWidgets[n];i.position=t.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutGlyphMarginWidget(i)}}removeGlyphMarginWidget(t){let n=t.getId();if(this._glyphMarginWidgets.hasOwnProperty(n)){let i=this._glyphMarginWidgets[n];delete this._glyphMarginWidgets[n],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeGlyphMarginWidget(i)}}changeViewZones(t){!this._modelData||!this._modelData.hasRealView||this._modelData.view.change(t)}getTargetAtClientPoint(t,n){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.getTargetAtClientPoint(t,n)}getScrolledVisiblePosition(t){if(!this._modelData||!this._modelData.hasRealView)return null;let n=this._modelData.model.validatePosition(t),i=this._configuration.options,r=i.get(147),s=hr._getVerticalOffsetForPosition(this._modelData,n.lineNumber,n.column)-this.getScrollTop(),a=this._modelData.view.getOffsetForColumn(n.lineNumber,n.column)+r.glyphMarginWidth+r.lineNumbersWidth+r.decorationsWidth-this.getScrollLeft();return{top:s,left:a,height:i.get(68)}}getOffsetForColumn(t,n){return!this._modelData||!this._modelData.hasRealView?-1:this._modelData.view.getOffsetForColumn(t,n)}render(t=!1){!this._modelData||!this._modelData.hasRealView||this._modelData.viewModel.batchEvents(()=>{this._modelData.view.render(!0,t)})}setAriaOptions(t){!this._modelData||!this._modelData.hasRealView||this._modelData.view.setAriaOptions(t)}applyFontInfo(t){ln(t,this._configuration.options.get(51))}setBanner(t,n){this._bannerDomNode&&this._domElement.contains(this._bannerDomNode)&&this._bannerDomNode.remove(),this._bannerDomNode=t,this._configuration.setReservedHeight(t?n:0),this._bannerDomNode&&this._domElement.prepend(this._bannerDomNode)}_attachModel(t){if(!t){this._modelData=null;return}let n=[];this._domElement.setAttribute("data-mode-id",t.getLanguageId()),this._configuration.setIsDominatedByLongLines(t.isDominatedByLongLines()),this._configuration.setModelLineCount(t.getLineCount());let i=t.onBeforeAttached(),r=new RS(this._id,this._configuration,t,JC.create(Ie(this._domElement)),nS.create(this._configuration.options),l=>Fn(Ie(this._domElement),l),this.languageConfigurationService,this._themeService,i,{batchChanges:l=>{try{return this._beginUpdate(),l()}finally{this._endUpdate()}}});n.push(t.onWillDispose(()=>this.setModel(null))),n.push(r.onEvent(l=>{switch(l.kind){case 0:this._onDidContentSizeChange.fire(l);break;case 1:this._editorTextFocus.setValue(l.hasFocus);break;case 2:this._onDidScrollChange.fire(l);break;case 3:this._onDidChangeViewZones.fire();break;case 4:this._onDidChangeHiddenAreas.fire();break;case 5:this._onDidAttemptReadOnlyEdit.fire();break;case 6:{if(l.reachedMaxCursorCount){let h=this.getOption(81),m=p("cursors.maximum","The number of cursors has been limited to {0}. Consider using [find and replace](https://code.visualstudio.com/docs/editor/codebasics#_find-and-replace) for larger changes or increase the editor multi cursor limit setting.",h);this._notificationService.prompt(mI.Warning,m,[{label:"Find and Replace",run:()=>{this._commandService.executeCommand("editor.action.startFindReplaceAction")}},{label:p("goToSetting","Increase Multi Cursor Limit"),run:()=>{this._commandService.executeCommand("workbench.action.openSettings2",{query:"editor.multiCursorLimit"})}}])}let d=[];for(let h=0,m=l.selections.length;h<m;h++)d[h]=l.selections[h].getPosition();let c={position:d[0],secondaryPositions:d.slice(1),reason:l.reason,source:l.source};this._onDidChangeCursorPosition.fire(c);let u={selection:l.selections[0],secondarySelections:l.selections.slice(1),modelVersionId:l.modelVersionId,oldSelections:l.oldSelections,oldModelVersionId:l.oldModelVersionId,source:l.source,reason:l.reason};this._onDidChangeCursorSelection.fire(u);break}case 7:this._onDidChangeModelDecorations.fire(l.event);break;case 8:this._domElement.setAttribute("data-mode-id",t.getLanguageId()),this._onDidChangeModelLanguage.fire(l.event);break;case 9:this._onDidChangeModelLanguageConfiguration.fire(l.event);break;case 10:this._onDidChangeModelContent.fire(l.event);break;case 11:this._onDidChangeModelOptions.fire(l.event);break;case 12:this._onDidChangeModelTokens.fire(l.event);break}}));let[s,a]=this._createView(r);if(a){this._domElement.appendChild(s.domNode.domNode);let l=Object.keys(this._contentWidgets);for(let d=0,c=l.length;d<c;d++){let u=l[d];s.addContentWidget(this._contentWidgets[u])}l=Object.keys(this._overlayWidgets);for(let d=0,c=l.length;d<c;d++){let u=l[d];s.addOverlayWidget(this._overlayWidgets[u])}l=Object.keys(this._glyphMarginWidgets);for(let d=0,c=l.length;d<c;d++){let u=l[d];s.addGlyphMarginWidget(this._glyphMarginWidgets[u])}s.render(!1,!0),s.domNode.domNode.setAttribute("data-uri",t.uri.toString())}this._modelData=new d0(t,r,s,a,n,i)}_createView(t){let n;this.isSimpleWidget?n={paste:(s,a,l,d)=>{this._paste("keyboard",s,a,l,d)},type:s=>{this._type("keyboard",s)},compositionType:(s,a,l,d)=>{this._compositionType("keyboard",s,a,l,d)},startComposition:()=>{this._startComposition()},endComposition:()=>{this._endComposition("keyboard")},cut:()=>{this._cut("keyboard")}}:n={paste:(s,a,l,d)=>{let c={text:s,pasteOnNewLine:a,multicursorText:l,mode:d};this._commandService.executeCommand("paste",c)},type:s=>{let a={text:s};this._commandService.executeCommand("type",a)},compositionType:(s,a,l,d)=>{if(l||d){let c={text:s,replacePrevCharCnt:a,replaceNextCharCnt:l,positionDelta:d};this._commandService.executeCommand("compositionType",c)}else{let c={text:s,replaceCharCnt:a};this._commandService.executeCommand("replacePreviousChar",c)}},startComposition:()=>{this._commandService.executeCommand("compositionStart",{})},endComposition:()=>{this._commandService.executeCommand("compositionEnd",{})},cut:()=>{this._commandService.executeCommand("cut",{})}};let i=new Ph(t.coordinatesConverter);return i.onKeyDown=s=>this._onKeyDown.fire(s),i.onKeyUp=s=>this._onKeyUp.fire(s),i.onContextMenu=s=>this._onContextMenu.fire(s),i.onMouseMove=s=>this._onMouseMove.fire(s),i.onMouseLeave=s=>this._onMouseLeave.fire(s),i.onMouseDown=s=>this._onMouseDown.fire(s),i.onMouseUp=s=>this._onMouseUp.fire(s),i.onMouseDrag=s=>this._onMouseDrag.fire(s),i.onMouseDrop=s=>this._onMouseDrop.fire(s),i.onMouseDropCanceled=s=>this._onMouseDropCanceled.fire(s),i.onMouseWheel=s=>this._onMouseWheel.fire(s),[new Qh(n,this._configuration,this._themeService.getColorTheme(),t,i,this._overflowWidgetsDomNode,this._instantiationService),!0]}_postDetachModelCleanup(t){t?.removeAllDecorationsWithOwnerId(this._id)}_detachModel(){if(this._contributionsDisposable?.dispose(),this._contributionsDisposable=void 0,!this._modelData)return null;let t=this._modelData.model,n=this._modelData.hasRealView?this._modelData.view.domNode.domNode:null;return this._modelData.dispose(),this._modelData=null,this._domElement.removeAttribute("data-mode-id"),n&&this._domElement.contains(n)&&n.remove(),this._bannerDomNode&&this._domElement.contains(this._bannerDomNode)&&this._bannerDomNode.remove(),t}_registerDecorationType(t,n,i,r){this._codeEditorService.registerDecorationType(t,n,i,r,this)}_removeDecorationType(t){this._codeEditorService.removeDecorationType(t)}_resolveDecorationOptions(t,n){return this._codeEditorService.resolveDecorationOptions(t,n)}getTelemetryData(){return this._telemetryData}hasModel(){return this._modelData!==null}showDropIndicatorAt(t){let n=[{range:new D(t.lineNumber,t.column,t.lineNumber,t.column),options:hr.dropIntoEditorDecorationOptions}];this._dropIntoEditorDecorations.set(n),this.revealPosition(t,1)}removeDropIndicator(){this._dropIntoEditorDecorations.clear()}setContextValue(t,n){this._contextKeyService.createKey(t,n)}_beginUpdate(){this._updateCounter++,this._updateCounter===1&&this._onBeginUpdate.fire()}_endUpdate(){this._updateCounter--,this._updateCounter===0&&this._onEndUpdate.fire()}};hr=R([S(3,ct),S(4,Nl),S(5,or),S(6,ft),S(7,bi),S(8,Jd),S(9,Co),S(10,ca),S(11,$P)],hr);var lU=0,d0=class{constructor(e,t,n,i,r,s){this.model=e;this.viewModel=t;this.view=n;this.hasRealView=i;this.listenersToRemove=r;this.attachedView=s}dispose(){kt(this.listenersToRemove),this.model.onBeforeDetached(this.attachedView),this.hasRealView&&this.view.dispose(),this.viewModel.dispose()}};var AS=class extends V{constructor(t){super();this._emitterOptions=t;this._value=0}_onDidChangeToTrue=this._register(new E(this._emitterOptions));onDidChangeToTrue=this._onDidChangeToTrue.event;_onDidChangeToFalse=this._register(new E(this._emitterOptions));onDidChangeToFalse=this._onDidChangeToFalse.event;_value;setValue(t){let n=t?2:1;this._value!==n&&(this._value=n,this._value===2?this._onDidChangeToTrue.fire():this._value===1&&this._onDidChangeToFalse.fire())}},jn=class extends E{constructor(t,n){super({deliveryQueue:n});this._contributions=t}fire(t){this._contributions.onBeforeInteractionEvent(),super.fire(t)}},c0=class extends V{_editor;_editorSimpleInput;_editorFocus;_textInputFocus;_editorTextFocus;_tabMovesFocus;_editorReadonly;_inDiffEditor;_editorColumnSelection;_hasMultipleSelections;_hasNonEmptySelection;_canUndo;_canRedo;constructor(e,t){super(),this._editor=e,t.createKey("editorId",e.getId()),this._editorSimpleInput=ye.editorSimpleInput.bindTo(t),this._editorFocus=ye.focus.bindTo(t),this._textInputFocus=ye.textInputFocus.bindTo(t),this._editorTextFocus=ye.editorTextFocus.bindTo(t),this._tabMovesFocus=ye.tabMovesFocus.bindTo(t),this._editorReadonly=ye.readOnly.bindTo(t),this._inDiffEditor=ye.inDiffEditor.bindTo(t),this._editorColumnSelection=ye.columnSelection.bindTo(t),this._hasMultipleSelections=ye.hasMultipleSelections.bindTo(t),this._hasNonEmptySelection=ye.hasNonEmptySelection.bindTo(t),this._canUndo=ye.canUndo.bindTo(t),this._canRedo=ye.canRedo.bindTo(t),this._register(this._editor.onDidChangeConfiguration(()=>this._updateFromConfig())),this._register(this._editor.onDidChangeCursorSelection(()=>this._updateFromSelection())),this._register(this._editor.onDidFocusEditorWidget(()=>this._updateFromFocus())),this._register(this._editor.onDidBlurEditorWidget(()=>this._updateFromFocus())),this._register(this._editor.onDidFocusEditorText(()=>this._updateFromFocus())),this._register(this._editor.onDidBlurEditorText(()=>this._updateFromFocus())),this._register(this._editor.onDidChangeModel(()=>this._updateFromModel())),this._register(this._editor.onDidChangeConfiguration(()=>this._updateFromModel())),this._register(mu.onDidChangeTabFocus(n=>this._tabMovesFocus.set(n))),this._updateFromConfig(),this._updateFromSelection(),this._updateFromFocus(),this._updateFromModel(),this._editorSimpleInput.set(this._editor.isSimpleWidget)}_updateFromConfig(){let e=this._editor.getOptions();this._tabMovesFocus.set(mu.getTabFocusMode()),this._editorReadonly.set(e.get(93)),this._inDiffEditor.set(e.get(62)),this._editorColumnSelection.set(e.get(22))}_updateFromSelection(){let e=this._editor.getSelections();e?(this._hasMultipleSelections.set(e.length>1),this._hasNonEmptySelection.set(e.some(t=>!t.isEmpty()))):(this._hasMultipleSelections.reset(),this._hasNonEmptySelection.reset())}_updateFromFocus(){this._editorFocus.set(this._editor.hasWidgetFocus()&&!this._editor.isSimpleWidget),this._editorTextFocus.set(this._editor.hasTextFocus()&&!this._editor.isSimpleWidget),this._textInputFocus.set(this._editor.hasTextFocus())}_updateFromModel(){let e=this._editor.getModel();this._canUndo.set(!!(e&&e.canUndo())),this._canRedo.set(!!(e&&e.canRedo()))}},u0=class extends V{constructor(t,n,i){super();this._editor=t;this._contextKeyService=n;this._languageFeaturesService=i;this._langId=ye.languageId.bindTo(n),this._hasCompletionItemProvider=ye.hasCompletionItemProvider.bindTo(n),this._hasCodeActionsProvider=ye.hasCodeActionsProvider.bindTo(n),this._hasCodeLensProvider=ye.hasCodeLensProvider.bindTo(n),this._hasDefinitionProvider=ye.hasDefinitionProvider.bindTo(n),this._hasDeclarationProvider=ye.hasDeclarationProvider.bindTo(n),this._hasImplementationProvider=ye.hasImplementationProvider.bindTo(n),this._hasTypeDefinitionProvider=ye.hasTypeDefinitionProvider.bindTo(n),this._hasHoverProvider=ye.hasHoverProvider.bindTo(n),this._hasDocumentHighlightProvider=ye.hasDocumentHighlightProvider.bindTo(n),this._hasDocumentSymbolProvider=ye.hasDocumentSymbolProvider.bindTo(n),this._hasReferenceProvider=ye.hasReferenceProvider.bindTo(n),this._hasRenameProvider=ye.hasRenameProvider.bindTo(n),this._hasSignatureHelpProvider=ye.hasSignatureHelpProvider.bindTo(n),this._hasInlayHintsProvider=ye.hasInlayHintsProvider.bindTo(n),this._hasDocumentFormattingProvider=ye.hasDocumentFormattingProvider.bindTo(n),this._hasDocumentSelectionFormattingProvider=ye.hasDocumentSelectionFormattingProvider.bindTo(n),this._hasMultipleDocumentFormattingProvider=ye.hasMultipleDocumentFormattingProvider.bindTo(n),this._hasMultipleDocumentSelectionFormattingProvider=ye.hasMultipleDocumentSelectionFormattingProvider.bindTo(n),this._isInEmbeddedEditor=ye.isInEmbeddedEditor.bindTo(n);let r=()=>this._update();this._register(t.onDidChangeModel(r)),this._register(t.onDidChangeModelLanguage(r)),this._register(i.completionProvider.onDidChange(r)),this._register(i.codeActionProvider.onDidChange(r)),this._register(i.codeLensProvider.onDidChange(r)),this._register(i.definitionProvider.onDidChange(r)),this._register(i.declarationProvider.onDidChange(r)),this._register(i.implementationProvider.onDidChange(r)),this._register(i.typeDefinitionProvider.onDidChange(r)),this._register(i.hoverProvider.onDidChange(r)),this._register(i.documentHighlightProvider.onDidChange(r)),this._register(i.documentSymbolProvider.onDidChange(r)),this._register(i.referenceProvider.onDidChange(r)),this._register(i.renameProvider.onDidChange(r)),this._register(i.documentFormattingEditProvider.onDidChange(r)),this._register(i.documentRangeFormattingEditProvider.onDidChange(r)),this._register(i.signatureHelpProvider.onDidChange(r)),this._register(i.inlayHintsProvider.onDidChange(r)),r()}_langId;_hasCompletionItemProvider;_hasCodeActionsProvider;_hasCodeLensProvider;_hasDefinitionProvider;_hasDeclarationProvider;_hasImplementationProvider;_hasTypeDefinitionProvider;_hasHoverProvider;_hasDocumentHighlightProvider;_hasDocumentSymbolProvider;_hasReferenceProvider;_hasRenameProvider;_hasDocumentFormattingProvider;_hasDocumentSelectionFormattingProvider;_hasMultipleDocumentFormattingProvider;_hasMultipleDocumentSelectionFormattingProvider;_hasSignatureHelpProvider;_hasInlayHintsProvider;_isInEmbeddedEditor;dispose(){super.dispose()}reset(){this._contextKeyService.bufferChangeEvents(()=>{this._langId.reset(),this._hasCompletionItemProvider.reset(),this._hasCodeActionsProvider.reset(),this._hasCodeLensProvider.reset(),this._hasDefinitionProvider.reset(),this._hasDeclarationProvider.reset(),this._hasImplementationProvider.reset(),this._hasTypeDefinitionProvider.reset(),this._hasHoverProvider.reset(),this._hasDocumentHighlightProvider.reset(),this._hasDocumentSymbolProvider.reset(),this._hasReferenceProvider.reset(),this._hasRenameProvider.reset(),this._hasDocumentFormattingProvider.reset(),this._hasDocumentSelectionFormattingProvider.reset(),this._hasSignatureHelpProvider.reset(),this._isInEmbeddedEditor.reset()})}_update(){let t=this._editor.getModel();if(!t){this.reset();return}this._contextKeyService.bufferChangeEvents(()=>{this._langId.set(t.getLanguageId()),this._hasCompletionItemProvider.set(this._languageFeaturesService.completionProvider.has(t)),this._hasCodeActionsProvider.set(this._languageFeaturesService.codeActionProvider.has(t)),this._hasCodeLensProvider.set(this._languageFeaturesService.codeLensProvider.has(t)),this._hasDefinitionProvider.set(this._languageFeaturesService.definitionProvider.has(t)),this._hasDeclarationProvider.set(this._languageFeaturesService.declarationProvider.has(t)),this._hasImplementationProvider.set(this._languageFeaturesService.implementationProvider.has(t)),this._hasTypeDefinitionProvider.set(this._languageFeaturesService.typeDefinitionProvider.has(t)),this._hasHoverProvider.set(this._languageFeaturesService.hoverProvider.has(t)),this._hasDocumentHighlightProvider.set(this._languageFeaturesService.documentHighlightProvider.has(t)),this._hasDocumentSymbolProvider.set(this._languageFeaturesService.documentSymbolProvider.has(t)),this._hasReferenceProvider.set(this._languageFeaturesService.referenceProvider.has(t)),this._hasRenameProvider.set(this._languageFeaturesService.renameProvider.has(t)),this._hasSignatureHelpProvider.set(this._languageFeaturesService.signatureHelpProvider.has(t)),this._hasInlayHintsProvider.set(this._languageFeaturesService.inlayHintsProvider.has(t)),this._hasDocumentFormattingProvider.set(this._languageFeaturesService.documentFormattingEditProvider.has(t)||this._languageFeaturesService.documentRangeFormattingEditProvider.has(t)),this._hasDocumentSelectionFormattingProvider.set(this._languageFeaturesService.documentRangeFormattingEditProvider.has(t)),this._hasMultipleDocumentFormattingProvider.set(this._languageFeaturesService.documentFormattingEditProvider.all(t).length+this._languageFeaturesService.documentRangeFormattingEditProvider.all(t).length>1),this._hasMultipleDocumentSelectionFormattingProvider.set(this._languageFeaturesService.documentRangeFormattingEditProvider.all(t).length>1),this._isInEmbeddedEditor.set(t.uri.scheme===Te.walkThroughSnippet||t.uri.scheme===Te.vscodeChatCodeBlock)})}},h0=class extends V{_hasDomElementFocus;_domFocusTracker;_overflowWidgetsDomNode;_onChange=this._register(new E);onChange=this._onChange.event;_overflowWidgetsDomNodeHasFocus;_hadFocus=void 0;constructor(e,t){super(),this._hasDomElementFocus=!1,this._domFocusTracker=this._register(Ni(e)),this._overflowWidgetsDomNodeHasFocus=!1,this._register(this._domFocusTracker.onDidFocus(()=>{this._hasDomElementFocus=!0,this._update()})),this._register(this._domFocusTracker.onDidBlur(()=>{this._hasDomElementFocus=!1,this._update()})),t&&(this._overflowWidgetsDomNode=this._register(Ni(t)),this._register(this._overflowWidgetsDomNode.onDidFocus(()=>{this._overflowWidgetsDomNodeHasFocus=!0,this._update()})),this._register(this._overflowWidgetsDomNode.onDidBlur(()=>{this._overflowWidgetsDomNodeHasFocus=!1,this._update()})))}_update(){let e=this._hasDomElementFocus||this._overflowWidgetsDomNodeHasFocus;this._hadFocus!==e&&(this._hadFocus=e,this._onChange.fire(void 0))}hasFocus(){return this._hadFocus??!1}refreshState(){this._domFocusTracker.refreshState(),this._overflowWidgetsDomNode?.refreshState?.()}},p0=class{constructor(e,t){this._editor=e;Array.isArray(t)&&t.length>0&&this.set(t)}_decorationIds=[];_isChangingDecorations=!1;get length(){return this._decorationIds.length}onDidChange(e,t,n){return this._editor.onDidChangeModelDecorations(i=>{this._isChangingDecorations||e.call(t,i)},n)}getRange(e){return!this._editor.hasModel()||e>=this._decorationIds.length?null:this._editor.getModel().getDecorationRange(this._decorationIds[e])}getRanges(){if(!this._editor.hasModel())return[];let e=this._editor.getModel(),t=[];for(let n of this._decorationIds){let i=e.getDecorationRange(n);i&&t.push(i)}return t}has(e){return this._decorationIds.includes(e.id)}clear(){this._decorationIds.length!==0&&this.set([])}set(e){try{this._isChangingDecorations=!0,this._editor.changeDecorations(t=>{this._decorationIds=t.deltaDecorations(this._decorationIds,e)})}finally{this._isChangingDecorations=!1}return this._decorationIds}append(e){let t=[];try{this._isChangingDecorations=!0,this._editor.changeDecorations(n=>{t=n.deltaDecorations([],e),this._decorationIds=this._decorationIds.concat(t)})}finally{this._isChangingDecorations=!1}return t}},dU=encodeURIComponent("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 6 3' enable-background='new 0 0 6 3' height='3' width='6'><g fill='"),cU=encodeURIComponent("'><polygon points='5.5,0 2.5,3 1.1,3 4.1,0'/><polygon points='4,0 6,2 6,0.6 5.4,0'/><polygon points='0,2 1,3 2.4,3 0,0.6'/></g></svg>");function l0(o){return dU+encodeURIComponent(o.toString())+cU}var uU=encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" height="3" width="12"><g fill="'),hU=encodeURIComponent('"><circle cx="1" cy="1" r="1"/><circle cx="5" cy="1" r="1"/><circle cx="9" cy="1" r="1"/></g></svg>');function pU(o){return uU+encodeURIComponent(o.toString())+hU}Ui((o,e)=>{let t=o.getColor(Vd);t&&e.addRule(`.monaco-editor .squiggly-error { background: url("data:image/svg+xml,${l0(t)}") repeat-x bottom left; }`);let n=o.getColor(Hi);n&&e.addRule(`.monaco-editor .squiggly-warning { background: url("data:image/svg+xml,${l0(n)}") repeat-x bottom left; }`);let i=o.getColor(To);i&&e.addRule(`.monaco-editor .squiggly-info { background: url("data:image/svg+xml,${l0(i)}") repeat-x bottom left; }`);let r=o.getColor(hA);r&&e.addRule(`.monaco-editor .squiggly-hint { background: url("data:image/svg+xml,${pU(r)}") no-repeat bottom left; }`);let s=o.getColor(IN);s&&e.addRule(`.monaco-editor.showUnused .squiggly-inline-unnecessary { opacity: ${s.rgba.a}; }`)});var OS=class o{constructor(e,t){this.storageService=t;this.id=o.COMMON_PREFIX+e}static applicationMementos=new Map;static profileMementos=new Map;static workspaceMementos=new Map;static COMMON_PREFIX="memento/";id;getMemento(e,t){switch(e){case 1:{let n=o.workspaceMementos.get(this.id);return n||(n=new jg(this.id,e,t,this.storageService),o.workspaceMementos.set(this.id,n)),n.getMemento()}case 0:{let n=o.profileMementos.get(this.id);return n||(n=new jg(this.id,e,t,this.storageService),o.profileMementos.set(this.id,n)),n.getMemento()}case-1:{let n=o.applicationMementos.get(this.id);return n||(n=new jg(this.id,e,t,this.storageService),o.applicationMementos.set(this.id,n)),n.getMemento()}}}onDidChangeValue(e,t){return this.storageService.onDidChangeValue(e,this.id,t)}saveMemento(){o.workspaceMementos.get(this.id)?.save(),o.profileMementos.get(this.id)?.save(),o.applicationMementos.get(this.id)?.save()}reloadMemento(e){let t;switch(e){case-1:t=o.applicationMementos.get(this.id);break;case 0:t=o.profileMementos.get(this.id);break;case 1:t=o.workspaceMementos.get(this.id);break}t?.reload()}static clear(e){switch(e){case 1:o.workspaceMementos.clear();break;case 0:o.profileMementos.clear();break;case-1:o.applicationMementos.clear();break}}},jg=class{constructor(e,t,n,i){this.id=e;this.scope=t;this.target=n;this.storageService=i;this.mementoObj=this.doLoad()}mementoObj;doLoad(){try{return this.storageService.getObject(this.id,this.scope,{})}catch(e){je(`[memento]: failed to parse contents: ${e} (id: ${this.id}, scope: ${this.scope}, contents: ${this.storageService.get(this.id,this.scope)})`)}return{}}getMemento(){return this.mementoObj}reload(){for(let e of Object.getOwnPropertyNames(this.mementoObj))delete this.mementoObj[e];Object.assign(this.mementoObj,this.doLoad())}save(){md(this.mementoObj)?this.storageService.remove(this.id,this.scope):this.storageService.store(this.id,this.mementoObj,this.scope,this.target)}};var qg=class extends ry{constructor(t,n,i){super(n);this.id=t;this.memento=new OS(this.id,i),this._register(i.onWillSaveState(()=>{this.saveState(),this.memento.saveMemento()}))}memento;getId(){return this.id}getMemento(t,n){return this.memento.getMemento(t,n)}reloadMemento(t){return this.memento.reloadMemento(t)}onDidChangeMementoValue(t,n){return this.memento.onDidChangeValue(t,n)}saveState(){}};var Jh={RESOURCES:"ResourceURLs",DOWNLOAD_URL:"DownloadURL",FILES:"Files",TEXT:Pd.text,INTERNAL_URI_LIST:"application/vnd.code.uri-list"};var ki;(i=>{function o(r,s){if(r.start>=s.end||s.start>=r.end)return{start:0,end:0};let a=Math.max(r.start,s.start),l=Math.min(r.end,s.end);return l-a<=0?{start:0,end:0}:{start:a,end:l}}i.intersect=o;function e(r){return r.end-r.start<=0}i.isEmpty=e;function t(r,s){return!e(o(r,s))}i.intersects=t;function n(r,s){let a=[],l={start:r.start,end:Math.min(s.start,r.end)},d={start:Math.max(s.end,r.start),end:r.end};return e(l)||a.push(l),e(d)||a.push(d),a}i.relativeComplement=n})(ki||={});var mU=()=>({get delay(){return-1},dispose:()=>{},showHover:()=>{}}),m0=mU,gU=new vi(()=>m0("mouse",!1)),fU=new vi(()=>m0("element",!1));function Gt(o){return o==="element"?fU.value:gU.value}function Wl(){return m0("element",!0)}function eF(o,e={}){let t=NS(e);return t.textContent=o,t}function tF(o,e={}){let t=NS(e);return nF(t,bU(o,!!e.renderCodeSegments),e.actionHandler,e.renderCodeSegments),t}function NS(o){let e=o.inline?"span":"div",t=document.createElement(e);return o.className&&(t.className=o.className),t}var g0=class{source;index;constructor(e){this.source=e,this.index=0}eos(){return this.index>=this.source.length}next(){let e=this.peek();return this.advance(),e}peek(){return this.source[this.index]}advance(){this.index++}};function nF(o,e,t,n){let i;if(e.type===2)i=document.createTextNode(e.content||"");else if(e.type===3)i=document.createElement("b");else if(e.type===4)i=document.createElement("i");else if(e.type===7&&n)i=document.createElement("code");else if(e.type===5&&t){let r=document.createElement("a");t.disposables.add(Jt(r,"click",s=>{t.callback(String(e.index),s)})),i=r}else e.type===8?i=document.createElement("br"):e.type===1&&(i=o);i&&o!==i&&o.appendChild(i),i&&Array.isArray(e.children)&&e.children.forEach(r=>{nF(i,r,t,n)})}function bU(o,e){let t={type:1,children:[]},n=0,i=t,r=[],s=new g0(o);for(;!s.eos();){let a=s.next(),l=a==="\\"&&f0(s.peek(),e)!==0;if(l&&(a=s.next()),!l&&vU(a,e)&&a===s.peek()){s.advance(),i.type===2&&(i=r.pop());let d=f0(a,e);if(i.type===d||i.type===5&&d===6)i=r.pop();else{let c={type:d,children:[]};d===5&&(c.index=n,n++),i.children.push(c),r.push(i),i=c}}else if(a===`
`)i.type===2&&(i=r.pop()),i.children.push({type:8});else if(i.type!==2){let d={type:2,content:a};i.children.push(d),r.push(i),i=d}else i.content+=a}return i.type===2&&(i=r.pop()),r.length,t}function vU(o,e){return f0(o,e)!==0}function f0(o,e){switch(o){case"*":return 3;case"_":return 4;case"[":return 5;case"]":return 6;case"`":return e?7:0;default:return 0}}var PS=class{constructor(e){this.spliceables=e}splice(e,t,n){this.spliceables.forEach(i=>i.splice(e,t,n))}};function iF(o,e){let t=[];for(let n of e){if(o.start>=n.range.end)continue;if(o.end<n.range.start)break;let i=ki.intersect(o,n.range);ki.isEmpty(i)||t.push({range:i,size:n.size})}return t}function BS({start:o,end:e},t){return{start:o+t,end:e+t}}function yU(o){let e=[],t=null;for(let n of o){let i=n.range.start,r=n.range.end,s=n.size;if(t&&s===t.size){t.range.end=r;continue}t={range:{start:i,end:r},size:s},e.push(t)}return e}function IU(...o){return yU(o.reduce((e,t)=>e.concat(t),[]))}var FS=class{groups=[];_size=0;_paddingTop=0;get paddingTop(){return this._paddingTop}set paddingTop(e){this._size=this._size+e-this._paddingTop,this._paddingTop=e}constructor(e){this._paddingTop=e??0,this._size=this._paddingTop}splice(e,t,n=[]){let i=n.length-t,r=iF({start:0,end:e},this.groups),s=iF({start:e+t,end:Number.POSITIVE_INFINITY},this.groups).map(l=>({range:BS(l.range,i),size:l.size})),a=n.map((l,d)=>({range:{start:e+d,end:e+d+1},size:l.size}));this.groups=IU(r,a,s),this._size=this._paddingTop+this.groups.reduce((l,d)=>l+d.size*(d.range.end-d.range.start),0)}get count(){let e=this.groups.length;return e?this.groups[e-1].range.end:0}get size(){return this._size}indexAt(e){if(e<0)return-1;if(e<this._paddingTop)return 0;let t=0,n=this._paddingTop;for(let i of this.groups){let r=i.range.end-i.range.start,s=n+r*i.size;if(e<s)return t+Math.floor((e-n)/i.size);t+=r,n=s}return t}indexAfter(e){return Math.min(this.indexAt(e)+1,this.count)}positionAt(e){if(e<0)return-1;let t=0,n=0;for(let i of this.groups){let r=i.range.end-i.range.start,s=n+r;if(e<s)return this._paddingTop+t+(e-n)*i.size;t+=r*i.size,n=s}return-1}};var VS=class{constructor(e){this.renderers=e}cache=new Map;transactionNodesPendingRemoval=new Set;inTransaction=!1;alloc(e){let t=this.getTemplateCache(e).pop(),n=!1;if(t)n=this.transactionNodesPendingRemoval.has(t.domNode),n&&this.transactionNodesPendingRemoval.delete(t.domNode);else{let i=We(".monaco-list-row"),s=this.getRenderer(e).renderTemplate(i);t={domNode:i,templateId:e,templateData:s}}return{row:t,isReusingConnectedDomNode:n}}release(e){e&&this.releaseRow(e)}transact(e){if(this.inTransaction)throw new Error("Already in transaction");this.inTransaction=!0;try{e()}finally{for(let t of this.transactionNodesPendingRemoval)this.doRemoveNode(t);this.transactionNodesPendingRemoval.clear(),this.inTransaction=!1}}releaseRow(e){let{domNode:t,templateId:n}=e;t&&(this.inTransaction?this.transactionNodesPendingRemoval.add(t):this.doRemoveNode(t)),this.getTemplateCache(n).push(e)}doRemoveNode(e){e.classList.remove("scrolling"),e.remove()}getTemplateCache(e){let t=this.cache.get(e);return t||(t=[],this.cache.set(e,t)),t}dispose(){this.cache.forEach((e,t)=>{for(let n of e)this.getRenderer(t).disposeTemplate(n.templateData),n.templateData=null}),this.cache.clear(),this.transactionNodesPendingRemoval.clear()}getRenderer(e){let t=this.renderers.get(e);if(!t)throw new Error(`No renderer found for ${e}`);return t}};var Cc={CurrentDragAndDropData:void 0};var Ws={useShadows:!0,verticalScrollMode:1,setRowLineHeight:!0,setRowHeight:!0,supportDynamicHeights:!1,dnd:{getDragElements(o){return[o]},getDragURI(){return null},onDragStart(){},onDragOver(){return!1},drop(){},dispose(){}},horizontalScrolling:!1,transformOptimization:!0,alwaysConsumeMouseWheel:!0},WS=class{elements;_context;get context(){return this._context}set context(e){this._context=e}constructor(e){this.elements=e}update(){}getData(){return this.elements}},b0=class{elements;constructor(e){this.elements=e}update(){}getData(){return this.elements}},v0=class{types;files;constructor(){this.types=[],this.files=[]}update(e){if(e.types&&this.types.splice(0,this.types.length,...e.types),e.files){this.files.splice(0,this.files.length);for(let t=0;t<e.files.length;t++){let n=e.files.item(t);n&&(n.size||n.type)&&this.files.push(n)}}}getData(){return{types:this.types,files:this.files}}};function CU(o,e){return Array.isArray(o)&&Array.isArray(e)?on(o,e):o===e}var y0=class{getSetSize;getPosInSet;getRole;isChecked;constructor(e){e?.getSetSize?this.getSetSize=e.getSetSize.bind(e):this.getSetSize=(t,n,i)=>i,e?.getPosInSet?this.getPosInSet=e.getPosInSet.bind(e):this.getPosInSet=(t,n)=>n+1,e?.getRole?this.getRole=e.getRole.bind(e):this.getRole=t=>"listitem",e?.isChecked?this.isChecked=e.isChecked.bind(e):this.isChecked=t=>{}}},ko=class ko{constructor(e,t,n,i=Ws){this.virtualDelegate=t;if(i.horizontalScrolling&&i.supportDynamicHeights)throw new Error("Horizontal scrolling and dynamic heights not supported simultaneously");this.items=[],this.itemId=0,this.rangeMap=this.createRangeMap(i.paddingTop??0);for(let s of n)this.renderers.set(s.templateId,s);this.cache=this.disposables.add(new VS(this.renderers)),this.lastRenderTop=0,this.lastRenderHeight=0,this.domNode=document.createElement("div"),this.domNode.className="monaco-list",this.domNode.classList.add(this.domId),this.domNode.tabIndex=0,this.domNode.classList.toggle("mouse-support",typeof i.mouseSupport=="boolean"?i.mouseSupport:!0),this._horizontalScrolling=i.horizontalScrolling??Ws.horizontalScrolling,this.domNode.classList.toggle("horizontal-scrolling",this._horizontalScrolling),this.paddingBottom=typeof i.paddingBottom>"u"?0:i.paddingBottom,this.accessibilityProvider=new y0(i.accessibilityProvider),this.rowsContainer=document.createElement("div"),this.rowsContainer.className="monaco-list-rows",(i.transformOptimization??Ws.transformOptimization)&&(this.rowsContainer.style.transform="translate3d(0px, 0px, 0px)",this.rowsContainer.style.overflow="hidden",this.rowsContainer.style.contain="strict"),this.disposables.add(Yt.addTarget(this.rowsContainer)),this.scrollable=this.disposables.add(new ms({forceIntegerValues:!0,smoothScrollDuration:i.smoothScrolling??!1?125:0,scheduleAtNextAnimationFrame:s=>Fn(Ie(this.domNode),s)})),this.scrollableElement=this.disposables.add(new pc(this.rowsContainer,{alwaysConsumeMouseWheel:i.alwaysConsumeMouseWheel??Ws.alwaysConsumeMouseWheel,horizontal:1,vertical:i.verticalScrollMode??Ws.verticalScrollMode,useShadows:i.useShadows??Ws.useShadows,mouseWheelScrollSensitivity:i.mouseWheelScrollSensitivity,fastScrollSensitivity:i.fastScrollSensitivity,scrollByPage:i.scrollByPage},this.scrollable)),this.domNode.appendChild(this.scrollableElement.getDomNode()),e.appendChild(this.domNode),this.scrollableElement.onScroll(this.onScroll,this,this.disposables),this.disposables.add(U(this.rowsContainer,at.Change,s=>this.onTouchChange(s))),this.disposables.add(U(this.scrollableElement.getDomNode(),"scroll",s=>s.target.scrollTop=0)),this.disposables.add(U(this.domNode,"dragover",s=>this.onDragOver(this.toDragEvent(s)))),this.disposables.add(U(this.domNode,"drop",s=>this.onDrop(this.toDragEvent(s)))),this.disposables.add(U(this.domNode,"dragleave",s=>this.onDragLeave(this.toDragEvent(s)))),this.disposables.add(U(this.domNode,"dragend",s=>this.onDragEnd(s))),this.setRowLineHeight=i.setRowLineHeight??Ws.setRowLineHeight,this.setRowHeight=i.setRowHeight??Ws.setRowHeight,this.supportDynamicHeights=i.supportDynamicHeights??Ws.supportDynamicHeights,this.dnd=i.dnd??this.disposables.add(Ws.dnd),this.layout(i.initialSize?.height,i.initialSize?.width)}static InstanceCount=0;domId=`list_id_${++ko.InstanceCount}`;domNode;items;itemId;rangeMap;cache;renderers=new Map;lastRenderTop;lastRenderHeight;renderWidth=0;rowsContainer;scrollable;scrollableElement;_scrollHeight=0;scrollableElementUpdateDisposable=null;scrollableElementWidthDelayer=new ls(50);splicing=!1;dragOverAnimationDisposable;dragOverAnimationStopDisposable=V.None;dragOverMouseY=0;setRowLineHeight;setRowHeight;supportDynamicHeights;paddingBottom;accessibilityProvider;scrollWidth;dnd;canDrop=!1;currentDragData;currentDragFeedback;currentDragFeedbackPosition;currentDragFeedbackDisposable=V.None;onDragLeaveTimeout=V.None;disposables=new he;_onDidChangeContentHeight=new E;_onDidChangeContentWidth=new E;onDidChangeContentHeight=oe.latch(this._onDidChangeContentHeight.event,void 0,this.disposables);onDidChangeContentWidth=oe.latch(this._onDidChangeContentWidth.event,void 0,this.disposables);get contentHeight(){return this.rangeMap.size}get contentWidth(){return this.scrollWidth??0}get onDidScroll(){return this.scrollableElement.onScroll}get onWillScroll(){return this.scrollableElement.onWillScroll}get containerDomNode(){return this.rowsContainer}get scrollableElementDomNode(){return this.scrollableElement.getDomNode()}_horizontalScrolling=!1;get horizontalScrolling(){return this._horizontalScrolling}set horizontalScrolling(e){if(e!==this._horizontalScrolling){if(e&&this.supportDynamicHeights)throw new Error("Horizontal scrolling and dynamic heights not supported simultaneously");if(this._horizontalScrolling=e,this.domNode.classList.toggle("horizontal-scrolling",this._horizontalScrolling),this._horizontalScrolling){for(let t of this.items)this.measureItemWidth(t);this.updateScrollWidth(),this.scrollableElement.setScrollDimensions({width:xb(this.domNode)}),this.rowsContainer.style.width=`${Math.max(this.scrollWidth||0,this.renderWidth)}px`}else this.scrollableElementWidthDelayer.cancel(),this.scrollableElement.setScrollDimensions({width:this.renderWidth,scrollWidth:this.renderWidth}),this.rowsContainer.style.width=""}}updateOptions(e){e.paddingBottom!==void 0&&(this.paddingBottom=e.paddingBottom,this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight})),e.smoothScrolling!==void 0&&this.scrollable.setSmoothScrollDuration(e.smoothScrolling?125:0),e.horizontalScrolling!==void 0&&(this.horizontalScrolling=e.horizontalScrolling);let t;if(e.scrollByPage!==void 0&&(t={...t??{},scrollByPage:e.scrollByPage}),e.mouseWheelScrollSensitivity!==void 0&&(t={...t??{},mouseWheelScrollSensitivity:e.mouseWheelScrollSensitivity}),e.fastScrollSensitivity!==void 0&&(t={...t??{},fastScrollSensitivity:e.fastScrollSensitivity}),t&&this.scrollableElement.updateOptions(t),e.paddingTop!==void 0&&e.paddingTop!==this.rangeMap.paddingTop){let n=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),i=e.paddingTop-this.rangeMap.paddingTop;this.rangeMap.paddingTop=e.paddingTop,this.render(n,Math.max(0,this.lastRenderTop+i),this.lastRenderHeight,void 0,void 0,!0),this.setScrollTop(this.lastRenderTop),this.eventuallyUpdateScrollDimensions(),this.supportDynamicHeights&&this._rerender(this.lastRenderTop,this.lastRenderHeight)}}delegateScrollFromMouseWheelEvent(e){this.scrollableElement.delegateScrollFromMouseWheelEvent(e)}delegateVerticalScrollbarPointerDown(e){this.scrollableElement.delegateVerticalScrollbarPointerDown(e)}updateElementHeight(e,t,n){if(e<0||e>=this.items.length)return;let i=this.items[e].size;if(typeof t>"u"){if(!this.supportDynamicHeights){console.warn("Dynamic heights not supported",new Error().stack);return}this.items[e].lastDynamicHeightWidth=void 0,t=i+this.probeDynamicHeight(e)}if(i===t)return;let r=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),s=0;e<r.start||n!==null&&n>e&&n<r.end?s=t-i:s=0,this.rangeMap.splice(e,1,[{size:t}]),this.items[e].size=t,this.render(r,Math.max(0,this.lastRenderTop+s),this.lastRenderHeight,void 0,void 0,!0),this.setScrollTop(this.lastRenderTop),this.eventuallyUpdateScrollDimensions(),this.supportDynamicHeights&&this._rerender(this.lastRenderTop,this.lastRenderHeight)}createRangeMap(e){return new FS(e)}splice(e,t,n=[]){if(this.splicing)throw new Error("Can't run recursive splices.");this.splicing=!0;try{return this._splice(e,t,n)}finally{this.splicing=!1,this._onDidChangeContentHeight.fire(this.contentHeight)}}_splice(e,t,n=[]){let i=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),r={start:e,end:e+t},s=ki.intersect(i,r),a=new Map;for(let k=s.end-1;k>=s.start;k--){let O=this.items[k];if(O.dragStartDisposable.dispose(),O.checkedDisposable.dispose(),O.row){let W=a.get(O.templateId);W||(W=[],a.set(O.templateId,W));let z=this.renderers.get(O.templateId);z&&z.disposeElement&&z.disposeElement(O.element,k,O.row.templateData,O.size),W.unshift(O.row)}O.row=null,O.stale=!0}let l={start:e+t,end:this.items.length},d=ki.intersect(l,i),c=ki.relativeComplement(l,i),u=n.map(k=>({id:String(this.itemId++),element:k,templateId:this.virtualDelegate.getTemplateId(k),size:this.virtualDelegate.getHeight(k),width:void 0,hasDynamicHeight:!!this.virtualDelegate.hasDynamicHeight&&this.virtualDelegate.hasDynamicHeight(k),lastDynamicHeightWidth:void 0,row:null,uri:void 0,dropTarget:!1,dragStartDisposable:V.None,checkedDisposable:V.None,stale:!1})),h;e===0&&t>=this.items.length?(this.rangeMap=this.createRangeMap(this.rangeMap.paddingTop),this.rangeMap.splice(0,0,u),h=this.items,this.items=u):(this.rangeMap.splice(e,t,u),h=this.items.splice(e,t,...u));let m=n.length-t,f=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),g=BS(d,m),b=ki.intersect(f,g);for(let k=b.start;k<b.end;k++)this.updateItemInDOM(this.items[k],k);let y=ki.relativeComplement(g,f);for(let k of y)for(let O=k.start;O<k.end;O++)this.removeItemFromDOM(O);let C=c.map(k=>BS(k,m)),L=[{start:e,end:e+n.length},...C].map(k=>ki.intersect(f,k)).reverse();for(let k of L)for(let O=k.end-1;O>=k.start;O--){let W=this.items[O],B=a.get(W.templateId)?.pop();this.insertItemInDOM(O,B)}for(let k of a.values())for(let O of k)this.cache.release(O);return this.eventuallyUpdateScrollDimensions(),this.supportDynamicHeights&&this._rerender(this.scrollTop,this.renderHeight),h.map(k=>k.element)}eventuallyUpdateScrollDimensions(){this._scrollHeight=this.contentHeight,this.rowsContainer.style.height=`${this._scrollHeight}px`,this.scrollableElementUpdateDisposable||(this.scrollableElementUpdateDisposable=Fn(Ie(this.domNode),()=>{this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight}),this.updateScrollWidth(),this.scrollableElementUpdateDisposable=null}))}eventuallyUpdateScrollWidth(){if(!this.horizontalScrolling){this.scrollableElementWidthDelayer.cancel();return}this.scrollableElementWidthDelayer.trigger(()=>this.updateScrollWidth())}updateScrollWidth(){if(!this.horizontalScrolling)return;let e=0;for(let t of this.items)typeof t.width<"u"&&(e=Math.max(e,t.width));this.scrollWidth=e,this.scrollableElement.setScrollDimensions({scrollWidth:e===0?0:e+10}),this._onDidChangeContentWidth.fire(this.scrollWidth)}updateWidth(e){if(!this.horizontalScrolling||typeof this.scrollWidth>"u")return;let t=this.items[e];this.measureItemWidth(t),typeof t.width<"u"&&t.width>this.scrollWidth&&(this.scrollWidth=t.width,this.scrollableElement.setScrollDimensions({scrollWidth:this.scrollWidth+10}),this._onDidChangeContentWidth.fire(this.scrollWidth))}rerender(){if(this.supportDynamicHeights){for(let e of this.items)e.lastDynamicHeightWidth=void 0;this._rerender(this.lastRenderTop,this.lastRenderHeight)}}get length(){return this.items.length}get renderHeight(){return this.scrollableElement.getScrollDimensions().height}get firstVisibleIndex(){return this.getRenderRange(this.lastRenderTop,this.lastRenderHeight).start}get firstMostlyVisibleIndex(){let e=this.firstVisibleIndex,t=this.rangeMap.positionAt(e),n=this.rangeMap.positionAt(e+1);return n!==-1&&(n-t)/2+t<this.scrollTop?e+1:e}get lastVisibleIndex(){return this.getRenderRange(this.lastRenderTop,this.lastRenderHeight).end-1}element(e){return this.items[e].element}indexOf(e){return this.items.findIndex(t=>t.element===e)}domElement(e){let t=this.items[e].row;return t&&t.domNode}elementHeight(e){return this.items[e].size}elementTop(e){return this.rangeMap.positionAt(e)}indexAt(e){return this.rangeMap.indexAt(e)}indexAfter(e){return this.rangeMap.indexAfter(e)}layout(e,t){let n={height:typeof e=="number"?e:dR(this.domNode)};this.scrollableElementUpdateDisposable&&(this.scrollableElementUpdateDisposable.dispose(),this.scrollableElementUpdateDisposable=null,n.scrollHeight=this.scrollHeight),this.scrollableElement.setScrollDimensions(n),typeof t<"u"&&(this.renderWidth=t,this.supportDynamicHeights&&this._rerender(this.scrollTop,this.renderHeight)),this.horizontalScrolling&&this.scrollableElement.setScrollDimensions({width:typeof t=="number"?t:xb(this.domNode)})}render(e,t,n,i,r,s=!1){let a=this.getRenderRange(t,n),l=ki.relativeComplement(a,e).reverse(),d=ki.relativeComplement(e,a);if(s){let c=ki.intersect(e,a);for(let u=c.start;u<c.end;u++)this.updateItemInDOM(this.items[u],u)}this.cache.transact(()=>{for(let c of d)for(let u=c.start;u<c.end;u++)this.removeItemFromDOM(u);for(let c of l)for(let u=c.end-1;u>=c.start;u--)this.insertItemInDOM(u)}),i!==void 0&&(this.rowsContainer.style.left=`-${i}px`),this.rowsContainer.style.top=`-${t}px`,this.horizontalScrolling&&r!==void 0&&(this.rowsContainer.style.width=`${Math.max(r,this.renderWidth)}px`),this.lastRenderTop=t,this.lastRenderHeight=n}insertItemInDOM(e,t){let n=this.items[e];if(!n.row)if(t)n.row=t,n.stale=!0;else{let l=this.cache.alloc(n.templateId);n.row=l.row,n.stale||=l.isReusingConnectedDomNode}let i=this.accessibilityProvider.getRole(n.element)||"listitem";n.row.domNode.setAttribute("role",i);let r=this.accessibilityProvider.isChecked(n.element);if(typeof r=="boolean")n.row.domNode.setAttribute("aria-checked",String(!!r));else if(r){let l=d=>n.row.domNode.setAttribute("aria-checked",String(!!d));l(r.value),n.checkedDisposable=r.onDidChange(()=>l(r.value))}if(n.stale||!n.row.domNode.parentElement){let l=this.items.at(e+1)?.row?.domNode??null;(n.row.domNode.parentElement!==this.rowsContainer||n.row.domNode.nextElementSibling!==l)&&this.rowsContainer.insertBefore(n.row.domNode,l),n.stale=!1}this.updateItemInDOM(n,e);let s=this.renderers.get(n.templateId);if(!s)throw new Error(`No renderer found for template id ${n.templateId}`);s?.renderElement(n.element,e,n.row.templateData,n.size);let a=this.dnd.getDragURI(n.element);n.dragStartDisposable.dispose(),n.row.domNode.draggable=!!a,a&&(n.dragStartDisposable=U(n.row.domNode,"dragstart",l=>this.onDragStart(n.element,a,l))),this.horizontalScrolling&&(this.measureItemWidth(n),this.eventuallyUpdateScrollWidth())}measureItemWidth(e){if(!e.row||!e.row.domNode)return;e.row.domNode.style.width="fit-content",e.width=xb(e.row.domNode);let t=Ie(e.row.domNode).getComputedStyle(e.row.domNode);t.paddingLeft&&(e.width+=parseFloat(t.paddingLeft)),t.paddingRight&&(e.width+=parseFloat(t.paddingRight)),e.row.domNode.style.width=""}updateItemInDOM(e,t){e.row.domNode.style.top=`${this.elementTop(t)}px`,this.setRowHeight&&(e.row.domNode.style.height=`${e.size}px`),this.setRowLineHeight&&(e.row.domNode.style.lineHeight=`${e.size}px`),e.row.domNode.setAttribute("data-index",`${t}`),e.row.domNode.setAttribute("data-last-element",t===this.length-1?"true":"false"),e.row.domNode.setAttribute("data-parity",t%2===0?"even":"odd"),e.row.domNode.setAttribute("aria-setsize",String(this.accessibilityProvider.getSetSize(e.element,t,this.length))),e.row.domNode.setAttribute("aria-posinset",String(this.accessibilityProvider.getPosInSet(e.element,t))),e.row.domNode.setAttribute("id",this.getElementDomId(t)),e.row.domNode.classList.toggle("drop-target",e.dropTarget)}removeItemFromDOM(e){let t=this.items[e];if(t.dragStartDisposable.dispose(),t.checkedDisposable.dispose(),t.row){let n=this.renderers.get(t.templateId);n&&n.disposeElement&&n.disposeElement(t.element,e,t.row.templateData,t.size),this.cache.release(t.row),t.row=null}this.horizontalScrolling&&this.eventuallyUpdateScrollWidth()}getScrollTop(){return this.scrollableElement.getScrollPosition().scrollTop}setScrollTop(e,t){this.scrollableElementUpdateDisposable&&(this.scrollableElementUpdateDisposable.dispose(),this.scrollableElementUpdateDisposable=null,this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight})),this.scrollableElement.setScrollPosition({scrollTop:e,reuseAnimation:t})}getScrollLeft(){return this.scrollableElement.getScrollPosition().scrollLeft}setScrollLeft(e){this.scrollableElementUpdateDisposable&&(this.scrollableElementUpdateDisposable.dispose(),this.scrollableElementUpdateDisposable=null,this.scrollableElement.setScrollDimensions({scrollWidth:this.scrollWidth})),this.scrollableElement.setScrollPosition({scrollLeft:e})}get scrollTop(){return this.getScrollTop()}set scrollTop(e){this.setScrollTop(e)}get scrollHeight(){return this._scrollHeight+(this.horizontalScrolling?10:0)+this.paddingBottom}get onMouseClick(){return oe.map(this.disposables.add(new Fe(this.domNode,"click")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseDblClick(){return oe.map(this.disposables.add(new Fe(this.domNode,"dblclick")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseMiddleClick(){return oe.filter(oe.map(this.disposables.add(new Fe(this.domNode,"auxclick")).event,e=>this.toMouseEvent(e),this.disposables),e=>e.browserEvent.button===1,this.disposables)}get onMouseUp(){return oe.map(this.disposables.add(new Fe(this.domNode,"mouseup")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseDown(){return oe.map(this.disposables.add(new Fe(this.domNode,"mousedown")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseOver(){return oe.map(this.disposables.add(new Fe(this.domNode,"mouseover")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseMove(){return oe.map(this.disposables.add(new Fe(this.domNode,"mousemove")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseOut(){return oe.map(this.disposables.add(new Fe(this.domNode,"mouseout")).event,e=>this.toMouseEvent(e),this.disposables)}get onContextMenu(){return oe.any(oe.map(this.disposables.add(new Fe(this.domNode,"contextmenu")).event,e=>this.toMouseEvent(e),this.disposables),oe.map(this.disposables.add(new Fe(this.domNode,at.Contextmenu)).event,e=>this.toGestureEvent(e),this.disposables))}get onTouchStart(){return oe.map(this.disposables.add(new Fe(this.domNode,"touchstart")).event,e=>this.toTouchEvent(e),this.disposables)}get onTap(){return oe.map(this.disposables.add(new Fe(this.rowsContainer,at.Tap)).event,e=>this.toGestureEvent(e),this.disposables)}toMouseEvent(e){let t=this.getItemIndexFromEventTarget(e.target||null),n=typeof t>"u"?void 0:this.items[t],i=n&&n.element;return{browserEvent:e,index:t,element:i}}toTouchEvent(e){let t=this.getItemIndexFromEventTarget(e.target||null),n=typeof t>"u"?void 0:this.items[t],i=n&&n.element;return{browserEvent:e,index:t,element:i}}toGestureEvent(e){let t=this.getItemIndexFromEventTarget(e.initialTarget||null),n=typeof t>"u"?void 0:this.items[t],i=n&&n.element;return{browserEvent:e,index:t,element:i}}toDragEvent(e){let t=this.getItemIndexFromEventTarget(e.target||null),n=typeof t>"u"?void 0:this.items[t],i=n&&n.element,r=this.getTargetSector(e,t);return{browserEvent:e,index:t,element:i,sector:r}}onScroll(e){try{let t=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight);this.render(t,e.scrollTop,e.height,e.scrollLeft,e.scrollWidth),this.supportDynamicHeights&&this._rerender(e.scrollTop,e.height,e.inSmoothScrolling)}catch(t){throw console.error("Got bad scroll event:",e),t}}onTouchChange(e){e.preventDefault(),e.stopPropagation(),this.scrollTop-=e.translationY}onDragStart(e,t,n){if(!n.dataTransfer)return;let i=this.dnd.getDragElements(e);if(n.dataTransfer.effectAllowed="copyMove",n.dataTransfer.setData(Jh.TEXT,t),n.dataTransfer.setDragImage){let r;this.dnd.getDragLabel&&(r=this.dnd.getDragLabel(i,n)),typeof r>"u"&&(r=String(i.length));let s=We(".monaco-drag-image");s.textContent=r,(d=>{for(;d&&!d.classList.contains("monaco-workbench");)d=d.parentElement;return d||this.domNode.ownerDocument})(this.domNode).appendChild(s),n.dataTransfer.setDragImage(s,-10,-10),setTimeout(()=>s.remove(),0)}this.domNode.classList.add("dragging"),this.currentDragData=new WS(i),Cc.CurrentDragAndDropData=new b0(i),this.dnd.onDragStart?.(this.currentDragData,n)}onDragOver(e){if(e.browserEvent.preventDefault(),this.onDragLeaveTimeout.dispose(),Cc.CurrentDragAndDropData&&Cc.CurrentDragAndDropData.getData()==="vscode-ui"||(this.setupDragAndDropScrollTopAnimation(e.browserEvent),!e.browserEvent.dataTransfer))return!1;if(!this.currentDragData)if(Cc.CurrentDragAndDropData)this.currentDragData=Cc.CurrentDragAndDropData;else{if(!e.browserEvent.dataTransfer.types)return!1;this.currentDragData=new v0}let t=this.dnd.onDragOver(this.currentDragData,e.element,e.index,e.sector,e.browserEvent);if(this.canDrop=typeof t=="boolean"?t:t.accept,!this.canDrop)return this.currentDragFeedback=void 0,this.currentDragFeedbackDisposable.dispose(),!1;e.browserEvent.dataTransfer.dropEffect=typeof t!="boolean"&&t.effect?.type===0?"copy":"move";let n;typeof t!="boolean"&&t.feedback?n=t.feedback:typeof e.index>"u"?n=[-1]:n=[e.index],n=Xs(n).filter(r=>r>=-1&&r<this.length).sort((r,s)=>r-s),n=n[0]===-1?[-1]:n;let i=typeof t!="boolean"&&t.effect&&t.effect.position?t.effect.position:"drop-target";if(CU(this.currentDragFeedback,n)&&this.currentDragFeedbackPosition===i)return!0;if(this.currentDragFeedback=n,this.currentDragFeedbackPosition=i,this.currentDragFeedbackDisposable.dispose(),n[0]===-1)this.domNode.classList.add(i),this.rowsContainer.classList.add(i),this.currentDragFeedbackDisposable=ve(()=>{this.domNode.classList.remove(i),this.rowsContainer.classList.remove(i)});else{if(n.length>1&&i!=="drop-target")throw new Error("Can't use multiple feedbacks with position different than 'over'");i==="drop-target-after"&&n[0]<this.length-1&&(n[0]+=1,i="drop-target-before");for(let r of n){let s=this.items[r];s.dropTarget=!0,s.row?.domNode.classList.add(i)}this.currentDragFeedbackDisposable=ve(()=>{for(let r of n){let s=this.items[r];s.dropTarget=!1,s.row?.domNode.classList.remove(i)}})}return!0}onDragLeave(e){this.onDragLeaveTimeout.dispose(),this.onDragLeaveTimeout=fb(()=>this.clearDragOverFeedback(),100,this.disposables),this.currentDragData&&this.dnd.onDragLeave?.(this.currentDragData,e.element,e.index,e.browserEvent)}onDrop(e){if(!this.canDrop)return;let t=this.currentDragData;this.teardownDragAndDropScrollTopAnimation(),this.clearDragOverFeedback(),this.domNode.classList.remove("dragging"),this.currentDragData=void 0,Cc.CurrentDragAndDropData=void 0,!(!t||!e.browserEvent.dataTransfer)&&(e.browserEvent.preventDefault(),t.update(e.browserEvent.dataTransfer),this.dnd.drop(t,e.element,e.index,e.sector,e.browserEvent))}onDragEnd(e){this.canDrop=!1,this.teardownDragAndDropScrollTopAnimation(),this.clearDragOverFeedback(),this.domNode.classList.remove("dragging"),this.currentDragData=void 0,Cc.CurrentDragAndDropData=void 0,this.dnd.onDragEnd?.(e)}clearDragOverFeedback(){this.currentDragFeedback=void 0,this.currentDragFeedbackPosition=void 0,this.currentDragFeedbackDisposable.dispose(),this.currentDragFeedbackDisposable=V.None}setupDragAndDropScrollTopAnimation(e){if(!this.dragOverAnimationDisposable){let t=im(this.domNode).top;this.dragOverAnimationDisposable=wR(Ie(this.domNode),this.animateDragAndDropScrollTop.bind(this,t))}this.dragOverAnimationStopDisposable.dispose(),this.dragOverAnimationStopDisposable=fb(()=>{this.dragOverAnimationDisposable&&(this.dragOverAnimationDisposable.dispose(),this.dragOverAnimationDisposable=void 0)},1e3,this.disposables),this.dragOverMouseY=e.pageY}animateDragAndDropScrollTop(e){if(this.dragOverMouseY===void 0)return;let t=this.dragOverMouseY-e,n=this.renderHeight-35;t<35?this.scrollTop+=Math.max(-14,Math.floor(.3*(t-35))):t>n&&(this.scrollTop+=Math.min(14,Math.floor(.3*(t-n))))}teardownDragAndDropScrollTopAnimation(){this.dragOverAnimationStopDisposable.dispose(),this.dragOverAnimationDisposable&&(this.dragOverAnimationDisposable.dispose(),this.dragOverAnimationDisposable=void 0)}getTargetSector(e,t){if(t===void 0)return;let n=e.offsetY/this.items[t].size,i=Math.floor(n/.25);return eu(i,0,3)}getItemIndexFromEventTarget(e){let t=this.scrollableElement.getDomNode(),n=e;for(;(yn(n)||bR(n))&&n!==this.rowsContainer&&t.contains(n);){let i=n.getAttribute("data-index");if(i){let r=Number(i);if(!isNaN(r))return r}n=n.parentElement}}getRenderRange(e,t){return{start:this.rangeMap.indexAt(e),end:this.rangeMap.indexAfter(e+t-1)}}_rerender(e,t,n){let i=this.getRenderRange(e,t),r,s;e===this.elementTop(i.start)?(r=i.start,s=0):i.end-i.start>1&&(r=i.start+1,s=this.elementTop(r)-e);let a=0;for(;;){let l=this.getRenderRange(e,t),d=!1;for(let c=l.start;c<l.end;c++){let u=this.probeDynamicHeight(c);u!==0&&this.rangeMap.splice(c,1,[this.items[c]]),a+=u,d=d||u!==0}if(!d){a!==0&&this.eventuallyUpdateScrollDimensions();let c=ki.relativeComplement(i,l);for(let h of c)for(let m=h.start;m<h.end;m++)this.items[m].row&&this.removeItemFromDOM(m);let u=ki.relativeComplement(l,i).reverse();for(let h of u)for(let m=h.end-1;m>=h.start;m--)this.insertItemInDOM(m);for(let h=l.start;h<l.end;h++)this.items[h].row&&this.updateItemInDOM(this.items[h],h);if(typeof r=="number"){let h=this.scrollable.getFutureScrollPosition().scrollTop-e,m=this.elementTop(r)-s+h;this.setScrollTop(m,n)}this._onDidChangeContentHeight.fire(this.contentHeight);return}}}probeDynamicHeight(e){let t=this.items[e];if(this.virtualDelegate.getDynamicHeight){let s=this.virtualDelegate.getDynamicHeight(t.element);if(s!==null){let a=t.size;return t.size=s,t.lastDynamicHeightWidth=this.renderWidth,s-a}}if(!t.hasDynamicHeight||t.lastDynamicHeightWidth===this.renderWidth||this.virtualDelegate.hasDynamicHeight&&!this.virtualDelegate.hasDynamicHeight(t.element))return 0;let n=t.size;if(t.row)return t.row.domNode.style.height="",t.size=t.row.domNode.offsetHeight,t.size===0&&!Jo(t.row.domNode,Ie(t.row.domNode).document.body)&&console.warn("Measuring item node that is not in DOM! Add ListView to the DOM before measuring row height!",new Error().stack),t.lastDynamicHeightWidth=this.renderWidth,t.size-n;let{row:i}=this.cache.alloc(t.templateId);i.domNode.style.height="",this.rowsContainer.appendChild(i.domNode);let r=this.renderers.get(t.templateId);if(!r)throw new Qe("Missing renderer for templateId: "+t.templateId);return r.renderElement(t.element,e,i.templateData,void 0),t.size=i.domNode.offsetHeight,r.disposeElement?.(t.element,e,i.templateData,void 0),this.virtualDelegate.setDynamicHeight?.(t.element,t.size),t.lastDynamicHeightWidth=this.renderWidth,i.domNode.remove(),this.cache.release(i),t.size-n}getElementDomId(e){return`${this.domId}_${e}`}dispose(){for(let e of this.items)if(e.dragStartDisposable.dispose(),e.checkedDisposable.dispose(),e.row){let t=this.renderers.get(e.row.templateId);t&&(t.disposeElement?.(e.element,-1,e.row.templateData,void 0),t.disposeTemplate(e.row.templateData))}this.items=[],this.domNode?.remove(),this.dragOverAnimationDisposable?.dispose(),this.disposables.dispose()}};R([de],ko.prototype,"onMouseClick",1),R([de],ko.prototype,"onMouseDblClick",1),R([de],ko.prototype,"onMouseMiddleClick",1),R([de],ko.prototype,"onMouseUp",1),R([de],ko.prototype,"onMouseDown",1),R([de],ko.prototype,"onMouseOver",1),R([de],ko.prototype,"onMouseMove",1),R([de],ko.prototype,"onMouseOut",1),R([de],ko.prototype,"onContextMenu",1),R([de],ko.prototype,"onTouchStart",1),R([de],ko.prototype,"onTap",1);var HS=ko;var Hs=class extends Error{constructor(e,t){super(`ListError [${e}] ${t}`)}};var I0=class{constructor(e){this.trait=e}renderedElements=[];get templateId(){return`template:${this.trait.name}`}renderTemplate(e){return e}renderElement(e,t,n){let i=this.renderedElements.findIndex(r=>r.templateData===n);if(i>=0){let r=this.renderedElements[i];this.trait.unrender(n),r.index=t}else{let r={index:t,templateData:n};this.renderedElements.push(r)}this.trait.renderIndex(t,n)}splice(e,t,n){let i=[];for(let r of this.renderedElements)r.index<e?i.push(r):r.index>=e+t&&i.push({index:r.index+n-t,templateData:r.templateData});this.renderedElements=i}renderIndexes(e){for(let{index:t,templateData:n}of this.renderedElements)e.indexOf(t)>-1&&this.trait.renderIndex(t,n)}disposeTemplate(e){let t=this.renderedElements.findIndex(n=>n.templateData===e);t<0||this.renderedElements.splice(t,1)}},ep=class{constructor(e){this._trait=e}indexes=[];sortedIndexes=[];_onChange=new E;onChange=this._onChange.event;get name(){return this._trait}get renderer(){return new I0(this)}splice(e,t,n){let i=n.length-t,r=e+t,s=[],a=0;for(;a<this.sortedIndexes.length&&this.sortedIndexes[a]<e;)s.push(this.sortedIndexes[a++]);for(let l=0;l<n.length;l++)n[l]&&s.push(l+e);for(;a<this.sortedIndexes.length&&this.sortedIndexes[a]>=r;)s.push(this.sortedIndexes[a++]+i);this.renderer.splice(e,t,n.length),this._set(s,s)}renderIndex(e,t){t.classList.toggle(this._trait,this.contains(e))}unrender(e){e.classList.remove(this._trait)}set(e,t){return this._set(e,[...e].sort(rF),t)}_set(e,t,n){let i=this.indexes,r=this.sortedIndexes;this.indexes=e,this.sortedIndexes=t;let s=E0(r,e);return this.renderer.renderIndexes(s),this._onChange.fire({indexes:e,browserEvent:n}),i}get(){return this.indexes}contains(e){return C1(this.sortedIndexes,e,rF)>=0}dispose(){kt(this._onChange)}};R([de],ep.prototype,"renderer",1);var C0=class extends ep{constructor(t){super("selected");this.setAriaSelected=t}renderIndex(t,n){super.renderIndex(t,n),this.setAriaSelected&&(this.contains(t)?n.setAttribute("aria-selected","true"):n.setAttribute("aria-selected","false"))}},Zg=class{constructor(e,t,n){this.trait=e;this.view=t;this.identityProvider=n}splice(e,t,n){if(!this.identityProvider)return this.trait.splice(e,t,new Array(n.length).fill(!1));let i=this.trait.get().map(a=>this.identityProvider.getId(this.view.element(a)).toString());if(i.length===0)return this.trait.splice(e,t,new Array(n.length).fill(!1));let r=new Set(i),s=n.map(a=>r.has(this.identityProvider.getId(a).toString()));this.trait.splice(e,t,s)}};function sF(o,e){return o.classList.contains(e)?!0:o.classList.contains("monaco-list")||!o.parentElement?!1:sF(o.parentElement,e)}function Yg(o){return sF(o,"monaco-editor")}var US=class{constructor(e,t,n){this.list=e;this.view=t;this.multipleSelectionSupport=n.multipleSelectionSupport,this.disposables.add(this.onKeyDown(i=>{switch(i.keyCode){case 3:return this.onEnter(i);case 16:return this.onUpArrow(i);case 18:return this.onDownArrow(i);case 11:return this.onPageUpArrow(i);case 12:return this.onPageDownArrow(i);case 9:return this.onEscape(i);case 31:this.multipleSelectionSupport&&(Be?i.metaKey:i.ctrlKey)&&this.onCtrlA(i)}}))}disposables=new he;multipleSelectionDisposables=new he;multipleSelectionSupport;get onKeyDown(){return oe.chain(this.disposables.add(new Fe(this.view.domNode,"keydown")).event,e=>e.filter(t=>!hs(t.target)).map(t=>new nt(t)))}updateOptions(e){e.multipleSelectionSupport!==void 0&&(this.multipleSelectionSupport=e.multipleSelectionSupport)}onEnter(e){e.preventDefault(),e.stopPropagation(),this.list.setSelection(this.list.getFocus(),e.browserEvent)}onUpArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusPrevious(1,!1,e.browserEvent);let t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onDownArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusNext(1,!1,e.browserEvent);let t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onPageUpArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusPreviousPage(e.browserEvent);let t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onPageDownArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusNextPage(e.browserEvent);let t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onCtrlA(e){e.preventDefault(),e.stopPropagation(),this.list.setSelection(vp(this.list.length),e.browserEvent),this.list.setAnchor(void 0),this.view.domNode.focus()}onEscape(e){this.list.getSelection().length&&(e.preventDefault(),e.stopPropagation(),this.list.setSelection([],e.browserEvent),this.list.setAnchor(void 0),this.view.domNode.focus())}dispose(){this.disposables.dispose(),this.multipleSelectionDisposables.dispose()}};R([de],US.prototype,"onKeyDown",1);var xU=new class{mightProducePrintableCharacter(o){return o.ctrlKey||o.metaKey||o.altKey?!1:o.keyCode>=31&&o.keyCode<=56||o.keyCode>=21&&o.keyCode<=30||o.keyCode>=98&&o.keyCode<=107||o.keyCode>=85&&o.keyCode<=95}},S0=class{constructor(e,t,n,i,r){this.list=e;this.view=t;this.keyboardNavigationLabelProvider=n;this.keyboardNavigationEventFilter=i;this.delegate=r;this.updateOptions(e.options)}enabled=!1;state=0;mode=0;triggered=!1;previouslyFocused=-1;enabledDisposables=new he;disposables=new he;updateOptions(e){e.typeNavigationEnabled??!0?this.enable():this.disable(),this.mode=e.typeNavigationMode??0}trigger(){this.triggered=!this.triggered}enable(){if(this.enabled)return;let e=!1,t=oe.chain(this.enabledDisposables.add(new Fe(this.view.domNode,"keydown")).event,r=>r.filter(s=>!hs(s.target)).filter(()=>this.mode===0||this.triggered).map(s=>new nt(s)).filter(s=>e||this.keyboardNavigationEventFilter(s)).filter(s=>this.delegate.mightProducePrintableCharacter(s)).forEach(s=>$e.stop(s,!0)).map(s=>s.browserEvent.key)),n=oe.debounce(t,()=>null,800,void 0,void 0,void 0,this.enabledDisposables);oe.reduce(oe.any(t,n),(r,s)=>s===null?null:(r||"")+s,void 0,this.enabledDisposables)(this.onInput,this,this.enabledDisposables),n(this.onClear,this,this.enabledDisposables),t(()=>e=!0,void 0,this.enabledDisposables),n(()=>e=!1,void 0,this.enabledDisposables),this.enabled=!0,this.triggered=!1}disable(){this.enabled&&(this.enabledDisposables.clear(),this.enabled=!1,this.triggered=!1)}onClear(){let e=this.list.getFocus();if(e.length>0&&e[0]===this.previouslyFocused){let t=this.list.options.accessibilityProvider?.getAriaLabel(this.list.element(e[0]));typeof t=="string"?Th(t):t&&Th(t.get())}this.previouslyFocused=-1}onInput(e){if(!e){this.state=0,this.triggered=!1;return}let t=this.list.getFocus(),n=t.length>0?t[0]:0,i=this.state===0?1:0;this.state=1;for(let r=0;r<this.list.length;r++){let s=(n+r+i)%this.list.length,a=this.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(this.view.element(s)),l=a&&a.toString();if(this.list.options.typeNavigationEnabled){if(typeof l<"u"){if(sm(e,l)){this.previouslyFocused=n,this.list.setFocus([s]),this.list.reveal(s);return}let d=PR(e,l);if(d&&d[0].end-d[0].start>1&&d.length===1){this.previouslyFocused=n,this.list.setFocus([s]),this.list.reveal(s);return}}}else if(typeof l>"u"||sm(e,l)){this.previouslyFocused=n,this.list.setFocus([s]),this.list.reveal(s);return}}}dispose(){this.disable(),this.enabledDisposables.dispose(),this.disposables.dispose()}},w0=class{constructor(e,t){this.list=e;this.view=t;let n=oe.chain(this.disposables.add(new Fe(t.domNode,"keydown")).event,r=>r.filter(s=>!hs(s.target)).map(s=>new nt(s)));oe.chain(n,r=>r.filter(s=>s.keyCode===2&&!s.ctrlKey&&!s.metaKey&&!s.shiftKey&&!s.altKey))(this.onTab,this,this.disposables)}disposables=new he;onTab(e){if(e.target!==this.view.domNode)return;let t=this.list.getFocus();if(t.length===0)return;let n=this.view.domElement(t[0]);if(!n)return;let i=n.querySelector("[tabIndex]");if(!i||!yn(i)||i.tabIndex===-1)return;let r=Ie(i).getComputedStyle(i);r.visibility==="hidden"||r.display==="none"||(e.preventDefault(),e.stopPropagation(),i.focus())}dispose(){this.disposables.dispose()}};function EU(o){return Be?o.browserEvent.metaKey:o.browserEvent.ctrlKey}function _U(o){return o.browserEvent.shiftKey}function TU(o){return Lb(o)&&o.button===2}var oF={isSelectionSingleChangeEvent:EU,isSelectionRangeChangeEvent:_U},zS=class{constructor(e){this.list=e;e.options.multipleSelectionSupport!==!1&&(this.multipleSelectionController=this.list.options.multipleSelectionController||oF),this.mouseSupport=typeof e.options.mouseSupport>"u"||!!e.options.mouseSupport,this.mouseSupport&&(e.onMouseDown(this.onMouseDown,this,this.disposables),e.onContextMenu(this.onContextMenu,this,this.disposables),e.onMouseDblClick(this.onDoubleClick,this,this.disposables),e.onTouchStart(this.onMouseDown,this,this.disposables),this.disposables.add(Yt.addTarget(e.getHTMLElement()))),oe.any(e.onMouseClick,e.onMouseMiddleClick,e.onTap)(this.onViewPointer,this,this.disposables)}multipleSelectionController;mouseSupport;disposables=new he;_onPointer=new E;onPointer=this._onPointer.event;updateOptions(e){e.multipleSelectionSupport!==void 0&&(this.multipleSelectionController=void 0,e.multipleSelectionSupport&&(this.multipleSelectionController=this.list.options.multipleSelectionController||oF))}isSelectionSingleChangeEvent(e){return this.multipleSelectionController?this.multipleSelectionController.isSelectionSingleChangeEvent(e):!1}isSelectionRangeChangeEvent(e){return this.multipleSelectionController?this.multipleSelectionController.isSelectionRangeChangeEvent(e):!1}isSelectionChangeEvent(e){return this.isSelectionSingleChangeEvent(e)||this.isSelectionRangeChangeEvent(e)}onMouseDown(e){Yg(e.browserEvent.target)||eo()!==e.browserEvent.target&&this.list.domFocus()}onContextMenu(e){if(hs(e.browserEvent.target)||Yg(e.browserEvent.target))return;let t=typeof e.index>"u"?[]:[e.index];this.list.setFocus(t,e.browserEvent)}onViewPointer(e){if(!this.mouseSupport||hs(e.browserEvent.target)||Yg(e.browserEvent.target)||e.browserEvent.isHandledByList)return;e.browserEvent.isHandledByList=!0;let t=e.index;if(typeof t>"u"){this.list.setFocus([],e.browserEvent),this.list.setSelection([],e.browserEvent),this.list.setAnchor(void 0);return}if(this.isSelectionChangeEvent(e))return this.changeSelection(e);this.list.setFocus([t],e.browserEvent),this.list.setAnchor(t),TU(e.browserEvent)||this.list.setSelection([t],e.browserEvent),this._onPointer.fire(e)}onDoubleClick(e){if(hs(e.browserEvent.target)||Yg(e.browserEvent.target)||this.isSelectionChangeEvent(e)||e.browserEvent.isHandledByList)return;e.browserEvent.isHandledByList=!0;let t=this.list.getFocus();this.list.setSelection(t,e.browserEvent)}changeSelection(e){let t=e.index,n=this.list.getAnchor();if(this.isSelectionRangeChangeEvent(e)){typeof n>"u"&&(n=this.list.getFocus()[0]??t,this.list.setAnchor(n));let i=Math.min(n,t),r=Math.max(n,t),s=vp(i,r+1),a=this.list.getSelection(),l=DU(E0(a,[n]),n);if(l.length===0)return;let d=E0(s,kU(a,l));this.list.setSelection(d,e.browserEvent),this.list.setFocus([t],e.browserEvent)}else if(this.isSelectionSingleChangeEvent(e)){let i=this.list.getSelection(),r=i.filter(s=>s!==t);this.list.setFocus([t]),this.list.setAnchor(t),i.length===r.length?this.list.setSelection([...r,t],e.browserEvent):this.list.setSelection(r,e.browserEvent)}}dispose(){this.disposables.dispose()}},x0=class{constructor(e,t){this.styleElement=e;this.selectorSuffix=t}style(e){let t=this.selectorSuffix&&`.${this.selectorSuffix}`,n=[];e.listBackground&&n.push(`.monaco-list${t} .monaco-list-rows { background: ${e.listBackground}; }`),e.listFocusBackground&&(n.push(`.monaco-list${t}:focus .monaco-list-row.focused { background-color: ${e.listFocusBackground}; }`),n.push(`.monaco-list${t}:focus .monaco-list-row.focused:hover { background-color: ${e.listFocusBackground}; }`)),e.listFocusForeground&&n.push(`.monaco-list${t}:focus .monaco-list-row.focused { color: ${e.listFocusForeground}; }`),e.listActiveSelectionBackground&&(n.push(`.monaco-list${t}:focus .monaco-list-row.selected { background-color: ${e.listActiveSelectionBackground}; }`),n.push(`.monaco-list${t}:focus .monaco-list-row.selected:hover { background-color: ${e.listActiveSelectionBackground}; }`)),e.listActiveSelectionForeground&&n.push(`.monaco-list${t}:focus .monaco-list-row.selected { color: ${e.listActiveSelectionForeground}; }`),e.listActiveSelectionIconForeground&&n.push(`.monaco-list${t}:focus .monaco-list-row.selected .codicon { color: ${e.listActiveSelectionIconForeground}; }`),e.listFocusAndSelectionBackground&&n.push(`
				.monaco-drag-image,
				.monaco-list${t}:focus .monaco-list-row.selected.focused { background-color: ${e.listFocusAndSelectionBackground}; }
			`),e.listFocusAndSelectionForeground&&n.push(`
				.monaco-drag-image,
				.monaco-list${t}:focus .monaco-list-row.selected.focused { color: ${e.listFocusAndSelectionForeground}; }
			`),e.listInactiveFocusForeground&&(n.push(`.monaco-list${t} .monaco-list-row.focused { color:  ${e.listInactiveFocusForeground}; }`),n.push(`.monaco-list${t} .monaco-list-row.focused:hover { color:  ${e.listInactiveFocusForeground}; }`)),e.listInactiveSelectionIconForeground&&n.push(`.monaco-list${t} .monaco-list-row.focused .codicon { color:  ${e.listInactiveSelectionIconForeground}; }`),e.listInactiveFocusBackground&&(n.push(`.monaco-list${t} .monaco-list-row.focused { background-color:  ${e.listInactiveFocusBackground}; }`),n.push(`.monaco-list${t} .monaco-list-row.focused:hover { background-color:  ${e.listInactiveFocusBackground}; }`)),e.listInactiveSelectionBackground&&(n.push(`.monaco-list${t} .monaco-list-row.selected { background-color:  ${e.listInactiveSelectionBackground}; }`),n.push(`.monaco-list${t} .monaco-list-row.selected:hover { background-color:  ${e.listInactiveSelectionBackground}; }`)),e.listInactiveSelectionForeground&&n.push(`.monaco-list${t} .monaco-list-row.selected { color: ${e.listInactiveSelectionForeground}; }`),e.listHoverBackground&&n.push(`.monaco-list${t}:not(.drop-target):not(.dragging) .monaco-list-row:hover:not(.selected):not(.focused) { background-color: ${e.listHoverBackground}; }`),e.listHoverForeground&&n.push(`.monaco-list${t}:not(.drop-target):not(.dragging) .monaco-list-row:hover:not(.selected):not(.focused) { color:  ${e.listHoverForeground}; }`);let i=Ko(e.listFocusAndSelectionOutline,Ko(e.listSelectionOutline,e.listFocusOutline??""));i&&n.push(`.monaco-list${t}:focus .monaco-list-row.focused.selected { outline: 1px solid ${i}; outline-offset: -1px;}`),e.listFocusOutline&&n.push(`
				.monaco-drag-image,
				.monaco-list${t}:focus .monaco-list-row.focused { outline: 1px solid ${e.listFocusOutline}; outline-offset: -1px; }
				.monaco-workbench.context-menu-visible .monaco-list${t}.last-focused .monaco-list-row.focused { outline: 1px solid ${e.listFocusOutline}; outline-offset: -1px; }
			`);let r=Ko(e.listSelectionOutline,e.listInactiveFocusOutline??"");r&&n.push(`.monaco-list${t} .monaco-list-row.focused.selected { outline: 1px dotted ${r}; outline-offset: -1px; }`),e.listSelectionOutline&&n.push(`.monaco-list${t} .monaco-list-row.selected { outline: 1px dotted ${e.listSelectionOutline}; outline-offset: -1px; }`),e.listInactiveFocusOutline&&n.push(`.monaco-list${t} .monaco-list-row.focused { outline: 1px dotted ${e.listInactiveFocusOutline}; outline-offset: -1px; }`),e.listHoverOutline&&n.push(`.monaco-list${t} .monaco-list-row:hover { outline: 1px dashed ${e.listHoverOutline}; outline-offset: -1px; }`),e.listDropOverBackground&&n.push(`
				.monaco-list${t}.drop-target,
				.monaco-list${t} .monaco-list-rows.drop-target,
				.monaco-list${t} .monaco-list-row.drop-target { background-color: ${e.listDropOverBackground} !important; color: inherit !important; }
			`),e.listDropBetweenBackground&&(n.push(`
			.monaco-list${t} .monaco-list-rows.drop-target-before .monaco-list-row:first-child::before,
			.monaco-list${t} .monaco-list-row.drop-target-before::before {
				content: ""; position: absolute; top: 0px; left: 0px; width: 100%; height: 1px;
				background-color: ${e.listDropBetweenBackground};
			}`),n.push(`
			.monaco-list${t} .monaco-list-rows.drop-target-after .monaco-list-row:last-child::after,
			.monaco-list${t} .monaco-list-row.drop-target-after::after {
				content: ""; position: absolute; bottom: 0px; left: 0px; width: 100%; height: 1px;
				background-color: ${e.listDropBetweenBackground};
			}`)),e.tableColumnsBorder&&n.push(`
				.monaco-table > .monaco-split-view2,
				.monaco-table > .monaco-split-view2 .monaco-sash.vertical::before,
				.monaco-workbench:not(.reduce-motion) .monaco-table:hover > .monaco-split-view2,
				.monaco-workbench:not(.reduce-motion) .monaco-table:hover > .monaco-split-view2 .monaco-sash.vertical::before {
					border-color: ${e.tableColumnsBorder};
				}

				.monaco-workbench:not(.reduce-motion) .monaco-table > .monaco-split-view2,
				.monaco-workbench:not(.reduce-motion) .monaco-table > .monaco-split-view2 .monaco-sash.vertical::before {
					border-color: transparent;
				}
			`),e.tableOddRowsBackgroundColor&&n.push(`
				.monaco-table .monaco-list-row[data-parity=odd]:not(.focused):not(.selected):not(:hover) .monaco-table-tr,
				.monaco-table .monaco-list:not(:focus) .monaco-list-row[data-parity=odd].focused:not(.selected):not(:hover) .monaco-table-tr,
				.monaco-table .monaco-list:not(.focused) .monaco-list-row[data-parity=odd].focused:not(.selected):not(:hover) .monaco-table-tr {
					background-color: ${e.tableOddRowsBackgroundColor};
				}
			`),this.styleElement.textContent=n.join(`
`)}},aF={listFocusBackground:"#7FB0D0",listActiveSelectionBackground:"#0E639C",listActiveSelectionForeground:"#FFFFFF",listActiveSelectionIconForeground:"#FFFFFF",listFocusAndSelectionOutline:"#90C2F9",listFocusAndSelectionBackground:"#094771",listFocusAndSelectionForeground:"#FFFFFF",listInactiveSelectionBackground:"#3F3F46",listInactiveSelectionIconForeground:"#FFFFFF",listHoverBackground:"#2A2D2E",listDropOverBackground:"#383B3D",listDropBetweenBackground:"#EEEEEE",treeIndentGuidesStroke:"#a9a9a9",treeInactiveIndentGuidesStroke:N.fromHex("#a9a9a9").transparent(.4).toString(),tableColumnsBorder:N.fromHex("#cccccc").transparent(.2).toString(),tableOddRowsBackgroundColor:N.fromHex("#cccccc").transparent(.04).toString(),listBackground:void 0,listFocusForeground:void 0,listInactiveSelectionForeground:void 0,listInactiveFocusForeground:void 0,listInactiveFocusBackground:void 0,listHoverForeground:void 0,listFocusOutline:void 0,listInactiveFocusOutline:void 0,listSelectionOutline:void 0,listHoverOutline:void 0,treeStickyScrollBackground:void 0,treeStickyScrollBorder:void 0,treeStickyScrollShadow:void 0},LU={keyboardSupport:!0,mouseSupport:!0,multipleSelectionSupport:!0,dnd:{getDragURI(){return null},onDragStart(){},onDragOver(){return!1},drop(){},dispose(){}}};function DU(o,e){let t=o.indexOf(e);if(t===-1)return[];let n=[],i=t-1;for(;i>=0&&o[i]===e-(t-i);)n.push(o[i--]);for(n.reverse(),i=t;i<o.length&&o[i]===e+(i-t);)n.push(o[i++]);return n}function E0(o,e){let t=[],n=0,i=0;for(;n<o.length||i<e.length;)if(n>=o.length)t.push(e[i++]);else if(i>=e.length)t.push(o[n++]);else if(o[n]===e[i]){t.push(o[n]),n++,i++;continue}else o[n]<e[i]?t.push(o[n++]):t.push(e[i++]);return t}function kU(o,e){let t=[],n=0,i=0;for(;n<o.length||i<e.length;)if(n>=o.length)t.push(e[i++]);else if(i>=e.length)t.push(o[n++]);else if(o[n]===e[i]){n++,i++;continue}else o[n]<e[i]?t.push(o[n++]):i++;return t}var rF=(o,e)=>o-e,_0=class{constructor(e,t){this._templateId=e;this.renderers=t}get templateId(){return this._templateId}renderTemplate(e){return this.renderers.map(t=>t.renderTemplate(e))}renderElement(e,t,n,i){let r=0;for(let s of this.renderers)s.renderElement(e,t,n[r++],i)}disposeElement(e,t,n,i){let r=0;for(let s of this.renderers)s.disposeElement?.(e,t,n[r],i),r+=1}disposeTemplate(e){let t=0;for(let n of this.renderers)n.disposeTemplate(e[t++])}},T0=class{constructor(e){this.accessibilityProvider=e}templateId="a18n";renderTemplate(e){return{container:e,disposables:new he}}renderElement(e,t,n){let i=this.accessibilityProvider.getAriaLabel(e),r=i&&typeof i!="string"?i:Wf(i);n.disposables.add($a(a=>{this.setAriaLabel(a.readObservable(r),n.container)}));let s=this.accessibilityProvider.getAriaLevel&&this.accessibilityProvider.getAriaLevel(e);typeof s=="number"?n.container.setAttribute("aria-level",`${s}`):n.container.removeAttribute("aria-level")}setAriaLabel(e,t){e?t.setAttribute("aria-label",e):t.removeAttribute("aria-label")}disposeElement(e,t,n,i){n.disposables.clear()}disposeTemplate(e){e.disposables.dispose()}},L0=class{constructor(e,t){this.list=e;this.dnd=t}getDragElements(e){let t=this.list.getSelectedElements();return t.indexOf(e)>-1?t:[e]}getDragURI(e){return this.dnd.getDragURI(e)}getDragLabel(e,t){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(e,t)}onDragStart(e,t){this.dnd.onDragStart?.(e,t)}onDragOver(e,t,n,i,r){return this.dnd.onDragOver(e,t,n,i,r)}onDragLeave(e,t,n,i){this.dnd.onDragLeave?.(e,t,n,i)}onDragEnd(e){this.dnd.onDragEnd?.(e)}drop(e,t,n,i,r){this.dnd.drop(e,t,n,i,r)}dispose(){this.dnd.dispose()}},$o=class{constructor(e,t,n,i,r=LU){this.user=e;this._options=r;let s=this._options.accessibilityProvider&&this._options.accessibilityProvider.getWidgetRole?this._options.accessibilityProvider?.getWidgetRole():"list";this.selection=new C0(s!=="listbox");let a=[this.focus.renderer,this.selection.renderer];this.accessibilityProvider=r.accessibilityProvider,this.accessibilityProvider&&(a.push(new T0(this.accessibilityProvider)),this.accessibilityProvider.onDidChangeActiveDescendant?.(this.onDidChangeActiveDescendant,this,this.disposables)),i=i.map(d=>new _0(d.templateId,[...a,d]));let l={...r,dnd:r.dnd&&new L0(this,r.dnd)};if(this.view=this.createListView(t,n,i,l),this.view.domNode.setAttribute("role",s),r.styleController)this.styleController=r.styleController(this.view.domId);else{let d=us(this.view.domNode);this.styleController=new x0(d,this.view.domId)}if(this.spliceable=new PS([new Zg(this.focus,this.view,r.identityProvider),new Zg(this.selection,this.view,r.identityProvider),new Zg(this.anchor,this.view,r.identityProvider),this.view]),this.disposables.add(this.focus),this.disposables.add(this.selection),this.disposables.add(this.anchor),this.disposables.add(this.view),this.disposables.add(this._onDidDispose),this.disposables.add(new w0(this,this.view)),(typeof r.keyboardSupport!="boolean"||r.keyboardSupport)&&(this.keyboardController=new US(this,this.view,r),this.disposables.add(this.keyboardController)),r.keyboardNavigationLabelProvider){let d=r.keyboardNavigationDelegate||xU;this.typeNavigationController=new S0(this,this.view,r.keyboardNavigationLabelProvider,r.keyboardNavigationEventFilter??(()=>!0),d),this.disposables.add(this.typeNavigationController)}this.mouseController=this.createMouseController(r),this.disposables.add(this.mouseController),this.onDidChangeFocus(this._onFocusChange,this,this.disposables),this.onDidChangeSelection(this._onSelectionChange,this,this.disposables),this.accessibilityProvider&&(this.ariaLabel=this.accessibilityProvider.getWidgetAriaLabel()),this._options.multipleSelectionSupport!==!1&&this.view.domNode.setAttribute("aria-multiselectable","true")}focus=new ep("focused");selection;anchor=new ep("anchor");eventBufferer=new zc;view;spliceable;styleController;typeNavigationController;accessibilityProvider;keyboardController;mouseController;_ariaLabel="";disposables=new he;get onDidChangeFocus(){return oe.map(this.eventBufferer.wrapEvent(this.focus.onChange),e=>this.toListEvent(e),this.disposables)}get onDidChangeSelection(){return oe.map(this.eventBufferer.wrapEvent(this.selection.onChange),e=>this.toListEvent(e),this.disposables)}get domId(){return this.view.domId}get onDidScroll(){return this.view.onDidScroll}get onMouseClick(){return this.view.onMouseClick}get onMouseDblClick(){return this.view.onMouseDblClick}get onMouseMiddleClick(){return this.view.onMouseMiddleClick}get onPointer(){return this.mouseController.onPointer}get onMouseUp(){return this.view.onMouseUp}get onMouseDown(){return this.view.onMouseDown}get onMouseOver(){return this.view.onMouseOver}get onMouseMove(){return this.view.onMouseMove}get onMouseOut(){return this.view.onMouseOut}get onTouchStart(){return this.view.onTouchStart}get onTap(){return this.view.onTap}get onContextMenu(){let e=!1,t=oe.chain(this.disposables.add(new Fe(this.view.domNode,"keydown")).event,r=>r.map(s=>new nt(s)).filter(s=>e=s.keyCode===58||s.shiftKey&&s.keyCode===68).map(s=>$e.stop(s,!0)).filter(()=>!1)),n=oe.chain(this.disposables.add(new Fe(this.view.domNode,"keyup")).event,r=>r.forEach(()=>e=!1).map(s=>new nt(s)).filter(s=>s.keyCode===58||s.shiftKey&&s.keyCode===68).map(s=>$e.stop(s,!0)).map(({browserEvent:s})=>{let a=this.getFocus(),l=a.length?a[0]:void 0,d=typeof l<"u"?this.view.element(l):void 0,c=typeof l<"u"?this.view.domElement(l):this.view.domNode;return{index:l,element:d,anchor:c,browserEvent:s}})),i=oe.chain(this.view.onContextMenu,r=>r.filter(s=>!e).map(({element:s,index:a,browserEvent:l})=>({element:s,index:a,anchor:new hi(Ie(this.view.domNode),l),browserEvent:l})));return oe.any(t,n,i)}get onKeyDown(){return this.disposables.add(new Fe(this.view.domNode,"keydown")).event}get onKeyUp(){return this.disposables.add(new Fe(this.view.domNode,"keyup")).event}get onKeyPress(){return this.disposables.add(new Fe(this.view.domNode,"keypress")).event}get onDidFocus(){return oe.signal(this.disposables.add(new Fe(this.view.domNode,"focus",!0)).event)}get onDidBlur(){return oe.signal(this.disposables.add(new Fe(this.view.domNode,"blur",!0)).event)}_onDidDispose=new E;onDidDispose=this._onDidDispose.event;createListView(e,t,n,i){return new HS(e,t,n,i)}createMouseController(e){return new zS(this)}updateOptions(e={}){this._options={...this._options,...e},this.typeNavigationController?.updateOptions(this._options),this._options.multipleSelectionController!==void 0&&(this._options.multipleSelectionSupport?this.view.domNode.setAttribute("aria-multiselectable","true"):this.view.domNode.removeAttribute("aria-multiselectable")),this.mouseController.updateOptions(e),this.keyboardController?.updateOptions(e),this.view.updateOptions(e)}get options(){return this._options}splice(e,t,n=[]){if(e<0||e>this.view.length)throw new Hs(this.user,`Invalid start index: ${e}`);if(t<0)throw new Hs(this.user,`Invalid delete count: ${t}`);t===0&&n.length===0||this.eventBufferer.bufferEvents(()=>this.spliceable.splice(e,t,n))}updateWidth(e){this.view.updateWidth(e)}updateElementHeight(e,t){this.view.updateElementHeight(e,t,null)}rerender(){this.view.rerender()}element(e){return this.view.element(e)}indexOf(e){return this.view.indexOf(e)}indexAt(e){return this.view.indexAt(e)}get length(){return this.view.length}get contentHeight(){return this.view.contentHeight}get contentWidth(){return this.view.contentWidth}get onDidChangeContentHeight(){return this.view.onDidChangeContentHeight}get onDidChangeContentWidth(){return this.view.onDidChangeContentWidth}get scrollTop(){return this.view.getScrollTop()}set scrollTop(e){this.view.setScrollTop(e)}get scrollLeft(){return this.view.getScrollLeft()}set scrollLeft(e){this.view.setScrollLeft(e)}get scrollHeight(){return this.view.scrollHeight}get renderHeight(){return this.view.renderHeight}get firstVisibleIndex(){return this.view.firstVisibleIndex}get firstMostlyVisibleIndex(){return this.view.firstMostlyVisibleIndex}get lastVisibleIndex(){return this.view.lastVisibleIndex}get ariaLabel(){return this._ariaLabel}set ariaLabel(e){this._ariaLabel=e,this.view.domNode.setAttribute("aria-label",e)}domFocus(){this.view.domNode.focus({preventScroll:!0})}layout(e,t){this.view.layout(e,t)}triggerTypeNavigation(){this.typeNavigationController?.trigger()}setSelection(e,t){for(let n of e)if(n<0||n>=this.length)throw new Hs(this.user,`Invalid index ${n}`);this.selection.set(e,t)}getSelection(){return this.selection.get()}getSelectedElements(){return this.getSelection().map(e=>this.view.element(e))}setAnchor(e){if(typeof e>"u"){this.anchor.set([]);return}if(e<0||e>=this.length)throw new Hs(this.user,`Invalid index ${e}`);this.anchor.set([e])}getAnchor(){return this.anchor.get().at(0)}getAnchorElement(){let e=this.getAnchor();return typeof e>"u"?void 0:this.element(e)}setFocus(e,t){for(let n of e)if(n<0||n>=this.length)throw new Hs(this.user,`Invalid index ${n}`);this.focus.set(e,t)}focusNext(e=1,t=!1,n,i){if(this.length===0)return;let r=this.focus.get(),s=this.findNextIndex(r.length>0?r[0]+e:0,t,i);s>-1&&this.setFocus([s],n)}focusPrevious(e=1,t=!1,n,i){if(this.length===0)return;let r=this.focus.get(),s=this.findPreviousIndex(r.length>0?r[0]-e:0,t,i);s>-1&&this.setFocus([s],n)}async focusNextPage(e,t){let n=this.view.indexAt(this.view.getScrollTop()+this.view.renderHeight);n=n===0?0:n-1;let i=this.getFocus()[0];if(i!==n&&(i===void 0||n>i)){let r=this.findPreviousIndex(n,!1,t);r>-1&&i!==r?this.setFocus([r],e):this.setFocus([n],e)}else{let r=this.view.getScrollTop(),s=r+this.view.renderHeight;n>i&&(s-=this.view.elementHeight(n)),this.view.setScrollTop(s),this.view.getScrollTop()!==r&&(this.setFocus([]),await vo(0),await this.focusNextPage(e,t))}}async focusPreviousPage(e,t,n=()=>0){let i,r=n(),s=this.view.getScrollTop()+r;s===0?i=this.view.indexAt(s):i=this.view.indexAfter(s-1);let a=this.getFocus()[0];if(a!==i&&(a===void 0||a>=i)){let l=this.findNextIndex(i,!1,t);l>-1&&a!==l?this.setFocus([l],e):this.setFocus([i],e)}else{let l=s;this.view.setScrollTop(s-this.view.renderHeight-r),this.view.getScrollTop()+n()!==l&&(this.setFocus([]),await vo(0),await this.focusPreviousPage(e,t,n))}}focusLast(e,t){if(this.length===0)return;let n=this.findPreviousIndex(this.length-1,!1,t);n>-1&&this.setFocus([n],e)}focusFirst(e,t){this.focusNth(0,e,t)}focusNth(e,t,n){if(this.length===0)return;let i=this.findNextIndex(e,!1,n);i>-1&&this.setFocus([i],t)}findNextIndex(e,t=!1,n){for(let i=0;i<this.length;i++){if(e>=this.length&&!t)return-1;if(e=e%this.length,!n||n(this.element(e)))return e;e++}return-1}findPreviousIndex(e,t=!1,n){for(let i=0;i<this.length;i++){if(e<0&&!t)return-1;if(e=(this.length+e%this.length)%this.length,!n||n(this.element(e)))return e;e--}return-1}getFocus(){return this.focus.get()}getFocusedElements(){return this.getFocus().map(e=>this.view.element(e))}reveal(e,t,n=0){if(e<0||e>=this.length)throw new Hs(this.user,`Invalid index ${e}`);let i=this.view.getScrollTop(),r=this.view.elementTop(e),s=this.view.elementHeight(e);if(yi(t)){let a=s-this.view.renderHeight+n;this.view.setScrollTop(a*eu(t,0,1)+r-n)}else{let a=r+s,l=i+this.view.renderHeight;r<i+n&&a>=l||(r<i+n||a>=l&&s>=this.view.renderHeight?this.view.setScrollTop(r-n):a>=l&&this.view.setScrollTop(a-this.view.renderHeight))}}getRelativeTop(e,t=0){if(e<0||e>=this.length)throw new Hs(this.user,`Invalid index ${e}`);let n=this.view.getScrollTop(),i=this.view.elementTop(e),r=this.view.elementHeight(e);if(i<n+t||i+r>n+this.view.renderHeight)return null;let s=r-this.view.renderHeight+t;return Math.abs((n+t-i)/s)}isDOMFocused(){return er(this.view.domNode)}getHTMLElement(){return this.view.domNode}getScrollableElement(){return this.view.scrollableElementDomNode}getElementID(e){return this.view.getElementDomId(e)}getElementTop(e){return this.view.elementTop(e)}style(e){this.styleController.style(e)}toListEvent({indexes:e,browserEvent:t}){return{indexes:e,elements:e.map(n=>this.view.element(n)),browserEvent:t}}_onFocusChange(){let e=this.focus.get();this.view.domNode.classList.toggle("element-focused",e.length>0),this.onDidChangeActiveDescendant()}onDidChangeActiveDescendant(){let e=this.focus.get();if(e.length>0){let t;this.accessibilityProvider?.getActiveDescendantId&&(t=this.accessibilityProvider.getActiveDescendantId(this.view.element(e[0]))),this.view.domNode.setAttribute("aria-activedescendant",t||this.view.getElementDomId(e[0]))}else this.view.domNode.removeAttribute("aria-activedescendant")}_onSelectionChange(){let e=this.selection.get();this.view.domNode.classList.toggle("selection-none",e.length===0),this.view.domNode.classList.toggle("selection-single",e.length===1),this.view.domNode.classList.toggle("selection-multiple",e.length>1)}dispose(){this._onDidDispose.fire(),this.disposables.dispose(),this._onDidDispose.dispose()}};R([de],$o.prototype,"onDidChangeFocus",1),R([de],$o.prototype,"onDidChangeSelection",1),R([de],$o.prototype,"onContextMenu",1),R([de],$o.prototype,"onKeyDown",1),R([de],$o.prototype,"onKeyUp",1),R([de],$o.prototype,"onKeyPress",1),R([de],$o.prototype,"onDidFocus",1),R([de],$o.prototype,"onDidBlur",1);var RU=new RegExp(`(\\\\)?\\$\\((${Je.iconNameExpression}(?:${Je.iconModifierExpression})?)\\)`,"g");function KS(o){let e=new Array,t,n=0,i=0;for(;(t=RU.exec(o))!==null;){i=t.index||0,n<i&&e.push(o.substring(n,i)),n=(t.index||0)+t[0].length;let[,r,s]=t;e.push(r?`$(${s})`:MU({id:s}))}return n<o.length&&e.push(o.substring(n)),e}function MU(o){let e=We("span");return e.classList.add(...Je.asClassNameArray(o)),e}var D0=class{_prefix;_lastId;constructor(e){this._prefix=e,this._lastId=0}nextId(){return this._prefix+ ++this._lastId}},k0=new D0("id#");var ri={};(function(){function o(e,t){t(ri)}o.amd=!0,function(e,t){typeof o=="function"&&o.amd?o(["exports"],t):typeof exports=="object"&&typeof module<"u"?t(exports):(e=typeof globalThis<"u"?globalThis:e||self,t(e.marked={}))}(this,function(e){"use strict";function t(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}e.defaults=t();function n(Pe){e.defaults=Pe}let i=/[&<>"']/,r=new RegExp(i.source,"g"),s=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,a=new RegExp(s.source,"g"),l={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},d=Pe=>l[Pe];function c(Pe,w){if(w){if(i.test(Pe))return Pe.replace(r,d)}else if(s.test(Pe))return Pe.replace(a,d);return Pe}let u=/(^|[^\[])\^/g;function h(Pe,w){let _=typeof Pe=="string"?Pe:Pe.source;w=w||"";let T={replace:(A,F)=>{let $=typeof F=="string"?F:F.source;return $=$.replace(u,"$1"),_=_.replace(A,$),T},getRegex:()=>new RegExp(_,w)};return T}function m(Pe){try{Pe=encodeURI(Pe).replace(/%25/g,"%")}catch{return null}return Pe}let f={exec:()=>null};function g(Pe,w){let _=Pe.replace(/\|/g,(F,$,J)=>{let Se=!1,_e=$;for(;--_e>=0&&J[_e]==="\\";)Se=!Se;return Se?"|":" |"}),T=_.split(/ \|/),A=0;if(T[0].trim()||T.shift(),T.length>0&&!T[T.length-1].trim()&&T.pop(),w)if(T.length>w)T.splice(w);else for(;T.length<w;)T.push("");for(;A<T.length;A++)T[A]=T[A].trim().replace(/\\\|/g,"|");return T}function b(Pe,w,_){let T=Pe.length;if(T===0)return"";let A=0;for(;A<T;){let F=Pe.charAt(T-A-1);if(F===w&&!_)A++;else if(F!==w&&_)A++;else break}return Pe.slice(0,T-A)}function y(Pe,w){if(Pe.indexOf(w[1])===-1)return-1;let _=0;for(let T=0;T<Pe.length;T++)if(Pe[T]==="\\")T++;else if(Pe[T]===w[0])_++;else if(Pe[T]===w[1]&&(_--,_<0))return T;return-1}function C(Pe,w,_,T){let A=w.href,F=w.title?c(w.title):null,$=Pe[1].replace(/\\([\[\]])/g,"$1");if(Pe[0].charAt(0)!=="!"){T.state.inLink=!0;let J={type:"link",raw:_,href:A,title:F,text:$,tokens:T.inlineTokens($)};return T.state.inLink=!1,J}return{type:"image",raw:_,href:A,title:F,text:c($)}}function x(Pe,w){let _=Pe.match(/^(\s+)(?:```)/);if(_===null)return w;let T=_[1];return w.split(`
`).map(A=>{let F=A.match(/^\s+/);if(F===null)return A;let[$]=F;return $.length>=T.length?A.slice(T.length):A}).join(`
`)}class L{options;rules;lexer;constructor(w){this.options=w||e.defaults}space(w){let _=this.rules.block.newline.exec(w);if(_&&_[0].length>0)return{type:"space",raw:_[0]}}code(w){let _=this.rules.block.code.exec(w);if(_){let T=_[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:_[0],codeBlockStyle:"indented",text:this.options.pedantic?T:b(T,`
`)}}}fences(w){let _=this.rules.block.fences.exec(w);if(_){let T=_[0],A=x(T,_[3]||"");return{type:"code",raw:T,lang:_[2]?_[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):_[2],text:A}}}heading(w){let _=this.rules.block.heading.exec(w);if(_){let T=_[2].trim();if(/#$/.test(T)){let A=b(T,"#");(this.options.pedantic||!A||/ $/.test(A))&&(T=A.trim())}return{type:"heading",raw:_[0],depth:_[1].length,text:T,tokens:this.lexer.inline(T)}}}hr(w){let _=this.rules.block.hr.exec(w);if(_)return{type:"hr",raw:b(_[0],`
`)}}blockquote(w){let _=this.rules.block.blockquote.exec(w);if(_){let T=b(_[0],`
`).split(`
`),A="",F="",$=[];for(;T.length>0;){let J=!1,Se=[],_e;for(_e=0;_e<T.length;_e++)if(/^ {0,3}>/.test(T[_e]))Se.push(T[_e]),J=!0;else if(!J)Se.push(T[_e]);else break;T=T.slice(_e);let Ze=Se.join(`
`),bt=Ze.replace(/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,`
    $1`).replace(/^ {0,3}>[ \t]?/gm,"");A=A?`${A}
${Ze}`:Ze,F=F?`${F}
${bt}`:bt;let Vt=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(bt,$,!0),this.lexer.state.top=Vt,T.length===0)break;let bn=$[$.length-1];if(bn?.type==="code")break;if(bn?.type==="blockquote"){let jt=bn,Re=jt.raw+`
`+T.join(`
`),H=this.blockquote(Re);$[$.length-1]=H,A=A.substring(0,A.length-jt.raw.length)+H.raw,F=F.substring(0,F.length-jt.text.length)+H.text;break}else if(bn?.type==="list"){let jt=bn,Re=jt.raw+`
`+T.join(`
`),H=this.list(Re);$[$.length-1]=H,A=A.substring(0,A.length-bn.raw.length)+H.raw,F=F.substring(0,F.length-jt.raw.length)+H.raw,T=Re.substring($[$.length-1].raw.length).split(`
`);continue}}return{type:"blockquote",raw:A,tokens:$,text:F}}}list(w){let _=this.rules.block.list.exec(w);if(_){let T=_[1].trim(),A=T.length>1,F={type:"list",raw:"",ordered:A,start:A?+T.slice(0,-1):"",loose:!1,items:[]};T=A?`\\d{1,9}\\${T.slice(-1)}`:`\\${T}`,this.options.pedantic&&(T=A?T:"[*+-]");let $=new RegExp(`^( {0,3}${T})((?:[	 ][^\\n]*)?(?:\\n|$))`),J=!1;for(;w;){let Se=!1,_e="",Ze="";if(!(_=$.exec(w))||this.rules.block.hr.test(w))break;_e=_[0],w=w.substring(_e.length);let bt=_[2].split(`
`,1)[0].replace(/^\t+/,fe=>" ".repeat(3*fe.length)),Vt=w.split(`
`,1)[0],bn=!bt.trim(),jt=0;if(this.options.pedantic?(jt=2,Ze=bt.trimStart()):bn?jt=_[1].length+1:(jt=_[2].search(/[^ ]/),jt=jt>4?1:jt,Ze=bt.slice(jt),jt+=_[1].length),bn&&/^ *$/.test(Vt)&&(_e+=Vt+`
`,w=w.substring(Vt.length+1),Se=!0),!Se){let fe=new RegExp(`^ {0,${Math.min(3,jt-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),Le=new RegExp(`^ {0,${Math.min(3,jt-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),Nt=new RegExp(`^ {0,${Math.min(3,jt-1)}}(?:\`\`\`|~~~)`),En=new RegExp(`^ {0,${Math.min(3,jt-1)}}#`);for(;w;){let Mi=w.split(`
`,1)[0];if(Vt=Mi,this.options.pedantic&&(Vt=Vt.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),Nt.test(Vt)||En.test(Vt)||fe.test(Vt)||Le.test(w))break;if(Vt.search(/[^ ]/)>=jt||!Vt.trim())Ze+=`
`+Vt.slice(jt);else{if(bn||bt.search(/[^ ]/)>=4||Nt.test(bt)||En.test(bt)||Le.test(bt))break;Ze+=`
`+Vt}!bn&&!Vt.trim()&&(bn=!0),_e+=Mi+`
`,w=w.substring(Mi.length+1),bt=Vt.slice(jt)}}F.loose||(J?F.loose=!0:/\n *\n *$/.test(_e)&&(J=!0));let Re=null,H;this.options.gfm&&(Re=/^\[[ xX]\] /.exec(Ze),Re&&(H=Re[0]!=="[ ] ",Ze=Ze.replace(/^\[[ xX]\] +/,""))),F.items.push({type:"list_item",raw:_e,task:!!Re,checked:H,loose:!1,text:Ze,tokens:[]}),F.raw+=_e}F.items[F.items.length-1].raw=F.items[F.items.length-1].raw.trimEnd(),F.items[F.items.length-1].text=F.items[F.items.length-1].text.trimEnd(),F.raw=F.raw.trimEnd();for(let Se=0;Se<F.items.length;Se++)if(this.lexer.state.top=!1,F.items[Se].tokens=this.lexer.blockTokens(F.items[Se].text,[]),!F.loose){let _e=F.items[Se].tokens.filter(bt=>bt.type==="space"),Ze=_e.length>0&&_e.some(bt=>/\n.*\n/.test(bt.raw));F.loose=Ze}if(F.loose)for(let Se=0;Se<F.items.length;Se++)F.items[Se].loose=!0;return F}}html(w){let _=this.rules.block.html.exec(w);if(_)return{type:"html",block:!0,raw:_[0],pre:_[1]==="pre"||_[1]==="script"||_[1]==="style",text:_[0]}}def(w){let _=this.rules.block.def.exec(w);if(_){let T=_[1].toLowerCase().replace(/\s+/g," "),A=_[2]?_[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",F=_[3]?_[3].substring(1,_[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):_[3];return{type:"def",tag:T,raw:_[0],href:A,title:F}}}table(w){let _=this.rules.block.table.exec(w);if(!_||!/[:|]/.test(_[2]))return;let T=g(_[1]),A=_[2].replace(/^\||\| *$/g,"").split("|"),F=_[3]&&_[3].trim()?_[3].replace(/\n[ \t]*$/,"").split(`
`):[],$={type:"table",raw:_[0],header:[],align:[],rows:[]};if(T.length===A.length){for(let J of A)/^ *-+: *$/.test(J)?$.align.push("right"):/^ *:-+: *$/.test(J)?$.align.push("center"):/^ *:-+ *$/.test(J)?$.align.push("left"):$.align.push(null);for(let J=0;J<T.length;J++)$.header.push({text:T[J],tokens:this.lexer.inline(T[J]),header:!0,align:$.align[J]});for(let J of F)$.rows.push(g(J,$.header.length).map((Se,_e)=>({text:Se,tokens:this.lexer.inline(Se),header:!1,align:$.align[_e]})));return $}}lheading(w){let _=this.rules.block.lheading.exec(w);if(_)return{type:"heading",raw:_[0],depth:_[2].charAt(0)==="="?1:2,text:_[1],tokens:this.lexer.inline(_[1])}}paragraph(w){let _=this.rules.block.paragraph.exec(w);if(_){let T=_[1].charAt(_[1].length-1)===`
`?_[1].slice(0,-1):_[1];return{type:"paragraph",raw:_[0],text:T,tokens:this.lexer.inline(T)}}}text(w){let _=this.rules.block.text.exec(w);if(_)return{type:"text",raw:_[0],text:_[0],tokens:this.lexer.inline(_[0])}}escape(w){let _=this.rules.inline.escape.exec(w);if(_)return{type:"escape",raw:_[0],text:c(_[1])}}tag(w){let _=this.rules.inline.tag.exec(w);if(_)return!this.lexer.state.inLink&&/^<a /i.test(_[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(_[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(_[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(_[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:_[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:_[0]}}link(w){let _=this.rules.inline.link.exec(w);if(_){let T=_[2].trim();if(!this.options.pedantic&&/^</.test(T)){if(!/>$/.test(T))return;let $=b(T.slice(0,-1),"\\");if((T.length-$.length)%2===0)return}else{let $=y(_[2],"()");if($>-1){let Se=(_[0].indexOf("!")===0?5:4)+_[1].length+$;_[2]=_[2].substring(0,$),_[0]=_[0].substring(0,Se).trim(),_[3]=""}}let A=_[2],F="";if(this.options.pedantic){let $=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(A);$&&(A=$[1],F=$[3])}else F=_[3]?_[3].slice(1,-1):"";return A=A.trim(),/^</.test(A)&&(this.options.pedantic&&!/>$/.test(T)?A=A.slice(1):A=A.slice(1,-1)),C(_,{href:A&&A.replace(this.rules.inline.anyPunctuation,"$1"),title:F&&F.replace(this.rules.inline.anyPunctuation,"$1")},_[0],this.lexer)}}reflink(w,_){let T;if((T=this.rules.inline.reflink.exec(w))||(T=this.rules.inline.nolink.exec(w))){let A=(T[2]||T[1]).replace(/\s+/g," "),F=_[A.toLowerCase()];if(!F){let $=T[0].charAt(0);return{type:"text",raw:$,text:$}}return C(T,F,T[0],this.lexer)}}emStrong(w,_,T=""){let A=this.rules.inline.emStrongLDelim.exec(w);if(!A||A[3]&&T.match(/[\p{L}\p{N}]/u))return;if(!(A[1]||A[2]||"")||!T||this.rules.inline.punctuation.exec(T)){let $=[...A[0]].length-1,J,Se,_e=$,Ze=0,bt=A[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(bt.lastIndex=0,_=_.slice(-1*w.length+$);(A=bt.exec(_))!=null;){if(J=A[1]||A[2]||A[3]||A[4]||A[5]||A[6],!J)continue;if(Se=[...J].length,A[3]||A[4]){_e+=Se;continue}else if((A[5]||A[6])&&$%3&&!(($+Se)%3)){Ze+=Se;continue}if(_e-=Se,_e>0)continue;Se=Math.min(Se,Se+_e+Ze);let Vt=[...A[0]][0].length,bn=w.slice(0,$+A.index+Vt+Se);if(Math.min($,Se)%2){let Re=bn.slice(1,-1);return{type:"em",raw:bn,text:Re,tokens:this.lexer.inlineTokens(Re)}}let jt=bn.slice(2,-2);return{type:"strong",raw:bn,text:jt,tokens:this.lexer.inlineTokens(jt)}}}}codespan(w){let _=this.rules.inline.code.exec(w);if(_){let T=_[2].replace(/\n/g," "),A=/[^ ]/.test(T),F=/^ /.test(T)&&/ $/.test(T);return A&&F&&(T=T.substring(1,T.length-1)),T=c(T,!0),{type:"codespan",raw:_[0],text:T}}}br(w){let _=this.rules.inline.br.exec(w);if(_)return{type:"br",raw:_[0]}}del(w){let _=this.rules.inline.del.exec(w);if(_)return{type:"del",raw:_[0],text:_[2],tokens:this.lexer.inlineTokens(_[2])}}autolink(w){let _=this.rules.inline.autolink.exec(w);if(_){let T,A;return _[2]==="@"?(T=c(_[1]),A="mailto:"+T):(T=c(_[1]),A=T),{type:"link",raw:_[0],text:T,href:A,tokens:[{type:"text",raw:T,text:T}]}}}url(w){let _;if(_=this.rules.inline.url.exec(w)){let T,A;if(_[2]==="@")T=c(_[0]),A="mailto:"+T;else{let F;do F=_[0],_[0]=this.rules.inline._backpedal.exec(_[0])?.[0]??"";while(F!==_[0]);T=c(_[0]),_[1]==="www."?A="http://"+_[0]:A=_[0]}return{type:"link",raw:_[0],text:T,href:A,tokens:[{type:"text",raw:T,text:T}]}}}inlineText(w){let _=this.rules.inline.text.exec(w);if(_){let T;return this.lexer.state.inRawBlock?T=_[0]:T=c(_[0]),{type:"text",raw:_[0],text:T}}}}let k=/^(?: *(?:\n|$))+/,O=/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,W=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,z=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,B=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,G=/(?:[*+-]|\d{1,9}[.)])/,q=h(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,G).replace(/blockCode/g,/ {4}/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),X=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,ce=/^[^\n]+/,Ce=/(?!\s*\])(?:\\.|[^\[\]\\])+/,te=h(/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/).replace("label",Ce).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),Z=h(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,G).getRegex(),le="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",ne=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,Q=h("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))","i").replace("comment",ne).replace("tag",le).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),we=h(X).replace("hr",z).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",le).getRegex(),st={blockquote:h(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",we).getRegex(),code:O,def:te,fences:W,heading:B,hr:z,html:Q,lheading:q,list:Z,newline:k,paragraph:we,table:f,text:ce},Xe=h("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",z).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",le).getRegex(),ke={...st,table:Xe,paragraph:h(X).replace("hr",z).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Xe).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",le).getRegex()},$n={...st,html:h(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",ne).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:f,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:h(X).replace("hr",z).replace("heading",` *#{1,6} *[^
]`).replace("lheading",q).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},xn=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,ji=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,po=/^( {2,}|\\)\n(?!\s*$)/,Aa=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,ai="\\p{P}\\p{S}",mr=h(/^((?![*_])[\spunctuation])/,"u").replace(/punctuation/g,ai).getRegex(),Yl=/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g,Oa=h(/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,"u").replace(/punct/g,ai).getRegex(),li=h("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)[punct](\\*+)(?=[\\s]|$)|[^punct\\s](\\*+)(?!\\*)(?=[punct\\s]|$)|(?!\\*)[punct\\s](\\*+)(?=[^punct\\s])|[\\s](\\*+)(?!\\*)(?=[punct])|(?!\\*)[punct](\\*+)(?!\\*)(?=[punct])|[^punct\\s](\\*+)(?=[^punct\\s])","gu").replace(/punct/g,ai).getRegex(),Na=h("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\\s]|$)|[^punct\\s](_+)(?!_)(?=[punct\\s]|$)|(?!_)[punct\\s](_+)(?=[^punct\\s])|[\\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])","gu").replace(/punct/g,ai).getRegex(),Pa=h(/\\([punct])/,"gu").replace(/punct/g,ai).getRegex(),Rc=h(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),Mc=h(ne).replace("(?:-->|$)","-->").getRegex(),Ae=h("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",Mc).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),$s=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,Fa=h(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",$s).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Xr=h(/^!?\[(label)\]\[(ref)\]/).replace("label",$s).replace("ref",Ce).getRegex(),Yo=h(/^!?\[(ref)\](?:\[\])?/).replace("ref",Ce).getRegex(),pp=h("reflink|nolink(?!\\()","g").replace("reflink",Xr).replace("nolink",Yo).getRegex(),Zl={_backpedal:f,anyPunctuation:Pa,autolink:Rc,blockSkip:Yl,br:po,code:ji,del:f,emStrongLDelim:Oa,emStrongRDelimAst:li,emStrongRDelimUnd:Na,escape:xn,link:Fa,nolink:Yo,punctuation:mr,reflink:Xr,reflinkSearch:pp,tag:Ae,text:Aa,url:f},mp={...Zl,link:h(/^!?\[(label)\]\((.*?)\)/).replace("label",$s).getRegex(),reflink:h(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",$s).getRegex()},Qr={...Zl,escape:h(xn).replace("])","~|])").getRegex(),url:h(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},gp={...Qr,br:h(po).replace("{2,}","*").getRegex(),text:h(Qr.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},Jr={normal:st,gfm:ke,pedantic:$n},Ro={normal:Zl,gfm:Qr,breaks:gp,pedantic:mp};class fn{tokens;options;state;tokenizer;inlineQueue;constructor(w){this.tokens=[],this.tokens.links=Object.create(null),this.options=w||e.defaults,this.options.tokenizer=this.options.tokenizer||new L,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let _={block:Jr.normal,inline:Ro.normal};this.options.pedantic?(_.block=Jr.pedantic,_.inline=Ro.pedantic):this.options.gfm&&(_.block=Jr.gfm,this.options.breaks?_.inline=Ro.breaks:_.inline=Ro.gfm),this.tokenizer.rules=_}static get rules(){return{block:Jr,inline:Ro}}static lex(w,_){return new fn(_).lex(w)}static lexInline(w,_){return new fn(_).inlineTokens(w)}lex(w){w=w.replace(/\r\n|\r/g,`
`),this.blockTokens(w,this.tokens);for(let _=0;_<this.inlineQueue.length;_++){let T=this.inlineQueue[_];this.inlineTokens(T.src,T.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(w,_=[],T=!1){this.options.pedantic?w=w.replace(/\t/g,"    ").replace(/^ +$/gm,""):w=w.replace(/^( *)(\t+)/gm,(J,Se,_e)=>Se+"    ".repeat(_e.length));let A,F,$;for(;w;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(J=>(A=J.call({lexer:this},w,_))?(w=w.substring(A.raw.length),_.push(A),!0):!1))){if(A=this.tokenizer.space(w)){w=w.substring(A.raw.length),A.raw.length===1&&_.length>0?_[_.length-1].raw+=`
`:_.push(A);continue}if(A=this.tokenizer.code(w)){w=w.substring(A.raw.length),F=_[_.length-1],F&&(F.type==="paragraph"||F.type==="text")?(F.raw+=`
`+A.raw,F.text+=`
`+A.text,this.inlineQueue[this.inlineQueue.length-1].src=F.text):_.push(A);continue}if(A=this.tokenizer.fences(w)){w=w.substring(A.raw.length),_.push(A);continue}if(A=this.tokenizer.heading(w)){w=w.substring(A.raw.length),_.push(A);continue}if(A=this.tokenizer.hr(w)){w=w.substring(A.raw.length),_.push(A);continue}if(A=this.tokenizer.blockquote(w)){w=w.substring(A.raw.length),_.push(A);continue}if(A=this.tokenizer.list(w)){w=w.substring(A.raw.length),_.push(A);continue}if(A=this.tokenizer.html(w)){w=w.substring(A.raw.length),_.push(A);continue}if(A=this.tokenizer.def(w)){w=w.substring(A.raw.length),F=_[_.length-1],F&&(F.type==="paragraph"||F.type==="text")?(F.raw+=`
`+A.raw,F.text+=`
`+A.raw,this.inlineQueue[this.inlineQueue.length-1].src=F.text):this.tokens.links[A.tag]||(this.tokens.links[A.tag]={href:A.href,title:A.title});continue}if(A=this.tokenizer.table(w)){w=w.substring(A.raw.length),_.push(A);continue}if(A=this.tokenizer.lheading(w)){w=w.substring(A.raw.length),_.push(A);continue}if($=w,this.options.extensions&&this.options.extensions.startBlock){let J=1/0,Se=w.slice(1),_e;this.options.extensions.startBlock.forEach(Ze=>{_e=Ze.call({lexer:this},Se),typeof _e=="number"&&_e>=0&&(J=Math.min(J,_e))}),J<1/0&&J>=0&&($=w.substring(0,J+1))}if(this.state.top&&(A=this.tokenizer.paragraph($))){F=_[_.length-1],T&&F?.type==="paragraph"?(F.raw+=`
`+A.raw,F.text+=`
`+A.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=F.text):_.push(A),T=$.length!==w.length,w=w.substring(A.raw.length);continue}if(A=this.tokenizer.text(w)){w=w.substring(A.raw.length),F=_[_.length-1],F&&F.type==="text"?(F.raw+=`
`+A.raw,F.text+=`
`+A.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=F.text):_.push(A);continue}if(w){let J="Infinite loop on byte: "+w.charCodeAt(0);if(this.options.silent){console.error(J);break}else throw new Error(J)}}return this.state.top=!0,_}inline(w,_=[]){return this.inlineQueue.push({src:w,tokens:_}),_}inlineTokens(w,_=[]){let T,A,F,$=w,J,Se,_e;if(this.tokens.links){let Ze=Object.keys(this.tokens.links);if(Ze.length>0)for(;(J=this.tokenizer.rules.inline.reflinkSearch.exec($))!=null;)Ze.includes(J[0].slice(J[0].lastIndexOf("[")+1,-1))&&($=$.slice(0,J.index)+"["+"a".repeat(J[0].length-2)+"]"+$.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(J=this.tokenizer.rules.inline.blockSkip.exec($))!=null;)$=$.slice(0,J.index)+"["+"a".repeat(J[0].length-2)+"]"+$.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(J=this.tokenizer.rules.inline.anyPunctuation.exec($))!=null;)$=$.slice(0,J.index)+"++"+$.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;w;)if(Se||(_e=""),Se=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(Ze=>(T=Ze.call({lexer:this},w,_))?(w=w.substring(T.raw.length),_.push(T),!0):!1))){if(T=this.tokenizer.escape(w)){w=w.substring(T.raw.length),_.push(T);continue}if(T=this.tokenizer.tag(w)){w=w.substring(T.raw.length),A=_[_.length-1],A&&T.type==="text"&&A.type==="text"?(A.raw+=T.raw,A.text+=T.text):_.push(T);continue}if(T=this.tokenizer.link(w)){w=w.substring(T.raw.length),_.push(T);continue}if(T=this.tokenizer.reflink(w,this.tokens.links)){w=w.substring(T.raw.length),A=_[_.length-1],A&&T.type==="text"&&A.type==="text"?(A.raw+=T.raw,A.text+=T.text):_.push(T);continue}if(T=this.tokenizer.emStrong(w,$,_e)){w=w.substring(T.raw.length),_.push(T);continue}if(T=this.tokenizer.codespan(w)){w=w.substring(T.raw.length),_.push(T);continue}if(T=this.tokenizer.br(w)){w=w.substring(T.raw.length),_.push(T);continue}if(T=this.tokenizer.del(w)){w=w.substring(T.raw.length),_.push(T);continue}if(T=this.tokenizer.autolink(w)){w=w.substring(T.raw.length),_.push(T);continue}if(!this.state.inLink&&(T=this.tokenizer.url(w))){w=w.substring(T.raw.length),_.push(T);continue}if(F=w,this.options.extensions&&this.options.extensions.startInline){let Ze=1/0,bt=w.slice(1),Vt;this.options.extensions.startInline.forEach(bn=>{Vt=bn.call({lexer:this},bt),typeof Vt=="number"&&Vt>=0&&(Ze=Math.min(Ze,Vt))}),Ze<1/0&&Ze>=0&&(F=w.substring(0,Ze+1))}if(T=this.tokenizer.inlineText(F)){w=w.substring(T.raw.length),T.raw.slice(-1)!=="_"&&(_e=T.raw.slice(-1)),Se=!0,A=_[_.length-1],A&&A.type==="text"?(A.raw+=T.raw,A.text+=T.text):_.push(T);continue}if(w){let Ze="Infinite loop on byte: "+w.charCodeAt(0);if(this.options.silent){console.error(Ze);break}else throw new Error(Ze)}}return _}}class Mo{options;parser;constructor(w){this.options=w||e.defaults}space(w){return""}code({text:w,lang:_,escaped:T}){let A=(_||"").match(/^\S*/)?.[0],F=w.replace(/\n$/,"")+`
`;return A?'<pre><code class="language-'+c(A)+'">'+(T?F:c(F,!0))+`</code></pre>
`:"<pre><code>"+(T?F:c(F,!0))+`</code></pre>
`}blockquote({tokens:w}){return`<blockquote>
${this.parser.parse(w)}</blockquote>
`}html({text:w}){return w}heading({tokens:w,depth:_}){return`<h${_}>${this.parser.parseInline(w)}</h${_}>
`}hr(w){return`<hr>
`}list(w){let _=w.ordered,T=w.start,A="";for(let J=0;J<w.items.length;J++){let Se=w.items[J];A+=this.listitem(Se)}let F=_?"ol":"ul",$=_&&T!==1?' start="'+T+'"':"";return"<"+F+$+`>
`+A+"</"+F+`>
`}listitem(w){let _="";if(w.task){let T=this.checkbox({checked:!!w.checked});w.loose?w.tokens.length>0&&w.tokens[0].type==="paragraph"?(w.tokens[0].text=T+" "+w.tokens[0].text,w.tokens[0].tokens&&w.tokens[0].tokens.length>0&&w.tokens[0].tokens[0].type==="text"&&(w.tokens[0].tokens[0].text=T+" "+w.tokens[0].tokens[0].text)):w.tokens.unshift({type:"text",raw:T+" ",text:T+" "}):_+=T+" "}return _+=this.parser.parse(w.tokens,!!w.loose),`<li>${_}</li>
`}checkbox({checked:w}){return"<input "+(w?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:w}){return`<p>${this.parser.parseInline(w)}</p>
`}table(w){let _="",T="";for(let F=0;F<w.header.length;F++)T+=this.tablecell(w.header[F]);_+=this.tablerow({text:T});let A="";for(let F=0;F<w.rows.length;F++){let $=w.rows[F];T="";for(let J=0;J<$.length;J++)T+=this.tablecell($[J]);A+=this.tablerow({text:T})}return A&&(A=`<tbody>${A}</tbody>`),`<table>
<thead>
`+_+`</thead>
`+A+`</table>
`}tablerow({text:w}){return`<tr>
${w}</tr>
`}tablecell(w){let _=this.parser.parseInline(w.tokens),T=w.header?"th":"td";return(w.align?`<${T} align="${w.align}">`:`<${T}>`)+_+`</${T}>
`}strong({tokens:w}){return`<strong>${this.parser.parseInline(w)}</strong>`}em({tokens:w}){return`<em>${this.parser.parseInline(w)}</em>`}codespan({text:w}){return`<code>${w}</code>`}br(w){return"<br>"}del({tokens:w}){return`<del>${this.parser.parseInline(w)}</del>`}link({href:w,title:_,tokens:T}){let A=this.parser.parseInline(T),F=m(w);if(F===null)return A;w=F;let $='<a href="'+w+'"';return _&&($+=' title="'+_+'"'),$+=">"+A+"</a>",$}image({href:w,title:_,text:T}){let A=m(w);if(A===null)return T;w=A;let F=`<img src="${w}" alt="${T}"`;return _&&(F+=` title="${_}"`),F+=">",F}text(w){return"tokens"in w&&w.tokens?this.parser.parseInline(w.tokens):w.text}}class qs{strong({text:w}){return w}em({text:w}){return w}codespan({text:w}){return w}del({text:w}){return w}html({text:w}){return w}text({text:w}){return w}link({text:w}){return""+w}image({text:w}){return""+w}br(){return""}}class Ri{options;renderer;textRenderer;constructor(w){this.options=w||e.defaults,this.options.renderer=this.options.renderer||new Mo,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new qs}static parse(w,_){return new Ri(_).parse(w)}static parseInline(w,_){return new Ri(_).parseInline(w)}parse(w,_=!0){let T="";for(let A=0;A<w.length;A++){let F=w[A];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[F.type]){let J=F,Se=this.options.extensions.renderers[J.type].call({parser:this},J);if(Se!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(J.type)){T+=Se||"";continue}}let $=F;switch($.type){case"space":{T+=this.renderer.space($);continue}case"hr":{T+=this.renderer.hr($);continue}case"heading":{T+=this.renderer.heading($);continue}case"code":{T+=this.renderer.code($);continue}case"table":{T+=this.renderer.table($);continue}case"blockquote":{T+=this.renderer.blockquote($);continue}case"list":{T+=this.renderer.list($);continue}case"html":{T+=this.renderer.html($);continue}case"paragraph":{T+=this.renderer.paragraph($);continue}case"text":{let J=$,Se=this.renderer.text(J);for(;A+1<w.length&&w[A+1].type==="text";)J=w[++A],Se+=`
`+this.renderer.text(J);_?T+=this.renderer.paragraph({type:"paragraph",raw:Se,text:Se,tokens:[{type:"text",raw:Se,text:Se}]}):T+=Se;continue}default:{let J='Token with "'+$.type+'" type was not found.';if(this.options.silent)return console.error(J),"";throw new Error(J)}}}return T}parseInline(w,_){_=_||this.renderer;let T="";for(let A=0;A<w.length;A++){let F=w[A];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[F.type]){let J=this.options.extensions.renderers[F.type].call({parser:this},F);if(J!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(F.type)){T+=J||"";continue}}let $=F;switch($.type){case"escape":{T+=_.text($);break}case"html":{T+=_.html($);break}case"link":{T+=_.link($);break}case"image":{T+=_.image($);break}case"strong":{T+=_.strong($);break}case"em":{T+=_.em($);break}case"codespan":{T+=_.codespan($);break}case"br":{T+=_.br($);break}case"del":{T+=_.del($);break}case"text":{T+=_.text($);break}default:{let J='Token with "'+$.type+'" type was not found.';if(this.options.silent)return console.error(J),"";throw new Error(J)}}}return T}}class Ba{options;constructor(w){this.options=w||e.defaults}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(w){return w}postprocess(w){return w}processAllTokens(w){return w}}class gr{defaults=t();options=this.setOptions;parse=this.parseMarkdown(fn.lex,Ri.parse);parseInline=this.parseMarkdown(fn.lexInline,Ri.parseInline);Parser=Ri;Renderer=Mo;TextRenderer=qs;Lexer=fn;Tokenizer=L;Hooks=Ba;constructor(...w){this.use(...w)}walkTokens(w,_){let T=[];for(let A of w)switch(T=T.concat(_.call(this,A)),A.type){case"table":{let F=A;for(let $ of F.header)T=T.concat(this.walkTokens($.tokens,_));for(let $ of F.rows)for(let J of $)T=T.concat(this.walkTokens(J.tokens,_));break}case"list":{let F=A;T=T.concat(this.walkTokens(F.items,_));break}default:{let F=A;this.defaults.extensions?.childTokens?.[F.type]?this.defaults.extensions.childTokens[F.type].forEach($=>{let J=F[$].flat(1/0);T=T.concat(this.walkTokens(J,_))}):F.tokens&&(T=T.concat(this.walkTokens(F.tokens,_)))}}return T}use(...w){let _=this.defaults.extensions||{renderers:{},childTokens:{}};return w.forEach(T=>{let A={...T};if(A.async=this.defaults.async||A.async||!1,T.extensions&&(T.extensions.forEach(F=>{if(!F.name)throw new Error("extension name required");if("renderer"in F){let $=_.renderers[F.name];$?_.renderers[F.name]=function(...J){let Se=F.renderer.apply(this,J);return Se===!1&&(Se=$.apply(this,J)),Se}:_.renderers[F.name]=F.renderer}if("tokenizer"in F){if(!F.level||F.level!=="block"&&F.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let $=_[F.level];$?$.unshift(F.tokenizer):_[F.level]=[F.tokenizer],F.start&&(F.level==="block"?_.startBlock?_.startBlock.push(F.start):_.startBlock=[F.start]:F.level==="inline"&&(_.startInline?_.startInline.push(F.start):_.startInline=[F.start]))}"childTokens"in F&&F.childTokens&&(_.childTokens[F.name]=F.childTokens)}),A.extensions=_),T.renderer){let F=this.defaults.renderer||new Mo(this.defaults);for(let $ in T.renderer){if(!($ in F))throw new Error(`renderer '${$}' does not exist`);if(["options","parser"].includes($))continue;let J=$,Se=T.renderer[J],_e=F[J];F[J]=(...Ze)=>{let bt=Se.apply(F,Ze);return bt===!1&&(bt=_e.apply(F,Ze)),bt||""}}A.renderer=F}if(T.tokenizer){let F=this.defaults.tokenizer||new L(this.defaults);for(let $ in T.tokenizer){if(!($ in F))throw new Error(`tokenizer '${$}' does not exist`);if(["options","rules","lexer"].includes($))continue;let J=$,Se=T.tokenizer[J],_e=F[J];F[J]=(...Ze)=>{let bt=Se.apply(F,Ze);return bt===!1&&(bt=_e.apply(F,Ze)),bt}}A.tokenizer=F}if(T.hooks){let F=this.defaults.hooks||new Ba;for(let $ in T.hooks){if(!($ in F))throw new Error(`hook '${$}' does not exist`);if($==="options")continue;let J=$,Se=T.hooks[J],_e=F[J];Ba.passThroughHooks.has($)?F[J]=Ze=>{if(this.defaults.async)return Promise.resolve(Se.call(F,Ze)).then(Vt=>_e.call(F,Vt));let bt=Se.call(F,Ze);return _e.call(F,bt)}:F[J]=(...Ze)=>{let bt=Se.apply(F,Ze);return bt===!1&&(bt=_e.apply(F,Ze)),bt}}A.hooks=F}if(T.walkTokens){let F=this.defaults.walkTokens,$=T.walkTokens;A.walkTokens=function(J){let Se=[];return Se.push($.call(this,J)),F&&(Se=Se.concat(F.call(this,J))),Se}}this.defaults={...this.defaults,...A}}),this}setOptions(w){return this.defaults={...this.defaults,...w},this}lexer(w,_){return fn.lex(w,_??this.defaults)}parser(w,_){return Ri.parse(w,_??this.defaults)}parseMarkdown(w,_){return(A,F)=>{let $={...F},J={...this.defaults,...$},Se=this.onError(!!J.silent,!!J.async);if(this.defaults.async===!0&&$.async===!1)return Se(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof A>"u"||A===null)return Se(new Error("marked(): input parameter is undefined or null"));if(typeof A!="string")return Se(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(A)+", string expected"));if(J.hooks&&(J.hooks.options=J),J.async)return Promise.resolve(J.hooks?J.hooks.preprocess(A):A).then(_e=>w(_e,J)).then(_e=>J.hooks?J.hooks.processAllTokens(_e):_e).then(_e=>J.walkTokens?Promise.all(this.walkTokens(_e,J.walkTokens)).then(()=>_e):_e).then(_e=>_(_e,J)).then(_e=>J.hooks?J.hooks.postprocess(_e):_e).catch(Se);try{J.hooks&&(A=J.hooks.preprocess(A));let _e=w(A,J);J.hooks&&(_e=J.hooks.processAllTokens(_e)),J.walkTokens&&this.walkTokens(_e,J.walkTokens);let Ze=_(_e,J);return J.hooks&&(Ze=J.hooks.postprocess(Ze)),Ze}catch(_e){return Se(_e)}}}onError(w,_){return T=>{if(T.message+=`
Please report this to https://github.com/markedjs/marked.`,w){let A="<p>An error occurred:</p><pre>"+c(T.message+"",!0)+"</pre>";return _?Promise.resolve(A):A}if(_)return Promise.reject(T);throw T}}}let es=new gr;function pe(Pe,w){return es.parse(Pe,w)}pe.options=pe.setOptions=function(Pe){return es.setOptions(Pe),pe.defaults=es.defaults,n(pe.defaults),pe},pe.getDefaults=t,pe.defaults=e.defaults,pe.use=function(...Pe){return es.use(...Pe),pe.defaults=es.defaults,n(pe.defaults),pe},pe.walkTokens=function(Pe,w){return es.walkTokens(Pe,w)},pe.parseInline=es.parseInline,pe.Parser=Ri,pe.parser=Ri.parse,pe.Renderer=Mo,pe.TextRenderer=qs,pe.Lexer=fn,pe.lexer=fn.lex,pe.Tokenizer=L,pe.Hooks=Ba,pe.parse=pe;let se=pe.options,M=pe.setOptions,ee=pe.use,ue=pe.walkTokens,qe=pe.parseInline,yt=pe,Pn=Ri.parse,di=fn.lex;e.Hooks=Ba,e.Lexer=fn,e.Marked=gr,e.Parser=Ri,e.Renderer=Mo,e.TextRenderer=qs,e.Tokenizer=L,e.getDefaults=t,e.lexer=di,e.marked=pe,e.options=se,e.parse=yt,e.parseInline=qe,e.parser=Pn,e.setOptions=M,e.use=ee,e.walkTokens=ue})})();var GSt=ri.Hooks||exports.Hooks,jSt=ri.Lexer||exports.Lexer,$St=ri.Marked||exports.Marked,qSt=ri.Parser||exports.Parser,R0=ri.Renderer||exports.Renderer,YSt=ri.TextRenderer||exports.TextRenderer,ZSt=ri.Tokenizer||exports.Tokenizer,lF=ri.defaults||exports.defaults,XSt=ri.getDefaults||exports.getDefaults,Xg=ri.lexer||exports.lexer,QSt=ri.marked||exports.marked,JSt=ri.options||exports.options,M0=ri.parse||exports.parse,ewt=ri.parseInline||exports.parseInline,dF=ri.parser||exports.parser,twt=ri.setOptions||exports.setOptions,nwt=ri.use||exports.use,iwt=ri.walkTokens||exports.walkTokens;var A0=Object.freeze({image:({href:o,title:e,text:t})=>{let n=[],i=[];return o&&({href:o,dimensions:n}=jR(o),i.push(`src="${am(o)}"`)),t&&i.push(`alt="${am(t)}"`),e&&i.push(`title="${am(e)}"`),n.length&&(i=i.concat(n)),"<img "+i.join(" ")+">"},paragraph({tokens:o}){return`<p>${this.parser.parseInline(o)}</p>`},link({href:o,title:e,tokens:t}){let n=this.parser.parseInline(t);return typeof o!="string"?"":(o===n&&(n=Wb(n)),e=typeof e=="string"?am(Wb(e)):"",o=Wb(o),o=o.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"),`<a href="${o}" title="${e||o}" draggable="false">${n}</a>`)}});function jS(o,e={},t={}){let n=new he,i=!1,r=NS(e),s=function(g){let b;try{b=TT(decodeURIComponent(g))}catch{}return b?(b=_R(b,y=>{if(o.uris&&o.uris[y])return ie.revive(o.uris[y])}),encodeURIComponent(JSON.stringify(b))):g},a=function(g,b){let y=o.uris&&o.uris[g],C=ie.revive(y);return b?g.startsWith(Te.data+":")?g:(C||(C=ie.parse(g)),el.uriToBrowserUri(C).toString(!0)):!C||ie.parse(g).toString()===C.toString()?g:(C.query&&(C=C.with({query:s(C.query)})),C.toString())},l=new R0;l.image=A0.image,l.link=A0.link,l.paragraph=A0.paragraph;let d=[],c=[];if(e.codeBlockRendererSync?l.code=({text:g,lang:b})=>{let y=k0.nextId(),C=e.codeBlockRendererSync(cF(b),g);return c.push([y,C]),`<div class="code" data-code="${y}">${$c(g)}</div>`}:e.codeBlockRenderer&&(l.code=({text:g,lang:b})=>{let y=k0.nextId(),C=e.codeBlockRenderer(cF(b),g);return d.push(C.then(x=>[y,x])),`<div class="code" data-code="${y}">${$c(g)}</div>`}),e.actionHandler){let g=function(C){let x=C.target.closest("a[data-href]");if(yn(x))try{let L=x.dataset.href;L&&(o.baseUri&&(L=O0(ie.from(o.baseUri),L)),e.actionHandler.callback(L,C))}catch(L){je(L)}finally{C.preventDefault()}},b=e.actionHandler.disposables.add(new Fe(r,"click")),y=e.actionHandler.disposables.add(new Fe(r,"auxclick"));e.actionHandler.disposables.add(oe.any(b.event,y.event)(C=>{let x=new hi(Ie(r),C);!x.leftButton&&!x.middleButton||g(x)})),e.actionHandler.disposables.add(U(r,"keydown",C=>{let x=new nt(C);!x.equals(10)&&!x.equals(3)||g(x)}))}o.supportHtml||(l.html=({text:g})=>e.sanitizerOptions?.replaceWithPlaintext?$c(g):(o.isTrusted?g.match(/^(<span[^>]+>)|(<\/\s*span>)$/):void 0)?g:""),t.renderer=l;let u=o.value??"";u.length>1e5&&(u=`${u.substr(0,1e5)}\u2026`),o.supportThemeIcons&&(u=KR(u));let h;if(e.fillInIncompleteTokens){let g={...lF,...t},b=Xg(u,g),y=GU(b);h=dF(y,g)}else h=M0(u,{...t,async:!1});o.supportThemeIcons&&(h=KS(h).map(b=>typeof b=="string"?b:b.outerHTML).join(""));let f=new DOMParser().parseFromString(N0({isTrusted:o.isTrusted,...e.sanitizerOptions},h),"text/html");if(f.body.querySelectorAll("img, audio, video, source").forEach(g=>{let b=g.getAttribute("src");if(b){let y=b;try{o.baseUri&&(y=O0(ie.from(o.baseUri),y))}catch{}if(g.setAttribute("src",a(y,!0)),e.remoteImageIsAllowed){let C=ie.parse(y);C.scheme!==Te.file&&C.scheme!==Te.data&&!e.remoteImageIsAllowed(C)&&g.replaceWith(We("",void 0,g.outerHTML))}}}),f.body.querySelectorAll("a").forEach(g=>{let b=g.getAttribute("href");if(g.setAttribute("href",""),!b||/^data:|javascript:/i.test(b)||/^command:/i.test(b)&&!o.isTrusted||/^command:(\/\/\/)?_workbench\.downloadResource/i.test(b))g.replaceWith(...g.childNodes);else{let y=a(b,!1);o.baseUri&&(y=O0(ie.from(o.baseUri),b)),g.dataset.href=y}}),r.innerHTML=N0({isTrusted:o.isTrusted,...e.sanitizerOptions},f.body.innerHTML),d.length>0)Promise.all(d).then(g=>{if(i)return;let b=new Map(g),y=r.querySelectorAll("div[data-code]");for(let C of y){let x=b.get(C.dataset.code??"");x&&oa(C,x)}e.asyncRenderCallback?.()});else if(c.length>0){let g=new Map(c),b=r.querySelectorAll("div[data-code]");for(let y of b){let C=g.get(y.dataset.code??"");C&&oa(y,C)}}if(e.asyncRenderCallback)for(let g of r.getElementsByTagName("img")){let b=n.add(U(g,"load",()=>{b.dispose(),e.asyncRenderCallback()}))}return{element:r,dispose:()=>{i=!0,n.dispose()}}}function cF(o){if(!o)return"";let e=o.split(/[\s+|:|,|\{|\?]/,1);return e.length?e[0]:o}function O0(o,e){return/^\w[\w\d+.-]*:/.test(e)?e:o.path.endsWith("/")?Mx(o,e).toString():Mx(as(o),e).toString()}var OU=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"];function N0(o,e){let{config:t,allowedSchemes:n}=PU(o),i=new he;i.add(uF("uponSanitizeAttribute",(r,s)=>{if(s.attrName==="style"||s.attrName==="class"){if(r.tagName==="SPAN"){if(s.attrName==="style"){s.keepAttr=/^(color\:(#[0-9a-fA-F]+|var\(--vscode(-[a-zA-Z0-9]+)+\));)?(background-color\:(#[0-9a-fA-F]+|var\(--vscode(-[a-zA-Z0-9]+)+\));)?(border-radius:[0-9]+px;)?$/.test(s.attrValue);return}else if(s.attrName==="class"){s.keepAttr=/^codicon codicon-[a-z\-]+( codicon-modifier-[a-z\-]+)?$/.test(s.attrValue);return}}s.keepAttr=!1;return}else if(r.tagName==="INPUT"&&r.attributes.getNamedItem("type")?.value==="checkbox"){if(s.attrName==="type"&&s.attrValue==="checkbox"||s.attrName==="disabled"||s.attrName==="checked"){s.keepAttr=!0;return}s.keepAttr=!1}})),i.add(uF("uponSanitizeElement",(r,s)=>{if(s.tagName==="input"&&(r.attributes.getNamedItem("type")?.value==="checkbox"?r.setAttribute("disabled",""):o.replaceWithPlaintext||r.remove()),o.replaceWithPlaintext&&!s.allowedTags[s.tagName]&&s.tagName!=="body"&&r.parentElement){let a,l;if(s.tagName==="#comment")a=`<!--${r.textContent}-->`;else{let h=OU.includes(s.tagName),m=r.attributes.length?" "+Array.from(r.attributes).map(f=>`${f.name}="${f.value}"`).join(" "):"";a=`<${s.tagName}${m}>`,h||(l=`</${s.tagName}>`)}let d=document.createDocumentFragment(),c=r.parentElement.ownerDocument.createTextNode(a);d.appendChild(c);let u=l?r.parentElement.ownerDocument.createTextNode(l):void 0;for(;r.firstChild;)d.appendChild(r.firstChild);u&&d.appendChild(u),r.parentElement.replaceChild(d,r)}})),i.add(xR(n));try{return Qp(e,{...t,RETURN_TRUSTED_TYPE:!0})}finally{i.dispose()}}var NU=["align","autoplay","alt","checked","class","colspan","controls","data-code","data-href","disabled","draggable","height","href","loop","muted","playsinline","poster","rowspan","src","style","target","title","type","width","start"];function PU(o){let e=[Te.http,Te.https,Te.mailto,Te.data,Te.file,Te.vscodeFileResource,Te.vscodeRemote,Te.vscodeRemoteResource];return o.isTrusted&&e.push(Te.command),{config:{ALLOWED_TAGS:o.allowedTags??[...ER],ALLOWED_ATTR:NU,ALLOW_UNKNOWN_PROTOCOLS:!0},allowedSchemes:e}}function hF(o){return typeof o=="string"?o:FU(o)}function FU(o,e){let t=o.value??"";t.length>1e5&&(t=`${t.substr(0,1e5)}\u2026`);let n=M0(t,{async:!1,renderer:e?WU.value:VU.value}).replace(/&(#\d+|[a-zA-Z]+);/g,i=>BU.get(i)??i);return N0({isTrusted:!1},n).toString()}var BU=new Map([["&quot;",'"'],["&nbsp;"," "],["&amp;","&"],["&#39;","'"],["&lt;","<"],["&gt;",">"]]);function pF(){let o=new R0;return o.code=({text:e})=>e,o.blockquote=({text:e})=>e+`
`,o.html=e=>"",o.heading=function({tokens:e}){return this.parser.parseInline(e)+`
`},o.hr=()=>"",o.list=function({items:e}){return e.map(t=>this.listitem(t)).join(`
`)+`
`},o.listitem=({text:e})=>e+`
`,o.paragraph=function({tokens:e}){return this.parser.parseInline(e)+`
`},o.table=function({header:e,rows:t}){return e.map(n=>this.tablecell(n)).join(" ")+`
`+t.map(n=>n.map(i=>this.tablecell(i)).join(" ")).join(`
`)+`
`},o.tablerow=({text:e})=>e,o.tablecell=function({tokens:e}){return this.parser.parseInline(e)},o.strong=({text:e})=>e,o.em=({text:e})=>e,o.codespan=({text:e})=>e,o.br=e=>`
`,o.del=({text:e})=>e,o.image=e=>"",o.text=({text:e})=>e,o.link=({text:e})=>e,o}var VU=new vi(o=>pF()),WU=new vi(()=>{let o=pF();return o.code=({text:e})=>`
\`\`\`
${e}
\`\`\`
`,o});function GS(o){let e="";return o.forEach(t=>{e+=t.raw}),e}function mF(o){if(o.tokens)for(let e=o.tokens.length-1;e>=0;e--){let t=o.tokens[e];if(t.type==="text"){let n=t.raw.split(`
`),i=n[n.length-1];if(i.includes("`"))return $U(o);if(i.includes("**"))return JU(o);if(i.match(/\*\w/))return qU(o);if(i.match(/(^|\s)__\w/))return ez(o);if(i.match(/(^|\s)_\w/))return YU(o);if(HU(i)||UU(i)&&o.tokens.slice(0,e).some(r=>r.type==="text"&&r.raw.match(/\[[^\]]*$/))){let r=o.tokens.slice(e+1);return r[0]?.type==="link"&&r[1]?.type==="text"&&r[1].raw.match(/^ *"[^"]*$/)||i.match(/^[^"]* +"[^"]*$/)?XU(o):ZU(o)}else if(i.match(/(^|\s)\[\w*/))return QU(o)}}}function HU(o){return!!o.match(/(^|\s)\[.*\]\(\w*/)}function UU(o){return!!o.match(/^[^\[]*\]\([^\)]*$/)}function zU(o){let e=o.items[o.items.length-1],t=e.tokens?e.tokens[e.tokens.length-1]:void 0,n;if(t?.type==="text"&&!("inRawBlock"in e)&&(n=mF(t)),!n||n.type!=="paragraph")return;let i=GS(o.items.slice(0,-1)),r=e.raw.match(/^(\s*(-|\d+\.|\*) +)/)?.[0];if(!r)return;let s=r+GS(e.tokens.slice(0,-1))+n.raw,a=Xg(i+s)[0];if(a.type==="list")return a}var KU=3;function GU(o){for(let e=0;e<KU;e++){let t=jU(o);if(t)o=t;else break}return o}function jU(o){let e,t;for(e=0;e<o.length;e++){let n=o[e];if(n.type==="paragraph"&&n.raw.match(/(\n|^)\|/)){t=tz(o.slice(e));break}if(e===o.length-1&&n.type==="list"){let i=zU(n);if(i){t=[i];break}}if(e===o.length-1&&n.type==="paragraph"){let i=mF(n);if(i){t=[i];break}}}if(t){let n=[...o.slice(0,e),...t];return n.links=o.links,n}return null}function $U(o){return Hl(o,"`")}function qU(o){return Hl(o,"*")}function YU(o){return Hl(o,"_")}function ZU(o){return Hl(o,")")}function XU(o){return Hl(o,'")')}function QU(o){return Hl(o,"](https://microsoft.com)")}function JU(o){return Hl(o,"**")}function ez(o){return Hl(o,"__")}function Hl(o,e){let t=GS(Array.isArray(o)?o:[o]);return Xg(t+e)[0]}function tz(o){let e=GS(o),t=e.split(`
`),n,i=!1;for(let r=0;r<t.length;r++){let s=t[r].trim();if(typeof n>"u"&&s.match(/^\s*\|/)){let a=s.match(/(\|[^\|]+)(?=\||$)/g);a&&(n=a.length)}else if(typeof n=="number")if(s.match(/^\s*\|/)){if(r!==t.length-1)return;i=!0}else return}if(typeof n=="number"&&n>0){let r=i?t.slice(0,-1).join(`
`):e,s=!!r.match(/\|\s*$/),a=r+(s?"":"|")+`
|${" --- |".repeat(n)}`;return Xg(a)}}function uF(o,e){return Ib(o,e),ve(()=>Cb(o))}var nz={showHover:()=>{},hideHover:()=>{},showAndFocusLastHover:()=>{},setupManagedHover:()=>null,showManagedHover:()=>{}};function ho(){return nz}var Sc=We,gF="selectOption.entry.template",P0=class{get templateId(){return gF}renderTemplate(e){let t=Object.create(null);return t.root=e,t.text=Ke(e,Sc(".option-text")),t.detail=Ke(e,Sc(".option-detail")),t.decoratorRight=Ke(e,Sc(".option-decorator-right")),t}renderElement(e,t,n){let i=n,r=e.text,s=e.detail,a=e.decoratorRight,l=e.isDisabled;i.text.textContent=r,i.detail.textContent=s||"",i.decoratorRight.innerText=a||"",l?i.root.classList.add("option-disabled"):i.root.classList.remove("option-disabled")}disposeTemplate(e){}},$S=class o extends V{static DEFAULT_DROPDOWN_MINIMUM_BOTTOM_MARGIN=32;static DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN=2;static DEFAULT_MINIMUM_VISIBLE_OPTIONS=3;_isVisible;selectBoxOptions;selectElement;container;options=[];selected;_onDidSelect;styles;listRenderer;contextViewProvider;selectDropDownContainer;styleElement;selectList;selectDropDownListContainer;widthControlElement;_currentSelection=0;_dropDownPosition;_hasDetails=!1;selectionDetailsPane;_skipLayout=!1;_cachedMaxDetailsHeight;_hover;_sticky=!1;constructor(e,t,n,i,r){super(),this._isVisible=!1,this.styles=i,this.selectBoxOptions=r||Object.create(null),typeof this.selectBoxOptions.minBottomMargin!="number"?this.selectBoxOptions.minBottomMargin=o.DEFAULT_DROPDOWN_MINIMUM_BOTTOM_MARGIN:this.selectBoxOptions.minBottomMargin<0&&(this.selectBoxOptions.minBottomMargin=0),this.selectElement=document.createElement("select"),this.selectElement.className="monaco-select-box monaco-select-box-dropdown-padding",typeof this.selectBoxOptions.ariaLabel=="string"&&this.selectElement.setAttribute("aria-label",this.selectBoxOptions.ariaLabel),typeof this.selectBoxOptions.ariaDescription=="string"&&this.selectElement.setAttribute("aria-description",this.selectBoxOptions.ariaDescription),this._onDidSelect=new E,this._register(this._onDidSelect),this.registerListeners(),this.constructSelectDropDown(n),this.selected=t||0,e&&this.setOptions(e,t),this.initStyleSheet()}setTitle(e){!this._hover&&e?this._hover=this._register(ho().setupManagedHover(Gt("mouse"),this.selectElement,e)):this._hover&&this._hover.update(e)}getHeight(){return 22}getTemplateId(){return gF}constructSelectDropDown(e){this.contextViewProvider=e,this.selectDropDownContainer=We(".monaco-select-box-dropdown-container"),this.selectDropDownContainer.classList.add("monaco-select-box-dropdown-padding"),this.selectionDetailsPane=Ke(this.selectDropDownContainer,Sc(".select-box-details-pane"));let t=Ke(this.selectDropDownContainer,Sc(".select-box-dropdown-container-width-control")),n=Ke(t,Sc(".width-control-div"));this.widthControlElement=document.createElement("span"),this.widthControlElement.className="option-text-width-control",Ke(n,this.widthControlElement),this._dropDownPosition=0,this.styleElement=us(this.selectDropDownContainer),this.selectDropDownContainer.setAttribute("draggable","true"),this._register(U(this.selectDropDownContainer,ae.DRAG_START,i=>{$e.stop(i,!0)}))}registerListeners(){this._register(Jt(this.selectElement,"change",t=>{this.selected=t.target.selectedIndex,this._onDidSelect.fire({index:t.target.selectedIndex,selected:t.target.value}),this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)})),this._register(U(this.selectElement,ae.CLICK,t=>{$e.stop(t),this._isVisible?this.hideSelectDropDown(!0):this.showSelectDropDown()})),this._register(U(this.selectElement,ae.MOUSE_DOWN,t=>{$e.stop(t)}));let e;this._register(U(this.selectElement,"touchstart",t=>{e=this._isVisible})),this._register(U(this.selectElement,"touchend",t=>{$e.stop(t),e?this.hideSelectDropDown(!0):this.showSelectDropDown()})),this._register(U(this.selectElement,ae.KEY_DOWN,t=>{let n=new nt(t),i=!1;Be?(n.keyCode===18||n.keyCode===16||n.keyCode===10||n.keyCode===3)&&(i=!0):(n.keyCode===18&&n.altKey||n.keyCode===16&&n.altKey||n.keyCode===10||n.keyCode===3)&&(i=!0),i&&(this.showSelectDropDown(),$e.stop(t,!0))}))}get onDidSelect(){return this._onDidSelect.event}setOptions(e,t){on(this.options,e)||(this.options=e,this.selectElement.options.length=0,this._hasDetails=!1,this._cachedMaxDetailsHeight=void 0,this.options.forEach((n,i)=>{this.selectElement.add(this.createOption(n.text,i,n.isDisabled)),typeof n.description=="string"&&(this._hasDetails=!0)})),t!==void 0&&(this.select(t),this._currentSelection=this.selected)}setEnabled(e){this.selectElement.disabled=!e}setOptionsList(){this.selectList?.splice(0,this.selectList.length,this.options)}select(e){e>=0&&e<this.options.length?this.selected=e:e>this.options.length-1?this.select(this.options.length-1):this.selected<0&&(this.selected=0),this.selectElement.selectedIndex=this.selected,this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)}setAriaLabel(e){this.selectBoxOptions.ariaLabel=e,this.selectElement.setAttribute("aria-label",this.selectBoxOptions.ariaLabel)}focus(){this.selectElement&&(this.selectElement.tabIndex=0,this.selectElement.focus())}blur(){this.selectElement&&(this.selectElement.tabIndex=-1,this.selectElement.blur())}setFocusable(e){this.selectElement.tabIndex=e?0:-1}render(e){this.container=e,e.classList.add("select-container"),e.appendChild(this.selectElement),this.styleSelectElement()}initStyleSheet(){let e=[];this.styles.listFocusBackground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { background-color: ${this.styles.listFocusBackground} !important; }`),this.styles.listFocusForeground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { color: ${this.styles.listFocusForeground} !important; }`),this.styles.decoratorRightForeground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.focused) .option-decorator-right { color: ${this.styles.decoratorRightForeground}; }`),this.styles.selectBackground&&this.styles.selectBorder&&this.styles.selectBorder!==this.styles.selectBackground?(e.push(`.monaco-select-box-dropdown-container { border: 1px solid ${this.styles.selectBorder} } `),e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-top { border-top: 1px solid ${this.styles.selectBorder} } `),e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-bottom { border-bottom: 1px solid ${this.styles.selectBorder} } `)):this.styles.selectListBorder&&(e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-top { border-top: 1px solid ${this.styles.selectListBorder} } `),e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-bottom { border-bottom: 1px solid ${this.styles.selectListBorder} } `)),this.styles.listHoverForeground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { color: ${this.styles.listHoverForeground} !important; }`),this.styles.listHoverBackground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { background-color: ${this.styles.listHoverBackground} !important; }`),this.styles.listFocusOutline&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { outline: 1.6px dotted ${this.styles.listFocusOutline} !important; outline-offset: -1.6px !important; }`),this.styles.listHoverOutline&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { outline: 1.6px dashed ${this.styles.listHoverOutline} !important; outline-offset: -1.6px !important; }`),e.push(".monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.option-disabled.focused { background-color: transparent !important; color: inherit !important; outline: none !important; }"),e.push(".monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.option-disabled:hover { background-color: transparent !important; color: inherit !important; outline: none !important; }"),this.styleElement.textContent=e.join(`
`)}styleSelectElement(){let e=this.styles.selectBackground??"",t=this.styles.selectForeground??"",n=this.styles.selectBorder??"";this.selectElement.style.backgroundColor=e,this.selectElement.style.color=t,this.selectElement.style.borderColor=n}styleList(){let e=this.styles.selectBackground??"",t=Ko(this.styles.selectListBackground,e);this.selectDropDownListContainer.style.backgroundColor=t,this.selectionDetailsPane.style.backgroundColor=t;let n=this.styles.focusBorder??"";this.selectDropDownContainer.style.outlineColor=n,this.selectDropDownContainer.style.outlineOffset="-1px",this.selectList.style(this.styles)}createOption(e,t,n){let i=document.createElement("option");return i.value=e,i.text=e,i.disabled=!!n,i}showSelectDropDown(){this.selectionDetailsPane.innerText="",!(!this.contextViewProvider||this._isVisible)&&(this.createSelectList(this.selectDropDownContainer),this.setOptionsList(),this.contextViewProvider.showContextView({getAnchor:()=>this.selectElement,render:e=>this.renderSelectDropDown(e,!0),layout:()=>{this.layoutSelectDropDown()},onHide:()=>{this.selectDropDownContainer.classList.remove("visible"),this.selectElement.classList.remove("synthetic-focus")},anchorPosition:this._dropDownPosition},this.selectBoxOptions.optionsAsChildren?this.container:void 0),this._isVisible=!0,this.hideSelectDropDown(!1),this.contextViewProvider.showContextView({getAnchor:()=>this.selectElement,render:e=>this.renderSelectDropDown(e),layout:()=>this.layoutSelectDropDown(),onHide:()=>{this.selectDropDownContainer.classList.remove("visible"),this.selectElement.classList.remove("synthetic-focus")},anchorPosition:this._dropDownPosition},this.selectBoxOptions.optionsAsChildren?this.container:void 0),this._currentSelection=this.selected,this._isVisible=!0,this.selectElement.setAttribute("aria-expanded","true"))}hideSelectDropDown(e){!this.contextViewProvider||!this._isVisible||(this._isVisible=!1,this.selectElement.setAttribute("aria-expanded","false"),e&&this.selectElement.focus(),this.contextViewProvider.hideContextView())}renderSelectDropDown(e,t){return e.appendChild(this.selectDropDownContainer),this.layoutSelectDropDown(t),{dispose:()=>{this.selectDropDownContainer.remove()}}}measureMaxDetailsHeight(){let e=0;return this.options.forEach((t,n)=>{this.updateDetail(n),this.selectionDetailsPane.offsetHeight>e&&(e=this.selectionDetailsPane.offsetHeight)}),e}layoutSelectDropDown(e){if(this._skipLayout)return!1;if(this.selectList){this.selectDropDownContainer.classList.add("visible");let t=Ie(this.selectElement),n=yo(this.selectElement),i=Ie(this.selectElement).getComputedStyle(this.selectElement),r=parseFloat(i.getPropertyValue("--dropdown-padding-top"))+parseFloat(i.getPropertyValue("--dropdown-padding-bottom")),s=t.innerHeight-n.top-n.height-(this.selectBoxOptions.minBottomMargin||0),a=n.top-o.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN,l=this.selectElement.offsetWidth,d=this.setWidthControlElement(this.widthControlElement),c=Math.max(d,Math.round(l)).toString()+"px";this.selectDropDownContainer.style.width=c,this.selectList.getHTMLElement().style.height="",this.selectList.layout();let u=this.selectList.contentHeight;this._hasDetails&&this._cachedMaxDetailsHeight===void 0&&(this._cachedMaxDetailsHeight=this.measureMaxDetailsHeight());let h=this._hasDetails?this._cachedMaxDetailsHeight:0,m=u+r+h,f=Math.floor((s-r-h)/this.getHeight()),g=Math.floor((a-r-h)/this.getHeight());if(e)return n.top+n.height>t.innerHeight-22||n.top<o.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN||f<1&&g<1?!1:(f<o.DEFAULT_MINIMUM_VISIBLE_OPTIONS&&g>f&&this.options.length>f?(this._dropDownPosition=1,this.selectDropDownListContainer.remove(),this.selectionDetailsPane.remove(),this.selectDropDownContainer.appendChild(this.selectionDetailsPane),this.selectDropDownContainer.appendChild(this.selectDropDownListContainer),this.selectionDetailsPane.classList.remove("border-top"),this.selectionDetailsPane.classList.add("border-bottom")):(this._dropDownPosition=0,this.selectDropDownListContainer.remove(),this.selectionDetailsPane.remove(),this.selectDropDownContainer.appendChild(this.selectDropDownListContainer),this.selectDropDownContainer.appendChild(this.selectionDetailsPane),this.selectionDetailsPane.classList.remove("border-bottom"),this.selectionDetailsPane.classList.add("border-top")),!0);if(n.top+n.height>t.innerHeight-22||n.top<o.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN||this._dropDownPosition===0&&f<1||this._dropDownPosition===1&&g<1)return this.hideSelectDropDown(!0),!1;if(this._dropDownPosition===0){if(this._isVisible&&f+g<1)return this.hideSelectDropDown(!0),!1;m>s&&(u=f*this.getHeight())}else m>a&&(u=g*this.getHeight());return this.selectList.layout(u),this.selectList.domFocus(),this.selectList.length>0&&(this.selectList.setFocus([this.selected||0]),this.selectList.reveal(this.selectList.getFocus()[0]||0)),this._hasDetails?(this.selectList.getHTMLElement().style.height=u+r+"px",this.selectDropDownContainer.style.height=""):this.selectDropDownContainer.style.height=u+r+"px",this.updateDetail(this.selected),this.selectDropDownContainer.style.width=c,this.selectDropDownListContainer.setAttribute("tabindex","0"),this.selectElement.classList.add("synthetic-focus"),this.selectDropDownContainer.classList.add("synthetic-focus"),!0}else return!1}setWidthControlElement(e){let t=0;if(e){let n=0,i=0;this.options.forEach((r,s)=>{let a=r.detail?r.detail.length:0,l=r.decoratorRight?r.decoratorRight.length:0,d=r.text.length+a+l;d>i&&(n=s,i=d)}),e.textContent=this.options[n].text+(this.options[n].decoratorRight?this.options[n].decoratorRight+" ":""),t=iu(e)}return t}createSelectList(e){if(this.selectList)return;this.selectDropDownListContainer=Ke(e,Sc(".select-box-dropdown-list-container")),this.listRenderer=new P0,this.selectList=this._register(new $o("SelectBoxCustom",this.selectDropDownListContainer,this,[this.listRenderer],{useShadows:!1,verticalScrollMode:3,keyboardSupport:!1,mouseSupport:!1,accessibilityProvider:{getAriaLabel:i=>{let r=i.text;return i.detail&&(r+=`. ${i.detail}`),i.decoratorRight&&(r+=`. ${i.decoratorRight}`),i.description&&(r+=`. ${i.description}`),r},getWidgetAriaLabel:()=>p({key:"selectBox",comment:["Behave like native select dropdown element."]},"Select Box"),getRole:()=>Be?"":"option",getWidgetRole:()=>"listbox"}})),this.selectBoxOptions.ariaLabel&&(this.selectList.ariaLabel=this.selectBoxOptions.ariaLabel);let t=this._register(new Fe(this.selectDropDownListContainer,"keydown")),n=oe.chain(t.event,i=>i.filter(()=>this.selectList.length>0).map(r=>new nt(r)));this._register(oe.chain(n,i=>i.filter(r=>r.keyCode===3))(this.onEnter,this)),this._register(oe.chain(n,i=>i.filter(r=>r.keyCode===2))(this.onEnter,this)),this._register(oe.chain(n,i=>i.filter(r=>r.keyCode===9))(this.onEscape,this)),this._register(oe.chain(n,i=>i.filter(r=>r.keyCode===16))(this.onUpArrow,this)),this._register(oe.chain(n,i=>i.filter(r=>r.keyCode===18))(this.onDownArrow,this)),this._register(oe.chain(n,i=>i.filter(r=>r.keyCode===12))(this.onPageDown,this)),this._register(oe.chain(n,i=>i.filter(r=>r.keyCode===11))(this.onPageUp,this)),this._register(oe.chain(n,i=>i.filter(r=>r.keyCode===14))(this.onHome,this)),this._register(oe.chain(n,i=>i.filter(r=>r.keyCode===13))(this.onEnd,this)),this._register(oe.chain(n,i=>i.filter(r=>r.keyCode>=21&&r.keyCode<=56||r.keyCode>=85&&r.keyCode<=113))(this.onCharacter,this)),this._register(U(this.selectList.getHTMLElement(),ae.POINTER_UP,i=>this.onPointerUp(i))),this._register(this.selectList.onMouseOver(i=>typeof i.index<"u"&&this.selectList.setFocus([i.index]))),this._register(this.selectList.onDidChangeFocus(i=>this.onListFocus(i))),this._register(U(this.selectDropDownContainer,ae.FOCUS_OUT,i=>{!this._isVisible||Jo(i.relatedTarget,this.selectDropDownContainer)||this.onListBlur()})),this.selectList.getHTMLElement().setAttribute("aria-label",this.selectBoxOptions.ariaLabel||""),this.selectList.getHTMLElement().setAttribute("aria-expanded","true"),this.styleList()}onPointerUp(e){if(!this.selectList.length)return;$e.stop(e);let t=e.target;if(!t||t.classList.contains("slider"))return;let n=t.closest(".monaco-list-row");if(!n)return;let i=Number(n.getAttribute("data-index")),r=n.classList.contains("option-disabled");i>=0&&i<this.options.length&&!r&&(this.selected=i,this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0]),this.selected!==this._currentSelection&&(this._currentSelection=this.selected,this._onDidSelect.fire({index:this.selectElement.selectedIndex,selected:this.options[this.selected].text}),this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)),this.hideSelectDropDown(!0))}onListBlur(){this._sticky||(this.selected!==this._currentSelection&&this.select(this._currentSelection),this.hideSelectDropDown(!1))}renderDescriptionMarkdown(e,t){let n=r=>{for(let s=0;s<r.childNodes.length;s++){let a=r.childNodes.item(s);(a.tagName&&a.tagName.toLowerCase())==="img"?a.remove():n(a)}},i=jS({value:e,supportThemeIcons:!0},{actionHandler:t});return i.element.classList.add("select-box-description-markdown"),n(i.element),i.element}onListFocus(e){!this._isVisible||!this._hasDetails||this.updateDetail(e.indexes[0])}updateDetail(e){this.selectionDetailsPane.innerText="";let t=this.options[e],n=t?.description??"",i=t?.descriptionIsMarkdown??!1;if(n){if(i){let r=t.descriptionMarkdownActionHandler;this.selectionDetailsPane.appendChild(this.renderDescriptionMarkdown(n,r))}else this.selectionDetailsPane.innerText=n;this.selectionDetailsPane.style.display="block"}else this.selectionDetailsPane.style.display="none";this._skipLayout=!0,this.contextViewProvider.layout(),this._skipLayout=!1}onEscape(e){$e.stop(e),this.select(this._currentSelection),this.hideSelectDropDown(!0)}onEnter(e){$e.stop(e),this.selected!==this._currentSelection&&(this._currentSelection=this.selected,this._onDidSelect.fire({index:this.selectElement.selectedIndex,selected:this.options[this.selected].text}),this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)),this.hideSelectDropDown(!0)}onDownArrow(e){if(this.selected<this.options.length-1){$e.stop(e,!0);let t=this.options[this.selected+1].isDisabled;if(t&&this.options.length>this.selected+2)this.selected+=2;else{if(t)return;this.selected++}this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0])}}onUpArrow(e){this.selected>0&&($e.stop(e,!0),this.options[this.selected-1].isDisabled&&this.selected>1?this.selected-=2:this.selected--,this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0]))}onPageUp(e){$e.stop(e),this.selectList.focusPreviousPage(),setTimeout(()=>{this.selected=this.selectList.getFocus()[0],this.options[this.selected].isDisabled&&this.selected<this.options.length-1&&(this.selected++,this.selectList.setFocus([this.selected])),this.selectList.reveal(this.selected),this.select(this.selected)},1)}onPageDown(e){$e.stop(e),this.selectList.focusNextPage(),setTimeout(()=>{this.selected=this.selectList.getFocus()[0],this.options[this.selected].isDisabled&&this.selected>0&&(this.selected--,this.selectList.setFocus([this.selected])),this.selectList.reveal(this.selected),this.select(this.selected)},1)}onHome(e){$e.stop(e),!(this.options.length<2)&&(this.selected=0,this.options[this.selected].isDisabled&&this.selected>1&&this.selected++,this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selected),this.select(this.selected))}onEnd(e){$e.stop(e),!(this.options.length<2)&&(this.selected=this.options.length-1,this.options[this.selected].isDisabled&&this.selected>1&&this.selected--,this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selected),this.select(this.selected))}onCharacter(e){let t=Op.toString(e.keyCode),n=-1;for(let i=0;i<this.options.length-1;i++)if(n=(i+this.selected+1)%this.options.length,this.options[n].text.charAt(0).toUpperCase()===t&&!this.options[n].isDisabled){this.select(n),this.selectList.setFocus([n]),this.selectList.reveal(this.selectList.getFocus()[0]),$e.stop(e);break}}dispose(){this.hideSelectDropDown(!1),super.dispose()}};var qS=class extends V{selectElement;selectBoxOptions;options;selected=0;_onDidSelect;styles;constructor(e,t,n,i){super(),this.selectBoxOptions=i||Object.create(null),this.options=[],this.selectElement=document.createElement("select"),this.selectElement.className="monaco-select-box",typeof this.selectBoxOptions.ariaLabel=="string"&&this.selectElement.setAttribute("aria-label",this.selectBoxOptions.ariaLabel),typeof this.selectBoxOptions.ariaDescription=="string"&&this.selectElement.setAttribute("aria-description",this.selectBoxOptions.ariaDescription),this._onDidSelect=this._register(new E),this.styles=n,this.registerListeners(),this.setOptions(e,t)}registerListeners(){this._register(Yt.addTarget(this.selectElement)),[at.Tap].forEach(e=>{this._register(U(this.selectElement,e,t=>{this.selectElement.focus()}))}),this._register(Jt(this.selectElement,"click",e=>{$e.stop(e,!0)})),this._register(Jt(this.selectElement,"change",e=>{this.selectElement.title=e.target.value,this._onDidSelect.fire({index:e.target.selectedIndex,selected:e.target.value})})),this._register(Jt(this.selectElement,"keydown",e=>{let t=!1;Be?(e.keyCode===18||e.keyCode===16||e.keyCode===10)&&(t=!0):(e.keyCode===18&&e.altKey||e.keyCode===10||e.keyCode===3)&&(t=!0),t&&e.stopPropagation()}))}get onDidSelect(){return this._onDidSelect.event}setOptions(e,t){(!this.options||!on(this.options,e))&&(this.options=e,this.selectElement.options.length=0,this.options.forEach((n,i)=>{this.selectElement.add(this.createOption(n.text,i,n.isDisabled))})),t!==void 0&&this.select(t)}select(e){this.options.length===0?this.selected=0:e>=0&&e<this.options.length?this.selected=e:e>this.options.length-1?this.select(this.options.length-1):this.selected<0&&(this.selected=0),this.selectElement.selectedIndex=this.selected,this.selected<this.options.length&&typeof this.options[this.selected].text=="string"?this.selectElement.title=this.options[this.selected].text:this.selectElement.title=""}setAriaLabel(e){this.selectBoxOptions.ariaLabel=e,this.selectElement.setAttribute("aria-label",e)}focus(){this.selectElement&&(this.selectElement.tabIndex=0,this.selectElement.focus())}blur(){this.selectElement&&(this.selectElement.tabIndex=-1,this.selectElement.blur())}setEnabled(e){this.selectElement.disabled=!e}setFocusable(e){this.selectElement.tabIndex=e?0:-1}render(e){e.classList.add("select-container"),e.appendChild(this.selectElement),this.setOptions(this.options,this.selected),this.applyStyles()}style(e){this.styles=e,this.applyStyles()}applyStyles(){this.selectElement&&(this.selectElement.style.backgroundColor=this.styles.selectBackground??"",this.selectElement.style.color=this.styles.selectForeground??"",this.selectElement.style.borderColor=this.styles.selectBorder??"")}createOption(e,t,n){let i=document.createElement("option");return i.value=e,i.text=e,i.disabled=!!n,i}};var Fxt={...aF,selectBackground:"#3C3C3C",selectForeground:"#F0F0F0",selectBorder:"#3C3C3C",decoratorRightForeground:void 0,selectListBackground:void 0,selectListBorder:void 0,focusBorder:void 0},YS=class extends On{selectBoxDelegate;constructor(e,t,n,i,r){super(),Be&&!r?.useCustomDrawn?this.selectBoxDelegate=new qS(e,t,i,r):this.selectBoxDelegate=new $S(e,t,n,i,r),this._register(this.selectBoxDelegate)}get onDidSelect(){return this.selectBoxDelegate.onDidSelect}setOptions(e,t){this.selectBoxDelegate.setOptions(e,t)}select(e){this.selectBoxDelegate.select(e)}setAriaLabel(e){this.selectBoxDelegate.setAriaLabel(e)}focus(){this.selectBoxDelegate.focus()}blur(){this.selectBoxDelegate.blur()}setFocusable(e){this.selectBoxDelegate.setFocusable(e)}setEnabled(e){this.selectBoxDelegate.setEnabled(e)}render(e){this.selectBoxDelegate.render(e)}};var La=class extends On{_onChange=this._register(new E);onChange=this._onChange.event;_onKeyDown=this._register(new E);onKeyDown=this._onKeyDown.event;_opts;_icon;domNode;_checked;_hover;constructor(e){super(),this._opts=e,this._checked=this._opts.isChecked;let t=["monaco-custom-toggle"];this._opts.icon&&(this._icon=this._opts.icon,t.push(...Je.asClassNameArray(this._icon))),this._opts.actionClassName&&t.push(...this._opts.actionClassName.split(" ")),this._checked&&t.push("checked"),this.domNode=document.createElement("div"),this._hover=this._register(ho().setupManagedHover(e.hoverDelegate??Gt("mouse"),this.domNode,this._opts.title)),this.domNode.classList.add(...t),this._opts.notFocusable||(this.domNode.tabIndex=0),this.domNode.setAttribute("role","checkbox"),this.domNode.setAttribute("aria-checked",String(this._checked)),this.domNode.setAttribute("aria-label",this._opts.title),this.applyStyles(),this.onclick(this.domNode,n=>{this.enabled&&(this.checked=!this._checked,this._onChange.fire(!1),n.preventDefault())}),this._register(this.ignoreGesture(this.domNode)),this.onkeydown(this.domNode,n=>{if(n.keyCode===10||n.keyCode===3){this.checked=!this._checked,this._onChange.fire(!0),n.preventDefault(),n.stopPropagation();return}this._onKeyDown.fire(n)})}get enabled(){return this.domNode.getAttribute("aria-disabled")!=="true"}focus(){this.domNode.focus()}get checked(){return this._checked}set checked(e){this._checked=e,this.domNode.setAttribute("aria-checked",String(this._checked)),this.domNode.classList.toggle("checked",this._checked),this.applyStyles()}setIcon(e){this._icon&&this.domNode.classList.remove(...Je.asClassNameArray(this._icon)),this._icon=e,this._icon&&this.domNode.classList.add(...Je.asClassNameArray(this._icon))}width(){return 22}applyStyles(){this.domNode&&(this.domNode.style.borderColor=this._checked&&this._opts.inputActiveOptionBorder||"",this.domNode.style.color=this._checked&&this._opts.inputActiveOptionForeground||"inherit",this.domNode.style.backgroundColor=this._checked&&this._opts.inputActiveOptionBackground||"")}enable(){this.domNode.setAttribute("aria-disabled",String(!1))}disable(){this.domNode.setAttribute("aria-disabled",String(!0))}setTitle(e){this._hover.update(e),this.domNode.setAttribute("aria-label",e)}set visible(e){this.domNode.style.display=e?"":"none"}get visible(){return this.domNode.style.display!=="none"}};var si=class extends V{constructor(t,n,i={}){super();this.options=i;this._context=t||this,this._action=n,n instanceof ir&&this._register(n.onDidChange(r=>{this.element&&this.handleActionChangeEvent(r)}))}element;_context;_action;customHover;get action(){return this._action}_actionRunner;handleActionChangeEvent(t){t.enabled!==void 0&&this.updateEnabled(),t.checked!==void 0&&this.updateChecked(),t.class!==void 0&&this.updateClass(),t.label!==void 0&&(this.updateLabel(),this.updateTooltip()),t.tooltip!==void 0&&this.updateTooltip()}get actionRunner(){return this._actionRunner||(this._actionRunner=this._register(new jo)),this._actionRunner}set actionRunner(t){this._actionRunner=t}isEnabled(){return this._action.enabled}setActionContext(t){this._context=t}render(t){let n=this.element=t;this._register(Yt.addTarget(t));let i=this.options&&this.options.draggable;i&&(t.draggable=!0,sn&&this._register(U(t,ae.DRAG_START,r=>r.dataTransfer?.setData(Jh.TEXT,this._action.label)))),this._register(U(n,at.Tap,r=>this.onClick(r,!0))),this._register(U(n,ae.MOUSE_DOWN,r=>{i||$e.stop(r,!0),this._action.enabled&&r.button===0&&n.classList.add("active")})),Be&&this._register(U(n,ae.CONTEXT_MENU,r=>{r.button===0&&r.ctrlKey===!0&&this.onClick(r)})),this._register(U(n,ae.CLICK,r=>{$e.stop(r,!0),this.options&&this.options.isMenu||this.onClick(r)})),this._register(U(n,ae.DBLCLICK,r=>{$e.stop(r,!0)})),[ae.MOUSE_UP,ae.MOUSE_OUT].forEach(r=>{this._register(U(n,r,s=>{$e.stop(s),n.classList.remove("active")}))})}onClick(t,n=!1){$e.stop(t,!0);let i=pi(this._context)?this.options?.useEventAsContext?t:{preserveFocus:n}:this._context;this.actionRunner.run(this._action,i)}focus(){this.element&&(this.element.tabIndex=0,this.element.focus(),this.element.classList.add("focused"))}isFocused(){return!!this.element?.classList.contains("focused")}blur(){this.element&&(this.element.blur(),this.element.tabIndex=-1,this.element.classList.remove("focused"))}setFocusable(t){this.element&&(this.element.tabIndex=t?0:-1)}get trapsArrowNavigation(){return!1}updateEnabled(){}updateLabel(){}getClass(){return this.action.class}getTooltip(){return this.action.tooltip}updateTooltip(){if(!this.element)return;let t=this.getTooltip()??"";if(this.updateAriaLabel(),this.options.hoverDelegate?.showNativeHover)this.element.title=t;else if(!this.customHover&&t!==""){let n=this.options.hoverDelegate??Gt("element");this.customHover=this._store.add(ho().setupManagedHover(n,this.element,t))}else this.customHover&&this.customHover.update(t)}updateAriaLabel(){if(this.element){let t=this.getTooltip()??"";this.element.setAttribute("aria-label",t)}}updateClass(){}updateChecked(){}dispose(){this.element&&(this.element.remove(),this.element=void 0),this._context=void 0,super.dispose()}},Ul=class extends si{label;options;cssClass;constructor(e,t,n){super(e,t,n),this.options=n,this.options.icon=n.icon!==void 0?n.icon:!1,this.options.label=n.label!==void 0?n.label:!0,this.cssClass=""}render(e){super.render(e),Yc(this.element);let t=document.createElement("a");if(t.classList.add("action-label"),t.setAttribute("role",this.getDefaultAriaRole()),this.label=t,this.element.appendChild(t),this.options.label&&this.options.keybinding){let n=document.createElement("span");n.classList.add("keybinding"),n.textContent=this.options.keybinding,this.element.appendChild(n)}this.updateClass(),this.updateLabel(),this.updateTooltip(),this.updateEnabled(),this.updateChecked()}getDefaultAriaRole(){return this._action.id===In.ID?"presentation":this.options.isMenu?"menuitem":this.options.isTabList?"tab":"button"}focus(){this.label&&(this.label.tabIndex=0,this.label.focus())}isFocused(){return!!this.label&&this.label?.tabIndex===0}blur(){this.label&&(this.label.tabIndex=-1)}setFocusable(e){this.label&&(this.label.tabIndex=e?0:-1)}updateLabel(){this.options.label&&this.label&&(this.label.textContent=this.action.label)}getTooltip(){let e=null;return this.action.tooltip?e=this.action.tooltip:!this.options.label&&this.action.label&&this.options.icon&&(e=this.action.label,this.options.keybinding&&(e=p({key:"titleLabel",comment:["action title","action keybinding"]},"{0} ({1})",e,this.options.keybinding))),e??void 0}updateClass(){this.cssClass&&this.label&&this.label.classList.remove(...this.cssClass.split(" ")),this.options.icon?(this.cssClass=this.getClass(),this.label&&(this.label.classList.add("codicon"),this.cssClass&&this.label.classList.add(...this.cssClass.split(" "))),this.updateEnabled()):this.label?.classList.remove("codicon")}updateEnabled(){this.action.enabled?(this.label&&(this.label.removeAttribute("aria-disabled"),this.label.classList.remove("disabled")),this.element?.classList.remove("disabled")):(this.label&&(this.label.setAttribute("aria-disabled","true"),this.label.classList.add("disabled")),this.element?.classList.add("disabled"))}updateAriaLabel(){if(this.label){let e=this.getTooltip()??"";this.label.setAttribute("aria-label",e)}}updateChecked(){this.label&&(this.action.checked!==void 0?(this.label.classList.toggle("checked",this.action.checked),this.options.isTabList?this.label.setAttribute("aria-selected",this.action.checked?"true":"false"):(this.label.setAttribute("aria-checked",this.action.checked?"true":"false"),this.label.setAttribute("role","checkbox"))):(this.label.classList.remove("checked"),this.label.removeAttribute(this.options.isTabList?"aria-selected":"aria-checked"),this.label.setAttribute("role",this.getDefaultAriaRole())))}},ZS=class extends si{selectBox;constructor(e,t,n,i,r,s,a){super(e,t),this.selectBox=new YS(n,i,r,s,a),this.selectBox.setFocusable(!1),this._register(this.selectBox),this.registerListeners()}setOptions(e,t){this.selectBox.setOptions(e,t)}select(e){this.selectBox.select(e)}registerListeners(){this._register(this.selectBox.onDidSelect(e=>this.runAction(e.selected,e.index)))}runAction(e,t){this.actionRunner.run(this._action,this.getActionContext(e,t))}getActionContext(e,t){return e}setFocusable(e){this.selectBox.setFocusable(e)}focus(){this.selectBox?.focus()}blur(){this.selectBox?.blur()}render(e){this.selectBox.render(e)}};var Da=class extends V{options;_hoverDelegate;_actionRunner;_actionRunnerDisposables=this._register(new he);_context;_orientation;_triggerKeys;viewItems;viewItemDisposables=this._register(new Fo);previouslyFocusedItem;focusedItem;focusTracker;triggerKeyDown=!1;focusable=!0;domNode;actionsList;_onDidBlur=this._register(new E);onDidBlur=this._onDidBlur.event;_onDidCancel=this._register(new E({onWillAddFirstListener:()=>this.cancelHasListener=!0}));onDidCancel=this._onDidCancel.event;cancelHasListener=!1;_onDidRun=this._register(new E);onDidRun=this._onDidRun.event;_onWillRun=this._register(new E);onWillRun=this._onWillRun.event;constructor(e,t={}){super(),this.options=t,this._context=t.context??null,this._orientation=this.options.orientation??0,this._triggerKeys={keyDown:this.options.triggerKeys?.keyDown??!1,keys:this.options.triggerKeys?.keys??[3,10]},this._hoverDelegate=t.hoverDelegate??this._register(Wl()),this.options.actionRunner?this._actionRunner=this.options.actionRunner:(this._actionRunner=new jo,this._actionRunnerDisposables.add(this._actionRunner)),this._actionRunnerDisposables.add(this._actionRunner.onDidRun(r=>this._onDidRun.fire(r))),this._actionRunnerDisposables.add(this._actionRunner.onWillRun(r=>this._onWillRun.fire(r))),this.viewItems=[],this.focusedItem=void 0,this.domNode=document.createElement("div"),this.domNode.className="monaco-action-bar";let n,i;switch(this._orientation){case 0:n=[15],i=[17];break;case 1:n=[16],i=[18],this.domNode.className+=" vertical";break}this._register(U(this.domNode,ae.KEY_DOWN,r=>{let s=new nt(r),a=!0,l=typeof this.focusedItem=="number"?this.viewItems[this.focusedItem]:void 0;n&&(s.equals(n[0])||s.equals(n[1]))?a=this.focusPrevious():i&&(s.equals(i[0])||s.equals(i[1]))?a=this.focusNext():s.equals(9)&&this.cancelHasListener?this._onDidCancel.fire():s.equals(14)?a=this.focusFirst():s.equals(13)?a=this.focusLast():s.equals(2)&&l instanceof si&&l.trapsArrowNavigation?a=this.focusNext(void 0,!0):this.isTriggerKeyEvent(s)?this._triggerKeys.keyDown?this.doTrigger(s):this.triggerKeyDown=!0:a=!1,a&&(s.preventDefault(),s.stopPropagation())})),this._register(U(this.domNode,ae.KEY_UP,r=>{let s=new nt(r);this.isTriggerKeyEvent(s)?(!this._triggerKeys.keyDown&&this.triggerKeyDown&&(this.triggerKeyDown=!1,this.doTrigger(s)),s.preventDefault(),s.stopPropagation()):(s.equals(2)||s.equals(1026)||s.equals(16)||s.equals(18)||s.equals(15)||s.equals(17))&&this.updateFocusedItem()})),this.focusTracker=this._register(Ni(this.domNode)),this._register(this.focusTracker.onDidBlur(()=>{(eo()===this.domNode||!Jo(eo(),this.domNode))&&(this._onDidBlur.fire(),this.previouslyFocusedItem=this.focusedItem,this.focusedItem=void 0,this.triggerKeyDown=!1)})),this._register(this.focusTracker.onDidFocus(()=>this.updateFocusedItem())),this.actionsList=document.createElement("ul"),this.actionsList.className="actions-container",this.options.highlightToggledItems&&this.actionsList.classList.add("highlight-toggled"),this.actionsList.setAttribute("role",this.options.ariaRole||"toolbar"),this.options.ariaLabel&&this.actionsList.setAttribute("aria-label",this.options.ariaLabel),this.domNode.appendChild(this.actionsList),e.appendChild(this.domNode)}refreshRole(){this.length()>=1?this.actionsList.setAttribute("role",this.options.ariaRole||"toolbar"):this.actionsList.setAttribute("role","presentation")}setAriaLabel(e){e?this.actionsList.setAttribute("aria-label",e):this.actionsList.removeAttribute("aria-label")}setFocusable(e){if(this.focusable=e,this.focusable){let t=this.viewItems.find(n=>n instanceof si&&n.isEnabled());t instanceof si&&t.setFocusable(!0)}else this.viewItems.forEach(t=>{t instanceof si&&t.setFocusable(!1)})}isTriggerKeyEvent(e){let t=!1;return this._triggerKeys.keys.forEach(n=>{t=t||e.equals(n)}),t}updateFocusedItem(){for(let e=0;e<this.actionsList.children.length;e++){let t=this.actionsList.children[e];if(Jo(eo(),t)){this.focusedItem=e,this.viewItems[this.focusedItem]?.showHover?.();break}}}get context(){return this._context}set context(e){this._context=e,this.viewItems.forEach(t=>t.setActionContext(e))}get actionRunner(){return this._actionRunner}set actionRunner(e){this._actionRunner=e,this._actionRunnerDisposables.clear(),this._actionRunnerDisposables.add(this._actionRunner.onDidRun(t=>this._onDidRun.fire(t))),this._actionRunnerDisposables.add(this._actionRunner.onWillRun(t=>this._onWillRun.fire(t))),this.viewItems.forEach(t=>t.actionRunner=e)}getContainer(){return this.domNode}hasAction(e){return this.viewItems.findIndex(t=>t.action.id===e.id)!==-1}getAction(e){if(typeof e=="number")return this.viewItems[e]?.action;if(yn(e)){for(;e.parentElement!==this.actionsList;){if(!e.parentElement)return;e=e.parentElement}for(let t=0;t<this.actionsList.childNodes.length;t++)if(this.actionsList.childNodes[t]===e)return this.viewItems[t].action}}push(e,t={}){let n=Array.isArray(e)?e:[e],i=yi(t.index)?t.index:null;n.forEach(r=>{let s=document.createElement("li");s.className="action-item",s.setAttribute("role","presentation");let a,l={hoverDelegate:this._hoverDelegate,...t,isTabList:this.options.ariaRole==="tablist"};this.options.actionViewItemProvider&&(a=this.options.actionViewItemProvider(r,l)),a||(a=new Ul(this.context,r,l)),this.options.allowContextMenu||this.viewItemDisposables.set(a,U(s,ae.CONTEXT_MENU,d=>{$e.stop(d,!0)})),a.actionRunner=this._actionRunner,a.setActionContext(this.context),a.render(s),this.focusable&&a instanceof si&&this.viewItems.length===0&&a.setFocusable(!0),i===null||i<0||i>=this.actionsList.children.length?(this.actionsList.appendChild(s),this.viewItems.push(a)):(this.actionsList.insertBefore(s,this.actionsList.children[i]),this.viewItems.splice(i,0,a),i++)}),typeof this.focusedItem=="number"&&this.focus(this.focusedItem),this.refreshRole()}getWidth(e){if(e>=0&&e<this.actionsList.children.length){let t=this.actionsList.children.item(e);if(t)return t.clientWidth}return 0}getHeight(e){if(e>=0&&e<this.actionsList.children.length){let t=this.actionsList.children.item(e);if(t)return t.clientHeight}return 0}pull(e){e>=0&&e<this.viewItems.length&&(this.actionsList.childNodes[e].remove(),this.viewItemDisposables.deleteAndDispose(this.viewItems[e]),kt(this.viewItems.splice(e,1)),this.refreshRole())}clear(){this.isEmpty()||(this.viewItems=kt(this.viewItems),this.viewItemDisposables.clearAndDisposeAll(),Ci(this.actionsList),this.refreshRole())}length(){return this.viewItems.length}isEmpty(){return this.viewItems.length===0}focus(e){let t=!1,n;if(e===void 0?t=!0:typeof e=="number"?n=e:typeof e=="boolean"&&(t=e),t&&typeof this.focusedItem>"u"){let i=this.viewItems.findIndex(r=>r.isEnabled());this.focusedItem=i===-1?void 0:i,this.updateFocus(void 0,void 0,!0)}else n!==void 0&&(this.focusedItem=n),this.updateFocus(void 0,void 0,!0)}focusFirst(){return this.focusedItem=this.length()-1,this.focusNext(!0)}focusLast(){return this.focusedItem=0,this.focusPrevious(!0)}focusNext(e,t){if(typeof this.focusedItem>"u")this.focusedItem=this.viewItems.length-1;else if(this.viewItems.length<=1)return!1;let n=this.focusedItem,i;do{if(!e&&this.options.preventLoopNavigation&&this.focusedItem+1>=this.viewItems.length)return this.focusedItem=n,!1;this.focusedItem=(this.focusedItem+1)%this.viewItems.length,i=this.viewItems[this.focusedItem]}while(this.focusedItem!==n&&(this.options.focusOnlyEnabledItems&&!i.isEnabled()||i.action.id===In.ID));return this.updateFocus(void 0,void 0,t),!0}focusPrevious(e){if(typeof this.focusedItem>"u")this.focusedItem=0;else if(this.viewItems.length<=1)return!1;let t=this.focusedItem,n;do{if(this.focusedItem=this.focusedItem-1,this.focusedItem<0){if(!e&&this.options.preventLoopNavigation)return this.focusedItem=t,!1;this.focusedItem=this.viewItems.length-1}n=this.viewItems[this.focusedItem]}while(this.focusedItem!==t&&(this.options.focusOnlyEnabledItems&&!n.isEnabled()||n.action.id===In.ID));return this.updateFocus(!0),!0}updateFocus(e,t,n=!1){typeof this.focusedItem>"u"&&this.actionsList.focus({preventScroll:t}),this.previouslyFocusedItem!==void 0&&this.previouslyFocusedItem!==this.focusedItem&&this.viewItems[this.previouslyFocusedItem]?.blur();let i=this.focusedItem!==void 0?this.viewItems[this.focusedItem]:void 0;if(i){let r=!0;Kp(i.focus)||(r=!1),this.options.focusOnlyEnabledItems&&Kp(i.isEnabled)&&!i.isEnabled()&&(r=!1),i.action.id===In.ID&&(r=!1),r?(n||this.previouslyFocusedItem!==this.focusedItem)&&(i.focus(e),this.previouslyFocusedItem=this.focusedItem):(this.actionsList.focus({preventScroll:t}),this.previouslyFocusedItem=void 0),r&&i.showHover?.()}}doTrigger(e){if(typeof this.focusedItem>"u")return;let t=this.viewItems[this.focusedItem];if(t instanceof si){let n=t._context===null||t._context===void 0?e:t._context;this.run(t._action,n)}}async run(e,t){await this._actionRunner.run(e,t)}dispose(){this._context=void 0,this.viewItems=kt(this.viewItems),this.getContainer().remove(),super.dispose()}};function F0(o){if(!o.length)return o;let e=-1;for(let n=0;n<o.length;n++)if(o[n].id!==In.ID){e=n;break}if(e===-1)return[];o=o.slice(e);for(let n=o.length-1;n>=0&&o[n].id===In.ID;n--)o.splice(n,1);let t=!1;for(let n=o.length-1;n>=0;n--){let i=o[n].id===In.ID;i&&!t?o.splice(n,1):i?i&&(t=!1):t=!0}return o}var XS=class extends qg{constructor(t,n,i,r){super(t,i,r);this.telemetryService=n}_onTitleAreaUpdate=this._register(new E);onTitleAreaUpdate=this._onTitleAreaUpdate.event;_onDidFocus;get onDidFocus(){return this._onDidFocus||(this._onDidFocus=this.registerFocusTrackEvents().onDidFocus),this._onDidFocus.event}_onDidBlur;get onDidBlur(){return this._onDidBlur||(this._onDidBlur=this.registerFocusTrackEvents().onDidBlur),this._onDidBlur.event}_hasFocus=!1;hasFocus(){return this._hasFocus}registerFocusTrackEvents(){let t=Tn(this.getContainer()),n=this._register(Ni(t)),i=this._onDidFocus=this._register(new E);this._register(n.onDidFocus(()=>{this._hasFocus=!0,i.fire()}));let r=this._onDidBlur=this._register(new E);return this._register(n.onDidBlur(()=>{this._hasFocus=!1,r.fire()})),{onDidFocus:i,onDidBlur:r}}actionRunner;visible=!1;parent;getTitle(){}create(t){this.parent=t}getContainer(){return this.parent}setVisible(t){this.visible!==!!t&&(this.visible=t)}focus(){}getMenuIds(){return[]}getActions(){return[]}getSecondaryActions(){return[]}getContextMenuActions(){return[]}getActionViewItem(t,n){}getActionsContext(){return null}getActionRunner(){return this.actionRunner||(this.actionRunner=this._register(new jo)),this.actionRunner}updateTitleArea(){this._onTitleAreaUpdate.fire()}isVisible(){return this.visible}getControl(){}};var Z_t={separatorBorder:N.transparent};var Qg;(i=>{i.Distribute={type:"distribute"};function e(r){return{type:"split",index:r}}i.Split=e;function t(r){return{type:"auto",index:r}}i.Auto=t;function n(r){return{type:"invisible",cachedVisibleSize:r}}i.Invisible=n})(Qg||={});var bTt={separatorBorder:N.transparent};var rz;(i=>{i.Distribute={type:"distribute"},i.Split={type:"split"},i.Auto={type:"auto"};function n(r){return{type:"invisible",cachedVisibleSize:r}}i.Invisible=n})(rz||={});async function vF(o){let e=navigator.usb;if(!e)return;let t=await e.requestDevice({filters:o?.filters??[]});if(t)return{deviceClass:t.deviceClass,deviceProtocol:t.deviceProtocol,deviceSubclass:t.deviceSubclass,deviceVersionMajor:t.deviceVersionMajor,deviceVersionMinor:t.deviceVersionMinor,deviceVersionSubminor:t.deviceVersionSubminor,manufacturerName:t.manufacturerName,productId:t.productId,productName:t.productName,serialNumber:t.serialNumber,usbVersionMajor:t.usbVersionMajor,usbVersionMinor:t.usbVersionMinor,usbVersionSubminor:t.usbVersionSubminor,vendorId:t.vendorId}}async function yF(o){let e=navigator.serial;if(!e)return;let t=await e.requestPort({filters:o?.filters??[]});if(!t)return;let n=t.getInfo();return{usbVendorId:n.usbVendorId,usbProductId:n.usbProductId}}async function IF(o){let e=navigator.hid;if(!e)return;let t=await e.requestDevice({filters:o?.filters??[]});if(!t.length)return;let n=t[0];return{opened:n.opened,vendorId:n.vendorId,productId:n.productId,productName:n.productName,collections:n.collections}}var Us=Y("openerService");var sz=60,az=sz*60,B0=az*24,eLt=B0*7,tLt=B0*30,nLt=B0*365;function CF(o){return o.getFullYear()+"-"+String(o.getMonth()+1).padStart(2,"0")+"-"+String(o.getDate()).padStart(2,"0")+"T"+String(o.getHours()).padStart(2,"0")+":"+String(o.getMinutes()).padStart(2,"0")+":"+String(o.getSeconds()).padStart(2,"0")+"."+(o.getMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}var Jg=/^([^.]+\..+)[:=](.+)$/,Ot=class{constructor(e,t,n){this._args=e;this.paths=t;this.productService=n}get appRoot(){return Pc(el.asFileUri("").fsPath)}get userHome(){return ie.file(this.paths.homeDir)}get userDataPath(){return this.paths.userDataDir}get appSettingsHome(){return ie.file(No(this.userDataPath,"User"))}get tmpDir(){return ie.file(this.paths.tmpDir)}get cacheHome(){return ie.file(this.userDataPath)}get stateResource(){return ht(this.appSettingsHome,"globalStorage","storage.json")}get userRoamingDataHome(){return this.appSettingsHome.with({scheme:Te.vscodeUserData})}get userDataSyncHome(){return ht(this.appSettingsHome,"sync")}get logsHome(){if(!this.args.logsPath){let e=CF(new Date).replace(/-|:|\.\d+Z$/g,"");this.args.logsPath=No(this.userDataPath,"logs",e)}return ie.file(this.args.logsPath)}get sync(){return this.args.sync}get machineSettingsResource(){return ht(ie.file(No(this.userDataPath,"Machine")),"settings.json")}get workspaceStorageHome(){return ht(this.appSettingsHome,"workspaceStorage")}get localHistoryHome(){return ht(this.appSettingsHome,"History")}get keyboardLayoutResource(){return ht(this.userRoamingDataHome,"keyboardLayout.json")}get argvResource(){let e=Wa.VSCODE_PORTABLE;return e?ie.file(No(e,"argv.json")):ht(this.userHome,this.productService.dataFolderName,"argv.json")}get isExtensionDevelopment(){return!!this.args.extensionDevelopmentPath}get untitledWorkspacesHome(){return ie.file(No(this.userDataPath,"Workspaces"))}get builtinExtensionsPath(){let e=this.args["builtin-extensions-dir"];return e?Nc(e):Ka(No(el.asFileUri("").fsPath,"..","extensions"))}get extensionsDownloadLocation(){let e=this.args["extensions-download-dir"];return e?ie.file(Nc(e)):ie.file(No(this.userDataPath,"CachedExtensionVSIXs"))}get extensionsPath(){let e=this.args["extensions-dir"];if(e)return Nc(e);let t=Wa.VSCODE_EXTENSIONS;if(t)return t;let n=Wa.VSCODE_PORTABLE;return n?No(n,"extensions"):ht(this.userHome,this.productService.dataFolderName,"extensions").fsPath}get extensionDevelopmentLocationURI(){let e=this.args.extensionDevelopmentPath;if(Array.isArray(e))return e.map(t=>/^[^:/?#]+?:\/\//.test(t)?ie.parse(t):ie.file(Ka(t)))}get extensionDevelopmentKind(){return this.args.extensionDevelopmentKind?.map(e=>e==="ui"||e==="workspace"||e==="web"?e:"workspace")}get extensionTestsLocationURI(){let e=this.args.extensionTestsPath;if(e)return/^[^:/?#]+?:\/\//.test(e)?ie.parse(e):ie.file(Ka(e))}get disableExtensions(){if(this.args["disable-extensions"])return!0;let e=this.args["disable-extension"];if(e){if(typeof e=="string")return[e];if(Array.isArray(e)&&e.length>0)return e}return!1}get debugExtensionHost(){return lz(this.args,this.isBuilt)}get debugRenderer(){return!!this.args.debugRenderer}get isBuilt(){return!Wa.VSCODE_DEV}get verbose(){return!!this.args.verbose}get logLevel(){return this.args.log?.find(e=>!Jg.test(e))}get extensionLogLevel(){let e=[];for(let t of this.args.log||[]){let n=Jg.exec(t);n&&n[1]&&n[2]&&e.push([n[1],n[2]])}return e.length?e:void 0}get serviceMachineIdResource(){return ht(ie.file(this.userDataPath),"machineid")}get crashReporterId(){return this.args["crash-reporter-id"]}get crashReporterDirectory(){return this.args["crash-reporter-directory"]}get disableTelemetry(){return!!this.args["disable-telemetry"]}get disableWorkspaceTrust(){return!!this.args["disable-workspace-trust"]}get useInMemorySecretStorage(){return!!this.args["use-inmemory-secretstorage"]}get policyFile(){if(this.args["__enable-file-policy"]){let e=Wa.VSCODE_PORTABLE;return e?ie.file(No(e,"policy.json")):ht(this.userHome,this.productService.dataFolderName,"policy.json")}}editSessionId=this.args.editSessionId;get continueOn(){return this.args.continueOn}set continueOn(e){this.args.continueOn=e}get args(){return this._args}};R([de],Ot.prototype,"appRoot",1),R([de],Ot.prototype,"userHome",1),R([de],Ot.prototype,"userDataPath",1),R([de],Ot.prototype,"appSettingsHome",1),R([de],Ot.prototype,"tmpDir",1),R([de],Ot.prototype,"cacheHome",1),R([de],Ot.prototype,"stateResource",1),R([de],Ot.prototype,"userRoamingDataHome",1),R([de],Ot.prototype,"userDataSyncHome",1),R([de],Ot.prototype,"sync",1),R([de],Ot.prototype,"machineSettingsResource",1),R([de],Ot.prototype,"workspaceStorageHome",1),R([de],Ot.prototype,"localHistoryHome",1),R([de],Ot.prototype,"keyboardLayoutResource",1),R([de],Ot.prototype,"argvResource",1),R([de],Ot.prototype,"isExtensionDevelopment",1),R([de],Ot.prototype,"untitledWorkspacesHome",1),R([de],Ot.prototype,"builtinExtensionsPath",1),R([de],Ot.prototype,"extensionsPath",1),R([de],Ot.prototype,"extensionDevelopmentLocationURI",1),R([de],Ot.prototype,"extensionDevelopmentKind",1),R([de],Ot.prototype,"extensionTestsLocationURI",1),R([de],Ot.prototype,"debugExtensionHost",1),R([de],Ot.prototype,"logLevel",1),R([de],Ot.prototype,"extensionLogLevel",1),R([de],Ot.prototype,"serviceMachineIdResource",1),R([de],Ot.prototype,"disableTelemetry",1),R([de],Ot.prototype,"disableWorkspaceTrust",1),R([de],Ot.prototype,"useInMemorySecretStorage",1),R([de],Ot.prototype,"policyFile",1);function lz(o,e){return dz(o["inspect-extensions"],o["inspect-brk-extensions"],5870,e,o.debugId,o.extensionEnvironment)}function dz(o,e,t,n,i,r){let a=Number(e||o)||(n?null:t),l=a?!!e:!1,d;if(r)try{d=JSON.parse(r)}catch{}return{port:a,break:l,debugId:i,env:d}}var SF=Go,rt=class{constructor(e,t,n,i){this.workspaceId=e;this.logsHome=t;this.options=n;this.productService=i;if(n.workspaceProvider&&Array.isArray(n.workspaceProvider.payload))try{this.payload=new Map(n.workspaceProvider.payload)}catch(r){je(r)}}get remoteAuthority(){return this.options.remoteAuthority}get expectsResolverExtension(){return!!this.options.remoteAuthority?.includes("+")&&!this.options.webSocketFactory}get isBuilt(){return!!this.productService.commit}get logLevel(){let e=this.payload?.get("logLevel");return e?e.split(",").find(t=>!Jg.test(t)):this.options.developmentOptions?.logLevel!==void 0?Ey(this.options.developmentOptions?.logLevel):void 0}get extensionLogLevel(){let e=this.payload?.get("logLevel");if(e){let t=[];for(let n of e.split(",")){let i=Jg.exec(n);i&&i[1]&&i[2]&&t.push([i[1],i[2]])}return t.length?t:void 0}return this.options.developmentOptions?.extensionLogLevel!==void 0?this.options.developmentOptions?.extensionLogLevel.map(([t,n])=>[t,Ey(n)]):void 0}get profDurationMarkers(){let e=this.payload?.get("profDurationMarkers");if(e){let t=[];for(let n of e.split(","))t.push(n);return t.length===2?t:void 0}}get windowLogsPath(){return this.logsHome}get logFile(){return ht(this.windowLogsPath,"window.log")}get userRoamingDataHome(){return ie.file("/User").with({scheme:Te.vscodeUserData})}get argvResource(){return ht(this.userRoamingDataHome,"argv.json")}get cacheHome(){return ht(this.userRoamingDataHome,"caches")}get workspaceStorageHome(){return ht(this.userRoamingDataHome,"workspaceStorage")}get localHistoryHome(){return ht(this.userRoamingDataHome,"History")}get stateResource(){return ht(this.userRoamingDataHome,"State","storage.json")}get userDataSyncHome(){return ht(this.userRoamingDataHome,"sync",this.workspaceId)}get sync(){}get keyboardLayoutResource(){return ht(this.userRoamingDataHome,"keyboardLayout.json")}get untitledWorkspacesHome(){return ht(this.userRoamingDataHome,"Workspaces")}get serviceMachineIdResource(){return ht(this.userRoamingDataHome,"machineid")}get extHostLogsPath(){return ht(this.logsHome,"exthost")}get extHostTelemetryLogFile(){return ht(this.extHostLogsPath,"extensionTelemetry.log")}extensionHostDebugEnvironment=void 0;get debugExtensionHost(){return this.extensionHostDebugEnvironment||(this.extensionHostDebugEnvironment=this.resolveExtensionHostDebugEnvironment()),this.extensionHostDebugEnvironment.params}get isExtensionDevelopment(){return this.extensionHostDebugEnvironment||(this.extensionHostDebugEnvironment=this.resolveExtensionHostDebugEnvironment()),this.extensionHostDebugEnvironment.isExtensionDevelopment}get extensionDevelopmentLocationURI(){return this.extensionHostDebugEnvironment||(this.extensionHostDebugEnvironment=this.resolveExtensionHostDebugEnvironment()),this.extensionHostDebugEnvironment.extensionDevelopmentLocationURI}get extensionDevelopmentLocationKind(){return this.extensionHostDebugEnvironment||(this.extensionHostDebugEnvironment=this.resolveExtensionHostDebugEnvironment()),this.extensionHostDebugEnvironment.extensionDevelopmentKind}get extensionTestsLocationURI(){return this.extensionHostDebugEnvironment||(this.extensionHostDebugEnvironment=this.resolveExtensionHostDebugEnvironment()),this.extensionHostDebugEnvironment.extensionTestsLocationURI}get extensionEnabledProposedApi(){return this.extensionHostDebugEnvironment||(this.extensionHostDebugEnvironment=this.resolveExtensionHostDebugEnvironment()),this.extensionHostDebugEnvironment.extensionEnabledProposedApi}get debugRenderer(){return this.extensionHostDebugEnvironment||(this.extensionHostDebugEnvironment=this.resolveExtensionHostDebugEnvironment()),this.extensionHostDebugEnvironment.debugRenderer}get enableSmokeTestDriver(){return this.options.developmentOptions?.enableSmokeTestDriver}get disableExtensions(){return this.payload?.get("disableExtensions")==="true"}get enableExtensions(){return this.options.enabledExtensions}get webviewExternalEndpoint(){let e=this.options.webviewEndpoint||this.productService.webviewContentExternalBaseUrlTemplate||"https://{{uuid}}.vscode-cdn.net/{{quality}}/{{commit}}/out/vs/workbench/contrib/webview/browser/pre/",t=this.payload?.get("webviewExternalEndpointCommit");return e.replace("{{commit}}",t??this.productService.commit??"ef65ac1ba57f57f2a3961bfe94aa20481caca4c6").replace("{{quality}}",(t?"insider":this.productService.quality)??"insider")}get extensionTelemetryLogResource(){return ht(this.logsHome,"extensionTelemetry.log")}get disableTelemetry(){return!1}get verbose(){return this.payload?.get("verbose")==="true"}get logExtensionHostCommunication(){return this.payload?.get("logExtensionHostCommunication")==="true"}get skipReleaseNotes(){return this.payload?.get("skipReleaseNotes")==="true"}get skipWelcome(){return this.payload?.get("skipWelcome")==="true"}get disableWorkspaceTrust(){return!this.options.enableWorkspaceTrust}get profile(){return this.payload?.get("profile")}editSessionId=this.options.editSessionId;payload;resolveExtensionHostDebugEnvironment(){let e={params:{port:null,break:!1},debugRenderer:!1,isExtensionDevelopment:!1,extensionDevelopmentLocationURI:void 0,extensionDevelopmentKind:void 0};if(this.payload)for(let[n,i]of this.payload)switch(n){case"extensionDevelopmentPath":e.extensionDevelopmentLocationURI||(e.extensionDevelopmentLocationURI=[]),e.extensionDevelopmentLocationURI.push(ie.parse(i)),e.isExtensionDevelopment=!0;break;case"extensionDevelopmentKind":e.extensionDevelopmentKind=[i];break;case"extensionTestsPath":e.extensionTestsLocationURI=ie.parse(i);break;case"debugRenderer":e.debugRenderer=i==="true";break;case"debugId":e.params.debugId=i;break;case"inspect-brk-extensions":e.params.port=parseInt(i),e.params.break=!0;break;case"inspect-extensions":e.params.port=parseInt(i);break;case"enableProposedApi":e.extensionEnabledProposedApi=[];break}let t=this.options.developmentOptions;return t&&!e.isExtensionDevelopment&&(t.extensions?.length&&(e.extensionDevelopmentLocationURI=t.extensions.map(n=>ie.revive(n)),e.isExtensionDevelopment=!0),t.extensionTestsPath&&(e.extensionTestsLocationURI=ie.revive(t.extensionTestsPath))),e}get filesToOpenOrCreate(){if(this.payload){let e=this.payload.get("openFile");if(e){let t=ie.parse(e);if(this.payload.has("gotoLineMode")){let n=Fk(t.path);return[{fileUri:t.with({path:n.path}),options:{selection:qn(n.line)?void 0:{startLineNumber:n.line,startColumn:n.column||1}}}]}return[{fileUri:t}]}}}get filesToDiff(){if(this.payload){let e=this.payload.get("diffFilePrimary"),t=this.payload.get("diffFileSecondary");if(e&&t)return[{fileUri:ie.parse(t)},{fileUri:ie.parse(e)}]}}get filesToMerge(){if(this.payload){let e=this.payload.get("mergeFile1"),t=this.payload.get("mergeFile2"),n=this.payload.get("mergeFileBase"),i=this.payload.get("mergeFileResult");if(e&&t&&n&&i)return[{fileUri:ie.parse(e)},{fileUri:ie.parse(t)},{fileUri:ie.parse(n)},{fileUri:ie.parse(i)}]}}};R([de],rt.prototype,"remoteAuthority",1),R([de],rt.prototype,"expectsResolverExtension",1),R([de],rt.prototype,"isBuilt",1),R([de],rt.prototype,"logLevel",1),R([de],rt.prototype,"windowLogsPath",1),R([de],rt.prototype,"logFile",1),R([de],rt.prototype,"userRoamingDataHome",1),R([de],rt.prototype,"argvResource",1),R([de],rt.prototype,"cacheHome",1),R([de],rt.prototype,"workspaceStorageHome",1),R([de],rt.prototype,"localHistoryHome",1),R([de],rt.prototype,"stateResource",1),R([de],rt.prototype,"userDataSyncHome",1),R([de],rt.prototype,"sync",1),R([de],rt.prototype,"keyboardLayoutResource",1),R([de],rt.prototype,"untitledWorkspacesHome",1),R([de],rt.prototype,"serviceMachineIdResource",1),R([de],rt.prototype,"extHostLogsPath",1),R([de],rt.prototype,"extHostTelemetryLogFile",1),R([de],rt.prototype,"debugExtensionHost",1),R([de],rt.prototype,"isExtensionDevelopment",1),R([de],rt.prototype,"extensionDevelopmentLocationURI",1),R([de],rt.prototype,"extensionDevelopmentLocationKind",1),R([de],rt.prototype,"extensionTestsLocationURI",1),R([de],rt.prototype,"extensionEnabledProposedApi",1),R([de],rt.prototype,"debugRenderer",1),R([de],rt.prototype,"enableSmokeTestDriver",1),R([de],rt.prototype,"disableExtensions",1),R([de],rt.prototype,"enableExtensions",1),R([de],rt.prototype,"webviewExternalEndpoint",1),R([de],rt.prototype,"extensionTelemetryLogResource",1),R([de],rt.prototype,"disableTelemetry",1),R([de],rt.prototype,"verbose",1),R([de],rt.prototype,"logExtensionHostCommunication",1),R([de],rt.prototype,"skipReleaseNotes",1),R([de],rt.prototype,"skipWelcome",1),R([de],rt.prototype,"disableWorkspaceTrust",1),R([de],rt.prototype,"profile",1),R([de],rt.prototype,"filesToOpenOrCreate",1),R([de],rt.prototype,"filesToDiff",1),R([de],rt.prototype,"filesToMerge",1);var wF=Y("layoutService");var JS=wF;function QS(o){switch(o){case 0:return"left";case 1:return"right";case 2:return"bottom";case 3:return"top";default:return"bottom"}}var $Dt={[QS(0)]:0,[QS(1)]:1,[QS(2)]:2,[QS(3)]:3};function V0(o){switch(o){case 0:return"always";case 1:return"never";case 2:return"preserve";default:return"preserve"}}var qDt={[V0(0)]:0,[V0(1)]:1,[V0(2)]:2};var zs=Y("lifecycleService");function xF(o){switch(o){case 1:return"Starting";case 2:return"Ready";case 3:return"Restored";case 4:return"Eventually"}}var Ks=class extends V{constructor(t,n){super();this.logService=t;this.storageService=n;this._startupKind=this.resolveStartupKind(),this._register(this.storageService.onWillSaveState(i=>{i.reason===1&&this.storageService.store(Ks.LAST_SHUTDOWN_REASON_KEY,this.shutdownReason,1,1)}))}static LAST_SHUTDOWN_REASON_KEY="lifecyle.lastShutdownReason";_onBeforeShutdown=this._register(new E);onBeforeShutdown=this._onBeforeShutdown.event;_onWillShutdown=this._register(new E);onWillShutdown=this._onWillShutdown.event;_onDidShutdown=this._register(new E);onDidShutdown=this._onDidShutdown.event;_onBeforeShutdownError=this._register(new E);onBeforeShutdownError=this._onBeforeShutdownError.event;_onShutdownVeto=this._register(new E);onShutdownVeto=this._onShutdownVeto.event;_startupKind;get startupKind(){return this._startupKind}_phase=1;get phase(){return this._phase}phaseWhen=new Map;shutdownReason;resolveStartupKind(){let t=this.doResolveStartupKind()??1;return this.logService.trace(`[lifecycle] starting up (startup kind: ${t})`),t}doResolveStartupKind(){let t=this.storageService.getNumber(Ks.LAST_SHUTDOWN_REASON_KEY,1);this.storageService.remove(Ks.LAST_SHUTDOWN_REASON_KEY,1);let n;switch(t){case 3:n=3;break;case 4:n=4;break}return n}set phase(t){if(t<this.phase)throw new Error("Lifecycle cannot go backwards");if(this._phase===t)return;this.logService.trace(`lifecycle: phase changed (value: ${t})`),this._phase=t,kn(`code/LifecyclePhase/${xF(t)}`);let n=this.phaseWhen.get(this._phase);n&&(n.open(),this.phaseWhen.delete(this._phase))}async when(t){if(t<=this._phase)return;let n=this.phaseWhen.get(t);n||(n=new Qc,this.phaseWhen.set(t,n)),await n.wait()}};Ks=R([S(0,Un),S(1,zn)],Ks);var ef=class extends Ks{beforeUnloadListener=void 0;unloadListener=void 0;ignoreBeforeUnload=!1;didUnload=!1;constructor(e,t){super(e,t),this.registerListeners()}registerListeners(){this.beforeUnloadListener=U(De,ae.BEFORE_UNLOAD,e=>this.onBeforeUnload(e)),this.unloadListener=U(De,ae.PAGE_HIDE,()=>this.onUnload())}onBeforeUnload(e){this.ignoreBeforeUnload?(this.logService.info("[lifecycle] onBeforeUnload triggered but ignored once"),this.ignoreBeforeUnload=!1):(this.logService.info("[lifecycle] onBeforeUnload triggered and handled with veto support"),this.doShutdown(()=>this.vetoBeforeUnload(e)))}vetoBeforeUnload(e){e.preventDefault(),e.returnValue=p("lifecycleVeto","Changes that you made may not be saved. Please check press 'Cancel' and try again.")}withExpectedShutdown(e,t){if(typeof e=="number")return this.shutdownReason=e,this.storageService.flush(1);this.ignoreBeforeUnload=!0;try{t?.()}finally{this.ignoreBeforeUnload=!1}}async shutdown(){this.logService.info("[lifecycle] shutdown triggered"),this.beforeUnloadListener?.dispose(),this.unloadListener?.dispose(),await this.storageService.flush(1),this.doShutdown()}doShutdown(e){let t=this.logService;this.storageService.flush(1);let n=!1;function i(r,s){typeof e=="function"&&(r instanceof Promise&&(t.error(`[lifecycle] Long running operations before shutdown are unsupported in the web (id: ${s})`),n=!0),r===!0&&(t.info(`[lifecycle]: Unload was prevented (id: ${s})`),n=!0))}return this._onBeforeShutdown.fire({reason:2,veto(r,s){i(r,s)},finalVeto(r,s){i(r(),s)}}),n&&typeof e=="function"?e():this.onUnload()}onUnload(){if(this.didUnload)return;this.didUnload=!0,this._register(U(De,ae.PAGE_SHOW,t=>this.onLoadAfterUnload(t)));let e=this.logService;this._onWillShutdown.fire({reason:2,joiners:()=>[],token:pn.None,join(t,n){e.error(`[lifecycle] Long running operations during shutdown are unsupported in the web (id: ${n.id})`)},force:()=>{}}),this._onDidShutdown.fire()}onLoadAfterUnload(e){e.persisted&&this.withExpectedShutdown({disableShutdownHandling:!0},()=>De.location.reload())}doResolveStartupKind(){let e=super.doResolveStartupKind();return typeof e!="number"&&performance.getEntriesByType("navigation").at(0)?.type==="reload"&&(e=3),e}};ef=R([S(0,Un),S(1,zn)],ef);fi(zs,ef,0);var tp=Y("hostService");var hz=p("open","open"),pz=p("close","close"),mz=p("find","find"),ew={open:hz,close:pz,find:mz};async function TF(o,e){let t=[];return await LF(o,t,e.logsHome,e.logsHome),t}async function LF(o,e,t,n){let i=await o.resolve(t);for(let{resource:r,isDirectory:s}of i.children||[])if(s)await LF(o,e,r,n);else{let a=(await o.readFile(r)).value.toString();if(a){let l=Zc(n,r);l&&e.push({relativePath:l,contents:a})}}}var DF=Y("editorPaneService");var tw;(e=>e.Workbench="workbench.contributions.kind")(tw||={});var xc=(i=>(i[i.BlockStartup=1]="BlockStartup",i[i.BlockRestore=2]="BlockRestore",i[i.AfterRestored=3]="AfterRestored",i[i.Eventually=4]="Eventually",i))(xc||{});function kF(o){let e=o;return!!e&&typeof e.editorTypeId=="string"}function gz(o){switch(o){case 3:return xc.AfterRestored;case 4:return xc.Eventually}}function RF(o){switch(o){case xc.BlockStartup:return 1;case xc.BlockRestore:return 2;case xc.AfterRestored:return 3;case xc.Eventually:return 4}}var Ec=class o extends V{static INSTANCE=new o;static BLOCK_BEFORE_RESTORE_WARN_THRESHOLD=20;static BLOCK_AFTER_RESTORE_WARN_THRESHOLD=100;instantiationService;lifecycleService;logService;environmentService;editorPaneService;contributionsByPhase=new Map;contributionsByEditor=new Map;contributionsById=new Map;instancesById=new Map;instanceDisposables=this._register(new he);timingsByPhase=new Map;get timings(){return this.timingsByPhase}pendingRestoredContributions=new tl;whenRestored=this.pendingRestoredContributions.p;registerWorkbenchContribution2(e,t,n){let i={id:e,ctor:t};this.instantiationService&&this.lifecycleService&&this.logService&&this.environmentService&&this.editorPaneService&&(typeof n=="number"&&this.lifecycleService.phase>=n||typeof e=="string"&&kF(n)&&this.editorPaneService.didInstantiateEditorPane(n.editorTypeId))?this.safeCreateContribution(this.instantiationService,this.logService,this.environmentService,i,typeof n=="number"?RF(n):this.lifecycleService.phase):(typeof n=="number"&&_p(this.contributionsByPhase,RF(n),[]).push(i),typeof e=="string"&&(this.contributionsById.has(e)?console.error(`IWorkbenchContributionsRegistry#registerWorkbenchContribution(): Can't register multiple contributions with same id '${e}'`):this.contributionsById.set(e,i),kF(n)&&_p(this.contributionsByEditor,n.editorTypeId,[]).push(i)))}registerWorkbenchContribution(e,t){this.registerWorkbenchContribution2(void 0,e,gz(t))}getWorkbenchContribution(e){if(this.instancesById.has(e))return this.instancesById.get(e);let t=this.instantiationService,n=this.lifecycleService,i=this.logService,r=this.environmentService;if(!t||!n||!i||!r)throw new Error(`IWorkbenchContributionsRegistry#getContribution('${e}'): cannot be called before registry started`);let s=this.contributionsById.get(e);if(!s)throw new Error(`IWorkbenchContributionsRegistry#getContribution('${e}'): contribution with that identifier is unknown.`);n.phase<3&&i.warn(`IWorkbenchContributionsRegistry#getContribution('${e}'): contribution instantiated before LifecyclePhase.Restored!`),this.safeCreateContribution(t,i,r,s,n.phase);let a=this.instancesById.get(e);if(!a)throw new Error(`IWorkbenchContributionsRegistry#getContribution('${e}'): failed to create contribution.`);return a}start(e){let t=this.instantiationService=e.get(ct),n=this.lifecycleService=e.get(zs),i=this.logService=e.get(Un),r=this.environmentService=e.get(Go),s=this.editorPaneService=e.get(DF);this._register(n.onDidShutdown(()=>{this.instanceDisposables.clear()}));for(let a of[1,2,3,4])this.instantiateByPhase(t,n,i,r,a);for(let a of this.contributionsByEditor.keys())s.didInstantiateEditorPane(a)&&this.onEditor(a,t,n,i,r);this._register(s.onWillInstantiateEditorPane(a=>this.onEditor(a.typeId,t,n,i,r)))}onEditor(e,t,n,i,r){let s=this.contributionsByEditor.get(e);if(s){this.contributionsByEditor.delete(e);for(let a of s)this.safeCreateContribution(t,i,r,a,n.phase)}}instantiateByPhase(e,t,n,i,r){t.phase>=r?this.doInstantiateByPhase(e,n,i,r):t.when(r).then(()=>this.doInstantiateByPhase(e,n,i,r))}async doInstantiateByPhase(e,t,n,i){let r=this.contributionsByPhase.get(i);if(r)switch(this.contributionsByPhase.delete(i),i){case 1:case 2:{kn(`code/willCreateWorkbenchContributions/${i}`);for(let s of r)this.safeCreateContribution(e,t,n,s,i);kn(`code/didCreateWorkbenchContributions/${i}`);break}case 3:case 4:{i===4&&await this.pendingRestoredContributions.p,this.doInstantiateWhenIdle(r,e,t,n,i);break}}}doInstantiateWhenIdle(e,t,n,i,r){kn(`code/willCreateWorkbenchContributions/${r}`);let s=0,a=r===4?3e3:500,l=d=>{for(;s<e.length;){let c=e[s++];if(this.safeCreateContribution(t,n,i,c,r),d.timeRemaining()<1){nl(l,a);break}}s===e.length&&(kn(`code/didCreateWorkbenchContributions/${r}`),r===3&&this.pendingRestoredContributions.complete())};nl(l,a)}safeCreateContribution(e,t,n,i,r){if(typeof i.id=="string"&&this.instancesById.has(i.id))return;let s=Date.now();try{typeof i.id=="string"&&kn(`code/willCreateWorkbenchContribution/${r}/${i.id}`);let a=e.createInstance(i.ctor);typeof i.id=="string"&&(this.instancesById.set(i.id,a),this.contributionsById.delete(i.id)),j1(a)&&this.instanceDisposables.add(a)}catch(a){t.error(`Unable to create workbench contribution '${i.id??i.ctor.name}'.`,a)}finally{typeof i.id=="string"&&kn(`code/didCreateWorkbenchContribution/${r}/${i.id}`)}if(typeof i.id=="string"||!n.isBuilt){let a=Date.now()-s;if(a>(r<3?o.BLOCK_BEFORE_RESTORE_WARN_THRESHOLD:o.BLOCK_AFTER_RESTORE_WARN_THRESHOLD)&&t.warn(`Creation of workbench contribution '${i.id??i.ctor.name}' took ${a}ms.`),typeof i.id=="string"){let l=this.timingsByPhase.get(r);l||(l=[],this.timingsByPhase.set(r,l)),l.push([i.id,a])}}}},y1t=Ec.INSTANCE.registerWorkbenchContribution2.bind(Ec.INSTANCE),I1t=Ec.INSTANCE.getWorkbenchContribution.bind(Ec.INSTANCE);et.add(tw.Workbench,Ec.INSTANCE);var tf=class{constructor(e,t,n,i){this.fileService=e;this.environmentService=t;this.lifecycleService=n;this.logService=i}async getLogs(){return TF(this.fileService,this.environmentService)}async whenWorkbenchRestored(){this.logService.info("[driver] Waiting for restored lifecycle phase..."),await this.lifecycleService.when(3),this.logService.info("[driver] Restored lifecycle phase reached. Waiting for contributions..."),await et.as(tw.Workbench).whenRestored,this.logService.info("[driver] Workbench contributions created.")}async setValue(e,t){let n=De.document.querySelector(e);if(!n)return Promise.reject(new Error(`Element not found: ${e}`));let i=n;i.value=t;let r=new Event("input",{bubbles:!0,cancelable:!0});i.dispatchEvent(r)}async isActiveElement(e){if(De.document.querySelector(e)!==De.document.activeElement){let n=[],i=De.document.activeElement;for(;i;){let r=i.tagName,s=i.id?`#${i.id}`:"",a=fr(i.className.split(/\s+/g).map(l=>l.trim())).map(l=>`.${l}`).join("");n.unshift(`${r}${s}${a}`),i=i.parentElement}throw new Error(`Active element not found. Current active element is '${n.join(" > ")}'. Looking for ${e}`)}return!0}async getElements(e,t){let n=De.document.querySelectorAll(e),i=[];for(let r=0;r<n.length;r++){let s=n.item(r);i.push(this.serializeElement(s,t))}return i}serializeElement(e,t){let n=Object.create(null);for(let a=0;a<e.attributes.length;a++){let l=e.attributes.item(a);l&&(n[l.name]=l.value)}let i=[];if(t)for(let a=0;a<e.children.length;a++){let l=e.children.item(a);l&&i.push(this.serializeElement(l,!0))}let{left:r,top:s}=im(e);return{tagName:e.tagName,className:e.className,textContent:e.textContent||"",attributes:n,children:i,left:r,top:s}}async getElementXY(e,t,n){let i=typeof t=="number"&&typeof n=="number"?{x:t,y:n}:void 0;return this._getElementXY(e,i)}async typeInEditor(e,t){let n=De.document.querySelector(e);if(!n)throw new Error(`Editor not found: ${e}`);let i=n,r=i.selectionStart,s=r+t.length,a=i.value,l=a.substr(0,r)+t+a.substr(r);i.value=l,i.setSelectionRange(s,s);let d=new Event("input",{bubbles:!0,cancelable:!0});i.dispatchEvent(d)}async getTerminalBuffer(e){let t=De.document.querySelector(e);if(!t)throw new Error(`Terminal not found: ${e}`);let n=t.xterm;if(!n)throw new Error(`Xterm not found: ${e}`);let i=[];for(let r=0;r<n.buffer.active.length;r++)i.push(n.buffer.active.getLine(r).translateToString(!0));return i}async writeInTerminal(e,t){let n=De.document.querySelector(e);if(!n)throw new Error(`Element not found: ${e}`);let i=n.xterm;if(!i)throw new Error(`Xterm not found: ${e}`);i.input(t)}getLocaleInfo(){return Promise.resolve({language:is,locale:M1})}getLocalizedStrings(){return Promise.resolve({open:ew.open,close:ew.close,find:ew.find})}async _getElementXY(e,t){let n=De.document.querySelector(e);if(!n)return Promise.reject(new Error(`Element not found: ${e}`));let{left:i,top:r}=im(n),{width:s,height:a}=bd(n),l,d;return t?(l=i+t.x,d=r+t.y):(l=i+s/2,d=r+a/2),l=Math.round(l),d=Math.round(d),{x:l,y:d}}async exitApplication(){}};tf=R([S(0,zt),S(1,Go),S(2,zs),S(3,Un)],tf);function MF(o){Object.assign(De,{driver:o.createInstance(tf)})}var qo=class extends V{constructor(t,n={getWindowsCount:wb,getWindows:tm},i,r){super();this.hostService=i;this.environmentService=r;this.enableWindowFocusOnElementFocus(t),this.enableMultiWindowAwareTimeout(t,n),this.registerFullScreenListeners(t.vscodeWindowId)}static TIMEOUT_HANDLES=Number.MIN_SAFE_INTEGER;static TIMEOUT_DISPOSABLES=new Map;enableWindowFocusOnElementFocus(t){let n=t.HTMLElement.prototype.focus,i=this;t.HTMLElement.prototype.focus=function(r){i.onElementFocus(Ie(this)),n.apply(this,[r])}}onElementFocus(t){let n=rl();n!==t&&n.document.hasFocus()&&(t.focus(),!this.environmentService.extensionTestsLocationURI&&!t.document.hasFocus()&&this.hostService.focus(t))}enableMultiWindowAwareTimeout(t,n={getWindowsCount:wb,getWindows:tm}){let i=t.setTimeout;Object.defineProperty(t,"vscodeOriginalSetTimeout",{get:()=>i});let r=t.clearTimeout;Object.defineProperty(t,"vscodeOriginalClearTimeout",{get:()=>r}),t.setTimeout=function(s,a=0,...l){if(n.getWindowsCount()===1||typeof s=="string"||a===0)return i.apply(this,[s,a,...l]);let d=new Set,c=qo.TIMEOUT_HANDLES++;qo.TIMEOUT_DISPOSABLES.set(c,d);let u=vr(s,()=>{kt(d),qo.TIMEOUT_DISPOSABLES.delete(c)});for(let{window:h,disposables:m}of n.getWindows()){if(Hw(h)&&h.document.visibilityState==="hidden")continue;let f=!1,g=h.vscodeOriginalSetTimeout.apply(this,[(...y)=>{f||u(...y)},a,...l]),b=ve(()=>{f=!0,h.vscodeOriginalClearTimeout(g),d.delete(b)});m.add(b),d.add(b)}return c},t.clearTimeout=function(s){let a=typeof s=="number"?qo.TIMEOUT_DISPOSABLES.get(s):void 0;a?(kt(a),qo.TIMEOUT_DISPOSABLES.delete(s)):r.apply(this,[s])}}registerFullScreenListeners(t){this._register(this.hostService.onDidChangeFullScreen(({windowId:n,fullscreen:i})=>{if(n===t){let r=fd(t);r&&gk(i,r.window)}}))}static async confirmOnShutdown(t,n){let i=t.get(hg),r=t.get(Et),s=n===2?Be?p("quitMessageMac","Are you sure you want to quit?"):p("quitMessage","Are you sure you want to exit?"):p("closeWindowMessage","Are you sure you want to close the window?"),a=n===2?Be?p({key:"quitButtonLabel",comment:["&& denotes a mnemonic"]},"&&Quit"):p({key:"exitButtonLabel",comment:["&& denotes a mnemonic"]},"&&Exit"):p({key:"closeWindowButtonLabel",comment:["&& denotes a mnemonic"]},"&&Close Window"),l=await i.confirm({message:s,primaryButton:a,checkbox:{label:p("doNotAskAgain","Do not ask me again")}});return l.confirmed&&l.checkboxChecked&&await r.updateValue("window.confirmBeforeClose","never"),l.confirmed}};qo=R([S(2,tp),S(3,wa)],qo);var nw=class extends qo{constructor(t,n,i,r,s,a,l,d,c){super(De,void 0,c,a);this.openerService=t;this.lifecycleService=n;this.dialogService=i;this.labelService=r;this.productService=s;this.browserEnvironmentService=a;this.layoutService=l;this.instantiationService=d;this.registerListeners(),this.create()}registerListeners(){this._register(this.lifecycleService.onWillShutdown(()=>this.onWillShutdown()));let t=Va&&De.visualViewport?De.visualViewport:De;this._register(U(t,ae.RESIZE,()=>{this.layoutService.layout(),Va&&De.scrollTo(0,0)})),this._register(U(this.layoutService.mainContainer,ae.WHEEL,n=>n.preventDefault(),{passive:!1})),this._register(U(this.layoutService.mainContainer,ae.CONTEXT_MENU,n=>$e.stop(n,!0))),this._register(U(this.layoutService.mainContainer,ae.DROP,n=>$e.stop(n,!0)))}onWillShutdown(){oe.toPromise(oe.any(oe.once(new Fe(De.document.body,ae.KEY_DOWN,!0).event),oe.once(new Fe(De.document.body,ae.MOUSE_DOWN,!0).event))).then(async()=>{await vo(3e3),await this.dialogService.prompt({type:Qn.Error,message:p("shutdownError","An unexpected error occurred that requires a reload of this page."),detail:p("shutdownErrorDetail","The workbench was unexpectedly disposed while running."),buttons:[{label:p({key:"reload",comment:["&& denotes a mnemonic"]},"&&Reload"),run:()=>De.location.reload()}]})})}create(){this.setupOpenHandlers(),this.registerLabelFormatters(),this.registerCommands(),this.setupDriver()}setupDriver(){this.environmentService.enableSmokeTestDriver&&MF(this.instantiationService)}setupOpenHandlers(){this.openerService.setDefaultExternalOpener({openExternal:async t=>{let n=!1;if(this.browserEnvironmentService.options?.openerAllowedExternalUrlPrefixes){for(let i of this.browserEnvironmentService.options.openerAllowedExternalUrlPrefixes)if(t.startsWith(i)){n=!0;break}}if(cb(t,Te.http)||cb(t,Te.https))Xi?SR(t,!n)||await this.dialogService.prompt({type:Qn.Warning,message:p("unableToOpenExternal","The browser interrupted the opening of a new tab or window. Press 'Open' to open it anyway."),detail:t,buttons:[{label:p({key:"open",comment:["&& denotes a mnemonic"]},"&&Open"),run:()=>n?tE(t):eE(t)},{label:p({key:"learnMore",comment:["&& denotes a mnemonic"]},"&&Learn More"),run:()=>this.openerService.open(ie.parse("https://aka.ms/allow-vscode-popup"))}],cancelButton:!0}):n?tE(t):eE(t);else{let i=()=>{this.lifecycleService.withExpectedShutdown({disableShutdownHandling:!0},()=>De.location.href=t)};i();let r=async()=>{let{downloadUrl:s}=this.productService,a,l=[{label:p({key:"openExternalDialogButtonRetry.v2",comment:["&& denotes a mnemonic"]},"&&Try Again"),run:()=>i()}];s!==void 0?(a=p("openExternalDialogDetail.v2",`We launched {0} on your computer.

If {1} did not launch, try again or install it below.`,this.productService.nameLong,this.productService.nameLong),l.push({label:p({key:"openExternalDialogButtonInstall.v3",comment:["&& denotes a mnemonic"]},"&&Install"),run:async()=>{await this.openerService.open(ie.parse(s)),r()}})):a=p("openExternalDialogDetailNoInstall",`We launched {0} on your computer.

If {1} did not launch, try again below.`,this.productService.nameLong,this.productService.nameLong),await this.hostService.withExpectedShutdown(()=>this.dialogService.prompt({type:Qn.Info,message:p("openExternalDialogTitle","All done. You can close this tab now."),detail:a,buttons:l,cancelButton:!0}))};cb(t,this.productService.urlProtocol)&&await r()}return!0}})}registerLabelFormatters(){this._register(this.labelService.registerFormatter({scheme:Te.vscodeUserData,priority:!0,formatting:{label:"(Settings) ${path}",separator:"/"}}))}registerCommands(){Rr.registerCommand("workbench.experimental.requestUsbDevice",async(t,n)=>vF(n)),Rr.registerCommand("workbench.experimental.requestSerialPort",async(t,n)=>yF(n)),Rr.registerCommand("workbench.experimental.requestHidDevice",async(t,n)=>IF(n))}};nw=R([S(0,Us),S(1,zs),S(2,hg),S(3,Wr),S(4,eP),S(5,SF),S(6,JS),S(7,ct),S(8,tp)],nw);var fz=Y("auxiliaryWindowService");var nf=class extends qo{constructor(t,n,i,r,s,a){super(t,void 0,s,a);this.window=t;this.container=n;this.configurationService=r;this.whenStylesHaveLoaded=i.wait().then(()=>{}),this.registerListeners()}_onWillLayout=this._register(new E);onWillLayout=this._onWillLayout.event;_onDidLayout=this._register(new E);onDidLayout=this._onDidLayout.event;_onBeforeUnload=this._register(new E);onBeforeUnload=this._onBeforeUnload.event;_onUnload=this._register(new E);onUnload=this._onUnload.event;_onWillDispose=this._register(new E);onWillDispose=this._onWillDispose.event;whenStylesHaveLoaded;registerListeners(){this._register(U(this.window,ae.BEFORE_UNLOAD,t=>this.handleBeforeUnload(t))),this._register(U(this.window,ae.UNLOAD,()=>this.handleUnload())),this._register(U(this.window,"unhandledrejection",t=>{je(t.reason),t.preventDefault()})),this._register(U(this.window,ae.RESIZE,()=>this.layout())),this._register(U(this.container,ae.SCROLL,()=>this.container.scrollTop=0)),Zi?(this._register(U(this.container,ae.DROP,t=>$e.stop(t,!0))),this._register(U(this.container,ae.WHEEL,t=>t.preventDefault(),{passive:!1})),this._register(U(this.container,ae.CONTEXT_MENU,t=>$e.stop(t,!0)))):(this._register(U(this.window.document.body,ae.DRAG_OVER,t=>$e.stop(t))),this._register(U(this.window.document.body,ae.DROP,t=>$e.stop(t))))}handleBeforeUnload(t){let n;if(this._onBeforeUnload.fire({veto(s){s&&(n=s)}}),n){this.handleVetoBeforeClose(t,n);return}let i=this.configurationService.getValue("window.confirmBeforeClose");(i==="always"||i==="keyboardOnly"&&nu.getInstance().isModifierPressed)&&this.confirmBeforeClose(t)}handleVetoBeforeClose(t,n){this.preventUnload(t)}preventUnload(t){t.preventDefault(),t.returnValue=p("lifecycleVeto","Changes that you made may not be saved. Please check press 'Cancel' and try again.")}confirmBeforeClose(t){this.preventUnload(t)}handleUnload(){this._onUnload.fire()}layout(){let t=bd(this.window.document.body,this.container);this._onWillLayout.fire(t),this._onDidLayout.fire(t)}createState(){return{bounds:{x:this.window.screenX,y:this.window.screenY,width:this.window.outerWidth,height:this.window.outerHeight},zoomLevel:pk(this.window)}}dispose(){this._store.isDisposed||(this._onWillDispose.fire(),super.dispose())}};nf=R([S(3,Et),S(4,tp),S(5,wa)],nf);var ka=class extends V{constructor(t,n,i,r,s,a){super();this.layoutService=t;this.dialogService=n;this.configurationService=i;this.telemetryService=r;this.hostService=s;this.environmentService=a}static DEFAULT_SIZE={width:800,height:600};static WINDOW_IDS=il(De)+1;_onDidOpenAuxiliaryWindow=this._register(new E);onDidOpenAuxiliaryWindow=this._onDidOpenAuxiliaryWindow.event;windows=new Map;async open(t){kn("code/auxiliaryWindow/willOpen");let n=await this.openWindow(t);if(!n)throw new Error(p("unableToOpenWindowError","Unable to open a new window."));let i=await this.resolveWindowId(n);If(n,i);let r=new he,{container:s,stylesLoaded:a}=this.createContainer(n,r,t),l=this.createAuxiliaryWindow(n,s,a),d=new he;this.windows.set(n.vscodeWindowId,l),d.add(ve(()=>this.windows.delete(n.vscodeWindowId)));let c=new he;return oe.once(l.onWillDispose)(()=>{n.close(),r.dispose(),d.dispose(),c.dispose()}),d.add(rR(n)),this._onDidOpenAuxiliaryWindow.fire({window:l,disposables:c}),kn("code/auxiliaryWindow/didOpen"),this.telemetryService.publicLog2("auxiliaryWindowOpen",{bounds:!!t?.bounds}),l}createAuxiliaryWindow(t,n,i){return new nf(t,n,i,this.configurationService,this.hostService,this.environmentService)}async openWindow(t){let n=rl(),i={x:n.screenX,y:n.screenY,width:n.outerWidth,height:n.outerHeight},r=Math.max(t?.bounds?.width??ka.DEFAULT_SIZE.width,xL.WIDTH),s=Math.max(t?.bounds?.height??ka.DEFAULT_SIZE.height,xL.HEIGHT),a={x:t?.bounds?.x??Math.max(i.x+i.width/2-r/2,0),y:t?.bounds?.y??Math.max(i.y+i.height/2-s/2,0),width:r,height:s};!t?.bounds&&a.x===i.x&&a.y===i.y&&(a={...a,x:a.x+30,y:a.y+30});let l=fr(["popup=yes",`left=${a.x}`,`top=${a.y}`,`width=${a.width}`,`height=${a.height}`,t?.nativeTitlebar?"window-native-titlebar=yes":void 0,t?.disableFullscreen?"window-disable-fullscreen=yes":void 0,t?.mode===0?"window-maximized=yes":void 0,t?.mode===2?"window-fullscreen=yes":void 0]),d=De.open(_f?"":"about:blank",void 0,l.join(","));return!d&&Zi?(await this.dialogService.prompt({type:Qn.Warning,message:p("unableToOpenWindow","The browser interrupted the opening of a new window. Press 'Retry' to try again."),detail:p("unableToOpenWindowDetail","To avoid this problem in the future, please ensure to allow popups for this website."),buttons:[{label:p({key:"retry",comment:["&& denotes a mnemonic"]},"&&Retry"),run:()=>this.openWindow(t)}],cancelButton:!0})).result:d?.window}async resolveWindowId(t){return ka.WINDOW_IDS++}createContainer(t,n,i){t.document.createElement=function(){throw new Error('Not allowed to create elements in child window JavaScript context. Always use the main window so that "xyz instanceof HTMLElement" continues to work.')},this.applyMeta(t);let{stylesLoaded:r}=this.applyCSS(t,n),s=this.applyHTML(t,n);return{stylesLoaded:r,container:s}}applyMeta(t){for(let i of['meta[charset="utf-8"]','meta[http-equiv="Content-Security-Policy"]','meta[name="viewport"]','meta[name="theme-color"]']){let r=De.document.querySelector(i);if(r){let s=mR(t.document.head);if(kb(r,s),i==='meta[http-equiv="Content-Security-Policy"]'){let a=s.getAttribute("content");a&&s.setAttribute("content",a.replace(/(script-src[^\;]*)/,"script-src 'none'"))}}}let n=De.document.querySelector('link[rel="icon"]');if(n){let i=gR(t.document.head);kb(n,i)}}applyCSS(t,n){kn("code/auxiliaryWindow/willApplyCSS");let i=new Map,r=new Qc;r.wait().then(()=>kn("code/auxiliaryWindow/didLoadCSSStyles"));let s=n.add(new he),a=0;function l(){--a===0&&(s.dispose(),r.open())}function d(c){if(uR(c))return;let u=t.document.head.appendChild(c.cloneNode(!0));c.tagName.toLowerCase()==="link"&&(a++,s.add(U(u,"load",l)),s.add(U(u,"error",l))),i.set(c,u)}a++;try{for(let c of De.document.head.querySelectorAll('link[rel="stylesheet"], style'))d(c)}finally{l()}return n.add(hR(t)),n.add(Tb.observe(De.document.head,n,{childList:!0,subtree:!0})(c=>{for(let u of c)if(!(u.type!=="childList"||u.target.nodeName.toLowerCase()==="title"||u.target.nodeName.toLowerCase()==="script"||u.target.nodeName.toLowerCase()==="meta")){for(let h of u.addedNodes)if(yn(h)&&(h.tagName.toLowerCase()==="style"||h.tagName.toLowerCase()==="link"))d(h);else if(h.nodeType===Node.TEXT_NODE&&h.parentNode){let m=i.get(h.parentNode);m&&(m.textContent=h.textContent)}for(let h of u.removedNodes){let m=i.get(h);m&&(m.parentNode?.removeChild(m),i.delete(h))}}})),kn("code/auxiliaryWindow/didApplyCSS"),{stylesLoaded:r}}applyHTML(t,n){kn("code/auxiliaryWindow/willApplyHTML");let i=document.createElement("div");return i.setAttribute("role","application"),lR(i,0,0,0,0,"relative"),i.style.display="flex",i.style.height="100%",i.style.flexDirection="column",t.document.body.append(i),n.add(Rb(De.document.documentElement,t.document.documentElement)),n.add(Rb(De.document.body,t.document.body)),n.add(Rb(this.layoutService.mainContainer,i,["class"])),kn("code/auxiliaryWindow/didApplyHTML"),i}getWindow(t){return this.windows.get(t)}};ka=R([S(0,JS),S(1,hg),S(2,Et),S(3,Hn),S(4,tp),S(5,wa)],ka);fi(fz,ka,1);var H0=new Ii(220,70),U0=new Ii(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY);var iw=class o extends XS{constructor(t,n,i,r,s){super(t,i,r,s);this.group=n}onDidChangeSizeConstraints=oe.None;_onDidChangeControl=this._register(new E);onDidChangeControl=this._onDidChangeControl.event;static EDITOR_MEMENTOS=new Map;get minimumWidth(){return H0.width}get maximumWidth(){return U0.width}get minimumHeight(){return H0.height}get maximumHeight(){return U0.height}_input;get input(){return this._input}_options;get options(){return this._options}get window(){return fd(this.group.windowId,!0).window}get scopedContextKeyService(){}create(t){super.create(t),this.createEditor(t)}async setInput(t,n,i,r){this._input=t,this._options=n}clearInput(){this._input=void 0,this._options=void 0}setOptions(t){this._options=t}setVisible(t){super.setVisible(t),this.setEditorVisible(t)}setEditorVisible(t){}setBoundarySashes(t){}getEditorMemento(t,n,i,r=10){let s=`${this.getId()}${i}`,a=o.EDITOR_MEMENTOS.get(s);return a||(a=this._register(new z0(this.getId(),i,this.getMemento(1,1),r,t,n)),o.EDITOR_MEMENTOS.set(s,a)),a}getViewState(){}saveState(){for(let[,t]of o.EDITOR_MEMENTOS)t.id===this.getId()&&t.saveState();super.saveState()}dispose(){this._input=void 0,this._options=void 0,super.dispose()}},z0=class o extends V{constructor(t,n,i,r,s,a){super();this.id=t;this.key=n;this.memento=i;this.limit=r;this.editorGroupService=s;this.configurationService=a;this.updateConfiguration(void 0),this.registerListeners()}static SHARED_EDITOR_STATE=-1;cache;cleanedUp=!1;editorDisposables;shareEditorState=!1;registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(t=>this.updateConfiguration(t)))}updateConfiguration(t){(!t||t.affectsConfiguration(void 0,"workbench.editor.sharedViewState"))&&(this.shareEditorState=this.configurationService.getValue(void 0,"workbench.editor.sharedViewState")===!0)}saveEditorState(t,n,i){let r=this.doGetResource(n);if(!r||!t)return;let s=this.doLoad(),a=s.get(r.toString());a||(a=Object.create(null),s.set(r.toString(),a)),a[t.id]=i,this.shareEditorState&&(a[o.SHARED_EDITOR_STATE]=i),ti(n)&&this.clearEditorStateOnDispose(r,n)}loadEditorState(t,n){let i=this.doGetResource(n);if(!i||!t)return;let s=this.doLoad().get(i.toString());if(s){let a=s[t.id];if(a)return a;if(this.shareEditorState)return s[o.SHARED_EDITOR_STATE]}}clearEditorState(t,n){ti(t)&&this.editorDisposables?.delete(t);let i=this.doGetResource(t);if(i){let r=this.doLoad();if(n){let s=r.get(i.toString());s&&(delete s[n.id],md(s)&&r.delete(i.toString()))}else r.delete(i.toString())}}clearEditorStateOnDispose(t,n){this.editorDisposables||(this.editorDisposables=new Map),this.editorDisposables.has(n)||this.editorDisposables.set(n,oe.once(n.onWillDispose)(()=>{this.clearEditorState(t),this.editorDisposables?.delete(n)}))}moveEditorState(t,n,i){let r=this.doLoad(),s=[...r.keys()];for(let a of s){let l=ie.parse(a);if(!i.isEqualOrParent(l,t))continue;let d;if(Yn(t,l))d=n;else{let u=Pk(l.path,t.path);d=ht(n,l.path.substr(u+t.path.length+1))}let c=r.get(a,0);c&&(r.delete(a),r.set(d.toString(),c))}}doGetResource(t){return ti(t)?t.resource:t}doLoad(){if(!this.cache){this.cache=new fo(this.limit);let t=this.memento[this.key];Array.isArray(t)&&this.cache.fromJSON(t)}return this.cache}saveState(){let t=this.doLoad();this.cleanedUp||(this.cleanUp(),this.cleanedUp=!0),this.memento[this.key]=t.toJSON()}cleanUp(){let t=this.doLoad(),n=[...t.entries()];for(let[i,r]of n)for(let s of Object.keys(r)){let a=Number(s);a===o.SHARED_EDITOR_STATE&&this.shareEditorState||this.editorGroupService.getGroup(a)||(delete r[a],md(r)&&t.delete(i))}}};var AF=class o{constructor(e,t,n){this.ctor=e;this.typeId=t;this.name=n}static instantiatedEditorPanes=new Set;static didInstantiateEditorPane(e){return o.instantiatedEditorPanes.has(e)}static _onWillInstantiateEditorPane=new E;static onWillInstantiateEditorPane=o._onWillInstantiateEditorPane.event;static create(e,t,n){return new o(e,t,n)}instantiate(e,t){o._onWillInstantiateEditorPane.fire({typeId:this.typeId});let n=e.createInstance(this.ctor,t);return o.instantiatedEditorPanes.add(this.typeId),n}describes(e){return e.getId()===this.typeId}},K0=class{mapEditorPanesToEditors=new Map;registerEditorPane(e,t){return this.mapEditorPanesToEditors.set(e,t),ve(()=>{this.mapEditorPanesToEditors.delete(e)})}getEditorPane(e){let t=this.findEditorPaneDescriptors(e);if(t.length!==0)return t.length===1?t[0]:e.prefersEditorPane(t)}findEditorPaneDescriptors(e,t){let n=[];for(let i of this.mapEditorPanesToEditors.keys()){let r=this.mapEditorPanesToEditors.get(i)||[];for(let s of r){let a=s.ctor;if(!t&&e.constructor===a){n.push(i);break}else if(t&&e instanceof a){n.push(i);break}}}return!t&&n.length===0?this.findEditorPaneDescriptors(e,!0):n}getEditorPaneByType(e){return bo.find(this.mapEditorPanesToEditors.keys(),t=>t.typeId===e)}getEditorPanes(){return Array.from(this.mapEditorPanesToEditors.keys())}getEditors(){let e=[];for(let t of this.mapEditorPanesToEditors.keys()){let n=this.mapEditorPanesToEditors.get(t);n&&e.push(...n.map(i=>i.ctor))}return e}};et.add(Zd.EditorPane,new K0);function ow(o,e,t,n){let i=o.getAriaLabel();return t&&!t.isPinned(o)&&(i=p("preview","{0}, preview",i)),t?.isSticky(e??o)&&(i=p("pinned","{0}, pinned",i)),t&&typeof n=="number"&&n>1&&(i=`${i}, ${t.ariaLabel}`),i}var np=class extends iw{constructor(t,n,i,r,s,a,l,d,c,u){super(t,n,r,d,a);this.instantiationService=s;this.textResourceConfigurationService=l;this.editorService=c;this.editorGroupService=u;this.viewState=this.getEditorMemento(u,l,i,100)}viewState;groupListener=this._register(new Zt);editorViewStateDisposables;setEditorVisible(t){this.groupListener.value=this.group.onWillCloseEditor(n=>this.onWillCloseEditor(n)),super.setEditorVisible(t)}onWillCloseEditor(t){let n=t.editor;n===this.input&&this.updateEditorViewState(n)}clearInput(){this.updateEditorViewState(this.input),super.clearInput()}saveState(){this.updateEditorViewState(this.input),super.saveState()}updateEditorViewState(t){if(!t||!this.tracksEditorViewState(t))return;let n=this.toEditorViewStateResource(t);n&&(this.tracksDisposedEditorViewState()||(this.editorViewStateDisposables||(this.editorViewStateDisposables=new Map),this.editorViewStateDisposables.has(t)||this.editorViewStateDisposables.set(t,oe.once(t.onWillDispose)(()=>{this.clearEditorViewState(n,this.group),this.editorViewStateDisposables?.delete(t)}))),t.isDisposed()&&!this.tracksDisposedEditorViewState()||!this.shouldRestoreEditorViewState(t)&&!this.group.contains(t)?this.clearEditorViewState(n,this.group):t.isDisposed()||this.saveEditorViewState(n))}shouldRestoreEditorViewState(t,n){return n?.newInGroup?this.textResourceConfigurationService.getValue(Ia.getOriginalUri(t,{supportSideBySide:1}),"workbench.editor.restoreViewState")!==!1:!0}getViewState(){let t=this.input;if(!t||!this.tracksEditorViewState(t))return;let n=this.toEditorViewStateResource(t);if(n)return this.computeEditorViewState(n)}saveEditorViewState(t){let n=this.computeEditorViewState(t);n&&this.viewState.saveEditorState(this.group,t,n)}loadEditorViewState(t,n){if(!t||!this.tracksEditorViewState(t)||!this.shouldRestoreEditorViewState(t,n))return;let i=this.toEditorViewStateResource(t);if(i)return this.viewState.loadEditorState(this.group,i)}moveEditorViewState(t,n,i){return this.viewState.moveEditorState(t,n,i)}clearEditorViewState(t,n){this.viewState.clearEditorState(t,n)}dispose(){if(super.dispose(),this.editorViewStateDisposables){for(let[,t]of this.editorViewStateDisposables)t.dispose();this.editorViewStateDisposables=void 0}}tracksDisposedEditorViewState(){return!1}};np=R([S(3,Hn),S(4,ct),S(5,zn),S(6,Kn),S(7,bi),S(8,gn),S(9,Sa)],np);var zl=class extends np{constructor(t,n,i,r,s,a,l,d,c,u){super(t,n,zl.VIEW_STATE_PREFERENCE_KEY,i,r,s,a,l,d,c);this.fileService=u;this._register(this.textResourceConfigurationService.onDidChangeConfiguration(h=>this.handleConfigurationChangeEvent(h))),this._register(oe.any(this.editorGroupService.onDidAddGroup,this.editorGroupService.onDidRemoveGroup)(()=>{let h=this.computeAriaLabel();this.editorContainer?.setAttribute("aria-label",h),this.updateEditorControlOptions({ariaLabel:h})})),this._register(this.fileService.onDidChangeFileSystemProviderCapabilities(h=>this.onDidChangeFileSystemProvider(h.scheme))),this._register(this.fileService.onDidChangeFileSystemProviderRegistrations(h=>this.onDidChangeFileSystemProvider(h.scheme)))}static VIEW_STATE_PREFERENCE_KEY="textEditorViewState";_onDidChangeSelection=this._register(new E);onDidChangeSelection=this._onDidChangeSelection.event;_onDidChangeScroll=this._register(new E);onDidChangeScroll=this._onDidChangeScroll.event;editorContainer;hasPendingConfigurationChange;lastAppliedEditorOptions;inputListener=this._register(new Zt);handleConfigurationChangeEvent(t){let n=this.getActiveResource();this.shouldHandleConfigurationChangeEvent(t,n)&&(this.isVisible()?this.updateEditorConfiguration(n):this.hasPendingConfigurationChange=!0)}shouldHandleConfigurationChangeEvent(t,n){return t.affectsConfiguration(n,"editor")||t.affectsConfiguration(n,"problems.visibility")}consumePendingConfigurationChangeEvent(){this.hasPendingConfigurationChange&&(this.updateEditorConfiguration(),this.hasPendingConfigurationChange=!1)}computeConfiguration(t){let n=mn(t.editor)?ou(t.editor):Object.create(null);return Object.assign(n,this.getConfigurationOverrides(t)),n.ariaLabel=this.computeAriaLabel(),n}computeAriaLabel(){return this.input?ow(this.input,void 0,this.group,this.editorGroupService.count):p("editor","Editor")}onDidChangeFileSystemProvider(t){this.input&&this.getActiveResource()?.scheme===t&&this.updateReadonly(this.input)}onDidChangeInputCapabilities(t){this.input===t&&this.updateReadonly(t)}updateReadonly(t){this.updateEditorControlOptions({...this.getReadonlyConfiguration(t.isReadonly())})}getReadonlyConfiguration(t){return{readOnly:!!t,readOnlyMessage:typeof t!="boolean"?t:void 0}}getConfigurationOverrides(t){return{overviewRulerLanes:3,lineNumbersMinChars:3,fixedOverflowWidgets:!0,...this.getReadonlyConfiguration(this.input?.isReadonly()),renderValidationDecorations:t.problems?.visibility!==!1?"on":"off"}}createEditor(t){this.editorContainer=t,this.createEditorControl(t,this.computeConfiguration(this.textResourceConfigurationService.getValue(this.getActiveResource()))),this.registerCodeEditorListeners()}registerCodeEditorListeners(){let t=this.getMainControl();t&&(this._register(t.onDidChangeModelLanguage(()=>this.updateEditorConfiguration())),this._register(t.onDidChangeModel(()=>this.updateEditorConfiguration())),this._register(t.onDidChangeCursorPosition(n=>this._onDidChangeSelection.fire({reason:this.toEditorPaneSelectionChangeReason(n)}))),this._register(t.onDidChangeModelContent(()=>this._onDidChangeSelection.fire({reason:3}))),this._register(t.onDidScrollChange(()=>this._onDidChangeScroll.fire())))}toEditorPaneSelectionChangeReason(t){switch(t.source){case"api":return 1;case"code.navigation":return 4;case"code.jump":return 5;default:return 2}}getSelection(){let t=this.getMainControl();if(t){let n=t.getSelection();if(n)return new G0(n)}}async setInput(t,n,i,r){await super.setInput(t,n,i,r),this.inputListener.value=t.onDidChangeCapabilities(()=>this.onDidChangeInputCapabilities(t)),this.updateEditorConfiguration(),Tn(this.editorContainer).setAttribute("aria-label",this.computeAriaLabel())}clearInput(){this.inputListener.clear(),super.clearInput()}getScrollPosition(){let t=this.getMainControl();if(!t)throw new Error("Control has not yet been initialized");return{scrollTop:t.getScrollTop()-t.getTopForLineNumber(1),scrollLeft:t.getScrollLeft()}}setScrollPosition(t){let n=this.getMainControl();if(!n)throw new Error("Control has not yet been initialized");n.setScrollTop(t.scrollTop),t.scrollLeft&&n.setScrollLeft(t.scrollLeft)}setEditorVisible(t){t&&this.consumePendingConfigurationChangeEvent(),super.setEditorVisible(t)}toEditorViewStateResource(t){return t.resource}updateEditorConfiguration(t=this.getActiveResource()){let n;if(t&&(n=this.textResourceConfigurationService.getValue(t)),!n)return;let i=this.computeConfiguration(n),r=i;this.lastAppliedEditorOptions&&(r=TR(this.lastAppliedEditorOptions,r)),Object.keys(r).length>0&&(this.lastAppliedEditorOptions=i,this.updateEditorControlOptions(r))}getActiveResource(){let t=this.getMainControl();if(t){let n=t.getModel();if(n)return n.uri}if(this.input)return this.input.resource}dispose(){this.lastAppliedEditorOptions=void 0,super.dispose()}};zl=R([S(2,Hn),S(3,ct),S(4,zn),S(5,Kn),S(6,bi),S(7,gn),S(8,Sa),S(9,zt)],zl);var G0=class o{constructor(e){this.textSelection=e}static TEXT_EDITOR_SELECTION_THRESHOLD=10;compare(e){if(!(e instanceof o))return 3;let t=Math.min(this.textSelection.selectionStartLineNumber,this.textSelection.positionLineNumber),n=Math.min(e.textSelection.selectionStartLineNumber,e.textSelection.positionLineNumber);return t===n?1:Math.abs(t-n)<o.TEXT_EDITOR_SELECTION_THRESHOLD?2:3}restore(e){return{...e,selection:this.textSelection,selectionRevealType:1}}log(){return`line: ${this.textSelection.startLineNumber}-${this.textSelection.endLineNumber}, col:  ${this.textSelection.startColumn}-${this.textSelection.endColumn}`}};var rw=class extends zl{editorControl=void 0;get scopedContextKeyService(){return this.editorControl?.invokeWithinContext(e=>e.get(ft))}getTitle(){return this.input?this.input.getName():p("textEditor","Text Editor")}createEditorControl(e,t){this.editorControl=this._register(this.instantiationService.createInstance(hr,e,t,this.getCodeEditorWidgetOptions()))}getCodeEditorWidgetOptions(){return Object.create(null)}updateEditorControlOptions(e){this.editorControl?.updateOptions(e)}getMainControl(){return this.editorControl}getControl(){return this.editorControl}computeEditorViewState(e){if(!this.editorControl)return;let t=this.editorControl.getModel();if(!t)return;let n=t.uri;if(n&&Yn(n,e))return this.editorControl.saveViewState()??void 0}setOptions(e){super.setOptions(e),e&&yI(e,Tn(this.editorControl),0)}focus(){super.focus(),this.editorControl?.focus()}hasFocus(){return this.editorControl?.hasTextFocus()||super.hasFocus()}setEditorVisible(e){super.setEditorVisible(e),e?this.editorControl?.onVisible():this.editorControl?.onHide()}layout(e){this.editorControl?.layout(e)}};var _c=class extends rw{constructor(e,t,n,i,r,s,a,l,d,c){super(e,t,n,i,r,s,a,d,l,c)}async setInput(e,t,n,i){await super.setInput(e,t,n,i);let r=await e.resolve();if(i.isCancellationRequested)return;if(!(r instanceof cr))throw new Error("Unable to open file as text");let s=Tn(this.editorControl),a=r.textEditorModel;if(s.setModel(a),!fg(t?.viewState)){let l=this.loadEditorViewState(e,n);l&&(t?.selection&&(l.cursorState=[]),s.restoreViewState(l))}t&&yI(t,s,1),s.updateOptions(this.getReadonlyConfiguration(r.isReadonly()))}revealLastLine(){let e=this.editorControl;if(!e)return;let t=e.getModel();if(t){let n=t.getLineCount();e.revealPosition({lineNumber:n,column:t.getLineMaxColumn(n)},0)}}clearInput(){super.clearInput(),this.editorControl?.setModel(null)}tracksEditorViewState(e){return e instanceof Kr||e instanceof zr}};_c=R([S(2,Hn),S(3,ct),S(4,zn),S(5,Kn),S(6,bi),S(7,Sa),S(8,gn),S(9,zt)],_c);var ip=class extends _c{constructor(t,n,i,r,s,a,l,d,c,u,h){super(ip.ID,t,n,i,r,s,a,d,l,h);this.modelService=c;this.languageService=u}static ID="workbench.editors.textResourceEditor";createEditorControl(t,n){super.createEditorControl(t,n);let i=this.editorControl;i&&this._register(i.onDidPaste(r=>this.onDidEditorPaste(r,i)))}onDidEditorPaste(t,n){if(this.input instanceof Kr&&this.input.hasLanguageSetExplicitly||t.range.startLineNumber!==1||t.range.startColumn!==1||n.getOption(93))return;let i=n.getModel();if(!i||!(i.getLineCount()===t.range.endLineNumber&&i.getLineMaxColumn(t.range.endLineNumber)===t.range.endColumn)||i.getLanguageId()!==sr)return;let a;if(t.languageId)a={id:t.languageId,source:"event"};else{let l=this.languageService.guessLanguageIdByFilepathOrFirstLine(i.uri,i.getLineContent(1).substr(0,1e3))??void 0;l&&(a={id:l,source:"guess"})}if(a&&a.id!==sr){this.input instanceof Kr&&a.source==="event"?this.input.setLanguageId(a.id):i.setLanguage(this.languageService.createById(a.id));let l=this.modelService.getCreationOptions(i.getLanguageId(),i.uri,i.isForSimpleWidget);i.detectIndentation(l.insertSpaces,l.tabSize)}}};ip=R([S(1,Hn),S(2,ct),S(3,zn),S(4,Kn),S(5,bi),S(6,gn),S(7,Sa),S(8,Vr),S(9,Bi),S(10,zt)],ip);var $0="workbench.panel.output",OF=new j("inOutput",!1),XNt=new j("activeLogOutput",!1),QNt=new j("activeLogOutput.levelSettable",!1),JNt=new j("activeLogOutput.level",""),ePt=new j("activeLogOutput.levelIsDefault",!1),NF=new j("outputView.scrollLock",!1),tPt=Y("outputService");var bz={OutputChannels:"workbench.contributions.outputChannels"},j0=class{channels=new Map;_onDidRegisterChannel=new E;onDidRegisterChannel=this._onDidRegisterChannel.event;_onDidRemoveChannel=new E;onDidRemoveChannel=this._onDidRemoveChannel.event;registerChannel(e){this.channels.has(e.id)||(this.channels.set(e.id,e),this._onDidRegisterChannel.fire(e.id))}getChannels(){let e=[];return this.channels.forEach(t=>e.push(t)),e}getChannel(e){return this.channels.get(e)}removeChannel(e){this.channels.delete(e),this._onDidRemoveChannel.fire(e)}};et.add(bz.OutputChannels,new j0);var nPt=new j("activeOutputChannel","");var sw=Y("contextViewService"),pr=Y("contextMenuService");var aw=class o extends V{static HEADER_SIZE=22;element;header;body;_expanded;_orientation;expandedSize=void 0;_headerVisible=!0;_collapsible=!0;_bodyRendered=!1;_minimumBodySize;_maximumBodySize;_ariaHeaderLabel;styles={dropBackground:void 0,headerBackground:void 0,headerBorder:void 0,headerForeground:void 0,leftBorder:void 0};animationTimer=void 0;_onDidChange=this._register(new E);onDidChange=this._onDidChange.event;_onDidChangeExpansionState=this._register(new E);onDidChangeExpansionState=this._onDidChangeExpansionState.event;get ariaHeaderLabel(){return this._ariaHeaderLabel}set ariaHeaderLabel(e){this._ariaHeaderLabel=e,this.header.setAttribute("aria-label",this.ariaHeaderLabel)}get draggableElement(){return this.header}get dropTargetElement(){return this.element}get dropBackground(){return this.styles.dropBackground}get minimumBodySize(){return this._minimumBodySize}set minimumBodySize(e){this._minimumBodySize=e,this._onDidChange.fire(void 0)}get maximumBodySize(){return this._maximumBodySize}set maximumBodySize(e){this._maximumBodySize=e,this._onDidChange.fire(void 0)}get headerSize(){return this.headerVisible?o.HEADER_SIZE:0}get minimumSize(){let e=this.headerSize,n=!this.headerVisible||this.isExpanded()?this.minimumBodySize:0;return e+n}get maximumSize(){let e=this.headerSize,n=!this.headerVisible||this.isExpanded()?this.maximumBodySize:0;return e+n}orthogonalSize=0;constructor(e){super(),this._expanded=typeof e.expanded>"u"?!0:!!e.expanded,this._orientation=typeof e.orientation>"u"?0:e.orientation,this._ariaHeaderLabel=p("viewSection","{0} Section",e.title),this._minimumBodySize=typeof e.minimumBodySize=="number"?e.minimumBodySize:this._orientation===1?200:120,this._maximumBodySize=typeof e.maximumBodySize=="number"?e.maximumBodySize:Number.POSITIVE_INFINITY,this.element=We(".pane")}isExpanded(){return this._expanded}setExpanded(e){return!e&&!this.collapsible||this._expanded===!!e?!1:(this.element?.classList.toggle("expanded",e),this._expanded=!!e,this.updateHeader(),e?(this._bodyRendered||(this.renderBody(this.body),this._bodyRendered=!0),typeof this.animationTimer=="number"&&Ie(this.element).clearTimeout(this.animationTimer),Ke(this.element,this.body)):this.animationTimer=Ie(this.element).setTimeout(()=>{this.body.remove()},200),this._onDidChangeExpansionState.fire(e),this._onDidChange.fire(e?this.expandedSize:void 0),!0)}get headerVisible(){return this._headerVisible}set headerVisible(e){this._headerVisible!==!!e&&(this._headerVisible=!!e,this.updateHeader(),this._onDidChange.fire(void 0))}get collapsible(){return this._collapsible}set collapsible(e){this._collapsible!==!!e&&(this._collapsible=!!e,this.updateHeader())}get orientation(){return this._orientation}set orientation(e){this._orientation!==e&&(this._orientation=e,this.element&&(this.element.classList.toggle("horizontal",this.orientation===1),this.element.classList.toggle("vertical",this.orientation===0)),this.header&&this.updateHeader())}render(){this.element.classList.toggle("expanded",this.isExpanded()),this.element.classList.toggle("horizontal",this.orientation===1),this.element.classList.toggle("vertical",this.orientation===0),this.header=We(".pane-header"),Ke(this.element,this.header),this.header.setAttribute("tabindex","0"),this.header.setAttribute("role","button"),this.header.setAttribute("aria-label",this.ariaHeaderLabel),this.renderHeader(this.header);let e=Ni(this.header);this._register(e),this._register(e.onDidFocus(()=>this.header.classList.add("focused"),null)),this._register(e.onDidBlur(()=>this.header.classList.remove("focused"),null)),this.updateHeader();let t=this._register(new he),n=this._register(new Fe(this.header,"keydown")),i=oe.map(n.event,r=>new nt(r),t);this._register(oe.filter(i,r=>r.keyCode===3||r.keyCode===10,t)(()=>this.setExpanded(!this.isExpanded()),null)),this._register(oe.filter(i,r=>r.keyCode===15,t)(()=>this.setExpanded(!1),null)),this._register(oe.filter(i,r=>r.keyCode===17,t)(()=>this.setExpanded(!0),null)),this._register(Yt.addTarget(this.header)),[ae.CLICK,at.Tap].forEach(r=>{this._register(U(this.header,r,s=>{s.defaultPrevented||this.setExpanded(!this.isExpanded())}))}),this.body=Ke(this.element,We(".pane-body")),!this._bodyRendered&&this.isExpanded()&&(this.renderBody(this.body),this._bodyRendered=!0),this.isExpanded()||this.body.remove()}layout(e){let t=this.headerVisible?o.HEADER_SIZE:0,n=this._orientation===0?this.orthogonalSize:e,i=this._orientation===0?e-t:this.orthogonalSize-t;this.isExpanded()&&(this.body.classList.toggle("wide",n>=600),this.layoutBody(i,n),this.expandedSize=e)}style(e){this.styles=e,this.header&&this.updateHeader()}updateHeader(){let e=!this.headerVisible||this.isExpanded();this.collapsible?(this.header.setAttribute("tabindex","0"),this.header.setAttribute("role","button")):(this.header.removeAttribute("tabindex"),this.header.removeAttribute("role")),this.header.style.lineHeight=`${this.headerSize}px`,this.header.classList.toggle("hidden",!this.headerVisible),this.header.classList.toggle("expanded",e),this.header.classList.toggle("not-collapsible",!this.collapsible),this.header.setAttribute("aria-expanded",String(e)),this.header.style.color=this.collapsible?this.styles.headerForeground??"":"",this.header.style.backgroundColor=(this.collapsible?this.styles.headerBackground:"transparent")??"",this.header.style.borderTop=this.styles.headerBorder&&this.orientation===0?`1px solid ${this.styles.headerBorder}`:"",this.element.style.borderLeft=this.styles.leftBorder&&this.orientation===1?`1px solid ${this.styles.leftBorder}`:""}},PF=class o extends V{constructor(t,n,i){super();this.pane=t;this.dnd=n;this.context=i;t.draggableElement.draggable=!0,this._register(U(t.draggableElement,"dragstart",r=>this.onDragStart(r))),this._register(U(t.dropTargetElement,"dragenter",r=>this.onDragEnter(r))),this._register(U(t.dropTargetElement,"dragleave",r=>this.onDragLeave(r))),this._register(U(t.dropTargetElement,"dragend",r=>this.onDragEnd(r))),this._register(U(t.dropTargetElement,"drop",r=>this.onDrop(r)))}static DefaultDragOverBackgroundColor=new N(new Ge(128,128,128,.5));dragOverCounter=0;_onDidDrop=this._register(new E);onDidDrop=this._onDidDrop.event;onDragStart(t){if(!this.dnd.canDrag(this.pane)||!t.dataTransfer){t.preventDefault(),t.stopPropagation();return}t.dataTransfer.effectAllowed="move",sn&&t.dataTransfer?.setData(Jh.TEXT,this.pane.draggableElement.textContent||"");let n=Ke(this.pane.element.ownerDocument.body,We(".monaco-drag-image",{},this.pane.draggableElement.textContent||""));t.dataTransfer.setDragImage(n,-10,-10),setTimeout(()=>n.remove(),0),this.context.draggable=this}onDragEnter(t){!this.context.draggable||this.context.draggable===this||this.dnd.canDrop(this.context.draggable.pane,this.pane)&&(this.dragOverCounter++,this.render())}onDragLeave(t){!this.context.draggable||this.context.draggable===this||this.dnd.canDrop(this.context.draggable.pane,this.pane)&&(this.dragOverCounter--,this.dragOverCounter===0&&this.render())}onDragEnd(t){this.context.draggable&&(this.dragOverCounter=0,this.render(),this.context.draggable=null)}onDrop(t){this.context.draggable&&($e.stop(t),this.dragOverCounter=0,this.render(),this.dnd.canDrop(this.context.draggable.pane,this.pane)&&this.context.draggable!==this&&this._onDidDrop.fire({from:this.context.draggable.pane,to:this.pane}),this.context.draggable=null)}render(){let t=null;this.dragOverCounter>0&&(t=this.pane.dropBackground??o.DefaultDragOverBackgroundColor.toString()),this.pane.dropTargetElement.style.backgroundColor=t||""}};var tBt=p("views log","Views"),FF=xl("default-view-icon",ge.window,p("defaultViewIcon","Default view icon.")),of;(t=>(t.ViewContainersRegistry="workbench.registry.view.containers",t.ViewsRegistry="workbench.registry.view"))(of||={});function Z0(o){switch(o){case 0:return"sidebar";case 1:return"panel";case 2:return"auxiliarybar"}}var q0=class extends V{_onDidRegister=this._register(new E);onDidRegister=this._onDidRegister.event;_onDidDeregister=this._register(new E);onDidDeregister=this._onDidDeregister.event;viewContainers=new Map;defaultViewContainers=[];get all(){return[...this.viewContainers.values()].flat()}registerViewContainer(e,t,n){let i=this.get(e.id);if(i)return i;let r=e;return r.openCommandActionDescriptor=n?.doNotRegisterOpenCommand?void 0:r.openCommandActionDescriptor??{id:r.id},_p(this.viewContainers,t,[]).push(r),n?.isDefault&&this.defaultViewContainers.push(r),this._onDidRegister.fire({viewContainer:r,viewContainerLocation:t}),r}deregisterViewContainer(e){for(let t of this.viewContainers.keys()){let n=this.viewContainers.get(t),i=n?.indexOf(e);if(i!==-1){n?.splice(i,1),n.length===0&&this.viewContainers.delete(t),this._onDidDeregister.fire({viewContainer:e,viewContainerLocation:t});return}}}get(e){return this.all.filter(t=>t.id===e)[0]}getViewContainers(e){return[...this.viewContainers.get(e)||[]]}getViewContainerLocation(e){return[...this.viewContainers.keys()].filter(t=>this.getViewContainers(t).filter(n=>n?.id===e.id).length>0)[0]}getDefaultViewContainer(e){return this.defaultViewContainers.find(t=>this.getViewContainerLocation(t)===e)}};et.add(of.ViewContainersRegistry,new q0);function vz(o,e){let t=o.group??"9_more",n=e.group??"9_more";return t!==n?t.localeCompare(n):(o.order??5)-(e.order??5)}var Y0=class extends V{_onViewsRegistered=this._register(new E);onViewsRegistered=this._onViewsRegistered.event;_onViewsDeregistered=this._register(new E);onViewsDeregistered=this._onViewsDeregistered.event;_onDidChangeContainer=this._register(new E);onDidChangeContainer=this._onDidChangeContainer.event;_onDidChangeViewWelcomeContent=this._register(new E);onDidChangeViewWelcomeContent=this._onDidChangeViewWelcomeContent.event;_viewContainers=[];_views=new Map;_viewWelcomeContents=new Fc;registerViews(e,t){this.registerViews2([{views:e,viewContainer:t}])}registerViews2(e){e.forEach(({views:t,viewContainer:n})=>this.addViews(t,n)),this._onViewsRegistered.fire(e)}deregisterViews(e,t){let n=this.removeViews(e,t);n.length&&this._onViewsDeregistered.fire({views:n,viewContainer:t})}moveViews(e,t){for(let n of this._views.keys())if(n!==t){let i=this.removeViews(e,n);i.length&&(this.addViews(i,t),this._onDidChangeContainer.fire({views:i,from:n,to:t}))}}getViews(e){return this._views.get(e)||[]}getView(e){for(let t of this._viewContainers){let n=(this._views.get(t)||[]).filter(i=>i.id===e)[0];if(n)return n}return null}getViewContainer(e){for(let t of this._viewContainers)if((this._views.get(t)||[]).filter(i=>i.id===e)[0])return t;return null}registerViewWelcomeContent(e,t){return this._viewWelcomeContents.add(e,t),this._onDidChangeViewWelcomeContent.fire(e),ve(()=>{this._viewWelcomeContents.delete(e,t),this._onDidChangeViewWelcomeContent.fire(e)})}registerViewWelcomeContent2(e,t){let n=new Map;for(let[i,r]of t)this._viewWelcomeContents.add(e,r),n.set(i,ve(()=>{this._viewWelcomeContents.delete(e,r),this._onDidChangeViewWelcomeContent.fire(e)}));return this._onDidChangeViewWelcomeContent.fire(e),n}getViewWelcomeContent(e){let t=[];return this._viewWelcomeContents.forEach(e,n=>t.push(n)),t.sort(vz)}addViews(e,t){let n=this._views.get(t);n||(n=[],this._views.set(t,n),this._viewContainers.push(t));for(let i of e){if(this.getView(i.id)!==null)throw new Error(p("duplicateId","A view with id '{0}' is already registered",i.id));n.push(i)}}removeViews(e,t){let n=this._views.get(t);if(!n)return[];let i=[],r=[];for(let s of n)e.includes(s)?i.push(s):r.push(s);return i.length&&(r.length?this._views.set(t,r):(this._views.delete(t),this._viewContainers.splice(this._viewContainers.indexOf(t),1))),i}};et.add(of.ViewsRegistry,new Y0);var rf=Y("viewDescriptorService");var yz=Y("viewsService");var X0=class extends jo{_element;boxContainer;_label;contents;visible;_onDidChangeVisibility=this._register(new E);onDidChangeVisibility=this._onDidChangeVisibility.event;hover;constructor(e,t){super(),this._element=Ke(e,We(".monaco-dropdown")),this._label=Ke(this._element,We(".dropdown-label"));let n=t.labelRenderer;n||(n=r=>(r.textContent=t.label||"",null));for(let r of[ae.CLICK,ae.MOUSE_DOWN,at.Tap])this._register(U(this.element,r,s=>$e.stop(s,!0)));for(let r of[ae.MOUSE_DOWN,at.Tap])this._register(U(this._label,r,s=>{Lb(s)&&(s.detail>1||s.button!==0)||(this.visible?this.hide():this.show())}));this._register(U(this._label,ae.KEY_UP,r=>{let s=new nt(r);(s.equals(3)||s.equals(10))&&($e.stop(r,!0),this.visible?this.hide():this.show())}));let i=n(this._label);i&&this._register(i),this._register(Yt.addTarget(this._label))}get element(){return this._element}get label(){return this._label}set tooltip(e){this._label&&(!this.hover&&e!==""?this.hover=this._register(ho().setupManagedHover(Gt("mouse"),this._label,e)):this.hover&&this.hover.update(e))}show(){this.visible||(this.visible=!0,this._onDidChangeVisibility.fire(!0))}hide(){this.visible&&(this.visible=!1,this._onDidChangeVisibility.fire(!1))}isVisible(){return!!this.visible}onEvent(e,t){this.hide()}dispose(){super.dispose(),this.hide(),this.boxContainer&&(this.boxContainer.remove(),this.boxContainer=void 0),this.contents&&(this.contents.remove(),this.contents=void 0),this._label&&(this._label.remove(),this._label=void 0)}},lw=class extends X0{constructor(t,n){super(t,n);this._options=n;this.actions=n.actions||[]}_menuOptions;_actions=[];set menuOptions(t){this._menuOptions=t}get menuOptions(){return this._menuOptions}get actions(){return this._options.actionProvider?this._options.actionProvider.getActions():this._actions}set actions(t){this._actions=t}show(){super.show(),this.element.classList.add("active"),this._options.contextMenuProvider.showContextMenu({getAnchor:()=>this.element,getActions:()=>this.actions,getActionsContext:()=>this.menuOptions?this.menuOptions.context:null,getActionViewItem:(t,n)=>this.menuOptions&&this.menuOptions.actionViewItemProvider?this.menuOptions.actionViewItemProvider(t,n):void 0,getKeyBinding:t=>this.menuOptions&&this.menuOptions.getKeyBinding?this.menuOptions.getKeyBinding(t):void 0,getMenuClassName:()=>this._options.menuClassName||"",onHide:()=>this.onHide(),actionRunner:this.menuOptions?this.menuOptions.actionRunner:void 0,anchorAlignment:this.menuOptions?this.menuOptions.anchorAlignment:0,domForShadowRoot:this._options.menuAsChild?this.element:void 0,skipTelemetry:this._options.skipTelemetry})}hide(){super.hide()}onHide(){this.hide(),this.element.classList.remove("active")}};var Kl=class extends si{menuActionsOrProvider;dropdownMenu;contextMenuProvider;actionItem=null;_onDidChangeVisibility=this._register(new E);onDidChangeVisibility=this._onDidChangeVisibility.event;options;constructor(e,t,n,i=Object.create(null)){super(null,e,i),this.menuActionsOrProvider=t,this.contextMenuProvider=n,this.options=i,this.options.actionRunner&&(this.actionRunner=this.options.actionRunner)}render(e){this.actionItem=e;let t=r=>{this.element=Ke(r,We("a.action-label"));let s=[];return typeof this.options.classNames=="string"?s=this.options.classNames.split(/\s+/g).filter(a=>!!a):this.options.classNames&&(s=this.options.classNames),s.find(a=>a==="icon")||s.push("codicon"),this.element.classList.add(...s),this.element.setAttribute("role","button"),this.element.setAttribute("aria-haspopup","true"),this.element.setAttribute("aria-expanded","false"),this._action.label&&this._register(ho().setupManagedHover(this.options.hoverDelegate??Gt("mouse"),this.element,this._action.label)),this.element.ariaLabel=this._action.label||"",null},n=Array.isArray(this.menuActionsOrProvider),i={contextMenuProvider:this.contextMenuProvider,labelRenderer:t,menuAsChild:this.options.menuAsChild,actions:n?this.menuActionsOrProvider:void 0,actionProvider:n?void 0:this.menuActionsOrProvider,skipTelemetry:this.options.skipTelemetry};if(this.dropdownMenu=this._register(new lw(e,i)),this._register(this.dropdownMenu.onDidChangeVisibility(r=>{this.element?.setAttribute("aria-expanded",`${r}`),this._onDidChangeVisibility.fire(r)})),this.dropdownMenu.menuOptions={actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,getKeyBinding:this.options.keybindingProvider,context:this._context},this.options.anchorAlignmentProvider){let r=this;this.dropdownMenu.menuOptions={...this.dropdownMenu.menuOptions,get anchorAlignment(){return r.options.anchorAlignmentProvider()}}}this.updateTooltip(),this.updateEnabled()}getTooltip(){let e=null;return this.action.tooltip?e=this.action.tooltip:this.action.label&&(e=this.action.label),e??void 0}setActionContext(e){super.setActionContext(e),this.dropdownMenu&&(this.dropdownMenu.menuOptions?this.dropdownMenu.menuOptions.context=e:this.dropdownMenu.menuOptions={context:e})}show(){this.dropdownMenu?.show()}updateEnabled(){let e=!this.action.enabled;this.actionItem?.classList.toggle("disabled",e),this.element?.classList.toggle("disabled",e)}};var op=class{modifierLabels;constructor(e,t,n=t){this.modifierLabels=[null],this.modifierLabels[2]=e,this.modifierLabels[1]=t,this.modifierLabels[3]=n}toLabel(e,t,n){if(t.length===0)return null;let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r],l=n(a);if(l===null)return null;i[r]=Sz(a,l,this.modifierLabels[e])}return i.join(" ")}},Q0=new op({ctrlKey:"\u2303",shiftKey:"\u21E7",altKey:"\u2325",metaKey:"\u2318",separator:""},{ctrlKey:p({key:"ctrlKey",comment:["This is the short form for the Control key on the keyboard"]},"Ctrl"),shiftKey:p({key:"shiftKey",comment:["This is the short form for the Shift key on the keyboard"]},"Shift"),altKey:p({key:"altKey",comment:["This is the short form for the Alt key on the keyboard"]},"Alt"),metaKey:p({key:"windowsKey",comment:["This is the short form for the Windows key on the keyboard"]},"Windows"),separator:"+"},{ctrlKey:p({key:"ctrlKey",comment:["This is the short form for the Control key on the keyboard"]},"Ctrl"),shiftKey:p({key:"shiftKey",comment:["This is the short form for the Shift key on the keyboard"]},"Shift"),altKey:p({key:"altKey",comment:["This is the short form for the Alt key on the keyboard"]},"Alt"),metaKey:p({key:"superKey",comment:["This is the short form for the Super key on the keyboard"]},"Super"),separator:"+"}),nVt=new op({ctrlKey:p({key:"ctrlKey.long",comment:["This is the long form for the Control key on the keyboard"]},"Control"),shiftKey:p({key:"shiftKey.long",comment:["This is the long form for the Shift key on the keyboard"]},"Shift"),altKey:p({key:"optKey.long",comment:["This is the long form for the Alt/Option key on the keyboard"]},"Option"),metaKey:p({key:"cmdKey.long",comment:["This is the long form for the Command key on the keyboard"]},"Command"),separator:"+"},{ctrlKey:p({key:"ctrlKey.long",comment:["This is the long form for the Control key on the keyboard"]},"Control"),shiftKey:p({key:"shiftKey.long",comment:["This is the long form for the Shift key on the keyboard"]},"Shift"),altKey:p({key:"altKey.long",comment:["This is the long form for the Alt key on the keyboard"]},"Alt"),metaKey:p({key:"windowsKey.long",comment:["This is the long form for the Windows key on the keyboard"]},"Windows"),separator:"+"},{ctrlKey:p({key:"ctrlKey.long",comment:["This is the long form for the Control key on the keyboard"]},"Control"),shiftKey:p({key:"shiftKey.long",comment:["This is the long form for the Shift key on the keyboard"]},"Shift"),altKey:p({key:"altKey.long",comment:["This is the long form for the Alt key on the keyboard"]},"Alt"),metaKey:p({key:"superKey.long",comment:["This is the long form for the Super key on the keyboard"]},"Super"),separator:"+"}),iVt=new op({ctrlKey:"Ctrl",shiftKey:"Shift",altKey:"Alt",metaKey:"Cmd",separator:"+"},{ctrlKey:"Ctrl",shiftKey:"Shift",altKey:"Alt",metaKey:"Super",separator:"+"}),oVt=new op({ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"cmd",separator:"+"},{ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"win",separator:"+"},{ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"meta",separator:"+"});function Sz(o,e,t){if(e===null)return"";let n=[];return o.ctrlKey&&n.push(t.ctrlKey),o.shiftKey&&n.push(t.shiftKey),o.altKey&&n.push(t.altKey),o.metaKey&&n.push(t.metaKey),e!==""&&n.push(e),n.join(t.separator)}var WVt={buttonBackground:"#0E639C",buttonHoverBackground:"#006BB3",buttonSeparator:N.white.toString(),buttonForeground:N.white.toString(),buttonBorder:void 0,buttonSecondaryBackground:void 0,buttonSecondaryForeground:void 0,buttonSecondaryHoverBackground:void 0},sf=class extends V{options;_element;_label="";_labelElement;_labelShortElement;_hover;_onDidClick=this._register(new E);get onDidClick(){return this._onDidClick.event}_onDidEscape=this._register(new E);get onDidEscape(){return this._onDidEscape.event}focusTracker;constructor(e,t){super(),this.options=t,this._element=document.createElement("a"),this._element.classList.add("monaco-button"),this._element.tabIndex=0,this._element.setAttribute("role","button"),this._element.classList.toggle("secondary",!!t.secondary);let n=t.secondary?t.buttonSecondaryBackground:t.buttonBackground,i=t.secondary?t.buttonSecondaryForeground:t.buttonForeground;this._element.style.color=i||"",this._element.style.backgroundColor=n||"",t.supportShortLabel&&(this._labelShortElement=document.createElement("div"),this._labelShortElement.classList.add("monaco-button-label-short"),this._element.appendChild(this._labelShortElement),this._labelElement=document.createElement("div"),this._labelElement.classList.add("monaco-button-label"),this._element.appendChild(this._labelElement),this._element.classList.add("monaco-text-button-with-short-label")),typeof t.title=="string"&&this.setTitle(t.title),typeof t.ariaLabel=="string"&&this._element.setAttribute("aria-label",t.ariaLabel),e.appendChild(this._element),this._register(Yt.addTarget(this._element)),[ae.CLICK,at.Tap].forEach(r=>{this._register(U(this._element,r,s=>{if(!this.enabled){$e.stop(s);return}this._onDidClick.fire(s)}))}),this._register(U(this._element,ae.KEY_DOWN,r=>{let s=new nt(r),a=!1;this.enabled&&(s.equals(3)||s.equals(10))?(this._onDidClick.fire(r),a=!0):s.equals(9)&&(this._onDidEscape.fire(r),this._element.blur(),a=!0),a&&$e.stop(s,!0)})),this._register(U(this._element,ae.MOUSE_OVER,r=>{this._element.classList.contains("disabled")||this.updateBackground(!0)})),this._register(U(this._element,ae.MOUSE_OUT,r=>{this.updateBackground(!1)})),this.focusTracker=this._register(Ni(this._element)),this._register(this.focusTracker.onDidFocus(()=>{this.enabled&&this.updateBackground(!0)})),this._register(this.focusTracker.onDidBlur(()=>{this.enabled&&this.updateBackground(!1)}))}dispose(){super.dispose(),this._element.remove()}getContentElements(e){let t=[];for(let n of KS(e))if(typeof n=="string"){if(n=n.trim(),n==="")continue;let i=document.createElement("span");i.textContent=n,t.push(i)}else t.push(n);return t}updateBackground(e){let t;this.options.secondary?t=e?this.options.buttonSecondaryHoverBackground:this.options.buttonSecondaryBackground:t=e?this.options.buttonHoverBackground:this.options.buttonBackground,t&&(this._element.style.backgroundColor=t)}get element(){return this._element}set label(e){if(this._label===e||Vb(this._label)&&Vb(e)&&GR(this._label,e))return;this._element.classList.add("monaco-text-button");let t=this.options.supportShortLabel?this._labelElement:this._element;if(Vb(e)){let i=jS(e,{inline:!0});i.dispose();let r=i.element.querySelector("p")?.innerHTML;if(r){let s=Qp(r,{ADD_TAGS:["b","i","u","code","span"],ALLOWED_ATTR:["class"],RETURN_TRUSTED_TYPE:!0});t.innerHTML=s}else oa(t)}else this.options.supportIcons?oa(t,...this.getContentElements(e)):t.textContent=e;let n="";typeof this.options.title=="string"?n=this.options.title:this.options.title&&(n=hF(e)),this.setTitle(n),typeof this.options.ariaLabel=="string"?this._element.setAttribute("aria-label",this.options.ariaLabel):this.options.ariaLabel&&this._element.setAttribute("aria-label",n),this._label=e}get label(){return this._label}set labelShort(e){!this.options.supportShortLabel||!this._labelShortElement||(this.options.supportIcons?oa(this._labelShortElement,...this.getContentElements(e)):this._labelShortElement.textContent=e)}set icon(e){this._element.classList.add(...Je.asClassNameArray(e))}set enabled(e){e?(this._element.classList.remove("disabled"),this._element.setAttribute("aria-disabled",String(!1)),this._element.tabIndex=0):(this._element.classList.add("disabled"),this._element.setAttribute("aria-disabled",String(!0)))}get enabled(){return!this._element.classList.contains("disabled")}set checked(e){e?(this._element.classList.add("checked"),this._element.setAttribute("aria-checked","true")):(this._element.classList.remove("checked"),this._element.setAttribute("aria-checked","false"))}get checked(){return this._element.classList.contains("checked")}setTitle(e){!this._hover&&e!==""?this._hover=this._register(ho().setupManagedHover(this.options.hoverDelegate??Gt("mouse"),this._element,e)):this._hover&&this._hover.update(e)}focus(){this._element.focus()}hasFocus(){return er(this._element)}};var wz=()=>({msLoopTime:-1,msDelayTime:-1,dispose:()=>{}}),xz=wz;function VF(o,e){return xz(o,e)}var J0="done",e1="active",dw="infinite",cw="infinite-long-running",t1="discrete";var uw=class o extends V{static LONG_RUNNING_INFINITE_THRESHOLD=1e4;static PROGRESS_SIGNAL_DEFAULT_DELAY=3e3;workedVal;element;bit;totalWork;showDelayedScheduler;longRunningScheduler;progressSignal=this._register(new Zt);constructor(e,t){super(),this.workedVal=0,this.showDelayedScheduler=this._register(new Qt(()=>om(this.element),0)),this.longRunningScheduler=this._register(new Qt(()=>this.infiniteLongRunning(),o.LONG_RUNNING_INFINITE_THRESHOLD)),this.create(e,t)}create(e,t){this.element=document.createElement("div"),this.element.classList.add("monaco-progress-container"),this.element.setAttribute("role","progressbar"),this.element.setAttribute("aria-valuemin","0"),e.appendChild(this.element),this.bit=document.createElement("div"),this.bit.classList.add("progress-bit"),this.bit.style.backgroundColor=t?.progressBarBackground||"#0E70C0",this.element.appendChild(this.bit)}off(){this.bit.style.width="inherit",this.bit.style.opacity="1",this.element.classList.remove(e1,dw,cw,t1),this.workedVal=0,this.totalWork=void 0,this.longRunningScheduler.cancel(),this.progressSignal.clear()}done(){return this.doDone(!0)}stop(){return this.doDone(!1)}doDone(e){return this.element.classList.add(J0),this.element.classList.contains(dw)?(this.bit.style.opacity="0",e?setTimeout(()=>this.off(),200):this.off()):(this.bit.style.width="inherit",e?setTimeout(()=>this.off(),200):this.off()),this}infinite(){return this.bit.style.width="2%",this.bit.style.opacity="1",this.element.classList.remove(t1,J0,cw),this.element.classList.add(e1,dw),this.longRunningScheduler.schedule(),this}infiniteLongRunning(){this.element.classList.add(cw)}total(e){return this.workedVal=0,this.totalWork=e,this.element.setAttribute("aria-valuemax",e.toString()),this}hasTotal(){return yi(this.totalWork)}worked(e){return e=Math.max(1,Number(e)),this.doSetWorked(this.workedVal+e)}setWorked(e){return e=Math.max(1,Number(e)),this.doSetWorked(e)}doSetWorked(e){let t=this.totalWork||100;return this.workedVal=e,this.workedVal=Math.min(t,this.workedVal),this.element.classList.remove(dw,cw,J0),this.element.classList.add(e1,t1),this.element.setAttribute("aria-valuenow",e.toString()),this.bit.style.width=100*(this.workedVal/t)+"%",this}getContainer(){return this.element}show(e){this.showDelayedScheduler.cancel(),this.progressSignal.value=VF(o.PROGRESS_SIGNAL_DEFAULT_DELAY),typeof e=="number"?this.showDelayedScheduler.schedule(e):om(this.element)}hide(){Db(this.element),this.showDelayedScheduler.cancel(),this.progressSignal.clear()}};var hw=class{constructor(e,t=0,n=e.length,i=t-1){this.items=e;this.start=t;this.end=n;this.index=i}current(){return this.index===this.start-1||this.index===this.end?null:this.items[this.index]}next(){return this.index=Math.min(this.index+1,this.end),this.current()}previous(){return this.index=Math.max(this.index-1,this.start-1),this.current()}first(){return this.index=this.start,this.current()}last(){return this.index=this.end-1,this.current()}};var pw=class{_history;_limit;_navigator;constructor(e=[],t=10){this._initialize(e),this._limit=t,this._onChange()}getHistory(){return this._elements}add(e){this._history.delete(e),this._history.add(e),this._onChange()}next(){return this._navigator.next()}previous(){return this._currentPosition()!==0?this._navigator.previous():null}current(){return this._navigator.current()}first(){return this._navigator.first()}last(){return this._navigator.last()}isFirst(){return this._currentPosition()===0}isLast(){return this._currentPosition()>=this._elements.length-1}isNowhere(){return this._navigator.current()===null}has(e){return this._history.has(e)}clear(){this._initialize([]),this._onChange()}_onChange(){this._reduceToLimit();let e=this._elements;this._navigator=new hw(e,0,e.length,e.length)}_reduceToLimit(){let e=this._elements;e.length>this._limit&&this._initialize(e.slice(e.length-this._limit))}_currentPosition(){let e=this._navigator.current();return e?this._elements.indexOf(e):-1}_initialize(e){this._history=new Set;for(let t of e)this._history.add(t)}get _elements(){let e=[];return this._history.forEach(t=>e.push(t)),e}};var af=We;var mw=class extends On{contextViewProvider;element;input;actionbar;options;message;placeholder;tooltip;ariaLabel;validation;state="idle";mirror;cachedHeight;cachedContentHeight;maxHeight=Number.POSITIVE_INFINITY;scrollableElement;hover;_onDidChange=this._register(new E);onDidChange=this._onDidChange.event;_onDidHeightChange=this._register(new E);onDidHeightChange=this._onDidHeightChange.event;constructor(e,t,n){super(),this.contextViewProvider=t,this.options=n,this.message=null,this.placeholder=this.options.placeholder||"",this.tooltip=this.options.tooltip??(this.placeholder||""),this.ariaLabel=this.options.ariaLabel||"",this.options.validationOptions&&(this.validation=this.options.validationOptions.validation),this.element=Ke(e,af(".monaco-inputbox.idle"));let i=this.options.flexibleHeight?"textarea":"input",r=Ke(this.element,af(".ibwrapper"));if(this.input=Ke(r,af(i+".input.empty")),this.input.setAttribute("autocorrect","off"),this.input.setAttribute("autocapitalize","off"),this.input.setAttribute("spellcheck","false"),this.onfocus(this.input,()=>this.element.classList.add("synthetic-focus")),this.onblur(this.input,()=>this.element.classList.remove("synthetic-focus")),this.options.flexibleHeight){this.maxHeight=typeof this.options.flexibleMaxHeight=="number"?this.options.flexibleMaxHeight:Number.POSITIVE_INFINITY,this.mirror=Ke(r,af("div.mirror")),this.mirror.innerText="\xA0",this.scrollableElement=new pC(this.element,{vertical:1}),this.options.flexibleWidth&&(this.input.setAttribute("wrap","off"),this.mirror.style.whiteSpace="pre",this.mirror.style.wordWrap="initial"),Ke(e,this.scrollableElement.getDomNode()),this._register(this.scrollableElement),this._register(this.scrollableElement.onScroll(l=>this.input.scrollTop=l.scrollTop));let s=this._register(new Fe(e.ownerDocument,"selectionchange")),a=oe.filter(s.event,()=>e.ownerDocument.getSelection()?.anchorNode===r);this._register(a(this.updateScrollDimensions,this)),this._register(this.onDidHeightChange(this.updateScrollDimensions,this))}else this.input.type=this.options.type||"text",this.input.setAttribute("wrap","off");this.ariaLabel&&this.input.setAttribute("aria-label",this.ariaLabel),this.placeholder&&!this.options.showPlaceholderOnFocus&&this.setPlaceHolder(this.placeholder),this.tooltip&&this.setTooltip(this.tooltip),this.oninput(this.input,()=>this.onValueChange()),this.onblur(this.input,()=>this.onBlur()),this.onfocus(this.input,()=>this.onFocus()),this._register(this.ignoreGesture(this.input)),setTimeout(()=>this.updateMirror(),0),this.options.actions&&(this.actionbar=this._register(new Da(this.element)),this.actionbar.push(this.options.actions,{icon:!0,label:!1})),this.applyStyles()}onBlur(){this._hideMessage(),this.options.showPlaceholderOnFocus&&this.input.setAttribute("placeholder","")}onFocus(){this._showMessage(),this.options.showPlaceholderOnFocus&&this.input.setAttribute("placeholder",this.placeholder||"")}setPlaceHolder(e){this.placeholder=e,this.input.setAttribute("placeholder",e)}setTooltip(e){this.tooltip=e,this.hover?this.hover.update(e):this.hover=this._register(ho().setupManagedHover(Gt("mouse"),this.input,e))}setAriaLabel(e){this.ariaLabel=e,e?this.input.setAttribute("aria-label",this.ariaLabel):this.input.removeAttribute("aria-label")}getAriaLabel(){return this.ariaLabel}get mirrorElement(){return this.mirror}get inputElement(){return this.input}get value(){return this.input.value}set value(e){this.input.value!==e&&(this.input.value=e,this.onValueChange())}get step(){return this.input.step}set step(e){this.input.step=e}get height(){return typeof this.cachedHeight=="number"?this.cachedHeight:Eb(this.element)}focus(){this.input.focus()}blur(){this.input.blur()}hasFocus(){return er(this.input)}select(e=null){this.input.select(),e&&(this.input.setSelectionRange(e.start,e.end),e.end===this.input.value.length&&(this.input.scrollLeft=this.input.scrollWidth))}isSelectionAtEnd(){return this.input.selectionEnd===this.input.value.length&&this.input.selectionStart===this.input.selectionEnd}getSelection(){let e=this.input.selectionStart;if(e===null)return null;let t=this.input.selectionEnd??e;return{start:e,end:t}}enable(){this.input.removeAttribute("disabled")}disable(){this.blur(),this.input.disabled=!0,this._hideMessage()}setEnabled(e){e?this.enable():this.disable()}get width(){return iu(this.input)}set width(e){if(this.options.flexibleHeight&&this.options.flexibleWidth){let t=0;if(this.mirror){let n=parseFloat(this.mirror.style.paddingLeft||"")||0,i=parseFloat(this.mirror.style.paddingRight||"")||0;t=n+i}this.input.style.width=e-t+"px"}else this.input.style.width=e+"px";this.mirror&&(this.mirror.style.width=e+"px")}set paddingRight(e){this.input.style.width=`calc(100% - ${e}px)`,this.mirror&&(this.mirror.style.paddingRight=e+"px")}updateScrollDimensions(){if(typeof this.cachedContentHeight!="number"||typeof this.cachedHeight!="number"||!this.scrollableElement)return;let e=this.cachedContentHeight,t=this.cachedHeight,n=this.input.scrollTop;this.scrollableElement.setScrollDimensions({scrollHeight:e,height:t}),this.scrollableElement.setScrollPosition({scrollTop:n})}showMessage(e,t){if(this.state==="open"&&Zn(this.message,e))return;this.message=e,this.element.classList.remove("idle"),this.element.classList.remove("info"),this.element.classList.remove("warning"),this.element.classList.remove("error"),this.element.classList.add(this.classForType(e.type));let n=this.stylesForType(this.message.type);this.element.style.border=`1px solid ${Ko(n.border,"transparent")}`,this.message.content&&(this.hasFocus()||t)&&this._showMessage()}hideMessage(){this.message=null,this.element.classList.remove("info"),this.element.classList.remove("warning"),this.element.classList.remove("error"),this.element.classList.add("idle"),this._hideMessage(),this.applyStyles()}isInputValid(){return!!this.validation&&!this.validation(this.value)}validate(){let e=null;return this.validation&&(e=this.validation(this.value),e?(this.inputElement.setAttribute("aria-invalid","true"),this.showMessage(e)):this.inputElement.hasAttribute("aria-invalid")&&(this.inputElement.removeAttribute("aria-invalid"),this.hideMessage())),e?.type}stylesForType(e){let t=this.options.inputBoxStyles;switch(e){case 1:return{border:t.inputValidationInfoBorder,background:t.inputValidationInfoBackground,foreground:t.inputValidationInfoForeground};case 2:return{border:t.inputValidationWarningBorder,background:t.inputValidationWarningBackground,foreground:t.inputValidationWarningForeground};default:return{border:t.inputValidationErrorBorder,background:t.inputValidationErrorBackground,foreground:t.inputValidationErrorForeground}}}classForType(e){switch(e){case 1:return"info";case 2:return"warning";default:return"error"}}_showMessage(){if(!this.contextViewProvider||!this.message)return;let e,t=()=>e.style.width=iu(this.element)+"px";this.contextViewProvider.showContextView({getAnchor:()=>this.element,anchorAlignment:1,render:i=>{if(!this.message)return null;e=Ke(i,af(".monaco-inputbox-container")),t();let r={inline:!0,className:"monaco-inputbox-message"},s=this.message.formatContent?tF(this.message.content,r):eF(this.message.content,r);s.classList.add(this.classForType(this.message.type));let a=this.stylesForType(this.message.type);return s.style.backgroundColor=a.background??"",s.style.color=a.foreground??"",s.style.border=a.border?`1px solid ${a.border}`:"",Ke(e,s),null},onHide:()=>{this.state="closed"},layout:t});let n;this.message.type===3?n=p("alertErrorMessage","Error: {0}",this.message.content):this.message.type===2?n=p("alertWarningMessage","Warning: {0}",this.message.content):n=p("alertInfoMessage","Info: {0}",this.message.content),Th(n),this.state="open"}_hideMessage(){this.contextViewProvider&&(this.state==="open"&&this.contextViewProvider.hideContextView(),this.state="idle")}onValueChange(){this._onDidChange.fire(this.value),this.validate(),this.updateMirror(),this.input.classList.toggle("empty",!this.value),this.state==="open"&&this.contextViewProvider&&this.contextViewProvider.layout()}updateMirror(){if(!this.mirror)return;let e=this.value,n=e.charCodeAt(e.length-1)===10?" ":"";(e+n).replace(/\u000c/g,"")?this.mirror.textContent=e+n:this.mirror.innerText="\xA0",this.layout()}applyStyles(){let e=this.options.inputBoxStyles,t=e.inputBackground??"",n=e.inputForeground??"",i=e.inputBorder??"";this.element.style.backgroundColor=t,this.element.style.color=n,this.input.style.backgroundColor="inherit",this.input.style.color=n,this.element.style.border=`1px solid ${Ko(i,"transparent")}`}layout(){if(!this.mirror)return;let e=this.cachedContentHeight;this.cachedContentHeight=Eb(this.mirror),e!==this.cachedContentHeight&&(this.cachedHeight=Math.min(this.cachedContentHeight,this.maxHeight),this.input.style.height=this.cachedHeight+"px",this._onDidHeightChange.fire(this.cachedContentHeight))}insertAtCursor(e){let t=this.inputElement,n=t.selectionStart,i=t.selectionEnd,r=t.value;n!==null&&i!==null&&(this.value=r.substr(0,n)+e+r.substr(i),t.setSelectionRange(n+1,n+1),this.layout())}dispose(){this._hideMessage(),this.message=null,this.actionbar?.dispose(),super.dispose()}},Gl=class extends mw{history;observer;_onDidFocus=this._register(new E);onDidFocus=this._onDidFocus.event;_onDidBlur=this._register(new E);onDidBlur=this._onDidBlur.event;constructor(e,t,n){let i=p({key:"history.inputbox.hint.suffix.noparens",comment:['Text is the suffix of an input field placeholder coming after the action the input field performs, this will be used when the input field ends in a closing parenthesis ")", for example "Filter (e.g. text, !exclude)". The character inserted into the final string is \u21C5 to represent the up and down arrow keys.']}," or {0} for history","\u21C5"),r=p({key:"history.inputbox.hint.suffix.inparens",comment:['Text is the suffix of an input field placeholder coming after the action the input field performs, this will be used when the input field does NOT end in a closing parenthesis (eg. "Find"). The character inserted into the final string is \u21C5 to represent the up and down arrow keys.']}," ({0} for history)","\u21C5");super(e,t,n),this.history=new pw(n.history,100);let s=()=>{if(n.showHistoryHint&&n.showHistoryHint()&&!this.placeholder.endsWith(i)&&!this.placeholder.endsWith(r)&&this.history.getHistory().length){let a=this.placeholder.endsWith(")")?i:r,l=this.placeholder+a;n.showPlaceholderOnFocus&&!er(this.input)?this.placeholder=l:this.setPlaceHolder(l)}};this.observer=new MutationObserver((a,l)=>{a.forEach(d=>{d.target.textContent||s()})}),this.observer.observe(this.input,{attributeFilter:["class"]}),this.onfocus(this.input,()=>s()),this.onblur(this.input,()=>{let a=l=>{if(this.placeholder.endsWith(l)){let d=this.placeholder.slice(0,this.placeholder.length-l.length);return n.showPlaceholderOnFocus?this.placeholder=d:this.setPlaceHolder(d),!0}else return!1};a(r)||a(i)})}dispose(){super.dispose(),this.observer&&(this.observer.disconnect(),this.observer=void 0)}addToHistory(e){this.value&&(e||this.value!==this.getCurrentValue())&&this.history.add(this.value)}prependHistory(e){let t=this.getHistory();this.clearHistory(),e.forEach(n=>{this.history.add(n)}),t.forEach(n=>{this.history.add(n)})}getHistory(){return this.history.getHistory()}isAtFirstInHistory(){return this.history.isFirst()}isAtLastInHistory(){return this.history.isLast()}isNowhereInHistory(){return this.history.isNowhere()}showNextValue(){this.history.has(this.value)||this.addToHistory();let e=this.getNextValue();e&&(e=e===this.value?this.getNextValue():e),this.value=e??"",Dg(this.value?this.value:p("clearedInput","Cleared Input"))}showPreviousValue(){this.history.has(this.value)||this.addToHistory();let e=this.getPreviousValue();e&&(e=e===this.value?this.getPreviousValue():e),e&&(this.value=e,Dg(this.value))}clearHistory(){this.history.clear()}setPlaceHolder(e){super.setPlaceHolder(e),this.setTooltip(e)}onBlur(){super.onBlur(),this._onDidBlur.fire()}onFocus(){super.onFocus(),this._onDidFocus.fire()}getCurrentValue(){let e=this.history.current();return e||(e=this.history.last(),this.history.next()),e}getPreviousValue(){return this.history.previous()||this.history.first()}getNextValue(){return this.history.next()}};var Ez=p("caseDescription","Match Case"),_z=p("wordsDescription","Match Whole Word"),Tz=p("regexDescription","Use Regular Expression"),gw=class extends La{constructor(e){super({icon:ge.caseSensitive,title:Ez+e.appendTitle,isChecked:e.isChecked,hoverDelegate:e.hoverDelegate??Gt("element"),inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}},fw=class extends La{constructor(e){super({icon:ge.wholeWord,title:_z+e.appendTitle,isChecked:e.isChecked,hoverDelegate:e.hoverDelegate??Gt("element"),inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}},bw=class extends La{constructor(e){super({icon:ge.regex,title:Tz+e.appendTitle,isChecked:e.isChecked,hoverDelegate:e.hoverDelegate??Gt("element"),inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}};var Lz=p("defaultLabel","input"),lf=class extends On{static OPTION_CHANGE="optionChange";placeholder;validation;label;showCommonFindToggles;fixFocusOnOptionClickEnabled=!0;imeSessionInProgress=!1;additionalTogglesDisposables=this._register(new Zt);controls;regex;wholeWords;caseSensitive;additionalToggles=[];domNode;inputBox;_onDidOptionChange=this._register(new E);onDidOptionChange=this._onDidOptionChange.event;_onKeyDown=this._register(new E);onKeyDown=this._onKeyDown.event;_onMouseDown=this._register(new E);onMouseDown=this._onMouseDown.event;_onInput=this._register(new E);onInput=this._onInput.event;_onKeyUp=this._register(new E);onKeyUp=this._onKeyUp.event;_onCaseSensitiveKeyDown=this._register(new E);onCaseSensitiveKeyDown=this._onCaseSensitiveKeyDown.event;_onRegexKeyDown=this._register(new E);onRegexKeyDown=this._onRegexKeyDown.event;constructor(e,t,n){super(),this.placeholder=n.placeholder||"",this.validation=n.validation,this.label=n.label||Lz,this.showCommonFindToggles=!!n.showCommonFindToggles;let i=n.appendCaseSensitiveLabel||"",r=n.appendWholeWordsLabel||"",s=n.appendRegexLabel||"",a=n.history||[],l=!!n.flexibleHeight,d=!!n.flexibleWidth,c=n.flexibleMaxHeight;this.domNode=document.createElement("div"),this.domNode.classList.add("monaco-findInput"),this.inputBox=this._register(new Gl(this.domNode,t,{placeholder:this.placeholder||"",ariaLabel:this.label||"",validationOptions:{validation:this.validation},history:a,showHistoryHint:n.showHistoryHint,flexibleHeight:l,flexibleWidth:d,flexibleMaxHeight:c,inputBoxStyles:n.inputBoxStyles}));let u=this._register(Wl());if(this.showCommonFindToggles){this.regex=this._register(new bw({appendTitle:s,isChecked:!1,hoverDelegate:u,...n.toggleStyles})),this._register(this.regex.onChange(m=>{this._onDidOptionChange.fire(m),!m&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this._register(this.regex.onKeyDown(m=>{this._onRegexKeyDown.fire(m)})),this.wholeWords=this._register(new fw({appendTitle:r,isChecked:!1,hoverDelegate:u,...n.toggleStyles})),this._register(this.wholeWords.onChange(m=>{this._onDidOptionChange.fire(m),!m&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this.caseSensitive=this._register(new gw({appendTitle:i,isChecked:!1,hoverDelegate:u,...n.toggleStyles})),this._register(this.caseSensitive.onChange(m=>{this._onDidOptionChange.fire(m),!m&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this._register(this.caseSensitive.onKeyDown(m=>{this._onCaseSensitiveKeyDown.fire(m)}));let h=[this.caseSensitive.domNode,this.wholeWords.domNode,this.regex.domNode];this.onkeydown(this.domNode,m=>{if(m.equals(15)||m.equals(17)||m.equals(9)){let f=h.indexOf(this.domNode.ownerDocument.activeElement);if(f>=0){let g=-1;m.equals(17)?g=(f+1)%h.length:m.equals(15)&&(f===0?g=h.length-1:g=f-1),m.equals(9)?(h[f].blur(),this.inputBox.focus()):g>=0&&h[g].focus(),$e.stop(m,!0)}}})}this.controls=document.createElement("div"),this.controls.className="controls",this.controls.style.display=this.showCommonFindToggles?"":"none",this.caseSensitive&&this.controls.append(this.caseSensitive.domNode),this.wholeWords&&this.controls.appendChild(this.wholeWords.domNode),this.regex&&this.controls.appendChild(this.regex.domNode),this.setAdditionalToggles(n?.additionalToggles),this.controls&&this.domNode.appendChild(this.controls),e?.appendChild(this.domNode),this._register(U(this.inputBox.inputElement,"compositionstart",h=>{this.imeSessionInProgress=!0})),this._register(U(this.inputBox.inputElement,"compositionend",h=>{this.imeSessionInProgress=!1,this._onInput.fire()})),this.onkeydown(this.inputBox.inputElement,h=>this._onKeyDown.fire(h)),this.onkeyup(this.inputBox.inputElement,h=>this._onKeyUp.fire(h)),this.oninput(this.inputBox.inputElement,h=>this._onInput.fire()),this.onmousedown(this.inputBox.inputElement,h=>this._onMouseDown.fire(h))}get isImeSessionInProgress(){return this.imeSessionInProgress}get onDidChange(){return this.inputBox.onDidChange}layout(e){this.inputBox.layout(),this.updateInputBoxPadding(e.collapsedFindWidget)}enable(){this.domNode.classList.remove("disabled"),this.inputBox.enable(),this.regex?.enable(),this.wholeWords?.enable(),this.caseSensitive?.enable();for(let e of this.additionalToggles)e.enable()}disable(){this.domNode.classList.add("disabled"),this.inputBox.disable(),this.regex?.disable(),this.wholeWords?.disable(),this.caseSensitive?.disable();for(let e of this.additionalToggles)e.disable()}setFocusInputOnOptionClick(e){this.fixFocusOnOptionClickEnabled=e}setEnabled(e){e?this.enable():this.disable()}setAdditionalToggles(e){for(let t of this.additionalToggles)t.domNode.remove();this.additionalToggles=[],this.additionalTogglesDisposables.value=new he;for(let t of e??[])this.additionalTogglesDisposables.value.add(t),this.controls.appendChild(t.domNode),this.additionalTogglesDisposables.value.add(t.onChange(n=>{this._onDidOptionChange.fire(n),!n&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus()})),this.additionalToggles.push(t);this.additionalToggles.length>0&&(this.controls.style.display=""),this.updateInputBoxPadding()}updateInputBoxPadding(e=!1){e?this.inputBox.paddingRight=0:this.inputBox.paddingRight=(this.caseSensitive?.width()??0)+(this.wholeWords?.width()??0)+(this.regex?.width()??0)+this.additionalToggles.reduce((t,n)=>t+n.width(),0)}clear(){this.clearValidation(),this.setValue(""),this.focus()}getValue(){return this.inputBox.value}setValue(e){this.inputBox.value!==e&&(this.inputBox.value=e)}onSearchSubmit(){this.inputBox.addToHistory()}select(){this.inputBox.select()}focus(){this.inputBox.focus()}getCaseSensitive(){return this.caseSensitive?.checked??!1}setCaseSensitive(e){this.caseSensitive&&(this.caseSensitive.checked=e)}getWholeWords(){return this.wholeWords?.checked??!1}setWholeWords(e){this.wholeWords&&(this.wholeWords.checked=e)}getRegex(){return this.regex?.checked??!1}setRegex(e){this.regex&&(this.regex.checked=e,this.validate())}focusOnCaseSensitive(){this.caseSensitive?.focus()}focusOnRegex(){this.regex?.focus()}_lastHighlightFindOptions=0;highlightFindOptions(){this.domNode.classList.remove("highlight-"+this._lastHighlightFindOptions),this._lastHighlightFindOptions=1-this._lastHighlightFindOptions,this.domNode.classList.add("highlight-"+this._lastHighlightFindOptions)}validate(){this.inputBox.validate()}showMessage(e){this.inputBox.showMessage(e)}clearMessage(){this.inputBox.hideMessage()}clearValidation(){this.inputBox.hideMessage()}};var gzt={keybindingLabelBackground:re(QA),keybindingLabelForeground:re(JA),keybindingLabelBorder:re(eO),keybindingLabelBottomBorder:re(tO),keybindingLabelShadow:re(Ou)};var WF={buttonForeground:re(IT),buttonSeparator:re(BA),buttonBackground:re(Nu),buttonHoverBackground:re(VA),buttonSecondaryForeground:re(HA),buttonSecondaryBackground:re(ny),buttonSecondaryHoverBackground:re(UA),buttonBorder:re(WA)};var HF={progressBarBackground:re(oA)};var Rz={inputActiveOptionBorder:re(bT),inputActiveOptionForeground:re(yT),inputActiveOptionBackground:re(vT)},fzt={activeForeground:re(Pu),activeBackground:re(zA),activeBorder:re(KA),inactiveForeground:re(GA),inactiveBackground:re(jA),inactiveBorder:re($A),inactiveHoverBackground:re(qA)};var bzt={checkboxBackground:re(YA),checkboxBorder:re(XA),checkboxForeground:re(ZA)};var vzt={dialogBackground:re(ei),dialogForeground:re(_s),dialogShadow:re(Ou),dialogBorder:re(be),errorIconForeground:re(IA),warningIconForeground:re(CA),infoIconForeground:re(SA),textLinkForeground:re(Xv)};var n1={inputBackground:re(_A),inputForeground:re(TA),inputBorder:re(Fu),inputValidationInfoBorder:re(kA),inputValidationInfoBackground:re(LA),inputValidationInfoForeground:re(DA),inputValidationWarningBorder:re(AA),inputValidationWarningBackground:re(RA),inputValidationWarningForeground:re(MA),inputValidationErrorBorder:re(PA),inputValidationErrorBackground:re(OA),inputValidationErrorForeground:re(NA)};var yzt={listFilterWidgetBackground:re(pO),listFilterWidgetOutline:re(mO),listFilterWidgetNoMatchesOutline:re(gO),listFilterWidgetShadow:re(fO),inputBoxStyles:n1,toggleStyles:Rz},Izt={badgeBackground:re(Cl),badgeForeground:re(Qv),badgeBorder:re(be)};var Czt={breadcrumbsBackground:re(bA),breadcrumbsForeground:re(fA),breadcrumbsHoverForeground:re(mT),breadcrumbsFocusForeground:re(mT),breadcrumbsFocusAndSelectionForeground:re(vA)};var Szt={listBackground:void 0,listInactiveFocusForeground:void 0,listFocusBackground:re(nO),listFocusForeground:re(iO),listFocusOutline:re(oO),listActiveSelectionBackground:re(ro),listActiveSelectionForeground:re(Ts),listActiveSelectionIconForeground:re(oy),listFocusAndSelectionOutline:re(rO),listFocusAndSelectionBackground:re(ro),listFocusAndSelectionForeground:re(Ts),listInactiveSelectionBackground:re(sO),listInactiveSelectionIconForeground:re(lO),listInactiveSelectionForeground:re(aO),listInactiveFocusBackground:re(dO),listInactiveFocusOutline:re(cO),listHoverBackground:re(CT),listHoverForeground:re(ST),listDropOverBackground:re(uO),listDropBetweenBackground:re(hO),listSelectionOutline:re(Ct),listHoverOutline:re(Ct),treeIndentGuidesStroke:re(Vu),treeInactiveIndentGuidesStroke:re(bO),treeStickyScrollBackground:void 0,treeStickyScrollBorder:void 0,treeStickyScrollShadow:re(Sl),tableColumnsBorder:re(vO),tableOddRowsBackgroundColor:re(yO)};var UF={selectBackground:re(Bu),selectListBackground:re(FA),selectForeground:re(zm),decoratorRightForeground:re(LO),selectBorder:re(Km),focusBorder:re(Li),listFocusBackground:re(RO),listInactiveSelectionIconForeground:re(kO),listFocusForeground:re(DO),listFocusOutline:eA(Ct,N.transparent.toString()),listHoverBackground:re(CT),listHoverForeground:re(ST),listHoverOutline:re(Ct),selectListBorder:re(pT),listBackground:void 0,listActiveSelectionBackground:void 0,listActiveSelectionForeground:void 0,listActiveSelectionIconForeground:void 0,listFocusAndSelectionBackground:void 0,listDropOverBackground:void 0,listDropBetweenBackground:void 0,listInactiveSelectionBackground:void 0,listInactiveSelectionForeground:void 0,listInactiveFocusBackground:void 0,listInactiveFocusOutline:void 0,listSelectionOutline:void 0,listFocusAndSelectionForeground:void 0,listFocusAndSelectionOutline:void 0,listInactiveFocusForeground:void 0,tableColumnsBorder:void 0,tableOddRowsBackgroundColor:void 0,treeIndentGuidesStroke:void 0,treeInactiveIndentGuidesStroke:void 0,treeStickyScrollBackground:void 0,treeStickyScrollBorder:void 0,treeStickyScrollShadow:void 0};var wzt={shadowColor:re(Ou),borderColor:re(IO),foregroundColor:re(CO),backgroundColor:re(SO),selectionForegroundColor:re(wO),selectionBackgroundColor:re(xO),selectionBorderColor:re(EO),separatorColor:re(_O),scrollbarShadow:re(Sl),scrollbarSliderBackground:re(Jv),scrollbarSliderHoverBackground:re(ey),scrollbarSliderActiveBackground:re(ty)};function uf(o,e,t,n,i,r){let s,a,l,d,c;if(Array.isArray(o))c=o,s=e,a=t,l=n,d=i;else{let h=e;c=o.getActions(h),s=t,a=n,l=i,d=r}Mz(c,s,!1,typeof a=="string"?h=>h===a:a,l,d)}function Mz(o,e,t,n=s=>s==="navigation",i=()=>!1,r=!1){let s,a;Array.isArray(e)?(s=e,a=e):(s=e.primary,a=e.secondary);let l=new Set;for(let[d,c]of o){let u;n(d)?(u=s,u.length>0&&r&&u.push(new In)):(u=a,u.length>0&&u.push(new In));for(let h of c){t&&(h=h instanceof xi&&h.alt?h.alt:h);let m=u.push(h);h instanceof sa&&l.add({group:d,action:h,index:m-1})}}for(let{group:d,action:c,index:u}of l){let h=n(d)?s:a,m=c.actions;i(c,d,h.length)&&h.splice(u,1,...m)}}var Tc=class extends Ul{constructor(t,n,i,r,s,a,l,d){super(void 0,t,{icon:!!(t.class||t.item.icon),label:!t.class&&!t.item.icon,draggable:n?.draggable,keybinding:n?.keybinding,hoverDelegate:n?.hoverDelegate});this._options=n;this._keybindingService=i;this._notificationService=r;this._contextKeyService=s;this._themeService=a;this._contextMenuService=l;this._accessibilityService=d;this._altKey=nu.getInstance()}_wantsAltCommand=!1;_itemClassDispose=this._register(new Zt);_altKey;get _menuItemAction(){return this._action}get _commandAction(){return this._wantsAltCommand&&this._menuItemAction.alt||this._menuItemAction}async onClick(t){t.preventDefault(),t.stopPropagation();try{await this.actionRunner.run(this._commandAction,this._context)}catch(n){this._notificationService.error(n)}}render(t){if(super.render(t),t.classList.add("menu-entry"),this.options.icon&&this._updateItemClass(this._menuItemAction.item),this._menuItemAction.alt){let n=!1,i=()=>{let r=!!this._menuItemAction.alt?.enabled&&(!this._accessibilityService.isMotionReduced()||n)&&(this._altKey.keyStatus.altKey||this._altKey.keyStatus.shiftKey&&n);r!==this._wantsAltCommand&&(this._wantsAltCommand=r,this.updateLabel(),this.updateTooltip(),this.updateClass())};this._register(this._altKey.event(i)),this._register(U(t,"mouseleave",r=>{n=!1,i()})),this._register(U(t,"mouseenter",r=>{n=!0,i()})),i()}}updateLabel(){this.options.label&&this.label&&(this.label.textContent=this._commandAction.label)}getTooltip(){let t=this._keybindingService.lookupKeybinding(this._commandAction.id,this._contextKeyService),n=t&&t.getLabel(),i=this._commandAction.tooltip||this._commandAction.label,r=n?p("titleAndKb","{0} ({1})",i,n):i;if(!this._wantsAltCommand&&this._menuItemAction.alt?.enabled){let s=this._menuItemAction.alt.tooltip||this._menuItemAction.alt.label,a=this._keybindingService.lookupKeybinding(this._menuItemAction.alt.id,this._contextKeyService),l=a&&a.getLabel(),d=l?p("titleAndKb","{0} ({1})",s,l):s;r=p("titleAndKbAndAlt",`{0}
[{1}] {2}`,r,Q0.modifierLabels[Zo].altKey,d)}return r}updateClass(){this.options.icon&&(this._commandAction!==this._menuItemAction?this._menuItemAction.alt&&this._updateItemClass(this._menuItemAction.alt.item):this._updateItemClass(this._menuItemAction.item))}_updateItemClass(t){this._itemClassDispose.value=void 0;let{element:n,label:i}=this;if(!n||!i)return;let r=this._commandAction.checked&&lM(t.toggled)&&t.toggled.icon?t.toggled.icon:t.icon;if(r)if(Je.isThemeIcon(r)){let s=Je.asClassNameArray(r);i.classList.add(...s),this._itemClassDispose.value=ve(()=>{i.classList.remove(...s)})}else i.style.backgroundImage=xT(this._themeService.getColorTheme().type)?sl(r.dark):sl(r.light),i.classList.add("icon"),this._itemClassDispose.value=yr(ve(()=>{i.style.backgroundImage="",i.classList.remove("icon")}),this._themeService.onDidColorThemeChange(()=>{this.updateClass()}))}};Tc=R([S(2,un),S(3,Jd),S(4,ft),S(5,bi),S(6,pr),S(7,Co)],Tc);var Lc=class extends Kl{constructor(t,n,i,r,s){let a={...n,menuAsChild:n?.menuAsChild??!1,classNames:n?.classNames??(Je.isThemeIcon(t.item.icon)?Je.asClassName(t.item.icon):void 0),keybindingProvider:n?.keybindingProvider??(l=>i.lookupKeybinding(l.id))};super(t,{getActions:()=>t.actions},r,a);this._keybindingService=i;this._contextMenuService=r;this._themeService=s}render(t){super.render(t),Yc(this.element),t.classList.add("menu-entry");let n=this._action,{icon:i}=n.item;if(i&&!Je.isThemeIcon(i)){this.element.classList.add("icon");let r=()=>{this.element&&(this.element.style.backgroundImage=xT(this._themeService.getColorTheme().type)?sl(i.dark):sl(i.light))};r(),this._register(this._themeService.onDidColorThemeChange(()=>{r()}))}}};Lc=R([S(2,un),S(3,pr),S(4,bi)],Lc);var df=class extends si{constructor(t,n,i,r,s,a,l,d){super(null,t);this._keybindingService=i;this._notificationService=r;this._contextMenuService=s;this._menuService=a;this._instaService=l;this._storageService=d;this._options=n,this._storageKey=`${t.item.submenu.id}_lastActionId`;let c,u=n?.persistLastActionId?d.get(this._storageKey,1):void 0;u&&(c=t.actions.find(m=>u===m.id)),c||(c=t.actions[0]),this._defaultAction=this._instaService.createInstance(Tc,c,{keybinding:this._getDefaultActionKeybindingLabel(c)});let h={keybindingProvider:m=>this._keybindingService.lookupKeybinding(m.id),...n,menuAsChild:n?.menuAsChild??!0,classNames:n?.classNames??["codicon","codicon-chevron-down"],actionRunner:n?.actionRunner??new jo};this._dropdown=new Kl(t,t.actions,this._contextMenuService,h),this._register(this._dropdown.actionRunner.onDidRun(m=>{m.action instanceof xi&&this.update(m.action)}))}_options;_defaultAction;_dropdown;_container=null;_storageKey;get onDidChangeDropdownVisibility(){return this._dropdown.onDidChangeVisibility}update(t){this._options?.persistLastActionId&&this._storageService.store(this._storageKey,t.id,1,1),this._defaultAction.dispose(),this._defaultAction=this._instaService.createInstance(Tc,t,{keybinding:this._getDefaultActionKeybindingLabel(t)}),this._defaultAction.actionRunner=new class extends jo{async runAction(n,i){await n.run(void 0)}},this._container&&this._defaultAction.render(Qx(this._container,We(".action-container")))}_getDefaultActionKeybindingLabel(t){let n;if(this._options?.renderKeybindingWithDefaultActionLabel){let i=this._keybindingService.lookupKeybinding(t.id);i&&(n=`(${i.getLabel()})`)}return n}setActionContext(t){super.setActionContext(t),this._defaultAction.setActionContext(t),this._dropdown.setActionContext(t)}render(t){this._container=t,super.render(this._container),this._container.classList.add("monaco-dropdown-with-default");let n=We(".action-container");this._defaultAction.render(Ke(this._container,n)),this._register(U(n,ae.KEY_DOWN,r=>{let s=new nt(r);s.equals(17)&&(this._defaultAction.element.tabIndex=-1,this._dropdown.focus(),s.stopPropagation())}));let i=We(".dropdown-action-container");this._dropdown.render(Ke(this._container,i)),this._register(U(i,ae.KEY_DOWN,r=>{let s=new nt(r);s.equals(15)&&(this._defaultAction.element.tabIndex=0,this._dropdown.setFocusable(!1),this._defaultAction.element?.focus(),s.stopPropagation())}))}focus(t){t?this._dropdown.focus():(this._defaultAction.element.tabIndex=0,this._defaultAction.element.focus())}blur(){this._defaultAction.element.tabIndex=-1,this._dropdown.blur(),this._container.blur()}setFocusable(t){t?this._defaultAction.element.tabIndex=0:(this._defaultAction.element.tabIndex=-1,this._dropdown.setFocusable(!1))}dispose(){this._defaultAction.dispose(),this._dropdown.dispose(),super.dispose()}};df=R([S(2,un),S(3,Jd),S(4,pr),S(5,kd),S(6,ct),S(7,zn)],df);var cf=class extends ZS{constructor(e,t){super(null,e,e.actions.map(n=>({text:n.id===In.ID?"\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500":n.label,isDisabled:!n.enabled})),0,t,UF,{ariaLabel:e.tooltip,optionsAsChildren:!0}),this.select(Math.max(0,e.actions.findIndex(n=>n.checked)))}render(e){super.render(e),e.style.borderColor=re(Km)}runAction(e,t){let n=this.action.actions[t];n&&this.actionRunner.run(n)}};cf=R([S(1,sw)],cf);function zF(o,e,t){return e instanceof xi?o.createInstance(Tc,e,t):e instanceof Fi?e.item.isSelection?o.createInstance(cf,e):e.item.rememberDefaultAction?o.createInstance(df,e,{...t,persistLastActionId:!0}):o.createInstance(Lc,e,t):void 0}var vw=class{constructor(e){this.nodes=e}toString(){return this.nodes.map(e=>typeof e=="string"?e:e.label).join("")}};R([de],vw.prototype,"toString",1);var Az=/\[([^\]]+)\]\(((?:https?:\/\/|command:|file:)[^\)\s]+)(?: (["'])(.+?)(\3))?\)/gi;function KF(o){let e=[],t=0,n;for(;n=Az.exec(o);){n.index-t>0&&e.push(o.substring(t,n.index));let[,i,r,,s]=n;s?e.push({label:i,href:r,title:s}):e.push({label:i,href:r}),t=n.index+n[0].length}return t<o.length&&e.push(o.substring(t)),new vw(e)}var jl=Y("hoverService"),yw=class extends V{constructor(t,n,i={},r,s){super();this.placement=t;this.instantHover=n;this.overrideOptions=i;this.configurationService=r;this.hoverService=s;this._delay=this.configurationService.getValue("workbench.hover.delay"),this._register(this.configurationService.onDidChangeConfiguration(a=>{a.affectsConfiguration("workbench.hover.delay")&&(this._delay=this.configurationService.getValue("workbench.hover.delay"))}))}lastHoverHideTime=0;timeLimit=200;_delay;get delay(){return this.isInstantlyHovering()?0:this._delay}hoverDisposables=this._register(new he);showHover(t,n){let i=typeof this.overrideOptions=="function"?this.overrideOptions(t,n):this.overrideOptions;this.hoverDisposables.clear();let r=yn(t.target)?[t.target]:t.target.targetElements;for(let a of r)this.hoverDisposables.add(Jt(a,"keydown",l=>{l.equals(9)&&this.hoverService.hideHover()}));let s=yn(t.content)?void 0:t.content.toString();return this.hoverService.showHover({...t,...i,persistence:{hideOnKeyDown:!0,...i.persistence},id:s,appearance:{...t.appearance,compact:!0,skipFadeInAnimation:this.isInstantlyHovering(),...i.appearance}},n)}isInstantlyHovering(){return this.instantHover&&Date.now()-this.lastHoverHideTime<this.timeLimit}setInstantHoverTimeLimit(t){if(!this.instantHover)throw new Error("Instant hover is not enabled");this.timeLimit=t}onDidHideHover(){this.hoverDisposables.clear(),this.instantHover&&(this.lastHoverHideTime=Date.now())}};yw=R([S(3,Et),S(4,jl)],yw);var rp=class extends V{constructor(t,n,i={},r,s){super();this._link=n;this._hoverService=r;this.el=Ke(t,We("a.monaco-link",{tabIndex:n.tabIndex??0,href:n.href},n.label)),this.hoverDelegate=i.hoverDelegate??Gt("mouse"),this.setTooltip(n.title),this.el.setAttribute("role","button");let a=this._register(new Fe(this.el,"click")),l=this._register(new Fe(this.el,"keypress")),d=oe.chain(l.event,h=>h.map(m=>new nt(m)).filter(m=>m.keyCode===3)),c=this._register(new Fe(this.el,at.Tap)).event;this._register(Yt.addTarget(this.el));let u=oe.any(a.event,d,c);this._register(u(h=>{this.enabled&&($e.stop(h,!0),i?.opener?i.opener(this._link.href):s.open(this._link.href,{allowCommands:!0}))})),this.enabled=!0}el;hover;hoverDelegate;_enabled=!0;get enabled(){return this._enabled}set enabled(t){t?(this.el.setAttribute("aria-disabled","false"),this.el.tabIndex=0,this.el.style.pointerEvents="auto",this.el.style.opacity="1",this.el.style.cursor="pointer",this._enabled=!1):(this.el.setAttribute("aria-disabled","true"),this.el.tabIndex=-1,this.el.style.pointerEvents="none",this.el.style.opacity="0.4",this.el.style.cursor="default",this._enabled=!0),this._enabled=t}set link(t){typeof t.label=="string"?this.el.textContent=t.label:(Ci(this.el),this.el.appendChild(t.label)),this.el.href=t.href,typeof t.tabIndex<"u"&&(this.el.tabIndex=t.tabIndex),this.setTooltip(t.title),this._link=t}setTooltip(t){this.hoverDelegate.showNativeHover?this.el.title=t??"":!this.hover&&t?this.hover=this._register(this._hoverService.setupManagedHover(this.hoverDelegate,this.el,t)):this.hover&&this.hover.update(t)}};rp=R([S(3,jl),S(4,Us)],rp);var Zr;(s=>{let o;(h=>(h[h.None=0]="None",h[h.Done=1]="Done",h[h.Infinite=2]="Infinite",h[h.While=3]="While",h[h.Work=4]="Work"))(o=s.Type||={}),s.None={type:0},s.Done={type:1},s.Infinite={type:2};class i{constructor(l,d,c){this.whilePromise=l;this.whileStart=d;this.whileDelay=c}type=3}s.While=i;class r{constructor(l,d){this.total=l;this.worked=d}type=4}s.Work=r})(Zr||={});var Iw=class extends V{constructor(t,n){super();this.progressBar=t;this.scope=n;this.registerListeners()}progressState=Zr.None;registerListeners(){this._register(this.scope.onDidChangeActive(()=>{this.scope.isActive?this.onDidScopeActivate():this.onDidScopeDeactivate()}))}onDidScopeActivate(){if(this.progressState.type!==Zr.Done.type)if(this.progressState.type===3){let t;if(this.progressState.whileDelay>0){let n=this.progressState.whileDelay-(Date.now()-this.progressState.whileStart);n>0&&(t=n)}this.doShowWhile(t)}else this.progressState.type===2?this.progressBar.infinite().show():this.progressState.type===4&&(this.progressState.total&&this.progressBar.total(this.progressState.total).show(),this.progressState.worked&&this.progressBar.worked(this.progressState.worked).show())}onDidScopeDeactivate(){this.progressBar.stop().hide()}show(t,n){return typeof t=="boolean"?this.progressState=Zr.Infinite:this.progressState=new Zr.Work(t,void 0),this.scope.isActive&&(this.progressState.type===2?this.progressBar.infinite().show(n):this.progressState.type===4&&typeof this.progressState.total=="number"&&this.progressBar.total(this.progressState.total).show(n)),{total:i=>{this.progressState=new Zr.Work(i,this.progressState.type===4?this.progressState.worked:void 0),this.scope.isActive&&this.progressBar.total(i)},worked:i=>{!this.scope.isActive||this.progressBar.hasTotal()?(this.progressState=new Zr.Work(this.progressState.type===4?this.progressState.total:void 0,this.progressState.type===4&&typeof this.progressState.worked=="number"?this.progressState.worked+i:i),this.scope.isActive&&this.progressBar.worked(i)):(this.progressState=Zr.Infinite,this.progressBar.infinite().show())},done:()=>{this.progressState=Zr.Done,this.scope.isActive&&this.progressBar.stop().hide()}}}async showWhile(t,n){this.progressState.type===3&&(t=Promise.all([t,this.progressState.whilePromise])),this.progressState=new Zr.While(t,n||0,Date.now());try{this.doShowWhile(n),await t}catch{}finally{(this.progressState.type!==3||this.progressState.whilePromise===t)&&(this.progressState=Zr.None,this.scope.isActive&&this.progressBar.stop().hide())}}doShowWhile(t){this.scope.isActive&&this.progressBar.infinite().show(t)}},Cw=class extends V{constructor(t,n){super();this.scopeId=t;this._isActive=n}_onDidChangeActive=this._register(new E);onDidChangeActive=this._onDidChangeActive.event;get isActive(){return this._isActive}onScopeOpened(t){t===this.scopeId&&(this._isActive||(this._isActive=!0,this._onDidChangeActive.fire()))}onScopeClosed(t){t===this.scopeId&&this._isActive&&(this._isActive=!1,this._onDidChangeActive.fire())}};var i1=class extends V{constructor(t,n,i,r){super();this.options=n;this.menuService=i;this.contextKeyService=r;this.menu=this._register(i.createMenu(t,r)),this._register(this.menu.onDidChange(()=>this.updateActions())),this.updateActions()}menu;_primaryActions=[];get primaryActions(){return this._primaryActions}_secondaryActions=[];get secondaryActions(){return this._secondaryActions}_onDidChange=this._register(new E);onDidChange=this._onDidChange.event;disposables=this._register(new he);updateActions(){this.disposables.clear(),this._primaryActions=[],this._secondaryActions=[],uf(this.menu,this.options,{primary:this._primaryActions,secondary:this._secondaryActions}),this.disposables.add(this.updateSubmenus([...this._primaryActions,...this._secondaryActions],{})),this._onDidChange.fire()}updateSubmenus(t,n){let i=new he;for(let r of t)if(r instanceof Fi&&!n[r.item.submenu.id]){let s=n[r.item.submenu.id]=i.add(this.menuService.createMenu(r.item.submenu,this.contextKeyService));i.add(s.onDidChange(()=>this.updateActions())),i.add(this.updateSubmenus(r.actions,n))}return i}},sp=class extends V{constructor(t,n,i,r,s){super();this.menuId=t;this.contextMenuId=n;this.options=i;this.contextKeyService=r;this.menuService=s;this.menuActions=this._register(new i1(t,this.options,s,r)),this._register(this.menuActions.onDidChange(()=>this._onDidChange.fire()))}menuActions;_onDidChange=this._register(new E);onDidChange=this._onDidChange.event;getPrimaryActions(){return this.menuActions.primaryActions}getSecondaryActions(){return this.menuActions.secondaryActions}getContextMenuActions(){let t=[];if(this.contextMenuId){let n=this.menuService.getMenuActions(this.contextMenuId,this.contextKeyService,this.options);uf(n,{primary:[],secondary:t})}return t}};sp=R([S(3,ft),S(4,kd)],sp);var Sw=class extends V{options;actionBar;toggleMenuAction;toggleMenuActionViewItem;submenuActionViewItems=[];hasSecondaryActions=!1;element;_onDidChangeDropdownVisibility=this._register(new Mp);onDidChangeDropdownVisibility=this._onDidChangeDropdownVisibility.event;disposables=this._register(new he);constructor(e,t,n={orientation:0}){super(),n.hoverDelegate=n.hoverDelegate??this._register(Wl()),this.options=n,this.toggleMenuAction=this._register(new ap(()=>this.toggleMenuActionViewItem?.show(),n.toggleMenuTitle)),this.element=document.createElement("div"),this.element.className="monaco-toolbar",e.appendChild(this.element),this.actionBar=this._register(new Da(this.element,{orientation:n.orientation,ariaLabel:n.ariaLabel,actionRunner:n.actionRunner,allowContextMenu:n.allowContextMenu,highlightToggledItems:n.highlightToggledItems,hoverDelegate:n.hoverDelegate,actionViewItemProvider:(i,r)=>{if(i.id===ap.ID)return this.toggleMenuActionViewItem=new Kl(i,i.menuActions,t,{actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,keybindingProvider:this.options.getKeyBinding,classNames:Je.asClassNameArray(n.moreIcon??ge.toolBarMore),anchorAlignmentProvider:this.options.anchorAlignmentProvider,menuAsChild:!!this.options.renderDropdownAsChildElement,skipTelemetry:this.options.skipTelemetry,isMenu:!0,hoverDelegate:this.options.hoverDelegate}),this.toggleMenuActionViewItem.setActionContext(this.actionBar.context),this.disposables.add(this._onDidChangeDropdownVisibility.add(this.toggleMenuActionViewItem.onDidChangeVisibility)),this.toggleMenuActionViewItem;if(n.actionViewItemProvider){let s=n.actionViewItemProvider(i,r);if(s)return s}if(i instanceof sa){let s=new Kl(i,i.actions,t,{actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,keybindingProvider:this.options.getKeyBinding,classNames:i.class,anchorAlignmentProvider:this.options.anchorAlignmentProvider,menuAsChild:!!this.options.renderDropdownAsChildElement,skipTelemetry:this.options.skipTelemetry,hoverDelegate:this.options.hoverDelegate});return s.setActionContext(this.actionBar.context),this.submenuActionViewItems.push(s),this.disposables.add(this._onDidChangeDropdownVisibility.add(s.onDidChangeVisibility)),s}}}))}set actionRunner(e){this.actionBar.actionRunner=e}get actionRunner(){return this.actionBar.actionRunner}set context(e){this.actionBar.context=e,this.toggleMenuActionViewItem?.setActionContext(e);for(let t of this.submenuActionViewItems)t.setActionContext(e)}getElement(){return this.element}focus(){this.actionBar.focus()}getItemsWidth(){let e=0;for(let t=0;t<this.actionBar.length();t++)e+=this.actionBar.getWidth(t);return e}getItemAction(e){return this.actionBar.getAction(e)}getItemWidth(e){return this.actionBar.getWidth(e)}getItemsLength(){return this.actionBar.length()}setAriaLabel(e){this.actionBar.setAriaLabel(e)}setActions(e,t){this.clear();let n=e?e.slice(0):[];this.hasSecondaryActions=!!(t&&t.length>0),this.hasSecondaryActions&&t&&(this.toggleMenuAction.menuActions=t.slice(0),n.push(this.toggleMenuAction)),n.forEach(i=>{this.actionBar.push(i,{icon:this.options.icon??!0,label:this.options.label??!1,keybinding:this.getKeybindingLabel(i)})})}isEmpty(){return this.actionBar.isEmpty()}getKeybindingLabel(e){return this.options.getKeyBinding?.(e)?.getLabel()??void 0}clear(){this.submenuActionViewItems=[],this.disposables.clear(),this.actionBar.clear()}dispose(){this.clear(),this.disposables.dispose(),super.dispose()}},ap=class o extends ir{static ID="toolbar.toggle.more";_menuActions;toggleDropdownMenu;constructor(e,t){t=t||p("moreActions","More Actions..."),super(o.ID,t,void 0,!0),this._menuActions=[],this.toggleDropdownMenu=e}async run(){this.toggleDropdownMenu()}get menuActions(){return this._menuActions}set menuActions(e){this._menuActions=e}};var ww=class{constructor(e,t,n){this._commandService=e;this._keybindingService=t;this._hiddenStates=new Gs(n)}_hiddenStates;createMenu(e,t,n){return new lp(e,this._hiddenStates,{emitEventsForSubmenuChanges:!1,eventDebounceDelay:50,...n},this._commandService,this._keybindingService,t)}getMenuActions(e,t,n){let i=new lp(e,this._hiddenStates,{emitEventsForSubmenuChanges:!1,eventDebounceDelay:50,...n},this._commandService,this._keybindingService,t),r=i.getActions(n);return i.dispose(),r}getMenuContexts(e){let t=new xw(e,!1);return new Set([...t.structureContextKeys,...t.preconditionContextKeys,...t.toggledContextKeys])}resetHiddenStates(e){this._hiddenStates.reset(e)}};ww=R([S(0,or),S(1,un),S(2,zn)],ww);var Gs=class{constructor(e){this._storageService=e;try{let t=e.get(Gs._key,0,"{}");this._data=JSON.parse(t)}catch{this._data=Object.create(null)}this._disposables.add(e.onDidChangeValue(0,Gs._key,this._disposables)(()=>{if(!this._ignoreChangeEvent)try{let t=e.get(Gs._key,0,"{}");this._data=JSON.parse(t)}catch(t){console.log("FAILED to read storage after UPDATE",t)}this._onDidChange.fire()}))}static _key="menu.hiddenCommands";_disposables=new he;_onDidChange=new E;onDidChange=this._onDidChange.event;_ignoreChangeEvent=!1;_data;_hiddenByDefaultCache=new Map;dispose(){this._onDidChange.dispose(),this._disposables.dispose()}_isHiddenByDefault(e,t){return this._hiddenByDefaultCache.get(`${e.id}/${t}`)??!1}setDefaultState(e,t,n){this._hiddenByDefaultCache.set(`${e.id}/${t}`,n)}isHidden(e,t){let n=this._isHiddenByDefault(e,t),i=this._data[e.id]?.includes(t)??!1;return n?!i:i}updateHidden(e,t,n){this._isHiddenByDefault(e,t)&&(n=!n);let r=this._data[e.id];if(n)r?r.indexOf(t)<0&&r.push(t):this._data[e.id]=[t];else if(r){let s=r.indexOf(t);s>=0&&I1(r,s),r.length===0&&delete this._data[e.id]}this._persist()}reset(e){if(e===void 0)this._data=Object.create(null),this._persist();else{for(let{id:t}of e)this._data[t]&&delete this._data[t];this._persist()}}_persist(){try{this._ignoreChangeEvent=!0;let e=JSON.stringify(this._data);this._storageService.store(Gs._key,e,0,0)}finally{this._ignoreChangeEvent=!1}}};Gs=R([S(0,zn)],Gs);var xw=class o{constructor(e,t){this._id=e;this._collectContextKeysForSubmenus=t;this.refresh()}_menuGroups=[];_allMenuIds=new Set;_structureContextKeys=new Set;_preconditionContextKeys=new Set;_toggledContextKeys=new Set;get allMenuIds(){return this._allMenuIds}get structureContextKeys(){return this._structureContextKeys}get preconditionContextKeys(){return this._preconditionContextKeys}get toggledContextKeys(){return this._toggledContextKeys}refresh(){this._menuGroups.length=0,this._allMenuIds.clear(),this._structureContextKeys.clear(),this._preconditionContextKeys.clear(),this._toggledContextKeys.clear();let e=this._sort(hl.getMenuItems(this._id)),t;for(let n of e){let i=n.group||"";(!t||t[0]!==i)&&(t=[i,[]],this._menuGroups.push(t)),t[1].push(n),this._collectContextKeysAndSubmenuIds(n)}this._allMenuIds.add(this._id)}_sort(e){return e}_collectContextKeysAndSubmenuIds(e){if(o._fillInKbExprKeys(e.when,this._structureContextKeys),gu(e)){if(e.command.precondition&&o._fillInKbExprKeys(e.command.precondition,this._preconditionContextKeys),e.command.toggled){let t=e.command.toggled.condition||e.command.toggled;o._fillInKbExprKeys(t,this._toggledContextKeys)}}else this._collectContextKeysForSubmenus&&(hl.getMenuItems(e.submenu).forEach(this._collectContextKeysAndSubmenuIds,this),this._allMenuIds.add(e.submenu))}static _fillInKbExprKeys(e,t){if(e)for(let n of e.keys())t.add(n)}},Ra=class extends xw{constructor(t,n,i,r,s,a){super(t,i);this._hiddenStates=n;this._commandService=r;this._keybindingService=s;this._contextKeyService=a;this.refresh()}createActionGroups(t){let n=[];for(let i of this._menuGroups){let[r,s]=i,a;for(let l of s)if(this._contextKeyService.contextMatchesRules(l.when)){let d=gu(l);d&&this._hiddenStates.setDefaultState(this._id,l.command.id,!!l.isHiddenByDefault);let c=Oz(this._id,d?l.command:l,this._hiddenStates);if(d){let u=o1(this._commandService,this._keybindingService,l.command.id,l.when);(a??=[]).push(new xi(l.command,l.alt,t,c,u,this._contextKeyService,this._commandService))}else{let u=new Ra(l.submenu,this._hiddenStates,this._collectContextKeysForSubmenus,this._commandService,this._keybindingService,this._contextKeyService).createActionGroups(t),h=In.join(...u.map(m=>m[1]));h.length>0&&(a??=[]).push(new Fi(l,c,h))}}a&&a.length>0&&n.push([r,a])}return n}_sort(t){return t.sort(Ra._compareMenuItems)}static _compareMenuItems(t,n){let i=t.group,r=n.group;if(i!==r){if(i){if(!r)return-1}else return 1;if(i==="navigation")return-1;if(r==="navigation")return 1;let l=i.localeCompare(r);if(l!==0)return l}let s=t.order||0,a=n.order||0;return s<a?-1:s>a?1:Ra._compareTitles(gu(t)?t.command.title:t.title,gu(n)?n.command.title:n.title)}static _compareTitles(t,n){let i=typeof t=="string"?t:t.original,r=typeof n=="string"?n:n.original;return i.localeCompare(r)}};Ra=R([S(3,or),S(4,un),S(5,ft)],Ra);var lp=class{_menuInfo;_disposables=new he;_onDidChange;onDidChange;constructor(e,t,n,i,r,s){this._menuInfo=new Ra(e,t,n.emitEventsForSubmenuChanges,i,r,s);let a=new Qt(()=>{this._menuInfo.refresh(),this._onDidChange.fire({menu:this,isStructuralChange:!0,isEnablementChange:!0,isToggleChange:!0})},n.eventDebounceDelay);this._disposables.add(a),this._disposables.add(hl.onDidChangeMenu(u=>{for(let h of this._menuInfo.allMenuIds)if(u.has(h)){a.schedule();break}}));let l=this._disposables.add(new he),d=u=>{let h=!1,m=!1,f=!1;for(let g of u)if(h=h||g.isStructuralChange,m=m||g.isEnablementChange,f=f||g.isToggleChange,h&&m&&f)break;return{menu:this,isStructuralChange:h,isEnablementChange:m,isToggleChange:f}},c=()=>{l.add(s.onDidChangeContext(u=>{let h=u.affectsSome(this._menuInfo.structureContextKeys),m=u.affectsSome(this._menuInfo.preconditionContextKeys),f=u.affectsSome(this._menuInfo.toggledContextKeys);(h||m||f)&&this._onDidChange.fire({menu:this,isStructuralChange:h,isEnablementChange:m,isToggleChange:f})})),l.add(t.onDidChange(u=>{this._onDidChange.fire({menu:this,isStructuralChange:!0,isEnablementChange:!1,isToggleChange:!1})}))};this._onDidChange=new jf({onWillAddFirstListener:c,onDidRemoveLastListener:l.clear.bind(l),delay:n.eventDebounceDelay,merge:d}),this.onDidChange=this._onDidChange.event}getActions(e){return this._menuInfo.createActionGroups(e)}dispose(){this._disposables.dispose(),this._onDidChange.dispose()}};lp=R([S(3,or),S(4,un),S(5,ft)],lp);function Oz(o,e,t){let n=dM(e)?e.submenu.id:e.id,i=typeof e.title=="string"?e.title:e.title.value,r=wi({id:`hide/${o.id}/${n}`,label:p("hide.label","Hide '{0}'",i),run(){t.updateHidden(o,n,!0)}}),s=wi({id:`toggle/${o.id}/${n}`,label:i,get checked(){return!t.isHidden(o,n)},run(){t.updateHidden(o,n,!!this.checked)}});return{hide:r,toggle:s,get isHidden(){return!s.checked}}}function o1(o,e,t,n=void 0,i=!0){return wi({id:`configureKeybinding/${t}`,label:p("configure keybinding","Configure Keybinding"),enabled:i,run(){let s=!!!e.lookupKeybinding(t)&&n?n.serialize():void 0;o.executeCommand("workbench.action.openGlobalKeybindings",`@command:${t}`+(s?` +when:${s}`:""))}})}var Dc=class extends Sw{constructor(t,n,i,r,s,a,l,d){super(t,s,{getKeyBinding:u=>a.lookupKeybinding(u.id)??void 0,...n,allowContextMenu:!0,skipTelemetry:typeof n?.telemetrySource=="string"});this._options=n;this._menuService=i;this._contextKeyService=r;this._contextMenuService=s;this._keybindingService=a;this._commandService=l;let c=n?.telemetrySource;c&&this._store.add(this.actionBar.onDidRun(u=>d.publicLog2("workbenchActionExecuted",{id:u.action.id,from:c})))}_sessionDisposables=this._store.add(new he);setActions(t,n=[],i){this._sessionDisposables.clear();let r=t.slice(),s=n.slice(),a=[],l=0,d=[],c=!1;if(this._options?.hiddenItemStrategy!==-1)for(let u=0;u<r.length;u++){let h=r[u];!(h instanceof xi)&&!(h instanceof Fi)||h.hideActions&&(a.push(h.hideActions.toggle),h.hideActions.toggle.checked&&l++,h.hideActions.isHidden&&(c=!0,r[u]=void 0,this._options?.hiddenItemStrategy!==0&&(d[u]=h)))}if(this._options?.overflowBehavior!==void 0){let u=w1(new Set(this._options.overflowBehavior.exempted),bo.map(r,f=>f?.id)),h=this._options.overflowBehavior.maxItems-u.size,m=0;for(let f=0;f<r.length;f++){let g=r[f];g&&(m++,!u.has(g.id)&&m>=h&&(r[f]=void 0,d[f]=g))}}Gw(r),Gw(d),super.setActions(r,In.join(d,s)),(a.length>0||r.length>0)&&this._sessionDisposables.add(U(this.getElement(),"contextmenu",u=>{let h=new hi(Ie(this.getElement()),u),m=this.getItemAction(h.target);if(!m)return;h.preventDefault(),h.stopPropagation();let f=[];if(m instanceof xi&&m.menuKeybinding)f.push(m.menuKeybinding);else if(!(m instanceof Fi||m instanceof ap)){let b=!!this._keybindingService.lookupKeybinding(m.id);f.push(o1(this._commandService,this._keybindingService,m.id,void 0,b))}if(a.length>0){let b=!1;if(l===1&&this._options?.hiddenItemStrategy===0){b=!0;for(let y=0;y<a.length;y++)if(a[y].checked){a[y]=wi({id:m.id,label:m.label,checked:!0,enabled:!1,run(){}});break}}if(!b&&(m instanceof xi||m instanceof Fi)){if(!m.hideActions)return;f.push(m.hideActions.hide)}else f.push(wi({id:"label",label:p("hide","Hide"),enabled:!1,run(){}}))}let g=In.join(f,a);this._options?.resetMenu&&!i&&(i=[this._options.resetMenu]),c&&i&&(g.push(new In),g.push(wi({id:"resetThisMenu",label:p("resetThisMenu","Reset Menu"),run:()=>this._menuService.resetHiddenStates(i)}))),g.length!==0&&this._contextMenuService.showContextMenu({getAnchor:()=>h,getActions:()=>g,menuId:this._options?.contextMenu,menuActionOptions:{renderShortTitle:!0,...this._options?.menuOptions},skipTelemetry:typeof this._options?.telemetrySource=="string",contextKeyService:this._contextKeyService})}))}};Dc=R([S(2,kd),S(3,ft),S(4,pr),S(5,un),S(6,or),S(7,Hn)],Dc);var dp=class extends Dc{_onDidChangeMenuItems=this._store.add(new E);onDidChangeMenuItems=this._onDidChangeMenuItems.event;constructor(e,t,n,i,r,s,a,l,d){super(e,{resetMenu:t,...n},i,r,s,a,l,d);let c=this._store.add(i.createMenu(t,r,{emitEventsForSubmenuChanges:!0})),u=()=>{let h=[],m=[];uf(c,n?.menuOptions,{primary:h,secondary:m},n?.toolbarOptions?.primaryGroup,n?.toolbarOptions?.shouldInlineSubmenu,n?.toolbarOptions?.useSeparatorsInPrimaryActions),e.classList.toggle("has-no-actions",h.length===0&&m.length===0),super.setActions(h,m)};this._store.add(c.onDidChange(()=>{u(),this._onDidChangeMenuItems.fire(this)})),u()}setActions(){throw new Qe("This toolbar is populated from a menu.")}};dp=R([S(3,kd),S(4,ft),S(5,pr),S(6,un),S(7,or),S(8,Hn)],dp);var Nz=p("defaultLabel","input"),Pz=p("label.preserveCaseToggle","Preserve Case"),r1=class extends La{constructor(e){super({icon:ge.preserveCase,title:Pz+e.appendTitle,isChecked:e.isChecked,hoverDelegate:e.hoverDelegate??Gt("element"),inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}},Ew=class extends On{constructor(t,n,i,r){super();this._showOptionButtons=i;this.contextViewProvider=n,this.placeholder=r.placeholder||"",this.validation=r.validation,this.label=r.label||Nz;let s=r.appendPreserveCaseLabel||"",a=r.history||[],l=!!r.flexibleHeight,d=!!r.flexibleWidth,c=r.flexibleMaxHeight;this.domNode=document.createElement("div"),this.domNode.classList.add("monaco-findInput"),this.inputBox=this._register(new Gl(this.domNode,this.contextViewProvider,{ariaLabel:this.label||"",placeholder:this.placeholder||"",validationOptions:{validation:this.validation},history:a,showHistoryHint:r.showHistoryHint,flexibleHeight:l,flexibleWidth:d,flexibleMaxHeight:c,inputBoxStyles:r.inputBoxStyles})),this.preserveCase=this._register(new r1({appendTitle:s,isChecked:!1,...r.toggleStyles})),this._register(this.preserveCase.onChange(m=>{this._onDidOptionChange.fire(m),!m&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this._register(this.preserveCase.onKeyDown(m=>{this._onPreserveCaseKeyDown.fire(m)})),this._showOptionButtons?this.cachedOptionsWidth=this.preserveCase.width():this.cachedOptionsWidth=0;let u=[this.preserveCase.domNode];this.onkeydown(this.domNode,m=>{if(m.equals(15)||m.equals(17)||m.equals(9)){let f=u.indexOf(this.domNode.ownerDocument.activeElement);if(f>=0){let g=-1;m.equals(17)?g=(f+1)%u.length:m.equals(15)&&(f===0?g=u.length-1:g=f-1),m.equals(9)?(u[f].blur(),this.inputBox.focus()):g>=0&&u[g].focus(),$e.stop(m,!0)}}});let h=document.createElement("div");h.className="controls",h.style.display=this._showOptionButtons?"block":"none",h.appendChild(this.preserveCase.domNode),this.domNode.appendChild(h),t?.appendChild(this.domNode),this.onkeydown(this.inputBox.inputElement,m=>this._onKeyDown.fire(m)),this.onkeyup(this.inputBox.inputElement,m=>this._onKeyUp.fire(m)),this.oninput(this.inputBox.inputElement,m=>this._onInput.fire()),this.onmousedown(this.inputBox.inputElement,m=>this._onMouseDown.fire(m))}static OPTION_CHANGE="optionChange";contextViewProvider;placeholder;validation;label;fixFocusOnOptionClickEnabled=!0;preserveCase;cachedOptionsWidth=0;domNode;inputBox;_onDidOptionChange=this._register(new E);onDidOptionChange=this._onDidOptionChange.event;_onKeyDown=this._register(new E);onKeyDown=this._onKeyDown.event;_onMouseDown=this._register(new E);onMouseDown=this._onMouseDown.event;_onInput=this._register(new E);onInput=this._onInput.event;_onKeyUp=this._register(new E);onKeyUp=this._onKeyUp.event;_onPreserveCaseKeyDown=this._register(new E);onPreserveCaseKeyDown=this._onPreserveCaseKeyDown.event;enable(){this.domNode.classList.remove("disabled"),this.inputBox.enable(),this.preserveCase.enable()}disable(){this.domNode.classList.add("disabled"),this.inputBox.disable(),this.preserveCase.disable()}setFocusInputOnOptionClick(t){this.fixFocusOnOptionClickEnabled=t}setEnabled(t){t?this.enable():this.disable()}clear(){this.clearValidation(),this.setValue(""),this.focus()}getValue(){return this.inputBox.value}setValue(t){this.inputBox.value!==t&&(this.inputBox.value=t)}onSearchSubmit(){this.inputBox.addToHistory()}applyStyles(){}select(){this.inputBox.select()}focus(){this.inputBox.focus()}getPreserveCase(){return this.preserveCase.checked}setPreserveCase(t){this.preserveCase.checked=t}focusOnPreserve(){this.preserveCase.focus()}_lastHighlightFindOptions=0;highlightFindOptions(){this.domNode.classList.remove("highlight-"+this._lastHighlightFindOptions),this._lastHighlightFindOptions=1-this._lastHighlightFindOptions,this.domNode.classList.add("highlight-"+this._lastHighlightFindOptions)}validate(){this.inputBox?.validate()}showMessage(t){this.inputBox?.showMessage(t)}clearMessage(){this.inputBox?.hideMessage()}clearValidation(){this.inputBox?.hideMessage()}set width(t){this.inputBox.paddingRight=this.cachedOptionsWidth,this.domNode.style.width=t+"px"}dispose(){super.dispose()}};var GF=new j("suggestWidgetVisible",!1,p("suggestWidgetVisible","Whether suggestion are visible")),s1="historyNavigationWidgetFocus",jF="historyNavigationForwardsEnabled",$F="historyNavigationBackwardsEnabled",hf,_w=[];function a1(o,e){if(_w.includes(e))throw new Error("Cannot register the same widget multiple times");_w.push(e);let t=new he,n=new j(s1,!1).bindTo(o),i=new j(jF,!0).bindTo(o),r=new j($F,!0).bindTo(o),s=()=>{n.set(!0),hf=e},a=()=>{n.set(!1),hf===e&&(hf=void 0)};return er(e.element)&&s(),t.add(e.onDidFocus(()=>s())),t.add(e.onDidBlur(()=>a())),t.add(ve(()=>{_w.splice(_w.indexOf(e),1),a()})),{historyNavigationForwardsEnablement:i,historyNavigationBackwardsEnablement:r,dispose(){t.dispose()}}}var cp=class extends Gl{constructor(e,t,n,i){super(e,t,n);let r=this._register(i.createScoped(this.element));this._register(a1(r,this))}};cp=R([S(3,ft)],cp);var Tw=class extends lf{constructor(e,t,n,i){super(e,t,n);let r=this._register(i.createScoped(this.inputBox.element));this._register(a1(r,this.inputBox))}};Tw=R([S(3,ft)],Tw);var Lw=class extends Ew{constructor(e,t,n,i,r=!1){super(e,t,r,n);let s=this._register(i.createScoped(this.inputBox.element));this._register(a1(s,this.inputBox))}};Lw=R([S(3,ft)],Lw);aa.registerCommandAndKeybindingRule({id:"history.showPrevious",weight:200,when:xt.and(xt.has(s1),xt.equals($F,!0),xt.not("isComposing"),GF.isEqualTo(!1)),primary:16,secondary:[528],handler:o=>{hf?.showPreviousValue()}});aa.registerCommandAndKeybindingRule({id:"history.showNext",weight:200,when:xt.and(xt.has(s1),xt.equals(jF,!0),xt.not("isComposing"),GF.isEqualTo(!1)),primary:18,secondary:[530],handler:o=>{hf?.showNextValue()}});function qF(o){return o.lookupKeybinding("history.showPrevious")?.getElectronAccelerator()==="Up"&&o.lookupKeybinding("history.showNext")?.getElectronAccelerator()==="Down"}var YF=new Ln("menu.view.filter"),ZF=new Ln("submenu.view.filter");hl.appendMenuItem(YF,{submenu:ZF,title:p("more filters","More Filters..."),group:"navigation",icon:ge.filter});var l1=class extends Lc{_checked=!1;set checked(e){this._checked!==e&&(this._checked=e,this.updateChecked())}updateChecked(){this.element&&this.element.classList.toggle("checked",this._checked)}render(e){super.render(e),this.updateChecked()}},up=class extends On{constructor(t,n,i,r,s){super();this.options=t;this.instantiationService=n;this.contextViewService=i;this.keybindingService=s;this.delayedFilterUpdate=new ls(400),this._register(ve(()=>this.delayedFilterUpdate.cancel())),t.focusContextKey&&(this.focusContextKey=new j(t.focusContextKey,!1).bindTo(r)),this.element=We(".viewpane-filter"),[this.filterInputBox,this.focusTracker]=this.createInput(this.element),this._register(this.filterInputBox),this._register(this.focusTracker);let a=Ke(this.element,We(".viewpane-filter-controls"));this.filterBadge=this.createBadge(a),this.toolbar=this._register(this.createToolBar(a)),this.adjustInputBox()}element;delayedFilterUpdate;filterInputBox;filterBadge;toolbar;focusContextKey;_onDidChangeFilterText=this._register(new E);onDidChangeFilterText=this._onDidChangeFilterText.event;moreFiltersActionViewItem;isMoreFiltersChecked=!1;lastWidth;focusTracker;get onDidFocus(){return this.focusTracker.onDidFocus}get onDidBlur(){return this.focusTracker.onDidBlur}hasFocus(){return this.filterInputBox.hasFocus()}focus(){this.filterInputBox.focus()}blur(){this.filterInputBox.blur()}updateBadge(t){this.filterBadge.classList.toggle("hidden",!t),this.filterBadge.textContent=t||"",this.adjustInputBox()}setFilterText(t){this.filterInputBox.value=t}getFilterText(){return this.filterInputBox.value}getHistory(){return this.filterInputBox.getHistory()}layout(t){this.element.parentElement?.classList.toggle("grow",t>700),this.element.classList.toggle("small",t<400),this.adjustInputBox(),this.lastWidth=t}relayout(){this.lastWidth&&this.layout(this.lastWidth)}checkMoreFilters(t){this.isMoreFiltersChecked=t,this.moreFiltersActionViewItem&&(this.moreFiltersActionViewItem.checked=t)}createInput(t){let n=this._register(this.instantiationService.createInstance(cp,t,this.contextViewService,{placeholder:this.options.placeholder,ariaLabel:this.options.ariaLabel,history:this.options.history||[],showHistoryHint:()=>qF(this.keybindingService),inputBoxStyles:n1}));this.options.text&&(n.value=this.options.text),this._register(n.onDidChange(r=>this.delayedFilterUpdate.trigger(()=>this.onDidInputChange(n)))),this._register(Jt(n.inputElement,ae.KEY_DOWN,r=>this.onInputKeyDown(r,n))),this._register(Jt(t,ae.KEY_DOWN,this.handleKeyboardEvent)),this._register(Jt(t,ae.KEY_UP,this.handleKeyboardEvent)),this._register(Jt(n.inputElement,ae.CLICK,r=>{r.stopPropagation(),r.preventDefault()}));let i=this._register(Ni(n.inputElement));return this.focusContextKey&&(this._register(i.onDidFocus(()=>this.focusContextKey.set(!0))),this._register(i.onDidBlur(()=>this.focusContextKey.set(!1))),this._register(ve(()=>this.focusContextKey.reset()))),[n,i]}createBadge(t){let n=Ke(t,We(".viewpane-filter-badge.hidden"));return n.style.backgroundColor=re(Cl),n.style.color=re(Qv),n.style.border=`1px solid ${re(be)}`,n}createToolBar(t){return this.instantiationService.createInstance(dp,t,YF,{hiddenItemStrategy:-1,actionViewItemProvider:(n,i)=>{if(n instanceof Fi&&n.item.submenu.id===ZF.id)return this.moreFiltersActionViewItem=this.instantiationService.createInstance(l1,n,i),this.moreFiltersActionViewItem.checked=this.isMoreFiltersChecked,this.moreFiltersActionViewItem}})}onDidInputChange(t){t.addToHistory(),this._onDidChangeFilterText.fire(t.value)}adjustInputBox(){this.filterInputBox.inputElement.style.paddingRight=this.element.classList.contains("small")||this.filterBadge.classList.contains("hidden")?"25px":"150px"}handleKeyboardEvent(t){(t.equals(10)||t.equals(15)||t.equals(17)||t.equals(14)||t.equals(13))&&t.stopPropagation()}onInputKeyDown(t,n){let i=!1;t.equals(2)&&!this.toolbar.isEmpty()&&(this.toolbar.focus(),i=!0),i&&(t.stopPropagation(),t.preventDefault())}};up=R([S(1,ct),S(2,sw),S(3,ft),S(4,un)],up);var rB=I("tab.activeBackground",lr,p("tabActiveBackground","Active tab background color in an active group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),m6t=I("tab.unfocusedActiveBackground",rB,p("tabUnfocusedActiveBackground","Active tab background color in an unfocused group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),Fz=I("tab.inactiveBackground",{dark:"#2D2D2D",light:"#ECECEC",hcDark:null,hcLight:null},p("tabInactiveBackground","Inactive tab background color in an active group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),g6t=I("tab.unfocusedInactiveBackground",Fz,p("tabUnfocusedInactiveBackground","Inactive tab background color in an unfocused group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),kc=I("tab.activeForeground",{dark:N.white,light:"#333333",hcDark:N.white,hcLight:"#292929"},p("tabActiveForeground","Active tab foreground color in an active group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),XF=I("tab.inactiveForeground",{dark:me(kc,.5),light:me(kc,.7),hcDark:N.white,hcLight:"#292929"},p("tabInactiveForeground","Inactive tab foreground color in an active group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),f6t=I("tab.unfocusedActiveForeground",{dark:me(kc,.5),light:me(kc,.7),hcDark:N.white,hcLight:"#292929"},p("tabUnfocusedActiveForeground","Active tab foreground color in an unfocused group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),b6t=I("tab.unfocusedInactiveForeground",{dark:me(XF,.5),light:me(XF,.5),hcDark:N.white,hcLight:"#292929"},p("tabUnfocusedInactiveForeground","Inactive tab foreground color in an unfocused group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),QF=I("tab.hoverBackground",null,p("tabHoverBackground","Tab background color when hovering. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),v6t=I("tab.unfocusedHoverBackground",{dark:me(QF,.5),light:me(QF,.7),hcDark:null,hcLight:null},p("tabUnfocusedHoverBackground","Tab background color in an unfocused group when hovering. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),JF=I("tab.hoverForeground",null,p("tabHoverForeground","Tab foreground color when hovering. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),y6t=I("tab.unfocusedHoverForeground",{dark:me(JF,.5),light:me(JF,.5),hcDark:null,hcLight:null},p("tabUnfocusedHoverForeground","Tab foreground color in an unfocused group when hovering. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),I6t=I("tab.border",{dark:"#252526",light:"#F3F3F3",hcDark:be,hcLight:be},p("tabBorder","Border to separate tabs from each other. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),C6t=I("tab.lastPinnedBorder",{dark:Vu,light:Vu,hcDark:be,hcLight:be},p("lastPinnedTabBorder","Border to separate pinned tabs from other tabs. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),eB=I("tab.activeBorder",null,p("tabActiveBorder","Border on the bottom of an active tab. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),S6t=I("tab.unfocusedActiveBorder",{dark:me(eB,.5),light:me(eB,.7),hcDark:null,hcLight:null},p("tabActiveUnfocusedBorder","Border on the bottom of an active tab in an unfocused group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),d1=I("tab.activeBorderTop",{dark:null,light:null,hcDark:null,hcLight:"#B5200D"},p("tabActiveBorderTop","Border to the top of an active tab. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),w6t=I("tab.unfocusedActiveBorderTop",{dark:me(d1,.5),light:me(d1,.7),hcDark:null,hcLight:"#B5200D"},p("tabActiveUnfocusedBorderTop","Border to the top of an active tab in an unfocused group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),x6t=I("tab.selectedBorderTop",d1,p("tabSelectedBorderTop","Border to the top of a selected tab. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),E6t=I("tab.selectedBackground",rB,p("tabSelectedBackground","Background of a selected tab. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),_6t=I("tab.selectedForeground",kc,p("tabSelectedForeground","Foreground of a selected tab. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),tB=I("tab.hoverBorder",null,p("tabHoverBorder","Border to highlight tabs when hovering. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),T6t=I("tab.unfocusedHoverBorder",{dark:me(tB,.5),light:me(tB,.7),hcDark:null,hcLight:be},p("tabUnfocusedHoverBorder","Border to highlight tabs in an unfocused group when hovering. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),L6t=I("tab.dragAndDropBorder",{dark:kc,light:kc,hcDark:Ct,hcLight:Ct},p("tabDragAndDropBorder","Border between tabs to indicate that a tab can be inserted between two tabs. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),kw=I("tab.activeModifiedBorder",{dark:"#3399CC",light:"#33AAEE",hcDark:null,hcLight:be},p("tabActiveModifiedBorder","Border on the top of modified active tabs in an active group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),nB=I("tab.inactiveModifiedBorder",{dark:me(kw,.5),light:me(kw,.5),hcDark:N.white,hcLight:be},p("tabInactiveModifiedBorder","Border on the top of modified inactive tabs in an active group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),D6t=I("tab.unfocusedActiveModifiedBorder",{dark:me(kw,.5),light:me(kw,.7),hcDark:N.white,hcLight:be},p("unfocusedActiveModifiedBorder","Border on the top of modified active tabs in an unfocused group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),k6t=I("tab.unfocusedInactiveModifiedBorder",{dark:me(nB,.5),light:me(nB,.5),hcDark:N.white,hcLight:be},p("unfocusedINactiveModifiedBorder","Border on the top of modified inactive tabs in an unfocused group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),R6t=I("editorPane.background",lr,p("editorPaneBackground","Background color of the editor pane visible on the left and right side of the centered editor layout.")),M6t=I("editorGroup.emptyBackground",null,p("editorGroupEmptyBackground","Background color of an empty editor group. Editor groups are the containers of editors.")),A6t=I("editorGroup.focusedEmptyBorder",{dark:null,light:null,hcDark:Li,hcLight:Li},p("editorGroupFocusedEmptyBorder","Border color of an empty editor group that is focused. Editor groups are the containers of editors.")),O6t=I("editorGroupHeader.tabsBackground",{dark:"#252526",light:"#F3F3F3",hcDark:null,hcLight:null},p("tabsContainerBackground","Background color of the editor group title header when tabs are enabled. Editor groups are the containers of editors.")),N6t=I("editorGroupHeader.tabsBorder",null,p("tabsContainerBorder","Border color of the editor group title header when tabs are enabled. Editor groups are the containers of editors.")),P6t=I("editorGroupHeader.noTabsBackground",lr,p("editorGroupHeaderBackground",'Background color of the editor group title header when (`"workbench.editor.showTabs": "single"`). Editor groups are the containers of editors.')),F6t=I("editorGroupHeader.border",{dark:null,light:null,hcDark:be,hcLight:be},p("editorTitleContainerBorder","Border color of the editor group title header. Editor groups are the containers of editors.")),sB=I("editorGroup.border",{dark:"#444444",light:"#E7E7E7",hcDark:be,hcLight:be},p("editorGroupBorder","Color to separate multiple editor groups from each other. Editor groups are the containers of editors.")),aB=I("editorGroup.dropBackground",{dark:N.fromHex("#53595D").transparent(.5),light:N.fromHex("#2677CB").transparent(.18),hcDark:null,hcLight:N.fromHex("#0F4A85").transparent(.5)},p("editorDragAndDropBackground","Background color when dragging editors around. The color should have transparency so that the editor contents can still shine through.")),B6t=I("editorGroup.dropIntoPromptForeground",_s,p("editorDropIntoPromptForeground","Foreground color of text shown over editors when dragging files. This text informs the user that they can hold shift to drop into the editor.")),V6t=I("editorGroup.dropIntoPromptBackground",ei,p("editorDropIntoPromptBackground","Background color of text shown over editors when dragging files. This text informs the user that they can hold shift to drop into the editor.")),W6t=I("editorGroup.dropIntoPromptBorder",{dark:null,light:null,hcDark:be,hcLight:be},p("editorDropIntoPromptBorder","Border color of text shown over editors when dragging files. This text informs the user that they can hold shift to drop into the editor.")),H6t=I("sideBySideEditor.horizontalBorder",sB,p("sideBySideEditor.horizontalBorder","Color to separate two editors from each other when shown side by side in an editor group from top to bottom.")),U6t=I("sideBySideEditor.verticalBorder",sB,p("sideBySideEditor.verticalBorder","Color to separate two editors from each other when shown side by side in an editor group from left to right.")),c1=I("panel.background",lr,p("panelBackground","Panel background color. Panels are shown below the editor area and contain views like output and integrated terminal.")),Bz=I("panel.border",{dark:N.fromHex("#808080").transparent(.35),light:N.fromHex("#808080").transparent(.35),hcDark:be,hcLight:be},p("panelBorder","Panel border color to separate the panel from the editor. Panels are shown below the editor area and contain views like output and integrated terminal.")),pf=I("panelTitle.activeForeground",{dark:"#E7E7E7",light:"#424242",hcDark:N.white,hcLight:Es},p("panelActiveTitleForeground","Title color for the active panel. Panels are shown below the editor area and contain views like output and integrated terminal.")),z6t=I("panelTitle.inactiveForeground",{dark:me(pf,.6),light:me(pf,.75),hcDark:N.white,hcLight:Es},p("panelInactiveTitleForeground","Title color for the inactive panel. Panels are shown below the editor area and contain views like output and integrated terminal.")),K6t=I("panelTitle.activeBorder",{dark:pf,light:pf,hcDark:be,hcLight:"#B5200D"},p("panelActiveTitleBorder","Border color for the active panel title. Panels are shown below the editor area and contain views like output and integrated terminal.")),G6t=I("panelInput.border",{dark:Fu,light:N.fromHex("#ddd"),hcDark:Fu,hcLight:Fu},p("panelInputBorder","Input box border for inputs in the panel.")),j6t=I("panel.dropBorder",pf,p("panelDragAndDropBorder","Drag and drop feedback color for the panel titles. Panels are shown below the editor area and contain views like output and integrated terminal.")),$6t=I("panelSection.dropBackground",aB,p("panelSectionDragAndDropBackground","Drag and drop feedback color for the panel sections. The color should have transparency so that the panel sections can still shine through. Panels are shown below the editor area and contain views like output and integrated terminal. Panel sections are views nested within the panels.")),q6t=I("panelSectionHeader.background",{dark:N.fromHex("#808080").transparent(.2),light:N.fromHex("#808080").transparent(.2),hcDark:null,hcLight:null},p("panelSectionHeaderBackground","Panel section header background color. Panels are shown below the editor area and contain views like output and integrated terminal. Panel sections are views nested within the panels.")),Y6t=I("panelSectionHeader.foreground",null,p("panelSectionHeaderForeground","Panel section header foreground color. Panels are shown below the editor area and contain views like output and integrated terminal. Panel sections are views nested within the panels.")),Z6t=I("panelSectionHeader.border",be,p("panelSectionHeaderBorder","Panel section header border color used when multiple views are stacked vertically in the panel. Panels are shown below the editor area and contain views like output and integrated terminal. Panel sections are views nested within the panels.")),X6t=I("panelSection.border",Bz,p("panelSectionBorder","Panel section border color used when multiple views are stacked horizontally in the panel. Panels are shown below the editor area and contain views like output and integrated terminal. Panel sections are views nested within the panels.")),lB=I("panelStickyScroll.background",c1,p("panelStickyScrollBackground","Background color of sticky scroll in the panel.")),dB=I("panelStickyScroll.border",null,p("panelStickyScrollBorder","Border color of sticky scroll in the panel.")),cB=I("panelStickyScroll.shadow",Sl,p("panelStickyScrollShadow","Shadow color of sticky scroll in the panel.")),Vz=I("outputView.background",null,p("outputViewBackground","Output view background color."));I("outputViewStickyScroll.background",Vz,p("outputViewStickyScrollBackground","Output view sticky scroll background color."));var Q6t=I("banner.background",{dark:ro,light:Ti(ro,.3),hcDark:ro,hcLight:ro},p("banner.background","Banner background color. The banner is shown under the title bar of the window.")),J6t=I("banner.foreground",Ts,p("banner.foreground","Banner foreground color. The banner is shown under the title bar of the window.")),eKt=I("banner.iconForeground",To,p("banner.iconForeground","Banner icon color. The banner is shown under the title bar of the window.")),$l=I("statusBar.foreground",{dark:"#FFFFFF",light:"#FFFFFF",hcDark:"#FFFFFF",hcLight:Es},p("statusBarForeground","Status bar foreground color when a workspace or folder is opened. The status bar is shown in the bottom of the window.")),tKt=I("statusBar.noFolderForeground",$l,p("statusBarNoFolderForeground","Status bar foreground color when no folder is opened. The status bar is shown in the bottom of the window.")),nKt=I("statusBar.background",{dark:"#007ACC",light:"#007ACC",hcDark:null,hcLight:null},p("statusBarBackground","Status bar background color when a workspace or folder is opened. The status bar is shown in the bottom of the window.")),iKt=I("statusBar.noFolderBackground",{dark:"#68217A",light:"#68217A",hcDark:null,hcLight:null},p("statusBarNoFolderBackground","Status bar background color when no folder is opened. The status bar is shown in the bottom of the window.")),Wz=I("statusBar.border",{dark:null,light:null,hcDark:be,hcLight:be},p("statusBarBorder","Status bar border color separating to the sidebar and editor. The status bar is shown in the bottom of the window.")),oKt=I("statusBar.focusBorder",{dark:$l,light:$l,hcDark:null,hcLight:$l},p("statusBarFocusBorder","Status bar border color when focused on keyboard navigation. The status bar is shown in the bottom of the window.")),rKt=I("statusBar.noFolderBorder",Wz,p("statusBarNoFolderBorder","Status bar border color separating to the sidebar and editor when no folder is opened. The status bar is shown in the bottom of the window.")),sKt=I("statusBarItem.activeBackground",{dark:N.white.transparent(.18),light:N.white.transparent(.18),hcDark:N.white.transparent(.18),hcLight:N.black.transparent(.18)},p("statusBarItemActiveBackground","Status bar item background color when clicking. The status bar is shown in the bottom of the window.")),aKt=I("statusBarItem.focusBorder",{dark:$l,light:$l,hcDark:null,hcLight:Ct},p("statusBarItemFocusBorder","Status bar item border color when focused on keyboard navigation. The status bar is shown in the bottom of the window.")),ql=I("statusBarItem.hoverBackground",{dark:N.white.transparent(.12),light:N.white.transparent(.12),hcDark:N.white.transparent(.12),hcLight:N.black.transparent(.12)},p("statusBarItemHoverBackground","Status bar item background color when hovering. The status bar is shown in the bottom of the window.")),gf=I("statusBarItem.hoverForeground",$l,p("statusBarItemHoverForeground","Status bar item foreground color when hovering. The status bar is shown in the bottom of the window.")),lKt=I("statusBarItem.compactHoverBackground",{dark:N.white.transparent(.2),light:N.white.transparent(.2),hcDark:N.white.transparent(.2),hcLight:N.black.transparent(.2)},p("statusBarItemCompactHoverBackground","Status bar item background color when hovering an item that contains two hovers. The status bar is shown in the bottom of the window.")),dKt=I("statusBarItem.prominentForeground",$l,p("statusBarProminentItemForeground","Status bar prominent items foreground color. Prominent items stand out from other status bar entries to indicate importance. The status bar is shown in the bottom of the window.")),cKt=I("statusBarItem.prominentBackground",N.black.transparent(.5),p("statusBarProminentItemBackground","Status bar prominent items background color. Prominent items stand out from other status bar entries to indicate importance. The status bar is shown in the bottom of the window.")),uKt=I("statusBarItem.prominentHoverForeground",gf,p("statusBarProminentItemHoverForeground","Status bar prominent items foreground color when hovering. Prominent items stand out from other status bar entries to indicate importance. The status bar is shown in the bottom of the window.")),hKt=I("statusBarItem.prominentHoverBackground",{dark:N.black.transparent(.3),light:N.black.transparent(.3),hcDark:N.black.transparent(.3),hcLight:null},p("statusBarProminentItemHoverBackground","Status bar prominent items background color when hovering. Prominent items stand out from other status bar entries to indicate importance. The status bar is shown in the bottom of the window.")),pKt=I("statusBarItem.errorBackground",{dark:Ti(dT,.4),light:Ti(dT,.4),hcDark:null,hcLight:"#B5200D"},p("statusBarErrorItemBackground","Status bar error items background color. Error items stand out from other status bar entries to indicate error conditions. The status bar is shown in the bottom of the window.")),mKt=I("statusBarItem.errorForeground",N.white,p("statusBarErrorItemForeground","Status bar error items foreground color. Error items stand out from other status bar entries to indicate error conditions. The status bar is shown in the bottom of the window.")),gKt=I("statusBarItem.errorHoverForeground",gf,p("statusBarErrorItemHoverForeground","Status bar error items foreground color when hovering. Error items stand out from other status bar entries to indicate error conditions. The status bar is shown in the bottom of the window.")),fKt=I("statusBarItem.errorHoverBackground",ql,p("statusBarErrorItemHoverBackground","Status bar error items background color when hovering. Error items stand out from other status bar entries to indicate error conditions. The status bar is shown in the bottom of the window.")),bKt=I("statusBarItem.warningBackground",{dark:Ti(Hi,.4),light:Ti(Hi,.4),hcDark:null,hcLight:"#895503"},p("statusBarWarningItemBackground","Status bar warning items background color. Warning items stand out from other status bar entries to indicate warning conditions. The status bar is shown in the bottom of the window.")),vKt=I("statusBarItem.warningForeground",N.white,p("statusBarWarningItemForeground","Status bar warning items foreground color. Warning items stand out from other status bar entries to indicate warning conditions. The status bar is shown in the bottom of the window.")),yKt=I("statusBarItem.warningHoverForeground",gf,p("statusBarWarningItemHoverForeground","Status bar warning items foreground color when hovering. Warning items stand out from other status bar entries to indicate warning conditions. The status bar is shown in the bottom of the window.")),IKt=I("statusBarItem.warningHoverBackground",ql,p("statusBarWarningItemHoverBackground","Status bar warning items background color when hovering. Warning items stand out from other status bar entries to indicate warning conditions. The status bar is shown in the bottom of the window.")),CKt=I("activityBar.background",{dark:"#333333",light:"#2C2C2C",hcDark:"#000000",hcLight:"#FFFFFF"},p("activityBarBackground","Activity bar background color. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),hp=I("activityBar.foreground",{dark:N.white,light:N.white,hcDark:N.white,hcLight:Es},p("activityBarForeground","Activity bar item foreground color when it is active. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),SKt=I("activityBar.inactiveForeground",{dark:me(hp,.4),light:me(hp,.4),hcDark:N.white,hcLight:Es},p("activityBarInActiveForeground","Activity bar item foreground color when it is inactive. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),wKt=I("activityBar.border",{dark:null,light:null,hcDark:be,hcLight:be},p("activityBarBorder","Activity bar border color separating to the side bar. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),xKt=I("activityBar.activeBorder",{dark:hp,light:hp,hcDark:be,hcLight:be},p("activityBarActiveBorder","Activity bar border color for the active item. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),EKt=I("activityBar.activeFocusBorder",{dark:null,light:null,hcDark:null,hcLight:"#B5200D"},p("activityBarActiveFocusBorder","Activity bar focus border color for the active item. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),_Kt=I("activityBar.activeBackground",null,p("activityBarActiveBackground","Activity bar background color for the active item. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),TKt=I("activityBar.dropBorder",{dark:hp,light:hp,hcDark:null,hcLight:null},p("activityBarDragAndDropBorder","Drag and drop feedback color for the activity bar items. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),uB=I("activityBarBadge.background",{dark:"#007ACC",light:"#007ACC",hcDark:"#000000",hcLight:"#0F4A85"},p("activityBarBadgeBackground","Activity notification badge background color. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),hB=I("activityBarBadge.foreground",N.white,p("activityBarBadgeForeground","Activity notification badge foreground color. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),mf=I("activityBarTop.foreground",{dark:"#E7E7E7",light:"#424242",hcDark:N.white,hcLight:Es},p("activityBarTop","Active foreground color of the item in the Activity bar when it is on top / bottom. The activity allows to switch between views of the side bar.")),LKt=I("activityBarTop.activeBorder",{dark:mf,light:mf,hcDark:be,hcLight:"#B5200D"},p("activityBarTopActiveFocusBorder","Focus border color for the active item in the Activity bar when it is on top / bottom. The activity allows to switch between views of the side bar.")),DKt=I("activityBarTop.activeBackground",null,p("activityBarTopActiveBackground","Background color for the active item in the Activity bar when it is on top / bottom. The activity allows to switch between views of the side bar.")),kKt=I("activityBarTop.inactiveForeground",{dark:me(mf,.6),light:me(mf,.75),hcDark:N.white,hcLight:Es},p("activityBarTopInActiveForeground","Inactive foreground color of the item in the Activity bar when it is on top / bottom. The activity allows to switch between views of the side bar.")),RKt=I("activityBarTop.dropBorder",mf,p("activityBarTopDragAndDropBorder","Drag and drop feedback color for the items in the Activity bar when it is on top / bottom. The activity allows to switch between views of the side bar.")),MKt=I("activityBarTop.background",null,p("activityBarTopBackground","Background color of the activity bar when set to top / bottom.")),AKt=I("profileBadge.background",{dark:"#4D4D4D",light:"#C4C4C4",hcDark:N.white,hcLight:N.black},p("profileBadgeBackground","Profile badge background color. The profile badge shows on top of the settings gear icon in the activity bar.")),OKt=I("profileBadge.foreground",{dark:N.white,light:"#333333",hcDark:N.black,hcLight:N.white},p("profileBadgeForeground","Profile badge foreground color. The profile badge shows on top of the settings gear icon in the activity bar.")),NKt=I("statusBarItem.remoteBackground",uB,p("statusBarItemHostBackground","Background color for the remote indicator on the status bar.")),Hz=I("statusBarItem.remoteForeground",hB,p("statusBarItemHostForeground","Foreground color for the remote indicator on the status bar.")),PKt=I("statusBarItem.remoteHoverForeground",gf,p("statusBarRemoteItemHoverForeground","Foreground color for the remote indicator on the status bar when hovering.")),FKt=I("statusBarItem.remoteHoverBackground",{dark:ql,light:ql,hcDark:ql,hcLight:null},p("statusBarRemoteItemHoverBackground","Background color for the remote indicator on the status bar when hovering.")),BKt=I("statusBarItem.offlineBackground","#6c1717",p("statusBarItemOfflineBackground","Status bar item background color when the workbench is offline.")),VKt=I("statusBarItem.offlineForeground",Hz,p("statusBarItemOfflineForeground","Status bar item foreground color when the workbench is offline.")),WKt=I("statusBarItem.offlineHoverForeground",gf,p("statusBarOfflineItemHoverForeground","Status bar item foreground hover color when the workbench is offline.")),HKt=I("statusBarItem.offlineHoverBackground",{dark:ql,light:ql,hcDark:ql,hcLight:null},p("statusBarOfflineItemHoverBackground","Status bar item background hover color when the workbench is offline.")),UKt=I("extensionBadge.remoteBackground",uB,p("extensionBadge.remoteBackground","Background color for the remote badge in the extensions view.")),zKt=I("extensionBadge.remoteForeground",hB,p("extensionBadge.remoteForeground","Foreground color for the remote badge in the extensions view.")),Rw=I("sideBar.background",{dark:"#252526",light:"#F3F3F3",hcDark:"#000000",hcLight:"#FFFFFF"},p("sideBarBackground","Side bar background color. The side bar is the container for views like explorer and search.")),pB=I("sideBar.foreground",null,p("sideBarForeground","Side bar foreground color. The side bar is the container for views like explorer and search.")),KKt=I("sideBar.border",{dark:null,light:null,hcDark:be,hcLight:be},p("sideBarBorder","Side bar border color on the side separating to the editor. The side bar is the container for views like explorer and search.")),GKt=I("sideBarTitle.background",Rw,p("sideBarTitleBackground","Side bar title background color. The side bar is the container for views like explorer and search.")),jKt=I("sideBarTitle.foreground",pB,p("sideBarTitleForeground","Side bar title foreground color. The side bar is the container for views like explorer and search.")),$Kt=I("sideBar.dropBackground",aB,p("sideBarDragAndDropBackground","Drag and drop feedback color for the side bar sections. The color should have transparency so that the side bar sections can still shine through. The side bar is the container for views like explorer and search. Side bar sections are views nested within the side bar.")),qKt=I("sideBarSectionHeader.background",{dark:N.fromHex("#808080").transparent(.2),light:N.fromHex("#808080").transparent(.2),hcDark:null,hcLight:null},p("sideBarSectionHeaderBackground","Side bar section header background color. The side bar is the container for views like explorer and search. Side bar sections are views nested within the side bar.")),YKt=I("sideBarSectionHeader.foreground",pB,p("sideBarSectionHeaderForeground","Side bar section header foreground color. The side bar is the container for views like explorer and search. Side bar sections are views nested within the side bar.")),Uz=I("sideBarSectionHeader.border",be,p("sideBarSectionHeaderBorder","Side bar section header border color. The side bar is the container for views like explorer and search. Side bar sections are views nested within the side bar.")),ZKt=I("sideBarActivityBarTop.border",Uz,p("sideBarActivityBarTopBorder","Border color between the activity bar at the top/bottom and the views.")),mB=I("sideBarStickyScroll.background",Rw,p("sideBarStickyScrollBackground","Background color of sticky scroll in the side bar.")),gB=I("sideBarStickyScroll.border",null,p("sideBarStickyScrollBorder","Border color of sticky scroll in the side bar.")),fB=I("sideBarStickyScroll.shadow",Sl,p("sideBarStickyScrollShadow","Shadow color of sticky scroll in the side bar.")),js=I("titleBar.activeForeground",{dark:"#CCCCCC",light:"#333333",hcDark:"#FFFFFF",hcLight:"#292929"},p("titleBarActiveForeground","Title bar foreground when the window is active.")),bB=I("titleBar.inactiveForeground",{dark:me(js,.6),light:me(js,.6),hcDark:null,hcLight:"#292929"},p("titleBarInactiveForeground","Title bar foreground when the window is inactive.")),iB=I("titleBar.activeBackground",{dark:"#3C3C3C",light:"#DDDDDD",hcDark:"#000000",hcLight:"#FFFFFF"},p("titleBarActiveBackground","Title bar background when the window is active.")),XKt=I("titleBar.inactiveBackground",{dark:me(iB,.6),light:me(iB,.6),hcDark:null,hcLight:null},p("titleBarInactiveBackground","Title bar background when the window is inactive.")),QKt=I("titleBar.border",{dark:null,light:null,hcDark:be,hcLight:be},p("titleBarBorder","Title bar border color.")),zz=I("menubar.selectionForeground",js,p("menubarSelectionForeground","Foreground color of the selected menu item in the menubar.")),oB=I("menubar.selectionBackground",{dark:Hm,light:Hm,hcDark:null,hcLight:null},p("menubarSelectionBackground","Background color of the selected menu item in the menubar.")),JKt=I("menubar.selectionBorder",{dark:null,light:null,hcDark:Ct,hcLight:Ct},p("menubarSelectionBorder","Border color of the selected menu item in the menubar.")),eGt=I("commandCenter.foreground",js,p("commandCenter-foreground","Foreground color of the command center"),!1),tGt=I("commandCenter.activeForeground",zz,p("commandCenter-activeForeground","Active foreground color of the command center"),!1),nGt=I("commandCenter.inactiveForeground",bB,p("commandCenter-inactiveForeground","Foreground color of the command center when the window is inactive"),!1),iGt=I("commandCenter.background",{dark:N.white.transparent(.05),hcDark:null,light:N.black.transparent(.05),hcLight:null},p("commandCenter-background","Background color of the command center"),!1),oGt=I("commandCenter.activeBackground",{dark:N.white.transparent(.08),hcDark:oB,light:N.black.transparent(.08),hcLight:oB},p("commandCenter-activeBackground","Active background color of the command center"),!1),rGt=I("commandCenter.border",{dark:me(js,.2),hcDark:be,light:me(js,.2),hcLight:be},p("commandCenter-border","Border color of the command center"),!1),sGt=I("commandCenter.activeBorder",{dark:me(js,.3),hcDark:js,light:me(js,.3),hcLight:js},p("commandCenter-activeBorder","Active border color of the command center"),!1),aGt=I("commandCenter.inactiveBorder",me(bB,.25),p("commandCenter-inactiveBorder","Border color of the command center when the window is inactive"),!1),lGt=I("notificationCenter.border",{dark:Um,light:Um,hcDark:be,hcLight:be},p("notificationCenterBorder","Notifications center border color. Notifications slide in from the bottom right of the window.")),dGt=I("notificationToast.border",{dark:Um,light:Um,hcDark:be,hcLight:be},p("notificationToastBorder","Notification toast border color. Notifications slide in from the bottom right of the window.")),cGt=I("notifications.foreground",_s,p("notificationsForeground","Notifications foreground color. Notifications slide in from the bottom right of the window.")),Dw=I("notifications.background",ei,p("notificationsBackground","Notifications background color. Notifications slide in from the bottom right of the window.")),uGt=I("notificationLink.foreground",Xv,p("notificationsLink","Notification links foreground color. Notifications slide in from the bottom right of the window.")),hGt=I("notificationCenterHeader.foreground",null,p("notificationCenterHeaderForeground","Notifications center header foreground color. Notifications slide in from the bottom right of the window.")),Kz=I("notificationCenterHeader.background",{dark:Wi(Dw,.3),light:Ti(Dw,.05),hcDark:Dw,hcLight:Dw},p("notificationCenterHeaderBackground","Notifications center header background color. Notifications slide in from the bottom right of the window.")),pGt=I("notifications.border",Kz,p("notificationsBorder","Notifications border color separating from other notifications in the notifications center. Notifications slide in from the bottom right of the window.")),mGt=I("notificationsErrorIcon.foreground",Vd,p("notificationsErrorIconForeground","The color used for the icon of error notifications. Notifications slide in from the bottom right of the window.")),gGt=I("notificationsWarningIcon.foreground",Hi,p("notificationsWarningIconForeground","The color used for the icon of warning notifications. Notifications slide in from the bottom right of the window.")),fGt=I("notificationsInfoIcon.foreground",To,p("notificationsInfoIconForeground","The color used for the icon of info notifications. Notifications slide in from the bottom right of the window.")),bGt=I("window.activeBorder",{dark:null,light:null,hcDark:be,hcLight:be},p("windowActiveBorder","The color used for the border of the window when it is active. Only supported in the macOS and Linux desktop client when using the custom title bar.")),vGt=I("window.inactiveBorder",{dark:null,light:null,hcDark:be,hcLight:be},p("windowInactiveBorder","The color used for the border of the window when it is inactive. Only supported in the macOS and Linux desktop client when using the custom title bar."));var xGt=Y("accessibleViewInformationService"),Mw=class extends V{constructor(t){super();this._storageService=t}hasShownAccessibleView(t){return this._storageService.getBoolean(`${JR}${t}`,-1,!1)===!0}};Mw=R([S(0,zn)],Mw);var vB=new ir("viewpane.action.filter"),Gz=xl("view-pane-container-expanded",ge.chevronDown,p("viewPaneContainerExpandedIcon","Icon for an expanded view pane container.")),jz=xl("view-pane-container-collapsed",ge.chevronRight,p("viewPaneContainerCollapsedIcon","Icon for a collapsed view pane container.")),yB=et.as(of.ViewsRegistry),ff=class{constructor(e,t,n,i,r,s,a){this.container=e;this.delegate=t;this.instantiationService=n;this.openerService=i;this.telemetryService=r;this.contextKeyService=s;this.disposables.add(oe.runAndSubscribe(this.delegate.onDidChangeViewWelcomeState,()=>this.onDidChangeViewWelcomeState())),this.disposables.add(a.onWillShutdown(()=>this.dispose()))}defaultItem;items=[];get enabled(){return this._enabled}_enabled=!1;element;scrollableElement;disposables=new he;enabledDisposables=this.disposables.add(new he);renderDisposables=this.disposables.add(new he);layout(e,t){this._enabled&&(this.element.style.height=`${e}px`,this.element.style.width=`${t}px`,this.element.classList.toggle("wide",t>640),this.scrollableElement.scanDomNode())}focus(){this._enabled&&this.element.focus()}onDidChangeViewWelcomeState(){let e=this.delegate.shouldShowWelcome();if(this._enabled===e)return;if(this._enabled=e,!e){this.enabledDisposables.clear();return}this.container.classList.add("welcome");let t=Ke(this.container,We(".welcome-view"));this.element=We(".welcome-view-content",{tabIndex:0}),this.scrollableElement=new mc(this.element,{alwaysConsumeMouseWheel:!0,horizontal:2,vertical:3}),Ke(t,this.scrollableElement.getDomNode()),this.enabledDisposables.add(ve(()=>{this.container.classList.remove("welcome"),this.scrollableElement.dispose(),t.remove(),this.scrollableElement=void 0,this.element=void 0})),this.contextKeyService.onDidChangeContext(this.onDidChangeContext,this,this.enabledDisposables),oe.chain(yB.onDidChangeViewWelcomeContent,n=>n.filter(i=>i===this.delegate.id))(this.onDidChangeViewWelcomeContent,this,this.enabledDisposables),this.onDidChangeViewWelcomeContent()}onDidChangeViewWelcomeContent(){let e=yB.getViewWelcomeContent(this.delegate.id);this.items=[];for(let t of e)if(t.when==="default")this.defaultItem={descriptor:t,visible:!0};else{let n=t.when?this.contextKeyService.contextMatchesRules(t.when):!0;this.items.push({descriptor:t,visible:n})}this.render()}onDidChangeContext(){let e=!1;for(let t of this.items){if(!t.descriptor.when||t.descriptor.when==="default")continue;let n=this.contextKeyService.contextMatchesRules(t.descriptor.when);t.visible!==n&&(t.visible=n,e=!0)}e&&this.render()}render(){this.renderDisposables.clear(),this.element.innerText="";let e=this.getContentDescriptors();if(e.length===0){this.container.classList.remove("welcome"),this.scrollableElement.scanDomNode();return}for(let{content:t,precondition:n}of e){let i=t.split(`
`);for(let r of i){if(r=r.trim(),!r)continue;let s=KF(r);if(s.nodes.length===1&&typeof s.nodes[0]!="string"){let a=s.nodes[0],l=Ke(this.element,We(".button-container")),d=new sf(l,{title:a.title,supportIcons:!0,...WF});if(d.label=a.label,d.onDidClick(c=>{this.telemetryService.publicLog2("views.welcomeAction",{viewId:this.delegate.id,uri:a.href}),this.openerService.open(a.href,{allowCommands:!0})},null,this.renderDisposables),this.renderDisposables.add(d),n){let c=()=>d.enabled=this.contextKeyService.contextMatchesRules(n);c();let u=new Set(n.keys());oe.filter(this.contextKeyService.onDidChangeContext,m=>m.affectsSome(u))(c,null,this.renderDisposables)}}else{let a=Ke(this.element,We("p"));for(let l of s.nodes)if(typeof l=="string")Ke(a,document.createTextNode(l));else{let d=this.renderDisposables.add(this.instantiationService.createInstance(rp,a,l,{}));if(n&&l.href.startsWith("command:")){let c=()=>d.enabled=this.contextKeyService.contextMatchesRules(n);c();let u=new Set(n.keys());oe.filter(this.contextKeyService.onDidChangeContext,m=>m.affectsSome(u))(c,null,this.renderDisposables)}}}}}this.container.classList.add("welcome"),this.scrollableElement.scanDomNode()}getContentDescriptors(){let e=this.items.filter(t=>t.visible);return e.length===0&&this.defaultItem?[this.defaultItem.descriptor]:e.map(t=>t.descriptor)}dispose(){this.disposables.dispose()}};ff=R([S(2,ct),S(3,Us),S(4,Hn),S(5,ft),S(6,zs)],ff);var Ma=class extends aw{constructor(t,n,i,r,s,a,l,d,c,u,h,m){super({...t,orientation:a.getViewLocationById(t.id)===1?1:0});this.keybindingService=n;this.contextMenuService=i;this.configurationService=r;this.contextKeyService=s;this.viewDescriptorService=a;this.instantiationService=l;this.openerService=d;this.themeService=c;this.telemetryService=u;this.hoverService=h;this.accessibleViewInformationService=m;this.id=t.id,this._title=t.title,this._titleDescription=t.titleDescription,this._singleViewPaneContainerTitle=t.singleViewPaneContainerTitle,this.showActions=t.showActions??0,this.scopedContextKeyService=this._register(s.createScoped(this.element)),this.scopedContextKeyService.createKey("view",this.id);let f=this.scopedContextKeyService.createKey("viewLocation",Z0(a.getViewLocationById(this.id)));this._register(oe.filter(a.onDidChangeLocation,b=>b.views.some(y=>y.id===this.id))(()=>f.set(Z0(a.getViewLocationById(this.id)))));let g=this._register(this.instantiationService.createChild(new ra([ft,this.scopedContextKeyService])));this.menuActions=this._register(g.createInstance(sp,t.titleMenuId??Ln.ViewTitle,Ln.ViewTitleContext,{shouldForwardArgs:!t.donotForwardArgs,renderShortTitle:!0})),this._register(this.menuActions.onDidChange(()=>this.updateActions()))}static AlwaysShowActionsConfig="workbench.view.alwaysShowHeaderActions";_onDidFocus=this._register(new E);onDidFocus=this._onDidFocus.event;_onDidBlur=this._register(new E);onDidBlur=this._onDidBlur.event;_onDidChangeBodyVisibility=this._register(new E);onDidChangeBodyVisibility=this._onDidChangeBodyVisibility.event;_onDidChangeTitleArea=this._register(new E);onDidChangeTitleArea=this._onDidChangeTitleArea.event;_onDidChangeViewWelcomeState=this._register(new E);onDidChangeViewWelcomeState=this._onDidChangeViewWelcomeState.event;_isVisible=!1;id;_title;get title(){return this._title}_titleDescription;get titleDescription(){return this._titleDescription}_singleViewPaneContainerTitle;get singleViewPaneContainerTitle(){return this._singleViewPaneContainerTitle}menuActions;progressBar;progressIndicator;toolbar;showActions;headerContainer;titleContainer;titleContainerHover;titleDescriptionContainer;titleDescriptionContainerHover;iconContainer;iconContainerHover;twistiesContainer;viewWelcomeController;scopedContextKeyService;get headerVisible(){return super.headerVisible}set headerVisible(t){super.headerVisible=t,this.element.classList.toggle("merged-header",!t)}setVisible(t){this._isVisible!==t&&(this._isVisible=t,this.isExpanded()&&this._onDidChangeBodyVisibility.fire(t))}isVisible(){return this._isVisible}isBodyVisible(){return this._isVisible&&this.isExpanded()}setExpanded(t){let n=super.setExpanded(t);return n&&this._onDidChangeBodyVisibility.fire(t),this.updateTwistyIcon(),n}render(){super.render();let t=Ni(this.element);this._register(t),this._register(t.onDidFocus(()=>this._onDidFocus.fire())),this._register(t.onDidBlur(()=>this._onDidBlur.fire()))}renderHeader(t){this.headerContainer=t,this.twistiesContainer=Ke(t,We(`.twisty-container${Je.asCSSSelector(this.getTwistyIcon(this.isExpanded()))}`)),this.renderHeaderTitle(t,this.title);let n=Ke(t,We(".actions"));n.classList.toggle("show-always",this.showActions===2),n.classList.toggle("show-expanded",this.showActions===1),this.toolbar=this.instantiationService.createInstance(Dc,n,{orientation:0,actionViewItemProvider:(s,a)=>this.getActionViewItem(s,a),ariaLabel:p("viewToolbarAriaLabel","{0} actions",this.title),getKeyBinding:s=>this.keybindingService.lookupKeybinding(s.id),renderDropdownAsChildElement:!0,actionRunner:this.getActionRunner(),resetMenu:this.menuActions.menuId}),this._register(this.toolbar),this.setActions(),this._register(U(n,ae.CLICK,s=>s.preventDefault()));let i=this.viewDescriptorService.getViewContainerByViewId(this.id);i?this._register(this.viewDescriptorService.getViewContainerModel(i).onDidChangeContainerInfo(({title:s})=>this.updateTitle(this.title))):console.error(`View container model not found for view ${this.id}`);let r=oe.filter(this.configurationService.onDidChangeConfiguration,s=>s.affectsConfiguration(Ma.AlwaysShowActionsConfig));this._register(r(this.updateActionsVisibility,this)),this.updateActionsVisibility()}updateHeader(){super.updateHeader(),this.updateTwistyIcon()}updateTwistyIcon(){this.twistiesContainer&&(this.twistiesContainer.classList.remove(...Je.asClassNameArray(this.getTwistyIcon(!this._expanded))),this.twistiesContainer.classList.add(...Je.asClassNameArray(this.getTwistyIcon(this._expanded))))}getTwistyIcon(t){return t?Gz:jz}style(t){super.style(t);let n=this.getIcon();if(this.iconContainer){let i=Ko(t.headerForeground,re(it));ie.isUri(n)?(this.iconContainer.style.backgroundColor=i,this.iconContainer.style.color=""):(this.iconContainer.style.color=i,this.iconContainer.style.backgroundColor="")}}getIcon(){return this.viewDescriptorService.getViewDescriptorById(this.id)?.containerIcon||FF}renderHeaderTitle(t,n){this.iconContainer=Ke(t,We(".icon",void 0));let i=this.getIcon(),r;if(ie.isUri(i)){r=`view-${this.id.replace(/[\.\:]/g,"-")}`;let a=`.pane-header .icon.${r}`;Zx(a,`
				mask: ${sl(i)} no-repeat 50% 50%;
				mask-size: 24px;
				-webkit-mask: ${sl(i)} no-repeat 50% 50%;
				-webkit-mask-size: 16px;
			`)}else Je.isThemeIcon(i)&&(r=Je.asClassName(i));r&&this.iconContainer.classList.add(...r.split(" "));let s=this.calculateTitle(n);this.titleContainer=Ke(t,We("h3.title",{},s)),this.titleContainerHover=this._register(this.hoverService.setupManagedHover(Gt("mouse"),this.titleContainer,s)),this._titleDescription&&this.setTitleDescription(this._titleDescription),this.iconContainerHover=this._register(this.hoverService.setupManagedHover(Gt("mouse"),this.iconContainer,s)),this.iconContainer.setAttribute("aria-label",this._getAriaLabel(s))}_getAriaLabel(t){let n=this.viewDescriptorService.getViewDescriptorById(this.id)?.accessibilityHelpContent,i=this.accessibleViewInformationService?.hasShownAccessibleView(this.id);return!n||i?t:p("viewAccessibilityHelp","Use Alt+F1 for accessibility help {0}",t)}updateTitle(t){let n=this.calculateTitle(t);this.titleContainer&&(this.titleContainer.textContent=n,this.titleContainerHover?.update(n)),this.iconContainer&&(this.iconContainerHover?.update(n),this.iconContainer.setAttribute("aria-label",this._getAriaLabel(n))),this._title=t,this._onDidChangeTitleArea.fire()}setTitleDescription(t){this.titleDescriptionContainer?(this.titleDescriptionContainer.textContent=t??"",this.titleDescriptionContainerHover?.update(t??"")):t&&this.titleContainer&&(this.titleDescriptionContainer=IR(this.titleContainer,We("span.description",{},t)),this.titleDescriptionContainerHover=this._register(this.hoverService.setupManagedHover(Gt("mouse"),this.titleDescriptionContainer,t)))}updateTitleDescription(t){this.setTitleDescription(t),this._titleDescription=t,this._onDidChangeTitleArea.fire()}calculateTitle(t){let n=this.viewDescriptorService.getViewContainerByViewId(this.id),i=this.viewDescriptorService.getViewContainerModel(n),r=this.viewDescriptorService.getViewDescriptorById(this.id);return!(this.viewDescriptorService.getDefaultContainerById(this.id)===n)&&r?.containerTitle&&i.title!==r.containerTitle?`${r.containerTitle}: ${t}`:t}renderBody(t){this.viewWelcomeController=this._register(this.instantiationService.createInstance(ff,t,this))}layoutBody(t,n){this.viewWelcomeController.layout(t,n)}onDidScrollRoot(){}getProgressIndicator(){if(this.progressBar===void 0&&(this.progressBar=this._register(new uw(this.element,HF)),this.progressBar.hide()),this.progressIndicator===void 0){let t=this;this.progressIndicator=this._register(new Iw(Tn(this.progressBar),new class extends Cw{constructor(){super(t.id,t.isBodyVisible()),this._register(t.onDidChangeBodyVisibility(n=>n?this.onScopeOpened(t.id):this.onScopeClosed(t.id)))}}))}return this.progressIndicator}getProgressLocation(){return this.viewDescriptorService.getViewContainerByViewId(this.id).id}getLocationBasedColors(){return $z(this.viewDescriptorService.getViewLocationById(this.id))}focus(){this.viewWelcomeController.enabled?this.viewWelcomeController.focus():this.element&&(this.element.focus(),this._onDidFocus.fire())}setActions(){if(this.toolbar){let t=[...this.menuActions.getPrimaryActions()];this.shouldShowFilterInHeader()&&t.unshift(vB),this.toolbar.setActions(F0(t),F0(this.menuActions.getSecondaryActions())),this.toolbar.context=this.getActionsContext()}}updateActionsVisibility(){if(!this.headerContainer)return;let t=this.configurationService.getValue("workbench.view.alwaysShowHeaderActions");this.headerContainer.classList.toggle("actions-always-visible",t)}updateActions(){this.setActions(),this._onDidChangeTitleArea.fire()}getActionViewItem(t,n){if(t.id===vB.id){let i=this;return new class extends si{constructor(){super(null,t)}setFocusable(){}get trapsArrowNavigation(){return!0}render(r){r.classList.add("viewpane-filter-container");let s=i.getFilterWidget();Ke(r,s.element),s.relayout()}}}return zF(this.instantiationService,t,{...n,menuAsChild:t instanceof Fi})}getActionsContext(){}getActionRunner(){}getOptimalWidth(){return 0}saveState(){}shouldShowWelcome(){return!1}getFilterWidget(){}shouldShowFilterInHeader(){return!1}};Ma=R([S(1,un),S(2,pr),S(3,Et),S(4,ft),S(5,rf),S(6,ct),S(7,Us),S(8,bi),S(9,Hn),S(10,jl)],Ma);var Aw=class extends Ma{filterWidget;dimension;filterContainer;constructor(e,t,n,i,r,s,a,l,d,c,u,h){super(e,t,n,i,r,s,a,l,d,c,u,h);let m=this._register(a.createChild(new ra([ft,this.scopedContextKeyService])));this.filterWidget=this._register(m.createInstance(up,e.filterOptions))}getFilterWidget(){return this.filterWidget}renderBody(e){super.renderBody(e),this.filterContainer=Ke(e,We(".viewpane-filter-container"))}layoutBody(e,t){super.layoutBody(e,t),this.dimension=new Ii(t,e);let n=!this.filterContainer?.hasChildNodes(),i=this.shouldShowFilterInHeader();n!==i&&(i&&oa(this.filterContainer),this.updateActions(),i||Ke(this.filterContainer,this.filterWidget.element)),i||(e=e-44),this.filterWidget.layout(t),this.layoutBodyContent(e,t)}shouldShowFilterInHeader(){return!(this.dimension&&this.dimension.width<600&&this.dimension.height>100)}};Aw=R([S(1,un),S(2,pr),S(3,Et),S(4,ft),S(5,rf),S(6,ct),S(7,Us),S(8,bi),S(9,Hn),S(10,jl)],Aw);function $z(o){let e,t,n,i;switch(o){case 1:e=c1,t=lB,n=dB,i=cB;break;case 0:case 2:default:e=Rw,t=mB,n=gB,i=fB}return{background:e,listOverrideStyles:{listBackground:e,treeStickyScrollBackground:t,treeStickyScrollBorder:n,treeStickyScrollShadow:i}}}var u$t=Object.freeze({id:"application",order:100,title:p("applicationConfigurationTitle","Application"),type:"object"}),IB=Object.freeze({id:"workbench",order:7,title:p("workbenchConfigurationTitle","Workbench"),type:"object"}),qz=Object.freeze({id:"security",scope:1,title:p("securityConfigurationTitle","Security"),type:"object",order:7}),h$t=Object.freeze({id:"problems",title:p("problemsConfigurationTitle","Problems"),type:"object",order:101}),Yz=Object.freeze({id:"window",order:8,title:p("windowConfigurationTitle","Window"),type:"object"}),Zz={ConfigurationMigration:"base.contributions.configuration.migration"},u1=class{migrations=[];_onDidRegisterConfigurationMigrations=new E;onDidRegisterConfigurationMigration=this._onDidRegisterConfigurationMigrations.event;registerConfigurationMigrations(e){this.migrations.push(...e)}},Fw=new u1;et.add(Zz.ConfigurationMigration,Fw);var Ow=class extends V{constructor(t,n){super();this.configurationService=t;this.workspaceService=n;this._register(this.workspaceService.onDidChangeWorkspaceFolders(async i=>{for(let r of i.added)await this.migrateConfigurationsForFolder(r,Fw.migrations)})),this.migrateConfigurations(Fw.migrations),this._register(Fw.onDidRegisterConfigurationMigration(i=>this.migrateConfigurations(i)))}static ID="workbench.contrib.configurationMigration";async migrateConfigurations(t){await this.migrateConfigurationsForFolder(void 0,t);for(let n of this.workspaceService.getWorkspace().folders)await this.migrateConfigurationsForFolder(n,t)}async migrateConfigurationsForFolder(t,n){await Promise.all([n.map(i=>this.migrateConfigurationsForFolderAndOverride(i,t?.uri))])}async migrateConfigurationsForFolderAndOverride(t,n){let i=this.configurationService.inspect(t.key,{resource:n}),r=this.workspaceService.getWorkbenchState()===3?[["user",2],["userLocal",3],["userRemote",4],["workspace",5],["workspaceFolder",6]]:[["user",2],["userLocal",3],["userRemote",4],["workspace",5]];for(let[s,a]of r){let l=i[s];if(!l)continue;let d=[];if(l.value!==void 0){let c=await this.runMigration(t,s,l.value,n,void 0);for(let u of c??[])d.push([u,[]])}for(let{identifiers:c,value:u}of l.overrides??[])if(u!==void 0){let h=await this.runMigration(t,s,u,n,c);for(let m of h??[])d.push([m,c])}d.length&&await Promise.allSettled(d.map(async([[c,u],h])=>this.configurationService.updateValue(c,u.value,{resource:n,overrideIdentifiers:h},a)))}}async runMigration(t,n,i,r,s){let a=d=>{let u=this.configurationService.inspect(d,{resource:r})[n];if(u)return s?u.overrides?.find(({identifiers:h})=>Zn(h,s))?.value:u.value},l=await t.migrateFn(i,a);return Array.isArray(l)?l:[[t.key,l]]}};Ow=R([S(0,Et),S(1,fs)],Ow);var Nw=class extends V{constructor(t){super();this.remoteAgentService=t;this.create()}static ID="workbench.contrib.dynamicWorkbenchSecurityConfiguration";_ready=new tl;ready=this._ready.p;async create(){try{await this.doCreate()}finally{this._ready.complete()}}async doCreate(){if(!mt&&(await this.remoteAgentService.getEnvironment())?.os!==1)return;et.as(bs.Configuration).registerConfiguration({...qz,properties:{"security.allowedUNCHosts":{type:"array",items:{type:"string",pattern:"^[^\\\\]+$",patternErrorMessage:p("security.allowedUNCHosts.patternErrorMessage","UNC host names must not contain backslashes.")},default:[],markdownDescription:p("security.allowedUNCHosts","A set of UNC host names (without leading or trailing backslash, for example `192.168.0.1` or `my-server`) to allow without user confirmation. If a UNC host is being accessed that is not allowed via this setting or has not been acknowledged via user confirmation, an error will occur and the operation stopped. A restart is required when changing this setting. Find out more about this setting at https://aka.ms/vscode-windows-unc."),scope:2},"security.restrictUNCAccess":{type:"boolean",default:!0,markdownDescription:p("security.restrictUNCAccess","If enabled, only allows access to UNC host names that are allowed by the `#security.allowedUNCHosts#` setting or after user confirmation. Find out more about this setting at https://aka.ms/vscode-windows-unc."),scope:2}}})}};Nw=R([S(0,II)],Nw);var bf="window.newWindowProfile",Pw=class extends V{constructor(t,n){super();this.userDataProfilesService=t;this.configurationService=n;this.registerNewWindowProfileConfiguration(),this._register(this.userDataProfilesService.onDidChangeProfiles(i=>this.registerNewWindowProfileConfiguration())),this.setNewWindowProfile(),this.checkAndResetNewWindowProfileConfig(),this._register(n.onDidChangeConfiguration(i=>{i.source!==7&&i.affectsConfiguration(bf)&&this.setNewWindowProfile()})),this._register(this.userDataProfilesService.onDidChangeProfiles(()=>this.checkAndResetNewWindowProfileConfig()))}static ID="workbench.contrib.dynamicWindowConfiguration";configurationNode;newWindowProfile;registerNewWindowProfileConfiguration(){let t=et.as(bs.Configuration),n={...Yz,properties:{[bf]:{type:["string","null"],default:null,enum:[...this.userDataProfilesService.profiles.map(i=>i.name),null],enumItemLabels:[...this.userDataProfilesService.profiles.map(i=>""),p("active window","Active Window")],description:p("newWindowProfile","Specifies the profile to use when opening a new window. If a profile name is provided, the new window will use that profile. If no profile name is provided, the new window will use the profile of the active window or the Default profile if no active window exists."),scope:1}}};this.configurationNode?t.updateConfigurations({add:[n],remove:[this.configurationNode]}):t.registerConfiguration(n),this.configurationNode=n}setNewWindowProfile(){let t=this.configurationService.getValue(bf);this.newWindowProfile=t?this.userDataProfilesService.profiles.find(n=>n.name===t):void 0}checkAndResetNewWindowProfileConfig(){let t=this.configurationService.getValue(bf);if(!t)return;let n=this.newWindowProfile?this.userDataProfilesService.profiles.find(i=>i.id===this.newWindowProfile.id):void 0;t!==n?.name&&this.configurationService.updateValue(bf,n?.name)}};Pw=R([S(0,GO),S(1,Et)],Pw);var q$t=Y("editorResolverService");var Xz=et.as(bs.Configuration),Qz={...IB,properties:{"workbench.editorAssociations":{type:"object",markdownDescription:p("editor.editorAssociations",'Configure [glob patterns](https://aka.ms/vscode-glob-patterns) to editors (for example `"*.hex": "hexEditor.hexedit"`). These have precedence over the default behavior.'),additionalProperties:{type:"string"}}}};Xz.registerConfiguration(Qz);var pqt=new j("workbenchState",void 0,{type:"string",description:p("workbenchState","The kind of workspace opened in the window, either 'empty' (no workspace), 'folder' (single folder) or 'workspace' (multi-root workspace)")}),mqt=new j("workspaceFolderCount",0,p("workspaceFolderCount","The number of root folders in the workspace")),gqt=new j("openFolderWorkspaceSupport",!0,!0),fqt=new j("enterMultiRootWorkspaceSupport",!0,!0),bqt=new j("emptyWorkspaceSupport",!0,!0),vqt=new j("dirtyWorkingCopies",!1,p("dirtyWorkingCopies","Whether there are any working copies with unsaved changes")),yqt=new j("remoteName","",p("remoteName","The name of the remote the window is connected to or an empty string if not connected to any remote")),Iqt=new j("virtualWorkspace","",p("virtualWorkspace","The scheme of the current workspace is from a virtual file system or an empty string.")),Cqt=new j("temporaryWorkspace",!1,p("temporaryWorkspace","The scheme of the current workspace is from a temporary file system.")),Sqt=new j("isFullscreen",!1,p("isFullscreen","Whether the main window is in fullscreen mode")),wqt=new j("isAuxiliaryWindowFocusedContext",!1,p("isAuxiliaryWindowFocusedContext","Whether an auxiliary window is focused")),xqt=new j("hasWebFileSystemAccess",!1,!0),Eqt=new j("embedderIdentifier",void 0,p("embedderIdentifier","The identifier of the embedder according to the product service, if one is defined")),_qt=new j("activeEditorIsDirty",!1,p("activeEditorIsDirty","Whether the active editor has unsaved changes")),Tqt=new j("activeEditorIsNotPreview",!1,p("activeEditorIsNotPreview","Whether the active editor is not in preview mode")),Lqt=new j("activeEditorIsFirstInGroup",!1,p("activeEditorIsFirstInGroup","Whether the active editor is the first one in its group")),Dqt=new j("activeEditorIsLastInGroup",!1,p("activeEditorIsLastInGroup","Whether the active editor is the last one in its group")),kqt=new j("activeEditorIsPinned",!1,p("activeEditorIsPinned","Whether the active editor is pinned")),Rqt=new j("activeEditorIsReadonly",!1,p("activeEditorIsReadonly","Whether the active editor is read-only")),Mqt=new j("activeCompareEditorCanSwap",!1,p("activeCompareEditorCanSwap","Whether the active compare editor can swap sides")),Aqt=new j("activeEditorCanToggleReadonly",!0,p("activeEditorCanToggleReadonly","Whether the active editor can toggle between being read-only or writeable")),Oqt=new j("activeEditorCanRevert",!1,p("activeEditorCanRevert","Whether the active editor can revert")),Nqt=new j("activeEditorCanSplitInGroup",!0),Pqt=new j("activeEditor",null,{type:"string",description:p("activeEditor","The identifier of the active editor")}),Fqt=new j("activeEditorAvailableEditorIds","",p("activeEditorAvailableEditorIds","The available editor identifiers that are usable for the active editor")),Bqt=new j("textCompareEditorVisible",!1,p("textCompareEditorVisible","Whether a text compare editor is visible")),Vqt=new j("textCompareEditorActive",!1,p("textCompareEditorActive","Whether a text compare editor is active")),Wqt=new j("sideBySideEditorActive",!1,p("sideBySideEditorActive","Whether a side by side editor is active")),Hqt=new j("groupEditorsCount",0,p("groupEditorsCount","The number of opened editor groups")),Uqt=new j("activeEditorGroupEmpty",!1,p("activeEditorGroupEmpty","Whether the active editor group is empty")),zqt=new j("activeEditorGroupIndex",0,p("activeEditorGroupIndex","The index of the active editor group")),Kqt=new j("activeEditorGroupLast",!1,p("activeEditorGroupLast","Whether the active editor group is the last group")),Gqt=new j("activeEditorGroupLocked",!1,p("activeEditorGroupLocked","Whether the active editor group is locked")),Jz=new j("multipleEditorGroups",!1,p("multipleEditorGroups","Whether there are multiple editor groups opened")),jqt=Jz.toNegated(),$qt=new j("multipleEditorsSelectedInGroup",!1,p("multipleEditorsSelectedInGroup","Whether multiple editors have been selected in an editor group")),qqt=new j("twoEditorsSelectedInGroup",!1,p("twoEditorsSelectedInGroup","Whether exactly two editors have been selected in an editor group")),Yqt=new j("SelectedEditorsInGroupFileOrUntitledResourceContextKey",!0,p("SelectedEditorsInGroupFileOrUntitledResourceContextKey","Whether all selected editors in a group have a file or untitled resource associated")),e7=new j("editorPartMultipleEditorGroups",!1,p("editorPartMultipleEditorGroups","Whether there are multiple editor groups opened in an editor part")),Zqt=e7.toNegated(),Xqt=new j("editorPartMaximizedEditorGroup",!1,p("editorPartEditorGroupMaximized","Editor Part has a maximized group")),Qqt=new j("isAuxiliaryEditorPart",!1,p("isAuxiliaryEditorPart","Editor Part is in an auxiliary window")),Jqt=new j("editorIsOpen",!1,p("editorIsOpen","Whether an editor is open")),eYt=new j("inZenMode",!1,p("inZenMode","Whether Zen mode is enabled")),tYt=new j("isCenteredLayout",!1,p("isMainEditorCenteredLayout","Whether centered layout is enabled for the main editor")),nYt=new j("splitEditorsVertically",!1,p("splitEditorsVertically","Whether editors split vertically")),iYt=new j("mainEditorAreaVisible",!0,p("mainEditorAreaVisible","Whether the editor area in the main window is visible")),oYt=new j("editorTabsVisible",!0,p("editorTabsVisible","Whether editor tabs are visible")),rYt=new j("sideBarVisible",!1,p("sideBarVisible","Whether the sidebar is visible")),sYt=new j("sideBarFocus",!1,p("sideBarFocus","Whether the sidebar has keyboard focus")),aYt=new j("activeViewlet","",p("activeViewlet","The identifier of the active viewlet")),lYt=new j("statusBarFocused",!1,p("statusBarFocused","Whether the status bar has keyboard focus")),dYt=new j("titleBarStyle",Wt?"native":"custom",p("titleBarStyle","Style of the window title bar")),cYt=new j("titleBarVisible",!1,p("titleBarVisible","Whether the title bar is visible")),uYt=new j("bannerFocused",!1,p("bannerFocused","Whether the banner has keyboard focus")),hYt=new j("notificationFocus",!0,p("notificationFocus","Whether a notification has keyboard focus")),pYt=new j("notificationCenterVisible",!1,p("notificationCenterVisible","Whether the notifications center is visible")),mYt=new j("notificationToastsVisible",!1,p("notificationToastsVisible","Whether a notification toast is visible")),gYt=new j("activeAuxiliary","",p("activeAuxiliary","The identifier of the active auxiliary panel")),fYt=new j("auxiliaryBarFocus",!1,p("auxiliaryBarFocus","Whether the auxiliary bar has keyboard focus")),bYt=new j("auxiliaryBarVisible",!1,p("auxiliaryBarVisible","Whether the auxiliary bar is visible")),vYt=new j("activePanel","",p("activePanel","The identifier of the active panel")),yYt=new j("panelFocus",!1,p("panelFocus","Whether the panel has keyboard focus")),IYt=new j("panelPosition","bottom",p("panelPosition","The position of the panel, always 'bottom'")),CYt=new j("panelAlignment","center",p("panelAlignment","The alignment of the panel, either 'center', 'left', 'right' or 'justify'")),SYt=new j("panelVisible",!1,p("panelVisible","Whether the panel is visible")),wYt=new j("panelMaximized",!1,p("panelMaximized","Whether the panel is maximized")),xYt=new j("focusedView","",p("focusedView","The identifier of the view that has keyboard focus"));var Gi=class{constructor(e,t,n,i){this._contextKeyService=e;this._fileService=t;this._languageService=n;this._modelService=i;this._schemeKey=Gi.Scheme.bindTo(this._contextKeyService),this._filenameKey=Gi.Filename.bindTo(this._contextKeyService),this._dirnameKey=Gi.Dirname.bindTo(this._contextKeyService),this._pathKey=Gi.Path.bindTo(this._contextKeyService),this._langIdKey=Gi.LangId.bindTo(this._contextKeyService),this._resourceKey=Gi.Resource.bindTo(this._contextKeyService),this._extensionKey=Gi.Extension.bindTo(this._contextKeyService),this._hasResource=Gi.HasResource.bindTo(this._contextKeyService),this._isFileSystemResource=Gi.IsFileSystemResource.bindTo(this._contextKeyService),this._disposables.add(t.onDidChangeFileSystemProviderRegistrations(()=>{let r=this.get();this._isFileSystemResource.set(!!(r&&t.hasProvider(r)))})),this._disposables.add(i.onModelAdded(r=>{Yn(r.uri,this.get())&&this._setLangId()})),this._disposables.add(i.onModelLanguageChanged(r=>{Yn(r.model.uri,this.get())&&this._setLangId()}))}static Scheme=new j("resourceScheme",void 0,{type:"string",description:p("resourceScheme","The scheme of the resource")});static Filename=new j("resourceFilename",void 0,{type:"string",description:p("resourceFilename","The file name of the resource")});static Dirname=new j("resourceDirname",void 0,{type:"string",description:p("resourceDirname","The folder name the resource is contained in")});static Path=new j("resourcePath",void 0,{type:"string",description:p("resourcePath","The full path of the resource")});static LangId=new j("resourceLangId",void 0,{type:"string",description:p("resourceLangId","The language identifier of the resource")});static Resource=new j("resource",void 0,{type:"URI",description:p("resource","The full value of the resource including scheme and path")});static Extension=new j("resourceExtname",void 0,{type:"string",description:p("resourceExtname","The extension name of the resource")});static HasResource=new j("resourceSet",void 0,{type:"boolean",description:p("resourceSet","Whether a resource is present or not")});static IsFileSystemResource=new j("isFileSystemResource",void 0,{type:"boolean",description:p("isFileSystemResource","Whether the resource is backed by a file system provider")});_disposables=new he;_value;_resourceKey;_schemeKey;_filenameKey;_dirnameKey;_pathKey;_langIdKey;_extensionKey;_hasResource;_isFileSystemResource;dispose(){this._disposables.dispose()}_setLangId(){let e=this.get();if(!e){this._langIdKey.set(null);return}let t=this._modelService.getModel(e)?.getLanguageId()??this._languageService.guessLanguageIdByFilepathOrFirstLine(e);this._langIdKey.set(t)}set(e){e=e??void 0,!Yn(this._value,e)&&(this._value=e,this._contextKeyService.bufferChangeEvents(()=>{this._resourceKey.set(e?e.toString():null),this._schemeKey.set(e?e.scheme:null),this._filenameKey.set(e?xr(e):null),this._dirnameKey.set(e?this.uriToPath(as(e)):null),this._pathKey.set(e?this.uriToPath(e):null),this._setLangId(),this._extensionKey.set(e?Rx(e):null),this._hasResource.set(!!e),this._isFileSystemResource.set(e?this._fileService.hasProvider(e):!1)}))}uriToPath(e){return e.scheme===Te.file?e.fsPath:e.path}reset(){this._value=void 0,this._contextKeyService.bufferChangeEvents(()=>{this._resourceKey.reset(),this._schemeKey.reset(),this._filenameKey.reset(),this._dirnameKey.reset(),this._pathKey.reset(),this._langIdKey.reset(),this._extensionKey.reset(),this._hasResource.reset(),this._isFileSystemResource.reset()})}get(){return this._value}};Gi=R([S(0,ft),S(1,zt),S(2,Bi),S(3,Vr)],Gi);var Bw=class extends Ma{editor;channelId;editorPromise=null;scrollLockContextKey;get scrollLock(){return!!this.scrollLockContextKey.get()}set scrollLock(e){this.scrollLockContextKey.set(e)}constructor(e,t,n,i,r,s,a,l,d,c,u){super(e,t,n,i,r,s,a,l,d,c,u),this.scrollLockContextKey=NF.bindTo(this.contextKeyService);let h=this._register(a.createChild(new ra([ft,this.scopedContextKeyService])));this.editor=this._register(h.createInstance(vf)),this._register(this.editor.onTitleAreaUpdate(()=>{this.updateTitle(this.editor.getTitle()),this.updateActions()})),this._register(this.onDidChangeBodyVisibility(()=>this.onDidChangeVisibility(this.isBodyVisible())))}showChannel(e,t){this.channelId!==e.id&&this.setInput(e),t||this.focus()}focus(){super.focus(),this.editorPromise?.then(()=>this.editor.focus())}renderBody(e){super.renderBody(e),this.editor.create(e),e.classList.add("output-view");let t=this.editor.getControl();t.setAriaOptions({role:"document",activeDescendant:void 0}),this._register(t.onDidChangeModelContent(()=>{this.scrollLock||this.editor.revealLastLine()})),this._register(t.onDidChangeCursorPosition(n=>{if(n.reason!==3||!this.configurationService.getValue("output.smartScroll.enabled"))return;let i=t.getModel();if(i){let r=n.position.lineNumber,s=i.getLineCount();this.scrollLock=s!==r}}))}layoutBody(e,t){super.layoutBody(e,t),this.editor.layout(new Ii(t,e))}onDidChangeVisibility(e){this.editor.setVisible(e),e||this.clearInput()}setInput(e){this.channelId=e.id;let t=this.createInput(e);(!this.editor.input||!t.matches(this.editor.input))&&(this.editorPromise?.cancel(),this.editorPromise=gd(n=>this.editor.setInput(this.createInput(e),{preserveFocus:!0},Object.create(null),n).then(()=>this.editor)))}clearInput(){this.channelId=void 0,this.editor.clearInput(),this.editorPromise=null}createInput(e){return this.instantiationService.createInstance(zr,e.uri,p("output model title","{0} - Output",e.label),p("channel","Output channel for '{0}'",e.label),void 0,void 0)}};Bw=R([S(1,un),S(2,pr),S(3,Et),S(4,ft),S(5,rf),S(6,ct),S(7,Us),S(8,bi),S(9,Hn),S(10,jl)],Bw);var vf=class extends _c{constructor(t,n,i,r,s,a,l,d,c){super($0,l.activeGroup,t,n,i,s,a,l,d,c);this.configurationService=r;this.resourceContext=this._register(n.createInstance(Gi))}resourceContext;getId(){return $0}getTitle(){return p("output","Output")}getConfigurationOverrides(t){let n=super.getConfigurationOverrides(t);n.wordWrap="on",n.lineNumbers="off",n.glyphMargin=!1,n.lineDecorationsWidth=20,n.rulers=[],n.folding=!1,n.scrollBeyondLastLine=!1,n.renderLineHighlight="none",n.minimap={enabled:!1},n.renderValidationDecorations="editable",n.padding=void 0,n.readOnly=!0,n.domReadOnly=!0,n.unicodeHighlight={nonBasicASCII:!1,invisibleCharacters:!1,ambiguousCharacters:!1};let i=this.configurationService.getValue("[Log]");return i&&(i["editor.minimap.enabled"]&&(n.minimap={enabled:!0}),"editor.wordWrap"in i&&(n.wordWrap=i["editor.wordWrap"])),n}getAriaLabel(){return this.input?this.input.getAriaLabel():p("outputViewAriaLabel","Output panel")}computeAriaLabel(){return this.input?ow(this.input,void 0,void 0,this.editorGroupService.count):this.getAriaLabel()}async setInput(t,n,i,r){let s=!(n&&n.preserveFocus);this.input&&t.matches(this.input)||(this.input&&this.input.dispose(),await super.setInput(t,n,i,r),this.resourceContext.set(t.resource),s&&this.focus(),this.revealLastLine())}clearInput(){this.input&&this.input.dispose(),super.clearInput(),this.resourceContext.reset()}createEditor(t){t.setAttribute("role","document"),super.createEditor(t);let n=this.scopedContextKeyService;n&&OF.bindTo(n).set(!0)}};vf=R([S(0,Hn),S(1,ct),S(2,zn),S(3,Et),S(4,Kn),S(5,bi),S(6,Sa),S(7,gn),S(8,zt)],vf);export{Bw as OutputViewPane};
