import a from"assert";import{URI as c}from"../../../../../base/common/uri.js";import{isMacintosh as p,isLinux as g,isWindows as i}from"../../../../../base/common/platform.js";import{OutputLinkComputer as r}from"../../common/outputLinkComputer.js";import{TestContextService as m}from"../../../../test/common/workbenchTestServices.js";import{ensureNoDisposablesAreLeakedInTestSuite as E}from"../../../../../base/test/common/utils.js";suite("OutputLinkProvider",()=>{function n(l){return p||g?l.replace(/\\/g,"/"):l}test("OutputLinkProvider - Link detection",function(){const l=i?c.file("C:\\Users\\someone\\AppData\\Local\\Temp\\_monacodata_9888\\workspaces\\mankala"):c.file("C:/Users/someone/AppData/Local/Temp/_monacodata_9888/workspaces/mankala"),o=r.createPatterns(l),s=new m;let e=n("Foo bar"),t=r.detectLinks(e,1,o,s);a.strictEqual(t.length,0),e=n(" at C:\\Users\\someone\\AppData\\Local\\Temp\\_monacodata_9888\\workspaces\\mankala\\Game.ts in"),t=r.detectLinks(e,1,o,s),a.strictEqual(t.length,1),a.strictEqual(t[0].url,s.toResource("/Game.ts").toString()),a.strictEqual(t[0].range.startColumn,5),a.strictEqual(t[0].range.endColumn,84),e=n(" at C:\\Users\\someone\\AppData\\Local\\Temp\\_monacodata_9888\\workspaces\\mankala\\Game.ts:336 in"),t=r.detectLinks(e,1,o,s),a.strictEqual(t.length,1),a.strictEqual(t[0].url,s.toResource("/Game.ts").toString()+"#336"),a.strictEqual(t[0].range.startColumn,5),a.strictEqual(t[0].range.endColumn,88),e=n(" at C:\\Users\\someone\\AppData\\Local\\Temp\\_monacodata_9888\\workspaces\\mankala\\Game.ts:336:9 in"),t=r.detectLinks(e,1,o,s),a.strictEqual(t.length,1),a.strictEqual(t[0].url,s.toResource("/Game.ts").toString()+"#336,9"),a.strictEqual(t[0].range.startColumn,5),a.strictEqual(t[0].range.endColumn,90),e=n(" at C:\\Users\\someone\\AppData\\Local\\Temp\\_monacodata_9888\\workspaces\\mankala\\Game.ts:336:9 in"),t=r.detectLinks(e,1,o,s),a.strictEqual(t.length,1),a.strictEqual(t[0].url,s.toResource("/Game.ts").toString()+"#336,9"),a.strictEqual(t[0].range.startColumn,5),a.strictEqual(t[0].range.endColumn,90),e=n(" at C:\\Users\\someone\\AppData\\Local\\Temp\\_monacodata_9888\\workspaces\\mankala\\Game.ts>dir in"),t=r.detectLinks(e,1,o,s),a.strictEqual(t.length,1),a.strictEqual(t[0].url,s.toResource("/Game.ts").toString()),a.strictEqual(t[0].range.startColumn,5),a.strictEqual(t[0].range.endColumn,84),e=n(" at C:\\Users\\someone\\AppData\\Local\\Temp\\_monacodata_9888\\workspaces\\mankala\\Game.ts:336:9] in"),t=r.detectLinks(e,1,o,s),a.strictEqual(t.length,1),a.strictEqual(t[0].url,s.toResource("/Game.ts").toString()+"#336,9"),a.strictEqual(t[0].range.startColumn,5),a.strictEqual(t[0].range.endColumn,90),e=n(" at C:\\Users\\someone\\AppData\\Local\\Temp\\_monacodata_9888\\workspaces\\mankala\\Game.ts] in"),t=r.detectLinks(e,1,o,s),a.strictEqual(t.length,1),a.strictEqual(t[0].url,s.toResource("/Game.ts]").toString()),e=n("C:\\Users\\someone\\AppData\\Local\\Temp\\_monacodata_9888\\workspaces\\mankala\\Game.ts on line 8"),t=r.detectLinks(e,1,o,s),a.strictEqual(t.length,1),a.strictEqual(t[0].url,s.toResource("/Game.ts").toString()+"#8"),a.strictEqual(t[0].range.startColumn,1),a.strictEqual(t[0].range.endColumn,90),e=n("C:\\Users\\someone\\AppData\\Local\\Temp\\_monacodata_9888\\workspaces\\mankala\\Game.ts on line 8, column 13"),t=r.detectLinks(e,1,o,s),a.strictEqual(t.length,1),a.strictEqual(t[0].url,s.toResource("/Game.ts").toString()+"#8,13"),a.strictEqual(t[0].range.startColumn,1),a.strictEqual(t[0].range.endColumn,101),e=n("C:\\Users\\someone\\AppData\\Local\\Temp\\_monacodata_9888\\workspaces\\mankala\\Game.ts on LINE 8, COLUMN 13"),t=r.detectLinks(e,1,o,s),a.strictEqual(t.length,1),a.strictEqual(t[0].url,s.toResource("/Game.ts").toString()+"#8,13"),a.strictEqual(t[0].range.startColumn,1),a.strictEqual(t[0].range.endColumn,101),e=n("C:\\Users\\someone\\AppData\\Local\\Temp\\_monacodata_9888\\workspaces\\mankala\\Game.ts:line 8"),t=r.detectLinks(e,1,o,s),a.strictEqual(t.length,1),a.strictEqual(t[0].url,s.toResource("/Game.ts").toString()+"#8"),a.strictEqual(t[0].range.startColumn,1),a.strictEqual(t[0].range.endColumn,87),e=n(" at File.put (C:/Users/someone/AppData/Local/Temp/_monacodata_9888/workspaces/mankala/Game.ts)"),t=r.detectLinks(e,1,o,s),a.strictEqual(t.length,1),a.strictEqual(t[0].url,s.toResource("/Game.ts").toString()),a.strictEqual(t[0].range.startColumn,15),a.strictEqual(t[0].range.endColumn,94),e=n(" at File.put (C:/Users/someone/AppData/Local/Temp/_monacodata_9888/workspaces/mankala/Game.ts:278)"),t=r.detectLinks(e,1,o,s),a.strictEqual(t.length,1),a.strictEqual(t[0].url,s.toResource("/Game.ts").toString()+"#278"),a.strictEqual(t[0].range.startColumn,15),a.strictEqual(t[0].range.endColumn,98),e=n(" at File.put (C:/Users/someone/AppData/Local/Temp/_monacodata_9888/workspaces/mankala/Game.ts:278:34)"),t=r.detectLinks(e,1,o,s),a.strictEqual(t.length,1),a.strictEqual(t[0].url,s.toResource("/Game.ts").toString()+"#278,34"),a.strictEqual(t[0].range.startColumn,15),a.strictEqual(t[0].range.endColumn,101),e=n(" at File.put (C:/Users/someone/AppData/Local/Temp/_monacodata_9888/workspaces/mankala/Game.ts:278:34)"),t=r.detectLinks(e,1,o,s),a.strictEqual(t.length,1),a.strictEqual(t[0].url,s.toResource("/Game.ts").toString()+"#278,34"),a.strictEqual(t[0].range.startColumn,15),a.strictEqual(t[0].range.endColumn,101),e=n("C:/Users/someone/AppData/Local/Temp/_monacodata_9888/workspaces/mankala/lib/something/Features.ts(45): error"),t=r.detectLinks(e,1,o,s),a.strictEqual(t.length,1),a.strictEqual(t[0].url,s.toResource("/lib/something/Features.ts").toString()+"#45"),a.strictEqual(t[0].range.startColumn,1),a.strictEqual(t[0].range.endColumn,102),e=n("C:/Users/someone/AppData/Local/Temp/_monacodata_9888/workspaces/mankala/lib/something/Features.ts (45): error"),t=r.detectLinks(e,1,o,s),a.strictEqual(t.length,1),a.strictEqual(t[0].url,s.toResource("/lib/something/Features.ts").toString()+"#45"),a.strictEqual(t[0].range.startColumn,1),a.strictEqual(t[0].range.endColumn,103),e=n("C:/Users/someone/AppData/Local/Temp/_monacodata_9888/workspaces/mankala/lib/something/Features.ts(45,18): error"),t=r.detectLinks(e,1,o,s),a.strictEqual(t.length,1),a.strictEqual(t[0].url,s.toResource("/lib/something/Features.ts").toString()+"#45,18"),a.strictEqual(t[0].range.startColumn,1),a.strictEqual(t[0].range.endColumn,105),e=n("C:/Users/someone/AppData/Local/Temp/_monacodata_9888/workspaces/mankala/lib/something/Features.ts(45,18): error"),t=r.detectLinks(e,1,o,s),a.strictEqual(t.length,1),a.strictEqual(t[0].url,s.toResource("/lib/something/Features.ts").toString()+"#45,18"),a.strictEqual(t[0].range.startColumn,1),a.strictEqual(t[0].range.endColumn,105),e=n("C:/Users/someone/AppData/Local/Temp/_monacodata_9888/workspaces/mankala/lib/something/Features.ts (45,18): error"),t=r.detectLinks(e,1,o,s),a.strictEqual(t.length,1),a.strictEqual(t[0].url,s.toResource("/lib/something/Features.ts").toString()+"#45,18"),a.strictEqual(t[0].range.startColumn,1),a.strictEqual(t[0].range.endColumn,106),e=n("C:/Users/someone/AppData/Local/Temp/_monacodata_9888/workspaces/mankala/lib/something/Features.ts (45,18): error"),t=r.detectLinks(e,1,o,s),a.strictEqual(t.length,1),a.strictEqual(t[0].url,s.toResource("/lib/something/Features.ts").toString()+"#45,18"),a.strictEqual(t[0].range.startColumn,1),a.strictEqual(t[0].range.endColumn,106),e=n("C:\\Users\\someone\\AppData\\Local\\Temp\\_monacodata_9888\\workspaces\\mankala\\lib\\something\\Features.ts(45): error"),t=r.detectLinks(e,1,o,s),a.strictEqual(t.length,1),a.strictEqual(t[0].url,s.toResource("/lib/something/Features.ts").toString()+"#45"),a.strictEqual(t[0].range.startColumn,1),a.strictEqual(t[0].range.endColumn,102),e=n("C:\\Users\\someone\\AppData\\Local\\Temp\\_monacodata_9888\\workspaces\\mankala\\lib\\something\\Features.ts (45): error"),t=r.detectLinks(e,1,o,s),a.strictEqual(t.length,1),a.strictEqual(t[0].url,s.toResource("/lib/something/Features.ts").toString()+"#45"),a.strictEqual(t[0].range.startColumn,1),a.strictEqual(t[0].range.endColumn,103),e=n("C:\\Users\\someone\\AppData\\Local\\Temp\\_monacodata_9888\\workspaces\\mankala\\lib\\something\\Features.ts(45,18): error"),t=r.detectLinks(e,1,o,s),a.strictEqual(t.length,1),a.strictEqual(t[0].url,s.toResource("/lib/something/Features.ts").toString()+"#45,18"),a.strictEqual(t[0].range.startColumn,1),a.strictEqual(t[0].range.endColumn,105),e=n("C:\\Users\\someone\\AppData\\Local\\Temp\\_monacodata_9888\\workspaces\\mankala\\lib\\something\\Features.ts(45,18): error"),t=r.detectLinks(e,1,o,s),a.strictEqual(t.length,1),a.strictEqual(t[0].url,s.toResource("/lib/something/Features.ts").toString()+"#45,18"),a.strictEqual(t[0].range.startColumn,1),a.strictEqual(t[0].range.endColumn,105),e=n("C:\\Users\\someone\\AppData\\Local\\Temp\\_monacodata_9888\\workspaces\\mankala\\lib\\something\\Features.ts (45,18): error"),t=r.detectLinks(e,1,o,s),a.strictEqual(t.length,1),a.strictEqual(t[0].url,s.toResource("/lib/something/Features.ts").toString()+"#45,18"),a.strictEqual(t[0].range.startColumn,1),a.strictEqual(t[0].range.endColumn,106),e=n("C:\\Users\\someone\\AppData\\Local\\Temp\\_monacodata_9888\\workspaces\\mankala\\lib\\something\\Features.ts (45,18): error"),t=r.detectLinks(e,1,o,s),a.strictEqual(t.length,1),a.strictEqual(t[0].url,s.toResource("/lib/something/Features.ts").toString()+"#45,18"),a.strictEqual(t[0].range.startColumn,1),a.strictEqual(t[0].range.endColumn,106),e=n("C:\\Users\\someone\\AppData\\Local\\Temp\\_monacodata_9888\\workspaces\\mankala\\lib\\something\\Features Special.ts (45,18): error"),t=r.detectLinks(e,1,o,s),a.strictEqual(t.length,1),a.strictEqual(t[0].url,s.toResource("/lib/something/Features Special.ts").toString()+"#45,18"),a.strictEqual(t[0].range.startColumn,1),a.strictEqual(t[0].range.endColumn,114),e=n(" at C:\\Users\\someone\\AppData\\Local\\Temp\\_monacodata_9888\\workspaces\\mankala\\Game.ts. in"),t=r.detectLinks(e,1,o,s),a.strictEqual(t.length,1),a.strictEqual(t[0].url,s.toResource("/Game.ts").toString()),a.strictEqual(t[0].range.startColumn,5),a.strictEqual(t[0].range.endColumn,84),e=n(" at C:\\Users\\someone\\AppData\\Local\\Temp\\_monacodata_9888\\workspaces\\mankala\\Game in"),t=r.detectLinks(e,1,o,s),a.strictEqual(t.length,1),e=n(" at C:\\Users\\someone\\AppData\\Local\\Temp\\_monacodata_9888\\workspaces\\mankala\\Game\\ in"),t=r.detectLinks(e,1,o,s),a.strictEqual(t.length,1),e=n(' at "C:\\Users\\someone\\AppData\\Local\\Temp\\_monacodata_9888\\workspaces\\mankala\\Game.ts" in'),t=r.detectLinks(e,1,o,s),a.strictEqual(t.length,1),a.strictEqual(t[0].url,s.toResource("/Game.ts").toString()),a.strictEqual(t[0].range.startColumn,6),a.strictEqual(t[0].range.endColumn,85),e=n(" at 'C:\\Users\\someone\\AppData\\Local\\Temp\\_monacodata_9888\\workspaces\\mankala\\Game.ts' in"),t=r.detectLinks(e,1,o,s),a.strictEqual(t.length,1),a.strictEqual(t[0].url,s.toResource("/Game.ts").toString()),a.strictEqual(t[0].range.startColumn,6),a.strictEqual(t[0].range.endColumn,85)}),test("OutputLinkProvider - #106847",function(){const l=i?c.file("C:\\Users\\username\\Desktop\\test-ts"):c.file("C:/Users/username/Desktop"),o=r.createPatterns(l),s=new m,e=n("aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa C:\\Users\\username\\Desktop\\test-ts\\prj.conf C:\\Users\\username\\Desktop\\test-ts\\prj.conf C:\\Users\\username\\Desktop\\test-ts\\prj.conf"),t=r.detectLinks(e,1,o,s);a.strictEqual(t.length,3);for(const u of t)a.ok(u.range.startColumn>0&&u.range.endColumn>0)}),E()});
