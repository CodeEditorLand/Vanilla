import{Action as x,Separator as G,SubmenuAction as D}from"../../../../base/common/actions.js";import{Codicon as d}from"../../../../base/common/codicons.js";import{Schemas as g}from"../../../../base/common/network.js";import{localize as n,localize2 as y}from"../../../../nls.js";import{MenuId as t,MenuRegistry as l}from"../../../../platform/actions/common/actions.js";import{ContextKeyExpr as r}from"../../../../platform/contextkey/common/contextkey.js";import{TerminalLocation as q,TerminalSettingId as w}from"../../../../platform/terminal/common/terminal.js";import{ResourceContextKey as f}from"../../../common/contextkeys.js";import{TaskExecutionSupportedContext as P}from"../../tasks/common/taskService.js";import{TerminalCommandId as e,TERMINAL_VIEW_ID as h}from"../common/terminal.js";import{TerminalContextKeys as c,TerminalContextKeyStrings as I}from"../common/terminalContextKey.js";import{terminalStrings as o}from"../common/terminalStrings.js";import{ACTIVE_GROUP as W,SIDE_GROUP as z}from"../../../services/editor/common/editorService.js";var H=(s=>(s.Create="1_create",s.Edit="3_edit",s.Clear="5_clear",s.Kill="7_kill",s.Config="9_config",s))(H||{}),V=(a=>(a.Create="1_create",a.Run="3_run",a.Manage="5_manage",a.Configure="7_configure",a))(V||{});function de(){l.appendMenuItems([{id:t.MenubarTerminalMenu,item:{group:"1_create",command:{id:e.New,title:n({key:"miNewTerminal",comment:["&& denotes a mnemonic"]},"&&New Terminal")},order:1}},{id:t.MenubarTerminalMenu,item:{group:"1_create",command:{id:e.Split,title:n({key:"miSplitTerminal",comment:["&& denotes a mnemonic"]},"&&Split Terminal"),precondition:r.has(I.IsOpen)},order:2,when:c.processSupported}},{id:t.MenubarTerminalMenu,item:{group:"3_run",command:{id:e.RunActiveFile,title:n({key:"miRunActiveFile",comment:["&& denotes a mnemonic"]},"Run &&Active File")},order:3,when:c.processSupported}},{id:t.MenubarTerminalMenu,item:{group:"3_run",command:{id:e.RunSelectedText,title:n({key:"miRunSelectedText",comment:["&& denotes a mnemonic"]},"Run &&Selected Text")},order:4,when:c.processSupported}}]),l.appendMenuItems([{id:t.TerminalInstanceContext,item:{group:"1_create",command:{id:e.Split,title:o.split.value}}},{id:t.TerminalInstanceContext,item:{command:{id:e.New,title:o.new},group:"1_create"}},{id:t.TerminalInstanceContext,item:{command:{id:e.KillViewOrEditor,title:o.kill.value},group:"7_kill"}},{id:t.TerminalInstanceContext,item:{command:{id:e.CopySelection,title:n("workbench.action.terminal.copySelection.short","Copy")},group:"3_edit",order:1}},{id:t.TerminalInstanceContext,item:{command:{id:e.CopySelectionAsHtml,title:n("workbench.action.terminal.copySelectionAsHtml","Copy as HTML")},group:"3_edit",order:2}},{id:t.TerminalInstanceContext,item:{command:{id:e.Paste,title:n("workbench.action.terminal.paste.short","Paste")},group:"3_edit",order:3}},{id:t.TerminalInstanceContext,item:{command:{id:e.Clear,title:n("workbench.action.terminal.clear","Clear")},group:"5_clear"}},{id:t.TerminalInstanceContext,item:{command:{id:e.SizeToContentWidth,title:o.toggleSizeToContentWidth},group:"9_config"}},{id:t.TerminalInstanceContext,item:{command:{id:e.SelectAll,title:n("workbench.action.terminal.selectAll","Select All")},group:"3_edit",order:3}}]),l.appendMenuItems([{id:t.TerminalEditorInstanceContext,item:{group:"1_create",command:{id:e.Split,title:o.split.value}}},{id:t.TerminalEditorInstanceContext,item:{command:{id:e.New,title:o.new},group:"1_create"}},{id:t.TerminalEditorInstanceContext,item:{command:{id:e.KillEditor,title:o.kill.value},group:"7_kill"}},{id:t.TerminalEditorInstanceContext,item:{command:{id:e.CopySelection,title:n("workbench.action.terminal.copySelection.short","Copy")},group:"3_edit",order:1}},{id:t.TerminalEditorInstanceContext,item:{command:{id:e.CopySelectionAsHtml,title:n("workbench.action.terminal.copySelectionAsHtml","Copy as HTML")},group:"3_edit",order:2}},{id:t.TerminalEditorInstanceContext,item:{command:{id:e.Paste,title:n("workbench.action.terminal.paste.short","Paste")},group:"3_edit",order:3}},{id:t.TerminalEditorInstanceContext,item:{command:{id:e.Clear,title:n("workbench.action.terminal.clear","Clear")},group:"5_clear"}},{id:t.TerminalEditorInstanceContext,item:{command:{id:e.SelectAll,title:n("workbench.action.terminal.selectAll","Select All")},group:"3_edit",order:3}},{id:t.TerminalEditorInstanceContext,item:{command:{id:e.SizeToContentWidth,title:o.toggleSizeToContentWidth},group:"9_config"}}]),l.appendMenuItems([{id:t.TerminalTabEmptyAreaContext,item:{command:{id:e.NewWithProfile,title:n("workbench.action.terminal.newWithProfile.short","New Terminal With Profile...")},group:"1_create"}},{id:t.TerminalTabEmptyAreaContext,item:{command:{id:e.New,title:o.new},group:"1_create"}}]),l.appendMenuItems([{id:t.TerminalNewDropdownContext,item:{command:{id:e.SelectDefaultProfile,title:y("workbench.action.terminal.selectDefaultProfile","Select Default Profile")},group:"3_configure"}},{id:t.TerminalNewDropdownContext,item:{command:{id:e.ConfigureTerminalSettings,title:n("workbench.action.terminal.openSettings","Configure Terminal Settings")},group:"3_configure"}},{id:t.TerminalNewDropdownContext,item:{command:{id:"workbench.action.tasks.runTask",title:n("workbench.action.tasks.runTask","Run Task...")},when:P,group:"4_tasks",order:1}},{id:t.TerminalNewDropdownContext,item:{command:{id:"workbench.action.tasks.configureTaskRunner",title:n("workbench.action.tasks.configureTaskRunner","Configure Tasks...")},when:P,group:"4_tasks",order:2}}]),l.appendMenuItems([{id:t.ViewTitle,item:{command:{id:e.SwitchTerminal,title:y("workbench.action.terminal.switchTerminal","Switch Terminal")},group:"navigation",order:0,when:r.and(r.equals("view",h),r.not(`config.${w.TabsEnabled}`))}},{id:t.ViewTitle,item:{command:{id:e.Focus,title:o.focus},alt:{id:e.Split,title:o.split.value,icon:d.splitHorizontal},group:"navigation",order:0,when:r.and(r.equals("view",h),r.has(`config.${w.TabsEnabled}`),r.or(r.and(r.equals(`config.${w.TabsShowActiveTerminal}`,"singleTerminal"),r.equals(I.GroupCount,1)),r.and(r.equals(`config.${w.TabsShowActiveTerminal}`,"singleTerminalOrNarrow"),r.or(r.equals(I.GroupCount,1),r.has(I.TabsNarrow))),r.and(r.equals(`config.${w.TabsShowActiveTerminal}`,"singleGroup"),r.equals(I.GroupCount,1)),r.equals(`config.${w.TabsShowActiveTerminal}`,"always")))}},{id:t.ViewTitle,item:{command:{id:e.Split,title:o.split,icon:d.splitHorizontal},group:"navigation",order:2,when:c.shouldShowViewInlineActions}},{id:t.ViewTitle,item:{command:{id:e.Kill,title:o.kill,icon:d.trash},group:"navigation",order:3,when:c.shouldShowViewInlineActions}},{id:t.ViewTitle,item:{command:{id:e.New,title:o.new,icon:d.plus},alt:{id:e.Split,title:o.split.value,icon:d.splitHorizontal},group:"navigation",order:0,when:r.and(r.equals("view",h),r.or(c.webExtensionContributedProfile,c.processSupported))}},{id:t.ViewTitle,item:{command:{id:e.Clear,title:n("workbench.action.terminal.clearLong","Clear Terminal"),icon:d.clearAll},group:"navigation",order:4,when:r.equals("view",h),isHiddenByDefault:!0}},{id:t.ViewTitle,item:{command:{id:e.RunActiveFile,title:n("workbench.action.terminal.runActiveFile","Run Active File"),icon:d.run},group:"navigation",order:5,when:r.equals("view",h),isHiddenByDefault:!0}},{id:t.ViewTitle,item:{command:{id:e.RunSelectedText,title:n("workbench.action.terminal.runSelectedText","Run Selected Text"),icon:d.selection},group:"navigation",order:6,when:r.equals("view",h),isHiddenByDefault:!0}}]),l.appendMenuItems([{id:t.TerminalTabContext,item:{command:{id:e.SplitActiveTab,title:o.split.value},group:"1_create",order:1}},{id:t.TerminalTabContext,item:{command:{id:e.MoveToEditor,title:o.moveToEditor.value},group:"1_create",order:2}},{id:t.TerminalTabContext,item:{command:{id:e.MoveIntoNewWindow,title:o.moveIntoNewWindow.value},group:"1_create",order:2}},{id:t.TerminalTabContext,item:{command:{id:e.RenameActiveTab,title:n("workbench.action.terminal.renameInstance","Rename...")},group:"3_edit"}},{id:t.TerminalTabContext,item:{command:{id:e.ChangeIconActiveTab,title:n("workbench.action.terminal.changeIcon","Change Icon...")},group:"3_edit"}},{id:t.TerminalTabContext,item:{command:{id:e.ChangeColorActiveTab,title:n("workbench.action.terminal.changeColor","Change Color...")},group:"3_edit"}},{id:t.TerminalTabContext,item:{command:{id:e.SizeToContentWidth,title:o.toggleSizeToContentWidth},group:"3_edit"}},{id:t.TerminalTabContext,item:{command:{id:e.JoinActiveTab,title:n("workbench.action.terminal.joinInstance","Join Terminals")},when:c.tabsSingularSelection.toNegated(),group:"9_config"}},{id:t.TerminalTabContext,item:{command:{id:e.Unsplit,title:o.unsplit.value},when:r.and(c.tabsSingularSelection,c.splitTerminal),group:"9_config"}},{id:t.TerminalTabContext,item:{command:{id:e.KillActiveTab,title:o.kill.value},group:"7_kill"}}]),l.appendMenuItem(t.EditorTitleContext,{command:{id:e.MoveToTerminalPanel,title:o.moveToTerminalPanel},when:f.Scheme.isEqualTo(g.vscodeTerminal),group:"2_files"}),l.appendMenuItem(t.EditorTitleContext,{command:{id:e.Rename,title:o.rename},when:f.Scheme.isEqualTo(g.vscodeTerminal),group:"2_files"}),l.appendMenuItem(t.EditorTitleContext,{command:{id:e.ChangeColor,title:o.changeColor},when:f.Scheme.isEqualTo(g.vscodeTerminal),group:"2_files"}),l.appendMenuItem(t.EditorTitleContext,{command:{id:e.ChangeIcon,title:o.changeIcon},when:f.Scheme.isEqualTo(g.vscodeTerminal),group:"2_files"}),l.appendMenuItem(t.EditorTitleContext,{command:{id:e.SizeToContentWidth,title:o.toggleSizeToContentWidth},when:f.Scheme.isEqualTo(g.vscodeTerminal),group:"2_files"}),l.appendMenuItem(t.EditorTitle,{command:{id:e.CreateTerminalEditorSameGroup,title:o.new,icon:d.plus},alt:{id:e.Split,title:o.split.value,icon:d.splitHorizontal},group:"navigation",order:0,when:f.Scheme.isEqualTo(g.vscodeTerminal)})}function ce(u,S,E,N,a,s){let m=[],p=[];S=S.filter(i=>!i.isAutoDetected);const k=u===q.Editor||typeof u=="object"&&"viewColumn"in u&&u.viewColumn===W?{viewColumn:z}:{splitActiveTerminal:!0};for(const i of S){const T=i.profileName===E,C={config:i,location:u},_={config:i,location:k},b=i.profileName.replace(/[\n\r\t]/g,"");m.push(new x(e.NewWithProfile,T?n("defaultTerminalProfile","{0} (Default)",b):b,void 0,!0,async()=>{const A=await a.createTerminal(C);a.setActiveInstance(A),await a.focusActiveInstance()})),p.push(new x(e.Split,T?n("defaultTerminalProfile","{0} (Default)",b):b,void 0,!0,async()=>{const A=await a.createTerminal(_);a.setActiveInstance(A),await a.focusActiveInstance()}))}for(const i of N){const C=i.title===E?n("defaultTerminalProfile","{0} (Default)",i.title.replace(/[\n\r\t]/g,"")):i.title.replace(/[\n\r\t]/g,"");m.push(new x("contributed",C,void 0,!0,()=>a.createTerminal({config:{extensionIdentifier:i.extensionIdentifier,id:i.id,title:C},location:u}))),p.push(new x("contributed-split",C,void 0,!0,()=>a.createTerminal({config:{extensionIdentifier:i.extensionIdentifier,id:i.id,title:C},location:k})))}const v=m.find(i=>i.label.endsWith("(Default)"));v&&(m=m.filter(i=>i!==v).sort((i,T)=>i.label.localeCompare(T.label)),m.unshift(v)),m.length>0&&(m.push(new D("split.profile",n("splitTerminal","Split Terminal"),p)),m.push(new G));const R=s.getActions();m.push(...G.join(...R.map(i=>i[1])));const M=p.find(i=>i.label.endsWith("(Default)"));return M&&(p=p.filter(i=>i!==M).sort((i,T)=>i.label.localeCompare(T.label)),p.unshift(M)),{dropdownAction:new x("refresh profiles",n("launchProfile","Launch Profile..."),"codicon-chevron-down",!0),dropdownMenuActions:m,className:`terminal-tab-actions-${a.resolveLocation(u)}`}}export{V as TerminalMenuBarGroup,ce as getTerminalActionBarArgs,de as setupTerminalMenus};
