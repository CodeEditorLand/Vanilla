{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/terminal/browser/terminalView.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as nls from '../../../../nls.js';\nimport * as dom from '../../../../base/browser/dom.js';\nimport { Action, IAction } from '../../../../base/common/actions.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IContextMenuService, IContextViewService } from '../../../../platform/contextview/browser/contextView.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { ITelemetryService } from '../../../../platform/telemetry/common/telemetry.js';\nimport { IThemeService, Themable } from '../../../../platform/theme/common/themeService.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport { switchTerminalActionViewItemSeparator, switchTerminalShowTabsTitle } from './terminalActions.js';\nimport { INotificationService, IPromptChoice, Severity } from '../../../../platform/notification/common/notification.js';\nimport { ICreateTerminalOptions, ITerminalConfigurationService, ITerminalGroupService, ITerminalInstance, ITerminalService, TerminalConnectionState, TerminalDataTransfers } from './terminal.js';\nimport { ViewPane, IViewPaneOptions } from '../../../browser/parts/views/viewPane.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { IContextKey, IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IViewDescriptorService } from '../../../common/views.js';\nimport { IOpenerService } from '../../../../platform/opener/common/opener.js';\nimport { IMenu, IMenuService, MenuId, MenuItemAction } from '../../../../platform/actions/common/actions.js';\nimport { ITerminalProfileResolverService, ITerminalProfileService, TerminalCommandId } from '../common/terminal.js';\nimport { TerminalSettingId, ITerminalProfile, TerminalLocation } from '../../../../platform/terminal/common/terminal.js';\nimport { ActionViewItem, IBaseActionViewItemOptions, SelectActionViewItem } from '../../../../base/browser/ui/actionbar/actionViewItems.js';\nimport { asCssVariable, selectBorder } from '../../../../platform/theme/common/colorRegistry.js';\nimport { ISelectOptionItem } from '../../../../base/browser/ui/selectBox/selectBox.js';\nimport { IActionViewItem } from '../../../../base/browser/ui/actionbar/actionbar.js';\nimport { TerminalTabbedView } from './terminalTabbedView.js';\nimport { ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { renderLabelWithIcons } from '../../../../base/browser/ui/iconLabel/iconLabels.js';\nimport { getColorForSeverity } from './terminalStatusList.js';\nimport { createAndFillInContextMenuActions, MenuEntryActionViewItem } from '../../../../platform/actions/browser/menuEntryActionViewItem.js';\nimport { DropdownWithPrimaryActionViewItem } from '../../../../platform/actions/browser/dropdownWithPrimaryActionViewItem.js';\nimport { DisposableStore, dispose, IDisposable, MutableDisposable, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { ColorScheme } from '../../../../platform/theme/common/theme.js';\nimport { getColorClass, getUriClasses } from './terminalIcon.js';\nimport { getTerminalActionBarArgs } from './terminalMenus.js';\nimport { TerminalContextKeys } from '../common/terminalContextKey.js';\nimport { getInstanceHoverInfo } from './terminalTooltip.js';\nimport { ServicesAccessor } from '../../../../editor/browser/editorExtensions.js';\nimport { TerminalCapability } from '../../../../platform/terminal/common/capabilities/capabilities.js';\nimport { defaultSelectBoxStyles } from '../../../../platform/theme/browser/defaultStyles.js';\nimport { Event } from '../../../../base/common/event.js';\nimport { IHoverDelegate, IHoverDelegateOptions } from '../../../../base/browser/ui/hover/hoverDelegate.js';\nimport { IHoverService } from '../../../../platform/hover/browser/hover.js';\nimport { IAccessibilityService } from '../../../../platform/accessibility/common/accessibility.js';\nimport { InstanceContext, TerminalContextActionRunner } from './terminalContextMenu.js';\nimport { MicrotaskDelay } from '../../../../base/common/symbols.js';\n\nexport class TerminalViewPane extends ViewPane {\n\tprivate _parentDomElement: HTMLElement | undefined;\n\tprivate _terminalTabbedView?: TerminalTabbedView;\n\tget terminalTabbedView(): TerminalTabbedView | undefined { return this._terminalTabbedView; }\n\tprivate _isInitialized: boolean = false;\n\tprivate readonly _newDropdown: MutableDisposable<DropdownWithPrimaryActionViewItem> = this._register(new MutableDisposable());\n\tprivate readonly _dropdownMenu: IMenu;\n\tprivate readonly _singleTabMenu: IMenu;\n\tprivate _viewShowing: IContextKey<boolean>;\n\tprivate readonly _disposableStore = this._register(new DisposableStore());\n\n\tconstructor(\n\t\toptions: IViewPaneOptions,\n\t\t@IKeybindingService keybindingService: IKeybindingService,\n\t\t@IContextKeyService private readonly _contextKeyService: IContextKeyService,\n\t\t@IViewDescriptorService viewDescriptorService: IViewDescriptorService,\n\t\t@IConfigurationService private readonly _configurationService: IConfigurationService,\n\t\t@IContextMenuService private readonly _contextMenuService: IContextMenuService,\n\t\t@IInstantiationService private readonly _instantiationService: IInstantiationService,\n\t\t@ITerminalService private readonly _terminalService: ITerminalService,\n\t\t@ITerminalConfigurationService private readonly _terminalConfigurationService: ITerminalConfigurationService,\n\t\t@ITerminalGroupService private readonly _terminalGroupService: ITerminalGroupService,\n\t\t@IThemeService themeService: IThemeService,\n\t\t@ITelemetryService telemetryService: ITelemetryService,\n\t\t@IHoverService hoverService: IHoverService,\n\t\t@INotificationService private readonly _notificationService: INotificationService,\n\t\t@IKeybindingService private readonly _keybindingService: IKeybindingService,\n\t\t@IOpenerService openerService: IOpenerService,\n\t\t@IMenuService private readonly _menuService: IMenuService,\n\t\t@ITerminalProfileService private readonly _terminalProfileService: ITerminalProfileService,\n\t\t@ITerminalProfileResolverService private readonly _terminalProfileResolverService: ITerminalProfileResolverService,\n\t\t@IThemeService private readonly _themeService: IThemeService,\n\t\t@IAccessibilityService private readonly _accessibilityService: IAccessibilityService\n\t) {\n\t\tsuper(options, keybindingService, _contextMenuService, _configurationService, _contextKeyService, viewDescriptorService, _instantiationService, openerService, themeService, telemetryService, hoverService);\n\t\tthis._register(this._terminalService.onDidRegisterProcessSupport(() => {\n\t\t\tthis._onDidChangeViewWelcomeState.fire();\n\t\t}));\n\n\t\tthis._register(this._terminalService.onDidChangeInstances(() => {\n\t\t\t// If the first terminal is opened, hide the welcome view\n\t\t\t// and if the last one is closed, show it again\n\t\t\tif (this._hasWelcomeScreen() && this._terminalGroupService.instances.length <= 1) {\n\t\t\t\tthis._onDidChangeViewWelcomeState.fire();\n\t\t\t}\n\t\t\tif (!this._parentDomElement) { return; }\n\t\t\t// If we do not have the tab view yet, create it now.\n\t\t\tif (!this._terminalTabbedView) {\n\t\t\t\tthis._createTabsView();\n\t\t\t}\n\t\t\t// If we just opened our first terminal, layout\n\t\t\tif (this._terminalGroupService.instances.length === 1) {\n\t\t\t\tthis.layoutBody(this._parentDomElement.offsetHeight, this._parentDomElement.offsetWidth);\n\t\t\t}\n\t\t}));\n\t\tthis._dropdownMenu = this._register(this._menuService.createMenu(MenuId.TerminalNewDropdownContext, this._contextKeyService));\n\t\tthis._singleTabMenu = this._register(this._menuService.createMenu(MenuId.TerminalTabContext, this._contextKeyService));\n\t\tthis._register(this._terminalProfileService.onDidChangeAvailableProfiles(profiles => this._updateTabActionBar(profiles)));\n\t\tthis._viewShowing = TerminalContextKeys.viewShowing.bindTo(this._contextKeyService);\n\t\tthis._register(this.onDidChangeBodyVisibility(e => {\n\t\t\tif (e) {\n\t\t\t\tthis._terminalTabbedView?.rerenderTabs();\n\t\t\t}\n\t\t}));\n\t\tthis._register(this._configurationService.onDidChangeConfiguration(e => {\n\t\t\tif (this._parentDomElement && (e.affectsConfiguration(TerminalSettingId.ShellIntegrationDecorationsEnabled) || e.affectsConfiguration(TerminalSettingId.ShellIntegrationEnabled))) {\n\t\t\t\tthis._updateForShellIntegration(this._parentDomElement);\n\t\t\t}\n\t\t}));\n\t\tthis._register(this._terminalService.onDidCreateInstance((i) => {\n\t\t\ti.capabilities.onDidAddCapabilityType(c => {\n\t\t\t\tif (c === TerminalCapability.CommandDetection && this._gutterDecorationsEnabled()) {\n\t\t\t\t\tthis._parentDomElement?.classList.add('shell-integration');\n\t\t\t\t}\n\t\t\t});\n\t\t}));\n\t}\n\n\tprivate _updateForShellIntegration(container: HTMLElement) {\n\t\tcontainer.classList.toggle('shell-integration', this._gutterDecorationsEnabled());\n\t}\n\n\tprivate _gutterDecorationsEnabled(): boolean {\n\t\tconst decorationsEnabled = this._configurationService.getValue(TerminalSettingId.ShellIntegrationDecorationsEnabled);\n\t\treturn (decorationsEnabled === 'both' || decorationsEnabled === 'gutter') && this._configurationService.getValue(TerminalSettingId.ShellIntegrationEnabled);\n\t}\n\n\tprivate _initializeTerminal(checkRestoredTerminals: boolean) {\n\t\tif (this.isBodyVisible() && this._terminalService.isProcessSupportRegistered && this._terminalService.connectionState === TerminalConnectionState.Connected) {\n\t\t\tconst wasInitialized = this._isInitialized;\n\t\t\tthis._isInitialized = true;\n\n\t\t\tlet hideOnStartup: 'never' | 'whenEmpty' | 'always' = 'never';\n\t\t\tif (!wasInitialized) {\n\t\t\t\thideOnStartup = this._configurationService.getValue(TerminalSettingId.HideOnStartup);\n\t\t\t\tif (hideOnStartup === 'always') {\n\t\t\t\t\tthis._terminalGroupService.hidePanel();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlet shouldCreate = this._terminalGroupService.groups.length === 0;\n\t\t\t// When triggered just after reconnection, also check there are no groups that could be\n\t\t\t// getting restored currently\n\t\t\tif (checkRestoredTerminals) {\n\t\t\t\tshouldCreate &&= this._terminalService.restoredGroupCount === 0;\n\t\t\t}\n\t\t\tif (!shouldCreate) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (!wasInitialized) {\n\t\t\t\tswitch (hideOnStartup) {\n\t\t\t\t\tcase 'never':\n\t\t\t\t\t\tthis._terminalService.createTerminal({ location: TerminalLocation.Panel });\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'whenEmpty':\n\t\t\t\t\t\tif (this._terminalService.restoredGroupCount === 0) {\n\t\t\t\t\t\t\tthis._terminalGroupService.hidePanel();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis._terminalService.createTerminal({ location: TerminalLocation.Panel });\n\t\t}\n\t}\n\n\t// eslint-disable-next-line @typescript-eslint/naming-convention\n\tprotected override renderBody(container: HTMLElement): void {\n\t\tsuper.renderBody(container);\n\n\t\tif (!this._parentDomElement) {\n\t\t\tthis._updateForShellIntegration(container);\n\t\t}\n\t\tthis._parentDomElement = container;\n\t\tthis._parentDomElement.classList.add('integrated-terminal');\n\t\tdom.createStyleSheet(this._parentDomElement);\n\t\tthis._instantiationService.createInstance(TerminalThemeIconStyle, this._parentDomElement);\n\n\t\tif (!this.shouldShowWelcome()) {\n\t\t\tthis._createTabsView();\n\t\t}\n\n\t\tthis._register(this.configurationService.onDidChangeConfiguration(e => {\n\t\t\tif (e.affectsConfiguration(TerminalSettingId.FontFamily) || e.affectsConfiguration('editor.fontFamily')) {\n\t\t\t\tif (!this._terminalConfigurationService.configFontIsMonospace()) {\n\t\t\t\t\tconst choices: IPromptChoice[] = [{\n\t\t\t\t\t\tlabel: nls.localize('terminal.useMonospace', \"Use 'monospace'\"),\n\t\t\t\t\t\trun: () => this.configurationService.updateValue(TerminalSettingId.FontFamily, 'monospace'),\n\t\t\t\t\t}];\n\t\t\t\t\tthis._notificationService.prompt(Severity.Warning, nls.localize('terminal.monospaceOnly', \"The terminal only supports monospace fonts. Be sure to restart VS Code if this is a newly installed font.\"), choices);\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\t\tthis._register(this.onDidChangeBodyVisibility(async visible => {\n\t\t\tthis._viewShowing.set(visible);\n\t\t\tif (visible) {\n\t\t\t\tif (this._hasWelcomeScreen()) {\n\t\t\t\t\tthis._onDidChangeViewWelcomeState.fire();\n\t\t\t\t}\n\t\t\t\tthis._initializeTerminal(false);\n\t\t\t\t// we don't know here whether or not it should be focused, so\n\t\t\t\t// defer focusing the panel to the focus() call\n\t\t\t\t// to prevent overriding preserveFocus for extensions\n\t\t\t\tthis._terminalGroupService.showPanel(false);\n\t\t\t} else {\n\t\t\t\tfor (const instance of this._terminalGroupService.instances) {\n\t\t\t\t\tinstance.resetFocusContextKey();\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._terminalGroupService.updateVisibility();\n\t\t}));\n\t\tthis._register(this._terminalService.onDidChangeConnectionState(() => this._initializeTerminal(true)));\n\t\tthis.layoutBody(this._parentDomElement.offsetHeight, this._parentDomElement.offsetWidth);\n\t}\n\n\tprivate _createTabsView(): void {\n\t\tif (!this._parentDomElement) {\n\t\t\treturn;\n\t\t}\n\t\tthis._terminalTabbedView = this._register(this.instantiationService.createInstance(TerminalTabbedView, this._parentDomElement));\n\t}\n\n\t// eslint-disable-next-line @typescript-eslint/naming-convention\n\tprotected override layoutBody(height: number, width: number): void {\n\t\tsuper.layoutBody(height, width);\n\t\tthis._terminalTabbedView?.layout(width, height);\n\t}\n\n\toverride getActionViewItem(action: Action, options: IBaseActionViewItemOptions): IActionViewItem | undefined {\n\t\tswitch (action.id) {\n\t\t\tcase TerminalCommandId.Split: {\n\t\t\t\t// Split needs to be special cased to force splitting within the panel, not the editor\n\t\t\t\tconst that = this;\n\t\t\t\tconst panelOnlySplitAction = new class extends Action {\n\t\t\t\t\tconstructor() {\n\t\t\t\t\t\tsuper(action.id, action.label, action.class, action.enabled);\n\t\t\t\t\t\tthis.checked = action.checked;\n\t\t\t\t\t\tthis.tooltip = action.tooltip;\n\t\t\t\t\t\tthis._register(action);\n\t\t\t\t\t}\n\t\t\t\t\toverride async run() {\n\t\t\t\t\t\tconst instance = that._terminalGroupService.activeInstance;\n\t\t\t\t\t\tif (instance) {\n\t\t\t\t\t\t\tconst newInstance = await that._terminalService.createTerminal({ location: { parentTerminal: instance } });\n\t\t\t\t\t\t\treturn newInstance?.focusWhenReady();\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\treturn new ActionViewItem(action, panelOnlySplitAction, { ...options, icon: true, label: false, keybinding: this._getKeybindingLabel(action) });\n\t\t\t}\n\t\t\tcase TerminalCommandId.SwitchTerminal: {\n\t\t\t\treturn this._instantiationService.createInstance(SwitchTerminalActionViewItem, action);\n\t\t\t}\n\t\t\tcase TerminalCommandId.Focus: {\n\t\t\t\tif (action instanceof MenuItemAction) {\n\t\t\t\t\tconst actions: IAction[] = [];\n\t\t\t\t\tcreateAndFillInContextMenuActions(this._singleTabMenu, { shouldForwardArgs: true }, actions);\n\t\t\t\t\treturn this._instantiationService.createInstance(SingleTerminalTabActionViewItem, action, actions);\n\t\t\t\t}\n\t\t\t}\n\t\t\tcase TerminalCommandId.New: {\n\t\t\t\tif (action instanceof MenuItemAction) {\n\t\t\t\t\tconst actions = getTerminalActionBarArgs(TerminalLocation.Panel, this._terminalProfileService.availableProfiles, this._getDefaultProfileName(), this._terminalProfileService.contributedProfiles, this._terminalService, this._dropdownMenu);\n\t\t\t\t\tthis._registerDisposableActions(actions.dropdownAction, actions.dropdownMenuActions);\n\t\t\t\t\tthis._newDropdown.value = new DropdownWithPrimaryActionViewItem(action, actions.dropdownAction, actions.dropdownMenuActions, actions.className, this._contextMenuService, { hoverDelegate: options.hoverDelegate }, this._keybindingService, this._notificationService, this._contextKeyService, this._themeService, this._accessibilityService);\n\t\t\t\t\tthis._newDropdown.value?.update(actions.dropdownAction, actions.dropdownMenuActions);\n\t\t\t\t\treturn this._newDropdown.value;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn super.getActionViewItem(action, options);\n\t}\n\n\t/**\n\t * Actions might be of type Action (disposable) or Separator or SubmenuAction, which don't extend Disposable\n\t */\n\tprivate _registerDisposableActions(dropdownAction: IAction, dropdownMenuActions: IAction[]): void {\n\t\tthis._disposableStore.clear();\n\t\tif (dropdownAction instanceof Action) {\n\t\t\tthis._disposableStore.add(dropdownAction);\n\t\t}\n\t\tdropdownMenuActions.filter(a => a instanceof Action).forEach(a => this._disposableStore.add(a));\n\t}\n\n\tprivate _getDefaultProfileName(): string {\n\t\tlet defaultProfileName;\n\t\ttry {\n\t\t\tdefaultProfileName = this._terminalProfileService.getDefaultProfileName();\n\t\t} catch (e) {\n\t\t\tdefaultProfileName = this._terminalProfileResolverService.defaultProfileName;\n\t\t}\n\t\treturn defaultProfileName!;\n\t}\n\n\tprivate _getKeybindingLabel(action: IAction): string | undefined {\n\t\treturn this._keybindingService.lookupKeybinding(action.id)?.getLabel() ?? undefined;\n\t}\n\n\tprivate _updateTabActionBar(profiles: ITerminalProfile[]): void {\n\t\tconst actions = getTerminalActionBarArgs(TerminalLocation.Panel, profiles, this._getDefaultProfileName(), this._terminalProfileService.contributedProfiles, this._terminalService, this._dropdownMenu);\n\t\tthis._registerDisposableActions(actions.dropdownAction, actions.dropdownMenuActions);\n\t\tthis._newDropdown.value?.update(actions.dropdownAction, actions.dropdownMenuActions);\n\t}\n\n\toverride focus() {\n\t\tsuper.focus();\n\t\tif (this._terminalService.connectionState === TerminalConnectionState.Connected) {\n\t\t\tthis._terminalGroupService.showPanel(true);\n\t\t\treturn;\n\t\t}\n\n\t\t// If the terminal is waiting to reconnect to remote terminals, then there is no TerminalInstance yet that can\n\t\t// be focused. So wait for connection to finish, then focus.\n\t\tconst previousActiveElement = this.element.ownerDocument.activeElement;\n\t\tif (previousActiveElement) {\n\t\t\t// TODO: Improve lifecycle management this event should be disposed after first fire\n\t\t\tthis._register(this._terminalService.onDidChangeConnectionState(() => {\n\t\t\t\t// Only focus the terminal if the activeElement has not changed since focus() was called\n\t\t\t\t// TODO: Hack\n\t\t\t\tif (previousActiveElement && dom.isActiveElement(previousActiveElement)) {\n\t\t\t\t\tthis._terminalGroupService.showPanel(true);\n\t\t\t\t}\n\t\t\t}));\n\t\t}\n\t}\n\n\tprivate _hasWelcomeScreen(): boolean {\n\t\treturn !this._terminalService.isProcessSupportRegistered;\n\t}\n\n\toverride shouldShowWelcome(): boolean {\n\t\treturn this._hasWelcomeScreen() && this._terminalService.instances.length === 0;\n\t}\n}\n\nclass SwitchTerminalActionViewItem extends SelectActionViewItem {\n\tconstructor(\n\t\taction: IAction,\n\t\t@ITerminalService private readonly _terminalService: ITerminalService,\n\t\t@ITerminalGroupService private readonly _terminalGroupService: ITerminalGroupService,\n\t\t@IContextViewService contextViewService: IContextViewService,\n\t\t@ITerminalProfileService terminalProfileService: ITerminalProfileService\n\t) {\n\t\tsuper(null, action, getTerminalSelectOpenItems(_terminalService, _terminalGroupService), _terminalGroupService.activeGroupIndex, contextViewService, defaultSelectBoxStyles, { ariaLabel: nls.localize('terminals', 'Open Terminals.'), optionsAsChildren: true });\n\t\tthis._register(_terminalService.onDidChangeInstances(() => this._updateItems(), this));\n\t\tthis._register(_terminalService.onDidChangeActiveGroup(() => this._updateItems(), this));\n\t\tthis._register(_terminalService.onDidChangeActiveInstance(() => this._updateItems(), this));\n\t\tthis._register(_terminalService.onAnyInstanceTitleChange(() => this._updateItems(), this));\n\t\tthis._register(_terminalGroupService.onDidChangeGroups(() => this._updateItems(), this));\n\t\tthis._register(_terminalService.onDidChangeConnectionState(() => this._updateItems(), this));\n\t\tthis._register(terminalProfileService.onDidChangeAvailableProfiles(() => this._updateItems(), this));\n\t\tthis._register(_terminalService.onAnyInstancePrimaryStatusChange(() => this._updateItems(), this));\n\t}\n\n\toverride render(container: HTMLElement): void {\n\t\tsuper.render(container);\n\t\tcontainer.classList.add('switch-terminal');\n\t\tcontainer.style.borderColor = asCssVariable(selectBorder);\n\t}\n\n\tprivate _updateItems(): void {\n\t\tconst options = getTerminalSelectOpenItems(this._terminalService, this._terminalGroupService);\n\t\tthis.setOptions(options, this._terminalGroupService.activeGroupIndex);\n\t}\n}\n\nfunction getTerminalSelectOpenItems(terminalService: ITerminalService, terminalGroupService: ITerminalGroupService): ISelectOptionItem[] {\n\tlet items: ISelectOptionItem[];\n\tif (terminalService.connectionState === TerminalConnectionState.Connected) {\n\t\titems = terminalGroupService.getGroupLabels().map(label => {\n\t\t\treturn { text: label };\n\t\t});\n\t} else {\n\t\titems = [{ text: nls.localize('terminalConnectingLabel', \"Starting...\") }];\n\t}\n\titems.push({ text: switchTerminalActionViewItemSeparator, isDisabled: true });\n\titems.push({ text: switchTerminalShowTabsTitle });\n\treturn items;\n}\n\nclass SingleTerminalTabActionViewItem extends MenuEntryActionViewItem {\n\tprivate _color: string | undefined;\n\tprivate _altCommand: string | undefined;\n\tprivate _class: string | undefined;\n\tprivate readonly _elementDisposables: IDisposable[] = [];\n\n\tconstructor(\n\t\taction: MenuItemAction,\n\t\tprivate readonly _actions: IAction[],\n\t\t@IKeybindingService keybindingService: IKeybindingService,\n\t\t@INotificationService notificationService: INotificationService,\n\t\t@IContextKeyService contextKeyService: IContextKeyService,\n\t\t@IThemeService themeService: IThemeService,\n\t\t@ITerminalService private readonly _terminalService: ITerminalService,\n\t\t@ITerminalConfigurationService private readonly _terminaConfigurationService: ITerminalConfigurationService,\n\t\t@ITerminalGroupService private readonly _terminalGroupService: ITerminalGroupService,\n\t\t@IContextMenuService contextMenuService: IContextMenuService,\n\t\t@ICommandService private readonly _commandService: ICommandService,\n\t\t@IInstantiationService private readonly _instantiationService: IInstantiationService,\n\t\t@IAccessibilityService _accessibilityService: IAccessibilityService\n\t) {\n\t\tsuper(action, {\n\t\t\tdraggable: true,\n\t\t\thoverDelegate: _instantiationService.createInstance(SingleTabHoverDelegate)\n\t\t}, keybindingService, notificationService, contextKeyService, themeService, contextMenuService, _accessibilityService);\n\n\t\t// Register listeners to update the tab\n\t\tthis._register(Event.debounce<ITerminalInstance | undefined, Set<ITerminalInstance>>(Event.any(\n\t\t\tthis._terminalService.onAnyInstancePrimaryStatusChange,\n\t\t\tthis._terminalGroupService.onDidChangeActiveInstance,\n\t\t\tEvent.map(this._terminalService.onAnyInstanceIconChange, e => e.instance),\n\t\t\tthis._terminalService.onAnyInstanceTitleChange,\n\t\t\tthis._terminalService.onDidChangeInstanceCapability,\n\t\t), (last, e) => {\n\t\t\tif (!last) {\n\t\t\t\tlast = new Set();\n\t\t\t}\n\t\t\tif (e) {\n\t\t\t\tlast.add(e);\n\t\t\t}\n\t\t\treturn last;\n\t\t}, MicrotaskDelay)(merged => {\n\t\t\tfor (const e of merged) {\n\t\t\t\tthis.updateLabel(e);\n\t\t\t}\n\t\t}));\n\n\t\t// Clean up on dispose\n\t\tthis._register(toDisposable(() => dispose(this._elementDisposables)));\n\t}\n\n\toverride async onClick(event: MouseEvent): Promise<void> {\n\t\tthis._terminalGroupService.lastAccessedMenu = 'inline-tab';\n\t\tif (event.altKey && this._menuItemAction.alt) {\n\t\t\tthis._commandService.executeCommand(this._menuItemAction.alt.id, { location: TerminalLocation.Panel } satisfies ICreateTerminalOptions);\n\t\t} else {\n\t\t\tthis._openContextMenu();\n\t\t}\n\t}\n\n\t// eslint-disable-next-line @typescript-eslint/naming-convention\n\tprotected override updateLabel(e?: ITerminalInstance): void {\n\t\t// Only update if it's the active instance\n\t\tif (e && e !== this._terminalGroupService.activeInstance) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._elementDisposables.length === 0 && this.element && this.label) {\n\t\t\t// Right click opens context menu\n\t\t\tthis._elementDisposables.push(dom.addDisposableListener(this.element, dom.EventType.CONTEXT_MENU, e => {\n\t\t\t\tif (e.button === 2) {\n\t\t\t\t\tthis._openContextMenu();\n\t\t\t\t\te.preventDefault();\n\t\t\t\t}\n\t\t\t}));\n\t\t\t// Middle click kills\n\t\t\tthis._elementDisposables.push(dom.addDisposableListener(this.element, dom.EventType.AUXCLICK, e => {\n\t\t\t\tif (e.button === 1) {\n\t\t\t\t\tconst instance = this._terminalGroupService.activeInstance;\n\t\t\t\t\tif (instance) {\n\t\t\t\t\t\tthis._terminalService.safeDisposeTerminal(instance);\n\t\t\t\t\t}\n\t\t\t\t\te.preventDefault();\n\t\t\t\t}\n\t\t\t}));\n\t\t\t// Drag and drop\n\t\t\tthis._elementDisposables.push(dom.addDisposableListener(this.element, dom.EventType.DRAG_START, e => {\n\t\t\t\tconst instance = this._terminalGroupService.activeInstance;\n\t\t\t\tif (e.dataTransfer && instance) {\n\t\t\t\t\te.dataTransfer.setData(TerminalDataTransfers.Terminals, JSON.stringify([instance.resource.toString()]));\n\t\t\t\t}\n\t\t\t}));\n\t\t}\n\t\tif (this.label) {\n\t\t\tconst label = this.label;\n\t\t\tconst instance = this._terminalGroupService.activeInstance;\n\t\t\tif (!instance) {\n\t\t\t\tdom.reset(label, '');\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tlabel.classList.add('single-terminal-tab');\n\t\t\tlet colorStyle = '';\n\t\t\tconst primaryStatus = instance.statusList.primary;\n\t\t\tif (primaryStatus) {\n\t\t\t\tconst colorKey = getColorForSeverity(primaryStatus.severity);\n\t\t\t\tthis._themeService.getColorTheme();\n\t\t\t\tconst foundColor = this._themeService.getColorTheme().getColor(colorKey);\n\t\t\t\tif (foundColor) {\n\t\t\t\t\tcolorStyle = foundColor.toString();\n\t\t\t\t}\n\t\t\t}\n\t\t\tlabel.style.color = colorStyle;\n\t\t\tdom.reset(label, ...renderLabelWithIcons(this._instantiationService.invokeFunction(getSingleTabLabel, instance, this._terminaConfigurationService.config.tabs.separator, ThemeIcon.isThemeIcon(this._commandAction.item.icon) ? this._commandAction.item.icon : undefined)));\n\n\t\t\tif (this._altCommand) {\n\t\t\t\tlabel.classList.remove(this._altCommand);\n\t\t\t\tthis._altCommand = undefined;\n\t\t\t}\n\t\t\tif (this._color) {\n\t\t\t\tlabel.classList.remove(this._color);\n\t\t\t\tthis._color = undefined;\n\t\t\t}\n\t\t\tif (this._class) {\n\t\t\t\tlabel.classList.remove(this._class);\n\t\t\t\tlabel.classList.remove('terminal-uri-icon');\n\t\t\t\tthis._class = undefined;\n\t\t\t}\n\t\t\tconst colorClass = getColorClass(instance);\n\t\t\tif (colorClass) {\n\t\t\t\tthis._color = colorClass;\n\t\t\t\tlabel.classList.add(colorClass);\n\t\t\t}\n\t\t\tconst uriClasses = getUriClasses(instance, this._themeService.getColorTheme().type);\n\t\t\tif (uriClasses) {\n\t\t\t\tthis._class = uriClasses?.[0];\n\t\t\t\tlabel.classList.add(...uriClasses);\n\t\t\t}\n\t\t\tif (this._commandAction.item.icon) {\n\t\t\t\tthis._altCommand = `alt-command`;\n\t\t\t\tlabel.classList.add(this._altCommand);\n\t\t\t}\n\t\t\tthis.updateTooltip();\n\t\t}\n\t}\n\n\tprivate _openContextMenu() {\n\t\tthis._contextMenuService.showContextMenu({\n\t\t\tactionRunner: new TerminalContextActionRunner(),\n\t\t\tgetAnchor: () => this.element!,\n\t\t\tgetActions: () => this._actions,\n\t\t\t// The context is always the active instance in the terminal view\n\t\t\tgetActionsContext: () => {\n\t\t\t\tconst instance = this._terminalGroupService.activeInstance;\n\t\t\t\treturn instance ? [new InstanceContext(instance)] : [];\n\t\t\t}\n\t\t});\n\t}\n}\n\nfunction getSingleTabLabel(accessor: ServicesAccessor, instance: ITerminalInstance | undefined, separator: string, icon?: ThemeIcon) {\n\t// Don't even show the icon if there is no title as the icon would shift around when the title\n\t// is added\n\tif (!instance || !instance.title) {\n\t\treturn '';\n\t}\n\tconst iconId = ThemeIcon.isThemeIcon(instance.icon) ? instance.icon.id : accessor.get(ITerminalProfileResolverService).getDefaultIcon().id;\n\tconst label = `$(${icon?.id || iconId}) ${getSingleTabTitle(instance, separator)}`;\n\n\tconst primaryStatus = instance.statusList.primary;\n\tif (!primaryStatus?.icon) {\n\t\treturn label;\n\t}\n\treturn `${label} $(${primaryStatus.icon.id})`;\n}\n\nfunction getSingleTabTitle(instance: ITerminalInstance | undefined, separator: string): string {\n\tif (!instance) {\n\t\treturn '';\n\t}\n\treturn !instance.description ? instance.title : `${instance.title} ${separator} ${instance.description}`;\n}\n\nclass TerminalThemeIconStyle extends Themable {\n\tprivate _styleElement: HTMLElement;\n\tconstructor(\n\t\tcontainer: HTMLElement,\n\t\t@IThemeService private readonly _themeService: IThemeService,\n\t\t@ITerminalService private readonly _terminalService: ITerminalService,\n\t\t@ITerminalGroupService private readonly _terminalGroupService: ITerminalGroupService\n\t) {\n\t\tsuper(_themeService);\n\t\tthis._registerListeners();\n\t\tthis._styleElement = dom.createStyleSheet(container);\n\t\tthis._register(toDisposable(() => this._styleElement.remove()));\n\t\tthis.updateStyles();\n\t}\n\n\tprivate _registerListeners(): void {\n\t\tthis._register(this._terminalService.onAnyInstanceIconChange(() => this.updateStyles()));\n\t\tthis._register(this._terminalService.onDidChangeInstances(() => this.updateStyles()));\n\t\tthis._register(this._terminalGroupService.onDidChangeGroups(() => this.updateStyles()));\n\t}\n\n\toverride updateStyles(): void {\n\t\tsuper.updateStyles();\n\t\tconst colorTheme = this._themeService.getColorTheme();\n\n\t\t// TODO: add a rule collector to avoid duplication\n\t\tlet css = '';\n\n\t\t// Add icons\n\t\tfor (const instance of this._terminalService.instances) {\n\t\t\tconst icon = instance.icon;\n\t\t\tif (!icon) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tlet uri = undefined;\n\t\t\tif (icon instanceof URI) {\n\t\t\t\turi = icon;\n\t\t\t} else if (icon instanceof Object && 'light' in icon && 'dark' in icon) {\n\t\t\t\turi = colorTheme.type === ColorScheme.LIGHT ? icon.light : icon.dark;\n\t\t\t}\n\t\t\tconst iconClasses = getUriClasses(instance, colorTheme.type);\n\t\t\tif (uri instanceof URI && iconClasses && iconClasses.length > 1) {\n\t\t\t\tcss += (\n\t\t\t\t\t`.monaco-workbench .${iconClasses[0]} .monaco-highlighted-label .codicon, .monaco-action-bar .terminal-uri-icon.single-terminal-tab.action-label:not(.alt-command) .codicon` +\n\t\t\t\t\t`{background-image: ${dom.asCSSUrl(uri)};}`\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\t// Add colors\n\t\tfor (const instance of this._terminalService.instances) {\n\t\t\tconst colorClass = getColorClass(instance);\n\t\t\tif (!colorClass || !instance.color) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tconst color = colorTheme.getColor(instance.color);\n\t\t\tif (color) {\n\t\t\t\t// exclude status icons (file-icon) and inline action icons (trashcan and horizontalSplit)\n\t\t\t\tcss += (\n\t\t\t\t\t`.monaco-workbench .${colorClass} .codicon:first-child:not(.codicon-split-horizontal):not(.codicon-trashcan):not(.file-icon)` +\n\t\t\t\t\t`{ color: ${color} !important; }`\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tthis._styleElement.textContent = css;\n\t}\n}\n\nclass SingleTabHoverDelegate implements IHoverDelegate {\n\tprivate _lastHoverHideTime: number = 0;\n\n\treadonly placement = 'element';\n\n\tconstructor(\n\t\t@IConfigurationService private readonly _configurationService: IConfigurationService,\n\t\t@IHoverService private readonly _hoverService: IHoverService,\n\t\t@ITerminalGroupService private readonly _terminalGroupService: ITerminalGroupService\n\t) {\n\t}\n\n\tget delay(): number {\n\t\treturn Date.now() - this._lastHoverHideTime < 200\n\t\t\t? 0  // show instantly when a hover was recently shown\n\t\t\t: this._configurationService.getValue<number>('workbench.hover.delay');\n\t}\n\n\tshowHover(options: IHoverDelegateOptions, focus?: boolean) {\n\t\tconst instance = this._terminalGroupService.activeInstance;\n\t\tif (!instance) {\n\t\t\treturn;\n\t\t}\n\t\tconst hoverInfo = getInstanceHoverInfo(instance);\n\t\treturn this._hoverService.showHover({\n\t\t\t...options,\n\t\t\tcontent: hoverInfo.content,\n\t\t\tactions: hoverInfo.actions\n\t\t}, focus);\n\t}\n\n\tonDidHideHover() {\n\t\tthis._lastHoverHideTime = Date.now();\n\t}\n}\n"],
  "mappings": "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",
  "names": ["e"]
}
