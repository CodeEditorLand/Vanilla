{
  "version": 3,
  "sources": ["../../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/terminal/browser/widgets/terminalHoverWidget.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Disposable, toDisposable } from '../../../../../base/common/lifecycle.js';\nimport { IMarkdownString } from '../../../../../base/common/htmlContent.js';\nimport { Widget } from '../../../../../base/browser/ui/widget.js';\nimport { ITerminalWidget } from './widgets.js';\nimport * as dom from '../../../../../base/browser/dom.js';\nimport type { IViewportRange } from '@xterm/xterm';\nimport { IHoverService } from '../../../../../platform/hover/browser/hover.js';\nimport { IConfigurationService } from '../../../../../platform/configuration/common/configuration.js';\nimport { TerminalSettingId } from '../../../../../platform/terminal/common/terminal.js';\nimport type { IHoverAction, IHoverTarget } from '../../../../../base/browser/ui/hover/hover.js';\n\nconst $ = dom.$;\n\nexport interface ILinkHoverTargetOptions {\n\treadonly viewportRange: IViewportRange;\n\treadonly cellDimensions: { width: number; height: number };\n\treadonly terminalDimensions: { width: number; height: number };\n\treadonly modifierDownCallback?: () => void;\n\treadonly modifierUpCallback?: () => void;\n}\n\nexport class TerminalHover extends Disposable implements ITerminalWidget {\n\treadonly id = 'hover';\n\n\tconstructor(\n\t\tprivate readonly _targetOptions: ILinkHoverTargetOptions,\n\t\tprivate readonly _text: IMarkdownString,\n\t\tprivate readonly _actions: IHoverAction[] | undefined,\n\t\tprivate readonly _linkHandler: (url: string) => any,\n\t\t@IHoverService private readonly _hoverService: IHoverService,\n\t\t@IConfigurationService private readonly _configurationService: IConfigurationService\n\t) {\n\t\tsuper();\n\t}\n\n\tattach(container: HTMLElement): void {\n\t\tconst showLinkHover = this._configurationService.getValue(TerminalSettingId.ShowLinkHover);\n\t\tif (!showLinkHover) {\n\t\t\treturn;\n\t\t}\n\t\tconst target = new CellHoverTarget(container, this._targetOptions);\n\t\tconst hover = this._hoverService.showHover({\n\t\t\ttarget,\n\t\t\tcontent: this._text,\n\t\t\tactions: this._actions,\n\t\t\tlinkHandler: this._linkHandler,\n\t\t\t// .xterm-hover lets xterm know that the hover is part of a link\n\t\t\tadditionalClasses: ['xterm-hover']\n\t\t});\n\t\tif (hover) {\n\t\t\tthis._register(hover);\n\t\t}\n\t}\n}\n\nclass CellHoverTarget extends Widget implements IHoverTarget {\n\tprivate _domNode: HTMLElement;\n\tprivate readonly _targetElements: HTMLElement[] = [];\n\n\tget targetElements(): readonly HTMLElement[] { return this._targetElements; }\n\n\tconstructor(\n\t\tcontainer: HTMLElement,\n\t\tprivate readonly _options: ILinkHoverTargetOptions\n\t) {\n\t\tsuper();\n\n\t\tthis._domNode = $('div.terminal-hover-targets.xterm-hover');\n\t\tconst rowCount = this._options.viewportRange.end.y - this._options.viewportRange.start.y + 1;\n\n\t\t// Add top target row\n\t\tconst width = (this._options.viewportRange.end.y > this._options.viewportRange.start.y ? this._options.terminalDimensions.width - this._options.viewportRange.start.x : this._options.viewportRange.end.x - this._options.viewportRange.start.x + 1) * this._options.cellDimensions.width;\n\t\tconst topTarget = $('div.terminal-hover-target.hoverHighlight');\n\t\ttopTarget.style.left = `${this._options.viewportRange.start.x * this._options.cellDimensions.width}px`;\n\t\ttopTarget.style.bottom = `${(this._options.terminalDimensions.height - this._options.viewportRange.start.y - 1) * this._options.cellDimensions.height}px`;\n\t\ttopTarget.style.width = `${width}px`;\n\t\ttopTarget.style.height = `${this._options.cellDimensions.height}px`;\n\t\tthis._targetElements.push(this._domNode.appendChild(topTarget));\n\n\t\t// Add middle target rows\n\t\tif (rowCount > 2) {\n\t\t\tconst middleTarget = $('div.terminal-hover-target.hoverHighlight');\n\t\t\tmiddleTarget.style.left = `0px`;\n\t\t\tmiddleTarget.style.bottom = `${(this._options.terminalDimensions.height - this._options.viewportRange.start.y - 1 - (rowCount - 2)) * this._options.cellDimensions.height}px`;\n\t\t\tmiddleTarget.style.width = `${this._options.terminalDimensions.width * this._options.cellDimensions.width}px`;\n\t\t\tmiddleTarget.style.height = `${(rowCount - 2) * this._options.cellDimensions.height}px`;\n\t\t\tthis._targetElements.push(this._domNode.appendChild(middleTarget));\n\t\t}\n\n\t\t// Add bottom target row\n\t\tif (rowCount > 1) {\n\t\t\tconst bottomTarget = $('div.terminal-hover-target.hoverHighlight');\n\t\t\tbottomTarget.style.left = `0px`;\n\t\t\tbottomTarget.style.bottom = `${(this._options.terminalDimensions.height - this._options.viewportRange.end.y - 1) * this._options.cellDimensions.height}px`;\n\t\t\tbottomTarget.style.width = `${(this._options.viewportRange.end.x + 1) * this._options.cellDimensions.width}px`;\n\t\t\tbottomTarget.style.height = `${this._options.cellDimensions.height}px`;\n\t\t\tthis._targetElements.push(this._domNode.appendChild(bottomTarget));\n\t\t}\n\n\t\tif (this._options.modifierDownCallback && this._options.modifierUpCallback) {\n\t\t\tlet down = false;\n\t\t\tthis._register(dom.addDisposableListener(container.ownerDocument, 'keydown', e => {\n\t\t\t\tif (e.ctrlKey && !down) {\n\t\t\t\t\tdown = true;\n\t\t\t\t\tthis._options.modifierDownCallback!();\n\t\t\t\t}\n\t\t\t}));\n\t\t\tthis._register(dom.addDisposableListener(container.ownerDocument, 'keyup', e => {\n\t\t\t\tif (!e.ctrlKey) {\n\t\t\t\t\tdown = false;\n\t\t\t\t\tthis._options.modifierUpCallback!();\n\t\t\t\t}\n\t\t\t}));\n\t\t}\n\n\t\tcontainer.appendChild(this._domNode);\n\t\tthis._register(toDisposable(() => this._domNode?.remove()));\n\t}\n}\n"],
  "mappings": "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",
  "names": []
}
