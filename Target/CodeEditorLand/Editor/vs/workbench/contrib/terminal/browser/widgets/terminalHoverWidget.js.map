{
  "version": 3,
  "sources": ["../../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/terminal/browser/widgets/terminalHoverWidget.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport type { IViewportRange } from \"@xterm/xterm\";\nimport * as dom from \"../../../../../base/browser/dom.js\";\nimport type {\n\tIHoverAction,\n\tIHoverTarget,\n} from \"../../../../../base/browser/ui/hover/hover.js\";\nimport { Widget } from \"../../../../../base/browser/ui/widget.js\";\nimport type { IMarkdownString } from \"../../../../../base/common/htmlContent.js\";\nimport {\n\tDisposable,\n\ttoDisposable,\n} from \"../../../../../base/common/lifecycle.js\";\nimport { IConfigurationService } from \"../../../../../platform/configuration/common/configuration.js\";\nimport { IHoverService } from \"../../../../../platform/hover/browser/hover.js\";\nimport { TerminalSettingId } from \"../../../../../platform/terminal/common/terminal.js\";\nimport type { ITerminalWidget } from \"./widgets.js\";\n\nconst $ = dom.$;\n\nexport interface ILinkHoverTargetOptions {\n\treadonly viewportRange: IViewportRange;\n\treadonly cellDimensions: { width: number; height: number };\n\treadonly terminalDimensions: { width: number; height: number };\n\treadonly modifierDownCallback?: () => void;\n\treadonly modifierUpCallback?: () => void;\n}\n\nexport class TerminalHover extends Disposable implements ITerminalWidget {\n\treadonly id = \"hover\";\n\n\tconstructor(\n\t\tprivate readonly _targetOptions: ILinkHoverTargetOptions,\n\t\tprivate readonly _text: IMarkdownString,\n\t\tprivate readonly _actions: IHoverAction[] | undefined,\n\t\tprivate readonly _linkHandler: (url: string) => any,\n\t\t@IHoverService private readonly _hoverService: IHoverService,\n\t\t@IConfigurationService\n\t\tprivate readonly _configurationService: IConfigurationService,\n\t) {\n\t\tsuper();\n\t}\n\n\tattach(container: HTMLElement): void {\n\t\tconst showLinkHover = this._configurationService.getValue(\n\t\t\tTerminalSettingId.ShowLinkHover,\n\t\t);\n\t\tif (!showLinkHover) {\n\t\t\treturn;\n\t\t}\n\t\tconst target = new CellHoverTarget(container, this._targetOptions);\n\t\tconst hover = this._hoverService.showHover({\n\t\t\ttarget,\n\t\t\tcontent: this._text,\n\t\t\tactions: this._actions,\n\t\t\tlinkHandler: this._linkHandler,\n\t\t\t// .xterm-hover lets xterm know that the hover is part of a link\n\t\t\tadditionalClasses: [\"xterm-hover\"],\n\t\t});\n\t\tif (hover) {\n\t\t\tthis._register(hover);\n\t\t}\n\t}\n}\n\nclass CellHoverTarget extends Widget implements IHoverTarget {\n\tprivate _domNode: HTMLElement;\n\tprivate readonly _targetElements: HTMLElement[] = [];\n\n\tget targetElements(): readonly HTMLElement[] {\n\t\treturn this._targetElements;\n\t}\n\n\tconstructor(\n\t\tcontainer: HTMLElement,\n\t\tprivate readonly _options: ILinkHoverTargetOptions,\n\t) {\n\t\tsuper();\n\n\t\tthis._domNode = $(\"div.terminal-hover-targets.xterm-hover\");\n\t\tconst rowCount =\n\t\t\tthis._options.viewportRange.end.y -\n\t\t\tthis._options.viewportRange.start.y +\n\t\t\t1;\n\n\t\t// Add top target row\n\t\tconst width =\n\t\t\t(this._options.viewportRange.end.y >\n\t\t\tthis._options.viewportRange.start.y\n\t\t\t\t? this._options.terminalDimensions.width -\n\t\t\t\t\tthis._options.viewportRange.start.x\n\t\t\t\t: this._options.viewportRange.end.x -\n\t\t\t\t\tthis._options.viewportRange.start.x +\n\t\t\t\t\t1) * this._options.cellDimensions.width;\n\t\tconst topTarget = $(\"div.terminal-hover-target.hoverHighlight\");\n\t\ttopTarget.style.left = `${this._options.viewportRange.start.x * this._options.cellDimensions.width}px`;\n\t\ttopTarget.style.bottom = `${(this._options.terminalDimensions.height - this._options.viewportRange.start.y - 1) * this._options.cellDimensions.height}px`;\n\t\ttopTarget.style.width = `${width}px`;\n\t\ttopTarget.style.height = `${this._options.cellDimensions.height}px`;\n\t\tthis._targetElements.push(this._domNode.appendChild(topTarget));\n\n\t\t// Add middle target rows\n\t\tif (rowCount > 2) {\n\t\t\tconst middleTarget = $(\"div.terminal-hover-target.hoverHighlight\");\n\t\t\tmiddleTarget.style.left = `0px`;\n\t\t\tmiddleTarget.style.bottom = `${(this._options.terminalDimensions.height - this._options.viewportRange.start.y - 1 - (rowCount - 2)) * this._options.cellDimensions.height}px`;\n\t\t\tmiddleTarget.style.width = `${this._options.terminalDimensions.width * this._options.cellDimensions.width}px`;\n\t\t\tmiddleTarget.style.height = `${(rowCount - 2) * this._options.cellDimensions.height}px`;\n\t\t\tthis._targetElements.push(this._domNode.appendChild(middleTarget));\n\t\t}\n\n\t\t// Add bottom target row\n\t\tif (rowCount > 1) {\n\t\t\tconst bottomTarget = $(\"div.terminal-hover-target.hoverHighlight\");\n\t\t\tbottomTarget.style.left = `0px`;\n\t\t\tbottomTarget.style.bottom = `${(this._options.terminalDimensions.height - this._options.viewportRange.end.y - 1) * this._options.cellDimensions.height}px`;\n\t\t\tbottomTarget.style.width = `${(this._options.viewportRange.end.x + 1) * this._options.cellDimensions.width}px`;\n\t\t\tbottomTarget.style.height = `${this._options.cellDimensions.height}px`;\n\t\t\tthis._targetElements.push(this._domNode.appendChild(bottomTarget));\n\t\t}\n\n\t\tif (\n\t\t\tthis._options.modifierDownCallback &&\n\t\t\tthis._options.modifierUpCallback\n\t\t) {\n\t\t\tlet down = false;\n\t\t\tthis._register(\n\t\t\t\tdom.addDisposableListener(\n\t\t\t\t\tcontainer.ownerDocument,\n\t\t\t\t\t\"keydown\",\n\t\t\t\t\t(e) => {\n\t\t\t\t\t\tif (e.ctrlKey && !down) {\n\t\t\t\t\t\t\tdown = true;\n\t\t\t\t\t\t\tthis._options.modifierDownCallback!();\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t),\n\t\t\t);\n\t\t\tthis._register(\n\t\t\t\tdom.addDisposableListener(\n\t\t\t\t\tcontainer.ownerDocument,\n\t\t\t\t\t\"keyup\",\n\t\t\t\t\t(e) => {\n\t\t\t\t\t\tif (!e.ctrlKey) {\n\t\t\t\t\t\t\tdown = false;\n\t\t\t\t\t\t\tthis._options.modifierUpCallback!();\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t),\n\t\t\t);\n\t\t}\n\n\t\tcontainer.appendChild(this._domNode);\n\t\tthis._register(toDisposable(() => this._domNode?.remove()));\n\t}\n}\n"],
  "mappings": "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",
  "names": []
}
