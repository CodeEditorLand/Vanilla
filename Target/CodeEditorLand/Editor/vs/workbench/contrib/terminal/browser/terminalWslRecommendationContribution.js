var S=Object.defineProperty;var v=Object.getOwnPropertyDescriptor;var I=(s,i,o,t)=>{for(var e=t>1?void 0:t?v(i,o):i,a=s.length-1,n;a>=0;a--)(n=s[a])&&(e=(t?n(i,o,e):n(e))||e);return t&&e&&S(i,o,e),e},r=(s,i)=>(o,t)=>i(o,t,s);import{Disposable as b}from"../../../../../vs/base/common/lifecycle.js";import{basename as w}from"../../../../../vs/base/common/path.js";import{isWindows as g}from"../../../../../vs/base/common/platform.js";import{localize as d}from"../../../../../vs/nls.js";import{IExtensionManagementService as h}from"../../../../../vs/platform/extensionManagement/common/extensionManagement.js";import{IInstantiationService as y}from"../../../../../vs/platform/instantiation/common/instantiation.js";import{INotificationService as E,NeverShowAgainScope as C,Severity as k}from"../../../../../vs/platform/notification/common/notification.js";import{IProductService as A}from"../../../../../vs/platform/product/common/productService.js";import{InstallRecommendedExtensionAction as D}from"../../../../../vs/workbench/contrib/extensions/browser/extensionsActions.js";import{ITerminalService as L}from"../../../../../vs/workbench/contrib/terminal/browser/terminal.js";let c=class extends b{static ID="terminalWslRecommendation";constructor(i,o,t,e,a){if(super(),!g)return;const n=o.exeBasedExtensionTips;if(!n||!n.wsl)return;let p=a.onDidCreateInstance(async f=>{async function u(l){return(await e.getInstalled()).some(x=>x.identifier.id===l)}if(!f.shellLaunchConfig.executable||w(f.shellLaunchConfig.executable).toLowerCase()!=="wsl.exe")return;p?.dispose(),p=void 0;const m=Object.keys(n.wsl.recommendations).find(l=>n.wsl.recommendations[l].important);!m||await u(m)||t.prompt(k.Info,d("useWslExtension.title","The '{0}' extension is recommended for opening a terminal in WSL.",n.wsl.friendlyName),[{label:d("install","Install"),run:()=>{i.createInstance(D,m).run()}}],{sticky:!0,neverShowAgain:{id:"terminalConfigHelper/launchRecommendationsIgnore",scope:C.APPLICATION},onCancel:()=>{}})})}};c=I([r(0,y),r(1,A),r(2,E),r(3,h),r(4,L)],c);export{c as TerminalWslRecommendationContribution};
