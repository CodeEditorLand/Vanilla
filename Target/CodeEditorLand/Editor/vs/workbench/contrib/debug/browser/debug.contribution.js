var wge=Object.defineProperty;var Ege=Object.getOwnPropertyDescriptor;var E=(r,t,e,i)=>{for(var n=i>1?void 0:i?Ege(t,e):t,o=r.length-1,s;o>=0;o--)(s=r[o])&&(n=(i?s(t,e,n):s(n))||n);return i&&n&&wge(t,e,n),n},b=(r,t)=>(e,i)=>t(e,i,r);var f_=class{_keyCodeToStr;_strToKeyCode;constructor(){this._keyCodeToStr=[],this._strToKeyCode=Object.create(null)}define(t,e){this._keyCodeToStr[t]=e,this._strToKeyCode[e.toLowerCase()]=t}keyCodeToStr(t){return this._keyCodeToStr[t]}strToKeyCode(t){return this._strToKeyCode[t.toLowerCase()]||0}},DM=new f_,P5=new f_,M5=new f_,O5=new Array(230),xge={},$Z=[],jZ=Object.create(null),XZ=Object.create(null),YZ={lowerCaseToEnum:r=>XZ[r]||0,toEnum:r=>jZ[r]||0,toString:r=>$Z[r]||"None"},QZ=[],A5=[];for(let r=0;r<=193;r++)QZ[r]=-1;for(let r=0;r<=132;r++)A5[r]=-1;(function(){let r="",t=[[1,0,"None",0,"unknown",0,"VK_UNKNOWN",r,r],[1,1,"Hyper",0,r,0,r,r,r],[1,2,"Super",0,r,0,r,r,r],[1,3,"Fn",0,r,0,r,r,r],[1,4,"FnLock",0,r,0,r,r,r],[1,5,"Suspend",0,r,0,r,r,r],[1,6,"Resume",0,r,0,r,r,r],[1,7,"Turbo",0,r,0,r,r,r],[1,8,"Sleep",0,r,0,"VK_SLEEP",r,r],[1,9,"WakeUp",0,r,0,r,r,r],[0,10,"KeyA",31,"A",65,"VK_A",r,r],[0,11,"KeyB",32,"B",66,"VK_B",r,r],[0,12,"KeyC",33,"C",67,"VK_C",r,r],[0,13,"KeyD",34,"D",68,"VK_D",r,r],[0,14,"KeyE",35,"E",69,"VK_E",r,r],[0,15,"KeyF",36,"F",70,"VK_F",r,r],[0,16,"KeyG",37,"G",71,"VK_G",r,r],[0,17,"KeyH",38,"H",72,"VK_H",r,r],[0,18,"KeyI",39,"I",73,"VK_I",r,r],[0,19,"KeyJ",40,"J",74,"VK_J",r,r],[0,20,"KeyK",41,"K",75,"VK_K",r,r],[0,21,"KeyL",42,"L",76,"VK_L",r,r],[0,22,"KeyM",43,"M",77,"VK_M",r,r],[0,23,"KeyN",44,"N",78,"VK_N",r,r],[0,24,"KeyO",45,"O",79,"VK_O",r,r],[0,25,"KeyP",46,"P",80,"VK_P",r,r],[0,26,"KeyQ",47,"Q",81,"VK_Q",r,r],[0,27,"KeyR",48,"R",82,"VK_R",r,r],[0,28,"KeyS",49,"S",83,"VK_S",r,r],[0,29,"KeyT",50,"T",84,"VK_T",r,r],[0,30,"KeyU",51,"U",85,"VK_U",r,r],[0,31,"KeyV",52,"V",86,"VK_V",r,r],[0,32,"KeyW",53,"W",87,"VK_W",r,r],[0,33,"KeyX",54,"X",88,"VK_X",r,r],[0,34,"KeyY",55,"Y",89,"VK_Y",r,r],[0,35,"KeyZ",56,"Z",90,"VK_Z",r,r],[0,36,"Digit1",22,"1",49,"VK_1",r,r],[0,37,"Digit2",23,"2",50,"VK_2",r,r],[0,38,"Digit3",24,"3",51,"VK_3",r,r],[0,39,"Digit4",25,"4",52,"VK_4",r,r],[0,40,"Digit5",26,"5",53,"VK_5",r,r],[0,41,"Digit6",27,"6",54,"VK_6",r,r],[0,42,"Digit7",28,"7",55,"VK_7",r,r],[0,43,"Digit8",29,"8",56,"VK_8",r,r],[0,44,"Digit9",30,"9",57,"VK_9",r,r],[0,45,"Digit0",21,"0",48,"VK_0",r,r],[1,46,"Enter",3,"Enter",13,"VK_RETURN",r,r],[1,47,"Escape",9,"Escape",27,"VK_ESCAPE",r,r],[1,48,"Backspace",1,"Backspace",8,"VK_BACK",r,r],[1,49,"Tab",2,"Tab",9,"VK_TAB",r,r],[1,50,"Space",10,"Space",32,"VK_SPACE",r,r],[0,51,"Minus",88,"-",189,"VK_OEM_MINUS","-","OEM_MINUS"],[0,52,"Equal",86,"=",187,"VK_OEM_PLUS","=","OEM_PLUS"],[0,53,"BracketLeft",92,"[",219,"VK_OEM_4","[","OEM_4"],[0,54,"BracketRight",94,"]",221,"VK_OEM_6","]","OEM_6"],[0,55,"Backslash",93,"\\",220,"VK_OEM_5","\\","OEM_5"],[0,56,"IntlHash",0,r,0,r,r,r],[0,57,"Semicolon",85,";",186,"VK_OEM_1",";","OEM_1"],[0,58,"Quote",95,"'",222,"VK_OEM_7","'","OEM_7"],[0,59,"Backquote",91,"`",192,"VK_OEM_3","`","OEM_3"],[0,60,"Comma",87,",",188,"VK_OEM_COMMA",",","OEM_COMMA"],[0,61,"Period",89,".",190,"VK_OEM_PERIOD",".","OEM_PERIOD"],[0,62,"Slash",90,"/",191,"VK_OEM_2","/","OEM_2"],[1,63,"CapsLock",8,"CapsLock",20,"VK_CAPITAL",r,r],[1,64,"F1",59,"F1",112,"VK_F1",r,r],[1,65,"F2",60,"F2",113,"VK_F2",r,r],[1,66,"F3",61,"F3",114,"VK_F3",r,r],[1,67,"F4",62,"F4",115,"VK_F4",r,r],[1,68,"F5",63,"F5",116,"VK_F5",r,r],[1,69,"F6",64,"F6",117,"VK_F6",r,r],[1,70,"F7",65,"F7",118,"VK_F7",r,r],[1,71,"F8",66,"F8",119,"VK_F8",r,r],[1,72,"F9",67,"F9",120,"VK_F9",r,r],[1,73,"F10",68,"F10",121,"VK_F10",r,r],[1,74,"F11",69,"F11",122,"VK_F11",r,r],[1,75,"F12",70,"F12",123,"VK_F12",r,r],[1,76,"PrintScreen",0,r,0,r,r,r],[1,77,"ScrollLock",84,"ScrollLock",145,"VK_SCROLL",r,r],[1,78,"Pause",7,"PauseBreak",19,"VK_PAUSE",r,r],[1,79,"Insert",19,"Insert",45,"VK_INSERT",r,r],[1,80,"Home",14,"Home",36,"VK_HOME",r,r],[1,81,"PageUp",11,"PageUp",33,"VK_PRIOR",r,r],[1,82,"Delete",20,"Delete",46,"VK_DELETE",r,r],[1,83,"End",13,"End",35,"VK_END",r,r],[1,84,"PageDown",12,"PageDown",34,"VK_NEXT",r,r],[1,85,"ArrowRight",17,"RightArrow",39,"VK_RIGHT","Right",r],[1,86,"ArrowLeft",15,"LeftArrow",37,"VK_LEFT","Left",r],[1,87,"ArrowDown",18,"DownArrow",40,"VK_DOWN","Down",r],[1,88,"ArrowUp",16,"UpArrow",38,"VK_UP","Up",r],[1,89,"NumLock",83,"NumLock",144,"VK_NUMLOCK",r,r],[1,90,"NumpadDivide",113,"NumPad_Divide",111,"VK_DIVIDE",r,r],[1,91,"NumpadMultiply",108,"NumPad_Multiply",106,"VK_MULTIPLY",r,r],[1,92,"NumpadSubtract",111,"NumPad_Subtract",109,"VK_SUBTRACT",r,r],[1,93,"NumpadAdd",109,"NumPad_Add",107,"VK_ADD",r,r],[1,94,"NumpadEnter",3,r,0,r,r,r],[1,95,"Numpad1",99,"NumPad1",97,"VK_NUMPAD1",r,r],[1,96,"Numpad2",100,"NumPad2",98,"VK_NUMPAD2",r,r],[1,97,"Numpad3",101,"NumPad3",99,"VK_NUMPAD3",r,r],[1,98,"Numpad4",102,"NumPad4",100,"VK_NUMPAD4",r,r],[1,99,"Numpad5",103,"NumPad5",101,"VK_NUMPAD5",r,r],[1,100,"Numpad6",104,"NumPad6",102,"VK_NUMPAD6",r,r],[1,101,"Numpad7",105,"NumPad7",103,"VK_NUMPAD7",r,r],[1,102,"Numpad8",106,"NumPad8",104,"VK_NUMPAD8",r,r],[1,103,"Numpad9",107,"NumPad9",105,"VK_NUMPAD9",r,r],[1,104,"Numpad0",98,"NumPad0",96,"VK_NUMPAD0",r,r],[1,105,"NumpadDecimal",112,"NumPad_Decimal",110,"VK_DECIMAL",r,r],[0,106,"IntlBackslash",97,"OEM_102",226,"VK_OEM_102",r,r],[1,107,"ContextMenu",58,"ContextMenu",93,r,r,r],[1,108,"Power",0,r,0,r,r,r],[1,109,"NumpadEqual",0,r,0,r,r,r],[1,110,"F13",71,"F13",124,"VK_F13",r,r],[1,111,"F14",72,"F14",125,"VK_F14",r,r],[1,112,"F15",73,"F15",126,"VK_F15",r,r],[1,113,"F16",74,"F16",127,"VK_F16",r,r],[1,114,"F17",75,"F17",128,"VK_F17",r,r],[1,115,"F18",76,"F18",129,"VK_F18",r,r],[1,116,"F19",77,"F19",130,"VK_F19",r,r],[1,117,"F20",78,"F20",131,"VK_F20",r,r],[1,118,"F21",79,"F21",132,"VK_F21",r,r],[1,119,"F22",80,"F22",133,"VK_F22",r,r],[1,120,"F23",81,"F23",134,"VK_F23",r,r],[1,121,"F24",82,"F24",135,"VK_F24",r,r],[1,122,"Open",0,r,0,r,r,r],[1,123,"Help",0,r,0,r,r,r],[1,124,"Select",0,r,0,r,r,r],[1,125,"Again",0,r,0,r,r,r],[1,126,"Undo",0,r,0,r,r,r],[1,127,"Cut",0,r,0,r,r,r],[1,128,"Copy",0,r,0,r,r,r],[1,129,"Paste",0,r,0,r,r,r],[1,130,"Find",0,r,0,r,r,r],[1,131,"AudioVolumeMute",117,"AudioVolumeMute",173,"VK_VOLUME_MUTE",r,r],[1,132,"AudioVolumeUp",118,"AudioVolumeUp",175,"VK_VOLUME_UP",r,r],[1,133,"AudioVolumeDown",119,"AudioVolumeDown",174,"VK_VOLUME_DOWN",r,r],[1,134,"NumpadComma",110,"NumPad_Separator",108,"VK_SEPARATOR",r,r],[0,135,"IntlRo",115,"ABNT_C1",193,"VK_ABNT_C1",r,r],[1,136,"KanaMode",0,r,0,r,r,r],[0,137,"IntlYen",0,r,0,r,r,r],[1,138,"Convert",0,r,0,r,r,r],[1,139,"NonConvert",0,r,0,r,r,r],[1,140,"Lang1",0,r,0,r,r,r],[1,141,"Lang2",0,r,0,r,r,r],[1,142,"Lang3",0,r,0,r,r,r],[1,143,"Lang4",0,r,0,r,r,r],[1,144,"Lang5",0,r,0,r,r,r],[1,145,"Abort",0,r,0,r,r,r],[1,146,"Props",0,r,0,r,r,r],[1,147,"NumpadParenLeft",0,r,0,r,r,r],[1,148,"NumpadParenRight",0,r,0,r,r,r],[1,149,"NumpadBackspace",0,r,0,r,r,r],[1,150,"NumpadMemoryStore",0,r,0,r,r,r],[1,151,"NumpadMemoryRecall",0,r,0,r,r,r],[1,152,"NumpadMemoryClear",0,r,0,r,r,r],[1,153,"NumpadMemoryAdd",0,r,0,r,r,r],[1,154,"NumpadMemorySubtract",0,r,0,r,r,r],[1,155,"NumpadClear",131,"Clear",12,"VK_CLEAR",r,r],[1,156,"NumpadClearEntry",0,r,0,r,r,r],[1,0,r,5,"Ctrl",17,"VK_CONTROL",r,r],[1,0,r,4,"Shift",16,"VK_SHIFT",r,r],[1,0,r,6,"Alt",18,"VK_MENU",r,r],[1,0,r,57,"Meta",91,"VK_COMMAND",r,r],[1,157,"ControlLeft",5,r,0,"VK_LCONTROL",r,r],[1,158,"ShiftLeft",4,r,0,"VK_LSHIFT",r,r],[1,159,"AltLeft",6,r,0,"VK_LMENU",r,r],[1,160,"MetaLeft",57,r,0,"VK_LWIN",r,r],[1,161,"ControlRight",5,r,0,"VK_RCONTROL",r,r],[1,162,"ShiftRight",4,r,0,"VK_RSHIFT",r,r],[1,163,"AltRight",6,r,0,"VK_RMENU",r,r],[1,164,"MetaRight",57,r,0,"VK_RWIN",r,r],[1,165,"BrightnessUp",0,r,0,r,r,r],[1,166,"BrightnessDown",0,r,0,r,r,r],[1,167,"MediaPlay",0,r,0,r,r,r],[1,168,"MediaRecord",0,r,0,r,r,r],[1,169,"MediaFastForward",0,r,0,r,r,r],[1,170,"MediaRewind",0,r,0,r,r,r],[1,171,"MediaTrackNext",124,"MediaTrackNext",176,"VK_MEDIA_NEXT_TRACK",r,r],[1,172,"MediaTrackPrevious",125,"MediaTrackPrevious",177,"VK_MEDIA_PREV_TRACK",r,r],[1,173,"MediaStop",126,"MediaStop",178,"VK_MEDIA_STOP",r,r],[1,174,"Eject",0,r,0,r,r,r],[1,175,"MediaPlayPause",127,"MediaPlayPause",179,"VK_MEDIA_PLAY_PAUSE",r,r],[1,176,"MediaSelect",128,"LaunchMediaPlayer",181,"VK_MEDIA_LAUNCH_MEDIA_SELECT",r,r],[1,177,"LaunchMail",129,"LaunchMail",180,"VK_MEDIA_LAUNCH_MAIL",r,r],[1,178,"LaunchApp2",130,"LaunchApp2",183,"VK_MEDIA_LAUNCH_APP2",r,r],[1,179,"LaunchApp1",0,r,0,"VK_MEDIA_LAUNCH_APP1",r,r],[1,180,"SelectTask",0,r,0,r,r,r],[1,181,"LaunchScreenSaver",0,r,0,r,r,r],[1,182,"BrowserSearch",120,"BrowserSearch",170,"VK_BROWSER_SEARCH",r,r],[1,183,"BrowserHome",121,"BrowserHome",172,"VK_BROWSER_HOME",r,r],[1,184,"BrowserBack",122,"BrowserBack",166,"VK_BROWSER_BACK",r,r],[1,185,"BrowserForward",123,"BrowserForward",167,"VK_BROWSER_FORWARD",r,r],[1,186,"BrowserStop",0,r,0,"VK_BROWSER_STOP",r,r],[1,187,"BrowserRefresh",0,r,0,"VK_BROWSER_REFRESH",r,r],[1,188,"BrowserFavorites",0,r,0,"VK_BROWSER_FAVORITES",r,r],[1,189,"ZoomToggle",0,r,0,r,r,r],[1,190,"MailReply",0,r,0,r,r,r],[1,191,"MailForward",0,r,0,r,r,r],[1,192,"MailSend",0,r,0,r,r,r],[1,0,r,114,"KeyInComposition",229,r,r,r],[1,0,r,116,"ABNT_C2",194,"VK_ABNT_C2",r,r],[1,0,r,96,"OEM_8",223,"VK_OEM_8",r,r],[1,0,r,0,r,0,"VK_KANA",r,r],[1,0,r,0,r,0,"VK_HANGUL",r,r],[1,0,r,0,r,0,"VK_JUNJA",r,r],[1,0,r,0,r,0,"VK_FINAL",r,r],[1,0,r,0,r,0,"VK_HANJA",r,r],[1,0,r,0,r,0,"VK_KANJI",r,r],[1,0,r,0,r,0,"VK_CONVERT",r,r],[1,0,r,0,r,0,"VK_NONCONVERT",r,r],[1,0,r,0,r,0,"VK_ACCEPT",r,r],[1,0,r,0,r,0,"VK_MODECHANGE",r,r],[1,0,r,0,r,0,"VK_SELECT",r,r],[1,0,r,0,r,0,"VK_PRINT",r,r],[1,0,r,0,r,0,"VK_EXECUTE",r,r],[1,0,r,0,r,0,"VK_SNAPSHOT",r,r],[1,0,r,0,r,0,"VK_HELP",r,r],[1,0,r,0,r,0,"VK_APPS",r,r],[1,0,r,0,r,0,"VK_PROCESSKEY",r,r],[1,0,r,0,r,0,"VK_PACKET",r,r],[1,0,r,0,r,0,"VK_DBE_SBCSCHAR",r,r],[1,0,r,0,r,0,"VK_DBE_DBCSCHAR",r,r],[1,0,r,0,r,0,"VK_ATTN",r,r],[1,0,r,0,r,0,"VK_CRSEL",r,r],[1,0,r,0,r,0,"VK_EXSEL",r,r],[1,0,r,0,r,0,"VK_EREOF",r,r],[1,0,r,0,r,0,"VK_PLAY",r,r],[1,0,r,0,r,0,"VK_ZOOM",r,r],[1,0,r,0,r,0,"VK_NONAME",r,r],[1,0,r,0,r,0,"VK_PA1",r,r],[1,0,r,0,r,0,"VK_OEM_CLEAR",r,r]],e=[],i=[];for(let n of t){let[o,s,a,l,d,c,p,h,m]=n;if(i[s]||(i[s]=!0,$Z[s]=a,jZ[a]=s,XZ[a.toLowerCase()]=s,o&&(QZ[s]=l,l!==0&&l!==3&&l!==5&&l!==4&&l!==6&&l!==57&&(A5[l]=s))),!e[l]){if(e[l]=!0,!d)throw new Error(`String representation missing for key code ${l} around scan code ${a}`);DM.define(l,d),P5.define(l,h||d),M5.define(l,m||h||d)}c&&(O5[c]=l),p&&(xge[p]=l)}A5[3]=46})();var b_;(s=>{function r(a){return DM.keyCodeToStr(a)}s.toString=r;function t(a){return DM.strToKeyCode(a)}s.fromString=t;function e(a){return P5.keyCodeToStr(a)}s.toUserSettingsUS=e;function i(a){return M5.keyCodeToStr(a)}s.toUserSettingsGeneral=i;function n(a){return P5.strToKeyCode(a)||M5.strToKeyCode(a)}s.fromUserSettings=n;function o(a){if(a>=98&&a<=113)return null;switch(a){case 16:return"Up";case 18:return"Down";case 15:return"Left";case 17:return"Right"}return DM.keyCodeToStr(a)}s.toElectronAccelerator=o})(b_||={});function mo(r,t){let e=(t&65535)<<16>>>0;return(r|e)>>>0}var N5=class{unexpectedErrorHandler;listeners;constructor(){this.listeners=[],this.unexpectedErrorHandler=function(t){setTimeout(()=>{throw t.stack?Ga.isErrorNoTelemetry(t)?new Ga(t.message+`

`+t.stack):new Error(t.message+`

`+t.stack):t},0)}}addListener(t){return this.listeners.push(t),()=>{this._removeListener(t)}}emit(t){this.listeners.forEach(e=>{e(t)})}_removeListener(t){this.listeners.splice(this.listeners.indexOf(t),1)}setUnexpectedErrorHandler(t){this.unexpectedErrorHandler=t}getUnexpectedErrorHandler(){return this.unexpectedErrorHandler}onUnexpectedError(t){this.unexpectedErrorHandler(t),this.emit(t)}onUnexpectedExternalError(t){this.unexpectedErrorHandler(t)}},F5=new N5;function yS(r){F5.onUnexpectedError(r)}function Xe(r){vl(r)||F5.onUnexpectedError(r)}function zo(r){vl(r)||F5.onUnexpectedExternalError(r)}var kM="Canceled";function vl(r){return r instanceof wo?!0:r instanceof Error&&r.name===kM&&r.message===kM}var wo=class extends Error{constructor(){super(kM),this.name=this.message}};function ZZ(){let r=new Error(kM);return r.name=r.message,r}function Uc(r){return r?new Error(`Illegal argument: ${r}`):new Error("Illegal argument")}function JZ(r){return r?new Error(`Illegal state: ${r}`):new Error("Illegal state")}function v_(r){return r?r.message?r.message:r.stack?r.stack.split(`
`)[0]:String(r):"Error"}var LM=class extends Error{constructor(t){super("NotSupported"),t&&(this.message=t)}};var Ga=class r extends Error{name;constructor(t){super(t),this.name="CodeExpectedError"}static fromError(t){if(t instanceof r)return t;let e=new r;return e.message=t.message,e.stack=t.stack,e}static isErrorNoTelemetry(t){return t.name==="CodeExpectedError"}},_t=class r extends Error{constructor(t){super(t||"An unexpected bug occurred."),Object.setPrototypeOf(this,r.prototype)}};function B5(){return globalThis._VSCODE_NLS_MESSAGES}function I_(){return globalThis._VSCODE_NLS_LANGUAGE}var Tge=I_()==="pseudo"||typeof document<"u"&&document.location&&document.location.hash.indexOf("pseudo=true")>=0;function PM(r,t){let e;return t.length===0?e=r:e=r.replace(/\{(\d+)\}/g,(i,n)=>{let o=n[0],s=t[o],a=i;return typeof s=="string"?a=s:(typeof s=="number"||typeof s=="boolean"||s===void 0||s===null)&&(a=String(s)),a}),Tge&&(e="\uFF3B"+e.replace(/[aouei]/g,"$&$&")+"\uFF3D"),e}function u(r,t,...e){return PM(typeof r=="number"?eJ(r,t):t,e)}function eJ(r,t){let e=B5()?.[r];if(typeof e!="string"){if(typeof t=="string")return t;throw new Error(`!!! NLS MISSING: ${r} !!!`)}return e}function ie(r,t,...e){let i;typeof r=="number"?i=eJ(r,t):i=t;let n=PM(i,e);return{value:n,original:t===i?n:PM(t,e)}}var SS="en",C_=!1,w_=!1,S_=!1,_ge=!1,nJ=!1,H5=!1,Dge=!1,U5=!1,kge=!1,oJ=!1,y_,MM=SS,W5=SS,Lge,sm,am=globalThis,cd;typeof am.vscode<"u"&&typeof am.vscode.process<"u"?cd=am.vscode.process:typeof process<"u"&&typeof process?.versions?.node=="string"&&(cd=process);var rJ=typeof cd?.versions?.electron=="string",Rge=rJ&&cd?.type==="renderer";if(typeof cd=="object"){C_=cd.platform==="win32",w_=cd.platform==="darwin",S_=cd.platform==="linux",_ge=S_&&!!cd.env.SNAP&&!!cd.env.SNAP_REVISION,Dge=rJ,kge=!!cd.env.CI||!!cd.env.BUILD_ARTIFACTSTAGINGDIRECTORY,y_=SS,MM=SS;let r=cd.env.VSCODE_NLS_CONFIG;if(r)try{let t=JSON.parse(r);y_=t.userLocale,W5=t.osLocale,MM=t.resolvedLanguage||SS,Lge=t.languagePack?.translationsConfigFile}catch{}nJ=!0}else typeof navigator=="object"&&!Rge?(sm=navigator.userAgent,C_=sm.indexOf("Windows")>=0,w_=sm.indexOf("Macintosh")>=0,U5=(sm.indexOf("Macintosh")>=0||sm.indexOf("iPad")>=0||sm.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,S_=sm.indexOf("Linux")>=0,oJ=sm?.indexOf("Mobi")>=0,H5=!0,MM=I_()||SS,y_=navigator.language.toLowerCase(),W5=y_):console.error("Unable to resolve platform.");var V5=0;w_?V5=1:C_?V5=3:S_&&(V5=2);var St=C_,ye=w_,ci=S_;var Po=nJ;var si=H5,Pge=H5&&typeof am.importScripts=="function",sJ=Pge?am.origin:void 0,Hr=U5,AM=oJ;var mp=sm,qa=MM,Mge;(i=>{function r(){return qa}i.value=r;function t(){return qa.length===2?qa==="en":qa.length>=3?qa[0]==="e"&&qa[1]==="n"&&qa[2]==="-":!1}i.isDefaultVariant=t;function e(){return qa==="en"}i.isDefault=e})(Mge||={});var aJ=y_,lJ=W5;var Age=typeof am.postMessage=="function"&&!am.importScripts,OM=(()=>{if(Age){let r=[];am.addEventListener("message",e=>{if(e.data&&e.data.vscodeScheduleAsyncWork)for(let i=0,n=r.length;i<n;i++){let o=r[i];if(o.id===e.data.vscodeScheduleAsyncWork){r.splice(i,1),o.callback();return}}});let t=0;return e=>{let i=++t;r.push({id:i,callback:e}),am.postMessage({vscodeScheduleAsyncWork:i},"*")}}return r=>setTimeout(r)})();var Ys=w_||U5?2:C_?1:3,tJ=!0,iJ=!1;function dJ(){if(!iJ){iJ=!0;let r=new Uint8Array(2);r[0]=1,r[1]=2,tJ=new Uint16Array(r.buffer)[0]===513}return tJ}var z5=!!(mp&&mp.indexOf("Chrome")>=0),NM=!!(mp&&mp.indexOf("Firefox")>=0),cJ=!!(!z5&&mp&&mp.indexOf("Safari")>=0),uJ=!!(mp&&mp.indexOf("Edg/")>=0),pJ=!!(mp&&mp.indexOf("Android")>=0);function $a(r,t){let e=this,i=!1,n;return function(){if(i)return n;if(i=!0,t)try{n=r.apply(e,arguments)}finally{t()}else n=r.apply(e,arguments);return n}}function lm(r,t){let e=K5(r,t);if(e!==-1)return r[e]}function K5(r,t,e=r.length-1){for(let i=e;i>=0;i--){let n=r[i];if(t(n))return i}return-1}function dm(r,t){let e=cm(r,t);return e===-1?void 0:r[e]}function cm(r,t,e=0,i=r.length){let n=e,o=i;for(;n<o;){let s=Math.floor((n+o)/2);t(r[s])?n=s+1:o=s}return n-1}function hJ(r,t){let e=Av(r,t);return e===r.length?void 0:r[e]}function Av(r,t,e=0,i=r.length){let n=e,o=i;for(;n<o;){let s=Math.floor((n+o)/2);t(r[s])?o=s:n=s+1}return n}var E_=class r{constructor(t){this._array=t}static assertInvariants=!1;_findLastMonotonousLastIdx=0;_prevFindLastPredicate;findLastMonotonous(t){if(r.assertInvariants){if(this._prevFindLastPredicate){for(let i of this._array)if(this._prevFindLastPredicate(i)&&!t(i))throw new Error("MonotonousArray: current predicate must be weaker than (or equal to) the previous predicate.")}this._prevFindLastPredicate=t}let e=cm(this._array,t,this._findLastMonotonousLastIdx);return this._findLastMonotonousLastIdx=e+1,e===-1?void 0:this._array[e]}};function mJ(r,t){if(r.length===0)return;let e=r[0];for(let i=1;i<r.length;i++){let n=r[i];t(n,e)>0&&(e=n)}return e}function gJ(r,t){if(r.length===0)return;let e=r[0];for(let i=1;i<r.length;i++){let n=r[i];t(n,e)>=0&&(e=n)}return e}function fJ(r,t){return mJ(r,(e,i)=>-t(e,i))}function bJ(r,t){if(r.length===0)return-1;let e=0;for(let i=1;i<r.length;i++){let n=r[i];t(n,r[e])>0&&(e=i)}return e}function vJ(r,t){for(let e of r){let i=t(e);if(i!==void 0)return i}}function ls(r,t=0){return r[r.length-(1+t)]}function WM(r){if(r.length===0)throw new Error("Invalid tail call");return[r.slice(0,r.length-1),r[r.length-1]]}function xi(r,t,e=(i,n)=>i===n){if(r===t)return!0;if(!r||!t||r.length!==t.length)return!1;for(let i=0,n=r.length;i<n;i++)if(!e(r[i],t[i]))return!1;return!0}function IJ(r,t){let e=r.length-1;t<e&&(r[t]=r[e]),r.pop()}function HM(r,t,e){return x_(r.length,i=>e(r[i],t))}function x_(r,t){let e=0,i=r-1;for(;e<=i;){let n=(e+i)/2|0,o=t(n);if(o<0)e=n+1;else if(o>0)i=n-1;else return n}return-(e+1)}function FM(r,t,e){if(r=r|0,r>=t.length)throw new TypeError("invalid index");let i=t[Math.floor(t.length*Math.random())],n=[],o=[],s=[];for(let a of t){let l=e(a,i);l<0?n.push(a):l>0?o.push(a):s.push(a)}return r<n.length?FM(r,n,e):r<n.length+s.length?s[0]:FM(r-(n.length+s.length),o,e)}function UM(r,t){let e=[],i;for(let n of r.slice(0).sort(t))!i||t(i[0],n)!==0?(i=[n],e.push(i)):i.push(n);return e}function*CS(r,t){let e,i;for(let n of r)i!==void 0&&t(i,n)?e.push(n):(e&&(yield e),e=[n]),i=n;e&&(yield e)}function zM(r,t){for(let e=0;e<=r.length;e++)t(e===0?void 0:r[e-1],e===r.length?void 0:r[e])}function yJ(r,t){for(let e=0;e<r.length;e++)t(e===0?void 0:r[e-1],r[e],e+1===r.length?void 0:r[e+1])}function cn(r){return r.filter(t=>!!t)}function G5(r){let t=0;for(let e=0;e<r.length;e++)r[e]&&(r[t]=r[e],t+=1);r.length=t}function SJ(r){return!Array.isArray(r)||r.length===0}function pm(r){return Array.isArray(r)&&r.length>0}function Mo(r,t=e=>e){let e=new Set;return r.filter(i=>{let n=t(i);return e.has(n)?!1:(e.add(n),!0)})}function CJ(r,t,e=(i,n)=>i===n){let i=0;for(let n=0,o=Math.min(r.length,t.length);n<o&&e(r[n],t[n]);n++)i++;return i}function yr(r,t){let e=typeof t=="number"?r:0;typeof t=="number"?e=r:(e=0,t=r);let i=[];if(e<=t)for(let n=e;n<t;n++)i.push(n);else for(let n=e;n>t;n--)i.push(n);return i}function wJ(r,t,e){return r.reduce((i,n)=>(i[t(n)]=e?e(n):n,i),Object.create(null))}function wS(r,t){return r.push(t),()=>Oge(r,t)}function Oge(r,t){let e=r.indexOf(t);if(e>-1)return r.splice(e,1),t}function gp(r,t,e){let i=r.slice(0,t),n=r.slice(t);return i.concat(e,n)}function q5(r,t){let e;if(typeof t=="number"){let i=t;e=()=>{let n=Math.sin(i++)*179426549;return n-Math.floor(n)}}else e=Math.random;for(let i=r.length-1;i>0;i-=1){let n=Math.floor(e()*(i+1)),o=r[i];r[i]=r[n],r[n]=o}}function KM(r,t){let e=r.indexOf(t);e>-1&&(r.splice(e,1),r.unshift(t))}function T_(r,t){let e=r.indexOf(t);e>-1&&(r.splice(e,1),r.push(t))}function __(r,t){for(let e of t)r.push(e)}function Ov(r){return Array.isArray(r)?r:[r]}function $5(r,t,e){let i=EJ(r,t),n=r.length,o=e.length;r.length=n+o;for(let s=n-1;s>=i;s--)r[s+o]=r[s];for(let s=0;s<o;s++)r[s+i]=e[s]}function j5(r,t,e,i){let n=EJ(r,t),o=r.splice(n,e);return o===void 0&&(o=[]),$5(r,n,i),o}function EJ(r,t){return t<0?Math.max(t+r.length,0):Math.min(t,r.length)}var BM;(a=>{function r(l){return l<0}a.isLessThan=r;function t(l){return l<=0}a.isLessThanOrEqual=t;function e(l){return l>0}a.isGreaterThan=e;function i(l){return l===0}a.isNeitherLessOrGreaterThan=i,a.greaterThan=1,a.lessThan=-1,a.neitherLessOrGreaterThan=0})(BM||={});function Sr(r,t){return(e,i)=>t(r(e),r(i))}function xJ(...r){return(t,e)=>{for(let i of r){let n=i(t,e);if(!BM.isNeitherLessOrGreaterThan(n))return n}return BM.neitherLessOrGreaterThan}}var ud=(r,t)=>r-t,TJ=(r,t)=>ud(r?1:0,t?1:0);function _J(r){return(t,e)=>-r(t,e)}var Ms=class{constructor(t){this.items=t}firstIdx=0;lastIdx=this.items.length-1;get length(){return this.lastIdx-this.firstIdx+1}takeWhile(t){let e=this.firstIdx;for(;e<this.items.length&&t(this.items[e]);)e++;let i=e===this.firstIdx?null:this.items.slice(this.firstIdx,e);return this.firstIdx=e,i}takeFromEndWhile(t){let e=this.lastIdx;for(;e>=0&&t(this.items[e]);)e--;let i=e===this.lastIdx?null:this.items.slice(e+1,this.lastIdx+1);return this.lastIdx=e,i}peek(){if(this.length!==0)return this.items[this.firstIdx]}peekLast(){if(this.length!==0)return this.items[this.lastIdx]}dequeue(){let t=this.items[this.firstIdx];return this.firstIdx++,t}removeLast(){let t=this.items[this.lastIdx];return this.lastIdx--,t}takeCount(t){let e=this.items.slice(this.firstIdx,this.firstIdx+t);return this.firstIdx+=t,e}},um=class r{constructor(t){this.iterate=t}static empty=new r(t=>{});forEach(t){this.iterate(e=>(t(e),!0))}toArray(){let t=[];return this.iterate(e=>(t.push(e),!0)),t}filter(t){return new r(e=>this.iterate(i=>t(i)?e(i):!0))}map(t){return new r(e=>this.iterate(i=>e(t(i))))}some(t){let e=!1;return this.iterate(i=>(e=t(i),!e)),e}findFirst(t){let e;return this.iterate(i=>t(i)?(e=i,!1):!0),e}findLast(t){let e;return this.iterate(i=>(t(i)&&(e=i),!0)),e}findLastMaxBy(t){let e,i=!0;return this.iterate(n=>((i||BM.isGreaterThan(t(n,e)))&&(i=!1,e=n),!0)),e}},VM=class r{constructor(t){this._indexMap=t}static createSortPermutation(t,e){let i=Array.from(t.keys()).sort((n,o)=>e(t[n],t[o]));return new r(i)}apply(t){return t.map((e,i)=>t[this._indexMap[i]])}inverse(){let t=this._indexMap.slice();for(let e=0;e<this._indexMap.length;e++)t[this._indexMap[e]]=e;return new r(t)}};function DJ(r,t){let e=new Set;for(let i of t)r.has(i)&&e.add(i);return e}var Nv,X5=globalThis.vscode;if(typeof X5<"u"&&typeof X5.process<"u"){let r=X5.process;Nv={get platform(){return r.platform},get arch(){return r.arch},get env(){return r.env},cwd(){return r.cwd()}}}else typeof process<"u"&&typeof process?.versions?.node=="string"?Nv={get platform(){return process.platform},get arch(){return process.arch},get env(){return process.env},cwd(){return process.env.VSCODE_CWD||process.cwd()}}:Nv={get platform(){return St?"win32":ye?"darwin":"linux"},get arch(){},get env(){return{}},cwd(){return"/"}};var D_=Nv.cwd,oc=Nv.env,Y5=Nv.platform,Nge=Nv.arch;var Bge=65,Vge=97,Wge=90,Hge=122,Ug=46,As=47,yl=92,Wg=58,Uge=63,GM=class extends Error{code;constructor(t,e,i){let n;typeof e=="string"&&e.indexOf("not ")===0?(n="must not be",e=e.replace(/^not /,"")):n="must be";let o=t.indexOf(".")!==-1?"property":"argument",s=`The "${t}" ${o} ${n} of type ${e}`;s+=`. Received type ${typeof i}`,super(s),this.code="ERR_INVALID_ARG_TYPE"}};function zge(r,t){if(r===null||typeof r!="object")throw new GM(t,"Object",r)}function ar(r,t){if(typeof r!="string")throw new GM(t,"string",r)}var Sl=Y5==="win32";function Ri(r){return r===As||r===yl}function Q5(r){return r===As}function Hg(r){return r>=Bge&&r<=Wge||r>=Vge&&r<=Hge}function qM(r,t,e,i){let n="",o=0,s=-1,a=0,l=0;for(let d=0;d<=r.length;++d){if(d<r.length)l=r.charCodeAt(d);else{if(i(l))break;l=As}if(i(l)){if(!(s===d-1||a===1))if(a===2){if(n.length<2||o!==2||n.charCodeAt(n.length-1)!==Ug||n.charCodeAt(n.length-2)!==Ug){if(n.length>2){let c=n.lastIndexOf(e);c===-1?(n="",o=0):(n=n.slice(0,c),o=n.length-1-n.lastIndexOf(e)),s=d,a=0;continue}else if(n.length!==0){n="",o=0,s=d,a=0;continue}}t&&(n+=n.length>0?`${e}..`:"..",o=2)}else n.length>0?n+=`${e}${r.slice(s+1,d)}`:n=r.slice(s+1,d),o=d-s-1;s=d,a=0}else l===Ug&&a!==-1?++a:a=-1}return n}function Kge(r){return r?`${r[0]==="."?"":"."}${r}`:""}function kJ(r,t){zge(t,"pathObject");let e=t.dir||t.root,i=t.base||`${t.name||""}${Kge(t.ext)}`;return e?e===t.root?`${e}${i}`:`${e}${r}${i}`:i}var Zn={resolve(...r){let t="",e="",i=!1;for(let n=r.length-1;n>=-1;n--){let o;if(n>=0){if(o=r[n],ar(o,`paths[${n}]`),o.length===0)continue}else t.length===0?o=D_():(o=oc[`=${t}`]||D_(),(o===void 0||o.slice(0,2).toLowerCase()!==t.toLowerCase()&&o.charCodeAt(2)===yl)&&(o=`${t}\\`));let s=o.length,a=0,l="",d=!1,c=o.charCodeAt(0);if(s===1)Ri(c)&&(a=1,d=!0);else if(Ri(c))if(d=!0,Ri(o.charCodeAt(1))){let p=2,h=p;for(;p<s&&!Ri(o.charCodeAt(p));)p++;if(p<s&&p!==h){let m=o.slice(h,p);for(h=p;p<s&&Ri(o.charCodeAt(p));)p++;if(p<s&&p!==h){for(h=p;p<s&&!Ri(o.charCodeAt(p));)p++;(p===s||p!==h)&&(l=`\\\\${m}\\${o.slice(h,p)}`,a=p)}}}else a=1;else Hg(c)&&o.charCodeAt(1)===Wg&&(l=o.slice(0,2),a=2,s>2&&Ri(o.charCodeAt(2))&&(d=!0,a=3));if(l.length>0)if(t.length>0){if(l.toLowerCase()!==t.toLowerCase())continue}else t=l;if(i){if(t.length>0)break}else if(e=`${o.slice(a)}\\${e}`,i=d,d&&t.length>0)break}return e=qM(e,!i,"\\",Ri),i?`${t}\\${e}`:`${t}${e}`||"."},normalize(r){ar(r,"path");let t=r.length;if(t===0)return".";let e=0,i,n=!1,o=r.charCodeAt(0);if(t===1)return Q5(o)?"\\":r;if(Ri(o))if(n=!0,Ri(r.charCodeAt(1))){let a=2,l=a;for(;a<t&&!Ri(r.charCodeAt(a));)a++;if(a<t&&a!==l){let d=r.slice(l,a);for(l=a;a<t&&Ri(r.charCodeAt(a));)a++;if(a<t&&a!==l){for(l=a;a<t&&!Ri(r.charCodeAt(a));)a++;if(a===t)return`\\\\${d}\\${r.slice(l)}\\`;a!==l&&(i=`\\\\${d}\\${r.slice(l,a)}`,e=a)}}}else e=1;else Hg(o)&&r.charCodeAt(1)===Wg&&(i=r.slice(0,2),e=2,t>2&&Ri(r.charCodeAt(2))&&(n=!0,e=3));let s=e<t?qM(r.slice(e),!n,"\\",Ri):"";return s.length===0&&!n&&(s="."),s.length>0&&Ri(r.charCodeAt(t-1))&&(s+="\\"),i===void 0?n?`\\${s}`:s:n?`${i}\\${s}`:`${i}${s}`},isAbsolute(r){ar(r,"path");let t=r.length;if(t===0)return!1;let e=r.charCodeAt(0);return Ri(e)||t>2&&Hg(e)&&r.charCodeAt(1)===Wg&&Ri(r.charCodeAt(2))},join(...r){if(r.length===0)return".";let t,e;for(let o=0;o<r.length;++o){let s=r[o];ar(s,"path"),s.length>0&&(t===void 0?t=e=s:t+=`\\${s}`)}if(t===void 0)return".";let i=!0,n=0;if(typeof e=="string"&&Ri(e.charCodeAt(0))){++n;let o=e.length;o>1&&Ri(e.charCodeAt(1))&&(++n,o>2&&(Ri(e.charCodeAt(2))?++n:i=!1))}if(i){for(;n<t.length&&Ri(t.charCodeAt(n));)n++;n>=2&&(t=`\\${t.slice(n)}`)}return Zn.normalize(t)},relative(r,t){if(ar(r,"from"),ar(t,"to"),r===t)return"";let e=Zn.resolve(r),i=Zn.resolve(t);if(e===i||(r=e.toLowerCase(),t=i.toLowerCase(),r===t))return"";let n=0;for(;n<r.length&&r.charCodeAt(n)===yl;)n++;let o=r.length;for(;o-1>n&&r.charCodeAt(o-1)===yl;)o--;let s=o-n,a=0;for(;a<t.length&&t.charCodeAt(a)===yl;)a++;let l=t.length;for(;l-1>a&&t.charCodeAt(l-1)===yl;)l--;let d=l-a,c=s<d?s:d,p=-1,h=0;for(;h<c;h++){let f=r.charCodeAt(n+h);if(f!==t.charCodeAt(a+h))break;f===yl&&(p=h)}if(h!==c){if(p===-1)return i}else{if(d>c){if(t.charCodeAt(a+h)===yl)return i.slice(a+h+1);if(h===2)return i.slice(a+h)}s>c&&(r.charCodeAt(n+h)===yl?p=h:h===2&&(p=3)),p===-1&&(p=0)}let m="";for(h=n+p+1;h<=o;++h)(h===o||r.charCodeAt(h)===yl)&&(m+=m.length===0?"..":"\\..");return a+=p,m.length>0?`${m}${i.slice(a,l)}`:(i.charCodeAt(a)===yl&&++a,i.slice(a,l))},toNamespacedPath(r){if(typeof r!="string"||r.length===0)return r;let t=Zn.resolve(r);if(t.length<=2)return r;if(t.charCodeAt(0)===yl){if(t.charCodeAt(1)===yl){let e=t.charCodeAt(2);if(e!==Uge&&e!==Ug)return`\\\\?\\UNC\\${t.slice(2)}`}}else if(Hg(t.charCodeAt(0))&&t.charCodeAt(1)===Wg&&t.charCodeAt(2)===yl)return`\\\\?\\${t}`;return r},dirname(r){ar(r,"path");let t=r.length;if(t===0)return".";let e=-1,i=0,n=r.charCodeAt(0);if(t===1)return Ri(n)?r:".";if(Ri(n)){if(e=i=1,Ri(r.charCodeAt(1))){let a=2,l=a;for(;a<t&&!Ri(r.charCodeAt(a));)a++;if(a<t&&a!==l){for(l=a;a<t&&Ri(r.charCodeAt(a));)a++;if(a<t&&a!==l){for(l=a;a<t&&!Ri(r.charCodeAt(a));)a++;if(a===t)return r;a!==l&&(e=i=a+1)}}}}else Hg(n)&&r.charCodeAt(1)===Wg&&(e=t>2&&Ri(r.charCodeAt(2))?3:2,i=e);let o=-1,s=!0;for(let a=t-1;a>=i;--a)if(Ri(r.charCodeAt(a))){if(!s){o=a;break}}else s=!1;if(o===-1){if(e===-1)return".";o=e}return r.slice(0,o)},basename(r,t){t!==void 0&&ar(t,"suffix"),ar(r,"path");let e=0,i=-1,n=!0,o;if(r.length>=2&&Hg(r.charCodeAt(0))&&r.charCodeAt(1)===Wg&&(e=2),t!==void 0&&t.length>0&&t.length<=r.length){if(t===r)return"";let s=t.length-1,a=-1;for(o=r.length-1;o>=e;--o){let l=r.charCodeAt(o);if(Ri(l)){if(!n){e=o+1;break}}else a===-1&&(n=!1,a=o+1),s>=0&&(l===t.charCodeAt(s)?--s===-1&&(i=o):(s=-1,i=a))}return e===i?i=a:i===-1&&(i=r.length),r.slice(e,i)}for(o=r.length-1;o>=e;--o)if(Ri(r.charCodeAt(o))){if(!n){e=o+1;break}}else i===-1&&(n=!1,i=o+1);return i===-1?"":r.slice(e,i)},extname(r){ar(r,"path");let t=0,e=-1,i=0,n=-1,o=!0,s=0;r.length>=2&&r.charCodeAt(1)===Wg&&Hg(r.charCodeAt(0))&&(t=i=2);for(let a=r.length-1;a>=t;--a){let l=r.charCodeAt(a);if(Ri(l)){if(!o){i=a+1;break}continue}n===-1&&(o=!1,n=a+1),l===Ug?e===-1?e=a:s!==1&&(s=1):e!==-1&&(s=-1)}return e===-1||n===-1||s===0||s===1&&e===n-1&&e===i+1?"":r.slice(e,n)},format:kJ.bind(null,"\\"),parse(r){ar(r,"path");let t={root:"",dir:"",base:"",ext:"",name:""};if(r.length===0)return t;let e=r.length,i=0,n=r.charCodeAt(0);if(e===1)return Ri(n)?(t.root=t.dir=r,t):(t.base=t.name=r,t);if(Ri(n)){if(i=1,Ri(r.charCodeAt(1))){let p=2,h=p;for(;p<e&&!Ri(r.charCodeAt(p));)p++;if(p<e&&p!==h){for(h=p;p<e&&Ri(r.charCodeAt(p));)p++;if(p<e&&p!==h){for(h=p;p<e&&!Ri(r.charCodeAt(p));)p++;p===e?i=p:p!==h&&(i=p+1)}}}}else if(Hg(n)&&r.charCodeAt(1)===Wg){if(e<=2)return t.root=t.dir=r,t;if(i=2,Ri(r.charCodeAt(2))){if(e===3)return t.root=t.dir=r,t;i=3}}i>0&&(t.root=r.slice(0,i));let o=-1,s=i,a=-1,l=!0,d=r.length-1,c=0;for(;d>=i;--d){if(n=r.charCodeAt(d),Ri(n)){if(!l){s=d+1;break}continue}a===-1&&(l=!1,a=d+1),n===Ug?o===-1?o=d:c!==1&&(c=1):o!==-1&&(c=-1)}return a!==-1&&(o===-1||c===0||c===1&&o===a-1&&o===s+1?t.base=t.name=r.slice(s,a):(t.name=r.slice(s,o),t.base=r.slice(s,a),t.ext=r.slice(o,a))),s>0&&s!==i?t.dir=r.slice(0,s-1):t.dir=t.root,t},sep:"\\",delimiter:";",win32:null,posix:null},Gge=(()=>{if(Sl){let r=/\\/g;return()=>{let t=D_().replace(r,"/");return t.slice(t.indexOf("/"))}}return()=>D_()})(),Xt={resolve(...r){let t="",e=!1;for(let i=r.length-1;i>=-1&&!e;i--){let n=i>=0?r[i]:Gge();ar(n,`paths[${i}]`),n.length!==0&&(t=`${n}/${t}`,e=n.charCodeAt(0)===As)}return t=qM(t,!e,"/",Q5),e?`/${t}`:t.length>0?t:"."},normalize(r){if(ar(r,"path"),r.length===0)return".";let t=r.charCodeAt(0)===As,e=r.charCodeAt(r.length-1)===As;return r=qM(r,!t,"/",Q5),r.length===0?t?"/":e?"./":".":(e&&(r+="/"),t?`/${r}`:r)},isAbsolute(r){return ar(r,"path"),r.length>0&&r.charCodeAt(0)===As},join(...r){if(r.length===0)return".";let t;for(let e=0;e<r.length;++e){let i=r[e];ar(i,"path"),i.length>0&&(t===void 0?t=i:t+=`/${i}`)}return t===void 0?".":Xt.normalize(t)},relative(r,t){if(ar(r,"from"),ar(t,"to"),r===t||(r=Xt.resolve(r),t=Xt.resolve(t),r===t))return"";let e=1,i=r.length,n=i-e,o=1,s=t.length-o,a=n<s?n:s,l=-1,d=0;for(;d<a;d++){let p=r.charCodeAt(e+d);if(p!==t.charCodeAt(o+d))break;p===As&&(l=d)}if(d===a)if(s>a){if(t.charCodeAt(o+d)===As)return t.slice(o+d+1);if(d===0)return t.slice(o+d)}else n>a&&(r.charCodeAt(e+d)===As?l=d:d===0&&(l=0));let c="";for(d=e+l+1;d<=i;++d)(d===i||r.charCodeAt(d)===As)&&(c+=c.length===0?"..":"/..");return`${c}${t.slice(o+l)}`},toNamespacedPath(r){return r},dirname(r){if(ar(r,"path"),r.length===0)return".";let t=r.charCodeAt(0)===As,e=-1,i=!0;for(let n=r.length-1;n>=1;--n)if(r.charCodeAt(n)===As){if(!i){e=n;break}}else i=!1;return e===-1?t?"/":".":t&&e===1?"//":r.slice(0,e)},basename(r,t){t!==void 0&&ar(t,"ext"),ar(r,"path");let e=0,i=-1,n=!0,o;if(t!==void 0&&t.length>0&&t.length<=r.length){if(t===r)return"";let s=t.length-1,a=-1;for(o=r.length-1;o>=0;--o){let l=r.charCodeAt(o);if(l===As){if(!n){e=o+1;break}}else a===-1&&(n=!1,a=o+1),s>=0&&(l===t.charCodeAt(s)?--s===-1&&(i=o):(s=-1,i=a))}return e===i?i=a:i===-1&&(i=r.length),r.slice(e,i)}for(o=r.length-1;o>=0;--o)if(r.charCodeAt(o)===As){if(!n){e=o+1;break}}else i===-1&&(n=!1,i=o+1);return i===-1?"":r.slice(e,i)},extname(r){ar(r,"path");let t=-1,e=0,i=-1,n=!0,o=0;for(let s=r.length-1;s>=0;--s){let a=r.charCodeAt(s);if(a===As){if(!n){e=s+1;break}continue}i===-1&&(n=!1,i=s+1),a===Ug?t===-1?t=s:o!==1&&(o=1):t!==-1&&(o=-1)}return t===-1||i===-1||o===0||o===1&&t===i-1&&t===e+1?"":r.slice(t,i)},format:kJ.bind(null,"/"),parse(r){ar(r,"path");let t={root:"",dir:"",base:"",ext:"",name:""};if(r.length===0)return t;let e=r.charCodeAt(0)===As,i;e?(t.root="/",i=1):i=0;let n=-1,o=0,s=-1,a=!0,l=r.length-1,d=0;for(;l>=i;--l){let c=r.charCodeAt(l);if(c===As){if(!a){o=l+1;break}continue}s===-1&&(a=!1,s=l+1),c===Ug?n===-1?n=l:d!==1&&(d=1):n!==-1&&(d=-1)}if(s!==-1){let c=o===0&&e?1:o;n===-1||d===0||d===1&&n===s-1&&n===o+1?t.base=t.name=r.slice(c,s):(t.name=r.slice(c,n),t.base=r.slice(c,s),t.ext=r.slice(n,s))}return o>0?t.dir=r.slice(0,o-1):e&&(t.dir="/"),t},sep:"/",delimiter:":",win32:null,posix:null};Xt.win32=Zn.win32=Zn;Xt.posix=Zn.posix=Xt;var ds=Sl?Zn.normalize:Xt.normalize,ja=Sl?Zn.isAbsolute:Xt.isAbsolute,cs=Sl?Zn.join:Xt.join,ES=Sl?Zn.resolve:Xt.resolve,k_=Sl?Zn.relative:Xt.relative,zg=Sl?Zn.dirname:Xt.dirname,Eo=Sl?Zn.basename:Xt.basename,hm=Sl?Zn.extname:Xt.extname,CLe=Sl?Zn.format:Xt.format,LJ=Sl?Zn.parse:Xt.parse,wLe=Sl?Zn.toNamespacedPath:Xt.toNamespacedPath,Ur=Sl?Zn.sep:Xt.sep,ELe=Sl?Zn.delimiter:Xt.delimiter;var qge=/^\w[\w\d+.-]*$/,$ge=/^\//,jge=/^\/\//;function Xge(r,t){if(!r.scheme&&t)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${r.authority}", path: "${r.path}", query: "${r.query}", fragment: "${r.fragment}"}`);if(r.scheme&&!qge.test(r.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(r.path){if(r.authority){if(!$ge.test(r.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(jge.test(r.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}function Yge(r,t){return!r&&!t?"file":r}function Qge(r,t){switch(r){case"https":case"http":case"file":t?t[0]!==zc&&(t=zc+t):t=zc;break}return t}var co="",zc="/",Zge=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/,Z=class r{static isUri(t){return t instanceof r?!0:t?typeof t.authority=="string"&&typeof t.fragment=="string"&&typeof t.path=="string"&&typeof t.query=="string"&&typeof t.scheme=="string"&&typeof t.fsPath=="string"&&typeof t.with=="function"&&typeof t.toString=="function":!1}scheme;authority;path;query;fragment;constructor(t,e,i,n,o,s=!1){typeof t=="object"?(this.scheme=t.scheme||co,this.authority=t.authority||co,this.path=t.path||co,this.query=t.query||co,this.fragment=t.fragment||co):(this.scheme=Yge(t,s),this.authority=e||co,this.path=Qge(this.scheme,i||co),this.query=n||co,this.fragment=o||co,Xge(this,s))}get fsPath(){return L_(this,!1)}with(t){if(!t)return this;let{scheme:e,authority:i,path:n,query:o,fragment:s}=t;return e===void 0?e=this.scheme:e===null&&(e=co),i===void 0?i=this.authority:i===null&&(i=co),n===void 0?n=this.path:n===null&&(n=co),o===void 0?o=this.query:o===null&&(o=co),s===void 0?s=this.fragment:s===null&&(s=co),e===this.scheme&&i===this.authority&&n===this.path&&o===this.query&&s===this.fragment?this:new Kg(e,i,n,o,s)}static parse(t,e=!1){let i=Zge.exec(t);return i?new Kg(i[2]||co,$M(i[4]||co),$M(i[5]||co),$M(i[7]||co),$M(i[9]||co),e):new Kg(co,co,co,co,co)}static file(t){let e=co;if(St&&(t=t.replace(/\\/g,zc)),t[0]===zc&&t[1]===zc){let i=t.indexOf(zc,2);i===-1?(e=t.substring(2),t=zc):(e=t.substring(2,i),t=t.substring(i)||zc)}return new Kg("file",e,t,co,co)}static from(t,e){return new Kg(t.scheme,t.authority,t.path,t.query,t.fragment,e)}static joinPath(t,...e){if(!t.path)throw new Error("[UriError]: cannot call joinPath on URI without path");let i;return St&&t.scheme==="file"?i=r.file(Zn.join(L_(t,!0),...e)).path:i=Xt.join(t.path,...e),t.with({path:i})}toString(t=!1){return Z5(this,t)}toJSON(){return this}static revive(t){if(t){if(t instanceof r)return t;{let e=new Kg(t);return e._formatted=t.external??null,e._fsPath=t._sep===OJ?t.fsPath??null:null,e}}else return t}[Symbol.for("debug.description")](){return`URI(${this.toString()})`}};function AJ(r){return!r||typeof r!="object"?!1:typeof r.scheme=="string"&&(typeof r.authority=="string"||typeof r.authority>"u")&&(typeof r.path=="string"||typeof r.path>"u")&&(typeof r.query=="string"||typeof r.query>"u")&&(typeof r.fragment=="string"||typeof r.fragment>"u")}var OJ=St?1:void 0,Kg=class extends Z{_formatted=null;_fsPath=null;get fsPath(){return this._fsPath||(this._fsPath=L_(this,!1)),this._fsPath}toString(t=!1){return t?Z5(this,!0):(this._formatted||(this._formatted=Z5(this,!1)),this._formatted)}toJSON(){let t={$mid:1};return this._fsPath&&(t.fsPath=this._fsPath,t._sep=OJ),this._formatted&&(t.external=this._formatted),this.path&&(t.path=this.path),this.scheme&&(t.scheme=this.scheme),this.authority&&(t.authority=this.authority),this.query&&(t.query=this.query),this.fragment&&(t.fragment=this.fragment),t}},NJ={58:"%3A",47:"%2F",63:"%3F",35:"%23",91:"%5B",93:"%5D",64:"%40",33:"%21",36:"%24",38:"%26",39:"%27",40:"%28",41:"%29",42:"%2A",43:"%2B",44:"%2C",59:"%3B",61:"%3D",32:"%20"};function RJ(r,t,e){let i,n=-1;for(let o=0;o<r.length;o++){let s=r.charCodeAt(o);if(s>=97&&s<=122||s>=65&&s<=90||s>=48&&s<=57||s===45||s===46||s===95||s===126||t&&s===47||e&&s===91||e&&s===93||e&&s===58)n!==-1&&(i+=encodeURIComponent(r.substring(n,o)),n=-1),i!==void 0&&(i+=r.charAt(o));else{i===void 0&&(i=r.substr(0,o));let a=NJ[s];a!==void 0?(n!==-1&&(i+=encodeURIComponent(r.substring(n,o)),n=-1),i+=a):n===-1&&(n=o)}}return n!==-1&&(i+=encodeURIComponent(r.substring(n))),i!==void 0?i:r}function Jge(r){let t;for(let e=0;e<r.length;e++){let i=r.charCodeAt(e);i===35||i===63?(t===void 0&&(t=r.substr(0,e)),t+=NJ[i]):t!==void 0&&(t+=r[e])}return t!==void 0?t:r}function L_(r,t){let e;return r.authority&&r.path.length>1&&r.scheme==="file"?e=`//${r.authority}${r.path}`:r.path.charCodeAt(0)===47&&(r.path.charCodeAt(1)>=65&&r.path.charCodeAt(1)<=90||r.path.charCodeAt(1)>=97&&r.path.charCodeAt(1)<=122)&&r.path.charCodeAt(2)===58?t?e=r.path.substr(1):e=r.path[1].toLowerCase()+r.path.substr(2):e=r.path,St&&(e=e.replace(/\//g,"\\")),e}function Z5(r,t){let e=t?Jge:RJ,i="",{scheme:n,authority:o,path:s,query:a,fragment:l}=r;if(n&&(i+=n,i+=":"),(o||n==="file")&&(i+=zc,i+=zc),o){let d=o.indexOf("@");if(d!==-1){let c=o.substr(0,d);o=o.substr(d+1),d=c.lastIndexOf(":"),d===-1?i+=e(c,!1,!1):(i+=e(c.substr(0,d),!1,!1),i+=":",i+=e(c.substr(d+1),!1,!0)),i+="@"}o=o.toLowerCase(),d=o.lastIndexOf(":"),d===-1?i+=e(o,!1,!0):(i+=e(o.substr(0,d),!1,!0),i+=o.substr(d))}if(s){if(s.length>=3&&s.charCodeAt(0)===47&&s.charCodeAt(2)===58){let d=s.charCodeAt(1);d>=65&&d<=90&&(s=`/${String.fromCharCode(d+32)}:${s.substr(3)}`)}else if(s.length>=2&&s.charCodeAt(1)===58){let d=s.charCodeAt(0);d>=65&&d<=90&&(s=`${String.fromCharCode(d+32)}:${s.substr(2)}`)}i+=e(s,!0,!1)}return a&&(i+="?",i+=e(a,!1,!1)),l&&(i+="#",i+=t?l:RJ(l,!1,!1)),i}function FJ(r){try{return decodeURIComponent(r)}catch{return r.length>3?r.substr(0,3)+FJ(r.substr(3)):r}}var PJ=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function $M(r){return r.match(PJ)?r.replace(PJ,t=>FJ(t)):r}function mm(r,t,e){let i=r.get(t);return i===void 0&&(i=e,r.set(t,i)),i}var J5=class{constructor(t,e){this.uri=t;this.value=e}};function efe(r){return Array.isArray(r)}var Fn=class r{static defaultToKey=t=>t.toString();[Symbol.toStringTag]="ResourceMap";map;toKey;constructor(t,e){if(t instanceof r)this.map=new Map(t.map),this.toKey=e??r.defaultToKey;else if(efe(t)){this.map=new Map,this.toKey=e??r.defaultToKey;for(let[i,n]of t)this.set(i,n)}else this.map=new Map,this.toKey=t??r.defaultToKey}set(t,e){return this.map.set(this.toKey(t),new J5(t,e)),this}get(t){return this.map.get(this.toKey(t))?.value}has(t){return this.map.has(this.toKey(t))}get size(){return this.map.size}clear(){this.map.clear()}delete(t){return this.map.delete(this.toKey(t))}forEach(t,e){typeof e<"u"&&(t=t.bind(e));for(let[i,n]of this.map)t(n.value,n.uri,this)}*values(){for(let t of this.map.values())yield t.value}*keys(){for(let t of this.map.values())yield t.uri}*entries(){for(let t of this.map.values())yield[t.uri,t.value]}*[Symbol.iterator](){for(let[,t]of this.map)yield[t.uri,t.value]}},jM=class{[Symbol.toStringTag]="ResourceSet";_map;constructor(t,e){!t||typeof t=="function"?this._map=new Fn(t):(this._map=new Fn(e),t.forEach(this.add,this))}get size(){return this._map.size}add(t){return this._map.set(t,t),this}clear(){this._map.clear()}delete(t){return this._map.delete(t)}forEach(t,e){this._map.forEach((i,n)=>t.call(e,n,n,this))}has(t){return this._map.has(t)}entries(){return this._map.entries()}keys(){return this._map.keys()}values(){return this._map.keys()}[Symbol.iterator](){return this.keys()}};var e4=class{[Symbol.toStringTag]="LinkedMap";_map;_head;_tail;_size;_state;constructor(){this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(t){return this._map.has(t)}get(t,e=0){let i=this._map.get(t);if(i)return e!==0&&this.touch(i,e),i.value}set(t,e,i=0){let n=this._map.get(t);if(n)n.value=e,i!==0&&this.touch(n,i);else{switch(n={key:t,value:e,next:void 0,previous:void 0},i){case 0:this.addItemLast(n);break;case 1:this.addItemFirst(n);break;case 2:this.addItemLast(n);break;default:this.addItemLast(n);break}this._map.set(t,n),this._size++}return this}delete(t){return!!this.remove(t)}remove(t){let e=this._map.get(t);if(e)return this._map.delete(t),this.removeItem(e),this._size--,e.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");let t=this._head;return this._map.delete(t.key),this.removeItem(t),this._size--,t.value}forEach(t,e){let i=this._state,n=this._head;for(;n;){if(e?t.bind(e)(n.value,n.key,this):t(n.value,n.key,this),this._state!==i)throw new Error("LinkedMap got modified during iteration.");n=n.next}}keys(){let t=this,e=this._state,i=this._head,n={[Symbol.iterator](){return n},next(){if(t._state!==e)throw new Error("LinkedMap got modified during iteration.");if(i){let o={value:i.key,done:!1};return i=i.next,o}else return{value:void 0,done:!0}}};return n}values(){let t=this,e=this._state,i=this._head,n={[Symbol.iterator](){return n},next(){if(t._state!==e)throw new Error("LinkedMap got modified during iteration.");if(i){let o={value:i.value,done:!1};return i=i.next,o}else return{value:void 0,done:!0}}};return n}entries(){let t=this,e=this._state,i=this._head,n={[Symbol.iterator](){return n},next(){if(t._state!==e)throw new Error("LinkedMap got modified during iteration.");if(i){let o={value:[i.key,i.value],done:!1};return i=i.next,o}else return{value:void 0,done:!0}}};return n}[Symbol.iterator](){return this.entries()}trimOld(t){if(t>=this.size)return;if(t===0){this.clear();return}let e=this._head,i=this.size;for(;e&&i>t;)this._map.delete(e.key),e=e.next,i--;this._head=e,this._size=i,e&&(e.previous=void 0),this._state++}trimNew(t){if(t>=this.size)return;if(t===0){this.clear();return}let e=this._tail,i=this.size;for(;e&&i>t;)this._map.delete(e.key),e=e.previous,i--;this._tail=e,this._size=i,e&&(e.next=void 0),this._state++}addItemFirst(t){if(!this._head&&!this._tail)this._tail=t;else if(this._head)t.next=this._head,this._head.previous=t;else throw new Error("Invalid list");this._head=t,this._state++}addItemLast(t){if(!this._head&&!this._tail)this._head=t;else if(this._tail)t.previous=this._tail,this._tail.next=t;else throw new Error("Invalid list");this._tail=t,this._state++}removeItem(t){if(t===this._head&&t===this._tail)this._head=void 0,this._tail=void 0;else if(t===this._head){if(!t.next)throw new Error("Invalid list");t.next.previous=void 0,this._head=t.next}else if(t===this._tail){if(!t.previous)throw new Error("Invalid list");t.previous.next=void 0,this._tail=t.previous}else{let e=t.next,i=t.previous;if(!e||!i)throw new Error("Invalid list");e.previous=i,i.next=e}t.next=void 0,t.previous=void 0,this._state++}touch(t,e){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(e!==1&&e!==2)){if(e===1){if(t===this._head)return;let i=t.next,n=t.previous;t===this._tail?(n.next=void 0,this._tail=n):(i.previous=n,n.next=i),t.previous=void 0,t.next=this._head,this._head.previous=t,this._head=t,this._state++}else if(e===2){if(t===this._tail)return;let i=t.next,n=t.previous;t===this._head?(i.previous=void 0,this._head=i):(i.previous=n,n.next=i),t.next=void 0,t.previous=this._tail,this._tail.next=t,this._tail=t,this._state++}}}toJSON(){let t=[];return this.forEach((e,i)=>{t.push([i,e])}),t}fromJSON(t){this.clear();for(let[e,i]of t)this.set(e,i)}},XM=class extends e4{_limit;_ratio;constructor(t,e=1){super(),this._limit=t,this._ratio=Math.min(Math.max(0,e),1)}get limit(){return this._limit}set limit(t){this._limit=t,this.checkTrim()}get ratio(){return this._ratio}set ratio(t){this._ratio=Math.min(Math.max(0,t),1),this.checkTrim()}get(t,e=2){return super.get(t,e)}peek(t){return super.get(t,0)}set(t,e){return super.set(t,e,2),this}checkTrim(){this.size>this._limit&&this.trim(Math.round(this._limit*this._ratio))}},zr=class extends XM{constructor(t,e=1){super(t,e)}trim(t){this.trimOld(t)}set(t,e){return super.set(t,e),this.checkTrim(),this}},YM=class extends XM{constructor(t,e=1){super(t,e)}trim(t){this.trimNew(t)}set(t,e){return this._limit<=this.size&&!this.has(t)&&this.trim(Math.round(this._limit*this._ratio)-1),super.set(t,e),this}};var Kc=class{map=new Map;add(t,e){let i=this.map.get(t);i||(i=new Set,this.map.set(t,i)),i.add(e)}delete(t,e){let i=this.map.get(t);i&&(i.delete(e),i.size===0&&this.map.delete(t))}forEach(t,e){let i=this.map.get(t);i&&i.forEach(e)}get(t){let e=this.map.get(t);return e||new Set}};var mt;(w=>{function r(C){return C&&typeof C=="object"&&typeof C[Symbol.iterator]=="function"}w.is=r;let t=Object.freeze([]);function e(){return t}w.empty=e;function*i(C){yield C}w.single=i;function n(C){return r(C)?C:i(C)}w.wrap=n;function o(C){return C||t}w.from=o;function*s(C){for(let S=C.length-1;S>=0;S--)yield C[S]}w.reverse=s;function a(C){return!C||C[Symbol.iterator]().next().done===!0}w.isEmpty=a;function l(C){return C[Symbol.iterator]().next().value}w.first=l;function d(C,S){let D=0;for(let k of C)if(S(k,D++))return!0;return!1}w.some=d;function c(C,S){for(let D of C)if(S(D))return D}w.find=c;function*p(C,S){for(let D of C)S(D)&&(yield D)}w.filter=p;function*h(C,S){let D=0;for(let k of C)yield S(k,D++)}w.map=h;function*m(C,S){let D=0;for(let k of C)yield*S(k,D++)}w.flatMap=m;function*f(...C){for(let S of C)yield*S}w.concat=f;function g(C,S,D){let k=D;for(let M of C)k=S(k,M);return k}w.reduce=g;function*v(C,S,D=C.length){for(S<0&&(S+=C.length),D<0?D+=C.length:D>C.length&&(D=C.length);S<D;S++)yield C[S]}w.slice=v;function I(C,S=Number.POSITIVE_INFINITY){let D=[];if(S===0)return[D,C];let k=C[Symbol.iterator]();for(let M=0;M<S;M++){let O=k.next();if(O.done)return[D,w.empty()];D.push(O.value)}return[D,{[Symbol.iterator](){return k}}]}w.consume=I;async function y(C){let S=[];for await(let D of C)S.push(D);return Promise.resolve(S)}w.asyncToArray=y})(mt||={});var tfe=!1,Fv=null;function ife(r){Fv=r}if(tfe){let r="__is_disposable_tracked__";ife(new class{trackDisposable(t){let e=new Error("Potentially leaked disposable").stack;setTimeout(()=>{t[r]||console.log(e)},3e3)}setParent(t,e){if(t&&t!==R.None)try{t[r]=!0}catch{}}markAsDisposed(t){if(t&&t!==R.None)try{t[r]=!0}catch{}}markAsSingleton(t){}})}function Bv(r){return Fv?.trackDisposable(r),r}function Vv(r){Fv?.markAsDisposed(r)}function R_(r,t){Fv?.setParent(r,t)}function nfe(r,t){if(Fv)for(let e of r)Fv.setParent(e,t)}function rc(r){return Fv?.markAsSingleton(r),r}function Wv(r){return typeof r=="object"&&r!==null&&typeof r.dispose=="function"&&r.dispose.length===0}function _e(r){if(mt.is(r)){let t=[];for(let e of r)if(e)try{e.dispose()}catch(i){t.push(i)}if(t.length===1)throw t[0];if(t.length>1)throw new AggregateError(t,"Encountered errors while disposing of store");return Array.isArray(r)?[]:r}else if(r)return r.dispose(),r}function QM(r){for(let t of r)Wv(t)&&t.dispose();return[]}function In(...r){let t=le(()=>_e(r));return nfe(r,t),t}function le(r){let t=Bv({dispose:$a(()=>{Vv(t),r()})});return t}var B=class r{static DISABLE_DISPOSED_WARNING=!1;_toDispose=new Set;_isDisposed=!1;constructor(){Bv(this)}dispose(){this._isDisposed||(Vv(this),this._isDisposed=!0,this.clear())}get isDisposed(){return this._isDisposed}clear(){if(this._toDispose.size!==0)try{_e(this._toDispose)}finally{this._toDispose.clear()}}add(t){if(!t)return t;if(t===this)throw new Error("Cannot register a disposable on itself!");return R_(t,this),this._isDisposed?r.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this._toDispose.add(t),t}delete(t){if(t){if(t===this)throw new Error("Cannot dispose a disposable on itself!");this._toDispose.delete(t),t.dispose()}}deleteAndLeak(t){t&&this._toDispose.has(t)&&(this._toDispose.delete(t),R_(t,null))}},R=class{static None=Object.freeze({dispose(){}});_store=new B;constructor(){Bv(this),R_(this._store,this)}dispose(){Vv(this),this._store.dispose()}_register(t){if(t===this)throw new Error("Cannot register a disposable on itself!");return this._store.add(t)}},yt=class{_value;_isDisposed=!1;constructor(){Bv(this)}get value(){return this._isDisposed?void 0:this._value}set value(t){this._isDisposed||t===this._value||(this._value?.dispose(),t&&R_(t,this),this._value=t)}clear(){this.value=void 0}dispose(){this._isDisposed=!0,Vv(this),this._value?.dispose(),this._value=void 0}clearAndLeak(){let t=this._value;return this._value=void 0,t&&R_(t,null),t}};var us=class{_store=new Map;_isDisposed=!1;constructor(){Bv(this)}dispose(){Vv(this),this._isDisposed=!0,this.clearAndDisposeAll()}clearAndDisposeAll(){if(this._store.size)try{_e(this._store.values())}finally{this._store.clear()}}has(t){return this._store.has(t)}get size(){return this._store.size}get(t){return this._store.get(t)}set(t,e,i=!1){this._isDisposed&&console.warn(new Error("Trying to add a disposable to a DisposableMap that has already been disposed of. The added object will be leaked!").stack),i||this._store.get(t)?.dispose(),this._store.set(t,e)}deleteAndDispose(t){this._store.get(t)?.dispose(),this._store.delete(t)}deleteAndLeak(t){let e=this._store.get(t);return this._store.delete(t),e}keys(){return this._store.keys()}values(){return this._store.values()}[Symbol.iterator](){return this._store[Symbol.iterator]()}};var xo=class r{static Undefined=new r(void 0);element;next;prev;constructor(t){this.element=t,this.next=r.Undefined,this.prev=r.Undefined}},lr=class{_first=xo.Undefined;_last=xo.Undefined;_size=0;get size(){return this._size}isEmpty(){return this._first===xo.Undefined}clear(){let t=this._first;for(;t!==xo.Undefined;){let e=t.next;t.prev=xo.Undefined,t.next=xo.Undefined,t=e}this._first=xo.Undefined,this._last=xo.Undefined,this._size=0}unshift(t){return this._insert(t,!1)}push(t){return this._insert(t,!0)}_insert(t,e){let i=new xo(t);if(this._first===xo.Undefined)this._first=i,this._last=i;else if(e){let o=this._last;this._last=i,i.prev=o,o.next=i}else{let o=this._first;this._first=i,i.next=o,o.prev=i}this._size+=1;let n=!1;return()=>{n||(n=!0,this._remove(i))}}shift(){if(this._first!==xo.Undefined){let t=this._first.element;return this._remove(this._first),t}}pop(){if(this._last!==xo.Undefined){let t=this._last.element;return this._remove(this._last),t}}_remove(t){if(t.prev!==xo.Undefined&&t.next!==xo.Undefined){let e=t.prev;e.next=t.next,t.next.prev=e}else t.prev===xo.Undefined&&t.next===xo.Undefined?(this._first=xo.Undefined,this._last=xo.Undefined):t.next===xo.Undefined?(this._last=this._last.prev,this._last.next=xo.Undefined):t.prev===xo.Undefined&&(this._first=this._first.next,this._first.prev=xo.Undefined);this._size-=1}*[Symbol.iterator](){let t=this._first;for(;t!==xo.Undefined;)yield t.element,t=t.next}};var ps=(r,t)=>r===t;function TS(r=ps){return(t,e)=>xi(t,e,r)}function WJ(){return(r,t)=>r.equals(t)}function _S(r,t,e){if(e!==void 0){let i=r;return i==null||t===void 0||t===null?t===i:e(i,t)}else{let i=r;return(n,o)=>n==null||o===void 0||o===null?o===n:i(n,o)}}function HJ(r){return JSON.stringify(t4(r))}var ofe=0,VJ=new WeakMap;function t4(r){if(Array.isArray(r))return r.map(t4);if(r&&typeof r=="object")if(Object.getPrototypeOf(r)===Object.prototype){let t=r,e=Object.create(null);for(let i of Object.keys(t).sort())e[i]=t4(t[i]);return e}else{let t=VJ.get(r);return t===void 0&&(t=ofe++,VJ.set(r,t)),t+"----2b76a038c20c4bcc"}return r}var uo=class{constructor(t,e,i){this.owner=t;this.debugNameSource=e;this.referenceFn=i}getDebugName(t){return GJ(t,this)}},UJ=new Map,i4=new WeakMap;function GJ(r,t){let e=i4.get(r);if(e)return e;let i=rfe(r,t);if(i){let n=UJ.get(i)??0;n++,UJ.set(i,n);let o=n===1?i:`${i}#${n}`;return i4.set(r,o),o}}function rfe(r,t){let e=i4.get(r);if(e)return e;let i=t.owner?afe(t.owner)+".":"",n,o=t.debugNameSource;if(o!==void 0)if(typeof o=="function"){if(n=o(),n!==void 0)return i+n}else return i+o;let s=t.referenceFn;if(s!==void 0&&(n=ZM(s),n!==void 0))return i+n;if(t.owner!==void 0){let a=sfe(t.owner,r);if(a!==void 0)return i+a}}function sfe(r,t){for(let e in r)if(r[e]===t)return e}var zJ=new Map,KJ=new WeakMap;function afe(r){let t=KJ.get(r);if(t)return t;let e=lfe(r),i=zJ.get(e)??0;i++,zJ.set(e,i);let n=i===1?e:`${e}#${i}`;return KJ.set(r,n),n}function lfe(r){let t=r.constructor;return t?t.name:"Object"}function ZM(r){let t=r.toString(),i=/\/\*\*\s*@description\s*([^*]*)\*\//.exec(t);return(i?i[1]:void 0)?.trim()}function P_(r,t){if(!r)throw new Error(t?`Assertion failed (${t})`:"Assertion Failed")}function gm(r,t="Unreachable"){throw new Error(t)}function n4(r){r||Xe(new _t("Soft Assertion Failed"))}function Gc(r){if(!r()){debugger;r(),Xe(new _t("Assertion Failed"))}}function M_(r,t){let e=0;for(;e<r.length-1;){let i=r[e],n=r[e+1];if(!t(i,n))return!1;e++}return!0}function Ft(r){return new DS(new uo(void 0,void 0,r),r,void 0,void 0)}function fp(r,t){return new DS(new uo(r.owner,r.debugName,r.debugReferenceFn??t),t,void 0,void 0)}function Gg(r,t){return new DS(new uo(r.owner,r.debugName,r.debugReferenceFn??t),t,r.createEmptyChangeSummary,r.handleChange)}function Cr(r){let t=new B,e=fp({owner:void 0,debugName:void 0,debugReferenceFn:r},i=>{t.clear(),r(i,t)});return le(()=>{e.dispose(),t.dispose()})}var DS=class{constructor(t,e,i,n){this._debugNameData=t;this._runFn=e;this.createChangeSummary=i;this._handleChange=n;this.changeSummary=this.createChangeSummary?.(),Cl()?.handleAutorunCreated(this),this._runIfNeeded(),Bv(this)}state=2;updateCount=0;disposed=!1;dependencies=new Set;dependenciesToBeRemoved=new Set;changeSummary;get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}dispose(){this.disposed=!0;for(let t of this.dependencies)t.removeObserver(this);this.dependencies.clear(),Vv(this)}_runIfNeeded(){if(this.state===3)return;let t=this.dependenciesToBeRemoved;this.dependenciesToBeRemoved=this.dependencies,this.dependencies=t,this.state=3;let e=this.disposed;try{if(!e){Cl()?.handleAutorunTriggered(this);let i=this.changeSummary;try{this.changeSummary=this.createChangeSummary?.(),this._runFn(this,i)}catch(n){yS(n)}}}finally{e||Cl()?.handleAutorunFinished(this);for(let i of this.dependenciesToBeRemoved)i.removeObserver(this);this.dependenciesToBeRemoved.clear()}}toString(){return`Autorun<${this.debugName}>`}beginUpdate(){this.state===3&&(this.state=1),this.updateCount++}endUpdate(){try{if(this.updateCount===1)do{if(this.state===1){this.state=3;for(let t of this.dependencies)if(t.reportChanges(),this.state===2)break}this._runIfNeeded()}while(this.state!==3)}finally{this.updateCount--}Gc(()=>this.updateCount>=0)}handlePossibleChange(t){this.state===3&&this.dependencies.has(t)&&!this.dependenciesToBeRemoved.has(t)&&(this.state=1)}handleChange(t,e){if(this.dependencies.has(t)&&!this.dependenciesToBeRemoved.has(t))try{(this._handleChange?this._handleChange({changedObservable:t,change:e,didChange:n=>n===t},this.changeSummary):!0)&&(this.state=2)}catch(i){yS(i)}}readObservable(t){if(this.disposed)return t.get();t.addObserver(this);let e=t.get();return this.dependencies.add(t),this.dependenciesToBeRemoved.delete(t),e}};(t=>t.Observer=DS)(Ft||={});function dt(r,t){return t!==void 0?new bp(new uo(r,void 0,t),t,void 0,void 0,void 0,ps):new bp(new uo(void 0,void 0,r),r,void 0,void 0,void 0,ps)}function kS(r,t,e){return new o4(new uo(r,void 0,t),t,void 0,void 0,void 0,ps,e)}function Os(r,t){return new bp(new uo(r.owner,r.debugName,r.debugReferenceFn),t,void 0,void 0,r.onLastObserverRemoved,r.equalsFn??ps)}$J(Os);function r4(r,t){return new bp(new uo(r.owner,r.debugName,void 0),t,r.createEmptyChangeSummary,r.handleChange,void 0,r.equalityComparer??ps)}function qc(r,t){let e,i;t===void 0?(e=r,i=void 0):(i=r,e=t);let n=new B;return new bp(new uo(i,void 0,e),o=>(n.clear(),e(o,n)),void 0,void 0,()=>n.dispose(),ps)}function pd(r,t){let e,i;t===void 0?(e=r,i=void 0):(i=r,e=t);let n;return new bp(new uo(i,void 0,e),o=>{n?n.clear():n=new B;let s=e(o);return s&&n.add(s),s},void 0,void 0,()=>{n&&(n.dispose(),n=void 0)},ps)}var bp=class extends $c{constructor(e,i,n,o,s=void 0,a){super();this._debugNameData=e;this._computeFn=i;this.createChangeSummary=n;this._handleChange=o;this._handleLastObserverRemoved=s;this._equalityComparator=a;this.changeSummary=this.createChangeSummary?.(),Cl()?.handleDerivedCreated(this)}state=0;value=void 0;updateCount=0;dependencies=new Set;dependenciesToBeRemoved=new Set;changeSummary=void 0;get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}onLastObserverRemoved(){this.state=0,this.value=void 0;for(let e of this.dependencies)e.removeObserver(this);this.dependencies.clear(),this._handleLastObserverRemoved?.()}get(){if(this.observers.size===0){let e=this._computeFn(this,this.createChangeSummary?.());return this.onLastObserverRemoved(),e}else{do{if(this.state===1){for(let e of this.dependencies)if(e.reportChanges(),this.state===2)break}this.state===1&&(this.state=3),this._recomputeIfNeeded()}while(this.state!==3);return this.value}}_recomputeIfNeeded(){if(this.state===3)return;let e=this.dependenciesToBeRemoved;this.dependenciesToBeRemoved=this.dependencies,this.dependencies=e;let i=this.state!==0,n=this.value;this.state=3;let o=!1;try{let s=this.changeSummary;this.changeSummary=this.createChangeSummary?.();try{this.value=this._computeFn(this,s)}finally{for(let a of this.dependenciesToBeRemoved)a.removeObserver(this);this.dependenciesToBeRemoved.clear()}o=i&&!this._equalityComparator(n,this.value),Cl()?.handleDerivedRecomputed(this,{oldValue:n,newValue:this.value,change:void 0,didChange:o,hadValue:i})}catch(s){yS(s)}if(o)for(let s of this.observers)s.handleChange(this,void 0)}toString(){return`LazyDerived<${this.debugName}>`}beginUpdate(e){this.updateCount++;let i=this.updateCount===1;if(this.state===3&&(this.state=1,!i))for(let n of this.observers)n.handlePossibleChange(this);if(i)for(let n of this.observers)n.beginUpdate(this)}endUpdate(e){if(this.updateCount--,this.updateCount===0){let i=[...this.observers];for(let n of i)n.endUpdate(this)}Gc(()=>this.updateCount>=0)}handlePossibleChange(e){if(this.state===3&&this.dependencies.has(e)&&!this.dependenciesToBeRemoved.has(e)){this.state=1;for(let i of this.observers)i.handlePossibleChange(this)}}handleChange(e,i){if(this.dependencies.has(e)&&!this.dependenciesToBeRemoved.has(e)){let n=!1;try{n=this._handleChange?this._handleChange({changedObservable:e,change:i,didChange:s=>s===e},this.changeSummary):!0}catch(s){yS(s)}let o=this.state===3;if(n&&(this.state===1||o)&&(this.state=2,o))for(let s of this.observers)s.handlePossibleChange(this)}}readObservable(e){e.addObserver(this);let i=e.get();return this.dependencies.add(e),this.dependenciesToBeRemoved.delete(e),i}addObserver(e){let i=!this.observers.has(e)&&this.updateCount>0;super.addObserver(e),i&&e.beginUpdate(this)}removeObserver(e){let i=this.observers.has(e)&&this.updateCount>0;super.removeObserver(e),i&&e.endUpdate(this)}},o4=class extends bp{constructor(e,i,n,o,s=void 0,a,l){super(e,i,n,o,s,a);this.set=l}};function qg(r){return new s4(r)}var s4=class extends A_{constructor(e){super();this.value=e}get debugName(){return this.toString()}get(){return this.value}addObserver(e){}removeObserver(e){}toString(){return`Const: ${this.value}`}};function Pi(...r){let t,e,i;return r.length===3?[t,e,i]=r:[e,i]=r,new vp(new uo(t,void 0,i),e,i,()=>vp.globalTransaction,ps)}function jJ(r,t,e){return new vp(new uo(r.owner,r.debugName,r.debugReferenceFn??e),t,e,()=>vp.globalTransaction,r.equalsFn??ps)}var vp=class extends $c{constructor(e,i,n,o,s){super();this._debugNameData=e;this.event=i;this._getValue=n;this._getTransaction=o;this._equalityComparator=s}static globalTransaction;value;hasValue=!1;subscription;getDebugName(){return this._debugNameData.getDebugName(this)}get debugName(){let e=this.getDebugName();return"From Event"+(e?`: ${e}`:"")}onFirstObserverAdded(){this.subscription=this.event(this.handleEvent)}handleEvent=e=>{let i=this._getValue(e),n=this.value,o=!this.hasValue||!this._equalityComparator(n,i),s=!1;o&&(this.value=i,this.hasValue&&(s=!0,yp(this._getTransaction(),a=>{Cl()?.handleFromEventObservableTriggered(this,{oldValue:n,newValue:i,change:void 0,didChange:o,hadValue:this.hasValue});for(let l of this.observers)a.updateObserver(l,this),l.handleChange(this,void 0)},()=>{let a=this.getDebugName();return"Event fired"+(a?`: ${a}`:"")})),this.hasValue=!0),s||Cl()?.handleFromEventObservableTriggered(this,{oldValue:n,newValue:i,change:void 0,didChange:o,hadValue:this.hasValue})};onLastObserverRemoved(){this.subscription.dispose(),this.subscription=void 0,this.hasValue=!1,this.value=void 0}get(){return this.subscription?(this.hasValue||this.handleEvent(void 0),this.value):this._getValue(void 0)}};(e=>{e.Observer=vp;function t(i,n){let o=!1;vp.globalTransaction===void 0&&(vp.globalTransaction=i,o=!0);try{n()}finally{o&&(vp.globalTransaction=void 0)}}e.batchEventsGlobally=t})(Pi||={});function hs(r,t){return new a4(r,t)}var a4=class extends $c{constructor(e,i){super();this.debugName=e;this.event=i}subscription;onFirstObserverAdded(){this.subscription=this.event(this.handleEvent)}handleEvent=()=>{nn(e=>{for(let i of this.observers)e.updateObserver(i,this),i.handleChange(this,void 0)},()=>this.debugName)};onLastObserverRemoved(){this.subscription.dispose(),this.subscription=void 0}get(){}};function Ip(r){return typeof r=="string"?new JM(r):new JM(void 0,r)}var JM=class extends $c{constructor(e,i){super();this._debugName=e;this._owner=i}get debugName(){return new uo(this._owner,this._debugName,void 0).getDebugName(this)??"Observable Signal"}toString(){return this.debugName}trigger(e,i){if(!e){nn(n=>{this.trigger(n,i)},()=>`Trigger signal ${this.debugName}`);return}for(let n of this.observers)e.updateObserver(n,this),n.handleChange(this,i)}get(){}};function XJ(r){let t=new eA(!1,void 0);return r.addObserver(t),le(()=>{r.removeObserver(t)})}ZJ(XJ);function $g(r,t){let e=new eA(!0,t);return r.addObserver(e),t?t(r.get()):r.reportChanges(),le(()=>{r.removeObserver(e)})}QJ($g);var eA=class{constructor(t,e){this._forceRecompute=t;this._handleValue=e}_counter=0;beginUpdate(t){this._counter++}endUpdate(t){this._counter--,this._counter===0&&this._forceRecompute&&(this._handleValue?this._handleValue(t.get()):t.reportChanges())}handlePossibleChange(t){}handleChange(t,e){}};function iA(r,t){let e;return Os({owner:r,debugReferenceFn:t},n=>(e=t(n,e),e))}var tA=class{constructor(t){this.observable=t}get onDidChange(){return X.fromObservableLight(this.observable)}get value(){return this.observable.get()}};function YJ(r,t){return iA(r,(e,i)=>i??t(e))}var JJ;function eee(r){JJ=r}function Cl(){return JJ}var nA=class{indentation=0;textToConsoleArgs(t){return cfe([LS(hfe("|  ",this.indentation)),t])}formatInfo(t){return t.hadValue?t.didChange?[LS(" "),jc(N_(t.oldValue,70),{color:"red",strikeThrough:!0}),LS(" "),jc(N_(t.newValue,60),{color:"green"})]:[LS(" (unchanged)")]:[LS(" "),jc(N_(t.newValue,60),{color:"green"}),LS(" (initial)")]}handleObservableChanged(t,e){console.log(...this.textToConsoleArgs([O_("observable value changed"),jc(t.debugName,{color:"BlueViolet"}),...this.formatInfo(e)]))}changedObservablesSets=new WeakMap;formatChanges(t){if(t.size!==0)return jc(" (changed deps: "+[...t].map(e=>e.debugName).join(", ")+")",{color:"gray"})}handleDerivedCreated(t){let e=t.handleChange;this.changedObservablesSets.set(t,new Set),t.handleChange=(i,n)=>(this.changedObservablesSets.get(t).add(i),e.apply(t,[i,n]))}handleDerivedRecomputed(t,e){let i=this.changedObservablesSets.get(t);console.log(...this.textToConsoleArgs([O_("derived recomputed"),jc(t.debugName,{color:"BlueViolet"}),...this.formatInfo(e),this.formatChanges(i),{data:[{fn:t._debugNameData.referenceFn??t._computeFn}]}])),i.clear()}handleFromEventObservableTriggered(t,e){console.log(...this.textToConsoleArgs([O_("observable from event triggered"),jc(t.debugName,{color:"BlueViolet"}),...this.formatInfo(e),{data:[{fn:t._getValue}]}]))}handleAutorunCreated(t){let e=t.handleChange;this.changedObservablesSets.set(t,new Set),t.handleChange=(i,n)=>(this.changedObservablesSets.get(t).add(i),e.apply(t,[i,n]))}handleAutorunTriggered(t){let e=this.changedObservablesSets.get(t);console.log(...this.textToConsoleArgs([O_("autorun"),jc(t.debugName,{color:"BlueViolet"}),this.formatChanges(e),{data:[{fn:t._debugNameData.referenceFn??t._runFn}]}])),e.clear(),this.indentation++}handleAutorunFinished(t){this.indentation--}handleBeginTransaction(t){let e=t.getDebugName();e===void 0&&(e=""),console.log(...this.textToConsoleArgs([O_("transaction"),jc(e,{color:"BlueViolet"}),{data:[{fn:t._fn}]}])),this.indentation++}handleEndTransaction(){this.indentation--}};function cfe(r){let t=new Array,e=[],i="";function n(s){if("length"in s)for(let a of s)a&&n(a);else"text"in s?(i+=`%c${s.text}`,t.push(s.style),s.data&&e.push(...s.data)):"data"in s&&e.push(...s.data)}n(r);let o=[i,...t];return o.push(...e),o}function LS(r){return jc(r,{color:"black"})}function O_(r){return jc(mfe(`${r}: `,10),{color:"black",bold:!0})}function jc(r,t={color:"black"}){function e(n){return Object.entries(n).reduce((o,[s,a])=>`${o}${s}:${a};`,"")}let i={color:t.color};return t.strikeThrough&&(i["text-decoration"]="line-through"),t.bold&&(i["font-weight"]="bold"),{text:r,style:e(i)}}function N_(r,t){switch(typeof r){case"number":return""+r;case"string":return r.length+2<=t?`"${r}"`:`"${r.substr(0,t-7)}"+...`;case"boolean":return r?"true":"false";case"undefined":return"undefined";case"object":return r===null?"null":Array.isArray(r)?ufe(r,t):pfe(r,t);case"symbol":return r.toString();case"function":return`[[Function${r.name?" "+r.name:""}]]`;default:return""+r}}function ufe(r,t){let e="[ ",i=!0;for(let n of r){if(i||(e+=", "),e.length-5>t){e+="...";break}i=!1,e+=`${N_(n,t-e.length)}`}return e+=" ]",e}function pfe(r,t){let e="{ ",i=!0;for(let[n,o]of Object.entries(r)){if(i||(e+=", "),e.length-5>t){e+="...";break}i=!1,e+=`${n}: ${N_(o,t-e.length)}`}return e+=" }",e}function hfe(r,t){let e="";for(let i=1;i<=t;i++)e+=r;return e}function mfe(r,t){for(;r.length<t;)r+=" ";return r}var tee;function QJ(r){tee=r}var iee;function ZJ(r){iee=r}var l4;function $J(r){l4=r}var A_=class{get TChange(){return null}reportChanges(){this.get()}read(t){return t?t.readObservable(this):this.get()}map(t,e){let i=e===void 0?void 0:t,n=e===void 0?t:e;return l4({owner:i,debugName:()=>{let o=ZM(n);if(o!==void 0)return o;let a=/^\s*\(?\s*([a-zA-Z_$][a-zA-Z_$0-9]*)\s*\)?\s*=>\s*\1(?:\??)\.([a-zA-Z_$][a-zA-Z_$0-9]*)\s*$/.exec(n.toString());if(a)return`${this.debugName}.${a[2]}`;if(!i)return`${this.debugName} (mapped)`},debugReferenceFn:n},o=>n(this.read(o),o))}flatten(){return l4({owner:void 0,debugName:()=>`${this.debugName} (flattened)`},t=>this.read(t).read(t))}recomputeInitiallyAndOnChange(t,e){return t.add(tee(this,e)),this}keepObserved(t){return t.add(iee(this)),this}get debugValue(){return this.get()}},$c=class extends A_{observers=new Set;addObserver(t){let e=this.observers.size;this.observers.add(t),e===0&&this.onFirstObserverAdded()}removeObserver(t){this.observers.delete(t)&&this.observers.size===0&&this.onLastObserverRemoved()}onFirstObserverAdded(){}onLastObserverRemoved(){}};function nn(r,t){let e=new jg(r,t);try{r(e)}finally{e.finish()}}function yp(r,t,e){r?t(r):nn(t,e)}var jg=class{constructor(t,e){this._fn=t;this._getDebugName=e;Cl()?.handleBeginTransaction(this)}updatingObservers=[];getDebugName(){return this._getDebugName?this._getDebugName():ZM(this._fn)}updateObserver(t,e){this.updatingObservers.push({observer:t,observable:e}),t.beginUpdate(e)}finish(){let t=this.updatingObservers;for(let e=0;e<t.length;e++){let{observer:i,observable:n}=t[e];i.endUpdate(n)}this.updatingObservers=null,Cl()?.handleEndTransaction()}};function Ht(r,t){let e;return typeof r=="string"?e=new uo(void 0,r,void 0):e=new uo(r,void 0,void 0),new RS(e,t,ps)}var RS=class extends $c{constructor(e,i,n){super();this._debugNameData=e;this._equalityComparator=n;this._value=i}_value;get debugName(){return this._debugNameData.getDebugName(this)??"ObservableValue"}get(){return this._value}set(e,i,n){if(n===void 0&&this._equalityComparator(this._value,e))return;let o;i||(i=o=new jg(()=>{},()=>`Setting ${this.debugName}`));try{let s=this._value;this._setValue(e),Cl()?.handleObservableChanged(this,{oldValue:s,newValue:e,change:n,didChange:!0,hadValue:!0});for(let a of this.observers)i.updateObserver(a,this),a.handleChange(this,n)}finally{o&&o.finish()}}toString(){return`${this.debugName}: ${this._value}`}_setValue(e){this._value=e}};function PS(r,t){let e;return typeof r=="string"?e=new uo(void 0,r,void 0):e=new uo(r,void 0,void 0),new d4(e,t,ps)}var d4=class extends RS{_setValue(t){this._value!==t&&(this._value&&this._value.dispose(),this._value=t)}dispose(){this._value?.dispose()}};function c4(r,t,e,i){return t||(t=n=>n!=null),new Promise((n,o)=>{let s=!0,a=!1,l=r.map(c=>({isFinished:t(c),error:e?e(c):!1,state:c})),d=Ft(c=>{let{isFinished:p,error:h,state:m}=l.read(c);(p||h)&&(s?a=!0:d.dispose(),h?o(h===!0?m:h):n(m))});if(i){let c=i.onCancellationRequested(()=>{d.dispose(),c.dispose(),o(new wo)});if(i.isCancellationRequested){d.dispose(),c.dispose(),o(new wo);return}}s=!1,a&&d.dispose()})}var oA=class extends $c{constructor(e,i,n){super();this._debugNameData=e;this._equalityComparator=n;this._value=i}_value;_isUpToDate=!0;_deltas=[];get debugName(){return this._debugNameData.getDebugName(this)??"LazyObservableValue"}get(){return this._update(),this._value}_update(){if(!this._isUpToDate)if(this._isUpToDate=!0,this._deltas.length>0){for(let e of this.observers)for(let i of this._deltas)e.handleChange(this,i);this._deltas.length=0}else for(let e of this.observers)e.handleChange(this,void 0)}_updateCounter=0;_beginUpdate(){if(this._updateCounter++,this._updateCounter===1)for(let e of this.observers)e.beginUpdate(this)}_endUpdate(){if(this._updateCounter--,this._updateCounter===0){this._update();let e=[...this.observers];for(let i of e)i.endUpdate(this)}}addObserver(e){let i=!this.observers.has(e)&&this._updateCounter>0;super.addObserver(e),i&&e.beginUpdate(this)}removeObserver(e){let i=this.observers.has(e)&&this._updateCounter>0;super.removeObserver(e),i&&e.endUpdate(this)}set(e,i,n){if(n===void 0&&this._equalityComparator(this._value,e))return;let o;i||(i=o=new jg(()=>{},()=>`Setting ${this.debugName}`));try{if(this._isUpToDate=!1,this._setValue(e),n!==void 0&&this._deltas.push(n),i.updateObserver({beginUpdate:()=>this._beginUpdate(),endUpdate:()=>this._endUpdate(),handleChange:(s,a)=>{},handlePossibleChange:s=>{}},this),this._updateCounter>1)for(let s of this.observers)s.handlePossibleChange(this)}finally{o&&o.finish()}}toString(){return`${this.debugName}: ${this._value}`}_setValue(e){this._value=e}};function rA(r,t){return r.lazy?new oA(new uo(r.owner,r.debugName,void 0),t,r.equalsFn??ps):new RS(new uo(r.owner,r.debugName,void 0),t,r.equalsFn??ps)}var gfe=!1;gfe&&eee(new nA);var ffe=globalThis.performance&&typeof globalThis.performance.now=="function",Ko=class r{_startTime;_stopTime;_now;static create(t){return new r(t)}constructor(t){this._now=ffe&&t===!1?Date.now:globalThis.performance.now.bind(globalThis.performance),this._startTime=this._now(),this._stopTime=-1}stop(){this._stopTime=this._now()}reset(){this._startTime=this._now(),this._stopTime=-1}elapsed(){return this._stopTime!==-1?this._stopTime-this._startTime:this._now()-this._startTime}};var sA=Symbol("MicrotaskDelay");var bfe=!1,nee=!1,vfe=!1,X;(xe=>{xe.None=()=>R.None;function t(be){if(vfe){let{onDidAddListener:fe}=be,Le=F_.create(),Ee=0;be.onDidAddListener=()=>{++Ee===2&&(console.warn("snapshotted emitter LIKELY used public and SHOULD HAVE BEEN created with DisposableStore. snapshotted here"),Le.print()),fe?.()}}}function e(be,fe){return m(be,()=>{},0,void 0,!0,void 0,fe)}xe.defer=e;function i(be){return(fe,Le=null,Ee)=>{let Ce=!1,Je;return Je=be(pe=>{if(!Ce)return Je?Je.dispose():Ce=!0,fe.call(Le,pe)},null,Ee),Ce&&Je.dispose(),Je}}xe.once=i;function n(be,fe){return xe.once(xe.filter(be,fe))}xe.onceIf=n;function o(be,fe,Le){return p((Ee,Ce=null,Je)=>be(pe=>Ee.call(Ce,fe(pe)),null,Je),Le)}xe.map=o;function s(be,fe,Le){return p((Ee,Ce=null,Je)=>be(pe=>{fe(pe),Ee.call(Ce,pe)},null,Je),Le)}xe.forEach=s;function a(be,fe,Le){return p((Ee,Ce=null,Je)=>be(pe=>fe(pe)&&Ee.call(Ce,pe),null,Je),Le)}xe.filter=a;function l(be){return be}xe.signal=l;function d(...be){return(fe,Le=null,Ee)=>{let Ce=In(...be.map(Je=>Je(pe=>fe.call(Le,pe))));return h(Ce,Ee)}}xe.any=d;function c(be,fe,Le,Ee){let Ce=Le;return o(be,Je=>(Ce=fe(Ce,Je),Ce),Ee)}xe.reduce=c;function p(be,fe){let Le,Ee={onWillAddFirstListener(){Le=be(Ce.fire,Ce)},onDidRemoveLastListener(){Le?.dispose()}};fe||t(Ee);let Ce=new x(Ee);return fe?.add(Ce),Ce.event}function h(be,fe){return fe instanceof Array?fe.push(be):fe&&fe.add(be),be}function m(be,fe,Le=100,Ee=!1,Ce=!1,Je,pe){let qt,Mt,at,On=0,Nn,Ro={leakWarningThreshold:Je,onWillAddFirstListener(){qt=be(sd=>{On++,Mt=fe(Mt,sd),Ee&&!at&&(or.fire(Mt),Mt=void 0),Nn=()=>{let Qi=Mt;Mt=void 0,at=void 0,(!Ee||On>1)&&or.fire(Qi),On=0},typeof Le=="number"?(clearTimeout(at),at=setTimeout(Nn,Le)):at===void 0&&(at=0,queueMicrotask(Nn))})},onWillRemoveListener(){Ce&&On>0&&Nn?.()},onDidRemoveLastListener(){Nn=void 0,qt.dispose()}};pe||t(Ro);let or=new x(Ro);return pe?.add(or),or.event}xe.debounce=m;function f(be,fe=0,Le){return xe.debounce(be,(Ee,Ce)=>Ee?(Ee.push(Ce),Ee):[Ce],fe,void 0,!0,void 0,Le)}xe.accumulate=f;function g(be,fe=(Ee,Ce)=>Ee===Ce,Le){let Ee=!0,Ce;return a(be,Je=>{let pe=Ee||!fe(Je,Ce);return Ee=!1,Ce=Je,pe},Le)}xe.latch=g;function v(be,fe,Le){return[xe.filter(be,fe,Le),xe.filter(be,Ee=>!fe(Ee),Le)]}xe.split=v;function I(be,fe=!1,Le=[],Ee){let Ce=Le.slice(),Je=be(Mt=>{Ce?Ce.push(Mt):qt.fire(Mt)});Ee&&Ee.add(Je);let pe=()=>{Ce?.forEach(Mt=>qt.fire(Mt)),Ce=null},qt=new x({onWillAddFirstListener(){Je||(Je=be(Mt=>qt.fire(Mt)),Ee&&Ee.add(Je))},onDidAddFirstListener(){Ce&&(fe?setTimeout(pe):pe())},onDidRemoveLastListener(){Je&&Je.dispose(),Je=null}});return Ee&&Ee.add(qt),qt.event}xe.buffer=I;function y(be,fe){return(Ee,Ce,Je)=>{let pe=fe(new C);return be(function(qt){let Mt=pe.evaluate(qt);Mt!==w&&Ee.call(Ce,Mt)},void 0,Je)}}xe.chain=y;let w=Symbol("HaltChainable");class C{steps=[];map(fe){return this.steps.push(fe),this}forEach(fe){return this.steps.push(Le=>(fe(Le),Le)),this}filter(fe){return this.steps.push(Le=>fe(Le)?Le:w),this}reduce(fe,Le){let Ee=Le;return this.steps.push(Ce=>(Ee=fe(Ee,Ce),Ee)),this}latch(fe=(Le,Ee)=>Le===Ee){let Le=!0,Ee;return this.steps.push(Ce=>{let Je=Le||!fe(Ce,Ee);return Le=!1,Ee=Ce,Je?Ce:w}),this}evaluate(fe){for(let Le of this.steps)if(fe=Le(fe),fe===w)break;return fe}}function S(be,fe,Le=Ee=>Ee){let Ee=(...qt)=>pe.fire(Le(...qt)),Ce=()=>be.on(fe,Ee),Je=()=>be.removeListener(fe,Ee),pe=new x({onWillAddFirstListener:Ce,onDidRemoveLastListener:Je});return pe.event}xe.fromNodeEventEmitter=S;function D(be,fe,Le=Ee=>Ee){let Ee=(...qt)=>pe.fire(Le(...qt)),Ce=()=>be.addEventListener(fe,Ee),Je=()=>be.removeEventListener(fe,Ee),pe=new x({onWillAddFirstListener:Ce,onDidRemoveLastListener:Je});return pe.event}xe.fromDOMEventEmitter=D;function k(be){return new Promise(fe=>i(be)(fe))}xe.toPromise=k;function M(be){let fe=new x;return be.then(Le=>{fe.fire(Le)},()=>{fe.fire(void 0)}).finally(()=>{fe.dispose()}),fe.event}xe.fromPromise=M;function O(be,fe){return be(Le=>fe.fire(Le))}xe.forward=O;function K(be,fe,Le){return fe(Le),be(Ee=>fe(Ee))}xe.runAndSubscribe=K;class G{constructor(fe,Le){this._observable=fe;let Ee={onWillAddFirstListener:()=>{fe.addObserver(this),this._observable.reportChanges()},onDidRemoveLastListener:()=>{fe.removeObserver(this)}};Le||t(Ee),this.emitter=new x(Ee),Le&&Le.add(this.emitter)}emitter;_counter=0;_hasChanged=!1;beginUpdate(fe){this._counter++}handlePossibleChange(fe){}handleChange(fe,Le){this._hasChanged=!0}endUpdate(fe){this._counter--,this._counter===0&&(this._observable.reportChanges(),this._hasChanged&&(this._hasChanged=!1,this.emitter.fire(this._observable.get())))}}function Y(be,fe){return new G(be,fe).emitter.event}xe.fromObservable=Y;function ge(be){return(fe,Le,Ee)=>{let Ce=0,Je=!1,pe={beginUpdate(){Ce++},endUpdate(){Ce--,Ce===0&&(be.reportChanges(),Je&&(Je=!1,fe.call(Le)))},handlePossibleChange(){},handleChange(){Je=!0}};be.addObserver(pe),be.reportChanges();let qt={dispose(){be.removeObserver(pe)}};return Ee instanceof B?Ee.add(qt):Array.isArray(Ee)&&Ee.push(qt),qt}}xe.fromObservableLight=ge})(X||={});var u4=class r{static all=new Set;static _idPool=0;name;listenerCount=0;invocationCount=0;elapsedOverall=0;durations=[];_stopWatch;constructor(t){this.name=`${t}_${r._idPool++}`,r.all.add(this)}start(t){this._stopWatch=new Ko,this.listenerCount=t}stop(){if(this._stopWatch){let t=this._stopWatch.elapsed();this.durations.push(t),this.elapsedOverall+=t,this.invocationCount+=1,this._stopWatch=void 0}}},oee=-1;var p4=class r{constructor(t,e,i=(r._idPool++).toString(16).padStart(3,"0")){this._errorHandler=t;this.threshold=e;this.name=i}static _idPool=1;_stacks;_warnCountdown=0;dispose(){this._stacks?.clear()}check(t,e){let i=this.threshold;if(i<=0||e<i)return;this._stacks||(this._stacks=new Map);let n=this._stacks.get(t.value)||0;if(this._stacks.set(t.value,n+1),this._warnCountdown-=1,this._warnCountdown<=0){this._warnCountdown=i*.5;let[o,s]=this.getMostFrequentStack(),a=`[${this.name}] potential listener LEAK detected, having ${e} listeners already. MOST frequent listener (${s}):`;console.warn(a),console.warn(o);let l=new h4(a,o);this._errorHandler(l)}return()=>{let o=this._stacks.get(t.value)||0;this._stacks.set(t.value,o-1)}}getMostFrequentStack(){if(!this._stacks)return;let t,e=0;for(let[i,n]of this._stacks)(!t||e<n)&&(t=[i,n],e=n);return t}},F_=class r{constructor(t){this.value=t}static create(){let t=new Error;return new r(t.stack??"")}print(){console.warn(this.value.split(`
`).slice(2).join(`
`))}},h4=class extends Error{constructor(t,e){super(t),this.name="ListenerLeakError",this.stack=e}},m4=class extends Error{constructor(t,e){super(t),this.name="ListenerRefusalError",this.stack=e}},Ife=0,MS=class{constructor(t){this.value=t}stack;id=Ife++},yfe=2,ree=(r,t)=>{if(r instanceof MS)t(r);else for(let e=0;e<r.length;e++){let i=r[e];i&&t(i)}},aA;if(bfe){let r=[];setInterval(()=>{r.length!==0&&(console.warn("[LEAKING LISTENERS] GC'ed these listeners that were NOT yet disposed:"),console.warn(r.join(`
`)),r.length=0)},3e3),aA=new FinalizationRegistry(t=>{typeof t=="string"&&r.push(t)})}var x=class{_options;_leakageMon;_perfMon;_disposed;_event;_listeners;_deliveryQueue;_size=0;constructor(t){this._options=t,this._leakageMon=oee>0||this._options?.leakWarningThreshold?new p4(t?.onListenerError??Xe,this._options?.leakWarningThreshold??oee):void 0,this._perfMon=this._options?._profName?new u4(this._options._profName):void 0,this._deliveryQueue=this._options?.deliveryQueue}dispose(){if(!this._disposed){if(this._disposed=!0,this._deliveryQueue?.current===this&&this._deliveryQueue.reset(),this._listeners){if(nee){let t=this._listeners;queueMicrotask(()=>{ree(t,e=>e.stack?.print())})}this._listeners=void 0,this._size=0}this._options?.onDidRemoveLastListener?.(),this._leakageMon?.dispose()}}get event(){return this._event??=(t,e,i)=>{if(this._leakageMon&&this._size>this._leakageMon.threshold**2){let l=`[${this._leakageMon.name}] REFUSES to accept new listeners because it exceeded its threshold by far (${this._size} vs ${this._leakageMon.threshold})`;console.warn(l);let d=this._leakageMon.getMostFrequentStack()??["UNKNOWN stack",-1],c=new m4(`${l}. HINT: Stack shows most frequent listener (${d[1]}-times)`,d[0]);return(this._options?.onListenerError||Xe)(c),R.None}if(this._disposed)return R.None;e&&(t=t.bind(e));let n=new MS(t),o,s;this._leakageMon&&this._size>=Math.ceil(this._leakageMon.threshold*.2)&&(n.stack=F_.create(),o=this._leakageMon.check(n.stack,this._size+1)),nee&&(n.stack=s??F_.create()),this._listeners?this._listeners instanceof MS?(this._deliveryQueue??=new lA,this._listeners=[this._listeners,n]):this._listeners.push(n):(this._options?.onWillAddFirstListener?.(this),this._listeners=n,this._options?.onDidAddFirstListener?.(this)),this._size++;let a=le(()=>{aA?.unregister(a),o?.(),this._removeListener(n)});if(i instanceof B?i.add(a):Array.isArray(i)&&i.push(a),aA){let l=new Error().stack.split(`
`).slice(2,3).join(`
`).trim(),d=/(file:|vscode-file:\/\/vscode-app)?(\/[^:]*:\d+:\d+)/.exec(l);aA.register(a,d?.[2]??l,a)}return a},this._event}_removeListener(t){if(this._options?.onWillRemoveListener?.(this),!this._listeners)return;if(this._size===1){this._listeners=void 0,this._options?.onDidRemoveLastListener?.(this),this._size=0;return}let e=this._listeners,i=e.indexOf(t);if(i===-1)throw console.log("disposed?",this._disposed),console.log("size?",this._size),console.log("arr?",JSON.stringify(this._listeners)),new Error("Attempted to dispose unknown listener");this._size--,e[i]=void 0;let n=this._deliveryQueue.current===this;if(this._size*yfe<=e.length){let o=0;for(let s=0;s<e.length;s++)e[s]?e[o++]=e[s]:n&&(this._deliveryQueue.end--,o<this._deliveryQueue.i&&this._deliveryQueue.i--);e.length=o}}_deliver(t,e){if(!t)return;let i=this._options?.onListenerError||Xe;if(!i){t.value(e);return}try{t.value(e)}catch(n){i(n)}}_deliverQueue(t){let e=t.current._listeners;for(;t.i<t.end;)this._deliver(e[t.i++],t.value);t.reset()}fire(t){if(this._deliveryQueue?.current&&(this._deliverQueue(this._deliveryQueue),this._perfMon?.stop()),this._perfMon?.start(this._size),this._listeners)if(this._listeners instanceof MS)this._deliver(this._listeners,t);else{let e=this._deliveryQueue;e.enqueue(this,t,this._listeners.length),this._deliverQueue(e)}this._perfMon?.stop()}hasListeners(){return this._size>0}},see=()=>new lA,lA=class{i=-1;end=0;current;value;enqueue(t,e,i){this.i=0,this.end=i,this.current=t,this.value=e}reset(){this.i=this.end,this.current=void 0,this.value=void 0}},AS=class extends x{_asyncDeliveryQueue;async fireAsync(t,e,i){if(this._listeners)for(this._asyncDeliveryQueue||(this._asyncDeliveryQueue=new lr),ree(this._listeners,n=>this._asyncDeliveryQueue.push([n.value,t]));this._asyncDeliveryQueue.size>0&&!e.isCancellationRequested;){let[n,o]=this._asyncDeliveryQueue.shift(),s=[],a={...o,token:e,waitUntil:l=>{if(Object.isFrozen(s))throw new Error("waitUntil can NOT be called asynchronous");i&&(l=i(l,n)),s.push(l)}};try{n(a)}catch(l){Xe(l);continue}Object.freeze(s),await Promise.allSettled(s).then(l=>{for(let d of l)d.status==="rejected"&&Xe(d.reason)})}}},hd=class extends x{_isPaused=0;_eventQueue=new lr;_mergeFn;get isPaused(){return this._isPaused!==0}constructor(t){super(t),this._mergeFn=t?.merge}pause(){this._isPaused++}resume(){if(this._isPaused!==0&&--this._isPaused===0)if(this._mergeFn){if(this._eventQueue.size>0){let t=Array.from(this._eventQueue);this._eventQueue.clear(),super.fire(this._mergeFn(t))}}else for(;!this._isPaused&&this._eventQueue.size!==0;)super.fire(this._eventQueue.shift())}fire(t){this._size&&(this._isPaused!==0?this._eventQueue.push(t):super.fire(t))}},dA=class extends hd{_delay;_handle;constructor(t){super(t),this._delay=t.delay??100}fire(t){this._handle||(this.pause(),this._handle=setTimeout(()=>{this._handle=void 0,this.resume()},this._delay)),super.fire(t)}},cA=class extends x{_queuedEvents=[];_mergeFn;constructor(t){super(t),this._mergeFn=t?.merge}fire(t){this.hasListeners()&&(this._queuedEvents.push(t),this._queuedEvents.length===1&&queueMicrotask(()=>{this._mergeFn?super.fire(this._mergeFn(this._queuedEvents)):this._queuedEvents.forEach(e=>super.fire(e)),this._queuedEvents=[]}))}},B_=class{emitter;hasListeners=!1;events=[];constructor(){this.emitter=new x({onWillAddFirstListener:()=>this.onFirstListenerAdd(),onDidRemoveLastListener:()=>this.onLastListenerRemove()})}get event(){return this.emitter.event}add(t){let e={event:t,listener:null};return this.events.push(e),this.hasListeners&&this.hook(e),le($a(()=>{this.hasListeners&&this.unhook(e);let n=this.events.indexOf(e);this.events.splice(n,1)}))}onFirstListenerAdd(){this.hasListeners=!0,this.events.forEach(t=>this.hook(t))}onLastListenerRemove(){this.hasListeners=!1,this.events.forEach(t=>this.unhook(t))}hook(t){t.listener=t.event(e=>this.emitter.fire(e))}unhook(t){t.listener?.dispose(),t.listener=null}dispose(){this.emitter.dispose();for(let t of this.events)t.listener?.dispose();this.events=[]}};var Xg=class{data=[];wrapEvent(t,e,i){return(n,o,s)=>t(a=>{let l=this.data[this.data.length-1];if(!e){l?l.buffers.push(()=>n.call(o,a)):n.call(o,a);return}let d=l;if(!d){n.call(o,e(i,a));return}d.items??=[],d.items.push(a),d.buffers.length===0&&l.buffers.push(()=>{d.reducedResult??=i?d.items.reduce(e,i):d.items.reduce(e),n.call(o,d.reducedResult)})},void 0,s)}bufferEvents(t){let e={buffers:new Array};this.data.push(e);let i=t();return this.data.pop(),e.buffers.forEach(n=>n()),i}},sc=class{listening=!1;inputEvent=X.None;inputEventListener=R.None;emitter=new x({onDidAddFirstListener:()=>{this.listening=!0,this.inputEventListener=this.inputEvent(this.emitter.fire,this.emitter)},onDidRemoveLastListener:()=>{this.listening=!1,this.inputEventListener.dispose()}});event=this.emitter.event;set input(t){this.inputEvent=t,this.listening&&(this.inputEventListener.dispose(),this.inputEventListener=t(this.emitter.fire,this.emitter))}dispose(){this.inputEventListener.dispose(),this.emitter.dispose()}};var aee=Object.freeze(function(r,t){let e=setTimeout(r.bind(t),0);return{dispose(){clearTimeout(e)}}}),Pt;(i=>{function r(n){return n===i.None||n===i.Cancelled||n instanceof OS?!0:!n||typeof n!="object"?!1:typeof n.isCancellationRequested=="boolean"&&typeof n.onCancellationRequested=="function"}i.isCancellationToken=r,i.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:X.None}),i.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:aee})})(Pt||={});var OS=class{_isCancelled=!1;_emitter=null;cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?aee:(this._emitter||(this._emitter=new x),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=null)}},Kt=class{_token=void 0;_parentListener=void 0;constructor(t){this._parentListener=t&&t.onCancellationRequested(this.cancel,this)}get token(){return this._token||(this._token=new OS),this._token}cancel(){this._token?this._token instanceof OS&&this._token.cancel():this._token=Pt.Cancelled}dispose(t=!1){t&&this.cancel(),this._parentListener?.dispose(),this._token?this._token instanceof OS&&this._token.dispose():this._token=Pt.None}};function lee(r){return r}var uA=class{lastCache=void 0;lastArgKey=void 0;_fn;_computeKey;constructor(t,e){typeof t=="function"?(this._fn=t,this._computeKey=lee):(this._fn=e,this._computeKey=t.getCacheKey)}get(t){let e=this._computeKey(t);return this.lastArgKey!==e&&(this.lastArgKey=e,this.lastCache=this._fn(t)),this.lastCache}},Yg=class{_map=new Map;_map2=new Map;get cachedValues(){return this._map}_fn;_computeKey;constructor(t,e){typeof t=="function"?(this._fn=t,this._computeKey=lee):(this._fn=e,this._computeKey=t.getCacheKey)}get(t){let e=this._computeKey(t);if(this._map2.has(e))return this._map2.get(e);let i=this._fn(t);return this._map.set(t,i),this._map2.set(e,i),i}};var qn=class{constructor(t){this.executor=t}_didRun=!1;_value;_error;get hasValue(){return this._didRun}get value(){if(!this._didRun)try{this._value=this.executor()}catch(t){this._error=t}finally{this._didRun=!0}if(this._error)throw this._error;return this._value}get rawValue(){return this._value}};function Hv(r){return r<0?0:r>255?255:r|0}function gd(r){return!r||typeof r!="string"?!0:r.trim().length===0}var Cfe=/{(\d+)}/g;function Sp(r,...t){return t.length===0?r:r.replace(Cfe,function(e,i){let n=parseInt(i,10);return isNaN(n)||n<0||n>=t.length?e:t[n]})}function cee(r){return r.replace(/[<>"'&]/g,t=>{switch(t){case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"'":return"&apos;";case"&":return"&amp;"}return t})}function Cp(r){return r.replace(/[<>&]/g,function(t){switch(t){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";default:return t}})}function ba(r){return r.replace(/[\\\{\}\*\+\?\|\^\$\.\[\]\(\)]/g,"\\$&")}function b4(r,t=" "){let e=wp(r,t);return Qg(e,t)}function wp(r,t){if(!r||!t)return r;let e=t.length;if(e===0||r.length===0)return r;let i=0;for(;r.indexOf(t,i)===i;)i=i+e;return r.substring(i)}function Qg(r,t){if(!r||!t)return r;let e=t.length,i=r.length;if(e===0||i===0)return r;let n=i,o=-1;for(;o=r.lastIndexOf(t,n-1),!(o===-1||o+e!==n);){if(o===0)return"";n=o}return r.substring(0,n)}function uee(r){return r.replace(/[\-\\\{\}\+\?\|\^\$\.\,\[\]\(\)\#\s]/g,"\\$&").replace(/[\*]/g,".*")}function pee(r){return r.replace(/\*/g,"")}function hA(r,t,e={}){if(!r)throw new Error("Cannot create regex from empty string");t||(r=ba(r)),e.wholeWord&&(/\B/.test(r.charAt(0))||(r="\\b"+r),/\B/.test(r.charAt(r.length-1))||(r=r+"\\b"));let i="";return e.global&&(i+="g"),e.matchCase||(i+="i"),e.multiline&&(i+="m"),e.unicode&&(i+="u"),new RegExp(r,i)}function hee(r){return r.source==="^"||r.source==="^$"||r.source==="$"||r.source==="^\\s*$"?!1:!!(r.exec("")&&r.lastIndex===0)}function Xc(r){return r.split(/\r\n|\r|\n/)}function mee(r){let t=[],e=r.split(/(\r\n|\r|\n)/);for(let i=0;i<Math.ceil(e.length/2);i++)t.push(e[2*i]+(e[2*i+1]??""));return t}function Jn(r){for(let t=0,e=r.length;t<e;t++){let i=r.charCodeAt(t);if(i!==32&&i!==9)return t}return-1}function yn(r,t=0,e=r.length){for(let i=t;i<e;i++){let n=r.charCodeAt(i);if(n!==32&&n!==9)return r.substring(t,i)}return r.substring(t,e)}function fd(r,t=r.length-1){for(let e=t;e>=0;e--){let i=r.charCodeAt(e);if(i!==32&&i!==9)return e}return-1}function Zg(r,t){return r<t?-1:r>t?1:0}function NS(r,t,e=0,i=r.length,n=0,o=t.length){for(;e<i&&n<o;e++,n++){let l=r.charCodeAt(e),d=t.charCodeAt(n);if(l<d)return-1;if(l>d)return 1}let s=i-e,a=o-n;return s<a?-1:s>a?1:0}function fm(r,t){return FS(r,t,0,r.length,0,t.length)}function FS(r,t,e=0,i=r.length,n=0,o=t.length){for(;e<i&&n<o;e++,n++){let l=r.charCodeAt(e),d=t.charCodeAt(n);if(l===d)continue;if(l>=128||d>=128)return NS(r.toLowerCase(),t.toLowerCase(),e,i,n,o);Uv(l)&&(l-=32),Uv(d)&&(d-=32);let c=l-d;if(c!==0)return c}let s=i-e,a=o-n;return s<a?-1:s>a?1:0}function V_(r){return r>=48&&r<=57}function Uv(r){return r>=97&&r<=122}function Ep(r){return r>=65&&r<=90}function dr(r,t){return r.length===t.length&&FS(r,t)===0}function bm(r,t){let e=t.length;return t.length>r.length?!1:FS(r,t,0,e)===0}function bd(r,t){let e=Math.min(r.length,t.length),i;for(i=0;i<e;i++)if(r.charCodeAt(i)!==t.charCodeAt(i))return i;return e}function Gv(r,t){let e=Math.min(r.length,t.length),i,n=r.length-1,o=t.length-1;for(i=0;i<e;i++)if(r.charCodeAt(n-i)!==t.charCodeAt(o-i))return i;return e}function Rn(r){return 55296<=r&&r<=56319}function xp(r){return 56320<=r&&r<=57343}function mA(r,t){return(r-55296<<10)+(t-56320)+65536}function BS(r,t,e){let i=r.charCodeAt(e);if(Rn(i)&&e+1<t){let n=r.charCodeAt(e+1);if(xp(n))return mA(i,n)}return i}function wfe(r,t){let e=r.charCodeAt(t-1);if(xp(e)&&t>1){let i=r.charCodeAt(t-2);if(Rn(i))return mA(i,e)}return e}var zv=class{_str;_len;_offset;get offset(){return this._offset}constructor(t,e=0){this._str=t,this._len=t.length,this._offset=e}setOffset(t){this._offset=t}prevCodePoint(){let t=wfe(this._str,this._offset);return this._offset-=t>=65536?2:1,t}nextCodePoint(){let t=BS(this._str,this._len,this._offset);return this._offset+=t>=65536?2:1,t}eol(){return this._offset>=this._len}},Kv=class{_iterator;get offset(){return this._iterator.offset}constructor(t,e=0){this._iterator=new zv(t,e)}nextGraphemeLength(){let t=pA.getInstance(),e=this._iterator,i=e.offset,n=t.getGraphemeBreakType(e.nextCodePoint());for(;!e.eol();){let o=e.offset,s=t.getGraphemeBreakType(e.nextCodePoint());if(dee(n,s)){e.setOffset(o);break}n=s}return e.offset-i}prevGraphemeLength(){let t=pA.getInstance(),e=this._iterator,i=e.offset,n=t.getGraphemeBreakType(e.prevCodePoint());for(;e.offset>0;){let o=e.offset,s=t.getGraphemeBreakType(e.prevCodePoint());if(dee(s,n)){e.setOffset(o);break}n=s}return i-e.offset}eol(){return this._iterator.eol()}};function W_(r,t){return new Kv(r,t).nextGraphemeLength()}function v4(r,t){return new Kv(r,t).prevGraphemeLength()}function gA(r,t){t>0&&xp(r.charCodeAt(t))&&t--;let e=t+W_(r,t);return[e-v4(r,e),e]}var g4;function Efe(){return/(?:[\u05BE\u05C0\u05C3\u05C6\u05D0-\u05F4\u0608\u060B\u060D\u061B-\u064A\u066D-\u066F\u0671-\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u0710\u0712-\u072F\u074D-\u07A5\u07B1-\u07EA\u07F4\u07F5\u07FA\u07FE-\u0815\u081A\u0824\u0828\u0830-\u0858\u085E-\u088E\u08A0-\u08C9\u200F\uFB1D\uFB1F-\uFB28\uFB2A-\uFD3D\uFD50-\uFDC7\uFDF0-\uFDFC\uFE70-\uFEFC]|\uD802[\uDC00-\uDD1B\uDD20-\uDE00\uDE10-\uDE35\uDE40-\uDEE4\uDEEB-\uDF35\uDF40-\uDFFF]|\uD803[\uDC00-\uDD23\uDE80-\uDEA9\uDEAD-\uDF45\uDF51-\uDF81\uDF86-\uDFF6]|\uD83A[\uDC00-\uDCCF\uDD00-\uDD43\uDD4B-\uDFFF]|\uD83B[\uDC00-\uDEBB])/}function vm(r){return g4||(g4=Efe()),g4.test(r)}var xfe=/^[\t\n\r\x20-\x7E]*$/;function H_(r){return xfe.test(r)}var I4=/[\u2028\u2029]/;function fA(r){return I4.test(r)}function vd(r){return r>=11904&&r<=55215||r>=63744&&r<=64255||r>=65281&&r<=65374}function U_(r){return r>=127462&&r<=127487||r===8986||r===8987||r===9200||r===9203||r>=9728&&r<=10175||r===11088||r===11093||r>=127744&&r<=128591||r>=128640&&r<=128764||r>=128992&&r<=129008||r>=129280&&r<=129535||r>=129648&&r<=129782}var Tfe=/(?:(?:\x1b\[|\x9B)[=?>!]?[\d;:]*["$#'* ]?[a-zA-Z@^`{}|~])|(:?\x1b\].*?\x07)/g;function gee(r){return r&&(r=r.replace(Tfe,"")),r}var fee=String.fromCharCode(65279);function bA(r){return!!(r&&r.length>0&&r.charCodeAt(0)===65279)}function vA(r){let t=26;return r=r%(2*t),r<t?String.fromCharCode(97+r):String.fromCharCode(65+r-t)}function dee(r,t){return r===0?t!==5&&t!==7:r===2&&t===3?!1:r===4||r===2||r===3||t===4||t===2||t===3?!0:!(r===8&&(t===8||t===9||t===11||t===12)||(r===11||r===9)&&(t===9||t===10)||(r===12||r===10)&&t===10||t===5||t===13||t===7||r===1||r===13&&t===14||r===6&&t===6)}var pA=class r{static _INSTANCE=null;static getInstance(){return r._INSTANCE||(r._INSTANCE=new r),r._INSTANCE}_data;constructor(){this._data=_fe()}getGraphemeBreakType(t){if(t<32)return t===10?3:t===13?2:4;if(t<127)return 0;let e=this._data,i=e.length/3,n=1;for(;n<=i;)if(t<e[3*n])n=2*n;else if(t>e[3*n+1])n=2*n+1;else return e[3*n+2];return 0}};function _fe(){return JSON.parse("[0,0,0,51229,51255,12,44061,44087,12,127462,127487,6,7083,7085,5,47645,47671,12,54813,54839,12,128678,128678,14,3270,3270,5,9919,9923,14,45853,45879,12,49437,49463,12,53021,53047,12,71216,71218,7,128398,128399,14,129360,129374,14,2519,2519,5,4448,4519,9,9742,9742,14,12336,12336,14,44957,44983,12,46749,46775,12,48541,48567,12,50333,50359,12,52125,52151,12,53917,53943,12,69888,69890,5,73018,73018,5,127990,127990,14,128558,128559,14,128759,128760,14,129653,129655,14,2027,2035,5,2891,2892,7,3761,3761,5,6683,6683,5,8293,8293,4,9825,9826,14,9999,9999,14,43452,43453,5,44509,44535,12,45405,45431,12,46301,46327,12,47197,47223,12,48093,48119,12,48989,49015,12,49885,49911,12,50781,50807,12,51677,51703,12,52573,52599,12,53469,53495,12,54365,54391,12,65279,65279,4,70471,70472,7,72145,72147,7,119173,119179,5,127799,127818,14,128240,128244,14,128512,128512,14,128652,128652,14,128721,128722,14,129292,129292,14,129445,129450,14,129734,129743,14,1476,1477,5,2366,2368,7,2750,2752,7,3076,3076,5,3415,3415,5,4141,4144,5,6109,6109,5,6964,6964,5,7394,7400,5,9197,9198,14,9770,9770,14,9877,9877,14,9968,9969,14,10084,10084,14,43052,43052,5,43713,43713,5,44285,44311,12,44733,44759,12,45181,45207,12,45629,45655,12,46077,46103,12,46525,46551,12,46973,46999,12,47421,47447,12,47869,47895,12,48317,48343,12,48765,48791,12,49213,49239,12,49661,49687,12,50109,50135,12,50557,50583,12,51005,51031,12,51453,51479,12,51901,51927,12,52349,52375,12,52797,52823,12,53245,53271,12,53693,53719,12,54141,54167,12,54589,54615,12,55037,55063,12,69506,69509,5,70191,70193,5,70841,70841,7,71463,71467,5,72330,72342,5,94031,94031,5,123628,123631,5,127763,127765,14,127941,127941,14,128043,128062,14,128302,128317,14,128465,128467,14,128539,128539,14,128640,128640,14,128662,128662,14,128703,128703,14,128745,128745,14,129004,129007,14,129329,129330,14,129402,129402,14,129483,129483,14,129686,129704,14,130048,131069,14,173,173,4,1757,1757,1,2200,2207,5,2434,2435,7,2631,2632,5,2817,2817,5,3008,3008,5,3201,3201,5,3387,3388,5,3542,3542,5,3902,3903,7,4190,4192,5,6002,6003,5,6439,6440,5,6765,6770,7,7019,7027,5,7154,7155,7,8205,8205,13,8505,8505,14,9654,9654,14,9757,9757,14,9792,9792,14,9852,9853,14,9890,9894,14,9937,9937,14,9981,9981,14,10035,10036,14,11035,11036,14,42654,42655,5,43346,43347,7,43587,43587,5,44006,44007,7,44173,44199,12,44397,44423,12,44621,44647,12,44845,44871,12,45069,45095,12,45293,45319,12,45517,45543,12,45741,45767,12,45965,45991,12,46189,46215,12,46413,46439,12,46637,46663,12,46861,46887,12,47085,47111,12,47309,47335,12,47533,47559,12,47757,47783,12,47981,48007,12,48205,48231,12,48429,48455,12,48653,48679,12,48877,48903,12,49101,49127,12,49325,49351,12,49549,49575,12,49773,49799,12,49997,50023,12,50221,50247,12,50445,50471,12,50669,50695,12,50893,50919,12,51117,51143,12,51341,51367,12,51565,51591,12,51789,51815,12,52013,52039,12,52237,52263,12,52461,52487,12,52685,52711,12,52909,52935,12,53133,53159,12,53357,53383,12,53581,53607,12,53805,53831,12,54029,54055,12,54253,54279,12,54477,54503,12,54701,54727,12,54925,54951,12,55149,55175,12,68101,68102,5,69762,69762,7,70067,70069,7,70371,70378,5,70720,70721,7,71087,71087,5,71341,71341,5,71995,71996,5,72249,72249,7,72850,72871,5,73109,73109,5,118576,118598,5,121505,121519,5,127245,127247,14,127568,127569,14,127777,127777,14,127872,127891,14,127956,127967,14,128015,128016,14,128110,128172,14,128259,128259,14,128367,128368,14,128424,128424,14,128488,128488,14,128530,128532,14,128550,128551,14,128566,128566,14,128647,128647,14,128656,128656,14,128667,128673,14,128691,128693,14,128715,128715,14,128728,128732,14,128752,128752,14,128765,128767,14,129096,129103,14,129311,129311,14,129344,129349,14,129394,129394,14,129413,129425,14,129466,129471,14,129511,129535,14,129664,129666,14,129719,129722,14,129760,129767,14,917536,917631,5,13,13,2,1160,1161,5,1564,1564,4,1807,1807,1,2085,2087,5,2307,2307,7,2382,2383,7,2497,2500,5,2563,2563,7,2677,2677,5,2763,2764,7,2879,2879,5,2914,2915,5,3021,3021,5,3142,3144,5,3263,3263,5,3285,3286,5,3398,3400,7,3530,3530,5,3633,3633,5,3864,3865,5,3974,3975,5,4155,4156,7,4229,4230,5,5909,5909,7,6078,6085,7,6277,6278,5,6451,6456,7,6744,6750,5,6846,6846,5,6972,6972,5,7074,7077,5,7146,7148,7,7222,7223,5,7416,7417,5,8234,8238,4,8417,8417,5,9000,9000,14,9203,9203,14,9730,9731,14,9748,9749,14,9762,9763,14,9776,9783,14,9800,9811,14,9831,9831,14,9872,9873,14,9882,9882,14,9900,9903,14,9929,9933,14,9941,9960,14,9974,9974,14,9989,9989,14,10006,10006,14,10062,10062,14,10160,10160,14,11647,11647,5,12953,12953,14,43019,43019,5,43232,43249,5,43443,43443,5,43567,43568,7,43696,43696,5,43765,43765,7,44013,44013,5,44117,44143,12,44229,44255,12,44341,44367,12,44453,44479,12,44565,44591,12,44677,44703,12,44789,44815,12,44901,44927,12,45013,45039,12,45125,45151,12,45237,45263,12,45349,45375,12,45461,45487,12,45573,45599,12,45685,45711,12,45797,45823,12,45909,45935,12,46021,46047,12,46133,46159,12,46245,46271,12,46357,46383,12,46469,46495,12,46581,46607,12,46693,46719,12,46805,46831,12,46917,46943,12,47029,47055,12,47141,47167,12,47253,47279,12,47365,47391,12,47477,47503,12,47589,47615,12,47701,47727,12,47813,47839,12,47925,47951,12,48037,48063,12,48149,48175,12,48261,48287,12,48373,48399,12,48485,48511,12,48597,48623,12,48709,48735,12,48821,48847,12,48933,48959,12,49045,49071,12,49157,49183,12,49269,49295,12,49381,49407,12,49493,49519,12,49605,49631,12,49717,49743,12,49829,49855,12,49941,49967,12,50053,50079,12,50165,50191,12,50277,50303,12,50389,50415,12,50501,50527,12,50613,50639,12,50725,50751,12,50837,50863,12,50949,50975,12,51061,51087,12,51173,51199,12,51285,51311,12,51397,51423,12,51509,51535,12,51621,51647,12,51733,51759,12,51845,51871,12,51957,51983,12,52069,52095,12,52181,52207,12,52293,52319,12,52405,52431,12,52517,52543,12,52629,52655,12,52741,52767,12,52853,52879,12,52965,52991,12,53077,53103,12,53189,53215,12,53301,53327,12,53413,53439,12,53525,53551,12,53637,53663,12,53749,53775,12,53861,53887,12,53973,53999,12,54085,54111,12,54197,54223,12,54309,54335,12,54421,54447,12,54533,54559,12,54645,54671,12,54757,54783,12,54869,54895,12,54981,55007,12,55093,55119,12,55243,55291,10,66045,66045,5,68325,68326,5,69688,69702,5,69817,69818,5,69957,69958,7,70089,70092,5,70198,70199,5,70462,70462,5,70502,70508,5,70750,70750,5,70846,70846,7,71100,71101,5,71230,71230,7,71351,71351,5,71737,71738,5,72000,72000,7,72160,72160,5,72273,72278,5,72752,72758,5,72882,72883,5,73031,73031,5,73461,73462,7,94192,94193,7,119149,119149,7,121403,121452,5,122915,122916,5,126980,126980,14,127358,127359,14,127535,127535,14,127759,127759,14,127771,127771,14,127792,127793,14,127825,127867,14,127897,127899,14,127945,127945,14,127985,127986,14,128000,128007,14,128021,128021,14,128066,128100,14,128184,128235,14,128249,128252,14,128266,128276,14,128335,128335,14,128379,128390,14,128407,128419,14,128444,128444,14,128481,128481,14,128499,128499,14,128526,128526,14,128536,128536,14,128543,128543,14,128556,128556,14,128564,128564,14,128577,128580,14,128643,128645,14,128649,128649,14,128654,128654,14,128660,128660,14,128664,128664,14,128675,128675,14,128686,128689,14,128695,128696,14,128705,128709,14,128717,128719,14,128725,128725,14,128736,128741,14,128747,128748,14,128755,128755,14,128762,128762,14,128981,128991,14,129009,129023,14,129160,129167,14,129296,129304,14,129320,129327,14,129340,129342,14,129356,129356,14,129388,129392,14,129399,129400,14,129404,129407,14,129432,129442,14,129454,129455,14,129473,129474,14,129485,129487,14,129648,129651,14,129659,129660,14,129671,129679,14,129709,129711,14,129728,129730,14,129751,129753,14,129776,129782,14,917505,917505,4,917760,917999,5,10,10,3,127,159,4,768,879,5,1471,1471,5,1536,1541,1,1648,1648,5,1767,1768,5,1840,1866,5,2070,2073,5,2137,2139,5,2274,2274,1,2363,2363,7,2377,2380,7,2402,2403,5,2494,2494,5,2507,2508,7,2558,2558,5,2622,2624,7,2641,2641,5,2691,2691,7,2759,2760,5,2786,2787,5,2876,2876,5,2881,2884,5,2901,2902,5,3006,3006,5,3014,3016,7,3072,3072,5,3134,3136,5,3157,3158,5,3260,3260,5,3266,3266,5,3274,3275,7,3328,3329,5,3391,3392,7,3405,3405,5,3457,3457,5,3536,3537,7,3551,3551,5,3636,3642,5,3764,3772,5,3895,3895,5,3967,3967,7,3993,4028,5,4146,4151,5,4182,4183,7,4226,4226,5,4253,4253,5,4957,4959,5,5940,5940,7,6070,6070,7,6087,6088,7,6158,6158,4,6432,6434,5,6448,6449,7,6679,6680,5,6742,6742,5,6754,6754,5,6783,6783,5,6912,6915,5,6966,6970,5,6978,6978,5,7042,7042,7,7080,7081,5,7143,7143,7,7150,7150,7,7212,7219,5,7380,7392,5,7412,7412,5,8203,8203,4,8232,8232,4,8265,8265,14,8400,8412,5,8421,8432,5,8617,8618,14,9167,9167,14,9200,9200,14,9410,9410,14,9723,9726,14,9733,9733,14,9745,9745,14,9752,9752,14,9760,9760,14,9766,9766,14,9774,9774,14,9786,9786,14,9794,9794,14,9823,9823,14,9828,9828,14,9833,9850,14,9855,9855,14,9875,9875,14,9880,9880,14,9885,9887,14,9896,9897,14,9906,9916,14,9926,9927,14,9935,9935,14,9939,9939,14,9962,9962,14,9972,9972,14,9978,9978,14,9986,9986,14,9997,9997,14,10002,10002,14,10017,10017,14,10055,10055,14,10071,10071,14,10133,10135,14,10548,10549,14,11093,11093,14,12330,12333,5,12441,12442,5,42608,42610,5,43010,43010,5,43045,43046,5,43188,43203,7,43302,43309,5,43392,43394,5,43446,43449,5,43493,43493,5,43571,43572,7,43597,43597,7,43703,43704,5,43756,43757,5,44003,44004,7,44009,44010,7,44033,44059,12,44089,44115,12,44145,44171,12,44201,44227,12,44257,44283,12,44313,44339,12,44369,44395,12,44425,44451,12,44481,44507,12,44537,44563,12,44593,44619,12,44649,44675,12,44705,44731,12,44761,44787,12,44817,44843,12,44873,44899,12,44929,44955,12,44985,45011,12,45041,45067,12,45097,45123,12,45153,45179,12,45209,45235,12,45265,45291,12,45321,45347,12,45377,45403,12,45433,45459,12,45489,45515,12,45545,45571,12,45601,45627,12,45657,45683,12,45713,45739,12,45769,45795,12,45825,45851,12,45881,45907,12,45937,45963,12,45993,46019,12,46049,46075,12,46105,46131,12,46161,46187,12,46217,46243,12,46273,46299,12,46329,46355,12,46385,46411,12,46441,46467,12,46497,46523,12,46553,46579,12,46609,46635,12,46665,46691,12,46721,46747,12,46777,46803,12,46833,46859,12,46889,46915,12,46945,46971,12,47001,47027,12,47057,47083,12,47113,47139,12,47169,47195,12,47225,47251,12,47281,47307,12,47337,47363,12,47393,47419,12,47449,47475,12,47505,47531,12,47561,47587,12,47617,47643,12,47673,47699,12,47729,47755,12,47785,47811,12,47841,47867,12,47897,47923,12,47953,47979,12,48009,48035,12,48065,48091,12,48121,48147,12,48177,48203,12,48233,48259,12,48289,48315,12,48345,48371,12,48401,48427,12,48457,48483,12,48513,48539,12,48569,48595,12,48625,48651,12,48681,48707,12,48737,48763,12,48793,48819,12,48849,48875,12,48905,48931,12,48961,48987,12,49017,49043,12,49073,49099,12,49129,49155,12,49185,49211,12,49241,49267,12,49297,49323,12,49353,49379,12,49409,49435,12,49465,49491,12,49521,49547,12,49577,49603,12,49633,49659,12,49689,49715,12,49745,49771,12,49801,49827,12,49857,49883,12,49913,49939,12,49969,49995,12,50025,50051,12,50081,50107,12,50137,50163,12,50193,50219,12,50249,50275,12,50305,50331,12,50361,50387,12,50417,50443,12,50473,50499,12,50529,50555,12,50585,50611,12,50641,50667,12,50697,50723,12,50753,50779,12,50809,50835,12,50865,50891,12,50921,50947,12,50977,51003,12,51033,51059,12,51089,51115,12,51145,51171,12,51201,51227,12,51257,51283,12,51313,51339,12,51369,51395,12,51425,51451,12,51481,51507,12,51537,51563,12,51593,51619,12,51649,51675,12,51705,51731,12,51761,51787,12,51817,51843,12,51873,51899,12,51929,51955,12,51985,52011,12,52041,52067,12,52097,52123,12,52153,52179,12,52209,52235,12,52265,52291,12,52321,52347,12,52377,52403,12,52433,52459,12,52489,52515,12,52545,52571,12,52601,52627,12,52657,52683,12,52713,52739,12,52769,52795,12,52825,52851,12,52881,52907,12,52937,52963,12,52993,53019,12,53049,53075,12,53105,53131,12,53161,53187,12,53217,53243,12,53273,53299,12,53329,53355,12,53385,53411,12,53441,53467,12,53497,53523,12,53553,53579,12,53609,53635,12,53665,53691,12,53721,53747,12,53777,53803,12,53833,53859,12,53889,53915,12,53945,53971,12,54001,54027,12,54057,54083,12,54113,54139,12,54169,54195,12,54225,54251,12,54281,54307,12,54337,54363,12,54393,54419,12,54449,54475,12,54505,54531,12,54561,54587,12,54617,54643,12,54673,54699,12,54729,54755,12,54785,54811,12,54841,54867,12,54897,54923,12,54953,54979,12,55009,55035,12,55065,55091,12,55121,55147,12,55177,55203,12,65024,65039,5,65520,65528,4,66422,66426,5,68152,68154,5,69291,69292,5,69633,69633,5,69747,69748,5,69811,69814,5,69826,69826,5,69932,69932,7,70016,70017,5,70079,70080,7,70095,70095,5,70196,70196,5,70367,70367,5,70402,70403,7,70464,70464,5,70487,70487,5,70709,70711,7,70725,70725,7,70833,70834,7,70843,70844,7,70849,70849,7,71090,71093,5,71103,71104,5,71227,71228,7,71339,71339,5,71344,71349,5,71458,71461,5,71727,71735,5,71985,71989,7,71998,71998,5,72002,72002,7,72154,72155,5,72193,72202,5,72251,72254,5,72281,72283,5,72344,72345,5,72766,72766,7,72874,72880,5,72885,72886,5,73023,73029,5,73104,73105,5,73111,73111,5,92912,92916,5,94095,94098,5,113824,113827,4,119142,119142,7,119155,119162,4,119362,119364,5,121476,121476,5,122888,122904,5,123184,123190,5,125252,125258,5,127183,127183,14,127340,127343,14,127377,127386,14,127491,127503,14,127548,127551,14,127744,127756,14,127761,127761,14,127769,127769,14,127773,127774,14,127780,127788,14,127796,127797,14,127820,127823,14,127869,127869,14,127894,127895,14,127902,127903,14,127943,127943,14,127947,127950,14,127972,127972,14,127988,127988,14,127992,127994,14,128009,128011,14,128019,128019,14,128023,128041,14,128064,128064,14,128102,128107,14,128174,128181,14,128238,128238,14,128246,128247,14,128254,128254,14,128264,128264,14,128278,128299,14,128329,128330,14,128348,128359,14,128371,128377,14,128392,128393,14,128401,128404,14,128421,128421,14,128433,128434,14,128450,128452,14,128476,128478,14,128483,128483,14,128495,128495,14,128506,128506,14,128519,128520,14,128528,128528,14,128534,128534,14,128538,128538,14,128540,128542,14,128544,128549,14,128552,128555,14,128557,128557,14,128560,128563,14,128565,128565,14,128567,128576,14,128581,128591,14,128641,128642,14,128646,128646,14,128648,128648,14,128650,128651,14,128653,128653,14,128655,128655,14,128657,128659,14,128661,128661,14,128663,128663,14,128665,128666,14,128674,128674,14,128676,128677,14,128679,128685,14,128690,128690,14,128694,128694,14,128697,128702,14,128704,128704,14,128710,128714,14,128716,128716,14,128720,128720,14,128723,128724,14,128726,128727,14,128733,128735,14,128742,128744,14,128746,128746,14,128749,128751,14,128753,128754,14,128756,128758,14,128761,128761,14,128763,128764,14,128884,128895,14,128992,129003,14,129008,129008,14,129036,129039,14,129114,129119,14,129198,129279,14,129293,129295,14,129305,129310,14,129312,129319,14,129328,129328,14,129331,129338,14,129343,129343,14,129351,129355,14,129357,129359,14,129375,129387,14,129393,129393,14,129395,129398,14,129401,129401,14,129403,129403,14,129408,129412,14,129426,129431,14,129443,129444,14,129451,129453,14,129456,129465,14,129472,129472,14,129475,129482,14,129484,129484,14,129488,129510,14,129536,129647,14,129652,129652,14,129656,129658,14,129661,129663,14,129667,129670,14,129680,129685,14,129705,129708,14,129712,129718,14,129723,129727,14,129731,129733,14,129744,129750,14,129754,129759,14,129768,129775,14,129783,129791,14,917504,917504,4,917506,917535,4,917632,917759,4,918000,921599,4,0,9,4,11,12,4,14,31,4,169,169,14,174,174,14,1155,1159,5,1425,1469,5,1473,1474,5,1479,1479,5,1552,1562,5,1611,1631,5,1750,1756,5,1759,1764,5,1770,1773,5,1809,1809,5,1958,1968,5,2045,2045,5,2075,2083,5,2089,2093,5,2192,2193,1,2250,2273,5,2275,2306,5,2362,2362,5,2364,2364,5,2369,2376,5,2381,2381,5,2385,2391,5,2433,2433,5,2492,2492,5,2495,2496,7,2503,2504,7,2509,2509,5,2530,2531,5,2561,2562,5,2620,2620,5,2625,2626,5,2635,2637,5,2672,2673,5,2689,2690,5,2748,2748,5,2753,2757,5,2761,2761,7,2765,2765,5,2810,2815,5,2818,2819,7,2878,2878,5,2880,2880,7,2887,2888,7,2893,2893,5,2903,2903,5,2946,2946,5,3007,3007,7,3009,3010,7,3018,3020,7,3031,3031,5,3073,3075,7,3132,3132,5,3137,3140,7,3146,3149,5,3170,3171,5,3202,3203,7,3262,3262,7,3264,3265,7,3267,3268,7,3271,3272,7,3276,3277,5,3298,3299,5,3330,3331,7,3390,3390,5,3393,3396,5,3402,3404,7,3406,3406,1,3426,3427,5,3458,3459,7,3535,3535,5,3538,3540,5,3544,3550,7,3570,3571,7,3635,3635,7,3655,3662,5,3763,3763,7,3784,3789,5,3893,3893,5,3897,3897,5,3953,3966,5,3968,3972,5,3981,3991,5,4038,4038,5,4145,4145,7,4153,4154,5,4157,4158,5,4184,4185,5,4209,4212,5,4228,4228,7,4237,4237,5,4352,4447,8,4520,4607,10,5906,5908,5,5938,5939,5,5970,5971,5,6068,6069,5,6071,6077,5,6086,6086,5,6089,6099,5,6155,6157,5,6159,6159,5,6313,6313,5,6435,6438,7,6441,6443,7,6450,6450,5,6457,6459,5,6681,6682,7,6741,6741,7,6743,6743,7,6752,6752,5,6757,6764,5,6771,6780,5,6832,6845,5,6847,6862,5,6916,6916,7,6965,6965,5,6971,6971,7,6973,6977,7,6979,6980,7,7040,7041,5,7073,7073,7,7078,7079,7,7082,7082,7,7142,7142,5,7144,7145,5,7149,7149,5,7151,7153,5,7204,7211,7,7220,7221,7,7376,7378,5,7393,7393,7,7405,7405,5,7415,7415,7,7616,7679,5,8204,8204,5,8206,8207,4,8233,8233,4,8252,8252,14,8288,8292,4,8294,8303,4,8413,8416,5,8418,8420,5,8482,8482,14,8596,8601,14,8986,8987,14,9096,9096,14,9193,9196,14,9199,9199,14,9201,9202,14,9208,9210,14,9642,9643,14,9664,9664,14,9728,9729,14,9732,9732,14,9735,9741,14,9743,9744,14,9746,9746,14,9750,9751,14,9753,9756,14,9758,9759,14,9761,9761,14,9764,9765,14,9767,9769,14,9771,9773,14,9775,9775,14,9784,9785,14,9787,9791,14,9793,9793,14,9795,9799,14,9812,9822,14,9824,9824,14,9827,9827,14,9829,9830,14,9832,9832,14,9851,9851,14,9854,9854,14,9856,9861,14,9874,9874,14,9876,9876,14,9878,9879,14,9881,9881,14,9883,9884,14,9888,9889,14,9895,9895,14,9898,9899,14,9904,9905,14,9917,9918,14,9924,9925,14,9928,9928,14,9934,9934,14,9936,9936,14,9938,9938,14,9940,9940,14,9961,9961,14,9963,9967,14,9970,9971,14,9973,9973,14,9975,9977,14,9979,9980,14,9982,9985,14,9987,9988,14,9992,9996,14,9998,9998,14,10000,10001,14,10004,10004,14,10013,10013,14,10024,10024,14,10052,10052,14,10060,10060,14,10067,10069,14,10083,10083,14,10085,10087,14,10145,10145,14,10175,10175,14,11013,11015,14,11088,11088,14,11503,11505,5,11744,11775,5,12334,12335,5,12349,12349,14,12951,12951,14,42607,42607,5,42612,42621,5,42736,42737,5,43014,43014,5,43043,43044,7,43047,43047,7,43136,43137,7,43204,43205,5,43263,43263,5,43335,43345,5,43360,43388,8,43395,43395,7,43444,43445,7,43450,43451,7,43454,43456,7,43561,43566,5,43569,43570,5,43573,43574,5,43596,43596,5,43644,43644,5,43698,43700,5,43710,43711,5,43755,43755,7,43758,43759,7,43766,43766,5,44005,44005,5,44008,44008,5,44012,44012,7,44032,44032,11,44060,44060,11,44088,44088,11,44116,44116,11,44144,44144,11,44172,44172,11,44200,44200,11,44228,44228,11,44256,44256,11,44284,44284,11,44312,44312,11,44340,44340,11,44368,44368,11,44396,44396,11,44424,44424,11,44452,44452,11,44480,44480,11,44508,44508,11,44536,44536,11,44564,44564,11,44592,44592,11,44620,44620,11,44648,44648,11,44676,44676,11,44704,44704,11,44732,44732,11,44760,44760,11,44788,44788,11,44816,44816,11,44844,44844,11,44872,44872,11,44900,44900,11,44928,44928,11,44956,44956,11,44984,44984,11,45012,45012,11,45040,45040,11,45068,45068,11,45096,45096,11,45124,45124,11,45152,45152,11,45180,45180,11,45208,45208,11,45236,45236,11,45264,45264,11,45292,45292,11,45320,45320,11,45348,45348,11,45376,45376,11,45404,45404,11,45432,45432,11,45460,45460,11,45488,45488,11,45516,45516,11,45544,45544,11,45572,45572,11,45600,45600,11,45628,45628,11,45656,45656,11,45684,45684,11,45712,45712,11,45740,45740,11,45768,45768,11,45796,45796,11,45824,45824,11,45852,45852,11,45880,45880,11,45908,45908,11,45936,45936,11,45964,45964,11,45992,45992,11,46020,46020,11,46048,46048,11,46076,46076,11,46104,46104,11,46132,46132,11,46160,46160,11,46188,46188,11,46216,46216,11,46244,46244,11,46272,46272,11,46300,46300,11,46328,46328,11,46356,46356,11,46384,46384,11,46412,46412,11,46440,46440,11,46468,46468,11,46496,46496,11,46524,46524,11,46552,46552,11,46580,46580,11,46608,46608,11,46636,46636,11,46664,46664,11,46692,46692,11,46720,46720,11,46748,46748,11,46776,46776,11,46804,46804,11,46832,46832,11,46860,46860,11,46888,46888,11,46916,46916,11,46944,46944,11,46972,46972,11,47000,47000,11,47028,47028,11,47056,47056,11,47084,47084,11,47112,47112,11,47140,47140,11,47168,47168,11,47196,47196,11,47224,47224,11,47252,47252,11,47280,47280,11,47308,47308,11,47336,47336,11,47364,47364,11,47392,47392,11,47420,47420,11,47448,47448,11,47476,47476,11,47504,47504,11,47532,47532,11,47560,47560,11,47588,47588,11,47616,47616,11,47644,47644,11,47672,47672,11,47700,47700,11,47728,47728,11,47756,47756,11,47784,47784,11,47812,47812,11,47840,47840,11,47868,47868,11,47896,47896,11,47924,47924,11,47952,47952,11,47980,47980,11,48008,48008,11,48036,48036,11,48064,48064,11,48092,48092,11,48120,48120,11,48148,48148,11,48176,48176,11,48204,48204,11,48232,48232,11,48260,48260,11,48288,48288,11,48316,48316,11,48344,48344,11,48372,48372,11,48400,48400,11,48428,48428,11,48456,48456,11,48484,48484,11,48512,48512,11,48540,48540,11,48568,48568,11,48596,48596,11,48624,48624,11,48652,48652,11,48680,48680,11,48708,48708,11,48736,48736,11,48764,48764,11,48792,48792,11,48820,48820,11,48848,48848,11,48876,48876,11,48904,48904,11,48932,48932,11,48960,48960,11,48988,48988,11,49016,49016,11,49044,49044,11,49072,49072,11,49100,49100,11,49128,49128,11,49156,49156,11,49184,49184,11,49212,49212,11,49240,49240,11,49268,49268,11,49296,49296,11,49324,49324,11,49352,49352,11,49380,49380,11,49408,49408,11,49436,49436,11,49464,49464,11,49492,49492,11,49520,49520,11,49548,49548,11,49576,49576,11,49604,49604,11,49632,49632,11,49660,49660,11,49688,49688,11,49716,49716,11,49744,49744,11,49772,49772,11,49800,49800,11,49828,49828,11,49856,49856,11,49884,49884,11,49912,49912,11,49940,49940,11,49968,49968,11,49996,49996,11,50024,50024,11,50052,50052,11,50080,50080,11,50108,50108,11,50136,50136,11,50164,50164,11,50192,50192,11,50220,50220,11,50248,50248,11,50276,50276,11,50304,50304,11,50332,50332,11,50360,50360,11,50388,50388,11,50416,50416,11,50444,50444,11,50472,50472,11,50500,50500,11,50528,50528,11,50556,50556,11,50584,50584,11,50612,50612,11,50640,50640,11,50668,50668,11,50696,50696,11,50724,50724,11,50752,50752,11,50780,50780,11,50808,50808,11,50836,50836,11,50864,50864,11,50892,50892,11,50920,50920,11,50948,50948,11,50976,50976,11,51004,51004,11,51032,51032,11,51060,51060,11,51088,51088,11,51116,51116,11,51144,51144,11,51172,51172,11,51200,51200,11,51228,51228,11,51256,51256,11,51284,51284,11,51312,51312,11,51340,51340,11,51368,51368,11,51396,51396,11,51424,51424,11,51452,51452,11,51480,51480,11,51508,51508,11,51536,51536,11,51564,51564,11,51592,51592,11,51620,51620,11,51648,51648,11,51676,51676,11,51704,51704,11,51732,51732,11,51760,51760,11,51788,51788,11,51816,51816,11,51844,51844,11,51872,51872,11,51900,51900,11,51928,51928,11,51956,51956,11,51984,51984,11,52012,52012,11,52040,52040,11,52068,52068,11,52096,52096,11,52124,52124,11,52152,52152,11,52180,52180,11,52208,52208,11,52236,52236,11,52264,52264,11,52292,52292,11,52320,52320,11,52348,52348,11,52376,52376,11,52404,52404,11,52432,52432,11,52460,52460,11,52488,52488,11,52516,52516,11,52544,52544,11,52572,52572,11,52600,52600,11,52628,52628,11,52656,52656,11,52684,52684,11,52712,52712,11,52740,52740,11,52768,52768,11,52796,52796,11,52824,52824,11,52852,52852,11,52880,52880,11,52908,52908,11,52936,52936,11,52964,52964,11,52992,52992,11,53020,53020,11,53048,53048,11,53076,53076,11,53104,53104,11,53132,53132,11,53160,53160,11,53188,53188,11,53216,53216,11,53244,53244,11,53272,53272,11,53300,53300,11,53328,53328,11,53356,53356,11,53384,53384,11,53412,53412,11,53440,53440,11,53468,53468,11,53496,53496,11,53524,53524,11,53552,53552,11,53580,53580,11,53608,53608,11,53636,53636,11,53664,53664,11,53692,53692,11,53720,53720,11,53748,53748,11,53776,53776,11,53804,53804,11,53832,53832,11,53860,53860,11,53888,53888,11,53916,53916,11,53944,53944,11,53972,53972,11,54000,54000,11,54028,54028,11,54056,54056,11,54084,54084,11,54112,54112,11,54140,54140,11,54168,54168,11,54196,54196,11,54224,54224,11,54252,54252,11,54280,54280,11,54308,54308,11,54336,54336,11,54364,54364,11,54392,54392,11,54420,54420,11,54448,54448,11,54476,54476,11,54504,54504,11,54532,54532,11,54560,54560,11,54588,54588,11,54616,54616,11,54644,54644,11,54672,54672,11,54700,54700,11,54728,54728,11,54756,54756,11,54784,54784,11,54812,54812,11,54840,54840,11,54868,54868,11,54896,54896,11,54924,54924,11,54952,54952,11,54980,54980,11,55008,55008,11,55036,55036,11,55064,55064,11,55092,55092,11,55120,55120,11,55148,55148,11,55176,55176,11,55216,55238,9,64286,64286,5,65056,65071,5,65438,65439,5,65529,65531,4,66272,66272,5,68097,68099,5,68108,68111,5,68159,68159,5,68900,68903,5,69446,69456,5,69632,69632,7,69634,69634,7,69744,69744,5,69759,69761,5,69808,69810,7,69815,69816,7,69821,69821,1,69837,69837,1,69927,69931,5,69933,69940,5,70003,70003,5,70018,70018,7,70070,70078,5,70082,70083,1,70094,70094,7,70188,70190,7,70194,70195,7,70197,70197,7,70206,70206,5,70368,70370,7,70400,70401,5,70459,70460,5,70463,70463,7,70465,70468,7,70475,70477,7,70498,70499,7,70512,70516,5,70712,70719,5,70722,70724,5,70726,70726,5,70832,70832,5,70835,70840,5,70842,70842,5,70845,70845,5,70847,70848,5,70850,70851,5,71088,71089,7,71096,71099,7,71102,71102,7,71132,71133,5,71219,71226,5,71229,71229,5,71231,71232,5,71340,71340,7,71342,71343,7,71350,71350,7,71453,71455,5,71462,71462,7,71724,71726,7,71736,71736,7,71984,71984,5,71991,71992,7,71997,71997,7,71999,71999,1,72001,72001,1,72003,72003,5,72148,72151,5,72156,72159,7,72164,72164,7,72243,72248,5,72250,72250,1,72263,72263,5,72279,72280,7,72324,72329,1,72343,72343,7,72751,72751,7,72760,72765,5,72767,72767,5,72873,72873,7,72881,72881,7,72884,72884,7,73009,73014,5,73020,73021,5,73030,73030,1,73098,73102,7,73107,73108,7,73110,73110,7,73459,73460,5,78896,78904,4,92976,92982,5,94033,94087,7,94180,94180,5,113821,113822,5,118528,118573,5,119141,119141,5,119143,119145,5,119150,119154,5,119163,119170,5,119210,119213,5,121344,121398,5,121461,121461,5,121499,121503,5,122880,122886,5,122907,122913,5,122918,122922,5,123566,123566,5,125136,125142,5,126976,126979,14,126981,127182,14,127184,127231,14,127279,127279,14,127344,127345,14,127374,127374,14,127405,127461,14,127489,127490,14,127514,127514,14,127538,127546,14,127561,127567,14,127570,127743,14,127757,127758,14,127760,127760,14,127762,127762,14,127766,127768,14,127770,127770,14,127772,127772,14,127775,127776,14,127778,127779,14,127789,127791,14,127794,127795,14,127798,127798,14,127819,127819,14,127824,127824,14,127868,127868,14,127870,127871,14,127892,127893,14,127896,127896,14,127900,127901,14,127904,127940,14,127942,127942,14,127944,127944,14,127946,127946,14,127951,127955,14,127968,127971,14,127973,127984,14,127987,127987,14,127989,127989,14,127991,127991,14,127995,127999,5,128008,128008,14,128012,128014,14,128017,128018,14,128020,128020,14,128022,128022,14,128042,128042,14,128063,128063,14,128065,128065,14,128101,128101,14,128108,128109,14,128173,128173,14,128182,128183,14,128236,128237,14,128239,128239,14,128245,128245,14,128248,128248,14,128253,128253,14,128255,128258,14,128260,128263,14,128265,128265,14,128277,128277,14,128300,128301,14,128326,128328,14,128331,128334,14,128336,128347,14,128360,128366,14,128369,128370,14,128378,128378,14,128391,128391,14,128394,128397,14,128400,128400,14,128405,128406,14,128420,128420,14,128422,128423,14,128425,128432,14,128435,128443,14,128445,128449,14,128453,128464,14,128468,128475,14,128479,128480,14,128482,128482,14,128484,128487,14,128489,128494,14,128496,128498,14,128500,128505,14,128507,128511,14,128513,128518,14,128521,128525,14,128527,128527,14,128529,128529,14,128533,128533,14,128535,128535,14,128537,128537,14]")}function bee(r,t){if(r===0)return 0;let e=Dfe(r,t);if(e!==void 0)return e;let i=new zv(t,r);return i.prevCodePoint(),i.offset}function Dfe(r,t){let e=new zv(t,r),i=e.prevCodePoint();for(;kfe(i)||i===65039||i===8419;){if(e.offset===0)return;i=e.prevCodePoint()}if(!U_(i))return;let n=e.offset;return n>0&&e.prevCodePoint()===8205&&(n=e.offset),n}function kfe(r){return 127995<=r&&r<=127999}var Jg="\xA0",f4=class r{constructor(t){this.confusableDictionary=t}static ambiguousCharacterData=new qn(()=>JSON.parse('{"_common":[8232,32,8233,32,5760,32,8192,32,8193,32,8194,32,8195,32,8196,32,8197,32,8198,32,8200,32,8201,32,8202,32,8287,32,8199,32,8239,32,2042,95,65101,95,65102,95,65103,95,8208,45,8209,45,8210,45,65112,45,1748,45,8259,45,727,45,8722,45,10134,45,11450,45,1549,44,1643,44,8218,44,184,44,42233,44,894,59,2307,58,2691,58,1417,58,1795,58,1796,58,5868,58,65072,58,6147,58,6153,58,8282,58,1475,58,760,58,42889,58,8758,58,720,58,42237,58,451,33,11601,33,660,63,577,63,2429,63,5038,63,42731,63,119149,46,8228,46,1793,46,1794,46,42510,46,68176,46,1632,46,1776,46,42232,46,1373,96,65287,96,8219,96,8242,96,1370,96,1523,96,8175,96,65344,96,900,96,8189,96,8125,96,8127,96,8190,96,697,96,884,96,712,96,714,96,715,96,756,96,699,96,701,96,700,96,702,96,42892,96,1497,96,2036,96,2037,96,5194,96,5836,96,94033,96,94034,96,65339,91,10088,40,10098,40,12308,40,64830,40,65341,93,10089,41,10099,41,12309,41,64831,41,10100,123,119060,123,10101,125,65342,94,8270,42,1645,42,8727,42,66335,42,5941,47,8257,47,8725,47,8260,47,9585,47,10187,47,10744,47,119354,47,12755,47,12339,47,11462,47,20031,47,12035,47,65340,92,65128,92,8726,92,10189,92,10741,92,10745,92,119311,92,119355,92,12756,92,20022,92,12034,92,42872,38,708,94,710,94,5869,43,10133,43,66203,43,8249,60,10094,60,706,60,119350,60,5176,60,5810,60,5120,61,11840,61,12448,61,42239,61,8250,62,10095,62,707,62,119351,62,5171,62,94015,62,8275,126,732,126,8128,126,8764,126,65372,124,65293,45,120784,50,120794,50,120804,50,120814,50,120824,50,130034,50,42842,50,423,50,1000,50,42564,50,5311,50,42735,50,119302,51,120785,51,120795,51,120805,51,120815,51,120825,51,130035,51,42923,51,540,51,439,51,42858,51,11468,51,1248,51,94011,51,71882,51,120786,52,120796,52,120806,52,120816,52,120826,52,130036,52,5070,52,71855,52,120787,53,120797,53,120807,53,120817,53,120827,53,130037,53,444,53,71867,53,120788,54,120798,54,120808,54,120818,54,120828,54,130038,54,11474,54,5102,54,71893,54,119314,55,120789,55,120799,55,120809,55,120819,55,120829,55,130039,55,66770,55,71878,55,2819,56,2538,56,2666,56,125131,56,120790,56,120800,56,120810,56,120820,56,120830,56,130040,56,547,56,546,56,66330,56,2663,57,2920,57,2541,57,3437,57,120791,57,120801,57,120811,57,120821,57,120831,57,130041,57,42862,57,11466,57,71884,57,71852,57,71894,57,9082,97,65345,97,119834,97,119886,97,119938,97,119990,97,120042,97,120094,97,120146,97,120198,97,120250,97,120302,97,120354,97,120406,97,120458,97,593,97,945,97,120514,97,120572,97,120630,97,120688,97,120746,97,65313,65,119808,65,119860,65,119912,65,119964,65,120016,65,120068,65,120120,65,120172,65,120224,65,120276,65,120328,65,120380,65,120432,65,913,65,120488,65,120546,65,120604,65,120662,65,120720,65,5034,65,5573,65,42222,65,94016,65,66208,65,119835,98,119887,98,119939,98,119991,98,120043,98,120095,98,120147,98,120199,98,120251,98,120303,98,120355,98,120407,98,120459,98,388,98,5071,98,5234,98,5551,98,65314,66,8492,66,119809,66,119861,66,119913,66,120017,66,120069,66,120121,66,120173,66,120225,66,120277,66,120329,66,120381,66,120433,66,42932,66,914,66,120489,66,120547,66,120605,66,120663,66,120721,66,5108,66,5623,66,42192,66,66178,66,66209,66,66305,66,65347,99,8573,99,119836,99,119888,99,119940,99,119992,99,120044,99,120096,99,120148,99,120200,99,120252,99,120304,99,120356,99,120408,99,120460,99,7428,99,1010,99,11429,99,43951,99,66621,99,128844,67,71922,67,71913,67,65315,67,8557,67,8450,67,8493,67,119810,67,119862,67,119914,67,119966,67,120018,67,120174,67,120226,67,120278,67,120330,67,120382,67,120434,67,1017,67,11428,67,5087,67,42202,67,66210,67,66306,67,66581,67,66844,67,8574,100,8518,100,119837,100,119889,100,119941,100,119993,100,120045,100,120097,100,120149,100,120201,100,120253,100,120305,100,120357,100,120409,100,120461,100,1281,100,5095,100,5231,100,42194,100,8558,68,8517,68,119811,68,119863,68,119915,68,119967,68,120019,68,120071,68,120123,68,120175,68,120227,68,120279,68,120331,68,120383,68,120435,68,5024,68,5598,68,5610,68,42195,68,8494,101,65349,101,8495,101,8519,101,119838,101,119890,101,119942,101,120046,101,120098,101,120150,101,120202,101,120254,101,120306,101,120358,101,120410,101,120462,101,43826,101,1213,101,8959,69,65317,69,8496,69,119812,69,119864,69,119916,69,120020,69,120072,69,120124,69,120176,69,120228,69,120280,69,120332,69,120384,69,120436,69,917,69,120492,69,120550,69,120608,69,120666,69,120724,69,11577,69,5036,69,42224,69,71846,69,71854,69,66182,69,119839,102,119891,102,119943,102,119995,102,120047,102,120099,102,120151,102,120203,102,120255,102,120307,102,120359,102,120411,102,120463,102,43829,102,42905,102,383,102,7837,102,1412,102,119315,70,8497,70,119813,70,119865,70,119917,70,120021,70,120073,70,120125,70,120177,70,120229,70,120281,70,120333,70,120385,70,120437,70,42904,70,988,70,120778,70,5556,70,42205,70,71874,70,71842,70,66183,70,66213,70,66853,70,65351,103,8458,103,119840,103,119892,103,119944,103,120048,103,120100,103,120152,103,120204,103,120256,103,120308,103,120360,103,120412,103,120464,103,609,103,7555,103,397,103,1409,103,119814,71,119866,71,119918,71,119970,71,120022,71,120074,71,120126,71,120178,71,120230,71,120282,71,120334,71,120386,71,120438,71,1292,71,5056,71,5107,71,42198,71,65352,104,8462,104,119841,104,119945,104,119997,104,120049,104,120101,104,120153,104,120205,104,120257,104,120309,104,120361,104,120413,104,120465,104,1211,104,1392,104,5058,104,65320,72,8459,72,8460,72,8461,72,119815,72,119867,72,119919,72,120023,72,120179,72,120231,72,120283,72,120335,72,120387,72,120439,72,919,72,120494,72,120552,72,120610,72,120668,72,120726,72,11406,72,5051,72,5500,72,42215,72,66255,72,731,105,9075,105,65353,105,8560,105,8505,105,8520,105,119842,105,119894,105,119946,105,119998,105,120050,105,120102,105,120154,105,120206,105,120258,105,120310,105,120362,105,120414,105,120466,105,120484,105,618,105,617,105,953,105,8126,105,890,105,120522,105,120580,105,120638,105,120696,105,120754,105,1110,105,42567,105,1231,105,43893,105,5029,105,71875,105,65354,106,8521,106,119843,106,119895,106,119947,106,119999,106,120051,106,120103,106,120155,106,120207,106,120259,106,120311,106,120363,106,120415,106,120467,106,1011,106,1112,106,65322,74,119817,74,119869,74,119921,74,119973,74,120025,74,120077,74,120129,74,120181,74,120233,74,120285,74,120337,74,120389,74,120441,74,42930,74,895,74,1032,74,5035,74,5261,74,42201,74,119844,107,119896,107,119948,107,120000,107,120052,107,120104,107,120156,107,120208,107,120260,107,120312,107,120364,107,120416,107,120468,107,8490,75,65323,75,119818,75,119870,75,119922,75,119974,75,120026,75,120078,75,120130,75,120182,75,120234,75,120286,75,120338,75,120390,75,120442,75,922,75,120497,75,120555,75,120613,75,120671,75,120729,75,11412,75,5094,75,5845,75,42199,75,66840,75,1472,108,8739,73,9213,73,65512,73,1633,108,1777,73,66336,108,125127,108,120783,73,120793,73,120803,73,120813,73,120823,73,130033,73,65321,73,8544,73,8464,73,8465,73,119816,73,119868,73,119920,73,120024,73,120128,73,120180,73,120232,73,120284,73,120336,73,120388,73,120440,73,65356,108,8572,73,8467,108,119845,108,119897,108,119949,108,120001,108,120053,108,120105,73,120157,73,120209,73,120261,73,120313,73,120365,73,120417,73,120469,73,448,73,120496,73,120554,73,120612,73,120670,73,120728,73,11410,73,1030,73,1216,73,1493,108,1503,108,1575,108,126464,108,126592,108,65166,108,65165,108,1994,108,11599,73,5825,73,42226,73,93992,73,66186,124,66313,124,119338,76,8556,76,8466,76,119819,76,119871,76,119923,76,120027,76,120079,76,120131,76,120183,76,120235,76,120287,76,120339,76,120391,76,120443,76,11472,76,5086,76,5290,76,42209,76,93974,76,71843,76,71858,76,66587,76,66854,76,65325,77,8559,77,8499,77,119820,77,119872,77,119924,77,120028,77,120080,77,120132,77,120184,77,120236,77,120288,77,120340,77,120392,77,120444,77,924,77,120499,77,120557,77,120615,77,120673,77,120731,77,1018,77,11416,77,5047,77,5616,77,5846,77,42207,77,66224,77,66321,77,119847,110,119899,110,119951,110,120003,110,120055,110,120107,110,120159,110,120211,110,120263,110,120315,110,120367,110,120419,110,120471,110,1400,110,1404,110,65326,78,8469,78,119821,78,119873,78,119925,78,119977,78,120029,78,120081,78,120185,78,120237,78,120289,78,120341,78,120393,78,120445,78,925,78,120500,78,120558,78,120616,78,120674,78,120732,78,11418,78,42208,78,66835,78,3074,111,3202,111,3330,111,3458,111,2406,111,2662,111,2790,111,3046,111,3174,111,3302,111,3430,111,3664,111,3792,111,4160,111,1637,111,1781,111,65359,111,8500,111,119848,111,119900,111,119952,111,120056,111,120108,111,120160,111,120212,111,120264,111,120316,111,120368,111,120420,111,120472,111,7439,111,7441,111,43837,111,959,111,120528,111,120586,111,120644,111,120702,111,120760,111,963,111,120532,111,120590,111,120648,111,120706,111,120764,111,11423,111,4351,111,1413,111,1505,111,1607,111,126500,111,126564,111,126596,111,65259,111,65260,111,65258,111,65257,111,1726,111,64428,111,64429,111,64427,111,64426,111,1729,111,64424,111,64425,111,64423,111,64422,111,1749,111,3360,111,4125,111,66794,111,71880,111,71895,111,66604,111,1984,79,2534,79,2918,79,12295,79,70864,79,71904,79,120782,79,120792,79,120802,79,120812,79,120822,79,130032,79,65327,79,119822,79,119874,79,119926,79,119978,79,120030,79,120082,79,120134,79,120186,79,120238,79,120290,79,120342,79,120394,79,120446,79,927,79,120502,79,120560,79,120618,79,120676,79,120734,79,11422,79,1365,79,11604,79,4816,79,2848,79,66754,79,42227,79,71861,79,66194,79,66219,79,66564,79,66838,79,9076,112,65360,112,119849,112,119901,112,119953,112,120005,112,120057,112,120109,112,120161,112,120213,112,120265,112,120317,112,120369,112,120421,112,120473,112,961,112,120530,112,120544,112,120588,112,120602,112,120646,112,120660,112,120704,112,120718,112,120762,112,120776,112,11427,112,65328,80,8473,80,119823,80,119875,80,119927,80,119979,80,120031,80,120083,80,120187,80,120239,80,120291,80,120343,80,120395,80,120447,80,929,80,120504,80,120562,80,120620,80,120678,80,120736,80,11426,80,5090,80,5229,80,42193,80,66197,80,119850,113,119902,113,119954,113,120006,113,120058,113,120110,113,120162,113,120214,113,120266,113,120318,113,120370,113,120422,113,120474,113,1307,113,1379,113,1382,113,8474,81,119824,81,119876,81,119928,81,119980,81,120032,81,120084,81,120188,81,120240,81,120292,81,120344,81,120396,81,120448,81,11605,81,119851,114,119903,114,119955,114,120007,114,120059,114,120111,114,120163,114,120215,114,120267,114,120319,114,120371,114,120423,114,120475,114,43847,114,43848,114,7462,114,11397,114,43905,114,119318,82,8475,82,8476,82,8477,82,119825,82,119877,82,119929,82,120033,82,120189,82,120241,82,120293,82,120345,82,120397,82,120449,82,422,82,5025,82,5074,82,66740,82,5511,82,42211,82,94005,82,65363,115,119852,115,119904,115,119956,115,120008,115,120060,115,120112,115,120164,115,120216,115,120268,115,120320,115,120372,115,120424,115,120476,115,42801,115,445,115,1109,115,43946,115,71873,115,66632,115,65331,83,119826,83,119878,83,119930,83,119982,83,120034,83,120086,83,120138,83,120190,83,120242,83,120294,83,120346,83,120398,83,120450,83,1029,83,1359,83,5077,83,5082,83,42210,83,94010,83,66198,83,66592,83,119853,116,119905,116,119957,116,120009,116,120061,116,120113,116,120165,116,120217,116,120269,116,120321,116,120373,116,120425,116,120477,116,8868,84,10201,84,128872,84,65332,84,119827,84,119879,84,119931,84,119983,84,120035,84,120087,84,120139,84,120191,84,120243,84,120295,84,120347,84,120399,84,120451,84,932,84,120507,84,120565,84,120623,84,120681,84,120739,84,11430,84,5026,84,42196,84,93962,84,71868,84,66199,84,66225,84,66325,84,119854,117,119906,117,119958,117,120010,117,120062,117,120114,117,120166,117,120218,117,120270,117,120322,117,120374,117,120426,117,120478,117,42911,117,7452,117,43854,117,43858,117,651,117,965,117,120534,117,120592,117,120650,117,120708,117,120766,117,1405,117,66806,117,71896,117,8746,85,8899,85,119828,85,119880,85,119932,85,119984,85,120036,85,120088,85,120140,85,120192,85,120244,85,120296,85,120348,85,120400,85,120452,85,1357,85,4608,85,66766,85,5196,85,42228,85,94018,85,71864,85,8744,118,8897,118,65366,118,8564,118,119855,118,119907,118,119959,118,120011,118,120063,118,120115,118,120167,118,120219,118,120271,118,120323,118,120375,118,120427,118,120479,118,7456,118,957,118,120526,118,120584,118,120642,118,120700,118,120758,118,1141,118,1496,118,71430,118,43945,118,71872,118,119309,86,1639,86,1783,86,8548,86,119829,86,119881,86,119933,86,119985,86,120037,86,120089,86,120141,86,120193,86,120245,86,120297,86,120349,86,120401,86,120453,86,1140,86,11576,86,5081,86,5167,86,42719,86,42214,86,93960,86,71840,86,66845,86,623,119,119856,119,119908,119,119960,119,120012,119,120064,119,120116,119,120168,119,120220,119,120272,119,120324,119,120376,119,120428,119,120480,119,7457,119,1121,119,1309,119,1377,119,71434,119,71438,119,71439,119,43907,119,71919,87,71910,87,119830,87,119882,87,119934,87,119986,87,120038,87,120090,87,120142,87,120194,87,120246,87,120298,87,120350,87,120402,87,120454,87,1308,87,5043,87,5076,87,42218,87,5742,120,10539,120,10540,120,10799,120,65368,120,8569,120,119857,120,119909,120,119961,120,120013,120,120065,120,120117,120,120169,120,120221,120,120273,120,120325,120,120377,120,120429,120,120481,120,5441,120,5501,120,5741,88,9587,88,66338,88,71916,88,65336,88,8553,88,119831,88,119883,88,119935,88,119987,88,120039,88,120091,88,120143,88,120195,88,120247,88,120299,88,120351,88,120403,88,120455,88,42931,88,935,88,120510,88,120568,88,120626,88,120684,88,120742,88,11436,88,11613,88,5815,88,42219,88,66192,88,66228,88,66327,88,66855,88,611,121,7564,121,65369,121,119858,121,119910,121,119962,121,120014,121,120066,121,120118,121,120170,121,120222,121,120274,121,120326,121,120378,121,120430,121,120482,121,655,121,7935,121,43866,121,947,121,8509,121,120516,121,120574,121,120632,121,120690,121,120748,121,1199,121,4327,121,71900,121,65337,89,119832,89,119884,89,119936,89,119988,89,120040,89,120092,89,120144,89,120196,89,120248,89,120300,89,120352,89,120404,89,120456,89,933,89,978,89,120508,89,120566,89,120624,89,120682,89,120740,89,11432,89,1198,89,5033,89,5053,89,42220,89,94019,89,71844,89,66226,89,119859,122,119911,122,119963,122,120015,122,120067,122,120119,122,120171,122,120223,122,120275,122,120327,122,120379,122,120431,122,120483,122,7458,122,43923,122,71876,122,66293,90,71909,90,65338,90,8484,90,8488,90,119833,90,119885,90,119937,90,119989,90,120041,90,120197,90,120249,90,120301,90,120353,90,120405,90,120457,90,918,90,120493,90,120551,90,120609,90,120667,90,120725,90,5059,90,42204,90,71849,90,65282,34,65284,36,65285,37,65286,38,65290,42,65291,43,65294,46,65295,47,65296,48,65297,49,65298,50,65299,51,65300,52,65301,53,65302,54,65303,55,65304,56,65305,57,65308,60,65309,61,65310,62,65312,64,65316,68,65318,70,65319,71,65324,76,65329,81,65330,82,65333,85,65334,86,65335,87,65343,95,65346,98,65348,100,65350,102,65355,107,65357,109,65358,110,65361,113,65362,114,65364,116,65365,117,65367,119,65370,122,65371,123,65373,125,119846,109],"_default":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"cs":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"de":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"es":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"fr":[65374,126,65306,58,65281,33,8216,96,8245,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"it":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ja":[8211,45,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65292,44,65307,59],"ko":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pl":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pt-BR":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"qps-ploc":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ru":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,305,105,921,73,1009,112,215,120,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"tr":[160,32,8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"zh-hans":[65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41],"zh-hant":[8211,45,65374,126,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65307,59]}'));static cache=new uA({getCacheKey:JSON.stringify},t=>{function e(c){let p=new Map;for(let h=0;h<c.length;h+=2)p.set(c[h],c[h+1]);return p}function i(c,p){let h=new Map(c);for(let[m,f]of p)h.set(m,f);return h}function n(c,p){if(!c)return p;let h=new Map;for(let[m,f]of c)p.has(m)&&h.set(m,f);return h}let o=this.ambiguousCharacterData.value,s=t.filter(c=>!c.startsWith("_")&&c in o);s.length===0&&(s=["_default"]);let a;for(let c of s){let p=e(o[c]);a=n(a,p)}let l=e(o._common),d=i(l,a);return new r(d)});static getInstance(t){return r.cache.get(Array.from(t))}static _locales=new qn(()=>Object.keys(r.ambiguousCharacterData.value).filter(t=>!t.startsWith("_")));static getLocales(){return r._locales.value}isAmbiguous(t){return this.confusableDictionary.has(t)}containsAmbiguousCharacter(t){for(let e=0;e<t.length;e++){let i=t.codePointAt(e);if(typeof i=="number"&&this.isAmbiguous(i))return!0}return!1}getPrimaryConfusable(t){return this.confusableDictionary.get(t)}getConfusableCodePoints(){return new Set(this.confusableDictionary.keys())}};var Ie;(at=>(at.inMemory="inmemory",at.vscode="vscode",at.internal="private",at.walkThrough="walkThrough",at.walkThroughSnippet="walkThroughSnippet",at.http="http",at.https="https",at.file="file",at.mailto="mailto",at.untitled="untitled",at.data="data",at.command="command",at.vscodeRemote="vscode-remote",at.vscodeRemoteResource="vscode-remote-resource",at.vscodeManagedRemoteResource="vscode-managed-remote-resource",at.vscodeUserData="vscode-userdata",at.vscodeCustomEditor="vscode-custom-editor",at.vscodeNotebookCell="vscode-notebook-cell",at.vscodeNotebookCellMetadata="vscode-notebook-cell-metadata",at.vscodeNotebookCellMetadataDiff="vscode-notebook-cell-metadata-diff",at.vscodeNotebookCellOutput="vscode-notebook-cell-output",at.vscodeNotebookCellOutputDiff="vscode-notebook-cell-output-diff",at.vscodeNotebookMetadata="vscode-notebook-metadata",at.vscodeInteractiveInput="vscode-interactive-input",at.vscodeSettings="vscode-settings",at.vscodeWorkspaceTrust="vscode-workspace-trust",at.vscodeTerminal="vscode-terminal",at.vscodeChatCodeBlock="vscode-chat-code-block",at.vscodeChatCodeCompareBlock="vscode-chat-code-compare-block",at.vscodeChatSesssion="vscode-chat-editor",at.webviewPanel="webview-panel",at.vscodeWebview="vscode-webview",at.extension="extension",at.vscodeFileResource="vscode-file",at.tmp="tmp",at.vsls="vsls",at.vscodeSourceControl="vscode-scm",at.commentsInput="comment",at.codeSetting="code-setting",at.outputChannel="output"))(Ie||={});function ef(r,t){return Z.isUri(r)?dr(r.scheme,t):bm(r,t+":")}function IA(r,...t){return t.some(e=>ef(r,e))}var Lfe="tkn",y4=class{_hosts=Object.create(null);_ports=Object.create(null);_connectionTokens=Object.create(null);_preferredWebSchema="http";_delegate=null;_serverRootPath="/";setPreferredWebSchema(t){this._preferredWebSchema=t}setDelegate(t){this._delegate=t}setServerRootPath(t,e){this._serverRootPath=Rfe(t,e)}getServerRootPath(){return this._serverRootPath}get _remoteResourcesPath(){return Xt.join(this._serverRootPath,Ie.vscodeRemoteResource)}set(t,e,i){this._hosts[t]=e,this._ports[t]=i}setConnectionToken(t,e){this._connectionTokens[t]=e}getPreferredWebSchema(){return this._preferredWebSchema}rewrite(t){if(this._delegate)try{return this._delegate(t)}catch(a){return Xe(a),t}let e=t.authority,i=this._hosts[e];i&&i.indexOf(":")!==-1&&i.indexOf("[")===-1&&(i=`[${i}]`);let n=this._ports[e],o=this._connectionTokens[e],s=`path=${encodeURIComponent(t.path)}`;return typeof o=="string"&&(s+=`&${Lfe}=${encodeURIComponent(o)}`),Z.from({scheme:si?this._preferredWebSchema:Ie.vscodeRemoteResource,authority:`${i}:${n}`,path:this._remoteResourcesPath,query:s})}},z_=new y4;function Rfe(r,t){return Xt.join(t??"/",`${r.quality??"oss"}-${r.commit??"dev"}`)}var C4="vscode-app",S4=class r{static FALLBACK_AUTHORITY=C4;asBrowserUri(t){let e=this.toUri(t);return this.uriToBrowserUri(e)}uriToBrowserUri(t){return t.scheme===Ie.vscodeRemote?z_.rewrite(t):t.scheme===Ie.file&&(Po||sJ===`${Ie.vscodeFileResource}://${r.FALLBACK_AUTHORITY}`)?t.with({scheme:Ie.vscodeFileResource,authority:t.authority||r.FALLBACK_AUTHORITY,query:null,fragment:null}):t}asFileUri(t){let e=this.toUri(t);return this.uriToFileUri(e)}uriToFileUri(t){return t.scheme===Ie.vscodeFileResource?t.with({scheme:Ie.file,authority:t.authority!==r.FALLBACK_AUTHORITY?t.authority:null,query:null,fragment:null}):t}toUri(t,e){if(Z.isUri(t))return t;if(globalThis._VSCODE_FILE_ROOT){let i=globalThis._VSCODE_FILE_ROOT;if(/^\w[\w\d+.-]*:\/\//.test(i))return Z.joinPath(Z.parse(i,!0),t);let n=cs(i,t);return Z.file(n)}return Z.parse(e.toUrl(t))}},Ao=new S4,Pfe;(o=>{let r=new Map([["1",{"Cross-Origin-Opener-Policy":"same-origin"}],["2",{"Cross-Origin-Embedder-Policy":"require-corp"}],["3",{"Cross-Origin-Opener-Policy":"same-origin","Cross-Origin-Embedder-Policy":"require-corp"}]]);o.CoopAndCoep=Object.freeze(r.get("3"));let e="vscode-coi";function i(s){let a;typeof s=="string"?a=new URL(s).searchParams:s instanceof URL?a=s.searchParams:Z.isUri(s)&&(a=new URL(s.toString(!0)).searchParams);let l=a?.get(e);if(l)return r.get(l)}o.getHeadersFromQuery=i;function n(s,a,l){if(!globalThis.crossOriginIsolated)return;let d=a&&l?"3":l?"2":"1";s instanceof URLSearchParams?s.set(e,d):s[e]=d}o.addSearchParam=n})(Pfe||={});function yA(r,t){let e=r;typeof e.vscodeWindowId!="number"&&Object.defineProperty(e,"vscodeWindowId",{get:()=>t})}var Ke=window;function w4(r){return r===Ke?!1:typeof r?.vscodeWindowId=="number"}var tf=class r{static INSTANCE=new r;mapWindowIdToZoomLevel=new Map;_onDidChangeZoomLevel=new x;onDidChangeZoomLevel=this._onDidChangeZoomLevel.event;getZoomLevel(t){return this.mapWindowIdToZoomLevel.get(this.getWindowId(t))??0}setZoomLevel(t,e){if(this.getZoomLevel(e)===t)return;let i=this.getWindowId(e);this.mapWindowIdToZoomLevel.set(i,t),this._onDidChangeZoomLevel.fire(i)}mapWindowIdToZoomFactor=new Map;getZoomFactor(t){return this.mapWindowIdToZoomFactor.get(this.getWindowId(t))??1}setZoomFactor(t,e){this.mapWindowIdToZoomFactor.set(this.getWindowId(e),t)}_onDidChangeFullscreen=new x;onDidChangeFullscreen=this._onDidChangeFullscreen.event;mapWindowIdToFullScreen=new Map;setFullscreen(t,e){if(this.isFullscreen(e)===t)return;let i=this.getWindowId(e);this.mapWindowIdToFullScreen.set(i,t),this._onDidChangeFullscreen.fire(i)}isFullscreen(t){return!!this.mapWindowIdToFullScreen.get(this.getWindowId(t))}getWindowId(t){return t.vscodeWindowId}};function Mfe(r,t,e){typeof t=="string"&&(t=r.matchMedia(t)),t.addEventListener("change",e)}function vee(r){return tf.INSTANCE.getZoomLevel(r)}var qMe=tf.INSTANCE.onDidChangeZoomLevel;function qv(r){return tf.INSTANCE.getZoomFactor(r)}function Iee(r,t){tf.INSTANCE.setFullscreen(r,t)}function K_(r){return tf.INSTANCE.isFullscreen(r)}var yee=tf.INSTANCE.onDidChangeFullscreen,VS=navigator.userAgent,po=VS.indexOf("Firefox")>=0,Yc=VS.indexOf("AppleWebKit")>=0,nf=VS.indexOf("Chrome")>=0,ms=!nf&&VS.indexOf("Safari")>=0,See=!nf&&!ms&&Yc,$Me=VS.indexOf("Electron/")>=0,E4=VS.indexOf("Android")>=0,SA=!1;if(typeof Ke.matchMedia=="function"){let r=Ke.matchMedia("(display-mode: standalone) or (display-mode: window-controls-overlay)"),t=Ke.matchMedia("(display-mode: fullscreen)");SA=r.matches,Mfe(Ke,r,({matches:e})=>{SA&&t.matches||(SA=e)})}function Cee(){return SA}function CA(){return navigator?.windowControlsOverlay?.visible}function wee(r){return r.navigator?.windowControlsOverlay?.getTitlebarAreaRect()}function x4(r,t){if(typeof r=="number"){if(r===0)return null;let e=(r&65535)>>>0,i=(r&4294901760)>>>16;return i!==0?new WS([wA(e,t),wA(i,t)]):new WS([wA(e,t)])}else{let e=[];for(let i=0;i<r.length;i++)e.push(wA(r[i],t));return new WS(e)}}function wA(r,t){let e=!!(r&2048),i=!!(r&256),n=t===2?i:e,o=!!(r&1024),s=!!(r&512),a=t===2?e:i,l=r&255;return new of(n,o,s,a,l)}var of=class r{constructor(t,e,i,n,o){this.ctrlKey=t;this.shiftKey=e;this.altKey=i;this.metaKey=n;this.keyCode=o}equals(t){return t instanceof r&&this.ctrlKey===t.ctrlKey&&this.shiftKey===t.shiftKey&&this.altKey===t.altKey&&this.metaKey===t.metaKey&&this.keyCode===t.keyCode}getHashCode(){let t=this.ctrlKey?"1":"0",e=this.shiftKey?"1":"0",i=this.altKey?"1":"0",n=this.metaKey?"1":"0";return`K${t}${e}${i}${n}${this.keyCode}`}isModifierKey(){return this.keyCode===0||this.keyCode===5||this.keyCode===57||this.keyCode===6||this.keyCode===4}toKeybinding(){return new WS([this])}isDuplicateModifierCase(){return this.ctrlKey&&this.keyCode===5||this.shiftKey&&this.keyCode===4||this.altKey&&this.keyCode===6||this.metaKey&&this.keyCode===57}};var WS=class{chords;constructor(t){if(t.length===0)throw Uc("chords");this.chords=t}getHashCode(){let t="";for(let e=0,i=this.chords.length;e<i;e++)e!==0&&(t+=";"),t+=this.chords[e].getHashCode();return t}equals(t){if(t===null||this.chords.length!==t.chords.length)return!1;for(let e=0;e<this.chords.length;e++)if(!this.chords[e].equals(t.chords[e]))return!1;return!0}};function Ofe(r){if(r.charCode){let e=String.fromCharCode(r.charCode).toUpperCase();return b_.fromString(e)}let t=r.keyCode;if(t===3)return 7;if(po)switch(t){case 59:return 85;case 60:if(ci)return 97;break;case 61:return 86;case 107:return 109;case 109:return 111;case 173:return 88;case 224:if(ye)return 57;break}else if(Yc){if(ye&&t===93)return 57;if(!ye&&t===92)return 57}return O5[t]||0}var Nfe=ye?256:2048,Ffe=512,Bfe=1024,Vfe=ye?2048:256;var ut=class{_standardKeyboardEventBrand=!0;browserEvent;target;ctrlKey;shiftKey;altKey;metaKey;altGraphKey;keyCode;code;_asKeybinding;_asKeyCodeChord;constructor(t){let e=t;this.browserEvent=e,this.target=e.target,this.ctrlKey=e.ctrlKey,this.shiftKey=e.shiftKey,this.altKey=e.altKey,this.metaKey=e.metaKey,this.altGraphKey=e.getModifierState?.("AltGraph"),this.keyCode=Ofe(e),this.code=e.code,this.ctrlKey=this.ctrlKey||this.keyCode===5,this.altKey=this.altKey||this.keyCode===6,this.shiftKey=this.shiftKey||this.keyCode===4,this.metaKey=this.metaKey||this.keyCode===57,this._asKeybinding=this._computeKeybinding(),this._asKeyCodeChord=this._computeKeyCodeChord()}preventDefault(){this.browserEvent&&this.browserEvent.preventDefault&&this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent&&this.browserEvent.stopPropagation&&this.browserEvent.stopPropagation()}toKeyCodeChord(){return this._asKeyCodeChord}equals(t){return this._asKeybinding===t}_computeKeybinding(){let t=0;this.keyCode!==5&&this.keyCode!==4&&this.keyCode!==6&&this.keyCode!==57&&(t=this.keyCode);let e=0;return this.ctrlKey&&(e|=Nfe),this.altKey&&(e|=Ffe),this.shiftKey&&(e|=Bfe),this.metaKey&&(e|=Vfe),e|=t,e}_computeKeyCodeChord(){let t=0;return this.keyCode!==5&&this.keyCode!==4&&this.keyCode!==6&&this.keyCode!==57&&(t=this.keyCode),new of(this.ctrlKey,this.shiftKey,this.altKey,this.metaKey,t)}};var Eee=new WeakMap;function Wfe(r){if(!r.parent||r.parent===r)return null;try{let t=r.location,e=r.parent.location;if(t.origin!=="null"&&e.origin!=="null"&&t.origin!==e.origin)return null}catch{return null}return r.parent}var EA=class{static getSameOriginWindowChain(t){let e=Eee.get(t);if(!e){e=[],Eee.set(t,e);let i=t,n;do n=Wfe(i),n?e.push({window:new WeakRef(i),iframeElement:i.frameElement||null}):e.push({window:new WeakRef(i),iframeElement:null}),i=n;while(i)}return e.slice(0)}static getPositionOfChildWindowRelativeToAncestorWindow(t,e){if(!e||t===e)return{top:0,left:0};let i=0,n=0,o=this.getSameOriginWindowChain(t);for(let s of o){let a=s.window.deref();if(i+=a?.scrollY??0,n+=a?.scrollX??0,a===e||!s.iframeElement)break;let l=s.iframeElement.getBoundingClientRect();i+=l.top,n+=l.left}return{top:i,left:n}}};var _i=class{browserEvent;leftButton;middleButton;rightButton;buttons;target;detail;posx;posy;ctrlKey;shiftKey;altKey;metaKey;timestamp;constructor(t,e){this.timestamp=Date.now(),this.browserEvent=e,this.leftButton=e.button===0,this.middleButton=e.button===1,this.rightButton=e.button===2,this.buttons=e.buttons,this.target=e.target,this.detail=e.detail||1,e.type==="dblclick"&&(this.detail=2),this.ctrlKey=e.ctrlKey,this.shiftKey=e.shiftKey,this.altKey=e.altKey,this.metaKey=e.metaKey,typeof e.pageX=="number"?(this.posx=e.pageX,this.posy=e.pageY):(this.posx=e.clientX+this.target.ownerDocument.body.scrollLeft+this.target.ownerDocument.documentElement.scrollLeft,this.posy=e.clientY+this.target.ownerDocument.body.scrollTop+this.target.ownerDocument.documentElement.scrollTop);let i=EA.getPositionOfChildWindowRelativeToAncestorWindow(t,e.view);this.posx-=i.left,this.posy-=i.top}preventDefault(){this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent.stopPropagation()}};var Id=class{browserEvent;deltaY;deltaX;target;constructor(t,e=0,i=0){this.browserEvent=t||null,this.target=t?t.target||t.targetNode||t.srcElement:null,this.deltaY=i,this.deltaX=e;let n=!1;if(nf){let o=navigator.userAgent.match(/Chrome\/(\d+)/);n=(o?parseInt(o[1]):123)<=122}if(t){let o=t,s=t,a=t.view?.devicePixelRatio||1;if(typeof o.wheelDeltaY<"u")n?this.deltaY=o.wheelDeltaY/(120*a):this.deltaY=o.wheelDeltaY/120;else if(typeof s.VERTICAL_AXIS<"u"&&s.axis===s.VERTICAL_AXIS)this.deltaY=-s.detail/3;else if(t.type==="wheel"){let l=t;l.deltaMode===l.DOM_DELTA_LINE?po&&!ye?this.deltaY=-t.deltaY/3:this.deltaY=-t.deltaY:this.deltaY=-t.deltaY/40}if(typeof o.wheelDeltaX<"u")ms&&St?this.deltaX=-(o.wheelDeltaX/120):n?this.deltaX=o.wheelDeltaX/(120*a):this.deltaX=o.wheelDeltaX/120;else if(typeof s.HORIZONTAL_AXIS<"u"&&s.axis===s.HORIZONTAL_AXIS)this.deltaX=-t.detail/3;else if(t.type==="wheel"){let l=t;l.deltaMode===l.DOM_DELTA_LINE?po&&!ye?this.deltaX=-t.deltaX/3:this.deltaX=-t.deltaX:this.deltaX=-t.deltaX/40}this.deltaY===0&&this.deltaX===0&&t.wheelDelta&&(n?this.deltaY=t.wheelDelta/(120*a):this.deltaY=t.wheelDelta/120)}}preventDefault(){this.browserEvent?.preventDefault()}stopPropagation(){this.browserEvent?.stopPropagation()}};var Qc={clipboard:{writeText:Po||document.queryCommandSupported&&document.queryCommandSupported("copy")||!!(navigator&&navigator.clipboard&&navigator.clipboard.writeText),readText:Po||!!(navigator&&navigator.clipboard&&navigator.clipboard.readText)},keyboard:Po||Cee()?0:navigator.keyboard||ms?1:2,touch:"ontouchstart"in Ke||navigator.maxTouchPoints>0,pointerEvents:Ke.PointerEvent&&("ontouchstart"in Ke||navigator.maxTouchPoints>0)};function Bt(r){return typeof r=="string"}function G_(r){return Array.isArray(r)&&r.every(t=>Bt(t))}function vi(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)&&!(r instanceof RegExp)&&!(r instanceof Date)}function cr(r){return typeof r=="number"&&!isNaN(r)}function T4(r){return!!r&&typeof r[Symbol.iterator]=="function"}function HS(r){return r===!0||r===!1}function Vn(r){return typeof r>"u"}function go(r){return!Wn(r)}function Wn(r){return Vn(r)||r===null}function un(r,t){if(!r)throw new Error(t?`Unexpected type, expected '${t}'`:"Unexpected type")}function Yt(r){if(Wn(r))throw new Error("Assertion Failed: argument is undefined or null");return r}function $v(...r){let t=[];for(let e=0;e<r.length;e++){let i=r[e];if(Wn(i))throw new Error(`Assertion Failed: argument at index ${e} is undefined or null`);t.push(i)}return t}var Hfe=Object.prototype.hasOwnProperty;function jv(r){if(!vi(r))return!1;for(let t in r)if(Hfe.call(r,t))return!1;return!0}function Xv(r){return typeof r=="function"}function xee(r,t){let e=Math.min(r.length,t.length);for(let i=0;i<e;i++)Ufe(r[i],t[i])}function Ufe(r,t){if(Bt(t)){if(typeof r!==t)throw new Error(`argument does not match constraint: typeof ${t}`)}else if(Xv(t)){try{if(r instanceof t)return}catch{}if(!Wn(r)&&r.constructor===t||t.length===1&&t.call(void 0,r)===!0)return;throw new Error("argument does not match one of these constraints: arg instanceof constraint, arg.constructor === constraint, nor constraint(arg) === true")}}function sf(r){return r===47||r===92}function Yv(r){return r.replace(/[\\/]/g,Xt.sep)}function Tee(r){return r.indexOf("/")===-1&&(r=Yv(r)),/^[a-zA-Z]:(\/|$)/.test(r)&&(r="/"+r),r}function _4(r,t=Xt.sep){if(!r)return"";let e=r.length,i=r.charCodeAt(0);if(sf(i)){if(sf(r.charCodeAt(1))&&!sf(r.charCodeAt(2))){let o=3,s=o;for(;o<e&&!sf(r.charCodeAt(o));o++);if(s!==o&&!sf(r.charCodeAt(o+1))){for(o+=1;o<e;o++)if(sf(r.charCodeAt(o)))return r.slice(0,o+1).replace(/[\\/]/g,t)}}return t}else if(Dee(i)&&r.charCodeAt(1)===58)return sf(r.charCodeAt(2))?r.slice(0,2)+t:r.slice(0,2);let n=r.indexOf("://");if(n!==-1){for(n+=3;n<e;n++)if(sf(r.charCodeAt(n)))return r.slice(0,n+1)}return""}var zfe=/[\\/:\*\?"<>\|]/g,Kfe=/[/]/g,Gfe=/^(con|prn|aux|clock\$|nul|lpt[0-9]|com[0-9])(\.(.*?))?$/i;function _ee(r,t=St){let e=t?zfe:Kfe;return!(!r||r.length===0||/^\s+$/.test(r)||(e.lastIndex=0,e.test(r))||t&&Gfe.test(r)||r==="."||r===".."||t&&r[r.length-1]==="."||t&&r.length!==r.trim().length||r.length>255)}function US(r,t,e,i=Ur){if(r===t)return!0;if(!r||!t||t.length>r.length)return!1;if(e){if(!bm(r,t))return!1;if(t.length===r.length)return!0;let o=t.length;return t.charAt(t.length-1)===i&&o--,r.charAt(o)===i}return t.charAt(t.length-1)!==i&&(t+=i),r.indexOf(t)===0}function Dee(r){return r>=65&&r<=90||r>=97&&r<=122}function D4(r,t=St){return t?Dee(r.charCodeAt(0))&&r.charCodeAt(1)===58:!1}function kee(r,t=St){return D4(r,t)?r[0]:void 0}function Lee(r,t,e){return t.length>r.length?-1:r===t?0:(e&&(r=r.toLowerCase(),t=t.toLowerCase()),r.indexOf(t))}function Ree(r){let t=r.split(":"),e,i,n;for(let o of t){let s=Number(o);cr(s)?i===void 0?i=s:n===void 0&&(n=s):e=e?[e,o].join(":"):o}if(!e)throw new Error("Format for `--goto` should be: `FILE:LINE(:COLUMN)`");return{path:e,line:i!==void 0?i:void 0,column:n!==void 0?n:i!==void 0?1:void 0}}function ym(r){return L_(r,!0)}var q_=class{constructor(t){this._ignorePathCasing=t}compare(t,e,i=!1){return t===e?0:Zg(this.getComparisonKey(t,i),this.getComparisonKey(e,i))}isEqual(t,e,i=!1){return t===e?!0:!t||!e?!1:this.getComparisonKey(t,i)===this.getComparisonKey(e,i)}getComparisonKey(t,e=!1){return t.with({path:this._ignorePathCasing(t)?t.path.toLowerCase():void 0,fragment:e?null:void 0}).toString()}ignorePathCasing(t){return this._ignorePathCasing(t)}isEqualOrParent(t,e,i=!1){if(t.scheme===e.scheme){if(t.scheme===Ie.file)return US(ym(t),ym(e),this._ignorePathCasing(t))&&t.query===e.query&&(i||t.fragment===e.fragment);if(k4(t.authority,e.authority))return US(t.path,e.path,this._ignorePathCasing(t),"/")&&t.query===e.query&&(i||t.fragment===e.fragment)}return!1}joinPath(t,...e){return Z.joinPath(t,...e)}basenameOrAuthority(t){return Ji(t)||t.authority}basename(t){return Xt.basename(t.path)}extname(t){return Xt.extname(t.path)}dirname(t){if(t.path.length===0)return t;let e;return t.scheme===Ie.file?e=Z.file(zg(ym(t))).path:(e=Xt.dirname(t.path),t.authority&&e.length&&e.charCodeAt(0)!==47&&(console.error(`dirname("${t.toString})) resulted in a relative path`),e="/")),t.with({path:e})}normalizePath(t){if(!t.path.length)return t;let e;return t.scheme===Ie.file?e=Z.file(ds(ym(t))).path:e=Xt.normalize(t.path),t.with({path:e})}relativePath(t,e){if(t.scheme!==e.scheme||!k4(t.authority,e.authority))return;if(t.scheme===Ie.file){let o=k_(ym(t),ym(e));return St?Yv(o):o}let i=t.path||"/",n=e.path||"/";if(this._ignorePathCasing(t)){let o=0;for(let s=Math.min(i.length,n.length);o<s&&!(i.charCodeAt(o)!==n.charCodeAt(o)&&i.charAt(o).toLowerCase()!==n.charAt(o).toLowerCase());o++);i=n.substr(0,o)+i.substr(o)}return Xt.relative(i,n)}resolvePath(t,e){if(t.scheme===Ie.file){let i=Z.file(ES(ym(t),e));return t.with({authority:i.authority,path:i.path})}return e=Tee(e),t.with({path:Xt.resolve(t.path,e)})}isAbsolutePath(t){return!!t.path&&t.path[0]==="/"}isEqualAuthority(t,e){return t===e||t!==void 0&&e!==void 0&&dr(t,e)}hasTrailingPathSeparator(t,e=Ur){if(t.scheme===Ie.file){let i=ym(t);return i.length>_4(i).length&&i[i.length-1]===e}else{let i=t.path;return i.length>1&&i.charCodeAt(i.length-1)===47&&!/^[a-zA-Z]:(\/$|\\$)/.test(t.fsPath)}}removeTrailingPathSeparator(t,e=Ur){return Mee(t,e)?t.with({path:t.path.substr(0,t.path.length-1)}):t}addTrailingPathSeparator(t,e=Ur){let i=!1;if(t.scheme===Ie.file){let n=ym(t);i=n!==void 0&&n.length===_4(n).length&&n[n.length-1]===e}else{e="/";let n=t.path;i=n.length===1&&n.charCodeAt(n.length-1)===47}return!i&&!Mee(t,e)?t.with({path:t.path+"/"}):t}},Ti=new q_(()=>!1),qfe=new q_(r=>r.scheme===Ie.file?!ci:!0),L4=new q_(r=>!0),zi=Ti.isEqual.bind(Ti),R4=Ti.isEqualOrParent.bind(Ti),fAe=Ti.getComparisonKey.bind(Ti),Ns=Ti.basenameOrAuthority.bind(Ti),Ji=Ti.basename.bind(Ti),Sm=Ti.extname.bind(Ti),Hn=Ti.dirname.bind(Ti),pi=Ti.joinPath.bind(Ti),bAe=Ti.normalizePath.bind(Ti),af=Ti.relativePath.bind(Ti),P4=Ti.resolvePath.bind(Ti),vAe=Ti.isAbsolutePath.bind(Ti),k4=Ti.isEqualAuthority.bind(Ti),Mee=Ti.hasTrailingPathSeparator.bind(Ti),IAe=Ti.removeTrailingPathSeparator.bind(Ti),yAe=Ti.addTrailingPathSeparator.bind(Ti);var Cm;(o=>{o.META_DATA_LABEL="label",o.META_DATA_DESCRIPTION="description",o.META_DATA_SIZE="size",o.META_DATA_MIME="mime";function n(s){let a=new Map;s.path.substring(s.path.indexOf(";")+1,s.path.lastIndexOf(";")).split(";").forEach(c=>{let[p,h]=c.split(":");p&&h&&a.set(p,h)});let d=s.path.substring(0,s.path.indexOf(";"));return d&&a.set(o.META_DATA_MIME,d),a}o.parseMetaData=n})(Cm||={});function X_(r){return!!r&&typeof r.then=="function"}function va(r){let t=new Kt,e=r(t.token),i=new Promise((n,o)=>{let s=t.token.onCancellationRequested(()=>{s.dispose(),o(new wo)});Promise.resolve(e).then(a=>{s.dispose(),t.dispose(),n(a)},a=>{s.dispose(),t.dispose(),o(a)})});return new class{cancel(){t.cancel(),t.dispose()}then(n,o){return i.then(n,o)}catch(n){return this.then(void 0,n)}finally(n){return i.finally(n)}}}function Zv(r,t,e){return new Promise((i,n)=>{let o=t.onCancellationRequested(()=>{o.dispose(),i(e)});r.then(i,n).finally(()=>o.dispose())})}function kA(r,t,e){let i,n=setTimeout(()=>{i?.(void 0),e?.()},t);return Promise.race([r.finally(()=>clearTimeout(n)),new Promise(o=>i=o)])}function Aee(){let r,t;return{promise:new Promise((i,n)=>{r=i,t=n}),resolve:r,reject:t}}var M4=class{activePromise;queuedPromise;queuedPromiseFactory;isDisposed=!1;constructor(){this.activePromise=null,this.queuedPromise=null,this.queuedPromiseFactory=null}queue(t){if(this.isDisposed)return Promise.reject(new Error("Throttler is disposed"));if(this.activePromise){if(this.queuedPromiseFactory=t,!this.queuedPromise){let e=()=>{if(this.queuedPromise=null,this.isDisposed)return;let i=this.queue(this.queuedPromiseFactory);return this.queuedPromiseFactory=null,i};this.queuedPromise=new Promise(i=>{this.activePromise.then(e,e).then(i)})}return new Promise((e,i)=>{this.queuedPromise.then(e,i)})}return this.activePromise=t(),new Promise((e,i)=>{this.activePromise.then(n=>{this.activePromise=null,e(n)},n=>{this.activePromise=null,i(n)})})}dispose(){this.isDisposed=!0}};var xA=class{promiseMap=new Map;queue(t,e){let n=(this.promiseMap.get(t)??Promise.resolve()).catch(()=>{}).then(e).finally(()=>{this.promiseMap.get(t)===n&&this.promiseMap.delete(t)});return this.promiseMap.set(t,n),n}},$fe=(r,t)=>{let e=!0,i=setTimeout(()=>{e=!1,t()},r);return{isTriggered:()=>e,dispose:()=>{clearTimeout(i),e=!1}}},jfe=r=>{let t=!0;return queueMicrotask(()=>{t&&(t=!1,r())}),{isTriggered:()=>t,dispose:()=>{t=!1}}},yd=class{constructor(t){this.defaultDelay=t;this.deferred=null,this.completionPromise=null,this.doResolve=null,this.doReject=null,this.task=null}deferred;completionPromise;doResolve;doReject;task;trigger(t,e=this.defaultDelay){this.task=t,this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise((n,o)=>{this.doResolve=n,this.doReject=o}).then(()=>{if(this.completionPromise=null,this.doResolve=null,this.task){let n=this.task;return this.task=null,n()}}));let i=()=>{this.deferred=null,this.doResolve?.(null)};return this.deferred=e===sA?jfe(i):$fe(e,i),this.completionPromise}isTriggered(){return!!this.deferred?.isTriggered()}cancel(){this.cancelTimeout(),this.completionPromise&&(this.doReject?.(new wo),this.completionPromise=null)}cancelTimeout(){this.deferred?.dispose(),this.deferred=null}dispose(){this.cancel()}},lf=class{delayer;throttler;constructor(t){this.delayer=new yd(t),this.throttler=new M4}trigger(t,e){return this.delayer.trigger(()=>this.throttler.queue(t),e)}isTriggered(){return this.delayer.isTriggered()}cancel(){this.delayer.cancel()}dispose(){this.delayer.dispose(),this.throttler.dispose()}},KS=class{_isOpen;_promise;_completePromise;constructor(){this._isOpen=!1,this._promise=new Promise((t,e)=>{this._completePromise=t})}isOpen(){return this._isOpen}open(){this._isOpen=!0,this._completePromise(!0)}wait(){return this._promise}};function To(r,t){return t?new Promise((e,i)=>{let n=setTimeout(()=>{o.dispose(),e()},r),o=t.onCancellationRequested(()=>{clearTimeout(n),o.dispose(),i(new wo)})}):va(e=>To(r,e))}function Sd(r,t=0,e){let i=setTimeout(()=>{r(),e&&n.dispose()},t),n=le(()=>{clearTimeout(i),e?.deleteAndLeak(n)});return e?.add(n),n}function Oee(r){let t=[],e=0,i=r.length;function n(){return e<i?r[e++]():null}function o(s){s!=null&&t.push(s);let a=n();return a?a.then(o):Promise.resolve(t)}return Promise.resolve(null).then(o)}var A4=class{_size=0;_isDisposed=!1;runningPromises;maxDegreeOfParalellism;outstandingPromises;_onDrained;constructor(t){this.maxDegreeOfParalellism=t,this.outstandingPromises=[],this.runningPromises=0,this._onDrained=new x}whenIdle(){return this.size>0?X.toPromise(this.onDrained):Promise.resolve()}get onDrained(){return this._onDrained.event}get size(){return this._size}queue(t){if(this._isDisposed)throw new Error("Object has been disposed");return this._size++,new Promise((e,i)=>{this.outstandingPromises.push({factory:t,c:e,e:i}),this.consume()})}consume(){for(;this.outstandingPromises.length&&this.runningPromises<this.maxDegreeOfParalellism;){let t=this.outstandingPromises.shift();this.runningPromises++;let e=t.factory();e.then(t.c,t.e),e.then(()=>this.consumed(),()=>this.consumed())}}consumed(){this._isDisposed||(this.runningPromises--,--this._size===0&&this._onDrained.fire(),this.outstandingPromises.length>0&&this.consume())}clear(){if(this._isDisposed)throw new Error("Object has been disposed");this.outstandingPromises.length=0,this._size=this.runningPromises}dispose(){this._isDisposed=!0,this.outstandingPromises.length=0,this._size=0,this._onDrained.dispose()}},TA=class extends A4{constructor(){super(1)}};var Qs=class{_token;_isDisposed=!1;constructor(t,e){this._token=-1,typeof t=="function"&&typeof e=="number"&&this.setIfNotSet(t,e)}dispose(){this.cancel(),this._isDisposed=!0}cancel(){this._token!==-1&&(clearTimeout(this._token),this._token=-1)}cancelAndSet(t,e){if(this._isDisposed)throw new _t("Calling 'cancelAndSet' on a disposed TimeoutTimer");this.cancel(),this._token=setTimeout(()=>{this._token=-1,t()},e)}setIfNotSet(t,e){if(this._isDisposed)throw new _t("Calling 'setIfNotSet' on a disposed TimeoutTimer");this._token===-1&&(this._token=setTimeout(()=>{this._token=-1,t()},e))}},_A=class{disposable=void 0;isDisposed=!1;cancel(){this.disposable?.dispose(),this.disposable=void 0}cancelAndSet(t,e,i=globalThis){if(this.isDisposed)throw new _t("Calling 'cancelAndSet' on a disposed IntervalTimer");this.cancel();let n=i.setInterval(()=>{t()},e);this.disposable=le(()=>{i.clearInterval(n),this.disposable=void 0})}dispose(){this.cancel(),this.isDisposed=!0}},Ye=class{runner;timeoutToken;timeout;timeoutHandler;constructor(t,e){this.timeoutToken=-1,this.runner=t,this.timeout=e,this.timeoutHandler=this.onTimeout.bind(this)}dispose(){this.cancel(),this.runner=null}cancel(){this.isScheduled()&&(clearTimeout(this.timeoutToken),this.timeoutToken=-1)}schedule(t=this.timeout){this.cancel(),this.timeoutToken=setTimeout(this.timeoutHandler,t)}get delay(){return this.timeout}set delay(t){this.timeout=t}isScheduled(){return this.timeoutToken!==-1}flush(){this.isScheduled()&&(this.cancel(),this.doRun())}onTimeout(){this.timeoutToken=-1,this.runner&&this.doRun()}doRun(){this.runner?.()}};var df,zS;(function(){typeof globalThis.requestIdleCallback!="function"||typeof globalThis.cancelIdleCallback!="function"?zS=(r,t)=>{OM(()=>{if(e)return;let i=Date.now()+15;t(Object.freeze({didTimeout:!0,timeRemaining(){return Math.max(0,i-Date.now())}}))});let e=!1;return{dispose(){e||(e=!0)}}}:zS=(r,t,e)=>{let i=r.requestIdleCallback(t,typeof e=="number"?{timeout:e}:void 0),n=!1;return{dispose(){n||(n=!0,r.cancelIdleCallback(i))}}},df=r=>zS(globalThis,r)})();var $_=class{_executor;_handle;_didRun=!1;_value;_error;constructor(t,e){this._executor=()=>{try{this._value=e()}catch(i){this._error=i}finally{this._didRun=!0}},this._handle=zS(t,()=>this._executor())}dispose(){this._handle.dispose()}get value(){if(this._didRun||(this._handle.dispose(),this._executor()),this._error)throw this._error;return this._value}get isInitialized(){return this._didRun}},j_=class extends $_{constructor(t){super(globalThis,t)}};var DA=class{_running;_queued;isRunning(t){return typeof t=="number"?this._running?.taskId===t:!!this._running}get running(){return this._running?.promise}cancelRunning(){this._running?.cancel()}run(t,e,i){return this._running={taskId:t,cancel:()=>i?.(),promise:e},e.then(()=>this.doneRunning(t),()=>this.doneRunning(t)),e}doneRunning(t){this._running&&t===this._running.taskId&&(this._running=void 0,this.runQueued())}runQueued(){if(this._queued){let t=this._queued;this._queued=void 0,t.run().then(t.promiseResolve,t.promiseReject)}}queue(t){if(this._queued)this._queued.run=t;else{let{promise:e,resolve:i,reject:n}=Aee();this._queued={run:t,promise:e,promiseResolve:i,promiseReject:n}}return this._queued.promise}hasQueued(){return!!this._queued}async join(){return this._queued?.promise??this._running?.promise}};var Kr=class{completeCallback;errorCallback;outcome;get isRejected(){return this.outcome?.outcome===1}get isResolved(){return this.outcome?.outcome===0}get isSettled(){return!!this.outcome}get value(){return this.outcome?.outcome===0?this.outcome?.value:void 0}p;constructor(){this.p=new Promise((t,e)=>{this.completeCallback=t,this.errorCallback=e})}complete(t){return new Promise(e=>{this.completeCallback(t),this.outcome={outcome:0,value:t},e()})}error(t){return new Promise(e=>{this.errorCallback(t),this.outcome={outcome:1,value:t},e()})}cancel(){return this.error(new wo)}},Xa;(e=>{async function r(i){let n,o=await Promise.all(i.map(s=>s.then(a=>a,a=>{n||(n=a)})));if(typeof n<"u")throw n;return o}e.settled=r;function t(i){return new Promise(async(n,o)=>{try{await i(n,o)}catch(s){o(s)}})}e.withAsyncBody=t})(Xa||={});var gs=class r{static fromArray(t){return new r(e=>{e.emitMany(t)})}static fromPromise(t){return new r(async e=>{e.emitMany(await t)})}static fromPromises(t){return new r(async e=>{await Promise.all(t.map(async i=>e.emitOne(await i)))})}static merge(t){return new r(async e=>{await Promise.all(t.map(async i=>{for await(let n of i)e.emitOne(n)}))})}static EMPTY=r.fromArray([]);_state;_results;_error;_onReturn;_onStateChanged;constructor(t,e){this._state=0,this._results=[],this._error=null,this._onReturn=e,this._onStateChanged=new x,queueMicrotask(async()=>{let i={emitOne:n=>this.emitOne(n),emitMany:n=>this.emitMany(n),reject:n=>this.reject(n)};try{await Promise.resolve(t(i)),this.resolve()}catch(n){this.reject(n)}finally{i.emitOne=void 0,i.emitMany=void 0,i.reject=void 0}})}[Symbol.asyncIterator](){let t=0;return{next:async()=>{do{if(this._state===2)throw this._error;if(t<this._results.length)return{done:!1,value:this._results[t++]};if(this._state===1)return{done:!0,value:void 0};await X.toPromise(this._onStateChanged.event)}while(!0)},return:async()=>(this._onReturn?.(),{done:!0,value:void 0})}}static map(t,e){return new r(async i=>{for await(let n of t)i.emitOne(e(n))})}map(t){return r.map(this,t)}static filter(t,e){return new r(async i=>{for await(let n of t)e(n)&&i.emitOne(n)})}filter(t){return r.filter(this,t)}static coalesce(t){return r.filter(t,e=>!!e)}coalesce(){return r.coalesce(this)}static async toPromise(t){let e=[];for await(let i of t)e.push(i);return e}toPromise(){return r.toPromise(this)}emitOne(t){this._state===0&&(this._results.push(t),this._onStateChanged.fire())}emitMany(t){this._state===0&&(this._results=this._results.concat(t),this._onStateChanged.fire())}resolve(){this._state===0&&(this._state=1,this._onStateChanged.fire())}reject(t){this._state===0&&(this._state=2,this._error=t,this._onStateChanged.fire())}},O4=class extends gs{constructor(e,i){super(i);this._source=e}cancel(){this._source.cancel()}};function Nee(r){let t=new Kt,e=r(t.token);return new O4(t,async i=>{let n=t.token.onCancellationRequested(()=>{n.dispose(),t.dispose(),i.reject(new wo)});try{for await(let o of e){if(t.token.isCancellationRequested)return;i.emitOne(o)}n.dispose(),t.dispose()}catch(o){n.dispose(),t.dispose(),i.reject(o)}})}var{entries:Kee,setPrototypeOf:Fee,isFrozen:Xfe,getPrototypeOf:Yfe,getOwnPropertyDescriptor:Qfe}=Object,{freeze:Ya,seal:Jc,create:Zfe}=Object,{apply:H4,construct:U4}=typeof Reflect<"u"&&Reflect;H4||(H4=function(t,e,i){return t.apply(e,i)});Ya||(Ya=function(t){return t});Jc||(Jc=function(t){return t});U4||(U4=function(t,e){return new t(...e)});var Jfe=lc(Array.prototype.forEach),Bee=lc(Array.prototype.pop),Y_=lc(Array.prototype.push),PA=lc(String.prototype.toLowerCase),N4=lc(String.prototype.toString),ebe=lc(String.prototype.match),Zc=lc(String.prototype.replace),tbe=lc(String.prototype.indexOf),ibe=lc(String.prototype.trim),Cd=lc(RegExp.prototype.test),Q_=nbe(TypeError);function lc(r){return function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];return H4(r,t,i)}}function nbe(r){return function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return U4(r,e)}}function Ai(r,t,e){var i;e=(i=e)!==null&&i!==void 0?i:PA,Fee&&Fee(r,null);let n=t.length;for(;n--;){let o=t[n];if(typeof o=="string"){let s=e(o);s!==o&&(Xfe(t)||(t[n]=s),o=s)}r[o]=!0}return r}function GS(r){let t=Zfe(null);for(let[e,i]of Kee(r))t[e]=i;return t}function LA(r,t){for(;r!==null;){let i=Qfe(r,t);if(i){if(i.get)return lc(i.get);if(typeof i.value=="function")return lc(i.value)}r=Yfe(r)}function e(i){return console.warn("fallback value for",i),null}return e}var Vee=Ya(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),F4=Ya(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),B4=Ya(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),obe=Ya(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),V4=Ya(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),rbe=Ya(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Wee=Ya(["#text"]),Hee=Ya(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),W4=Ya(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Uee=Ya(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),RA=Ya(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),sbe=Jc(/\{\{[\w\W]*|[\w\W]*\}\}/gm),abe=Jc(/<%[\w\W]*|[\w\W]*%>/gm),lbe=Jc(/\${[\w\W]*}/gm),dbe=Jc(/^data-[\-\w.\u00B7-\uFFFF]/),cbe=Jc(/^aria-[\-\w]+$/),Gee=Jc(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),ube=Jc(/^(?:\w+script|data):/i),pbe=Jc(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),qee=Jc(/^html$/i),zee=Object.freeze({__proto__:null,MUSTACHE_EXPR:sbe,ERB_EXPR:abe,TMPLIT_EXPR:lbe,DATA_ATTR:dbe,ARIA_ATTR:cbe,IS_ALLOWED_URI:Gee,IS_SCRIPT_OR_DATA:ube,ATTR_WHITESPACE:pbe,DOCTYPE_NAME:qee}),hbe=()=>typeof window>"u"?null:window,mbe=function(t,e){if(typeof t!="object"||typeof t.createPolicy!="function")return null;let i=null,n="data-tt-policy-suffix";e&&e.hasAttribute(n)&&(i=e.getAttribute(n));let o="dompurify"+(i?"#"+i:"");try{return t.createPolicy(o,{createHTML(s){return s},createScriptURL(s){return s}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}};function $ee(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:hbe(),t=Dt=>$ee(Dt);if(t.version="3.0.5",t.removed=[],!r||!r.document||r.document.nodeType!==9)return t.isSupported=!1,t;let e=r.document,i=e.currentScript,{document:n}=r,{DocumentFragment:o,HTMLTemplateElement:s,Node:a,Element:l,NodeFilter:d,NamedNodeMap:c=r.NamedNodeMap||r.MozNamedAttrMap,HTMLFormElement:p,DOMParser:h,trustedTypes:m}=r,f=l.prototype,g=LA(f,"cloneNode"),v=LA(f,"nextSibling"),I=LA(f,"childNodes"),y=LA(f,"parentNode");if(typeof s=="function"){let Dt=n.createElement("template");Dt.content&&Dt.content.ownerDocument&&(n=Dt.content.ownerDocument)}let w,C="",{implementation:S,createNodeIterator:D,createDocumentFragment:k,getElementsByTagName:M}=n,{importNode:O}=e,K={};t.isSupported=typeof Kee=="function"&&typeof y=="function"&&S&&S.createHTMLDocument!==void 0;let{MUSTACHE_EXPR:G,ERB_EXPR:Y,TMPLIT_EXPR:ge,DATA_ATTR:xe,ARIA_ATTR:be,IS_SCRIPT_OR_DATA:fe,ATTR_WHITESPACE:Le}=zee,{IS_ALLOWED_URI:Ee}=zee,Ce=null,Je=Ai({},[...Vee,...F4,...B4,...V4,...Wee]),pe=null,qt=Ai({},[...Hee,...W4,...Uee,...RA]),Mt=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),at=null,On=null,Nn=!0,Ro=!0,or=!1,sd=!0,Qi=!1,Br=!1,im=!1,dp=!1,Vr=!1,Bc=!1,Vc=!1,nm=!0,om=!1,Rt="user-content-",nc=!0,Wc=!1,ad={},Ka=null,Bg=Ai({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Mv=null,m_=Ai({},["audio","video","img","source","image","track"]),cp=null,g_=Ai({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),up="http://www.w3.org/1998/Math/MathML",ld="http://www.w3.org/2000/svg",rr="http://www.w3.org/1999/xhtml",dd=rr,rm=!1,ga=null,Vg=Ai({},[up,ld,rr],N4),Hc,pp=["application/xhtml+xml","text/html"],ze="text/html",Ae,ee=null,De=n.createElement("form"),We=function(ae){return ae instanceof RegExp||ae instanceof Function},ri=function(ae){if(!(ee&&ee===ae)){if((!ae||typeof ae!="object")&&(ae={}),ae=GS(ae),Hc=pp.indexOf(ae.PARSER_MEDIA_TYPE)===-1?Hc=ze:Hc=ae.PARSER_MEDIA_TYPE,Ae=Hc==="application/xhtml+xml"?N4:PA,Ce="ALLOWED_TAGS"in ae?Ai({},ae.ALLOWED_TAGS,Ae):Je,pe="ALLOWED_ATTR"in ae?Ai({},ae.ALLOWED_ATTR,Ae):qt,ga="ALLOWED_NAMESPACES"in ae?Ai({},ae.ALLOWED_NAMESPACES,N4):Vg,cp="ADD_URI_SAFE_ATTR"in ae?Ai(GS(g_),ae.ADD_URI_SAFE_ATTR,Ae):g_,Mv="ADD_DATA_URI_TAGS"in ae?Ai(GS(m_),ae.ADD_DATA_URI_TAGS,Ae):m_,Ka="FORBID_CONTENTS"in ae?Ai({},ae.FORBID_CONTENTS,Ae):Bg,at="FORBID_TAGS"in ae?Ai({},ae.FORBID_TAGS,Ae):{},On="FORBID_ATTR"in ae?Ai({},ae.FORBID_ATTR,Ae):{},ad="USE_PROFILES"in ae?ae.USE_PROFILES:!1,Nn=ae.ALLOW_ARIA_ATTR!==!1,Ro=ae.ALLOW_DATA_ATTR!==!1,or=ae.ALLOW_UNKNOWN_PROTOCOLS||!1,sd=ae.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Qi=ae.SAFE_FOR_TEMPLATES||!1,Br=ae.WHOLE_DOCUMENT||!1,Vr=ae.RETURN_DOM||!1,Bc=ae.RETURN_DOM_FRAGMENT||!1,Vc=ae.RETURN_TRUSTED_TYPE||!1,dp=ae.FORCE_BODY||!1,nm=ae.SANITIZE_DOM!==!1,om=ae.SANITIZE_NAMED_PROPS||!1,nc=ae.KEEP_CONTENT!==!1,Wc=ae.IN_PLACE||!1,Ee=ae.ALLOWED_URI_REGEXP||Gee,dd=ae.NAMESPACE||rr,Mt=ae.CUSTOM_ELEMENT_HANDLING||{},ae.CUSTOM_ELEMENT_HANDLING&&We(ae.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Mt.tagNameCheck=ae.CUSTOM_ELEMENT_HANDLING.tagNameCheck),ae.CUSTOM_ELEMENT_HANDLING&&We(ae.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Mt.attributeNameCheck=ae.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),ae.CUSTOM_ELEMENT_HANDLING&&typeof ae.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(Mt.allowCustomizedBuiltInElements=ae.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Qi&&(Ro=!1),Bc&&(Vr=!0),ad&&(Ce=Ai({},[...Wee]),pe=[],ad.html===!0&&(Ai(Ce,Vee),Ai(pe,Hee)),ad.svg===!0&&(Ai(Ce,F4),Ai(pe,W4),Ai(pe,RA)),ad.svgFilters===!0&&(Ai(Ce,B4),Ai(pe,W4),Ai(pe,RA)),ad.mathMl===!0&&(Ai(Ce,V4),Ai(pe,Uee),Ai(pe,RA))),ae.ADD_TAGS&&(Ce===Je&&(Ce=GS(Ce)),Ai(Ce,ae.ADD_TAGS,Ae)),ae.ADD_ATTR&&(pe===qt&&(pe=GS(pe)),Ai(pe,ae.ADD_ATTR,Ae)),ae.ADD_URI_SAFE_ATTR&&Ai(cp,ae.ADD_URI_SAFE_ATTR,Ae),ae.FORBID_CONTENTS&&(Ka===Bg&&(Ka=GS(Ka)),Ai(Ka,ae.FORBID_CONTENTS,Ae)),nc&&(Ce["#text"]=!0),Br&&Ai(Ce,["html","head","body"]),Ce.table&&(Ai(Ce,["tbody"]),delete at.tbody),ae.TRUSTED_TYPES_POLICY){if(typeof ae.TRUSTED_TYPES_POLICY.createHTML!="function")throw Q_('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof ae.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Q_('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');w=ae.TRUSTED_TYPES_POLICY,C=w.createHTML("")}else w===void 0&&(w=mbe(m,i)),w!==null&&typeof C=="string"&&(C=w.createHTML(""));Ya&&Ya(ae),ee=ae}},Zi=Ai({},["mi","mo","mn","ms","mtext"]),Wr=Ai({},["foreignobject","desc","title","annotation-xml"]),Ps=Ai({},["title","style","font","a","script"]),Wt=Ai({},F4);Ai(Wt,B4),Ai(Wt,obe);let W=Ai({},V4);Ai(W,rbe);let z=function(ae){let je=y(ae);(!je||!je.tagName)&&(je={namespaceURI:dd,tagName:"template"});let It=PA(ae.tagName),Ln=PA(je.tagName);return ga[ae.namespaceURI]?ae.namespaceURI===ld?je.namespaceURI===rr?It==="svg":je.namespaceURI===up?It==="svg"&&(Ln==="annotation-xml"||Zi[Ln]):!!Wt[It]:ae.namespaceURI===up?je.namespaceURI===rr?It==="math":je.namespaceURI===ld?It==="math"&&Wr[Ln]:!!W[It]:ae.namespaceURI===rr?je.namespaceURI===ld&&!Wr[Ln]||je.namespaceURI===up&&!Zi[Ln]?!1:!W[It]&&(Ps[It]||!Wt[It]):!!(Hc==="application/xhtml+xml"&&ga[ae.namespaceURI]):!1},$=function(ae){Y_(t.removed,{element:ae});try{ae.parentNode.removeChild(ae)}catch{ae.remove()}},te=function(ae,je){try{Y_(t.removed,{attribute:je.getAttributeNode(ae),from:je})}catch{Y_(t.removed,{attribute:null,from:je})}if(je.removeAttribute(ae),ae==="is"&&!pe[ae])if(Vr||Bc)try{$(je)}catch{}else try{je.setAttribute(ae,"")}catch{}},oe=function(ae){let je,It;if(dp)ae="<remove></remove>"+ae;else{let fa=ebe(ae,/^[\r\n\t ]+/);It=fa&&fa[0]}Hc==="application/xhtml+xml"&&dd===rr&&(ae='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+ae+"</body></html>");let Ln=w?w.createHTML(ae):ae;if(dd===rr)try{je=new h().parseFromString(Ln,Hc)}catch{}if(!je||!je.documentElement){je=S.createDocument(dd,"template",null);try{je.documentElement.innerHTML=rm?C:Ln}catch{}}let Ir=je.body||je.documentElement;return ae&&It&&Ir.insertBefore(n.createTextNode(It),Ir.childNodes[0]||null),dd===rr?M.call(je,Br?"html":"body")[0]:Br?je.documentElement:Ir},ve=function(ae){return D.call(ae.ownerDocument||ae,ae,d.SHOW_ELEMENT|d.SHOW_COMMENT|d.SHOW_TEXT,null,!1)},Te=function(ae){return ae instanceof p&&(typeof ae.nodeName!="string"||typeof ae.textContent!="string"||typeof ae.removeChild!="function"||!(ae.attributes instanceof c)||typeof ae.removeAttribute!="function"||typeof ae.setAttribute!="function"||typeof ae.namespaceURI!="string"||typeof ae.insertBefore!="function"||typeof ae.hasChildNodes!="function")},ot=function(ae){return typeof a=="object"?ae instanceof a:ae&&typeof ae=="object"&&typeof ae.nodeType=="number"&&typeof ae.nodeName=="string"},pt=function(ae,je,It){K[ae]&&Jfe(K[ae],Ln=>{Ln.call(t,je,It,ee)})},di=function(ae){let je;if(pt("beforeSanitizeElements",ae,null),Te(ae))return $(ae),!0;let It=Ae(ae.nodeName);if(pt("uponSanitizeElement",ae,{tagName:It,allowedTags:Ce}),ae.hasChildNodes()&&!ot(ae.firstElementChild)&&(!ot(ae.content)||!ot(ae.content.firstElementChild))&&Cd(/<[/\w]/g,ae.innerHTML)&&Cd(/<[/\w]/g,ae.textContent))return $(ae),!0;if(!Ce[It]||at[It]){if(!at[It]&&Gn(It)&&(Mt.tagNameCheck instanceof RegExp&&Cd(Mt.tagNameCheck,It)||Mt.tagNameCheck instanceof Function&&Mt.tagNameCheck(It)))return!1;if(nc&&!Ka[It]){let Ln=y(ae)||ae.parentNode,Ir=I(ae)||ae.childNodes;if(Ir&&Ln){let fa=Ir.length;for(let Uo=fa-1;Uo>=0;--Uo)Ln.insertBefore(g(Ir[Uo],!0),v(ae))}}return $(ae),!0}return ae instanceof l&&!z(ae)||(It==="noscript"||It==="noembed"||It==="noframes")&&Cd(/<\/no(script|embed|frames)/i,ae.innerHTML)?($(ae),!0):(Qi&&ae.nodeType===3&&(je=ae.textContent,je=Zc(je,G," "),je=Zc(je,Y," "),je=Zc(je,ge," "),ae.textContent!==je&&(Y_(t.removed,{element:ae.cloneNode()}),ae.textContent=je)),pt("afterSanitizeElements",ae,null),!1)},Ui=function(ae,je,It){if(nm&&(je==="id"||je==="name")&&(It in n||It in De))return!1;if(!(Ro&&!On[je]&&Cd(xe,je))){if(!(Nn&&Cd(be,je))){if(!pe[je]||On[je]){if(!(Gn(ae)&&(Mt.tagNameCheck instanceof RegExp&&Cd(Mt.tagNameCheck,ae)||Mt.tagNameCheck instanceof Function&&Mt.tagNameCheck(ae))&&(Mt.attributeNameCheck instanceof RegExp&&Cd(Mt.attributeNameCheck,je)||Mt.attributeNameCheck instanceof Function&&Mt.attributeNameCheck(je))||je==="is"&&Mt.allowCustomizedBuiltInElements&&(Mt.tagNameCheck instanceof RegExp&&Cd(Mt.tagNameCheck,It)||Mt.tagNameCheck instanceof Function&&Mt.tagNameCheck(It))))return!1}else if(!cp[je]){if(!Cd(Ee,Zc(It,Le,""))){if(!((je==="src"||je==="xlink:href"||je==="href")&&ae!=="script"&&tbe(It,"data:")===0&&Mv[ae])){if(!(or&&!Cd(fe,Zc(It,Le,"")))){if(It)return!1}}}}}}return!0},Gn=function(ae){return ae.indexOf("-")>0},sr=function(ae){let je,It,Ln,Ir;pt("beforeSanitizeAttributes",ae,null);let{attributes:fa}=ae;if(!fa)return;let Uo={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:pe};for(Ir=fa.length;Ir--;){je=fa[Ir];let{name:hp,namespaceURI:R5}=je;if(It=hp==="value"?je.value:ibe(je.value),Ln=Ae(hp),Uo.attrName=Ln,Uo.attrValue=It,Uo.keepAttr=!0,Uo.forceKeepAttr=void 0,pt("uponSanitizeAttribute",ae,Uo),It=Uo.attrValue,Uo.forceKeepAttr||(te(hp,ae),!Uo.keepAttr))continue;if(!sd&&Cd(/\/>/i,It)){te(hp,ae);continue}Qi&&(It=Zc(It,G," "),It=Zc(It,Y," "),It=Zc(It,ge," "));let qZ=Ae(ae.nodeName);if(Ui(qZ,Ln,It)){if(om&&(Ln==="id"||Ln==="name")&&(te(hp,ae),It=Rt+It),w&&typeof m=="object"&&typeof m.getAttributeType=="function"&&!R5)switch(m.getAttributeType(qZ,Ln)){case"TrustedHTML":{It=w.createHTML(It);break}case"TrustedScriptURL":{It=w.createScriptURL(It);break}}try{R5?ae.setAttributeNS(R5,hp,It):ae.setAttribute(hp,It),Bee(t.removed)}catch{}}}pt("afterSanitizeAttributes",ae,null)},lo=function Dt(ae){let je,It=ve(ae);for(pt("beforeSanitizeShadowDOM",ae,null);je=It.nextNode();)pt("uponSanitizeShadowNode",je,null),!di(je)&&(je.content instanceof o&&Dt(je.content),sr(je));pt("afterSanitizeShadowDOM",ae,null)};return t.sanitize=function(Dt){let ae=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},je,It,Ln,Ir;if(rm=!Dt,rm&&(Dt="<!-->"),typeof Dt!="string"&&!ot(Dt))if(typeof Dt.toString=="function"){if(Dt=Dt.toString(),typeof Dt!="string")throw Q_("dirty is not a string, aborting")}else throw Q_("toString is not a function");if(!t.isSupported)return Dt;if(im||ri(ae),t.removed=[],typeof Dt=="string"&&(Wc=!1),Wc){if(Dt.nodeName){let hp=Ae(Dt.nodeName);if(!Ce[hp]||at[hp])throw Q_("root node is forbidden and cannot be sanitized in-place")}}else if(Dt instanceof a)je=oe("<!---->"),It=je.ownerDocument.importNode(Dt,!0),It.nodeType===1&&It.nodeName==="BODY"||It.nodeName==="HTML"?je=It:je.appendChild(It);else{if(!Vr&&!Qi&&!Br&&Dt.indexOf("<")===-1)return w&&Vc?w.createHTML(Dt):Dt;if(je=oe(Dt),!je)return Vr?null:Vc?C:""}je&&dp&&$(je.firstChild);let fa=ve(Wc?Dt:je);for(;Ln=fa.nextNode();)di(Ln)||(Ln.content instanceof o&&lo(Ln.content),sr(Ln));if(Wc)return Dt;if(Vr){if(Bc)for(Ir=k.call(je.ownerDocument);je.firstChild;)Ir.appendChild(je.firstChild);else Ir=je;return(pe.shadowroot||pe.shadowrootmode)&&(Ir=O.call(e,Ir,!0)),Ir}let Uo=Br?je.outerHTML:je.innerHTML;return Br&&Ce["!doctype"]&&je.ownerDocument&&je.ownerDocument.doctype&&je.ownerDocument.doctype.name&&Cd(qee,je.ownerDocument.doctype.name)&&(Uo="<!DOCTYPE "+je.ownerDocument.doctype.name+`>
`+Uo),Qi&&(Uo=Zc(Uo,G," "),Uo=Zc(Uo,Y," "),Uo=Zc(Uo,ge," ")),w&&Vc?w.createHTML(Uo):Uo},t.setConfig=function(Dt){ri(Dt),im=!0},t.clearConfig=function(){ee=null,im=!1},t.isValidAttribute=function(Dt,ae,je){ee||ri({});let It=Ae(Dt),Ln=Ae(ae);return Ui(It,Ln,je)},t.addHook=function(Dt,ae){typeof ae=="function"&&(K[Dt]=K[Dt]||[],Y_(K[Dt],ae))},t.removeHook=function(Dt){if(K[Dt])return Bee(K[Dt])},t.removeHooks=function(Dt){K[Dt]&&(K[Dt]=[])},t.removeAllHooks=function(){K={}},t}var Tp=$ee();var FAe=Tp.version,BAe=Tp.isSupported,Z_=Tp.sanitize,VAe=Tp.setConfig,WAe=Tp.clearConfig,HAe=Tp.isValidAttribute,MA=Tp.addHook,AA=Tp.removeHook,UAe=Tp.removeHooks,zAe=Tp.removeAllHooks;function wr(r){return eD(r,0)}function eD(r,t){switch(typeof r){case"object":return r===null?wm(349,t):Array.isArray(r)?fbe(r,t):bbe(r,t);case"string":return qS(r,t);case"boolean":return gbe(r,t);case"number":return wm(r,t);case"undefined":return wm(937,t);default:return wm(617,t)}}function wm(r,t){return(t<<5)-t+r|0}function gbe(r,t){return wm(r?433:863,t)}function qS(r,t){t=wm(149417,t);for(let e=0,i=r.length;e<i;e++)t=wm(r.charCodeAt(e),t);return t}function fbe(r,t){return t=wm(104579,t),r.reduce((e,i)=>eD(i,e),t)}function bbe(r,t){return t=wm(181387,t),Object.keys(r).sort().reduce((e,i)=>(e=qS(i,e),eD(r[i],e)),t)}function z4(r,t,e=32){let i=e-t,n=~((1<<i)-1);return(r<<t|(n&r)>>>i)>>>0}function Xee(r,t=0,e=r.byteLength,i=0){for(let n=0;n<e;n++)r[t+n]=i}function vbe(r,t,e="0"){for(;r.length<t;)r=e+r;return r}function J_(r,t=32){return r instanceof ArrayBuffer?Array.from(new Uint8Array(r)).map(e=>e.toString(16).padStart(2,"0")).join(""):vbe((r>>>0).toString(16),t/4)}var OA=class r{static _bigBlock32=new DataView(new ArrayBuffer(320));_h0=1732584193;_h1=4023233417;_h2=2562383102;_h3=271733878;_h4=3285377520;_buff;_buffDV;_buffLen;_totalLen;_leftoverHighSurrogate;_finished;constructor(){this._buff=new Uint8Array(67),this._buffDV=new DataView(this._buff.buffer),this._buffLen=0,this._totalLen=0,this._leftoverHighSurrogate=0,this._finished=!1}update(t){let e=t.length;if(e===0)return;let i=this._buff,n=this._buffLen,o=this._leftoverHighSurrogate,s,a;for(o!==0?(s=o,a=-1,o=0):(s=t.charCodeAt(0),a=0);;){let l=s;if(Rn(s))if(a+1<e){let d=t.charCodeAt(a+1);xp(d)?(a++,l=mA(s,d)):l=65533}else{o=s;break}else xp(s)&&(l=65533);if(n=this._push(i,n,l),a++,a<e)s=t.charCodeAt(a);else break}this._buffLen=n,this._leftoverHighSurrogate=o}_push(t,e,i){return i<128?t[e++]=i:i<2048?(t[e++]=192|(i&1984)>>>6,t[e++]=128|(i&63)>>>0):i<65536?(t[e++]=224|(i&61440)>>>12,t[e++]=128|(i&4032)>>>6,t[e++]=128|(i&63)>>>0):(t[e++]=240|(i&1835008)>>>18,t[e++]=128|(i&258048)>>>12,t[e++]=128|(i&4032)>>>6,t[e++]=128|(i&63)>>>0),e>=64&&(this._step(),e-=64,this._totalLen+=64,t[0]=t[64],t[1]=t[65],t[2]=t[66]),e}digest(){return this._finished||(this._finished=!0,this._leftoverHighSurrogate&&(this._leftoverHighSurrogate=0,this._buffLen=this._push(this._buff,this._buffLen,65533)),this._totalLen+=this._buffLen,this._wrapUp()),J_(this._h0)+J_(this._h1)+J_(this._h2)+J_(this._h3)+J_(this._h4)}_wrapUp(){this._buff[this._buffLen++]=128,Xee(this._buff,this._buffLen),this._buffLen>56&&(this._step(),Xee(this._buff));let t=8*this._totalLen;this._buffDV.setUint32(56,Math.floor(t/4294967296),!1),this._buffDV.setUint32(60,t%4294967296,!1),this._step()}_step(){let t=r._bigBlock32,e=this._buffDV;for(let p=0;p<64;p+=4)t.setUint32(p,e.getUint32(p,!1),!1);for(let p=64;p<320;p+=4)t.setUint32(p,z4(t.getUint32(p-12,!1)^t.getUint32(p-32,!1)^t.getUint32(p-56,!1)^t.getUint32(p-64,!1),1),!1);let i=this._h0,n=this._h1,o=this._h2,s=this._h3,a=this._h4,l,d,c;for(let p=0;p<80;p++)p<20?(l=n&o|~n&s,d=1518500249):p<40?(l=n^o^s,d=1859775393):p<60?(l=n&o|n&s|o&s,d=2400959708):(l=n^o^s,d=3395469782),c=z4(i,5)+l+a+d+t.getUint32(p*4,!1)&4294967295,a=s,s=o,o=z4(n,30),n=i,i=c;this._h0=this._h0+i&4294967295,this._h1=this._h1+n&4294967295,this._h2=this._h2+o&4294967295,this._h3=this._h3+s&4294967295,this._h4=this._h4+a&4294967295}};function pn(r,t,e){return Math.min(Math.max(r,t),e)}var tD=class{_n=1;_val=0;update(t){return this._val=this._val+(t-this._val)/this._n,this._n+=1,this._val}get value(){return this._val}},NA=class{_n=0;_val=0;_values=[];_index=0;_sum=0;constructor(t){this._values=new Array(t),this._values.fill(0,0,t)}update(t){let e=this._values[this._index];return this._values[this._index]=t,this._index=(this._index+1)%this._values.length,this._sum-=e,this._sum+=t,this._n<this._values.length&&(this._n+=1),this._val=this._sum/this._n,this._val}get value(){return this._val}};function Yee(r,t,e,i,n,o,s,a){let l=s-e,d=a-i,c=n-e,p=o-i,h=r-e,m=t-i,f=l*l+d*d,g=l*c+d*p,v=l*h+d*m,I=c*c+p*p,y=c*h+p*m,w=1/(f*I-g*g),C=(I*v-g*y)*w,S=(f*y-g*v)*w;return C>=0&&S>=0&&C+S<1}var{registerWindow:ete,getWindow:ue,getDocument:dOe,getWindows:nD,getWindowsCount:BA,getWindowId:_p,getWindowById:Em,hasWindow:cOe,onDidRegisterWindow:oD,onWillUnregisterWindow:uOe,onDidUnregisterWindow:tte}=function(){let r=new Map;yA(Ke,1);let t={window:Ke,disposables:new B};r.set(Ke.vscodeWindowId,t);let e=new x,i=new x,n=new x;function o(s,a){return(typeof s=="number"?r.get(s):void 0)??(a?t:void 0)}return{onDidRegisterWindow:e.event,onWillUnregisterWindow:n.event,onDidUnregisterWindow:i.event,registerWindow(s){if(r.has(s.vscodeWindowId))return R.None;let a=new B,l={window:s,disposables:a.add(new B)};return r.set(s.vscodeWindowId,l),a.add(le(()=>{r.delete(s.vscodeWindowId),i.fire(s)})),a.add(F(s,Q.BEFORE_UNLOAD,()=>{n.fire(s)})),e.fire(l),a},getWindows(){return r.values()},getWindowsCount(){return r.size},getWindowId(s){return s.vscodeWindowId},hasWindow(s){return r.has(s)},getWindowById:o,getWindow(s){let a=s;if(a?.ownerDocument?.defaultView)return a.ownerDocument.defaultView.window;let l=s;return l?.view?l.view.window:Ke},getDocument(s){return ue(s).document}}}();function ai(r){for(;r.firstChild;)r.firstChild.remove()}var G4=class{_handler;_node;_type;_options;constructor(t,e,i,n){this._node=t,this._type=e,this._handler=i,this._options=n||!1,this._node.addEventListener(this._type,this._handler,this._options)}dispose(){this._handler&&(this._node.removeEventListener(this._type,this._handler,this._options),this._node=null,this._handler=null)}};function F(r,t,e,i){return new G4(r,t,e,i)}function Ibe(r,t){return function(e){return t(new _i(r,e))}}function ybe(r){return function(t){return r(new ut(t))}}var Ut=function(t,e,i,n){let o=i;return e==="click"||e==="mousedown"||e==="contextmenu"?o=Ibe(ue(t),i):(e==="keydown"||e==="keypress"||e==="keyup")&&(o=ybe(i)),F(t,e,o,n)};function ite(r,t,e){return F(r,Hr&&Qc.pointerEvents?Q.POINTER_DOWN:Q.MOUSE_DOWN,t,e)}function nte(r,t,e){return F(r,Hr&&Qc.pointerEvents?Q.POINTER_MOVE:Q.MOUSE_MOVE,t,e)}function $4(r,t,e){return F(r,Hr&&Qc.pointerEvents?Q.POINTER_UP:Q.MOUSE_UP,t,e)}function Jv(r,t,e){return zS(r,t,e)}var cf=class extends $_{constructor(t,e){super(t,e)}},jS,eo;var $S=class extends _A{defaultTarget;constructor(t){super(),this.defaultTarget=t&&ue(t)}cancelAndSet(t,e,i){return super.cancelAndSet(t,e,i??this.defaultTarget)}},iD=class{_runner;priority;_canceled;constructor(t,e=0){this._runner=t,this.priority=e,this._canceled=!1}dispose(){this._canceled=!0}execute(){if(!this._canceled)try{this._runner()}catch(t){Xe(t)}}static sort(t,e){return e.priority-t.priority}};(function(){let r=new Map,t=new Map,e=new Map,i=new Map,n=o=>{e.set(o,!1);let s=r.get(o)??[];for(t.set(o,s),r.set(o,[]),i.set(o,!0);s.length>0;)s.sort(iD.sort),s.shift().execute();i.set(o,!1)};eo=(o,s,a=0)=>{let l=_p(o),d=new iD(s,a),c=r.get(l);return c||(c=[],r.set(l,c)),c.push(d),e.get(l)||(e.set(l,!0),o.requestAnimationFrame(()=>n(l))),d},jS=(o,s,a)=>{let l=_p(o);if(i.get(l)){let d=new iD(s,a),c=t.get(l);return c||(c=[],t.set(l,c)),c.push(d),d}else return eo(o,s,a)}})();function j4(r,t){return eo(r,t,1e4)}function ote(r,t){return eo(r,t,-1e4)}function X4(r){return ue(r).getComputedStyle(r,null)}function Qa(r,t){let e=ue(r),i=e.document;if(r!==i.body)return new Ge(r.clientWidth,r.clientHeight);if(Hr&&e?.visualViewport)return new Ge(e.visualViewport.width,e.visualViewport.height);if(e?.innerWidth&&e.innerHeight)return new Ge(e.innerWidth,e.innerHeight);if(i.body&&i.body.clientWidth&&i.body.clientHeight)return new Ge(i.body.clientWidth,i.body.clientHeight);if(i.documentElement&&i.documentElement.clientWidth&&i.documentElement.clientHeight)return new Ge(i.documentElement.clientWidth,i.documentElement.clientHeight);if(t)return Qa(t);throw new Error("Unable to figure out browser width and height")}var Ia=class r{static convertToPixels(t,e){return parseFloat(e)||0}static getDimension(t,e,i){let n=X4(t),o=n?n.getPropertyValue(e):"0";return r.convertToPixels(t,o)}static getBorderLeftWidth(t){return r.getDimension(t,"border-left-width","borderLeftWidth")}static getBorderRightWidth(t){return r.getDimension(t,"border-right-width","borderRightWidth")}static getBorderTopWidth(t){return r.getDimension(t,"border-top-width","borderTopWidth")}static getBorderBottomWidth(t){return r.getDimension(t,"border-bottom-width","borderBottomWidth")}static getPaddingLeft(t){return r.getDimension(t,"padding-left","paddingLeft")}static getPaddingRight(t){return r.getDimension(t,"padding-right","paddingRight")}static getPaddingTop(t){return r.getDimension(t,"padding-top","paddingTop")}static getPaddingBottom(t){return r.getDimension(t,"padding-bottom","paddingBottom")}static getMarginLeft(t){return r.getDimension(t,"margin-left","marginLeft")}static getMarginTop(t){return r.getDimension(t,"margin-top","marginTop")}static getMarginRight(t){return r.getDimension(t,"margin-right","marginRight")}static getMarginBottom(t){return r.getDimension(t,"margin-bottom","marginBottom")}},Ge=class r{constructor(t,e){this.width=t;this.height=e}static None=new r(0,0);with(t=this.width,e=this.height){return t!==this.width||e!==this.height?new r(t,e):this}static is(t){return typeof t=="object"&&typeof t.height=="number"&&typeof t.width=="number"}static lift(t){return t instanceof r?t:new r(t.width,t.height)}static equals(t,e){return t===e?!0:!t||!e?!1:t.width===e.width&&t.height===e.height}};function rD(r){let t=r.offsetParent,e=r.offsetTop,i=r.offsetLeft;for(;(r=r.parentNode)!==null&&r!==r.ownerDocument.body&&r!==r.ownerDocument.documentElement;){e-=r.scrollTop;let n=ste(r)?null:X4(r);n&&(i-=n.direction!=="rtl"?r.scrollLeft:-r.scrollLeft),r===t&&(i+=Ia.getBorderLeftWidth(r),e+=Ia.getBorderTopWidth(r),e+=r.offsetTop,i+=r.offsetLeft,t=r.offsetParent)}return{left:i,top:e}}function VA(r,t,e){typeof t=="number"&&(r.style.width=`${t}px`),typeof e=="number"&&(r.style.height=`${e}px`)}function rte(r,t,e,i,n,o="absolute"){typeof t=="number"&&(r.style.top=`${t}px`),typeof e=="number"&&(r.style.right=`${e}px`),typeof i=="number"&&(r.style.bottom=`${i}px`),typeof n=="number"&&(r.style.left=`${n}px`),r.style.position=o}function Oi(r){let t=r.getBoundingClientRect(),e=ue(r);return{left:t.left+e.scrollX,top:t.top+e.scrollY,width:t.width,height:t.height}}function Y4(r){let t=r,e=1;do{let i=X4(t).zoom;i!=null&&i!=="1"&&(e*=i),t=t.parentElement}while(t!==null&&t!==t.ownerDocument.documentElement);return e}function xm(r){let t=Ia.getMarginLeft(r)+Ia.getMarginRight(r);return r.offsetWidth+t}function XS(r){let t=Ia.getBorderLeftWidth(r)+Ia.getBorderRightWidth(r),e=Ia.getPaddingLeft(r)+Ia.getPaddingRight(r);return r.offsetWidth-t-e}function WA(r){let t=Ia.getBorderTopWidth(r)+Ia.getBorderBottomWidth(r),e=Ia.getPaddingTop(r)+Ia.getPaddingBottom(r);return r.offsetHeight-t-e}function Tm(r){let t=Ia.getMarginTop(r)+Ia.getMarginBottom(r);return r.offsetHeight+t}function $n(r,t){return!!t?.contains(r)}function Q4(r,t,e){for(;r&&r.nodeType===r.ELEMENT_NODE;){if(r.classList.contains(t))return r;if(e){if(typeof e=="string"){if(r.classList.contains(e))return null}else if(r===e)return null}r=r.parentNode}return null}function HA(r,t,e){return!!Q4(r,t,e)}function ste(r){return r&&!!r.host&&!!r.mode}function sD(r){return!!tu(r)}function tu(r){for(;r.parentNode;){if(r===r.ownerDocument?.body)return null;r=r.parentNode}return ste(r)?r:null}function fo(){let r=pf().activeElement;for(;r?.shadowRoot;)r=r.shadowRoot.activeElement;return r}function fs(r){return fo()===r}function uf(r){return $n(fo(),r)}function Z4(r){return r.ownerDocument===pf()}function pf(){return BA()<=1?Ke.document:Array.from(nD()).map(({window:t})=>t.document).find(t=>t.hasFocus())??Ke.document}function Gr(){return pf().defaultView?.window??Ke}var aD=new Map;function ate(r){return aD.has(r)}function Go(r=Ke.document.head,t,e){let i=document.createElement("style");if(i.type="text/css",i.media="screen",t?.(i),r.appendChild(i),e&&e.add(le(()=>i.remove())),r===Ke.document.head){let n=new Set;aD.set(i,n);for(let{window:o,disposables:s}of nD()){if(o===Ke)continue;let a=s.add(dte(i,n,o));e?.add(a)}}return i}function lte(r){let t=new B;for(let[e,i]of aD)t.add(dte(e,i,r));return t}function dte(r,t,e){let i=new B,n=r.cloneNode(!0);e.document.head.appendChild(n),i.add(le(()=>n.remove()));for(let o of mte(r))n.sheet?.insertRule(o.cssText,n.sheet?.cssRules.length);return i.add(UA.observe(r,i,{childList:!0})(()=>{n.textContent=r.textContent})),t.add(n),i.add(le(()=>t.delete(n))),i}var UA=new class{mutationObservers=new Map;observe(r,t,e){let i=this.mutationObservers.get(r);i||(i=new Map,this.mutationObservers.set(r,i));let n=wr(e),o=i.get(n);if(o)o.users+=1;else{let s=new x,a=new MutationObserver(d=>s.fire(d));a.observe(r,e);let l=o={users:1,observer:a,onDidMutate:s.event};t.add(le(()=>{l.users-=1,l.users===0&&(s.dispose(),a.disconnect(),i?.delete(n),i?.size===0&&this.mutationObservers.delete(r))})),i.set(n,o)}return o.onDidMutate}};function cte(r=Ke.document.head){return pte("meta",r)}function ute(r=Ke.document.head){return pte("link",r)}function pte(r,t=Ke.document.head){let e=document.createElement(r);return t.appendChild(e),e}var K4=null;function hte(){return K4||(K4=Go()),K4}function mte(r){return r?.sheet?.rules?r.sheet.rules:r?.sheet?.cssRules?r.sheet.cssRules:[]}function lD(r,t,e=hte()){if(!(!e||!t)){e.sheet?.insertRule(`${r} {${t}}`,0);for(let i of aD.get(e)??[])lD(r,t,i)}}function zA(r,t=hte()){if(!t)return;let e=mte(t),i=[];for(let n=0;n<e.length;n++){let o=e[n];Sbe(o)&&o.selectorText.indexOf(r)!==-1&&i.push(n)}for(let n=i.length-1;n>=0;n--)t.sheet?.deleteRule(i[n]);for(let n of aD.get(t)??[])zA(r,n)}function Sbe(r){return typeof r.selectorText=="string"}function on(r){return r instanceof HTMLElement||r instanceof ue(r).HTMLElement}function gte(r){return r instanceof SVGElement||r instanceof ue(r).SVGElement}function Za(r){return r instanceof MouseEvent||r instanceof ue(r).MouseEvent}function El(r){return r instanceof KeyboardEvent||r instanceof ue(r).KeyboardEvent}var Q={CLICK:"click",AUXCLICK:"auxclick",DBLCLICK:"dblclick",MOUSE_UP:"mouseup",MOUSE_DOWN:"mousedown",MOUSE_OVER:"mouseover",MOUSE_MOVE:"mousemove",MOUSE_OUT:"mouseout",MOUSE_ENTER:"mouseenter",MOUSE_LEAVE:"mouseleave",MOUSE_WHEEL:"wheel",POINTER_UP:"pointerup",POINTER_DOWN:"pointerdown",POINTER_MOVE:"pointermove",POINTER_LEAVE:"pointerleave",CONTEXT_MENU:"contextmenu",WHEEL:"wheel",KEY_DOWN:"keydown",KEY_PRESS:"keypress",KEY_UP:"keyup",LOAD:"load",BEFORE_UNLOAD:"beforeunload",UNLOAD:"unload",PAGE_SHOW:"pageshow",PAGE_HIDE:"pagehide",PASTE:"paste",ABORT:"abort",ERROR:"error",RESIZE:"resize",SCROLL:"scroll",FULLSCREEN_CHANGE:"fullscreenchange",WK_FULLSCREEN_CHANGE:"webkitfullscreenchange",SELECT:"select",CHANGE:"change",SUBMIT:"submit",RESET:"reset",FOCUS:"focus",FOCUS_IN:"focusin",FOCUS_OUT:"focusout",BLUR:"blur",INPUT:"input",STORAGE:"storage",DRAG_START:"dragstart",DRAG:"drag",DRAG_ENTER:"dragenter",DRAG_LEAVE:"dragleave",DRAG_OVER:"dragover",DROP:"drop",DRAG_END:"dragend",ANIMATION_START:Yc?"webkitAnimationStart":"animationstart",ANIMATION_END:Yc?"webkitAnimationEnd":"animationend",ANIMATION_ITERATION:Yc?"webkitAnimationIteration":"animationiteration"};var Ve={stop:(r,t)=>(r.preventDefault(),t&&r.stopPropagation(),r)};function fte(r){let t=[];for(let e=0;r&&r.nodeType===r.ELEMENT_NODE;e++)t[e]=r.scrollTop,r=r.parentNode;return t}function bte(r,t){for(let e=0;r&&r.nodeType===r.ELEMENT_NODE;e++)r.scrollTop!==t[e]&&(r.scrollTop=t[e]),r=r.parentNode}var q4=class r extends R{_onDidFocus=this._register(new x);onDidFocus=this._onDidFocus.event;_onDidBlur=this._register(new x);onDidBlur=this._onDidBlur.event;_refreshStateHandler;static hasFocusWithin(t){if(on(t)){let e=tu(t),i=e?e.activeElement:t.ownerDocument.activeElement;return $n(i,t)}else{let e=t;return $n(e.document.activeElement,e.document)}}constructor(t){super();let e=r.hasFocusWithin(t),i=!1,n=()=>{i=!1,e||(e=!0,this._onDidFocus.fire())},o=()=>{e&&(i=!0,(on(t)?ue(t):t).setTimeout(()=>{i&&(i=!1,e=!1,this._onDidBlur.fire())},0))};this._refreshStateHandler=()=>{r.hasFocusWithin(t)!==e&&(e?o():n())},this._register(F(t,Q.FOCUS,n,!0)),this._register(F(t,Q.BLUR,o,!0)),on(t)&&(this._register(F(t,Q.FOCUS_IN,()=>this._refreshStateHandler())),this._register(F(t,Q.FOCUS_OUT,()=>this._refreshStateHandler())))}refreshState(){this._refreshStateHandler()}};function Er(r){return new q4(r)}function KA(r,t){return r.after(t),t}function U(r,...t){if(r.append(...t),t.length===1&&typeof t[0]!="string")return t[0]}function eI(r,t){return r.insertBefore(t,r.firstChild),t}function bo(r,...t){r.innerText="",U(r,...t)}var Cbe=/([\w\-]+)?(#([\w\-]+))?((\.([\w\-]+))*)/;function vte(r,t,e,...i){let n=Cbe.exec(t);if(!n)throw new Error("Bad use of emmet");let o=n[1]||"div",s;return r!=="http://www.w3.org/1999/xhtml"?s=document.createElementNS(r,o):s=document.createElement(o),n[3]&&(s.id=n[3]),n[4]&&(s.className=n[4].replace(/\./g," ").trim()),e&&Object.entries(e).forEach(([a,l])=>{typeof l>"u"||(/^on\w+$/.test(a)?s[a]=l:a==="selected"?l&&s.setAttribute(a,"true"):s.setAttribute(a,l))}),s.append(...i),s}function J(r,t,...e){return vte("http://www.w3.org/1999/xhtml",r,t,...e)}J.SVG=function(r,t,...e){return vte("http://www.w3.org/2000/svg",r,t,...e)};function rn(...r){for(let t of r)t.style.display="",t.removeAttribute("aria-hidden")}function ji(...r){for(let t of r)t.style.display="none",t.setAttribute("aria-hidden","true")}function J4(r,t){let e=r.devicePixelRatio*t;return Math.max(1,Math.floor(e))/r.devicePixelRatio}function eK(r){Ke.open(r,"_blank","noopener")}var Qee=780,Zee=640;function tK(r){let t=Math.floor(Ke.screenLeft+Ke.innerWidth/2-Qee/2),e=Math.floor(Ke.screenTop+Ke.innerHeight/2-Zee/2);Ke.open(r,"_blank",`width=${Qee},height=${Zee},top=${e},left=${t}`)}function Ite(r,t=!0){let e=Ke.open();return e?(t&&(e.opener=null),e.location.href=r,!0):!1}function yte(r,t){let e=()=>{t(),i=eo(r,e)},i=eo(r,e);return le(()=>i.dispose())}z_.setPreferredWebSchema(/^https:/.test(Ke.location.href)?"https":"http");function Dp(r){return r?`url('${Ao.uriToBrowserUri(r).toString(!0).replace(/'/g,"%27")}')`:"url('')"}function Ja(r,t){if(r!==void 0){let e=r.match(/^\s*var\((.+)\)$/);if(e){let i=e[1].split(",",2);return i.length===2&&(t=Ja(i[1].trim(),t)),`var(${i[0]}, ${t})`}return r}return t}function Ste(r,t=!1){let e=document.createElement("a");return MA("afterSanitizeAttributes",i=>{for(let n of["href","src"])if(i.hasAttribute(n)){let o=i.getAttribute(n);if(n==="href"&&o.startsWith("#"))continue;if(e.href=o,!r.includes(e.protocol.replace(/:$/,""))){if(t&&n==="src"&&e.href.startsWith("data:"))continue;i.removeAttribute(n)}}}),le(()=>{AA("afterSanitizeAttributes")})}var pOe=[Ie.http,Ie.https,Ie.command],Cte=Object.freeze(["a","abbr","b","bdo","blockquote","br","caption","cite","code","col","colgroup","dd","del","details","dfn","div","dl","dt","em","figcaption","figure","h1","h2","h3","h4","h5","h6","hr","i","img","input","ins","kbd","label","li","mark","ol","p","pre","q","rp","rt","ruby","samp","small","small","source","span","strike","strong","sub","summary","sup","table","tbody","td","tfoot","th","thead","time","tr","tt","u","ul","var","video","wbr"]),hOe=Object.freeze({ALLOWED_TAGS:["a","button","blockquote","code","div","h1","h2","h3","h4","h5","h6","hr","input","label","li","p","pre","select","small","span","strong","textarea","ul","ol"],ALLOWED_ATTR:["href","data-href","data-command","target","title","name","src","alt","class","id","role","tabindex","style","data-code","width","height","align","x-dispatch","required","checked","placeholder","type","start"],RETURN_DOM:!1,RETURN_DOM_FRAGMENT:!1,RETURN_TRUSTED_TYPE:!0});function wbe(r){let t=new Uint16Array(r.length);for(let n=0;n<t.length;n++)t[n]=r.charCodeAt(n);let e="",i=new Uint8Array(t.buffer);for(let n=0;n<i.length;n++)e+=String.fromCharCode(i[n]);return e}function YS(r){return btoa(wbe(r))}var eu=class r extends x{_subscriptions=new B;_keyStatus;static instance;constructor(){super(),this._keyStatus={altKey:!1,shiftKey:!1,ctrlKey:!1,metaKey:!1},this._subscriptions.add(X.runAndSubscribe(oD,({window:t,disposables:e})=>this.registerListeners(t,e),{window:Ke,disposables:this._subscriptions}))}registerListeners(t,e){e.add(F(t,"keydown",i=>{if(i.defaultPrevented)return;let n=new ut(i);if(!(n.keyCode===6&&i.repeat)){if(i.altKey&&!this._keyStatus.altKey)this._keyStatus.lastKeyPressed="alt";else if(i.ctrlKey&&!this._keyStatus.ctrlKey)this._keyStatus.lastKeyPressed="ctrl";else if(i.metaKey&&!this._keyStatus.metaKey)this._keyStatus.lastKeyPressed="meta";else if(i.shiftKey&&!this._keyStatus.shiftKey)this._keyStatus.lastKeyPressed="shift";else if(n.keyCode!==6)this._keyStatus.lastKeyPressed=void 0;else return;this._keyStatus.altKey=i.altKey,this._keyStatus.ctrlKey=i.ctrlKey,this._keyStatus.metaKey=i.metaKey,this._keyStatus.shiftKey=i.shiftKey,this._keyStatus.lastKeyPressed&&(this._keyStatus.event=i,this.fire(this._keyStatus))}},!0)),e.add(F(t,"keyup",i=>{i.defaultPrevented||(!i.altKey&&this._keyStatus.altKey?this._keyStatus.lastKeyReleased="alt":!i.ctrlKey&&this._keyStatus.ctrlKey?this._keyStatus.lastKeyReleased="ctrl":!i.metaKey&&this._keyStatus.metaKey?this._keyStatus.lastKeyReleased="meta":!i.shiftKey&&this._keyStatus.shiftKey?this._keyStatus.lastKeyReleased="shift":this._keyStatus.lastKeyReleased=void 0,this._keyStatus.lastKeyPressed!==this._keyStatus.lastKeyReleased&&(this._keyStatus.lastKeyPressed=void 0),this._keyStatus.altKey=i.altKey,this._keyStatus.ctrlKey=i.ctrlKey,this._keyStatus.metaKey=i.metaKey,this._keyStatus.shiftKey=i.shiftKey,this._keyStatus.lastKeyReleased&&(this._keyStatus.event=i,this.fire(this._keyStatus)))},!0)),e.add(F(t.document.body,"mousedown",()=>{this._keyStatus.lastKeyPressed=void 0},!0)),e.add(F(t.document.body,"mouseup",()=>{this._keyStatus.lastKeyPressed=void 0},!0)),e.add(F(t.document.body,"mousemove",i=>{i.buttons&&(this._keyStatus.lastKeyPressed=void 0)},!0)),e.add(F(t,"blur",()=>{this.resetKeyStatus()}))}get keyStatus(){return this._keyStatus}get isModifierPressed(){return this._keyStatus.altKey||this._keyStatus.ctrlKey||this._keyStatus.metaKey||this._keyStatus.shiftKey}resetKeyStatus(){this.doResetKeyStatus(),this.fire(this._keyStatus)}doResetKeyStatus(){this._keyStatus={altKey:!1,shiftKey:!1,ctrlKey:!1,metaKey:!1}}static getInstance(){return r.instance||(r.instance=new r),r.instance}dispose(){super.dispose(),this._subscriptions.dispose()}};var wl=class extends R{constructor(e,i){super();this.element=e;this.callbacks=i;this.registerListeners()}counter=0;dragStartTime=0;registerListeners(){this.callbacks.onDragStart&&this._register(F(this.element,Q.DRAG_START,e=>{this.callbacks.onDragStart?.(e)})),this.callbacks.onDrag&&this._register(F(this.element,Q.DRAG,e=>{this.callbacks.onDrag?.(e)})),this._register(F(this.element,Q.DRAG_ENTER,e=>{this.counter++,this.dragStartTime=e.timeStamp,this.callbacks.onDragEnter?.(e)})),this._register(F(this.element,Q.DRAG_OVER,e=>{e.preventDefault(),this.callbacks.onDragOver?.(e,e.timeStamp-this.dragStartTime)})),this._register(F(this.element,Q.DRAG_LEAVE,e=>{this.counter--,this.counter===0&&(this.dragStartTime=0,this.callbacks.onDragLeave?.(e))})),this._register(F(this.element,Q.DRAG_END,e=>{this.counter=0,this.dragStartTime=0,this.callbacks.onDragEnd?.(e)})),this._register(F(this.element,Q.DROP,e=>{this.counter=0,this.dragStartTime=0,this.callbacks.onDrop?.(e)}))}},Ebe=/(?<tag>[\w\-]+)?(?:#(?<id>[\w\-]+))?(?<class>(?:\.(?:[\w\-]+))*)(?:@(?<name>(?:[\w\_])+))?/;function wi(r,...t){let e,i;Array.isArray(t[0])?(e={},i=t[0]):(e=t[0]||{},i=t[1]);let n=Ebe.exec(r);if(!n||!n.groups)throw new Error("Bad use of h");let o=n.groups.tag||"div",s=document.createElement(o);n.groups.id&&(s.id=n.groups.id);let a=[];if(n.groups.class)for(let d of n.groups.class.split("."))d!==""&&a.push(d);if(e.className!==void 0)for(let d of e.className.split("."))d!==""&&a.push(d);a.length>0&&(s.className=a.join(" "));let l={};if(n.groups.name&&(l[n.groups.name]=s),i)for(let d of i)on(d)?s.appendChild(d):typeof d=="string"?s.append(d):"root"in d&&(Object.assign(l,d),s.appendChild(d.root));for(let[d,c]of Object.entries(e))if(d!=="className")if(d==="style")for(let[p,h]of Object.entries(c))s.style.setProperty(Jee(p),typeof h=="number"?h+"px":""+h);else d==="tabIndex"?s.tabIndex=c:s.setAttribute(Jee(d),c.toString());return l.root=s,l}function Jee(r){return r.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function GA(r,t,e){for(let{name:i,value:n}of r.attributes)(!e||e.includes(i))&&t.setAttribute(i,n)}function xbe(r,t,e){let i=r.getAttribute(e);i?t.setAttribute(e,i):t.removeAttribute(e)}function qA(r,t,e){GA(r,t,e);let i=new B;return i.add(UA.observe(r,i,{attributes:!0,attributeFilter:e})(n=>{for(let o of n)o.type==="attributes"&&o.attributeName&&xbe(r,t,o.attributeName)})),i}function dc(r){return r.tagName.toLowerCase()==="input"||r.tagName.toLowerCase()==="textarea"||on(r)&&!!r.editContext}var FA=class{constructor(t,e,i){this.originX=t;this.originY=e;let{top:n,left:o,right:s,bottom:a}=i.getBoundingClientRect(),l=this.points,d=0;l[d++]=o,l[d++]=n,l[d++]=s,l[d++]=n,l[d++]=o,l[d++]=a,l[d++]=s,l[d++]=a}points=new Int16Array(8);contains(t,e){let{points:i,originX:n,originY:o}=this;for(let s=0;s<4;s++){let a=2*s,l=2*((s+1)%4);if(Yee(t,e,n,o,i[a],i[a+1],i[l],i[l+1]))return!0}return!1}};function Re(r,t,e){let i=null,n=null;if(typeof e.value=="function"?(i="value",n=e.value,n.length!==0&&console.warn("Memoize should only be used in functions with zero parameters")):typeof e.get=="function"&&(i="get",n=e.get),!n)throw new Error("not supported");let o=`$memoize$${t}`;e[i]=function(...s){return this.hasOwnProperty(o)||Object.defineProperty(this,o,{configurable:!1,enumerable:!1,writable:!1,value:n.apply(this,s)}),this[o]}}var At;(o=>(o.Tap="-monaco-gesturetap",o.Change="-monaco-gesturechange",o.Start="-monaco-gesturestart",o.End="-monaco-gesturesend",o.Contextmenu="-monaco-gesturecontextmenu"))(At||={});var Fs=class Fs extends R{static SCROLL_FRICTION=-.005;static INSTANCE;static HOLD_DELAY=700;dispatched=!1;targets=new lr;ignoreTargets=new lr;handle;activeTouches;_lastSetTapCountTime;static CLEAR_TAP_COUNT_TIME=400;constructor(){super(),this.activeTouches={},this.handle=null,this._lastSetTapCountTime=0,this._register(X.runAndSubscribe(oD,({window:t,disposables:e})=>{e.add(F(t.document,"touchstart",i=>this.onTouchStart(i),{passive:!1})),e.add(F(t.document,"touchend",i=>this.onTouchEnd(t,i))),e.add(F(t.document,"touchmove",i=>this.onTouchMove(i),{passive:!1}))},{window:Ke,disposables:this._store}))}static addTarget(t){if(!Fs.isTouchDevice())return R.None;Fs.INSTANCE||(Fs.INSTANCE=rc(new Fs));let e=Fs.INSTANCE.targets.push(t);return le(e)}static ignoreTarget(t){if(!Fs.isTouchDevice())return R.None;Fs.INSTANCE||(Fs.INSTANCE=rc(new Fs));let e=Fs.INSTANCE.ignoreTargets.push(t);return le(e)}static isTouchDevice(){return"ontouchstart"in Ke||navigator.maxTouchPoints>0}dispose(){this.handle&&(this.handle.dispose(),this.handle=null),super.dispose()}onTouchStart(t){let e=Date.now();this.handle&&(this.handle.dispose(),this.handle=null);for(let i=0,n=t.targetTouches.length;i<n;i++){let o=t.targetTouches.item(i);this.activeTouches[o.identifier]={id:o.identifier,initialTarget:o.target,initialTimeStamp:e,initialPageX:o.pageX,initialPageY:o.pageY,rollingTimestamps:[e],rollingPageX:[o.pageX],rollingPageY:[o.pageY]};let s=this.newGestureEvent(At.Start,o.target);s.pageX=o.pageX,s.pageY=o.pageY,this.dispatchEvent(s)}this.dispatched&&(t.preventDefault(),t.stopPropagation(),this.dispatched=!1)}onTouchEnd(t,e){let i=Date.now(),n=Object.keys(this.activeTouches).length;for(let o=0,s=e.changedTouches.length;o<s;o++){let a=e.changedTouches.item(o);if(!this.activeTouches.hasOwnProperty(String(a.identifier))){console.warn("move of an UNKNOWN touch",a);continue}let l=this.activeTouches[a.identifier],d=Date.now()-l.initialTimeStamp;if(d<Fs.HOLD_DELAY&&Math.abs(l.initialPageX-ls(l.rollingPageX))<30&&Math.abs(l.initialPageY-ls(l.rollingPageY))<30){let c=this.newGestureEvent(At.Tap,l.initialTarget);c.pageX=ls(l.rollingPageX),c.pageY=ls(l.rollingPageY),this.dispatchEvent(c)}else if(d>=Fs.HOLD_DELAY&&Math.abs(l.initialPageX-ls(l.rollingPageX))<30&&Math.abs(l.initialPageY-ls(l.rollingPageY))<30){let c=this.newGestureEvent(At.Contextmenu,l.initialTarget);c.pageX=ls(l.rollingPageX),c.pageY=ls(l.rollingPageY),this.dispatchEvent(c)}else if(n===1){let c=ls(l.rollingPageX),p=ls(l.rollingPageY),h=ls(l.rollingTimestamps)-l.rollingTimestamps[0],m=c-l.rollingPageX[0],f=p-l.rollingPageY[0],g=[...this.targets].filter(v=>l.initialTarget instanceof Node&&v.contains(l.initialTarget));this.inertia(t,g,i,Math.abs(m)/h,m>0?1:-1,c,Math.abs(f)/h,f>0?1:-1,p)}this.dispatchEvent(this.newGestureEvent(At.End,l.initialTarget)),delete this.activeTouches[a.identifier]}this.dispatched&&(e.preventDefault(),e.stopPropagation(),this.dispatched=!1)}newGestureEvent(t,e){let i=document.createEvent("CustomEvent");return i.initEvent(t,!1,!0),i.initialTarget=e,i.tapCount=0,i}dispatchEvent(t){if(t.type===At.Tap){let e=new Date().getTime(),i=0;e-this._lastSetTapCountTime>Fs.CLEAR_TAP_COUNT_TIME?i=1:i=2,this._lastSetTapCountTime=e,t.tapCount=i}else(t.type===At.Change||t.type===At.Contextmenu)&&(this._lastSetTapCountTime=0);if(t.initialTarget instanceof Node){for(let i of this.ignoreTargets)if(i.contains(t.initialTarget))return;let e=[];for(let i of this.targets)if(i.contains(t.initialTarget)){let n=0,o=t.initialTarget;for(;o&&o!==i;)n++,o=o.parentElement;e.push([n,i])}e.sort((i,n)=>i[0]-n[0]);for(let[i,n]of e)n.dispatchEvent(t),this.dispatched=!0}}inertia(t,e,i,n,o,s,a,l,d){this.handle=eo(t,()=>{let c=Date.now(),p=c-i,h=0,m=0,f=!0;n+=Fs.SCROLL_FRICTION*p,a+=Fs.SCROLL_FRICTION*p,n>0&&(f=!1,h=o*n*p),a>0&&(f=!1,m=l*a*p);let g=this.newGestureEvent(At.Change);g.translationX=h,g.translationY=m,e.forEach(v=>v.dispatchEvent(g)),f||this.inertia(t,e,c,n,o,s+h,a,l,d+m)})}onTouchMove(t){let e=Date.now();for(let i=0,n=t.changedTouches.length;i<n;i++){let o=t.changedTouches.item(i);if(!this.activeTouches.hasOwnProperty(String(o.identifier))){console.warn("end of an UNKNOWN touch",o);continue}let s=this.activeTouches[o.identifier],a=this.newGestureEvent(At.Change,s.initialTarget);a.translationX=o.pageX-ls(s.rollingPageX),a.translationY=o.pageY-ls(s.rollingPageY),a.pageX=o.pageX,a.pageY=o.pageY,this.dispatchEvent(a),s.rollingPageX.length>3&&(s.rollingPageX.shift(),s.rollingPageY.shift(),s.rollingTimestamps.shift()),s.rollingPageX.push(o.pageX),s.rollingPageY.push(o.pageY),s.rollingTimestamps.push(e)}this.dispatched&&(t.preventDefault(),t.stopPropagation(),this.dispatched=!1)}};E([Re],Fs,"isTouchDevice",1);var yi=Fs;var lt=class{emitter;get event(){return this.emitter.event}constructor(t,e,i){let n=o=>this.emitter.fire(o);this.emitter=new x({onWillAddFirstListener:()=>t.addEventListener(e,n,i),onDidRemoveLastListener:()=>t.removeEventListener(e,n,i)})}dispose(){this.emitter.dispose()}};var Tbe=!1;var _be=4,Dbe=new x;var kbe=300,Lbe=new x;var dD=class{constructor(t){this.el=t}disposables=new B;get onPointerMove(){return this.disposables.add(new lt(ue(this.el),"mousemove")).event}get onPointerUp(){return this.disposables.add(new lt(ue(this.el),"mouseup")).event}dispose(){this.disposables.dispose()}};E([Re],dD.prototype,"onPointerMove",1),E([Re],dD.prototype,"onPointerUp",1);var cD=class{constructor(t){this.el=t}disposables=new B;get onPointerMove(){return this.disposables.add(new lt(this.el,At.Change)).event}get onPointerUp(){return this.disposables.add(new lt(this.el,At.End)).event}dispose(){this.disposables.dispose()}};E([Re],cD.prototype,"onPointerMove",1),E([Re],cD.prototype,"onPointerUp",1);var QS=class{constructor(t){this.factory=t}get onPointerMove(){return this.factory.onPointerMove}get onPointerUp(){return this.factory.onPointerUp}dispose(){}};E([Re],QS.prototype,"onPointerMove",1),E([Re],QS.prototype,"onPointerUp",1);var wte="pointer-events-disabled",xl=class r extends R{el;layoutProvider;orientation;size;hoverDelay=kbe;hoverDelayer=this._register(new yd(this.hoverDelay));_state=3;onDidEnablementChange=this._register(new x);_onDidStart=this._register(new x);_onDidChange=this._register(new x);_onDidReset=this._register(new x);_onDidEnd=this._register(new x);orthogonalStartSashDisposables=this._register(new B);_orthogonalStartSash;orthogonalStartDragHandleDisposables=this._register(new B);_orthogonalStartDragHandle;orthogonalEndSashDisposables=this._register(new B);_orthogonalEndSash;orthogonalEndDragHandleDisposables=this._register(new B);_orthogonalEndDragHandle;get state(){return this._state}get orthogonalStartSash(){return this._orthogonalStartSash}get orthogonalEndSash(){return this._orthogonalEndSash}set state(t){this._state!==t&&(this.el.classList.toggle("disabled",t===0),this.el.classList.toggle("minimum",t===1),this.el.classList.toggle("maximum",t===2),this._state=t,this.onDidEnablementChange.fire(t))}onDidStart=this._onDidStart.event;onDidChange=this._onDidChange.event;onDidReset=this._onDidReset.event;onDidEnd=this._onDidEnd.event;linkedSash=void 0;set orthogonalStartSash(t){if(this._orthogonalStartSash!==t){if(this.orthogonalStartDragHandleDisposables.clear(),this.orthogonalStartSashDisposables.clear(),t){let e=i=>{this.orthogonalStartDragHandleDisposables.clear(),i!==0&&(this._orthogonalStartDragHandle=U(this.el,J(".orthogonal-drag-handle.start")),this.orthogonalStartDragHandleDisposables.add(le(()=>this._orthogonalStartDragHandle.remove())),this.orthogonalStartDragHandleDisposables.add(new lt(this._orthogonalStartDragHandle,"mouseenter")).event(()=>r.onMouseEnter(t),void 0,this.orthogonalStartDragHandleDisposables),this.orthogonalStartDragHandleDisposables.add(new lt(this._orthogonalStartDragHandle,"mouseleave")).event(()=>r.onMouseLeave(t),void 0,this.orthogonalStartDragHandleDisposables))};this.orthogonalStartSashDisposables.add(t.onDidEnablementChange.event(e,this)),e(t.state)}this._orthogonalStartSash=t}}set orthogonalEndSash(t){if(this._orthogonalEndSash!==t){if(this.orthogonalEndDragHandleDisposables.clear(),this.orthogonalEndSashDisposables.clear(),t){let e=i=>{this.orthogonalEndDragHandleDisposables.clear(),i!==0&&(this._orthogonalEndDragHandle=U(this.el,J(".orthogonal-drag-handle.end")),this.orthogonalEndDragHandleDisposables.add(le(()=>this._orthogonalEndDragHandle.remove())),this.orthogonalEndDragHandleDisposables.add(new lt(this._orthogonalEndDragHandle,"mouseenter")).event(()=>r.onMouseEnter(t),void 0,this.orthogonalEndDragHandleDisposables),this.orthogonalEndDragHandleDisposables.add(new lt(this._orthogonalEndDragHandle,"mouseleave")).event(()=>r.onMouseLeave(t),void 0,this.orthogonalEndDragHandleDisposables))};this.orthogonalEndSashDisposables.add(t.onDidEnablementChange.event(e,this)),e(t.state)}this._orthogonalEndSash=t}}constructor(t,e,i){super(),this.el=U(t,J(".monaco-sash")),i.orthogonalEdge&&this.el.classList.add(`orthogonal-edge-${i.orthogonalEdge}`),ye&&this.el.classList.add("mac");let n=this._register(new lt(this.el,"mousedown")).event;this._register(n(p=>this.onPointerStart(p,new dD(t)),this));let o=this._register(new lt(this.el,"dblclick")).event;this._register(o(this.onPointerDoublePress,this));let s=this._register(new lt(this.el,"mouseenter")).event;this._register(s(()=>r.onMouseEnter(this)));let a=this._register(new lt(this.el,"mouseleave")).event;this._register(a(()=>r.onMouseLeave(this))),this._register(yi.addTarget(this.el));let l=this._register(new lt(this.el,At.Start)).event;this._register(l(p=>this.onPointerStart(p,new cD(this.el)),this));let d=this._register(new lt(this.el,At.Tap)).event,c;this._register(d(p=>{if(c){clearTimeout(c),c=void 0,this.onPointerDoublePress(p);return}clearTimeout(c),c=setTimeout(()=>c=void 0,250)},this)),typeof i.size=="number"?(this.size=i.size,i.orientation===0?this.el.style.width=`${this.size}px`:this.el.style.height=`${this.size}px`):(this.size=_be,this._register(Dbe.event(p=>{this.size=p,this.layout()}))),this._register(Lbe.event(p=>this.hoverDelay=p)),this.layoutProvider=e,this.orthogonalStartSash=i.orthogonalStartSash,this.orthogonalEndSash=i.orthogonalEndSash,this.orientation=i.orientation||0,this.orientation===1?(this.el.classList.add("horizontal"),this.el.classList.remove("vertical")):(this.el.classList.remove("horizontal"),this.el.classList.add("vertical")),this.el.classList.toggle("debug",Tbe),this.layout()}onPointerStart(t,e){Ve.stop(t);let i=!1;if(!t.__orthogonalSashEvent){let f=this.getOrthogonalSash(t);f&&(i=!0,t.__orthogonalSashEvent=!0,f.onPointerStart(t,new QS(e)))}if(this.linkedSash&&!t.__linkedSashEvent&&(t.__linkedSashEvent=!0,this.linkedSash.onPointerStart(t,new QS(e))),!this.state)return;let n=this.el.ownerDocument.getElementsByTagName("iframe");for(let f of n)f.classList.add(wte);let o=t.pageX,s=t.pageY,a=t.altKey,l={startX:o,currentX:o,startY:s,currentY:s,altKey:a};this.el.classList.add("active"),this._onDidStart.fire(l);let d=Go(this.el),c=()=>{let f="";i?f="all-scroll":this.orientation===1?this.state===1?f="s-resize":this.state===2?f="n-resize":f=ye?"row-resize":"ns-resize":this.state===1?f="e-resize":this.state===2?f="w-resize":f=ye?"col-resize":"ew-resize",d.textContent=`* { cursor: ${f} !important; }`},p=new B;c(),i||this.onDidEnablementChange.event(c,null,p);let h=f=>{Ve.stop(f,!1);let g={startX:o,currentX:f.pageX,startY:s,currentY:f.pageY,altKey:a};this._onDidChange.fire(g)},m=f=>{Ve.stop(f,!1),d.remove(),this.el.classList.remove("active"),this._onDidEnd.fire(),p.dispose();for(let g of n)g.classList.remove(wte)};e.onPointerMove(h,null,p),e.onPointerUp(m,null,p),p.add(e)}onPointerDoublePress(t){let e=this.getOrthogonalSash(t);e&&e._onDidReset.fire(),this.linkedSash&&this.linkedSash._onDidReset.fire(),this._onDidReset.fire()}static onMouseEnter(t,e=!1){t.el.classList.contains("active")?(t.hoverDelayer.cancel(),t.el.classList.add("hover")):t.hoverDelayer.trigger(()=>t.el.classList.add("hover"),t.hoverDelay).then(void 0,()=>{}),!e&&t.linkedSash&&r.onMouseEnter(t.linkedSash,!0)}static onMouseLeave(t,e=!1){t.hoverDelayer.cancel(),t.el.classList.remove("hover"),!e&&t.linkedSash&&r.onMouseLeave(t.linkedSash,!0)}clearSashHoverState(){r.onMouseLeave(this)}layout(){if(this.orientation===0){let t=this.layoutProvider;this.el.style.left=t.getVerticalSashLeft(this)-this.size/2+"px",t.getVerticalSashTop&&(this.el.style.top=t.getVerticalSashTop(this)+"px"),t.getVerticalSashHeight&&(this.el.style.height=t.getVerticalSashHeight(this)+"px")}else{let t=this.layoutProvider;this.el.style.top=t.getHorizontalSashTop(this)-this.size/2+"px",t.getHorizontalSashLeft&&(this.el.style.left=t.getHorizontalSashLeft(this)+"px"),t.getHorizontalSashWidth&&(this.el.style.width=t.getHorizontalSashWidth(this)+"px")}}getOrthogonalSash(t){let e=t.initialTarget??t.target;if(!(!e||!on(e))&&e.classList.contains("orthogonal-drag-handle"))return e.classList.contains("start")?this.orthogonalStartSash:this.orthogonalEndSash}dispose(){super.dispose(),this.el.remove()}};function Xi(r){if(!r||typeof r!="object"||r instanceof RegExp)return r;let t=Array.isArray(r)?[]:{};return Object.entries(r).forEach(([e,i])=>{t[e]=i&&typeof i=="object"?Xi(i):i}),t}var Rbe=Object.prototype.hasOwnProperty;function nK(r,t){return iK(r,t,new Set)}function iK(r,t,e){if(Wn(r))return r;let i=t(r);if(typeof i<"u")return i;if(Array.isArray(r)){let n=[];for(let o of r)n.push(iK(o,t,e));return n}if(vi(r)){if(e.has(r))throw new Error("Cannot clone recursive data-structure");e.add(r);let n={};for(let o in r)Rbe.call(r,o)&&(n[o]=iK(r[o],t,e));return e.delete(r),n}return r}function Bs(r,t,e=!0){return vi(r)?(vi(t)&&Object.keys(t).forEach(i=>{i in r?e&&(vi(r[i])&&vi(t[i])?Bs(r[i],t[i],e):r[i]=t[i]):r[i]=t[i]}),r):t}function sn(r,t){if(r===t)return!0;if(r==null||t===null||t===void 0||typeof r!=typeof t||typeof r!="object"||Array.isArray(r)!==Array.isArray(t))return!1;let e,i;if(Array.isArray(r)){if(r.length!==t.length)return!1;for(e=0;e<r.length;e++)if(!sn(r[e],t[e]))return!1}else{let n=[];for(i in r)n.push(i);n.sort();let o=[];for(i in t)o.push(i);if(o.sort(),!sn(n,o))return!1;for(e=0;e<n.length;e++)if(!sn(r[n[e]],t[n[e]]))return!1}return!0}function Ete(r,t){let e=Object.create(null);return!r||!t||Object.keys(t).forEach(n=>{let o=r[n],s=t[n];sn(o,s)||(e[n]=s)}),e}function xte(r,t){let e=Object.create(null);for(let[i,n]of Object.entries(r))t(i,n)&&(e[i]=n);return e}function Tte(r,t){let e={};for(let[i,n]of Object.entries(r))e[i]=t(n,i);return e}var ZS=class extends R{_onDidChange=this._register(new x);onDidChange=this._onDidChange.event;_referenceDomElement;_width;_height;_resizeObserver;constructor(t,e){super(),this._referenceDomElement=t,this._width=-1,this._height=-1,this._resizeObserver=null,this.measureReferenceDomElement(!1,e)}dispose(){this.stopObserving(),super.dispose()}getWidth(){return this._width}getHeight(){return this._height}startObserving(){if(!this._resizeObserver&&this._referenceDomElement){let t=null,e=()=>{t?this.observe({width:t.width,height:t.height}):this.observe()},i=!1,n=!1,o=()=>{if(i&&!n)try{i=!1,n=!0,e()}finally{eo(ue(this._referenceDomElement),()=>{n=!1,o()})}};this._resizeObserver=new ResizeObserver(s=>{s&&s[0]&&s[0].contentRect?t={width:s[0].contentRect.width,height:s[0].contentRect.height}:t=null,i=!0,o()}),this._resizeObserver.observe(this._referenceDomElement)}}stopObserving(){this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=null)}observe(t){this.measureReferenceDomElement(!0,t)}measureReferenceDomElement(t,e){let i=0,n=0;e?(i=e.width,n=e.height):this._referenceDomElement&&(i=this._referenceDomElement.clientWidth,n=this._referenceDomElement.clientHeight),i=Math.max(5,i),n=Math.max(5,n),(this._width!==i||this._height!==n)&&(this._width=i,this._height=n,t&&this._onDidChange.fire())}};var oK=class extends R{_onDidChange=this._register(new x);onDidChange=this._onDidChange.event;_listener;_mediaQueryList;constructor(t){super(),this._listener=()=>this._handleChange(t,!0),this._mediaQueryList=null,this._handleChange(t,!1)}_handleChange(t,e){this._mediaQueryList?.removeEventListener("change",this._listener),this._mediaQueryList=t.matchMedia(`(resolution: ${t.devicePixelRatio}dppx)`),this._mediaQueryList.addEventListener("change",this._listener),e&&this._onDidChange.fire()}},rK=class extends R{_onDidChange=this._register(new x);onDidChange=this._onDidChange.event;_value;get value(){return this._value}constructor(t){super(),this._value=this._getPixelRatio(t);let e=this._register(new oK(t));this._register(e.onDidChange(()=>{this._value=this._getPixelRatio(t),this._onDidChange.fire(this._value)}))}_getPixelRatio(t){let e=document.createElement("canvas").getContext("2d"),i=t.devicePixelRatio||1,n=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return i/n}},sK=class{mapWindowIdToPixelRatioMonitor=new Map;_getOrCreatePixelRatioMonitor(t){let e=_p(t),i=this.mapWindowIdToPixelRatioMonitor.get(e);return i||(i=rc(new rK(t)),this.mapWindowIdToPixelRatioMonitor.set(e,i),rc(X.once(tte)(({vscodeWindowId:n})=>{n===e&&(i?.dispose(),this.mapWindowIdToPixelRatioMonitor.delete(e))}))),i}getInstance(t){return this._getOrCreatePixelRatioMonitor(t)}},Zs=new sK;var tI=class{constructor(t){this.domNode=t}_maxWidth="";_width="";_height="";_top="";_left="";_bottom="";_right="";_paddingTop="";_paddingLeft="";_paddingBottom="";_paddingRight="";_fontFamily="";_fontWeight="";_fontSize="";_fontStyle="";_fontFeatureSettings="";_fontVariationSettings="";_textDecoration="";_lineHeight="";_letterSpacing="";_className="";_display="";_position="";_visibility="";_color="";_backgroundColor="";_layerHint=!1;_contain="none";_boxShadow="";setMaxWidth(t){let e=Tl(t);this._maxWidth!==e&&(this._maxWidth=e,this.domNode.style.maxWidth=this._maxWidth)}setWidth(t){let e=Tl(t);this._width!==e&&(this._width=e,this.domNode.style.width=this._width)}setHeight(t){let e=Tl(t);this._height!==e&&(this._height=e,this.domNode.style.height=this._height)}setTop(t){let e=Tl(t);this._top!==e&&(this._top=e,this.domNode.style.top=this._top)}setLeft(t){let e=Tl(t);this._left!==e&&(this._left=e,this.domNode.style.left=this._left)}setBottom(t){let e=Tl(t);this._bottom!==e&&(this._bottom=e,this.domNode.style.bottom=this._bottom)}setRight(t){let e=Tl(t);this._right!==e&&(this._right=e,this.domNode.style.right=this._right)}setPaddingTop(t){let e=Tl(t);this._paddingTop!==e&&(this._paddingTop=e,this.domNode.style.paddingTop=this._paddingTop)}setPaddingLeft(t){let e=Tl(t);this._paddingLeft!==e&&(this._paddingLeft=e,this.domNode.style.paddingLeft=this._paddingLeft)}setPaddingBottom(t){let e=Tl(t);this._paddingBottom!==e&&(this._paddingBottom=e,this.domNode.style.paddingBottom=this._paddingBottom)}setPaddingRight(t){let e=Tl(t);this._paddingRight!==e&&(this._paddingRight=e,this.domNode.style.paddingRight=this._paddingRight)}setFontFamily(t){this._fontFamily!==t&&(this._fontFamily=t,this.domNode.style.fontFamily=this._fontFamily)}setFontWeight(t){this._fontWeight!==t&&(this._fontWeight=t,this.domNode.style.fontWeight=this._fontWeight)}setFontSize(t){let e=Tl(t);this._fontSize!==e&&(this._fontSize=e,this.domNode.style.fontSize=this._fontSize)}setFontStyle(t){this._fontStyle!==t&&(this._fontStyle=t,this.domNode.style.fontStyle=this._fontStyle)}setFontFeatureSettings(t){this._fontFeatureSettings!==t&&(this._fontFeatureSettings=t,this.domNode.style.fontFeatureSettings=this._fontFeatureSettings)}setFontVariationSettings(t){this._fontVariationSettings!==t&&(this._fontVariationSettings=t,this.domNode.style.fontVariationSettings=this._fontVariationSettings)}setTextDecoration(t){this._textDecoration!==t&&(this._textDecoration=t,this.domNode.style.textDecoration=this._textDecoration)}setLineHeight(t){let e=Tl(t);this._lineHeight!==e&&(this._lineHeight=e,this.domNode.style.lineHeight=this._lineHeight)}setLetterSpacing(t){let e=Tl(t);this._letterSpacing!==e&&(this._letterSpacing=e,this.domNode.style.letterSpacing=this._letterSpacing)}setClassName(t){this._className!==t&&(this._className=t,this.domNode.className=this._className)}toggleClassName(t,e){this.domNode.classList.toggle(t,e),this._className=this.domNode.className}setDisplay(t){this._display!==t&&(this._display=t,this.domNode.style.display=this._display)}setPosition(t){this._position!==t&&(this._position=t,this.domNode.style.position=this._position)}setVisibility(t){this._visibility!==t&&(this._visibility=t,this.domNode.style.visibility=this._visibility)}setColor(t){this._color!==t&&(this._color=t,this.domNode.style.color=this._color)}setBackgroundColor(t){this._backgroundColor!==t&&(this._backgroundColor=t,this.domNode.style.backgroundColor=this._backgroundColor)}setLayerHinting(t){this._layerHint!==t&&(this._layerHint=t,this.domNode.style.transform=this._layerHint?"translate3d(0px, 0px, 0px)":"")}setBoxShadow(t){this._boxShadow!==t&&(this._boxShadow=t,this.domNode.style.boxShadow=t)}setContain(t){this._contain!==t&&(this._contain=t,this.domNode.style.contain=this._contain)}setAttribute(t,e){this.domNode.setAttribute(t,e)}removeAttribute(t){this.domNode.removeAttribute(t)}appendChild(t){this.domNode.appendChild(t.domNode)}removeChild(t){this.domNode.removeChild(t.domNode)}};function Tl(r){return typeof r=="number"?`${r}px`:r}function Ot(r){return new tI(r)}var o0e=new Uint32Array(10);var r0e=new Uint8Array([114,82,115,101,69,102,97,113,81,116,84,100,119,87,99,122,120,118,103]),s0e=new Uint16Array([107,111,105,79,106,112,117,80,104,27496,28520,27752,121,110,27246,28782,27758,98,109,27757,108]),a0e=new Uint16Array([114,82,29810,115,30579,26483,101,102,29286,24934,29030,29798,30822,30310,26470,97,113,29809,116,84,100,119,99,122,120,118,103]),l0e=new Uint16Array([114,82,29810,115,30579,26483,101,69,102,29286,24934,29030,29798,30822,30310,26470,97,113,81,29809,116,84,100,119,87,99,122,120,118,103,107,111,105,79,106,112,117,80,104,27496,28520,27752,121,110,27246,28782,27758,98,109,27757,108]);function kte(...r){return function(t,e){for(let i=0,n=r.length;i<n;i++){let o=r[i](t,e);if(o)return o}return null}}var m0e=Lte.bind(void 0,!1),nI=Lte.bind(void 0,!0);function Lte(r,t,e){if(!e||e.length<t.length)return null;let i;return r?i=bm(e,t):i=e.indexOf(t)===0,i?t.length>0?[{start:0,end:t.length}]:[]:null}function Pbe(r,t){let e=t.toLowerCase().indexOf(r.toLowerCase());return e===-1?null:[{start:e,end:e+r.length}]}function uK(r,t){return lK(r.toLowerCase(),t.toLowerCase(),0,0)}function lK(r,t,e,i){if(e===r.length)return[];if(i===t.length)return null;if(r[e]===t[i]){let n=null;return(n=lK(r,t,e+1,i+1))?Pte({start:i,end:i+1},n):null}return lK(r,t,e,i+1)}function pK(r){return 97<=r&&r<=122}function JS(r){return 65<=r&&r<=90}function hK(r){return 48<=r&&r<=57}function Mbe(r){return r===32||r===9||r===10||r===13}var Abe=new Set;"()[]{}<>`'\"-/;:,.?!".split("").forEach(r=>Abe.add(r.charCodeAt(0)));function Rte(r){return pK(r)||JS(r)||hK(r)}function Pte(r,t){return t.length===0?t=[r]:r.end===t[0].start?t[0].start=r.start:t.unshift(r),t}function Mte(r,t){for(let e=t;e<r.length;e++){let i=r.charCodeAt(e);if(JS(i)||hK(i)||e>0&&!Rte(r.charCodeAt(e-1)))return e}return r.length}function dK(r,t,e,i){if(e===r.length)return[];if(i===t.length)return null;if(r[e]!==t[i].toLowerCase())return null;{let n=null,o=i+1;for(n=dK(r,t,e+1,i+1);!n&&(o=Mte(t,o))<t.length;)n=dK(r,t,e+1,o),o++;return n===null?null:Pte({start:i,end:i+1},n)}}function Obe(r){let t=0,e=0,i=0,n=0,o=0;for(let c=0;c<r.length;c++)o=r.charCodeAt(c),JS(o)&&t++,pK(o)&&e++,Rte(o)&&i++,hK(o)&&n++;let s=t/r.length,a=e/r.length,l=i/r.length,d=n/r.length;return{upperPercent:s,lowerPercent:a,alphaPercent:l,numericPercent:d}}function Nbe(r){let{upperPercent:t,lowerPercent:e}=r;return e===0&&t>.6}function Fbe(r){let{upperPercent:t,lowerPercent:e,alphaPercent:i,numericPercent:n}=r;return e>.2&&t<.8&&i>.6&&n<.2}function Bbe(r){let t=0,e=0,i=0,n=0;for(let o=0;o<r.length;o++)i=r.charCodeAt(o),JS(i)&&t++,pK(i)&&e++,Mbe(i)&&n++;return(t===0||e===0)&&n===0?r.length<=30:t<=5}function Ate(r,t){if(!t||(t=t.trim(),t.length===0)||!Bbe(r))return null;t.length>60&&(t=t.substring(0,60));let e=Obe(t);if(!Fbe(e)){if(!Nbe(e))return null;t=t.toLowerCase()}let i=null,n=0;for(r=r.toLowerCase();n<t.length&&(i=dK(r,t,0,n))===null;)n=Mte(t,n+1);return i}var Vbe=kte(nI,Ate,Pbe),Wbe=kte(nI,Ate,uK),_te=new zr(1e4);function _l(r,t,e=!1){if(typeof r!="string"||typeof t!="string")return null;let i=_te.get(r);i||(i=new RegExp(uee(r),"i"),_te.set(r,i));let n=i.exec(t);return n?[{start:n.index,end:n.index+n[0].length}]:e?Wbe(r,t):Vbe(r,t)}function Ote(r,t){let e=_m(r,r.toLowerCase(),0,t,t.toLowerCase(),0,{firstMatchCanBeWeak:!0,boostFullMatch:!0});return e?qo(e):null}function Nte(r,t,e,i,n,o){let s=Math.min(13,r.length);for(;e<s;e++){let a=_m(r,t,e,i,n,o,{firstMatchCanBeWeak:!0,boostFullMatch:!0});if(a)return a}return[0,o]}function qo(r){if(typeof r>"u")return[];let t=[],e=r[1];for(let i=r.length-1;i>1;i--){let n=r[i]+e,o=t[t.length-1];o&&o.end===n?o.end=n+1:t.push({start:n,end:n+1})}return t}var mf=128;function mK(){let r=[],t=[];for(let e=0;e<=mf;e++)t[e]=0;for(let e=0;e<=mf;e++)r.push(t.slice(0));return r}function Fte(r){let t=[];for(let e=0;e<=r;e++)t[e]=0;return t}var Bte=Fte(2*mf),cK=Fte(2*mf),kp=mK(),hf=mK(),uD=mK(),Hbe=!1;function aK(r,t,e,i,n){function o(a,l,d=" "){for(;a.length<l;)a=d+a;return a}let s=` |   |${i.split("").map(a=>o(a,3)).join("|")}
`;for(let a=0;a<=e;a++)a===0?s+=" |":s+=`${t[a-1]}|`,s+=r[a].slice(0,n+1).map(l=>o(l.toString(),3)).join("|")+`
`;return s}function Ube(r,t,e,i){r=r.substr(t),e=e.substr(i),console.log(aK(hf,r,r.length,e,e.length)),console.log(aK(uD,r,r.length,e,e.length)),console.log(aK(kp,r,r.length,e,e.length))}function $A(r,t){if(t<0||t>=r.length)return!1;let e=r.codePointAt(t);switch(e){case 95:case 45:case 46:case 32:case 47:case 92:case 39:case 34:case 58:case 36:case 60:case 62:case 40:case 41:case 91:case 93:case 123:case 125:return!0;case void 0:return!1;default:return!!U_(e)}}function Dte(r,t){if(t<0||t>=r.length)return!1;switch(r.charCodeAt(t)){case 32:case 9:return!0;default:return!1}}function jA(r,t,e){return t[r]!==e[r]}function gK(r,t,e,i,n,o,s=!1){for(;t<e&&n<o;)r[t]===i[n]&&(s&&(Bte[t]=n),t+=1),n+=1;return t===e}var Dl;(e=>{e.Default=[-100,0];function t(i){return!i||i.length===2&&i[0]===-100&&i[1]===0}e.isDefault=t})(Dl||={});var iI=class{constructor(t,e){this.firstMatchCanBeWeak=t;this.boostFullMatch=e}static default={boostFullMatch:!0,firstMatchCanBeWeak:!1}};function _m(r,t,e,i,n,o,s=iI.default){let a=r.length>mf?mf:r.length,l=i.length>mf?mf:i.length;if(e>=a||o>=l||a-e>l-o||!gK(t,e,a,n,o,l,!0))return;zbe(a,l,e,o,t,n);let d=1,c=1,p=e,h=o,m=[!1];for(d=1,p=e;p<a;d++,p++){let y=Bte[p],w=cK[p],C=p+1<a?cK[p+1]:l;for(c=y-o+1,h=y;h<C;c++,h++){let S=Number.MIN_SAFE_INTEGER,D=!1;h<=w&&(S=Kbe(r,t,p,e,i,n,h,l,o,kp[d-1][c-1]===0,m));let k=0;S!==Number.MAX_SAFE_INTEGER&&(D=!0,k=S+hf[d-1][c-1]);let M=h>y,O=M?hf[d][c-1]+(kp[d][c-1]>0?-5:0):0,K=h>y+1&&kp[d][c-1]>0,G=K?hf[d][c-2]+(kp[d][c-2]>0?-5:0):0;if(K&&(!M||G>=O)&&(!D||G>=k))hf[d][c]=G,uD[d][c]=3,kp[d][c]=0;else if(M&&(!D||O>=k))hf[d][c]=O,uD[d][c]=2,kp[d][c]=0;else if(D)hf[d][c]=k,uD[d][c]=1,kp[d][c]=kp[d-1][c-1]+1;else throw new Error("not possible")}}if(Hbe&&Ube(r,e,i,o),!m[0]&&!s.firstMatchCanBeWeak)return;d--,c--;let f=[hf[d][c],o],g=0,v=0;for(;d>=1;){let y=c;do{let w=uD[d][y];if(w===3)y=y-2;else if(w===2)y=y-1;else break}while(y>=1);g>1&&t[e+d-1]===n[o+c-1]&&!jA(y+o-1,i,n)&&g+1>kp[d][y]&&(y=c),y===c?g++:g=1,v||(v=y),d--,c=y-1,f.push(c)}l-o===a&&s.boostFullMatch&&(f[0]+=2);let I=v-a;return f[0]-=I,f}function zbe(r,t,e,i,n,o){let s=r-1,a=t-1;for(;s>=e&&a>=i;)n[s]===o[a]&&(cK[s]=a,s--),a--}function Kbe(r,t,e,i,n,o,s,a,l,d,c){if(t[e]!==o[s])return Number.MIN_SAFE_INTEGER;let p=1,h=!1;return s===e-i?p=r[e]===n[s]?7:5:jA(s,n,o)&&(s===0||!jA(s-1,n,o))?(p=r[e]===n[s]?7:5,h=!0):$A(o,s)&&(s===0||!$A(o,s-1))?p=5:($A(o,s-1)||Dte(o,s-1))&&(p=5,h=!0),p>1&&e===i&&(c[0]=!0),h||(h=jA(s,n,o)||$A(o,s-1)||Dte(o,s-1)),e===i?s>l&&(p-=h?3:5):d?p+=h?2:0:p+=h?0:1,s+1===a&&(p-=h?3:5),p}function Vte(r,t,e,i,n,o,s){return Gbe(r,t,e,i,n,o,!0,s)}function Gbe(r,t,e,i,n,o,s,a){let l=_m(r,t,e,i,n,o,a);if(l&&!s)return l;if(r.length>=3){let d=Math.min(7,r.length-1);for(let c=e+1;c<d;c++){let p=qbe(r,c);if(p){let h=_m(p,p.toLowerCase(),e,i,n,o,a);h&&(h[0]-=3,(!l||h[0]>l[0])&&(l=h))}}}return l}function qbe(r,t){if(t+1>=r.length)return;let e=r[t],i=r[t+1];if(e!==i)return r.slice(0,t)+i+e+r.slice(t+2)}var fK=Object.create(null);function _(r,t){if(Bt(t)){let e=fK[t];if(e===void 0)throw new Error(`${r} references an unknown codicon: ${t}`);t=e}return fK[r]=t,{id:r}}function XA(){return fK}var Wte={add:_("add",6e4),plus:_("plus",6e4),gistNew:_("gist-new",6e4),repoCreate:_("repo-create",6e4),lightbulb:_("lightbulb",60001),lightBulb:_("light-bulb",60001),repo:_("repo",60002),repoDelete:_("repo-delete",60002),gistFork:_("gist-fork",60003),repoForked:_("repo-forked",60003),gitPullRequest:_("git-pull-request",60004),gitPullRequestAbandoned:_("git-pull-request-abandoned",60004),recordKeys:_("record-keys",60005),keyboard:_("keyboard",60005),tag:_("tag",60006),gitPullRequestLabel:_("git-pull-request-label",60006),tagAdd:_("tag-add",60006),tagRemove:_("tag-remove",60006),person:_("person",60007),personFollow:_("person-follow",60007),personOutline:_("person-outline",60007),personFilled:_("person-filled",60007),gitBranch:_("git-branch",60008),gitBranchCreate:_("git-branch-create",60008),gitBranchDelete:_("git-branch-delete",60008),sourceControl:_("source-control",60008),mirror:_("mirror",60009),mirrorPublic:_("mirror-public",60009),star:_("star",60010),starAdd:_("star-add",60010),starDelete:_("star-delete",60010),starEmpty:_("star-empty",60010),comment:_("comment",60011),commentAdd:_("comment-add",60011),alert:_("alert",60012),warning:_("warning",60012),search:_("search",60013),searchSave:_("search-save",60013),logOut:_("log-out",60014),signOut:_("sign-out",60014),logIn:_("log-in",60015),signIn:_("sign-in",60015),eye:_("eye",60016),eyeUnwatch:_("eye-unwatch",60016),eyeWatch:_("eye-watch",60016),circleFilled:_("circle-filled",60017),primitiveDot:_("primitive-dot",60017),closeDirty:_("close-dirty",60017),debugBreakpoint:_("debug-breakpoint",60017),debugBreakpointDisabled:_("debug-breakpoint-disabled",60017),debugHint:_("debug-hint",60017),terminalDecorationSuccess:_("terminal-decoration-success",60017),primitiveSquare:_("primitive-square",60018),edit:_("edit",60019),pencil:_("pencil",60019),info:_("info",60020),issueOpened:_("issue-opened",60020),gistPrivate:_("gist-private",60021),gitForkPrivate:_("git-fork-private",60021),lock:_("lock",60021),mirrorPrivate:_("mirror-private",60021),close:_("close",60022),removeClose:_("remove-close",60022),x:_("x",60022),repoSync:_("repo-sync",60023),sync:_("sync",60023),clone:_("clone",60024),desktopDownload:_("desktop-download",60024),beaker:_("beaker",60025),microscope:_("microscope",60025),vm:_("vm",60026),deviceDesktop:_("device-desktop",60026),file:_("file",60027),fileText:_("file-text",60027),more:_("more",60028),ellipsis:_("ellipsis",60028),kebabHorizontal:_("kebab-horizontal",60028),mailReply:_("mail-reply",60029),reply:_("reply",60029),organization:_("organization",60030),organizationFilled:_("organization-filled",60030),organizationOutline:_("organization-outline",60030),newFile:_("new-file",60031),fileAdd:_("file-add",60031),newFolder:_("new-folder",60032),fileDirectoryCreate:_("file-directory-create",60032),trash:_("trash",60033),trashcan:_("trashcan",60033),history:_("history",60034),clock:_("clock",60034),folder:_("folder",60035),fileDirectory:_("file-directory",60035),symbolFolder:_("symbol-folder",60035),logoGithub:_("logo-github",60036),markGithub:_("mark-github",60036),github:_("github",60036),terminal:_("terminal",60037),console:_("console",60037),repl:_("repl",60037),zap:_("zap",60038),symbolEvent:_("symbol-event",60038),error:_("error",60039),stop:_("stop",60039),variable:_("variable",60040),symbolVariable:_("symbol-variable",60040),array:_("array",60042),symbolArray:_("symbol-array",60042),symbolModule:_("symbol-module",60043),symbolPackage:_("symbol-package",60043),symbolNamespace:_("symbol-namespace",60043),symbolObject:_("symbol-object",60043),symbolMethod:_("symbol-method",60044),symbolFunction:_("symbol-function",60044),symbolConstructor:_("symbol-constructor",60044),symbolBoolean:_("symbol-boolean",60047),symbolNull:_("symbol-null",60047),symbolNumeric:_("symbol-numeric",60048),symbolNumber:_("symbol-number",60048),symbolStructure:_("symbol-structure",60049),symbolStruct:_("symbol-struct",60049),symbolParameter:_("symbol-parameter",60050),symbolTypeParameter:_("symbol-type-parameter",60050),symbolKey:_("symbol-key",60051),symbolText:_("symbol-text",60051),symbolReference:_("symbol-reference",60052),goToFile:_("go-to-file",60052),symbolEnum:_("symbol-enum",60053),symbolValue:_("symbol-value",60053),symbolRuler:_("symbol-ruler",60054),symbolUnit:_("symbol-unit",60054),activateBreakpoints:_("activate-breakpoints",60055),archive:_("archive",60056),arrowBoth:_("arrow-both",60057),arrowDown:_("arrow-down",60058),arrowLeft:_("arrow-left",60059),arrowRight:_("arrow-right",60060),arrowSmallDown:_("arrow-small-down",60061),arrowSmallLeft:_("arrow-small-left",60062),arrowSmallRight:_("arrow-small-right",60063),arrowSmallUp:_("arrow-small-up",60064),arrowUp:_("arrow-up",60065),bell:_("bell",60066),bold:_("bold",60067),book:_("book",60068),bookmark:_("bookmark",60069),debugBreakpointConditionalUnverified:_("debug-breakpoint-conditional-unverified",60070),debugBreakpointConditional:_("debug-breakpoint-conditional",60071),debugBreakpointConditionalDisabled:_("debug-breakpoint-conditional-disabled",60071),debugBreakpointDataUnverified:_("debug-breakpoint-data-unverified",60072),debugBreakpointData:_("debug-breakpoint-data",60073),debugBreakpointDataDisabled:_("debug-breakpoint-data-disabled",60073),debugBreakpointLogUnverified:_("debug-breakpoint-log-unverified",60074),debugBreakpointLog:_("debug-breakpoint-log",60075),debugBreakpointLogDisabled:_("debug-breakpoint-log-disabled",60075),briefcase:_("briefcase",60076),broadcast:_("broadcast",60077),browser:_("browser",60078),bug:_("bug",60079),calendar:_("calendar",60080),caseSensitive:_("case-sensitive",60081),check:_("check",60082),checklist:_("checklist",60083),chevronDown:_("chevron-down",60084),chevronLeft:_("chevron-left",60085),chevronRight:_("chevron-right",60086),chevronUp:_("chevron-up",60087),chromeClose:_("chrome-close",60088),chromeMaximize:_("chrome-maximize",60089),chromeMinimize:_("chrome-minimize",60090),chromeRestore:_("chrome-restore",60091),circleOutline:_("circle-outline",60092),circle:_("circle",60092),debugBreakpointUnverified:_("debug-breakpoint-unverified",60092),terminalDecorationIncomplete:_("terminal-decoration-incomplete",60092),circleSlash:_("circle-slash",60093),circuitBoard:_("circuit-board",60094),clearAll:_("clear-all",60095),clippy:_("clippy",60096),closeAll:_("close-all",60097),cloudDownload:_("cloud-download",60098),cloudUpload:_("cloud-upload",60099),code:_("code",60100),collapseAll:_("collapse-all",60101),colorMode:_("color-mode",60102),commentDiscussion:_("comment-discussion",60103),creditCard:_("credit-card",60105),dash:_("dash",60108),dashboard:_("dashboard",60109),database:_("database",60110),debugContinue:_("debug-continue",60111),debugDisconnect:_("debug-disconnect",60112),debugPause:_("debug-pause",60113),debugRestart:_("debug-restart",60114),debugStart:_("debug-start",60115),debugStepInto:_("debug-step-into",60116),debugStepOut:_("debug-step-out",60117),debugStepOver:_("debug-step-over",60118),debugStop:_("debug-stop",60119),debug:_("debug",60120),deviceCameraVideo:_("device-camera-video",60121),deviceCamera:_("device-camera",60122),deviceMobile:_("device-mobile",60123),diffAdded:_("diff-added",60124),diffIgnored:_("diff-ignored",60125),diffModified:_("diff-modified",60126),diffRemoved:_("diff-removed",60127),diffRenamed:_("diff-renamed",60128),diff:_("diff",60129),diffSidebyside:_("diff-sidebyside",60129),discard:_("discard",60130),editorLayout:_("editor-layout",60131),emptyWindow:_("empty-window",60132),exclude:_("exclude",60133),extensions:_("extensions",60134),eyeClosed:_("eye-closed",60135),fileBinary:_("file-binary",60136),fileCode:_("file-code",60137),fileMedia:_("file-media",60138),filePdf:_("file-pdf",60139),fileSubmodule:_("file-submodule",60140),fileSymlinkDirectory:_("file-symlink-directory",60141),fileSymlinkFile:_("file-symlink-file",60142),fileZip:_("file-zip",60143),files:_("files",60144),filter:_("filter",60145),flame:_("flame",60146),foldDown:_("fold-down",60147),foldUp:_("fold-up",60148),fold:_("fold",60149),folderActive:_("folder-active",60150),folderOpened:_("folder-opened",60151),gear:_("gear",60152),gift:_("gift",60153),gistSecret:_("gist-secret",60154),gist:_("gist",60155),gitCommit:_("git-commit",60156),gitCompare:_("git-compare",60157),compareChanges:_("compare-changes",60157),gitMerge:_("git-merge",60158),githubAction:_("github-action",60159),githubAlt:_("github-alt",60160),globe:_("globe",60161),grabber:_("grabber",60162),graph:_("graph",60163),gripper:_("gripper",60164),heart:_("heart",60165),home:_("home",60166),horizontalRule:_("horizontal-rule",60167),hubot:_("hubot",60168),inbox:_("inbox",60169),issueReopened:_("issue-reopened",60171),issues:_("issues",60172),italic:_("italic",60173),jersey:_("jersey",60174),json:_("json",60175),kebabVertical:_("kebab-vertical",60176),key:_("key",60177),law:_("law",60178),lightbulbAutofix:_("lightbulb-autofix",60179),linkExternal:_("link-external",60180),link:_("link",60181),listOrdered:_("list-ordered",60182),listUnordered:_("list-unordered",60183),liveShare:_("live-share",60184),loading:_("loading",60185),location:_("location",60186),mailRead:_("mail-read",60187),mail:_("mail",60188),markdown:_("markdown",60189),megaphone:_("megaphone",60190),mention:_("mention",60191),milestone:_("milestone",60192),gitPullRequestMilestone:_("git-pull-request-milestone",60192),mortarBoard:_("mortar-board",60193),move:_("move",60194),multipleWindows:_("multiple-windows",60195),mute:_("mute",60196),noNewline:_("no-newline",60197),note:_("note",60198),octoface:_("octoface",60199),openPreview:_("open-preview",60200),package:_("package",60201),paintcan:_("paintcan",60202),pin:_("pin",60203),play:_("play",60204),run:_("run",60204),plug:_("plug",60205),preserveCase:_("preserve-case",60206),preview:_("preview",60207),project:_("project",60208),pulse:_("pulse",60209),question:_("question",60210),quote:_("quote",60211),radioTower:_("radio-tower",60212),reactions:_("reactions",60213),references:_("references",60214),refresh:_("refresh",60215),regex:_("regex",60216),remoteExplorer:_("remote-explorer",60217),remote:_("remote",60218),remove:_("remove",60219),replaceAll:_("replace-all",60220),replace:_("replace",60221),repoClone:_("repo-clone",60222),repoForcePush:_("repo-force-push",60223),repoPull:_("repo-pull",60224),repoPush:_("repo-push",60225),report:_("report",60226),requestChanges:_("request-changes",60227),rocket:_("rocket",60228),rootFolderOpened:_("root-folder-opened",60229),rootFolder:_("root-folder",60230),rss:_("rss",60231),ruby:_("ruby",60232),saveAll:_("save-all",60233),saveAs:_("save-as",60234),save:_("save",60235),screenFull:_("screen-full",60236),screenNormal:_("screen-normal",60237),searchStop:_("search-stop",60238),server:_("server",60240),settingsGear:_("settings-gear",60241),settings:_("settings",60242),shield:_("shield",60243),smiley:_("smiley",60244),sortPrecedence:_("sort-precedence",60245),splitHorizontal:_("split-horizontal",60246),splitVertical:_("split-vertical",60247),squirrel:_("squirrel",60248),starFull:_("star-full",60249),starHalf:_("star-half",60250),symbolClass:_("symbol-class",60251),symbolColor:_("symbol-color",60252),symbolConstant:_("symbol-constant",60253),symbolEnumMember:_("symbol-enum-member",60254),symbolField:_("symbol-field",60255),symbolFile:_("symbol-file",60256),symbolInterface:_("symbol-interface",60257),symbolKeyword:_("symbol-keyword",60258),symbolMisc:_("symbol-misc",60259),symbolOperator:_("symbol-operator",60260),symbolProperty:_("symbol-property",60261),wrench:_("wrench",60261),wrenchSubaction:_("wrench-subaction",60261),symbolSnippet:_("symbol-snippet",60262),tasklist:_("tasklist",60263),telescope:_("telescope",60264),textSize:_("text-size",60265),threeBars:_("three-bars",60266),thumbsdown:_("thumbsdown",60267),thumbsup:_("thumbsup",60268),tools:_("tools",60269),triangleDown:_("triangle-down",60270),triangleLeft:_("triangle-left",60271),triangleRight:_("triangle-right",60272),triangleUp:_("triangle-up",60273),twitter:_("twitter",60274),unfold:_("unfold",60275),unlock:_("unlock",60276),unmute:_("unmute",60277),unverified:_("unverified",60278),verified:_("verified",60279),versions:_("versions",60280),vmActive:_("vm-active",60281),vmOutline:_("vm-outline",60282),vmRunning:_("vm-running",60283),watch:_("watch",60284),whitespace:_("whitespace",60285),wholeWord:_("whole-word",60286),window:_("window",60287),wordWrap:_("word-wrap",60288),zoomIn:_("zoom-in",60289),zoomOut:_("zoom-out",60290),listFilter:_("list-filter",60291),listFlat:_("list-flat",60292),listSelection:_("list-selection",60293),selection:_("selection",60293),listTree:_("list-tree",60294),debugBreakpointFunctionUnverified:_("debug-breakpoint-function-unverified",60295),debugBreakpointFunction:_("debug-breakpoint-function",60296),debugBreakpointFunctionDisabled:_("debug-breakpoint-function-disabled",60296),debugStackframeActive:_("debug-stackframe-active",60297),circleSmallFilled:_("circle-small-filled",60298),debugStackframeDot:_("debug-stackframe-dot",60298),terminalDecorationMark:_("terminal-decoration-mark",60298),debugStackframe:_("debug-stackframe",60299),debugStackframeFocused:_("debug-stackframe-focused",60299),debugBreakpointUnsupported:_("debug-breakpoint-unsupported",60300),symbolString:_("symbol-string",60301),debugReverseContinue:_("debug-reverse-continue",60302),debugStepBack:_("debug-step-back",60303),debugRestartFrame:_("debug-restart-frame",60304),debugAlt:_("debug-alt",60305),callIncoming:_("call-incoming",60306),callOutgoing:_("call-outgoing",60307),menu:_("menu",60308),expandAll:_("expand-all",60309),feedback:_("feedback",60310),gitPullRequestReviewer:_("git-pull-request-reviewer",60310),groupByRefType:_("group-by-ref-type",60311),ungroupByRefType:_("ungroup-by-ref-type",60312),account:_("account",60313),gitPullRequestAssignee:_("git-pull-request-assignee",60313),bellDot:_("bell-dot",60314),debugConsole:_("debug-console",60315),library:_("library",60316),output:_("output",60317),runAll:_("run-all",60318),syncIgnored:_("sync-ignored",60319),pinned:_("pinned",60320),githubInverted:_("github-inverted",60321),serverProcess:_("server-process",60322),serverEnvironment:_("server-environment",60323),pass:_("pass",60324),issueClosed:_("issue-closed",60324),stopCircle:_("stop-circle",60325),playCircle:_("play-circle",60326),record:_("record",60327),debugAltSmall:_("debug-alt-small",60328),vmConnect:_("vm-connect",60329),cloud:_("cloud",60330),merge:_("merge",60331),export:_("export",60332),graphLeft:_("graph-left",60333),magnet:_("magnet",60334),notebook:_("notebook",60335),redo:_("redo",60336),checkAll:_("check-all",60337),pinnedDirty:_("pinned-dirty",60338),passFilled:_("pass-filled",60339),circleLargeFilled:_("circle-large-filled",60340),circleLarge:_("circle-large",60341),circleLargeOutline:_("circle-large-outline",60341),combine:_("combine",60342),gather:_("gather",60342),table:_("table",60343),variableGroup:_("variable-group",60344),typeHierarchy:_("type-hierarchy",60345),typeHierarchySub:_("type-hierarchy-sub",60346),typeHierarchySuper:_("type-hierarchy-super",60347),gitPullRequestCreate:_("git-pull-request-create",60348),runAbove:_("run-above",60349),runBelow:_("run-below",60350),notebookTemplate:_("notebook-template",60351),debugRerun:_("debug-rerun",60352),workspaceTrusted:_("workspace-trusted",60353),workspaceUntrusted:_("workspace-untrusted",60354),workspaceUnknown:_("workspace-unknown",60355),terminalCmd:_("terminal-cmd",60356),terminalDebian:_("terminal-debian",60357),terminalLinux:_("terminal-linux",60358),terminalPowershell:_("terminal-powershell",60359),terminalTmux:_("terminal-tmux",60360),terminalUbuntu:_("terminal-ubuntu",60361),terminalBash:_("terminal-bash",60362),arrowSwap:_("arrow-swap",60363),copy:_("copy",60364),personAdd:_("person-add",60365),filterFilled:_("filter-filled",60366),wand:_("wand",60367),debugLineByLine:_("debug-line-by-line",60368),inspect:_("inspect",60369),layers:_("layers",60370),layersDot:_("layers-dot",60371),layersActive:_("layers-active",60372),compass:_("compass",60373),compassDot:_("compass-dot",60374),compassActive:_("compass-active",60375),azure:_("azure",60376),issueDraft:_("issue-draft",60377),gitPullRequestClosed:_("git-pull-request-closed",60378),gitPullRequestDraft:_("git-pull-request-draft",60379),debugAll:_("debug-all",60380),debugCoverage:_("debug-coverage",60381),runErrors:_("run-errors",60382),folderLibrary:_("folder-library",60383),debugContinueSmall:_("debug-continue-small",60384),beakerStop:_("beaker-stop",60385),graphLine:_("graph-line",60386),graphScatter:_("graph-scatter",60387),pieChart:_("pie-chart",60388),bracket:_("bracket",60175),bracketDot:_("bracket-dot",60389),bracketError:_("bracket-error",60390),lockSmall:_("lock-small",60391),azureDevops:_("azure-devops",60392),verifiedFilled:_("verified-filled",60393),newline:_("newline",60394),layout:_("layout",60395),layoutActivitybarLeft:_("layout-activitybar-left",60396),layoutActivitybarRight:_("layout-activitybar-right",60397),layoutPanelLeft:_("layout-panel-left",60398),layoutPanelCenter:_("layout-panel-center",60399),layoutPanelJustify:_("layout-panel-justify",60400),layoutPanelRight:_("layout-panel-right",60401),layoutPanel:_("layout-panel",60402),layoutSidebarLeft:_("layout-sidebar-left",60403),layoutSidebarRight:_("layout-sidebar-right",60404),layoutStatusbar:_("layout-statusbar",60405),layoutMenubar:_("layout-menubar",60406),layoutCentered:_("layout-centered",60407),target:_("target",60408),indent:_("indent",60409),recordSmall:_("record-small",60410),errorSmall:_("error-small",60411),terminalDecorationError:_("terminal-decoration-error",60411),arrowCircleDown:_("arrow-circle-down",60412),arrowCircleLeft:_("arrow-circle-left",60413),arrowCircleRight:_("arrow-circle-right",60414),arrowCircleUp:_("arrow-circle-up",60415),layoutSidebarRightOff:_("layout-sidebar-right-off",60416),layoutPanelOff:_("layout-panel-off",60417),layoutSidebarLeftOff:_("layout-sidebar-left-off",60418),blank:_("blank",60419),heartFilled:_("heart-filled",60420),map:_("map",60421),mapHorizontal:_("map-horizontal",60421),foldHorizontal:_("fold-horizontal",60421),mapFilled:_("map-filled",60422),mapHorizontalFilled:_("map-horizontal-filled",60422),foldHorizontalFilled:_("fold-horizontal-filled",60422),circleSmall:_("circle-small",60423),bellSlash:_("bell-slash",60424),bellSlashDot:_("bell-slash-dot",60425),commentUnresolved:_("comment-unresolved",60426),gitPullRequestGoToChanges:_("git-pull-request-go-to-changes",60427),gitPullRequestNewChanges:_("git-pull-request-new-changes",60428),searchFuzzy:_("search-fuzzy",60429),commentDraft:_("comment-draft",60430),send:_("send",60431),sparkle:_("sparkle",60432),insert:_("insert",60433),mic:_("mic",60434),thumbsdownFilled:_("thumbsdown-filled",60435),thumbsupFilled:_("thumbsup-filled",60436),coffee:_("coffee",60437),snake:_("snake",60438),game:_("game",60439),vr:_("vr",60440),chip:_("chip",60441),piano:_("piano",60442),music:_("music",60443),micFilled:_("mic-filled",60444),repoFetch:_("repo-fetch",60445),copilot:_("copilot",60446),lightbulbSparkle:_("lightbulb-sparkle",60447),robot:_("robot",60448),sparkleFilled:_("sparkle-filled",60449),diffSingle:_("diff-single",60450),diffMultiple:_("diff-multiple",60451),surroundWith:_("surround-with",60452),share:_("share",60453),gitStash:_("git-stash",60454),gitStashApply:_("git-stash-apply",60455),gitStashPop:_("git-stash-pop",60456),vscode:_("vscode",60457),vscodeInsiders:_("vscode-insiders",60458),codeOss:_("code-oss",60459),runCoverage:_("run-coverage",60460),runAllCoverage:_("run-all-coverage",60461),coverage:_("coverage",60462),githubProject:_("github-project",60463),mapVertical:_("map-vertical",60464),foldVertical:_("fold-vertical",60464),mapVerticalFilled:_("map-vertical-filled",60465),foldVerticalFilled:_("fold-vertical-filled",60465),goToSearch:_("go-to-search",60466),percentage:_("percentage",60467),sortPercentage:_("sort-percentage",60467),attach:_("attach",60468)};var $be={dialogError:_("dialog-error","error"),dialogWarning:_("dialog-warning","warning"),dialogInfo:_("dialog-info","info"),dialogClose:_("dialog-close","close"),treeItemExpanded:_("tree-item-expanded","chevron-down"),treeFilterOnTypeOn:_("tree-filter-on-type-on","list-filter"),treeFilterOnTypeOff:_("tree-filter-on-type-off","list-selection"),treeFilterClear:_("tree-filter-clear","close"),treeItemLoading:_("tree-item-loading","loading"),menuSelection:_("menu-selection","check"),menuSubmenu:_("menu-submenu","chevron-right"),menuBarMore:_("menubar-more","more"),scrollbarButtonLeft:_("scrollbar-button-left","triangle-left"),scrollbarButtonRight:_("scrollbar-button-right","triangle-right"),scrollbarButtonUp:_("scrollbar-button-up","triangle-up"),scrollbarButtonDown:_("scrollbar-button-down","triangle-down"),toolBarMore:_("toolbar-more","more"),quickInputBack:_("quick-input-back","arrow-left"),dropDownButton:_("drop-down-button",60084),symbolCustomColor:_("symbol-customcolor",60252),exportIcon:_("export",60332),workspaceUnspecified:_("workspace-unspecified",60355),newLine:_("newline",60394),thumbsDownFilled:_("thumbsdown-filled",60435),thumbsUpFilled:_("thumbsup-filled",60436),gitFetch:_("git-fetch",60445),lightbulbSparkleAutofix:_("lightbulb-sparkle-autofix",60447),debugBreakpointPending:_("debug-breakpoint-pending",60377)},N={...Wte,...$be};var Hte;(t=>{function r(e){return e&&typeof e=="object"&&typeof e.id=="string"}t.isThemeColor=r})(Hte||={});var de;(g=>{g.iconNameSegment="[A-Za-z0-9]+",g.iconNameExpression="[A-Za-z0-9-]+",g.iconModifierExpression="~[A-Za-z]+",g.iconNameCharacter="[A-Za-z0-9~-]";let n=new RegExp(`^(${g.iconNameExpression})(${g.iconModifierExpression})?$`);function o(v){let I=n.exec(v.id);if(!I)return o(N.error);let[,y,w]=I,C=["codicon","codicon-"+y];return w&&C.push("codicon-modifier-"+w.substring(1)),C}g.asClassNameArray=o;function s(v){return o(v).join(" ")}g.asClassName=s;function a(v){return"."+o(v).join(".")}g.asCSSSelector=a;function l(v){return v&&typeof v=="object"&&typeof v.id=="string"&&(typeof v.color>"u"||Hte.isThemeColor(v.color))}g.isThemeIcon=l;let d=new RegExp(`^\\$\\((${g.iconNameExpression}(?:${g.iconModifierExpression})?)\\)$`);function c(v){let I=d.exec(v);if(!I)return;let[,y]=I;return{id:y}}g.fromString=c;function p(v){return{id:v}}g.fromId=p;function h(v,I){let y=v.id,w=y.lastIndexOf("~");return w!==-1&&(y=y.substring(0,w)),I&&(y=`${y}~${I}`),{id:y}}g.modify=h;function m(v){let I=v.id.lastIndexOf("~");if(I!==-1)return v.id.substring(I+1)}g.getModifier=m;function f(v,I){return v.id===I.id&&v.color?.id===I.color?.id}g.isEqual=f})(de||={});var jbe="$(",bK=new RegExp(`\\$\\(${de.iconNameExpression}(?:${de.iconModifierExpression})?\\)`,"g"),Xbe=new RegExp(`(\\\\)?${bK.source}`,"g");function Ute(r){return r.replace(Xbe,(t,e)=>e?t:`\\${t}`)}var Ybe=new RegExp(`\\\\${bK.source}`,"g");function zte(r){return r.replace(Ybe,t=>`\\${t}`)}var Qbe=new RegExp(`(\\s)?(\\\\)?${bK.source}(\\s)?`,"g");function pD(r){return r.indexOf(jbe)===-1?r:r.replace(Qbe,(t,e,i,n)=>i?t:e||n||"")}var M0e=new RegExp(`\\$\\(${de.iconNameCharacter}+\\)`,"g");var Sn=class{value;isTrusted;supportThemeIcons;supportHtml;baseUri;constructor(t="",e=!1){if(this.value=t,typeof this.value!="string")throw Uc("value");typeof e=="boolean"?(this.isTrusted=e,this.supportThemeIcons=!1,this.supportHtml=!1):(this.isTrusted=e.isTrusted??void 0,this.supportThemeIcons=e.supportThemeIcons??!1,this.supportHtml=e.supportHtml??!1)}appendText(t,e=0){return this.value+=Zbe(this.supportThemeIcons?Ute(t):t).replace(/([ \t]+)/g,(i,n)=>"&nbsp;".repeat(n.length)).replace(/\>/gm,"\\>").replace(/\n/g,e===1?`\\
`:`

`),this}appendMarkdown(t){return this.value+=t,this}appendCodeblock(t,e){return this.value+=`
${Jbe(e,t)}
`,this}appendLink(t,e,i){return this.value+="[",this.value+=this._escape(e,"]"),this.value+="](",this.value+=this._escape(String(t),")"),i&&(this.value+=` "${this._escape(this._escape(i,'"'),")")}"`),this.value+=")",this}_escape(t,e){let i=new RegExp(ba(e),"g");return t.replace(i,(n,o)=>t.charAt(o-1)!=="\\"?`\\${n}`:n)}};function oI(r){return ya(r)?!r.value:Array.isArray(r)?r.every(oI):!0}function ya(r){return r instanceof Sn?!0:r&&typeof r=="object"?typeof r.value=="string"&&(typeof r.isTrusted=="boolean"||typeof r.isTrusted=="object"||r.isTrusted===void 0)&&(typeof r.supportThemeIcons=="boolean"||r.supportThemeIcons===void 0):!1}function YA(r,t){return r===t?!0:!r||!t?!1:r.value===t.value&&r.isTrusted===t.isTrusted&&r.supportThemeIcons===t.supportThemeIcons&&r.supportHtml===t.supportHtml&&(r.baseUri===t.baseUri||!!r.baseUri&&!!t.baseUri&&zi(Z.from(r.baseUri),Z.from(t.baseUri)))}function Zbe(r){return r.replace(/[\\`*_{}[\]()#+\-!~]/g,"\\$&")}function Jbe(r,t){let e=r.match(/^`+/gm)?.reduce((n,o)=>n.length>o.length?n:o).length??0,i=e>=3?e+1:3;return[`${"`".repeat(i)}${t}`,r,`${"`".repeat(i)}`].join(`
`)}function hD(r){return r.replace(/"/g,"&quot;")}function QA(r){return r&&r.replace(/\\([\\`*_{}[\]()#+\-.!~])/g,"$1")}function Kte(r){let t=[],e=r.split("|").map(n=>n.trim());r=e[0];let i=e[1];if(i){let n=/height=(\d+)/.exec(i),o=/width=(\d+)/.exec(i),s=n?n[1]:"",a=o?o[1]:"",l=isFinite(parseInt(a)),d=isFinite(parseInt(s));l&&t.push(`width="${a}"`),d&&t.push(`height="${s}"`)}return{href:r,dimensions:t}}function Gte(r){let t=!1,e=new Map,i=new Map;if(eve(r,c=>{if(r===c)return!0;let p=JSON.stringify(c);if(p.length<30)return!0;let h=e.get(p);if(!h){let m={schemas:[c]};return e.set(p,m),i.set(c,m),!0}return h.schemas.push(c),i.set(c,h),t=!0,!1}),e.clear(),!t)return JSON.stringify(r);let o="$defs";for(;r.hasOwnProperty(o);)o+="_";let s=[];function a(c){return JSON.stringify(c,(p,h)=>{if(h!==c){let m=i.get(h);if(m&&m.schemas.length>1)return m.id||(m.id=`_${s.length}`,s.push(m.schemas[0])),{$ref:`#/${o}/${m.id}`}}return h})}let l=a(r),d=[];for(let c=0;c<s.length;c++)d.push(`"_${c}":${a(s[c])}`);return d.length?`${l.substring(0,l.length-1)},"${o}":{${d.join(",")}}}`:l}function eC(r){return typeof r=="object"&&r!==null}function eve(r,t){if(!r||typeof r!="object")return;let e=(...l)=>{for(let d of l)eC(d)&&s.push(d)},i=(...l)=>{for(let d of l)if(eC(d))for(let c in d){let p=d[c];eC(p)&&s.push(p)}},n=(...l)=>{for(let d of l)if(Array.isArray(d))for(let c of d)eC(c)&&s.push(c)},o=l=>{if(Array.isArray(l))for(let d of l)eC(d)&&s.push(d);else eC(l)&&s.push(l)},s=[r],a=s.pop();for(;a;)t(a)&&(e(a.additionalItems,a.additionalProperties,a.not,a.contains,a.propertyNames,a.if,a.then,a.else,a.unevaluatedItems,a.unevaluatedProperties),i(a.definitions,a.$defs,a.properties,a.patternProperties,a.dependencies,a.dependentSchemas),n(a.anyOf,a.allOf,a.oneOf,a.prefixItems),o(a.items)),a=s.pop()}var IK=class r{constructor(t,e,i,n,o,s,a){this._forceIntegerValues=t;this._forceIntegerValues&&(e=e|0,i=i|0,n=n|0,o=o|0,s=s|0,a=a|0),this.rawScrollLeft=n,this.rawScrollTop=a,e<0&&(e=0),n+e>i&&(n=i-e),n<0&&(n=0),o<0&&(o=0),a+o>s&&(a=s-o),a<0&&(a=0),this.width=e,this.scrollWidth=i,this.scrollLeft=n,this.height=o,this.scrollHeight=s,this.scrollTop=a}_scrollStateBrand=void 0;rawScrollLeft;rawScrollTop;width;scrollWidth;scrollLeft;height;scrollHeight;scrollTop;equals(t){return this.rawScrollLeft===t.rawScrollLeft&&this.rawScrollTop===t.rawScrollTop&&this.width===t.width&&this.scrollWidth===t.scrollWidth&&this.scrollLeft===t.scrollLeft&&this.height===t.height&&this.scrollHeight===t.scrollHeight&&this.scrollTop===t.scrollTop}withScrollDimensions(t,e){return new r(this._forceIntegerValues,typeof t.width<"u"?t.width:this.width,typeof t.scrollWidth<"u"?t.scrollWidth:this.scrollWidth,e?this.rawScrollLeft:this.scrollLeft,typeof t.height<"u"?t.height:this.height,typeof t.scrollHeight<"u"?t.scrollHeight:this.scrollHeight,e?this.rawScrollTop:this.scrollTop)}withScrollPosition(t){return new r(this._forceIntegerValues,this.width,this.scrollWidth,typeof t.scrollLeft<"u"?t.scrollLeft:this.rawScrollLeft,this.height,this.scrollHeight,typeof t.scrollTop<"u"?t.scrollTop:this.rawScrollTop)}createScrollEvent(t,e){let i=this.width!==t.width,n=this.scrollWidth!==t.scrollWidth,o=this.scrollLeft!==t.scrollLeft,s=this.height!==t.height,a=this.scrollHeight!==t.scrollHeight,l=this.scrollTop!==t.scrollTop;return{inSmoothScrolling:e,oldWidth:t.width,oldScrollWidth:t.scrollWidth,oldScrollLeft:t.scrollLeft,width:this.width,scrollWidth:this.scrollWidth,scrollLeft:this.scrollLeft,oldHeight:t.height,oldScrollHeight:t.scrollHeight,oldScrollTop:t.scrollTop,height:this.height,scrollHeight:this.scrollHeight,scrollTop:this.scrollTop,widthChanged:i,scrollWidthChanged:n,scrollLeftChanged:o,heightChanged:s,scrollHeightChanged:a,scrollTopChanged:l}}},iu=class extends R{_scrollableBrand=void 0;_smoothScrollDuration;_scheduleAtNextAnimationFrame;_state;_smoothScrolling;_onScroll=this._register(new x);onScroll=this._onScroll.event;constructor(t){super(),this._smoothScrollDuration=t.smoothScrollDuration,this._scheduleAtNextAnimationFrame=t.scheduleAtNextAnimationFrame,this._state=new IK(t.forceIntegerValues,0,0,0,0,0,0),this._smoothScrolling=null}dispose(){this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),super.dispose()}setSmoothScrollDuration(t){this._smoothScrollDuration=t}validateScrollPosition(t){return this._state.withScrollPosition(t)}getScrollDimensions(){return this._state}setScrollDimensions(t,e){let i=this._state.withScrollDimensions(t,e);this._setState(i,!!this._smoothScrolling),this._smoothScrolling?.acceptScrollDimensions(this._state)}getFutureScrollPosition(){return this._smoothScrolling?this._smoothScrolling.to:this._state}getCurrentScrollPosition(){return this._state}setScrollPositionNow(t){let e=this._state.withScrollPosition(t);this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),this._setState(e,!1)}setScrollPositionSmooth(t,e){if(this._smoothScrollDuration===0)return this.setScrollPositionNow(t);if(this._smoothScrolling){t={scrollLeft:typeof t.scrollLeft>"u"?this._smoothScrolling.to.scrollLeft:t.scrollLeft,scrollTop:typeof t.scrollTop>"u"?this._smoothScrolling.to.scrollTop:t.scrollTop};let i=this._state.withScrollPosition(t);if(this._smoothScrolling.to.scrollLeft===i.scrollLeft&&this._smoothScrolling.to.scrollTop===i.scrollTop)return;let n;e?n=new JA(this._smoothScrolling.from,i,this._smoothScrolling.startTime,this._smoothScrolling.duration):n=this._smoothScrolling.combine(this._state,i,this._smoothScrollDuration),this._smoothScrolling.dispose(),this._smoothScrolling=n}else{let i=this._state.withScrollPosition(t);this._smoothScrolling=JA.start(this._state,i,this._smoothScrollDuration)}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())})}hasPendingScrollAnimation(){return!!this._smoothScrolling}_performSmoothScrolling(){if(!this._smoothScrolling)return;let t=this._smoothScrolling.tick(),e=this._state.withScrollPosition(t);if(this._setState(e,!0),!!this._smoothScrolling){if(t.isDone){this._smoothScrolling.dispose(),this._smoothScrolling=null;return}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())})}}_setState(t,e){let i=this._state;i.equals(t)||(this._state=t,this._onScroll.fire(this._state.createScrollEvent(i,e)))}},ZA=class{scrollLeft;scrollTop;isDone;constructor(t,e,i){this.scrollLeft=t,this.scrollTop=e,this.isDone=i}};function vK(r,t){let e=t-r;return function(i){return r+e*nve(i)}}function tve(r,t,e){return function(i){return i<e?r(i/e):t((i-e)/(1-e))}}var JA=class r{from;to;duration;startTime;animationFrameDisposable;scrollLeft;scrollTop;constructor(t,e,i,n){this.from=t,this.to=e,this.duration=n,this.startTime=i,this.animationFrameDisposable=null,this._initAnimations()}_initAnimations(){this.scrollLeft=this._initAnimation(this.from.scrollLeft,this.to.scrollLeft,this.to.width),this.scrollTop=this._initAnimation(this.from.scrollTop,this.to.scrollTop,this.to.height)}_initAnimation(t,e,i){if(Math.abs(t-e)>2.5*i){let o,s;return t<e?(o=t+.75*i,s=e-.75*i):(o=t-.75*i,s=e+.75*i),tve(vK(t,o),vK(s,e),.33)}return vK(t,e)}dispose(){this.animationFrameDisposable!==null&&(this.animationFrameDisposable.dispose(),this.animationFrameDisposable=null)}acceptScrollDimensions(t){this.to=t.withScrollPosition(this.to),this._initAnimations()}tick(){return this._tick(Date.now())}_tick(t){let e=(t-this.startTime)/this.duration;if(e<1){let i=this.scrollLeft(e),n=this.scrollTop(e);return new ZA(i,n,!1)}return new ZA(this.to.scrollLeft,this.to.scrollTop,!0)}combine(t,e,i){return r.start(t,e,i)}static start(t,e,i){i=i+10;let n=Date.now()-10;return new r(t,e,n,i)}};function ive(r){return Math.pow(r,3)}function nve(r){return 1-ive(1-r)}var Lp={tabSize:4,indentSize:4,insertSpaces:!0,detectIndentation:!0,trimAutoWhitespace:!0,largeFileOptimizations:!0,bracketPairColorizationOptions:{enabled:!0,independentColorPoolPerBracketType:!1}};var yK="`~!@#$%^&*()-=+[{]}\\|;:'\",.<>/?";function ove(r=""){let t="(-?\\d*\\.\\d\\w*)|([^";for(let e of yK)r.indexOf(e)>=0||(t+="\\"+e);return t+="\\s]+)",new RegExp(t,"g")}var rI=ove();function mD(r){let t=rI;if(r&&r instanceof RegExp)if(r.global)t=r;else{let e="g";r.ignoreCase&&(e+="i"),r.multiline&&(e+="m"),r.unicode&&(e+="u"),t=new RegExp(r.source,e)}return t.lastIndex=0,t}var qte=new lr;qte.unshift({maxLen:1e3,windowSize:15,timeBudget:150});function gD(r,t,e,i,n){if(t=mD(t),n||(n=mt.first(qte)),e.length>n.maxLen){let d=r-n.maxLen/2;return d<0?d=0:i+=d,e=e.substring(d,r+n.maxLen/2),gD(r,t,e,i,n)}let o=Date.now(),s=r-1-i,a=-1,l=null;for(let d=1;!(Date.now()-o>=n.timeBudget);d++){let c=s-n.windowSize*d;t.lastIndex=Math.max(0,c);let p=rve(t,e,s,a);if(!p&&l||(l=p,c<=0))break;a=c}if(l){let d={word:l[0],startColumn:i+1+l.index,endColumn:i+1+l.index+l[0].length};return t.lastIndex=0,d}return null}function rve(r,t,e,i){let n;for(;n=r.exec(t);){let o=n.index||0;if(o<=e&&r.lastIndex>=e)return n;if(i>0&&o>i)return null}return null}function SK(...r){switch(r.length){case 1:return u("contextkey.scanner.hint.didYouMean1","Did you mean {0}?",r[0]);case 2:return u("contextkey.scanner.hint.didYouMean2","Did you mean {0} or {1}?",r[0],r[1]);case 3:return u("contextkey.scanner.hint.didYouMean3","Did you mean {0}, {1} or {2}?",r[0],r[1],r[2]);default:return}}var sve=u("contextkey.scanner.hint.didYouForgetToOpenOrCloseQuote","Did you forget to open or close the quote?"),ave=u("contextkey.scanner.hint.didYouForgetToEscapeSlash","Did you forget to escape the '/' (slash) character? Put two backslashes before it to escape, e.g., '\\\\/'."),gf=class r{static getLexeme(t){switch(t.type){case 0:return"(";case 1:return")";case 2:return"!";case 3:return t.isTripleEq?"===":"==";case 4:return t.isTripleEq?"!==":"!=";case 5:return"<";case 6:return"<=";case 7:return">=";case 8:return">=";case 9:return"=~";case 10:return t.lexeme;case 11:return"true";case 12:return"false";case 13:return"in";case 14:return"not";case 15:return"&&";case 16:return"||";case 17:return t.lexeme;case 18:return t.lexeme;case 19:return t.lexeme;case 20:return"EOF";default:throw JZ(`unhandled token type: ${JSON.stringify(t)}; have you forgotten to add a case?`)}}static _regexFlags=new Set(["i","g","s","m","y","u"].map(t=>t.charCodeAt(0)));static _keywords=new Map([["not",14],["in",13],["false",12],["true",11]]);_input="";_start=0;_current=0;_tokens=[];_errors=[];get errors(){return this._errors}reset(t){return this._input=t,this._start=0,this._current=0,this._tokens=[],this._errors=[],this}scan(){for(;!this._isAtEnd();)switch(this._start=this._current,this._advance()){case 40:this._addToken(0);break;case 41:this._addToken(1);break;case 33:if(this._match(61)){let e=this._match(61);this._tokens.push({type:4,offset:this._start,isTripleEq:e})}else this._addToken(2);break;case 39:this._quotedString();break;case 47:this._regex();break;case 61:if(this._match(61)){let e=this._match(61);this._tokens.push({type:3,offset:this._start,isTripleEq:e})}else this._match(126)?this._addToken(9):this._error(SK("==","=~"));break;case 60:this._addToken(this._match(61)?6:5);break;case 62:this._addToken(this._match(61)?8:7);break;case 38:this._match(38)?this._addToken(15):this._error(SK("&&"));break;case 124:this._match(124)?this._addToken(16):this._error(SK("||"));break;case 32:case 13:case 9:case 10:case 160:break;default:this._string()}return this._start=this._current,this._addToken(20),Array.from(this._tokens)}_match(t){return this._isAtEnd()||this._input.charCodeAt(this._current)!==t?!1:(this._current++,!0)}_advance(){return this._input.charCodeAt(this._current++)}_peek(){return this._isAtEnd()?0:this._input.charCodeAt(this._current)}_addToken(t){this._tokens.push({type:t,offset:this._start})}_error(t){let e=this._start,i=this._input.substring(this._start,this._current),n={type:19,offset:this._start,lexeme:i};this._errors.push({offset:e,lexeme:i,additionalInfo:t}),this._tokens.push(n)}stringRe=/[a-zA-Z0-9_<>\-\./\\:\*\?\+\[\]\^,#@;"%\$\p{L}-]+/uy;_string(){this.stringRe.lastIndex=this._start;let t=this.stringRe.exec(this._input);if(t){this._current=this._start+t[0].length;let e=this._input.substring(this._start,this._current),i=r._keywords.get(e);i?this._addToken(i):this._tokens.push({type:17,lexeme:e,offset:this._start})}}_quotedString(){for(;this._peek()!==39&&!this._isAtEnd();)this._advance();if(this._isAtEnd()){this._error(sve);return}this._advance(),this._tokens.push({type:18,lexeme:this._input.substring(this._start+1,this._current-1),offset:this._start+1})}_regex(){let t=this._current,e=!1,i=!1;for(;;){if(t>=this._input.length){this._current=t,this._error(ave);return}let o=this._input.charCodeAt(t);if(e)e=!1;else if(o===47&&!i){t++;break}else o===91?i=!0:o===92?e=!0:o===93&&(i=!1);t++}for(;t<this._input.length&&r._regexFlags.has(this._input.charCodeAt(t));)t++;this._current=t;let n=this._input.substring(this._start,this._current);this._tokens.push({type:10,lexeme:n,offset:this._start})}_isAtEnd(){return this._current>=this._input.length}};var qr=class{ctor;staticArguments;supportsDelayedInstantiation;constructor(t,e=[],i=!1){this.ctor=t,this.staticArguments=e,this.supportsDelayedInstantiation=i}};var el=class{_entries=new Map;constructor(...t){for(let[e,i]of t)this.set(e,i)}set(t,e){let i=this._entries.get(t);return this._entries.set(t,e),i}has(t){return this._entries.has(t)}get(t){return this._entries.get(t)}};var ff;(n=>{n.serviceIds=new Map,n.DI_TARGET="$di$target",n.DI_DEPENDENCIES="$di$dependencies";function i(o){return o[n.DI_DEPENDENCIES]||[]}n.getServiceDependencies=i})(ff||={});var ne=q("instantiationService");function lve(r,t,e){t[ff.DI_TARGET]===t?t[ff.DI_DEPENDENCIES].push({id:r,index:e}):(t[ff.DI_DEPENDENCIES]=[{id:r,index:e}],t[ff.DI_TARGET]=t)}function q(r){if(ff.serviceIds.has(r))return ff.serviceIds.get(r);let t=function(e,i,n){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");lve(t,e,n)};return t.toString=()=>r,ff.serviceIds.set(r,t),t}var bs=new Map;bs.set("false",!1);bs.set("true",!0);bs.set("isMac",ye);bs.set("isLinux",ci);bs.set("isWindows",St);bs.set("isWeb",si);bs.set("isMacNative",ye&&!si);bs.set("isEdge",uJ);bs.set("isFirefox",NM);bs.set("isChrome",z5);bs.set("isSafari",cJ);var dve=Object.prototype.hasOwnProperty;var cve={regexParsingWithErrorRecovery:!0},uve=u("contextkey.parser.error.emptyString","Empty context key expression"),pve=u("contextkey.parser.error.emptyString.hint","Did you forget to write an expression? You can also put 'false' or 'true' to always evaluate to false or true, respectively."),hve=u("contextkey.parser.error.noInAfterNot","'in' after 'not'."),$te=u("contextkey.parser.error.closingParenthesis","closing parenthesis ')'"),mve=u("contextkey.parser.error.unexpectedToken","Unexpected token"),gve=u("contextkey.parser.error.unexpectedToken.hint","Did you forget to put && or || before the token?"),fve=u("contextkey.parser.error.unexpectedEOF","Unexpected end of expression"),bve=u("contextkey.parser.error.unexpectedEOF.hint","Did you forget to put a context key?"),CK=class r{constructor(t=cve){this._config=t}static _parseError=new Error;_scanner=new gf;_tokens=[];_current=0;_parsingErrors=[];get lexingErrors(){return this._scanner.errors}get parsingErrors(){return this._parsingErrors}parse(t){if(t===""){this._parsingErrors.push({message:uve,offset:0,lexeme:"",additionalInfo:pve});return}this._tokens=this._scanner.reset(t).scan(),this._current=0,this._parsingErrors=[];try{let e=this._expr();if(!this._isAtEnd()){let i=this._peek(),n=i.type===17?gve:void 0;throw this._parsingErrors.push({message:mve,offset:i.offset,lexeme:gf.getLexeme(i),additionalInfo:n}),r._parseError}return e}catch(e){if(e!==r._parseError)throw e;return}}_expr(){return this._or()}_or(){let t=[this._and()];for(;this._matchOne(16);){let e=this._and();t.push(e)}return t.length===1?t[0]:P.or(...t)}_and(){let t=[this._term()];for(;this._matchOne(15);){let e=this._term();t.push(e)}return t.length===1?t[0]:P.and(...t)}_term(){if(this._matchOne(2)){let t=this._peek();switch(t.type){case 11:return this._advance(),Js.INSTANCE;case 12:return this._advance(),Sa.INSTANCE;case 0:{this._advance();let e=this._expr();return this._consume(1,$te),e?.negate()}case 17:return this._advance(),aI.create(t.lexeme);default:throw this._errExpectedButGot("KEY | true | false | '(' expression ')'",t)}}return this._primary()}_primary(){let t=this._peek();switch(t.type){case 11:return this._advance(),P.true();case 12:return this._advance(),P.false();case 0:{this._advance();let e=this._expr();return this._consume(1,$te),e}case 17:{let e=t.lexeme;if(this._advance(),this._matchOne(9)){let n=this._peek();if(!this._config.regexParsingWithErrorRecovery){if(this._advance(),n.type!==10)throw this._errExpectedButGot("REGEX",n);let o=n.lexeme,s=o.lastIndexOf("/"),a=s===o.length-1?void 0:this._removeFlagsGY(o.substring(s+1)),l;try{l=new RegExp(o.substring(1,s),a)}catch{throw this._errExpectedButGot("REGEX",n)}return wD.create(e,l)}switch(n.type){case 10:case 19:{let o=[n.lexeme];this._advance();let s=this._peek(),a=0;for(let h=0;h<n.lexeme.length;h++)n.lexeme.charCodeAt(h)===40?a++:n.lexeme.charCodeAt(h)===41&&a--;for(;!this._isAtEnd()&&s.type!==15&&s.type!==16;){switch(s.type){case 0:a++;break;case 1:a--;break;case 10:case 18:for(let h=0;h<s.lexeme.length;h++)s.lexeme.charCodeAt(h)===40?a++:n.lexeme.charCodeAt(h)===41&&a--}if(a<0)break;o.push(gf.getLexeme(s)),this._advance(),s=this._peek()}let l=o.join(""),d=l.lastIndexOf("/"),c=d===l.length-1?void 0:this._removeFlagsGY(l.substring(d+1)),p;try{p=new RegExp(l.substring(1,d),c)}catch{throw this._errExpectedButGot("REGEX",n)}return P.regex(e,p)}case 18:{let o=n.lexeme;this._advance();let s=null;if(!gd(o)){let a=o.indexOf("/"),l=o.lastIndexOf("/");if(a!==l&&a>=0){let d=o.slice(a+1,l),c=o[l+1]==="i"?"i":"";try{s=new RegExp(d,c)}catch{throw this._errExpectedButGot("REGEX",n)}}}if(s===null)throw this._errExpectedButGot("REGEX",n);return wD.create(e,s)}default:throw this._errExpectedButGot("REGEX",this._peek())}}if(this._matchOne(14)){this._consume(13,hve);let n=this._value();return P.notIn(e,n)}switch(this._peek().type){case 3:{this._advance();let n=this._value();if(this._previous().type===18)return P.equals(e,n);switch(n){case"true":return P.has(e);case"false":return P.not(e);default:return P.equals(e,n)}}case 4:{this._advance();let n=this._value();if(this._previous().type===18)return P.notEquals(e,n);switch(n){case"true":return P.not(e);case"false":return P.has(e);default:return P.notEquals(e,n)}}case 5:return this._advance(),SD.create(e,this._value());case 6:return this._advance(),CD.create(e,this._value());case 7:return this._advance(),ID.create(e,this._value());case 8:return this._advance(),yD.create(e,this._value());case 13:return this._advance(),P.in(e,this._value());default:return P.has(e)}}case 20:throw this._parsingErrors.push({message:fve,offset:t.offset,lexeme:"",additionalInfo:bve}),r._parseError;default:throw this._errExpectedButGot(`true | false | KEY 
	| KEY '=~' REGEX 
	| KEY ('==' | '!=' | '<' | '<=' | '>' | '>=' | 'in' | 'not' 'in') value`,this._peek())}}_value(){let t=this._peek();switch(t.type){case 17:case 18:return this._advance(),t.lexeme;case 11:return this._advance(),"true";case 12:return this._advance(),"false";case 13:return this._advance(),"in";default:return""}}_flagsGYRe=/g|y/g;_removeFlagsGY(t){return t.replaceAll(this._flagsGYRe,"")}_previous(){return this._tokens[this._current-1]}_matchOne(t){return this._check(t)?(this._advance(),!0):!1}_advance(){return this._isAtEnd()||this._current++,this._previous()}_consume(t,e){if(this._check(t))return this._advance();throw this._errExpectedButGot(e,this._peek())}_errExpectedButGot(t,e,i){let n=u("contextkey.parser.error.expectedButGot",`Expected: {0}
Received: '{1}'.`,t,gf.getLexeme(e)),o=e.offset,s=gf.getLexeme(e);return this._parsingErrors.push({message:n,offset:o,lexeme:s,additionalInfo:i}),r._parseError}_check(t){return this._peek().type===t}_peek(){return this._tokens[this._current]}_isAtEnd(){return this._peek().type===20}},P=class{static false(){return Js.INSTANCE}static true(){return Sa.INSTANCE}static has(t){return sI.create(t)}static equals(t,e){return bD.create(t,e)}static notEquals(t,e){return vD.create(t,e)}static regex(t,e){return wD.create(t,e)}static in(t,e){return eO.create(t,e)}static notIn(t,e){return tO.create(t,e)}static not(t){return aI.create(t)}static and(...t){return iO.create(t,null,!0)}static or(...t){return ED.create(t,null,!0)}static greater(t,e){return ID.create(t,e)}static greaterEquals(t,e){return yD.create(t,e)}static smaller(t,e){return SD.create(t,e)}static smallerEquals(t,e){return CD.create(t,e)}static _parser=new CK({regexParsingWithErrorRecovery:!1});static deserialize(t){return t==null?void 0:this._parser.parse(t)}};function fD(r,t){return r.cmp(t)}var Js=class r{static INSTANCE=new r;type=0;constructor(){}cmp(t){return this.type-t.type}equals(t){return t.type===this.type}substituteConstants(){return this}evaluate(t){return!1}serialize(){return"false"}keys(){return[]}map(t){return this}negate(){return Sa.INSTANCE}},Sa=class r{static INSTANCE=new r;type=1;constructor(){}cmp(t){return this.type-t.type}equals(t){return t.type===this.type}substituteConstants(){return this}evaluate(t){return!0}serialize(){return"true"}keys(){return[]}map(t){return this}negate(){return Js.INSTANCE}},sI=class r{constructor(t,e){this.key=t;this.negated=e}static create(t,e=null){let i=bs.get(t);return typeof i=="boolean"?i?Sa.INSTANCE:Js.INSTANCE:new r(t,e)}type=2;cmp(t){return t.type!==this.type?this.type-t.type:Yte(this.key,t.key)}equals(t){return t.type===this.type?this.key===t.key:!1}substituteConstants(){let t=bs.get(this.key);return typeof t=="boolean"?t?Sa.INSTANCE:Js.INSTANCE:this}evaluate(t){return!!t.getValue(this.key)}serialize(){return this.key}keys(){return[this.key]}map(t){return t.mapDefined(this.key)}negate(){return this.negated||(this.negated=aI.create(this.key,this)),this.negated}},bD=class r{constructor(t,e,i){this.key=t;this.value=e;this.negated=i}static create(t,e,i=null){if(typeof e=="boolean")return e?sI.create(t,i):aI.create(t,i);let n=bs.get(t);return typeof n=="boolean"?e===(n?"true":"false")?Sa.INSTANCE:Js.INSTANCE:new r(t,e,i)}type=4;cmp(t){return t.type!==this.type?this.type-t.type:lI(this.key,this.value,t.key,t.value)}equals(t){return t.type===this.type?this.key===t.key&&this.value===t.value:!1}substituteConstants(){let t=bs.get(this.key);if(typeof t=="boolean"){let e=t?"true":"false";return this.value===e?Sa.INSTANCE:Js.INSTANCE}return this}evaluate(t){return t.getValue(this.key)==this.value}serialize(){return`${this.key} == '${this.value}'`}keys(){return[this.key]}map(t){return t.mapEquals(this.key,this.value)}negate(){return this.negated||(this.negated=vD.create(this.key,this.value,this)),this.negated}},eO=class r{constructor(t,e){this.key=t;this.valueKey=e}static create(t,e){return new r(t,e)}type=10;negated=null;cmp(t){return t.type!==this.type?this.type-t.type:lI(this.key,this.valueKey,t.key,t.valueKey)}equals(t){return t.type===this.type?this.key===t.key&&this.valueKey===t.valueKey:!1}substituteConstants(){return this}evaluate(t){let e=t.getValue(this.valueKey),i=t.getValue(this.key);return Array.isArray(e)?e.includes(i):typeof i=="string"&&typeof e=="object"&&e!==null?dve.call(e,i):!1}serialize(){return`${this.key} in '${this.valueKey}'`}keys(){return[this.key,this.valueKey]}map(t){return t.mapIn(this.key,this.valueKey)}negate(){return this.negated||(this.negated=tO.create(this.key,this.valueKey)),this.negated}},tO=class r{constructor(t,e){this.key=t;this.valueKey=e;this._negated=eO.create(t,e)}static create(t,e){return new r(t,e)}type=11;_negated;cmp(t){return t.type!==this.type?this.type-t.type:this._negated.cmp(t._negated)}equals(t){return t.type===this.type?this._negated.equals(t._negated):!1}substituteConstants(){return this}evaluate(t){return!this._negated.evaluate(t)}serialize(){return`${this.key} not in '${this.valueKey}'`}keys(){return this._negated.keys()}map(t){return t.mapNotIn(this.key,this.valueKey)}negate(){return this._negated}},vD=class r{constructor(t,e,i){this.key=t;this.value=e;this.negated=i}static create(t,e,i=null){if(typeof e=="boolean")return e?aI.create(t,i):sI.create(t,i);let n=bs.get(t);return typeof n=="boolean"?e===(n?"true":"false")?Js.INSTANCE:Sa.INSTANCE:new r(t,e,i)}type=5;cmp(t){return t.type!==this.type?this.type-t.type:lI(this.key,this.value,t.key,t.value)}equals(t){return t.type===this.type?this.key===t.key&&this.value===t.value:!1}substituteConstants(){let t=bs.get(this.key);if(typeof t=="boolean"){let e=t?"true":"false";return this.value===e?Js.INSTANCE:Sa.INSTANCE}return this}evaluate(t){return t.getValue(this.key)!=this.value}serialize(){return`${this.key} != '${this.value}'`}keys(){return[this.key]}map(t){return t.mapNotEquals(this.key,this.value)}negate(){return this.negated||(this.negated=bD.create(this.key,this.value,this)),this.negated}},aI=class r{constructor(t,e){this.key=t;this.negated=e}static create(t,e=null){let i=bs.get(t);return typeof i=="boolean"?i?Js.INSTANCE:Sa.INSTANCE:new r(t,e)}type=3;cmp(t){return t.type!==this.type?this.type-t.type:Yte(this.key,t.key)}equals(t){return t.type===this.type?this.key===t.key:!1}substituteConstants(){let t=bs.get(this.key);return typeof t=="boolean"?t?Js.INSTANCE:Sa.INSTANCE:this}evaluate(t){return!t.getValue(this.key)}serialize(){return`!${this.key}`}keys(){return[this.key]}map(t){return t.mapNot(this.key)}negate(){return this.negated||(this.negated=sI.create(this.key,this)),this.negated}};function nO(r,t){if(typeof r=="string"){let e=parseFloat(r);isNaN(e)||(r=e)}return typeof r=="string"||typeof r=="number"?t(r):Js.INSTANCE}var ID=class r{constructor(t,e,i){this.key=t;this.value=e;this.negated=i}static create(t,e,i=null){return nO(e,n=>new r(t,n,i))}type=12;cmp(t){return t.type!==this.type?this.type-t.type:lI(this.key,this.value,t.key,t.value)}equals(t){return t.type===this.type?this.key===t.key&&this.value===t.value:!1}substituteConstants(){return this}evaluate(t){return typeof this.value=="string"?!1:parseFloat(t.getValue(this.key))>this.value}serialize(){return`${this.key} > ${this.value}`}keys(){return[this.key]}map(t){return t.mapGreater(this.key,this.value)}negate(){return this.negated||(this.negated=CD.create(this.key,this.value,this)),this.negated}},yD=class r{constructor(t,e,i){this.key=t;this.value=e;this.negated=i}static create(t,e,i=null){return nO(e,n=>new r(t,n,i))}type=13;cmp(t){return t.type!==this.type?this.type-t.type:lI(this.key,this.value,t.key,t.value)}equals(t){return t.type===this.type?this.key===t.key&&this.value===t.value:!1}substituteConstants(){return this}evaluate(t){return typeof this.value=="string"?!1:parseFloat(t.getValue(this.key))>=this.value}serialize(){return`${this.key} >= ${this.value}`}keys(){return[this.key]}map(t){return t.mapGreaterEquals(this.key,this.value)}negate(){return this.negated||(this.negated=SD.create(this.key,this.value,this)),this.negated}},SD=class r{constructor(t,e,i){this.key=t;this.value=e;this.negated=i}static create(t,e,i=null){return nO(e,n=>new r(t,n,i))}type=14;cmp(t){return t.type!==this.type?this.type-t.type:lI(this.key,this.value,t.key,t.value)}equals(t){return t.type===this.type?this.key===t.key&&this.value===t.value:!1}substituteConstants(){return this}evaluate(t){return typeof this.value=="string"?!1:parseFloat(t.getValue(this.key))<this.value}serialize(){return`${this.key} < ${this.value}`}keys(){return[this.key]}map(t){return t.mapSmaller(this.key,this.value)}negate(){return this.negated||(this.negated=yD.create(this.key,this.value,this)),this.negated}},CD=class r{constructor(t,e,i){this.key=t;this.value=e;this.negated=i}static create(t,e,i=null){return nO(e,n=>new r(t,n,i))}type=15;cmp(t){return t.type!==this.type?this.type-t.type:lI(this.key,this.value,t.key,t.value)}equals(t){return t.type===this.type?this.key===t.key&&this.value===t.value:!1}substituteConstants(){return this}evaluate(t){return typeof this.value=="string"?!1:parseFloat(t.getValue(this.key))<=this.value}serialize(){return`${this.key} <= ${this.value}`}keys(){return[this.key]}map(t){return t.mapSmallerEquals(this.key,this.value)}negate(){return this.negated||(this.negated=ID.create(this.key,this.value,this)),this.negated}},wD=class r{constructor(t,e){this.key=t;this.regexp=e}static create(t,e){return new r(t,e)}type=7;negated=null;cmp(t){if(t.type!==this.type)return this.type-t.type;if(this.key<t.key)return-1;if(this.key>t.key)return 1;let e=this.regexp?this.regexp.source:"",i=t.regexp?t.regexp.source:"";return e<i?-1:e>i?1:0}equals(t){if(t.type===this.type){let e=this.regexp?this.regexp.source:"",i=t.regexp?t.regexp.source:"";return this.key===t.key&&e===i}return!1}substituteConstants(){return this}evaluate(t){let e=t.getValue(this.key);return this.regexp?this.regexp.test(e):!1}serialize(){let t=this.regexp?`/${this.regexp.source}/${this.regexp.flags}`:"/invalid/";return`${this.key} =~ ${t}`}keys(){return[this.key]}map(t){return t.mapRegex(this.key,this.regexp)}negate(){return this.negated||(this.negated=wK.create(this)),this.negated}},wK=class r{constructor(t){this._actual=t}static create(t){return new r(t)}type=8;cmp(t){return t.type!==this.type?this.type-t.type:this._actual.cmp(t._actual)}equals(t){return t.type===this.type?this._actual.equals(t._actual):!1}substituteConstants(){return this}evaluate(t){return!this._actual.evaluate(t)}serialize(){return`!(${this._actual.serialize()})`}keys(){return this._actual.keys()}map(t){return new r(this._actual.map(t))}negate(){return this._actual}};function Xte(r){let t=null;for(let e=0,i=r.length;e<i;e++){let n=r[e].substituteConstants();if(r[e]!==n&&t===null){t=[];for(let o=0;o<e;o++)t[o]=r[o]}t!==null&&(t[e]=n)}return t===null?r:t}var iO=class r{constructor(t,e){this.expr=t;this.negated=e}static create(t,e,i){return r._normalizeArr(t,e,i)}type=6;cmp(t){if(t.type!==this.type)return this.type-t.type;if(this.expr.length<t.expr.length)return-1;if(this.expr.length>t.expr.length)return 1;for(let e=0,i=this.expr.length;e<i;e++){let n=fD(this.expr[e],t.expr[e]);if(n!==0)return n}return 0}equals(t){if(t.type===this.type){if(this.expr.length!==t.expr.length)return!1;for(let e=0,i=this.expr.length;e<i;e++)if(!this.expr[e].equals(t.expr[e]))return!1;return!0}return!1}substituteConstants(){let t=Xte(this.expr);return t===this.expr?this:r.create(t,this.negated,!1)}evaluate(t){for(let e=0,i=this.expr.length;e<i;e++)if(!this.expr[e].evaluate(t))return!1;return!0}static _normalizeArr(t,e,i){let n=[],o=!1;for(let s of t)if(s){if(s.type===1){o=!0;continue}if(s.type===0)return Js.INSTANCE;if(s.type===6){n.push(...s.expr);continue}n.push(s)}if(n.length===0&&o)return Sa.INSTANCE;if(n.length!==0){if(n.length===1)return n[0];n.sort(fD);for(let s=1;s<n.length;s++)n[s-1].equals(n[s])&&(n.splice(s,1),s--);if(n.length===1)return n[0];for(;n.length>1;){let s=n[n.length-1];if(s.type!==9)break;n.pop();let a=n.pop(),l=n.length===0,d=ED.create(s.expr.map(c=>r.create([c,a],null,i)),null,l);d&&(n.push(d),n.sort(fD))}if(n.length===1)return n[0];if(i){for(let s=0;s<n.length;s++)for(let a=s+1;a<n.length;a++)if(n[s].negate().equals(n[a]))return Js.INSTANCE;if(n.length===1)return n[0]}return new r(n,e)}}serialize(){return this.expr.map(t=>t.serialize()).join(" && ")}keys(){let t=[];for(let e of this.expr)t.push(...e.keys());return t}map(t){return new r(this.expr.map(e=>e.map(t)),null)}negate(){if(!this.negated){let t=[];for(let e of this.expr)t.push(e.negate());this.negated=ED.create(t,this,!0)}return this.negated}},ED=class r{constructor(t,e){this.expr=t;this.negated=e}static create(t,e,i){return r._normalizeArr(t,e,i)}type=9;cmp(t){if(t.type!==this.type)return this.type-t.type;if(this.expr.length<t.expr.length)return-1;if(this.expr.length>t.expr.length)return 1;for(let e=0,i=this.expr.length;e<i;e++){let n=fD(this.expr[e],t.expr[e]);if(n!==0)return n}return 0}equals(t){if(t.type===this.type){if(this.expr.length!==t.expr.length)return!1;for(let e=0,i=this.expr.length;e<i;e++)if(!this.expr[e].equals(t.expr[e]))return!1;return!0}return!1}substituteConstants(){let t=Xte(this.expr);return t===this.expr?this:r.create(t,this.negated,!1)}evaluate(t){for(let e=0,i=this.expr.length;e<i;e++)if(this.expr[e].evaluate(t))return!0;return!1}static _normalizeArr(t,e,i){let n=[],o=!1;if(t){for(let s=0,a=t.length;s<a;s++){let l=t[s];if(l){if(l.type===0){o=!0;continue}if(l.type===1)return Sa.INSTANCE;if(l.type===9){n=n.concat(l.expr);continue}n.push(l)}}if(n.length===0&&o)return Js.INSTANCE;n.sort(fD)}if(n.length!==0){if(n.length===1)return n[0];for(let s=1;s<n.length;s++)n[s-1].equals(n[s])&&(n.splice(s,1),s--);if(n.length===1)return n[0];if(i){for(let s=0;s<n.length;s++)for(let a=s+1;a<n.length;a++)if(n[s].negate().equals(n[a]))return Sa.INSTANCE;if(n.length===1)return n[0]}return new r(n,e)}}serialize(){return this.expr.map(t=>t.serialize()).join(" || ")}keys(){let t=[];for(let e of this.expr)t.push(...e.keys());return t}map(t){return new r(this.expr.map(e=>e.map(t)),null)}negate(){if(!this.negated){let t=[];for(let e of this.expr)t.push(e.negate());for(;t.length>1;){let e=t.shift(),i=t.shift(),n=[];for(let o of jte(e))for(let s of jte(i))n.push(iO.create([o,s],null,!1));t.unshift(r.create(n,null,!1))}this.negated=r.create(t,this,!0)}return this.negated}},A=class r extends sI{static _info=[];static all(){return r._info.values()}_defaultValue;constructor(t,e,i){super(t,null),this._defaultValue=e,typeof i=="object"?r._info.push({...i,key:t}):i!==!0&&r._info.push({key:t,description:i,type:e!=null?typeof e:void 0})}bindTo(t){return t.createKey(this.key,this._defaultValue)}getValue(t){return t.getContextKeyValue(this.key)}toNegated(){return this.negate()}isEqualTo(t){return bD.create(this.key,t)}notEqualsTo(t){return vD.create(this.key,t)}},re=q("contextKeyService");function Yte(r,t){return r<t?-1:r>t?1:0}function lI(r,t,e,i){return r<e?-1:r>e?1:t<i?-1:t>i?1:0}function jte(r){return r.type===9?r.expr:[r]}var Un=q("accessibilityService");var ANe=new A("accessibilityModeEnabled",!1);var Qte="ACCESSIBLE_VIEW_SHOWN_";var EK=class{_value="";_pos=0;reset(t){return this._value=t,this._pos=0,this}next(){return this._pos+=1,this}hasNext(){return this._pos<this._value.length-1}cmp(t){let e=t.charCodeAt(0),i=this._value.charCodeAt(this._pos);return e-i}value(){return this._value[this._pos]}},xK=class{constructor(t=!0){this._caseSensitive=t}_value;_from;_to;reset(t){return this._value=t,this._from=0,this._to=0,this.next()}hasNext(){return this._to<this._value.length}next(){this._from=this._to;let t=!0;for(;this._to<this._value.length;this._to++)if(this._value.charCodeAt(this._to)===46)if(t)this._from++;else break;else t=!1;return this}cmp(t){return this._caseSensitive?NS(t,this._value,0,t.length,this._from,this._to):FS(t,this._value,0,t.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}},oO=class{constructor(t=!0,e=!0){this._splitOnBackslash=t;this._caseSensitive=e}_value;_valueLen;_from;_to;reset(t){this._from=0,this._to=0,this._value=t,this._valueLen=t.length;for(let e=t.length-1;e>=0;e--,this._valueLen--){let i=this._value.charCodeAt(e);if(!(i===47||this._splitOnBackslash&&i===92))break}return this.next()}hasNext(){return this._to<this._valueLen}next(){this._from=this._to;let t=!0;for(;this._to<this._valueLen;this._to++){let e=this._value.charCodeAt(this._to);if(e===47||this._splitOnBackslash&&e===92)if(t)this._from++;else break;else t=!1}return this}cmp(t){return this._caseSensitive?NS(t,this._value,0,t.length,this._from,this._to):FS(t,this._value,0,t.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}};var TK=class{constructor(t,e){this._ignorePathCasing=t;this._ignoreQueryAndFragment=e}_pathIterator;_value;_states=[];_stateIdx=0;reset(t){return this._value=t,this._states=[],this._value.scheme&&this._states.push(1),this._value.authority&&this._states.push(2),this._value.path&&(this._pathIterator=new oO(!1,!this._ignorePathCasing(t)),this._pathIterator.reset(t.path),this._pathIterator.value()&&this._states.push(3)),this._ignoreQueryAndFragment(t)||(this._value.query&&this._states.push(4),this._value.fragment&&this._states.push(5)),this._stateIdx=0,this}next(){return this._states[this._stateIdx]===3&&this._pathIterator.hasNext()?this._pathIterator.next():this._stateIdx+=1,this}hasNext(){return this._states[this._stateIdx]===3&&this._pathIterator.hasNext()||this._stateIdx<this._states.length-1}cmp(t){if(this._states[this._stateIdx]===1)return fm(t,this._value.scheme);if(this._states[this._stateIdx]===2)return fm(t,this._value.authority);if(this._states[this._stateIdx]===3)return this._pathIterator.cmp(t);if(this._states[this._stateIdx]===4)return Zg(t,this._value.query);if(this._states[this._stateIdx]===5)return Zg(t,this._value.fragment);throw new Error}value(){if(this._states[this._stateIdx]===1)return this._value.scheme;if(this._states[this._stateIdx]===2)return this._value.authority;if(this._states[this._stateIdx]===3)return this._pathIterator.value();if(this._states[this._stateIdx]===4)return this._value.query;if(this._states[this._stateIdx]===5)return this._value.fragment;throw new Error}},tC=class{height=1;segment;value;key;left;mid;right;isEmpty(){return!this.left&&!this.mid&&!this.right&&!this.value}rotateLeft(){let t=this.right;return this.right=t.left,t.left=this,this.updateHeight(),t.updateHeight(),t}rotateRight(){let t=this.left;return this.left=t.right,t.right=this,this.updateHeight(),t.updateHeight(),t}updateHeight(){this.height=1+Math.max(this.heightLeft,this.heightRight)}balanceFactor(){return this.heightRight-this.heightLeft}get heightLeft(){return this.left?.height??0}get heightRight(){return this.right?.height??0}};var iC=class r{static forUris(t=()=>!1,e=()=>!1){return new r(new TK(t,e))}static forPaths(t=!1){return new r(new oO(void 0,!t))}static forStrings(){return new r(new EK)}static forConfigKeys(){return new r(new xK)}_iter;_root;constructor(t){this._iter=t}clear(){this._root=void 0}fill(t,e){if(e){let i=e.slice(0);q5(i);for(let n of i)this.set(n,t)}else{let i=t.slice(0);q5(i);for(let n of i)this.set(n[0],n[1])}}set(t,e){let i=this._iter.reset(t),n;this._root||(this._root=new tC,this._root.segment=i.value());let o=[];for(n=this._root;;){let a=i.cmp(n.segment);if(a>0)n.left||(n.left=new tC,n.left.segment=i.value()),o.push([-1,n]),n=n.left;else if(a<0)n.right||(n.right=new tC,n.right.segment=i.value()),o.push([1,n]),n=n.right;else if(i.hasNext())i.next(),n.mid||(n.mid=new tC,n.mid.segment=i.value()),o.push([0,n]),n=n.mid;else break}let s=n.value;n.value=e,n.key=t;for(let a=o.length-1;a>=0;a--){let l=o[a][1];l.updateHeight();let d=l.balanceFactor();if(d<-1||d>1){let c=o[a][0],p=o[a+1][0];if(c===1&&p===1)o[a][1]=l.rotateLeft();else if(c===-1&&p===-1)o[a][1]=l.rotateRight();else if(c===1&&p===-1)l.right=o[a+1][1]=o[a+1][1].rotateRight(),o[a][1]=l.rotateLeft();else if(c===-1&&p===1)l.left=o[a+1][1]=o[a+1][1].rotateLeft(),o[a][1]=l.rotateRight();else throw new Error;if(a>0)switch(o[a-1][0]){case-1:o[a-1][1].left=o[a][1];break;case 1:o[a-1][1].right=o[a][1];break;case 0:o[a-1][1].mid=o[a][1];break}else this._root=o[0][1]}}return s}get(t){return this._getNode(t)?.value}_getNode(t){let e=this._iter.reset(t),i=this._root;for(;i;){let n=e.cmp(i.segment);if(n>0)i=i.left;else if(n<0)i=i.right;else if(e.hasNext())e.next(),i=i.mid;else break}return i}has(t){let e=this._getNode(t);return!(e?.value===void 0&&e?.mid===void 0)}delete(t){return this._delete(t,!1)}deleteSuperstr(t){return this._delete(t,!0)}_delete(t,e){let i=this._iter.reset(t),n=[],o=this._root;for(;o;){let s=i.cmp(o.segment);if(s>0)n.push([-1,o]),o=o.left;else if(s<0)n.push([1,o]),o=o.right;else if(i.hasNext())i.next(),n.push([0,o]),o=o.mid;else break}if(o){if(e?(o.left=void 0,o.mid=void 0,o.right=void 0,o.height=1):(o.key=void 0,o.value=void 0),!o.mid&&!o.value)if(o.left&&o.right){let s=this._min(o.right);if(s.key){let{key:a,value:l,segment:d}=s;this._delete(s.key,!1),o.key=a,o.value=l,o.segment=d}}else{let s=o.left??o.right;if(n.length>0){let[a,l]=n[n.length-1];switch(a){case-1:l.left=s;break;case 0:l.mid=s;break;case 1:l.right=s;break}}else this._root=s}for(let s=n.length-1;s>=0;s--){let a=n[s][1];a.updateHeight();let l=a.balanceFactor();if(l>1?(a.right.balanceFactor()>=0||(a.right=a.right.rotateRight()),n[s][1]=a.rotateLeft()):l<-1&&(a.left.balanceFactor()<=0||(a.left=a.left.rotateLeft()),n[s][1]=a.rotateRight()),s>0)switch(n[s-1][0]){case-1:n[s-1][1].left=n[s][1];break;case 1:n[s-1][1].right=n[s][1];break;case 0:n[s-1][1].mid=n[s][1];break}else this._root=n[0][1]}}}_min(t){for(;t.left;)t=t.left;return t}findSubstr(t){let e=this._iter.reset(t),i=this._root,n;for(;i;){let o=e.cmp(i.segment);if(o>0)i=i.left;else if(o<0)i=i.right;else if(e.hasNext())e.next(),n=i.value||n,i=i.mid;else break}return i&&i.value||n}findSuperstr(t){return this._findSuperstrOrElement(t,!1)}_findSuperstrOrElement(t,e){let i=this._iter.reset(t),n=this._root;for(;n;){let o=i.cmp(n.segment);if(o>0)n=n.left;else if(o<0)n=n.right;else if(i.hasNext())i.next(),n=n.mid;else return n.mid?this._entries(n.mid):e?n.value:void 0}}hasElementOrSubtree(t){return this._findSuperstrOrElement(t,!0)!==void 0}forEach(t){for(let[e,i]of this)t(i,e)}*[Symbol.iterator](){yield*this._entries(this._root)}_entries(t){let e=[];return this._dfsEntries(t,e),e[Symbol.iterator]()}_dfsEntries(t,e){t&&(t.left&&this._dfsEntries(t.left,e),t.value&&e.push([t.key,t.value]),t.mid&&this._dfsEntries(t.mid,e),t.right&&this._dfsEntries(t.right,e))}_isBalanced(){let t=e=>{if(!e)return!0;let i=e.balanceFactor();return i<-1||i>1?!1:t(e.left)&&t(e.right)};return t(this._root)}};var $o=q("environmentService"),GNe=$o;var kt=q("contextService");function bf(r){let t=r;return typeof t?.id=="string"&&Z.isUri(t.uri)}function Zte(r){return typeof r?.id=="string"&&!bf(r)&&!TD(r)}var vve={id:"ext-dev"},Ive={id:"empty-window"};function Jte(r,t){if(typeof r=="string"||typeof r>"u")return typeof r=="string"?{id:Eo(r)}:t?vve:Ive;let e=r;return e.configuration?{id:e.id,configPath:e.configuration}:e.folders.length===1?{id:e.id,uri:e.folders[0].uri}:{id:e.id}}function TD(r){let t=r;return typeof t?.id=="string"&&Z.isUri(t.configPath)}function rO(r){let t=r;return!!(t&&typeof t=="object"&&typeof t.id=="string"&&Array.isArray(t.folders))}function Rp(r){let t=r;return!!(t&&typeof t=="object"&&Z.isUri(t.uri)&&typeof t.name=="string"&&typeof t.toResource=="function")}var _D="code-workspace",yve=`.${_D}`,r1e=[{name:u("codeWorkspace","Code Workspace"),extensions:[_D]}];function eie(r){let t;return Z.isUri(r)?t=r:t=r.configuration,t?.scheme===Ie.tmp}var Sve="4064f6ec-cb38-4ad0-af64-ee6467e63c82";function tie(r){return r.id===Sve}function nC(r){return(typeof r=="string"?hm(r):Sm(r))===yve}var se=q("configurationService");function iie(r){return r.applicationValue!==void 0||r.userValue!==void 0||r.userLocalValue!==void 0||r.userRemoteValue!==void 0||r.workspaceValue!==void 0||r.workspaceFolderValue!==void 0}function nie(r){return r.replace(/[\[\]]/g,"")}var _K=class{data=new Map;add(t,e){P_(Bt(t)),P_(vi(e)),P_(!this.data.has(t),"There is already an extension with this id"),this.data.set(t,e)}knows(t){return this.data.has(t)}as(t){return this.data.get(t)||null}},Pe=new _K;var wd={JSONContribution:"base.contributions.json"};function Cve(r){return r.length>0&&r.charAt(r.length-1)==="#"?r.substring(0,r.length-1):r}var DK=class{schemasById;_onDidChangeSchema=new x;onDidChangeSchema=this._onDidChangeSchema.event;constructor(){this.schemasById={}}registerSchema(t,e){this.schemasById[Cve(t)]=e,this._onDidChangeSchema.fire(t)}notifySchemaChanged(t){this._onDidChangeSchema.fire(t)}getSchemaContributions(){return{schemas:this.schemasById}}getSchemaContent(t){let e=this.schemasById[t];return e?Gte(e):void 0}hasSchemaContent(t){return!!this.schemasById[t]}},wve=new DK;Pe.add(wd.JSONContribution,wve);var T1e=q("policy");var ur={Configuration:"base.contributions.configuration"};var aO={properties:{},patternProperties:{}},lO={properties:{},patternProperties:{}},dO={properties:{},patternProperties:{}},cO={properties:{},patternProperties:{}},uO={properties:{},patternProperties:{}},DD={properties:{},patternProperties:{}},dI="vscode://schemas/settings/resourceLanguage";var pO=Pe.as(wd.JSONContribution),kK=class{registeredConfigurationDefaults=[];configurationDefaultsOverrides;defaultLanguageConfigurationOverridesNode;configurationContributors;configurationProperties;policyConfigurations;excludedConfigurationProperties;resourceLanguageSettingsSchema;overrideIdentifiers=new Set;_onDidSchemaChange=new x;onDidSchemaChange=this._onDidSchemaChange.event;_onDidUpdateConfiguration=new x;onDidUpdateConfiguration=this._onDidUpdateConfiguration.event;constructor(){this.configurationDefaultsOverrides=new Map,this.defaultLanguageConfigurationOverridesNode={id:"defaultOverrides",title:u("defaultLanguageConfigurationOverrides.title","Default Language Configuration Overrides"),properties:{}},this.configurationContributors=[this.defaultLanguageConfigurationOverridesNode],this.resourceLanguageSettingsSchema={properties:{},patternProperties:{},additionalProperties:!0,allowTrailingCommas:!0,allowComments:!0},this.configurationProperties={},this.policyConfigurations=new Map,this.excludedConfigurationProperties={},pO.registerSchema(dI,this.resourceLanguageSettingsSchema),this.registerOverridePropertyPatternKey()}registerConfiguration(t,e=!0){this.registerConfigurations([t],e)}registerConfigurations(t,e=!0){let i=new Set;this.doRegisterConfigurations(t,e,i),pO.registerSchema(dI,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:i})}deregisterConfigurations(t){let e=new Set;this.doDeregisterConfigurations(t,e),pO.registerSchema(dI,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:e})}updateConfigurations({add:t,remove:e}){let i=new Set;this.doDeregisterConfigurations(e,i),this.doRegisterConfigurations(t,!1,i),pO.registerSchema(dI,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:i})}registerDefaultConfigurations(t){let e=new Set;this.doRegisterDefaultConfigurations(t,e),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:e,defaultsOverrides:!0})}doRegisterDefaultConfigurations(t,e){this.registeredConfigurationDefaults.push(...t);let i=[];for(let{overrides:n,source:o}of t)for(let s in n){e.add(s);let a=this.configurationDefaultsOverrides.get(s)??this.configurationDefaultsOverrides.set(s,{configurationDefaultOverrides:[]}).get(s),l=n[s];if(a.configurationDefaultOverrides.push({value:l,source:o}),oC.test(s)){let d=this.mergeDefaultConfigurationsForOverrideIdentifier(s,l,o,a.configurationDefaultOverrideValue);if(!d)continue;a.configurationDefaultOverrideValue=d,this.updateDefaultOverrideProperty(s,d,o),i.push(...Eve(s))}else{let d=this.mergeDefaultConfigurationsForConfigurationProperty(s,l,o,a.configurationDefaultOverrideValue);if(!d)continue;a.configurationDefaultOverrideValue=d;let c=this.configurationProperties[s];c&&(this.updatePropertyDefaultValue(s,c),this.updateSchema(s,c))}}this.doRegisterOverrideIdentifiers(i)}deregisterDefaultConfigurations(t){let e=new Set;this.doDeregisterDefaultConfigurations(t,e),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:e,defaultsOverrides:!0})}doDeregisterDefaultConfigurations(t,e){for(let i of t){let n=this.registeredConfigurationDefaults.indexOf(i);n!==-1&&this.registeredConfigurationDefaults.splice(n,1)}for(let{overrides:i,source:n}of t)for(let o in i){let s=this.configurationDefaultsOverrides.get(o);if(!s)continue;let a=s.configurationDefaultOverrides.findIndex(l=>n?l.source?.id===n.id:l.value===i[o]);if(a!==-1){if(s.configurationDefaultOverrides.splice(a,1),s.configurationDefaultOverrides.length===0&&this.configurationDefaultsOverrides.delete(o),oC.test(o)){let l;for(let d of s.configurationDefaultOverrides)l=this.mergeDefaultConfigurationsForOverrideIdentifier(o,d.value,d.source,l);l&&!jv(l.value)?(s.configurationDefaultOverrideValue=l,this.updateDefaultOverrideProperty(o,l,n)):(this.configurationDefaultsOverrides.delete(o),delete this.configurationProperties[o],delete this.defaultLanguageConfigurationOverridesNode.properties[o])}else{let l;for(let c of s.configurationDefaultOverrides)l=this.mergeDefaultConfigurationsForConfigurationProperty(o,c.value,c.source,l);s.configurationDefaultOverrideValue=l;let d=this.configurationProperties[o];d&&(this.updatePropertyDefaultValue(o,d),this.updateSchema(o,d))}e.add(o)}}this.updateOverridePropertyPatternKey()}updateDefaultOverrideProperty(t,e,i){let n={type:"object",default:e.value,description:u("defaultLanguageConfiguration.description","Configure settings to be overridden for the {0} language.",nie(t)),$ref:dI,defaultDefaultValue:e.value,source:i,defaultValueSource:i};this.configurationProperties[t]=n,this.defaultLanguageConfigurationOverridesNode.properties[t]=n}mergeDefaultConfigurationsForOverrideIdentifier(t,e,i,n){let o=n?.value||{},s=n?.source??new Map;if(!(s instanceof Map)){console.error("objectConfigurationSources is not a Map");return}for(let a of Object.keys(e)){let l=e[a];if(vi(l)&&(Vn(o[a])||vi(o[a]))){if(o[a]={...o[a]??{},...l},i)for(let c in l)s.set(`${a}.${c}`,i)}else o[a]=l,i?s.set(a,i):s.delete(a)}return{value:o,source:s}}mergeDefaultConfigurationsForConfigurationProperty(t,e,i,n){let o=this.configurationProperties[t],s=n?.value??o?.defaultDefaultValue,a=i;if(vi(e)&&(o!==void 0&&o.type==="object"||o===void 0&&(Vn(s)||vi(s)))){if(a=n?.source??new Map,!(a instanceof Map)){console.error("defaultValueSource is not a Map");return}for(let d in e)i&&a.set(`${t}.${d}`,i);e={...vi(s)?s:{},...e}}return{value:e,source:a}}deltaConfiguration(t){let e=!1,i=new Set;t.removedDefaults&&(this.doDeregisterDefaultConfigurations(t.removedDefaults,i),e=!0),t.addedDefaults&&(this.doRegisterDefaultConfigurations(t.addedDefaults,i),e=!0),t.removedConfigurations&&this.doDeregisterConfigurations(t.removedConfigurations,i),t.addedConfigurations&&this.doRegisterConfigurations(t.addedConfigurations,!1,i),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:i,defaultsOverrides:e})}notifyConfigurationSchemaUpdated(...t){this._onDidSchemaChange.fire()}registerOverrideIdentifiers(t){this.doRegisterOverrideIdentifiers(t),this._onDidSchemaChange.fire()}doRegisterOverrideIdentifiers(t){for(let e of t)this.overrideIdentifiers.add(e);this.updateOverridePropertyPatternKey()}doRegisterConfigurations(t,e,i){t.forEach(n=>{this.validateAndRegisterProperties(n,e,n.extensionInfo,n.restrictedProperties,void 0,i),this.configurationContributors.push(n),this.registerJSONConfiguration(n)})}doDeregisterConfigurations(t,e){let i=n=>{if(n.properties)for(let o in n.properties){e.add(o);let s=this.configurationProperties[o];s?.policy?.name&&this.policyConfigurations.delete(s.policy.name),delete this.configurationProperties[o],this.removeFromSchema(o,n.properties[o])}n.allOf?.forEach(o=>i(o))};for(let n of t){i(n);let o=this.configurationContributors.indexOf(n);o!==-1&&this.configurationContributors.splice(o,1)}}validateAndRegisterProperties(t,e=!0,i,n,o=3,s){o=Wn(t.scope)?o:t.scope;let a=t.properties;if(a)for(let d in a){let c=a[d];if(e&&Tve(d,c)){delete a[d];continue}if(c.source=i,c.defaultDefaultValue=a[d].default,this.updatePropertyDefaultValue(d,c),oC.test(d)?c.scope=void 0:(c.scope=Wn(c.scope)?o:c.scope,c.restricted=Wn(c.restricted)?!!n?.includes(d):c.restricted),a[d].hasOwnProperty("included")&&!a[d].included){this.excludedConfigurationProperties[d]=a[d],delete a[d];continue}else this.configurationProperties[d]=a[d],a[d].policy?.name&&this.policyConfigurations.set(a[d].policy.name,d);!a[d].deprecationMessage&&a[d].markdownDeprecationMessage&&(a[d].deprecationMessage=a[d].markdownDeprecationMessage),s.add(d)}let l=t.allOf;if(l)for(let d of l)this.validateAndRegisterProperties(d,e,i,n,o,s)}getConfigurations(){return this.configurationContributors}getConfigurationProperties(){return this.configurationProperties}getPolicyConfigurations(){return this.policyConfigurations}getExcludedConfigurationProperties(){return this.excludedConfigurationProperties}getRegisteredDefaultConfigurations(){return[...this.registeredConfigurationDefaults]}getConfigurationDefaultsOverrides(){let t=new Map;for(let[e,i]of this.configurationDefaultsOverrides)i.configurationDefaultOverrideValue&&t.set(e,i.configurationDefaultOverrideValue);return t}registerJSONConfiguration(t){let e=i=>{let n=i.properties;if(n)for(let s in n)this.updateSchema(s,n[s]);i.allOf?.forEach(e)};e(t)}updateSchema(t,e){switch(aO.properties[t]=e,e.scope){case 1:lO.properties[t]=e;break;case 2:dO.properties[t]=e;break;case 6:cO.properties[t]=e;break;case 3:uO.properties[t]=e;break;case 4:DD.properties[t]=e;break;case 5:DD.properties[t]=e,this.resourceLanguageSettingsSchema.properties[t]=e;break}}removeFromSchema(t,e){switch(delete aO.properties[t],e.scope){case 1:delete lO.properties[t];break;case 2:delete dO.properties[t];break;case 6:delete cO.properties[t];break;case 3:delete uO.properties[t];break;case 4:case 5:delete DD.properties[t],delete this.resourceLanguageSettingsSchema.properties[t];break}}updateOverridePropertyPatternKey(){for(let t of this.overrideIdentifiers.values()){let e=`[${t}]`,i={type:"object",description:u("overrideSettings.defaultDescription","Configure editor settings to be overridden for a language."),errorMessage:u("overrideSettings.errorMessage","This setting does not support per-language configuration."),$ref:dI};this.updatePropertyDefaultValue(e,i),aO.properties[e]=i,lO.properties[e]=i,dO.properties[e]=i,cO.properties[e]=i,uO.properties[e]=i,DD.properties[e]=i}}registerOverridePropertyPatternKey(){let t={type:"object",description:u("overrideSettings.defaultDescription","Configure editor settings to be overridden for a language."),errorMessage:u("overrideSettings.errorMessage","This setting does not support per-language configuration."),$ref:dI};aO.patternProperties[cI]=t,lO.patternProperties[cI]=t,dO.patternProperties[cI]=t,cO.patternProperties[cI]=t,uO.patternProperties[cI]=t,DD.patternProperties[cI]=t,this._onDidSchemaChange.fire()}updatePropertyDefaultValue(t,e){let i=this.configurationDefaultsOverrides.get(t)?.configurationDefaultOverrideValue,n,o;i&&(!e.disallowConfigurationDefault||!i.source)&&(n=i.value,o=i.source),Vn(n)&&(n=e.defaultDefaultValue,o=void 0),Vn(n)&&(n=xve(e.type)),e.default=n,e.defaultValueSource=o}},rie="\\[([^\\]]+)\\]",oie=new RegExp(rie,"g"),cI=`^(${rie})+$`,oC=new RegExp(cI);function Eve(r){let t=[];if(oC.test(r)){let e=oie.exec(r);for(;e?.length;){let i=e[1].trim();i&&t.push(i),e=oie.exec(r)}}return Mo(t)}function xve(r){switch(Array.isArray(r)?r[0]:r){case"boolean":return!1;case"integer":case"number":return 0;case"string":return"";case"array":return[];case"object":return{};default:return null}}var hO=new kK;Pe.add(ur.Configuration,hO);function Tve(r,t){return r.trim()?oC.test(r)?u("config.property.languageDefault","Cannot register '{0}'. This matches property pattern '\\\\[.*\\\\]$' for describing language specific editor settings. Use 'configurationDefaults' contribution.",r):hO.getConfigurationProperties()[r]!==void 0?u("config.property.duplicate","Cannot register '{0}'. This property is already registered.",r):t.policy?.name&&hO.getPolicyConfigurations().get(t.policy?.name)!==void 0?u("config.policy.duplicate","Cannot register '{0}'. The associated policy {1} is already registered with {2}.",r,t.policy?.name,hO.getPolicyConfigurations().get(t.policy?.name)):null:u("config.property.empty","Cannot register an empty property")}var ru=8,mO=class{_values;constructor(t){this._values=t}hasChanged(t){return this._values[t]}},kD=class{stableMinimapLayoutInput;stableFitMaxMinimapScale;stableFitRemainingWidth;constructor(){this.stableMinimapLayoutInput=null,this.stableFitMaxMinimapScale=0,this.stableFitRemainingWidth=0}},en=class{id;name;defaultValue;schema;constructor(t,e,i,n){this.id=t,this.name=e,this.defaultValue=i,this.schema=n}applyUpdate(t,e){return fO(t,e)}compute(t,e,i){return i}},sC=class{constructor(t,e){this.newValue=t;this.didChange=e}};function fO(r,t){if(typeof r!="object"||typeof t!="object"||!r||!t)return new sC(t,r!==t);if(Array.isArray(r)||Array.isArray(t)){let i=Array.isArray(r)&&Array.isArray(t)&&xi(r,t);return new sC(t,!i)}let e=!1;for(let i in t)if(t.hasOwnProperty(i)){let n=fO(r[i],t[i]);n.didChange&&(r[i]=n.newValue,e=!0)}return new sC(r,e)}var pI=class{id;name;defaultValue;schema=void 0;constructor(t){this.id=t,this.name="_never_",this.defaultValue=void 0}applyUpdate(t,e){return fO(t,e)}validate(t){return this.defaultValue}},vf=class{id;name;defaultValue;schema;constructor(t,e,i,n){this.id=t,this.name=e,this.defaultValue=i,this.schema=n}applyUpdate(t,e){return fO(t,e)}validate(t){return typeof t>"u"?this.defaultValue:t}compute(t,e,i){return i}};function He(r,t){return typeof r>"u"?t:r==="false"?!1:!!r}var li=class extends vf{constructor(t,e,i,n=void 0){typeof n<"u"&&(n.type="boolean",n.default=i),super(t,e,i,n)}validate(t){return He(t,this.defaultValue)}};function If(r,t,e,i){if(typeof r>"u")return t;let n=parseInt(r,10);return isNaN(n)?t:(n=Math.max(e,n),n=Math.min(i,n),n|0)}var Ki=class r extends vf{static clampedInt(t,e,i,n){return If(t,e,i,n)}minimum;maximum;constructor(t,e,i,n,o,s=void 0){typeof s<"u"&&(s.type="integer",s.default=i,s.minimum=n,s.maximum=o),super(t,e,i,s),this.minimum=n,this.maximum=o}validate(t){return r.clampedInt(t,this.defaultValue,this.minimum,this.maximum)}};function aie(r,t,e,i){if(typeof r>"u")return t;let n=kl.float(r,t);return kl.clamp(n,e,i)}var kl=class r extends vf{static clamp(t,e,i){return t<e?e:t>i?i:t}static float(t,e){if(typeof t=="number")return t;if(typeof t>"u")return e;let i=parseFloat(t);return isNaN(i)?e:i}validationFn;constructor(t,e,i,n,o){typeof o<"u"&&(o.type="number",o.default=i),super(t,e,i,o),this.validationFn=n}validate(t){return this.validationFn(r.float(t,this.defaultValue))}},Vs=class r extends vf{static string(t,e){return typeof t!="string"?e:t}constructor(t,e,i,n=void 0){typeof n<"u"&&(n.type="string",n.default=i),super(t,e,i,n)}validate(t){return r.string(t,this.defaultValue)}};function Pn(r,t,e,i){return typeof r!="string"?t:i&&r in i?i[r]:e.indexOf(r)===-1?t:r}var Cn=class extends vf{_allowedValues;constructor(t,e,i,n,o=void 0){typeof o<"u"&&(o.type="string",o.enum=n,o.default=i),super(t,e,i,o),this._allowedValues=n}validate(t){return Pn(t,this.defaultValue,this._allowedValues)}},rC=class extends en{_allowedValues;_convert;constructor(t,e,i,n,o,s,a=void 0){typeof a<"u"&&(a.type="string",a.enum=o,a.default=n),super(t,e,i,a),this._allowedValues=o,this._convert=s}validate(t){return typeof t!="string"?this.defaultValue:this._allowedValues.indexOf(t)===-1?this.defaultValue:this._convert(t)}};function _ve(r){switch(r){case"none":return 0;case"keep":return 1;case"brackets":return 2;case"advanced":return 3;case"full":return 4}}var LK=class extends en{constructor(){super(2,"accessibilitySupport",0,{type:"string",enum:["auto","on","off"],enumDescriptions:[u("accessibilitySupport.auto","Use platform APIs to detect when a Screen Reader is attached."),u("accessibilitySupport.on","Optimize for usage with a Screen Reader."),u("accessibilitySupport.off","Assume a screen reader is not attached.")],default:"auto",tags:["accessibility"],description:u("accessibilitySupport","Controls if the UI should run in a mode where it is optimized for screen readers.")})}validate(t){switch(t){case"auto":return 0;case"off":return 1;case"on":return 2}return this.defaultValue}compute(t,e,i){return i===0?t.accessibilitySupport:i}},RK=class extends en{constructor(){let t={insertSpace:!0,ignoreEmptyLines:!0};super(23,"comments",t,{"editor.comments.insertSpace":{type:"boolean",default:t.insertSpace,description:u("comments.insertSpace","Controls whether a space character is inserted when commenting.")},"editor.comments.ignoreEmptyLines":{type:"boolean",default:t.ignoreEmptyLines,description:u("comments.ignoreEmptyLines","Controls if empty lines should be ignored with toggle, add or remove actions for line comments.")}})}validate(t){if(!t||typeof t!="object")return this.defaultValue;let e=t;return{insertSpace:He(e.insertSpace,this.defaultValue.insertSpace),ignoreEmptyLines:He(e.ignoreEmptyLines,this.defaultValue.ignoreEmptyLines)}}};function Dve(r){switch(r){case"blink":return 1;case"smooth":return 2;case"phase":return 3;case"expand":return 4;case"solid":return 5}}function kve(r){switch(r){case"line":return 1;case"block":return 2;case"underline":return 3;case"line-thin":return 4;case"block-outline":return 5;case"underline-thin":return 6}}var PK=class extends pI{constructor(){super(144)}compute(t,e,i){let n=["monaco-editor"];return e.get(40)&&n.push(e.get(40)),t.extraEditorClassName&&n.push(t.extraEditorClassName),e.get(75)==="default"?n.push("mouse-default"):e.get(75)==="copy"&&n.push("mouse-copy"),e.get(113)&&n.push("showUnused"),e.get(142)&&n.push("showDeprecated"),n.join(" ")}},MK=class extends li{constructor(){super(38,"emptySelectionClipboard",!0,{description:u("emptySelectionClipboard","Controls whether copying without a selection copies the current line.")})}compute(t,e,i){return i&&t.emptySelectionClipboard}},AK=class extends en{constructor(){let t={cursorMoveOnType:!0,seedSearchStringFromSelection:"always",autoFindInSelection:"never",globalFindClipboard:!1,addExtraSpaceOnTop:!0,loop:!0};super(42,"find",t,{"editor.find.cursorMoveOnType":{type:"boolean",default:t.cursorMoveOnType,description:u("find.cursorMoveOnType","Controls whether the cursor should jump to find matches while typing.")},"editor.find.seedSearchStringFromSelection":{type:"string",enum:["never","always","selection"],default:t.seedSearchStringFromSelection,enumDescriptions:[u("editor.find.seedSearchStringFromSelection.never","Never seed search string from the editor selection."),u("editor.find.seedSearchStringFromSelection.always","Always seed search string from the editor selection, including word at cursor position."),u("editor.find.seedSearchStringFromSelection.selection","Only seed search string from the editor selection.")],description:u("find.seedSearchStringFromSelection","Controls whether the search string in the Find Widget is seeded from the editor selection.")},"editor.find.autoFindInSelection":{type:"string",enum:["never","always","multiline"],default:t.autoFindInSelection,enumDescriptions:[u("editor.find.autoFindInSelection.never","Never turn on Find in Selection automatically (default)."),u("editor.find.autoFindInSelection.always","Always turn on Find in Selection automatically."),u("editor.find.autoFindInSelection.multiline","Turn on Find in Selection automatically when multiple lines of content are selected.")],description:u("find.autoFindInSelection","Controls the condition for turning on Find in Selection automatically.")},"editor.find.globalFindClipboard":{type:"boolean",default:t.globalFindClipboard,description:u("find.globalFindClipboard","Controls whether the Find Widget should read or modify the shared find clipboard on macOS."),included:ye},"editor.find.addExtraSpaceOnTop":{type:"boolean",default:t.addExtraSpaceOnTop,description:u("find.addExtraSpaceOnTop","Controls whether the Find Widget should add extra lines on top of the editor. When true, you can scroll beyond the first line when the Find Widget is visible.")},"editor.find.loop":{type:"boolean",default:t.loop,description:u("find.loop","Controls whether the search automatically restarts from the beginning (or the end) when no further matches can be found.")}})}validate(t){if(!t||typeof t!="object")return this.defaultValue;let e=t;return{cursorMoveOnType:He(e.cursorMoveOnType,this.defaultValue.cursorMoveOnType),seedSearchStringFromSelection:typeof t.seedSearchStringFromSelection=="boolean"?t.seedSearchStringFromSelection?"always":"never":Pn(e.seedSearchStringFromSelection,this.defaultValue.seedSearchStringFromSelection,["never","always","selection"]),autoFindInSelection:typeof t.autoFindInSelection=="boolean"?t.autoFindInSelection?"always":"never":Pn(e.autoFindInSelection,this.defaultValue.autoFindInSelection,["never","always","multiline"]),globalFindClipboard:He(e.globalFindClipboard,this.defaultValue.globalFindClipboard),addExtraSpaceOnTop:He(e.addExtraSpaceOnTop,this.defaultValue.addExtraSpaceOnTop),loop:He(e.loop,this.defaultValue.loop)}}},ou=class r extends en{static OFF='"liga" off, "calt" off';static ON='"liga" on, "calt" on';constructor(){super(52,"fontLigatures",r.OFF,{anyOf:[{type:"boolean",description:u("fontLigatures","Enables/Disables font ligatures ('calt' and 'liga' font features). Change this to a string for fine-grained control of the 'font-feature-settings' CSS property.")},{type:"string",description:u("fontFeatureSettings","Explicit 'font-feature-settings' CSS property. A boolean can be passed instead if one only needs to turn on/off ligatures.")}],description:u("fontLigaturesGeneral","Configures font ligatures or font features. Can be either a boolean to enable/disable ligatures or a string for the value of the CSS 'font-feature-settings' property."),default:!1})}validate(t){return typeof t>"u"?this.defaultValue:typeof t=="string"?t==="false"||t.length===0?r.OFF:t==="true"?r.ON:t:t?r.ON:r.OFF}},lC=class r extends en{static OFF="normal";static TRANSLATE="translate";constructor(){super(55,"fontVariations",r.OFF,{anyOf:[{type:"boolean",description:u("fontVariations","Enables/Disables the translation from font-weight to font-variation-settings. Change this to a string for fine-grained control of the 'font-variation-settings' CSS property.")},{type:"string",description:u("fontVariationSettings","Explicit 'font-variation-settings' CSS property. A boolean can be passed instead if one only needs to translate font-weight to font-variation-settings.")}],description:u("fontVariationsGeneral","Configures font variations. Can be either a boolean to enable/disable the translation from font-weight to font-variation-settings or a string for the value of the CSS 'font-variation-settings' property."),default:!1})}validate(t){return typeof t>"u"?this.defaultValue:typeof t=="string"?t==="false"?r.OFF:t==="true"?r.TRANSLATE:t:t?r.TRANSLATE:r.OFF}compute(t,e,i){return t.fontInfo.fontVariationSettings}},OK=class extends pI{constructor(){super(51)}compute(t,e,i){return t.fontInfo}},NK=class extends vf{constructor(){super(53,"fontSize",vs.fontSize,{type:"number",minimum:6,maximum:100,default:vs.fontSize,description:u("fontSize","Controls the font size in pixels.")})}validate(t){let e=kl.float(t,this.defaultValue);return e===0?vs.fontSize:kl.clamp(e,6,100)}compute(t,e,i){return t.fontInfo.fontSize}},FK=class r extends en{static SUGGESTION_VALUES=["normal","bold","100","200","300","400","500","600","700","800","900"];static MINIMUM_VALUE=1;static MAXIMUM_VALUE=1e3;constructor(){super(54,"fontWeight",vs.fontWeight,{anyOf:[{type:"number",minimum:r.MINIMUM_VALUE,maximum:r.MAXIMUM_VALUE,errorMessage:u("fontWeightErrorMessage",'Only "normal" and "bold" keywords or numbers between 1 and 1000 are allowed.')},{type:"string",pattern:"^(normal|bold|1000|[1-9][0-9]{0,2})$"},{enum:r.SUGGESTION_VALUES}],default:vs.fontWeight,description:u("fontWeight",'Controls the font weight. Accepts "normal" and "bold" keywords or numbers between 1 and 1000.')})}validate(t){return t==="normal"||t==="bold"?t:String(Ki.clampedInt(t,vs.fontWeight,r.MINIMUM_VALUE,r.MAXIMUM_VALUE))}},BK=class extends en{constructor(){let t={multiple:"peek",multipleDefinitions:"peek",multipleTypeDefinitions:"peek",multipleDeclarations:"peek",multipleImplementations:"peek",multipleReferences:"peek",multipleTests:"peek",alternativeDefinitionCommand:"editor.action.goToReferences",alternativeTypeDefinitionCommand:"editor.action.goToReferences",alternativeDeclarationCommand:"editor.action.goToReferences",alternativeImplementationCommand:"",alternativeReferenceCommand:"",alternativeTestsCommand:""},e={type:"string",enum:["peek","gotoAndPeek","goto"],default:t.multiple,enumDescriptions:[u("editor.gotoLocation.multiple.peek","Show Peek view of the results (default)"),u("editor.gotoLocation.multiple.gotoAndPeek","Go to the primary result and show a Peek view"),u("editor.gotoLocation.multiple.goto","Go to the primary result and enable Peek-less navigation to others")]},i=["","editor.action.referenceSearch.trigger","editor.action.goToReferences","editor.action.peekImplementation","editor.action.goToImplementation","editor.action.peekTypeDefinition","editor.action.goToTypeDefinition","editor.action.peekDeclaration","editor.action.revealDeclaration","editor.action.peekDefinition","editor.action.revealDefinitionAside","editor.action.revealDefinition"];super(59,"gotoLocation",t,{"editor.gotoLocation.multiple":{deprecationMessage:u("editor.gotoLocation.multiple.deprecated","This setting is deprecated, please use separate settings like 'editor.editor.gotoLocation.multipleDefinitions' or 'editor.editor.gotoLocation.multipleImplementations' instead.")},"editor.gotoLocation.multipleDefinitions":{description:u("editor.editor.gotoLocation.multipleDefinitions","Controls the behavior the 'Go to Definition'-command when multiple target locations exist."),...e},"editor.gotoLocation.multipleTypeDefinitions":{description:u("editor.editor.gotoLocation.multipleTypeDefinitions","Controls the behavior the 'Go to Type Definition'-command when multiple target locations exist."),...e},"editor.gotoLocation.multipleDeclarations":{description:u("editor.editor.gotoLocation.multipleDeclarations","Controls the behavior the 'Go to Declaration'-command when multiple target locations exist."),...e},"editor.gotoLocation.multipleImplementations":{description:u("editor.editor.gotoLocation.multipleImplemenattions","Controls the behavior the 'Go to Implementations'-command when multiple target locations exist."),...e},"editor.gotoLocation.multipleReferences":{description:u("editor.editor.gotoLocation.multipleReferences","Controls the behavior the 'Go to References'-command when multiple target locations exist."),...e},"editor.gotoLocation.alternativeDefinitionCommand":{type:"string",default:t.alternativeDefinitionCommand,enum:i,description:u("alternativeDefinitionCommand","Alternative command id that is being executed when the result of 'Go to Definition' is the current location.")},"editor.gotoLocation.alternativeTypeDefinitionCommand":{type:"string",default:t.alternativeTypeDefinitionCommand,enum:i,description:u("alternativeTypeDefinitionCommand","Alternative command id that is being executed when the result of 'Go to Type Definition' is the current location.")},"editor.gotoLocation.alternativeDeclarationCommand":{type:"string",default:t.alternativeDeclarationCommand,enum:i,description:u("alternativeDeclarationCommand","Alternative command id that is being executed when the result of 'Go to Declaration' is the current location.")},"editor.gotoLocation.alternativeImplementationCommand":{type:"string",default:t.alternativeImplementationCommand,enum:i,description:u("alternativeImplementationCommand","Alternative command id that is being executed when the result of 'Go to Implementation' is the current location.")},"editor.gotoLocation.alternativeReferenceCommand":{type:"string",default:t.alternativeReferenceCommand,enum:i,description:u("alternativeReferenceCommand","Alternative command id that is being executed when the result of 'Go to Reference' is the current location.")}})}validate(t){if(!t||typeof t!="object")return this.defaultValue;let e=t;return{multiple:Pn(e.multiple,this.defaultValue.multiple,["peek","gotoAndPeek","goto"]),multipleDefinitions:e.multipleDefinitions??Pn(e.multipleDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleTypeDefinitions:e.multipleTypeDefinitions??Pn(e.multipleTypeDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleDeclarations:e.multipleDeclarations??Pn(e.multipleDeclarations,"peek",["peek","gotoAndPeek","goto"]),multipleImplementations:e.multipleImplementations??Pn(e.multipleImplementations,"peek",["peek","gotoAndPeek","goto"]),multipleReferences:e.multipleReferences??Pn(e.multipleReferences,"peek",["peek","gotoAndPeek","goto"]),multipleTests:e.multipleTests??Pn(e.multipleTests,"peek",["peek","gotoAndPeek","goto"]),alternativeDefinitionCommand:Vs.string(e.alternativeDefinitionCommand,this.defaultValue.alternativeDefinitionCommand),alternativeTypeDefinitionCommand:Vs.string(e.alternativeTypeDefinitionCommand,this.defaultValue.alternativeTypeDefinitionCommand),alternativeDeclarationCommand:Vs.string(e.alternativeDeclarationCommand,this.defaultValue.alternativeDeclarationCommand),alternativeImplementationCommand:Vs.string(e.alternativeImplementationCommand,this.defaultValue.alternativeImplementationCommand),alternativeReferenceCommand:Vs.string(e.alternativeReferenceCommand,this.defaultValue.alternativeReferenceCommand),alternativeTestsCommand:Vs.string(e.alternativeTestsCommand,this.defaultValue.alternativeTestsCommand)}}},VK=class extends en{constructor(){let t={enabled:!0,delay:300,hidingDelay:300,sticky:!0,above:!0};super(61,"hover",t,{"editor.hover.enabled":{type:"boolean",default:t.enabled,description:u("hover.enabled","Controls whether the hover is shown.")},"editor.hover.delay":{type:"number",default:t.delay,minimum:0,maximum:1e4,description:u("hover.delay","Controls the delay in milliseconds after which the hover is shown.")},"editor.hover.sticky":{type:"boolean",default:t.sticky,description:u("hover.sticky","Controls whether the hover should remain visible when mouse is moved over it.")},"editor.hover.hidingDelay":{type:"integer",minimum:0,default:t.hidingDelay,description:u("hover.hidingDelay","Controls the delay in milliseconds after which the hover is hidden. Requires `editor.hover.sticky` to be enabled.")},"editor.hover.above":{type:"boolean",default:t.above,description:u("hover.above","Prefer showing hovers above the line, if there's space.")}})}validate(t){if(!t||typeof t!="object")return this.defaultValue;let e=t;return{enabled:He(e.enabled,this.defaultValue.enabled),delay:Ki.clampedInt(e.delay,this.defaultValue.delay,0,1e4),sticky:He(e.sticky,this.defaultValue.sticky),hidingDelay:Ki.clampedInt(e.hidingDelay,this.defaultValue.hidingDelay,0,6e5),above:He(e.above,this.defaultValue.above)}}};var LD=class r extends pI{constructor(){super(147)}compute(t,e,i){return r.computeLayout(e,{memory:t.memory,outerWidth:t.outerWidth,outerHeight:t.outerHeight,isDominatedByLongLines:t.isDominatedByLongLines,lineHeight:t.fontInfo.lineHeight,viewLineCount:t.viewLineCount,lineNumbersDigitCount:t.lineNumbersDigitCount,typicalHalfwidthCharacterWidth:t.fontInfo.typicalHalfwidthCharacterWidth,maxDigitWidth:t.fontInfo.maxDigitWidth,pixelRatio:t.pixelRatio,glyphMarginDecorationLaneCount:t.glyphMarginDecorationLaneCount})}static computeContainedMinimapLineCount(t){let e=t.height/t.lineHeight,i=Math.floor(t.paddingTop/t.lineHeight),n=Math.floor(t.paddingBottom/t.lineHeight);t.scrollBeyondLastLine&&(n=Math.max(n,e-1));let o=(i+t.viewLineCount+n)/(t.pixelRatio*t.height),s=Math.floor(t.viewLineCount/o);return{typicalViewportLineCount:e,extraLinesBeforeFirstLine:i,extraLinesBeyondLastLine:n,desiredRatio:o,minimapLineCount:s}}static _computeMinimapLayout(t,e){let i=t.outerWidth,n=t.outerHeight,o=t.pixelRatio;if(!t.minimap.enabled)return{renderMinimap:0,minimapLeft:0,minimapWidth:0,minimapHeightIsEditorHeight:!1,minimapIsSampling:!1,minimapScale:1,minimapLineHeight:1,minimapCanvasInnerWidth:0,minimapCanvasInnerHeight:Math.floor(o*n),minimapCanvasOuterWidth:0,minimapCanvasOuterHeight:n};let s=e.stableMinimapLayoutInput,a=s&&t.outerHeight===s.outerHeight&&t.lineHeight===s.lineHeight&&t.typicalHalfwidthCharacterWidth===s.typicalHalfwidthCharacterWidth&&t.pixelRatio===s.pixelRatio&&t.scrollBeyondLastLine===s.scrollBeyondLastLine&&t.paddingTop===s.paddingTop&&t.paddingBottom===s.paddingBottom&&t.minimap.enabled===s.minimap.enabled&&t.minimap.side===s.minimap.side&&t.minimap.size===s.minimap.size&&t.minimap.showSlider===s.minimap.showSlider&&t.minimap.renderCharacters===s.minimap.renderCharacters&&t.minimap.maxColumn===s.minimap.maxColumn&&t.minimap.scale===s.minimap.scale&&t.verticalScrollbarWidth===s.verticalScrollbarWidth&&t.isViewportWrapping===s.isViewportWrapping,l=t.lineHeight,d=t.typicalHalfwidthCharacterWidth,c=t.scrollBeyondLastLine,p=t.minimap.renderCharacters,h=o>=2?Math.round(t.minimap.scale*2):t.minimap.scale,m=t.minimap.maxColumn,f=t.minimap.size,g=t.minimap.side,v=t.verticalScrollbarWidth,I=t.viewLineCount,y=t.remainingWidth,w=t.isViewportWrapping,C=p?2:3,S=Math.floor(o*n),D=S/o,k=!1,M=!1,O=C*h,K=h/o,G=1;if(f==="fill"||f==="fit"){let{typicalViewportLineCount:Ee,extraLinesBeforeFirstLine:Ce,extraLinesBeyondLastLine:Je,desiredRatio:pe,minimapLineCount:qt}=r.computeContainedMinimapLineCount({viewLineCount:I,scrollBeyondLastLine:c,paddingTop:t.paddingTop,paddingBottom:t.paddingBottom,height:n,lineHeight:l,pixelRatio:o});if(I/qt>1)k=!0,M=!0,h=1,O=1,K=h/o;else{let at=!1,On=h+1;if(f==="fit"){let Nn=Math.ceil((Ce+I+Je)*O);w&&a&&y<=e.stableFitRemainingWidth?(at=!0,On=e.stableFitMaxMinimapScale):at=Nn>S}if(f==="fill"||at){k=!0;let Nn=h;O=Math.min(l*o,Math.max(1,Math.floor(1/pe))),w&&a&&y<=e.stableFitRemainingWidth&&(On=e.stableFitMaxMinimapScale),h=Math.min(On,Math.max(1,Math.floor(O/C))),h>Nn&&(G=Math.min(2,h/Nn)),K=h/o/G,S=Math.ceil(Math.max(Ee,Ce+I+Je)*O),w?(e.stableMinimapLayoutInput=t,e.stableFitRemainingWidth=y,e.stableFitMaxMinimapScale=h):(e.stableMinimapLayoutInput=null,e.stableFitRemainingWidth=0)}}}let Y=Math.floor(m*K),ge=Math.min(Y,Math.max(0,Math.floor((y-v-2)*K/(d+K)))+ru),xe=Math.floor(o*ge),be=xe/o;xe=Math.floor(xe*G);let fe=p?1:2,Le=g==="left"?0:i-ge-v;return{renderMinimap:fe,minimapLeft:Le,minimapWidth:ge,minimapHeightIsEditorHeight:k,minimapIsSampling:M,minimapScale:h,minimapLineHeight:O,minimapCanvasInnerWidth:xe,minimapCanvasInnerHeight:S,minimapCanvasOuterWidth:be,minimapCanvasOuterHeight:D}}static computeLayout(t,e){let i=e.outerWidth|0,n=e.outerHeight|0,o=e.lineHeight|0,s=e.lineNumbersDigitCount|0,a=e.typicalHalfwidthCharacterWidth,l=e.maxDigitWidth,d=e.pixelRatio,c=e.viewLineCount,p=t.get(139),h=p==="inherit"?t.get(138):p,m=h==="inherit"?t.get(134):h,f=t.get(137),g=e.isDominatedByLongLines,v=t.get(58),I=t.get(69).renderType!==0,y=t.get(70),w=t.get(107),C=t.get(85),S=t.get(74),D=t.get(105),k=D.verticalScrollbarSize,M=D.verticalHasArrows,O=D.arrowSize,K=D.horizontalScrollbarSize,G=t.get(44),Y=t.get(112)!=="never",ge=t.get(67);G&&Y&&(ge+=16);let xe=0;if(I){let or=Math.max(s,y);xe=Math.round(or*l)}let be=0;v&&(be=o*e.glyphMarginDecorationLaneCount);let fe=0,Le=fe+be,Ee=Le+xe,Ce=Ee+ge,Je=i-be-xe-ge,pe=!1,qt=!1,Mt=-1;h==="inherit"&&g?(pe=!0,qt=!0):m==="on"||m==="bounded"?qt=!0:m==="wordWrapColumn"&&(Mt=f);let at=r._computeMinimapLayout({outerWidth:i,outerHeight:n,lineHeight:o,typicalHalfwidthCharacterWidth:a,pixelRatio:d,scrollBeyondLastLine:w,paddingTop:C.top,paddingBottom:C.bottom,minimap:S,verticalScrollbarWidth:k,viewLineCount:c,remainingWidth:Je,isViewportWrapping:qt},e.memory||new kD);at.renderMinimap!==0&&at.minimapLeft===0&&(fe+=at.minimapWidth,Le+=at.minimapWidth,Ee+=at.minimapWidth,Ce+=at.minimapWidth);let On=Je-at.minimapWidth,Nn=Math.max(1,Math.floor((On-k-2)/a)),Ro=M?O:0;return qt&&(Mt=Math.max(1,Nn),m==="bounded"&&(Mt=Math.min(Mt,f))),{width:i,height:n,glyphMarginLeft:fe,glyphMarginWidth:be,glyphMarginDecorationLaneCount:e.glyphMarginDecorationLaneCount,lineNumbersLeft:Le,lineNumbersWidth:xe,decorationsLeft:Ee,decorationsWidth:ge,contentLeft:Ce,contentWidth:On,minimap:at,viewportColumn:Nn,isWordWrapMinified:pe,isViewportWrapping:qt,wrappingColumn:Mt,verticalScrollbarWidth:k,horizontalScrollbarHeight:K,overviewRuler:{top:Ro,width:k,height:n-2*Ro,right:0}}}},WK=class extends en{constructor(){super(141,"wrappingStrategy","simple",{"editor.wrappingStrategy":{enumDescriptions:[u("wrappingStrategy.simple","Assumes that all characters are of the same width. This is a fast algorithm that works correctly for monospace fonts and certain scripts (like Latin characters) where glyphs are of equal width."),u("wrappingStrategy.advanced","Delegates wrapping points computation to the browser. This is a slow algorithm, that might cause freezes for large files, but it works correctly in all cases.")],type:"string",enum:["simple","advanced"],default:"simple",description:u("wrappingStrategy","Controls the algorithm that computes wrapping points. Note that when in accessibility mode, advanced will be used for the best experience.")}})}validate(t){return Pn(t,"simple",["simple","advanced"])}compute(t,e,i){return e.get(2)===2?"advanced":i}};var HK=class extends en{constructor(){let t={enabled:"onCode"};super(66,"lightbulb",t,{"editor.lightbulb.enabled":{type:"string",tags:["experimental"],enum:["off","onCode","on"],default:t.enabled,enumDescriptions:[u("editor.lightbulb.enabled.off","Disable the code action menu."),u("editor.lightbulb.enabled.onCode","Show the code action menu when the cursor is on lines with code."),u("editor.lightbulb.enabled.on","Show the code action menu when the cursor is on lines with code or on empty lines.")],description:u("enabled","Enables the Code Action lightbulb in the editor.")}})}validate(t){return!t||typeof t!="object"?this.defaultValue:{enabled:Pn(t.enabled,this.defaultValue.enabled,["off","onCode","on"])}}},UK=class extends en{constructor(){let t={enabled:!0,maxLineCount:5,defaultModel:"outlineModel",scrollWithEditor:!0};super(117,"stickyScroll",t,{"editor.stickyScroll.enabled":{type:"boolean",default:t.enabled,description:u("editor.stickyScroll.enabled","Shows the nested current scopes during the scroll at the top of the editor."),tags:["experimental"]},"editor.stickyScroll.maxLineCount":{type:"number",default:t.maxLineCount,minimum:1,maximum:20,description:u("editor.stickyScroll.maxLineCount","Defines the maximum number of sticky lines to show.")},"editor.stickyScroll.defaultModel":{type:"string",enum:["outlineModel","foldingProviderModel","indentationModel"],default:t.defaultModel,description:u("editor.stickyScroll.defaultModel","Defines the model to use for determining which lines to stick. If the outline model does not exist, it will fall back on the folding provider model which falls back on the indentation model. This order is respected in all three cases.")},"editor.stickyScroll.scrollWithEditor":{type:"boolean",default:t.scrollWithEditor,description:u("editor.stickyScroll.scrollWithEditor","Enable scrolling of Sticky Scroll with the editor's horizontal scrollbar.")}})}validate(t){if(!t||typeof t!="object")return this.defaultValue;let e=t;return{enabled:He(e.enabled,this.defaultValue.enabled),maxLineCount:Ki.clampedInt(e.maxLineCount,this.defaultValue.maxLineCount,1,20),defaultModel:Pn(e.defaultModel,this.defaultValue.defaultModel,["outlineModel","foldingProviderModel","indentationModel"]),scrollWithEditor:He(e.scrollWithEditor,this.defaultValue.scrollWithEditor)}}},zK=class extends en{constructor(){let t={enabled:"on",fontSize:0,fontFamily:"",padding:!1,maximumLength:43};super(143,"inlayHints",t,{"editor.inlayHints.enabled":{type:"string",default:t.enabled,description:u("inlayHints.enable","Enables the inlay hints in the editor."),enum:["on","onUnlessPressed","offUnlessPressed","off"],markdownEnumDescriptions:[u("editor.inlayHints.on","Inlay hints are enabled"),u("editor.inlayHints.onUnlessPressed","Inlay hints are showing by default and hide when holding {0}",ye?"Ctrl+Option":"Ctrl+Alt"),u("editor.inlayHints.offUnlessPressed","Inlay hints are hidden by default and show when holding {0}",ye?"Ctrl+Option":"Ctrl+Alt"),u("editor.inlayHints.off","Inlay hints are disabled")]},"editor.inlayHints.fontSize":{type:"number",default:t.fontSize,markdownDescription:u("inlayHints.fontSize","Controls font size of inlay hints in the editor. As default the {0} is used when the configured value is less than {1} or greater than the editor font size.","`#editor.fontSize#`","`5`")},"editor.inlayHints.fontFamily":{type:"string",default:t.fontFamily,markdownDescription:u("inlayHints.fontFamily","Controls font family of inlay hints in the editor. When set to empty, the {0} is used.","`#editor.fontFamily#`")},"editor.inlayHints.padding":{type:"boolean",default:t.padding,description:u("inlayHints.padding","Enables the padding around the inlay hints in the editor.")},"editor.inlayHints.maximumLength":{type:"number",default:t.maximumLength,markdownDescription:u("inlayHints.maximumLength","Maximum overall length of inlay hints, for a single line, before they get truncated by the editor. Set to `0` to never truncate")}})}validate(t){if(!t||typeof t!="object")return this.defaultValue;let e=t;return typeof e.enabled=="boolean"&&(e.enabled=e.enabled?"on":"off"),{enabled:Pn(e.enabled,this.defaultValue.enabled,["on","off","offUnlessPressed","onUnlessPressed"]),fontSize:Ki.clampedInt(e.fontSize,this.defaultValue.fontSize,0,100),fontFamily:Vs.string(e.fontFamily,this.defaultValue.fontFamily),padding:He(e.padding,this.defaultValue.padding),maximumLength:Ki.clampedInt(e.maximumLength,this.defaultValue.maximumLength,0,Number.MAX_SAFE_INTEGER)}}},KK=class extends en{constructor(){super(67,"lineDecorationsWidth",10)}validate(t){return typeof t=="string"&&/^\d+(\.\d+)?ch$/.test(t)?-parseFloat(t.substring(0,t.length-2)):Ki.clampedInt(t,this.defaultValue,0,1e3)}compute(t,e,i){return i<0?Ki.clampedInt(-i*t.fontInfo.typicalHalfwidthCharacterWidth,this.defaultValue,0,1e3):i}},GK=class extends kl{constructor(){super(68,"lineHeight",vs.lineHeight,t=>kl.clamp(t,0,150),{markdownDescription:u("lineHeight",`Controls the line height. 
 - Use 0 to automatically compute the line height from the font size.
 - Values between 0 and 8 will be used as a multiplier with the font size.
 - Values greater than or equal to 8 will be used as effective values.`)})}compute(t,e,i){return t.fontInfo.lineHeight}},qK=class extends en{constructor(){let t={enabled:!0,size:"proportional",side:"right",showSlider:"mouseover",autohide:!1,renderCharacters:!0,maxColumn:120,scale:1,showRegionSectionHeaders:!0,showMarkSectionHeaders:!0,sectionHeaderFontSize:9,sectionHeaderLetterSpacing:1};super(74,"minimap",t,{"editor.minimap.enabled":{type:"boolean",default:t.enabled,description:u("minimap.enabled","Controls whether the minimap is shown.")},"editor.minimap.autohide":{type:"boolean",default:t.autohide,description:u("minimap.autohide","Controls whether the minimap is hidden automatically.")},"editor.minimap.size":{type:"string",enum:["proportional","fill","fit"],enumDescriptions:[u("minimap.size.proportional","The minimap has the same size as the editor contents (and might scroll)."),u("minimap.size.fill","The minimap will stretch or shrink as necessary to fill the height of the editor (no scrolling)."),u("minimap.size.fit","The minimap will shrink as necessary to never be larger than the editor (no scrolling).")],default:t.size,description:u("minimap.size","Controls the size of the minimap.")},"editor.minimap.side":{type:"string",enum:["left","right"],default:t.side,description:u("minimap.side","Controls the side where to render the minimap.")},"editor.minimap.showSlider":{type:"string",enum:["always","mouseover"],default:t.showSlider,description:u("minimap.showSlider","Controls when the minimap slider is shown.")},"editor.minimap.scale":{type:"number",default:t.scale,minimum:1,maximum:3,enum:[1,2,3],description:u("minimap.scale","Scale of content drawn in the minimap: 1, 2 or 3.")},"editor.minimap.renderCharacters":{type:"boolean",default:t.renderCharacters,description:u("minimap.renderCharacters","Render the actual characters on a line as opposed to color blocks.")},"editor.minimap.maxColumn":{type:"number",default:t.maxColumn,description:u("minimap.maxColumn","Limit the width of the minimap to render at most a certain number of columns.")},"editor.minimap.showRegionSectionHeaders":{type:"boolean",default:t.showRegionSectionHeaders,description:u("minimap.showRegionSectionHeaders","Controls whether named regions are shown as section headers in the minimap.")},"editor.minimap.showMarkSectionHeaders":{type:"boolean",default:t.showMarkSectionHeaders,description:u("minimap.showMarkSectionHeaders","Controls whether MARK: comments are shown as section headers in the minimap.")},"editor.minimap.sectionHeaderFontSize":{type:"number",default:t.sectionHeaderFontSize,description:u("minimap.sectionHeaderFontSize","Controls the font size of section headers in the minimap.")},"editor.minimap.sectionHeaderLetterSpacing":{type:"number",default:t.sectionHeaderLetterSpacing,description:u("minimap.sectionHeaderLetterSpacing","Controls the amount of space (in pixels) between characters of section header. This helps the readability of the header in small font sizes.")}})}validate(t){if(!t||typeof t!="object")return this.defaultValue;let e=t;return{enabled:He(e.enabled,this.defaultValue.enabled),autohide:He(e.autohide,this.defaultValue.autohide),size:Pn(e.size,this.defaultValue.size,["proportional","fill","fit"]),side:Pn(e.side,this.defaultValue.side,["right","left"]),showSlider:Pn(e.showSlider,this.defaultValue.showSlider,["always","mouseover"]),renderCharacters:He(e.renderCharacters,this.defaultValue.renderCharacters),scale:Ki.clampedInt(e.scale,1,1,3),maxColumn:Ki.clampedInt(e.maxColumn,this.defaultValue.maxColumn,1,1e4),showRegionSectionHeaders:He(e.showRegionSectionHeaders,this.defaultValue.showRegionSectionHeaders),showMarkSectionHeaders:He(e.showMarkSectionHeaders,this.defaultValue.showMarkSectionHeaders),sectionHeaderFontSize:kl.clamp(e.sectionHeaderFontSize??this.defaultValue.sectionHeaderFontSize,4,32),sectionHeaderLetterSpacing:kl.clamp(e.sectionHeaderLetterSpacing??this.defaultValue.sectionHeaderLetterSpacing,0,5)}}};function Lve(r){return r==="ctrlCmd"?ye?"metaKey":"ctrlKey":"altKey"}var $K=class extends en{constructor(){super(85,"padding",{top:0,bottom:0},{"editor.padding.top":{type:"number",default:0,minimum:0,maximum:1e3,description:u("padding.top","Controls the amount of space between the top edge of the editor and the first line.")},"editor.padding.bottom":{type:"number",default:0,minimum:0,maximum:1e3,description:u("padding.bottom","Controls the amount of space between the bottom edge of the editor and the last line.")}})}validate(t){if(!t||typeof t!="object")return this.defaultValue;let e=t;return{top:Ki.clampedInt(e.top,0,0,1e3),bottom:Ki.clampedInt(e.bottom,0,0,1e3)}}},jK=class extends en{constructor(){let t={enabled:!0,cycle:!0};super(87,"parameterHints",t,{"editor.parameterHints.enabled":{type:"boolean",default:t.enabled,description:u("parameterHints.enabled","Enables a pop-up that shows parameter documentation and type information as you type.")},"editor.parameterHints.cycle":{type:"boolean",default:t.cycle,description:u("parameterHints.cycle","Controls whether the parameter hints menu cycles or closes when reaching the end of the list.")}})}validate(t){if(!t||typeof t!="object")return this.defaultValue;let e=t;return{enabled:He(e.enabled,this.defaultValue.enabled),cycle:He(e.cycle,this.defaultValue.cycle)}}},XK=class extends pI{constructor(){super(145)}compute(t,e,i){return t.pixelRatio}},YK=class extends en{constructor(){super(89,"placeholder",void 0)}validate(t){return typeof t>"u"?this.defaultValue:typeof t=="string"?t:this.defaultValue}},QK=class extends en{defaultValue;constructor(){let t={other:"on",comments:"off",strings:"off"},e=[{type:"boolean"},{type:"string",enum:["on","inline","off"],enumDescriptions:[u("on","Quick suggestions show inside the suggest widget"),u("inline","Quick suggestions show as ghost text"),u("off","Quick suggestions are disabled")]}];super(91,"quickSuggestions",t,{type:"object",additionalProperties:!1,properties:{strings:{anyOf:e,default:t.strings,description:u("quickSuggestions.strings","Enable quick suggestions inside strings.")},comments:{anyOf:e,default:t.comments,description:u("quickSuggestions.comments","Enable quick suggestions inside comments.")},other:{anyOf:e,default:t.other,description:u("quickSuggestions.other","Enable quick suggestions outside of strings and comments.")}},default:t,markdownDescription:u("quickSuggestions","Controls whether suggestions should automatically show up while typing. This can be controlled for typing in comments, strings, and other code. Quick suggestion can be configured to show as ghost text or with the suggest widget. Also be aware of the {0}-setting which controls if suggestions are triggered by special characters.","`#editor.suggestOnTriggerCharacters#`")}),this.defaultValue=t}validate(t){if(typeof t=="boolean"){let d=t?"on":"off";return{comments:d,strings:d,other:d}}if(!t||typeof t!="object")return this.defaultValue;let{other:e,comments:i,strings:n}=t,o=["on","inline","off"],s,a,l;return typeof e=="boolean"?s=e?"on":"off":s=Pn(e,this.defaultValue.other,o),typeof i=="boolean"?a=i?"on":"off":a=Pn(i,this.defaultValue.comments,o),typeof n=="boolean"?l=n?"on":"off":l=Pn(n,this.defaultValue.strings,o),{other:s,comments:a,strings:l}}};var ZK=class extends en{constructor(){super(69,"lineNumbers",{renderType:1,renderFn:null},{type:"string",enum:["off","on","relative","interval"],enumDescriptions:[u("lineNumbers.off","Line numbers are not rendered."),u("lineNumbers.on","Line numbers are rendered as absolute number."),u("lineNumbers.relative","Line numbers are rendered as distance in lines to cursor position."),u("lineNumbers.interval","Line numbers are rendered every 10 lines.")],default:"on",description:u("lineNumbers","Controls the display of line numbers.")})}validate(t){let e=this.defaultValue.renderType,i=this.defaultValue.renderFn;return typeof t<"u"&&(typeof t=="function"?(e=4,i=t):t==="interval"?e=3:t==="relative"?e=2:t==="on"?e=1:e=0),{renderType:e,renderFn:i}}};function hI(r){let t=r.get(100);return t==="editable"?r.get(93):t!=="on"}var JK=class extends en{constructor(){let t=[],e={type:"number",description:u("rulers.size","Number of monospace characters at which this editor ruler will render.")};super(104,"rulers",t,{type:"array",items:{anyOf:[e,{type:["object"],properties:{column:e,color:{type:"string",description:u("rulers.color","Color of this editor ruler."),format:"color-hex"}}}]},default:t,description:u("rulers","Render vertical rulers after a certain number of monospace characters. Use multiple values for multiple rulers. No rulers are drawn if array is empty.")})}validate(t){if(Array.isArray(t)){let e=[];for(let i of t)if(typeof i=="number")e.push({column:Ki.clampedInt(i,0,0,1e4),color:null});else if(i&&typeof i=="object"){let n=i;e.push({column:Ki.clampedInt(n.column,0,0,1e4),color:n.color})}return e.sort((i,n)=>i.column-n.column),e}return this.defaultValue}},eG=class extends en{constructor(){super(94,"readOnlyMessage",void 0)}validate(t){return!t||typeof t!="object"?this.defaultValue:t}};function sie(r,t){if(typeof r!="string")return t;switch(r){case"hidden":return 2;case"visible":return 3;default:return 1}}var tG=class extends en{constructor(){let t={vertical:1,horizontal:1,arrowSize:11,useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,horizontalScrollbarSize:12,horizontalSliderSize:12,verticalScrollbarSize:14,verticalSliderSize:14,handleMouseWheel:!0,alwaysConsumeMouseWheel:!0,scrollByPage:!1,ignoreHorizontalScrollbarInContentHeight:!1};super(105,"scrollbar",t,{"editor.scrollbar.vertical":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[u("scrollbar.vertical.auto","The vertical scrollbar will be visible only when necessary."),u("scrollbar.vertical.visible","The vertical scrollbar will always be visible."),u("scrollbar.vertical.fit","The vertical scrollbar will always be hidden.")],default:"auto",description:u("scrollbar.vertical","Controls the visibility of the vertical scrollbar.")},"editor.scrollbar.horizontal":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[u("scrollbar.horizontal.auto","The horizontal scrollbar will be visible only when necessary."),u("scrollbar.horizontal.visible","The horizontal scrollbar will always be visible."),u("scrollbar.horizontal.fit","The horizontal scrollbar will always be hidden.")],default:"auto",description:u("scrollbar.horizontal","Controls the visibility of the horizontal scrollbar.")},"editor.scrollbar.verticalScrollbarSize":{type:"number",default:t.verticalScrollbarSize,description:u("scrollbar.verticalScrollbarSize","The width of the vertical scrollbar.")},"editor.scrollbar.horizontalScrollbarSize":{type:"number",default:t.horizontalScrollbarSize,description:u("scrollbar.horizontalScrollbarSize","The height of the horizontal scrollbar.")},"editor.scrollbar.scrollByPage":{type:"boolean",default:t.scrollByPage,description:u("scrollbar.scrollByPage","Controls whether clicks scroll by page or jump to click position.")},"editor.scrollbar.ignoreHorizontalScrollbarInContentHeight":{type:"boolean",default:t.ignoreHorizontalScrollbarInContentHeight,description:u("scrollbar.ignoreHorizontalScrollbarInContentHeight","When set, the horizontal scrollbar will not increase the size of the editor's content.")}})}validate(t){if(!t||typeof t!="object")return this.defaultValue;let e=t,i=Ki.clampedInt(e.horizontalScrollbarSize,this.defaultValue.horizontalScrollbarSize,0,1e3),n=Ki.clampedInt(e.verticalScrollbarSize,this.defaultValue.verticalScrollbarSize,0,1e3);return{arrowSize:Ki.clampedInt(e.arrowSize,this.defaultValue.arrowSize,0,1e3),vertical:sie(e.vertical,this.defaultValue.vertical),horizontal:sie(e.horizontal,this.defaultValue.horizontal),useShadows:He(e.useShadows,this.defaultValue.useShadows),verticalHasArrows:He(e.verticalHasArrows,this.defaultValue.verticalHasArrows),horizontalHasArrows:He(e.horizontalHasArrows,this.defaultValue.horizontalHasArrows),handleMouseWheel:He(e.handleMouseWheel,this.defaultValue.handleMouseWheel),alwaysConsumeMouseWheel:He(e.alwaysConsumeMouseWheel,this.defaultValue.alwaysConsumeMouseWheel),horizontalScrollbarSize:i,horizontalSliderSize:Ki.clampedInt(e.horizontalSliderSize,i,0,1e3),verticalScrollbarSize:n,verticalSliderSize:Ki.clampedInt(e.verticalSliderSize,n,0,1e3),scrollByPage:He(e.scrollByPage,this.defaultValue.scrollByPage),ignoreHorizontalScrollbarInContentHeight:He(e.ignoreHorizontalScrollbarInContentHeight,this.defaultValue.ignoreHorizontalScrollbarInContentHeight)}}},nu="inUntrustedWorkspace",uI={allowedCharacters:"editor.unicodeHighlight.allowedCharacters",invisibleCharacters:"editor.unicodeHighlight.invisibleCharacters",nonBasicASCII:"editor.unicodeHighlight.nonBasicASCII",ambiguousCharacters:"editor.unicodeHighlight.ambiguousCharacters",includeComments:"editor.unicodeHighlight.includeComments",includeStrings:"editor.unicodeHighlight.includeStrings",allowedLocales:"editor.unicodeHighlight.allowedLocales"},iG=class extends en{constructor(){let t={nonBasicASCII:nu,invisibleCharacters:!0,ambiguousCharacters:!0,includeComments:nu,includeStrings:!0,allowedCharacters:{},allowedLocales:{_os:!0,_vscode:!0}};super(127,"unicodeHighlight",t,{[uI.nonBasicASCII]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,nu],default:t.nonBasicASCII,description:u("unicodeHighlight.nonBasicASCII","Controls whether all non-basic ASCII characters are highlighted. Only characters between U+0020 and U+007E, tab, line-feed and carriage-return are considered basic ASCII.")},[uI.invisibleCharacters]:{restricted:!0,type:"boolean",default:t.invisibleCharacters,description:u("unicodeHighlight.invisibleCharacters","Controls whether characters that just reserve space or have no width at all are highlighted.")},[uI.ambiguousCharacters]:{restricted:!0,type:"boolean",default:t.ambiguousCharacters,description:u("unicodeHighlight.ambiguousCharacters","Controls whether characters are highlighted that can be confused with basic ASCII characters, except those that are common in the current user locale.")},[uI.includeComments]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,nu],default:t.includeComments,description:u("unicodeHighlight.includeComments","Controls whether characters in comments should also be subject to Unicode highlighting.")},[uI.includeStrings]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,nu],default:t.includeStrings,description:u("unicodeHighlight.includeStrings","Controls whether characters in strings should also be subject to Unicode highlighting.")},[uI.allowedCharacters]:{restricted:!0,type:"object",default:t.allowedCharacters,description:u("unicodeHighlight.allowedCharacters","Defines allowed characters that are not being highlighted."),additionalProperties:{type:"boolean"}},[uI.allowedLocales]:{restricted:!0,type:"object",additionalProperties:{type:"boolean"},default:t.allowedLocales,description:u("unicodeHighlight.allowedLocales","Unicode characters that are common in allowed locales are not being highlighted.")}})}applyUpdate(t,e){let i=!1;e.allowedCharacters&&t&&(sn(t.allowedCharacters,e.allowedCharacters)||(t={...t,allowedCharacters:e.allowedCharacters},i=!0)),e.allowedLocales&&t&&(sn(t.allowedLocales,e.allowedLocales)||(t={...t,allowedLocales:e.allowedLocales},i=!0));let n=super.applyUpdate(t,e);return i?new sC(n.newValue,!0):n}validate(t){if(!t||typeof t!="object")return this.defaultValue;let e=t;return{nonBasicASCII:aC(e.nonBasicASCII,nu,[!0,!1,nu]),invisibleCharacters:He(e.invisibleCharacters,this.defaultValue.invisibleCharacters),ambiguousCharacters:He(e.ambiguousCharacters,this.defaultValue.ambiguousCharacters),includeComments:aC(e.includeComments,nu,[!0,!1,nu]),includeStrings:aC(e.includeStrings,nu,[!0,!1,nu]),allowedCharacters:this.validateBooleanMap(t.allowedCharacters,this.defaultValue.allowedCharacters),allowedLocales:this.validateBooleanMap(t.allowedLocales,this.defaultValue.allowedLocales)}}validateBooleanMap(t,e){if(typeof t!="object"||!t)return e;let i={};for(let[n,o]of Object.entries(t))o===!0&&(i[n]=!0);return i}},nG=class extends en{constructor(){let t={enabled:!0,mode:"subwordSmart",showToolbar:"onHover",suppressSuggestions:!1,keepOnBlur:!1,fontFamily:"default",syntaxHighlightingEnabled:!1};super(63,"inlineSuggest",t,{"editor.inlineSuggest.enabled":{type:"boolean",default:t.enabled,description:u("inlineSuggest.enabled","Controls whether to automatically show inline suggestions in the editor.")},"editor.inlineSuggest.showToolbar":{type:"string",default:t.showToolbar,enum:["always","onHover","never"],enumDescriptions:[u("inlineSuggest.showToolbar.always","Show the inline suggestion toolbar whenever an inline suggestion is shown."),u("inlineSuggest.showToolbar.onHover","Show the inline suggestion toolbar when hovering over an inline suggestion."),u("inlineSuggest.showToolbar.never","Never show the inline suggestion toolbar.")],description:u("inlineSuggest.showToolbar","Controls when to show the inline suggestion toolbar.")},"editor.inlineSuggest.syntaxHighlightingEnabled":{type:"boolean",default:t.syntaxHighlightingEnabled,description:u("inlineSuggest.syntaxHighlightingEnabled","Controls whether to show syntax highlighting for inline suggestions in the editor.")},"editor.inlineSuggest.suppressSuggestions":{type:"boolean",default:t.suppressSuggestions,description:u("inlineSuggest.suppressSuggestions","Controls how inline suggestions interact with the suggest widget. If enabled, the suggest widget is not shown automatically when inline suggestions are available.")},"editor.inlineSuggest.fontFamily":{type:"string",default:t.fontFamily,description:u("inlineSuggest.fontFamily","Controls the font family of the inline suggestions.")}})}validate(t){if(!t||typeof t!="object")return this.defaultValue;let e=t;return{enabled:He(e.enabled,this.defaultValue.enabled),mode:Pn(e.mode,this.defaultValue.mode,["prefix","subword","subwordSmart"]),showToolbar:Pn(e.showToolbar,this.defaultValue.showToolbar,["always","onHover","never"]),suppressSuggestions:He(e.suppressSuggestions,this.defaultValue.suppressSuggestions),keepOnBlur:He(e.keepOnBlur,this.defaultValue.keepOnBlur),fontFamily:Vs.string(e.fontFamily,this.defaultValue.fontFamily),syntaxHighlightingEnabled:He(e.syntaxHighlightingEnabled,this.defaultValue.syntaxHighlightingEnabled)}}},oG=class extends en{constructor(){let t={enabled:!1,showToolbar:"onHover",fontFamily:"default",keepOnBlur:!1};super(64,"experimentalInlineEdit",t,{"editor.experimentalInlineEdit.enabled":{type:"boolean",default:t.enabled,description:u("inlineEdit.enabled","Controls whether to show inline edits in the editor.")},"editor.experimentalInlineEdit.showToolbar":{type:"string",default:t.showToolbar,enum:["always","onHover","never"],enumDescriptions:[u("inlineEdit.showToolbar.always","Show the inline edit toolbar whenever an inline suggestion is shown."),u("inlineEdit.showToolbar.onHover","Show the inline edit toolbar when hovering over an inline suggestion."),u("inlineEdit.showToolbar.never","Never show the inline edit toolbar.")],description:u("inlineEdit.showToolbar","Controls when to show the inline edit toolbar.")},"editor.experimentalInlineEdit.fontFamily":{type:"string",default:t.fontFamily,description:u("inlineEdit.fontFamily","Controls the font family of the inline edit.")}})}validate(t){if(!t||typeof t!="object")return this.defaultValue;let e=t;return{enabled:He(e.enabled,this.defaultValue.enabled),showToolbar:Pn(e.showToolbar,this.defaultValue.showToolbar,["always","onHover","never"]),fontFamily:Vs.string(e.fontFamily,this.defaultValue.fontFamily),keepOnBlur:He(e.keepOnBlur,this.defaultValue.keepOnBlur)}}},rG=class extends en{constructor(){let t={enabled:Lp.bracketPairColorizationOptions.enabled,independentColorPoolPerBracketType:Lp.bracketPairColorizationOptions.independentColorPoolPerBracketType};super(15,"bracketPairColorization",t,{"editor.bracketPairColorization.enabled":{type:"boolean",default:t.enabled,markdownDescription:u("bracketPairColorization.enabled","Controls whether bracket pair colorization is enabled or not. Use {0} to override the bracket highlight colors.","`#workbench.colorCustomizations#`")},"editor.bracketPairColorization.independentColorPoolPerBracketType":{type:"boolean",default:t.independentColorPoolPerBracketType,description:u("bracketPairColorization.independentColorPoolPerBracketType","Controls whether each bracket type has its own independent color pool.")}})}validate(t){if(!t||typeof t!="object")return this.defaultValue;let e=t;return{enabled:He(e.enabled,this.defaultValue.enabled),independentColorPoolPerBracketType:He(e.independentColorPoolPerBracketType,this.defaultValue.independentColorPoolPerBracketType)}}},sG=class extends en{constructor(){let t={bracketPairs:!1,bracketPairsHorizontal:"active",highlightActiveBracketPair:!0,indentation:!0,highlightActiveIndentation:!0};super(16,"guides",t,{"editor.guides.bracketPairs":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[u("editor.guides.bracketPairs.true","Enables bracket pair guides."),u("editor.guides.bracketPairs.active","Enables bracket pair guides only for the active bracket pair."),u("editor.guides.bracketPairs.false","Disables bracket pair guides.")],default:t.bracketPairs,description:u("editor.guides.bracketPairs","Controls whether bracket pair guides are enabled or not.")},"editor.guides.bracketPairsHorizontal":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[u("editor.guides.bracketPairsHorizontal.true","Enables horizontal guides as addition to vertical bracket pair guides."),u("editor.guides.bracketPairsHorizontal.active","Enables horizontal guides only for the active bracket pair."),u("editor.guides.bracketPairsHorizontal.false","Disables horizontal bracket pair guides.")],default:t.bracketPairsHorizontal,description:u("editor.guides.bracketPairsHorizontal","Controls whether horizontal bracket pair guides are enabled or not.")},"editor.guides.highlightActiveBracketPair":{type:"boolean",default:t.highlightActiveBracketPair,description:u("editor.guides.highlightActiveBracketPair","Controls whether the editor should highlight the active bracket pair.")},"editor.guides.indentation":{type:"boolean",default:t.indentation,description:u("editor.guides.indentation","Controls whether the editor should render indent guides.")},"editor.guides.highlightActiveIndentation":{type:["boolean","string"],enum:[!0,"always",!1],enumDescriptions:[u("editor.guides.highlightActiveIndentation.true","Highlights the active indent guide."),u("editor.guides.highlightActiveIndentation.always","Highlights the active indent guide even if bracket guides are highlighted."),u("editor.guides.highlightActiveIndentation.false","Do not highlight the active indent guide.")],default:t.highlightActiveIndentation,description:u("editor.guides.highlightActiveIndentation","Controls whether the editor should highlight the active indent guide.")}})}validate(t){if(!t||typeof t!="object")return this.defaultValue;let e=t;return{bracketPairs:aC(e.bracketPairs,this.defaultValue.bracketPairs,[!0,!1,"active"]),bracketPairsHorizontal:aC(e.bracketPairsHorizontal,this.defaultValue.bracketPairsHorizontal,[!0,!1,"active"]),highlightActiveBracketPair:He(e.highlightActiveBracketPair,this.defaultValue.highlightActiveBracketPair),indentation:He(e.indentation,this.defaultValue.indentation),highlightActiveIndentation:aC(e.highlightActiveIndentation,this.defaultValue.highlightActiveIndentation,[!0,!1,"always"])}}};function aC(r,t,e){let i=e.indexOf(r);return i===-1?t:e[i]}var aG=class extends en{constructor(){let t={insertMode:"insert",filterGraceful:!0,snippetsPreventQuickSuggestions:!1,localityBonus:!1,shareSuggestSelections:!1,selectionMode:"always",showIcons:!0,showStatusBar:!1,preview:!1,previewMode:"subwordSmart",showInlineDetails:!0,showMethods:!0,showFunctions:!0,showConstructors:!0,showDeprecated:!0,matchOnWordStartOnly:!0,showFields:!0,showVariables:!0,showClasses:!0,showStructs:!0,showInterfaces:!0,showModules:!0,showProperties:!0,showEvents:!0,showOperators:!0,showUnits:!0,showValues:!0,showConstants:!0,showEnums:!0,showEnumMembers:!0,showKeywords:!0,showWords:!0,showColors:!0,showFiles:!0,showReferences:!0,showFolders:!0,showTypeParameters:!0,showSnippets:!0,showUsers:!0,showIssues:!0};super(120,"suggest",t,{"editor.suggest.insertMode":{type:"string",enum:["insert","replace"],enumDescriptions:[u("suggest.insertMode.insert","Insert suggestion without overwriting text right of the cursor."),u("suggest.insertMode.replace","Insert suggestion and overwrite text right of the cursor.")],default:t.insertMode,description:u("suggest.insertMode","Controls whether words are overwritten when accepting completions. Note that this depends on extensions opting into this feature.")},"editor.suggest.filterGraceful":{type:"boolean",default:t.filterGraceful,description:u("suggest.filterGraceful","Controls whether filtering and sorting suggestions accounts for small typos.")},"editor.suggest.localityBonus":{type:"boolean",default:t.localityBonus,description:u("suggest.localityBonus","Controls whether sorting favors words that appear close to the cursor.")},"editor.suggest.shareSuggestSelections":{type:"boolean",default:t.shareSuggestSelections,markdownDescription:u("suggest.shareSuggestSelections","Controls whether remembered suggestion selections are shared between multiple workspaces and windows (needs `#editor.suggestSelection#`).")},"editor.suggest.selectionMode":{type:"string",enum:["always","never","whenTriggerCharacter","whenQuickSuggestion"],enumDescriptions:[u("suggest.insertMode.always","Always select a suggestion when automatically triggering IntelliSense."),u("suggest.insertMode.never","Never select a suggestion when automatically triggering IntelliSense."),u("suggest.insertMode.whenTriggerCharacter","Select a suggestion only when triggering IntelliSense from a trigger character."),u("suggest.insertMode.whenQuickSuggestion","Select a suggestion only when triggering IntelliSense as you type.")],default:t.selectionMode,markdownDescription:u("suggest.selectionMode","Controls whether a suggestion is selected when the widget shows. Note that this only applies to automatically triggered suggestions ({0} and {1}) and that a suggestion is always selected when explicitly invoked, e.g via `Ctrl+Space`.","`#editor.quickSuggestions#`","`#editor.suggestOnTriggerCharacters#`")},"editor.suggest.snippetsPreventQuickSuggestions":{type:"boolean",default:t.snippetsPreventQuickSuggestions,description:u("suggest.snippetsPreventQuickSuggestions","Controls whether an active snippet prevents quick suggestions.")},"editor.suggest.showIcons":{type:"boolean",default:t.showIcons,description:u("suggest.showIcons","Controls whether to show or hide icons in suggestions.")},"editor.suggest.showStatusBar":{type:"boolean",default:t.showStatusBar,description:u("suggest.showStatusBar","Controls the visibility of the status bar at the bottom of the suggest widget.")},"editor.suggest.preview":{type:"boolean",default:t.preview,description:u("suggest.preview","Controls whether to preview the suggestion outcome in the editor.")},"editor.suggest.showInlineDetails":{type:"boolean",default:t.showInlineDetails,description:u("suggest.showInlineDetails","Controls whether suggest details show inline with the label or only in the details widget.")},"editor.suggest.maxVisibleSuggestions":{type:"number",deprecationMessage:u("suggest.maxVisibleSuggestions.dep","This setting is deprecated. The suggest widget can now be resized.")},"editor.suggest.filteredTypes":{type:"object",deprecationMessage:u("deprecated","This setting is deprecated, please use separate settings like 'editor.suggest.showKeywords' or 'editor.suggest.showSnippets' instead.")},"editor.suggest.showMethods":{type:"boolean",default:!0,markdownDescription:u("editor.suggest.showMethods","When enabled IntelliSense shows `method`-suggestions.")},"editor.suggest.showFunctions":{type:"boolean",default:!0,markdownDescription:u("editor.suggest.showFunctions","When enabled IntelliSense shows `function`-suggestions.")},"editor.suggest.showConstructors":{type:"boolean",default:!0,markdownDescription:u("editor.suggest.showConstructors","When enabled IntelliSense shows `constructor`-suggestions.")},"editor.suggest.showDeprecated":{type:"boolean",default:!0,markdownDescription:u("editor.suggest.showDeprecated","When enabled IntelliSense shows `deprecated`-suggestions.")},"editor.suggest.matchOnWordStartOnly":{type:"boolean",default:!0,markdownDescription:u("editor.suggest.matchOnWordStartOnly","When enabled IntelliSense filtering requires that the first character matches on a word start. For example, `c` on `Console` or `WebContext` but _not_ on `description`. When disabled IntelliSense will show more results but still sorts them by match quality.")},"editor.suggest.showFields":{type:"boolean",default:!0,markdownDescription:u("editor.suggest.showFields","When enabled IntelliSense shows `field`-suggestions.")},"editor.suggest.showVariables":{type:"boolean",default:!0,markdownDescription:u("editor.suggest.showVariables","When enabled IntelliSense shows `variable`-suggestions.")},"editor.suggest.showClasses":{type:"boolean",default:!0,markdownDescription:u("editor.suggest.showClasss","When enabled IntelliSense shows `class`-suggestions.")},"editor.suggest.showStructs":{type:"boolean",default:!0,markdownDescription:u("editor.suggest.showStructs","When enabled IntelliSense shows `struct`-suggestions.")},"editor.suggest.showInterfaces":{type:"boolean",default:!0,markdownDescription:u("editor.suggest.showInterfaces","When enabled IntelliSense shows `interface`-suggestions.")},"editor.suggest.showModules":{type:"boolean",default:!0,markdownDescription:u("editor.suggest.showModules","When enabled IntelliSense shows `module`-suggestions.")},"editor.suggest.showProperties":{type:"boolean",default:!0,markdownDescription:u("editor.suggest.showPropertys","When enabled IntelliSense shows `property`-suggestions.")},"editor.suggest.showEvents":{type:"boolean",default:!0,markdownDescription:u("editor.suggest.showEvents","When enabled IntelliSense shows `event`-suggestions.")},"editor.suggest.showOperators":{type:"boolean",default:!0,markdownDescription:u("editor.suggest.showOperators","When enabled IntelliSense shows `operator`-suggestions.")},"editor.suggest.showUnits":{type:"boolean",default:!0,markdownDescription:u("editor.suggest.showUnits","When enabled IntelliSense shows `unit`-suggestions.")},"editor.suggest.showValues":{type:"boolean",default:!0,markdownDescription:u("editor.suggest.showValues","When enabled IntelliSense shows `value`-suggestions.")},"editor.suggest.showConstants":{type:"boolean",default:!0,markdownDescription:u("editor.suggest.showConstants","When enabled IntelliSense shows `constant`-suggestions.")},"editor.suggest.showEnums":{type:"boolean",default:!0,markdownDescription:u("editor.suggest.showEnums","When enabled IntelliSense shows `enum`-suggestions.")},"editor.suggest.showEnumMembers":{type:"boolean",default:!0,markdownDescription:u("editor.suggest.showEnumMembers","When enabled IntelliSense shows `enumMember`-suggestions.")},"editor.suggest.showKeywords":{type:"boolean",default:!0,markdownDescription:u("editor.suggest.showKeywords","When enabled IntelliSense shows `keyword`-suggestions.")},"editor.suggest.showWords":{type:"boolean",default:!0,markdownDescription:u("editor.suggest.showTexts","When enabled IntelliSense shows `text`-suggestions.")},"editor.suggest.showColors":{type:"boolean",default:!0,markdownDescription:u("editor.suggest.showColors","When enabled IntelliSense shows `color`-suggestions.")},"editor.suggest.showFiles":{type:"boolean",default:!0,markdownDescription:u("editor.suggest.showFiles","When enabled IntelliSense shows `file`-suggestions.")},"editor.suggest.showReferences":{type:"boolean",default:!0,markdownDescription:u("editor.suggest.showReferences","When enabled IntelliSense shows `reference`-suggestions.")},"editor.suggest.showCustomcolors":{type:"boolean",default:!0,markdownDescription:u("editor.suggest.showCustomcolors","When enabled IntelliSense shows `customcolor`-suggestions.")},"editor.suggest.showFolders":{type:"boolean",default:!0,markdownDescription:u("editor.suggest.showFolders","When enabled IntelliSense shows `folder`-suggestions.")},"editor.suggest.showTypeParameters":{type:"boolean",default:!0,markdownDescription:u("editor.suggest.showTypeParameters","When enabled IntelliSense shows `typeParameter`-suggestions.")},"editor.suggest.showSnippets":{type:"boolean",default:!0,markdownDescription:u("editor.suggest.showSnippets","When enabled IntelliSense shows `snippet`-suggestions.")},"editor.suggest.showUsers":{type:"boolean",default:!0,markdownDescription:u("editor.suggest.showUsers","When enabled IntelliSense shows `user`-suggestions.")},"editor.suggest.showIssues":{type:"boolean",default:!0,markdownDescription:u("editor.suggest.showIssues","When enabled IntelliSense shows `issues`-suggestions.")}})}validate(t){if(!t||typeof t!="object")return this.defaultValue;let e=t;return{insertMode:Pn(e.insertMode,this.defaultValue.insertMode,["insert","replace"]),filterGraceful:He(e.filterGraceful,this.defaultValue.filterGraceful),snippetsPreventQuickSuggestions:He(e.snippetsPreventQuickSuggestions,this.defaultValue.filterGraceful),localityBonus:He(e.localityBonus,this.defaultValue.localityBonus),shareSuggestSelections:He(e.shareSuggestSelections,this.defaultValue.shareSuggestSelections),selectionMode:Pn(e.selectionMode,this.defaultValue.selectionMode,["always","never","whenQuickSuggestion","whenTriggerCharacter"]),showIcons:He(e.showIcons,this.defaultValue.showIcons),showStatusBar:He(e.showStatusBar,this.defaultValue.showStatusBar),preview:He(e.preview,this.defaultValue.preview),previewMode:Pn(e.previewMode,this.defaultValue.previewMode,["prefix","subword","subwordSmart"]),showInlineDetails:He(e.showInlineDetails,this.defaultValue.showInlineDetails),showMethods:He(e.showMethods,this.defaultValue.showMethods),showFunctions:He(e.showFunctions,this.defaultValue.showFunctions),showConstructors:He(e.showConstructors,this.defaultValue.showConstructors),showDeprecated:He(e.showDeprecated,this.defaultValue.showDeprecated),matchOnWordStartOnly:He(e.matchOnWordStartOnly,this.defaultValue.matchOnWordStartOnly),showFields:He(e.showFields,this.defaultValue.showFields),showVariables:He(e.showVariables,this.defaultValue.showVariables),showClasses:He(e.showClasses,this.defaultValue.showClasses),showStructs:He(e.showStructs,this.defaultValue.showStructs),showInterfaces:He(e.showInterfaces,this.defaultValue.showInterfaces),showModules:He(e.showModules,this.defaultValue.showModules),showProperties:He(e.showProperties,this.defaultValue.showProperties),showEvents:He(e.showEvents,this.defaultValue.showEvents),showOperators:He(e.showOperators,this.defaultValue.showOperators),showUnits:He(e.showUnits,this.defaultValue.showUnits),showValues:He(e.showValues,this.defaultValue.showValues),showConstants:He(e.showConstants,this.defaultValue.showConstants),showEnums:He(e.showEnums,this.defaultValue.showEnums),showEnumMembers:He(e.showEnumMembers,this.defaultValue.showEnumMembers),showKeywords:He(e.showKeywords,this.defaultValue.showKeywords),showWords:He(e.showWords,this.defaultValue.showWords),showColors:He(e.showColors,this.defaultValue.showColors),showFiles:He(e.showFiles,this.defaultValue.showFiles),showReferences:He(e.showReferences,this.defaultValue.showReferences),showFolders:He(e.showFolders,this.defaultValue.showFolders),showTypeParameters:He(e.showTypeParameters,this.defaultValue.showTypeParameters),showSnippets:He(e.showSnippets,this.defaultValue.showSnippets),showUsers:He(e.showUsers,this.defaultValue.showUsers),showIssues:He(e.showIssues,this.defaultValue.showIssues)}}},lG=class extends en{constructor(){super(115,"smartSelect",{selectLeadingAndTrailingWhitespace:!0,selectSubwords:!0},{"editor.smartSelect.selectLeadingAndTrailingWhitespace":{description:u("selectLeadingAndTrailingWhitespace","Whether leading and trailing whitespace should always be selected."),default:!0,type:"boolean"},"editor.smartSelect.selectSubwords":{description:u("selectSubwords","Whether subwords (like 'foo' in 'fooBar' or 'foo_bar') should be selected."),default:!0,type:"boolean"}})}validate(t){return!t||typeof t!="object"?this.defaultValue:{selectLeadingAndTrailingWhitespace:He(t.selectLeadingAndTrailingWhitespace,this.defaultValue.selectLeadingAndTrailingWhitespace),selectSubwords:He(t.selectSubwords,this.defaultValue.selectSubwords)}}},dG=class extends en{constructor(){let t=[];super(132,"wordSegmenterLocales",t,{anyOf:[{description:u("wordSegmenterLocales","Locales to be used for word segmentation when doing word related navigations or operations. Specify the BCP 47 language tag of the word you wish to recognize (e.g., ja, zh-CN, zh-Hant-TW, etc.)."),type:"string"},{description:u("wordSegmenterLocales","Locales to be used for word segmentation when doing word related navigations or operations. Specify the BCP 47 language tag of the word you wish to recognize (e.g., ja, zh-CN, zh-Hant-TW, etc.)."),type:"array",items:{type:"string"}}]})}validate(t){if(typeof t=="string"&&(t=[t]),Array.isArray(t)){let e=[];for(let i of t)if(typeof i=="string")try{Intl.Segmenter.supportedLocalesOf(i).length>0&&e.push(i)}catch{}return e}return this.defaultValue}};var cG=class extends en{constructor(){super(140,"wrappingIndent",1,{"editor.wrappingIndent":{type:"string",enum:["none","same","indent","deepIndent"],enumDescriptions:[u("wrappingIndent.none","No indentation. Wrapped lines begin at column 1."),u("wrappingIndent.same","Wrapped lines get the same indentation as the parent."),u("wrappingIndent.indent","Wrapped lines get +1 indentation toward the parent."),u("wrappingIndent.deepIndent","Wrapped lines get +2 indentation toward the parent.")],description:u("wrappingIndent","Controls the indentation of wrapped lines."),default:"same"}})}validate(t){switch(t){case"none":return 0;case"same":return 1;case"indent":return 2;case"deepIndent":return 3}return 1}compute(t,e,i){return e.get(2)===2?0:i}},uG=class extends pI{constructor(){super(148)}compute(t,e,i){let n=e.get(147);return{isDominatedByLongLines:t.isDominatedByLongLines,isWordWrapMinified:n.isWordWrapMinified,isViewportWrapping:n.isViewportWrapping,wrappingColumn:n.wrappingColumn}}},pG=class extends en{constructor(){let t={enabled:!0,showDropSelector:"afterDrop"};super(36,"dropIntoEditor",t,{"editor.dropIntoEditor.enabled":{type:"boolean",default:t.enabled,markdownDescription:u("dropIntoEditor.enabled","Controls whether you can drag and drop a file into a text editor by holding down the `Shift` key (instead of opening the file in an editor).")},"editor.dropIntoEditor.showDropSelector":{type:"string",markdownDescription:u("dropIntoEditor.showDropSelector","Controls if a widget is shown when dropping files into the editor. This widget lets you control how the file is dropped."),enum:["afterDrop","never"],enumDescriptions:[u("dropIntoEditor.showDropSelector.afterDrop","Show the drop selector widget after a file is dropped into the editor."),u("dropIntoEditor.showDropSelector.never","Never show the drop selector widget. Instead the default drop provider is always used.")],default:"afterDrop"}})}validate(t){if(!t||typeof t!="object")return this.defaultValue;let e=t;return{enabled:He(e.enabled,this.defaultValue.enabled),showDropSelector:Pn(e.showDropSelector,this.defaultValue.showDropSelector,["afterDrop","never"])}}},hG=class extends en{constructor(){let t={enabled:!0,showPasteSelector:"afterPaste"};super(86,"pasteAs",t,{"editor.pasteAs.enabled":{type:"boolean",default:t.enabled,markdownDescription:u("pasteAs.enabled","Controls whether you can paste content in different ways.")},"editor.pasteAs.showPasteSelector":{type:"string",markdownDescription:u("pasteAs.showPasteSelector","Controls if a widget is shown when pasting content in to the editor. This widget lets you control how the file is pasted."),enum:["afterPaste","never"],enumDescriptions:[u("pasteAs.showPasteSelector.afterPaste","Show the paste selector widget after content is pasted into the editor."),u("pasteAs.showPasteSelector.never","Never show the paste selector widget. Instead the default pasting behavior is always used.")],default:"afterPaste"}})}validate(t){if(!t||typeof t!="object")return this.defaultValue;let e=t;return{enabled:He(e.enabled,this.defaultValue.enabled),showPasteSelector:Pn(e.showPasteSelector,this.defaultValue.showPasteSelector,["afterPaste","never"])}}},Rve="Consolas, 'Courier New', monospace",Pve="Menlo, Monaco, 'Courier New', monospace",Mve="'Droid Sans Mono', 'monospace', monospace",vs={fontFamily:ye?Pve:ci?Mve:Rve,fontWeight:"normal",fontSize:ye?12:14,lineHeight:0,letterSpacing:0},dC=[];function me(r){return dC[r.id]=r,r}var uc={acceptSuggestionOnCommitCharacter:me(new li(0,"acceptSuggestionOnCommitCharacter",!0,{markdownDescription:u("acceptSuggestionOnCommitCharacter","Controls whether suggestions should be accepted on commit characters. For example, in JavaScript, the semi-colon (`;`) can be a commit character that accepts a suggestion and types that character.")})),acceptSuggestionOnEnter:me(new Cn(1,"acceptSuggestionOnEnter","on",["on","smart","off"],{markdownEnumDescriptions:["",u("acceptSuggestionOnEnterSmart","Only accept a suggestion with `Enter` when it makes a textual change."),""],markdownDescription:u("acceptSuggestionOnEnter","Controls whether suggestions should be accepted on `Enter`, in addition to `Tab`. Helps to avoid ambiguity between inserting new lines or accepting suggestions.")})),accessibilitySupport:me(new LK),accessibilityPageSize:me(new Ki(3,"accessibilityPageSize",10,1,1073741824,{description:u("accessibilityPageSize","Controls the number of lines in the editor that can be read out by a screen reader at once. When we detect a screen reader we automatically set the default to be 500. Warning: this has a performance implication for numbers larger than the default."),tags:["accessibility"]})),ariaLabel:me(new Vs(4,"ariaLabel",u("editorViewAccessibleLabel","Editor content"))),ariaRequired:me(new li(5,"ariaRequired",!1,void 0)),screenReaderAnnounceInlineSuggestion:me(new li(8,"screenReaderAnnounceInlineSuggestion",!0,{description:u("screenReaderAnnounceInlineSuggestion","Control whether inline suggestions are announced by a screen reader."),tags:["accessibility"]})),autoClosingBrackets:me(new Cn(6,"autoClosingBrackets","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",u("editor.autoClosingBrackets.languageDefined","Use language configurations to determine when to autoclose brackets."),u("editor.autoClosingBrackets.beforeWhitespace","Autoclose brackets only when the cursor is to the left of whitespace."),""],description:u("autoClosingBrackets","Controls whether the editor should automatically close brackets after the user adds an opening bracket.")})),autoClosingComments:me(new Cn(7,"autoClosingComments","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",u("editor.autoClosingComments.languageDefined","Use language configurations to determine when to autoclose comments."),u("editor.autoClosingComments.beforeWhitespace","Autoclose comments only when the cursor is to the left of whitespace."),""],description:u("autoClosingComments","Controls whether the editor should automatically close comments after the user adds an opening comment.")})),autoClosingDelete:me(new Cn(9,"autoClosingDelete","auto",["always","auto","never"],{enumDescriptions:["",u("editor.autoClosingDelete.auto","Remove adjacent closing quotes or brackets only if they were automatically inserted."),""],description:u("autoClosingDelete","Controls whether the editor should remove adjacent closing quotes or brackets when deleting.")})),autoClosingOvertype:me(new Cn(10,"autoClosingOvertype","auto",["always","auto","never"],{enumDescriptions:["",u("editor.autoClosingOvertype.auto","Type over closing quotes or brackets only if they were automatically inserted."),""],description:u("autoClosingOvertype","Controls whether the editor should type over closing quotes or brackets.")})),autoClosingQuotes:me(new Cn(11,"autoClosingQuotes","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",u("editor.autoClosingQuotes.languageDefined","Use language configurations to determine when to autoclose quotes."),u("editor.autoClosingQuotes.beforeWhitespace","Autoclose quotes only when the cursor is to the left of whitespace."),""],description:u("autoClosingQuotes","Controls whether the editor should automatically close quotes after the user adds an opening quote.")})),autoIndent:me(new rC(12,"autoIndent",4,"full",["none","keep","brackets","advanced","full"],_ve,{enumDescriptions:[u("editor.autoIndent.none","The editor will not insert indentation automatically."),u("editor.autoIndent.keep","The editor will keep the current line's indentation."),u("editor.autoIndent.brackets","The editor will keep the current line's indentation and honor language defined brackets."),u("editor.autoIndent.advanced","The editor will keep the current line's indentation, honor language defined brackets and invoke special onEnterRules defined by languages."),u("editor.autoIndent.full","The editor will keep the current line's indentation, honor language defined brackets, invoke special onEnterRules defined by languages, and honor indentationRules defined by languages.")],description:u("autoIndent","Controls whether the editor should automatically adjust the indentation when users type, paste, move or indent lines.")})),automaticLayout:me(new li(13,"automaticLayout",!1)),autoSurround:me(new Cn(14,"autoSurround","languageDefined",["languageDefined","quotes","brackets","never"],{enumDescriptions:[u("editor.autoSurround.languageDefined","Use language configurations to determine when to automatically surround selections."),u("editor.autoSurround.quotes","Surround with quotes but not brackets."),u("editor.autoSurround.brackets","Surround with brackets but not quotes."),""],description:u("autoSurround","Controls whether the editor should automatically surround selections when typing quotes or brackets.")})),bracketPairColorization:me(new rG),bracketPairGuides:me(new sG),stickyTabStops:me(new li(118,"stickyTabStops",!1,{description:u("stickyTabStops","Emulate selection behavior of tab characters when using spaces for indentation. Selection will stick to tab stops.")})),codeLens:me(new li(17,"codeLens",!0,{description:u("codeLens","Controls whether the editor shows CodeLens.")})),codeLensFontFamily:me(new Vs(18,"codeLensFontFamily","",{description:u("codeLensFontFamily","Controls the font family for CodeLens.")})),codeLensFontSize:me(new Ki(19,"codeLensFontSize",0,0,100,{type:"number",default:0,minimum:0,maximum:100,markdownDescription:u("codeLensFontSize","Controls the font size in pixels for CodeLens. When set to 0, 90% of `#editor.fontSize#` is used.")})),colorDecorators:me(new li(20,"colorDecorators",!0,{description:u("colorDecorators","Controls whether the editor should render the inline color decorators and color picker.")})),colorDecoratorActivatedOn:me(new Cn(150,"colorDecoratorsActivatedOn","clickAndHover",["clickAndHover","hover","click"],{enumDescriptions:[u("editor.colorDecoratorActivatedOn.clickAndHover","Make the color picker appear both on click and hover of the color decorator"),u("editor.colorDecoratorActivatedOn.hover","Make the color picker appear on hover of the color decorator"),u("editor.colorDecoratorActivatedOn.click","Make the color picker appear on click of the color decorator")],description:u("colorDecoratorActivatedOn","Controls the condition to make a color picker appear from a color decorator")})),colorDecoratorsLimit:me(new Ki(21,"colorDecoratorsLimit",500,1,1e6,{markdownDescription:u("colorDecoratorsLimit","Controls the max number of color decorators that can be rendered in an editor at once.")})),columnSelection:me(new li(22,"columnSelection",!1,{description:u("columnSelection","Enable that the selection with the mouse and keys is doing column selection.")})),comments:me(new RK),contextmenu:me(new li(24,"contextmenu",!0)),copyWithSyntaxHighlighting:me(new li(25,"copyWithSyntaxHighlighting",!0,{description:u("copyWithSyntaxHighlighting","Controls whether syntax highlighting should be copied into the clipboard.")})),cursorBlinking:me(new rC(26,"cursorBlinking",1,"blink",["blink","smooth","phase","expand","solid"],Dve,{description:u("cursorBlinking","Control the cursor animation style.")})),cursorSmoothCaretAnimation:me(new Cn(27,"cursorSmoothCaretAnimation","off",["off","explicit","on"],{enumDescriptions:[u("cursorSmoothCaretAnimation.off","Smooth caret animation is disabled."),u("cursorSmoothCaretAnimation.explicit","Smooth caret animation is enabled only when the user moves the cursor with an explicit gesture."),u("cursorSmoothCaretAnimation.on","Smooth caret animation is always enabled.")],description:u("cursorSmoothCaretAnimation","Controls whether the smooth caret animation should be enabled.")})),cursorStyle:me(new rC(28,"cursorStyle",1,"line",["line","block","underline","line-thin","block-outline","underline-thin"],kve,{description:u("cursorStyle","Controls the cursor style.")})),cursorSurroundingLines:me(new Ki(29,"cursorSurroundingLines",0,0,1073741824,{description:u("cursorSurroundingLines","Controls the minimal number of visible leading lines (minimum 0) and trailing lines (minimum 1) surrounding the cursor. Known as 'scrollOff' or 'scrollOffset' in some other editors.")})),cursorSurroundingLinesStyle:me(new Cn(30,"cursorSurroundingLinesStyle","default",["default","all"],{enumDescriptions:[u("cursorSurroundingLinesStyle.default","`cursorSurroundingLines` is enforced only when triggered via the keyboard or API."),u("cursorSurroundingLinesStyle.all","`cursorSurroundingLines` is enforced always.")],markdownDescription:u("cursorSurroundingLinesStyle","Controls when `#editor.cursorSurroundingLines#` should be enforced.")})),cursorWidth:me(new Ki(31,"cursorWidth",0,0,1073741824,{markdownDescription:u("cursorWidth","Controls the width of the cursor when `#editor.cursorStyle#` is set to `line`.")})),disableLayerHinting:me(new li(32,"disableLayerHinting",!1)),disableMonospaceOptimizations:me(new li(33,"disableMonospaceOptimizations",!1)),domReadOnly:me(new li(34,"domReadOnly",!1)),dragAndDrop:me(new li(35,"dragAndDrop",!0,{description:u("dragAndDrop","Controls whether the editor should allow moving selections via drag and drop.")})),emptySelectionClipboard:me(new MK),dropIntoEditor:me(new pG),experimentalEditContextEnabled:me(new li(37,"experimentalEditContextEnabled",!1,{description:u("experimentalEditContextEnabled","Sets whether the new experimental edit context should be used instead of the text area.")})),stickyScroll:me(new UK),experimentalWhitespaceRendering:me(new Cn(39,"experimentalWhitespaceRendering","svg",["svg","font","off"],{enumDescriptions:[u("experimentalWhitespaceRendering.svg","Use a new rendering method with svgs."),u("experimentalWhitespaceRendering.font","Use a new rendering method with font characters."),u("experimentalWhitespaceRendering.off","Use the stable rendering method.")],description:u("experimentalWhitespaceRendering","Controls whether whitespace is rendered with a new, experimental method.")})),extraEditorClassName:me(new Vs(40,"extraEditorClassName","")),fastScrollSensitivity:me(new kl(41,"fastScrollSensitivity",5,r=>r<=0?5:r,{markdownDescription:u("fastScrollSensitivity","Scrolling speed multiplier when pressing `Alt`.")})),find:me(new AK),fixedOverflowWidgets:me(new li(43,"fixedOverflowWidgets",!1)),folding:me(new li(44,"folding",!0,{description:u("folding","Controls whether the editor has code folding enabled.")})),foldingStrategy:me(new Cn(45,"foldingStrategy","auto",["auto","indentation"],{enumDescriptions:[u("foldingStrategy.auto","Use a language-specific folding strategy if available, else the indentation-based one."),u("foldingStrategy.indentation","Use the indentation-based folding strategy.")],description:u("foldingStrategy","Controls the strategy for computing folding ranges.")})),foldingHighlight:me(new li(46,"foldingHighlight",!0,{description:u("foldingHighlight","Controls whether the editor should highlight folded ranges.")})),foldingImportsByDefault:me(new li(47,"foldingImportsByDefault",!1,{description:u("foldingImportsByDefault","Controls whether the editor automatically collapses import ranges.")})),foldingMaximumRegions:me(new Ki(48,"foldingMaximumRegions",5e3,10,65e3,{description:u("foldingMaximumRegions","The maximum number of foldable regions. Increasing this value may result in the editor becoming less responsive when the current source has a large number of foldable regions.")})),unfoldOnClickAfterEndOfLine:me(new li(49,"unfoldOnClickAfterEndOfLine",!1,{description:u("unfoldOnClickAfterEndOfLine","Controls whether clicking on the empty content after a folded line will unfold the line.")})),fontFamily:me(new Vs(50,"fontFamily",vs.fontFamily,{description:u("fontFamily","Controls the font family.")})),fontInfo:me(new OK),fontLigatures2:me(new ou),fontSize:me(new NK),fontWeight:me(new FK),fontVariations:me(new lC),formatOnPaste:me(new li(56,"formatOnPaste",!1,{description:u("formatOnPaste","Controls whether the editor should automatically format the pasted content. A formatter must be available and the formatter should be able to format a range in a document.")})),formatOnType:me(new li(57,"formatOnType",!1,{description:u("formatOnType","Controls whether the editor should automatically format the line after typing.")})),glyphMargin:me(new li(58,"glyphMargin",!0,{description:u("glyphMargin","Controls whether the editor should render the vertical glyph margin. Glyph margin is mostly used for debugging.")})),gotoLocation:me(new BK),hideCursorInOverviewRuler:me(new li(60,"hideCursorInOverviewRuler",!1,{description:u("hideCursorInOverviewRuler","Controls whether the cursor should be hidden in the overview ruler.")})),hover:me(new VK),inDiffEditor:me(new li(62,"inDiffEditor",!1)),letterSpacing:me(new kl(65,"letterSpacing",vs.letterSpacing,r=>kl.clamp(r,-5,20),{description:u("letterSpacing","Controls the letter spacing in pixels.")})),lightbulb:me(new HK),lineDecorationsWidth:me(new KK),lineHeight:me(new GK),lineNumbers:me(new ZK),lineNumbersMinChars:me(new Ki(70,"lineNumbersMinChars",5,1,300)),linkedEditing:me(new li(71,"linkedEditing",!1,{description:u("linkedEditing","Controls whether the editor has linked editing enabled. Depending on the language, related symbols such as HTML tags, are updated while editing.")})),links:me(new li(72,"links",!0,{description:u("links","Controls whether the editor should detect links and make them clickable.")})),matchBrackets:me(new Cn(73,"matchBrackets","always",["always","near","never"],{description:u("matchBrackets","Highlight matching brackets.")})),minimap:me(new qK),mouseStyle:me(new Cn(75,"mouseStyle","text",["text","default","copy"])),mouseWheelScrollSensitivity:me(new kl(76,"mouseWheelScrollSensitivity",1,r=>r===0?1:r,{markdownDescription:u("mouseWheelScrollSensitivity","A multiplier to be used on the `deltaX` and `deltaY` of mouse wheel scroll events.")})),mouseWheelZoom:me(new li(77,"mouseWheelZoom",!1,{markdownDescription:ye?u("mouseWheelZoom.mac","Zoom the font of the editor when using mouse wheel and holding `Cmd`."):u("mouseWheelZoom","Zoom the font of the editor when using mouse wheel and holding `Ctrl`.")})),multiCursorMergeOverlapping:me(new li(78,"multiCursorMergeOverlapping",!0,{description:u("multiCursorMergeOverlapping","Merge multiple cursors when they are overlapping.")})),multiCursorModifier:me(new rC(79,"multiCursorModifier","altKey","alt",["ctrlCmd","alt"],Lve,{markdownEnumDescriptions:[u("multiCursorModifier.ctrlCmd","Maps to `Control` on Windows and Linux and to `Command` on macOS."),u("multiCursorModifier.alt","Maps to `Alt` on Windows and Linux and to `Option` on macOS.")],markdownDescription:u({key:"multiCursorModifier",comment:["- `ctrlCmd` refers to a value the setting can take and should not be localized.","- `Control` and `Command` refer to the modifier keys Ctrl or Cmd on the keyboard and can be localized."]},"The modifier to be used to add multiple cursors with the mouse. The Go to Definition and Open Link mouse gestures will adapt such that they do not conflict with the [multicursor modifier](https://code.visualstudio.com/docs/editor/codebasics#_multicursor-modifier).")})),multiCursorPaste:me(new Cn(80,"multiCursorPaste","spread",["spread","full"],{markdownEnumDescriptions:[u("multiCursorPaste.spread","Each cursor pastes a single line of the text."),u("multiCursorPaste.full","Each cursor pastes the full text.")],markdownDescription:u("multiCursorPaste","Controls pasting when the line count of the pasted text matches the cursor count.")})),multiCursorLimit:me(new Ki(81,"multiCursorLimit",1e4,1,1e5,{markdownDescription:u("multiCursorLimit","Controls the max number of cursors that can be in an active editor at once.")})),occurrencesHighlight:me(new Cn(82,"occurrencesHighlight","singleFile",["off","singleFile","multiFile"],{markdownEnumDescriptions:[u("occurrencesHighlight.off","Does not highlight occurrences."),u("occurrencesHighlight.singleFile","Highlights occurrences only in the current file."),u("occurrencesHighlight.multiFile","Experimental: Highlights occurrences across all valid open files.")],markdownDescription:u("occurrencesHighlight","Controls whether occurrences should be highlighted across open files.")})),overviewRulerBorder:me(new li(83,"overviewRulerBorder",!0,{description:u("overviewRulerBorder","Controls whether a border should be drawn around the overview ruler.")})),overviewRulerLanes:me(new Ki(84,"overviewRulerLanes",3,0,3)),padding:me(new $K),pasteAs:me(new hG),parameterHints:me(new jK),peekWidgetDefaultFocus:me(new Cn(88,"peekWidgetDefaultFocus","tree",["tree","editor"],{enumDescriptions:[u("peekWidgetDefaultFocus.tree","Focus the tree when opening peek"),u("peekWidgetDefaultFocus.editor","Focus the editor when opening peek")],description:u("peekWidgetDefaultFocus","Controls whether to focus the inline editor or the tree in the peek widget.")})),placeholder:me(new YK),definitionLinkOpensInPeek:me(new li(90,"definitionLinkOpensInPeek",!1,{description:u("definitionLinkOpensInPeek","Controls whether the Go to Definition mouse gesture always opens the peek widget.")})),quickSuggestions:me(new QK),quickSuggestionsDelay:me(new Ki(92,"quickSuggestionsDelay",10,0,1073741824,{description:u("quickSuggestionsDelay","Controls the delay in milliseconds after which quick suggestions will show up.")})),readOnly:me(new li(93,"readOnly",!1)),readOnlyMessage:me(new eG),renameOnType:me(new li(95,"renameOnType",!1,{description:u("renameOnType","Controls whether the editor auto renames on type."),markdownDeprecationMessage:u("renameOnTypeDeprecate","Deprecated, use `editor.linkedEditing` instead.")})),renderControlCharacters:me(new li(96,"renderControlCharacters",!0,{description:u("renderControlCharacters","Controls whether the editor should render control characters."),restricted:!0})),renderFinalNewline:me(new Cn(97,"renderFinalNewline",ci?"dimmed":"on",["off","on","dimmed"],{description:u("renderFinalNewline","Render last line number when the file ends with a newline.")})),renderLineHighlight:me(new Cn(98,"renderLineHighlight","line",["none","gutter","line","all"],{enumDescriptions:["","","",u("renderLineHighlight.all","Highlights both the gutter and the current line.")],description:u("renderLineHighlight","Controls how the editor should render the current line highlight.")})),renderLineHighlightOnlyWhenFocus:me(new li(99,"renderLineHighlightOnlyWhenFocus",!1,{description:u("renderLineHighlightOnlyWhenFocus","Controls if the editor should render the current line highlight only when the editor is focused.")})),renderValidationDecorations:me(new Cn(100,"renderValidationDecorations","editable",["editable","on","off"])),renderWhitespace:me(new Cn(101,"renderWhitespace","selection",["none","boundary","selection","trailing","all"],{enumDescriptions:["",u("renderWhitespace.boundary","Render whitespace characters except for single spaces between words."),u("renderWhitespace.selection","Render whitespace characters only on selected text."),u("renderWhitespace.trailing","Render only trailing whitespace characters."),""],description:u("renderWhitespace","Controls how the editor should render whitespace characters.")})),revealHorizontalRightPadding:me(new Ki(102,"revealHorizontalRightPadding",15,0,1e3)),roundedSelection:me(new li(103,"roundedSelection",!0,{description:u("roundedSelection","Controls whether selections should have rounded corners.")})),rulers:me(new JK),scrollbar:me(new tG),scrollBeyondLastColumn:me(new Ki(106,"scrollBeyondLastColumn",4,0,1073741824,{description:u("scrollBeyondLastColumn","Controls the number of extra characters beyond which the editor will scroll horizontally.")})),scrollBeyondLastLine:me(new li(107,"scrollBeyondLastLine",!0,{description:u("scrollBeyondLastLine","Controls whether the editor will scroll beyond the last line.")})),scrollPredominantAxis:me(new li(108,"scrollPredominantAxis",!0,{description:u("scrollPredominantAxis","Scroll only along the predominant axis when scrolling both vertically and horizontally at the same time. Prevents horizontal drift when scrolling vertically on a trackpad.")})),selectionClipboard:me(new li(109,"selectionClipboard",!0,{description:u("selectionClipboard","Controls whether the Linux primary clipboard should be supported."),included:ci})),selectionHighlight:me(new li(110,"selectionHighlight",!0,{description:u("selectionHighlight","Controls whether the editor should highlight matches similar to the selection.")})),selectOnLineNumbers:me(new li(111,"selectOnLineNumbers",!0)),showFoldingControls:me(new Cn(112,"showFoldingControls","mouseover",["always","never","mouseover"],{enumDescriptions:[u("showFoldingControls.always","Always show the folding controls."),u("showFoldingControls.never","Never show the folding controls and reduce the gutter size."),u("showFoldingControls.mouseover","Only show the folding controls when the mouse is over the gutter.")],description:u("showFoldingControls","Controls when the folding controls on the gutter are shown.")})),showUnused:me(new li(113,"showUnused",!0,{description:u("showUnused","Controls fading out of unused code.")})),showDeprecated:me(new li(142,"showDeprecated",!0,{description:u("showDeprecated","Controls strikethrough deprecated variables.")})),inlayHints:me(new zK),snippetSuggestions:me(new Cn(114,"snippetSuggestions","inline",["top","bottom","inline","none"],{enumDescriptions:[u("snippetSuggestions.top","Show snippet suggestions on top of other suggestions."),u("snippetSuggestions.bottom","Show snippet suggestions below other suggestions."),u("snippetSuggestions.inline","Show snippets suggestions with other suggestions."),u("snippetSuggestions.none","Do not show snippet suggestions.")],description:u("snippetSuggestions","Controls whether snippets are shown with other suggestions and how they are sorted.")})),smartSelect:me(new lG),smoothScrolling:me(new li(116,"smoothScrolling",!1,{description:u("smoothScrolling","Controls whether the editor will scroll using an animation.")})),stopRenderingLineAfter:me(new Ki(119,"stopRenderingLineAfter",1e4,-1,1073741824)),suggest:me(new aG),inlineSuggest:me(new nG),inlineEdit:me(new oG),inlineCompletionsAccessibilityVerbose:me(new li(151,"inlineCompletionsAccessibilityVerbose",!1,{description:u("inlineCompletionsAccessibilityVerbose","Controls whether the accessibility hint should be provided to screen reader users when an inline completion is shown.")})),suggestFontSize:me(new Ki(121,"suggestFontSize",0,0,1e3,{markdownDescription:u("suggestFontSize","Font size for the suggest widget. When set to {0}, the value of {1} is used.","`0`","`#editor.fontSize#`")})),suggestLineHeight:me(new Ki(122,"suggestLineHeight",0,0,1e3,{markdownDescription:u("suggestLineHeight","Line height for the suggest widget. When set to {0}, the value of {1} is used. The minimum value is 8.","`0`","`#editor.lineHeight#`")})),suggestOnTriggerCharacters:me(new li(123,"suggestOnTriggerCharacters",!0,{description:u("suggestOnTriggerCharacters","Controls whether suggestions should automatically show up when typing trigger characters.")})),suggestSelection:me(new Cn(124,"suggestSelection","first",["first","recentlyUsed","recentlyUsedByPrefix"],{markdownEnumDescriptions:[u("suggestSelection.first","Always select the first suggestion."),u("suggestSelection.recentlyUsed","Select recent suggestions unless further typing selects one, e.g. `console.| -> console.log` because `log` has been completed recently."),u("suggestSelection.recentlyUsedByPrefix","Select suggestions based on previous prefixes that have completed those suggestions, e.g. `co -> console` and `con -> const`.")],description:u("suggestSelection","Controls how suggestions are pre-selected when showing the suggest list.")})),tabCompletion:me(new Cn(125,"tabCompletion","off",["on","off","onlySnippets"],{enumDescriptions:[u("tabCompletion.on","Tab complete will insert the best matching suggestion when pressing tab."),u("tabCompletion.off","Disable tab completions."),u("tabCompletion.onlySnippets","Tab complete snippets when their prefix match. Works best when 'quickSuggestions' aren't enabled.")],description:u("tabCompletion","Enables tab completions.")})),tabIndex:me(new Ki(126,"tabIndex",0,-1,1073741824)),unicodeHighlight:me(new iG),unusualLineTerminators:me(new Cn(128,"unusualLineTerminators","prompt",["auto","off","prompt"],{enumDescriptions:[u("unusualLineTerminators.auto","Unusual line terminators are automatically removed."),u("unusualLineTerminators.off","Unusual line terminators are ignored."),u("unusualLineTerminators.prompt","Unusual line terminators prompt to be removed.")],description:u("unusualLineTerminators","Remove unusual line terminators that might cause problems.")})),useShadowDOM:me(new li(129,"useShadowDOM",!0)),useTabStops:me(new li(130,"useTabStops",!0,{description:u("useTabStops","Spaces and tabs are inserted and deleted in alignment with tab stops.")})),wordBreak:me(new Cn(131,"wordBreak","normal",["normal","keepAll"],{markdownEnumDescriptions:[u("wordBreak.normal","Use the default line break rule."),u("wordBreak.keepAll","Word breaks should not be used for Chinese/Japanese/Korean (CJK) text. Non-CJK text behavior is the same as for normal.")],description:u("wordBreak","Controls the word break rules used for Chinese/Japanese/Korean (CJK) text.")})),wordSegmenterLocales:me(new dG),wordSeparators:me(new Vs(133,"wordSeparators",yK,{description:u("wordSeparators","Characters that will be used as word separators when doing word related navigations or operations.")})),wordWrap:me(new Cn(134,"wordWrap","off",["off","on","wordWrapColumn","bounded"],{markdownEnumDescriptions:[u("wordWrap.off","Lines will never wrap."),u("wordWrap.on","Lines will wrap at the viewport width."),u({key:"wordWrap.wordWrapColumn",comment:["- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Lines will wrap at `#editor.wordWrapColumn#`."),u({key:"wordWrap.bounded",comment:["- viewport means the edge of the visible window size.","- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Lines will wrap at the minimum of viewport and `#editor.wordWrapColumn#`.")],description:u({key:"wordWrap",comment:["- 'off', 'on', 'wordWrapColumn' and 'bounded' refer to values the setting can take and should not be localized.","- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Controls how lines should wrap.")})),wordWrapBreakAfterCharacters:me(new Vs(135,"wordWrapBreakAfterCharacters"," 	})]?|/&.,;\xA2\xB0\u2032\u2033\u2030\u2103\u3001\u3002\uFF61\uFF64\uFFE0\uFF0C\uFF0E\uFF1A\uFF1B\uFF1F\uFF01\uFF05\u30FB\uFF65\u309D\u309E\u30FD\u30FE\u30FC\u30A1\u30A3\u30A5\u30A7\u30A9\u30C3\u30E3\u30E5\u30E7\u30EE\u30F5\u30F6\u3041\u3043\u3045\u3047\u3049\u3063\u3083\u3085\u3087\u308E\u3095\u3096\u31F0\u31F1\u31F2\u31F3\u31F4\u31F5\u31F6\u31F7\u31F8\u31F9\u31FA\u31FB\u31FC\u31FD\u31FE\u31FF\u3005\u303B\uFF67\uFF68\uFF69\uFF6A\uFF6B\uFF6C\uFF6D\uFF6E\uFF6F\uFF70\u201D\u3009\u300B\u300D\u300F\u3011\u3015\uFF09\uFF3D\uFF5D\uFF63")),wordWrapBreakBeforeCharacters:me(new Vs(136,"wordWrapBreakBeforeCharacters","([{\u2018\u201C\u3008\u300A\u300C\u300E\u3010\u3014\uFF08\uFF3B\uFF5B\uFF62\xA3\xA5\uFF04\uFFE1\uFFE5+\uFF0B")),wordWrapColumn:me(new Ki(137,"wordWrapColumn",80,1,1073741824,{markdownDescription:u({key:"wordWrapColumn",comment:["- `editor.wordWrap` refers to a different setting and should not be localized.","- 'wordWrapColumn' and 'bounded' refer to values the different setting can take and should not be localized."]},"Controls the wrapping column of the editor when `#editor.wordWrap#` is `wordWrapColumn` or `bounded`.")})),wordWrapOverride1:me(new Cn(138,"wordWrapOverride1","inherit",["off","on","inherit"])),wordWrapOverride2:me(new Cn(139,"wordWrapOverride2","inherit",["off","on","inherit"])),editorClassName:me(new PK),defaultColorDecorators:me(new li(149,"defaultColorDecorators",!1,{markdownDescription:u("defaultColorDecorators","Controls whether inline color decorations should be shown using the default document color provider")})),pixelRatio:me(new XK),tabFocusMode:me(new li(146,"tabFocusMode",!1,{markdownDescription:u("tabFocusMode","Controls whether the editor receives tabs or defers them to the workbench for navigation.")})),layoutInfo:me(new LD),wrappingInfo:me(new uG),wrappingIndent:me(new cG),wrappingStrategy:me(new WK)};var Pp=new class{_zoomLevel=0;_onDidChangeZoomLevel=new x;onDidChangeZoomLevel=this._onDidChangeZoomLevel.event;getZoomLevel(){return this._zoomLevel}setZoomLevel(r){r=Math.min(Math.max(-5,r),20),this._zoomLevel!==r&&(this._zoomLevel=r,this._onDidChangeZoomLevel.fire(this._zoomLevel))}};var Ave=ye?1.5:1.35,mG=8,Mp=class r{_bareFontInfoBrand=void 0;static createFromValidatedSettings(t,e,i){let n=t.get(50),o=t.get(54),s=t.get(53),a=t.get(52),l=t.get(55),d=t.get(68),c=t.get(65);return r._create(n,o,s,a,l,d,c,e,i)}static createFromRawSettings(t,e,i=!1){let n=uc.fontFamily.validate(t.fontFamily),o=uc.fontWeight.validate(t.fontWeight),s=uc.fontSize.validate(t.fontSize),a=uc.fontLigatures2.validate(t.fontLigatures),l=uc.fontVariations.validate(t.fontVariations),d=uc.lineHeight.validate(t.lineHeight),c=uc.letterSpacing.validate(t.letterSpacing);return r._create(n,o,s,a,l,d,c,e,i)}static _create(t,e,i,n,o,s,a,l,d){s===0?s=Ave*i:s<mG&&(s=s*i),s=Math.round(s),s<mG&&(s=mG);let c=1+(d?0:Pp.getZoomLevel()*.1);return i*=c,s*=c,o===lC.TRANSLATE&&(e==="normal"||e==="bold"?o=lC.OFF:(o=`'wght' ${parseInt(e,10)}`,e="normal")),new r({pixelRatio:l,fontFamily:t,fontWeight:e,fontSize:i,fontFeatureSettings:n,fontVariationSettings:o,lineHeight:s,letterSpacing:a})}pixelRatio;fontFamily;fontWeight;fontSize;fontFeatureSettings;fontVariationSettings;lineHeight;letterSpacing;constructor(t){this.pixelRatio=t.pixelRatio,this.fontFamily=String(t.fontFamily),this.fontWeight=String(t.fontWeight),this.fontSize=t.fontSize,this.fontFeatureSettings=t.fontFeatureSettings,this.fontVariationSettings=t.fontVariationSettings,this.lineHeight=t.lineHeight|0,this.letterSpacing=t.letterSpacing}getId(){return`${this.pixelRatio}-${this.fontFamily}-${this.fontWeight}-${this.fontSize}-${this.fontFeatureSettings}-${this.fontVariationSettings}-${this.lineHeight}-${this.letterSpacing}`}getMassagedFontFamily(){let t=vs.fontFamily,e=r._wrapInQuotes(this.fontFamily);return t&&this.fontFamily!==t?`${e}, ${t}`:e}static _wrapInQuotes(t){return/[,"']/.test(t)?t:/[+ ]/.test(t)?`"${t}"`:t}},gG=2,cC=class extends Mp{_editorStylingBrand=void 0;version=gG;isTrusted;isMonospace;typicalHalfwidthCharacterWidth;typicalFullwidthCharacterWidth;canUseHalfwidthRightwardsArrow;spaceWidth;middotWidth;wsmiddotWidth;maxDigitWidth;constructor(t,e){super(t),this.isTrusted=e,this.isMonospace=t.isMonospace,this.typicalHalfwidthCharacterWidth=t.typicalHalfwidthCharacterWidth,this.typicalFullwidthCharacterWidth=t.typicalFullwidthCharacterWidth,this.canUseHalfwidthRightwardsArrow=t.canUseHalfwidthRightwardsArrow,this.spaceWidth=t.spaceWidth,this.middotWidth=t.middotWidth,this.wsmiddotWidth=t.wsmiddotWidth,this.maxDigitWidth=t.maxDigitWidth}equals(t){return this.fontFamily===t.fontFamily&&this.fontWeight===t.fontWeight&&this.fontSize===t.fontSize&&this.fontFeatureSettings===t.fontFeatureSettings&&this.fontVariationSettings===t.fontVariationSettings&&this.lineHeight===t.lineHeight&&this.letterSpacing===t.letterSpacing&&this.typicalHalfwidthCharacterWidth===t.typicalHalfwidthCharacterWidth&&this.typicalFullwidthCharacterWidth===t.typicalFullwidthCharacterWidth&&this.canUseHalfwidthRightwardsArrow===t.canUseHalfwidthRightwardsArrow&&this.spaceWidth===t.spaceWidth&&this.middotWidth===t.middotWidth&&this.wsmiddotWidth===t.wsmiddotWidth&&this.maxDigitWidth===t.maxDigitWidth}};function hn(r,t){r instanceof tI?(r.setFontFamily(t.getMassagedFontFamily()),r.setFontWeight(t.fontWeight),r.setFontSize(t.fontSize),r.setFontFeatureSettings(t.fontFeatureSettings),r.setFontVariationSettings(t.fontVariationSettings),r.setLineHeight(t.lineHeight),r.setLetterSpacing(t.letterSpacing)):(r.style.fontFamily=t.getMassagedFontFamily(),r.style.fontWeight=t.fontWeight,r.style.fontSize=t.fontSize+"px",r.style.fontFeatureSettings=t.fontFeatureSettings,r.style.fontVariationSettings=t.fontVariationSettings,r.style.lineHeight=t.lineHeight+"px",r.style.letterSpacing=t.letterSpacing+"px")}var bO=class{chr;type;width;constructor(t,e){this.chr=t,this.type=e,this.width=0}fulfill(t){this.width=t}},fG=class r{_bareFontInfo;_requests;_container;_testElements;constructor(t,e){this._bareFontInfo=t,this._requests=e,this._container=null,this._testElements=null}read(t){this._createDomElements(),t.document.body.appendChild(this._container),this._readFromDomElements(),this._container?.remove(),this._container=null,this._testElements=null}_createDomElements(){let t=document.createElement("div");t.style.position="absolute",t.style.top="-50000px",t.style.width="50000px";let e=document.createElement("div");hn(e,this._bareFontInfo),t.appendChild(e);let i=document.createElement("div");hn(i,this._bareFontInfo),i.style.fontWeight="bold",t.appendChild(i);let n=document.createElement("div");hn(n,this._bareFontInfo),n.style.fontStyle="italic",t.appendChild(n);let o=[];for(let s of this._requests){let a;s.type===0&&(a=e),s.type===2&&(a=i),s.type===1&&(a=n),a.appendChild(document.createElement("br"));let l=document.createElement("span");r._render(l,s),a.appendChild(l),o.push(l)}this._container=t,this._testElements=o}static _render(t,e){if(e.chr===" "){let i="\xA0";for(let n=0;n<8;n++)i+=i;t.innerText=i}else{let i=e.chr;for(let n=0;n<8;n++)i+=i;t.textContent=i}}_readFromDomElements(){for(let t=0,e=this._requests.length;t<e;t++){let i=this._requests[t],n=this._testElements[t];i.fulfill(n.offsetWidth/256)}}};function lie(r,t,e){new fG(t,e).read(r)}var bG=class extends R{_cache=new Map;_evictUntrustedReadingsTimeout=-1;_onDidChange=this._register(new x);onDidChange=this._onDidChange.event;dispose(){this._evictUntrustedReadingsTimeout!==-1&&(clearTimeout(this._evictUntrustedReadingsTimeout),this._evictUntrustedReadingsTimeout=-1),super.dispose()}clearAllFontInfos(){this._cache.clear(),this._onDidChange.fire()}_ensureCache(t){let e=_p(t),i=this._cache.get(e);return i||(i=new vG,this._cache.set(e,i)),i}_writeToCache(t,e,i){this._ensureCache(t).put(e,i),!i.isTrusted&&this._evictUntrustedReadingsTimeout===-1&&(this._evictUntrustedReadingsTimeout=t.setTimeout(()=>{this._evictUntrustedReadingsTimeout=-1,this._evictUntrustedReadings(t)},5e3))}_evictUntrustedReadings(t){let e=this._ensureCache(t),i=e.getValues(),n=!1;for(let o of i)o.isTrusted||(n=!0,e.remove(o));n&&this._onDidChange.fire()}serializeFontInfo(t){return this._ensureCache(t).getValues().filter(i=>i.isTrusted)}restoreFontInfo(t,e){for(let i of e){if(i.version!==gG)continue;let n=new cC(i,!1);this._writeToCache(t,n,n)}}readFontInfo(t,e){let i=this._ensureCache(t);if(!i.has(e)){let n=this._actualReadFontInfo(t,e);(n.typicalHalfwidthCharacterWidth<=2||n.typicalFullwidthCharacterWidth<=2||n.spaceWidth<=2||n.maxDigitWidth<=2)&&(n=new cC({pixelRatio:Zs.getInstance(t).value,fontFamily:n.fontFamily,fontWeight:n.fontWeight,fontSize:n.fontSize,fontFeatureSettings:n.fontFeatureSettings,fontVariationSettings:n.fontVariationSettings,lineHeight:n.lineHeight,letterSpacing:n.letterSpacing,isMonospace:n.isMonospace,typicalHalfwidthCharacterWidth:Math.max(n.typicalHalfwidthCharacterWidth,5),typicalFullwidthCharacterWidth:Math.max(n.typicalFullwidthCharacterWidth,5),canUseHalfwidthRightwardsArrow:n.canUseHalfwidthRightwardsArrow,spaceWidth:Math.max(n.spaceWidth,5),middotWidth:Math.max(n.middotWidth,5),wsmiddotWidth:Math.max(n.wsmiddotWidth,5),maxDigitWidth:Math.max(n.maxDigitWidth,5)},!1)),this._writeToCache(t,e,n)}return i.get(e)}_createRequest(t,e,i,n){let o=new bO(t,e);return i.push(o),n?.push(o),o}_actualReadFontInfo(t,e){let i=[],n=[],o=this._createRequest("n",0,i,n),s=this._createRequest("\uFF4D",0,i,null),a=this._createRequest(" ",0,i,n),l=this._createRequest("0",0,i,n),d=this._createRequest("1",0,i,n),c=this._createRequest("2",0,i,n),p=this._createRequest("3",0,i,n),h=this._createRequest("4",0,i,n),m=this._createRequest("5",0,i,n),f=this._createRequest("6",0,i,n),g=this._createRequest("7",0,i,n),v=this._createRequest("8",0,i,n),I=this._createRequest("9",0,i,n),y=this._createRequest("\u2192",0,i,n),w=this._createRequest("\uFFEB",0,i,null),C=this._createRequest("\xB7",0,i,n),S=this._createRequest("\u2E31",0,i,null),D="|/-_ilm%";for(let G=0,Y=D.length;G<Y;G++)this._createRequest(D.charAt(G),0,i,n),this._createRequest(D.charAt(G),1,i,n),this._createRequest(D.charAt(G),2,i,n);lie(t,e,i);let k=Math.max(l.width,d.width,c.width,p.width,h.width,m.width,f.width,g.width,v.width,I.width),M=e.fontFeatureSettings===ou.OFF,O=n[0].width;for(let G=1,Y=n.length;M&&G<Y;G++){let ge=O-n[G].width;if(ge<-.001||ge>.001){M=!1;break}}let K=!0;return M&&w.width!==O&&(K=!1),w.width>y.width&&(K=!1),new cC({pixelRatio:Zs.getInstance(t).value,fontFamily:e.fontFamily,fontWeight:e.fontWeight,fontSize:e.fontSize,fontFeatureSettings:e.fontFeatureSettings,fontVariationSettings:e.fontVariationSettings,lineHeight:e.lineHeight,letterSpacing:e.letterSpacing,isMonospace:M,typicalHalfwidthCharacterWidth:o.width,typicalFullwidthCharacterWidth:s.width,canUseHalfwidthRightwardsArrow:K,spaceWidth:a.width,middotWidth:C.width,wsmiddotWidth:S.width,maxDigitWidth:k},!0)}},vG=class{_keys;_values;constructor(){this._keys=Object.create(null),this._values=Object.create(null)}has(t){let e=t.getId();return!!this._values[e]}get(t){let e=t.getId();return this._values[e]}put(t,e){let i=t.getId();this._keys[i]=t,this._values[i]=e}remove(t){let e=t.getId();delete this._keys[e],delete this._values[e]}getValues(){return Object.keys(this._keys).map(t=>this._values[t])}},RD=new bG;var PD=class r{constructor(t,e){this.key=t;this.migrate=e}static items=[];apply(t){let e=r._read(t,this.key),i=o=>r._read(t,o),n=(o,s)=>r._write(t,o,s);this.migrate(e,i,n)}static _read(t,e){if(typeof t>"u")return;let i=e.indexOf(".");if(i>=0){let n=e.substring(0,i);return this._read(t[n],e.substring(i+1))}return t[e]}static _write(t,e,i){let n=e.indexOf(".");if(n>=0){let o=e.substring(0,n);t[o]=t[o]||{},this._write(t[o],e.substring(n+1),i);return}t[e]=i}};function su(r,t){PD.items.push(new PD(r,t))}function il(r,t){su(r,(e,i,n)=>{if(typeof e<"u"){for(let[o,s]of t)if(e===o){n(r,s);return}}})}function die(r){PD.items.forEach(t=>t.apply(r))}il("wordWrap",[[!0,"on"],[!1,"off"]]);il("lineNumbers",[[!0,"on"],[!1,"off"]]);il("cursorBlinking",[["visible","solid"]]);il("renderWhitespace",[[!0,"boundary"],[!1,"none"]]);il("renderLineHighlight",[[!0,"line"],[!1,"none"]]);il("acceptSuggestionOnEnter",[[!0,"on"],[!1,"off"]]);il("tabCompletion",[[!1,"off"],[!0,"onlySnippets"]]);il("hover",[[!0,{enabled:!0}],[!1,{enabled:!1}]]);il("parameterHints",[[!0,{enabled:!0}],[!1,{enabled:!1}]]);il("autoIndent",[[!1,"advanced"],[!0,"full"]]);il("matchBrackets",[[!0,"always"],[!1,"never"]]);il("renderFinalNewline",[[!0,"on"],[!1,"off"]]);il("cursorSmoothCaretAnimation",[[!0,"on"],[!1,"off"]]);il("occurrencesHighlight",[[!0,"singleFile"],[!1,"off"]]);il("wordBasedSuggestions",[[!0,"matchingDocuments"],[!1,"off"]]);su("autoClosingBrackets",(r,t,e)=>{r===!1&&(e("autoClosingBrackets","never"),typeof t("autoClosingQuotes")>"u"&&e("autoClosingQuotes","never"),typeof t("autoSurround")>"u"&&e("autoSurround","never"))});su("renderIndentGuides",(r,t,e)=>{typeof r<"u"&&(e("renderIndentGuides",void 0),typeof t("guides.indentation")>"u"&&e("guides.indentation",!!r))});su("highlightActiveIndentGuide",(r,t,e)=>{typeof r<"u"&&(e("highlightActiveIndentGuide",void 0),typeof t("guides.highlightActiveIndentation")>"u"&&e("guides.highlightActiveIndentation",!!r))});var Ove={method:"showMethods",function:"showFunctions",constructor:"showConstructors",deprecated:"showDeprecated",field:"showFields",variable:"showVariables",class:"showClasses",struct:"showStructs",interface:"showInterfaces",module:"showModules",property:"showProperties",event:"showEvents",operator:"showOperators",unit:"showUnits",value:"showValues",constant:"showConstants",enum:"showEnums",enumMember:"showEnumMembers",keyword:"showKeywords",text:"showWords",color:"showColors",file:"showFiles",reference:"showReferences",folder:"showFolders",typeParameter:"showTypeParameters",snippet:"showSnippets"};su("suggest.filteredTypes",(r,t,e)=>{if(r&&typeof r=="object"){for(let i of Object.entries(Ove))r[i[0]]===!1&&typeof t(`suggest.${i[1]}`)>"u"&&e(`suggest.${i[1]}`,!1);e("suggest.filteredTypes",void 0)}});su("quickSuggestions",(r,t,e)=>{if(typeof r=="boolean"){let i=r?"on":"off";e("quickSuggestions",{comments:i,strings:i,other:i})}});su("experimental.stickyScroll.enabled",(r,t,e)=>{typeof r=="boolean"&&(e("experimental.stickyScroll.enabled",void 0),typeof t("stickyScroll.enabled")>"u"&&e("stickyScroll.enabled",r))});su("experimental.stickyScroll.maxLineCount",(r,t,e)=>{typeof r=="number"&&(e("experimental.stickyScroll.maxLineCount",void 0),typeof t("stickyScroll.maxLineCount")>"u"&&e("stickyScroll.maxLineCount",r))});su("codeActionsOnSave",(r,t,e)=>{if(r&&typeof r=="object"){let i=!1,n={};for(let o of Object.entries(r))typeof o[1]=="boolean"?(i=!0,n[o[0]]=o[1]?"explicit":"never"):n[o[0]]=o[1];i&&e("codeActionsOnSave",n)}});su("codeActionWidget.includeNearbyQuickfixes",(r,t,e)=>{typeof r=="boolean"&&(e("codeActionWidget.includeNearbyQuickfixes",void 0),typeof t("codeActionWidget.includeNearbyQuickFixes")>"u"&&e("codeActionWidget.includeNearbyQuickFixes",r))});su("lightbulb.enabled",(r,t,e)=>{typeof r=="boolean"&&e("lightbulb.enabled",r?void 0:"off")});var IG=class{_tabFocus=!1;_onDidChangeTabFocus=new x;onDidChangeTabFocus=this._onDidChangeTabFocus.event;getTabFocusMode(){return this._tabFocus}setTabFocusMode(t){this._tabFocus=t,this._onDidChangeTabFocus.fire(this._tabFocus)}},uC=new IG;var et=class extends R{_onDidChange=this._register(new x);onDidChange=this._onDidChange.event;_id;_label;_tooltip;_cssClass;_enabled=!0;_checked;_actionCallback;constructor(t,e="",i="",n=!0,o){super(),this._id=t,this._label=e,this._cssClass=i,this._enabled=n,this._actionCallback=o}get id(){return this._id}get label(){return this._label}set label(t){this._setLabel(t)}_setLabel(t){this._label!==t&&(this._label=t,this._onDidChange.fire({label:t}))}get tooltip(){return this._tooltip||""}set tooltip(t){this._setTooltip(t)}_setTooltip(t){this._tooltip!==t&&(this._tooltip=t,this._onDidChange.fire({tooltip:t}))}get class(){return this._cssClass}set class(t){this._setClass(t)}_setClass(t){this._cssClass!==t&&(this._cssClass=t,this._onDidChange.fire({class:t}))}get enabled(){return this._enabled}set enabled(t){this._setEnabled(t)}_setEnabled(t){this._enabled!==t&&(this._enabled=t,this._onDidChange.fire({enabled:t}))}get checked(){return this._checked}set checked(t){this._setChecked(t)}_setChecked(t){this._checked!==t&&(this._checked=t,this._onDidChange.fire({checked:t}))}async run(t,e){this._actionCallback&&await this._actionCallback(t)}},jo=class extends R{_onWillRun=this._register(new x);onWillRun=this._onWillRun.event;_onDidRun=this._register(new x);onDidRun=this._onDidRun.event;async run(t,e){if(!t.enabled)return;this._onWillRun.fire({action:t});let i;try{await this.runAction(t,e)}catch(n){i=n}this._onDidRun.fire({action:t,error:i})}async runAction(t,e){await t.run(e)}},Qt=class r{static join(...t){let e=[];for(let i of t)i.length&&(e.length?e=[...e,new r,...i]:e=i);return e}static ID="vs.actions.separator";id=r.ID;label="";tooltip="";class="separator";enabled=!1;checked=!1;async run(){}},vo=class{id;label;class;tooltip="";enabled=!0;checked=void 0;_actions;get actions(){return this._actions}constructor(t,e,i,n){this.id=t,this.label=e,this.class=n,this._actions=i}async run(){}},vO=class r extends et{static ID="vs.actions.empty";constructor(){super(r.ID,u("submenu.empty","(empty)"),void 0,!1)}};function fn(r){return{id:r.id,label:r.label,tooltip:r.tooltip??r.label,class:r.class,enabled:r.enabled??!0,checked:r.checked,run:async(...t)=>r.run(...t)}}var $t=Object.freeze({View:ie("view","View"),Help:ie("help","Help"),Test:ie("test","Test"),File:ie("file","File"),Preferences:ie("preferences","Preferences"),Developer:ie({key:"developer",comment:["A developer on Code itself or someone diagnosing issues in Code"]},"Developer")});var ct=q("commandService"),tt=new class{_commands=new Map;_onDidRegisterCommand=new x;onDidRegisterCommand=this._onDidRegisterCommand.event;registerCommand(r,t){if(!r)throw new Error("invalid command");if(typeof r=="string"){if(!t)throw new Error("invalid command");return this.registerCommand({id:r,handler:t})}if(r.metadata&&Array.isArray(r.metadata.args)){let s=[];for(let l of r.metadata.args)s.push(l.constraint);let a=r.handler;r.handler=function(l,...d){return xee(d,s),a(l,...d)}}let{id:e}=r,i=this._commands.get(e);i||(i=new lr,this._commands.set(e,i));let n=i.unshift(r),o=le(()=>{n(),this._commands.get(e)?.isEmpty()&&this._commands.delete(e)});return this._onDidRegisterCommand.fire(e),o}registerCommandAlias(r,t){return tt.registerCommand(r,(e,...i)=>e.get(ct).executeCommand(t,...i))}getCommand(r){let t=this._commands.get(r);if(!(!t||t.isEmpty()))return mt.first(t)}getCommands(){let r=new Map;for(let t of this._commands.keys()){let e=this.getCommand(t);e&&r.set(t,e)}return r}};tt.registerCommand("noop",()=>{});function IO(r){return r?r.condition!==void 0:!1}var yG=class r{_coreKeybindings;_extensionKeybindings;_cachedMergedKeybindings;constructor(){this._coreKeybindings=new lr,this._extensionKeybindings=[],this._cachedMergedKeybindings=null}static bindToCurrentPlatform(t){if(Ys===1){if(t&&t.win)return t.win}else if(Ys===2){if(t&&t.mac)return t.mac}else if(t&&t.linux)return t.linux;return t}registerKeybindingRule(t){let e=r.bindToCurrentPlatform(t),i=new B;if(e&&e.primary){let n=x4(e.primary,Ys);n&&i.add(this._registerDefaultKeybinding(n,t.id,t.args,t.weight,0,t.when))}if(e&&Array.isArray(e.secondary))for(let n=0,o=e.secondary.length;n<o;n++){let s=e.secondary[n],a=x4(s,Ys);a&&i.add(this._registerDefaultKeybinding(a,t.id,t.args,t.weight,-n-1,t.when))}return i}setExtensionKeybindings(t){let e=[],i=0;for(let n of t)n.keybinding&&(e[i++]={keybinding:n.keybinding,command:n.id,commandArgs:n.args,when:n.when,weight1:n.weight,weight2:0,extensionId:n.extensionId||null,isBuiltinExtension:n.isBuiltinExtension||!1});this._extensionKeybindings=e,this._cachedMergedKeybindings=null}registerCommandAndKeybindingRule(t){return In(this.registerKeybindingRule(t),tt.registerCommand(t))}_registerDefaultKeybinding(t,e,i,n,o,s){let a=this._coreKeybindings.push({keybinding:t,command:e,commandArgs:i,when:s,weight1:n,weight2:o,extensionId:null,isBuiltinExtension:!1});return this._cachedMergedKeybindings=null,le(()=>{a(),this._cachedMergedKeybindings=null})}getDefaultKeybindings(){return this._cachedMergedKeybindings||(this._cachedMergedKeybindings=Array.from(this._coreKeybindings).concat(this._extensionKeybindings),this._cachedMergedKeybindings.sort(Fve)),this._cachedMergedKeybindings.slice(0)}},wt=new yG,Nve={EditorModes:"platform.keybindingsRegistry"};Pe.add(Nve.EditorModes,wt);function Fve(r,t){if(r.weight1!==t.weight1)return r.weight1-t.weight1;if(r.command&&t.command){if(r.command<t.command)return-1;if(r.command>t.command)return 1}return r.weight2-t.weight2}function yf(r){return r.command!==void 0}function cie(r){return r.submenu!==void 0}var V=class r{static _instances=new Map;static CommandPalette=new r("CommandPalette");static DebugBreakpointsContext=new r("DebugBreakpointsContext");static DebugCallStackContext=new r("DebugCallStackContext");static DebugConsoleContext=new r("DebugConsoleContext");static DebugVariablesContext=new r("DebugVariablesContext");static NotebookVariablesContext=new r("NotebookVariablesContext");static DebugHoverContext=new r("DebugHoverContext");static DebugWatchContext=new r("DebugWatchContext");static DebugToolBar=new r("DebugToolBar");static DebugToolBarStop=new r("DebugToolBarStop");static DebugCallStackToolbar=new r("DebugCallStackToolbar");static DebugCreateConfiguration=new r("DebugCreateConfiguration");static EditorContext=new r("EditorContext");static SimpleEditorContext=new r("SimpleEditorContext");static EditorContent=new r("EditorContent");static EditorLineNumberContext=new r("EditorLineNumberContext");static EditorContextCopy=new r("EditorContextCopy");static EditorContextPeek=new r("EditorContextPeek");static EditorContextShare=new r("EditorContextShare");static EditorTitle=new r("EditorTitle");static EditorTitleRun=new r("EditorTitleRun");static EditorTitleContext=new r("EditorTitleContext");static EditorTitleContextShare=new r("EditorTitleContextShare");static EmptyEditorGroup=new r("EmptyEditorGroup");static EmptyEditorGroupContext=new r("EmptyEditorGroupContext");static EditorTabsBarContext=new r("EditorTabsBarContext");static EditorTabsBarShowTabsSubmenu=new r("EditorTabsBarShowTabsSubmenu");static EditorTabsBarShowTabsZenModeSubmenu=new r("EditorTabsBarShowTabsZenModeSubmenu");static EditorActionsPositionSubmenu=new r("EditorActionsPositionSubmenu");static ExplorerContext=new r("ExplorerContext");static ExplorerContextShare=new r("ExplorerContextShare");static ExtensionContext=new r("ExtensionContext");static ExtensionEditorContextMenu=new r("ExtensionEditorContextMenu");static GlobalActivity=new r("GlobalActivity");static CommandCenter=new r("CommandCenter");static CommandCenterCenter=new r("CommandCenterCenter");static LayoutControlMenuSubmenu=new r("LayoutControlMenuSubmenu");static LayoutControlMenu=new r("LayoutControlMenu");static MenubarMainMenu=new r("MenubarMainMenu");static MenubarAppearanceMenu=new r("MenubarAppearanceMenu");static MenubarDebugMenu=new r("MenubarDebugMenu");static MenubarEditMenu=new r("MenubarEditMenu");static MenubarCopy=new r("MenubarCopy");static MenubarFileMenu=new r("MenubarFileMenu");static MenubarGoMenu=new r("MenubarGoMenu");static MenubarHelpMenu=new r("MenubarHelpMenu");static MenubarLayoutMenu=new r("MenubarLayoutMenu");static MenubarNewBreakpointMenu=new r("MenubarNewBreakpointMenu");static PanelAlignmentMenu=new r("PanelAlignmentMenu");static PanelPositionMenu=new r("PanelPositionMenu");static ActivityBarPositionMenu=new r("ActivityBarPositionMenu");static MenubarPreferencesMenu=new r("MenubarPreferencesMenu");static MenubarRecentMenu=new r("MenubarRecentMenu");static MenubarSelectionMenu=new r("MenubarSelectionMenu");static MenubarShare=new r("MenubarShare");static MenubarSwitchEditorMenu=new r("MenubarSwitchEditorMenu");static MenubarSwitchGroupMenu=new r("MenubarSwitchGroupMenu");static MenubarTerminalMenu=new r("MenubarTerminalMenu");static MenubarViewMenu=new r("MenubarViewMenu");static MenubarHomeMenu=new r("MenubarHomeMenu");static OpenEditorsContext=new r("OpenEditorsContext");static OpenEditorsContextShare=new r("OpenEditorsContextShare");static ProblemsPanelContext=new r("ProblemsPanelContext");static SCMInputBox=new r("SCMInputBox");static SCMChangesContext=new r("SCMChangesContext");static SCMChangeContext=new r("SCMChangeContext");static SCMResourceContext=new r("SCMResourceContext");static SCMResourceContextShare=new r("SCMResourceContextShare");static SCMResourceFolderContext=new r("SCMResourceFolderContext");static SCMResourceGroupContext=new r("SCMResourceGroupContext");static SCMSourceControl=new r("SCMSourceControl");static SCMSourceControlInline=new r("SCMSourceControlInline");static SCMSourceControlTitle=new r("SCMSourceControlTitle");static SCMHistoryTitle=new r("SCMHistoryTitle");static SCMTitle=new r("SCMTitle");static SearchContext=new r("SearchContext");static SearchActionMenu=new r("SearchActionContext");static StatusBarWindowIndicatorMenu=new r("StatusBarWindowIndicatorMenu");static StatusBarRemoteIndicatorMenu=new r("StatusBarRemoteIndicatorMenu");static StickyScrollContext=new r("StickyScrollContext");static TestItem=new r("TestItem");static TestItemGutter=new r("TestItemGutter");static TestProfilesContext=new r("TestProfilesContext");static TestMessageContext=new r("TestMessageContext");static TestMessageContent=new r("TestMessageContent");static TestPeekElement=new r("TestPeekElement");static TestPeekTitle=new r("TestPeekTitle");static TestCallStack=new r("TestCallStack");static TouchBarContext=new r("TouchBarContext");static TitleBarContext=new r("TitleBarContext");static TitleBarTitleContext=new r("TitleBarTitleContext");static TunnelContext=new r("TunnelContext");static TunnelPrivacy=new r("TunnelPrivacy");static TunnelProtocol=new r("TunnelProtocol");static TunnelPortInline=new r("TunnelInline");static TunnelTitle=new r("TunnelTitle");static TunnelLocalAddressInline=new r("TunnelLocalAddressInline");static TunnelOriginInline=new r("TunnelOriginInline");static ViewItemContext=new r("ViewItemContext");static ViewContainerTitle=new r("ViewContainerTitle");static ViewContainerTitleContext=new r("ViewContainerTitleContext");static ViewTitle=new r("ViewTitle");static ViewTitleContext=new r("ViewTitleContext");static CommentEditorActions=new r("CommentEditorActions");static CommentThreadTitle=new r("CommentThreadTitle");static CommentThreadActions=new r("CommentThreadActions");static CommentThreadAdditionalActions=new r("CommentThreadAdditionalActions");static CommentThreadTitleContext=new r("CommentThreadTitleContext");static CommentThreadCommentContext=new r("CommentThreadCommentContext");static CommentTitle=new r("CommentTitle");static CommentActions=new r("CommentActions");static CommentsViewThreadActions=new r("CommentsViewThreadActions");static InteractiveToolbar=new r("InteractiveToolbar");static InteractiveCellTitle=new r("InteractiveCellTitle");static InteractiveCellDelete=new r("InteractiveCellDelete");static InteractiveCellExecute=new r("InteractiveCellExecute");static InteractiveInputExecute=new r("InteractiveInputExecute");static InteractiveInputConfig=new r("InteractiveInputConfig");static ReplInputExecute=new r("ReplInputExecute");static IssueReporter=new r("IssueReporter");static NotebookToolbar=new r("NotebookToolbar");static NotebookStickyScrollContext=new r("NotebookStickyScrollContext");static NotebookCellTitle=new r("NotebookCellTitle");static NotebookCellDelete=new r("NotebookCellDelete");static NotebookCellInsert=new r("NotebookCellInsert");static NotebookCellBetween=new r("NotebookCellBetween");static NotebookCellListTop=new r("NotebookCellTop");static NotebookCellExecute=new r("NotebookCellExecute");static NotebookCellExecuteGoTo=new r("NotebookCellExecuteGoTo");static NotebookCellExecutePrimary=new r("NotebookCellExecutePrimary");static NotebookDiffCellInputTitle=new r("NotebookDiffCellInputTitle");static NotebookDiffCellMetadataTitle=new r("NotebookDiffCellMetadataTitle");static NotebookDiffCellOutputsTitle=new r("NotebookDiffCellOutputsTitle");static NotebookOutputToolbar=new r("NotebookOutputToolbar");static NotebookOutlineFilter=new r("NotebookOutlineFilter");static NotebookOutlineActionMenu=new r("NotebookOutlineActionMenu");static NotebookEditorLayoutConfigure=new r("NotebookEditorLayoutConfigure");static NotebookKernelSource=new r("NotebookKernelSource");static BulkEditTitle=new r("BulkEditTitle");static BulkEditContext=new r("BulkEditContext");static TimelineItemContext=new r("TimelineItemContext");static TimelineTitle=new r("TimelineTitle");static TimelineTitleContext=new r("TimelineTitleContext");static TimelineFilterSubMenu=new r("TimelineFilterSubMenu");static AccountsContext=new r("AccountsContext");static SidebarTitle=new r("SidebarTitle");static PanelTitle=new r("PanelTitle");static AuxiliaryBarTitle=new r("AuxiliaryBarTitle");static AuxiliaryBarHeader=new r("AuxiliaryBarHeader");static TerminalInstanceContext=new r("TerminalInstanceContext");static TerminalEditorInstanceContext=new r("TerminalEditorInstanceContext");static TerminalNewDropdownContext=new r("TerminalNewDropdownContext");static TerminalTabContext=new r("TerminalTabContext");static TerminalTabEmptyAreaContext=new r("TerminalTabEmptyAreaContext");static TerminalStickyScrollContext=new r("TerminalStickyScrollContext");static WebviewContext=new r("WebviewContext");static InlineCompletionsActions=new r("InlineCompletionsActions");static InlineEditsActions=new r("InlineEditsActions");static InlineEditActions=new r("InlineEditActions");static NewFile=new r("NewFile");static MergeInput1Toolbar=new r("MergeToolbar1Toolbar");static MergeInput2Toolbar=new r("MergeToolbar2Toolbar");static MergeBaseToolbar=new r("MergeBaseToolbar");static MergeInputResultToolbar=new r("MergeToolbarResultToolbar");static InlineSuggestionToolbar=new r("InlineSuggestionToolbar");static InlineEditToolbar=new r("InlineEditToolbar");static ChatContext=new r("ChatContext");static ChatCodeBlock=new r("ChatCodeblock");static ChatCompareBlock=new r("ChatCompareBlock");static ChatMessageTitle=new r("ChatMessageTitle");static ChatExecute=new r("ChatExecute");static ChatExecuteSecondary=new r("ChatExecuteSecondary");static ChatInputSide=new r("ChatInputSide");static AccessibleView=new r("AccessibleView");static MultiDiffEditorFileToolbar=new r("MultiDiffEditorFileToolbar");static DiffEditorHunkToolbar=new r("DiffEditorHunkToolbar");static DiffEditorSelectionToolbar=new r("DiffEditorSelectionToolbar");static for(t){return r._instances.get(t)??new r(t)}id;constructor(t){if(r._instances.has(t))throw new TypeError(`MenuId with identifier '${t}' already exists. Use MenuId.for(ident) or a unique identifier`);r._instances.set(t,this),this.id=t}},jt=q("menuService"),mI=class r{constructor(t){this.id=t;this.has=e=>e===t}static _all=new Map;static for(t){let e=this._all.get(t);return e||(e=new r(t),this._all.set(t,e)),e}static merge(t){let e=new Set;for(let i of t)i instanceof r&&e.add(i.id);return e}has},Ue=new class{_commands=new Map;_menuItems=new Map;_onDidChangeMenu=new cA({merge:mI.merge});onDidChangeMenu=this._onDidChangeMenu.event;addCommand(r){return this._commands.set(r.id,r),this._onDidChangeMenu.fire(mI.for(V.CommandPalette)),le(()=>{this._commands.delete(r.id)&&this._onDidChangeMenu.fire(mI.for(V.CommandPalette))})}getCommand(r){return this._commands.get(r)}getCommands(){let r=new Map;return this._commands.forEach((t,e)=>r.set(e,t)),r}appendMenuItem(r,t){let e=this._menuItems.get(r);e||(e=new lr,this._menuItems.set(r,e));let i=e.push(t);return this._onDidChangeMenu.fire(mI.for(r)),le(()=>{i(),this._onDidChangeMenu.fire(mI.for(r))})}appendMenuItems(r){let t=new B;for(let{id:e,item:i}of r)t.add(this.appendMenuItem(e,i));return t}getMenuItems(r){let t;return this._menuItems.has(r)?t=[...this._menuItems.get(r)]:t=[],r===V.CommandPalette&&this._appendImplicitItems(t),t}_appendImplicitItems(r){let t=new Set;for(let e of r)yf(e)&&(t.add(e.command.id),e.alt&&t.add(e.alt.id));this._commands.forEach((e,i)=>{t.has(i)||r.push({command:e})})}},to=class extends vo{constructor(e,i,n){super(`submenuitem.${e.submenu.id}`,typeof e.title=="string"?e.title:e.title.value,n,"submenu");this.item=e;this.hideActions=i}},wn=class{constructor(t,e,i,n,o,s,a){this.hideActions=n;this.menuKeybinding=o;this._commandService=a;this.id=t.id,this.label=wn.label(t,i),this.tooltip=(typeof t.tooltip=="string"?t.tooltip:t.tooltip?.value)??"",this.enabled=!t.precondition||s.contextMatchesRules(t.precondition),this.checked=void 0;let l;if(t.toggled){let d=t.toggled.condition?t.toggled:{condition:t.toggled};this.checked=s.contextMatchesRules(d.condition),this.checked&&d.tooltip&&(this.tooltip=typeof d.tooltip=="string"?d.tooltip:d.tooltip.value),this.checked&&de.isThemeIcon(d.icon)&&(l=d.icon),this.checked&&d.title&&(this.label=typeof d.title=="string"?d.title:d.title.value)}l||(l=de.isThemeIcon(t.icon)?t.icon:void 0),this.item=t,this.alt=e?new wn(e,void 0,i,n,void 0,s,a):void 0,this._options=i,this.class=l&&de.asClassName(l)}static label(t,e){return e?.renderShortTitle&&t.shortTitle?typeof t.shortTitle=="string"?t.shortTitle:t.shortTitle.value:typeof t.title=="string"?t.title:t.title.value}item;alt;_options;id;label;tooltip;class;enabled;checked;run(...t){let e=[];return this._options?.arg&&(e=[...e,this._options.arg]),this._options?.shouldForwardArgs&&(e=[...e,...t]),this._commandService.executeCommand(this.id,...e)}};wn=E([b(5,re),b(6,ct)],wn);var Me=class{constructor(t){this.desc=t}};function he(r){let t=[],e=new r,{f1:i,menu:n,keybinding:o,...s}=e.desc;if(tt.getCommand(s.id))throw new Error(`Cannot register two commands with the same id: ${s.id}`);if(t.push(tt.registerCommand({id:s.id,handler:(a,...l)=>e.run(a,...l),metadata:s.metadata})),Array.isArray(n))for(let a of n)t.push(Ue.appendMenuItem(a.id,{command:{...s,precondition:a.precondition===null?void 0:s.precondition},...a}));else n&&t.push(Ue.appendMenuItem(n.id,{command:{...s,precondition:n.precondition===null?void 0:s.precondition},...n}));if(i&&(t.push(Ue.appendMenuItem(V.CommandPalette,{command:s,when:s.precondition})),t.push(Ue.addCommand(s))),Array.isArray(o))for(let a of o)t.push(wt.registerKeybindingRule({...a,id:s.id,when:s.precondition?P.and(s.precondition,a.when):a.when}));else o&&t.push(wt.registerKeybindingRule({...o,id:s.id,when:s.precondition?P.and(s.precondition,o.when):o.when}));return{dispose(){_e(t)}}}var pC=class extends R{constructor(e,i,n,o,s){super();this._accessibilityService=s;this.isSimpleWidget=e,this.contextMenuId=i,this._containerObserver=this._register(new ZS(o,n.dimension)),this._targetWindowId=ue(o).vscodeWindowId,this._rawOptions=uie(n),this._validatedOptions=gI.validateOptions(this._rawOptions),this.options=this._computeOptions(),this.options.get(13)&&this._containerObserver.startObserving(),this._register(Pp.onDidChangeZoomLevel(()=>this._recomputeOptions())),this._register(uC.onDidChangeTabFocus(()=>this._recomputeOptions())),this._register(this._containerObserver.onDidChange(()=>this._recomputeOptions())),this._register(RD.onDidChange(()=>this._recomputeOptions())),this._register(Zs.getInstance(ue(o)).onDidChange(()=>this._recomputeOptions())),this._register(this._accessibilityService.onDidChangeScreenReaderOptimized(()=>this._recomputeOptions()))}_onDidChange=this._register(new x);onDidChange=this._onDidChange.event;_onDidChangeFast=this._register(new x);onDidChangeFast=this._onDidChangeFast.event;isSimpleWidget;contextMenuId;_containerObserver;_isDominatedByLongLines=!1;_viewLineCount=1;_lineNumbersDigitCount=1;_reservedHeight=0;_glyphMarginDecorationLaneCount=1;_targetWindowId;_computeOptionsMemory=new kD;_rawOptions;_validatedOptions;options;_recomputeOptions(){let e=this._computeOptions(),i=gI.checkEquals(this.options,e);i!==null&&(this.options=e,this._onDidChangeFast.fire(i),this._onDidChange.fire(i))}_computeOptions(){let e=this._readEnvConfiguration(),i=Mp.createFromValidatedSettings(this._validatedOptions,e.pixelRatio,this.isSimpleWidget),n=this._readFontInfo(i),o={memory:this._computeOptionsMemory,outerWidth:e.outerWidth,outerHeight:e.outerHeight-this._reservedHeight,fontInfo:n,extraEditorClassName:e.extraEditorClassName,isDominatedByLongLines:this._isDominatedByLongLines,viewLineCount:this._viewLineCount,lineNumbersDigitCount:this._lineNumbersDigitCount,emptySelectionClipboard:e.emptySelectionClipboard,pixelRatio:e.pixelRatio,tabFocusMode:uC.getTabFocusMode(),accessibilitySupport:e.accessibilitySupport,glyphMarginDecorationLaneCount:this._glyphMarginDecorationLaneCount};return gI.computeOptions(this._validatedOptions,o)}_readEnvConfiguration(){return{extraEditorClassName:Vve(),outerWidth:this._containerObserver.getWidth(),outerHeight:this._containerObserver.getHeight(),emptySelectionClipboard:Yc||po,pixelRatio:Zs.getInstance(Em(this._targetWindowId,!0).window).value,accessibilitySupport:this._accessibilityService.isScreenReaderOptimized()?2:this._accessibilityService.getAccessibilitySupport()}}_readFontInfo(e){return RD.readFontInfo(Em(this._targetWindowId,!0).window,e)}getRawOptions(){return this._rawOptions}updateOptions(e){let i=uie(e);gI.applyUpdate(this._rawOptions,i)&&(this._validatedOptions=gI.validateOptions(this._rawOptions),this._recomputeOptions())}observeContainer(e){this._containerObserver.observe(e)}setIsDominatedByLongLines(e){this._isDominatedByLongLines!==e&&(this._isDominatedByLongLines=e,this._recomputeOptions())}setModelLineCount(e){let i=Bve(e);this._lineNumbersDigitCount!==i&&(this._lineNumbersDigitCount=i,this._recomputeOptions())}setViewLineCount(e){this._viewLineCount!==e&&(this._viewLineCount=e,this._recomputeOptions())}setReservedHeight(e){this._reservedHeight!==e&&(this._reservedHeight=e,this._recomputeOptions())}setGlyphMarginDecorationLaneCount(e){this._glyphMarginDecorationLaneCount!==e&&(this._glyphMarginDecorationLaneCount=e,this._recomputeOptions())}};pC=E([b(4,Un)],pC);function Bve(r){let t=0;for(;r;)r=Math.floor(r/10),t++;return t||1}function Vve(){let r="";return!ms&&!See&&(r+="no-user-select "),ms&&(r+="no-minimap-shadow ",r+="enable-user-select "),ye&&(r+="mac "),r}var SG=class{_values=[];_read(t){return this._values[t]}get(t){return this._values[t]}_write(t,e){this._values[t]=e}},CG=class{_values=[];_read(t){if(t>=this._values.length)throw new Error("Cannot read uninitialized value");return this._values[t]}get(t){return this._read(t)}_write(t,e){this._values[t]=e}},gI=class r{static validateOptions(t){let e=new SG;for(let i of dC){let n=i.name==="_never_"?void 0:t[i.name];e._write(i.id,i.validate(n))}return e}static computeOptions(t,e){let i=new CG;for(let n of dC)i._write(n.id,n.compute(e,i,t._read(n.id)));return i}static _deepEquals(t,e){if(typeof t!="object"||typeof e!="object"||!t||!e)return t===e;if(Array.isArray(t)||Array.isArray(e))return Array.isArray(t)&&Array.isArray(e)?xi(t,e):!1;if(Object.keys(t).length!==Object.keys(e).length)return!1;for(let i in t)if(!r._deepEquals(t[i],e[i]))return!1;return!0}static checkEquals(t,e){let i=[],n=!1;for(let o of dC){let s=!r._deepEquals(t._read(o.id),e._read(o.id));i[o.id]=s,s&&(n=!0)}return n?new mO(i):null}static applyUpdate(t,e){let i=!1;for(let n of dC)if(e.hasOwnProperty(n.name)){let o=n.applyUpdate(t[n.name],e[n.name]);t[n.name]=o.newValue,i=i||o.didChange}return i}};function uie(r){let t=Xi(r);return die(t),t}var H=class r{lineNumber;column;constructor(t,e){this.lineNumber=t,this.column=e}with(t=this.lineNumber,e=this.column){return t===this.lineNumber&&e===this.column?this:new r(t,e)}delta(t=0,e=0){return this.with(this.lineNumber+t,this.column+e)}equals(t){return r.equals(this,t)}static equals(t,e){return!t&&!e?!0:!!t&&!!e&&t.lineNumber===e.lineNumber&&t.column===e.column}isBefore(t){return r.isBefore(this,t)}static isBefore(t,e){return t.lineNumber<e.lineNumber?!0:e.lineNumber<t.lineNumber?!1:t.column<e.column}isBeforeOrEqual(t){return r.isBeforeOrEqual(this,t)}static isBeforeOrEqual(t,e){return t.lineNumber<e.lineNumber?!0:e.lineNumber<t.lineNumber?!1:t.column<=e.column}static compare(t,e){let i=t.lineNumber|0,n=e.lineNumber|0;if(i===n){let o=t.column|0,s=e.column|0;return o-s}return i-n}clone(){return new r(this.lineNumber,this.column)}toString(){return"("+this.lineNumber+","+this.column+")"}static lift(t){return new r(t.lineNumber,t.column)}static isIPosition(t){return t&&typeof t.lineNumber=="number"&&typeof t.column=="number"}toJSON(){return{lineNumber:this.lineNumber,column:this.column}}};var L=class r{startLineNumber;startColumn;endLineNumber;endColumn;constructor(t,e,i,n){t>i||t===i&&e>n?(this.startLineNumber=i,this.startColumn=n,this.endLineNumber=t,this.endColumn=e):(this.startLineNumber=t,this.startColumn=e,this.endLineNumber=i,this.endColumn=n)}isEmpty(){return r.isEmpty(this)}static isEmpty(t){return t.startLineNumber===t.endLineNumber&&t.startColumn===t.endColumn}containsPosition(t){return r.containsPosition(this,t)}static containsPosition(t,e){return!(e.lineNumber<t.startLineNumber||e.lineNumber>t.endLineNumber||e.lineNumber===t.startLineNumber&&e.column<t.startColumn||e.lineNumber===t.endLineNumber&&e.column>t.endColumn)}static strictContainsPosition(t,e){return!(e.lineNumber<t.startLineNumber||e.lineNumber>t.endLineNumber||e.lineNumber===t.startLineNumber&&e.column<=t.startColumn||e.lineNumber===t.endLineNumber&&e.column>=t.endColumn)}containsRange(t){return r.containsRange(this,t)}static containsRange(t,e){return!(e.startLineNumber<t.startLineNumber||e.endLineNumber<t.startLineNumber||e.startLineNumber>t.endLineNumber||e.endLineNumber>t.endLineNumber||e.startLineNumber===t.startLineNumber&&e.startColumn<t.startColumn||e.endLineNumber===t.endLineNumber&&e.endColumn>t.endColumn)}strictContainsRange(t){return r.strictContainsRange(this,t)}static strictContainsRange(t,e){return!(e.startLineNumber<t.startLineNumber||e.endLineNumber<t.startLineNumber||e.startLineNumber>t.endLineNumber||e.endLineNumber>t.endLineNumber||e.startLineNumber===t.startLineNumber&&e.startColumn<=t.startColumn||e.endLineNumber===t.endLineNumber&&e.endColumn>=t.endColumn)}plusRange(t){return r.plusRange(this,t)}static plusRange(t,e){let i,n,o,s;return e.startLineNumber<t.startLineNumber?(i=e.startLineNumber,n=e.startColumn):e.startLineNumber===t.startLineNumber?(i=e.startLineNumber,n=Math.min(e.startColumn,t.startColumn)):(i=t.startLineNumber,n=t.startColumn),e.endLineNumber>t.endLineNumber?(o=e.endLineNumber,s=e.endColumn):e.endLineNumber===t.endLineNumber?(o=e.endLineNumber,s=Math.max(e.endColumn,t.endColumn)):(o=t.endLineNumber,s=t.endColumn),new r(i,n,o,s)}intersectRanges(t){return r.intersectRanges(this,t)}static intersectRanges(t,e){let i=t.startLineNumber,n=t.startColumn,o=t.endLineNumber,s=t.endColumn,a=e.startLineNumber,l=e.startColumn,d=e.endLineNumber,c=e.endColumn;return i<a?(i=a,n=l):i===a&&(n=Math.max(n,l)),o>d?(o=d,s=c):o===d&&(s=Math.min(s,c)),i>o||i===o&&n>s?null:new r(i,n,o,s)}equalsRange(t){return r.equalsRange(this,t)}static equalsRange(t,e){return!t&&!e?!0:!!t&&!!e&&t.startLineNumber===e.startLineNumber&&t.startColumn===e.startColumn&&t.endLineNumber===e.endLineNumber&&t.endColumn===e.endColumn}getEndPosition(){return r.getEndPosition(this)}static getEndPosition(t){return new H(t.endLineNumber,t.endColumn)}getStartPosition(){return r.getStartPosition(this)}static getStartPosition(t){return new H(t.startLineNumber,t.startColumn)}toString(){return"["+this.startLineNumber+","+this.startColumn+" -> "+this.endLineNumber+","+this.endColumn+"]"}setEndPosition(t,e){return new r(this.startLineNumber,this.startColumn,t,e)}setStartPosition(t,e){return new r(t,e,this.endLineNumber,this.endColumn)}collapseToStart(){return r.collapseToStart(this)}static collapseToStart(t){return new r(t.startLineNumber,t.startColumn,t.startLineNumber,t.startColumn)}collapseToEnd(){return r.collapseToEnd(this)}static collapseToEnd(t){return new r(t.endLineNumber,t.endColumn,t.endLineNumber,t.endColumn)}delta(t){return new r(this.startLineNumber+t,this.startColumn,this.endLineNumber+t,this.endColumn)}static fromPositions(t,e=t){return new r(t.lineNumber,t.column,e.lineNumber,e.column)}static lift(t){return t?new r(t.startLineNumber,t.startColumn,t.endLineNumber,t.endColumn):null}static isIRange(t){return t&&typeof t.startLineNumber=="number"&&typeof t.startColumn=="number"&&typeof t.endLineNumber=="number"&&typeof t.endColumn=="number"}static areIntersectingOrTouching(t,e){return!(t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<e.startColumn||e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<t.startColumn)}static areIntersecting(t,e){return!(t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<=e.startColumn||e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<=t.startColumn)}static compareRangesUsingStarts(t,e){if(t&&e){let o=t.startLineNumber|0,s=e.startLineNumber|0;if(o===s){let a=t.startColumn|0,l=e.startColumn|0;if(a===l){let d=t.endLineNumber|0,c=e.endLineNumber|0;if(d===c){let p=t.endColumn|0,h=e.endColumn|0;return p-h}return d-c}return a-l}return o-s}return(t?1:0)-(e?1:0)}static compareRangesUsingEnds(t,e){return t.endLineNumber===e.endLineNumber?t.endColumn===e.endColumn?t.startLineNumber===e.startLineNumber?t.startColumn-e.startColumn:t.startLineNumber-e.startLineNumber:t.endColumn-e.endColumn:t.endLineNumber-e.endLineNumber}static spansMultipleLines(t){return t.endLineNumber>t.startLineNumber}toJSON(){return this}};var Et=class r extends L{selectionStartLineNumber;selectionStartColumn;positionLineNumber;positionColumn;constructor(t,e,i,n){super(t,e,i,n),this.selectionStartLineNumber=t,this.selectionStartColumn=e,this.positionLineNumber=i,this.positionColumn=n}toString(){return"["+this.selectionStartLineNumber+","+this.selectionStartColumn+" -> "+this.positionLineNumber+","+this.positionColumn+"]"}equalsSelection(t){return r.selectionsEqual(this,t)}static selectionsEqual(t,e){return t.selectionStartLineNumber===e.selectionStartLineNumber&&t.selectionStartColumn===e.selectionStartColumn&&t.positionLineNumber===e.positionLineNumber&&t.positionColumn===e.positionColumn}getDirection(){return this.selectionStartLineNumber===this.startLineNumber&&this.selectionStartColumn===this.startColumn?0:1}setEndPosition(t,e){return this.getDirection()===0?new r(this.startLineNumber,this.startColumn,t,e):new r(t,e,this.startLineNumber,this.startColumn)}getPosition(){return new H(this.positionLineNumber,this.positionColumn)}getSelectionStart(){return new H(this.selectionStartLineNumber,this.selectionStartColumn)}setStartPosition(t,e){return this.getDirection()===0?new r(t,e,this.endLineNumber,this.endColumn):new r(this.endLineNumber,this.endColumn,t,e)}static fromPositions(t,e=t){return new r(t.lineNumber,t.column,e.lineNumber,e.column)}static fromRange(t,e){return e===0?new r(t.startLineNumber,t.startColumn,t.endLineNumber,t.endColumn):new r(t.endLineNumber,t.endColumn,t.startLineNumber,t.startColumn)}static liftSelection(t){return new r(t.selectionStartLineNumber,t.selectionStartColumn,t.positionLineNumber,t.positionColumn)}static selectionsArrEqual(t,e){if(t&&!e||!t&&e)return!1;if(!t&&!e)return!0;if(t.length!==e.length)return!1;for(let i=0,n=t.length;i<n;i++)if(!this.selectionsEqual(t[i],e[i]))return!1;return!0}static isISelection(t){return t&&typeof t.selectionStartLineNumber=="number"&&typeof t.selectionStartColumn=="number"&&typeof t.positionLineNumber=="number"&&typeof t.positionColumn=="number"}static createWithDirection(t,e,i,n,o){return o===0?new r(t,e,i,n):new r(i,n,t,e)}};var au=class{originalStart;originalLength;modifiedStart;modifiedLength;constructor(t,e,i,n){this.originalStart=t,this.originalLength=e,this.modifiedStart=i,this.modifiedLength=n}getOriginalEnd(){return this.originalStart+this.originalLength}getModifiedEnd(){return this.modifiedStart+this.modifiedLength}};var Sf=class{static Assert(t,e){if(!t)throw new Error(e)}},Cf=class{static Copy(t,e,i,n,o){for(let s=0;s<o;s++)i[n+s]=t[e+s]}static Copy2(t,e,i,n,o){for(let s=0;s<o;s++)i[n+s]=t[e+s]}};var yO=class{m_changes;m_originalStart;m_modifiedStart;m_originalCount;m_modifiedCount;constructor(){this.m_changes=[],this.m_originalStart=1073741824,this.m_modifiedStart=1073741824,this.m_originalCount=0,this.m_modifiedCount=0}MarkNextChange(){(this.m_originalCount>0||this.m_modifiedCount>0)&&this.m_changes.push(new au(this.m_originalStart,this.m_originalCount,this.m_modifiedStart,this.m_modifiedCount)),this.m_originalCount=0,this.m_modifiedCount=0,this.m_originalStart=1073741824,this.m_modifiedStart=1073741824}AddOriginalElement(t,e){this.m_originalStart=Math.min(this.m_originalStart,t),this.m_modifiedStart=Math.min(this.m_modifiedStart,e),this.m_originalCount++}AddModifiedElement(t,e){this.m_originalStart=Math.min(this.m_originalStart,t),this.m_modifiedStart=Math.min(this.m_modifiedStart,e),this.m_modifiedCount++}getChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes}getReverseChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes.reverse(),this.m_changes}},Dm=class r{ContinueProcessingPredicate;_originalSequence;_modifiedSequence;_hasStrings;_originalStringElements;_originalElementsOrHash;_modifiedStringElements;_modifiedElementsOrHash;m_forwardHistory;m_reverseHistory;constructor(t,e,i=null){this.ContinueProcessingPredicate=i,this._originalSequence=t,this._modifiedSequence=e;let[n,o,s]=r._getElements(t),[a,l,d]=r._getElements(e);this._hasStrings=s&&d,this._originalStringElements=n,this._originalElementsOrHash=o,this._modifiedStringElements=a,this._modifiedElementsOrHash=l,this.m_forwardHistory=[],this.m_reverseHistory=[]}static _isStringArray(t){return t.length>0&&typeof t[0]=="string"}static _getElements(t){let e=t.getElements();if(r._isStringArray(e)){let i=new Int32Array(e.length);for(let n=0,o=e.length;n<o;n++)i[n]=qS(e[n],0);return[e,i,!0]}return e instanceof Int32Array?[[],e,!1]:[[],new Int32Array(e),!1]}ElementsAreEqual(t,e){return this._originalElementsOrHash[t]!==this._modifiedElementsOrHash[e]?!1:this._hasStrings?this._originalStringElements[t]===this._modifiedStringElements[e]:!0}ElementsAreStrictEqual(t,e){if(!this.ElementsAreEqual(t,e))return!1;let i=r._getStrictElement(this._originalSequence,t),n=r._getStrictElement(this._modifiedSequence,e);return i===n}static _getStrictElement(t,e){return typeof t.getStrictElement=="function"?t.getStrictElement(e):null}OriginalElementsAreEqual(t,e){return this._originalElementsOrHash[t]!==this._originalElementsOrHash[e]?!1:this._hasStrings?this._originalStringElements[t]===this._originalStringElements[e]:!0}ModifiedElementsAreEqual(t,e){return this._modifiedElementsOrHash[t]!==this._modifiedElementsOrHash[e]?!1:this._hasStrings?this._modifiedStringElements[t]===this._modifiedStringElements[e]:!0}ComputeDiff(t){return this._ComputeDiff(0,this._originalElementsOrHash.length-1,0,this._modifiedElementsOrHash.length-1,t)}_ComputeDiff(t,e,i,n,o){let s=[!1],a=this.ComputeDiffRecursive(t,e,i,n,s);return o&&(a=this.PrettifyChanges(a)),{quitEarly:s[0],changes:a}}ComputeDiffRecursive(t,e,i,n,o){for(o[0]=!1;t<=e&&i<=n&&this.ElementsAreEqual(t,i);)t++,i++;for(;e>=t&&n>=i&&this.ElementsAreEqual(e,n);)e--,n--;if(t>e||i>n){let p;return i<=n?(Sf.Assert(t===e+1,"originalStart should only be one more than originalEnd"),p=[new au(t,0,i,n-i+1)]):t<=e?(Sf.Assert(i===n+1,"modifiedStart should only be one more than modifiedEnd"),p=[new au(t,e-t+1,i,0)]):(Sf.Assert(t===e+1,"originalStart should only be one more than originalEnd"),Sf.Assert(i===n+1,"modifiedStart should only be one more than modifiedEnd"),p=[]),p}let s=[0],a=[0],l=this.ComputeRecursionPoint(t,e,i,n,s,a,o),d=s[0],c=a[0];if(l!==null)return l;if(!o[0]){let p=this.ComputeDiffRecursive(t,d,i,c,o),h=[];return o[0]?h=[new au(d+1,e-(d+1)+1,c+1,n-(c+1)+1)]:h=this.ComputeDiffRecursive(d+1,e,c+1,n,o),this.ConcatenateChanges(p,h)}return[new au(t,e-t+1,i,n-i+1)]}WALKTRACE(t,e,i,n,o,s,a,l,d,c,p,h,m,f,g,v,I,y){let w=null,C=null,S=new yO,D=e,k=i,M=m[0]-v[0]-n,O=-1073741824,K=this.m_forwardHistory.length-1;do{let G=M+t;G===D||G<k&&d[G-1]<d[G+1]?(p=d[G+1],f=p-M-n,p<O&&S.MarkNextChange(),O=p,S.AddModifiedElement(p+1,f),M=G+1-t):(p=d[G-1]+1,f=p-M-n,p<O&&S.MarkNextChange(),O=p-1,S.AddOriginalElement(p,f+1),M=G-1-t),K>=0&&(d=this.m_forwardHistory[K],t=d[0],D=1,k=d.length-1)}while(--K>=-1);if(w=S.getReverseChanges(),y[0]){let G=m[0]+1,Y=v[0]+1;if(w!==null&&w.length>0){let ge=w[w.length-1];G=Math.max(G,ge.getOriginalEnd()),Y=Math.max(Y,ge.getModifiedEnd())}C=[new au(G,h-G+1,Y,g-Y+1)]}else{S=new yO,D=s,k=a,M=m[0]-v[0]-l,O=1073741824,K=I?this.m_reverseHistory.length-1:this.m_reverseHistory.length-2;do{let G=M+o;G===D||G<k&&c[G-1]>=c[G+1]?(p=c[G+1]-1,f=p-M-l,p>O&&S.MarkNextChange(),O=p+1,S.AddOriginalElement(p+1,f+1),M=G+1-o):(p=c[G-1],f=p-M-l,p>O&&S.MarkNextChange(),O=p,S.AddModifiedElement(p+1,f+1),M=G-1-o),K>=0&&(c=this.m_reverseHistory[K],o=c[0],D=1,k=c.length-1)}while(--K>=-1);C=S.getChanges()}return this.ConcatenateChanges(w,C)}ComputeRecursionPoint(t,e,i,n,o,s,a){let l=0,d=0,c=0,p=0,h=0,m=0;t--,i--,o[0]=0,s[0]=0,this.m_forwardHistory=[],this.m_reverseHistory=[];let f=e-t+(n-i),g=f+1,v=new Int32Array(g),I=new Int32Array(g),y=n-i,w=e-t,C=t-i,S=e-n,k=(w-y)%2===0;v[y]=t,I[w]=e,a[0]=!1;for(let M=1;M<=f/2+1;M++){let O=0,K=0;c=this.ClipDiagonalBound(y-M,M,y,g),p=this.ClipDiagonalBound(y+M,M,y,g);for(let Y=c;Y<=p;Y+=2){Y===c||Y<p&&v[Y-1]<v[Y+1]?l=v[Y+1]:l=v[Y-1]+1,d=l-(Y-y)-C;let ge=l;for(;l<e&&d<n&&this.ElementsAreEqual(l+1,d+1);)l++,d++;if(v[Y]=l,l+d>O+K&&(O=l,K=d),!k&&Math.abs(Y-w)<=M-1&&l>=I[Y])return o[0]=l,s[0]=d,ge<=I[Y]&&M<=1448?this.WALKTRACE(y,c,p,C,w,h,m,S,v,I,l,e,o,d,n,s,k,a):null}let G=(O-t+(K-i)-M)/2;if(this.ContinueProcessingPredicate!==null&&!this.ContinueProcessingPredicate(O,G))return a[0]=!0,o[0]=O,s[0]=K,G>0&&M<=1448?this.WALKTRACE(y,c,p,C,w,h,m,S,v,I,l,e,o,d,n,s,k,a):(t++,i++,[new au(t,e-t+1,i,n-i+1)]);h=this.ClipDiagonalBound(w-M,M,w,g),m=this.ClipDiagonalBound(w+M,M,w,g);for(let Y=h;Y<=m;Y+=2){Y===h||Y<m&&I[Y-1]>=I[Y+1]?l=I[Y+1]-1:l=I[Y-1],d=l-(Y-w)-S;let ge=l;for(;l>t&&d>i&&this.ElementsAreEqual(l,d);)l--,d--;if(I[Y]=l,k&&Math.abs(Y-y)<=M&&l<=v[Y])return o[0]=l,s[0]=d,ge>=v[Y]&&M<=1448?this.WALKTRACE(y,c,p,C,w,h,m,S,v,I,l,e,o,d,n,s,k,a):null}if(M<=1447){let Y=new Int32Array(p-c+2);Y[0]=y-c+1,Cf.Copy2(v,c,Y,1,p-c+1),this.m_forwardHistory.push(Y),Y=new Int32Array(m-h+2),Y[0]=w-h+1,Cf.Copy2(I,h,Y,1,m-h+1),this.m_reverseHistory.push(Y)}}return this.WALKTRACE(y,c,p,C,w,h,m,S,v,I,l,e,o,d,n,s,k,a)}PrettifyChanges(t){for(let e=0;e<t.length;e++){let i=t[e],n=e<t.length-1?t[e+1].originalStart:this._originalElementsOrHash.length,o=e<t.length-1?t[e+1].modifiedStart:this._modifiedElementsOrHash.length,s=i.originalLength>0,a=i.modifiedLength>0;for(;i.originalStart+i.originalLength<n&&i.modifiedStart+i.modifiedLength<o&&(!s||this.OriginalElementsAreEqual(i.originalStart,i.originalStart+i.originalLength))&&(!a||this.ModifiedElementsAreEqual(i.modifiedStart,i.modifiedStart+i.modifiedLength));){let d=this.ElementsAreStrictEqual(i.originalStart,i.modifiedStart);if(this.ElementsAreStrictEqual(i.originalStart+i.originalLength,i.modifiedStart+i.modifiedLength)&&!d)break;i.originalStart++,i.modifiedStart++}let l=[null];if(e<t.length-1&&this.ChangesOverlap(t[e],t[e+1],l)){t[e]=l[0],t.splice(e+1,1),e--;continue}}for(let e=t.length-1;e>=0;e--){let i=t[e],n=0,o=0;if(e>0){let p=t[e-1];n=p.originalStart+p.originalLength,o=p.modifiedStart+p.modifiedLength}let s=i.originalLength>0,a=i.modifiedLength>0,l=0,d=this._boundaryScore(i.originalStart,i.originalLength,i.modifiedStart,i.modifiedLength);for(let p=1;;p++){let h=i.originalStart-p,m=i.modifiedStart-p;if(h<n||m<o||s&&!this.OriginalElementsAreEqual(h,h+i.originalLength)||a&&!this.ModifiedElementsAreEqual(m,m+i.modifiedLength))break;let g=(h===n&&m===o?5:0)+this._boundaryScore(h,i.originalLength,m,i.modifiedLength);g>d&&(d=g,l=p)}i.originalStart-=l,i.modifiedStart-=l;let c=[null];if(e>0&&this.ChangesOverlap(t[e-1],t[e],c)){t[e-1]=c[0],t.splice(e,1),e++;continue}}if(this._hasStrings)for(let e=1,i=t.length;e<i;e++){let n=t[e-1],o=t[e],s=o.originalStart-n.originalStart-n.originalLength,a=n.originalStart,l=o.originalStart+o.originalLength,d=l-a,c=n.modifiedStart,p=o.modifiedStart+o.modifiedLength,h=p-c;if(s<5&&d<20&&h<20){let m=this._findBetterContiguousSequence(a,d,c,h,s);if(m){let[f,g]=m;(f!==n.originalStart+n.originalLength||g!==n.modifiedStart+n.modifiedLength)&&(n.originalLength=f-n.originalStart,n.modifiedLength=g-n.modifiedStart,o.originalStart=f+s,o.modifiedStart=g+s,o.originalLength=l-o.originalStart,o.modifiedLength=p-o.modifiedStart)}}}return t}_findBetterContiguousSequence(t,e,i,n,o){if(e<o||n<o)return null;let s=t+e-o+1,a=i+n-o+1,l=0,d=0,c=0;for(let p=t;p<s;p++)for(let h=i;h<a;h++){let m=this._contiguousSequenceScore(p,h,o);m>0&&m>l&&(l=m,d=p,c=h)}return l>0?[d,c]:null}_contiguousSequenceScore(t,e,i){let n=0;for(let o=0;o<i;o++){if(!this.ElementsAreEqual(t+o,e+o))return 0;n+=this._originalStringElements[t+o].length}return n}_OriginalIsBoundary(t){return t<=0||t>=this._originalElementsOrHash.length-1?!0:this._hasStrings&&/^\s*$/.test(this._originalStringElements[t])}_OriginalRegionIsBoundary(t,e){if(this._OriginalIsBoundary(t)||this._OriginalIsBoundary(t-1))return!0;if(e>0){let i=t+e;if(this._OriginalIsBoundary(i-1)||this._OriginalIsBoundary(i))return!0}return!1}_ModifiedIsBoundary(t){return t<=0||t>=this._modifiedElementsOrHash.length-1?!0:this._hasStrings&&/^\s*$/.test(this._modifiedStringElements[t])}_ModifiedRegionIsBoundary(t,e){if(this._ModifiedIsBoundary(t)||this._ModifiedIsBoundary(t-1))return!0;if(e>0){let i=t+e;if(this._ModifiedIsBoundary(i-1)||this._ModifiedIsBoundary(i))return!0}return!1}_boundaryScore(t,e,i,n){let o=this._OriginalRegionIsBoundary(t,e)?1:0,s=this._ModifiedRegionIsBoundary(i,n)?1:0;return o+s}ConcatenateChanges(t,e){let i=[];if(t.length===0||e.length===0)return e.length>0?e:t;if(this.ChangesOverlap(t[t.length-1],e[0],i)){let n=new Array(t.length+e.length-1);return Cf.Copy(t,0,n,0,t.length-1),n[t.length-1]=i[0],Cf.Copy(e,1,n,t.length,e.length-1),n}else{let n=new Array(t.length+e.length);return Cf.Copy(t,0,n,0,t.length),Cf.Copy(e,0,n,t.length,e.length),n}}ChangesOverlap(t,e,i){if(Sf.Assert(t.originalStart<=e.originalStart,"Left change is not less than or equal to right change"),Sf.Assert(t.modifiedStart<=e.modifiedStart,"Left change is not less than or equal to right change"),t.originalStart+t.originalLength>=e.originalStart||t.modifiedStart+t.modifiedLength>=e.modifiedStart){let n=t.originalStart,o=t.originalLength,s=t.modifiedStart,a=t.modifiedLength;return t.originalStart+t.originalLength>=e.originalStart&&(o=e.originalStart+e.originalLength-t.originalStart),t.modifiedStart+t.modifiedLength>=e.modifiedStart&&(a=e.modifiedStart+e.modifiedLength-t.modifiedStart),i[0]=new au(n,o,s,a),!0}else return i[0]=null,!1}ClipDiagonalBound(t,e,i,n){if(t>=0&&t<n)return t;let o=i,s=n-i-1,a=e%2===0;if(t<0){let l=o%2===0;return a===l?0:1}else{let l=s%2===0;return a===l?n-1:n-2}}};var Qe=class r{constructor(t,e){this.start=t;this.endExclusive=e;if(t>e)throw new _t(`Invalid range: ${this.toString()}`)}static addRange(t,e){let i=0;for(;i<e.length&&e[i].endExclusive<t.start;)i++;let n=i;for(;n<e.length&&e[n].start<=t.endExclusive;)n++;if(i===n)e.splice(i,0,t);else{let o=Math.min(t.start,e[i].start),s=Math.max(t.endExclusive,e[n-1].endExclusive);e.splice(i,n-i,new r(o,s))}}static tryCreate(t,e){if(!(t>e))return new r(t,e)}static ofLength(t){return new r(0,t)}static ofStartAndLength(t,e){return new r(t,t+e)}static emptyAt(t){return new r(t,t)}get isEmpty(){return this.start===this.endExclusive}delta(t){return new r(this.start+t,this.endExclusive+t)}deltaStart(t){return new r(this.start+t,this.endExclusive)}deltaEnd(t){return new r(this.start,this.endExclusive+t)}get length(){return this.endExclusive-this.start}toString(){return`[${this.start}, ${this.endExclusive})`}equals(t){return this.start===t.start&&this.endExclusive===t.endExclusive}containsRange(t){return this.start<=t.start&&t.endExclusive<=this.endExclusive}contains(t){return this.start<=t&&t<this.endExclusive}join(t){return new r(Math.min(this.start,t.start),Math.max(this.endExclusive,t.endExclusive))}intersect(t){let e=Math.max(this.start,t.start),i=Math.min(this.endExclusive,t.endExclusive);if(e<=i)return new r(e,i)}intersectionLength(t){let e=Math.max(this.start,t.start),i=Math.min(this.endExclusive,t.endExclusive);return Math.max(0,i-e)}intersects(t){let e=Math.max(this.start,t.start),i=Math.min(this.endExclusive,t.endExclusive);return e<i}intersectsOrTouches(t){let e=Math.max(this.start,t.start),i=Math.min(this.endExclusive,t.endExclusive);return e<=i}isBefore(t){return this.endExclusive<=t.start}isAfter(t){return this.start>=t.endExclusive}slice(t){return t.slice(this.start,this.endExclusive)}substring(t){return t.substring(this.start,this.endExclusive)}clip(t){if(this.isEmpty)throw new _t(`Invalid clipping range: ${this.toString()}`);return Math.max(this.start,Math.min(this.endExclusive-1,t))}clipCyclic(t){if(this.isEmpty)throw new _t(`Invalid clipping range: ${this.toString()}`);return t<this.start?this.endExclusive-(this.start-t)%this.length:t>=this.endExclusive?this.start+(t-this.start)%this.length:t}map(t){let e=[];for(let i=this.start;i<this.endExclusive;i++)e.push(t(i));return e}forEach(t){for(let e=this.start;e<this.endExclusive;e++)t(e)}},SO=class r{_sortedRanges=[];addRange(t){let e=0;for(;e<this._sortedRanges.length&&this._sortedRanges[e].endExclusive<t.start;)e++;let i=e;for(;i<this._sortedRanges.length&&this._sortedRanges[i].start<=t.endExclusive;)i++;if(e===i)this._sortedRanges.splice(e,0,t);else{let n=Math.min(t.start,this._sortedRanges[e].start),o=Math.max(t.endExclusive,this._sortedRanges[i-1].endExclusive);this._sortedRanges.splice(e,i-e,new Qe(n,o))}}toString(){return this._sortedRanges.map(t=>t.toString()).join(", ")}intersectsStrict(t){let e=0;for(;e<this._sortedRanges.length&&this._sortedRanges[e].endExclusive<=t.start;)e++;return e<this._sortedRanges.length&&this._sortedRanges[e].start<t.endExclusive}intersectWithRange(t){let e=new r;for(let i of this._sortedRanges){let n=i.intersect(t);n&&e.addRange(n)}return e}intersectWithRangeLength(t){return this.intersectWithRange(t).length}get length(){return this._sortedRanges.reduce((t,e)=>t+e.length,0)}};var ht=class r{static fromRange(t){return new r(t.startLineNumber,t.endLineNumber)}static fromRangeInclusive(t){return new r(t.startLineNumber,t.endLineNumber+1)}static subtract(t,e){return e?t.startLineNumber<e.startLineNumber&&e.endLineNumberExclusive<t.endLineNumberExclusive?[new r(t.startLineNumber,e.startLineNumber),new r(e.endLineNumberExclusive,t.endLineNumberExclusive)]:e.startLineNumber<=t.startLineNumber&&t.endLineNumberExclusive<=e.endLineNumberExclusive?[]:e.endLineNumberExclusive<t.endLineNumberExclusive?[new r(Math.max(e.endLineNumberExclusive,t.startLineNumber),t.endLineNumberExclusive)]:[new r(t.startLineNumber,Math.min(e.startLineNumber,t.endLineNumberExclusive))]:[t]}static joinMany(t){if(t.length===0)return[];let e=new Ed(t[0].slice());for(let i=1;i<t.length;i++)e=e.getUnion(new Ed(t[i].slice()));return e.ranges}static join(t){if(t.length===0)throw new _t("lineRanges cannot be empty");let e=t[0].startLineNumber,i=t[0].endLineNumberExclusive;for(let n=1;n<t.length;n++)e=Math.min(e,t[n].startLineNumber),i=Math.max(i,t[n].endLineNumberExclusive);return new r(e,i)}static ofLength(t,e){return new r(t,t+e)}static deserialize(t){return new r(t[0],t[1])}startLineNumber;endLineNumberExclusive;constructor(t,e){if(t>e)throw new _t(`startLineNumber ${t} cannot be after endLineNumberExclusive ${e}`);this.startLineNumber=t,this.endLineNumberExclusive=e}contains(t){return this.startLineNumber<=t&&t<this.endLineNumberExclusive}get isEmpty(){return this.startLineNumber===this.endLineNumberExclusive}delta(t){return new r(this.startLineNumber+t,this.endLineNumberExclusive+t)}deltaLength(t){return new r(this.startLineNumber,this.endLineNumberExclusive+t)}get length(){return this.endLineNumberExclusive-this.startLineNumber}join(t){return new r(Math.min(this.startLineNumber,t.startLineNumber),Math.max(this.endLineNumberExclusive,t.endLineNumberExclusive))}toString(){return`[${this.startLineNumber},${this.endLineNumberExclusive})`}intersect(t){let e=Math.max(this.startLineNumber,t.startLineNumber),i=Math.min(this.endLineNumberExclusive,t.endLineNumberExclusive);if(e<=i)return new r(e,i)}intersectsStrict(t){return this.startLineNumber<t.endLineNumberExclusive&&t.startLineNumber<this.endLineNumberExclusive}overlapOrTouch(t){return this.startLineNumber<=t.endLineNumberExclusive&&t.startLineNumber<=this.endLineNumberExclusive}equals(t){return this.startLineNumber===t.startLineNumber&&this.endLineNumberExclusive===t.endLineNumberExclusive}toInclusiveRange(){return this.isEmpty?null:new L(this.startLineNumber,1,this.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER)}toExclusiveRange(){return new L(this.startLineNumber,1,this.endLineNumberExclusive,1)}mapToLineArray(t){let e=[];for(let i=this.startLineNumber;i<this.endLineNumberExclusive;i++)e.push(t(i));return e}forEach(t){for(let e=this.startLineNumber;e<this.endLineNumberExclusive;e++)t(e)}serialize(){return[this.startLineNumber,this.endLineNumberExclusive]}includes(t){return this.startLineNumber<=t&&t<this.endLineNumberExclusive}toOffsetRange(){return new Qe(this.startLineNumber-1,this.endLineNumberExclusive-1)}},Ed=class r{constructor(t=[]){this._normalizedRanges=t}get ranges(){return this._normalizedRanges}addRange(t){if(t.length===0)return;let e=Av(this._normalizedRanges,n=>n.endLineNumberExclusive>=t.startLineNumber),i=cm(this._normalizedRanges,n=>n.startLineNumber<=t.endLineNumberExclusive)+1;if(e===i)this._normalizedRanges.splice(e,0,t);else if(e===i-1){let n=this._normalizedRanges[e];this._normalizedRanges[e]=n.join(t)}else{let n=this._normalizedRanges[e].join(this._normalizedRanges[i-1]).join(t);this._normalizedRanges.splice(e,i-e,n)}}contains(t){let e=dm(this._normalizedRanges,i=>i.startLineNumber<=t);return!!e&&e.endLineNumberExclusive>t}intersects(t){let e=dm(this._normalizedRanges,i=>i.startLineNumber<t.endLineNumberExclusive);return!!e&&e.endLineNumberExclusive>t.startLineNumber}getUnion(t){if(this._normalizedRanges.length===0)return t;if(t._normalizedRanges.length===0)return this;let e=[],i=0,n=0,o=null;for(;i<this._normalizedRanges.length||n<t._normalizedRanges.length;){let s=null;if(i<this._normalizedRanges.length&&n<t._normalizedRanges.length){let a=this._normalizedRanges[i],l=t._normalizedRanges[n];a.startLineNumber<l.startLineNumber?(s=a,i++):(s=l,n++)}else i<this._normalizedRanges.length?(s=this._normalizedRanges[i],i++):(s=t._normalizedRanges[n],n++);o===null?o=s:o.endLineNumberExclusive>=s.startLineNumber?o=new ht(o.startLineNumber,Math.max(o.endLineNumberExclusive,s.endLineNumberExclusive)):(e.push(o),o=s)}return o!==null&&e.push(o),new r(e)}subtractFrom(t){let e=Av(this._normalizedRanges,s=>s.endLineNumberExclusive>=t.startLineNumber),i=cm(this._normalizedRanges,s=>s.startLineNumber<=t.endLineNumberExclusive)+1;if(e===i)return new r([t]);let n=[],o=t.startLineNumber;for(let s=e;s<i;s++){let a=this._normalizedRanges[s];a.startLineNumber>o&&n.push(new ht(o,a.startLineNumber)),o=a.endLineNumberExclusive}return o<t.endLineNumberExclusive&&n.push(new ht(o,t.endLineNumberExclusive)),new r(n)}toString(){return this._normalizedRanges.map(t=>t.toString()).join(", ")}getIntersection(t){let e=[],i=0,n=0;for(;i<this._normalizedRanges.length&&n<t._normalizedRanges.length;){let o=this._normalizedRanges[i],s=t._normalizedRanges[n],a=o.intersect(s);a&&!a.isEmpty&&e.push(a),o.endLineNumberExclusive<s.endLineNumberExclusive?i++:n++}return new r(e)}getWithDelta(t){return new r(this._normalizedRanges.map(e=>e.delta(t)))}};var $r=class{static insert(t,e){return{range:new L(t.lineNumber,t.column,t.lineNumber,t.column),text:e,forceMoveMarkers:!0}}static delete(t){return{range:t,text:null}}static replace(t,e){return{range:t,text:e}}static replaceMove(t,e){return{range:t,text:e,forceMoveMarkers:!0}}};var pr=class r{constructor(t,e){this.lineCount=t;this.columnCount=e}static zero=new r(0,0);static lengthDiffNonNegative(t,e){return e.isLessThan(t)?r.zero:t.lineCount===e.lineCount?new r(0,e.columnCount-t.columnCount):new r(e.lineCount-t.lineCount,e.columnCount)}static betweenPositions(t,e){return t.lineNumber===e.lineNumber?new r(0,e.column-t.column):new r(e.lineNumber-t.lineNumber,e.column-1)}static ofRange(t){return r.betweenPositions(t.getStartPosition(),t.getEndPosition())}static ofText(t){let e=0,i=0;for(let n of t)n===`
`?(e++,i=0):i++;return new r(e,i)}isZero(){return this.lineCount===0&&this.columnCount===0}isLessThan(t){return this.lineCount!==t.lineCount?this.lineCount<t.lineCount:this.columnCount<t.columnCount}isGreaterThan(t){return this.lineCount!==t.lineCount?this.lineCount>t.lineCount:this.columnCount>t.columnCount}isGreaterThanOrEqualTo(t){return this.lineCount!==t.lineCount?this.lineCount>t.lineCount:this.columnCount>=t.columnCount}equals(t){return this.lineCount===t.lineCount&&this.columnCount===t.columnCount}compare(t){return this.lineCount!==t.lineCount?this.lineCount-t.lineCount:this.columnCount-t.columnCount}add(t){return t.lineCount===0?new r(this.lineCount,this.columnCount+t.columnCount):new r(this.lineCount+t.lineCount,t.columnCount)}createRange(t){return this.lineCount===0?new L(t.lineNumber,t.column,t.lineNumber,t.column+this.columnCount):new L(t.lineNumber,t.column,t.lineNumber+this.lineCount,this.columnCount+1)}toRange(){return new L(1,1,this.lineCount+1,this.columnCount+1)}addToPosition(t){return this.lineCount===0?new H(t.lineNumber,t.column+this.columnCount):new H(t.lineNumber+this.lineCount,this.columnCount+1)}toString(){return`${this.lineCount},${this.columnCount}`}};var CO=class{constructor(t){this.text=t;this.lineStartOffsetByLineIdx=[],this.lineStartOffsetByLineIdx.push(0);for(let e=0;e<t.length;e++)t.charAt(e)===`
`&&this.lineStartOffsetByLineIdx.push(e+1)}lineStartOffsetByLineIdx;getOffset(t){return this.lineStartOffsetByLineIdx[t.lineNumber-1]+t.column-1}getOffsetRange(t){return new Qe(this.getOffset(t.getStartPosition()),this.getOffset(t.getEndPosition()))}getPosition(t){let e=cm(this.lineStartOffsetByLineIdx,o=>o<=t),i=e+1,n=t-this.lineStartOffsetByLineIdx[e]+1;return new H(i,n)}getRange(t){return L.fromPositions(this.getPosition(t.start),this.getPosition(t.endExclusive))}getTextLength(t){return pr.ofRange(this.getRange(t))}get textLength(){let t=this.lineStartOffsetByLineIdx.length-1;return new pr(t,this.text.length-this.lineStartOffsetByLineIdx[t])}};var lu=class r{constructor(t){this.edits=t;Gc(()=>M_(t,(e,i)=>e.range.getEndPosition().isBeforeOrEqual(i.range.getStartPosition())))}static single(t,e){return new r([new _o(t,e)])}normalize(){let t=[];for(let e of this.edits)if(t.length>0&&t[t.length-1].range.getEndPosition().equals(e.range.getStartPosition())){let i=t[t.length-1];t[t.length-1]=new _o(i.range.plusRange(e.range),i.text+e.text)}else e.isEmpty||t.push(e);return new r(t)}mapPosition(t){let e=0,i=0,n=0;for(let o of this.edits){let s=o.range.getStartPosition(),a=o.range.getEndPosition();if(t.isBeforeOrEqual(s))break;let l=pr.ofText(o.text);if(t.isBefore(a)){let d=new H(s.lineNumber+e,s.column+(s.lineNumber+e===i?n:0)),c=l.addToPosition(d);return wO(d,c)}e+=l.lineCount-(o.range.endLineNumber-o.range.startLineNumber),l.lineCount===0?a.lineNumber!==s.lineNumber?n+=l.columnCount-(a.column-1):n+=l.columnCount-(a.column-s.column):n=l.columnCount,i=a.lineNumber+e}return new H(t.lineNumber+e,t.column+(t.lineNumber+e===i?n:0))}mapRange(t){function e(s){return s instanceof H?s:s.getStartPosition()}function i(s){return s instanceof H?s:s.getEndPosition()}let n=e(this.mapPosition(t.getStartPosition())),o=i(this.mapPosition(t.getEndPosition()));return wO(n,o)}inverseMapPosition(t,e){return this.inverse(e).mapPosition(t)}inverseMapRange(t,e){return this.inverse(e).mapRange(t)}apply(t){let e="",i=new H(1,1);for(let o of this.edits){let s=o.range,a=s.getStartPosition(),l=s.getEndPosition(),d=wO(i,a);d.isEmpty()||(e+=t.getValueOfRange(d)),e+=o.text,i=l}let n=wO(i,t.endPositionExclusive);return n.isEmpty()||(e+=t.getValueOfRange(n)),e}applyToString(t){let e=new wG(t);return this.apply(e)}inverse(t){let e=this.getNewRanges();return new r(this.edits.map((i,n)=>new _o(e[n],t.getValueOfRange(i.range))))}getNewRanges(){let t=[],e=0,i=0,n=0;for(let o of this.edits){let s=pr.ofText(o.text),a=H.lift({lineNumber:o.range.startLineNumber+i,column:o.range.startColumn+(o.range.startLineNumber===e?n:0)}),l=s.createRange(a);t.push(l),i=l.endLineNumber-o.range.endLineNumber,n=l.endColumn-o.range.endColumn,e=o.range.endLineNumber}return t}},_o=class{constructor(t,e){this.range=t;this.text=e}get isEmpty(){return this.range.isEmpty()&&this.text.length===0}static equals(t,e){return t.range.equalsRange(e.range)&&t.text===e.text}toSingleEditOperation(){return{range:this.range,text:this.text}}};function wO(r,t){if(r.lineNumber===t.lineNumber&&r.column===Number.MAX_SAFE_INTEGER)return L.fromPositions(t,t);if(!r.isBeforeOrEqual(t))throw new _t("start must be before end");return new L(r.lineNumber,r.column,t.lineNumber,t.column)}var MD=class{get endPositionExclusive(){return this.length.addToPosition(new H(1,1))}getValue(){return this.getValueOfRange(this.length.toRange())}};var wG=class extends MD{constructor(e){super();this.value=e}_t=new CO(this.value);getValueOfRange(e){return this._t.getOffsetRange(e).substring(this.value)}get length(){return this._t.textLength}};var Ws=class r{static inverse(t,e,i){let n=[],o=1,s=1;for(let l of t){let d=new r(new ht(o,l.original.startLineNumber),new ht(s,l.modified.startLineNumber));d.modified.isEmpty||n.push(d),o=l.original.endLineNumberExclusive,s=l.modified.endLineNumberExclusive}let a=new r(new ht(o,e+1),new ht(s,i+1));return a.modified.isEmpty||n.push(a),n}static clip(t,e,i){let n=[];for(let o of t){let s=o.original.intersect(e),a=o.modified.intersect(i);s&&!s.isEmpty&&a&&!a.isEmpty&&n.push(new r(s,a))}return n}original;modified;constructor(t,e){this.original=t,this.modified=e}toString(){return`{${this.original.toString()}->${this.modified.toString()}}`}flip(){return new r(this.modified,this.original)}join(t){return new r(this.original.join(t.original),this.modified.join(t.modified))}get changedLineCount(){return Math.max(this.original.length,this.modified.length)}toRangeMapping(){let t=this.original.toInclusiveRange(),e=this.modified.toInclusiveRange();if(t&&e)return new ea(t,e);if(this.original.startLineNumber===1||this.modified.startLineNumber===1){if(!(this.modified.startLineNumber===1&&this.original.startLineNumber===1))throw new _t("not a valid diff");return new ea(new L(this.original.startLineNumber,1,this.original.endLineNumberExclusive,1),new L(this.modified.startLineNumber,1,this.modified.endLineNumberExclusive,1))}else return new ea(new L(this.original.startLineNumber-1,Number.MAX_SAFE_INTEGER,this.original.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),new L(this.modified.startLineNumber-1,Number.MAX_SAFE_INTEGER,this.modified.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER))}toRangeMapping2(t,e){if(pie(this.original.endLineNumberExclusive,t)&&pie(this.modified.endLineNumberExclusive,e))return new ea(new L(this.original.startLineNumber,1,this.original.endLineNumberExclusive,1),new L(this.modified.startLineNumber,1,this.modified.endLineNumberExclusive,1));if(!this.original.isEmpty&&!this.modified.isEmpty)return new ea(L.fromPositions(new H(this.original.startLineNumber,1),hC(new H(this.original.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),t)),L.fromPositions(new H(this.modified.startLineNumber,1),hC(new H(this.modified.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),e)));if(this.original.startLineNumber>1&&this.modified.startLineNumber>1)return new ea(L.fromPositions(hC(new H(this.original.startLineNumber-1,Number.MAX_SAFE_INTEGER),t),hC(new H(this.original.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),t)),L.fromPositions(hC(new H(this.modified.startLineNumber-1,Number.MAX_SAFE_INTEGER),e),hC(new H(this.modified.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),e)));throw new _t}};function hC(r,t){if(r.lineNumber<1)return new H(1,1);if(r.lineNumber>t.length)return new H(t.length,t[t.length-1].length+1);let e=t[r.lineNumber-1];return r.column>e.length+1?new H(r.lineNumber,e.length+1):r}function pie(r,t){return r>=1&&r<=t.length}var Ll=class r extends Ws{static fromRangeMappings(t){let e=ht.join(t.map(n=>ht.fromRangeInclusive(n.originalRange))),i=ht.join(t.map(n=>ht.fromRangeInclusive(n.modifiedRange)));return new r(e,i,t)}innerChanges;constructor(t,e,i){super(t,e),this.innerChanges=i}flip(){return new r(this.modified,this.original,this.innerChanges?.map(t=>t.flip()))}withInnerChangesFromLineRanges(){return new r(this.original,this.modified,[this.toRangeMapping()])}},ea=class r{static assertSorted(t){for(let e=1;e<t.length;e++){let i=t[e-1],n=t[e];if(!(i.originalRange.getEndPosition().isBeforeOrEqual(n.originalRange.getStartPosition())&&i.modifiedRange.getEndPosition().isBeforeOrEqual(n.modifiedRange.getStartPosition())))throw new _t("Range mappings must be sorted")}}originalRange;modifiedRange;constructor(t,e){this.originalRange=t,this.modifiedRange=e}toString(){return`{${this.originalRange.toString()}->${this.modifiedRange.toString()}}`}flip(){return new r(this.modifiedRange,this.originalRange)}toTextEdit(t){let e=t.getValueOfRange(this.modifiedRange);return new _o(this.originalRange,e)}};var fI=class{constructor(t,e,i){this.changes=t;this.moves=e;this.hitTimeout=i}},EO=class r{lineRangeMapping;changes;constructor(t,e){this.lineRangeMapping=t,this.changes=e}flip(){return new r(this.lineRangeMapping.flip(),this.changes.map(t=>t.flip()))}};function mC(r,t){return new EG(r,t)}var EG=class{constructor(t,e){this.reducer=t;this.options=e}state={flowing:!1,ended:!1,destroyed:!1};buffer={data:[],error:[]};listeners={data:[],error:[],end:[]};pendingWritePromises=[];pause(){this.state.destroyed||(this.state.flowing=!1)}resume(){this.state.destroyed||this.state.flowing||(this.state.flowing=!0,this.flowData(),this.flowErrors(),this.flowEnd())}write(t){if(!this.state.destroyed){if(this.state.flowing)this.emitData(t);else if(this.buffer.data.push(t),typeof this.options?.highWaterMark=="number"&&this.buffer.data.length>this.options.highWaterMark)return new Promise(e=>this.pendingWritePromises.push(e))}}error(t){this.state.destroyed||(this.state.flowing?this.emitError(t):this.buffer.error.push(t))}end(t){this.state.destroyed||(typeof t<"u"&&this.write(t),this.state.flowing?(this.emitEnd(),this.destroy()):this.state.ended=!0)}emitData(t){this.listeners.data.slice(0).forEach(e=>e(t))}emitError(t){this.listeners.error.length===0?Xe(t):this.listeners.error.slice(0).forEach(e=>e(t))}emitEnd(){this.listeners.end.slice(0).forEach(t=>t())}on(t,e){if(!this.state.destroyed)switch(t){case"data":this.listeners.data.push(e),this.resume();break;case"end":this.listeners.end.push(e),this.state.flowing&&this.flowEnd()&&this.destroy();break;case"error":this.listeners.error.push(e),this.state.flowing&&this.flowErrors();break}}removeListener(t,e){if(this.state.destroyed)return;let i;switch(t){case"data":i=this.listeners.data;break;case"end":i=this.listeners.end;break;case"error":i=this.listeners.error;break}if(i){let n=i.indexOf(e);n>=0&&i.splice(n,1)}}flowData(){if(this.buffer.data.length>0){let t=this.reducer(this.buffer.data);this.emitData(t),this.buffer.data.length=0;let e=[...this.pendingWritePromises];this.pendingWritePromises.length=0,e.forEach(i=>i())}}flowErrors(){if(this.listeners.error.length>0){for(let t of this.buffer.error)this.emitError(t);this.buffer.error.length=0}}flowEnd(){return this.state.ended?(this.emitEnd(),this.listeners.end.length>0):!1}destroy(){this.state.destroyed||(this.state.destroyed=!0,this.state.ended=!0,this.buffer.data.length=0,this.buffer.error.length=0,this.listeners.data.length=0,this.listeners.error.length=0,this.listeners.end.length=0,this.pendingWritePromises.length=0)}};function hie(r,t){return new Promise((e,i)=>{let n=[];xO(r,{onData:o=>{t&&n.push(o)},onError:o=>{t?i(o):e(void 0)},onEnd:()=>{e(t?t(n):void 0)}})})}function xO(r,t,e){r.on("error",i=>{e?.isCancellationRequested||t.onError(i)}),r.on("end",()=>{e?.isCancellationRequested||t.onEnd()}),r.on("data",i=>{e?.isCancellationRequested||t.onData(i)})}function mie(r,t){let e=mC(t);return e.end(r),e}function gie(r){let t=!1;return{read:()=>t?null:(t=!0,r)}}var TO=typeof Buffer<"u",zve=new qn(()=>new Uint8Array(256)),xG,TG,Jt=class r{static alloc(t){return TO?new r(Buffer.allocUnsafe(t)):new r(new Uint8Array(t))}static wrap(t){return TO&&!Buffer.isBuffer(t)&&(t=Buffer.from(t.buffer,t.byteOffset,t.byteLength)),new r(t)}static fromString(t,e){return!(e?.dontUseNodeBuffer||!1)&&TO?new r(Buffer.from(t)):(xG||(xG=new TextEncoder),new r(xG.encode(t)))}static fromByteArray(t){let e=r.alloc(t.length);for(let i=0,n=t.length;i<n;i++)e.buffer[i]=t[i];return e}static concat(t,e){if(typeof e>"u"){e=0;for(let o=0,s=t.length;o<s;o++)e+=t[o].byteLength}let i=r.alloc(e),n=0;for(let o=0,s=t.length;o<s;o++){let a=t[o];i.set(a,n),n+=a.byteLength}return i}buffer;byteLength;constructor(t){this.buffer=t,this.byteLength=this.buffer.byteLength}clone(){let t=r.alloc(this.byteLength);return t.set(this),t}toString(){return TO?this.buffer.toString():(TG||(TG=new TextDecoder),TG.decode(this.buffer))}slice(t,e){return new r(this.buffer.subarray(t,e))}set(t,e){if(t instanceof r)this.buffer.set(t.buffer,e);else if(t instanceof Uint8Array)this.buffer.set(t,e);else if(t instanceof ArrayBuffer)this.buffer.set(new Uint8Array(t),e);else if(ArrayBuffer.isView(t))this.buffer.set(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),e);else throw new Error("Unknown argument 'array'")}readUInt32BE(t){return jr(this.buffer,t)}writeUInt32BE(t,e){Xr(this.buffer,t,e)}readUInt32LE(t){return Gve(this.buffer,t)}writeUInt32LE(t,e){qve(this.buffer,t,e)}readUInt8(t){return _O(this.buffer,t)}writeUInt8(t,e){DO(this.buffer,t,e)}indexOf(t,e=0){return Kve(this.buffer,t instanceof r?t.buffer:t,e)}};function Kve(r,t,e=0){let i=t.byteLength,n=r.byteLength;if(i===0)return 0;if(i===1)return r.indexOf(t[0]);if(i>n-e)return-1;let o=zve.value;o.fill(t.length);for(let d=0;d<t.length;d++)o[t[d]]=t.length-d-1;let s=e+t.length-1,a=s,l=-1;for(;s<n;)if(r[s]===t[a]){if(a===0){l=s;break}s--,a--}else s+=Math.max(t.length-a,o[r[s]]),a=t.length-1;return l}function fie(r,t){return r[t+0]<<0>>>0|r[t+1]<<8>>>0}function bie(r,t,e){r[e+0]=t&255,t=t>>>8,r[e+1]=t&255}function jr(r,t){return r[t]*2**24+r[t+1]*2**16+r[t+2]*2**8+r[t+3]}function Xr(r,t,e){r[e+3]=t,t=t>>>8,r[e+2]=t,t=t>>>8,r[e+1]=t,t=t>>>8,r[e]=t}function Gve(r,t){return r[t+0]<<0>>>0|r[t+1]<<8>>>0|r[t+2]<<16>>>0|r[t+3]<<24>>>0}function qve(r,t,e){r[e+0]=t&255,t=t>>>8,r[e+1]=t&255,t=t>>>8,r[e+2]=t&255,t=t>>>8,r[e+3]=t&255}function _O(r,t){return r[t]}function DO(r,t,e){r[e]=t}function vie(r){return gie(r)}function Iie(r){return hie(r,t=>Jt.concat(t))}function kO(r){return mie(r,t=>Jt.concat(t))}function yie(r){return mC(t=>Jt.concat(t),r)}function AD(r){let t=0,e=0,i=0,n=new Uint8Array(Math.floor(r.length/4*3)),o=a=>{switch(e){case 3:n[i++]=t|a,e=0;break;case 2:n[i++]=t|a>>>2,t=a<<6,e=3;break;case 1:n[i++]=t|a>>>4,t=a<<4,e=2;break;default:t=a<<2,e=1}};for(let a=0;a<r.length;a++){let l=r.charCodeAt(a);if(l>=65&&l<=90)o(l-65);else if(l>=97&&l<=122)o(l-97+26);else if(l>=48&&l<=57)o(l-48+52);else if(l===43||l===45)o(62);else if(l===47||l===95)o(63);else{if(l===61)break;throw new SyntaxError(`Unexpected base64 character ${r[a]}`)}}let s=i;for(;e>0;)o(0);return Jt.wrap(n).slice(0,s)}var $ve="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",jve="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_";function OD({buffer:r},t=!0,e=!1){let i=e?jve:$ve,n="",o=r.byteLength%3,s=0;for(;s<r.byteLength-o;s+=3){let a=r[s+0],l=r[s+1],d=r[s+2];n+=i[a>>>2],n+=i[(a<<4|l>>>4)&63],n+=i[(l<<2|d>>>6)&63],n+=i[d&63]}if(o===1){let a=r[s+0];n+=i[a>>>2],n+=i[a<<4&63],t&&(n+="==")}else if(o===2){let a=r[s+0],l=r[s+1];n+=i[a>>>2],n+=i[(a<<4|l>>>4)&63],n+=i[l<<2&63],t&&(n+="=")}return n}var DG;function Sie(){return DG||(DG=new TextDecoder("UTF-16LE")),DG}var kG;function Xve(){return kG||(kG=new TextDecoder("UTF-16BE")),kG}var LG;function RG(){return LG||(LG=dJ()?Sie():Xve()),LG}function Cie(r,t,e){let i=new Uint16Array(r.buffer,t,e);return e>0&&(i[0]===65279||i[0]===65534)?Yve(r,t,e):Sie().decode(i)}function Yve(r,t,e){let i=[],n=0;for(let o=0;o<e;o++){let s=fie(r,t);t+=2,i[n++]=String.fromCharCode(s)}return i.join("")}var xd=class{_capacity;_buffer;_completedStrings;_bufferLength;constructor(t){this._capacity=t|0,this._buffer=new Uint16Array(this._capacity),this._completedStrings=null,this._bufferLength=0}reset(){this._completedStrings=null,this._bufferLength=0}build(){return this._completedStrings!==null?(this._flushBuffer(),this._completedStrings.join("")):this._buildBuffer()}_buildBuffer(){if(this._bufferLength===0)return"";let t=new Uint16Array(this._buffer.buffer,0,this._bufferLength);return RG().decode(t)}_flushBuffer(){let t=this._buildBuffer();this._bufferLength=0,this._completedStrings===null?this._completedStrings=[t]:this._completedStrings[this._completedStrings.length]=t}appendCharCode(t){let e=this._capacity-this._bufferLength;e<=1&&(e===0||Rn(t))&&this._flushBuffer(),this._buffer[this._bufferLength++]=t}appendASCIICharCode(t){this._bufferLength===this._capacity&&this._flushBuffer(),this._buffer[this._bufferLength++]=t}appendString(t){let e=t.length;if(this._bufferLength+e>=this._capacity){this._flushBuffer(),this._completedStrings[this._completedStrings.length]=t;return}for(let i=0;i<e;i++)this._buffer[this._bufferLength++]=t.charCodeAt(i)}};function LO(r){return r.replace(/\n/g,"\\n").replace(/\r/g,"\\r")}var Rl=class r{constructor(t,e,i,n){this.oldPosition=t;this.oldText=e;this.newPosition=i;this.newText=n}get oldLength(){return this.oldText.length}get oldEnd(){return this.oldPosition+this.oldText.length}get newLength(){return this.newText.length}get newEnd(){return this.newPosition+this.newText.length}toString(){return this.oldText.length===0?`(insert@${this.oldPosition} "${LO(this.newText)}")`:this.newText.length===0?`(delete@${this.oldPosition} "${LO(this.oldText)}")`:`(replace@${this.oldPosition} "${LO(this.oldText)}" with "${LO(this.newText)}")`}static _writeStringSize(t){return 4+2*t.length}static _writeString(t,e,i){let n=e.length;Xr(t,n,i),i+=4;for(let o=0;o<n;o++)bie(t,e.charCodeAt(o),i),i+=2;return i}static _readString(t,e){let i=jr(t,e);return e+=4,Cie(t,e,i)}writeSize(){return 8+r._writeStringSize(this.oldText)+r._writeStringSize(this.newText)}write(t,e){return Xr(t,this.oldPosition,e),e+=4,Xr(t,this.newPosition,e),e+=4,e=r._writeString(t,this.oldText,e),e=r._writeString(t,this.newText,e),e}static read(t,e,i){let n=jr(t,e);e+=4;let o=jr(t,e);e+=4;let s=r._readString(t,e);e+=r._writeStringSize(s);let a=r._readString(t,e);return e+=r._writeStringSize(a),i.push(new r(n,s,o,a)),e}};function wie(r,t){return r===null||r.length===0?t:new PG(r,t).compress()}var PG=class r{_prevEdits;_currEdits;_result;_resultLen;_prevLen;_prevDeltaOffset;_currLen;_currDeltaOffset;constructor(t,e){this._prevEdits=t,this._currEdits=e,this._result=[],this._resultLen=0,this._prevLen=this._prevEdits.length,this._prevDeltaOffset=0,this._currLen=this._currEdits.length,this._currDeltaOffset=0}compress(){let t=0,e=0,i=this._getPrev(t),n=this._getCurr(e);for(;t<this._prevLen||e<this._currLen;){if(i===null){this._acceptCurr(n),n=this._getCurr(++e);continue}if(n===null){this._acceptPrev(i),i=this._getPrev(++t);continue}if(n.oldEnd<=i.newPosition){this._acceptCurr(n),n=this._getCurr(++e);continue}if(i.newEnd<=n.oldPosition){this._acceptPrev(i),i=this._getPrev(++t);continue}if(n.oldPosition<i.newPosition){let[d,c]=r._splitCurr(n,i.newPosition-n.oldPosition);this._acceptCurr(d),n=c;continue}if(i.newPosition<n.oldPosition){let[d,c]=r._splitPrev(i,n.oldPosition-i.newPosition);this._acceptPrev(d),i=c;continue}let a,l;if(n.oldEnd===i.newEnd)a=i,l=n,i=this._getPrev(++t),n=this._getCurr(++e);else if(n.oldEnd<i.newEnd){let[d,c]=r._splitPrev(i,n.oldLength);a=d,l=n,i=c,n=this._getCurr(++e)}else{let[d,c]=r._splitCurr(n,i.newLength);a=i,l=d,i=this._getPrev(++t),n=c}this._result[this._resultLen++]=new Rl(a.oldPosition,a.oldText,l.newPosition,l.newText),this._prevDeltaOffset+=a.newLength-a.oldLength,this._currDeltaOffset+=l.newLength-l.oldLength}let o=r._merge(this._result);return r._removeNoOps(o)}_acceptCurr(t){this._result[this._resultLen++]=r._rebaseCurr(this._prevDeltaOffset,t),this._currDeltaOffset+=t.newLength-t.oldLength}_getCurr(t){return t<this._currLen?this._currEdits[t]:null}_acceptPrev(t){this._result[this._resultLen++]=r._rebasePrev(this._currDeltaOffset,t),this._prevDeltaOffset+=t.newLength-t.oldLength}_getPrev(t){return t<this._prevLen?this._prevEdits[t]:null}static _rebaseCurr(t,e){return new Rl(e.oldPosition-t,e.oldText,e.newPosition,e.newText)}static _rebasePrev(t,e){return new Rl(e.oldPosition,e.oldText,e.newPosition+t,e.newText)}static _splitPrev(t,e){let i=t.newText.substr(0,e),n=t.newText.substr(e);return[new Rl(t.oldPosition,t.oldText,t.newPosition,i),new Rl(t.oldEnd,"",t.newPosition+e,n)]}static _splitCurr(t,e){let i=t.oldText.substr(0,e),n=t.oldText.substr(e);return[new Rl(t.oldPosition,i,t.newPosition,t.newText),new Rl(t.oldPosition+e,n,t.newEnd,"")]}static _merge(t){if(t.length===0)return t;let e=[],i=0,n=t[0];for(let o=1;o<t.length;o++){let s=t[o];n.oldEnd===s.oldPosition?n=new Rl(n.oldPosition,n.oldText+s.oldText,n.newPosition,n.newText+s.newText):(e[i++]=n,n=s)}return e[i++]=n,e}static _removeNoOps(t){if(t.length===0)return t;let e=[],i=0;for(let n=0;n<t.length;n++){let o=t[n];o.oldText!==o.newText&&(e[i++]=o)}return e}};var bI=class r{_asciiMap;_map;_defaultValue;constructor(t){let e=Hv(t);this._defaultValue=e,this._asciiMap=r._createAsciiMap(e),this._map=new Map}static _createAsciiMap(t){let e=new Uint8Array(256);return e.fill(t),e}set(t,e){let i=Hv(e);t>=0&&t<256?this._asciiMap[t]=i:this._map.set(t,i)}get(t){return t>=0&&t<256?this._asciiMap[t]:this._map.get(t)||this._defaultValue}clear(){this._asciiMap.fill(this._defaultValue),this._map.clear()}};var RO=class{_actual;constructor(){this._actual=new bI(0)}add(t){this._actual.set(t,1)}has(t){return this._actual.get(t)===1}clear(){return this._actual.clear()}};var MG=class extends bI{intlSegmenterLocales;_segmenter=null;_cachedLine=null;_cachedSegments=[];constructor(t,e){super(0),this.intlSegmenterLocales=e,this.intlSegmenterLocales.length>0?this._segmenter=new Intl.Segmenter(this.intlSegmenterLocales,{granularity:"word"}):this._segmenter=null;for(let i=0,n=t.length;i<n;i++)this.set(t.charCodeAt(i),2);this.set(32,1),this.set(9,1)}findPrevIntlWordBeforeOrAtOffset(t,e){let i=null;for(let n of this._getIntlSegmenterWordsOnLine(t)){if(n.index>e)break;i=n}return i}findNextIntlWordAtOrAfterOffset(t,e){for(let i of this._getIntlSegmenterWordsOnLine(t))if(!(i.index<e))return i;return null}_getIntlSegmenterWordsOnLine(t){return this._segmenter?this._cachedLine===t?this._cachedSegments:(this._cachedLine=t,this._cachedSegments=this._filterWordSegments(this._segmenter.segment(t)),this._cachedSegments):[]}_filterWordSegments(t){let e=[];for(let i of t)this._isWordLike(i)&&e.push(i);return e}_isWordLike(t){return!!t.isWordLike}},Eie=new zr(10);function Ap(r,t){let e=`${r}/${t.join(",")}`,i=Eie.get(e);return i||(i=new MG(r,t),Eie.set(e,i)),i}function Ef(r,t){let e=Math.pow(10,t);return Math.round(r*e)/e}var xt=class{_rgbaBrand=void 0;r;g;b;a;constructor(t,e,i,n=1){this.r=Math.min(255,Math.max(0,t))|0,this.g=Math.min(255,Math.max(0,e))|0,this.b=Math.min(255,Math.max(0,i))|0,this.a=Ef(Math.max(Math.min(1,n),0),3)}static equals(t,e){return t.r===e.r&&t.g===e.g&&t.b===e.b&&t.a===e.a}},wf=class r{_hslaBrand=void 0;h;s;l;a;constructor(t,e,i,n){this.h=Math.max(Math.min(360,t),0)|0,this.s=Ef(Math.max(Math.min(1,e),0),3),this.l=Ef(Math.max(Math.min(1,i),0),3),this.a=Ef(Math.max(Math.min(1,n),0),3)}static equals(t,e){return t.h===e.h&&t.s===e.s&&t.l===e.l&&t.a===e.a}static fromRGBA(t){let e=t.r/255,i=t.g/255,n=t.b/255,o=t.a,s=Math.max(e,i,n),a=Math.min(e,i,n),l=0,d=0,c=(a+s)/2,p=s-a;if(p>0){switch(d=Math.min(c<=.5?p/(2*c):p/(2-2*c),1),s){case e:l=(i-n)/p+(i<n?6:0);break;case i:l=(n-e)/p+2;break;case n:l=(e-i)/p+4;break}l*=60,l=Math.round(l)}return new r(l,d,c,o)}static _hue2rgb(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+(e-t)*6*i:i<1/2?e:i<2/3?t+(e-t)*(2/3-i)*6:t}static toRGBA(t){let e=t.h/360,{s:i,l:n,a:o}=t,s,a,l;if(i===0)s=a=l=n;else{let d=n<.5?n*(1+i):n+i-n*i,c=2*n-d;s=r._hue2rgb(c,d,e+1/3),a=r._hue2rgb(c,d,e),l=r._hue2rgb(c,d,e-1/3)}return new xt(Math.round(s*255),Math.round(a*255),Math.round(l*255),o)}},pc=class r{_hsvaBrand=void 0;h;s;v;a;constructor(t,e,i,n){this.h=Math.max(Math.min(360,t),0)|0,this.s=Ef(Math.max(Math.min(1,e),0),3),this.v=Ef(Math.max(Math.min(1,i),0),3),this.a=Ef(Math.max(Math.min(1,n),0),3)}static equals(t,e){return t.h===e.h&&t.s===e.s&&t.v===e.v&&t.a===e.a}static fromRGBA(t){let e=t.r/255,i=t.g/255,n=t.b/255,o=Math.max(e,i,n),s=Math.min(e,i,n),a=o-s,l=o===0?0:a/o,d;return a===0?d=0:o===e?d=((i-n)/a%6+6)%6:o===i?d=(n-e)/a+2:d=(e-i)/a+4,new r(Math.round(d*60),l,o,t.a)}static toRGBA(t){let{h:e,s:i,v:n,a:o}=t,s=n*i,a=s*(1-Math.abs(e/60%2-1)),l=n-s,[d,c,p]=[0,0,0];return e<60?(d=s,c=a):e<120?(d=a,c=s):e<180?(c=s,p=a):e<240?(c=a,p=s):e<300?(d=a,p=s):e<=360&&(d=s,p=a),d=Math.round((d+l)*255),c=Math.round((c+l)*255),p=Math.round((p+l)*255),new xt(d,c,p,o)}},j=class r{static fromHex(t){return r.Format.CSS.parseHex(t)||r.red}static equals(t,e){return!t&&!e?!0:!t||!e?!1:t.equals(e)}rgba;_hsla;get hsla(){return this._hsla?this._hsla:wf.fromRGBA(this.rgba)}_hsva;get hsva(){return this._hsva?this._hsva:pc.fromRGBA(this.rgba)}constructor(t){if(t)if(t instanceof xt)this.rgba=t;else if(t instanceof wf)this._hsla=t,this.rgba=wf.toRGBA(t);else if(t instanceof pc)this._hsva=t,this.rgba=pc.toRGBA(t);else throw new Error("Invalid color ctor argument");else throw new Error("Color needs a value")}equals(t){return!!t&&xt.equals(this.rgba,t.rgba)&&wf.equals(this.hsla,t.hsla)&&pc.equals(this.hsva,t.hsva)}getRelativeLuminance(){let t=r._relativeLuminanceForComponent(this.rgba.r),e=r._relativeLuminanceForComponent(this.rgba.g),i=r._relativeLuminanceForComponent(this.rgba.b),n=.2126*t+.7152*e+.0722*i;return Ef(n,4)}static _relativeLuminanceForComponent(t){let e=t/255;return e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)}getContrastRatio(t){let e=this.getRelativeLuminance(),i=t.getRelativeLuminance();return e>i?(e+.05)/(i+.05):(i+.05)/(e+.05)}isDarker(){return(this.rgba.r*299+this.rgba.g*587+this.rgba.b*114)/1e3<128}isLighter(){return(this.rgba.r*299+this.rgba.g*587+this.rgba.b*114)/1e3>=128}isLighterThan(t){let e=this.getRelativeLuminance(),i=t.getRelativeLuminance();return e>i}isDarkerThan(t){let e=this.getRelativeLuminance(),i=t.getRelativeLuminance();return e<i}lighten(t){return new r(new wf(this.hsla.h,this.hsla.s,this.hsla.l+this.hsla.l*t,this.hsla.a))}darken(t){return new r(new wf(this.hsla.h,this.hsla.s,this.hsla.l-this.hsla.l*t,this.hsla.a))}transparent(t){let{r:e,g:i,b:n,a:o}=this.rgba;return new r(new xt(e,i,n,o*t))}isTransparent(){return this.rgba.a===0}isOpaque(){return this.rgba.a===1}opposite(){return new r(new xt(255-this.rgba.r,255-this.rgba.g,255-this.rgba.b,this.rgba.a))}blend(t){let e=t.rgba,i=this.rgba.a,n=e.a,o=i+n*(1-i);if(o<1e-6)return r.transparent;let s=this.rgba.r*i/o+e.r*n*(1-i)/o,a=this.rgba.g*i/o+e.g*n*(1-i)/o,l=this.rgba.b*i/o+e.b*n*(1-i)/o;return new r(new xt(s,a,l,o))}makeOpaque(t){if(this.isOpaque()||t.rgba.a!==1)return this;let{r:e,g:i,b:n,a:o}=this.rgba;return new r(new xt(t.rgba.r-o*(t.rgba.r-e),t.rgba.g-o*(t.rgba.g-i),t.rgba.b-o*(t.rgba.b-n),1))}flatten(...t){let e=t.reduceRight((i,n)=>r._flatten(n,i));return r._flatten(this,e)}static _flatten(t,e){let i=1-t.rgba.a;return new r(new xt(i*e.rgba.r+t.rgba.a*t.rgba.r,i*e.rgba.g+t.rgba.a*t.rgba.g,i*e.rgba.b+t.rgba.a*t.rgba.b))}_toString;toString(){return this._toString||(this._toString=r.Format.CSS.format(this)),this._toString}static getLighterColor(t,e,i){if(t.isLighterThan(e))return t;i=i||.5;let n=t.getRelativeLuminance(),o=e.getRelativeLuminance();return i=i*(o-n)/o,t.lighten(i)}static getDarkerColor(t,e,i){if(t.isDarkerThan(e))return t;i=i||.5;let n=t.getRelativeLuminance(),o=e.getRelativeLuminance();return i=i*(n-o)/n,t.darken(i)}static white=new r(new xt(255,255,255,1));static black=new r(new xt(0,0,0,1));static red=new r(new xt(255,0,0,1));static blue=new r(new xt(0,0,255,1));static green=new r(new xt(0,255,0,1));static cyan=new r(new xt(0,255,255,1));static lightgrey=new r(new xt(211,211,211,1));static transparent=new r(new xt(0,0,0,0))};(t=>{let r;(i=>{let e;(f=>{function n(g){return g.rgba.a===1?`rgb(${g.rgba.r}, ${g.rgba.g}, ${g.rgba.b})`:t.Format.CSS.formatRGBA(g)}f.formatRGB=n;function o(g){return`rgba(${g.rgba.r}, ${g.rgba.g}, ${g.rgba.b}, ${+g.rgba.a.toFixed(2)})`}f.formatRGBA=o;function s(g){return g.hsla.a===1?`hsl(${g.hsla.h}, ${(g.hsla.s*100).toFixed(2)}%, ${(g.hsla.l*100).toFixed(2)}%)`:t.Format.CSS.formatHSLA(g)}f.formatHSL=s;function a(g){return`hsla(${g.hsla.h}, ${(g.hsla.s*100).toFixed(2)}%, ${(g.hsla.l*100).toFixed(2)}%, ${g.hsla.a.toFixed(2)})`}f.formatHSLA=a;function l(g){let v=g.toString(16);return v.length!==2?"0"+v:v}function d(g){return`#${l(g.rgba.r)}${l(g.rgba.g)}${l(g.rgba.b)}`}f.formatHex=d;function c(g,v=!1){return v&&g.rgba.a===1?t.Format.CSS.formatHex(g):`#${l(g.rgba.r)}${l(g.rgba.g)}${l(g.rgba.b)}${l(Math.round(g.rgba.a*255))}`}f.formatHexA=c;function p(g){return g.isOpaque()?t.Format.CSS.formatHex(g):t.Format.CSS.formatRGBA(g)}f.format=p;function h(g){let v=g.length;if(v===0||g.charCodeAt(0)!==35)return null;if(v===7){let I=16*m(g.charCodeAt(1))+m(g.charCodeAt(2)),y=16*m(g.charCodeAt(3))+m(g.charCodeAt(4)),w=16*m(g.charCodeAt(5))+m(g.charCodeAt(6));return new t(new xt(I,y,w,1))}if(v===9){let I=16*m(g.charCodeAt(1))+m(g.charCodeAt(2)),y=16*m(g.charCodeAt(3))+m(g.charCodeAt(4)),w=16*m(g.charCodeAt(5))+m(g.charCodeAt(6)),C=16*m(g.charCodeAt(7))+m(g.charCodeAt(8));return new t(new xt(I,y,w,C/255))}if(v===4){let I=m(g.charCodeAt(1)),y=m(g.charCodeAt(2)),w=m(g.charCodeAt(3));return new t(new xt(16*I+I,16*y+y,16*w+w))}if(v===5){let I=m(g.charCodeAt(1)),y=m(g.charCodeAt(2)),w=m(g.charCodeAt(3)),C=m(g.charCodeAt(4));return new t(new xt(16*I+I,16*y+y,16*w+w,(16*C+C)/255))}return null}f.parseHex=h;function m(g){switch(g){case 48:return 0;case 49:return 1;case 50:return 2;case 51:return 3;case 52:return 4;case 53:return 5;case 54:return 6;case 55:return 7;case 56:return 8;case 57:return 9;case 97:return 10;case 65:return 10;case 98:return 11;case 66:return 11;case 99:return 12;case 67:return 12;case 100:return 13;case 68:return 13;case 101:return 14;case 69:return 14;case 102:return 15;case 70:return 15}return 0}})(e=i.CSS||={})})(r=t.Format||={})})(j||={});var Ni=function(){if(typeof crypto=="object"&&typeof crypto.randomUUID=="function")return crypto.randomUUID.bind(crypto);let r;typeof crypto=="object"&&typeof crypto.getRandomValues=="function"?r=crypto.getRandomValues.bind(crypto):r=function(i){for(let n=0;n<i.length;n++)i[n]=Math.floor(Math.random()*256);return i};let t=new Uint8Array(16),e=[];for(let i=0;i<256;i++)e.push(i.toString(16).padStart(2,"0"));return function(){r(t),t[6]=t[6]&15|64,t[8]=t[8]&63|128;let n=0,o="";return o+=e[t[n++]],o+=e[t[n++]],o+=e[t[n++]],o+=e[t[n++]],o+="-",o+=e[t[n++]],o+=e[t[n++]],o+="-",o+=e[t[n++]],o+=e[t[n++]],o+="-",o+=e[t[n++]],o+=e[t[n++]],o+="-",o+=e[t[n++]],o+=e[t[n++]],o+=e[t[n++]],o+=e[t[n++]],o+=e[t[n++]],o+=e[t[n++]],o}}();var ND=Object.freeze({create:r=>Mo(r.map(t=>t.toString())).join(`\r
`),split:r=>r.split(`\r
`),parse:r=>ND.split(r).filter(t=>!t.startsWith("#"))});var Tie=class r{constructor(t){this.value=t}static sep=".";static None=new r("@@none@@");static Empty=new r("");equals(t){return this.value===t.value}contains(t){return this.equals(t)||this.value===""||t.value.startsWith(this.value+r.sep)}intersects(t){return this.contains(t)||t.contains(this)}append(...t){return new r((this.value?[this.value,...t]:t).join(r.sep))}};var Pl=class{static getLanguageId(t){return(t&255)>>>0}static getTokenType(t){return(t&768)>>>8}static containsBalancedBrackets(t){return(t&1024)!==0}static getFontStyle(t){return(t&30720)>>>11}static getForeground(t){return(t&16744448)>>>15}static getBackground(t){return(t&4278190080)>>>24}static getClassNameFromMetadata(t){let i="mtk"+this.getForeground(t),n=this.getFontStyle(t);return n&1&&(i+=" mtki"),n&2&&(i+=" mtkb"),n&4&&(i+=" mtku"),n&8&&(i+=" mtks"),i}static getInlineStyleFromMetadata(t,e){let i=this.getForeground(t),n=this.getFontStyle(t),o=`color: ${e[i]};`;n&1&&(o+="font-style: italic;"),n&2&&(o+="font-weight: bold;");let s="";return n&4&&(s+=" underline"),n&8&&(s+=" line-through"),s&&(o+=`text-decoration:${s};`),o}static getPresentationFromMetadata(t){let e=this.getForeground(t),i=this.getFontStyle(t);return{foreground:e,italic:!!(i&1),bold:!!(i&2),underline:!!(i&4),strikethrough:!!(i&8)}}};var PO="**",_ie="/",MO="[/\\\\]",AO="[^/\\\\]",Zve=/\//g;function Die(r,t){switch(r){case 0:return"";case 1:return`${AO}*?`;default:return`(?:${MO}|${AO}+${MO}${t?`|${MO}${AO}+`:""})*?`}}function OO(r,t){if(!r)return[];let e=[],i=!1,n=!1,o="";for(let s of r){switch(s){case t:if(!i&&!n){e.push(o),o="";continue}break;case"{":i=!0;break;case"}":i=!1;break;case"[":n=!0;break;case"]":n=!1;break}o+=s}return o&&e.push(o),e}function Mie(r){if(!r)return"";let t="",e=OO(r,_ie);if(e.every(i=>i===PO))t=".*";else{let i=!1;e.forEach((n,o)=>{if(n===PO){if(i)return;t+=Die(2,o===e.length-1)}else{let s=!1,a="",l=!1,d="";for(let c of n){if(c!=="}"&&s){a+=c;continue}if(l&&(c!=="]"||!d)){let p;c==="-"?p=c:(c==="^"||c==="!")&&!d?p="^":c===_ie?p="":p=ba(c),d+=p;continue}switch(c){case"{":s=!0;continue;case"[":l=!0;continue;case"}":{let h=`(?:${OO(a,",").map(m=>Mie(m)).join("|")})`;t+=h,s=!1,a="";break}case"]":{t+="["+d+"]",l=!1,d="";break}case"?":t+=AO;continue;case"*":t+=Die(1);continue;default:t+=ba(c)}}o<e.length-1&&(e[o+1]!==PO||o+2<e.length)&&(t+=MO)}i=n===PO})}return t}var Jve=/^\*\*\/\*\.[\w\.-]+$/,eIe=/^\*\*\/([\w\.-]+)\/?$/,tIe=/^{\*\*\/\*?[\w\.-]+\/?(,\*\*\/\*?[\w\.-]+\/?)*}$/,iIe=/^{\*\*\/\*?[\w\.-]+(\/(\*\*)?)?(,\*\*\/\*?[\w\.-]+(\/(\*\*)?)?)*}$/,nIe=/^\*\*((\/[\w\.-]+)+)\/?$/,oIe=/^([\w\.-]+(\/[\w\.-]+)*)\/?$/,kie=new zr(1e4),Lie=function(){return!1},Op=function(){return null};function OG(r,t){if(!r)return Op;let e;typeof r!="string"?e=r.pattern:e=r,e=e.trim();let i=`${e}_${!!t.trimForExclusions}`,n=kie.get(i);if(n)return Rie(n,r);let o;return Jve.test(e)?n=rIe(e.substr(4),e):(o=eIe.exec(AG(e,t)))?n=sIe(o[1],e):(t.trimForExclusions?iIe:tIe).test(e)?n=aIe(e,t):(o=nIe.exec(AG(e,t)))?n=Pie(o[1].substr(1),e,!0):(o=oIe.exec(AG(e,t)))?n=Pie(o[1],e,!1):n=lIe(e),kie.set(i,n),Rie(n,r)}function Rie(r,t){if(typeof t=="string")return r;let e=function(i,n){return US(i,t.base,!ci)?r(wp(i.substr(t.base.length),Ur),n):null};return e.allBasenames=r.allBasenames,e.allPaths=r.allPaths,e.basenames=r.basenames,e.patterns=r.patterns,e}function AG(r,t){return t.trimForExclusions&&r.endsWith("/**")?r.substr(0,r.length-2):r}function rIe(r,t){return function(e,i){return typeof e=="string"&&e.endsWith(r)?t:null}}function sIe(r,t){let e=`/${r}`,i=`\\${r}`,n=function(s,a){return typeof s!="string"?null:a?a===r?t:null:s===r||s.endsWith(e)||s.endsWith(i)?t:null},o=[r];return n.basenames=o,n.patterns=[t],n.allBasenames=o,n}function aIe(r,t){let e=Aie(r.slice(1,-1).split(",").map(a=>OG(a,t)).filter(a=>a!==Op),r),i=e.length;if(!i)return Op;if(i===1)return e[0];let n=function(a,l){for(let d=0,c=e.length;d<c;d++)if(e[d](a,l))return r;return null},o=e.find(a=>!!a.allBasenames);o&&(n.allBasenames=o.allBasenames);let s=e.reduce((a,l)=>l.allPaths?a.concat(l.allPaths):a,[]);return s.length&&(n.allPaths=s),n}function Pie(r,t,e){let i=Ur===Xt.sep,n=i?r:r.replace(Zve,Ur),o=Ur+n,s=Xt.sep+r,a;return e?a=function(l,d){return typeof l=="string"&&(l===n||l.endsWith(o)||!i&&(l===r||l.endsWith(s)))?t:null}:a=function(l,d){return typeof l=="string"&&(l===n||!i&&l===r)?t:null},a.allPaths=[(e?"*/":"./")+r],a}function lIe(r){try{let t=new RegExp(`^${Mie(r)}$`);return function(e){return t.lastIndex=0,typeof e=="string"&&t.test(e)?r:null}}catch{return Op}}function du(r,t={}){if(!r)return Lie;if(typeof r=="string"||FD(r)){let e=OG(r,t);if(e===Op)return Lie;let i=function(n,o){return!!e(n,o)};return e.allBasenames&&(i.allBasenames=e.allBasenames),e.allPaths&&(i.allPaths=e.allPaths),i}return dIe(r,t)}function FD(r){let t=r;return t?typeof t.base=="string"&&typeof t.pattern=="string":!1}function dIe(r,t){let e=Aie(Object.getOwnPropertyNames(r).map(a=>cIe(a,r[a],t)).filter(a=>a!==Op)),i=e.length;if(!i)return Op;if(!e.some(a=>!!a.requiresSiblings)){if(i===1)return e[0];let a=function(c,p){let h;for(let m=0,f=e.length;m<f;m++){let g=e[m](c,p);if(typeof g=="string")return g;X_(g)&&(h||(h=[]),h.push(g))}return h?(async()=>{for(let m of h){let f=await m;if(typeof f=="string")return f}return null})():null},l=e.find(c=>!!c.allBasenames);l&&(a.allBasenames=l.allBasenames);let d=e.reduce((c,p)=>p.allPaths?c.concat(p.allPaths):c,[]);return d.length&&(a.allPaths=d),a}let n=function(a,l,d){let c,p;for(let h=0,m=e.length;h<m;h++){let f=e[h];f.requiresSiblings&&d&&(l||(l=Eo(a)),c||(c=l.substr(0,l.length-hm(a).length)));let g=f(a,l,c,d);if(typeof g=="string")return g;X_(g)&&(p||(p=[]),p.push(g))}return p?(async()=>{for(let h of p){let m=await h;if(typeof m=="string")return m}return null})():null},o=e.find(a=>!!a.allBasenames);o&&(n.allBasenames=o.allBasenames);let s=e.reduce((a,l)=>l.allPaths?a.concat(l.allPaths):a,[]);return s.length&&(n.allPaths=s),n}function cIe(r,t,e){if(t===!1)return Op;let i=OG(r,e);if(i===Op)return Op;if(typeof t=="boolean")return i;if(t){let n=t.when;if(typeof n=="string"){let o=(s,a,l,d)=>{if(!d||!i(s,a))return null;let c=n.replace("$(basename)",()=>l),p=d(c);return X_(p)?p.then(h=>h?r:null):p?r:null};return o.requiresSiblings=!0,o}}return i}function Aie(r,t){let e=r.filter(a=>!!a.basenames);if(e.length<2)return r;let i=e.reduce((a,l)=>{let d=l.basenames;return d?a.concat(d):a},[]),n;if(t){n=[];for(let a=0,l=i.length;a<l;a++)n.push(t)}else n=e.reduce((a,l)=>{let d=l.patterns;return d?a.concat(d):a},[]);let o=function(a,l){if(typeof a!="string")return null;if(!l){let c;for(c=a.length;c>0;c--){let p=a.charCodeAt(c-1);if(p===47||p===92)break}l=a.substr(c)}let d=i.indexOf(l);return d!==-1?n[d]:null};o.basenames=i,o.patterns=n,o.allBasenames=i;let s=r.filter(a=>!a.basenames);return s.push(o),s}var BD=class{_tokenizationSupports=new Map;_factories=new Map;_onDidChange=new x;onDidChange=this._onDidChange.event;_colorMap;constructor(){this._colorMap=null}handleChange(t){this._onDidChange.fire({changedLanguages:t,changedColorMap:!1})}register(t,e){return this._tokenizationSupports.set(t,e),this.handleChange([t]),le(()=>{this._tokenizationSupports.get(t)===e&&(this._tokenizationSupports.delete(t),this.handleChange([t]))})}get(t){return this._tokenizationSupports.get(t)||null}registerFactory(t,e){this._factories.get(t)?.dispose();let i=new NG(this,t,e);return this._factories.set(t,i),le(()=>{let n=this._factories.get(t);!n||n!==i||(this._factories.delete(t),n.dispose())})}async getOrCreate(t){let e=this.get(t);if(e)return e;let i=this._factories.get(t);return!i||i.isResolved?null:(await i.resolve(),this.get(t))}isResolved(t){if(this.get(t))return!0;let i=this._factories.get(t);return!!(!i||i.isResolved)}setColorMap(t){this._colorMap=t,this._onDidChange.fire({changedLanguages:Array.from(this._tokenizationSupports.keys()),changedColorMap:!0})}getColorMap(){return this._colorMap}getDefaultBackground(){return this._colorMap&&this._colorMap.length>2?this._colorMap[2]:null}},NG=class extends R{constructor(e,i,n){super();this._registry=e;this._languageId=i;this._factory=n}_isDisposed=!1;_resolvePromise=null;_isResolved=!1;get isResolved(){return this._isResolved}dispose(){this._isDisposed=!0,super.dispose()}async resolve(){return this._resolvePromise||(this._resolvePromise=this._create()),this._resolvePromise}async _create(){let e=await this._factory.tokenizationSupport;this._isResolved=!0,e&&!this._isDisposed&&this._register(this._registry.register(this._languageId,e))}};function nl(r){let t=0,e=0,i=0,n=0;for(let o=0,s=r.length;o<s;o++){let a=r.charCodeAt(o);a===13?(t===0&&(e=o),t++,o+1<s&&r.charCodeAt(o+1)===10?(n|=2,o++):n|=3,i=o+1):a===10&&(n|=1,t===0&&(e=o),t++,i=o+1)}return t===0&&(e=r.length),[t,e,r.length-i,n]}var FG=class r{constructor(t){this._tokenInfo=t}static create(t){return new r(t)}forEach(t){let e=0;for(let i of this._tokenInfo){let n=new Qe(e,e+i.length);t(n,i),e+=i.length}}slice(t){let e=[],i=0;for(let n of this._tokenInfo){let o=i,s=o+n.length;if(s>t.start){if(o>=t.endExclusive)break;let a=Math.max(0,t.start-o),l=Math.max(0,s-t.endExclusive);e.push(new FO(n.length-a-l,n.metadata))}i+=n.length}return r.create(e)}},FO=class{constructor(t,e){this.length=t;this.metadata=e}},BO=class{_tokens=[];add(t,e){this._tokens.push(new FO(t,e))}build(){return FG.create(this._tokens)}};var io=class r{static createEmpty(t,e){let i=r.defaultTokenMetadata,n=new Uint32Array(2);return n[0]=t.length,n[1]=i,new r(n,t,e)}static createFromTextAndMetadata(t,e){let i=0,n="",o=new Array;for(let{text:s,metadata:a}of t)o.push(i+s.length,a),i+=s.length,n+=s;return new r(new Uint32Array(o),n,e)}static convertToEndOffset(t,e){let n=(t.length>>>1)-1;for(let o=0;o<n;o++)t[o<<1]=t[o+1<<1];t[n<<1]=e}static findIndexInTokensArray(t,e){if(t.length<=2)return 0;let i=0,n=(t.length>>>1)-1;for(;i<n;){let o=i+Math.floor((n-i)/2),s=t[o<<1];if(s===e)return o+1;s<e?i=o+1:s>e&&(n=o)}return i}_lineTokensBrand=void 0;_tokens;_tokensCount;_text;languageIdCodec;static defaultTokenMetadata=(32768|2<<24)>>>0;constructor(t,e,i){this._tokens=t,this._tokensCount=this._tokens.length>>>1,this._text=e,this.languageIdCodec=i}equals(t){return t instanceof r?this.slicedEquals(t,0,this._tokensCount):!1}slicedEquals(t,e,i){if(this._text!==t._text||this._tokensCount!==t._tokensCount)return!1;let n=e<<1,o=n+(i<<1);for(let s=n;s<o;s++)if(this._tokens[s]!==t._tokens[s])return!1;return!0}getLineContent(){return this._text}getCount(){return this._tokensCount}getStartOffset(t){return t>0?this._tokens[t-1<<1]:0}getMetadata(t){return this._tokens[(t<<1)+1]}getLanguageId(t){let e=this._tokens[(t<<1)+1],i=Pl.getLanguageId(e);return this.languageIdCodec.decodeLanguageId(i)}getStandardTokenType(t){let e=this._tokens[(t<<1)+1];return Pl.getTokenType(e)}getForeground(t){let e=this._tokens[(t<<1)+1];return Pl.getForeground(e)}getClassName(t){let e=this._tokens[(t<<1)+1];return Pl.getClassNameFromMetadata(e)}getInlineStyle(t,e){let i=this._tokens[(t<<1)+1];return Pl.getInlineStyleFromMetadata(i,e)}getPresentation(t){let e=this._tokens[(t<<1)+1];return Pl.getPresentationFromMetadata(e)}getEndOffset(t){return this._tokens[t<<1]}findTokenIndexAtOffset(t){return r.findIndexInTokensArray(this._tokens,t)}inflate(){return this}sliceAndInflate(t,e,i){return new BG(this,t,e,i)}withInserted(t){if(t.length===0)return this;let e=0,i=0,n="",o=new Array,s=0;for(;;){let a=e<this._tokensCount?this._tokens[e<<1]:-1,l=i<t.length?t[i]:null;if(a!==-1&&(l===null||a<=l.offset)){n+=this._text.substring(s,a);let d=this._tokens[(e<<1)+1];o.push(n.length,d),e++,s=a}else if(l){if(l.offset>s){n+=this._text.substring(s,l.offset);let d=this._tokens[(e<<1)+1];o.push(n.length,d),s=l.offset}n+=l.text,o.push(n.length,l.tokenMetadata),i++}else break}return new r(new Uint32Array(o),n,this.languageIdCodec)}getTokensInRange(t){let e=new BO,i=this.findTokenIndexAtOffset(t.start),n=this.findTokenIndexAtOffset(t.endExclusive);for(let o=i;o<=n;o++){let a=new Qe(this.getStartOffset(o),this.getEndOffset(o)).intersectionLength(t);a>0&&e.add(a,this.getMetadata(o))}return e.build()}getTokenText(t){let e=this.getStartOffset(t),i=this.getEndOffset(t);return this._text.substring(e,i)}forEach(t){let e=this.getCount();for(let i=0;i<e;i++)t(i)}},BG=class r{_source;_startOffset;_endOffset;_deltaOffset;_firstTokenIndex;_tokensCount;languageIdCodec;constructor(t,e,i,n){this._source=t,this._startOffset=e,this._endOffset=i,this._deltaOffset=n,this._firstTokenIndex=t.findTokenIndexAtOffset(e),this.languageIdCodec=t.languageIdCodec,this._tokensCount=0;for(let o=this._firstTokenIndex,s=t.getCount();o<s&&!(t.getStartOffset(o)>=i);o++)this._tokensCount++}getMetadata(t){return this._source.getMetadata(this._firstTokenIndex+t)}getLanguageId(t){return this._source.getLanguageId(this._firstTokenIndex+t)}getLineContent(){return this._source.getLineContent().substring(this._startOffset,this._endOffset)}equals(t){return t instanceof r?this._startOffset===t._startOffset&&this._endOffset===t._endOffset&&this._deltaOffset===t._deltaOffset&&this._source.slicedEquals(t._source,this._firstTokenIndex,this._tokensCount):!1}getCount(){return this._tokensCount}getStandardTokenType(t){return this._source.getStandardTokenType(this._firstTokenIndex+t)}getForeground(t){return this._source.getForeground(this._firstTokenIndex+t)}getEndOffset(t){let e=this._source.getEndOffset(this._firstTokenIndex+t);return Math.min(this._endOffset,e)-this._startOffset+this._deltaOffset}getClassName(t){return this._source.getClassName(this._firstTokenIndex+t)}getInlineStyle(t,e){return this._source.getInlineStyle(this._firstTokenIndex+t,e)}getPresentation(t){return this._source.getPresentation(this._firstTokenIndex+t)}findTokenIndexAtOffset(t){return this._source.findTokenIndexAtOffset(t+this._startOffset-this._deltaOffset)-this._firstTokenIndex}getTokenText(t){let e=this._firstTokenIndex+t,i=this._source.getStartOffset(e),n=this._source.getEndOffset(e),o=this._source.getTokenText(e);return i<this._startOffset&&(o=o.substring(this._startOffset-i)),n>this._endOffset&&(o=o.substring(0,o.length-(n-this._endOffset))),o}forEach(t){for(let e=0;e<this.getCount();e++)t(e)}};var Np=new Uint32Array(0).buffer,Yr=class r{static deleteBeginning(t,e){return t===null||t===Np?t:r.delete(t,0,e)}static deleteEnding(t,e){if(t===null||t===Np)return t;let i=Fp(t),n=i[i.length-2];return r.delete(t,e,n)}static delete(t,e,i){if(t===null||t===Np||e===i)return t;let n=Fp(t),o=n.length>>>1;if(e===0&&n[n.length-2]===i)return Np;let s=io.findIndexInTokensArray(n,e),a=s>0?n[s-1<<1]:0,l=n[s<<1];if(i<l){let m=i-e;for(let f=s;f<o;f++)n[f<<1]-=m;return t}let d,c;a!==e?(n[s<<1]=e,d=s+1<<1,c=e):(d=s<<1,c=a);let p=i-e;for(let m=s+1;m<o;m++){let f=n[m<<1]-p;f>c&&(n[d++]=f,n[d++]=n[(m<<1)+1],c=f)}if(d===n.length)return t;let h=new Uint32Array(d);return h.set(n.subarray(0,d),0),h.buffer}static append(t,e){if(e===Np)return t;if(t===Np)return e;if(t===null)return t;if(e===null)return null;let i=Fp(t),n=Fp(e),o=n.length>>>1,s=new Uint32Array(i.length+n.length);s.set(i,0);let a=i.length,l=i[i.length-2];for(let d=0;d<o;d++)s[a++]=n[d<<1]+l,s[a++]=n[(d<<1)+1];return s.buffer}static insert(t,e,i){if(t===null||t===Np)return t;let n=Fp(t),o=n.length>>>1,s=io.findIndexInTokensArray(n,e);s>0&&n[s-1<<1]===e&&s--;for(let a=s;a<o;a++)n[a<<1]+=i;return t}};function Fp(r){return r instanceof Uint32Array?r:new Uint32Array(r)}var VD=class r{static deserialize(t,e,i){let n=new Uint32Array(t.buffer),o=jr(t,e);e+=4;let s=jr(t,e);e+=4;let a=[];for(let l=0;l<s;l++){let d=jr(t,e);e+=4,a.push(n.subarray(e/4,e/4+d/4)),e+=d}return i.push(new r(o,a)),e}_startLineNumber;_tokens;get startLineNumber(){return this._startLineNumber}get endLineNumber(){return this._startLineNumber+this._tokens.length-1}constructor(t,e){this._startLineNumber=t,this._tokens=e}getLineRange(){return new ht(this._startLineNumber,this._startLineNumber+this._tokens.length)}getLineTokens(t){return this._tokens[t-this._startLineNumber]}appendLineTokens(t){this._tokens.push(t)}serializeSize(){let t=0;t+=4,t+=4;for(let e=0;e<this._tokens.length;e++){let i=this._tokens[e];if(!(i instanceof Uint32Array))throw new Error("Not supported!");t+=4,t+=i.byteLength}return t}serialize(t,e){Xr(t,this._startLineNumber,e),e+=4,Xr(t,this._tokens.length,e),e+=4;for(let i=0;i<this._tokens.length;i++){let n=this._tokens[i];if(!(n instanceof Uint32Array))throw new Error("Not supported!");Xr(t,n.byteLength,e),e+=4,t.set(new Uint8Array(n.buffer),e),e+=n.byteLength}return e}applyEdit(t,e){let[i,n]=nl(e);this._acceptDeleteRange(t),this._acceptInsertText(new H(t.startLineNumber,t.startColumn),i,n)}_acceptDeleteRange(t){if(t.startLineNumber===t.endLineNumber&&t.startColumn===t.endColumn)return;let e=t.startLineNumber-this._startLineNumber,i=t.endLineNumber-this._startLineNumber;if(i<0){let n=i-e;this._startLineNumber-=n;return}if(!(e>=this._tokens.length)){if(e<0&&i>=this._tokens.length){this._startLineNumber=0,this._tokens=[];return}if(e===i){this._tokens[e]=Yr.delete(this._tokens[e],t.startColumn-1,t.endColumn-1);return}if(e>=0)if(this._tokens[e]=Yr.deleteEnding(this._tokens[e],t.startColumn-1),i<this._tokens.length){let n=Yr.deleteBeginning(this._tokens[i],t.endColumn-1);this._tokens[e]=Yr.append(this._tokens[e],n),this._tokens.splice(e+1,i-e)}else this._tokens[e]=Yr.append(this._tokens[e],null),this._tokens=this._tokens.slice(0,e+1);else{let n=-e;this._startLineNumber-=n,this._tokens[i]=Yr.deleteBeginning(this._tokens[i],t.endColumn-1),this._tokens=this._tokens.slice(i)}}}_acceptInsertText(t,e,i){if(e===0&&i===0)return;let n=t.lineNumber-this._startLineNumber;if(n<0){this._startLineNumber+=e;return}if(!(n>=this._tokens.length)){if(e===0){this._tokens[n]=Yr.insert(this._tokens[n],t.column-1,i);return}this._tokens[n]=Yr.deleteEnding(this._tokens[n],t.column-1),this._tokens[n]=Yr.insert(this._tokens[n],t.column-1,i),this._insertLines(t.lineNumber,e)}}_insertLines(t,e){if(e===0)return;let i=[];for(let n=0;n<e;n++)i[n]=null;this._tokens=gp(this._tokens,t,i)}};var VO=(n=>(n[n.Ignore=0]="Ignore",n[n.Info=1]="Info",n[n.Warning=2]="Warning",n[n.Error=3]="Error",n))(VO||{});(a=>{let r="error",t="warning",e="warn",i="info",n="ignore";function o(l){return l?dr(r,l)?3:dr(t,l)||dr(e,l)?2:dr(i,l)?1:0:0}a.fromValue=o;function s(l){switch(l){case 3:return r;case 2:return t;case 1:return i;default:return n}}a.toString=s})(VO||={});var Si=VO;function WG(r){if(!r)return;let t=r.indexOf("+");return t<0?r:r.substr(0,t)}var Nie=["AI","Azure","Chat","Data Science","Debuggers","Extension Packs","Education","Formatters","Keymaps","Language Packs","Linters","Machine Learning","Notebooks","Programming Languages","SCM Providers","Snippets","Testing","Themes","Visualization","Other"];var Qr=class{value;_lower;constructor(t){this.value=t,this._lower=t.toLowerCase()}static equals(t,e){if(typeof t>"u"||t===null)return typeof e>"u"||e===null;if(typeof e>"u"||e===null)return!1;if(typeof t=="string"||typeof e=="string"){let i=typeof t=="string"?t:t.value,n=typeof e=="string"?e:e.value;return dr(i,n)}return t._lower===e._lower}static toKey(t){return typeof t=="string"?t.toLowerCase():t._lower}},WD=class{_set=new Set;get size(){return this._set.size}constructor(t){if(t)for(let e of t)this.add(e)}add(t){this._set.add(Qr.toKey(t))}delete(t){return this._set.delete(Qr.toKey(t))}has(t){return this._set.has(Qr.toKey(t))}};var BUe=q("IBuiltinExtensionsScannerService");var II=(n=>(n[n.Hint=1]="Hint",n[n.Info=2]="Info",n[n.Warning=4]="Warning",n[n.Error=8]="Error",n))(II||{});(o=>{function r(s,a){return a-s}o.compare=r;let t=Object.create(null);t[8]=u("sev.error","Error"),t[4]=u("sev.warning","Warning"),t[2]=u("sev.info","Info");function e(s){return t[s]||""}o.toString=e;function i(s){switch(s){case Si.Error:return 8;case Si.Warning:return 4;case Si.Info:return 2;case Si.Ignore:return 1}}o.fromSeverity=i;function n(s){switch(s){case 8:return Si.Error;case 4:return Si.Warning;case 2:return Si.Info;case 1:return Si.Ignore}}o.toSeverity=n})(II||={});var uIe;(i=>{let r="";function t(n){return e(n,!0)}i.makeKey=t;function e(n,o){let s=[r];return n.source?s.push(n.source.replace("\xA6","\\\xA6")):s.push(r),n.code?typeof n.code=="string"?s.push(n.code.replace("\xA6","\\\xA6")):s.push(n.code.value.replace("\xA6","\\\xA6")):s.push(r),n.severity!==void 0&&n.severity!==null?s.push(II.toString(n.severity)):s.push(r),n.message&&o?s.push(n.message.replace("\xA6","\\\xA6")):s.push(r),n.startLineNumber!==void 0&&n.startLineNumber!==null?s.push(n.startLineNumber.toString()):s.push(r),n.startColumn!==void 0&&n.startColumn!==null?s.push(n.startColumn.toString()):s.push(r),n.endLineNumber!==void 0&&n.endLineNumber!==null?s.push(n.endLineNumber.toString()):s.push(r),n.endColumn!==void 0&&n.endColumn!==null?s.push(n.endColumn.toString()):s.push(r),s.push(r),s.join("\xA6")}i.makeKeyOptionalMessage=e})(uIe||={});var WO=q("markerService");var HO=class{constructor(t,e){this.tokens=t;this.endState=e}_encodedTokenizationResultBrand=void 0};var xf;(n=>{let r=new Map;r.set(0,N.symbolMethod),r.set(1,N.symbolFunction),r.set(2,N.symbolConstructor),r.set(3,N.symbolField),r.set(4,N.symbolVariable),r.set(5,N.symbolClass),r.set(6,N.symbolStruct),r.set(7,N.symbolInterface),r.set(8,N.symbolModule),r.set(9,N.symbolProperty),r.set(10,N.symbolEvent),r.set(11,N.symbolOperator),r.set(12,N.symbolUnit),r.set(13,N.symbolValue),r.set(15,N.symbolEnum),r.set(14,N.symbolConstant),r.set(15,N.symbolEnum),r.set(16,N.symbolEnumMember),r.set(17,N.symbolKeyword),r.set(27,N.symbolSnippet),r.set(18,N.symbolText),r.set(19,N.symbolColor),r.set(20,N.symbolFile),r.set(21,N.symbolReference),r.set(22,N.symbolCustomColor),r.set(23,N.symbolFolder),r.set(24,N.symbolTypeParameter),r.set(25,N.account),r.set(26,N.issues);function t(o){let s=r.get(o);return s||(console.info("No codicon found for CompletionItemKind "+o),s=N.symbolProperty),s}n.toIcon=t;let e=new Map;e.set("method",0),e.set("function",1),e.set("constructor",2),e.set("field",3),e.set("variable",4),e.set("class",5),e.set("struct",6),e.set("interface",7),e.set("module",8),e.set("property",9),e.set("event",10),e.set("operator",11),e.set("unit",12),e.set("value",13),e.set("constant",14),e.set("enum",15),e.set("enum-member",16),e.set("enumMember",16),e.set("keyword",17),e.set("snippet",27),e.set("text",18),e.set("color",19),e.set("file",20),e.set("reference",21),e.set("customcolor",22),e.set("folder",23),e.set("type-parameter",24),e.set("typeParameter",24),e.set("account",25),e.set("issue",26);function i(o,s){let a=e.get(o);return typeof a>"u"&&!s&&(a=9),a}n.fromString=i})(xf||={});function Bie(r){return r&&Z.isUri(r.uri)&&L.isIRange(r.range)&&(L.isIRange(r.originSelectionRange)||L.isIRange(r.targetSelectionRange))}var F2e={17:u("Array","array"),16:u("Boolean","boolean"),4:u("Class","class"),13:u("Constant","constant"),8:u("Constructor","constructor"),9:u("Enum","enumeration"),21:u("EnumMember","enumeration member"),23:u("Event","event"),7:u("Field","field"),0:u("File","file"),11:u("Function","function"),10:u("Interface","interface"),19:u("Key","key"),5:u("Method","method"),1:u("Module","module"),2:u("Namespace","namespace"),20:u("Null","null"),15:u("Number","number"),18:u("Object","object"),24:u("Operator","operator"),3:u("Package","package"),6:u("Property","property"),14:u("String","string"),22:u("Struct","struct"),25:u("TypeParameter","type parameter"),12:u("Variable","variable")};var HG;(e=>{let r=new Map;r.set(0,N.symbolFile),r.set(1,N.symbolModule),r.set(2,N.symbolNamespace),r.set(3,N.symbolPackage),r.set(4,N.symbolClass),r.set(5,N.symbolMethod),r.set(6,N.symbolProperty),r.set(7,N.symbolField),r.set(8,N.symbolConstructor),r.set(9,N.symbolEnum),r.set(10,N.symbolInterface),r.set(11,N.symbolFunction),r.set(12,N.symbolVariable),r.set(13,N.symbolConstant),r.set(14,N.symbolString),r.set(15,N.symbolNumber),r.set(16,N.symbolBoolean),r.set(17,N.symbolArray),r.set(18,N.symbolObject),r.set(19,N.symbolKey),r.set(20,N.symbolNull),r.set(21,N.symbolEnumMember),r.set(22,N.symbolStruct),r.set(23,N.symbolEvent),r.set(24,N.symbolOperator),r.set(25,N.symbolTypeParameter);function t(i){let n=r.get(i);return n||(console.info("No codicon found for SymbolKind "+i),n=N.symbolProperty),n}e.toIcon=t})(HG||={});var Fie=class r{constructor(t){this.value=t}static Comment=new r("comment");static Imports=new r("imports");static Region=new r("region");static fromValue(t){switch(t){case"comment":return r.Comment;case"imports":return r.Imports;case"region":return r.Region}return new r(t)}};var UG;(t=>{function r(e){return!e||typeof e!="object"?!1:typeof e.id=="string"&&typeof e.title=="string"}t.is=r})(UG||={});var Is=new BD,HD=new BD;var ti=q("languageService");function Bp(r,t){let e=r.getCount(),i=r.findTokenIndexAtOffset(t),n=r.getLanguageId(i),o=i;for(;o+1<e&&r.getLanguageId(o+1)===n;)o++;let s=i;for(;s>0&&r.getLanguageId(s-1)===n;)s--;return new zG(r,n,s,o+1,r.getStartOffset(s),r.getEndOffset(o))}var zG=class{_scopedLineTokensBrand=void 0;languageIdCodec;languageId;_actual;_firstTokenIndex;_lastTokenIndex;firstCharOffset;_lastCharOffset;constructor(t,e,i,n,o,s){this._actual=t,this.languageId=e,this._firstTokenIndex=i,this._lastTokenIndex=n,this.firstCharOffset=o,this._lastCharOffset=s,this.languageIdCodec=t.languageIdCodec}getLineContent(){return this._actual.getLineContent().substring(this.firstCharOffset,this._lastCharOffset)}getLineLength(){return this._lastCharOffset-this.firstCharOffset}getActualLineContentBefore(t){return this._actual.getLineContent().substring(0,this.firstCharOffset+t)}getTokenCount(){return this._lastTokenIndex-this._firstTokenIndex}findTokenIndexAtOffset(t){return this._actual.findTokenIndexAtOffset(t+this.firstCharOffset)-this._firstTokenIndex}getStandardTokenType(t){return this._actual.getStandardTokenType(t+this._firstTokenIndex)}toIViewLineTokens(){return this._actual.sliceAndInflate(this.firstCharOffset,this._lastCharOffset,0)}},Wie=(t=>(t[t.value=3]="value",t))(Wie||{});function hc(r){return(r&Wie.value)!==0}var fC=class{open;close;_inString;_inComment;_inRegEx;_neutralCharacter=null;_neutralCharacterSearched=!1;constructor(t){if(this.open=t.open,this.close=t.close,this._inString=!0,this._inComment=!0,this._inRegEx=!0,Array.isArray(t.notIn))for(let e=0,i=t.notIn.length;e<i;e++)switch(t.notIn[e]){case"string":this._inString=!1;break;case"comment":this._inComment=!1;break;case"regex":this._inRegEx=!1;break}}isOK(t){switch(t){case 0:return!0;case 1:return this._inComment;case 2:return this._inString;case 3:return this._inRegEx}}shouldAutoClose(t,e){if(t.getTokenCount()===0)return!0;let i=t.findTokenIndexAtOffset(e-2),n=t.getStandardTokenType(i);return this.isOK(n)}_findNeutralCharacterInRange(t,e){for(let i=t;i<=e;i++){let n=String.fromCharCode(i);if(!this.open.includes(n)&&!this.close.includes(n))return n}return null}findNeutralCharacter(){return this._neutralCharacterSearched||(this._neutralCharacterSearched=!0,this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(48,57)),this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(97,122)),this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(65,90))),this._neutralCharacter}},UO=class{autoClosingPairsOpenByStart;autoClosingPairsOpenByEnd;autoClosingPairsCloseByStart;autoClosingPairsCloseByEnd;autoClosingPairsCloseSingleChar;constructor(t){this.autoClosingPairsOpenByStart=new Map,this.autoClosingPairsOpenByEnd=new Map,this.autoClosingPairsCloseByStart=new Map,this.autoClosingPairsCloseByEnd=new Map,this.autoClosingPairsCloseSingleChar=new Map;for(let e of t)UD(this.autoClosingPairsOpenByStart,e.open.charAt(0),e),UD(this.autoClosingPairsOpenByEnd,e.open.charAt(e.open.length-1),e),UD(this.autoClosingPairsCloseByStart,e.close.charAt(0),e),UD(this.autoClosingPairsCloseByEnd,e.close.charAt(e.close.length-1),e),e.close.length===1&&e.open.length===1&&UD(this.autoClosingPairsCloseSingleChar,e.close,e)}};function UD(r,t,e){r.has(t)?r.get(t).push(e):r.set(t,[e])}var KG=class r{_richEditBracketBrand=void 0;languageId;index;open;close;forwardRegex;reversedRegex;_openSet;_closeSet;constructor(t,e,i,n,o,s){this.languageId=t,this.index=e,this.open=i,this.close=n,this.forwardRegex=o,this.reversedRegex=s,this._openSet=r._toSet(this.open),this._closeSet=r._toSet(this.close)}isOpen(t){return this._openSet.has(t)}isClose(t){return this._closeSet.has(t)}static _toSet(t){let e=new Set;for(let i of t)e.add(i);return e}};function pIe(r){let t=r.length;r=r.map(s=>[s[0].toLowerCase(),s[1].toLowerCase()]);let e=[];for(let s=0;s<t;s++)e[s]=s;let i=(s,a)=>{let[l,d]=s,[c,p]=a;return l===c||l===p||d===c||d===p},n=(s,a)=>{let l=Math.min(s,a),d=Math.max(s,a);for(let c=0;c<t;c++)e[c]===d&&(e[c]=l)};for(let s=0;s<t;s++){let a=r[s];for(let l=s+1;l<t;l++){let d=r[l];i(a,d)&&n(e[s],e[l])}}let o=[];for(let s=0;s<t;s++){let a=[],l=[];for(let d=0;d<t;d++)if(e[d]===s){let[c,p]=r[d];a.push(c),l.push(p)}a.length>0&&o.push({open:a,close:l})}return o}var zO=class{_richEditBracketsBrand=void 0;brackets;forwardRegex;reversedRegex;maxBracketLength;textIsBracket;textIsOpenBracket;constructor(t,e){let i=pIe(e);this.brackets=i.map((n,o)=>new KG(t,o,n.open,n.close,hIe(n.open,n.close,i,o),mIe(n.open,n.close,i,o))),this.forwardRegex=gIe(this.brackets),this.reversedRegex=fIe(this.brackets),this.textIsBracket={},this.textIsOpenBracket={},this.maxBracketLength=0;for(let n of this.brackets){for(let o of n.open)this.textIsBracket[o]=n,this.textIsOpenBracket[o]=!0,this.maxBracketLength=Math.max(this.maxBracketLength,o.length);for(let o of n.close)this.textIsBracket[o]=n,this.textIsOpenBracket[o]=!1,this.maxBracketLength=Math.max(this.maxBracketLength,o.length)}}};function Hie(r,t,e,i){for(let n=0,o=t.length;n<o;n++){if(n===e)continue;let s=t[n];for(let a of s.open)a.indexOf(r)>=0&&i.push(a);for(let a of s.close)a.indexOf(r)>=0&&i.push(a)}}function Uie(r,t){return r.length-t.length}function KO(r){if(r.length<=1)return r;let t=[],e=new Set;for(let i of r)e.has(i)||(t.push(i),e.add(i));return t}function hIe(r,t,e,i){let n=[];n=n.concat(r),n=n.concat(t);for(let o=0,s=n.length;o<s;o++)Hie(n[o],e,i,n);return n=KO(n),n.sort(Uie),n.reverse(),bC(n)}function mIe(r,t,e,i){let n=[];n=n.concat(r),n=n.concat(t);for(let o=0,s=n.length;o<s;o++)Hie(n[o],e,i,n);return n=KO(n),n.sort(Uie),n.reverse(),bC(n.map(GG))}function gIe(r){let t=[];for(let e of r){for(let i of e.open)t.push(i);for(let i of e.close)t.push(i)}return t=KO(t),bC(t)}function fIe(r){let t=[];for(let e of r){for(let i of e.open)t.push(i);for(let i of e.close)t.push(i)}return t=KO(t),bC(t.map(GG))}function bIe(r){let t=/^[\w ]+$/.test(r);return r=ba(r),t?`\\b${r}\\b`:r}function bC(r,t){let e=`(${r.map(bIe).join(")|(")})`;return hA(e,!0,t)}var GG=function(){function r(i){let n=new Uint16Array(i.length),o=0;for(let s=i.length-1;s>=0;s--)n[o++]=i.charCodeAt(s);return RG().decode(n)}let t=null,e=null;return function(n){return t!==n&&(t=n,e=r(t)),e}}(),Ca=class{static _findPrevBracketInText(t,e,i,n){let o=i.match(t);if(!o)return null;let s=i.length-(o.index||0),a=o[0].length,l=n+s;return new L(e,l-a+1,e,l+1)}static findPrevBracketInRange(t,e,i,n,o){let a=GG(i).substring(i.length-o,i.length-n);return this._findPrevBracketInText(t,e,a,n)}static findNextBracketInText(t,e,i,n){let o=i.match(t);if(!o)return null;let s=o.index||0,a=o[0].length;if(a===0)return null;let l=n+s;return new L(e,l+1,e,l+1+a)}static findNextBracketInRange(t,e,i,n,o){let s=i.substring(n,o);return this.findNextBracketInText(t,e,s,n)}};var GO=class{constructor(t,e){this.languageId=t;let i=e.brackets?zie(e.brackets):[],n=new Yg(a=>{let l=new Set;return{info:new qG(this,a,l),closing:l}}),o=new Yg(a=>{let l=new Set,d=new Set;return{info:new $G(this,a,l,d),opening:l,openingColorized:d}});for(let[a,l]of i){let d=n.get(a),c=o.get(l);d.closing.add(c.info),c.opening.add(d.info)}let s=e.colorizedBracketPairs?zie(e.colorizedBracketPairs):i.filter(a=>!(a[0]==="<"&&a[1]===">"));for(let[a,l]of s){let d=n.get(a),c=o.get(l);d.closing.add(c.info),c.openingColorized.add(d.info),c.opening.add(d.info)}this._openingBrackets=new Map([...n.cachedValues].map(([a,l])=>[a,l.info])),this._closingBrackets=new Map([...o.cachedValues].map(([a,l])=>[a,l.info]))}_openingBrackets;_closingBrackets;get openingBrackets(){return[...this._openingBrackets.values()]}get closingBrackets(){return[...this._closingBrackets.values()]}getOpeningBracketInfo(t){return this._openingBrackets.get(t)}getClosingBracketInfo(t){return this._closingBrackets.get(t)}getBracketInfo(t){return this.getOpeningBracketInfo(t)||this.getClosingBracketInfo(t)}getBracketRegExp(t){let e=Array.from([...this._openingBrackets.keys(),...this._closingBrackets.keys()]);return bC(e,t)}};function zie(r){return r.filter(([t,e])=>t!==""&&e!=="")}var qO=class{constructor(t,e){this.config=t;this.bracketText=e}get languageId(){return this.config.languageId}},qG=class extends qO{constructor(e,i,n){super(e,i);this.openedBrackets=n}isOpeningBracket=!0},$G=class extends qO{constructor(e,i,n,o){super(e,i);this.openingBrackets=n;this.openingColorizedBrackets=o}isOpeningBracket=!1;closes(e){return e.config!==this.config?!1:this.openingBrackets.has(e)}closesColorized(e){return e.config!==this.config?!1:this.openingColorizedBrackets.has(e)}getOpeningBrackets(){return[...this.openingBrackets]}};var tn=class r{static _nextVisibleColumn(t,e,i){return t===9?r.nextRenderTabStop(e,i):vd(t)||U_(t)?e+2:e+1}static visibleColumnFromColumn(t,e,i){let n=Math.min(e-1,t.length),o=t.substring(0,n),s=new Kv(o),a=0;for(;!s.eol();){let l=BS(o,n,s.offset);s.nextGraphemeLength(),a=this._nextVisibleColumn(l,a,i)}return a}static toStatusbarColumn(t,e,i){let n=t.substring(0,Math.min(e-1,t.length)),o=new zv(n),s=0;for(;!o.eol();)o.nextCodePoint()===9?s=r.nextRenderTabStop(s,i):s=s+1;return s+1}static columnFromVisibleColumn(t,e,i){if(e<=0)return 1;let n=t.length,o=new Kv(t),s=0,a=1;for(;!o.eol();){let l=BS(t,n,o.offset);o.nextGraphemeLength();let d=this._nextVisibleColumn(l,s,i),c=o.offset+1;if(d>=e){let p=e-s;return d-e<p?c:a}s=d,a=c}return n+1}static nextRenderTabStop(t,e){return t+e-t%e}static nextIndentTabStop(t,e){return t+e-t%e}static prevRenderTabStop(t,e){return Math.max(0,t-1-(t-1)%e)}static prevIndentTabStop(t,e){return Math.max(0,t-1-(t-1)%e)}};function Kie(r,t,e,i){return r!==e?Mn(e-r,i):Mn(0,i-t)}var Xo=0;function vC(r){return r===0}var Ml=2**26;function Mn(r,t){return r*Ml+t}function ta(r){let t=r,e=Math.floor(t/Ml),i=t-e*Ml;return new pr(e,i)}function Gie(r){return Math.floor(r/Ml)}function Gi(r,t){let e=r+t;return t>=Ml&&(e=e-r%Ml),e}function qie(r,t){return r.reduce((e,i)=>Gi(e,t(i)),Xo)}function jG(r,t){return r===t}function yI(r,t){let e=r,i=t;if(i-e<=0)return Xo;let o=Math.floor(e/Ml),s=Math.floor(i/Ml),a=i-s*Ml;if(o===s){let l=e-o*Ml;return Mn(0,a-l)}else return Mn(s-o,a)}function km(r,t){return r<t}function Tf(r,t){return r<=t}function IC(r,t){return r>=t}function _f(r){return Mn(r.lineNumber-1,r.column-1)}function Df(r,t){let e=r,i=Math.floor(e/Ml),n=e-i*Ml,o=t,s=Math.floor(o/Ml),a=o-s*Ml;return new L(i+1,n+1,s+1,a+1)}function $ie(r){let t=Xc(r);return Mn(t.length-1,t[t.length-1].length)}var $O=[],ys=class r{constructor(t,e){this.items=t;this.additionalItems=e}static cache=new Array(129);static create(t,e){if(t<=128&&e.length===0){let i=r.cache[t];return i||(i=new r(t,e),r.cache[t]=i),i}return new r(t,e)}static empty=r.create(0,$O);static getEmpty(){return this.empty}add(t,e){let i=e.getKey(t),n=i>>5;if(n===0){let s=1<<i|this.items;return s===this.items?this:r.create(s,this.additionalItems)}n--;let o=this.additionalItems.slice(0);for(;o.length<n;)o.push(0);return o[n]|=1<<(i&31),r.create(this.items,o)}has(t,e){let i=e.getKey(t),n=i>>5;return n===0?(this.items&1<<i)!==0:(n--,((this.additionalItems[n]||0)&1<<(i&31))!==0)}merge(t){let e=this.items|t.items;if(this.additionalItems===$O&&t.additionalItems===$O)return e===this.items?this:e===t.items?t:r.create(e,$O);let i=[];for(let n=0;n<Math.max(this.additionalItems.length,t.additionalItems.length);n++){let o=this.additionalItems[n]||0,s=t.additionalItems[n]||0;i.push(o|s)}return r.create(e,i)}intersects(t){if(this.items&t.items)return!0;for(let e=0;e<Math.min(this.additionalItems.length,t.additionalItems.length);e++)if(this.additionalItems[e]&t.additionalItems[e])return!0;return!1}equals(t){if(this.items!==t.items||this.additionalItems.length!==t.additionalItems.length)return!1;for(let e=0;e<this.additionalItems.length;e++)if(this.additionalItems[e]!==t.additionalItems[e])return!1;return!0}},XG={getKey(r){return r}},yC=class{items=new Map;getKey(t){let e=this.items.get(t);return e===void 0&&(e=this.items.size,this.items.set(t,e)),e}reverseLookup(t){return[...this.items].find(([e,i])=>i===t)?.[0]}reverseLookupSet(t){let e=[];for(let[i]of this.items)t.has(i,this)&&e.push(i);return e}keys(){return this.items.keys()}};var jO=class r{static DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_QUOTES=`;:.,=}])> 
	`;static DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_BRACKETS=`'"\`;:.,=}])> 
	`;static DEFAULT_AUTOCLOSE_BEFORE_WHITESPACE=` 
	`;_autoClosingPairs;_surroundingPairs;_autoCloseBeforeForQuotes;_autoCloseBeforeForBrackets;constructor(t){if(t.autoClosingPairs?this._autoClosingPairs=t.autoClosingPairs.map(e=>new fC(e)):t.brackets?this._autoClosingPairs=t.brackets.map(e=>new fC({open:e[0],close:e[1]})):this._autoClosingPairs=[],t.__electricCharacterSupport&&t.__electricCharacterSupport.docComment){let e=t.__electricCharacterSupport.docComment;this._autoClosingPairs.push(new fC({open:e.open,close:e.close||""}))}this._autoCloseBeforeForQuotes=typeof t.autoCloseBefore=="string"?t.autoCloseBefore:r.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_QUOTES,this._autoCloseBeforeForBrackets=typeof t.autoCloseBefore=="string"?t.autoCloseBefore:r.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_BRACKETS,this._surroundingPairs=t.surroundingPairs||this._autoClosingPairs}getAutoClosingPairs(){return this._autoClosingPairs}getAutoCloseBeforeSet(t){return t?this._autoCloseBeforeForQuotes:this._autoCloseBeforeForBrackets}getSurroundingPairs(){return this._surroundingPairs}};var XO=class{_richEditBrackets;constructor(t){this._richEditBrackets=t}getElectricCharacters(){let t=[];if(this._richEditBrackets)for(let e of this._richEditBrackets.brackets)for(let i of e.close){let n=i.charAt(i.length-1);t.push(n)}return Mo(t)}onElectricCharacter(t,e,i){if(!this._richEditBrackets||this._richEditBrackets.brackets.length===0)return null;let n=e.findTokenIndexAtOffset(i-1);if(hc(e.getStandardTokenType(n)))return null;let o=this._richEditBrackets.reversedRegex,s=e.getLineContent().substring(0,i-1)+t,a=Ca.findPrevBracketInRange(o,1,s,0,s.length);if(!a)return null;let l=s.substring(a.startColumn-1,a.endColumn-1).toLowerCase();if(this._richEditBrackets.textIsOpenBracket[l])return null;let c=e.getActualLineContentBefore(a.startColumn-1);return/^\s*$/.test(c)?{matchOpenBracket:l}:null}};function YO(r){return r.global&&(r.lastIndex=0),!0}var QO=class{_indentationRules;constructor(t){this._indentationRules=t}shouldIncrease(t){return!!(this._indentationRules&&this._indentationRules.increaseIndentPattern&&YO(this._indentationRules.increaseIndentPattern)&&this._indentationRules.increaseIndentPattern.test(t))}shouldDecrease(t){return!!(this._indentationRules&&this._indentationRules.decreaseIndentPattern&&YO(this._indentationRules.decreaseIndentPattern)&&this._indentationRules.decreaseIndentPattern.test(t))}shouldIndentNextLine(t){return!!(this._indentationRules&&this._indentationRules.indentNextLinePattern&&YO(this._indentationRules.indentNextLinePattern)&&this._indentationRules.indentNextLinePattern.test(t))}shouldIgnore(t){return!!(this._indentationRules&&this._indentationRules.unIndentedLinePattern&&YO(this._indentationRules.unIndentedLinePattern)&&this._indentationRules.unIndentedLinePattern.test(t))}getIndentMetadata(t){let e=0;return this.shouldIncrease(t)&&(e+=1),this.shouldDecrease(t)&&(e+=2),this.shouldIndentNextLine(t)&&(e+=4),this.shouldIgnore(t)&&(e+=8),e}};var ZO=class r{_brackets;_regExpRules;constructor(t){t=t||{},t.brackets=t.brackets||[["(",")"],["{","}"],["[","]"]],this._brackets=[],t.brackets.forEach(e=>{let i=r._createOpenBracketRegExp(e[0]),n=r._createCloseBracketRegExp(e[1]);i&&n&&this._brackets.push({open:e[0],openRegExp:i,close:e[1],closeRegExp:n})}),this._regExpRules=t.onEnterRules||[]}onEnter(t,e,i,n){if(t>=3)for(let o=0,s=this._regExpRules.length;o<s;o++){let a=this._regExpRules[o];if([{reg:a.beforeText,text:i},{reg:a.afterText,text:n},{reg:a.previousLineText,text:e}].every(d=>d.reg?(d.reg.lastIndex=0,d.reg.test(d.text)):!0))return a.action}if(t>=2&&i.length>0&&n.length>0)for(let o=0,s=this._brackets.length;o<s;o++){let a=this._brackets[o];if(a.openRegExp.test(i)&&a.closeRegExp.test(n))return{indentAction:2}}if(t>=2&&i.length>0){for(let o=0,s=this._brackets.length;o<s;o++)if(this._brackets[o].openRegExp.test(i))return{indentAction:1}}return null}static _createOpenBracketRegExp(t){let e=ba(t);return/\B/.test(e.charAt(0))||(e="\\b"+e),e+="\\s*$",r._safeRegExp(e)}static _createCloseBracketRegExp(t){let e=ba(t);return/\B/.test(e.charAt(e.length-1))||(e=e+"\\b"),e="^\\s*"+e,r._safeRegExp(e)}static _safeRegExp(t){try{return new RegExp(t)}catch(e){return Xe(e),null}}};var vIe=[];function gi(r,t,e){t instanceof qr||(t=new qr(t,[],!!e)),vIe.push([r,t])}var Oo=Object.freeze({text:"text/plain",binary:"application/octet-stream",unknown:"application/unknown",markdown:"text/markdown",latex:"text/latex",uriList:"text/uri-list"});var IIe={ModesRegistry:"editor.modesRegistry"},QG=class{_languages;_onDidChangeLanguages=new x;onDidChangeLanguages=this._onDidChangeLanguages.event;constructor(){this._languages=[]}registerLanguage(t){return this._languages.push(t),this._onDidChangeLanguages.fire(void 0),{dispose:()=>{for(let e=0,i=this._languages.length;e<i;e++)if(this._languages[e]===t){this._languages.splice(e,1);return}}}}getLanguages(){return this._languages}},SC=new QG;Pe.add(IIe.ModesRegistry,SC);var jn="plaintext",yIe=".txt";SC.registerLanguage({id:jn,extensions:[yIe],aliases:[u("plainText.alias","Plain Text"),"text"],mimetypes:[Oo.text]});Pe.as(ur.Configuration).registerDefaultConfigurations([{overrides:{"[plaintext]":{"editor.unicodeHighlight.ambiguousCharacters":!1,"editor.unicodeHighlight.invisibleCharacters":!1}}}]);var KD=class{constructor(t){this.languageId=t}affects(t){return this.languageId?this.languageId===t:!0}},Do=q("languageConfigurationService"),zD=class extends R{constructor(e,i){super();this.configurationService=e;this.languageService=i;let n=new Set(Object.values(ZG));this._register(this.configurationService.onDidChangeConfiguration(o=>{let s=o.change.keys.some(l=>n.has(l)),a=o.change.overrides.filter(([l,d])=>d.some(c=>n.has(c))).map(([l])=>l);if(s)this.configurations.clear(),this.onDidChangeEmitter.fire(new KD(void 0));else for(let l of a)this.languageService.isRegisteredLanguageId(l)&&(this.configurations.delete(l),this.onDidChangeEmitter.fire(new KD(l)))})),this._register(this._registry.onDidChange(o=>{this.configurations.delete(o.languageId),this.onDidChangeEmitter.fire(new KD(o.languageId))}))}_serviceBrand;_registry=this._register(new e8);onDidChangeEmitter=this._register(new x);onDidChange=this.onDidChangeEmitter.event;configurations=new Map;register(e,i,n){return this._registry.register(e,i,n)}getLanguageConfiguration(e){let i=this.configurations.get(e);return i||(i=SIe(e,this._registry,this.configurationService,this.languageService),this.configurations.set(e,i)),i}};zD=E([b(0,se),b(1,ti)],zD);function SIe(r,t,e,i){let n=t.getLanguageConfiguration(r);if(!n){if(!i.isRegisteredLanguageId(r))return new CC(r,{});n=new CC(r,{})}let o=CIe(n.languageId,e),s=Yie([n.underlyingConfig,o]);return new CC(n.languageId,s)}var ZG={brackets:"editor.language.brackets",colorizedBracketPairs:"editor.language.colorizedBracketPairs"};function CIe(r,t){let e=t.getValue(ZG.brackets,{overrideIdentifier:r}),i=t.getValue(ZG.colorizedBracketPairs,{overrideIdentifier:r});return{brackets:Xie(e),colorizedBracketPairs:Xie(i)}}function Xie(r){if(Array.isArray(r))return r.map(t=>{if(!(!Array.isArray(t)||t.length!==2))return[t[0],t[1]]}).filter(t=>!!t)}function t0(r,t,e){let i=r.getLineContent(t),n=yn(i);return n.length>e-1&&(n=n.substring(0,e-1)),n}var JG=class{constructor(t){this.languageId=t;this._entries=[],this._order=0,this._resolved=null}_entries;_order;_resolved=null;register(t,e){let i=new JO(t,e,++this._order);return this._entries.push(i),this._resolved=null,le(()=>{for(let n=0;n<this._entries.length;n++)if(this._entries[n]===i){this._entries.splice(n,1),this._resolved=null;break}})}getResolvedConfiguration(){if(!this._resolved){let t=this._resolve();t&&(this._resolved=new CC(this.languageId,t))}return this._resolved}_resolve(){return this._entries.length===0?null:(this._entries.sort(JO.cmp),Yie(this._entries.map(t=>t.configuration)))}};function Yie(r){let t={comments:void 0,brackets:void 0,wordPattern:void 0,indentationRules:void 0,onEnterRules:void 0,autoClosingPairs:void 0,surroundingPairs:void 0,autoCloseBefore:void 0,folding:void 0,colorizedBracketPairs:void 0,__electricCharacterSupport:void 0};for(let e of r)t={comments:e.comments||t.comments,brackets:e.brackets||t.brackets,wordPattern:e.wordPattern||t.wordPattern,indentationRules:e.indentationRules||t.indentationRules,onEnterRules:e.onEnterRules||t.onEnterRules,autoClosingPairs:e.autoClosingPairs||t.autoClosingPairs,surroundingPairs:e.surroundingPairs||t.surroundingPairs,autoCloseBefore:e.autoCloseBefore||t.autoCloseBefore,folding:e.folding||t.folding,colorizedBracketPairs:e.colorizedBracketPairs||t.colorizedBracketPairs,__electricCharacterSupport:e.__electricCharacterSupport||t.__electricCharacterSupport};return t}var JO=class{constructor(t,e,i){this.configuration=t;this.priority=e;this.order=i}static cmp(t,e){return t.priority===e.priority?t.order-e.order:t.priority-e.priority}},e0=class{constructor(t){this.languageId=t}},e8=class extends R{_entries=new Map;_onDidChange=this._register(new x);onDidChange=this._onDidChange.event;constructor(){super(),this._register(this.register(jn,{brackets:[["(",")"],["[","]"],["{","}"]],surroundingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:"<",close:">"},{open:'"',close:'"'},{open:"'",close:"'"},{open:"`",close:"`"}],colorizedBracketPairs:[],folding:{offSide:!0}},0))}register(t,e,i=0){let n=this._entries.get(t);n||(n=new JG(t),this._entries.set(t,n));let o=n.register(e,i);return this._onDidChange.fire(new e0(t)),le(()=>{o.dispose(),this._onDidChange.fire(new e0(t))})}getLanguageConfiguration(t){return this._entries.get(t)?.getResolvedConfiguration()||null}},CC=class r{constructor(t,e){this.languageId=t;this.underlyingConfig=e;this._brackets=null,this._electricCharacter=null,this._onEnterSupport=this.underlyingConfig.brackets||this.underlyingConfig.indentationRules||this.underlyingConfig.onEnterRules?new ZO(this.underlyingConfig):null,this.comments=r._handleComments(this.underlyingConfig),this.characterPair=new jO(this.underlyingConfig),this.wordDefinition=this.underlyingConfig.wordPattern||rI,this.indentationRules=this.underlyingConfig.indentationRules,this.underlyingConfig.indentationRules?this.indentRulesSupport=new QO(this.underlyingConfig.indentationRules):this.indentRulesSupport=null,this.foldingRules=this.underlyingConfig.folding||{},this.bracketsNew=new GO(t,this.underlyingConfig)}_brackets;_electricCharacter;_onEnterSupport;comments;characterPair;wordDefinition;indentRulesSupport;indentationRules;foldingRules;bracketsNew;getWordDefinition(){return mD(this.wordDefinition)}get brackets(){return!this._brackets&&this.underlyingConfig.brackets&&(this._brackets=new zO(this.languageId,this.underlyingConfig.brackets)),this._brackets}get electricCharacter(){return this._electricCharacter||(this._electricCharacter=new XO(this.brackets)),this._electricCharacter}onEnter(t,e,i,n){return this._onEnterSupport?this._onEnterSupport.onEnter(t,e,i,n):null}getAutoClosingPairs(){return new UO(this.characterPair.getAutoClosingPairs())}getAutoCloseBeforeSet(t){return this.characterPair.getAutoCloseBeforeSet(t)}getSurroundingPairs(){return this.characterPair.getSurroundingPairs()}static _handleComments(t){let e=t.comments;if(!e)return null;let i={};if(e.lineComment&&(i.lineCommentToken=e.lineComment),e.blockComment){let[n,o]=e.blockComment;i.blockCommentStartToken=n,i.blockCommentEndToken=o}return i}};gi(Do,zD,1);var t8=class r{constructor(t){this.map=t}static createFromLanguage(t,e){function i(o){return e.getKey(`${o.languageId}:::${o.bracketText}`)}let n=new Map;for(let o of t.bracketsNew.openingBrackets){let s=Mn(0,o.bracketText.length),a=i(o),l=ys.getEmpty().add(a,XG);n.set(o.bracketText,new uu(s,1,a,l,GD.create(s,o,l)))}for(let o of t.bracketsNew.closingBrackets){let s=Mn(0,o.bracketText.length),a=ys.getEmpty(),l=o.getOpeningBrackets();for(let d of l)a=a.add(i(d),XG);n.set(o.bracketText,new uu(s,2,i(l[0]),a,GD.create(s,o,a)))}return new r(n)}hasRegExp=!1;_regExpGlobal=null;getRegExpStr(){if(this.isEmpty)return null;{let t=[...this.map.keys()];return t.sort(),t.reverse(),t.map(e=>wIe(e)).join("|")}}get regExpGlobal(){if(!this.hasRegExp){let t=this.getRegExpStr();this._regExpGlobal=t?new RegExp(t,"gi"):null,this.hasRegExp=!0}return this._regExpGlobal}getToken(t){return this.map.get(t.toLowerCase())}findClosingTokenText(t){for(let[e,i]of this.map)if(i.kind===2&&i.bracketIds.intersects(t))return e}get isEmpty(){return this.map.size===0}};function wIe(r){let t=ba(r);return/^[\w ]+/.test(r)&&(t=`\\b${t}`),/[\w ]+$/.test(r)&&(t=`${t}\\b`),t}var wC=class{constructor(t,e){this.denseKeyProvider=t;this.getLanguageConfiguration=e}languageIdToBracketTokens=new Map;didLanguageChange(t){return this.languageIdToBracketTokens.has(t)}getSingleLanguageBracketTokens(t){let e=this.languageIdToBracketTokens.get(t);return e||(e=t8.createFromLanguage(this.getLanguageConfiguration(t),this.denseKeyProvider),this.languageIdToBracketTokens.set(t,e)),e}getToken(t,e){return this.getSingleLanguageBracketTokens(e).getToken(t)}};var uu=class{constructor(t,e,i,n,o){this.length=t;this.kind=e;this.bracketId=i;this.bracketIds=n;this.astNode=o}},EC=class{constructor(t,e){this.textModel=t;this.bracketTokens=e;this.textBufferLineCount=t.getLineCount(),this.textBufferLastLineLength=t.getLineLength(this.textBufferLineCount)}textBufferLineCount;textBufferLastLineLength;reader=new i8(this.textModel,this.bracketTokens);_offset=Xo;get offset(){return this._offset}get length(){return Mn(this.textBufferLineCount-1,this.textBufferLastLineLength)}getText(){return this.textModel.getValue()}skip(t){this.didPeek=!1,this._offset=Gi(this._offset,t);let e=ta(this._offset);this.reader.setPosition(e.lineCount,e.columnCount)}didPeek=!1;peeked=null;read(){let t;return this.peeked?(this.didPeek=!1,t=this.peeked):t=this.reader.read(),t&&(this._offset=Gi(this._offset,t.length)),t}peek(){return this.didPeek||(this.peeked=this.reader.read(),this.didPeek=!0),this.peeked}},i8=class{constructor(t,e){this.textModel=t;this.bracketTokens=e;this.textBufferLineCount=t.getLineCount(),this.textBufferLastLineLength=t.getLineLength(this.textBufferLineCount)}textBufferLineCount;textBufferLastLineLength;lineIdx=0;line=null;lineCharOffset=0;lineTokens=null;lineTokenOffset=0;setPosition(t,e){t===this.lineIdx?(this.lineCharOffset=e,this.line!==null&&(this.lineTokenOffset=this.lineCharOffset===0?0:this.lineTokens.findTokenIndexAtOffset(this.lineCharOffset))):(this.lineIdx=t,this.lineCharOffset=e,this.line=null),this.peekedToken=null}peekedToken=null;read(){if(this.peekedToken){let o=this.peekedToken;return this.peekedToken=null,this.lineCharOffset+=o.length,o}if(this.lineIdx>this.textBufferLineCount-1||this.lineIdx===this.textBufferLineCount-1&&this.lineCharOffset>=this.textBufferLastLineLength)return null;this.line===null&&(this.lineTokens=this.textModel.tokenization.getLineTokens(this.lineIdx+1),this.line=this.lineTokens.getLineContent(),this.lineTokenOffset=this.lineCharOffset===0?0:this.lineTokens.findTokenIndexAtOffset(this.lineCharOffset));let t=this.lineIdx,e=this.lineCharOffset,i=0;for(;;){let o=this.lineTokens,s=o.getCount(),a=null;if(this.lineTokenOffset<s){let l=o.getMetadata(this.lineTokenOffset);for(;this.lineTokenOffset+1<s&&l===o.getMetadata(this.lineTokenOffset+1);)this.lineTokenOffset++;let d=Pl.getTokenType(l)===0,c=Pl.containsBalancedBrackets(l),p=o.getEndOffset(this.lineTokenOffset);if(c&&d&&this.lineCharOffset<p){let h=o.getLanguageId(this.lineTokenOffset),m=this.line.substring(this.lineCharOffset,p),f=this.bracketTokens.getSingleLanguageBracketTokens(h),g=f.regExpGlobal;if(g){g.lastIndex=0;let v=g.exec(m);v&&(a=f.getToken(v[0]),a&&(this.lineCharOffset+=v.index))}}if(i+=p-this.lineCharOffset,a)if(t!==this.lineIdx||e!==this.lineCharOffset){this.peekedToken=a;break}else return this.lineCharOffset+=a.length,a;else this.lineTokenOffset++,this.lineCharOffset=p}else if(this.lineIdx===this.textBufferLineCount-1||(this.lineIdx++,this.lineTokens=this.textModel.tokenization.getLineTokens(this.lineIdx+1),this.lineTokenOffset=0,this.line=this.lineTokens.getLineContent(),this.lineCharOffset=0,i+=33,i>1e3))break;if(i>1500)break}let n=Kie(t,e,this.lineIdx,this.lineCharOffset);return new uu(n,0,-1,ys.getEmpty(),new pu(n))}},i0=class{constructor(t,e){this.text=t;let i=e.getRegExpStr(),n=i?new RegExp(i+`|
`,"gi"):null,o=[],s,a=0,l=0,d=0,c=0,p=[];for(let f=0;f<60;f++)p.push(new uu(Mn(0,f),0,-1,ys.getEmpty(),new pu(Mn(0,f))));let h=[];for(let f=0;f<60;f++)h.push(new uu(Mn(1,f),0,-1,ys.getEmpty(),new pu(Mn(1,f))));if(n)for(n.lastIndex=0;(s=n.exec(t))!==null;){let f=s.index,g=s[0];if(g===`
`)a++,l=f+1;else{if(d!==f){let v;if(c===a){let I=f-d;if(I<p.length)v=p[I];else{let y=Mn(0,I);v=new uu(y,0,-1,ys.getEmpty(),new pu(y))}}else{let I=a-c,y=f-l;if(I===1&&y<h.length)v=h[y];else{let w=Mn(I,y);v=new uu(w,0,-1,ys.getEmpty(),new pu(w))}}o.push(v)}o.push(e.getToken(g)),d=f+g.length,c=a}}let m=t.length;if(d!==m){let f=c===a?Mn(0,m-d):Mn(a-c,m-l);o.push(new uu(f,0,-1,ys.getEmpty(),new pu(f)))}this.length=Mn(a,m-l),this.tokens=o}_offset=Xo;tokens;idx=0;get offset(){return this._offset}length;read(){return this.tokens[this.idx++]||null}peek(){return this.tokens[this.idx]||null}skip(t){throw new LM}getText(){return this.text}};var qD=class{_length;get length(){return this._length}constructor(t){this._length=t}},$D=class r extends qD{constructor(e,i,n,o,s){super(e);this.openingBracket=i;this.child=n;this.closingBracket=o;this.missingOpeningBracketIds=s}static create(e,i,n){let o=e.length;return i&&(o=Gi(o,i.length)),n&&(o=Gi(o,n.length)),new r(o,e,i,n,i?i.missingOpeningBracketIds:ys.getEmpty())}get kind(){return 2}get listHeight(){return 0}get childrenLength(){return 3}getChild(e){switch(e){case 0:return this.openingBracket;case 1:return this.child;case 2:return this.closingBracket}throw new Error("Invalid child index")}get children(){let e=[];return e.push(this.openingBracket),this.child&&e.push(this.child),this.closingBracket&&e.push(this.closingBracket),e}canBeReused(e){return!(this.closingBracket===null||e.intersects(this.missingOpeningBracketIds))}flattenLists(){return r.create(this.openingBracket.flattenLists(),this.child&&this.child.flattenLists(),this.closingBracket&&this.closingBracket.flattenLists())}deepClone(){return new r(this.length,this.openingBracket.deepClone(),this.child&&this.child.deepClone(),this.closingBracket&&this.closingBracket.deepClone(),this.missingOpeningBracketIds)}computeMinIndentation(e,i){return this.child?this.child.computeMinIndentation(Gi(e,this.openingBracket.length),i):Number.MAX_SAFE_INTEGER}},Al=class r extends qD{constructor(e,i,n){super(e);this.listHeight=i;this._missingOpeningBracketIds=n}static create23(e,i,n,o=!1){let s=e.length,a=e.missingOpeningBracketIds;if(e.listHeight!==i.listHeight)throw new Error("Invalid list heights");if(s=Gi(s,i.length),a=a.merge(i.missingOpeningBracketIds),n){if(e.listHeight!==n.listHeight)throw new Error("Invalid list heights");s=Gi(s,n.length),a=a.merge(n.missingOpeningBracketIds)}return o?new n8(s,e.listHeight+1,e,i,n,a):new jD(s,e.listHeight+1,e,i,n,a)}static create(e,i=!1){if(e.length===0)return this.getEmpty();{let n=e[0].length,o=e[0].missingOpeningBracketIds;for(let s=1;s<e.length;s++)n=Gi(n,e[s].length),o=o.merge(e[s].missingOpeningBracketIds);return i?new n0(n,e[0].listHeight+1,e,o):new XD(n,e[0].listHeight+1,e,o)}}static getEmpty(){return new n0(Xo,0,[],ys.getEmpty())}get kind(){return 4}get missingOpeningBracketIds(){return this._missingOpeningBracketIds}cachedMinIndentation=-1;throwIfImmutable(){}makeLastElementMutable(){this.throwIfImmutable();let e=this.childrenLength;if(e===0)return;let i=this.getChild(e-1),n=i.kind===4?i.toMutable():i;return i!==n&&this.setChild(e-1,n),n}makeFirstElementMutable(){if(this.throwIfImmutable(),this.childrenLength===0)return;let i=this.getChild(0),n=i.kind===4?i.toMutable():i;return i!==n&&this.setChild(0,n),n}canBeReused(e){if(e.intersects(this.missingOpeningBracketIds)||this.childrenLength===0)return!1;let i=this;for(;i.kind===4;){let n=i.childrenLength;if(n===0)throw new _t;i=i.getChild(n-1)}return i.canBeReused(e)}handleChildrenChanged(){this.throwIfImmutable();let e=this.childrenLength,i=this.getChild(0).length,n=this.getChild(0).missingOpeningBracketIds;for(let o=1;o<e;o++){let s=this.getChild(o);i=Gi(i,s.length),n=n.merge(s.missingOpeningBracketIds)}this._length=i,this._missingOpeningBracketIds=n,this.cachedMinIndentation=-1}flattenLists(){let e=[];for(let i of this.children){let n=i.flattenLists();n.kind===4?e.push(...n.children):e.push(n)}return r.create(e)}computeMinIndentation(e,i){if(this.cachedMinIndentation!==-1)return this.cachedMinIndentation;let n=Number.MAX_SAFE_INTEGER,o=e;for(let s=0;s<this.childrenLength;s++){let a=this.getChild(s);a&&(n=Math.min(n,a.computeMinIndentation(o,i)),o=Gi(o,a.length))}return this.cachedMinIndentation=n,n}},jD=class r extends Al{constructor(e,i,n,o,s,a){super(e,i,a);this._item1=n;this._item2=o;this._item3=s}get childrenLength(){return this._item3!==null?3:2}getChild(e){switch(e){case 0:return this._item1;case 1:return this._item2;case 2:return this._item3}throw new Error("Invalid child index")}setChild(e,i){switch(e){case 0:this._item1=i;return;case 1:this._item2=i;return;case 2:this._item3=i;return}throw new Error("Invalid child index")}get children(){return this._item3?[this._item1,this._item2,this._item3]:[this._item1,this._item2]}get item1(){return this._item1}get item2(){return this._item2}get item3(){return this._item3}deepClone(){return new r(this.length,this.listHeight,this._item1.deepClone(),this._item2.deepClone(),this._item3?this._item3.deepClone():null,this.missingOpeningBracketIds)}appendChildOfSameHeight(e){if(this._item3)throw new Error("Cannot append to a full (2,3) tree node");this.throwIfImmutable(),this._item3=e,this.handleChildrenChanged()}unappendChild(){if(!this._item3)throw new Error("Cannot remove from a non-full (2,3) tree node");this.throwIfImmutable();let e=this._item3;return this._item3=null,this.handleChildrenChanged(),e}prependChildOfSameHeight(e){if(this._item3)throw new Error("Cannot prepend to a full (2,3) tree node");this.throwIfImmutable(),this._item3=this._item2,this._item2=this._item1,this._item1=e,this.handleChildrenChanged()}unprependChild(){if(!this._item3)throw new Error("Cannot remove from a non-full (2,3) tree node");this.throwIfImmutable();let e=this._item1;return this._item1=this._item2,this._item2=this._item3,this._item3=null,this.handleChildrenChanged(),e}toMutable(){return this}},n8=class extends jD{toMutable(){return new jD(this.length,this.listHeight,this.item1,this.item2,this.item3,this.missingOpeningBracketIds)}throwIfImmutable(){throw new Error("this instance is immutable")}},XD=class r extends Al{constructor(e,i,n,o){super(e,i,o);this._children=n}get childrenLength(){return this._children.length}getChild(e){return this._children[e]}setChild(e,i){this._children[e]=i}get children(){return this._children}deepClone(){let e=new Array(this._children.length);for(let i=0;i<this._children.length;i++)e[i]=this._children[i].deepClone();return new r(this.length,this.listHeight,e,this.missingOpeningBracketIds)}appendChildOfSameHeight(e){this.throwIfImmutable(),this._children.push(e),this.handleChildrenChanged()}unappendChild(){this.throwIfImmutable();let e=this._children.pop();return this.handleChildrenChanged(),e}prependChildOfSameHeight(e){this.throwIfImmutable(),this._children.unshift(e),this.handleChildrenChanged()}unprependChild(){this.throwIfImmutable();let e=this._children.shift();return this.handleChildrenChanged(),e}toMutable(){return this}},n0=class extends XD{toMutable(){return new XD(this.length,this.listHeight,[...this.children],this.missingOpeningBracketIds)}throwIfImmutable(){throw new Error("this instance is immutable")}},TIe=[],YD=class extends qD{get listHeight(){return 0}get childrenLength(){return 0}getChild(t){return null}get children(){return TIe}flattenLists(){return this}deepClone(){return this}},pu=class extends YD{get kind(){return 0}get missingOpeningBracketIds(){return ys.getEmpty()}canBeReused(t){return!0}computeMinIndentation(t,e){let i=ta(t),n=(i.columnCount===0?i.lineCount:i.lineCount+1)+1,o=Gie(Gi(t,this.length))+1,s=Number.MAX_SAFE_INTEGER;for(let a=n;a<=o;a++){let l=e.getLineFirstNonWhitespaceColumn(a),d=e.getLineContent(a);if(l===0)continue;let c=tn.visibleColumnFromColumn(d,l,e.getOptions().tabSize);s=Math.min(s,c)}return s}},GD=class r extends YD{constructor(e,i,n){super(e);this.bracketInfo=i;this.bracketIds=n}static create(e,i,n){return new r(e,i,n)}get kind(){return 1}get missingOpeningBracketIds(){return ys.getEmpty()}get text(){return this.bracketInfo.bracketText}get languageId(){return this.bracketInfo.languageId}canBeReused(e){return!1}computeMinIndentation(e,i){return Number.MAX_SAFE_INTEGER}},o0=class extends YD{get kind(){return 3}missingOpeningBracketIds;constructor(t,e){super(e),this.missingOpeningBracketIds=t}canBeReused(t){return!t.intersects(this.missingOpeningBracketIds)}computeMinIndentation(t,e){return Number.MAX_SAFE_INTEGER}};var QD=class{constructor(t,e,i,n){this.range=t;this.nestingLevel=e;this.nestingLevelOfEqualBracketType=i;this.isInvalid=n}},o8=class{constructor(t,e,i,n,o,s){this.range=t;this.openingBracketRange=e;this.closingBracketRange=i;this.nestingLevel=n;this.nestingLevelOfEqualBracketType=o;this.bracketPairNode=s}get openingBracketInfo(){return this.bracketPairNode.openingBracket.bracketInfo}get closingBracketInfo(){return this.bracketPairNode.closingBracket?.bracketInfo}},r0=class extends o8{constructor(e,i,n,o,s,a,l){super(e,i,n,o,s,a);this.minVisibleColumnIndentation=l}};var s0=class{changeType=1},ol=class r{constructor(t,e,i,n,o){this.ownerId=t;this.lineNumber=e;this.column=i;this.options=n;this.order=o}static applyInjectedText(t,e){if(!e||e.length===0)return t;let i="",n=0;for(let o of e)i+=t.substring(n,o.column-1),n=o.column-1,i+=o.options.content;return i+=t.substring(n),i}static fromDecorations(t){let e=[];for(let i of t)i.options.before&&i.options.before.content.length>0&&e.push(new r(i.ownerId,i.range.startLineNumber,i.range.startColumn,i.options.before,0)),i.options.after&&i.options.after.content.length>0&&e.push(new r(i.ownerId,i.range.endLineNumber,i.range.endColumn,i.options.after,1));return e.sort((i,n)=>i.lineNumber===n.lineNumber?i.column===n.column?i.order-n.order:i.column-n.column:i.lineNumber-n.lineNumber),e}withText(t){return new r(this.ownerId,this.lineNumber,this.column,{...this.options,content:t},this.order)}},ZD=class{changeType=2;lineNumber;detail;injectedText;constructor(t,e,i){this.lineNumber=t,this.detail=e,this.injectedText=i}},a0=class{changeType=3;fromLineNumber;toLineNumber;constructor(t,e){this.fromLineNumber=t,this.toLineNumber=e}},l0=class{changeType=4;fromLineNumber;toLineNumber;detail;injectedTexts;constructor(t,e,i,n){this.injectedTexts=n,this.fromLineNumber=t,this.toLineNumber=e,this.detail=i}},d0=class{changeType=5},SI=class r{changes;versionId;isUndoing;isRedoing;resultingSelection;constructor(t,e,i,n){this.changes=t,this.versionId=e,this.isUndoing=i,this.isRedoing=n,this.resultingSelection=null}containsEvent(t){for(let e=0,i=this.changes.length;e<i;e++)if(this.changes[e].changeType===t)return!0;return!1}static merge(t,e){let i=[].concat(t.changes).concat(e.changes),n=e.versionId,o=t.isUndoing||e.isUndoing,s=t.isRedoing||e.isRedoing;return new r(i,n,o,s)}},xC=class{changes;constructor(t){this.changes=t}},kf=class r{constructor(t,e){this.rawContentChangedEvent=t;this.contentChangedEvent=e}merge(t){let e=SI.merge(this.rawContentChangedEvent,t.rawContentChangedEvent),i=r._mergeChangeEvents(this.contentChangedEvent,t.contentChangedEvent);return new r(e,i)}static _mergeChangeEvents(t,e){let i=[].concat(t.changes).concat(e.changes),n=e.eol,o=e.versionId,s=t.isUndoing||e.isUndoing,a=t.isRedoing||e.isRedoing,l=t.isFlush||e.isFlush,d=t.isEolChange&&e.isEolChange;return{changes:i,eol:n,isEolChange:d,versionId:o,isUndoing:s,isRedoing:a,isFlush:l}}};var mc=class{constructor(t,e,i,n,o,s){this.visibleColumn=t;this.column=e;this.className=i;this.horizontalLine=n;this.forWrappedLinesAfterColumn=o;this.forWrappedLinesBeforeOrAtColumn=s;if(t!==-1==(e!==-1))throw new Error}},Lm=class{constructor(t,e){this.top=t;this.endColumn=e}};var JD=class r{constructor(t){this.edits=t;let e=-1;for(let i of t){if(!(i.replaceRange.start>=e))throw new _t(`Edits must be disjoint and sorted. Found ${i} after ${e}`);e=i.replaceRange.endExclusive}}static empty=new r([]);static fromJson(t){return new r(t.map(hu.fromJson))}static replace(t,e){return new r([new hu(t,e)])}static insert(t,e){return r.replace(Qe.emptyAt(t),e)}normalize(){let t=[],e;for(let i of this.edits)i.newText.length===0&&i.replaceRange.length===0||(e&&e.replaceRange.endExclusive===i.replaceRange.start?e=new hu(e.replaceRange.join(i.replaceRange),e.newText+i.newText):(e&&t.push(e),e=i));return e&&t.push(e),new r(t)}toString(){return`[${this.edits.map(e=>e.toString()).join(", ")}]`}apply(t){let e=[],i=0;for(let n of this.edits)e.push(t.substring(i,n.replaceRange.start)),e.push(n.newText),i=n.replaceRange.endExclusive;return e.push(t.substring(i)),e.join("")}compose(t){return DIe(this,t)}inverse(t){let e=[],i=0;for(let n of this.edits)e.push(new hu(Qe.ofStartAndLength(n.replaceRange.start+i,n.newText.length),t.substring(n.replaceRange.start,n.replaceRange.endExclusive))),i+=n.newText.length-n.replaceRange.length;return new r(e)}getNewTextRanges(){let t=[],e=0;for(let i of this.edits)t.push(Qe.ofStartAndLength(i.replaceRange.start+e,i.newText.length)),e+=i.newText.length-i.replaceRange.length;return t}get isEmpty(){return this.edits.length===0}tryRebase(t){let e=[],i=0,n=0,o=0;for(;n<this.edits.length||i<t.edits.length;){let s=t.edits[i],a=this.edits[n];if(a)s?a.replaceRange.intersects(s.replaceRange)?n++:a.replaceRange.start<s.replaceRange.start?(e.push(new hu(a.replaceRange.delta(o),a.newText)),n++):(i++,o+=s.newText.length-s.replaceRange.length):(e.push(new hu(a.replaceRange.delta(o),a.newText)),n++);else break}return new r(e)}applyToOffset(t){let e=0;for(let i of this.edits)if(i.replaceRange.start<=t){if(t<i.replaceRange.endExclusive)return i.replaceRange.start+e;e+=i.newText.length-i.replaceRange.length}else break;return t+e}applyToOffsetRange(t){return new Qe(this.applyToOffset(t.start),this.applyToOffset(t.endExclusive))}applyInverseToOffset(t){let e=0;for(let i of this.edits){let n=i.newText.length;if(i.replaceRange.start<=t-e){if(t-e<i.replaceRange.start+n)return i.replaceRange.start;e+=n-i.replaceRange.length}else break}return t-e}},hu=class r{constructor(t,e){this.replaceRange=t;this.newText=e}static fromJson(t){return new r(Qe.ofStartAndLength(t.pos,t.len),t.txt)}static insert(t,e){return new r(Qe.emptyAt(t),e)}toString(){return`${this.replaceRange} -> "${this.newText}"`}get isEmpty(){return this.newText.length===0&&this.replaceRange.length===0}};function DIe(r,t){if(r=r.normalize(),t=t.normalize(),r.isEmpty)return t;if(t.isEmpty)return r;let e=[...r.edits],i=[],n=0;for(let o of t.edits){for(;;){let d=e[0];if(!d||d.replaceRange.start+n+d.newText.length>=o.replaceRange.start)break;e.shift(),i.push(d),n+=d.newText.length-d.replaceRange.length}let s=n,a,l;for(;;){let d=e[0];if(!d||d.replaceRange.start+n>o.replaceRange.endExclusive)break;a||(a=d),l=d,e.shift(),n+=d.newText.length-d.replaceRange.length}if(!a)i.push(new hu(o.replaceRange.delta(-n),o.newText));else{let d="",c=o.replaceRange.start-(a.replaceRange.start+s);c>0&&(d=a.newText.slice(0,c));let p=l.replaceRange.endExclusive+n-o.replaceRange.endExclusive;if(p>0){let f=new hu(Qe.ofStartAndLength(l.replaceRange.endExclusive,0),l.newText.slice(-p));e.unshift(f),n-=f.newText.length-f.replaceRange.length}let h=d+o.newText,m=new Qe(Math.min(a.replaceRange.start,o.replaceRange.start-s),o.replaceRange.endExclusive-n);i.push(new hu(m,h))}}for(;;){let o=e.shift();if(!o)break;i.push(o)}return new JD(i).normalize()}var c0=class r{constructor(t,e){this.lineEdit=t;this.additionalLines=e}static replace(t,e){return new r(JD.replace(t,e),null)}};var u0=q("undoRedoService");var Qie=class r{static _ID=0;id;order;constructor(){this.id=r._ID++,this.order=1}nextOrder(){return this.id===0?0:this.order++}static None=new r},Zie=class r{static _ID=0;id;order;constructor(){this.id=r._ID++,this.order=1}nextOrder(){return this.id===0?0:this.order++}static None=new r};var TC=class{_textModelResolvedOptionsBrand=void 0;tabSize;indentSize;_indentSizeIsTabSize;insertSpaces;defaultEOL;trimAutoWhitespace;bracketPairColorizationOptions;get originalIndentSize(){return this._indentSizeIsTabSize?"tabSize":this.indentSize}constructor(t){this.tabSize=Math.max(1,t.tabSize|0),t.indentSize==="tabSize"?(this.indentSize=this.tabSize,this._indentSizeIsTabSize=!0):(this.indentSize=Math.max(1,t.indentSize|0),this._indentSizeIsTabSize=!1),this.insertSpaces=!!t.insertSpaces,this.defaultEOL=t.defaultEOL|0,this.trimAutoWhitespace=!!t.trimAutoWhitespace,this.bracketPairColorizationOptions=t.bracketPairColorizationOptions}equals(t){return this.tabSize===t.tabSize&&this._indentSizeIsTabSize===t._indentSizeIsTabSize&&this.indentSize===t.indentSize&&this.insertSpaces===t.insertSpaces&&this.defaultEOL===t.defaultEOL&&this.trimAutoWhitespace===t.trimAutoWhitespace&&sn(this.bracketPairColorizationOptions,t.bracketPairColorizationOptions)}createChangeEvent(t){return{tabSize:this.tabSize!==t.tabSize,indentSize:this.indentSize!==t.indentSize,insertSpaces:this.insertSpaces!==t.insertSpaces,trimAutoWhitespace:this.trimAutoWhitespace!==t.trimAutoWhitespace}}},Lf=class{_findMatchBrand=void 0;range;matches;constructor(t,e){this.range=t,this.matches=e}};function Jie(r){return r&&typeof r.read=="function"}var _C=class{constructor(t,e,i,n,o,s){this.identifier=t;this.range=e;this.text=i;this.forceMoveMarkers=n;this.isAutoWhitespaceEdit=o;this._isTracked=s}},p0=class{regex;wordSeparators;simpleSearch;constructor(t,e,i){this.regex=t,this.wordSeparators=e,this.simpleSearch=i}},h0=class{constructor(t,e,i){this.reverseEdits=t;this.changes=e;this.trimAutoWhitespaceLineNumbers=i}};function tne(r){return r&&typeof r.id=="string"}var CI={ICodeEditor:"vs.editor.ICodeEditor",IDiffEditor:"vs.editor.IDiffEditor"};var Rm=class{constructor(t,e,i,n,o){this.injectionOffsets=t;this.injectionOptions=e;this.breakOffsets=i;this.breakOffsetsVisibleColumn=n;this.wrappedTextIndentLength=o}getOutputLineCount(){return this.breakOffsets.length}getMinOutputOffset(t){return t>0?this.wrappedTextIndentLength:0}getLineLength(t){let e=t>0?this.breakOffsets[t-1]:0,n=this.breakOffsets[t]-e;return t>0&&(n+=this.wrappedTextIndentLength),n}getMaxOutputOffset(t){return this.getLineLength(t)}translateToInputOffset(t,e){t>0&&(e=Math.max(0,e-this.wrappedTextIndentLength));let n=t===0?e:this.breakOffsets[t-1]+e;if(this.injectionOffsets!==null)for(let o=0;o<this.injectionOffsets.length&&n>this.injectionOffsets[o];o++)n<this.injectionOffsets[o]+this.injectionOptions[o].content.length?n=this.injectionOffsets[o]:n-=this.injectionOptions[o].content.length;return n}translateToOutputPosition(t,e=2){let i=t;if(this.injectionOffsets!==null)for(let n=0;n<this.injectionOffsets.length&&!(t<this.injectionOffsets[n]||e!==1&&t===this.injectionOffsets[n]);n++)i+=this.injectionOptions[n].content.length;return this.offsetInInputWithInjectionsToOutputPosition(i,e)}offsetInInputWithInjectionsToOutputPosition(t,e=2){let i=0,n=this.breakOffsets.length-1,o=0,s=0;for(;i<=n;){o=i+(n-i)/2|0;let l=this.breakOffsets[o];if(s=o>0?this.breakOffsets[o-1]:0,e===0)if(t<=s)n=o-1;else if(t>l)i=o+1;else break;else if(t<s)n=o-1;else if(t>=l)i=o+1;else break}let a=t-s;return o>0&&(a+=this.wrappedTextIndentLength),new DC(o,a)}normalizeOutputPosition(t,e,i){if(this.injectionOffsets!==null){let n=this.outputPositionToOffsetInInputWithInjections(t,e),o=this.normalizeOffsetInInputWithInjectionsAroundInjections(n,i);if(o!==n)return this.offsetInInputWithInjectionsToOutputPosition(o,i)}if(i===0){if(t>0&&e===this.getMinOutputOffset(t))return new DC(t-1,this.getMaxOutputOffset(t-1))}else if(i===1){let n=this.getOutputLineCount()-1;if(t<n&&e===this.getMaxOutputOffset(t))return new DC(t+1,this.getMinOutputOffset(t+1))}return new DC(t,e)}outputPositionToOffsetInInputWithInjections(t,e){return t>0&&(e=Math.max(0,e-this.wrappedTextIndentLength)),(t>0?this.breakOffsets[t-1]:0)+e}normalizeOffsetInInputWithInjectionsAroundInjections(t,e){let i=this.getInjectedTextAtOffset(t);if(!i)return t;if(e===2){if(t===i.offsetInInputWithInjections+i.length&&ine(this.injectionOptions[i.injectedTextIndex].cursorStops))return i.offsetInInputWithInjections+i.length;{let n=i.offsetInInputWithInjections;if(nne(this.injectionOptions[i.injectedTextIndex].cursorStops))return n;let o=i.injectedTextIndex-1;for(;o>=0&&this.injectionOffsets[o]===this.injectionOffsets[i.injectedTextIndex]&&!(ine(this.injectionOptions[o].cursorStops)||(n-=this.injectionOptions[o].content.length,nne(this.injectionOptions[o].cursorStops)));)o--;return n}}else if(e===1||e===4){let n=i.offsetInInputWithInjections+i.length,o=i.injectedTextIndex;for(;o+1<this.injectionOffsets.length&&this.injectionOffsets[o+1]===this.injectionOffsets[o];)n+=this.injectionOptions[o+1].content.length,o++;return n}else if(e===0||e===3){let n=i.offsetInInputWithInjections,o=i.injectedTextIndex;for(;o-1>=0&&this.injectionOffsets[o-1]===this.injectionOffsets[o];)n-=this.injectionOptions[o-1].content.length,o--;return n}gm(e)}getInjectedText(t,e){let i=this.outputPositionToOffsetInInputWithInjections(t,e),n=this.getInjectedTextAtOffset(i);return n?{options:this.injectionOptions[n.injectedTextIndex]}:null}getInjectedTextAtOffset(t){let e=this.injectionOffsets,i=this.injectionOptions;if(e!==null){let n=0;for(let o=0;o<e.length;o++){let s=i[o].content.length,a=e[o]+n,l=e[o]+n+s;if(a>t)break;if(t<=l)return{injectedTextIndex:o,offsetInInputWithInjections:a,length:s};n+=s}}}};function ine(r){return r==null?!0:r===1||r===0}function nne(r){return r==null?!0:r===2||r===0}var DC=class{outputLineIndex;outputOffset;constructor(t,e){this.outputLineIndex=t,this.outputOffset=e}toString(){return`${this.outputLineIndex}:${this.outputOffset}`}toPosition(t){return new H(t+this.outputLineIndex,this.outputOffset+1)}};function kIe(r,t,e){let i=0;for(let o=0;o<r.length;o++)r.charAt(o)==="	"?i=tn.nextIndentTabStop(i,t):i++;let n="";if(!e){let o=Math.floor(i/t);i=i%t;for(let s=0;s<o;s++)n+="	"}for(let o=0;o<i;o++)n+=" ";return n}function m0(r,t,e){let i=Jn(r);return i===-1&&(i=r.length),kIe(r.substring(0,i),t,e)+r.substring(i)}var LIe=()=>!0,RIe=()=>!1,PIe=r=>r===" "||r==="	",Pm=class{constructor(t,e,i,n){this.languageConfigurationService=n;this._languageId=t;let o=i.options,s=o.get(147),a=o.get(51);this.readOnly=o.get(93),this.tabSize=e.tabSize,this.indentSize=e.indentSize,this.insertSpaces=e.insertSpaces,this.stickyTabStops=o.get(118),this.lineHeight=a.lineHeight,this.typicalHalfwidthCharacterWidth=a.typicalHalfwidthCharacterWidth,this.pageSize=Math.max(1,Math.floor(s.height/this.lineHeight)-2),this.useTabStops=o.get(130),this.wordSeparators=o.get(133),this.emptySelectionClipboard=o.get(38),this.copyWithSyntaxHighlighting=o.get(25),this.multiCursorMergeOverlapping=o.get(78),this.multiCursorPaste=o.get(80),this.multiCursorLimit=o.get(81),this.autoClosingBrackets=o.get(6),this.autoClosingComments=o.get(7),this.autoClosingQuotes=o.get(11),this.autoClosingDelete=o.get(9),this.autoClosingOvertype=o.get(10),this.autoSurround=o.get(14),this.autoIndent=o.get(12),this.wordSegmenterLocales=o.get(132),this.surroundingPairs={},this._electricChars=null,this.shouldAutoCloseBefore={quote:this._getShouldAutoClose(t,this.autoClosingQuotes,!0),comment:this._getShouldAutoClose(t,this.autoClosingComments,!1),bracket:this._getShouldAutoClose(t,this.autoClosingBrackets,!1)},this.autoClosingPairs=this.languageConfigurationService.getLanguageConfiguration(t).getAutoClosingPairs();let l=this.languageConfigurationService.getLanguageConfiguration(t).getSurroundingPairs();if(l)for(let c of l)this.surroundingPairs[c.open]=c.close;let d=this.languageConfigurationService.getLanguageConfiguration(t).comments;this.blockCommentStartToken=d?.blockCommentStartToken??null}_cursorMoveConfigurationBrand=void 0;readOnly;tabSize;indentSize;insertSpaces;stickyTabStops;pageSize;lineHeight;typicalHalfwidthCharacterWidth;useTabStops;wordSeparators;emptySelectionClipboard;copyWithSyntaxHighlighting;multiCursorMergeOverlapping;multiCursorPaste;multiCursorLimit;autoClosingBrackets;autoClosingComments;autoClosingQuotes;autoClosingDelete;autoClosingOvertype;autoSurround;autoIndent;autoClosingPairs;surroundingPairs;blockCommentStartToken;shouldAutoCloseBefore;wordSegmenterLocales;_languageId;_electricChars;static shouldRecreate(t){return t.hasChanged(147)||t.hasChanged(133)||t.hasChanged(38)||t.hasChanged(78)||t.hasChanged(80)||t.hasChanged(81)||t.hasChanged(6)||t.hasChanged(7)||t.hasChanged(11)||t.hasChanged(9)||t.hasChanged(10)||t.hasChanged(14)||t.hasChanged(130)||t.hasChanged(51)||t.hasChanged(93)||t.hasChanged(132)}get electricChars(){if(!this._electricChars){this._electricChars={};let t=this.languageConfigurationService.getLanguageConfiguration(this._languageId).electricCharacter?.getElectricCharacters();if(t)for(let e of t)this._electricChars[e]=!0}return this._electricChars}onElectricCharacter(t,e,i){let n=Bp(e,i-1),o=this.languageConfigurationService.getLanguageConfiguration(n.languageId).electricCharacter;return o?o.onElectricCharacter(t,n,i-n.firstCharOffset):null}normalizeIndentation(t){return m0(t,this.indentSize,this.insertSpaces)}_getShouldAutoClose(t,e,i){switch(e){case"beforeWhitespace":return PIe;case"languageDefined":return this._getLanguageDefinedShouldAutoClose(t,i);case"always":return LIe;case"never":return RIe}}_getLanguageDefinedShouldAutoClose(t,e){let i=this.languageConfigurationService.getLanguageConfiguration(t).getAutoCloseBeforeSet(e);return n=>i.indexOf(n)!==-1}visibleColumnFromColumn(t,e){return tn.visibleColumnFromColumn(t.getLineContent(e.lineNumber),e.column,this.tabSize)}columnFromVisibleColumn(t,e,i){let n=tn.columnFromVisibleColumn(t.getLineContent(e),i,this.tabSize),o=t.getLineMinColumn(e);if(n<o)return o;let s=t.getLineMaxColumn(e);return n>s?s:n}},Zt=class r{_cursorStateBrand=void 0;static fromModelState(t){return new s8(t)}static fromViewState(t){return new a8(t)}static fromModelSelection(t){let e=Et.liftSelection(t),i=new No(L.fromPositions(e.getSelectionStart()),0,0,e.getPosition(),0);return r.fromModelState(i)}static fromModelSelections(t){let e=[];for(let i=0,n=t.length;i<n;i++)e[i]=this.fromModelSelection(t[i]);return e}modelState;viewState;constructor(t,e){this.modelState=t,this.viewState=e}equals(t){return this.viewState.equals(t.viewState)&&this.modelState.equals(t.modelState)}},s8=class{modelState;viewState;constructor(t){this.modelState=t,this.viewState=null}},a8=class{modelState;viewState;constructor(t){this.modelState=null,this.viewState=t}};var No=class r{constructor(t,e,i,n,o){this.selectionStart=t;this.selectionStartKind=e;this.selectionStartLeftoverVisibleColumns=i;this.position=n;this.leftoverVisibleColumns=o;this.selection=r._computeSelection(this.selectionStart,this.position)}_singleCursorStateBrand=void 0;selection;equals(t){return this.selectionStartLeftoverVisibleColumns===t.selectionStartLeftoverVisibleColumns&&this.leftoverVisibleColumns===t.leftoverVisibleColumns&&this.selectionStartKind===t.selectionStartKind&&this.position.equals(t.position)&&this.selectionStart.equalsRange(t.selectionStart)}hasSelection(){return!this.selection.isEmpty()||!this.selectionStart.isEmpty()}move(t,e,i,n){return t?new r(this.selectionStart,this.selectionStartKind,this.selectionStartLeftoverVisibleColumns,new H(e,i),n):new r(new L(e,i,e,i),0,n,new H(e,i),n)}static _computeSelection(t,e){return t.isEmpty()||!e.isBeforeOrEqual(t.getStartPosition())?Et.fromPositions(t.getStartPosition(),e):Et.fromPositions(t.getEndPosition(),e)}},hr=class{_editOperationResultBrand=void 0;type;commands;shouldPushStackElementBefore;shouldPushStackElementAfter;constructor(t,e,i){this.type=t,this.commands=e,this.shouldPushStackElementBefore=i.shouldPushStackElementBefore,this.shouldPushStackElementAfter=i.shouldPushStackElementAfter}};function mu(r){return r==="'"||r==='"'||r==="`"}function g0(r){return`--vscode-${r.replace(/\./g,"-")}`}function Se(r){return`var(${g0(r)})`}function ek(r,t){return`var(${g0(r)}, ${t})`}function MIe(r){return r!==null&&typeof r=="object"&&"light"in r&&"dark"in r}var AIe={ColorContribution:"base.contributions.colors"},OIe="default",l8=class{_onDidChangeSchema=new x;onDidChangeSchema=this._onDidChangeSchema.event;colorsById;colorSchema={type:"object",properties:{}};colorReferenceSchema={type:"string",enum:[],enumDescriptions:[]};constructor(){this.colorsById={}}notifyThemeUpdate(t){for(let e of Object.keys(this.colorsById)){let i=t.getColor(e);i&&(this.colorSchema.properties[e].oneOf[0].defaultSnippets[0].body=`\${1:${i.toString()}}`)}this._onDidChangeSchema.fire()}registerColor(t,e,i,n=!1,o){let s={id:t,description:i,defaults:e,needsTransparency:n,deprecationMessage:o};this.colorsById[t]=s;let a={type:"string",format:"color-hex",defaultSnippets:[{body:"${1:#ff0000}"}]};return o&&(a.deprecationMessage=o),n&&(a.pattern="^#(?:(?<rgba>[0-9a-fA-f]{3}[0-9a-eA-E])|(?:[0-9a-fA-F]{6}(?:(?![fF]{2})(?:[0-9a-fA-F]{2}))))?$",a.patternErrorMessage=u("transparecyRequired","This color must be transparent or it will obscure content")),this.colorSchema.properties[t]={description:i,oneOf:[a,{type:"string",const:OIe,description:u("useDefault","Use the default color.")}]},this.colorReferenceSchema.enum.push(t),this.colorReferenceSchema.enumDescriptions.push(i),this._onDidChangeSchema.fire(),t}deregisterColor(t){delete this.colorsById[t],delete this.colorSchema.properties[t];let e=this.colorReferenceSchema.enum.indexOf(t);e!==-1&&(this.colorReferenceSchema.enum.splice(e,1),this.colorReferenceSchema.enumDescriptions.splice(e,1)),this._onDidChangeSchema.fire()}getColors(){return Object.keys(this.colorsById).map(t=>this.colorsById[t])}resolveDefaultColor(t,e){let i=this.colorsById[t];if(i?.defaults){let n=MIe(i.defaults)?i.defaults[e.type]:i.defaults;return Td(n,e)}}getColorSchema(){return this.colorSchema}getColorReferenceSchema(){return this.colorReferenceSchema}toString(){let t=(e,i)=>{let n=e.indexOf(".")===-1?0:1,o=i.indexOf(".")===-1?0:1;return n!==o?n-o:e.localeCompare(i)};return Object.keys(this.colorsById).sort(t).map(e=>`- \`${e}\`: ${this.colorsById[e].description}`).join(`
`)}},f0=new l8;Pe.add(AIe.ColorContribution,f0);function T(r,t,e,i,n){return f0.registerColor(r,t,e,i,n)}function NIe(r,t){switch(r.op){case 0:return Td(r.value,t)?.darken(r.factor);case 1:return Td(r.value,t)?.lighten(r.factor);case 2:return Td(r.value,t)?.transparent(r.factor);case 3:{let e=Td(r.background,t);return e?Td(r.value,t)?.makeOpaque(e):Td(r.value,t)}case 4:for(let e of r.values){let i=Td(e,t);if(i)return i}return;case 6:return Td(t.defines(r.if)?r.then:r.else,t);case 5:{let e=Td(r.value,t);if(!e)return;let i=Td(r.background,t);return i?e.isDarkerThan(i)?j.getLighterColor(e,i,r.factor).transparent(r.transparency):j.getDarkerColor(e,i,r.factor).transparent(r.transparency):e.transparent(r.factor*r.transparency)}default:throw gm(r)}}function ia(r,t){return{op:0,value:r,factor:t}}function wa(r,t){return{op:1,value:r,factor:t}}function Ne(r,t){return{op:2,value:r,factor:t}}function d8(...r){return{op:4,values:r}}function sne(r,t,e){return{op:6,if:r,then:t,else:e}}function c8(r,t,e,i){return{op:5,value:r,background:t,factor:e,transparency:i}}function Td(r,t){if(r!==null){if(typeof r=="string")return r[0]==="#"?j.fromHex(r):t.getColor(r);if(r instanceof j)return r;if(typeof r=="object")return NIe(r,t)}}var ane="vscode://schemas/workbench-colors",lne=Pe.as(wd.JSONContribution);lne.registerSchema(ane,f0.getColorSchema());var rne=new Ye(()=>lne.notifySchemaChanged(ane),200);f0.onDidChangeSchema(()=>{rne.isScheduled()||rne.schedule()});var st=T("foreground",{dark:"#CCCCCC",light:"#616161",hcDark:"#FFFFFF",hcLight:"#292929"},u("foreground","Overall foreground color. This color is only used if not overridden by a component.")),e3e=T("disabledForeground",{dark:"#CCCCCC80",light:"#61616180",hcDark:"#A5A5A5",hcLight:"#7F7F7F"},u("disabledForeground","Overall foreground for disabled elements. This color is only used if not overridden by a component.")),tk=T("errorForeground",{dark:"#F48771",light:"#A1260D",hcDark:"#F48771",hcLight:"#B5200D"},u("errorForeground","Overall foreground color for error messages. This color is only used if not overridden by a component.")),t3e=T("descriptionForeground",{light:"#717171",dark:Ne(st,.7),hcDark:Ne(st,.7),hcLight:Ne(st,.7)},u("descriptionForeground","Foreground color for description text providing additional information, for example for a label.")),ik=T("icon.foreground",{dark:"#C5C5C5",light:"#424242",hcDark:"#FFFFFF",hcLight:"#292929"},u("iconForeground","The default color for icons in the workbench.")),na=T("focusBorder",{dark:"#007FD4",light:"#0090F1",hcDark:"#F38518",hcLight:"#006BBD"},u("focusBorder","Overall border color for focused elements. This color is only used if not overridden by a component.")),Oe=T("contrastBorder",{light:null,dark:null,hcDark:"#6FC3DF",hcLight:"#0F4A85"},u("contrastBorder","An extra border around elements to separate them from others for greater contrast.")),fi=T("contrastActiveBorder",{light:null,dark:null,hcDark:na,hcLight:na},u("activeContrastBorder","An extra border around active elements to separate them from others for greater contrast.")),FIe=T("selection.background",null,u("selectionBackground","The background color of text selections in the workbench (e.g. for input fields or text areas). Note that this does not apply to selections within the editor.")),wI=T("textLink.foreground",{light:"#006AB1",dark:"#3794FF",hcDark:"#21A6FF",hcLight:"#0F4A85"},u("textLinkForeground","Foreground color for links in text.")),i3e=T("textLink.activeForeground",{light:"#006AB1",dark:"#3794FF",hcDark:"#21A6FF",hcLight:"#0F4A85"},u("textLinkActiveForeground","Foreground color for links in text when clicked on and on mouse hover.")),n3e=T("textSeparator.foreground",{light:"#0000002e",dark:"#ffffff2e",hcDark:j.black,hcLight:"#292929"},u("textSeparatorForeground","Color for text separators.")),o3e=T("textPreformat.foreground",{light:"#A31515",dark:"#D7BA7D",hcDark:"#000000",hcLight:"#FFFFFF"},u("textPreformatForeground","Foreground color for preformatted text segments.")),r3e=T("textPreformat.background",{light:"#0000001A",dark:"#FFFFFF1A",hcDark:"#FFFFFF",hcLight:"#09345f"},u("textPreformatBackground","Background color for preformatted text segments.")),s3e=T("textBlockQuote.background",{light:"#f2f2f2",dark:"#222222",hcDark:null,hcLight:"#F2F2F2"},u("textBlockQuoteBackground","Background color for block quotes in text.")),a3e=T("textBlockQuote.border",{light:"#007acc80",dark:"#007acc80",hcDark:j.white,hcLight:"#292929"},u("textBlockQuoteBorder","Border color for block quotes in text.")),l3e=T("textCodeBlock.background",{light:"#dcdcdc66",dark:"#0a0a0a66",hcDark:j.black,hcLight:"#F2F2F2"},u("textCodeBlockBackground","Background color for code blocks in text."));var h3e=T("sash.hoverBorder",na,u("sashActiveBorder","Border color of active sashes.")),gc=T("badge.background",{dark:"#4D4D4D",light:"#C4C4C4",hcDark:j.black,hcLight:"#0F4A85"},u("badgeBackground","Badge background color. Badges are small information labels, e.g. for search results count.")),Rf=T("badge.foreground",{dark:j.white,light:"#333",hcDark:j.white,hcLight:j.white},u("badgeForeground","Badge foreground color. Badges are small information labels, e.g. for search results count.")),Pf=T("scrollbar.shadow",{dark:"#000000",light:"#DDDDDD",hcDark:null,hcLight:null},u("scrollbarShadow","Scrollbar shadow to indicate that the view is scrolled.")),b0=T("scrollbarSlider.background",{dark:j.fromHex("#797979").transparent(.4),light:j.fromHex("#646464").transparent(.4),hcDark:Ne(Oe,.6),hcLight:Ne(Oe,.4)},u("scrollbarSliderBackground","Scrollbar slider background color.")),v0=T("scrollbarSlider.hoverBackground",{dark:j.fromHex("#646464").transparent(.7),light:j.fromHex("#646464").transparent(.7),hcDark:Ne(Oe,.8),hcLight:Ne(Oe,.8)},u("scrollbarSliderHoverBackground","Scrollbar slider background color when hovering.")),I0=T("scrollbarSlider.activeBackground",{dark:j.fromHex("#BFBFBF").transparent(.4),light:j.fromHex("#000000").transparent(.6),hcDark:Oe,hcLight:Oe},u("scrollbarSliderActiveBackground","Scrollbar slider background color when clicked on.")),dne=T("progressBar.background",{dark:j.fromHex("#0E70C0"),light:j.fromHex("#0E70C0"),hcDark:Oe,hcLight:Oe},u("progressBarBackground","Background color of the progress bar that can show for long running operations."));var Hs=T("editor.background",{light:"#ffffff",dark:"#1E1E1E",hcDark:j.black,hcLight:j.white},u("editorBackground","Editor background color.")),Qo=T("editor.foreground",{light:"#333333",dark:"#BBBBBB",hcDark:j.white,hcLight:st},u("editorForeground","Editor default foreground color.")),I3e=T("editorStickyScroll.background",Hs,u("editorStickyScrollBackground","Background color of sticky scroll in the editor")),y3e=T("editorStickyScrollHover.background",{dark:"#2A2D2E",light:"#F0F0F0",hcDark:null,hcLight:j.fromHex("#0F4A85").transparent(.1)},u("editorStickyScrollHoverBackground","Background color of sticky scroll on hover in the editor")),S3e=T("editorStickyScroll.border",{dark:null,light:null,hcDark:Oe,hcLight:Oe},u("editorStickyScrollBorder","Border color of sticky scroll in the editor")),C3e=T("editorStickyScroll.shadow",Pf,u("editorStickyScrollShadow"," Shadow color of sticky scroll in the editor")),xr=T("editorWidget.background",{dark:"#252526",light:"#F3F3F3",hcDark:"#0C141F",hcLight:j.white},u("editorWidgetBackground","Background color of editor widgets, such as find/replace.")),Wp=T("editorWidget.foreground",st,u("editorWidgetForeground","Foreground color of editor widgets, such as find/replace.")),nk=T("editorWidget.border",{dark:"#454545",light:"#C8C8C8",hcDark:Oe,hcLight:Oe},u("editorWidgetBorder","Border color of editor widgets. The color is only used if the widget chooses to have a border and if the color is not overridden by a widget.")),w3e=T("editorWidget.resizeBorder",null,u("editorWidgetResizeBorder","Border color of the resize bar of editor widgets. The color is only used if the widget chooses to have a resize border and if the color is not overridden by a widget.")),E3e=T("editorError.background",null,u("editorError.background","Background color of error text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0),xI=T("editorError.foreground",{dark:"#F14C4C",light:"#E51400",hcDark:"#F48771",hcLight:"#B5200D"},u("editorError.foreground","Foreground color of error squigglies in the editor.")),x3e=T("editorError.border",{dark:null,light:null,hcDark:j.fromHex("#E47777").transparent(.8),hcLight:"#B5200D"},u("errorBorder","If set, color of double underlines for errors in the editor.")),hne=T("editorWarning.background",null,u("editorWarning.background","Background color of warning text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0),Zr=T("editorWarning.foreground",{dark:"#CCA700",light:"#BF8803",hcDark:"#FFD370",hcLight:"#895503"},u("editorWarning.foreground","Foreground color of warning squigglies in the editor.")),RC=T("editorWarning.border",{dark:null,light:null,hcDark:j.fromHex("#FFCC00").transparent(.8),hcLight:j.fromHex("#FFCC00").transparent(.8)},u("warningBorder","If set, color of double underlines for warnings in the editor.")),T3e=T("editorInfo.background",null,u("editorInfo.background","Background color of info text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0),Jr=T("editorInfo.foreground",{dark:"#3794FF",light:"#1a85ff",hcDark:"#3794FF",hcLight:"#1a85ff"},u("editorInfo.foreground","Foreground color of info squigglies in the editor.")),PC=T("editorInfo.border",{dark:null,light:null,hcDark:j.fromHex("#3794FF").transparent(.8),hcLight:"#292929"},u("infoBorder","If set, color of double underlines for infos in the editor.")),mne=T("editorHint.foreground",{dark:j.fromHex("#eeeeee").transparent(.7),light:"#6c6c6c",hcDark:null,hcLight:null},u("editorHint.foreground","Foreground color of hint squigglies in the editor.")),_3e=T("editorHint.border",{dark:null,light:null,hcDark:j.fromHex("#eeeeee").transparent(.8),hcLight:"#292929"},u("hintBorder","If set, color of double underlines for hints in the editor.")),gne=T("editorLink.activeForeground",{dark:"#4E94CE",light:j.blue,hcDark:j.cyan,hcLight:"#292929"},u("activeLinkForeground","Color of active links.")),Mm=T("editor.selectionBackground",{light:"#ADD6FF",dark:"#264F78",hcDark:"#f3f518",hcLight:"#0F4A85"},u("editorSelectionBackground","Color of the editor selection.")),fne=T("editor.selectionForeground",{light:null,dark:null,hcDark:"#000000",hcLight:j.white},u("editorSelectionForeground","Color of the selected text for high contrast.")),D3e=T("editor.inactiveSelectionBackground",{light:Ne(Mm,.5),dark:Ne(Mm,.5),hcDark:Ne(Mm,.7),hcLight:Ne(Mm,.5)},u("editorInactiveSelection","Color of the selection in an inactive editor. The color must not be opaque so as not to hide underlying decorations."),!0),k3e=T("editor.selectionHighlightBackground",{light:c8(Mm,Hs,.3,.6),dark:c8(Mm,Hs,.3,.6),hcDark:null,hcLight:null},u("editorSelectionHighlight","Color for regions with the same content as the selection. The color must not be opaque so as not to hide underlying decorations."),!0),L3e=T("editor.selectionHighlightBorder",{light:null,dark:null,hcDark:fi,hcLight:fi},u("editorSelectionHighlightBorder","Border color for regions with the same content as the selection.")),m8=T("editor.findMatchBackground",{light:"#A8AC94",dark:"#515C6A",hcDark:null,hcLight:null},u("editorFindMatch","Color of the current search match.")),R3e=T("editor.findMatchForeground",null,u("editorFindMatchForeground","Text color of the current search match.")),Ol=T("editor.findMatchHighlightBackground",{light:"#EA5C0055",dark:"#EA5C0055",hcDark:null,hcLight:null},u("findMatchHighlight","Color of the other search matches. The color must not be opaque so as not to hide underlying decorations."),!0),P3e=T("editor.findMatchHighlightForeground",null,u("findMatchHighlightForeground","Foreground color of the other search matches."),!0),M3e=T("editor.findRangeHighlightBackground",{dark:"#3a3d4166",light:"#b4b4b44d",hcDark:null,hcLight:null},u("findRangeHighlight","Color of the range limiting the search. The color must not be opaque so as not to hide underlying decorations."),!0),A3e=T("editor.findMatchBorder",{light:null,dark:null,hcDark:fi,hcLight:fi},u("editorFindMatchBorder","Border color of the current search match.")),Af=T("editor.findMatchHighlightBorder",{light:null,dark:null,hcDark:fi,hcLight:fi},u("findMatchHighlightBorder","Border color of the other search matches.")),O3e=T("editor.findRangeHighlightBorder",{dark:null,light:null,hcDark:Ne(fi,.4),hcLight:Ne(fi,.4)},u("findRangeHighlightBorder","Border color of the range limiting the search. The color must not be opaque so as not to hide underlying decorations."),!0),bne=T("editor.hoverHighlightBackground",{light:"#ADD6FF26",dark:"#264f7840",hcDark:"#ADD6FF26",hcLight:null},u("hoverHighlight","Highlight below the word for which a hover is shown. The color must not be opaque so as not to hide underlying decorations."),!0),Mf=T("editorHoverWidget.background",xr,u("hoverBackground","Background color of the editor hover.")),vne=T("editorHoverWidget.foreground",Wp,u("hoverForeground","Foreground color of the editor hover.")),Ine=T("editorHoverWidget.border",nk,u("hoverBorder","Border color of the editor hover.")),N3e=T("editorHoverWidget.statusBarBackground",{dark:wa(Mf,.2),light:ia(Mf,.05),hcDark:xr,hcLight:xr},u("statusBarBackground","Background color of the editor hover status bar.")),C0=T("editorInlayHint.foreground",{dark:"#969696",light:"#969696",hcDark:j.white,hcLight:j.black},u("editorInlayHintForeground","Foreground color of inline hints")),w0=T("editorInlayHint.background",{dark:Ne(gc,.1),light:Ne(gc,.1),hcDark:Ne(j.white,.1),hcLight:Ne(gc,.1)},u("editorInlayHintBackground","Background color of inline hints")),yne=T("editorInlayHint.typeForeground",C0,u("editorInlayHintForegroundTypes","Foreground color of inline hints for types")),Sne=T("editorInlayHint.typeBackground",w0,u("editorInlayHintBackgroundTypes","Background color of inline hints for types")),Cne=T("editorInlayHint.parameterForeground",C0,u("editorInlayHintForegroundParameter","Foreground color of inline hints for parameters")),wne=T("editorInlayHint.parameterBackground",w0,u("editorInlayHintBackgroundParameter","Background color of inline hints for parameters")),BIe=T("editorLightBulb.foreground",{dark:"#FFCC00",light:"#DDB100",hcDark:"#FFCC00",hcLight:"#007ACC"},u("editorLightBulbForeground","The color used for the lightbulb actions icon.")),F3e=T("editorLightBulbAutoFix.foreground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},u("editorLightBulbAutoFixForeground","The color used for the lightbulb auto fix actions icon.")),B3e=T("editorLightBulbAi.foreground",BIe,u("editorLightBulbAiForeground","The color used for the lightbulb AI icon.")),V3e=T("editor.snippetTabstopHighlightBackground",{dark:new j(new xt(124,124,124,.3)),light:new j(new xt(10,50,100,.2)),hcDark:new j(new xt(124,124,124,.3)),hcLight:new j(new xt(10,50,100,.2))},u("snippetTabstopHighlightBackground","Highlight background color of a snippet tabstop.")),W3e=T("editor.snippetTabstopHighlightBorder",null,u("snippetTabstopHighlightBorder","Highlight border color of a snippet tabstop.")),H3e=T("editor.snippetFinalTabstopHighlightBackground",null,u("snippetFinalTabstopHighlightBackground","Highlight background color of the final tabstop of a snippet.")),U3e=T("editor.snippetFinalTabstopHighlightBorder",{dark:"#525252",light:new j(new xt(10,50,100,.5)),hcDark:"#525252",hcLight:"#292929"},u("snippetFinalTabstopHighlightBorder","Highlight border color of the final tabstop of a snippet.")),y0=new j(new xt(155,185,85,.2)),S0=new j(new xt(255,0,0,.2)),Ene=T("diffEditor.insertedTextBackground",{dark:"#9ccc2c33",light:"#9ccc2c40",hcDark:null,hcLight:null},u("diffEditorInserted","Background color for text that got inserted. The color must not be opaque so as not to hide underlying decorations."),!0),xne=T("diffEditor.removedTextBackground",{dark:"#ff000033",light:"#ff000033",hcDark:null,hcLight:null},u("diffEditorRemoved","Background color for text that got removed. The color must not be opaque so as not to hide underlying decorations."),!0),z3e=T("diffEditor.insertedLineBackground",{dark:y0,light:y0,hcDark:null,hcLight:null},u("diffEditorInsertedLines","Background color for lines that got inserted. The color must not be opaque so as not to hide underlying decorations."),!0),K3e=T("diffEditor.removedLineBackground",{dark:S0,light:S0,hcDark:null,hcLight:null},u("diffEditorRemovedLines","Background color for lines that got removed. The color must not be opaque so as not to hide underlying decorations."),!0),G3e=T("diffEditorGutter.insertedLineBackground",null,u("diffEditorInsertedLineGutter","Background color for the margin where lines got inserted.")),q3e=T("diffEditorGutter.removedLineBackground",null,u("diffEditorRemovedLineGutter","Background color for the margin where lines got removed.")),Tne=T("diffEditorOverview.insertedForeground",null,u("diffEditorOverviewInserted","Diff overview ruler foreground for inserted content.")),_ne=T("diffEditorOverview.removedForeground",null,u("diffEditorOverviewRemoved","Diff overview ruler foreground for removed content.")),$3e=T("diffEditor.insertedTextBorder",{dark:null,light:null,hcDark:"#33ff2eff",hcLight:"#374E06"},u("diffEditorInsertedOutline","Outline color for the text that got inserted.")),j3e=T("diffEditor.removedTextBorder",{dark:null,light:null,hcDark:"#FF008F",hcLight:"#AD0707"},u("diffEditorRemovedOutline","Outline color for text that got removed.")),X3e=T("diffEditor.border",{dark:null,light:null,hcDark:Oe,hcLight:Oe},u("diffEditorBorder","Border color between the two text editors.")),Y3e=T("diffEditor.diagonalFill",{dark:"#cccccc33",light:"#22222233",hcDark:null,hcLight:null},u("diffDiagonalFill","Color of the diff editor's diagonal fill. The diagonal fill is used in side-by-side diff views.")),Q3e=T("diffEditor.unchangedRegionBackground","sideBar.background",u("diffEditor.unchangedRegionBackground","The background color of unchanged blocks in the diff editor.")),Z3e=T("diffEditor.unchangedRegionForeground","foreground",u("diffEditor.unchangedRegionForeground","The foreground color of unchanged blocks in the diff editor.")),J3e=T("diffEditor.unchangedCodeBackground",{dark:"#74747429",light:"#b8b8b829",hcDark:null,hcLight:null},u("diffEditor.unchangedCodeBackground","The background color of unchanged code in the diff editor.")),Hp=T("widget.shadow",{dark:Ne(j.black,.36),light:Ne(j.black,.16),hcDark:null,hcLight:null},u("widgetShadow","Shadow color of widgets such as find/replace inside the editor.")),Am=T("widget.border",{dark:null,light:null,hcDark:Oe,hcLight:Oe},u("widgetBorder","Border color of widgets such as find/replace inside the editor.")),EI=T("toolbar.hoverBackground",{dark:"#5a5d5e50",light:"#b8b8b850",hcDark:null,hcLight:null},u("toolbarHoverBackground","Toolbar background when hovering over actions using the mouse")),e7e=T("toolbar.hoverOutline",{dark:null,light:null,hcDark:fi,hcLight:fi},u("toolbarHoverOutline","Toolbar outline when hovering over actions using the mouse")),t7e=T("toolbar.activeBackground",{dark:wa(EI,.1),light:ia(EI,.1),hcDark:null,hcLight:null},u("toolbarActiveBackground","Toolbar background when holding the mouse over actions")),Dne=T("breadcrumb.foreground",Ne(st,.8),u("breadcrumbsFocusForeground","Color of focused breadcrumb items.")),kne=T("breadcrumb.background",Hs,u("breadcrumbsBackground","Background color of breadcrumb items.")),g8=T("breadcrumb.focusForeground",{light:ia(st,.2),dark:wa(st,.1),hcDark:wa(st,.1),hcLight:wa(st,.1)},u("breadcrumbsFocusForeground","Color of focused breadcrumb items.")),Lne=T("breadcrumb.activeSelectionForeground",{light:ia(st,.2),dark:wa(st,.1),hcDark:wa(st,.1),hcLight:wa(st,.1)},u("breadcrumbsSelectedForeground","Color of selected breadcrumb items.")),f8=T("breadcrumbPicker.background",xr,u("breadcrumbsSelectedBackground","Background color of breadcrumb item picker.")),Rne=.5,cne=j.fromHex("#40C8AE").transparent(Rne),une=j.fromHex("#40A6FF").transparent(Rne),pne=j.fromHex("#606060").transparent(.4),b8=.4,kC=1,u8=T("merge.currentHeaderBackground",{dark:cne,light:cne,hcDark:null,hcLight:null},u("mergeCurrentHeaderBackground","Current header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),i7e=T("merge.currentContentBackground",Ne(u8,b8),u("mergeCurrentContentBackground","Current content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),p8=T("merge.incomingHeaderBackground",{dark:une,light:une,hcDark:null,hcLight:null},u("mergeIncomingHeaderBackground","Incoming header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),n7e=T("merge.incomingContentBackground",Ne(p8,b8),u("mergeIncomingContentBackground","Incoming content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),h8=T("merge.commonHeaderBackground",{dark:pne,light:pne,hcDark:null,hcLight:null},u("mergeCommonHeaderBackground","Common ancestor header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),o7e=T("merge.commonContentBackground",Ne(h8,b8),u("mergeCommonContentBackground","Common ancestor content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),LC=T("merge.border",{dark:null,light:null,hcDark:"#C3DF6F",hcLight:"#007ACC"},u("mergeBorder","Border color on headers and the splitter in inline merge-conflicts.")),r7e=T("editorOverviewRuler.currentContentForeground",{dark:Ne(u8,kC),light:Ne(u8,kC),hcDark:LC,hcLight:LC},u("overviewRulerCurrentContentForeground","Current overview ruler foreground for inline merge-conflicts.")),s7e=T("editorOverviewRuler.incomingContentForeground",{dark:Ne(p8,kC),light:Ne(p8,kC),hcDark:LC,hcLight:LC},u("overviewRulerIncomingContentForeground","Incoming overview ruler foreground for inline merge-conflicts.")),a7e=T("editorOverviewRuler.commonContentForeground",{dark:Ne(h8,kC),light:Ne(h8,kC),hcDark:LC,hcLight:LC},u("overviewRulerCommonContentForeground","Common ancestor overview ruler foreground for inline merge-conflicts.")),v8=T("editorOverviewRuler.findMatchForeground",{dark:"#d186167e",light:"#d186167e",hcDark:"#AB5A00",hcLight:"#AB5A00"},u("overviewRulerFindMatchForeground","Overview ruler marker color for find matches. The color must not be opaque so as not to hide underlying decorations."),!0),l7e=T("editorOverviewRuler.selectionHighlightForeground","#A0A0A0CC",u("overviewRulerSelectionHighlightForeground","Overview ruler marker color for selection highlights. The color must not be opaque so as not to hide underlying decorations."),!0),Pne=T("problemsErrorIcon.foreground",xI,u("problemsErrorIconForeground","The color used for the problems error icon.")),Mne=T("problemsWarningIcon.foreground",Zr,u("problemsWarningIconForeground","The color used for the problems warning icon.")),Ane=T("problemsInfoIcon.foreground",Jr,u("problemsInfoIconForeground","The color used for the problems info icon."));var One=T("minimap.findMatchHighlight",{light:"#d18616",dark:"#d18616",hcDark:"#AB5A00",hcLight:"#0F4A85"},u("minimapFindMatchHighlight","Minimap marker color for find matches."),!0),m7e=T("minimap.selectionOccurrenceHighlight",{light:"#c9c9c9",dark:"#676767",hcDark:"#ffffff",hcLight:"#0F4A85"},u("minimapSelectionOccurrenceHighlight","Minimap marker color for repeating editor selections."),!0),I8=T("minimap.selectionHighlight",{light:"#ADD6FF",dark:"#264F78",hcDark:"#ffffff",hcLight:"#0F4A85"},u("minimapSelectionHighlight","Minimap marker color for the editor selection."),!0),g7e=T("minimap.infoHighlight",{dark:Jr,light:Jr,hcDark:PC,hcLight:PC},u("minimapInfo","Minimap marker color for infos.")),f7e=T("minimap.warningHighlight",{dark:Zr,light:Zr,hcDark:RC,hcLight:RC},u("overviewRuleWarning","Minimap marker color for warnings.")),b7e=T("minimap.errorHighlight",{dark:new j(new xt(255,18,18,.7)),light:new j(new xt(255,18,18,.7)),hcDark:new j(new xt(255,50,50,1)),hcLight:"#B5200D"},u("minimapError","Minimap marker color for errors.")),Nne=T("minimap.background",null,u("minimapBackground","Minimap background color.")),Fne=T("minimap.foregroundOpacity",j.fromHex("#000f"),u("minimapForegroundOpacity",'Opacity of foreground elements rendered in the minimap. For example, "#000000c0" will render the elements with 75% opacity.')),v7e=T("minimapSlider.background",Ne(b0,.5),u("minimapSliderBackground","Minimap slider background color.")),I7e=T("minimapSlider.hoverBackground",Ne(v0,.5),u("minimapSliderHoverBackground","Minimap slider background color when hovering.")),y7e=T("minimapSlider.activeBackground",Ne(I0,.5),u("minimapSliderActiveBackground","Minimap slider background color when clicked on."));var T7e=T("charts.foreground",st,u("chartsForeground","The foreground color used in charts.")),_7e=T("charts.lines",Ne(st,.5),u("chartsLines","The color used for horizontal lines in charts.")),D7e=T("charts.red",xI,u("chartsRed","The red color used in chart visualizations.")),k7e=T("charts.blue",Jr,u("chartsBlue","The blue color used in chart visualizations.")),L7e=T("charts.yellow",Zr,u("chartsYellow","The yellow color used in chart visualizations.")),R7e=T("charts.orange",One,u("chartsOrange","The orange color used in chart visualizations.")),P7e=T("charts.green",{dark:"#89D185",light:"#388A34",hcDark:"#89D185",hcLight:"#374e06"},u("chartsGreen","The green color used in chart visualizations.")),M7e=T("charts.purple",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},u("chartsPurple","The purple color used in chart visualizations."));var y8=T("input.background",{dark:"#3C3C3C",light:j.white,hcDark:j.black,hcLight:j.white},u("inputBoxBackground","Input box background.")),S8=T("input.foreground",st,u("inputBoxForeground","Input box foreground.")),Nf=T("input.border",{dark:null,light:null,hcDark:Oe,hcLight:Oe},u("inputBoxBorder","Input box border.")),C8=T("inputOption.activeBorder",{dark:"#007ACC",light:"#007ACC",hcDark:Oe,hcLight:Oe},u("inputBoxActiveOptionBorder","Border color of activated options in input fields.")),VIe=T("inputOption.hoverBackground",{dark:"#5a5d5e80",light:"#b8b8b850",hcDark:null,hcLight:null},u("inputOption.hoverBackground","Background color of activated options in input fields.")),w8=T("inputOption.activeBackground",{dark:Ne(na,.4),light:Ne(na,.2),hcDark:j.transparent,hcLight:j.transparent},u("inputOption.activeBackground","Background hover color of options in input fields.")),E8=T("inputOption.activeForeground",{dark:j.white,light:j.black,hcDark:st,hcLight:st},u("inputOption.activeForeground","Foreground color of activated options in input fields.")),V7e=T("input.placeholderForeground",{light:Ne(st,.5),dark:Ne(st,.5),hcDark:Ne(st,.7),hcLight:Ne(st,.7)},u("inputPlaceholderForeground","Input box foreground color for placeholder text.")),Bne=T("inputValidation.infoBackground",{dark:"#063B49",light:"#D6ECF2",hcDark:j.black,hcLight:j.white},u("inputValidationInfoBackground","Input validation background color for information severity.")),Vne=T("inputValidation.infoForeground",{dark:null,light:null,hcDark:null,hcLight:st},u("inputValidationInfoForeground","Input validation foreground color for information severity.")),Wne=T("inputValidation.infoBorder",{dark:"#007acc",light:"#007acc",hcDark:Oe,hcLight:Oe},u("inputValidationInfoBorder","Input validation border color for information severity.")),Hne=T("inputValidation.warningBackground",{dark:"#352A05",light:"#F6F5D2",hcDark:j.black,hcLight:j.white},u("inputValidationWarningBackground","Input validation background color for warning severity.")),Une=T("inputValidation.warningForeground",{dark:null,light:null,hcDark:null,hcLight:st},u("inputValidationWarningForeground","Input validation foreground color for warning severity.")),zne=T("inputValidation.warningBorder",{dark:"#B89500",light:"#B89500",hcDark:Oe,hcLight:Oe},u("inputValidationWarningBorder","Input validation border color for warning severity.")),Kne=T("inputValidation.errorBackground",{dark:"#5A1D1D",light:"#F2DEDE",hcDark:j.black,hcLight:j.white},u("inputValidationErrorBackground","Input validation background color for error severity.")),Gne=T("inputValidation.errorForeground",{dark:null,light:null,hcDark:null,hcLight:st},u("inputValidationErrorForeground","Input validation foreground color for error severity.")),qne=T("inputValidation.errorBorder",{dark:"#BE1100",light:"#BE1100",hcDark:Oe,hcLight:Oe},u("inputValidationErrorBorder","Input validation border color for error severity.")),Ff=T("dropdown.background",{dark:"#3C3C3C",light:j.white,hcDark:j.black,hcLight:j.white},u("dropdownBackground","Dropdown background.")),$ne=T("dropdown.listBackground",{dark:null,light:null,hcDark:j.black,hcLight:j.white},u("dropdownListBackground","Dropdown list background.")),ok=T("dropdown.foreground",{dark:"#F0F0F0",light:st,hcDark:j.white,hcLight:st},u("dropdownForeground","Dropdown foreground.")),Bf=T("dropdown.border",{dark:Ff,light:"#CECECE",hcDark:Oe,hcLight:Oe},u("dropdownBorder","Dropdown border.")),rk=T("button.foreground",j.white,u("buttonForeground","Button foreground color.")),jne=T("button.separator",Ne(rk,.4),u("buttonSeparator","Button separator color.")),Of=T("button.background",{dark:"#0E639C",light:"#007ACC",hcDark:null,hcLight:"#0F4A85"},u("buttonBackground","Button background color.")),Xne=T("button.hoverBackground",{dark:wa(Of,.2),light:ia(Of,.2),hcDark:Of,hcLight:Of},u("buttonHoverBackground","Button background color when hovering.")),Yne=T("button.border",Oe,u("buttonBorder","Button border color.")),Qne=T("button.secondaryForeground",{dark:j.white,light:j.white,hcDark:j.white,hcLight:st},u("buttonSecondaryForeground","Secondary button foreground color.")),E0=T("button.secondaryBackground",{dark:"#3A3D41",light:"#5F6A79",hcDark:null,hcLight:j.white},u("buttonSecondaryBackground","Secondary button background color.")),Zne=T("button.secondaryHoverBackground",{dark:wa(E0,.2),light:ia(E0,.2),hcDark:null,hcLight:null},u("buttonSecondaryHoverBackground","Secondary button background color when hovering.")),MC=T("radio.activeForeground",E8,u("radioActiveForeground","Foreground color of active radio option.")),Jne=T("radio.activeBackground",w8,u("radioBackground","Background color of active radio option.")),eoe=T("radio.activeBorder",C8,u("radioActiveBorder","Border color of the active radio option.")),toe=T("radio.inactiveForeground",null,u("radioInactiveForeground","Foreground color of inactive radio option.")),ioe=T("radio.inactiveBackground",null,u("radioInactiveBackground","Background color of inactive radio option.")),noe=T("radio.inactiveBorder",{light:Ne(MC,.2),dark:Ne(MC,.2),hcDark:Ne(MC,.4),hcLight:Ne(MC,.2)},u("radioInactiveBorder","Border color of the inactive radio option.")),ooe=T("radio.inactiveHoverBackground",VIe,u("radioHoverBackground","Background color of inactive active radio option when hovering.")),roe=T("checkbox.background",Ff,u("checkbox.background","Background color of checkbox widget.")),W7e=T("checkbox.selectBackground",xr,u("checkbox.select.background","Background color of checkbox widget when the element it's in is selected.")),soe=T("checkbox.foreground",ok,u("checkbox.foreground","Foreground color of checkbox widget.")),aoe=T("checkbox.border",Bf,u("checkbox.border","Border color of checkbox widget.")),H7e=T("checkbox.selectBorder",ik,u("checkbox.select.border","Border color of checkbox widget when the element it's in is selected.")),loe=T("keybindingLabel.background",{dark:new j(new xt(128,128,128,.17)),light:new j(new xt(221,221,221,.4)),hcDark:j.transparent,hcLight:j.transparent},u("keybindingLabelBackground","Keybinding label background color. The keybinding label is used to represent a keyboard shortcut.")),doe=T("keybindingLabel.foreground",{dark:j.fromHex("#CCCCCC"),light:j.fromHex("#555555"),hcDark:j.white,hcLight:st},u("keybindingLabelForeground","Keybinding label foreground color. The keybinding label is used to represent a keyboard shortcut.")),coe=T("keybindingLabel.border",{dark:new j(new xt(51,51,51,.6)),light:new j(new xt(204,204,204,.4)),hcDark:new j(new xt(111,195,223)),hcLight:Oe},u("keybindingLabelBorder","Keybinding label border color. The keybinding label is used to represent a keyboard shortcut.")),uoe=T("keybindingLabel.bottomBorder",{dark:new j(new xt(68,68,68,.6)),light:new j(new xt(187,187,187,.4)),hcDark:new j(new xt(111,195,223)),hcLight:st},u("keybindingLabelBottomBorder","Keybinding label border bottom color. The keybinding label is used to represent a keyboard shortcut."));var poe=T("list.focusBackground",null,u("listFocusBackground","List/Tree background color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),hoe=T("list.focusForeground",null,u("listFocusForeground","List/Tree foreground color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),moe=T("list.focusOutline",{dark:na,light:na,hcDark:fi,hcLight:fi},u("listFocusOutline","List/Tree outline color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),goe=T("list.focusAndSelectionOutline",null,u("listFocusAndSelectionOutline","List/Tree outline color for the focused item when the list/tree is active and selected. An active list/tree has keyboard focus, an inactive does not.")),Ss=T("list.activeSelectionBackground",{dark:"#04395E",light:"#0060C0",hcDark:null,hcLight:j.fromHex("#0F4A85").transparent(.1)},u("listActiveSelectionBackground","List/Tree background color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),Nl=T("list.activeSelectionForeground",{dark:j.white,light:j.white,hcDark:null,hcLight:null},u("listActiveSelectionForeground","List/Tree foreground color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),x0=T("list.activeSelectionIconForeground",null,u("listActiveSelectionIconForeground","List/Tree icon foreground color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),foe=T("list.inactiveSelectionBackground",{dark:"#37373D",light:"#E4E6F1",hcDark:null,hcLight:j.fromHex("#0F4A85").transparent(.1)},u("listInactiveSelectionBackground","List/Tree background color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),boe=T("list.inactiveSelectionForeground",null,u("listInactiveSelectionForeground","List/Tree foreground color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),voe=T("list.inactiveSelectionIconForeground",null,u("listInactiveSelectionIconForeground","List/Tree icon foreground color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),Ioe=T("list.inactiveFocusBackground",null,u("listInactiveFocusBackground","List/Tree background color for the focused item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),yoe=T("list.inactiveFocusOutline",null,u("listInactiveFocusOutline","List/Tree outline color for the focused item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),x8=T("list.hoverBackground",{dark:"#2A2D2E",light:"#F0F0F0",hcDark:j.white.transparent(.1),hcLight:j.fromHex("#0F4A85").transparent(.1)},u("listHoverBackground","List/Tree background when hovering over items using the mouse.")),T8=T("list.hoverForeground",null,u("listHoverForeground","List/Tree foreground when hovering over items using the mouse.")),Soe=T("list.dropBackground",{dark:"#062F4A",light:"#D6EBFF",hcDark:null,hcLight:null},u("listDropBackground","List/Tree drag and drop background when moving items over other items when using the mouse.")),Coe=T("list.dropBetweenBackground",{dark:ik,light:ik,hcDark:null,hcLight:null},u("listDropBetweenBackground","List/Tree drag and drop border color when moving items between items when using the mouse.")),AC=T("list.highlightForeground",{dark:"#2AAAFF",light:"#0066BF",hcDark:na,hcLight:na},u("highlight","List/Tree foreground color of the match highlights when searching inside the list/tree.")),woe=T("list.focusHighlightForeground",{dark:AC,light:sne(Ss,AC,"#BBE7FF"),hcDark:AC,hcLight:AC},u("listFocusHighlightForeground","List/Tree foreground color of the match highlights on actively focused items when searching inside the list/tree.")),$7e=T("list.invalidItemForeground",{dark:"#B89500",light:"#B89500",hcDark:"#B89500",hcLight:"#B5200D"},u("invalidItemForeground","List/Tree foreground color for invalid items, for example an unresolved root in explorer.")),j7e=T("list.errorForeground",{dark:"#F88070",light:"#B01011",hcDark:null,hcLight:null},u("listErrorForeground","Foreground color of list items containing errors.")),X7e=T("list.warningForeground",{dark:"#CCA700",light:"#855F00",hcDark:null,hcLight:null},u("listWarningForeground","Foreground color of list items containing warnings.")),Eoe=T("listFilterWidget.background",{light:ia(xr,0),dark:wa(xr,0),hcDark:xr,hcLight:xr},u("listFilterWidgetBackground","Background color of the type filter widget in lists and trees.")),xoe=T("listFilterWidget.outline",{dark:j.transparent,light:j.transparent,hcDark:"#f38518",hcLight:"#007ACC"},u("listFilterWidgetOutline","Outline color of the type filter widget in lists and trees.")),Toe=T("listFilterWidget.noMatchesOutline",{dark:"#BE1100",light:"#BE1100",hcDark:Oe,hcLight:Oe},u("listFilterWidgetNoMatchesOutline","Outline color of the type filter widget in lists and trees, when there are no matches.")),_oe=T("listFilterWidget.shadow",Hp,u("listFilterWidgetShadow","Shadow color of the type filter widget in lists and trees.")),Y7e=T("list.filterMatchBackground",{dark:Ol,light:Ol,hcDark:null,hcLight:null},u("listFilterMatchHighlight","Background color of the filtered match.")),Q7e=T("list.filterMatchBorder",{dark:Af,light:Af,hcDark:Oe,hcLight:fi},u("listFilterMatchHighlightBorder","Border color of the filtered match.")),Doe=T("list.deemphasizedForeground",{dark:"#8C8C8C",light:"#8E8E90",hcDark:"#A7A8A9",hcLight:"#666666"},u("listDeemphasizedForeground","List/Tree foreground color for items that are deemphasized.")),OC=T("tree.indentGuidesStroke",{dark:"#585858",light:"#a9a9a9",hcDark:"#a9a9a9",hcLight:"#a5a5a5"},u("treeIndentGuidesStroke","Tree stroke color for the indentation guides.")),koe=T("tree.inactiveIndentGuidesStroke",Ne(OC,.4),u("treeInactiveIndentGuidesStroke","Tree stroke color for the indentation guides that are not active.")),Loe=T("tree.tableColumnsBorder",{dark:"#CCCCCC20",light:"#61616120",hcDark:null,hcLight:null},u("tableColumnsBorder","Table border color between columns.")),Roe=T("tree.tableOddRowsBackground",{dark:Ne(st,.04),light:Ne(st,.04),hcDark:null,hcLight:null},u("tableOddRowsBackgroundColor","Background color for odd table rows.")),Z7e=T("editorActionList.background",xr,u("editorActionListBackground","Action List background color.")),J7e=T("editorActionList.foreground",Wp,u("editorActionListForeground","Action List foreground color.")),e9e=T("editorActionList.focusForeground",Nl,u("editorActionListFocusForeground","Action List foreground color for the focused item.")),t9e=T("editorActionList.focusBackground",Ss,u("editorActionListFocusBackground","Action List background color for the focused item."));var Poe=T("menu.border",{dark:null,light:null,hcDark:Oe,hcLight:Oe},u("menuBorder","Border color of menus.")),Moe=T("menu.foreground",ok,u("menuForeground","Foreground color of menu items.")),Aoe=T("menu.background",Ff,u("menuBackground","Background color of menu items.")),Ooe=T("menu.selectionForeground",Nl,u("menuSelectionForeground","Foreground color of the selected menu item in menus.")),Noe=T("menu.selectionBackground",Ss,u("menuSelectionBackground","Background color of the selected menu item in menus.")),Foe=T("menu.selectionBorder",{dark:null,light:null,hcDark:fi,hcLight:fi},u("menuSelectionBorder","Border color of the selected menu item in menus.")),Boe=T("menu.separatorBackground",{dark:"#606060",light:"#D4D4D4",hcDark:Oe,hcLight:Oe},u("menuSeparatorBackground","Color of a separator menu item in menus."));var p9e=T("quickInput.background",xr,u("pickerBackground","Quick picker background color. The quick picker widget is the container for pickers like the command palette.")),h9e=T("quickInput.foreground",Wp,u("pickerForeground","Quick picker foreground color. The quick picker widget is the container for pickers like the command palette.")),m9e=T("quickInputTitle.background",{dark:new j(new xt(255,255,255,.105)),light:new j(new xt(0,0,0,.06)),hcDark:"#000000",hcLight:j.white},u("pickerTitleBackground","Quick picker title background color. The quick picker widget is the container for pickers like the command palette.")),Woe=T("pickerGroup.foreground",{dark:"#3794FF",light:"#0066BF",hcDark:j.white,hcLight:"#0F4A85"},u("pickerGroupForeground","Quick picker color for grouping labels.")),g9e=T("pickerGroup.border",{dark:"#3F3F46",light:"#CCCEDB",hcDark:j.white,hcLight:"#0F4A85"},u("pickerGroupBorder","Quick picker color for grouping borders.")),Voe=T("quickInput.list.focusBackground",null,"",void 0,u("quickInput.list.focusBackground deprecation","Please use quickInputList.focusBackground instead")),T0=T("quickInputList.focusForeground",Nl,u("quickInput.listFocusForeground","Quick picker foreground color for the focused item.")),_0=T("quickInputList.focusIconForeground",x0,u("quickInput.listFocusIconForeground","Quick picker icon foreground color for the focused item.")),D0=T("quickInputList.focusBackground",{dark:d8(Voe,Ss),light:d8(Voe,Ss),hcDark:null,hcLight:null},u("quickInput.listFocusBackground","Quick picker background color for the focused item."));var y9e=T("search.resultsInfoForeground",{light:st,dark:Ne(st,.65),hcDark:st,hcLight:st},u("search.resultsInfoForeground","Color of the text in the search viewlet's completion message.")),S9e=T("searchEditor.findMatchBackground",{light:Ne(Ol,.66),dark:Ne(Ol,.66),hcDark:Ol,hcLight:Ol},u("searchEditor.queryMatch","Color of the Search Editor query matches.")),C9e=T("searchEditor.findMatchBorder",{light:Ne(Af,.66),dark:Ne(Af,.66),hcDark:Af,hcLight:Af},u("searchEditor.editorFindMatchBorder","Border color of the Search Editor query matches."));var HIe={IconContribution:"base.contributions.icons"},UIe;(t=>{function r(e,i){let n=e.defaults;for(;de.isThemeIcon(n);){let o=TI.getIcon(n.id);if(!o)return;n=o.defaults}return n}t.getDefinition=r})(UIe||={});var zIe;(e=>{function r(i){return{weight:i.weight,style:i.style,src:i.src.map(n=>({format:n.format,location:n.location.toString()}))}}e.toJSONObject=r;function t(i){let n=o=>Bt(o)?o:void 0;if(i&&Array.isArray(i.src)&&i.src.every(o=>Bt(o.format)&&Bt(o.location)))return{weight:n(i.weight),style:n(i.style),src:i.src.map(o=>({format:o.format,location:Z.parse(o.location)}))}}e.fromJSONObject=t})(zIe||={});var _8=class{_onDidChange=new x;onDidChange=this._onDidChange.event;iconsById;iconSchema={definitions:{icons:{type:"object",properties:{fontId:{type:"string",description:u("iconDefinition.fontId","The id of the font to use. If not set, the font that is defined first is used.")},fontCharacter:{type:"string",description:u("iconDefinition.fontCharacter","The font character associated with the icon definition.")}},additionalProperties:!1,defaultSnippets:[{body:{fontCharacter:"\\\\e030"}}]}},type:"object",properties:{}};iconReferenceSchema={type:"string",pattern:`^${de.iconNameExpression}$`,enum:[],enumDescriptions:[]};iconFontsById;constructor(){this.iconsById={},this.iconFontsById={}}registerIcon(t,e,i,n){let o=this.iconsById[t];if(o){if(i&&!o.description){o.description=i,this.iconSchema.properties[t].markdownDescription=`${i} $(${t})`;let l=this.iconReferenceSchema.enum.indexOf(t);l!==-1&&(this.iconReferenceSchema.enumDescriptions[l]=i),this._onDidChange.fire()}return o}let s={id:t,description:i,defaults:e,deprecationMessage:n};this.iconsById[t]=s;let a={$ref:"#/definitions/icons"};return n&&(a.deprecationMessage=n),i&&(a.markdownDescription=`${i}: $(${t})`),this.iconSchema.properties[t]=a,this.iconReferenceSchema.enum.push(t),this.iconReferenceSchema.enumDescriptions.push(i||""),this._onDidChange.fire(),{id:t}}deregisterIcon(t){delete this.iconsById[t],delete this.iconSchema.properties[t];let e=this.iconReferenceSchema.enum.indexOf(t);e!==-1&&(this.iconReferenceSchema.enum.splice(e,1),this.iconReferenceSchema.enumDescriptions.splice(e,1)),this._onDidChange.fire()}getIcons(){return Object.keys(this.iconsById).map(t=>this.iconsById[t])}getIcon(t){return this.iconsById[t]}getIconSchema(){return this.iconSchema}getIconReferenceSchema(){return this.iconReferenceSchema}registerIconFont(t,e){let i=this.iconFontsById[t];return i||(this.iconFontsById[t]=e,this._onDidChange.fire(),e)}deregisterIconFont(t){delete this.iconFontsById[t]}getIconFont(t){return this.iconFontsById[t]}toString(){let t=(o,s)=>o.id.localeCompare(s.id),e=o=>{for(;de.isThemeIcon(o.defaults);)o=this.iconsById[o.defaults.id];return`codicon codicon-${o?o.id:""}`},i=[];i.push("| preview     | identifier                        | default codicon ID                | description"),i.push("| ----------- | --------------------------------- | --------------------------------- | --------------------------------- |");let n=Object.keys(this.iconsById).map(o=>this.iconsById[o]);for(let o of n.filter(s=>!!s.description).sort(t))i.push(`|<i class="${e(o)}"></i>|${o.id}|${de.isThemeIcon(o.defaults)?o.defaults.id:o.id}|${o.description||""}|`);i.push("| preview     | identifier                        "),i.push("| ----------- | --------------------------------- |");for(let o of n.filter(s=>!de.isThemeIcon(s.defaults)).sort(t))i.push(`|<i class="${e(o)}"></i>|${o.id}|`);return i.join(`
`)}},TI=new _8;Pe.add(HIe.IconContribution,TI);function ke(r,t,e,i){return TI.registerIcon(r,t,e,i)}function Uoe(){return TI}function KIe(){let r=XA();for(let t in r){let e="\\"+r[t].toString(16);TI.registerIcon(t,{fontCharacter:e})}}KIe();var zoe="vscode://schemas/icons",Koe=Pe.as(wd.JSONContribution);Koe.registerSchema(zoe,TI.getIconSchema());var Hoe=new Ye(()=>Koe.notifySchemaChanged(zoe),200);TI.onDidChange(()=>{Hoe.isScheduled()||Hoe.schedule()});var Goe=ke("widget-close",N.close,u("widgetClose","Icon for the close action in widgets.")),Y9e=ke("goto-previous-location",N.arrowUp,u("previousChangeIcon","Icon for goto previous editor location.")),Q9e=ke("goto-next-location",N.arrowDown,u("nextChangeIcon","Icon for goto next editor location.")),D8=de.modify(N.sync,"spin"),qoe=de.modify(N.loading,"spin");function oa(r){return r==="hcDark"||r==="hcLight"}function k8(r){return r==="dark"||r==="hcDark"}var Fe=q("themeService");function _d(r){return{id:r}}var f6e=N.file,b6e=N.folder;function sk(r){switch(r){case"dark":return"vs-dark";case"hcDark":return"hc-black";case"hcLight":return"hc-light";default:return"vs"}}var qIe={ThemingContribution:"base.contributions.theming"},L8=class{themingParticipants=[];onThemingParticipantAddedEmitter;constructor(){this.themingParticipants=[],this.onThemingParticipantAddedEmitter=new x}onColorThemeChange(t){return this.themingParticipants.push(t),this.onThemingParticipantAddedEmitter.fire(t),le(()=>{let e=this.themingParticipants.indexOf(t);this.themingParticipants.splice(e,1)})}get onThemingParticipantAdded(){return this.onThemingParticipantAddedEmitter.event}getThemingParticipants(){return this.themingParticipants}},$oe=new L8;Pe.add(qIe.ThemingContribution,$oe);function Zo(r){return $oe.onColorThemeChange(r)}var fc=class extends R{constructor(e){super();this.themeService=e;this.theme=e.getColorTheme(),this._register(this.themeService.onDidColorThemeChange(i=>this.onThemeChange(i)))}theme;onThemeChange(e){this.theme=e,this.updateStyles()}updateStyles(){}getColor(e,i){let n=this.theme.getColor(e);return n&&i&&(n=i(n,this.theme)),n?n.toString():null}};var k0=class{_theme;get type(){return this._theme.type}get value(){return this._theme}constructor(t){this._theme=t}update(t){this._theme=t}getColor(t){return this._theme.getColor(t)}};var L0=class{type=0;constructor(){}},R0=class{type=1;constructor(){}},P0=class{type=2;_source;constructor(t){this._source=t}hasChanged(t){return this._source.hasChanged(t)}},M0=class{constructor(t,e,i){this.selections=t;this.modelSelections=e;this.reason=i}type=3},Up=class{type=4;affectsMinimap;affectsOverviewRuler;affectsGlyphMargin;affectsLineNumber;constructor(t){t?(this.affectsMinimap=t.affectsMinimap,this.affectsOverviewRuler=t.affectsOverviewRuler,this.affectsGlyphMargin=t.affectsGlyphMargin,this.affectsLineNumber=t.affectsLineNumber):(this.affectsMinimap=!0,this.affectsOverviewRuler=!0,this.affectsGlyphMargin=!0,this.affectsLineNumber=!0)}},_I=class{type=5;constructor(){}},A0=class{type=6;isFocused;constructor(t){this.isFocused=t}},O0=class{type=7},DI=class{type=8;constructor(){}},ak=class{constructor(t,e){this.fromLineNumber=t;this.count=e}type=9},NC=class{type=10;fromLineNumber;toLineNumber;constructor(t,e){this.fromLineNumber=t,this.toLineNumber=e}},FC=class{type=11;fromLineNumber;toLineNumber;constructor(t,e){this.fromLineNumber=t,this.toLineNumber=e}};var Om=class{constructor(t,e,i,n,o,s,a){this.source=t;this.minimalReveal=e;this.range=i;this.selections=n;this.verticalType=o;this.revealHorizontal=s;this.scrollType=a}type=12},N0=class{type=13;scrollWidth;scrollLeft;scrollHeight;scrollTop;scrollWidthChanged;scrollLeftChanged;scrollHeightChanged;scrollTopChanged;constructor(t){this.scrollWidth=t.scrollWidth,this.scrollLeft=t.scrollLeft,this.scrollHeight=t.scrollHeight,this.scrollTop=t.scrollTop,this.scrollWidthChanged=t.scrollWidthChanged,this.scrollLeftChanged=t.scrollLeftChanged,this.scrollHeightChanged=t.scrollHeightChanged,this.scrollTopChanged=t.scrollTopChanged}},F0=class{constructor(t){this.theme=t}type=14},B0=class{type=15;ranges;constructor(t){this.ranges=t}},V0=class{type=16;constructor(){}},W0=class{type=17;constructor(){}};var bc=class extends R{_shouldRender;constructor(){super(),this._shouldRender=!0}shouldRender(){return this._shouldRender}forceShouldRender(){this._shouldRender=!0}setShouldRender(){this._shouldRender=!0}onDidRender(){this._shouldRender=!1}onCompositionStart(t){return!1}onCompositionEnd(t){return!1}onConfigurationChanged(t){return!1}onCursorStateChanged(t){return!1}onDecorationsChanged(t){return!1}onFlushed(t){return!1}onFocusChanged(t){return!1}onLanguageConfigurationChanged(t){return!1}onLineMappingChanged(t){return!1}onLinesChanged(t){return!1}onLinesDeleted(t){return!1}onLinesInserted(t){return!1}onRevealRangeRequest(t){return!1}onScrollChanged(t){return!1}onThemeChanged(t){return!1}onTokensChanged(t){return!1}onTokensColorsChanged(t){return!1}onZonesChanged(t){return!1}handleEvents(t){let e=!1;for(let i=0,n=t.length;i<n;i++){let o=t[i];switch(o.type){case 0:this.onCompositionStart(o)&&(e=!0);break;case 1:this.onCompositionEnd(o)&&(e=!0);break;case 2:this.onConfigurationChanged(o)&&(e=!0);break;case 3:this.onCursorStateChanged(o)&&(e=!0);break;case 4:this.onDecorationsChanged(o)&&(e=!0);break;case 5:this.onFlushed(o)&&(e=!0);break;case 6:this.onFocusChanged(o)&&(e=!0);break;case 7:this.onLanguageConfigurationChanged(o)&&(e=!0);break;case 8:this.onLineMappingChanged(o)&&(e=!0);break;case 9:this.onLinesChanged(o)&&(e=!0);break;case 10:this.onLinesDeleted(o)&&(e=!0);break;case 11:this.onLinesInserted(o)&&(e=!0);break;case 12:this.onRevealRangeRequest(o)&&(e=!0);break;case 13:this.onScrollChanged(o)&&(e=!0);break;case 15:this.onTokensChanged(o)&&(e=!0);break;case 14:this.onThemeChanged(o)&&(e=!0);break;case 16:this.onTokensColorsChanged(o)&&(e=!0);break;case 17:this.onZonesChanged(o)&&(e=!0);break;default:console.info("View received unknown event: "),console.info(o)}}e&&(this._shouldRender=!0)}};var lk=class{_viewportBrand=void 0;top;left;width;height;constructor(t,e,i,n){this.top=t|0,this.left=e|0,this.width=i|0,this.height=n|0}},H0=class{tabSize;data;constructor(t,e){this.tabSize=t,this.data=e}},kI=class{_viewLineDataBrand=void 0;content;continuesWithWrappedLine;minColumn;maxColumn;startVisibleColumn;tokens;inlineDecorations;constructor(t,e,i,n,o,s,a){this.content=t,this.continuesWithWrappedLine=e,this.minColumn=i,this.maxColumn=n,this.startVisibleColumn=o,this.tokens=s,this.inlineDecorations=a}},zp=class r{minColumn;maxColumn;content;continuesWithWrappedLine;containsRTL;isBasicASCII;tokens;inlineDecorations;tabSize;startVisibleColumn;constructor(t,e,i,n,o,s,a,l,d,c){this.minColumn=t,this.maxColumn=e,this.content=i,this.continuesWithWrappedLine=n,this.isBasicASCII=r.isBasicASCII(i,s),this.containsRTL=r.containsRTL(i,this.isBasicASCII,o),this.tokens=a,this.inlineDecorations=l,this.tabSize=d,this.startVisibleColumn=c}static isBasicASCII(t,e){return e?H_(t):!0}static containsRTL(t,e,i){return!e&&i?vm(t):!1}};var Nm=class{constructor(t,e,i){this.range=t;this.inlineClassName=e;this.type=i}},U0=class{constructor(t,e,i,n){this.startOffset=t;this.endOffset=e;this.inlineClassName=i;this.inlineClassNameAffectsLetterSpacing=n}toInlineDecoration(t){return new Nm(new L(t,this.startOffset+1,t,this.endOffset+1),this.inlineClassName,this.inlineClassNameAffectsLetterSpacing?3:0)}},VC=class{_viewModelDecorationBrand=void 0;range;options;constructor(t,e){this.range=t,this.options=e}},LI=class r{constructor(t,e,i){this.color=t;this.zIndex=e;this.data=i}static compareByRenderingProps(t,e){return t.zIndex===e.zIndex?t.color<e.color?-1:t.color>e.color?1:0:t.zIndex-e.zIndex}static equals(t,e){return t.color===e.color&&t.zIndex===e.zIndex&&xi(t.data,e.data)}static equalsArr(t,e){return xi(t,e,r.equals)}};var z0=class{_colorZoneBrand=void 0;from;to;colorId;constructor(t,e,i){this.from=t|0,this.to=e|0,this.colorId=i|0}static compare(t,e){return t.colorId===e.colorId?t.from===e.from?t.to-e.to:t.from-e.from:t.colorId-e.colorId}},dk=class{_overviewRulerZoneBrand=void 0;startLineNumber;endLineNumber;heightInLines;color;_colorZone;constructor(t,e,i,n){this.startLineNumber=t,this.endLineNumber=e,this.heightInLines=i,this.color=n,this._colorZone=null}static compare(t,e){return t.color===e.color?t.startLineNumber===e.startLineNumber?t.heightInLines===e.heightInLines?t.endLineNumber-e.endLineNumber:t.heightInLines-e.heightInLines:t.startLineNumber-e.startLineNumber:t.color<e.color?-1:1}setColorZone(t){this._colorZone=t}getColorZones(){return this._colorZone}},K0=class{_getVerticalOffsetForLine;_zones;_colorZonesInvalid;_lineHeight;_domWidth;_domHeight;_outerHeight;_pixelRatio;_lastAssignedId;_color2Id;_id2Color;constructor(t){this._getVerticalOffsetForLine=t,this._zones=[],this._colorZonesInvalid=!1,this._lineHeight=0,this._domWidth=0,this._domHeight=0,this._outerHeight=0,this._pixelRatio=1,this._lastAssignedId=0,this._color2Id=Object.create(null),this._id2Color=[]}getId2Color(){return this._id2Color}setZones(t){this._zones=t,this._zones.sort(dk.compare)}setLineHeight(t){return this._lineHeight===t?!1:(this._lineHeight=t,this._colorZonesInvalid=!0,!0)}setPixelRatio(t){this._pixelRatio=t,this._colorZonesInvalid=!0}getDOMWidth(){return this._domWidth}getCanvasWidth(){return this._domWidth*this._pixelRatio}setDOMWidth(t){return this._domWidth===t?!1:(this._domWidth=t,this._colorZonesInvalid=!0,!0)}getDOMHeight(){return this._domHeight}getCanvasHeight(){return this._domHeight*this._pixelRatio}setDOMHeight(t){return this._domHeight===t?!1:(this._domHeight=t,this._colorZonesInvalid=!0,!0)}getOuterHeight(){return this._outerHeight}setOuterHeight(t){return this._outerHeight===t?!1:(this._outerHeight=t,this._colorZonesInvalid=!0,!0)}resolveColorZones(){let t=this._colorZonesInvalid,e=Math.floor(this._lineHeight),i=Math.floor(this.getCanvasHeight()),n=Math.floor(this._outerHeight),o=i/n,s=Math.floor(4*this._pixelRatio/2),a=[];for(let l=0,d=this._zones.length;l<d;l++){let c=this._zones[l];if(!t){let C=c.getColorZones();if(C){a.push(C);continue}}let p=this._getVerticalOffsetForLine(c.startLineNumber),h=c.heightInLines===0?this._getVerticalOffsetForLine(c.endLineNumber)+e:p+c.heightInLines*e,m=Math.floor(o*p),f=Math.floor(o*h),g=Math.floor((m+f)/2),v=f-g;v<s&&(v=s),g-v<0&&(g=v),g+v>i&&(g=i-v);let I=c.color,y=this._color2Id[I];y||(y=++this._lastAssignedId,this._color2Id[I]=y,this._id2Color[y]=I);let w=new z0(g-v,g+v,y);c.setColorZone(w),a.push(w)}return this._colorZonesInvalid=!1,a.sort(z0.compare),a}};function no(r){return r&&typeof r.getEditorType=="function"?r.getEditorType()===CI.ICodeEditor:!1}function RI(r){return r&&typeof r.getEditorType=="function"?r.getEditorType()===CI.IDiffEditor:!1}function joe(r){return!!r&&typeof r=="object"&&typeof r.onDidChangeActiveEditor=="function"}function Xoe(r){return no(r)||RI(r)?r:null}function R8(r){let t=r;return typeof t?.resolve=="function"&&typeof t?.isResolved=="function"}var En=q("codeEditorService");var qi=q("modelService");var Tr=q("textModelService");var Tt=q("telemetryService"),Yoe=q("customEndpointTelemetryService");function P8(r,t){return t&&(r.stack||r.stacktrace)?u("stackTrace.format","{0}: {1}",Zoe(r),Qoe(r.stack)||Qoe(r.stacktrace)):Zoe(r)}function Qoe(r){return Array.isArray(r)?r.join(`
`):r}function Zoe(r){return r.code==="ERR_UNC_HOST_NOT_ALLOWED"?`${r.message}. Please update the 'security.allowedUNCHosts' setting if you want to allow this host.`:typeof r.code=="string"&&typeof r.errno=="number"&&typeof r.syscall=="string"?u("nodeExceptionMessage","A system error occurred ({0})",r.message):r.message||u("error.defaultMessage","An unknown error occurred. Please consult the log for more details.")}function PI(r=null,t=!1){if(!r)return u("error.defaultMessage","An unknown error occurred. Please consult the log for more details.");if(Array.isArray(r)){let e=cn(r),i=PI(e[0],t);return e.length>1?u("error.moreErrors","{0} ({1} errors in total)",i,e.length):i}if(Bt(r))return r;if(r.detail){let e=r.detail;if(e.error)return P8(e.error,t);if(e.exception)return P8(e.exception,t)}return r.stack?P8(r,t):r.message?r.message:u("error.defaultMessage","An unknown error occurred. Please consult the log for more details.")}function ck(r){let t=r;return t instanceof Error&&Array.isArray(t.actions)}function WC(r,t){let e;return typeof r=="string"?e=new Error(r):e=r,e.actions=t,e}var bt=q("logService"),fXe=q("loggerService");function G0(r){switch(r){case 1:return"trace";case 2:return"debug";case 3:return"info";case 4:return"warn";case 5:return"error";case 0:return"off"}}var bXe=new A("logLevel",G0(3));var MI=class{id;precondition;_kbOpts;_menuOpts;metadata;constructor(t){this.id=t.id,this.precondition=t.precondition,this._kbOpts=t.kbOpts,this._menuOpts=t.menuOpts,this.metadata=t.metadata}register(){if(Array.isArray(this._menuOpts)?this._menuOpts.forEach(this._registerMenuItem,this):this._menuOpts&&this._registerMenuItem(this._menuOpts),this._kbOpts){let t=Array.isArray(this._kbOpts)?this._kbOpts:[this._kbOpts];for(let e of t){let i=e.kbExpr;this.precondition&&(i?i=P.and(i,this.precondition):i=this.precondition);let n={id:this.id,weight:e.weight,args:e.args,when:i,primary:e.primary,secondary:e.secondary,win:e.win,linux:e.linux,mac:e.mac};wt.registerKeybindingRule(n)}}tt.registerCommand({id:this.id,handler:(t,e)=>this.runCommand(t,e),metadata:this.metadata})}_registerMenuItem(t){Ue.appendMenuItem(t.menuId,{group:t.group,command:{id:this.id,title:t.title,icon:t.icon,precondition:this.precondition},when:t.when,order:t.order})}},uk=class extends MI{_implementations=[];addImplementation(t,e,i,n){return this._implementations.push({priority:t,name:e,implementation:i,when:n}),this._implementations.sort((o,s)=>s.priority-o.priority),{dispose:()=>{for(let o=0;o<this._implementations.length;o++)if(this._implementations[o].implementation===i){this._implementations.splice(o,1);return}}}}runCommand(t,e){let i=t.get(bt),n=t.get(re);i.trace(`Executing Command '${this.id}' which has ${this._implementations.length} bound.`);for(let o of this._implementations){if(o.when){let a=n.getContext(fo());if(!o.when.evaluate(a))continue}let s=o.implementation(t,e);if(s)return i.trace(`Command '${this.id}' was handled by '${o.name}'.`),typeof s=="boolean"?void 0:s}i.trace(`The Command '${this.id}' was not handled by any implementation.`)}},q0=class extends MI{constructor(e,i){super(i);this.command=e}runCommand(e,i){return this.command.runCommand(e,i)}},_r=class r extends MI{static bindToContribution(t){return class extends r{_callback;constructor(i){super(i),this._callback=i.handler}runEditorCommand(i,n,o){let s=t(n);s&&this._callback(s,o)}}}static runEditorCommand(t,e,i,n){let o=t.get(En),s=o.getFocusedCodeEditor()||o.getActiveCodeEditor();if(s)return s.invokeWithinContext(a=>{if(a.get(re).contextMatchesRules(i??void 0))return n(a,s,e)})}runCommand(t,e){return r.runEditorCommand(t,e,this.precondition,(i,n,o)=>this.runEditorCommand(i,n,o))}},mr=class r extends _r{static convertOptions(t){let e;Array.isArray(t.menuOpts)?e=t.menuOpts:t.menuOpts?e=[t.menuOpts]:e=[];function i(n){return n.menuId||(n.menuId=V.EditorContext),n.title||(n.title=t.label),n.when=P.and(t.precondition,n.when),n}return Array.isArray(t.contextMenuOpts)?e.push(...t.contextMenuOpts.map(i)):t.contextMenuOpts&&e.push(i(t.contextMenuOpts)),t.menuOpts=e,t}label;alias;constructor(t){super(r.convertOptions(t)),this.label=t.label,this.alias=t.alias}runEditorCommand(t,e,i){return this.reportTelemetry(t,e),this.run(t,e,i||{})}reportTelemetry(t,e){t.get(Tt).publicLog2("editorActionInvoked",{name:this.label,id:this.id})}};var $0=class extends Me{run(t,...e){let i=t.get(En),n=i.getFocusedCodeEditor()||i.getActiveCodeEditor();if(n)return n.invokeWithinContext(o=>{let s=o.get(re),a=o.get(bt);if(!s.contextMatchesRules(this.desc.precondition??void 0)){a.debug("[EditorAction2] NOT running command because its precondition is FALSE",this.desc.id,this.desc.precondition?.serialize());return}return this.runEditorCommand(o,n,...e)})}};function Fl(r,t){tt.registerCommand(r,function(e,...i){let n=e.get(ne),[o,s]=i;un(Z.isUri(o)),un(H.isIPosition(s));let a=e.get(qi).getModel(o);if(a){let l=H.lift(s);return n.invokeFunction(t,a,l,...i.slice(2))}return e.get(Tr).createModelReference(o).then(l=>new Promise((d,c)=>{try{let p=n.invokeFunction(t,l.object.textEditorModel,H.lift(s),i.slice(2));d(p)}catch(p){c(p)}}).finally(()=>{l.dispose()}))})}function qe(r){return gu.INSTANCE.registerEditorCommand(r),r}function Dr(r){let t=new r;return gu.INSTANCE.registerEditorAction(t),t}function gr(r,t,e){gu.INSTANCE.registerEditorContribution(r,t,e)}var Fm;(o=>{function r(s){return gu.INSTANCE.getEditorCommand(s)}o.getEditorCommand=r;function t(){return gu.INSTANCE.getEditorActions()}o.getEditorActions=t;function e(){return gu.INSTANCE.getEditorContributions()}o.getEditorContributions=e;function i(s){return gu.INSTANCE.getEditorContributions().filter(a=>s.indexOf(a.id)>=0)}o.getSomeEditorContributions=i;function n(){return gu.INSTANCE.getDiffEditorContributions()}o.getDiffEditorContributions=n})(Fm||={});var $Ie={EditorCommonContributions:"editor.contributions"},gu=class r{static INSTANCE=new r;editorContributions=[];diffEditorContributions=[];editorActions=[];editorCommands=Object.create(null);constructor(){}registerEditorContribution(t,e,i){this.editorContributions.push({id:t,ctor:e,instantiation:i})}getEditorContributions(){return this.editorContributions.slice(0)}registerDiffEditorContribution(t,e){this.diffEditorContributions.push({id:t,ctor:e})}getDiffEditorContributions(){return this.diffEditorContributions.slice(0)}registerEditorAction(t){t.register(),this.editorActions.push(t)}getEditorActions(){return this.editorActions}registerEditorCommand(t){t.register(),this.editorCommands[t.id]=t}getEditorCommand(t){return this.editorCommands[t]||null}};Pe.add($Ie.EditorCommonContributions,gu.INSTANCE);function pk(r){return r.register(),r}var M8=pk(new uk({id:"undo",precondition:void 0,kbOpts:{weight:0,primary:2104},menuOpts:[{menuId:V.MenubarEditMenu,group:"1_do",title:u({key:"miUndo",comment:["&& denotes a mnemonic"]},"&&Undo"),order:1},{menuId:V.CommandPalette,group:"",title:u("undo","Undo"),order:1}]}));pk(new q0(M8,{id:"default:undo",precondition:void 0}));var A8=pk(new uk({id:"redo",precondition:void 0,kbOpts:{weight:0,primary:2103,secondary:[3128],mac:{primary:3128}},menuOpts:[{menuId:V.MenubarEditMenu,group:"1_do",title:u({key:"miRedo",comment:["&& denotes a mnemonic"]},"&&Redo"),order:2},{menuId:V.CommandPalette,group:"",title:u("redo","Redo"),order:1}]}));pk(new q0(A8,{id:"default:redo",precondition:void 0}));var Joe=pk(new uk({id:"editor.action.selectAll",precondition:void 0,kbOpts:{weight:0,kbExpr:null,primary:2079},menuOpts:[{menuId:V.MenubarSelectionMenu,group:"1_basic",title:u({key:"miSelectAll",comment:["&& denotes a mnemonic"]},"&&Select All"),order:1},{menuId:V.CommandPalette,group:"",title:u("selectAll","Select All"),order:1}]}));var Be=q("keybindingService");var j0={Quickaccess:"workbench.contributions.quickaccess"},O8=class{providers=[];defaultProvider=void 0;registerQuickAccessProvider(t){return t.prefix.length===0?this.defaultProvider=t:this.providers.push(t),this.providers.sort((e,i)=>i.prefix.length-e.prefix.length),le(()=>{this.providers.splice(this.providers.indexOf(t),1),this.defaultProvider===t&&(this.defaultProvider=void 0)})}getQuickAccessProviders(){return cn([this.defaultProvider,...this.providers])}getQuickAccessProvider(t){return t&&this.providers.find(i=>t.startsWith(i.prefix))||void 0||this.defaultProvider}clear(){let t=[...this.providers],e=this.defaultProvider;return this.providers=[],this.defaultProvider=void 0,()=>{this.providers=t,this.defaultProvider=e}}};Pe.add(j0.Quickaccess,new O8);var ere=new qn(()=>{let r=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"});return{collator:r,collatorIsNumeric:r.resolvedOptions().numeric}}),YYe=new qn(()=>({collator:new Intl.Collator(void 0,{numeric:!0})})),QYe=new qn(()=>({collator:new Intl.Collator(void 0,{numeric:!0,sensitivity:"accent"})}));function N8(r,t,e=!1){let i=r||"",n=t||"",o=ere.value.collator.compare(i,n);return ere.value.collatorIsNumeric&&o===0&&i!==n?i<n?-1:1:o}function X0(r,t,e){let i=r.toLowerCase(),n=t.toLowerCase(),o=jIe(r,t,e);if(o)return o;let s=i.endsWith(e),a=n.endsWith(e);if(s!==a)return s?-1:1;let l=N8(i,n);return l!==0?l:i.localeCompare(n)}function jIe(r,t,e){let i=r.toLowerCase(),n=t.toLowerCase(),o=i.startsWith(e),s=n.startsWith(e);if(o!==s)return o?-1:1;if(o&&s){if(i.length<n.length)return-1;if(i.length>n.length)return 1}return 0}var Q0=0,tre=[Q0,[]];function ire(r,t,e,i){if(!r||!t)return tre;let n=r.length,o=t.length;if(n<o)return tre;let s=r.toLowerCase();return XIe(t,e,o,r,s,n,i)}function XIe(r,t,e,i,n,o,s){let a=[],l=[];for(let h=0;h<e;h++){let m=h*o,f=m-o,g=h>0,v=r[h],I=t[h];for(let y=0;y<o;y++){let w=y>0,C=m+y,S=C-1,D=f+y-1,k=w?a[S]:0,M=g&&w?a[D]:0,O=g&&w?l[D]:0,K;!M&&g?K=0:K=YIe(v,I,i,n,y,O),K&&M+K>=k&&(s||g||n.startsWith(t,y))?(l[C]=O+1,a[C]=M+K):(l[C]=Q0,a[C]=k)}}let d=[],c=e-1,p=o-1;for(;c>=0&&p>=0;){let h=c*o+p;l[h]===Q0||(d.push(p),c--),p--}return[a[e*o-1],d.reverse()]}function YIe(r,t,e,i,n,o){let s=0;if(!QIe(t,i[n]))return s;if(s+=1,o>0&&(s+=o*5),r===e[n]&&(s+=1),n===0)s+=8;else{let a=ZIe(e.charCodeAt(n-1));a?s+=a:JS(e.charCodeAt(n))&&o===0&&(s+=2)}return s}function QIe(r,t){return r===t?!0:r==="/"||r==="\\"?t==="/"||t==="\\":!1}function ZIe(r){switch(r){case 47:case 92:return 5;case 95:case 45:case 46:case 32:case 39:case 34:case 58:return 4;default:return 0}}var Z0=Object.freeze({score:0}),Y0=1<<18,F8=1<<17,B8=65536;function JIe(r,t,e,i){let n=i.values?i.values:[i];return wr({[i.normalized]:{values:n.map(s=>({value:s.normalized,expectContiguousMatch:s.expectContiguousMatch})),label:r,description:t,allowNonContiguousMatches:e}})}function J0(r,t,e,i,n){if(!r||!t.normalized)return Z0;let o=i.getItemLabel(r);if(!o)return Z0;let s=i.getItemDescription(r),a=JIe(o,s,e,t),l=n[a];if(l)return l;let d=eye(o,s,i.getItemPath(r),t,e);return n[a]=d,d}function eye(r,t,e,i,n){let o=!e||!i.containsPathSeparator;return e&&(ci?i.pathNormalized===e:dr(i.pathNormalized,e))?{score:Y0,labelMatch:[{start:0,end:r.length}],descriptionMatch:t?[{start:0,end:t.length}]:void 0}:i.values&&i.values.length>1?tye(r,t,e,i.values,o,n):lre(r,t,e,i,o,n)}function tye(r,t,e,i,n,o){let s=0,a=[],l=[];for(let d of i){let{score:c,labelMatch:p,descriptionMatch:h}=lre(r,t,e,d,n,o);if(c===Q0)return Z0;s+=c,p&&a.push(...p),h&&l.push(...h)}return{score:s,labelMatch:ore(a),descriptionMatch:ore(l)}}function lre(r,t,e,i,n,o){if(n||!t){let[s,a]=ire(r,i.normalized,i.normalizedLowercase,o&&!i.expectContiguousMatch);if(s){let l=nI(i.normalized,r),d;if(l){d=F8;let c=Math.round(i.normalized.length/r.length*100);d+=c}else d=B8;return{score:d+s,labelMatch:l||nre(a)}}}if(t){let s=t;e&&(s=`${t}${Ur}`);let a=s.length,l=`${s}${r}`,[d,c]=ire(l,i.normalized,i.normalizedLowercase,o&&!i.expectContiguousMatch);if(d){let p=nre(c),h=[],m=[];return p.forEach(f=>{f.start<a&&f.end>a?(h.push({start:0,end:f.end-a}),m.push({start:f.start,end:a})):f.start>=a?h.push({start:f.start-a,end:f.end-a}):m.push(f)}),{score:d,labelMatch:h,descriptionMatch:m}}}return Z0}function nre(r){let t=[];if(!r)return t;let e;for(let i of r)e&&e.end===i?e.end+=1:(e={start:i,end:i+1},t.push(e));return t}function ore(r){let t=r.sort((n,o)=>n.start-o.start),e=[],i;for(let n of t)!i||!iye(i,n)?(i=n,e.push(n)):(i.start=Math.min(i.start,n.start),i.end=Math.max(i.end,n.end));return e}function iye(r,t){return!(r.end<t.start||t.end<r.start)}function dre(r,t,e,i,n,o){let s=J0(r,e,i,n,o),a=J0(t,e,i,n,o),l=s.score,d=a.score;if((l===Y0||d===Y0)&&l!==d)return l===Y0?-1:1;if(l>B8||d>B8){if(l!==d)return l>d?-1:1;if(l<F8&&d<F8){let v=nye(s.labelMatch,a.labelMatch);if(v!==0)return v}let f=n.getItemLabel(r)||"",g=n.getItemLabel(t)||"";if(f.length!==g.length)return f.length-g.length}if(l!==d)return l>d?-1:1;let c=Array.isArray(s.labelMatch)&&s.labelMatch.length>0,p=Array.isArray(a.labelMatch)&&a.labelMatch.length>0;if(c&&!p)return-1;if(p&&!c)return 1;let h=rre(r,s,n),m=rre(t,a,n);return h&&m&&h!==m?m>h?-1:1:oye(r,t,e,n)}function rre(r,t,e){let i=-1,n=-1;if(t.descriptionMatch&&t.descriptionMatch.length?i=t.descriptionMatch[0].start:t.labelMatch&&t.labelMatch.length&&(i=t.labelMatch[0].start),t.labelMatch&&t.labelMatch.length){if(n=t.labelMatch[t.labelMatch.length-1].end,t.descriptionMatch&&t.descriptionMatch.length){let o=e.getItemDescription(r);o&&(n+=o.length)}}else t.descriptionMatch&&t.descriptionMatch.length&&(n=t.descriptionMatch[t.descriptionMatch.length-1].end);return n-i}function nye(r,t){if(!r&&!t||(!r||!r.length)&&(!t||!t.length))return 0;if(!t||!t.length)return-1;if(!r||!r.length)return 1;let e=r[0].start,n=r[r.length-1].end-e,o=t[0].start,a=t[t.length-1].end-o;return n===a?0:a<n?1:-1}function oye(r,t,e,i){let n=i.getItemLabel(r)||"",o=i.getItemLabel(t)||"",s=i.getItemDescription(r),a=i.getItemDescription(t),l=n.length+(s?s.length:0),d=o.length+(a?a.length:0);if(l!==d)return l-d;let c=i.getItemPath(r),p=i.getItemPath(t);return c&&p&&c.length!==p.length?c.length-p.length:n!==o?X0(n,o,e.normalized):s&&a&&s!==a?X0(s,a,e.normalized):c&&p&&c!==p?X0(c,p,e.normalized):0}function sre(r){return r.startsWith('"')&&r.endsWith('"')}var rye=" ";function cre(r){typeof r!="string"&&(r="");let t=r.toLowerCase(),{pathNormalized:e,normalized:i,normalizedLowercase:n}=are(r),o=e.indexOf(Ur)>=0,s=sre(r),a,l=r.split(rye);if(l.length>1)for(let d of l){let c=sre(d),{pathNormalized:p,normalized:h,normalizedLowercase:m}=are(d);h&&(a||(a=[]),a.push({original:d,originalLowercase:d.toLowerCase(),pathNormalized:p,normalized:h,normalizedLowercase:m,expectContiguousMatch:c}))}return{original:r,originalLowercase:t,pathNormalized:e,normalized:i,normalizedLowercase:n,values:a,containsPathSeparator:o,expectContiguousMatch:s}}function are(r){let t;St?t=r.replace(/\//g,Ur):t=r.replace(/\\/g,Ur);let e=pee(t).replace(/\s|"/g,"");return{pathNormalized:t,normalized:e,normalizedLowercase:e.toLowerCase()}}var V8=class{constructor(t){this.options=t}getItemLabel(t){return t.label}getItemDescription(t){if(!this.options?.skipDescription)return t.description}getItemPath(t){if(!this.options?.skipPath)return t.resource?.scheme===Ie.file?t.resource.fsPath:t.resource?.path}},W8=new V8,ki=q("quickInputService");function H8(r){let t=r;return Array.isArray(t.items)}function ure(r){let t=r;return!!t.picks&&t.additionalPicks instanceof Promise}var Vf=class extends R{constructor(e,i){super();this.prefix=e;this.options=i}provide(e,i,n){let o=new B;e.canAcceptInBackground=!!this.options?.canAcceptInBackground,e.matchOnLabel=e.matchOnDescription=e.matchOnDetail=e.sortByLabel=!1;let s,a=o.add(new yt),l=async()=>{let c=a.value=new B;s?.dispose(!0),e.busy=!1,s=new Kt(i);let p=s.token,h=e.value.substring(this.prefix.length);this.options?.shouldSkipTrimPickFilter||(h=h.trim());let m=this._getPicks(h,c,p,n),f=(v,I)=>{let y,w;if(H8(v)?(y=v.items,w=v.active):y=v,y.length===0){if(I)return!1;(h.length>0||e.hideInput)&&this.options?.noResultsPick&&(Xv(this.options.noResultsPick)?y=[this.options.noResultsPick(h)]:y=[this.options.noResultsPick])}return e.items=y,w&&(e.activeItems=[w]),!0},g=async v=>{let I=!1,y=!1;await Promise.all([(async()=>{typeof v.mergeDelay=="number"&&(await To(v.mergeDelay),p.isCancellationRequested)||y||(I=f(v.picks,!0))})(),(async()=>{e.busy=!0;try{let w=await v.additionalPicks;if(p.isCancellationRequested)return;let C,S;H8(v.picks)?(C=v.picks.items,S=v.picks.active):C=v.picks;let D,k;if(H8(w)?(D=w.items,k=w.active):D=w,D.length>0||!I){let M;if(!S&&!k){let O=e.activeItems[0];O&&C.indexOf(O)!==-1&&(M=O)}f({items:[...C,...D],active:S||k||M})}}finally{p.isCancellationRequested||(e.busy=!1),y=!0}})()])};if(m!==null)if(ure(m))await g(m);else if(!(m instanceof Promise))f(m);else{e.busy=!0;try{let v=await m;if(p.isCancellationRequested)return;ure(v)?await g(v):f(v)}finally{p.isCancellationRequested||(e.busy=!1)}}};o.add(e.onDidChangeValue(()=>l())),l(),o.add(e.onDidAccept(c=>{if(n?.handleAccept){c.inBackground||e.hide(),n.handleAccept?.(e.activeItems[0]);return}let[p]=e.selectedItems;typeof p?.accept=="function"&&(c.inBackground||e.hide(),p.accept(e.keyMods,c))}));let d=async(c,p)=>{if(typeof p.trigger!="function")return;let h=p.buttons?.indexOf(c)??-1;if(h>=0){let m=p.trigger(h,e.keyMods),f=typeof m=="number"?m:await m;if(i.isCancellationRequested)return;switch(f){case 0:break;case 1:e.hide();break;case 2:l();break;case 3:{let g=e.items.indexOf(p);if(g!==-1){let v=e.items.slice(),I=v.splice(g,1),y=e.activeItems.filter(C=>C!==I[0]),w=e.keepScrollPosition;e.keepScrollPosition=!0,e.items=v,y&&(e.activeItems=y),e.keepScrollPosition=w}break}}}};return o.add(e.onDidTriggerItemButton(({button:c,item:p})=>d(c,p))),o.add(e.onDidTriggerSeparatorButton(({button:c,separator:p})=>d(c,p))),o}};var U8=q("accessibleViewService");var eN=new class{_implementations=[];register(t){return this._implementations.push(t),{dispose:()=>{let e=this._implementations.indexOf(t);e!==-1&&this._implementations.splice(e,1)}}}getImplementations(){return this._implementations}};var Ei=q("fileService");function pre(r){return!!(r.capabilities&2048)}var HC=class r extends Error{constructor(e,i){super(e);this.code=i}static create(e,i){let n=new r(e.toString(),i);return sye(n,i),n}};function rl(r,t){return HC.create(r,t)}function sye(r,t){return r.name=t?`${t} (FileSystemError)`:"FileSystemError",r}function aye(r){if(!r)return"Unknown";if(r instanceof HC)return r.code;let t=/^(.+) \(FileSystemError\)$/.exec(r.name);if(!t)return"Unknown";switch(t[1]){case"EntryExists":return"EntryExists";case"EntryIsADirectory":return"EntryIsADirectory";case"EntryNotADirectory":return"EntryNotADirectory";case"EntryNotFound":return"EntryNotFound";case"EntryTooLarge":return"EntryTooLarge";case"EntryWriteLocked":return"EntryWriteLocked";case"NoPermissions":return"NoPermissions";case"Unavailable":return"Unavailable"}return"Unknown"}function hre(r){if(r instanceof UC)return r.fileOperationResult;switch(aye(r)){case"EntryNotFound":return 1;case"EntryIsADirectory":return 0;case"EntryNotADirectory":return 9;case"EntryWriteLocked":return 5;case"NoPermissions":return 6;case"EntryExists":return 4;case"EntryTooLarge":return 7;default:return 10}}var UC=class extends Error{constructor(e,i,n){super(e);this.fileOperationResult=i;this.options=n}},tN=class extends UC{constructor(e,i,n,o){super(e,i,o);this.fileOperationResult=i;this.size=n}},iN=class extends UC{constructor(e,i,n){super(e,2,n);this.stat=i}};var fu={OFF:"off",AFTER_DELAY:"afterDelay",ON_FOCUS_CHANGE:"onFocusChange",ON_WINDOW_CHANGE:"onWindowChange"},zC={OFF:"off",ON_EXIT:"onExit",ON_EXIT_AND_WINDOW_CLOSE:"onExitAndWindowClose"},nN="files.associations";var mre="files.readonlyInclude",gre="files.readonlyExclude";var bu=(i=>(i[i.FILE=0]="FILE",i[i.FOLDER=1]="FOLDER",i[i.ROOT_FOLDER=2]="ROOT_FOLDER",i))(bu||{}),hk="";var vc=class r{static KB=1024;static MB=r.KB*r.KB;static GB=r.MB*r.KB;static TB=r.GB*r.KB;static formatSize(t){return cr(t)||(t=0),t<r.KB?u("sizeB","{0}B",t.toFixed(0)):t<r.MB?u("sizeKB","{0}KB",(t/r.KB).toFixed(2)):t<r.GB?u("sizeMB","{0}MB",(t/r.MB).toFixed(2)):t<r.TB?u("sizeGB","{0}GB",(t/r.GB).toFixed(2)):u("sizeTB","{0}TB",(t/r.TB).toFixed(2))}};function fre(r){let t=typeof r=="string"||r?.scheme===Ie.vscodeRemote;return typeof r!="string"&&r?.scheme===Ie.file?1024*vc.MB:t?10*vc.MB:si?50*vc.MB:1024*vc.MB}var bre="";var Wf=class extends R{_onWillDispose=this._register(new x);onWillDispose=this._onWillDispose.event;resolved=!1;async resolve(){this.resolved=!0}isResolved(){return this.resolved}isDisposed(){return this._store.isDisposed}dispose(){this._onWillDispose.fire(),super.dispose()}};var KC=q("ILanguageDetectionService"),z8="languageDetection";var vu=class extends Wf{constructor(e,i,n,o,s){super();this.modelService=e;this.languageService=i;this.languageDetectionService=n;this.accessibilityService=o;s&&this.handleExistingModel(s)}static AUTO_DETECT_LANGUAGE_THROTTLE_DELAY=600;textEditorModelHandle=void 0;createdEditorModel;modelDisposeListener=this._register(new yt);autoDetectLanguageThrottler=this._register(new lf(vu.AUTO_DETECT_LANGUAGE_THROTTLE_DELAY));handleExistingModel(e){let i=this.modelService.getModel(e);if(!i)throw new Error(`Document with resource ${e.toString(!0)} does not exist`);this.textEditorModelHandle=e,this.registerModelDisposeListener(i)}registerModelDisposeListener(e){this.modelDisposeListener.value=e.onWillDispose(()=>{this.textEditorModelHandle=void 0,this.dispose()})}get textEditorModel(){return this.textEditorModelHandle?this.modelService.getModel(this.textEditorModelHandle):null}isReadonly(){return!0}_hasLanguageSetExplicitly=!1;get hasLanguageSetExplicitly(){return this._hasLanguageSetExplicitly}setLanguageId(e,i){this._hasLanguageSetExplicitly=!0,this.setLanguageIdInternal(e,i)}setLanguageIdInternal(e,i){this.isResolved()&&(!e||e===this.textEditorModel.getLanguageId()||this.textEditorModel.setLanguage(this.languageService.createById(e),i))}installModelListeners(e){let i=this._register(e.onDidChangeLanguage(n=>{n.source!==z8&&(this._hasLanguageSetExplicitly=!0,i.dispose())}))}getLanguageId(){return this.textEditorModel?.getLanguageId()}autoDetectLanguage(){return this.autoDetectLanguageThrottler.trigger(()=>this.doAutoDetectLanguage())}async doAutoDetectLanguage(){if(this.hasLanguageSetExplicitly||!this.textEditorModelHandle||!this.languageDetectionService.isEnabledForLanguage(this.getLanguageId()??jn))return;let e=await this.languageDetectionService.detectLanguage(this.textEditorModelHandle),i=this.getLanguageId();if(e&&e!==i&&!this.isDisposed()){this.setLanguageIdInternal(e,z8);let n=this.languageService.getLanguageName(e);this.accessibilityService.alert(u("languageAutoDetected","Language {0} was automatically detected and set as the language mode.",n??e))}}createTextEditorModel(e,i,n){let o=this.getFirstLineText(e),s=this.getOrCreateLanguage(i,this.languageService,n,o);return this.doCreateTextEditorModel(e,s,i)}doCreateTextEditorModel(e,i,n){let o=n&&this.modelService.getModel(n);return o?this.updateTextEditorModel(e,i.languageId):(o=this.modelService.createModel(e,i,n),this.createdEditorModel=!0,this.registerModelDisposeListener(o)),this.textEditorModelHandle=o.uri,o}getFirstLineText(e){let i=e;return typeof i.getFirstLineText=="function"?i.getFirstLineText(1e3):e.getLineContent(1).substr(0,1e3)}getOrCreateLanguage(e,i,n,o){return!n||n===jn?i.createByFilepathOrFirstLine(e??null,o):i.createById(n)}updateTextEditorModel(e,i){this.isResolved()&&(e&&this.modelService.updateModel(this.textEditorModel,e),i&&i!==jn&&this.textEditorModel.getLanguageId()!==i&&this.textEditorModel.setLanguage(this.languageService.createById(i)))}createSnapshot(){return this.textEditorModel?this.textEditorModel.createSnapshot(!0):null}isResolved(){return!!this.textEditorModelHandle}dispose(){this.modelDisposeListener.dispose(),this.textEditorModelHandle&&this.createdEditorModel&&this.modelService.destroyModel(this.textEditorModelHandle),this.textEditorModelHandle=void 0,this.createdEditorModel=!1,super.dispose()}};vu=E([b(0,qi),b(1,ti),b(2,KC),b(3,Un)],vu);var oN=q("workingCopyBackupService");var Cs=q("textResourceConfigurationService"),GC=q("textResourcePropertiesService");var Ic=class r{constructor(t,e,i){this.startOffset=t;this.endOffset=e;this.newLength=i}static fromModelContentChanges(t){return t.map(i=>{let n=L.lift(i.range);return new r(_f(n.getStartPosition()),_f(n.getEndPosition()),$ie(i.text))}).reverse()}toString(){return`[${ta(this.startOffset)}...${ta(this.endOffset)}) -> ${ta(this.newLength)}`}},rN=class{nextEditIdx=0;deltaOldToNewLineCount=0;deltaOldToNewColumnCount=0;deltaLineIdxInOld=-1;edits;constructor(t){this.edits=t.map(e=>K8.from(e))}getOffsetBeforeChange(t){return this.adjustNextEdit(t),this.translateCurToOld(t)}getDistanceToNextChange(t){this.adjustNextEdit(t);let e=this.edits[this.nextEditIdx],i=e?this.translateOldToCur(e.offsetObj):null;return i===null?null:yI(t,i)}translateOldToCur(t){return t.lineCount===this.deltaLineIdxInOld?Mn(t.lineCount+this.deltaOldToNewLineCount,t.columnCount+this.deltaOldToNewColumnCount):Mn(t.lineCount+this.deltaOldToNewLineCount,t.columnCount)}translateCurToOld(t){let e=ta(t);return e.lineCount-this.deltaOldToNewLineCount===this.deltaLineIdxInOld?Mn(e.lineCount-this.deltaOldToNewLineCount,e.columnCount-this.deltaOldToNewColumnCount):Mn(e.lineCount-this.deltaOldToNewLineCount,e.columnCount)}adjustNextEdit(t){for(;this.nextEditIdx<this.edits.length;){let e=this.edits[this.nextEditIdx],i=this.translateOldToCur(e.endOffsetAfterObj);if(Tf(i,t)){this.nextEditIdx++;let n=ta(i),o=ta(this.translateOldToCur(e.endOffsetBeforeObj)),s=n.lineCount-o.lineCount;this.deltaOldToNewLineCount+=s;let a=this.deltaLineIdxInOld===e.endOffsetBeforeObj.lineCount?this.deltaOldToNewColumnCount:0,l=n.columnCount-o.columnCount;this.deltaOldToNewColumnCount=a+l,this.deltaLineIdxInOld=e.endOffsetBeforeObj.lineCount}else break}}},K8=class r{static from(t){return new r(t.startOffset,t.endOffset,t.newLength)}endOffsetBeforeObj;endOffsetAfterObj;offsetObj;constructor(t,e,i){this.endOffsetBeforeObj=ta(e),this.endOffsetAfterObj=ta(Gi(t,i)),this.offsetObj=ta(t)}};function Ire(r){if(r.length===0)return null;if(r.length===1)return r[0];let t=0;function e(){if(t>=r.length)return null;let s=t,a=r[s].listHeight;for(t++;t<r.length&&r[t].listHeight===a;)t++;return t-s>=2?$8(s===0&&t===r.length?r:r.slice(s,t),!1):r[s]}let i=e(),n=e();if(!n)return i;for(let s=e();s;s=e())vre(i,n)<=vre(n,s)?(i=G8(i,n),n=s):n=G8(n,s);return G8(i,n)}function $8(r,t=!1){if(r.length===0)return null;if(r.length===1)return r[0];let e=r.length;for(;e>3;){let i=e>>1;for(let n=0;n<i;n++){let o=n<<1;r[n]=Al.create23(r[o],r[o+1],o+3===e?r[o+2]:null,t)}e=i}return Al.create23(r[0],r[1],e>=3?r[2]:null,t)}function vre(r,t){return Math.abs(r.listHeight-t.listHeight)}function G8(r,t){return r.listHeight===t.listHeight?Al.create23(r,t,null,!1):r.listHeight>t.listHeight?lye(r,t):dye(t,r)}function lye(r,t){r=r.toMutable();let e=r,i=[],n;for(;;){if(t.listHeight===e.listHeight){n=t;break}if(e.kind!==4)throw new Error("unexpected");i.push(e),e=e.makeLastElementMutable()}for(let o=i.length-1;o>=0;o--){let s=i[o];n?s.childrenLength>=3?n=Al.create23(s.unappendChild(),n,null,!1):(s.appendChildOfSameHeight(n),n=void 0):s.handleChildrenChanged()}return n?Al.create23(r,n,null,!1):r}function dye(r,t){r=r.toMutable();let e=r,i=[];for(;t.listHeight!==e.listHeight;){if(e.kind!==4)throw new Error("unexpected");i.push(e),e=e.makeFirstElementMutable()}let n=t;for(let o=i.length-1;o>=0;o--){let s=i[o];n?s.childrenLength>=3?n=Al.create23(n,s.unprependChild(),null,!1):(s.prependChildOfSameHeight(n),n=void 0):s.handleChildrenChanged()}return n?Al.create23(n,r,null,!1):r}var sN=class{nextNodes;offsets;idxs;lastOffset=Xo;constructor(t){this.nextNodes=[t],this.offsets=[Xo],this.idxs=[]}readLongestNodeAt(t,e){if(km(t,this.lastOffset))throw new Error("Invalid offset");for(this.lastOffset=t;;){let i=mk(this.nextNodes);if(!i)return;let n=mk(this.offsets);if(km(t,n))return;if(km(n,t))if(Gi(n,i.length)<=t)this.nextNodeAfterCurrent();else{let o=j8(i);o!==-1?(this.nextNodes.push(i.getChild(o)),this.offsets.push(n),this.idxs.push(o)):this.nextNodeAfterCurrent()}else{if(e(i))return this.nextNodeAfterCurrent(),i;{let o=j8(i);if(o===-1){this.nextNodeAfterCurrent();return}else this.nextNodes.push(i.getChild(o)),this.offsets.push(n),this.idxs.push(o)}}}}nextNodeAfterCurrent(){for(;;){let t=mk(this.offsets),e=mk(this.nextNodes);if(this.nextNodes.pop(),this.offsets.pop(),this.idxs.length===0)break;let i=mk(this.nextNodes),n=j8(i,this.idxs[this.idxs.length-1]);if(n!==-1){this.nextNodes.push(i.getChild(n)),this.offsets.push(Gi(t,e.length)),this.idxs[this.idxs.length-1]=n;break}else this.idxs.pop()}}};function j8(r,t=-1){for(;;){if(t++,t>=r.childrenLength)return-1;if(r.getChild(t))return t}}function mk(r){return r.length>0?r[r.length-1]:void 0}function gk(r,t,e,i){return new X8(r,t,e,i).parseDocument()}var X8=class{constructor(t,e,i,n){this.tokenizer=t;this.createImmutableLists=n;if(i&&n)throw new Error("Not supported");this.oldNodeReader=i?new sN(i):void 0,this.positionMapper=new rN(e)}oldNodeReader;positionMapper;_itemsConstructed=0;_itemsFromCache=0;get nodesConstructed(){return this._itemsConstructed}get nodesReused(){return this._itemsFromCache}parseDocument(){this._itemsConstructed=0,this._itemsFromCache=0;let t=this.parseList(ys.getEmpty(),0);return t||(t=Al.getEmpty()),t}parseList(t,e){let i=[];for(;;){let o=this.tryReadChildFromCache(t);if(!o){let s=this.tokenizer.peek();if(!s||s.kind===2&&s.bracketIds.intersects(t))break;o=this.parseChild(t,e+1)}o.kind===4&&o.childrenLength===0||i.push(o)}return this.oldNodeReader?Ire(i):$8(i,this.createImmutableLists)}tryReadChildFromCache(t){if(this.oldNodeReader){let e=this.positionMapper.getDistanceToNextChange(this.tokenizer.offset);if(e===null||!vC(e)){let i=this.oldNodeReader.readLongestNodeAt(this.positionMapper.getOffsetBeforeChange(this.tokenizer.offset),n=>e!==null&&!km(n.length,e)?!1:n.canBeReused(t));if(i)return this._itemsFromCache++,this.tokenizer.skip(i.length),i}}}parseChild(t,e){this._itemsConstructed++;let i=this.tokenizer.read();switch(i.kind){case 2:return new o0(i.bracketIds,i.length);case 0:return i.astNode;case 1:{if(e>300)return new pu(i.length);let n=t.merge(i.bracketIds),o=this.parseList(n,e+1),s=this.tokenizer.peek();return s&&s.kind===2&&(s.bracketId===i.bracketId||s.bracketIds.intersects(i.bracketIds))?(this.tokenizer.read(),$D.create(i.astNode,o,s.astNode)):$D.create(i.astNode,o,null)}default:throw new Error("unexpected")}}};function qC(r,t){if(r.length===0)return t;if(t.length===0)return r;let e=new Ms(yre(r)),i=yre(t);i.push({modified:!1,lengthBefore:void 0,lengthAfter:void 0});let n=e.dequeue();function o(d){if(d===void 0){let p=e.takeWhile(h=>!0)||[];return n&&p.unshift(n),p}let c=[];for(;n&&!vC(d);){let[p,h]=n.splitAt(d);c.push(p),d=yI(p.lengthAfter,d),n=h??e.dequeue()}return vC(d)||c.push(new fk(!1,d,d)),c}let s=[];function a(d,c,p){if(s.length>0&&jG(s[s.length-1].endOffset,d)){let h=s[s.length-1];s[s.length-1]=new Ic(h.startOffset,c,Gi(h.newLength,p))}else s.push({startOffset:d,endOffset:c,newLength:p})}let l=Xo;for(let d of i){let c=o(d.lengthBefore);if(d.modified){let p=qie(c,m=>m.lengthBefore),h=Gi(l,p);a(l,h,d.lengthAfter),l=h}else for(let p of c){let h=l;l=Gi(l,p.lengthBefore),p.modified&&a(h,l,p.lengthAfter)}}return s}var fk=class r{constructor(t,e,i){this.modified=t;this.lengthBefore=e;this.lengthAfter=i}splitAt(t){let e=yI(t,this.lengthAfter);return jG(e,Xo)?[this,void 0]:this.modified?[new r(this.modified,this.lengthBefore,t),new r(this.modified,Xo,e)]:[new r(this.modified,t,t),new r(this.modified,e,e)]}toString(){return`${this.modified?"M":"U"}:${ta(this.lengthBefore)} -> ${ta(this.lengthAfter)}`}};function yre(r){let t=[],e=Xo;for(let i of r){let n=yI(e,i.startOffset);vC(n)||t.push(new fk(!1,n,n));let o=yI(i.startOffset,i.endOffset);t.push(new fk(!0,o,i.newLength)),e=i.endOffset}return t}var aN=class extends R{constructor(e,i){super();this.textModel=e;this.getLanguageConfiguration=i;if(e.tokenization.hasTokens)e.tokenization.backgroundTokenizationState===2?(this.initialAstWithoutTokens=void 0,this.astWithTokens=this.parseDocumentFromTextBuffer([],void 0,!1)):(this.initialAstWithoutTokens=this.parseDocumentFromTextBuffer([],void 0,!0),this.astWithTokens=this.initialAstWithoutTokens);else{let n=this.brackets.getSingleLanguageBracketTokens(this.textModel.getLanguageId()),o=new i0(this.textModel.getValue(),n);this.initialAstWithoutTokens=gk(o,[],void 0,!0),this.astWithTokens=this.initialAstWithoutTokens}}didChangeEmitter=new x;initialAstWithoutTokens;astWithTokens;denseKeyProvider=new yC;brackets=new wC(this.denseKeyProvider,this.getLanguageConfiguration);didLanguageChange(e){return this.brackets.didLanguageChange(e)}onDidChange=this.didChangeEmitter.event;queuedTextEditsForInitialAstWithoutTokens=[];queuedTextEdits=[];handleDidChangeBackgroundTokenizationState(){if(this.textModel.tokenization.backgroundTokenizationState===2){let e=this.initialAstWithoutTokens===void 0;this.initialAstWithoutTokens=void 0,e||this.didChangeEmitter.fire()}}handleDidChangeTokens({ranges:e}){let i=e.map(n=>new Ic(Mn(n.fromLineNumber-1,0),Mn(n.toLineNumber,0),Mn(n.toLineNumber-n.fromLineNumber+1,0)));this.handleEdits(i,!0),this.initialAstWithoutTokens||this.didChangeEmitter.fire()}handleContentChanged(e){let i=Ic.fromModelContentChanges(e.changes);this.handleEdits(i,!1)}handleEdits(e,i){let n=qC(this.queuedTextEdits,e);this.queuedTextEdits=n,this.initialAstWithoutTokens&&!i&&(this.queuedTextEditsForInitialAstWithoutTokens=qC(this.queuedTextEditsForInitialAstWithoutTokens,e))}flushQueue(){this.queuedTextEdits.length>0&&(this.astWithTokens=this.parseDocumentFromTextBuffer(this.queuedTextEdits,this.astWithTokens,!1),this.queuedTextEdits=[]),this.queuedTextEditsForInitialAstWithoutTokens.length>0&&(this.initialAstWithoutTokens&&(this.initialAstWithoutTokens=this.parseDocumentFromTextBuffer(this.queuedTextEditsForInitialAstWithoutTokens,this.initialAstWithoutTokens,!1)),this.queuedTextEditsForInitialAstWithoutTokens=[])}parseDocumentFromTextBuffer(e,i,n){let s=i,a=new EC(this.textModel,this.brackets);return gk(a,e,s,n)}getBracketsInRange(e,i){this.flushQueue();let n=Mn(e.startLineNumber-1,e.startColumn-1),o=Mn(e.endLineNumber-1,e.endColumn-1);return new um(s=>{let a=this.initialAstWithoutTokens||this.astWithTokens;Y8(a,Xo,a.length,n,o,s,0,0,new Map,i)})}getBracketPairsInRange(e,i){this.flushQueue();let n=_f(e.getStartPosition()),o=_f(e.getEndPosition());return new um(s=>{let a=this.initialAstWithoutTokens||this.astWithTokens,l=new Q8(s,i,this.textModel);Z8(a,Xo,a.length,n,o,l,0,new Map)})}getFirstBracketAfter(e){this.flushQueue();let i=this.initialAstWithoutTokens||this.astWithTokens;return Cre(i,Xo,i.length,_f(e))}getFirstBracketBefore(e){this.flushQueue();let i=this.initialAstWithoutTokens||this.astWithTokens;return Sre(i,Xo,i.length,_f(e))}};function Sre(r,t,e,i){if(r.kind===4||r.kind===2){let n=[];for(let o of r.children)e=Gi(t,o.length),n.push({nodeOffsetStart:t,nodeOffsetEnd:e}),t=e;for(let o=n.length-1;o>=0;o--){let{nodeOffsetStart:s,nodeOffsetEnd:a}=n[o];if(km(s,i)){let l=Sre(r.children[o],s,a,i);if(l)return l}}return null}else{if(r.kind===3)return null;if(r.kind===1){let n=Df(t,e);return{bracketInfo:r.bracketInfo,range:n}}}return null}function Cre(r,t,e,i){if(r.kind===4||r.kind===2){for(let n of r.children){if(e=Gi(t,n.length),km(i,e)){let o=Cre(n,t,e,i);if(o)return o}t=e}return null}else{if(r.kind===3)return null;if(r.kind===1){let n=Df(t,e);return{bracketInfo:r.bracketInfo,range:n}}}return null}function Y8(r,t,e,i,n,o,s,a,l,d,c=!1){if(s>200)return!0;e:for(;;)switch(r.kind){case 4:{let p=r.childrenLength;for(let h=0;h<p;h++){let m=r.getChild(h);if(m){if(e=Gi(t,m.length),Tf(t,n)&&IC(e,i)){if(IC(e,n)){r=m;continue e}if(!Y8(m,t,e,i,n,o,s,0,l,d))return!1}t=e}}return!0}case 2:{let p=!d||!r.closingBracket||r.closingBracket.bracketInfo.closesColorized(r.openingBracket.bracketInfo),h=0;if(l){let f=l.get(r.openingBracket.text);f===void 0&&(f=0),h=f,p&&(f++,l.set(r.openingBracket.text,f))}let m=r.childrenLength;for(let f=0;f<m;f++){let g=r.getChild(f);if(g){if(e=Gi(t,g.length),Tf(t,n)&&IC(e,i)){if(IC(e,n)&&g.kind!==1){r=g,p?(s++,a=h+1):a=h;continue e}if((p||g.kind!==1||!r.closingBracket)&&!Y8(g,t,e,i,n,o,p?s+1:s,p?h+1:h,l,d,!r.closingBracket))return!1}t=e}}return l?.set(r.openingBracket.text,h),!0}case 3:{let p=Df(t,e);return o(new QD(p,s-1,0,!0))}case 1:{let p=Df(t,e);return o(new QD(p,s-1,a-1,c))}case 0:return!0}}var Q8=class{constructor(t,e,i){this.push=t;this.includeMinIndentation=e;this.textModel=i}};function Z8(r,t,e,i,n,o,s,a){if(s>200)return!0;let l=!0;if(r.kind===2){let d=0;if(a){let h=a.get(r.openingBracket.text);h===void 0&&(h=0),d=h,h++,a.set(r.openingBracket.text,h)}let c=Gi(t,r.openingBracket.length),p=-1;if(o.includeMinIndentation&&(p=r.computeMinIndentation(t,o.textModel)),l=o.push(new r0(Df(t,e),Df(t,c),r.closingBracket?Df(Gi(c,r.child?.length||Xo),e):void 0,s,d,r,p)),t=c,l&&r.child){let h=r.child;if(e=Gi(t,h.length),Tf(t,n)&&IC(e,i)&&(l=Z8(h,t,e,i,n,o,s+1,a),!l))return!1}a?.set(r.openingBracket.text,d)}else{let d=t;for(let c of r.children){let p=d;if(d=Gi(d,c.length),Tf(p,n)&&Tf(i,d)&&(l=Z8(c,p,d,i,n,o,s,a),!l))return!1}}return l}var dN=class extends R{constructor(e,i){super();this.textModel=e;this.languageConfigurationService=i}bracketPairsTree=this._register(new yt);onDidChangeEmitter=new x;onDidChange=this.onDidChangeEmitter.event;get canBuildAST(){return this.textModel.getValueLength()<=5e6}bracketsRequested=!1;handleLanguageConfigurationServiceChange(e){(!e.languageId||this.bracketPairsTree.value?.object.didLanguageChange(e.languageId))&&(this.bracketPairsTree.clear(),this.updateBracketPairsTree())}handleDidChangeOptions(e){this.bracketPairsTree.clear(),this.updateBracketPairsTree()}handleDidChangeLanguage(e){this.bracketPairsTree.clear(),this.updateBracketPairsTree()}handleDidChangeContent(e){this.bracketPairsTree.value?.object.handleContentChanged(e)}handleDidChangeBackgroundTokenizationState(){this.bracketPairsTree.value?.object.handleDidChangeBackgroundTokenizationState()}handleDidChangeTokens(e){this.bracketPairsTree.value?.object.handleDidChangeTokens(e)}updateBracketPairsTree(){if(this.bracketsRequested&&this.canBuildAST){if(!this.bracketPairsTree.value){let e=new B;this.bracketPairsTree.value=cye(e.add(new aN(this.textModel,i=>this.languageConfigurationService.getLanguageConfiguration(i))),e),e.add(this.bracketPairsTree.value.object.onDidChange(i=>this.onDidChangeEmitter.fire(i))),this.onDidChangeEmitter.fire()}}else this.bracketPairsTree.value&&(this.bracketPairsTree.clear(),this.onDidChangeEmitter.fire())}getBracketPairsInRange(e){return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getBracketPairsInRange(e,!1)||um.empty}getBracketPairsInRangeWithMinIndentation(e){return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getBracketPairsInRange(e,!0)||um.empty}getBracketsInRange(e,i=!1){return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getBracketsInRange(e,i)||um.empty}findMatchingBracketUp(e,i,n){let o=this.textModel.validatePosition(i),s=this.textModel.getLanguageIdAtPosition(o.lineNumber,o.column);if(this.canBuildAST){let a=this.languageConfigurationService.getLanguageConfiguration(s).bracketsNew.getClosingBracketInfo(e);if(!a)return null;let l=this.getBracketPairsInRange(L.fromPositions(i,i)).findLast(d=>a.closes(d.openingBracketInfo));return l?l.openingBracketRange:null}else{let a=e.toLowerCase(),l=this.languageConfigurationService.getLanguageConfiguration(s).brackets;if(!l)return null;let d=l.textIsBracket[a];return d?lN(this._findMatchingBracketUp(d,o,e3(n))):null}}matchBracket(e,i){if(this.canBuildAST){let n=this.getBracketPairsInRange(L.fromPositions(e,e)).filter(o=>o.closingBracketRange!==void 0&&(o.openingBracketRange.containsPosition(e)||o.closingBracketRange.containsPosition(e))).findLastMaxBy(Sr(o=>o.openingBracketRange.containsPosition(e)?o.openingBracketRange:o.closingBracketRange,L.compareRangesUsingStarts));return n?[n.openingBracketRange,n.closingBracketRange]:null}else{let n=e3(i);return this._matchBracket(this.textModel.validatePosition(e),n)}}_establishBracketSearchOffsets(e,i,n,o){let s=i.getCount(),a=i.getLanguageId(o),l=Math.max(0,e.column-1-n.maxBracketLength);for(let c=o-1;c>=0;c--){let p=i.getEndOffset(c);if(p<=l)break;if(hc(i.getStandardTokenType(c))||i.getLanguageId(c)!==a){l=p;break}}let d=Math.min(i.getLineContent().length,e.column-1+n.maxBracketLength);for(let c=o+1;c<s;c++){let p=i.getStartOffset(c);if(p>=d)break;if(hc(i.getStandardTokenType(c))||i.getLanguageId(c)!==a){d=p;break}}return{searchStartOffset:l,searchEndOffset:d}}_matchBracket(e,i){let n=e.lineNumber,o=this.textModel.tokenization.getLineTokens(n),s=this.textModel.getLineContent(n),a=o.findTokenIndexAtOffset(e.column-1);if(a<0)return null;let l=this.languageConfigurationService.getLanguageConfiguration(o.getLanguageId(a)).brackets;if(l&&!hc(o.getStandardTokenType(a))){let{searchStartOffset:d,searchEndOffset:c}=this._establishBracketSearchOffsets(e,o,l,a),p=null;for(;;){let h=Ca.findNextBracketInRange(l.forwardRegex,n,s,d,c);if(!h)break;if(h.startColumn<=e.column&&e.column<=h.endColumn){let m=s.substring(h.startColumn-1,h.endColumn-1).toLowerCase(),f=this._matchFoundBracket(h,l.textIsBracket[m],l.textIsOpenBracket[m],i);if(f){if(f instanceof Bm)return null;p=f}}d=h.endColumn-1}if(p)return p}if(a>0&&o.getStartOffset(a)===e.column-1){let d=a-1,c=this.languageConfigurationService.getLanguageConfiguration(o.getLanguageId(d)).brackets;if(c&&!hc(o.getStandardTokenType(d))){let{searchStartOffset:p,searchEndOffset:h}=this._establishBracketSearchOffsets(e,o,c,d),m=Ca.findPrevBracketInRange(c.reversedRegex,n,s,p,h);if(m&&m.startColumn<=e.column&&e.column<=m.endColumn){let f=s.substring(m.startColumn-1,m.endColumn-1).toLowerCase(),g=this._matchFoundBracket(m,c.textIsBracket[f],c.textIsOpenBracket[f],i);if(g)return g instanceof Bm?null:g}}}return null}_matchFoundBracket(e,i,n,o){if(!i)return null;let s=n?this._findMatchingBracketDown(i,e.getEndPosition(),o):this._findMatchingBracketUp(i,e.getStartPosition(),o);return s?s instanceof Bm?s:[e,s]:null}_findMatchingBracketUp(e,i,n){let o=e.languageId,s=e.reversedRegex,a=-1,l=0,d=(c,p,h,m)=>{for(;;){if(n&&++l%100===0&&!n())return Bm.INSTANCE;let f=Ca.findPrevBracketInRange(s,c,p,h,m);if(!f)break;let g=p.substring(f.startColumn-1,f.endColumn-1).toLowerCase();if(e.isOpen(g)?a++:e.isClose(g)&&a--,a===0)return f;m=f.startColumn-1}return null};for(let c=i.lineNumber;c>=1;c--){let p=this.textModel.tokenization.getLineTokens(c),h=p.getCount(),m=this.textModel.getLineContent(c),f=h-1,g=m.length,v=m.length;c===i.lineNumber&&(f=p.findTokenIndexAtOffset(i.column-1),g=i.column-1,v=i.column-1);let I=!0;for(;f>=0;f--){let y=p.getLanguageId(f)===o&&!hc(p.getStandardTokenType(f));if(y)I?g=p.getStartOffset(f):(g=p.getStartOffset(f),v=p.getEndOffset(f));else if(I&&g!==v){let w=d(c,m,g,v);if(w)return w}I=y}if(I&&g!==v){let y=d(c,m,g,v);if(y)return y}}return null}_findMatchingBracketDown(e,i,n){let o=e.languageId,s=e.forwardRegex,a=1,l=0,d=(p,h,m,f)=>{for(;;){if(n&&++l%100===0&&!n())return Bm.INSTANCE;let g=Ca.findNextBracketInRange(s,p,h,m,f);if(!g)break;let v=h.substring(g.startColumn-1,g.endColumn-1).toLowerCase();if(e.isOpen(v)?a++:e.isClose(v)&&a--,a===0)return g;m=g.endColumn-1}return null},c=this.textModel.getLineCount();for(let p=i.lineNumber;p<=c;p++){let h=this.textModel.tokenization.getLineTokens(p),m=h.getCount(),f=this.textModel.getLineContent(p),g=0,v=0,I=0;p===i.lineNumber&&(g=h.findTokenIndexAtOffset(i.column-1),v=i.column-1,I=i.column-1);let y=!0;for(;g<m;g++){let w=h.getLanguageId(g)===o&&!hc(h.getStandardTokenType(g));if(w)y||(v=h.getStartOffset(g)),I=h.getEndOffset(g);else if(y&&v!==I){let C=d(p,f,v,I);if(C)return C}y=w}if(y&&v!==I){let w=d(p,f,v,I);if(w)return w}}return null}findPrevBracket(e){let i=this.textModel.validatePosition(e);if(this.canBuildAST)return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getFirstBracketBefore(i)||null;let n=null,o=null,s=null;for(let a=i.lineNumber;a>=1;a--){let l=this.textModel.tokenization.getLineTokens(a),d=l.getCount(),c=this.textModel.getLineContent(a),p=d-1,h=c.length,m=c.length;if(a===i.lineNumber){p=l.findTokenIndexAtOffset(i.column-1),h=i.column-1,m=i.column-1;let g=l.getLanguageId(p);n!==g&&(n=g,o=this.languageConfigurationService.getLanguageConfiguration(n).brackets,s=this.languageConfigurationService.getLanguageConfiguration(n).bracketsNew)}let f=!0;for(;p>=0;p--){let g=l.getLanguageId(p);if(n!==g){if(o&&s&&f&&h!==m){let I=Ca.findPrevBracketInRange(o.reversedRegex,a,c,h,m);if(I)return this._toFoundBracket(s,I);f=!1}n=g,o=this.languageConfigurationService.getLanguageConfiguration(n).brackets,s=this.languageConfigurationService.getLanguageConfiguration(n).bracketsNew}let v=!!o&&!hc(l.getStandardTokenType(p));if(v)f?h=l.getStartOffset(p):(h=l.getStartOffset(p),m=l.getEndOffset(p));else if(s&&o&&f&&h!==m){let I=Ca.findPrevBracketInRange(o.reversedRegex,a,c,h,m);if(I)return this._toFoundBracket(s,I)}f=v}if(s&&o&&f&&h!==m){let g=Ca.findPrevBracketInRange(o.reversedRegex,a,c,h,m);if(g)return this._toFoundBracket(s,g)}}return null}findNextBracket(e){let i=this.textModel.validatePosition(e);if(this.canBuildAST)return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getFirstBracketAfter(i)||null;let n=this.textModel.getLineCount(),o=null,s=null,a=null;for(let l=i.lineNumber;l<=n;l++){let d=this.textModel.tokenization.getLineTokens(l),c=d.getCount(),p=this.textModel.getLineContent(l),h=0,m=0,f=0;if(l===i.lineNumber){h=d.findTokenIndexAtOffset(i.column-1),m=i.column-1,f=i.column-1;let v=d.getLanguageId(h);o!==v&&(o=v,s=this.languageConfigurationService.getLanguageConfiguration(o).brackets,a=this.languageConfigurationService.getLanguageConfiguration(o).bracketsNew)}let g=!0;for(;h<c;h++){let v=d.getLanguageId(h);if(o!==v){if(a&&s&&g&&m!==f){let y=Ca.findNextBracketInRange(s.forwardRegex,l,p,m,f);if(y)return this._toFoundBracket(a,y);g=!1}o=v,s=this.languageConfigurationService.getLanguageConfiguration(o).brackets,a=this.languageConfigurationService.getLanguageConfiguration(o).bracketsNew}let I=!!s&&!hc(d.getStandardTokenType(h));if(I)g||(m=d.getStartOffset(h)),f=d.getEndOffset(h);else if(a&&s&&g&&m!==f){let y=Ca.findNextBracketInRange(s.forwardRegex,l,p,m,f);if(y)return this._toFoundBracket(a,y)}g=I}if(a&&s&&g&&m!==f){let v=Ca.findNextBracketInRange(s.forwardRegex,l,p,m,f);if(v)return this._toFoundBracket(a,v)}}return null}findEnclosingBrackets(e,i){let n=this.textModel.validatePosition(e);if(this.canBuildAST){let f=L.fromPositions(n),g=this.getBracketPairsInRange(L.fromPositions(n,n)).findLast(v=>v.closingBracketRange!==void 0&&v.range.strictContainsRange(f));return g?[g.openingBracketRange,g.closingBracketRange]:null}let o=e3(i),s=this.textModel.getLineCount(),a=new Map,l=[],d=(f,g)=>{if(!a.has(f)){let v=[];for(let I=0,y=g?g.brackets.length:0;I<y;I++)v[I]=0;a.set(f,v)}l=a.get(f)},c=0,p=(f,g,v,I,y)=>{for(;;){if(o&&++c%100===0&&!o())return Bm.INSTANCE;let w=Ca.findNextBracketInRange(f.forwardRegex,g,v,I,y);if(!w)break;let C=v.substring(w.startColumn-1,w.endColumn-1).toLowerCase(),S=f.textIsBracket[C];if(S&&(S.isOpen(C)?l[S.index]++:S.isClose(C)&&l[S.index]--,l[S.index]===-1))return this._matchFoundBracket(w,S,!1,o);I=w.endColumn-1}return null},h=null,m=null;for(let f=n.lineNumber;f<=s;f++){let g=this.textModel.tokenization.getLineTokens(f),v=g.getCount(),I=this.textModel.getLineContent(f),y=0,w=0,C=0;if(f===n.lineNumber){y=g.findTokenIndexAtOffset(n.column-1),w=n.column-1,C=n.column-1;let D=g.getLanguageId(y);h!==D&&(h=D,m=this.languageConfigurationService.getLanguageConfiguration(h).brackets,d(h,m))}let S=!0;for(;y<v;y++){let D=g.getLanguageId(y);if(h!==D){if(m&&S&&w!==C){let M=p(m,f,I,w,C);if(M)return lN(M);S=!1}h=D,m=this.languageConfigurationService.getLanguageConfiguration(h).brackets,d(h,m)}let k=!!m&&!hc(g.getStandardTokenType(y));if(k)S||(w=g.getStartOffset(y)),C=g.getEndOffset(y);else if(m&&S&&w!==C){let M=p(m,f,I,w,C);if(M)return lN(M)}S=k}if(m&&S&&w!==C){let D=p(m,f,I,w,C);if(D)return lN(D)}}return null}_toFoundBracket(e,i){if(!i)return null;let n=this.textModel.getValueInRange(i);n=n.toLowerCase();let o=e.getBracketInfo(n);return o?{range:i,bracketInfo:o}:null}};function cye(r,t){return{object:r,dispose:()=>t?.dispose()}}function e3(r){if(typeof r>"u")return()=>!0;{let t=Date.now();return()=>Date.now()-t<=r}}var Bm=class r{static INSTANCE=new r;_searchCanceledBrand=void 0;constructor(){}};function lN(r){return r instanceof Bm?null:r}var t3=T("editor.lineHighlightBackground",null,u("lineHighlight","Background color for the highlight of line at the cursor position.")),i3=T("editor.lineHighlightBorder",{dark:"#282828",light:"#eeeeee",hcDark:"#f38518",hcLight:Oe},u("lineHighlightBorderBox","Background color for the border around the line at the cursor position.")),mit=T("editor.rangeHighlightBackground",{dark:"#ffffff0b",light:"#fdff0033",hcDark:null,hcLight:null},u("rangeHighlight","Background color of highlighted ranges, like by quick open and find features. The color must not be opaque so as not to hide underlying decorations."),!0),git=T("editor.rangeHighlightBorder",{dark:null,light:null,hcDark:fi,hcLight:fi},u("rangeHighlightBorder","Background color of the border around highlighted ranges.")),fit=T("editor.symbolHighlightBackground",{dark:Ol,light:Ol,hcDark:null,hcLight:null},u("symbolHighlight","Background color of highlighted symbol, like for go to definition or go next/previous symbol. The color must not be opaque so as not to hide underlying decorations."),!0),bit=T("editor.symbolHighlightBorder",{dark:null,light:null,hcDark:fi,hcLight:fi},u("symbolHighlightBorder","Background color of the border around highlighted symbols.")),$C=T("editorCursor.foreground",{dark:"#AEAFAD",light:j.black,hcDark:j.white,hcLight:"#0F4A85"},u("caret","Color of the editor cursor.")),cN=T("editorCursor.background",null,u("editorCursorBackground","The background color of the editor cursor. Allows customizing the color of a character overlapped by a block cursor.")),uN=T("editorMultiCursor.primary.foreground",$C,u("editorMultiCursorPrimaryForeground","Color of the primary editor cursor when multiple cursors are present.")),wre=T("editorMultiCursor.primary.background",cN,u("editorMultiCursorPrimaryBackground","The background color of the primary editor cursor when multiple cursors are present. Allows customizing the color of a character overlapped by a block cursor.")),pN=T("editorMultiCursor.secondary.foreground",$C,u("editorMultiCursorSecondaryForeground","Color of secondary editor cursors when multiple cursors are present.")),Ere=T("editorMultiCursor.secondary.background",cN,u("editorMultiCursorSecondaryBackground","The background color of secondary editor cursors when multiple cursors are present. Allows customizing the color of a character overlapped by a block cursor.")),hN=T("editorWhitespace.foreground",{dark:"#e3e4e229",light:"#33333333",hcDark:"#e3e4e229",hcLight:"#CCCCCC"},u("editorWhitespaces","Color of whitespace characters in the editor.")),xre=T("editorLineNumber.foreground",{dark:"#858585",light:"#237893",hcDark:j.white,hcLight:"#292929"},u("editorLineNumbers","Color of editor line numbers.")),uye=T("editorIndentGuide.background",hN,u("editorIndentGuides","Color of the editor indentation guides."),!1,u("deprecatedEditorIndentGuides","'editorIndentGuide.background' is deprecated. Use 'editorIndentGuide.background1' instead.")),pye=T("editorIndentGuide.activeBackground",hN,u("editorActiveIndentGuide","Color of the active editor indentation guides."),!1,u("deprecatedEditorActiveIndentGuide","'editorIndentGuide.activeBackground' is deprecated. Use 'editorIndentGuide.activeBackground1' instead.")),Tre=T("editorIndentGuide.background1",uye,u("editorIndentGuides1","Color of the editor indentation guides (1).")),_re=T("editorIndentGuide.background2","#00000000",u("editorIndentGuides2","Color of the editor indentation guides (2).")),Dre=T("editorIndentGuide.background3","#00000000",u("editorIndentGuides3","Color of the editor indentation guides (3).")),kre=T("editorIndentGuide.background4","#00000000",u("editorIndentGuides4","Color of the editor indentation guides (4).")),Lre=T("editorIndentGuide.background5","#00000000",u("editorIndentGuides5","Color of the editor indentation guides (5).")),Rre=T("editorIndentGuide.background6","#00000000",u("editorIndentGuides6","Color of the editor indentation guides (6).")),Pre=T("editorIndentGuide.activeBackground1",pye,u("editorActiveIndentGuide1","Color of the active editor indentation guides (1).")),Mre=T("editorIndentGuide.activeBackground2","#00000000",u("editorActiveIndentGuide2","Color of the active editor indentation guides (2).")),Are=T("editorIndentGuide.activeBackground3","#00000000",u("editorActiveIndentGuide3","Color of the active editor indentation guides (3).")),Ore=T("editorIndentGuide.activeBackground4","#00000000",u("editorActiveIndentGuide4","Color of the active editor indentation guides (4).")),Nre=T("editorIndentGuide.activeBackground5","#00000000",u("editorActiveIndentGuide5","Color of the active editor indentation guides (5).")),Fre=T("editorIndentGuide.activeBackground6","#00000000",u("editorActiveIndentGuide6","Color of the active editor indentation guides (6).")),hye=T("editorActiveLineNumber.foreground",{dark:"#c6c6c6",light:"#0B216F",hcDark:fi,hcLight:fi},u("editorActiveLineNumber","Color of editor active line number"),!1,u("deprecatedEditorActiveLineNumber","Id is deprecated. Use 'editorLineNumber.activeForeground' instead.")),vit=T("editorLineNumber.activeForeground",hye,u("editorActiveLineNumber","Color of editor active line number")),Bre=T("editorLineNumber.dimmedForeground",null,u("editorDimmedLineNumber","Color of the final editor line when editor.renderFinalNewline is set to dimmed.")),Iit=T("editorRuler.foreground",{dark:"#5A5A5A",light:j.lightgrey,hcDark:j.white,hcLight:"#292929"},u("editorRuler","Color of the editor rulers.")),yit=T("editorCodeLens.foreground",{dark:"#999999",light:"#919191",hcDark:"#999999",hcLight:"#292929"},u("editorCodeLensForeground","Foreground color of editor CodeLens")),Sit=T("editorBracketMatch.background",{dark:"#0064001a",light:"#0064001a",hcDark:"#0064001a",hcLight:"#0000"},u("editorBracketMatchBackground","Background color behind matching brackets")),Cit=T("editorBracketMatch.border",{dark:"#888",light:"#B9B9B9",hcDark:Oe,hcLight:Oe},u("editorBracketMatchBorder","Color for matching brackets boxes")),mN=T("editorOverviewRuler.border",{dark:"#7f7f7f4d",light:"#7f7f7f4d",hcDark:"#7f7f7f4d",hcLight:"#666666"},u("editorOverviewRulerBorder","Color of the overview ruler border.")),Vre=T("editorOverviewRuler.background",null,u("editorOverviewRulerBackground","Background color of the editor overview ruler.")),wit=T("editorGutter.background",Hs,u("editorGutter","Background color of the editor gutter. The gutter contains the glyph margins and the line numbers.")),Eit=T("editorUnnecessaryCode.border",{dark:null,light:null,hcDark:j.fromHex("#fff").transparent(.8),hcLight:Oe},u("unnecessaryCodeBorder","Border color of unnecessary (unused) source code in the editor.")),Wre=T("editorUnnecessaryCode.opacity",{dark:j.fromHex("#000a"),light:j.fromHex("#0007"),hcDark:null,hcLight:null},u("unnecessaryCodeOpacity",`Opacity of unnecessary (unused) source code in the editor. For example, "#000000c0" will render the code with 75% opacity. For high contrast themes, use the  'editorUnnecessaryCode.border' theme color to underline unnecessary code instead of fading it out.`)),xit=T("editorGhostText.border",{dark:null,light:null,hcDark:j.fromHex("#fff").transparent(.8),hcLight:j.fromHex("#292929").transparent(.8)},u("editorGhostTextBorder","Border color of ghost text in the editor.")),Tit=T("editorGhostText.foreground",{dark:j.fromHex("#ffffff56"),light:j.fromHex("#0007"),hcDark:null,hcLight:null},u("editorGhostTextForeground","Foreground color of the ghost text in the editor.")),_it=T("editorGhostText.background",null,u("editorGhostTextBackground","Background color of the ghost text in the editor.")),mye=new j(new xt(0,122,204,.6)),Dit=T("editorOverviewRuler.rangeHighlightForeground",mye,u("overviewRulerRangeHighlight","Overview ruler marker color for range highlights. The color must not be opaque so as not to hide underlying decorations."),!0),kit=T("editorOverviewRuler.errorForeground",{dark:new j(new xt(255,18,18,.7)),light:new j(new xt(255,18,18,.7)),hcDark:new j(new xt(255,50,50,1)),hcLight:"#B5200D"},u("overviewRuleError","Overview ruler marker color for errors.")),Lit=T("editorOverviewRuler.warningForeground",{dark:Zr,light:Zr,hcDark:RC,hcLight:RC},u("overviewRuleWarning","Overview ruler marker color for warnings.")),Rit=T("editorOverviewRuler.infoForeground",{dark:Jr,light:Jr,hcDark:PC,hcLight:PC},u("overviewRuleInfo","Overview ruler marker color for infos.")),gN=T("editorBracketHighlight.foreground1",{dark:"#FFD700",light:"#0431FAFF",hcDark:"#FFD700",hcLight:"#0431FAFF"},u("editorBracketHighlightForeground1","Foreground color of brackets (1). Requires enabling bracket pair colorization.")),fN=T("editorBracketHighlight.foreground2",{dark:"#DA70D6",light:"#319331FF",hcDark:"#DA70D6",hcLight:"#319331FF"},u("editorBracketHighlightForeground2","Foreground color of brackets (2). Requires enabling bracket pair colorization.")),bN=T("editorBracketHighlight.foreground3",{dark:"#179FFF",light:"#7B3814FF",hcDark:"#87CEFA",hcLight:"#7B3814FF"},u("editorBracketHighlightForeground3","Foreground color of brackets (3). Requires enabling bracket pair colorization.")),vN=T("editorBracketHighlight.foreground4","#00000000",u("editorBracketHighlightForeground4","Foreground color of brackets (4). Requires enabling bracket pair colorization.")),IN=T("editorBracketHighlight.foreground5","#00000000",u("editorBracketHighlightForeground5","Foreground color of brackets (5). Requires enabling bracket pair colorization.")),yN=T("editorBracketHighlight.foreground6","#00000000",u("editorBracketHighlightForeground6","Foreground color of brackets (6). Requires enabling bracket pair colorization.")),Hre=T("editorBracketHighlight.unexpectedBracket.foreground",{dark:new j(new xt(255,18,18,.8)),light:new j(new xt(255,18,18,.8)),hcDark:"new Color(new RGBA(255, 50, 50, 1))",hcLight:"#B5200D"},u("editorBracketHighlightUnexpectedBracketForeground","Foreground color of unexpected brackets.")),Ure=T("editorBracketPairGuide.background1","#00000000",u("editorBracketPairGuide.background1","Background color of inactive bracket pair guides (1). Requires enabling bracket pair guides.")),zre=T("editorBracketPairGuide.background2","#00000000",u("editorBracketPairGuide.background2","Background color of inactive bracket pair guides (2). Requires enabling bracket pair guides.")),Kre=T("editorBracketPairGuide.background3","#00000000",u("editorBracketPairGuide.background3","Background color of inactive bracket pair guides (3). Requires enabling bracket pair guides.")),Gre=T("editorBracketPairGuide.background4","#00000000",u("editorBracketPairGuide.background4","Background color of inactive bracket pair guides (4). Requires enabling bracket pair guides.")),qre=T("editorBracketPairGuide.background5","#00000000",u("editorBracketPairGuide.background5","Background color of inactive bracket pair guides (5). Requires enabling bracket pair guides.")),$re=T("editorBracketPairGuide.background6","#00000000",u("editorBracketPairGuide.background6","Background color of inactive bracket pair guides (6). Requires enabling bracket pair guides.")),jre=T("editorBracketPairGuide.activeBackground1","#00000000",u("editorBracketPairGuide.activeBackground1","Background color of active bracket pair guides (1). Requires enabling bracket pair guides.")),Xre=T("editorBracketPairGuide.activeBackground2","#00000000",u("editorBracketPairGuide.activeBackground2","Background color of active bracket pair guides (2). Requires enabling bracket pair guides.")),Yre=T("editorBracketPairGuide.activeBackground3","#00000000",u("editorBracketPairGuide.activeBackground3","Background color of active bracket pair guides (3). Requires enabling bracket pair guides.")),Qre=T("editorBracketPairGuide.activeBackground4","#00000000",u("editorBracketPairGuide.activeBackground4","Background color of active bracket pair guides (4). Requires enabling bracket pair guides.")),Zre=T("editorBracketPairGuide.activeBackground5","#00000000",u("editorBracketPairGuide.activeBackground5","Background color of active bracket pair guides (5). Requires enabling bracket pair guides.")),Jre=T("editorBracketPairGuide.activeBackground6","#00000000",u("editorBracketPairGuide.activeBackground6","Background color of active bracket pair guides (6). Requires enabling bracket pair guides.")),Pit=T("editorUnicodeHighlight.border",Zr,u("editorUnicodeHighlight.border","Border color used to highlight unicode characters.")),Mit=T("editorUnicodeHighlight.background",hne,u("editorUnicodeHighlight.background","Background color used to highlight unicode characters."));Zo((r,t)=>{let e=r.getColor(Hs),i=r.getColor(t3),n=i&&!i.isTransparent()?i:e;n&&t.addRule(`.monaco-editor .inputarea.ime-input { background-color: ${n}; }`)});var SN=class extends R{constructor(e){super();this.textModel=e;this.colorizationOptions=e.getOptions().bracketPairColorizationOptions,this._register(e.bracketPairs.onDidChange(i=>{this.onDidChangeEmitter.fire()}))}colorizationOptions;colorProvider=new CN;onDidChangeEmitter=new x;onDidChange=this.onDidChangeEmitter.event;handleDidChangeOptions(e){this.colorizationOptions=this.textModel.getOptions().bracketPairColorizationOptions}getDecorationsInRange(e,i,n,o){return o?[]:i===void 0?[]:this.colorizationOptions.enabled?this.textModel.bracketPairs.getBracketsInRange(e,!0).map(a=>({id:`bracket${a.range.toString()}-${a.nestingLevel}`,options:{description:"BracketPairColorization",inlineClassName:this.colorProvider.getInlineClassName(a,this.colorizationOptions.independentColorPoolPerBracketType)},ownerId:0,range:a.range})).toArray():[]}getAllDecorations(e,i){return e===void 0?[]:this.colorizationOptions.enabled?this.getDecorationsInRange(new L(1,1,this.textModel.getLineCount(),1),e,i):[]}},CN=class{unexpectedClosingBracketClassName="unexpected-closing-bracket";getInlineClassName(t,e){return t.isInvalid?this.unexpectedClosingBracketClassName:this.getInlineClassNameOfLevel(e?t.nestingLevelOfEqualBracketType:t.nestingLevel)}getInlineClassNameOfLevel(t){return`bracket-highlighting-${t%30}`}};Zo((r,t)=>{let e=[gN,fN,bN,vN,IN,yN],i=new CN;t.addRule(`.monaco-editor .${i.unexpectedClosingBracketClassName} { color: ${r.getColor(Hre)}; }`);let n=e.map(o=>r.getColor(o)).filter(o=>!!o).filter(o=>!o.isTransparent());for(let o=0;o<30;o++){let s=n[o%n.length];t.addRule(`.monaco-editor .${i.getInlineClassNameOfLevel(o)} { color: ${s}; }`)}});function jC(r){return r.toString()}var sl=class r{constructor(t,e,i,n,o,s,a){this.beforeVersionId=t;this.afterVersionId=e;this.beforeEOL=i;this.afterEOL=n;this.beforeCursorState=o;this.afterCursorState=s;this.changes=a}static create(t,e){let i=t.getAlternativeVersionId(),n=r3(t);return new r(i,i,n,n,e,e,[])}append(t,e,i,n,o){e.length>0&&(this.changes=wie(this.changes,e)),this.afterEOL=i,this.afterVersionId=n,this.afterCursorState=o}static _writeSelectionsSize(t){return 4+4*4*(t?t.length:0)}static _writeSelections(t,e,i){if(Xr(t,e?e.length:0,i),i+=4,e)for(let n of e)Xr(t,n.selectionStartLineNumber,i),i+=4,Xr(t,n.selectionStartColumn,i),i+=4,Xr(t,n.positionLineNumber,i),i+=4,Xr(t,n.positionColumn,i),i+=4;return i}static _readSelections(t,e,i){let n=jr(t,e);e+=4;for(let o=0;o<n;o++){let s=jr(t,e);e+=4;let a=jr(t,e);e+=4;let l=jr(t,e);e+=4;let d=jr(t,e);e+=4,i.push(new Et(s,a,l,d))}return e}serialize(){let t=10+r._writeSelectionsSize(this.beforeCursorState)+r._writeSelectionsSize(this.afterCursorState)+4;for(let n of this.changes)t+=n.writeSize();let e=new Uint8Array(t),i=0;Xr(e,this.beforeVersionId,i),i+=4,Xr(e,this.afterVersionId,i),i+=4,DO(e,this.beforeEOL,i),i+=1,DO(e,this.afterEOL,i),i+=1,i=r._writeSelections(e,this.beforeCursorState,i),i=r._writeSelections(e,this.afterCursorState,i),Xr(e,this.changes.length,i),i+=4;for(let n of this.changes)i=n.write(e,i);return e.buffer}static deserialize(t){let e=new Uint8Array(t),i=0,n=jr(e,i);i+=4;let o=jr(e,i);i+=4;let s=_O(e,i);i+=1;let a=_O(e,i);i+=1;let l=[];i=r._readSelections(e,i,l);let d=[];i=r._readSelections(e,i,d);let c=jr(e,i);i+=4;let p=[];for(let h=0;h<c;h++)i=Rl.read(e,i,p);return new r(n,o,s,a,l,d,p)}},wN=class{constructor(t,e,i,n){this.label=t;this.code=e;this.model=i,this._data=sl.create(i,n)}model;_data;get type(){return 0}get resource(){return Z.isUri(this.model)?this.model:this.model.uri}toString(){return(this._data instanceof sl?this._data:sl.deserialize(this._data)).changes.map(e=>e.toString()).join(", ")}matchesResource(t){return(Z.isUri(this.model)?this.model:this.model.uri).toString()===t.toString()}setModel(t){this.model=t}canAppend(t){return this.model===t&&this._data instanceof sl}append(t,e,i,n,o){this._data instanceof sl&&this._data.append(t,e,i,n,o)}close(){this._data instanceof sl&&(this._data=this._data.serialize())}open(){this._data instanceof sl||(this._data=sl.deserialize(this._data))}undo(){if(Z.isUri(this.model))throw new Error("Invalid SingleModelEditStackElement");this._data instanceof sl&&(this._data=this._data.serialize());let t=sl.deserialize(this._data);this.model._applyUndo(t.changes,t.beforeEOL,t.beforeVersionId,t.beforeCursorState)}redo(){if(Z.isUri(this.model))throw new Error("Invalid SingleModelEditStackElement");this._data instanceof sl&&(this._data=this._data.serialize());let t=sl.deserialize(this._data);this.model._applyRedo(t.changes,t.afterEOL,t.afterVersionId,t.afterCursorState)}heapSize(){return this._data instanceof sl&&(this._data=this._data.serialize()),this._data.byteLength+168}},o3=class{constructor(t,e,i){this.label=t;this.code=e;this._isOpen=!0,this._editStackElementsArr=i.slice(0),this._editStackElementsMap=new Map;for(let n of this._editStackElementsArr){let o=jC(n.resource);this._editStackElementsMap.set(o,n)}this._delegate=null}type=1;_isOpen;_editStackElementsArr;_editStackElementsMap;_delegate;get resources(){return this._editStackElementsArr.map(t=>t.resource)}setDelegate(t){this._delegate=t}prepareUndoRedo(){if(this._delegate)return this._delegate.prepareUndoRedo(this)}getMissingModels(){let t=[];for(let e of this._editStackElementsArr)Z.isUri(e.model)&&t.push(e.model);return t}matchesResource(t){let e=jC(t);return this._editStackElementsMap.has(e)}setModel(t){let e=jC(Z.isUri(t)?t:t.uri);this._editStackElementsMap.has(e)&&this._editStackElementsMap.get(e).setModel(t)}canAppend(t){if(!this._isOpen)return!1;let e=jC(t.uri);return this._editStackElementsMap.has(e)?this._editStackElementsMap.get(e).canAppend(t):!1}append(t,e,i,n,o){let s=jC(t.uri);this._editStackElementsMap.get(s).append(t,e,i,n,o)}close(){this._isOpen=!1}open(){}undo(){this._isOpen=!1;for(let t of this._editStackElementsArr)t.undo()}redo(){for(let t of this._editStackElementsArr)t.redo()}heapSize(t){let e=jC(t);return this._editStackElementsMap.has(e)?this._editStackElementsMap.get(e).heapSize():0}split(){return this._editStackElementsArr}toString(){let t=[];for(let e of this._editStackElementsArr)t.push(`${Ji(e.resource)}: ${e}`);return`{${t.join(", ")}}`}};function r3(r){return r.getEOL()===`
`?0:1}function n3(r){return r?r instanceof wN||r instanceof o3:!1}var EN=class r{_model;_undoRedoService;constructor(t,e){this._model=t,this._undoRedoService=e}pushStackElement(){let t=this._undoRedoService.getLastElement(this._model.uri);n3(t)&&t.close()}popStackElement(){let t=this._undoRedoService.getLastElement(this._model.uri);n3(t)&&t.open()}clear(){this._undoRedoService.removeElements(this._model.uri)}_getOrCreateEditStackElement(t,e){let i=this._undoRedoService.getLastElement(this._model.uri);if(n3(i)&&i.canAppend(this._model))return i;let n=new wN(u("edit","Typing"),"undoredo.textBufferEdit",this._model,t);return this._undoRedoService.pushElement(n,e),n}pushEOL(t){let e=this._getOrCreateEditStackElement(null,void 0);this._model.setEOL(t),e.append(this._model,[],r3(this._model),this._model.getAlternativeVersionId(),null)}pushEditOperation(t,e,i,n){let o=this._getOrCreateEditStackElement(t,n),s=this._model.applyEdits(e,!0),a=r._computeCursorState(i,s),l=s.map((d,c)=>({index:c,textChange:d.textChange}));return l.sort((d,c)=>d.textChange.oldPosition===c.textChange.oldPosition?d.index-c.index:d.textChange.oldPosition-c.textChange.oldPosition),o.append(this._model,l.map(d=>d.textChange),r3(this._model),this._model.getAlternativeVersionId(),a),a}static _computeCursorState(t,e){try{return t?t(e):null}catch(i){return Xe(i),null}}};var XC=class extends R{_isDisposed=!1;dispose(){super.dispose(),this._isDisposed=!0}assertNotDisposed(){if(this._isDisposed)throw new Error("TextModelPart is disposed!")}};function ise(r,t){let e=0,i=0,n=r.length;for(;i<n;){let o=r.charCodeAt(i);if(o===32)e++;else if(o===9)e=e-e%t+t;else break;i++}return i===n?-1:e}var xN=class extends XC{constructor(e,i){super();this.textModel=e;this.languageConfigurationService=i}getLanguageConfiguration(e){return this.languageConfigurationService.getLanguageConfiguration(e)}_computeIndentLevel(e){return ise(this.textModel.getLineContent(e+1),this.textModel.getOptions().tabSize)}getActiveIndentGuide(e,i,n){this.assertNotDisposed();let o=this.textModel.getLineCount();if(e<1||e>o)throw new _t("Illegal value for lineNumber");let s=this.getLanguageConfiguration(this.textModel.getLanguageId()).foldingRules,a=!!(s&&s.offSide),l=-2,d=-1,c=-2,p=-1,h=M=>{if(l!==-1&&(l===-2||l>M-1)){l=-1,d=-1;for(let O=M-2;O>=0;O--){let K=this._computeIndentLevel(O);if(K>=0){l=O,d=K;break}}}if(c===-2){c=-1,p=-1;for(let O=M;O<o;O++){let K=this._computeIndentLevel(O);if(K>=0){c=O,p=K;break}}}},m=-2,f=-1,g=-2,v=-1,I=M=>{if(m===-2){m=-1,f=-1;for(let O=M-2;O>=0;O--){let K=this._computeIndentLevel(O);if(K>=0){m=O,f=K;break}}}if(g!==-1&&(g===-2||g<M-1)){g=-1,v=-1;for(let O=M;O<o;O++){let K=this._computeIndentLevel(O);if(K>=0){g=O,v=K;break}}}},y=0,w=!0,C=0,S=!0,D=0,k=0;for(let M=0;w||S;M++){let O=e-M,K=e+M;M>1&&(O<1||O<i)&&(w=!1),M>1&&(K>o||K>n)&&(S=!1),M>5e4&&(w=!1,S=!1);let G=-1;if(w&&O>=1){let ge=this._computeIndentLevel(O-1);ge>=0?(c=O-1,p=ge,G=Math.ceil(ge/this.textModel.getOptions().indentSize)):(h(O),G=this._getIndentLevelForWhitespaceLine(a,d,p))}let Y=-1;if(S&&K<=o){let ge=this._computeIndentLevel(K-1);ge>=0?(m=K-1,f=ge,Y=Math.ceil(ge/this.textModel.getOptions().indentSize)):(I(K),Y=this._getIndentLevelForWhitespaceLine(a,f,v))}if(M===0){k=G;continue}if(M===1){if(K<=o&&Y>=0&&k+1===Y){w=!1,y=K,C=K,D=Y;continue}if(O>=1&&G>=0&&G-1===k){S=!1,y=O,C=O,D=G;continue}if(y=e,C=e,D=k,D===0)return{startLineNumber:y,endLineNumber:C,indent:D}}w&&(G>=D?y=O:w=!1),S&&(Y>=D?C=K:S=!1)}return{startLineNumber:y,endLineNumber:C,indent:D}}getLinesBracketGuides(e,i,n,o){let s=[];for(let h=e;h<=i;h++)s.push([]);let a=!0,l=this.textModel.bracketPairs.getBracketPairsInRangeWithMinIndentation(new L(e,1,i,this.textModel.getLineMaxColumn(i))).toArray(),d;if(n&&l.length>0){let h=(e<=n.lineNumber&&n.lineNumber<=i?l:this.textModel.bracketPairs.getBracketPairsInRange(L.fromPositions(n)).toArray()).filter(m=>L.strictContainsPosition(m.range,n));d=lm(h,m=>a||m.range.startLineNumber!==m.range.endLineNumber)?.range}let c=this.textModel.getOptions().bracketPairColorizationOptions.independentColorPoolPerBracketType,p=new bk;for(let h of l){if(!h.closingBracketRange)continue;let m=d&&h.range.equalsRange(d);if(!m&&!o.includeInactive)continue;let f=p.getInlineClassName(h.nestingLevel,h.nestingLevelOfEqualBracketType,c)+(o.highlightActive&&m?" "+p.activeClassName:""),g=h.openingBracketRange.getStartPosition(),v=h.closingBracketRange.getStartPosition(),I=o.horizontalGuides===2||o.horizontalGuides===1&&m;if(h.range.startLineNumber===h.range.endLineNumber){a&&I&&s[h.range.startLineNumber-e].push(new mc(-1,h.openingBracketRange.getEndPosition().column,f,new Lm(!1,v.column),-1,-1));continue}let y=this.getVisibleColumnFromPosition(v),w=this.getVisibleColumnFromPosition(h.openingBracketRange.getStartPosition()),C=Math.min(w,y,h.minVisibleColumnIndentation+1),S=!1;Jn(this.textModel.getLineContent(h.closingBracketRange.startLineNumber))<h.closingBracketRange.startColumn-1&&(S=!0);let M=Math.max(g.lineNumber,e),O=Math.min(v.lineNumber,i),K=S?1:0;for(let G=M;G<O+K;G++)s[G-e].push(new mc(C,-1,f,null,G===g.lineNumber?g.column:-1,G===v.lineNumber?v.column:-1));I&&(g.lineNumber>=e&&w>C&&s[g.lineNumber-e].push(new mc(C,-1,f,new Lm(!1,g.column),-1,-1)),v.lineNumber<=i&&y>C&&s[v.lineNumber-e].push(new mc(C,-1,f,new Lm(!S,v.column),-1,-1)))}for(let h of s)h.sort((m,f)=>m.visibleColumn-f.visibleColumn);return s}getVisibleColumnFromPosition(e){return tn.visibleColumnFromColumn(this.textModel.getLineContent(e.lineNumber),e.column,this.textModel.getOptions().tabSize)+1}getLinesIndentGuides(e,i){this.assertNotDisposed();let n=this.textModel.getLineCount();if(e<1||e>n)throw new Error("Illegal value for startLineNumber");if(i<1||i>n)throw new Error("Illegal value for endLineNumber");let o=this.textModel.getOptions(),s=this.getLanguageConfiguration(this.textModel.getLanguageId()).foldingRules,a=!!(s&&s.offSide),l=new Array(i-e+1),d=-2,c=-1,p=-2,h=-1;for(let m=e;m<=i;m++){let f=m-e,g=this._computeIndentLevel(m-1);if(g>=0){d=m-1,c=g,l[f]=Math.ceil(g/o.indentSize);continue}if(d===-2){d=-1,c=-1;for(let v=m-2;v>=0;v--){let I=this._computeIndentLevel(v);if(I>=0){d=v,c=I;break}}}if(p!==-1&&(p===-2||p<m-1)){p=-1,h=-1;for(let v=m;v<n;v++){let I=this._computeIndentLevel(v);if(I>=0){p=v,h=I;break}}}l[f]=this._getIndentLevelForWhitespaceLine(a,c,h)}return l}_getIndentLevelForWhitespaceLine(e,i,n){let o=this.textModel.getOptions();return i===-1||n===-1?0:i<n?1+Math.floor(i/o.indentSize):i===n||e?Math.ceil(n/o.indentSize):1+Math.floor(n/o.indentSize)}},bk=class{activeClassName="indent-active";getInlineClassName(t,e,i){return this.getInlineClassNameOfLevel(i?e:t)}getInlineClassNameOfLevel(t){return`bracket-indent-guide lvl-${t%30}`}};var s3=class{spacesDiff=0;looksLikeAlignment=!1};function fye(r,t,e,i,n){n.spacesDiff=0,n.looksLikeAlignment=!1;let o;for(o=0;o<t&&o<i;o++){let h=r.charCodeAt(o),m=e.charCodeAt(o);if(h!==m)break}let s=0,a=0;for(let h=o;h<t;h++)r.charCodeAt(h)===32?s++:a++;let l=0,d=0;for(let h=o;h<i;h++)e.charCodeAt(h)===32?l++:d++;if(s>0&&a>0||l>0&&d>0)return;let c=Math.abs(a-d),p=Math.abs(s-l);if(c===0){n.spacesDiff=p,p>0&&0<=l-1&&l-1<r.length&&l<e.length&&e.charCodeAt(l)!==32&&r.charCodeAt(l-1)===32&&r.charCodeAt(r.length-1)===44&&(n.looksLikeAlignment=!0);return}if(p%c===0){n.spacesDiff=p/c;return}}function a3(r,t,e){let i=Math.min(r.getLineCount(),1e4),n=0,o=0,s="",a=0,l=[2,4,6,8,3,5,7],d=8,c=[0,0,0,0,0,0,0,0,0],p=new s3;for(let f=1;f<=i;f++){let g=r.getLineLength(f),v=r.getLineContent(f),I=g<=65536,y=!1,w=0,C=0,S=0;for(let k=0,M=g;k<M;k++){let O=I?v.charCodeAt(k):r.getLineCharCode(f,k);if(O===9)S++;else if(O===32)C++;else{y=!0,w=k;break}}if(!y||(S>0?n++:C>1&&o++,fye(s,a,v,w,p),p.looksLikeAlignment&&!(e&&t===p.spacesDiff)))continue;let D=p.spacesDiff;D<=d&&c[D]++,s=v,a=w}let h=e;n!==o&&(h=n<o);let m=t;if(h){let f=h?0:.1*i;l.forEach(g=>{let v=c[g];v>f&&(f=v,m=g)}),m===4&&c[4]>0&&c[2]>0&&c[2]>=c[4]/2&&(m=2)}return{insertSpaces:h,tabSize:m}}function Ea(r){return(r.metadata&1)>>>0}function mn(r,t){r.metadata=r.metadata&254|t<<0}function es(r){return(r.metadata&2)>>>1===1}function an(r,t){r.metadata=r.metadata&253|(t?1:0)<<1}function cse(r){return(r.metadata&4)>>>2===1}function nse(r,t){r.metadata=r.metadata&251|(t?1:0)<<2}function use(r){return(r.metadata&64)>>>6===1}function ose(r,t){r.metadata=r.metadata&191|(t?1:0)<<6}function bye(r){return(r.metadata&24)>>>3}function rse(r,t){r.metadata=r.metadata&231|t<<3}function vye(r){return(r.metadata&32)>>>5===1}function sse(r,t){r.metadata=r.metadata&223|(t?1:0)<<5}var yk=class{metadata;parent;left;right;start;end;delta;maxEnd;id;ownerId;options;cachedVersionId;cachedAbsoluteStart;cachedAbsoluteEnd;range;constructor(t,e,i){this.metadata=0,this.parent=this,this.left=this,this.right=this,mn(this,1),this.start=e,this.end=i,this.delta=0,this.maxEnd=i,this.id=t,this.ownerId=0,this.options=null,nse(this,!1),ose(this,!1),rse(this,1),sse(this,!1),this.cachedVersionId=0,this.cachedAbsoluteStart=e,this.cachedAbsoluteEnd=i,this.range=null,an(this,!1)}reset(t,e,i,n){this.start=e,this.end=i,this.maxEnd=i,this.cachedVersionId=t,this.cachedAbsoluteStart=e,this.cachedAbsoluteEnd=i,this.range=n}setOptions(t){this.options=t;let e=this.options.className;nse(this,e==="squiggly-error"||e==="squiggly-warning"||e==="squiggly-info"),ose(this,this.options.glyphMarginClassName!==null),rse(this,this.options.stickiness),sse(this,this.options.collapseOnReplaceEdit)}setCachedOffsets(t,e,i){this.cachedVersionId!==i&&(this.range=null),this.cachedVersionId=i,this.cachedAbsoluteStart=t,this.cachedAbsoluteEnd=e}detach(){this.parent=null,this.left=null,this.right=null}},ei=new yk(null,0,0);ei.parent=ei;ei.left=ei;ei.right=ei;mn(ei,0);var QC=class{root;requestNormalizeDelta;constructor(){this.root=ei,this.requestNormalizeDelta=!1}intervalSearch(t,e,i,n,o,s){return this.root===ei?[]:xye(this,t,e,i,n,o,s)}search(t,e,i,n){return this.root===ei?[]:ase(this,t,e,i,n)}collectNodesFromOwner(t){return wye(this,t)}collectNodesPostOrder(){return Eye(this)}insert(t){lse(this,t),this._normalizeDeltaIfNecessary()}delete(t){dse(this,t),this._normalizeDeltaIfNecessary()}resolveNode(t,e){let i=t,n=0;for(;t!==this.root;)t===t.parent.right&&(n+=t.parent.delta),t=t.parent;let o=i.start+n,s=i.end+n;i.setCachedOffsets(o,s,e)}acceptReplace(t,e,i,n){let o=Sye(this,t,t+e);for(let s=0,a=o.length;s<a;s++){let l=o[s];dse(this,l)}this._normalizeDeltaIfNecessary(),Cye(this,t,t+e,i),this._normalizeDeltaIfNecessary();for(let s=0,a=o.length;s<a;s++){let l=o[s];l.start=l.cachedAbsoluteStart,l.end=l.cachedAbsoluteEnd,yye(l,t,t+e,i,n),l.maxEnd=l.end,lse(this,l)}this._normalizeDeltaIfNecessary()}getAllInOrder(){return ase(this,0,!1,0,!1)}_normalizeDeltaIfNecessary(){this.requestNormalizeDelta&&(this.requestNormalizeDelta=!1,Iye(this))}};function Iye(r){let t=r.root,e=0;for(;t!==ei;){if(t.left!==ei&&!es(t.left)){t=t.left;continue}if(t.right!==ei&&!es(t.right)){e+=t.delta,t=t.right;continue}t.start=e+t.start,t.end=e+t.end,t.delta=0,Vm(t),an(t,!0),an(t.left,!1),an(t.right,!1),t===t.parent.right&&(e-=t.parent.delta),t=t.parent}an(r.root,!1)}function YC(r,t,e,i){return r<e?!0:r>e||i===1?!1:i===2?!0:t}function yye(r,t,e,i,n){let o=bye(r),s=o===0||o===2,a=o===1||o===2,l=e-t,d=i,c=Math.min(l,d),p=r.start,h=!1,m=r.end,f=!1;t<=p&&m<=e&&vye(r)&&(r.start=t,h=!0,r.end=t,f=!0);{let v=n?1:l>0?2:0;!h&&YC(p,s,t,v)&&(h=!0),!f&&YC(m,a,t,v)&&(f=!0)}if(c>0&&!n){let v=l>d?2:0;!h&&YC(p,s,t+c,v)&&(h=!0),!f&&YC(m,a,t+c,v)&&(f=!0)}{let v=n?1:0;!h&&YC(p,s,e,v)&&(r.start=t+d,h=!0),!f&&YC(m,a,e,v)&&(r.end=t+d,f=!0)}let g=d-l;h||(r.start=Math.max(0,p+g)),f||(r.end=Math.max(0,m+g)),r.start>r.end&&(r.end=r.start)}function Sye(r,t,e){let i=r.root,n=0,o=0,s=0,a=0,l=[],d=0;for(;i!==ei;){if(es(i)){an(i.left,!1),an(i.right,!1),i===i.parent.right&&(n-=i.parent.delta),i=i.parent;continue}if(!es(i.left)){if(o=n+i.maxEnd,o<t){an(i,!0);continue}if(i.left!==ei){i=i.left;continue}}if(s=n+i.start,s>e){an(i,!0);continue}if(a=n+i.end,a>=t&&(i.setCachedOffsets(s,a,0),l[d++]=i),an(i,!0),i.right!==ei&&!es(i.right)){n+=i.delta,i=i.right;continue}}return an(r.root,!1),l}function Cye(r,t,e,i){let n=r.root,o=0,s=0,a=0,l=i-(e-t);for(;n!==ei;){if(es(n)){an(n.left,!1),an(n.right,!1),n===n.parent.right&&(o-=n.parent.delta),Vm(n),n=n.parent;continue}if(!es(n.left)){if(s=o+n.maxEnd,s<t){an(n,!0);continue}if(n.left!==ei){n=n.left;continue}}if(a=o+n.start,a>e){n.start+=l,n.end+=l,n.delta+=l,(n.delta<-1073741824||n.delta>1073741824)&&(r.requestNormalizeDelta=!0),an(n,!0);continue}if(an(n,!0),n.right!==ei&&!es(n.right)){o+=n.delta,n=n.right;continue}}an(r.root,!1)}function wye(r,t){let e=r.root,i=[],n=0;for(;e!==ei;){if(es(e)){an(e.left,!1),an(e.right,!1),e=e.parent;continue}if(e.left!==ei&&!es(e.left)){e=e.left;continue}if(e.ownerId===t&&(i[n++]=e),an(e,!0),e.right!==ei&&!es(e.right)){e=e.right;continue}}return an(r.root,!1),i}function Eye(r){let t=r.root,e=[],i=0;for(;t!==ei;){if(es(t)){an(t.left,!1),an(t.right,!1),t=t.parent;continue}if(t.left!==ei&&!es(t.left)){t=t.left;continue}if(t.right!==ei&&!es(t.right)){t=t.right;continue}e[i++]=t,an(t,!0)}return an(r.root,!1),e}function ase(r,t,e,i,n){let o=r.root,s=0,a=0,l=0,d=[],c=0;for(;o!==ei;){if(es(o)){an(o.left,!1),an(o.right,!1),o===o.parent.right&&(s-=o.parent.delta),o=o.parent;continue}if(o.left!==ei&&!es(o.left)){o=o.left;continue}a=s+o.start,l=s+o.end,o.setCachedOffsets(a,l,i);let p=!0;if(t&&o.ownerId&&o.ownerId!==t&&(p=!1),e&&cse(o)&&(p=!1),n&&!use(o)&&(p=!1),p&&(d[c++]=o),an(o,!0),o.right!==ei&&!es(o.right)){s+=o.delta,o=o.right;continue}}return an(r.root,!1),d}function xye(r,t,e,i,n,o,s){let a=r.root,l=0,d=0,c=0,p=0,h=[],m=0;for(;a!==ei;){if(es(a)){an(a.left,!1),an(a.right,!1),a===a.parent.right&&(l-=a.parent.delta),a=a.parent;continue}if(!es(a.left)){if(d=l+a.maxEnd,d<t){an(a,!0);continue}if(a.left!==ei){a=a.left;continue}}if(c=l+a.start,c>e){an(a,!0);continue}if(p=l+a.end,p>=t){a.setCachedOffsets(c,p,o);let f=!0;i&&a.ownerId&&a.ownerId!==i&&(f=!1),n&&cse(a)&&(f=!1),s&&!use(a)&&(f=!1),f&&(h[m++]=a)}if(an(a,!0),a.right!==ei&&!es(a.right)){l+=a.delta,a=a.right;continue}}return an(r.root,!1),h}function lse(r,t){if(r.root===ei)return t.parent=ei,t.left=ei,t.right=ei,mn(t,0),r.root=t,r.root;Tye(r,t),Hf(t.parent);let e=t;for(;e!==r.root&&Ea(e.parent)===1;)if(e.parent===e.parent.parent.left){let i=e.parent.parent.right;Ea(i)===1?(mn(e.parent,0),mn(i,0),mn(e.parent.parent,1),e=e.parent.parent):(e===e.parent.right&&(e=e.parent,vk(r,e)),mn(e.parent,0),mn(e.parent.parent,1),Ik(r,e.parent.parent))}else{let i=e.parent.parent.left;Ea(i)===1?(mn(e.parent,0),mn(i,0),mn(e.parent.parent,1),e=e.parent.parent):(e===e.parent.left&&(e=e.parent,Ik(r,e)),mn(e.parent,0),mn(e.parent.parent,1),vk(r,e.parent.parent))}return mn(r.root,0),t}function Tye(r,t){let e=0,i=r.root,n=t.start,o=t.end;for(;;)if(Dye(n,o,i.start+e,i.end+e)<0)if(i.left===ei){t.start-=e,t.end-=e,t.maxEnd-=e,i.left=t;break}else i=i.left;else if(i.right===ei){t.start-=e+i.delta,t.end-=e+i.delta,t.maxEnd-=e+i.delta,i.right=t;break}else e+=i.delta,i=i.right;t.parent=i,t.left=ei,t.right=ei,mn(t,1)}function dse(r,t){let e,i;if(t.left===ei?(e=t.right,i=t,e.delta+=t.delta,(e.delta<-1073741824||e.delta>1073741824)&&(r.requestNormalizeDelta=!0),e.start+=t.delta,e.end+=t.delta):t.right===ei?(e=t.left,i=t):(i=_ye(t.right),e=i.right,e.start+=i.delta,e.end+=i.delta,e.delta+=i.delta,(e.delta<-1073741824||e.delta>1073741824)&&(r.requestNormalizeDelta=!0),i.start+=t.delta,i.end+=t.delta,i.delta=t.delta,(i.delta<-1073741824||i.delta>1073741824)&&(r.requestNormalizeDelta=!0)),i===r.root){r.root=e,mn(e,0),t.detach(),l3(),Vm(e),r.root.parent=ei;return}let n=Ea(i)===1;if(i===i.parent.left?i.parent.left=e:i.parent.right=e,i===t?e.parent=i.parent:(i.parent===t?e.parent=i:e.parent=i.parent,i.left=t.left,i.right=t.right,i.parent=t.parent,mn(i,Ea(t)),t===r.root?r.root=i:t===t.parent.left?t.parent.left=i:t.parent.right=i,i.left!==ei&&(i.left.parent=i),i.right!==ei&&(i.right.parent=i)),t.detach(),n){Hf(e.parent),i!==t&&(Hf(i),Hf(i.parent)),l3();return}Hf(e),Hf(e.parent),i!==t&&(Hf(i),Hf(i.parent));let o;for(;e!==r.root&&Ea(e)===0;)e===e.parent.left?(o=e.parent.right,Ea(o)===1&&(mn(o,0),mn(e.parent,1),vk(r,e.parent),o=e.parent.right),Ea(o.left)===0&&Ea(o.right)===0?(mn(o,1),e=e.parent):(Ea(o.right)===0&&(mn(o.left,0),mn(o,1),Ik(r,o),o=e.parent.right),mn(o,Ea(e.parent)),mn(e.parent,0),mn(o.right,0),vk(r,e.parent),e=r.root)):(o=e.parent.left,Ea(o)===1&&(mn(o,0),mn(e.parent,1),Ik(r,e.parent),o=e.parent.left),Ea(o.left)===0&&Ea(o.right)===0?(mn(o,1),e=e.parent):(Ea(o.left)===0&&(mn(o.right,0),mn(o,1),vk(r,o),o=e.parent.left),mn(o,Ea(e.parent)),mn(e.parent,0),mn(o.left,0),Ik(r,e.parent),e=r.root));mn(e,0),l3()}function _ye(r){for(;r.left!==ei;)r=r.left;return r}function l3(){ei.parent=ei,ei.delta=0,ei.start=0,ei.end=0}function vk(r,t){let e=t.right;e.delta+=t.delta,(e.delta<-1073741824||e.delta>1073741824)&&(r.requestNormalizeDelta=!0),e.start+=t.delta,e.end+=t.delta,t.right=e.left,e.left!==ei&&(e.left.parent=t),e.parent=t.parent,t.parent===ei?r.root=e:t===t.parent.left?t.parent.left=e:t.parent.right=e,e.left=t,t.parent=e,Vm(t),Vm(e)}function Ik(r,t){let e=t.left;t.delta-=e.delta,(t.delta<-1073741824||t.delta>1073741824)&&(r.requestNormalizeDelta=!0),t.start-=e.delta,t.end-=e.delta,t.left=e.right,e.right!==ei&&(e.right.parent=t),e.parent=t.parent,t.parent===ei?r.root=e:t===t.parent.right?t.parent.right=e:t.parent.left=e,e.right=t,t.parent=e,Vm(t),Vm(e)}function pse(r){let t=r.end;if(r.left!==ei){let e=r.left.maxEnd;e>t&&(t=e)}if(r.right!==ei){let e=r.right.maxEnd+r.delta;e>t&&(t=e)}return t}function Vm(r){r.maxEnd=pse(r)}function Hf(r){for(;r!==ei;){let t=pse(r);if(r.maxEnd===t)return;r.maxEnd=t,r=r.parent}}function Dye(r,t,e,i){return r===e?t-i:r-e}var ZC=class{parent;left;right;color;piece;size_left;lf_left;constructor(t,e){this.piece=t,this.color=e,this.size_left=0,this.lf_left=0,this.parent=this,this.left=this,this.right=this}next(){if(this.right!==Lt)return TN(this.right);let t=this;for(;t.parent!==Lt&&t.parent.left!==t;)t=t.parent;return t.parent===Lt?Lt:t.parent}prev(){if(this.left!==Lt)return c3(this.left);let t=this;for(;t.parent!==Lt&&t.parent.right!==t;)t=t.parent;return t.parent===Lt?Lt:t.parent}detach(){this.parent=null,this.left=null,this.right=null}};var Lt=new ZC(null,0);Lt.parent=Lt;Lt.left=Lt;Lt.right=Lt;Lt.color=0;function TN(r){for(;r.left!==Lt;)r=r.left;return r}function c3(r){for(;r.right!==Lt;)r=r.right;return r}function u3(r){return r===Lt?0:r.size_left+r.piece.length+u3(r.right)}function p3(r){return r===Lt?0:r.lf_left+r.piece.lineFeedCnt+p3(r.right)}function d3(){Lt.parent=Lt}function Ck(r,t){let e=t.right;e.size_left+=t.size_left+(t.piece?t.piece.length:0),e.lf_left+=t.lf_left+(t.piece?t.piece.lineFeedCnt:0),t.right=e.left,e.left!==Lt&&(e.left.parent=t),e.parent=t.parent,t.parent===Lt?r.root=e:t.parent.left===t?t.parent.left=e:t.parent.right=e,e.left=t,t.parent=e}function wk(r,t){let e=t.left;t.left=e.right,e.right!==Lt&&(e.right.parent=t),e.parent=t.parent,t.size_left-=e.size_left+(e.piece?e.piece.length:0),t.lf_left-=e.lf_left+(e.piece?e.piece.lineFeedCnt:0),t.parent===Lt?r.root=e:t===t.parent.right?t.parent.right=e:t.parent.left=e,e.right=t,t.parent=e}function Ek(r,t){let e,i;if(t.left===Lt?(i=t,e=i.right):t.right===Lt?(i=t,e=i.left):(i=TN(t.right),e=i.right),i===r.root){r.root=e,e.color=0,t.detach(),d3(),r.root.parent=Lt;return}let n=i.color===1;if(i===i.parent.left?i.parent.left=e:i.parent.right=e,i===t?(e.parent=i.parent,Sk(r,e)):(i.parent===t?e.parent=i:e.parent=i.parent,Sk(r,e),i.left=t.left,i.right=t.right,i.parent=t.parent,i.color=t.color,t===r.root?r.root=i:t===t.parent.left?t.parent.left=i:t.parent.right=i,i.left!==Lt&&(i.left.parent=i),i.right!==Lt&&(i.right.parent=i),i.size_left=t.size_left,i.lf_left=t.lf_left,Sk(r,i)),t.detach(),e.parent.left===e){let s=u3(e),a=p3(e);if(s!==e.parent.size_left||a!==e.parent.lf_left){let l=s-e.parent.size_left,d=a-e.parent.lf_left;e.parent.size_left=s,e.parent.lf_left=a,Kp(r,e.parent,l,d)}}if(Sk(r,e.parent),n){d3();return}let o;for(;e!==r.root&&e.color===0;)e===e.parent.left?(o=e.parent.right,o.color===1&&(o.color=0,e.parent.color=1,Ck(r,e.parent),o=e.parent.right),o.left.color===0&&o.right.color===0?(o.color=1,e=e.parent):(o.right.color===0&&(o.left.color=0,o.color=1,wk(r,o),o=e.parent.right),o.color=e.parent.color,e.parent.color=0,o.right.color=0,Ck(r,e.parent),e=r.root)):(o=e.parent.left,o.color===1&&(o.color=0,e.parent.color=1,wk(r,e.parent),o=e.parent.left),o.left.color===0&&o.right.color===0?(o.color=1,e=e.parent):(o.left.color===0&&(o.right.color=0,o.color=1,Ck(r,o),o=e.parent.left),o.color=e.parent.color,e.parent.color=0,o.left.color=0,wk(r,e.parent),e=r.root));e.color=0,d3()}function h3(r,t){for(Sk(r,t);t!==r.root&&t.parent.color===1;)if(t.parent===t.parent.parent.left){let e=t.parent.parent.right;e.color===1?(t.parent.color=0,e.color=0,t.parent.parent.color=1,t=t.parent.parent):(t===t.parent.right&&(t=t.parent,Ck(r,t)),t.parent.color=0,t.parent.parent.color=1,wk(r,t.parent.parent))}else{let e=t.parent.parent.left;e.color===1?(t.parent.color=0,e.color=0,t.parent.parent.color=1,t=t.parent.parent):(t===t.parent.left&&(t=t.parent,wk(r,t)),t.parent.color=0,t.parent.parent.color=1,Ck(r,t.parent.parent))}r.root.color=0}function Kp(r,t,e,i){for(;t!==r.root&&t!==Lt;)t.parent.left===t&&(t.parent.size_left+=e,t.parent.lf_left+=i),t=t.parent}function Sk(r,t){let e=0,i=0;if(t!==r.root){for(;t!==r.root&&t===t.parent.right;)t=t.parent;if(t!==r.root)for(t=t.parent,e=u3(t.left)-t.size_left,i=p3(t.left)-t.lf_left,t.size_left+=e,t.lf_left+=i;t!==r.root&&(e!==0||i!==0);)t.parent.left===t&&(t.parent.size_left+=e,t.parent.lf_left+=i),t=t.parent}}var kye=999,Iu=class{searchString;isRegex;matchCase;wordSeparators;constructor(t,e,i,n){this.searchString=t,this.isRegex=e,this.matchCase=i,this.wordSeparators=n}parseSearchRequest(){if(this.searchString==="")return null;let t;this.isRegex?t=Lye(this.searchString):t=this.searchString.indexOf(`
`)>=0;let e=null;try{e=hA(this.searchString,this.isRegex,{matchCase:this.matchCase,wholeWord:!1,multiline:t,global:!0,unicode:!0})}catch{return null}if(!e)return null;let i=!this.isRegex&&!t;return i&&this.searchString.toLowerCase()!==this.searchString.toUpperCase()&&(i=this.matchCase),new p0(e,this.wordSeparators?Ap(this.wordSeparators,[]):null,i?this.searchString:null)}};function Lye(r){if(!r||r.length===0)return!1;for(let t=0,e=r.length;t<e;t++){let i=r.charCodeAt(t);if(i===10)return!0;if(i===92){if(t++,t>=e)break;let n=r.charCodeAt(t);if(n===110||n===114||n===87)return!0}}return!1}function Uf(r,t,e){if(!e)return new Lf(r,null);let i=[];for(let n=0,o=t.length;n<o;n++)i[n]=t[n];return new Lf(r,i)}var _N=class{_lineFeedsOffsets;constructor(t){let e=[],i=0;for(let n=0,o=t.length;n<o;n++)t.charCodeAt(n)===10&&(e[i++]=n);this._lineFeedsOffsets=e}findLineFeedCountBeforeOffset(t){let e=this._lineFeedsOffsets,i=0,n=e.length-1;if(n===-1||t<=e[0])return 0;for(;i<n;){let o=i+((n-i)/2>>0);e[o]>=t?n=o-1:e[o+1]>=t?(i=o,n=o):i=o+1}return i+1}},AI=class{static findMatches(t,e,i,n,o){let s=e.parseSearchRequest();return s?s.regex.multiline?this._doFindMatchesMultiline(t,i,new Wm(s.wordSeparators,s.regex),n,o):this._doFindMatchesLineByLine(t,i,s,n,o):[]}static _getMultilineMatchRange(t,e,i,n,o,s){let a,l=0;n?(l=n.findLineFeedCountBeforeOffset(o),a=e+o+l):a=e+o;let d;if(n){let m=n.findLineFeedCountBeforeOffset(o+s.length)-l;d=a+s.length+m}else d=a+s.length;let c=t.getPositionAt(a),p=t.getPositionAt(d);return new L(c.lineNumber,c.column,p.lineNumber,p.column)}static _doFindMatchesMultiline(t,e,i,n,o){let s=t.getOffsetAt(e.getStartPosition()),a=t.getValueInRange(e,1),l=t.getEOL()===`\r
`?new _N(a):null,d=[],c=0,p;for(i.reset(0);p=i.next(a);)if(d[c++]=Uf(this._getMultilineMatchRange(t,s,a,l,p.index,p[0]),p,n),c>=o)return d;return d}static _doFindMatchesLineByLine(t,e,i,n,o){let s=[],a=0;if(e.startLineNumber===e.endLineNumber){let d=t.getLineContent(e.startLineNumber).substring(e.startColumn-1,e.endColumn-1);return a=this._findMatchesInLine(i,d,e.startLineNumber,e.startColumn-1,a,s,n,o),s}let l=t.getLineContent(e.startLineNumber).substring(e.startColumn-1);a=this._findMatchesInLine(i,l,e.startLineNumber,e.startColumn-1,a,s,n,o);for(let d=e.startLineNumber+1;d<e.endLineNumber&&a<o;d++)a=this._findMatchesInLine(i,t.getLineContent(d),d,0,a,s,n,o);if(a<o){let d=t.getLineContent(e.endLineNumber).substring(0,e.endColumn-1);a=this._findMatchesInLine(i,d,e.endLineNumber,0,a,s,n,o)}return s}static _findMatchesInLine(t,e,i,n,o,s,a,l){let d=t.wordSeparators;if(!a&&t.simpleSearch){let h=t.simpleSearch,m=h.length,f=e.length,g=-m;for(;(g=e.indexOf(h,g+m))!==-1;)if((!d||DN(d,e,f,g,m))&&(s[o++]=new Lf(new L(i,g+1+n,i,g+1+m+n),null),o>=l))return o;return o}let c=new Wm(t.wordSeparators,t.regex),p;c.reset(0);do if(p=c.next(e),p&&(s[o++]=Uf(new L(i,p.index+1+n,i,p.index+1+p[0].length+n),p,a),o>=l))return o;while(p);return o}static findNextMatch(t,e,i,n){let o=e.parseSearchRequest();if(!o)return null;let s=new Wm(o.wordSeparators,o.regex);return o.regex.multiline?this._doFindNextMatchMultiline(t,i,s,n):this._doFindNextMatchLineByLine(t,i,s,n)}static _doFindNextMatchMultiline(t,e,i,n){let o=new H(e.lineNumber,1),s=t.getOffsetAt(o),a=t.getLineCount(),l=t.getValueInRange(new L(o.lineNumber,o.column,a,t.getLineMaxColumn(a)),1),d=t.getEOL()===`\r
`?new _N(l):null;i.reset(e.column-1);let c=i.next(l);return c?Uf(this._getMultilineMatchRange(t,s,l,d,c.index,c[0]),c,n):e.lineNumber!==1||e.column!==1?this._doFindNextMatchMultiline(t,new H(1,1),i,n):null}static _doFindNextMatchLineByLine(t,e,i,n){let o=t.getLineCount(),s=e.lineNumber,a=t.getLineContent(s),l=this._findFirstMatchInLine(i,a,s,e.column,n);if(l)return l;for(let d=1;d<=o;d++){let c=(s+d-1)%o,p=t.getLineContent(c+1),h=this._findFirstMatchInLine(i,p,c+1,1,n);if(h)return h}return null}static _findFirstMatchInLine(t,e,i,n,o){t.reset(n-1);let s=t.next(e);return s?Uf(new L(i,s.index+1,i,s.index+1+s[0].length),s,o):null}static findPreviousMatch(t,e,i,n){let o=e.parseSearchRequest();if(!o)return null;let s=new Wm(o.wordSeparators,o.regex);return o.regex.multiline?this._doFindPreviousMatchMultiline(t,i,s,n):this._doFindPreviousMatchLineByLine(t,i,s,n)}static _doFindPreviousMatchMultiline(t,e,i,n){let o=this._doFindMatchesMultiline(t,new L(1,1,e.lineNumber,e.column),i,n,10*kye);if(o.length>0)return o[o.length-1];let s=t.getLineCount();return e.lineNumber!==s||e.column!==t.getLineMaxColumn(s)?this._doFindPreviousMatchMultiline(t,new H(s,t.getLineMaxColumn(s)),i,n):null}static _doFindPreviousMatchLineByLine(t,e,i,n){let o=t.getLineCount(),s=e.lineNumber,a=t.getLineContent(s).substring(0,e.column-1),l=this._findLastMatchInLine(i,a,s,n);if(l)return l;for(let d=1;d<=o;d++){let c=(o+s-d-1)%o,p=t.getLineContent(c+1),h=this._findLastMatchInLine(i,p,c+1,n);if(h)return h}return null}static _findLastMatchInLine(t,e,i,n){let o=null,s;for(t.reset(0);s=t.next(e);)o=Uf(new L(i,s.index+1,i,s.index+1+s[0].length),s,n);return o}};function Rye(r,t,e,i,n){if(i===0)return!0;let o=t.charCodeAt(i-1);if(r.get(o)!==0||o===13||o===10)return!0;if(n>0){let s=t.charCodeAt(i);if(r.get(s)!==0)return!0}return!1}function Pye(r,t,e,i,n){if(i+n===e)return!0;let o=t.charCodeAt(i+n);if(r.get(o)!==0||o===13||o===10)return!0;if(n>0){let s=t.charCodeAt(i+n-1);if(r.get(s)!==0)return!0}return!1}function DN(r,t,e,i,n){return Rye(r,t,e,i,n)&&Pye(r,t,e,i,n)}var Wm=class{_wordSeparators;_searchRegex;_prevMatchStartIndex;_prevMatchLength;constructor(t,e){this._wordSeparators=t,this._searchRegex=e,this._prevMatchStartIndex=-1,this._prevMatchLength=0}reset(t){this._searchRegex.lastIndex=t,this._prevMatchStartIndex=-1,this._prevMatchLength=0}next(t){let e=t.length,i;do{if(this._prevMatchStartIndex+this._prevMatchLength===e||(i=this._searchRegex.exec(t),!i))return null;let n=i.index,o=i[0].length;if(n===this._prevMatchStartIndex&&o===this._prevMatchLength){if(o===0){BS(t,e,this._searchRegex.lastIndex)>65535?this._searchRegex.lastIndex+=2:this._searchRegex.lastIndex+=1;continue}return null}if(this._prevMatchStartIndex=n,this._prevMatchLength=o,!this._wordSeparators||DN(this._wordSeparators,t,e,n,o))return i}while(i);return null}};var Hm=65535;function hse(r){let t;return r[r.length-1]<65536?t=new Uint16Array(r.length):t=new Uint32Array(r.length),t.set(r,0),t}var g3=class{constructor(t,e,i,n,o){this.lineStarts=t;this.cr=e;this.lf=i;this.crlf=n;this.isBasicASCII=o}};function Gp(r,t=!0){let e=[0],i=1;for(let n=0,o=r.length;n<o;n++){let s=r.charCodeAt(n);s===13?n+1<o&&r.charCodeAt(n+1)===10?(e[i++]=n+2,n++):e[i++]=n+1:s===10&&(e[i++]=n+1)}return t?hse(e):e}function mse(r,t){r.length=0,r[0]=0;let e=1,i=0,n=0,o=0,s=!0;for(let l=0,d=t.length;l<d;l++){let c=t.charCodeAt(l);c===13?l+1<d&&t.charCodeAt(l+1)===10?(o++,r[e++]=l+2,l++):(i++,r[e++]=l+1):c===10?(n++,r[e++]=l+1):s&&c!==9&&(c<32||c>126)&&(s=!1)}let a=new g3(hse(r),i,n,o,s);return r.length=0,a}var ra=class{bufferIndex;start;end;length;lineFeedCnt;constructor(t,e,i,n,o){this.bufferIndex=t,this.start=e,this.end=i,this.lineFeedCnt=n,this.length=o}},qp=class{buffer;lineStarts;constructor(t,e){this.buffer=t,this.lineStarts=e}},f3=class{_pieces;_index;_tree;_BOM;constructor(t,e){this._pieces=[],this._tree=t,this._BOM=e,this._index=0,t.root!==Lt&&t.iterate(t.root,i=>(i!==Lt&&this._pieces.push(i.piece),!0))}read(){return this._pieces.length===0?this._index===0?(this._index++,this._BOM):null:this._index>this._pieces.length-1?null:this._index===0?this._BOM+this._tree.getPieceContent(this._pieces[this._index++]):this._tree.getPieceContent(this._pieces[this._index++])}},b3=class{_limit;_cache;constructor(t){this._limit=t,this._cache=[]}get(t){for(let e=this._cache.length-1;e>=0;e--){let i=this._cache[e];if(i.nodeStartOffset<=t&&i.nodeStartOffset+i.node.piece.length>=t)return i}return null}get2(t){for(let e=this._cache.length-1;e>=0;e--){let i=this._cache[e];if(i.nodeStartLineNumber&&i.nodeStartLineNumber<t&&i.nodeStartLineNumber+i.node.piece.lineFeedCnt>=t)return i}return null}set(t){this._cache.length>=this._limit&&this._cache.shift(),this._cache.push(t)}validate(t){let e=!1,i=this._cache;for(let n=0;n<i.length;n++){let o=i[n];if(o.node.parent===null||o.nodeStartOffset>=t){i[n]=null,e=!0;continue}}if(e){let n=[];for(let o of i)o!==null&&n.push(o);this._cache=n}}},kN=class{root;_buffers;_lineCnt;_length;_EOL;_EOLLength;_EOLNormalized;_lastChangeBufferPos;_searchCache;_lastVisitedLine;constructor(t,e,i){this.create(t,e,i)}create(t,e,i){this._buffers=[new qp("",[0])],this._lastChangeBufferPos={line:0,column:0},this.root=Lt,this._lineCnt=1,this._length=0,this._EOL=e,this._EOLLength=e.length,this._EOLNormalized=i;let n=null;for(let o=0,s=t.length;o<s;o++)if(t[o].buffer.length>0){t[o].lineStarts||(t[o].lineStarts=Gp(t[o].buffer));let a=new ra(o+1,{line:0,column:0},{line:t[o].lineStarts.length-1,column:t[o].buffer.length-t[o].lineStarts[t[o].lineStarts.length-1]},t[o].lineStarts.length-1,t[o].buffer.length);this._buffers.push(t[o]),n=this.rbInsertRight(n,a)}this._searchCache=new b3(1),this._lastVisitedLine={lineNumber:0,value:""},this.computeBufferMetadata()}normalizeEOL(t){let e=Hm,i=e-Math.floor(e/3),n=i*2,o="",s=0,a=[];if(this.iterate(this.root,l=>{let d=this.getNodeContent(l),c=d.length;if(s<=i||s+c<n)return o+=d,s+=c,!0;let p=o.replace(/\r\n|\r|\n/g,t);return a.push(new qp(p,Gp(p))),o=d,s=c,!0}),s>0){let l=o.replace(/\r\n|\r|\n/g,t);a.push(new qp(l,Gp(l)))}this.create(a,t,!0)}getEOL(){return this._EOL}setEOL(t){this._EOL=t,this._EOLLength=this._EOL.length,this.normalizeEOL(t)}createSnapshot(t){return new f3(this,t)}equal(t){if(this.getLength()!==t.getLength()||this.getLineCount()!==t.getLineCount())return!1;let e=0;return this.iterate(this.root,n=>{if(n===Lt)return!0;let o=this.getNodeContent(n),s=o.length,a=t.nodeAt(e),l=t.nodeAt(e+s),d=t.getValueInRange2(a,l);return e+=s,o===d})}getOffsetAt(t,e){let i=0,n=this.root;for(;n!==Lt;)if(n.left!==Lt&&n.lf_left+1>=t)n=n.left;else if(n.lf_left+n.piece.lineFeedCnt+1>=t){i+=n.size_left;let o=this.getAccumulatedValue(n,t-n.lf_left-2);return i+=o+e-1}else t-=n.lf_left+n.piece.lineFeedCnt,i+=n.size_left+n.piece.length,n=n.right;return i}getPositionAt(t){t=Math.floor(t),t=Math.max(0,t);let e=this.root,i=0,n=t;for(;e!==Lt;)if(e.size_left!==0&&e.size_left>=t)e=e.left;else if(e.size_left+e.piece.length>=t){let o=this.getIndexOf(e,t-e.size_left);if(i+=e.lf_left+o.index,o.index===0){let s=this.getOffsetAt(i+1,1),a=n-s;return new H(i+1,a+1)}return new H(i+1,o.remainder+1)}else if(t-=e.size_left+e.piece.length,i+=e.lf_left+e.piece.lineFeedCnt,e.right===Lt){let o=this.getOffsetAt(i+1,1),s=n-t-o;return new H(i+1,s+1)}else e=e.right;return new H(1,1)}getValueInRange(t,e){if(t.startLineNumber===t.endLineNumber&&t.startColumn===t.endColumn)return"";let i=this.nodeAt2(t.startLineNumber,t.startColumn),n=this.nodeAt2(t.endLineNumber,t.endColumn),o=this.getValueInRange2(i,n);return e?e!==this._EOL||!this._EOLNormalized?o.replace(/\r\n|\r|\n/g,e):e===this.getEOL()&&this._EOLNormalized?o:o.replace(/\r\n|\r|\n/g,e):o}getValueInRange2(t,e){if(t.node===e.node){let a=t.node,l=this._buffers[a.piece.bufferIndex].buffer,d=this.offsetInBuffer(a.piece.bufferIndex,a.piece.start);return l.substring(d+t.remainder,d+e.remainder)}let i=t.node,n=this._buffers[i.piece.bufferIndex].buffer,o=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start),s=n.substring(o+t.remainder,o+i.piece.length);for(i=i.next();i!==Lt;){let a=this._buffers[i.piece.bufferIndex].buffer,l=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);if(i===e.node){s+=a.substring(l,l+e.remainder);break}else s+=a.substr(l,i.piece.length);i=i.next()}return s}getLinesContent(){let t=[],e=0,i="",n=!1;return this.iterate(this.root,o=>{if(o===Lt)return!0;let s=o.piece,a=s.length;if(a===0)return!0;let l=this._buffers[s.bufferIndex].buffer,d=this._buffers[s.bufferIndex].lineStarts,c=s.start.line,p=s.end.line,h=d[c]+s.start.column;if(n&&(l.charCodeAt(h)===10&&(h++,a--),t[e++]=i,i="",n=!1,a===0))return!0;if(c===p)return!this._EOLNormalized&&l.charCodeAt(h+a-1)===13?(n=!0,i+=l.substr(h,a-1)):i+=l.substr(h,a),!0;i+=this._EOLNormalized?l.substring(h,Math.max(h,d[c+1]-this._EOLLength)):l.substring(h,d[c+1]).replace(/(\r\n|\r|\n)$/,""),t[e++]=i;for(let m=c+1;m<p;m++)i=this._EOLNormalized?l.substring(d[m],d[m+1]-this._EOLLength):l.substring(d[m],d[m+1]).replace(/(\r\n|\r|\n)$/,""),t[e++]=i;return!this._EOLNormalized&&l.charCodeAt(d[p]+s.end.column-1)===13?(n=!0,s.end.column===0?e--:i=l.substr(d[p],s.end.column-1)):i=l.substr(d[p],s.end.column),!0}),n&&(t[e++]=i,i=""),t[e++]=i,t}getLength(){return this._length}getLineCount(){return this._lineCnt}getLineContent(t){return this._lastVisitedLine.lineNumber===t?this._lastVisitedLine.value:(this._lastVisitedLine.lineNumber=t,t===this._lineCnt?this._lastVisitedLine.value=this.getLineRawContent(t):this._EOLNormalized?this._lastVisitedLine.value=this.getLineRawContent(t,this._EOLLength):this._lastVisitedLine.value=this.getLineRawContent(t).replace(/(\r\n|\r|\n)$/,""),this._lastVisitedLine.value)}_getCharCode(t){if(t.remainder===t.node.piece.length){let e=t.node.next();if(!e)return 0;let i=this._buffers[e.piece.bufferIndex],n=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start);return i.buffer.charCodeAt(n)}else{let e=this._buffers[t.node.piece.bufferIndex],n=this.offsetInBuffer(t.node.piece.bufferIndex,t.node.piece.start)+t.remainder;return e.buffer.charCodeAt(n)}}getLineCharCode(t,e){let i=this.nodeAt2(t,e+1);return this._getCharCode(i)}getLineLength(t){if(t===this.getLineCount()){let e=this.getOffsetAt(t,1);return this.getLength()-e}return this.getOffsetAt(t+1,1)-this.getOffsetAt(t,1)-this._EOLLength}getCharCode(t){let e=this.nodeAt(t);return this._getCharCode(e)}getNearestChunk(t){let e=this.nodeAt(t);if(e.remainder===e.node.piece.length){let i=e.node.next();if(!i||i===Lt)return"";let n=this._buffers[i.piece.bufferIndex],o=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);return n.buffer.substring(o,o+i.piece.length)}else{let i=this._buffers[e.node.piece.bufferIndex],n=this.offsetInBuffer(e.node.piece.bufferIndex,e.node.piece.start),o=n+e.remainder,s=n+e.node.piece.length;return i.buffer.substring(o,s)}}findMatchesInNode(t,e,i,n,o,s,a,l,d,c,p){let h=this._buffers[t.piece.bufferIndex],m=this.offsetInBuffer(t.piece.bufferIndex,t.piece.start),f=this.offsetInBuffer(t.piece.bufferIndex,o),g=this.offsetInBuffer(t.piece.bufferIndex,s),v,I={line:0,column:0},y,w;e._wordSeparators?(y=h.buffer.substring(f,g),w=C=>C+f,e.reset(0)):(y=h.buffer,w=C=>C,e.reset(f));do if(v=e.next(y),v){if(w(v.index)>=g)return c;this.positionInBuffer(t,w(v.index)-m,I);let C=this.getLineFeedCnt(t.piece.bufferIndex,o,I),S=I.line===o.line?I.column-o.column+n:I.column+1,D=S+v[0].length;if(p[c++]=Uf(new L(i+C,S,i+C,D),v,l),w(v.index)+v[0].length>=g||c>=d)return c}while(v);return c}findMatchesLineByLine(t,e,i,n){let o=[],s=0,a=new Wm(e.wordSeparators,e.regex),l=this.nodeAt2(t.startLineNumber,t.startColumn);if(l===null)return[];let d=this.nodeAt2(t.endLineNumber,t.endColumn);if(d===null)return[];let c=this.positionInBuffer(l.node,l.remainder),p=this.positionInBuffer(d.node,d.remainder);if(l.node===d.node)return this.findMatchesInNode(l.node,a,t.startLineNumber,t.startColumn,c,p,e,i,n,s,o),o;let h=t.startLineNumber,m=l.node;for(;m!==d.node;){let g=this.getLineFeedCnt(m.piece.bufferIndex,c,m.piece.end);if(g>=1){let I=this._buffers[m.piece.bufferIndex].lineStarts,y=this.offsetInBuffer(m.piece.bufferIndex,m.piece.start),w=I[c.line+g],C=h===t.startLineNumber?t.startColumn:1;if(s=this.findMatchesInNode(m,a,h,C,c,this.positionInBuffer(m,w-y),e,i,n,s,o),s>=n)return o;h+=g}let v=h===t.startLineNumber?t.startColumn-1:0;if(h===t.endLineNumber){let I=this.getLineContent(h).substring(v,t.endColumn-1);return s=this._findMatchesInLine(e,a,I,t.endLineNumber,v,s,o,i,n),o}if(s=this._findMatchesInLine(e,a,this.getLineContent(h).substr(v),h,v,s,o,i,n),s>=n)return o;h++,l=this.nodeAt2(h,1),m=l.node,c=this.positionInBuffer(l.node,l.remainder)}if(h===t.endLineNumber){let g=h===t.startLineNumber?t.startColumn-1:0,v=this.getLineContent(h).substring(g,t.endColumn-1);return s=this._findMatchesInLine(e,a,v,t.endLineNumber,g,s,o,i,n),o}let f=h===t.startLineNumber?t.startColumn:1;return s=this.findMatchesInNode(d.node,a,h,f,c,p,e,i,n,s,o),o}_findMatchesInLine(t,e,i,n,o,s,a,l,d){let c=t.wordSeparators;if(!l&&t.simpleSearch){let h=t.simpleSearch,m=h.length,f=i.length,g=-m;for(;(g=i.indexOf(h,g+m))!==-1;)if((!c||DN(c,i,f,g,m))&&(a[s++]=new Lf(new L(n,g+1+o,n,g+1+m+o),null),s>=d))return s;return s}let p;e.reset(0);do if(p=e.next(i),p&&(a[s++]=Uf(new L(n,p.index+1+o,n,p.index+1+p[0].length+o),p,l),s>=d))return s;while(p);return s}insert(t,e,i=!1){if(this._EOLNormalized=this._EOLNormalized&&i,this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",this.root!==Lt){let{node:n,remainder:o,nodeStartOffset:s}=this.nodeAt(t),a=n.piece,l=a.bufferIndex,d=this.positionInBuffer(n,o);if(n.piece.bufferIndex===0&&a.end.line===this._lastChangeBufferPos.line&&a.end.column===this._lastChangeBufferPos.column&&s+a.length===t&&e.length<Hm){this.appendToNode(n,e),this.computeBufferMetadata();return}if(s===t)this.insertContentToNodeLeft(e,n),this._searchCache.validate(t);else if(s+n.piece.length>t){let c=[],p=new ra(a.bufferIndex,d,a.end,this.getLineFeedCnt(a.bufferIndex,d,a.end),this.offsetInBuffer(l,a.end)-this.offsetInBuffer(l,d));if(this.shouldCheckCRLF()&&this.endWithCR(e)&&this.nodeCharCodeAt(n,o)===10){let g={line:p.start.line+1,column:0};p=new ra(p.bufferIndex,g,p.end,this.getLineFeedCnt(p.bufferIndex,g,p.end),p.length-1),e+=`
`}if(this.shouldCheckCRLF()&&this.startWithLF(e))if(this.nodeCharCodeAt(n,o-1)===13){let g=this.positionInBuffer(n,o-1);this.deleteNodeTail(n,g),e="\r"+e,n.piece.length===0&&c.push(n)}else this.deleteNodeTail(n,d);else this.deleteNodeTail(n,d);let h=this.createNewPieces(e);p.length>0&&this.rbInsertRight(n,p);let m=n;for(let f=0;f<h.length;f++)m=this.rbInsertRight(m,h[f]);this.deleteNodes(c)}else this.insertContentToNodeRight(e,n)}else{let n=this.createNewPieces(e),o=this.rbInsertLeft(null,n[0]);for(let s=1;s<n.length;s++)o=this.rbInsertRight(o,n[s])}this.computeBufferMetadata()}delete(t,e){if(this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",e<=0||this.root===Lt)return;let i=this.nodeAt(t),n=this.nodeAt(t+e),o=i.node,s=n.node;if(o===s){let h=this.positionInBuffer(o,i.remainder),m=this.positionInBuffer(o,n.remainder);if(i.nodeStartOffset===t){if(e===o.piece.length){let f=o.next();Ek(this,o),this.validateCRLFWithPrevNode(f),this.computeBufferMetadata();return}this.deleteNodeHead(o,m),this._searchCache.validate(t),this.validateCRLFWithPrevNode(o),this.computeBufferMetadata();return}if(i.nodeStartOffset+o.piece.length===t+e){this.deleteNodeTail(o,h),this.validateCRLFWithNextNode(o),this.computeBufferMetadata();return}this.shrinkNode(o,h,m),this.computeBufferMetadata();return}let a=[],l=this.positionInBuffer(o,i.remainder);this.deleteNodeTail(o,l),this._searchCache.validate(t),o.piece.length===0&&a.push(o);let d=this.positionInBuffer(s,n.remainder);this.deleteNodeHead(s,d),s.piece.length===0&&a.push(s);let c=o.next();for(let h=c;h!==Lt&&h!==s;h=h.next())a.push(h);let p=o.piece.length===0?o.prev():o;this.deleteNodes(a),this.validateCRLFWithNextNode(p),this.computeBufferMetadata()}insertContentToNodeLeft(t,e){let i=[];if(this.shouldCheckCRLF()&&this.endWithCR(t)&&this.startWithLF(e)){let s=e.piece,a={line:s.start.line+1,column:0},l=new ra(s.bufferIndex,a,s.end,this.getLineFeedCnt(s.bufferIndex,a,s.end),s.length-1);e.piece=l,t+=`
`,Kp(this,e,-1,-1),e.piece.length===0&&i.push(e)}let n=this.createNewPieces(t),o=this.rbInsertLeft(e,n[n.length-1]);for(let s=n.length-2;s>=0;s--)o=this.rbInsertLeft(o,n[s]);this.validateCRLFWithPrevNode(o),this.deleteNodes(i)}insertContentToNodeRight(t,e){this.adjustCarriageReturnFromNext(t,e)&&(t+=`
`);let i=this.createNewPieces(t),n=this.rbInsertRight(e,i[0]),o=n;for(let s=1;s<i.length;s++)o=this.rbInsertRight(o,i[s]);this.validateCRLFWithPrevNode(n)}positionInBuffer(t,e,i){let n=t.piece,o=t.piece.bufferIndex,s=this._buffers[o].lineStarts,l=s[n.start.line]+n.start.column+e,d=n.start.line,c=n.end.line,p=0,h=0,m=0;for(;d<=c&&(p=d+(c-d)/2|0,m=s[p],p!==c);)if(h=s[p+1],l<m)c=p-1;else if(l>=h)d=p+1;else break;return i?(i.line=p,i.column=l-m,null):{line:p,column:l-m}}getLineFeedCnt(t,e,i){if(i.column===0)return i.line-e.line;let n=this._buffers[t].lineStarts;if(i.line===n.length-1)return i.line-e.line;let o=n[i.line+1],s=n[i.line]+i.column;if(o>s+1)return i.line-e.line;let a=s-1;return this._buffers[t].buffer.charCodeAt(a)===13?i.line-e.line+1:i.line-e.line}offsetInBuffer(t,e){return this._buffers[t].lineStarts[e.line]+e.column}deleteNodes(t){for(let e=0;e<t.length;e++)Ek(this,t[e])}createNewPieces(t){if(t.length>Hm){let c=[];for(;t.length>Hm;){let h=t.charCodeAt(Hm-1),m;h===13||h>=55296&&h<=56319?(m=t.substring(0,Hm-1),t=t.substring(Hm-1)):(m=t.substring(0,Hm),t=t.substring(Hm));let f=Gp(m);c.push(new ra(this._buffers.length,{line:0,column:0},{line:f.length-1,column:m.length-f[f.length-1]},f.length-1,m.length)),this._buffers.push(new qp(m,f))}let p=Gp(t);return c.push(new ra(this._buffers.length,{line:0,column:0},{line:p.length-1,column:t.length-p[p.length-1]},p.length-1,t.length)),this._buffers.push(new qp(t,p)),c}let e=this._buffers[0].buffer.length,i=Gp(t,!1),n=this._lastChangeBufferPos;if(this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-1]===e&&e!==0&&this.startWithLF(t)&&this.endWithCR(this._buffers[0].buffer)){this._lastChangeBufferPos={line:this._lastChangeBufferPos.line,column:this._lastChangeBufferPos.column+1},n=this._lastChangeBufferPos;for(let c=0;c<i.length;c++)i[c]+=e+1;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(i.slice(1)),this._buffers[0].buffer+="_"+t,e+=1}else{if(e!==0)for(let c=0;c<i.length;c++)i[c]+=e;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(i.slice(1)),this._buffers[0].buffer+=t}let o=this._buffers[0].buffer.length,s=this._buffers[0].lineStarts.length-1,a=o-this._buffers[0].lineStarts[s],l={line:s,column:a},d=new ra(0,n,l,this.getLineFeedCnt(0,n,l),o-e);return this._lastChangeBufferPos=l,[d]}getLinesRawContent(){return this.getContentOfSubTree(this.root)}getLineRawContent(t,e=0){let i=this.root,n="",o=this._searchCache.get2(t);if(o){i=o.node;let s=this.getAccumulatedValue(i,t-o.nodeStartLineNumber-1),a=this._buffers[i.piece.bufferIndex].buffer,l=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);if(o.nodeStartLineNumber+i.piece.lineFeedCnt===t)n=a.substring(l+s,l+i.piece.length);else{let d=this.getAccumulatedValue(i,t-o.nodeStartLineNumber);return a.substring(l+s,l+d-e)}}else{let s=0,a=t;for(;i!==Lt;)if(i.left!==Lt&&i.lf_left>=t-1)i=i.left;else if(i.lf_left+i.piece.lineFeedCnt>t-1){let l=this.getAccumulatedValue(i,t-i.lf_left-2),d=this.getAccumulatedValue(i,t-i.lf_left-1),c=this._buffers[i.piece.bufferIndex].buffer,p=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);return s+=i.size_left,this._searchCache.set({node:i,nodeStartOffset:s,nodeStartLineNumber:a-(t-1-i.lf_left)}),c.substring(p+l,p+d-e)}else if(i.lf_left+i.piece.lineFeedCnt===t-1){let l=this.getAccumulatedValue(i,t-i.lf_left-2),d=this._buffers[i.piece.bufferIndex].buffer,c=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);n=d.substring(c+l,c+i.piece.length);break}else t-=i.lf_left+i.piece.lineFeedCnt,s+=i.size_left+i.piece.length,i=i.right}for(i=i.next();i!==Lt;){let s=this._buffers[i.piece.bufferIndex].buffer;if(i.piece.lineFeedCnt>0){let a=this.getAccumulatedValue(i,0),l=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);return n+=s.substring(l,l+a-e),n}else{let a=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);n+=s.substr(a,i.piece.length)}i=i.next()}return n}computeBufferMetadata(){let t=this.root,e=1,i=0;for(;t!==Lt;)e+=t.lf_left+t.piece.lineFeedCnt,i+=t.size_left+t.piece.length,t=t.right;this._lineCnt=e,this._length=i,this._searchCache.validate(this._length)}getIndexOf(t,e){let i=t.piece,n=this.positionInBuffer(t,e),o=n.line-i.start.line;if(this.offsetInBuffer(i.bufferIndex,i.end)-this.offsetInBuffer(i.bufferIndex,i.start)===e){let s=this.getLineFeedCnt(t.piece.bufferIndex,i.start,n);if(s!==o)return{index:s,remainder:0}}return{index:o,remainder:n.column}}getAccumulatedValue(t,e){if(e<0)return 0;let i=t.piece,n=this._buffers[i.bufferIndex].lineStarts,o=i.start.line+e+1;return o>i.end.line?n[i.end.line]+i.end.column-n[i.start.line]-i.start.column:n[o]-n[i.start.line]-i.start.column}deleteNodeTail(t,e){let i=t.piece,n=i.lineFeedCnt,o=this.offsetInBuffer(i.bufferIndex,i.end),s=e,a=this.offsetInBuffer(i.bufferIndex,s),l=this.getLineFeedCnt(i.bufferIndex,i.start,s),d=l-n,c=a-o,p=i.length+c;t.piece=new ra(i.bufferIndex,i.start,s,l,p),Kp(this,t,c,d)}deleteNodeHead(t,e){let i=t.piece,n=i.lineFeedCnt,o=this.offsetInBuffer(i.bufferIndex,i.start),s=e,a=this.getLineFeedCnt(i.bufferIndex,s,i.end),l=this.offsetInBuffer(i.bufferIndex,s),d=a-n,c=o-l,p=i.length+c;t.piece=new ra(i.bufferIndex,s,i.end,a,p),Kp(this,t,c,d)}shrinkNode(t,e,i){let n=t.piece,o=n.start,s=n.end,a=n.length,l=n.lineFeedCnt,d=e,c=this.getLineFeedCnt(n.bufferIndex,n.start,d),p=this.offsetInBuffer(n.bufferIndex,e)-this.offsetInBuffer(n.bufferIndex,o);t.piece=new ra(n.bufferIndex,n.start,d,c,p),Kp(this,t,p-a,c-l);let h=new ra(n.bufferIndex,i,s,this.getLineFeedCnt(n.bufferIndex,i,s),this.offsetInBuffer(n.bufferIndex,s)-this.offsetInBuffer(n.bufferIndex,i)),m=this.rbInsertRight(t,h);this.validateCRLFWithPrevNode(m)}appendToNode(t,e){this.adjustCarriageReturnFromNext(e,t)&&(e+=`
`);let i=this.shouldCheckCRLF()&&this.startWithLF(e)&&this.endWithCR(t),n=this._buffers[0].buffer.length;this._buffers[0].buffer+=e;let o=Gp(e,!1);for(let m=0;m<o.length;m++)o[m]+=n;if(i){let m=this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-2];this._buffers[0].lineStarts.pop(),this._lastChangeBufferPos={line:this._lastChangeBufferPos.line-1,column:n-m}}this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(o.slice(1));let s=this._buffers[0].lineStarts.length-1,a=this._buffers[0].buffer.length-this._buffers[0].lineStarts[s],l={line:s,column:a},d=t.piece.length+e.length,c=t.piece.lineFeedCnt,p=this.getLineFeedCnt(0,t.piece.start,l),h=p-c;t.piece=new ra(t.piece.bufferIndex,t.piece.start,l,p,d),this._lastChangeBufferPos=l,Kp(this,t,e.length,h)}nodeAt(t){let e=this.root,i=this._searchCache.get(t);if(i)return{node:i.node,nodeStartOffset:i.nodeStartOffset,remainder:t-i.nodeStartOffset};let n=0;for(;e!==Lt;)if(e.size_left>t)e=e.left;else if(e.size_left+e.piece.length>=t){n+=e.size_left;let o={node:e,remainder:t-e.size_left,nodeStartOffset:n};return this._searchCache.set(o),o}else t-=e.size_left+e.piece.length,n+=e.size_left+e.piece.length,e=e.right;return null}nodeAt2(t,e){let i=this.root,n=0;for(;i!==Lt;)if(i.left!==Lt&&i.lf_left>=t-1)i=i.left;else if(i.lf_left+i.piece.lineFeedCnt>t-1){let o=this.getAccumulatedValue(i,t-i.lf_left-2),s=this.getAccumulatedValue(i,t-i.lf_left-1);return n+=i.size_left,{node:i,remainder:Math.min(o+e-1,s),nodeStartOffset:n}}else if(i.lf_left+i.piece.lineFeedCnt===t-1){let o=this.getAccumulatedValue(i,t-i.lf_left-2);if(o+e-1<=i.piece.length)return{node:i,remainder:o+e-1,nodeStartOffset:n};e-=i.piece.length-o;break}else t-=i.lf_left+i.piece.lineFeedCnt,n+=i.size_left+i.piece.length,i=i.right;for(i=i.next();i!==Lt;){if(i.piece.lineFeedCnt>0){let o=this.getAccumulatedValue(i,0),s=this.offsetOfNode(i);return{node:i,remainder:Math.min(e-1,o),nodeStartOffset:s}}else if(i.piece.length>=e-1){let o=this.offsetOfNode(i);return{node:i,remainder:e-1,nodeStartOffset:o}}else e-=i.piece.length;i=i.next()}return null}nodeCharCodeAt(t,e){if(t.piece.lineFeedCnt<1)return-1;let i=this._buffers[t.piece.bufferIndex],n=this.offsetInBuffer(t.piece.bufferIndex,t.piece.start)+e;return i.buffer.charCodeAt(n)}offsetOfNode(t){if(!t)return 0;let e=t.size_left;for(;t!==this.root;)t.parent.right===t&&(e+=t.parent.size_left+t.parent.piece.length),t=t.parent;return e}shouldCheckCRLF(){return!(this._EOLNormalized&&this._EOL===`
`)}startWithLF(t){if(typeof t=="string")return t.charCodeAt(0)===10;if(t===Lt||t.piece.lineFeedCnt===0)return!1;let e=t.piece,i=this._buffers[e.bufferIndex].lineStarts,n=e.start.line,o=i[n]+e.start.column;return n===i.length-1||i[n+1]>o+1?!1:this._buffers[e.bufferIndex].buffer.charCodeAt(o)===10}endWithCR(t){return typeof t=="string"?t.charCodeAt(t.length-1)===13:t===Lt||t.piece.lineFeedCnt===0?!1:this.nodeCharCodeAt(t,t.piece.length-1)===13}validateCRLFWithPrevNode(t){if(this.shouldCheckCRLF()&&this.startWithLF(t)){let e=t.prev();this.endWithCR(e)&&this.fixCRLF(e,t)}}validateCRLFWithNextNode(t){if(this.shouldCheckCRLF()&&this.endWithCR(t)){let e=t.next();this.startWithLF(e)&&this.fixCRLF(t,e)}}fixCRLF(t,e){let i=[],n=this._buffers[t.piece.bufferIndex].lineStarts,o;t.piece.end.column===0?o={line:t.piece.end.line-1,column:n[t.piece.end.line]-n[t.piece.end.line-1]-1}:o={line:t.piece.end.line,column:t.piece.end.column-1};let s=t.piece.length-1,a=t.piece.lineFeedCnt-1;t.piece=new ra(t.piece.bufferIndex,t.piece.start,o,a,s),Kp(this,t,-1,-1),t.piece.length===0&&i.push(t);let l={line:e.piece.start.line+1,column:0},d=e.piece.length-1,c=this.getLineFeedCnt(e.piece.bufferIndex,l,e.piece.end);e.piece=new ra(e.piece.bufferIndex,l,e.piece.end,c,d),Kp(this,e,-1,-1),e.piece.length===0&&i.push(e);let p=this.createNewPieces(`\r
`);this.rbInsertRight(t,p[0]);for(let h=0;h<i.length;h++)Ek(this,i[h])}adjustCarriageReturnFromNext(t,e){if(this.shouldCheckCRLF()&&this.endWithCR(t)){let i=e.next();if(this.startWithLF(i)){if(t+=`
`,i.piece.length===1)Ek(this,i);else{let n=i.piece,o={line:n.start.line+1,column:0},s=n.length-1,a=this.getLineFeedCnt(n.bufferIndex,o,n.end);i.piece=new ra(n.bufferIndex,o,n.end,a,s),Kp(this,i,-1,-1)}return!0}}return!1}iterate(t,e){if(t===Lt)return e(Lt);let i=this.iterate(t.left,e);return i&&e(t)&&this.iterate(t.right,e)}getNodeContent(t){if(t===Lt)return"";let e=this._buffers[t.piece.bufferIndex],i=t.piece,n=this.offsetInBuffer(i.bufferIndex,i.start),o=this.offsetInBuffer(i.bufferIndex,i.end);return e.buffer.substring(n,o)}getPieceContent(t){let e=this._buffers[t.bufferIndex],i=this.offsetInBuffer(t.bufferIndex,t.start),n=this.offsetInBuffer(t.bufferIndex,t.end);return e.buffer.substring(i,n)}rbInsertRight(t,e){let i=new ZC(e,1);if(i.left=Lt,i.right=Lt,i.parent=Lt,i.size_left=0,i.lf_left=0,this.root===Lt)this.root=i,i.color=0;else if(t.right===Lt)t.right=i,i.parent=t;else{let o=TN(t.right);o.left=i,i.parent=o}return h3(this,i),i}rbInsertLeft(t,e){let i=new ZC(e,1);if(i.left=Lt,i.right=Lt,i.parent=Lt,i.size_left=0,i.lf_left=0,this.root===Lt)this.root=i,i.color=0;else if(t.left===Lt)t.left=i,i.parent=t;else{let n=c3(t.left);n.right=i,i.parent=n}return h3(this,i),i}getContentOfSubTree(t){let e="";return this.iterate(t,i=>(e+=this.getNodeContent(i),!0)),e}};var zf=class r extends R{_pieceTree;_BOM;_mightContainRTL;_mightContainUnusualLineTerminators;_mightContainNonBasicASCII;_onDidChangeContent=this._register(new x);onDidChangeContent=this._onDidChangeContent.event;constructor(t,e,i,n,o,s,a){super(),this._BOM=e,this._mightContainNonBasicASCII=!s,this._mightContainRTL=n,this._mightContainUnusualLineTerminators=o,this._pieceTree=new kN(t,i,a)}equals(t){return!(t instanceof r)||this._BOM!==t._BOM||this.getEOL()!==t.getEOL()?!1:this._pieceTree.equal(t._pieceTree)}mightContainRTL(){return this._mightContainRTL}mightContainUnusualLineTerminators(){return this._mightContainUnusualLineTerminators}resetMightContainUnusualLineTerminators(){this._mightContainUnusualLineTerminators=!1}mightContainNonBasicASCII(){return this._mightContainNonBasicASCII}getBOM(){return this._BOM}getEOL(){return this._pieceTree.getEOL()}createSnapshot(t){return this._pieceTree.createSnapshot(t?this._BOM:"")}getOffsetAt(t,e){return this._pieceTree.getOffsetAt(t,e)}getPositionAt(t){return this._pieceTree.getPositionAt(t)}getRangeAt(t,e){let i=t+e,n=this.getPositionAt(t),o=this.getPositionAt(i);return new L(n.lineNumber,n.column,o.lineNumber,o.column)}getValueInRange(t,e=0){if(t.isEmpty())return"";let i=this._getEndOfLine(e);return this._pieceTree.getValueInRange(t,i)}getValueLengthInRange(t,e=0){if(t.isEmpty())return 0;if(t.startLineNumber===t.endLineNumber)return t.endColumn-t.startColumn;let i=this.getOffsetAt(t.startLineNumber,t.startColumn),n=this.getOffsetAt(t.endLineNumber,t.endColumn),o=0,s=this._getEndOfLine(e),a=this.getEOL();if(s.length!==a.length){let l=s.length-a.length,d=t.endLineNumber-t.startLineNumber;o=l*d}return n-i+o}getCharacterCountInRange(t,e=0){if(this._mightContainNonBasicASCII){let i=0,n=t.startLineNumber,o=t.endLineNumber;for(let s=n;s<=o;s++){let a=this.getLineContent(s),l=s===n?t.startColumn-1:0,d=s===o?t.endColumn-1:a.length;for(let c=l;c<d;c++)Rn(a.charCodeAt(c))?(i=i+1,c=c+1):i=i+1}return i+=this._getEndOfLine(e).length*(o-n),i}return this.getValueLengthInRange(t,e)}getNearestChunk(t){return this._pieceTree.getNearestChunk(t)}getLength(){return this._pieceTree.getLength()}getLineCount(){return this._pieceTree.getLineCount()}getLinesContent(){return this._pieceTree.getLinesContent()}getLineContent(t){return this._pieceTree.getLineContent(t)}getLineCharCode(t,e){return this._pieceTree.getLineCharCode(t,e)}getCharCode(t){return this._pieceTree.getCharCode(t)}getLineLength(t){return this._pieceTree.getLineLength(t)}getLineMinColumn(t){return 1}getLineMaxColumn(t){return this.getLineLength(t)+1}getLineFirstNonWhitespaceColumn(t){let e=Jn(this.getLineContent(t));return e===-1?0:e+1}getLineLastNonWhitespaceColumn(t){let e=fd(this.getLineContent(t));return e===-1?0:e+2}_getEndOfLine(t){switch(t){case 1:return`
`;case 2:return`\r
`;case 0:return this.getEOL();default:throw new Error("Unknown EOL preference")}}setEOL(t){this._pieceTree.setEOL(t)}applyEdits(t,e,i){let n=this._mightContainRTL,o=this._mightContainUnusualLineTerminators,s=this._mightContainNonBasicASCII,a=!0,l=[];for(let g=0;g<t.length;g++){let v=t[g];a&&v._isTracked&&(a=!1);let I=v.range;if(v.text){let D=!0;s||(D=!H_(v.text),s=D),!n&&D&&(n=vm(v.text)),!o&&D&&(o=fA(v.text))}let y="",w=0,C=0,S=0;if(v.text){let D;[w,C,S,D]=nl(v.text);let k=this.getEOL(),M=k===`\r
`?2:1;D===0||D===M?y=v.text:y=v.text.replace(/\r\n|\r|\n/g,k)}l[g]={sortIndex:g,identifier:v.identifier||null,range:I,rangeOffset:this.getOffsetAt(I.startLineNumber,I.startColumn),rangeLength:this.getValueLengthInRange(I),text:y,eolCount:w,firstLineLength:C,lastLineLength:S,forceMoveMarkers:!!v.forceMoveMarkers,isAutoWhitespaceEdit:v.isAutoWhitespaceEdit||!1}}l.sort(r._sortOpsAscending);let d=!1;for(let g=0,v=l.length-1;g<v;g++){let I=l[g].range.getEndPosition(),y=l[g+1].range.getStartPosition();if(y.isBeforeOrEqual(I)){if(y.isBefore(I))throw new Error("Overlapping ranges are not allowed!");d=!0}}a&&(l=this._reduceOperations(l));let c=i||e?r._getInverseEditRanges(l):[],p=[];if(e)for(let g=0;g<l.length;g++){let v=l[g],I=c[g];if(v.isAutoWhitespaceEdit&&v.range.isEmpty())for(let y=I.startLineNumber;y<=I.endLineNumber;y++){let w="";y===I.startLineNumber&&(w=this.getLineContent(v.range.startLineNumber),Jn(w)!==-1)||p.push({lineNumber:y,oldContent:w})}}let h=null;if(i){let g=0;h=[];for(let v=0;v<l.length;v++){let I=l[v],y=c[v],w=this.getValueInRange(I.range),C=I.rangeOffset+g;g+=I.text.length-w.length,h[v]={sortIndex:I.sortIndex,identifier:I.identifier,range:y,text:w,textChange:new Rl(I.rangeOffset,w,C,I.text)}}d||h.sort((v,I)=>v.sortIndex-I.sortIndex)}this._mightContainRTL=n,this._mightContainUnusualLineTerminators=o,this._mightContainNonBasicASCII=s;let m=this._doApplyEdits(l),f=null;if(e&&p.length>0){p.sort((g,v)=>v.lineNumber-g.lineNumber),f=[];for(let g=0,v=p.length;g<v;g++){let I=p[g].lineNumber;if(g>0&&p[g-1].lineNumber===I)continue;let y=p[g].oldContent,w=this.getLineContent(I);w.length===0||w===y||Jn(w)!==-1||f.push(I)}}return this._onDidChangeContent.fire(),new h0(h,m,f)}_reduceOperations(t){return t.length<1e3?t:[this._toSingleEditOperation(t)]}_toSingleEditOperation(t){let e=!1,i=t[0].range,n=t[t.length-1].range,o=new L(i.startLineNumber,i.startColumn,n.endLineNumber,n.endColumn),s=i.startLineNumber,a=i.startColumn,l=[];for(let m=0,f=t.length;m<f;m++){let g=t[m],v=g.range;e=e||g.forceMoveMarkers,l.push(this.getValueInRange(new L(s,a,v.startLineNumber,v.startColumn))),g.text.length>0&&l.push(g.text),s=v.endLineNumber,a=v.endColumn}let d=l.join(""),[c,p,h]=nl(d);return{sortIndex:0,identifier:t[0].identifier,range:o,rangeOffset:this.getOffsetAt(o.startLineNumber,o.startColumn),rangeLength:this.getValueLengthInRange(o,0),text:d,eolCount:c,firstLineLength:p,lastLineLength:h,forceMoveMarkers:e,isAutoWhitespaceEdit:!1}}_doApplyEdits(t){t.sort(r._sortOpsDescending);let e=[];for(let i=0;i<t.length;i++){let n=t[i],o=n.range.startLineNumber,s=n.range.startColumn,a=n.range.endLineNumber,l=n.range.endColumn;if(o===a&&s===l&&n.text.length===0)continue;n.text?(this._pieceTree.delete(n.rangeOffset,n.rangeLength),this._pieceTree.insert(n.rangeOffset,n.text,!0)):this._pieceTree.delete(n.rangeOffset,n.rangeLength);let d=new L(o,s,a,l);e.push({range:d,rangeLength:n.rangeLength,text:n.text,rangeOffset:n.rangeOffset,forceMoveMarkers:n.forceMoveMarkers})}return e}findMatchesLineByLine(t,e,i,n){return this._pieceTree.findMatchesLineByLine(t,e,i,n)}getPieceTree(){return this._pieceTree}static _getInverseEditRange(t,e){let i=t.startLineNumber,n=t.startColumn,[o,s,a]=nl(e),l;if(e.length>0){let d=o+1;d===1?l=new L(i,n,i,n+s):l=new L(i,n,i+d-1,a+1)}else l=new L(i,n,i,n);return l}static _getInverseEditRanges(t){let e=[],i=0,n=0,o=null;for(let s=0,a=t.length;s<a;s++){let l=t[s],d,c;o?o.range.endLineNumber===l.range.startLineNumber?(d=i,c=n+(l.range.startColumn-o.range.endColumn)):(d=i+(l.range.startLineNumber-o.range.endLineNumber),c=l.range.startColumn):(d=l.range.startLineNumber,c=l.range.startColumn);let p;if(l.text.length>0){let h=l.eolCount+1;h===1?p=new L(d,c,d,c+l.firstLineLength):p=new L(d,c,d+h-1,l.lastLineLength+1)}else p=new L(d,c,d,c);i=p.endLineNumber,n=p.endColumn,e.push(p),o=l}return e}static _sortOpsAscending(t,e){let i=L.compareRangesUsingEnds(t.range,e.range);return i===0?t.sortIndex-e.sortIndex:i}static _sortOpsDescending(t,e){let i=L.compareRangesUsingEnds(t.range,e.range);return i===0?e.sortIndex-t.sortIndex:-i}};var v3=class{constructor(t,e,i,n,o,s,a,l,d){this._chunks=t;this._bom=e;this._cr=i;this._lf=n;this._crlf=o;this._containsRTL=s;this._containsUnusualLineTerminators=a;this._isBasicASCII=l;this._normalizeEOL=d}_getEOL(t){let e=this._cr+this._lf+this._crlf,i=this._cr+this._crlf;return e===0?t===1?`
`:`\r
`:i>e/2?`\r
`:`
`}create(t){let e=this._getEOL(t),i=this._chunks;if(this._normalizeEOL&&(e===`\r
`&&(this._cr>0||this._lf>0)||e===`
`&&(this._cr>0||this._crlf>0)))for(let o=0,s=i.length;o<s;o++){let a=i[o].buffer.replace(/\r\n|\r|\n/g,e),l=Gp(a);i[o]=new qp(a,l)}let n=new zf(i,this._bom,e,this._containsRTL,this._containsUnusualLineTerminators,this._isBasicASCII,this._normalizeEOL);return{textBuffer:n,disposable:n}}getFirstLineText(t){return this._chunks[0].buffer.substr(0,t).split(/\r\n|\r|\n/)[0]}},Kf=class{chunks;BOM;_hasPreviousChar;_previousChar;_tmpLineStarts;cr;lf;crlf;containsRTL;containsUnusualLineTerminators;isBasicASCII;constructor(){this.chunks=[],this.BOM="",this._hasPreviousChar=!1,this._previousChar=0,this._tmpLineStarts=[],this.cr=0,this.lf=0,this.crlf=0,this.containsRTL=!1,this.containsUnusualLineTerminators=!1,this.isBasicASCII=!0}acceptChunk(t){if(t.length===0)return;this.chunks.length===0&&bA(t)&&(this.BOM=fee,t=t.substr(1));let e=t.charCodeAt(t.length-1);e===13||e>=55296&&e<=56319?(this._acceptChunk1(t.substr(0,t.length-1),!1),this._hasPreviousChar=!0,this._previousChar=e):(this._acceptChunk1(t,!1),this._hasPreviousChar=!1,this._previousChar=e)}_acceptChunk1(t,e){!e&&t.length===0||(this._hasPreviousChar?this._acceptChunk2(String.fromCharCode(this._previousChar)+t):this._acceptChunk2(t))}_acceptChunk2(t){let e=mse(this._tmpLineStarts,t);this.chunks.push(new qp(t,e.lineStarts)),this.cr+=e.cr,this.lf+=e.lf,this.crlf+=e.crlf,e.isBasicASCII||(this.isBasicASCII=!1,this.containsRTL||(this.containsRTL=vm(t)),this.containsUnusualLineTerminators||(this.containsUnusualLineTerminators=fA(t)))}finish(t=!0){return this._finish(),new v3(this.chunks,this.BOM,this.cr,this.lf,this.crlf,this.containsRTL,this.containsUnusualLineTerminators,this.isBasicASCII,t)}_finish(){if(this.chunks.length===0&&this._acceptChunk1("",!0),this._hasPreviousChar){this._hasPreviousChar=!1;let t=this.chunks[this.chunks.length-1];t.buffer+=String.fromCharCode(this._previousChar);let e=Gp(t.buffer);t.lineStarts=e,this._previousChar===13&&this.cr++}}};var I3=new class{clone(){return this}equals(r){return this===r}};function LN(r,t){let e=new Uint32Array(2);return e[0]=0,e[1]=(r<<0|0|0|32768|2<<24)>>>0,new HO(e,t===null?I3:t)}var RN=class{constructor(t){this._default=t}_store=[];get(t){return t<this._store.length?this._store[t]:this._default}set(t,e){for(;t>=this._store.length;)this._store[this._store.length]=this._default;this._store[t]=e}replace(t,e,i){if(t>=this._store.length)return;if(e===0){this.insert(t,i);return}else if(i===0){this.delete(t,e);return}let n=this._store.slice(0,t),o=this._store.slice(t+e),s=Mye(i,this._default);this._store=n.concat(s,o)}delete(t,e){e===0||t>=this._store.length||this._store.splice(t,e)}insert(t,e){if(e===0||t>=this._store.length)return;let i=[];for(let n=0;n<e;n++)i[n]=this._default;this._store=gp(this._store,t,i)}};function Mye(r,t){let e=[];for(let i=0;i<r;i++)e[i]=t;return e}var OI=class{static deserialize(t){let e=0,i=jr(t,e);e+=4;let n=[];for(let o=0;o<i;o++)e=VD.deserialize(t,e,n);return n}_tokens;constructor(){this._tokens=[]}add(t,e){if(this._tokens.length>0){let i=this._tokens[this._tokens.length-1];if(i.endLineNumber+1===t){i.appendLineTokens(e);return}}this._tokens.push(new VD(t,[e]))}finalize(){return this._tokens}serialize(){let t=this._serializeSize(),e=new Uint8Array(t);return this._serialize(e),e}_serializeSize(){let t=0;t+=4;for(let e=0;e<this._tokens.length;e++)t+=this._tokens[e].serializeSize();return t}_serialize(t){let e=0;Xr(t,this._tokens.length,e),e+=4;for(let i=0;i<this._tokens.length;i++)e=this._tokens[i].serialize(t,e)}};var y3=class{constructor(t,e){this.tokenizationSupport=e;this.store=new ew(t)}initialState=this.tokenizationSupport.getInitialState();store;getStartState(t){return this.store.getStartState(t,this.initialState)}getFirstInvalidLine(){return this.store.getFirstInvalidLine(this.initialState)}},PN=class extends y3{constructor(e,i,n,o){super(e,i);this._textModel=n;this._languageIdCodec=o}updateTokensUntilLine(e,i){let n=this._textModel.getLanguageId();for(;;){let o=this.getFirstInvalidLine();if(!o||o.lineNumber>i)break;let s=this._textModel.getLineContent(o.lineNumber),a=JC(this._languageIdCodec,n,this.tokenizationSupport,s,!0,o.startState);e.add(o.lineNumber,a.tokens),this.store.setEndState(o.lineNumber,a.endState)}}getTokenTypeIfInsertingCharacter(e,i){let n=this.getStartState(e.lineNumber);if(!n)return 0;let o=this._textModel.getLanguageId(),s=this._textModel.getLineContent(e.lineNumber),a=s.substring(0,e.column-1)+i+s.substring(e.column-1),l=JC(this._languageIdCodec,o,this.tokenizationSupport,a,!0,n),d=new io(l.tokens,a,this._languageIdCodec);if(d.getCount()===0)return 0;let c=d.findTokenIndexAtOffset(e.column-1);return d.getStandardTokenType(c)}tokenizeLineWithEdit(e,i){let n=this.getStartState(e);if(!n)return{mainLineTokens:null,additionalLines:null};let o=this._textModel.getLineContent(e),s=i.lineEdit.apply(o),a=this._textModel.getLanguageIdAtPosition(e,0),l=JC(this._languageIdCodec,a,this.tokenizationSupport,s,!0,n),d=null;if(i.additionalLines){d=[];let p=l.endState;for(let h of i.additionalLines){let m=JC(this._languageIdCodec,a,this.tokenizationSupport,h,!0,p);d.push(new io(m.tokens,h,this._languageIdCodec)),p=m.endState}}return{mainLineTokens:new io(l.tokens,s,this._languageIdCodec),additionalLines:d}}hasAccurateTokensForLine(e){let i=this.store.getFirstInvalidEndStateLineNumberOrMax();return e<i}isCheapToTokenize(e){let i=this.store.getFirstInvalidEndStateLineNumberOrMax();return e<i||e===i&&this._textModel.getLineLength(e)<2048}tokenizeHeuristically(e,i,n){if(n<=this.store.getFirstInvalidEndStateLineNumberOrMax())return{heuristicTokens:!1};if(i<=this.store.getFirstInvalidEndStateLineNumberOrMax())return this.updateTokensUntilLine(e,n),{heuristicTokens:!1};let o=this.guessStartState(i),s=this._textModel.getLanguageId();for(let a=i;a<=n;a++){let l=this._textModel.getLineContent(a),d=JC(this._languageIdCodec,s,this.tokenizationSupport,l,!0,o);e.add(a,d.tokens),o=d.endState}return{heuristicTokens:!0}}guessStartState(e){let i=this._textModel.getLineFirstNonWhitespaceColumn(e),n=[],o=null;for(let l=e-1;i>1&&l>=1;l--){let d=this._textModel.getLineFirstNonWhitespaceColumn(l);if(d!==0&&d<i&&(n.push(this._textModel.getLineContent(l)),i=d,o=this.getStartState(l),o))break}o||(o=this.tokenizationSupport.getInitialState()),n.reverse();let s=this._textModel.getLanguageId(),a=o;for(let l of n)a=JC(this._languageIdCodec,s,this.tokenizationSupport,l,!1,a).endState;return a}},ew=class{constructor(t){this.lineCount=t;this._invalidEndStatesLineNumbers.addRange(new Qe(1,t+1))}_tokenizationStateStore=new S3;_invalidEndStatesLineNumbers=new C3;getEndState(t){return this._tokenizationStateStore.getEndState(t)}setEndState(t,e){if(!e)throw new _t("Cannot set null/undefined state");this._invalidEndStatesLineNumbers.delete(t);let i=this._tokenizationStateStore.setEndState(t,e);return i&&t<this.lineCount&&this._invalidEndStatesLineNumbers.addRange(new Qe(t+1,t+2)),i}acceptChange(t,e){this.lineCount+=e-t.length,this._tokenizationStateStore.acceptChange(t,e),this._invalidEndStatesLineNumbers.addRangeAndResize(new Qe(t.startLineNumber,t.endLineNumberExclusive),e)}acceptChanges(t){for(let e of t){let[i]=nl(e.text);this.acceptChange(new ht(e.range.startLineNumber,e.range.endLineNumber+1),i+1)}}invalidateEndStateRange(t){this._invalidEndStatesLineNumbers.addRange(new Qe(t.startLineNumber,t.endLineNumberExclusive))}getFirstInvalidEndStateLineNumber(){return this._invalidEndStatesLineNumbers.min}getFirstInvalidEndStateLineNumberOrMax(){return this.getFirstInvalidEndStateLineNumber()||Number.MAX_SAFE_INTEGER}allStatesValid(){return this._invalidEndStatesLineNumbers.min===null}getStartState(t,e){return t===1?e:this.getEndState(t-1)}getFirstInvalidLine(t){let e=this.getFirstInvalidEndStateLineNumber();if(e===null)return null;let i=this.getStartState(e,t);if(!i)throw new _t("Start state must be defined");return{lineNumber:e,startState:i}}},S3=class{_lineEndStates=new RN(null);getEndState(t){return this._lineEndStates.get(t)}setEndState(t,e){let i=this._lineEndStates.get(t);return i&&i.equals(e)?!1:(this._lineEndStates.set(t,e),!0)}acceptChange(t,e){let i=t.length;e>0&&i>0&&(i--,e--),this._lineEndStates.replace(t.startLineNumber,i,e)}acceptChanges(t){for(let e of t){let[i]=nl(e.text);this.acceptChange(new ht(e.range.startLineNumber,e.range.endLineNumber+1),i+1)}}},C3=class{_ranges=[];getRanges(){return this._ranges}get min(){return this._ranges.length===0?null:this._ranges[0].start}removeMin(){if(this._ranges.length===0)return null;let t=this._ranges[0];return t.start+1===t.endExclusive?this._ranges.shift():this._ranges[0]=new Qe(t.start+1,t.endExclusive),t.start}delete(t){let e=this._ranges.findIndex(i=>i.contains(t));if(e!==-1){let i=this._ranges[e];i.start===t?i.endExclusive===t+1?this._ranges.splice(e,1):this._ranges[e]=new Qe(t+1,i.endExclusive):i.endExclusive===t+1?this._ranges[e]=new Qe(i.start,t):this._ranges.splice(e,1,new Qe(i.start,t),new Qe(t+1,i.endExclusive))}}addRange(t){Qe.addRange(t,this._ranges)}addRangeAndResize(t,e){let i=0;for(;!(i>=this._ranges.length||t.start<=this._ranges[i].endExclusive);)i++;let n=i;for(;!(n>=this._ranges.length||t.endExclusive<this._ranges[n].start);)n++;let o=e-t.length;for(let s=n;s<this._ranges.length;s++)this._ranges[s]=this._ranges[s].delta(o);if(i===n){let s=new Qe(t.start,t.start+e);s.isEmpty||this._ranges.splice(i,0,s)}else{let s=Math.min(t.start,this._ranges[i].start),a=Math.max(t.endExclusive,this._ranges[n-1].endExclusive),l=new Qe(s,a+o);l.isEmpty?this._ranges.splice(i,n-i):this._ranges.splice(i,n-i,l)}}toString(){return this._ranges.map(t=>t.toString()).join(" + ")}};function JC(r,t,e,i,n,o){let s=null;if(e)try{s=e.tokenizeEncoded(i,n,o.clone())}catch(a){Xe(a)}return s||(s=LN(r.encodeLanguageId(t),o)),io.convertToEndOffset(s.tokens,i.length),s}var MN=class{constructor(t,e){this._tokenizerWithStateStore=t;this._backgroundTokenStore=e}_isDisposed=!1;dispose(){this._isDisposed=!0}handleChanges(){this._beginBackgroundTokenization()}_isScheduled=!1;_beginBackgroundTokenization(){this._isScheduled||!this._tokenizerWithStateStore._textModel.isAttachedToEditor()||!this._hasLinesToTokenize()||(this._isScheduled=!0,df(t=>{this._isScheduled=!1,this._backgroundTokenizeWithDeadline(t)}))}_backgroundTokenizeWithDeadline(t){let e=Date.now()+t.timeRemaining(),i=()=>{this._isDisposed||!this._tokenizerWithStateStore._textModel.isAttachedToEditor()||!this._hasLinesToTokenize()||(this._backgroundTokenizeForAtLeast1ms(),Date.now()<e?OM(i):this._beginBackgroundTokenization())};i()}_backgroundTokenizeForAtLeast1ms(){let t=this._tokenizerWithStateStore._textModel.getLineCount(),e=new OI,i=Ko.create(!1);do if(i.elapsed()>1||this._tokenizeOneInvalidLine(e)>=t)break;while(this._hasLinesToTokenize());this._backgroundTokenStore.setTokens(e.finalize()),this.checkFinished()}_hasLinesToTokenize(){return this._tokenizerWithStateStore?!this._tokenizerWithStateStore.store.allStatesValid():!1}_tokenizeOneInvalidLine(t){let e=this._tokenizerWithStateStore?.getFirstInvalidLine();return e?(this._tokenizerWithStateStore.updateTokensUntilLine(t,e.lineNumber),e.lineNumber):this._tokenizerWithStateStore._textModel.getLineCount()+1}checkFinished(){this._isDisposed||this._tokenizerWithStateStore.store.allStatesValid()&&this._backgroundTokenStore.backgroundTokenizationFinished()}requestTokens(t,e){this._tokenizerWithStateStore.store.invalidateEndStateRange(new ht(t,e))}};var AN=class{_onDidChangeVisibleRanges=new x;onDidChangeVisibleRanges=this._onDidChangeVisibleRanges.event;_views=new Set;attachView(){let t=new w3(e=>{this._onDidChangeVisibleRanges.fire({view:t,state:e})});return this._views.add(t),t}detachView(t){this._views.delete(t),this._onDidChangeVisibleRanges.fire({view:t,state:void 0})}},w3=class{constructor(t){this.handleStateChange=t}setVisibleLines(t,e){let i=t.map(n=>new ht(n.startLineNumber,n.endLineNumber+1));this.handleStateChange({visibleLineRanges:i,stabilized:e})}},ON=class extends R{constructor(e){super();this._refreshTokens=e}runner=this._register(new Ye(()=>this.update(),50));_computedLineRanges=[];_lineRanges=[];get lineRanges(){return this._lineRanges}update(){xi(this._computedLineRanges,this._lineRanges,(e,i)=>e.equals(i))||(this._computedLineRanges=this._lineRanges,this._refreshTokens())}handleStateChange(e){this._lineRanges=e.visibleLineRanges,e.stabilized?(this.runner.cancel(),this.update()):this.runner.schedule()}},tw=class extends R{constructor(e,i,n){super();this._languageIdCodec=e;this._textModel=i;this.getLanguageId=n}_backgroundTokenizationState=1;get backgroundTokenizationState(){return this._backgroundTokenizationState}_onDidChangeBackgroundTokenizationState=this._register(new x);onDidChangeBackgroundTokenizationState=this._onDidChangeBackgroundTokenizationState.event;_onDidChangeTokens=this._register(new x);onDidChangeTokens=this._onDidChangeTokens.event;tokenizeIfCheap(e){this.isCheapToTokenize(e)&&this.forceTokenization(e)}};var fse=q("treeSitterParserService");var xk=class extends tw{constructor(e,i,n,o){super(i,n,o);this._treeSitterService=e;this._initialize()}_tokenizationSupport=null;_lastLanguageId;_initialize(){let e=this.getLanguageId();(!this._tokenizationSupport||this._lastLanguageId!==e)&&(this._lastLanguageId=e,this._tokenizationSupport=HD.get(e))}getLineTokens(e){let i=this._textModel.getLineContent(e);if(this._tokenizationSupport){let n=this._tokenizationSupport.tokenizeEncoded(e,this._textModel);if(n)return new io(n,i,this._languageIdCodec)}return io.createEmpty(i,this._languageIdCodec)}resetTokenization(e=!0){e&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]}),this._initialize()}handleDidChangeAttached(){}handleDidChangeContent(e){e.isFlush&&this.resetTokenization(!1)}forceTokenization(e){}hasAccurateTokensForLine(e){return!0}isCheapToTokenize(e){return!0}getTokenTypeIfInsertingCharacter(e,i,n){return 0}tokenizeLineWithEdit(e,i){return{mainLineTokens:null,additionalLines:null}}get hasTokens(){return this._treeSitterService.getParseResult(this._textModel)!==void 0}};var Tk=class r{_lineTokens;_len;_languageIdCodec;constructor(t){this._lineTokens=[],this._len=0,this._languageIdCodec=t}flush(){this._lineTokens=[],this._len=0}get hasTokens(){return this._lineTokens.length>0}getTokens(t,e,i){let n=null;if(e<this._len&&(n=this._lineTokens[e]),n!==null&&n!==Np)return new io(Fp(n),i,this._languageIdCodec);let o=new Uint32Array(2);return o[0]=i.length,o[1]=bse(this._languageIdCodec.encodeLanguageId(t)),new io(o,i,this._languageIdCodec)}static _massageTokens(t,e,i){let n=i?Fp(i):null;if(e===0){let o=!1;if(n&&n.length>1&&(o=Pl.getLanguageId(n[1])!==t),!o)return Np}if(!n||n.length===0){let o=new Uint32Array(2);return o[0]=e,o[1]=bse(t),o.buffer}return n[n.length-2]=e,n.byteOffset===0&&n.byteLength===n.buffer.byteLength?n.buffer:n}_ensureLine(t){for(;t>=this._len;)this._lineTokens[this._len]=null,this._len++}_deleteLines(t,e){e!==0&&(t+e>this._len&&(e=this._len-t),this._lineTokens.splice(t,e),this._len-=e)}_insertLines(t,e){if(e===0)return;let i=[];for(let n=0;n<e;n++)i[n]=null;this._lineTokens=gp(this._lineTokens,t,i),this._len+=e}setTokens(t,e,i,n,o){let s=r._massageTokens(this._languageIdCodec.encodeLanguageId(t),i,n);this._ensureLine(e);let a=this._lineTokens[e];return this._lineTokens[e]=s,o?!r._equals(a,s):!1}static _equals(t,e){if(!t||!e)return!t&&!e;let i=Fp(t),n=Fp(e);if(i.length!==n.length)return!1;for(let o=0,s=i.length;o<s;o++)if(i[o]!==n[o])return!1;return!0}acceptEdit(t,e,i){this._acceptDeleteRange(t),this._acceptInsertText(new H(t.startLineNumber,t.startColumn),e,i)}_acceptDeleteRange(t){let e=t.startLineNumber-1;if(e>=this._len)return;if(t.startLineNumber===t.endLineNumber){if(t.startColumn===t.endColumn)return;this._lineTokens[e]=Yr.delete(this._lineTokens[e],t.startColumn-1,t.endColumn-1);return}this._lineTokens[e]=Yr.deleteEnding(this._lineTokens[e],t.startColumn-1);let i=t.endLineNumber-1,n=null;i<this._len&&(n=Yr.deleteBeginning(this._lineTokens[i],t.endColumn-1)),this._lineTokens[e]=Yr.append(this._lineTokens[e],n),this._deleteLines(t.startLineNumber,t.endLineNumber-t.startLineNumber)}_acceptInsertText(t,e,i){if(e===0&&i===0)return;let n=t.lineNumber-1;if(!(n>=this._len)){if(e===0){this._lineTokens[n]=Yr.insert(this._lineTokens[n],t.column-1,i);return}this._lineTokens[n]=Yr.deleteEnding(this._lineTokens[n],t.column-1),this._lineTokens[n]=Yr.insert(this._lineTokens[n],t.column-1,i),this._insertLines(t.lineNumber,e)}}setMultilineTokens(t,e){if(t.length===0)return{changes:[]};let i=[];for(let n=0,o=t.length;n<o;n++){let s=t[n],a=0,l=0,d=!1;for(let c=s.startLineNumber;c<=s.endLineNumber;c++)d?(this.setTokens(e.getLanguageId(),c-1,e.getLineLength(c),s.getLineTokens(c),!1),l=c):this.setTokens(e.getLanguageId(),c-1,e.getLineLength(c),s.getLineTokens(c),!0)&&(d=!0,a=c,l=c);d&&i.push({fromLineNumber:a,toLineNumber:l})}return{changes:i}}};function bse(r){return(r<<0|0|0|32768|2<<24|1024)>>>0}var NN=class r{_pieces;_isComplete;_languageIdCodec;constructor(t){this._pieces=[],this._isComplete=!1,this._languageIdCodec=t}flush(){this._pieces=[],this._isComplete=!1}isEmpty(){return this._pieces.length===0}set(t,e){this._pieces=t||[],this._isComplete=e}setPartial(t,e){let i=t;if(e.length>0){let o=e[0].getRange(),s=e[e.length-1].getRange();if(!o||!s)return t;i=t.plusRange(o).plusRange(s)}let n=null;for(let o=0,s=this._pieces.length;o<s;o++){let a=this._pieces[o];if(a.endLineNumber<i.startLineNumber)continue;if(a.startLineNumber>i.endLineNumber){n=n||{index:o};break}if(a.removeTokens(i),a.isEmpty()){this._pieces.splice(o,1),o--,s--;continue}if(a.endLineNumber<i.startLineNumber)continue;if(a.startLineNumber>i.endLineNumber){n=n||{index:o};continue}let[l,d]=a.split(i);if(l.isEmpty()){n=n||{index:o};continue}d.isEmpty()||(this._pieces.splice(o,1,l,d),o++,s++,n=n||{index:o})}return n=n||{index:this._pieces.length},e.length>0&&(this._pieces=gp(this._pieces,n.index,e)),i}isComplete(){return this._isComplete}addSparseTokens(t,e){if(e.getLineContent().length===0)return e;let i=this._pieces;if(i.length===0)return e;let n=r._findFirstPieceWithLine(i,t),o=i[n].getLineTokens(t);if(!o)return e;let s=e.getCount(),a=o.getCount(),l=0,d=[],c=0,p=0,h=(m,f)=>{m!==p&&(p=m,d[c++]=m,d[c++]=f)};for(let m=0;m<a;m++){let f=o.getStartCharacter(m),g=o.getEndCharacter(m),v=o.getMetadata(m),I=((v&1?2048:0)|(v&2?4096:0)|(v&4?8192:0)|(v&8?16384:0)|(v&16?16744448:0)|(v&32?4278190080:0))>>>0,y=~I>>>0;for(;l<s&&e.getEndOffset(l)<=f;)h(e.getEndOffset(l),e.getMetadata(l)),l++;for(l<s&&e.getStartOffset(l)<f&&h(f,e.getMetadata(l));l<s&&e.getEndOffset(l)<g;)h(e.getEndOffset(l),e.getMetadata(l)&y|v&I),l++;if(l<s)h(g,e.getMetadata(l)&y|v&I),e.getEndOffset(l)===g&&l++;else{let w=Math.min(Math.max(0,l-1),s-1);h(g,e.getMetadata(w)&y|v&I)}}for(;l<s;)h(e.getEndOffset(l),e.getMetadata(l)),l++;return new io(new Uint32Array(d),e.getLineContent(),this._languageIdCodec)}static _findFirstPieceWithLine(t,e){let i=0,n=t.length-1;for(;i<n;){let o=i+Math.floor((n-i)/2);if(t[o].endLineNumber<e)i=o+1;else if(t[o].startLineNumber>e)n=o-1;else{for(;o>i&&t[o-1].startLineNumber<=e&&e<=t[o-1].endLineNumber;)o--;return o}}return i}acceptEdit(t,e,i,n,o){for(let s of this._pieces)s.acceptEdit(t,e,i,n,o)}};var Um=class extends XC{constructor(e,i,n,o,s,a,l){super();this._textModel=e;this._bracketPairsTextModelPart=i;this._languageId=n;this._attachedViews=o;this._languageService=s;this._languageConfigurationService=a;this._treeSitterService=l;this._register(this._languageConfigurationService.onDidChange(d=>{d.affects(this._languageId)&&this._onDidChangeLanguageConfiguration.fire({})})),this._register(X.filter(HD.onDidChange,d=>d.changedLanguages.includes(this._languageId))(()=>{this.createPreferredTokenProvider()})),this.createPreferredTokenProvider()}_semanticTokens=new NN(this._languageService.languageIdCodec);_onDidChangeLanguage=this._register(new x);onDidChangeLanguage=this._onDidChangeLanguage.event;_onDidChangeLanguageConfiguration=this._register(new x);onDidChangeLanguageConfiguration=this._onDidChangeLanguageConfiguration.event;_onDidChangeTokens=this._register(new x);onDidChangeTokens=this._onDidChangeTokens.event;_tokens;_tokensDisposables=this._register(new B);createGrammarTokens(){return this._register(new FN(this._languageService.languageIdCodec,this._textModel,()=>this._languageId,this._attachedViews))}createTreeSitterTokens(){return this._register(new xk(this._treeSitterService,this._languageService.languageIdCodec,this._textModel,()=>this._languageId))}createTokens(e){let i=this._tokens!==void 0;this._tokens?.dispose(),this._tokens=e?this.createTreeSitterTokens():this.createGrammarTokens(),this._tokensDisposables.clear(),this._tokensDisposables.add(this._tokens.onDidChangeTokens(n=>{this._emitModelTokensChangedEvent(n)})),this._tokensDisposables.add(this._tokens.onDidChangeBackgroundTokenizationState(n=>{this._bracketPairsTextModelPart.handleDidChangeBackgroundTokenizationState()})),i&&this._tokens.resetTokenization()}createPreferredTokenProvider(){HD.get(this._languageId)?this._tokens instanceof xk||this.createTokens(!0):this._tokens instanceof FN||this.createTokens(!1)}_hasListeners(){return this._onDidChangeLanguage.hasListeners()||this._onDidChangeLanguageConfiguration.hasListeners()||this._onDidChangeTokens.hasListeners()}handleLanguageConfigurationServiceChange(e){e.affects(this._languageId)&&this._onDidChangeLanguageConfiguration.fire({})}handleDidChangeContent(e){if(e.isFlush)this._semanticTokens.flush();else if(!e.isEolChange)for(let i of e.changes){let[n,o,s]=nl(i.text);this._semanticTokens.acceptEdit(i.range,n,o,s,i.text.length>0?i.text.charCodeAt(0):0)}this._tokens.handleDidChangeContent(e)}handleDidChangeAttached(){this._tokens.handleDidChangeAttached()}getLineTokens(e){this.validateLineNumber(e);let i=this._tokens.getLineTokens(e);return this._semanticTokens.addSparseTokens(e,i)}_emitModelTokensChangedEvent(e){this._textModel._isDisposing()||(this._bracketPairsTextModelPart.handleDidChangeTokens(e),this._onDidChangeTokens.fire(e))}validateLineNumber(e){if(e<1||e>this._textModel.getLineCount())throw new _t("Illegal value for lineNumber")}get hasTokens(){return this._tokens.hasTokens}resetTokenization(){this._tokens.resetTokenization()}get backgroundTokenizationState(){return this._tokens.backgroundTokenizationState}forceTokenization(e){this.validateLineNumber(e),this._tokens.forceTokenization(e)}hasAccurateTokensForLine(e){return this.validateLineNumber(e),this._tokens.hasAccurateTokensForLine(e)}isCheapToTokenize(e){return this.validateLineNumber(e),this._tokens.isCheapToTokenize(e)}tokenizeIfCheap(e){this.validateLineNumber(e),this._tokens.tokenizeIfCheap(e)}getTokenTypeIfInsertingCharacter(e,i,n){return this._tokens.getTokenTypeIfInsertingCharacter(e,i,n)}tokenizeLineWithEdit(e,i){return this._tokens.tokenizeLineWithEdit(e,i)}setSemanticTokens(e,i){this._semanticTokens.set(e,i),this._emitModelTokensChangedEvent({semanticTokensApplied:e!==null,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]})}hasCompleteSemanticTokens(){return this._semanticTokens.isComplete()}hasSomeSemanticTokens(){return!this._semanticTokens.isEmpty()}setPartialSemanticTokens(e,i){if(this.hasCompleteSemanticTokens())return;let n=this._textModel.validateRange(this._semanticTokens.setPartial(e,i));this._emitModelTokensChangedEvent({semanticTokensApplied:!0,ranges:[{fromLineNumber:n.startLineNumber,toLineNumber:n.endLineNumber}]})}getWordAtPosition(e){this.assertNotDisposed();let i=this._textModel.validatePosition(e),n=this._textModel.getLineContent(i.lineNumber),o=this.getLineTokens(i.lineNumber),s=o.findTokenIndexAtOffset(i.column-1),[a,l]=Um._findLanguageBoundaries(o,s),d=gD(i.column,this.getLanguageConfiguration(o.getLanguageId(s)).getWordDefinition(),n.substring(a,l),a);if(d&&d.startColumn<=e.column&&e.column<=d.endColumn)return d;if(s>0&&a===i.column-1){let[c,p]=Um._findLanguageBoundaries(o,s-1),h=gD(i.column,this.getLanguageConfiguration(o.getLanguageId(s-1)).getWordDefinition(),n.substring(c,p),c);if(h&&h.startColumn<=e.column&&e.column<=h.endColumn)return h}return null}getLanguageConfiguration(e){return this._languageConfigurationService.getLanguageConfiguration(e)}static _findLanguageBoundaries(e,i){let n=e.getLanguageId(i),o=0;for(let a=i;a>=0&&e.getLanguageId(a)===n;a--)o=e.getStartOffset(a);let s=e.getLineContent().length;for(let a=i,l=e.getCount();a<l&&e.getLanguageId(a)===n;a++)s=e.getEndOffset(a);return[o,s]}getWordUntilPosition(e){let i=this.getWordAtPosition(e);return i?{word:i.word.substr(0,e.column-i.startColumn),startColumn:i.startColumn,endColumn:e.column}:{word:"",startColumn:e.column,endColumn:e.column}}getLanguageId(){return this._languageId}getLanguageIdAtPosition(e,i){let n=this._textModel.validatePosition(new H(e,i)),o=this.getLineTokens(n.lineNumber);return o.getLanguageId(o.findTokenIndexAtOffset(n.column-1))}setLanguageId(e,i="api"){if(this._languageId===e)return;let n={oldLanguage:this._languageId,newLanguage:e,source:i};this._languageId=e,this._bracketPairsTextModelPart.handleDidChangeLanguage(n),this._tokens.resetTokenization(),this.createPreferredTokenProvider(),this._onDidChangeLanguage.fire(n),this._onDidChangeLanguageConfiguration.fire({})}};Um=E([b(4,ti),b(5,Do),b(6,fse)],Um);var FN=class extends tw{_tokenizer=null;_defaultBackgroundTokenizer=null;_backgroundTokenizer=this._register(new yt);_tokens=new Tk(this._languageIdCodec);_debugBackgroundTokens;_debugBackgroundStates;_debugBackgroundTokenizer=this._register(new yt);_attachedViewStates=this._register(new us);constructor(t,e,i,n){super(t,e,i),this._register(Is.onDidChange(o=>{let s=this.getLanguageId();o.changedLanguages.indexOf(s)!==-1&&this.resetTokenization()})),this.resetTokenization(),this._register(n.onDidChangeVisibleRanges(({view:o,state:s})=>{if(s){let a=this._attachedViewStates.get(o);a||(a=new ON(()=>this.refreshRanges(a.lineRanges)),this._attachedViewStates.set(o,a)),a.handleStateChange(s)}else this._attachedViewStates.deleteAndDispose(o)}))}resetTokenization(t=!0){this._tokens.flush(),this._debugBackgroundTokens?.flush(),this._debugBackgroundStates&&(this._debugBackgroundStates=new ew(this._textModel.getLineCount())),t&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]});let e=()=>{if(this._textModel.isTooLargeForTokenization())return[null,null];let o=Is.get(this.getLanguageId());if(!o)return[null,null];let s;try{s=o.getInitialState()}catch(a){return Xe(a),[null,null]}return[o,s]},[i,n]=e();if(i&&n?this._tokenizer=new PN(this._textModel.getLineCount(),i,this._textModel,this._languageIdCodec):this._tokenizer=null,this._backgroundTokenizer.clear(),this._defaultBackgroundTokenizer=null,this._tokenizer){let o={setTokens:s=>{this.setTokens(s)},backgroundTokenizationFinished:()=>{if(this._backgroundTokenizationState===2)return;let s=2;this._backgroundTokenizationState=s,this._onDidChangeBackgroundTokenizationState.fire()},setEndState:(s,a)=>{if(!this._tokenizer)return;let l=this._tokenizer.store.getFirstInvalidEndStateLineNumber();l!==null&&s>=l&&this._tokenizer?.store.setEndState(s,a)}};i&&i.createBackgroundTokenizer&&!i.backgroundTokenizerShouldOnlyVerifyTokens&&(this._backgroundTokenizer.value=i.createBackgroundTokenizer(this._textModel,o)),!this._backgroundTokenizer.value&&!this._textModel.isTooLargeForTokenization()&&(this._backgroundTokenizer.value=this._defaultBackgroundTokenizer=new MN(this._tokenizer,o),this._defaultBackgroundTokenizer.handleChanges()),i?.backgroundTokenizerShouldOnlyVerifyTokens&&i.createBackgroundTokenizer?(this._debugBackgroundTokens=new Tk(this._languageIdCodec),this._debugBackgroundStates=new ew(this._textModel.getLineCount()),this._debugBackgroundTokenizer.clear(),this._debugBackgroundTokenizer.value=i.createBackgroundTokenizer(this._textModel,{setTokens:s=>{this._debugBackgroundTokens?.setMultilineTokens(s,this._textModel)},backgroundTokenizationFinished(){},setEndState:(s,a)=>{this._debugBackgroundStates?.setEndState(s,a)}})):(this._debugBackgroundTokens=void 0,this._debugBackgroundStates=void 0,this._debugBackgroundTokenizer.value=void 0)}this.refreshAllVisibleLineTokens()}handleDidChangeAttached(){this._defaultBackgroundTokenizer?.handleChanges()}handleDidChangeContent(t){if(t.isFlush)this.resetTokenization(!1);else if(!t.isEolChange){for(let e of t.changes){let[i,n]=nl(e.text);this._tokens.acceptEdit(e.range,i,n),this._debugBackgroundTokens?.acceptEdit(e.range,i,n)}this._debugBackgroundStates?.acceptChanges(t.changes),this._tokenizer&&this._tokenizer.store.acceptChanges(t.changes),this._defaultBackgroundTokenizer?.handleChanges()}}setTokens(t){let{changes:e}=this._tokens.setMultilineTokens(t,this._textModel);return e.length>0&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:e}),{changes:e}}refreshAllVisibleLineTokens(){let t=ht.joinMany([...this._attachedViewStates].map(([e,i])=>i.lineRanges));this.refreshRanges(t)}refreshRanges(t){for(let e of t)this.refreshRange(e.startLineNumber,e.endLineNumberExclusive-1)}refreshRange(t,e){if(!this._tokenizer)return;t=Math.max(1,Math.min(this._textModel.getLineCount(),t)),e=Math.min(this._textModel.getLineCount(),e);let i=new OI,{heuristicTokens:n}=this._tokenizer.tokenizeHeuristically(i,t,e),o=this.setTokens(i.finalize());if(n)for(let s of o.changes)this._backgroundTokenizer.value?.requestTokens(s.fromLineNumber,s.toLineNumber+1);this._defaultBackgroundTokenizer?.checkFinished()}forceTokenization(t){let e=new OI;this._tokenizer?.updateTokensUntilLine(e,t),this.setTokens(e.finalize()),this._defaultBackgroundTokenizer?.checkFinished()}hasAccurateTokensForLine(t){return this._tokenizer?this._tokenizer.hasAccurateTokensForLine(t):!0}isCheapToTokenize(t){return this._tokenizer?this._tokenizer.isCheapToTokenize(t):!0}getLineTokens(t){let e=this._textModel.getLineContent(t),i=this._tokens.getTokens(this._textModel.getLanguageId(),t-1,e);if(this._debugBackgroundTokens&&this._debugBackgroundStates&&this._tokenizer&&this._debugBackgroundStates.getFirstInvalidEndStateLineNumberOrMax()>t&&this._tokenizer.store.getFirstInvalidEndStateLineNumberOrMax()>t){let n=this._debugBackgroundTokens.getTokens(this._textModel.getLanguageId(),t-1,e);!i.equals(n)&&this._debugBackgroundTokenizer.value?.reportMismatchingTokens&&this._debugBackgroundTokenizer.value.reportMismatchingTokens(t)}return i}getTokenTypeIfInsertingCharacter(t,e,i){if(!this._tokenizer)return 0;let n=this._textModel.validatePosition(new H(t,e));return this.forceTokenization(n.lineNumber),this._tokenizer.getTokenTypeIfInsertingCharacter(n,i)}tokenizeLineWithEdit(t,e){return this._tokenizer?(this.forceTokenization(t),this._tokenizer.tokenizeLineWithEdit(t,e)):{mainLineTokens:null,additionalLines:null}}get hasTokens(){return this._tokens.hasTokens}};function R3(r){let t=new Kf;return t.acceptChunk(r),t.finish()}function Cse(r){return new Promise((t,e)=>{let i=new Kf,n=!1;xO(r,{onData:o=>{i.acceptChunk(typeof o=="string"?o:o.toString())},onError:o=>{n||(n=!0,e(o))},onEnd:()=>{n||(n=!0,t(i.finish()))}})})}function Aye(r){let t=new Kf,e;for(;typeof(e=r.read())=="string";)t.acceptChunk(e);return t.finish()}function vse(r,t){let e;return typeof r=="string"?e=R3(r):Jie(r)?e=Aye(r):e=r,e.create(t)}var BN=0,Oye=999,Nye=1e4,x3=class{_source;_eos;constructor(t){this._source=t,this._eos=!1}read(){if(this._eos)return null;let t=[],e=0,i=0;do{let n=this._source.read();if(n===null)return this._eos=!0,e===0?null:t.join("");if(n.length>0&&(t[e++]=n,i+=n.length),i>=64*1024)return t.join("")}while(!0)}},_k=()=>{throw new Error("Invalid change accessor")};var xa=class extends R{constructor(e,i,n,o=null,s,a,l,d){super();this._undoRedoService=s;this._languageService=a;this._languageConfigurationService=l;this.instantiationService=d;BN++,this.id="$model"+BN,this.isForSimpleWidget=n.isForSimpleWidget,typeof o>"u"||o===null?this._associatedResource=Z.parse("inmemory://model/"+BN):this._associatedResource=o,this._attachedEditorCount=0;let{textBuffer:c,disposable:p}=vse(e,n.defaultEOL);this._buffer=c,this._bufferDisposable=p,this._options=xa.resolveOptions(this._buffer,n);let h=typeof i=="string"?i:i.languageId;typeof i!="string"&&(this._languageSelectionListener.value=i.onDidChange(()=>this._setLanguage(i.languageId))),this._bracketPairs=this._register(new dN(this,this._languageConfigurationService)),this._guidesTextModelPart=this._register(new xN(this,this._languageConfigurationService)),this._decorationProvider=this._register(new SN(this)),this._tokenizationTextModelPart=this.instantiationService.createInstance(Um,this,this._bracketPairs,h,this._attachedViews);let m=this._buffer.getLineCount(),f=this._buffer.getValueLengthInRange(new L(1,1,m,this._buffer.getLineLength(m)+1),0);n.largeFileOptimizations?(this._isTooLargeForTokenization=f>xa.LARGE_FILE_SIZE_THRESHOLD||m>xa.LARGE_FILE_LINE_COUNT_THRESHOLD,this._isTooLargeForHeapOperation=f>xa.LARGE_FILE_HEAP_OPERATION_THRESHOLD):(this._isTooLargeForTokenization=!1,this._isTooLargeForHeapOperation=!1),this._isTooLargeForSyncing=f>xa._MODEL_SYNC_LIMIT,this._versionId=1,this._alternativeVersionId=1,this._initialUndoRedoSnapshot=null,this._isDisposed=!1,this.__isDisposing=!1,this._instanceId=vA(BN),this._lastDecorationId=0,this._decorations=Object.create(null),this._decorationsTree=new WN,this._commandManager=new EN(this,this._undoRedoService),this._isUndoing=!1,this._isRedoing=!1,this._trimAutoWhitespaceLines=null,this._register(this._decorationProvider.onDidChange(()=>{this._onDidChangeDecorations.beginDeferredEmit(),this._onDidChangeDecorations.fire(),this._onDidChangeDecorations.endDeferredEmit()})),this._languageService.requestRichLanguageFeatures(h),this._register(this._languageConfigurationService.onDidChange(g=>{this._bracketPairs.handleLanguageConfigurationServiceChange(g),this._tokenizationTextModelPart.handleLanguageConfigurationServiceChange(g)}))}static _MODEL_SYNC_LIMIT=50*1024*1024;static LARGE_FILE_SIZE_THRESHOLD=20*1024*1024;static LARGE_FILE_LINE_COUNT_THRESHOLD=300*1e3;static LARGE_FILE_HEAP_OPERATION_THRESHOLD=256*1024*1024;static DEFAULT_CREATION_OPTIONS={isForSimpleWidget:!1,tabSize:Lp.tabSize,indentSize:Lp.indentSize,insertSpaces:Lp.insertSpaces,detectIndentation:!1,defaultEOL:1,trimAutoWhitespace:Lp.trimAutoWhitespace,largeFileOptimizations:Lp.largeFileOptimizations,bracketPairColorizationOptions:Lp.bracketPairColorizationOptions};static resolveOptions(e,i){if(i.detectIndentation){let n=a3(e,i.tabSize,i.insertSpaces);return new TC({tabSize:n.tabSize,indentSize:"tabSize",insertSpaces:n.insertSpaces,trimAutoWhitespace:i.trimAutoWhitespace,defaultEOL:i.defaultEOL,bracketPairColorizationOptions:i.bracketPairColorizationOptions})}return new TC(i)}_onWillDispose=this._register(new x);onWillDispose=this._onWillDispose.event;_onDidChangeDecorations=this._register(new k3(e=>this.handleBeforeFireDecorationsChangedEvent(e)));onDidChangeDecorations=this._onDidChangeDecorations.event;get onDidChangeLanguage(){return this._tokenizationTextModelPart.onDidChangeLanguage}get onDidChangeLanguageConfiguration(){return this._tokenizationTextModelPart.onDidChangeLanguageConfiguration}get onDidChangeTokens(){return this._tokenizationTextModelPart.onDidChangeTokens}_onDidChangeOptions=this._register(new x);onDidChangeOptions=this._onDidChangeOptions.event;_onDidChangeAttached=this._register(new x);onDidChangeAttached=this._onDidChangeAttached.event;_onDidChangeInjectedText=this._register(new x);_eventEmitter=this._register(new L3);onDidChangeContent(e){return this._eventEmitter.slowEvent(i=>e(i.contentChangedEvent))}onDidChangeContentOrInjectedText(e){return In(this._eventEmitter.fastEvent(i=>e(i)),this._onDidChangeInjectedText.event(i=>e(i)))}id;isForSimpleWidget;_associatedResource;_attachedEditorCount;_buffer;_bufferDisposable;_options;_languageSelectionListener=this._register(new yt);_isDisposed;__isDisposing;_isDisposing(){return this.__isDisposing}_versionId;_alternativeVersionId;_initialUndoRedoSnapshot;_isTooLargeForSyncing;_isTooLargeForTokenization;_isTooLargeForHeapOperation;_commandManager;_isUndoing;_isRedoing;_trimAutoWhitespaceLines;_instanceId;_deltaDecorationCallCnt=0;_lastDecorationId;_decorations;_decorationsTree;_decorationProvider;_tokenizationTextModelPart;get tokenization(){return this._tokenizationTextModelPart}_bracketPairs;get bracketPairs(){return this._bracketPairs}_guidesTextModelPart;get guides(){return this._guidesTextModelPart}_attachedViews=new AN;dispose(){this.__isDisposing=!0,this._onWillDispose.fire(),this._tokenizationTextModelPart.dispose(),this._isDisposed=!0,super.dispose(),this._bufferDisposable.dispose(),this.__isDisposing=!1;let e=new zf([],"",`
`,!1,!1,!0,!0);e.dispose(),this._buffer=e,this._bufferDisposable=R.None}_hasListeners(){return this._onWillDispose.hasListeners()||this._onDidChangeDecorations.hasListeners()||this._tokenizationTextModelPart._hasListeners()||this._onDidChangeOptions.hasListeners()||this._onDidChangeAttached.hasListeners()||this._onDidChangeInjectedText.hasListeners()||this._eventEmitter.hasListeners()}_assertNotDisposed(){if(this._isDisposed)throw new _t("Model is disposed!")}equalsTextBuffer(e){return this._assertNotDisposed(),this._buffer.equals(e)}getTextBuffer(){return this._assertNotDisposed(),this._buffer}_emitContentChangedEvent(e,i){this.__isDisposing||(this._tokenizationTextModelPart.handleDidChangeContent(i),this._bracketPairs.handleDidChangeContent(i),this._eventEmitter.fire(new kf(e,i)))}setValue(e){if(this._assertNotDisposed(),e==null)throw Uc();let{textBuffer:i,disposable:n}=vse(e,this._options.defaultEOL);this._setValueFromTextBuffer(i,n)}_createContentChanged2(e,i,n,o,s,a,l,d){return{changes:[{range:e,rangeOffset:i,rangeLength:n,text:o}],eol:this._buffer.getEOL(),isEolChange:d,versionId:this.getVersionId(),isUndoing:s,isRedoing:a,isFlush:l}}_setValueFromTextBuffer(e,i){this._assertNotDisposed();let n=this.getFullModelRange(),o=this.getValueLengthInRange(n),s=this.getLineCount(),a=this.getLineMaxColumn(s);this._buffer=e,this._bufferDisposable.dispose(),this._bufferDisposable=i,this._increaseVersionId(),this._decorations=Object.create(null),this._decorationsTree=new WN,this._commandManager.clear(),this._trimAutoWhitespaceLines=null,this._emitContentChangedEvent(new SI([new s0],this._versionId,!1,!1),this._createContentChanged2(new L(1,1,s,a),0,o,this.getValue(),!1,!1,!0,!1))}setEOL(e){this._assertNotDisposed();let i=e===1?`\r
`:`
`;if(this._buffer.getEOL()===i)return;let n=this.getFullModelRange(),o=this.getValueLengthInRange(n),s=this.getLineCount(),a=this.getLineMaxColumn(s);this._onBeforeEOLChange(),this._buffer.setEOL(i),this._increaseVersionId(),this._onAfterEOLChange(),this._emitContentChangedEvent(new SI([new d0],this._versionId,!1,!1),this._createContentChanged2(new L(1,1,s,a),0,o,this.getValue(),!1,!1,!1,!0))}_onBeforeEOLChange(){this._decorationsTree.ensureAllNodesHaveRanges(this)}_onAfterEOLChange(){let e=this.getVersionId(),i=this._decorationsTree.collectNodesPostOrder();for(let n=0,o=i.length;n<o;n++){let s=i[n],a=s.range,l=s.cachedAbsoluteStart-s.start,d=this._buffer.getOffsetAt(a.startLineNumber,a.startColumn),c=this._buffer.getOffsetAt(a.endLineNumber,a.endColumn);s.cachedAbsoluteStart=d,s.cachedAbsoluteEnd=c,s.cachedVersionId=e,s.start=d-l,s.end=c-l,Vm(s)}}onBeforeAttached(){return this._attachedEditorCount++,this._attachedEditorCount===1&&(this._tokenizationTextModelPart.handleDidChangeAttached(),this._onDidChangeAttached.fire(void 0)),this._attachedViews.attachView()}onBeforeDetached(e){this._attachedEditorCount--,this._attachedEditorCount===0&&(this._tokenizationTextModelPart.handleDidChangeAttached(),this._onDidChangeAttached.fire(void 0)),this._attachedViews.detachView(e)}isAttachedToEditor(){return this._attachedEditorCount>0}getAttachedEditorCount(){return this._attachedEditorCount}isTooLargeForSyncing(){return this._isTooLargeForSyncing}isTooLargeForTokenization(){return this._isTooLargeForTokenization}isTooLargeForHeapOperation(){return this._isTooLargeForHeapOperation}isDisposed(){return this._isDisposed}isDominatedByLongLines(){if(this._assertNotDisposed(),this.isTooLargeForTokenization())return!1;let e=0,i=0,n=this._buffer.getLineCount();for(let o=1;o<=n;o++){let s=this._buffer.getLineLength(o);s>=Nye?i+=s:e+=s}return i>e}get uri(){return this._associatedResource}getOptions(){return this._assertNotDisposed(),this._options}getFormattingOptions(){return{tabSize:this._options.indentSize,insertSpaces:this._options.insertSpaces}}updateOptions(e){this._assertNotDisposed();let i=typeof e.tabSize<"u"?e.tabSize:this._options.tabSize,n=typeof e.indentSize<"u"?e.indentSize:this._options.originalIndentSize,o=typeof e.insertSpaces<"u"?e.insertSpaces:this._options.insertSpaces,s=typeof e.trimAutoWhitespace<"u"?e.trimAutoWhitespace:this._options.trimAutoWhitespace,a=typeof e.bracketColorizationOptions<"u"?e.bracketColorizationOptions:this._options.bracketPairColorizationOptions,l=new TC({tabSize:i,indentSize:n,insertSpaces:o,defaultEOL:this._options.defaultEOL,trimAutoWhitespace:s,bracketPairColorizationOptions:a});if(this._options.equals(l))return;let d=this._options.createChangeEvent(l);this._options=l,this._bracketPairs.handleDidChangeOptions(d),this._decorationProvider.handleDidChangeOptions(d),this._onDidChangeOptions.fire(d)}detectIndentation(e,i){this._assertNotDisposed();let n=a3(this._buffer,i,e);this.updateOptions({insertSpaces:n.insertSpaces,tabSize:n.tabSize,indentSize:n.tabSize})}normalizeIndentation(e){return this._assertNotDisposed(),m0(e,this._options.indentSize,this._options.insertSpaces)}getVersionId(){return this._assertNotDisposed(),this._versionId}mightContainRTL(){return this._buffer.mightContainRTL()}mightContainUnusualLineTerminators(){return this._buffer.mightContainUnusualLineTerminators()}removeUnusualLineTerminators(e=null){let i=this.findMatches(I4.source,!1,!0,!1,null,!1,1073741824);this._buffer.resetMightContainUnusualLineTerminators(),this.pushEditOperations(e,i.map(n=>({range:n.range,text:null})),()=>null)}mightContainNonBasicASCII(){return this._buffer.mightContainNonBasicASCII()}getAlternativeVersionId(){return this._assertNotDisposed(),this._alternativeVersionId}getInitialUndoRedoSnapshot(){return this._assertNotDisposed(),this._initialUndoRedoSnapshot}getOffsetAt(e){this._assertNotDisposed();let i=this._validatePosition(e.lineNumber,e.column,0);return this._buffer.getOffsetAt(i.lineNumber,i.column)}getPositionAt(e){this._assertNotDisposed();let i=Math.min(this._buffer.getLength(),Math.max(0,e));return this._buffer.getPositionAt(i)}_increaseVersionId(){this._versionId=this._versionId+1,this._alternativeVersionId=this._versionId}_overwriteVersionId(e){this._versionId=e}_overwriteAlternativeVersionId(e){this._alternativeVersionId=e}_overwriteInitialUndoRedoSnapshot(e){this._initialUndoRedoSnapshot=e}getValue(e,i=!1){if(this._assertNotDisposed(),this.isTooLargeForHeapOperation())throw new _t("Operation would exceed heap memory limits");let n=this.getFullModelRange(),o=this.getValueInRange(n,e);return i?this._buffer.getBOM()+o:o}createSnapshot(e=!1){return new x3(this._buffer.createSnapshot(e))}getValueLength(e,i=!1){this._assertNotDisposed();let n=this.getFullModelRange(),o=this.getValueLengthInRange(n,e);return i?this._buffer.getBOM().length+o:o}getValueInRange(e,i=0){return this._assertNotDisposed(),this._buffer.getValueInRange(this.validateRange(e),i)}getValueLengthInRange(e,i=0){return this._assertNotDisposed(),this._buffer.getValueLengthInRange(this.validateRange(e),i)}getCharacterCountInRange(e,i=0){return this._assertNotDisposed(),this._buffer.getCharacterCountInRange(this.validateRange(e),i)}getLineCount(){return this._assertNotDisposed(),this._buffer.getLineCount()}getLineContent(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new _t("Illegal value for lineNumber");return this._buffer.getLineContent(e)}getLineLength(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new _t("Illegal value for lineNumber");return this._buffer.getLineLength(e)}getLinesContent(){if(this._assertNotDisposed(),this.isTooLargeForHeapOperation())throw new _t("Operation would exceed heap memory limits");return this._buffer.getLinesContent()}getEOL(){return this._assertNotDisposed(),this._buffer.getEOL()}getEndOfLineSequence(){return this._assertNotDisposed(),this._buffer.getEOL()===`
`?0:1}getLineMinColumn(e){return this._assertNotDisposed(),1}getLineMaxColumn(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new _t("Illegal value for lineNumber");return this._buffer.getLineLength(e)+1}getLineFirstNonWhitespaceColumn(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new _t("Illegal value for lineNumber");return this._buffer.getLineFirstNonWhitespaceColumn(e)}getLineLastNonWhitespaceColumn(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new _t("Illegal value for lineNumber");return this._buffer.getLineLastNonWhitespaceColumn(e)}_validateRangeRelaxedNoAllocations(e){let i=this._buffer.getLineCount(),n=e.startLineNumber,o=e.startColumn,s=Math.floor(typeof n=="number"&&!isNaN(n)?n:1),a=Math.floor(typeof o=="number"&&!isNaN(o)?o:1);if(s<1)s=1,a=1;else if(s>i)s=i,a=this.getLineMaxColumn(s);else if(a<=1)a=1;else{let h=this.getLineMaxColumn(s);a>=h&&(a=h)}let l=e.endLineNumber,d=e.endColumn,c=Math.floor(typeof l=="number"&&!isNaN(l)?l:1),p=Math.floor(typeof d=="number"&&!isNaN(d)?d:1);if(c<1)c=1,p=1;else if(c>i)c=i,p=this.getLineMaxColumn(c);else if(p<=1)p=1;else{let h=this.getLineMaxColumn(c);p>=h&&(p=h)}return n===s&&o===a&&l===c&&d===p&&e instanceof L&&!(e instanceof Et)?e:new L(s,a,c,p)}_isValidPosition(e,i,n){if(typeof e!="number"||typeof i!="number"||isNaN(e)||isNaN(i)||e<1||i<1||(e|0)!==e||(i|0)!==i)return!1;let o=this._buffer.getLineCount();if(e>o)return!1;if(i===1)return!0;let s=this.getLineMaxColumn(e);if(i>s)return!1;if(n===1){let a=this._buffer.getLineCharCode(e,i-2);if(Rn(a))return!1}return!0}_validatePosition(e,i,n){let o=Math.floor(typeof e=="number"&&!isNaN(e)?e:1),s=Math.floor(typeof i=="number"&&!isNaN(i)?i:1),a=this._buffer.getLineCount();if(o<1)return new H(1,1);if(o>a)return new H(a,this.getLineMaxColumn(a));if(s<=1)return new H(o,1);let l=this.getLineMaxColumn(o);if(s>=l)return new H(o,l);if(n===1){let d=this._buffer.getLineCharCode(o,s-2);if(Rn(d))return new H(o,s-1)}return new H(o,s)}validatePosition(e){let i=1;return this._assertNotDisposed(),e instanceof H&&this._isValidPosition(e.lineNumber,e.column,i)?e:this._validatePosition(e.lineNumber,e.column,i)}_isValidRange(e,i){let n=e.startLineNumber,o=e.startColumn,s=e.endLineNumber,a=e.endColumn;if(!this._isValidPosition(n,o,0)||!this._isValidPosition(s,a,0))return!1;if(i===1){let l=o>1?this._buffer.getLineCharCode(n,o-2):0,d=a>1&&a<=this._buffer.getLineLength(s)?this._buffer.getLineCharCode(s,a-2):0,c=Rn(l),p=Rn(d);return!c&&!p}return!0}validateRange(e){let i=1;if(this._assertNotDisposed(),e instanceof L&&!(e instanceof Et)&&this._isValidRange(e,i))return e;let n=this._validatePosition(e.startLineNumber,e.startColumn,0),o=this._validatePosition(e.endLineNumber,e.endColumn,0),s=n.lineNumber,a=n.column,l=o.lineNumber,d=o.column;if(i===1){let c=a>1?this._buffer.getLineCharCode(s,a-2):0,p=d>1&&d<=this._buffer.getLineLength(l)?this._buffer.getLineCharCode(l,d-2):0,h=Rn(c),m=Rn(p);return!h&&!m?new L(s,a,l,d):s===l&&a===d?new L(s,a-1,l,d-1):h&&m?new L(s,a-1,l,d+1):h?new L(s,a-1,l,d):new L(s,a,l,d+1)}return new L(s,a,l,d)}modifyPosition(e,i){this._assertNotDisposed();let n=this.getOffsetAt(e)+i;return this.getPositionAt(Math.min(this._buffer.getLength(),Math.max(0,n)))}getFullModelRange(){this._assertNotDisposed();let e=this.getLineCount();return new L(1,1,e,this.getLineMaxColumn(e))}findMatchesLineByLine(e,i,n,o){return this._buffer.findMatchesLineByLine(e,i,n,o)}findMatches(e,i,n,o,s,a,l=Oye){this._assertNotDisposed();let d=null;i!==null&&(Array.isArray(i)||(i=[i]),i.every(h=>L.isIRange(h))&&(d=i.map(h=>this.validateRange(h)))),d===null&&(d=[this.getFullModelRange()]),d=d.sort((h,m)=>h.startLineNumber-m.startLineNumber||h.startColumn-m.startColumn);let c=[];c.push(d.reduce((h,m)=>L.areIntersecting(h,m)?h.plusRange(m):(c.push(h),m)));let p;if(!n&&e.indexOf(`
`)<0){let m=new Iu(e,n,o,s).parseSearchRequest();if(!m)return[];p=f=>this.findMatchesLineByLine(f,m,a,l)}else p=h=>AI.findMatches(this,new Iu(e,n,o,s),h,a,l);return c.map(p).reduce((h,m)=>h.concat(m),[])}findNextMatch(e,i,n,o,s,a){this._assertNotDisposed();let l=this.validatePosition(i);if(!n&&e.indexOf(`
`)<0){let c=new Iu(e,n,o,s).parseSearchRequest();if(!c)return null;let p=this.getLineCount(),h=new L(l.lineNumber,l.column,p,this.getLineMaxColumn(p)),m=this.findMatchesLineByLine(h,c,a,1);return AI.findNextMatch(this,new Iu(e,n,o,s),l,a),m.length>0||(h=new L(1,1,l.lineNumber,this.getLineMaxColumn(l.lineNumber)),m=this.findMatchesLineByLine(h,c,a,1),m.length>0)?m[0]:null}return AI.findNextMatch(this,new Iu(e,n,o,s),l,a)}findPreviousMatch(e,i,n,o,s,a){this._assertNotDisposed();let l=this.validatePosition(i);return AI.findPreviousMatch(this,new Iu(e,n,o,s),l,a)}pushStackElement(){this._commandManager.pushStackElement()}popStackElement(){this._commandManager.popStackElement()}pushEOL(e){if((this.getEOL()===`
`?0:1)!==e)try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._initialUndoRedoSnapshot===null&&(this._initialUndoRedoSnapshot=this._undoRedoService.createSnapshot(this.uri)),this._commandManager.pushEOL(e)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_validateEditOperation(e){return e instanceof _C?e:new _C(e.identifier||null,this.validateRange(e.range),e.text,e.forceMoveMarkers||!1,e.isAutoWhitespaceEdit||!1,e._isTracked||!1)}_validateEditOperations(e){let i=[];for(let n=0,o=e.length;n<o;n++)i[n]=this._validateEditOperation(e[n]);return i}pushEditOperations(e,i,n,o){try{return this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._pushEditOperations(e,this._validateEditOperations(i),n,o)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_pushEditOperations(e,i,n,o){if(this._options.trimAutoWhitespace&&this._trimAutoWhitespaceLines){let s=i.map(l=>({range:this.validateRange(l.range),text:l.text})),a=!0;if(e)for(let l=0,d=e.length;l<d;l++){let c=e[l],p=!1;for(let h=0,m=s.length;h<m;h++){let f=s[h].range,g=f.startLineNumber>c.endLineNumber,v=c.startLineNumber>f.endLineNumber;if(!g&&!v){p=!0;break}}if(!p){a=!1;break}}if(a)for(let l=0,d=this._trimAutoWhitespaceLines.length;l<d;l++){let c=this._trimAutoWhitespaceLines[l],p=this.getLineMaxColumn(c),h=!0;for(let m=0,f=s.length;m<f;m++){let g=s[m].range,v=s[m].text;if(!(c<g.startLineNumber||c>g.endLineNumber)&&!(c===g.startLineNumber&&g.startColumn===p&&g.isEmpty()&&v&&v.length>0&&v.charAt(0)===`
`)&&!(c===g.startLineNumber&&g.startColumn===1&&g.isEmpty()&&v&&v.length>0&&v.charAt(v.length-1)===`
`)){h=!1;break}}if(h){let m=new L(c,1,c,p);i.push(new _C(null,m,null,!1,!1,!1))}}this._trimAutoWhitespaceLines=null}return this._initialUndoRedoSnapshot===null&&(this._initialUndoRedoSnapshot=this._undoRedoService.createSnapshot(this.uri)),this._commandManager.pushEditOperation(e,i,n,o)}_applyUndo(e,i,n,o){let s=e.map(a=>{let l=this.getPositionAt(a.newPosition),d=this.getPositionAt(a.newEnd);return{range:new L(l.lineNumber,l.column,d.lineNumber,d.column),text:a.oldText}});this._applyUndoRedoEdits(s,i,!0,!1,n,o)}_applyRedo(e,i,n,o){let s=e.map(a=>{let l=this.getPositionAt(a.oldPosition),d=this.getPositionAt(a.oldEnd);return{range:new L(l.lineNumber,l.column,d.lineNumber,d.column),text:a.newText}});this._applyUndoRedoEdits(s,i,!1,!0,n,o)}_applyUndoRedoEdits(e,i,n,o,s,a){try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._isUndoing=n,this._isRedoing=o,this.applyEdits(e,!1),this.setEOL(i),this._overwriteAlternativeVersionId(s)}finally{this._isUndoing=!1,this._isRedoing=!1,this._eventEmitter.endDeferredEmit(a),this._onDidChangeDecorations.endDeferredEmit()}}applyEdits(e,i=!1){try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit();let n=this._validateEditOperations(e);return this._doApplyEdits(n,i)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_doApplyEdits(e,i){let n=this._buffer.getLineCount(),o=this._buffer.applyEdits(e,this._options.trimAutoWhitespace,i),s=this._buffer.getLineCount(),a=o.changes;if(this._trimAutoWhitespaceLines=o.trimAutoWhitespaceLineNumbers,a.length!==0){for(let c=0,p=a.length;c<p;c++){let h=a[c];this._decorationsTree.acceptReplace(h.rangeOffset,h.rangeLength,h.text.length,h.forceMoveMarkers)}let l=[];this._increaseVersionId();let d=n;for(let c=0,p=a.length;c<p;c++){let h=a[c],[m]=nl(h.text);this._onDidChangeDecorations.fire();let f=h.range.startLineNumber,g=h.range.endLineNumber,v=g-f,I=m,y=Math.min(v,I),w=I-v,C=s-d-w+f,S=C,D=C+I,k=this._decorationsTree.getInjectedTextInInterval(this,this.getOffsetAt(new H(S,1)),this.getOffsetAt(new H(D,this.getLineMaxColumn(D))),0),M=ol.fromDecorations(k),O=new Ms(M);for(let K=y;K>=0;K--){let G=f+K,Y=C+K;O.takeFromEndWhile(xe=>xe.lineNumber>Y);let ge=O.takeFromEndWhile(xe=>xe.lineNumber===Y);l.push(new ZD(G,this.getLineContent(Y),ge))}if(y<v){let K=f+y;l.push(new a0(K+1,g))}if(y<I){let K=new Ms(M),G=f+y,Y=I-y,ge=s-d-Y+G+1,xe=[],be=[];for(let fe=0;fe<Y;fe++){let Le=ge+fe;be[fe]=this.getLineContent(Le),K.takeWhile(Ee=>Ee.lineNumber<Le),xe[fe]=K.takeWhile(Ee=>Ee.lineNumber===Le)}l.push(new l0(G+1,f+I,be,xe))}d+=w}this._emitContentChangedEvent(new SI(l,this.getVersionId(),this._isUndoing,this._isRedoing),{changes:a,eol:this._buffer.getEOL(),isEolChange:!1,versionId:this.getVersionId(),isUndoing:this._isUndoing,isRedoing:this._isRedoing,isFlush:!1})}return o.reverseEdits===null?void 0:o.reverseEdits}undo(){return this._undoRedoService.undo(this.uri)}canUndo(){return this._undoRedoService.canUndo(this.uri)}redo(){return this._undoRedoService.redo(this.uri)}canRedo(){return this._undoRedoService.canRedo(this.uri)}handleBeforeFireDecorationsChangedEvent(e){if(e===null||e.size===0)return;let n=Array.from(e).map(o=>new ZD(o,this.getLineContent(o),this._getInjectedTextInLine(o)));this._onDidChangeInjectedText.fire(new xC(n))}changeDecorations(e,i=0){this._assertNotDisposed();try{return this._onDidChangeDecorations.beginDeferredEmit(),this._changeDecorations(i,e)}finally{this._onDidChangeDecorations.endDeferredEmit()}}_changeDecorations(e,i){let n={addDecoration:(s,a)=>this._deltaDecorationsImpl(e,[],[{range:s,options:a}])[0],changeDecoration:(s,a)=>{this._changeDecorationImpl(s,a)},changeDecorationOptions:(s,a)=>{this._changeDecorationOptionsImpl(s,yse(a))},removeDecoration:s=>{this._deltaDecorationsImpl(e,[s],[])},deltaDecorations:(s,a)=>s.length===0&&a.length===0?[]:this._deltaDecorationsImpl(e,s,a)},o=null;try{o=i(n)}catch(s){Xe(s)}return n.addDecoration=_k,n.changeDecoration=_k,n.changeDecorationOptions=_k,n.removeDecoration=_k,n.deltaDecorations=_k,o}deltaDecorations(e,i,n=0){if(this._assertNotDisposed(),e||(e=[]),e.length===0&&i.length===0)return[];try{return this._deltaDecorationCallCnt++,this._deltaDecorationCallCnt>1&&(console.warn("Invoking deltaDecorations recursively could lead to leaking decorations."),Xe(new Error("Invoking deltaDecorations recursively could lead to leaking decorations."))),this._onDidChangeDecorations.beginDeferredEmit(),this._deltaDecorationsImpl(n,e,i)}finally{this._onDidChangeDecorations.endDeferredEmit(),this._deltaDecorationCallCnt--}}_getTrackedRange(e){return this.getDecorationRange(e)}_setTrackedRange(e,i,n){let o=e?this._decorations[e]:null;if(!o)return i?this._deltaDecorationsImpl(0,[],[{range:i,options:Ise[n]}],!0)[0]:null;if(!i)return this._decorationsTree.delete(o),delete this._decorations[o.id],null;let s=this._validateRangeRelaxedNoAllocations(i),a=this._buffer.getOffsetAt(s.startLineNumber,s.startColumn),l=this._buffer.getOffsetAt(s.endLineNumber,s.endColumn);return this._decorationsTree.delete(o),o.reset(this.getVersionId(),a,l,s),o.setOptions(Ise[n]),this._decorationsTree.insert(o),o.id}removeAllDecorationsWithOwnerId(e){if(this._isDisposed)return;let i=this._decorationsTree.collectNodesFromOwner(e);for(let n=0,o=i.length;n<o;n++){let s=i[n];this._decorationsTree.delete(s),delete this._decorations[s.id]}}getDecorationOptions(e){let i=this._decorations[e];return i?i.options:null}getDecorationRange(e){let i=this._decorations[e];return i?this._decorationsTree.getNodeRange(this,i):null}getLineDecorations(e,i=0,n=!1){return e<1||e>this.getLineCount()?[]:this.getLinesDecorations(e,e,i,n)}getLinesDecorations(e,i,n=0,o=!1,s=!1){let a=this.getLineCount(),l=Math.min(a,Math.max(1,e)),d=Math.min(a,Math.max(1,i)),c=this.getLineMaxColumn(d),p=new L(l,1,d,c),h=this._getDecorationsInRange(p,n,o,s);return __(h,this._decorationProvider.getDecorationsInRange(p,n,o)),h}getDecorationsInRange(e,i=0,n=!1,o=!1,s=!1){let a=this.validateRange(e),l=this._getDecorationsInRange(a,i,n,s);return __(l,this._decorationProvider.getDecorationsInRange(a,i,n,o)),l}getOverviewRulerDecorations(e=0,i=!1){return this._decorationsTree.getAll(this,e,i,!0,!1)}getInjectedTextDecorations(e=0){return this._decorationsTree.getAllInjectedText(this,e)}_getInjectedTextInLine(e){let i=this._buffer.getOffsetAt(e,1),n=i+this._buffer.getLineLength(e),o=this._decorationsTree.getInjectedTextInInterval(this,i,n,0);return ol.fromDecorations(o).filter(s=>s.lineNumber===e)}getAllDecorations(e=0,i=!1){let n=this._decorationsTree.getAll(this,e,i,!1,!1);return n=n.concat(this._decorationProvider.getAllDecorations(e,i)),n}getAllMarginDecorations(e=0){return this._decorationsTree.getAll(this,e,!1,!1,!0)}_getDecorationsInRange(e,i,n,o){let s=this._buffer.getOffsetAt(e.startLineNumber,e.startColumn),a=this._buffer.getOffsetAt(e.endLineNumber,e.endColumn);return this._decorationsTree.getAllInInterval(this,s,a,i,n,o)}getRangeAt(e,i){return this._buffer.getRangeAt(e,i-e)}_changeDecorationImpl(e,i){let n=this._decorations[e];if(!n)return;if(n.options.after){let l=this.getDecorationRange(e);this._onDidChangeDecorations.recordLineAffectedByInjectedText(l.endLineNumber)}if(n.options.before){let l=this.getDecorationRange(e);this._onDidChangeDecorations.recordLineAffectedByInjectedText(l.startLineNumber)}let o=this._validateRangeRelaxedNoAllocations(i),s=this._buffer.getOffsetAt(o.startLineNumber,o.startColumn),a=this._buffer.getOffsetAt(o.endLineNumber,o.endColumn);this._decorationsTree.delete(n),n.reset(this.getVersionId(),s,a,o),this._decorationsTree.insert(n),this._onDidChangeDecorations.checkAffectedAndFire(n.options),n.options.after&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(o.endLineNumber),n.options.before&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(o.startLineNumber)}_changeDecorationOptionsImpl(e,i){let n=this._decorations[e];if(!n)return;let o=!!(n.options.overviewRuler&&n.options.overviewRuler.color),s=!!(i.overviewRuler&&i.overviewRuler.color);if(this._onDidChangeDecorations.checkAffectedAndFire(n.options),this._onDidChangeDecorations.checkAffectedAndFire(i),n.options.after||i.after){let d=this._decorationsTree.getNodeRange(this,n);this._onDidChangeDecorations.recordLineAffectedByInjectedText(d.endLineNumber)}if(n.options.before||i.before){let d=this._decorationsTree.getNodeRange(this,n);this._onDidChangeDecorations.recordLineAffectedByInjectedText(d.startLineNumber)}let a=o!==s,l=Bye(i)!==VN(n);a||l?(this._decorationsTree.delete(n),n.setOptions(i),this._decorationsTree.insert(n)):n.setOptions(i)}_deltaDecorationsImpl(e,i,n,o=!1){let s=this.getVersionId(),a=i.length,l=0,d=n.length,c=0;this._onDidChangeDecorations.beginDeferredEmit();try{let p=new Array(d);for(;l<a||c<d;){let h=null;if(l<a){do h=this._decorations[i[l++]];while(!h&&l<a);if(h){if(h.options.after){let m=this._decorationsTree.getNodeRange(this,h);this._onDidChangeDecorations.recordLineAffectedByInjectedText(m.endLineNumber)}if(h.options.before){let m=this._decorationsTree.getNodeRange(this,h);this._onDidChangeDecorations.recordLineAffectedByInjectedText(m.startLineNumber)}this._decorationsTree.delete(h),o||this._onDidChangeDecorations.checkAffectedAndFire(h.options)}}if(c<d){if(!h){let y=++this._lastDecorationId,w=`${this._instanceId};${y}`;h=new yk(w,0,0),this._decorations[w]=h}let m=n[c],f=this._validateRangeRelaxedNoAllocations(m.range),g=yse(m.options),v=this._buffer.getOffsetAt(f.startLineNumber,f.startColumn),I=this._buffer.getOffsetAt(f.endLineNumber,f.endColumn);h.ownerId=e,h.reset(s,v,I,f),h.setOptions(g),h.options.after&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(f.endLineNumber),h.options.before&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(f.startLineNumber),o||this._onDidChangeDecorations.checkAffectedAndFire(g),this._decorationsTree.insert(h),p[c]=h.id,c++}else h&&delete this._decorations[h.id]}return p}finally{this._onDidChangeDecorations.endDeferredEmit()}}getLanguageId(){return this.tokenization.getLanguageId()}setLanguage(e,i){typeof e=="string"?(this._languageSelectionListener.clear(),this._setLanguage(e,i)):(this._languageSelectionListener.value=e.onDidChange(()=>this._setLanguage(e.languageId,i)),this._setLanguage(e.languageId,i))}_setLanguage(e,i){this.tokenization.setLanguageId(e,i),this._languageService.requestRichLanguageFeatures(e)}getLanguageIdAtPosition(e,i){return this.tokenization.getLanguageIdAtPosition(e,i)}getWordAtPosition(e){return this._tokenizationTextModelPart.getWordAtPosition(e)}getWordUntilPosition(e){return this._tokenizationTextModelPart.getWordUntilPosition(e)}normalizePosition(e,i){return e}getLineIndentColumn(e){return Fye(this.getLineContent(e))+1}};xa=E([b(4,u0),b(5,ti),b(6,Do),b(7,ne)],xa);function Fye(r){let t=0;for(let e of r)if(e===" "||e==="	")t++;else break;return t}function E3(r){return!!(r.options.overviewRuler&&r.options.overviewRuler.color)}function Bye(r){return!!r.after||!!r.before}function VN(r){return!!r.options.after||!!r.options.before}var WN=class{_decorationsTree0;_decorationsTree1;_injectedTextDecorationsTree;constructor(){this._decorationsTree0=new QC,this._decorationsTree1=new QC,this._injectedTextDecorationsTree=new QC}ensureAllNodesHaveRanges(t){this.getAll(t,0,!1,!1,!1)}_ensureNodesHaveRanges(t,e){for(let i of e)i.range===null&&(i.range=t.getRangeAt(i.cachedAbsoluteStart,i.cachedAbsoluteEnd));return e}getAllInInterval(t,e,i,n,o,s){let a=t.getVersionId(),l=this._intervalSearch(e,i,n,o,a,s);return this._ensureNodesHaveRanges(t,l)}_intervalSearch(t,e,i,n,o,s){let a=this._decorationsTree0.intervalSearch(t,e,i,n,o,s),l=this._decorationsTree1.intervalSearch(t,e,i,n,o,s),d=this._injectedTextDecorationsTree.intervalSearch(t,e,i,n,o,s);return a.concat(l).concat(d)}getInjectedTextInInterval(t,e,i,n){let o=t.getVersionId(),s=this._injectedTextDecorationsTree.intervalSearch(e,i,n,!1,o,!1);return this._ensureNodesHaveRanges(t,s).filter(a=>a.options.showIfCollapsed||!a.range.isEmpty())}getAllInjectedText(t,e){let i=t.getVersionId(),n=this._injectedTextDecorationsTree.search(e,!1,i,!1);return this._ensureNodesHaveRanges(t,n).filter(o=>o.options.showIfCollapsed||!o.range.isEmpty())}getAll(t,e,i,n,o){let s=t.getVersionId(),a=this._search(e,i,n,s,o);return this._ensureNodesHaveRanges(t,a)}_search(t,e,i,n,o){if(i)return this._decorationsTree1.search(t,e,n,o);{let s=this._decorationsTree0.search(t,e,n,o),a=this._decorationsTree1.search(t,e,n,o),l=this._injectedTextDecorationsTree.search(t,e,n,o);return s.concat(a).concat(l)}}collectNodesFromOwner(t){let e=this._decorationsTree0.collectNodesFromOwner(t),i=this._decorationsTree1.collectNodesFromOwner(t),n=this._injectedTextDecorationsTree.collectNodesFromOwner(t);return e.concat(i).concat(n)}collectNodesPostOrder(){let t=this._decorationsTree0.collectNodesPostOrder(),e=this._decorationsTree1.collectNodesPostOrder(),i=this._injectedTextDecorationsTree.collectNodesPostOrder();return t.concat(e).concat(i)}insert(t){VN(t)?this._injectedTextDecorationsTree.insert(t):E3(t)?this._decorationsTree1.insert(t):this._decorationsTree0.insert(t)}delete(t){VN(t)?this._injectedTextDecorationsTree.delete(t):E3(t)?this._decorationsTree1.delete(t):this._decorationsTree0.delete(t)}getNodeRange(t,e){let i=t.getVersionId();return e.cachedVersionId!==i&&this._resolveNode(e,i),e.range===null&&(e.range=t.getRangeAt(e.cachedAbsoluteStart,e.cachedAbsoluteEnd)),e.range}_resolveNode(t,e){VN(t)?this._injectedTextDecorationsTree.resolveNode(t,e):E3(t)?this._decorationsTree1.resolveNode(t,e):this._decorationsTree0.resolveNode(t,e)}acceptReplace(t,e,i,n){this._decorationsTree0.acceptReplace(t,e,i,n),this._decorationsTree1.acceptReplace(t,e,i,n),this._injectedTextDecorationsTree.acceptReplace(t,e,i,n)}};function $p(r){return r.replace(/[^a-z0-9\-_]/gi," ")}var HN=class{color;darkColor;constructor(t){this.color=t.color||"",this.darkColor=t.darkColor||""}},T3=class extends HN{position;_resolvedColor;constructor(t){super(t),this._resolvedColor=null,this.position=typeof t.position=="number"?t.position:2}getColor(t){return this._resolvedColor||(t.type!=="light"&&this.darkColor?this._resolvedColor=this._resolveColor(this.darkColor,t):this._resolvedColor=this._resolveColor(this.color,t)),this._resolvedColor}invalidateCachedColor(){this._resolvedColor=null}_resolveColor(t,e){if(typeof t=="string")return t;let i=t?e.getColor(t.id):null;return i?i.toString():""}},_3=class{position;persistLane;constructor(t){this.position=t?.position??2,this.persistLane=t?.persistLane}},D3=class extends HN{position;sectionHeaderStyle;sectionHeaderText;_resolvedColor;constructor(t){super(t),this.position=t.position,this.sectionHeaderStyle=t.sectionHeaderStyle??null,this.sectionHeaderText=t.sectionHeaderText??null}getColor(t){return this._resolvedColor||(t.type!=="light"&&this.darkColor?this._resolvedColor=this._resolveColor(this.darkColor,t):this._resolvedColor=this._resolveColor(this.color,t)),this._resolvedColor}invalidateCachedColor(){this._resolvedColor=void 0}_resolveColor(t,e){return typeof t=="string"?j.fromHex(t):e.getColor(t.id)}},Gf=class r{static from(t){return t instanceof r?t:new r(t)}content;tokens;inlineClassName;inlineClassNameAffectsLetterSpacing;attachedData;cursorStops;constructor(t){this.content=t.content||"",this.tokens=t.tokens??null,this.inlineClassName=t.inlineClassName||null,this.inlineClassNameAffectsLetterSpacing=t.inlineClassNameAffectsLetterSpacing||!1,this.attachedData=t.attachedData||null,this.cursorStops=t.cursorStops||null}},Ii=class r{static EMPTY;static register(t){return new r(t)}static createDynamic(t){return new r(t)}description;blockClassName;blockIsAfterEnd;blockDoesNotCollapse;blockPadding;stickiness;zIndex;className;shouldFillLineOnLineBreak;hoverMessage;glyphMarginHoverMessage;isWholeLine;showIfCollapsed;collapseOnReplaceEdit;overviewRuler;minimap;glyphMargin;glyphMarginClassName;linesDecorationsClassName;lineNumberClassName;lineNumberHoverMessage;linesDecorationsTooltip;firstLineDecorationClassName;marginClassName;inlineClassName;inlineClassNameAffectsLetterSpacing;beforeContentClassName;afterContentClassName;after;before;hideInCommentTokens;hideInStringTokens;constructor(t){this.description=t.description,this.blockClassName=t.blockClassName?$p(t.blockClassName):null,this.blockDoesNotCollapse=t.blockDoesNotCollapse??null,this.blockIsAfterEnd=t.blockIsAfterEnd??null,this.blockPadding=t.blockPadding??null,this.stickiness=t.stickiness||0,this.zIndex=t.zIndex||0,this.className=t.className?$p(t.className):null,this.shouldFillLineOnLineBreak=t.shouldFillLineOnLineBreak??null,this.hoverMessage=t.hoverMessage||null,this.glyphMarginHoverMessage=t.glyphMarginHoverMessage||null,this.lineNumberHoverMessage=t.lineNumberHoverMessage||null,this.isWholeLine=t.isWholeLine||!1,this.showIfCollapsed=t.showIfCollapsed||!1,this.collapseOnReplaceEdit=t.collapseOnReplaceEdit||!1,this.overviewRuler=t.overviewRuler?new T3(t.overviewRuler):null,this.minimap=t.minimap?new D3(t.minimap):null,this.glyphMargin=t.glyphMarginClassName?new _3(t.glyphMargin):null,this.glyphMarginClassName=t.glyphMarginClassName?$p(t.glyphMarginClassName):null,this.linesDecorationsClassName=t.linesDecorationsClassName?$p(t.linesDecorationsClassName):null,this.lineNumberClassName=t.lineNumberClassName?$p(t.lineNumberClassName):null,this.linesDecorationsTooltip=t.linesDecorationsTooltip?cee(t.linesDecorationsTooltip):null,this.firstLineDecorationClassName=t.firstLineDecorationClassName?$p(t.firstLineDecorationClassName):null,this.marginClassName=t.marginClassName?$p(t.marginClassName):null,this.inlineClassName=t.inlineClassName?$p(t.inlineClassName):null,this.inlineClassNameAffectsLetterSpacing=t.inlineClassNameAffectsLetterSpacing||!1,this.beforeContentClassName=t.beforeContentClassName?$p(t.beforeContentClassName):null,this.afterContentClassName=t.afterContentClassName?$p(t.afterContentClassName):null,this.after=t.after?Gf.from(t.after):null,this.before=t.before?Gf.from(t.before):null,this.hideInCommentTokens=t.hideInCommentTokens??!1,this.hideInStringTokens=t.hideInStringTokens??!1}};Ii.EMPTY=Ii.register({description:"empty"});var Ise=[Ii.register({description:"tracked-range-always-grows-when-typing-at-edges",stickiness:0}),Ii.register({description:"tracked-range-never-grows-when-typing-at-edges",stickiness:1}),Ii.register({description:"tracked-range-grows-only-when-typing-before",stickiness:2}),Ii.register({description:"tracked-range-grows-only-when-typing-after",stickiness:3})];function yse(r){return r instanceof Ii?r:Ii.createDynamic(r)}var k3=class extends R{constructor(e){super();this.handleBeforeFire=e;this._deferredCnt=0,this._shouldFireDeferred=!1,this._affectsMinimap=!1,this._affectsOverviewRuler=!1,this._affectsGlyphMargin=!1,this._affectsLineNumber=!1}_actual=this._register(new x);event=this._actual.event;_deferredCnt;_shouldFireDeferred;_affectsMinimap;_affectsOverviewRuler;_affectedInjectedTextLines=null;_affectsGlyphMargin;_affectsLineNumber;hasListeners(){return this._actual.hasListeners()}beginDeferredEmit(){this._deferredCnt++}endDeferredEmit(){this._deferredCnt--,this._deferredCnt===0&&(this._shouldFireDeferred&&this.doFire(),this._affectedInjectedTextLines?.clear(),this._affectedInjectedTextLines=null)}recordLineAffectedByInjectedText(e){this._affectedInjectedTextLines||(this._affectedInjectedTextLines=new Set),this._affectedInjectedTextLines.add(e)}checkAffectedAndFire(e){this._affectsMinimap||=!!e.minimap?.position,this._affectsOverviewRuler||=!!e.overviewRuler?.color,this._affectsGlyphMargin||=!!e.glyphMarginClassName,this._affectsLineNumber||=!!e.lineNumberClassName,this.tryFire()}fire(){this._affectsMinimap=!0,this._affectsOverviewRuler=!0,this._affectsGlyphMargin=!0,this.tryFire()}tryFire(){this._deferredCnt===0?this.doFire():this._shouldFireDeferred=!0}doFire(){this.handleBeforeFire(this._affectedInjectedTextLines);let e={affectsMinimap:this._affectsMinimap,affectsOverviewRuler:this._affectsOverviewRuler,affectsGlyphMargin:this._affectsGlyphMargin,affectsLineNumber:this._affectsLineNumber};this._shouldFireDeferred=!1,this._affectsMinimap=!1,this._affectsOverviewRuler=!1,this._affectsGlyphMargin=!1,this._actual.fire(e)}},L3=class extends R{_fastEmitter=this._register(new x);fastEvent=this._fastEmitter.event;_slowEmitter=this._register(new x);slowEvent=this._slowEmitter.event;_deferredCnt;_deferredEvent;constructor(){super(),this._deferredCnt=0,this._deferredEvent=null}hasListeners(){return this._fastEmitter.hasListeners()||this._slowEmitter.hasListeners()}beginDeferredEmit(){this._deferredCnt++}endDeferredEmit(t=null){if(this._deferredCnt--,this._deferredCnt===0&&this._deferredEvent!==null){this._deferredEvent.rawContentChangedEvent.resultingSelection=t;let e=this._deferredEvent;this._deferredEvent=null,this._fastEmitter.fire(e),this._slowEmitter.fire(e)}}fire(t){if(this._deferredCnt>0){this._deferredEvent?this._deferredEvent=this._deferredEvent.merge(t):this._deferredEvent=t;return}this._fastEmitter.fire(t),this._slowEmitter.fire(t)}};var qf=q("workingCopyService"),P3=class extends R{_onDidRegister=this._register(new x);onDidRegister=this._onDidRegister.event;_onDidUnregister=this._register(new x);onDidUnregister=this._onDidUnregister.event;_onDidChangeDirty=this._register(new x);onDidChangeDirty=this._onDidChangeDirty.event;_onDidChangeContent=this._register(new x);onDidChangeContent=this._onDidChangeContent.event;_onDidSave=this._register(new x);onDidSave=this._onDidSave.event;get workingCopies(){return Array.from(this._workingCopies.values())}_workingCopies=new Set;mapResourceToWorkingCopies=new Fn;mapWorkingCopyToListeners=this._register(new us);registerWorkingCopy(t){let e=this.mapResourceToWorkingCopies.get(t.resource);if(e?.has(t.typeId))throw new Error(`Cannot register more than one working copy with the same resource ${t.resource.toString()} and type ${t.typeId}.`);this._workingCopies.add(t),e||(e=new Map,this.mapResourceToWorkingCopies.set(t.resource,e)),e.set(t.typeId,t);let i=new B;return i.add(t.onDidChangeContent(()=>this._onDidChangeContent.fire(t))),i.add(t.onDidChangeDirty(()=>this._onDidChangeDirty.fire(t))),i.add(t.onDidSave(n=>this._onDidSave.fire({workingCopy:t,...n}))),this.mapWorkingCopyToListeners.set(t,i),this._onDidRegister.fire(t),t.isDirty()&&this._onDidChangeDirty.fire(t),le(()=>{this.unregisterWorkingCopy(t),this._onDidUnregister.fire(t)})}unregisterWorkingCopy(t){this._workingCopies.delete(t);let e=this.mapResourceToWorkingCopies.get(t.resource);e?.delete(t.typeId)&&e.size===0&&this.mapResourceToWorkingCopies.delete(t.resource),t.isDirty()&&this._onDidChangeDirty.fire(t),this.mapWorkingCopyToListeners.deleteAndDispose(t)}has(t){return Z.isUri(t)?this.mapResourceToWorkingCopies.has(t):this.mapResourceToWorkingCopies.get(t.resource)?.has(t.typeId)??!1}get(t){return this.mapResourceToWorkingCopies.get(t.resource)?.get(t.typeId)}getAll(t){let e=this.mapResourceToWorkingCopies.get(t);if(e)return Array.from(e.values())}get hasDirty(){for(let t of this._workingCopies)if(t.isDirty())return!0;return!1}get dirtyCount(){let t=0;for(let e of this._workingCopies)e.isDirty()&&t++;return t}get dirtyWorkingCopies(){return this.workingCopies.filter(t=>t.isDirty())}get modifiedCount(){let t=0;for(let e of this._workingCopies)e.isModified()&&t++;return t}get modifiedWorkingCopies(){return this.workingCopies.filter(t=>t.isModified())}isDirty(t,e){let i=this.mapResourceToWorkingCopies.get(t);if(i){if(typeof e=="string")return i.get(e)?.isDirty()??!1;for(let[,n]of i)if(n.isDirty())return!0}return!1}};gi(qf,P3,1);var hi=q("labelService");function jp(r,t=St){return D4(r,t)?r.charAt(0).toUpperCase()+r.slice(1):r}var M3=Object.create(null);function xse(r,t,e=Ys){if(e===1||!r||!t)return r;let i=M3.original===t?M3.normalized:void 0;i||(i=t,St&&(i=Yv(i)),i=`${Qg(i,Xt.sep)}${Xt.sep}`,M3={original:t,normalized:i});let n=r;return St&&(n=Yv(n)),(e===3?n.startsWith(i):bm(n,i))?`~/${n.substr(i.length)}`:r}var wse="\u2026",Dk="\\\\",kk="~";function UN(r,t=Ur){let e=new Array(r.length),i=!1;for(let n=0;n<r.length;n++){let o=r[n];if(o===""){e[n]=`.${t}`;continue}if(!o){e[n]=o;continue}i=!0;let s="",a=o;a.indexOf(Dk)===0?(s=a.substr(0,a.indexOf(Dk)+Dk.length),a=a.substr(a.indexOf(Dk)+Dk.length)):a.indexOf(t)===0?(s=a.substr(0,a.indexOf(t)+t.length),a=a.substr(a.indexOf(t)+t.length)):a.indexOf(kk)===0&&(s=a.substr(0,a.indexOf(kk)+kk.length),a=a.substr(a.indexOf(kk)+kk.length));let l=a.split(t);for(let d=1;i&&d<=l.length;d++)for(let c=l.length-d;i&&c>=0;c--){i=!1;let p=l.slice(c,c+d).join(t);for(let h=0;!i&&h<r.length;h++)if(h!==n&&r[h]&&r[h].indexOf(p)>-1){let m=c+d===l.length,f=c>0&&r[h].indexOf(t)>-1?t+p:p,g=r[h].endsWith(f);i=!m||g}if(!i){let h="";(l[0].endsWith(":")||s!=="")&&(c===1&&(c=0,d++,p=l[0]+t+p),c>0&&(h=l[0]+t),h=s+h),c>0&&(h=h+wse+t),h=h+p,c+d<l.length&&(h=h+t+wse),e[n]=h}}i&&(e[n]=o)}return e}function Tse(r,t=Object.create(null)){let e=[],i=!1,n="";for(let o of r)if(o==="$"||i&&o==="{")n&&e.push({value:n,type:0}),n="",i=!0;else if(o==="}"&&i){let s=t[n];if(typeof s=="string")s.length&&e.push({value:s,type:1});else if(s){let a=e[e.length-1];(!a||a.type!==2)&&e.push({value:s.label,type:2})}n="",i=!1}else n+=o;return n&&!i&&e.push({value:n,type:0}),e.filter((o,s)=>{if(o.type===2){let a=e[s-1],l=e[s+1];return[a,l].every(d=>d&&(d.type===1||d.type===0)&&d.value.length>0)}return!0}).map(o=>o.value).join("")}function zm(r,t){return ye||t?r.replace(/\(&&\w\)|&&/g,"").replace(/&/g,ye?"&":"&&"):r.replace(/&&|&/g,e=>e==="&"?"&&":"&")}function zN(r,t){return ye||t?r.replace(/\(&&\w\)|&&/g,""):St?r.replace(/&&|&/g,e=>e==="&"?"&&":"&"):r.replace(/&&/g,"_")}function _se(r){return r.replace(/&/g,"&&")}function Dse(r){if(r.endsWith("]")){let t=r.lastIndexOf(" [",r.length-2);if(t!==-1){let e=Ese(r.substring(0,t)),i=r.substring(t);return{name:e.name+i,parentPath:e.parentPath}}}return Ese(r)}function Ese(r){let t=r.indexOf("/")!==-1?Xt:Zn,e=t.basename(r),i=t.dirname(r);return e.length?{name:e,parentPath:i}:{name:i,parentPath:""}}var al=q("productService"),kse="vscode://schemas/vscode-product";var Io=q("dialogService");var Ta=q("fileDialogService");var Bl=class extends Lk{_onDidChangeDirty=this._register(new x);_onDidChangeLabel=this._register(new x);_onDidChangeCapabilities=this._register(new x);_onWillDispose=this._register(new x);onDidChangeDirty=this._onDidChangeDirty.event;onDidChangeLabel=this._onDidChangeLabel.event;onDidChangeCapabilities=this._onDidChangeCapabilities.event;onWillDispose=this._onWillDispose.event;closeHandler;get editorId(){}get capabilities(){return 2}hasCapability(t){return t===0?this.capabilities===0:(this.capabilities&t)!==0}isReadonly(){return this.hasCapability(2)}getName(){return`Editor ${this.typeId}`}getDescription(t){}getTitle(t){return this.getName()}getLabelExtraClasses(){return[]}getAriaLabel(){return this.getTitle(0)}getIcon(){}getTelemetryDescriptor(){return{typeId:this.typeId}}isDirty(){return!1}isModified(){return this.isDirty()}isSaving(){return!1}async resolve(){return null}async save(t,e){return this}async saveAs(t,e){return this}async revert(t,e){}async rename(t,e){}copy(){return this}canMove(t,e){return!0}matches(t){if(kr(t))return this===t;let e=t.options?.override;return this.editorId!==e&&e!==void 0&&this.editorId!==void 0?!1:zi(this.resource,ro.getCanonicalUri(t))}prefersEditorPane(t){return t.at(0)}toUntyped(t){}isDisposed(){return this._store.isDisposed}dispose(){this.isDisposed()||this._onWillDispose.fire(),super.dispose()}};var Fo=class extends Bl{constructor(e,i,n,o,s){super();this.preferredName=e;this.preferredDescription=i;this.secondary=n;this.primary=o;this.editorService=s;this.registerListeners()}static ID="workbench.editorinputs.sidebysideEditorInput";get typeId(){return Fo.ID}get capabilities(){let e=this.primary.capabilities;return e&=-33,this.secondary.hasCapability(16)&&(e|=16),this.secondary.hasCapability(8)&&(e|=8),e|=256,e}get resource(){if(this.hasIdenticalSides)return this.primary.resource}hasIdenticalSides=this.primary.matches(this.secondary);registerListeners(){this._register(X.once(X.any(this.primary.onWillDispose,this.secondary.onWillDispose))(()=>{this.isDisposed()||this.dispose()})),this._register(this.primary.onDidChangeDirty(()=>this._onDidChangeDirty.fire())),this._register(this.primary.onDidChangeCapabilities(()=>this._onDidChangeCapabilities.fire())),this._register(this.secondary.onDidChangeCapabilities(()=>this._onDidChangeCapabilities.fire())),this._register(this.primary.onDidChangeLabel(()=>this._onDidChangeLabel.fire())),this._register(this.secondary.onDidChangeLabel(()=>this._onDidChangeLabel.fire()))}getName(){let e=this.getPreferredName();return e||(this.hasIdenticalSides?this.primary.getName():u("sideBySideLabels","{0} - {1}",this.secondary.getName(),this.primary.getName()))}getPreferredName(){return this.preferredName}getDescription(e){let i=this.getPreferredDescription();return i||(this.hasIdenticalSides?this.primary.getDescription(e):super.getDescription(e))}getPreferredDescription(){return this.preferredDescription}getTitle(e){let i;this.hasIdenticalSides?i=this.primary.getTitle(e)??this.getName():i=super.getTitle(e);let n=this.getPreferredTitle();return n&&(i=`${n} (${i})`),i}getPreferredTitle(){if(this.preferredName&&this.preferredDescription)return`${this.preferredName} ${this.preferredDescription}`;if(this.preferredName||this.preferredDescription)return this.preferredName??this.preferredDescription}getLabelExtraClasses(){return this.hasIdenticalSides?this.primary.getLabelExtraClasses():super.getLabelExtraClasses()}getAriaLabel(){return this.hasIdenticalSides?this.primary.getAriaLabel():super.getAriaLabel()}getTelemetryDescriptor(){return{...this.primary.getTelemetryDescriptor(),...super.getTelemetryDescriptor()}}isDirty(){return this.primary.isDirty()}isSaving(){return this.primary.isSaving()}async save(e,i){let n=await this.primary.save(e,i);return this.saveResultToEditor(n)}async saveAs(e,i){let n=await this.primary.saveAs(e,i);return this.saveResultToEditor(n)}saveResultToEditor(e){if(!e||!this.hasIdenticalSides)return e;if(this.primary.matches(e))return this;if(e instanceof Bl)return new Fo(this.preferredName,this.preferredDescription,e,e,this.editorService);if(!kd(e)&&!nw(e)&&!Xp(e)&&!Yp(e))return{primary:e,secondary:e,label:this.preferredName,description:this.preferredDescription}}revert(e,i){return this.primary.revert(e,i)}async rename(e,i){if(!this.hasIdenticalSides)return;let n=await this.primary.rename(e,i);if(n){if(kr(n.editor))return{editor:new Fo(this.preferredName,this.preferredDescription,n.editor,n.editor,this.editorService),options:{...n.options,viewState:KN(this,e,this.editorService)}};if(Lse(n.editor))return{editor:{label:this.preferredName,description:this.preferredDescription,primary:n.editor,secondary:n.editor,options:{...n.options,viewState:KN(this,e,this.editorService)}}}}}isReadonly(){return this.primary.isReadonly()}toUntyped(e){let i=this.primary.toUntyped(e),n=this.secondary.toUntyped(e);if(i&&n&&!kd(i)&&!kd(n)&&!nw(i)&&!nw(n)&&!Xp(i)&&!Xp(n)&&!Yp(i)&&!Yp(n)){let o={label:this.preferredName,description:this.preferredDescription,primary:i,secondary:n};return typeof e?.preserveViewState=="number"&&(o.options={viewState:KN(this,e.preserveViewState,this.editorService)}),o}}matches(e){return this===e?!0:A3(e)||kd(e)?!1:e instanceof Fo?this.primary.matches(e.primary)&&this.secondary.matches(e.secondary):Xp(e)?this.primary.matches(e.primary)&&this.secondary.matches(e.secondary):!1}};Fo=E([b(4,$e)],Fo);var O3={LEFT:"left",RIGHT:"right",FIRST:"first",LAST:"last"};function Vye(r){let t=r;return!!(t&&typeof t=="object"&&Array.isArray(t.editors)&&Array.isArray(t.mru))}var Qp=class extends R{constructor(e,i,n){super();this.instantiationService=i;this.configurationService=n;Vye(e)?this._id=this.deserialize(e):this._id=Qp.IDS++,this.onConfigurationUpdated(),this.registerListeners()}static IDS=0;_onDidModelChange=this._register(new x({leakWarningThreshold:500}));onDidModelChange=this._onDidModelChange.event;_id;get id(){return this._id}editors=[];mru=[];editorListeners=new Set;locked=!1;selection=[];get active(){return this.selection[0]??null}preview=null;sticky=-1;transient=new Set;editorOpenPositioning;focusRecentEditorAfterClose;registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(e=>this.onConfigurationUpdated(e)))}onConfigurationUpdated(e){e&&!e.affectsConfiguration("workbench.editor.openPositioning")&&!e.affectsConfiguration("workbench.editor.focusRecentEditorAfterClose")||(this.editorOpenPositioning=this.configurationService.getValue("workbench.editor.openPositioning"),this.focusRecentEditorAfterClose=this.configurationService.getValue("workbench.editor.focusRecentEditorAfterClose"))}get count(){return this.editors.length}get stickyCount(){return this.sticky+1}getEditors(e,i){let n=e===0?this.mru.slice(0):this.editors.slice(0);return i?.excludeSticky?e===0?n.filter(o=>!this.isSticky(o)):n.slice(this.sticky+1):n}getEditorByIndex(e){return this.editors[e]}get activeEditor(){return this.active}isActive(e){return this.matches(this.active,e)}get previewEditor(){return this.preview}openEditor(e,i){let n=i?.sticky||typeof i?.index=="number"&&this.isSticky(i.index),o=i?.pinned||i?.sticky,s=!!i?.transient,a=i?.active||!this.activeEditor||!o&&this.preview===this.activeEditor,l=this.findEditor(e,i);if(l){let[d,c]=l;return this.doSetTransient(d,c,s===!1?!1:this.isTransient(d)),o&&this.doPin(d,c),this.setSelection(a?d:this.activeEditor,i?.inactiveSelection??[]),i&&typeof i.index=="number"&&this.moveEditor(d,i.index),n&&this.doStick(d,this.indexOf(d)),{editor:d,isNew:!1}}else{let d=e,c=this.indexOf(this.active),p;if(i&&typeof i.index=="number"?p=i.index:this.editorOpenPositioning===O3.FIRST?(p=0,!n&&this.isSticky(p)&&(p=this.sticky+1)):this.editorOpenPositioning===O3.LAST?p=this.editors.length:(this.editorOpenPositioning===O3.LEFT?c===0||!this.editors.length?p=0:p=c:p=c+1,!n&&this.isSticky(p)&&(p=this.sticky+1)),n&&(this.sticky++,this.isSticky(p)||(p=this.sticky)),(o||!this.preview)&&this.splice(p,!1,d),s&&this.doSetTransient(d,p,!0),!o){if(this.preview){let m=this.indexOf(this.preview);p>m&&p--,this.replaceEditor(this.preview,d,p,!a)}this.preview=d}this.registerEditorListeners(d);let h={kind:5,editor:d,editorIndex:p};return this._onDidModelChange.fire(h),this.setSelection(a?d:this.activeEditor,i?.inactiveSelection??[]),{editor:d,isNew:!0}}}registerEditorListeners(e){let i=new B;this.editorListeners.add(i),i.add(X.once(e.onWillDispose)(()=>{let n=this.editors.indexOf(e);if(n>=0){let o={kind:15,editor:e,editorIndex:n};this._onDidModelChange.fire(o)}})),i.add(e.onDidChangeDirty(()=>{let n={kind:14,editor:e,editorIndex:this.editors.indexOf(e)};this._onDidModelChange.fire(n)})),i.add(e.onDidChangeLabel(()=>{let n={kind:9,editor:e,editorIndex:this.editors.indexOf(e)};this._onDidModelChange.fire(n)})),i.add(e.onDidChangeCapabilities(()=>{let n={kind:10,editor:e,editorIndex:this.editors.indexOf(e)};this._onDidModelChange.fire(n)})),i.add(this.onDidModelChange(n=>{n.kind===6&&n.editor?.matches(e)&&(_e(i),this.editorListeners.delete(i))}))}replaceEditor(e,i,n,o=!0){let s=this.doCloseEditor(e,1,o);if(this.splice(n,!1,i),s){let a={kind:6,...s};this._onDidModelChange.fire(a)}}closeEditor(e,i=0,n=!0){let o=this.doCloseEditor(e,i,n);if(o){let s={kind:6,...o};return this._onDidModelChange.fire(s),o}}doCloseEditor(e,i,n){let o=this.indexOf(e);if(o===-1)return;let s=this.editors[o],a=this.isSticky(o),l=this.active===s;if(n&&l)if(this.mru.length>1){let d;this.focusRecentEditorAfterClose?d=this.mru[1]:o===this.editors.length-1?d=this.editors[o-1]:d=this.editors[o+1];let c=this.selection.filter(p=>p!==s&&p!==d);this.doSetSelection(d,this.editors.indexOf(d),c)}else this.doSetSelection(null,void 0,[]);else if(!l&&this.doIsSelected(s)){let d=this.selection.filter(c=>c!==s&&c!==this.activeEditor);this.doSetSelection(this.activeEditor,this.indexOf(this.activeEditor),d)}return this.preview===s&&(this.preview=null),this.transient.delete(s),this.splice(o,!0),{editor:s,sticky:a,editorIndex:o,context:i}}moveEditor(e,i){i>=this.editors.length?i=this.editors.length-1:i<0&&(i=0);let n=this.indexOf(e);if(n<0||i===n)return;let o=this.editors[n],s=this.sticky;this.isSticky(n)&&i>this.sticky?this.sticky--:!this.isSticky(n)&&i<=this.sticky&&this.sticky++,this.editors.splice(n,1),this.editors.splice(i,0,o);let a={kind:7,editor:o,oldEditorIndex:n,editorIndex:i};if(this._onDidModelChange.fire(a),s!==this.sticky){let l={kind:13,editor:o,editorIndex:i};this._onDidModelChange.fire(l)}return o}setActive(e){let i;return e?i=this.setEditorActive(e):this.setGroupActive(),i}setGroupActive(){this._onDidModelChange.fire({kind:0})}setEditorActive(e){let i=this.findEditor(e);if(!i)return;let[n,o]=i;return this.doSetSelection(n,o,[]),n}get selectedEditors(){return this.editors.filter(e=>this.doIsSelected(e))}isSelected(e){let i;return typeof e=="number"?i=this.editors[e]:i=this.findEditor(e)?.[0],!!i&&this.doIsSelected(i)}doIsSelected(e){return this.selection.includes(e)}setSelection(e,i){let n=this.findEditor(e);if(!n)return;let[o,s]=n,a=new Set;for(let l of i){let d=this.findEditor(l);if(!d)return;let[c]=d;c!==o&&a.add(c)}this.doSetSelection(o,s,Array.from(a))}doSetSelection(e,i,n){let o=this.activeEditor,s=this.selection,a;e?a=[e,...n]:a=[],this.selection=a;let l=e&&typeof i=="number"&&o!==e;if(l){let d=this.indexOf(e,this.mru);this.mru.splice(d,1),this.mru.unshift(e);let c={kind:8,editor:e,editorIndex:i};this._onDidModelChange.fire(c)}if(l||s.length!==a.length||s.some(d=>!a.includes(d))){let d={kind:4};this._onDidModelChange.fire(d)}}setIndex(e){this._onDidModelChange.fire({kind:1})}setLabel(e){this._onDidModelChange.fire({kind:2})}pin(e){let i=this.findEditor(e);if(!i)return;let[n,o]=i;return this.doPin(n,o),n}doPin(e,i){if(this.isPinned(e))return;this.setTransient(e,!1),this.preview=null;let n={kind:11,editor:e,editorIndex:i};this._onDidModelChange.fire(n)}unpin(e){let i=this.findEditor(e);if(!i)return;let[n,o]=i;return this.doUnpin(n,o),n}doUnpin(e,i){if(!this.isPinned(e))return;let n=this.preview;this.preview=e;let o={kind:11,editor:e,editorIndex:i};this._onDidModelChange.fire(o),n&&this.closeEditor(n,3)}isPinned(e){let i;return typeof e=="number"?i=this.editors[e]:i=e,!this.matches(this.preview,i)}stick(e){let i=this.findEditor(e);if(!i)return;let[n,o]=i;return this.doStick(n,o),n}doStick(e,i){if(this.isSticky(i))return;this.pin(e);let n=this.sticky+1;this.moveEditor(e,n),this.sticky++;let o={kind:13,editor:e,editorIndex:n};this._onDidModelChange.fire(o)}unstick(e){let i=this.findEditor(e);if(!i)return;let[n,o]=i;return this.doUnstick(n,o),n}doUnstick(e,i){if(!this.isSticky(i))return;let n=this.sticky;this.moveEditor(e,n),this.sticky--;let o={kind:13,editor:e,editorIndex:n};this._onDidModelChange.fire(o)}isSticky(e){if(this.sticky<0)return!1;let i;return typeof e=="number"?i=e:i=this.indexOf(e),i<0?!1:i<=this.sticky}setTransient(e,i){if(!i&&this.transient.size===0)return;let n=this.findEditor(e);if(!n)return;let[o,s]=n;return this.doSetTransient(o,s,i),o}doSetTransient(e,i,n){if(n){if(this.transient.has(e))return;this.transient.add(e)}else{if(!this.transient.has(e))return;this.transient.delete(e)}let o={kind:12,editor:e,editorIndex:i};this._onDidModelChange.fire(o)}isTransient(e){if(this.transient.size===0)return!1;let i;return typeof e=="number"?i=this.editors[e]:i=this.findEditor(e)?.[0],!!i&&this.transient.has(i)}splice(e,i,n){let o=this.editors[e];if(i&&this.isSticky(e)&&this.sticky--,n?this.editors.splice(e,i?1:0,n):this.editors.splice(e,i?1:0),!i&&n)this.mru.length===0?this.mru.push(n):this.mru.splice(1,0,n);else{let s=this.indexOf(o,this.mru);i&&!n?this.mru.splice(s,1):i&&n&&this.mru.splice(s,1,n)}}indexOf(e,i=this.editors,n){let o=-1;if(!e)return o;for(let s=0;s<i.length;s++){let a=i[s];if(this.matches(a,e,n))if(n?.supportSideBySide&&a instanceof Fo&&!(e instanceof Fo))o=s;else{o=s;break}}return o}findEditor(e,i){let n=this.indexOf(e,this.editors,i);if(n!==-1)return[this.editors[n],n]}isFirst(e,i=this.editors){return this.matches(i[0],e)}isLast(e,i=this.editors){return this.matches(i[i.length-1],e)}contains(e,i){return this.indexOf(e,this.editors,i)!==-1}matches(e,i,n){if(!e||!i)return!1;if(n?.supportSideBySide&&e instanceof Fo&&!(i instanceof Fo))switch(n.supportSideBySide){case 4:if(this.matches(e.primary,i,n)||this.matches(e.secondary,i,n))return!0;break;case 3:if(this.matches(e.primary,i,n)&&this.matches(e.secondary,i,n))return!0;break}let o=e===i;return n?.strictEquals?o:o||e.matches(i)}get isLocked(){return this.locked}lock(e){this.isLocked!==e&&(this.locked=e,this._onDidModelChange.fire({kind:3}))}clone(){let e=this.instantiationService.createInstance(Qp,void 0);e.editors=this.editors.slice(0),e.mru=this.mru.slice(0),e.preview=this.preview,e.selection=this.selection.slice(0),e.sticky=this.sticky;for(let i of e.editors)e.registerEditorListeners(i);return e}serialize(){let e=Pe.as(Ld.EditorFactory),i=[],n=[],o,s=this.sticky;for(let l=0;l<this.editors.length;l++){let d=this.editors[l],c=!1,p=e.getEditorSerializer(d);if(p){let h=p.canSerialize(d)?p.serialize(d):void 0;typeof h=="string"?(c=!0,n.push({id:d.typeId,value:h}),i.push(d),this.preview===d&&(o=i.length-1)):c=!1}!c&&this.isSticky(l)&&s--}let a=this.mru.map(l=>this.indexOf(l,i)).filter(l=>l>=0);return{id:this.id,locked:this.locked?!0:void 0,editors:n,mru:a,preview:o,sticky:s>=0?s:void 0}}deserialize(e){let i=Pe.as(Ld.EditorFactory);return typeof e.id=="number"?(this._id=e.id,Qp.IDS=Math.max(e.id+1,Qp.IDS)):this._id=Qp.IDS++,e.locked&&(this.locked=!0),this.editors=cn(e.editors.map((n,o)=>{let s,a=i.getEditorSerializer(n.id);if(a){let l=a.deserialize(this.instantiationService,n.value);l instanceof Bl&&(s=l,this.registerEditorListeners(s))}return!s&&typeof e.sticky=="number"&&o<=e.sticky&&e.sticky--,s})),this.mru=cn(e.mru.map(n=>this.editors[n])),this.selection=this.mru.length>0?[this.mru[0]]:[],typeof e.preview=="number"&&(this.preview=this.editors[e.preview]),typeof e.sticky=="number"&&(this.sticky=e.sticky),this._id}dispose(){_e(Array.from(this.editorListeners)),this.editorListeners.clear(),this.transient.clear(),super.dispose()}};Qp=E([b(1,ne),b(2,se)],Qp);var Rk={exports:{}};(function(){function t(o){let s=[];typeof o=="number"&&s.push("code/timeOrigin",o);function a(d){s.push(d,Date.now())}function l(){let d=[];for(let c=0;c<s.length;c+=2)d.push({name:s[c],startTime:s[c+1]});return d}return{mark:a,getMarks:l}}function e(){if(typeof performance=="object"&&typeof performance.mark=="function"&&!performance.nodeTiming)return typeof performance.timeOrigin!="number"&&!performance.timing?t():{mark(o){performance.mark(o)},getMarks(){let o=performance.timeOrigin;typeof o!="number"&&(o=performance.timing.navigationStart||performance.timing.redirectStart||performance.timing.fetchStart);let s=[{name:"code/timeOrigin",startTime:Math.round(o)}];for(let a of performance.getEntriesByType("mark"))s.push({name:a.name,startTime:Math.round(o+a.startTime)});return s}};if(typeof process=="object"){let o=performance?.timeOrigin;return t(o)}else return console.trace("perf-util loaded in UNKNOWN environment"),t()}function i(o){return o.MonacoPerformanceMarks||(o.MonacoPerformanceMarks=e()),o.MonacoPerformanceMarks}var n;typeof global=="object"?n=global:typeof self=="object"?n=self:n={},typeof Rk=="object"&&typeof Rk.exports=="object"?Rk.exports=i(n):(console.trace("perf-util defined in UNKNOWN context (neither requirejs or commonjs)"),n.perf=i(n))})();var fr=Rk.exports.mark,Aut=Rk.exports.getMarks;var zn=q("IUriIdentityService");function Rse(r){let t=r;return!!(t&&typeof t=="object"&&typeof t.id=="string"&&typeof t.isDefault=="boolean"&&typeof t.name=="string"&&Z.isUri(t.location)&&Z.isUri(t.globalStorageHome)&&Z.isUri(t.settingsResource)&&Z.isUri(t.keybindingsResource)&&Z.isUri(t.tasksResource)&&Z.isUri(t.snippetsHome)&&Z.isUri(t.extensionsResource))}var Pse=q("IUserDataProfilesService");function GN(r,t,e,i,n,o){return{id:r,name:t,location:e,isDefault:!1,shortName:n?.shortName,icon:n?.icon,globalStorageHome:o&&n?.useDefaultFlags?.globalState?o.globalStorageHome:pi(e,"globalStorage"),settingsResource:o&&n?.useDefaultFlags?.settings?o.settingsResource:pi(e,"settings.json"),keybindingsResource:o&&n?.useDefaultFlags?.keybindings?o.keybindingsResource:pi(e,"keybindings.json"),tasksResource:o&&n?.useDefaultFlags?.tasks?o.tasksResource:pi(e,"tasks.json"),snippetsHome:o&&n?.useDefaultFlags?.snippets?o.snippetsHome:pi(e,"snippets"),extensionsResource:o&&n?.useDefaultFlags?.extensions?o.extensionsResource:pi(e,"extensions.json"),cacheHome:pi(i,r),useDefaultFlags:n?.useDefaultFlags,isTransient:n?.transient}}var qN=class extends R{constructor(e,i,n,o){super();this.environmentService=e;this.fileService=i;this.uriIdentityService=n;this.logService=o;this.profilesHome=pi(this.environmentService.userRoamingDataHome,"profiles"),this.profilesCacheHome=pi(this.environmentService.cacheHome,"CachedProfilesData")}static PROFILES_KEY="userDataProfiles";static PROFILE_ASSOCIATIONS_KEY="profileAssociations";_serviceBrand;enabled=!0;profilesHome;profilesCacheHome;get defaultProfile(){return this.profiles[0]}get profiles(){return[...this.profilesObject.profiles,...this.transientProfilesObject.profiles]}_onDidChangeProfiles=this._register(new x);onDidChangeProfiles=this._onDidChangeProfiles.event;_onWillCreateProfile=this._register(new x);onWillCreateProfile=this._onWillCreateProfile.event;_onWillRemoveProfile=this._register(new x);onWillRemoveProfile=this._onWillRemoveProfile.event;_onDidResetWorkspaces=this._register(new x);onDidResetWorkspaces=this._onDidResetWorkspaces.event;profileCreationPromises=new Map;transientProfilesObject={profiles:[],folders:new Fn,workspaces:new Fn,emptyWindows:new Map};init(){this._profilesObject=void 0}setEnablement(e){this.enabled!==e&&(this._profilesObject=void 0,this.enabled=e)}isEnabled(){return this.enabled}_profilesObject;get profilesObject(){if(!this._profilesObject){let e=this.createDefaultProfile(),i=[e];if(this.enabled)try{for(let s of this.getStoredProfiles()){if(!s.name||!Bt(s.name)||!s.location){this.logService.warn("Skipping the invalid stored profile",s.location||s.name);continue}i.push(GN(Ji(s.location),s.name,s.location,this.profilesCacheHome,{shortName:s.shortName,icon:s.icon,useDefaultFlags:s.useDefaultFlags},e))}}catch(s){this.logService.error(s)}let n=new Fn,o=new Map;if(i.length)try{let s=this.getStoredProfileAssociations();if(s.workspaces)for(let[a,l]of Object.entries(s.workspaces)){let d=Z.parse(a),c=i.find(p=>p.id===l);c&&n.set(d,c)}if(s.emptyWindows)for(let[a,l]of Object.entries(s.emptyWindows)){let d=i.find(c=>c.id===l);d&&o.set(a,d)}}catch(s){this.logService.error(s)}this._profilesObject={profiles:i,workspaces:n,emptyWindows:o}}return this._profilesObject}createDefaultProfile(){let e=GN("__default__profile__",u("defaultProfile","Default"),this.environmentService.userRoamingDataHome,this.profilesCacheHome);return{...e,extensionsResource:this.getDefaultProfileExtensionsLocation()??e.extensionsResource,isDefault:!0}}async createTransientProfile(e){let i="Temp",n=new RegExp(`${ba(i)}\\s(\\d+)`),o=0;for(let a of this.profiles){let l=n.exec(a.name),d=l?parseInt(l[1]):0;o=d>o?d:o}let s=`${i} ${o+1}`;return this.createProfile(wr(Ni()).toString(16),s,{transient:!0},e)}async createNamedProfile(e,i,n){return this.createProfile(wr(Ni()).toString(16),e,i,n)}async createProfile(e,i,n,o){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");let s=await this.doCreateProfile(e,i,n);return o&&await this.setProfileForWorkspace(o,s),s}async doCreateProfile(e,i,n){if(!Bt(i)||!i)throw new Error("Name of the profile is mandatory and must be of type `string`");let o=this.profileCreationPromises.get(i);return o||(o=(async()=>{try{if(this.profiles.find(d=>d.name===i||d.id===e))throw new Error(`Profile with ${i} name already exists`);let a=GN(e,i,pi(this.profilesHome,e),this.profilesCacheHome,n,this.defaultProfile);await this.fileService.createFolder(a.location);let l=[];return this._onWillCreateProfile.fire({profile:a,join(d){l.push(d)}}),await Xa.settled(l),this.updateProfiles([a],[],[]),a}finally{this.profileCreationPromises.delete(i)}})(),this.profileCreationPromises.set(i,o)),o}async updateProfile(e,i){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");let n=this.profiles.find(o=>o.id===e.id);if(!n)throw new Error(`Profile '${e.name}' does not exist`);return n=GN(n.id,i.name??n.name,n.location,this.profilesCacheHome,{shortName:i.shortName??n.shortName,icon:i.icon===null?void 0:i.icon??n.icon,transient:i.transient??n.isTransient,useDefaultFlags:i.useDefaultFlags??n.useDefaultFlags},this.defaultProfile),this.updateProfiles([],[],[n]),n}async removeProfile(e){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");if(e.isDefault)throw new Error("Cannot remove default profile");let i=this.profiles.find(o=>o.id===e.id);if(!i)throw new Error(`Profile '${e.name}' does not exist`);let n=[];this._onWillRemoveProfile.fire({profile:i,join(o){n.push(o)}});try{await Promise.allSettled(n)}catch(o){this.logService.error(o)}for(let o of[...this.profilesObject.emptyWindows.keys()])i.id===this.profilesObject.emptyWindows.get(o)?.id&&this.profilesObject.emptyWindows.delete(o);for(let o of[...this.profilesObject.workspaces.keys()])i.id===this.profilesObject.workspaces.get(o)?.id&&this.profilesObject.workspaces.delete(o);this.updateStoredProfileAssociations(),this.updateProfiles([],[i],[]);try{await this.fileService.del(i.cacheHome,{recursive:!0})}catch(o){hre(o)!==1&&this.logService.error(o)}}async setProfileForWorkspace(e,i){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");let n=this.profiles.find(o=>o.id===i.id);if(!n)throw new Error(`Profile '${i.name}' does not exist`);this.updateWorkspaceAssociation(e,n)}unsetWorkspace(e,i){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");this.updateWorkspaceAssociation(e,void 0,i)}async resetWorkspaces(){this.transientProfilesObject.folders.clear(),this.transientProfilesObject.workspaces.clear(),this.transientProfilesObject.emptyWindows.clear(),this.profilesObject.workspaces.clear(),this.profilesObject.emptyWindows.clear(),this.updateStoredProfileAssociations(),this._onDidResetWorkspaces.fire()}async cleanUp(){if(this.enabled&&await this.fileService.exists(this.profilesHome)){let e=await this.fileService.resolve(this.profilesHome);await Promise.all((e.children||[]).filter(i=>i.isDirectory&&this.profiles.every(n=>!this.uriIdentityService.extUri.isEqual(n.location,i.resource))).map(i=>this.fileService.del(i.resource,{recursive:!0})))}}async cleanUpTransientProfiles(){if(!this.enabled)return;let e=this.transientProfilesObject.profiles.filter(i=>!this.isProfileAssociatedToWorkspace(i));await Promise.allSettled(e.map(i=>this.removeProfile(i)))}getProfileForWorkspace(e){let i=this.getWorkspace(e),n=Z.isUri(i)?this.profilesObject.workspaces.get(i):this.profilesObject.emptyWindows.get(i);return n||(bf(e)?this.transientProfilesObject.folders.get(e.uri):TD(e)?this.transientProfilesObject.workspaces.get(e.configPath):this.transientProfilesObject.emptyWindows.get(e.id))}getWorkspace(e){return bf(e)?e.uri:TD(e)?e.configPath:e.id}isProfileAssociatedToWorkspace(e){return!!([...this.profilesObject.emptyWindows.values()].some(i=>this.uriIdentityService.extUri.isEqual(i.location,e.location))||[...this.profilesObject.workspaces.values()].some(i=>this.uriIdentityService.extUri.isEqual(i.location,e.location))||[...this.transientProfilesObject.emptyWindows.values()].some(i=>this.uriIdentityService.extUri.isEqual(i.location,e.location))||[...this.transientProfilesObject.workspaces.values()].some(i=>this.uriIdentityService.extUri.isEqual(i.location,e.location))||[...this.transientProfilesObject.folders.values()].some(i=>this.uriIdentityService.extUri.isEqual(i.location,e.location)))}updateProfiles(e,i,n){let o=[...this.profiles,...e],s=[],a=this.transientProfilesObject.profiles;this.transientProfilesObject.profiles=[];for(let l of o){if(l.isDefault||i.some(c=>l.id===c.id))continue;l=n.find(c=>l.id===c.id)??l;let d=a.find(c=>l.id===c.id);if(l.isTransient)this.transientProfilesObject.profiles.push(l);else{if(d){for(let[c,p]of this.transientProfilesObject.emptyWindows.entries())if(l.id===p.id){this.updateWorkspaceAssociation({id:c},l);break}for(let[c,p]of this.transientProfilesObject.workspaces.entries())if(l.id===p.id){this.updateWorkspaceAssociation({id:"",configPath:c},l);break}for(let[c,p]of this.transientProfilesObject.folders.entries())if(l.id===p.id){this.updateWorkspaceAssociation({id:"",uri:c},l);break}}s.push({location:l.location,name:l.name,shortName:l.shortName,icon:l.icon,useDefaultFlags:l.useDefaultFlags})}}this.saveStoredProfiles(s),this._profilesObject=void 0,this.triggerProfilesChanges(e,i,n)}triggerProfilesChanges(e,i,n){this._onDidChangeProfiles.fire({added:e,removed:i,updated:n,all:this.profiles})}updateWorkspaceAssociation(e,i,n){if(n=i?.isTransient?!0:n,n)bf(e)?(this.transientProfilesObject.folders.delete(e.uri),i&&this.transientProfilesObject.folders.set(e.uri,i)):TD(e)?(this.transientProfilesObject.workspaces.delete(e.configPath),i&&this.transientProfilesObject.workspaces.set(e.configPath,i)):(this.transientProfilesObject.emptyWindows.delete(e.id),i&&this.transientProfilesObject.emptyWindows.set(e.id,i));else{this.updateWorkspaceAssociation(e,void 0,!0);let o=this.getWorkspace(e);Z.isUri(o)?(this.profilesObject.workspaces.delete(o),i&&this.profilesObject.workspaces.set(o,i)):(this.profilesObject.emptyWindows.delete(o),i&&this.profilesObject.emptyWindows.set(o,i)),this.updateStoredProfileAssociations()}}updateStoredProfileAssociations(){let e={};for(let[n,o]of this.profilesObject.workspaces.entries())e[n.toString()]=o.id;let i={};for(let[n,o]of this.profilesObject.emptyWindows.entries())i[n.toString()]=o.id;this.saveStoredProfileAssociations({workspaces:e,emptyWindows:i}),this._profilesObject=void 0}migrateStoredProfileAssociations(e){let i={},n=this.createDefaultProfile();if(e.workspaces)for(let[s,a]of Object.entries(e.workspaces)){let l=Z.parse(a);i[s]=this.uriIdentityService.extUri.isEqual(l,n.location)?n.id:this.uriIdentityService.extUri.basename(l)}let o={};if(e.emptyWindows)for(let[s,a]of Object.entries(e.emptyWindows)){let l=Z.parse(a);o[s]=this.uriIdentityService.extUri.isEqual(l,n.location)?n.id:this.uriIdentityService.extUri.basename(l)}return{workspaces:i,emptyWindows:o}}getStoredProfiles(){return[]}saveStoredProfiles(e){throw new Error("not implemented")}getStoredProfileAssociations(){return{}}saveStoredProfileAssociations(e){throw new Error("not implemented")}getDefaultProfileExtensionsLocation(){}};qN=E([b(0,$o),b(1,Ei),b(2,zn),b(3,bt)],qN);var F3={WIDTH:400,WIDTH_WITH_VERTICAL_PANEL:600,HEIGHT:270};function ow(r){let t=Gm(r),e=r.getValue("window.menuBarVisibility");return e==="default"||t&&e==="compact"||ye&&Po?"classic":e}function rw(r,t){return!0}function Gm(r,t){return t||(t=B3(r)),t==="native"}function B3(r){if(si)return"custom";let t=r.getValue("window");if(t){if(ye&&t.nativeTabs===!0||ye&&t.nativeFullScreen===!1)return"native";let n=t.titleBarStyle;if(n==="native"||n==="custom")return n}return ci?"native":"custom"}var Mse=35;var gn=q("editorGroupsService");var $e=q("editorService"),Zp=-1,Vl=-2;var V3=class{constructor(t,e,i){this.id=t;this.dependencies=e;this.callback=i}};var Ase=class r{static INSTANCE=new r;_isWebWorker=typeof self=="object"&&self.constructor&&self.constructor.name==="DedicatedWorkerGlobalScope";_isRenderer=typeof document=="object";_defineCalls=[];_state=1;_amdPolicy;constructor(){}_initialize(){if(this._state===1){if(globalThis.define){console.log("[amdX] AMD loader already present externally"),this._state=3;return}}else return;this._state=2,globalThis.define=(t,e,i)=>{typeof t!="string"&&(i=e,e=t,t=null),(typeof e!="object"||!Array.isArray(e))&&(i=e,e=null),this._defineCalls.push(new V3(t,e,i))},globalThis.define.amd=!0,this._isRenderer?this._amdPolicy=globalThis._VSCODE_WEB_PACKAGE_TTP??window.trustedTypes?.createPolicy("amdLoader",{createScriptURL(t){if(t.startsWith(window.location.origin)||t.startsWith(`${Ie.vscodeFileResource}://${C4}`))return t;throw new Error(`[trusted_script_src] Invalid script url: ${t}`)}}):this._isWebWorker&&(this._amdPolicy=globalThis._VSCODE_WEB_PACKAGE_TTP??globalThis.trustedTypes?.createPolicy("amdLoader",{createScriptURL(t){return t}}))}async load(t){if(this._initialize(),this._state===3)return new Promise(s=>{let a=Ni();console.log(`[amdX] Using external define("${a}", ["${t}"])`),globalThis.define(a,[t],function(l){console.log(`[amdX] Got a result for ${a}: ${!!l}`),s(l)})});let e=await(this._isWebWorker?this._workerLoadScript(t):this._isRenderer?this._rendererLoadScript(t):this._nodeJSLoadScript(t));if(!e){console.warn(`Did not receive a define call from script ${t}`);return}let i={},n=[],o=[];if(Array.isArray(e.dependencies))for(let s of e.dependencies)s==="exports"?n.push(i):o.push(s);if(o.length>0)throw new Error(`Cannot resolve dependencies for script ${t}. The dependencies are: ${o.join(", ")}`);return typeof e.callback=="function"?e.callback(...n)??i:e.callback}_rendererLoadScript(t){return new Promise((e,i)=>{let n=document.createElement("script");n.setAttribute("async","async"),n.setAttribute("type","text/javascript");let o=()=>{n.removeEventListener("load",s),n.removeEventListener("error",a)},s=l=>{o(),e(this._defineCalls.pop())},a=l=>{o(),i(l)};n.addEventListener("load",s),n.addEventListener("error",a),this._amdPolicy&&(t=this._amdPolicy.createScriptURL(t)),n.setAttribute("src",t),window.document.getElementsByTagName("head")[0].appendChild(n)})}async _workerLoadScript(t){return this._amdPolicy&&(t=this._amdPolicy.createScriptURL(t)),await import(t),this._defineCalls.pop()}async _nodeJSLoadScript(t){try{let e=(await import("fs")).default,i=(await import("vm")).default,n=(await import("module")).default,o=Z.parse(t).fsPath,s=e.readFileSync(o).toString(),a=n.wrap(s.replace(/^#!.*/,""));return new i.Script(a).runInThisContext().apply(),this._defineCalls.pop()}catch(e){throw e}}};var H3="utf8";var jmt=512*8,Xmt=512*128;var W3={utf8:{labelLong:"UTF-8",labelShort:"UTF-8",order:1,alias:"utf8bom",guessableName:"UTF-8"},utf8bom:{labelLong:"UTF-8 with BOM",labelShort:"UTF-8 with BOM",encodeOnly:!0,order:2,alias:"utf8"},utf16le:{labelLong:"UTF-16 LE",labelShort:"UTF-16 LE",order:3,guessableName:"UTF-16LE"},utf16be:{labelLong:"UTF-16 BE",labelShort:"UTF-16 BE",order:4,guessableName:"UTF-16BE"},windows1252:{labelLong:"Western (Windows 1252)",labelShort:"Windows 1252",order:5,guessableName:"windows-1252"},iso88591:{labelLong:"Western (ISO 8859-1)",labelShort:"ISO 8859-1",order:6},iso88593:{labelLong:"Western (ISO 8859-3)",labelShort:"ISO 8859-3",order:7},iso885915:{labelLong:"Western (ISO 8859-15)",labelShort:"ISO 8859-15",order:8},macroman:{labelLong:"Western (Mac Roman)",labelShort:"Mac Roman",order:9},cp437:{labelLong:"DOS (CP 437)",labelShort:"CP437",order:10},windows1256:{labelLong:"Arabic (Windows 1256)",labelShort:"Windows 1256",order:11},iso88596:{labelLong:"Arabic (ISO 8859-6)",labelShort:"ISO 8859-6",order:12},windows1257:{labelLong:"Baltic (Windows 1257)",labelShort:"Windows 1257",order:13},iso88594:{labelLong:"Baltic (ISO 8859-4)",labelShort:"ISO 8859-4",order:14},iso885914:{labelLong:"Celtic (ISO 8859-14)",labelShort:"ISO 8859-14",order:15},windows1250:{labelLong:"Central European (Windows 1250)",labelShort:"Windows 1250",order:16,guessableName:"windows-1250"},iso88592:{labelLong:"Central European (ISO 8859-2)",labelShort:"ISO 8859-2",order:17,guessableName:"ISO-8859-2"},cp852:{labelLong:"Central European (CP 852)",labelShort:"CP 852",order:18},windows1251:{labelLong:"Cyrillic (Windows 1251)",labelShort:"Windows 1251",order:19,guessableName:"windows-1251"},cp866:{labelLong:"Cyrillic (CP 866)",labelShort:"CP 866",order:20,guessableName:"IBM866"},iso88595:{labelLong:"Cyrillic (ISO 8859-5)",labelShort:"ISO 8859-5",order:21,guessableName:"ISO-8859-5"},koi8r:{labelLong:"Cyrillic (KOI8-R)",labelShort:"KOI8-R",order:22,guessableName:"KOI8-R"},koi8u:{labelLong:"Cyrillic (KOI8-U)",labelShort:"KOI8-U",order:23},iso885913:{labelLong:"Estonian (ISO 8859-13)",labelShort:"ISO 8859-13",order:24},windows1253:{labelLong:"Greek (Windows 1253)",labelShort:"Windows 1253",order:25,guessableName:"windows-1253"},iso88597:{labelLong:"Greek (ISO 8859-7)",labelShort:"ISO 8859-7",order:26,guessableName:"ISO-8859-7"},windows1255:{labelLong:"Hebrew (Windows 1255)",labelShort:"Windows 1255",order:27,guessableName:"windows-1255"},iso88598:{labelLong:"Hebrew (ISO 8859-8)",labelShort:"ISO 8859-8",order:28,guessableName:"ISO-8859-8"},iso885910:{labelLong:"Nordic (ISO 8859-10)",labelShort:"ISO 8859-10",order:29},iso885916:{labelLong:"Romanian (ISO 8859-16)",labelShort:"ISO 8859-16",order:30},windows1254:{labelLong:"Turkish (Windows 1254)",labelShort:"Windows 1254",order:31},iso88599:{labelLong:"Turkish (ISO 8859-9)",labelShort:"ISO 8859-9",order:32},windows1258:{labelLong:"Vietnamese (Windows 1258)",labelShort:"Windows 1258",order:33},gbk:{labelLong:"Simplified Chinese (GBK)",labelShort:"GBK",order:34},gb18030:{labelLong:"Simplified Chinese (GB18030)",labelShort:"GB18030",order:35},cp950:{labelLong:"Traditional Chinese (Big5)",labelShort:"Big5",order:36,guessableName:"Big5"},big5hkscs:{labelLong:"Traditional Chinese (Big5-HKSCS)",labelShort:"Big5-HKSCS",order:37},shiftjis:{labelLong:"Japanese (Shift JIS)",labelShort:"Shift JIS",order:38,guessableName:"SHIFT_JIS"},eucjp:{labelLong:"Japanese (EUC-JP)",labelShort:"EUC-JP",order:39,guessableName:"EUC-JP"},euckr:{labelLong:"Korean (EUC-KR)",labelShort:"EUC-KR",order:40,guessableName:"EUC-KR"},windows874:{labelLong:"Thai (Windows 874)",labelShort:"Windows 874",order:41},iso885911:{labelLong:"Latin/Thai (ISO 8859-11)",labelShort:"ISO 8859-11",order:42},koi8ru:{labelLong:"Cyrillic (KOI8-RU)",labelShort:"KOI8-RU",order:43},koi8t:{labelLong:"Tajik (KOI8-T)",labelShort:"KOI8-T",order:44},gb2312:{labelLong:"Simplified Chinese (GB 2312)",labelShort:"GB 2312",order:45,guessableName:"GB2312"},cp865:{labelLong:"Nordic DOS (CP 865)",labelShort:"CP 865",order:46},cp850:{labelLong:"Western European DOS (CP 850)",labelShort:"CP 850",order:47}},Ymt=(()=>{let r={};for(let t in W3)W3[t].guessableName&&(r[t]=W3[t]);return r})();var Su=class extends vu{constructor(e,i,n,o,s,a,l,d,c,p,h,m,f,g,v){super(l,a,g,v);this.resource=e;this.hasAssociatedFilePath=i;this.initialValue=n;this.preferredLanguageId=o;this.preferredEncoding=s;this.workingCopyBackupService=d;this.textResourceConfigurationService=c;this.workingCopyService=p;this.textFileService=h;this.labelService=m;this.editorService=f;this._register(this.workingCopyService.registerWorkingCopy(this)),o&&this.setLanguageId(o),this.onConfigurationChange(void 0,!1),this.registerListeners()}static FIRST_LINE_NAME_MAX_LENGTH=40;static FIRST_LINE_NAME_CANDIDATE_MAX_LENGTH=this.FIRST_LINE_NAME_MAX_LENGTH*10;static ACTIVE_EDITOR_LANGUAGE_ID="${activeEditorLanguage}";_onDidChangeContent=this._register(new x);onDidChangeContent=this._onDidChangeContent.event;_onDidChangeName=this._register(new x);onDidChangeName=this._onDidChangeName.event;_onDidChangeDirty=this._register(new x);onDidChangeDirty=this._onDidChangeDirty.event;_onDidChangeEncoding=this._register(new x);onDidChangeEncoding=this._onDidChangeEncoding.event;_onDidSave=this._register(new x);onDidSave=this._onDidSave.event;_onDidRevert=this._register(new x);onDidRevert=this._onDidRevert.event;typeId=bre;capabilities=2;configuredLabelFormat="content";cachedModelFirstLineWords=void 0;get name(){return this.configuredLabelFormat==="content"&&!this.hasAssociatedFilePath&&this.cachedModelFirstLineWords?this.cachedModelFirstLineWords:this.labelService.getUriBasenameLabel(this.resource)}registerListeners(){this._register(this.textResourceConfigurationService.onDidChangeConfiguration(e=>this.onConfigurationChange(e,!0)))}onConfigurationChange(e,i){if(!e||e.affectsConfiguration(this.resource,"files.encoding")){let n=this.textResourceConfigurationService.getValue(this.resource,"files.encoding");this.configuredEncoding!==n&&typeof n=="string"&&(this.configuredEncoding=n,i&&!this.preferredEncoding&&this._onDidChangeEncoding.fire())}if(!e||e.affectsConfiguration(this.resource,"workbench.editor.untitled.labelFormat")){let n=this.textResourceConfigurationService.getValue(this.resource,"workbench.editor.untitled.labelFormat");this.configuredLabelFormat!==n&&(n==="content"||n==="name")&&(this.configuredLabelFormat=n,i&&this._onDidChangeName.fire())}}setLanguageId(e,i){let n=e===Su.ACTIVE_EDITOR_LANGUAGE_ID?this.editorService.activeTextEditorLanguageId:e;this.preferredLanguageId=n,n&&super.setLanguageId(n,i)}getLanguageId(){return this.textEditorModel?this.textEditorModel.getLanguageId():this.preferredLanguageId}configuredEncoding;getEncoding(){return this.preferredEncoding||this.configuredEncoding}async setEncoding(e){let i=this.getEncoding();this.preferredEncoding=e,i!==this.preferredEncoding&&this._onDidChangeEncoding.fire()}dirty=this.hasAssociatedFilePath||!!this.initialValue;isDirty(){return this.dirty}isModified(){return this.isDirty()}setDirty(e){this.dirty!==e&&(this.dirty=e,this._onDidChangeDirty.fire())}async save(e){let i=await this.textFileService.save(this.resource,e);return i&&this._onDidSave.fire({reason:e?.reason,source:e?.source}),!!i}async revert(){this.ignoreDirtyOnModelContentChange=!0;try{this.updateTextEditorModel(R3(""))}finally{this.ignoreDirtyOnModelContentChange=!1}this.setDirty(!1),this._onDidRevert.fire()}async backup(e){let i;return this.isResolved()?i=await this.textFileService.getEncodedReadable(this.resource,this.createSnapshot()??void 0,{encoding:H3}):typeof this.initialValue=="string"&&(i=vie(Jt.fromString(this.initialValue))),{content:i}}ignoreDirtyOnModelContentChange=!1;async resolve(){let e=!1,i=!1;if(this.textEditorModel)this.updateTextEditorModel(void 0,this.preferredLanguageId);else{let o,s=await this.workingCopyBackupService.resolve(this);s?(o=s.value,i=!0):o=kO(Jt.fromString(this.initialValue||""));let a=await Cse(await this.textFileService.getDecodedStream(this.resource,o,{encoding:H3}));this.createTextEditorModel(a,this.resource,this.preferredLanguageId),e=!0}let n=Yt(this.textEditorModel);return this.installModelListeners(n),e&&((i||this.initialValue)&&this.updateNameFromFirstLine(n),this.setDirty(this.hasAssociatedFilePath||!!i||!!this.initialValue),(i||this.initialValue)&&this._onDidChangeContent.fire()),super.resolve()}installModelListeners(e){this._register(e.onDidChangeContent(i=>this.onModelContentChanged(e,i))),this._register(e.onDidChangeLanguage(()=>this.onConfigurationChange(void 0,!0))),super.installModelListeners(e)}onModelContentChanged(e,i){this.ignoreDirtyOnModelContentChange||(!this.hasAssociatedFilePath&&e.getLineCount()===1&&e.getLineLength(1)===0?this.setDirty(!1):this.setDirty(!0)),i.changes.some(n=>(n.range.startLineNumber===1||n.range.endLineNumber===1)&&n.range.startColumn<=Su.FIRST_LINE_NAME_CANDIDATE_MAX_LENGTH)&&this.updateNameFromFirstLine(e),this._onDidChangeContent.fire(),this.autoDetectLanguage()}updateNameFromFirstLine(e){if(this.hasAssociatedFilePath)return;let i,n=e.getValueInRange({startLineNumber:1,endLineNumber:1,startColumn:1,endColumn:Su.FIRST_LINE_NAME_CANDIDATE_MAX_LENGTH+1}).trim().replace(/\s+/g," ").replace(/\u202E/g,"");n=n.substr(0,gA(n,Su.FIRST_LINE_NAME_MAX_LENGTH)[0]),n&&mD().exec(n)&&(i=n),i!==this.cachedModelFirstLineWords&&(this.cachedModelFirstLineWords=i,this._onDidChangeName.fire())}isReadonly(){return!1}};Su=E([b(5,ti),b(6,qi),b(7,oN),b(8,Cs),b(9,qf),b(10,Us),b(11,hi),b(12,$e),b(13,KC),b(14,Un)],Su);var Nse=q("untitledTextEditorService"),FI=class extends R{constructor(e,i){super();this.instantiationService=e;this.configurationService=i}static UNTITLED_WITHOUT_ASSOCIATED_RESOURCE_REGEX=/Untitled-\d+/;_onDidChangeDirty=this._register(new x);onDidChangeDirty=this._onDidChangeDirty.event;_onDidChangeEncoding=this._register(new x);onDidChangeEncoding=this._onDidChangeEncoding.event;_onDidCreate=this._register(new x);onDidCreate=this._onDidCreate.event;_onWillDispose=this._register(new x);onWillDispose=this._onWillDispose.event;_onDidChangeLabel=this._register(new x);onDidChangeLabel=this._onDidChangeLabel.event;mapResourceToModel=new Fn;get(e){return this.mapResourceToModel.get(e)}getValue(e){return this.get(e)?.textEditorModel?.getValue()}async resolve(e){let i=this.doCreateOrGet(e);return await i.resolve(),i}create(e){return this.doCreateOrGet(e)}doCreateOrGet(e=Object.create(null)){let i=this.massageOptions(e);return i.untitledResource&&this.mapResourceToModel.has(i.untitledResource)?this.mapResourceToModel.get(i.untitledResource):this.doCreate(i)}massageOptions(e){let i=Object.create(null);if(e.associatedResource?(i.untitledResource=Z.from({scheme:Ie.untitled,authority:e.associatedResource.authority,fragment:e.associatedResource.fragment,path:e.associatedResource.path,query:e.associatedResource.query}),i.associatedResource=e.associatedResource):e.untitledResource?.scheme===Ie.untitled&&(i.untitledResource=e.untitledResource),e.languageId)i.languageId=e.languageId;else if(!i.associatedResource){let n=this.configurationService.getValue();n.files?.defaultLanguage&&(i.languageId=n.files.defaultLanguage)}return i.encoding=e.encoding,i.initialValue=e.initialValue,i}doCreate(e){let i=e.untitledResource;if(!i){let o=1;do i=Z.from({scheme:Ie.untitled,path:`Untitled-${o}`}),o++;while(this.mapResourceToModel.has(i))}let n=this._register(this.instantiationService.createInstance(Su,i,!!e.associatedResource,e.initialValue,e.languageId,e.encoding));return this.registerModel(n),n}registerModel(e){let i=new B;i.add(e.onDidChangeDirty(()=>this._onDidChangeDirty.fire(e))),i.add(e.onDidChangeName(()=>this._onDidChangeLabel.fire(e))),i.add(e.onDidChangeEncoding(()=>this._onDidChangeEncoding.fire(e))),i.add(e.onWillDispose(()=>this._onWillDispose.fire(e))),X.once(e.onWillDispose)(()=>{this.mapResourceToModel.delete(e.resource),i.dispose()}),this.mapResourceToModel.set(e.resource,e),this._onDidCreate.fire(e),e.isDirty()&&this._onDidChangeDirty.fire(e)}isUntitledWithAssociatedResource(e){return e.scheme===Ie.untitled&&e.path.length>1&&!FI.UNTITLED_WITHOUT_ASSOCIATED_RESOURCE_REGEX.test(e.path)}canDispose(e){return e.isDisposed()?!0:this.doCanDispose(e)}async doCanDispose(e){return e.isDirty()?(await X.toPromise(e.onDidChangeDirty),this.canDispose(e)):!0}};FI=E([b(0,ne),b(1,se)],FI);gi(Nse,FI,1);var Sc=Si,mi=q("notificationService");var Cu=q("progressService");var Gye=Object.freeze({total(){},worked(){},done(){}}),Fse=class{constructor(t){this.callback=t}static None=Object.freeze({report(){}});_value;get value(){return this._value}report(t){this._value=t,this.callback(this._value)}};var $N=class extends R{deferred=new Kr;reporter;lastStep;constructor(t,e){super(),e.withProgress(t,i=>(this.reporter=i,this.lastStep&&i.report(this.lastStep),this.deferred.p)),this._register(le(()=>this.deferred.complete()))}report(t){this.reporter?this.reporter.report(t):this.lastStep=t}};$N=E([b(1,Cu)],$N);var jN=q("editorProgressService");var sw=class extends R{constructor(e,i){super();this.logService=e;this.configurationService=i}participants=new lr;addFileOperationParticipant(e){let i=this.participants.push(e);return le(()=>i())}async participate(e,i,n,o){let s=this.configurationService.getValue("files.participants.timeout");if(!(typeof s!="number"||s<=0))for(let a of this.participants)try{await a.participate(e,i,n,s,o)}catch(l){this.logService.warn(l)}}dispose(){this.participants.clear(),super.dispose()}};sw=E([b(0,bt),b(1,se)],sw);var ll=class extends R{constructor(e,i,n,o){super();this.getExpression=e;this.shouldUpdate=i;this.contextService=n;this.configurationService=o;this.updateExpressions(!1),this.registerListeners()}static NO_FOLDER=null;_onExpressionChange=this._register(new x);onExpressionChange=this._onExpressionChange.event;mapFolderToParsedExpression=new Map;mapFolderToConfiguredExpression=new Map;registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(e=>{this.shouldUpdate(e)&&this.updateExpressions(!0)})),this._register(this.contextService.onDidChangeWorkspaceFolders(()=>this.updateExpressions(!0)))}updateExpressions(e){let i=!1;for(let a of this.contextService.getWorkspace().folders){let l=a.uri.toString(),d=this.doGetExpression(a.uri),c=this.mapFolderToConfiguredExpression.get(l);d?(!c||!sn(c.expression,d.expression))&&(i=!0,this.mapFolderToParsedExpression.set(l,du(d.expression)),this.mapFolderToConfiguredExpression.set(l,d)):c&&(i=!0,this.mapFolderToParsedExpression.delete(l),this.mapFolderToConfiguredExpression.delete(l))}let n=new jM(this.contextService.getWorkspace().folders.map(a=>a.uri));for(let[a]of this.mapFolderToConfiguredExpression)a!==ll.NO_FOLDER&&(n.has(Z.parse(a))||(this.mapFolderToParsedExpression.delete(a),this.mapFolderToConfiguredExpression.delete(a),i=!0));let o=this.doGetExpression(void 0),s=this.mapFolderToConfiguredExpression.get(ll.NO_FOLDER);o?(!s||!sn(s.expression,o.expression))&&(i=!0,this.mapFolderToParsedExpression.set(ll.NO_FOLDER,du(o.expression)),this.mapFolderToConfiguredExpression.set(ll.NO_FOLDER,o)):s&&(i=!0,this.mapFolderToParsedExpression.delete(ll.NO_FOLDER),this.mapFolderToConfiguredExpression.delete(ll.NO_FOLDER)),e&&i&&this._onExpressionChange.fire()}doGetExpression(e){let i=this.getExpression(e);if(!i)return;let n=Object.keys(i);if(n.length===0)return;let o=!1,s=Object.create(null);for(let a of n){o||(o=ja(a));let l=a,d=kee(l,!0);if(d){let c=d.toLowerCase();d!==d.toLowerCase()&&(l=`${c}${l.substring(1)}`)}s[l]=i[a]}return{expression:s,hasAbsolutePath:o}}matches(e,i){if(this.mapFolderToParsedExpression.size===0)return!1;let n=this.contextService.getWorkspaceFolder(e),o,s;if(n&&this.mapFolderToParsedExpression.has(n.uri.toString())?(o=this.mapFolderToParsedExpression.get(n.uri.toString()),s=this.mapFolderToConfiguredExpression.get(n.uri.toString())):(o=this.mapFolderToParsedExpression.get(ll.NO_FOLDER),s=this.mapFolderToConfiguredExpression.get(ll.NO_FOLDER)),!o)return!1;let a;return n?a=af(n.uri,e):a=this.uriToPath(e),typeof a=="string"&&o(a,void 0,i)?!0:a!==this.uriToPath(e)&&s?.hasAbsolutePath?!!o(this.uriToPath(e),void 0,i):!1}uriToPath(e){return e.scheme===Ie.file?e.fsPath:e.path}};ll=E([b(2,kt),b(3,se)],ll);var qye=new A("autoSaveAfterShortDelayContext",!1,!0);var qm=q("filesConfigurationService"),dl=class extends R{constructor(e,i,n,o,s,a,l,d){super();this.contextKeyService=e;this.configurationService=i;this.contextService=n;this.environmentService=o;this.uriIdentityService=s;this.fileService=a;this.markerService=l;this.textResourceConfigurationService=d;let c=i.getValue();this.currentGlobalAutoSaveConfiguration=this.computeAutoSaveConfiguration(void 0,c.files),this.currentFilesAssociationConfiguration=c?.files?.associations,this.currentHotExitConfiguration=c?.files?.hotExit||zC.ON_EXIT,this.onFilesConfigurationChange(c,!1),this.registerListeners()}static DEFAULT_AUTO_SAVE_MODE=si?fu.AFTER_DELAY:fu.OFF;static DEFAULT_AUTO_SAVE_DELAY=1e3;static READONLY_MESSAGES={providerReadonly:{value:u("providerReadonly","Editor is read-only because the file system of the file is read-only."),isTrusted:!0},sessionReadonly:{value:u({key:"sessionReadonly",comment:['Please do not translate the word "command", it is part of our internal syntax which must not change','{Locked="](command:{0})"}']},"Editor is read-only because the file was set read-only in this session. [Click here](command:{0}) to set writeable.","workbench.action.files.setActiveEditorWriteableInSession"),isTrusted:!0},configuredReadonly:{value:u({key:"configuredReadonly",comment:['Please do not translate the word "command", it is part of our internal syntax which must not change','{Locked="](command:{0})"}']},"Editor is read-only because the file was set read-only via settings. [Click here](command:{0}) to configure or [toggle for this session](command:{1}).",`workbench.action.openSettings?${encodeURIComponent('["files.readonly"]')}`,"workbench.action.files.toggleActiveEditorReadonlyInSession"),isTrusted:!0},fileLocked:{value:u({key:"fileLocked",comment:['Please do not translate the word "command", it is part of our internal syntax which must not change','{Locked="](command:{0})"}']},"Editor is read-only because of file permissions. [Click here](command:{0}) to set writeable anyway.","workbench.action.files.setActiveEditorWriteableInSession"),isTrusted:!0},fileReadonly:{value:u("fileReadonly","Editor is read-only because the file is read-only."),isTrusted:!0}};_onDidChangeAutoSaveConfiguration=this._register(new x);onDidChangeAutoSaveConfiguration=this._onDidChangeAutoSaveConfiguration.event;_onDidChangeAutoSaveDisabled=this._register(new x);onDidChangeAutoSaveDisabled=this._onDidChangeAutoSaveDisabled.event;_onDidChangeFilesAssociation=this._register(new x);onDidChangeFilesAssociation=this._onDidChangeFilesAssociation.event;_onDidChangeReadonly=this._register(new x);onDidChangeReadonly=this._onDidChangeReadonly.event;currentGlobalAutoSaveConfiguration;currentFilesAssociationConfiguration;currentHotExitConfiguration;autoSaveConfigurationCache=new zr(1e3);autoSaveDisabledOverrides=new Fn;autoSaveAfterShortDelayContext=qye.bindTo(this.contextKeyService);readonlyIncludeMatcher=this._register(new j_(()=>this.createReadonlyMatcher(mre)));readonlyExcludeMatcher=this._register(new j_(()=>this.createReadonlyMatcher(gre)));configuredReadonlyFromPermissions;sessionReadonlyOverrides=new Fn(e=>this.uriIdentityService.extUri.getComparisonKey(e));createReadonlyMatcher(e){let i=this._register(new ll(n=>this.configurationService.getValue(e,{resource:n}),n=>n.affectsConfiguration(e),this.contextService,this.configurationService));return this._register(i.onExpressionChange(()=>this._onDidChangeReadonly.fire())),i}isReadonly(e,i){let n=this.fileService.getProvider(e.scheme);if(n&&pre(n))return n.readOnlyMessage??dl.READONLY_MESSAGES.providerReadonly;let o=this.sessionReadonlyOverrides.get(e);return typeof o=="boolean"?o===!0?dl.READONLY_MESSAGES.sessionReadonly:!1:this.uriIdentityService.extUri.isEqualOrParent(e,this.environmentService.userRoamingDataHome)||this.uriIdentityService.extUri.isEqual(e,this.contextService.getWorkspace().configuration??void 0)?!1:this.readonlyIncludeMatcher.value.matches(e)?this.readonlyExcludeMatcher.value.matches(e)?!1:dl.READONLY_MESSAGES.configuredReadonly:this.configuredReadonlyFromPermissions&&i?.locked?dl.READONLY_MESSAGES.fileLocked:i?.readonly?dl.READONLY_MESSAGES.fileReadonly:!1}async updateReadonly(e,i){if(i==="toggle"){let n;try{n=await this.fileService.resolve(e,{resolveMetadata:!0})}catch{}i=!this.isReadonly(e,n)}i==="reset"?this.sessionReadonlyOverrides.delete(e):this.sessionReadonlyOverrides.set(e,i),this._onDidChangeReadonly.fire()}registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(e=>{e.affectsConfiguration("files")&&this.onFilesConfigurationChange(this.configurationService.getValue(),!0)}))}onFilesConfigurationChange(e,i){this.currentGlobalAutoSaveConfiguration=this.computeAutoSaveConfiguration(void 0,e.files),this.autoSaveConfigurationCache.clear(),this.autoSaveAfterShortDelayContext.set(this.getAutoSaveMode(void 0).mode===1),i&&this._onDidChangeAutoSaveConfiguration.fire();let n=e?.files?.associations;sn(this.currentFilesAssociationConfiguration,n)||(this.currentFilesAssociationConfiguration=n,i&&this._onDidChangeFilesAssociation.fire());let o=e?.files?.hotExit;o===zC.OFF||o===zC.ON_EXIT_AND_WINDOW_CLOSE?this.currentHotExitConfiguration=o:this.currentHotExitConfiguration=zC.ON_EXIT;let s=!!e?.files?.readonlyFromPermissions;s!==!!this.configuredReadonlyFromPermissions&&(this.configuredReadonlyFromPermissions=s,i&&this._onDidChangeReadonly.fire())}getAutoSaveConfiguration(e){let i=this.toResource(e);if(i){let n=this.autoSaveConfigurationCache.get(i);return n||(n=this.computeAutoSaveConfiguration(i,this.textResourceConfigurationService.getValue(i,"files")),this.autoSaveConfigurationCache.set(i,n)),n}return this.currentGlobalAutoSaveConfiguration}computeAutoSaveConfiguration(e,i){let n,o,s,a,l,d;switch(i?.autoSave??dl.DEFAULT_AUTO_SAVE_MODE){case fu.AFTER_DELAY:{n="afterDelay",o=typeof i?.autoSaveDelay=="number"&&i.autoSaveDelay>=0?i.autoSaveDelay:dl.DEFAULT_AUTO_SAVE_DELAY,d=o<=dl.DEFAULT_AUTO_SAVE_DELAY;break}case fu.ON_FOCUS_CHANGE:n="onFocusChange";break;case fu.ON_WINDOW_CHANGE:n="onWindowChange";break}return i?.autoSaveWorkspaceFilesOnly===!0&&(s=!0,e&&!this.contextService.isInsideWorkspace(e)&&(l=!0,d=void 0)),i?.autoSaveWhenNoErrors===!0&&(a=!0,d=void 0),{autoSave:n,autoSaveDelay:o,autoSaveWorkspaceFilesOnly:s,autoSaveWhenNoErrors:a,isOutOfWorkspace:l,isShortAutoSaveDelay:d}}toResource(e){return e instanceof Bl?ro.getOriginalUri(e,{supportSideBySide:1}):e}hasShortAutoSaveDelay(e){let i=this.toResource(e);return this.getAutoSaveConfiguration(i).isShortAutoSaveDelay?!i||!this.autoSaveDisabledOverrides.has(i):!1}getAutoSaveMode(e,i){let n=this.toResource(e);if(n&&this.autoSaveDisabledOverrides.has(n))return{mode:0,reason:4};let o=this.getAutoSaveConfiguration(n);if(typeof o.autoSave>"u")return{mode:0,reason:1};if(typeof i=="number"&&(o.autoSave==="afterDelay"&&i!==2||o.autoSave==="onFocusChange"&&i!==3&&i!==4||o.autoSave==="onWindowChange"&&i!==4))return{mode:0,reason:1};if(n){if(o.autoSaveWorkspaceFilesOnly&&o.isOutOfWorkspace)return{mode:0,reason:2};if(o.autoSaveWhenNoErrors&&this.markerService.read({resource:n,take:1,severities:8}).length>0)return{mode:0,reason:3}}switch(o.autoSave){case"afterDelay":return typeof o.autoSaveDelay=="number"&&o.autoSaveDelay<=dl.DEFAULT_AUTO_SAVE_DELAY?{mode:o.autoSaveWhenNoErrors?2:1}:{mode:2};case"onFocusChange":return{mode:3};case"onWindowChange":return{mode:4}}}async toggleAutoSave(){let e=this.configurationService.getValue("files.autoSave"),i;return[fu.AFTER_DELAY,fu.ON_FOCUS_CHANGE,fu.ON_WINDOW_CHANGE].some(n=>n===e)?i=fu.OFF:i=fu.AFTER_DELAY,this.configurationService.updateValue("files.autoSave",i)}disableAutoSave(e){let i=this.toResource(e);if(!i)return R.None;let n=this.autoSaveDisabledOverrides.get(i)??0;return this.autoSaveDisabledOverrides.set(i,n+1),n===0&&this._onDidChangeAutoSaveDisabled.fire(i),le(()=>{let o=this.autoSaveDisabledOverrides.get(i)??0;o<=1?(this.autoSaveDisabledOverrides.delete(i),this._onDidChangeAutoSaveDisabled.fire(i)):this.autoSaveDisabledOverrides.set(i,o-1)})}get isHotExitEnabled(){return this.contextService.getWorkspace().transient?!1:this.currentHotExitConfiguration!==zC.OFF}get hotExitConfiguration(){return this.currentHotExitConfiguration}preventSaveConflicts(e,i){return this.configurationService.getValue("files.saveConflictResolution",{resource:e,overrideIdentifier:i})!=="overwriteFileOnDisk"}};dl=E([b(0,re),b(1,se),b(2,kt),b(3,$o),b(4,zn),b(5,Ei),b(6,WO),b(7,Cs)],dl);gi(qm,dl,0);var U3=q("workingCopyEditorService"),Pk=class extends R{constructor(e){super();this.editorService=e}_onDidRegisterHandler=this._register(new x);onDidRegisterHandler=this._onDidRegisterHandler.event;handlers=new Set;registerHandler(e){return this.handlers.add(e),this._onDidRegisterHandler.fire(e),le(()=>this.handlers.delete(e))}findEditor(e){for(let i of this.editorService.getEditors(0))if(this.isOpen(e,i.editor))return i}isOpen(e,i){for(let n of this.handlers)if(n.isOpen(e,i))return!0;return!1}};Pk=E([b(0,$e)],Pk);gi(U3,Pk,1);var Vse=q("elevatedFileService");var aw=class extends R{constructor(e,i){super();this.resource=e;this.fileService=i;this._register(this.fileService.onDidFilesChange(n=>this.onDidFilesChange(n)))}_onDidChangeOrphaned=this._register(new x);onDidChangeOrphaned=this._onDidChangeOrphaned.event;orphaned=!1;isOrphaned(){return this.orphaned}async onDidFilesChange(e){let i=!1,n;if(this.orphaned?e.contains(this.resource,1)&&(n=!1,i=!0):e.contains(this.resource,2)&&(n=!0,i=!0),i&&this.orphaned!==n){let o=!1;n&&(await To(100,Pt.None),this.isDisposed()?o=!0:o=!await this.fileService.exists(this.resource)),this.orphaned!==o&&!this.isDisposed()&&this.setOrphaned(o)}}setOrphaned(e){this.orphaned!==e&&(this.orphaned=e,this._onDidChangeOrphaned.fire())}_onWillDispose=this._register(new x);onWillDispose=this._onWillDispose.event;isDisposed(){return this._store.isDisposed}dispose(){this.orphaned=!1,this._onWillDispose.fire(),super.dispose()}isModified(){return this.isDirty()}};aw=E([b(1,Ei)],aw);var BI=class extends aw{constructor(e,i,n,o,s,a,l,d,c,p,h,m,f,g,v,I){super(i,a);this.typeId=e;this.name=n;this.modelFactory=o;this.externalResolver=s;this.logService=l;this.workingCopyFileService=d;this.filesConfigurationService=c;this.workingCopyBackupService=p;this.notificationService=m;this.workingCopyEditorService=f;this.editorService=g;this.elevatedFileService=v;this.progressService=I;this._register(h.registerWorkingCopy(this)),this.registerListeners()}capabilities=0;_model=void 0;get model(){return this._model}_onDidChangeContent=this._register(new x);onDidChangeContent=this._onDidChangeContent.event;_onDidResolve=this._register(new x);onDidResolve=this._onDidResolve.event;_onDidChangeDirty=this._register(new x);onDidChangeDirty=this._onDidChangeDirty.event;_onDidSaveError=this._register(new x);onDidSaveError=this._onDidSaveError.event;_onDidSave=this._register(new x);onDidSave=this._onDidSave.event;_onDidRevert=this._register(new x);onDidRevert=this._onDidRevert.event;_onDidChangeReadonly=this._register(new x);onDidChangeReadonly=this._onDidChangeReadonly.event;registerListeners(){this._register(this.filesConfigurationService.onDidChangeReadonly(()=>this._onDidChangeReadonly.fire()))}dirty=!1;savedVersionId;isDirty(){return this.dirty}markModified(){this.setDirty(!0)}setDirty(e){if(!this.isResolved())return;let i=this.dirty;this.doSetDirty(e),e!==i&&this._onDidChangeDirty.fire()}doSetDirty(e){let i=this.dirty,n=this.inConflictMode,o=this.inErrorMode,s=this.savedVersionId;return e?this.dirty=!0:(this.dirty=!1,this.inConflictMode=!1,this.inErrorMode=!1,this.isResolved()&&(this.savedVersionId=this.model.versionId)),()=>{this.dirty=i,this.inConflictMode=n,this.inErrorMode=o,this.savedVersionId=s}}lastResolvedFileStat;isResolved(){return!!this.model}async resolve(e){if(this.trace("resolve() - enter"),this.isDisposed()){this.trace("resolve() - exit - without resolving because file working copy is disposed");return}if(!e?.contents&&(this.dirty||this.saveSequentializer.isRunning())){this.trace("resolve() - exit - without resolving because file working copy is dirty or being saved");return}return this.doResolve(e)}async doResolve(e){if(e?.contents)return this.resolveFromBuffer(e.contents);if(!(!this.isResolved()&&await this.resolveFromBackup()))return this.resolveFromFile(e)}async resolveFromBuffer(e){this.trace("resolveFromBuffer()");let i,n,o,s;try{let a=await this.fileService.stat(this.resource);i=a.mtime,n=a.ctime,o=a.size,s=a.etag,this.setOrphaned(!1)}catch(a){i=Date.now(),n=Date.now(),o=0,s=hk,this.setOrphaned(a.fileOperationResult===1)}return this.resolveFromContent({resource:this.resource,name:this.name,mtime:i,ctime:n,size:o,etag:s,value:e,readonly:!1,locked:!1},!0)}async resolveFromBackup(){let e=await this.workingCopyBackupService.resolve(this);return this.isResolved()?(this.trace("resolveFromBackup() - exit - withoutresolving because previously new file working copy got created meanwhile"),!0):e?(await this.doResolveFromBackup(e),!0):!1}async doResolveFromBackup(e){this.trace("doResolveFromBackup()"),await this.resolveFromContent({resource:this.resource,name:this.name,mtime:e.meta?e.meta.mtime:Date.now(),ctime:e.meta?e.meta.ctime:Date.now(),size:e.meta?e.meta.size:0,etag:e.meta?e.meta.etag:hk,value:e.value,readonly:!1,locked:!1},!0),e.meta&&e.meta.orphaned&&this.setOrphaned(!0)}async resolveFromFile(e){this.trace("resolveFromFile()");let i=e?.forceReadFromFile,n;i?n=hk:this.lastResolvedFileStat&&(n=this.lastResolvedFileStat.etag);let o=this.versionId;try{let s=await this.fileService.readFileStream(this.resource,{etag:n,limits:e?.limits});if(this.setOrphaned(!1),o!==this.versionId){this.trace("resolveFromFile() - exit - without resolving because file working copy content changed");return}await this.resolveFromContent(s,!1)}catch(s){let a=s.fileOperationResult;if(this.setOrphaned(a===1),this.isResolved()&&a===2){s instanceof iN&&this.updateLastResolvedFileStat(s.stat);return}if(this.isResolved()&&a===1&&!i)return;throw s}}async resolveFromContent(e,i){if(this.trace("resolveFromContent() - enter"),this.isDisposed()){this.trace("resolveFromContent() - exit - because working copy is disposed");return}this.updateLastResolvedFileStat({resource:this.resource,name:e.name,mtime:e.mtime,ctime:e.ctime,size:e.size,etag:e.etag,readonly:e.readonly,locked:e.locked,isFile:!0,isDirectory:!1,isSymbolicLink:!1,children:void 0}),this.isResolved()?await this.doUpdateModel(e.value):await this.doCreateModel(e.value),this.setDirty(!!i),this._onDidResolve.fire()}async doCreateModel(e){this.trace("doCreateModel()"),this._model=this._register(await this.modelFactory.createModel(this.resource,e,Pt.None)),this.installModelListeners(this._model)}ignoreDirtyOnModelContentChange=!1;async doUpdateModel(e){this.trace("doUpdateModel()"),this.ignoreDirtyOnModelContentChange=!0;try{await this.model?.update(e,Pt.None)}finally{this.ignoreDirtyOnModelContentChange=!1}}installModelListeners(e){this._register(e.onDidChangeContent(i=>this.onModelContentChanged(e,i.isUndoing||i.isRedoing))),this._register(e.onWillDispose(()=>this.dispose()))}onModelContentChanged(e,i){if(this.trace("onModelContentChanged() - enter"),this.versionId++,this.trace(`onModelContentChanged() - new versionId ${this.versionId}`),i&&(this.lastContentChangeFromUndoRedo=Date.now()),!this.ignoreDirtyOnModelContentChange&&!this.isReadonly())if(e.versionId===this.savedVersionId){this.trace("onModelContentChanged() - model content changed back to last saved version");let n=this.dirty;this.setDirty(!1),n&&this._onDidRevert.fire()}else this.trace("onModelContentChanged() - model content changed and marked as dirty"),this.setDirty(!0);this._onDidChangeContent.fire()}async forceResolveFromFile(){this.isDisposed()||await this.externalResolver({forceReadFromFile:!0})}get backupDelay(){return this.model?.configuration?.backupDelay}async backup(e){let i;this.lastResolvedFileStat&&(i={mtime:this.lastResolvedFileStat.mtime,ctime:this.lastResolvedFileStat.ctime,size:this.lastResolvedFileStat.size,etag:this.lastResolvedFileStat.etag,orphaned:this.isOrphaned()});let n;return this.isResolved()&&(n=await Zv(this.model.snapshot(2,e),e)),{meta:i,content:n}}versionId=0;static UNDO_REDO_SAVE_PARTICIPANTS_AUTO_SAVE_THROTTLE_THRESHOLD=500;lastContentChangeFromUndoRedo=void 0;saveSequentializer=new DA;ignoreSaveFromSaveParticipants=!1;async save(e=Object.create(null)){return this.isResolved()?this.isReadonly()?(this.trace("save() - ignoring request for readonly resource"),!1):(this.hasState(3)||this.hasState(5))&&(e.reason===2||e.reason===3||e.reason===4)?(this.trace("save() - ignoring auto save request for file working copy that is in conflict or error"),!1):(this.trace("save() - enter"),await this.doSave(e),this.trace("save() - exit"),this.hasState(0)):!1}async doSave(e){typeof e.reason!="number"&&(e.reason=1);let i=this.versionId;if(this.trace(`doSave(${i}) - enter with versionId ${i}`),this.ignoreSaveFromSaveParticipants){this.trace(`doSave(${i}) - exit - refusing to save() recursively from save participant`);return}if(this.saveSequentializer.isRunning(i))return this.trace(`doSave(${i}) - exit - found a running save for versionId ${i}`),this.saveSequentializer.running;if(!e.force&&!this.dirty){this.trace(`doSave(${i}) - exit - because not dirty and/or versionId is different (this.isDirty: ${this.dirty}, this.versionId: ${this.versionId})`);return}if(this.saveSequentializer.isRunning())return this.trace(`doSave(${i}) - exit - because busy saving`),this.saveSequentializer.cancelRunning(),this.saveSequentializer.queue(()=>this.doSave(e));this.isResolved()&&this.model.pushStackElement();let n=new Kt;return this.progressService.withProgress({title:u("saveParticipants","Saving '{0}'",this.name),location:10,cancellable:!0,delay:this.isDirty()?3e3:5e3},o=>this.doSaveSequential(i,e,o,n),()=>{n.cancel()}).finally(()=>{n.dispose()})}doSaveSequential(e,i,n,o){return this.saveSequentializer.run(e,(async()=>{if(this.isResolved()&&!i.skipSaveParticipants&&this.workingCopyFileService.hasSaveParticipants)try{if(i.reason===2&&typeof this.lastContentChangeFromUndoRedo=="number"){let l=Date.now()-this.lastContentChangeFromUndoRedo;l<BI.UNDO_REDO_SAVE_PARTICIPANTS_AUTO_SAVE_THROTTLE_THRESHOLD&&await To(BI.UNDO_REDO_SAVE_PARTICIPANTS_AUTO_SAVE_THROTTLE_THRESHOLD-l)}if(!o.token.isCancellationRequested){this.ignoreSaveFromSaveParticipants=!0;try{await this.workingCopyFileService.runSaveParticipants(this,{reason:i.reason??1,savedFrom:i.from},n,o.token)}finally{this.ignoreSaveFromSaveParticipants=!1}}}catch(l){this.logService.error(`[stored file working copy] runSaveParticipants(${e}) - resulted in an error: ${l.toString()}`,this.resource.toString(),this.typeId)}if(o.token.isCancellationRequested||this.isDisposed()||!this.isResolved())return;e=this.versionId,this.inErrorMode=!1,n.report({message:u("saveTextFile","Writing into file...")}),this.trace(`doSave(${e}) - before write()`);let s=Yt(this.lastResolvedFileStat),a=this;return this.saveSequentializer.run(e,(async()=>{try{let l={mtime:s.mtime,etag:i.ignoreModifiedSince||!this.filesConfigurationService.preventSaveConflicts(s.resource)?hk:s.etag,unlock:i.writeUnlock},d;if(typeof a.model.save=="function")try{d=await a.model.save(l,o.token)}catch(c){if(o.token.isCancellationRequested)return;throw c}else{let c=await Zv(a.model.snapshot(1,o.token),o.token);if(o.token.isCancellationRequested)return;o.dispose(),i?.writeElevated&&this.elevatedFileService.isSupported(s.resource)?d=await this.elevatedFileService.writeFileElevated(s.resource,Yt(c),l):d=await this.fileService.writeFile(s.resource,Yt(c),l)}this.handleSaveSuccess(d,e,i)}catch(l){this.handleSaveError(l,e,i)}})(),()=>o.cancel())})(),()=>o.cancel())}handleSaveSuccess(e,i,n){this.updateLastResolvedFileStat(e),i===this.versionId?(this.trace(`handleSaveSuccess(${i}) - setting dirty to false because versionId did not change`),this.setDirty(!1)):this.trace(`handleSaveSuccess(${i}) - not setting dirty to false because versionId did change meanwhile`),this.setOrphaned(!1),this._onDidSave.fire({reason:n.reason,stat:e,source:n.source})}handleSaveError(e,i,n){if((n.ignoreErrorHandler?this.logService.trace:this.logService.error).apply(this.logService,[`[stored file working copy] handleSaveError(${i}) - exit - resulted in a save error: ${e.toString()}`,this.resource.toString(),this.typeId]),n.ignoreErrorHandler)throw e;this.setDirty(!0),this.inErrorMode=!0,e.fileOperationResult===3&&(this.inConflictMode=!0),this.doHandleSaveError(e,n),this._onDidSaveError.fire()}doHandleSaveError(e,i){let n=e,o=[],s;if(n.fileOperationResult===3)s=u("staleSaveError","Failed to save '{0}': The content of the file is newer. Do you want to overwrite the file with your changes?",this.name),o.push(fn({id:"fileWorkingCopy.overwrite",label:u("overwrite","Overwrite"),run:()=>this.save({...i,ignoreModifiedSince:!0,reason:1})})),o.push(fn({id:"fileWorkingCopy.revert",label:u("revert","Revert"),run:()=>this.revert()}));else{let d=n.fileOperationResult===5,c=d&&n.options?.unlock,p=n.fileOperationResult===6,h=this.elevatedFileService.isSupported(this.resource);ck(e)&&o.push(...e.actions),h&&(p||c)?o.push(fn({id:"fileWorkingCopy.saveElevated",label:c?St?u("overwriteElevated","Overwrite as Admin..."):u("overwriteElevatedSudo","Overwrite as Sudo..."):St?u("saveElevated","Retry as Admin..."):u("saveElevatedSudo","Retry as Sudo..."),run:()=>{this.save({...i,writeElevated:!0,writeUnlock:c,reason:1})}})):d?o.push(fn({id:"fileWorkingCopy.unlock",label:u("overwrite","Overwrite"),run:()=>this.save({...i,writeUnlock:!0,reason:1})})):o.push(fn({id:"fileWorkingCopy.retry",label:u("retry","Retry"),run:()=>this.save({...i,reason:1})})),o.push(fn({id:"fileWorkingCopy.saveAs",label:u("saveAs","Save As..."),run:async()=>{let m=this.workingCopyEditorService.findEditor(this);m&&((await this.editorService.save(m,{saveAs:!0,reason:1})).success||this.doHandleSaveError(e,i))}})),o.push(fn({id:"fileWorkingCopy.revert",label:u("revert","Revert"),run:()=>this.revert()})),d?c&&h?s=St?u("readonlySaveErrorAdmin","Failed to save '{0}': File is read-only. Select 'Overwrite as Admin' to retry as administrator.",this.name):u("readonlySaveErrorSudo","Failed to save '{0}': File is read-only. Select 'Overwrite as Sudo' to retry as superuser.",this.name):s=u("readonlySaveError","Failed to save '{0}': File is read-only. Select 'Overwrite' to attempt to make it writeable.",this.name):h&&p?s=St?u("permissionDeniedSaveError","Failed to save '{0}': Insufficient permissions. Select 'Retry as Admin' to retry as administrator.",this.name):u("permissionDeniedSaveErrorSudo","Failed to save '{0}': Insufficient permissions. Select 'Retry as Sudo' to retry as superuser.",this.name):s=u({key:"genericSaveError",comment:["{0} is the resource that failed to save and {1} the error message"]},"Failed to save '{0}': {1}",this.name,PI(e,!1))}let a=this.notificationService.notify({id:`${wr(this.resource.toString())}`,severity:Sc.Error,message:s,actions:{primary:o}}),l=this._register(X.once(X.any(this.onDidSave,this.onDidRevert))(()=>a.close()));this._register(X.once(a.onDidClose)(()=>l.dispose()))}updateLastResolvedFileStat(e){let i=this.isReadonly();this.lastResolvedFileStat?this.lastResolvedFileStat.mtime<=e.mtime?this.lastResolvedFileStat=e:this.lastResolvedFileStat={...this.lastResolvedFileStat,readonly:e.readonly,locked:e.locked}:this.lastResolvedFileStat=e,this.isReadonly()!==i&&this._onDidChangeReadonly.fire()}async revert(e){if(!this.isResolved()||!this.dirty&&!e?.force)return;this.trace("revert()");let i=this.dirty,n=this.doSetDirty(!1);if(!e?.soft)try{await this.forceResolveFromFile()}catch(s){if(s.fileOperationResult!==1)throw n(),s}this._onDidRevert.fire(),i&&this._onDidChangeDirty.fire()}inConflictMode=!1;inErrorMode=!1;hasState(e){switch(e){case 3:return this.inConflictMode;case 1:return this.dirty;case 5:return this.inErrorMode;case 4:return this.isOrphaned();case 2:return this.saveSequentializer.isRunning();case 0:return!this.dirty}}async joinState(e){return this.saveSequentializer.running}isReadonly(){return this.filesConfigurationService.isReadonly(this.resource,this.lastResolvedFileStat)}trace(e){this.logService.trace(`[stored file working copy] ${e}`,this.resource.toString(),this.typeId)}dispose(){this.trace("dispose()"),this.inConflictMode=!1,this.inErrorMode=!1,this._model=void 0,super.dispose()}};BI=E([b(5,Ei),b(6,bt),b(7,z3),b(8,qm),b(9,oN),b(10,qf),b(11,mi),b(12,U3),b(13,$e),b(14,Vse),b(15,Cu)],BI);var lw=class extends R{constructor(e){super();this.logService=e}saveParticipants=[];get length(){return this.saveParticipants.length}addSaveParticipant(e){let i=wS(this.saveParticipants,e);return le(()=>i())}async participate(e,i,n,o){e.model?.pushStackElement();for(let s of this.saveParticipants){if(o.isCancellationRequested||e.isDisposed())break;try{let a=s.participate(e,i,n,o);await Zv(a,o)}catch(a){this.logService.warn(a)}}e.model?.pushStackElement()}dispose(){this.saveParticipants.splice(0,this.saveParticipants.length),super.dispose()}};lw=E([b(0,bt)],lw);var z3=q("workingCopyFileService"),Mk=class extends R{constructor(e,i,n,o){super();this.fileService=e;this.workingCopyService=i;this.instantiationService=n;this.uriIdentityService=o;this._register(this.registerWorkingCopyProvider(s=>this.workingCopyService.workingCopies.filter(a=>this.fileService.hasProvider(s)?this.uriIdentityService.extUri.isEqualOrParent(a.resource,s):this.uriIdentityService.extUri.isEqual(a.resource,s))))}_onWillRunWorkingCopyFileOperation=this._register(new AS);onWillRunWorkingCopyFileOperation=this._onWillRunWorkingCopyFileOperation.event;_onDidFailWorkingCopyFileOperation=this._register(new AS);onDidFailWorkingCopyFileOperation=this._onDidFailWorkingCopyFileOperation.event;_onDidRunWorkingCopyFileOperation=this._register(new AS);onDidRunWorkingCopyFileOperation=this._onDidRunWorkingCopyFileOperation.event;correlationIds=0;create(e,i,n){return this.doCreateFileOrFolder(e,!0,i,n)}createFolder(e,i,n){return this.doCreateFileOrFolder(e,!1,i,n)}async doCreateFileOrFolder(e,i,n,o){if(e.length===0)return[];if(i){let c=(await Xa.settled(e.map(p=>this.fileService.canCreateFile(p.resource,{overwrite:p.overwrite})))).find(p=>p instanceof Error);if(c instanceof Error)throw c}let s=e.map(d=>({target:d.resource}));await this.runFileOperationParticipants(s,0,o,n);let a={correlationId:this.correlationIds++,operation:0,files:s};await this._onWillRunWorkingCopyFileOperation.fireAsync(a,Pt.None);let l;try{i?l=await Xa.settled(e.map(d=>this.fileService.createFile(d.resource,d.contents,{overwrite:d.overwrite}))):l=await Xa.settled(e.map(d=>this.fileService.createFolder(d.resource)))}catch(d){throw await this._onDidFailWorkingCopyFileOperation.fireAsync(a,Pt.None),d}return await this._onDidRunWorkingCopyFileOperation.fireAsync(a,Pt.None),l}async move(e,i,n){return this.doMoveOrCopy(e,!0,i,n)}async copy(e,i,n){return this.doMoveOrCopy(e,!1,i,n)}async doMoveOrCopy(e,i,n,o){let s=[];for(let{file:{source:d,target:c},overwrite:p}of e){let h=await(i?this.fileService.canMove(d,c,p):this.fileService.canCopy(d,c,p));if(h instanceof Error)throw h}let a=e.map(d=>d.file);await this.runFileOperationParticipants(a,i?2:3,o,n);let l={correlationId:this.correlationIds++,operation:i?2:3,files:a};await this._onWillRunWorkingCopyFileOperation.fireAsync(l,Pt.None);try{for(let{file:{source:d,target:c},overwrite:p}of e){if(!this.uriIdentityService.extUri.isEqual(d,c)){let h=i?[...this.getDirty(d),...this.getDirty(c)]:this.getDirty(c);await Xa.settled(h.map(m=>m.revert({soft:!0})))}i?s.push(await this.fileService.move(d,c,p)):s.push(await this.fileService.copy(d,c,p))}}catch(d){throw await this._onDidFailWorkingCopyFileOperation.fireAsync(l,Pt.None),d}return await this._onDidRunWorkingCopyFileOperation.fireAsync(l,Pt.None),s}async delete(e,i,n){for(let a of e){let l=await this.fileService.canDelete(a.resource,{recursive:a.recursive,useTrash:a.useTrash});if(l instanceof Error)throw l}let o=e.map(a=>({target:a.resource}));await this.runFileOperationParticipants(o,1,n,i);let s={correlationId:this.correlationIds++,operation:1,files:o};await this._onWillRunWorkingCopyFileOperation.fireAsync(s,Pt.None);for(let a of e){let l=this.getDirty(a.resource);await Xa.settled(l.map(d=>d.revert({soft:!0})))}try{for(let a of e)await this.fileService.del(a.resource,{recursive:a.recursive,useTrash:a.useTrash})}catch(a){throw await this._onDidFailWorkingCopyFileOperation.fireAsync(s,Pt.None),a}await this._onDidRunWorkingCopyFileOperation.fireAsync(s,Pt.None)}fileOperationParticipants=this._register(this.instantiationService.createInstance(sw));addFileOperationParticipant(e){return this.fileOperationParticipants.addFileOperationParticipant(e)}runFileOperationParticipants(e,i,n,o){return this.fileOperationParticipants.participate(e,i,n,o)}saveParticipants=this._register(this.instantiationService.createInstance(lw));get hasSaveParticipants(){return this.saveParticipants.length>0}addSaveParticipant(e){return this.saveParticipants.addSaveParticipant(e)}runSaveParticipants(e,i,n,o){return this.saveParticipants.participate(e,i,n,o)}workingCopyProviders=[];registerWorkingCopyProvider(e){let i=wS(this.workingCopyProviders,e);return le(i)}getDirty(e){let i=new Set;for(let n of this.workingCopyProviders)for(let o of n(e))o.isDirty()&&i.add(o);return Array.from(i)}};Mk=E([b(0,Ei),b(1,qf),b(2,ne),b(3,zn)],Mk);gi(z3,Mk,1);var Us=q("textFileService");var ZN;(t=>t.DEFAULT={allowTrailingComma:!0})(ZN||={});function G3(r,t=!1){let e=0,i=r.length,n="",o=0,s=16,a=0;function l(g){let v=0,I=0;for(;v<g;){let y=r.charCodeAt(e);if(y>=48&&y<=57)I=I*16+y-48;else if(y>=65&&y<=70)I=I*16+y-65+10;else if(y>=97&&y<=102)I=I*16+y-97+10;else break;e++,v++}return v<g&&(I=-1),I}function d(g){e=g,n="",o=0,s=16,a=0}function c(){let g=e;if(r.charCodeAt(e)===48)e++;else for(e++;e<r.length&&dw(r.charCodeAt(e));)e++;if(e<r.length&&r.charCodeAt(e)===46)if(e++,e<r.length&&dw(r.charCodeAt(e)))for(e++;e<r.length&&dw(r.charCodeAt(e));)e++;else return a=3,r.substring(g,e);let v=e;if(e<r.length&&(r.charCodeAt(e)===69||r.charCodeAt(e)===101))if(e++,(e<r.length&&r.charCodeAt(e)===43||r.charCodeAt(e)===45)&&e++,e<r.length&&dw(r.charCodeAt(e))){for(e++;e<r.length&&dw(r.charCodeAt(e));)e++;v=e}else a=3;return r.substring(g,v)}function p(){let g="",v=e;for(;;){if(e>=i){g+=r.substring(v,e),a=2;break}let I=r.charCodeAt(e);if(I===34){g+=r.substring(v,e),e++;break}if(I===92){if(g+=r.substring(v,e),e++,e>=i){a=2;break}switch(r.charCodeAt(e++)){case 34:g+='"';break;case 92:g+="\\";break;case 47:g+="/";break;case 98:g+="\b";break;case 102:g+="\f";break;case 110:g+=`
`;break;case 114:g+="\r";break;case 116:g+="	";break;case 117:{let w=l(4);w>=0?g+=String.fromCharCode(w):a=4;break}default:a=5}v=e;continue}if(I>=0&&I<=31)if(QN(I)){g+=r.substring(v,e),a=2;break}else a=6;e++}return g}function h(){if(n="",a=0,o=e,e>=i)return o=i,s=17;let g=r.charCodeAt(e);if(K3(g)){do e++,n+=String.fromCharCode(g),g=r.charCodeAt(e);while(K3(g));return s=15}if(QN(g))return e++,n+=String.fromCharCode(g),g===13&&r.charCodeAt(e)===10&&(e++,n+=`
`),s=14;switch(g){case 123:return e++,s=1;case 125:return e++,s=2;case 91:return e++,s=3;case 93:return e++,s=4;case 58:return e++,s=6;case 44:return e++,s=5;case 34:return e++,n=p(),s=10;case 47:{let v=e-1;if(r.charCodeAt(e+1)===47){for(e+=2;e<i&&!QN(r.charCodeAt(e));)e++;return n=r.substring(v,e),s=12}if(r.charCodeAt(e+1)===42){e+=2;let I=i-1,y=!1;for(;e<I;){if(r.charCodeAt(e)===42&&r.charCodeAt(e+1)===47){e+=2,y=!0;break}e++}return y||(e++,a=1),n=r.substring(v,e),s=13}return n+=String.fromCharCode(g),e++,s=16}case 45:if(n+=String.fromCharCode(g),e++,e===i||!dw(r.charCodeAt(e)))return s=16;case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return n+=c(),s=11;default:for(;e<i&&m(g);)e++,g=r.charCodeAt(e);if(o!==e){switch(n=r.substring(o,e),n){case"true":return s=8;case"false":return s=9;case"null":return s=7}return s=16}return n+=String.fromCharCode(g),e++,s=16}}function m(g){if(K3(g)||QN(g))return!1;switch(g){case 125:case 93:case 123:case 91:case 34:case 58:case 44:case 47:return!1}return!0}function f(){let g;do g=h();while(g>=12&&g<=15);return g}return{setPosition:d,getPosition:()=>e,scan:t?f:h,getToken:()=>s,getTokenValue:()=>n,getTokenOffset:()=>o,getTokenLength:()=>e-o,getTokenError:()=>a}}function K3(r){return r===32||r===9||r===11||r===12||r===160||r===5760||r>=8192&&r<=8203||r===8239||r===8287||r===12288||r===65279}function QN(r){return r===10||r===13||r===8232||r===8233}function dw(r){return r>=48&&r<=57}function Ak(r,t=[],e=ZN.DEFAULT){let i=null,n=[],o=[];function s(l){Array.isArray(n)?n.push(l):i!==null&&(n[i]=l)}return Ok(r,{onObjectBegin:()=>{let l={};s(l),o.push(n),n=l,i=null},onObjectProperty:l=>{i=l},onObjectEnd:()=>{n=o.pop()},onArrayBegin:()=>{let l=[];s(l),o.push(n),n=l,i=null},onArrayEnd:()=>{n=o.pop()},onLiteralValue:s,onError:(l,d,c)=>{t.push({error:l,offset:d,length:c})}},e),n[0]}function Wse(r,t=[],e=ZN.DEFAULT){let i={type:"array",offset:-1,length:-1,children:[],parent:void 0};function n(l){i.type==="property"&&(i.length=l-i.offset,i=i.parent)}function o(l){return i.children.push(l),l}Ok(r,{onObjectBegin:l=>{i=o({type:"object",offset:l,length:-1,parent:i,children:[]})},onObjectProperty:(l,d,c)=>{i=o({type:"property",offset:d,length:-1,parent:i,children:[]}),i.children.push({type:"string",value:l,offset:d,length:c,parent:i})},onObjectEnd:(l,d)=>{i.length=l+d-i.offset,i=i.parent,n(l+d)},onArrayBegin:(l,d)=>{i=o({type:"array",offset:l,length:-1,parent:i,children:[]})},onArrayEnd:(l,d)=>{i.length=l+d-i.offset,i=i.parent,n(l+d)},onLiteralValue:(l,d,c)=>{o({type:$3(l),offset:d,length:c,parent:i,value:l}),n(d+c)},onSeparator:(l,d,c)=>{i.type==="property"&&(l===":"?i.colonOffset=d:l===","&&n(d))},onError:(l,d,c)=>{t.push({error:l,offset:d,length:c})}},e);let a=i.children[0];return a&&delete a.parent,a}function q3(r,t){if(!r)return;let e=r;for(let i of t)if(typeof i=="string"){if(e.type!=="object"||!Array.isArray(e.children))return;let n=!1;for(let o of e.children)if(Array.isArray(o.children)&&o.children[0].value===i){e=o.children[1],n=!0;break}if(!n)return}else{let n=i;if(e.type!=="array"||n<0||!Array.isArray(e.children)||n>=e.children.length)return;e=e.children[n]}return e}function Ok(r,t,e=ZN.DEFAULT){let i=G3(r,!1);function n(O){return O?()=>O(i.getTokenOffset(),i.getTokenLength()):()=>!0}function o(O){return O?K=>O(K,i.getTokenOffset(),i.getTokenLength()):()=>!0}let s=n(t.onObjectBegin),a=o(t.onObjectProperty),l=n(t.onObjectEnd),d=n(t.onArrayBegin),c=n(t.onArrayEnd),p=o(t.onLiteralValue),h=o(t.onSeparator),m=n(t.onComment),f=o(t.onError),g=e&&e.disallowComments,v=e&&e.allowTrailingComma;function I(){for(;;){let O=i.scan();switch(i.getTokenError()){case 4:y(14);break;case 5:y(15);break;case 3:y(13);break;case 1:g||y(11);break;case 2:y(12);break;case 6:y(16);break}switch(O){case 12:case 13:g?y(10):m();break;case 16:y(1);break;case 15:case 14:break;default:return O}}}function y(O,K=[],G=[]){if(f(O),K.length+G.length>0){let Y=i.getToken();for(;Y!==17;){if(K.indexOf(Y)!==-1){I();break}else if(G.indexOf(Y)!==-1)break;Y=I()}}}function w(O){let K=i.getTokenValue();return O?p(K):a(K),I(),!0}function C(){switch(i.getToken()){case 11:{let O=0;try{O=JSON.parse(i.getTokenValue()),typeof O!="number"&&(y(2),O=0)}catch{y(2)}p(O);break}case 7:p(null);break;case 8:p(!0);break;case 9:p(!1);break;default:return!1}return I(),!0}function S(){return i.getToken()!==10?(y(3,[],[2,5]),!1):(w(!1),i.getToken()===6?(h(":"),I(),M()||y(4,[],[2,5])):y(5,[],[2,5]),!0)}function D(){s(),I();let O=!1;for(;i.getToken()!==2&&i.getToken()!==17;){if(i.getToken()===5){if(O||y(4,[],[]),h(","),I(),i.getToken()===2&&v)break}else O&&y(6,[],[]);S()||y(4,[],[2,5]),O=!0}return l(),i.getToken()!==2?y(7,[2],[]):I(),!0}function k(){d(),I();let O=!1;for(;i.getToken()!==4&&i.getToken()!==17;){if(i.getToken()===5){if(O||y(4,[],[]),h(","),I(),i.getToken()===4&&v)break}else O&&y(6,[],[]);M()||y(4,[],[4,5]),O=!0}return c(),i.getToken()!==4?y(8,[4],[]):I(),!0}function M(){switch(i.getToken()){case 3:return k();case 1:return D();case 10:return w(!0);default:return C()}}return I(),i.getToken()===17?e.allowEmptyContent?!0:(y(4,[],[]),!1):M()?(i.getToken()!==17&&y(9,[],[]),!0):(y(4,[],[]),!1)}function $3(r){switch(typeof r){case"boolean":return"boolean";case"number":return"number";case"string":return"string";case"object":{if(r){if(Array.isArray(r))return"array"}else return"null";return"object"}default:return"null"}}var j3=".vscode",$ye="settings",NSt=`${j3}/${$ye}.json`;var $m="vscode://schemas/launch";var FSt=[1],BSt=[2,3,4,5,6],jye=[3,4,5],VSt=[1,...jye],WSt=[2,3,4,5,6],Xye=[3,4,5,6],Yye=[4,5,6],JN="tasks",Use="launch",zse=Object.create(null);zse[JN]=`${j3}/${JN}.json`;zse[Use]=`${j3}/${Use}.json`;var Qye=Object.create(null);Qye[JN]=`${JN}.json`;var HSt=se;var X3=class extends Wf{_currentResultGroups=new Map;updateResultGroup(t,e){return e?this._currentResultGroups.set(t,e):this._currentResultGroups.delete(t),this.removeDuplicateResults(),this.update()}removeDuplicateResults(){let t=new Set;[...this._currentResultGroups.keys()].sort((e,i)=>this._currentResultGroups.get(e).order-this._currentResultGroups.get(i).order).forEach(e=>{let i=this._currentResultGroups.get(e);i.result.filterMatches=i.result.filterMatches.filter(n=>!t.has(n.setting.key)),i.result.filterMatches.forEach(n=>t.add(n.setting.key))})}filterSettings(t,e,i){let n=this.filterGroups,o=[];for(let s of n){let a=e(s);for(let l of s.sections)for(let d of l.settings){let c=i(d,s);(a||c)&&o.push({setting:d,matches:c&&c.matches,matchType:c?.matchType??0,score:c?.score??0})}}return o}getPreference(t){for(let e of this.settingsGroups)for(let i of e.sections)for(let n of i.settings)if(t===n.key)return n}collectMetadata(t){let e=Object.create(null),i=!1;return t.forEach(n=>{n.result.metadata&&(e[n.id]=n.result.metadata,i=!0)}),i?e:null}get filterGroups(){return this.settingsGroups}};var e1=class extends X3{constructor(e,i){super();this._defaultSettings=e;this._register(i.onDidChangeConfiguration(n=>{n.source===7&&(this.dirty=!0,this._onDidChangeGroups.fire())})),this._register(Pe.as(ur.Configuration).onDidSchemaChange(n=>{this.dirty=!0,this._onDidChangeGroups.fire()}))}_onDidChangeGroups=this._register(new x);onDidChangeGroups=this._onDidChangeGroups.event;additionalGroups=[];dirty=!1;get filterGroups(){return this.settingsGroups.slice(1)}get settingsGroups(){let e=this._defaultSettings.getSettingsGroups(this.dirty);return this.dirty=!1,[...e,...this.additionalGroups]}setAdditionalGroups(e){this.additionalGroups=e}findValueMatches(e,i){return[]}update(){throw new Error("Not supported")}};e1=E([b(1,se)],e1);function Zye(r){return"// "+u("defaultKeybindingsHeader","Override key bindings by placing them into your key bindings file.")+`
`+r.getDefaultKeybindingsContent()}var t1=class{constructor(t,e){this._uri=t;this.keybindingService=e}_content;get uri(){return this._uri}get content(){return this._content||(this._content=Zye(this.keybindingService)),this._content}getPreference(){return null}dispose(){}};t1=E([b(1,Be)],t1);var jm=q("preferencesService");var Ld={EditorPane:"workbench.contributions.editors",EditorFactory:"workbench.contributions.editor.inputFactories"},uw={id:"default",displayName:u("promptOpenWith.defaultEditor.displayName","Text Editor"),providerDisplayName:u("builtinProviderDisplayName","Built-in")},Kse="workbench.editor.sidebysideEditor",n1="workbench.editors.textDiffEditor",Gse="workbench.editors.binaryResourceDiffEditor";function e7(r){let t=r;return!!t&&typeof t.getSelection=="function"&&!!t.onDidChangeSelection}function KN(r,t,e){for(let i of e.visibleEditorPanes)if(i.group.id===t&&r.matches(i.input))return i.getViewState()}function Lse(r){if(kr(r))return!1;let t=r;return Z.isUri(t?.resource)}function kd(r){if(kr(r))return!1;let t=r;return t?.original!==void 0&&t.modified!==void 0}function nw(r){if(kr(r))return!1;let t=r;return!t||t.resources&&!Array.isArray(t.resources)?!1:!!t.resources||!!t.multiDiffSource}function Xp(r){if(kr(r)||kd(r))return!1;let t=r;return t?.primary!==void 0&&t.secondary!==void 0}function Yp(r){if(kr(r))return!1;let t=r;return Z.isUri(t?.base?.resource)&&Z.isUri(t?.input1?.resource)&&Z.isUri(t?.input2?.resource)&&Z.isUri(t?.result?.resource)}var Y3=class{mapIdToSaveSource=new Map;registerSource(t,e){let i=this.mapIdToSaveSource.get(t);return i||(i={source:t,label:e},this.mapIdToSaveSource.set(t,i)),i.source}getSourceLabel(t){return this.mapIdToSaveSource.get(t)?.label??t}},LEt=new Y3;var Lk=class extends R{};function kr(r){return r instanceof Lk}function Jye(r){let t=r;return Z.isUri(t?.preferredResource)}function eSe(r){let t=r;return kr(t?.primary)&&kr(t?.secondary)}function A3(r){let t=r;return kr(t?.modified)&&kr(t?.original)}function qse(r,t,e,i,n){return tSe(i,[fn({id:"workbench.action.openLargeFile",label:u("openLargeFile","Open Anyway"),run:()=>{let o={...e,limits:{size:Number.MAX_VALUE}};r.openEditor(t,o)}}),fn({id:"workbench.action.configureEditorLargeFileConfirmation",label:u("configureEditorLargeFileConfirmation","Configure Limit"),run:()=>n.openUserSettings({query:"workbench.editorLargeFileConfirmation"})})],{forceMessage:!0,forceSeverity:Si.Warning})}function o1(r){let t=r;return typeof t?.groupId=="number"&&kr(t.editor)}var Q3=class{getOriginalUri(t,e){if(!t)return;if(Yp(t))return ro.getOriginalUri(t.result,e);if(e?.supportSideBySide){let{primary:n,secondary:o}=this.getSideEditors(t);if(n&&o){if(e?.supportSideBySide===3)return{primary:this.getOriginalUri(n,{filterByScheme:e.filterByScheme}),secondary:this.getOriginalUri(o,{filterByScheme:e.filterByScheme})};if(e?.supportSideBySide===4)return this.getOriginalUri(n,{filterByScheme:e.filterByScheme})??this.getOriginalUri(o,{filterByScheme:e.filterByScheme});t=e.supportSideBySide===1?n:o}}if(kd(t)||nw(t)||Xp(t)||Yp(t))return;let i=Jye(t)?t.preferredResource:t.resource;return!i||!e||!e.filterByScheme?i:this.filterUri(i,e.filterByScheme)}getSideEditors(t){return eSe(t)||Xp(t)?{primary:t.primary,secondary:t.secondary}:A3(t)||kd(t)?{primary:t.modified,secondary:t.original}:{primary:void 0,secondary:void 0}}getCanonicalUri(t,e){if(!t)return;if(Yp(t))return ro.getCanonicalUri(t.result,e);if(e?.supportSideBySide){let{primary:n,secondary:o}=this.getSideEditors(t);if(n&&o){if(e?.supportSideBySide===3)return{primary:this.getCanonicalUri(n,{filterByScheme:e.filterByScheme}),secondary:this.getCanonicalUri(o,{filterByScheme:e.filterByScheme})};if(e?.supportSideBySide===4)return this.getCanonicalUri(n,{filterByScheme:e.filterByScheme})??this.getCanonicalUri(o,{filterByScheme:e.filterByScheme});t=e.supportSideBySide===1?n:o}}if(kd(t)||nw(t)||Xp(t)||Yp(t))return;let i=t.resource;return!i||!e||!e.filterByScheme?i:this.filterUri(i,e.filterByScheme)}filterUri(t,e){if(Array.isArray(e)){if(e.some(i=>t.scheme===i))return t}else if(e===t.scheme)return t}};function r1(r,t,e,i){if(!r.isSticky(t))return!1;switch(i.preventPinnedEditorClose){case"keyboardAndMouse":return e===2||e===1;case"mouse":return e===2;case"keyboard":return e===1}return!1}var ro=new Q3;var Z3=class{instantiationService;fileEditorFactory;editorSerializerConstructors=new Map;editorSerializerInstances=new Map;start(t){let e=this.instantiationService=t.get(ne);for(let[i,n]of this.editorSerializerConstructors)this.createEditorSerializer(i,n,e);this.editorSerializerConstructors.clear()}createEditorSerializer(t,e,i){let n=i.createInstance(e);this.editorSerializerInstances.set(t,n)}registerFileEditorFactory(t){if(this.fileEditorFactory)throw new Error("Can only register one file editor factory.");this.fileEditorFactory=t}getFileEditorFactory(){return Yt(this.fileEditorFactory)}registerEditorSerializer(t,e){if(this.editorSerializerConstructors.has(t)||this.editorSerializerInstances.has(t))throw new Error(`A editor serializer with type ID '${t}' was already registered.`);return this.instantiationService?this.createEditorSerializer(t,e,this.instantiationService):this.editorSerializerConstructors.set(t,e),le(()=>{this.editorSerializerConstructors.delete(t),this.editorSerializerInstances.delete(t)})}getEditorSerializer(t){return this.editorSerializerInstances.get(typeof t=="string"?t:t.typeId)}};Pe.add(Ld.EditorFactory,new Z3);function Nk(r){let t=r;if(!t)return!1;let e=t;if(e.modified)return Nk(e.modified);let i=t;return!!(i.contributionsState&&i.viewState&&Array.isArray(i.cursorState))}function tSe(r,t,e){let i=WC(r,t);return i.forceMessage=e?.forceMessage,i.forceSeverity=e?.forceSeverity,i.allowDialog=e?.allowDialog,i}function s1(r){return JSON.stringify(r,iSe)}function pw(r){let t=JSON.parse(r);return t=Wl(t),t}function iSe(r,t){return t instanceof RegExp?{$mid:2,source:t.source,flags:t.flags}:t}function Wl(r,t=0){if(!r||t>200)return r;if(typeof r=="object"){switch(r.$mid){case 1:return Z.revive(r);case 2:return new RegExp(r.source,r.flags);case 17:return new Date(r.source)}if(r instanceof Jt||r instanceof Uint8Array)return r;if(Array.isArray(r))for(let e=0;e<r.length;++e)r[e]=Wl(r[e],t+1);else for(let e in r)Object.hasOwnProperty.call(r,e)&&(r[e]=Wl(r[e],t+1))}return r}var hw=class r extends R{constructor(e,i=Object.create(null)){super();this.database=e;this.options=i;this.registerListeners()}static DEFAULT_FLUSH_DELAY=100;_onDidChangeStorage=this._register(new hd);onDidChangeStorage=this._onDidChangeStorage.event;state=0;cache=new Map;flushDelayer=this._register(new lf(r.DEFAULT_FLUSH_DELAY));pendingDeletes=new Set;pendingInserts=new Map;pendingClose=void 0;whenFlushedCallbacks=[];registerListeners(){this._register(this.database.onDidChangeItemsExternal(e=>this.onDidChangeItemsExternal(e)))}onDidChangeItemsExternal(e){this._onDidChangeStorage.pause();try{e.changed?.forEach((i,n)=>this.acceptExternal(n,i)),e.deleted?.forEach(i=>this.acceptExternal(i,void 0))}finally{this._onDidChangeStorage.resume()}}acceptExternal(e,i){if(this.state===2)return;let n=!1;Wn(i)?n=this.cache.delete(e):this.cache.get(e)!==i&&(this.cache.set(e,i),n=!0),n&&this._onDidChangeStorage.fire({key:e,external:!0})}get items(){return this.cache}get size(){return this.cache.size}async init(){this.state===0&&(this.state=1,this.options.hint!==0&&(this.cache=await this.database.getItems()))}get(e,i){let n=this.cache.get(e);return Wn(n)?i:n}getBoolean(e,i){let n=this.get(e);return Wn(n)?i:n==="true"}getNumber(e,i){let n=this.get(e);return Wn(n)?i:parseInt(n,10)}getObject(e,i){let n=this.get(e);return Wn(n)?i:pw(n)}async set(e,i,n=!1){if(this.state===2)return;if(Wn(i))return this.delete(e,n);let o=vi(i)||Array.isArray(i)?s1(i):String(i);if(this.cache.get(e)!==o)return this.cache.set(e,o),this.pendingInserts.set(e,o),this.pendingDeletes.delete(e),this._onDidChangeStorage.fire({key:e,external:n}),this.doFlush()}async delete(e,i=!1){if(!(this.state===2||!this.cache.delete(e)))return this.pendingDeletes.has(e)||this.pendingDeletes.add(e),this.pendingInserts.delete(e),this._onDidChangeStorage.fire({key:e,external:i}),this.doFlush()}async optimize(){if(this.state!==2)return await this.flush(0),this.database.optimize()}async close(){return this.pendingClose||(this.pendingClose=this.doClose()),this.pendingClose}async doClose(){this.state=2;try{await this.doFlush(0)}catch{}await this.database.close(()=>this.cache)}get hasPending(){return this.pendingInserts.size>0||this.pendingDeletes.size>0}async flushPending(){if(!this.hasPending)return;let e={insert:this.pendingInserts,delete:this.pendingDeletes};return this.pendingDeletes=new Set,this.pendingInserts=new Map,this.database.updateItems(e).finally(()=>{if(!this.hasPending)for(;this.whenFlushedCallbacks.length;)this.whenFlushedCallbacks.pop()?.()})}async flush(e){if(!(this.state===2||this.pendingClose))return this.doFlush(e)}async doFlush(e){return this.options.hint===1?this.flushPending():this.flushDelayer.trigger(()=>this.flushPending(),e)}async whenFlushed(){if(this.hasPending)return new Promise(e=>this.whenFlushedCallbacks.push(e))}isInMemory(){return this.options.hint===1}},mw=class{onDidChangeItemsExternal=X.None;items=new Map;async getItems(){return this.items}async updateItems(t){t.insert?.forEach((e,i)=>this.items.set(i,e)),t.delete?.forEach(e=>this.items.delete(e))}async optimize(){}async close(){}};var nSe="__$__isNewStorageMarker",a1="__$__targetStorageMarker",nt=q("storageService");function oSe(r){let t=r.get(a1);if(t)try{return JSON.parse(t)}catch{}return Object.create(null)}var t7=class r extends R{constructor(e={flushInterval:r.DEFAULT_FLUSH_INTERVAL}){super();this.options=e}static DEFAULT_FLUSH_INTERVAL=60*1e3;_onDidChangeValue=this._register(new hd);_onDidChangeTarget=this._register(new hd);onDidChangeTarget=this._onDidChangeTarget.event;_onWillSaveState=this._register(new x);onWillSaveState=this._onWillSaveState.event;initializationPromise;flushWhenIdleScheduler=this._register(new Ye(()=>this.doFlushWhenIdle(),this.options.flushInterval));runFlushWhenIdle=this._register(new yt);onDidChangeValue(e,i,n){return X.filter(this._onDidChangeValue.event,o=>o.scope===e&&(i===void 0||o.key===i),n)}doFlushWhenIdle(){this.runFlushWhenIdle.value=df(()=>{this.shouldFlushWhenIdle()&&this.flush(),this.flushWhenIdleScheduler.schedule()})}shouldFlushWhenIdle(){return!0}stopFlushWhenIdle(){_e([this.runFlushWhenIdle,this.flushWhenIdleScheduler])}initialize(){return this.initializationPromise||(this.initializationPromise=(async()=>{fr("code/willInitStorage");try{await this.doInitialize()}finally{fr("code/didInitStorage")}this.flushWhenIdleScheduler.schedule()})()),this.initializationPromise}emitDidChangeValue(e,i){let{key:n,external:o}=i;if(n===a1){switch(e){case-1:this._applicationKeyTargets=void 0;break;case 0:this._profileKeyTargets=void 0;break;case 1:this._workspaceKeyTargets=void 0;break}this._onDidChangeTarget.fire({scope:e})}else this._onDidChangeValue.fire({scope:e,key:n,target:this.getKeyTargets(e)[n],external:o})}emitWillSaveState(e){this._onWillSaveState.fire({reason:e})}get(e,i,n){return this.getStorage(i)?.get(e,n)}getBoolean(e,i,n){return this.getStorage(i)?.getBoolean(e,n)}getNumber(e,i,n){return this.getStorage(i)?.getNumber(e,n)}getObject(e,i,n){return this.getStorage(i)?.getObject(e,n)}storeAll(e,i){this.withPausedEmitters(()=>{for(let n of e)this.store(n.key,n.value,n.scope,n.target,i)})}store(e,i,n,o,s=!1){if(Wn(i)){this.remove(e,n,s);return}this.withPausedEmitters(()=>{this.updateKeyTarget(e,n,o),this.getStorage(n)?.set(e,i,s)})}remove(e,i,n=!1){this.withPausedEmitters(()=>{this.updateKeyTarget(e,i,void 0),this.getStorage(i)?.delete(e,n)})}withPausedEmitters(e){this._onDidChangeValue.pause(),this._onDidChangeTarget.pause();try{e()}finally{this._onDidChangeValue.resume(),this._onDidChangeTarget.resume()}}keys(e,i){let n=[],o=this.getKeyTargets(e);for(let s of Object.keys(o))o[s]===i&&n.push(s);return n}updateKeyTarget(e,i,n,o=!1){let s=this.getKeyTargets(i);typeof n=="number"?s[e]!==n&&(s[e]=n,this.getStorage(i)?.set(a1,JSON.stringify(s),o)):typeof s[e]=="number"&&(delete s[e],this.getStorage(i)?.set(a1,JSON.stringify(s),o))}_workspaceKeyTargets=void 0;get workspaceKeyTargets(){return this._workspaceKeyTargets||(this._workspaceKeyTargets=this.loadKeyTargets(1)),this._workspaceKeyTargets}_profileKeyTargets=void 0;get profileKeyTargets(){return this._profileKeyTargets||(this._profileKeyTargets=this.loadKeyTargets(0)),this._profileKeyTargets}_applicationKeyTargets=void 0;get applicationKeyTargets(){return this._applicationKeyTargets||(this._applicationKeyTargets=this.loadKeyTargets(-1)),this._applicationKeyTargets}getKeyTargets(e){switch(e){case-1:return this.applicationKeyTargets;case 0:return this.profileKeyTargets;default:return this.workspaceKeyTargets}}loadKeyTargets(e){let i=this.getStorage(e);return i?oSe(i):Object.create(null)}isNew(e){return this.getBoolean(nSe,e)===!0}async flush(e=0){this._onWillSaveState.fire({reason:e});let i=this.getStorage(-1),n=this.getStorage(0),o=this.getStorage(1);switch(e){case 0:await Xa.settled([i?.whenFlushed()??Promise.resolve(),n?.whenFlushed()??Promise.resolve(),o?.whenFlushed()??Promise.resolve()]);break;case 1:await Xa.settled([i?.flush(0)??Promise.resolve(),n?.flush(0)??Promise.resolve(),o?.flush(0)??Promise.resolve()]);break}}async log(){let e=this.getStorage(-1)?.items??new Map,i=this.getStorage(0)?.items??new Map,n=this.getStorage(1)?.items??new Map;return rSe(e,i,n,this.getLogDetails(-1)??"",this.getLogDetails(0)??"",this.getLogDetails(1)??"")}async optimize(e){return await this.flush(),this.getStorage(e)?.optimize()}async switch(e,i){return this.emitWillSaveState(0),Rse(e)?this.switchToProfile(e,i):this.switchToWorkspace(e,i)}canSwitchProfile(e,i){return!(e.id===i.id||$se(i)&&$se(e))}switchData(e,i,n){this.withPausedEmitters(()=>{let o=new Set;for(let[s,a]of e)o.add(s),i.get(s)!==a&&this.emitDidChangeValue(n,{key:s,external:!0});for(let[s]of i.items)o.has(s)||this.emitDidChangeValue(n,{key:s,external:!0})})}};function $se(r){return r.isDefault||!!r.useDefaultFlags?.globalState}var l1=class extends t7{applicationStorage=this._register(new hw(new mw,{hint:1}));profileStorage=this._register(new hw(new mw,{hint:1}));workspaceStorage=this._register(new hw(new mw,{hint:1}));constructor(){super(),this._register(this.workspaceStorage.onDidChangeStorage(t=>this.emitDidChangeValue(1,t))),this._register(this.profileStorage.onDidChangeStorage(t=>this.emitDidChangeValue(0,t))),this._register(this.applicationStorage.onDidChangeStorage(t=>this.emitDidChangeValue(-1,t)))}getStorage(t){switch(t){case-1:return this.applicationStorage;case 0:return this.profileStorage;default:return this.workspaceStorage}}getLogDetails(t){switch(t){case-1:return"inMemory (application)";case 0:return"inMemory (profile)";default:return"inMemory (workspace)"}}async doInitialize(){}async switchToProfile(){}async switchToWorkspace(){}shouldFlushWhenIdle(){return!1}hasScope(t){return!1}};async function rSe(r,t,e,i,n,o){let s=g=>{try{return JSON.parse(g)}catch{return g}},a=new Map,l=new Map;r.forEach((g,v)=>{a.set(v,g),l.set(v,s(g))});let d=new Map,c=new Map;t.forEach((g,v)=>{d.set(v,g),c.set(v,s(g))});let p=new Map,h=new Map;e.forEach((g,v)=>{p.set(v,g),h.set(v,s(g))}),console.group(i!==n?`Storage: Application (path: ${i})`:`Storage: Application & Profile (path: ${i}, default profile)`);let m=[];if(a.forEach((g,v)=>{m.push({key:v,value:g})}),console.table(m),console.groupEnd(),console.log(l),i!==n){console.group(`Storage: Profile (path: ${n}, profile specific)`);let g=[];d.forEach((v,I)=>{g.push({key:I,value:v})}),console.table(g),console.groupEnd(),console.log(c)}console.group(`Storage: Workspace (path: ${o})`);let f=[];p.forEach((g,v)=>{f.push({key:v,value:g})}),console.table(f),console.groupEnd(),console.log(h)}var gw=class r{constructor(t,e){this.storageService=e;this.id=r.COMMON_PREFIX+t}static applicationMementos=new Map;static profileMementos=new Map;static workspaceMementos=new Map;static COMMON_PREFIX="memento/";id;getMemento(t,e){switch(t){case 1:{let i=r.workspaceMementos.get(this.id);return i||(i=new Fk(this.id,t,e,this.storageService),r.workspaceMementos.set(this.id,i)),i.getMemento()}case 0:{let i=r.profileMementos.get(this.id);return i||(i=new Fk(this.id,t,e,this.storageService),r.profileMementos.set(this.id,i)),i.getMemento()}case-1:{let i=r.applicationMementos.get(this.id);return i||(i=new Fk(this.id,t,e,this.storageService),r.applicationMementos.set(this.id,i)),i.getMemento()}}}onDidChangeValue(t,e){return this.storageService.onDidChangeValue(t,this.id,e)}saveMemento(){r.workspaceMementos.get(this.id)?.save(),r.profileMementos.get(this.id)?.save(),r.applicationMementos.get(this.id)?.save()}reloadMemento(t){let e;switch(t){case-1:e=r.applicationMementos.get(this.id);break;case 0:e=r.profileMementos.get(this.id);break;case 1:e=r.workspaceMementos.get(this.id);break}e?.reload()}static clear(t){switch(t){case 1:r.workspaceMementos.clear();break;case 0:r.profileMementos.clear();break;case-1:r.applicationMementos.clear();break}}},Fk=class{constructor(t,e,i,n){this.id=t;this.scope=e;this.target=i;this.storageService=n;this.mementoObj=this.doLoad()}mementoObj;doLoad(){try{return this.storageService.getObject(this.id,this.scope,{})}catch(t){Xe(`[memento]: failed to parse contents: ${t} (id: ${this.id}, scope: ${this.scope}, contents: ${this.storageService.get(this.id,this.scope)})`)}return{}}getMemento(){return this.mementoObj}reload(){for(let t of Object.getOwnPropertyNames(this.mementoObj))delete this.mementoObj[t];Object.assign(this.mementoObj,this.doLoad())}save(){jv(this.mementoObj)?this.storageService.remove(this.id,this.scope):this.storageService.store(this.id,this.mementoObj,this.scope,this.target)}};var Xm=class extends fc{constructor(e,i,n){super(i);this.id=e;this.memento=new gw(this.id,n),this._register(n.onWillSaveState(()=>{this.saveState(),this.memento.saveMemento()}))}memento;getId(){return this.id}getMemento(e,i){return this.memento.getMemento(e,i)}reloadMemento(e){return this.memento.reloadMemento(e)}onDidChangeMementoValue(e,i){return this.memento.onDidChangeValue(e,i)}saveState(){}};var d1=class extends R{timeout;constructor(t,e){super(),this._register(F(t,"dragover",i=>{i.preventDefault(),this.timeout||(this.timeout=setTimeout(()=>{e(),this.timeout=null},800))})),["dragleave","drop","dragend"].forEach(i=>{this._register(F(t,i,()=>{this.clearDragTimeout()}))})}clearDragTimeout(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null)}dispose(){super.dispose(),this.clearDragTimeout()}},_a={RESOURCES:"ResourceURLs",DOWNLOAD_URL:"DownloadURL",FILES:"Files",TEXT:Oo.text,INTERNAL_URI_LIST:"application/vnd.code.uri-list"};function c1(r,t,e,i,n){let o=document.createElement("div");o.className=e,o.textContent=t,n&&(o.style.color=n),i&&(o.style.background=i),r.dataTransfer&&(ue(r).document.body.appendChild(o),r.dataTransfer.setDragImage(o,-10,-10),setTimeout(()=>o.remove(),0))}var ts;(n=>{function r(o,s){if(o.start>=s.end||s.start>=o.end)return{start:0,end:0};let a=Math.max(o.start,s.start),l=Math.min(o.end,s.end);return l-a<=0?{start:0,end:0}:{start:a,end:l}}n.intersect=r;function t(o){return o.end-o.start<=0}n.isEmpty=t;function e(o,s){return!t(r(o,s))}n.intersects=e;function i(o,s){let a=[],l={start:o.start,end:Math.min(s.start,o.end)},d={start:Math.max(s.end,o.start),end:o.end};return t(l)||a.push(l),t(d)||a.push(d),a}n.relativeComplement=i})(ts||={});function i7(r,t,e){let i=e.mode===1?e.offset:e.offset+e.size,n=e.mode===1?e.offset+e.size:e.offset;return e.position===0?t<=r-i?i:t<=n?n-t:Math.max(r-t,0):t<=n?n-t:t<=r-i?i:0}var Hl=class{_hooks=new B;_pointerMoveCallback=null;_onStopCallback=null;dispose(){this.stopMonitoring(!1),this._hooks.dispose()}stopMonitoring(t,e){if(!this.isMonitoring())return;this._hooks.clear(),this._pointerMoveCallback=null;let i=this._onStopCallback;this._onStopCallback=null,t&&i&&i(e)}isMonitoring(){return!!this._pointerMoveCallback}startMonitoring(t,e,i,n,o){this.isMonitoring()&&this.stopMonitoring(!1),this._pointerMoveCallback=n,this._onStopCallback=o;let s=t;try{t.setPointerCapture(e),this._hooks.add(le(()=>{try{t.releasePointerCapture(e)}catch{}}))}catch{s=ue(t)}this._hooks.add(F(s,Q.POINTER_MOVE,a=>{if(a.buttons!==i){this.stopMonitoring(!0);return}a.preventDefault(),this._pointerMoveCallback(a)})),this._hooks.add(F(s,Q.POINTER_UP,a=>this.stopMonitoring(!0)))}};var ko=class extends R{onclick(t,e){this._register(F(t,Q.CLICK,i=>e(new _i(ue(t),i))))}onmousedown(t,e){this._register(F(t,Q.MOUSE_DOWN,i=>e(new _i(ue(t),i))))}onmouseover(t,e){this._register(F(t,Q.MOUSE_OVER,i=>e(new _i(ue(t),i))))}onmouseleave(t,e){this._register(F(t,Q.MOUSE_LEAVE,i=>e(new _i(ue(t),i))))}onkeydown(t,e){this._register(F(t,Q.KEY_DOWN,i=>e(new ut(i))))}onkeyup(t,e){this._register(F(t,Q.KEY_UP,i=>e(new ut(i))))}oninput(t,e){this._register(F(t,Q.INPUT,e))}onblur(t,e){this._register(F(t,Q.BLUR,e))}onfocus(t,e){this._register(F(t,Q.FOCUS,e))}onchange(t,e){this._register(F(t,Q.CHANGE,e))}ignoreGesture(t){return yi.ignoreTarget(t)}};var jf=11,u1=class extends ko{_onActivate;bgDomNode;domNode;_pointerdownRepeatTimer;_pointerdownScheduleRepeatTimer;_pointerMoveMonitor;constructor(t){super(),this._onActivate=t.onActivate,this.bgDomNode=document.createElement("div"),this.bgDomNode.className="arrow-background",this.bgDomNode.style.position="absolute",this.bgDomNode.style.width=t.bgWidth+"px",this.bgDomNode.style.height=t.bgHeight+"px",typeof t.top<"u"&&(this.bgDomNode.style.top="0px"),typeof t.left<"u"&&(this.bgDomNode.style.left="0px"),typeof t.bottom<"u"&&(this.bgDomNode.style.bottom="0px"),typeof t.right<"u"&&(this.bgDomNode.style.right="0px"),this.domNode=document.createElement("div"),this.domNode.className=t.className,this.domNode.classList.add(...de.asClassNameArray(t.icon)),this.domNode.style.position="absolute",this.domNode.style.width=jf+"px",this.domNode.style.height=jf+"px",typeof t.top<"u"&&(this.domNode.style.top=t.top+"px"),typeof t.left<"u"&&(this.domNode.style.left=t.left+"px"),typeof t.bottom<"u"&&(this.domNode.style.bottom=t.bottom+"px"),typeof t.right<"u"&&(this.domNode.style.right=t.right+"px"),this._pointerMoveMonitor=this._register(new Hl),this._register(Ut(this.bgDomNode,Q.POINTER_DOWN,e=>this._arrowPointerDown(e))),this._register(Ut(this.domNode,Q.POINTER_DOWN,e=>this._arrowPointerDown(e))),this._pointerdownRepeatTimer=this._register(new $S),this._pointerdownScheduleRepeatTimer=this._register(new Qs)}_arrowPointerDown(t){if(!t.target||!(t.target instanceof Element))return;let e=()=>{this._pointerdownRepeatTimer.cancelAndSet(()=>this._onActivate(),1e3/24,ue(t))};this._onActivate(),this._pointerdownRepeatTimer.cancel(),this._pointerdownScheduleRepeatTimer.cancelAndSet(e,200),this._pointerMoveMonitor.startMonitoring(t.target,t.pointerId,t.buttons,i=>{},()=>{this._pointerdownRepeatTimer.cancel(),this._pointerdownScheduleRepeatTimer.cancel()}),t.preventDefault()}};var Xf=class r{_scrollbarSize;_oppositeScrollbarSize;_arrowSize;_visibleSize;_scrollSize;_scrollPosition;_computedAvailableSize;_computedIsNeeded;_computedSliderSize;_computedSliderRatio;_computedSliderPosition;constructor(t,e,i,n,o,s){this._scrollbarSize=Math.round(e),this._oppositeScrollbarSize=Math.round(i),this._arrowSize=Math.round(t),this._visibleSize=n,this._scrollSize=o,this._scrollPosition=s,this._computedAvailableSize=0,this._computedIsNeeded=!1,this._computedSliderSize=0,this._computedSliderRatio=0,this._computedSliderPosition=0,this._refreshComputedValues()}clone(){return new r(this._arrowSize,this._scrollbarSize,this._oppositeScrollbarSize,this._visibleSize,this._scrollSize,this._scrollPosition)}setVisibleSize(t){let e=Math.round(t);return this._visibleSize!==e?(this._visibleSize=e,this._refreshComputedValues(),!0):!1}setScrollSize(t){let e=Math.round(t);return this._scrollSize!==e?(this._scrollSize=e,this._refreshComputedValues(),!0):!1}setScrollPosition(t){let e=Math.round(t);return this._scrollPosition!==e?(this._scrollPosition=e,this._refreshComputedValues(),!0):!1}setScrollbarSize(t){this._scrollbarSize=Math.round(t)}setOppositeScrollbarSize(t){this._oppositeScrollbarSize=Math.round(t)}static _computeValues(t,e,i,n,o){let s=Math.max(0,i-t),a=Math.max(0,s-2*e),l=n>0&&n>i;if(!l)return{computedAvailableSize:Math.round(s),computedIsNeeded:l,computedSliderSize:Math.round(a),computedSliderRatio:0,computedSliderPosition:0};let d=Math.round(Math.max(20,Math.floor(i*a/n))),c=(a-d)/(n-i),p=o*c;return{computedAvailableSize:Math.round(s),computedIsNeeded:l,computedSliderSize:Math.round(d),computedSliderRatio:c,computedSliderPosition:Math.round(p)}}_refreshComputedValues(){let t=r._computeValues(this._oppositeScrollbarSize,this._arrowSize,this._visibleSize,this._scrollSize,this._scrollPosition);this._computedAvailableSize=t.computedAvailableSize,this._computedIsNeeded=t.computedIsNeeded,this._computedSliderSize=t.computedSliderSize,this._computedSliderRatio=t.computedSliderRatio,this._computedSliderPosition=t.computedSliderPosition}getArrowSize(){return this._arrowSize}getScrollPosition(){return this._scrollPosition}getRectangleLargeSize(){return this._computedAvailableSize}getRectangleSmallSize(){return this._scrollbarSize}isNeeded(){return this._computedIsNeeded}getSliderSize(){return this._computedSliderSize}getSliderPosition(){return this._computedSliderPosition}getDesiredScrollPositionFromOffset(t){if(!this._computedIsNeeded)return 0;let e=t-this._arrowSize-this._computedSliderSize/2;return Math.round(e/this._computedSliderRatio)}getDesiredScrollPositionFromOffsetPaged(t){if(!this._computedIsNeeded)return 0;let e=t-this._arrowSize,i=this._scrollPosition;return e<this._computedSliderPosition?i-=this._visibleSize:i+=this._visibleSize,i}getDesiredScrollPositionFromDelta(t){if(!this._computedIsNeeded)return 0;let e=this._computedSliderPosition+t;return Math.round(e/this._computedSliderRatio)}};var p1=class extends R{_visibility;_visibleClassName;_invisibleClassName;_domNode;_rawShouldBeVisible;_shouldBeVisible;_isNeeded;_isVisible;_revealTimer;constructor(t,e,i){super(),this._visibility=t,this._visibleClassName=e,this._invisibleClassName=i,this._domNode=null,this._isVisible=!1,this._isNeeded=!1,this._rawShouldBeVisible=!1,this._shouldBeVisible=!1,this._revealTimer=this._register(new Qs)}setVisibility(t){this._visibility!==t&&(this._visibility=t,this._updateShouldBeVisible())}setShouldBeVisible(t){this._rawShouldBeVisible=t,this._updateShouldBeVisible()}_applyVisibilitySetting(){return this._visibility===2?!1:this._visibility===3?!0:this._rawShouldBeVisible}_updateShouldBeVisible(){let t=this._applyVisibilitySetting();this._shouldBeVisible!==t&&(this._shouldBeVisible=t,this.ensureVisibility())}setIsNeeded(t){this._isNeeded!==t&&(this._isNeeded=t,this.ensureVisibility())}setDomNode(t){this._domNode=t,this._domNode.setClassName(this._invisibleClassName),this.setShouldBeVisible(!1)}ensureVisibility(){if(!this._isNeeded){this._hide(!1);return}this._shouldBeVisible?this._reveal():this._hide(!0)}_reveal(){this._isVisible||(this._isVisible=!0,this._revealTimer.setIfNotSet(()=>{this._domNode?.setClassName(this._visibleClassName)},0))}_hide(t){this._revealTimer.cancel(),this._isVisible&&(this._isVisible=!1,this._domNode?.setClassName(this._invisibleClassName+(t?" fade":"")))}};var sSe=140,fw=class extends ko{_host;_scrollable;_scrollByPage;_lazyRender;_scrollbarState;_visibilityController;_pointerMoveMonitor;domNode;slider;_shouldRender;constructor(t){super(),this._lazyRender=t.lazyRender,this._host=t.host,this._scrollable=t.scrollable,this._scrollByPage=t.scrollByPage,this._scrollbarState=t.scrollbarState,this._visibilityController=this._register(new p1(t.visibility,"visible scrollbar "+t.extraScrollbarClassName,"invisible scrollbar "+t.extraScrollbarClassName)),this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._pointerMoveMonitor=this._register(new Hl),this._shouldRender=!0,this.domNode=Ot(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this._visibilityController.setDomNode(this.domNode),this.domNode.setPosition("absolute"),this._register(F(this.domNode.domNode,Q.POINTER_DOWN,e=>this._domNodePointerDown(e)))}_createArrow(t){let e=this._register(new u1(t));this.domNode.domNode.appendChild(e.bgDomNode),this.domNode.domNode.appendChild(e.domNode)}_createSlider(t,e,i,n){this.slider=Ot(document.createElement("div")),this.slider.setClassName("slider"),this.slider.setPosition("absolute"),this.slider.setTop(t),this.slider.setLeft(e),typeof i=="number"&&this.slider.setWidth(i),typeof n=="number"&&this.slider.setHeight(n),this.slider.setLayerHinting(!0),this.slider.setContain("strict"),this.domNode.domNode.appendChild(this.slider.domNode),this._register(F(this.slider.domNode,Q.POINTER_DOWN,o=>{o.button===0&&(o.preventDefault(),this._sliderPointerDown(o))})),this.onclick(this.slider.domNode,o=>{o.leftButton&&o.stopPropagation()})}_onElementSize(t){return this._scrollbarState.setVisibleSize(t)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollSize(t){return this._scrollbarState.setScrollSize(t)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollPosition(t){return this._scrollbarState.setScrollPosition(t)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}beginReveal(){this._visibilityController.setShouldBeVisible(!0)}beginHide(){this._visibilityController.setShouldBeVisible(!1)}render(){this._shouldRender&&(this._shouldRender=!1,this._renderDomNode(this._scrollbarState.getRectangleLargeSize(),this._scrollbarState.getRectangleSmallSize()),this._updateSlider(this._scrollbarState.getSliderSize(),this._scrollbarState.getArrowSize()+this._scrollbarState.getSliderPosition()))}_domNodePointerDown(t){t.target===this.domNode.domNode&&this._onPointerDown(t)}delegatePointerDown(t){let e=this.domNode.domNode.getClientRects()[0].top,i=e+this._scrollbarState.getSliderPosition(),n=e+this._scrollbarState.getSliderPosition()+this._scrollbarState.getSliderSize(),o=this._sliderPointerPosition(t);i<=o&&o<=n?t.button===0&&(t.preventDefault(),this._sliderPointerDown(t)):this._onPointerDown(t)}_onPointerDown(t){let e,i;if(t.target===this.domNode.domNode&&typeof t.offsetX=="number"&&typeof t.offsetY=="number")e=t.offsetX,i=t.offsetY;else{let o=Oi(this.domNode.domNode);e=t.pageX-o.left,i=t.pageY-o.top}let n=this._pointerDownRelativePosition(e,i);this._setDesiredScrollPositionNow(this._scrollByPage?this._scrollbarState.getDesiredScrollPositionFromOffsetPaged(n):this._scrollbarState.getDesiredScrollPositionFromOffset(n)),t.button===0&&(t.preventDefault(),this._sliderPointerDown(t))}_sliderPointerDown(t){if(!t.target||!(t.target instanceof Element))return;let e=this._sliderPointerPosition(t),i=this._sliderOrthogonalPointerPosition(t),n=this._scrollbarState.clone();this.slider.toggleClassName("active",!0),this._pointerMoveMonitor.startMonitoring(t.target,t.pointerId,t.buttons,o=>{let s=this._sliderOrthogonalPointerPosition(o),a=Math.abs(s-i);if(St&&a>sSe){this._setDesiredScrollPositionNow(n.getScrollPosition());return}let d=this._sliderPointerPosition(o)-e;this._setDesiredScrollPositionNow(n.getDesiredScrollPositionFromDelta(d))},()=>{this.slider.toggleClassName("active",!1),this._host.onDragEnd()}),this._host.onDragStart()}_setDesiredScrollPositionNow(t){let e={};this.writeScrollPosition(e,t),this._scrollable.setScrollPositionNow(e)}updateScrollbarSize(t){this._updateScrollbarSize(t),this._scrollbarState.setScrollbarSize(t),this._shouldRender=!0,this._lazyRender||this.render()}isNeeded(){return this._scrollbarState.isNeeded()}};var h1=class extends fw{constructor(t,e,i){let n=t.getScrollDimensions(),o=t.getCurrentScrollPosition();if(super({lazyRender:e.lazyRender,host:i,scrollbarState:new Xf(e.horizontalHasArrows?e.arrowSize:0,e.horizontal===2?0:e.horizontalScrollbarSize,e.vertical===2?0:e.verticalScrollbarSize,n.width,n.scrollWidth,o.scrollLeft),visibility:e.horizontal,extraScrollbarClassName:"horizontal",scrollable:t,scrollByPage:e.scrollByPage}),e.horizontalHasArrows){let s=(e.arrowSize-jf)/2,a=(e.horizontalScrollbarSize-jf)/2;this._createArrow({className:"scra",icon:N.scrollbarButtonLeft,top:a,left:s,bottom:void 0,right:void 0,bgWidth:e.arrowSize,bgHeight:e.horizontalScrollbarSize,onActivate:()=>this._host.onMouseWheel(new Id(null,1,0))}),this._createArrow({className:"scra",icon:N.scrollbarButtonRight,top:a,left:void 0,bottom:void 0,right:s,bgWidth:e.arrowSize,bgHeight:e.horizontalScrollbarSize,onActivate:()=>this._host.onMouseWheel(new Id(null,-1,0))})}this._createSlider(Math.floor((e.horizontalScrollbarSize-e.horizontalSliderSize)/2),0,void 0,e.horizontalSliderSize)}_updateSlider(t,e){this.slider.setWidth(t),this.slider.setLeft(e)}_renderDomNode(t,e){this.domNode.setWidth(t),this.domNode.setHeight(e),this.domNode.setLeft(0),this.domNode.setBottom(0)}onDidScroll(t){return this._shouldRender=this._onElementScrollSize(t.scrollWidth)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(t.scrollLeft)||this._shouldRender,this._shouldRender=this._onElementSize(t.width)||this._shouldRender,this._shouldRender}_pointerDownRelativePosition(t,e){return t}_sliderPointerPosition(t){return t.pageX}_sliderOrthogonalPointerPosition(t){return t.pageY}_updateScrollbarSize(t){this.slider.setHeight(t)}writeScrollPosition(t,e){t.scrollLeft=e}updateOptions(t){this.updateScrollbarSize(t.horizontal===2?0:t.horizontalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(t.vertical===2?0:t.verticalScrollbarSize),this._visibilityController.setVisibility(t.horizontal),this._scrollByPage=t.scrollByPage}};var m1=class extends fw{constructor(t,e,i){let n=t.getScrollDimensions(),o=t.getCurrentScrollPosition();if(super({lazyRender:e.lazyRender,host:i,scrollbarState:new Xf(e.verticalHasArrows?e.arrowSize:0,e.vertical===2?0:e.verticalScrollbarSize,0,n.height,n.scrollHeight,o.scrollTop),visibility:e.vertical,extraScrollbarClassName:"vertical",scrollable:t,scrollByPage:e.scrollByPage}),e.verticalHasArrows){let s=(e.arrowSize-jf)/2,a=(e.verticalScrollbarSize-jf)/2;this._createArrow({className:"scra",icon:N.scrollbarButtonUp,top:s,left:a,bottom:void 0,right:void 0,bgWidth:e.verticalScrollbarSize,bgHeight:e.arrowSize,onActivate:()=>this._host.onMouseWheel(new Id(null,0,1))}),this._createArrow({className:"scra",icon:N.scrollbarButtonDown,top:void 0,left:a,bottom:s,right:void 0,bgWidth:e.verticalScrollbarSize,bgHeight:e.arrowSize,onActivate:()=>this._host.onMouseWheel(new Id(null,0,-1))})}this._createSlider(0,Math.floor((e.verticalScrollbarSize-e.verticalSliderSize)/2),e.verticalSliderSize,void 0)}_updateSlider(t,e){this.slider.setHeight(t),this.slider.setTop(e)}_renderDomNode(t,e){this.domNode.setWidth(e),this.domNode.setHeight(t),this.domNode.setRight(0),this.domNode.setTop(0)}onDidScroll(t){return this._shouldRender=this._onElementScrollSize(t.scrollHeight)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(t.scrollTop)||this._shouldRender,this._shouldRender=this._onElementSize(t.height)||this._shouldRender,this._shouldRender}_pointerDownRelativePosition(t,e){return e}_sliderPointerPosition(t){return t.pageY}_sliderOrthogonalPointerPosition(t){return t.pageX}_updateScrollbarSize(t){this.slider.setWidth(t)}writeScrollPosition(t,e){t.scrollTop=e}updateOptions(t){this.updateScrollbarSize(t.vertical===2?0:t.verticalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(0),this._visibilityController.setVisibility(t.vertical),this._scrollByPage=t.scrollByPage}};var aSe=500,jse=50,Xse=!0,n7=class{timestamp;deltaX;deltaY;score;constructor(t,e,i){this.timestamp=t,this.deltaX=e,this.deltaY=i,this.score=0}},Bk=class r{static INSTANCE=new r;_capacity;_memory;_front;_rear;constructor(){this._capacity=5,this._memory=[],this._front=-1,this._rear=-1}isPhysicalMouseWheel(){if(this._front===-1&&this._rear===-1)return!1;let t=1,e=0,i=1,n=this._rear;do{let o=n===this._front?t:Math.pow(2,-i);if(t-=o,e+=this._memory[n].score*o,n===this._front)break;n=(this._capacity+n-1)%this._capacity,i++}while(!0);return e<=.5}acceptStandardWheelEvent(t){if(nf){let e=ue(t.browserEvent),i=qv(e);this.accept(Date.now(),t.deltaX*i,t.deltaY*i)}else this.accept(Date.now(),t.deltaX,t.deltaY)}accept(t,e,i){let n=null,o=new n7(t,e,i);this._front===-1&&this._rear===-1?(this._memory[0]=o,this._front=0,this._rear=0):(n=this._memory[this._rear],this._rear=(this._rear+1)%this._capacity,this._rear===this._front&&(this._front=(this._front+1)%this._capacity),this._memory[this._rear]=o),o.score=this._computeScore(o,n)}_computeScore(t,e){if(Math.abs(t.deltaX)>0&&Math.abs(t.deltaY)>0)return 1;let i=.5;if((!this._isAlmostInt(t.deltaX)||!this._isAlmostInt(t.deltaY))&&(i+=.25),e){let n=Math.abs(t.deltaX),o=Math.abs(t.deltaY),s=Math.abs(e.deltaX),a=Math.abs(e.deltaY),l=Math.max(Math.min(n,s),1),d=Math.max(Math.min(o,a),1),c=Math.max(n,s),p=Math.max(o,a);c%l===0&&p%d===0&&(i-=.5)}return Math.min(Math.max(i,0),1)}_isAlmostInt(t){return Math.abs(Math.round(t)-t)<.01}},Vk=class extends ko{_options;_scrollable;_verticalScrollbar;_horizontalScrollbar;_domNode;_leftShadowDomNode;_topShadowDomNode;_topLeftShadowDomNode;_listenOnDomNode;_mouseWheelToDispose;_isDragging;_mouseIsOver;_hideTimeout;_shouldRender;_revealOnScroll;_onScroll=this._register(new x);onScroll=this._onScroll.event;_onWillScroll=this._register(new x);onWillScroll=this._onWillScroll.event;get options(){return this._options}constructor(t,e,i){super(),t.style.overflow="hidden",this._options=lSe(e),this._scrollable=i,this._register(this._scrollable.onScroll(o=>{this._onWillScroll.fire(o),this._onDidScroll(o),this._onScroll.fire(o)}));let n={onMouseWheel:o=>this._onMouseWheel(o),onDragStart:()=>this._onDragStart(),onDragEnd:()=>this._onDragEnd()};this._verticalScrollbar=this._register(new m1(this._scrollable,this._options,n)),this._horizontalScrollbar=this._register(new h1(this._scrollable,this._options,n)),this._domNode=document.createElement("div"),this._domNode.className="monaco-scrollable-element "+this._options.className,this._domNode.setAttribute("role","presentation"),this._domNode.style.position="relative",this._domNode.style.overflow="hidden",this._domNode.appendChild(t),this._domNode.appendChild(this._horizontalScrollbar.domNode.domNode),this._domNode.appendChild(this._verticalScrollbar.domNode.domNode),this._options.useShadows?(this._leftShadowDomNode=Ot(document.createElement("div")),this._leftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._leftShadowDomNode.domNode),this._topShadowDomNode=Ot(document.createElement("div")),this._topShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topShadowDomNode.domNode),this._topLeftShadowDomNode=Ot(document.createElement("div")),this._topLeftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topLeftShadowDomNode.domNode)):(this._leftShadowDomNode=null,this._topShadowDomNode=null,this._topLeftShadowDomNode=null),this._listenOnDomNode=this._options.listenOnDomNode||this._domNode,this._mouseWheelToDispose=[],this._setListeningToMouseWheel(this._options.handleMouseWheel),this.onmouseover(this._listenOnDomNode,o=>this._onMouseOver(o)),this.onmouseleave(this._listenOnDomNode,o=>this._onMouseLeave(o)),this._hideTimeout=this._register(new Qs),this._isDragging=!1,this._mouseIsOver=!1,this._shouldRender=!0,this._revealOnScroll=!0}dispose(){this._mouseWheelToDispose=_e(this._mouseWheelToDispose),super.dispose()}getDomNode(){return this._domNode}getOverviewRulerLayoutInfo(){return{parent:this._domNode,insertBefore:this._verticalScrollbar.domNode.domNode}}delegateVerticalScrollbarPointerDown(t){this._verticalScrollbar.delegatePointerDown(t)}getScrollDimensions(){return this._scrollable.getScrollDimensions()}setScrollDimensions(t){this._scrollable.setScrollDimensions(t,!1)}updateClassName(t){this._options.className=t,ye&&(this._options.className+=" mac"),this._domNode.className="monaco-scrollable-element "+this._options.className}updateOptions(t){typeof t.handleMouseWheel<"u"&&(this._options.handleMouseWheel=t.handleMouseWheel,this._setListeningToMouseWheel(this._options.handleMouseWheel)),typeof t.mouseWheelScrollSensitivity<"u"&&(this._options.mouseWheelScrollSensitivity=t.mouseWheelScrollSensitivity),typeof t.fastScrollSensitivity<"u"&&(this._options.fastScrollSensitivity=t.fastScrollSensitivity),typeof t.scrollPredominantAxis<"u"&&(this._options.scrollPredominantAxis=t.scrollPredominantAxis),typeof t.horizontal<"u"&&(this._options.horizontal=t.horizontal),typeof t.vertical<"u"&&(this._options.vertical=t.vertical),typeof t.horizontalScrollbarSize<"u"&&(this._options.horizontalScrollbarSize=t.horizontalScrollbarSize),typeof t.verticalScrollbarSize<"u"&&(this._options.verticalScrollbarSize=t.verticalScrollbarSize),typeof t.scrollByPage<"u"&&(this._options.scrollByPage=t.scrollByPage),this._horizontalScrollbar.updateOptions(this._options),this._verticalScrollbar.updateOptions(this._options),this._options.lazyRender||this._render()}setRevealOnScroll(t){this._revealOnScroll=t}delegateScrollFromMouseWheelEvent(t){this._onMouseWheel(new Id(t))}_setListeningToMouseWheel(t){if(this._mouseWheelToDispose.length>0!==t&&(this._mouseWheelToDispose=_e(this._mouseWheelToDispose),t)){let i=n=>{this._onMouseWheel(new Id(n))};this._mouseWheelToDispose.push(F(this._listenOnDomNode,Q.MOUSE_WHEEL,i,{passive:!1}))}}_onMouseWheel(t){if(t.browserEvent?.defaultPrevented)return;let e=Bk.INSTANCE;Xse&&e.acceptStandardWheelEvent(t);let i=!1;if(t.deltaY||t.deltaX){let o=t.deltaY*this._options.mouseWheelScrollSensitivity,s=t.deltaX*this._options.mouseWheelScrollSensitivity;this._options.scrollPredominantAxis&&(this._options.scrollYToX&&s+o===0?s=o=0:Math.abs(o)>=Math.abs(s)?s=0:o=0),this._options.flipAxes&&([o,s]=[s,o]);let a=!ye&&t.browserEvent&&t.browserEvent.shiftKey;(this._options.scrollYToX||a)&&!s&&(s=o,o=0),t.browserEvent&&t.browserEvent.altKey&&(s=s*this._options.fastScrollSensitivity,o=o*this._options.fastScrollSensitivity);let l=this._scrollable.getFutureScrollPosition(),d={};if(o){let c=jse*o,p=l.scrollTop-(c<0?Math.floor(c):Math.ceil(c));this._verticalScrollbar.writeScrollPosition(d,p)}if(s){let c=jse*s,p=l.scrollLeft-(c<0?Math.floor(c):Math.ceil(c));this._horizontalScrollbar.writeScrollPosition(d,p)}d=this._scrollable.validateScrollPosition(d),(l.scrollLeft!==d.scrollLeft||l.scrollTop!==d.scrollTop)&&(Xse&&this._options.mouseWheelSmoothScroll&&e.isPhysicalMouseWheel()?this._scrollable.setScrollPositionSmooth(d):this._scrollable.setScrollPositionNow(d),i=!0)}let n=i;!n&&this._options.alwaysConsumeMouseWheel&&(n=!0),!n&&this._options.consumeMouseWheelIfScrollbarIsNeeded&&(this._verticalScrollbar.isNeeded()||this._horizontalScrollbar.isNeeded())&&(n=!0),n&&(t.preventDefault(),t.stopPropagation())}_onDidScroll(t){this._shouldRender=this._horizontalScrollbar.onDidScroll(t)||this._shouldRender,this._shouldRender=this._verticalScrollbar.onDidScroll(t)||this._shouldRender,this._options.useShadows&&(this._shouldRender=!0),this._revealOnScroll&&this._reveal(),this._options.lazyRender||this._render()}renderNow(){if(!this._options.lazyRender)throw new Error("Please use `lazyRender` together with `renderNow`!");this._render()}_render(){if(this._shouldRender&&(this._shouldRender=!1,this._horizontalScrollbar.render(),this._verticalScrollbar.render(),this._options.useShadows)){let t=this._scrollable.getCurrentScrollPosition(),e=t.scrollTop>0,i=t.scrollLeft>0,n=i?" left":"",o=e?" top":"",s=i||e?" top-left-corner":"";this._leftShadowDomNode.setClassName(`shadow${n}`),this._topShadowDomNode.setClassName(`shadow${o}`),this._topLeftShadowDomNode.setClassName(`shadow${s}${o}${n}`)}}_onDragStart(){this._isDragging=!0,this._reveal()}_onDragEnd(){this._isDragging=!1,this._hide()}_onMouseLeave(t){this._mouseIsOver=!1,this._hide()}_onMouseOver(t){this._mouseIsOver=!0,this._reveal()}_reveal(){this._verticalScrollbar.beginReveal(),this._horizontalScrollbar.beginReveal(),this._scheduleHide()}_hide(){!this._mouseIsOver&&!this._isDragging&&(this._verticalScrollbar.beginHide(),this._horizontalScrollbar.beginHide())}_scheduleHide(){!this._mouseIsOver&&!this._isDragging&&this._hideTimeout.cancelAndSet(()=>this._hide(),aSe)}},bw=class extends Vk{constructor(t,e){e=e||{},e.mouseWheelSmoothScroll=!1;let i=new iu({forceIntegerValues:!0,smoothScrollDuration:0,scheduleAtNextAnimationFrame:n=>eo(ue(t),n)});super(t,e,i),this._register(i)}setScrollPosition(t){this._scrollable.setScrollPositionNow(t)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}},Yf=class extends Vk{constructor(t,e,i){super(t,e,i)}setScrollPosition(t){t.reuseAnimation?this._scrollable.setScrollPositionSmooth(t,t.reuseAnimation):this._scrollable.setScrollPositionNow(t)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}},Da=class extends Vk{_element;constructor(t,e){e=e||{},e.mouseWheelSmoothScroll=!1;let i=new iu({forceIntegerValues:!1,smoothScrollDuration:0,scheduleAtNextAnimationFrame:n=>eo(ue(t),n)});super(t,e,i),this._register(i),this._element=t,this._register(this.onScroll(n=>{n.scrollTopChanged&&(this._element.scrollTop=n.scrollTop),n.scrollLeftChanged&&(this._element.scrollLeft=n.scrollLeft)})),this.scanDomNode()}setScrollPosition(t){this._scrollable.setScrollPositionNow(t)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}scanDomNode(){this.setScrollDimensions({width:this._element.clientWidth,scrollWidth:this._element.scrollWidth,height:this._element.clientHeight,scrollHeight:this._element.scrollHeight}),this.setScrollPosition({scrollLeft:this._element.scrollLeft,scrollTop:this._element.scrollTop})}};function lSe(r){let t={lazyRender:typeof r.lazyRender<"u"?r.lazyRender:!1,className:typeof r.className<"u"?r.className:"",useShadows:typeof r.useShadows<"u"?r.useShadows:!0,handleMouseWheel:typeof r.handleMouseWheel<"u"?r.handleMouseWheel:!0,flipAxes:typeof r.flipAxes<"u"?r.flipAxes:!1,consumeMouseWheelIfScrollbarIsNeeded:typeof r.consumeMouseWheelIfScrollbarIsNeeded<"u"?r.consumeMouseWheelIfScrollbarIsNeeded:!1,alwaysConsumeMouseWheel:typeof r.alwaysConsumeMouseWheel<"u"?r.alwaysConsumeMouseWheel:!1,scrollYToX:typeof r.scrollYToX<"u"?r.scrollYToX:!1,mouseWheelScrollSensitivity:typeof r.mouseWheelScrollSensitivity<"u"?r.mouseWheelScrollSensitivity:1,fastScrollSensitivity:typeof r.fastScrollSensitivity<"u"?r.fastScrollSensitivity:5,scrollPredominantAxis:typeof r.scrollPredominantAxis<"u"?r.scrollPredominantAxis:!0,mouseWheelSmoothScroll:typeof r.mouseWheelSmoothScroll<"u"?r.mouseWheelSmoothScroll:!0,arrowSize:typeof r.arrowSize<"u"?r.arrowSize:11,listenOnDomNode:typeof r.listenOnDomNode<"u"?r.listenOnDomNode:null,horizontal:typeof r.horizontal<"u"?r.horizontal:1,horizontalScrollbarSize:typeof r.horizontalScrollbarSize<"u"?r.horizontalScrollbarSize:10,horizontalSliderSize:typeof r.horizontalSliderSize<"u"?r.horizontalSliderSize:0,horizontalHasArrows:typeof r.horizontalHasArrows<"u"?r.horizontalHasArrows:!1,vertical:typeof r.vertical<"u"?r.vertical:1,verticalScrollbarSize:typeof r.verticalScrollbarSize<"u"?r.verticalScrollbarSize:10,verticalHasArrows:typeof r.verticalHasArrows<"u"?r.verticalHasArrows:!1,verticalSliderSize:typeof r.verticalSliderSize<"u"?r.verticalSliderSize:0,scrollByPage:typeof r.scrollByPage<"u"?r.scrollByPage:!1};return t.horizontalSliderSize=typeof r.horizontalSliderSize<"u"?r.horizontalSliderSize:t.horizontalScrollbarSize,t.verticalSliderSize=typeof r.verticalSliderSize<"u"?r.verticalSliderSize:t.verticalScrollbarSize,ye&&(t.className+=" mac"),t}var g1=J;var f1=class extends R{containerDomNode;contentsDomNode;scrollbar;constructor(){super(),this.containerDomNode=document.createElement("div"),this.containerDomNode.className="monaco-hover",this.containerDomNode.tabIndex=0,this.containerDomNode.setAttribute("role","tooltip"),this.contentsDomNode=document.createElement("div"),this.contentsDomNode.className="monaco-hover-content",this.scrollbar=this._register(new Da(this.contentsDomNode,{consumeMouseWheelIfScrollbarIsNeeded:!0})),this.containerDomNode.appendChild(this.scrollbar.getDomNode())}onContentsChanged(){this.scrollbar.scanDomNode()}},b1=class r extends R{static render(t,e,i){return new r(t,e,i)}actionLabel;actionKeybindingLabel;actionContainer;action;constructor(t,e,i){super(),this.actionLabel=e.label,this.actionKeybindingLabel=i,this.actionContainer=U(t,g1("div.action-container")),this.actionContainer.setAttribute("tabindex","0"),this.action=U(this.actionContainer,g1("a.action")),this.action.setAttribute("role","button"),e.iconClass&&U(this.action,g1(`span.icon.${e.iconClass}`));let n=U(this.action,g1("span"));n.textContent=i?`${e.label} (${i})`:e.label,this._store.add(new Wk(this.actionContainer,e.run)),this._store.add(new Hk(this.actionContainer,e.run,[3,10])),this.setEnabled(!0)}setEnabled(t){t?(this.actionContainer.classList.remove("disabled"),this.actionContainer.removeAttribute("aria-disabled")):(this.actionContainer.classList.add("disabled"),this.actionContainer.setAttribute("aria-disabled","true"))}};function Yse(r,t){return r&&t?u("acessibleViewHint","Inspect this in the accessible view with {0}.",t):r?u("acessibleViewHintNoKbOpen","Inspect this in the accessible view via the command Open Accessible View which is currently not triggerable via keybinding."):""}var Wk=class extends R{constructor(t,e){super(),this._register(F(t,Q.CLICK,i=>{i.stopPropagation(),i.preventDefault(),e(t)}))}},Hk=class extends R{constructor(t,e,i){super(),this._register(F(t,Q.KEY_DOWN,n=>{let o=new ut(n);i.some(s=>o.equals(s))&&(n.stopPropagation(),n.preventDefault(),e(t))}))}};var dSe=()=>({get delay(){return-1},dispose:()=>{},showHover:()=>{}}),o7=dSe,cSe=new qn(()=>o7("mouse",!1)),uSe=new qn(()=>o7("element",!1));function gt(r){return r==="element"?uSe.value:cSe.value}function wu(){return o7("element",!0)}function Qse(r,t={}){let e=v1(t);return e.textContent=r,e}function Zse(r,t={}){let e=v1(t);return Jse(e,pSe(r,!!t.renderCodeSegments),t.actionHandler,t.renderCodeSegments),e}function v1(r){let t=r.inline?"span":"div",e=document.createElement(t);return r.className&&(e.className=r.className),e}var r7=class{source;index;constructor(t){this.source=t,this.index=0}eos(){return this.index>=this.source.length}next(){let t=this.peek();return this.advance(),t}peek(){return this.source[this.index]}advance(){this.index++}};function Jse(r,t,e,i){let n;if(t.type===2)n=document.createTextNode(t.content||"");else if(t.type===3)n=document.createElement("b");else if(t.type===4)n=document.createElement("i");else if(t.type===7&&i)n=document.createElement("code");else if(t.type===5&&e){let o=document.createElement("a");e.disposables.add(Ut(o,"click",s=>{e.callback(String(t.index),s)})),n=o}else t.type===8?n=document.createElement("br"):t.type===1&&(n=r);n&&r!==n&&r.appendChild(n),n&&Array.isArray(t.children)&&t.children.forEach(o=>{Jse(n,o,e,i)})}function pSe(r,t){let e={type:1,children:[]},i=0,n=e,o=[],s=new r7(r);for(;!s.eos();){let a=s.next(),l=a==="\\"&&s7(s.peek(),t)!==0;if(l&&(a=s.next()),!l&&hSe(a,t)&&a===s.peek()){s.advance(),n.type===2&&(n=o.pop());let d=s7(a,t);if(n.type===d||n.type===5&&d===6)n=o.pop();else{let c={type:d,children:[]};d===5&&(c.index=i,i++),n.children.push(c),o.push(n),n=c}}else if(a===`
`)n.type===2&&(n=o.pop()),n.children.push({type:8});else if(n.type!==2){let d={type:2,content:a};n.children.push(d),o.push(n),n=d}else n.content+=a}return n.type===2&&(n=o.pop()),o.length,e}function hSe(r,t){return s7(r,t)!==0}function s7(r,t){switch(r){case"*":return 3;case"_":return 4;case"[":return 5;case"]":return 6;case"`":return t?7:0;default:return 0}}var eae=2e4,nae,a7,tae,l7,iae;function ka(r){nae&&(a7.textContent!==r?(ai(tae),I1(a7,r)):(ai(a7),I1(tae,r)))}function La(r){nae&&(l7.textContent!==r?(ai(iae),I1(l7,r)):(ai(l7),I1(iae,r)))}function I1(r,t){ai(r),t.length>eae&&(t=t.substr(0,eae)),r.textContent=t,r.style.visibility="hidden",r.style.visibility="visible"}var S1=class{constructor(t){this.spliceables=t}splice(t,e,i){this.spliceables.forEach(n=>n.splice(t,e,i))}};function oae(r,t){let e=[];for(let i of t){if(r.start>=i.range.end)continue;if(r.end<i.range.start)break;let n=ts.intersect(r,i.range);ts.isEmpty(n)||e.push({range:n,size:i.size})}return e}function w1({start:r,end:t},e){return{start:r+e,end:t+e}}function mSe(r){let t=[],e=null;for(let i of r){let n=i.range.start,o=i.range.end,s=i.size;if(e&&s===e.size){e.range.end=o;continue}e={range:{start:n,end:o},size:s},t.push(e)}return t}function gSe(...r){return mSe(r.reduce((t,e)=>t.concat(e),[]))}var C1=class{groups=[];_size=0;_paddingTop=0;get paddingTop(){return this._paddingTop}set paddingTop(t){this._size=this._size+t-this._paddingTop,this._paddingTop=t}constructor(t){this._paddingTop=t??0,this._size=this._paddingTop}splice(t,e,i=[]){let n=i.length-e,o=oae({start:0,end:t},this.groups),s=oae({start:t+e,end:Number.POSITIVE_INFINITY},this.groups).map(l=>({range:w1(l.range,n),size:l.size})),a=i.map((l,d)=>({range:{start:t+d,end:t+d+1},size:l.size}));this.groups=gSe(o,a,s),this._size=this._paddingTop+this.groups.reduce((l,d)=>l+d.size*(d.range.end-d.range.start),0)}get count(){let t=this.groups.length;return t?this.groups[t-1].range.end:0}get size(){return this._size}indexAt(t){if(t<0)return-1;if(t<this._paddingTop)return 0;let e=0,i=this._paddingTop;for(let n of this.groups){let o=n.range.end-n.range.start,s=i+o*n.size;if(t<s)return e+Math.floor((t-i)/n.size);e+=o,i=s}return e}indexAfter(t){return Math.min(this.indexAt(t)+1,this.count)}positionAt(t){if(t<0)return-1;let e=0,i=0;for(let n of this.groups){let o=n.range.end-n.range.start,s=i+o;if(t<s)return this._paddingTop+e+(t-i)*n.size;e+=o*n.size,i=s}return-1}};var E1=class{constructor(t){this.renderers=t}cache=new Map;transactionNodesPendingRemoval=new Set;inTransaction=!1;alloc(t){let e=this.getTemplateCache(t).pop(),i=!1;if(e)i=this.transactionNodesPendingRemoval.has(e.domNode),i&&this.transactionNodesPendingRemoval.delete(e.domNode);else{let n=J(".monaco-list-row"),s=this.getRenderer(t).renderTemplate(n);e={domNode:n,templateId:t,templateData:s}}return{row:e,isReusingConnectedDomNode:i}}release(t){t&&this.releaseRow(t)}transact(t){if(this.inTransaction)throw new Error("Already in transaction");this.inTransaction=!0;try{t()}finally{for(let e of this.transactionNodesPendingRemoval)this.doRemoveNode(e);this.transactionNodesPendingRemoval.clear(),this.inTransaction=!1}}releaseRow(t){let{domNode:e,templateId:i}=t;e&&(this.inTransaction?this.transactionNodesPendingRemoval.add(e):this.doRemoveNode(e)),this.getTemplateCache(i).push(t)}doRemoveNode(t){t.classList.remove("scrolling"),t.remove()}getTemplateCache(t){let e=this.cache.get(t);return e||(e=[],this.cache.set(t,e)),e}dispose(){this.cache.forEach((t,e)=>{for(let i of t)this.getRenderer(e).disposeTemplate(i.templateData),i.templateData=null}),this.cache.clear(),this.transactionNodesPendingRemoval.clear()}getRenderer(t){let e=this.renderers.get(t);if(!e)throw new Error(`No renderer found for ${t}`);return e}};var VI={CurrentDragAndDropData:void 0};var Jp={useShadows:!0,verticalScrollMode:1,setRowLineHeight:!0,setRowHeight:!0,supportDynamicHeights:!1,dnd:{getDragElements(r){return[r]},getDragURI(){return null},onDragStart(){},onDragOver(){return!1},drop(){},dispose(){}},horizontalScrolling:!1,transformOptimization:!0,alwaysConsumeMouseWheel:!0},Cc=class{elements;_context;get context(){return this._context}set context(t){this._context=t}constructor(t){this.elements=t}update(){}getData(){return this.elements}},d7=class{elements;constructor(t){this.elements=t}update(){}getData(){return this.elements}},c7=class{types;files;constructor(){this.types=[],this.files=[]}update(t){if(t.types&&this.types.splice(0,this.types.length,...t.types),t.files){this.files.splice(0,this.files.length);for(let e=0;e<t.files.length;e++){let i=t.files.item(e);i&&(i.size||i.type)&&this.files.push(i)}}}getData(){return{types:this.types,files:this.files}}};function fSe(r,t){return Array.isArray(r)&&Array.isArray(t)?xi(r,t):r===t}var u7=class{getSetSize;getPosInSet;getRole;isChecked;constructor(t){t?.getSetSize?this.getSetSize=t.getSetSize.bind(t):this.getSetSize=(e,i,n)=>n,t?.getPosInSet?this.getPosInSet=t.getPosInSet.bind(t):this.getPosInSet=(e,i)=>i+1,t?.getRole?this.getRole=t.getRole.bind(t):this.getRole=e=>"listitem",t?.isChecked?this.isChecked=t.isChecked.bind(t):this.isChecked=e=>{}}},Ul=class Ul{constructor(t,e,i,n=Jp){this.virtualDelegate=e;if(n.horizontalScrolling&&n.supportDynamicHeights)throw new Error("Horizontal scrolling and dynamic heights not supported simultaneously");this.items=[],this.itemId=0,this.rangeMap=this.createRangeMap(n.paddingTop??0);for(let s of i)this.renderers.set(s.templateId,s);this.cache=this.disposables.add(new E1(this.renderers)),this.lastRenderTop=0,this.lastRenderHeight=0,this.domNode=document.createElement("div"),this.domNode.className="monaco-list",this.domNode.classList.add(this.domId),this.domNode.tabIndex=0,this.domNode.classList.toggle("mouse-support",typeof n.mouseSupport=="boolean"?n.mouseSupport:!0),this._horizontalScrolling=n.horizontalScrolling??Jp.horizontalScrolling,this.domNode.classList.toggle("horizontal-scrolling",this._horizontalScrolling),this.paddingBottom=typeof n.paddingBottom>"u"?0:n.paddingBottom,this.accessibilityProvider=new u7(n.accessibilityProvider),this.rowsContainer=document.createElement("div"),this.rowsContainer.className="monaco-list-rows",(n.transformOptimization??Jp.transformOptimization)&&(this.rowsContainer.style.transform="translate3d(0px, 0px, 0px)",this.rowsContainer.style.overflow="hidden",this.rowsContainer.style.contain="strict"),this.disposables.add(yi.addTarget(this.rowsContainer)),this.scrollable=this.disposables.add(new iu({forceIntegerValues:!0,smoothScrollDuration:n.smoothScrolling??!1?125:0,scheduleAtNextAnimationFrame:s=>eo(ue(this.domNode),s)})),this.scrollableElement=this.disposables.add(new Yf(this.rowsContainer,{alwaysConsumeMouseWheel:n.alwaysConsumeMouseWheel??Jp.alwaysConsumeMouseWheel,horizontal:1,vertical:n.verticalScrollMode??Jp.verticalScrollMode,useShadows:n.useShadows??Jp.useShadows,mouseWheelScrollSensitivity:n.mouseWheelScrollSensitivity,fastScrollSensitivity:n.fastScrollSensitivity,scrollByPage:n.scrollByPage},this.scrollable)),this.domNode.appendChild(this.scrollableElement.getDomNode()),t.appendChild(this.domNode),this.scrollableElement.onScroll(this.onScroll,this,this.disposables),this.disposables.add(F(this.rowsContainer,At.Change,s=>this.onTouchChange(s))),this.disposables.add(F(this.scrollableElement.getDomNode(),"scroll",s=>s.target.scrollTop=0)),this.disposables.add(F(this.domNode,"dragover",s=>this.onDragOver(this.toDragEvent(s)))),this.disposables.add(F(this.domNode,"drop",s=>this.onDrop(this.toDragEvent(s)))),this.disposables.add(F(this.domNode,"dragleave",s=>this.onDragLeave(this.toDragEvent(s)))),this.disposables.add(F(this.domNode,"dragend",s=>this.onDragEnd(s))),this.setRowLineHeight=n.setRowLineHeight??Jp.setRowLineHeight,this.setRowHeight=n.setRowHeight??Jp.setRowHeight,this.supportDynamicHeights=n.supportDynamicHeights??Jp.supportDynamicHeights,this.dnd=n.dnd??this.disposables.add(Jp.dnd),this.layout(n.initialSize?.height,n.initialSize?.width)}static InstanceCount=0;domId=`list_id_${++Ul.InstanceCount}`;domNode;items;itemId;rangeMap;cache;renderers=new Map;lastRenderTop;lastRenderHeight;renderWidth=0;rowsContainer;scrollable;scrollableElement;_scrollHeight=0;scrollableElementUpdateDisposable=null;scrollableElementWidthDelayer=new yd(50);splicing=!1;dragOverAnimationDisposable;dragOverAnimationStopDisposable=R.None;dragOverMouseY=0;setRowLineHeight;setRowHeight;supportDynamicHeights;paddingBottom;accessibilityProvider;scrollWidth;dnd;canDrop=!1;currentDragData;currentDragFeedback;currentDragFeedbackPosition;currentDragFeedbackDisposable=R.None;onDragLeaveTimeout=R.None;disposables=new B;_onDidChangeContentHeight=new x;_onDidChangeContentWidth=new x;onDidChangeContentHeight=X.latch(this._onDidChangeContentHeight.event,void 0,this.disposables);onDidChangeContentWidth=X.latch(this._onDidChangeContentWidth.event,void 0,this.disposables);get contentHeight(){return this.rangeMap.size}get contentWidth(){return this.scrollWidth??0}get onDidScroll(){return this.scrollableElement.onScroll}get onWillScroll(){return this.scrollableElement.onWillScroll}get containerDomNode(){return this.rowsContainer}get scrollableElementDomNode(){return this.scrollableElement.getDomNode()}_horizontalScrolling=!1;get horizontalScrolling(){return this._horizontalScrolling}set horizontalScrolling(t){if(t!==this._horizontalScrolling){if(t&&this.supportDynamicHeights)throw new Error("Horizontal scrolling and dynamic heights not supported simultaneously");if(this._horizontalScrolling=t,this.domNode.classList.toggle("horizontal-scrolling",this._horizontalScrolling),this._horizontalScrolling){for(let e of this.items)this.measureItemWidth(e);this.updateScrollWidth(),this.scrollableElement.setScrollDimensions({width:XS(this.domNode)}),this.rowsContainer.style.width=`${Math.max(this.scrollWidth||0,this.renderWidth)}px`}else this.scrollableElementWidthDelayer.cancel(),this.scrollableElement.setScrollDimensions({width:this.renderWidth,scrollWidth:this.renderWidth}),this.rowsContainer.style.width=""}}updateOptions(t){t.paddingBottom!==void 0&&(this.paddingBottom=t.paddingBottom,this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight})),t.smoothScrolling!==void 0&&this.scrollable.setSmoothScrollDuration(t.smoothScrolling?125:0),t.horizontalScrolling!==void 0&&(this.horizontalScrolling=t.horizontalScrolling);let e;if(t.scrollByPage!==void 0&&(e={...e??{},scrollByPage:t.scrollByPage}),t.mouseWheelScrollSensitivity!==void 0&&(e={...e??{},mouseWheelScrollSensitivity:t.mouseWheelScrollSensitivity}),t.fastScrollSensitivity!==void 0&&(e={...e??{},fastScrollSensitivity:t.fastScrollSensitivity}),e&&this.scrollableElement.updateOptions(e),t.paddingTop!==void 0&&t.paddingTop!==this.rangeMap.paddingTop){let i=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),n=t.paddingTop-this.rangeMap.paddingTop;this.rangeMap.paddingTop=t.paddingTop,this.render(i,Math.max(0,this.lastRenderTop+n),this.lastRenderHeight,void 0,void 0,!0),this.setScrollTop(this.lastRenderTop),this.eventuallyUpdateScrollDimensions(),this.supportDynamicHeights&&this._rerender(this.lastRenderTop,this.lastRenderHeight)}}delegateScrollFromMouseWheelEvent(t){this.scrollableElement.delegateScrollFromMouseWheelEvent(t)}delegateVerticalScrollbarPointerDown(t){this.scrollableElement.delegateVerticalScrollbarPointerDown(t)}updateElementHeight(t,e,i){if(t<0||t>=this.items.length)return;let n=this.items[t].size;if(typeof e>"u"){if(!this.supportDynamicHeights){console.warn("Dynamic heights not supported",new Error().stack);return}this.items[t].lastDynamicHeightWidth=void 0,e=n+this.probeDynamicHeight(t)}if(n===e)return;let o=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),s=0;t<o.start||i!==null&&i>t&&i<o.end?s=e-n:s=0,this.rangeMap.splice(t,1,[{size:e}]),this.items[t].size=e,this.render(o,Math.max(0,this.lastRenderTop+s),this.lastRenderHeight,void 0,void 0,!0),this.setScrollTop(this.lastRenderTop),this.eventuallyUpdateScrollDimensions(),this.supportDynamicHeights&&this._rerender(this.lastRenderTop,this.lastRenderHeight)}createRangeMap(t){return new C1(t)}splice(t,e,i=[]){if(this.splicing)throw new Error("Can't run recursive splices.");this.splicing=!0;try{return this._splice(t,e,i)}finally{this.splicing=!1,this._onDidChangeContentHeight.fire(this.contentHeight)}}_splice(t,e,i=[]){let n=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),o={start:t,end:t+e},s=ts.intersect(n,o),a=new Map;for(let S=s.end-1;S>=s.start;S--){let D=this.items[S];if(D.dragStartDisposable.dispose(),D.checkedDisposable.dispose(),D.row){let k=a.get(D.templateId);k||(k=[],a.set(D.templateId,k));let M=this.renderers.get(D.templateId);M&&M.disposeElement&&M.disposeElement(D.element,S,D.row.templateData,D.size),k.unshift(D.row)}D.row=null,D.stale=!0}let l={start:t+e,end:this.items.length},d=ts.intersect(l,n),c=ts.relativeComplement(l,n),p=i.map(S=>({id:String(this.itemId++),element:S,templateId:this.virtualDelegate.getTemplateId(S),size:this.virtualDelegate.getHeight(S),width:void 0,hasDynamicHeight:!!this.virtualDelegate.hasDynamicHeight&&this.virtualDelegate.hasDynamicHeight(S),lastDynamicHeightWidth:void 0,row:null,uri:void 0,dropTarget:!1,dragStartDisposable:R.None,checkedDisposable:R.None,stale:!1})),h;t===0&&e>=this.items.length?(this.rangeMap=this.createRangeMap(this.rangeMap.paddingTop),this.rangeMap.splice(0,0,p),h=this.items,this.items=p):(this.rangeMap.splice(t,e,p),h=this.items.splice(t,e,...p));let m=i.length-e,f=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),g=w1(d,m),v=ts.intersect(f,g);for(let S=v.start;S<v.end;S++)this.updateItemInDOM(this.items[S],S);let I=ts.relativeComplement(g,f);for(let S of I)for(let D=S.start;D<S.end;D++)this.removeItemFromDOM(D);let y=c.map(S=>w1(S,m)),C=[{start:t,end:t+i.length},...y].map(S=>ts.intersect(f,S)).reverse();for(let S of C)for(let D=S.end-1;D>=S.start;D--){let k=this.items[D],O=a.get(k.templateId)?.pop();this.insertItemInDOM(D,O)}for(let S of a.values())for(let D of S)this.cache.release(D);return this.eventuallyUpdateScrollDimensions(),this.supportDynamicHeights&&this._rerender(this.scrollTop,this.renderHeight),h.map(S=>S.element)}eventuallyUpdateScrollDimensions(){this._scrollHeight=this.contentHeight,this.rowsContainer.style.height=`${this._scrollHeight}px`,this.scrollableElementUpdateDisposable||(this.scrollableElementUpdateDisposable=eo(ue(this.domNode),()=>{this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight}),this.updateScrollWidth(),this.scrollableElementUpdateDisposable=null}))}eventuallyUpdateScrollWidth(){if(!this.horizontalScrolling){this.scrollableElementWidthDelayer.cancel();return}this.scrollableElementWidthDelayer.trigger(()=>this.updateScrollWidth())}updateScrollWidth(){if(!this.horizontalScrolling)return;let t=0;for(let e of this.items)typeof e.width<"u"&&(t=Math.max(t,e.width));this.scrollWidth=t,this.scrollableElement.setScrollDimensions({scrollWidth:t===0?0:t+10}),this._onDidChangeContentWidth.fire(this.scrollWidth)}updateWidth(t){if(!this.horizontalScrolling||typeof this.scrollWidth>"u")return;let e=this.items[t];this.measureItemWidth(e),typeof e.width<"u"&&e.width>this.scrollWidth&&(this.scrollWidth=e.width,this.scrollableElement.setScrollDimensions({scrollWidth:this.scrollWidth+10}),this._onDidChangeContentWidth.fire(this.scrollWidth))}rerender(){if(this.supportDynamicHeights){for(let t of this.items)t.lastDynamicHeightWidth=void 0;this._rerender(this.lastRenderTop,this.lastRenderHeight)}}get length(){return this.items.length}get renderHeight(){return this.scrollableElement.getScrollDimensions().height}get firstVisibleIndex(){return this.getRenderRange(this.lastRenderTop,this.lastRenderHeight).start}get firstMostlyVisibleIndex(){let t=this.firstVisibleIndex,e=this.rangeMap.positionAt(t),i=this.rangeMap.positionAt(t+1);return i!==-1&&(i-e)/2+e<this.scrollTop?t+1:t}get lastVisibleIndex(){return this.getRenderRange(this.lastRenderTop,this.lastRenderHeight).end-1}element(t){return this.items[t].element}indexOf(t){return this.items.findIndex(e=>e.element===t)}domElement(t){let e=this.items[t].row;return e&&e.domNode}elementHeight(t){return this.items[t].size}elementTop(t){return this.rangeMap.positionAt(t)}indexAt(t){return this.rangeMap.indexAt(t)}indexAfter(t){return this.rangeMap.indexAfter(t)}layout(t,e){let i={height:typeof t=="number"?t:WA(this.domNode)};this.scrollableElementUpdateDisposable&&(this.scrollableElementUpdateDisposable.dispose(),this.scrollableElementUpdateDisposable=null,i.scrollHeight=this.scrollHeight),this.scrollableElement.setScrollDimensions(i),typeof e<"u"&&(this.renderWidth=e,this.supportDynamicHeights&&this._rerender(this.scrollTop,this.renderHeight)),this.horizontalScrolling&&this.scrollableElement.setScrollDimensions({width:typeof e=="number"?e:XS(this.domNode)})}render(t,e,i,n,o,s=!1){let a=this.getRenderRange(e,i),l=ts.relativeComplement(a,t).reverse(),d=ts.relativeComplement(t,a);if(s){let c=ts.intersect(t,a);for(let p=c.start;p<c.end;p++)this.updateItemInDOM(this.items[p],p)}this.cache.transact(()=>{for(let c of d)for(let p=c.start;p<c.end;p++)this.removeItemFromDOM(p);for(let c of l)for(let p=c.end-1;p>=c.start;p--)this.insertItemInDOM(p)}),n!==void 0&&(this.rowsContainer.style.left=`-${n}px`),this.rowsContainer.style.top=`-${e}px`,this.horizontalScrolling&&o!==void 0&&(this.rowsContainer.style.width=`${Math.max(o,this.renderWidth)}px`),this.lastRenderTop=e,this.lastRenderHeight=i}insertItemInDOM(t,e){let i=this.items[t];if(!i.row)if(e)i.row=e,i.stale=!0;else{let l=this.cache.alloc(i.templateId);i.row=l.row,i.stale||=l.isReusingConnectedDomNode}let n=this.accessibilityProvider.getRole(i.element)||"listitem";i.row.domNode.setAttribute("role",n);let o=this.accessibilityProvider.isChecked(i.element);if(typeof o=="boolean")i.row.domNode.setAttribute("aria-checked",String(!!o));else if(o){let l=d=>i.row.domNode.setAttribute("aria-checked",String(!!d));l(o.value),i.checkedDisposable=o.onDidChange(()=>l(o.value))}if(i.stale||!i.row.domNode.parentElement){let l=this.items.at(t+1)?.row?.domNode??null;(i.row.domNode.parentElement!==this.rowsContainer||i.row.domNode.nextElementSibling!==l)&&this.rowsContainer.insertBefore(i.row.domNode,l),i.stale=!1}this.updateItemInDOM(i,t);let s=this.renderers.get(i.templateId);if(!s)throw new Error(`No renderer found for template id ${i.templateId}`);s?.renderElement(i.element,t,i.row.templateData,i.size);let a=this.dnd.getDragURI(i.element);i.dragStartDisposable.dispose(),i.row.domNode.draggable=!!a,a&&(i.dragStartDisposable=F(i.row.domNode,"dragstart",l=>this.onDragStart(i.element,a,l))),this.horizontalScrolling&&(this.measureItemWidth(i),this.eventuallyUpdateScrollWidth())}measureItemWidth(t){if(!t.row||!t.row.domNode)return;t.row.domNode.style.width="fit-content",t.width=XS(t.row.domNode);let e=ue(t.row.domNode).getComputedStyle(t.row.domNode);e.paddingLeft&&(t.width+=parseFloat(e.paddingLeft)),e.paddingRight&&(t.width+=parseFloat(e.paddingRight)),t.row.domNode.style.width=""}updateItemInDOM(t,e){t.row.domNode.style.top=`${this.elementTop(e)}px`,this.setRowHeight&&(t.row.domNode.style.height=`${t.size}px`),this.setRowLineHeight&&(t.row.domNode.style.lineHeight=`${t.size}px`),t.row.domNode.setAttribute("data-index",`${e}`),t.row.domNode.setAttribute("data-last-element",e===this.length-1?"true":"false"),t.row.domNode.setAttribute("data-parity",e%2===0?"even":"odd"),t.row.domNode.setAttribute("aria-setsize",String(this.accessibilityProvider.getSetSize(t.element,e,this.length))),t.row.domNode.setAttribute("aria-posinset",String(this.accessibilityProvider.getPosInSet(t.element,e))),t.row.domNode.setAttribute("id",this.getElementDomId(e)),t.row.domNode.classList.toggle("drop-target",t.dropTarget)}removeItemFromDOM(t){let e=this.items[t];if(e.dragStartDisposable.dispose(),e.checkedDisposable.dispose(),e.row){let i=this.renderers.get(e.templateId);i&&i.disposeElement&&i.disposeElement(e.element,t,e.row.templateData,e.size),this.cache.release(e.row),e.row=null}this.horizontalScrolling&&this.eventuallyUpdateScrollWidth()}getScrollTop(){return this.scrollableElement.getScrollPosition().scrollTop}setScrollTop(t,e){this.scrollableElementUpdateDisposable&&(this.scrollableElementUpdateDisposable.dispose(),this.scrollableElementUpdateDisposable=null,this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight})),this.scrollableElement.setScrollPosition({scrollTop:t,reuseAnimation:e})}getScrollLeft(){return this.scrollableElement.getScrollPosition().scrollLeft}setScrollLeft(t){this.scrollableElementUpdateDisposable&&(this.scrollableElementUpdateDisposable.dispose(),this.scrollableElementUpdateDisposable=null,this.scrollableElement.setScrollDimensions({scrollWidth:this.scrollWidth})),this.scrollableElement.setScrollPosition({scrollLeft:t})}get scrollTop(){return this.getScrollTop()}set scrollTop(t){this.setScrollTop(t)}get scrollHeight(){return this._scrollHeight+(this.horizontalScrolling?10:0)+this.paddingBottom}get onMouseClick(){return X.map(this.disposables.add(new lt(this.domNode,"click")).event,t=>this.toMouseEvent(t),this.disposables)}get onMouseDblClick(){return X.map(this.disposables.add(new lt(this.domNode,"dblclick")).event,t=>this.toMouseEvent(t),this.disposables)}get onMouseMiddleClick(){return X.filter(X.map(this.disposables.add(new lt(this.domNode,"auxclick")).event,t=>this.toMouseEvent(t),this.disposables),t=>t.browserEvent.button===1,this.disposables)}get onMouseUp(){return X.map(this.disposables.add(new lt(this.domNode,"mouseup")).event,t=>this.toMouseEvent(t),this.disposables)}get onMouseDown(){return X.map(this.disposables.add(new lt(this.domNode,"mousedown")).event,t=>this.toMouseEvent(t),this.disposables)}get onMouseOver(){return X.map(this.disposables.add(new lt(this.domNode,"mouseover")).event,t=>this.toMouseEvent(t),this.disposables)}get onMouseMove(){return X.map(this.disposables.add(new lt(this.domNode,"mousemove")).event,t=>this.toMouseEvent(t),this.disposables)}get onMouseOut(){return X.map(this.disposables.add(new lt(this.domNode,"mouseout")).event,t=>this.toMouseEvent(t),this.disposables)}get onContextMenu(){return X.any(X.map(this.disposables.add(new lt(this.domNode,"contextmenu")).event,t=>this.toMouseEvent(t),this.disposables),X.map(this.disposables.add(new lt(this.domNode,At.Contextmenu)).event,t=>this.toGestureEvent(t),this.disposables))}get onTouchStart(){return X.map(this.disposables.add(new lt(this.domNode,"touchstart")).event,t=>this.toTouchEvent(t),this.disposables)}get onTap(){return X.map(this.disposables.add(new lt(this.rowsContainer,At.Tap)).event,t=>this.toGestureEvent(t),this.disposables)}toMouseEvent(t){let e=this.getItemIndexFromEventTarget(t.target||null),i=typeof e>"u"?void 0:this.items[e],n=i&&i.element;return{browserEvent:t,index:e,element:n}}toTouchEvent(t){let e=this.getItemIndexFromEventTarget(t.target||null),i=typeof e>"u"?void 0:this.items[e],n=i&&i.element;return{browserEvent:t,index:e,element:n}}toGestureEvent(t){let e=this.getItemIndexFromEventTarget(t.initialTarget||null),i=typeof e>"u"?void 0:this.items[e],n=i&&i.element;return{browserEvent:t,index:e,element:n}}toDragEvent(t){let e=this.getItemIndexFromEventTarget(t.target||null),i=typeof e>"u"?void 0:this.items[e],n=i&&i.element,o=this.getTargetSector(t,e);return{browserEvent:t,index:e,element:n,sector:o}}onScroll(t){try{let e=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight);this.render(e,t.scrollTop,t.height,t.scrollLeft,t.scrollWidth),this.supportDynamicHeights&&this._rerender(t.scrollTop,t.height,t.inSmoothScrolling)}catch(e){throw console.error("Got bad scroll event:",t),e}}onTouchChange(t){t.preventDefault(),t.stopPropagation(),this.scrollTop-=t.translationY}onDragStart(t,e,i){if(!i.dataTransfer)return;let n=this.dnd.getDragElements(t);if(i.dataTransfer.effectAllowed="copyMove",i.dataTransfer.setData(_a.TEXT,e),i.dataTransfer.setDragImage){let o;this.dnd.getDragLabel&&(o=this.dnd.getDragLabel(n,i)),typeof o>"u"&&(o=String(n.length));let s=J(".monaco-drag-image");s.textContent=o,(d=>{for(;d&&!d.classList.contains("monaco-workbench");)d=d.parentElement;return d||this.domNode.ownerDocument})(this.domNode).appendChild(s),i.dataTransfer.setDragImage(s,-10,-10),setTimeout(()=>s.remove(),0)}this.domNode.classList.add("dragging"),this.currentDragData=new Cc(n),VI.CurrentDragAndDropData=new d7(n),this.dnd.onDragStart?.(this.currentDragData,i)}onDragOver(t){if(t.browserEvent.preventDefault(),this.onDragLeaveTimeout.dispose(),VI.CurrentDragAndDropData&&VI.CurrentDragAndDropData.getData()==="vscode-ui"||(this.setupDragAndDropScrollTopAnimation(t.browserEvent),!t.browserEvent.dataTransfer))return!1;if(!this.currentDragData)if(VI.CurrentDragAndDropData)this.currentDragData=VI.CurrentDragAndDropData;else{if(!t.browserEvent.dataTransfer.types)return!1;this.currentDragData=new c7}let e=this.dnd.onDragOver(this.currentDragData,t.element,t.index,t.sector,t.browserEvent);if(this.canDrop=typeof e=="boolean"?e:e.accept,!this.canDrop)return this.currentDragFeedback=void 0,this.currentDragFeedbackDisposable.dispose(),!1;t.browserEvent.dataTransfer.dropEffect=typeof e!="boolean"&&e.effect?.type===0?"copy":"move";let i;typeof e!="boolean"&&e.feedback?i=e.feedback:typeof t.index>"u"?i=[-1]:i=[t.index],i=Mo(i).filter(o=>o>=-1&&o<this.length).sort((o,s)=>o-s),i=i[0]===-1?[-1]:i;let n=typeof e!="boolean"&&e.effect&&e.effect.position?e.effect.position:"drop-target";if(fSe(this.currentDragFeedback,i)&&this.currentDragFeedbackPosition===n)return!0;if(this.currentDragFeedback=i,this.currentDragFeedbackPosition=n,this.currentDragFeedbackDisposable.dispose(),i[0]===-1)this.domNode.classList.add(n),this.rowsContainer.classList.add(n),this.currentDragFeedbackDisposable=le(()=>{this.domNode.classList.remove(n),this.rowsContainer.classList.remove(n)});else{if(i.length>1&&n!=="drop-target")throw new Error("Can't use multiple feedbacks with position different than 'over'");n==="drop-target-after"&&i[0]<this.length-1&&(i[0]+=1,n="drop-target-before");for(let o of i){let s=this.items[o];s.dropTarget=!0,s.row?.domNode.classList.add(n)}this.currentDragFeedbackDisposable=le(()=>{for(let o of i){let s=this.items[o];s.dropTarget=!1,s.row?.domNode.classList.remove(n)}})}return!0}onDragLeave(t){this.onDragLeaveTimeout.dispose(),this.onDragLeaveTimeout=Sd(()=>this.clearDragOverFeedback(),100,this.disposables),this.currentDragData&&this.dnd.onDragLeave?.(this.currentDragData,t.element,t.index,t.browserEvent)}onDrop(t){if(!this.canDrop)return;let e=this.currentDragData;this.teardownDragAndDropScrollTopAnimation(),this.clearDragOverFeedback(),this.domNode.classList.remove("dragging"),this.currentDragData=void 0,VI.CurrentDragAndDropData=void 0,!(!e||!t.browserEvent.dataTransfer)&&(t.browserEvent.preventDefault(),e.update(t.browserEvent.dataTransfer),this.dnd.drop(e,t.element,t.index,t.sector,t.browserEvent))}onDragEnd(t){this.canDrop=!1,this.teardownDragAndDropScrollTopAnimation(),this.clearDragOverFeedback(),this.domNode.classList.remove("dragging"),this.currentDragData=void 0,VI.CurrentDragAndDropData=void 0,this.dnd.onDragEnd?.(t)}clearDragOverFeedback(){this.currentDragFeedback=void 0,this.currentDragFeedbackPosition=void 0,this.currentDragFeedbackDisposable.dispose(),this.currentDragFeedbackDisposable=R.None}setupDragAndDropScrollTopAnimation(t){if(!this.dragOverAnimationDisposable){let e=rD(this.domNode).top;this.dragOverAnimationDisposable=yte(ue(this.domNode),this.animateDragAndDropScrollTop.bind(this,e))}this.dragOverAnimationStopDisposable.dispose(),this.dragOverAnimationStopDisposable=Sd(()=>{this.dragOverAnimationDisposable&&(this.dragOverAnimationDisposable.dispose(),this.dragOverAnimationDisposable=void 0)},1e3,this.disposables),this.dragOverMouseY=t.pageY}animateDragAndDropScrollTop(t){if(this.dragOverMouseY===void 0)return;let e=this.dragOverMouseY-t,i=this.renderHeight-35;e<35?this.scrollTop+=Math.max(-14,Math.floor(.3*(e-35))):e>i&&(this.scrollTop+=Math.min(14,Math.floor(.3*(e-i))))}teardownDragAndDropScrollTopAnimation(){this.dragOverAnimationStopDisposable.dispose(),this.dragOverAnimationDisposable&&(this.dragOverAnimationDisposable.dispose(),this.dragOverAnimationDisposable=void 0)}getTargetSector(t,e){if(e===void 0)return;let i=t.offsetY/this.items[e].size,n=Math.floor(i/.25);return pn(n,0,3)}getItemIndexFromEventTarget(t){let e=this.scrollableElement.getDomNode(),i=t;for(;(on(i)||gte(i))&&i!==this.rowsContainer&&e.contains(i);){let n=i.getAttribute("data-index");if(n){let o=Number(n);if(!isNaN(o))return o}i=i.parentElement}}getRenderRange(t,e){return{start:this.rangeMap.indexAt(t),end:this.rangeMap.indexAfter(t+e-1)}}_rerender(t,e,i){let n=this.getRenderRange(t,e),o,s;t===this.elementTop(n.start)?(o=n.start,s=0):n.end-n.start>1&&(o=n.start+1,s=this.elementTop(o)-t);let a=0;for(;;){let l=this.getRenderRange(t,e),d=!1;for(let c=l.start;c<l.end;c++){let p=this.probeDynamicHeight(c);p!==0&&this.rangeMap.splice(c,1,[this.items[c]]),a+=p,d=d||p!==0}if(!d){a!==0&&this.eventuallyUpdateScrollDimensions();let c=ts.relativeComplement(n,l);for(let h of c)for(let m=h.start;m<h.end;m++)this.items[m].row&&this.removeItemFromDOM(m);let p=ts.relativeComplement(l,n).reverse();for(let h of p)for(let m=h.end-1;m>=h.start;m--)this.insertItemInDOM(m);for(let h=l.start;h<l.end;h++)this.items[h].row&&this.updateItemInDOM(this.items[h],h);if(typeof o=="number"){let h=this.scrollable.getFutureScrollPosition().scrollTop-t,m=this.elementTop(o)-s+h;this.setScrollTop(m,i)}this._onDidChangeContentHeight.fire(this.contentHeight);return}}}probeDynamicHeight(t){let e=this.items[t];if(this.virtualDelegate.getDynamicHeight){let s=this.virtualDelegate.getDynamicHeight(e.element);if(s!==null){let a=e.size;return e.size=s,e.lastDynamicHeightWidth=this.renderWidth,s-a}}if(!e.hasDynamicHeight||e.lastDynamicHeightWidth===this.renderWidth||this.virtualDelegate.hasDynamicHeight&&!this.virtualDelegate.hasDynamicHeight(e.element))return 0;let i=e.size;if(e.row)return e.row.domNode.style.height="",e.size=e.row.domNode.offsetHeight,e.size===0&&!$n(e.row.domNode,ue(e.row.domNode).document.body)&&console.warn("Measuring item node that is not in DOM! Add ListView to the DOM before measuring row height!",new Error().stack),e.lastDynamicHeightWidth=this.renderWidth,e.size-i;let{row:n}=this.cache.alloc(e.templateId);n.domNode.style.height="",this.rowsContainer.appendChild(n.domNode);let o=this.renderers.get(e.templateId);if(!o)throw new _t("Missing renderer for templateId: "+e.templateId);return o.renderElement(e.element,t,n.templateData,void 0),e.size=n.domNode.offsetHeight,o.disposeElement?.(e.element,t,n.templateData,void 0),this.virtualDelegate.setDynamicHeight?.(e.element,e.size),e.lastDynamicHeightWidth=this.renderWidth,n.domNode.remove(),this.cache.release(n),e.size-i}getElementDomId(t){return`${this.domId}_${t}`}dispose(){for(let t of this.items)if(t.dragStartDisposable.dispose(),t.checkedDisposable.dispose(),t.row){let e=this.renderers.get(t.row.templateId);e&&(e.disposeElement?.(t.element,-1,t.row.templateData,void 0),e.disposeTemplate(t.row.templateData))}this.items=[],this.domNode?.remove(),this.dragOverAnimationDisposable?.dispose(),this.disposables.dispose()}};E([Re],Ul.prototype,"onMouseClick",1),E([Re],Ul.prototype,"onMouseDblClick",1),E([Re],Ul.prototype,"onMouseMiddleClick",1),E([Re],Ul.prototype,"onMouseUp",1),E([Re],Ul.prototype,"onMouseDown",1),E([Re],Ul.prototype,"onMouseOver",1),E([Re],Ul.prototype,"onMouseMove",1),E([Re],Ul.prototype,"onMouseOut",1),E([Re],Ul.prototype,"onContextMenu",1),E([Re],Ul.prototype,"onTouchStart",1),E([Re],Ul.prototype,"onTap",1);var x1=Ul;var eh=class extends Error{constructor(t,e){super(`ListError [${t}] ${e}`)}},T1=class{cache=new WeakMap;getHeight(t){return this.cache.get(t)??this.estimateHeight(t)}setDynamicHeight(t,e){e>0&&this.cache.set(t,e)}};var p7=class{constructor(t){this.trait=t}renderedElements=[];get templateId(){return`template:${this.trait.name}`}renderTemplate(t){return t}renderElement(t,e,i){let n=this.renderedElements.findIndex(o=>o.templateData===i);if(n>=0){let o=this.renderedElements[n];this.trait.unrender(i),o.index=e}else{let o={index:e,templateData:i};this.renderedElements.push(o)}this.trait.renderIndex(e,i)}splice(t,e,i){let n=[];for(let o of this.renderedElements)o.index<t?n.push(o):o.index>=t+e&&n.push({index:o.index+i-e,templateData:o.templateData});this.renderedElements=n}renderIndexes(t){for(let{index:e,templateData:i}of this.renderedElements)t.indexOf(e)>-1&&this.trait.renderIndex(e,i)}disposeTemplate(t){let e=this.renderedElements.findIndex(i=>i.templateData===t);e<0||this.renderedElements.splice(e,1)}},Iw=class{constructor(t){this._trait=t}indexes=[];sortedIndexes=[];_onChange=new x;onChange=this._onChange.event;get name(){return this._trait}get renderer(){return new p7(this)}splice(t,e,i){let n=i.length-e,o=t+e,s=[],a=0;for(;a<this.sortedIndexes.length&&this.sortedIndexes[a]<t;)s.push(this.sortedIndexes[a++]);for(let l=0;l<i.length;l++)i[l]&&s.push(l+t);for(;a<this.sortedIndexes.length&&this.sortedIndexes[a]>=o;)s.push(this.sortedIndexes[a++]+n);this.renderer.splice(t,e,i.length),this._set(s,s)}renderIndex(t,e){e.classList.toggle(this._trait,this.contains(t))}unrender(t){t.classList.remove(this._trait)}set(t,e){return this._set(t,[...t].sort(lae),e)}_set(t,e,i){let n=this.indexes,o=this.sortedIndexes;this.indexes=t,this.sortedIndexes=e;let s=f7(o,t);return this.renderer.renderIndexes(s),this._onChange.fire({indexes:t,browserEvent:i}),n}get(){return this.indexes}contains(t){return HM(this.sortedIndexes,t,lae)>=0}dispose(){_e(this._onChange)}};E([Re],Iw.prototype,"renderer",1);var h7=class extends Iw{constructor(e){super("selected");this.setAriaSelected=e}renderIndex(e,i){super.renderIndex(e,i),this.setAriaSelected&&(this.contains(e)?i.setAttribute("aria-selected","true"):i.setAttribute("aria-selected","false"))}},Uk=class{constructor(t,e,i){this.trait=t;this.view=e;this.identityProvider=i}splice(t,e,i){if(!this.identityProvider)return this.trait.splice(t,e,new Array(i.length).fill(!1));let n=this.trait.get().map(a=>this.identityProvider.getId(this.view.element(a)).toString());if(n.length===0)return this.trait.splice(t,e,new Array(i.length).fill(!1));let o=new Set(n),s=i.map(a=>o.has(this.identityProvider.getId(a).toString()));this.trait.splice(t,e,s)}};function Kk(r,t){return r.classList.contains(t)?!0:r.classList.contains("monaco-list")||!r.parentElement?!1:Kk(r.parentElement,t)}function vw(r){return Kk(r,"monaco-editor")}function dae(r){return Kk(r,"monaco-custom-toggle")}function cae(r){return Kk(r,"action-item")}function yw(r){return Kk(r,"monaco-tree-sticky-row")}function Sw(r){return r.classList.contains("monaco-tree-sticky-container")}function y7(r){return r.tagName==="A"&&r.classList.contains("monaco-button")||r.tagName==="DIV"&&r.classList.contains("monaco-button-dropdown")?!0:r.classList.contains("monaco-list")||!r.parentElement?!1:y7(r.parentElement)}var _1=class{constructor(t,e,i){this.list=t;this.view=e;this.multipleSelectionSupport=i.multipleSelectionSupport,this.disposables.add(this.onKeyDown(n=>{switch(n.keyCode){case 3:return this.onEnter(n);case 16:return this.onUpArrow(n);case 18:return this.onDownArrow(n);case 11:return this.onPageUpArrow(n);case 12:return this.onPageDownArrow(n);case 9:return this.onEscape(n);case 31:this.multipleSelectionSupport&&(ye?n.metaKey:n.ctrlKey)&&this.onCtrlA(n)}}))}disposables=new B;multipleSelectionDisposables=new B;multipleSelectionSupport;get onKeyDown(){return X.chain(this.disposables.add(new lt(this.view.domNode,"keydown")).event,t=>t.filter(e=>!dc(e.target)).map(e=>new ut(e)))}updateOptions(t){t.multipleSelectionSupport!==void 0&&(this.multipleSelectionSupport=t.multipleSelectionSupport)}onEnter(t){t.preventDefault(),t.stopPropagation(),this.list.setSelection(this.list.getFocus(),t.browserEvent)}onUpArrow(t){t.preventDefault(),t.stopPropagation(),this.list.focusPrevious(1,!1,t.browserEvent);let e=this.list.getFocus()[0];this.list.setAnchor(e),this.list.reveal(e),this.view.domNode.focus()}onDownArrow(t){t.preventDefault(),t.stopPropagation(),this.list.focusNext(1,!1,t.browserEvent);let e=this.list.getFocus()[0];this.list.setAnchor(e),this.list.reveal(e),this.view.domNode.focus()}onPageUpArrow(t){t.preventDefault(),t.stopPropagation(),this.list.focusPreviousPage(t.browserEvent);let e=this.list.getFocus()[0];this.list.setAnchor(e),this.list.reveal(e),this.view.domNode.focus()}onPageDownArrow(t){t.preventDefault(),t.stopPropagation(),this.list.focusNextPage(t.browserEvent);let e=this.list.getFocus()[0];this.list.setAnchor(e),this.list.reveal(e),this.view.domNode.focus()}onCtrlA(t){t.preventDefault(),t.stopPropagation(),this.list.setSelection(yr(this.list.length),t.browserEvent),this.list.setAnchor(void 0),this.view.domNode.focus()}onEscape(t){this.list.getSelection().length&&(t.preventDefault(),t.stopPropagation(),this.list.setSelection([],t.browserEvent),this.list.setAnchor(void 0),this.view.domNode.focus())}dispose(){this.disposables.dispose(),this.multipleSelectionDisposables.dispose()}};E([Re],_1.prototype,"onKeyDown",1);var bSe=new class{mightProducePrintableCharacter(r){return r.ctrlKey||r.metaKey||r.altKey?!1:r.keyCode>=31&&r.keyCode<=56||r.keyCode>=21&&r.keyCode<=30||r.keyCode>=98&&r.keyCode<=107||r.keyCode>=85&&r.keyCode<=95}},m7=class{constructor(t,e,i,n,o){this.list=t;this.view=e;this.keyboardNavigationLabelProvider=i;this.keyboardNavigationEventFilter=n;this.delegate=o;this.updateOptions(t.options)}enabled=!1;state=0;mode=0;triggered=!1;previouslyFocused=-1;enabledDisposables=new B;disposables=new B;updateOptions(t){t.typeNavigationEnabled??!0?this.enable():this.disable(),this.mode=t.typeNavigationMode??0}trigger(){this.triggered=!this.triggered}enable(){if(this.enabled)return;let t=!1,e=X.chain(this.enabledDisposables.add(new lt(this.view.domNode,"keydown")).event,o=>o.filter(s=>!dc(s.target)).filter(()=>this.mode===0||this.triggered).map(s=>new ut(s)).filter(s=>t||this.keyboardNavigationEventFilter(s)).filter(s=>this.delegate.mightProducePrintableCharacter(s)).forEach(s=>Ve.stop(s,!0)).map(s=>s.browserEvent.key)),i=X.debounce(e,()=>null,800,void 0,void 0,void 0,this.enabledDisposables);X.reduce(X.any(e,i),(o,s)=>s===null?null:(o||"")+s,void 0,this.enabledDisposables)(this.onInput,this,this.enabledDisposables),i(this.onClear,this,this.enabledDisposables),e(()=>t=!0,void 0,this.enabledDisposables),i(()=>t=!1,void 0,this.enabledDisposables),this.enabled=!0,this.triggered=!1}disable(){this.enabled&&(this.enabledDisposables.clear(),this.enabled=!1,this.triggered=!1)}onClear(){let t=this.list.getFocus();if(t.length>0&&t[0]===this.previouslyFocused){let e=this.list.options.accessibilityProvider?.getAriaLabel(this.list.element(t[0]));typeof e=="string"?ka(e):e&&ka(e.get())}this.previouslyFocused=-1}onInput(t){if(!t){this.state=0,this.triggered=!1;return}let e=this.list.getFocus(),i=e.length>0?e[0]:0,n=this.state===0?1:0;this.state=1;for(let o=0;o<this.list.length;o++){let s=(i+o+n)%this.list.length,a=this.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(this.view.element(s)),l=a&&a.toString();if(this.list.options.typeNavigationEnabled){if(typeof l<"u"){if(nI(t,l)){this.previouslyFocused=i,this.list.setFocus([s]),this.list.reveal(s);return}let d=Ote(t,l);if(d&&d[0].end-d[0].start>1&&d.length===1){this.previouslyFocused=i,this.list.setFocus([s]),this.list.reveal(s);return}}}else if(typeof l>"u"||nI(t,l)){this.previouslyFocused=i,this.list.setFocus([s]),this.list.reveal(s);return}}}dispose(){this.disable(),this.enabledDisposables.dispose(),this.disposables.dispose()}},g7=class{constructor(t,e){this.list=t;this.view=e;let i=X.chain(this.disposables.add(new lt(e.domNode,"keydown")).event,o=>o.filter(s=>!dc(s.target)).map(s=>new ut(s)));X.chain(i,o=>o.filter(s=>s.keyCode===2&&!s.ctrlKey&&!s.metaKey&&!s.shiftKey&&!s.altKey))(this.onTab,this,this.disposables)}disposables=new B;onTab(t){if(t.target!==this.view.domNode)return;let e=this.list.getFocus();if(e.length===0)return;let i=this.view.domElement(e[0]);if(!i)return;let n=i.querySelector("[tabIndex]");if(!n||!on(n)||n.tabIndex===-1)return;let o=ue(n).getComputedStyle(n);o.visibility==="hidden"||o.display==="none"||(t.preventDefault(),t.stopPropagation(),n.focus())}dispose(){this.disposables.dispose()}};function S7(r){return ye?r.browserEvent.metaKey:r.browserEvent.ctrlKey}function C7(r){return r.browserEvent.shiftKey}function vSe(r){return Za(r)&&r.button===2}var aae={isSelectionSingleChangeEvent:S7,isSelectionRangeChangeEvent:C7},zk=class{constructor(t){this.list=t;t.options.multipleSelectionSupport!==!1&&(this.multipleSelectionController=this.list.options.multipleSelectionController||aae),this.mouseSupport=typeof t.options.mouseSupport>"u"||!!t.options.mouseSupport,this.mouseSupport&&(t.onMouseDown(this.onMouseDown,this,this.disposables),t.onContextMenu(this.onContextMenu,this,this.disposables),t.onMouseDblClick(this.onDoubleClick,this,this.disposables),t.onTouchStart(this.onMouseDown,this,this.disposables),this.disposables.add(yi.addTarget(t.getHTMLElement()))),X.any(t.onMouseClick,t.onMouseMiddleClick,t.onTap)(this.onViewPointer,this,this.disposables)}multipleSelectionController;mouseSupport;disposables=new B;_onPointer=new x;onPointer=this._onPointer.event;updateOptions(t){t.multipleSelectionSupport!==void 0&&(this.multipleSelectionController=void 0,t.multipleSelectionSupport&&(this.multipleSelectionController=this.list.options.multipleSelectionController||aae))}isSelectionSingleChangeEvent(t){return this.multipleSelectionController?this.multipleSelectionController.isSelectionSingleChangeEvent(t):!1}isSelectionRangeChangeEvent(t){return this.multipleSelectionController?this.multipleSelectionController.isSelectionRangeChangeEvent(t):!1}isSelectionChangeEvent(t){return this.isSelectionSingleChangeEvent(t)||this.isSelectionRangeChangeEvent(t)}onMouseDown(t){vw(t.browserEvent.target)||fo()!==t.browserEvent.target&&this.list.domFocus()}onContextMenu(t){if(dc(t.browserEvent.target)||vw(t.browserEvent.target))return;let e=typeof t.index>"u"?[]:[t.index];this.list.setFocus(e,t.browserEvent)}onViewPointer(t){if(!this.mouseSupport||dc(t.browserEvent.target)||vw(t.browserEvent.target)||t.browserEvent.isHandledByList)return;t.browserEvent.isHandledByList=!0;let e=t.index;if(typeof e>"u"){this.list.setFocus([],t.browserEvent),this.list.setSelection([],t.browserEvent),this.list.setAnchor(void 0);return}if(this.isSelectionChangeEvent(t))return this.changeSelection(t);this.list.setFocus([e],t.browserEvent),this.list.setAnchor(e),vSe(t.browserEvent)||this.list.setSelection([e],t.browserEvent),this._onPointer.fire(t)}onDoubleClick(t){if(dc(t.browserEvent.target)||vw(t.browserEvent.target)||this.isSelectionChangeEvent(t)||t.browserEvent.isHandledByList)return;t.browserEvent.isHandledByList=!0;let e=this.list.getFocus();this.list.setSelection(e,t.browserEvent)}changeSelection(t){let e=t.index,i=this.list.getAnchor();if(this.isSelectionRangeChangeEvent(t)){typeof i>"u"&&(i=this.list.getFocus()[0]??e,this.list.setAnchor(i));let n=Math.min(i,e),o=Math.max(i,e),s=yr(n,o+1),a=this.list.getSelection(),l=ySe(f7(a,[i]),i);if(l.length===0)return;let d=f7(s,SSe(a,l));this.list.setSelection(d,t.browserEvent),this.list.setFocus([e],t.browserEvent)}else if(this.isSelectionSingleChangeEvent(t)){let n=this.list.getSelection(),o=n.filter(s=>s!==e);this.list.setFocus([e]),this.list.setAnchor(e),n.length===o.length?this.list.setSelection([...o,e],t.browserEvent):this.list.setSelection(o,t.browserEvent)}}dispose(){this.disposables.dispose()}},D1=class{constructor(t,e){this.styleElement=t;this.selectorSuffix=e}style(t){let e=this.selectorSuffix&&`.${this.selectorSuffix}`,i=[];t.listBackground&&i.push(`.monaco-list${e} .monaco-list-rows { background: ${t.listBackground}; }`),t.listFocusBackground&&(i.push(`.monaco-list${e}:focus .monaco-list-row.focused { background-color: ${t.listFocusBackground}; }`),i.push(`.monaco-list${e}:focus .monaco-list-row.focused:hover { background-color: ${t.listFocusBackground}; }`)),t.listFocusForeground&&i.push(`.monaco-list${e}:focus .monaco-list-row.focused { color: ${t.listFocusForeground}; }`),t.listActiveSelectionBackground&&(i.push(`.monaco-list${e}:focus .monaco-list-row.selected { background-color: ${t.listActiveSelectionBackground}; }`),i.push(`.monaco-list${e}:focus .monaco-list-row.selected:hover { background-color: ${t.listActiveSelectionBackground}; }`)),t.listActiveSelectionForeground&&i.push(`.monaco-list${e}:focus .monaco-list-row.selected { color: ${t.listActiveSelectionForeground}; }`),t.listActiveSelectionIconForeground&&i.push(`.monaco-list${e}:focus .monaco-list-row.selected .codicon { color: ${t.listActiveSelectionIconForeground}; }`),t.listFocusAndSelectionBackground&&i.push(`
				.monaco-drag-image,
				.monaco-list${e}:focus .monaco-list-row.selected.focused { background-color: ${t.listFocusAndSelectionBackground}; }
			`),t.listFocusAndSelectionForeground&&i.push(`
				.monaco-drag-image,
				.monaco-list${e}:focus .monaco-list-row.selected.focused { color: ${t.listFocusAndSelectionForeground}; }
			`),t.listInactiveFocusForeground&&(i.push(`.monaco-list${e} .monaco-list-row.focused { color:  ${t.listInactiveFocusForeground}; }`),i.push(`.monaco-list${e} .monaco-list-row.focused:hover { color:  ${t.listInactiveFocusForeground}; }`)),t.listInactiveSelectionIconForeground&&i.push(`.monaco-list${e} .monaco-list-row.focused .codicon { color:  ${t.listInactiveSelectionIconForeground}; }`),t.listInactiveFocusBackground&&(i.push(`.monaco-list${e} .monaco-list-row.focused { background-color:  ${t.listInactiveFocusBackground}; }`),i.push(`.monaco-list${e} .monaco-list-row.focused:hover { background-color:  ${t.listInactiveFocusBackground}; }`)),t.listInactiveSelectionBackground&&(i.push(`.monaco-list${e} .monaco-list-row.selected { background-color:  ${t.listInactiveSelectionBackground}; }`),i.push(`.monaco-list${e} .monaco-list-row.selected:hover { background-color:  ${t.listInactiveSelectionBackground}; }`)),t.listInactiveSelectionForeground&&i.push(`.monaco-list${e} .monaco-list-row.selected { color: ${t.listInactiveSelectionForeground}; }`),t.listHoverBackground&&i.push(`.monaco-list${e}:not(.drop-target):not(.dragging) .monaco-list-row:hover:not(.selected):not(.focused) { background-color: ${t.listHoverBackground}; }`),t.listHoverForeground&&i.push(`.monaco-list${e}:not(.drop-target):not(.dragging) .monaco-list-row:hover:not(.selected):not(.focused) { color:  ${t.listHoverForeground}; }`);let n=Ja(t.listFocusAndSelectionOutline,Ja(t.listSelectionOutline,t.listFocusOutline??""));n&&i.push(`.monaco-list${e}:focus .monaco-list-row.focused.selected { outline: 1px solid ${n}; outline-offset: -1px;}`),t.listFocusOutline&&i.push(`
				.monaco-drag-image,
				.monaco-list${e}:focus .monaco-list-row.focused { outline: 1px solid ${t.listFocusOutline}; outline-offset: -1px; }
				.monaco-workbench.context-menu-visible .monaco-list${e}.last-focused .monaco-list-row.focused { outline: 1px solid ${t.listFocusOutline}; outline-offset: -1px; }
			`);let o=Ja(t.listSelectionOutline,t.listInactiveFocusOutline??"");o&&i.push(`.monaco-list${e} .monaco-list-row.focused.selected { outline: 1px dotted ${o}; outline-offset: -1px; }`),t.listSelectionOutline&&i.push(`.monaco-list${e} .monaco-list-row.selected { outline: 1px dotted ${t.listSelectionOutline}; outline-offset: -1px; }`),t.listInactiveFocusOutline&&i.push(`.monaco-list${e} .monaco-list-row.focused { outline: 1px dotted ${t.listInactiveFocusOutline}; outline-offset: -1px; }`),t.listHoverOutline&&i.push(`.monaco-list${e} .monaco-list-row:hover { outline: 1px dashed ${t.listHoverOutline}; outline-offset: -1px; }`),t.listDropOverBackground&&i.push(`
				.monaco-list${e}.drop-target,
				.monaco-list${e} .monaco-list-rows.drop-target,
				.monaco-list${e} .monaco-list-row.drop-target { background-color: ${t.listDropOverBackground} !important; color: inherit !important; }
			`),t.listDropBetweenBackground&&(i.push(`
			.monaco-list${e} .monaco-list-rows.drop-target-before .monaco-list-row:first-child::before,
			.monaco-list${e} .monaco-list-row.drop-target-before::before {
				content: ""; position: absolute; top: 0px; left: 0px; width: 100%; height: 1px;
				background-color: ${t.listDropBetweenBackground};
			}`),i.push(`
			.monaco-list${e} .monaco-list-rows.drop-target-after .monaco-list-row:last-child::after,
			.monaco-list${e} .monaco-list-row.drop-target-after::after {
				content: ""; position: absolute; bottom: 0px; left: 0px; width: 100%; height: 1px;
				background-color: ${t.listDropBetweenBackground};
			}`)),t.tableColumnsBorder&&i.push(`
				.monaco-table > .monaco-split-view2,
				.monaco-table > .monaco-split-view2 .monaco-sash.vertical::before,
				.monaco-workbench:not(.reduce-motion) .monaco-table:hover > .monaco-split-view2,
				.monaco-workbench:not(.reduce-motion) .monaco-table:hover > .monaco-split-view2 .monaco-sash.vertical::before {
					border-color: ${t.tableColumnsBorder};
				}

				.monaco-workbench:not(.reduce-motion) .monaco-table > .monaco-split-view2,
				.monaco-workbench:not(.reduce-motion) .monaco-table > .monaco-split-view2 .monaco-sash.vertical::before {
					border-color: transparent;
				}
			`),t.tableOddRowsBackgroundColor&&i.push(`
				.monaco-table .monaco-list-row[data-parity=odd]:not(.focused):not(.selected):not(:hover) .monaco-table-tr,
				.monaco-table .monaco-list:not(:focus) .monaco-list-row[data-parity=odd].focused:not(.selected):not(:hover) .monaco-table-tr,
				.monaco-table .monaco-list:not(.focused) .monaco-list-row[data-parity=odd].focused:not(.selected):not(:hover) .monaco-table-tr {
					background-color: ${t.tableOddRowsBackgroundColor};
				}
			`),this.styleElement.textContent=i.join(`
`)}},k1={listFocusBackground:"#7FB0D0",listActiveSelectionBackground:"#0E639C",listActiveSelectionForeground:"#FFFFFF",listActiveSelectionIconForeground:"#FFFFFF",listFocusAndSelectionOutline:"#90C2F9",listFocusAndSelectionBackground:"#094771",listFocusAndSelectionForeground:"#FFFFFF",listInactiveSelectionBackground:"#3F3F46",listInactiveSelectionIconForeground:"#FFFFFF",listHoverBackground:"#2A2D2E",listDropOverBackground:"#383B3D",listDropBetweenBackground:"#EEEEEE",treeIndentGuidesStroke:"#a9a9a9",treeInactiveIndentGuidesStroke:j.fromHex("#a9a9a9").transparent(.4).toString(),tableColumnsBorder:j.fromHex("#cccccc").transparent(.2).toString(),tableOddRowsBackgroundColor:j.fromHex("#cccccc").transparent(.04).toString(),listBackground:void 0,listFocusForeground:void 0,listInactiveSelectionForeground:void 0,listInactiveFocusForeground:void 0,listInactiveFocusBackground:void 0,listHoverForeground:void 0,listFocusOutline:void 0,listInactiveFocusOutline:void 0,listSelectionOutline:void 0,listHoverOutline:void 0,treeStickyScrollBackground:void 0,treeStickyScrollBorder:void 0,treeStickyScrollShadow:void 0},ISe={keyboardSupport:!0,mouseSupport:!0,multipleSelectionSupport:!0,dnd:{getDragURI(){return null},onDragStart(){},onDragOver(){return!1},drop(){},dispose(){}}};function ySe(r,t){let e=r.indexOf(t);if(e===-1)return[];let i=[],n=e-1;for(;n>=0&&r[n]===t-(e-n);)i.push(r[n--]);for(i.reverse(),n=e;n<r.length&&r[n]===t+(n-e);)i.push(r[n++]);return i}function f7(r,t){let e=[],i=0,n=0;for(;i<r.length||n<t.length;)if(i>=r.length)e.push(t[n++]);else if(n>=t.length)e.push(r[i++]);else if(r[i]===t[n]){e.push(r[i]),i++,n++;continue}else r[i]<t[n]?e.push(r[i++]):e.push(t[n++]);return e}function SSe(r,t){let e=[],i=0,n=0;for(;i<r.length||n<t.length;)if(i>=r.length)e.push(t[n++]);else if(n>=t.length)e.push(r[i++]);else if(r[i]===t[n]){i++,n++;continue}else r[i]<t[n]?e.push(r[i++]):n++;return e}var lae=(r,t)=>r-t,b7=class{constructor(t,e){this._templateId=t;this.renderers=e}get templateId(){return this._templateId}renderTemplate(t){return this.renderers.map(e=>e.renderTemplate(t))}renderElement(t,e,i,n){let o=0;for(let s of this.renderers)s.renderElement(t,e,i[o++],n)}disposeElement(t,e,i,n){let o=0;for(let s of this.renderers)s.disposeElement?.(t,e,i[o],n),o+=1}disposeTemplate(t){let e=0;for(let i of this.renderers)i.disposeTemplate(t[e++])}},v7=class{constructor(t){this.accessibilityProvider=t}templateId="a18n";renderTemplate(t){return{container:t,disposables:new B}}renderElement(t,e,i){let n=this.accessibilityProvider.getAriaLabel(t),o=n&&typeof n!="string"?n:qg(n);i.disposables.add(Ft(a=>{this.setAriaLabel(a.readObservable(o),i.container)}));let s=this.accessibilityProvider.getAriaLevel&&this.accessibilityProvider.getAriaLevel(t);typeof s=="number"?i.container.setAttribute("aria-level",`${s}`):i.container.removeAttribute("aria-level")}setAriaLabel(t,e){t?e.setAttribute("aria-label",t):e.removeAttribute("aria-label")}disposeElement(t,e,i,n){i.disposables.clear()}disposeTemplate(t){t.disposables.dispose()}},I7=class{constructor(t,e){this.list=t;this.dnd=e}getDragElements(t){let e=this.list.getSelectedElements();return e.indexOf(t)>-1?e:[t]}getDragURI(t){return this.dnd.getDragURI(t)}getDragLabel(t,e){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(t,e)}onDragStart(t,e){this.dnd.onDragStart?.(t,e)}onDragOver(t,e,i,n,o){return this.dnd.onDragOver(t,e,i,n,o)}onDragLeave(t,e,i,n){this.dnd.onDragLeave?.(t,e,i,n)}onDragEnd(t){this.dnd.onDragEnd?.(t)}drop(t,e,i,n,o){this.dnd.drop(t,e,i,n,o)}dispose(){this.dnd.dispose()}},ho=class{constructor(t,e,i,n,o=ISe){this.user=t;this._options=o;let s=this._options.accessibilityProvider&&this._options.accessibilityProvider.getWidgetRole?this._options.accessibilityProvider?.getWidgetRole():"list";this.selection=new h7(s!=="listbox");let a=[this.focus.renderer,this.selection.renderer];this.accessibilityProvider=o.accessibilityProvider,this.accessibilityProvider&&(a.push(new v7(this.accessibilityProvider)),this.accessibilityProvider.onDidChangeActiveDescendant?.(this.onDidChangeActiveDescendant,this,this.disposables)),n=n.map(d=>new b7(d.templateId,[...a,d]));let l={...o,dnd:o.dnd&&new I7(this,o.dnd)};if(this.view=this.createListView(e,i,n,l),this.view.domNode.setAttribute("role",s),o.styleController)this.styleController=o.styleController(this.view.domId);else{let d=Go(this.view.domNode);this.styleController=new D1(d,this.view.domId)}if(this.spliceable=new S1([new Uk(this.focus,this.view,o.identityProvider),new Uk(this.selection,this.view,o.identityProvider),new Uk(this.anchor,this.view,o.identityProvider),this.view]),this.disposables.add(this.focus),this.disposables.add(this.selection),this.disposables.add(this.anchor),this.disposables.add(this.view),this.disposables.add(this._onDidDispose),this.disposables.add(new g7(this,this.view)),(typeof o.keyboardSupport!="boolean"||o.keyboardSupport)&&(this.keyboardController=new _1(this,this.view,o),this.disposables.add(this.keyboardController)),o.keyboardNavigationLabelProvider){let d=o.keyboardNavigationDelegate||bSe;this.typeNavigationController=new m7(this,this.view,o.keyboardNavigationLabelProvider,o.keyboardNavigationEventFilter??(()=>!0),d),this.disposables.add(this.typeNavigationController)}this.mouseController=this.createMouseController(o),this.disposables.add(this.mouseController),this.onDidChangeFocus(this._onFocusChange,this,this.disposables),this.onDidChangeSelection(this._onSelectionChange,this,this.disposables),this.accessibilityProvider&&(this.ariaLabel=this.accessibilityProvider.getWidgetAriaLabel()),this._options.multipleSelectionSupport!==!1&&this.view.domNode.setAttribute("aria-multiselectable","true")}focus=new Iw("focused");selection;anchor=new Iw("anchor");eventBufferer=new Xg;view;spliceable;styleController;typeNavigationController;accessibilityProvider;keyboardController;mouseController;_ariaLabel="";disposables=new B;get onDidChangeFocus(){return X.map(this.eventBufferer.wrapEvent(this.focus.onChange),t=>this.toListEvent(t),this.disposables)}get onDidChangeSelection(){return X.map(this.eventBufferer.wrapEvent(this.selection.onChange),t=>this.toListEvent(t),this.disposables)}get domId(){return this.view.domId}get onDidScroll(){return this.view.onDidScroll}get onMouseClick(){return this.view.onMouseClick}get onMouseDblClick(){return this.view.onMouseDblClick}get onMouseMiddleClick(){return this.view.onMouseMiddleClick}get onPointer(){return this.mouseController.onPointer}get onMouseUp(){return this.view.onMouseUp}get onMouseDown(){return this.view.onMouseDown}get onMouseOver(){return this.view.onMouseOver}get onMouseMove(){return this.view.onMouseMove}get onMouseOut(){return this.view.onMouseOut}get onTouchStart(){return this.view.onTouchStart}get onTap(){return this.view.onTap}get onContextMenu(){let t=!1,e=X.chain(this.disposables.add(new lt(this.view.domNode,"keydown")).event,o=>o.map(s=>new ut(s)).filter(s=>t=s.keyCode===58||s.shiftKey&&s.keyCode===68).map(s=>Ve.stop(s,!0)).filter(()=>!1)),i=X.chain(this.disposables.add(new lt(this.view.domNode,"keyup")).event,o=>o.forEach(()=>t=!1).map(s=>new ut(s)).filter(s=>s.keyCode===58||s.shiftKey&&s.keyCode===68).map(s=>Ve.stop(s,!0)).map(({browserEvent:s})=>{let a=this.getFocus(),l=a.length?a[0]:void 0,d=typeof l<"u"?this.view.element(l):void 0,c=typeof l<"u"?this.view.domElement(l):this.view.domNode;return{index:l,element:d,anchor:c,browserEvent:s}})),n=X.chain(this.view.onContextMenu,o=>o.filter(s=>!t).map(({element:s,index:a,browserEvent:l})=>({element:s,index:a,anchor:new _i(ue(this.view.domNode),l),browserEvent:l})));return X.any(e,i,n)}get onKeyDown(){return this.disposables.add(new lt(this.view.domNode,"keydown")).event}get onKeyUp(){return this.disposables.add(new lt(this.view.domNode,"keyup")).event}get onKeyPress(){return this.disposables.add(new lt(this.view.domNode,"keypress")).event}get onDidFocus(){return X.signal(this.disposables.add(new lt(this.view.domNode,"focus",!0)).event)}get onDidBlur(){return X.signal(this.disposables.add(new lt(this.view.domNode,"blur",!0)).event)}_onDidDispose=new x;onDidDispose=this._onDidDispose.event;createListView(t,e,i,n){return new x1(t,e,i,n)}createMouseController(t){return new zk(this)}updateOptions(t={}){this._options={...this._options,...t},this.typeNavigationController?.updateOptions(this._options),this._options.multipleSelectionController!==void 0&&(this._options.multipleSelectionSupport?this.view.domNode.setAttribute("aria-multiselectable","true"):this.view.domNode.removeAttribute("aria-multiselectable")),this.mouseController.updateOptions(t),this.keyboardController?.updateOptions(t),this.view.updateOptions(t)}get options(){return this._options}splice(t,e,i=[]){if(t<0||t>this.view.length)throw new eh(this.user,`Invalid start index: ${t}`);if(e<0)throw new eh(this.user,`Invalid delete count: ${e}`);e===0&&i.length===0||this.eventBufferer.bufferEvents(()=>this.spliceable.splice(t,e,i))}updateWidth(t){this.view.updateWidth(t)}updateElementHeight(t,e){this.view.updateElementHeight(t,e,null)}rerender(){this.view.rerender()}element(t){return this.view.element(t)}indexOf(t){return this.view.indexOf(t)}indexAt(t){return this.view.indexAt(t)}get length(){return this.view.length}get contentHeight(){return this.view.contentHeight}get contentWidth(){return this.view.contentWidth}get onDidChangeContentHeight(){return this.view.onDidChangeContentHeight}get onDidChangeContentWidth(){return this.view.onDidChangeContentWidth}get scrollTop(){return this.view.getScrollTop()}set scrollTop(t){this.view.setScrollTop(t)}get scrollLeft(){return this.view.getScrollLeft()}set scrollLeft(t){this.view.setScrollLeft(t)}get scrollHeight(){return this.view.scrollHeight}get renderHeight(){return this.view.renderHeight}get firstVisibleIndex(){return this.view.firstVisibleIndex}get firstMostlyVisibleIndex(){return this.view.firstMostlyVisibleIndex}get lastVisibleIndex(){return this.view.lastVisibleIndex}get ariaLabel(){return this._ariaLabel}set ariaLabel(t){this._ariaLabel=t,this.view.domNode.setAttribute("aria-label",t)}domFocus(){this.view.domNode.focus({preventScroll:!0})}layout(t,e){this.view.layout(t,e)}triggerTypeNavigation(){this.typeNavigationController?.trigger()}setSelection(t,e){for(let i of t)if(i<0||i>=this.length)throw new eh(this.user,`Invalid index ${i}`);this.selection.set(t,e)}getSelection(){return this.selection.get()}getSelectedElements(){return this.getSelection().map(t=>this.view.element(t))}setAnchor(t){if(typeof t>"u"){this.anchor.set([]);return}if(t<0||t>=this.length)throw new eh(this.user,`Invalid index ${t}`);this.anchor.set([t])}getAnchor(){return this.anchor.get().at(0)}getAnchorElement(){let t=this.getAnchor();return typeof t>"u"?void 0:this.element(t)}setFocus(t,e){for(let i of t)if(i<0||i>=this.length)throw new eh(this.user,`Invalid index ${i}`);this.focus.set(t,e)}focusNext(t=1,e=!1,i,n){if(this.length===0)return;let o=this.focus.get(),s=this.findNextIndex(o.length>0?o[0]+t:0,e,n);s>-1&&this.setFocus([s],i)}focusPrevious(t=1,e=!1,i,n){if(this.length===0)return;let o=this.focus.get(),s=this.findPreviousIndex(o.length>0?o[0]-t:0,e,n);s>-1&&this.setFocus([s],i)}async focusNextPage(t,e){let i=this.view.indexAt(this.view.getScrollTop()+this.view.renderHeight);i=i===0?0:i-1;let n=this.getFocus()[0];if(n!==i&&(n===void 0||i>n)){let o=this.findPreviousIndex(i,!1,e);o>-1&&n!==o?this.setFocus([o],t):this.setFocus([i],t)}else{let o=this.view.getScrollTop(),s=o+this.view.renderHeight;i>n&&(s-=this.view.elementHeight(i)),this.view.setScrollTop(s),this.view.getScrollTop()!==o&&(this.setFocus([]),await To(0),await this.focusNextPage(t,e))}}async focusPreviousPage(t,e,i=()=>0){let n,o=i(),s=this.view.getScrollTop()+o;s===0?n=this.view.indexAt(s):n=this.view.indexAfter(s-1);let a=this.getFocus()[0];if(a!==n&&(a===void 0||a>=n)){let l=this.findNextIndex(n,!1,e);l>-1&&a!==l?this.setFocus([l],t):this.setFocus([n],t)}else{let l=s;this.view.setScrollTop(s-this.view.renderHeight-o),this.view.getScrollTop()+i()!==l&&(this.setFocus([]),await To(0),await this.focusPreviousPage(t,e,i))}}focusLast(t,e){if(this.length===0)return;let i=this.findPreviousIndex(this.length-1,!1,e);i>-1&&this.setFocus([i],t)}focusFirst(t,e){this.focusNth(0,t,e)}focusNth(t,e,i){if(this.length===0)return;let n=this.findNextIndex(t,!1,i);n>-1&&this.setFocus([n],e)}findNextIndex(t,e=!1,i){for(let n=0;n<this.length;n++){if(t>=this.length&&!e)return-1;if(t=t%this.length,!i||i(this.element(t)))return t;t++}return-1}findPreviousIndex(t,e=!1,i){for(let n=0;n<this.length;n++){if(t<0&&!e)return-1;if(t=(this.length+t%this.length)%this.length,!i||i(this.element(t)))return t;t--}return-1}getFocus(){return this.focus.get()}getFocusedElements(){return this.getFocus().map(t=>this.view.element(t))}reveal(t,e,i=0){if(t<0||t>=this.length)throw new eh(this.user,`Invalid index ${t}`);let n=this.view.getScrollTop(),o=this.view.elementTop(t),s=this.view.elementHeight(t);if(cr(e)){let a=s-this.view.renderHeight+i;this.view.setScrollTop(a*pn(e,0,1)+o-i)}else{let a=o+s,l=n+this.view.renderHeight;o<n+i&&a>=l||(o<n+i||a>=l&&s>=this.view.renderHeight?this.view.setScrollTop(o-i):a>=l&&this.view.setScrollTop(a-this.view.renderHeight))}}getRelativeTop(t,e=0){if(t<0||t>=this.length)throw new eh(this.user,`Invalid index ${t}`);let i=this.view.getScrollTop(),n=this.view.elementTop(t),o=this.view.elementHeight(t);if(n<i+e||n+o>i+this.view.renderHeight)return null;let s=o-this.view.renderHeight+e;return Math.abs((i+e-n)/s)}isDOMFocused(){return fs(this.view.domNode)}getHTMLElement(){return this.view.domNode}getScrollableElement(){return this.view.scrollableElementDomNode}getElementID(t){return this.view.getElementDomId(t)}getElementTop(t){return this.view.elementTop(t)}style(t){this.styleController.style(t)}toListEvent({indexes:t,browserEvent:e}){return{indexes:t,elements:t.map(i=>this.view.element(i)),browserEvent:e}}_onFocusChange(){let t=this.focus.get();this.view.domNode.classList.toggle("element-focused",t.length>0),this.onDidChangeActiveDescendant()}onDidChangeActiveDescendant(){let t=this.focus.get();if(t.length>0){let e;this.accessibilityProvider?.getActiveDescendantId&&(e=this.accessibilityProvider.getActiveDescendantId(this.view.element(t[0]))),this.view.domNode.setAttribute("aria-activedescendant",e||this.view.getElementDomId(t[0]))}else this.view.domNode.removeAttribute("aria-activedescendant")}_onSelectionChange(){let t=this.selection.get();this.view.domNode.classList.toggle("selection-none",t.length===0),this.view.domNode.classList.toggle("selection-single",t.length===1),this.view.domNode.classList.toggle("selection-multiple",t.length>1)}dispose(){this._onDidDispose.fire(),this.disposables.dispose(),this._onDidDispose.dispose()}};E([Re],ho.prototype,"onDidChangeFocus",1),E([Re],ho.prototype,"onDidChangeSelection",1),E([Re],ho.prototype,"onContextMenu",1),E([Re],ho.prototype,"onKeyDown",1),E([Re],ho.prototype,"onKeyUp",1),E([Re],ho.prototype,"onKeyPress",1),E([Re],ho.prototype,"onDidFocus",1),E([Re],ho.prototype,"onDidBlur",1);var CSe=new RegExp(`(\\\\)?\\$\\((${de.iconNameExpression}(?:${de.iconModifierExpression})?)\\)`,"g");function zl(r){let t=new Array,e,i=0,n=0;for(;(e=CSe.exec(r))!==null;){n=e.index||0,i<n&&t.push(r.substring(i,n)),i=(e.index||0)+e[0].length;let[,o,s]=e;t.push(o?`$(${s})`:Eu({id:s}))}return i<r.length&&t.push(r.substring(i)),t}function Eu(r){let t=J("span");return t.classList.add(...de.asClassNameArray(r)),t}var Gk=class{_prefix;_lastId;constructor(t){this._prefix=t,this._lastId=0}nextId(){return this._prefix+ ++this._lastId}},qk=new Gk("id#");var ws={};(function(){function r(t,e){e(ws)}r.amd=!0,function(t,e){typeof r=="function"&&r.amd?r(["exports"],e):typeof exports=="object"&&typeof module<"u"?e(exports):(t=typeof globalThis<"u"?globalThis:t||self,e(t.marked={}))}(this,function(t){"use strict";function e(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}t.defaults=e();function i(Wt){t.defaults=Wt}let n=/[&<>"']/,o=new RegExp(n.source,"g"),s=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,a=new RegExp(s.source,"g"),l={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},d=Wt=>l[Wt];function c(Wt,W){if(W){if(n.test(Wt))return Wt.replace(o,d)}else if(s.test(Wt))return Wt.replace(a,d);return Wt}let p=/(^|[^\[])\^/g;function h(Wt,W){let z=typeof Wt=="string"?Wt:Wt.source;W=W||"";let $={replace:(te,oe)=>{let ve=typeof oe=="string"?oe:oe.source;return ve=ve.replace(p,"$1"),z=z.replace(te,ve),$},getRegex:()=>new RegExp(z,W)};return $}function m(Wt){try{Wt=encodeURI(Wt).replace(/%25/g,"%")}catch{return null}return Wt}let f={exec:()=>null};function g(Wt,W){let z=Wt.replace(/\|/g,(oe,ve,Te)=>{let ot=!1,pt=ve;for(;--pt>=0&&Te[pt]==="\\";)ot=!ot;return ot?"|":" |"}),$=z.split(/ \|/),te=0;if($[0].trim()||$.shift(),$.length>0&&!$[$.length-1].trim()&&$.pop(),W)if($.length>W)$.splice(W);else for(;$.length<W;)$.push("");for(;te<$.length;te++)$[te]=$[te].trim().replace(/\\\|/g,"|");return $}function v(Wt,W,z){let $=Wt.length;if($===0)return"";let te=0;for(;te<$;){let oe=Wt.charAt($-te-1);if(oe===W&&!z)te++;else if(oe!==W&&z)te++;else break}return Wt.slice(0,$-te)}function I(Wt,W){if(Wt.indexOf(W[1])===-1)return-1;let z=0;for(let $=0;$<Wt.length;$++)if(Wt[$]==="\\")$++;else if(Wt[$]===W[0])z++;else if(Wt[$]===W[1]&&(z--,z<0))return $;return-1}function y(Wt,W,z,$){let te=W.href,oe=W.title?c(W.title):null,ve=Wt[1].replace(/\\([\[\]])/g,"$1");if(Wt[0].charAt(0)!=="!"){$.state.inLink=!0;let Te={type:"link",raw:z,href:te,title:oe,text:ve,tokens:$.inlineTokens(ve)};return $.state.inLink=!1,Te}return{type:"image",raw:z,href:te,title:oe,text:c(ve)}}function w(Wt,W){let z=Wt.match(/^(\s+)(?:```)/);if(z===null)return W;let $=z[1];return W.split(`
`).map(te=>{let oe=te.match(/^\s+/);if(oe===null)return te;let[ve]=oe;return ve.length>=$.length?te.slice($.length):te}).join(`
`)}class C{options;rules;lexer;constructor(W){this.options=W||t.defaults}space(W){let z=this.rules.block.newline.exec(W);if(z&&z[0].length>0)return{type:"space",raw:z[0]}}code(W){let z=this.rules.block.code.exec(W);if(z){let $=z[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:z[0],codeBlockStyle:"indented",text:this.options.pedantic?$:v($,`
`)}}}fences(W){let z=this.rules.block.fences.exec(W);if(z){let $=z[0],te=w($,z[3]||"");return{type:"code",raw:$,lang:z[2]?z[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):z[2],text:te}}}heading(W){let z=this.rules.block.heading.exec(W);if(z){let $=z[2].trim();if(/#$/.test($)){let te=v($,"#");(this.options.pedantic||!te||/ $/.test(te))&&($=te.trim())}return{type:"heading",raw:z[0],depth:z[1].length,text:$,tokens:this.lexer.inline($)}}}hr(W){let z=this.rules.block.hr.exec(W);if(z)return{type:"hr",raw:v(z[0],`
`)}}blockquote(W){let z=this.rules.block.blockquote.exec(W);if(z){let $=v(z[0],`
`).split(`
`),te="",oe="",ve=[];for(;$.length>0;){let Te=!1,ot=[],pt;for(pt=0;pt<$.length;pt++)if(/^ {0,3}>/.test($[pt]))ot.push($[pt]),Te=!0;else if(!Te)ot.push($[pt]);else break;$=$.slice(pt);let di=ot.join(`
`),Ui=di.replace(/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,`
    $1`).replace(/^ {0,3}>[ \t]?/gm,"");te=te?`${te}
${di}`:di,oe=oe?`${oe}
${Ui}`:Ui;let Gn=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(Ui,ve,!0),this.lexer.state.top=Gn,$.length===0)break;let sr=ve[ve.length-1];if(sr?.type==="code")break;if(sr?.type==="blockquote"){let lo=sr,Dt=lo.raw+`
`+$.join(`
`),ae=this.blockquote(Dt);ve[ve.length-1]=ae,te=te.substring(0,te.length-lo.raw.length)+ae.raw,oe=oe.substring(0,oe.length-lo.text.length)+ae.text;break}else if(sr?.type==="list"){let lo=sr,Dt=lo.raw+`
`+$.join(`
`),ae=this.list(Dt);ve[ve.length-1]=ae,te=te.substring(0,te.length-sr.raw.length)+ae.raw,oe=oe.substring(0,oe.length-lo.raw.length)+ae.raw,$=Dt.substring(ve[ve.length-1].raw.length).split(`
`);continue}}return{type:"blockquote",raw:te,tokens:ve,text:oe}}}list(W){let z=this.rules.block.list.exec(W);if(z){let $=z[1].trim(),te=$.length>1,oe={type:"list",raw:"",ordered:te,start:te?+$.slice(0,-1):"",loose:!1,items:[]};$=te?`\\d{1,9}\\${$.slice(-1)}`:`\\${$}`,this.options.pedantic&&($=te?$:"[*+-]");let ve=new RegExp(`^( {0,3}${$})((?:[	 ][^\\n]*)?(?:\\n|$))`),Te=!1;for(;W;){let ot=!1,pt="",di="";if(!(z=ve.exec(W))||this.rules.block.hr.test(W))break;pt=z[0],W=W.substring(pt.length);let Ui=z[2].split(`
`,1)[0].replace(/^\t+/,je=>" ".repeat(3*je.length)),Gn=W.split(`
`,1)[0],sr=!Ui.trim(),lo=0;if(this.options.pedantic?(lo=2,di=Ui.trimStart()):sr?lo=z[1].length+1:(lo=z[2].search(/[^ ]/),lo=lo>4?1:lo,di=Ui.slice(lo),lo+=z[1].length),sr&&/^ *$/.test(Gn)&&(pt+=Gn+`
`,W=W.substring(Gn.length+1),ot=!0),!ot){let je=new RegExp(`^ {0,${Math.min(3,lo-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),It=new RegExp(`^ {0,${Math.min(3,lo-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),Ln=new RegExp(`^ {0,${Math.min(3,lo-1)}}(?:\`\`\`|~~~)`),Ir=new RegExp(`^ {0,${Math.min(3,lo-1)}}#`);for(;W;){let fa=W.split(`
`,1)[0];if(Gn=fa,this.options.pedantic&&(Gn=Gn.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),Ln.test(Gn)||Ir.test(Gn)||je.test(Gn)||It.test(W))break;if(Gn.search(/[^ ]/)>=lo||!Gn.trim())di+=`
`+Gn.slice(lo);else{if(sr||Ui.search(/[^ ]/)>=4||Ln.test(Ui)||Ir.test(Ui)||It.test(Ui))break;di+=`
`+Gn}!sr&&!Gn.trim()&&(sr=!0),pt+=fa+`
`,W=W.substring(fa.length+1),Ui=Gn.slice(lo)}}oe.loose||(Te?oe.loose=!0:/\n *\n *$/.test(pt)&&(Te=!0));let Dt=null,ae;this.options.gfm&&(Dt=/^\[[ xX]\] /.exec(di),Dt&&(ae=Dt[0]!=="[ ] ",di=di.replace(/^\[[ xX]\] +/,""))),oe.items.push({type:"list_item",raw:pt,task:!!Dt,checked:ae,loose:!1,text:di,tokens:[]}),oe.raw+=pt}oe.items[oe.items.length-1].raw=oe.items[oe.items.length-1].raw.trimEnd(),oe.items[oe.items.length-1].text=oe.items[oe.items.length-1].text.trimEnd(),oe.raw=oe.raw.trimEnd();for(let ot=0;ot<oe.items.length;ot++)if(this.lexer.state.top=!1,oe.items[ot].tokens=this.lexer.blockTokens(oe.items[ot].text,[]),!oe.loose){let pt=oe.items[ot].tokens.filter(Ui=>Ui.type==="space"),di=pt.length>0&&pt.some(Ui=>/\n.*\n/.test(Ui.raw));oe.loose=di}if(oe.loose)for(let ot=0;ot<oe.items.length;ot++)oe.items[ot].loose=!0;return oe}}html(W){let z=this.rules.block.html.exec(W);if(z)return{type:"html",block:!0,raw:z[0],pre:z[1]==="pre"||z[1]==="script"||z[1]==="style",text:z[0]}}def(W){let z=this.rules.block.def.exec(W);if(z){let $=z[1].toLowerCase().replace(/\s+/g," "),te=z[2]?z[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",oe=z[3]?z[3].substring(1,z[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):z[3];return{type:"def",tag:$,raw:z[0],href:te,title:oe}}}table(W){let z=this.rules.block.table.exec(W);if(!z||!/[:|]/.test(z[2]))return;let $=g(z[1]),te=z[2].replace(/^\||\| *$/g,"").split("|"),oe=z[3]&&z[3].trim()?z[3].replace(/\n[ \t]*$/,"").split(`
`):[],ve={type:"table",raw:z[0],header:[],align:[],rows:[]};if($.length===te.length){for(let Te of te)/^ *-+: *$/.test(Te)?ve.align.push("right"):/^ *:-+: *$/.test(Te)?ve.align.push("center"):/^ *:-+ *$/.test(Te)?ve.align.push("left"):ve.align.push(null);for(let Te=0;Te<$.length;Te++)ve.header.push({text:$[Te],tokens:this.lexer.inline($[Te]),header:!0,align:ve.align[Te]});for(let Te of oe)ve.rows.push(g(Te,ve.header.length).map((ot,pt)=>({text:ot,tokens:this.lexer.inline(ot),header:!1,align:ve.align[pt]})));return ve}}lheading(W){let z=this.rules.block.lheading.exec(W);if(z)return{type:"heading",raw:z[0],depth:z[2].charAt(0)==="="?1:2,text:z[1],tokens:this.lexer.inline(z[1])}}paragraph(W){let z=this.rules.block.paragraph.exec(W);if(z){let $=z[1].charAt(z[1].length-1)===`
`?z[1].slice(0,-1):z[1];return{type:"paragraph",raw:z[0],text:$,tokens:this.lexer.inline($)}}}text(W){let z=this.rules.block.text.exec(W);if(z)return{type:"text",raw:z[0],text:z[0],tokens:this.lexer.inline(z[0])}}escape(W){let z=this.rules.inline.escape.exec(W);if(z)return{type:"escape",raw:z[0],text:c(z[1])}}tag(W){let z=this.rules.inline.tag.exec(W);if(z)return!this.lexer.state.inLink&&/^<a /i.test(z[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(z[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(z[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(z[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:z[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:z[0]}}link(W){let z=this.rules.inline.link.exec(W);if(z){let $=z[2].trim();if(!this.options.pedantic&&/^</.test($)){if(!/>$/.test($))return;let ve=v($.slice(0,-1),"\\");if(($.length-ve.length)%2===0)return}else{let ve=I(z[2],"()");if(ve>-1){let ot=(z[0].indexOf("!")===0?5:4)+z[1].length+ve;z[2]=z[2].substring(0,ve),z[0]=z[0].substring(0,ot).trim(),z[3]=""}}let te=z[2],oe="";if(this.options.pedantic){let ve=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(te);ve&&(te=ve[1],oe=ve[3])}else oe=z[3]?z[3].slice(1,-1):"";return te=te.trim(),/^</.test(te)&&(this.options.pedantic&&!/>$/.test($)?te=te.slice(1):te=te.slice(1,-1)),y(z,{href:te&&te.replace(this.rules.inline.anyPunctuation,"$1"),title:oe&&oe.replace(this.rules.inline.anyPunctuation,"$1")},z[0],this.lexer)}}reflink(W,z){let $;if(($=this.rules.inline.reflink.exec(W))||($=this.rules.inline.nolink.exec(W))){let te=($[2]||$[1]).replace(/\s+/g," "),oe=z[te.toLowerCase()];if(!oe){let ve=$[0].charAt(0);return{type:"text",raw:ve,text:ve}}return y($,oe,$[0],this.lexer)}}emStrong(W,z,$=""){let te=this.rules.inline.emStrongLDelim.exec(W);if(!te||te[3]&&$.match(/[\p{L}\p{N}]/u))return;if(!(te[1]||te[2]||"")||!$||this.rules.inline.punctuation.exec($)){let ve=[...te[0]].length-1,Te,ot,pt=ve,di=0,Ui=te[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(Ui.lastIndex=0,z=z.slice(-1*W.length+ve);(te=Ui.exec(z))!=null;){if(Te=te[1]||te[2]||te[3]||te[4]||te[5]||te[6],!Te)continue;if(ot=[...Te].length,te[3]||te[4]){pt+=ot;continue}else if((te[5]||te[6])&&ve%3&&!((ve+ot)%3)){di+=ot;continue}if(pt-=ot,pt>0)continue;ot=Math.min(ot,ot+pt+di);let Gn=[...te[0]][0].length,sr=W.slice(0,ve+te.index+Gn+ot);if(Math.min(ve,ot)%2){let Dt=sr.slice(1,-1);return{type:"em",raw:sr,text:Dt,tokens:this.lexer.inlineTokens(Dt)}}let lo=sr.slice(2,-2);return{type:"strong",raw:sr,text:lo,tokens:this.lexer.inlineTokens(lo)}}}}codespan(W){let z=this.rules.inline.code.exec(W);if(z){let $=z[2].replace(/\n/g," "),te=/[^ ]/.test($),oe=/^ /.test($)&&/ $/.test($);return te&&oe&&($=$.substring(1,$.length-1)),$=c($,!0),{type:"codespan",raw:z[0],text:$}}}br(W){let z=this.rules.inline.br.exec(W);if(z)return{type:"br",raw:z[0]}}del(W){let z=this.rules.inline.del.exec(W);if(z)return{type:"del",raw:z[0],text:z[2],tokens:this.lexer.inlineTokens(z[2])}}autolink(W){let z=this.rules.inline.autolink.exec(W);if(z){let $,te;return z[2]==="@"?($=c(z[1]),te="mailto:"+$):($=c(z[1]),te=$),{type:"link",raw:z[0],text:$,href:te,tokens:[{type:"text",raw:$,text:$}]}}}url(W){let z;if(z=this.rules.inline.url.exec(W)){let $,te;if(z[2]==="@")$=c(z[0]),te="mailto:"+$;else{let oe;do oe=z[0],z[0]=this.rules.inline._backpedal.exec(z[0])?.[0]??"";while(oe!==z[0]);$=c(z[0]),z[1]==="www."?te="http://"+z[0]:te=z[0]}return{type:"link",raw:z[0],text:$,href:te,tokens:[{type:"text",raw:$,text:$}]}}}inlineText(W){let z=this.rules.inline.text.exec(W);if(z){let $;return this.lexer.state.inRawBlock?$=z[0]:$=c(z[0]),{type:"text",raw:z[0],text:$}}}}let S=/^(?: *(?:\n|$))+/,D=/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,k=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,M=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,O=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,K=/(?:[*+-]|\d{1,9}[.)])/,G=h(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,K).replace(/blockCode/g,/ {4}/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),Y=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,ge=/^[^\n]+/,xe=/(?!\s*\])(?:\\.|[^\[\]\\])+/,be=h(/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/).replace("label",xe).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),fe=h(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,K).getRegex(),Le="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Ee=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,Ce=h("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))","i").replace("comment",Ee).replace("tag",Le).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Je=h(Y).replace("hr",M).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Le).getRegex(),qt={blockquote:h(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Je).getRegex(),code:D,def:be,fences:k,heading:O,hr:M,html:Ce,lheading:G,list:fe,newline:S,paragraph:Je,table:f,text:ge},Mt=h("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",M).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Le).getRegex(),at={...qt,table:Mt,paragraph:h(Y).replace("hr",M).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Mt).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Le).getRegex()},On={...qt,html:h(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Ee).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:f,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:h(Y).replace("hr",M).replace("heading",` *#{1,6} *[^
]`).replace("lheading",G).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},Nn=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,Ro=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,or=/^( {2,}|\\)\n(?!\s*$)/,sd=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,Qi="\\p{P}\\p{S}",Br=h(/^((?![*_])[\spunctuation])/,"u").replace(/punctuation/g,Qi).getRegex(),im=/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g,dp=h(/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,"u").replace(/punct/g,Qi).getRegex(),Vr=h("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)[punct](\\*+)(?=[\\s]|$)|[^punct\\s](\\*+)(?!\\*)(?=[punct\\s]|$)|(?!\\*)[punct\\s](\\*+)(?=[^punct\\s])|[\\s](\\*+)(?!\\*)(?=[punct])|(?!\\*)[punct](\\*+)(?!\\*)(?=[punct])|[^punct\\s](\\*+)(?=[^punct\\s])","gu").replace(/punct/g,Qi).getRegex(),Bc=h("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\\s]|$)|[^punct\\s](_+)(?!_)(?=[punct\\s]|$)|(?!_)[punct\\s](_+)(?=[^punct\\s])|[\\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])","gu").replace(/punct/g,Qi).getRegex(),Vc=h(/\\([punct])/,"gu").replace(/punct/g,Qi).getRegex(),nm=h(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),om=h(Ee).replace("(?:-->|$)","-->").getRegex(),Rt=h("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",om).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),nc=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,Wc=h(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",nc).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),ad=h(/^!?\[(label)\]\[(ref)\]/).replace("label",nc).replace("ref",xe).getRegex(),Ka=h(/^!?\[(ref)\](?:\[\])?/).replace("ref",xe).getRegex(),Bg=h("reflink|nolink(?!\\()","g").replace("reflink",ad).replace("nolink",Ka).getRegex(),Mv={_backpedal:f,anyPunctuation:Vc,autolink:nm,blockSkip:im,br:or,code:Ro,del:f,emStrongLDelim:dp,emStrongRDelimAst:Vr,emStrongRDelimUnd:Bc,escape:Nn,link:Wc,nolink:Ka,punctuation:Br,reflink:ad,reflinkSearch:Bg,tag:Rt,text:sd,url:f},m_={...Mv,link:h(/^!?\[(label)\]\((.*?)\)/).replace("label",nc).getRegex(),reflink:h(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",nc).getRegex()},cp={...Mv,escape:h(Nn).replace("])","~|])").getRegex(),url:h(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},g_={...cp,br:h(or).replace("{2,}","*").getRegex(),text:h(cp.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},up={normal:qt,gfm:at,pedantic:On},ld={normal:Mv,gfm:cp,breaks:g_,pedantic:m_};class rr{tokens;options;state;tokenizer;inlineQueue;constructor(W){this.tokens=[],this.tokens.links=Object.create(null),this.options=W||t.defaults,this.options.tokenizer=this.options.tokenizer||new C,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let z={block:up.normal,inline:ld.normal};this.options.pedantic?(z.block=up.pedantic,z.inline=ld.pedantic):this.options.gfm&&(z.block=up.gfm,this.options.breaks?z.inline=ld.breaks:z.inline=ld.gfm),this.tokenizer.rules=z}static get rules(){return{block:up,inline:ld}}static lex(W,z){return new rr(z).lex(W)}static lexInline(W,z){return new rr(z).inlineTokens(W)}lex(W){W=W.replace(/\r\n|\r/g,`
`),this.blockTokens(W,this.tokens);for(let z=0;z<this.inlineQueue.length;z++){let $=this.inlineQueue[z];this.inlineTokens($.src,$.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(W,z=[],$=!1){this.options.pedantic?W=W.replace(/\t/g,"    ").replace(/^ +$/gm,""):W=W.replace(/^( *)(\t+)/gm,(Te,ot,pt)=>ot+"    ".repeat(pt.length));let te,oe,ve;for(;W;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(Te=>(te=Te.call({lexer:this},W,z))?(W=W.substring(te.raw.length),z.push(te),!0):!1))){if(te=this.tokenizer.space(W)){W=W.substring(te.raw.length),te.raw.length===1&&z.length>0?z[z.length-1].raw+=`
`:z.push(te);continue}if(te=this.tokenizer.code(W)){W=W.substring(te.raw.length),oe=z[z.length-1],oe&&(oe.type==="paragraph"||oe.type==="text")?(oe.raw+=`
`+te.raw,oe.text+=`
`+te.text,this.inlineQueue[this.inlineQueue.length-1].src=oe.text):z.push(te);continue}if(te=this.tokenizer.fences(W)){W=W.substring(te.raw.length),z.push(te);continue}if(te=this.tokenizer.heading(W)){W=W.substring(te.raw.length),z.push(te);continue}if(te=this.tokenizer.hr(W)){W=W.substring(te.raw.length),z.push(te);continue}if(te=this.tokenizer.blockquote(W)){W=W.substring(te.raw.length),z.push(te);continue}if(te=this.tokenizer.list(W)){W=W.substring(te.raw.length),z.push(te);continue}if(te=this.tokenizer.html(W)){W=W.substring(te.raw.length),z.push(te);continue}if(te=this.tokenizer.def(W)){W=W.substring(te.raw.length),oe=z[z.length-1],oe&&(oe.type==="paragraph"||oe.type==="text")?(oe.raw+=`
`+te.raw,oe.text+=`
`+te.raw,this.inlineQueue[this.inlineQueue.length-1].src=oe.text):this.tokens.links[te.tag]||(this.tokens.links[te.tag]={href:te.href,title:te.title});continue}if(te=this.tokenizer.table(W)){W=W.substring(te.raw.length),z.push(te);continue}if(te=this.tokenizer.lheading(W)){W=W.substring(te.raw.length),z.push(te);continue}if(ve=W,this.options.extensions&&this.options.extensions.startBlock){let Te=1/0,ot=W.slice(1),pt;this.options.extensions.startBlock.forEach(di=>{pt=di.call({lexer:this},ot),typeof pt=="number"&&pt>=0&&(Te=Math.min(Te,pt))}),Te<1/0&&Te>=0&&(ve=W.substring(0,Te+1))}if(this.state.top&&(te=this.tokenizer.paragraph(ve))){oe=z[z.length-1],$&&oe?.type==="paragraph"?(oe.raw+=`
`+te.raw,oe.text+=`
`+te.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=oe.text):z.push(te),$=ve.length!==W.length,W=W.substring(te.raw.length);continue}if(te=this.tokenizer.text(W)){W=W.substring(te.raw.length),oe=z[z.length-1],oe&&oe.type==="text"?(oe.raw+=`
`+te.raw,oe.text+=`
`+te.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=oe.text):z.push(te);continue}if(W){let Te="Infinite loop on byte: "+W.charCodeAt(0);if(this.options.silent){console.error(Te);break}else throw new Error(Te)}}return this.state.top=!0,z}inline(W,z=[]){return this.inlineQueue.push({src:W,tokens:z}),z}inlineTokens(W,z=[]){let $,te,oe,ve=W,Te,ot,pt;if(this.tokens.links){let di=Object.keys(this.tokens.links);if(di.length>0)for(;(Te=this.tokenizer.rules.inline.reflinkSearch.exec(ve))!=null;)di.includes(Te[0].slice(Te[0].lastIndexOf("[")+1,-1))&&(ve=ve.slice(0,Te.index)+"["+"a".repeat(Te[0].length-2)+"]"+ve.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(Te=this.tokenizer.rules.inline.blockSkip.exec(ve))!=null;)ve=ve.slice(0,Te.index)+"["+"a".repeat(Te[0].length-2)+"]"+ve.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(Te=this.tokenizer.rules.inline.anyPunctuation.exec(ve))!=null;)ve=ve.slice(0,Te.index)+"++"+ve.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;W;)if(ot||(pt=""),ot=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(di=>($=di.call({lexer:this},W,z))?(W=W.substring($.raw.length),z.push($),!0):!1))){if($=this.tokenizer.escape(W)){W=W.substring($.raw.length),z.push($);continue}if($=this.tokenizer.tag(W)){W=W.substring($.raw.length),te=z[z.length-1],te&&$.type==="text"&&te.type==="text"?(te.raw+=$.raw,te.text+=$.text):z.push($);continue}if($=this.tokenizer.link(W)){W=W.substring($.raw.length),z.push($);continue}if($=this.tokenizer.reflink(W,this.tokens.links)){W=W.substring($.raw.length),te=z[z.length-1],te&&$.type==="text"&&te.type==="text"?(te.raw+=$.raw,te.text+=$.text):z.push($);continue}if($=this.tokenizer.emStrong(W,ve,pt)){W=W.substring($.raw.length),z.push($);continue}if($=this.tokenizer.codespan(W)){W=W.substring($.raw.length),z.push($);continue}if($=this.tokenizer.br(W)){W=W.substring($.raw.length),z.push($);continue}if($=this.tokenizer.del(W)){W=W.substring($.raw.length),z.push($);continue}if($=this.tokenizer.autolink(W)){W=W.substring($.raw.length),z.push($);continue}if(!this.state.inLink&&($=this.tokenizer.url(W))){W=W.substring($.raw.length),z.push($);continue}if(oe=W,this.options.extensions&&this.options.extensions.startInline){let di=1/0,Ui=W.slice(1),Gn;this.options.extensions.startInline.forEach(sr=>{Gn=sr.call({lexer:this},Ui),typeof Gn=="number"&&Gn>=0&&(di=Math.min(di,Gn))}),di<1/0&&di>=0&&(oe=W.substring(0,di+1))}if($=this.tokenizer.inlineText(oe)){W=W.substring($.raw.length),$.raw.slice(-1)!=="_"&&(pt=$.raw.slice(-1)),ot=!0,te=z[z.length-1],te&&te.type==="text"?(te.raw+=$.raw,te.text+=$.text):z.push($);continue}if(W){let di="Infinite loop on byte: "+W.charCodeAt(0);if(this.options.silent){console.error(di);break}else throw new Error(di)}}return z}}class dd{options;parser;constructor(W){this.options=W||t.defaults}space(W){return""}code({text:W,lang:z,escaped:$}){let te=(z||"").match(/^\S*/)?.[0],oe=W.replace(/\n$/,"")+`
`;return te?'<pre><code class="language-'+c(te)+'">'+($?oe:c(oe,!0))+`</code></pre>
`:"<pre><code>"+($?oe:c(oe,!0))+`</code></pre>
`}blockquote({tokens:W}){return`<blockquote>
${this.parser.parse(W)}</blockquote>
`}html({text:W}){return W}heading({tokens:W,depth:z}){return`<h${z}>${this.parser.parseInline(W)}</h${z}>
`}hr(W){return`<hr>
`}list(W){let z=W.ordered,$=W.start,te="";for(let Te=0;Te<W.items.length;Te++){let ot=W.items[Te];te+=this.listitem(ot)}let oe=z?"ol":"ul",ve=z&&$!==1?' start="'+$+'"':"";return"<"+oe+ve+`>
`+te+"</"+oe+`>
`}listitem(W){let z="";if(W.task){let $=this.checkbox({checked:!!W.checked});W.loose?W.tokens.length>0&&W.tokens[0].type==="paragraph"?(W.tokens[0].text=$+" "+W.tokens[0].text,W.tokens[0].tokens&&W.tokens[0].tokens.length>0&&W.tokens[0].tokens[0].type==="text"&&(W.tokens[0].tokens[0].text=$+" "+W.tokens[0].tokens[0].text)):W.tokens.unshift({type:"text",raw:$+" ",text:$+" "}):z+=$+" "}return z+=this.parser.parse(W.tokens,!!W.loose),`<li>${z}</li>
`}checkbox({checked:W}){return"<input "+(W?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:W}){return`<p>${this.parser.parseInline(W)}</p>
`}table(W){let z="",$="";for(let oe=0;oe<W.header.length;oe++)$+=this.tablecell(W.header[oe]);z+=this.tablerow({text:$});let te="";for(let oe=0;oe<W.rows.length;oe++){let ve=W.rows[oe];$="";for(let Te=0;Te<ve.length;Te++)$+=this.tablecell(ve[Te]);te+=this.tablerow({text:$})}return te&&(te=`<tbody>${te}</tbody>`),`<table>
<thead>
`+z+`</thead>
`+te+`</table>
`}tablerow({text:W}){return`<tr>
${W}</tr>
`}tablecell(W){let z=this.parser.parseInline(W.tokens),$=W.header?"th":"td";return(W.align?`<${$} align="${W.align}">`:`<${$}>`)+z+`</${$}>
`}strong({tokens:W}){return`<strong>${this.parser.parseInline(W)}</strong>`}em({tokens:W}){return`<em>${this.parser.parseInline(W)}</em>`}codespan({text:W}){return`<code>${W}</code>`}br(W){return"<br>"}del({tokens:W}){return`<del>${this.parser.parseInline(W)}</del>`}link({href:W,title:z,tokens:$}){let te=this.parser.parseInline($),oe=m(W);if(oe===null)return te;W=oe;let ve='<a href="'+W+'"';return z&&(ve+=' title="'+z+'"'),ve+=">"+te+"</a>",ve}image({href:W,title:z,text:$}){let te=m(W);if(te===null)return $;W=te;let oe=`<img src="${W}" alt="${$}"`;return z&&(oe+=` title="${z}"`),oe+=">",oe}text(W){return"tokens"in W&&W.tokens?this.parser.parseInline(W.tokens):W.text}}class rm{strong({text:W}){return W}em({text:W}){return W}codespan({text:W}){return W}del({text:W}){return W}html({text:W}){return W}text({text:W}){return W}link({text:W}){return""+W}image({text:W}){return""+W}br(){return""}}class ga{options;renderer;textRenderer;constructor(W){this.options=W||t.defaults,this.options.renderer=this.options.renderer||new dd,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new rm}static parse(W,z){return new ga(z).parse(W)}static parseInline(W,z){return new ga(z).parseInline(W)}parse(W,z=!0){let $="";for(let te=0;te<W.length;te++){let oe=W[te];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[oe.type]){let Te=oe,ot=this.options.extensions.renderers[Te.type].call({parser:this},Te);if(ot!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(Te.type)){$+=ot||"";continue}}let ve=oe;switch(ve.type){case"space":{$+=this.renderer.space(ve);continue}case"hr":{$+=this.renderer.hr(ve);continue}case"heading":{$+=this.renderer.heading(ve);continue}case"code":{$+=this.renderer.code(ve);continue}case"table":{$+=this.renderer.table(ve);continue}case"blockquote":{$+=this.renderer.blockquote(ve);continue}case"list":{$+=this.renderer.list(ve);continue}case"html":{$+=this.renderer.html(ve);continue}case"paragraph":{$+=this.renderer.paragraph(ve);continue}case"text":{let Te=ve,ot=this.renderer.text(Te);for(;te+1<W.length&&W[te+1].type==="text";)Te=W[++te],ot+=`
`+this.renderer.text(Te);z?$+=this.renderer.paragraph({type:"paragraph",raw:ot,text:ot,tokens:[{type:"text",raw:ot,text:ot}]}):$+=ot;continue}default:{let Te='Token with "'+ve.type+'" type was not found.';if(this.options.silent)return console.error(Te),"";throw new Error(Te)}}}return $}parseInline(W,z){z=z||this.renderer;let $="";for(let te=0;te<W.length;te++){let oe=W[te];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[oe.type]){let Te=this.options.extensions.renderers[oe.type].call({parser:this},oe);if(Te!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(oe.type)){$+=Te||"";continue}}let ve=oe;switch(ve.type){case"escape":{$+=z.text(ve);break}case"html":{$+=z.html(ve);break}case"link":{$+=z.link(ve);break}case"image":{$+=z.image(ve);break}case"strong":{$+=z.strong(ve);break}case"em":{$+=z.em(ve);break}case"codespan":{$+=z.codespan(ve);break}case"br":{$+=z.br(ve);break}case"del":{$+=z.del(ve);break}case"text":{$+=z.text(ve);break}default:{let Te='Token with "'+ve.type+'" type was not found.';if(this.options.silent)return console.error(Te),"";throw new Error(Te)}}}return $}}class Vg{options;constructor(W){this.options=W||t.defaults}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(W){return W}postprocess(W){return W}processAllTokens(W){return W}}class Hc{defaults=e();options=this.setOptions;parse=this.parseMarkdown(rr.lex,ga.parse);parseInline=this.parseMarkdown(rr.lexInline,ga.parseInline);Parser=ga;Renderer=dd;TextRenderer=rm;Lexer=rr;Tokenizer=C;Hooks=Vg;constructor(...W){this.use(...W)}walkTokens(W,z){let $=[];for(let te of W)switch($=$.concat(z.call(this,te)),te.type){case"table":{let oe=te;for(let ve of oe.header)$=$.concat(this.walkTokens(ve.tokens,z));for(let ve of oe.rows)for(let Te of ve)$=$.concat(this.walkTokens(Te.tokens,z));break}case"list":{let oe=te;$=$.concat(this.walkTokens(oe.items,z));break}default:{let oe=te;this.defaults.extensions?.childTokens?.[oe.type]?this.defaults.extensions.childTokens[oe.type].forEach(ve=>{let Te=oe[ve].flat(1/0);$=$.concat(this.walkTokens(Te,z))}):oe.tokens&&($=$.concat(this.walkTokens(oe.tokens,z)))}}return $}use(...W){let z=this.defaults.extensions||{renderers:{},childTokens:{}};return W.forEach($=>{let te={...$};if(te.async=this.defaults.async||te.async||!1,$.extensions&&($.extensions.forEach(oe=>{if(!oe.name)throw new Error("extension name required");if("renderer"in oe){let ve=z.renderers[oe.name];ve?z.renderers[oe.name]=function(...Te){let ot=oe.renderer.apply(this,Te);return ot===!1&&(ot=ve.apply(this,Te)),ot}:z.renderers[oe.name]=oe.renderer}if("tokenizer"in oe){if(!oe.level||oe.level!=="block"&&oe.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let ve=z[oe.level];ve?ve.unshift(oe.tokenizer):z[oe.level]=[oe.tokenizer],oe.start&&(oe.level==="block"?z.startBlock?z.startBlock.push(oe.start):z.startBlock=[oe.start]:oe.level==="inline"&&(z.startInline?z.startInline.push(oe.start):z.startInline=[oe.start]))}"childTokens"in oe&&oe.childTokens&&(z.childTokens[oe.name]=oe.childTokens)}),te.extensions=z),$.renderer){let oe=this.defaults.renderer||new dd(this.defaults);for(let ve in $.renderer){if(!(ve in oe))throw new Error(`renderer '${ve}' does not exist`);if(["options","parser"].includes(ve))continue;let Te=ve,ot=$.renderer[Te],pt=oe[Te];oe[Te]=(...di)=>{let Ui=ot.apply(oe,di);return Ui===!1&&(Ui=pt.apply(oe,di)),Ui||""}}te.renderer=oe}if($.tokenizer){let oe=this.defaults.tokenizer||new C(this.defaults);for(let ve in $.tokenizer){if(!(ve in oe))throw new Error(`tokenizer '${ve}' does not exist`);if(["options","rules","lexer"].includes(ve))continue;let Te=ve,ot=$.tokenizer[Te],pt=oe[Te];oe[Te]=(...di)=>{let Ui=ot.apply(oe,di);return Ui===!1&&(Ui=pt.apply(oe,di)),Ui}}te.tokenizer=oe}if($.hooks){let oe=this.defaults.hooks||new Vg;for(let ve in $.hooks){if(!(ve in oe))throw new Error(`hook '${ve}' does not exist`);if(ve==="options")continue;let Te=ve,ot=$.hooks[Te],pt=oe[Te];Vg.passThroughHooks.has(ve)?oe[Te]=di=>{if(this.defaults.async)return Promise.resolve(ot.call(oe,di)).then(Gn=>pt.call(oe,Gn));let Ui=ot.call(oe,di);return pt.call(oe,Ui)}:oe[Te]=(...di)=>{let Ui=ot.apply(oe,di);return Ui===!1&&(Ui=pt.apply(oe,di)),Ui}}te.hooks=oe}if($.walkTokens){let oe=this.defaults.walkTokens,ve=$.walkTokens;te.walkTokens=function(Te){let ot=[];return ot.push(ve.call(this,Te)),oe&&(ot=ot.concat(oe.call(this,Te))),ot}}this.defaults={...this.defaults,...te}}),this}setOptions(W){return this.defaults={...this.defaults,...W},this}lexer(W,z){return rr.lex(W,z??this.defaults)}parser(W,z){return ga.parse(W,z??this.defaults)}parseMarkdown(W,z){return(te,oe)=>{let ve={...oe},Te={...this.defaults,...ve},ot=this.onError(!!Te.silent,!!Te.async);if(this.defaults.async===!0&&ve.async===!1)return ot(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof te>"u"||te===null)return ot(new Error("marked(): input parameter is undefined or null"));if(typeof te!="string")return ot(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(te)+", string expected"));if(Te.hooks&&(Te.hooks.options=Te),Te.async)return Promise.resolve(Te.hooks?Te.hooks.preprocess(te):te).then(pt=>W(pt,Te)).then(pt=>Te.hooks?Te.hooks.processAllTokens(pt):pt).then(pt=>Te.walkTokens?Promise.all(this.walkTokens(pt,Te.walkTokens)).then(()=>pt):pt).then(pt=>z(pt,Te)).then(pt=>Te.hooks?Te.hooks.postprocess(pt):pt).catch(ot);try{Te.hooks&&(te=Te.hooks.preprocess(te));let pt=W(te,Te);Te.hooks&&(pt=Te.hooks.processAllTokens(pt)),Te.walkTokens&&this.walkTokens(pt,Te.walkTokens);let di=z(pt,Te);return Te.hooks&&(di=Te.hooks.postprocess(di)),di}catch(pt){return ot(pt)}}}onError(W,z){return $=>{if($.message+=`
Please report this to https://github.com/markedjs/marked.`,W){let te="<p>An error occurred:</p><pre>"+c($.message+"",!0)+"</pre>";return z?Promise.resolve(te):te}if(z)return Promise.reject($);throw $}}}let pp=new Hc;function ze(Wt,W){return pp.parse(Wt,W)}ze.options=ze.setOptions=function(Wt){return pp.setOptions(Wt),ze.defaults=pp.defaults,i(ze.defaults),ze},ze.getDefaults=e,ze.defaults=t.defaults,ze.use=function(...Wt){return pp.use(...Wt),ze.defaults=pp.defaults,i(ze.defaults),ze},ze.walkTokens=function(Wt,W){return pp.walkTokens(Wt,W)},ze.parseInline=pp.parseInline,ze.Parser=ga,ze.parser=ga.parse,ze.Renderer=dd,ze.TextRenderer=rm,ze.Lexer=rr,ze.lexer=rr.lex,ze.Tokenizer=C,ze.Hooks=Vg,ze.parse=ze;let Ae=ze.options,ee=ze.setOptions,De=ze.use,We=ze.walkTokens,ri=ze.parseInline,Zi=ze,Wr=ga.parse,Ps=rr.lex;t.Hooks=Vg,t.Lexer=rr,t.Marked=Hc,t.Parser=ga,t.Renderer=dd,t.TextRenderer=rm,t.Tokenizer=C,t.getDefaults=e,t.lexer=Ps,t.marked=ze,t.options=Ae,t.parse=Zi,t.parseInline=ri,t.parser=Wr,t.setOptions=ee,t.use=De,t.walkTokens=We})})();var BLt=ws.Hooks||exports.Hooks,VLt=ws.Lexer||exports.Lexer,WLt=ws.Marked||exports.Marked,HLt=ws.Parser||exports.Parser,w7=ws.Renderer||exports.Renderer,ULt=ws.TextRenderer||exports.TextRenderer,zLt=ws.Tokenizer||exports.Tokenizer,uae=ws.defaults||exports.defaults,KLt=ws.getDefaults||exports.getDefaults,$k=ws.lexer||exports.lexer,GLt=ws.marked||exports.marked,qLt=ws.options||exports.options,E7=ws.parse||exports.parse,$Lt=ws.parseInline||exports.parseInline,pae=ws.parser||exports.parser,jLt=ws.setOptions||exports.setOptions,XLt=ws.use||exports.use,YLt=ws.walkTokens||exports.walkTokens;var x7=Object.freeze({image:({href:r,title:t,text:e})=>{let i=[],n=[];return r&&({href:r,dimensions:i}=Kte(r),n.push(`src="${hD(r)}"`)),e&&n.push(`alt="${hD(e)}"`),t&&n.push(`title="${hD(t)}"`),i.length&&(n=n.concat(i)),"<img "+n.join(" ")+">"},paragraph({tokens:r}){return`<p>${this.parser.parseInline(r)}</p>`},link({href:r,title:t,tokens:e}){let i=this.parser.parseInline(e);return typeof r!="string"?"":(r===i&&(i=QA(i)),t=typeof t=="string"?hD(QA(t)):"",r=QA(r),r=r.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"),`<a href="${r}" title="${t||r}" draggable="false">${i}</a>`)}});function Qf(r,t={},e={}){let i=new B,n=!1,o=v1(t),s=function(g){let v;try{v=pw(decodeURIComponent(g))}catch{}return v?(v=nK(v,I=>{if(r.uris&&r.uris[I])return Z.revive(r.uris[I])}),encodeURIComponent(JSON.stringify(v))):g},a=function(g,v){let I=r.uris&&r.uris[g],y=Z.revive(I);return v?g.startsWith(Ie.data+":")?g:(y||(y=Z.parse(g)),Ao.uriToBrowserUri(y).toString(!0)):!y||Z.parse(g).toString()===y.toString()?g:(y.query&&(y=y.with({query:s(y.query)})),y.toString())},l=new w7;l.image=x7.image,l.link=x7.link,l.paragraph=x7.paragraph;let d=[],c=[];if(t.codeBlockRendererSync?l.code=({text:g,lang:v})=>{let I=qk.nextId(),y=t.codeBlockRendererSync(hae(v),g);return c.push([I,y]),`<div class="code" data-code="${I}">${Cp(g)}</div>`}:t.codeBlockRenderer&&(l.code=({text:g,lang:v})=>{let I=qk.nextId(),y=t.codeBlockRenderer(hae(v),g);return d.push(y.then(w=>[I,w])),`<div class="code" data-code="${I}">${Cp(g)}</div>`}),t.actionHandler){let g=function(y){let w=y.target.closest("a[data-href]");if(on(w))try{let C=w.dataset.href;C&&(r.baseUri&&(C=T7(Z.from(r.baseUri),C)),t.actionHandler.callback(C,y))}catch(C){Xe(C)}finally{y.preventDefault()}},v=t.actionHandler.disposables.add(new lt(o,"click")),I=t.actionHandler.disposables.add(new lt(o,"auxclick"));t.actionHandler.disposables.add(X.any(v.event,I.event)(y=>{let w=new _i(ue(o),y);!w.leftButton&&!w.middleButton||g(w)})),t.actionHandler.disposables.add(F(o,"keydown",y=>{let w=new ut(y);!w.equals(10)&&!w.equals(3)||g(w)}))}r.supportHtml||(l.html=({text:g})=>t.sanitizerOptions?.replaceWithPlaintext?Cp(g):(r.isTrusted?g.match(/^(<span[^>]+>)|(<\/\s*span>)$/):void 0)?g:""),e.renderer=l;let p=r.value??"";p.length>1e5&&(p=`${p.substr(0,1e5)}\u2026`),r.supportThemeIcons&&(p=zte(p));let h;if(t.fillInIncompleteTokens){let g={...uae,...e},v=$k(p,g),I=OSe(v);h=pae(I,g)}else h=E7(p,{...e,async:!1});r.supportThemeIcons&&(h=zl(h).map(v=>typeof v=="string"?v:v.outerHTML).join(""));let f=new DOMParser().parseFromString(_7({isTrusted:r.isTrusted,...t.sanitizerOptions},h),"text/html");if(f.body.querySelectorAll("img, audio, video, source").forEach(g=>{let v=g.getAttribute("src");if(v){let I=v;try{r.baseUri&&(I=T7(Z.from(r.baseUri),I))}catch{}if(g.setAttribute("src",a(I,!0)),t.remoteImageIsAllowed){let y=Z.parse(I);y.scheme!==Ie.file&&y.scheme!==Ie.data&&!t.remoteImageIsAllowed(y)&&g.replaceWith(J("",void 0,g.outerHTML))}}}),f.body.querySelectorAll("a").forEach(g=>{let v=g.getAttribute("href");if(g.setAttribute("href",""),!v||/^data:|javascript:/i.test(v)||/^command:/i.test(v)&&!r.isTrusted||/^command:(\/\/\/)?_workbench\.downloadResource/i.test(v))g.replaceWith(...g.childNodes);else{let I=a(v,!1);r.baseUri&&(I=T7(Z.from(r.baseUri),v)),g.dataset.href=I}}),o.innerHTML=_7({isTrusted:r.isTrusted,...t.sanitizerOptions},f.body.innerHTML),d.length>0)Promise.all(d).then(g=>{if(n)return;let v=new Map(g),I=o.querySelectorAll("div[data-code]");for(let y of I){let w=v.get(y.dataset.code??"");w&&bo(y,w)}t.asyncRenderCallback?.()});else if(c.length>0){let g=new Map(c),v=o.querySelectorAll("div[data-code]");for(let I of v){let y=g.get(I.dataset.code??"");y&&bo(I,y)}}if(t.asyncRenderCallback)for(let g of o.getElementsByTagName("img")){let v=i.add(F(g,"load",()=>{v.dispose(),t.asyncRenderCallback()}))}return{element:o,dispose:()=>{n=!0,i.dispose()}}}function hae(r){if(!r)return"";let t=r.split(/[\s+|:|,|\{|\?]/,1);return t.length?t[0]:r}function T7(r,t){return/^\w[\w\d+.-]*:/.test(t)?t:r.path.endsWith("/")?P4(r,t).toString():P4(Hn(r),t).toString()}var ESe=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"];function _7(r,t){let{config:e,allowedSchemes:i}=TSe(r),n=new B;n.add(mae("uponSanitizeAttribute",(o,s)=>{if(s.attrName==="style"||s.attrName==="class"){if(o.tagName==="SPAN"){if(s.attrName==="style"){s.keepAttr=/^(color\:(#[0-9a-fA-F]+|var\(--vscode(-[a-zA-Z0-9]+)+\));)?(background-color\:(#[0-9a-fA-F]+|var\(--vscode(-[a-zA-Z0-9]+)+\));)?(border-radius:[0-9]+px;)?$/.test(s.attrValue);return}else if(s.attrName==="class"){s.keepAttr=/^codicon codicon-[a-z\-]+( codicon-modifier-[a-z\-]+)?$/.test(s.attrValue);return}}s.keepAttr=!1;return}else if(o.tagName==="INPUT"&&o.attributes.getNamedItem("type")?.value==="checkbox"){if(s.attrName==="type"&&s.attrValue==="checkbox"||s.attrName==="disabled"||s.attrName==="checked"){s.keepAttr=!0;return}s.keepAttr=!1}})),n.add(mae("uponSanitizeElement",(o,s)=>{if(s.tagName==="input"&&(o.attributes.getNamedItem("type")?.value==="checkbox"?o.setAttribute("disabled",""):r.replaceWithPlaintext||o.remove()),r.replaceWithPlaintext&&!s.allowedTags[s.tagName]&&s.tagName!=="body"&&o.parentElement){let a,l;if(s.tagName==="#comment")a=`<!--${o.textContent}-->`;else{let h=ESe.includes(s.tagName),m=o.attributes.length?" "+Array.from(o.attributes).map(f=>`${f.name}="${f.value}"`).join(" "):"";a=`<${s.tagName}${m}>`,h||(l=`</${s.tagName}>`)}let d=document.createDocumentFragment(),c=o.parentElement.ownerDocument.createTextNode(a);d.appendChild(c);let p=l?o.parentElement.ownerDocument.createTextNode(l):void 0;for(;o.firstChild;)d.appendChild(o.firstChild);p&&d.appendChild(p),o.parentElement.replaceChild(d,o)}})),n.add(Ste(i));try{return Z_(t,{...e,RETURN_TRUSTED_TYPE:!0})}finally{n.dispose()}}var xSe=["align","autoplay","alt","checked","class","colspan","controls","data-code","data-href","disabled","draggable","height","href","loop","muted","playsinline","poster","rowspan","src","style","target","title","type","width","start"];function TSe(r){let t=[Ie.http,Ie.https,Ie.mailto,Ie.data,Ie.file,Ie.vscodeFileResource,Ie.vscodeRemote,Ie.vscodeRemoteResource];return r.isTrusted&&t.push(Ie.command),{config:{ALLOWED_TAGS:r.allowedTags??[...Cte],ALLOWED_ATTR:xSe,ALLOW_UNKNOWN_PROTOCOLS:!0},allowedSchemes:t}}function gae(r){return typeof r=="string"?r:_Se(r)}function _Se(r,t){let e=r.value??"";e.length>1e5&&(e=`${e.substr(0,1e5)}\u2026`);let i=E7(e,{async:!1,renderer:t?LSe.value:kSe.value}).replace(/&(#\d+|[a-zA-Z]+);/g,n=>DSe.get(n)??n);return _7({isTrusted:!1},i).toString()}var DSe=new Map([["&quot;",'"'],["&nbsp;"," "],["&amp;","&"],["&#39;","'"],["&lt;","<"],["&gt;",">"]]);function fae(){let r=new w7;return r.code=({text:t})=>t,r.blockquote=({text:t})=>t+`
`,r.html=t=>"",r.heading=function({tokens:t}){return this.parser.parseInline(t)+`
`},r.hr=()=>"",r.list=function({items:t}){return t.map(e=>this.listitem(e)).join(`
`)+`
`},r.listitem=({text:t})=>t+`
`,r.paragraph=function({tokens:t}){return this.parser.parseInline(t)+`
`},r.table=function({header:t,rows:e}){return t.map(i=>this.tablecell(i)).join(" ")+`
`+e.map(i=>i.map(n=>this.tablecell(n)).join(" ")).join(`
`)+`
`},r.tablerow=({text:t})=>t,r.tablecell=function({tokens:t}){return this.parser.parseInline(t)},r.strong=({text:t})=>t,r.em=({text:t})=>t,r.codespan=({text:t})=>t,r.br=t=>`
`,r.del=({text:t})=>t,r.image=t=>"",r.text=({text:t})=>t,r.link=({text:t})=>t,r}var kSe=new qn(r=>fae()),LSe=new qn(()=>{let r=fae();return r.code=({text:t})=>`
\`\`\`
${t}
\`\`\`
`,r});function L1(r){let t="";return r.forEach(e=>{t+=e.raw}),t}function bae(r){if(r.tokens)for(let t=r.tokens.length-1;t>=0;t--){let e=r.tokens[t];if(e.type==="text"){let i=e.raw.split(`
`),n=i[i.length-1];if(n.includes("`"))return FSe(r);if(n.includes("**"))return zSe(r);if(n.match(/\*\w/))return BSe(r);if(n.match(/(^|\s)__\w/))return KSe(r);if(n.match(/(^|\s)_\w/))return VSe(r);if(RSe(n)||PSe(n)&&r.tokens.slice(0,t).some(o=>o.type==="text"&&o.raw.match(/\[[^\]]*$/))){let o=r.tokens.slice(t+1);return o[0]?.type==="link"&&o[1]?.type==="text"&&o[1].raw.match(/^ *"[^"]*$/)||n.match(/^[^"]* +"[^"]*$/)?HSe(r):WSe(r)}else if(n.match(/(^|\s)\[\w*/))return USe(r)}}}function RSe(r){return!!r.match(/(^|\s)\[.*\]\(\w*/)}function PSe(r){return!!r.match(/^[^\[]*\]\([^\)]*$/)}function MSe(r){let t=r.items[r.items.length-1],e=t.tokens?t.tokens[t.tokens.length-1]:void 0,i;if(e?.type==="text"&&!("inRawBlock"in t)&&(i=bae(e)),!i||i.type!=="paragraph")return;let n=L1(r.items.slice(0,-1)),o=t.raw.match(/^(\s*(-|\d+\.|\*) +)/)?.[0];if(!o)return;let s=o+L1(t.tokens.slice(0,-1))+i.raw,a=$k(n+s)[0];if(a.type==="list")return a}var ASe=3;function OSe(r){for(let t=0;t<ASe;t++){let e=NSe(r);if(e)r=e;else break}return r}function NSe(r){let t,e;for(t=0;t<r.length;t++){let i=r[t];if(i.type==="paragraph"&&i.raw.match(/(\n|^)\|/)){e=GSe(r.slice(t));break}if(t===r.length-1&&i.type==="list"){let n=MSe(i);if(n){e=[n];break}}if(t===r.length-1&&i.type==="paragraph"){let n=bae(i);if(n){e=[n];break}}}if(e){let i=[...r.slice(0,t),...e];return i.links=r.links,i}return null}function FSe(r){return Zf(r,"`")}function BSe(r){return Zf(r,"*")}function VSe(r){return Zf(r,"_")}function WSe(r){return Zf(r,")")}function HSe(r){return Zf(r,'")')}function USe(r){return Zf(r,"](https://microsoft.com)")}function zSe(r){return Zf(r,"**")}function KSe(r){return Zf(r,"__")}function Zf(r,t){let e=L1(Array.isArray(r)?r:[r]);return $k(e+t)[0]}function GSe(r){let t=L1(r),e=t.split(`
`),i,n=!1;for(let o=0;o<e.length;o++){let s=e[o].trim();if(typeof i>"u"&&s.match(/^\s*\|/)){let a=s.match(/(\|[^\|]+)(?=\||$)/g);a&&(i=a.length)}else if(typeof i=="number")if(s.match(/^\s*\|/)){if(o!==e.length-1)return;n=!0}else return}if(typeof i=="number"&&i>0){let o=n?e.slice(0,-1).join(`
`):t,s=!!o.match(/\|\s*$/),a=o+(s?"":"|")+`
|${" --- |".repeat(i)}`;return $k(a)}}function mae(r,t){return MA(r,t),le(()=>AA(r))}var qSe={showHover:()=>{},hideHover:()=>{},showAndFocusLastHover:()=>{},setupManagedHover:()=>null,showManagedHover:()=>{}};function Bo(){return qSe}var WI=J,vae="selectOption.entry.template",D7=class{get templateId(){return vae}renderTemplate(t){let e=Object.create(null);return e.root=t,e.text=U(t,WI(".option-text")),e.detail=U(t,WI(".option-detail")),e.decoratorRight=U(t,WI(".option-decorator-right")),e}renderElement(t,e,i){let n=i,o=t.text,s=t.detail,a=t.decoratorRight,l=t.isDisabled;n.text.textContent=o,n.detail.textContent=s||"",n.decoratorRight.innerText=a||"",l?n.root.classList.add("option-disabled"):n.root.classList.remove("option-disabled")}disposeTemplate(t){}},R1=class r extends R{static DEFAULT_DROPDOWN_MINIMUM_BOTTOM_MARGIN=32;static DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN=2;static DEFAULT_MINIMUM_VISIBLE_OPTIONS=3;_isVisible;selectBoxOptions;selectElement;container;options=[];selected;_onDidSelect;styles;listRenderer;contextViewProvider;selectDropDownContainer;styleElement;selectList;selectDropDownListContainer;widthControlElement;_currentSelection=0;_dropDownPosition;_hasDetails=!1;selectionDetailsPane;_skipLayout=!1;_cachedMaxDetailsHeight;_hover;_sticky=!1;constructor(t,e,i,n,o){super(),this._isVisible=!1,this.styles=n,this.selectBoxOptions=o||Object.create(null),typeof this.selectBoxOptions.minBottomMargin!="number"?this.selectBoxOptions.minBottomMargin=r.DEFAULT_DROPDOWN_MINIMUM_BOTTOM_MARGIN:this.selectBoxOptions.minBottomMargin<0&&(this.selectBoxOptions.minBottomMargin=0),this.selectElement=document.createElement("select"),this.selectElement.className="monaco-select-box monaco-select-box-dropdown-padding",typeof this.selectBoxOptions.ariaLabel=="string"&&this.selectElement.setAttribute("aria-label",this.selectBoxOptions.ariaLabel),typeof this.selectBoxOptions.ariaDescription=="string"&&this.selectElement.setAttribute("aria-description",this.selectBoxOptions.ariaDescription),this._onDidSelect=new x,this._register(this._onDidSelect),this.registerListeners(),this.constructSelectDropDown(i),this.selected=e||0,t&&this.setOptions(t,e),this.initStyleSheet()}setTitle(t){!this._hover&&t?this._hover=this._register(Bo().setupManagedHover(gt("mouse"),this.selectElement,t)):this._hover&&this._hover.update(t)}getHeight(){return 22}getTemplateId(){return vae}constructSelectDropDown(t){this.contextViewProvider=t,this.selectDropDownContainer=J(".monaco-select-box-dropdown-container"),this.selectDropDownContainer.classList.add("monaco-select-box-dropdown-padding"),this.selectionDetailsPane=U(this.selectDropDownContainer,WI(".select-box-details-pane"));let e=U(this.selectDropDownContainer,WI(".select-box-dropdown-container-width-control")),i=U(e,WI(".width-control-div"));this.widthControlElement=document.createElement("span"),this.widthControlElement.className="option-text-width-control",U(i,this.widthControlElement),this._dropDownPosition=0,this.styleElement=Go(this.selectDropDownContainer),this.selectDropDownContainer.setAttribute("draggable","true"),this._register(F(this.selectDropDownContainer,Q.DRAG_START,n=>{Ve.stop(n,!0)}))}registerListeners(){this._register(Ut(this.selectElement,"change",e=>{this.selected=e.target.selectedIndex,this._onDidSelect.fire({index:e.target.selectedIndex,selected:e.target.value}),this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)})),this._register(F(this.selectElement,Q.CLICK,e=>{Ve.stop(e),this._isVisible?this.hideSelectDropDown(!0):this.showSelectDropDown()})),this._register(F(this.selectElement,Q.MOUSE_DOWN,e=>{Ve.stop(e)}));let t;this._register(F(this.selectElement,"touchstart",e=>{t=this._isVisible})),this._register(F(this.selectElement,"touchend",e=>{Ve.stop(e),t?this.hideSelectDropDown(!0):this.showSelectDropDown()})),this._register(F(this.selectElement,Q.KEY_DOWN,e=>{let i=new ut(e),n=!1;ye?(i.keyCode===18||i.keyCode===16||i.keyCode===10||i.keyCode===3)&&(n=!0):(i.keyCode===18&&i.altKey||i.keyCode===16&&i.altKey||i.keyCode===10||i.keyCode===3)&&(n=!0),n&&(this.showSelectDropDown(),Ve.stop(e,!0))}))}get onDidSelect(){return this._onDidSelect.event}setOptions(t,e){xi(this.options,t)||(this.options=t,this.selectElement.options.length=0,this._hasDetails=!1,this._cachedMaxDetailsHeight=void 0,this.options.forEach((i,n)=>{this.selectElement.add(this.createOption(i.text,n,i.isDisabled)),typeof i.description=="string"&&(this._hasDetails=!0)})),e!==void 0&&(this.select(e),this._currentSelection=this.selected)}setEnabled(t){this.selectElement.disabled=!t}setOptionsList(){this.selectList?.splice(0,this.selectList.length,this.options)}select(t){t>=0&&t<this.options.length?this.selected=t:t>this.options.length-1?this.select(this.options.length-1):this.selected<0&&(this.selected=0),this.selectElement.selectedIndex=this.selected,this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)}setAriaLabel(t){this.selectBoxOptions.ariaLabel=t,this.selectElement.setAttribute("aria-label",this.selectBoxOptions.ariaLabel)}focus(){this.selectElement&&(this.selectElement.tabIndex=0,this.selectElement.focus())}blur(){this.selectElement&&(this.selectElement.tabIndex=-1,this.selectElement.blur())}setFocusable(t){this.selectElement.tabIndex=t?0:-1}render(t){this.container=t,t.classList.add("select-container"),t.appendChild(this.selectElement),this.styleSelectElement()}initStyleSheet(){let t=[];this.styles.listFocusBackground&&t.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { background-color: ${this.styles.listFocusBackground} !important; }`),this.styles.listFocusForeground&&t.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { color: ${this.styles.listFocusForeground} !important; }`),this.styles.decoratorRightForeground&&t.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.focused) .option-decorator-right { color: ${this.styles.decoratorRightForeground}; }`),this.styles.selectBackground&&this.styles.selectBorder&&this.styles.selectBorder!==this.styles.selectBackground?(t.push(`.monaco-select-box-dropdown-container { border: 1px solid ${this.styles.selectBorder} } `),t.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-top { border-top: 1px solid ${this.styles.selectBorder} } `),t.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-bottom { border-bottom: 1px solid ${this.styles.selectBorder} } `)):this.styles.selectListBorder&&(t.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-top { border-top: 1px solid ${this.styles.selectListBorder} } `),t.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-bottom { border-bottom: 1px solid ${this.styles.selectListBorder} } `)),this.styles.listHoverForeground&&t.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { color: ${this.styles.listHoverForeground} !important; }`),this.styles.listHoverBackground&&t.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { background-color: ${this.styles.listHoverBackground} !important; }`),this.styles.listFocusOutline&&t.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { outline: 1.6px dotted ${this.styles.listFocusOutline} !important; outline-offset: -1.6px !important; }`),this.styles.listHoverOutline&&t.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { outline: 1.6px dashed ${this.styles.listHoverOutline} !important; outline-offset: -1.6px !important; }`),t.push(".monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.option-disabled.focused { background-color: transparent !important; color: inherit !important; outline: none !important; }"),t.push(".monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.option-disabled:hover { background-color: transparent !important; color: inherit !important; outline: none !important; }"),this.styleElement.textContent=t.join(`
`)}styleSelectElement(){let t=this.styles.selectBackground??"",e=this.styles.selectForeground??"",i=this.styles.selectBorder??"";this.selectElement.style.backgroundColor=t,this.selectElement.style.color=e,this.selectElement.style.borderColor=i}styleList(){let t=this.styles.selectBackground??"",e=Ja(this.styles.selectListBackground,t);this.selectDropDownListContainer.style.backgroundColor=e,this.selectionDetailsPane.style.backgroundColor=e;let i=this.styles.focusBorder??"";this.selectDropDownContainer.style.outlineColor=i,this.selectDropDownContainer.style.outlineOffset="-1px",this.selectList.style(this.styles)}createOption(t,e,i){let n=document.createElement("option");return n.value=t,n.text=t,n.disabled=!!i,n}showSelectDropDown(){this.selectionDetailsPane.innerText="",!(!this.contextViewProvider||this._isVisible)&&(this.createSelectList(this.selectDropDownContainer),this.setOptionsList(),this.contextViewProvider.showContextView({getAnchor:()=>this.selectElement,render:t=>this.renderSelectDropDown(t,!0),layout:()=>{this.layoutSelectDropDown()},onHide:()=>{this.selectDropDownContainer.classList.remove("visible"),this.selectElement.classList.remove("synthetic-focus")},anchorPosition:this._dropDownPosition},this.selectBoxOptions.optionsAsChildren?this.container:void 0),this._isVisible=!0,this.hideSelectDropDown(!1),this.contextViewProvider.showContextView({getAnchor:()=>this.selectElement,render:t=>this.renderSelectDropDown(t),layout:()=>this.layoutSelectDropDown(),onHide:()=>{this.selectDropDownContainer.classList.remove("visible"),this.selectElement.classList.remove("synthetic-focus")},anchorPosition:this._dropDownPosition},this.selectBoxOptions.optionsAsChildren?this.container:void 0),this._currentSelection=this.selected,this._isVisible=!0,this.selectElement.setAttribute("aria-expanded","true"))}hideSelectDropDown(t){!this.contextViewProvider||!this._isVisible||(this._isVisible=!1,this.selectElement.setAttribute("aria-expanded","false"),t&&this.selectElement.focus(),this.contextViewProvider.hideContextView())}renderSelectDropDown(t,e){return t.appendChild(this.selectDropDownContainer),this.layoutSelectDropDown(e),{dispose:()=>{this.selectDropDownContainer.remove()}}}measureMaxDetailsHeight(){let t=0;return this.options.forEach((e,i)=>{this.updateDetail(i),this.selectionDetailsPane.offsetHeight>t&&(t=this.selectionDetailsPane.offsetHeight)}),t}layoutSelectDropDown(t){if(this._skipLayout)return!1;if(this.selectList){this.selectDropDownContainer.classList.add("visible");let e=ue(this.selectElement),i=Oi(this.selectElement),n=ue(this.selectElement).getComputedStyle(this.selectElement),o=parseFloat(n.getPropertyValue("--dropdown-padding-top"))+parseFloat(n.getPropertyValue("--dropdown-padding-bottom")),s=e.innerHeight-i.top-i.height-(this.selectBoxOptions.minBottomMargin||0),a=i.top-r.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN,l=this.selectElement.offsetWidth,d=this.setWidthControlElement(this.widthControlElement),c=Math.max(d,Math.round(l)).toString()+"px";this.selectDropDownContainer.style.width=c,this.selectList.getHTMLElement().style.height="",this.selectList.layout();let p=this.selectList.contentHeight;this._hasDetails&&this._cachedMaxDetailsHeight===void 0&&(this._cachedMaxDetailsHeight=this.measureMaxDetailsHeight());let h=this._hasDetails?this._cachedMaxDetailsHeight:0,m=p+o+h,f=Math.floor((s-o-h)/this.getHeight()),g=Math.floor((a-o-h)/this.getHeight());if(t)return i.top+i.height>e.innerHeight-22||i.top<r.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN||f<1&&g<1?!1:(f<r.DEFAULT_MINIMUM_VISIBLE_OPTIONS&&g>f&&this.options.length>f?(this._dropDownPosition=1,this.selectDropDownListContainer.remove(),this.selectionDetailsPane.remove(),this.selectDropDownContainer.appendChild(this.selectionDetailsPane),this.selectDropDownContainer.appendChild(this.selectDropDownListContainer),this.selectionDetailsPane.classList.remove("border-top"),this.selectionDetailsPane.classList.add("border-bottom")):(this._dropDownPosition=0,this.selectDropDownListContainer.remove(),this.selectionDetailsPane.remove(),this.selectDropDownContainer.appendChild(this.selectDropDownListContainer),this.selectDropDownContainer.appendChild(this.selectionDetailsPane),this.selectionDetailsPane.classList.remove("border-bottom"),this.selectionDetailsPane.classList.add("border-top")),!0);if(i.top+i.height>e.innerHeight-22||i.top<r.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN||this._dropDownPosition===0&&f<1||this._dropDownPosition===1&&g<1)return this.hideSelectDropDown(!0),!1;if(this._dropDownPosition===0){if(this._isVisible&&f+g<1)return this.hideSelectDropDown(!0),!1;m>s&&(p=f*this.getHeight())}else m>a&&(p=g*this.getHeight());return this.selectList.layout(p),this.selectList.domFocus(),this.selectList.length>0&&(this.selectList.setFocus([this.selected||0]),this.selectList.reveal(this.selectList.getFocus()[0]||0)),this._hasDetails?(this.selectList.getHTMLElement().style.height=p+o+"px",this.selectDropDownContainer.style.height=""):this.selectDropDownContainer.style.height=p+o+"px",this.updateDetail(this.selected),this.selectDropDownContainer.style.width=c,this.selectDropDownListContainer.setAttribute("tabindex","0"),this.selectElement.classList.add("synthetic-focus"),this.selectDropDownContainer.classList.add("synthetic-focus"),!0}else return!1}setWidthControlElement(t){let e=0;if(t){let i=0,n=0;this.options.forEach((o,s)=>{let a=o.detail?o.detail.length:0,l=o.decoratorRight?o.decoratorRight.length:0,d=o.text.length+a+l;d>n&&(i=s,n=d)}),t.textContent=this.options[i].text+(this.options[i].decoratorRight?this.options[i].decoratorRight+" ":""),e=xm(t)}return e}createSelectList(t){if(this.selectList)return;this.selectDropDownListContainer=U(t,WI(".select-box-dropdown-list-container")),this.listRenderer=new D7,this.selectList=this._register(new ho("SelectBoxCustom",this.selectDropDownListContainer,this,[this.listRenderer],{useShadows:!1,verticalScrollMode:3,keyboardSupport:!1,mouseSupport:!1,accessibilityProvider:{getAriaLabel:n=>{let o=n.text;return n.detail&&(o+=`. ${n.detail}`),n.decoratorRight&&(o+=`. ${n.decoratorRight}`),n.description&&(o+=`. ${n.description}`),o},getWidgetAriaLabel:()=>u({key:"selectBox",comment:["Behave like native select dropdown element."]},"Select Box"),getRole:()=>ye?"":"option",getWidgetRole:()=>"listbox"}})),this.selectBoxOptions.ariaLabel&&(this.selectList.ariaLabel=this.selectBoxOptions.ariaLabel);let e=this._register(new lt(this.selectDropDownListContainer,"keydown")),i=X.chain(e.event,n=>n.filter(()=>this.selectList.length>0).map(o=>new ut(o)));this._register(X.chain(i,n=>n.filter(o=>o.keyCode===3))(this.onEnter,this)),this._register(X.chain(i,n=>n.filter(o=>o.keyCode===2))(this.onEnter,this)),this._register(X.chain(i,n=>n.filter(o=>o.keyCode===9))(this.onEscape,this)),this._register(X.chain(i,n=>n.filter(o=>o.keyCode===16))(this.onUpArrow,this)),this._register(X.chain(i,n=>n.filter(o=>o.keyCode===18))(this.onDownArrow,this)),this._register(X.chain(i,n=>n.filter(o=>o.keyCode===12))(this.onPageDown,this)),this._register(X.chain(i,n=>n.filter(o=>o.keyCode===11))(this.onPageUp,this)),this._register(X.chain(i,n=>n.filter(o=>o.keyCode===14))(this.onHome,this)),this._register(X.chain(i,n=>n.filter(o=>o.keyCode===13))(this.onEnd,this)),this._register(X.chain(i,n=>n.filter(o=>o.keyCode>=21&&o.keyCode<=56||o.keyCode>=85&&o.keyCode<=113))(this.onCharacter,this)),this._register(F(this.selectList.getHTMLElement(),Q.POINTER_UP,n=>this.onPointerUp(n))),this._register(this.selectList.onMouseOver(n=>typeof n.index<"u"&&this.selectList.setFocus([n.index]))),this._register(this.selectList.onDidChangeFocus(n=>this.onListFocus(n))),this._register(F(this.selectDropDownContainer,Q.FOCUS_OUT,n=>{!this._isVisible||$n(n.relatedTarget,this.selectDropDownContainer)||this.onListBlur()})),this.selectList.getHTMLElement().setAttribute("aria-label",this.selectBoxOptions.ariaLabel||""),this.selectList.getHTMLElement().setAttribute("aria-expanded","true"),this.styleList()}onPointerUp(t){if(!this.selectList.length)return;Ve.stop(t);let e=t.target;if(!e||e.classList.contains("slider"))return;let i=e.closest(".monaco-list-row");if(!i)return;let n=Number(i.getAttribute("data-index")),o=i.classList.contains("option-disabled");n>=0&&n<this.options.length&&!o&&(this.selected=n,this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0]),this.selected!==this._currentSelection&&(this._currentSelection=this.selected,this._onDidSelect.fire({index:this.selectElement.selectedIndex,selected:this.options[this.selected].text}),this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)),this.hideSelectDropDown(!0))}onListBlur(){this._sticky||(this.selected!==this._currentSelection&&this.select(this._currentSelection),this.hideSelectDropDown(!1))}renderDescriptionMarkdown(t,e){let i=o=>{for(let s=0;s<o.childNodes.length;s++){let a=o.childNodes.item(s);(a.tagName&&a.tagName.toLowerCase())==="img"?a.remove():i(a)}},n=Qf({value:t,supportThemeIcons:!0},{actionHandler:e});return n.element.classList.add("select-box-description-markdown"),i(n.element),n.element}onListFocus(t){!this._isVisible||!this._hasDetails||this.updateDetail(t.indexes[0])}updateDetail(t){this.selectionDetailsPane.innerText="";let e=this.options[t],i=e?.description??"",n=e?.descriptionIsMarkdown??!1;if(i){if(n){let o=e.descriptionMarkdownActionHandler;this.selectionDetailsPane.appendChild(this.renderDescriptionMarkdown(i,o))}else this.selectionDetailsPane.innerText=i;this.selectionDetailsPane.style.display="block"}else this.selectionDetailsPane.style.display="none";this._skipLayout=!0,this.contextViewProvider.layout(),this._skipLayout=!1}onEscape(t){Ve.stop(t),this.select(this._currentSelection),this.hideSelectDropDown(!0)}onEnter(t){Ve.stop(t),this.selected!==this._currentSelection&&(this._currentSelection=this.selected,this._onDidSelect.fire({index:this.selectElement.selectedIndex,selected:this.options[this.selected].text}),this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)),this.hideSelectDropDown(!0)}onDownArrow(t){if(this.selected<this.options.length-1){Ve.stop(t,!0);let e=this.options[this.selected+1].isDisabled;if(e&&this.options.length>this.selected+2)this.selected+=2;else{if(e)return;this.selected++}this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0])}}onUpArrow(t){this.selected>0&&(Ve.stop(t,!0),this.options[this.selected-1].isDisabled&&this.selected>1?this.selected-=2:this.selected--,this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0]))}onPageUp(t){Ve.stop(t),this.selectList.focusPreviousPage(),setTimeout(()=>{this.selected=this.selectList.getFocus()[0],this.options[this.selected].isDisabled&&this.selected<this.options.length-1&&(this.selected++,this.selectList.setFocus([this.selected])),this.selectList.reveal(this.selected),this.select(this.selected)},1)}onPageDown(t){Ve.stop(t),this.selectList.focusNextPage(),setTimeout(()=>{this.selected=this.selectList.getFocus()[0],this.options[this.selected].isDisabled&&this.selected>0&&(this.selected--,this.selectList.setFocus([this.selected])),this.selectList.reveal(this.selected),this.select(this.selected)},1)}onHome(t){Ve.stop(t),!(this.options.length<2)&&(this.selected=0,this.options[this.selected].isDisabled&&this.selected>1&&this.selected++,this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selected),this.select(this.selected))}onEnd(t){Ve.stop(t),!(this.options.length<2)&&(this.selected=this.options.length-1,this.options[this.selected].isDisabled&&this.selected>1&&this.selected--,this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selected),this.select(this.selected))}onCharacter(t){let e=b_.toString(t.keyCode),i=-1;for(let n=0;n<this.options.length-1;n++)if(i=(n+this.selected+1)%this.options.length,this.options[i].text.charAt(0).toUpperCase()===e&&!this.options[i].isDisabled){this.select(i),this.selectList.setFocus([i]),this.selectList.reveal(this.selectList.getFocus()[0]),Ve.stop(t);break}}dispose(){this.hideSelectDropDown(!1),super.dispose()}};var P1=class extends R{selectElement;selectBoxOptions;options;selected=0;_onDidSelect;styles;constructor(t,e,i,n){super(),this.selectBoxOptions=n||Object.create(null),this.options=[],this.selectElement=document.createElement("select"),this.selectElement.className="monaco-select-box",typeof this.selectBoxOptions.ariaLabel=="string"&&this.selectElement.setAttribute("aria-label",this.selectBoxOptions.ariaLabel),typeof this.selectBoxOptions.ariaDescription=="string"&&this.selectElement.setAttribute("aria-description",this.selectBoxOptions.ariaDescription),this._onDidSelect=this._register(new x),this.styles=i,this.registerListeners(),this.setOptions(t,e)}registerListeners(){this._register(yi.addTarget(this.selectElement)),[At.Tap].forEach(t=>{this._register(F(this.selectElement,t,e=>{this.selectElement.focus()}))}),this._register(Ut(this.selectElement,"click",t=>{Ve.stop(t,!0)})),this._register(Ut(this.selectElement,"change",t=>{this.selectElement.title=t.target.value,this._onDidSelect.fire({index:t.target.selectedIndex,selected:t.target.value})})),this._register(Ut(this.selectElement,"keydown",t=>{let e=!1;ye?(t.keyCode===18||t.keyCode===16||t.keyCode===10)&&(e=!0):(t.keyCode===18&&t.altKey||t.keyCode===10||t.keyCode===3)&&(e=!0),e&&t.stopPropagation()}))}get onDidSelect(){return this._onDidSelect.event}setOptions(t,e){(!this.options||!xi(this.options,t))&&(this.options=t,this.selectElement.options.length=0,this.options.forEach((i,n)=>{this.selectElement.add(this.createOption(i.text,n,i.isDisabled))})),e!==void 0&&this.select(e)}select(t){this.options.length===0?this.selected=0:t>=0&&t<this.options.length?this.selected=t:t>this.options.length-1?this.select(this.options.length-1):this.selected<0&&(this.selected=0),this.selectElement.selectedIndex=this.selected,this.selected<this.options.length&&typeof this.options[this.selected].text=="string"?this.selectElement.title=this.options[this.selected].text:this.selectElement.title=""}setAriaLabel(t){this.selectBoxOptions.ariaLabel=t,this.selectElement.setAttribute("aria-label",t)}focus(){this.selectElement&&(this.selectElement.tabIndex=0,this.selectElement.focus())}blur(){this.selectElement&&(this.selectElement.tabIndex=-1,this.selectElement.blur())}setEnabled(t){this.selectElement.disabled=!t}setFocusable(t){this.selectElement.tabIndex=t?0:-1}render(t){t.classList.add("select-container"),t.appendChild(this.selectElement),this.setOptions(this.options,this.selected),this.applyStyles()}style(t){this.styles=t,this.applyStyles()}applyStyles(){this.selectElement&&(this.selectElement.style.backgroundColor=this.styles.selectBackground??"",this.selectElement.style.color=this.styles.selectForeground??"",this.selectElement.style.borderColor=this.styles.selectBorder??"")}createOption(t,e,i){let n=document.createElement("option");return n.value=t,n.text=t,n.disabled=!!i,n}};var LPt={...k1,selectBackground:"#3C3C3C",selectForeground:"#F0F0F0",selectBorder:"#3C3C3C",decoratorRightForeground:void 0,selectListBackground:void 0,selectListBorder:void 0,focusBorder:void 0},th=class extends ko{selectBoxDelegate;constructor(t,e,i,n,o){super(),ye&&!o?.useCustomDrawn?this.selectBoxDelegate=new P1(t,e,n,o):this.selectBoxDelegate=new R1(t,e,i,n,o),this._register(this.selectBoxDelegate)}get onDidSelect(){return this.selectBoxDelegate.onDidSelect}setOptions(t,e){this.selectBoxDelegate.setOptions(t,e)}select(t){this.selectBoxDelegate.select(t)}setAriaLabel(t){this.selectBoxDelegate.setAriaLabel(t)}focus(){this.selectBoxDelegate.focus()}blur(){this.selectBoxDelegate.blur()}setFocusable(t){this.selectBoxDelegate.setFocusable(t)}setEnabled(t){this.selectBoxDelegate.setEnabled(t)}render(t){this.selectBoxDelegate.render(t)}};var Iae={inputActiveOptionBorder:"#007ACC00",inputActiveOptionForeground:"#FFFFFF",inputActiveOptionBackground:"#0E639C50"};var xu=class extends ko{_onChange=this._register(new x);onChange=this._onChange.event;_onKeyDown=this._register(new x);onKeyDown=this._onKeyDown.event;_opts;_icon;domNode;_checked;_hover;constructor(t){super(),this._opts=t,this._checked=this._opts.isChecked;let e=["monaco-custom-toggle"];this._opts.icon&&(this._icon=this._opts.icon,e.push(...de.asClassNameArray(this._icon))),this._opts.actionClassName&&e.push(...this._opts.actionClassName.split(" ")),this._checked&&e.push("checked"),this.domNode=document.createElement("div"),this._hover=this._register(Bo().setupManagedHover(t.hoverDelegate??gt("mouse"),this.domNode,this._opts.title)),this.domNode.classList.add(...e),this._opts.notFocusable||(this.domNode.tabIndex=0),this.domNode.setAttribute("role","checkbox"),this.domNode.setAttribute("aria-checked",String(this._checked)),this.domNode.setAttribute("aria-label",this._opts.title),this.applyStyles(),this.onclick(this.domNode,i=>{this.enabled&&(this.checked=!this._checked,this._onChange.fire(!1),i.preventDefault())}),this._register(this.ignoreGesture(this.domNode)),this.onkeydown(this.domNode,i=>{if(i.keyCode===10||i.keyCode===3){this.checked=!this._checked,this._onChange.fire(!0),i.preventDefault(),i.stopPropagation();return}this._onKeyDown.fire(i)})}get enabled(){return this.domNode.getAttribute("aria-disabled")!=="true"}focus(){this.domNode.focus()}get checked(){return this._checked}set checked(t){this._checked=t,this.domNode.setAttribute("aria-checked",String(this._checked)),this.domNode.classList.toggle("checked",this._checked),this.applyStyles()}setIcon(t){this._icon&&this.domNode.classList.remove(...de.asClassNameArray(this._icon)),this._icon=t,this._icon&&this.domNode.classList.add(...de.asClassNameArray(this._icon))}width(){return 22}applyStyles(){this.domNode&&(this.domNode.style.borderColor=this._checked&&this._opts.inputActiveOptionBorder||"",this.domNode.style.color=this._checked&&this._opts.inputActiveOptionForeground||"inherit",this.domNode.style.backgroundColor=this._checked&&this._opts.inputActiveOptionBackground||"")}enable(){this.domNode.setAttribute("aria-disabled",String(!1))}disable(){this.domNode.setAttribute("aria-disabled",String(!0))}setTitle(t){this._hover.update(t),this.domNode.setAttribute("aria-label",t)}set visible(t){this.domNode.style.display=t?"":"none"}get visible(){return this.domNode.style.display!=="none"}};var Yn=class extends R{constructor(e,i,n={}){super();this.options=n;this._context=e||this,this._action=i,i instanceof et&&this._register(i.onDidChange(o=>{this.element&&this.handleActionChangeEvent(o)}))}element;_context;_action;customHover;get action(){return this._action}_actionRunner;handleActionChangeEvent(e){e.enabled!==void 0&&this.updateEnabled(),e.checked!==void 0&&this.updateChecked(),e.class!==void 0&&this.updateClass(),e.label!==void 0&&(this.updateLabel(),this.updateTooltip()),e.tooltip!==void 0&&this.updateTooltip()}get actionRunner(){return this._actionRunner||(this._actionRunner=this._register(new jo)),this._actionRunner}set actionRunner(e){this._actionRunner=e}isEnabled(){return this._action.enabled}setActionContext(e){this._context=e}render(e){let i=this.element=e;this._register(yi.addTarget(e));let n=this.options&&this.options.draggable;n&&(e.draggable=!0,po&&this._register(F(e,Q.DRAG_START,o=>o.dataTransfer?.setData(_a.TEXT,this._action.label)))),this._register(F(i,At.Tap,o=>this.onClick(o,!0))),this._register(F(i,Q.MOUSE_DOWN,o=>{n||Ve.stop(o,!0),this._action.enabled&&o.button===0&&i.classList.add("active")})),ye&&this._register(F(i,Q.CONTEXT_MENU,o=>{o.button===0&&o.ctrlKey===!0&&this.onClick(o)})),this._register(F(i,Q.CLICK,o=>{Ve.stop(o,!0),this.options&&this.options.isMenu||this.onClick(o)})),this._register(F(i,Q.DBLCLICK,o=>{Ve.stop(o,!0)})),[Q.MOUSE_UP,Q.MOUSE_OUT].forEach(o=>{this._register(F(i,o,s=>{Ve.stop(s),i.classList.remove("active")}))})}onClick(e,i=!1){Ve.stop(e,!0);let n=Wn(this._context)?this.options?.useEventAsContext?e:{preserveFocus:i}:this._context;this.actionRunner.run(this._action,n)}focus(){this.element&&(this.element.tabIndex=0,this.element.focus(),this.element.classList.add("focused"))}isFocused(){return!!this.element?.classList.contains("focused")}blur(){this.element&&(this.element.blur(),this.element.tabIndex=-1,this.element.classList.remove("focused"))}setFocusable(e){this.element&&(this.element.tabIndex=e?0:-1)}get trapsArrowNavigation(){return!1}updateEnabled(){}updateLabel(){}getClass(){return this.action.class}getTooltip(){return this.action.tooltip}updateTooltip(){if(!this.element)return;let e=this.getTooltip()??"";if(this.updateAriaLabel(),this.options.hoverDelegate?.showNativeHover)this.element.title=e;else if(!this.customHover&&e!==""){let i=this.options.hoverDelegate??gt("element");this.customHover=this._store.add(Bo().setupManagedHover(i,this.element,e))}else this.customHover&&this.customHover.update(e)}updateAriaLabel(){if(this.element){let e=this.getTooltip()??"";this.element.setAttribute("aria-label",e)}}updateClass(){}updateChecked(){}dispose(){this.element&&(this.element.remove(),this.element=void 0),this._context=void 0,super.dispose()}},Kl=class extends Yn{label;options;cssClass;constructor(t,e,i){super(t,e,i),this.options=i,this.options.icon=i.icon!==void 0?i.icon:!1,this.options.label=i.label!==void 0?i.label:!0,this.cssClass=""}render(t){super.render(t),un(this.element);let e=document.createElement("a");if(e.classList.add("action-label"),e.setAttribute("role",this.getDefaultAriaRole()),this.label=e,this.element.appendChild(e),this.options.label&&this.options.keybinding){let i=document.createElement("span");i.classList.add("keybinding"),i.textContent=this.options.keybinding,this.element.appendChild(i)}this.updateClass(),this.updateLabel(),this.updateTooltip(),this.updateEnabled(),this.updateChecked()}getDefaultAriaRole(){return this._action.id===Qt.ID?"presentation":this.options.isMenu?"menuitem":this.options.isTabList?"tab":"button"}focus(){this.label&&(this.label.tabIndex=0,this.label.focus())}isFocused(){return!!this.label&&this.label?.tabIndex===0}blur(){this.label&&(this.label.tabIndex=-1)}setFocusable(t){this.label&&(this.label.tabIndex=t?0:-1)}updateLabel(){this.options.label&&this.label&&(this.label.textContent=this.action.label)}getTooltip(){let t=null;return this.action.tooltip?t=this.action.tooltip:!this.options.label&&this.action.label&&this.options.icon&&(t=this.action.label,this.options.keybinding&&(t=u({key:"titleLabel",comment:["action title","action keybinding"]},"{0} ({1})",t,this.options.keybinding))),t??void 0}updateClass(){this.cssClass&&this.label&&this.label.classList.remove(...this.cssClass.split(" ")),this.options.icon?(this.cssClass=this.getClass(),this.label&&(this.label.classList.add("codicon"),this.cssClass&&this.label.classList.add(...this.cssClass.split(" "))),this.updateEnabled()):this.label?.classList.remove("codicon")}updateEnabled(){this.action.enabled?(this.label&&(this.label.removeAttribute("aria-disabled"),this.label.classList.remove("disabled")),this.element?.classList.remove("disabled")):(this.label&&(this.label.setAttribute("aria-disabled","true"),this.label.classList.add("disabled")),this.element?.classList.add("disabled"))}updateAriaLabel(){if(this.label){let t=this.getTooltip()??"";this.label.setAttribute("aria-label",t)}}updateChecked(){this.label&&(this.action.checked!==void 0?(this.label.classList.toggle("checked",this.action.checked),this.options.isTabList?this.label.setAttribute("aria-selected",this.action.checked?"true":"false"):(this.label.setAttribute("aria-checked",this.action.checked?"true":"false"),this.label.setAttribute("role","checkbox"))):(this.label.classList.remove("checked"),this.label.removeAttribute(this.options.isTabList?"aria-selected":"aria-checked"),this.label.setAttribute("role",this.getDefaultAriaRole())))}},Cw=class extends Yn{selectBox;constructor(t,e,i,n,o,s,a){super(t,e),this.selectBox=new th(i,n,o,s,a),this.selectBox.setFocusable(!1),this._register(this.selectBox),this.registerListeners()}setOptions(t,e){this.selectBox.setOptions(t,e)}select(t){this.selectBox.select(t)}registerListeners(){this._register(this.selectBox.onDidSelect(t=>this.runAction(t.selected,t.index)))}runAction(t,e){this.actionRunner.run(this._action,this.getActionContext(t,e))}getActionContext(t,e){return t}setFocusable(t){this.selectBox.setFocusable(t)}focus(){this.selectBox?.focus()}blur(){this.selectBox?.blur()}render(t){this.selectBox.render(t)}};var Fi=class extends R{options;_hoverDelegate;_actionRunner;_actionRunnerDisposables=this._register(new B);_context;_orientation;_triggerKeys;viewItems;viewItemDisposables=this._register(new us);previouslyFocusedItem;focusedItem;focusTracker;triggerKeyDown=!1;focusable=!0;domNode;actionsList;_onDidBlur=this._register(new x);onDidBlur=this._onDidBlur.event;_onDidCancel=this._register(new x({onWillAddFirstListener:()=>this.cancelHasListener=!0}));onDidCancel=this._onDidCancel.event;cancelHasListener=!1;_onDidRun=this._register(new x);onDidRun=this._onDidRun.event;_onWillRun=this._register(new x);onWillRun=this._onWillRun.event;constructor(t,e={}){super(),this.options=e,this._context=e.context??null,this._orientation=this.options.orientation??0,this._triggerKeys={keyDown:this.options.triggerKeys?.keyDown??!1,keys:this.options.triggerKeys?.keys??[3,10]},this._hoverDelegate=e.hoverDelegate??this._register(wu()),this.options.actionRunner?this._actionRunner=this.options.actionRunner:(this._actionRunner=new jo,this._actionRunnerDisposables.add(this._actionRunner)),this._actionRunnerDisposables.add(this._actionRunner.onDidRun(o=>this._onDidRun.fire(o))),this._actionRunnerDisposables.add(this._actionRunner.onWillRun(o=>this._onWillRun.fire(o))),this.viewItems=[],this.focusedItem=void 0,this.domNode=document.createElement("div"),this.domNode.className="monaco-action-bar";let i,n;switch(this._orientation){case 0:i=[15],n=[17];break;case 1:i=[16],n=[18],this.domNode.className+=" vertical";break}this._register(F(this.domNode,Q.KEY_DOWN,o=>{let s=new ut(o),a=!0,l=typeof this.focusedItem=="number"?this.viewItems[this.focusedItem]:void 0;i&&(s.equals(i[0])||s.equals(i[1]))?a=this.focusPrevious():n&&(s.equals(n[0])||s.equals(n[1]))?a=this.focusNext():s.equals(9)&&this.cancelHasListener?this._onDidCancel.fire():s.equals(14)?a=this.focusFirst():s.equals(13)?a=this.focusLast():s.equals(2)&&l instanceof Yn&&l.trapsArrowNavigation?a=this.focusNext(void 0,!0):this.isTriggerKeyEvent(s)?this._triggerKeys.keyDown?this.doTrigger(s):this.triggerKeyDown=!0:a=!1,a&&(s.preventDefault(),s.stopPropagation())})),this._register(F(this.domNode,Q.KEY_UP,o=>{let s=new ut(o);this.isTriggerKeyEvent(s)?(!this._triggerKeys.keyDown&&this.triggerKeyDown&&(this.triggerKeyDown=!1,this.doTrigger(s)),s.preventDefault(),s.stopPropagation()):(s.equals(2)||s.equals(1026)||s.equals(16)||s.equals(18)||s.equals(15)||s.equals(17))&&this.updateFocusedItem()})),this.focusTracker=this._register(Er(this.domNode)),this._register(this.focusTracker.onDidBlur(()=>{(fo()===this.domNode||!$n(fo(),this.domNode))&&(this._onDidBlur.fire(),this.previouslyFocusedItem=this.focusedItem,this.focusedItem=void 0,this.triggerKeyDown=!1)})),this._register(this.focusTracker.onDidFocus(()=>this.updateFocusedItem())),this.actionsList=document.createElement("ul"),this.actionsList.className="actions-container",this.options.highlightToggledItems&&this.actionsList.classList.add("highlight-toggled"),this.actionsList.setAttribute("role",this.options.ariaRole||"toolbar"),this.options.ariaLabel&&this.actionsList.setAttribute("aria-label",this.options.ariaLabel),this.domNode.appendChild(this.actionsList),t.appendChild(this.domNode)}refreshRole(){this.length()>=1?this.actionsList.setAttribute("role",this.options.ariaRole||"toolbar"):this.actionsList.setAttribute("role","presentation")}setAriaLabel(t){t?this.actionsList.setAttribute("aria-label",t):this.actionsList.removeAttribute("aria-label")}setFocusable(t){if(this.focusable=t,this.focusable){let e=this.viewItems.find(i=>i instanceof Yn&&i.isEnabled());e instanceof Yn&&e.setFocusable(!0)}else this.viewItems.forEach(e=>{e instanceof Yn&&e.setFocusable(!1)})}isTriggerKeyEvent(t){let e=!1;return this._triggerKeys.keys.forEach(i=>{e=e||t.equals(i)}),e}updateFocusedItem(){for(let t=0;t<this.actionsList.children.length;t++){let e=this.actionsList.children[t];if($n(fo(),e)){this.focusedItem=t,this.viewItems[this.focusedItem]?.showHover?.();break}}}get context(){return this._context}set context(t){this._context=t,this.viewItems.forEach(e=>e.setActionContext(t))}get actionRunner(){return this._actionRunner}set actionRunner(t){this._actionRunner=t,this._actionRunnerDisposables.clear(),this._actionRunnerDisposables.add(this._actionRunner.onDidRun(e=>this._onDidRun.fire(e))),this._actionRunnerDisposables.add(this._actionRunner.onWillRun(e=>this._onWillRun.fire(e))),this.viewItems.forEach(e=>e.actionRunner=t)}getContainer(){return this.domNode}hasAction(t){return this.viewItems.findIndex(e=>e.action.id===t.id)!==-1}getAction(t){if(typeof t=="number")return this.viewItems[t]?.action;if(on(t)){for(;t.parentElement!==this.actionsList;){if(!t.parentElement)return;t=t.parentElement}for(let e=0;e<this.actionsList.childNodes.length;e++)if(this.actionsList.childNodes[e]===t)return this.viewItems[e].action}}push(t,e={}){let i=Array.isArray(t)?t:[t],n=cr(e.index)?e.index:null;i.forEach(o=>{let s=document.createElement("li");s.className="action-item",s.setAttribute("role","presentation");let a,l={hoverDelegate:this._hoverDelegate,...e,isTabList:this.options.ariaRole==="tablist"};this.options.actionViewItemProvider&&(a=this.options.actionViewItemProvider(o,l)),a||(a=new Kl(this.context,o,l)),this.options.allowContextMenu||this.viewItemDisposables.set(a,F(s,Q.CONTEXT_MENU,d=>{Ve.stop(d,!0)})),a.actionRunner=this._actionRunner,a.setActionContext(this.context),a.render(s),this.focusable&&a instanceof Yn&&this.viewItems.length===0&&a.setFocusable(!0),n===null||n<0||n>=this.actionsList.children.length?(this.actionsList.appendChild(s),this.viewItems.push(a)):(this.actionsList.insertBefore(s,this.actionsList.children[n]),this.viewItems.splice(n,0,a),n++)}),typeof this.focusedItem=="number"&&this.focus(this.focusedItem),this.refreshRole()}getWidth(t){if(t>=0&&t<this.actionsList.children.length){let e=this.actionsList.children.item(t);if(e)return e.clientWidth}return 0}getHeight(t){if(t>=0&&t<this.actionsList.children.length){let e=this.actionsList.children.item(t);if(e)return e.clientHeight}return 0}pull(t){t>=0&&t<this.viewItems.length&&(this.actionsList.childNodes[t].remove(),this.viewItemDisposables.deleteAndDispose(this.viewItems[t]),_e(this.viewItems.splice(t,1)),this.refreshRole())}clear(){this.isEmpty()||(this.viewItems=_e(this.viewItems),this.viewItemDisposables.clearAndDisposeAll(),ai(this.actionsList),this.refreshRole())}length(){return this.viewItems.length}isEmpty(){return this.viewItems.length===0}focus(t){let e=!1,i;if(t===void 0?e=!0:typeof t=="number"?i=t:typeof t=="boolean"&&(e=t),e&&typeof this.focusedItem>"u"){let n=this.viewItems.findIndex(o=>o.isEnabled());this.focusedItem=n===-1?void 0:n,this.updateFocus(void 0,void 0,!0)}else i!==void 0&&(this.focusedItem=i),this.updateFocus(void 0,void 0,!0)}focusFirst(){return this.focusedItem=this.length()-1,this.focusNext(!0)}focusLast(){return this.focusedItem=0,this.focusPrevious(!0)}focusNext(t,e){if(typeof this.focusedItem>"u")this.focusedItem=this.viewItems.length-1;else if(this.viewItems.length<=1)return!1;let i=this.focusedItem,n;do{if(!t&&this.options.preventLoopNavigation&&this.focusedItem+1>=this.viewItems.length)return this.focusedItem=i,!1;this.focusedItem=(this.focusedItem+1)%this.viewItems.length,n=this.viewItems[this.focusedItem]}while(this.focusedItem!==i&&(this.options.focusOnlyEnabledItems&&!n.isEnabled()||n.action.id===Qt.ID));return this.updateFocus(void 0,void 0,e),!0}focusPrevious(t){if(typeof this.focusedItem>"u")this.focusedItem=0;else if(this.viewItems.length<=1)return!1;let e=this.focusedItem,i;do{if(this.focusedItem=this.focusedItem-1,this.focusedItem<0){if(!t&&this.options.preventLoopNavigation)return this.focusedItem=e,!1;this.focusedItem=this.viewItems.length-1}i=this.viewItems[this.focusedItem]}while(this.focusedItem!==e&&(this.options.focusOnlyEnabledItems&&!i.isEnabled()||i.action.id===Qt.ID));return this.updateFocus(!0),!0}updateFocus(t,e,i=!1){typeof this.focusedItem>"u"&&this.actionsList.focus({preventScroll:e}),this.previouslyFocusedItem!==void 0&&this.previouslyFocusedItem!==this.focusedItem&&this.viewItems[this.previouslyFocusedItem]?.blur();let n=this.focusedItem!==void 0?this.viewItems[this.focusedItem]:void 0;if(n){let o=!0;Xv(n.focus)||(o=!1),this.options.focusOnlyEnabledItems&&Xv(n.isEnabled)&&!n.isEnabled()&&(o=!1),n.action.id===Qt.ID&&(o=!1),o?(i||this.previouslyFocusedItem!==this.focusedItem)&&(n.focus(t),this.previouslyFocusedItem=this.focusedItem):(this.actionsList.focus({preventScroll:e}),this.previouslyFocusedItem=void 0),o&&n.showHover?.()}}doTrigger(t){if(typeof this.focusedItem>"u")return;let e=this.viewItems[this.focusedItem];if(e instanceof Yn){let i=e._context===null||e._context===void 0?t:e._context;this.run(e._action,i)}}async run(t,e){await this._actionRunner.run(t,e)}dispose(){this._context=void 0,this.viewItems=_e(this.viewItems),this.getContainer().remove(),super.dispose()}};function Ym(r){if(!r.length)return r;let t=-1;for(let i=0;i<r.length;i++)if(r[i].id!==Qt.ID){t=i;break}if(t===-1)return[];r=r.slice(t);for(let i=r.length-1;i>=0&&r[i].id===Qt.ID;i--)r.splice(i,1);let e=!1;for(let i=r.length-1;i>=0;i--){let n=r[i].id===Qt.ID;n&&!e?r.splice(i,1):n?n&&(e=!1):e=!0}return r}var ww=class extends Xm{constructor(e,i,n,o){super(e,n,o);this.telemetryService=i}_onTitleAreaUpdate=this._register(new x);onTitleAreaUpdate=this._onTitleAreaUpdate.event;_onDidFocus;get onDidFocus(){return this._onDidFocus||(this._onDidFocus=this.registerFocusTrackEvents().onDidFocus),this._onDidFocus.event}_onDidBlur;get onDidBlur(){return this._onDidBlur||(this._onDidBlur=this.registerFocusTrackEvents().onDidBlur),this._onDidBlur.event}_hasFocus=!1;hasFocus(){return this._hasFocus}registerFocusTrackEvents(){let e=Yt(this.getContainer()),i=this._register(Er(e)),n=this._onDidFocus=this._register(new x);this._register(i.onDidFocus(()=>{this._hasFocus=!0,n.fire()}));let o=this._onDidBlur=this._register(new x);return this._register(i.onDidBlur(()=>{this._hasFocus=!1,o.fire()})),{onDidFocus:n,onDidBlur:o}}actionRunner;visible=!1;parent;getTitle(){}create(e){this.parent=e}getContainer(){return this.parent}setVisible(e){this.visible!==!!e&&(this.visible=e)}focus(){}getMenuIds(){return[]}getActions(){return[]}getSecondaryActions(){return[]}getContextMenuActions(){return[]}getActionViewItem(e,i){}getActionsContext(){return null}getActionRunner(){return this.actionRunner||(this.actionRunner=this._register(new jo)),this.actionRunner}updateTitleArea(){this._onTitleAreaUpdate.fire()}isVisible(){return this.visible}getControl(){}};var M1=class extends R{_onDidRegister=this._register(new x);onDidRegister=this._onDidRegister.event;_onDidDeregister=this._register(new x);onDidDeregister=this._onDidDeregister.event;composites=[];registerComposite(t){this.compositeById(t.id)||(this.composites.push(t),this._onDidRegister.fire(t))}deregisterComposite(t){let e=this.compositeById(t);e&&(this.composites.splice(this.composites.indexOf(e),1),this._onDidDeregister.fire(e))}getComposite(t){return this.compositeById(t)}getComposites(){return this.composites.slice(0)}compositeById(t){return this.composites.find(e=>e.id===t)}};var $Se={separatorBorder:j.transparent};var A1=class{constructor(t,e,i,n){this.container=t;this.view=e;this.disposable=n;typeof i=="number"?(this._size=i,this._cachedVisibleSize=void 0,t.classList.add("visible")):(this._size=0,this._cachedVisibleSize=i.cachedVisibleSize)}_size;set size(t){this._size=t}get size(){return this._size}_cachedVisibleSize=void 0;get cachedVisibleSize(){return this._cachedVisibleSize}get visible(){return typeof this._cachedVisibleSize>"u"}setVisible(t,e){if(t!==this.visible){t?(this.size=pn(this._cachedVisibleSize,this.viewMinimumSize,this.viewMaximumSize),this._cachedVisibleSize=void 0):(this._cachedVisibleSize=typeof e=="number"?e:this.size,this.size=0),this.container.classList.toggle("visible",t);try{this.view.setVisible?.(t)}catch(i){console.error("Splitview: Failed to set visible view"),console.error(i)}}}get minimumSize(){return this.visible?this.view.minimumSize:0}get viewMinimumSize(){return this.view.minimumSize}get maximumSize(){return this.visible?this.view.maximumSize:0}get viewMaximumSize(){return this.view.maximumSize}get priority(){return this.view.priority}get proportionalLayout(){return this.view.proportionalLayout??!0}get snap(){return!!this.view.snap}set enabled(t){this.container.style.pointerEvents=t?"":"none"}layout(t,e){this.layoutContainer(t);try{this.view.layout(this.size,t,e)}catch(i){console.error("Splitview: Failed to layout view"),console.error(i)}}dispose(){this.disposable.dispose()}},k7=class extends A1{layoutContainer(t){this.container.style.top=`${t}px`,this.container.style.height=`${this.size}px`}},L7=class extends A1{layoutContainer(t){this.container.style.left=`${t}px`,this.container.style.width=`${this.size}px`}};var Rd;(n=>{n.Distribute={type:"distribute"};function t(o){return{type:"split",index:o}}n.Split=t;function e(o){return{type:"auto",index:o}}n.Auto=e;function i(o){return{type:"invisible",cachedVisibleSize:o}}n.Invisible=i})(Rd||={});var wc=class extends R{orientation;el;sashContainer;viewContainer;scrollable;scrollableElement;size=0;layoutContext;_contentSize=0;proportions=void 0;viewItems=[];sashItems=[];sashDragState;state=0;inverseAltBehavior;proportionalLayout;getSashOrthogonalSize;_onDidSashChange=this._register(new x);_onDidSashReset=this._register(new x);_orthogonalStartSash;_orthogonalEndSash;_startSnappingEnabled=!0;_endSnappingEnabled=!0;get contentSize(){return this._contentSize}onDidSashChange=this._onDidSashChange.event;onDidSashReset=this._onDidSashReset.event;onDidScroll;get length(){return this.viewItems.length}get minimumSize(){return this.viewItems.reduce((t,e)=>t+e.minimumSize,0)}get maximumSize(){return this.length===0?Number.POSITIVE_INFINITY:this.viewItems.reduce((t,e)=>t+e.maximumSize,0)}get orthogonalStartSash(){return this._orthogonalStartSash}get orthogonalEndSash(){return this._orthogonalEndSash}get startSnappingEnabled(){return this._startSnappingEnabled}get endSnappingEnabled(){return this._endSnappingEnabled}set orthogonalStartSash(t){for(let e of this.sashItems)e.sash.orthogonalStartSash=t;this._orthogonalStartSash=t}set orthogonalEndSash(t){for(let e of this.sashItems)e.sash.orthogonalEndSash=t;this._orthogonalEndSash=t}get sashes(){return this.sashItems.map(t=>t.sash)}set startSnappingEnabled(t){this._startSnappingEnabled!==t&&(this._startSnappingEnabled=t,this.updateSashEnablement())}set endSnappingEnabled(t){this._endSnappingEnabled!==t&&(this._endSnappingEnabled=t,this.updateSashEnablement())}constructor(t,e={}){super(),this.orientation=e.orientation??0,this.inverseAltBehavior=e.inverseAltBehavior??!1,this.proportionalLayout=e.proportionalLayout??!0,this.getSashOrthogonalSize=e.getSashOrthogonalSize,this.el=document.createElement("div"),this.el.classList.add("monaco-split-view2"),this.el.classList.add(this.orientation===0?"vertical":"horizontal"),t.appendChild(this.el),this.sashContainer=U(this.el,J(".sash-container")),this.viewContainer=J(".split-view-container"),this.scrollable=this._register(new iu({forceIntegerValues:!0,smoothScrollDuration:125,scheduleAtNextAnimationFrame:n=>eo(ue(this.el),n)})),this.scrollableElement=this._register(new Yf(this.viewContainer,{vertical:this.orientation===0?e.scrollbarVisibility??1:2,horizontal:this.orientation===1?e.scrollbarVisibility??1:2},this.scrollable));let i=this._register(new lt(this.viewContainer,"scroll")).event;this._register(i(n=>{let o=this.scrollableElement.getScrollPosition(),s=Math.abs(this.viewContainer.scrollLeft-o.scrollLeft)<=1?void 0:this.viewContainer.scrollLeft,a=Math.abs(this.viewContainer.scrollTop-o.scrollTop)<=1?void 0:this.viewContainer.scrollTop;(s!==void 0||a!==void 0)&&this.scrollableElement.setScrollPosition({scrollLeft:s,scrollTop:a})})),this.onDidScroll=this.scrollableElement.onScroll,this._register(this.onDidScroll(n=>{n.scrollTopChanged&&(this.viewContainer.scrollTop=n.scrollTop),n.scrollLeftChanged&&(this.viewContainer.scrollLeft=n.scrollLeft)})),U(this.el,this.scrollableElement.getDomNode()),this.style(e.styles||$Se),e.descriptor&&(this.size=e.descriptor.size,e.descriptor.views.forEach((n,o)=>{let s=Vn(n.visible)||n.visible?n.size:{type:"invisible",cachedVisibleSize:n.size},a=n.view;this.doAddView(a,s,o,!0)}),this._contentSize=this.viewItems.reduce((n,o)=>n+o.size,0),this.saveProportions())}style(t){t.separatorBorder.isTransparent()?(this.el.classList.remove("separator-border"),this.el.style.removeProperty("--separator-border")):(this.el.classList.add("separator-border"),this.el.style.setProperty("--separator-border",t.separatorBorder.toString()))}addView(t,e,i=this.viewItems.length,n){this.doAddView(t,e,i,n)}removeView(t,e){if(t<0||t>=this.viewItems.length)throw new Error("Index out of bounds");if(this.state!==0)throw new Error("Cant modify splitview");this.state=1;try{e?.type==="auto"&&(this.areViewsDistributed()?e={type:"distribute"}:e={type:"split",index:e.index});let i=e?.type==="split"?this.viewItems[e.index]:void 0,n=this.viewItems.splice(t,1)[0];if(i&&(i.size+=n.size),this.viewItems.length>=1){let s=Math.max(t-1,0);this.sashItems.splice(s,1)[0].disposable.dispose()}this.relayout(),e?.type==="distribute"&&this.distributeViewSizes();let o=n.view;return n.dispose(),o}finally{this.state=0}}removeAllViews(){if(this.state!==0)throw new Error("Cant modify splitview");this.state=1;try{let t=this.viewItems.splice(0,this.viewItems.length);for(let i of t)i.dispose();let e=this.sashItems.splice(0,this.sashItems.length);for(let i of e)i.disposable.dispose();return this.relayout(),t.map(i=>i.view)}finally{this.state=0}}moveView(t,e){if(this.state!==0)throw new Error("Cant modify splitview");let i=this.getViewCachedVisibleSize(t),n=typeof i>"u"?this.getViewSize(t):Rd.Invisible(i),o=this.removeView(t);this.addView(o,n,e)}swapViews(t,e){if(this.state!==0)throw new Error("Cant modify splitview");if(t>e)return this.swapViews(e,t);let i=this.getViewSize(t),n=this.getViewSize(e),o=this.removeView(e),s=this.removeView(t);this.addView(o,i,t),this.addView(s,n,e)}isViewVisible(t){if(t<0||t>=this.viewItems.length)throw new Error("Index out of bounds");return this.viewItems[t].visible}setViewVisible(t,e){if(t<0||t>=this.viewItems.length)throw new Error("Index out of bounds");this.viewItems[t].setVisible(e),this.distributeEmptySpace(t),this.layoutViews(),this.saveProportions()}getViewCachedVisibleSize(t){if(t<0||t>=this.viewItems.length)throw new Error("Index out of bounds");return this.viewItems[t].cachedVisibleSize}layout(t,e){let i=Math.max(this.size,this._contentSize);if(this.size=t,this.layoutContext=e,this.proportions){let n=0;for(let o=0;o<this.viewItems.length;o++){let s=this.viewItems[o],a=this.proportions[o];typeof a=="number"?n+=a:t-=s.size}for(let o=0;o<this.viewItems.length;o++){let s=this.viewItems[o],a=this.proportions[o];typeof a=="number"&&n>0&&(s.size=pn(Math.round(a*t/n),s.minimumSize,s.maximumSize))}}else{let n=yr(this.viewItems.length),o=n.filter(a=>this.viewItems[a].priority===1),s=n.filter(a=>this.viewItems[a].priority===2);this.resize(this.viewItems.length-1,t-i,void 0,o,s)}this.distributeEmptySpace(),this.layoutViews()}saveProportions(){this.proportionalLayout&&this._contentSize>0&&(this.proportions=this.viewItems.map(t=>t.proportionalLayout&&t.visible?t.size/this._contentSize:void 0))}onSashStart({sash:t,start:e,alt:i}){for(let a of this.viewItems)a.enabled=!1;let n=this.sashItems.findIndex(a=>a.sash===t),o=In(F(this.el.ownerDocument.body,"keydown",a=>s(this.sashDragState.current,a.altKey)),F(this.el.ownerDocument.body,"keyup",()=>s(this.sashDragState.current,!1))),s=(a,l)=>{let d=this.viewItems.map(f=>f.size),c=Number.NEGATIVE_INFINITY,p=Number.POSITIVE_INFINITY;if(this.inverseAltBehavior&&(l=!l),l)if(n===this.sashItems.length-1){let g=this.viewItems[n];c=(g.minimumSize-g.size)/2,p=(g.maximumSize-g.size)/2}else{let g=this.viewItems[n+1];c=(g.size-g.maximumSize)/2,p=(g.size-g.minimumSize)/2}let h,m;if(!l){let f=yr(n,-1),g=yr(n+1,this.viewItems.length),v=f.reduce((M,O)=>M+(this.viewItems[O].minimumSize-d[O]),0),I=f.reduce((M,O)=>M+(this.viewItems[O].viewMaximumSize-d[O]),0),y=g.length===0?Number.POSITIVE_INFINITY:g.reduce((M,O)=>M+(d[O]-this.viewItems[O].minimumSize),0),w=g.length===0?Number.NEGATIVE_INFINITY:g.reduce((M,O)=>M+(d[O]-this.viewItems[O].viewMaximumSize),0),C=Math.max(v,w),S=Math.min(y,I),D=this.findFirstSnapIndex(f),k=this.findFirstSnapIndex(g);if(typeof D=="number"){let M=this.viewItems[D],O=Math.floor(M.viewMinimumSize/2);h={index:D,limitDelta:M.visible?C-O:C+O,size:M.size}}if(typeof k=="number"){let M=this.viewItems[k],O=Math.floor(M.viewMinimumSize/2);m={index:k,limitDelta:M.visible?S+O:S-O,size:M.size}}}this.sashDragState={start:a,current:a,index:n,sizes:d,minDelta:c,maxDelta:p,alt:l,snapBefore:h,snapAfter:m,disposable:o}};s(e,i)}onSashChange({current:t}){let{index:e,start:i,sizes:n,alt:o,minDelta:s,maxDelta:a,snapBefore:l,snapAfter:d}=this.sashDragState;this.sashDragState.current=t;let c=t-i,p=this.resize(e,c,n,void 0,void 0,s,a,l,d);if(o){let h=e===this.sashItems.length-1,m=this.viewItems.map(w=>w.size),f=h?e:e+1,g=this.viewItems[f],v=g.size-g.maximumSize,I=g.size-g.minimumSize,y=h?e-1:e+1;this.resize(y,-p,m,void 0,void 0,v,I)}this.distributeEmptySpace(),this.layoutViews()}onSashEnd(t){this._onDidSashChange.fire(t),this.sashDragState.disposable.dispose(),this.saveProportions();for(let e of this.viewItems)e.enabled=!0}onViewChange(t,e){let i=this.viewItems.indexOf(t);i<0||i>=this.viewItems.length||(e=typeof e=="number"?e:t.size,e=pn(e,t.minimumSize,t.maximumSize),this.inverseAltBehavior&&i>0?(this.resize(i-1,Math.floor((t.size-e)/2)),this.distributeEmptySpace(),this.layoutViews()):(t.size=e,this.relayout([i],void 0)))}resizeView(t,e){if(!(t<0||t>=this.viewItems.length)){if(this.state!==0)throw new Error("Cant modify splitview");this.state=1;try{let i=yr(this.viewItems.length).filter(a=>a!==t),n=[...i.filter(a=>this.viewItems[a].priority===1),t],o=i.filter(a=>this.viewItems[a].priority===2),s=this.viewItems[t];e=Math.round(e),e=pn(e,s.minimumSize,Math.min(s.maximumSize,this.size)),s.size=e,this.relayout(n,o)}finally{this.state=0}}}isViewExpanded(t){if(t<0||t>=this.viewItems.length)return!1;for(let e of this.viewItems)if(e!==this.viewItems[t]&&e.size>e.minimumSize)return!1;return!0}distributeViewSizes(){let t=[],e=0;for(let a of this.viewItems)a.maximumSize-a.minimumSize>0&&(t.push(a),e+=a.size);let i=Math.floor(e/t.length);for(let a of t)a.size=pn(i,a.minimumSize,a.maximumSize);let n=yr(this.viewItems.length),o=n.filter(a=>this.viewItems[a].priority===1),s=n.filter(a=>this.viewItems[a].priority===2);this.relayout(o,s)}getViewSize(t){return t<0||t>=this.viewItems.length?-1:this.viewItems[t].size}doAddView(t,e,i=this.viewItems.length,n){if(this.state!==0)throw new Error("Cant modify splitview");this.state=1;try{let o=J(".split-view-view");i===this.viewItems.length?this.viewContainer.appendChild(o):this.viewContainer.insertBefore(o,this.viewContainer.children.item(i));let s=t.onDidChange(h=>this.onViewChange(c,h)),a=le(()=>o.remove()),l=In(s,a),d;typeof e=="number"?d=e:(e.type==="auto"&&(this.areViewsDistributed()?e={type:"distribute"}:e={type:"split",index:e.index}),e.type==="split"?d=this.getViewSize(e.index)/2:e.type==="invisible"?d={cachedVisibleSize:e.cachedVisibleSize}:d=t.minimumSize);let c=this.orientation===0?new k7(o,t,d,l):new L7(o,t,d,l);if(this.viewItems.splice(i,0,c),this.viewItems.length>1){let h={orthogonalStartSash:this.orthogonalStartSash,orthogonalEndSash:this.orthogonalEndSash},m=this.orientation===0?new xl(this.sashContainer,{getHorizontalSashTop:M=>this.getSashPosition(M),getHorizontalSashWidth:this.getSashOrthogonalSize},{...h,orientation:1}):new xl(this.sashContainer,{getVerticalSashLeft:M=>this.getSashPosition(M),getVerticalSashHeight:this.getSashOrthogonalSize},{...h,orientation:0}),f=this.orientation===0?M=>({sash:m,start:M.startY,current:M.currentY,alt:M.altKey}):M=>({sash:m,start:M.startX,current:M.currentX,alt:M.altKey}),v=X.map(m.onDidStart,f)(this.onSashStart,this),y=X.map(m.onDidChange,f)(this.onSashChange,this),C=X.map(m.onDidEnd,()=>this.sashItems.findIndex(M=>M.sash===m))(this.onSashEnd,this),S=m.onDidReset(()=>{let M=this.sashItems.findIndex(ge=>ge.sash===m),O=yr(M,-1),K=yr(M+1,this.viewItems.length),G=this.findFirstSnapIndex(O),Y=this.findFirstSnapIndex(K);typeof G=="number"&&!this.viewItems[G].visible||typeof Y=="number"&&!this.viewItems[Y].visible||this._onDidSashReset.fire(M)}),D=In(v,y,C,S,m),k={sash:m,disposable:D};this.sashItems.splice(i-1,0,k)}o.appendChild(t.element);let p;typeof e!="number"&&e.type==="split"&&(p=[e.index]),n||this.relayout([i],p),!n&&typeof e!="number"&&e.type==="distribute"&&this.distributeViewSizes()}finally{this.state=0}}relayout(t,e){let i=this.viewItems.reduce((n,o)=>n+o.size,0);this.resize(this.viewItems.length-1,this.size-i,void 0,t,e),this.distributeEmptySpace(),this.layoutViews(),this.saveProportions()}resize(t,e,i=this.viewItems.map(c=>c.size),n,o,s=Number.NEGATIVE_INFINITY,a=Number.POSITIVE_INFINITY,l,d){if(t<0||t>=this.viewItems.length)return 0;let c=yr(t,-1),p=yr(t+1,this.viewItems.length);if(o)for(let k of o)KM(c,k),KM(p,k);if(n)for(let k of n)T_(c,k),T_(p,k);let h=c.map(k=>this.viewItems[k]),m=c.map(k=>i[k]),f=p.map(k=>this.viewItems[k]),g=p.map(k=>i[k]),v=c.reduce((k,M)=>k+(this.viewItems[M].minimumSize-i[M]),0),I=c.reduce((k,M)=>k+(this.viewItems[M].maximumSize-i[M]),0),y=p.length===0?Number.POSITIVE_INFINITY:p.reduce((k,M)=>k+(i[M]-this.viewItems[M].minimumSize),0),w=p.length===0?Number.NEGATIVE_INFINITY:p.reduce((k,M)=>k+(i[M]-this.viewItems[M].maximumSize),0),C=Math.max(v,w,s),S=Math.min(y,I,a),D=!1;if(l){let k=this.viewItems[l.index],M=e>=l.limitDelta;D=M!==k.visible,k.setVisible(M,l.size)}if(!D&&d){let k=this.viewItems[d.index],M=e<d.limitDelta;D=M!==k.visible,k.setVisible(M,d.size)}if(D)return this.resize(t,e,i,n,o,s,a);e=pn(e,C,S);for(let k=0,M=e;k<h.length;k++){let O=h[k],K=pn(m[k]+M,O.minimumSize,O.maximumSize),G=K-m[k];M-=G,O.size=K}for(let k=0,M=e;k<f.length;k++){let O=f[k],K=pn(g[k]-M,O.minimumSize,O.maximumSize),G=K-g[k];M+=G,O.size=K}return e}distributeEmptySpace(t){let e=this.viewItems.reduce((a,l)=>a+l.size,0),i=this.size-e,n=yr(this.viewItems.length-1,-1),o=n.filter(a=>this.viewItems[a].priority===1),s=n.filter(a=>this.viewItems[a].priority===2);for(let a of s)KM(n,a);for(let a of o)T_(n,a);typeof t=="number"&&T_(n,t);for(let a=0;i!==0&&a<n.length;a++){let l=this.viewItems[n[a]],d=pn(l.size+i,l.minimumSize,l.maximumSize),c=d-l.size;i-=c,l.size=d}}layoutViews(){this._contentSize=this.viewItems.reduce((e,i)=>e+i.size,0);let t=0;for(let e of this.viewItems)e.layout(t,this.layoutContext),t+=e.size;this.sashItems.forEach(e=>e.sash.layout()),this.updateSashEnablement(),this.updateScrollableElement()}updateScrollableElement(){this.orientation===0?this.scrollableElement.setScrollDimensions({height:this.size,scrollHeight:this._contentSize}):this.scrollableElement.setScrollDimensions({width:this.size,scrollWidth:this._contentSize})}updateSashEnablement(){let t=!1,e=this.viewItems.map(l=>t=l.size-l.minimumSize>0||t);t=!1;let i=this.viewItems.map(l=>t=l.maximumSize-l.size>0||t),n=[...this.viewItems].reverse();t=!1;let o=n.map(l=>t=l.size-l.minimumSize>0||t).reverse();t=!1;let s=n.map(l=>t=l.maximumSize-l.size>0||t).reverse(),a=0;for(let l=0;l<this.sashItems.length;l++){let{sash:d}=this.sashItems[l],c=this.viewItems[l];a+=c.size;let p=!(e[l]&&s[l+1]),h=!(i[l]&&o[l+1]);if(p&&h){let m=yr(l,-1),f=yr(l+1,this.viewItems.length),g=this.findFirstSnapIndex(m),v=this.findFirstSnapIndex(f),I=typeof g=="number"&&!this.viewItems[g].visible,y=typeof v=="number"&&!this.viewItems[v].visible;I&&o[l]&&(a>0||this.startSnappingEnabled)?d.state=1:y&&e[l]&&(a<this._contentSize||this.endSnappingEnabled)?d.state=2:d.state=0}else p&&!h?d.state=1:!p&&h?d.state=2:d.state=3}}getSashPosition(t){let e=0;for(let i=0;i<this.sashItems.length;i++)if(e+=this.viewItems[i].size,this.sashItems[i].sash===t)return e;return 0}findFirstSnapIndex(t){for(let e of t){let i=this.viewItems[e];if(i.visible&&i.snap)return e}for(let e of t){let i=this.viewItems[e];if(i.visible&&i.maximumSize-i.minimumSize>0)return;if(!i.visible&&i.snap)return e}}areViewsDistributed(){let t,e;for(let i of this.viewItems)if(t=t===void 0?i.size:Math.min(t,i.size),e=e===void 0?i.size:Math.max(e,i.size),e-t>2)return!1;return!0}dispose(){this.sashDragState?.disposable.dispose(),_e(this.viewItems),this.viewItems=[],this.sashItems.forEach(t=>t.disposable.dispose()),this.sashItems=[],super.dispose()}};var rOt={separatorBorder:j.transparent};var XSe;(n=>{n.Distribute={type:"distribute"},n.Split={type:"split"},n.Auto={type:"auto"};function i(o){return{type:"invisible",cachedVisibleSize:o}}n.Invisible=i})(XSe||={});async function Sae(r){let t=navigator.usb;if(!t)return;let e=await t.requestDevice({filters:r?.filters??[]});if(e)return{deviceClass:e.deviceClass,deviceProtocol:e.deviceProtocol,deviceSubclass:e.deviceSubclass,deviceVersionMajor:e.deviceVersionMajor,deviceVersionMinor:e.deviceVersionMinor,deviceVersionSubminor:e.deviceVersionSubminor,manufacturerName:e.manufacturerName,productId:e.productId,productName:e.productName,serialNumber:e.serialNumber,usbVersionMajor:e.usbVersionMajor,usbVersionMinor:e.usbVersionMinor,usbVersionSubminor:e.usbVersionSubminor,vendorId:e.vendorId}}async function Cae(r){let t=navigator.serial;if(!t)return;let e=await t.requestPort({filters:r?.filters??[]});if(!e)return;let i=e.getInfo();return{usbVendorId:i.usbVendorId,usbProductId:i.usbProductId}}async function wae(r){let t=navigator.hid;if(!t)return;let e=await t.requestDevice({filters:r?.filters??[]});if(!e.length)return;let i=e[0];return{opened:i.opened,vendorId:i.vendorId,productId:i.productId,productName:i.productName,collections:i.collections}}var Yi=q("openerService");function O1(r){let t,e=/^L?(\d+)(?:,(\d+))?(-L?(\d+)(?:,(\d+))?)?/.exec(r.fragment);return e&&(t={startLineNumber:parseInt(e[1]),startColumn:e[2]?parseInt(e[2]):1,endLineNumber:e[4]?parseInt(e[4]):void 0,endColumn:e[4]?e[5]?parseInt(e[5]):1:void 0},r=r.with({fragment:""})),{selection:t,uri:r}}var Jo=$o;var YSe=60,QSe=YSe*60,P7=QSe*24,XOt=P7*7,YOt=P7*30,QOt=P7*365;function Eae(r){return r.getFullYear()+"-"+String(r.getMonth()+1).padStart(2,"0")+"-"+String(r.getDate()).padStart(2,"0")+"T"+String(r.getHours()).padStart(2,"0")+":"+String(r.getMinutes()).padStart(2,"0")+":"+String(r.getSeconds()).padStart(2,"0")+"."+(r.getMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}var jk=/^([^.]+\..+)[:=](.+)$/,xn=class{constructor(t,e,i){this._args=t;this.paths=e;this.productService=i}get appRoot(){return zg(Ao.asFileUri("").fsPath)}get userHome(){return Z.file(this.paths.homeDir)}get userDataPath(){return this.paths.userDataDir}get appSettingsHome(){return Z.file(cs(this.userDataPath,"User"))}get tmpDir(){return Z.file(this.paths.tmpDir)}get cacheHome(){return Z.file(this.userDataPath)}get stateResource(){return pi(this.appSettingsHome,"globalStorage","storage.json")}get userRoamingDataHome(){return this.appSettingsHome.with({scheme:Ie.vscodeUserData})}get userDataSyncHome(){return pi(this.appSettingsHome,"sync")}get logsHome(){if(!this.args.logsPath){let t=Eae(new Date).replace(/-|:|\.\d+Z$/g,"");this.args.logsPath=cs(this.userDataPath,"logs",t)}return Z.file(this.args.logsPath)}get sync(){return this.args.sync}get machineSettingsResource(){return pi(Z.file(cs(this.userDataPath,"Machine")),"settings.json")}get workspaceStorageHome(){return pi(this.appSettingsHome,"workspaceStorage")}get localHistoryHome(){return pi(this.appSettingsHome,"History")}get keyboardLayoutResource(){return pi(this.userRoamingDataHome,"keyboardLayout.json")}get argvResource(){let t=oc.VSCODE_PORTABLE;return t?Z.file(cs(t,"argv.json")):pi(this.userHome,this.productService.dataFolderName,"argv.json")}get isExtensionDevelopment(){return!!this.args.extensionDevelopmentPath}get untitledWorkspacesHome(){return Z.file(cs(this.userDataPath,"Workspaces"))}get builtinExtensionsPath(){let t=this.args["builtin-extensions-dir"];return t?ES(t):ds(cs(Ao.asFileUri("").fsPath,"..","extensions"))}get extensionsDownloadLocation(){let t=this.args["extensions-download-dir"];return t?Z.file(ES(t)):Z.file(cs(this.userDataPath,"CachedExtensionVSIXs"))}get extensionsPath(){let t=this.args["extensions-dir"];if(t)return ES(t);let e=oc.VSCODE_EXTENSIONS;if(e)return e;let i=oc.VSCODE_PORTABLE;return i?cs(i,"extensions"):pi(this.userHome,this.productService.dataFolderName,"extensions").fsPath}get extensionDevelopmentLocationURI(){let t=this.args.extensionDevelopmentPath;if(Array.isArray(t))return t.map(e=>/^[^:/?#]+?:\/\//.test(e)?Z.parse(e):Z.file(ds(e)))}get extensionDevelopmentKind(){return this.args.extensionDevelopmentKind?.map(t=>t==="ui"||t==="workspace"||t==="web"?t:"workspace")}get extensionTestsLocationURI(){let t=this.args.extensionTestsPath;if(t)return/^[^:/?#]+?:\/\//.test(t)?Z.parse(t):Z.file(ds(t))}get disableExtensions(){if(this.args["disable-extensions"])return!0;let t=this.args["disable-extension"];if(t){if(typeof t=="string")return[t];if(Array.isArray(t)&&t.length>0)return t}return!1}get debugExtensionHost(){return ZSe(this.args,this.isBuilt)}get debugRenderer(){return!!this.args.debugRenderer}get isBuilt(){return!oc.VSCODE_DEV}get verbose(){return!!this.args.verbose}get logLevel(){return this.args.log?.find(t=>!jk.test(t))}get extensionLogLevel(){let t=[];for(let e of this.args.log||[]){let i=jk.exec(e);i&&i[1]&&i[2]&&t.push([i[1],i[2]])}return t.length?t:void 0}get serviceMachineIdResource(){return pi(Z.file(this.userDataPath),"machineid")}get crashReporterId(){return this.args["crash-reporter-id"]}get crashReporterDirectory(){return this.args["crash-reporter-directory"]}get disableTelemetry(){return!!this.args["disable-telemetry"]}get disableWorkspaceTrust(){return!!this.args["disable-workspace-trust"]}get useInMemorySecretStorage(){return!!this.args["use-inmemory-secretstorage"]}get policyFile(){if(this.args["__enable-file-policy"]){let t=oc.VSCODE_PORTABLE;return t?Z.file(cs(t,"policy.json")):pi(this.userHome,this.productService.dataFolderName,"policy.json")}}editSessionId=this.args.editSessionId;get continueOn(){return this.args.continueOn}set continueOn(t){this.args.continueOn=t}get args(){return this._args}};E([Re],xn.prototype,"appRoot",1),E([Re],xn.prototype,"userHome",1),E([Re],xn.prototype,"userDataPath",1),E([Re],xn.prototype,"appSettingsHome",1),E([Re],xn.prototype,"tmpDir",1),E([Re],xn.prototype,"cacheHome",1),E([Re],xn.prototype,"stateResource",1),E([Re],xn.prototype,"userRoamingDataHome",1),E([Re],xn.prototype,"userDataSyncHome",1),E([Re],xn.prototype,"sync",1),E([Re],xn.prototype,"machineSettingsResource",1),E([Re],xn.prototype,"workspaceStorageHome",1),E([Re],xn.prototype,"localHistoryHome",1),E([Re],xn.prototype,"keyboardLayoutResource",1),E([Re],xn.prototype,"argvResource",1),E([Re],xn.prototype,"isExtensionDevelopment",1),E([Re],xn.prototype,"untitledWorkspacesHome",1),E([Re],xn.prototype,"builtinExtensionsPath",1),E([Re],xn.prototype,"extensionsPath",1),E([Re],xn.prototype,"extensionDevelopmentLocationURI",1),E([Re],xn.prototype,"extensionDevelopmentKind",1),E([Re],xn.prototype,"extensionTestsLocationURI",1),E([Re],xn.prototype,"debugExtensionHost",1),E([Re],xn.prototype,"logLevel",1),E([Re],xn.prototype,"extensionLogLevel",1),E([Re],xn.prototype,"serviceMachineIdResource",1),E([Re],xn.prototype,"disableTelemetry",1),E([Re],xn.prototype,"disableWorkspaceTrust",1),E([Re],xn.prototype,"useInMemorySecretStorage",1),E([Re],xn.prototype,"policyFile",1);function ZSe(r,t){return JSe(r["inspect-extensions"],r["inspect-brk-extensions"],5870,t,r.debugId,r.extensionEnvironment)}function JSe(r,t,e,i,n,o){let a=Number(t||r)||(i?null:e),l=a?!!t:!1,d;if(o)try{d=JSON.parse(o)}catch{}return{port:a,break:l,debugId:n,env:d}}var ih=$o,Di=class{constructor(t,e,i,n){this.workspaceId=t;this.logsHome=e;this.options=i;this.productService=n;if(i.workspaceProvider&&Array.isArray(i.workspaceProvider.payload))try{this.payload=new Map(i.workspaceProvider.payload)}catch(o){Xe(o)}}get remoteAuthority(){return this.options.remoteAuthority}get expectsResolverExtension(){return!!this.options.remoteAuthority?.includes("+")&&!this.options.webSocketFactory}get isBuilt(){return!!this.productService.commit}get logLevel(){let t=this.payload?.get("logLevel");return t?t.split(",").find(e=>!jk.test(e)):this.options.developmentOptions?.logLevel!==void 0?G0(this.options.developmentOptions?.logLevel):void 0}get extensionLogLevel(){let t=this.payload?.get("logLevel");if(t){let e=[];for(let i of t.split(",")){let n=jk.exec(i);n&&n[1]&&n[2]&&e.push([n[1],n[2]])}return e.length?e:void 0}return this.options.developmentOptions?.extensionLogLevel!==void 0?this.options.developmentOptions?.extensionLogLevel.map(([e,i])=>[e,G0(i)]):void 0}get profDurationMarkers(){let t=this.payload?.get("profDurationMarkers");if(t){let e=[];for(let i of t.split(","))e.push(i);return e.length===2?e:void 0}}get windowLogsPath(){return this.logsHome}get logFile(){return pi(this.windowLogsPath,"window.log")}get userRoamingDataHome(){return Z.file("/User").with({scheme:Ie.vscodeUserData})}get argvResource(){return pi(this.userRoamingDataHome,"argv.json")}get cacheHome(){return pi(this.userRoamingDataHome,"caches")}get workspaceStorageHome(){return pi(this.userRoamingDataHome,"workspaceStorage")}get localHistoryHome(){return pi(this.userRoamingDataHome,"History")}get stateResource(){return pi(this.userRoamingDataHome,"State","storage.json")}get userDataSyncHome(){return pi(this.userRoamingDataHome,"sync",this.workspaceId)}get sync(){}get keyboardLayoutResource(){return pi(this.userRoamingDataHome,"keyboardLayout.json")}get untitledWorkspacesHome(){return pi(this.userRoamingDataHome,"Workspaces")}get serviceMachineIdResource(){return pi(this.userRoamingDataHome,"machineid")}get extHostLogsPath(){return pi(this.logsHome,"exthost")}get extHostTelemetryLogFile(){return pi(this.extHostLogsPath,"extensionTelemetry.log")}extensionHostDebugEnvironment=void 0;get debugExtensionHost(){return this.extensionHostDebugEnvironment||(this.extensionHostDebugEnvironment=this.resolveExtensionHostDebugEnvironment()),this.extensionHostDebugEnvironment.params}get isExtensionDevelopment(){return this.extensionHostDebugEnvironment||(this.extensionHostDebugEnvironment=this.resolveExtensionHostDebugEnvironment()),this.extensionHostDebugEnvironment.isExtensionDevelopment}get extensionDevelopmentLocationURI(){return this.extensionHostDebugEnvironment||(this.extensionHostDebugEnvironment=this.resolveExtensionHostDebugEnvironment()),this.extensionHostDebugEnvironment.extensionDevelopmentLocationURI}get extensionDevelopmentLocationKind(){return this.extensionHostDebugEnvironment||(this.extensionHostDebugEnvironment=this.resolveExtensionHostDebugEnvironment()),this.extensionHostDebugEnvironment.extensionDevelopmentKind}get extensionTestsLocationURI(){return this.extensionHostDebugEnvironment||(this.extensionHostDebugEnvironment=this.resolveExtensionHostDebugEnvironment()),this.extensionHostDebugEnvironment.extensionTestsLocationURI}get extensionEnabledProposedApi(){return this.extensionHostDebugEnvironment||(this.extensionHostDebugEnvironment=this.resolveExtensionHostDebugEnvironment()),this.extensionHostDebugEnvironment.extensionEnabledProposedApi}get debugRenderer(){return this.extensionHostDebugEnvironment||(this.extensionHostDebugEnvironment=this.resolveExtensionHostDebugEnvironment()),this.extensionHostDebugEnvironment.debugRenderer}get enableSmokeTestDriver(){return this.options.developmentOptions?.enableSmokeTestDriver}get disableExtensions(){return this.payload?.get("disableExtensions")==="true"}get enableExtensions(){return this.options.enabledExtensions}get webviewExternalEndpoint(){let t=this.options.webviewEndpoint||this.productService.webviewContentExternalBaseUrlTemplate||"https://{{uuid}}.vscode-cdn.net/{{quality}}/{{commit}}/out/vs/workbench/contrib/webview/browser/pre/",e=this.payload?.get("webviewExternalEndpointCommit");return t.replace("{{commit}}",e??this.productService.commit??"ef65ac1ba57f57f2a3961bfe94aa20481caca4c6").replace("{{quality}}",(e?"insider":this.productService.quality)??"insider")}get extensionTelemetryLogResource(){return pi(this.logsHome,"extensionTelemetry.log")}get disableTelemetry(){return!1}get verbose(){return this.payload?.get("verbose")==="true"}get logExtensionHostCommunication(){return this.payload?.get("logExtensionHostCommunication")==="true"}get skipReleaseNotes(){return this.payload?.get("skipReleaseNotes")==="true"}get skipWelcome(){return this.payload?.get("skipWelcome")==="true"}get disableWorkspaceTrust(){return!this.options.enableWorkspaceTrust}get profile(){return this.payload?.get("profile")}editSessionId=this.options.editSessionId;payload;resolveExtensionHostDebugEnvironment(){let t={params:{port:null,break:!1},debugRenderer:!1,isExtensionDevelopment:!1,extensionDevelopmentLocationURI:void 0,extensionDevelopmentKind:void 0};if(this.payload)for(let[i,n]of this.payload)switch(i){case"extensionDevelopmentPath":t.extensionDevelopmentLocationURI||(t.extensionDevelopmentLocationURI=[]),t.extensionDevelopmentLocationURI.push(Z.parse(n)),t.isExtensionDevelopment=!0;break;case"extensionDevelopmentKind":t.extensionDevelopmentKind=[n];break;case"extensionTestsPath":t.extensionTestsLocationURI=Z.parse(n);break;case"debugRenderer":t.debugRenderer=n==="true";break;case"debugId":t.params.debugId=n;break;case"inspect-brk-extensions":t.params.port=parseInt(n),t.params.break=!0;break;case"inspect-extensions":t.params.port=parseInt(n);break;case"enableProposedApi":t.extensionEnabledProposedApi=[];break}let e=this.options.developmentOptions;return e&&!t.isExtensionDevelopment&&(e.extensions?.length&&(t.extensionDevelopmentLocationURI=e.extensions.map(i=>Z.revive(i)),t.isExtensionDevelopment=!0),e.extensionTestsPath&&(t.extensionTestsLocationURI=Z.revive(e.extensionTestsPath))),t}get filesToOpenOrCreate(){if(this.payload){let t=this.payload.get("openFile");if(t){let e=Z.parse(t);if(this.payload.has("gotoLineMode")){let i=Ree(e.path);return[{fileUri:e.with({path:i.path}),options:{selection:Vn(i.line)?void 0:{startLineNumber:i.line,startColumn:i.column||1}}}]}return[{fileUri:e}]}}}get filesToDiff(){if(this.payload){let t=this.payload.get("diffFilePrimary"),e=this.payload.get("diffFileSecondary");if(t&&e)return[{fileUri:Z.parse(e)},{fileUri:Z.parse(t)}]}}get filesToMerge(){if(this.payload){let t=this.payload.get("mergeFile1"),e=this.payload.get("mergeFile2"),i=this.payload.get("mergeFileBase"),n=this.payload.get("mergeFileResult");if(t&&e&&i&&n)return[{fileUri:Z.parse(t)},{fileUri:Z.parse(e)},{fileUri:Z.parse(i)},{fileUri:Z.parse(n)}]}}};E([Re],Di.prototype,"remoteAuthority",1),E([Re],Di.prototype,"expectsResolverExtension",1),E([Re],Di.prototype,"isBuilt",1),E([Re],Di.prototype,"logLevel",1),E([Re],Di.prototype,"windowLogsPath",1),E([Re],Di.prototype,"logFile",1),E([Re],Di.prototype,"userRoamingDataHome",1),E([Re],Di.prototype,"argvResource",1),E([Re],Di.prototype,"cacheHome",1),E([Re],Di.prototype,"workspaceStorageHome",1),E([Re],Di.prototype,"localHistoryHome",1),E([Re],Di.prototype,"stateResource",1),E([Re],Di.prototype,"userDataSyncHome",1),E([Re],Di.prototype,"sync",1),E([Re],Di.prototype,"keyboardLayoutResource",1),E([Re],Di.prototype,"untitledWorkspacesHome",1),E([Re],Di.prototype,"serviceMachineIdResource",1),E([Re],Di.prototype,"extHostLogsPath",1),E([Re],Di.prototype,"extHostTelemetryLogFile",1),E([Re],Di.prototype,"debugExtensionHost",1),E([Re],Di.prototype,"isExtensionDevelopment",1),E([Re],Di.prototype,"extensionDevelopmentLocationURI",1),E([Re],Di.prototype,"extensionDevelopmentLocationKind",1),E([Re],Di.prototype,"extensionTestsLocationURI",1),E([Re],Di.prototype,"extensionEnabledProposedApi",1),E([Re],Di.prototype,"debugRenderer",1),E([Re],Di.prototype,"enableSmokeTestDriver",1),E([Re],Di.prototype,"disableExtensions",1),E([Re],Di.prototype,"enableExtensions",1),E([Re],Di.prototype,"webviewExternalEndpoint",1),E([Re],Di.prototype,"extensionTelemetryLogResource",1),E([Re],Di.prototype,"disableTelemetry",1),E([Re],Di.prototype,"verbose",1),E([Re],Di.prototype,"logExtensionHostCommunication",1),E([Re],Di.prototype,"skipReleaseNotes",1),E([Re],Di.prototype,"skipWelcome",1),E([Re],Di.prototype,"disableWorkspaceTrust",1),E([Re],Di.prototype,"profile",1),E([Re],Di.prototype,"filesToOpenOrCreate",1),E([Re],Di.prototype,"filesToDiff",1),E([Re],Di.prototype,"filesToMerge",1);var N1=q("layoutService");var Ew=class extends Xm{constructor(e,i,n,o,s){super(e,n,o);this.options=i;this.layoutService=s;this._register(s.registerPart(this))}_dimension;get dimension(){return this._dimension}_contentPosition;get contentPosition(){return this._contentPosition}_onDidVisibilityChange=this._register(new x);onDidVisibilityChange=this._onDidVisibilityChange.event;parent;headerArea;titleArea;contentArea;footerArea;partLayout;onThemeChange(e){this.parent&&super.onThemeChange(e)}create(e,i){this.parent=e,this.titleArea=this.createTitleArea(e,i),this.contentArea=this.createContentArea(e,i),this.partLayout=new M7(this.options,this.contentArea),this.updateStyles()}getContainer(){return this.parent}createTitleArea(e,i){}getTitleArea(){return this.titleArea}createContentArea(e,i){}getContentArea(){return this.contentArea}setHeaderArea(e){if(this.headerArea)throw new Error("Header already exists");!this.parent||!this.titleArea||(eI(this.parent,e),e.classList.add("header-or-footer"),e.classList.add("header"),this.headerArea=e,this.partLayout?.setHeaderVisibility(!0),this.relayout())}setFooterArea(e){if(this.footerArea)throw new Error("Footer already exists");!this.parent||!this.titleArea||(this.parent.appendChild(e),e.classList.add("header-or-footer"),e.classList.add("footer"),this.footerArea=e,this.partLayout?.setFooterVisibility(!0),this.relayout())}removeHeaderArea(){this.headerArea&&(this.headerArea.remove(),this.headerArea=void 0,this.partLayout?.setHeaderVisibility(!1),this.relayout())}removeFooterArea(){this.footerArea&&(this.footerArea.remove(),this.footerArea=void 0,this.partLayout?.setFooterVisibility(!1),this.relayout())}relayout(){this.dimension&&this.contentPosition&&this.layout(this.dimension.width,this.dimension.height,this.contentPosition.top,this.contentPosition.left)}layoutContents(e,i){return Yt(this.partLayout).layout(e,i)}_onDidChange=this._register(new x);get onDidChange(){return this._onDidChange.event}element;layout(e,i,n,o){this._dimension=new Ge(e,i),this._contentPosition={top:n,left:o}}setVisible(e){this._onDidVisibilityChange.fire(e)}},M7=class r{constructor(t,e){this.options=t;this.contentArea=e}static HEADER_HEIGHT=35;static TITLE_HEIGHT=35;static Footer_HEIGHT=35;headerVisible=!1;footerVisible=!1;layout(t,e){let i;this.options.hasTitle?i=new Ge(t,Math.min(e,r.TITLE_HEIGHT)):i=Ge.None;let n;this.headerVisible?n=new Ge(t,Math.min(e,r.HEADER_HEIGHT)):n=Ge.None;let o;this.footerVisible?o=new Ge(t,Math.min(e,r.Footer_HEIGHT)):o=Ge.None;let s=t;this.options&&typeof this.options.borderWidth=="function"&&(s-=this.options.borderWidth());let a=new Ge(s,e-i.height-n.height-o.height);return this.contentArea&&VA(this.contentArea,a.width,a.height),{headerSize:n,titleSize:i,contentSize:a,footerSize:o}}setFooterVisibility(t){this.footerVisible=t}setHeaderVisibility(t){this.headerVisible=t}},xw=class extends Xm{_parts=new Set;get parts(){return Array.from(this._parts)}registerPart(t){return this._parts.add(t),le(()=>this.unregisterPart(t))}unregisterPart(t){this._parts.delete(t)}getPart(t){return this.getPartByDocument(t.ownerDocument)}getPartByDocument(t){if(this._parts.size>1){for(let e of this._parts)if(e.element?.ownerDocument===t)return e}return this.mainPart}get activePart(){return this.getPartByDocument(pf())}};var ii=N1;function F1(r){return r===2||r===3}function Jf(r){switch(r){case 0:return"left";case 1:return"right";case 2:return"bottom";case 3:return"top";default:return"bottom"}}var ANt={[Jf(0)]:0,[Jf(1)]:1,[Jf(2)]:2,[Jf(3)]:3};function A7(r){switch(r){case 0:return"always";case 1:return"never";case 2:return"preserve";default:return"preserve"}}var ONt={[A7(0)]:0,[A7(1)]:1,[A7(2)]:2};var er=q("lifecycleService");function Tae(r){switch(r){case 1:return"Starting";case 2:return"Ready";case 3:return"Restored";case 4:return"Eventually"}}var nh=class extends R{constructor(e,i){super();this.logService=e;this.storageService=i;this._startupKind=this.resolveStartupKind(),this._register(this.storageService.onWillSaveState(n=>{n.reason===1&&this.storageService.store(nh.LAST_SHUTDOWN_REASON_KEY,this.shutdownReason,1,1)}))}static LAST_SHUTDOWN_REASON_KEY="lifecyle.lastShutdownReason";_onBeforeShutdown=this._register(new x);onBeforeShutdown=this._onBeforeShutdown.event;_onWillShutdown=this._register(new x);onWillShutdown=this._onWillShutdown.event;_onDidShutdown=this._register(new x);onDidShutdown=this._onDidShutdown.event;_onBeforeShutdownError=this._register(new x);onBeforeShutdownError=this._onBeforeShutdownError.event;_onShutdownVeto=this._register(new x);onShutdownVeto=this._onShutdownVeto.event;_startupKind;get startupKind(){return this._startupKind}_phase=1;get phase(){return this._phase}phaseWhen=new Map;shutdownReason;resolveStartupKind(){let e=this.doResolveStartupKind()??1;return this.logService.trace(`[lifecycle] starting up (startup kind: ${e})`),e}doResolveStartupKind(){let e=this.storageService.getNumber(nh.LAST_SHUTDOWN_REASON_KEY,1);this.storageService.remove(nh.LAST_SHUTDOWN_REASON_KEY,1);let i;switch(e){case 3:i=3;break;case 4:i=4;break}return i}set phase(e){if(e<this.phase)throw new Error("Lifecycle cannot go backwards");if(this._phase===e)return;this.logService.trace(`lifecycle: phase changed (value: ${e})`),this._phase=e,fr(`code/LifecyclePhase/${Tae(e)}`);let i=this.phaseWhen.get(this._phase);i&&(i.open(),this.phaseWhen.delete(this._phase))}async when(e){if(e<=this._phase)return;let i=this.phaseWhen.get(e);i||(i=new KS,this.phaseWhen.set(e,i)),await i.wait()}};nh=E([b(0,bt),b(1,nt)],nh);var Xk=class extends nh{beforeUnloadListener=void 0;unloadListener=void 0;ignoreBeforeUnload=!1;didUnload=!1;constructor(t,e){super(t,e),this.registerListeners()}registerListeners(){this.beforeUnloadListener=F(Ke,Q.BEFORE_UNLOAD,t=>this.onBeforeUnload(t)),this.unloadListener=F(Ke,Q.PAGE_HIDE,()=>this.onUnload())}onBeforeUnload(t){this.ignoreBeforeUnload?(this.logService.info("[lifecycle] onBeforeUnload triggered but ignored once"),this.ignoreBeforeUnload=!1):(this.logService.info("[lifecycle] onBeforeUnload triggered and handled with veto support"),this.doShutdown(()=>this.vetoBeforeUnload(t)))}vetoBeforeUnload(t){t.preventDefault(),t.returnValue=u("lifecycleVeto","Changes that you made may not be saved. Please check press 'Cancel' and try again.")}withExpectedShutdown(t,e){if(typeof t=="number")return this.shutdownReason=t,this.storageService.flush(1);this.ignoreBeforeUnload=!0;try{e?.()}finally{this.ignoreBeforeUnload=!1}}async shutdown(){this.logService.info("[lifecycle] shutdown triggered"),this.beforeUnloadListener?.dispose(),this.unloadListener?.dispose(),await this.storageService.flush(1),this.doShutdown()}doShutdown(t){let e=this.logService;this.storageService.flush(1);let i=!1;function n(o,s){typeof t=="function"&&(o instanceof Promise&&(e.error(`[lifecycle] Long running operations before shutdown are unsupported in the web (id: ${s})`),i=!0),o===!0&&(e.info(`[lifecycle]: Unload was prevented (id: ${s})`),i=!0))}return this._onBeforeShutdown.fire({reason:2,veto(o,s){n(o,s)},finalVeto(o,s){n(o(),s)}}),i&&typeof t=="function"?t():this.onUnload()}onUnload(){if(this.didUnload)return;this.didUnload=!0,this._register(F(Ke,Q.PAGE_SHOW,e=>this.onLoadAfterUnload(e)));let t=this.logService;this._onWillShutdown.fire({reason:2,joiners:()=>[],token:Pt.None,join(e,i){t.error(`[lifecycle] Long running operations during shutdown are unsupported in the web (id: ${i.id})`)},force:()=>{}}),this._onDidShutdown.fire()}onLoadAfterUnload(t){t.persisted&&this.withExpectedShutdown({disableShutdownHandling:!0},()=>Ke.location.reload())}doResolveStartupKind(){let t=super.doResolveStartupKind();return typeof t!="number"&&performance.getEntriesByType("navigation").at(0)?.type==="reload"&&(t=3),t}};Xk=E([b(0,bt),b(1,nt)],Xk);gi(er,Xk,0);var Tn=q("hostService");var iCe=u("open","open"),nCe=u("close","close"),oCe=u("find","find"),B1={open:iCe,close:nCe,find:oCe};async function kae(r,t){let e=[];return await Lae(r,e,t.logsHome,t.logsHome),e}async function Lae(r,t,e,i){let n=await r.resolve(e);for(let{resource:o,isDirectory:s}of n.children||[])if(s)await Lae(r,t,o,i);else{let a=(await r.readFile(o)).value.toString();if(a){let l=af(i,o);l&&t.push({relativePath:l,contents:a})}}}var Rae=q("editorPaneService");var Pd;(t=>t.Workbench="workbench.contributions.kind")(Pd||={});var Ec=(n=>(n[n.BlockStartup=1]="BlockStartup",n[n.BlockRestore=2]="BlockRestore",n[n.AfterRestored=3]="AfterRestored",n[n.Eventually=4]="Eventually",n))(Ec||{});function Pae(r){let t=r;return!!t&&typeof t.editorTypeId=="string"}function rCe(r){switch(r){case 3:return Ec.AfterRestored;case 4:return Ec.Eventually}}function Mae(r){switch(r){case Ec.BlockStartup:return 1;case Ec.BlockRestore:return 2;case Ec.AfterRestored:return 3;case Ec.Eventually:return 4}}var HI=class r extends R{static INSTANCE=new r;static BLOCK_BEFORE_RESTORE_WARN_THRESHOLD=20;static BLOCK_AFTER_RESTORE_WARN_THRESHOLD=100;instantiationService;lifecycleService;logService;environmentService;editorPaneService;contributionsByPhase=new Map;contributionsByEditor=new Map;contributionsById=new Map;instancesById=new Map;instanceDisposables=this._register(new B);timingsByPhase=new Map;get timings(){return this.timingsByPhase}pendingRestoredContributions=new Kr;whenRestored=this.pendingRestoredContributions.p;registerWorkbenchContribution2(t,e,i){let n={id:t,ctor:e};this.instantiationService&&this.lifecycleService&&this.logService&&this.environmentService&&this.editorPaneService&&(typeof i=="number"&&this.lifecycleService.phase>=i||typeof t=="string"&&Pae(i)&&this.editorPaneService.didInstantiateEditorPane(i.editorTypeId))?this.safeCreateContribution(this.instantiationService,this.logService,this.environmentService,n,typeof i=="number"?Mae(i):this.lifecycleService.phase):(typeof i=="number"&&mm(this.contributionsByPhase,Mae(i),[]).push(n),typeof t=="string"&&(this.contributionsById.has(t)?console.error(`IWorkbenchContributionsRegistry#registerWorkbenchContribution(): Can't register multiple contributions with same id '${t}'`):this.contributionsById.set(t,n),Pae(i)&&mm(this.contributionsByEditor,i.editorTypeId,[]).push(n)))}registerWorkbenchContribution(t,e){this.registerWorkbenchContribution2(void 0,t,rCe(e))}getWorkbenchContribution(t){if(this.instancesById.has(t))return this.instancesById.get(t);let e=this.instantiationService,i=this.lifecycleService,n=this.logService,o=this.environmentService;if(!e||!i||!n||!o)throw new Error(`IWorkbenchContributionsRegistry#getContribution('${t}'): cannot be called before registry started`);let s=this.contributionsById.get(t);if(!s)throw new Error(`IWorkbenchContributionsRegistry#getContribution('${t}'): contribution with that identifier is unknown.`);i.phase<3&&n.warn(`IWorkbenchContributionsRegistry#getContribution('${t}'): contribution instantiated before LifecyclePhase.Restored!`),this.safeCreateContribution(e,n,o,s,i.phase);let a=this.instancesById.get(t);if(!a)throw new Error(`IWorkbenchContributionsRegistry#getContribution('${t}'): failed to create contribution.`);return a}start(t){let e=this.instantiationService=t.get(ne),i=this.lifecycleService=t.get(er),n=this.logService=t.get(bt),o=this.environmentService=t.get($o),s=this.editorPaneService=t.get(Rae);this._register(i.onDidShutdown(()=>{this.instanceDisposables.clear()}));for(let a of[1,2,3,4])this.instantiateByPhase(e,i,n,o,a);for(let a of this.contributionsByEditor.keys())s.didInstantiateEditorPane(a)&&this.onEditor(a,e,i,n,o);this._register(s.onWillInstantiateEditorPane(a=>this.onEditor(a.typeId,e,i,n,o)))}onEditor(t,e,i,n,o){let s=this.contributionsByEditor.get(t);if(s){this.contributionsByEditor.delete(t);for(let a of s)this.safeCreateContribution(e,n,o,a,i.phase)}}instantiateByPhase(t,e,i,n,o){e.phase>=o?this.doInstantiateByPhase(t,i,n,o):e.when(o).then(()=>this.doInstantiateByPhase(t,i,n,o))}async doInstantiateByPhase(t,e,i,n){let o=this.contributionsByPhase.get(n);if(o)switch(this.contributionsByPhase.delete(n),n){case 1:case 2:{fr(`code/willCreateWorkbenchContributions/${n}`);for(let s of o)this.safeCreateContribution(t,e,i,s,n);fr(`code/didCreateWorkbenchContributions/${n}`);break}case 3:case 4:{n===4&&await this.pendingRestoredContributions.p,this.doInstantiateWhenIdle(o,t,e,i,n);break}}}doInstantiateWhenIdle(t,e,i,n,o){fr(`code/willCreateWorkbenchContributions/${o}`);let s=0,a=o===4?3e3:500,l=d=>{for(;s<t.length;){let c=t[s++];if(this.safeCreateContribution(e,i,n,c,o),d.timeRemaining()<1){df(l,a);break}}s===t.length&&(fr(`code/didCreateWorkbenchContributions/${o}`),o===3&&this.pendingRestoredContributions.complete())};df(l,a)}safeCreateContribution(t,e,i,n,o){if(typeof n.id=="string"&&this.instancesById.has(n.id))return;let s=Date.now();try{typeof n.id=="string"&&fr(`code/willCreateWorkbenchContribution/${o}/${n.id}`);let a=t.createInstance(n.ctor);typeof n.id=="string"&&(this.instancesById.set(n.id,a),this.contributionsById.delete(n.id)),Wv(a)&&this.instanceDisposables.add(a)}catch(a){e.error(`Unable to create workbench contribution '${n.id??n.ctor.name}'.`,a)}finally{typeof n.id=="string"&&fr(`code/didCreateWorkbenchContribution/${o}/${n.id}`)}if(typeof n.id=="string"||!i.isBuilt){let a=Date.now()-s;if(a>(o<3?r.BLOCK_BEFORE_RESTORE_WARN_THRESHOLD:r.BLOCK_AFTER_RESTORE_WARN_THRESHOLD)&&e.warn(`Creation of workbench contribution '${n.id??n.ctor.name}' took ${a}ms.`),typeof n.id=="string"){let l=this.timingsByPhase.get(o);l||(l=[],this.timingsByPhase.set(o,l)),l.push([n.id,a])}}}},Yk=HI.INSTANCE.registerWorkbenchContribution2.bind(HI.INSTANCE),sFt=HI.INSTANCE.getWorkbenchContribution.bind(HI.INSTANCE);Pe.add(Pd.Workbench,HI.INSTANCE);var Qk=class{constructor(t,e,i,n){this.fileService=t;this.environmentService=e;this.lifecycleService=i;this.logService=n}async getLogs(){return kae(this.fileService,this.environmentService)}async whenWorkbenchRestored(){this.logService.info("[driver] Waiting for restored lifecycle phase..."),await this.lifecycleService.when(3),this.logService.info("[driver] Restored lifecycle phase reached. Waiting for contributions..."),await Pe.as(Pd.Workbench).whenRestored,this.logService.info("[driver] Workbench contributions created.")}async setValue(t,e){let i=Ke.document.querySelector(t);if(!i)return Promise.reject(new Error(`Element not found: ${t}`));let n=i;n.value=e;let o=new Event("input",{bubbles:!0,cancelable:!0});n.dispatchEvent(o)}async isActiveElement(t){if(Ke.document.querySelector(t)!==Ke.document.activeElement){let i=[],n=Ke.document.activeElement;for(;n;){let o=n.tagName,s=n.id?`#${n.id}`:"",a=cn(n.className.split(/\s+/g).map(l=>l.trim())).map(l=>`.${l}`).join("");i.unshift(`${o}${s}${a}`),n=n.parentElement}throw new Error(`Active element not found. Current active element is '${i.join(" > ")}'. Looking for ${t}`)}return!0}async getElements(t,e){let i=Ke.document.querySelectorAll(t),n=[];for(let o=0;o<i.length;o++){let s=i.item(o);n.push(this.serializeElement(s,e))}return n}serializeElement(t,e){let i=Object.create(null);for(let a=0;a<t.attributes.length;a++){let l=t.attributes.item(a);l&&(i[l.name]=l.value)}let n=[];if(e)for(let a=0;a<t.children.length;a++){let l=t.children.item(a);l&&n.push(this.serializeElement(l,!0))}let{left:o,top:s}=rD(t);return{tagName:t.tagName,className:t.className,textContent:t.textContent||"",attributes:i,children:n,left:o,top:s}}async getElementXY(t,e,i){let n=typeof e=="number"&&typeof i=="number"?{x:e,y:i}:void 0;return this._getElementXY(t,n)}async typeInEditor(t,e){let i=Ke.document.querySelector(t);if(!i)throw new Error(`Editor not found: ${t}`);let n=i,o=n.selectionStart,s=o+e.length,a=n.value,l=a.substr(0,o)+e+a.substr(o);n.value=l,n.setSelectionRange(s,s);let d=new Event("input",{bubbles:!0,cancelable:!0});n.dispatchEvent(d)}async getTerminalBuffer(t){let e=Ke.document.querySelector(t);if(!e)throw new Error(`Terminal not found: ${t}`);let i=e.xterm;if(!i)throw new Error(`Xterm not found: ${t}`);let n=[];for(let o=0;o<i.buffer.active.length;o++)n.push(i.buffer.active.getLine(o).translateToString(!0));return n}async writeInTerminal(t,e){let i=Ke.document.querySelector(t);if(!i)throw new Error(`Element not found: ${t}`);let n=i.xterm;if(!n)throw new Error(`Xterm not found: ${t}`);n.input(e)}getLocaleInfo(){return Promise.resolve({language:qa,locale:aJ})}getLocalizedStrings(){return Promise.resolve({open:B1.open,close:B1.close,find:B1.find})}async _getElementXY(t,e){let i=Ke.document.querySelector(t);if(!i)return Promise.reject(new Error(`Element not found: ${t}`));let{left:n,top:o}=rD(i),{width:s,height:a}=Qa(i),l,d;return e?(l=n+e.x,d=o+e.y):(l=n+s/2,d=o+a/2),l=Math.round(l),d=Math.round(d),{x:l,y:d}}async exitApplication(){}};Qk=E([b(0,Ei),b(1,$o),b(2,er),b(3,bt)],Qk);function Aae(r){Object.assign(Ke,{driver:r.createInstance(Qk)})}var Md=class extends R{constructor(e,i={getWindowsCount:BA,getWindows:nD},n,o){super();this.hostService=n;this.environmentService=o;this.enableWindowFocusOnElementFocus(e),this.enableMultiWindowAwareTimeout(e,i),this.registerFullScreenListeners(e.vscodeWindowId)}static TIMEOUT_HANDLES=Number.MIN_SAFE_INTEGER;static TIMEOUT_DISPOSABLES=new Map;enableWindowFocusOnElementFocus(e){let i=e.HTMLElement.prototype.focus,n=this;e.HTMLElement.prototype.focus=function(o){n.onElementFocus(ue(this)),i.apply(this,[o])}}onElementFocus(e){let i=Gr();i!==e&&i.document.hasFocus()&&(e.focus(),!this.environmentService.extensionTestsLocationURI&&!e.document.hasFocus()&&this.hostService.focus(e))}enableMultiWindowAwareTimeout(e,i={getWindowsCount:BA,getWindows:nD}){let n=e.setTimeout;Object.defineProperty(e,"vscodeOriginalSetTimeout",{get:()=>n});let o=e.clearTimeout;Object.defineProperty(e,"vscodeOriginalClearTimeout",{get:()=>o}),e.setTimeout=function(s,a=0,...l){if(i.getWindowsCount()===1||typeof s=="string"||a===0)return n.apply(this,[s,a,...l]);let d=new Set,c=Md.TIMEOUT_HANDLES++;Md.TIMEOUT_DISPOSABLES.set(c,d);let p=$a(s,()=>{_e(d),Md.TIMEOUT_DISPOSABLES.delete(c)});for(let{window:h,disposables:m}of i.getWindows()){if(w4(h)&&h.document.visibilityState==="hidden")continue;let f=!1,g=h.vscodeOriginalSetTimeout.apply(this,[(...I)=>{f||p(...I)},a,...l]),v=le(()=>{f=!0,h.vscodeOriginalClearTimeout(g),d.delete(v)});m.add(v),d.add(v)}return c},e.clearTimeout=function(s){let a=typeof s=="number"?Md.TIMEOUT_DISPOSABLES.get(s):void 0;a?(_e(a),Md.TIMEOUT_DISPOSABLES.delete(s)):o.apply(this,[s])}}registerFullScreenListeners(e){this._register(this.hostService.onDidChangeFullScreen(({windowId:i,fullscreen:n})=>{if(i===e){let o=Em(e);o&&Iee(n,o.window)}}))}static async confirmOnShutdown(e,i){let n=e.get(Io),o=e.get(se),s=i===2?ye?u("quitMessageMac","Are you sure you want to quit?"):u("quitMessage","Are you sure you want to exit?"):u("closeWindowMessage","Are you sure you want to close the window?"),a=i===2?ye?u({key:"quitButtonLabel",comment:["&& denotes a mnemonic"]},"&&Quit"):u({key:"exitButtonLabel",comment:["&& denotes a mnemonic"]},"&&Exit"):u({key:"closeWindowButtonLabel",comment:["&& denotes a mnemonic"]},"&&Close Window"),l=await n.confirm({message:s,primaryButton:a,checkbox:{label:u("doNotAskAgain","Do not ask me again")}});return l.confirmed&&l.checkboxChecked&&await o.updateValue("window.confirmBeforeClose","never"),l.confirmed}};Md=E([b(2,Tn),b(3,Jo)],Md);var V1=class extends Md{constructor(e,i,n,o,s,a,l,d,c){super(Ke,void 0,c,a);this.openerService=e;this.lifecycleService=i;this.dialogService=n;this.labelService=o;this.productService=s;this.browserEnvironmentService=a;this.layoutService=l;this.instantiationService=d;this.registerListeners(),this.create()}registerListeners(){this._register(this.lifecycleService.onWillShutdown(()=>this.onWillShutdown()));let e=Hr&&Ke.visualViewport?Ke.visualViewport:Ke;this._register(F(e,Q.RESIZE,()=>{this.layoutService.layout(),Hr&&Ke.scrollTo(0,0)})),this._register(F(this.layoutService.mainContainer,Q.WHEEL,i=>i.preventDefault(),{passive:!1})),this._register(F(this.layoutService.mainContainer,Q.CONTEXT_MENU,i=>Ve.stop(i,!0))),this._register(F(this.layoutService.mainContainer,Q.DROP,i=>Ve.stop(i,!0)))}onWillShutdown(){X.toPromise(X.any(X.once(new lt(Ke.document.body,Q.KEY_DOWN,!0).event),X.once(new lt(Ke.document.body,Q.MOUSE_DOWN,!0).event))).then(async()=>{await To(3e3),await this.dialogService.prompt({type:Si.Error,message:u("shutdownError","An unexpected error occurred that requires a reload of this page."),detail:u("shutdownErrorDetail","The workbench was unexpectedly disposed while running."),buttons:[{label:u({key:"reload",comment:["&& denotes a mnemonic"]},"&&Reload"),run:()=>Ke.location.reload()}]})})}create(){this.setupOpenHandlers(),this.registerLabelFormatters(),this.registerCommands(),this.setupDriver()}setupDriver(){this.environmentService.enableSmokeTestDriver&&Aae(this.instantiationService)}setupOpenHandlers(){this.openerService.setDefaultExternalOpener({openExternal:async e=>{let i=!1;if(this.browserEnvironmentService.options?.openerAllowedExternalUrlPrefixes){for(let n of this.browserEnvironmentService.options.openerAllowedExternalUrlPrefixes)if(e.startsWith(n)){i=!0;break}}if(ef(e,Ie.http)||ef(e,Ie.https))ms?Ite(e,!i)||await this.dialogService.prompt({type:Si.Warning,message:u("unableToOpenExternal","The browser interrupted the opening of a new tab or window. Press 'Open' to open it anyway."),detail:e,buttons:[{label:u({key:"open",comment:["&& denotes a mnemonic"]},"&&Open"),run:()=>i?tK(e):eK(e)},{label:u({key:"learnMore",comment:["&& denotes a mnemonic"]},"&&Learn More"),run:()=>this.openerService.open(Z.parse("https://aka.ms/allow-vscode-popup"))}],cancelButton:!0}):i?tK(e):eK(e);else{let n=()=>{this.lifecycleService.withExpectedShutdown({disableShutdownHandling:!0},()=>Ke.location.href=e)};n();let o=async()=>{let{downloadUrl:s}=this.productService,a,l=[{label:u({key:"openExternalDialogButtonRetry.v2",comment:["&& denotes a mnemonic"]},"&&Try Again"),run:()=>n()}];s!==void 0?(a=u("openExternalDialogDetail.v2",`We launched {0} on your computer.

If {1} did not launch, try again or install it below.`,this.productService.nameLong,this.productService.nameLong),l.push({label:u({key:"openExternalDialogButtonInstall.v3",comment:["&& denotes a mnemonic"]},"&&Install"),run:async()=>{await this.openerService.open(Z.parse(s)),o()}})):a=u("openExternalDialogDetailNoInstall",`We launched {0} on your computer.

If {1} did not launch, try again below.`,this.productService.nameLong,this.productService.nameLong),await this.hostService.withExpectedShutdown(()=>this.dialogService.prompt({type:Si.Info,message:u("openExternalDialogTitle","All done. You can close this tab now."),detail:a,buttons:l,cancelButton:!0}))};ef(e,this.productService.urlProtocol)&&await o()}return!0}})}registerLabelFormatters(){this._register(this.labelService.registerFormatter({scheme:Ie.vscodeUserData,priority:!0,formatting:{label:"(Settings) ${path}",separator:"/"}}))}registerCommands(){tt.registerCommand("workbench.experimental.requestUsbDevice",async(e,i)=>Sae(i)),tt.registerCommand("workbench.experimental.requestSerialPort",async(e,i)=>Cae(i)),tt.registerCommand("workbench.experimental.requestHidDevice",async(e,i)=>wae(i))}};V1=E([b(0,Yi),b(1,er),b(2,Io),b(3,hi),b(4,al),b(5,ih),b(6,ii),b(7,ne),b(8,Tn)],V1);var sCe=q("auxiliaryWindowService");var Zk=class extends Md{constructor(e,i,n,o,s,a){super(e,void 0,s,a);this.window=e;this.container=i;this.configurationService=o;this.whenStylesHaveLoaded=n.wait().then(()=>{}),this.registerListeners()}_onWillLayout=this._register(new x);onWillLayout=this._onWillLayout.event;_onDidLayout=this._register(new x);onDidLayout=this._onDidLayout.event;_onBeforeUnload=this._register(new x);onBeforeUnload=this._onBeforeUnload.event;_onUnload=this._register(new x);onUnload=this._onUnload.event;_onWillDispose=this._register(new x);onWillDispose=this._onWillDispose.event;whenStylesHaveLoaded;registerListeners(){this._register(F(this.window,Q.BEFORE_UNLOAD,e=>this.handleBeforeUnload(e))),this._register(F(this.window,Q.UNLOAD,()=>this.handleUnload())),this._register(F(this.window,"unhandledrejection",e=>{Xe(e.reason),e.preventDefault()})),this._register(F(this.window,Q.RESIZE,()=>this.layout())),this._register(F(this.container,Q.SCROLL,()=>this.container.scrollTop=0)),si?(this._register(F(this.container,Q.DROP,e=>Ve.stop(e,!0))),this._register(F(this.container,Q.WHEEL,e=>e.preventDefault(),{passive:!1})),this._register(F(this.container,Q.CONTEXT_MENU,e=>Ve.stop(e,!0)))):(this._register(F(this.window.document.body,Q.DRAG_OVER,e=>Ve.stop(e))),this._register(F(this.window.document.body,Q.DROP,e=>Ve.stop(e))))}handleBeforeUnload(e){let i;if(this._onBeforeUnload.fire({veto(s){s&&(i=s)}}),i){this.handleVetoBeforeClose(e,i);return}let n=this.configurationService.getValue("window.confirmBeforeClose");(n==="always"||n==="keyboardOnly"&&eu.getInstance().isModifierPressed)&&this.confirmBeforeClose(e)}handleVetoBeforeClose(e,i){this.preventUnload(e)}preventUnload(e){e.preventDefault(),e.returnValue=u("lifecycleVeto","Changes that you made may not be saved. Please check press 'Cancel' and try again.")}confirmBeforeClose(e){this.preventUnload(e)}handleUnload(){this._onUnload.fire()}layout(){let e=Qa(this.window.document.body,this.container);this._onWillLayout.fire(e),this._onDidLayout.fire(e)}createState(){return{bounds:{x:this.window.screenX,y:this.window.screenY,width:this.window.outerWidth,height:this.window.outerHeight},zoomLevel:vee(this.window)}}dispose(){this._store.isDisposed||(this._onWillDispose.fire(),super.dispose())}};Zk=E([b(3,se),b(4,Tn),b(5,Jo)],Zk);var Qm=class extends R{constructor(e,i,n,o,s,a){super();this.layoutService=e;this.dialogService=i;this.configurationService=n;this.telemetryService=o;this.hostService=s;this.environmentService=a}static DEFAULT_SIZE={width:800,height:600};static WINDOW_IDS=_p(Ke)+1;_onDidOpenAuxiliaryWindow=this._register(new x);onDidOpenAuxiliaryWindow=this._onDidOpenAuxiliaryWindow.event;windows=new Map;async open(e){fr("code/auxiliaryWindow/willOpen");let i=await this.openWindow(e);if(!i)throw new Error(u("unableToOpenWindowError","Unable to open a new window."));let n=await this.resolveWindowId(i);yA(i,n);let o=new B,{container:s,stylesLoaded:a}=this.createContainer(i,o,e),l=this.createAuxiliaryWindow(i,s,a),d=new B;this.windows.set(i.vscodeWindowId,l),d.add(le(()=>this.windows.delete(i.vscodeWindowId)));let c=new B;return X.once(l.onWillDispose)(()=>{i.close(),o.dispose(),d.dispose(),c.dispose()}),d.add(ete(i)),this._onDidOpenAuxiliaryWindow.fire({window:l,disposables:c}),fr("code/auxiliaryWindow/didOpen"),this.telemetryService.publicLog2("auxiliaryWindowOpen",{bounds:!!e?.bounds}),l}createAuxiliaryWindow(e,i,n){return new Zk(e,i,n,this.configurationService,this.hostService,this.environmentService)}async openWindow(e){let i=Gr(),n={x:i.screenX,y:i.screenY,width:i.outerWidth,height:i.outerHeight},o=Math.max(e?.bounds?.width??Qm.DEFAULT_SIZE.width,F3.WIDTH),s=Math.max(e?.bounds?.height??Qm.DEFAULT_SIZE.height,F3.HEIGHT),a={x:e?.bounds?.x??Math.max(n.x+n.width/2-o/2,0),y:e?.bounds?.y??Math.max(n.y+n.height/2-s/2,0),width:o,height:s};!e?.bounds&&a.x===n.x&&a.y===n.y&&(a={...a,x:a.x+30,y:a.y+30});let l=cn(["popup=yes",`left=${a.x}`,`top=${a.y}`,`width=${a.width}`,`height=${a.height}`,e?.nativeTitlebar?"window-native-titlebar=yes":void 0,e?.disableFullscreen?"window-disable-fullscreen=yes":void 0,e?.mode===0?"window-maximized=yes":void 0,e?.mode===2?"window-fullscreen=yes":void 0]),d=Ke.open(NM?"":"about:blank",void 0,l.join(","));return!d&&si?(await this.dialogService.prompt({type:Si.Warning,message:u("unableToOpenWindow","The browser interrupted the opening of a new window. Press 'Retry' to try again."),detail:u("unableToOpenWindowDetail","To avoid this problem in the future, please ensure to allow popups for this website."),buttons:[{label:u({key:"retry",comment:["&& denotes a mnemonic"]},"&&Retry"),run:()=>this.openWindow(e)}],cancelButton:!0})).result:d?.window}async resolveWindowId(e){return Qm.WINDOW_IDS++}createContainer(e,i,n){e.document.createElement=function(){throw new Error('Not allowed to create elements in child window JavaScript context. Always use the main window so that "xyz instanceof HTMLElement" continues to work.')},this.applyMeta(e);let{stylesLoaded:o}=this.applyCSS(e,i),s=this.applyHTML(e,i);return{stylesLoaded:o,container:s}}applyMeta(e){for(let n of['meta[charset="utf-8"]','meta[http-equiv="Content-Security-Policy"]','meta[name="viewport"]','meta[name="theme-color"]']){let o=Ke.document.querySelector(n);if(o){let s=cte(e.document.head);if(GA(o,s),n==='meta[http-equiv="Content-Security-Policy"]'){let a=s.getAttribute("content");a&&s.setAttribute("content",a.replace(/(script-src[^\;]*)/,"script-src 'none'"))}}}let i=Ke.document.querySelector('link[rel="icon"]');if(i){let n=ute(e.document.head);GA(i,n)}}applyCSS(e,i){fr("code/auxiliaryWindow/willApplyCSS");let n=new Map,o=new KS;o.wait().then(()=>fr("code/auxiliaryWindow/didLoadCSSStyles"));let s=i.add(new B),a=0;function l(){--a===0&&(s.dispose(),o.open())}function d(c){if(ate(c))return;let p=e.document.head.appendChild(c.cloneNode(!0));c.tagName.toLowerCase()==="link"&&(a++,s.add(F(p,"load",l)),s.add(F(p,"error",l))),n.set(c,p)}a++;try{for(let c of Ke.document.head.querySelectorAll('link[rel="stylesheet"], style'))d(c)}finally{l()}return i.add(lte(e)),i.add(UA.observe(Ke.document.head,i,{childList:!0,subtree:!0})(c=>{for(let p of c)if(!(p.type!=="childList"||p.target.nodeName.toLowerCase()==="title"||p.target.nodeName.toLowerCase()==="script"||p.target.nodeName.toLowerCase()==="meta")){for(let h of p.addedNodes)if(on(h)&&(h.tagName.toLowerCase()==="style"||h.tagName.toLowerCase()==="link"))d(h);else if(h.nodeType===Node.TEXT_NODE&&h.parentNode){let m=n.get(h.parentNode);m&&(m.textContent=h.textContent)}for(let h of p.removedNodes){let m=n.get(h);m&&(m.parentNode?.removeChild(m),n.delete(h))}}})),fr("code/auxiliaryWindow/didApplyCSS"),{stylesLoaded:o}}applyHTML(e,i){fr("code/auxiliaryWindow/willApplyHTML");let n=document.createElement("div");return n.setAttribute("role","application"),rte(n,0,0,0,0,"relative"),n.style.display="flex",n.style.height="100%",n.style.flexDirection="column",e.document.body.append(n),i.add(qA(Ke.document.documentElement,e.document.documentElement)),i.add(qA(Ke.document.body,e.document.body)),i.add(qA(this.layoutService.mainContainer,n,["class"])),fr("code/auxiliaryWindow/didApplyHTML"),n}getWindow(e){return this.windows.get(e)}};Qm=E([b(0,ii),b(1,Io),b(2,se),b(3,Tt),b(4,Tn),b(5,Jo)],Qm);gi(sCe,Qm,1);var eb=new Ge(220,70),O7=new Ge(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY);var oh=class r extends ww{constructor(e,i,n,o,s){super(e,n,o,s);this.group=i}onDidChangeSizeConstraints=X.None;_onDidChangeControl=this._register(new x);onDidChangeControl=this._onDidChangeControl.event;static EDITOR_MEMENTOS=new Map;get minimumWidth(){return eb.width}get maximumWidth(){return O7.width}get minimumHeight(){return eb.height}get maximumHeight(){return O7.height}_input;get input(){return this._input}_options;get options(){return this._options}get window(){return Em(this.group.windowId,!0).window}get scopedContextKeyService(){}create(e){super.create(e),this.createEditor(e)}async setInput(e,i,n,o){this._input=e,this._options=i}clearInput(){this._input=void 0,this._options=void 0}setOptions(e){this._options=e}setVisible(e){super.setVisible(e),this.setEditorVisible(e)}setEditorVisible(e){}setBoundarySashes(e){}getEditorMemento(e,i,n,o=10){let s=`${this.getId()}${n}`,a=r.EDITOR_MEMENTOS.get(s);return a||(a=this._register(new N7(this.getId(),n,this.getMemento(1,1),o,e,i)),r.EDITOR_MEMENTOS.set(s,a)),a}getViewState(){}saveState(){for(let[,e]of r.EDITOR_MEMENTOS)e.id===this.getId()&&e.saveState();super.saveState()}dispose(){this._input=void 0,this._options=void 0,super.dispose()}},N7=class r extends R{constructor(e,i,n,o,s,a){super();this.id=e;this.key=i;this.memento=n;this.limit=o;this.editorGroupService=s;this.configurationService=a;this.updateConfiguration(void 0),this.registerListeners()}static SHARED_EDITOR_STATE=-1;cache;cleanedUp=!1;editorDisposables;shareEditorState=!1;registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(e=>this.updateConfiguration(e)))}updateConfiguration(e){(!e||e.affectsConfiguration(void 0,"workbench.editor.sharedViewState"))&&(this.shareEditorState=this.configurationService.getValue(void 0,"workbench.editor.sharedViewState")===!0)}saveEditorState(e,i,n){let o=this.doGetResource(i);if(!o||!e)return;let s=this.doLoad(),a=s.get(o.toString());a||(a=Object.create(null),s.set(o.toString(),a)),a[e.id]=n,this.shareEditorState&&(a[r.SHARED_EDITOR_STATE]=n),kr(i)&&this.clearEditorStateOnDispose(o,i)}loadEditorState(e,i){let n=this.doGetResource(i);if(!n||!e)return;let s=this.doLoad().get(n.toString());if(s){let a=s[e.id];if(a)return a;if(this.shareEditorState)return s[r.SHARED_EDITOR_STATE]}}clearEditorState(e,i){kr(e)&&this.editorDisposables?.delete(e);let n=this.doGetResource(e);if(n){let o=this.doLoad();if(i){let s=o.get(n.toString());s&&(delete s[i.id],jv(s)&&o.delete(n.toString()))}else o.delete(n.toString())}}clearEditorStateOnDispose(e,i){this.editorDisposables||(this.editorDisposables=new Map),this.editorDisposables.has(i)||this.editorDisposables.set(i,X.once(i.onWillDispose)(()=>{this.clearEditorState(e),this.editorDisposables?.delete(i)}))}moveEditorState(e,i,n){let o=this.doLoad(),s=[...o.keys()];for(let a of s){let l=Z.parse(a);if(!n.isEqualOrParent(l,e))continue;let d;if(zi(e,l))d=i;else{let p=Lee(l.path,e.path);d=pi(i,l.path.substr(p+e.path.length+1))}let c=o.get(a,0);c&&(o.delete(a),o.set(d.toString(),c))}}doGetResource(e){return kr(e)?e.resource:e}doLoad(){if(!this.cache){this.cache=new zr(this.limit);let e=this.memento[this.key];Array.isArray(e)&&this.cache.fromJSON(e)}return this.cache}saveState(){let e=this.doLoad();this.cleanedUp||(this.cleanUp(),this.cleanedUp=!0),this.memento[this.key]=e.toJSON()}cleanUp(){let e=this.doLoad(),i=[...e.entries()];for(let[n,o]of i)for(let s of Object.keys(o)){let a=Number(s);a===r.SHARED_EDITOR_STATE&&this.shareEditorState||this.editorGroupService.getGroup(a)||(delete o[a],jv(o)&&e.delete(n))}}};var W1=class r{constructor(t,e,i){this.ctor=t;this.typeId=e;this.name=i}static instantiatedEditorPanes=new Set;static didInstantiateEditorPane(t){return r.instantiatedEditorPanes.has(t)}static _onWillInstantiateEditorPane=new x;static onWillInstantiateEditorPane=r._onWillInstantiateEditorPane.event;static create(t,e,i){return new r(t,e,i)}instantiate(t,e){r._onWillInstantiateEditorPane.fire({typeId:this.typeId});let i=t.createInstance(this.ctor,e);return r.instantiatedEditorPanes.add(this.typeId),i}describes(t){return t.getId()===this.typeId}},F7=class{mapEditorPanesToEditors=new Map;registerEditorPane(t,e){return this.mapEditorPanesToEditors.set(t,e),le(()=>{this.mapEditorPanesToEditors.delete(t)})}getEditorPane(t){let e=this.findEditorPaneDescriptors(t);if(e.length!==0)return e.length===1?e[0]:t.prefersEditorPane(e)}findEditorPaneDescriptors(t,e){let i=[];for(let n of this.mapEditorPanesToEditors.keys()){let o=this.mapEditorPanesToEditors.get(n)||[];for(let s of o){let a=s.ctor;if(!e&&t.constructor===a){i.push(n);break}else if(e&&t instanceof a){i.push(n);break}}}return!e&&i.length===0?this.findEditorPaneDescriptors(t,!0):i}getEditorPaneByType(t){return mt.find(this.mapEditorPanesToEditors.keys(),e=>e.typeId===t)}getEditorPanes(){return Array.from(this.mapEditorPanesToEditors.keys())}getEditors(){let t=[];for(let e of this.mapEditorPanesToEditors.keys()){let i=this.mapEditorPanesToEditors.get(e);i&&t.push(...i.map(n=>n.ctor))}return t}};Pe.add(Ld.EditorPane,new F7);function H1(r,t,e,i){let n=r.getAriaLabel();return e&&!e.isPinned(r)&&(n=u("preview","{0}, preview",n)),e?.isSticky(t??r)&&(n=u("pinned","{0}, pinned",n)),e&&typeof i=="number"&&i>1&&(n=`${n}, ${e.ariaLabel}`),n}var U1=class r extends R{static HEADER_SIZE=22;element;header;body;_expanded;_orientation;expandedSize=void 0;_headerVisible=!0;_collapsible=!0;_bodyRendered=!1;_minimumBodySize;_maximumBodySize;_ariaHeaderLabel;styles={dropBackground:void 0,headerBackground:void 0,headerBorder:void 0,headerForeground:void 0,leftBorder:void 0};animationTimer=void 0;_onDidChange=this._register(new x);onDidChange=this._onDidChange.event;_onDidChangeExpansionState=this._register(new x);onDidChangeExpansionState=this._onDidChangeExpansionState.event;get ariaHeaderLabel(){return this._ariaHeaderLabel}set ariaHeaderLabel(t){this._ariaHeaderLabel=t,this.header.setAttribute("aria-label",this.ariaHeaderLabel)}get draggableElement(){return this.header}get dropTargetElement(){return this.element}get dropBackground(){return this.styles.dropBackground}get minimumBodySize(){return this._minimumBodySize}set minimumBodySize(t){this._minimumBodySize=t,this._onDidChange.fire(void 0)}get maximumBodySize(){return this._maximumBodySize}set maximumBodySize(t){this._maximumBodySize=t,this._onDidChange.fire(void 0)}get headerSize(){return this.headerVisible?r.HEADER_SIZE:0}get minimumSize(){let t=this.headerSize,i=!this.headerVisible||this.isExpanded()?this.minimumBodySize:0;return t+i}get maximumSize(){let t=this.headerSize,i=!this.headerVisible||this.isExpanded()?this.maximumBodySize:0;return t+i}orthogonalSize=0;constructor(t){super(),this._expanded=typeof t.expanded>"u"?!0:!!t.expanded,this._orientation=typeof t.orientation>"u"?0:t.orientation,this._ariaHeaderLabel=u("viewSection","{0} Section",t.title),this._minimumBodySize=typeof t.minimumBodySize=="number"?t.minimumBodySize:this._orientation===1?200:120,this._maximumBodySize=typeof t.maximumBodySize=="number"?t.maximumBodySize:Number.POSITIVE_INFINITY,this.element=J(".pane")}isExpanded(){return this._expanded}setExpanded(t){return!t&&!this.collapsible||this._expanded===!!t?!1:(this.element?.classList.toggle("expanded",t),this._expanded=!!t,this.updateHeader(),t?(this._bodyRendered||(this.renderBody(this.body),this._bodyRendered=!0),typeof this.animationTimer=="number"&&ue(this.element).clearTimeout(this.animationTimer),U(this.element,this.body)):this.animationTimer=ue(this.element).setTimeout(()=>{this.body.remove()},200),this._onDidChangeExpansionState.fire(t),this._onDidChange.fire(t?this.expandedSize:void 0),!0)}get headerVisible(){return this._headerVisible}set headerVisible(t){this._headerVisible!==!!t&&(this._headerVisible=!!t,this.updateHeader(),this._onDidChange.fire(void 0))}get collapsible(){return this._collapsible}set collapsible(t){this._collapsible!==!!t&&(this._collapsible=!!t,this.updateHeader())}get orientation(){return this._orientation}set orientation(t){this._orientation!==t&&(this._orientation=t,this.element&&(this.element.classList.toggle("horizontal",this.orientation===1),this.element.classList.toggle("vertical",this.orientation===0)),this.header&&this.updateHeader())}render(){this.element.classList.toggle("expanded",this.isExpanded()),this.element.classList.toggle("horizontal",this.orientation===1),this.element.classList.toggle("vertical",this.orientation===0),this.header=J(".pane-header"),U(this.element,this.header),this.header.setAttribute("tabindex","0"),this.header.setAttribute("role","button"),this.header.setAttribute("aria-label",this.ariaHeaderLabel),this.renderHeader(this.header);let t=Er(this.header);this._register(t),this._register(t.onDidFocus(()=>this.header.classList.add("focused"),null)),this._register(t.onDidBlur(()=>this.header.classList.remove("focused"),null)),this.updateHeader();let e=this._register(new B),i=this._register(new lt(this.header,"keydown")),n=X.map(i.event,o=>new ut(o),e);this._register(X.filter(n,o=>o.keyCode===3||o.keyCode===10,e)(()=>this.setExpanded(!this.isExpanded()),null)),this._register(X.filter(n,o=>o.keyCode===15,e)(()=>this.setExpanded(!1),null)),this._register(X.filter(n,o=>o.keyCode===17,e)(()=>this.setExpanded(!0),null)),this._register(yi.addTarget(this.header)),[Q.CLICK,At.Tap].forEach(o=>{this._register(F(this.header,o,s=>{s.defaultPrevented||this.setExpanded(!this.isExpanded())}))}),this.body=U(this.element,J(".pane-body")),!this._bodyRendered&&this.isExpanded()&&(this.renderBody(this.body),this._bodyRendered=!0),this.isExpanded()||this.body.remove()}layout(t){let e=this.headerVisible?r.HEADER_SIZE:0,i=this._orientation===0?this.orthogonalSize:t,n=this._orientation===0?t-e:this.orthogonalSize-e;this.isExpanded()&&(this.body.classList.toggle("wide",i>=600),this.layoutBody(n,i),this.expandedSize=t)}style(t){this.styles=t,this.header&&this.updateHeader()}updateHeader(){let t=!this.headerVisible||this.isExpanded();this.collapsible?(this.header.setAttribute("tabindex","0"),this.header.setAttribute("role","button")):(this.header.removeAttribute("tabindex"),this.header.removeAttribute("role")),this.header.style.lineHeight=`${this.headerSize}px`,this.header.classList.toggle("hidden",!this.headerVisible),this.header.classList.toggle("expanded",t),this.header.classList.toggle("not-collapsible",!this.collapsible),this.header.setAttribute("aria-expanded",String(t)),this.header.style.color=this.collapsible?this.styles.headerForeground??"":"",this.header.style.backgroundColor=(this.collapsible?this.styles.headerBackground:"transparent")??"",this.header.style.borderTop=this.styles.headerBorder&&this.orientation===0?`1px solid ${this.styles.headerBorder}`:"",this.element.style.borderLeft=this.styles.leftBorder&&this.orientation===1?`1px solid ${this.styles.leftBorder}`:""}},B7=class r extends R{constructor(e,i,n){super();this.pane=e;this.dnd=i;this.context=n;e.draggableElement.draggable=!0,this._register(F(e.draggableElement,"dragstart",o=>this.onDragStart(o))),this._register(F(e.dropTargetElement,"dragenter",o=>this.onDragEnter(o))),this._register(F(e.dropTargetElement,"dragleave",o=>this.onDragLeave(o))),this._register(F(e.dropTargetElement,"dragend",o=>this.onDragEnd(o))),this._register(F(e.dropTargetElement,"drop",o=>this.onDrop(o)))}static DefaultDragOverBackgroundColor=new j(new xt(128,128,128,.5));dragOverCounter=0;_onDidDrop=this._register(new x);onDidDrop=this._onDidDrop.event;onDragStart(e){if(!this.dnd.canDrag(this.pane)||!e.dataTransfer){e.preventDefault(),e.stopPropagation();return}e.dataTransfer.effectAllowed="move",po&&e.dataTransfer?.setData(_a.TEXT,this.pane.draggableElement.textContent||"");let i=U(this.pane.element.ownerDocument.body,J(".monaco-drag-image",{},this.pane.draggableElement.textContent||""));e.dataTransfer.setDragImage(i,-10,-10),setTimeout(()=>i.remove(),0),this.context.draggable=this}onDragEnter(e){!this.context.draggable||this.context.draggable===this||this.dnd.canDrop(this.context.draggable.pane,this.pane)&&(this.dragOverCounter++,this.render())}onDragLeave(e){!this.context.draggable||this.context.draggable===this||this.dnd.canDrop(this.context.draggable.pane,this.pane)&&(this.dragOverCounter--,this.dragOverCounter===0&&this.render())}onDragEnd(e){this.context.draggable&&(this.dragOverCounter=0,this.render(),this.context.draggable=null)}onDrop(e){this.context.draggable&&(Ve.stop(e),this.dragOverCounter=0,this.render(),this.dnd.canDrop(this.context.draggable.pane,this.pane)&&this.context.draggable!==this&&this._onDidDrop.fire({from:this.context.draggable.pane,to:this.pane}),this.context.draggable=null)}render(){let e=null;this.dragOverCounter>0&&(e=this.pane.dropBackground??r.DefaultDragOverBackgroundColor.toString()),this.pane.dropTargetElement.style.backgroundColor=e||""}};var z1=class extends R{dnd;dndContext={draggable:null};element;paneItems=[];orthogonalSize=0;size=0;splitview;animationTimer=void 0;_onDidDrop=this._register(new x);onDidDrop=this._onDidDrop.event;orientation;boundarySashes;onDidSashChange;onDidSashReset;onDidScroll;constructor(t,e={}){super(),this.dnd=e.dnd,this.orientation=e.orientation??0,this.element=U(t,J(".monaco-pane-view")),this.splitview=this._register(new wc(this.element,{orientation:this.orientation})),this.onDidSashReset=this.splitview.onDidSashReset,this.onDidSashChange=this.splitview.onDidSashChange,this.onDidScroll=this.splitview.onDidScroll;let i=this._register(new B),n=this._register(new lt(this.element,"keydown")),o=X.map(X.filter(n.event,s=>on(s.target)&&s.target.classList.contains("pane-header"),i),s=>new ut(s),i);this._register(X.filter(o,s=>s.keyCode===16,i)(()=>this.focusPrevious())),this._register(X.filter(o,s=>s.keyCode===18,i)(()=>this.focusNext()))}addPane(t,e,i=this.splitview.length){let n=new B;t.onDidChangeExpansionState(this.setupAnimation,this,n);let o={pane:t,disposable:n};if(this.paneItems.splice(i,0,o),t.orientation=this.orientation,t.orthogonalSize=this.orthogonalSize,this.splitview.addView(t,e,i),this.dnd){let s=new B7(t,this.dnd,this.dndContext);n.add(s),n.add(s.onDidDrop(this._onDidDrop.fire,this._onDidDrop))}}removePane(t){let e=this.paneItems.findIndex(n=>n.pane===t);if(e===-1)return;this.splitview.removeView(e,t.isExpanded()?Rd.Distribute:void 0),this.paneItems.splice(e,1)[0].disposable.dispose()}movePane(t,e){let i=this.paneItems.findIndex(s=>s.pane===t),n=this.paneItems.findIndex(s=>s.pane===e);if(i===-1||n===-1)return;let[o]=this.paneItems.splice(i,1);this.paneItems.splice(n,0,o),this.splitview.moveView(i,n)}resizePane(t,e){let i=this.paneItems.findIndex(n=>n.pane===t);i!==-1&&this.splitview.resizeView(i,e)}getPaneSize(t){let e=this.paneItems.findIndex(i=>i.pane===t);return e===-1?-1:this.splitview.getViewSize(e)}layout(t,e){this.orthogonalSize=this.orientation===0?e:t,this.size=this.orientation===1?e:t;for(let i of this.paneItems)i.pane.orthogonalSize=this.orthogonalSize;this.splitview.layout(this.size)}setBoundarySashes(t){this.boundarySashes=t,this.updateSplitviewOrthogonalSashes(t)}updateSplitviewOrthogonalSashes(t){this.orientation===0?(this.splitview.orthogonalStartSash=t?.left,this.splitview.orthogonalEndSash=t?.right):this.splitview.orthogonalEndSash=t?.bottom}flipOrientation(t,e){this.orientation=this.orientation===0?1:0;let i=this.paneItems.map(s=>this.getPaneSize(s.pane));this.splitview.dispose(),ai(this.element),this.splitview=this._register(new wc(this.element,{orientation:this.orientation})),this.updateSplitviewOrthogonalSashes(this.boundarySashes);let n=this.orientation===0?e:t,o=this.orientation===1?e:t;this.paneItems.forEach((s,a)=>{s.pane.orthogonalSize=n,s.pane.orientation=this.orientation;let l=this.size===0?0:o*i[a]/this.size;this.splitview.addView(s.pane,l,a)}),this.size=o,this.orthogonalSize=n,this.splitview.layout(this.size)}setupAnimation(){typeof this.animationTimer=="number"&&ue(this.element).clearTimeout(this.animationTimer),this.element.classList.add("animated"),this.animationTimer=ue(this.element).setTimeout(()=>{this.animationTimer=void 0,this.element.classList.remove("animated")},200)}getPaneHeaderElements(){return[...this.element.querySelectorAll(".pane-header")]}focusPrevious(){let t=this.getPaneHeaderElements(),e=t.indexOf(this.element.ownerDocument.activeElement);e!==-1&&t[Math.max(e-1,0)].focus()}focusNext(){let t=this.getPaneHeaderElements(),e=t.indexOf(this.element.ownerDocument.activeElement);e!==-1&&t[Math.min(e+1,t.length-1)].focus()}dispose(){super.dispose(),this.paneItems.forEach(t=>t.disposable.dispose())}};var _w=/\(&([^\s&])\)|(^|[^&])&([^\s&])/,UI=/(&amp;)?(&amp;)([^\s&])/g;var eL=class r extends Fi{constructor(e,i,n,o){e.classList.add("monaco-menu-container"),e.setAttribute("role","presentation");let s=document.createElement("div");s.classList.add("monaco-menu"),s.setAttribute("role","presentation");super(s,{orientation:1,actionViewItemProvider:c=>this.doGetActionViewItem(c,n,a),context:n.context,actionRunner:n.actionRunner,ariaLabel:n.ariaLabel,ariaRole:"menu",focusOnlyEnabledItems:!0,triggerKeys:{keys:[3,...ye||ci?[10]:[]],keyDown:!0}});this.menuStyles=o;this.menuElement=s,this.actionsList.tabIndex=0,this.initializeOrUpdateStyleSheet(e,o),this._register(yi.addTarget(s)),this._register(F(s,Q.KEY_DOWN,c=>{new ut(c).equals(2)&&c.preventDefault()})),n.enableMnemonics&&this._register(F(s,Q.KEY_DOWN,c=>{let p=c.key.toLocaleLowerCase();if(this.mnemonics.has(p)){Ve.stop(c,!0);let h=this.mnemonics.get(p);if(h.length===1&&(h[0]instanceof Jk&&h[0].container&&this.focusItemByElement(h[0].container),h[0].onClick(c)),h.length>1){let m=h.shift();m&&m.container&&(this.focusItemByElement(m.container),h.push(m)),this.mnemonics.set(p,h)}}})),ci&&this._register(F(s,Q.KEY_DOWN,c=>{let p=new ut(c);p.equals(14)||p.equals(11)?(this.focusedItem=this.viewItems.length-1,this.focusNext(),Ve.stop(c,!0)):(p.equals(13)||p.equals(12))&&(this.focusedItem=0,this.focusPrevious(),Ve.stop(c,!0))})),this._register(F(this.domNode,Q.MOUSE_OUT,c=>{let p=c.relatedTarget;$n(p,this.domNode)||(this.focusedItem=void 0,this.updateFocus(),c.stopPropagation())})),this._register(F(this.actionsList,Q.MOUSE_OVER,c=>{let p=c.target;if(!(!p||!$n(p,this.actionsList)||p===this.actionsList)){for(;p.parentElement!==this.actionsList&&p.parentElement!==null;)p=p.parentElement;if(p.classList.contains("action-item")){let h=this.focusedItem;this.setFocusedItem(p),h!==this.focusedItem&&this.updateFocus()}}})),this._register(yi.addTarget(this.actionsList)),this._register(F(this.actionsList,At.Tap,c=>{let p=c.initialTarget;if(!(!p||!$n(p,this.actionsList)||p===this.actionsList)){for(;p.parentElement!==this.actionsList&&p.parentElement!==null;)p=p.parentElement;if(p.classList.contains("action-item")){let h=this.focusedItem;this.setFocusedItem(p),h!==this.focusedItem&&this.updateFocus()}}}));let a={parent:this};this.mnemonics=new Map,this.scrollableElement=this._register(new Da(s,{alwaysConsumeMouseWheel:!0,horizontal:2,vertical:3,verticalScrollbarSize:7,handleMouseWheel:!0,useShadows:!0}));let l=this.scrollableElement.getDomNode();l.style.position="",this.styleScrollElement(l,o),this._register(F(s,At.Change,c=>{Ve.stop(c,!0);let p=this.scrollableElement.getScrollPosition().scrollTop;this.scrollableElement.setScrollPosition({scrollTop:p-c.translationY})})),this._register(F(l,Q.MOUSE_UP,c=>{c.preventDefault()}));let d=ue(e);s.style.maxHeight=`${Math.max(10,d.innerHeight-e.getBoundingClientRect().top-35)}px`,i=i.filter((c,p)=>n.submenuIds?.has(c.id)?(console.warn(`Found submenu cycle: ${c.id}`),!1):!(c instanceof Qt&&(p===i.length-1||p===0||i[p-1]instanceof Qt))),this.push(i,{icon:!0,label:!0,isMenu:!0}),e.appendChild(this.scrollableElement.getDomNode()),this.scrollableElement.scanDomNode(),this.viewItems.filter(c=>!(c instanceof K1)).forEach((c,p,h)=>{c.updatePositionInSet(p+1,h.length)})}mnemonics;scrollableElement;menuElement;static globalStyleSheet;styleSheet;initializeOrUpdateStyleSheet(e,i){this.styleSheet||(sD(e)?this.styleSheet=Go(e):(r.globalStyleSheet||(r.globalStyleSheet=Go()),this.styleSheet=r.globalStyleSheet)),this.styleSheet.textContent=aCe(i,sD(e))}styleScrollElement(e,i){let n=i.foregroundColor??"",o=i.backgroundColor??"",s=i.borderColor?`1px solid ${i.borderColor}`:"",a="5px",l=i.shadowColor?`0 2px 8px ${i.shadowColor}`:"";e.style.outline=s,e.style.borderRadius=a,e.style.color=n,e.style.backgroundColor=o,e.style.boxShadow=l}getContainer(){return this.scrollableElement.getDomNode()}get onScroll(){return this.scrollableElement.onScroll}get scrollOffset(){return this.menuElement.scrollTop}trigger(e){if(e<=this.viewItems.length&&e>=0){let i=this.viewItems[e];if(i instanceof Jk)super.focus(e),i.open(!0);else if(i instanceof tL)super.run(i._action,i._context);else return}}focusItemByElement(e){let i=this.focusedItem;this.setFocusedItem(e),i!==this.focusedItem&&this.updateFocus()}setFocusedItem(e){for(let i=0;i<this.actionsList.children.length;i++){let n=this.actionsList.children[i];if(e===n){this.focusedItem=i;break}}}updateFocus(e){super.updateFocus(e,!0,!0),typeof this.focusedItem<"u"&&this.scrollableElement.setScrollPosition({scrollTop:Math.round(this.menuElement.scrollTop)})}doGetActionViewItem(e,i,n){if(e instanceof Qt)return new K1(i.context,e,{icon:!0},this.menuStyles);if(e instanceof vo){let o=new Jk(e,e.actions,n,{...i,submenuIds:new Set([...i.submenuIds||[],e.id])},this.menuStyles);if(i.enableMnemonics){let s=o.getMnemonic();if(s&&o.isEnabled()){let a=[];this.mnemonics.has(s)&&(a=this.mnemonics.get(s)),a.push(o),this.mnemonics.set(s,a)}}return o}else{let o={enableMnemonics:i.enableMnemonics,useEventAsContext:i.useEventAsContext};if(i.getKeyBinding){let a=i.getKeyBinding(e);if(a){let l=a.getLabel();l&&(o.keybinding=l)}}let s=new tL(i.context,e,o,this.menuStyles);if(i.enableMnemonics){let a=s.getMnemonic();if(a&&s.isEnabled()){let l=[];this.mnemonics.has(a)&&(l=this.mnemonics.get(a)),l.push(s),this.mnemonics.set(a,l)}}return s}}},tL=class extends Yn{constructor(e,i,n,o){n.isMenu=!0;super(i,i,n);this.menuStyle=o;if(this.options=n,this.options.icon=n.icon!==void 0?n.icon:!1,this.options.label=n.label!==void 0?n.label:!0,this.cssClass="",this.options.label&&n.enableMnemonics){let s=this.action.label;if(s){let a=_w.exec(s);a&&(this.mnemonic=(a[1]?a[1]:a[3]).toLocaleLowerCase())}}this.runOnceToEnableMouseUp=new Ye(()=>{this.element&&(this._register(F(this.element,Q.MOUSE_UP,s=>{if(Ve.stop(s,!0),po){if(new _i(ue(this.element),s).rightButton)return;this.onClick(s)}else setTimeout(()=>{this.onClick(s)},0)})),this._register(F(this.element,Q.CONTEXT_MENU,s=>{Ve.stop(s,!0)})))},100),this._register(this.runOnceToEnableMouseUp)}container;options;item;runOnceToEnableMouseUp;label;check;mnemonic;cssClass;render(e){super.render(e),this.element&&(this.container=e,this.item=U(this.element,J("a.action-menu-item")),this._action.id===Qt.ID?this.item.setAttribute("role","presentation"):(this.item.setAttribute("role","menuitem"),this.mnemonic&&this.item.setAttribute("aria-keyshortcuts",`${this.mnemonic}`)),this.check=U(this.item,J("span.menu-item-check"+de.asCSSSelector(N.menuSelection))),this.check.setAttribute("role","none"),this.label=U(this.item,J("span.action-label")),this.options.label&&this.options.keybinding&&(U(this.item,J("span.keybinding")).textContent=this.options.keybinding),this.runOnceToEnableMouseUp.schedule(),this.updateClass(),this.updateLabel(),this.updateTooltip(),this.updateEnabled(),this.updateChecked(),this.applyStyle())}blur(){super.blur(),this.applyStyle()}focus(){super.focus(),this.item?.focus(),this.applyStyle()}updatePositionInSet(e,i){this.item&&(this.item.setAttribute("aria-posinset",`${e}`),this.item.setAttribute("aria-setsize",`${i}`))}updateLabel(){if(this.label&&this.options.label){ai(this.label);let e=pD(this.action.label);if(e){let i=G1(e);this.options.enableMnemonics||(e=i),this.label.setAttribute("aria-label",i.replace(/&&/g,"&"));let n=_w.exec(e);if(n){e=Cp(e),UI.lastIndex=0;let o=UI.exec(e);for(;o&&o[1];)o=UI.exec(e);let s=a=>a.replace(/&amp;&amp;/g,"&amp;");o?this.label.append(wp(s(e.substr(0,o.index))," "),J("u",{"aria-hidden":"true"},o[3]),Qg(s(e.substr(o.index+o[0].length))," ")):this.label.innerText=s(e).trim(),this.item?.setAttribute("aria-keyshortcuts",(n[1]?n[1]:n[3]).toLocaleLowerCase())}else this.label.innerText=e.replace(/&&/g,"&").trim()}}}updateTooltip(){}updateClass(){this.cssClass&&this.item&&this.item.classList.remove(...this.cssClass.split(" ")),this.options.icon&&this.label?(this.cssClass=this.action.class||"",this.label.classList.add("icon"),this.cssClass&&this.label.classList.add(...this.cssClass.split(" ")),this.updateEnabled()):this.label&&this.label.classList.remove("icon")}updateEnabled(){this.action.enabled?(this.element&&(this.element.classList.remove("disabled"),this.element.removeAttribute("aria-disabled")),this.item&&(this.item.classList.remove("disabled"),this.item.removeAttribute("aria-disabled"),this.item.tabIndex=0)):(this.element&&(this.element.classList.add("disabled"),this.element.setAttribute("aria-disabled","true")),this.item&&(this.item.classList.add("disabled"),this.item.setAttribute("aria-disabled","true")))}updateChecked(){if(!this.item)return;let e=this.action.checked;this.item.classList.toggle("checked",!!e),e!==void 0?(this.item.setAttribute("role","menuitemcheckbox"),this.item.setAttribute("aria-checked",e?"true":"false")):(this.item.setAttribute("role","menuitem"),this.item.setAttribute("aria-checked",""))}getMnemonic(){return this.mnemonic}applyStyle(){let e=this.element&&this.element.classList.contains("focused"),i=e&&this.menuStyle.selectionForegroundColor?this.menuStyle.selectionForegroundColor:this.menuStyle.foregroundColor,n=e&&this.menuStyle.selectionBackgroundColor?this.menuStyle.selectionBackgroundColor:void 0,o=e&&this.menuStyle.selectionBorderColor?`1px solid ${this.menuStyle.selectionBorderColor}`:"",s=e&&this.menuStyle.selectionBorderColor?"-1px":"";this.item&&(this.item.style.color=i??"",this.item.style.backgroundColor=n??"",this.item.style.outline=o,this.item.style.outlineOffset=s),this.check&&(this.check.style.color=i??"")}},Jk=class extends tL{constructor(e,i,n,o,s){super(e,e,o,s);this.submenuActions=i;this.parentData=n;this.submenuOptions=o;this.expandDirection=o&&o.expandDirection!==void 0?o.expandDirection:{horizontal:0,vertical:1},this.showScheduler=new Ye(()=>{this.mouseOver&&(this.cleanupExistingSubmenu(!1),this.createSubmenu(!1))},250),this.hideScheduler=new Ye(()=>{this.element&&!$n(fo(),this.element)&&this.parentData.submenu===this.mysubmenu&&(this.parentData.parent.focus(!1),this.cleanupExistingSubmenu(!0))},750)}mysubmenu=null;submenuContainer;submenuIndicator;submenuDisposables=this._register(new B);mouseOver=!1;showScheduler;hideScheduler;expandDirection;render(e){super.render(e),this.element&&(this.item&&(this.item.classList.add("monaco-submenu-item"),this.item.tabIndex=0,this.item.setAttribute("aria-haspopup","true"),this.updateAriaExpanded("false"),this.submenuIndicator=U(this.item,J("span.submenu-indicator"+de.asCSSSelector(N.menuSubmenu))),this.submenuIndicator.setAttribute("aria-hidden","true")),this._register(F(this.element,Q.KEY_UP,i=>{let n=new ut(i);(n.equals(17)||n.equals(3))&&(Ve.stop(i,!0),this.createSubmenu(!0))})),this._register(F(this.element,Q.KEY_DOWN,i=>{let n=new ut(i);fo()===this.item&&(n.equals(17)||n.equals(3))&&Ve.stop(i,!0)})),this._register(F(this.element,Q.MOUSE_OVER,i=>{this.mouseOver||(this.mouseOver=!0,this.showScheduler.schedule())})),this._register(F(this.element,Q.MOUSE_LEAVE,i=>{this.mouseOver=!1})),this._register(F(this.element,Q.FOCUS_OUT,i=>{this.element&&!$n(fo(),this.element)&&this.hideScheduler.schedule()})),this._register(this.parentData.parent.onScroll(()=>{this.parentData.submenu===this.mysubmenu&&(this.parentData.parent.focus(!1),this.cleanupExistingSubmenu(!0))})))}updateEnabled(){}open(e){this.cleanupExistingSubmenu(!1),this.createSubmenu(e)}onClick(e){Ve.stop(e,!0),this.cleanupExistingSubmenu(!1),this.createSubmenu(!0)}cleanupExistingSubmenu(e){if(this.parentData.submenu&&(e||this.parentData.submenu!==this.mysubmenu)){try{this.parentData.submenu.dispose()}catch{}this.parentData.submenu=void 0,this.updateAriaExpanded("false"),this.submenuContainer&&(this.submenuDisposables.clear(),this.submenuContainer=void 0)}}calculateSubmenuMenuLayout(e,i,n,o){let s={top:0,left:0};return s.left=i7(e.width,i.width,{position:o.horizontal===0?0:1,offset:n.left,size:n.width}),s.left>=n.left&&s.left<n.left+n.width&&(n.left+10+i.width<=e.width&&(s.left=n.left+10),n.top+=10,n.height=0),s.top=i7(e.height,i.height,{position:0,offset:n.top,size:0}),s.top+i.height===n.top&&s.top+n.height+i.height<=e.height&&(s.top+=n.height),s}createSubmenu(e=!0){if(this.element)if(this.parentData.submenu)this.parentData.submenu.focus(!1);else{this.updateAriaExpanded("true"),this.submenuContainer=U(this.element,J("div.monaco-submenu")),this.submenuContainer.classList.add("menubar-menu-items-holder","context-view");let i=ue(this.parentData.parent.domNode).getComputedStyle(this.parentData.parent.domNode),n=parseFloat(i.paddingTop||"0")||0;this.submenuContainer.style.zIndex="1",this.submenuContainer.style.position="fixed",this.submenuContainer.style.top="0",this.submenuContainer.style.left="0",this.parentData.submenu=new eL(this.submenuContainer,this.submenuActions.length?this.submenuActions:[new vO],this.submenuOptions,this.menuStyle);let o=this.element.getBoundingClientRect(),s={top:o.top-n,left:o.left,height:o.height+2*n,width:o.width},a=this.submenuContainer.getBoundingClientRect(),l=ue(this.element),{top:d,left:c}=this.calculateSubmenuMenuLayout(new Ge(l.innerWidth,l.innerHeight),Ge.lift(a),s,this.expandDirection);this.submenuContainer.style.left=`${c-a.left}px`,this.submenuContainer.style.top=`${d-a.top}px`,this.submenuDisposables.add(F(this.submenuContainer,Q.KEY_UP,p=>{new ut(p).equals(15)&&(Ve.stop(p,!0),this.parentData.parent.focus(),this.cleanupExistingSubmenu(!0))})),this.submenuDisposables.add(F(this.submenuContainer,Q.KEY_DOWN,p=>{new ut(p).equals(15)&&Ve.stop(p,!0)})),this.submenuDisposables.add(this.parentData.submenu.onDidCancel(()=>{this.parentData.parent.focus(),this.cleanupExistingSubmenu(!0)})),this.parentData.submenu.focus(e),this.mysubmenu=this.parentData.submenu}}updateAriaExpanded(e){this.item&&this.item?.setAttribute("aria-expanded",e)}applyStyle(){super.applyStyle();let i=this.element&&this.element.classList.contains("focused")&&this.menuStyle.selectionForegroundColor?this.menuStyle.selectionForegroundColor:this.menuStyle.foregroundColor;this.submenuIndicator&&(this.submenuIndicator.style.color=i??"")}dispose(){super.dispose(),this.hideScheduler.dispose(),this.mysubmenu&&(this.mysubmenu.dispose(),this.mysubmenu=null),this.submenuContainer&&(this.submenuContainer=void 0)}},K1=class extends Kl{constructor(e,i,n,o){super(e,i,n);this.menuStyles=o}render(e){super.render(e),this.label&&(this.label.style.borderBottomColor=this.menuStyles.separatorColor?`${this.menuStyles.separatorColor}`:"")}};function G1(r){let t=_w,e=t.exec(r);if(!e)return r;let i=!e[1];return r.replace(t,i?"$2$3":"").trim()}function Oae(r){let t=XA()[r.id];return`.codicon-${r.id}:before { content: '\\${t.toString(16)}'; }`}function aCe(r,t){let e=`
.monaco-menu {
	font-size: 13px;
	border-radius: 5px;
	min-width: 160px;
}

${Oae(N.menuSelection)}
${Oae(N.menuSubmenu)}

.monaco-menu .monaco-action-bar {
	text-align: right;
	overflow: hidden;
	white-space: nowrap;
}

.monaco-menu .monaco-action-bar .actions-container {
	display: flex;
	margin: 0 auto;
	padding: 0;
	width: 100%;
	justify-content: flex-end;
}

.monaco-menu .monaco-action-bar.vertical .actions-container {
	display: inline-block;
}

.monaco-menu .monaco-action-bar.reverse .actions-container {
	flex-direction: row-reverse;
}

.monaco-menu .monaco-action-bar .action-item {
	cursor: pointer;
	display: inline-block;
	transition: transform 50ms ease;
	position: relative;  /* DO NOT REMOVE - this is the key to preventing the ghosting icon bug in Chrome 42 */
}

.monaco-menu .monaco-action-bar .action-item.disabled {
	cursor: default;
}

.monaco-menu .monaco-action-bar .action-item .icon,
.monaco-menu .monaco-action-bar .action-item .codicon {
	display: inline-block;
}

.monaco-menu .monaco-action-bar .action-item .codicon {
	display: flex;
	align-items: center;
}

.monaco-menu .monaco-action-bar .action-label {
	font-size: 11px;
	margin-right: 4px;
}

.monaco-menu .monaco-action-bar .action-item.disabled .action-label,
.monaco-menu .monaco-action-bar .action-item.disabled .action-label:hover {
	color: var(--vscode-disabledForeground);
}

/* Vertical actions */

.monaco-menu .monaco-action-bar.vertical {
	text-align: left;
}

.monaco-menu .monaco-action-bar.vertical .action-item {
	display: block;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator {
	display: block;
	border-bottom: 1px solid var(--vscode-menu-separatorBackground);
	padding-top: 1px;
	padding: 30px;
}

.monaco-menu .secondary-actions .monaco-action-bar .action-label {
	margin-left: 6px;
}

/* Action Items */
.monaco-menu .monaco-action-bar .action-item.select-container {
	overflow: hidden; /* somehow the dropdown overflows its container, we prevent it here to not push */
	flex: 1;
	max-width: 170px;
	min-width: 60px;
	display: flex;
	align-items: center;
	justify-content: center;
	margin-right: 10px;
}

.monaco-menu .monaco-action-bar.vertical {
	margin-left: 0;
	overflow: visible;
}

.monaco-menu .monaco-action-bar.vertical .actions-container {
	display: block;
}

.monaco-menu .monaco-action-bar.vertical .action-item {
	padding: 0;
	transform: none;
	display: flex;
}

.monaco-menu .monaco-action-bar.vertical .action-item.active {
	transform: none;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item {
	flex: 1 1 auto;
	display: flex;
	height: 2em;
	align-items: center;
	position: relative;
	margin: 0 4px;
	border-radius: 4px;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item:hover .keybinding,
.monaco-menu .monaco-action-bar.vertical .action-menu-item:focus .keybinding {
	opacity: unset;
}

.monaco-menu .monaco-action-bar.vertical .action-label {
	flex: 1 1 auto;
	text-decoration: none;
	padding: 0 1em;
	background: none;
	font-size: 12px;
	line-height: 1;
}

.monaco-menu .monaco-action-bar.vertical .keybinding,
.monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	display: inline-block;
	flex: 2 1 auto;
	padding: 0 1em;
	text-align: right;
	font-size: 12px;
	line-height: 1;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	height: 100%;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator.codicon {
	font-size: 16px !important;
	display: flex;
	align-items: center;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator.codicon::before {
	margin-left: auto;
	margin-right: -20px;
}

.monaco-menu .monaco-action-bar.vertical .action-item.disabled .keybinding,
.monaco-menu .monaco-action-bar.vertical .action-item.disabled .submenu-indicator {
	opacity: 0.4;
}

.monaco-menu .monaco-action-bar.vertical .action-label:not(.separator) {
	display: inline-block;
	box-sizing: border-box;
	margin: 0;
}

.monaco-menu .monaco-action-bar.vertical .action-item {
	position: static;
	overflow: visible;
}

.monaco-menu .monaco-action-bar.vertical .action-item .monaco-submenu {
	position: absolute;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator {
	width: 100%;
	height: 0px !important;
	opacity: 1;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator.text {
	padding: 0.7em 1em 0.1em 1em;
	font-weight: bold;
	opacity: 1;
}

.monaco-menu .monaco-action-bar.vertical .action-label:hover {
	color: inherit;
}

.monaco-menu .monaco-action-bar.vertical .menu-item-check {
	position: absolute;
	visibility: hidden;
	width: 1em;
	height: 100%;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item.checked .menu-item-check {
	visibility: visible;
	display: flex;
	align-items: center;
	justify-content: center;
}

/* Context Menu */

.context-view.monaco-menu-container {
	outline: 0;
	border: none;
	animation: fadeIn 0.083s linear;
	-webkit-app-region: no-drag;
}

.context-view.monaco-menu-container :focus,
.context-view.monaco-menu-container .monaco-action-bar.vertical:focus,
.context-view.monaco-menu-container .monaco-action-bar.vertical :focus {
	outline: 0;
}

.hc-black .context-view.monaco-menu-container,
.hc-light .context-view.monaco-menu-container,
:host-context(.hc-black) .context-view.monaco-menu-container,
:host-context(.hc-light) .context-view.monaco-menu-container {
	box-shadow: none;
}

.hc-black .monaco-menu .monaco-action-bar.vertical .action-item.focused,
.hc-light .monaco-menu .monaco-action-bar.vertical .action-item.focused,
:host-context(.hc-black) .monaco-menu .monaco-action-bar.vertical .action-item.focused,
:host-context(.hc-light) .monaco-menu .monaco-action-bar.vertical .action-item.focused {
	background: none;
}

/* Vertical Action Bar Styles */

.monaco-menu .monaco-action-bar.vertical {
	padding: 4px 0;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item {
	height: 2em;
}

.monaco-menu .monaco-action-bar.vertical .action-label:not(.separator),
.monaco-menu .monaco-action-bar.vertical .keybinding {
	font-size: inherit;
	padding: 0 2em;
	max-height: 100%;
}

.monaco-menu .monaco-action-bar.vertical .menu-item-check {
	font-size: inherit;
	width: 2em;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator {
	font-size: inherit;
	margin: 5px 0 !important;
	padding: 0;
	border-radius: 0;
}

.linux .monaco-menu .monaco-action-bar.vertical .action-label.separator,
:host-context(.linux) .monaco-menu .monaco-action-bar.vertical .action-label.separator {
	margin-left: 0;
	margin-right: 0;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	font-size: 60%;
	padding: 0 1.8em;
}

.linux .monaco-menu .monaco-action-bar.vertical .submenu-indicator,
:host-context(.linux) .monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	height: 100%;
	mask-size: 10px 10px;
	-webkit-mask-size: 10px 10px;
}

.monaco-menu .action-item {
	cursor: default;
}`;if(t){e+=`
			/* Arrows */
			.monaco-scrollable-element > .scrollbar > .scra {
				cursor: pointer;
				font-size: 11px !important;
			}

			.monaco-scrollable-element > .visible {
				opacity: 1;

				/* Background rule added for IE9 - to allow clicks on dom node */
				background:rgba(0,0,0,0);

				transition: opacity 100ms linear;
			}
			.monaco-scrollable-element > .invisible {
				opacity: 0;
				pointer-events: none;
			}
			.monaco-scrollable-element > .invisible.fade {
				transition: opacity 800ms linear;
			}

			/* Scrollable Content Inset Shadow */
			.monaco-scrollable-element > .shadow {
				position: absolute;
				display: none;
			}
			.monaco-scrollable-element > .shadow.top {
				display: block;
				top: 0;
				left: 3px;
				height: 3px;
				width: 100%;
			}
			.monaco-scrollable-element > .shadow.left {
				display: block;
				top: 3px;
				left: 0;
				height: 100%;
				width: 3px;
			}
			.monaco-scrollable-element > .shadow.top-left-corner {
				display: block;
				top: 0;
				left: 0;
				height: 3px;
				width: 3px;
			}
		`;let i=r.scrollbarShadow;i&&(e+=`
				.monaco-scrollable-element > .shadow.top {
					box-shadow: ${i} 0 6px 6px -6px inset;
				}

				.monaco-scrollable-element > .shadow.left {
					box-shadow: ${i} 6px 0 6px -6px inset;
				}

				.monaco-scrollable-element > .shadow.top.left {
					box-shadow: ${i} 6px 6px 6px -6px inset;
				}
			`);let n=r.scrollbarSliderBackground;n&&(e+=`
				.monaco-scrollable-element > .scrollbar > .slider {
					background: ${n};
				}
			`);let o=r.scrollbarSliderHoverBackground;o&&(e+=`
				.monaco-scrollable-element > .scrollbar > .slider:hover {
					background: ${o};
				}
			`);let s=r.scrollbarSliderActiveBackground;s&&(e+=`
				.monaco-scrollable-element > .scrollbar > .slider.active {
					background: ${s};
				}
			`)}return e}var V7=class extends jo{_element;boxContainer;_label;contents;visible;_onDidChangeVisibility=this._register(new x);onDidChangeVisibility=this._onDidChangeVisibility.event;hover;constructor(t,e){super(),this._element=U(t,J(".monaco-dropdown")),this._label=U(this._element,J(".dropdown-label"));let i=e.labelRenderer;i||(i=o=>(o.textContent=e.label||"",null));for(let o of[Q.CLICK,Q.MOUSE_DOWN,At.Tap])this._register(F(this.element,o,s=>Ve.stop(s,!0)));for(let o of[Q.MOUSE_DOWN,At.Tap])this._register(F(this._label,o,s=>{Za(s)&&(s.detail>1||s.button!==0)||(this.visible?this.hide():this.show())}));this._register(F(this._label,Q.KEY_UP,o=>{let s=new ut(o);(s.equals(3)||s.equals(10))&&(Ve.stop(o,!0),this.visible?this.hide():this.show())}));let n=i(this._label);n&&this._register(n),this._register(yi.addTarget(this._label))}get element(){return this._element}get label(){return this._label}set tooltip(t){this._label&&(!this.hover&&t!==""?this.hover=this._register(Bo().setupManagedHover(gt("mouse"),this._label,t)):this.hover&&this.hover.update(t))}show(){this.visible||(this.visible=!0,this._onDidChangeVisibility.fire(!0))}hide(){this.visible&&(this.visible=!1,this._onDidChangeVisibility.fire(!1))}isVisible(){return!!this.visible}onEvent(t,e){this.hide()}dispose(){super.dispose(),this.hide(),this.boxContainer&&(this.boxContainer.remove(),this.boxContainer=void 0),this.contents&&(this.contents.remove(),this.contents=void 0),this._label&&(this._label.remove(),this._label=void 0)}},q1=class extends V7{constructor(e,i){super(e,i);this._options=i;this.actions=i.actions||[]}_menuOptions;_actions=[];set menuOptions(e){this._menuOptions=e}get menuOptions(){return this._menuOptions}get actions(){return this._options.actionProvider?this._options.actionProvider.getActions():this._actions}set actions(e){this._actions=e}show(){super.show(),this.element.classList.add("active"),this._options.contextMenuProvider.showContextMenu({getAnchor:()=>this.element,getActions:()=>this.actions,getActionsContext:()=>this.menuOptions?this.menuOptions.context:null,getActionViewItem:(e,i)=>this.menuOptions&&this.menuOptions.actionViewItemProvider?this.menuOptions.actionViewItemProvider(e,i):void 0,getKeyBinding:e=>this.menuOptions&&this.menuOptions.getKeyBinding?this.menuOptions.getKeyBinding(e):void 0,getMenuClassName:()=>this._options.menuClassName||"",onHide:()=>this.onHide(),actionRunner:this.menuOptions?this.menuOptions.actionRunner:void 0,anchorAlignment:this.menuOptions?this.menuOptions.anchorAlignment:0,domForShadowRoot:this._options.menuAsChild?this.element:void 0,skipTelemetry:this._options.skipTelemetry})}hide(){super.hide()}onHide(){this.hide(),this.element.classList.remove("active")}};var Tu=class extends Yn{menuActionsOrProvider;dropdownMenu;contextMenuProvider;actionItem=null;_onDidChangeVisibility=this._register(new x);onDidChangeVisibility=this._onDidChangeVisibility.event;options;constructor(t,e,i,n=Object.create(null)){super(null,t,n),this.menuActionsOrProvider=e,this.contextMenuProvider=i,this.options=n,this.options.actionRunner&&(this.actionRunner=this.options.actionRunner)}render(t){this.actionItem=t;let e=o=>{this.element=U(o,J("a.action-label"));let s=[];return typeof this.options.classNames=="string"?s=this.options.classNames.split(/\s+/g).filter(a=>!!a):this.options.classNames&&(s=this.options.classNames),s.find(a=>a==="icon")||s.push("codicon"),this.element.classList.add(...s),this.element.setAttribute("role","button"),this.element.setAttribute("aria-haspopup","true"),this.element.setAttribute("aria-expanded","false"),this._action.label&&this._register(Bo().setupManagedHover(this.options.hoverDelegate??gt("mouse"),this.element,this._action.label)),this.element.ariaLabel=this._action.label||"",null},i=Array.isArray(this.menuActionsOrProvider),n={contextMenuProvider:this.contextMenuProvider,labelRenderer:e,menuAsChild:this.options.menuAsChild,actions:i?this.menuActionsOrProvider:void 0,actionProvider:i?void 0:this.menuActionsOrProvider,skipTelemetry:this.options.skipTelemetry};if(this.dropdownMenu=this._register(new q1(t,n)),this._register(this.dropdownMenu.onDidChangeVisibility(o=>{this.element?.setAttribute("aria-expanded",`${o}`),this._onDidChangeVisibility.fire(o)})),this.dropdownMenu.menuOptions={actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,getKeyBinding:this.options.keybindingProvider,context:this._context},this.options.anchorAlignmentProvider){let o=this;this.dropdownMenu.menuOptions={...this.dropdownMenu.menuOptions,get anchorAlignment(){return o.options.anchorAlignmentProvider()}}}this.updateTooltip(),this.updateEnabled()}getTooltip(){let t=null;return this.action.tooltip?t=this.action.tooltip:this.action.label&&(t=this.action.label),t??void 0}setActionContext(t){super.setActionContext(t),this.dropdownMenu&&(this.dropdownMenu.menuOptions?this.dropdownMenu.menuOptions.context=t:this.dropdownMenu.menuOptions={context:t})}show(){this.dropdownMenu?.show()}updateEnabled(){let t=!this.action.enabled;this.actionItem?.classList.toggle("disabled",t),this.element?.classList.toggle("disabled",t)}};var Dw=class{modifierLabels;constructor(t,e,i=e){this.modifierLabels=[null],this.modifierLabels[2]=t,this.modifierLabels[1]=e,this.modifierLabels[3]=i}toLabel(t,e,i){if(e.length===0)return null;let n=[];for(let o=0,s=e.length;o<s;o++){let a=e[o],l=i(a);if(l===null)return null;n[o]=lCe(a,l,this.modifierLabels[t])}return n.join(" ")}},j1=new Dw({ctrlKey:"\u2303",shiftKey:"\u21E7",altKey:"\u2325",metaKey:"\u2318",separator:""},{ctrlKey:u({key:"ctrlKey",comment:["This is the short form for the Control key on the keyboard"]},"Ctrl"),shiftKey:u({key:"shiftKey",comment:["This is the short form for the Shift key on the keyboard"]},"Shift"),altKey:u({key:"altKey",comment:["This is the short form for the Alt key on the keyboard"]},"Alt"),metaKey:u({key:"windowsKey",comment:["This is the short form for the Windows key on the keyboard"]},"Windows"),separator:"+"},{ctrlKey:u({key:"ctrlKey",comment:["This is the short form for the Control key on the keyboard"]},"Ctrl"),shiftKey:u({key:"shiftKey",comment:["This is the short form for the Shift key on the keyboard"]},"Shift"),altKey:u({key:"altKey",comment:["This is the short form for the Alt key on the keyboard"]},"Alt"),metaKey:u({key:"superKey",comment:["This is the short form for the Super key on the keyboard"]},"Super"),separator:"+"}),E2t=new Dw({ctrlKey:u({key:"ctrlKey.long",comment:["This is the long form for the Control key on the keyboard"]},"Control"),shiftKey:u({key:"shiftKey.long",comment:["This is the long form for the Shift key on the keyboard"]},"Shift"),altKey:u({key:"optKey.long",comment:["This is the long form for the Alt/Option key on the keyboard"]},"Option"),metaKey:u({key:"cmdKey.long",comment:["This is the long form for the Command key on the keyboard"]},"Command"),separator:"+"},{ctrlKey:u({key:"ctrlKey.long",comment:["This is the long form for the Control key on the keyboard"]},"Control"),shiftKey:u({key:"shiftKey.long",comment:["This is the long form for the Shift key on the keyboard"]},"Shift"),altKey:u({key:"altKey.long",comment:["This is the long form for the Alt key on the keyboard"]},"Alt"),metaKey:u({key:"windowsKey.long",comment:["This is the long form for the Windows key on the keyboard"]},"Windows"),separator:"+"},{ctrlKey:u({key:"ctrlKey.long",comment:["This is the long form for the Control key on the keyboard"]},"Control"),shiftKey:u({key:"shiftKey.long",comment:["This is the long form for the Shift key on the keyboard"]},"Shift"),altKey:u({key:"altKey.long",comment:["This is the long form for the Alt key on the keyboard"]},"Alt"),metaKey:u({key:"superKey.long",comment:["This is the long form for the Super key on the keyboard"]},"Super"),separator:"+"}),x2t=new Dw({ctrlKey:"Ctrl",shiftKey:"Shift",altKey:"Alt",metaKey:"Cmd",separator:"+"},{ctrlKey:"Ctrl",shiftKey:"Shift",altKey:"Alt",metaKey:"Super",separator:"+"}),T2t=new Dw({ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"cmd",separator:"+"},{ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"win",separator:"+"},{ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"meta",separator:"+"});function lCe(r,t,e){if(t===null)return"";let i=[];return r.ctrlKey&&i.push(e.ctrlKey),r.shiftKey&&i.push(e.shiftKey),r.altKey&&i.push(e.altKey),r.metaKey&&i.push(e.metaKey),t!==""&&i.push(t),i.join(e.separator)}var so=q("contextViewService"),vt=q("contextMenuService");var Lzt={buttonBackground:"#0E639C",buttonHoverBackground:"#006BB3",buttonSeparator:j.white.toString(),buttonForeground:j.white.toString(),buttonBorder:void 0,buttonSecondaryBackground:void 0,buttonSecondaryForeground:void 0,buttonSecondaryHoverBackground:void 0},zI=class extends R{options;_element;_label="";_labelElement;_labelShortElement;_hover;_onDidClick=this._register(new x);get onDidClick(){return this._onDidClick.event}_onDidEscape=this._register(new x);get onDidEscape(){return this._onDidEscape.event}focusTracker;constructor(t,e){super(),this.options=e,this._element=document.createElement("a"),this._element.classList.add("monaco-button"),this._element.tabIndex=0,this._element.setAttribute("role","button"),this._element.classList.toggle("secondary",!!e.secondary);let i=e.secondary?e.buttonSecondaryBackground:e.buttonBackground,n=e.secondary?e.buttonSecondaryForeground:e.buttonForeground;this._element.style.color=n||"",this._element.style.backgroundColor=i||"",e.supportShortLabel&&(this._labelShortElement=document.createElement("div"),this._labelShortElement.classList.add("monaco-button-label-short"),this._element.appendChild(this._labelShortElement),this._labelElement=document.createElement("div"),this._labelElement.classList.add("monaco-button-label"),this._element.appendChild(this._labelElement),this._element.classList.add("monaco-text-button-with-short-label")),typeof e.title=="string"&&this.setTitle(e.title),typeof e.ariaLabel=="string"&&this._element.setAttribute("aria-label",e.ariaLabel),t.appendChild(this._element),this._register(yi.addTarget(this._element)),[Q.CLICK,At.Tap].forEach(o=>{this._register(F(this._element,o,s=>{if(!this.enabled){Ve.stop(s);return}this._onDidClick.fire(s)}))}),this._register(F(this._element,Q.KEY_DOWN,o=>{let s=new ut(o),a=!1;this.enabled&&(s.equals(3)||s.equals(10))?(this._onDidClick.fire(o),a=!0):s.equals(9)&&(this._onDidEscape.fire(o),this._element.blur(),a=!0),a&&Ve.stop(s,!0)})),this._register(F(this._element,Q.MOUSE_OVER,o=>{this._element.classList.contains("disabled")||this.updateBackground(!0)})),this._register(F(this._element,Q.MOUSE_OUT,o=>{this.updateBackground(!1)})),this.focusTracker=this._register(Er(this._element)),this._register(this.focusTracker.onDidFocus(()=>{this.enabled&&this.updateBackground(!0)})),this._register(this.focusTracker.onDidBlur(()=>{this.enabled&&this.updateBackground(!1)}))}dispose(){super.dispose(),this._element.remove()}getContentElements(t){let e=[];for(let i of zl(t))if(typeof i=="string"){if(i=i.trim(),i==="")continue;let n=document.createElement("span");n.textContent=i,e.push(n)}else e.push(i);return e}updateBackground(t){let e;this.options.secondary?e=t?this.options.buttonSecondaryHoverBackground:this.options.buttonSecondaryBackground:e=t?this.options.buttonHoverBackground:this.options.buttonBackground,e&&(this._element.style.backgroundColor=e)}get element(){return this._element}set label(t){if(this._label===t||ya(this._label)&&ya(t)&&YA(this._label,t))return;this._element.classList.add("monaco-text-button");let e=this.options.supportShortLabel?this._labelElement:this._element;if(ya(t)){let n=Qf(t,{inline:!0});n.dispose();let o=n.element.querySelector("p")?.innerHTML;if(o){let s=Z_(o,{ADD_TAGS:["b","i","u","code","span"],ALLOWED_ATTR:["class"],RETURN_TRUSTED_TYPE:!0});e.innerHTML=s}else bo(e)}else this.options.supportIcons?bo(e,...this.getContentElements(t)):e.textContent=t;let i="";typeof this.options.title=="string"?i=this.options.title:this.options.title&&(i=gae(t)),this.setTitle(i),typeof this.options.ariaLabel=="string"?this._element.setAttribute("aria-label",this.options.ariaLabel):this.options.ariaLabel&&this._element.setAttribute("aria-label",i),this._label=t}get label(){return this._label}set labelShort(t){!this.options.supportShortLabel||!this._labelShortElement||(this.options.supportIcons?bo(this._labelShortElement,...this.getContentElements(t)):this._labelShortElement.textContent=t)}set icon(t){this._element.classList.add(...de.asClassNameArray(t))}set enabled(t){t?(this._element.classList.remove("disabled"),this._element.setAttribute("aria-disabled",String(!1)),this._element.tabIndex=0):(this._element.classList.add("disabled"),this._element.setAttribute("aria-disabled",String(!0)))}get enabled(){return!this._element.classList.contains("disabled")}set checked(t){t?(this._element.classList.add("checked"),this._element.setAttribute("aria-checked","true")):(this._element.classList.remove("checked"),this._element.setAttribute("aria-checked","false"))}get checked(){return this._element.classList.contains("checked")}setTitle(t){!this._hover&&t!==""?this._hover=this._register(Bo().setupManagedHover(this.options.hoverDelegate??gt("mouse"),this._element,t)):this._hover&&this._hover.update(t)}focus(){this._element.focus()}hasFocus(){return fs(this._element)}};var X1=J,Nae={keybindingLabelBackground:void 0,keybindingLabelForeground:void 0,keybindingLabelBorder:void 0,keybindingLabelBottomBorder:void 0,keybindingLabelShadow:void 0},Y1=class r extends R{constructor(e,i,n){super();this.os=i;this.options=n||Object.create(null);let o=this.options.keybindingLabelForeground;this.domNode=U(e,X1(".monaco-keybinding")),o&&(this.domNode.style.color=o),this.hover=this._register(Bo().setupManagedHover(gt("mouse"),this.domNode,"")),this.didEverRender=!1,e.appendChild(this.domNode)}domNode;options;keyElements=new Set;hover;keybinding;matches;didEverRender;get element(){return this.domNode}set(e,i){this.didEverRender&&this.keybinding===e&&r.areSame(this.matches,i)||(this.keybinding=e,this.matches=i,this.render())}render(){if(this.clear(),this.keybinding){let e=this.keybinding.getChords();e[0]&&this.renderChord(this.domNode,e[0],this.matches?this.matches.firstPart:null);for(let n=1;n<e.length;n++)U(this.domNode,X1("span.monaco-keybinding-key-chord-separator",void 0," ")),this.renderChord(this.domNode,e[n],this.matches?this.matches.chordPart:null);let i=this.options.disableTitle??!1?void 0:this.keybinding.getAriaLabel()||void 0;this.hover.update(i),this.domNode.setAttribute("aria-label",i||"")}else this.options&&this.options.renderUnboundKeybindings&&this.renderUnbound(this.domNode);this.didEverRender=!0}clear(){ai(this.domNode),this.keyElements.clear()}renderChord(e,i,n){let o=j1.modifierLabels[this.os];i.ctrlKey&&this.renderKey(e,o.ctrlKey,!!n?.ctrlKey,o.separator),i.shiftKey&&this.renderKey(e,o.shiftKey,!!n?.shiftKey,o.separator),i.altKey&&this.renderKey(e,o.altKey,!!n?.altKey,o.separator),i.metaKey&&this.renderKey(e,o.metaKey,!!n?.metaKey,o.separator);let s=i.keyLabel;s&&this.renderKey(e,s,!!n?.keyCode,"")}renderKey(e,i,n,o){U(e,this.createKeyElement(i,n?".highlight":"")),o&&U(e,X1("span.monaco-keybinding-key-separator",void 0,o))}renderUnbound(e){U(e,this.createKeyElement(u("unbound","Unbound")))}createKeyElement(e,i=""){let n=X1("span.monaco-keybinding-key"+i,void 0,e);return this.keyElements.add(n),this.options.keybindingLabelBackground&&(n.style.backgroundColor=this.options.keybindingLabelBackground),this.options.keybindingLabelBorder&&(n.style.borderColor=this.options.keybindingLabelBorder),this.options.keybindingLabelBottomBorder&&(n.style.borderBottomColor=this.options.keybindingLabelBottomBorder),this.options.keybindingLabelShadow&&(n.style.boxShadow=`inset 0 -1px 0 ${this.options.keybindingLabelShadow}`),n}static areSame(e,i){return e===i||!e&&!i?!0:!!e&&!!i&&sn(e.firstPart,i.firstPart)&&sn(e.chordPart,i.chordPart)}};var dCe=()=>({msLoopTime:-1,msDelayTime:-1,dispose:()=>{}}),cCe=dCe;function Fae(r,t){return cCe(r,t)}var W7="done",H7="active",Q1="infinite",Z1="infinite-long-running",U7="discrete";var J1=class r extends R{static LONG_RUNNING_INFINITE_THRESHOLD=1e4;static PROGRESS_SIGNAL_DEFAULT_DELAY=3e3;workedVal;element;bit;totalWork;showDelayedScheduler;longRunningScheduler;progressSignal=this._register(new yt);constructor(t,e){super(),this.workedVal=0,this.showDelayedScheduler=this._register(new Ye(()=>rn(this.element),0)),this.longRunningScheduler=this._register(new Ye(()=>this.infiniteLongRunning(),r.LONG_RUNNING_INFINITE_THRESHOLD)),this.create(t,e)}create(t,e){this.element=document.createElement("div"),this.element.classList.add("monaco-progress-container"),this.element.setAttribute("role","progressbar"),this.element.setAttribute("aria-valuemin","0"),t.appendChild(this.element),this.bit=document.createElement("div"),this.bit.classList.add("progress-bit"),this.bit.style.backgroundColor=e?.progressBarBackground||"#0E70C0",this.element.appendChild(this.bit)}off(){this.bit.style.width="inherit",this.bit.style.opacity="1",this.element.classList.remove(H7,Q1,Z1,U7),this.workedVal=0,this.totalWork=void 0,this.longRunningScheduler.cancel(),this.progressSignal.clear()}done(){return this.doDone(!0)}stop(){return this.doDone(!1)}doDone(t){return this.element.classList.add(W7),this.element.classList.contains(Q1)?(this.bit.style.opacity="0",t?setTimeout(()=>this.off(),200):this.off()):(this.bit.style.width="inherit",t?setTimeout(()=>this.off(),200):this.off()),this}infinite(){return this.bit.style.width="2%",this.bit.style.opacity="1",this.element.classList.remove(U7,W7,Z1),this.element.classList.add(H7,Q1),this.longRunningScheduler.schedule(),this}infiniteLongRunning(){this.element.classList.add(Z1)}total(t){return this.workedVal=0,this.totalWork=t,this.element.setAttribute("aria-valuemax",t.toString()),this}hasTotal(){return cr(this.totalWork)}worked(t){return t=Math.max(1,Number(t)),this.doSetWorked(this.workedVal+t)}setWorked(t){return t=Math.max(1,Number(t)),this.doSetWorked(t)}doSetWorked(t){let e=this.totalWork||100;return this.workedVal=t,this.workedVal=Math.min(e,this.workedVal),this.element.classList.remove(Q1,Z1,W7),this.element.classList.add(H7,U7),this.element.setAttribute("aria-valuenow",t.toString()),this.bit.style.width=100*(this.workedVal/e)+"%",this}getContainer(){return this.element}show(t){this.showDelayedScheduler.cancel(),this.progressSignal.value=Fae(r.PROGRESS_SIGNAL_DEFAULT_DELAY),typeof t=="number"?this.showDelayedScheduler.schedule(t):rn(this.element)}hide(){ji(this.element),this.showDelayedScheduler.cancel(),this.progressSignal.clear()}};var eF=class{constructor(t,e=0,i=t.length,n=e-1){this.items=t;this.start=e;this.end=i;this.index=n}current(){return this.index===this.start-1||this.index===this.end?null:this.items[this.index]}next(){return this.index=Math.min(this.index+1,this.end),this.current()}previous(){return this.index=Math.max(this.index-1,this.start-1),this.current()}first(){return this.index=this.start,this.current()}last(){return this.index=this.end-1,this.current()}};var kw=class{_history;_limit;_navigator;constructor(t=[],e=10){this._initialize(t),this._limit=e,this._onChange()}getHistory(){return this._elements}add(t){this._history.delete(t),this._history.add(t),this._onChange()}next(){return this._navigator.next()}previous(){return this._currentPosition()!==0?this._navigator.previous():null}current(){return this._navigator.current()}first(){return this._navigator.first()}last(){return this._navigator.last()}isFirst(){return this._currentPosition()===0}isLast(){return this._currentPosition()>=this._elements.length-1}isNowhere(){return this._navigator.current()===null}has(t){return this._history.has(t)}clear(){this._initialize([]),this._onChange()}_onChange(){this._reduceToLimit();let t=this._elements;this._navigator=new eF(t,0,t.length,t.length)}_reduceToLimit(){let t=this._elements;t.length>this._limit&&this._initialize(t.slice(t.length-this._limit))}_currentPosition(){let t=this._navigator.current();return t?this._elements.indexOf(t):-1}_initialize(t){this._history=new Set;for(let e of t)this._history.add(e)}get _elements(){let t=[];return this._history.forEach(e=>t.push(e)),t}};var iL=J;var Bae={inputBackground:"#3C3C3C",inputForeground:"#CCCCCC",inputValidationInfoBorder:"#55AAFF",inputValidationInfoBackground:"#063B49",inputValidationWarningBorder:"#B89500",inputValidationWarningBackground:"#352A05",inputValidationErrorBorder:"#BE1100",inputValidationErrorBackground:"#5A1D1D",inputBorder:void 0,inputValidationErrorForeground:void 0,inputValidationInfoForeground:void 0,inputValidationWarningForeground:void 0},rh=class extends ko{contextViewProvider;element;input;actionbar;options;message;placeholder;tooltip;ariaLabel;validation;state="idle";mirror;cachedHeight;cachedContentHeight;maxHeight=Number.POSITIVE_INFINITY;scrollableElement;hover;_onDidChange=this._register(new x);onDidChange=this._onDidChange.event;_onDidHeightChange=this._register(new x);onDidHeightChange=this._onDidHeightChange.event;constructor(t,e,i){super(),this.contextViewProvider=e,this.options=i,this.message=null,this.placeholder=this.options.placeholder||"",this.tooltip=this.options.tooltip??(this.placeholder||""),this.ariaLabel=this.options.ariaLabel||"",this.options.validationOptions&&(this.validation=this.options.validationOptions.validation),this.element=U(t,iL(".monaco-inputbox.idle"));let n=this.options.flexibleHeight?"textarea":"input",o=U(this.element,iL(".ibwrapper"));if(this.input=U(o,iL(n+".input.empty")),this.input.setAttribute("autocorrect","off"),this.input.setAttribute("autocapitalize","off"),this.input.setAttribute("spellcheck","false"),this.onfocus(this.input,()=>this.element.classList.add("synthetic-focus")),this.onblur(this.input,()=>this.element.classList.remove("synthetic-focus")),this.options.flexibleHeight){this.maxHeight=typeof this.options.flexibleMaxHeight=="number"?this.options.flexibleMaxHeight:Number.POSITIVE_INFINITY,this.mirror=U(o,iL("div.mirror")),this.mirror.innerText="\xA0",this.scrollableElement=new bw(this.element,{vertical:1}),this.options.flexibleWidth&&(this.input.setAttribute("wrap","off"),this.mirror.style.whiteSpace="pre",this.mirror.style.wordWrap="initial"),U(t,this.scrollableElement.getDomNode()),this._register(this.scrollableElement),this._register(this.scrollableElement.onScroll(l=>this.input.scrollTop=l.scrollTop));let s=this._register(new lt(t.ownerDocument,"selectionchange")),a=X.filter(s.event,()=>t.ownerDocument.getSelection()?.anchorNode===o);this._register(a(this.updateScrollDimensions,this)),this._register(this.onDidHeightChange(this.updateScrollDimensions,this))}else this.input.type=this.options.type||"text",this.input.setAttribute("wrap","off");this.ariaLabel&&this.input.setAttribute("aria-label",this.ariaLabel),this.placeholder&&!this.options.showPlaceholderOnFocus&&this.setPlaceHolder(this.placeholder),this.tooltip&&this.setTooltip(this.tooltip),this.oninput(this.input,()=>this.onValueChange()),this.onblur(this.input,()=>this.onBlur()),this.onfocus(this.input,()=>this.onFocus()),this._register(this.ignoreGesture(this.input)),setTimeout(()=>this.updateMirror(),0),this.options.actions&&(this.actionbar=this._register(new Fi(this.element)),this.actionbar.push(this.options.actions,{icon:!0,label:!1})),this.applyStyles()}onBlur(){this._hideMessage(),this.options.showPlaceholderOnFocus&&this.input.setAttribute("placeholder","")}onFocus(){this._showMessage(),this.options.showPlaceholderOnFocus&&this.input.setAttribute("placeholder",this.placeholder||"")}setPlaceHolder(t){this.placeholder=t,this.input.setAttribute("placeholder",t)}setTooltip(t){this.tooltip=t,this.hover?this.hover.update(t):this.hover=this._register(Bo().setupManagedHover(gt("mouse"),this.input,t))}setAriaLabel(t){this.ariaLabel=t,t?this.input.setAttribute("aria-label",this.ariaLabel):this.input.removeAttribute("aria-label")}getAriaLabel(){return this.ariaLabel}get mirrorElement(){return this.mirror}get inputElement(){return this.input}get value(){return this.input.value}set value(t){this.input.value!==t&&(this.input.value=t,this.onValueChange())}get step(){return this.input.step}set step(t){this.input.step=t}get height(){return typeof this.cachedHeight=="number"?this.cachedHeight:Tm(this.element)}focus(){this.input.focus()}blur(){this.input.blur()}hasFocus(){return fs(this.input)}select(t=null){this.input.select(),t&&(this.input.setSelectionRange(t.start,t.end),t.end===this.input.value.length&&(this.input.scrollLeft=this.input.scrollWidth))}isSelectionAtEnd(){return this.input.selectionEnd===this.input.value.length&&this.input.selectionStart===this.input.selectionEnd}getSelection(){let t=this.input.selectionStart;if(t===null)return null;let e=this.input.selectionEnd??t;return{start:t,end:e}}enable(){this.input.removeAttribute("disabled")}disable(){this.blur(),this.input.disabled=!0,this._hideMessage()}setEnabled(t){t?this.enable():this.disable()}get width(){return xm(this.input)}set width(t){if(this.options.flexibleHeight&&this.options.flexibleWidth){let e=0;if(this.mirror){let i=parseFloat(this.mirror.style.paddingLeft||"")||0,n=parseFloat(this.mirror.style.paddingRight||"")||0;e=i+n}this.input.style.width=t-e+"px"}else this.input.style.width=t+"px";this.mirror&&(this.mirror.style.width=t+"px")}set paddingRight(t){this.input.style.width=`calc(100% - ${t}px)`,this.mirror&&(this.mirror.style.paddingRight=t+"px")}updateScrollDimensions(){if(typeof this.cachedContentHeight!="number"||typeof this.cachedHeight!="number"||!this.scrollableElement)return;let t=this.cachedContentHeight,e=this.cachedHeight,i=this.input.scrollTop;this.scrollableElement.setScrollDimensions({scrollHeight:t,height:e}),this.scrollableElement.setScrollPosition({scrollTop:i})}showMessage(t,e){if(this.state==="open"&&sn(this.message,t))return;this.message=t,this.element.classList.remove("idle"),this.element.classList.remove("info"),this.element.classList.remove("warning"),this.element.classList.remove("error"),this.element.classList.add(this.classForType(t.type));let i=this.stylesForType(this.message.type);this.element.style.border=`1px solid ${Ja(i.border,"transparent")}`,this.message.content&&(this.hasFocus()||e)&&this._showMessage()}hideMessage(){this.message=null,this.element.classList.remove("info"),this.element.classList.remove("warning"),this.element.classList.remove("error"),this.element.classList.add("idle"),this._hideMessage(),this.applyStyles()}isInputValid(){return!!this.validation&&!this.validation(this.value)}validate(){let t=null;return this.validation&&(t=this.validation(this.value),t?(this.inputElement.setAttribute("aria-invalid","true"),this.showMessage(t)):this.inputElement.hasAttribute("aria-invalid")&&(this.inputElement.removeAttribute("aria-invalid"),this.hideMessage())),t?.type}stylesForType(t){let e=this.options.inputBoxStyles;switch(t){case 1:return{border:e.inputValidationInfoBorder,background:e.inputValidationInfoBackground,foreground:e.inputValidationInfoForeground};case 2:return{border:e.inputValidationWarningBorder,background:e.inputValidationWarningBackground,foreground:e.inputValidationWarningForeground};default:return{border:e.inputValidationErrorBorder,background:e.inputValidationErrorBackground,foreground:e.inputValidationErrorForeground}}}classForType(t){switch(t){case 1:return"info";case 2:return"warning";default:return"error"}}_showMessage(){if(!this.contextViewProvider||!this.message)return;let t,e=()=>t.style.width=xm(this.element)+"px";this.contextViewProvider.showContextView({getAnchor:()=>this.element,anchorAlignment:1,render:n=>{if(!this.message)return null;t=U(n,iL(".monaco-inputbox-container")),e();let o={inline:!0,className:"monaco-inputbox-message"},s=this.message.formatContent?Zse(this.message.content,o):Qse(this.message.content,o);s.classList.add(this.classForType(this.message.type));let a=this.stylesForType(this.message.type);return s.style.backgroundColor=a.background??"",s.style.color=a.foreground??"",s.style.border=a.border?`1px solid ${a.border}`:"",U(t,s),null},onHide:()=>{this.state="closed"},layout:e});let i;this.message.type===3?i=u("alertErrorMessage","Error: {0}",this.message.content):this.message.type===2?i=u("alertWarningMessage","Warning: {0}",this.message.content):i=u("alertInfoMessage","Info: {0}",this.message.content),ka(i),this.state="open"}_hideMessage(){this.contextViewProvider&&(this.state==="open"&&this.contextViewProvider.hideContextView(),this.state="idle")}onValueChange(){this._onDidChange.fire(this.value),this.validate(),this.updateMirror(),this.input.classList.toggle("empty",!this.value),this.state==="open"&&this.contextViewProvider&&this.contextViewProvider.layout()}updateMirror(){if(!this.mirror)return;let t=this.value,i=t.charCodeAt(t.length-1)===10?" ":"";(t+i).replace(/\u000c/g,"")?this.mirror.textContent=t+i:this.mirror.innerText="\xA0",this.layout()}applyStyles(){let t=this.options.inputBoxStyles,e=t.inputBackground??"",i=t.inputForeground??"",n=t.inputBorder??"";this.element.style.backgroundColor=e,this.element.style.color=i,this.input.style.backgroundColor="inherit",this.input.style.color=i,this.element.style.border=`1px solid ${Ja(n,"transparent")}`}layout(){if(!this.mirror)return;let t=this.cachedContentHeight;this.cachedContentHeight=Tm(this.mirror),t!==this.cachedContentHeight&&(this.cachedHeight=Math.min(this.cachedContentHeight,this.maxHeight),this.input.style.height=this.cachedHeight+"px",this._onDidHeightChange.fire(this.cachedContentHeight))}insertAtCursor(t){let e=this.inputElement,i=e.selectionStart,n=e.selectionEnd,o=e.value;i!==null&&n!==null&&(this.value=o.substr(0,i)+t+o.substr(n),e.setSelectionRange(i+1,i+1),this.layout())}dispose(){this._hideMessage(),this.message=null,this.actionbar?.dispose(),super.dispose()}},ib=class extends rh{history;observer;_onDidFocus=this._register(new x);onDidFocus=this._onDidFocus.event;_onDidBlur=this._register(new x);onDidBlur=this._onDidBlur.event;constructor(t,e,i){let n=u({key:"history.inputbox.hint.suffix.noparens",comment:['Text is the suffix of an input field placeholder coming after the action the input field performs, this will be used when the input field ends in a closing parenthesis ")", for example "Filter (e.g. text, !exclude)". The character inserted into the final string is \u21C5 to represent the up and down arrow keys.']}," or {0} for history","\u21C5"),o=u({key:"history.inputbox.hint.suffix.inparens",comment:['Text is the suffix of an input field placeholder coming after the action the input field performs, this will be used when the input field does NOT end in a closing parenthesis (eg. "Find"). The character inserted into the final string is \u21C5 to represent the up and down arrow keys.']}," ({0} for history)","\u21C5");super(t,e,i),this.history=new kw(i.history,100);let s=()=>{if(i.showHistoryHint&&i.showHistoryHint()&&!this.placeholder.endsWith(n)&&!this.placeholder.endsWith(o)&&this.history.getHistory().length){let a=this.placeholder.endsWith(")")?n:o,l=this.placeholder+a;i.showPlaceholderOnFocus&&!fs(this.input)?this.placeholder=l:this.setPlaceHolder(l)}};this.observer=new MutationObserver((a,l)=>{a.forEach(d=>{d.target.textContent||s()})}),this.observer.observe(this.input,{attributeFilter:["class"]}),this.onfocus(this.input,()=>s()),this.onblur(this.input,()=>{let a=l=>{if(this.placeholder.endsWith(l)){let d=this.placeholder.slice(0,this.placeholder.length-l.length);return i.showPlaceholderOnFocus?this.placeholder=d:this.setPlaceHolder(d),!0}else return!1};a(o)||a(n)})}dispose(){super.dispose(),this.observer&&(this.observer.disconnect(),this.observer=void 0)}addToHistory(t){this.value&&(t||this.value!==this.getCurrentValue())&&this.history.add(this.value)}prependHistory(t){let e=this.getHistory();this.clearHistory(),t.forEach(i=>{this.history.add(i)}),e.forEach(i=>{this.history.add(i)})}getHistory(){return this.history.getHistory()}isAtFirstInHistory(){return this.history.isFirst()}isAtLastInHistory(){return this.history.isLast()}isNowhereInHistory(){return this.history.isNowhere()}showNextValue(){this.history.has(this.value)||this.addToHistory();let t=this.getNextValue();t&&(t=t===this.value?this.getNextValue():t),this.value=t??"",La(this.value?this.value:u("clearedInput","Cleared Input"))}showPreviousValue(){this.history.has(this.value)||this.addToHistory();let t=this.getPreviousValue();t&&(t=t===this.value?this.getPreviousValue():t),t&&(this.value=t,La(this.value))}clearHistory(){this.history.clear()}setPlaceHolder(t){super.setPlaceHolder(t),this.setTooltip(t)}onBlur(){super.onBlur(),this._onDidBlur.fire()}onFocus(){super.onFocus(),this._onDidFocus.fire()}getCurrentValue(){let t=this.history.current();return t||(t=this.history.last(),this.history.next()),t}getPreviousValue(){return this.history.previous()||this.history.first()}getNextValue(){return this.history.next()}};var uCe=u("caseDescription","Match Case"),pCe=u("wordsDescription","Match Whole Word"),hCe=u("regexDescription","Use Regular Expression"),tF=class extends xu{constructor(t){super({icon:N.caseSensitive,title:uCe+t.appendTitle,isChecked:t.isChecked,hoverDelegate:t.hoverDelegate??gt("element"),inputActiveOptionBorder:t.inputActiveOptionBorder,inputActiveOptionForeground:t.inputActiveOptionForeground,inputActiveOptionBackground:t.inputActiveOptionBackground})}},iF=class extends xu{constructor(t){super({icon:N.wholeWord,title:pCe+t.appendTitle,isChecked:t.isChecked,hoverDelegate:t.hoverDelegate??gt("element"),inputActiveOptionBorder:t.inputActiveOptionBorder,inputActiveOptionForeground:t.inputActiveOptionForeground,inputActiveOptionBackground:t.inputActiveOptionBackground})}},nF=class extends xu{constructor(t){super({icon:N.regex,title:hCe+t.appendTitle,isChecked:t.isChecked,hoverDelegate:t.hoverDelegate??gt("element"),inputActiveOptionBorder:t.inputActiveOptionBorder,inputActiveOptionForeground:t.inputActiveOptionForeground,inputActiveOptionBackground:t.inputActiveOptionBackground})}};var mCe=u("defaultLabel","input"),Lw=class extends ko{static OPTION_CHANGE="optionChange";placeholder;validation;label;showCommonFindToggles;fixFocusOnOptionClickEnabled=!0;imeSessionInProgress=!1;additionalTogglesDisposables=this._register(new yt);controls;regex;wholeWords;caseSensitive;additionalToggles=[];domNode;inputBox;_onDidOptionChange=this._register(new x);onDidOptionChange=this._onDidOptionChange.event;_onKeyDown=this._register(new x);onKeyDown=this._onKeyDown.event;_onMouseDown=this._register(new x);onMouseDown=this._onMouseDown.event;_onInput=this._register(new x);onInput=this._onInput.event;_onKeyUp=this._register(new x);onKeyUp=this._onKeyUp.event;_onCaseSensitiveKeyDown=this._register(new x);onCaseSensitiveKeyDown=this._onCaseSensitiveKeyDown.event;_onRegexKeyDown=this._register(new x);onRegexKeyDown=this._onRegexKeyDown.event;constructor(t,e,i){super(),this.placeholder=i.placeholder||"",this.validation=i.validation,this.label=i.label||mCe,this.showCommonFindToggles=!!i.showCommonFindToggles;let n=i.appendCaseSensitiveLabel||"",o=i.appendWholeWordsLabel||"",s=i.appendRegexLabel||"",a=i.history||[],l=!!i.flexibleHeight,d=!!i.flexibleWidth,c=i.flexibleMaxHeight;this.domNode=document.createElement("div"),this.domNode.classList.add("monaco-findInput"),this.inputBox=this._register(new ib(this.domNode,e,{placeholder:this.placeholder||"",ariaLabel:this.label||"",validationOptions:{validation:this.validation},history:a,showHistoryHint:i.showHistoryHint,flexibleHeight:l,flexibleWidth:d,flexibleMaxHeight:c,inputBoxStyles:i.inputBoxStyles}));let p=this._register(wu());if(this.showCommonFindToggles){this.regex=this._register(new nF({appendTitle:s,isChecked:!1,hoverDelegate:p,...i.toggleStyles})),this._register(this.regex.onChange(m=>{this._onDidOptionChange.fire(m),!m&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this._register(this.regex.onKeyDown(m=>{this._onRegexKeyDown.fire(m)})),this.wholeWords=this._register(new iF({appendTitle:o,isChecked:!1,hoverDelegate:p,...i.toggleStyles})),this._register(this.wholeWords.onChange(m=>{this._onDidOptionChange.fire(m),!m&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this.caseSensitive=this._register(new tF({appendTitle:n,isChecked:!1,hoverDelegate:p,...i.toggleStyles})),this._register(this.caseSensitive.onChange(m=>{this._onDidOptionChange.fire(m),!m&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this._register(this.caseSensitive.onKeyDown(m=>{this._onCaseSensitiveKeyDown.fire(m)}));let h=[this.caseSensitive.domNode,this.wholeWords.domNode,this.regex.domNode];this.onkeydown(this.domNode,m=>{if(m.equals(15)||m.equals(17)||m.equals(9)){let f=h.indexOf(this.domNode.ownerDocument.activeElement);if(f>=0){let g=-1;m.equals(17)?g=(f+1)%h.length:m.equals(15)&&(f===0?g=h.length-1:g=f-1),m.equals(9)?(h[f].blur(),this.inputBox.focus()):g>=0&&h[g].focus(),Ve.stop(m,!0)}}})}this.controls=document.createElement("div"),this.controls.className="controls",this.controls.style.display=this.showCommonFindToggles?"":"none",this.caseSensitive&&this.controls.append(this.caseSensitive.domNode),this.wholeWords&&this.controls.appendChild(this.wholeWords.domNode),this.regex&&this.controls.appendChild(this.regex.domNode),this.setAdditionalToggles(i?.additionalToggles),this.controls&&this.domNode.appendChild(this.controls),t?.appendChild(this.domNode),this._register(F(this.inputBox.inputElement,"compositionstart",h=>{this.imeSessionInProgress=!0})),this._register(F(this.inputBox.inputElement,"compositionend",h=>{this.imeSessionInProgress=!1,this._onInput.fire()})),this.onkeydown(this.inputBox.inputElement,h=>this._onKeyDown.fire(h)),this.onkeyup(this.inputBox.inputElement,h=>this._onKeyUp.fire(h)),this.oninput(this.inputBox.inputElement,h=>this._onInput.fire()),this.onmousedown(this.inputBox.inputElement,h=>this._onMouseDown.fire(h))}get isImeSessionInProgress(){return this.imeSessionInProgress}get onDidChange(){return this.inputBox.onDidChange}layout(t){this.inputBox.layout(),this.updateInputBoxPadding(t.collapsedFindWidget)}enable(){this.domNode.classList.remove("disabled"),this.inputBox.enable(),this.regex?.enable(),this.wholeWords?.enable(),this.caseSensitive?.enable();for(let t of this.additionalToggles)t.enable()}disable(){this.domNode.classList.add("disabled"),this.inputBox.disable(),this.regex?.disable(),this.wholeWords?.disable(),this.caseSensitive?.disable();for(let t of this.additionalToggles)t.disable()}setFocusInputOnOptionClick(t){this.fixFocusOnOptionClickEnabled=t}setEnabled(t){t?this.enable():this.disable()}setAdditionalToggles(t){for(let e of this.additionalToggles)e.domNode.remove();this.additionalToggles=[],this.additionalTogglesDisposables.value=new B;for(let e of t??[])this.additionalTogglesDisposables.value.add(e),this.controls.appendChild(e.domNode),this.additionalTogglesDisposables.value.add(e.onChange(i=>{this._onDidOptionChange.fire(i),!i&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus()})),this.additionalToggles.push(e);this.additionalToggles.length>0&&(this.controls.style.display=""),this.updateInputBoxPadding()}updateInputBoxPadding(t=!1){t?this.inputBox.paddingRight=0:this.inputBox.paddingRight=(this.caseSensitive?.width()??0)+(this.wholeWords?.width()??0)+(this.regex?.width()??0)+this.additionalToggles.reduce((e,i)=>e+i.width(),0)}clear(){this.clearValidation(),this.setValue(""),this.focus()}getValue(){return this.inputBox.value}setValue(t){this.inputBox.value!==t&&(this.inputBox.value=t)}onSearchSubmit(){this.inputBox.addToHistory()}select(){this.inputBox.select()}focus(){this.inputBox.focus()}getCaseSensitive(){return this.caseSensitive?.checked??!1}setCaseSensitive(t){this.caseSensitive&&(this.caseSensitive.checked=t)}getWholeWords(){return this.wholeWords?.checked??!1}setWholeWords(t){this.wholeWords&&(this.wholeWords.checked=t)}getRegex(){return this.regex?.checked??!1}setRegex(t){this.regex&&(this.regex.checked=t,this.validate())}focusOnCaseSensitive(){this.caseSensitive?.focus()}focusOnRegex(){this.regex?.focus()}_lastHighlightFindOptions=0;highlightFindOptions(){this.domNode.classList.remove("highlight-"+this._lastHighlightFindOptions),this._lastHighlightFindOptions=1-this._lastHighlightFindOptions,this.domNode.classList.add("highlight-"+this._lastHighlightFindOptions)}validate(){this.inputBox.validate()}showMessage(t){this.inputBox.showMessage(t)}clearMessage(){this.inputBox.hideMessage()}clearValidation(){this.inputBox.hideMessage()}};var Qn=class extends Error{constructor(t,e){super(`TreeError [${t}] ${e}`)}},KI=class{constructor(t){this.fn=t}_map=new WeakMap;map(t){let e=this._map.get(t);return e||(e=this.fn(t),this._map.set(t,e)),e}};function nL(r){return typeof r=="object"&&"visibility"in r&&"data"in r}function GI(r){switch(r){case!0:return 1;case!1:return 0;default:return r}}function z7(r){return typeof r.collapsible=="boolean"}var oF=class{constructor(t,e,i={}){this.user=t;this.collapseByDefault=typeof i.collapseByDefault>"u"?!1:i.collapseByDefault,this.allowNonCollapsibleParents=i.allowNonCollapsibleParents??!1,this.filter=i.filter,this.autoExpandSingleChildren=typeof i.autoExpandSingleChildren>"u"?!1:i.autoExpandSingleChildren,this.root={parent:void 0,element:e,children:[],depth:0,visibleChildrenCount:0,visibleChildIndex:-1,collapsible:!1,collapsed:!1,renderNodeCount:0,visibility:1,visible:!0,filterData:void 0}}rootRef=[];root;eventBufferer=new Xg;_onDidSpliceModel=new x;onDidSpliceModel=this._onDidSpliceModel.event;_onDidSpliceRenderedNodes=new x;onDidSpliceRenderedNodes=this._onDidSpliceRenderedNodes.event;_onDidChangeCollapseState=new x;onDidChangeCollapseState=this.eventBufferer.wrapEvent(this._onDidChangeCollapseState.event);_onDidChangeRenderNodeCount=new x;onDidChangeRenderNodeCount=this.eventBufferer.wrapEvent(this._onDidChangeRenderNodeCount.event);collapseByDefault;allowNonCollapsibleParents;filter;autoExpandSingleChildren;refilterDelayer=new yd(sA);splice(t,e,i=mt.empty(),n={}){if(t.length===0)throw new Qn(this.user,"Invalid tree location");n.diffIdentityProvider?this.spliceSmart(n.diffIdentityProvider,t,e,i,n):this.spliceSimple(t,e,i,n)}spliceSmart(t,e,i,n=mt.empty(),o,s=o.diffDepth??0){let{parentNode:a}=this.getParentNodeWithListIndex(e);if(!a.lastDiffIds)return this.spliceSimple(e,i,n,o);let l=[...n],d=e[e.length-1],c=new Dm({getElements:()=>a.lastDiffIds},{getElements:()=>[...a.children.slice(0,d),...l,...a.children.slice(d+i)].map(g=>t.getId(g.element).toString())}).ComputeDiff(!1);if(c.quitEarly)return a.lastDiffIds=void 0,this.spliceSimple(e,i,l,o);let p=e.slice(0,-1),h=(g,v,I)=>{if(s>0)for(let y=0;y<I;y++)g--,v--,this.spliceSmart(t,[...p,g,0],Number.MAX_SAFE_INTEGER,l[v].children,o,s-1)},m=Math.min(a.children.length,d+i),f=l.length;for(let g of c.changes.sort((v,I)=>I.originalStart-v.originalStart))h(m,f,m-(g.originalStart+g.originalLength)),m=g.originalStart,f=g.modifiedStart-d,this.spliceSimple([...p,m],g.originalLength,mt.slice(l,f,f+g.modifiedLength),o);h(m,f,m)}spliceSimple(t,e,i=mt.empty(),{onDidCreateNode:n,onDidDeleteNode:o,diffIdentityProvider:s}){let{parentNode:a,listIndex:l,revealed:d,visible:c}=this.getParentNodeWithListIndex(t),p=[],h=mt.map(i,S=>this.createTreeNode(S,a,a.visible?1:0,d,p,n)),m=t[t.length-1],f=0;for(let S=m;S>=0&&S<a.children.length;S--){let D=a.children[S];if(D.visible){f=D.visibleChildIndex;break}}let g=[],v=0,I=0;for(let S of h)g.push(S),I+=S.renderNodeCount,S.visible&&(S.visibleChildIndex=f+v++);let y=j5(a.children,m,e,g);s?a.lastDiffIds?j5(a.lastDiffIds,m,e,g.map(S=>s.getId(S.element).toString())):a.lastDiffIds=a.children.map(S=>s.getId(S.element).toString()):a.lastDiffIds=void 0;let w=0;for(let S of y)S.visible&&w++;if(w!==0)for(let S=m+g.length;S<a.children.length;S++){let D=a.children[S];D.visible&&(D.visibleChildIndex-=w)}if(a.visibleChildrenCount+=v-w,d&&c){let S=y.reduce((D,k)=>D+(k.visible?k.renderNodeCount:0),0);this._updateAncestorsRenderNodeCount(a,I-S),this._onDidSpliceRenderedNodes.fire({start:l,deleteCount:S,elements:p})}if(y.length>0&&o){let S=D=>{o(D),D.children.forEach(S)};y.forEach(S)}this._onDidSpliceModel.fire({insertedNodes:g,deletedNodes:y});let C=a;for(;C;){if(C.visibility===2){this.refilterDelayer.trigger(()=>this.refilter());break}C=C.parent}}rerender(t){if(t.length===0)throw new Qn(this.user,"Invalid tree location");let{node:e,listIndex:i,revealed:n}=this.getTreeNodeWithListIndex(t);e.visible&&n&&this._onDidSpliceRenderedNodes.fire({start:i,deleteCount:1,elements:[e]})}has(t){return this.hasTreeNode(t)}getListIndex(t){let{listIndex:e,visible:i,revealed:n}=this.getTreeNodeWithListIndex(t);return i&&n?e:-1}getListRenderCount(t){return this.getTreeNode(t).renderNodeCount}isCollapsible(t){return this.getTreeNode(t).collapsible}setCollapsible(t,e){let i=this.getTreeNode(t);typeof e>"u"&&(e=!i.collapsible);let n={collapsible:e};return this.eventBufferer.bufferEvents(()=>this._setCollapseState(t,n))}isCollapsed(t){return this.getTreeNode(t).collapsed}setCollapsed(t,e,i){let n=this.getTreeNode(t);typeof e>"u"&&(e=!n.collapsed);let o={collapsed:e,recursive:i||!1};return this.eventBufferer.bufferEvents(()=>this._setCollapseState(t,o))}_setCollapseState(t,e){let{node:i,listIndex:n,revealed:o}=this.getTreeNodeWithListIndex(t),s=this._setListNodeCollapseState(i,n,o,e);if(i!==this.root&&this.autoExpandSingleChildren&&s&&!z7(e)&&i.collapsible&&!i.collapsed&&!e.recursive){let a=-1;for(let l=0;l<i.children.length;l++)if(i.children[l].visible)if(a>-1){a=-1;break}else a=l;a>-1&&this._setCollapseState([...t,a],e)}return s}_setListNodeCollapseState(t,e,i,n){let o=this._setNodeCollapseState(t,n,!1);if(!i||!t.visible||!o)return o;let s=t.renderNodeCount,a=this.updateNodeAfterCollapseChange(t),l=s-(e===-1?0:1);return this._onDidSpliceRenderedNodes.fire({start:e+1,deleteCount:l,elements:a.slice(1)}),o}_setNodeCollapseState(t,e,i){let n;if(t===this.root?n=!1:(z7(e)?(n=t.collapsible!==e.collapsible,t.collapsible=e.collapsible):t.collapsible?(n=t.collapsed!==e.collapsed,t.collapsed=e.collapsed):n=!1,n&&this._onDidChangeCollapseState.fire({node:t,deep:i})),!z7(e)&&e.recursive)for(let o of t.children)n=this._setNodeCollapseState(o,e,!0)||n;return n}expandTo(t){this.eventBufferer.bufferEvents(()=>{let e=this.getTreeNode(t);for(;e.parent;)e=e.parent,t=t.slice(0,t.length-1),e.collapsed&&this._setCollapseState(t,{collapsed:!1,recursive:!1})})}refilter(){let t=this.root.renderNodeCount,e=this.updateNodeAfterFilterChange(this.root);this._onDidSpliceRenderedNodes.fire({start:0,deleteCount:t,elements:e}),this.refilterDelayer.cancel()}createTreeNode(t,e,i,n,o,s){let a={parent:e,element:t.element,children:[],depth:e.depth+1,visibleChildrenCount:0,visibleChildIndex:-1,collapsible:typeof t.collapsible=="boolean"?t.collapsible:typeof t.collapsed<"u",collapsed:typeof t.collapsed>"u"?this.collapseByDefault:t.collapsed,renderNodeCount:1,visibility:1,visible:!0,filterData:void 0},l=this._filterNode(a,i);a.visibility=l,n&&o.push(a);let d=t.children||mt.empty(),c=n&&l!==0&&!a.collapsed,p=0,h=1;for(let m of d){let f=this.createTreeNode(m,a,l,c,o,s);a.children.push(f),h+=f.renderNodeCount,f.visible&&(f.visibleChildIndex=p++)}return this.allowNonCollapsibleParents||(a.collapsible=a.collapsible||a.children.length>0),a.visibleChildrenCount=p,a.visible=l===2?p>0:l===1,a.visible?a.collapsed||(a.renderNodeCount=h):(a.renderNodeCount=0,n&&o.pop()),s?.(a),a}updateNodeAfterCollapseChange(t){let e=t.renderNodeCount,i=[];return this._updateNodeAfterCollapseChange(t,i),this._updateAncestorsRenderNodeCount(t.parent,i.length-e),i}_updateNodeAfterCollapseChange(t,e){if(t.visible===!1)return 0;if(e.push(t),t.renderNodeCount=1,!t.collapsed)for(let i of t.children)t.renderNodeCount+=this._updateNodeAfterCollapseChange(i,e);return this._onDidChangeRenderNodeCount.fire(t),t.renderNodeCount}updateNodeAfterFilterChange(t){let e=t.renderNodeCount,i=[];return this._updateNodeAfterFilterChange(t,t.visible?1:0,i),this._updateAncestorsRenderNodeCount(t.parent,i.length-e),i}_updateNodeAfterFilterChange(t,e,i,n=!0){let o;if(t!==this.root){if(o=this._filterNode(t,e),o===0)return t.visible=!1,t.renderNodeCount=0,!1;n&&i.push(t)}let s=i.length;t.renderNodeCount=t===this.root?0:1;let a=!1;if(!t.collapsed||o!==0){let l=0;for(let d of t.children)a=this._updateNodeAfterFilterChange(d,o,i,n&&!t.collapsed)||a,d.visible&&(d.visibleChildIndex=l++);t.visibleChildrenCount=l}else t.visibleChildrenCount=0;return t!==this.root&&(t.visible=o===2?a:o===1,t.visibility=o),t.visible?t.collapsed||(t.renderNodeCount+=i.length-s):(t.renderNodeCount=0,n&&i.pop()),this._onDidChangeRenderNodeCount.fire(t),t.visible}_updateAncestorsRenderNodeCount(t,e){if(e!==0)for(;t;)t.renderNodeCount+=e,this._onDidChangeRenderNodeCount.fire(t),t=t.parent}_filterNode(t,e){let i=this.filter?this.filter.filter(t.element,e):1;return typeof i=="boolean"?(t.filterData=void 0,i?1:0):nL(i)?(t.filterData=i.data,GI(i.visibility)):(t.filterData=void 0,GI(i))}hasTreeNode(t,e=this.root){if(!t||t.length===0)return!0;let[i,...n]=t;return i<0||i>e.children.length?!1:this.hasTreeNode(n,e.children[i])}getTreeNode(t,e=this.root){if(!t||t.length===0)return e;let[i,...n]=t;if(i<0||i>e.children.length)throw new Qn(this.user,"Invalid tree location");return this.getTreeNode(n,e.children[i])}getTreeNodeWithListIndex(t){if(t.length===0)return{node:this.root,listIndex:-1,revealed:!0,visible:!1};let{parentNode:e,listIndex:i,revealed:n,visible:o}=this.getParentNodeWithListIndex(t),s=t[t.length-1];if(s<0||s>e.children.length)throw new Qn(this.user,"Invalid tree location");let a=e.children[s];return{node:a,listIndex:i,revealed:n,visible:o&&a.visible}}getParentNodeWithListIndex(t,e=this.root,i=0,n=!0,o=!0){let[s,...a]=t;if(s<0||s>e.children.length)throw new Qn(this.user,"Invalid tree location");for(let l=0;l<s;l++)i+=e.children[l].renderNodeCount;return n=n&&!e.collapsed,o=o&&e.visible,a.length===0?{parentNode:e,listIndex:i,revealed:n,visible:o}:this.getParentNodeWithListIndex(a,e.children[s],i+1,n,o)}getNode(t=[]){return this.getTreeNode(t)}getNodeLocation(t){let e=[],i=t;for(;i.parent;)e.push(i.parent.children.indexOf(i)),i=i.parent;return e.reverse()}getParentNodeLocation(t){if(t.length!==0)return t.length===1?[]:WM(t)[0]}getFirstElementChild(t){let e=this.getTreeNode(t);if(e.children.length!==0)return e.children[0].element}getLastElementAncestor(t=[]){let e=this.getTreeNode(t);if(e.children.length!==0)return this._getLastElementAncestor(e)}_getLastElementAncestor(t){return t.children.length===0?t.element:this._getLastElementAncestor(t.children[t.children.length-1])}};var G7=class extends Cc{constructor(e){super(e.elements.map(i=>i.element));this.data=e}set context(e){this.data.context=e}get context(){return this.data.context}};function K7(r){return r instanceof Cc?new G7(r):r}var q7=class{constructor(t,e){this.modelProvider=t;this.dnd=e}autoExpandNode;autoExpandDisposable=R.None;disposables=new B;getDragURI(t){return this.dnd.getDragURI(t.element)}getDragLabel(t,e){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(t.map(i=>i.element),e)}onDragStart(t,e){this.dnd.onDragStart?.(K7(t),e)}onDragOver(t,e,i,n,o,s=!0){let a=this.dnd.onDragOver(K7(t),e&&e.element,i,n,o),l=this.autoExpandNode!==e;if(l&&(this.autoExpandDisposable.dispose(),this.autoExpandNode=e),typeof e>"u")return a;if(l&&typeof a!="boolean"&&a.autoExpand&&(this.autoExpandDisposable=Sd(()=>{let m=this.modelProvider(),f=m.getNodeLocation(e);m.isCollapsed(f)&&m.setCollapsed(f,!1),this.autoExpandNode=void 0},500,this.disposables)),typeof a=="boolean"||!a.accept||typeof a.bubble>"u"||a.feedback){if(!s){let m=typeof a=="boolean"?a:a.accept,f=typeof a=="boolean"?void 0:a.effect;return{accept:m,effect:f,feedback:[i]}}return a}if(a.bubble===1){let m=this.modelProvider(),f=m.getNodeLocation(e),g=m.getParentNodeLocation(f),v=m.getNode(g),I=g&&m.getListIndex(g);return this.onDragOver(t,v,I,n,o,!1)}let d=this.modelProvider(),c=d.getNodeLocation(e),p=d.getListIndex(c),h=d.getListRenderCount(c);return{...a,feedback:yr(p,p+h)}}drop(t,e,i,n,o){this.autoExpandDisposable.dispose(),this.autoExpandNode=void 0,this.dnd.drop(K7(t),e&&e.element,i,n,o)}onDragEnd(t){this.dnd.onDragEnd?.(t)}dispose(){this.disposables.dispose(),this.dnd.dispose()}};function gCe(r,t){return t&&{...t,identityProvider:t.identityProvider&&{getId(e){return t.identityProvider.getId(e.element)}},dnd:t.dnd&&new q7(r,t.dnd),multipleSelectionController:t.multipleSelectionController&&{isSelectionSingleChangeEvent(e){return t.multipleSelectionController.isSelectionSingleChangeEvent({...e,element:e.element})},isSelectionRangeChangeEvent(e){return t.multipleSelectionController.isSelectionRangeChangeEvent({...e,element:e.element})}},accessibilityProvider:t.accessibilityProvider&&{...t.accessibilityProvider,getSetSize(e){let i=r(),n=i.getNodeLocation(e),o=i.getParentNodeLocation(n);return i.getNode(o).visibleChildrenCount},getPosInSet(e){return e.visibleChildIndex+1},isChecked:t.accessibilityProvider&&t.accessibilityProvider.isChecked?e=>t.accessibilityProvider.isChecked(e.element):void 0,getRole:t.accessibilityProvider&&t.accessibilityProvider.getRole?e=>t.accessibilityProvider.getRole(e.element):()=>"treeitem",getAriaLabel(e){return t.accessibilityProvider.getAriaLabel(e.element)},getWidgetAriaLabel(){return t.accessibilityProvider.getWidgetAriaLabel()},getWidgetRole:t.accessibilityProvider&&t.accessibilityProvider.getWidgetRole?()=>t.accessibilityProvider.getWidgetRole():()=>"tree",getAriaLevel:t.accessibilityProvider&&t.accessibilityProvider.getAriaLevel?e=>t.accessibilityProvider.getAriaLevel(e.element):e=>e.depth,getActiveDescendantId:t.accessibilityProvider.getActiveDescendantId&&(e=>t.accessibilityProvider.getActiveDescendantId(e.element))},keyboardNavigationLabelProvider:t.keyboardNavigationLabelProvider&&{...t.keyboardNavigationLabelProvider,getKeyboardNavigationLabel(e){return t.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(e.element)}}}}var Pw=class{constructor(t){this.delegate=t}getHeight(t){return this.delegate.getHeight(t.element)}getTemplateId(t){return this.delegate.getTemplateId(t.element)}hasDynamicHeight(t){return!!this.delegate.hasDynamicHeight&&this.delegate.hasDynamicHeight(t.element)}setDynamicHeight(t,e){this.delegate.setDynamicHeight?.(t.element,e)}},$7=class r{focus;selection;expanded;scrollTop;static lift(t){return t instanceof r?t:new r(t)}static empty(t=0){return new r({focus:[],selection:[],expanded:Object.create(null),scrollTop:t})}constructor(t){if(this.focus=new Set(t.focus),this.selection=new Set(t.selection),t.expanded instanceof Array){this.expanded=Object.create(null);for(let e of t.expanded)this.expanded[e]=1}else this.expanded=t.expanded;this.expanded=t.expanded,this.scrollTop=t.scrollTop}toJSON(){return{focus:Array.from(this.focus),selection:Array.from(this.selection),expanded:this.expanded,scrollTop:this.scrollTop}}};var j7=class{constructor(t,e=[]){this._elements=e;this.onDidChange=X.forEach(t,i=>this._elements=i,this.disposables)}disposables=new B;onDidChange;get elements(){return this._elements}dispose(){this.disposables.dispose()}},X7=class r{constructor(t,e,i,n,o,s={}){this.renderer=t;this.model=e;this.activeNodes=n;this.renderedIndentGuides=o;this.templateId=t.templateId,this.updateOptions(s),X.map(i,a=>a.node)(this.onDidChangeNodeTwistieState,this,this.disposables),t.onDidChangeTwistieState?.(this.onDidChangeTwistieState,this,this.disposables)}static DefaultIndent=8;templateId;renderedElements=new Map;renderedNodes=new Map;indent=r.DefaultIndent;hideTwistiesOfChildlessElements=!1;shouldRenderIndentGuides=!1;activeIndentNodes=new Set;indentGuidesDisposable=R.None;disposables=new B;updateOptions(t={}){if(typeof t.indent<"u"){let e=pn(t.indent,0,40);if(e!==this.indent){this.indent=e;for(let[i,n]of this.renderedNodes)this.renderTreeElement(i,n)}}if(typeof t.renderIndentGuides<"u"){let e=t.renderIndentGuides!=="none";if(e!==this.shouldRenderIndentGuides){this.shouldRenderIndentGuides=e;for(let[i,n]of this.renderedNodes)this._renderIndentGuides(i,n);if(this.indentGuidesDisposable.dispose(),e){let i=new B;this.activeNodes.onDidChange(this._onDidChangeActiveNodes,this,i),this.indentGuidesDisposable=i,this._onDidChangeActiveNodes(this.activeNodes.elements)}}}typeof t.hideTwistiesOfChildlessElements<"u"&&(this.hideTwistiesOfChildlessElements=t.hideTwistiesOfChildlessElements)}renderTemplate(t){let e=U(t,J(".monaco-tl-row")),i=U(e,J(".monaco-tl-indent")),n=U(e,J(".monaco-tl-twistie")),o=U(e,J(".monaco-tl-contents")),s=this.renderer.renderTemplate(o);return{container:t,indent:i,twistie:n,indentGuidesDisposable:R.None,templateData:s}}renderElement(t,e,i,n){this.renderedNodes.set(t,i),this.renderedElements.set(t.element,t),this.renderTreeElement(t,i),this.renderer.renderElement(t,e,i.templateData,n)}disposeElement(t,e,i,n){i.indentGuidesDisposable.dispose(),this.renderer.disposeElement?.(t,e,i.templateData,n),typeof n=="number"&&(this.renderedNodes.delete(t),this.renderedElements.delete(t.element))}disposeTemplate(t){this.renderer.disposeTemplate(t.templateData)}onDidChangeTwistieState(t){let e=this.renderedElements.get(t);e&&this.onDidChangeNodeTwistieState(e)}onDidChangeNodeTwistieState(t){let e=this.renderedNodes.get(t);e&&(this._onDidChangeActiveNodes(this.activeNodes.elements),this.renderTreeElement(t,e))}renderTreeElement(t,e){let i=r.DefaultIndent+(t.depth-1)*this.indent;e.twistie.style.paddingLeft=`${i}px`,e.indent.style.width=`${i+this.indent-16}px`,t.collapsible?e.container.setAttribute("aria-expanded",String(!t.collapsed)):e.container.removeAttribute("aria-expanded"),e.twistie.classList.remove(...de.asClassNameArray(N.treeItemExpanded));let n=!1;this.renderer.renderTwistie&&(n=this.renderer.renderTwistie(t.element,e.twistie)),t.collapsible&&(!this.hideTwistiesOfChildlessElements||t.visibleChildrenCount>0)?(n||e.twistie.classList.add(...de.asClassNameArray(N.treeItemExpanded)),e.twistie.classList.add("collapsible"),e.twistie.classList.toggle("collapsed",t.collapsed)):e.twistie.classList.remove("collapsible","collapsed"),this._renderIndentGuides(t,e)}_renderIndentGuides(t,e){if(ai(e.indent),e.indentGuidesDisposable.dispose(),!this.shouldRenderIndentGuides)return;let i=new B;for(;;){let n=this.model.getNodeLocation(t),o=this.model.getParentNodeLocation(n);if(!o)break;let s=this.model.getNode(o),a=J(".indent-guide",{style:`width: ${this.indent}px`});this.activeIndentNodes.has(s)&&a.classList.add("active"),e.indent.childElementCount===0?e.indent.appendChild(a):e.indent.insertBefore(a,e.indent.firstElementChild),this.renderedIndentGuides.add(s,a),i.add(le(()=>this.renderedIndentGuides.delete(s,a))),t=s}e.indentGuidesDisposable=i}_onDidChangeActiveNodes(t){if(!this.shouldRenderIndentGuides)return;let e=new Set;t.forEach(i=>{let n=this.model.getNodeLocation(i);try{let o=this.model.getParentNodeLocation(n);i.collapsible&&i.children.length>0&&!i.collapsed?e.add(i):o&&e.add(this.model.getNode(o))}catch{}}),this.activeIndentNodes.forEach(i=>{e.has(i)||this.renderedIndentGuides.forEach(i,n=>n.classList.remove("active"))}),e.forEach(i=>{this.activeIndentNodes.has(i)||this.renderedIndentGuides.forEach(i,n=>n.classList.add("active"))}),this.activeIndentNodes=e}setModel(t){this.model=t}dispose(){this.renderedNodes.clear(),this.renderedElements.clear(),this.indentGuidesDisposable.dispose(),_e(this.disposables)}},Y7=class{constructor(t,e,i){this.tree=t;this.keyboardNavigationLabelProvider=e;this._filter=i;t.onWillRefilter(this.reset,this,this.disposables)}_totalCount=0;get totalCount(){return this._totalCount}_matchCount=0;get matchCount(){return this._matchCount}_pattern="";_lowercasePattern="";disposables=new B;set pattern(t){this._pattern=t,this._lowercasePattern=t.toLowerCase()}filter(t,e){let i=1;if(this._filter){let s=this._filter.filter(t,e);if(typeof s=="boolean"?i=s?1:0:nL(s)?i=GI(s.visibility):i=s,i===0)return!1}if(this._totalCount++,!this._pattern)return this._matchCount++,{data:Dl.Default,visibility:i};let n=this.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(t),o=Array.isArray(n)?n:[n];for(let s of o){let a=s&&s.toString();if(typeof a>"u")return{data:Dl.Default,visibility:i};let l;if(this.tree.findMatchType===1){let d=a.toLowerCase().indexOf(this._lowercasePattern);if(d>-1){l=[Number.MAX_SAFE_INTEGER,0];for(let c=this._lowercasePattern.length;c>0;c--)l.push(d+c-1)}}else l=_m(this._pattern,this._lowercasePattern,0,a,a.toLowerCase(),0,{firstMatchCanBeWeak:!0,boostFullMatch:!0});if(l)return this._matchCount++,o.length===1?{data:l,visibility:i}:{data:{label:a,score:l},visibility:i}}return this.tree.findMode===1?typeof this.tree.options.defaultFindVisibility=="number"?this.tree.options.defaultFindVisibility:this.tree.options.defaultFindVisibility?this.tree.options.defaultFindVisibility(t):2:{data:Dl.Default,visibility:i}}reset(){this._totalCount=0,this._matchCount=0}dispose(){_e(this.disposables)}},Q7=class extends xu{constructor(t){super({icon:N.listFilter,title:u("filter","Filter"),isChecked:t.isChecked??!1,hoverDelegate:t.hoverDelegate??gt("element"),inputActiveOptionBorder:t.inputActiveOptionBorder,inputActiveOptionForeground:t.inputActiveOptionForeground,inputActiveOptionBackground:t.inputActiveOptionBackground})}},Z7=class extends xu{constructor(t){super({icon:N.searchFuzzy,title:u("fuzzySearch","Fuzzy Match"),isChecked:t.isChecked??!1,hoverDelegate:t.hoverDelegate??gt("element"),inputActiveOptionBorder:t.inputActiveOptionBorder,inputActiveOptionForeground:t.inputActiveOptionForeground,inputActiveOptionBackground:t.inputActiveOptionBackground})}},fCe={inputBoxStyles:Bae,toggleStyles:Iae,listFilterWidgetBackground:void 0,listFilterWidgetNoMatchesOutline:void 0,listFilterWidgetOutline:void 0,listFilterWidgetShadow:void 0};var J7=class extends R{constructor(e,i,n,o,s,a){super();this.tree=i;e.appendChild(this.elements.root),this._register(le(()=>this.elements.root.remove()));let l=a?.styles??fCe;l.listFilterWidgetBackground&&(this.elements.root.style.backgroundColor=l.listFilterWidgetBackground),l.listFilterWidgetShadow&&(this.elements.root.style.boxShadow=`0 0 8px 2px ${l.listFilterWidgetShadow}`);let d=this._register(wu());this.modeToggle=this._register(new Q7({...l.toggleStyles,isChecked:o===1,hoverDelegate:d})),this.matchTypeToggle=this._register(new Z7({...l.toggleStyles,isChecked:s===0,hoverDelegate:d})),this.onDidChangeMode=X.map(this.modeToggle.onChange,()=>this.modeToggle.checked?1:0,this._store),this.onDidChangeMatchType=X.map(this.matchTypeToggle.onChange,()=>this.matchTypeToggle.checked?0:1,this._store),this.findInput=this._register(new Lw(this.elements.findInput,n,{label:u("type to search","Type to search"),additionalToggles:[this.modeToggle,this.matchTypeToggle],showCommonFindToggles:!1,inputBoxStyles:l.inputBoxStyles,toggleStyles:l.toggleStyles,history:a?.history})),this.actionbar=this._register(new Fi(this.elements.actionbar)),this.mode=o;let c=this._register(new lt(this.findInput.inputBox.inputElement,"keydown")),p=X.chain(c.event,g=>g.map(v=>new ut(v)));this._register(p(g=>{if(g.equals(3)){g.preventDefault(),g.stopPropagation(),this.findInput.inputBox.addToHistory(),this.tree.domFocus();return}if(g.equals(18)){g.preventDefault(),g.stopPropagation(),this.findInput.inputBox.isAtLastInHistory()||this.findInput.inputBox.isNowhereInHistory()?(this.findInput.inputBox.addToHistory(),this.tree.domFocus()):this.findInput.inputBox.showNextValue();return}if(g.equals(16)){g.preventDefault(),g.stopPropagation(),this.findInput.inputBox.showPreviousValue();return}}));let h=this._register(new et("close",u("close","Close"),"codicon codicon-close",!0,()=>this.dispose()));this.actionbar.push(h,{icon:!0,label:!1});let m=this._register(new lt(this.elements.grab,"mousedown"));this._register(m.event(g=>{let v=new B,I=v.add(new lt(ue(g),"mousemove")),y=v.add(new lt(ue(g),"mouseup")),w=this.right,C=g.pageX,S=this.top,D=g.pageY;this.elements.grab.classList.add("grabbing");let k=this.elements.root.style.transition;this.elements.root.style.transition="unset";let M=O=>{let K=O.pageX-C;this.right=w-K;let G=O.pageY-D;this.top=S+G,this.layout()};v.add(I.event(M)),v.add(y.event(O=>{M(O),this.elements.grab.classList.remove("grabbing"),this.elements.root.style.transition=k,v.dispose()}))}));let f=X.chain(this._register(new lt(this.elements.grab,"keydown")).event,g=>g.map(v=>new ut(v)));this._register(f(g=>{let v,I;if(g.keyCode===15?v=Number.POSITIVE_INFINITY:g.keyCode===17?v=0:g.keyCode===10&&(v=this.right===0?Number.POSITIVE_INFINITY:0),g.keyCode===16?I=0:g.keyCode===18&&(I=Number.POSITIVE_INFINITY),v!==void 0&&(g.preventDefault(),g.stopPropagation(),this.right=v,this.layout()),I!==void 0){g.preventDefault(),g.stopPropagation(),this.top=I;let y=this.elements.root.style.transition;this.elements.root.style.transition="unset",this.layout(),setTimeout(()=>{this.elements.root.style.transition=y},0)}})),this.onDidChangeValue=this.findInput.onDidChange}elements=wi(".monaco-tree-type-filter",[wi(".monaco-tree-type-filter-grab.codicon.codicon-debug-gripper@grab",{tabIndex:0}),wi(".monaco-tree-type-filter-input@findInput"),wi(".monaco-tree-type-filter-actionbar@actionbar")]);set mode(e){this.modeToggle.checked=e===1,this.findInput.inputBox.setPlaceHolder(e===1?u("type to filter","Type to filter"):u("type to search","Type to search"))}set matchType(e){this.matchTypeToggle.checked=e===0}get value(){return this.findInput.inputBox.value}set value(e){this.findInput.inputBox.value=e}modeToggle;matchTypeToggle;findInput;actionbar;width=0;right=0;top=0;_onDidDisable=new x;onDidDisable=this._onDidDisable.event;onDidChangeValue;onDidChangeMode;onDidChangeMatchType;getHistory(){return this.findInput.inputBox.getHistory()}focus(){this.findInput.focus()}select(){this.findInput.select(),this.findInput.inputBox.addToHistory(!0)}layout(e=this.width){this.width=e,this.right=pn(this.right,0,Math.max(0,e-212)),this.elements.root.style.right=`${this.right}px`,this.top=pn(this.top,0,24),this.elements.root.style.top=`${this.top}px`}showMessage(e){this.findInput.showMessage(e)}clearMessage(){this.findInput.clearMessage()}async dispose(){this._onDidDisable.fire(),this.elements.root.classList.add("disabled"),await To(300),super.dispose()}},e9=class{constructor(t,e,i,n,o={}){this.tree=t;this.view=e;this.filter=i;this.contextViewProvider=n;this.options=o;this._mode=t.options.defaultFindMode??0,this._matchType=t.options.defaultFindMatchType??0}_history;_pattern="";get pattern(){return this._pattern}previousPattern="";_mode;get mode(){return this._mode}set mode(t){t!==this._mode&&(this._mode=t,this.widget&&(this.widget.mode=this._mode),this.tree.refilter(),this.render(),this._onDidChangeMode.fire(t))}_matchType;get matchType(){return this._matchType}set matchType(t){t!==this._matchType&&(this._matchType=t,this.widget&&(this.widget.matchType=this._matchType),this.tree.refilter(),this.render(),this._onDidChangeMatchType.fire(t))}widget;width=0;_onDidChangeMode=new x;onDidChangeMode=this._onDidChangeMode.event;_onDidChangeMatchType=new x;onDidChangeMatchType=this._onDidChangeMatchType.event;_onDidChangePattern=new x;onDidChangePattern=this._onDidChangePattern.event;_onDidChangeOpenState=new x;onDidChangeOpenState=this._onDidChangeOpenState.event;enabledDisposables=new B;disposables=new B;updateOptions(t={}){t.defaultFindMode!==void 0&&(this.mode=t.defaultFindMode),t.defaultFindMatchType!==void 0&&(this.matchType=t.defaultFindMatchType)}isOpened(){return!!this.widget}open(){if(this.widget){this.widget.focus(),this.widget.select();return}this.widget=new J7(this.view.getHTMLElement(),this.tree,this.contextViewProvider,this.mode,this.matchType,{...this.options,history:this._history}),this.enabledDisposables.add(this.widget),this.widget.onDidChangeValue(this.onDidChangeValue,this,this.enabledDisposables),this.widget.onDidChangeMode(t=>this.mode=t,void 0,this.enabledDisposables),this.widget.onDidChangeMatchType(t=>this.matchType=t,void 0,this.enabledDisposables),this.widget.onDidDisable(this.close,this,this.enabledDisposables),this.widget.layout(this.width),this.widget.focus(),this.widget.value=this.previousPattern,this.widget.select(),this._onDidChangeOpenState.fire(!0)}close(){this.widget&&(this._history=this.widget.getHistory(),this.widget=void 0,this.enabledDisposables.clear(),this.previousPattern=this.pattern,this.onDidChangeValue(""),this.tree.domFocus(),this._onDidChangeOpenState.fire(!1))}onDidChangeValue(t){this._pattern=t,this._onDidChangePattern.fire(t),this.filter.pattern=t,this.tree.refilter(),t&&this.tree.focusNext(0,!0,void 0,i=>!Dl.isDefault(i.filterData));let e=this.tree.getFocus();if(e.length>0){let i=e[0];this.tree.getRelativeTop(i)===null&&this.tree.reveal(i,.5)}this.render()}render(){let t=this.filter.totalCount>0&&this.filter.matchCount===0;this.pattern&&t?(ka(u("replFindNoResults","No results")),this.tree.options.showNotFoundMessage??!0?this.widget?.showMessage({type:2,content:u("not found","No elements found.")}):this.widget?.showMessage({type:2})):(this.widget?.clearMessage(),this.pattern&&ka(u("replFindResults","{0} results",this.filter.matchCount)))}shouldAllowFocus(t){return!this.widget||!this.pattern||this.filter.totalCount>0&&this.filter.matchCount<=1?!0:!Dl.isDefault(t.filterData)}layout(t){this.width=t,this.widget?.layout(t)}dispose(){this._history=void 0,this._onDidChangePattern.dispose(),this.enabledDisposables.dispose(),this.disposables.dispose()}};function bCe(r,t){return r.position===t.position&&Vae(r,t)}function Vae(r,t){return r.node.element===t.node.element&&r.startIndex===t.startIndex&&r.height===t.height&&r.endIndex===t.endIndex}var t9=class{constructor(t=[]){this.stickyNodes=t}get count(){return this.stickyNodes.length}equal(t){return xi(this.stickyNodes,t.stickyNodes,bCe)}lastNodePartiallyVisible(){if(this.count===0)return!1;let t=this.stickyNodes[this.count-1];if(this.count===1)return t.position!==0;let e=this.stickyNodes[this.count-2];return e.position+e.height!==t.position}animationStateChanged(t){if(!xi(this.stickyNodes,t.stickyNodes,Vae)||this.count===0)return!1;let e=this.stickyNodes[this.count-1],i=t.stickyNodes[t.count-1];return e.position!==i.position}},i9=class{constrainStickyScrollNodes(t,e,i){for(let n=0;n<t.length;n++){let o=t[n];if(o.position+o.height>i||n>=e)return t.slice(0,n)}return t}},aF=class extends R{constructor(e,i,n,o,s,a={}){super();this.tree=e;this.model=i;this.view=n;this.treeDelegate=s;let l=this.validateStickySettings(a);this.stickyScrollMaxItemCount=l.stickyScrollMaxItemCount,this.stickyScrollDelegate=a.stickyScrollDelegate??new i9,this._widget=this._register(new n9(n.getScrollableElement(),n,e,o,s,a.accessibilityProvider)),this.onDidChangeHasFocus=this._widget.onDidChangeHasFocus,this.onContextMenu=this._widget.onContextMenu,this._register(n.onDidScroll(()=>this.update())),this._register(n.onDidChangeContentHeight(()=>this.update())),this._register(e.onDidChangeCollapseState(()=>this.update())),this.update()}onDidChangeHasFocus;onContextMenu;stickyScrollDelegate;stickyScrollMaxItemCount;maxWidgetViewRatio=.4;_widget;get height(){return this._widget.height}get count(){return this._widget.count}getNode(e){return this._widget.getNode(e)}getNodeAtHeight(e){let i;if(e===0?i=this.view.firstVisibleIndex:i=this.view.indexAt(e+this.view.scrollTop),!(i<0||i>=this.view.length))return this.view.element(i)}update(){let e=this.getNodeAtHeight(0);if(!e||this.tree.scrollTop===0){this._widget.setState(void 0);return}let i=this.findStickyState(e);this._widget.setState(i)}findStickyState(e){let i=[],n=e,o=0,s=this.getNextStickyNode(n,void 0,o);for(;s&&(i.push(s),o+=s.height,!(i.length<=this.stickyScrollMaxItemCount&&(n=this.getNextVisibleNode(s),!n)));)s=this.getNextStickyNode(n,s.node,o);let a=this.constrainStickyNodes(i);return a.length?new t9(a):void 0}getNextVisibleNode(e){return this.getNodeAtHeight(e.position+e.height)}getNextStickyNode(e,i,n){let o=this.getAncestorUnderPrevious(e,i);if(o&&!(o===e&&(!this.nodeIsUncollapsedParent(e)||this.nodeTopAlignsWithStickyNodesBottom(e,n))))return this.createStickyScrollNode(o,n)}nodeTopAlignsWithStickyNodesBottom(e,i){let n=this.getNodeIndex(e),o=this.view.getElementTop(n),s=i;return this.view.scrollTop===o-s}createStickyScrollNode(e,i){let n=this.treeDelegate.getHeight(e),{startIndex:o,endIndex:s}=this.getNodeRange(e),a=this.calculateStickyNodePosition(s,i,n);return{node:e,position:a,height:n,startIndex:o,endIndex:s}}getAncestorUnderPrevious(e,i=void 0){let n=e,o=this.getParentNode(n);for(;o;){if(o===i)return n;n=o,o=this.getParentNode(n)}if(i===void 0)return n}calculateStickyNodePosition(e,i,n){let o=this.view.getRelativeTop(e);if(o===null&&this.view.firstVisibleIndex===e&&e+1<this.view.length){let c=this.treeDelegate.getHeight(this.view.element(e)),p=this.view.getRelativeTop(e+1);o=p?p-c/this.view.renderHeight:null}if(o===null)return i;let s=this.view.element(e),a=this.treeDelegate.getHeight(s),d=o*this.view.renderHeight+a;return i+n>d&&i<=d?d-n:i}constrainStickyNodes(e){if(e.length===0)return[];let i=this.view.renderHeight*this.maxWidgetViewRatio,n=e[e.length-1];if(e.length<=this.stickyScrollMaxItemCount&&n.position+n.height<=i)return e;let o=this.stickyScrollDelegate.constrainStickyScrollNodes(e,this.stickyScrollMaxItemCount,i);if(!o.length)return[];let s=o[o.length-1];if(o.length>this.stickyScrollMaxItemCount||s.position+s.height>i)throw new Error("stickyScrollDelegate violates constraints");return o}getParentNode(e){let i=this.model.getNodeLocation(e),n=this.model.getParentNodeLocation(i);return n?this.model.getNode(n):void 0}nodeIsUncollapsedParent(e){let i=this.model.getNodeLocation(e);return this.model.getListRenderCount(i)>1}getNodeIndex(e){let i=this.model.getNodeLocation(e);return this.model.getListIndex(i)}getNodeRange(e){let i=this.model.getNodeLocation(e),n=this.model.getListIndex(i);if(n<0)throw new Error("Node not found in tree");let o=this.model.getListRenderCount(i),s=n+o-1;return{startIndex:n,endIndex:s}}nodePositionTopBelowWidget(e){let i=[],n=this.getParentNode(e);for(;n;)i.push(n),n=this.getParentNode(n);let o=0;for(let s=0;s<i.length&&s<this.stickyScrollMaxItemCount;s++)o+=this.treeDelegate.getHeight(i[s]);return o}getFocus(){return this._widget.getFocus()}domFocus(){this._widget.domFocus()}focusedLast(){return this._widget.focusedLast()}updateOptions(e={}){if(!e.stickyScrollMaxItemCount)return;let i=this.validateStickySettings(e);this.stickyScrollMaxItemCount!==i.stickyScrollMaxItemCount&&(this.stickyScrollMaxItemCount=i.stickyScrollMaxItemCount,this.update())}validateStickySettings(e){let i=7;return typeof e.stickyScrollMaxItemCount=="number"&&(i=Math.max(e.stickyScrollMaxItemCount,1)),{stickyScrollMaxItemCount:i}}setModel(e){this.model=e}},n9=class{constructor(t,e,i,n,o,s){this.view=e;this.tree=i;this.treeRenderers=n;this.treeDelegate=o;this.accessibilityProvider=s;this._rootDomNode=J(".monaco-tree-sticky-container.empty"),t.appendChild(this._rootDomNode);let a=J(".monaco-tree-sticky-container-shadow");this._rootDomNode.appendChild(a),this.stickyScrollFocus=new o9(this._rootDomNode,e),this.onDidChangeHasFocus=this.stickyScrollFocus.onDidChangeHasFocus,this.onContextMenu=this.stickyScrollFocus.onContextMenu}_rootDomNode;_previousState;_previousElements=[];_previousStateDisposables=new B;stickyScrollFocus;onDidChangeHasFocus;onContextMenu;get height(){if(!this._previousState)return 0;let t=this._previousState.stickyNodes[this._previousState.count-1];return t.position+t.height}get count(){return this._previousState?.count??0}getNode(t){return this._previousState?.stickyNodes.find(e=>e.node===t)}setState(t){let e=!!this._previousState&&this._previousState.count>0,i=!!t&&t.count>0;if(!e&&!i||e&&i&&this._previousState.equal(t))return;if(e!==i&&this.setVisible(i),!i){this._previousState=void 0,this._previousElements=[],this._previousStateDisposables.clear();return}let n=t.stickyNodes[t.count-1];if(this._previousState&&t.animationStateChanged(this._previousState))this._previousElements[this._previousState.count-1].style.top=`${n.position}px`;else{this._previousStateDisposables.clear();let o=Array(t.count);for(let s=t.count-1;s>=0;s--){let a=t.stickyNodes[s],{element:l,disposable:d}=this.createElement(a,s,t.count);o[s]=l,this._rootDomNode.appendChild(l),this._previousStateDisposables.add(d)}this.stickyScrollFocus.updateElements(o,t),this._previousElements=o}this._previousState=t,this._rootDomNode.style.height=`${n.position+n.height}px`}createElement(t,e,i){let n=t.startIndex,o=document.createElement("div");o.style.top=`${t.position}px`,this.tree.options.setRowHeight!==!1&&(o.style.height=`${t.height}px`),this.tree.options.setRowLineHeight!==!1&&(o.style.lineHeight=`${t.height}px`),o.classList.add("monaco-tree-sticky-row"),o.classList.add("monaco-list-row"),o.setAttribute("data-index",`${n}`),o.setAttribute("data-parity",n%2===0?"even":"odd"),o.setAttribute("id",this.view.getElementID(n));let s=this.setAccessibilityAttributes(o,t.node.element,e,i),a=this.treeDelegate.getTemplateId(t.node),l=this.treeRenderers.find(h=>h.templateId===a);if(!l)throw new Error(`No renderer found for template id ${a}`);let d=t.node;d===this.tree.getNode(this.tree.getNodeLocation(t.node))&&(d=new Proxy(t.node,{}));let c=l.renderTemplate(o);l.renderElement(d,t.startIndex,c,t.height);let p=le(()=>{s.dispose(),l.disposeElement(d,t.startIndex,c,t.height),l.disposeTemplate(c),o.remove()});return{element:o,disposable:p}}setAccessibilityAttributes(t,e,i,n){if(!this.accessibilityProvider)return R.None;this.accessibilityProvider.getSetSize&&t.setAttribute("aria-setsize",String(this.accessibilityProvider.getSetSize(e,i,n))),this.accessibilityProvider.getPosInSet&&t.setAttribute("aria-posinset",String(this.accessibilityProvider.getPosInSet(e,i))),this.accessibilityProvider.getRole&&t.setAttribute("role",this.accessibilityProvider.getRole(e)??"treeitem");let o=this.accessibilityProvider.getAriaLabel(e),s=o&&typeof o!="string"?o:qg(o),a=Ft(d=>{let c=d.readObservable(s);c?t.setAttribute("aria-label",c):t.removeAttribute("aria-label")});typeof o=="string"||o&&t.setAttribute("aria-label",o.get());let l=this.accessibilityProvider.getAriaLevel&&this.accessibilityProvider.getAriaLevel(e);return typeof l=="number"&&t.setAttribute("aria-level",`${l}`),t.setAttribute("aria-selected",String(!1)),a}setVisible(t){this._rootDomNode.classList.toggle("empty",!t),t||this.stickyScrollFocus.updateElements([],void 0)}getFocus(){return this.stickyScrollFocus.getFocus()}domFocus(){this.stickyScrollFocus.domFocus()}focusedLast(){return this.stickyScrollFocus.focusedLast()}dispose(){this.stickyScrollFocus.dispose(),this._previousStateDisposables.dispose(),this._rootDomNode.remove()}},o9=class extends R{constructor(e,i){super();this.container=e;this.view=i;this._register(F(this.container,"focus",()=>this.onFocus())),this._register(F(this.container,"blur",()=>this.onBlur())),this._register(this.view.onDidFocus(()=>this.toggleStickyScrollFocused(!1))),this._register(this.view.onKeyDown(n=>this.onKeyDown(n))),this._register(this.view.onMouseDown(n=>this.onMouseDown(n))),this._register(this.view.onContextMenu(n=>this.handleContextMenu(n)))}focusedIndex=-1;elements=[];state;_onDidChangeHasFocus=new x;onDidChangeHasFocus=this._onDidChangeHasFocus.event;_onContextMenu=new x;onContextMenu=this._onContextMenu.event;_domHasFocus=!1;get domHasFocus(){return this._domHasFocus}set domHasFocus(e){e!==this._domHasFocus&&(this._onDidChangeHasFocus.fire(e),this._domHasFocus=e)}handleContextMenu(e){let i=e.browserEvent.target;if(!Sw(i)&&!yw(i)){this.focusedLast()&&this.view.domFocus();return}if(!El(e.browserEvent)){if(!this.state)throw new Error("Context menu should not be triggered when state is undefined");let a=this.state.stickyNodes.findIndex(l=>l.node.element===e.element?.element);if(a===-1)throw new Error("Context menu should not be triggered when element is not in sticky scroll widget");this.container.focus(),this.setFocus(a);return}if(!this.state||this.focusedIndex<0)throw new Error("Context menu key should not be triggered when focus is not in sticky scroll widget");let o=this.state.stickyNodes[this.focusedIndex].node.element,s=this.elements[this.focusedIndex];this._onContextMenu.fire({element:o,anchor:s,browserEvent:e.browserEvent,isStickyScroll:!0})}onKeyDown(e){if(this.domHasFocus&&this.state){if(e.key==="ArrowUp")this.setFocusedElement(Math.max(0,this.focusedIndex-1)),e.preventDefault(),e.stopPropagation();else if(e.key==="ArrowDown"||e.key==="ArrowRight"){if(this.focusedIndex>=this.state.count-1){let i=this.state.stickyNodes[this.state.count-1].startIndex+1;this.view.domFocus(),this.view.setFocus([i]),this.scrollNodeUnderWidget(i,this.state)}else this.setFocusedElement(this.focusedIndex+1);e.preventDefault(),e.stopPropagation()}}}onMouseDown(e){let i=e.browserEvent.target;!Sw(i)&&!yw(i)||(e.browserEvent.preventDefault(),e.browserEvent.stopPropagation())}updateElements(e,i){if(i&&i.count===0)throw new Error("Sticky scroll state must be undefined when there are no sticky nodes");if(i&&i.count!==e.length)throw new Error("Sticky scroll focus received illigel state");let n=this.focusedIndex;if(this.removeFocus(),this.elements=e,this.state=i,i){let o=pn(n,0,i.count-1);this.setFocus(o)}else this.domHasFocus&&this.view.domFocus();this.container.tabIndex=i?0:-1}setFocusedElement(e){let i=this.state;if(!i)throw new Error("Cannot set focus when state is undefined");if(this.setFocus(e),!(e<i.count-1)&&i.lastNodePartiallyVisible()){let n=i.stickyNodes[e];this.scrollNodeUnderWidget(n.endIndex+1,i)}}scrollNodeUnderWidget(e,i){let n=i.stickyNodes[i.count-1],o=i.count>1?i.stickyNodes[i.count-2]:void 0,s=this.view.getElementTop(e),a=o?o.position+o.height+n.height:n.height;this.view.scrollTop=s-a}getFocus(){if(!(!this.state||this.focusedIndex===-1))return this.state.stickyNodes[this.focusedIndex].node.element}domFocus(){if(!this.state)throw new Error("Cannot focus when state is undefined");this.container.focus()}focusedLast(){return this.state?this.view.getHTMLElement().classList.contains("sticky-scroll-focused"):!1}removeFocus(){this.focusedIndex!==-1&&(this.toggleElementFocus(this.elements[this.focusedIndex],!1),this.focusedIndex=-1)}setFocus(e){if(0>e)throw new Error("addFocus() can not remove focus");if(!this.state&&e>=0)throw new Error("Cannot set focus index when state is undefined");if(this.state&&e>=this.state.count)throw new Error("Cannot set focus index to an index that does not exist");let i=this.focusedIndex;i>=0&&this.toggleElementFocus(this.elements[i],!1),e>=0&&this.toggleElementFocus(this.elements[e],!0),this.focusedIndex=e}toggleElementFocus(e,i){this.toggleElementActiveFocus(e,i&&this.domHasFocus),this.toggleElementPassiveFocus(e,i)}toggleCurrentElementActiveFocus(e){this.focusedIndex!==-1&&this.toggleElementActiveFocus(this.elements[this.focusedIndex],e)}toggleElementActiveFocus(e,i){e.classList.toggle("focused",i)}toggleElementPassiveFocus(e,i){e.classList.toggle("passive-focused",i)}toggleStickyScrollFocused(e){this.view.getHTMLElement().classList.toggle("sticky-scroll-focused",e)}onFocus(){if(!this.state||this.elements.length===0)throw new Error("Cannot focus when state is undefined or elements are empty");this.domHasFocus=!0,this.toggleStickyScrollFocused(!0),this.toggleCurrentElementActiveFocus(!0),this.focusedIndex===-1&&this.setFocus(0)}onBlur(){this.domHasFocus=!1,this.toggleCurrentElementActiveFocus(!1)}dispose(){this.toggleStickyScrollFocused(!1),this._onDidChangeHasFocus.fire(!1),super.dispose()}};function Rw(r){let t=0;return HA(r.browserEvent.target,"monaco-tl-twistie","monaco-tl-row")?t=1:HA(r.browserEvent.target,"monaco-tl-contents","monaco-tl-row")?t=2:HA(r.browserEvent.target,"monaco-tree-type-filter","monaco-list")&&(t=3),{browserEvent:r.browserEvent,element:r.element?r.element.element:null,target:t}}function vCe(r){let t=Sw(r.browserEvent.target);return{element:r.element?r.element.element:null,browserEvent:r.browserEvent,anchor:r.anchor,isStickyScroll:t}}function sF(r,t){t(r),r.children.forEach(e=>sF(e,t))}var oL=class{constructor(t,e){this.getFirstViewElementWithTrait=t;this.identityProvider=e}nodes=[];elements;_onDidChange=new x;onDidChange=this._onDidChange.event;_nodeSet;get nodeSet(){return this._nodeSet||(this._nodeSet=this.createNodeSet()),this._nodeSet}set(t,e){!e?.__forceEvent&&xi(this.nodes,t)||this._set(t,!1,e)}_set(t,e,i){if(this.nodes=[...t],this.elements=void 0,this._nodeSet=void 0,!e){let n=this;this._onDidChange.fire({get elements(){return n.get()},browserEvent:i})}}get(){return this.elements||(this.elements=this.nodes.map(t=>t.element)),[...this.elements]}getNodes(){return this.nodes}has(t){return this.nodeSet.has(t)}onDidModelSplice({insertedNodes:t,deletedNodes:e}){if(!this.identityProvider){let l=this.createNodeSet(),d=c=>l.delete(c);e.forEach(c=>sF(c,d)),this.set([...l.values()]);return}let i=new Set,n=l=>i.add(this.identityProvider.getId(l.element).toString());e.forEach(l=>sF(l,n));let o=new Map,s=l=>o.set(this.identityProvider.getId(l.element).toString(),l);t.forEach(l=>sF(l,s));let a=[];for(let l of this.nodes){let d=this.identityProvider.getId(l.element).toString();if(!i.has(d))a.push(l);else{let p=o.get(d);p&&p.visible&&a.push(p)}}if(this.nodes.length>0&&a.length===0){let l=this.getFirstViewElementWithTrait();l&&a.push(l)}this._set(a,!0)}createNodeSet(){let t=new Set;for(let e of this.nodes)t.add(e);return t}},r9=class extends zk{constructor(e,i,n){super(e);this.tree=i;this.stickyScrollProvider=n}onViewPointer(e){if(y7(e.browserEvent.target)||dc(e.browserEvent.target)||vw(e.browserEvent.target)||e.browserEvent.isHandledByList)return;let i=e.element;if(!i)return super.onViewPointer(e);if(this.isSelectionRangeChangeEvent(e)||this.isSelectionSingleChangeEvent(e))return super.onViewPointer(e);let n=e.browserEvent.target,o=n.classList.contains("monaco-tl-twistie")||n.classList.contains("monaco-icon-label")&&n.classList.contains("folder-icon")&&e.browserEvent.offsetX<16,s=yw(e.browserEvent.target),a=!1;if(s?a=!0:typeof this.tree.expandOnlyOnTwistieClick=="function"?a=this.tree.expandOnlyOnTwistieClick(i.element):a=!!this.tree.expandOnlyOnTwistieClick,s)this.handleStickyScrollMouseEvent(e,i);else{if(a&&!o&&e.browserEvent.detail!==2)return super.onViewPointer(e);if(!this.tree.expandOnDoubleClick&&e.browserEvent.detail===2)return super.onViewPointer(e)}if(i.collapsible&&(!s||o)){let l=this.tree.getNodeLocation(i),d=e.browserEvent.altKey;if(this.tree.setFocus([l]),this.tree.toggleCollapsed(l,d),o){e.browserEvent.isHandledByList=!0;return}}s||super.onViewPointer(e)}handleStickyScrollMouseEvent(e,i){if(dae(e.browserEvent.target)||cae(e.browserEvent.target))return;let n=this.stickyScrollProvider();if(!n)throw new Error("Sticky scroll controller not found");let o=this.list.indexOf(i),s=this.list.getElementTop(o),a=n.nodePositionTopBelowWidget(i);this.tree.scrollTop=s-a,this.list.domFocus(),this.list.setFocus([o]),this.list.setSelection([o])}onDoubleClick(e){e.browserEvent.target.classList.contains("monaco-tl-twistie")||!this.tree.expandOnDoubleClick||e.browserEvent.isHandledByList||super.onDoubleClick(e)}onMouseDown(e){let i=e.browserEvent.target;if(!Sw(i)&&!yw(i)){super.onMouseDown(e);return}}onContextMenu(e){let i=e.browserEvent.target;if(!Sw(i)&&!yw(i)){super.onContextMenu(e);return}}},s9=class extends ho{constructor(e,i,n,o,s,a,l,d){super(e,i,n,o,d);this.focusTrait=s;this.selectionTrait=a;this.anchorTrait=l}createMouseController(e){return new r9(this,e.tree,e.stickyScrollProvider)}splice(e,i,n=[]){if(super.splice(e,i,n),n.length===0)return;let o=[],s=[],a;n.forEach((l,d)=>{this.focusTrait.has(l)&&o.push(e+d),this.selectionTrait.has(l)&&s.push(e+d),this.anchorTrait.has(l)&&(a=e+d)}),o.length>0&&super.setFocus(Mo([...super.getFocus(),...o])),s.length>0&&super.setSelection(Mo([...super.getSelection(),...s])),typeof a=="number"&&super.setAnchor(a)}setFocus(e,i,n=!1){super.setFocus(e,i),n||this.focusTrait.set(e.map(o=>this.element(o)),i)}setSelection(e,i,n=!1){super.setSelection(e,i),n||this.selectionTrait.set(e.map(o=>this.element(o)),i)}setAnchor(e,i=!1){super.setAnchor(e),i||(typeof e>"u"?this.anchorTrait.set([]):this.anchorTrait.set([this.element(e)]))}};var Mw=class{constructor(t,e,i,n,o={}){this._user=t;this._options=o;let s;o.keyboardNavigationLabelProvider&&(s=new Y7(this,o.keyboardNavigationLabelProvider,o.filter),o={...o,filter:s},this.disposables.add(s)),this.model=this.createModel(t,o),this.treeDelegate=new Pw(i);let a=this.disposables.add(new j7(this.onDidChangeActiveNodesRelay.event)),l=new Kc;this.renderers=n.map(d=>new X7(d,this.model,this.onDidChangeCollapseStateRelay.event,a,l,o));for(let d of this.renderers)this.disposables.add(d);if(this.focus=new oL(()=>this.view.getFocusedElements()[0],o.identityProvider),this.selection=new oL(()=>this.view.getSelectedElements()[0],o.identityProvider),this.anchor=new oL(()=>this.view.getAnchorElement(),o.identityProvider),this.view=new s9(t,e,this.treeDelegate,this.renderers,this.focus,this.selection,this.anchor,{...gCe(()=>this.model,o),tree:this,stickyScrollProvider:()=>this.stickyScrollController}),this.setupModel(this.model),o.keyboardSupport!==!1){let d=X.chain(this.view.onKeyDown,c=>c.filter(p=>!dc(p.target)).map(p=>new ut(p)));X.chain(d,c=>c.filter(p=>p.keyCode===15))(this.onLeftArrow,this,this.disposables),X.chain(d,c=>c.filter(p=>p.keyCode===17))(this.onRightArrow,this,this.disposables),X.chain(d,c=>c.filter(p=>p.keyCode===10))(this.onSpace,this,this.disposables)}if((o.findWidgetEnabled??!0)&&o.keyboardNavigationLabelProvider&&o.contextViewProvider){let d=this.options.findWidgetStyles?{styles:this.options.findWidgetStyles}:void 0;this.findController=new e9(this,this.view,s,o.contextViewProvider,d),this.focusNavigationFilter=c=>this.findController.shouldAllowFocus(c),this.onDidChangeFindOpenState=this.findController.onDidChangeOpenState,this.disposables.add(this.findController),this.onDidChangeFindMode=this.findController.onDidChangeMode,this.onDidChangeFindMatchType=this.findController.onDidChangeMatchType,this.disposables.add(this.onDidSpliceModelRelay.event(()=>{!this.findController.isOpened()||this.findController.pattern.length===0||(this.refilter(),this.findController.render())}))}else this.onDidChangeFindMode=X.None,this.onDidChangeFindMatchType=X.None;o.enableStickyScroll&&(this.stickyScrollController=new aF(this,this.model,this.view,this.renderers,this.treeDelegate,o),this.onDidChangeStickyScrollFocused=this.stickyScrollController.onDidChangeHasFocus),this.styleElement=Go(this.view.getHTMLElement()),this.getHTMLElement().classList.toggle("always",this._options.renderIndentGuides==="always")}view;renderers;model;treeDelegate;focus;selection;anchor;eventBufferer=new Xg;findController;onDidChangeFindOpenState=X.None;onDidChangeStickyScrollFocused=X.None;focusNavigationFilter;stickyScrollController;styleElement;disposables=new B;get onDidScroll(){return this.view.onDidScroll}get onDidChangeFocus(){return this.eventBufferer.wrapEvent(this.focus.onDidChange)}get onDidChangeSelection(){return this.eventBufferer.wrapEvent(this.selection.onDidChange)}get onMouseClick(){return X.map(this.view.onMouseClick,Rw)}get onMouseDblClick(){return X.filter(X.map(this.view.onMouseDblClick,Rw),t=>t.target!==3)}get onMouseOver(){return X.map(this.view.onMouseOver,Rw)}get onMouseOut(){return X.map(this.view.onMouseOut,Rw)}get onContextMenu(){return X.any(X.filter(X.map(this.view.onContextMenu,vCe),t=>!t.isStickyScroll),this.stickyScrollController?.onContextMenu??X.None)}get onTap(){return X.map(this.view.onTap,Rw)}get onPointer(){return X.map(this.view.onPointer,Rw)}get onKeyDown(){return this.view.onKeyDown}get onKeyUp(){return this.view.onKeyUp}get onKeyPress(){return this.view.onKeyPress}get onDidFocus(){return this.view.onDidFocus}get onDidBlur(){return this.view.onDidBlur}onDidSwapModel=this.disposables.add(new x);onDidChangeModelRelay=this.disposables.add(new sc);onDidSpliceModelRelay=this.disposables.add(new sc);onDidChangeCollapseStateRelay=this.disposables.add(new sc);onDidChangeRenderNodeCountRelay=this.disposables.add(new sc);onDidChangeActiveNodesRelay=this.disposables.add(new sc);get onDidChangeModel(){return X.any(this.onDidChangeModelRelay.event,this.onDidSwapModel.event)}get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}get onDidChangeRenderNodeCount(){return this.model.onDidChangeRenderNodeCount}_onWillRefilter=new x;onWillRefilter=this._onWillRefilter.event;get findMode(){return this.findController?.mode??0}set findMode(t){this.findController&&(this.findController.mode=t)}onDidChangeFindMode;get findMatchType(){return this.findController?.matchType??0}set findMatchType(t){this.findController&&(this.findController.matchType=t)}onDidChangeFindMatchType;get onDidChangeFindPattern(){return this.findController?this.findController.onDidChangePattern:X.None}get expandOnDoubleClick(){return typeof this._options.expandOnDoubleClick>"u"?!0:this._options.expandOnDoubleClick}get expandOnlyOnTwistieClick(){return typeof this._options.expandOnlyOnTwistieClick>"u"?!0:this._options.expandOnlyOnTwistieClick}_onDidUpdateOptions=new x;onDidUpdateOptions=this._onDidUpdateOptions.event;get onDidDispose(){return this.view.onDidDispose}updateOptions(t={}){this._options={...this._options,...t};for(let e of this.renderers)e.updateOptions(t);this.view.updateOptions(this._options),this.findController?.updateOptions(t),this.updateStickyScroll(t),this._onDidUpdateOptions.fire(this._options),this.getHTMLElement().classList.toggle("always",this._options.renderIndentGuides==="always")}get options(){return this._options}updateStickyScroll(t){!this.stickyScrollController&&this._options.enableStickyScroll?(this.stickyScrollController=new aF(this,this.model,this.view,this.renderers,this.treeDelegate,this._options),this.onDidChangeStickyScrollFocused=this.stickyScrollController.onDidChangeHasFocus):this.stickyScrollController&&!this._options.enableStickyScroll&&(this.onDidChangeStickyScrollFocused=X.None,this.stickyScrollController.dispose(),this.stickyScrollController=void 0),this.stickyScrollController?.updateOptions(t)}updateWidth(t){let e=this.model.getListIndex(t);e!==-1&&this.view.updateWidth(e)}getHTMLElement(){return this.view.getHTMLElement()}get contentHeight(){return this.view.contentHeight}get contentWidth(){return this.view.contentWidth}get onDidChangeContentHeight(){return this.view.onDidChangeContentHeight}get onDidChangeContentWidth(){return this.view.onDidChangeContentWidth}get scrollTop(){return this.view.scrollTop}set scrollTop(t){this.view.scrollTop=t}get scrollLeft(){return this.view.scrollLeft}set scrollLeft(t){this.view.scrollLeft=t}get scrollHeight(){return this.view.scrollHeight}get renderHeight(){return this.view.renderHeight}get firstVisibleElement(){let t=this.view.firstVisibleIndex;return this.stickyScrollController&&(t+=this.stickyScrollController.count),t<0||t>=this.view.length?void 0:this.view.element(t).element}get lastVisibleElement(){let t=this.view.lastVisibleIndex;return this.view.element(t).element}get ariaLabel(){return this.view.ariaLabel}set ariaLabel(t){this.view.ariaLabel=t}get selectionSize(){return this.selection.getNodes().length}domFocus(){this.stickyScrollController?.focusedLast()?this.stickyScrollController.domFocus():this.view.domFocus()}isDOMFocused(){return fs(this.getHTMLElement())}layout(t,e){this.view.layout(t,e),cr(e)&&this.findController?.layout(e)}style(t){let e=`.${this.view.domId}`,i=[];t.treeIndentGuidesStroke&&(i.push(`.monaco-list${e}:hover .monaco-tl-indent > .indent-guide, .monaco-list${e}.always .monaco-tl-indent > .indent-guide  { border-color: ${t.treeInactiveIndentGuidesStroke}; }`),i.push(`.monaco-list${e} .monaco-tl-indent > .indent-guide.active { border-color: ${t.treeIndentGuidesStroke}; }`));let n=t.treeStickyScrollBackground??t.listBackground;n&&(i.push(`.monaco-list${e} .monaco-scrollable-element .monaco-tree-sticky-container { background-color: ${n}; }`),i.push(`.monaco-list${e} .monaco-scrollable-element .monaco-tree-sticky-container .monaco-tree-sticky-row { background-color: ${n}; }`)),t.treeStickyScrollBorder&&i.push(`.monaco-list${e} .monaco-scrollable-element .monaco-tree-sticky-container { border-bottom: 1px solid ${t.treeStickyScrollBorder}; }`),t.treeStickyScrollShadow&&i.push(`.monaco-list${e} .monaco-scrollable-element .monaco-tree-sticky-container .monaco-tree-sticky-container-shadow { box-shadow: ${t.treeStickyScrollShadow} 0 6px 6px -6px inset; height: 3px; }`),t.listFocusForeground&&(i.push(`.monaco-list${e}.sticky-scroll-focused .monaco-scrollable-element .monaco-tree-sticky-container:focus .monaco-list-row.focused { color: ${t.listFocusForeground}; }`),i.push(`.monaco-list${e}:not(.sticky-scroll-focused) .monaco-scrollable-element .monaco-tree-sticky-container .monaco-list-row.focused { color: inherit; }`));let o=Ja(t.listFocusAndSelectionOutline,Ja(t.listSelectionOutline,t.listFocusOutline??""));o&&(i.push(`.monaco-list${e}.sticky-scroll-focused .monaco-scrollable-element .monaco-tree-sticky-container:focus .monaco-list-row.focused.selected { outline: 1px solid ${o}; outline-offset: -1px;}`),i.push(`.monaco-list${e}:not(.sticky-scroll-focused) .monaco-scrollable-element .monaco-tree-sticky-container .monaco-list-row.focused.selected { outline: inherit;}`)),t.listFocusOutline&&(i.push(`.monaco-list${e}.sticky-scroll-focused .monaco-scrollable-element .monaco-tree-sticky-container:focus .monaco-list-row.focused { outline: 1px solid ${t.listFocusOutline}; outline-offset: -1px; }`),i.push(`.monaco-list${e}:not(.sticky-scroll-focused) .monaco-scrollable-element .monaco-tree-sticky-container .monaco-list-row.focused { outline: inherit; }`),i.push(`.monaco-workbench.context-menu-visible .monaco-list${e}.last-focused.sticky-scroll-focused .monaco-scrollable-element .monaco-tree-sticky-container .monaco-list-row.passive-focused { outline: 1px solid ${t.listFocusOutline}; outline-offset: -1px; }`),i.push(`.monaco-workbench.context-menu-visible .monaco-list${e}.last-focused.sticky-scroll-focused .monaco-list-rows .monaco-list-row.focused { outline: inherit; }`),i.push(`.monaco-workbench.context-menu-visible .monaco-list${e}.last-focused:not(.sticky-scroll-focused) .monaco-tree-sticky-container .monaco-list-rows .monaco-list-row.focused { outline: inherit; }`)),this.styleElement.textContent=i.join(`
`),this.view.style(t)}getParentElement(t){let e=this.model.getParentNodeLocation(t);return this.model.getNode(e).element}getFirstElementChild(t){return this.model.getFirstElementChild(t)}getNode(t){return this.model.getNode(t)}getNodeLocation(t){return this.model.getNodeLocation(t)}collapse(t,e=!1){return this.model.setCollapsed(t,!0,e)}expand(t,e=!1){return this.model.setCollapsed(t,!1,e)}toggleCollapsed(t,e=!1){return this.model.setCollapsed(t,void 0,e)}expandAll(){this.model.setCollapsed(this.model.rootRef,!1,!0)}collapseAll(){this.model.setCollapsed(this.model.rootRef,!0,!0)}isCollapsible(t){return this.model.isCollapsible(t)}setCollapsible(t,e){return this.model.setCollapsible(t,e)}isCollapsed(t){return this.model.isCollapsed(t)}expandTo(t){this.model.expandTo(t)}triggerTypeNavigation(){this.view.triggerTypeNavigation()}openFind(){this.findController?.open()}closeFind(){this.findController?.close()}refilter(){this._onWillRefilter.fire(void 0),this.model.refilter()}setAnchor(t){if(typeof t>"u")return this.view.setAnchor(void 0);this.eventBufferer.bufferEvents(()=>{let e=this.model.getNode(t);this.anchor.set([e]);let i=this.model.getListIndex(t);i>-1&&this.view.setAnchor(i,!0)})}getAnchor(){return this.anchor.get().at(0)}setSelection(t,e){this.eventBufferer.bufferEvents(()=>{let i=t.map(o=>this.model.getNode(o));this.selection.set(i,e);let n=t.map(o=>this.model.getListIndex(o)).filter(o=>o>-1);this.view.setSelection(n,e,!0)})}getSelection(){return this.selection.get()}setFocus(t,e){this.eventBufferer.bufferEvents(()=>{let i=t.map(o=>this.model.getNode(o));this.focus.set(i,e);let n=t.map(o=>this.model.getListIndex(o)).filter(o=>o>-1);this.view.setFocus(n,e,!0)})}focusNext(t=1,e=!1,i,n=El(i)&&i.altKey?void 0:this.focusNavigationFilter){this.view.focusNext(t,e,i,n)}focusPrevious(t=1,e=!1,i,n=El(i)&&i.altKey?void 0:this.focusNavigationFilter){this.view.focusPrevious(t,e,i,n)}focusNextPage(t,e=El(t)&&t.altKey?void 0:this.focusNavigationFilter){return this.view.focusNextPage(t,e)}focusPreviousPage(t,e=El(t)&&t.altKey?void 0:this.focusNavigationFilter){return this.view.focusPreviousPage(t,e,()=>this.stickyScrollController?.height??0)}focusLast(t,e=El(t)&&t.altKey?void 0:this.focusNavigationFilter){this.view.focusLast(t,e)}focusFirst(t,e=El(t)&&t.altKey?void 0:this.focusNavigationFilter){this.view.focusFirst(t,e)}getFocus(){return this.focus.get()}getStickyScrollFocus(){let t=this.stickyScrollController?.getFocus();return t!==void 0?[t]:[]}getFocusedPart(){return this.stickyScrollController?.focusedLast()?1:0}reveal(t,e){this.model.expandTo(t);let i=this.model.getListIndex(t);if(i!==-1)if(!this.stickyScrollController)this.view.reveal(i,e);else{let n=this.stickyScrollController.nodePositionTopBelowWidget(this.getNode(t));this.view.reveal(i,e,n)}}getRelativeTop(t){let e=this.model.getListIndex(t);if(e===-1)return null;let i=this.stickyScrollController?.getNode(this.getNode(t));return this.view.getRelativeTop(e,i?.position??this.stickyScrollController?.height)}getViewState(t=this.options.identityProvider){if(!t)throw new Qn(this._user,"Can't get tree view state without an identity provider");let e=s=>t.getId(s).toString(),i=$7.empty(this.scrollTop);for(let s of this.getFocus())i.focus.add(e(s));for(let s of this.getSelection())i.selection.add(e(s));let n=this.model.getNode(),o=[n];for(;o.length>0;){let s=o.shift();s!==n&&s.collapsible&&(i.expanded[e(s.element)]=s.collapsed?0:1),o.push(...s.children)}return i}onLeftArrow(t){t.preventDefault(),t.stopPropagation();let e=this.view.getFocusedElements();if(e.length===0)return;let i=e[0],n=this.model.getNodeLocation(i);if(!this.model.setCollapsed(n,!0)){let s=this.model.getParentNodeLocation(n);if(!s)return;let a=this.model.getListIndex(s);this.view.reveal(a),this.view.setFocus([a])}}onRightArrow(t){t.preventDefault(),t.stopPropagation();let e=this.view.getFocusedElements();if(e.length===0)return;let i=e[0],n=this.model.getNodeLocation(i);if(!this.model.setCollapsed(n,!1)){if(!i.children.some(l=>l.visible))return;let[s]=this.view.getFocus(),a=s+1;this.view.reveal(a),this.view.setFocus([a])}}onSpace(t){t.preventDefault(),t.stopPropagation();let e=this.view.getFocusedElements();if(e.length===0)return;let i=e[0],n=this.model.getNodeLocation(i),o=t.browserEvent.altKey;this.model.setCollapsed(n,void 0,o)}modelDisposables=new B;setupModel(t){this.modelDisposables.clear(),this.modelDisposables.add(t.onDidSpliceRenderedNodes(({start:o,deleteCount:s,elements:a})=>this.view.splice(o,s,a)));let e=X.forEach(t.onDidSpliceModel,o=>{this.eventBufferer.bufferEvents(()=>{this.focus.onDidModelSplice(o),this.selection.onDidModelSplice(o)})},this.modelDisposables);e(()=>null,null,this.modelDisposables);let i=this.modelDisposables.add(new x),n=this.modelDisposables.add(new yd(0));this.modelDisposables.add(X.any(e,this.focus.onDidChange,this.selection.onDidChange)(()=>{n.trigger(()=>{let o=new Set;for(let s of this.focus.getNodes())o.add(s);for(let s of this.selection.getNodes())o.add(s);i.fire([...o.values()])})})),this.onDidChangeActiveNodesRelay.input=i.event,this.onDidChangeModelRelay.input=X.signal(t.onDidSpliceModel),this.onDidChangeCollapseStateRelay.input=t.onDidChangeCollapseState,this.onDidChangeRenderNodeCountRelay.input=t.onDidChangeRenderNodeCount}setModel(t){let e=this.model;this.model=t,this.setupModel(t),this.renderers.forEach(i=>i.setModel(t)),this.stickyScrollController?.setModel(t),this.focus.set([]),this.selection.set([]),this.anchor.set([]),this.view.splice(0,e.getListRenderCount(e.rootRef)),this.model.refilter(),this.onDidSwapModel.fire()}getModel(){return this.model}navigate(t){return new a9(this.view,this.model,t)}dispose(){_e(this.disposables),this.stickyScrollController?.dispose(),this.view.dispose(),this.modelDisposables.dispose()}},a9=class{constructor(t,e,i){this.view=t;this.model=e;i?this.index=this.model.getListIndex(i):this.index=-1}index;current(){return this.index<0||this.index>=this.view.length?null:this.view.element(this.index).element}previous(){return this.index--,this.current()}next(){return this.index++,this.current()}first(){return this.index=0,this.current()}last(){return this.index=this.view.length-1,this.current()}};var Aw=class{constructor(t,e,i){this.options=e;this.styles=i;this.element=U(t,J(".monaco-count-badge")),this.countFormat=this.options.countFormat||"{0}",this.titleFormat=this.options.titleFormat||"",this.setCount(this.options.count||0)}element;count=0;countFormat;titleFormat;setCount(t){this.count=t,this.render()}setCountFormat(t){this.countFormat=t,this.render()}setTitleFormat(t){this.titleFormat=t,this.render()}render(){this.element.textContent=Sp(this.countFormat,this.count),this.element.title=Sp(this.titleFormat,this.count),this.element.style.backgroundColor=this.styles.badgeBackground??"",this.element.style.color=this.styles.badgeForeground??"",this.styles.badgeBorder&&(this.element.style.border=`1px solid ${this.styles.badgeBorder}`)}};var Ow=class{},lF=class{_disposables=new B;_domNode;_scrollable;_onDidSelectItem=new x;_onDidFocusItem=new x;_onDidChangeFocus=new x;onDidSelectItem=this._onDidSelectItem.event;onDidFocusItem=this._onDidFocusItem.event;onDidChangeFocus=this._onDidChangeFocus.event;_items=new Array;_nodes=new Array;_freeNodes=new Array;_separatorIcon;_enabled=!0;_focusedItemIdx=-1;_selectedItemIdx=-1;_pendingDimLayout;_pendingLayout;_dimension;constructor(t,e,i,n){this._domNode=document.createElement("div"),this._domNode.className="monaco-breadcrumbs",this._domNode.tabIndex=0,this._domNode.setAttribute("role","list"),this._scrollable=new Da(this._domNode,{vertical:2,horizontal:1,horizontalScrollbarSize:e,useShadows:!1,scrollYToX:!0}),this._separatorIcon=i,this._disposables.add(this._scrollable),this._disposables.add(Ut(this._domNode,"click",a=>this._onClick(a))),t.appendChild(this._scrollable.getDomNode());let o=Go(this._domNode);this._style(o,n);let s=Er(this._domNode);this._disposables.add(s),this._disposables.add(s.onDidBlur(a=>this._onDidChangeFocus.fire(!1))),this._disposables.add(s.onDidFocus(a=>this._onDidChangeFocus.fire(!0)))}setHorizontalScrollbarSize(t){this._scrollable.updateOptions({horizontalScrollbarSize:t})}dispose(){this._disposables.dispose(),this._pendingLayout?.dispose(),this._pendingDimLayout?.dispose(),this._onDidSelectItem.dispose(),this._onDidFocusItem.dispose(),this._onDidChangeFocus.dispose(),this._domNode.remove(),this._nodes.length=0,this._freeNodes.length=0}layout(t){t&&Ge.equals(t,this._dimension)||(t?(this._pendingDimLayout?.dispose(),this._pendingDimLayout=this._updateDimensions(t)):(this._pendingLayout?.dispose(),this._pendingLayout=this._updateScrollbar()))}_updateDimensions(t){let e=new B;return e.add(ote(ue(this._domNode),()=>{this._dimension=t,this._domNode.style.width=`${t.width}px`,this._domNode.style.height=`${t.height}px`,e.add(this._updateScrollbar())})),e}_updateScrollbar(){return j4(ue(this._domNode),()=>{j4(ue(this._domNode),()=>{this._scrollable.setRevealOnScroll(!1),this._scrollable.scanDomNode(),this._scrollable.setRevealOnScroll(!0)})})}_style(t,e){let i="";e.breadcrumbsBackground&&(i+=`.monaco-breadcrumbs { background-color: ${e.breadcrumbsBackground}}`),e.breadcrumbsForeground&&(i+=`.monaco-breadcrumbs .monaco-breadcrumb-item { color: ${e.breadcrumbsForeground}}
`),e.breadcrumbsFocusForeground&&(i+=`.monaco-breadcrumbs .monaco-breadcrumb-item.focused { color: ${e.breadcrumbsFocusForeground}}
`),e.breadcrumbsFocusAndSelectionForeground&&(i+=`.monaco-breadcrumbs .monaco-breadcrumb-item.focused.selected { color: ${e.breadcrumbsFocusAndSelectionForeground}}
`),e.breadcrumbsHoverForeground&&(i+=`.monaco-breadcrumbs:not(.disabled	) .monaco-breadcrumb-item:hover:not(.focused):not(.selected) { color: ${e.breadcrumbsHoverForeground}}
`),t.innerText=i}setEnabled(t){this._enabled=t,this._domNode.classList.toggle("disabled",!this._enabled)}domFocus(){let t=this._focusedItemIdx>=0?this._focusedItemIdx:this._items.length-1;t>=0&&t<this._items.length?this._focus(t,void 0):this._domNode.focus()}isDOMFocused(){return uf(this._domNode)}getFocused(){return this._items[this._focusedItemIdx]}setFocused(t,e){this._focus(this._items.indexOf(t),e)}focusPrev(t){this._focusedItemIdx>0&&this._focus(this._focusedItemIdx-1,t)}focusNext(t){this._focusedItemIdx+1<this._nodes.length&&this._focus(this._focusedItemIdx+1,t)}_focus(t,e){this._focusedItemIdx=-1;for(let i=0;i<this._nodes.length;i++){let n=this._nodes[i];i!==t?n.classList.remove("focused"):(this._focusedItemIdx=i,n.classList.add("focused"),n.focus())}this._reveal(this._focusedItemIdx,!0),this._onDidFocusItem.fire({type:"focus",item:this._items[this._focusedItemIdx],node:this._nodes[this._focusedItemIdx],payload:e})}reveal(t){let e=this._items.indexOf(t);e>=0&&this._reveal(e,!1)}revealLast(){this._reveal(this._items.length-1,!1)}_reveal(t,e){if(t<0||t>=this._nodes.length)return;let i=this._nodes[t];if(!i)return;let{width:n}=this._scrollable.getScrollDimensions(),{scrollLeft:o}=this._scrollable.getScrollPosition();(!e||i.offsetLeft>o+n||i.offsetLeft<o)&&(this._scrollable.setRevealOnScroll(!1),this._scrollable.setScrollPosition({scrollLeft:i.offsetLeft}),this._scrollable.setRevealOnScroll(!0))}getSelection(){return this._items[this._selectedItemIdx]}setSelection(t,e){this._select(this._items.indexOf(t),e)}_select(t,e){this._selectedItemIdx=-1;for(let i=0;i<this._nodes.length;i++){let n=this._nodes[i];i!==t?n.classList.remove("selected"):(this._selectedItemIdx=i,n.classList.add("selected"))}this._onDidSelectItem.fire({type:"select",item:this._items[this._selectedItemIdx],node:this._nodes[this._selectedItemIdx],payload:e})}getItems(){return this._items}setItems(t){let e,i=[];try{e=CJ(this._items,t,(n,o)=>n.equals(o)),i=this._items.splice(e,this._items.length-e,...t.slice(e)),this._render(e),_e(i),this._focus(-1,void 0)}catch(n){let o=new Error(`BreadcrumbsItem#setItems: newItems: ${t.length}, prefix: ${e}, removed: ${i.length}`);throw o.name=n.name,o.stack=n.stack,o}}_render(t){let e=!1;for(;t<this._items.length&&t<this._nodes.length;t++){let i=this._items[t],n=this._nodes[t];this._renderItem(i,n),e=!0}for(;t<this._nodes.length;){let i=this._nodes.pop();i&&(this._freeNodes.push(i),i.remove(),e=!0)}for(;t<this._items.length;t++){let i=this._items[t],n=this._freeNodes.length>0?this._freeNodes.pop():document.createElement("div");n&&(this._renderItem(i,n),this._domNode.appendChild(n),this._nodes.push(n),e=!0)}e&&this.layout(void 0)}_renderItem(t,e){ai(e),e.className="";try{t.render(e)}catch(n){e.innerText="<<RENDER ERROR>>",console.error(n)}e.tabIndex=-1,e.setAttribute("role","listitem"),e.classList.add("monaco-breadcrumb-item");let i=J(de.asCSSSelector(this._separatorIcon));e.appendChild(i)}_onClick(t){if(this._enabled)for(let e=t.target;e;e=e.parentElement){let i=this._nodes.indexOf(e);if(i>=0){this._focus(i,t),this._select(i,t);break}}}};function ICe(r,t){let e={...t};for(let i in r){let n=r[i];e[i]=n!==void 0?Se(n):void 0}return e}var z8t={keybindingLabelBackground:Se(loe),keybindingLabelForeground:Se(doe),keybindingLabelBorder:Se(coe),keybindingLabelBottomBorder:Se(uoe),keybindingLabelShadow:Se(Hp)};var dF={buttonForeground:Se(rk),buttonSeparator:Se(jne),buttonBackground:Se(Of),buttonHoverBackground:Se(Xne),buttonSecondaryForeground:Se(Qne),buttonSecondaryBackground:Se(E0),buttonSecondaryHoverBackground:Se(Zne),buttonBorder:Se(Yne)};var Wae={progressBarBackground:Se(dne)};var yCe={inputActiveOptionBorder:Se(C8),inputActiveOptionForeground:Se(E8),inputActiveOptionBackground:Se(w8)},K8t={activeForeground:Se(MC),activeBackground:Se(Jne),activeBorder:Se(eoe),inactiveForeground:Se(toe),inactiveBackground:Se(ioe),inactiveBorder:Se(noe),inactiveHoverBackground:Se(ooe)};var G8t={checkboxBackground:Se(roe),checkboxBorder:Se(aoe),checkboxForeground:Se(soe)};var q8t={dialogBackground:Se(xr),dialogForeground:Se(Wp),dialogShadow:Se(Hp),dialogBorder:Se(Oe),errorIconForeground:Se(Pne),warningIconForeground:Se(Mne),infoIconForeground:Se(Ane),textLinkForeground:Se(wI)};var Zm={inputBackground:Se(y8),inputForeground:Se(S8),inputBorder:Se(Nf),inputValidationInfoBorder:Se(Wne),inputValidationInfoBackground:Se(Bne),inputValidationInfoForeground:Se(Vne),inputValidationWarningBorder:Se(zne),inputValidationWarningBackground:Se(Hne),inputValidationWarningForeground:Se(Une),inputValidationErrorBorder:Se(qne),inputValidationErrorBackground:Se(Kne),inputValidationErrorForeground:Se(Gne)};var Hae={listFilterWidgetBackground:Se(Eoe),listFilterWidgetOutline:Se(xoe),listFilterWidgetNoMatchesOutline:Se(Toe),listFilterWidgetShadow:Se(_oe),inputBoxStyles:Zm,toggleStyles:yCe},cF={badgeBackground:Se(gc),badgeForeground:Se(Rf),badgeBorder:Se(Oe)};var uF={breadcrumbsBackground:Se(kne),breadcrumbsForeground:Se(Dne),breadcrumbsHoverForeground:Se(g8),breadcrumbsFocusForeground:Se(g8),breadcrumbsFocusAndSelectionForeground:Se(Lne)};var Nw={listBackground:void 0,listInactiveFocusForeground:void 0,listFocusBackground:Se(poe),listFocusForeground:Se(hoe),listFocusOutline:Se(moe),listActiveSelectionBackground:Se(Ss),listActiveSelectionForeground:Se(Nl),listActiveSelectionIconForeground:Se(x0),listFocusAndSelectionOutline:Se(goe),listFocusAndSelectionBackground:Se(Ss),listFocusAndSelectionForeground:Se(Nl),listInactiveSelectionBackground:Se(foe),listInactiveSelectionIconForeground:Se(voe),listInactiveSelectionForeground:Se(boe),listInactiveFocusBackground:Se(Ioe),listInactiveFocusOutline:Se(yoe),listHoverBackground:Se(x8),listHoverForeground:Se(T8),listDropOverBackground:Se(Soe),listDropBetweenBackground:Se(Coe),listSelectionOutline:Se(fi),listHoverOutline:Se(fi),treeIndentGuidesStroke:Se(OC),treeInactiveIndentGuidesStroke:Se(koe),treeStickyScrollBackground:void 0,treeStickyScrollBorder:void 0,treeStickyScrollShadow:Se(Pf),tableColumnsBorder:Se(Loe),tableOddRowsBackgroundColor:Se(Roe)};function qI(r){return ICe(r,Nw)}var Jm={selectBackground:Se(Ff),selectListBackground:Se($ne),selectForeground:Se(ok),decoratorRightForeground:Se(Woe),selectBorder:Se(Bf),focusBorder:Se(na),listFocusBackground:Se(D0),listInactiveSelectionIconForeground:Se(_0),listFocusForeground:Se(T0),listFocusOutline:ek(fi,j.transparent.toString()),listHoverBackground:Se(x8),listHoverForeground:Se(T8),listHoverOutline:Se(fi),selectListBorder:Se(nk),listBackground:void 0,listActiveSelectionBackground:void 0,listActiveSelectionForeground:void 0,listActiveSelectionIconForeground:void 0,listFocusAndSelectionBackground:void 0,listDropOverBackground:void 0,listDropBetweenBackground:void 0,listInactiveSelectionBackground:void 0,listInactiveSelectionForeground:void 0,listInactiveFocusBackground:void 0,listInactiveFocusOutline:void 0,listSelectionOutline:void 0,listFocusAndSelectionForeground:void 0,listFocusAndSelectionOutline:void 0,listInactiveFocusForeground:void 0,tableColumnsBorder:void 0,tableOddRowsBackgroundColor:void 0,treeIndentGuidesStroke:void 0,treeInactiveIndentGuidesStroke:void 0,treeStickyScrollBackground:void 0,treeStickyScrollBorder:void 0,treeStickyScrollShadow:void 0};var Uae={shadowColor:Se(Hp),borderColor:Se(Poe),foregroundColor:Se(Moe),backgroundColor:Se(Aoe),selectionForegroundColor:Se(Ooe),selectionBackgroundColor:Se(Noe),selectionBorderColor:Se(Foe),separatorColor:Se(Boe),scrollbarShadow:Se(Pf),scrollbarSliderBackground:Se(b0),scrollbarSliderHoverBackground:Se(v0),scrollbarSliderActiveBackground:Se(I0)};function sa(r,t,e,i){let n,o,s;if(Array.isArray(r))s=r,n=t,o=e;else{let d=t;s=r.getActions(d),n=e,o=i}let a=eu.getInstance(),l=a.keyStatus.altKey||(St||ci)&&a.keyStatus.shiftKey;zae(s,n,l,o?d=>d===o:d=>d==="navigation")}function Vo(r,t,e,i,n,o){let s,a,l,d,c;if(Array.isArray(r))c=r,s=t,a=e,l=i,d=n;else{let h=t;c=r.getActions(h),s=e,a=i,l=n,d=o}zae(c,s,!1,typeof a=="string"?h=>h===a:a,l,d)}function zae(r,t,e,i=s=>s==="navigation",n=()=>!1,o=!1){let s,a;Array.isArray(t)?(s=t,a=t):(s=t.primary,a=t.secondary);let l=new Set;for(let[d,c]of r){let p;i(d)?(p=s,p.length>0&&o&&p.push(new Qt)):(p=a,p.length>0&&p.push(new Qt));for(let h of c){e&&(h=h instanceof wn&&h.alt?h.alt:h);let m=p.push(h);h instanceof vo&&l.add({group:d,action:h,index:m-1})}}for(let{group:d,action:c,index:p}of l){let h=i(d)?s:a,m=c.actions;n(c,d,h.length)&&h.splice(p,1,...m)}}var Gl=class extends Kl{constructor(e,i,n,o,s,a,l,d){super(void 0,e,{icon:!!(e.class||e.item.icon),label:!e.class&&!e.item.icon,draggable:i?.draggable,keybinding:i?.keybinding,hoverDelegate:i?.hoverDelegate});this._options=i;this._keybindingService=n;this._notificationService=o;this._contextKeyService=s;this._themeService=a;this._contextMenuService=l;this._accessibilityService=d;this._altKey=eu.getInstance()}_wantsAltCommand=!1;_itemClassDispose=this._register(new yt);_altKey;get _menuItemAction(){return this._action}get _commandAction(){return this._wantsAltCommand&&this._menuItemAction.alt||this._menuItemAction}async onClick(e){e.preventDefault(),e.stopPropagation();try{await this.actionRunner.run(this._commandAction,this._context)}catch(i){this._notificationService.error(i)}}render(e){if(super.render(e),e.classList.add("menu-entry"),this.options.icon&&this._updateItemClass(this._menuItemAction.item),this._menuItemAction.alt){let i=!1,n=()=>{let o=!!this._menuItemAction.alt?.enabled&&(!this._accessibilityService.isMotionReduced()||i)&&(this._altKey.keyStatus.altKey||this._altKey.keyStatus.shiftKey&&i);o!==this._wantsAltCommand&&(this._wantsAltCommand=o,this.updateLabel(),this.updateTooltip(),this.updateClass())};this._register(this._altKey.event(n)),this._register(F(e,"mouseleave",o=>{i=!1,n()})),this._register(F(e,"mouseenter",o=>{i=!0,n()})),n()}}updateLabel(){this.options.label&&this.label&&(this.label.textContent=this._commandAction.label)}getTooltip(){let e=this._keybindingService.lookupKeybinding(this._commandAction.id,this._contextKeyService),i=e&&e.getLabel(),n=this._commandAction.tooltip||this._commandAction.label,o=i?u("titleAndKb","{0} ({1})",n,i):n;if(!this._wantsAltCommand&&this._menuItemAction.alt?.enabled){let s=this._menuItemAction.alt.tooltip||this._menuItemAction.alt.label,a=this._keybindingService.lookupKeybinding(this._menuItemAction.alt.id,this._contextKeyService),l=a&&a.getLabel(),d=l?u("titleAndKb","{0} ({1})",s,l):s;o=u("titleAndKbAndAlt",`{0}
[{1}] {2}`,o,j1.modifierLabels[Ys].altKey,d)}return o}updateClass(){this.options.icon&&(this._commandAction!==this._menuItemAction?this._menuItemAction.alt&&this._updateItemClass(this._menuItemAction.alt.item):this._updateItemClass(this._menuItemAction.item))}_updateItemClass(e){this._itemClassDispose.value=void 0;let{element:i,label:n}=this;if(!i||!n)return;let o=this._commandAction.checked&&IO(e.toggled)&&e.toggled.icon?e.toggled.icon:e.icon;if(o)if(de.isThemeIcon(o)){let s=de.asClassNameArray(o);n.classList.add(...s),this._itemClassDispose.value=le(()=>{n.classList.remove(...s)})}else n.style.backgroundImage=k8(this._themeService.getColorTheme().type)?Dp(o.dark):Dp(o.light),n.classList.add("icon"),this._itemClassDispose.value=In(le(()=>{n.style.backgroundImage="",n.classList.remove("icon")}),this._themeService.onDidColorThemeChange(()=>{this.updateClass()}))}};Gl=E([b(2,Be),b(3,mi),b(4,re),b(5,Fe),b(6,vt),b(7,Un)],Gl);var pF=class r extends Gl{render(t){this.options.label=!0,this.options.icon=!1,super.render(t),t.classList.add("text-only"),t.classList.toggle("use-comma",this._options?.useComma??!1)}updateLabel(){let t=this._keybindingService.lookupKeybinding(this._action.id,this._contextKeyService);if(!t)return super.updateLabel();if(this.label){let e=r._symbolPrintEnter(t);this._options?.conversational?this.label.textContent=u({key:"content2",comment:['A label with keybindg like "ESC to dismiss"']},"{1} to {0}",this._action.label,e):this.label.textContent=u({key:"content",comment:["A label","A keybinding"]},"{0} ({1})",this._action.label,e)}}static _symbolPrintEnter(t){return t.getLabel()?.replace(/\benter\b/gi,"\u23CE").replace(/\bEscape\b/gi,"Esc")}},eg=class extends Tu{constructor(e,i,n,o,s){let a={...i,menuAsChild:i?.menuAsChild??!1,classNames:i?.classNames??(de.isThemeIcon(e.item.icon)?de.asClassName(e.item.icon):void 0),keybindingProvider:i?.keybindingProvider??(l=>n.lookupKeybinding(l.id))};super(e,{getActions:()=>e.actions},o,a);this._keybindingService=n;this._contextMenuService=o;this._themeService=s}render(e){super.render(e),un(this.element),e.classList.add("menu-entry");let i=this._action,{icon:n}=i.item;if(n&&!de.isThemeIcon(n)){this.element.classList.add("icon");let o=()=>{this.element&&(this.element.style.backgroundImage=k8(this._themeService.getColorTheme().type)?Dp(n.dark):Dp(n.light))};o(),this._register(this._themeService.onDidColorThemeChange(()=>{o()}))}}};eg=E([b(2,Be),b(3,vt),b(4,Fe)],eg);var rL=class extends Yn{constructor(e,i,n,o,s,a,l,d){super(null,e);this._keybindingService=n;this._notificationService=o;this._contextMenuService=s;this._menuService=a;this._instaService=l;this._storageService=d;this._options=i,this._storageKey=`${e.item.submenu.id}_lastActionId`;let c,p=i?.persistLastActionId?d.get(this._storageKey,1):void 0;p&&(c=e.actions.find(m=>p===m.id)),c||(c=e.actions[0]),this._defaultAction=this._instaService.createInstance(Gl,c,{keybinding:this._getDefaultActionKeybindingLabel(c)});let h={keybindingProvider:m=>this._keybindingService.lookupKeybinding(m.id),...i,menuAsChild:i?.menuAsChild??!0,classNames:i?.classNames??["codicon","codicon-chevron-down"],actionRunner:i?.actionRunner??new jo};this._dropdown=new Tu(e,e.actions,this._contextMenuService,h),this._register(this._dropdown.actionRunner.onDidRun(m=>{m.action instanceof wn&&this.update(m.action)}))}_options;_defaultAction;_dropdown;_container=null;_storageKey;get onDidChangeDropdownVisibility(){return this._dropdown.onDidChangeVisibility}update(e){this._options?.persistLastActionId&&this._storageService.store(this._storageKey,e.id,1,1),this._defaultAction.dispose(),this._defaultAction=this._instaService.createInstance(Gl,e,{keybinding:this._getDefaultActionKeybindingLabel(e)}),this._defaultAction.actionRunner=new class extends jo{async runAction(i,n){await i.run(void 0)}},this._container&&this._defaultAction.render(eI(this._container,J(".action-container")))}_getDefaultActionKeybindingLabel(e){let i;if(this._options?.renderKeybindingWithDefaultActionLabel){let n=this._keybindingService.lookupKeybinding(e.id);n&&(i=`(${n.getLabel()})`)}return i}setActionContext(e){super.setActionContext(e),this._defaultAction.setActionContext(e),this._dropdown.setActionContext(e)}render(e){this._container=e,super.render(this._container),this._container.classList.add("monaco-dropdown-with-default");let i=J(".action-container");this._defaultAction.render(U(this._container,i)),this._register(F(i,Q.KEY_DOWN,o=>{let s=new ut(o);s.equals(17)&&(this._defaultAction.element.tabIndex=-1,this._dropdown.focus(),s.stopPropagation())}));let n=J(".dropdown-action-container");this._dropdown.render(U(this._container,n)),this._register(F(n,Q.KEY_DOWN,o=>{let s=new ut(o);s.equals(15)&&(this._defaultAction.element.tabIndex=0,this._dropdown.setFocusable(!1),this._defaultAction.element?.focus(),s.stopPropagation())}))}focus(e){e?this._dropdown.focus():(this._defaultAction.element.tabIndex=0,this._defaultAction.element.focus())}blur(){this._defaultAction.element.tabIndex=-1,this._dropdown.blur(),this._container.blur()}setFocusable(e){e?this._defaultAction.element.tabIndex=0:(this._defaultAction.element.tabIndex=-1,this._dropdown.setFocusable(!1))}dispose(){this._defaultAction.dispose(),this._dropdown.dispose(),super.dispose()}};rL=E([b(2,Be),b(3,mi),b(4,vt),b(5,jt),b(6,ne),b(7,nt)],rL);var sL=class extends Cw{constructor(t,e){super(null,t,t.actions.map(i=>({text:i.id===Qt.ID?"\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500":i.label,isDisabled:!i.enabled})),0,e,Jm,{ariaLabel:t.tooltip,optionsAsChildren:!0}),this.select(Math.max(0,t.actions.findIndex(i=>i.checked)))}render(t){super.render(t),t.style.borderColor=Se(Bf)}runAction(t,e){let i=this.action.actions[e];i&&this.actionRunner.run(i)}};sL=E([b(1,so)],sL);function aa(r,t,e){return t instanceof wn?r.createInstance(Gl,t,e):t instanceof to?t.item.isSelection?r.createInstance(sL,t):t.item.rememberDefaultAction?r.createInstance(rL,t,{...e,persistLastActionId:!0}):r.createInstance(eg,t,e):void 0}var l9=class extends R{constructor(e,i,n,o){super();this.options=i;this.menuService=n;this.contextKeyService=o;this.menu=this._register(n.createMenu(e,o)),this._register(this.menu.onDidChange(()=>this.updateActions())),this.updateActions()}menu;_primaryActions=[];get primaryActions(){return this._primaryActions}_secondaryActions=[];get secondaryActions(){return this._secondaryActions}_onDidChange=this._register(new x);onDidChange=this._onDidChange.event;disposables=this._register(new B);updateActions(){this.disposables.clear(),this._primaryActions=[],this._secondaryActions=[],Vo(this.menu,this.options,{primary:this._primaryActions,secondary:this._secondaryActions}),this.disposables.add(this.updateSubmenus([...this._primaryActions,...this._secondaryActions],{})),this._onDidChange.fire()}updateSubmenus(e,i){let n=new B;for(let o of e)if(o instanceof to&&!i[o.item.submenu.id]){let s=i[o.item.submenu.id]=n.add(this.menuService.createMenu(o.item.submenu,this.contextKeyService));n.add(s.onDidChange(()=>this.updateActions())),n.add(this.updateSubmenus(o.actions,i))}return n}},nb=class extends R{constructor(e,i,n,o,s){super();this.menuId=e;this.contextMenuId=i;this.options=n;this.contextKeyService=o;this.menuService=s;this.menuActions=this._register(new l9(e,this.options,s,o)),this._register(this.menuActions.onDidChange(()=>this._onDidChange.fire()))}menuActions;_onDidChange=this._register(new x);onDidChange=this._onDidChange.event;getPrimaryActions(){return this.menuActions.primaryActions}getSecondaryActions(){return this.menuActions.secondaryActions}getContextMenuActions(){let e=[];if(this.contextMenuId){let i=this.menuService.getMenuActions(this.contextMenuId,this.contextKeyService,this.options);Vo(i,{primary:[],secondary:e})}return e}};nb=E([b(3,re),b(4,jt)],nb);var _u;(n=>{function r(o){return typeof o?.showDirectoryPicker=="function"}n.supported=r;function t(o){let s=o;return s?typeof s.kind=="string"&&typeof s.queryPermission=="function"&&typeof s.requestPermission=="function":!1}n.isFileSystemHandle=t;function e(o){return o.kind==="file"}n.isFileSystemFileHandle=e;function i(o){return o.kind==="directory"}n.isFileSystemDirectoryHandle=i})(_u||={});var hF=class{constructor(t,e,i){this.indexedDB=t;this.store=e;this.logService=i}onDidChangeCapabilities=X.None;onDidChangeFile=X.None;extUri=ci?Ti:L4;_capabilities;get capabilities(){return this._capabilities||(this._capabilities=18,ci&&(this._capabilities|=1024)),this._capabilities}async stat(t){try{let e=await this.getHandle(t);if(!e)throw this.createFileSystemProviderError(t,"No such file or directory, stat","EntryNotFound");if(_u.isFileSystemFileHandle(e)){let i=await e.getFile();return{type:1,mtime:i.lastModified,ctime:0,size:i.size}}return{type:2,mtime:0,ctime:0,size:0}}catch(e){throw this.toFileSystemProviderError(e)}}async readdir(t){try{let e=await this.getDirectoryHandle(t);if(!e)throw this.createFileSystemProviderError(t,"No such file or directory, readdir","EntryNotFound");let i=[];for await(let[n,o]of e)i.push([n,_u.isFileSystemFileHandle(o)?1:2]);return i}catch(e){throw this.toFileSystemProviderError(e)}}readFileStream(t,e,i){let n=mC(o=>Jt.concat(o.map(s=>Jt.wrap(s))).buffer,{highWaterMark:10});return(async()=>{try{let o=await this.getFileHandle(t);if(!o)throw this.createFileSystemProviderError(t,"No such file or directory, readFile","EntryNotFound");let s=await o.getFile();if(typeof e.length=="number"||typeof e.position=="number"){let a=new Uint8Array(await s.arrayBuffer());typeof e?.position=="number"&&(a=a.slice(e.position)),typeof e?.length=="number"&&(a=a.slice(0,e.length)),n.end(a)}else{let a=s.stream().getReader(),l=await a.read();for(;!l.done&&!(i.isCancellationRequested||(await n.write(l.value),i.isCancellationRequested));)l=await a.read();n.end(void 0)}}catch(o){n.error(this.toFileSystemProviderError(o)),n.end()}})(),n}async readFile(t){try{let e=await this.getFileHandle(t);if(!e)throw this.createFileSystemProviderError(t,"No such file or directory, readFile","EntryNotFound");let i=await e.getFile();return new Uint8Array(await i.arrayBuffer())}catch(e){throw this.toFileSystemProviderError(e)}}async writeFile(t,e,i){try{let n=await this.getFileHandle(t);if(!i.create||!i.overwrite){if(n){if(!i.overwrite)throw this.createFileSystemProviderError(t,"File already exists, writeFile","EntryExists")}else if(!i.create)throw this.createFileSystemProviderError(t,"No such file, writeFile","EntryNotFound")}if(!n){let s=await this.getDirectoryHandle(this.extUri.dirname(t));if(!s)throw this.createFileSystemProviderError(t,"No such parent directory, writeFile","EntryNotFound");if(n=await s.getFileHandle(this.extUri.basename(t),{create:!0}),!n)throw this.createFileSystemProviderError(t,"Unable to create file , writeFile","Unknown")}let o=await n.createWritable();await o.write(e),await o.close()}catch(n){throw this.toFileSystemProviderError(n)}}async mkdir(t){try{let e=await this.getDirectoryHandle(this.extUri.dirname(t));if(!e)throw this.createFileSystemProviderError(t,"No such parent directory, mkdir","EntryNotFound");await e.getDirectoryHandle(this.extUri.basename(t),{create:!0})}catch(e){throw this.toFileSystemProviderError(e)}}async delete(t,e){try{let i=await this.getDirectoryHandle(this.extUri.dirname(t));if(!i)throw this.createFileSystemProviderError(t,"No such parent directory, delete","EntryNotFound");return i.removeEntry(this.extUri.basename(t),{recursive:e.recursive})}catch(i){throw this.toFileSystemProviderError(i)}}async rename(t,e,i){try{if(this.extUri.isEqual(t,e))return;let n=await this.getFileHandle(t);if(n){let o=await n.getFile(),s=new Uint8Array(await o.arrayBuffer());await this.writeFile(e,s,{create:!0,overwrite:i.overwrite,unlock:!1,atomic:!1}),await this.delete(t,{recursive:!1,useTrash:!1,atomic:!1})}else throw this.createFileSystemProviderError(t,u("fileSystemRenameError","Rename is only supported for files."),"Unavailable")}catch(n){throw this.toFileSystemProviderError(n)}}watch(t,e){return R.None}_files=new Map;_directories=new Map;registerFileHandle(t){return this.registerHandle(t,this._files)}registerDirectoryHandle(t){return this.registerHandle(t,this._directories)}get directories(){return this._directories.values()}async registerHandle(t,e){let i=`/${t.name}`;if(e.has(i)&&!await e.get(i)?.isSameEntry(t)){let n=hm(t.name),o=Eo(t.name,n),s=1;do i=`/${o}-${s++}${n}`;while(e.has(i)&&!await e.get(i)?.isSameEntry(t))}e.set(i,t);try{await this.indexedDB?.runInTransaction(this.store,"readwrite",n=>n.put(t,i))}catch(n){this.logService.error(n)}return Z.from({scheme:Ie.file,path:i})}async getHandle(t){let e=await this.doGetHandle(t);if(!e){let i=await this.getDirectoryHandle(this.extUri.dirname(t));if(i){let n=Ti.basename(t);try{e=await i.getFileHandle(n)}catch{try{e=await i.getDirectoryHandle(n)}catch{}}}}return e}async getFileHandle(t){let e=await this.doGetHandle(t);if(e instanceof FileSystemFileHandle)return e;let i=await this.getDirectoryHandle(this.extUri.dirname(t));try{return await i?.getFileHandle(Ti.basename(t))}catch{return}}async getDirectoryHandle(t){let e=await this.doGetHandle(t);if(e instanceof FileSystemDirectoryHandle)return e;let i=this.extUri.dirname(t);if(this.extUri.isEqual(i,t))return;let n=await this.getDirectoryHandle(i);try{return await n?.getDirectoryHandle(Ti.basename(t))}catch{return}}async doGetHandle(t){if(this.extUri.dirname(t).path!=="/")return;let e=t.path.replace(/\/$/,""),i=this._files.get(e)??this._directories.get(e);if(i)return i;let n=await this.indexedDB?.runInTransaction(this.store,"readonly",o=>o.get(e));if(_u.isFileSystemHandle(n)){let o=await n.queryPermission()==="granted";try{o||(o=await n.requestPermission()==="granted")}catch(s){this.logService.error(s)}if(o)return _u.isFileSystemFileHandle(n)?this._files.set(e,n):_u.isFileSystemDirectoryHandle(n)&&this._directories.set(e,n),n}throw this.createFileSystemProviderError(t,"No file system handle registered","Unavailable")}toFileSystemProviderError(t){if(t instanceof HC)return t;let e="Unknown";return t.name==="NotAllowedError"&&(t=new Error(u("fileSystemNotAllowedError","Insufficient permissions. Please retry and allow the operation.")),e="Unavailable"),rl(t,e)}createFileSystemProviderError(t,e,i){return rl(new Error(`${e} (${ds(t.path)})`),i)}};var mF={EDITORS:"CodeEditors",FILES:"CodeFiles"};function wCe(r){let t=[];if(r.dataTransfer&&r.dataTransfer.types.length>0){let n=r.dataTransfer.getData(mF.EDITORS);if(n)try{t.push(...pw(n))}catch{}else try{let a=r.dataTransfer.getData(_a.RESOURCES);t.push(...c9(a))}catch{}if(r.dataTransfer?.files)for(let a=0;a<r.dataTransfer.files.length;a++){let l=r.dataTransfer.files[a];if(l&&l.path)try{t.push({resource:Z.file(l.path),isExternal:!0,allowWorkspaceOpen:!0})}catch{}}let o=r.dataTransfer.getData(mF.FILES);if(o)try{let a=JSON.parse(o);for(let l of a)t.push({resource:Z.file(l),isExternal:!0,allowWorkspaceOpen:!0})}catch{}let s=Pe.as(gF.DragAndDropContribution).getAll();for(let a of s){let l=r.dataTransfer.getData(a.dataFormatKey);if(l)try{t.push(...a.getEditorInputs(l))}catch{}}}let e=[],i=new Fn;for(let n of t)n.resource?i.has(n.resource)||(e.push(n),i.set(n.resource,!0)):e.push(n);return e}async function Kae(r,t){let e=wCe(t);if(t.dataTransfer&&si&&_Ce(t,_a.FILES)&&t.dataTransfer.items){let o=await r.get(ne).invokeFunction(s=>ECe(s,t));for(let s of o)e.push({resource:s.resource,contents:s.contents?.toString(),isExternal:!0,allowWorkspaceOpen:s.isDirectory})}return e}function c9(r){let t=[];if(r){let e=JSON.parse(r);for(let i of e)if(i.indexOf(":")>0){let{selection:n,uri:o}=O1(Z.parse(i));t.push({resource:o,options:{selection:n}})}}return t}async function ECe(r,t){if(_u.supported(Ke)){let i=t.dataTransfer?.items;if(i)return xCe(r,i)}let e=t.dataTransfer?.files;return e?TCe(r,e):[]}async function xCe(r,t){let e=r.get(Ei).getProvider(Ie.file);if(!(e instanceof hF))return[];let i=[];for(let n=0;n<t.length;n++){let o=t[n];if(o){let s=new Kr;i.push(s),(async()=>{try{let a=await o.getAsFileSystemHandle();if(!a){s.complete(void 0);return}_u.isFileSystemFileHandle(a)?s.complete({resource:await e.registerFileHandle(a),isDirectory:!1}):_u.isFileSystemDirectoryHandle(a)?s.complete({resource:await e.registerDirectoryHandle(a),isDirectory:!0}):s.complete(void 0)}catch{s.complete(void 0)}})()}}return cn(await Promise.all(i.map(n=>n.p)))}async function TCe(r,t){let e=r.get(Io),i=[];for(let n=0;n<t.length;n++){let o=t.item(n);if(o){if(o.size>100*vc.MB){e.warn(u("fileTooLarge","File is too large to open as untitled editor. Please upload it first into the file explorer and then try again."));continue}let s=new Kr;i.push(s);let a=new FileReader;a.onerror=()=>s.complete(void 0),a.onabort=()=>s.complete(void 0),a.onload=async l=>{let d=o.name,c=l.target?.result??void 0;if(typeof d!="string"||typeof c>"u"){s.complete(void 0);return}s.complete({resource:Z.from({scheme:Ie.untitled,path:d}),contents:typeof c=="string"?Jt.fromString(c):Jt.wrap(new Uint8Array(c))})},a.readAsArrayBuffer(o)}}return cn(await Promise.all(i.map(n=>n.p)))}function _Ce(r,...t){if(!r.dataTransfer)return!1;let e=r.dataTransfer.types,i=[];for(let n=0;n<e.length;n++)i.push(e[n].toLowerCase());for(let n of t)if(i.indexOf(n.toLowerCase())>=0)return!0;return!1}var d9=class{_contributions=new Map;register(t){if(this._contributions.has(t.dataFormatKey))throw new Error(`A drag and drop contributiont with key '${t.dataFormatKey}' was already registered.`);this._contributions.set(t.dataFormatKey,t)}getAll(){return this._contributions.values()}},gF={DragAndDropContribution:"workbench.contributions.dragAndDrop"};Pe.add(gF.DragAndDropContribution,new d9);var ob=class r{static INSTANCE=new r;data;proto;constructor(){}static getInstance(){return r.INSTANCE}hasData(t){return t&&t===this.proto}clearData(t){this.hasData(t)&&(this.proto=void 0,this.data=void 0)}getData(t){if(this.hasData(t))return this.data}setData(t,e){e&&(this.data=t,this.proto=e)}};function Gae(r,t,e){let i,n,o,s,a;if(t){for(s=t.offset,a=s+t.length,o=s;o>0&&!aL(r,o-1);)o--;let w=a;for(;w<r.length&&!aL(r,w);)w++;n=r.substring(o,w),i=DCe(n,e)}else n=r,i=0,o=0,s=0,a=r.length;let l=kCe(e,r),d=!1,c=0,p;e.insertSpaces?p=u9(" ",e.tabSize||4):p="	";let h=G3(n,!1),m=!1;function f(){return l+u9(p,i+c)}function g(){let w=h.scan();for(d=!1;w===15||w===14;)d=d||w===14,w=h.scan();return m=w===16||h.getTokenError()!==0,w}let v=[];function I(w,C,S){!m&&C<a&&S>s&&r.substring(C,S)!==w&&v.push({offset:C,length:S-C,content:w})}let y=g();if(y!==17){let w=h.getTokenOffset()+o,C=u9(p,i);I(C,o,w)}for(;y!==17;){let w=h.getTokenOffset()+h.getTokenLength()+o,C=g(),S="";for(;!d&&(C===12||C===13);){let k=h.getTokenOffset()+o;I(" ",w,k),w=h.getTokenOffset()+h.getTokenLength()+o,S=C===12?f():"",C=g()}if(C===2)y!==1&&(c--,S=f());else if(C===4)y!==3&&(c--,S=f());else{switch(y){case 3:case 1:c++,S=f();break;case 5:case 12:S=f();break;case 13:d?S=f():S=" ";break;case 6:S=" ";break;case 10:if(C===6){S="";break}case 7:case 8:case 9:case 11:case 2:case 4:C===12||C===13?S=" ":C!==5&&C!==17&&(m=!0);break;case 16:m=!0;break}d&&(C===12||C===13)&&(S=f())}let D=h.getTokenOffset()+o;I(S,w,D),y=C}return v}function qae(r,t){let e=JSON.stringify(r,void 0,t.insertSpaces?t.tabSize||4:"	");return t.eol!==void 0?e.replace(/\r\n|\r|\n/g,t.eol):e}function u9(r,t){let e="";for(let i=0;i<t;i++)e+=r;return e}function DCe(r,t){let e=0,i=0,n=t.tabSize||4;for(;e<r.length;){let o=r.charAt(e);if(o===" ")i++;else if(o==="	")i+=n;else break;e++}return Math.floor(i/n)}function kCe(r,t){for(let e=0;e<t.length;e++){let i=t.charAt(e);if(i==="\r")return e+1<t.length&&t.charAt(e+1)===`
`?`\r
`:"\r";if(i===`
`)return`
`}return r&&r.eol||`
`}function aL(r,t){return`\r
`.indexOf(r.charAt(t))!==-1}function fF(r,t,e,i,n){let o=t.slice(),a=Wse(r,[]),l,d;for(;o.length>0&&(d=o.pop(),l=q3(a,o),l===void 0&&e!==void 0);)typeof d=="string"?e={[d]:e}:e=[e];if(l)if(l.type==="object"&&typeof d=="string"&&Array.isArray(l.children)){let c=q3(l,[d]);if(c!==void 0)if(e===void 0){if(!c.parent)throw new Error("Malformed AST");let p=l.children.indexOf(c.parent),h,m=c.parent.offset+c.parent.length;if(p>0){let f=l.children[p-1];h=f.offset+f.length}else h=l.offset+1,l.children.length>1&&(m=l.children[1].offset);return Fw(r,{offset:h,length:m-h,content:""},i)}else return Fw(r,{offset:c.offset,length:c.length,content:JSON.stringify(e)},i);else{if(e===void 0)return[];let p=`${JSON.stringify(d)}: ${JSON.stringify(e)}`,h=n?n(l.children.map(f=>f.children[0].value)):l.children.length,m;if(h>0){let f=l.children[h-1];m={offset:f.offset+f.length,length:0,content:","+p}}else l.children.length===0?m={offset:l.offset+1,length:0,content:p}:m={offset:l.offset+1,length:0,content:p+","};return Fw(r,m,i)}}else if(l.type==="array"&&typeof d=="number"&&Array.isArray(l.children))if(e!==void 0){let c=`${JSON.stringify(e)}`,p;if(l.children.length===0||d===0)p={offset:l.offset+1,length:0,content:l.children.length===0?c:c+","};else{let h=d===-1||d>l.children.length?l.children.length:d,m=l.children[h-1];p={offset:m.offset+m.length,length:0,content:","+c}}return Fw(r,p,i)}else{let c=d,p=l.children[c],h;if(l.children.length===1)h={offset:l.offset+1,length:l.length-2,content:""};else if(l.children.length-1===c){let m=l.children[c-1],f=m.offset+m.length,g=l.offset+l.length;h={offset:f,length:g-2-f,content:""}}else h={offset:p.offset,length:l.children[c+1].offset-p.offset,content:""};return Fw(r,h,i)}else throw new Error(`Can not add ${typeof d!="number"?"index":"property"} to parent of type ${l.type}`);else return e===void 0?[]:Fw(r,{offset:a?a.offset:0,length:a?a.length:0,content:JSON.stringify(e)},i)}function Fw(r,t,e){let i=$ae(r,t),n=t.offset,o=t.offset+t.content.length;if(t.length===0||t.content.length===0){for(;n>0&&!aL(i,n-1);)n--;for(;o<i.length&&!aL(i,o);)o++}let s=Gae(i,{offset:n,length:o-n},e);for(let l=s.length-1;l>=0;l--){let d=s[l];i=$ae(i,d),n=Math.min(n,d.offset),o=Math.max(o,d.offset+d.length),o+=d.content.length-d.length}let a=r.length-(i.length-o)-n;return[{offset:n,length:a,content:i.substring(n,o)}]}function $ae(r,t){return r.substring(0,t.offset)+t.content+r.substring(t.offset+t.length)}function p9(r){return r&&r.hasOwnProperty("folderUri")}function jae(r){return r&&r.hasOwnProperty("workspace")}var ql=q("workspacesService");function lL(r){return r.hasOwnProperty("workspace")}function Bw(r){return r.hasOwnProperty("folderUri")}var tg=q("workspaceEditingService");var bF=class extends R{constructor(e){super();this.channelName=e;if("BroadcastChannel"in Ke)try{this.broadcastChannel=new BroadcastChannel(e);let i=n=>{this._onDidReceiveData.fire(n.data)};this.broadcastChannel.addEventListener("message",i),this._register(le(()=>{this.broadcastChannel&&(this.broadcastChannel.removeEventListener("message",i),this.broadcastChannel.close())}))}catch(i){console.warn("Error while creating broadcast channel. Falling back to localStorage.",v_(i))}this.broadcastChannel||(this.channelName=`BroadcastDataChannel.${e}`,this.createBroadcastChannel())}broadcastChannel;_onDidReceiveData=this._register(new x);onDidReceiveData=this._onDidReceiveData.event;createBroadcastChannel(){let e=i=>{i.key===this.channelName&&i.newValue&&this._onDidReceiveData.fire(JSON.parse(i.newValue))};Ke.addEventListener("storage",e),this._register(le(()=>Ke.removeEventListener("storage",e)))}postData(e){this.broadcastChannel?this.broadcastChannel.postMessage(e):(localStorage.removeItem(this.channelName),localStorage.setItem(this.channelName,JSON.stringify(e)))}};var Ad=class{constructor(t){this.identifier=t}},Od=class{constructor(t){this.identifier=t}};async function Xae(r){let t=[],e=Oo.uriList.toLowerCase();if(r.has(e))try{let i=await r.get(e)?.asString(),n=JSON.stringify(ND.parse(i??""));t.push(...c9(n))}catch{}return t}var Vw=class{constructor(t,e,i,n,o,s,a,l){this.options=t;this.fileService=e;this.workspacesService=i;this.editorService=n;this.workspaceEditingService=o;this.hostService=s;this.contextService=a;this.instantiationService=l}async handleDrop(t,e,i,n,o){let s=await this.instantiationService.invokeFunction(d=>Kae(d,t));if(!s.length)return;if(await this.hostService.focus(e),this.options.allowWorkspaceOpen){let d=cn(s.filter(c=>c.allowWorkspaceOpen&&c.resource?.scheme===Ie.file).map(c=>c.resource));if(d.length>0&&await this.handleWorkspaceDrop(d))return}let a=cn(s.filter(d=>d.isExternal&&d.resource?.scheme===Ie.file).map(d=>d.resource));a.length&&this.workspacesService.addRecentlyOpened(a.map(d=>({fileUri:d})));let l=i?.();await this.editorService.openEditors(s.map(d=>({...d,resource:d.resource,options:{...d.options,...o,pinned:!0}})),l,{validateTrust:!0}),n?.(l)}async handleWorkspaceDrop(t){let e=[],i=[];return await Promise.all(t.map(async n=>{if(nC(n)){e.push({workspaceUri:n});return}try{let o=await this.fileService.stat(n);o.isDirectory&&(e.push({folderUri:o.resource}),i.push({uri:o.resource}))}catch{}})),e.length===0?!1:(e.length>i.length||i.length===1?await this.hostService.openWindow(e):eie(this.contextService.getWorkspace())?await this.workspaceEditingService.addFolders(i):await this.workspaceEditingService.createAndEnterWorkspace(i),!0)}};Vw=E([b(1,Ei),b(2,ql),b(3,$e),b(4,tg),b(5,Tn),b(6,kt),b(7,ne)],Vw);function g9(r,t,e,i){if(t.length===0||!e.dataTransfer)return;let n=r.get(Us),o=r.get($e),s=r.get(Ei),a=r.get(hi),l=cn(t.map(m=>Z.isUri(m)?{resource:m}:o1(m)?Z.isUri(m.editor.resource)?{resource:m.editor.resource}:void 0:m)),d=l.filter(({resource:m})=>s.hasProvider(m));if(!i?.disableStandardTransfer){let m=St?`\r
`:`
`;e.dataTransfer.setData(_a.TEXT,d.map(({resource:g})=>a.getUriLabel(g,{noPrefix:!0})).join(m));let f=d.find(({isDirectory:g})=>!g);if(f){let g=Ao.uriToFileUri(f.resource);g.scheme===Ie.file&&e.dataTransfer.setData(_a.DOWNLOAD_URL,[Oo.binary,Ji(f.resource),g.toString()].join(":"))}}let c=d.filter(({isDirectory:m})=>!m);c.length&&e.dataTransfer.setData(_a.RESOURCES,JSON.stringify(c.map(({resource:m})=>m.toString())));let p=Pe.as(gF.DragAndDropContribution).getAll();for(let m of p)m.setData(l,e);let h=[];for(let m of t){let f;if(o1(m)){let g=m.editor.toUntyped({preserveViewState:m.groupId});g&&(f={...g,resource:ro.getCanonicalUri(g)})}else if(Z.isUri(m)){let{selection:g,uri:v}=O1(m);f={resource:v,options:g?{selection:g}:void 0}}else m.isDirectory||(f={resource:m.resource});if(f){{let g=f.resource;if(g){let v=n.files.get(g);v&&(typeof f.languageId!="string"&&(f.languageId=v.getLanguageId()),typeof f.encoding!="string"&&(f.encoding=v.getEncoding()),typeof f.contents!="string"&&v.isDirty()&&!v.textEditorModel.isTooLargeForHeapOperation()&&(f.contents=v.textEditorModel.getValue())),f.options?.viewState||(f.options={...f.options,viewState:(()=>{for(let I of o.visibleEditorPanes)if(zi(I.input.resource,g)){let y=I.getViewState();if(y)return y}})()})}}h.push(f)}}if(h.length){e.dataTransfer.setData(mF.EDITORS,s1(h));let m=[];for(let f of h)f.resource?m.push(f.resource):kd(f)?f.modified.resource&&m.push(f.modified.resource):Xp(f)?f.primary.resource&&m.push(f.primary.resource):Yp(f)&&m.push(f.result.resource);i?.disableStandardTransfer||e.dataTransfer.setData(Oo.uriList,ND.create(m.slice(0,1))),e.dataTransfer.setData(_a.INTERNAL_URI_LIST,ND.create(m))}}var h9=class{constructor(t,e){this.type=t;this.id=e}update(t){}getData(){return{type:this.type,id:this.id}}},$I=class{constructor(t){this.compositeId=t}get id(){return this.compositeId}},jI=class{constructor(t){this.viewId=t}get id(){return this.viewId}},rb=class r extends R{static instance;static get INSTANCE(){return r.instance||(r.instance=new r,rc(r.instance)),r.instance}transferData=ob.getInstance();onDragStart=this._register(new x);onDragEnd=this._register(new x);constructor(){super(),this._register(this.onDragEnd.event(t=>{let e=t.dragAndDropData.getData().id,i=t.dragAndDropData.getData().type;this.readDragData(i)?.getData().id===e&&this.transferData.clearData(i==="view"?jI.prototype:$I.prototype)}))}readDragData(t){if(this.transferData.hasData(t==="view"?jI.prototype:$I.prototype)){let e=this.transferData.getData(t==="view"?jI.prototype:$I.prototype);if(e&&e[0])return new h9(t,e[0].id)}}writeDragData(t,e){this.transferData.setData([e==="view"?new jI(t):new $I(t)],e==="view"?jI.prototype:$I.prototype)}registerTarget(t,e){let i=new B;return i.add(new wl(t,{onDragEnter:n=>{if(n.preventDefault(),e.onDragEnter){let o=this.readDragData("composite")||this.readDragData("view");o&&e.onDragEnter({eventData:n,dragAndDropData:o})}},onDragLeave:n=>{let o=this.readDragData("composite")||this.readDragData("view");e.onDragLeave&&o&&e.onDragLeave({eventData:n,dragAndDropData:o})},onDrop:n=>{if(e.onDrop){let o=this.readDragData("composite")||this.readDragData("view");if(!o)return;e.onDrop({eventData:n,dragAndDropData:o}),this.onDragEnd.fire({eventData:n,dragAndDropData:o})}},onDragOver:n=>{if(n.preventDefault(),e.onDragOver){let o=this.readDragData("composite")||this.readDragData("view");if(!o)return;e.onDragOver({eventData:n,dragAndDropData:o})}}})),e.onDragStart&&this.onDragStart.event(n=>{e.onDragStart(n)},this,i),e.onDragEnd&&this.onDragEnd.event(n=>{e.onDragEnd(n)},this,i),this._register(i)}registerDraggable(t,e,i){t.draggable=!0;let n=new B;return n.add(new wl(t,{onDragStart:o=>{let{id:s,type:a}=e();this.writeDragData(s,a),o.dataTransfer?.setDragImage(t,0,0),this.onDragStart.fire({eventData:o,dragAndDropData:this.readDragData(a)})},onDragEnd:o=>{let{type:s}=e(),a=this.readDragData(s);a&&this.onDragEnd.fire({eventData:o,dragAndDropData:a})},onDragEnter:o=>{if(i.onDragEnter){let s=this.readDragData("composite")||this.readDragData("view");if(!s)return;s&&i.onDragEnter({eventData:o,dragAndDropData:s})}},onDragLeave:o=>{let s=this.readDragData("composite")||this.readDragData("view");s&&i.onDragLeave?.({eventData:o,dragAndDropData:s})},onDrop:o=>{if(i.onDrop){let s=this.readDragData("composite")||this.readDragData("view");if(!s)return;i.onDrop({eventData:o,dragAndDropData:s}),this.onDragEnd.fire({eventData:o,dragAndDropData:s})}},onDragOver:o=>{if(i.onDragOver){let s=this.readDragData("composite")||this.readDragData("view");if(!s)return;i.onDragOver({eventData:o,dragAndDropData:s})}}})),i.onDragStart&&this.onDragStart.event(o=>{i.onDragStart(o)},this,n),i.onDragEnd&&this.onDragEnd.event(o=>{i.onDragEnd(o)},this,n),this._register(n)}};function dL(r,t,e){r&&(r.dropEffect=e?t:"none")}var vF=class{constructor(t,e){this.toResource=t;this.instantiationService=e}getDragURI(t){let e=this.toResource(t);return e?e.toString():null}getDragLabel(t){let e=cn(t.map(this.toResource));return e.length===1?Ji(e[0]):e.length>1?String(e.length):void 0}onDragStart(t,e){let i=[];for(let n of t.elements){let o=this.toResource(n);o&&i.push(o)}i.length&&this.instantiationService.invokeFunction(n=>g9(n,i,e))}onDragOver(t,e,i,n,o){return!1}drop(t,e,i,n,o){}dispose(){}};vF=E([b(1,ne)],vF);var m9=class r extends R{static CHANNEL_NAME="monaco-workbench-global-dragged-over";broadcaster=this._register(new bF(r.CHANNEL_NAME));constructor(){super(),this.registerListeners()}registerListeners(){this._register(X.runAndSubscribe(oD,({window:t,disposables:e})=>{e.add(F(t,Q.DRAG_OVER,()=>this.markDraggedOver(!1),!0)),e.add(F(t,Q.DRAG_LEAVE,()=>this.clearDraggedOver(!1),!0))},{window:Ke,disposables:this._store})),this._register(this.broadcaster.onDidReceiveData(t=>{t===!0?this.markDraggedOver(!0):this.clearDraggedOver(!0)}))}draggedOver=!1;get isDraggedOver(){return this.draggedOver}markDraggedOver(t){this.draggedOver!==!0&&(this.draggedOver=!0,t||this.broadcaster.postData(!0))}clearDraggedOver(t){this.draggedOver!==!1&&(this.draggedOver=!1,t||this.broadcaster.postData(!1))}},RCe=new m9;function IF(){return RCe.isDraggedOver}var qqt=u("views log","Views"),Yae=ke("default-view-icon",N.window,u("defaultViewIcon","Default view icon.")),xc;(e=>(e.ViewContainersRegistry="workbench.registry.view.containers",e.ViewsRegistry="workbench.registry.view"))(xc||={});function Es(r){switch(r){case 0:return"sidebar";case 1:return"panel";case 2:return"auxiliarybar"}}var f9=class extends R{_onDidRegister=this._register(new x);onDidRegister=this._onDidRegister.event;_onDidDeregister=this._register(new x);onDidDeregister=this._onDidDeregister.event;viewContainers=new Map;defaultViewContainers=[];get all(){return[...this.viewContainers.values()].flat()}registerViewContainer(t,e,i){let n=this.get(t.id);if(n)return n;let o=t;return o.openCommandActionDescriptor=i?.doNotRegisterOpenCommand?void 0:o.openCommandActionDescriptor??{id:o.id},mm(this.viewContainers,e,[]).push(o),i?.isDefault&&this.defaultViewContainers.push(o),this._onDidRegister.fire({viewContainer:o,viewContainerLocation:e}),o}deregisterViewContainer(t){for(let e of this.viewContainers.keys()){let i=this.viewContainers.get(e),n=i?.indexOf(t);if(n!==-1){i?.splice(n,1),i.length===0&&this.viewContainers.delete(e),this._onDidDeregister.fire({viewContainer:t,viewContainerLocation:e});return}}}get(t){return this.all.filter(e=>e.id===t)[0]}getViewContainers(t){return[...this.viewContainers.get(t)||[]]}getViewContainerLocation(t){return[...this.viewContainers.keys()].filter(e=>this.getViewContainers(e).filter(i=>i?.id===t.id).length>0)[0]}getDefaultViewContainer(t){return this.defaultViewContainers.find(e=>this.getViewContainerLocation(e)===t)}};Pe.add(xc.ViewContainersRegistry,new f9);function PCe(r,t){let e=r.group??"9_more",i=t.group??"9_more";return e!==i?e.localeCompare(i):(r.order??5)-(t.order??5)}var b9=class extends R{_onViewsRegistered=this._register(new x);onViewsRegistered=this._onViewsRegistered.event;_onViewsDeregistered=this._register(new x);onViewsDeregistered=this._onViewsDeregistered.event;_onDidChangeContainer=this._register(new x);onDidChangeContainer=this._onDidChangeContainer.event;_onDidChangeViewWelcomeContent=this._register(new x);onDidChangeViewWelcomeContent=this._onDidChangeViewWelcomeContent.event;_viewContainers=[];_views=new Map;_viewWelcomeContents=new Kc;registerViews(t,e){this.registerViews2([{views:t,viewContainer:e}])}registerViews2(t){t.forEach(({views:e,viewContainer:i})=>this.addViews(e,i)),this._onViewsRegistered.fire(t)}deregisterViews(t,e){let i=this.removeViews(t,e);i.length&&this._onViewsDeregistered.fire({views:i,viewContainer:e})}moveViews(t,e){for(let i of this._views.keys())if(i!==e){let n=this.removeViews(t,i);n.length&&(this.addViews(n,e),this._onDidChangeContainer.fire({views:n,from:i,to:e}))}}getViews(t){return this._views.get(t)||[]}getView(t){for(let e of this._viewContainers){let i=(this._views.get(e)||[]).filter(n=>n.id===t)[0];if(i)return i}return null}getViewContainer(t){for(let e of this._viewContainers)if((this._views.get(e)||[]).filter(n=>n.id===t)[0])return e;return null}registerViewWelcomeContent(t,e){return this._viewWelcomeContents.add(t,e),this._onDidChangeViewWelcomeContent.fire(t),le(()=>{this._viewWelcomeContents.delete(t,e),this._onDidChangeViewWelcomeContent.fire(t)})}registerViewWelcomeContent2(t,e){let i=new Map;for(let[n,o]of e)this._viewWelcomeContents.add(t,o),i.set(n,le(()=>{this._viewWelcomeContents.delete(t,o),this._onDidChangeViewWelcomeContent.fire(t)}));return this._onDidChangeViewWelcomeContent.fire(t),i}getViewWelcomeContent(t){let e=[];return this._viewWelcomeContents.forEach(t,i=>e.push(i)),e.sort(PCe)}addViews(t,e){let i=this._views.get(e);i||(i=[],this._views.set(e,i),this._viewContainers.push(e));for(let n of t){if(this.getView(n.id)!==null)throw new Error(u("duplicateId","A view with id '{0}' is already registered",n.id));i.push(n)}}removeViews(t,e){let i=this._views.get(e);if(!i)return[];let n=[],o=[];for(let s of i)t.includes(s)?n.push(s):o.push(s);return n.length&&(o.length?this._views.set(e,o):(this._views.delete(e),this._viewContainers.splice(this._viewContainers.indexOf(e),1))),n}};Pe.add(xc.ViewsRegistry,new b9);var $i=q("viewDescriptorService");var Mi=q("viewsService");var yF=class{constructor(t){this.nodes=t}toString(){return this.nodes.map(t=>typeof t=="string"?t:t.label).join("")}};E([Re],yF.prototype,"toString",1);var MCe=/\[([^\]]+)\]\(((?:https?:\/\/|command:|file:)[^\)\s]+)(?: (["'])(.+?)(\3))?\)/gi;function Qae(r){let t=[],e=0,i;for(;i=MCe.exec(r);){i.index-e>0&&t.push(r.substring(e,i.index));let[,n,o,,s]=i;s?t.push({label:n,href:o,title:s}):t.push({label:n,href:o}),e=i.index+i[0].length}return e<r.length&&t.push(r.substring(e)),new yF(t)}var Nt=q("hoverService"),sh=class extends R{constructor(e,i,n={},o,s){super();this.placement=e;this.instantHover=i;this.overrideOptions=n;this.configurationService=o;this.hoverService=s;this._delay=this.configurationService.getValue("workbench.hover.delay"),this._register(this.configurationService.onDidChangeConfiguration(a=>{a.affectsConfiguration("workbench.hover.delay")&&(this._delay=this.configurationService.getValue("workbench.hover.delay"))}))}lastHoverHideTime=0;timeLimit=200;_delay;get delay(){return this.isInstantlyHovering()?0:this._delay}hoverDisposables=this._register(new B);showHover(e,i){let n=typeof this.overrideOptions=="function"?this.overrideOptions(e,i):this.overrideOptions;this.hoverDisposables.clear();let o=on(e.target)?[e.target]:e.target.targetElements;for(let a of o)this.hoverDisposables.add(Ut(a,"keydown",l=>{l.equals(9)&&this.hoverService.hideHover()}));let s=on(e.content)?void 0:e.content.toString();return this.hoverService.showHover({...e,...n,persistence:{hideOnKeyDown:!0,...n.persistence},id:s,appearance:{...e.appearance,compact:!0,skipFadeInAnimation:this.isInstantlyHovering(),...n.appearance}},i)}isInstantlyHovering(){return this.instantHover&&Date.now()-this.lastHoverHideTime<this.timeLimit}setInstantHoverTimeLimit(e){if(!this.instantHover)throw new Error("Instant hover is not enabled");this.timeLimit=e}onDidHideHover(){this.hoverDisposables.clear(),this.instantHover&&(this.lastHoverHideTime=Date.now())}};sh=E([b(3,se),b(4,Nt)],sh);var Ww=class extends R{constructor(e,i,n={},o,s){super();this._link=i;this._hoverService=o;this.el=U(e,J("a.monaco-link",{tabIndex:i.tabIndex??0,href:i.href},i.label)),this.hoverDelegate=n.hoverDelegate??gt("mouse"),this.setTooltip(i.title),this.el.setAttribute("role","button");let a=this._register(new lt(this.el,"click")),l=this._register(new lt(this.el,"keypress")),d=X.chain(l.event,h=>h.map(m=>new ut(m)).filter(m=>m.keyCode===3)),c=this._register(new lt(this.el,At.Tap)).event;this._register(yi.addTarget(this.el));let p=X.any(a.event,d,c);this._register(p(h=>{this.enabled&&(Ve.stop(h,!0),n?.opener?n.opener(this._link.href):s.open(this._link.href,{allowCommands:!0}))})),this.enabled=!0}el;hover;hoverDelegate;_enabled=!0;get enabled(){return this._enabled}set enabled(e){e?(this.el.setAttribute("aria-disabled","false"),this.el.tabIndex=0,this.el.style.pointerEvents="auto",this.el.style.opacity="1",this.el.style.cursor="pointer",this._enabled=!1):(this.el.setAttribute("aria-disabled","true"),this.el.tabIndex=-1,this.el.style.pointerEvents="none",this.el.style.opacity="0.4",this.el.style.cursor="default",this._enabled=!0),this._enabled=e}set link(e){typeof e.label=="string"?this.el.textContent=e.label:(ai(this.el),this.el.appendChild(e.label)),this.el.href=e.href,typeof e.tabIndex<"u"&&(this.el.tabIndex=e.tabIndex),this.setTooltip(e.title),this._link=e}setTooltip(e){this.hoverDelegate.showNativeHover?this.el.title=e??"":!this.hover&&e?this.hover=this._register(this._hoverService.setupManagedHover(this.hoverDelegate,this.el,e)):this.hover&&this.hover.update(e)}};Ww=E([b(3,Nt),b(4,Yi)],Ww);var Du;(s=>{let r;(h=>(h[h.None=0]="None",h[h.Done=1]="Done",h[h.Infinite=2]="Infinite",h[h.While=3]="While",h[h.Work=4]="Work"))(r=s.Type||={}),s.None={type:0},s.Done={type:1},s.Infinite={type:2};class n{constructor(l,d,c){this.whilePromise=l;this.whileStart=d;this.whileDelay=c}type=3}s.While=n;class o{constructor(l,d){this.total=l;this.worked=d}type=4}s.Work=o})(Du||={});var SF=class extends R{constructor(e,i){super();this.progressBar=e;this.scope=i;this.registerListeners()}progressState=Du.None;registerListeners(){this._register(this.scope.onDidChangeActive(()=>{this.scope.isActive?this.onDidScopeActivate():this.onDidScopeDeactivate()}))}onDidScopeActivate(){if(this.progressState.type!==Du.Done.type)if(this.progressState.type===3){let e;if(this.progressState.whileDelay>0){let i=this.progressState.whileDelay-(Date.now()-this.progressState.whileStart);i>0&&(e=i)}this.doShowWhile(e)}else this.progressState.type===2?this.progressBar.infinite().show():this.progressState.type===4&&(this.progressState.total&&this.progressBar.total(this.progressState.total).show(),this.progressState.worked&&this.progressBar.worked(this.progressState.worked).show())}onDidScopeDeactivate(){this.progressBar.stop().hide()}show(e,i){return typeof e=="boolean"?this.progressState=Du.Infinite:this.progressState=new Du.Work(e,void 0),this.scope.isActive&&(this.progressState.type===2?this.progressBar.infinite().show(i):this.progressState.type===4&&typeof this.progressState.total=="number"&&this.progressBar.total(this.progressState.total).show(i)),{total:n=>{this.progressState=new Du.Work(n,this.progressState.type===4?this.progressState.worked:void 0),this.scope.isActive&&this.progressBar.total(n)},worked:n=>{!this.scope.isActive||this.progressBar.hasTotal()?(this.progressState=new Du.Work(this.progressState.type===4?this.progressState.total:void 0,this.progressState.type===4&&typeof this.progressState.worked=="number"?this.progressState.worked+n:n),this.scope.isActive&&this.progressBar.worked(n)):(this.progressState=Du.Infinite,this.progressBar.infinite().show())},done:()=>{this.progressState=Du.Done,this.scope.isActive&&this.progressBar.stop().hide()}}}async showWhile(e,i){this.progressState.type===3&&(e=Promise.all([e,this.progressState.whilePromise])),this.progressState=new Du.While(e,i||0,Date.now());try{this.doShowWhile(i),await e}catch{}finally{(this.progressState.type!==3||this.progressState.whilePromise===e)&&(this.progressState=Du.None,this.scope.isActive&&this.progressBar.stop().hide())}}doShowWhile(e){this.scope.isActive&&this.progressBar.infinite().show(e)}},CF=class extends R{constructor(e,i){super();this.scopeId=e;this._isActive=i}_onDidChangeActive=this._register(new x);onDidChangeActive=this._onDidChangeActive.event;get isActive(){return this._isActive}onScopeOpened(e){e===this.scopeId&&(this._isActive||(this._isActive=!0,this._onDidChangeActive.fire()))}onScopeClosed(e){e===this.scopeId&&this._isActive&&(this._isActive=!1,this._onDidChangeActive.fire())}};var wF=class extends R{options;actionBar;toggleMenuAction;toggleMenuActionViewItem;submenuActionViewItems=[];hasSecondaryActions=!1;element;_onDidChangeDropdownVisibility=this._register(new B_);onDidChangeDropdownVisibility=this._onDidChangeDropdownVisibility.event;disposables=this._register(new B);constructor(t,e,i={orientation:0}){super(),i.hoverDelegate=i.hoverDelegate??this._register(wu()),this.options=i,this.toggleMenuAction=this._register(new Hw(()=>this.toggleMenuActionViewItem?.show(),i.toggleMenuTitle)),this.element=document.createElement("div"),this.element.className="monaco-toolbar",t.appendChild(this.element),this.actionBar=this._register(new Fi(this.element,{orientation:i.orientation,ariaLabel:i.ariaLabel,actionRunner:i.actionRunner,allowContextMenu:i.allowContextMenu,highlightToggledItems:i.highlightToggledItems,hoverDelegate:i.hoverDelegate,actionViewItemProvider:(n,o)=>{if(n.id===Hw.ID)return this.toggleMenuActionViewItem=new Tu(n,n.menuActions,e,{actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,keybindingProvider:this.options.getKeyBinding,classNames:de.asClassNameArray(i.moreIcon??N.toolBarMore),anchorAlignmentProvider:this.options.anchorAlignmentProvider,menuAsChild:!!this.options.renderDropdownAsChildElement,skipTelemetry:this.options.skipTelemetry,isMenu:!0,hoverDelegate:this.options.hoverDelegate}),this.toggleMenuActionViewItem.setActionContext(this.actionBar.context),this.disposables.add(this._onDidChangeDropdownVisibility.add(this.toggleMenuActionViewItem.onDidChangeVisibility)),this.toggleMenuActionViewItem;if(i.actionViewItemProvider){let s=i.actionViewItemProvider(n,o);if(s)return s}if(n instanceof vo){let s=new Tu(n,n.actions,e,{actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,keybindingProvider:this.options.getKeyBinding,classNames:n.class,anchorAlignmentProvider:this.options.anchorAlignmentProvider,menuAsChild:!!this.options.renderDropdownAsChildElement,skipTelemetry:this.options.skipTelemetry,hoverDelegate:this.options.hoverDelegate});return s.setActionContext(this.actionBar.context),this.submenuActionViewItems.push(s),this.disposables.add(this._onDidChangeDropdownVisibility.add(s.onDidChangeVisibility)),s}}}))}set actionRunner(t){this.actionBar.actionRunner=t}get actionRunner(){return this.actionBar.actionRunner}set context(t){this.actionBar.context=t,this.toggleMenuActionViewItem?.setActionContext(t);for(let e of this.submenuActionViewItems)e.setActionContext(t)}getElement(){return this.element}focus(){this.actionBar.focus()}getItemsWidth(){let t=0;for(let e=0;e<this.actionBar.length();e++)t+=this.actionBar.getWidth(e);return t}getItemAction(t){return this.actionBar.getAction(t)}getItemWidth(t){return this.actionBar.getWidth(t)}getItemsLength(){return this.actionBar.length()}setAriaLabel(t){this.actionBar.setAriaLabel(t)}setActions(t,e){this.clear();let i=t?t.slice(0):[];this.hasSecondaryActions=!!(e&&e.length>0),this.hasSecondaryActions&&e&&(this.toggleMenuAction.menuActions=e.slice(0),i.push(this.toggleMenuAction)),i.forEach(n=>{this.actionBar.push(n,{icon:this.options.icon??!0,label:this.options.label??!1,keybinding:this.getKeybindingLabel(n)})})}isEmpty(){return this.actionBar.isEmpty()}getKeybindingLabel(t){return this.options.getKeyBinding?.(t)?.getLabel()??void 0}clear(){this.submenuActionViewItems=[],this.disposables.clear(),this.actionBar.clear()}dispose(){this.clear(),this.disposables.dispose(),super.dispose()}},Hw=class r extends et{static ID="toolbar.toggle.more";_menuActions;toggleDropdownMenu;constructor(t,e){e=e||u("moreActions","More Actions..."),super(r.ID,e,void 0,!0),this._menuActions=[],this.toggleDropdownMenu=t}async run(){this.toggleDropdownMenu()}get menuActions(){return this._menuActions}set menuActions(t){this._menuActions=t}};var EF=class{constructor(t,e,i){this._commandService=t;this._keybindingService=e;this._hiddenStates=new ah(i)}_hiddenStates;createMenu(t,e,i){return new Uw(t,this._hiddenStates,{emitEventsForSubmenuChanges:!1,eventDebounceDelay:50,...i},this._commandService,this._keybindingService,e)}getMenuActions(t,e,i){let n=new Uw(t,this._hiddenStates,{emitEventsForSubmenuChanges:!1,eventDebounceDelay:50,...i},this._commandService,this._keybindingService,e),o=n.getActions(i);return n.dispose(),o}getMenuContexts(t){let e=new xF(t,!1);return new Set([...e.structureContextKeys,...e.preconditionContextKeys,...e.toggledContextKeys])}resetHiddenStates(t){this._hiddenStates.reset(t)}};EF=E([b(0,ct),b(1,Be),b(2,nt)],EF);var ah=class{constructor(t){this._storageService=t;try{let e=t.get(ah._key,0,"{}");this._data=JSON.parse(e)}catch{this._data=Object.create(null)}this._disposables.add(t.onDidChangeValue(0,ah._key,this._disposables)(()=>{if(!this._ignoreChangeEvent)try{let e=t.get(ah._key,0,"{}");this._data=JSON.parse(e)}catch(e){console.log("FAILED to read storage after UPDATE",e)}this._onDidChange.fire()}))}static _key="menu.hiddenCommands";_disposables=new B;_onDidChange=new x;onDidChange=this._onDidChange.event;_ignoreChangeEvent=!1;_data;_hiddenByDefaultCache=new Map;dispose(){this._onDidChange.dispose(),this._disposables.dispose()}_isHiddenByDefault(t,e){return this._hiddenByDefaultCache.get(`${t.id}/${e}`)??!1}setDefaultState(t,e,i){this._hiddenByDefaultCache.set(`${t.id}/${e}`,i)}isHidden(t,e){let i=this._isHiddenByDefault(t,e),n=this._data[t.id]?.includes(e)??!1;return i?!n:n}updateHidden(t,e,i){this._isHiddenByDefault(t,e)&&(i=!i);let o=this._data[t.id];if(i)o?o.indexOf(e)<0&&o.push(e):this._data[t.id]=[e];else if(o){let s=o.indexOf(e);s>=0&&IJ(o,s),o.length===0&&delete this._data[t.id]}this._persist()}reset(t){if(t===void 0)this._data=Object.create(null),this._persist();else{for(let{id:e}of t)this._data[e]&&delete this._data[e];this._persist()}}_persist(){try{this._ignoreChangeEvent=!0;let t=JSON.stringify(this._data);this._storageService.store(ah._key,t,0,0)}finally{this._ignoreChangeEvent=!1}}};ah=E([b(0,nt)],ah);var xF=class r{constructor(t,e){this._id=t;this._collectContextKeysForSubmenus=e;this.refresh()}_menuGroups=[];_allMenuIds=new Set;_structureContextKeys=new Set;_preconditionContextKeys=new Set;_toggledContextKeys=new Set;get allMenuIds(){return this._allMenuIds}get structureContextKeys(){return this._structureContextKeys}get preconditionContextKeys(){return this._preconditionContextKeys}get toggledContextKeys(){return this._toggledContextKeys}refresh(){this._menuGroups.length=0,this._allMenuIds.clear(),this._structureContextKeys.clear(),this._preconditionContextKeys.clear(),this._toggledContextKeys.clear();let t=this._sort(Ue.getMenuItems(this._id)),e;for(let i of t){let n=i.group||"";(!e||e[0]!==n)&&(e=[n,[]],this._menuGroups.push(e)),e[1].push(i),this._collectContextKeysAndSubmenuIds(i)}this._allMenuIds.add(this._id)}_sort(t){return t}_collectContextKeysAndSubmenuIds(t){if(r._fillInKbExprKeys(t.when,this._structureContextKeys),yf(t)){if(t.command.precondition&&r._fillInKbExprKeys(t.command.precondition,this._preconditionContextKeys),t.command.toggled){let e=t.command.toggled.condition||t.command.toggled;r._fillInKbExprKeys(e,this._toggledContextKeys)}}else this._collectContextKeysForSubmenus&&(Ue.getMenuItems(t.submenu).forEach(this._collectContextKeysAndSubmenuIds,this),this._allMenuIds.add(t.submenu))}static _fillInKbExprKeys(t,e){if(t)for(let i of t.keys())e.add(i)}},ig=class extends xF{constructor(e,i,n,o,s,a){super(e,n);this._hiddenStates=i;this._commandService=o;this._keybindingService=s;this._contextKeyService=a;this.refresh()}createActionGroups(e){let i=[];for(let n of this._menuGroups){let[o,s]=n,a;for(let l of s)if(this._contextKeyService.contextMatchesRules(l.when)){let d=yf(l);d&&this._hiddenStates.setDefaultState(this._id,l.command.id,!!l.isHiddenByDefault);let c=ACe(this._id,d?l.command:l,this._hiddenStates);if(d){let p=v9(this._commandService,this._keybindingService,l.command.id,l.when);(a??=[]).push(new wn(l.command,l.alt,e,c,p,this._contextKeyService,this._commandService))}else{let p=new ig(l.submenu,this._hiddenStates,this._collectContextKeysForSubmenus,this._commandService,this._keybindingService,this._contextKeyService).createActionGroups(e),h=Qt.join(...p.map(m=>m[1]));h.length>0&&(a??=[]).push(new to(l,c,h))}}a&&a.length>0&&i.push([o,a])}return i}_sort(e){return e.sort(ig._compareMenuItems)}static _compareMenuItems(e,i){let n=e.group,o=i.group;if(n!==o){if(n){if(!o)return-1}else return 1;if(n==="navigation")return-1;if(o==="navigation")return 1;let l=n.localeCompare(o);if(l!==0)return l}let s=e.order||0,a=i.order||0;return s<a?-1:s>a?1:ig._compareTitles(yf(e)?e.command.title:e.title,yf(i)?i.command.title:i.title)}static _compareTitles(e,i){let n=typeof e=="string"?e:e.original,o=typeof i=="string"?i:i.original;return n.localeCompare(o)}};ig=E([b(3,ct),b(4,Be),b(5,re)],ig);var Uw=class{_menuInfo;_disposables=new B;_onDidChange;onDidChange;constructor(t,e,i,n,o,s){this._menuInfo=new ig(t,e,i.emitEventsForSubmenuChanges,n,o,s);let a=new Ye(()=>{this._menuInfo.refresh(),this._onDidChange.fire({menu:this,isStructuralChange:!0,isEnablementChange:!0,isToggleChange:!0})},i.eventDebounceDelay);this._disposables.add(a),this._disposables.add(Ue.onDidChangeMenu(p=>{for(let h of this._menuInfo.allMenuIds)if(p.has(h)){a.schedule();break}}));let l=this._disposables.add(new B),d=p=>{let h=!1,m=!1,f=!1;for(let g of p)if(h=h||g.isStructuralChange,m=m||g.isEnablementChange,f=f||g.isToggleChange,h&&m&&f)break;return{menu:this,isStructuralChange:h,isEnablementChange:m,isToggleChange:f}},c=()=>{l.add(s.onDidChangeContext(p=>{let h=p.affectsSome(this._menuInfo.structureContextKeys),m=p.affectsSome(this._menuInfo.preconditionContextKeys),f=p.affectsSome(this._menuInfo.toggledContextKeys);(h||m||f)&&this._onDidChange.fire({menu:this,isStructuralChange:h,isEnablementChange:m,isToggleChange:f})})),l.add(e.onDidChange(p=>{this._onDidChange.fire({menu:this,isStructuralChange:!0,isEnablementChange:!1,isToggleChange:!1})}))};this._onDidChange=new dA({onWillAddFirstListener:c,onDidRemoveLastListener:l.clear.bind(l),delay:i.eventDebounceDelay,merge:d}),this.onDidChange=this._onDidChange.event}getActions(t){return this._menuInfo.createActionGroups(t)}dispose(){this._disposables.dispose(),this._onDidChange.dispose()}};Uw=E([b(3,ct),b(4,Be),b(5,re)],Uw);function ACe(r,t,e){let i=cie(t)?t.submenu.id:t.id,n=typeof t.title=="string"?t.title:t.title.value,o=fn({id:`hide/${r.id}/${i}`,label:u("hide.label","Hide '{0}'",n),run(){e.updateHidden(r,i,!0)}}),s=fn({id:`toggle/${r.id}/${i}`,label:n,get checked(){return!e.isHidden(r,i)},run(){e.updateHidden(r,i,!!this.checked)}});return{hide:o,toggle:s,get isHidden(){return!s.checked}}}function v9(r,t,e,i=void 0,n=!0){return fn({id:`configureKeybinding/${e}`,label:u("configure keybinding","Configure Keybinding"),enabled:n,run(){let s=!!!t.lookupKeybinding(e)&&i?i.serialize():void 0;r.executeCommand("workbench.action.openGlobalKeybindings",`@command:${e}`+(s?` +when:${s}`:""))}})}var ul=class extends wF{constructor(e,i,n,o,s,a,l,d){super(e,s,{getKeyBinding:p=>a.lookupKeybinding(p.id)??void 0,...i,allowContextMenu:!0,skipTelemetry:typeof i?.telemetrySource=="string"});this._options=i;this._menuService=n;this._contextKeyService=o;this._contextMenuService=s;this._keybindingService=a;this._commandService=l;let c=i?.telemetrySource;c&&this._store.add(this.actionBar.onDidRun(p=>d.publicLog2("workbenchActionExecuted",{id:p.action.id,from:c})))}_sessionDisposables=this._store.add(new B);setActions(e,i=[],n){this._sessionDisposables.clear();let o=e.slice(),s=i.slice(),a=[],l=0,d=[],c=!1;if(this._options?.hiddenItemStrategy!==-1)for(let p=0;p<o.length;p++){let h=o[p];!(h instanceof wn)&&!(h instanceof to)||h.hideActions&&(a.push(h.hideActions.toggle),h.hideActions.toggle.checked&&l++,h.hideActions.isHidden&&(c=!0,o[p]=void 0,this._options?.hiddenItemStrategy!==0&&(d[p]=h)))}if(this._options?.overflowBehavior!==void 0){let p=DJ(new Set(this._options.overflowBehavior.exempted),mt.map(o,f=>f?.id)),h=this._options.overflowBehavior.maxItems-p.size,m=0;for(let f=0;f<o.length;f++){let g=o[f];g&&(m++,!p.has(g.id)&&m>=h&&(o[f]=void 0,d[f]=g))}}G5(o),G5(d),super.setActions(o,Qt.join(d,s)),(a.length>0||o.length>0)&&this._sessionDisposables.add(F(this.getElement(),"contextmenu",p=>{let h=new _i(ue(this.getElement()),p),m=this.getItemAction(h.target);if(!m)return;h.preventDefault(),h.stopPropagation();let f=[];if(m instanceof wn&&m.menuKeybinding)f.push(m.menuKeybinding);else if(!(m instanceof to||m instanceof Hw)){let v=!!this._keybindingService.lookupKeybinding(m.id);f.push(v9(this._commandService,this._keybindingService,m.id,void 0,v))}if(a.length>0){let v=!1;if(l===1&&this._options?.hiddenItemStrategy===0){v=!0;for(let I=0;I<a.length;I++)if(a[I].checked){a[I]=fn({id:m.id,label:m.label,checked:!0,enabled:!1,run(){}});break}}if(!v&&(m instanceof wn||m instanceof to)){if(!m.hideActions)return;f.push(m.hideActions.hide)}else f.push(fn({id:"label",label:u("hide","Hide"),enabled:!1,run(){}}))}let g=Qt.join(f,a);this._options?.resetMenu&&!n&&(n=[this._options.resetMenu]),c&&n&&(g.push(new Qt),g.push(fn({id:"resetThisMenu",label:u("resetThisMenu","Reset Menu"),run:()=>this._menuService.resetHiddenStates(n)}))),g.length!==0&&this._contextMenuService.showContextMenu({getAnchor:()=>h,getActions:()=>g,menuId:this._options?.contextMenu,menuActionOptions:{renderShortTitle:!0,...this._options?.menuOptions},skipTelemetry:typeof this._options?.telemetrySource=="string",contextKeyService:this._contextKeyService})}))}};ul=E([b(2,jt),b(3,re),b(4,vt),b(5,Be),b(6,ct),b(7,Tt)],ul);var lh=class extends ul{_onDidChangeMenuItems=this._store.add(new x);onDidChangeMenuItems=this._onDidChangeMenuItems.event;constructor(t,e,i,n,o,s,a,l,d){super(t,{resetMenu:e,...i},n,o,s,a,l,d);let c=this._store.add(n.createMenu(e,o,{emitEventsForSubmenuChanges:!0})),p=()=>{let h=[],m=[];Vo(c,i?.menuOptions,{primary:h,secondary:m},i?.toolbarOptions?.primaryGroup,i?.toolbarOptions?.shouldInlineSubmenu,i?.toolbarOptions?.useSeparatorsInPrimaryActions),t.classList.toggle("has-no-actions",h.length===0&&m.length===0),super.setActions(h,m)};this._store.add(c.onDidChange(()=>{p(),this._onDidChangeMenuItems.fire(this)})),p()}setActions(){throw new _t("This toolbar is populated from a menu.")}};lh=E([b(3,jt),b(4,re),b(5,vt),b(6,Be),b(7,ct),b(8,Tt)],lh);var OCe=u("defaultLabel","input"),NCe=u("label.preserveCaseToggle","Preserve Case"),I9=class extends xu{constructor(t){super({icon:N.preserveCase,title:NCe+t.appendTitle,isChecked:t.isChecked,hoverDelegate:t.hoverDelegate??gt("element"),inputActiveOptionBorder:t.inputActiveOptionBorder,inputActiveOptionForeground:t.inputActiveOptionForeground,inputActiveOptionBackground:t.inputActiveOptionBackground})}},TF=class extends ko{constructor(e,i,n,o){super();this._showOptionButtons=n;this.contextViewProvider=i,this.placeholder=o.placeholder||"",this.validation=o.validation,this.label=o.label||OCe;let s=o.appendPreserveCaseLabel||"",a=o.history||[],l=!!o.flexibleHeight,d=!!o.flexibleWidth,c=o.flexibleMaxHeight;this.domNode=document.createElement("div"),this.domNode.classList.add("monaco-findInput"),this.inputBox=this._register(new ib(this.domNode,this.contextViewProvider,{ariaLabel:this.label||"",placeholder:this.placeholder||"",validationOptions:{validation:this.validation},history:a,showHistoryHint:o.showHistoryHint,flexibleHeight:l,flexibleWidth:d,flexibleMaxHeight:c,inputBoxStyles:o.inputBoxStyles})),this.preserveCase=this._register(new I9({appendTitle:s,isChecked:!1,...o.toggleStyles})),this._register(this.preserveCase.onChange(m=>{this._onDidOptionChange.fire(m),!m&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this._register(this.preserveCase.onKeyDown(m=>{this._onPreserveCaseKeyDown.fire(m)})),this._showOptionButtons?this.cachedOptionsWidth=this.preserveCase.width():this.cachedOptionsWidth=0;let p=[this.preserveCase.domNode];this.onkeydown(this.domNode,m=>{if(m.equals(15)||m.equals(17)||m.equals(9)){let f=p.indexOf(this.domNode.ownerDocument.activeElement);if(f>=0){let g=-1;m.equals(17)?g=(f+1)%p.length:m.equals(15)&&(f===0?g=p.length-1:g=f-1),m.equals(9)?(p[f].blur(),this.inputBox.focus()):g>=0&&p[g].focus(),Ve.stop(m,!0)}}});let h=document.createElement("div");h.className="controls",h.style.display=this._showOptionButtons?"block":"none",h.appendChild(this.preserveCase.domNode),this.domNode.appendChild(h),e?.appendChild(this.domNode),this.onkeydown(this.inputBox.inputElement,m=>this._onKeyDown.fire(m)),this.onkeyup(this.inputBox.inputElement,m=>this._onKeyUp.fire(m)),this.oninput(this.inputBox.inputElement,m=>this._onInput.fire()),this.onmousedown(this.inputBox.inputElement,m=>this._onMouseDown.fire(m))}static OPTION_CHANGE="optionChange";contextViewProvider;placeholder;validation;label;fixFocusOnOptionClickEnabled=!0;preserveCase;cachedOptionsWidth=0;domNode;inputBox;_onDidOptionChange=this._register(new x);onDidOptionChange=this._onDidOptionChange.event;_onKeyDown=this._register(new x);onKeyDown=this._onKeyDown.event;_onMouseDown=this._register(new x);onMouseDown=this._onMouseDown.event;_onInput=this._register(new x);onInput=this._onInput.event;_onKeyUp=this._register(new x);onKeyUp=this._onKeyUp.event;_onPreserveCaseKeyDown=this._register(new x);onPreserveCaseKeyDown=this._onPreserveCaseKeyDown.event;enable(){this.domNode.classList.remove("disabled"),this.inputBox.enable(),this.preserveCase.enable()}disable(){this.domNode.classList.add("disabled"),this.inputBox.disable(),this.preserveCase.disable()}setFocusInputOnOptionClick(e){this.fixFocusOnOptionClickEnabled=e}setEnabled(e){e?this.enable():this.disable()}clear(){this.clearValidation(),this.setValue(""),this.focus()}getValue(){return this.inputBox.value}setValue(e){this.inputBox.value!==e&&(this.inputBox.value=e)}onSearchSubmit(){this.inputBox.addToHistory()}applyStyles(){}select(){this.inputBox.select()}focus(){this.inputBox.focus()}getPreserveCase(){return this.preserveCase.checked}setPreserveCase(e){this.preserveCase.checked=e}focusOnPreserve(){this.preserveCase.focus()}_lastHighlightFindOptions=0;highlightFindOptions(){this.domNode.classList.remove("highlight-"+this._lastHighlightFindOptions),this._lastHighlightFindOptions=1-this._lastHighlightFindOptions,this.domNode.classList.add("highlight-"+this._lastHighlightFindOptions)}validate(){this.inputBox?.validate()}showMessage(e){this.inputBox?.showMessage(e)}clearMessage(){this.inputBox?.hideMessage()}clearValidation(){this.inputBox?.hideMessage()}set width(e){this.inputBox.paddingRight=this.cachedOptionsWidth,this.domNode.style.width=e+"px"}dispose(){super.dispose()}};var LF=new A("suggestWidgetVisible",!1,u("suggestWidgetVisible","Whether suggestion are visible")),y9="historyNavigationWidgetFocus",Zae="historyNavigationForwardsEnabled",Jae="historyNavigationBackwardsEnabled",cL,_F=[];function uL(r,t){if(_F.includes(t))throw new Error("Cannot register the same widget multiple times");_F.push(t);let e=new B,i=new A(y9,!1).bindTo(r),n=new A(Zae,!0).bindTo(r),o=new A(Jae,!0).bindTo(r),s=()=>{i.set(!0),cL=t},a=()=>{i.set(!1),cL===t&&(cL=void 0)};return fs(t.element)&&s(),e.add(t.onDidFocus(()=>s())),e.add(t.onDidBlur(()=>a())),e.add(le(()=>{_F.splice(_F.indexOf(t),1),a()})),{historyNavigationForwardsEnablement:n,historyNavigationBackwardsEnablement:o,dispose(){e.dispose()}}}var zw=class extends ib{constructor(t,e,i,n){super(t,e,i);let o=this._register(n.createScoped(this.element));this._register(uL(o,this))}};zw=E([b(3,re)],zw);var DF=class extends Lw{constructor(t,e,i,n){super(t,e,i);let o=this._register(n.createScoped(this.inputBox.element));this._register(uL(o,this.inputBox))}};DF=E([b(3,re)],DF);var kF=class extends TF{constructor(t,e,i,n,o=!1){super(t,e,o,i);let s=this._register(n.createScoped(this.inputBox.element));this._register(uL(s,this.inputBox))}};kF=E([b(3,re)],kF);wt.registerCommandAndKeybindingRule({id:"history.showPrevious",weight:200,when:P.and(P.has(y9),P.equals(Jae,!0),P.not("isComposing"),LF.isEqualTo(!1)),primary:16,secondary:[528],handler:r=>{cL?.showPreviousValue()}});wt.registerCommandAndKeybindingRule({id:"history.showNext",weight:200,when:P.and(P.has(y9),P.equals(Zae,!0),P.not("isComposing"),LF.isEqualTo(!1)),primary:18,secondary:[530],handler:r=>{cL?.showNextValue()}});function ele(r){return r.lookupKeybinding("history.showPrevious")?.getElectronAccelerator()==="Up"&&r.lookupKeybinding("history.showNext")?.getElectronAccelerator()==="Down"}var ile=new V("menu.view.filter"),nle=new V("submenu.view.filter");Ue.appendMenuItem(ile,{submenu:nle,title:u("more filters","More Filters..."),group:"navigation",icon:N.filter});var S9=class extends eg{_checked=!1;set checked(t){this._checked!==t&&(this._checked=t,this.updateChecked())}updateChecked(){this.element&&this.element.classList.toggle("checked",this._checked)}render(t){super.render(t),this.updateChecked()}},Kw=class extends ko{constructor(e,i,n,o,s){super();this.options=e;this.instantiationService=i;this.contextViewService=n;this.keybindingService=s;this.delayedFilterUpdate=new yd(400),this._register(le(()=>this.delayedFilterUpdate.cancel())),e.focusContextKey&&(this.focusContextKey=new A(e.focusContextKey,!1).bindTo(o)),this.element=J(".viewpane-filter"),[this.filterInputBox,this.focusTracker]=this.createInput(this.element),this._register(this.filterInputBox),this._register(this.focusTracker);let a=U(this.element,J(".viewpane-filter-controls"));this.filterBadge=this.createBadge(a),this.toolbar=this._register(this.createToolBar(a)),this.adjustInputBox()}element;delayedFilterUpdate;filterInputBox;filterBadge;toolbar;focusContextKey;_onDidChangeFilterText=this._register(new x);onDidChangeFilterText=this._onDidChangeFilterText.event;moreFiltersActionViewItem;isMoreFiltersChecked=!1;lastWidth;focusTracker;get onDidFocus(){return this.focusTracker.onDidFocus}get onDidBlur(){return this.focusTracker.onDidBlur}hasFocus(){return this.filterInputBox.hasFocus()}focus(){this.filterInputBox.focus()}blur(){this.filterInputBox.blur()}updateBadge(e){this.filterBadge.classList.toggle("hidden",!e),this.filterBadge.textContent=e||"",this.adjustInputBox()}setFilterText(e){this.filterInputBox.value=e}getFilterText(){return this.filterInputBox.value}getHistory(){return this.filterInputBox.getHistory()}layout(e){this.element.parentElement?.classList.toggle("grow",e>700),this.element.classList.toggle("small",e<400),this.adjustInputBox(),this.lastWidth=e}relayout(){this.lastWidth&&this.layout(this.lastWidth)}checkMoreFilters(e){this.isMoreFiltersChecked=e,this.moreFiltersActionViewItem&&(this.moreFiltersActionViewItem.checked=e)}createInput(e){let i=this._register(this.instantiationService.createInstance(zw,e,this.contextViewService,{placeholder:this.options.placeholder,ariaLabel:this.options.ariaLabel,history:this.options.history||[],showHistoryHint:()=>ele(this.keybindingService),inputBoxStyles:Zm}));this.options.text&&(i.value=this.options.text),this._register(i.onDidChange(o=>this.delayedFilterUpdate.trigger(()=>this.onDidInputChange(i)))),this._register(Ut(i.inputElement,Q.KEY_DOWN,o=>this.onInputKeyDown(o,i))),this._register(Ut(e,Q.KEY_DOWN,this.handleKeyboardEvent)),this._register(Ut(e,Q.KEY_UP,this.handleKeyboardEvent)),this._register(Ut(i.inputElement,Q.CLICK,o=>{o.stopPropagation(),o.preventDefault()}));let n=this._register(Er(i.inputElement));return this.focusContextKey&&(this._register(n.onDidFocus(()=>this.focusContextKey.set(!0))),this._register(n.onDidBlur(()=>this.focusContextKey.set(!1))),this._register(le(()=>this.focusContextKey.reset()))),[i,n]}createBadge(e){let i=U(e,J(".viewpane-filter-badge.hidden"));return i.style.backgroundColor=Se(gc),i.style.color=Se(Rf),i.style.border=`1px solid ${Se(Oe)}`,i}createToolBar(e){return this.instantiationService.createInstance(lh,e,ile,{hiddenItemStrategy:-1,actionViewItemProvider:(i,n)=>{if(i instanceof to&&i.item.submenu.id===nle.id)return this.moreFiltersActionViewItem=this.instantiationService.createInstance(S9,i,n),this.moreFiltersActionViewItem.checked=this.isMoreFiltersChecked,this.moreFiltersActionViewItem}})}onDidInputChange(e){e.addToHistory(),this._onDidChangeFilterText.fire(e.value)}adjustInputBox(){this.filterInputBox.inputElement.style.paddingRight=this.element.classList.contains("small")||this.filterBadge.classList.contains("hidden")?"25px":"150px"}handleKeyboardEvent(e){(e.equals(10)||e.equals(15)||e.equals(17)||e.equals(14)||e.equals(13))&&e.stopPropagation()}onInputKeyDown(e,i){let n=!1;e.equals(2)&&!this.toolbar.isEmpty()&&(this.toolbar.focus(),n=!0),n&&(e.stopPropagation(),e.preventDefault())}};Kw=E([b(1,ne),b(2,so),b(3,re),b(4,Be)],Kw);function FF(r){switch(r.type){case"light":return j.fromHex("#F3F3F3");case"hcLight":return j.fromHex("#FFFFFF");case"hcDark":return j.fromHex("#000000");default:return j.fromHex("#252526")}}var BF=T("tab.activeBackground",Hs,u("tabActiveBackground","Active tab background color in an active group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),sle=T("tab.unfocusedActiveBackground",BF,u("tabUnfocusedActiveBackground","Active tab background color in an unfocused group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),C9=T("tab.inactiveBackground",{dark:"#2D2D2D",light:"#ECECEC",hcDark:null,hcLight:null},u("tabInactiveBackground","Inactive tab background color in an active group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),ale=T("tab.unfocusedInactiveBackground",C9,u("tabUnfocusedInactiveBackground","Inactive tab background color in an unfocused group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),ng=T("tab.activeForeground",{dark:j.white,light:"#333333",hcDark:j.white,hcLight:"#292929"},u("tabActiveForeground","Active tab foreground color in an active group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),ole=T("tab.inactiveForeground",{dark:Ne(ng,.5),light:Ne(ng,.7),hcDark:j.white,hcLight:"#292929"},u("tabInactiveForeground","Inactive tab foreground color in an active group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),lle=T("tab.unfocusedActiveForeground",{dark:Ne(ng,.5),light:Ne(ng,.7),hcDark:j.white,hcLight:"#292929"},u("tabUnfocusedActiveForeground","Active tab foreground color in an unfocused group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),JYt=T("tab.unfocusedInactiveForeground",{dark:Ne(ole,.5),light:Ne(ole,.5),hcDark:j.white,hcLight:"#292929"},u("tabUnfocusedInactiveForeground","Inactive tab foreground color in an unfocused group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),PF=T("tab.hoverBackground",null,u("tabHoverBackground","Tab background color when hovering. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),dle=T("tab.unfocusedHoverBackground",{dark:Ne(PF,.5),light:Ne(PF,.7),hcDark:null,hcLight:null},u("tabUnfocusedHoverBackground","Tab background color in an unfocused group when hovering. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),MF=T("tab.hoverForeground",null,u("tabHoverForeground","Tab foreground color when hovering. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),cle=T("tab.unfocusedHoverForeground",{dark:Ne(MF,.5),light:Ne(MF,.5),hcDark:null,hcLight:null},u("tabUnfocusedHoverForeground","Tab foreground color in an unfocused group when hovering. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),VF=T("tab.border",{dark:"#252526",light:"#F3F3F3",hcDark:Oe,hcLight:Oe},u("tabBorder","Border to separate tabs from each other. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),ule=T("tab.lastPinnedBorder",{dark:OC,light:OC,hcDark:Oe,hcLight:Oe},u("lastPinnedTabBorder","Border to separate pinned tabs from other tabs. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),Gw=T("tab.activeBorder",null,u("tabActiveBorder","Border on the bottom of an active tab. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),ple=T("tab.unfocusedActiveBorder",{dark:Ne(Gw,.5),light:Ne(Gw,.7),hcDark:null,hcLight:null},u("tabActiveUnfocusedBorder","Border on the bottom of an active tab in an unfocused group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),pL=T("tab.activeBorderTop",{dark:null,light:null,hcDark:null,hcLight:"#B5200D"},u("tabActiveBorderTop","Border to the top of an active tab. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),hle=T("tab.unfocusedActiveBorderTop",{dark:Ne(pL,.5),light:Ne(pL,.7),hcDark:null,hcLight:"#B5200D"},u("tabActiveUnfocusedBorderTop","Border to the top of an active tab in an unfocused group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),mle=T("tab.selectedBorderTop",pL,u("tabSelectedBorderTop","Border to the top of a selected tab. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),eQt=T("tab.selectedBackground",BF,u("tabSelectedBackground","Background of a selected tab. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),tQt=T("tab.selectedForeground",ng,u("tabSelectedForeground","Foreground of a selected tab. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),AF=T("tab.hoverBorder",null,u("tabHoverBorder","Border to highlight tabs when hovering. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),gle=T("tab.unfocusedHoverBorder",{dark:Ne(AF,.5),light:Ne(AF,.7),hcDark:null,hcLight:Oe},u("tabUnfocusedHoverBorder","Border to highlight tabs in an unfocused group when hovering. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),iQt=T("tab.dragAndDropBorder",{dark:ng,light:ng,hcDark:fi,hcLight:fi},u("tabDragAndDropBorder","Border between tabs to indicate that a tab can be inserted between two tabs. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),qw=T("tab.activeModifiedBorder",{dark:"#3399CC",light:"#33AAEE",hcDark:null,hcLight:Oe},u("tabActiveModifiedBorder","Border on the top of modified active tabs in an active group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),OF=T("tab.inactiveModifiedBorder",{dark:Ne(qw,.5),light:Ne(qw,.5),hcDark:j.white,hcLight:Oe},u("tabInactiveModifiedBorder","Border on the top of modified inactive tabs in an active group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),fle=T("tab.unfocusedActiveModifiedBorder",{dark:Ne(qw,.5),light:Ne(qw,.7),hcDark:j.white,hcLight:Oe},u("unfocusedActiveModifiedBorder","Border on the top of modified active tabs in an unfocused group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),ble=T("tab.unfocusedInactiveModifiedBorder",{dark:Ne(OF,.5),light:Ne(OF,.5),hcDark:j.white,hcLight:Oe},u("unfocusedINactiveModifiedBorder","Border on the top of modified inactive tabs in an unfocused group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),nQt=T("editorPane.background",Hs,u("editorPaneBackground","Background color of the editor pane visible on the left and right side of the centered editor layout.")),oQt=T("editorGroup.emptyBackground",null,u("editorGroupEmptyBackground","Background color of an empty editor group. Editor groups are the containers of editors.")),rQt=T("editorGroup.focusedEmptyBorder",{dark:null,light:null,hcDark:na,hcLight:na},u("editorGroupFocusedEmptyBorder","Border color of an empty editor group that is focused. Editor groups are the containers of editors.")),vle=T("editorGroupHeader.tabsBackground",{dark:"#252526",light:"#F3F3F3",hcDark:null,hcLight:null},u("tabsContainerBackground","Background color of the editor group title header when tabs are enabled. Editor groups are the containers of editors.")),Ile=T("editorGroupHeader.tabsBorder",null,u("tabsContainerBorder","Border color of the editor group title header when tabs are enabled. Editor groups are the containers of editors.")),sQt=T("editorGroupHeader.noTabsBackground",Hs,u("editorGroupHeaderBackground",'Background color of the editor group title header when (`"workbench.editor.showTabs": "single"`). Editor groups are the containers of editors.')),aQt=T("editorGroupHeader.border",{dark:null,light:null,hcDark:Oe,hcLight:Oe},u("editorTitleContainerBorder","Border color of the editor group title header. Editor groups are the containers of editors.")),yle=T("editorGroup.border",{dark:"#444444",light:"#E7E7E7",hcDark:Oe,hcLight:Oe},u("editorGroupBorder","Color to separate multiple editor groups from each other. Editor groups are the containers of editors.")),jw=T("editorGroup.dropBackground",{dark:j.fromHex("#53595D").transparent(.5),light:j.fromHex("#2677CB").transparent(.18),hcDark:null,hcLight:j.fromHex("#0F4A85").transparent(.5)},u("editorDragAndDropBackground","Background color when dragging editors around. The color should have transparency so that the editor contents can still shine through.")),lQt=T("editorGroup.dropIntoPromptForeground",Wp,u("editorDropIntoPromptForeground","Foreground color of text shown over editors when dragging files. This text informs the user that they can hold shift to drop into the editor.")),dQt=T("editorGroup.dropIntoPromptBackground",xr,u("editorDropIntoPromptBackground","Background color of text shown over editors when dragging files. This text informs the user that they can hold shift to drop into the editor.")),cQt=T("editorGroup.dropIntoPromptBorder",{dark:null,light:null,hcDark:Oe,hcLight:Oe},u("editorDropIntoPromptBorder","Border color of text shown over editors when dragging files. This text informs the user that they can hold shift to drop into the editor.")),Sle=T("sideBySideEditor.horizontalBorder",yle,u("sideBySideEditor.horizontalBorder","Color to separate two editors from each other when shown side by side in an editor group from top to bottom.")),Cle=T("sideBySideEditor.verticalBorder",yle,u("sideBySideEditor.verticalBorder","Color to separate two editors from each other when shown side by side in an editor group from left to right.")),w9=T("panel.background",Hs,u("panelBackground","Panel background color. Panels are shown below the editor area and contain views like output and integrated terminal.")),E9=T("panel.border",{dark:j.fromHex("#808080").transparent(.35),light:j.fromHex("#808080").transparent(.35),hcDark:Oe,hcLight:Oe},u("panelBorder","Panel border color to separate the panel from the editor. Panels are shown below the editor area and contain views like output and integrated terminal.")),hL=T("panelTitle.activeForeground",{dark:"#E7E7E7",light:"#424242",hcDark:j.white,hcLight:Qo},u("panelActiveTitleForeground","Title color for the active panel. Panels are shown below the editor area and contain views like output and integrated terminal.")),uQt=T("panelTitle.inactiveForeground",{dark:Ne(hL,.6),light:Ne(hL,.75),hcDark:j.white,hcLight:Qo},u("panelInactiveTitleForeground","Title color for the inactive panel. Panels are shown below the editor area and contain views like output and integrated terminal.")),pQt=T("panelTitle.activeBorder",{dark:hL,light:hL,hcDark:Oe,hcLight:"#B5200D"},u("panelActiveTitleBorder","Border color for the active panel title. Panels are shown below the editor area and contain views like output and integrated terminal.")),hQt=T("panelInput.border",{dark:Nf,light:j.fromHex("#ddd"),hcDark:Nf,hcLight:Nf},u("panelInputBorder","Input box border for inputs in the panel.")),mQt=T("panel.dropBorder",hL,u("panelDragAndDropBorder","Drag and drop feedback color for the panel titles. Panels are shown below the editor area and contain views like output and integrated terminal.")),x9=T("panelSection.dropBackground",jw,u("panelSectionDragAndDropBackground","Drag and drop feedback color for the panel sections. The color should have transparency so that the panel sections can still shine through. Panels are shown below the editor area and contain views like output and integrated terminal. Panel sections are views nested within the panels.")),wle=T("panelSectionHeader.background",{dark:j.fromHex("#808080").transparent(.2),light:j.fromHex("#808080").transparent(.2),hcDark:null,hcLight:null},u("panelSectionHeaderBackground","Panel section header background color. Panels are shown below the editor area and contain views like output and integrated terminal. Panel sections are views nested within the panels.")),Ele=T("panelSectionHeader.foreground",null,u("panelSectionHeaderForeground","Panel section header foreground color. Panels are shown below the editor area and contain views like output and integrated terminal. Panel sections are views nested within the panels.")),xle=T("panelSectionHeader.border",Oe,u("panelSectionHeaderBorder","Panel section header border color used when multiple views are stacked vertically in the panel. Panels are shown below the editor area and contain views like output and integrated terminal. Panel sections are views nested within the panels.")),Tle=T("panelSection.border",E9,u("panelSectionBorder","Panel section border color used when multiple views are stacked horizontally in the panel. Panels are shown below the editor area and contain views like output and integrated terminal. Panel sections are views nested within the panels.")),_le=T("panelStickyScroll.background",w9,u("panelStickyScrollBackground","Background color of sticky scroll in the panel.")),Dle=T("panelStickyScroll.border",null,u("panelStickyScrollBorder","Border color of sticky scroll in the panel.")),kle=T("panelStickyScroll.shadow",Pf,u("panelStickyScrollShadow","Shadow color of sticky scroll in the panel.")),FCe=T("outputView.background",null,u("outputViewBackground","Output view background color."));T("outputViewStickyScroll.background",FCe,u("outputViewStickyScrollBackground","Output view sticky scroll background color."));var gQt=T("banner.background",{dark:Ss,light:ia(Ss,.3),hcDark:Ss,hcLight:Ss},u("banner.background","Banner background color. The banner is shown under the title bar of the window.")),fQt=T("banner.foreground",Nl,u("banner.foreground","Banner foreground color. The banner is shown under the title bar of the window.")),bQt=T("banner.iconForeground",Jr,u("banner.iconForeground","Banner icon color. The banner is shown under the title bar of the window.")),$l=T("statusBar.foreground",{dark:"#FFFFFF",light:"#FFFFFF",hcDark:"#FFFFFF",hcLight:Qo},u("statusBarForeground","Status bar foreground color when a workspace or folder is opened. The status bar is shown in the bottom of the window.")),Lle=T("statusBar.noFolderForeground",$l,u("statusBarNoFolderForeground","Status bar foreground color when no folder is opened. The status bar is shown in the bottom of the window.")),Rle=T("statusBar.background",{dark:"#007ACC",light:"#007ACC",hcDark:null,hcLight:null},u("statusBarBackground","Status bar background color when a workspace or folder is opened. The status bar is shown in the bottom of the window.")),Ple=T("statusBar.noFolderBackground",{dark:"#68217A",light:"#68217A",hcDark:null,hcLight:null},u("statusBarNoFolderBackground","Status bar background color when no folder is opened. The status bar is shown in the bottom of the window.")),gL=T("statusBar.border",{dark:null,light:null,hcDark:Oe,hcLight:Oe},u("statusBarBorder","Status bar border color separating to the sidebar and editor. The status bar is shown in the bottom of the window.")),Mle=T("statusBar.focusBorder",{dark:$l,light:$l,hcDark:null,hcLight:$l},u("statusBarFocusBorder","Status bar border color when focused on keyboard navigation. The status bar is shown in the bottom of the window.")),Ale=T("statusBar.noFolderBorder",gL,u("statusBarNoFolderBorder","Status bar border color separating to the sidebar and editor when no folder is opened. The status bar is shown in the bottom of the window.")),vQt=T("statusBarItem.activeBackground",{dark:j.white.transparent(.18),light:j.white.transparent(.18),hcDark:j.white.transparent(.18),hcLight:j.black.transparent(.18)},u("statusBarItemActiveBackground","Status bar item background color when clicking. The status bar is shown in the bottom of the window.")),Ole=T("statusBarItem.focusBorder",{dark:$l,light:$l,hcDark:null,hcLight:fi},u("statusBarItemFocusBorder","Status bar item border color when focused on keyboard navigation. The status bar is shown in the bottom of the window.")),dh=T("statusBarItem.hoverBackground",{dark:j.white.transparent(.12),light:j.white.transparent(.12),hcDark:j.white.transparent(.12),hcLight:j.black.transparent(.12)},u("statusBarItemHoverBackground","Status bar item background color when hovering. The status bar is shown in the bottom of the window.")),fL=T("statusBarItem.hoverForeground",$l,u("statusBarItemHoverForeground","Status bar item foreground color when hovering. The status bar is shown in the bottom of the window.")),Nle=T("statusBarItem.compactHoverBackground",{dark:j.white.transparent(.2),light:j.white.transparent(.2),hcDark:j.white.transparent(.2),hcLight:j.black.transparent(.2)},u("statusBarItemCompactHoverBackground","Status bar item background color when hovering an item that contains two hovers. The status bar is shown in the bottom of the window.")),IQt=T("statusBarItem.prominentForeground",$l,u("statusBarProminentItemForeground","Status bar prominent items foreground color. Prominent items stand out from other status bar entries to indicate importance. The status bar is shown in the bottom of the window.")),yQt=T("statusBarItem.prominentBackground",j.black.transparent(.5),u("statusBarProminentItemBackground","Status bar prominent items background color. Prominent items stand out from other status bar entries to indicate importance. The status bar is shown in the bottom of the window.")),SQt=T("statusBarItem.prominentHoverForeground",fL,u("statusBarProminentItemHoverForeground","Status bar prominent items foreground color when hovering. Prominent items stand out from other status bar entries to indicate importance. The status bar is shown in the bottom of the window.")),CQt=T("statusBarItem.prominentHoverBackground",{dark:j.black.transparent(.3),light:j.black.transparent(.3),hcDark:j.black.transparent(.3),hcLight:null},u("statusBarProminentItemHoverBackground","Status bar prominent items background color when hovering. Prominent items stand out from other status bar entries to indicate importance. The status bar is shown in the bottom of the window.")),wQt=T("statusBarItem.errorBackground",{dark:ia(tk,.4),light:ia(tk,.4),hcDark:null,hcLight:"#B5200D"},u("statusBarErrorItemBackground","Status bar error items background color. Error items stand out from other status bar entries to indicate error conditions. The status bar is shown in the bottom of the window.")),EQt=T("statusBarItem.errorForeground",j.white,u("statusBarErrorItemForeground","Status bar error items foreground color. Error items stand out from other status bar entries to indicate error conditions. The status bar is shown in the bottom of the window.")),xQt=T("statusBarItem.errorHoverForeground",fL,u("statusBarErrorItemHoverForeground","Status bar error items foreground color when hovering. Error items stand out from other status bar entries to indicate error conditions. The status bar is shown in the bottom of the window.")),TQt=T("statusBarItem.errorHoverBackground",dh,u("statusBarErrorItemHoverBackground","Status bar error items background color when hovering. Error items stand out from other status bar entries to indicate error conditions. The status bar is shown in the bottom of the window.")),_Qt=T("statusBarItem.warningBackground",{dark:ia(Zr,.4),light:ia(Zr,.4),hcDark:null,hcLight:"#895503"},u("statusBarWarningItemBackground","Status bar warning items background color. Warning items stand out from other status bar entries to indicate warning conditions. The status bar is shown in the bottom of the window.")),DQt=T("statusBarItem.warningForeground",j.white,u("statusBarWarningItemForeground","Status bar warning items foreground color. Warning items stand out from other status bar entries to indicate warning conditions. The status bar is shown in the bottom of the window.")),kQt=T("statusBarItem.warningHoverForeground",fL,u("statusBarWarningItemHoverForeground","Status bar warning items foreground color when hovering. Warning items stand out from other status bar entries to indicate warning conditions. The status bar is shown in the bottom of the window.")),LQt=T("statusBarItem.warningHoverBackground",dh,u("statusBarWarningItemHoverBackground","Status bar warning items background color when hovering. Warning items stand out from other status bar entries to indicate warning conditions. The status bar is shown in the bottom of the window.")),RQt=T("activityBar.background",{dark:"#333333",light:"#2C2C2C",hcDark:"#000000",hcLight:"#FFFFFF"},u("activityBarBackground","Activity bar background color. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),$w=T("activityBar.foreground",{dark:j.white,light:j.white,hcDark:j.white,hcLight:Qo},u("activityBarForeground","Activity bar item foreground color when it is active. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),PQt=T("activityBar.inactiveForeground",{dark:Ne($w,.4),light:Ne($w,.4),hcDark:j.white,hcLight:Qo},u("activityBarInActiveForeground","Activity bar item foreground color when it is inactive. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),MQt=T("activityBar.border",{dark:null,light:null,hcDark:Oe,hcLight:Oe},u("activityBarBorder","Activity bar border color separating to the side bar. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),AQt=T("activityBar.activeBorder",{dark:$w,light:$w,hcDark:Oe,hcLight:Oe},u("activityBarActiveBorder","Activity bar border color for the active item. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),OQt=T("activityBar.activeFocusBorder",{dark:null,light:null,hcDark:null,hcLight:"#B5200D"},u("activityBarActiveFocusBorder","Activity bar focus border color for the active item. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),NQt=T("activityBar.activeBackground",null,u("activityBarActiveBackground","Activity bar background color for the active item. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),FQt=T("activityBar.dropBorder",{dark:$w,light:$w,hcDark:null,hcLight:null},u("activityBarDragAndDropBorder","Drag and drop feedback color for the activity bar items. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),bL=T("activityBarBadge.background",{dark:"#007ACC",light:"#007ACC",hcDark:"#000000",hcLight:"#0F4A85"},u("activityBarBadgeBackground","Activity notification badge background color. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),vL=T("activityBarBadge.foreground",j.white,u("activityBarBadgeForeground","Activity notification badge foreground color. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),mL=T("activityBarTop.foreground",{dark:"#E7E7E7",light:"#424242",hcDark:j.white,hcLight:Qo},u("activityBarTop","Active foreground color of the item in the Activity bar when it is on top / bottom. The activity allows to switch between views of the side bar.")),BQt=T("activityBarTop.activeBorder",{dark:mL,light:mL,hcDark:Oe,hcLight:"#B5200D"},u("activityBarTopActiveFocusBorder","Focus border color for the active item in the Activity bar when it is on top / bottom. The activity allows to switch between views of the side bar.")),VQt=T("activityBarTop.activeBackground",null,u("activityBarTopActiveBackground","Background color for the active item in the Activity bar when it is on top / bottom. The activity allows to switch between views of the side bar.")),WQt=T("activityBarTop.inactiveForeground",{dark:Ne(mL,.6),light:Ne(mL,.75),hcDark:j.white,hcLight:Qo},u("activityBarTopInActiveForeground","Inactive foreground color of the item in the Activity bar when it is on top / bottom. The activity allows to switch between views of the side bar.")),HQt=T("activityBarTop.dropBorder",mL,u("activityBarTopDragAndDropBorder","Drag and drop feedback color for the items in the Activity bar when it is on top / bottom. The activity allows to switch between views of the side bar.")),UQt=T("activityBarTop.background",null,u("activityBarTopBackground","Background color of the activity bar when set to top / bottom.")),zQt=T("profileBadge.background",{dark:"#4D4D4D",light:"#C4C4C4",hcDark:j.white,hcLight:j.black},u("profileBadgeBackground","Profile badge background color. The profile badge shows on top of the settings gear icon in the activity bar.")),KQt=T("profileBadge.foreground",{dark:j.white,light:"#333333",hcDark:j.black,hcLight:j.white},u("profileBadgeForeground","Profile badge foreground color. The profile badge shows on top of the settings gear icon in the activity bar.")),GQt=T("statusBarItem.remoteBackground",bL,u("statusBarItemHostBackground","Background color for the remote indicator on the status bar.")),BCe=T("statusBarItem.remoteForeground",vL,u("statusBarItemHostForeground","Foreground color for the remote indicator on the status bar.")),qQt=T("statusBarItem.remoteHoverForeground",fL,u("statusBarRemoteItemHoverForeground","Foreground color for the remote indicator on the status bar when hovering.")),$Qt=T("statusBarItem.remoteHoverBackground",{dark:dh,light:dh,hcDark:dh,hcLight:null},u("statusBarRemoteItemHoverBackground","Background color for the remote indicator on the status bar when hovering.")),jQt=T("statusBarItem.offlineBackground","#6c1717",u("statusBarItemOfflineBackground","Status bar item background color when the workbench is offline.")),XQt=T("statusBarItem.offlineForeground",BCe,u("statusBarItemOfflineForeground","Status bar item foreground color when the workbench is offline.")),YQt=T("statusBarItem.offlineHoverForeground",fL,u("statusBarOfflineItemHoverForeground","Status bar item foreground hover color when the workbench is offline.")),QQt=T("statusBarItem.offlineHoverBackground",{dark:dh,light:dh,hcDark:dh,hcLight:null},u("statusBarOfflineItemHoverBackground","Status bar item background hover color when the workbench is offline.")),ZQt=T("extensionBadge.remoteBackground",bL,u("extensionBadge.remoteBackground","Background color for the remote badge in the extensions view.")),JQt=T("extensionBadge.remoteForeground",vL,u("extensionBadge.remoteForeground","Foreground color for the remote badge in the extensions view.")),WF=T("sideBar.background",{dark:"#252526",light:"#F3F3F3",hcDark:"#000000",hcLight:"#FFFFFF"},u("sideBarBackground","Side bar background color. The side bar is the container for views like explorer and search.")),Fle=T("sideBar.foreground",null,u("sideBarForeground","Side bar foreground color. The side bar is the container for views like explorer and search.")),eZt=T("sideBar.border",{dark:null,light:null,hcDark:Oe,hcLight:Oe},u("sideBarBorder","Side bar border color on the side separating to the editor. The side bar is the container for views like explorer and search.")),tZt=T("sideBarTitle.background",WF,u("sideBarTitleBackground","Side bar title background color. The side bar is the container for views like explorer and search.")),iZt=T("sideBarTitle.foreground",Fle,u("sideBarTitleForeground","Side bar title foreground color. The side bar is the container for views like explorer and search.")),T9=T("sideBar.dropBackground",jw,u("sideBarDragAndDropBackground","Drag and drop feedback color for the side bar sections. The color should have transparency so that the side bar sections can still shine through. The side bar is the container for views like explorer and search. Side bar sections are views nested within the side bar.")),Ble=T("sideBarSectionHeader.background",{dark:j.fromHex("#808080").transparent(.2),light:j.fromHex("#808080").transparent(.2),hcDark:null,hcLight:null},u("sideBarSectionHeaderBackground","Side bar section header background color. The side bar is the container for views like explorer and search. Side bar sections are views nested within the side bar.")),Vle=T("sideBarSectionHeader.foreground",Fle,u("sideBarSectionHeaderForeground","Side bar section header foreground color. The side bar is the container for views like explorer and search. Side bar sections are views nested within the side bar.")),_9=T("sideBarSectionHeader.border",Oe,u("sideBarSectionHeaderBorder","Side bar section header border color. The side bar is the container for views like explorer and search. Side bar sections are views nested within the side bar.")),nZt=T("sideBarActivityBarTop.border",_9,u("sideBarActivityBarTopBorder","Border color between the activity bar at the top/bottom and the views.")),Wle=T("sideBarStickyScroll.background",WF,u("sideBarStickyScrollBackground","Background color of sticky scroll in the side bar.")),Hle=T("sideBarStickyScroll.border",null,u("sideBarStickyScrollBorder","Border color of sticky scroll in the side bar.")),Ule=T("sideBarStickyScroll.shadow",Pf,u("sideBarStickyScrollShadow","Shadow color of sticky scroll in the side bar.")),Tc=T("titleBar.activeForeground",{dark:"#CCCCCC",light:"#333333",hcDark:"#FFFFFF",hcLight:"#292929"},u("titleBarActiveForeground","Title bar foreground when the window is active.")),HF=T("titleBar.inactiveForeground",{dark:Ne(Tc,.6),light:Ne(Tc,.6),hcDark:null,hcLight:"#292929"},u("titleBarInactiveForeground","Title bar foreground when the window is inactive.")),NF=T("titleBar.activeBackground",{dark:"#3C3C3C",light:"#DDDDDD",hcDark:"#000000",hcLight:"#FFFFFF"},u("titleBarActiveBackground","Title bar background when the window is active.")),zle=T("titleBar.inactiveBackground",{dark:Ne(NF,.6),light:Ne(NF,.6),hcDark:null,hcLight:null},u("titleBarInactiveBackground","Title bar background when the window is inactive.")),Kle=T("titleBar.border",{dark:null,light:null,hcDark:Oe,hcLight:Oe},u("titleBarBorder","Title bar border color.")),VCe=T("menubar.selectionForeground",Tc,u("menubarSelectionForeground","Foreground color of the selected menu item in the menubar.")),rle=T("menubar.selectionBackground",{dark:EI,light:EI,hcDark:null,hcLight:null},u("menubarSelectionBackground","Background color of the selected menu item in the menubar.")),oZt=T("menubar.selectionBorder",{dark:null,light:null,hcDark:fi,hcLight:fi},u("menubarSelectionBorder","Border color of the selected menu item in the menubar.")),rZt=T("commandCenter.foreground",Tc,u("commandCenter-foreground","Foreground color of the command center"),!1),sZt=T("commandCenter.activeForeground",VCe,u("commandCenter-activeForeground","Active foreground color of the command center"),!1),aZt=T("commandCenter.inactiveForeground",HF,u("commandCenter-inactiveForeground","Foreground color of the command center when the window is inactive"),!1),Gle=T("commandCenter.background",{dark:j.white.transparent(.05),hcDark:null,light:j.black.transparent(.05),hcLight:null},u("commandCenter-background","Background color of the command center"),!1),lZt=T("commandCenter.activeBackground",{dark:j.white.transparent(.08),hcDark:rle,light:j.black.transparent(.08),hcLight:rle},u("commandCenter-activeBackground","Active background color of the command center"),!1),dZt=T("commandCenter.border",{dark:Ne(Tc,.2),hcDark:Oe,light:Ne(Tc,.2),hcLight:Oe},u("commandCenter-border","Border color of the command center"),!1),cZt=T("commandCenter.activeBorder",{dark:Ne(Tc,.3),hcDark:Tc,light:Ne(Tc,.3),hcLight:Tc},u("commandCenter-activeBorder","Active border color of the command center"),!1),uZt=T("commandCenter.inactiveBorder",Ne(HF,.25),u("commandCenter-inactiveBorder","Border color of the command center when the window is inactive"),!1),pZt=T("notificationCenter.border",{dark:Am,light:Am,hcDark:Oe,hcLight:Oe},u("notificationCenterBorder","Notifications center border color. Notifications slide in from the bottom right of the window.")),hZt=T("notificationToast.border",{dark:Am,light:Am,hcDark:Oe,hcLight:Oe},u("notificationToastBorder","Notification toast border color. Notifications slide in from the bottom right of the window.")),mZt=T("notifications.foreground",Wp,u("notificationsForeground","Notifications foreground color. Notifications slide in from the bottom right of the window.")),RF=T("notifications.background",xr,u("notificationsBackground","Notifications background color. Notifications slide in from the bottom right of the window.")),gZt=T("notificationLink.foreground",wI,u("notificationsLink","Notification links foreground color. Notifications slide in from the bottom right of the window.")),fZt=T("notificationCenterHeader.foreground",null,u("notificationCenterHeaderForeground","Notifications center header foreground color. Notifications slide in from the bottom right of the window.")),WCe=T("notificationCenterHeader.background",{dark:wa(RF,.3),light:ia(RF,.05),hcDark:RF,hcLight:RF},u("notificationCenterHeaderBackground","Notifications center header background color. Notifications slide in from the bottom right of the window.")),bZt=T("notifications.border",WCe,u("notificationsBorder","Notifications border color separating from other notifications in the notifications center. Notifications slide in from the bottom right of the window.")),vZt=T("notificationsErrorIcon.foreground",xI,u("notificationsErrorIconForeground","The color used for the icon of error notifications. Notifications slide in from the bottom right of the window.")),IZt=T("notificationsWarningIcon.foreground",Zr,u("notificationsWarningIconForeground","The color used for the icon of warning notifications. Notifications slide in from the bottom right of the window.")),yZt=T("notificationsInfoIcon.foreground",Jr,u("notificationsInfoIconForeground","The color used for the icon of info notifications. Notifications slide in from the bottom right of the window.")),SZt=T("window.activeBorder",{dark:null,light:null,hcDark:Oe,hcLight:Oe},u("windowActiveBorder","The color used for the border of the window when it is active. Only supported in the macOS and Linux desktop client when using the custom title bar.")),CZt=T("window.inactiveBorder",{dark:null,light:null,hcDark:Oe,hcLight:Oe},u("windowInactiveBorder","The color used for the border of the window when it is inactive. Only supported in the macOS and Linux desktop client when using the custom title bar."));var DZt=q("accessibleViewInformationService"),UF=class extends R{constructor(e){super();this._storageService=e}hasShownAccessibleView(e){return this._storageService.getBoolean(`${Qte}${e}`,-1,!1)===!0}};UF=E([b(0,nt)],UF);var zF=new et("viewpane.action.filter"),HCe=ke("view-pane-container-expanded",N.chevronDown,u("viewPaneContainerExpandedIcon","Icon for an expanded view pane container.")),UCe=ke("view-pane-container-collapsed",N.chevronRight,u("viewPaneContainerCollapsedIcon","Icon for a collapsed view pane container.")),qle=Pe.as(xc.ViewsRegistry),IL=class{constructor(t,e,i,n,o,s,a){this.container=t;this.delegate=e;this.instantiationService=i;this.openerService=n;this.telemetryService=o;this.contextKeyService=s;this.disposables.add(X.runAndSubscribe(this.delegate.onDidChangeViewWelcomeState,()=>this.onDidChangeViewWelcomeState())),this.disposables.add(a.onWillShutdown(()=>this.dispose()))}defaultItem;items=[];get enabled(){return this._enabled}_enabled=!1;element;scrollableElement;disposables=new B;enabledDisposables=this.disposables.add(new B);renderDisposables=this.disposables.add(new B);layout(t,e){this._enabled&&(this.element.style.height=`${t}px`,this.element.style.width=`${e}px`,this.element.classList.toggle("wide",e>640),this.scrollableElement.scanDomNode())}focus(){this._enabled&&this.element.focus()}onDidChangeViewWelcomeState(){let t=this.delegate.shouldShowWelcome();if(this._enabled===t)return;if(this._enabled=t,!t){this.enabledDisposables.clear();return}this.container.classList.add("welcome");let e=U(this.container,J(".welcome-view"));this.element=J(".welcome-view-content",{tabIndex:0}),this.scrollableElement=new Da(this.element,{alwaysConsumeMouseWheel:!0,horizontal:2,vertical:3}),U(e,this.scrollableElement.getDomNode()),this.enabledDisposables.add(le(()=>{this.container.classList.remove("welcome"),this.scrollableElement.dispose(),e.remove(),this.scrollableElement=void 0,this.element=void 0})),this.contextKeyService.onDidChangeContext(this.onDidChangeContext,this,this.enabledDisposables),X.chain(qle.onDidChangeViewWelcomeContent,i=>i.filter(n=>n===this.delegate.id))(this.onDidChangeViewWelcomeContent,this,this.enabledDisposables),this.onDidChangeViewWelcomeContent()}onDidChangeViewWelcomeContent(){let t=qle.getViewWelcomeContent(this.delegate.id);this.items=[];for(let e of t)if(e.when==="default")this.defaultItem={descriptor:e,visible:!0};else{let i=e.when?this.contextKeyService.contextMatchesRules(e.when):!0;this.items.push({descriptor:e,visible:i})}this.render()}onDidChangeContext(){let t=!1;for(let e of this.items){if(!e.descriptor.when||e.descriptor.when==="default")continue;let i=this.contextKeyService.contextMatchesRules(e.descriptor.when);e.visible!==i&&(e.visible=i,t=!0)}t&&this.render()}render(){this.renderDisposables.clear(),this.element.innerText="";let t=this.getContentDescriptors();if(t.length===0){this.container.classList.remove("welcome"),this.scrollableElement.scanDomNode();return}for(let{content:e,precondition:i}of t){let n=e.split(`
`);for(let o of n){if(o=o.trim(),!o)continue;let s=Qae(o);if(s.nodes.length===1&&typeof s.nodes[0]!="string"){let a=s.nodes[0],l=U(this.element,J(".button-container")),d=new zI(l,{title:a.title,supportIcons:!0,...dF});if(d.label=a.label,d.onDidClick(c=>{this.telemetryService.publicLog2("views.welcomeAction",{viewId:this.delegate.id,uri:a.href}),this.openerService.open(a.href,{allowCommands:!0})},null,this.renderDisposables),this.renderDisposables.add(d),i){let c=()=>d.enabled=this.contextKeyService.contextMatchesRules(i);c();let p=new Set(i.keys());X.filter(this.contextKeyService.onDidChangeContext,m=>m.affectsSome(p))(c,null,this.renderDisposables)}}else{let a=U(this.element,J("p"));for(let l of s.nodes)if(typeof l=="string")U(a,document.createTextNode(l));else{let d=this.renderDisposables.add(this.instantiationService.createInstance(Ww,a,l,{}));if(i&&l.href.startsWith("command:")){let c=()=>d.enabled=this.contextKeyService.contextMatchesRules(i);c();let p=new Set(i.keys());X.filter(this.contextKeyService.onDidChangeContext,m=>m.affectsSome(p))(c,null,this.renderDisposables)}}}}}this.container.classList.add("welcome"),this.scrollableElement.scanDomNode()}getContentDescriptors(){let t=this.items.filter(e=>e.visible);return t.length===0&&this.defaultItem?[this.defaultItem.descriptor]:t.map(e=>e.descriptor)}dispose(){this.disposables.dispose()}};IL=E([b(2,ne),b(3,Yi),b(4,Tt),b(5,re),b(6,er)],IL);var Lr=class extends U1{constructor(e,i,n,o,s,a,l,d,c,p,h,m){super({...e,orientation:a.getViewLocationById(e.id)===1?1:0});this.keybindingService=i;this.contextMenuService=n;this.configurationService=o;this.contextKeyService=s;this.viewDescriptorService=a;this.instantiationService=l;this.openerService=d;this.themeService=c;this.telemetryService=p;this.hoverService=h;this.accessibleViewInformationService=m;this.id=e.id,this._title=e.title,this._titleDescription=e.titleDescription,this._singleViewPaneContainerTitle=e.singleViewPaneContainerTitle,this.showActions=e.showActions??0,this.scopedContextKeyService=this._register(s.createScoped(this.element)),this.scopedContextKeyService.createKey("view",this.id);let f=this.scopedContextKeyService.createKey("viewLocation",Es(a.getViewLocationById(this.id)));this._register(X.filter(a.onDidChangeLocation,v=>v.views.some(I=>I.id===this.id))(()=>f.set(Es(a.getViewLocationById(this.id)))));let g=this._register(this.instantiationService.createChild(new el([re,this.scopedContextKeyService])));this.menuActions=this._register(g.createInstance(nb,e.titleMenuId??V.ViewTitle,V.ViewTitleContext,{shouldForwardArgs:!e.donotForwardArgs,renderShortTitle:!0})),this._register(this.menuActions.onDidChange(()=>this.updateActions()))}static AlwaysShowActionsConfig="workbench.view.alwaysShowHeaderActions";_onDidFocus=this._register(new x);onDidFocus=this._onDidFocus.event;_onDidBlur=this._register(new x);onDidBlur=this._onDidBlur.event;_onDidChangeBodyVisibility=this._register(new x);onDidChangeBodyVisibility=this._onDidChangeBodyVisibility.event;_onDidChangeTitleArea=this._register(new x);onDidChangeTitleArea=this._onDidChangeTitleArea.event;_onDidChangeViewWelcomeState=this._register(new x);onDidChangeViewWelcomeState=this._onDidChangeViewWelcomeState.event;_isVisible=!1;id;_title;get title(){return this._title}_titleDescription;get titleDescription(){return this._titleDescription}_singleViewPaneContainerTitle;get singleViewPaneContainerTitle(){return this._singleViewPaneContainerTitle}menuActions;progressBar;progressIndicator;toolbar;showActions;headerContainer;titleContainer;titleContainerHover;titleDescriptionContainer;titleDescriptionContainerHover;iconContainer;iconContainerHover;twistiesContainer;viewWelcomeController;scopedContextKeyService;get headerVisible(){return super.headerVisible}set headerVisible(e){super.headerVisible=e,this.element.classList.toggle("merged-header",!e)}setVisible(e){this._isVisible!==e&&(this._isVisible=e,this.isExpanded()&&this._onDidChangeBodyVisibility.fire(e))}isVisible(){return this._isVisible}isBodyVisible(){return this._isVisible&&this.isExpanded()}setExpanded(e){let i=super.setExpanded(e);return i&&this._onDidChangeBodyVisibility.fire(e),this.updateTwistyIcon(),i}render(){super.render();let e=Er(this.element);this._register(e),this._register(e.onDidFocus(()=>this._onDidFocus.fire())),this._register(e.onDidBlur(()=>this._onDidBlur.fire()))}renderHeader(e){this.headerContainer=e,this.twistiesContainer=U(e,J(`.twisty-container${de.asCSSSelector(this.getTwistyIcon(this.isExpanded()))}`)),this.renderHeaderTitle(e,this.title);let i=U(e,J(".actions"));i.classList.toggle("show-always",this.showActions===2),i.classList.toggle("show-expanded",this.showActions===1),this.toolbar=this.instantiationService.createInstance(ul,i,{orientation:0,actionViewItemProvider:(s,a)=>this.getActionViewItem(s,a),ariaLabel:u("viewToolbarAriaLabel","{0} actions",this.title),getKeyBinding:s=>this.keybindingService.lookupKeybinding(s.id),renderDropdownAsChildElement:!0,actionRunner:this.getActionRunner(),resetMenu:this.menuActions.menuId}),this._register(this.toolbar),this.setActions(),this._register(F(i,Q.CLICK,s=>s.preventDefault()));let n=this.viewDescriptorService.getViewContainerByViewId(this.id);n?this._register(this.viewDescriptorService.getViewContainerModel(n).onDidChangeContainerInfo(({title:s})=>this.updateTitle(this.title))):console.error(`View container model not found for view ${this.id}`);let o=X.filter(this.configurationService.onDidChangeConfiguration,s=>s.affectsConfiguration(Lr.AlwaysShowActionsConfig));this._register(o(this.updateActionsVisibility,this)),this.updateActionsVisibility()}updateHeader(){super.updateHeader(),this.updateTwistyIcon()}updateTwistyIcon(){this.twistiesContainer&&(this.twistiesContainer.classList.remove(...de.asClassNameArray(this.getTwistyIcon(!this._expanded))),this.twistiesContainer.classList.add(...de.asClassNameArray(this.getTwistyIcon(this._expanded))))}getTwistyIcon(e){return e?HCe:UCe}style(e){super.style(e);let i=this.getIcon();if(this.iconContainer){let n=Ja(e.headerForeground,Se(st));Z.isUri(i)?(this.iconContainer.style.backgroundColor=n,this.iconContainer.style.color=""):(this.iconContainer.style.color=n,this.iconContainer.style.backgroundColor="")}}getIcon(){return this.viewDescriptorService.getViewDescriptorById(this.id)?.containerIcon||Yae}renderHeaderTitle(e,i){this.iconContainer=U(e,J(".icon",void 0));let n=this.getIcon(),o;if(Z.isUri(n)){o=`view-${this.id.replace(/[\.\:]/g,"-")}`;let a=`.pane-header .icon.${o}`;lD(a,`
				mask: ${Dp(n)} no-repeat 50% 50%;
				mask-size: 24px;
				-webkit-mask: ${Dp(n)} no-repeat 50% 50%;
				-webkit-mask-size: 16px;
			`)}else de.isThemeIcon(n)&&(o=de.asClassName(n));o&&this.iconContainer.classList.add(...o.split(" "));let s=this.calculateTitle(i);this.titleContainer=U(e,J("h3.title",{},s)),this.titleContainerHover=this._register(this.hoverService.setupManagedHover(gt("mouse"),this.titleContainer,s)),this._titleDescription&&this.setTitleDescription(this._titleDescription),this.iconContainerHover=this._register(this.hoverService.setupManagedHover(gt("mouse"),this.iconContainer,s)),this.iconContainer.setAttribute("aria-label",this._getAriaLabel(s))}_getAriaLabel(e){let i=this.viewDescriptorService.getViewDescriptorById(this.id)?.accessibilityHelpContent,n=this.accessibleViewInformationService?.hasShownAccessibleView(this.id);return!i||n?e:u("viewAccessibilityHelp","Use Alt+F1 for accessibility help {0}",e)}updateTitle(e){let i=this.calculateTitle(e);this.titleContainer&&(this.titleContainer.textContent=i,this.titleContainerHover?.update(i)),this.iconContainer&&(this.iconContainerHover?.update(i),this.iconContainer.setAttribute("aria-label",this._getAriaLabel(i))),this._title=e,this._onDidChangeTitleArea.fire()}setTitleDescription(e){this.titleDescriptionContainer?(this.titleDescriptionContainer.textContent=e??"",this.titleDescriptionContainerHover?.update(e??"")):e&&this.titleContainer&&(this.titleDescriptionContainer=KA(this.titleContainer,J("span.description",{},e)),this.titleDescriptionContainerHover=this._register(this.hoverService.setupManagedHover(gt("mouse"),this.titleDescriptionContainer,e)))}updateTitleDescription(e){this.setTitleDescription(e),this._titleDescription=e,this._onDidChangeTitleArea.fire()}calculateTitle(e){let i=this.viewDescriptorService.getViewContainerByViewId(this.id),n=this.viewDescriptorService.getViewContainerModel(i),o=this.viewDescriptorService.getViewDescriptorById(this.id);return!(this.viewDescriptorService.getDefaultContainerById(this.id)===i)&&o?.containerTitle&&n.title!==o.containerTitle?`${o.containerTitle}: ${e}`:e}renderBody(e){this.viewWelcomeController=this._register(this.instantiationService.createInstance(IL,e,this))}layoutBody(e,i){this.viewWelcomeController.layout(e,i)}onDidScrollRoot(){}getProgressIndicator(){if(this.progressBar===void 0&&(this.progressBar=this._register(new J1(this.element,Wae)),this.progressBar.hide()),this.progressIndicator===void 0){let e=this;this.progressIndicator=this._register(new SF(Yt(this.progressBar),new class extends CF{constructor(){super(e.id,e.isBodyVisible()),this._register(e.onDidChangeBodyVisibility(i=>i?this.onScopeOpened(e.id):this.onScopeClosed(e.id)))}}))}return this.progressIndicator}getProgressLocation(){return this.viewDescriptorService.getViewContainerByViewId(this.id).id}getLocationBasedColors(){return zCe(this.viewDescriptorService.getViewLocationById(this.id))}focus(){this.viewWelcomeController.enabled?this.viewWelcomeController.focus():this.element&&(this.element.focus(),this._onDidFocus.fire())}setActions(){if(this.toolbar){let e=[...this.menuActions.getPrimaryActions()];this.shouldShowFilterInHeader()&&e.unshift(zF),this.toolbar.setActions(Ym(e),Ym(this.menuActions.getSecondaryActions())),this.toolbar.context=this.getActionsContext()}}updateActionsVisibility(){if(!this.headerContainer)return;let e=this.configurationService.getValue("workbench.view.alwaysShowHeaderActions");this.headerContainer.classList.toggle("actions-always-visible",e)}updateActions(){this.setActions(),this._onDidChangeTitleArea.fire()}getActionViewItem(e,i){if(e.id===zF.id){let n=this;return new class extends Yn{constructor(){super(null,e)}setFocusable(){}get trapsArrowNavigation(){return!0}render(o){o.classList.add("viewpane-filter-container");let s=n.getFilterWidget();U(o,s.element),s.relayout()}}}return aa(this.instantiationService,e,{...i,menuAsChild:e instanceof to})}getActionsContext(){}getActionRunner(){}getOptimalWidth(){return 0}saveState(){}shouldShowWelcome(){return!1}getFilterWidget(){}shouldShowFilterInHeader(){return!1}};Lr=E([b(1,Be),b(2,vt),b(3,se),b(4,re),b(5,$i),b(6,ne),b(7,Yi),b(8,Fe),b(9,Tt),b(10,Nt)],Lr);var Xw=class extends Lr{filterWidget;dimension;filterContainer;constructor(t,e,i,n,o,s,a,l,d,c,p,h){super(t,e,i,n,o,s,a,l,d,c,p,h);let m=this._register(a.createChild(new el([re,this.scopedContextKeyService])));this.filterWidget=this._register(m.createInstance(Kw,t.filterOptions))}getFilterWidget(){return this.filterWidget}renderBody(t){super.renderBody(t),this.filterContainer=U(t,J(".viewpane-filter-container"))}layoutBody(t,e){super.layoutBody(t,e),this.dimension=new Ge(e,t);let i=!this.filterContainer?.hasChildNodes(),n=this.shouldShowFilterInHeader();i!==n&&(n&&bo(this.filterContainer),this.updateActions(),n||U(this.filterContainer,this.filterWidget.element)),n||(t=t-44),this.filterWidget.layout(e),this.layoutBodyContent(t,e)}shouldShowFilterInHeader(){return!(this.dimension&&this.dimension.width<600&&this.dimension.height>100)}};Xw=E([b(1,Be),b(2,vt),b(3,se),b(4,re),b(5,$i),b(6,ne),b(7,Yi),b(8,Fe),b(9,Tt),b(10,Nt)],Xw);function zCe(r){let t,e,i,n;switch(r){case 1:t=w9,e=_le,i=Dle,n=kle;break;case 0:case 2:default:t=WF,e=Wle,i=Hle,n=Ule}return{background:t,listOverrideStyles:{listBackground:t,treeStickyScrollBackground:e,treeStickyScrollBorder:i,treeStickyScrollShadow:n}}}var tr=class extends Me{desc;constructor(t){super(t),this.desc=t}run(t,...e){let i=t.get(Mi).getActiveViewWithId(this.desc.viewId);if(i)return this.runInView(t,i,...e)}};function $le(r){switch(r){case 100:return"req";case 101:return"cancel";case 102:return"subscribe";case 103:return"unsubscribe"}}function jle(r){switch(r){case 200:return"init";case 201:return"reply:";case 202:case 203:return"replyErr:";case 204:return"event:"}}function Yw(r){let t=0;for(let e=0;;e+=7){let i=r.read(1);if(t|=(i.buffer[0]&127)<<e,!(i.buffer[0]&128))return t}}var KCe=ab(0);function Qw(r,t){if(t===0){r.write(KCe);return}let e=0;for(let n=t;n!==0;n=n>>>7)e++;let i=Jt.alloc(e);for(let n=0;t!==0;n++)i.buffer[n]=t&127,t=t>>>7,t>0&&(i.buffer[n]|=128);r.write(i)}var k9=class{constructor(t){this.buffer=t}pos=0;read(t){let e=this.buffer.slice(this.pos,this.pos+t);return this.pos+=e.byteLength,e}},L9=class{buffers=[];get buffer(){return Jt.concat(this.buffers)}write(t){this.buffers.push(t)}};function ab(r){let t=Jt.alloc(1);return t.writeUInt8(r,0),t}var XI={Undefined:ab(0),String:ab(1),Buffer:ab(2),VSBuffer:ab(3),Array:ab(4),Object:ab(5),Uint:ab(6)},GCe=typeof Buffer<"u";function R9(r,t){if(typeof t>"u")r.write(XI.Undefined);else if(typeof t=="string"){let e=Jt.fromString(t);r.write(XI.String),Qw(r,e.byteLength),r.write(e)}else if(GCe&&Buffer.isBuffer(t)){let e=Jt.wrap(t);r.write(XI.Buffer),Qw(r,e.byteLength),r.write(e)}else if(t instanceof Jt)r.write(XI.VSBuffer),Qw(r,t.byteLength),r.write(t);else if(Array.isArray(t)){r.write(XI.Array),Qw(r,t.length);for(let e of t)R9(r,e)}else if(typeof t=="number"&&(t|0)===t)r.write(XI.Uint),Qw(r,t);else{let e=Jt.fromString(JSON.stringify(t));r.write(XI.Object),Qw(r,e.byteLength),r.write(e)}}function P9(r){switch(r.read(1).readUInt8(0)){case 0:return;case 1:return r.read(Yw(r)).toString();case 2:return r.read(Yw(r)).buffer;case 3:return r.read(Yw(r));case 4:{let e=Yw(r),i=[];for(let n=0;n<e;n++)i.push(P9(r));return i}case 5:return JSON.parse(r.read(Yw(r)).toString());case 6:return Yw(r)}}var D9=class{constructor(t,e=null){this.protocol=t;this.protocolListener=this.protocol.onMessage(i=>this.onBuffer(i)),this.logger=e}isDisposed=!1;state=0;activeRequests=new Set;handlers=new Map;lastRequestId=0;protocolListener;logger;_onDidInitialize=new x;onDidInitialize=this._onDidInitialize.event;getChannel(t){let e=this;return{call(i,n,o){return e.isDisposed?Promise.reject(new wo):e.requestPromise(t,i,n,o)},listen(i,n){return e.isDisposed?X.None:e.requestEvent(t,i,n)}}}requestPromise(t,e,i,n=Pt.None){let o=this.lastRequestId++,a={id:o,type:100,channelName:t,name:e,arg:i};if(n.isCancellationRequested)return Promise.reject(new wo);let l;return new Promise((c,p)=>{if(n.isCancellationRequested)return p(new wo);let h=()=>{let v=I=>{switch(I.type){case 201:this.handlers.delete(o),c(I.data);break;case 202:{this.handlers.delete(o);let y=new Error(I.data.message);y.stack=Array.isArray(I.data.stack)?I.data.stack.join(`
`):I.data.stack,y.name=I.data.name,p(y);break}case 203:this.handlers.delete(o),p(I.data);break}};this.handlers.set(o,v),this.sendRequest(a)},m=null;this.state===1?h():(m=va(v=>this.whenInitialized()),m.then(()=>{m=null,h()}));let f=()=>{m?(m.cancel(),m=null):this.sendRequest({id:o,type:101}),p(new wo)},g=n.onCancellationRequested(f);l=In(le(f),g),this.activeRequests.add(l)}).finally(()=>{l.dispose(),this.activeRequests.delete(l)})}requestEvent(t,e,i){let n=this.lastRequestId++,s={id:n,type:102,channelName:t,name:e,arg:i},a=null,l=new x({onWillAddFirstListener:()=>{a=va(c=>this.whenInitialized()),a.then(()=>{a=null,this.activeRequests.add(l),this.sendRequest(s)})},onDidRemoveLastListener:()=>{a?(a.cancel(),a=null):(this.activeRequests.delete(l),this.sendRequest({id:n,type:103}))}}),d=c=>l.fire(c.data);return this.handlers.set(n,d),l.event}sendRequest(t){switch(t.type){case 100:case 102:{let e=this.send([t.type,t.id,t.channelName,t.name],t.arg);this.logger?.logOutgoing(e,t.id,0,`${$le(t.type)}: ${t.channelName}.${t.name}`,t.arg);return}case 101:case 103:{let e=this.send([t.type,t.id]);this.logger?.logOutgoing(e,t.id,0,$le(t.type));return}}}send(t,e=void 0){let i=new L9;return R9(i,t),R9(i,e),this.sendBuffer(i.buffer)}sendBuffer(t){try{return this.protocol.send(t),t.byteLength}catch{return 0}}onBuffer(t){let e=new k9(t),i=P9(e),n=P9(e),o=i[0];switch(o){case 200:return this.logger?.logIncoming(t.byteLength,0,0,jle(o)),this.onResponse({type:i[0]});case 201:case 202:case 204:case 203:return this.logger?.logIncoming(t.byteLength,i[1],0,jle(o),n),this.onResponse({type:i[0],id:i[1],data:n})}}onResponse(t){if(t.type===200){this.state=1,this._onDidInitialize.fire();return}this.handlers.get(t.id)?.(t)}get onDidInitializePromise(){return X.toPromise(this.onDidInitialize)}whenInitialized(){return this.state===1?Promise.resolve():this.onDidInitializePromise}dispose(){this.isDisposed=!0,this.protocolListener&&(this.protocolListener.dispose(),this.protocolListener=null),_e(this.activeRequests.values()),this.activeRequests.clear()}};E([Re],D9.prototype,"onDidInitializePromise",1);var qCe;(n=>{function r(o,s,a){let l=o,d=a&&a.disableMarshalling,c=new Map;for(let p in l)e(p)&&c.set(p,X.buffer(l[p],!0,void 0,s));return new class{listen(p,h,m){let f=c.get(h);if(f)return f;let g=l[h];if(typeof g=="function"){if(i(h))return g.call(l,m);if(e(h))return c.set(h,X.buffer(l[h],!0,void 0,s)),c.get(h)}throw new Ga(`Event not found: ${h}`)}call(p,h,m){let f=l[h];if(typeof f=="function"){if(!d&&Array.isArray(m))for(let v=0;v<m.length;v++)m[v]=Wl(m[v]);let g=f.apply(l,m);return g instanceof Promise||(g=Promise.resolve(g)),g}throw new Ga(`Method not found: ${h}`)}}}n.fromService=r;function t(o,s){let a=s&&s.disableMarshalling;return new Proxy({},{get(l,d){if(typeof d=="string")return s?.properties?.has(d)?s.properties.get(d):i(d)?function(c){return o.listen(d,c)}:e(d)?o.listen(d):async function(...c){let p;s&&!Wn(s.context)?p=[s.context,...c]:p=c;let h=await o.call(d,p);return a?h:Wl(h)};throw new Ga(`Property not found: ${String(d)}`)}})}n.toService=t;function e(o){return o[0]==="o"&&o[1]==="n"&&Ep(o.charCodeAt(2))}function i(o){return/^onDynamic/.test(o)&&Ep(o.charCodeAt(9))}})(qCe||={});var KF="^([a-z0-9A-Z][a-z0-9-A-Z]*)\\.([a-z0-9A-Z][a-z0-9-A-Z]*)$",kei=new RegExp(KF);var Lei=q("extensionGalleryService");var Xle=q("extensionManagementService");var Rei=q("IGlobalExtensionEnablementService"),Pei=q("IExtensionTipsService"),Mei=ie("extensions","Extensions"),Aei=ie("preferences","Preferences");var A9=class{telemetryLevel=0;sessionId="someValue.sessionId";machineId="someValue.machineId";sqmId="someValue.sqmId";devDeviceId="someValue.devDeviceId";firstSessionDate="someValue.firstSessionDate";sendErrorTelemetry=!1;publicLog(){}publicLog2(){}publicLogError(){}publicLogError2(){}setExperimentProperty(){}},hti=new A9;var XCe=new Set(["ssh-remote","dev-container","attached-container","wsl","tunnel","codespaces","amlext"]);function Qle(r){if(!r)return"none";let t=WG(r);return XCe.has(t)?t:"other"}function O9(r,t){return r.uuid&&t.uuid?r.uuid===t.uuid:r.id===t.id?!0:fm(r.id,t.id)===0}var Ati=new Qr("pprice.better-merge");var N9=class{_generators=new Map;_cache=new WeakMap;register(t,e){this._generators.set(t,e)}readActivationEvents(t){return this._cache.has(t)||this._cache.set(t,this._readActivationEvents(t)),this._cache.get(t)}createActivationEventsMap(t){let e=Object.create(null);for(let i of t){let n=this.readActivationEvents(i);n.length>0&&(e[Qr.toKey(i.identifier)]=n)}return e}_readActivationEvents(t){if(typeof t.main>"u"&&typeof t.browser>"u")return[];let e=Array.isArray(t.activationEvents)?t.activationEvents.slice(0):[];for(let i=0;i<e.length;i++)e[i]==="onUri"&&(e[i]=`onUri:${Qr.toKey(t.identifier)}`);if(!t.contributes)return e;for(let i in t.contributes){let n=this._generators.get(i);if(!n)continue;let o=t.contributes[i],s=Array.isArray(o)?o:[o];try{n(s,e)}catch(a){Xe(a)}}return e}},F9=new N9;var YCe={activeComment:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.activeComment.d.ts"},aiRelatedInformation:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.aiRelatedInformation.d.ts"},aiTextSearchProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.aiTextSearchProvider.d.ts"},aiTextSearchProviderNew:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.aiTextSearchProviderNew.d.ts"},attributableCoverage:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.attributableCoverage.d.ts"},authLearnMore:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.authLearnMore.d.ts"},authSession:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.authSession.d.ts"},canonicalUriProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.canonicalUriProvider.d.ts"},chatParticipantAdditions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatParticipantAdditions.d.ts"},chatParticipantPrivate:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatParticipantPrivate.d.ts",version:2},chatProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatProvider.d.ts"},chatTab:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatTab.d.ts"},chatVariableResolver:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatVariableResolver.d.ts"},codeActionAI:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.codeActionAI.d.ts"},codeActionRanges:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.codeActionRanges.d.ts"},codiconDecoration:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.codiconDecoration.d.ts"},commentReactor:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentReactor.d.ts"},commentReveal:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentReveal.d.ts"},commentThreadApplicability:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentThreadApplicability.d.ts"},commentingRangeHint:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentingRangeHint.d.ts"},commentsDraftState:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentsDraftState.d.ts"},contribAccessibilityHelpContent:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribAccessibilityHelpContent.d.ts"},contribChatParticipantDetection:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribChatParticipantDetection.d.ts"},contribCommentEditorActionsMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentEditorActionsMenu.d.ts"},contribCommentPeekContext:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentPeekContext.d.ts"},contribCommentThreadAdditionalMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentThreadAdditionalMenu.d.ts"},contribCommentsViewThreadMenus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentsViewThreadMenus.d.ts"},contribDebugCreateConfiguration:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribDebugCreateConfiguration.d.ts"},contribDiffEditorGutterToolBarMenus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribDiffEditorGutterToolBarMenus.d.ts"},contribEditSessions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribEditSessions.d.ts"},contribEditorContentMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribEditorContentMenu.d.ts"},contribIssueReporter:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribIssueReporter.d.ts"},contribLabelFormatterWorkspaceTooltip:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribLabelFormatterWorkspaceTooltip.d.ts"},contribMenuBarHome:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribMenuBarHome.d.ts"},contribMergeEditorMenus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribMergeEditorMenus.d.ts"},contribMultiDiffEditorMenus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribMultiDiffEditorMenus.d.ts"},contribNotebookStaticPreloads:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribNotebookStaticPreloads.d.ts"},contribRemoteHelp:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribRemoteHelp.d.ts"},contribShareMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribShareMenu.d.ts"},contribSourceControlHistoryItemMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlHistoryItemMenu.d.ts"},contribSourceControlHistoryTitleMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlHistoryTitleMenu.d.ts"},contribSourceControlInputBoxMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlInputBoxMenu.d.ts"},contribSourceControlTitleMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlTitleMenu.d.ts"},contribStatusBarItems:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribStatusBarItems.d.ts"},contribViewContainerTitle:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribViewContainerTitle.d.ts"},contribViewsRemote:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribViewsRemote.d.ts"},contribViewsWelcome:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribViewsWelcome.d.ts"},createFileSystemWatcher:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.createFileSystemWatcher.d.ts"},customEditorMove:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.customEditorMove.d.ts"},debugVisualization:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.debugVisualization.d.ts"},defaultChatParticipant:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.defaultChatParticipant.d.ts"},diffCommand:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.diffCommand.d.ts"},diffContentOptions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.diffContentOptions.d.ts"},documentFiltersExclusive:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.documentFiltersExclusive.d.ts"},documentPaste:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.documentPaste.d.ts"},editSessionIdentityProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.editSessionIdentityProvider.d.ts"},editorHoverVerbosityLevel:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.editorHoverVerbosityLevel.d.ts"},editorInsets:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.editorInsets.d.ts"},embeddings:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.embeddings.d.ts"},extensionRuntime:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.extensionRuntime.d.ts"},extensionsAny:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.extensionsAny.d.ts"},externalUriOpener:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.externalUriOpener.d.ts"},fileComments:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.fileComments.d.ts"},fileSearchProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.fileSearchProvider.d.ts"},fileSearchProviderNew:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.fileSearchProviderNew.d.ts"},findFiles2:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.findFiles2.d.ts"},findFiles2New:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.findFiles2New.d.ts"},findTextInFiles:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.findTextInFiles.d.ts"},findTextInFilesNew:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.findTextInFilesNew.d.ts"},fsChunks:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.fsChunks.d.ts"},idToken:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.idToken.d.ts"},inlineCompletionsAdditions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.inlineCompletionsAdditions.d.ts"},inlineEdit:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.inlineEdit.d.ts"},interactive:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.interactive.d.ts"},interactiveWindow:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.interactiveWindow.d.ts"},ipc:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.ipc.d.ts"},languageModelSystem:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageModelSystem.d.ts"},languageStatusText:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageStatusText.d.ts"},lmTools:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.lmTools.d.ts",version:6},mappedEditsProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.mappedEditsProvider.d.ts"},multiDocumentHighlightProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.multiDocumentHighlightProvider.d.ts"},newSymbolNamesProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.newSymbolNamesProvider.d.ts"},notebookCellExecution:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookCellExecution.d.ts"},notebookCellExecutionState:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookCellExecutionState.d.ts"},notebookControllerAffinityHidden:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookControllerAffinityHidden.d.ts"},notebookDeprecated:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookDeprecated.d.ts"},notebookExecution:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookExecution.d.ts"},notebookKernelSource:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookKernelSource.d.ts"},notebookLiveShare:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookLiveShare.d.ts"},notebookMessaging:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookMessaging.d.ts"},notebookMime:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookMime.d.ts"},notebookReplDocument:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookReplDocument.d.ts"},notebookVariableProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookVariableProvider.d.ts"},portsAttributes:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.portsAttributes.d.ts"},profileContentHandlers:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.profileContentHandlers.d.ts"},quickDiffProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickDiffProvider.d.ts"},quickInputButtonLocation:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickInputButtonLocation.d.ts"},quickPickItemTooltip:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickPickItemTooltip.d.ts"},quickPickSortByLabel:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickPickSortByLabel.d.ts"},resolvers:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.resolvers.d.ts"},scmActionButton:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmActionButton.d.ts"},scmHistoryProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmHistoryProvider.d.ts"},scmMultiDiffEditor:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmMultiDiffEditor.d.ts"},scmSelectedProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmSelectedProvider.d.ts"},scmTextDocument:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmTextDocument.d.ts"},scmValidation:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmValidation.d.ts"},shareProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.shareProvider.d.ts"},showLocal:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.showLocal.d.ts"},speech:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.speech.d.ts"},tabInputMultiDiff:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tabInputMultiDiff.d.ts"},tabInputTextMerge:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tabInputTextMerge.d.ts"},taskPresentationGroup:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.taskPresentationGroup.d.ts"},telemetry:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.telemetry.d.ts"},terminalDataWriteEvent:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalDataWriteEvent.d.ts"},terminalDimensions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalDimensions.d.ts"},terminalExecuteCommandEvent:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalExecuteCommandEvent.d.ts"},terminalQuickFixProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalQuickFixProvider.d.ts"},terminalSelection:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalSelection.d.ts"},testObserver:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.testObserver.d.ts"},testRelatedCode:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.testRelatedCode.d.ts"},textSearchCompleteNew:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textSearchCompleteNew.d.ts"},textSearchProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textSearchProvider.d.ts"},textSearchProviderNew:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textSearchProviderNew.d.ts"},timeline:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.timeline.d.ts"},tokenInformation:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tokenInformation.d.ts"},treeViewActiveItem:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.treeViewActiveItem.d.ts"},treeViewMarkdownMessage:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.treeViewMarkdownMessage.d.ts"},treeViewReveal:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.treeViewReveal.d.ts"},tunnelFactory:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tunnelFactory.d.ts"},tunnels:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tunnels.d.ts"},workspaceTrust:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.workspaceTrust.d.ts"}},yL=Object.freeze(YCe);var zti=q("IV8InspectProfilingService"),QCe;(e=>{function r(i){return!!(i.samples&&i.timeDeltas)}e.isValidProfile=r;function t(i,n="noAbsolutePaths"){for(let o of i.nodes)o.callFrame&&o.callFrame.url&&(ja(o.callFrame.url)||/^\w[\w\d+.-]*:\/\/\/?/.test(o.callFrame.url))&&(o.callFrame.url=cs(n,Eo(o.callFrame.url)));return i}e.rewriteAbsolutePaths=t})(QCe||={});var iii=q("remoteAuthorityResolverService");var U9=Pe.as(wd.JSONContribution);var B9=class r{constructor(t,e){this.added=t;this.removed=e}static _toSet(t){let e=new WD;for(let i=0,n=t.length;i<n;i++)e.add(t[i].description.identifier);return e}static compute(t,e){if(!t||!t.length)return new r(e,[]);if(!e||!e.length)return new r([],t);let i=this._toSet(t),n=this._toSet(e),o=e.filter(a=>!i.has(a.description.identifier)),s=t.filter(a=>!n.has(a.description.identifier));return new r(o,s)}},V9=class{name;defaultExtensionKind;_handler;_users;_delta;constructor(t,e){this.name=t,this.defaultExtensionKind=e,this._handler=null,this._users=null,this._delta=null}setHandler(t){if(this._handler!==null)throw new Error("Handler already set!");return this._handler=t,this._handle(),{dispose:()=>{this._handler=null}}}acceptUsers(t){this._delta=B9.compute(this._users,t),this._users=t,this._handle()}_handle(){if(!(this._handler===null||this._users===null||this._delta===null))try{this._handler(this._users,this._delta)}catch(t){Xe(t)}}},ZCe={type:"string",enum:["ui","workspace"],enumDescriptions:[u("ui","UI extension kind. In a remote window, such extensions are enabled only when available on the local machine."),u("workspace","Workspace extension kind. In a remote window, such extensions are enabled only when available on the remote.")]},Zle="vscode://schemas/vscode-extensions",W9={properties:{engines:{type:"object",description:u("vscode.extension.engines","Engine compatibility."),properties:{vscode:{type:"string",description:u("vscode.extension.engines.vscode","For VS Code extensions, specifies the VS Code version that the extension is compatible with. Cannot be *. For example: ^0.10.5 indicates compatibility with a minimum VS Code version of 0.10.5."),default:"^1.22.0"}}},publisher:{description:u("vscode.extension.publisher","The publisher of the VS Code extension."),type:"string"},displayName:{description:u("vscode.extension.displayName","The display name for the extension used in the VS Code gallery."),type:"string"},categories:{description:u("vscode.extension.categories","The categories used by the VS Code gallery to categorize the extension."),type:"array",uniqueItems:!0,items:{oneOf:[{type:"string",enum:Nie},{type:"string",const:"Languages",deprecationMessage:u("vscode.extension.category.languages.deprecated","Use 'Programming  Languages' instead")}]}},galleryBanner:{type:"object",description:u("vscode.extension.galleryBanner","Banner used in the VS Code marketplace."),properties:{color:{description:u("vscode.extension.galleryBanner.color","The banner color on the VS Code marketplace page header."),type:"string"},theme:{description:u("vscode.extension.galleryBanner.theme","The color theme for the font used in the banner."),type:"string",enum:["dark","light"]}}},contributes:{description:u("vscode.extension.contributes","All contributions of the VS Code extension represented by this package."),type:"object",properties:{},default:{}},preview:{type:"boolean",description:u("vscode.extension.preview","Sets the extension to be flagged as a Preview in the Marketplace.")},enableProposedApi:{type:"boolean",deprecationMessage:u("vscode.extension.enableProposedApi.deprecated","Use `enabledApiProposals` instead.")},enabledApiProposals:{markdownDescription:u("vscode.extension.enabledApiProposals","Enable API proposals to try them out. Only valid **during development**. Extensions **cannot be published** with this property. For more details visit: https://code.visualstudio.com/api/advanced-topics/using-proposed-api"),type:"array",uniqueItems:!0,items:{type:"string",enum:Object.keys(yL).map(r=>r),markdownEnumDescriptions:Object.values(yL).map(r=>r.proposal)}},api:{markdownDescription:u("vscode.extension.api","Describe the API provided by this extension. For more details visit: https://code.visualstudio.com/api/advanced-topics/remote-extensions#handling-dependencies-with-remote-extensions"),type:"string",enum:["none"],enumDescriptions:[u("vscode.extension.api.none","Give up entirely the ability to export any APIs. This allows other extensions that depend on this extension to run in a separate extension host process or in a remote machine.")]},activationEvents:{description:u("vscode.extension.activationEvents","Activation events for the VS Code extension."),type:"array",items:{type:"string",defaultSnippets:[{label:"onWebviewPanel",description:u("vscode.extension.activationEvents.onWebviewPanel","An activation event emmited when a webview is loaded of a certain viewType"),body:"onWebviewPanel:viewType"},{label:"onLanguage",description:u("vscode.extension.activationEvents.onLanguage","An activation event emitted whenever a file that resolves to the specified language gets opened."),body:"onLanguage:${1:languageId}"},{label:"onCommand",description:u("vscode.extension.activationEvents.onCommand","An activation event emitted whenever the specified command gets invoked."),body:"onCommand:${2:commandId}"},{label:"onDebug",description:u("vscode.extension.activationEvents.onDebug","An activation event emitted whenever a user is about to start debugging or about to setup debug configurations."),body:"onDebug"},{label:"onDebugInitialConfigurations",description:u("vscode.extension.activationEvents.onDebugInitialConfigurations",'An activation event emitted whenever a "launch.json" needs to be created (and all provideDebugConfigurations methods need to be called).'),body:"onDebugInitialConfigurations"},{label:"onDebugDynamicConfigurations",description:u("vscode.extension.activationEvents.onDebugDynamicConfigurations",'An activation event emitted whenever a list of all debug configurations needs to be created (and all provideDebugConfigurations methods for the "dynamic" scope need to be called).'),body:"onDebugDynamicConfigurations"},{label:"onDebugResolve",description:u("vscode.extension.activationEvents.onDebugResolve","An activation event emitted whenever a debug session with the specific type is about to be launched (and a corresponding resolveDebugConfiguration method needs to be called)."),body:"onDebugResolve:${6:type}"},{label:"onDebugAdapterProtocolTracker",description:u("vscode.extension.activationEvents.onDebugAdapterProtocolTracker","An activation event emitted whenever a debug session with the specific type is about to be launched and a debug protocol tracker might be needed."),body:"onDebugAdapterProtocolTracker:${6:type}"},{label:"workspaceContains",description:u("vscode.extension.activationEvents.workspaceContains","An activation event emitted whenever a folder is opened that contains at least a file matching the specified glob pattern."),body:"workspaceContains:${4:filePattern}"},{label:"onStartupFinished",description:u("vscode.extension.activationEvents.onStartupFinished","An activation event emitted after the start-up finished (after all `*` activated extensions have finished activating)."),body:"onStartupFinished"},{label:"onTaskType",description:u("vscode.extension.activationEvents.onTaskType","An activation event emitted whenever tasks of a certain type need to be listed or resolved."),body:"onTaskType:${1:taskType}"},{label:"onFileSystem",description:u("vscode.extension.activationEvents.onFileSystem","An activation event emitted whenever a file or folder is accessed with the given scheme."),body:"onFileSystem:${1:scheme}"},{label:"onEditSession",description:u("vscode.extension.activationEvents.onEditSession","An activation event emitted whenever an edit session is accessed with the given scheme."),body:"onEditSession:${1:scheme}"},{label:"onSearch",description:u("vscode.extension.activationEvents.onSearch","An activation event emitted whenever a search is started in the folder with the given scheme."),body:"onSearch:${7:scheme}"},{label:"onView",body:"onView:${5:viewId}",description:u("vscode.extension.activationEvents.onView","An activation event emitted whenever the specified view is expanded.")},{label:"onUri",body:"onUri",description:u("vscode.extension.activationEvents.onUri","An activation event emitted whenever a system-wide Uri directed towards this extension is open.")},{label:"onOpenExternalUri",body:"onOpenExternalUri",description:u("vscode.extension.activationEvents.onOpenExternalUri","An activation event emitted whenever a external uri (such as an http or https link) is being opened.")},{label:"onCustomEditor",body:"onCustomEditor:${9:viewType}",description:u("vscode.extension.activationEvents.onCustomEditor","An activation event emitted whenever the specified custom editor becomes visible.")},{label:"onNotebook",body:"onNotebook:${1:type}",description:u("vscode.extension.activationEvents.onNotebook","An activation event emitted whenever the specified notebook document is opened.")},{label:"onAuthenticationRequest",body:"onAuthenticationRequest:${11:authenticationProviderId}",description:u("vscode.extension.activationEvents.onAuthenticationRequest","An activation event emitted whenever sessions are requested from the specified authentication provider.")},{label:"onRenderer",description:u("vscode.extension.activationEvents.onRenderer","An activation event emitted whenever a notebook output renderer is used."),body:"onRenderer:${11:rendererId}"},{label:"onTerminalProfile",body:"onTerminalProfile:${1:terminalId}",description:u("vscode.extension.activationEvents.onTerminalProfile","An activation event emitted when a specific terminal profile is launched.")},{label:"onTerminalQuickFixRequest",body:"onTerminalQuickFixRequest:${1:quickFixId}",description:u("vscode.extension.activationEvents.onTerminalQuickFixRequest","An activation event emitted when a command matches the selector associated with this ID")},{label:"onWalkthrough",body:"onWalkthrough:${1:walkthroughID}",description:u("vscode.extension.activationEvents.onWalkthrough","An activation event emitted when a specified walkthrough is opened.")},{label:"onIssueReporterOpened",body:"onIssueReporterOpened",description:u("vscode.extension.activationEvents.onIssueReporterOpened","An activation event emitted when the issue reporter is opened.")},{label:"onChatParticipant",body:"onChatParticipant:${1:participantId}",description:u("vscode.extension.activationEvents.onChatParticipant","An activation event emitted when the specified chat participant is invoked.")},{label:"onLanguageModelTool",body:"onLanguageModelTool:${1:toolId}",description:u("vscode.extension.activationEvents.onLanguageModelTool","An activation event emitted when the specified language model tool is invoked.")},{label:"*",description:u("vscode.extension.activationEvents.star","An activation event emitted on VS Code startup. To ensure a great end user experience, please use this activation event in your extension only when no other activation events combination works in your use-case."),body:"*"}]}},badges:{type:"array",description:u("vscode.extension.badges","Array of badges to display in the sidebar of the Marketplace's extension page."),items:{type:"object",required:["url","href","description"],properties:{url:{type:"string",description:u("vscode.extension.badges.url","Badge image URL.")},href:{type:"string",description:u("vscode.extension.badges.href","Badge link.")},description:{type:"string",description:u("vscode.extension.badges.description","Badge description.")}}}},markdown:{type:"string",description:u("vscode.extension.markdown","Controls the Markdown rendering engine used in the Marketplace. Either github (default) or standard."),enum:["github","standard"],default:"github"},qna:{default:"marketplace",description:u("vscode.extension.qna","Controls the Q&A link in the Marketplace. Set to marketplace to enable the default Marketplace Q & A site. Set to a string to provide the URL of a custom Q & A site. Set to false to disable Q & A altogether."),anyOf:[{type:["string","boolean"],enum:["marketplace",!1]},{type:"string"}]},extensionDependencies:{description:u("vscode.extension.extensionDependencies","Dependencies to other extensions. The identifier of an extension is always ${publisher}.${name}. For example: vscode.csharp."),type:"array",uniqueItems:!0,items:{type:"string",pattern:KF}},extensionPack:{description:u("vscode.extension.contributes.extensionPack","A set of extensions that can be installed together. The identifier of an extension is always ${publisher}.${name}. For example: vscode.csharp."),type:"array",uniqueItems:!0,items:{type:"string",pattern:KF}},extensionKind:{description:u("extensionKind","Define the kind of an extension. `ui` extensions are installed and run on the local machine while `workspace` extensions run on the remote."),type:"array",items:ZCe,default:["workspace"],defaultSnippets:[{body:["ui"],description:u("extensionKind.ui","Define an extension which can run only on the local machine when connected to remote window.")},{body:["workspace"],description:u("extensionKind.workspace","Define an extension which can run only on the remote machine when connected remote window.")},{body:["ui","workspace"],description:u("extensionKind.ui-workspace","Define an extension which can run on either side, with a preference towards running on the local machine.")},{body:["workspace","ui"],description:u("extensionKind.workspace-ui","Define an extension which can run on either side, with a preference towards running on the remote machine.")},{body:[],description:u("extensionKind.empty","Define an extension which cannot run in a remote context, neither on the local, nor on the remote machine.")}]},capabilities:{description:u("vscode.extension.capabilities","Declare the set of supported capabilities by the extension."),type:"object",properties:{virtualWorkspaces:{description:u("vscode.extension.capabilities.virtualWorkspaces","Declares whether the extension should be enabled in virtual workspaces. A virtual workspace is a workspace which is not backed by any on-disk resources. When false, this extension will be automatically disabled in virtual workspaces. Default is true."),type:["boolean","object"],defaultSnippets:[{label:"limited",body:{supported:"${1:limited}",description:"${2}"}},{label:"false",body:{supported:!1,description:"${2}"}}],default:(!0).valueOf,properties:{supported:{markdownDescription:u("vscode.extension.capabilities.virtualWorkspaces.supported","Declares the level of support for virtual workspaces by the extension."),type:["string","boolean"],enum:["limited",!0,!1],enumDescriptions:[u("vscode.extension.capabilities.virtualWorkspaces.supported.limited","The extension will be enabled in virtual workspaces with some functionality disabled."),u("vscode.extension.capabilities.virtualWorkspaces.supported.true","The extension will be enabled in virtual workspaces with all functionality enabled."),u("vscode.extension.capabilities.virtualWorkspaces.supported.false","The extension will not be enabled in virtual workspaces.")]},description:{type:"string",markdownDescription:u("vscode.extension.capabilities.virtualWorkspaces.description","A description of how virtual workspaces affects the extensions behavior and why it is needed. This only applies when `supported` is not `true`.")}}},untrustedWorkspaces:{description:u("vscode.extension.capabilities.untrustedWorkspaces","Declares how the extension should be handled in untrusted workspaces."),type:"object",required:["supported"],defaultSnippets:[{body:{supported:"${1:limited}",description:"${2}"}}],properties:{supported:{markdownDescription:u("vscode.extension.capabilities.untrustedWorkspaces.supported","Declares the level of support for untrusted workspaces by the extension."),type:["string","boolean"],enum:["limited",!0,!1],enumDescriptions:[u("vscode.extension.capabilities.untrustedWorkspaces.supported.limited","The extension will be enabled in untrusted workspaces with some functionality disabled."),u("vscode.extension.capabilities.untrustedWorkspaces.supported.true","The extension will be enabled in untrusted workspaces with all functionality enabled."),u("vscode.extension.capabilities.untrustedWorkspaces.supported.false","The extension will not be enabled in untrusted workspaces.")]},restrictedConfigurations:{description:u("vscode.extension.capabilities.untrustedWorkspaces.restrictedConfigurations","A list of configuration keys contributed by the extension that should not use workspace values in untrusted workspaces."),type:"array",items:{type:"string"}},description:{type:"string",markdownDescription:u("vscode.extension.capabilities.untrustedWorkspaces.description","A description of how workspace trust affects the extensions behavior and why it is needed. This only applies when `supported` is not `true`.")}}}}},sponsor:{description:u("vscode.extension.contributes.sponsor","Specify the location from where users can sponsor your extension."),type:"object",defaultSnippets:[{body:{url:"${1:https:}"}}],properties:{url:{description:u("vscode.extension.contributes.sponsor.url","URL from where users can sponsor your extension. It must be a valid URL with a HTTP or HTTPS protocol. Example value: https://github.com/sponsors/nvaccess"),type:"string"}}},scripts:{type:"object",properties:{"vscode:prepublish":{description:u("vscode.extension.scripts.prepublish","Script executed before the package is published as a VS Code extension."),type:"string"},"vscode:uninstall":{description:u("vscode.extension.scripts.uninstall","Uninstall hook for VS Code extension. Script that gets executed when the extension is completely uninstalled from VS Code which is when VS Code is restarted (shutdown and start) after the extension is uninstalled. Only Node scripts are supported."),type:"string"}}},icon:{type:"string",description:u("vscode.extension.icon","The path to a 128x128 pixel icon.")},l10n:{type:"string",description:u({key:"vscode.extension.l10n",comment:['{Locked="bundle.l10n._locale_.json"}','{Locked="vscode.l10n API"}']},"The relative path to a folder containing localization (bundle.l10n.*.json) files. Must be specified if you are using the vscode.l10n API.")},pricing:{type:"string",markdownDescription:u("vscode.extension.pricing","The pricing information for the extension. Can be Free (default) or Trial. For more details visit: https://code.visualstudio.com/api/working-with-extensions/publishing-extension#extension-pricing-label"),enum:["Free","Trial"],default:"Free"}}},H9=class{_extensionPoints=new Map;registerExtensionPoint(t){if(this._extensionPoints.has(t.extensionPoint))throw new Error("Duplicate extension point: "+t.extensionPoint);let e=new V9(t.extensionPoint,t.defaultExtensionKind);return this._extensionPoints.set(t.extensionPoint,e),t.activationEventsGenerator&&F9.register(t.extensionPoint,t.activationEventsGenerator),W9.properties.contributes.properties[t.extensionPoint]=t.jsonSchema,U9.registerSchema(Zle,W9),e}getExtensionPoints(){return Array.from(this._extensionPoints.values())}},Jle={ExtensionsRegistry:"ExtensionsRegistry"};Pe.add(Jle.ExtensionsRegistry,new H9);var Ra=Pe.as(Jle.ExtensionsRegistry);U9.registerSchema(Zle,W9);U9.registerSchema(kse,{properties:{extensionEnabledApiProposals:{description:u("product.extensionEnabledApiProposals","API proposals that the respective extensions can freely use."),type:"object",properties:{},additionalProperties:{anyOf:[{type:"array",uniqueItems:!0,items:{type:"string",enum:Object.keys(yL),markdownEnumDescriptions:Object.values(yL).map(r=>r.proposal)}}]}}}});var bni=Object.freeze({identifier:new Qr("nullExtensionDescription"),name:"Null Extension Description",version:"0.0.0",publisher:"vscode",engines:{vscode:""},extensionLocation:Z.parse("void:location"),isBuiltin:!1,targetPlatform:"undefined",isUserBuiltin:!1,isUnderDevelopment:!1});var _n=q("extensionService");function ede(r,t){return r.enabledApiProposals?r.enabledApiProposals.includes(t):!1}var GF=class extends ch{constantViewDescriptors=new Map;allViews=new Map;filterValue;constructor(t,e,i,n,o,s,a,l,d,c,p,h){super(t,{mergeViewWithContainerWhenSingleView:!1},a,i,n,d,o,c,l,s,p,h),this._register(e(m=>{this.filterValue=m,this.onFilterChanged(m)})),this._register(this.viewContainerModel.onDidChangeActiveViewDescriptors(()=>{this.updateAllViews(this.viewContainerModel.activeViewDescriptors)}))}updateAllViews(t){t.forEach(e=>{let i=this.getFilterOn(e);i&&(this.allViews.has(i)||this.allViews.set(i,new Map),this.allViews.get(i).set(e.id,e),this.filterValue&&!this.filterValue.includes(i)&&this.panes.find(n=>n.id===e.id)&&this.viewContainerModel.setVisible(e.id,!1))})}addConstantViewDescriptors(t){t.forEach(e=>this.constantViewDescriptors.set(e.id,e))}onFilterChanged(t){this.allViews.size===0&&this.updateAllViews(this.viewContainerModel.activeViewDescriptors),this.getViewsNotForTarget(t).forEach(e=>this.viewContainerModel.setVisible(e.id,!1)),this.getViewsForTarget(t).forEach(e=>this.viewContainerModel.setVisible(e.id,!0))}getViewsForTarget(t){let e=[];for(let i=0;i<t.length;i++)this.allViews.has(t[i])&&e.push(...Array.from(this.allViews.get(t[i]).values()));return e}getViewsNotForTarget(t){let e=this.allViews.keys(),i=e.next(),n=[];for(;!i.done;){let o=!1;t.forEach(s=>{i.value===s&&(o=!0)}),o||(n=n.concat(this.getViewsForTarget([i.value]))),i=e.next()}return n}onDidAddViewDescriptors(t){let e=super.onDidAddViewDescriptors(t);for(let i=0;i<t.length;i++)this.constantViewDescriptors.has(t[i].viewDescriptor.id)&&e[i].setExpanded(!1);return this.allViews.size===0&&this.updateAllViews(this.viewContainerModel.activeViewDescriptors),e}openView(t,e){let i=super.openView(t,e);if(i){let n=Array.from(this.allViews.entries()).find(o=>o[1].has(t));n&&!this.filterValue?.includes(n[0])&&this.setFilter(n[1].get(t))}return i}};GF=E([b(2,se),b(3,ii),b(4,Tt),b(5,nt),b(6,ne),b(7,Fe),b(8,vt),b(9,_n),b(10,kt),b(11,$i)],GF);var ewe="diagnosticsService",aoi=q(ewe);var twe;(s=>{s.enableDiagnostics=!1,s.records=[];let e=new WeakMap,i=0;function n(a,l){if(!e.has(a)){let d=String(++i);e.set(a,d)}return e.get(a)}function o(a,l,d,c){}s.traceSocketEvent=o})(twe||={});var Doi=q("remoteSocketFactoryService");var iwe="signService",Roi=q(iwe);var lri=30*1e3;var qF=q("remoteAgentService"),Dri=new class{maxSampleCount=5;sampleDelay=2e3;initial=[];maxInitialCount=3;average=[];maxAverageCount=100;highLatencyMultiple=2;highLatencyMinThreshold=500;highLatencyMaxThreshold=1500;lastMeasurement=void 0;get latency(){return this.lastMeasurement}async measure(r){let t=1/0;for(let i=0;i<this.maxSampleCount;i++){let n=await r.getRoundTripTime();if(n===void 0)return;t=Math.min(t,n/2),await To(this.sampleDelay)}this.average.push(t),this.average.length>this.maxAverageCount&&this.average.shift();let e;return this.initial.length<this.maxInitialCount?this.initial.push(t):e=this.initial.reduce((i,n)=>i+n,0)/this.initial.length,this.lastMeasurement={initial:e,current:t,average:this.average.reduce((i,n)=>i+n,0)/this.average.length,high:typeof e>"u"?!1:t>this.highLatencyMaxThreshold||t>this.highLatencyMinThreshold&&t>e*this.highLatencyMultiple},this.lastMeasurement}};var Jri=Object.freeze({id:"application",order:100,title:u("applicationConfigurationTitle","Application"),type:"object"}),K9=Object.freeze({id:"workbench",order:7,title:u("workbenchConfigurationTitle","Workbench"),type:"object"}),nwe=Object.freeze({id:"security",scope:1,title:u("securityConfigurationTitle","Security"),type:"object",order:7}),esi=Object.freeze({id:"problems",title:u("problemsConfigurationTitle","Problems"),type:"object",order:101}),owe=Object.freeze({id:"window",order:8,title:u("windowConfigurationTitle","Window"),type:"object"}),Nd={ConfigurationMigration:"base.contributions.configuration.migration"},z9=class{migrations=[];_onDidRegisterConfigurationMigrations=new x;onDidRegisterConfigurationMigration=this._onDidRegisterConfigurationMigrations.event;registerConfigurationMigrations(t){this.migrations.push(...t)}},YF=new z9;Pe.add(Nd.ConfigurationMigration,YF);var $F=class extends R{constructor(e,i){super();this.configurationService=e;this.workspaceService=i;this._register(this.workspaceService.onDidChangeWorkspaceFolders(async n=>{for(let o of n.added)await this.migrateConfigurationsForFolder(o,YF.migrations)})),this.migrateConfigurations(YF.migrations),this._register(YF.onDidRegisterConfigurationMigration(n=>this.migrateConfigurations(n)))}static ID="workbench.contrib.configurationMigration";async migrateConfigurations(e){await this.migrateConfigurationsForFolder(void 0,e);for(let i of this.workspaceService.getWorkspace().folders)await this.migrateConfigurationsForFolder(i,e)}async migrateConfigurationsForFolder(e,i){await Promise.all([i.map(n=>this.migrateConfigurationsForFolderAndOverride(n,e?.uri))])}async migrateConfigurationsForFolderAndOverride(e,i){let n=this.configurationService.inspect(e.key,{resource:i}),o=this.workspaceService.getWorkbenchState()===3?[["user",2],["userLocal",3],["userRemote",4],["workspace",5],["workspaceFolder",6]]:[["user",2],["userLocal",3],["userRemote",4],["workspace",5]];for(let[s,a]of o){let l=n[s];if(!l)continue;let d=[];if(l.value!==void 0){let c=await this.runMigration(e,s,l.value,i,void 0);for(let p of c??[])d.push([p,[]])}for(let{identifiers:c,value:p}of l.overrides??[])if(p!==void 0){let h=await this.runMigration(e,s,p,i,c);for(let m of h??[])d.push([m,c])}d.length&&await Promise.allSettled(d.map(async([[c,p],h])=>this.configurationService.updateValue(c,p.value,{resource:i,overrideIdentifiers:h},a)))}}async runMigration(e,i,n,o,s){let a=d=>{let p=this.configurationService.inspect(d,{resource:o})[i];if(p)return s?p.overrides?.find(({identifiers:h})=>sn(h,s))?.value:p.value},l=await e.migrateFn(n,a);return Array.isArray(l)?l:[[e.key,l]]}};$F=E([b(0,se),b(1,kt)],$F);var jF=class extends R{constructor(e){super();this.remoteAgentService=e;this.create()}static ID="workbench.contrib.dynamicWorkbenchSecurityConfiguration";_ready=new Kr;ready=this._ready.p;async create(){try{await this.doCreate()}finally{this._ready.complete()}}async doCreate(){if(!St&&(await this.remoteAgentService.getEnvironment())?.os!==1)return;Pe.as(ur.Configuration).registerConfiguration({...nwe,properties:{"security.allowedUNCHosts":{type:"array",items:{type:"string",pattern:"^[^\\\\]+$",patternErrorMessage:u("security.allowedUNCHosts.patternErrorMessage","UNC host names must not contain backslashes.")},default:[],markdownDescription:u("security.allowedUNCHosts","A set of UNC host names (without leading or trailing backslash, for example `192.168.0.1` or `my-server`) to allow without user confirmation. If a UNC host is being accessed that is not allowed via this setting or has not been acknowledged via user confirmation, an error will occur and the operation stopped. A restart is required when changing this setting. Find out more about this setting at https://aka.ms/vscode-windows-unc."),scope:2},"security.restrictUNCAccess":{type:"boolean",default:!0,markdownDescription:u("security.restrictUNCAccess","If enabled, only allows access to UNC host names that are allowed by the `#security.allowedUNCHosts#` setting or after user confirmation. Find out more about this setting at https://aka.ms/vscode-windows-unc."),scope:2}}})}};jF=E([b(0,qF)],jF);var SL="window.newWindowProfile",XF=class extends R{constructor(e,i){super();this.userDataProfilesService=e;this.configurationService=i;this.registerNewWindowProfileConfiguration(),this._register(this.userDataProfilesService.onDidChangeProfiles(n=>this.registerNewWindowProfileConfiguration())),this.setNewWindowProfile(),this.checkAndResetNewWindowProfileConfig(),this._register(i.onDidChangeConfiguration(n=>{n.source!==7&&n.affectsConfiguration(SL)&&this.setNewWindowProfile()})),this._register(this.userDataProfilesService.onDidChangeProfiles(()=>this.checkAndResetNewWindowProfileConfig()))}static ID="workbench.contrib.dynamicWindowConfiguration";configurationNode;newWindowProfile;registerNewWindowProfileConfiguration(){let e=Pe.as(ur.Configuration),i={...owe,properties:{[SL]:{type:["string","null"],default:null,enum:[...this.userDataProfilesService.profiles.map(n=>n.name),null],enumItemLabels:[...this.userDataProfilesService.profiles.map(n=>""),u("active window","Active Window")],description:u("newWindowProfile","Specifies the profile to use when opening a new window. If a profile name is provided, the new window will use that profile. If no profile name is provided, the new window will use the profile of the active window or the Default profile if no active window exists."),scope:1}}};this.configurationNode?e.updateConfigurations({add:[i],remove:[this.configurationNode]}):e.registerConfiguration(i),this.configurationNode=i}setNewWindowProfile(){let e=this.configurationService.getValue(SL);this.newWindowProfile=e?this.userDataProfilesService.profiles.find(i=>i.name===e):void 0}checkAndResetNewWindowProfileConfig(){let e=this.configurationService.getValue(SL);if(!e)return;let i=this.newWindowProfile?this.userDataProfilesService.profiles.find(n=>n.id===this.newWindowProfile.id):void 0;e!==i?.name&&this.configurationService.updateValue(SL,i?.name)}};XF=E([b(0,Pse),b(1,se)],XF);var Zw=q("editorResolverService");var rwe=Pe.as(ur.Configuration),swe={...K9,properties:{"workbench.editorAssociations":{type:"object",markdownDescription:u("editor.editorAssociations",'Configure [glob patterns](https://aka.ms/vscode-glob-patterns) to editors (for example `"*.hex": "hexEditor.hexedit"`). These have precedence over the default behavior.'),additionalProperties:{type:"string"}}}};rwe.registerConfiguration(swe);var Pa=new A("workbenchState",void 0,{type:"string",description:u("workbenchState","The kind of workspace opened in the window, either 'empty' (no workspace), 'folder' (single folder) or 'workspace' (multi-root workspace)")}),tde=new A("workspaceFolderCount",0,u("workspaceFolderCount","The number of root folders in the workspace")),YI=new A("openFolderWorkspaceSupport",!0,!0),uh=new A("enterMultiRootWorkspaceSupport",!0,!0),QF=new A("emptyWorkspaceSupport",!0,!0),eai=new A("dirtyWorkingCopies",!1,u("dirtyWorkingCopies","Whether there are any working copies with unsaved changes")),tai=new A("remoteName","",u("remoteName","The name of the remote the window is connected to or an empty string if not connected to any remote")),iai=new A("virtualWorkspace","",u("virtualWorkspace","The scheme of the current workspace is from a virtual file system or an empty string.")),nai=new A("temporaryWorkspace",!1,u("temporaryWorkspace","The scheme of the current workspace is from a temporary file system.")),ku=new A("isFullscreen",!1,u("isFullscreen","Whether the main window is in fullscreen mode")),jl=new A("isAuxiliaryWindowFocusedContext",!1,u("isAuxiliaryWindowFocusedContext","Whether an auxiliary window is focused")),oai=new A("hasWebFileSystemAccess",!1,!0),rai=new A("embedderIdentifier",void 0,u("embedderIdentifier","The identifier of the embedder according to the product service, if one is defined")),sai=new A("activeEditorIsDirty",!1,u("activeEditorIsDirty","Whether the active editor has unsaved changes")),ide=new A("activeEditorIsNotPreview",!1,u("activeEditorIsNotPreview","Whether the active editor is not in preview mode")),nde=new A("activeEditorIsFirstInGroup",!1,u("activeEditorIsFirstInGroup","Whether the active editor is the first one in its group")),ode=new A("activeEditorIsLastInGroup",!1,u("activeEditorIsLastInGroup","Whether the active editor is the last one in its group")),G9=new A("activeEditorIsPinned",!1,u("activeEditorIsPinned","Whether the active editor is pinned")),aai=new A("activeEditorIsReadonly",!1,u("activeEditorIsReadonly","Whether the active editor is read-only")),awe=new A("activeCompareEditorCanSwap",!1,u("activeCompareEditorCanSwap","Whether the active compare editor can swap sides")),lai=new A("activeEditorCanToggleReadonly",!0,u("activeEditorCanToggleReadonly","Whether the active editor can toggle between being read-only or writeable")),dai=new A("activeEditorCanRevert",!1,u("activeEditorCanRevert","Whether the active editor can revert")),q9=new A("activeEditorCanSplitInGroup",!0),$9=new A("activeEditor",null,{type:"string",description:u("activeEditor","The identifier of the active editor")}),j9=new A("activeEditorAvailableEditorIds","",u("activeEditorAvailableEditorIds","The available editor identifiers that are usable for the active editor")),lwe=new A("textCompareEditorVisible",!1,u("textCompareEditorVisible","Whether a text compare editor is visible")),rde=new A("textCompareEditorActive",!1,u("textCompareEditorActive","Whether a text compare editor is active")),X9=new A("sideBySideEditorActive",!1,u("sideBySideEditorActive","Whether a side by side editor is active")),cai=new A("groupEditorsCount",0,u("groupEditorsCount","The number of opened editor groups")),sde=new A("activeEditorGroupEmpty",!1,u("activeEditorGroupEmpty","Whether the active editor group is empty")),uai=new A("activeEditorGroupIndex",0,u("activeEditorGroupIndex","The index of the active editor group")),pai=new A("activeEditorGroupLast",!1,u("activeEditorGroupLast","Whether the active editor group is the last group")),Y9=new A("activeEditorGroupLocked",!1,u("activeEditorGroupLocked","Whether the active editor group is locked")),Q9=new A("multipleEditorGroups",!1,u("multipleEditorGroups","Whether there are multiple editor groups opened")),hai=Q9.toNegated(),mai=new A("multipleEditorsSelectedInGroup",!1,u("multipleEditorsSelectedInGroup","Whether multiple editors have been selected in an editor group")),gai=new A("twoEditorsSelectedInGroup",!1,u("twoEditorsSelectedInGroup","Whether exactly two editors have been selected in an editor group")),fai=new A("SelectedEditorsInGroupFileOrUntitledResourceContextKey",!0,u("SelectedEditorsInGroupFileOrUntitledResourceContextKey","Whether all selected editors in a group have a file or untitled resource associated")),ade=new A("editorPartMultipleEditorGroups",!1,u("editorPartMultipleEditorGroups","Whether there are multiple editor groups opened in an editor part")),bai=ade.toNegated(),dwe=new A("editorPartMaximizedEditorGroup",!1,u("editorPartEditorGroupMaximized","Editor Part has a maximized group")),vai=new A("isAuxiliaryEditorPart",!1,u("isAuxiliaryEditorPart","Editor Part is in an auxiliary window")),Iai=new A("editorIsOpen",!1,u("editorIsOpen","Whether an editor is open")),Fd=new A("inZenMode",!1,u("inZenMode","Whether Zen mode is enabled")),Z9=new A("isCenteredLayout",!1,u("isMainEditorCenteredLayout","Whether centered layout is enabled for the main editor")),yai=new A("splitEditorsVertically",!1,u("splitEditorsVertically","Whether editors split vertically")),lde=new A("mainEditorAreaVisible",!0,u("mainEditorAreaVisible","Whether the editor area in the main window is visible")),Sai=new A("editorTabsVisible",!0,u("editorTabsVisible","Whether editor tabs are visible")),db=new A("sideBarVisible",!1,u("sideBarVisible","Whether the sidebar is visible")),dde=new A("sideBarFocus",!1,u("sideBarFocus","Whether the sidebar has keyboard focus")),Cai=new A("activeViewlet","",u("activeViewlet","The identifier of the active viewlet")),cb=new A("statusBarFocused",!1,u("statusBarFocused","Whether the status bar has keyboard focus")),Jw=new A("titleBarStyle",ci?"native":"custom",u("titleBarStyle","Style of the window title bar")),CL=new A("titleBarVisible",!1,u("titleBarVisible","Whether the title bar is visible")),wai=new A("bannerFocused",!1,u("bannerFocused","Whether the banner has keyboard focus")),Eai=new A("notificationFocus",!0,u("notificationFocus","Whether a notification has keyboard focus")),xai=new A("notificationCenterVisible",!1,u("notificationCenterVisible","Whether the notifications center is visible")),Tai=new A("notificationToastsVisible",!1,u("notificationToastsVisible","Whether a notification toast is visible")),_ai=new A("activeAuxiliary","",u("activeAuxiliary","The identifier of the active auxiliary panel")),Dai=new A("auxiliaryBarFocus",!1,u("auxiliaryBarFocus","Whether the auxiliary bar has keyboard focus")),ph=new A("auxiliaryBarVisible",!1,u("auxiliaryBarVisible","Whether the auxiliary bar is visible")),kai=new A("activePanel","",u("activePanel","The identifier of the active panel")),wL=new A("panelFocus",!1,u("panelFocus","Whether the panel has keyboard focus")),ub=new A("panelPosition","bottom",u("panelPosition","The position of the panel, always 'bottom'")),hh=new A("panelAlignment","center",u("panelAlignment","The alignment of the panel, either 'center', 'left', 'right' or 'justify'")),QI=new A("panelVisible",!1,u("panelVisible","Whether the panel is visible")),cde=new A("panelMaximized",!1,u("panelMaximized","Whether the panel is maximized")),Ks=new A("focusedView","",u("focusedView","The identifier of the view that has keyboard focus"));var zs=class{constructor(t,e,i,n){this._contextKeyService=t;this._fileService=e;this._languageService=i;this._modelService=n;this._schemeKey=zs.Scheme.bindTo(this._contextKeyService),this._filenameKey=zs.Filename.bindTo(this._contextKeyService),this._dirnameKey=zs.Dirname.bindTo(this._contextKeyService),this._pathKey=zs.Path.bindTo(this._contextKeyService),this._langIdKey=zs.LangId.bindTo(this._contextKeyService),this._resourceKey=zs.Resource.bindTo(this._contextKeyService),this._extensionKey=zs.Extension.bindTo(this._contextKeyService),this._hasResource=zs.HasResource.bindTo(this._contextKeyService),this._isFileSystemResource=zs.IsFileSystemResource.bindTo(this._contextKeyService),this._disposables.add(e.onDidChangeFileSystemProviderRegistrations(()=>{let o=this.get();this._isFileSystemResource.set(!!(o&&e.hasProvider(o)))})),this._disposables.add(n.onModelAdded(o=>{zi(o.uri,this.get())&&this._setLangId()})),this._disposables.add(n.onModelLanguageChanged(o=>{zi(o.model.uri,this.get())&&this._setLangId()}))}static Scheme=new A("resourceScheme",void 0,{type:"string",description:u("resourceScheme","The scheme of the resource")});static Filename=new A("resourceFilename",void 0,{type:"string",description:u("resourceFilename","The file name of the resource")});static Dirname=new A("resourceDirname",void 0,{type:"string",description:u("resourceDirname","The folder name the resource is contained in")});static Path=new A("resourcePath",void 0,{type:"string",description:u("resourcePath","The full path of the resource")});static LangId=new A("resourceLangId",void 0,{type:"string",description:u("resourceLangId","The language identifier of the resource")});static Resource=new A("resource",void 0,{type:"URI",description:u("resource","The full value of the resource including scheme and path")});static Extension=new A("resourceExtname",void 0,{type:"string",description:u("resourceExtname","The extension name of the resource")});static HasResource=new A("resourceSet",void 0,{type:"boolean",description:u("resourceSet","Whether a resource is present or not")});static IsFileSystemResource=new A("isFileSystemResource",void 0,{type:"boolean",description:u("isFileSystemResource","Whether the resource is backed by a file system provider")});_disposables=new B;_value;_resourceKey;_schemeKey;_filenameKey;_dirnameKey;_pathKey;_langIdKey;_extensionKey;_hasResource;_isFileSystemResource;dispose(){this._disposables.dispose()}_setLangId(){let t=this.get();if(!t){this._langIdKey.set(null);return}let e=this._modelService.getModel(t)?.getLanguageId()??this._languageService.guessLanguageIdByFilepathOrFirstLine(t);this._langIdKey.set(e)}set(t){t=t??void 0,!zi(this._value,t)&&(this._value=t,this._contextKeyService.bufferChangeEvents(()=>{this._resourceKey.set(t?t.toString():null),this._schemeKey.set(t?t.scheme:null),this._filenameKey.set(t?Ji(t):null),this._dirnameKey.set(t?this.uriToPath(Hn(t)):null),this._pathKey.set(t?this.uriToPath(t):null),this._setLangId(),this._extensionKey.set(t?Sm(t):null),this._hasResource.set(!!t),this._isFileSystemResource.set(t?this._fileService.hasProvider(t):!1)}))}uriToPath(t){return t.scheme===Ie.file?t.fsPath:t.path}reset(){this._value=void 0,this._contextKeyService.bufferChangeEvents(()=>{this._resourceKey.reset(),this._schemeKey.reset(),this._filenameKey.reset(),this._dirnameKey.reset(),this._pathKey.reset(),this._langIdKey.reset(),this._extensionKey.reset(),this._hasResource.reset(),this._isFileSystemResource.reset()})}get(){return this._value}};zs=E([b(0,re),b(1,Ei),b(2,ti),b(3,qi)],zs);function ude(r,t,e){if(!t){r.set("");return}let i=t.resource;if(i?.scheme===Ie.untitled&&t.editorId!==uw.id)r.set("");else{let n=i?e.getEditors(i).map(o=>o.id):[];r.set(n.join(","))}}var TL=new V("Views");Ue.appendMenuItem(V.ViewContainerTitle,{submenu:TL,title:u("views","Views"),order:1});var eE=class r extends fc{constructor(e,i,n,o,s){super(s);this.paneElement=e;this.orientation=i;this.bounds=n;this.location=o;this.cleanupOverlayScheduler=this._register(new Ye(()=>this.dispose(),300)),this.create()}static OVERLAY_ID="monaco-pane-drop-overlay";container;overlay;_currentDropOperation;_disposed;cleanupOverlayScheduler;get currentDropOperation(){return this._currentDropOperation}get disposed(){return!!this._disposed}create(){this.container=document.createElement("div"),this.container.id=r.OVERLAY_ID,this.container.style.top="0px",this.paneElement.appendChild(this.container),this.paneElement.classList.add("dragged-over"),this._register(le(()=>{this.container.remove(),this.paneElement.classList.remove("dragged-over")})),this.overlay=document.createElement("div"),this.overlay.classList.add("pane-overlay-indicator"),this.container.appendChild(this.overlay),this.registerListeners(),this.updateStyles()}updateStyles(){this.overlay.style.backgroundColor=this.getColor(this.location===1?x9:T9)||"";let e=this.getColor(fi);this.overlay.style.outlineColor=e||"",this.overlay.style.outlineOffset=e?"-2px":"",this.overlay.style.outlineStyle=e?"dashed":"",this.overlay.style.outlineWidth=e?"2px":"",this.overlay.style.borderColor=e||"",this.overlay.style.borderStyle="solid",this.overlay.style.borderWidth="0px"}registerListeners(){this._register(new wl(this.container,{onDragOver:e=>{this.positionOverlay(e.offsetX,e.offsetY),this.cleanupOverlayScheduler.isScheduled()&&this.cleanupOverlayScheduler.cancel()},onDragLeave:e=>this.dispose(),onDragEnd:e=>this.dispose(),onDrop:e=>{this.dispose()}})),this._register(F(this.container,Q.MOUSE_OVER,()=>{this.cleanupOverlayScheduler.isScheduled()||this.cleanupOverlayScheduler.schedule()}))}positionOverlay(e,i){let n=this.paneElement.clientWidth,o=this.paneElement.clientHeight,s=n/2,a=o/2,l;switch(this.orientation===0?i<a?l=0:i>=a&&(l=1):this.orientation===1&&(e<s?l=2:e>=s&&(l=3)),l){case 0:this.doPositionOverlay({top:"0",left:"0",width:"100%",height:"50%"});break;case 1:this.doPositionOverlay({bottom:"0",left:"0",width:"100%",height:"50%"});break;case 2:this.doPositionOverlay({top:"0",left:"0",width:"50%",height:"100%"});break;case 3:this.doPositionOverlay({top:"0",right:"0",width:"50%",height:"100%"});break;default:{let d="0",c="0",p="100%",h="100%";if(this.bounds){let m=this.container.getBoundingClientRect();d=`${this.bounds.top-m.top}px`,c=`${this.bounds.left-m.left}px`,h=`${this.bounds.bottom-this.bounds.top}px`,p=`${this.bounds.right-this.bounds.left}px`}this.doPositionOverlay({top:d,left:c,width:p,height:h})}}this.orientation===0&&o<=25||this.orientation===1&&n<=25?this.doUpdateOverlayBorder(l):this.doUpdateOverlayBorder(void 0),this.overlay.style.opacity="1",setTimeout(()=>this.overlay.classList.add("overlay-move-transition"),0),this._currentDropOperation=l}doUpdateOverlayBorder(e){this.overlay.style.borderTopWidth=e===0?"2px":"0px",this.overlay.style.borderLeftWidth=e===2?"2px":"0px",this.overlay.style.borderBottomWidth=e===1?"2px":"0px",this.overlay.style.borderRightWidth=e===3?"2px":"0px"}doPositionOverlay(e){this.container.style.height="100%",this.overlay.style.top=e.top||"",this.overlay.style.left=e.left||"",this.overlay.style.bottom=e.bottom||"",this.overlay.style.right=e.right||"",this.overlay.style.width=e.width,this.overlay.style.height=e.height}contains(e){return e===this.container||e===this.overlay}dispose(){super.dispose(),this._disposed=!0}},EL=class extends nb{constructor(t,e,i,n,o){let s=n.createScoped(t);s.createKey("viewContainer",e.id);let a=s.createKey("viewContainerLocation",Es(i.getViewContainerLocation(e)));super(V.ViewContainerTitle,V.ViewContainerTitleContext,{shouldForwardArgs:!0,renderShortTitle:!0},s,o),this._register(s),this._register(X.filter(i.onDidChangeContainerLocation,l=>l.viewContainer===e)(()=>a.set(Es(i.getViewContainerLocation(e)))))}};EL=E([b(2,$i),b(3,re),b(4,jt)],EL);var ch=class extends Xm{constructor(e,i,n,o,s,a,l,d,c,p,h,m){super(e,c,p);this.options=i;this.instantiationService=n;this.configurationService=o;this.layoutService=s;this.contextMenuService=a;this.telemetryService=l;this.extensionService=d;this.storageService=p;this.contextService=h;this.viewDescriptorService=m;let f=this.viewDescriptorService.getViewContainerById(e);if(!f)throw new Error("Could not find container");this.viewContainer=f,this.visibleViewsStorageId=`${e}.numberOfVisibleViews`,this.visibleViewsCountFromCache=this.storageService.getNumber(this.visibleViewsStorageId,1,void 0),this.viewContainerModel=this.viewDescriptorService.getViewContainerModel(f)}viewContainer;lastFocusedPane;lastMergedCollapsedPane;paneItems=[];paneview;visible=!1;areExtensionsReady=!1;didLayout=!1;dimension;_boundarySashes;visibleViewsCountFromCache;visibleViewsStorageId;viewContainerModel;_onTitleAreaUpdate=this._register(new x);onTitleAreaUpdate=this._onTitleAreaUpdate.event;_onDidChangeVisibility=this._register(new x);onDidChangeVisibility=this._onDidChangeVisibility.event;_onDidAddViews=this._register(new x);onDidAddViews=this._onDidAddViews.event;_onDidRemoveViews=this._register(new x);onDidRemoveViews=this._onDidRemoveViews.event;_onDidChangeViewVisibility=this._register(new x);onDidChangeViewVisibility=this._onDidChangeViewVisibility.event;_onDidFocusView=this._register(new x);onDidFocusView=this._onDidFocusView.event;_onDidBlurView=this._register(new x);onDidBlurView=this._onDidBlurView.event;get onDidSashChange(){return Yt(this.paneview).onDidSashChange}get panes(){return this.paneItems.map(e=>e.pane)}get views(){return this.panes}get length(){return this.paneItems.length}_menuActions;get menuActions(){return this._menuActions}create(e){let i=this.options;i.orientation=this.orientation,this.paneview=this._register(new z1(e,this.options)),this._boundarySashes&&this.paneview.setBoundarySashes(this._boundarySashes),this._register(this.paneview.onDidDrop(({from:d,to:c})=>this.movePane(d,c))),this._register(this.paneview.onDidScroll(d=>this.onDidScrollPane())),this._register(this.paneview.onDidSashReset(d=>this.onDidSashReset(d))),this._register(F(e,Q.CONTEXT_MENU,d=>this.showContextMenu(new _i(ue(e),d)))),this._register(yi.addTarget(e)),this._register(F(e,At.Contextmenu,d=>this.showContextMenu(new _i(ue(e),d)))),this._menuActions=this._register(this.instantiationService.createInstance(EL,this.paneview.element,this.viewContainer)),this._register(this._menuActions.onDidChange(()=>this.updateTitleArea()));let n,o=()=>{let d=e.getBoundingClientRect(),c=this.panes[this.panes.length-1].element.getBoundingClientRect(),p=this.orientation===0?c.bottom:d.top,h=this.orientation===1?c.right:d.left;return{top:p,bottom:d.bottom,left:h,right:d.right}},s=(d,c)=>c.x>=d.left&&c.x<=d.right&&c.y>=d.top&&c.y<=d.bottom,a;this._register(rb.INSTANCE.registerTarget(e,{onDragEnter:d=>{if(a=o(),n&&n.disposed&&(n=void 0),!n&&s(a,d.eventData)){let c=d.dragAndDropData.getData();if(c.type==="view"){let p=this.viewDescriptorService.getViewContainerByViewId(c.id),h=this.viewDescriptorService.getViewDescriptorById(c.id);if(p!==this.viewContainer&&(!h||!h.canMoveView||this.viewContainer.rejectAddedViews))return;n=new eE(e,void 0,a,this.viewDescriptorService.getViewContainerLocation(this.viewContainer),this.themeService)}if(c.type==="composite"&&c.id!==this.viewContainer.id){let p=this.viewDescriptorService.getViewContainerById(c.id),h=this.viewDescriptorService.getViewContainerModel(p).allViewDescriptors;!h.some(m=>!m.canMoveView)&&h.length>0&&(n=new eE(e,void 0,a,this.viewDescriptorService.getViewContainerLocation(this.viewContainer),this.themeService))}}},onDragOver:d=>{n&&n.disposed&&(n=void 0),n&&!s(a,d.eventData)&&(n.dispose(),n=void 0),s(a,d.eventData)&&dL(d.eventData.dataTransfer,"move",n!==void 0)},onDragLeave:d=>{n?.dispose(),n=void 0},onDrop:d=>{if(n){let c=d.dragAndDropData.getData(),p=[];if(c.type==="composite"&&c.id!==this.viewContainer.id){let m=this.viewDescriptorService.getViewContainerById(c.id),f=this.viewDescriptorService.getViewContainerModel(m).allViewDescriptors;f.some(g=>!g.canMoveView)||p.push(...f)}else if(c.type==="view"){let m=this.viewDescriptorService.getViewContainerByViewId(c.id),f=this.viewDescriptorService.getViewDescriptorById(c.id);m!==this.viewContainer&&f&&f.canMoveView&&this.viewDescriptorService.moveViewsToContainer([f],this.viewContainer,void 0,"dnd")}let h=this.panes.length;if(p.length>0&&this.viewDescriptorService.moveViewsToContainer(p,this.viewContainer,void 0,"dnd"),h>0)for(let m of p){let f=this.panes.find(g=>g.id===m.id);f&&this.movePane(f,this.panes[this.panes.length-1])}}n?.dispose(),n=void 0}})),this._register(this.onDidSashChange(()=>this.saveViewSizes())),this._register(this.viewContainerModel.onDidAddVisibleViewDescriptors(d=>this.onDidAddViewDescriptors(d))),this._register(this.viewContainerModel.onDidRemoveVisibleViewDescriptors(d=>this.onDidRemoveViewDescriptors(d)));let l=this.viewContainerModel.visibleViewDescriptors.map((d,c)=>{let p=this.viewContainerModel.getSize(d.id),h=this.viewContainerModel.isCollapsed(d.id);return{viewDescriptor:d,index:c,size:p,collapsed:h}});l.length&&this.onDidAddViewDescriptors(l),this.extensionService.whenInstalledExtensionsRegistered().then(()=>{this.areExtensionsReady=!0,this.panes.length&&(this.updateTitleArea(),this.updateViewHeaders()),this._register(this.configurationService.onDidChangeConfiguration(d=>{d.affectsConfiguration("workbench.activityBar.location")&&this.updateViewHeaders()}))}),this._register(this.viewContainerModel.onDidChangeActiveViewDescriptors(()=>this._onTitleAreaUpdate.fire()))}getTitle(){let e=this.viewContainerModel.title;if(this.isViewMergedWithContainer()){let i=this.paneItems[0].pane.singleViewPaneContainerTitle;if(i)return i;let n=this.paneItems[0].pane.title;return e===n?n:n?`${e}: ${n}`:e}return e}showContextMenu(e){for(let i of this.paneItems)if($n(e.target,i.pane.element))return;e.stopPropagation(),e.preventDefault(),this.contextMenuService.showContextMenu({getAnchor:()=>e,getActions:()=>this.menuActions?.getContextMenuActions()??[]})}getActionsContext(){if(this.isViewMergedWithContainer())return this.panes[0].getActionsContext()}getActionViewItem(e,i){return this.isViewMergedWithContainer()?this.paneItems[0].pane.getActionViewItem(e,i):aa(this.instantiationService,e,i)}focus(){let e;if(this.lastFocusedPane)e=this.lastFocusedPane;else if(this.paneItems.length>0){for(let{pane:i}of this.paneItems)if(i.isExpanded()){e=i;break}}e&&e.focus()}get orientation(){switch(this.viewDescriptorService.getViewContainerLocation(this.viewContainer)){case 0:case 2:return 0;case 1:return F1(this.layoutService.getPanelPosition())?1:0}return 0}layout(e){this.paneview&&(this.paneview.orientation!==this.orientation&&this.paneview.flipOrientation(e.height,e.width),this.paneview.layout(e.height,e.width)),this.dimension=e,this.didLayout?this.saveViewSizes():(this.didLayout=!0,this.restoreViewSizes())}setBoundarySashes(e){this._boundarySashes=e,this.paneview?.setBoundarySashes(e)}getOptimalWidth(){return Math.max(...this.panes.map(n=>n.getOptimalWidth()||0))+16}addPanes(e){let i=this.isViewMergedWithContainer();for(let{pane:n,size:o,index:s,disposable:a}of e)this.addPane(n,o,a,s);this.updateViewHeaders(),this.isViewMergedWithContainer()!==i&&this.updateTitleArea(),this._onDidAddViews.fire(e.map(({pane:n})=>n))}setVisible(e){this.visible!==!!e&&(this.visible=e,this._onDidChangeVisibility.fire(e)),this.panes.filter(i=>i.isVisible()!==e).map(i=>i.setVisible(e))}isVisible(){return this.visible}updateTitleArea(){this._onTitleAreaUpdate.fire()}createView(e,i){return this.instantiationService.createInstance(e.ctorDescriptor.ctor,...e.ctorDescriptor.staticArguments||[],i)}getView(e){return this.panes.filter(i=>i.id===e)[0]}saveViewSizes(){this.didLayout&&this.viewContainerModel.setSizes(this.panes.map(e=>({id:e.id,size:this.getPaneSize(e)})))}restoreViewSizes(){if(this.didLayout){let e;for(let i=0;i<this.viewContainerModel.visibleViewDescriptors.length;i++){let n=this.panes[i],o=this.viewContainerModel.visibleViewDescriptors[i],s=this.viewContainerModel.getSize(o.id);typeof s=="number"?this.resizePane(n,s):(e=e||this.computeInitialSizes(),this.resizePane(n,e.get(n.id)||200))}}}computeInitialSizes(){let e=new Map;if(this.dimension){let i=this.viewContainerModel.visibleViewDescriptors.reduce((n,{weight:o})=>n+(o||20),0);for(let n of this.viewContainerModel.visibleViewDescriptors)this.orientation===0?e.set(n.id,this.dimension.height*(n.weight||20)/i):e.set(n.id,this.dimension.width*(n.weight||20)/i)}return e}saveState(){this.panes.forEach(e=>e.saveState()),this.storageService.store(this.visibleViewsStorageId,this.length,1,1)}onContextMenu(e,i){e.stopPropagation(),e.preventDefault();let n=i.menuActions.getContextMenuActions();this.contextMenuService.showContextMenu({getAnchor:()=>e,getActions:()=>n})}openView(e,i){let n=this.getView(e);return n||this.toggleViewVisibility(e),n=this.getView(e),n&&(n.setExpanded(!0),i&&n.focus()),n}onDidAddViewDescriptors(e){let i=[];for(let{viewDescriptor:o,collapsed:s,index:a,size:l}of e){let d=this.createView(o,{id:o.id,title:o.name.value,fromExtensionId:o.extensionId,expanded:!s,singleViewPaneContainerTitle:o.singleViewPaneContainerTitle});d.render();let c=F(d.draggableElement,"contextmenu",h=>{h.stopPropagation(),h.preventDefault(),this.onContextMenu(new _i(ue(d.draggableElement),h),d)}),p=X.latch(X.map(d.onDidChange,()=>!d.isExpanded()))(h=>{this.viewContainerModel.setCollapsed(o.id,h)});i.push({pane:d,size:l||d.minimumSize,index:a,disposable:In(c,p)})}this.addPanes(i),this.restoreViewSizes();let n=[];for(let{pane:o}of i)o.setVisible(this.isVisible()),n.push(o);return n}onDidRemoveViewDescriptors(e){e=e.sort((n,o)=>o.index-n.index);let i=[];for(let{index:n}of e)this.paneItems[n]&&i.push(this.paneItems[n].pane);if(i.length){this.removePanes(i);for(let n of i)n.setVisible(!1)}}toggleViewVisibility(e){if(this.viewContainerModel.activeViewDescriptors.some(i=>i.id===e)){let i=!this.viewContainerModel.isVisible(e);this.viewContainerModel.setVisible(e,i)}}addPane(e,i,n,o=this.paneItems.length-1){let s=e.onDidFocus(()=>{this._onDidFocusView.fire(e),this.lastFocusedPane=e}),a=e.onDidBlur(()=>this._onDidBlurView.fire(e)),l=e.onDidChangeTitleArea(()=>{this.isViewMergedWithContainer()&&this.updateTitleArea()}),d=e.onDidChangeBodyVisibility(()=>this._onDidChangeViewVisibility.fire(e)),c=e.onDidChange(()=>{e===this.lastFocusedPane&&!e.isExpanded()&&(this.lastFocusedPane=void 0)}),p=this.viewDescriptorService.getViewContainerLocation(this.viewContainer)===1;e.style({headerForeground:Se(p?Ele:Vle),headerBackground:Se(p?wle:Ble),headerBorder:Se(p?xle:_9),dropBackground:Se(p?x9:T9),leftBorder:p?Se(Tle):void 0});let h=new B;h.add(n),h.add(In(e,s,a,l,c,d));let m={pane:e,disposable:h};this.paneItems.splice(o,0,m),Yt(this.paneview).addPane(e,i,o);let f;h.add(rb.INSTANCE.registerDraggable(e.draggableElement,()=>({type:"view",id:e.id}),{})),h.add(rb.INSTANCE.registerTarget(e.dropTargetElement,{onDragEnter:g=>{if(!f){let v=g.dragAndDropData.getData();if(v.type==="view"&&v.id!==e.id){let I=this.viewDescriptorService.getViewContainerByViewId(v.id),y=this.viewDescriptorService.getViewDescriptorById(v.id);if(I!==this.viewContainer&&(!y||!y.canMoveView||this.viewContainer.rejectAddedViews))return;f=new eE(e.dropTargetElement,this.orientation??0,void 0,this.viewDescriptorService.getViewContainerLocation(this.viewContainer),this.themeService)}if(v.type==="composite"&&v.id!==this.viewContainer.id&&!this.viewContainer.rejectAddedViews){let I=this.viewDescriptorService.getViewContainerById(v.id),y=this.viewDescriptorService.getViewContainerModel(I).allViewDescriptors;!y.some(w=>!w.canMoveView)&&y.length>0&&(f=new eE(e.dropTargetElement,this.orientation??0,void 0,this.viewDescriptorService.getViewContainerLocation(this.viewContainer),this.themeService))}}},onDragOver:g=>{dL(g.eventData.dataTransfer,"move",f!==void 0)},onDragLeave:g=>{f?.dispose(),f=void 0},onDrop:g=>{if(f){let v=g.dragAndDropData.getData(),I=[],y;if(v.type==="composite"&&v.id!==this.viewContainer.id&&!this.viewContainer.rejectAddedViews){let w=this.viewDescriptorService.getViewContainerById(v.id),C=this.viewDescriptorService.getViewContainerModel(w).allViewDescriptors;C.length>0&&!C.some(S=>!S.canMoveView)&&(I.push(...C),y=C[0])}else if(v.type==="view"){let w=this.viewDescriptorService.getViewContainerByViewId(v.id),C=this.viewDescriptorService.getViewDescriptorById(v.id);w!==this.viewContainer&&C&&C.canMoveView&&!this.viewContainer.rejectAddedViews&&I.push(C),C&&(y=C)}if(I&&this.viewDescriptorService.moveViewsToContainer(I,this.viewContainer,void 0,"dnd"),y){if(f.currentDropOperation===1||f.currentDropOperation===3){let w=this.panes.findIndex(S=>S.id===y.id),C=this.panes.findIndex(S=>S.id===e.id);w>=0&&C>=0&&(w>C&&C++,C<this.panes.length&&C!==w&&this.movePane(this.panes[w],this.panes[C]))}if(f.currentDropOperation===0||f.currentDropOperation===2){let w=this.panes.findIndex(S=>S.id===y.id),C=this.panes.findIndex(S=>S.id===e.id);w>=0&&C>=0&&(w<C&&C--,C>=0&&C!==w&&this.movePane(this.panes[w],this.panes[C]))}I.length>1&&I.slice(1).forEach(w=>{let C=this.panes.findIndex(D=>D.id===y.id),S=this.panes.findIndex(D=>D.id===w.id);S>=0&&C>=0&&(S>C&&C++,C<this.panes.length&&C!==S&&(this.movePane(this.panes[S],this.panes[C]),y=w))})}}f?.dispose(),f=void 0}}))}removePanes(e){let i=this.isViewMergedWithContainer();e.forEach(n=>this.removePane(n)),this.updateViewHeaders(),i!==this.isViewMergedWithContainer()&&this.updateTitleArea(),this._onDidRemoveViews.fire(e)}removePane(e){let i=this.paneItems.findIndex(o=>o.pane===e);if(i===-1)return;this.lastFocusedPane===e&&(this.lastFocusedPane=void 0),Yt(this.paneview).removePane(e);let[n]=this.paneItems.splice(i,1);n.disposable.dispose()}movePane(e,i){let n=this.paneItems.findIndex(d=>d.pane===e),o=this.paneItems.findIndex(d=>d.pane===i),s=this.viewContainerModel.visibleViewDescriptors[n],a=this.viewContainerModel.visibleViewDescriptors[o];if(n<0||n>=this.paneItems.length||o<0||o>=this.paneItems.length)return;let[l]=this.paneItems.splice(n,1);this.paneItems.splice(o,0,l),Yt(this.paneview).movePane(e,i),this.viewContainerModel.move(s.id,a.id),this.updateTitleArea()}resizePane(e,i){Yt(this.paneview).resizePane(e,i)}getPaneSize(e){return Yt(this.paneview).getPaneSize(e)}updateViewHeaders(){this.isViewMergedWithContainer()?(this.paneItems[0].pane.isExpanded()?this.lastMergedCollapsedPane=void 0:(this.lastMergedCollapsedPane=this.paneItems[0].pane,this.paneItems[0].pane.setExpanded(!0)),this.paneItems[0].pane.headerVisible=!1,this.paneItems[0].pane.collapsible=!0):(this.paneItems.length===1?(this.paneItems[0].pane.headerVisible=!0,this.paneItems[0].pane===this.lastMergedCollapsedPane&&this.paneItems[0].pane.setExpanded(!1),this.paneItems[0].pane.collapsible=!1):this.paneItems.forEach(e=>{e.pane.headerVisible=!0,e.pane.collapsible=!0,e.pane===this.lastMergedCollapsedPane&&e.pane.setExpanded(!1)}),this.lastMergedCollapsedPane=void 0)}isViewMergedWithContainer(){return this.options.mergeViewWithContainerWhenSingleView&&this.paneItems.length===1?this.areExtensionsReady?!0:this.visibleViewsCountFromCache===void 0?this.paneItems[0].pane.isExpanded():this.visibleViewsCountFromCache===1:!1}onDidScrollPane(){for(let e of this.panes)e.onDidScrollRoot()}onDidSashReset(e){let i,n;for(let o=e;o>=0;o--)if(this.paneItems[o].pane?.isVisible()&&this.paneItems[o]?.pane.isExpanded()){i=this.paneItems[o].pane;break}for(let o=e+1;o<this.paneItems.length;o++)if(this.paneItems[o].pane?.isVisible()&&this.paneItems[o]?.pane.isExpanded()){n=this.paneItems[o].pane;break}if(i&&n){let o=this.getPaneSize(i),s=this.getPaneSize(n),a=Math.ceil((o+s)/2),l=Math.floor((o+s)/2);o>s?(this.resizePane(i,a),this.resizePane(n,l)):(this.resizePane(n,l),this.resizePane(i,a))}}dispose(){super.dispose(),this.paneItems.forEach(e=>e.disposable.dispose()),this.paneview&&this.paneview.dispose()}};ch=E([b(2,ne),b(3,se),b(4,ii),b(5,vt),b(6,Tt),b(7,_n),b(8,Fe),b(9,nt),b(10,kt),b(11,$i)],ch);var tE=class extends Me{constructor(e,i){super(e);this.offset=i}async run(e){let i=e.get($i),n=e.get(re),o=Ks.getValue(n);if(o===void 0)return;let s=i.getViewContainerByViewId(o),a=i.getViewContainerModel(s),l=a.visibleViewDescriptors.find(p=>p.id===o),d=a.visibleViewDescriptors.indexOf(l);if(d+this.offset<0||d+this.offset>=a.visibleViewDescriptors.length)return;let c=a.visibleViewDescriptors[d+this.offset];a.move(l.id,c.id)}};he(class extends tE{constructor(){super({id:"views.moveViewUp",title:u("viewMoveUp","Move View Up"),keybinding:{primary:mo(2089,16),weight:201,when:Ks.notEqualsTo("")}},-1)}});he(class extends tE{constructor(){super({id:"views.moveViewLeft",title:u("viewMoveLeft","Move View Left"),keybinding:{primary:mo(2089,15),weight:201,when:Ks.notEqualsTo("")}},-1)}});he(class extends tE{constructor(){super({id:"views.moveViewDown",title:u("viewMoveDown","Move View Down"),keybinding:{primary:mo(2089,18),weight:201,when:Ks.notEqualsTo("")}},1)}});he(class extends tE{constructor(){super({id:"views.moveViewRight",title:u("viewMoveRight","Move View Right"),keybinding:{primary:mo(2089,17),weight:201,when:Ks.notEqualsTo("")}},1)}});he(class extends Me{constructor(){super({id:"vscode.moveViews",title:u("viewsMove","Move Views")})}async run(t,e){if(!Array.isArray(e?.viewIds)||typeof e?.destinationId!="string")return Promise.reject("Invalid arguments");let i=t.get($i),n=i.getViewContainerById(e.destinationId);if(n){for(let o of e.viewIds){let s=i.getViewDescriptorById(o);s?.canMoveView&&i.moveViewsToContainer([s],n,0,this.desc.id)}await t.get(Mi).openViewContainer(n.id,!0)}}});var J9=class{_registeredGutterActionsGenerators=new Set;registerGutterActionsGenerator(t){return this._registeredGutterActionsGenerators.add(t),{dispose:()=>{this._registeredGutterActionsGenerators.delete(t)}}}getGutterActionsGenerators(){return Array.from(this._registeredGutterActionsGenerators.values())}};Pe.add("gutterActionsRegistry",new J9);var e6=Pe.as("gutterActionsRegistry"),iE=class extends R{constructor(e,i,n,o,s){super();this.editor=e;this.contextMenuService=i;this.menuService=n;this.contextKeyService=o;this.instantiationService=s;this._register(this.editor.onMouseDown(a=>this.doShow(a,!1)))}static ID="workbench.contrib.editorLineNumberContextMenu";show(e){this.doShow(e,!0)}doShow(e,i){let n=this.editor.getModel();if(!e.event.rightButton&&!(ye&&e.event.leftButton&&e.event.ctrlKey)&&!i||e.target.type!==3&&e.target.type!==2||!e.target.position||!n)return;let o=e.target.position.lineNumber,s=this.contextKeyService.createOverlay([["editorLineNumber",o]]),a=this.menuService.createMenu(V.EditorLineNumberContext,s),l=[];this.instantiationService.invokeFunction(d=>{for(let p of e6.getGutterActionsGenerators()){let h=new Map;p({lineNumber:o,editor:this.editor,accessor:d},{push:(m,f="navigation")=>{let g=h.get(f)??[];g.push(m),h.set(f,g)}});for(let[m,f]of h.entries())l.push([m,f])}l.sort((p,h)=>p[0].localeCompare(h[0]));let c=a.getActions({arg:{lineNumber:o,uri:n.uri},shouldForwardArgs:!0});if(l.push(...c),e.target.type===3){let p=this.editor.getSelections(),h={startLineNumber:o,endLineNumber:o,startColumn:1,endColumn:n.getLineLength(o)+1};p?.some(f=>!f.isEmpty()&&f.intersectRanges(h)!==null)||this.editor.setSelection(h,"api")}this.contextMenuService.showContextMenu({getAnchor:()=>e.event,getActions:()=>Qt.join(...l.map(p=>p[1])),onHide:()=>a.dispose()})})}};iE=E([b(1,vt),b(2,jt),b(3,re),b(4,ne)],iE);gr(iE.ID,iE,1);var Rr=class r extends R{constructor(e,i){super();this.options=i;this.supportIcons=i?.supportIcons??!1,this.domNode=U(e,J("span.monaco-highlighted-label"))}domNode;text="";title="";highlights=[];supportIcons;didEverRender=!1;customHover;get element(){return this.domNode}set(e,i=[],n="",o){e||(e=""),o&&(e=r.escapeNewLines(e,i)),!(this.didEverRender&&this.text===e&&this.title===n&&sn(this.highlights,i))&&(this.text=e,this.title=n,this.highlights=i,this.render())}render(){let e=[],i=0;for(let n of this.highlights){if(n.end===n.start)continue;if(i<n.start){let a=this.text.substring(i,n.start);this.supportIcons?e.push(...zl(a)):e.push(a),i=n.start}let o=this.text.substring(i,n.end),s=J("span.highlight",void 0,...this.supportIcons?zl(o):[o]);n.extraClasses&&s.classList.add(...n.extraClasses),e.push(s),i=n.end}if(i<this.text.length){let n=this.text.substring(i);this.supportIcons?e.push(...zl(n)):e.push(n)}if(bo(this.domNode,...e),this.options?.hoverDelegate?.showNativeHover)this.domNode.title=this.title;else if(!this.customHover&&this.title!==""){let n=this.options?.hoverDelegate??gt("mouse");this.customHover=this._register(Bo().setupManagedHover(n,this.domNode,this.title))}else this.customHover&&this.customHover.update(this.title);this.didEverRender=!0}static escapeNewLines(e,i){let n=0,o=0;return e.replace(/\r\n|\r|\n/g,(s,a)=>{o=s===`\r
`?-1:0,a+=n;for(let l of i)l.end<=a||(l.start>=a&&(l.start+=o),l.end>=a&&(l.end+=o));return n+=o,"\u23CE"})}};var ZI=class{constructor(t){this._element=t}disposed;_textContent;_classNames;_empty;get element(){return this._element}set textContent(t){this.disposed||t===this._textContent||(this._textContent=t,this._element.textContent=t)}set classNames(t){this.disposed||sn(t,this._classNames)||(this._classNames=t,this._element.classList.value="",this._element.classList.add(...t))}set empty(t){this.disposed||t===this._empty||(this._empty=t,this._element.style.marginLeft=t?"0":"")}dispose(){this.disposed=!0}},gh=class extends R{creationOptions;domNode;nameContainer;nameNode;descriptionNode;suffixNode;labelContainer;hoverDelegate;customHovers=new Map;constructor(t,e){super(),this.creationOptions=e,this.domNode=this._register(new ZI(U(t,J(".monaco-icon-label")))),this.labelContainer=U(this.domNode.element,J(".monaco-icon-label-container")),this.nameContainer=U(this.labelContainer,J("span.monaco-icon-name-container")),e?.supportHighlights||e?.supportIcons?this.nameNode=this._register(new i6(this.nameContainer,!!e.supportIcons)):this.nameNode=new t6(this.nameContainer),this.hoverDelegate=e?.hoverDelegate??gt("mouse")}get element(){return this.domNode.element}setLabel(t,e,i){let n=["monaco-icon-label"],o=["monaco-icon-label-container"],s="";i&&(i.extraClasses&&n.push(...i.extraClasses),i.italic&&n.push("italic"),i.strikethrough&&n.push("strikethrough"),i.disabledCommand&&o.push("disabled"),i.title&&(typeof i.title=="string"?s+=i.title:s+=t));let a=this.domNode.element.querySelector(".monaco-icon-label-iconpath");if(i?.iconPath){let l;!a||!on(a)?(l=J(".monaco-icon-label-iconpath"),this.domNode.element.prepend(l)):l=a,l.style.backgroundImage=Dp(i?.iconPath)}else a&&a.remove();if(this.domNode.classNames=n,this.domNode.element.setAttribute("aria-label",s),this.labelContainer.classList.value="",this.labelContainer.classList.add(...o),this.setupHover(i?.descriptionTitle?this.labelContainer:this.element,i?.title),this.nameNode.setLabel(t,i),e||this.descriptionNode){let l=this.getOrCreateDescriptionNode();l instanceof Rr?(l.set(e||"",i?i.descriptionMatches:void 0,void 0,i?.labelEscapeNewLines),this.setupHover(l.element,i?.descriptionTitle)):(l.textContent=e&&i?.labelEscapeNewLines?Rr.escapeNewLines(e,[]):e||"",this.setupHover(l.element,i?.descriptionTitle||""),l.empty=!e)}if(i?.suffix||this.suffixNode){let l=this.getOrCreateSuffixNode();l.textContent=i?.suffix??""}}setupHover(t,e){let i=this.customHovers.get(t);if(i&&(i.dispose(),this.customHovers.delete(t)),!e){t.removeAttribute("title");return}if(this.hoverDelegate.showNativeHover){let o=function(s,a){Bt(a)?s.title=pD(a):a?.markdownNotSupportedFallback?s.title=a.markdownNotSupportedFallback:s.removeAttribute("title")};var n=o;o(t,e)}else{let o=Bo().setupManagedHover(this.hoverDelegate,t,e);o&&this.customHovers.set(t,o)}}dispose(){super.dispose();for(let t of this.customHovers.values())t.dispose();this.customHovers.clear()}getOrCreateSuffixNode(){if(!this.suffixNode){let t=this._register(new ZI(KA(this.nameContainer,J("span.monaco-icon-suffix-container"))));this.suffixNode=this._register(new ZI(U(t.element,J("span.label-suffix"))))}return this.suffixNode}getOrCreateDescriptionNode(){if(!this.descriptionNode){let t=this._register(new ZI(U(this.labelContainer,J("span.monaco-icon-description-container"))));this.creationOptions?.supportDescriptionHighlights?this.descriptionNode=this._register(new Rr(U(t.element,J("span.label-description")),{supportIcons:!!this.creationOptions.supportIcons})):this.descriptionNode=this._register(new ZI(U(t.element,J("span.label-description"))))}return this.descriptionNode}},t6=class{constructor(t){this.container=t}label=void 0;singleLabel=void 0;options;setLabel(t,e){if(!(this.label===t&&sn(this.options,e)))if(this.label=t,this.options=e,typeof t=="string")this.singleLabel||(this.container.innerText="",this.container.classList.remove("multiple"),this.singleLabel=U(this.container,J("a.label-name",{id:e?.domId}))),this.singleLabel.textContent=t;else{this.container.innerText="",this.container.classList.add("multiple"),this.singleLabel=void 0;for(let i=0;i<t.length;i++){let n=t[i],o=e?.domId&&`${e?.domId}_${i}`;U(this.container,J("a.label-name",{id:o,"data-icon-label-count":t.length,"data-icon-label-index":i,role:"treeitem"},n)),i<t.length-1&&U(this.container,J("span.label-separator",void 0,e?.separator||"/"))}}}};function cwe(r,t,e){if(!e)return;let i=0;return r.map(n=>{let o={start:i,end:i+n.length},s=e.map(a=>ts.intersect(o,a)).filter(a=>!ts.isEmpty(a)).map(({start:a,end:l})=>({start:a-i,end:l-i}));return i=o.end+t.length,s})}var i6=class extends R{constructor(e,i){super();this.container=e;this.supportIcons=i}label=void 0;singleLabel=void 0;options;setLabel(e,i){if(!(this.label===e&&sn(this.options,i)))if(this.label=e,this.options=i,typeof e=="string")this.singleLabel||(this.container.innerText="",this.container.classList.remove("multiple"),this.singleLabel=this._register(new Rr(U(this.container,J("a.label-name",{id:i?.domId})),{supportIcons:this.supportIcons}))),this.singleLabel.set(e,i?.matches,void 0,i?.labelEscapeNewLines);else{this.container.innerText="",this.container.classList.add("multiple"),this.singleLabel=void 0;let n=i?.separator||"/",o=cwe(e,n,i?.matches);for(let s=0;s<e.length;s++){let a=e[s],l=o?o[s]:void 0,d=i?.domId&&`${i?.domId}_${s}`,c=J("a.label-name",{id:d,"data-icon-label-count":e.length,"data-icon-label-index":s,role:"treeitem"});this._register(new Rr(U(this.container,c),{supportIcons:this.supportIcons})).set(a,l,void 0,i?.labelEscapeNewLines),s<e.length-1&&U(c,J("span.label-separator",void 0,n))}}}};var n6=class{constructor(t,e){this.renderer=t;this.modelProvider=e}get templateId(){return this.renderer.templateId}renderTemplate(t){return{data:this.renderer.renderTemplate(t),disposable:R.None}}renderElement(t,e,i,n){if(i.disposable?.dispose(),!i.data)return;let o=this.modelProvider();if(o.isResolved(t))return this.renderer.renderElement(o.get(t),t,i.data,n);let s=new Kt,a=o.resolve(t,s.token);i.disposable={dispose:()=>s.cancel()},this.renderer.renderPlaceholder(t,i.data),a.then(l=>this.renderer.renderElement(l,t,i.data,n))}disposeTemplate(t){t.disposable&&(t.disposable.dispose(),t.disposable=void 0),t.data&&(this.renderer.disposeTemplate(t.data),t.data=void 0)}},o6=class{constructor(t,e){this.modelProvider=t;this.accessibilityProvider=e}getWidgetAriaLabel(){return this.accessibilityProvider.getWidgetAriaLabel()}getAriaLabel(t){let e=this.modelProvider();return e.isResolved(t)?this.accessibilityProvider.getAriaLabel(e.get(t)):null}};function uwe(r,t){return{...t,accessibilityProvider:t.accessibilityProvider&&new o6(r,t.accessibilityProvider)}}var JF=class{list;_model;constructor(t,e,i,n,o={}){let s=()=>this.model,a=n.map(l=>new n6(l,s));this.list=new ho(t,e,i,a,uwe(s,o))}updateOptions(t){this.list.updateOptions(t)}getHTMLElement(){return this.list.getHTMLElement()}isDOMFocused(){return fs(this.getHTMLElement())}domFocus(){this.list.domFocus()}get onDidFocus(){return this.list.onDidFocus}get onDidBlur(){return this.list.onDidBlur}get widget(){return this.list}get onDidDispose(){return this.list.onDidDispose}get onMouseClick(){return X.map(this.list.onMouseClick,({element:t,index:e,browserEvent:i})=>({element:t===void 0?void 0:this._model.get(t),index:e,browserEvent:i}))}get onMouseDblClick(){return X.map(this.list.onMouseDblClick,({element:t,index:e,browserEvent:i})=>({element:t===void 0?void 0:this._model.get(t),index:e,browserEvent:i}))}get onTap(){return X.map(this.list.onTap,({element:t,index:e,browserEvent:i})=>({element:t===void 0?void 0:this._model.get(t),index:e,browserEvent:i}))}get onPointer(){return X.map(this.list.onPointer,({element:t,index:e,browserEvent:i})=>({element:t===void 0?void 0:this._model.get(t),index:e,browserEvent:i}))}get onDidChangeFocus(){return X.map(this.list.onDidChangeFocus,({elements:t,indexes:e,browserEvent:i})=>({elements:t.map(n=>this._model.get(n)),indexes:e,browserEvent:i}))}get onDidChangeSelection(){return X.map(this.list.onDidChangeSelection,({elements:t,indexes:e,browserEvent:i})=>({elements:t.map(n=>this._model.get(n)),indexes:e,browserEvent:i}))}get onContextMenu(){return X.map(this.list.onContextMenu,({element:t,index:e,anchor:i,browserEvent:n})=>typeof t>"u"?{element:t,index:e,anchor:i,browserEvent:n}:{element:this._model.get(t),index:e,anchor:i,browserEvent:n})}get model(){return this._model}set model(t){this._model=t,this.list.splice(0,this.list.length,yr(t.length))}get length(){return this.list.length}get scrollTop(){return this.list.scrollTop}set scrollTop(t){this.list.scrollTop=t}get scrollLeft(){return this.list.scrollLeft}set scrollLeft(t){this.list.scrollLeft=t}setAnchor(t){this.list.setAnchor(t)}getAnchor(){return this.list.getAnchor()}setFocus(t){this.list.setFocus(t)}focusNext(t,e){this.list.focusNext(t,e)}focusPrevious(t,e){this.list.focusPrevious(t,e)}focusNextPage(){return this.list.focusNextPage()}focusPreviousPage(){return this.list.focusPreviousPage()}focusLast(){this.list.focusLast()}focusFirst(){this.list.focusFirst()}getFocus(){return this.list.getFocus()}setSelection(t,e){this.list.setSelection(t,e)}getSelection(){return this.list.getSelection()}getSelectedElements(){return this.getSelection().map(t=>this.model.get(t))}layout(t,e){this.list.layout(t,e)}triggerTypeNavigation(){this.list.triggerTypeNavigation()}reveal(t,e){this.list.reveal(t,e)}style(t){this.list.style(t)}dispose(){this.list.dispose()}};var eB=class r{constructor(t,e,i){this.columns=t;this.getColumnSize=i;let n=new Map(e.map(o=>[o.templateId,o]));this.renderers=[];for(let o of t){let s=n.get(o.templateId);if(!s)throw new Error(`Table cell renderer for template id ${o.templateId} not found.`);this.renderers.push(s)}}static TemplateId="row";templateId=r.TemplateId;renderers;renderedTemplates=new Set;renderTemplate(t){let e=U(t,J(".monaco-table-tr")),i=[],n=[];for(let s=0;s<this.columns.length;s++){let a=this.renderers[s],l=U(e,J(".monaco-table-td",{"data-col-index":s}));l.style.width=`${this.getColumnSize(s)}px`,i.push(l),n.push(a.renderTemplate(l))}let o={container:t,cellContainers:i,cellTemplateData:n};return this.renderedTemplates.add(o),o}renderElement(t,e,i,n){for(let o=0;o<this.columns.length;o++){let a=this.columns[o].project(t);this.renderers[o].renderElement(a,e,i.cellTemplateData[o],n)}}disposeElement(t,e,i,n){for(let o=0;o<this.columns.length;o++){let s=this.renderers[o];if(s.disposeElement){let l=this.columns[o].project(t);s.disposeElement(l,e,i.cellTemplateData[o],n)}}}disposeTemplate(t){for(let e=0;e<this.columns.length;e++)this.renderers[e].disposeTemplate(t.cellTemplateData[e]);ai(t.container),this.renderedTemplates.delete(t)}layoutColumn(t,e){for(let{cellContainers:i}of this.renderedTemplates)i[t].style.width=`${e}px`}};function pwe(r){return{getHeight(t){return r.getHeight(t)},getTemplateId(){return eB.TemplateId}}}var r6=class extends R{constructor(e,i){super();this.column=e;this.index=i;this.element=J(".monaco-table-th",{"data-col-index":i},e.label),e.tooltip&&this._register(Bo().setupManagedHover(gt("mouse"),this.element,e.tooltip))}element;get minimumSize(){return this.column.minimumWidth??120}get maximumSize(){return this.column.maximumWidth??Number.POSITIVE_INFINITY}get onDidChange(){return this.column.onDidChangeWidthConstraints??X.None}_onDidLayout=new x;onDidLayout=this._onDidLayout.event;layout(e){this._onDidLayout.fire([this.index,e])}},tB=class r{constructor(t,e,i,n,o,s){this.virtualDelegate=i;this.columns=n;this.domNode=U(e,J(`.monaco-table.${this.domId}`));let a=n.map((c,p)=>this.disposables.add(new r6(c,p))),l={size:a.reduce((c,p)=>c+p.column.weight,0),views:a.map(c=>({size:c.column.weight,view:c}))};this.splitview=this.disposables.add(new wc(this.domNode,{orientation:1,scrollbarVisibility:2,getSashOrthogonalSize:()=>this.cachedHeight,descriptor:l})),this.splitview.el.style.height=`${i.headerRowHeight}px`,this.splitview.el.style.lineHeight=`${i.headerRowHeight}px`;let d=new eB(n,o,c=>this.splitview.getViewSize(c));this.list=this.disposables.add(new ho(t,this.domNode,pwe(i),[d],s)),X.any(...a.map(c=>c.onDidLayout))(([c,p])=>d.layoutColumn(c,p),null,this.disposables),this.splitview.onDidSashReset(c=>{let p=n.reduce((m,f)=>m+f.weight,0),h=n[c].weight/p*this.cachedWidth;this.splitview.resizeView(c,h)},null,this.disposables),this.styleElement=Go(this.domNode),this.style(k1)}static InstanceCount=0;domId=`table_id_${++r.InstanceCount}`;domNode;splitview;list;styleElement;disposables=new B;cachedWidth=0;cachedHeight=0;get onDidChangeFocus(){return this.list.onDidChangeFocus}get onDidChangeSelection(){return this.list.onDidChangeSelection}get onDidScroll(){return this.list.onDidScroll}get onMouseClick(){return this.list.onMouseClick}get onMouseDblClick(){return this.list.onMouseDblClick}get onMouseMiddleClick(){return this.list.onMouseMiddleClick}get onPointer(){return this.list.onPointer}get onMouseUp(){return this.list.onMouseUp}get onMouseDown(){return this.list.onMouseDown}get onMouseOver(){return this.list.onMouseOver}get onMouseMove(){return this.list.onMouseMove}get onMouseOut(){return this.list.onMouseOut}get onTouchStart(){return this.list.onTouchStart}get onTap(){return this.list.onTap}get onContextMenu(){return this.list.onContextMenu}get onDidFocus(){return this.list.onDidFocus}get onDidBlur(){return this.list.onDidBlur}get scrollTop(){return this.list.scrollTop}set scrollTop(t){this.list.scrollTop=t}get scrollLeft(){return this.list.scrollLeft}set scrollLeft(t){this.list.scrollLeft=t}get scrollHeight(){return this.list.scrollHeight}get renderHeight(){return this.list.renderHeight}get onDidDispose(){return this.list.onDidDispose}getColumnLabels(){return this.columns.map(t=>t.label)}resizeColumn(t,e){let i=Math.round(e/100*this.cachedWidth);this.splitview.resizeView(t,i)}updateOptions(t){this.list.updateOptions(t)}splice(t,e,i=[]){this.list.splice(t,e,i)}rerender(){this.list.rerender()}row(t){return this.list.element(t)}indexOf(t){return this.list.indexOf(t)}get length(){return this.list.length}getHTMLElement(){return this.domNode}layout(t,e){t=t??WA(this.domNode),e=e??XS(this.domNode),this.cachedWidth=e,this.cachedHeight=t,this.splitview.layout(e);let i=t-this.virtualDelegate.headerRowHeight;this.list.getHTMLElement().style.height=`${i}px`,this.list.layout(i,e)}triggerTypeNavigation(){this.list.triggerTypeNavigation()}style(t){let e=[];e.push(`.monaco-table.${this.domId} > .monaco-split-view2 .monaco-sash.vertical::before {
			top: ${this.virtualDelegate.headerRowHeight+1}px;
			height: calc(100% - ${this.virtualDelegate.headerRowHeight}px);
		}`),this.styleElement.textContent=e.join(`
`),this.list.style(t)}domFocus(){this.list.domFocus()}setAnchor(t){this.list.setAnchor(t)}getAnchor(){return this.list.getAnchor()}getSelectedElements(){return this.list.getSelectedElements()}setSelection(t,e){this.list.setSelection(t,e)}getSelection(){return this.list.getSelection()}setFocus(t,e){this.list.setFocus(t,e)}focusNext(t=1,e=!1,i){this.list.focusNext(t,e,i)}focusPrevious(t=1,e=!1,i){this.list.focusPrevious(t,e,i)}focusNextPage(t){return this.list.focusNextPage(t)}focusPreviousPage(t){return this.list.focusPreviousPage(t)}focusFirst(t){this.list.focusFirst(t)}focusLast(t){this.list.focusLast(t)}getFocus(){return this.list.getFocus()}getFocusedElements(){return this.list.getFocusedElements()}getRelativeTop(t){return this.list.getRelativeTop(t)}reveal(t,e){this.list.reveal(t,e)}dispose(){this.disposables.dispose()}};var pb=class{constructor(t,e={}){this.user=t;this.model=new oF(t,null,e),this.onDidSpliceModel=this.model.onDidSpliceModel,this.onDidSpliceRenderedNodes=this.model.onDidSpliceRenderedNodes,this.onDidChangeCollapseState=this.model.onDidChangeCollapseState,this.onDidChangeRenderNodeCount=this.model.onDidChangeRenderNodeCount,e.sorter&&(this.sorter={compare(i,n){return e.sorter.compare(i.element,n.element)}}),this.identityProvider=e.identityProvider}rootRef=null;model;nodes=new Map;nodesByIdentity=new Map;identityProvider;sorter;onDidSpliceModel;onDidSpliceRenderedNodes;onDidChangeCollapseState;onDidChangeRenderNodeCount;get size(){return this.nodes.size}setChildren(t,e=mt.empty(),i={}){let n=this.getElementLocation(t);this._setChildren(n,this.preserveCollapseState(e),i)}_setChildren(t,e=mt.empty(),i){let n=new Set,o=new Set,s=l=>{if(l.element===null)return;let d=l;if(n.add(d.element),this.nodes.set(d.element,d),this.identityProvider){let c=this.identityProvider.getId(d.element).toString();o.add(c),this.nodesByIdentity.set(c,d)}i.onDidCreateNode?.(d)},a=l=>{if(l.element===null)return;let d=l;if(n.has(d.element)||this.nodes.delete(d.element),this.identityProvider){let c=this.identityProvider.getId(d.element).toString();o.has(c)||this.nodesByIdentity.delete(c)}i.onDidDeleteNode?.(d)};this.model.splice([...t,0],Number.MAX_VALUE,e,{...i,onDidCreateNode:s,onDidDeleteNode:a})}preserveCollapseState(t=mt.empty()){return this.sorter&&(t=[...t].sort(this.sorter.compare.bind(this.sorter))),mt.map(t,e=>{let i=this.nodes.get(e.element);if(!i&&this.identityProvider){let s=this.identityProvider.getId(e.element).toString();i=this.nodesByIdentity.get(s)}if(!i){let s;return typeof e.collapsed>"u"?s=void 0:e.collapsed===1||e.collapsed===3?s=!0:e.collapsed===0||e.collapsed===2?s=!1:s=!!e.collapsed,{...e,children:this.preserveCollapseState(e.children),collapsed:s}}let n=typeof e.collapsible=="boolean"?e.collapsible:i.collapsible,o;return typeof e.collapsed>"u"||e.collapsed===3||e.collapsed===2?o=i.collapsed:e.collapsed===1?o=!0:e.collapsed===0?o=!1:o=!!e.collapsed,{...e,collapsible:n,collapsed:o,children:this.preserveCollapseState(e.children)}})}rerender(t){let e=this.getElementLocation(t);this.model.rerender(e)}resort(t=null,e=!0){if(!this.sorter)return;let i=this.getElementLocation(t),n=this.model.getNode(i);this._setChildren(i,this.resortChildren(n,e),{})}resortChildren(t,e,i=!0){let n=[...t.children];return(e||i)&&(n=n.sort(this.sorter.compare.bind(this.sorter))),mt.map(n,o=>({element:o.element,collapsible:o.collapsible,collapsed:o.collapsed,children:this.resortChildren(o,e,!1)}))}getFirstElementChild(t=null){let e=this.getElementLocation(t);return this.model.getFirstElementChild(e)}getLastElementAncestor(t=null){let e=this.getElementLocation(t);return this.model.getLastElementAncestor(e)}has(t){return this.nodes.has(t)}getListIndex(t){let e=this.getElementLocation(t);return this.model.getListIndex(e)}getListRenderCount(t){let e=this.getElementLocation(t);return this.model.getListRenderCount(e)}isCollapsible(t){let e=this.getElementLocation(t);return this.model.isCollapsible(e)}setCollapsible(t,e){let i=this.getElementLocation(t);return this.model.setCollapsible(i,e)}isCollapsed(t){let e=this.getElementLocation(t);return this.model.isCollapsed(e)}setCollapsed(t,e,i){let n=this.getElementLocation(t);return this.model.setCollapsed(n,e,i)}expandTo(t){let e=this.getElementLocation(t);this.model.expandTo(e)}refilter(){this.model.refilter()}getNode(t=null){if(t===null)return this.model.getNode(this.model.rootRef);let e=this.nodes.get(t);if(!e)throw new Qn(this.user,`Tree element not found: ${t}`);return e}getNodeLocation(t){return t.element}getParentNodeLocation(t){if(t===null)throw new Qn(this.user,"Invalid getParentNodeLocation call");let e=this.nodes.get(t);if(!e)throw new Qn(this.user,`Tree element not found: ${t}`);let i=this.model.getNodeLocation(e),n=this.model.getParentNodeLocation(i);return this.model.getNode(n).element}getElementLocation(t){if(t===null)return[];let e=this.nodes.get(t);if(!e)throw new Qn(this.user,`Tree element not found: ${t}`);return this.model.getNodeLocation(e)}};function iB(r){let t=[r.element],e=r.incompressible||!1;return{element:{elements:t,incompressible:e},children:mt.map(mt.from(r.children),iB),collapsible:r.collapsible,collapsed:r.collapsed}}function nB(r){let t=[r.element],e=r.incompressible||!1,i,n;for(;[n,i]=mt.consume(mt.from(r.children),2),!(n.length!==1||n[0].incompressible);)r=n[0],t.push(r.element);return{element:{elements:t,incompressible:e},children:mt.map(mt.concat(n,i),nB),collapsible:r.collapsible,collapsed:r.collapsed}}function s6(r,t=0){let e;return t<r.element.elements.length-1?e=[s6(r,t+1)]:e=mt.map(mt.from(r.children),i=>s6(i,0)),t===0&&r.element.incompressible?{element:r.element.elements[t],children:e,incompressible:!0,collapsible:r.collapsible,collapsed:r.collapsed}:{element:r.element.elements[t],children:e,collapsible:r.collapsible,collapsed:r.collapsed}}function pde(r){return s6(r,0)}function hde(r,t,e){return r.element===t?{...r,children:e}:{...r,children:mt.map(mt.from(r.children),i=>hde(i,t,e))}}var mwe=r=>({getId(t){return t.elements.map(e=>r.getId(e).toString()).join("\0")}}),a6=class{constructor(t,e={}){this.user=t;this.model=new pb(t,e),this.enabled=typeof e.compressionEnabled>"u"?!0:e.compressionEnabled,this.identityProvider=e.identityProvider}rootRef=null;get onDidSpliceRenderedNodes(){return this.model.onDidSpliceRenderedNodes}get onDidSpliceModel(){return this.model.onDidSpliceModel}get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}get onDidChangeRenderNodeCount(){return this.model.onDidChangeRenderNodeCount}model;nodes=new Map;enabled;identityProvider;get size(){return this.nodes.size}setChildren(t,e=mt.empty(),i){let n=i.diffIdentityProvider&&mwe(i.diffIdentityProvider);if(t===null){let f=mt.map(e,this.enabled?nB:iB);this._setChildren(null,f,{diffIdentityProvider:n,diffDepth:1/0});return}let o=this.nodes.get(t);if(!o)throw new Qn(this.user,"Unknown compressed tree node");let s=this.model.getNode(o),a=this.model.getParentNodeLocation(o),l=this.model.getNode(a),d=pde(s),c=hde(d,t,e),p=(this.enabled?nB:iB)(c),h=i.diffIdentityProvider?(f,g)=>i.diffIdentityProvider.getId(f)===i.diffIdentityProvider.getId(g):void 0;if(xi(p.element.elements,s.element.elements,h)){this._setChildren(o,p.children||mt.empty(),{diffIdentityProvider:n,diffDepth:1});return}let m=l.children.map(f=>f===s?p:f);this._setChildren(l.element,m,{diffIdentityProvider:n,diffDepth:s.depth-l.depth})}isCompressionEnabled(){return this.enabled}setCompressionEnabled(t){if(t===this.enabled)return;this.enabled=t;let i=this.model.getNode().children,n=mt.map(i,pde),o=mt.map(n,t?nB:iB);this._setChildren(null,o,{diffIdentityProvider:this.identityProvider,diffDepth:1/0})}_setChildren(t,e,i){let n=new Set,o=a=>{for(let l of a.element.elements)n.add(l),this.nodes.set(l,a.element)},s=a=>{for(let l of a.element.elements)n.has(l)||this.nodes.delete(l)};this.model.setChildren(t,e,{...i,onDidCreateNode:o,onDidDeleteNode:s})}has(t){return this.nodes.has(t)}getListIndex(t){let e=this.getCompressedNode(t);return this.model.getListIndex(e)}getListRenderCount(t){let e=this.getCompressedNode(t);return this.model.getListRenderCount(e)}getNode(t){if(typeof t>"u")return this.model.getNode();let e=this.getCompressedNode(t);return this.model.getNode(e)}getNodeLocation(t){let e=this.model.getNodeLocation(t);return e===null?null:e.elements[e.elements.length-1]}getParentNodeLocation(t){let e=this.getCompressedNode(t),i=this.model.getParentNodeLocation(e);return i===null?null:i.elements[i.elements.length-1]}getFirstElementChild(t){let e=this.getCompressedNode(t);return this.model.getFirstElementChild(e)}getLastElementAncestor(t){let e=typeof t>"u"?void 0:this.getCompressedNode(t);return this.model.getLastElementAncestor(e)}isCollapsible(t){let e=this.getCompressedNode(t);return this.model.isCollapsible(e)}setCollapsible(t,e){let i=this.getCompressedNode(t);return this.model.setCollapsible(i,e)}isCollapsed(t){let e=this.getCompressedNode(t);return this.model.isCollapsed(e)}setCollapsed(t,e,i){let n=this.getCompressedNode(t);return this.model.setCollapsed(n,e,i)}expandTo(t){let e=this.getCompressedNode(t);this.model.expandTo(e)}rerender(t){let e=this.getCompressedNode(t);this.model.rerender(e)}refilter(){this.model.refilter()}resort(t=null,e=!0){let i=this.getCompressedNode(t);this.model.resort(i,e)}getCompressedNode(t){if(t===null)return null;let e=this.nodes.get(t);if(!e)throw new Qn(this.user,`Tree element not found: ${t}`);return e}},gwe=r=>r[r.length-1],l6=class r{constructor(t,e){this.unwrapper=t;this.node=e}get element(){return this.node.element===null?null:this.unwrapper(this.node.element)}get children(){return this.node.children.map(t=>new r(this.unwrapper,t))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}};function fwe(r,t){return{...t,identityProvider:t.identityProvider&&{getId(e){return t.identityProvider.getId(r(e))}},sorter:t.sorter&&{compare(e,i){return t.sorter.compare(e.elements[0],i.elements[0])}},filter:t.filter&&{filter(e,i){return t.filter.filter(r(e),i)}}}}var oB=class{rootRef=null;get onDidSpliceModel(){return X.map(this.model.onDidSpliceModel,({insertedNodes:t,deletedNodes:e})=>({insertedNodes:t.map(i=>this.nodeMapper.map(i)),deletedNodes:e.map(i=>this.nodeMapper.map(i))}))}get onDidSpliceRenderedNodes(){return X.map(this.model.onDidSpliceRenderedNodes,({start:t,deleteCount:e,elements:i})=>({start:t,deleteCount:e,elements:i.map(n=>this.nodeMapper.map(n))}))}get onDidChangeCollapseState(){return X.map(this.model.onDidChangeCollapseState,({node:t,deep:e})=>({node:this.nodeMapper.map(t),deep:e}))}get onDidChangeRenderNodeCount(){return X.map(this.model.onDidChangeRenderNodeCount,t=>this.nodeMapper.map(t))}elementMapper;nodeMapper;model;constructor(t,e={}){this.elementMapper=e.elementMapper||gwe;let i=n=>this.elementMapper(n.elements);this.nodeMapper=new KI(n=>new l6(i,n)),this.model=new a6(t,fwe(i,e))}setChildren(t,e=mt.empty(),i={}){this.model.setChildren(t,e,i)}isCompressionEnabled(){return this.model.isCompressionEnabled()}setCompressionEnabled(t){this.model.setCompressionEnabled(t)}has(t){return this.model.has(t)}getListIndex(t){return this.model.getListIndex(t)}getListRenderCount(t){return this.model.getListRenderCount(t)}getNode(t){return this.nodeMapper.map(this.model.getNode(t))}getNodeLocation(t){return t.element}getParentNodeLocation(t){return this.model.getParentNodeLocation(t)}getFirstElementChild(t){let e=this.model.getFirstElementChild(t);return e===null||typeof e>"u"?e:this.elementMapper(e.elements)}getLastElementAncestor(t){let e=this.model.getLastElementAncestor(t);return e===null||typeof e>"u"?e:this.elementMapper(e.elements)}isCollapsible(t){return this.model.isCollapsible(t)}setCollapsible(t,e){return this.model.setCollapsible(t,e)}isCollapsed(t){return this.model.isCollapsed(t)}setCollapsed(t,e,i){return this.model.setCollapsed(t,e,i)}expandTo(t){return this.model.expandTo(t)}rerender(t){return this.model.rerender(t)}refilter(){return this.model.refilter()}resort(t=null,e=!0){return this.model.resort(t,e)}getCompressedTreeNode(t=null){return this.model.getNode(t)}};var JI=class extends Mw{constructor(e,i,n,o,s={}){super(e,i,n,o,s);this.user=e}get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}setChildren(e,i=mt.empty(),n){this.model.setChildren(e,i,n)}rerender(e){if(e===void 0){this.view.rerender();return}this.model.rerender(e)}updateElementHeight(e,i){let n=this.model.getListIndex(e);if(n===-1)throw new Qn(this.user,"updateElementHeight failed - index not found");this.view.updateElementHeight(n,i)}resort(e,i=!0){this.model.resort(e,i)}hasElement(e){return this.model.has(e)}createModel(e,i){return new pb(e,i)}},rB=class{constructor(t,e,i){this._compressedTreeNodeProvider=t;this.stickyScrollDelegate=e;this.renderer=i;this.templateId=i.templateId,i.onDidChangeTwistieState&&(this.onDidChangeTwistieState=i.onDidChangeTwistieState)}templateId;onDidChangeTwistieState;get compressedTreeNodeProvider(){return this._compressedTreeNodeProvider()}renderTemplate(t){return{compressedTreeNode:void 0,data:this.renderer.renderTemplate(t)}}renderElement(t,e,i,n){let o=this.stickyScrollDelegate.getCompressedNode(t);o||(o=this.compressedTreeNodeProvider.getCompressedTreeNode(t.element)),o.element.elements.length===1?(i.compressedTreeNode=void 0,this.renderer.renderElement(t,e,i.data,n)):(i.compressedTreeNode=o,this.renderer.renderCompressedElements(o,e,i.data,n))}disposeElement(t,e,i,n){i.compressedTreeNode?this.renderer.disposeCompressedElements?.(i.compressedTreeNode,e,i.data,n):this.renderer.disposeElement?.(t,e,i.data,n)}disposeTemplate(t){this.renderer.disposeTemplate(t.data)}renderTwistie(t,e){return this.renderer.renderTwistie?this.renderer.renderTwistie(t,e):!1}};E([Re],rB.prototype,"compressedTreeNodeProvider",1);var d6=class{constructor(t){this.modelProvider=t}compressedStickyNodes=new Map;getCompressedNode(t){return this.compressedStickyNodes.get(t)}constrainStickyScrollNodes(t,e,i){if(this.compressedStickyNodes.clear(),t.length===0)return[];for(let n=0;n<t.length;n++){let o=t[n],s=o.position+o.height;if(n+1<t.length&&s+t[n+1].height>i||n>=e-1&&e<t.length){let l=t.slice(0,n),d=t.slice(n),c=this.compressStickyNodes(d);return[...l,c]}}return t}compressStickyNodes(t){if(t.length===0)throw new Error("Can't compress empty sticky nodes");let e=this.modelProvider();if(!e.isCompressionEnabled())return t[0];let i=[];for(let d=0;d<t.length;d++){let c=t[d],p=e.getCompressedTreeNode(c.node.element);if(p.element){if(d!==0&&p.element.incompressible)break;i.push(...p.element.elements)}}if(i.length<2)return t[0];let n=t[t.length-1],o={elements:i,incompressible:!1},s={...n.node,children:[],element:o},a=new Proxy(t[0].node,{}),l={node:a,startIndex:t[0].startIndex,endIndex:n.endIndex,position:t[0].position,height:t[0].height};return this.compressedStickyNodes.set(a,s),l}};function bwe(r,t){return t&&{...t,keyboardNavigationLabelProvider:t.keyboardNavigationLabelProvider&&{getKeyboardNavigationLabel(e){let i;try{i=r().getCompressedTreeNode(e)}catch{return t.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(e)}return i.element.elements.length===1?t.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(e):t.keyboardNavigationLabelProvider.getCompressedNodeKeyboardNavigationLabel(i.element.elements)}}}}var nE=class extends JI{constructor(t,e,i,n,o={}){let s=()=>this,a=new d6(()=>this.model),l=n.map(d=>new rB(s,a,d));super(t,e,i,l,{...bwe(s,o),stickyScrollDelegate:a})}setChildren(t,e=mt.empty(),i){this.model.setChildren(t,e,i)}createModel(t,e){return new oB(t,e)}updateOptions(t={}){super.updateOptions(t),typeof t.compressionEnabled<"u"&&this.model.setCompressionEnabled(t.compressionEnabled)}getCompressedTreeNode(t=null){return this.model.getCompressedTreeNode(t)}};function c6(r){return{...r,children:[],refreshPromise:void 0,stale:!0,slow:!1,forceExpanded:!1}}function p6(r,t){return t.parent?t.parent===r?!0:p6(r,t.parent):!1}function vwe(r,t){return r===t||p6(r,t)||p6(t,r)}var h6=class r{constructor(t){this.node=t}get element(){return this.node.element.element}get children(){return this.node.children.map(t=>new r(t))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}},m6=class{constructor(t,e,i){this.renderer=t;this.nodeMapper=e;this.onDidChangeTwistieState=i;this.templateId=t.templateId}templateId;renderedNodes=new Map;renderTemplate(t){return{templateData:this.renderer.renderTemplate(t)}}renderElement(t,e,i,n){this.renderer.renderElement(this.nodeMapper.map(t),e,i.templateData,n)}renderTwistie(t,e){return t.slow?(e.classList.add(...de.asClassNameArray(N.treeItemLoading)),!0):(e.classList.remove(...de.asClassNameArray(N.treeItemLoading)),!1)}disposeElement(t,e,i,n){this.renderer.disposeElement?.(this.nodeMapper.map(t),e,i.templateData,n)}disposeTemplate(t){this.renderer.disposeTemplate(t.templateData)}dispose(){this.renderedNodes.clear()}};function mde(r){return{browserEvent:r.browserEvent,elements:r.elements.map(t=>t.element)}}function sB(r){return{browserEvent:r.browserEvent,element:r.element&&r.element.element,target:r.target}}function Iwe(r){return{browserEvent:r.browserEvent,element:r.element&&r.element.element,anchor:r.anchor,isStickyScroll:r.isStickyScroll}}var g6=class extends Cc{constructor(e){super(e.elements.map(i=>i.element));this.data=e}set context(e){this.data.context=e}get context(){return this.data.context}};function u6(r){return r instanceof Cc?new g6(r):r}var f6=class{constructor(t){this.dnd=t}getDragURI(t){return this.dnd.getDragURI(t.element)}getDragLabel(t,e){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(t.map(i=>i.element),e)}onDragStart(t,e){this.dnd.onDragStart?.(u6(t),e)}onDragOver(t,e,i,n,o,s=!0){return this.dnd.onDragOver(u6(t),e&&e.element,i,n,o)}drop(t,e,i,n,o){this.dnd.drop(u6(t),e&&e.element,i,n,o)}onDragEnd(t){this.dnd.onDragEnd?.(t)}dispose(){this.dnd.dispose()}};function gde(r){return r&&{...r,collapseByDefault:!0,identityProvider:r.identityProvider&&{getId(t){return r.identityProvider.getId(t.element)}},dnd:r.dnd&&new f6(r.dnd),multipleSelectionController:r.multipleSelectionController&&{isSelectionSingleChangeEvent(t){return r.multipleSelectionController.isSelectionSingleChangeEvent({...t,element:t.element})},isSelectionRangeChangeEvent(t){return r.multipleSelectionController.isSelectionRangeChangeEvent({...t,element:t.element})}},accessibilityProvider:r.accessibilityProvider&&{...r.accessibilityProvider,getPosInSet:void 0,getSetSize:void 0,getRole:r.accessibilityProvider.getRole?t=>r.accessibilityProvider.getRole(t.element):()=>"treeitem",isChecked:r.accessibilityProvider.isChecked?t=>!!r.accessibilityProvider?.isChecked(t.element):void 0,getAriaLabel(t){return r.accessibilityProvider.getAriaLabel(t.element)},getWidgetAriaLabel(){return r.accessibilityProvider.getWidgetAriaLabel()},getWidgetRole:r.accessibilityProvider.getWidgetRole?()=>r.accessibilityProvider.getWidgetRole():()=>"tree",getAriaLevel:r.accessibilityProvider.getAriaLevel&&(t=>r.accessibilityProvider.getAriaLevel(t.element)),getActiveDescendantId:r.accessibilityProvider.getActiveDescendantId&&(t=>r.accessibilityProvider.getActiveDescendantId(t.element))},filter:r.filter&&{filter(t,e){return r.filter.filter(t.element,e)}},keyboardNavigationLabelProvider:r.keyboardNavigationLabelProvider&&{...r.keyboardNavigationLabelProvider,getKeyboardNavigationLabel(t){return r.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(t.element)}},sorter:void 0,expandOnlyOnTwistieClick:typeof r.expandOnlyOnTwistieClick>"u"?void 0:typeof r.expandOnlyOnTwistieClick!="function"?r.expandOnlyOnTwistieClick:t=>r.expandOnlyOnTwistieClick(t.element),defaultFindVisibility:t=>t.hasChildren&&t.stale?1:typeof r.defaultFindVisibility=="number"?r.defaultFindVisibility:typeof r.defaultFindVisibility>"u"?2:r.defaultFindVisibility(t.element)}}function b6(r,t){t(r),r.children.forEach(e=>b6(e,t))}var _L=class{constructor(t,e,i,n,o,s={}){this.user=t;this.dataSource=o;this.identityProvider=s.identityProvider,this.autoExpandSingleChildren=typeof s.autoExpandSingleChildren>"u"?!1:s.autoExpandSingleChildren,this.sorter=s.sorter,this.getDefaultCollapseState=a=>s.collapseByDefault?s.collapseByDefault(a)?3:2:void 0,this.tree=this.createTree(t,e,i,n,s),this.onDidChangeFindMode=this.tree.onDidChangeFindMode,this.onDidChangeFindMatchType=this.tree.onDidChangeFindMatchType,this.root=c6({element:void 0,parent:null,hasChildren:!0,defaultCollapseState:void 0}),this.identityProvider&&(this.root={...this.root,id:null}),this.nodes.set(null,this.root),this.tree.onDidChangeCollapseState(this._onDidChangeCollapseState,this,this.disposables)}tree;root;nodes=new Map;sorter;getDefaultCollapseState;subTreeRefreshPromises=new Map;refreshPromises=new Map;identityProvider;autoExpandSingleChildren;_onDidRender=new x;_onDidChangeNodeSlowState=new x;nodeMapper=new KI(t=>new h6(t));disposables=new B;get onDidScroll(){return this.tree.onDidScroll}get onDidChangeFocus(){return X.map(this.tree.onDidChangeFocus,mde)}get onDidChangeSelection(){return X.map(this.tree.onDidChangeSelection,mde)}get onKeyDown(){return this.tree.onKeyDown}get onMouseClick(){return X.map(this.tree.onMouseClick,sB)}get onMouseDblClick(){return X.map(this.tree.onMouseDblClick,sB)}get onContextMenu(){return X.map(this.tree.onContextMenu,Iwe)}get onTap(){return X.map(this.tree.onTap,sB)}get onPointer(){return X.map(this.tree.onPointer,sB)}get onDidFocus(){return this.tree.onDidFocus}get onDidBlur(){return this.tree.onDidBlur}get onDidChangeModel(){return this.tree.onDidChangeModel}get onDidChangeCollapseState(){return this.tree.onDidChangeCollapseState}get onDidUpdateOptions(){return this.tree.onDidUpdateOptions}get onDidChangeFindOpenState(){return this.tree.onDidChangeFindOpenState}get onDidChangeStickyScrollFocused(){return this.tree.onDidChangeStickyScrollFocused}get findMode(){return this.tree.findMode}set findMode(t){this.tree.findMode=t}onDidChangeFindMode;get findMatchType(){return this.tree.findMatchType}set findMatchType(t){this.tree.findMatchType=t}onDidChangeFindMatchType;get expandOnlyOnTwistieClick(){if(typeof this.tree.expandOnlyOnTwistieClick=="boolean")return this.tree.expandOnlyOnTwistieClick;let t=this.tree.expandOnlyOnTwistieClick;return e=>t(this.nodes.get(e===this.root.element?null:e)||null)}get onDidDispose(){return this.tree.onDidDispose}createTree(t,e,i,n,o){let s=new Pw(i),a=n.map(d=>new m6(d,this.nodeMapper,this._onDidChangeNodeSlowState.event)),l=gde(o)||{};return new JI(t,e,s,a,l)}updateOptions(t={}){this.tree.updateOptions(t)}get options(){return this.tree.options}getHTMLElement(){return this.tree.getHTMLElement()}get contentHeight(){return this.tree.contentHeight}get contentWidth(){return this.tree.contentWidth}get onDidChangeContentHeight(){return this.tree.onDidChangeContentHeight}get onDidChangeContentWidth(){return this.tree.onDidChangeContentWidth}get scrollTop(){return this.tree.scrollTop}set scrollTop(t){this.tree.scrollTop=t}get scrollLeft(){return this.tree.scrollLeft}set scrollLeft(t){this.tree.scrollLeft=t}get scrollHeight(){return this.tree.scrollHeight}get renderHeight(){return this.tree.renderHeight}get lastVisibleElement(){return this.tree.lastVisibleElement.element}get ariaLabel(){return this.tree.ariaLabel}set ariaLabel(t){this.tree.ariaLabel=t}domFocus(){this.tree.domFocus()}layout(t,e){this.tree.layout(t,e)}style(t){this.tree.style(t)}getInput(){return this.root.element}async setInput(t,e){this.refreshPromises.forEach(n=>n.cancel()),this.refreshPromises.clear(),this.root.element=t;let i=e&&{viewState:e,focus:[],selection:[]};await this._updateChildren(t,!0,!1,i),i&&(this.tree.setFocus(i.focus),this.tree.setSelection(i.selection)),e&&typeof e.scrollTop=="number"&&(this.scrollTop=e.scrollTop)}async updateChildren(t=this.root.element,e=!0,i=!1,n){await this._updateChildren(t,e,i,void 0,n)}async _updateChildren(t=this.root.element,e=!0,i=!1,n,o){if(typeof this.root.element>"u")throw new Qn(this.user,"Tree input not set");this.root.refreshPromise&&(await this.root.refreshPromise,await X.toPromise(this._onDidRender.event));let s=this.getDataNode(t);if(await this.refreshAndRenderNode(s,e,n,o),i)try{this.tree.rerender(s)}catch{}}resort(t=this.root.element,e=!0){this.tree.resort(this.getDataNode(t),e)}hasNode(t){return t===this.root.element||this.nodes.has(t)}rerender(t){if(t===void 0||t===this.root.element){this.tree.rerender();return}let e=this.getDataNode(t);this.tree.rerender(e)}updateElementHeight(t,e){let i=this.getDataNode(t);this.tree.updateElementHeight(i,e)}updateWidth(t){let e=this.getDataNode(t);this.tree.updateWidth(e)}getNode(t=this.root.element){let e=this.getDataNode(t),i=this.tree.getNode(e===this.root?null:e);return this.nodeMapper.map(i)}collapse(t,e=!1){let i=this.getDataNode(t);return this.tree.collapse(i===this.root?null:i,e)}async expand(t,e=!1){if(typeof this.root.element>"u")throw new Qn(this.user,"Tree input not set");this.root.refreshPromise&&(await this.root.refreshPromise,await X.toPromise(this._onDidRender.event));let i=this.getDataNode(t);if(this.tree.hasElement(i)&&!this.tree.isCollapsible(i)||(i.refreshPromise&&(await this.root.refreshPromise,await X.toPromise(this._onDidRender.event)),i!==this.root&&!i.refreshPromise&&!this.tree.isCollapsed(i)))return!1;let n=this.tree.expand(i===this.root?null:i,e);return i.refreshPromise&&(await this.root.refreshPromise,await X.toPromise(this._onDidRender.event)),n}toggleCollapsed(t,e=!1){return this.tree.toggleCollapsed(this.getDataNode(t),e)}expandAll(){this.tree.expandAll()}async expandTo(t){if(!this.dataSource.getParent)throw new Error("Can't expand to element without getParent method");let e=[];for(;!this.hasNode(t);)t=this.dataSource.getParent(t),t!==this.root.element&&e.push(t);for(let i of mt.reverse(e))await this.expand(i);this.tree.expandTo(this.getDataNode(t))}collapseAll(){this.tree.collapseAll()}isCollapsible(t){return this.tree.isCollapsible(this.getDataNode(t))}isCollapsed(t){return this.tree.isCollapsed(this.getDataNode(t))}triggerTypeNavigation(){this.tree.triggerTypeNavigation()}openFind(){this.tree.openFind()}closeFind(){this.tree.closeFind()}refilter(){this.tree.refilter()}setAnchor(t){this.tree.setAnchor(typeof t>"u"?void 0:this.getDataNode(t))}getAnchor(){return this.tree.getAnchor()?.element}setSelection(t,e){let i=t.map(n=>this.getDataNode(n));this.tree.setSelection(i,e)}getSelection(){return this.tree.getSelection().map(e=>e.element)}setFocus(t,e){let i=t.map(n=>this.getDataNode(n));this.tree.setFocus(i,e)}focusNext(t=1,e=!1,i){this.tree.focusNext(t,e,i)}focusPrevious(t=1,e=!1,i){this.tree.focusPrevious(t,e,i)}focusNextPage(t){return this.tree.focusNextPage(t)}focusPreviousPage(t){return this.tree.focusPreviousPage(t)}focusLast(t){this.tree.focusLast(t)}focusFirst(t){this.tree.focusFirst(t)}getFocus(){return this.tree.getFocus().map(e=>e.element)}getStickyScrollFocus(){return this.tree.getStickyScrollFocus().map(e=>e.element)}getFocusedPart(){return this.tree.getFocusedPart()}reveal(t,e){this.tree.reveal(this.getDataNode(t),e)}getRelativeTop(t){return this.tree.getRelativeTop(this.getDataNode(t))}getParentElement(t){let e=this.tree.getParentElement(this.getDataNode(t));return e&&e.element}getFirstElementChild(t=this.root.element){let e=this.getDataNode(t),i=this.tree.getFirstElementChild(e===this.root?null:e);return i&&i.element}getDataNode(t){let e=this.nodes.get(t===this.root.element?null:t);if(!e)throw new Qn(this.user,`Data tree node not found: ${t}`);return e}async refreshAndRenderNode(t,e,i,n){await this.refreshNode(t,e,i),!this.disposables.isDisposed&&this.render(t,i,n)}async refreshNode(t,e,i){let n;if(this.subTreeRefreshPromises.forEach((o,s)=>{!n&&vwe(s,t)&&(n=o.then(()=>this.refreshNode(t,e,i)))}),n)return n;if(t!==this.root&&this.tree.getNode(t).collapsed){t.hasChildren=!!this.dataSource.hasChildren(t.element),t.stale=!0,this.setChildren(t,[],e,i);return}return this.doRefreshSubTree(t,e,i)}async doRefreshSubTree(t,e,i){let n;t.refreshPromise=new Promise(o=>n=o),this.subTreeRefreshPromises.set(t,t.refreshPromise),t.refreshPromise.finally(()=>{t.refreshPromise=void 0,this.subTreeRefreshPromises.delete(t)});try{let o=await this.doRefreshNode(t,e,i);t.stale=!1,await Xa.settled(o.map(s=>this.doRefreshSubTree(s,e,i)))}finally{n()}}async doRefreshNode(t,e,i){t.hasChildren=!!this.dataSource.hasChildren(t.element);let n;if(!t.hasChildren)n=Promise.resolve(mt.empty());else{let o=this.doGetChildren(t);if(T4(o))n=Promise.resolve(o);else{let s=To(800);s.then(()=>{t.slow=!0,this._onDidChangeNodeSlowState.fire(t)},a=>null),n=o.finally(()=>s.cancel())}}try{let o=await n;return this.setChildren(t,o,e,i)}catch(o){if(t!==this.root&&this.tree.hasElement(t)&&this.tree.collapse(t),vl(o))return[];throw o}finally{t.slow&&(t.slow=!1,this._onDidChangeNodeSlowState.fire(t))}}doGetChildren(t){let e=this.refreshPromises.get(t);if(e)return e;let i=this.dataSource.getChildren(t.element);return T4(i)?this.processChildren(i):(e=va(async()=>this.processChildren(await i)),this.refreshPromises.set(t,e),e.finally(()=>{this.refreshPromises.delete(t)}))}_onDidChangeCollapseState({node:t,deep:e}){t.element!==null&&!t.collapsed&&t.element.stale&&(e?this.collapse(t.element.element):this.refreshAndRenderNode(t.element,!1).catch(Xe))}setChildren(t,e,i,n){let o=[...e];if(t.children.length===0&&o.length===0)return[];let s=new Map,a=new Map;for(let c of t.children)s.set(c.element,c),this.identityProvider&&a.set(c.id,{node:c,collapsed:this.tree.hasElement(c)&&this.tree.isCollapsed(c)});let l=[],d=o.map(c=>{let p=!!this.dataSource.hasChildren(c);if(!this.identityProvider){let g=c6({element:c,parent:t,hasChildren:p,defaultCollapseState:this.getDefaultCollapseState(c)});return p&&g.defaultCollapseState===2&&l.push(g),g}let h=this.identityProvider.getId(c).toString(),m=a.get(h);if(m){let g=m.node;return s.delete(g.element),this.nodes.delete(g.element),this.nodes.set(c,g),g.element=c,g.hasChildren=p,i?m.collapsed?(g.children.forEach(v=>b6(v,I=>this.nodes.delete(I.element))),g.children.splice(0,g.children.length),g.stale=!0):l.push(g):p&&!m.collapsed&&l.push(g),g}let f=c6({element:c,parent:t,id:h,hasChildren:p,defaultCollapseState:this.getDefaultCollapseState(c)});return n&&n.viewState.focus&&n.viewState.focus.indexOf(h)>-1&&n.focus.push(f),n&&n.viewState.selection&&n.viewState.selection.indexOf(h)>-1&&n.selection.push(f),(n&&n.viewState.expanded&&n.viewState.expanded.indexOf(h)>-1||p&&f.defaultCollapseState===2)&&l.push(f),f});for(let c of s.values())b6(c,p=>this.nodes.delete(p.element));for(let c of d)this.nodes.set(c.element,c);return t.children.splice(0,t.children.length,...d),t!==this.root&&this.autoExpandSingleChildren&&d.length===1&&l.length===0&&(d[0].forceExpanded=!0,l.push(d[0])),l}render(t,e,i){let n=t.children.map(s=>this.asTreeElement(s,e)),o=i&&{...i,diffIdentityProvider:i.diffIdentityProvider&&{getId(s){return i.diffIdentityProvider.getId(s.element)}}};this.tree.setChildren(t===this.root?null:t,n,o),t!==this.root&&this.tree.setCollapsible(t,t.hasChildren),this._onDidRender.fire()}asTreeElement(t,e){if(t.stale)return{element:t,collapsible:t.hasChildren,collapsed:!0};let i;return e&&e.viewState.expanded&&t.id&&e.viewState.expanded.indexOf(t.id)>-1?i=!1:t.forceExpanded?(i=!1,t.forceExpanded=!1):i=t.defaultCollapseState,{element:t,children:t.hasChildren?mt.map(t.children,n=>this.asTreeElement(n,e)):[],collapsible:t.hasChildren,collapsed:i}}processChildren(t){return this.sorter&&(t=[...t].sort(this.sorter.compare.bind(this.sorter))),t}getViewState(){if(!this.identityProvider)throw new Qn(this.user,"Can't get tree view state without an identity provider");let t=a=>this.identityProvider.getId(a).toString(),e=this.getFocus().map(t),i=this.getSelection().map(t),n=[],o=this.tree.getNode(),s=[o];for(;s.length>0;){let a=s.pop();a!==o&&a.collapsible&&!a.collapsed&&n.push(t(a.element.element)),s.push(...a.children)}return{focus:e,selection:i,expanded:n,scrollTop:this.scrollTop}}dispose(){this.disposables.dispose(),this.tree.dispose()}},v6=class r{constructor(t){this.node=t}get element(){return{elements:this.node.element.elements.map(t=>t.element),incompressible:this.node.element.incompressible}}get children(){return this.node.children.map(t=>new r(t))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}},I6=class{constructor(t,e,i,n){this.renderer=t;this.nodeMapper=e;this.compressibleNodeMapperProvider=i;this.onDidChangeTwistieState=n;this.templateId=t.templateId}templateId;renderedNodes=new Map;disposables=[];renderTemplate(t){return{templateData:this.renderer.renderTemplate(t)}}renderElement(t,e,i,n){this.renderer.renderElement(this.nodeMapper.map(t),e,i.templateData,n)}renderCompressedElements(t,e,i,n){this.renderer.renderCompressedElements(this.compressibleNodeMapperProvider().map(t),e,i.templateData,n)}renderTwistie(t,e){return t.slow?(e.classList.add(...de.asClassNameArray(N.treeItemLoading)),!0):(e.classList.remove(...de.asClassNameArray(N.treeItemLoading)),!1)}disposeElement(t,e,i,n){this.renderer.disposeElement?.(this.nodeMapper.map(t),e,i.templateData,n)}disposeCompressedElements(t,e,i,n){this.renderer.disposeCompressedElements?.(this.compressibleNodeMapperProvider().map(t),e,i.templateData,n)}disposeTemplate(t){this.renderer.disposeTemplate(t.templateData)}dispose(){this.renderedNodes.clear(),this.disposables=_e(this.disposables)}};function ywe(r){let t=r&&gde(r);return t&&{...t,keyboardNavigationLabelProvider:t.keyboardNavigationLabelProvider&&{...t.keyboardNavigationLabelProvider,getCompressedNodeKeyboardNavigationLabel(e){return r.keyboardNavigationLabelProvider.getCompressedNodeKeyboardNavigationLabel(e.map(i=>i.element))}}}}var aB=class extends _L{constructor(e,i,n,o,s,a,l={}){super(e,i,n,s,a,l);this.compressionDelegate=o;this.filter=l.filter}compressibleNodeMapper=new KI(e=>new v6(e));filter;createTree(e,i,n,o,s){let a=new Pw(n),l=o.map(c=>new I6(c,this.nodeMapper,()=>this.compressibleNodeMapper,this._onDidChangeNodeSlowState.event)),d=ywe(s)||{};return new nE(e,i,a,l,d)}asTreeElement(e,i){return{incompressible:this.compressionDelegate.isIncompressible(e.element),...super.asTreeElement(e,i)}}updateOptions(e={}){this.tree.updateOptions(e)}getViewState(){if(!this.identityProvider)throw new Qn(this.user,"Can't get tree view state without an identity provider");let e=l=>this.identityProvider.getId(l).toString(),i=this.getFocus().map(e),n=this.getSelection().map(e),o=[],s=this.tree.getCompressedTreeNode(),a=[s];for(;a.length>0;){let l=a.pop();if(l!==s&&l.collapsible&&!l.collapsed)for(let d of l.element.elements)o.push(e(d.element));a.push(...l.children)}return{focus:i,selection:n,expanded:o,scrollTop:this.scrollTop}}render(e,i,n){if(!this.identityProvider)return super.render(e,i);let o=f=>this.identityProvider.getId(f).toString(),s=f=>{let g=new Set;for(let v of f){let I=this.tree.getCompressedTreeNode(v===this.root?null:v);if(I.element)for(let y of I.element.elements)g.add(o(y.element))}return g},a=s(this.tree.getSelection()),l=s(this.tree.getFocus());super.render(e,i,n);let d=this.getSelection(),c=!1,p=this.getFocus(),h=!1,m=f=>{let g=f.element;if(g)for(let v=0;v<g.elements.length;v++){let I=o(g.elements[v].element),y=g.elements[g.elements.length-1].element;a.has(I)&&d.indexOf(y)===-1&&(d.push(y),c=!0),l.has(I)&&p.indexOf(y)===-1&&(p.push(y),h=!0)}f.children.forEach(m)};m(this.tree.getCompressedTreeNode(e===this.root?null:e)),c&&this.setSelection(d),h&&this.setFocus(p)}processChildren(e){return this.filter&&(e=mt.filter(e,i=>{let n=this.filter.filter(i,1),o=Swe(n);if(o===2)throw new Error("Recursive tree visibility not supported in async data compressed trees");return o===1})),super.processChildren(e)}};function Swe(r){return typeof r=="boolean"?r?1:0:nL(r)?GI(r.visibility):GI(r)}var lB=class extends Mw{constructor(e,i,n,o,s,a={}){super(e,i,n,o,a);this.user=e;this.dataSource=s;this.identityProvider=a.identityProvider}input;identityProvider;nodesByIdentity=new Map;getInput(){return this.input}setInput(e,i){if(i&&!this.identityProvider)throw new Qn(this.user,"Can't restore tree view state without an identity provider");if(this.input=e,!e){this.nodesByIdentity.clear(),this.model.setChildren(null,mt.empty());return}if(!i){this._refresh(e);return}let n=[],o=[],s=l=>{let d=this.identityProvider.getId(l).toString();return!i.expanded[d]},a=l=>{let d=this.identityProvider.getId(l.element).toString();i.focus.has(d)&&n.push(l.element),i.selection.has(d)&&o.push(l.element)};this._refresh(e,s,a),this.setFocus(n),this.setSelection(o),i&&typeof i.scrollTop=="number"&&(this.scrollTop=i.scrollTop)}updateChildren(e=this.input){if(typeof this.input>"u")throw new Qn(this.user,"Tree input not set");let i;this.identityProvider&&(i=n=>{let o=this.identityProvider.getId(n).toString(),s=this.nodesByIdentity.get(o);if(s)return s.collapsed}),this._refresh(e,i)}resort(e=this.input,i=!0){this.model.resort(e===this.input?null:e,i)}refresh(e){if(e===void 0){this.view.rerender();return}this.model.rerender(e)}_refresh(e,i,n){let o;if(this.identityProvider){let s=new Set,a=n;n=l=>{let d=this.identityProvider.getId(l.element).toString();s.add(d),this.nodesByIdentity.set(d,l),a?.(l)},o=l=>{let d=this.identityProvider.getId(l.element).toString();s.has(d)||this.nodesByIdentity.delete(d)}}this.model.setChildren(e===this.input?null:e,this.iterate(e,i).elements,{onDidCreateNode:n,onDidDeleteNode:o})}iterate(e,i){let n=[...this.dataSource.getChildren(e)];return{elements:mt.map(n,s=>{let{elements:a,size:l}=this.iterate(s,i),d=this.dataSource.hasChildren?this.dataSource.hasChildren(s):void 0,c=l===0?void 0:i&&i(s);return{element:s,children:a,collapsible:d,collapsed:c}}),size:n.length}}createModel(e,i){return new pb(e,i)}};var _hi=new A("isMac",ye,u("isMac","Whether the operating system is macOS")),Dhi=new A("isLinux",ci,u("isLinux","Whether the operating system is Linux")),khi=new A("isWindows",St,u("isWindows","Whether the operating system is Windows")),ey=new A("isWeb",si,u("isWeb","Whether the platform is a web browser")),Bd=new A("isMacNative",ye&&!si,u("isMacNative","Whether the operating system is macOS on a non-browser platform")),fde=new A("isIOS",Hr,u("isIOS","Whether the operating system is iOS")),Lhi=new A("isMobile",AM,u("isMobile","Whether the platform is a mobile web browser")),bde=new A("isDevelopment",!1,!0),Rhi=new A("productQualityType","",u("productQualityType","Quality type of VS Code")),oE="inputFocus",dB=new A(oE,!1,u("inputFocus","Whether keyboard focus is inside an input box"));var Wo=q("listService");var kL=new A("listScrollAtBoundary","none"),vde=P.or(kL.isEqualTo("top"),kL.isEqualTo("both")),Ide=P.or(kL.isEqualTo("bottom"),kL.isEqualTo("both")),yde=new A("listFocus",!0),Sde=new A("treestickyScrollFocused",!1),vB=new A("listSupportsMultiselect",!0),Ih=P.and(yde,P.not(oE),Sde.negate()),w6=new A("listHasSelectionOrFocus",!1),E6=new A("listDoubleSelection",!1),x6=new A("listMultiSelection",!1),IB=new A("listSelectionNavigation",!1),Ewe=new A("listSupportsFind",!0),yB=new A("treeElementCanCollapse",!1),xwe=new A("treeElementHasParent",!1),SB=new A("treeElementCanExpand",!1),Twe=new A("treeElementHasChild",!1),_we=new A("treeFindOpen",!1),Cde="listTypeNavigationMode",wde="listAutomaticKeyboardNavigation";function CB(r,t){let e=r.createScoped(t.getHTMLElement());return yde.bindTo(e),e}function wB(r,t){let e=kL.bindTo(r),i=()=>{let n=t.scrollTop===0,o=t.scrollHeight-t.renderHeight-t.scrollTop<1;n&&o?e.set("both"):n?e.set("top"):o?e.set("bottom"):e.set("none")};return i(),t.onDidScroll(i)}var ty="workbench.list.multiSelectModifier",uB="workbench.list.openMode",Vd="workbench.list.horizontalScrolling",T6="workbench.list.defaultFindMode",_6="workbench.list.typeNavigationMode",pB="workbench.list.keyboardNavigation",Ru="workbench.list.scrollByPage",D6="workbench.list.defaultFindMatchType",LL="workbench.tree.indent",hB="workbench.tree.renderIndentGuides",Pu="workbench.list.smoothScrolling",fh="workbench.list.mouseWheelScrollSensitivity",bh="workbench.list.fastScrollSensitivity",mB="workbench.tree.expandMode",gB="workbench.tree.enableStickyScroll",fB="workbench.tree.stickyScrollMaxItemCount";function vh(r){return r.getValue(ty)==="alt"}var y6=class extends R{constructor(e){super();this.configurationService=e;this.useAltAsMultipleSelectionModifier=vh(e),this.registerListeners()}useAltAsMultipleSelectionModifier;registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(e=>{e.affectsConfiguration(ty)&&(this.useAltAsMultipleSelectionModifier=vh(this.configurationService))}))}isSelectionSingleChangeEvent(e){return this.useAltAsMultipleSelectionModifier?e.browserEvent.altKey:S7(e)}isSelectionRangeChangeEvent(e){return C7(e)}};function EB(r,t){let e=r.get(se),i=r.get(Be),n=new B;return[{...t,keyboardNavigationDelegate:{mightProducePrintableCharacter(s){return i.mightProducePrintableCharacter(s)}},smoothScrolling:!!e.getValue(Pu),mouseWheelScrollSensitivity:e.getValue(fh),fastScrollSensitivity:e.getValue(bh),multipleSelectionController:t.multipleSelectionController??n.add(new y6(e)),keyboardNavigationEventFilter:Dwe(i),scrollByPage:!!e.getValue(Ru)},n]}var rE=class extends ho{contextKeyService;listSupportsMultiSelect;listHasSelectionOrFocus;listDoubleSelection;listMultiSelection;horizontalScrolling;_useAltAsMultipleSelectionModifier;navigator;get onDidOpen(){return this.navigator.onDidOpen}constructor(t,e,i,n,o,s,a,l,d){let c=typeof o.horizontalScrolling<"u"?o.horizontalScrolling:!!l.getValue(Vd),[p,h]=d.invokeFunction(EB,o);super(t,e,i,n,{keyboardSupport:!1,...p,horizontalScrolling:c}),this.disposables.add(h),this.contextKeyService=CB(s,this),this.disposables.add(wB(this.contextKeyService,this)),this.listSupportsMultiSelect=vB.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(o.multipleSelectionSupport!==!1),IB.bindTo(this.contextKeyService).set(!!o.selectionNavigation),this.listHasSelectionOrFocus=w6.bindTo(this.contextKeyService),this.listDoubleSelection=E6.bindTo(this.contextKeyService),this.listMultiSelection=x6.bindTo(this.contextKeyService),this.horizontalScrolling=o.horizontalScrolling,this._useAltAsMultipleSelectionModifier=vh(l),this.disposables.add(this.contextKeyService),this.disposables.add(a.register(this)),this.updateStyles(o.overrideStyles),this.disposables.add(this.onDidChangeSelection(()=>{let f=this.getSelection(),g=this.getFocus();this.contextKeyService.bufferChangeEvents(()=>{this.listHasSelectionOrFocus.set(f.length>0||g.length>0),this.listMultiSelection.set(f.length>1),this.listDoubleSelection.set(f.length===2)})})),this.disposables.add(this.onDidChangeFocus(()=>{let f=this.getSelection(),g=this.getFocus();this.listHasSelectionOrFocus.set(f.length>0||g.length>0)})),this.disposables.add(l.onDidChangeConfiguration(f=>{f.affectsConfiguration(ty)&&(this._useAltAsMultipleSelectionModifier=vh(l));let g={};if(f.affectsConfiguration(Vd)&&this.horizontalScrolling===void 0){let v=!!l.getValue(Vd);g={...g,horizontalScrolling:v}}if(f.affectsConfiguration(Ru)){let v=!!l.getValue(Ru);g={...g,scrollByPage:v}}if(f.affectsConfiguration(Pu)){let v=!!l.getValue(Pu);g={...g,smoothScrolling:v}}if(f.affectsConfiguration(fh)){let v=l.getValue(fh);g={...g,mouseWheelScrollSensitivity:v}}if(f.affectsConfiguration(bh)){let v=l.getValue(bh);g={...g,fastScrollSensitivity:v}}Object.keys(g).length>0&&this.updateOptions(g)})),this.navigator=new bB(this,{configurationService:l,...o}),this.disposables.add(this.navigator)}updateOptions(t){super.updateOptions(t),t.overrideStyles!==void 0&&this.updateStyles(t.overrideStyles),t.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!t.multipleSelectionSupport)}updateStyles(t){this.style(t?qI(t):Nw)}get useAltAsMultipleSelectionModifier(){return this._useAltAsMultipleSelectionModifier}};rE=E([b(5,re),b(6,Wo),b(7,se),b(8,ne)],rE);var cB=class extends JF{contextKeyService;disposables;listSupportsMultiSelect;_useAltAsMultipleSelectionModifier;horizontalScrolling;navigator;get onDidOpen(){return this.navigator.onDidOpen}constructor(t,e,i,n,o,s,a,l,d){let c=typeof o.horizontalScrolling<"u"?o.horizontalScrolling:!!l.getValue(Vd),[p,h]=d.invokeFunction(EB,o);super(t,e,i,n,{keyboardSupport:!1,...p,horizontalScrolling:c}),this.disposables=new B,this.disposables.add(h),this.contextKeyService=CB(s,this),this.disposables.add(wB(this.contextKeyService,this.widget)),this.horizontalScrolling=o.horizontalScrolling,this.listSupportsMultiSelect=vB.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(o.multipleSelectionSupport!==!1),IB.bindTo(this.contextKeyService).set(!!o.selectionNavigation),this._useAltAsMultipleSelectionModifier=vh(l),this.disposables.add(this.contextKeyService),this.disposables.add(a.register(this)),this.updateStyles(o.overrideStyles),this.disposables.add(l.onDidChangeConfiguration(f=>{f.affectsConfiguration(ty)&&(this._useAltAsMultipleSelectionModifier=vh(l));let g={};if(f.affectsConfiguration(Vd)&&this.horizontalScrolling===void 0){let v=!!l.getValue(Vd);g={...g,horizontalScrolling:v}}if(f.affectsConfiguration(Ru)){let v=!!l.getValue(Ru);g={...g,scrollByPage:v}}if(f.affectsConfiguration(Pu)){let v=!!l.getValue(Pu);g={...g,smoothScrolling:v}}if(f.affectsConfiguration(fh)){let v=l.getValue(fh);g={...g,mouseWheelScrollSensitivity:v}}if(f.affectsConfiguration(bh)){let v=l.getValue(bh);g={...g,fastScrollSensitivity:v}}Object.keys(g).length>0&&this.updateOptions(g)})),this.navigator=new bB(this,{configurationService:l,...o}),this.disposables.add(this.navigator)}updateOptions(t){super.updateOptions(t),t.overrideStyles!==void 0&&this.updateStyles(t.overrideStyles),t.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!t.multipleSelectionSupport)}updateStyles(t){this.style(t?qI(t):Nw)}get useAltAsMultipleSelectionModifier(){return this._useAltAsMultipleSelectionModifier}dispose(){this.disposables.dispose(),super.dispose()}};cB=E([b(5,re),b(6,Wo),b(7,se),b(8,ne)],cB);var sE=class extends tB{contextKeyService;listSupportsMultiSelect;listHasSelectionOrFocus;listDoubleSelection;listMultiSelection;horizontalScrolling;_useAltAsMultipleSelectionModifier;navigator;get onDidOpen(){return this.navigator.onDidOpen}constructor(t,e,i,n,o,s,a,l,d,c){let p=typeof s.horizontalScrolling<"u"?s.horizontalScrolling:!!d.getValue(Vd),[h,m]=c.invokeFunction(EB,s);super(t,e,i,n,o,{keyboardSupport:!1,...h,horizontalScrolling:p}),this.disposables.add(m),this.contextKeyService=CB(a,this),this.disposables.add(wB(this.contextKeyService,this)),this.listSupportsMultiSelect=vB.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(s.multipleSelectionSupport!==!1),IB.bindTo(this.contextKeyService).set(!!s.selectionNavigation),this.listHasSelectionOrFocus=w6.bindTo(this.contextKeyService),this.listDoubleSelection=E6.bindTo(this.contextKeyService),this.listMultiSelection=x6.bindTo(this.contextKeyService),this.horizontalScrolling=s.horizontalScrolling,this._useAltAsMultipleSelectionModifier=vh(d),this.disposables.add(this.contextKeyService),this.disposables.add(l.register(this)),this.updateStyles(s.overrideStyles),this.disposables.add(this.onDidChangeSelection(()=>{let g=this.getSelection(),v=this.getFocus();this.contextKeyService.bufferChangeEvents(()=>{this.listHasSelectionOrFocus.set(g.length>0||v.length>0),this.listMultiSelection.set(g.length>1),this.listDoubleSelection.set(g.length===2)})})),this.disposables.add(this.onDidChangeFocus(()=>{let g=this.getSelection(),v=this.getFocus();this.listHasSelectionOrFocus.set(g.length>0||v.length>0)})),this.disposables.add(d.onDidChangeConfiguration(g=>{g.affectsConfiguration(ty)&&(this._useAltAsMultipleSelectionModifier=vh(d));let v={};if(g.affectsConfiguration(Vd)&&this.horizontalScrolling===void 0){let I=!!d.getValue(Vd);v={...v,horizontalScrolling:I}}if(g.affectsConfiguration(Ru)){let I=!!d.getValue(Ru);v={...v,scrollByPage:I}}if(g.affectsConfiguration(Pu)){let I=!!d.getValue(Pu);v={...v,smoothScrolling:I}}if(g.affectsConfiguration(fh)){let I=d.getValue(fh);v={...v,mouseWheelScrollSensitivity:I}}if(g.affectsConfiguration(bh)){let I=d.getValue(bh);v={...v,fastScrollSensitivity:I}}Object.keys(v).length>0&&this.updateOptions(v)})),this.navigator=new S6(this,{configurationService:d,...s}),this.disposables.add(this.navigator)}updateOptions(t){super.updateOptions(t),t.overrideStyles!==void 0&&this.updateStyles(t.overrideStyles),t.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!t.multipleSelectionSupport)}updateStyles(t){this.style(t?qI(t):Nw)}get useAltAsMultipleSelectionModifier(){return this._useAltAsMultipleSelectionModifier}dispose(){this.disposables.dispose(),super.dispose()}};sE=E([b(6,re),b(7,Wo),b(8,se),b(9,ne)],sE);var RL=class extends R{constructor(e,i){super();this.widget=e;this._register(X.filter(this.widget.onDidChangeSelection,n=>El(n.browserEvent))(n=>this.onSelectionFromKeyboard(n))),this._register(this.widget.onPointer(n=>this.onPointer(n.element,n.browserEvent))),this._register(this.widget.onMouseDblClick(n=>this.onMouseDblClick(n.element,n.browserEvent))),typeof i?.openOnSingleClick!="boolean"&&i?.configurationService?(this.openOnSingleClick=i?.configurationService.getValue(uB)!=="doubleClick",this._register(i?.configurationService.onDidChangeConfiguration(n=>{n.affectsConfiguration(uB)&&(this.openOnSingleClick=i?.configurationService.getValue(uB)!=="doubleClick")}))):this.openOnSingleClick=i?.openOnSingleClick??!0}openOnSingleClick;_onDidOpen=this._register(new x);onDidOpen=this._onDidOpen.event;onSelectionFromKeyboard(e){if(e.elements.length!==1)return;let i=e.browserEvent,n=typeof i.preserveFocus=="boolean"?i.preserveFocus:!0,o=typeof i.pinned=="boolean"?i.pinned:!n;this._open(this.getSelectedElement(),n,o,!1,e.browserEvent)}onPointer(e,i){if(!this.openOnSingleClick||i.detail===2)return;let o=i.button===1,s=!0,a=o,l=i.ctrlKey||i.metaKey||i.altKey;this._open(e,s,a,l,i)}onMouseDblClick(e,i){if(!i)return;let n=i.target;if(n.classList.contains("monaco-tl-twistie")||n.classList.contains("monaco-icon-label")&&n.classList.contains("folder-icon")&&i.offsetX<16)return;let s=!1,a=!0,l=i.ctrlKey||i.metaKey||i.altKey;this._open(e,s,a,l,i)}_open(e,i,n,o,s){e&&this._onDidOpen.fire({editorOptions:{preserveFocus:i,pinned:n,revealIfVisible:!0},sideBySide:o,element:e,browserEvent:s})}},bB=class extends RL{widget;constructor(t,e){super(t,e),this.widget=t}getSelectedElement(){return this.widget.getSelectedElements()[0]}},S6=class extends RL{constructor(t,e){super(t,e)}getSelectedElement(){return this.widget.getSelectedElements()[0]}},C6=class extends RL{constructor(t,e){super(t,e)}getSelectedElement(){return this.widget.getSelection()[0]??void 0}};function Dwe(r){let t=!1;return e=>{if(e.toKeyCodeChord().isModifierKey())return!1;if(t)return t=!1,!1;let i=r.softDispatch(e,e.target);return i.kind===1?(t=!0,!1):(t=!1,i.kind===0)}}var DL=class extends JI{internals;get contextKeyService(){return this.internals.contextKeyService}get useAltAsMultipleSelectionModifier(){return this.internals.useAltAsMultipleSelectionModifier}get onDidOpen(){return this.internals.onDidOpen}constructor(t,e,i,n,o,s,a,l,d){let{options:c,getTypeNavigationMode:p,disposable:h}=s.invokeFunction(PL,o);super(t,e,i,n,c),this.disposables.add(h),this.internals=new og(this,o,p,o.overrideStyles,a,l,d),this.disposables.add(this.internals)}updateOptions(t){super.updateOptions(t),this.internals.updateOptions(t)}};DL=E([b(5,ne),b(6,re),b(7,Wo),b(8,se)],DL);var aE=class extends nE{internals;get contextKeyService(){return this.internals.contextKeyService}get useAltAsMultipleSelectionModifier(){return this.internals.useAltAsMultipleSelectionModifier}get onDidOpen(){return this.internals.onDidOpen}constructor(t,e,i,n,o,s,a,l,d){let{options:c,getTypeNavigationMode:p,disposable:h}=s.invokeFunction(PL,o);super(t,e,i,n,c),this.disposables.add(h),this.internals=new og(this,o,p,o.overrideStyles,a,l,d),this.disposables.add(this.internals)}updateOptions(t={}){super.updateOptions(t),t.overrideStyles&&this.internals.updateStyleOverrides(t.overrideStyles),this.internals.updateOptions(t)}};aE=E([b(5,ne),b(6,re),b(7,Wo),b(8,se)],aE);var hb=class extends lB{internals;get contextKeyService(){return this.internals.contextKeyService}get useAltAsMultipleSelectionModifier(){return this.internals.useAltAsMultipleSelectionModifier}get onDidOpen(){return this.internals.onDidOpen}constructor(t,e,i,n,o,s,a,l,d,c){let{options:p,getTypeNavigationMode:h,disposable:m}=a.invokeFunction(PL,s);super(t,e,i,n,o,p),this.disposables.add(m),this.internals=new og(this,s,h,s.overrideStyles,l,d,c),this.disposables.add(this.internals)}updateOptions(t={}){super.updateOptions(t),t.overrideStyles!==void 0&&this.internals.updateStyleOverrides(t.overrideStyles),this.internals.updateOptions(t)}};hb=E([b(6,ne),b(7,re),b(8,Wo),b(9,se)],hb);var is=class extends _L{internals;get contextKeyService(){return this.internals.contextKeyService}get useAltAsMultipleSelectionModifier(){return this.internals.useAltAsMultipleSelectionModifier}get onDidOpen(){return this.internals.onDidOpen}constructor(t,e,i,n,o,s,a,l,d,c){let{options:p,getTypeNavigationMode:h,disposable:m}=a.invokeFunction(PL,s);super(t,e,i,n,o,p),this.disposables.add(m),this.internals=new og(this,s,h,s.overrideStyles,l,d,c),this.disposables.add(this.internals)}updateOptions(t={}){super.updateOptions(t),t.overrideStyles&&this.internals.updateStyleOverrides(t.overrideStyles),this.internals.updateOptions(t)}};is=E([b(6,ne),b(7,re),b(8,Wo),b(9,se)],is);var lE=class extends aB{internals;get contextKeyService(){return this.internals.contextKeyService}get useAltAsMultipleSelectionModifier(){return this.internals.useAltAsMultipleSelectionModifier}get onDidOpen(){return this.internals.onDidOpen}constructor(t,e,i,n,o,s,a,l,d,c,p){let{options:h,getTypeNavigationMode:m,disposable:f}=l.invokeFunction(PL,a);super(t,e,i,n,o,s,h),this.disposables.add(f),this.internals=new og(this,a,m,a.overrideStyles,d,c,p),this.disposables.add(this.internals)}updateOptions(t){super.updateOptions(t),this.internals.updateOptions(t)}};lE=E([b(7,ne),b(8,re),b(9,Wo),b(10,se)],lE);function Ede(r){let t=r.getValue(T6);if(t==="highlight")return 0;if(t==="filter")return 1;let e=r.getValue(pB);if(e==="simple"||e==="highlight")return 0;if(e==="filter")return 1}function xde(r){let t=r.getValue(D6);if(t==="fuzzy")return 0;if(t==="contiguous")return 1}function PL(r,t){let e=r.get(se),i=r.get(so),n=r.get(re),o=r.get(ne),s=()=>{let h=n.getContextKeyValue(Cde);if(h==="automatic")return 0;if(h==="trigger")return 1;if(n.getContextKeyValue(wde)===!1)return 1;let f=e.getValue(_6);if(f==="automatic")return 0;if(f==="trigger")return 1},a=t.horizontalScrolling!==void 0?t.horizontalScrolling:!!e.getValue(Vd),[l,d]=o.invokeFunction(EB,t),c=t.paddingBottom,p=t.renderIndentGuides!==void 0?t.renderIndentGuides:e.getValue(hB);return{getTypeNavigationMode:s,disposable:d,options:{keyboardSupport:!1,...l,indent:typeof e.getValue(LL)=="number"?e.getValue(LL):void 0,renderIndentGuides:p,smoothScrolling:!!e.getValue(Pu),defaultFindMode:Ede(e),defaultFindMatchType:xde(e),horizontalScrolling:a,scrollByPage:!!e.getValue(Ru),paddingBottom:c,hideTwistiesOfChildlessElements:t.hideTwistiesOfChildlessElements,expandOnlyOnTwistieClick:t.expandOnlyOnTwistieClick??e.getValue(mB)==="doubleClick",contextViewProvider:i,findWidgetStyles:Hae,enableStickyScroll:!!e.getValue(gB),stickyScrollMaxItemCount:Number(e.getValue(fB))}}}var og=class{constructor(t,e,i,n,o,s,a){this.tree=t;this.contextKeyService=CB(o,t),this.disposables.push(wB(this.contextKeyService,t)),this.listSupportsMultiSelect=vB.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(e.multipleSelectionSupport!==!1),IB.bindTo(this.contextKeyService).set(!!e.selectionNavigation),this.listSupportFindWidget=Ewe.bindTo(this.contextKeyService),this.listSupportFindWidget.set(e.findWidgetEnabled??!0),this.hasSelectionOrFocus=w6.bindTo(this.contextKeyService),this.hasDoubleSelection=E6.bindTo(this.contextKeyService),this.hasMultiSelection=x6.bindTo(this.contextKeyService),this.treeElementCanCollapse=yB.bindTo(this.contextKeyService),this.treeElementHasParent=xwe.bindTo(this.contextKeyService),this.treeElementCanExpand=SB.bindTo(this.contextKeyService),this.treeElementHasChild=Twe.bindTo(this.contextKeyService),this.treeFindOpen=_we.bindTo(this.contextKeyService),this.treeStickyScrollFocused=Sde.bindTo(this.contextKeyService),this._useAltAsMultipleSelectionModifier=vh(a),this.updateStyleOverrides(n);let d=()=>{let p=t.getFocus()[0];if(!p)return;let h=t.getNode(p);this.treeElementCanCollapse.set(h.collapsible&&!h.collapsed),this.treeElementHasParent.set(!!t.getParentElement(p)),this.treeElementCanExpand.set(h.collapsible&&h.collapsed),this.treeElementHasChild.set(!!t.getFirstElementChild(p))},c=new Set;c.add(Cde),c.add(wde),this.disposables.push(this.contextKeyService,s.register(t),t.onDidChangeSelection(()=>{let p=t.getSelection(),h=t.getFocus();this.contextKeyService.bufferChangeEvents(()=>{this.hasSelectionOrFocus.set(p.length>0||h.length>0),this.hasMultiSelection.set(p.length>1),this.hasDoubleSelection.set(p.length===2)})}),t.onDidChangeFocus(()=>{let p=t.getSelection(),h=t.getFocus();this.hasSelectionOrFocus.set(p.length>0||h.length>0),d()}),t.onDidChangeCollapseState(d),t.onDidChangeModel(d),t.onDidChangeFindOpenState(p=>this.treeFindOpen.set(p)),t.onDidChangeStickyScrollFocused(p=>this.treeStickyScrollFocused.set(p)),a.onDidChangeConfiguration(p=>{let h={};if(p.affectsConfiguration(ty)&&(this._useAltAsMultipleSelectionModifier=vh(a)),p.affectsConfiguration(LL)){let m=a.getValue(LL);h={...h,indent:m}}if(p.affectsConfiguration(hB)&&e.renderIndentGuides===void 0){let m=a.getValue(hB);h={...h,renderIndentGuides:m}}if(p.affectsConfiguration(Pu)){let m=!!a.getValue(Pu);h={...h,smoothScrolling:m}}if(p.affectsConfiguration(T6)||p.affectsConfiguration(pB)){let m=Ede(a);h={...h,defaultFindMode:m}}if(p.affectsConfiguration(_6)||p.affectsConfiguration(pB)){let m=i();h={...h,typeNavigationMode:m}}if(p.affectsConfiguration(D6)){let m=xde(a);h={...h,defaultFindMatchType:m}}if(p.affectsConfiguration(Vd)&&e.horizontalScrolling===void 0){let m=!!a.getValue(Vd);h={...h,horizontalScrolling:m}}if(p.affectsConfiguration(Ru)){let m=!!a.getValue(Ru);h={...h,scrollByPage:m}}if(p.affectsConfiguration(mB)&&e.expandOnlyOnTwistieClick===void 0&&(h={...h,expandOnlyOnTwistieClick:a.getValue(mB)==="doubleClick"}),p.affectsConfiguration(gB)){let m=a.getValue(gB);h={...h,enableStickyScroll:m}}if(p.affectsConfiguration(fB)){let m=Math.max(1,a.getValue(fB));h={...h,stickyScrollMaxItemCount:m}}if(p.affectsConfiguration(fh)){let m=a.getValue(fh);h={...h,mouseWheelScrollSensitivity:m}}if(p.affectsConfiguration(bh)){let m=a.getValue(bh);h={...h,fastScrollSensitivity:m}}Object.keys(h).length>0&&t.updateOptions(h)}),this.contextKeyService.onDidChangeContext(p=>{p.affectsSome(c)&&t.updateOptions({typeNavigationMode:i()})})),this.navigator=new C6(t,{configurationService:a,...e}),this.disposables.push(this.navigator)}contextKeyService;listSupportsMultiSelect;listSupportFindWidget;hasSelectionOrFocus;hasDoubleSelection;hasMultiSelection;treeElementCanCollapse;treeElementHasParent;treeElementCanExpand;treeElementHasChild;treeFindOpen;treeStickyScrollFocused;_useAltAsMultipleSelectionModifier;disposables=[];navigator;get onDidOpen(){return this.navigator.onDidOpen}get useAltAsMultipleSelectionModifier(){return this._useAltAsMultipleSelectionModifier}updateOptions(t){t.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!t.multipleSelectionSupport)}updateStyleOverrides(t){this.tree.style(t?qI(t):Nw)}dispose(){this.disposables=_e(this.disposables)}};og=E([b(4,re),b(5,Wo),b(6,se)],og);var kwe=Pe.as(ur.Configuration);kwe.registerConfiguration({id:"workbench",order:7,title:u("workbenchConfigurationTitle","Workbench"),type:"object",properties:{[ty]:{type:"string",enum:["ctrlCmd","alt"],markdownEnumDescriptions:[u("multiSelectModifier.ctrlCmd","Maps to `Control` on Windows and Linux and to `Command` on macOS."),u("multiSelectModifier.alt","Maps to `Alt` on Windows and Linux and to `Option` on macOS.")],default:"ctrlCmd",description:u({key:"multiSelectModifier",comment:["- `ctrlCmd` refers to a value the setting can take and should not be localized.","- `Control` and `Command` refer to the modifier keys Ctrl or Cmd on the keyboard and can be localized."]},"The modifier to be used to add an item in trees and lists to a multi-selection with the mouse (for example in the explorer, open editors and scm view). The 'Open to Side' mouse gestures - if supported - will adapt such that they do not conflict with the multiselect modifier.")},[uB]:{type:"string",enum:["singleClick","doubleClick"],default:"singleClick",description:u({key:"openModeModifier",comment:["`singleClick` and `doubleClick` refers to a value the setting can take and should not be localized."]},"Controls how to open items in trees and lists using the mouse (if supported). Note that some trees and lists might choose to ignore this setting if it is not applicable.")},[Vd]:{type:"boolean",default:!1,description:u("horizontalScrolling setting","Controls whether lists and trees support horizontal scrolling in the workbench. Warning: turning on this setting has a performance implication.")},[Ru]:{type:"boolean",default:!1,description:u("list.scrollByPage","Controls whether clicks in the scrollbar scroll page by page.")},[LL]:{type:"number",default:8,minimum:4,maximum:40,description:u("tree indent setting","Controls tree indentation in pixels.")},[hB]:{type:"string",enum:["none","onHover","always"],default:"onHover",description:u("render tree indent guides","Controls whether the tree should render indent guides.")},[Pu]:{type:"boolean",default:!1,description:u("list smoothScrolling setting","Controls whether lists and trees have smooth scrolling.")},[fh]:{type:"number",default:1,markdownDescription:u("Mouse Wheel Scroll Sensitivity","A multiplier to be used on the `deltaX` and `deltaY` of mouse wheel scroll events.")},[bh]:{type:"number",default:5,markdownDescription:u("Fast Scroll Sensitivity","Scrolling speed multiplier when pressing `Alt`.")},[T6]:{type:"string",enum:["highlight","filter"],enumDescriptions:[u("defaultFindModeSettingKey.highlight","Highlight elements when searching. Further up and down navigation will traverse only the highlighted elements."),u("defaultFindModeSettingKey.filter","Filter elements when searching.")],default:"highlight",description:u("defaultFindModeSettingKey","Controls the default find mode for lists and trees in the workbench.")},[pB]:{type:"string",enum:["simple","highlight","filter"],enumDescriptions:[u("keyboardNavigationSettingKey.simple","Simple keyboard navigation focuses elements which match the keyboard input. Matching is done only on prefixes."),u("keyboardNavigationSettingKey.highlight","Highlight keyboard navigation highlights elements which match the keyboard input. Further up and down navigation will traverse only the highlighted elements."),u("keyboardNavigationSettingKey.filter","Filter keyboard navigation will filter out and hide all the elements which do not match the keyboard input.")],default:"highlight",description:u("keyboardNavigationSettingKey","Controls the keyboard navigation style for lists and trees in the workbench. Can be simple, highlight and filter."),deprecated:!0,deprecationMessage:u("keyboardNavigationSettingKeyDeprecated","Please use 'workbench.list.defaultFindMode' and	'workbench.list.typeNavigationMode' instead.")},[D6]:{type:"string",enum:["fuzzy","contiguous"],enumDescriptions:[u("defaultFindMatchTypeSettingKey.fuzzy","Use fuzzy matching when searching."),u("defaultFindMatchTypeSettingKey.contiguous","Use contiguous matching when searching.")],default:"fuzzy",description:u("defaultFindMatchTypeSettingKey","Controls the type of matching used when searching lists and trees in the workbench.")},[mB]:{type:"string",enum:["singleClick","doubleClick"],default:"singleClick",description:u("expand mode","Controls how tree folders are expanded when clicking the folder names. Note that some trees and lists might choose to ignore this setting if it is not applicable.")},[gB]:{type:"boolean",default:!0,description:u("sticky scroll","Controls whether sticky scrolling is enabled in trees.")},[fB]:{type:"number",minimum:1,default:7,markdownDescription:u("sticky scroll maximum items","Controls the number of sticky elements displayed in the tree when {0} is enabled.","`#workbench.tree.enableStickyScroll#`")},[_6]:{type:"string",enum:["automatic","trigger"],default:"automatic",markdownDescription:u("typeNavigationMode2","Controls how type navigation works in lists and trees in the workbench. When set to `trigger`, type navigation begins once the `list.triggerTypeNavigation` command is run.")}}});var k6=ke("debug-console-view-icon",N.debugConsole,u("debugConsoleViewIcon","View icon of the debug console view.")),L6=ke("run-view-icon",N.debugAlt,u("runViewIcon","View icon of the run view.")),Tde=ke("variables-view-icon",N.debugAlt,u("variablesViewIcon","View icon of the variables view.")),_de=ke("watch-view-icon",N.debugAlt,u("watchViewIcon","View icon of the watch view.")),Dde=ke("callstack-view-icon",N.debugAlt,u("callStackViewIcon","View icon of the call stack view.")),kde=ke("breakpoints-view-icon",N.debugAlt,u("breakpointsViewIcon","View icon of the breakpoints view.")),Lde=ke("loaded-scripts-view-icon",N.debugAlt,u("loadedScriptsViewIcon","View icon of the loaded scripts view.")),_c={regular:ke("debug-breakpoint",N.debugBreakpoint,u("debugBreakpoint","Icon for breakpoints.")),disabled:ke("debug-breakpoint-disabled",N.debugBreakpointDisabled,u("debugBreakpointDisabled","Icon for disabled breakpoints.")),unverified:ke("debug-breakpoint-unverified",N.debugBreakpointUnverified,u("debugBreakpointUnverified","Icon for unverified breakpoints.")),pending:ke("debug-breakpoint-pending",N.debugBreakpointPending,u("debugBreakpointPendingOnTrigger","Icon for breakpoints waiting on another breakpoint."))},R6={regular:ke("debug-breakpoint-function",N.debugBreakpointFunction,u("debugBreakpointFunction","Icon for function breakpoints.")),disabled:ke("debug-breakpoint-function-disabled",N.debugBreakpointFunctionDisabled,u("debugBreakpointFunctionDisabled","Icon for disabled function breakpoints.")),unverified:ke("debug-breakpoint-function-unverified",N.debugBreakpointFunctionUnverified,u("debugBreakpointFunctionUnverified","Icon for unverified function breakpoints."))},P6={regular:ke("debug-breakpoint-conditional",N.debugBreakpointConditional,u("debugBreakpointConditional","Icon for conditional breakpoints.")),disabled:ke("debug-breakpoint-conditional-disabled",N.debugBreakpointConditionalDisabled,u("debugBreakpointConditionalDisabled","Icon for disabled conditional breakpoints.")),unverified:ke("debug-breakpoint-conditional-unverified",N.debugBreakpointConditionalUnverified,u("debugBreakpointConditionalUnverified","Icon for unverified conditional breakpoints."))},M6={regular:ke("debug-breakpoint-data",N.debugBreakpointData,u("debugBreakpointData","Icon for data breakpoints.")),disabled:ke("debug-breakpoint-data-disabled",N.debugBreakpointDataDisabled,u("debugBreakpointDataDisabled","Icon for disabled data breakpoints.")),unverified:ke("debug-breakpoint-data-unverified",N.debugBreakpointDataUnverified,u("debugBreakpointDataUnverified","Icon for unverified data breakpoints."))},xB={regular:ke("debug-breakpoint-log",N.debugBreakpointLog,u("debugBreakpointLog","Icon for log breakpoints.")),disabled:ke("debug-breakpoint-log-disabled",N.debugBreakpointLogDisabled,u("debugBreakpointLogDisabled","Icon for disabled log breakpoint.")),unverified:ke("debug-breakpoint-log-unverified",N.debugBreakpointLogUnverified,u("debugBreakpointLogUnverified","Icon for unverified log breakpoints."))},ML=ke("debug-hint",N.debugHint,u("debugBreakpointHint","Icon for breakpoint hints shown on hover in editor glyph margin.")),TB=ke("debug-breakpoint-unsupported",N.debugBreakpointUnsupported,u("debugBreakpointUnsupported","Icon for unsupported breakpoints.")),_B=[_c,R6,P6,M6,xB],iy=ke("debug-stackframe",N.debugStackframe,u("debugStackframe","Icon for a stackframe shown in the editor glyph margin.")),ny=ke("debug-stackframe-focused",N.debugStackframeFocused,u("debugStackframeFocused","Icon for a focused stackframe  shown in the editor glyph margin.")),Rde=ke("debug-gripper",N.gripper,u("debugGripper","Icon for the debug bar gripper.")),AL=ke("debug-restart-frame",N.debugRestartFrame,u("debugRestartFrame","Icon for the debug restart frame action.")),rg=ke("debug-stop",N.debugStop,u("debugStop","Icon for the debug stop action.")),Dc=ke("debug-disconnect",N.debugDisconnect,u("debugDisconnect","Icon for the debug disconnect action.")),oy=ke("debug-restart",N.debugRestart,u("debugRestart","Icon for the debug restart action.")),ry=ke("debug-step-over",N.debugStepOver,u("debugStepOver","Icon for the debug step over action.")),mb=ke("debug-step-into",N.debugStepInto,u("debugStepInto","Icon for the debug step into action.")),gb=ke("debug-step-out",N.debugStepOut,u("debugStepOut","Icon for the debug step out action.")),OL=ke("debug-step-back",N.debugStepBack,u("debugStepBack","Icon for the debug step back action.")),sy=ke("debug-pause",N.debugPause,u("debugPause","Icon for the debug pause action.")),ay=ke("debug-continue",N.debugContinue,u("debugContinue","Icon for the debug continue action.")),NL=ke("debug-reverse-continue",N.debugReverseContinue,u("debugReverseContinue","Icon for the debug reverse continue action.")),Pde=ke("debug-run",N.run,u("debugRun","Icon for the run or debug action.")),DB=ke("debug-start",N.debugStart,u("debugStart","Icon for the debug start action.")),dE=ke("debug-configure",N.gear,u("debugConfigure","Icon for the debug configure action.")),tgi=ke("debug-console",N.gear,u("debugConsole","Icon for the debug console open action.")),Mde=ke("debug-remove-config",N.trash,u("debugRemoveConfig","Icon for removing debug configurations.")),igi=ke("debug-collapse-all",N.collapseAll,u("debugCollapseAll","Icon for the collapse all action in the debug views.")),Ade=ke("callstack-view-session",N.bug,u("callstackViewSession","Icon for the session icon in the call stack view.")),Ode=ke("debug-console-clear-all",N.clearAll,u("debugConsoleClearAll","Icon for the clear all action in the debug console.")),Nde=ke("watch-expressions-remove-all",N.closeAll,u("watchExpressionsRemoveAll","Icon for the Remove All action in the watch view.")),Fde=ke("watch-expression-remove",N.removeClose,u("watchExpressionRemove","Icon for the Remove action in the watch view.")),Bde=ke("watch-expressions-add",N.add,u("watchExpressionsAdd","Icon for the add action in the watch view.")),Vde=ke("watch-expressions-add-function-breakpoint",N.add,u("watchExpressionsAddFuncBreakpoint","Icon for the add function breakpoint action in the watch view.")),Wde=ke("watch-expressions-add-data-breakpoint",N.variableGroup,u("watchExpressionsAddDataBreakpoint","Icon for the add data breakpoint action in the breakpoints view.")),Hde=ke("breakpoints-remove-all",N.closeAll,u("breakpointsRemoveAll","Icon for the Remove All action in the breakpoints view.")),Ude=ke("breakpoints-activate",N.activateBreakpoints,u("breakpointsActivate","Icon for the activate action in the breakpoints view.")),zde=ke("debug-console-evaluation-input",N.arrowSmallRight,u("debugConsoleEvaluationInput","Icon for the debug evaluation input marker.")),Kde=ke("debug-console-evaluation-prompt",N.chevronRight,u("debugConsoleEvaluationPrompt","Icon for the debug evaluation prompt.")),kB=ke("debug-inspect-memory",N.fileBinary,u("debugInspectMemory","Icon for the inspect memory action."));var LB=class{stopped=!1;stopEmitter=new x;onDidSessionStop=this.stopEmitter.event;sessionStopped(){this.stopped||(this.stopped=!0,this.stopEmitter.fire())}};var ni=q("ILanguageFeaturesService");var Lwe=/{([^}]+)}/g;function qde(r,t,e){return r.replace(Lwe,function(i,n){return t&&n.length>0&&n[0]!=="_"?i:e&&e.hasOwnProperty(n)?e[n]:i})}function $de(r){let t={};for(let e of Object.keys(r))e.startsWith("!")||(t[e]=r[e]);return t}function FL(r){return r.configuration.request==="attach"&&!BL(r)&&(!r.parentSession||FL(r.parentSession))}function BL(r){let t=r.configuration.type;if(t)return t==="vslsShare"&&(t=r.configuration.adapterProxy.configuration.type),dr(t,"extensionhost")||dr(t,"pwa-extensionhost")?r:r.parentSession?BL(r.parentSession):void 0}function jde(r){return r.type&&(r.label||r.program||r.runtime)}function Rwe(r,t,e){let i,n=0,o=/([^()\[\]{}<>\s+\-/%~#^;=|,`!]|\->)+/g,s=null;for(;s=o.exec(r);){let a=s.index+1,l=a+s[0].length;if(a<=t&&l>=e){i=s[0],n=a;break}}if(i){let a=/(\w|\p{L})+/gu,l=null;for(;(l=a.exec(i))&&!(l.index+1+n+l[0].length>=e););l&&(i=i.substring(0,a.lastIndex))}return i?{start:n,end:n+i.length-1}:{start:0,end:0}}async function RB(r,t,e,i){if(r.evaluatableExpressionProvider.has(t)){let n=r.evaluatableExpressionProvider.ordered(t),o=cn(await Promise.all(n.map(async s=>{try{return await s.provideEvaluatableExpression(t,e,i??Pt.None)}catch{return}})));if(o.length>0){let s=o[0].expression,a=o[0].range;return s||(s=t.getLineContent(e.lineNumber).substring(a.startColumn-1,a.endColumn-1)),{range:a,matchingExpression:s}}}else{let n=t.getLineContent(e.lineNumber),{start:o,end:s}=Rwe(n,e.column,e.column),a=n.substring(o-1,s);return{matchingExpression:a,range:new L(e.lineNumber,o,e.lineNumber,o+a.length)}}return null}var Pwe=/^[a-zA-Z][a-zA-Z0-9\+\-\.]+:/;function dy(r){return!!(r&&r.match(Pwe))}function A6(r){return r.filter(t=>!t.presentation?.hidden).sort((t,e)=>t.presentation?e.presentation?t.presentation.group?e.presentation.group?t.presentation.group!==e.presentation.group?t.presentation.group.localeCompare(e.presentation.group):Gde(t.presentation.order,e.presentation.order):-1:e.presentation.group?1:Gde(t.presentation.order,e.presentation.order):-1:e.presentation?1:0)}function Gde(r,t){return typeof r!="number"?typeof t!="number"?0:1:typeof t!="number"?-1:r-t}async function VL(r,t){let e=r.getValue("debug.saveBeforeStart",{overrideIdentifier:t.activeTextEditorLanguageId});if(e!=="none"&&(await t.saveAll(),e==="allEditorsInActiveGroup")){let i=t.activeEditorPane;i&&i.input.resource?.scheme===Ie.untitled&&await t.save({editor:i.input,groupId:i.group.id})}await r.reloadConfiguration()}var Xde=(r,t)=>!r||!t?r===t:r.name===t.name&&r.path===t.path&&r.sourceReference===t.sourceReference;var PB=u("unknownSource","Unknown Source"),yh=class{uri;available;raw;constructor(t,e,i,n){let o;t?(this.raw=t,o=this.raw.path||this.raw.name||"",this.available=!0):(this.raw={name:PB},this.available=!1,o=`${Gs}:${PB}`),this.uri=WL(this.raw,o,e,i,n)}get name(){return this.raw.name||Ns(this.uri)}get origin(){return this.raw.origin}get presentationHint(){return this.raw.presentationHint}get reference(){return this.raw.sourceReference}get inMemory(){return this.uri.scheme===Gs}openInEditor(t,e,i,n,o){return this.available?t.openEditor({resource:this.uri,description:this.origin,options:{preserveFocus:i,selection:e,revealIfOpened:!0,selectionRevealType:1,pinned:o}},n?Vl:Zp):Promise.resolve(void 0)}static getEncodedDebugData(t){let e,i,n;switch(t.scheme){case Ie.file:e=ds(t.fsPath);break;case Gs:if(e=t.path,t.query){let o=t.query.split("&");for(let s of o){let a=s.split("=");if(a.length===2)switch(a[0]){case"session":n=a[1];break;case"ref":i=parseInt(a[1]);break}}}break;default:e=t.toString();break}return{name:Ns(t),path:e,sourceReference:i,sessionId:n}}};function WL(r,t,e,i,n){let o=s=>typeof r.sourceReference=="number"&&r.sourceReference>0?Z.from({scheme:Gs,path:s?.replace(/^\/+/g,"/"),query:`session=${e}&ref=${r.sourceReference}`}):s&&dy(s)?i.asCanonicalUri(Z.parse(s)):s&&ja(s)?i.asCanonicalUri(Z.file(s)):i.asCanonicalUri(Z.from({scheme:Gs,path:s,query:`session=${e}`}));try{return o(t)}catch{return n.error("Invalid path from debug adapter: "+t),o("/invalidDebugSource")}}var MB="debug.breakpoint",AB="debug.functionbreakpoint",OB="debug.databreakpoint",NB="debug.exceptionbreakpoint",FB="debug.watchexpressions",Yde="debug.chosenenvironment",Qde="debug.uxstate",uE=class extends R{constructor(e,i,n,o){super();this.storageService=e;this.textFileService=i;this.uriIdentityService=n;this.logService=o;this._register(e.onDidChangeValue(1,void 0,this._store)(s=>{if(s.external)switch(s.key){case MB:return this.breakpoints.set(this.loadBreakpoints(),void 0);case AB:return this.functionBreakpoints.set(this.loadFunctionBreakpoints(),void 0);case NB:return this.exceptionBreakpoints.set(this.loadExceptionBreakpoints(),void 0);case OB:return this.dataBreakpoints.set(this.loadDataBreakpoints(),void 0);case FB:return this.watchExpressions.set(this.loadWatchExpressions(),void 0)}}))}breakpoints=Ht(this,this.loadBreakpoints());functionBreakpoints=Ht(this,this.loadFunctionBreakpoints());exceptionBreakpoints=Ht(this,this.loadExceptionBreakpoints());dataBreakpoints=Ht(this,this.loadDataBreakpoints());watchExpressions=Ht(this,this.loadWatchExpressions());loadDebugUxState(){return this.storageService.get(Qde,1,"default")}storeDebugUxState(e){this.storageService.store(Qde,e,1,1)}loadBreakpoints(){let e;try{e=JSON.parse(this.storageService.get(MB,1,"[]")).map(i=>(i.uri=Z.revive(i.uri),new ir(i,this.textFileService,this.uriIdentityService,this.logService,i.id)))}catch{}return e||[]}loadFunctionBreakpoints(){let e;try{e=JSON.parse(this.storageService.get(AB,1,"[]")).map(i=>new ns(i,i.id))}catch{}return e||[]}loadExceptionBreakpoints(){let e;try{e=JSON.parse(this.storageService.get(NB,1,"[]")).map(i=>new kc(i,i.id))}catch{}return e||[]}loadDataBreakpoints(){let e;try{e=JSON.parse(this.storageService.get(OB,1,"[]")).map(i=>new xs(i,i.id))}catch{}return e||[]}loadWatchExpressions(){let e;try{e=JSON.parse(this.storageService.get(FB,1,"[]")).map(i=>new Hi(i.name,i.id))}catch{}return e||[]}loadChosenEnvironments(){return JSON.parse(this.storageService.get(Yde,1,"{}"))}storeChosenEnvironments(e){this.storageService.store(Yde,JSON.stringify(e),1,1)}storeWatchExpressions(e){e.length?this.storageService.store(FB,JSON.stringify(e.map(i=>({name:i.name,id:i.getId()}))),1,1):this.storageService.remove(FB,1)}storeBreakpoints(e){let i=e.getBreakpoints();i.length?this.storageService.store(MB,JSON.stringify(i),1,1):this.storageService.remove(MB,1);let n=e.getFunctionBreakpoints();n.length?this.storageService.store(AB,JSON.stringify(n),1,1):this.storageService.remove(AB,1);let o=e.getDataBreakpoints().filter(a=>a.canPersist);o.length?this.storageService.store(OB,JSON.stringify(o),1,1):this.storageService.remove(OB,1);let s=e.getExceptionBreakpoints();s.length?this.storageService.store(NB,JSON.stringify(s),1,1):this.storageService.remove(NB,1)}};uE=E([b(0,nt),b(1,Us),b(2,zn),b(3,bt)],uE);function BB(r,t,e=[]){let i=t.getSession(),n=[[Zde.key,t.variableMenuContext||""],[bb.key,!!t.evaluateName],[fb.key,!!i?.capabilities.supportsReadMemoryRequest&&t.memoryReference!==void 0],[cy.key,!!t.presentationHint?.attributes?.includes("readOnly")||t.presentationHint?.lazy],[VB.key,i?.configuration.type],...e];return r.createOverlay(n)}var hE=q("debugVisualizerService"),O6=class{constructor(t,e){this.handle=t;this.viz=e}get name(){return this.viz.name}get iconPath(){return this.viz.iconPath}get iconClass(){return this.viz.iconClass}async resolve(t){return this.viz.visualization??=await this.handle.resolveDebugVisualizer(this.viz,t)}async execute(){await this.handle.executeDebugVisualizerCommand(this.viz.id)}},Jde={object:[],dispose:()=>{}},pE=class{constructor(t,e,i){this.contextKeyService=t;this.extensionService=e;this.logService=i;Mwe.setHandler((n,{added:o,removed:s})=>{this.registrations=this.registrations.filter(a=>!s.some(l=>Qr.equals(l.description.identifier,a.extensionId))),o.forEach(a=>this.processExtensionRegistration(a.description))})}handles=new Map;trees=new Map;didActivate=new Map;registrations=[];async getApplicableFor(t,e){if(!(t instanceof Li))return Jde;let i=t.getThreadId();if(i===void 0)return Jde;let n=this.getVariableContext(i,t),o=BB(this.contextKeyService,t,[[HB.key,t.name],[mE.key,t.value],[WB.key,t.type]]),s=await Promise.all(this.registrations.map(async l=>{if(!o.contextMatchesRules(l.expr))return;let d=this.didActivate.get(l.id);if(d||(d=this.extensionService.activateByEvent(`onDebugVisualizer:${l.id}`),this.didActivate.set(l.id,d)),await d,e.isCancellationRequested)return;let c=this.handles.get(ece(l.extensionId,l.id));return c&&{handle:c,result:await c.provideDebugVisualizers(n,e)}})),a={object:s.filter(go).flatMap(l=>l.result.map(d=>new O6(l.handle,d))),dispose:()=>{for(let l of s)l?.handle.disposeDebugVisualizers(l.result.map(d=>d.id))}};return e.isCancellationRequested&&a.dispose(),a}register(t){let e=ece(t.extensionId,t.id);return this.handles.set(e,t),le(()=>this.handles.delete(e))}registerTree(t,e){return this.trees.set(t,e),le(()=>this.trees.delete(t))}async getVisualizedNodeFor(t,e){if(!(e instanceof Li))return;let i=e.getThreadId();if(i===void 0)return;let n=this.trees.get(t);if(n)try{let o=await n.getTreeItem(this.getVariableContext(i,e));return o?new Xl(this,t,o,e):void 0}catch(o){this.logService.warn("Failed to get visualized node",o);return}}async getVisualizedChildren(t,e){return(await this.trees.get(t)?.getChildren(e)||[]).map(n=>new Xl(this,t,n,void 0))}async editTreeItem(t,e,i){let n=await this.trees.get(t)?.editItem?.(e.id,i);n&&Object.assign(e,n)}getVariableContext(t,e){let i={sessionId:e.getSession()?.getId()||"",containerId:e.parent instanceof Li?e.reference:void 0,threadId:t,variable:{name:e.name,value:e.value,type:e.type,evaluateName:e.evaluateName,variablesReference:e.reference||0,indexedVariables:e.indexedVariables,memoryReference:e.memoryReference,namedVariables:e.namedVariables,presentationHint:e.presentationHint}};for(let n=e;n instanceof Li;n=n.parent)n.parent instanceof sg&&(i.frameId=n.parent.stackFrame.frameId);return i}processExtensionRegistration(t){let e=t.contributes?.debugVisualizers;if(e instanceof Array)for(let{when:i,id:n}of e)try{let o=P.deserialize(i);o&&this.registrations.push({expr:o,id:n,extensionId:t.identifier})}catch(o){this.logService.error(`Error processing debug visualizer registration from extension '${t.identifier.value}'`,o)}}};pE=E([b(0,re),b(1,_n),b(2,bt)],pE);var ece=(r,t)=>`${Qr.toKey(r)}\0${t}`,Mwe=Ra.registerExtensionPoint({extensionPoint:"debugVisualizers",jsonSchema:{type:"array",items:{type:"object",properties:{id:{type:"string",description:"Name of the debug visualizer"},when:{type:"string",description:"Condition when the debug visualizer is applicable"}},required:["id","when"]}},activationEventsGenerator:(r,t)=>{for(let e of r)e.id&&t.push(`onDebugVisualizer:${e.id}`)}});var Awe=ke("disassembly-editor-label-icon",N.debug,u("disassemblyEditorLabelIcon","Icon of the disassembly editor label.")),Yl=class r extends Bl{static ID="debug.disassemblyView.input";get typeId(){return r.ID}static _instance;static get instance(){return(!r._instance||r._instance.isDisposed())&&(r._instance=new r),r._instance}resource=void 0;getName(){return u("disassemblyInputName","Disassembly")}getIcon(){return Awe}matches(t){return t instanceof r}};var Wd=class r{constructor(t,e,i,n,o=0,s=0,a=void 0,l=0,d=void 0,c=void 0){this.session=t;this.threadId=e;this._reference=i;this.id=n;this.namedVariables=o;this.indexedVariables=s;this.memoryReference=a;this.startOfVariables=l;this.presentationHint=d;this.valueLocationReference=c}static allValues=new Map;static BASE_CHUNK_SIZE=100;type;valueChanged=!1;_value="";children;get reference(){return this._reference}set reference(t){this._reference=t,this.children=void 0}async evaluateLazy(){if(typeof this.reference>"u")return;let t=await this.session.variables(this.reference,this.threadId,void 0,void 0,void 0);if(!t||!t.body||!t.body.variables||t.body.variables.length!==1)return;let e=t.body.variables[0];this.reference=e.variablesReference,this._value=e.value,this.namedVariables=e.namedVariables,this.indexedVariables=e.indexedVariables,this.memoryReference=e.memoryReference,this.presentationHint=e.presentationHint,this.valueLocationReference=e.valueLocationReference,this.adoptLazyResponse(e)}adoptLazyResponse(t){}getChildren(){return this.children||(this.children=this.doGetChildren()),this.children}async doGetChildren(){if(!this.hasChildren)return[];if(!this.getChildrenInChunks)return this.fetchVariables(void 0,void 0,void 0);let t=this.namedVariables?await this.fetchVariables(void 0,void 0,"named"):[],e=r.BASE_CHUNK_SIZE;for(;this.indexedVariables&&this.indexedVariables>e*r.BASE_CHUNK_SIZE;)e*=r.BASE_CHUNK_SIZE;if(this.indexedVariables&&this.indexedVariables>e){let n=Math.ceil(this.indexedVariables/e);for(let o=0;o<n;o++){let s=(this.startOfVariables||0)+o*e,a=Math.min(e,this.indexedVariables-o*e);t.push(new Li(this.session,this.threadId,this,this.reference,`[${s}..${s+a-1}]`,"","",void 0,a,void 0,{kind:"virtual"},void 0,void 0,!0,s))}return t}let i=await this.fetchVariables(this.startOfVariables,this.indexedVariables,"indexed");return t.concat(i)}getId(){return this.id}getSession(){return this.session}get value(){return this._value}get hasChildren(){return!!this.reference&&this.reference>0&&!this.presentationHint?.lazy}async fetchVariables(t,e,i){try{let n=await this.session.variables(this.reference||0,this.threadId,i,t,e);if(!n||!n.body||!n.body.variables)return[];let o=new Map,s=n.body.variables.filter(a=>!!a).map(a=>{if(Bt(a.value)&&Bt(a.name)&&typeof a.variablesReference=="number"){let l=o.get(a.name)||0,d=l>0?l.toString():"";return o.set(a.name,l+1),new Li(this.session,this.threadId,this,a.variablesReference,a.name,a.evaluateName,a.value,a.namedVariables,a.indexedVariables,a.memoryReference,a.presentationHint,a.type,a.__vscodeVariableMenuContext,!0,0,d,a.declarationLocationReference,a.valueLocationReference)}return new Li(this.session,this.threadId,this,0,"",void 0,u("invalidVariableAttributes","Invalid variable attributes"),0,0,void 0,{kind:"virtual"},void 0,void 0,!1)});return this.session.autoExpandLazyVariables&&await Promise.all(s.map(a=>a.presentationHint?.lazy&&a.evaluateLazy())),s}catch(n){return[new Li(this.session,this.threadId,this,0,"",void 0,n.message,0,0,void 0,{kind:"virtual"},void 0,void 0,!1)]}}get getChildrenInChunks(){return!!this.indexedVariables}set value(t){this._value=t,this.valueChanged=!!r.allValues.get(this.getId())&&r.allValues.get(this.getId())!==Hi.DEFAULT_VALUE&&r.allValues.get(this.getId())!==t,r.allValues.set(this.getId(),t)}toString(){return this.value}async evaluateExpression(t,e,i,n,o=!1,s){if(!e||!i&&n!=="repl")return this.value=n==="repl"?u("startDebugFirst","Please start a debug session to evaluate expressions"):Hi.DEFAULT_VALUE,this.reference=0,!1;this.session=e;try{let a=await e.evaluate(t,i?i.frameId:void 0,n,s);return a&&a.body?(this.value=a.body.result||"",this.reference=a.body.variablesReference,this.namedVariables=a.body.namedVariables,this.indexedVariables=a.body.indexedVariables,this.memoryReference=a.body.memoryReference,this.type=a.body.type||this.type,this.presentationHint=a.body.presentationHint,this.valueLocationReference=a.body.valueLocationReference,!o&&a.body.presentationHint?.lazy&&await this.evaluateLazy(),!0):!1}catch(a){return this.value=a.message||"",this.reference=0,!1}}};function N6(r,t){t&&t.body&&(r.value=t.body.value||"",r.type=t.body.type||r.type,r.reference=t.body.variablesReference,r.namedVariables=t.body.namedVariables,r.indexedVariables=t.body.indexedVariables)}var Xl=class{constructor(t,e,i,n){this.visualizer=t;this.treeId=e;this.treeItem=i;this.original=n}errorMessage;id=Ni();evaluateLazy(){return Promise.resolve()}getChildren(){return this.visualizer.getVisualizedChildren(this.treeId,this.treeItem.id)}getId(){return this.id}get name(){return this.treeItem.label}get value(){return this.treeItem.description||""}get hasChildren(){return this.treeItem.collapsibleState!==0}async edit(t){try{return await this.visualizer.editTreeItem(this.treeId,this.treeItem,t),!0}catch(e){return this.errorMessage=e.message,!1}}},Hi=class r extends Wd{constructor(e,i=Ni()){super(void 0,void 0,0,i);this.name=e;this.available=!1,e&&(this.value=r.DEFAULT_VALUE)}static DEFAULT_VALUE=u("notAvailable","not available");available;_onDidChangeValue=new x;onDidChangeValue=this._onDidChangeValue.event;async evaluate(e,i,n,o,s){let a=this.value===r.DEFAULT_VALUE;this.available=await this.evaluateExpression(this.name,e,i,n,o,s),(a||this.valueChanged)&&this._onDidChangeValue.fire(this)}toString(){return`${this.name}
${this.value}`}async setExpression(e,i){if(!this.session)return;let n=await this.session.setExpression(i.frameId,this.name,e);N6(this,n)}},Li=class extends Wd{constructor(e,i,n,o,s,a,l,d,c,p,h,m=void 0,f=void 0,g=!0,v=0,I="",y=void 0,w=void 0){super(e,i,o,`variable:${n.getId()}:${s}:${I}`,d,c,p,v,h,w);this.parent=n;this.name=s;this.evaluateName=a;this.variableMenuContext=f;this.available=g;this.declarationLocationReference=y;this.value=l||"",this.type=m}errorMessage;getThreadId(){return this.threadId}async setVariable(e,i){if(this.session)try{if(this.session.capabilities.supportsSetExpression&&!this.session.capabilities.supportsSetVariable&&this.evaluateName)return this.setExpression(e,i);let n=await this.session.setVariable(this.parent.reference,this.name,e);N6(this,n)}catch(n){this.errorMessage=n.message}}async setExpression(e,i){if(!this.session||!this.evaluateName)return;let n=await this.session.setExpression(i.frameId,this.evaluateName,e);N6(this,n)}toString(){return this.name?`${this.name}: ${this.value}`:this.value}adoptLazyResponse(e){this.evaluateName=e.evaluateName}toDebugProtocolObject(){return{name:this.name,variablesReference:this.reference||0,memoryReference:this.memoryReference,value:this.value,evaluateName:this.evaluateName}}},sg=class extends Wd{constructor(e,i,n,o,s,a,l,d){super(e.thread.session,e.thread.threadId,o,`scope:${n}:${i}`,a,l);this.stackFrame=e;this.name=n;this.expensive=s;this.range=d}toString(){return this.name}toDebugProtocolObject(){return{name:this.name,variablesReference:this.reference||0,expensive:this.expensive}}},UL=class extends sg{constructor(t,e,i){super(t,e,i,0,!1)}toString(){return this.name}},Ma=class{constructor(t,e,i,n,o,s,a,l,d){this.thread=t;this.frameId=e;this.source=i;this.name=n;this.presentationHint=o;this.range=s;this.index=a;this.canRestart=l;this.instructionPointerReference=d}scopes;getId(){return`stackframe:${this.thread.getId()}:${this.index}:${this.source.name}`}getScopes(){return this.scopes||(this.scopes=this.thread.session.scopes(this.frameId,this.thread.threadId).then(t=>{if(!t||!t.body||!t.body.scopes)return[];let e=new Set;return t.body.scopes.map(i=>{let n=0;do n=qS(`${i.name}:${i.line}:${i.column}`,n);while(e.has(n));return e.add(n),new sg(this,n,i.name,i.variablesReference,i.expensive,i.namedVariables,i.indexedVariables,i.line&&i.column&&i.endLine&&i.endColumn?new L(i.line,i.column,i.endLine,i.endColumn):void 0)})},t=>[new UL(this,0,t.message)])),this.scopes}async getMostSpecificScopes(t){let i=(await this.getScopes()).filter(s=>!s.expensive);if(!i.some(s=>!!s.range))return i;let o=i.filter(s=>s.range&&L.containsRange(s.range,t)).sort((s,a)=>s.range.endLineNumber-s.range.startLineNumber-(a.range.endLineNumber-a.range.startLineNumber));return o.length?o:i}restart(){return this.thread.session.restartFrame(this.frameId,this.thread.threadId)}forgetScopes(){this.scopes=void 0}toString(){let t=typeof this.range.startLineNumber=="number"?`:${this.range.startLineNumber}`:"",e=`${this.source.inMemory?this.source.name:this.source.uri.fsPath}${t}`;return e===PB?this.name:`${this.name} (${e})`}async openInEditor(t,e,i,n){let o=this.thread.stoppedDetails?.reason;if(this.instructionPointerReference&&(o==="instruction breakpoint"||o==="step"&&this.thread.lastSteppingGranularity==="instruction"||t.activeEditor instanceof Yl))return t.openEditor(Yl.instance,{pinned:!0,revealIfOpened:!0});if(this.source.available)return this.source.openInEditor(t,this.range,e,i,n)}equals(t){return this.name===t.name&&t.thread===this.thread&&this.frameId===t.frameId&&t.source===this.source&&L.equalsRange(this.range,t.range)}},Owe=["breakpoint","step","function breakpoint"],Hd=class{constructor(t,e,i){this.session=t;this.name=e;this.threadId=i;this.callStack=[],this.staleCallStack=[],this.stopped=!1}callStack;staleCallStack;callStackCancellationTokens=[];stoppedDetails;stopped;reachedEndOfCallStack=!1;lastSteppingGranularity;getId(){return`thread:${this.session.getId()}:${this.threadId}`}clearCallStack(){this.callStack.length&&(this.staleCallStack=this.callStack),this.callStack=[],this.callStackCancellationTokens.forEach(t=>t.dispose(!0)),this.callStackCancellationTokens=[]}getCallStack(){return this.callStack}getStaleCallStack(){return this.staleCallStack}getTopStackFrame(){let t=this.getCallStack(),e=this.stoppedDetails?.reason;return t.find(n=>!!((e==="instruction breakpoint"||e==="step"&&this.lastSteppingGranularity==="instruction")&&n.instructionPointerReference||n.source&&n.source.available&&(Owe.includes(e)||!Sh(n))))}get stateLabel(){return this.stoppedDetails?this.stoppedDetails.description||(this.stoppedDetails.reason?u({key:"pausedOn",comment:["indicates reason for program being paused"]},"Paused on {0}",this.stoppedDetails.reason):u("paused","Paused")):u({key:"running",comment:["indicates state"]},"Running")}async fetchCallStack(t=20){if(this.stopped){let e=this.callStack.length,i=await this.getCallStackImpl(e,t);this.reachedEndOfCallStack=i.length<t,e<this.callStack.length&&this.callStack.splice(e,this.callStack.length-e),this.callStack=this.callStack.concat(i||[]),typeof this.stoppedDetails?.totalFrames=="number"&&this.stoppedDetails.totalFrames===this.callStack.length&&(this.reachedEndOfCallStack=!0)}}async getCallStackImpl(t,e){try{let i=new Kt;this.callStackCancellationTokens.push(i);let n=await this.session.stackTrace(this.threadId,t,e,i.token);return!n||!n.body||i.token.isCancellationRequested?[]:(this.stoppedDetails&&(this.stoppedDetails.totalFrames=n.body.totalFrames),n.body.stackFrames.map((o,s)=>{let a=this.session.getSource(o.source);return new Ma(this,o.id,a,o.name,o.presentationHint,new L(o.line,o.column,o.endLine||o.line,o.endColumn||o.column),t+s,typeof o.canRestart=="boolean"?o.canRestart:!0,o.instructionPointerReference)}))}catch(i){return this.stoppedDetails&&(this.stoppedDetails.framesErrorMessage=i.message),[]}}get exceptionInfo(){return this.stoppedDetails&&this.stoppedDetails.reason==="exception"?this.session.capabilities.supportsExceptionInfoRequest?this.session.exceptionInfo(this.threadId):Promise.resolve({description:this.stoppedDetails.text,breakMode:null}):Promise.resolve(void 0)}next(t){return this.session.next(this.threadId,t)}stepIn(t){return this.session.stepIn(this.threadId,void 0,t)}stepOut(t){return this.session.stepOut(this.threadId,t)}stepBack(t){return this.session.stepBack(this.threadId,t)}continue(){return this.session.continue(this.threadId)}pause(){return this.session.pause(this.threadId)}terminate(){return this.session.terminateThreads([this.threadId])}reverseContinue(){return this.session.reverseContinue(this.threadId)}},tce=(r,t,e,i="memory")=>Z.from({scheme:py,authority:r,path:"/"+encodeURIComponent(t)+`/${encodeURIComponent(i)}.bin`,query:e?`?range=${e.fromOffset}:${e.toOffset}`:void 0}),UB=class extends R{constructor(e,i){super();this.memoryReference=e;this.session=i;this._register(i.onDidInvalidateMemory(n=>{n.body.memoryReference===e&&this.invalidate(n.body.offset,n.body.count-n.body.offset)}))}invalidateEmitter=this._register(new x);onDidInvalidate=this.invalidateEmitter.event;writable=!!this.session.capabilities.supportsWriteMemoryRequest;async read(e,i){let n=i-e,o=e,s=await this.session.readMemory(this.memoryReference,o,n);if(s===void 0||!s.body?.data)return[{type:1,offset:o,length:n}];let a;try{a=AD(s.body.data)}catch{return[{type:2,offset:o,length:n,error:"Invalid base64 data from debug adapter"}]}let l=s.body.unreadableBytes||0,d=n-l;if(a.byteLength<d){let c=Jt.alloc(d-a.byteLength);c.buffer.fill(0),a=Jt.concat([a,c],d)}else a.byteLength>d&&(a=a.slice(0,d));return l?[{type:0,offset:o,length:d,data:a},{type:1,offset:o+d,length:l}]:[{type:0,offset:o,length:n,data:a}]}async write(e,i){let o=(await this.session.writeMemory(this.memoryReference,e,OD(i),!0))?.body?.bytesWritten??i.byteLength;return this.invalidate(e,e+o),o}dispose(){super.dispose()}invalidate(e,i){this.invalidateEmitter.fire({fromOffset:e,toOffset:i})}},F6=class{constructor(t,e){this.enabled=t;this.id=e}getId(){return this.id}};function HL(r,t){return Bs({supportsConditionalBreakpoints:!!t.supportsConditionalBreakpoints,supportsHitConditionalBreakpoints:!!t.supportsHitConditionalBreakpoints,supportsLogPoints:!!t.supportsLogPoints,supportsFunctionBreakpoints:!!t.supportsFunctionBreakpoints,supportsDataBreakpoints:!!t.supportsDataBreakpoints,supportsInstructionBreakpoints:!!t.supportsInstructionBreakpoints},r)}var uy=class extends F6{sessionData=new Map;data;hitCondition;condition;logMessage;mode;modeLabel;constructor(t,e){super(e.enabled??!0,t),this.condition=e.condition,this.hitCondition=e.hitCondition,this.logMessage=e.logMessage,this.mode=e.mode,this.modeLabel=e.modeLabel}setSessionData(t,e){e?(e.sessionId=t,this.sessionData.set(t,e)):this.sessionData.delete(t);let i=Array.from(this.sessionData.values()),n=Mo(i.filter(o=>o.verified),o=>`${o.line}:${o.column}`);n.length?this.data=n.length===1?n[0]:void 0:this.data=i.length?i[0]:void 0}get message(){if(this.data)return this.data.message}get verified(){return this.data?this.data.verified:!0}get sessionsThatVerified(){let t=[];for(let[e,i]of this.sessionData)i.verified&&t.push(e);return t}getIdFromAdapter(t){let e=this.sessionData.get(t);return e?e.id:void 0}getDebugProtocolBreakpoint(t){let e=this.sessionData.get(t);if(e)return{id:e.id,verified:e.verified,message:e.message,source:e.source,line:e.line,column:e.column,endLine:e.endLine,endColumn:e.endColumn,instructionReference:e.instructionReference,offset:e.offset}}toJSON(){return{id:this.getId(),enabled:this.enabled,condition:this.condition,hitCondition:this.hitCondition,logMessage:this.logMessage,mode:this.mode,modeLabel:this.modeLabel}}},ir=class extends uy{constructor(e,i,n,o,s=Ni()){super(s,e);this.textFileService=i;this.uriIdentityService=n;this.logService=o;this._uri=e.uri,this._lineNumber=e.lineNumber,this._column=e.column,this._adapterData=e.adapterData,this.triggeredBy=e.triggeredBy}sessionsDidTrigger;_uri;_adapterData;_lineNumber;_column;triggeredBy;toDAP(){return{line:this.sessionAgnosticData.lineNumber,column:this.sessionAgnosticData.column,condition:this.condition,hitCondition:this.hitCondition,logMessage:this.logMessage,mode:this.mode}}get originalUri(){return this._uri}get lineNumber(){return this.verified&&this.data&&typeof this.data.line=="number"?this.data.line:this._lineNumber}get verified(){return this.data?this.data.verified&&!this.textFileService.isDirty(this._uri):!0}get pending(){return this.data?!1:this.triggeredBy!==void 0}get uri(){return this.verified&&this.data&&this.data.source?WL(this.data.source,this.data.source.path,this.data.sessionId,this.uriIdentityService,this.logService):this._uri}get column(){return this.verified&&this.data&&typeof this.data.column=="number"?this.data.column:this._column}get message(){return this.textFileService.isDirty(this.uri)?u("breakpointDirtydHover","Unverified breakpoint. File is modified, please restart debug session."):super.message}get adapterData(){return this.data&&this.data.source&&this.data.source.adapterData?this.data.source.adapterData:this._adapterData}get endLineNumber(){return this.verified&&this.data?this.data.endLine:void 0}get endColumn(){return this.verified&&this.data?this.data.endColumn:void 0}get sessionAgnosticData(){return{lineNumber:this._lineNumber,column:this._column}}get supported(){return this.data?!(this.logMessage&&!this.data.supportsLogPoints||this.condition&&!this.data.supportsConditionalBreakpoints||this.hitCondition&&!this.data.supportsHitConditionalBreakpoints):!0}setSessionData(e,i){super.setSessionData(e,i),this._adapterData||(this._adapterData=this.adapterData)}toJSON(){return{...super.toJSON(),uri:this._uri,lineNumber:this._lineNumber,column:this._column,adapterData:this.adapterData,triggeredBy:this.triggeredBy}}toString(){return`${Ns(this.uri)} ${this.lineNumber}`}setSessionDidTrigger(e){this.sessionsDidTrigger??=new Set,this.sessionsDidTrigger.add(e)}getSessionDidTrigger(e){return!!this.sessionsDidTrigger?.has(e)}update(e){e.hasOwnProperty("lineNumber")&&!Wn(e.lineNumber)&&(this._lineNumber=e.lineNumber),e.hasOwnProperty("column")&&(this._column=e.column),e.hasOwnProperty("condition")&&(this.condition=e.condition),e.hasOwnProperty("hitCondition")&&(this.hitCondition=e.hitCondition),e.hasOwnProperty("logMessage")&&(this.logMessage=e.logMessage),e.hasOwnProperty("mode")&&(this.mode=e.mode,this.modeLabel=e.modeLabel),e.hasOwnProperty("triggeredBy")&&(this.triggeredBy=e.triggeredBy,this.sessionsDidTrigger=void 0)}},ns=class extends uy{name;constructor(t,e=Ni()){super(e,t),this.name=t.name}toDAP(){return{name:this.name,condition:this.condition,hitCondition:this.hitCondition}}toJSON(){return{...super.toJSON(),name:this.name}}get supported(){return this.data?this.data.supportsFunctionBreakpoints:!0}toString(){return this.name}},xs=class extends uy{sessionDataIdForAddr=new WeakMap;description;src;canPersist;accessTypes;accessType;constructor(t,e=Ni()){super(e,t),this.description=t.description,"dataId"in t&&(t.src={type:0,dataId:t.dataId}),this.src=t.src,this.canPersist=t.canPersist,this.accessTypes=t.accessTypes,this.accessType=t.accessType,t.initialSessionData&&this.sessionDataIdForAddr.set(t.initialSessionData.session,t.initialSessionData.dataId)}async toDAP(t){let e;if(this.src.type===0)e=this.src.dataId;else{let i=this.sessionDataIdForAddr.get(t);if(!i){if(i=(await t.dataBytesBreakpointInfo(this.src.address,this.src.bytes))?.dataId,!i)return;this.sessionDataIdForAddr.set(t,i)}e=i}return{dataId:e,accessType:this.accessType,condition:this.condition,hitCondition:this.hitCondition}}toJSON(){return{...super.toJSON(),description:this.description,src:this.src,accessTypes:this.accessTypes,accessType:this.accessType,canPersist:this.canPersist}}get supported(){return this.data?this.data.supportsDataBreakpoints:!0}toString(){return this.description}},kc=class extends uy{supportedSessions=new Set;filter;label;supportsCondition;description;conditionDescription;fallback=!1;constructor(t,e=Ni()){super(e,t),this.filter=t.filter,this.label=t.label,this.supportsCondition=t.supportsCondition,this.description=t.description,this.conditionDescription=t.conditionDescription,this.fallback=t.fallback||!1}toJSON(){return{...super.toJSON(),filter:this.filter,label:this.label,enabled:this.enabled,supportsCondition:this.supportsCondition,conditionDescription:this.conditionDescription,condition:this.condition,fallback:this.fallback,description:this.description}}setSupportedSession(t,e){e?this.supportedSessions.add(t):this.supportedSessions.delete(t)}setFallback(t){this.fallback=t}get supported(){return!0}isSupportedSession(t){return t?this.supportedSessions.has(t):this.fallback}matches(t){return this.filter===t.filter&&this.label===t.label&&this.supportsCondition===!!t.supportsCondition&&this.conditionDescription===t.conditionDescription&&this.description===t.description}toString(){return this.label}},os=class extends uy{instructionReference;offset;canPersist;address;constructor(t,e=Ni()){super(e,t),this.instructionReference=t.instructionReference,this.offset=t.offset,this.canPersist=t.canPersist,this.address=t.address}toDAP(){return{instructionReference:this.instructionReference,condition:this.condition,hitCondition:this.hitCondition,mode:this.mode,offset:this.offset}}toJSON(){return{...super.toJSON(),instructionReference:this.instructionReference,offset:this.offset,canPersist:this.canPersist,address:this.address}}get supported(){return this.data?this.data.supportsInstructionBreakpoints:!0}toString(){return this.instructionReference}},vb=class{constructor(t,e){this.sessionId=t;this.threadId=e}getId(){return`${this.sessionId}:${this.threadId}`}},gE=class extends R{constructor(e,i,n,o){super();this.textFileService=i;this.uriIdentityService=n;this.logService=o;this._register(Ft(s=>{this.breakpoints=e.breakpoints.read(s),this.functionBreakpoints=e.functionBreakpoints.read(s),this.exceptionBreakpoints=e.exceptionBreakpoints.read(s),this.dataBreakpoints=e.dataBreakpoints.read(s),this._onDidChangeBreakpoints.fire(void 0)})),this._register(Ft(s=>{this.watchExpressions=e.watchExpressions.read(s),this._onDidChangeWatchExpressions.fire(void 0)})),this.instructionBreakpoints=[],this.sessions=[];for(let s of this.watchExpressions)this.watchExpressionChangeListeners.set(s.getId(),s.onDidChangeValue(a=>this._onDidChangeWatchExpressionValue.fire(a)))}sessions;schedulers=new Map;breakpointsActivated=!0;_onDidChangeBreakpoints=this._register(new x);_onDidChangeCallStack=this._register(new x);_onDidChangeWatchExpressions=this._register(new x);_onDidChangeWatchExpressionValue=this._register(new x);_breakpointModes=new Map;breakpoints;functionBreakpoints;exceptionBreakpoints;dataBreakpoints;watchExpressions;watchExpressionChangeListeners=this._register(new us);instructionBreakpoints;getId(){return"root"}getSession(e,i=!1){if(e)return this.getSessions(i).find(n=>n.getId()===e)}getSessions(e=!1){return this.sessions.filter(i=>e||i.state!==0)}addSession(e){this.sessions=this.sessions.filter(o=>!(o.getId()===e.getId()||o.state===0&&o.configuration.name===e.configuration.name));let i=1;for(;this.sessions.some(o=>o.getLabel()===e.getLabel());)e.setName(`${e.configuration.name} ${++i}`);let n=-1;e.parentSession&&(n=K5(this.sessions,o=>o.parentSession===e.parentSession||o===e.parentSession)),n>=0?this.sessions.splice(n+1,0,e):this.sessions.push(e),this._onDidChangeCallStack.fire(void 0)}get onDidChangeBreakpoints(){return this._onDidChangeBreakpoints.event}get onDidChangeCallStack(){return this._onDidChangeCallStack.event}get onDidChangeWatchExpressions(){return this._onDidChangeWatchExpressions.event}get onDidChangeWatchExpressionValue(){return this._onDidChangeWatchExpressionValue.event}rawUpdate(e){let i=this.sessions.find(n=>n.getId()===e.sessionId);i&&(i.rawUpdate(e),this._onDidChangeCallStack.fire(void 0))}clearThreads(e,i,n=void 0){let o=this.sessions.find(s=>s.getId()===e);this.schedulers.forEach(s=>{s.scheduler.dispose(),s.completeDeferred.complete()}),this.schedulers.clear(),o&&(o.clearThreads(i,n),this._onDidChangeCallStack.fire(void 0))}async fetchCallstack(e,i){if(e.reachedEndOfCallStack)return;let n=e.stoppedDetails?.totalFrames,o=typeof n=="number"?n-e.getCallStack().length:void 0;(!i||o&&i>o)&&(i=o),i&&i>0&&(await e.fetchCallStack(i),this._onDidChangeCallStack.fire())}refreshTopOfCallstack(e,i=!0){if(e.session.capabilities.supportsDelayedStackTraceLoading){let o=Promise.resolve(),s=new Promise((a,l)=>{o=e.fetchCallStack(1).then(()=>{if(!i){a(),this._onDidChangeCallStack.fire();return}if(!this.schedulers.has(e.getId())){let c=new Kr;this.schedulers.set(e.getId(),{completeDeferred:c,scheduler:new Ye(()=>{e.fetchCallStack(19).then(()=>{let p=e.getStaleCallStack(),h=e.getCallStack(),m=p.length!==h.length;for(let f=1;f<p.length&&!m;f++)m=!p[f].equals(h[f]);m&&this._onDidChangeCallStack.fire()}).finally(()=>{c.complete(),this.schedulers.delete(e.getId())})},420)})}let d=this.schedulers.get(e.getId());d.scheduler.schedule(),d.completeDeferred.p.then(a,l),this._onDidChangeCallStack.fire()})});return{topCallStack:o,wholeCallStack:s}}let n=e.fetchCallStack();return{wholeCallStack:n,topCallStack:n}}getBreakpoints(e){if(e){let i=e.uri?.toString(),n=e.originalUri?.toString();return this.breakpoints.filter(o=>!(i&&o.uri.toString()!==i||n&&o.originalUri.toString()!==n||e.lineNumber&&o.lineNumber!==e.lineNumber||e.column&&o.column!==e.column||e.enabledOnly&&(!this.breakpointsActivated||!o.enabled)||e.triggeredOnly&&o.triggeredBy===void 0))}return this.breakpoints}getFunctionBreakpoints(){return this.functionBreakpoints}getDataBreakpoints(){return this.dataBreakpoints}getExceptionBreakpoints(){return this.exceptionBreakpoints}getExceptionBreakpointsForSession(e){return this.exceptionBreakpoints.filter(i=>i.isSupportedSession(e))}getInstructionBreakpoints(){return this.instructionBreakpoints}setExceptionBreakpointsForSession(e,i){if(!i)return;let n=!1;i.forEach(o=>{let s=this.exceptionBreakpoints.filter(a=>a.matches(o)).pop();s||(n=!0,s=new kc({filter:o.filter,label:o.label,enabled:!!o.default,supportsCondition:!!o.supportsCondition,description:o.description,conditionDescription:o.conditionDescription}),this.exceptionBreakpoints.push(s)),s.setSupportedSession(e,!0)}),n&&this._onDidChangeBreakpoints.fire(void 0)}removeExceptionBreakpointsForSession(e){this.exceptionBreakpoints.forEach(i=>i.setSupportedSession(e,!1))}setExceptionBreakpointFallbackSession(e){this.exceptionBreakpoints.forEach(i=>i.setFallback(i.isSupportedSession(e)))}setExceptionBreakpointCondition(e,i){e.condition=i,this._onDidChangeBreakpoints.fire(void 0)}areBreakpointsActivated(){return this.breakpointsActivated}setBreakpointsActivated(e){this.breakpointsActivated=e,this._onDidChangeBreakpoints.fire(void 0)}addBreakpoints(e,i,n=!0){let o=i.map(s=>new ir({uri:e,lineNumber:s.lineNumber,column:s.column,enabled:s.enabled??!0,condition:s.condition,hitCondition:s.hitCondition,logMessage:s.logMessage,triggeredBy:s.triggeredBy,adapterData:void 0,mode:s.mode,modeLabel:s.modeLabel},this.textFileService,this.uriIdentityService,this.logService,s.id));return this.breakpoints=this.breakpoints.concat(o),this.breakpointsActivated=!0,this.sortAndDeDup(),n&&this._onDidChangeBreakpoints.fire({added:o,sessionOnly:!1}),o}removeBreakpoints(e){this.breakpoints=this.breakpoints.filter(i=>!e.some(n=>n.getId()===i.getId())),this._onDidChangeBreakpoints.fire({removed:e,sessionOnly:!1})}updateBreakpoints(e){let i=[];this.breakpoints.forEach(n=>{let o=e.get(n.getId());o&&(n.update(o),i.push(n))}),this.sortAndDeDup(),this._onDidChangeBreakpoints.fire({changed:i,sessionOnly:!1})}setBreakpointSessionData(e,i,n){this.breakpoints.forEach(o=>{if(!n)o.setSessionData(e,void 0);else{let s=n.get(o.getId());s&&o.setSessionData(e,HL(s,i))}}),this.functionBreakpoints.forEach(o=>{if(!n)o.setSessionData(e,void 0);else{let s=n.get(o.getId());s&&o.setSessionData(e,HL(s,i))}}),this.dataBreakpoints.forEach(o=>{if(!n)o.setSessionData(e,void 0);else{let s=n.get(o.getId());s&&o.setSessionData(e,HL(s,i))}}),this.exceptionBreakpoints.forEach(o=>{if(!n)o.setSessionData(e,void 0);else{let s=n.get(o.getId());s&&o.setSessionData(e,HL(s,i))}}),this.instructionBreakpoints.forEach(o=>{if(!n)o.setSessionData(e,void 0);else{let s=n.get(o.getId());s&&o.setSessionData(e,HL(s,i))}}),this._onDidChangeBreakpoints.fire({sessionOnly:!0})}getDebugProtocolBreakpoint(e,i){let n=this.breakpoints.find(o=>o.getId()===e);if(n)return n.getDebugProtocolBreakpoint(i)}getBreakpointModes(e){return[...this._breakpointModes.values()].filter(i=>i.appliesTo.includes(e))}registerBreakpointModes(e,i){for(let n of i){let o=`${n.mode}/${n.label}`,s=this._breakpointModes.get(o);if(s)for(let a of n.appliesTo)s.appliesTo.includes(a)||s.appliesTo.push(a);else{let a=[...this._breakpointModes.values()].find(l=>l!==s&&l.label===n.label);a&&(a.label=`${a.label} (${a.firstFromDebugType})`),this._breakpointModes.set(o,{mode:n.mode,label:a?`${n.label} (${e})`:n.label,firstFromDebugType:e,description:n.description,appliesTo:n.appliesTo.slice()})}}}sortAndDeDup(){this.breakpoints=this.breakpoints.sort((e,i)=>e.uri.toString()!==i.uri.toString()?Ns(e.uri).localeCompare(Ns(i.uri)):e.lineNumber===i.lineNumber?e.column&&i.column?e.column-i.column:1:e.lineNumber-i.lineNumber),this.breakpoints=Mo(this.breakpoints,e=>`${e.uri.toString()}:${e.lineNumber}:${e.column}`)}setEnablement(e,i){if(e instanceof ir||e instanceof ns||e instanceof kc||e instanceof xs||e instanceof os){let n=[];e.enabled!==i&&(e instanceof ir||e instanceof ns||e instanceof xs||e instanceof os)&&n.push(e),e.enabled=i,i&&(this.breakpointsActivated=!0),this._onDidChangeBreakpoints.fire({changed:n,sessionOnly:!1})}}enableOrDisableAllBreakpoints(e){let i=[];this.breakpoints.forEach(n=>{n.enabled!==e&&i.push(n),n.enabled=e}),this.functionBreakpoints.forEach(n=>{n.enabled!==e&&i.push(n),n.enabled=e}),this.dataBreakpoints.forEach(n=>{n.enabled!==e&&i.push(n),n.enabled=e}),this.instructionBreakpoints.forEach(n=>{n.enabled!==e&&i.push(n),n.enabled=e}),e&&(this.breakpointsActivated=!0),this._onDidChangeBreakpoints.fire({changed:i,sessionOnly:!1})}addFunctionBreakpoint(e,i){let n=new ns(e,i);return this.functionBreakpoints.push(n),this._onDidChangeBreakpoints.fire({added:[n],sessionOnly:!1}),n}updateFunctionBreakpoint(e,i){let n=this.functionBreakpoints.find(o=>o.getId()===e);n&&(typeof i.name=="string"&&(n.name=i.name),typeof i.condition=="string"&&(n.condition=i.condition),typeof i.hitCondition=="string"&&(n.hitCondition=i.hitCondition),this._onDidChangeBreakpoints.fire({changed:[n],sessionOnly:!1}))}removeFunctionBreakpoints(e){let i;e?(i=this.functionBreakpoints.filter(n=>n.getId()===e),this.functionBreakpoints=this.functionBreakpoints.filter(n=>n.getId()!==e)):(i=this.functionBreakpoints,this.functionBreakpoints=[]),this._onDidChangeBreakpoints.fire({removed:i,sessionOnly:!1})}addDataBreakpoint(e,i){let n=new xs(e,i);this.dataBreakpoints.push(n),this._onDidChangeBreakpoints.fire({added:[n],sessionOnly:!1})}updateDataBreakpoint(e,i){let n=this.dataBreakpoints.find(o=>o.getId()===e);n&&(typeof i.condition=="string"&&(n.condition=i.condition),typeof i.hitCondition=="string"&&(n.hitCondition=i.hitCondition),this._onDidChangeBreakpoints.fire({changed:[n],sessionOnly:!1}))}removeDataBreakpoints(e){let i;e?(i=this.dataBreakpoints.filter(n=>n.getId()===e),this.dataBreakpoints=this.dataBreakpoints.filter(n=>n.getId()!==e)):(i=this.dataBreakpoints,this.dataBreakpoints=[]),this._onDidChangeBreakpoints.fire({removed:i,sessionOnly:!1})}addInstructionBreakpoint(e){let i=new os(e);this.instructionBreakpoints.push(i),this._onDidChangeBreakpoints.fire({added:[i],sessionOnly:!0})}removeInstructionBreakpoints(e,i){let n=[];if(e)for(let o=0;o<this.instructionBreakpoints.length;o++){let s=this.instructionBreakpoints[o];s.instructionReference===e&&(i===void 0||s.offset===i)&&(n.push(s),this.instructionBreakpoints.splice(o--,1))}else n=this.instructionBreakpoints,this.instructionBreakpoints=[];this._onDidChangeBreakpoints.fire({removed:n,sessionOnly:!1})}getWatchExpressions(){return this.watchExpressions}addWatchExpression(e){let i=new Hi(e||"");return this.watchExpressionChangeListeners.set(i.getId(),i.onDidChangeValue(n=>this._onDidChangeWatchExpressionValue.fire(n))),this.watchExpressions.push(i),this._onDidChangeWatchExpressions.fire(i),i}renameWatchExpression(e,i){let n=this.watchExpressions.filter(o=>o.getId()===e);n.length===1&&(n[0].name=i,this._onDidChangeWatchExpressions.fire(n[0]))}removeWatchExpressions(e=null){if(this.watchExpressions=e?this.watchExpressions.filter(i=>i.getId()!==e):[],this._onDidChangeWatchExpressions.fire(void 0),!e){this.watchExpressionChangeListeners.clearAndDisposeAll();return}this.watchExpressionChangeListeners.deleteAndDispose(e)}moveWatchExpression(e,i){let n=this.watchExpressions.find(o=>o.getId()===e);n&&(this.watchExpressions=this.watchExpressions.filter(o=>o.getId()!==e),this.watchExpressions=this.watchExpressions.slice(0,i).concat(n,this.watchExpressions.slice(i)),this._onDidChangeWatchExpressions.fire(void 0))}sourceIsNotAvailable(e){this.sessions.forEach(i=>{let n=i.getSourceForUri(e);n&&(n.available=!1)}),this._onDidChangeCallStack.fire(void 0)}};gE=E([b(1,Us),b(2,zn),b(3,bt)],gE);var zB=class{_state;constructor(){this._state=0}get state(){return this._state}set state(t){t>this._state&&(this._state=t)}isOK(){return this._state===0}isFatal(){return this._state===4}},zL=class{_problemReporter;constructor(t){this._problemReporter=t}reset(){this._problemReporter.status.state=0}get problemReporter(){return this._problemReporter}info(t){this._problemReporter.info(t)}warn(t){this._problemReporter.warn(t)}error(t){this._problemReporter.error(t)}fatal(t){this._problemReporter.fatal(t)}};var fE=(o=>(o[o.Default=0]="Default",o[o.Relative=1]="Relative",o[o.Absolute=2]="Absolute",o[o.AutoDetect=3]="AutoDetect",o[o.Search=4]="Search",o))(fE||{});(t=>{function r(e){return e=e.toLowerCase(),e==="absolute"?2:e==="relative"?1:e==="autodetect"?3:e==="search"?4:void 0}t.fromString=r})(fE||={});var $B=(e=>(e[e.File=0]="File",e[e.Location=1]="Location",e))($B||{});(t=>{function r(e){return e=e.toLowerCase(),e==="file"?0:e==="location"?1:void 0}t.fromString=r})($B||={});var jB=(i=>(i[i.allDocuments=0]="allDocuments",i[i.openDocuments=1]="openDocuments",i[i.closedDocuments=2]="closedDocuments",i))(jB||{});(t=>{function r(e){return e=e.toLowerCase(),e==="alldocuments"?0:e==="opendocuments"?1:e==="closeddocuments"?2:void 0}t.fromString=r})(jB||={});function Fwe(r){return!!(r&&Bt(r.name))}var SIi=Ys===1?`\r
`:`
`;var Ib;(a=>{let r;(d=>{function l(c){let p=c;return p&&Bt(p.regexp)}d.is=l})(r=a.CheckedProblemPattern||={});let t;(d=>{function l(c){let p=c;return p&&Bt(p.name)}d.is=l})(t=a.NamedProblemPattern||={});let e;(d=>{function l(c){let p=c;return p&&t.is(p)&&Bt(p.regexp)}d.is=l})(e=a.NamedCheckedProblemPattern||={});let i;(d=>{function l(c){return c&&Array.isArray(c)}d.is=l})(i=a.MultiLineProblemPattern||={});let n;(d=>{function l(c){if(!i.is(c))return!1;for(let p of c)if(!a.CheckedProblemPattern.is(p))return!1;return!0}d.is=l})(n=a.MultiLineCheckedProblemPattern||={});let o;(d=>{function l(c){let p=c;return p&&Bt(p.name)&&Array.isArray(p.patterns)&&n.is(p.patterns)}d.is=l})(o=a.NamedMultiLineCheckedProblemPattern||={});function s(l){return Bt(l.name)}a.isNamedProblemMatcher=s})(Ib||={});var KB=class extends zL{constructor(t){super(t)}parse(t){if(Ib.NamedMultiLineCheckedProblemPattern.is(t))return this.createNamedMultiLineProblemPattern(t);if(Ib.MultiLineCheckedProblemPattern.is(t))return this.createMultiLineProblemPattern(t);if(Ib.NamedCheckedProblemPattern.is(t)){let e=this.createSingleProblemPattern(t);return e.name=t.name,e}else return Ib.CheckedProblemPattern.is(t)?this.createSingleProblemPattern(t):(this.error(u("ProblemPatternParser.problemPattern.missingRegExp","The problem pattern is missing a regular expression.")),null)}createSingleProblemPattern(t){let e=this.doCreateSingleProblemPattern(t,!0);return e===void 0?null:(e.kind===void 0&&(e.kind=1),this.validateProblemPattern([e])?e:null)}createNamedMultiLineProblemPattern(t){let e=this.createMultiLineProblemPattern(t.patterns);return e?{name:t.name,label:t.label?t.label:t.name,patterns:e}:null}createMultiLineProblemPattern(t){let e=[];for(let i=0;i<t.length;i++){let n=this.doCreateSingleProblemPattern(t[i],!1);if(n===void 0)return null;i<t.length-1&&!Vn(n.loop)&&n.loop&&(n.loop=!1,this.error(u("ProblemPatternParser.loopProperty.notLast","The loop property is only supported on the last line matcher."))),e.push(n)}return e[0].kind===void 0&&(e[0].kind=1),this.validateProblemPattern(e)?e:null}doCreateSingleProblemPattern(t,e){let i=this.createRegularExpression(t.regexp);if(i===void 0)return;let n={regexp:i};t.kind&&(n.kind=$B.fromString(t.kind));function o(s,a,l,d){let c=a[d];typeof c=="number"&&(s[l]=c)}return o(n,t,"file","file"),o(n,t,"location","location"),o(n,t,"line","line"),o(n,t,"character","column"),o(n,t,"endLine","endLine"),o(n,t,"endCharacter","endColumn"),o(n,t,"severity","severity"),o(n,t,"code","code"),o(n,t,"message","message"),(t.loop===!0||t.loop===!1)&&(n.loop=t.loop),e&&(n.location||n.kind===0?n=Bs(n,{file:1,message:0},!1):n=Bs(n,{file:1,line:2,character:3,message:0},!1)),n}validateProblemPattern(t){let e=!1,i=!1,n=!1,o=!1,s=t[0].kind===void 0?1:t[0].kind;return t.forEach((a,l)=>{l!==0&&a.kind&&this.error(u("ProblemPatternParser.problemPattern.kindProperty.notFirst","The problem pattern is invalid. The kind property must be provided only in the first element")),e=e||!Vn(a.file),i=i||!Vn(a.message),n=n||!Vn(a.location),o=o||!Vn(a.line)}),e&&i?s===1&&!(n||o)?(this.error(u("ProblemPatternParser.problemPattern.missingLocation",'The problem pattern is invalid. It must either have kind: "file" or have a line or location match group.')),!1):!0:(this.error(u("ProblemPatternParser.problemPattern.missingProperty","The problem pattern is invalid. It must have at least have a file and a message.")),!1)}createRegularExpression(t){let e;try{e=new RegExp(t)}catch{this.error(u("ProblemPatternParser.invalidRegexp",`Error: The string {0} is not a valid regular expression.
`,t))}return e}},GB=class{constructor(t,e=new zB){this._collector=t;this._validationStatus=e}info(t){this._validationStatus.state=1,this._collector.info(t)}warn(t){this._validationStatus.state=2,this._collector.warn(t)}error(t){this._validationStatus.state=3,this._collector.error(t)}fatal(t){this._validationStatus.state=4,this._collector.error(t)}get status(){return this._validationStatus}},qB;(d=>(d.ProblemPattern={default:{regexp:"^([^\\\\s].*)\\\\((\\\\d+,\\\\d+)\\\\):\\\\s*(.*)$",file:1,location:2,message:3},type:"object",additionalProperties:!1,properties:{regexp:{type:"string",description:u("ProblemPatternSchema.regexp","The regular expression to find an error, warning or info in the output.")},kind:{type:"string",description:u("ProblemPatternSchema.kind","whether the pattern matches a location (file and line) or only a file.")},file:{type:"integer",description:u("ProblemPatternSchema.file","The match group index of the filename. If omitted 1 is used.")},location:{type:"integer",description:u("ProblemPatternSchema.location","The match group index of the problem's location. Valid location patterns are: (line), (line,column) and (startLine,startColumn,endLine,endColumn). If omitted (line,column) is assumed.")},line:{type:"integer",description:u("ProblemPatternSchema.line","The match group index of the problem's line. Defaults to 2")},column:{type:"integer",description:u("ProblemPatternSchema.column","The match group index of the problem's line character. Defaults to 3")},endLine:{type:"integer",description:u("ProblemPatternSchema.endLine","The match group index of the problem's end line. Defaults to undefined")},endColumn:{type:"integer",description:u("ProblemPatternSchema.endColumn","The match group index of the problem's end line character. Defaults to undefined")},severity:{type:"integer",description:u("ProblemPatternSchema.severity","The match group index of the problem's severity. Defaults to undefined")},code:{type:"integer",description:u("ProblemPatternSchema.code","The match group index of the problem's code. Defaults to undefined")},message:{type:"integer",description:u("ProblemPatternSchema.message","The match group index of the message. If omitted it defaults to 4 if location is specified. Otherwise it defaults to 5.")},loop:{type:"boolean",description:u("ProblemPatternSchema.loop","In a multi line matcher loop indicated whether this pattern is executed in a loop as long as it matches. Can only specified on a last pattern in a multi line pattern.")}}},d.NamedProblemPattern=Xi(d.ProblemPattern),d.NamedProblemPattern.properties=Xi(d.NamedProblemPattern.properties)||{},d.NamedProblemPattern.properties.name={type:"string",description:u("NamedProblemPatternSchema.name","The name of the problem pattern.")},d.MultiLineProblemPattern={type:"array",items:d.ProblemPattern},d.NamedMultiLineProblemPattern={type:"object",additionalProperties:!1,properties:{name:{type:"string",description:u("NamedMultiLineProblemPatternSchema.name","The name of the problem multi line problem pattern.")},patterns:{type:"array",description:u("NamedMultiLineProblemPatternSchema.patterns","The actual patterns."),items:d.ProblemPattern}}},d.WatchingPattern={type:"object",additionalProperties:!1,properties:{regexp:{type:"string",description:u("WatchingPatternSchema.regexp","The regular expression to detect the begin or end of a background task.")},file:{type:"integer",description:u("WatchingPatternSchema.file","The match group index of the filename. Can be omitted.")}}},d.PatternType={anyOf:[{type:"string",description:u("PatternTypeSchema.name","The name of a contributed or predefined pattern")},d.ProblemPattern,d.MultiLineProblemPattern],description:u("PatternTypeSchema.description","A problem pattern or the name of a contributed or predefined problem pattern. Can be omitted if base is specified.")},d.ProblemMatcher={type:"object",additionalProperties:!1,properties:{base:{type:"string",description:u("ProblemMatcherSchema.base","The name of a base problem matcher to use.")},owner:{type:"string",description:u("ProblemMatcherSchema.owner","The owner of the problem inside Code. Can be omitted if base is specified. Defaults to 'external' if omitted and base is not specified.")},source:{type:"string",description:u("ProblemMatcherSchema.source","A human-readable string describing the source of this diagnostic, e.g. 'typescript' or 'super lint'.")},severity:{type:"string",enum:["error","warning","info"],description:u("ProblemMatcherSchema.severity","The default severity for captures problems. Is used if the pattern doesn't define a match group for severity.")},applyTo:{type:"string",enum:["allDocuments","openDocuments","closedDocuments"],description:u("ProblemMatcherSchema.applyTo","Controls if a problem reported on a text document is applied only to open, closed or all documents.")},pattern:d.PatternType,fileLocation:{oneOf:[{type:"string",enum:["absolute","relative","autoDetect","search"]},{type:"array",prefixItems:[{type:"string",enum:["absolute","relative","autoDetect","search"]}],minItems:1,maxItems:1,additionalItems:!1},{type:"array",prefixItems:[{type:"string",enum:["relative","autoDetect"]},{type:"string"}],minItems:2,maxItems:2,additionalItems:!1,examples:[["relative","${workspaceFolder}"],["autoDetect","${workspaceFolder}"]]},{type:"array",prefixItems:[{type:"string",enum:["search"]},{type:"object",properties:{include:{oneOf:[{type:"string"},{type:"array",items:{type:"string"}}]},exclude:{oneOf:[{type:"string"},{type:"array",items:{type:"string"}}]}},required:["include"]}],minItems:2,maxItems:2,additionalItems:!1,examples:[["search",{include:["${workspaceFolder}"]}],["search",{include:["${workspaceFolder}"],exclude:[]}]]}],description:u("ProblemMatcherSchema.fileLocation","Defines how file names reported in a problem pattern should be interpreted. A relative fileLocation may be an array, where the second element of the array is the path of the relative file location. The search fileLocation mode, performs a deep (and, possibly, heavy) file system search within the directories specified by the include/exclude properties of the second element (or the current workspace directory if not specified).")},background:{type:"object",additionalProperties:!1,description:u("ProblemMatcherSchema.background","Patterns to track the begin and end of a matcher active on a background task."),properties:{activeOnStart:{type:"boolean",description:u("ProblemMatcherSchema.background.activeOnStart","If set to true the background monitor is in active mode when the task starts. This is equals of issuing a line that matches the beginsPattern")},beginsPattern:{oneOf:[{type:"string"},d.WatchingPattern],description:u("ProblemMatcherSchema.background.beginsPattern","If matched in the output the start of a background task is signaled.")},endsPattern:{oneOf:[{type:"string"},d.WatchingPattern],description:u("ProblemMatcherSchema.background.endsPattern","If matched in the output the end of a background task is signaled.")}}},watching:{type:"object",additionalProperties:!1,deprecationMessage:u("ProblemMatcherSchema.watching.deprecated","The watching property is deprecated. Use background instead."),description:u("ProblemMatcherSchema.watching","Patterns to track the begin and end of a watching matcher."),properties:{activeOnStart:{type:"boolean",description:u("ProblemMatcherSchema.watching.activeOnStart","If set to true the watcher is in active mode when the task starts. This is equals of issuing a line that matches the beginPattern")},beginsPattern:{oneOf:[{type:"string"},d.WatchingPattern],description:u("ProblemMatcherSchema.watching.beginsPattern","If matched in the output the start of a watching task is signaled.")},endsPattern:{oneOf:[{type:"string"},d.WatchingPattern],description:u("ProblemMatcherSchema.watching.endsPattern","If matched in the output the end of a watching task is signaled.")}}}}},d.LegacyProblemMatcher=Xi(d.ProblemMatcher),d.LegacyProblemMatcher.properties=Xi(d.LegacyProblemMatcher.properties)||{},d.LegacyProblemMatcher.properties.watchedTaskBeginsRegExp={type:"string",deprecationMessage:u("LegacyProblemMatcherSchema.watchedBegin.deprecated","This property is deprecated. Use the watching property instead."),description:u("LegacyProblemMatcherSchema.watchedBegin","A regular expression signaling that a watched tasks begins executing triggered through file watching.")},d.LegacyProblemMatcher.properties.watchedTaskEndsRegExp={type:"string",deprecationMessage:u("LegacyProblemMatcherSchema.watchedEnd.deprecated","This property is deprecated. Use the watching property instead."),description:u("LegacyProblemMatcherSchema.watchedEnd","A regular expression signaling that a watched tasks ends executing.")},d.NamedProblemMatcher=Xi(d.ProblemMatcher),d.NamedProblemMatcher.properties=Xi(d.NamedProblemMatcher.properties)||{},d.NamedProblemMatcher.properties.name={type:"string",description:u("NamedProblemMatcherSchema.name","The name of the problem matcher used to refer to it.")},d.NamedProblemMatcher.properties.label={type:"string",description:u("NamedProblemMatcherSchema.label","A human readable label of the problem matcher.")}))(qB||={});var nce=Ra.registerExtensionPoint({extensionPoint:"problemPatterns",jsonSchema:{description:u("ProblemPatternExtPoint","Contributes problem patterns"),type:"array",items:{anyOf:[qB.NamedProblemPattern,qB.NamedMultiLineProblemPattern]}}}),B6=class{patterns;readyPromise;constructor(){this.patterns=Object.create(null),this.fillDefaults(),this.readyPromise=new Promise((t,e)=>{nce.setHandler((i,n)=>{try{n.removed.forEach(o=>{let s=o.value;for(let a of s)this.patterns[a.name]&&delete this.patterns[a.name]}),n.added.forEach(o=>{let s=o.value,a=new KB(new GB(o.collector));for(let l of s){if(Ib.NamedMultiLineCheckedProblemPattern.is(l)){let d=a.parse(l);a.problemReporter.status.state<3?this.add(d.name,d.patterns):(o.collector.error(u("ProblemPatternRegistry.error","Invalid problem pattern. The pattern will be ignored.")),o.collector.error(JSON.stringify(l,void 0,4)))}else if(Ib.NamedProblemPattern.is(l)){let d=a.parse(l);a.problemReporter.status.state<3?this.add(l.name,d):(o.collector.error(u("ProblemPatternRegistry.error","Invalid problem pattern. The pattern will be ignored.")),o.collector.error(JSON.stringify(l,void 0,4)))}a.reset()}})}catch{}t(void 0)})})}onReady(){return this.readyPromise}add(t,e){this.patterns[t]=e}get(t){return this.patterns[t]}fillDefaults(){this.add("msCompile",{regexp:/^(?:\s*\d+>)?(\S.*)\((\d+|\d+,\d+|\d+,\d+,\d+,\d+)\)\s*:\s+((?:fatal +)?error|warning|info)\s+(\w+\d+)\s*:\s*(.*)$/,kind:1,file:1,location:2,severity:3,code:4,message:5}),this.add("gulp-tsc",{regexp:/^([^\s].*)\((\d+|\d+,\d+|\d+,\d+,\d+,\d+)\):\s+(\d+)\s+(.*)$/,kind:1,file:1,location:2,code:3,message:4}),this.add("cpp",{regexp:/^(\S.*)\((\d+|\d+,\d+|\d+,\d+,\d+,\d+)\):\s+(error|warning|info)\s+(C\d+)\s*:\s*(.*)$/,kind:1,file:1,location:2,severity:3,code:4,message:5}),this.add("csc",{regexp:/^(\S.*)\((\d+|\d+,\d+|\d+,\d+,\d+,\d+)\):\s+(error|warning|info)\s+(CS\d+)\s*:\s*(.*)$/,kind:1,file:1,location:2,severity:3,code:4,message:5}),this.add("vb",{regexp:/^(\S.*)\((\d+|\d+,\d+|\d+,\d+,\d+,\d+)\):\s+(error|warning|info)\s+(BC\d+)\s*:\s*(.*)$/,kind:1,file:1,location:2,severity:3,code:4,message:5}),this.add("lessCompile",{regexp:/^\s*(.*) in file (.*) line no. (\d+)$/,kind:1,message:1,file:2,line:3}),this.add("jshint",{regexp:/^(.*):\s+line\s+(\d+),\s+col\s+(\d+),\s(.+?)(?:\s+\((\w)(\d+)\))?$/,kind:1,file:1,line:2,character:3,message:4,severity:5,code:6}),this.add("jshint-stylish",[{regexp:/^(.+)$/,kind:1,file:1},{regexp:/^\s+line\s+(\d+)\s+col\s+(\d+)\s+(.+?)(?:\s+\((\w)(\d+)\))?$/,line:1,character:2,message:3,severity:4,code:5,loop:!0}]),this.add("eslint-compact",{regexp:/^(.+):\sline\s(\d+),\scol\s(\d+),\s(Error|Warning|Info)\s-\s(.+)\s\((.+)\)$/,file:1,kind:1,line:2,character:3,severity:4,message:5,code:6}),this.add("eslint-stylish",[{regexp:/^((?:[a-zA-Z]:)*[./\\]+.*?)$/,kind:1,file:1},{regexp:/^\s+(\d+):(\d+)\s+(error|warning|info)\s+(.+?)(?:\s\s+(.*))?$/,line:1,character:2,severity:3,message:4,code:5,loop:!0}]),this.add("go",{regexp:/^([^:]*: )?((.:)?[^:]*):(\d+)(:(\d+))?: (.*)$/,kind:1,file:2,line:4,character:6,message:7})}},Ch=new B6,V6=class extends zL{constructor(t){super(t)}parse(t){let e=this.createProblemMatcher(t);if(this.checkProblemMatcherValid(t,e))return this.addWatchingMatcher(t,e),e}checkProblemMatcherValid(t,e){return e?e.pattern?e.owner?Vn(e.fileLocation)?(this.error(u("ProblemMatcherParser.noFileLocation",`Error: the description doesn't define a file location:
{0}
`,JSON.stringify(t,null,4))),!1):!0:(this.error(u("ProblemMatcherParser.noOwner",`Error: the description doesn't define an owner:
{0}
`,JSON.stringify(t,null,4))),!1):(this.error(u("ProblemMatcherParser.noProblemPattern",`Error: the description doesn't define a valid problem pattern:
{0}
`,JSON.stringify(t,null,4))),!1):(this.error(u("ProblemMatcherParser.noProblemMatcher",`Error: the description can't be converted into a problem matcher:
{0}
`,JSON.stringify(t,null,4))),!1)}createProblemMatcher(t){let e=null,i=Bt(t.owner)?t.owner:Ni(),n=Bt(t.source)?t.source:void 0,o=Bt(t.applyTo)?jB.fromString(t.applyTo):0;o||(o=0);let s,a,l;if(Vn(t.fileLocation))s=1,a="${workspaceFolder}";else if(Bt(t.fileLocation))l=fE.fromString(t.fileLocation),l&&(s=l,l===1||l===3?a="${workspaceFolder}":l===4&&(a={include:["${workspaceFolder}"]}));else if(G_(t.fileLocation)){let p=t.fileLocation;p.length>0&&(l=fE.fromString(p[0]),p.length===1&&l===2?s=l:p.length===2&&(l===1||l===3)&&p[1]&&(s=l,a=p[1]))}else Array.isArray(t.fileLocation)&&fE.fromString(t.fileLocation[0])===4&&(s=4,a=t.fileLocation[1]??{include:["${workspaceFolder}"]});let d=t.pattern?this.createProblemPattern(t.pattern):void 0,c=t.severity?Si.fromValue(t.severity):void 0;if(c===Si.Ignore&&(this.info(u("ProblemMatcherParser.unknownSeverity",`Info: unknown severity {0}. Valid values are error, warning and info.
`,t.severity)),c=Si.Error),Bt(t.base)){let p=t.base;if(p.length>1&&p[0]==="$"){let h=Vwe.get(p.substring(1));h&&(e=Xi(h),t.owner!==void 0&&i!==void 0&&(e.owner=i),t.source!==void 0&&n!==void 0&&(e.source=n),t.fileLocation!==void 0&&s!==void 0&&(e.fileLocation=s,e.filePrefix=a),t.pattern!==void 0&&d!==void 0&&d!==null&&(e.pattern=d),t.severity!==void 0&&c!==void 0&&(e.severity=c),t.applyTo!==void 0&&o!==void 0&&(e.applyTo=o))}}else s&&d&&(e={owner:i,applyTo:o,fileLocation:s,pattern:d},n&&(e.source=n),a&&(e.filePrefix=a),c&&(e.severity=c));return Ib.isNamedProblemMatcher(t)&&(e.name=t.name,e.label=Bt(t.label)?t.label:t.name),e}createProblemPattern(t){if(Bt(t)){let e=t;if(e.length>1&&e[0]==="$"){let i=Ch.get(e.substring(1));return i||this.error(u("ProblemMatcherParser.noDefinedPatter","Error: the pattern with the identifier {0} doesn't exist.",e)),i}else e.length===0?this.error(u("ProblemMatcherParser.noIdentifier","Error: the pattern property refers to an empty identifier.")):this.error(u("ProblemMatcherParser.noValidIdentifier","Error: the pattern property {0} is not a valid pattern variable name.",e))}else if(t){let e=new KB(this.problemReporter);return Array.isArray(t),e.parse(t)}return null}addWatchingMatcher(t,e){let i=this.createRegularExpression(t.watchedTaskBeginsRegExp),n=this.createRegularExpression(t.watchedTaskEndsRegExp);if(i&&n){e.watching={activeOnStart:!1,beginsPattern:{regexp:i},endsPattern:{regexp:n}};return}let o=t.background||t.watching;if(Wn(o))return;let s=this.createWatchingPattern(o.beginsPattern),a=this.createWatchingPattern(o.endsPattern);if(s&&a){e.watching={activeOnStart:HS(o.activeOnStart)?o.activeOnStart:!1,beginsPattern:s,endsPattern:a};return}(s||a)&&this.error(u("ProblemMatcherParser.problemPattern.watchingMatcher","A problem matcher must define both a begin pattern and an end pattern for watching."))}createWatchingPattern(t){if(Wn(t))return null;let e,i;return Bt(t)?e=this.createRegularExpression(t):(e=this.createRegularExpression(t.regexp),cr(t.file)&&(i=t.file)),e?i?{regexp:e,file:i}:{regexp:e,file:1}:null}createRegularExpression(t){let e=null;if(!t)return e;try{e=new RegExp(t)}catch{this.error(u("ProblemMatcherParser.invalidRegexp",`Error: The string {0} is not a valid regular expression.
`,t))}return e}},Bwe=Ra.registerExtensionPoint({extensionPoint:"problemMatchers",deps:[nce],jsonSchema:{description:u("ProblemMatcherExtPoint","Contributes problem matchers"),type:"array",items:qB.NamedProblemMatcher}}),W6=class{matchers;readyPromise;_onMatchersChanged=new x;onMatcherChanged=this._onMatchersChanged.event;constructor(){this.matchers=Object.create(null),this.fillDefaults(),this.readyPromise=new Promise((t,e)=>{Bwe.setHandler((i,n)=>{try{n.removed.forEach(s=>{let a=s.value;for(let l of a)this.matchers[l.name]&&delete this.matchers[l.name]}),n.added.forEach(s=>{let a=s.value,l=new V6(new GB(s.collector));for(let d of a){let c=l.parse(d);c&&Fwe(c)&&this.add(c)}}),(n.removed.length>0||n.added.length>0)&&this._onMatchersChanged.fire()}catch{}let o=this.get("tsc-watch");o&&(o.tscWatch=!0),t(void 0)})})}onReady(){return Ch.onReady(),this.readyPromise}add(t){this.matchers[t.name]=t}get(t){return this.matchers[t]}keys(){return Object.keys(this.matchers)}fillDefaults(){this.add({name:"msCompile",label:u("msCompile","Microsoft compiler problems"),owner:"msCompile",source:"cpp",applyTo:0,fileLocation:2,pattern:Ch.get("msCompile")}),this.add({name:"lessCompile",label:u("lessCompile","Less problems"),deprecated:!0,owner:"lessCompile",source:"less",applyTo:0,fileLocation:2,pattern:Ch.get("lessCompile"),severity:Si.Error}),this.add({name:"gulp-tsc",label:u("gulp-tsc","Gulp TSC Problems"),owner:"typescript",source:"ts",applyTo:2,fileLocation:1,filePrefix:"${workspaceFolder}",pattern:Ch.get("gulp-tsc")}),this.add({name:"jshint",label:u("jshint","JSHint problems"),owner:"jshint",source:"jshint",applyTo:0,fileLocation:2,pattern:Ch.get("jshint")}),this.add({name:"jshint-stylish",label:u("jshint-stylish","JSHint stylish problems"),owner:"jshint",source:"jshint",applyTo:0,fileLocation:2,pattern:Ch.get("jshint-stylish")}),this.add({name:"eslint-compact",label:u("eslint-compact","ESLint compact problems"),owner:"eslint",source:"eslint",applyTo:0,fileLocation:2,filePrefix:"${workspaceFolder}",pattern:Ch.get("eslint-compact")}),this.add({name:"eslint-stylish",label:u("eslint-stylish","ESLint stylish problems"),owner:"eslint",source:"eslint",applyTo:0,fileLocation:2,pattern:Ch.get("eslint-stylish")}),this.add({name:"go",label:u("go","Go problems"),owner:"go",source:"go",applyTo:0,fileLocation:1,filePrefix:"${workspaceFolder}",pattern:Ch.get("go")})}},Vwe=new W6;var Wwe={type:"object",additionalProperties:!1,properties:{type:{type:"string",description:u("TaskDefinition.description","The actual task type. Please note that types starting with a '$' are reserved for internal usage.")},required:{type:"array",items:{type:"string"}},properties:{type:"object",description:u("TaskDefinition.properties","Additional properties of the task type"),additionalProperties:{$ref:"http://json-schema.org/draft-07/schema#"}},when:{type:"string",markdownDescription:u("TaskDefinition.when","Condition which must be true to enable this type of task. Consider using `shellExecutionSupported`, `processExecutionSupported`, and `customExecutionSupported` as appropriate for this task definition. See the [API documentation](https://code.visualstudio.com/api/extension-guides/task-provider#when-clause) for more information."),default:""}}},oce;(t=>{function r(e,i,n){if(!e)return;let o=Bt(e.type)?e.type:void 0;if(!o||o.length===0){n.error(u("TaskTypeConfiguration.noType","The task type configuration is missing the required 'taskType' property"));return}let s=[];if(Array.isArray(e.required))for(let a of e.required)Bt(a)&&s.push(a);return{extensionId:i.value,taskType:o,required:s,properties:e.properties?Xi(e.properties):{},when:e.when?P.deserialize(e.when):void 0}}t.from=r})(oce||={});var Hwe=Ra.registerExtensionPoint({extensionPoint:"taskDefinitions",activationEventsGenerator:(r,t)=>{for(let e of r)e.type&&t.push(`onTaskType:${e.type}`)},jsonSchema:{description:u("TaskDefinitionExtPoint","Contributes task kinds"),type:"array",items:Wwe}}),H6=class{taskTypes;readyPromise;_schema;_onDefinitionsChanged=new x;onDefinitionsChanged=this._onDefinitionsChanged.event;constructor(){this.taskTypes=Object.create(null),this.readyPromise=new Promise((t,e)=>{Hwe.setHandler((i,n)=>{this._schema=void 0;try{for(let o of n.removed){let s=o.value;for(let a of s)this.taskTypes&&a.type&&this.taskTypes[a.type]&&delete this.taskTypes[a.type]}for(let o of n.added){let s=o.value;for(let a of s){let l=oce.from(a,o.description.identifier,o.collector);l&&(this.taskTypes[l.taskType]=l)}}(n.removed.length>0||n.added.length>0)&&this._onDefinitionsChanged.fire()}catch{}t(void 0)})})}onReady(){return this.readyPromise}get(t){return this.taskTypes[t]}all(){return Object.keys(this.taskTypes).map(t=>this.taskTypes[t])}getJsonSchema(){if(this._schema===void 0){let t=[];for(let e of this.all()){let i={type:"object",additionalProperties:!1};e.required.length>0&&(i.required=e.required.slice(0)),e.properties!==void 0?i.properties=Xi(e.properties):i.properties=Object.create(null),i.properties.type={type:"string",enum:[e.taskType]},t.push(i)}this._schema={oneOf:t}}return this._schema}},XB=new H6;var Jyi=new A("terminalTabFocusMode",!1,!0);var eSi=q("ptyService");var Uwe={Backend:"workbench.contributions.terminal.processBackend"},U6=class{_backends=new Map;get backends(){return this._backends}registerTerminalBackend(t){let e=this._sanitizeRemoteAuthority(t.remoteAuthority);if(this._backends.has(e))throw new Error(`A terminal backend with remote authority '${e}' was already registered.`);this._backends.set(e,t)}getTerminalBackend(t){return this._backends.get(this._sanitizeRemoteAuthority(t))}_sanitizeRemoteAuthority(t){return t?.toLowerCase()??""}};Pe.add(Uwe.Backend,new U6);var tSi=q("localPtyService"),iSi=q("terminalLogService");var rce="settings",CSi=new A("taskRunning",!1,u("tasks.taskRunningContext","Whether a task is currently running.")),wSi=ie("tasksCategory","Tasks"),K6=(i=>(i[i.Escape=1]="Escape",i[i.Strong=2]="Strong",i[i.Weak=3]="Weak",i))(K6||{}),sce="$customized";(t=>{function r(e){if(!e)return 2;switch(e.toLowerCase()){case"escape":return 1;case"strong":return 2;case"weak":return 3;default:return 2}}t.from=r})(K6||={});var zwe;(t=>t.defaults={cwd:"${workspaceFolder}"})(zwe||={});var G6=(i=>(i[i.Always=1]="Always",i[i.Silent=2]="Silent",i[i.Never=3]="Never",i))(G6||{});(t=>{function r(e){switch(e.toLowerCase()){case"always":return 1;case"silent":return 2;case"never":return 3;default:return 1}}t.fromString=r})(G6||={});var q6=(i=>(i[i.Never=1]="Never",i[i.OnProblem=2]="OnProblem",i[i.Always=3]="Always",i))(q6||{});(t=>{function r(e){switch(e.toLowerCase()){case"always":return 3;case"never":return 1;case"onproblem":return 2;default:return 2}}t.fromString=r})(q6||={});var $6=(i=>(i[i.Shared=1]="Shared",i[i.Dedicated=2]="Dedicated",i[i.New=3]="New",i))($6||{});(t=>{function r(e){switch(e.toLowerCase()){case"shared":return 1;case"dedicated":return 2;case"new":return 3;default:return 1}}t.fromString=r})($6||={});var Kwe;(t=>t.defaults={echo:!0,reveal:1,revealProblems:1,focus:!1,panel:1,showReuseMessage:!0,clear:!1})(Kwe||={});var j6=(i=>(i[i.Shell=1]="Shell",i[i.Process=2]="Process",i[i.CustomExecution=3]="CustomExecution",i))(j6||{});(e=>{function r(i){switch(i.toLowerCase()){case"shell":return 1;case"process":return 2;case"customExecution":return 3;default:return 2}}e.fromString=r;function t(i){switch(i){case 1:return"shell";case 2:return"process";case 3:return"customExecution";default:return"process"}}e.toString=t})(j6||={});var Gwe;(t=>{function r(e){return Bt(e)?e:e.value}t.value=r})(Gwe||={});var qwe;(s=>{s.Clean={_id:"clean",isDefault:!1},s.Build={_id:"build",isDefault:!1},s.Rebuild={_id:"rebuild",isDefault:!1},s.Test={_id:"test",isDefault:!1};function n(a){return a===s.Clean._id||a===s.Build._id||a===s.Rebuild._id||a===s.Test._id}s.is=n;function o(a){if(a!==void 0)return Bt(a)?n(a)?{_id:a,isDefault:!1}:void 0:a}s.from=o})(qwe||={});var KL;(s=>{s.Workspace="workspace",s.Extension="extension",s.InMemory="inMemory",s.WorkspaceFile="workspaceFile",s.User="user";function o(a){switch(a){case s.User:return 2;case s.WorkspaceFile:return 5;default:return 6}}s.toConfigurationTarget=o})(KL||={});var $we;(t=>t.defaults={reevaluateOnRerun:!0,runOn:1,instanceLimit:1})($we||={});var YB=class{_id;_label="";type;runOptions;configurationProperties;_source;_taskLoadMessages;constructor(t,e,i,n,o,s){this._id=t,e&&(this._label=e),i&&(this.type=i),this.runOptions=n,this.configurationProperties=o,this._source=s}getDefinition(t){}getMapKey(){return this._id}getKey(){}getCommonTaskId(){let t={folder:this.getFolderId(),id:this._id};return JSON.stringify(t)}clone(){return this.fromObject(Object.assign({},this))}getWorkspaceFolder(){}getWorkspaceFileName(){}getTelemetryKind(){return"unknown"}matches(t,e=!1){if(t===void 0)return!1;if(Bt(t))return t===this._label||t===this.configurationProperties.identifier||e&&t===this._id;let i=this.getDefinition(!0);return i!==void 0&&i._key===t._key}getQualifiedLabel(){let t=this.getWorkspaceFolder();return t?`${this._label} (${t.name})`:this._label}getTaskExecution(){return{id:this._id,task:this}}addTaskLoadMessages(t){this._taskLoadMessages===void 0&&(this._taskLoadMessages=[]),t&&(this._taskLoadMessages=this._taskLoadMessages.concat(t))}get taskLoadMessages(){return this._taskLoadMessages}},QB=class r extends YB{instance;_source;hasDefinedMatchers;command={};constructor(t,e,i,n,o,s,a,l){super(t,i,void 0,a,l,e),this._source=e,this.hasDefinedMatchers=s,o&&(this.command=o)}clone(){return new r(this._id,this._source,this._label,this.type,this.command,this.hasDefinedMatchers,this.runOptions,this.configurationProperties)}customizes(){if(this._source&&this._source.customizes)return this._source.customizes}getDefinition(t=!1){if(t&&this._source.customizes!==void 0)return this._source.customizes;{let e;switch(this.command?this.command.runtime:void 0){case 1:e="shell";break;case 2:e="process";break;case 3:e="customExecution";break;case void 0:e="$composite";break;default:throw new Error("Unexpected task runtime")}return{type:e,_key:this._id,id:this._id}}}static is(t){return t instanceof r}getMapKey(){let t=this._source.config.workspaceFolder;return t?`${t.uri.toString()}|${this._id}|${this.instance}`:`${this._id}|${this.instance}`}getFolderId(){return this._source.kind===KL.User?rce:this._source.config.workspaceFolder?.uri.toString()}getCommonTaskId(){return this._source.customizes?super.getCommonTaskId():this.getKey()??super.getCommonTaskId()}getKey(){let t=this.getFolderId();if(!t)return;let e=this.configurationProperties.identifier;return this._source.kind!==KL.Workspace&&(e+=this._source.kind),JSON.stringify({type:sce,folder:t,id:e})}getWorkspaceFolder(){return this._source.config.workspaceFolder}getWorkspaceFileName(){return this._source.config.workspace&&this._source.config.workspace.configuration?Ji(this._source.config.workspace.configuration):void 0}getTelemetryKind(){return this._source.customizes?"workspace>extension":"workspace"}fromObject(t){return new r(t._id,t._source,t._label,t.type,t.command,t.hasDefinedMatchers,t.runOptions,t.configurationProperties)}},ZB=class r extends YB{_source;configures;constructor(t,e,i,n,o,s,a){super(t,i,n,s,a,e),this._source=e,this.configures=o}static is(t){return t instanceof r}fromObject(t){return t}getDefinition(){return this.configures}getWorkspaceFileName(){return this._source.config.workspace&&this._source.config.workspace.configuration?Ji(this._source.config.workspace.configuration):void 0}getWorkspaceFolder(){return this._source.config.workspaceFolder}getFolderId(){return this._source.kind===KL.User?rce:this._source.config.workspaceFolder?.uri.toString()}getKey(){let t=this.getFolderId();if(!t)return;let e=this.configurationProperties.identifier;return this._source.kind!==KL.Workspace&&(e+=this._source.kind),JSON.stringify({type:sce,folder:t,id:e})}};var X6=(e=>(e[e.Process=1]="Process",e[e.Terminal=2]="Terminal",e))(X6||{});(t=>t._default=2)(X6||={});var jwe;(a=>{function r(l){return{taskId:l._id,taskName:l.configurationProperties.name,runType:l.configurationProperties.isBackground?"background":"singleRun",group:l.configurationProperties.group,__task:l}}function t(l,d,c){return{...r(l),kind:"start",terminalId:d,resolvedVariables:c}}a.start=t;function e(l,d,c){return{...r(l),kind:"processStarted",terminalId:d,processId:c}}a.processStarted=e;function i(l,d,c){return{...r(l),kind:"processEnded",terminalId:d,exitCode:c}}a.processEnded=i;function n(l,d,c){return{...r(l),kind:"terminated",exitReason:c,terminalId:d}}a.terminated=n;function o(l,d,c){return{...r(d),kind:l,terminalId:c}}a.general=o;function s(){return{kind:"changed"}}a.changed=s})(jwe||={});var z6;(e=>{function r(i){let n=Object.keys(i).sort(),o="";for(let s of n){let a=i[s];a instanceof Object?a=r(a):typeof a=="string"&&(a=a.replace(/,/g,",,")),o+=s+","+a+","}return o}function t(i){let o={_key:r(i),type:i.taskType};return Object.assign(o,i),o}e.create=t})(z6||={});var Xwe;(t=>{function r(e,i){let n=XB.get(e.type);if(n===void 0){let l=Xi(e);return delete l._key,z6.create(l)}let o=Object.create(null);o.type=n.taskType;let s=new Set;n.required.forEach(l=>s.add(l));let a=n.properties;for(let l of Object.keys(a)){let d=e[l];if(d!=null)o[l]=d;else if(s.has(l)){let c=a[l];if(c.default!==void 0)o[l]=Xi(c.default);else switch(c.type){case"boolean":o[l]=!1;break;case"number":case"integer":o[l]=0;break;case"string":o[l]="";break;default:i.error(u("TaskDefinition.missingRequiredProperty","Error: the task identifier '{0}' is missing the required property '{1}'. The task identifier will be ignored.",JSON.stringify(e,void 0,0),l));return}}}return z6.create(o)}t.createTaskIdentifier=r})(Xwe||={});var TSi=Symbol("unset");var wh=class r{constructor(t,e=t.length){this.path=t;this.viewEnd=e;if(t.length===0||e<1)throw new Error("cannot create test with empty path")}stringifed;static fromExtHostTestItem(t,e,i=t.parent){if(t._isRoot)return new r([e]);let n=[t.id];for(let o=i;o&&o.id!==e;o=o.parent)n.push(o.id);return n.push(e),new r(n.reverse())}static isRoot(t){return!t.includes("\0")}static root(t){let e=t.indexOf("\0");return e===-1?t:t.slice(0,e)}static fromString(t){return new r(t.split("\0"))}static join(t,e){return new r([...t.path,e])}static joinToString(t,e){return t.toString()+"\0"+e}static parentId(t){let e=t.lastIndexOf("\0");return e===-1?void 0:t.slice(0,e)}static localId(t){let e=t.lastIndexOf("\0");return e===-1?t:t.slice(e+1)}static isChild(t,e){return e[t.length]==="\0"&&e.startsWith(t)}static compare(t,e){return t===e?0:r.isChild(t,e)?2:r.isChild(e,t)?3:1}static getLengthOfCommonPrefix(t,e){if(t===0)return 0;let i=0;for(;i<t-1;){for(let n=1;n<t;n++){let o=e(n-1),s=e(n);if(o.path[i]!==s.path[i])return i}i++}return i}get rootId(){return new r(this.path,1)}get parentId(){return this.viewEnd>1?new r(this.path,this.viewEnd-1):void 0}get localId(){return this.path[this.viewEnd-1]}get controllerId(){return this.path[0]}get isRoot(){return this.viewEnd===1}*idsFromRoot(){for(let t=1;t<=this.viewEnd;t++)yield new r(this.path,t)}*idsToRoot(){for(let t=this.viewEnd;t>0;t--)yield new r(this.path,t)}compare(t){if(typeof t=="string")return r.compare(this.toString(),t);for(let e=0;e<t.viewEnd&&e<this.viewEnd;e++)if(t.path[e]!==this.path[e])return 1;return t.viewEnd>this.viewEnd?2:t.viewEnd<this.viewEnd?3:0}toJSON(){return this.toString()}toString(){if(!this.stringifed){this.stringifed=this.path[0];for(let t=1;t<this.viewEnd;t++)this.stringifed+="\0",this.stringifed+=this.path[t]}return this.stringifed}};var ace=[2,4,8,16,32,64];var GL;(e=>(e.serialize=i=>({range:i.range.toJSON(),uri:i.uri.toJSON()}),e.deserialize=(i,n)=>({range:L.lift(n.range),uri:i.asCanonicalUri(Z.revive(n.uri))})))(GL||={});var Y6;(e=>(e.serialize=i=>({label:i.label,uri:i.uri?.toJSON(),position:i.position?.toJSON()}),e.deserialize=(i,n)=>({label:n.label,uri:n.uri?i.asCanonicalUri(Z.revive(n.uri)):void 0,position:n.position?H.lift(n.position):void 0})))(Y6||={});var Q6;(e=>(e.serialize=i=>({message:i.message,type:0,expected:i.expected,actual:i.actual,contextValue:i.contextValue,location:i.location&&GL.serialize(i.location),stackTrace:i.stackTrace?.map(Y6.serialize)}),e.deserialize=(i,n)=>({message:n.message,type:0,expected:n.expected,actual:n.actual,contextValue:n.contextValue,location:n.location&&GL.deserialize(i,n.location),stackTrace:n.stackTrace&&n.stackTrace.map(o=>Y6.deserialize(i,o))})))(Q6||={});var lce=(r,t)=>`${t?"s":"e"}${r}`,Z6;(e=>(e.serialize=i=>({message:i.message,type:1,offset:i.offset,length:i.length,location:i.location&&GL.serialize(i.location)}),e.deserialize=(i,n)=>({message:n.message,type:1,offset:n.offset,length:n.length,location:n.location&&GL.deserialize(i,n.location)})))(Z6||={});var J6;(i=>(i.serialize=n=>n.type===0?Q6.serialize(n):Z6.serialize(n),i.deserialize=(n,o)=>o.type===0?Q6.deserialize(n,o):Z6.deserialize(n,o),i.isDiffable=n=>n.type===0&&n.actual!==void 0&&n.expected!==void 0))(J6||={});var JB;(i=>(i.serializeWithoutMessages=n=>({state:n.state,duration:n.duration,messages:[]}),i.serialize=n=>({state:n.state,duration:n.duration,messages:n.messages.map(J6.serialize)}),i.deserialize=(n,o)=>({state:o.state,duration:o.duration,messages:o.messages.map(s=>J6.deserialize(n,s))})))(JB||={});var eq;(e=>(e.serialize=i=>({extId:i.extId,label:i.label,tags:i.tags,busy:i.busy,children:void 0,uri:i.uri?.toJSON(),range:i.range?.toJSON()||null,description:i.description,error:i.error,sortText:i.sortText}),e.deserialize=(i,n)=>({extId:n.extId,label:n.label,tags:n.tags,busy:n.busy,children:void 0,uri:n.uri?i.asCanonicalUri(Z.revive(n.uri)):void 0,range:n.range?L.lift(n.range):null,description:n.description,error:n.error,sortText:n.sortText})))(eq||={});var bE;(e=>(e.serialize=i=>({expand:i.expand,item:eq.serialize(i.item)}),e.deserialize=(i,n)=>({controllerId:wh.root(n.item.extId),expand:n.expand,item:eq.deserialize(i,n.item)})))(bE||={});var tq;(e=>(e.serialize=i=>{let n;return i.item&&(n={},i.item.label!==void 0&&(n.label=i.item.label),i.item.tags!==void 0&&(n.tags=i.item.tags),i.item.busy!==void 0&&(n.busy=i.item.busy),i.item.uri!==void 0&&(n.uri=i.item.uri?.toJSON()),i.item.range!==void 0&&(n.range=i.item.range?.toJSON()),i.item.description!==void 0&&(n.description=i.item.description),i.item.error!==void 0&&(n.error=i.item.error),i.item.sortText!==void 0&&(n.sortText=i.item.sortText)),{extId:i.extId,expand:i.expand,item:n}},e.deserialize=i=>{let n;return i.item&&(n={},i.item.label!==void 0&&(n.label=i.item.label),i.item.tags!==void 0&&(n.tags=i.item.tags),i.item.busy!==void 0&&(n.busy=i.item.busy),i.item.range!==void 0&&(n.range=i.item.range?L.lift(i.item.range):null),i.item.description!==void 0&&(n.description=i.item.description),i.item.error!==void 0&&(n.error=i.item.error),i.item.sortText!==void 0&&(n.sortText=i.item.sortText)),{extId:i.extId,expand:i.expand,item:n}}))(tq||={});var qL;(i=>(i.serializeWithoutMessages=n=>({...bE.serialize(n),ownComputedState:n.ownComputedState,computedState:n.computedState,tasks:n.tasks.map(JB.serializeWithoutMessages)}),i.serialize=n=>({...bE.serialize(n),ownComputedState:n.ownComputedState,computedState:n.computedState,tasks:n.tasks.map(JB.serialize)}),i.deserialize=(n,o)=>({...bE.deserialize(n,o),ownComputedState:o.ownComputedState,computedState:o.computedState,tasks:o.tasks.map(s=>JB.deserialize(n,s)),retired:!0})))(qL||={});var rq;(e=>(e.empty=()=>({covered:0,total:0}),e.sum=(i,n)=>{i.covered+=n.covered,i.total+=n.total}))(rq||={});var Ywe;(i=>(i.serialize=n=>({id:n.id,statement:n.statement,branch:n.branch,declaration:n.declaration,testIds:n.testIds,uri:n.uri.toJSON()}),i.deserialize=(n,o)=>({id:o.id,statement:o.statement,branch:o.branch,declaration:o.declaration,testIds:o.testIds,uri:n.asCanonicalUri(Z.revive(o.uri))}),i.empty=(n,o)=>({id:n,uri:o,statement:rq.empty()})))(Ywe||={});function sq(r){return{...r,location:r.location?.toJSON()}}function aq(r){return r.location=r.location?H.isIPosition(r.location)?H.lift(r.location):L.lift(r.location):void 0,r}var Qwe;(e=>(e.serialize=i=>i.type===0?nq.serialize(i):oq.serialize(i),e.deserialize=i=>i.type===0?nq.deserialize(i):oq.deserialize(i)))(Qwe||={});var iq;(e=>(e.serialize=sq,e.deserialize=aq))(iq||={});var nq;(e=>(e.serialize=sq,e.deserialize=aq))(nq||={});var oq;(e=>(e.serialize=i=>({...sq(i),branches:i.branches?.map(iq.serialize)}),e.deserialize=i=>({...aq(i),branches:i.branches?.map(iq.deserialize)})))(oq||={});var Zwe;(e=>(e.deserialize=(i,n)=>n.op===0?{op:n.op,item:bE.deserialize(i,n.item)}:n.op===1?{op:n.op,item:tq.deserialize(n.item)}:n.op===2?{op:n.op,uri:i.asCanonicalUri(Z.revive(n.uri)),docv:n.docv}:n,e.serialize=i=>i.op===0?{op:i.op,item:bE.serialize(i.item)}:i.op===1?{op:i.op,item:tq.serialize(i.item)}:i))(Zwe||={});var Ud={2:6,6:5,4:4,1:3,3:2,0:0,5:1};var zSi=Tte(Ud,(r,t)=>({statusNode:!0,state:Number(t),priority:r})),Jwe=(r,t)=>Ud[t]-Ud[r],tV=(...r)=>{switch(r.length){case 0:return 0;case 1:return r[0];case 2:return Ud[r[0]]>Ud[r[1]]?r[0]:r[1];default:{let t=r[0];for(let e=1;e<r.length;e++)Ud[t]<Ud[r[e]]&&(t=r[e]);return t}}},dce=Object.keys(Ud).map(r=>Number(r)).sort(Jwe),lq={3:0,5:1,4:2,6:3},$L=()=>new Uint32Array(dce.length);var eEe=r=>"getOwnDuration"in r,dq=(r,t,e=!1)=>{let i=r.getCurrentComputedState(t);if(i===void 0||e){i=r.getOwnState(t)??0;let n=0,o=$L();for(let s of r.getChildren(t)){let a=dq(r,s);n++,o[a]++,i=a===5&&i===0?5:tV(i,a)}n>tEe&&uce.set(t,o),r.setComputedState(t,i)}return i},cce=(r,t,e=!1)=>{let i=r.getCurrentComputedDuration(t);if(i===void 0||e){let n=r.getOwnDuration(t);if(n!==void 0)i=n;else{i=void 0;for(let o of r.getChildren(t)){let s=cce(r,o);s!==void 0&&(i=(i||0)+s)}}r.setComputedDuration(t,i)}return i},tEe=64,uce=new WeakMap,pce=(r,t,e,i=!0)=>{let n=r.getCurrentComputedState(t),o=Ud[n],s=e??dq(r,t,!0),a=Ud[s],l=new Set;if(a!==o){r.setComputedState(t,s),l.add(t);let d=n,c=s;for(let p of r.getParents(t)){let h=uce.get(p);h&&(h[d]--,h[c]++);let m=r.getCurrentComputedState(p);if(a>o){if(m!==void 0&&Ud[m]>=a||h&&h[c]>1)break;r.setComputedState(p,s),l.add(p)}else{if(m===void 0||Ud[m]>o||h&&h[d]>0)break;c=dq(r,p,!0),r.setComputedState(p,c),l.add(p)}d=m}}if(eEe(r)&&i)for(let d of mt.concat(mt.single(t),r.getParents(t))){let c=r.getCurrentComputedDuration(d),p=cce(r,d,!0);if(c===p)break;r.setComputedDuration(d,p),l.add(d)}return l};var oEe={buffers:[],length:0,onDidWriteData:X.None,endPromise:Promise.resolve(),getRange:()=>Jt.alloc(0),getRangeIter:()=>[]},cq=class{writeDataEmitter=new x;endDeferred=new Kr;offset=0;onDidWriteData=this.writeDataEmitter.event;endPromise=this.endDeferred.p;buffers=[];get length(){return this.offset}getRange(t,e){let i=Jt.alloc(e),n=0;for(let o of this.getRangeIter(t,e))i.buffer.set(o.buffer,n),n+=o.byteLength;return n<e?i.slice(0,n):i}*getRangeIter(t,e){let i=0,n=0;for(let o of this.buffers){if(n+o.byteLength<=t){n+=o.byteLength;continue}let s=Math.max(0,t-n),a=Math.min(o.byteLength,s+e-i);if(yield o.slice(s,a),i+=a-s,n+=o.byteLength,i===e)break}}append(t,e){let i=this.offset,n=t.byteLength;if(e===void 0)return this.push(t),{offset:i,length:n};let o;(p=>(p[p.CR=13]="CR",p[p.LF=10]="LF"))(o||={});let s=Jt.fromString(hce(e,!0)),a=Jt.fromString(hce(e,!1));n+=s.byteLength+a.byteLength,this.push(s);let l=t.byteLength;for(;l>0;l--){let d=t.buffer[l-1];if(d!==13&&d!==10)break}return this.push(t.slice(0,l)),this.push(a),this.push(t.slice(l)),{offset:i,length:n}}push(t){t.byteLength!==0&&(this.buffers.push(t),this.writeDataEmitter.fire(t),this.offset+=t.byteLength)}end(){this.endDeferred.complete()}};var hce=(r,t)=>`\x1B]633;SetMark;Id=${lce(r,t)};Hidden\x07`,rEe=(r,t,e)=>({controllerId:r,expand:0,item:{...t},children:[],tasks:[],ownComputedState:0,computedState:0});var yb=class extends R{constructor(e,i,n,o){super();this.id=e;this.persist=i;this.request=n;this.telemetry=o}completeEmitter=this._register(new x);newTaskEmitter=this._register(new x);endTaskEmitter=this._register(new x);changeEmitter=this._register(new x);testById=new Map;testMarkerCounter=0;_completedAt;startedAt=Date.now();onChange=this.changeEmitter.event;onComplete=this.completeEmitter.event;onNewTask=this.newTaskEmitter.event;onEndTask=this.endTaskEmitter.event;tasks=[];name=u("runFinished","Test run at {0}",new Date().toLocaleString(qa));get completedAt(){return this._completedAt}counts=$L();get tests(){return this.testById.values()}getTestById(e){return this.testById.get(e)?.item}computedStateAccessor={getOwnState:e=>e.ownComputedState,getCurrentComputedState:e=>e.computedState,setComputedState:(e,i)=>e.computedState=i,getChildren:e=>e.children,getParents:e=>{let{testById:i}=this;return function*(){let n=wh.fromString(e.item.extId).parentId;if(n)for(let o of n.idsToRoot())yield i.get(o.toString())}()}};getStateById(e){return this.testById.get(e)}appendOutput(e,i,n,o){let s=e.byteLength>100?e.slice(0,100).toString()+"\u2026":e.toString(),a;(o||n)&&(a=this.testMarkerCounter++);let l=this.mustGetTaskIndex(i),d=this.tasks[l],{offset:c,length:p}=d.output.append(e,a),h={location:n,message:s,offset:c,length:p,marker:a,type:1},m=o&&this.testById.get(o);m?(m.tasks[l].messages.push(h),this.changeEmitter.fire({item:m,result:this,reason:2,message:h})):d.otherMessages.push(h)}addTask(e){this.tasks.push({...e,coverage:Ht(this,void 0),otherMessages:[],output:new cq});for(let i of this.tests)i.tasks.push({duration:void 0,messages:[],state:0});this.newTaskEmitter.fire(this.tasks.length-1)}addTestChainToRun(e,i){let n=this.testById.get(i[0].extId);n||(n=this.addTestToRun(e,i[0],null));for(let o=1;o<i.length;o++)n=this.addTestToRun(e,i[o],n.item.extId)}updateState(e,i,n,o){let s=this.testById.get(e);if(!s)return;let a=this.mustGetTaskIndex(i),l=lq[s.tasks[a].state],d=lq[n];l!==void 0&&(d===void 0||d<l)||this.fireUpdateAndRefresh(s,a,n,o)}appendMessage(e,i,n){let o=this.testById.get(e);o&&(o.tasks[this.mustGetTaskIndex(i)].messages.push(n),this.changeEmitter.fire({item:o,result:this,reason:2,message:n}))}markTaskComplete(e){let i=this.mustGetTaskIndex(e),n=this.tasks[i];n.running=!1,n.output.end(),this.setAllToState(0,e,o=>o.state===1||o.state===2),this.endTaskEmitter.fire(i)}markComplete(){if(this._completedAt!==void 0)throw new Error("cannot complete a test result multiple times");for(let e of this.tasks)e.running&&this.markTaskComplete(e.id);this._completedAt=Date.now(),this.completeEmitter.fire(),this.telemetry.publicLog2("test.outcomes",{failures:this.counts[6]+this.counts[4],passes:this.counts[3],controller:this.request.targets.map(e=>e.controllerId).join(",")})}markRetired(e){for(let[i,n]of this.testById)!n.retired&&(!e||e.hasKeyOrParent(wh.fromString(i).path))&&(n.retired=!0,this.changeEmitter.fire({reason:0,item:n,result:this}))}toJSON(){return this.completedAt&&this.persist?this.doSerialize.value:void 0}toJSONWithMessages(){return this.completedAt&&this.persist?this.doSerializeWithMessages.value:void 0}setAllToState(e,i,n){let o=this.mustGetTaskIndex(i);for(let s of this.testById.values())n(s.tasks[o],s)&&this.fireUpdateAndRefresh(s,o,e)}fireUpdateAndRefresh(e,i,n,o){let s=e.ownComputedState,a=e.ownDuration,l={item:e,result:this,reason:1,previousState:s,previousOwnDuration:a};e.tasks[i].state=n,o!==void 0&&(e.tasks[i].duration=o,e.ownDuration=Math.max(e.ownDuration||0,o));let d=tV(...e.tasks.map(c=>c.state));if(d===s){o!==a&&this.changeEmitter.fire(l);return}e.ownComputedState=d,this.counts[s]--,this.counts[d]++,pce(this.computedStateAccessor,e).forEach(c=>this.changeEmitter.fire(c===e?l:{item:c,result:this,reason:0}))}addTestToRun(e,i,n){let o=rEe(e,i,n);if(this.testById.set(i.extId,o),this.counts[0]++,n&&this.testById.get(n)?.children.push(o),this.tasks.length)for(let s=0;s<this.tasks.length;s++)o.tasks.push({duration:void 0,messages:[],state:0});return o}mustGetTaskIndex(e){let i=this.tasks.findIndex(n=>n.id===e);if(i===-1)throw new Error(`Unknown task ${e} in updateState`);return i}doSerialize=new qn(()=>({id:this.id,completedAt:this.completedAt,tasks:this.tasks.map(e=>({id:e.id,name:e.name,ctrlId:e.ctrlId,hasCoverage:!!e.coverage.get()})),name:this.name,request:this.request,items:[...this.testById.values()].map(qL.serializeWithoutMessages)}));doSerializeWithMessages=new qn(()=>({id:this.id,completedAt:this.completedAt,tasks:this.tasks.map(e=>({id:e.id,name:e.name,ctrlId:e.ctrlId,hasCoverage:!!e.coverage.get()})),name:this.name,request:this.request,items:[...this.testById.values()].map(qL.serialize)}))};yb=E([b(3,Tt)],yb);var iV=class{constructor(t,e,i=!0){this.serialized=e;this.persist=i;this.id=e.id,this.completedAt=e.completedAt,this.tasks=e.tasks.map((n,o)=>({id:n.id,name:n.name||u("testUnnamedTask","Unnamed Task"),ctrlId:n.ctrlId,running:!1,coverage:Ht(this,void 0),output:oEe,otherMessages:[]})),this.name=e.name,this.request=e.request;for(let n of e.items){let o=qL.deserialize(t,n);this.counts[o.ownComputedState]++,this.testById.set(n.item.extId,o)}}counts=$L();id;completedAt;tasks;get tests(){return this.testById.values()}name;request;testById=new Map;getStateById(t){return this.testById.get(t)}toJSON(){return this.persist?this.serialized:void 0}toJSONWithMessages(){return this.toJSON()}};var nr="workbench.view.debug",hy="workbench.debug.variablesView",Mu="workbench.debug.watchExpressionsView",ag="workbench.debug.callStackView",my="workbench.debug.loadedScriptsView",Aa="workbench.debug.breakPointsView",nV="workbench.debug.disassemblyView",oV="workbench.panel.repl",ln="workbench.panel.repl.view",VB=new A("debugType",void 0,{type:"string",description:u("debugType","Debug type of the active debug session. For example 'python'.")}),mce=new A("debugConfigurationType",void 0,{type:"string",description:u("debugConfigurationType","Debug type of the selected launch configuration. For example 'python'.")}),Gt=new A("debugState","inactive",{type:"string",description:u("debugState","State that the focused debug session is in. One of the following: 'inactive', 'initializing', 'stopped' or 'running'.")}),uq="debugUx",zd=new A(uq,"default",{type:"string",description:u("debugUX","Debug UX state. When there are no debug configurations it is 'simple', otherwise 'default'. Used to decide when to show welcome views in the debug viewlet.")}),rV=new A("hasDebugged",!1,{type:"boolean",description:u("hasDebugged","True when a debug session has been started at least once, false otherwise.")}),ui=new A("inDebugMode",!1,{type:"boolean",description:u("inDebugMode","True when debugging, false otherwise.")}),Eh=new A("inDebugRepl",!1,{type:"boolean",description:u("inDebugRepl","True when focus is in the debug console, false otherwise.")}),jL=new A("breakpointWidgetVisible",!1,{type:"boolean",description:u("breakpointWidgetVisibile","True when breakpoint editor zone widget is visible, false otherwise.")}),pq=new A("inBreakpointWidget",!1,{type:"boolean",description:u("inBreakpointWidget","True when focus is in the breakpoint editor zone widget, false otherwise.")}),vE=new A("breakpointsFocused",!0,{type:"boolean",description:u("breakpointsFocused","True when the BREAKPOINTS view is focused, false otherwise.")}),XL=new A("watchExpressionsFocused",!0,{type:"boolean",description:u("watchExpressionsFocused","True when the WATCH view is focused, false otherwise.")}),sV=new A("watchExpressionsExist",!1,{type:"boolean",description:u("watchExpressionsExist","True when at least one watch expression exists, false otherwise.")}),aV=new A("variablesFocused",!0,{type:"boolean",description:u("variablesFocused","True when the VARIABLES views is focused, false otherwise")}),lV=new A("expressionSelected",!1,{type:"boolean",description:u("expressionSelected","True when an expression input box is open in either the WATCH or the VARIABLES view, false otherwise.")}),dV=new A("breakpointInputFocused",!1,{type:"boolean",description:u("breakpointInputFocused","True when the input box has focus in the BREAKPOINTS view.")}),Ho=new A("callStackItemType",void 0,{type:"string",description:u("callStackItemType","Represents the item type of the focused element in the CALL STACK view. For example: 'session', 'thread', 'stackFrame'")}),cV=new A("callStackSessionIsAttach",!1,{type:"boolean",description:u("callStackSessionIsAttach","True when the session in the CALL STACK view is attach, false otherwise. Used internally for inline menus in the CALL STACK view.")}),Sb=new A("callStackItemStopped",!1,{type:"boolean",description:u("callStackItemStopped","True when the focused item in the CALL STACK is stopped. Used internaly for inline menus in the CALL STACK view.")}),hq=new A("callStackSessionHasOneThread",!1,{type:"boolean",description:u("callStackSessionHasOneThread","True when the focused session in the CALL STACK view has exactly one thread. Used internally for inline menus in the CALL STACK view.")}),xh=new A("watchItemType",void 0,{type:"string",description:u("watchItemType","Represents the item type of the focused element in the WATCH view. For example: 'expression', 'variable'")}),fb=new A("canViewMemory",void 0,{type:"boolean",description:u("canViewMemory","Indicates whether the item in the view has an associated memory refrence.")}),pl=new A("breakpointItemType",void 0,{type:"string",description:u("breakpointItemType","Represents the item type of the focused element in the BREAKPOINTS view. For example: 'breakpoint', 'exceptionBreakppint', 'functionBreakpoint', 'dataBreakpoint'")}),mq=new A("breakpointItemBytes",void 0,{type:"boolean",description:u("breakpointItemIsDataBytes","Whether the breakpoint item is a data breakpoint on a byte range.")}),gq=new A("breakpointHasModes",!1,{type:"boolean",description:u("breakpointHasModes","Whether the breakpoint has multiple modes it can switch to.")}),uV=new A("breakpointSupportsCondition",!1,{type:"boolean",description:u("breakpointSupportsCondition","True when the focused breakpoint supports conditions.")}),pV=new A("loadedScriptsSupported",!1,{type:"boolean",description:u("loadedScriptsSupported","True when the focused sessions supports the LOADED SCRIPTS view")}),gce=new A("loadedScriptsItemType",void 0,{type:"string",description:u("loadedScriptsItemType","Represents the item type of the focused element in the LOADED SCRIPTS view.")}),qs=new A("focusedSessionIsAttach",!1,{type:"boolean",description:u("focusedSessionIsAttach","True when the focused session is 'attach'.")}),Th=new A("focusedSessionIsNoDebug",!1,{type:"boolean",description:u("focusedSessionIsNoDebug","True when the focused session is run without debugging.")}),YL=new A("stepBackSupported",!1,{type:"boolean",description:u("stepBackSupported","True when the focused session supports 'stepBack' requests.")}),hV=new A("restartFrameSupported",!1,{type:"boolean",description:u("restartFrameSupported","True when the focused session supports 'restartFrame' requests.")}),mV=new A("stackFrameSupportsRestart",!1,{type:"boolean",description:u("stackFrameSupportsRestart","True when the focused stack frame supports 'restartFrame'.")}),gy=new A("jumpToCursorSupported",!1,{type:"boolean",description:u("jumpToCursorSupported","True when the focused session supports 'jumpToCursor' request.")}),Cb=new A("stepIntoTargetsSupported",!1,{type:"boolean",description:u("stepIntoTargetsSupported","True when the focused session supports 'stepIntoTargets' request.")}),lg=new A("breakpointsExist",!1,{type:"boolean",description:u("breakpointsExist","True when at least one breakpoint exists.")}),oi=new A("debuggersAvailable",!1,{type:"boolean",description:u("debuggersAvailable","True when there is at least one debug extensions active.")}),gV=new A("debugExtensionAvailable",!0,{type:"boolean",description:u("debugExtensionsAvailable","True when there is at least one debug extension installed and enabled.")}),Zde=new A("debugProtocolVariableMenuContext",void 0,{type:"string",description:u("debugProtocolVariableMenuContext","Represents the context the debug adapter sets on the focused variable in the VARIABLES view.")}),QL=new A("debugSetVariableSupported",!1,{type:"boolean",description:u("debugSetVariableSupported","True when the focused session supports 'setVariable' request.")}),IE=new A("debugSetDataBreakpointAddressSupported",!1,{type:"boolean",description:u("debugSetDataBreakpointAddressSupported","True when the focused session supports 'getBreakpointInfo' request on an address.")}),ZL=new A("debugSetExpressionSupported",!1,{type:"boolean",description:u("debugSetExpressionSupported","True when the focused session supports 'setExpression' request.")}),yE=new A("breakWhenValueChangesSupported",!1,{type:"boolean",description:u("breakWhenValueChangesSupported","True when the focused session supports to break when value changes.")}),JL=new A("breakWhenValueIsAccessedSupported",!1,{type:"boolean",description:u("breakWhenValueIsAccessedSupported","True when the focused breakpoint supports to break when value is accessed.")}),eR=new A("breakWhenValueIsReadSupported",!1,{type:"boolean",description:u("breakWhenValueIsReadSupported","True when the focused breakpoint supports to break when value is read.")}),Kd=new A("terminateDebuggeeSupported",!1,{type:"boolean",description:u("terminateDebuggeeSupported","True when the focused session supports the terminate debuggee capability.")}),wb=new A("suspendDebuggeeSupported",!1,{type:"boolean",description:u("suspendDebuggeeSupported","True when the focused session supports the suspend debuggee capability.")}),bb=new A("variableEvaluateNamePresent",!1,{type:"boolean",description:u("variableEvaluateNamePresent","True when the focused variable has an 'evalauteName' field set.")}),cy=new A("variableIsReadonly",!1,{type:"boolean",description:u("variableIsReadonly","True when the focused variable is read-only.")}),mE=new A("variableValue",!1,{type:"string",description:u("variableValue","Value of the variable, present for debug visualization clauses.")}),WB=new A("variableType",!1,{type:"string",description:u("variableType","Type of the variable, present for debug visualization clauses.")}),fce=new A("variableInterfaces",!1,{type:"array",description:u("variableInterfaces","Any interfaces or contracts that the variable satisfies, present for debug visualization clauses.")}),HB=new A("variableName",!1,{type:"string",description:u("variableName","Name of the variable, present for debug visualization clauses.")}),bce=new A("variableLanguage",!1,{type:"string",description:u("variableLanguage","Language of the variable source, present for debug visualization clauses.")}),vce=new A("variableExtensionId",!1,{type:"string",description:u("variableExtensionId","Extension ID of the variable source, present for debug visualization clauses.")}),fV=new A("exceptionWidgetVisible",!1,{type:"boolean",description:u("exceptionWidgetVisible","True when the exception widget is visible.")}),fq=new A("multiSessionRepl",!1,{type:"boolean",description:u("multiSessionRepl","True when there is more than 1 debug console.")}),bV=new A("multiSessionDebug",!1,{type:"boolean",description:u("multiSessionDebug","True when there is more than 1 active debug session.")}),SE=new A("disassembleRequestSupported",!1,{type:"boolean",description:u("disassembleRequestSupported","True when the focused sessions supports disassemble request.")}),_h=new A("disassemblyViewFocus",!1,{type:"boolean",description:u("disassemblyViewFocus","True when the Disassembly View is focused.")}),vV=new A("languageSupportsDisassembleRequest",!1,{type:"boolean",description:u("languageSupportsDisassembleRequest","True when the language in the current editor supports disassemble request.")}),IV=new A("focusedStackFrameHasInstructionReference",!1,{type:"boolean",description:u("focusedStackFrameHasInstructionReference","True when the focused stack frame has instruction pointer reference.")}),yV=r=>u("debuggerDisabled","Configured debug type '{0}' is installed but not supported in this environment.",r),dg="editor.contrib.debug",Gd="editor.contrib.breakpoint",Gs="debug",SV={enum:["neverOpen","openOnSessionStart","openOnFirstSessionStart"],default:"openOnFirstSessionStart",description:u("internalConsoleOptions","Controls when the internal Debug Console should open.")};function Ql(r){switch(r){case 1:return"initializing";case 2:return"stopped";case 3:return"running";default:return"inactive"}}var py="vscode-debug-memory";function Sh(r){let t=r.presentationHint??r.source.presentationHint;return t==="deemphasize"||t==="subtle"}var we=q("debugService");var sEe;(e=>(e.deserialize=i=>i,e.serialize=i=>i))(sEe||={});var aEe;(e=>(e.deserialize=i=>({id:i.id,name:i.name,iconPath:i.iconPath&&{light:Z.revive(i.iconPath.light),dark:Z.revive(i.iconPath.dark)},iconClass:i.iconClass,visualization:i.visualization}),e.serialize=i=>i))(aEe||={});var CV=T("editor.stackFrameHighlightBackground",{dark:"#ffff0033",light:"#ffff6673",hcDark:"#ffff0033",hcLight:"#ffff6673"},u("topStackFrameLineHighlight","Background color for the highlight of line at the top stack frame position.")),wV=T("editor.focusedStackFrameHighlightBackground",{dark:"#7abd7a4d",light:"#cee7ce73",hcDark:"#7abd7a4d",hcLight:"#cee7ce73"},u("focusedStackFrameLineHighlight","Background color for the highlight of line at focused stack frame position.")),EV=1,lEe={description:"top-stack-frame-margin",glyphMarginClassName:de.asClassName(iy),glyphMargin:{position:3},zIndex:9999,stickiness:EV,overviewRuler:{position:7,color:_d(CV)}},dEe={description:"focused-stack-frame-margin",glyphMarginClassName:de.asClassName(ny),glyphMargin:{position:3},zIndex:9999,stickiness:EV,overviewRuler:{position:7,color:_d(wV)}},cEe={description:"top-stack-frame-decoration",isWholeLine:!0,className:"debug-top-stack-frame-line",stickiness:EV},uEe={description:"focused-stack-frame-decoration",isWholeLine:!0,className:"debug-focused-stack-frame-line",stickiness:EV},pEe=r=>({description:"top-stack-frame-inline-decoration",before:{content:"\uEB8B",inlineClassName:r?"debug-top-stack-frame-column start-of-line":"debug-top-stack-frame-column",inlineClassNameAffectsLetterSpacing:!0}});function hEe(r,t,e){let i=[],n=new L(r.range.startLineNumber,r.range.startColumn,r.range.startLineNumber,1073741824),o=new L(r.range.startLineNumber,r.range.startColumn,r.range.startLineNumber,r.range.startColumn+1),s=r.thread.getTopStackFrame();return r.getId()===s?.getId()?(t&&i.push({options:lEe,range:o}),i.push({options:cEe,range:n}),r.range.startColumn>1&&i.push({options:pEe(e),range:n})):(t&&i.push({options:dEe,range:o}),i.push({options:uEe,range:n})),i}var CE=class extends R{constructor(e,i,n,o){super();this.editor=e;this.debugService=i;this.uriIdentityService=n;this.logService=o;let s=()=>this.decorations.set(this.createCallStackDecorations());this._register(X.any(this.debugService.getViewModel().onDidFocusStackFrame,this.debugService.getModel().onDidChangeCallStack)(()=>{s()})),this._register(this.editor.onDidChangeModel(a=>{a.newModelUrl&&s()})),s()}decorations=this.editor.createDecorationsCollection();createCallStackDecorations(){let e=this.editor;if(!e.hasModel())return[];let i=this.debugService.getViewModel().focusedStackFrame,n=[];return this.debugService.getModel().getSessions().forEach(o=>{let s=o===i?.thread.session;o.getAllThreads().forEach(a=>{if(a.stopped){let l=a.getCallStack(),d=[];l.length>0&&(i&&!i.equals(l[0])&&d.push(i),d.push(l[0])),d.forEach(c=>{if(c&&this.uriIdentityService.extUri.isEqual(c.source.uri,e.getModel()?.uri)){if(c.range.startLineNumber>e.getModel()?.getLineCount()||c.range.startLineNumber<1){this.logService.warn(`CallStackEditorContribution: invalid stack frame line number: ${c.range.startLineNumber}`);return}let p=e.getModel().getLineFirstNonWhitespaceColumn(c.range.startLineNumber)>=c.range.startColumn;n.push(...hEe(c,s,p))}})}})}),Mo(n,o=>`${o.options.className} ${o.options.glyphMarginClassName} ${o.range.startLineNumber} ${o.range.startColumn}`)}dispose(){super.dispose(),this.decorations.clear()}};CE=E([b(1,we),b(2,zn),b(3,bt)],CE);var Ice={allowBreakpoint:!1,isBreakpointSet:!1,isBreakpointEnabled:!1,instructionReference:"",instructionOffset:0,instructionReferenceOffset:0,address:0n,instruction:{address:"-1",instruction:u("instructionNotAvailable","Disassembly not available.")}},Oa=class extends oh{constructor(e,i,n,o,s,a,l){super(nV,e,i,n,o);this._configurationService=s;this._instantiationService=a;this._debugService=l;this._disassembledInstructions=void 0,this._onDidChangeStackFrame=this._register(new x({leakWarningThreshold:1e3})),this._previousDebuggingState=l.state,this._register(s.onDidChangeConfiguration(d=>{if(d.affectsConfiguration("debug")){let c=this._configurationService.getValue("debug").disassemblyView.showSourceCode;this._enableSourceCodeRender!==c?this._enableSourceCodeRender=c:this._disassembledInstructions?.rerender()}}))}static NUM_INSTRUCTIONS_TO_LOAD=50;_fontInfo;_disassembledInstructions;_onDidChangeStackFrame;_previousDebuggingState;_instructionBpList=[];_enableSourceCodeRender=!0;_loadingLock=!1;_referenceToMemoryAddress=new Map;get fontInfo(){return this._fontInfo||(this._fontInfo=this.createFontInfo(),this._register(this._configurationService.onDidChangeConfiguration(e=>{e.affectsConfiguration("editor")&&(this._fontInfo=this.createFontInfo())}))),this._fontInfo}createFontInfo(){return Mp.createFromRawSettings(this._configurationService.getValue("editor"),Zs.getInstance(this.window).value)}get currentInstructionAddresses(){return this._debugService.getModel().getSessions(!1).map(e=>e.getAllThreads()).reduce((e,i)=>e.concat(i),[]).map(e=>e.getTopStackFrame()).map(e=>e?.instructionPointerReference).map(e=>e?this.getReferenceAddress(e):void 0)}get focusedCurrentInstructionReference(){return this._debugService.getViewModel().focusedStackFrame?.thread.getTopStackFrame()?.instructionPointerReference}get focusedCurrentInstructionAddress(){let e=this.focusedCurrentInstructionReference;return e?this.getReferenceAddress(e):void 0}get focusedInstructionReference(){return this._debugService.getViewModel().focusedStackFrame?.instructionPointerReference}get focusedInstructionAddress(){let e=this.focusedInstructionReference;return e?this.getReferenceAddress(e):void 0}get isSourceCodeRender(){return this._enableSourceCodeRender}get debugSession(){return this._debugService.getViewModel().focusedSession}get onDidChangeStackFrame(){return this._onDidChangeStackFrame.event}get focusedAddressAndOffset(){let e=this._disassembledInstructions?.getFocusedElements()[0];if(!e)return;let i=e.instructionReference,n=Number(e.address-this.getReferenceAddress(i));return{reference:i,offset:n,address:e.address}}createEditor(e){this._enableSourceCodeRender=this._configurationService.getValue("debug").disassemblyView.showSourceCode;let i=this.fontInfo.lineHeight,n=this,o=new class{headerRowHeight=0;getHeight(a){return n.isSourceCodeRender&&a.showSourceLocation&&a.instruction.location?.path&&a.instruction.line?a.instruction.endLine?i*(a.instruction.endLine-a.instruction.line+2):i*2:i}},s=this._register(this._instantiationService.createInstance(Lc,this));this._disassembledInstructions=this._register(this._instantiationService.createInstance(sE,"DisassemblyView",e,o,[{label:"",tooltip:"",weight:0,minimumWidth:this.fontInfo.lineHeight,maximumWidth:this.fontInfo.lineHeight,templateId:Eb.TEMPLATE_ID,project(a){return a}},{label:u("disassemblyTableColumnLabel","instructions"),tooltip:"",weight:.3,templateId:Lc.TEMPLATE_ID,project(a){return a}}],[this._instantiationService.createInstance(Eb,this),s],{identityProvider:{getId:a=>a.instruction.address},horizontalScrolling:!1,overrideStyles:{listBackground:Hs},multipleSelectionSupport:!1,setRowLineHeight:!1,openOnSingleClick:!1,accessibilityProvider:new bq,mouseSupport:!1})),this._disassembledInstructions.domNode.classList.add("disassembly-view"),this.focusedInstructionReference&&this.reloadDisassembly(this.focusedInstructionReference,0),this._register(this._disassembledInstructions.onDidScroll(a=>{if(!this._loadingLock)if(a.oldScrollTop>a.scrollTop&&a.scrollTop<a.height){this._loadingLock=!0;let l=Math.floor(a.scrollTop/this.fontInfo.lineHeight);this.scrollUp_LoadDisassembledInstructions(Oa.NUM_INSTRUCTIONS_TO_LOAD).then(d=>{d>0&&this._disassembledInstructions.reveal(l+d,0),this._loadingLock=!1})}else a.oldScrollTop<a.scrollTop&&a.scrollTop+a.height>a.scrollHeight-a.height&&(this._loadingLock=!0,this.scrollDown_LoadDisassembledInstructions(Oa.NUM_INSTRUCTIONS_TO_LOAD).then(()=>{this._loadingLock=!1}))})),this._register(this._debugService.getViewModel().onDidFocusStackFrame(({stackFrame:a})=>{this._disassembledInstructions&&a?.instructionPointerReference&&this.goToInstructionAndOffset(a.instructionPointerReference,0),this._onDidChangeStackFrame.fire()})),this._register(this._debugService.getModel().onDidChangeBreakpoints(a=>{if(a&&this._disassembledInstructions){let l=!1;a.added?.forEach(d=>{if(d instanceof os){let c=this.getIndexFromReferenceAndOffset(d.instructionReference,d.offset);c>=0&&(this._disassembledInstructions.row(c).isBreakpointSet=!0,this._disassembledInstructions.row(c).isBreakpointEnabled=d.enabled,l=!0)}}),a.removed?.forEach(d=>{if(d instanceof os){let c=this.getIndexFromReferenceAndOffset(d.instructionReference,d.offset);c>=0&&(this._disassembledInstructions.row(c).isBreakpointSet=!1,l=!0)}}),a.changed?.forEach(d=>{if(d instanceof os){let c=this.getIndexFromReferenceAndOffset(d.instructionReference,d.offset);c>=0&&this._disassembledInstructions.row(c).isBreakpointEnabled!==d.enabled&&(this._disassembledInstructions.row(c).isBreakpointEnabled=d.enabled,l=!0)}}),this._instructionBpList=this._debugService.getModel().getInstructionBreakpoints();for(let d of this._instructionBpList)this.primeMemoryReference(d.instructionReference);l&&this._onDidChangeStackFrame.fire()}})),this._register(this._debugService.onDidChangeState(a=>{(a===3||a===2)&&this._previousDebuggingState!==3&&this._previousDebuggingState!==2&&(this.clear(),this._enableSourceCodeRender=this._configurationService.getValue("debug").disassemblyView.showSourceCode),this._previousDebuggingState=a,this._onDidChangeStackFrame.fire()}))}layout(e){this._disassembledInstructions?.layout(e.height)}async goToInstructionAndOffset(e,i,n){let o=this._referenceToMemoryAddress.get(e);o===void 0&&(await this.loadDisassembledInstructions(e,0,-Oa.NUM_INSTRUCTIONS_TO_LOAD,Oa.NUM_INSTRUCTIONS_TO_LOAD*2),o=this._referenceToMemoryAddress.get(e)),o&&this.goToAddress(o+BigInt(i),n)}getReferenceAddress(e){return this._referenceToMemoryAddress.get(e)}goToAddress(e,i){if(!this._disassembledInstructions||!e)return!1;let n=this.getIndexFromAddress(e);return n>=0?(this._disassembledInstructions.reveal(n),i&&(this._disassembledInstructions.domFocus(),this._disassembledInstructions.setFocus([n])),!0):!1}async scrollUp_LoadDisassembledInstructions(e){let i=this._disassembledInstructions?.row(0);return i?this.loadDisassembledInstructions(i.instructionReference,i.instructionReferenceOffset,i.instructionOffset-e,e):0}async scrollDown_LoadDisassembledInstructions(e){let i=this._disassembledInstructions?.row(this._disassembledInstructions?.length-1);return i?this.loadDisassembledInstructions(i.instructionReference,i.instructionReferenceOffset,i.instructionOffset+1,e):0}async primeMemoryReference(e){if(this._referenceToMemoryAddress.has(e))return!0;let i=await this.debugSession?.disassemble(e,0,0,1);if(i&&i.length>0)try{return this._referenceToMemoryAddress.set(e,BigInt(i[0].address)),!0}catch{return!1}return!1}async loadDisassembledInstructions(e,i,n,o){let s=this.debugSession,a=await s?.disassemble(e,i,n,o);if(!this._referenceToMemoryAddress.has(e)&&n!==0&&await this.loadDisassembledInstructions(e,0,0,Oa.NUM_INSTRUCTIONS_TO_LOAD),s&&a&&this._disassembledInstructions){let l=[],d,c;for(let k=0;k<a.length;k++){let M=a[k],O=n+k;if(M.location&&(d=M.location,c=void 0),M.line){let Y={startLineNumber:M.line,startColumn:M.column??0,endLineNumber:M.endLine??M.line,endColumn:M.endColumn??0};L.equalsRange(Y,c??null)||(c=Y,M.location=d)}let K;try{K=BigInt(M.address)}catch{console.error(`Could not parse disassembly address ${M.address} (in ${JSON.stringify(M)})`);continue}let G={allowBreakpoint:!0,isBreakpointSet:!1,isBreakpointEnabled:!1,instructionReference:e,instructionReferenceOffset:i,instructionOffset:O,instruction:M,address:K};l.push(G),i===0&&O===0&&this._referenceToMemoryAddress.set(e,K)}if(l.length===0)return 0;let p=this._referenceToMemoryAddress.get(e),h=this._instructionBpList.map(k=>{let M=this._referenceToMemoryAddress.get(k.instructionReference);if(M)return{enabled:k.enabled,address:M+BigInt(k.offset||0)}});if(p!==void 0)for(let k of l){let M=h.find(O=>O?.address===k.address);M&&(k.isBreakpointSet=!0,k.isBreakpointEnabled=M.enabled)}let m=this._disassembledInstructions;m.length===1&&this._disassembledInstructions.row(0)===Ice&&m.splice(0,1);let f=l[0].address,g=l[l.length-1].address,v=x_(m.length,k=>Number(m.row(k).address-f)),I=v<0?~v:v,y=x_(m.length,k=>Number(m.row(k).address-g)),C=(y<0?~y:y+1)-I,S;for(let k=I-1;k>=0;k--){let{instruction:M}=m.row(k);if(M.location&&M.line!==void 0){S=M;break}}let D=k=>k.line!==void 0&&k.location!==void 0&&(!S||!Xde(k.location,S.location)||k.line!==S.line);for(let k of l)D(k.instruction)&&(k.showSourceLocation=!0,S=k.instruction);return m.splice(I,C,l),l.length-C}return 0}getIndexFromReferenceAndOffset(e,i){let n=this._referenceToMemoryAddress.get(e);return n===void 0?-1:this.getIndexFromAddress(n+BigInt(i))}getIndexFromAddress(e){let i=this._disassembledInstructions;return i&&i.length>0?x_(i.length,n=>{let o=i.row(n);return Number(o.address-e)}):-1}reloadDisassembly(e,i){this._disassembledInstructions&&(this._loadingLock=!0,this.clear(),this._instructionBpList=this._debugService.getModel().getInstructionBreakpoints(),this.loadDisassembledInstructions(e,i,-Oa.NUM_INSTRUCTIONS_TO_LOAD*4,Oa.NUM_INSTRUCTIONS_TO_LOAD*8).then(()=>{if(this._disassembledInstructions.length>0){let n=Math.floor(this._disassembledInstructions.length/2);this._disassembledInstructions.reveal(n,.5),this._disassembledInstructions.domFocus(),this._disassembledInstructions.setFocus([n])}this._loadingLock=!1}))}clear(){this._referenceToMemoryAddress.clear(),this._disassembledInstructions?.splice(0,this._disassembledInstructions.length,[Ice])}};Oa=E([b(1,Tt),b(2,Fe),b(3,nt),b(4,se),b(5,ne),b(6,we)],Oa);var Eb=class{constructor(t,e){this._disassemblyView=t;this._debugService=e}static TEMPLATE_ID="breakpoint";templateId=Eb.TEMPLATE_ID;_breakpointIcon="codicon-"+_c.regular.id;_breakpointDisabledIcon="codicon-"+_c.disabled.id;_breakpointHintIcon="codicon-"+ML.id;_debugStackframe="codicon-"+iy.id;_debugStackframeFocused="codicon-"+ny.id;renderTemplate(t){t.style.alignSelf="flex-end";let e=U(t,J(".codicon"));e.style.display="flex",e.style.alignItems="center",e.style.justifyContent="center",e.style.height=this._disassemblyView.fontInfo.lineHeight+"px";let i={element:void 0},n=[this._disassemblyView.onDidChangeStackFrame(()=>this.rerenderDebugStackframe(e,i.element)),Ut(t,"mouseover",()=>{i.element?.allowBreakpoint&&e.classList.add(this._breakpointHintIcon)}),Ut(t,"mouseout",()=>{i.element?.allowBreakpoint&&e.classList.remove(this._breakpointHintIcon)}),Ut(t,"click",()=>{if(i.element?.allowBreakpoint){e.classList.add(this._breakpointHintIcon);let o=i.element.instructionReference,s=Number(i.element.address-this._disassemblyView.getReferenceAddress(o));i.element.isBreakpointSet?this._debugService.removeInstructionBreakpoints(o,s):i.element.allowBreakpoint&&!i.element.isBreakpointSet&&this._debugService.addInstructionBreakpoint({instructionReference:o,offset:s,address:i.element.address,canPersist:!1})}})];return{currentElement:i,icon:e,disposables:n}}renderElement(t,e,i,n){i.currentElement.element=t,this.rerenderDebugStackframe(i.icon,t)}disposeTemplate(t){_e(t.disposables),t.disposables=[]}rerenderDebugStackframe(t,e){e?.address===this._disassemblyView.focusedCurrentInstructionAddress?t.classList.add(this._debugStackframe):e?.address===this._disassemblyView.focusedInstructionAddress?t.classList.add(this._debugStackframeFocused):(t.classList.remove(this._debugStackframe),t.classList.remove(this._debugStackframeFocused)),t.classList.remove(this._breakpointHintIcon),e?.isBreakpointSet?e.isBreakpointEnabled?(t.classList.add(this._breakpointIcon),t.classList.remove(this._breakpointDisabledIcon)):(t.classList.remove(this._breakpointIcon),t.classList.add(this._breakpointDisabledIcon)):(t.classList.remove(this._breakpointIcon),t.classList.remove(this._breakpointDisabledIcon))}};Eb=E([b(1,we)],Eb);var Lc=class extends R{constructor(e,i,n,o,s,a){super();this._disassemblyView=e;this.editorService=n;this.textModelService=o;this.uriService=s;this.logService=a;this._topStackFrameColor=i.getColorTheme().getColor(CV),this._focusedStackFrameColor=i.getColorTheme().getColor(wV),this._register(i.onDidColorThemeChange(l=>{this._topStackFrameColor=l.getColor(CV),this._focusedStackFrameColor=l.getColor(wV)}))}static TEMPLATE_ID="instruction";static INSTRUCTION_ADDR_MIN_LENGTH=25;static INSTRUCTION_BYTES_MIN_LENGTH=30;templateId=Lc.TEMPLATE_ID;_topStackFrameColor;_focusedStackFrameColor;renderTemplate(e){let i=U(e,J(".sourcecode")),n=U(e,J(".instruction"));this.applyFontInfo(i),this.applyFontInfo(n);let o={element:void 0},s=[],a=[this._disassemblyView.onDidChangeStackFrame(()=>this.rerenderBackground(n,i,o.element)),Ut(i,"dblclick",()=>this.openSourceCode(o.element?.instruction))];return{currentElement:o,instruction:n,sourcecode:i,cellDisposable:s,disposables:a}}renderElement(e,i,n,o){this.renderElementInner(e,i,n,o)}async renderElementInner(e,i,n,o){n.currentElement.element=e;let s=e.instruction;n.sourcecode.innerText="";let a=new xd(1e3);if(this._disassemblyView.isSourceCodeRender&&e.showSourceLocation&&s.location?.path&&s.line!==void 0){let d=this.getUriFromSource(s);if(d){let c,p=new xd(1e4),h=await this.textModelService.createModelReference(d);if(n.currentElement.element!==e)return;if(c=h.object.textEditorModel,n.cellDisposable.push(h),c&&n.currentElement.element===e){let m=s.line;for(;m&&m>=1&&m<=c.getLineCount();){let f=c.getLineContent(m);if(p.appendString(`  ${m}: `),p.appendString(f+`
`),s.endLine&&m<s.endLine){m++;continue}break}n.sourcecode.innerText=p.build()}}}let l=10;if(s.address!=="-1"){a.appendString(s.address),s.address.length<Lc.INSTRUCTION_ADDR_MIN_LENGTH&&(l=Lc.INSTRUCTION_ADDR_MIN_LENGTH-s.address.length);for(let d=0;d<l;d++)a.appendString(" ")}if(s.instructionBytes){a.appendString(s.instructionBytes),l=10,s.instructionBytes.length<Lc.INSTRUCTION_BYTES_MIN_LENGTH&&(l=Lc.INSTRUCTION_BYTES_MIN_LENGTH-s.instructionBytes.length);for(let d=0;d<l;d++)a.appendString(" ")}a.appendString(s.instruction),n.instruction.innerText=a.build(),this.rerenderBackground(n.instruction,n.sourcecode,e)}disposeElement(e,i,n,o){_e(n.cellDisposable),n.cellDisposable=[]}disposeTemplate(e){_e(e.disposables),e.disposables=[]}rerenderBackground(e,i,n){n&&this._disassemblyView.currentInstructionAddresses.includes(n.address)?e.style.background=this._topStackFrameColor?.toString()||"transparent":n?.address===this._disassemblyView.focusedInstructionAddress?e.style.background=this._focusedStackFrameColor?.toString()||"transparent":e.style.background="transparent"}openSourceCode(e){if(e){let i=this.getUriFromSource(e),n=e.endLine?{startLineNumber:e.line,endLineNumber:e.endLine,startColumn:e.column||1,endColumn:e.endColumn||1073741824}:{startLineNumber:e.line,endLineNumber:e.line,startColumn:e.column||1,endColumn:e.endColumn||1073741824};this.editorService.openEditor({resource:i,description:u("editorOpenedFromDisassemblyDescription","from disassembly"),options:{preserveFocus:!1,selection:n,revealIfOpened:!0,selectionRevealType:1,pinned:!1}})}}getUriFromSource(e){let i=e.location.path;return i&&dy(i)?this.uriService.asCanonicalUri(Z.parse(i)):i&&ja(i)?this.uriService.asCanonicalUri(Z.file(i)):WL(e.location,e.location.path,this._disassemblyView.debugSession.getId(),this.uriService,this.logService)}applyFontInfo(e){hn(e,this._disassemblyView.fontInfo),e.style.whiteSpace="pre"}};Lc=E([b(1,Fe),b(2,$e),b(3,Tr),b(4,zn),b(5,bt)],Lc);var bq=class{getWidgetAriaLabel(){return u("disassemblyView","Disassembly View")}getAriaLabel(t){let e="",i=t.instruction;return i.address!=="-1"&&(e+=`${u("instructionAddress","Address")}: ${i.address}`),i.instructionBytes&&(e+=`, ${u("instructionBytes","Bytes")}: ${i.instructionBytes}`),e+=`, ${u("instructionText","Instruction")}: ${i.instruction}`,e}},wE=class{_onDidActiveEditorChangeListener;_onDidChangeModelLanguage;_languageSupportsDisassembleRequest;constructor(t,e,i){i.bufferChangeEvents(()=>{this._languageSupportsDisassembleRequest=vV.bindTo(i)});let n=()=>{this._onDidChangeModelLanguage&&(this._onDidChangeModelLanguage.dispose(),this._onDidChangeModelLanguage=void 0);let o=t.activeTextEditorControl;if(no(o)){let s=o.getModel()?.getLanguageId();this._languageSupportsDisassembleRequest?.set(!!s&&e.getAdapterManager().someDebuggerInterestedInLanguage(s)),this._onDidChangeModelLanguage=o.onDidChangeModelLanguage(a=>{this._languageSupportsDisassembleRequest?.set(e.getAdapterManager().someDebuggerInterestedInLanguage(a.newLanguage))})}else this._languageSupportsDisassembleRequest?.set(!1)};n(),this._onDidActiveEditorChangeListener=t.onDidActiveEditorChange(n)}dispose(){this._onDidActiveEditorChangeListener.dispose(),this._onDidChangeModelLanguage?.dispose()}};wE=E([b(0,$e),b(1,we),b(2,re)],wE);var Bi=J;function kb(r){let t=Bi("input");return t.type="checkbox",t.tabIndex=-1,r.push(yi.ignoreTarget(t)),t}var gEe=9;function yce(r,t,e){let i=r.getBreakpoints().length+r.getExceptionBreakpointsForSession(t).length+r.getFunctionBreakpoints().length+r.getDataBreakpoints().length+r.getInstructionBreakpoints().length;return Math.min(e,i)*22}var EE=class extends Lr{constructor(e,i,n,o,s,a,l,d,c,p,h,m,f,g,v,I,y){super(e,o,i,c,h,p,s,m,a,f,I);this.debugService=n;this.editorService=l;this.contextViewService=d;this.labelService=g;this.languageService=y;this.menu=v.createMenu(V.DebugBreakpointsContext,h),this._register(this.menu),this.breakpointItemType=pl.bindTo(h),this.breakpointIsDataBytes=mq.bindTo(h),this.breakpointHasMultipleModes=gq.bindTo(h),this.breakpointSupportsCondition=uV.bindTo(h),this.breakpointInputFocused=dV.bindTo(h),this._register(this.debugService.getModel().onDidChangeBreakpoints(()=>this.onBreakpointsChange())),this._register(this.debugService.getViewModel().onDidFocusSession(()=>this.onBreakpointsChange())),this._register(this.debugService.onDidChangeState(()=>this.onStateChange())),this.hintDelayer=this._register(new Ye(()=>this.updateBreakpointsHint(!0),4e3))}list;needsRefresh=!1;needsStateChange=!1;ignoreLayout=!1;menu;breakpointItemType;breakpointIsDataBytes;breakpointHasMultipleModes;breakpointSupportsCondition;_inputBoxData;breakpointInputFocused;autoFocusedIndex=-1;hintContainer;hintDelayer;renderBody(e){super.renderBody(e),this.element.classList.add("debug-pane"),e.classList.add("debug-breakpoints");let i=new vq(this);this.list=this.instantiationService.createInstance(rE,"Breakpoints",e,i,[this.instantiationService.createInstance(xb,this.menu,this.breakpointHasMultipleModes,this.breakpointSupportsCondition,this.breakpointItemType),new xV(this.menu,this.breakpointHasMultipleModes,this.breakpointSupportsCondition,this.breakpointItemType,this.debugService,this.hoverService),new DV(this,this.debugService,this.contextViewService),this.instantiationService.createInstance(Tb,this.menu,this.breakpointSupportsCondition,this.breakpointItemType),new TV(this,this.debugService,this.contextViewService,this.hoverService,this.labelService),this.instantiationService.createInstance(_b,this.menu,this.breakpointHasMultipleModes,this.breakpointSupportsCondition,this.breakpointItemType,this.breakpointIsDataBytes),new _V(this,this.debugService,this.contextViewService,this.hoverService,this.labelService),this.instantiationService.createInstance(Db)],{identityProvider:{getId:o=>o.getId()},multipleSelectionSupport:!1,keyboardNavigationLabelProvider:{getKeyboardNavigationLabel:o=>o},accessibilityProvider:new Iq(this.debugService,this.labelService),overrideStyles:this.getLocationBasedColors().listOverrideStyles}),vE.bindTo(this.list.contextKeyService),this._register(this.list.onContextMenu(this.onListContextMenu,this)),this.list.onMouseMiddleClick(async({element:o})=>{o instanceof ir?await this.debugService.removeBreakpoints(o.getId()):o instanceof ns?await this.debugService.removeFunctionBreakpoints(o.getId()):o instanceof xs?await this.debugService.removeDataBreakpoints(o.getId()):o instanceof os&&await this.debugService.removeInstructionBreakpoints(o.instructionReference,o.offset)}),this._register(this.list.onDidOpen(async o=>{o.element&&(Za(o.browserEvent)&&o.browserEvent.button===1||(o.element instanceof ir&&xE(o.element,o.sideBySide,o.editorOptions.preserveFocus||!1,o.editorOptions.pinned||!o.editorOptions.preserveFocus,this.debugService,this.editorService),o.element instanceof os&&(await this.editorService.openEditor(Yl.instance)).goToInstructionAndOffset(o.element.instructionReference,o.element.offset,Za(o.browserEvent)&&o.browserEvent.detail===2),Za(o.browserEvent)&&o.browserEvent.detail===2&&o.element instanceof ns&&o.element!==this.inputBoxData?.breakpoint&&this.renderInputBox({breakpoint:o.element,type:"name"})))})),this.list.splice(0,this.list.length,this.elements),this._register(this.onDidChangeBodyVisibility(o=>{o&&(this.needsRefresh&&this.onBreakpointsChange(),this.needsStateChange&&this.onStateChange())}));let n=this.viewDescriptorService.getViewContainerModel(this.viewDescriptorService.getViewContainerByViewId(this.id));this._register(n.onDidChangeAllViewDescriptors(()=>{this.updateSize()}))}renderHeaderTitle(e,i){super.renderHeaderTitle(e,i);let n=U(e,Bi("span.breakpoint-warning"));this.hintContainer=this._register(new gh(n,{supportIcons:!0,hoverDelegate:{showHover:(o,s)=>this.hoverService.showHover({content:o.content,target:this.hintContainer.element},s),delay:this.configurationService.getValue("workbench.hover.delay")}})),ji(this.hintContainer.element)}focus(){super.focus(),this.list?.domFocus()}renderInputBox(e){this._inputBoxData=e,this.onBreakpointsChange(),this._inputBoxData=void 0}get inputBoxData(){return this._inputBoxData}layoutBody(e,i){if(!this.ignoreLayout){super.layoutBody(e,i),this.list?.layout(e,i);try{this.ignoreLayout=!0,this.updateSize()}finally{this.ignoreLayout=!1}}}onListContextMenu(e){let i=e.element,n=i instanceof ir?"breakpoint":i instanceof kc?"exceptionBreakpoint":i instanceof ns?"functionBreakpoint":i instanceof xs?"dataBreakpoint":i instanceof os?"instructionBreakpoint":void 0;this.breakpointItemType.set(n);let o=this.debugService.getViewModel().focusedSession,s=i instanceof kc?i.supportsCondition:!o||!!o.capabilities.supportsConditionalBreakpoints;this.breakpointSupportsCondition.set(s),this.breakpointIsDataBytes.set(i instanceof xs&&i.src.type===1);let a=[];sa(this.menu,{arg:e.element,shouldForwardArgs:!1},{primary:[],secondary:a},"inline"),this.contextMenuService.showContextMenu({getAnchor:()=>e.anchor,getActions:()=>a,getActionsContext:()=>i})}updateSize(){let e=this.viewDescriptorService.getViewContainerModel(this.viewDescriptorService.getViewContainerByViewId(this.id)),i=this.debugService.getViewModel().focusedSession?.getId();this.minimumBodySize=this.orientation===0?yce(this.debugService.getModel(),i,gEe):170,this.maximumBodySize=this.orientation===0&&e.visibleViewDescriptors.length>1?yce(this.debugService.getModel(),i,Number.POSITIVE_INFINITY):Number.POSITIVE_INFINITY}updateBreakpointsHint(e=!1){if(!this.hintContainer)return;let i=this.debugService.getViewModel().focusedSession?.configuration.type,n=i?this.debugService.getAdapterManager().getDebugger(i):void 0,o=n?.strings?.unverifiedBreakpoints,s=o&&this.debugService.getModel().getBreakpoints().filter(a=>{if(a.verified||!a.enabled)return!1;let l=this.languageService.guessLanguageIdByFilepathOrFirstLine(a.uri);return l&&n.interestedInLanguage(l)});if(o&&s?.length&&this.debugService.getModel().areBreakpointsActivated())if(e){let a=new Sn(void 0,{isTrusted:!0}).appendMarkdown(o);this.hintContainer.setLabel("$(warning)",void 0,{title:{markdown:a,markdownNotSupportedFallback:o}}),rn(this.hintContainer.element)}else this.hintDelayer.schedule();else ji(this.hintContainer.element)}onBreakpointsChange(){if(this.isBodyVisible()){if(this.updateSize(),this.list){let e=this.list.getFocus()[0],i=e&&!this.elements.includes(this.list.element(e));this.list.splice(0,this.list.length,this.elements),this.needsRefresh=!1,i&&this.list.focusNth(Math.min(e,this.list.length-1))}this.updateBreakpointsHint()}else this.needsRefresh=!0}onStateChange(){if(this.isBodyVisible()){this.needsStateChange=!1;let e=this.debugService.getViewModel().focusedThread,i=!1;if(e&&e.stoppedDetails&&e.stoppedDetails.hitBreakpointIds&&e.stoppedDetails.hitBreakpointIds.length>0){let n=e.stoppedDetails.hitBreakpointIds,s=this.elements.findIndex(a=>{let l=a.getIdFromAdapter(e.session.getId());return typeof l=="number"&&n.indexOf(l)!==-1});s>=0&&(this.list.setFocus([s]),this.list.setSelection([s]),i=!0,this.autoFocusedIndex=s)}if(!i){let n=this.list.getFocus(),o=this.list.getSelection();this.autoFocusedIndex>=0&&xi(n,o)&&n.indexOf(this.autoFocusedIndex)>=0&&(this.list.setFocus([]),this.list.setSelection([])),this.autoFocusedIndex=-1}this.updateBreakpointsHint()}else this.needsStateChange=!0}get elements(){let e=this.debugService.getModel(),i=this.debugService.getViewModel().focusedSession?.getId();return e.getExceptionBreakpointsForSession(i).concat(e.getFunctionBreakpoints()).concat(e.getDataBreakpoints()).concat(e.getBreakpoints()).concat(e.getInstructionBreakpoints())}};EE=E([b(1,vt),b(2,we),b(3,Be),b(4,ne),b(5,Fe),b(6,$e),b(7,so),b(8,se),b(9,$i),b(10,re),b(11,Yi),b(12,Tt),b(13,hi),b(14,jt),b(15,Nt),b(16,ti)],EE);var vq=class{constructor(t){this.view=t}getHeight(t){return 22}getTemplateId(t){if(t instanceof ir)return xb.ID;if(t instanceof ns){let e=this.view.inputBoxData?.breakpoint;return!t.name||e&&e.getId()===t.getId()?TV.ID:Tb.ID}if(t instanceof kc){let e=this.view.inputBoxData?.breakpoint;return e&&e.getId()===t.getId()?DV.ID:xV.ID}if(t instanceof xs){let e=this.view.inputBoxData?.breakpoint;return e&&e.getId()===t.getId()?_V.ID:_b.ID}return t instanceof os?Db.ID:""}},tR=new Map,xb=class{constructor(t,e,i,n,o,s,a){this.menu=t;this.breakpointHasMultipleModes=e;this.breakpointSupportsCondition=i;this.breakpointItemType=n;this.debugService=o;this.hoverService=s;this.labelService=a}static ID="breakpoints";get templateId(){return xb.ID}renderTemplate(t){let e=Object.create(null);e.toDispose=[],e.breakpoint=U(t,Bi(".breakpoint")),e.icon=Bi(".icon"),e.checkbox=kb(e.toDispose),e.toDispose.push(Ut(e.checkbox,"change",n=>{this.debugService.enableOrDisableBreakpoints(!e.context.enabled,e.context)})),U(e.breakpoint,e.icon),U(e.breakpoint,e.checkbox),e.name=U(e.breakpoint,Bi("span.name")),e.filePath=U(e.breakpoint,Bi("span.file-path")),e.actionBar=new Fi(e.breakpoint),e.toDispose.push(e.actionBar);let i=U(e.breakpoint,Bi(".badge-container"));return e.badge=U(i,Bi("span.line-number.monaco-count-badge")),e}renderElement(t,e,i){i.context=t,i.breakpoint.classList.toggle("disabled",!this.debugService.getModel().areBreakpointsActivated()),i.name.textContent=Ns(t.uri);let n=t.lineNumber.toString();t.column&&(n+=`:${t.column}`),t.modeLabel&&(n=`${t.modeLabel}: ${n}`),i.badge.textContent=n,i.filePath.textContent=this.labelService.getUriLabel(Hn(t.uri),{relative:!0}),i.checkbox.checked=t.enabled;let{message:o,icon:s}=Dh(this.debugService.state,this.debugService.getModel().areBreakpointsActivated(),t,this.labelService,this.debugService.getModel());i.icon.className=de.asClassName(s),i.toDispose.push(this.hoverService.setupManagedHover(gt("mouse"),i.breakpoint,t.message||o||"")),(this.debugService.state===3||this.debugService.state===2)&&!t.verified&&i.breakpoint.classList.add("disabled");let l=[],d=this.debugService.getViewModel().focusedSession;this.breakpointSupportsCondition.set(!d||!!d.capabilities.supportsConditionalBreakpoints),this.breakpointItemType.set("breakpoint"),this.breakpointHasMultipleModes.set(this.debugService.getModel().getBreakpointModes("source").length>1),Vo(this.menu,{arg:t,shouldForwardArgs:!0},{primary:l,secondary:[]},"inline"),i.actionBar.clear(),i.actionBar.push(l,{icon:!0,label:!1}),tR.set(t.getId(),i.actionBar.domNode)}disposeTemplate(t){_e(t.toDispose)}};xb=E([b(4,we),b(5,Nt),b(6,hi)],xb);var xV=class r{constructor(t,e,i,n,o,s){this.menu=t;this.breakpointHasMultipleModes=e;this.breakpointSupportsCondition=i;this.breakpointItemType=n;this.debugService=o;this.hoverService=s}static ID="exceptionbreakpoints";get templateId(){return r.ID}renderTemplate(t){let e=Object.create(null);e.toDispose=[],e.breakpoint=U(t,Bi(".breakpoint")),e.checkbox=kb(e.toDispose),e.toDispose.push(Ut(e.checkbox,"change",n=>{this.debugService.enableOrDisableBreakpoints(!e.context.enabled,e.context)})),U(e.breakpoint,e.checkbox),e.name=U(e.breakpoint,Bi("span.name")),e.condition=U(e.breakpoint,Bi("span.condition")),e.breakpoint.classList.add("exception"),e.actionBar=new Fi(e.breakpoint),e.toDispose.push(e.actionBar);let i=U(e.breakpoint,Bi(".badge-container"));return e.badge=U(i,Bi("span.line-number.monaco-count-badge")),e}renderElement(t,e,i){i.context=t,i.name.textContent=t.label||`${t.filter} exceptions`;let n=t.verified?t.description||i.name.textContent:t.message||u("unverifiedExceptionBreakpoint","Unverified Exception Breakpoint");i.toDispose.push(this.hoverService.setupManagedHover(gt("mouse"),i.breakpoint,n)),i.breakpoint.classList.toggle("disabled",!t.verified),i.checkbox.checked=t.enabled,i.condition.textContent=t.condition||"",i.toDispose.push(this.hoverService.setupManagedHover(gt("mouse"),i.condition,u("expressionCondition","Expression condition: {0}",t.condition))),t.modeLabel?(i.badge.textContent=t.modeLabel,i.badge.style.display="block"):i.badge.style.display="none";let o=[];this.breakpointSupportsCondition.set(t.supportsCondition),this.breakpointItemType.set("exceptionBreakpoint"),this.breakpointHasMultipleModes.set(this.debugService.getModel().getBreakpointModes("exception").length>1),Vo(this.menu,{arg:t,shouldForwardArgs:!0},{primary:o,secondary:[]},"inline"),i.actionBar.clear(),i.actionBar.push(o,{icon:!0,label:!1}),tR.set(t.getId(),i.actionBar.domNode)}disposeTemplate(t){_e(t.toDispose)}},Tb=class{constructor(t,e,i,n,o,s){this.menu=t;this.breakpointSupportsCondition=e;this.breakpointItemType=i;this.debugService=n;this.hoverService=o;this.labelService=s}static ID="functionbreakpoints";get templateId(){return Tb.ID}renderTemplate(t){let e=Object.create(null);e.toDispose=[],e.breakpoint=U(t,Bi(".breakpoint")),e.icon=Bi(".icon"),e.checkbox=kb(e.toDispose),e.toDispose.push(Ut(e.checkbox,"change",n=>{this.debugService.enableOrDisableBreakpoints(!e.context.enabled,e.context)})),U(e.breakpoint,e.icon),U(e.breakpoint,e.checkbox),e.name=U(e.breakpoint,Bi("span.name")),e.condition=U(e.breakpoint,Bi("span.condition")),e.actionBar=new Fi(e.breakpoint),e.toDispose.push(e.actionBar);let i=U(e.breakpoint,Bi(".badge-container"));return e.badge=U(i,Bi("span.line-number.monaco-count-badge")),e}renderElement(t,e,i){i.context=t,i.name.textContent=t.name;let{icon:n,message:o}=Dh(this.debugService.state,this.debugService.getModel().areBreakpointsActivated(),t,this.labelService,this.debugService.getModel());i.icon.className=de.asClassName(n),i.toDispose.push(this.hoverService.setupManagedHover(gt("mouse"),i.icon,o||"")),i.checkbox.checked=t.enabled,i.toDispose.push(this.hoverService.setupManagedHover(gt("mouse"),i.breakpoint,o||"")),t.condition&&t.hitCondition?i.condition.textContent=u("expressionAndHitCount","Condition: {0} | Hit Count: {1}",t.condition,t.hitCondition):i.condition.textContent=t.condition||t.hitCondition||"",t.modeLabel?(i.badge.textContent=t.modeLabel,i.badge.style.display="block"):i.badge.style.display="none";let s=this.debugService.getViewModel().focusedSession;i.breakpoint.classList.toggle("disabled",s&&!s.capabilities.supportsFunctionBreakpoints||!this.debugService.getModel().areBreakpointsActivated()),s&&!s.capabilities.supportsFunctionBreakpoints&&i.toDispose.push(this.hoverService.setupManagedHover(gt("mouse"),i.breakpoint,u("functionBreakpointsNotSupported","Function breakpoints are not supported by this debug type")));let a=[];this.breakpointSupportsCondition.set(!s||!!s.capabilities.supportsConditionalBreakpoints),this.breakpointItemType.set("functionBreakpoint"),Vo(this.menu,{arg:t,shouldForwardArgs:!0},{primary:a,secondary:[]},"inline"),i.actionBar.clear(),i.actionBar.push(a,{icon:!0,label:!1}),tR.set(t.getId(),i.actionBar.domNode)}disposeTemplate(t){_e(t.toDispose)}};Tb=E([b(3,we),b(4,Nt),b(5,hi)],Tb);var _b=class{constructor(t,e,i,n,o,s,a,l){this.menu=t;this.breakpointHasMultipleModes=e;this.breakpointSupportsCondition=i;this.breakpointItemType=n;this.breakpointIsDataBytes=o;this.debugService=s;this.hoverService=a;this.labelService=l}static ID="databreakpoints";get templateId(){return _b.ID}renderTemplate(t){let e=Object.create(null);e.breakpoint=U(t,Bi(".breakpoint")),e.toDispose=[],e.icon=Bi(".icon"),e.checkbox=kb(e.toDispose),e.toDispose.push(Ut(e.checkbox,"change",n=>{this.debugService.enableOrDisableBreakpoints(!e.context.enabled,e.context)})),U(e.breakpoint,e.icon),U(e.breakpoint,e.checkbox),e.name=U(e.breakpoint,Bi("span.name")),e.accessType=U(e.breakpoint,Bi("span.access-type")),e.condition=U(e.breakpoint,Bi("span.condition")),e.actionBar=new Fi(e.breakpoint),e.toDispose.push(e.actionBar);let i=U(e.breakpoint,Bi(".badge-container"));return e.badge=U(i,Bi("span.line-number.monaco-count-badge")),e}renderElement(t,e,i){i.context=t,i.name.textContent=t.description;let{icon:n,message:o}=Dh(this.debugService.state,this.debugService.getModel().areBreakpointsActivated(),t,this.labelService,this.debugService.getModel());i.icon.className=de.asClassName(n),i.toDispose.push(this.hoverService.setupManagedHover(gt("mouse"),i.icon,o||"")),i.checkbox.checked=t.enabled,i.toDispose.push(this.hoverService.setupManagedHover(gt("mouse"),i.breakpoint,o||"")),t.modeLabel?(i.badge.textContent=t.modeLabel,i.badge.style.display="block"):i.badge.style.display="none";let s=this.debugService.getViewModel().focusedSession;if(i.breakpoint.classList.toggle("disabled",s&&!s.capabilities.supportsDataBreakpoints||!this.debugService.getModel().areBreakpointsActivated()),s&&!s.capabilities.supportsDataBreakpoints&&i.toDispose.push(this.hoverService.setupManagedHover(gt("mouse"),i.breakpoint,u("dataBreakpointsNotSupported","Data breakpoints are not supported by this debug type"))),t.accessType){let l=t.accessType==="read"?u("read","Read"):t.accessType==="write"?u("write","Write"):u("access","Access");i.accessType.textContent=l}else i.accessType.textContent="";t.condition&&t.hitCondition?i.condition.textContent=u("expressionAndHitCount","Condition: {0} | Hit Count: {1}",t.condition,t.hitCondition):i.condition.textContent=t.condition||t.hitCondition||"";let a=[];this.breakpointSupportsCondition.set(!s||!!s.capabilities.supportsConditionalBreakpoints),this.breakpointHasMultipleModes.set(this.debugService.getModel().getBreakpointModes("data").length>1),this.breakpointItemType.set("dataBreakpoint"),this.breakpointIsDataBytes.set(t.src.type===1),Vo(this.menu,{arg:t,shouldForwardArgs:!0},{primary:a,secondary:[]},"inline"),i.actionBar.clear(),i.actionBar.push(a,{icon:!0,label:!1}),tR.set(t.getId(),i.actionBar.domNode),this.breakpointIsDataBytes.reset()}disposeTemplate(t){_e(t.toDispose)}};_b=E([b(5,we),b(6,Nt),b(7,hi)],_b);var Db=class{constructor(t,e,i){this.debugService=t;this.hoverService=e;this.labelService=i}static ID="instructionBreakpoints";get templateId(){return Db.ID}renderTemplate(t){let e=Object.create(null);e.toDispose=[],e.breakpoint=U(t,Bi(".breakpoint")),e.icon=Bi(".icon"),e.checkbox=kb(e.toDispose),e.toDispose.push(Ut(e.checkbox,"change",n=>{this.debugService.enableOrDisableBreakpoints(!e.context.enabled,e.context)})),U(e.breakpoint,e.icon),U(e.breakpoint,e.checkbox),e.name=U(e.breakpoint,Bi("span.name")),e.address=U(e.breakpoint,Bi("span.file-path")),e.actionBar=new Fi(e.breakpoint),e.toDispose.push(e.actionBar);let i=U(e.breakpoint,Bi(".badge-container"));return e.badge=U(i,Bi("span.line-number.monaco-count-badge")),e}renderElement(t,e,i){i.context=t,i.breakpoint.classList.toggle("disabled",!this.debugService.getModel().areBreakpointsActivated()),i.name.textContent="0x"+t.address.toString(16),i.toDispose.push(this.hoverService.setupManagedHover(gt("mouse"),i.name,"Decimal address: breakpoint.address.toString()")),i.checkbox.checked=t.enabled;let{message:n,icon:o}=Dh(this.debugService.state,this.debugService.getModel().areBreakpointsActivated(),t,this.labelService,this.debugService.getModel());i.icon.className=de.asClassName(o),i.toDispose.push(this.hoverService.setupManagedHover(gt("mouse"),i.breakpoint,t.message||n||"")),(this.debugService.state===3||this.debugService.state===2)&&!t.verified&&i.breakpoint.classList.add("disabled"),t.modeLabel?(i.badge.textContent=t.modeLabel,i.badge.style.display="block"):i.badge.style.display="none"}disposeTemplate(t){_e(t.toDispose)}};Db=E([b(0,we),b(1,Nt),b(2,hi)],Db);var TV=class r{constructor(t,e,i,n,o){this.view=t;this.debugService=e;this.contextViewService=i;this.hoverService=n;this.labelService=o}static ID="functionbreakpointinput";get templateId(){return r.ID}renderTemplate(t){let e=Object.create(null),i=[],n=U(t,Bi(".breakpoint"));e.icon=Bi(".icon"),e.checkbox=kb(i),U(n,e.icon),U(n,e.checkbox),this.view.breakpointInputFocused.set(!0);let o=U(n,Bi(".inputBoxContainer")),s=new rh(o,this.contextViewService,{inputBoxStyles:Zm}),a=l=>{e.updating=!0;try{this.view.breakpointInputFocused.set(!1);let d=e.breakpoint.getId();l?(e.type==="name"&&this.debugService.updateFunctionBreakpoint(d,{name:s.value}),e.type==="condition"&&this.debugService.updateFunctionBreakpoint(d,{condition:s.value}),e.type==="hitCount"&&this.debugService.updateFunctionBreakpoint(d,{hitCondition:s.value})):e.type==="name"&&!e.breakpoint.name?this.debugService.removeFunctionBreakpoints(d):this.view.renderInputBox(void 0)}finally{e.updating=!1}};return i.push(Ut(s.inputElement,"keydown",l=>{let d=l.equals(9),c=l.equals(3);(d||c)&&(l.preventDefault(),l.stopPropagation(),a(c))})),i.push(F(s.inputElement,"blur",()=>{e.updating||a(!!s.value)})),e.inputBox=s,e.toDispose=i,e}renderElement(t,e,i){i.breakpoint=t,i.type=this.view.inputBoxData?.type||"name";let{icon:n,message:o}=Dh(this.debugService.state,this.debugService.getModel().areBreakpointsActivated(),t,this.labelService,this.debugService.getModel());i.icon.className=de.asClassName(n),i.toDispose.push(this.hoverService.setupManagedHover(gt("mouse"),i.icon,o||"")),i.checkbox.checked=t.enabled,i.checkbox.disabled=!0,i.inputBox.value=t.name||"";let s=u("functionBreakpointPlaceholder","Function to break on"),a=u("functionBreakPointInputAriaLabel","Type function breakpoint.");i.type==="condition"?(i.inputBox.value=t.condition||"",s=u("functionBreakpointExpressionPlaceholder","Break when expression evaluates to true"),a=u("functionBreakPointExpresionAriaLabel","Type expression. Function breakpoint will break when expression evaluates to true")):i.type==="hitCount"&&(i.inputBox.value=t.hitCondition||"",s=u("functionBreakpointHitCountPlaceholder","Break when hit count is met"),a=u("functionBreakPointHitCountAriaLabel","Type hit count. Function breakpoint will break when hit count is met.")),i.inputBox.setAriaLabel(a),i.inputBox.setPlaceHolder(s),setTimeout(()=>{i.inputBox.focus(),i.inputBox.select()},0)}disposeTemplate(t){_e(t.toDispose)}},_V=class r{constructor(t,e,i,n,o){this.view=t;this.debugService=e;this.contextViewService=i;this.hoverService=n;this.labelService=o}static ID="databreakpointinput";get templateId(){return r.ID}renderTemplate(t){let e=Object.create(null),i=[],n=U(t,Bi(".breakpoint"));e.icon=Bi(".icon"),e.checkbox=kb(i),U(n,e.icon),U(n,e.checkbox),this.view.breakpointInputFocused.set(!0);let o=U(n,Bi(".inputBoxContainer")),s=new rh(o,this.contextViewService,{inputBoxStyles:Zm}),a=l=>{e.updating=!0;try{this.view.breakpointInputFocused.set(!1);let d=e.breakpoint.getId();l?(e.type==="condition"&&this.debugService.updateDataBreakpoint(d,{condition:s.value}),e.type==="hitCount"&&this.debugService.updateDataBreakpoint(d,{hitCondition:s.value})):this.view.renderInputBox(void 0)}finally{e.updating=!1}};return i.push(Ut(s.inputElement,"keydown",l=>{let d=l.equals(9),c=l.equals(3);(d||c)&&(l.preventDefault(),l.stopPropagation(),a(c))})),i.push(F(s.inputElement,"blur",()=>{e.updating||a(!!s.value)})),e.inputBox=s,e.toDispose=i,e}renderElement(t,e,i){i.breakpoint=t,i.type=this.view.inputBoxData?.type||"condition";let{icon:n,message:o}=Dh(this.debugService.state,this.debugService.getModel().areBreakpointsActivated(),t,this.labelService,this.debugService.getModel());i.icon.className=de.asClassName(n),i.toDispose.push(this.hoverService.setupManagedHover(gt("mouse"),i.icon,o??"")),i.checkbox.checked=t.enabled,i.checkbox.disabled=!0,i.inputBox.value="";let s="",a="";i.type==="condition"?(i.inputBox.value=t.condition||"",s=u("dataBreakpointExpressionPlaceholder","Break when expression evaluates to true"),a=u("dataBreakPointExpresionAriaLabel","Type expression. Data breakpoint will break when expression evaluates to true")):i.type==="hitCount"&&(i.inputBox.value=t.hitCondition||"",s=u("dataBreakpointHitCountPlaceholder","Break when hit count is met"),a=u("dataBreakPointHitCountAriaLabel","Type hit count. Data breakpoint will break when hit count is met.")),i.inputBox.setAriaLabel(a),i.inputBox.setPlaceHolder(s),setTimeout(()=>{i.inputBox.focus(),i.inputBox.select()},0)}disposeTemplate(t){_e(t.toDispose)}},DV=class r{constructor(t,e,i){this.view=t;this.debugService=e;this.contextViewService=i}static ID="exceptionbreakpointinput";get templateId(){return r.ID}renderTemplate(t){let e=Object.create(null),i=[],n=U(t,Bi(".breakpoint"));n.classList.add("exception"),e.checkbox=kb(i),U(n,e.checkbox),this.view.breakpointInputFocused.set(!0);let o=U(n,Bi(".inputBoxContainer")),s=new rh(o,this.contextViewService,{ariaLabel:u("exceptionBreakpointAriaLabel","Type exception breakpoint condition"),inputBoxStyles:Zm}),a=l=>{this.view.breakpointInputFocused.set(!1);let d=e.breakpoint.condition;l&&(d=s.value!==""?s.value:void 0),this.debugService.setExceptionBreakpointCondition(e.breakpoint,d)};return i.push(Ut(s.inputElement,"keydown",l=>{let d=l.equals(9),c=l.equals(3);(d||c)&&(l.preventDefault(),l.stopPropagation(),a(c))})),i.push(F(s.inputElement,"blur",()=>{setTimeout(()=>{a(!0)})})),e.inputBox=s,e.toDispose=i,e}renderElement(t,e,i){let n=t.conditionDescription||u("exceptionBreakpointPlaceholder","Break when expression evaluates to true");i.inputBox.setPlaceHolder(n),i.breakpoint=t,i.checkbox.checked=t.enabled,i.checkbox.disabled=!0,i.inputBox.value=t.condition||"",setTimeout(()=>{i.inputBox.focus(),i.inputBox.select()},0)}disposeTemplate(t){_e(t.toDispose)}},Iq=class{constructor(t,e){this.debugService=t;this.labelService=e}getWidgetAriaLabel(){return u("breakpoints","Breakpoints")}getRole(){return"checkbox"}isChecked(t){return t.enabled}getAriaLabel(t){if(t instanceof kc)return t.toString();let{message:e}=Dh(this.debugService.state,this.debugService.getModel().areBreakpointsActivated(),t,this.labelService,this.debugService.getModel()),i=t.toString();return e?`${i}, ${e}`:i}};function xE(r,t,e,i,n,o){if(r.uri.scheme===Gs&&n.state===0)return Promise.resolve(void 0);let s=r.endLineNumber?{startLineNumber:r.lineNumber,endLineNumber:r.endLineNumber,startColumn:r.column||1,endColumn:r.endColumn||1073741824}:{startLineNumber:r.lineNumber,startColumn:r.column||1,endLineNumber:r.lineNumber,endColumn:r.column||1073741824};return o.openEditor({resource:r.uri,options:{preserveFocus:e,selection:s,revealIfOpened:!0,selectionRevealType:1,pinned:i}},t?Vl:Zp)}function Dh(r,t,e,i,n){let o=r===3||r===2,s=e instanceof xs?M6:e instanceof ns?R6:e.logMessage?xB:_c;if(!e.enabled||!t)return{icon:s.disabled,message:e.logMessage?u("disabledLogpoint","Disabled Logpoint"):u("disabledBreakpoint","Disabled Breakpoint")};let a=c=>"message"in e&&e.message?c.concat(", "+e.message):c;if(o&&e instanceof ir&&e.pending)return{icon:_c.pending};if(o&&!e.verified)return{icon:s.unverified,message:"message"in e&&e.message?e.message:e.logMessage?u("unverifiedLogpoint","Unverified Logpoint"):u("unverifiedBreakpoint","Unverified Breakpoint"),showAdapterUnverifiedMessage:!0};if(e instanceof xs)return e.supported?{icon:s.regular,message:e.message||u("dataBreakpoint","Data Breakpoint")}:{icon:s.unverified,message:u("dataBreakpointUnsupported","Data breakpoints not supported by this debug type")};if(e instanceof ns){if(!e.supported)return{icon:s.unverified,message:u("functionBreakpointUnsupported","Function breakpoints not supported by this debug type")};let c=[];return c.push(e.message||u("functionBreakpoint","Function Breakpoint")),e.condition&&c.push(u("expression","Condition: {0}",e.condition)),e.hitCondition&&c.push(u("hitCount","Hit Count: {0}",e.hitCondition)),{icon:s.regular,message:a(c.join(`
`))}}if(e instanceof os){if(!e.supported)return{icon:s.unverified,message:u("instructionBreakpointUnsupported","Instruction breakpoints not supported by this debug type")};let c=[];return e.message?c.push(e.message):e.instructionReference?c.push(u("instructionBreakpointAtAddress","Instruction breakpoint at address {0}",e.instructionReference)):c.push(u("instructionBreakpoint","Instruction breakpoint")),e.hitCondition&&c.push(u("hitCount","Hit Count: {0}",e.hitCondition)),{icon:s.regular,message:a(c.join(`
`))}}let l;if(e instanceof ir&&e.triggeredBy&&(l=n.getBreakpoints().find(c=>c.getId()===e.triggeredBy)),e.logMessage||e.condition||e.hitCondition||l){let c=[],p=e.logMessage?xB.regular:P6.regular;return e.supported||(p=TB,c.push(u("breakpointUnsupported","Breakpoints of this type are not supported by the debugger"))),e.logMessage&&c.push(u("logMessage","Log Message: {0}",e.logMessage)),e.condition&&c.push(u("expression","Condition: {0}",e.condition)),e.hitCondition&&c.push(u("hitCount","Hit Count: {0}",e.hitCondition)),l&&c.push(u("triggeredBy","Hit after breakpoint: {0}",`${i.getUriLabel(l.uri,{relative:!0})}: ${l.lineNumber}`)),{icon:p,message:a(c.join(`
`))}}let d="message"in e&&e.message?e.message:e instanceof ir&&i?i.getUriLabel(e.uri):u("breakpoint","Breakpoint");return{icon:s.regular,message:d}}he(class extends Me{constructor(){super({id:"workbench.debug.viewlet.action.addFunctionBreakpointAction",title:{...ie("addFunctionBreakpoint","Add Function Breakpoint"),mnemonicTitle:u({key:"miFunctionBreakpoint",comment:["&& denotes a mnemonic"]},"&&Function Breakpoint...")},f1:!0,icon:Vde,menu:[{id:V.ViewTitle,group:"navigation",order:10,when:P.equals("view",Aa)},{id:V.MenubarNewBreakpointMenu,group:"1_breakpoints",order:3,when:oi}]})}async run(r){let t=r.get(we);await r.get(Mi).openView(Aa),t.addFunctionBreakpoint()}});var kV=class extends Me{async run(t,e){let i=t.get(we),n=i.getViewModel().focusedSession;if(!n)return;let o;e&&e.src.type===1&&(o=`${e.src.address} + ${e.src.bytes}`);let s=t.get(ki),a=t.get(mi),l=await this.getRange(s,o);if(!l)return;let d;try{d=await n.dataBytesBreakpointInfo(l.address,l.bytes)}catch(h){a.error(u("dataBreakpointError","Failed to set data breakpoint at {0}: {1}",l.address,h.message))}if(!d?.dataId)return;let c="write";if(d.accessTypes&&d.accessTypes?.length>1){let h=d.accessTypes.map(f=>({label:f})),m=await s.pick(h,{placeHolder:u("dataBreakpointAccessType","Select the access type to monitor")});if(!m)return;c=m.label}let p={type:1,...l};e&&await i.removeDataBreakpoints(e.getId()),await i.addDataBreakpoint({description:d.description,src:p,canPersist:!0,accessTypes:d.accessTypes,accessType:c,initialSessionData:{session:n,dataId:d.dataId}})}getRange(t,e){return new Promise(i=>{let n=new B,o=n.add(t.createInputBox());o.prompt=u("dataBreakpointMemoryRangePrompt","Enter a memory range in which to break"),o.placeholder=u("dataBreakpointMemoryRangePlaceholder","Absolute range (0x1234 - 0x1300) or range of bytes after an address (0x1234 + 0xff)"),e&&(o.value=e,o.valueSelection=[0,e.length]),n.add(o.onDidChangeValue(s=>{let a=this.parseAddress(s,!1);o.validationMessage=a?.error})),n.add(o.onDidAccept(()=>{let s=this.parseAddress(o.value,!0);"error"in s?o.validationMessage=s.error:i(s),o.dispose()})),n.add(o.onDidHide(()=>{i(void 0),n.dispose()})),o.ignoreFocusOut=!0,o.show()})}parseAddress(t,e){let i=/^(\S+)\s*(?:([+-])\s*(\S+))?/.exec(t);if(!i)return{error:u("dataBreakpointAddrFormat",'Address should be a range of numbers the form "[Start] - [End]" or "[Start] + [Bytes]"')};let n=p=>e?/^0x[0-9a-f]*|[0-9]*$/i.test(p):/^0x[0-9a-f]+|[0-9]+$/i.test(p),[,o,s="+",a="1"]=i;for(let p of[o,a])if(!n(p))return{error:u("dataBreakpointAddrStartEnd",'Number must be a decimal integer or hex value starting with "0x", got {0}',p)};if(!e)return;let l=BigInt(o),d=BigInt(a),c=`0x${l.toString(16)}`;return s==="-"?{address:c,bytes:Number(l-d)}:{address:c,bytes:Number(d)}}};he(class extends kV{constructor(){super({id:"workbench.debug.viewlet.action.addDataBreakpointOnAddress",title:{...ie("addDataBreakpointOnAddress","Add Data Breakpoint at Address"),mnemonicTitle:u({key:"miDataBreakpoint",comment:["&& denotes a mnemonic"]},"&&Data Breakpoint...")},f1:!0,icon:Wde,menu:[{id:V.ViewTitle,group:"navigation",order:11,when:P.and(IE,P.equals("view",Aa))},{id:V.MenubarNewBreakpointMenu,group:"1_breakpoints",order:4,when:IE}]})}});he(class extends kV{constructor(){super({id:"workbench.debug.viewlet.action.editDataBreakpointOnAddress",title:ie("editDataBreakpointOnAddress","Edit Address..."),menu:[{id:V.DebugBreakpointsContext,when:P.and(IE,mq),group:"navigation",order:15}]})}});he(class extends Me{constructor(){super({id:"workbench.debug.viewlet.action.toggleBreakpointsActivatedAction",title:ie("activateBreakpoints","Toggle Activate Breakpoints"),f1:!0,icon:Ude,menu:{id:V.ViewTitle,group:"navigation",order:20,when:P.equals("view",Aa)}})}run(r){let t=r.get(we);t.setBreakpointsActivated(!t.getModel().areBreakpointsActivated())}});he(class extends Me{constructor(){super({id:"workbench.debug.viewlet.action.removeBreakpoint",title:u("removeBreakpoint","Remove Breakpoint"),icon:N.removeClose,menu:[{id:V.DebugBreakpointsContext,group:"3_modification",order:10,when:pl.notEqualsTo("exceptionBreakpoint")},{id:V.DebugBreakpointsContext,group:"inline",order:20,when:pl.notEqualsTo("exceptionBreakpoint")}]})}async run(r,t){let e=r.get(we);t instanceof ir?await e.removeBreakpoints(t.getId()):t instanceof ns?await e.removeFunctionBreakpoints(t.getId()):t instanceof xs?await e.removeDataBreakpoints(t.getId()):t instanceof os&&await e.removeInstructionBreakpoints(t.instructionReference,t.offset)}});he(class extends Me{constructor(){super({id:"workbench.debug.viewlet.action.removeAllBreakpoints",title:{...ie("removeAllBreakpoints","Remove All Breakpoints"),mnemonicTitle:u({key:"miRemoveAllBreakpoints",comment:["&& denotes a mnemonic"]},"Remove &&All Breakpoints")},f1:!0,icon:Hde,menu:[{id:V.ViewTitle,group:"navigation",order:30,when:P.equals("view",Aa)},{id:V.DebugBreakpointsContext,group:"3_modification",order:20,when:P.and(lg,pl.notEqualsTo("exceptionBreakpoint"))},{id:V.MenubarDebugMenu,group:"5_breakpoints",order:3,when:oi}]})}run(r){let t=r.get(we);t.removeBreakpoints(),t.removeFunctionBreakpoints(),t.removeDataBreakpoints(),t.removeInstructionBreakpoints()}});he(class extends Me{constructor(){super({id:"workbench.debug.viewlet.action.enableAllBreakpoints",title:{...ie("enableAllBreakpoints","Enable All Breakpoints"),mnemonicTitle:u({key:"miEnableAllBreakpoints",comment:["&& denotes a mnemonic"]},"&&Enable All Breakpoints")},f1:!0,precondition:oi,menu:[{id:V.DebugBreakpointsContext,group:"z_commands",order:10,when:P.and(lg,pl.notEqualsTo("exceptionBreakpoint"))},{id:V.MenubarDebugMenu,group:"5_breakpoints",order:1,when:oi}]})}async run(r){await r.get(we).enableOrDisableBreakpoints(!0)}});he(class extends Me{constructor(){super({id:"workbench.debug.viewlet.action.disableAllBreakpoints",title:{...ie("disableAllBreakpoints","Disable All Breakpoints"),mnemonicTitle:u({key:"miDisableAllBreakpoints",comment:["&& denotes a mnemonic"]},"Disable A&&ll Breakpoints")},f1:!0,precondition:oi,menu:[{id:V.DebugBreakpointsContext,group:"z_commands",order:20,when:P.and(lg,pl.notEqualsTo("exceptionBreakpoint"))},{id:V.MenubarDebugMenu,group:"5_breakpoints",order:2,when:oi}]})}async run(r){await r.get(we).enableOrDisableBreakpoints(!1)}});he(class extends Me{constructor(){super({id:"workbench.debug.viewlet.action.reapplyBreakpointsAction",title:ie("reapplyAllBreakpoints","Reapply All Breakpoints"),f1:!0,precondition:ui,menu:[{id:V.DebugBreakpointsContext,group:"z_commands",order:30,when:P.and(lg,pl.notEqualsTo("exceptionBreakpoint"))}]})}async run(r){await r.get(we).setBreakpointsActivated(!0)}});he(class extends tr{constructor(){super({id:"debug.editBreakpoint",viewId:Aa,title:u("editCondition","Edit Condition..."),icon:N.edit,precondition:uV,menu:[{id:V.DebugBreakpointsContext,when:pl.notEqualsTo("functionBreakpoint"),group:"navigation",order:10},{id:V.DebugBreakpointsContext,group:"inline",order:10}]})}async runInView(r,t,e){let i=r.get(we),n=r.get($e);if(e instanceof ir){let o=await xE(e,!1,!1,!0,i,n);if(o){let s=o.getControl();no(s)&&s.getContribution(Gd)?.showBreakpointWidget(e.lineNumber,e.column)}}else if(e instanceof ns){let o=r.get(vt),s=[new et("breakpoint.editCondition",u("editCondition","Edit Condition..."),void 0,!0,async()=>t.renderInputBox({breakpoint:e,type:"condition"})),new et("breakpoint.editCondition",u("editHitCount","Edit Hit Count..."),void 0,!0,async()=>t.renderInputBox({breakpoint:e,type:"hitCount"}))],a=tR.get(e.getId());a&&o.showContextMenu({getActions:()=>s,getAnchor:()=>a,onHide:()=>_e(s)})}else t.renderInputBox({breakpoint:e,type:"condition"})}});he(class extends tr{constructor(){super({id:"debug.editFunctionBreakpoint",viewId:Aa,title:u("editBreakpoint","Edit Function Condition..."),menu:[{id:V.DebugBreakpointsContext,group:"navigation",order:10,when:pl.isEqualTo("functionBreakpoint")}]})}runInView(r,t,e){t.renderInputBox({breakpoint:e,type:"name"})}});he(class extends tr{constructor(){super({id:"debug.editFunctionBreakpointHitCount",viewId:Aa,title:u("editHitCount","Edit Hit Count..."),precondition:uV,menu:[{id:V.DebugBreakpointsContext,group:"navigation",order:20,when:P.or(pl.isEqualTo("functionBreakpoint"),pl.isEqualTo("dataBreakpoint"))}]})}runInView(r,t,e){t.renderInputBox({breakpoint:e,type:"hitCount"})}});he(class extends tr{constructor(){super({id:"debug.editBreakpointMode",viewId:Aa,title:u("editMode","Edit Mode..."),menu:[{id:V.DebugBreakpointsContext,group:"navigation",order:20,when:P.and(gq,P.or(pl.isEqualTo("breakpoint"),pl.isEqualTo("exceptionBreakpoint"),pl.isEqualTo("instructionBreakpoint")))}]})}async runInView(r,t,e){let i=e instanceof ir?"source":e instanceof os?"instruction":"exception",n=r.get(we),o=n.getModel().getBreakpointModes(i),s=await r.get(ki).pick(o.map(a=>({label:a.label,description:a.description,mode:a.mode})),{placeHolder:u("selectBreakpointMode","Select Breakpoint Mode")});if(s)if(i==="source"){let a=new Map;a.set(e.getId(),{mode:s.mode,modeLabel:s.label}),n.updateBreakpoints(e.originalUri,a,!1)}else e instanceof os?(n.removeInstructionBreakpoints(e.instructionReference,e.offset),n.addInstructionBreakpoint({...e.toJSON(),mode:s.mode,modeLabel:s.label})):e instanceof kc&&(e.mode=s.mode,e.modeLabel=s.label,n.setExceptionBreakpointCondition(e,e.condition))}});var Sce=q("markerDecorationsService");var TE=class{static ID="editor.contrib.markerDecorations";constructor(t,e){}dispose(){}};TE=E([b(1,Sce)],TE);gr(TE.ID,TE,0);var cg;(k=>{let r={total:0,min:Number.MAX_VALUE,max:0},t={...r},e={...r},i={...r},n=0,o;(G=>(G[G.Before=0]="Before",G[G.InProgress=1]="InProgress",G[G.Finished=2]="Finished"))(o||={});let s={keydown:0,input:0,render:0};function a(){I(),performance.mark("inputlatency/start"),performance.mark("keydown/start"),s.keydown=1,queueMicrotask(l)}k.onKeyDown=a;function l(){s.keydown===1&&(performance.mark("keydown/end"),s.keydown=2)}function d(){performance.mark("input/start"),s.input=1,v()}k.onBeforeInput=d;function c(){s.input===0&&d(),queueMicrotask(p)}k.onInput=c;function p(){s.input===1&&(performance.mark("input/end"),s.input=2)}function h(){I()}k.onKeyUp=h;function m(){I()}k.onSelectionChange=m;function f(){s.keydown===2&&s.input===2&&s.render===0&&(performance.mark("render/start"),s.render=1,queueMicrotask(g),v())}k.onRenderStart=f;function g(){s.render===1&&(performance.mark("render/end"),s.render=2)}function v(){setTimeout(I)}function I(){s.keydown===2&&s.input===2&&s.render===2&&(performance.mark("inputlatency/end"),performance.measure("keydown","keydown/start","keydown/end"),performance.measure("input","input/start","input/end"),performance.measure("render","render/start","render/end"),performance.measure("inputlatency","inputlatency/start","inputlatency/end"),y("keydown",r),y("input",t),y("render",e),y("inputlatency",i),n++,w())}function y(M,O){let K=performance.getEntriesByName(M)[0].duration;O.total+=K,O.min=Math.min(O.min,K),O.max=Math.max(O.max,K)}function w(){performance.clearMarks("keydown/start"),performance.clearMarks("keydown/end"),performance.clearMarks("input/start"),performance.clearMarks("input/end"),performance.clearMarks("render/start"),performance.clearMarks("render/end"),performance.clearMarks("inputlatency/start"),performance.clearMarks("inputlatency/end"),performance.clearMeasures("keydown"),performance.clearMeasures("input"),performance.clearMeasures("render"),performance.clearMeasures("inputlatency"),s.keydown=0,s.input=0,s.render=0}function C(){if(n===0)return;let M={keydown:S(r),input:S(t),render:S(e),total:S(i),sampleCount:n};return D(r),D(t),D(e),D(i),n=0,M}k.getAndClearMeasurements=C;function S(M){return{average:M.total/n,max:M.max,min:M.min}}function D(M){M.total=0,M.min=Number.MAX_VALUE,M.max=0}})(cg||={});var Lb=class{constructor(t,e){this.x=t;this.y=e}_pageCoordinatesBrand=void 0;toClientCoordinates(t){return new iR(this.x-t.scrollX,this.y-t.scrollY)}},iR=class{constructor(t,e){this.clientX=t;this.clientY=e}_clientCoordinatesBrand=void 0;toPageCoordinates(t){return new Lb(this.clientX+t.scrollX,this.clientY+t.scrollY)}},yq=class{constructor(t,e,i,n){this.x=t;this.y=e;this.width=i;this.height=n}_editorPagePositionBrand=void 0},Sq=class{constructor(t,e){this.x=t;this.y=e}_positionRelativeToEditorBrand=void 0};function MV(r){let t=Oi(r);return new yq(t.left,t.top,t.width,t.height)}function AV(r,t,e){let i=t.width/r.offsetWidth,n=t.height/r.offsetHeight,o=(e.x-t.x)/i,s=(e.y-t.y)/n;return new Sq(o,s)}var Rc=class extends _i{_editorMouseEventBrand=void 0;isFromPointerCapture;pos;editorPos;relativePos;constructor(t,e,i){super(ue(i),t),this.isFromPointerCapture=e,this.pos=new Lb(this.posx,this.posy),this.editorPos=MV(i),this.relativePos=AV(i,this.editorPos,this.pos)}},LV=class{_editorViewDomNode;constructor(t){this._editorViewDomNode=t}_create(t){return new Rc(t,!1,this._editorViewDomNode)}onContextMenu(t,e){return F(t,"contextmenu",i=>{e(this._create(i))})}onMouseUp(t,e){return F(t,"mouseup",i=>{e(this._create(i))})}onMouseDown(t,e){return F(t,Q.MOUSE_DOWN,i=>{e(this._create(i))})}onPointerDown(t,e){return F(t,Q.POINTER_DOWN,i=>{e(this._create(i),i.pointerId)})}onMouseLeave(t,e){return F(t,Q.MOUSE_LEAVE,i=>{e(this._create(i))})}onMouseMove(t,e){return F(t,"mousemove",i=>e(this._create(i)))}},RV=class{_editorViewDomNode;constructor(t){this._editorViewDomNode=t}_create(t){return new Rc(t,!1,this._editorViewDomNode)}onPointerUp(t,e){return F(t,"pointerup",i=>{e(this._create(i))})}onPointerDown(t,e){return F(t,Q.POINTER_DOWN,i=>{e(this._create(i),i.pointerId)})}onPointerLeave(t,e){return F(t,Q.POINTER_LEAVE,i=>{e(this._create(i))})}onPointerMove(t,e){return F(t,"pointermove",i=>e(this._create(i)))}},PV=class extends R{_editorViewDomNode;_globalPointerMoveMonitor;_keydownListener;constructor(t){super(),this._editorViewDomNode=t,this._globalPointerMoveMonitor=this._register(new Hl),this._keydownListener=null}startMonitoring(t,e,i,n,o){this._keydownListener=Ut(t.ownerDocument,"keydown",s=>{s.toKeyCodeChord().isModifierKey()||this._globalPointerMoveMonitor.stopMonitoring(!0,s.browserEvent)},!0),this._globalPointerMoveMonitor.startMonitoring(t,e,i,s=>{n(new Rc(s,!0,this._editorViewDomNode))},s=>{this._keydownListener.dispose(),o(s)})}stopMonitoring(){this._globalPointerMoveMonitor.stopMonitoring(!0)}},_E=class r{constructor(t){this._editor=t}static _idPool=0;_instanceId=++r._idPool;_counter=0;_rules=new Map;_garbageCollectionScheduler=new Ye(()=>this.garbageCollect(),1e3);createClassNameRef(t){let e=this.getOrCreateRule(t);return e.increaseRefCount(),{className:e.className,dispose:()=>{e.decreaseRefCount(),this._garbageCollectionScheduler.schedule()}}}getOrCreateRule(t){let e=this.computeUniqueKey(t),i=this._rules.get(e);if(!i){let n=this._counter++;i=new Cq(e,`dyn-rule-${this._instanceId}-${n}`,sD(this._editor.getContainerDomNode())?this._editor.getContainerDomNode():void 0,t),this._rules.set(e,i)}return i}computeUniqueKey(t){return JSON.stringify(t)}garbageCollect(){for(let t of this._rules.values())t.hasReferences()||(this._rules.delete(t.key),t.dispose())}},Cq=class{constructor(t,e,i,n){this.key=t;this.className=e;this.properties=n;this._styleElementDisposables=new B,this._styleElement=Go(i,void 0,this._styleElementDisposables),this._styleElement.textContent=this.getCssText(this.className,this.properties)}_referenceCount=0;_styleElement;_styleElementDisposables;getCssText(t,e){let i=`.${t} {`;for(let n in e){let o=e[n],s;typeof o=="object"?s=Se(o.id):s=o;let a=fEe(n);i+=`
	${a}: ${s};`}return i+=`
}`,i}dispose(){this._styleElementDisposables.dispose(),this._styleElement=void 0}increaseRefCount(){this._referenceCount++}decreaseRefCount(){this._referenceCount--}hasReferences(){return this._referenceCount>0}};function fEe(r){return r.replace(/(^[A-Z])/,([t])=>t.toLowerCase()).replace(/([A-Z])/g,([t])=>`-${t.toLowerCase()}`)}var OV=class{selections;startLineNumber;endLineNumber;relativeVerticalOffset;visibleRange;bigNumbersDelta;whitespaceViewportData;_model;lineHeight;constructor(t,e,i,n){this.selections=t,this.startLineNumber=e.startLineNumber|0,this.endLineNumber=e.endLineNumber|0,this.relativeVerticalOffset=e.relativeVerticalOffset,this.bigNumbersDelta=e.bigNumbersDelta|0,this.lineHeight=e.lineHeight|0,this.whitespaceViewportData=i,this._model=n,this.visibleRange=new L(e.startLineNumber,this._model.getLineMinColumn(e.startLineNumber),e.endLineNumber,this._model.getLineMaxColumn(e.endLineNumber))}getViewLineRenderingData(t){return this._model.getViewportViewLineRenderingData(this.visibleRange,t)}getDecorationsInViewport(){return this._model.getDecorationsInViewport(this.visibleRange)}};var wq=class{_restrictedRenderingContextBrand=void 0;viewportData;scrollWidth;scrollHeight;visibleRange;bigNumbersDelta;scrollTop;scrollLeft;viewportWidth;viewportHeight;_viewLayout;constructor(t,e){this._viewLayout=t,this.viewportData=e,this.scrollWidth=this._viewLayout.getScrollWidth(),this.scrollHeight=this._viewLayout.getScrollHeight(),this.visibleRange=this.viewportData.visibleRange,this.bigNumbersDelta=this.viewportData.bigNumbersDelta;let i=this._viewLayout.getCurrentViewport();this.scrollTop=i.top,this.scrollLeft=i.left,this.viewportWidth=i.width,this.viewportHeight=i.height}getScrolledTopFromAbsoluteTop(t){return t-this.scrollTop}getVerticalOffsetForLineNumber(t,e){return this._viewLayout.getVerticalOffsetForLineNumber(t,e)}getVerticalOffsetAfterLineNumber(t,e){return this._viewLayout.getVerticalOffsetAfterLineNumber(t,e)}getDecorationsInViewport(){return this.viewportData.getDecorationsInViewport()}},NV=class extends wq{_renderingContextBrand=void 0;_viewLines;constructor(t,e,i){super(t,e),this._viewLines=i}linesVisibleRangesForRange(t,e){return this._viewLines.linesVisibleRangesForRange(t,e)}visibleRangeForPosition(t){return this._viewLines.visibleRangeForPosition(t)}},FV=class{constructor(t,e,i,n){this.outsideRenderedLine=t;this.lineNumber=e;this.ranges=i;this.continuesOnNextLine=n}static firstLine(t){if(!t)return null;let e=null;for(let i of t)(!e||i.lineNumber<e.lineNumber)&&(e=i);return e}static lastLine(t){if(!t)return null;let e=null;for(let i of t)(!e||i.lineNumber>e.lineNumber)&&(e=i);return e}},DE=class r{_horizontalRangeBrand=void 0;left;width;static from(t){let e=new Array(t.length);for(let i=0,n=t.length;i<n;i++){let o=t[i];e[i]=new r(o.left,o.width)}return e}constructor(t,e){this.left=Math.round(t),this.width=Math.round(e)}toString(){return`[${this.left},${this.width}]`}},Au=class{_floatHorizontalRangeBrand=void 0;left;width;constructor(t,e){this.left=t,this.width=e}toString(){return`[${this.left},${this.width}]`}static compare(t,e){return t.left-e.left}},BV=class{outsideRenderedLine;left;originalLeft;constructor(t,e){this.outsideRenderedLine=t,this.originalLeft=e,this.left=Math.round(this.originalLeft)}},nR=class{constructor(t,e){this.outsideRenderedLine=t;this.ranges=e}};var VV=class{configuration;viewModel;viewLayout;theme;constructor(t,e,i){this.configuration=t,this.theme=new k0(e),this.viewModel=i,this.viewLayout=i.viewLayout}addEventHandler(t){this.viewModel.addViewEventHandler(t)}removeEventHandler(t){this.viewModel.removeViewEventHandler(t)}};var Dn=class extends bc{_context;constructor(t){super(),this._context=t,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}};var Pr=class{static write(t,e){t.setAttribute("data-mprt",String(e))}static read(t){let e=t.getAttribute("data-mprt");return e===null?0:parseInt(e,10)}static collect(t,e){let i=[],n=0;for(;t&&t!==t.ownerDocument.body&&t!==e;)t.nodeType===t.ELEMENT_NODE&&(i[n++]=this.read(t)),t=t.parentElement;let o=new Uint8Array(n);for(let s=0;s<n;s++)o[s]=i[n-s-1];return o}};function kh(r,t){let e=globalThis.MonacoEnvironment;if(e?.createTrustedTypesPolicy)try{return e.createTrustedTypesPolicy(r,t)}catch(i){Xe(i);return}try{return globalThis.trustedTypes?.createPolicy(r,t)}catch(i){Xe(i);return}}var oR=class{constructor(t){this._lineFactory=t;this._set(1,[])}_lines;_rendLineNumberStart;flush(){this._set(1,[])}_set(t,e){this._lines=e,this._rendLineNumberStart=t}_get(){return{rendLineNumberStart:this._rendLineNumberStart,lines:this._lines}}getStartLineNumber(){return this._rendLineNumberStart}getEndLineNumber(){return this._rendLineNumberStart+this._lines.length-1}getCount(){return this._lines.length}getLine(t){let e=t-this._rendLineNumberStart;if(e<0||e>=this._lines.length)throw new _t("Illegal value for lineNumber");return this._lines[e]}onLinesDeleted(t,e){if(this.getCount()===0)return null;let i=this.getStartLineNumber(),n=this.getEndLineNumber();if(e<i){let l=e-t+1;return this._rendLineNumberStart-=l,null}if(t>n)return null;let o=0,s=0;for(let l=i;l<=n;l++){let d=l-this._rendLineNumberStart;t<=l&&l<=e&&(s===0?(o=d,s=1):s++)}if(t<i){let l=0;e<i?l=e-t+1:l=i-t,this._rendLineNumberStart-=l}return this._lines.splice(o,s)}onLinesChanged(t,e){let i=t+e-1;if(this.getCount()===0)return!1;let n=this.getStartLineNumber(),o=this.getEndLineNumber(),s=!1;for(let a=t;a<=i;a++)a>=n&&a<=o&&(this._lines[a-this._rendLineNumberStart].onContentChanged(),s=!0);return s}onLinesInserted(t,e){if(this.getCount()===0)return null;let i=e-t+1,n=this.getStartLineNumber(),o=this.getEndLineNumber();if(t<=n)return this._rendLineNumberStart+=i,null;if(t>o)return null;if(i+t>o)return this._lines.splice(t-this._rendLineNumberStart,o-t+1);let s=[];for(let p=0;p<i;p++)s[p]=this._lineFactory.createLine();let a=t-this._rendLineNumberStart,l=this._lines.slice(0,a),d=this._lines.slice(a,this._lines.length-i),c=this._lines.slice(this._lines.length-i,this._lines.length);return this._lines=l.concat(s).concat(d),c}onTokensChanged(t){if(this.getCount()===0)return!1;let e=this.getStartLineNumber(),i=this.getEndLineNumber(),n=!1;for(let o=0,s=t.length;o<s;o++){let a=t[o];if(a.toLineNumber<e||a.fromLineNumber>i)continue;let l=Math.max(e,a.fromLineNumber),d=Math.min(i,a.toLineNumber);for(let c=l;c<=d;c++){let p=c-this._rendLineNumberStart;this._lines[p].onTokensChanged(),n=!0}}return n}},kE=class{constructor(t){this._lineFactory=t}domNode=this._createDomNode();_linesCollection=new oR(this._lineFactory);_createDomNode(){let t=Ot(document.createElement("div"));return t.setClassName("view-layer"),t.setPosition("absolute"),t.domNode.setAttribute("role","presentation"),t.domNode.setAttribute("aria-hidden","true"),t}onConfigurationChanged(t){return!!t.hasChanged(147)}onFlushed(t){return this._linesCollection.flush(),!0}onLinesChanged(t){return this._linesCollection.onLinesChanged(t.fromLineNumber,t.count)}onLinesDeleted(t){let e=this._linesCollection.onLinesDeleted(t.fromLineNumber,t.toLineNumber);if(e)for(let i=0,n=e.length;i<n;i++)e[i].getDomNode()?.remove();return!0}onLinesInserted(t){let e=this._linesCollection.onLinesInserted(t.fromLineNumber,t.toLineNumber);if(e)for(let i=0,n=e.length;i<n;i++)e[i].getDomNode()?.remove();return!0}onScrollChanged(t){return t.scrollTopChanged}onTokensChanged(t){return this._linesCollection.onTokensChanged(t.ranges)}onZonesChanged(t){return!0}getStartLineNumber(){return this._linesCollection.getStartLineNumber()}getEndLineNumber(){return this._linesCollection.getEndLineNumber()}getVisibleLine(t){return this._linesCollection.getLine(t)}renderLines(t){let e=this._linesCollection._get(),i=new Eq(this.domNode.domNode,this._lineFactory,t),n={rendLineNumberStart:e.rendLineNumberStart,lines:e.lines,linesLength:e.lines.length},o=i.render(n,t.startLineNumber,t.endLineNumber,t.relativeVerticalOffset);this._linesCollection._set(o.rendLineNumberStart,o.lines)}},Eq=class r{constructor(t,e,i){this._domNode=t;this._lineFactory=e;this._viewportData=i}static _ttPolicy=kh("editorViewLayer",{createHTML:t=>t});render(t,e,i,n){let o={rendLineNumberStart:t.rendLineNumberStart,lines:t.lines.slice(0),linesLength:t.linesLength};if(o.rendLineNumberStart+o.linesLength-1<e||i<o.rendLineNumberStart){o.rendLineNumberStart=e,o.linesLength=i-e+1,o.lines=[];for(let s=e;s<=i;s++)o.lines[s-e]=this._lineFactory.createLine();return this._finishRendering(o,!0,n),o}if(this._renderUntouchedLines(o,Math.max(e-o.rendLineNumberStart,0),Math.min(i-o.rendLineNumberStart,o.linesLength-1),n,e),o.rendLineNumberStart>e){let s=e,a=Math.min(i,o.rendLineNumberStart-1);s<=a&&(this._insertLinesBefore(o,s,a,n,e),o.linesLength+=a-s+1)}else if(o.rendLineNumberStart<e){let s=Math.min(o.linesLength,e-o.rendLineNumberStart);s>0&&(this._removeLinesBefore(o,s),o.linesLength-=s)}if(o.rendLineNumberStart=e,o.rendLineNumberStart+o.linesLength-1<i){let s=o.rendLineNumberStart+o.linesLength,a=i;s<=a&&(this._insertLinesAfter(o,s,a,n,e),o.linesLength+=a-s+1)}else if(o.rendLineNumberStart+o.linesLength-1>i){let s=Math.max(0,i-o.rendLineNumberStart+1),l=o.linesLength-1-s+1;l>0&&(this._removeLinesAfter(o,l),o.linesLength-=l)}return this._finishRendering(o,!1,n),o}_renderUntouchedLines(t,e,i,n,o){let s=t.rendLineNumberStart,a=t.lines;for(let l=e;l<=i;l++){let d=s+l;a[l].layoutLine(d,n[d-o],this._viewportData.lineHeight)}}_insertLinesBefore(t,e,i,n,o){let s=[],a=0;for(let l=e;l<=i;l++)s[a++]=this._lineFactory.createLine();t.lines=s.concat(t.lines)}_removeLinesBefore(t,e){for(let i=0;i<e;i++)t.lines[i].getDomNode()?.remove();t.lines.splice(0,e)}_insertLinesAfter(t,e,i,n,o){let s=[],a=0;for(let l=e;l<=i;l++)s[a++]=this._lineFactory.createLine();t.lines=t.lines.concat(s)}_removeLinesAfter(t,e){let i=t.linesLength-e;for(let n=0;n<e;n++)t.lines[i+n].getDomNode()?.remove();t.lines.splice(i,e)}_finishRenderingNewLines(t,e,i,n){r._ttPolicy&&(i=r._ttPolicy.createHTML(i));let o=this._domNode.lastChild;e||!o?this._domNode.innerHTML=i:o.insertAdjacentHTML("afterend",i);let s=this._domNode.lastChild;for(let a=t.linesLength-1;a>=0;a--){let l=t.lines[a];n[a]&&(l.setDomNode(s),s=s.previousSibling)}}_finishRenderingInvalidLines(t,e,i){let n=document.createElement("div");r._ttPolicy&&(e=r._ttPolicy.createHTML(e)),n.innerHTML=e;for(let o=0;o<t.linesLength;o++){let s=t.lines[o];if(i[o]){let a=n.firstChild,l=s.getDomNode();l.parentNode.replaceChild(a,l),s.setDomNode(a)}}}static _sb=new xd(1e5);_finishRendering(t,e,i){let n=r._sb,o=t.linesLength,s=t.lines,a=t.rendLineNumberStart,l=[];{n.reset();let d=!1;for(let c=0;c<o;c++){let p=s[c];l[c]=!1,!(p.getDomNode()||!p.renderLine(c+a,i[c],this._viewportData.lineHeight,this._viewportData,n))&&(l[c]=!0,d=!0)}d&&this._finishRenderingNewLines(t,e,n.build(),l)}{n.reset();let d=!1,c=[];for(let p=0;p<o;p++){let h=s[p];c[p]=!1,!(l[p]||!h.renderLine(p+a,i[p],this._viewportData.lineHeight,this._viewportData,n))&&(c[p]=!0,d=!0)}d&&this._finishRenderingInvalidLines(t,n.build(),c)}}};var LE=class{constructor(t,e){this._domNode=t;this.endNode=e}_didDomLayout=!1;_clientRectDeltaLeft=0;_clientRectScale=1;_clientRectRead=!1;get didDomLayout(){return this._didDomLayout}readClientRect(){if(!this._clientRectRead){this._clientRectRead=!0;let t=this._domNode.getBoundingClientRect();this.markDidDomLayout(),this._clientRectDeltaLeft=t.left,this._clientRectScale=t.width/this._domNode.offsetWidth}}get clientRectDeltaLeft(){return this._clientRectRead||this.readClientRect(),this._clientRectDeltaLeft}get clientRectScale(){return this._clientRectRead||this.readClientRect(),this._clientRectScale}markDidDomLayout(){this._didDomLayout=!0}};var fy=class{static _handyReadyRange;static _createRange(){return this._handyReadyRange||(this._handyReadyRange=document.createRange()),this._handyReadyRange}static _detachRange(t,e){t.selectNodeContents(e)}static _readClientRects(t,e,i,n,o){let s=this._createRange();try{return s.setStart(t,e),s.setEnd(i,n),s.getClientRects()}catch{return null}finally{this._detachRange(s,o)}}static _mergeAdjacentRanges(t){if(t.length===1)return t;t.sort(Au.compare);let e=[],i=0,n=t[0];for(let o=1,s=t.length;o<s;o++){let a=t[o];n.left+n.width+.9>=a.left?n.width=Math.max(n.width,a.left+a.width-n.left):(e[i++]=n,n=a)}return e[i++]=n,e}static _createHorizontalRangesFromClientRects(t,e,i){if(!t||t.length===0)return null;let n=[];for(let o=0,s=t.length;o<s;o++){let a=t[o];n[o]=new Au(Math.max(0,(a.left-e)/i),a.width/i)}return this._mergeAdjacentRanges(n)}static readHorizontalRanges(t,e,i,n,o,s){let l=t.children.length-1;if(0>l)return null;if(e=Math.min(l,Math.max(0,e)),n=Math.min(l,Math.max(0,n)),e===n&&i===o&&i===0&&!t.children[e].firstChild){let h=t.children[e].getClientRects();return s.markDidDomLayout(),this._createHorizontalRangesFromClientRects(h,s.clientRectDeltaLeft,s.clientRectScale)}e!==n&&n>0&&o===0&&(n--,o=1073741824);let d=t.children[e].firstChild,c=t.children[n].firstChild;if((!d||!c)&&(!d&&i===0&&e>0&&(d=t.children[e-1].firstChild,i=1073741824),!c&&o===0&&n>0&&(c=t.children[n-1].firstChild,o=1073741824)),!d||!c)return null;i=Math.min(d.textContent.length,Math.max(0,i)),o=Math.min(c.textContent.length,Math.max(0,o));let p=this._readClientRects(d,i,c,o,s.endNode);return s.markDidDomLayout(),this._createHorizontalRangesFromClientRects(p,s.clientRectDeltaLeft,s.clientRectScale)}};var Lo=class{constructor(t,e,i,n){this.endIndex=t;this.type=e;this.metadata=i;this.containsRTL=n}_linePartBrand=void 0;isWhitespace(){return!!(this.metadata&1)}isPseudoAfter(){return!!(this.metadata&4)}};var Pc=class r{constructor(t,e,i,n){this.startColumn=t;this.endColumn=e;this.className=i;this.type=n}_lineDecorationBrand=void 0;static _equals(t,e){return t.startColumn===e.startColumn&&t.endColumn===e.endColumn&&t.className===e.className&&t.type===e.type}static equalsArr(t,e){let i=t.length,n=e.length;if(i!==n)return!1;for(let o=0;o<i;o++)if(!r._equals(t[o],e[o]))return!1;return!0}static extractWrapped(t,e,i){if(t.length===0)return t;let n=e+1,o=i+1,s=i-e,a=[],l=0;for(let d of t)d.endColumn<=n||d.startColumn>=o||(a[l++]=new r(Math.max(1,d.startColumn-n+1),Math.min(s+1,d.endColumn-n+1),d.className,d.type));return a}static filter(t,e,i,n){if(t.length===0)return[];let o=[],s=0;for(let a=0,l=t.length;a<l;a++){let d=t[a],c=d.range;if(c.endLineNumber<e||c.startLineNumber>e||c.isEmpty()&&(d.type===0||d.type===3))continue;let p=c.startLineNumber===e?c.startColumn:i,h=c.endLineNumber===e?c.endColumn:n;o[s++]=new r(p,h,d.inlineClassName,d.type)}return o}static _typeCompare(t,e){let i=[2,0,1,3];return i[t]-i[e]}static compare(t,e){if(t.startColumn!==e.startColumn)return t.startColumn-e.startColumn;if(t.endColumn!==e.endColumn)return t.endColumn-e.endColumn;let i=r._typeCompare(t.type,e.type);return i!==0?i:t.className!==e.className?t.className<e.className?-1:1:0}},WV=class{startOffset;endOffset;className;metadata;constructor(t,e,i,n){this.startOffset=t,this.endOffset=e,this.className=i,this.metadata=n}},xq=class r{count;stopOffsets;classNames;metadata;constructor(){this.stopOffsets=[],this.classNames=[],this.metadata=[],this.count=0}static _metadata(t){let e=0;for(let i=0,n=t.length;i<n;i++)e|=t[i];return e}consumeLowerThan(t,e,i){for(;this.count>0&&this.stopOffsets[0]<t;){let n=0;for(;n+1<this.count&&this.stopOffsets[n]===this.stopOffsets[n+1];)n++;i.push(new WV(e,this.stopOffsets[n],this.classNames.join(" "),r._metadata(this.metadata))),e=this.stopOffsets[n]+1,this.stopOffsets.splice(0,n+1),this.classNames.splice(0,n+1),this.metadata.splice(0,n+1),this.count-=n+1}return this.count>0&&e<t&&(i.push(new WV(e,t-1,this.classNames.join(" "),r._metadata(this.metadata))),e=t),e}insert(t,e,i){if(this.count===0||this.stopOffsets[this.count-1]<=t)this.stopOffsets.push(t),this.classNames.push(e),this.metadata.push(i);else for(let n=0;n<this.count;n++)if(this.stopOffsets[n]>=t){this.stopOffsets.splice(n,0,t),this.classNames.splice(n,0,e),this.metadata.splice(n,0,i);break}this.count++}},HV=class{static normalize(t,e){if(e.length===0)return[];let i=[],n=new xq,o=0;for(let s=0,a=e.length;s<a;s++){let l=e[s],d=l.startColumn,c=l.endColumn,p=l.className,h=l.type===1?2:l.type===2?4:0;if(d>1){let g=t.charCodeAt(d-2);Rn(g)&&d--}if(c>1){let g=t.charCodeAt(c-2);Rn(g)&&c--}let m=d-1,f=c-2;o=n.consumeLowerThan(m,o,i),n.count===0&&(o=m),n.insert(f,p,h)}return n.consumeLowerThan(1073741824,o,i),i}};var RE=class{startOffset;endOffset;constructor(t,e){this.startOffset=t,this.endOffset=e}equals(t){return this.startOffset===t.startOffset&&this.endOffset===t.endOffset}},Rb=class{useMonospaceOptimizations;canUseHalfwidthRightwardsArrow;lineContent;continuesWithWrappedLine;isBasicASCII;containsRTL;fauxIndentLength;lineTokens;lineDecorations;tabSize;startVisibleColumn;spaceWidth;renderSpaceWidth;renderSpaceCharCode;stopRenderingLineAfter;renderWhitespace;renderControlCharacters;fontLigatures;selectionsOnLine;constructor(t,e,i,n,o,s,a,l,d,c,p,h,m,f,g,v,I,y,w){this.useMonospaceOptimizations=t,this.canUseHalfwidthRightwardsArrow=e,this.lineContent=i,this.continuesWithWrappedLine=n,this.isBasicASCII=o,this.containsRTL=s,this.fauxIndentLength=a,this.lineTokens=l,this.lineDecorations=d.sort(Pc.compare),this.tabSize=c,this.startVisibleColumn=p,this.spaceWidth=h,this.stopRenderingLineAfter=g,this.renderWhitespace=v==="all"?4:v==="boundary"?1:v==="selection"?2:v==="trailing"?3:0,this.renderControlCharacters=I,this.fontLigatures=y,this.selectionsOnLine=w&&w.sort((D,k)=>D.startOffset<k.startOffset?-1:1);let C=Math.abs(f-h),S=Math.abs(m-h);C<S?(this.renderSpaceWidth=f,this.renderSpaceCharCode=11825):(this.renderSpaceWidth=m,this.renderSpaceCharCode=183)}sameSelection(t){if(this.selectionsOnLine===null)return t===null;if(t===null||t.length!==this.selectionsOnLine.length)return!1;for(let e=0;e<this.selectionsOnLine.length;e++)if(!this.selectionsOnLine[e].equals(t[e]))return!1;return!0}equals(t){return this.useMonospaceOptimizations===t.useMonospaceOptimizations&&this.canUseHalfwidthRightwardsArrow===t.canUseHalfwidthRightwardsArrow&&this.lineContent===t.lineContent&&this.continuesWithWrappedLine===t.continuesWithWrappedLine&&this.isBasicASCII===t.isBasicASCII&&this.containsRTL===t.containsRTL&&this.fauxIndentLength===t.fauxIndentLength&&this.tabSize===t.tabSize&&this.startVisibleColumn===t.startVisibleColumn&&this.spaceWidth===t.spaceWidth&&this.renderSpaceWidth===t.renderSpaceWidth&&this.renderSpaceCharCode===t.renderSpaceCharCode&&this.stopRenderingLineAfter===t.stopRenderingLineAfter&&this.renderWhitespace===t.renderWhitespace&&this.renderControlCharacters===t.renderControlCharacters&&this.fontLigatures===t.fontLigatures&&Pc.equalsArr(this.lineDecorations,t.lineDecorations)&&this.lineTokens.equals(t.lineTokens)&&this.sameSelection(t.selectionsOnLine)}};var rR=class{constructor(t,e){this.partIndex=t;this.charIndex=e}},sR=class r{static getPartIndex(t){return(t&4294901760)>>>16}static getCharIndex(t){return(t&65535)>>>0}length;_data;_horizontalOffset;constructor(t,e){this.length=t,this._data=new Uint32Array(this.length),this._horizontalOffset=new Uint32Array(this.length)}setColumnInfo(t,e,i,n){let o=(e<<16|i<<0)>>>0;this._data[t-1]=o,this._horizontalOffset[t-1]=n}getHorizontalOffset(t){return this._horizontalOffset.length===0?0:this._horizontalOffset[t-1]}charOffsetToPartData(t){return this.length===0?0:t<0?this._data[0]:t>=this.length?this._data[this.length-1]:this._data[t]}getDomPosition(t){let e=this.charOffsetToPartData(t-1),i=r.getPartIndex(e),n=r.getCharIndex(e);return new rR(i,n)}getColumn(t,e){return this.partDataToCharOffset(t.partIndex,e,t.charIndex)+1}partDataToCharOffset(t,e,i){if(this.length===0)return 0;let n=(t<<16|i<<0)>>>0,o=0,s=this.length-1;for(;o+1<s;){let g=o+s>>>1,v=this._data[g];if(v===n)return g;v>n?s=g:o=g}if(o===s)return o;let a=this._data[o],l=this._data[s];if(a===n)return o;if(l===n)return s;let d=r.getPartIndex(a),c=r.getCharIndex(a),p=r.getPartIndex(l),h;d!==p?h=e:h=r.getCharIndex(l);let m=i-c,f=h-i;return m<=f?o:s}inflate(){let t=[];for(let e=0;e<this.length;e++){let i=this._data[e],n=r.getPartIndex(i),o=r.getCharIndex(i),s=this._horizontalOffset[e];t.push([n,o,s])}return t}};var aR=class{_renderLineOutputBrand=void 0;characterMapping;containsRTL;containsForeignElements;constructor(t,e,i){this.characterMapping=t,this.containsRTL=e,this.containsForeignElements=i}};function lR(r,t){if(r.lineContent.length===0){if(r.lineDecorations.length>0){t.appendString("<span>");let e=0,i=0,n=0;for(let s of r.lineDecorations)(s.type===1||s.type===2)&&(t.appendString('<span class="'),t.appendString(s.className),t.appendString('"></span>'),s.type===1&&(n|=1,e++),s.type===2&&(n|=2,i++));t.appendString("</span>");let o=new sR(1,e+i);return o.setColumnInfo(1,e,0,0),new aR(o,!1,n)}return t.appendString("<span><span></span></span>"),new aR(new sR(0,0),!1,0)}return EEe(vEe(r),t)}var Tq=class{constructor(t,e,i,n){this.characterMapping=t;this.html=e;this.containsRTL=i;this.containsForeignElements=n}};function Cce(r){let t=new xd(1e4),e=lR(r,t);return new Tq(e.characterMapping,t.build(),e.containsRTL,e.containsForeignElements)}var _q=class{constructor(t,e,i,n,o,s,a,l,d,c,p,h,m,f,g,v){this.fontIsMonospace=t;this.canUseHalfwidthRightwardsArrow=e;this.lineContent=i;this.len=n;this.isOverflowing=o;this.overflowingCharCount=s;this.parts=a;this.containsForeignElements=l;this.fauxIndentLength=d;this.tabSize=c;this.startVisibleColumn=p;this.containsRTL=h;this.spaceWidth=m;this.renderSpaceCharCode=f;this.renderWhitespace=g;this.renderControlCharacters=v}};function vEe(r){let t=r.lineContent,e,i,n;r.stopRenderingLineAfter!==-1&&r.stopRenderingLineAfter<t.length?(e=!0,i=t.length-r.stopRenderingLineAfter,n=r.stopRenderingLineAfter):(e=!1,i=0,n=t.length);let o=IEe(t,r.containsRTL,r.lineTokens,r.fauxIndentLength,n);r.renderControlCharacters&&!r.isBasicASCII&&(o=SEe(t,o)),(r.renderWhitespace===4||r.renderWhitespace===1||r.renderWhitespace===2&&r.selectionsOnLine||r.renderWhitespace===3&&!r.continuesWithWrappedLine)&&(o=CEe(r,t,n,o));let s=0;if(r.lineDecorations.length>0){for(let a=0,l=r.lineDecorations.length;a<l;a++){let d=r.lineDecorations[a];d.type===3||d.type===1?s|=1:d.type===2&&(s|=2)}o=wEe(t,n,o,r.lineDecorations)}return r.containsRTL||(o=yEe(t,o,!r.isBasicASCII||r.fontLigatures)),new _q(r.useMonospaceOptimizations,r.canUseHalfwidthRightwardsArrow,t,n,e,i,o,s,r.fauxIndentLength,r.tabSize,r.startVisibleColumn,r.containsRTL,r.spaceWidth,r.renderSpaceCharCode,r.renderWhitespace,r.renderControlCharacters)}function IEe(r,t,e,i,n){let o=[],s=0;i>0&&(o[s++]=new Lo(i,"",0,!1));let a=i;for(let l=0,d=e.getCount();l<d;l++){let c=e.getEndOffset(l);if(c<=i)continue;let p=e.getClassName(l);if(c>=n){let m=t?vm(r.substring(a,n)):!1;o[s++]=new Lo(n,p,0,m);break}let h=t?vm(r.substring(a,c)):!1;o[s++]=new Lo(c,p,0,h),a=c}return o}function yEe(r,t,e){let i=0,n=[],o=0;if(e)for(let s=0,a=t.length;s<a;s++){let l=t[s],d=l.endIndex;if(i+50<d){let c=l.type,p=l.metadata,h=l.containsRTL,m=-1,f=i;for(let g=i;g<d;g++)r.charCodeAt(g)===32&&(m=g),m!==-1&&g-f>=50&&(n[o++]=new Lo(m+1,c,p,h),f=m+1,m=-1);f!==d&&(n[o++]=new Lo(d,c,p,h))}else n[o++]=l;i=d}else for(let s=0,a=t.length;s<a;s++){let l=t[s],d=l.endIndex,c=d-i;if(c>50){let p=l.type,h=l.metadata,m=l.containsRTL,f=Math.ceil(c/50);for(let g=1;g<f;g++){let v=i+g*50;n[o++]=new Lo(v,p,h,m)}n[o++]=new Lo(d,p,h,m)}else n[o++]=l;i=d}return n}function wce(r){return r<32?r!==9:r===127||r>=8234&&r<=8238||r>=8294&&r<=8297||r>=8206&&r<=8207||r===1564}function SEe(r,t){let e=[],i=new Lo(0,"",0,!1),n=0;for(let o of t){let s=o.endIndex;for(;n<s;n++){let a=r.charCodeAt(n);wce(a)&&(n>i.endIndex&&(i=new Lo(n,o.type,o.metadata,o.containsRTL),e.push(i)),i=new Lo(n+1,"mtkcontrol",o.metadata,!1),e.push(i))}n>i.endIndex&&(i=new Lo(s,o.type,o.metadata,o.containsRTL),e.push(i))}return e}function CEe(r,t,e,i){let n=r.continuesWithWrappedLine,o=r.fauxIndentLength,s=r.tabSize,a=r.startVisibleColumn,l=r.useMonospaceOptimizations,d=r.selectionsOnLine,c=r.renderWhitespace===1,p=r.renderWhitespace===3,h=r.renderSpaceWidth!==r.spaceWidth,m=[],f=0,g=0,v=i[g].type,I=i[g].containsRTL,y=i[g].endIndex,w=i.length,C=!1,S=Jn(t),D;S===-1?(C=!0,S=e,D=e):D=fd(t);let k=!1,M=0,O=d&&d[M],K=a%s;for(let Y=o;Y<e;Y++){let ge=t.charCodeAt(Y);O&&Y>=O.endOffset&&(M++,O=d&&d[M]);let xe;if(Y<S||Y>D)xe=!0;else if(ge===9)xe=!0;else if(ge===32)if(c)if(k)xe=!0;else{let be=Y+1<e?t.charCodeAt(Y+1):0;xe=be===32||be===9}else xe=!0;else xe=!1;if(xe&&d&&(xe=!!O&&O.startOffset<=Y&&O.endOffset>Y),xe&&p&&(xe=C||Y>D),xe&&I&&Y>=S&&Y<=D&&(xe=!1),k){if(!xe||!l&&K>=s){if(h){let be=f>0?m[f-1].endIndex:o;for(let fe=be+1;fe<=Y;fe++)m[f++]=new Lo(fe,"mtkw",1,!1)}else m[f++]=new Lo(Y,"mtkw",1,!1);K=K%s}}else(Y===y||xe&&Y>o)&&(m[f++]=new Lo(Y,v,0,I),K=K%s);for(ge===9?K=s:vd(ge)?K+=2:K++,k=xe;Y===y&&(g++,g<w);)v=i[g].type,I=i[g].containsRTL,y=i[g].endIndex}let G=!1;if(k)if(n&&c){let Y=e>0?t.charCodeAt(e-1):0,ge=e>1?t.charCodeAt(e-2):0;Y===32&&ge!==32&&ge!==9||(G=!0)}else G=!0;if(G)if(h){let Y=f>0?m[f-1].endIndex:o;for(let ge=Y+1;ge<=e;ge++)m[f++]=new Lo(ge,"mtkw",1,!1)}else m[f++]=new Lo(e,"mtkw",1,!1);else m[f++]=new Lo(e,v,0,I);return m}function wEe(r,t,e,i){i.sort(Pc.compare);let n=HV.normalize(r,i),o=n.length,s=0,a=[],l=0,d=0;for(let p=0,h=e.length;p<h;p++){let m=e[p],f=m.endIndex,g=m.type,v=m.metadata,I=m.containsRTL;for(;s<o&&n[s].startOffset<f;){let y=n[s];if(y.startOffset>d&&(d=y.startOffset,a[l++]=new Lo(d,g,v,I)),y.endOffset+1<=f)d=y.endOffset+1,a[l++]=new Lo(d,g+" "+y.className,v|y.metadata,I),s++;else{d=f,a[l++]=new Lo(d,g+" "+y.className,v|y.metadata,I);break}}f>d&&(d=f,a[l++]=new Lo(d,g,v,I))}let c=e[e.length-1].endIndex;if(s<o&&n[s].startOffset===c)for(;s<o&&n[s].startOffset===c;){let p=n[s];a[l++]=new Lo(d,p.className,p.metadata,!1),s++}return a}function EEe(r,t){let e=r.fontIsMonospace,i=r.canUseHalfwidthRightwardsArrow,n=r.containsForeignElements,o=r.lineContent,s=r.len,a=r.isOverflowing,l=r.overflowingCharCount,d=r.parts,c=r.fauxIndentLength,p=r.tabSize,h=r.startVisibleColumn,m=r.containsRTL,f=r.spaceWidth,g=r.renderSpaceCharCode,v=r.renderWhitespace,I=r.renderControlCharacters,y=new sR(s+1,d.length),w=!1,C=0,S=h,D=0,k=0,M=0;m?t.appendString('<span dir="ltr">'):t.appendString("<span>");for(let O=0,K=d.length;O<K;O++){let G=d[O],Y=G.endIndex,ge=G.type,xe=G.containsRTL,be=v!==0&&G.isWhitespace(),fe=be&&!e&&(ge==="mtkw"||!n),Le=C===Y&&G.isPseudoAfter();if(D=0,t.appendString("<span "),xe&&t.appendString('style="unicode-bidi:isolate" '),t.appendString('class="'),t.appendString(fe?"mtkz":ge),t.appendASCIICharCode(34),be){let Ee=0;{let Ce=C,Je=S;for(;Ce<Y;Ce++){let qt=(o.charCodeAt(Ce)===9?p-Je%p:1)|0;Ee+=qt,Ce>=c&&(Je+=qt)}}for(fe&&(t.appendString(' style="width:'),t.appendString(String(f*Ee)),t.appendString('px"')),t.appendASCIICharCode(62);C<Y;C++){y.setColumnInfo(C+1,O-M,D,k),M=0;let Ce=o.charCodeAt(C),Je,pe;if(Ce===9){Je=p-S%p|0,pe=Je,!i||pe>1?t.appendCharCode(8594):t.appendCharCode(65515);for(let qt=2;qt<=pe;qt++)t.appendCharCode(160)}else Je=2,pe=1,t.appendCharCode(g),t.appendCharCode(8204);D+=Je,k+=pe,C>=c&&(S+=pe)}}else for(t.appendASCIICharCode(62);C<Y;C++){y.setColumnInfo(C+1,O-M,D,k),M=0;let Ee=o.charCodeAt(C),Ce=1,Je=1;switch(Ee){case 9:Ce=p-S%p,Je=Ce;for(let pe=1;pe<=Ce;pe++)t.appendCharCode(160);break;case 32:t.appendCharCode(160);break;case 60:t.appendString("&lt;");break;case 62:t.appendString("&gt;");break;case 38:t.appendString("&amp;");break;case 0:I?t.appendCharCode(9216):t.appendString("&#00;");break;case 65279:case 8232:case 8233:case 133:t.appendCharCode(65533);break;default:vd(Ee)&&Je++,I&&Ee<32?t.appendCharCode(9216+Ee):I&&Ee===127?t.appendCharCode(9249):I&&wce(Ee)?(t.appendString("[U+"),t.appendString(xEe(Ee)),t.appendString("]"),Ce=8,Je=Ce):t.appendCharCode(Ee)}D+=Ce,k+=Je,C>=c&&(S+=Je)}Le?M++:M=0,C>=s&&!w&&G.isPseudoAfter()&&(w=!0,y.setColumnInfo(C+1,O,D,k)),t.appendString("</span>")}return w||y.setColumnInfo(s+1,d.length-1,D,k),a&&(t.appendString('<span class="mtkoverflow">'),t.appendString(u("showMore","Show more ({0})",TEe(l))),t.appendString("</span>")),t.appendString("</span>"),new aR(y,m,n)}function xEe(r){return r.toString(16).toUpperCase().padStart(4,"0")}function TEe(r){return r<1024?u("overflow.chars","{0} chars",r):r<1024*1024?`${(r/1024).toFixed(1)} KB`:`${(r/1024/1024).toFixed(1)} MB`}var _Ee=function(){return Po?!0:!(ci||po||ms)}(),ME=!0,dR=class{themeType;renderWhitespace;renderControlCharacters;spaceWidth;middotWidth;wsmiddotWidth;useMonospaceOptimizations;canUseHalfwidthRightwardsArrow;lineHeight;stopRenderingLineAfter;fontLigatures;constructor(t,e){this.themeType=e;let i=t.options,n=i.get(51);i.get(39)==="off"?this.renderWhitespace=i.get(101):this.renderWhitespace="none",this.renderControlCharacters=i.get(96),this.spaceWidth=n.spaceWidth,this.middotWidth=n.middotWidth,this.wsmiddotWidth=n.wsmiddotWidth,this.useMonospaceOptimizations=n.isMonospace&&!i.get(33),this.canUseHalfwidthRightwardsArrow=n.canUseHalfwidthRightwardsArrow,this.lineHeight=i.get(68),this.stopRenderingLineAfter=i.get(119),this.fontLigatures=i.get(52)}equals(t){return this.themeType===t.themeType&&this.renderWhitespace===t.renderWhitespace&&this.renderControlCharacters===t.renderControlCharacters&&this.spaceWidth===t.spaceWidth&&this.middotWidth===t.middotWidth&&this.wsmiddotWidth===t.wsmiddotWidth&&this.useMonospaceOptimizations===t.useMonospaceOptimizations&&this.canUseHalfwidthRightwardsArrow===t.canUseHalfwidthRightwardsArrow&&this.lineHeight===t.lineHeight&&this.stopRenderingLineAfter===t.stopRenderingLineAfter&&this.fontLigatures===t.fontLigatures}},Ou=class r{static CLASS_NAME="view-line";_options;_isMaybeInvalid;_renderedViewLine;constructor(t){this._options=t,this._isMaybeInvalid=!0,this._renderedViewLine=null}getDomNode(){return this._renderedViewLine&&this._renderedViewLine.domNode?this._renderedViewLine.domNode.domNode:null}setDomNode(t){if(this._renderedViewLine)this._renderedViewLine.domNode=Ot(t);else throw new Error("I have no rendered view line to set the dom node to...")}onContentChanged(){this._isMaybeInvalid=!0}onTokensChanged(){this._isMaybeInvalid=!0}onDecorationsChanged(){this._isMaybeInvalid=!0}onOptionsChanged(t){this._isMaybeInvalid=!0,this._options=t}onSelectionChanged(){return oa(this._options.themeType)||this._options.renderWhitespace==="selection"?(this._isMaybeInvalid=!0,!0):!1}renderLine(t,e,i,n,o){if(this._isMaybeInvalid===!1)return!1;this._isMaybeInvalid=!1;let s=n.getViewLineRenderingData(t),a=this._options,l=Pc.filter(s.inlineDecorations,t,s.minColumn,s.maxColumn),d=null;if(oa(a.themeType)||this._options.renderWhitespace==="selection"){let m=n.selections;for(let f of m){if(f.endLineNumber<t||f.startLineNumber>t)continue;let g=f.startLineNumber===t?f.startColumn:s.minColumn,v=f.endLineNumber===t?f.endColumn:s.maxColumn;g<v&&(oa(a.themeType)&&l.push(new Pc(g,v,"inline-selected-text",0)),this._options.renderWhitespace==="selection"&&(d||(d=[]),d.push(new RE(g-1,v-1))))}}let c=new Rb(a.useMonospaceOptimizations,a.canUseHalfwidthRightwardsArrow,s.content,s.continuesWithWrappedLine,s.isBasicASCII,s.containsRTL,s.minColumn-1,s.tokens,l,s.tabSize,s.startVisibleColumn,a.spaceWidth,a.middotWidth,a.wsmiddotWidth,a.stopRenderingLineAfter,a.renderWhitespace,a.renderControlCharacters,a.fontLigatures!==ou.OFF,d);if(this._renderedViewLine&&this._renderedViewLine.input.equals(c))return!1;o.appendString('<div style="top:'),o.appendString(String(e)),o.appendString("px;height:"),o.appendString(String(i)),o.appendString('px;" class="'),o.appendString(r.CLASS_NAME),o.appendString('">');let p=lR(c,o);o.appendString("</div>");let h=null;return ME&&_Ee&&s.isBasicASCII&&a.useMonospaceOptimizations&&p.containsForeignElements===0&&(h=new PE(this._renderedViewLine?this._renderedViewLine.domNode:null,c,p.characterMapping)),h||(h=Ece(this._renderedViewLine?this._renderedViewLine.domNode:null,c,p.characterMapping,p.containsRTL,p.containsForeignElements)),this._renderedViewLine=h,!0}layoutLine(t,e,i){this._renderedViewLine&&this._renderedViewLine.domNode&&(this._renderedViewLine.domNode.setTop(e),this._renderedViewLine.domNode.setHeight(i))}getWidth(t){return this._renderedViewLine?this._renderedViewLine.getWidth(t):0}getWidthIsFast(){return this._renderedViewLine?this._renderedViewLine.getWidthIsFast():!0}needsMonospaceFontCheck(){return this._renderedViewLine?this._renderedViewLine instanceof PE:!1}monospaceAssumptionsAreValid(){return this._renderedViewLine&&this._renderedViewLine instanceof PE?this._renderedViewLine.monospaceAssumptionsAreValid():ME}onMonospaceAssumptionsInvalidated(){this._renderedViewLine&&this._renderedViewLine instanceof PE&&(this._renderedViewLine=this._renderedViewLine.toSlowRenderedLine())}getVisibleRangesForRange(t,e,i,n){if(!this._renderedViewLine)return null;e=Math.min(this._renderedViewLine.input.lineContent.length+1,Math.max(1,e)),i=Math.min(this._renderedViewLine.input.lineContent.length+1,Math.max(1,i));let o=this._renderedViewLine.input.stopRenderingLineAfter;if(o!==-1&&e>o+1&&i>o+1)return new nR(!0,[new Au(this.getWidth(n),0)]);o!==-1&&e>o+1&&(e=o+1),o!==-1&&i>o+1&&(i=o+1);let s=this._renderedViewLine.getVisibleRangesForRange(t,e,i,n);return s&&s.length>0?new nR(!1,s):null}getColumnOfNodeOffset(t,e){return this._renderedViewLine?this._renderedViewLine.getColumnOfNodeOffset(t,e):1}};var PE=class{domNode;input;_characterMapping;_charWidth;_keyColumnPixelOffsetCache;_cachedWidth=-1;constructor(t,e,i){this.domNode=t,this.input=e;let n=Math.floor(e.lineContent.length/300);if(n>0){this._keyColumnPixelOffsetCache=new Float32Array(n);for(let o=0;o<n;o++)this._keyColumnPixelOffsetCache[o]=-1}else this._keyColumnPixelOffsetCache=null;this._characterMapping=i,this._charWidth=e.spaceWidth}getWidth(t){if(!this.domNode||this.input.lineContent.length<300){let e=this._characterMapping.getHorizontalOffset(this._characterMapping.length);return Math.round(this._charWidth*e)}return this._cachedWidth===-1&&(this._cachedWidth=this._getReadingTarget(this.domNode).offsetWidth,t?.markDidDomLayout()),this._cachedWidth}getWidthIsFast(){return this.input.lineContent.length<300||this._cachedWidth!==-1}monospaceAssumptionsAreValid(){if(!this.domNode)return ME;if(this.input.lineContent.length<300){let t=this.getWidth(null),e=this.domNode.domNode.firstChild.offsetWidth;Math.abs(t-e)>=2&&(console.warn("monospace assumptions have been violated, therefore disabling monospace optimizations!"),ME=!1)}return ME}toSlowRenderedLine(){return Ece(this.domNode,this.input,this._characterMapping,!1,0)}getVisibleRangesForRange(t,e,i,n){let o=this._getColumnPixelOffset(t,e,n),s=this._getColumnPixelOffset(t,i,n);return[new Au(o,s-o)]}_getColumnPixelOffset(t,e,i){if(e<=300){let d=this._characterMapping.getHorizontalOffset(e);return this._charWidth*d}let n=Math.floor((e-1)/300)-1,o=(n+1)*300+1,s=-1;if(this._keyColumnPixelOffsetCache&&(s=this._keyColumnPixelOffsetCache[n],s===-1&&(s=this._actualReadPixelOffset(t,o,i),this._keyColumnPixelOffsetCache[n]=s)),s===-1){let d=this._characterMapping.getHorizontalOffset(e);return this._charWidth*d}let a=this._characterMapping.getHorizontalOffset(o),l=this._characterMapping.getHorizontalOffset(e);return s+this._charWidth*(l-a)}_getReadingTarget(t){return t.domNode.firstChild}_actualReadPixelOffset(t,e,i){if(!this.domNode)return-1;let n=this._characterMapping.getDomPosition(e),o=fy.readHorizontalRanges(this._getReadingTarget(this.domNode),n.partIndex,n.charIndex,n.partIndex,n.charIndex,i);return!o||o.length===0?-1:o[0].left}getColumnOfNodeOffset(t,e){return xce(this._characterMapping,t,e)}},zV=class{domNode;input;_characterMapping;_isWhitespaceOnly;_containsForeignElements;_cachedWidth;_pixelOffsetCache;constructor(t,e,i,n,o){if(this.domNode=t,this.input=e,this._characterMapping=i,this._isWhitespaceOnly=/^\s*$/.test(e.lineContent),this._containsForeignElements=o,this._cachedWidth=-1,this._pixelOffsetCache=null,!n||this._characterMapping.length===0){this._pixelOffsetCache=new Float32Array(Math.max(2,this._characterMapping.length+1));for(let s=0,a=this._characterMapping.length;s<=a;s++)this._pixelOffsetCache[s]=-1}}_getReadingTarget(t){return t.domNode.firstChild}getWidth(t){return this.domNode?(this._cachedWidth===-1&&(this._cachedWidth=this._getReadingTarget(this.domNode).offsetWidth,t?.markDidDomLayout()),this._cachedWidth):0}getWidthIsFast(){return this._cachedWidth!==-1}getVisibleRangesForRange(t,e,i,n){if(!this.domNode)return null;if(this._pixelOffsetCache!==null){let o=this._readPixelOffset(this.domNode,t,e,n);if(o===-1)return null;let s=this._readPixelOffset(this.domNode,t,i,n);return s===-1?null:[new Au(o,s-o)]}return this._readVisibleRangesForRange(this.domNode,t,e,i,n)}_readVisibleRangesForRange(t,e,i,n,o){if(i===n){let s=this._readPixelOffset(t,e,i,o);return s===-1?null:[new Au(s,0)]}else return this._readRawVisibleRangesForRange(t,i,n,o)}_readPixelOffset(t,e,i,n){if(this._characterMapping.length===0){if(this._containsForeignElements===0||this._containsForeignElements===2)return 0;if(this._containsForeignElements===1)return this.getWidth(n);let o=this._getReadingTarget(t);return o.firstChild?(n.markDidDomLayout(),o.firstChild.offsetWidth):0}if(this._pixelOffsetCache!==null){let o=this._pixelOffsetCache[i];if(o!==-1)return o;let s=this._actualReadPixelOffset(t,e,i,n);return this._pixelOffsetCache[i]=s,s}return this._actualReadPixelOffset(t,e,i,n)}_actualReadPixelOffset(t,e,i,n){if(this._characterMapping.length===0){let l=fy.readHorizontalRanges(this._getReadingTarget(t),0,0,0,0,n);return!l||l.length===0?-1:l[0].left}if(i===this._characterMapping.length&&this._isWhitespaceOnly&&this._containsForeignElements===0)return this.getWidth(n);let o=this._characterMapping.getDomPosition(i),s=fy.readHorizontalRanges(this._getReadingTarget(t),o.partIndex,o.charIndex,o.partIndex,o.charIndex,n);if(!s||s.length===0)return-1;let a=s[0].left;if(this.input.isBasicASCII){let l=this._characterMapping.getHorizontalOffset(i),d=Math.round(this.input.spaceWidth*l);if(Math.abs(d-a)<=1)return d}return a}_readRawVisibleRangesForRange(t,e,i,n){if(e===1&&i===this._characterMapping.length)return[new Au(0,this.getWidth(n))];let o=this._characterMapping.getDomPosition(e),s=this._characterMapping.getDomPosition(i);return fy.readHorizontalRanges(this._getReadingTarget(t),o.partIndex,o.charIndex,s.partIndex,s.charIndex,n)}getColumnOfNodeOffset(t,e){return xce(this._characterMapping,t,e)}},Dq=class extends zV{_readVisibleRangesForRange(t,e,i,n,o){let s=super._readVisibleRangesForRange(t,e,i,n,o);if(!s||s.length===0||i===n||i===1&&n===this._characterMapping.length)return s;if(!this.input.containsRTL){let a=this._readPixelOffset(t,e,n,o);if(a!==-1){let l=s[s.length-1];l.left<a&&(l.width=a-l.left)}}return s}},Ece=function(){return Yc?DEe:kEe}();function DEe(r,t,e,i,n){return new Dq(r,t,e,i,n)}function kEe(r,t,e,i,n){return new zV(r,t,e,i,n)}function xce(r,t,e){let i=t.textContent.length,n=-1;for(;t;)t=t.previousSibling,n++;return r.getColumn(new rR(n,e),i)}var Nu="monaco-mouse-cursor-text";var KV=class{constructor(t,e,i,n,o,s,a){this.top=t;this.left=e;this.paddingLeft=i;this.width=n;this.height=o;this.textContent=s;this.textContentClassName=a}};var cR=class{_context;_domNode;_cursorStyle;_lineCursorWidth;_lineHeight;_typicalHalfwidthCharacterWidth;_isVisible;_position;_pluralityClass;_lastRenderedContent;_renderData;constructor(t,e){this._context=t;let i=this._context.configuration.options,n=i.get(51);this._cursorStyle=i.get(28),this._lineHeight=i.get(68),this._typicalHalfwidthCharacterWidth=n.typicalHalfwidthCharacterWidth,this._lineCursorWidth=Math.min(i.get(31),this._typicalHalfwidthCharacterWidth),this._isVisible=!0,this._domNode=Ot(document.createElement("div")),this._domNode.setClassName(`cursor ${Nu}`),this._domNode.setHeight(this._lineHeight),this._domNode.setTop(0),this._domNode.setLeft(0),hn(this._domNode,n),this._domNode.setDisplay("none"),this._position=new H(1,1),this._pluralityClass="",this.setPlurality(e),this._lastRenderedContent="",this._renderData=null}getDomNode(){return this._domNode}getPosition(){return this._position}setPlurality(t){switch(t){default:case 0:this._pluralityClass="";break;case 1:this._pluralityClass="cursor-primary";break;case 2:this._pluralityClass="cursor-secondary";break}}show(){this._isVisible||(this._domNode.setVisibility("inherit"),this._isVisible=!0)}hide(){this._isVisible&&(this._domNode.setVisibility("hidden"),this._isVisible=!1)}onConfigurationChanged(t){let e=this._context.configuration.options,i=e.get(51);return this._cursorStyle=e.get(28),this._lineHeight=e.get(68),this._typicalHalfwidthCharacterWidth=i.typicalHalfwidthCharacterWidth,this._lineCursorWidth=Math.min(e.get(31),this._typicalHalfwidthCharacterWidth),hn(this._domNode,i),!0}onCursorPositionChanged(t,e){return e?this._domNode.domNode.style.transitionProperty="none":this._domNode.domNode.style.transitionProperty="",this._position=t,!0}_getGraphemeAwarePosition(){let{lineNumber:t,column:e}=this._position,i=this._context.viewModel.getLineContent(t),[n,o]=gA(i,e-1);return[new H(t,n+1),i.substring(n,o)]}_prepareRender(t){let e="",i="",[n,o]=this._getGraphemeAwarePosition();if(this._cursorStyle===1||this._cursorStyle===4){let h=t.visibleRangeForPosition(n);if(!h||h.outsideRenderedLine)return null;let m=ue(this._domNode.domNode),f;this._cursorStyle===1?(f=J4(m,this._lineCursorWidth>0?this._lineCursorWidth:2),f>2&&(e=o,i=this._getTokenClassName(n))):f=J4(m,1);let g=h.left,v=0;f>=2&&g>=1&&(v=1,g-=v);let I=t.getVerticalOffsetForLineNumber(n.lineNumber)-t.bigNumbersDelta;return new KV(I,g,v,f,this._lineHeight,e,i)}let s=t.linesVisibleRangesForRange(new L(n.lineNumber,n.column,n.lineNumber,n.column+o.length),!1);if(!s||s.length===0)return null;let a=s[0];if(a.outsideRenderedLine||a.ranges.length===0)return null;let l=a.ranges[0],d=o==="	"?this._typicalHalfwidthCharacterWidth:l.width<1?this._typicalHalfwidthCharacterWidth:l.width;this._cursorStyle===2&&(e=o,i=this._getTokenClassName(n));let c=t.getVerticalOffsetForLineNumber(n.lineNumber)-t.bigNumbersDelta,p=this._lineHeight;return(this._cursorStyle===3||this._cursorStyle===6)&&(c+=this._lineHeight-2,p=2),new KV(c,l.left,0,d,p,e,i)}_getTokenClassName(t){let e=this._context.viewModel.getViewLineData(t.lineNumber),i=e.tokens.findTokenIndexAtOffset(t.column-1);return e.tokens.getClassName(i)}prepareRender(t){this._renderData=this._prepareRender(t)}render(t){return this._renderData?(this._lastRenderedContent!==this._renderData.textContent&&(this._lastRenderedContent=this._renderData.textContent,this._domNode.domNode.textContent=this._lastRenderedContent),this._domNode.setClassName(`cursor ${this._pluralityClass} ${Nu} ${this._renderData.textContentClassName}`),this._domNode.setDisplay("block"),this._domNode.setTop(this._renderData.top),this._domNode.setLeft(this._renderData.left),this._domNode.setPaddingLeft(this._renderData.paddingLeft),this._domNode.setWidth(this._renderData.width),this._domNode.setLineHeight(this._renderData.height),this._domNode.setHeight(this._renderData.height),{domNode:this._domNode.domNode,position:this._position,contentLeft:this._renderData.left,height:this._renderData.height,width:2}):(this._domNode.setDisplay("none"),null)}};var by=class r{static whitespaceVisibleColumn(t,e,i){let n=t.length,o=0,s=-1,a=-1;for(let l=0;l<n;l++){if(l===e)return[s,a,o];switch(o%i===0&&(s=l,a=o),t.charCodeAt(l)){case 32:o+=1;break;case 9:o=tn.nextRenderTabStop(o,i);break;default:return[-1,-1,-1]}}return e===n?[s,a,o]:[-1,-1,-1]}static atomicPosition(t,e,i,n){let o=t.length,[s,a,l]=r.whitespaceVisibleColumn(t,e,i);if(l===-1)return-1;let d;switch(n){case 0:d=!0;break;case 1:d=!1;break;case 2:if(l%i===0)return e;d=l%i<=i/2;break}if(d){if(s===-1)return-1;let h=a;for(let m=s;m<o;++m){if(h===a+i)return s;switch(t.charCodeAt(m)){case 32:h+=1;break;case 9:h=tn.nextRenderTabStop(h,i);break;default:return-1}}return h===a+i?s:-1}let c=tn.nextRenderTabStop(l,i),p=l;for(let h=e;h<o;h++){if(p===c)return h;switch(t.charCodeAt(h)){case 32:p+=1;break;case 9:p=tn.nextRenderTabStop(p,i);break;default:return-1}}return p===c?o:-1}};var Lh=class{constructor(t=null){this.hitTarget=t}type=0},GV=class{constructor(t,e,i){this.position=t;this.spanNode=e;this.injectedText=i}type=1;get hitTarget(){return this.spanNode}},AE;(t=>{function r(e,i,n){let o=e.getPositionFromDOMInfo(i,n);return o?new GV(o,i,null):new Lh(i)}t.createFromDOMInfo=r})(AE||={});var qV=class{constructor(t,e){this.lastViewCursorsRenderData=t;this.lastTextareaPosition=e}},Mr=class{static _deduceRage(t,e=null){return!e&&t?new L(t.lineNumber,t.column,t.lineNumber,t.column):e??null}static createUnknown(t,e,i){return{type:0,element:t,mouseColumn:e,position:i,range:this._deduceRage(i)}}static createTextarea(t,e){return{type:1,element:t,mouseColumn:e,position:null,range:null}}static createMargin(t,e,i,n,o,s){return{type:t,element:e,mouseColumn:i,position:n,range:o,detail:s}}static createViewZone(t,e,i,n,o){return{type:t,element:e,mouseColumn:i,position:n,range:this._deduceRage(n),detail:o}}static createContentText(t,e,i,n,o){return{type:6,element:t,mouseColumn:e,position:i,range:this._deduceRage(i,n),detail:o}}static createContentEmpty(t,e,i,n){return{type:7,element:t,mouseColumn:e,position:i,range:this._deduceRage(i),detail:n}}static createContentWidget(t,e,i){return{type:9,element:t,mouseColumn:e,position:null,range:null,detail:i}}static createScrollbar(t,e,i){return{type:11,element:t,mouseColumn:e,position:i,range:this._deduceRage(i)}}static createOverlayWidget(t,e,i){return{type:12,element:t,mouseColumn:e,position:null,range:null,detail:i}}static createOutsideEditor(t,e,i,n){return{type:13,element:null,mouseColumn:t,position:e,range:this._deduceRage(e),outsidePosition:i,outsideDistance:n}}static _typeToString(t){return t===1?"TEXTAREA":t===2?"GUTTER_GLYPH_MARGIN":t===3?"GUTTER_LINE_NUMBERS":t===4?"GUTTER_LINE_DECORATIONS":t===5?"GUTTER_VIEW_ZONE":t===6?"CONTENT_TEXT":t===7?"CONTENT_EMPTY":t===8?"CONTENT_VIEW_ZONE":t===9?"CONTENT_WIDGET":t===10?"OVERVIEW_RULER":t===11?"SCROLLBAR":t===12?"OVERLAY_WIDGET":"UNKNOWN"}static toString(t){return this._typeToString(t.type)+": "+t.position+" - "+t.range+" - "+JSON.stringify(t.detail)}},Ts=class{static isTextArea(t){return t.length===2&&t[0]===3&&t[1]===7}static isChildOfViewLines(t){return t.length>=4&&t[0]===3&&t[3]===8}static isStrictChildOfViewLines(t){return t.length>4&&t[0]===3&&t[3]===8}static isChildOfScrollableElement(t){return t.length>=2&&t[0]===3&&t[1]===6}static isChildOfMinimap(t){return t.length>=2&&t[0]===3&&t[1]===9}static isChildOfContentWidgets(t){return t.length>=4&&t[0]===3&&t[3]===1}static isChildOfOverflowGuard(t){return t.length>=1&&t[0]===3}static isChildOfOverflowingContentWidgets(t){return t.length>=1&&t[0]===2}static isChildOfOverlayWidgets(t){return t.length>=2&&t[0]===3&&t[1]===4}static isChildOfOverflowingOverlayWidgets(t){return t.length>=1&&t[0]===5}},OE=class r{viewModel;layoutInfo;viewDomNode;lineHeight;stickyTabStops;typicalHalfwidthCharacterWidth;lastRenderData;_context;_viewHelper;constructor(t,e,i){this.viewModel=t.viewModel;let n=t.configuration.options;this.layoutInfo=n.get(147),this.viewDomNode=e.viewDomNode,this.lineHeight=n.get(68),this.stickyTabStops=n.get(118),this.typicalHalfwidthCharacterWidth=n.get(51).typicalHalfwidthCharacterWidth,this.lastRenderData=i,this._context=t,this._viewHelper=e}getZoneAtCoord(t){return r.getZoneAtCoord(this._context,t)}static getZoneAtCoord(t,e){let i=t.viewLayout.getWhitespaceAtVerticalOffset(e);if(i){let n=i.verticalOffset+i.height/2,o=t.viewModel.getLineCount(),s=null,a,l=null;return i.afterLineNumber!==o&&(l=new H(i.afterLineNumber+1,1)),i.afterLineNumber>0&&(s=new H(i.afterLineNumber,t.viewModel.getLineMaxColumn(i.afterLineNumber))),l===null?a=s:s===null?a=l:e<n?a=s:a=l,{viewZoneId:i.id,afterLineNumber:i.afterLineNumber,positionBefore:s,positionAfter:l,position:a}}return null}getFullLineRangeAtCoord(t){if(this._context.viewLayout.isAfterLines(t)){let n=this._context.viewModel.getLineCount(),o=this._context.viewModel.getLineMaxColumn(n);return{range:new L(n,o,n,o),isAfterLines:!0}}let e=this._context.viewLayout.getLineNumberAtVerticalOffset(t),i=this._context.viewModel.getLineMaxColumn(e);return{range:new L(e,1,e,i),isAfterLines:!1}}getLineNumberAtVerticalOffset(t){return this._context.viewLayout.getLineNumberAtVerticalOffset(t)}isAfterLines(t){return this._context.viewLayout.isAfterLines(t)}isInTopPadding(t){return this._context.viewLayout.isInTopPadding(t)}isInBottomPadding(t){return this._context.viewLayout.isInBottomPadding(t)}getVerticalOffsetForLineNumber(t){return this._context.viewLayout.getVerticalOffsetForLineNumber(t)}findAttribute(t,e){return r._findAttribute(t,e,this._viewHelper.viewDomNode)}static _findAttribute(t,e,i){for(;t&&t!==t.ownerDocument.body;){if(t.hasAttribute&&t.hasAttribute(e))return t.getAttribute(e);if(t===i)return null;t=t.parentNode}return null}getLineWidth(t){return this._viewHelper.getLineWidth(t)}visibleRangeForPosition(t,e){return this._viewHelper.visibleRangeForPosition(t,e)}getPositionFromDOMInfo(t,e){return this._viewHelper.getPositionFromDOMInfo(t,e)}getCurrentScrollTop(){return this._context.viewLayout.getCurrentScrollTop()}getCurrentScrollLeft(){return this._context.viewLayout.getCurrentScrollLeft()}},Lq=class{editorPos;pos;relativePos;mouseVerticalOffset;isInMarginArea;isInContentArea;mouseContentHorizontalOffset;mouseColumn;constructor(t,e,i,n){this.editorPos=e,this.pos=i,this.relativePos=n,this.mouseVerticalOffset=Math.max(0,t.getCurrentScrollTop()+this.relativePos.y),this.mouseContentHorizontalOffset=t.getCurrentScrollLeft()+this.relativePos.x-t.layoutInfo.contentLeft,this.isInMarginArea=this.relativePos.x<t.layoutInfo.contentLeft&&this.relativePos.x>=t.layoutInfo.glyphMarginLeft,this.isInContentArea=!this.isInMarginArea,this.mouseColumn=Math.max(0,NE._getMouseColumn(this.mouseContentHorizontalOffset,t.typicalHalfwidthCharacterWidth))}},Rq=class extends Lq{_ctx;_eventTarget;hitTestResult=new qn(()=>NE.doHitTest(this._ctx,this));_useHitTestTarget;_targetPathCacheElement=null;_targetPathCacheValue=new Uint8Array(0);get target(){return this._useHitTestTarget?this.hitTestResult.value.hitTarget:this._eventTarget}get targetPath(){return this._targetPathCacheElement!==this.target&&(this._targetPathCacheElement=this.target,this._targetPathCacheValue=Pr.collect(this.target,this._ctx.viewDomNode)),this._targetPathCacheValue}constructor(t,e,i,n,o){super(t,e,i,n),this._ctx=t,this._eventTarget=o;let s=!!this._eventTarget;this._useHitTestTarget=!s}toString(){return`pos(${this.pos.x},${this.pos.y}), editorPos(${this.editorPos.x},${this.editorPos.y}), relativePos(${this.relativePos.x},${this.relativePos.y}), mouseVerticalOffset: ${this.mouseVerticalOffset}, mouseContentHorizontalOffset: ${this.mouseContentHorizontalOffset}
	target: ${this.target?this.target.outerHTML:null}`}get wouldBenefitFromHitTestTargetSwitch(){return!this._useHitTestTarget&&this.hitTestResult.value.hitTarget!==null&&this.target!==this.hitTestResult.value.hitTarget}switchToHitTestTarget(){this._useHitTestTarget=!0}_getMouseColumn(t=null){return t&&t.column<this._ctx.viewModel.getLineMaxColumn(t.lineNumber)?tn.visibleColumnFromColumn(this._ctx.viewModel.getLineContent(t.lineNumber),t.column,this._ctx.viewModel.model.getOptions().tabSize)+1:this.mouseColumn}fulfillUnknown(t=null){return Mr.createUnknown(this.target,this._getMouseColumn(t),t)}fulfillTextarea(){return Mr.createTextarea(this.target,this._getMouseColumn())}fulfillMargin(t,e,i,n){return Mr.createMargin(t,this.target,this._getMouseColumn(e),e,i,n)}fulfillViewZone(t,e,i){return Mr.createViewZone(t,this.target,this._getMouseColumn(e),e,i)}fulfillContentText(t,e,i){return Mr.createContentText(this.target,this._getMouseColumn(t),t,e,i)}fulfillContentEmpty(t,e){return Mr.createContentEmpty(this.target,this._getMouseColumn(t),t,e)}fulfillContentWidget(t){return Mr.createContentWidget(this.target,this._getMouseColumn(),t)}fulfillScrollbar(t){return Mr.createScrollbar(this.target,this._getMouseColumn(t),t)}fulfillOverlayWidget(t){return Mr.createOverlayWidget(this.target,this._getMouseColumn(),t)}},Tce={isAfterLines:!0};function kq(r){return{isAfterLines:!1,horizontalDistanceToText:r}}var NE=class r{_context;_viewHelper;constructor(t,e){this._context=t,this._viewHelper=e}mouseTargetIsWidget(t){let e=t.target,i=Pr.collect(e,this._viewHelper.viewDomNode);return!!(Ts.isChildOfContentWidgets(i)||Ts.isChildOfOverflowingContentWidgets(i)||Ts.isChildOfOverlayWidgets(i)||Ts.isChildOfOverflowingOverlayWidgets(i))}createMouseTarget(t,e,i,n,o){let s=new OE(this._context,this._viewHelper,t),a=new Rq(s,e,i,n,o);try{let l=r._createMouseTarget(s,a);if(l.type===6&&s.stickyTabStops&&l.position!==null){let d=r._snapToSoftTabBoundary(l.position,s.viewModel),c=L.fromPositions(d,d).plusRange(l.range);return a.fulfillContentText(d,c,l.detail)}return l}catch{return a.fulfillUnknown()}}static _createMouseTarget(t,e){if(e.target===null)return e.fulfillUnknown();let i=e,n=null;return!Ts.isChildOfOverflowGuard(e.targetPath)&&!Ts.isChildOfOverflowingContentWidgets(e.targetPath)&&!Ts.isChildOfOverflowingOverlayWidgets(e.targetPath)&&(n=n||e.fulfillUnknown()),n=n||r._hitTestContentWidget(t,i),n=n||r._hitTestOverlayWidget(t,i),n=n||r._hitTestMinimap(t,i),n=n||r._hitTestScrollbarSlider(t,i),n=n||r._hitTestViewZone(t,i),n=n||r._hitTestMargin(t,i),n=n||r._hitTestViewCursor(t,i),n=n||r._hitTestTextArea(t,i),n=n||r._hitTestViewLines(t,i),n=n||r._hitTestScrollbar(t,i),n||e.fulfillUnknown()}static _hitTestContentWidget(t,e){if(Ts.isChildOfContentWidgets(e.targetPath)||Ts.isChildOfOverflowingContentWidgets(e.targetPath)){let i=t.findAttribute(e.target,"widgetId");return i?e.fulfillContentWidget(i):e.fulfillUnknown()}return null}static _hitTestOverlayWidget(t,e){if(Ts.isChildOfOverlayWidgets(e.targetPath)||Ts.isChildOfOverflowingOverlayWidgets(e.targetPath)){let i=t.findAttribute(e.target,"widgetId");return i?e.fulfillOverlayWidget(i):e.fulfillUnknown()}return null}static _hitTestViewCursor(t,e){if(e.target){let i=t.lastRenderData.lastViewCursorsRenderData;for(let n of i)if(e.target===n.domNode)return e.fulfillContentText(n.position,null,{mightBeForeignElement:!1,injectedText:null})}if(e.isInContentArea){let i=t.lastRenderData.lastViewCursorsRenderData,n=e.mouseContentHorizontalOffset,o=e.mouseVerticalOffset;for(let s of i){if(n<s.contentLeft||n>s.contentLeft+s.width)continue;let a=t.getVerticalOffsetForLineNumber(s.position.lineNumber);if(a<=o&&o<=a+s.height)return e.fulfillContentText(s.position,null,{mightBeForeignElement:!1,injectedText:null})}}return null}static _hitTestViewZone(t,e){let i=t.getZoneAtCoord(e.mouseVerticalOffset);if(i){let n=e.isInContentArea?8:5;return e.fulfillViewZone(n,i.position,i)}return null}static _hitTestTextArea(t,e){return Ts.isTextArea(e.targetPath)?t.lastRenderData.lastTextareaPosition?e.fulfillContentText(t.lastRenderData.lastTextareaPosition,null,{mightBeForeignElement:!1,injectedText:null}):e.fulfillTextarea():null}static _hitTestMargin(t,e){if(e.isInMarginArea){let i=t.getFullLineRangeAtCoord(e.mouseVerticalOffset),n=i.range.getStartPosition(),o=Math.abs(e.relativePos.x),s={isAfterLines:i.isAfterLines,glyphMarginLeft:t.layoutInfo.glyphMarginLeft,glyphMarginWidth:t.layoutInfo.glyphMarginWidth,lineNumbersWidth:t.layoutInfo.lineNumbersWidth,offsetX:o};if(o-=t.layoutInfo.glyphMarginLeft,o<=t.layoutInfo.glyphMarginWidth){let a=t.viewModel.coordinatesConverter.convertViewPositionToModelPosition(i.range.getStartPosition()),l=t.viewModel.glyphLanes.getLanesAtLine(a.lineNumber);return s.glyphMarginLane=l[Math.floor(o/t.lineHeight)],e.fulfillMargin(2,n,i.range,s)}return o-=t.layoutInfo.glyphMarginWidth,o<=t.layoutInfo.lineNumbersWidth?e.fulfillMargin(3,n,i.range,s):(o-=t.layoutInfo.lineNumbersWidth,e.fulfillMargin(4,n,i.range,s))}return null}static _hitTestViewLines(t,e){if(!Ts.isChildOfViewLines(e.targetPath))return null;if(t.isInTopPadding(e.mouseVerticalOffset))return e.fulfillContentEmpty(new H(1,1),Tce);if(t.isAfterLines(e.mouseVerticalOffset)||t.isInBottomPadding(e.mouseVerticalOffset)){let n=t.viewModel.getLineCount(),o=t.viewModel.getLineMaxColumn(n);return e.fulfillContentEmpty(new H(n,o),Tce)}if(Ts.isStrictChildOfViewLines(e.targetPath)){let n=t.getLineNumberAtVerticalOffset(e.mouseVerticalOffset);if(t.viewModel.getLineLength(n)===0){let s=t.getLineWidth(n),a=kq(e.mouseContentHorizontalOffset-s);return e.fulfillContentEmpty(new H(n,1),a)}let o=t.getLineWidth(n);if(e.mouseContentHorizontalOffset>=o){let s=kq(e.mouseContentHorizontalOffset-o),a=new H(n,t.viewModel.getLineMaxColumn(n));return e.fulfillContentEmpty(a,s)}}let i=e.hitTestResult.value;return i.type===1?r.createMouseTargetFromHitTestPosition(t,e,i.spanNode,i.position,i.injectedText):e.wouldBenefitFromHitTestTargetSwitch?(e.switchToHitTestTarget(),this._createMouseTarget(t,e)):e.fulfillUnknown()}static _hitTestMinimap(t,e){if(Ts.isChildOfMinimap(e.targetPath)){let i=t.getLineNumberAtVerticalOffset(e.mouseVerticalOffset),n=t.viewModel.getLineMaxColumn(i);return e.fulfillScrollbar(new H(i,n))}return null}static _hitTestScrollbarSlider(t,e){if(Ts.isChildOfScrollableElement(e.targetPath)&&e.target&&e.target.nodeType===1){let i=e.target.className;if(i&&/\b(slider|scrollbar)\b/.test(i)){let n=t.getLineNumberAtVerticalOffset(e.mouseVerticalOffset),o=t.viewModel.getLineMaxColumn(n);return e.fulfillScrollbar(new H(n,o))}}return null}static _hitTestScrollbar(t,e){if(Ts.isChildOfScrollableElement(e.targetPath)){let i=t.getLineNumberAtVerticalOffset(e.mouseVerticalOffset),n=t.viewModel.getLineMaxColumn(i);return e.fulfillScrollbar(new H(i,n))}return null}getMouseColumn(t){let e=this._context.configuration.options,i=e.get(147),n=this._context.viewLayout.getCurrentScrollLeft()+t.x-i.contentLeft;return r._getMouseColumn(n,e.get(51).typicalHalfwidthCharacterWidth)}static _getMouseColumn(t,e){return t<0?1:Math.round(t/e)+1}static createMouseTargetFromHitTestPosition(t,e,i,n,o){let s=n.lineNumber,a=n.column,l=t.getLineWidth(s);if(e.mouseContentHorizontalOffset>l){let I=kq(e.mouseContentHorizontalOffset-l);return e.fulfillContentEmpty(n,I)}let d=t.visibleRangeForPosition(s,a);if(!d)return e.fulfillUnknown(n);let c=d.left;if(Math.abs(e.mouseContentHorizontalOffset-c)<1)return e.fulfillContentText(n,null,{mightBeForeignElement:!!o,injectedText:o});let p=[];if(p.push({offset:d.left,column:a}),a>1){let I=t.visibleRangeForPosition(s,a-1);I&&p.push({offset:I.left,column:a-1})}let h=t.viewModel.getLineMaxColumn(s);if(a<h){let I=t.visibleRangeForPosition(s,a+1);I&&p.push({offset:I.left,column:a+1})}p.sort((I,y)=>I.offset-y.offset);let m=e.pos.toClientCoordinates(ue(t.viewDomNode)),f=i.getBoundingClientRect(),g=f.left<=m.clientX&&m.clientX<=f.right,v=null;for(let I=1;I<p.length;I++){let y=p[I-1],w=p[I];if(y.offset<=e.mouseContentHorizontalOffset&&e.mouseContentHorizontalOffset<=w.offset){v=new L(s,y.column,s,w.column);let C=Math.abs(y.offset-e.mouseContentHorizontalOffset),S=Math.abs(w.offset-e.mouseContentHorizontalOffset);n=C<S?new H(s,y.column):new H(s,w.column);break}}return e.fulfillContentText(n,v,{mightBeForeignElement:!g||!!o,injectedText:o})}static _doHitTestWithCaretRangeFromPoint(t,e){let i=t.getLineNumberAtVerticalOffset(e.mouseVerticalOffset),n=t.getVerticalOffsetForLineNumber(i),o=n+t.lineHeight;if(!(i===t.viewModel.getLineCount()&&e.mouseVerticalOffset>o)){let a=Math.floor((n+o)/2),l=e.pos.y+(a-e.mouseVerticalOffset);l<=e.editorPos.y&&(l=e.editorPos.y+1),l>=e.editorPos.y+e.editorPos.height&&(l=e.editorPos.y+e.editorPos.height-1);let d=new Lb(e.pos.x,l),c=this._actualDoHitTestWithCaretRangeFromPoint(t,d.toClientCoordinates(ue(t.viewDomNode)));if(c.type===1)return c}return this._actualDoHitTestWithCaretRangeFromPoint(t,e.pos.toClientCoordinates(ue(t.viewDomNode)))}static _actualDoHitTestWithCaretRangeFromPoint(t,e){let i=tu(t.viewDomNode),n;if(i?typeof i.caretRangeFromPoint>"u"?n=PEe(i,e.clientX,e.clientY):n=i.caretRangeFromPoint(e.clientX,e.clientY):n=t.viewDomNode.ownerDocument.caretRangeFromPoint(e.clientX,e.clientY),!n||!n.startContainer)return new Lh;let o=n.startContainer;if(o.nodeType===o.TEXT_NODE){let s=o.parentNode,a=s?s.parentNode:null,l=a?a.parentNode:null;return(l&&l.nodeType===l.ELEMENT_NODE?l.className:null)===Ou.CLASS_NAME?AE.createFromDOMInfo(t,s,n.startOffset):new Lh(o.parentNode)}else if(o.nodeType===o.ELEMENT_NODE){let s=o.parentNode,a=s?s.parentNode:null;return(a&&a.nodeType===a.ELEMENT_NODE?a.className:null)===Ou.CLASS_NAME?AE.createFromDOMInfo(t,o,o.textContent.length):new Lh(o)}return new Lh}static _doHitTestWithCaretPositionFromPoint(t,e){let i=t.viewDomNode.ownerDocument.caretPositionFromPoint(e.clientX,e.clientY);if(i.offsetNode.nodeType===i.offsetNode.TEXT_NODE){let n=i.offsetNode.parentNode,o=n?n.parentNode:null,s=o?o.parentNode:null;return(s&&s.nodeType===s.ELEMENT_NODE?s.className:null)===Ou.CLASS_NAME?AE.createFromDOMInfo(t,i.offsetNode.parentNode,i.offset):new Lh(i.offsetNode.parentNode)}if(i.offsetNode.nodeType===i.offsetNode.ELEMENT_NODE){let n=i.offsetNode.parentNode,o=n&&n.nodeType===n.ELEMENT_NODE?n.className:null,s=n?n.parentNode:null,a=s&&s.nodeType===s.ELEMENT_NODE?s.className:null;if(o===Ou.CLASS_NAME){let l=i.offsetNode.childNodes[Math.min(i.offset,i.offsetNode.childNodes.length-1)];if(l)return AE.createFromDOMInfo(t,l,0)}else if(a===Ou.CLASS_NAME)return AE.createFromDOMInfo(t,i.offsetNode,0)}return new Lh(i.offsetNode)}static _snapToSoftTabBoundary(t,e){let i=e.getLineContent(t.lineNumber),{tabSize:n}=e.model.getOptions(),o=by.atomicPosition(i,t.column-1,n,2);return o!==-1?new H(t.lineNumber,o+1):t}static doHitTest(t,e){let i=new Lh;if(typeof t.viewDomNode.ownerDocument.caretRangeFromPoint=="function"?i=this._doHitTestWithCaretRangeFromPoint(t,e):t.viewDomNode.ownerDocument.caretPositionFromPoint&&(i=this._doHitTestWithCaretPositionFromPoint(t,e.pos.toClientCoordinates(ue(t.viewDomNode)))),i.type===1){let n=t.viewModel.getInjectedTextAt(i.position),o=t.viewModel.normalizePosition(i.position,2);(n||!o.equals(i.position))&&(i=new GV(o,i.spanNode,n))}return i}};function PEe(r,t,e){let i=document.createRange(),n=r.elementFromPoint(t,e);if(n!==null){for(;n&&n.firstChild&&n.firstChild.nodeType!==n.firstChild.TEXT_NODE&&n.lastChild&&n.lastChild.firstChild;)n=n.lastChild;let o=n.getBoundingClientRect(),s=ue(n),a=s.getComputedStyle(n,null).getPropertyValue("font-style"),l=s.getComputedStyle(n,null).getPropertyValue("font-variant"),d=s.getComputedStyle(n,null).getPropertyValue("font-weight"),c=s.getComputedStyle(n,null).getPropertyValue("font-size"),p=s.getComputedStyle(n,null).getPropertyValue("line-height"),h=s.getComputedStyle(n,null).getPropertyValue("font-family"),m=`${a} ${l} ${d} ${c}/${p} ${h}`,f=n.innerText,g=o.left,v=0,I;if(t>o.left+o.width)v=f.length;else{let y=Pq.getInstance();for(let w=0;w<f.length+1;w++){if(I=y.getCharWidth(f.charAt(w),m)/2,g+=I,t<g){v=w;break}g+=I}}i.setStart(n.firstChild,v),i.setEnd(n.firstChild,v)}return i}var Pq=class r{static _INSTANCE=null;static getInstance(){return r._INSTANCE||(r._INSTANCE=new r),r._INSTANCE}_cache;_canvas;constructor(){this._cache={},this._canvas=document.createElement("canvas")}getCharWidth(t,e){let i=t+e;if(this._cache[i])return this._cache[i];let n=this._canvas.getContext("2d");n.font=e;let s=n.measureText(t).width;return this._cache[i]=s,s}};var Pb=class r{static columnSelect(t,e,i,n,o,s){let a=Math.abs(o-i)+1,l=i>o,d=n>s,c=n<s,p=[];for(let h=0;h<a;h++){let m=i+(l?-h:h),f=t.columnFromVisibleColumn(e,m,n),g=t.columnFromVisibleColumn(e,m,s),v=t.visibleColumnFromColumn(e,new H(m,f)),I=t.visibleColumnFromColumn(e,new H(m,g));c&&(v>s||I<n)||d&&(I>n||v<s)||p.push(new No(new L(m,f,m,f),0,0,new H(m,g),0))}if(p.length===0)for(let h=0;h<a;h++){let m=i+(l?-h:h),f=e.getLineMaxColumn(m);p.push(new No(new L(m,f,m,f),0,0,new H(m,f),0))}return{viewStates:p,reversed:l,fromLineNumber:i,fromVisualColumn:n,toLineNumber:o,toVisualColumn:s}}static columnSelectLeft(t,e,i){let n=i.toViewVisualColumn;return n>0&&n--,r.columnSelect(t,e,i.fromViewLineNumber,i.fromViewVisualColumn,i.toViewLineNumber,n)}static columnSelectRight(t,e,i){let n=0,o=Math.min(i.fromViewLineNumber,i.toViewLineNumber),s=Math.max(i.fromViewLineNumber,i.toViewLineNumber);for(let l=o;l<=s;l++){let d=e.getLineMaxColumn(l),c=t.visibleColumnFromColumn(e,new H(l,d));n=Math.max(n,c)}let a=i.toViewVisualColumn;return a<n&&a++,this.columnSelect(t,e,i.fromViewLineNumber,i.fromViewVisualColumn,i.toViewLineNumber,a)}static columnSelectUp(t,e,i,n){let o=n?t.pageSize:1,s=Math.max(1,i.toViewLineNumber-o);return this.columnSelect(t,e,i.fromViewLineNumber,i.fromViewVisualColumn,s,i.toViewVisualColumn)}static columnSelectDown(t,e,i,n){let o=n?t.pageSize:1,s=Math.min(e.getLineCount(),i.toViewLineNumber+o);return this.columnSelect(t,e,i.fromViewLineNumber,i.fromViewVisualColumn,s,i.toViewVisualColumn)}};var _s=class{_range;_text;insertsAutoWhitespace;constructor(t,e,i=!1){this._range=t,this._text=e,this.insertsAutoWhitespace=i}getEditOperations(t,e){e.addTrackedEditOperation(this._range,this._text)}computeCursorState(t,e){let n=e.getInverseEditOperations()[0].range;return Et.fromPositions(n.getEndPosition())}};var Iy=class{_range;_text;insertsAutoWhitespace;constructor(t,e,i=!1){this._range=t,this._text=e,this.insertsAutoWhitespace=i}getEditOperations(t,e){e.addTrackedEditOperation(this._range,this._text)}computeCursorState(t,e){let n=e.getInverseEditOperations()[0].range;return Et.fromPositions(n.getStartPosition())}},yy=class{_range;_text;_columnDeltaOffset;_lineNumberDeltaOffset;insertsAutoWhitespace;constructor(t,e,i,n,o=!1){this._range=t,this._text=e,this._columnDeltaOffset=n,this._lineNumberDeltaOffset=i,this.insertsAutoWhitespace=o}getEditOperations(t,e){e.addTrackedEditOperation(this._range,this._text)}computeCursorState(t,e){let n=e.getInverseEditOperations()[0].range;return Et.fromPositions(n.getEndPosition().delta(this._lineNumberDeltaOffset,this._columnDeltaOffset))}},jV=class{_range;_text;_initialSelection;_forceMoveMarkers;_selectionId;constructor(t,e,i,n=!1){this._range=t,this._text=e,this._initialSelection=i,this._forceMoveMarkers=n,this._selectionId=null}getEditOperations(t,e){e.addTrackedEditOperation(this._range,this._text,this._forceMoveMarkers),this._selectionId=e.trackSelection(this._initialSelection)}computeCursorState(t,e){return e.getTrackedSelection(this._selectionId)}};var uR=class{_cursorPositionBrand=void 0;lineNumber;column;leftoverVisibleColumns;constructor(t,e,i){this.lineNumber=t,this.column=e,this.leftoverVisibleColumns=i}},ao=class r{static leftPosition(t,e){if(e.column>t.getLineMinColumn(e.lineNumber))return e.delta(void 0,-v4(t.getLineContent(e.lineNumber),e.column-1));if(e.lineNumber>1){let i=e.lineNumber-1;return new H(i,t.getLineMaxColumn(i))}else return e}static leftPositionAtomicSoftTabs(t,e,i){if(e.column<=t.getLineIndentColumn(e.lineNumber)){let n=t.getLineMinColumn(e.lineNumber),o=t.getLineContent(e.lineNumber),s=by.atomicPosition(o,e.column-1,i,0);if(s!==-1&&s+1>=n)return new H(e.lineNumber,s+1)}return this.leftPosition(t,e)}static left(t,e,i){let n=t.stickyTabStops?r.leftPositionAtomicSoftTabs(e,i,t.tabSize):r.leftPosition(e,i);return new uR(n.lineNumber,n.column,0)}static moveLeft(t,e,i,n,o){let s,a;if(i.hasSelection()&&!n)s=i.selection.startLineNumber,a=i.selection.startColumn;else{let l=i.position.delta(void 0,-(o-1)),d=e.normalizePosition(r.clipPositionColumn(l,e),0),c=r.left(t,e,d);s=c.lineNumber,a=c.column}return i.move(n,s,a,0)}static clipPositionColumn(t,e){return new H(t.lineNumber,r.clipRange(t.column,e.getLineMinColumn(t.lineNumber),e.getLineMaxColumn(t.lineNumber)))}static clipRange(t,e,i){return t<e?e:t>i?i:t}static rightPosition(t,e,i){return i<t.getLineMaxColumn(e)?i=i+W_(t.getLineContent(e),i-1):e<t.getLineCount()&&(e=e+1,i=t.getLineMinColumn(e)),new H(e,i)}static rightPositionAtomicSoftTabs(t,e,i,n,o){if(i<t.getLineIndentColumn(e)){let s=t.getLineContent(e),a=by.atomicPosition(s,i-1,n,1);if(a!==-1)return new H(e,a+1)}return this.rightPosition(t,e,i)}static right(t,e,i){let n=t.stickyTabStops?r.rightPositionAtomicSoftTabs(e,i.lineNumber,i.column,t.tabSize,t.indentSize):r.rightPosition(e,i.lineNumber,i.column);return new uR(n.lineNumber,n.column,0)}static moveRight(t,e,i,n,o){let s,a;if(i.hasSelection()&&!n)s=i.selection.endLineNumber,a=i.selection.endColumn;else{let l=i.position.delta(void 0,o-1),d=e.normalizePosition(r.clipPositionColumn(l,e),1),c=r.right(t,e,d);s=c.lineNumber,a=c.column}return i.move(n,s,a,0)}static vertical(t,e,i,n,o,s,a,l){let d=tn.visibleColumnFromColumn(e.getLineContent(i),n,t.tabSize)+o,c=e.getLineCount(),p=i===1&&n===1,h=i===c&&n===e.getLineMaxColumn(i),m=s<i?p:h;if(i=s,i<1?(i=1,a?n=e.getLineMinColumn(i):n=Math.min(e.getLineMaxColumn(i),n)):i>c?(i=c,a?n=e.getLineMaxColumn(i):n=Math.min(e.getLineMaxColumn(i),n)):n=t.columnFromVisibleColumn(e,i,d),m?o=0:o=d-tn.visibleColumnFromColumn(e.getLineContent(i),n,t.tabSize),l!==void 0){let f=new H(i,n),g=e.normalizePosition(f,l);o=o+(n-g.column),i=g.lineNumber,n=g.column}return new uR(i,n,o)}static down(t,e,i,n,o,s,a){return this.vertical(t,e,i,n,o,i+s,a,4)}static moveDown(t,e,i,n,o){let s,a;i.hasSelection()&&!n?(s=i.selection.endLineNumber,a=i.selection.endColumn):(s=i.position.lineNumber,a=i.position.column);let l=0,d;do if(d=r.down(t,e,s+l,a,i.leftoverVisibleColumns,o,!0),e.normalizePosition(new H(d.lineNumber,d.column),2).lineNumber>s)break;while(l++<10&&s+l<e.getLineCount());return i.move(n,d.lineNumber,d.column,d.leftoverVisibleColumns)}static translateDown(t,e,i){let n=i.selection,o=r.down(t,e,n.selectionStartLineNumber,n.selectionStartColumn,i.selectionStartLeftoverVisibleColumns,1,!1),s=r.down(t,e,n.positionLineNumber,n.positionColumn,i.leftoverVisibleColumns,1,!1);return new No(new L(o.lineNumber,o.column,o.lineNumber,o.column),0,o.leftoverVisibleColumns,new H(s.lineNumber,s.column),s.leftoverVisibleColumns)}static up(t,e,i,n,o,s,a){return this.vertical(t,e,i,n,o,i-s,a,3)}static moveUp(t,e,i,n,o){let s,a;i.hasSelection()&&!n?(s=i.selection.startLineNumber,a=i.selection.startColumn):(s=i.position.lineNumber,a=i.position.column);let l=r.up(t,e,s,a,i.leftoverVisibleColumns,o,!0);return i.move(n,l.lineNumber,l.column,l.leftoverVisibleColumns)}static translateUp(t,e,i){let n=i.selection,o=r.up(t,e,n.selectionStartLineNumber,n.selectionStartColumn,i.selectionStartLeftoverVisibleColumns,1,!1),s=r.up(t,e,n.positionLineNumber,n.positionColumn,i.leftoverVisibleColumns,1,!1);return new No(new L(o.lineNumber,o.column,o.lineNumber,o.column),0,o.leftoverVisibleColumns,new H(s.lineNumber,s.column),s.leftoverVisibleColumns)}static _isBlankLine(t,e){return t.getLineFirstNonWhitespaceColumn(e)===0}static moveToPrevBlankLine(t,e,i,n){let o=i.position.lineNumber;for(;o>1&&this._isBlankLine(e,o);)o--;for(;o>1&&!this._isBlankLine(e,o);)o--;return i.move(n,o,e.getLineMinColumn(o),0)}static moveToNextBlankLine(t,e,i,n){let o=e.getLineCount(),s=i.position.lineNumber;for(;s<o&&this._isBlankLine(e,s);)s++;for(;s<o&&!this._isBlankLine(e,s);)s++;return i.move(n,s,e.getLineMinColumn(s),0)}static moveToBeginningOfLine(t,e,i,n){let o=i.position.lineNumber,s=e.getLineMinColumn(o),a=e.getLineFirstNonWhitespaceColumn(o)||s,l;return i.position.column===a?l=s:l=a,i.move(n,o,l,0)}static moveToEndOfLine(t,e,i,n,o){let s=i.position.lineNumber,a=e.getLineMaxColumn(s);return i.move(n,s,a,o?1073741824-a:0)}static moveToBeginningOfBuffer(t,e,i,n){return i.move(n,1,1,0)}static moveToEndOfBuffer(t,e,i,n){let o=e.getLineCount(),s=e.getLineMaxColumn(o);return i.move(n,o,s,0)}};var ug=class r{static deleteRight(t,e,i,n){let o=[],s=t!==3;for(let a=0,l=n.length;a<l;a++){let d=n[a],c=d;if(c.isEmpty()){let p=d.getPosition(),h=ao.right(e,i,p);c=new L(h.lineNumber,h.column,p.lineNumber,p.column)}if(c.isEmpty()){o[a]=null;continue}c.startLineNumber!==c.endLineNumber&&(s=!0),o[a]=new _s(c,"")}return[s,o]}static isAutoClosingPairDelete(t,e,i,n,o,s,a){if(e==="never"&&i==="never"||t==="never")return!1;for(let l=0,d=s.length;l<d;l++){let c=s[l],p=c.getPosition();if(!c.isEmpty())return!1;let h=o.getLineContent(p.lineNumber);if(p.column<2||p.column>=h.length+1)return!1;let m=h.charAt(p.column-2),f=n.get(m);if(!f)return!1;if(mu(m)){if(i==="never")return!1}else if(e==="never")return!1;let g=h.charAt(p.column-1),v=!1;for(let I of f)I.open===m&&I.close===g&&(v=!0);if(!v)return!1;if(t==="auto"){let I=!1;for(let y=0,w=a.length;y<w;y++){let C=a[y];if(p.lineNumber===C.startLineNumber&&p.column===C.startColumn){I=!0;break}}if(!I)return!1}}return!0}static _runAutoClosingPairDelete(t,e,i){let n=[];for(let o=0,s=i.length;o<s;o++){let a=i[o].getPosition(),l=new L(a.lineNumber,a.column-1,a.lineNumber,a.column+1);n[o]=new _s(l,"")}return[!0,n]}static deleteLeft(t,e,i,n,o){if(this.isAutoClosingPairDelete(e.autoClosingDelete,e.autoClosingBrackets,e.autoClosingQuotes,e.autoClosingPairs.autoClosingPairsOpenByEnd,i,n,o))return this._runAutoClosingPairDelete(e,i,n);let s=[],a=t!==2;for(let l=0,d=n.length;l<d;l++){let c=r.getDeleteRange(n[l],i,e);if(c.isEmpty()){s[l]=null;continue}c.startLineNumber!==c.endLineNumber&&(a=!0),s[l]=new _s(c,"")}return[a,s]}static getDeleteRange(t,e,i){if(!t.isEmpty())return t;let n=t.getPosition();if(i.useTabStops&&n.column>1){let o=e.getLineContent(n.lineNumber),s=Jn(o),a=s===-1?o.length+1:s+1;if(n.column<=a){let l=i.visibleColumnFromColumn(e,n),d=tn.prevIndentTabStop(l,i.indentSize),c=i.columnFromVisibleColumn(e,n.lineNumber,d);return new L(n.lineNumber,c,n.lineNumber,n.column)}}return L.fromPositions(r.getPositionAfterDeleteLeft(n,e),n)}static getPositionAfterDeleteLeft(t,e){if(t.column>1){let i=bee(t.column-1,e.getLineContent(t.lineNumber));return t.with(void 0,i+1)}else if(t.lineNumber>1){let i=t.lineNumber-1;return new H(i,e.getLineMaxColumn(i))}else return t}static cut(t,e,i){let n=[],o=null;i.sort((s,a)=>H.compare(s.getStartPosition(),a.getEndPosition()));for(let s=0,a=i.length;s<a;s++){let l=i[s];if(l.isEmpty())if(t.emptySelectionClipboard){let d=l.getPosition(),c,p,h,m;d.lineNumber<e.getLineCount()?(c=d.lineNumber,p=1,h=d.lineNumber+1,m=1):d.lineNumber>1&&o?.endLineNumber!==d.lineNumber?(c=d.lineNumber-1,p=e.getLineMaxColumn(d.lineNumber-1),h=d.lineNumber,m=e.getLineMaxColumn(d.lineNumber)):(c=d.lineNumber,p=1,h=d.lineNumber,m=e.getLineMaxColumn(d.lineNumber));let f=new L(c,p,h,m);o=f,f.isEmpty()?n[s]=null:n[s]=new _s(f,"")}else n[s]=null;else n[s]=new _s(l,"")}return new hr(0,n,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}};var FE=class r{static _createWord(t,e,i,n,o){return{start:n,end:o,wordType:e,nextCharClass:i}}static _createIntlWord(t,e){return{start:t.index,end:t.index+t.segment.length,wordType:1,nextCharClass:e}}static _findPreviousWordOnLine(t,e,i){let n=e.getLineContent(i.lineNumber);return this._doFindPreviousWordOnLine(n,t,i)}static _doFindPreviousWordOnLine(t,e,i){let n=0,o=e.findPrevIntlWordBeforeOrAtOffset(t,i.column-2);for(let s=i.column-2;s>=0;s--){let a=t.charCodeAt(s),l=e.get(a);if(o&&s===o.index)return this._createIntlWord(o,l);if(l===0){if(n===2)return this._createWord(t,n,l,s+1,this._findEndOfWord(t,e,n,s+1));n=1}else if(l===2){if(n===1)return this._createWord(t,n,l,s+1,this._findEndOfWord(t,e,n,s+1));n=2}else if(l===1&&n!==0)return this._createWord(t,n,l,s+1,this._findEndOfWord(t,e,n,s+1))}return n!==0?this._createWord(t,n,1,0,this._findEndOfWord(t,e,n,0)):null}static _findEndOfWord(t,e,i,n){let o=e.findNextIntlWordAtOrAfterOffset(t,n),s=t.length;for(let a=n;a<s;a++){let l=t.charCodeAt(a),d=e.get(l);if(o&&a===o.index+o.segment.length||d===1||i===1&&d===2||i===2&&d===0)return a}return s}static _findNextWordOnLine(t,e,i){let n=e.getLineContent(i.lineNumber);return this._doFindNextWordOnLine(n,t,i)}static _doFindNextWordOnLine(t,e,i){let n=0,o=t.length,s=e.findNextIntlWordAtOrAfterOffset(t,i.column-1);for(let a=i.column-1;a<o;a++){let l=t.charCodeAt(a),d=e.get(l);if(s&&a===s.index)return this._createIntlWord(s,d);if(d===0){if(n===2)return this._createWord(t,n,d,this._findStartOfWord(t,e,n,a-1),a);n=1}else if(d===2){if(n===1)return this._createWord(t,n,d,this._findStartOfWord(t,e,n,a-1),a);n=2}else if(d===1&&n!==0)return this._createWord(t,n,d,this._findStartOfWord(t,e,n,a-1),a)}return n!==0?this._createWord(t,n,1,this._findStartOfWord(t,e,n,o-1),o):null}static _findStartOfWord(t,e,i,n){let o=e.findPrevIntlWordBeforeOrAtOffset(t,n);for(let s=n;s>=0;s--){let a=t.charCodeAt(s),l=e.get(a);if(o&&s===o.index)return s;if(l===1||i===1&&l===2||i===2&&l===0)return s+1}return 0}static moveWordLeft(t,e,i,n,o){let s=i.lineNumber,a=i.column;a===1&&s>1&&(s=s-1,a=e.getLineMaxColumn(s));let l=r._findPreviousWordOnLine(t,e,new H(s,a));if(n===0)return new H(s,l?l.start+1:1);if(n===1)return!o&&l&&l.wordType===2&&l.end-l.start===1&&l.nextCharClass===0&&(l=r._findPreviousWordOnLine(t,e,new H(s,l.start+1))),new H(s,l?l.start+1:1);if(n===3){for(;l&&l.wordType===2;)l=r._findPreviousWordOnLine(t,e,new H(s,l.start+1));return new H(s,l?l.start+1:1)}return l&&a<=l.end+1&&(l=r._findPreviousWordOnLine(t,e,new H(s,l.start+1))),new H(s,l?l.end+1:1)}static _moveWordPartLeft(t,e){let i=e.lineNumber,n=t.getLineMaxColumn(i);if(e.column===1)return i>1?new H(i-1,t.getLineMaxColumn(i-1)):e;let o=t.getLineContent(i);for(let s=e.column-1;s>1;s--){let a=o.charCodeAt(s-2),l=o.charCodeAt(s-1);if(a===95&&l!==95)return new H(i,s);if(a===45&&l!==45)return new H(i,s);if((Uv(a)||V_(a))&&Ep(l))return new H(i,s);if(Ep(a)&&Ep(l)&&s+1<n){let d=o.charCodeAt(s);if(Uv(d)||V_(d))return new H(i,s)}}return new H(i,1)}static moveWordRight(t,e,i,n){let o=i.lineNumber,s=i.column,a=!1;s===e.getLineMaxColumn(o)&&o<e.getLineCount()&&(a=!0,o=o+1,s=1);let l=r._findNextWordOnLine(t,e,new H(o,s));if(n===2)l&&l.wordType===2&&l.end-l.start===1&&l.nextCharClass===0&&(l=r._findNextWordOnLine(t,e,new H(o,l.end+1))),l?s=l.end+1:s=e.getLineMaxColumn(o);else if(n===3){for(a&&(s=0);l&&(l.wordType===2||l.start+1<=s);)l=r._findNextWordOnLine(t,e,new H(o,l.end+1));l?s=l.start+1:s=e.getLineMaxColumn(o)}else l&&!a&&s>=l.start+1&&(l=r._findNextWordOnLine(t,e,new H(o,l.end+1))),l?s=l.start+1:s=e.getLineMaxColumn(o);return new H(o,s)}static _moveWordPartRight(t,e){let i=e.lineNumber,n=t.getLineMaxColumn(i);if(e.column===n)return i<t.getLineCount()?new H(i+1,1):e;let o=t.getLineContent(i);for(let s=e.column+1;s<n;s++){let a=o.charCodeAt(s-2),l=o.charCodeAt(s-1);if(a!==95&&l===95)return new H(i,s);if(a!==45&&l===45)return new H(i,s);if((Uv(a)||V_(a))&&Ep(l))return new H(i,s);if(Ep(a)&&Ep(l)&&s+1<n){let d=o.charCodeAt(s);if(Uv(d)||V_(d))return new H(i,s)}}return new H(i,n)}static _deleteWordLeftWhitespace(t,e){let i=t.getLineContent(e.lineNumber),n=e.column-2,o=fd(i,n);return o+1<n?new L(e.lineNumber,o+2,e.lineNumber,e.column):null}static deleteWordLeft(t,e){let i=t.wordSeparators,n=t.model,o=t.selection,s=t.whitespaceHeuristics;if(!o.isEmpty())return o;if(ug.isAutoClosingPairDelete(t.autoClosingDelete,t.autoClosingBrackets,t.autoClosingQuotes,t.autoClosingPairs.autoClosingPairsOpenByEnd,t.model,[t.selection],t.autoClosedCharacters)){let p=t.selection.getPosition();return new L(p.lineNumber,p.column-1,p.lineNumber,p.column+1)}let a=new H(o.positionLineNumber,o.positionColumn),l=a.lineNumber,d=a.column;if(l===1&&d===1)return null;if(s){let p=this._deleteWordLeftWhitespace(n,a);if(p)return p}let c=r._findPreviousWordOnLine(i,n,a);return e===0?c?d=c.start+1:d>1?d=1:(l--,d=n.getLineMaxColumn(l)):(c&&d<=c.end+1&&(c=r._findPreviousWordOnLine(i,n,new H(l,c.start+1))),c?d=c.end+1:d>1?d=1:(l--,d=n.getLineMaxColumn(l))),new L(l,d,a.lineNumber,a.column)}static deleteInsideWord(t,e,i){if(!i.isEmpty())return i;let n=new H(i.positionLineNumber,i.positionColumn),o=this._deleteInsideWordWhitespace(e,n);return o||this._deleteInsideWordDetermineDeleteRange(t,e,n)}static _charAtIsWhitespace(t,e){let i=t.charCodeAt(e);return i===32||i===9}static _deleteInsideWordWhitespace(t,e){let i=t.getLineContent(e.lineNumber),n=i.length;if(n===0)return null;let o=Math.max(e.column-2,0);if(!this._charAtIsWhitespace(i,o))return null;let s=Math.min(e.column-1,n-1);if(!this._charAtIsWhitespace(i,s))return null;for(;o>0&&this._charAtIsWhitespace(i,o-1);)o--;for(;s+1<n&&this._charAtIsWhitespace(i,s+1);)s++;return new L(e.lineNumber,o+1,e.lineNumber,s+2)}static _deleteInsideWordDetermineDeleteRange(t,e,i){let n=e.getLineContent(i.lineNumber),o=n.length;if(o===0)return i.lineNumber>1?new L(i.lineNumber-1,e.getLineMaxColumn(i.lineNumber-1),i.lineNumber,1):i.lineNumber<e.getLineCount()?new L(i.lineNumber,1,i.lineNumber+1,1):new L(i.lineNumber,1,i.lineNumber,1);let s=p=>p.start+1<=i.column&&i.column<=p.end+1,a=(p,h)=>(p=Math.min(p,i.column),h=Math.max(h,i.column),new L(i.lineNumber,p,i.lineNumber,h)),l=p=>{let h=p.start+1,m=p.end+1,f=!1;for(;m-1<o&&this._charAtIsWhitespace(n,m-1);)f=!0,m++;if(!f)for(;h>1&&this._charAtIsWhitespace(n,h-2);)h--;return a(h,m)},d=r._findPreviousWordOnLine(t,e,i);if(d&&s(d))return l(d);let c=r._findNextWordOnLine(t,e,i);return c&&s(c)?l(c):d&&c?a(d.end+1,c.start+1):d?a(d.start+1,d.end+1):c?a(c.start+1,c.end+1):a(1,o+1)}static _deleteWordPartLeft(t,e){if(!e.isEmpty())return e;let i=e.getPosition(),n=r._moveWordPartLeft(t,i);return new L(i.lineNumber,i.column,n.lineNumber,n.column)}static _findFirstNonWhitespaceChar(t,e){let i=t.length;for(let n=e;n<i;n++){let o=t.charAt(n);if(o!==" "&&o!=="	")return n}return i}static _deleteWordRightWhitespace(t,e){let i=t.getLineContent(e.lineNumber),n=e.column-1,o=this._findFirstNonWhitespaceChar(i,n);return n+1<o?new L(e.lineNumber,e.column,e.lineNumber,o+1):null}static deleteWordRight(t,e){let i=t.wordSeparators,n=t.model,o=t.selection,s=t.whitespaceHeuristics;if(!o.isEmpty())return o;let a=new H(o.positionLineNumber,o.positionColumn),l=a.lineNumber,d=a.column,c=n.getLineCount(),p=n.getLineMaxColumn(l);if(l===c&&d===p)return null;if(s){let m=this._deleteWordRightWhitespace(n,a);if(m)return m}let h=r._findNextWordOnLine(i,n,a);return e===2?h?d=h.end+1:d<p||l===c?d=p:(l++,h=r._findNextWordOnLine(i,n,new H(l,1)),h?d=h.start+1:d=n.getLineMaxColumn(l)):(h&&d>=h.start+1&&(h=r._findNextWordOnLine(i,n,new H(l,h.end+1))),h?d=h.start+1:d<p||l===c?d=p:(l++,h=r._findNextWordOnLine(i,n,new H(l,1)),h?d=h.start+1:d=n.getLineMaxColumn(l))),new L(l,d,a.lineNumber,a.column)}static _deleteWordPartRight(t,e){if(!e.isEmpty())return e;let i=e.getPosition(),n=r._moveWordPartRight(t,i);return new L(i.lineNumber,i.column,n.lineNumber,n.column)}static _createWordAtPosition(t,e,i){let n=new L(e,i.start+1,e,i.end+1);return{word:t.getValueInRange(n),startColumn:n.startColumn,endColumn:n.endColumn}}static getWordAtPosition(t,e,i,n){let o=Ap(e,i),s=r._findPreviousWordOnLine(o,t,n);if(s&&s.wordType===1&&s.start<=n.column-1&&n.column-1<=s.end)return r._createWordAtPosition(t,n.lineNumber,s);let a=r._findNextWordOnLine(o,t,n);return a&&a.wordType===1&&a.start<=n.column-1&&n.column-1<=a.end?r._createWordAtPosition(t,n.lineNumber,a):null}static word(t,e,i,n,o){let s=Ap(t.wordSeparators,t.wordSegmenterLocales),a=r._findPreviousWordOnLine(s,e,o),l=r._findNextWordOnLine(s,e,o);if(!n){let m,f;return a&&a.wordType===1&&a.start<=o.column-1&&o.column-1<=a.end?(m=a.start+1,f=a.end+1):l&&l.wordType===1&&l.start<=o.column-1&&o.column-1<=l.end?(m=l.start+1,f=l.end+1):(a?m=a.end+1:m=1,l?f=l.start+1:f=e.getLineMaxColumn(o.lineNumber)),new No(new L(o.lineNumber,m,o.lineNumber,f),1,0,new H(o.lineNumber,f),0)}let d,c;a&&a.wordType===1&&a.start<o.column-1&&o.column-1<a.end?(d=a.start+1,c=a.end+1):l&&l.wordType===1&&l.start<o.column-1&&o.column-1<l.end?(d=l.start+1,c=l.end+1):(d=o.column,c=o.column);let p=o.lineNumber,h;if(i.selectionStart.containsPosition(o))h=i.selectionStart.endColumn;else if(o.isBeforeOrEqual(i.selectionStart.getStartPosition())){h=d;let m=new H(p,h);i.selectionStart.containsPosition(m)&&(h=i.selectionStart.endColumn)}else{h=c;let m=new H(p,h);i.selectionStart.containsPosition(m)&&(h=i.selectionStart.startColumn)}return i.move(!0,p,h,0)}};var Ar=class{static addCursorDown(t,e,i){let n=[],o=0;for(let s=0,a=e.length;s<a;s++){let l=e[s];n[o++]=new Zt(l.modelState,l.viewState),i?n[o++]=Zt.fromModelState(ao.translateDown(t.cursorConfig,t.model,l.modelState)):n[o++]=Zt.fromViewState(ao.translateDown(t.cursorConfig,t,l.viewState))}return n}static addCursorUp(t,e,i){let n=[],o=0;for(let s=0,a=e.length;s<a;s++){let l=e[s];n[o++]=new Zt(l.modelState,l.viewState),i?n[o++]=Zt.fromModelState(ao.translateUp(t.cursorConfig,t.model,l.modelState)):n[o++]=Zt.fromViewState(ao.translateUp(t.cursorConfig,t,l.viewState))}return n}static moveToBeginningOfLine(t,e,i){let n=[];for(let o=0,s=e.length;o<s;o++){let a=e[o];n[o]=this._moveToLineStart(t,a,i)}return n}static _moveToLineStart(t,e,i){let n=e.viewState.position.column,o=e.modelState.position.column,s=n===o,a=e.viewState.position.lineNumber,l=t.getLineFirstNonWhitespaceColumn(a);return!s&&!(n===l)?this._moveToLineStartByView(t,e,i):this._moveToLineStartByModel(t,e,i)}static _moveToLineStartByView(t,e,i){return Zt.fromViewState(ao.moveToBeginningOfLine(t.cursorConfig,t,e.viewState,i))}static _moveToLineStartByModel(t,e,i){return Zt.fromModelState(ao.moveToBeginningOfLine(t.cursorConfig,t.model,e.modelState,i))}static moveToEndOfLine(t,e,i,n){let o=[];for(let s=0,a=e.length;s<a;s++){let l=e[s];o[s]=this._moveToLineEnd(t,l,i,n)}return o}static _moveToLineEnd(t,e,i,n){let o=e.viewState.position,s=t.getLineMaxColumn(o.lineNumber),a=o.column===s,l=e.modelState.position,d=t.model.getLineMaxColumn(l.lineNumber),c=s-o.column===d-l.column;return a||c?this._moveToLineEndByModel(t,e,i,n):this._moveToLineEndByView(t,e,i,n)}static _moveToLineEndByView(t,e,i,n){return Zt.fromViewState(ao.moveToEndOfLine(t.cursorConfig,t,e.viewState,i,n))}static _moveToLineEndByModel(t,e,i,n){return Zt.fromModelState(ao.moveToEndOfLine(t.cursorConfig,t.model,e.modelState,i,n))}static expandLineSelection(t,e){let i=[];for(let n=0,o=e.length;n<o;n++){let s=e[n],a=s.modelState.selection.startLineNumber,l=t.model.getLineCount(),d=s.modelState.selection.endLineNumber,c;d===l?c=t.model.getLineMaxColumn(l):(d++,c=1),i[n]=Zt.fromModelState(new No(new L(a,1,a,1),0,0,new H(d,c),0))}return i}static moveToBeginningOfBuffer(t,e,i){let n=[];for(let o=0,s=e.length;o<s;o++){let a=e[o];n[o]=Zt.fromModelState(ao.moveToBeginningOfBuffer(t.cursorConfig,t.model,a.modelState,i))}return n}static moveToEndOfBuffer(t,e,i){let n=[];for(let o=0,s=e.length;o<s;o++){let a=e[o];n[o]=Zt.fromModelState(ao.moveToEndOfBuffer(t.cursorConfig,t.model,a.modelState,i))}return n}static selectAll(t,e){let i=t.model.getLineCount(),n=t.model.getLineMaxColumn(i);return Zt.fromModelState(new No(new L(1,1,1,1),0,0,new H(i,n),0))}static line(t,e,i,n,o){let s=t.model.validatePosition(n),a=o?t.coordinatesConverter.validateViewPosition(new H(o.lineNumber,o.column),s):t.coordinatesConverter.convertModelPositionToViewPosition(s);if(!i){let d=t.model.getLineCount(),c=s.lineNumber+1,p=1;return c>d&&(c=d,p=t.model.getLineMaxColumn(c)),Zt.fromModelState(new No(new L(s.lineNumber,1,c,p),2,0,new H(c,p),0))}let l=e.modelState.selectionStart.getStartPosition().lineNumber;if(s.lineNumber<l)return Zt.fromViewState(e.viewState.move(!0,a.lineNumber,1,0));if(s.lineNumber>l){let d=t.getLineCount(),c=a.lineNumber+1,p=1;return c>d&&(c=d,p=t.getLineMaxColumn(c)),Zt.fromViewState(e.viewState.move(!0,c,p,0))}else{let d=e.modelState.selectionStart.getEndPosition();return Zt.fromModelState(e.modelState.move(!0,d.lineNumber,d.column,0))}}static word(t,e,i,n){let o=t.model.validatePosition(n);return Zt.fromModelState(FE.word(t.cursorConfig,t.model,e.modelState,i,o))}static cancelSelection(t,e){if(!e.modelState.hasSelection())return new Zt(e.modelState,e.viewState);let i=e.viewState.position.lineNumber,n=e.viewState.position.column;return Zt.fromViewState(new No(new L(i,n,i,n),0,0,new H(i,n),0))}static moveTo(t,e,i,n,o){if(i){if(e.modelState.selectionStartKind===1)return this.word(t,e,i,n);if(e.modelState.selectionStartKind===2)return this.line(t,e,i,n,o)}let s=t.model.validatePosition(n),a=o?t.coordinatesConverter.validateViewPosition(new H(o.lineNumber,o.column),s):t.coordinatesConverter.convertModelPositionToViewPosition(s);return Zt.fromViewState(e.viewState.move(i,a.lineNumber,a.column,0))}static simpleMove(t,e,i,n,o,s){switch(i){case Vt.Direction.Left:return s===Vt.Unit.HalfLine?this._moveHalfLineLeft(t,e,n):this._moveLeft(t,e,n,o);case Vt.Direction.Right:return s===Vt.Unit.HalfLine?this._moveHalfLineRight(t,e,n):this._moveRight(t,e,n,o);case Vt.Direction.Up:return s===Vt.Unit.WrappedLine?this._moveUpByViewLines(t,e,n,o):this._moveUpByModelLines(t,e,n,o);case Vt.Direction.Down:return s===Vt.Unit.WrappedLine?this._moveDownByViewLines(t,e,n,o):this._moveDownByModelLines(t,e,n,o);case Vt.Direction.PrevBlankLine:return s===Vt.Unit.WrappedLine?e.map(a=>Zt.fromViewState(ao.moveToPrevBlankLine(t.cursorConfig,t,a.viewState,n))):e.map(a=>Zt.fromModelState(ao.moveToPrevBlankLine(t.cursorConfig,t.model,a.modelState,n)));case Vt.Direction.NextBlankLine:return s===Vt.Unit.WrappedLine?e.map(a=>Zt.fromViewState(ao.moveToNextBlankLine(t.cursorConfig,t,a.viewState,n))):e.map(a=>Zt.fromModelState(ao.moveToNextBlankLine(t.cursorConfig,t.model,a.modelState,n)));case Vt.Direction.WrappedLineStart:return this._moveToViewMinColumn(t,e,n);case Vt.Direction.WrappedLineFirstNonWhitespaceCharacter:return this._moveToViewFirstNonWhitespaceColumn(t,e,n);case Vt.Direction.WrappedLineColumnCenter:return this._moveToViewCenterColumn(t,e,n);case Vt.Direction.WrappedLineEnd:return this._moveToViewMaxColumn(t,e,n);case Vt.Direction.WrappedLineLastNonWhitespaceCharacter:return this._moveToViewLastNonWhitespaceColumn(t,e,n);default:return null}}static viewportMove(t,e,i,n,o){let s=t.getCompletelyVisibleViewRange(),a=t.coordinatesConverter.convertViewRangeToModelRange(s);switch(i){case Vt.Direction.ViewPortTop:{let l=this._firstLineNumberInRange(t.model,a,o),d=t.model.getLineFirstNonWhitespaceColumn(l);return[this._moveToModelPosition(t,e[0],n,l,d)]}case Vt.Direction.ViewPortBottom:{let l=this._lastLineNumberInRange(t.model,a,o),d=t.model.getLineFirstNonWhitespaceColumn(l);return[this._moveToModelPosition(t,e[0],n,l,d)]}case Vt.Direction.ViewPortCenter:{let l=Math.round((a.startLineNumber+a.endLineNumber)/2),d=t.model.getLineFirstNonWhitespaceColumn(l);return[this._moveToModelPosition(t,e[0],n,l,d)]}case Vt.Direction.ViewPortIfOutside:{let l=[];for(let d=0,c=e.length;d<c;d++){let p=e[d];l[d]=this.findPositionInViewportIfOutside(t,p,s,n)}return l}default:return null}}static findPositionInViewportIfOutside(t,e,i,n){let o=e.viewState.position.lineNumber;if(i.startLineNumber<=o&&o<=i.endLineNumber-1)return new Zt(e.modelState,e.viewState);{let s;o>i.endLineNumber-1?s=i.endLineNumber-1:o<i.startLineNumber?s=i.startLineNumber:s=o;let a=ao.vertical(t.cursorConfig,t,o,e.viewState.position.column,e.viewState.leftoverVisibleColumns,s,!1);return Zt.fromViewState(e.viewState.move(n,a.lineNumber,a.column,a.leftoverVisibleColumns))}}static _firstLineNumberInRange(t,e,i){let n=e.startLineNumber;return e.startColumn!==t.getLineMinColumn(n)&&n++,Math.min(e.endLineNumber,n+i-1)}static _lastLineNumberInRange(t,e,i){let n=e.startLineNumber;return e.startColumn!==t.getLineMinColumn(n)&&n++,Math.max(n,e.endLineNumber-i+1)}static _moveLeft(t,e,i,n){return e.map(o=>Zt.fromViewState(ao.moveLeft(t.cursorConfig,t,o.viewState,i,n)))}static _moveHalfLineLeft(t,e,i){let n=[];for(let o=0,s=e.length;o<s;o++){let a=e[o],l=a.viewState.position.lineNumber,d=Math.round(t.getLineLength(l)/2);n[o]=Zt.fromViewState(ao.moveLeft(t.cursorConfig,t,a.viewState,i,d))}return n}static _moveRight(t,e,i,n){return e.map(o=>Zt.fromViewState(ao.moveRight(t.cursorConfig,t,o.viewState,i,n)))}static _moveHalfLineRight(t,e,i){let n=[];for(let o=0,s=e.length;o<s;o++){let a=e[o],l=a.viewState.position.lineNumber,d=Math.round(t.getLineLength(l)/2);n[o]=Zt.fromViewState(ao.moveRight(t.cursorConfig,t,a.viewState,i,d))}return n}static _moveDownByViewLines(t,e,i,n){let o=[];for(let s=0,a=e.length;s<a;s++){let l=e[s];o[s]=Zt.fromViewState(ao.moveDown(t.cursorConfig,t,l.viewState,i,n))}return o}static _moveDownByModelLines(t,e,i,n){let o=[];for(let s=0,a=e.length;s<a;s++){let l=e[s];o[s]=Zt.fromModelState(ao.moveDown(t.cursorConfig,t.model,l.modelState,i,n))}return o}static _moveUpByViewLines(t,e,i,n){let o=[];for(let s=0,a=e.length;s<a;s++){let l=e[s];o[s]=Zt.fromViewState(ao.moveUp(t.cursorConfig,t,l.viewState,i,n))}return o}static _moveUpByModelLines(t,e,i,n){let o=[];for(let s=0,a=e.length;s<a;s++){let l=e[s];o[s]=Zt.fromModelState(ao.moveUp(t.cursorConfig,t.model,l.modelState,i,n))}return o}static _moveToViewPosition(t,e,i,n,o){return Zt.fromViewState(e.viewState.move(i,n,o,0))}static _moveToModelPosition(t,e,i,n,o){return Zt.fromModelState(e.modelState.move(i,n,o,0))}static _moveToViewMinColumn(t,e,i){let n=[];for(let o=0,s=e.length;o<s;o++){let a=e[o],l=a.viewState.position.lineNumber,d=t.getLineMinColumn(l);n[o]=this._moveToViewPosition(t,a,i,l,d)}return n}static _moveToViewFirstNonWhitespaceColumn(t,e,i){let n=[];for(let o=0,s=e.length;o<s;o++){let a=e[o],l=a.viewState.position.lineNumber,d=t.getLineFirstNonWhitespaceColumn(l);n[o]=this._moveToViewPosition(t,a,i,l,d)}return n}static _moveToViewCenterColumn(t,e,i){let n=[];for(let o=0,s=e.length;o<s;o++){let a=e[o],l=a.viewState.position.lineNumber,d=Math.round((t.getLineMaxColumn(l)+t.getLineMinColumn(l))/2);n[o]=this._moveToViewPosition(t,a,i,l,d)}return n}static _moveToViewMaxColumn(t,e,i){let n=[];for(let o=0,s=e.length;o<s;o++){let a=e[o],l=a.viewState.position.lineNumber,d=t.getLineMaxColumn(l);n[o]=this._moveToViewPosition(t,a,i,l,d)}return n}static _moveToViewLastNonWhitespaceColumn(t,e,i){let n=[];for(let o=0,s=e.length;o<s;o++){let a=e[o],l=a.viewState.position.lineNumber,d=t.getLineLastNonWhitespaceColumn(l);n[o]=this._moveToViewPosition(t,a,i,l,d)}return n}},Vt;(a=>{let r=function(l){if(!vi(l))return!1;let d=l;return!(!Bt(d.to)||!Vn(d.select)&&!HS(d.select)||!Vn(d.by)&&!Bt(d.by)||!Vn(d.value)&&!cr(d.value))};a.metadata={description:"Move cursor to a logical position in the view",args:[{name:"Cursor move argument object",description:`Property-value pairs that can be passed through this argument:
					* 'to': A mandatory logical position value providing where to move the cursor.
						\`\`\`
						'left', 'right', 'up', 'down', 'prevBlankLine', 'nextBlankLine',
						'wrappedLineStart', 'wrappedLineEnd', 'wrappedLineColumnCenter'
						'wrappedLineFirstNonWhitespaceCharacter', 'wrappedLineLastNonWhitespaceCharacter'
						'viewPortTop', 'viewPortCenter', 'viewPortBottom', 'viewPortIfOutside'
						\`\`\`
					* 'by': Unit to move. Default is computed based on 'to' value.
						\`\`\`
						'line', 'wrappedLine', 'character', 'halfLine'
						\`\`\`
					* 'value': Number of units to move. Default is '1'.
					* 'select': If 'true' makes the selection. Default is 'false'.
				`,constraint:r,schema:{type:"object",required:["to"],properties:{to:{type:"string",enum:["left","right","up","down","prevBlankLine","nextBlankLine","wrappedLineStart","wrappedLineEnd","wrappedLineColumnCenter","wrappedLineFirstNonWhitespaceCharacter","wrappedLineLastNonWhitespaceCharacter","viewPortTop","viewPortCenter","viewPortBottom","viewPortIfOutside"]},by:{type:"string",enum:["line","wrappedLine","character","halfLine"]},value:{type:"number",default:1},select:{type:"boolean",default:!1}}}}]},a.RawDirection={Left:"left",Right:"right",Up:"up",Down:"down",PrevBlankLine:"prevBlankLine",NextBlankLine:"nextBlankLine",WrappedLineStart:"wrappedLineStart",WrappedLineFirstNonWhitespaceCharacter:"wrappedLineFirstNonWhitespaceCharacter",WrappedLineColumnCenter:"wrappedLineColumnCenter",WrappedLineEnd:"wrappedLineEnd",WrappedLineLastNonWhitespaceCharacter:"wrappedLineLastNonWhitespaceCharacter",ViewPortTop:"viewPortTop",ViewPortCenter:"viewPortCenter",ViewPortBottom:"viewPortBottom",ViewPortIfOutside:"viewPortIfOutside"},a.RawUnit={Line:"line",WrappedLine:"wrappedLine",Character:"character",HalfLine:"halfLine"};function n(l){if(!l.to)return null;let d;switch(l.to){case a.RawDirection.Left:d=0;break;case a.RawDirection.Right:d=1;break;case a.RawDirection.Up:d=2;break;case a.RawDirection.Down:d=3;break;case a.RawDirection.PrevBlankLine:d=4;break;case a.RawDirection.NextBlankLine:d=5;break;case a.RawDirection.WrappedLineStart:d=6;break;case a.RawDirection.WrappedLineFirstNonWhitespaceCharacter:d=7;break;case a.RawDirection.WrappedLineColumnCenter:d=8;break;case a.RawDirection.WrappedLineEnd:d=9;break;case a.RawDirection.WrappedLineLastNonWhitespaceCharacter:d=10;break;case a.RawDirection.ViewPortTop:d=11;break;case a.RawDirection.ViewPortBottom:d=13;break;case a.RawDirection.ViewPortCenter:d=12;break;case a.RawDirection.ViewPortIfOutside:d=14;break;default:return null}let c=0;switch(l.by){case a.RawUnit.Line:c=1;break;case a.RawUnit.WrappedLine:c=2;break;case a.RawUnit.Character:c=3;break;case a.RawUnit.HalfLine:c=4;break}return{direction:d,unit:c,select:!!l.select,value:l.value||1}}a.parse=n;let o;(k=>(k[k.Left=0]="Left",k[k.Right=1]="Right",k[k.Up=2]="Up",k[k.Down=3]="Down",k[k.PrevBlankLine=4]="PrevBlankLine",k[k.NextBlankLine=5]="NextBlankLine",k[k.WrappedLineStart=6]="WrappedLineStart",k[k.WrappedLineFirstNonWhitespaceCharacter=7]="WrappedLineFirstNonWhitespaceCharacter",k[k.WrappedLineColumnCenter=8]="WrappedLineColumnCenter",k[k.WrappedLineEnd=9]="WrappedLineEnd",k[k.WrappedLineLastNonWhitespaceCharacter=10]="WrappedLineLastNonWhitespaceCharacter",k[k.ViewPortTop=11]="ViewPortTop",k[k.ViewPortCenter=12]="ViewPortCenter",k[k.ViewPortBottom=13]="ViewPortBottom",k[k.ViewPortIfOutside=14]="ViewPortIfOutside"))(o=a.Direction||={});let s;(m=>(m[m.None=0]="None",m[m.Line=1]="Line",m[m.WrappedLine=2]="WrappedLine",m[m.Character=3]="Character",m[m.HalfLine=4]="HalfLine"))(s=a.Unit||={})})(Vt||={});function MEe(r,t,e){let i=r.tokenization.getLanguageIdAtPosition(t,0);if(t>1){let n,o=-1;for(n=t-1;n>=1;n--){if(r.tokenization.getLanguageIdAtPosition(n,0)!==i)return o;let s=r.getLineContent(n);if(e.shouldIgnore(n)||/^\s+$/.test(s)||s===""){o=n;continue}return n}}return-1}function pR(r,t,e,i=!0,n){if(r<4)return null;let o=n.getLanguageConfiguration(t.tokenization.getLanguageId()).indentRulesSupport;if(!o)return null;let s=new YV(t,o,n);if(e<=1)return{indentation:"",action:null};for(let l=e-1;l>0&&t.getLineContent(l)==="";l--)if(l===1)return{indentation:"",action:null};let a=MEe(t,e,s);if(a<0)return null;if(a<1)return{indentation:"",action:null};if(s.shouldIncrease(a)||s.shouldIndentNextLine(a)){let l=t.getLineContent(a);return{indentation:yn(l),action:1,line:a}}else if(s.shouldDecrease(a)){let l=t.getLineContent(a);return{indentation:yn(l),action:null,line:a}}else{if(a===1)return{indentation:yn(t.getLineContent(a)),action:null,line:a};let l=a-1,d=o.getIndentMetadata(t.getLineContent(l));if(!(d&3)&&d&4){let c=0;for(let p=l-1;p>0;p--)if(!s.shouldIndentNextLine(p)){c=p;break}return{indentation:yn(t.getLineContent(c+1)),action:null,line:c+1}}if(i)return{indentation:yn(t.getLineContent(a)),action:null,line:a};for(let c=a;c>0;c--){if(s.shouldIncrease(c))return{indentation:yn(t.getLineContent(c)),action:1,line:c};if(s.shouldIndentNextLine(c)){let p=0;for(let h=c-1;h>0;h--)if(!s.shouldIndentNextLine(c)){p=h;break}return{indentation:yn(t.getLineContent(p+1)),action:null,line:p+1}}else if(s.shouldDecrease(c))return{indentation:yn(t.getLineContent(c)),action:null,line:c}}return{indentation:yn(t.getLineContent(1)),action:null,line:1}}}function Dce(r,t,e,i,n){if(r<4)return null;let o=t.getLanguageIdAtPosition(e.startLineNumber,e.startColumn),s=n.getLanguageConfiguration(o).indentRulesSupport;if(!s)return null;t.tokenization.forceTokenization(e.startLineNumber);let l=new Sy(t,n).getProcessedTokenContextAroundRange(e),d=l.afterRangeProcessedTokens,c=l.beforeRangeProcessedTokens,p=yn(c.getLineContent()),h=AEe(t,e.startLineNumber,c),m=QV(t,e.getStartPosition()),f=t.getLineContent(e.startLineNumber),g=yn(f),v=pR(r,h,e.startLineNumber+1,void 0,n);if(!v){let y=m?g:p;return{beforeEnter:y,afterEnter:y}}let I=m?g:v.indentation;return v.action===1&&(I=i.shiftIndent(I)),s.shouldDecrease(d.getLineContent())&&(I=i.unshiftIndent(I)),{beforeEnter:m?g:p,afterEnter:I}}function kce(r,t,e,i,n,o){let s=r.autoIndent;if(s<4||QV(t,e.getStartPosition()))return null;let l=t.getLanguageIdAtPosition(e.startLineNumber,e.startColumn),d=o.getLanguageConfiguration(l).indentRulesSupport;if(!d)return null;let p=new Sy(t,o).getProcessedTokenContextAroundRange(e),h=p.beforeRangeProcessedTokens.getLineContent(),m=p.afterRangeProcessedTokens.getLineContent(),f=h+m,g=h+i+m;if(!d.shouldDecrease(f)&&d.shouldDecrease(g)){let I=pR(s,t,e.startLineNumber,!1,o);if(!I)return null;let y=I.indentation;return I.action!==1&&(y=n.unshiftIndent(y)),y}let v=e.startLineNumber-1;if(v>0){let I=t.getLineContent(v);if(d.shouldIndentNextLine(I)&&d.shouldIncrease(g)){let w=pR(s,t,e.startLineNumber,!1,o)?.indentation;if(w!==void 0){let C=t.getLineContent(e.startLineNumber),S=yn(C),k=n.shiftIndent(w)===S,M=/^\s*$/.test(f),O=r.autoClosingPairs.autoClosingPairsOpenByEnd.get(i),G=O&&O.length>0&&M;if(k&&G)return w}}}return null}function AEe(r,t,e){return{tokenization:{getLineTokens:n=>n===t?e:r.tokenization.getLineTokens(n),getLanguageId:()=>r.getLanguageId(),getLanguageIdAtPosition:(n,o)=>r.getLanguageIdAtPosition(n,o)},getLineContent:n=>n===t?e.getLineContent():r.getLineContent(n)}}var YV=class{_indentRulesSupport;_indentationLineProcessor;constructor(t,e,i){this._indentRulesSupport=e,this._indentationLineProcessor=new ZV(t,i)}shouldIncrease(t,e){let i=this._indentationLineProcessor.getProcessedLine(t,e);return this._indentRulesSupport.shouldIncrease(i)}shouldDecrease(t,e){let i=this._indentationLineProcessor.getProcessedLine(t,e);return this._indentRulesSupport.shouldDecrease(i)}shouldIgnore(t,e){let i=this._indentationLineProcessor.getProcessedLine(t,e);return this._indentRulesSupport.shouldIgnore(i)}shouldIndentNextLine(t,e){let i=this._indentationLineProcessor.getProcessedLine(t,e);return this._indentRulesSupport.shouldIndentNextLine(i)}},Sy=class{model;indentationLineProcessor;constructor(t,e){this.model=t,this.indentationLineProcessor=new ZV(t,e)}getProcessedTokenContextAroundRange(t){let e=this._getProcessedTokensBeforeRange(t),i=this._getProcessedTokensAfterRange(t),n=this._getProcessedPreviousLineTokens(t);return{beforeRangeProcessedTokens:e,afterRangeProcessedTokens:i,previousLineProcessedTokens:n}}_getProcessedTokensBeforeRange(t){this.model.tokenization.forceTokenization(t.startLineNumber);let e=this.model.tokenization.getLineTokens(t.startLineNumber),i=Bp(e,t.startColumn-1),n;if(QV(this.model,t.getStartPosition())){let s=t.startColumn-1-i.firstCharOffset,a=i.firstCharOffset,l=a+s;n=e.sliceAndInflate(a,l,0)}else{let s=t.startColumn-1;n=e.sliceAndInflate(0,s,0)}return this.indentationLineProcessor.getProcessedTokens(n)}_getProcessedTokensAfterRange(t){let e=t.isEmpty()?t.getStartPosition():t.getEndPosition();this.model.tokenization.forceTokenization(e.lineNumber);let i=this.model.tokenization.getLineTokens(e.lineNumber),n=Bp(i,e.column-1),o=e.column-1-n.firstCharOffset,s=n.firstCharOffset+o,a=n.firstCharOffset+n.getLineLength(),l=i.sliceAndInflate(s,a,0);return this.indentationLineProcessor.getProcessedTokens(l)}_getProcessedPreviousLineTokens(t){let e=m=>{this.model.tokenization.forceTokenization(m);let f=this.model.tokenization.getLineTokens(m),g=this.model.getLineMaxColumn(m)-1;return Bp(f,g)};this.model.tokenization.forceTokenization(t.startLineNumber);let i=this.model.tokenization.getLineTokens(t.startLineNumber),n=Bp(i,t.startColumn-1),o=io.createEmpty("",n.languageIdCodec),s=t.startLineNumber-1;if(s===0||!(n.firstCharOffset===0))return o;let d=e(s);if(!(n.languageId===d.languageId))return o;let p=d.toIViewLineTokens();return this.indentationLineProcessor.getProcessedTokens(p)}},ZV=class{constructor(t,e){this.model=t;this.languageConfigurationService=e}getProcessedLine(t,e){let i=(s,a)=>{let l=yn(s);return a+s.substring(l.length)};this.model.tokenization.forceTokenization?.(t);let n=this.model.tokenization.getLineTokens(t),o=this.getProcessedTokens(n).getLineContent();return e!==void 0&&(o=i(o,e)),o}getProcessedTokens(t){let e=l=>l===2||l===3||l===1,i=t.getLanguageId(0),o=this.languageConfigurationService.getLanguageConfiguration(i).bracketsNew.getBracketRegExp({global:!0}),s=[];return t.forEach(l=>{let d=t.getStandardTokenType(l),c=t.getTokenText(l);e(d)&&(c=c.replace(o,""));let p=t.getMetadata(l);s.push({text:c,metadata:p})}),io.createFromTextAndMetadata(s,t.languageIdCodec)}};function QV(r,t){r.tokenization.forceTokenization(t.lineNumber);let e=r.tokenization.getLineTokens(t.lineNumber),i=Bp(e,t.column-1),n=i.firstCharOffset===0,o=e.getLanguageId(0)===i.languageId;return!n&&!o}function hR(r,t,e,i){t.tokenization.forceTokenization(e.startLineNumber);let n=t.getLanguageIdAtPosition(e.startLineNumber,e.startColumn),o=i.getLanguageConfiguration(n);if(!o)return null;let a=new Sy(t,i).getProcessedTokenContextAroundRange(e),l=a.previousLineProcessedTokens.getLineContent(),d=a.beforeRangeProcessedTokens.getLineContent(),c=a.afterRangeProcessedTokens.getLineContent(),p=o.onEnter(r,l,d,c);if(!p)return null;let h=p.indentAction,m=p.appendText,f=p.removeText||0;m?h===1&&(m="	"+m):h===1||h===2?m="	":m="";let g=t0(t,e.startLineNumber,e.startColumn);return f&&(g=g.substring(0,g.length-f)),{indentAction:h,appendText:m,removeText:f,indentation:g}}var Mq=Object.create(null);function Cy(r,t){if(t<=0)return"";Mq[r]||(Mq[r]=["",r]);let e=Mq[r];for(let i=e.length;i<=t;i++)e[i]=e[i-1]+r;return e[t]}var Zl=class{constructor(t,e,i){this._languageConfigurationService=i;this._opts=e,this._selection=t,this._selectionId=null,this._useLastEditRangeForCursorEndPosition=!1,this._selectionStartColumnStaysPut=!1}static unshiftIndent(t,e,i,n,o){let s=tn.visibleColumnFromColumn(t,e,i);if(o){let a=Cy(" ",n),d=tn.prevIndentTabStop(s,n)/n;return Cy(a,d)}else{let a="	",d=tn.prevRenderTabStop(s,i)/i;return Cy(a,d)}}static shiftIndent(t,e,i,n,o){let s=tn.visibleColumnFromColumn(t,e,i);if(o){let a=Cy(" ",n),d=tn.nextIndentTabStop(s,n)/n;return Cy(a,d)}else{let a="	",d=tn.nextRenderTabStop(s,i)/i;return Cy(a,d)}}_opts;_selection;_selectionId;_useLastEditRangeForCursorEndPosition;_selectionStartColumnStaysPut;_addEditOperation(t,e,i){this._useLastEditRangeForCursorEndPosition?t.addTrackedEditOperation(e,i):t.addEditOperation(e,i)}getEditOperations(t,e){let i=this._selection.startLineNumber,n=this._selection.endLineNumber;this._selection.endColumn===1&&i!==n&&(n=n-1);let{tabSize:o,indentSize:s,insertSpaces:a}=this._opts,l=i===n;if(this._opts.useTabStops){this._selection.isEmpty()&&/^\s*$/.test(t.getLineContent(i))&&(this._useLastEditRangeForCursorEndPosition=!0);let d=0,c=0;for(let p=i;p<=n;p++,d=c){c=0;let h=t.getLineContent(p),m=Jn(h);if(this._opts.isUnshift&&(h.length===0||m===0)||!l&&!this._opts.isUnshift&&h.length===0)continue;if(m===-1&&(m=h.length),p>1&&tn.visibleColumnFromColumn(h,m+1,o)%s!==0&&t.tokenization.isCheapToTokenize(p-1)){let v=hR(this._opts.autoIndent,t,new L(p-1,t.getLineMaxColumn(p-1),p-1,t.getLineMaxColumn(p-1)),this._languageConfigurationService);if(v){if(c=d,v.appendText)for(let I=0,y=v.appendText.length;I<y&&c<s&&v.appendText.charCodeAt(I)===32;I++)c++;v.removeText&&(c=Math.max(0,c-v.removeText));for(let I=0;I<c&&!(m===0||h.charCodeAt(m-1)!==32);I++)m--}}if(this._opts.isUnshift&&m===0)continue;let f;this._opts.isUnshift?f=Zl.unshiftIndent(h,m+1,o,s,a):f=Zl.shiftIndent(h,m+1,o,s,a),this._addEditOperation(e,new L(p,1,p,m+1),f),p===i&&!this._selection.isEmpty()&&(this._selectionStartColumnStaysPut=this._selection.startColumn<=m+1)}}else{!this._opts.isUnshift&&this._selection.isEmpty()&&t.getLineLength(i)===0&&(this._useLastEditRangeForCursorEndPosition=!0);let d=a?Cy(" ",s):"	";for(let c=i;c<=n;c++){let p=t.getLineContent(c),h=Jn(p);if(!(this._opts.isUnshift&&(p.length===0||h===0))&&!(!l&&!this._opts.isUnshift&&p.length===0)&&(h===-1&&(h=p.length),!(this._opts.isUnshift&&h===0)))if(this._opts.isUnshift){h=Math.min(h,s);for(let m=0;m<h;m++)if(p.charCodeAt(m)===9){h=m+1;break}this._addEditOperation(e,new L(c,1,c,h+1),"")}else this._addEditOperation(e,new L(c,1,c,1),d),c===i&&!this._selection.isEmpty()&&(this._selectionStartColumnStaysPut=this._selection.startColumn===1)}}this._selectionId=e.trackSelection(this._selection)}computeCursorState(t,e){if(this._useLastEditRangeForCursorEndPosition){let n=e.getInverseEditOperations()[0];return new Et(n.range.endLineNumber,n.range.endColumn,n.range.endLineNumber,n.range.endColumn)}let i=e.getTrackedSelection(this._selectionId);if(this._selectionStartColumnStaysPut){let n=this._selection.startColumn;return i.startColumn<=n?i:i.getDirection()===0?new Et(i.startLineNumber,n,i.endLineNumber,i.endColumn):new Et(i.endLineNumber,i.endColumn,i.startLineNumber,n)}return i}};Zl=E([b(2,Do)],Zl);var JV=class{_range;_charBeforeSelection;_charAfterSelection;constructor(t,e,i){this._range=t,this._charBeforeSelection=e,this._charAfterSelection=i}getEditOperations(t,e){e.addTrackedEditOperation(new L(this._range.startLineNumber,this._range.startColumn,this._range.startLineNumber,this._range.startColumn),this._charBeforeSelection),e.addTrackedEditOperation(new L(this._range.endLineNumber,this._range.endColumn,this._range.endLineNumber,this._range.endColumn),this._charAfterSelection)}computeCursorState(t,e){let i=e.getInverseEditOperations(),n=i[0].range,o=i[1].range;return new Et(n.endLineNumber,n.endColumn,o.endLineNumber,o.endColumn-this._charAfterSelection.length)}},eW=class{constructor(t,e,i){this._position=t;this._text=e;this._charAfter=i}getEditOperations(t,e){e.addTrackedEditOperation(new L(this._position.lineNumber,this._position.column,this._position.lineNumber,this._position.column),this._text+this._charAfter)}computeCursorState(t,e){let n=e.getInverseEditOperations()[0].range;return new Et(n.endLineNumber,n.startColumn,n.endLineNumber,n.endColumn-this._charAfter.length)}};var tW=class{static getEdits(t,e,i,n,o){if(!o&&this._isAutoIndentType(t,e,i)){let s=[];for(let l of i){let d=this._findActualIndentationForSelection(t,e,l,n);if(d===null)return;s.push({selection:l,indentation:d})}let a=BE.getAutoClosingPairClose(t,e,i,n,!1);return this._getIndentationAndAutoClosingPairEdits(t,e,s,n,a)}}static _isAutoIndentType(t,e,i){if(t.autoIndent<4)return!1;for(let n=0,o=i.length;n<o;n++)if(!e.tokenization.isCheapToTokenize(i[n].getEndPosition().lineNumber))return!1;return!0}static _findActualIndentationForSelection(t,e,i,n){let o=kce(t,e,i,n,{shiftIndent:a=>mR(t,a),unshiftIndent:a=>HE(t,a)},t.languageConfigurationService);if(o===null)return null;let s=t0(e,i.startLineNumber,i.startColumn);return o===t.normalizeIndentation(s)?null:o}static _getIndentationAndAutoClosingPairEdits(t,e,i,n,o){let s=i.map(({selection:l,indentation:d})=>{if(o!==null){let c=this._getEditFromIndentationAndSelection(t,e,d,l,n,!1);return new Oq(c,l,n,o)}else{let c=this._getEditFromIndentationAndSelection(t,e,d,l,n,!0);return wy(c.range,c.text,!1)}}),a={shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1};return new hr(4,s,a)}static _getEditFromIndentationAndSelection(t,e,i,n,o,s=!0){let a=n.startLineNumber,l=e.getLineFirstNonWhitespaceColumn(a),d=t.normalizeIndentation(i);if(l!==0){let p=e.getLineContent(a);d+=p.substring(l-1,n.startColumn-1)}return d+=s?o:"",{range:new L(a,1,n.endLineNumber,n.endColumn),text:d}}},iW=class{static getEdits(t,e,i,n,o,s){if(Pce(e,i,n,o,s))return this._runAutoClosingOvertype(t,n,s)}static _runAutoClosingOvertype(t,e,i){let n=[];for(let o=0,s=e.length;o<s;o++){let l=e[o].getPosition(),d=new L(l.lineNumber,l.column,l.lineNumber,l.column+1);n[o]=new _s(d,i)}return new hr(4,n,{shouldPushStackElementBefore:uW(t,4),shouldPushStackElementAfter:!1})}},nW=class{static getEdits(t,e,i,n,o){if(Pce(t,e,i,n,o)){let s=i.map(a=>new _s(new L(a.positionLineNumber,a.positionColumn,a.positionLineNumber,a.positionColumn+1),"",!1));return new hr(4,s,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}}},BE=class{static getEdits(t,e,i,n,o,s){if(!s){let a=this.getAutoClosingPairClose(t,e,i,n,o);if(a!==null)return this._runAutoClosingOpenCharType(i,n,o,a)}}static _runAutoClosingOpenCharType(t,e,i,n){let o=[];for(let s=0,a=t.length;s<a;s++){let l=t[s];o[s]=new Aq(l,e,!i,n)}return new hr(4,o,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}static getAutoClosingPairClose(t,e,i,n,o){for(let f of i)if(!f.isEmpty())return null;let s=i.map(f=>{let g=f.getPosition();return o?{lineNumber:g.lineNumber,beforeColumn:g.column-n.length,afterColumn:g.column}:{lineNumber:g.lineNumber,beforeColumn:g.column,afterColumn:g.column}}),a=this._findAutoClosingPairOpen(t,e,s.map(f=>new H(f.lineNumber,f.beforeColumn)),n);if(!a)return null;let l,d;if(mu(n)?(l=t.autoClosingQuotes,d=t.shouldAutoCloseBefore.quote):(t.blockCommentStartToken?a.open.includes(t.blockCommentStartToken):!1)?(l=t.autoClosingComments,d=t.shouldAutoCloseBefore.comment):(l=t.autoClosingBrackets,d=t.shouldAutoCloseBefore.bracket),l==="never")return null;let p=this._findContainedAutoClosingPair(t,a),h=p?p.close:"",m=!0;for(let f of s){let{lineNumber:g,beforeColumn:v,afterColumn:I}=f,y=e.getLineContent(g),w=y.substring(0,v-1),C=y.substring(I-1);if(C.startsWith(h)||(m=!1),C.length>0){let M=C.charAt(0);if(!this._isBeforeClosingBrace(t,C)&&!d(M))return null}if(a.open.length===1&&(n==="'"||n==='"')&&l!=="always"){let M=Ap(t.wordSeparators,[]);if(w.length>0){let O=w.charCodeAt(w.length-1);if(M.get(O)===0)return null}}if(!e.tokenization.isCheapToTokenize(g))return null;e.tokenization.forceTokenization(g);let S=e.tokenization.getLineTokens(g),D=Bp(S,v-1);if(!a.shouldAutoClose(D,v-D.firstCharOffset))return null;let k=a.findNeutralCharacter();if(k){let M=e.tokenization.getTokenTypeIfInsertingCharacter(g,v,k);if(!a.isOK(M))return null}}return m?a.close.substring(0,a.close.length-h.length):a.close}static _findContainedAutoClosingPair(t,e){if(e.open.length<=1)return null;let i=e.close.charAt(e.close.length-1),n=t.autoClosingPairs.autoClosingPairsCloseByEnd.get(i)||[],o=null;for(let s of n)s.open!==e.open&&e.open.includes(s.open)&&e.close.endsWith(s.close)&&(!o||s.open.length>o.open.length)&&(o=s);return o}static _findAutoClosingPairOpen(t,e,i,n){let o=t.autoClosingPairs.autoClosingPairsOpenByEnd.get(n);if(!o)return null;let s=null;for(let a of o)if(s===null||a.open.length>s.open.length){let l=!0;for(let d of i)if(e.getValueInRange(new L(d.lineNumber,d.column-a.open.length+1,d.lineNumber,d.column))+n!==a.open){l=!1;break}l&&(s=a)}return s}static _isBeforeClosingBrace(t,e){let i=e.charAt(0),n=t.autoClosingPairs.autoClosingPairsOpenByStart.get(i)||[],o=t.autoClosingPairs.autoClosingPairsCloseByStart.get(i)||[],s=n.some(l=>e.startsWith(l.open)),a=o.some(l=>e.startsWith(l.close));return!s&&a}},oW=class{static getEdits(t,e,i,n,o){if(!o&&this._isSurroundSelectionType(t,e,i,n))return this._runSurroundSelectionType(t,i,n)}static _runSurroundSelectionType(t,e,i){let n=[];for(let o=0,s=e.length;o<s;o++){let a=e[o],l=t.surroundingPairs[i];n[o]=new JV(a,i,l)}return new hr(0,n,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _isSurroundSelectionType(t,e,i,n){if(!Fq(t,n)||!t.surroundingPairs.hasOwnProperty(n))return!1;let o=mu(n);for(let s of i){if(s.isEmpty())return!1;let a=!0;for(let l=s.startLineNumber;l<=s.endLineNumber;l++){let d=e.getLineContent(l),c=l===s.startLineNumber?s.startColumn-1:0,p=l===s.endLineNumber?s.endColumn-1:d.length,h=d.substring(c,p);if(/[^ \t]/.test(h)){a=!1;break}}if(a)return!1;if(o&&s.startLineNumber===s.endLineNumber&&s.startColumn+1===s.endColumn){let l=e.getValueInRange(s);if(mu(l))return!1}}return!0}},rW=class{static getEdits(t,e,i,n,o,s){if(!s&&this._isTypeInterceptorElectricChar(e,i,n)){let a=this._typeInterceptorElectricChar(t,e,i,n[0],o);if(a)return a}}static _isTypeInterceptorElectricChar(t,e,i){return!!(i.length===1&&e.tokenization.isCheapToTokenize(i[0].getEndPosition().lineNumber))}static _typeInterceptorElectricChar(t,e,i,n,o){if(!e.electricChars.hasOwnProperty(o)||!n.isEmpty())return null;let s=n.getPosition();i.tokenization.forceTokenization(s.lineNumber);let a=i.tokenization.getLineTokens(s.lineNumber),l;try{l=e.onElectricCharacter(o,a,s.column)}catch(d){return Xe(d),null}if(!l)return null;if(l.matchOpenBracket){let d=(a.getLineContent()+o).lastIndexOf(l.matchOpenBracket)+1,c=i.bracketPairs.findMatchingBracketUp(l.matchOpenBracket,{lineNumber:s.lineNumber,column:d},500);if(c){if(c.startLineNumber===s.lineNumber)return null;let p=i.getLineContent(c.startLineNumber),h=yn(p),m=e.normalizeIndentation(h),f=i.getLineContent(s.lineNumber),g=i.getLineFirstNonWhitespaceColumn(s.lineNumber)||s.column,v=f.substring(g-1,s.column-1),I=m+v+o,y=new L(s.lineNumber,1,s.lineNumber,s.column),w=new _s(y,I);return new hr(Nq(I,t),[w],{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!0})}}return null}},sW=class{static getEdits(t,e,i){let n=[];for(let s=0,a=e.length;s<a;s++)n[s]=new _s(e[s],i);let o=Nq(i,t);return new hr(o,n,{shouldPushStackElementBefore:uW(t,o),shouldPushStackElementAfter:!1})}},VE=class{static getEdits(t,e,i,n,o){if(!o&&n===`
`){let s=[];for(let a=0,l=i.length;a<l;a++)s[a]=this._enter(t,e,!1,i[a]);return new hr(4,s,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}}static _enter(t,e,i,n){if(t.autoIndent===0)return wy(n,`
`,i);if(!e.tokenization.isCheapToTokenize(n.getStartPosition().lineNumber)||t.autoIndent===1){let l=e.getLineContent(n.startLineNumber),d=yn(l).substring(0,n.startColumn-1);return wy(n,`
`+t.normalizeIndentation(d),i)}let o=hR(t.autoIndent,e,n,t.languageConfigurationService);if(o){if(o.indentAction===0)return wy(n,`
`+t.normalizeIndentation(o.indentation+o.appendText),i);if(o.indentAction===1)return wy(n,`
`+t.normalizeIndentation(o.indentation+o.appendText),i);if(o.indentAction===2){let l=t.normalizeIndentation(o.indentation),d=t.normalizeIndentation(o.indentation+o.appendText),c=`
`+d+`
`+l;return i?new Iy(n,c,!0):new yy(n,c,-1,d.length-l.length,!0)}else if(o.indentAction===3){let l=HE(t,o.indentation);return wy(n,`
`+t.normalizeIndentation(l+o.appendText),i)}}let s=e.getLineContent(n.startLineNumber),a=yn(s).substring(0,n.startColumn-1);if(t.autoIndent>=4){let l=Dce(t.autoIndent,e,n,{unshiftIndent:d=>HE(t,d),shiftIndent:d=>mR(t,d),normalizeIndentation:d=>t.normalizeIndentation(d)},t.languageConfigurationService);if(l){let d=t.visibleColumnFromColumn(e,n.getEndPosition()),c=n.endColumn,p=e.getLineContent(n.endLineNumber),h=Jn(p);if(h>=0?n=n.setEndPosition(n.endLineNumber,Math.max(n.endColumn,h+1)):n=n.setEndPosition(n.endLineNumber,e.getLineMaxColumn(n.endLineNumber)),i)return new Iy(n,`
`+t.normalizeIndentation(l.afterEnter),!0);{let m=0;return c<=h+1&&(t.insertSpaces||(d=Math.ceil(d/t.indentSize)),m=Math.min(d+1-t.normalizeIndentation(l.afterEnter).length-1,0)),new yy(n,`
`+t.normalizeIndentation(l.afterEnter),0,m,!0)}}}return wy(n,`
`+t.normalizeIndentation(a),i)}static lineInsertBefore(t,e,i){if(e===null||i===null)return[];let n=[];for(let o=0,s=i.length;o<s;o++){let a=i[o].positionLineNumber;if(a===1)n[o]=new Iy(new L(1,1,1,1),`
`);else{a--;let l=e.getLineMaxColumn(a);n[o]=this._enter(t,e,!1,new L(a,l,a,l))}}return n}static lineInsertAfter(t,e,i){if(e===null||i===null)return[];let n=[];for(let o=0,s=i.length;o<s;o++){let a=i[o].positionLineNumber,l=e.getLineMaxColumn(a);n[o]=this._enter(t,e,!1,new L(a,l,a,l))}return n}static lineBreakInsert(t,e,i){let n=[];for(let o=0,s=i.length;o<s;o++)n[o]=this._enter(t,e,!0,i[o]);return n}},aW=class{static getEdits(t,e,i,n,o,s){let a=this._distributePasteToCursors(t,i,n,o,s);return a?(i=i.sort(L.compareRangesUsingStarts),this._distributedPaste(t,e,i,a)):this._simplePaste(t,e,i,n,o)}static _distributePasteToCursors(t,e,i,n,o){if(n||e.length===1)return null;if(o&&o.length===e.length)return o;if(t.multiCursorPaste==="spread"){i.charCodeAt(i.length-1)===10&&(i=i.substring(0,i.length-1)),i.charCodeAt(i.length-1)===13&&(i=i.substring(0,i.length-1));let s=Xc(i);if(s.length===e.length)return s}return null}static _distributedPaste(t,e,i,n){let o=[];for(let s=0,a=i.length;s<a;s++)o[s]=new _s(i[s],n[s]);return new hr(0,o,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _simplePaste(t,e,i,n,o){let s=[];for(let a=0,l=i.length;a<l;a++){let d=i[a],c=d.getPosition();if(o&&!d.isEmpty()&&(o=!1),o&&n.indexOf(`
`)!==n.length-1&&(o=!1),o){let p=new L(c.lineNumber,1,c.lineNumber,1);s[a]=new jV(p,n,d,!0)}else s[a]=new _s(d,n)}return new hr(0,s,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}},lW=class{static getEdits(t,e,i,n,o,s,a,l){let d=n.map(c=>this._compositionType(i,c,o,s,a,l));return new hr(4,d,{shouldPushStackElementBefore:uW(t,4),shouldPushStackElementAfter:!1})}static _compositionType(t,e,i,n,o,s){if(!e.isEmpty())return null;let a=e.getPosition(),l=Math.max(1,a.column-n),d=Math.min(t.getLineMaxColumn(a.lineNumber),a.column+o),c=new L(a.lineNumber,l,a.lineNumber,d);return t.getValueInRange(c)===i&&s===0?null:new yy(c,i,0,s)}},dW=class{static getEdits(t,e,i){let n=[];for(let s=0,a=e.length;s<a;s++)n[s]=new _s(e[s],i);let o=Nq(i,t);return new hr(o,n,{shouldPushStackElementBefore:uW(t,o),shouldPushStackElementAfter:!1})}},cW=class{static getCommands(t,e,i){let n=[];for(let o=0,s=i.length;o<s;o++){let a=i[o];if(a.isEmpty()){let l=e.getLineContent(a.startLineNumber);if(/^\s*$/.test(l)&&e.tokenization.isCheapToTokenize(a.startLineNumber)){let d=this._goodIndentForLine(t,e,a.startLineNumber);d=d||"	";let c=t.normalizeIndentation(d);if(!l.startsWith(c)){n[o]=new _s(new L(a.startLineNumber,1,a.startLineNumber,l.length+1),c,!0);continue}}n[o]=this._replaceJumpToNextIndent(t,e,a,!0)}else{if(a.startLineNumber===a.endLineNumber){let l=e.getLineMaxColumn(a.startLineNumber);if(a.startColumn!==1||a.endColumn!==l){n[o]=this._replaceJumpToNextIndent(t,e,a,!1);continue}}n[o]=new Zl(a,{isUnshift:!1,tabSize:t.tabSize,indentSize:t.indentSize,insertSpaces:t.insertSpaces,useTabStops:t.useTabStops,autoIndent:t.autoIndent},t.languageConfigurationService)}}return n}static _goodIndentForLine(t,e,i){let n=null,o="",s=pR(t.autoIndent,e,i,!1,t.languageConfigurationService);if(s)n=s.action,o=s.indentation;else if(i>1){let a;for(a=i-1;a>=1;a--){let c=e.getLineContent(a);if(fd(c)>=0)break}if(a<1)return null;let l=e.getLineMaxColumn(a),d=hR(t.autoIndent,e,new L(a,l,a,l),t.languageConfigurationService);d&&(o=d.indentation+d.appendText)}return n&&(n===1&&(o=mR(t,o)),n===3&&(o=HE(t,o)),o=t.normalizeIndentation(o)),o||null}static _replaceJumpToNextIndent(t,e,i,n){let o="",s=i.getStartPosition();if(t.insertSpaces){let a=t.visibleColumnFromColumn(e,s),l=t.indentSize,d=l-a%l;for(let c=0;c<d;c++)o+=" "}else o="	";return new _s(i,o,n)}},WE=class extends yy{_openCharacter;_closeCharacter;closeCharacterRange;enclosingRange;constructor(t,e,i,n,o,s){super(t,e,i,n),this._openCharacter=o,this._closeCharacter=s,this.closeCharacterRange=null,this.enclosingRange=null}_computeCursorStateWithRange(t,e,i){return this.closeCharacterRange=new L(e.startLineNumber,e.endColumn-this._closeCharacter.length,e.endLineNumber,e.endColumn),this.enclosingRange=new L(e.startLineNumber,e.endColumn-this._openCharacter.length-this._closeCharacter.length,e.endLineNumber,e.endColumn),super.computeCursorState(t,i)}},Aq=class extends WE{constructor(t,e,i,n){let o=(i?e:"")+n,s=0,a=-n.length;super(t,o,s,a,e,n)}computeCursorState(t,e){let n=e.getInverseEditOperations()[0].range;return this._computeCursorStateWithRange(t,n,e)}},Oq=class extends WE{_autoIndentationEdit;_autoClosingEdit;constructor(t,e,i,n){let o=i+n,s=0,a=i.length;super(e,o,s,a,i,n),this._autoIndentationEdit=t,this._autoClosingEdit={range:e,text:o}}getEditOperations(t,e){e.addTrackedEditOperation(this._autoIndentationEdit.range,this._autoIndentationEdit.text),e.addTrackedEditOperation(this._autoClosingEdit.range,this._autoClosingEdit.text)}computeCursorState(t,e){let i=e.getInverseEditOperations();if(i.length!==2)throw new Error("There should be two inverse edit operations!");let n=i[0].range,o=i[1].range,s=n.plusRange(o);return this._computeCursorStateWithRange(t,s,e)}};function Nq(r,t){return r===" "?t===5||t===6?6:5:4}function uW(r,t){return Rce(r)&&!Rce(t)?!0:r===5?!1:Lce(r)!==Lce(t)}function Lce(r){return r===6||r===5?"space":r}function Rce(r){return r===4||r===5||r===6}function Pce(r,t,e,i,n){if(r.autoClosingOvertype==="never"||!r.autoClosingPairs.autoClosingPairsCloseSingleChar.has(n))return!1;for(let o=0,s=e.length;o<s;o++){let a=e[o];if(!a.isEmpty())return!1;let l=a.getPosition(),d=t.getLineContent(l.lineNumber);if(d.charAt(l.column-1)!==n)return!1;let p=mu(n);if((l.column>2?d.charCodeAt(l.column-2):0)===92&&p)return!1;if(r.autoClosingOvertype==="auto"){let m=!1;for(let f=0,g=i.length;f<g;f++){let v=i[f];if(l.lineNumber===v.startLineNumber&&l.column===v.startColumn){m=!0;break}}if(!m)return!1}}return!0}function wy(r,t,e){return e?new Iy(r,t,!0):new _s(r,t,!0)}function mR(r,t,e){return e=e||1,Zl.shiftIndent(t,t.length+e,r.tabSize,r.indentSize,r.insertSpaces)}function HE(r,t,e){return e=e||1,Zl.unshiftIndent(t,t.length+e,r.tabSize,r.indentSize,r.insertSpaces)}function Fq(r,t){return mu(t)?r.autoSurround==="quotes"||r.autoSurround==="languageDefined":r.autoSurround==="brackets"||r.autoSurround==="languageDefined"}var Fu=class{static indent(t,e,i){if(e===null||i===null)return[];let n=[];for(let o=0,s=i.length;o<s;o++)n[o]=new Zl(i[o],{isUnshift:!1,tabSize:t.tabSize,indentSize:t.indentSize,insertSpaces:t.insertSpaces,useTabStops:t.useTabStops,autoIndent:t.autoIndent},t.languageConfigurationService);return n}static outdent(t,e,i){let n=[];for(let o=0,s=i.length;o<s;o++)n[o]=new Zl(i[o],{isUnshift:!0,tabSize:t.tabSize,indentSize:t.indentSize,insertSpaces:t.insertSpaces,useTabStops:t.useTabStops,autoIndent:t.autoIndent},t.languageConfigurationService);return n}static shiftIndent(t,e,i){return mR(t,e,i)}static unshiftIndent(t,e,i){return HE(t,e,i)}static paste(t,e,i,n,o,s){return aW.getEdits(t,e,i,n,o,s)}static tab(t,e,i){return cW.getCommands(t,e,i)}static compositionType(t,e,i,n,o,s,a,l){return lW.getEdits(t,e,i,n,o,s,a,l)}static compositionEndWithInterceptors(t,e,i,n,o,s){if(!n)return null;let a=null;for(let h of n)if(a===null)a=h.insertedText;else if(a!==h.insertedText)return null;if(!a||a.length!==1)return null;let l=a,d=!1;for(let h of n)if(h.deletedText.length!==0){d=!0;break}if(d){if(!Fq(e,l)||!e.surroundingPairs.hasOwnProperty(l))return null;let h=mu(l);for(let g of n)if(g.deletedSelectionStart!==0||g.deletedSelectionEnd!==g.deletedText.length||/^[ \t]+$/.test(g.deletedText)||h&&mu(g.deletedText))return null;let m=[];for(let g of o){if(!g.isEmpty())return null;m.push(g.getPosition())}if(m.length!==n.length)return null;let f=[];for(let g=0,v=m.length;g<v;g++)f.push(new eW(m[g],n[g].deletedText,e.surroundingPairs[l]));return new hr(4,f,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}let c=nW.getEdits(e,i,o,s,l);if(c!==void 0)return c;let p=BE.getEdits(e,i,o,l,!0,!1);return p!==void 0?p:null}static typeWithInterceptors(t,e,i,n,o,s,a){let l=VE.getEdits(i,n,o,a,t);if(l!==void 0)return l;let d=tW.getEdits(i,n,o,a,t);if(d!==void 0)return d;let c=iW.getEdits(e,i,n,o,s,a);if(c!==void 0)return c;let p=BE.getEdits(i,n,o,a,!1,t);if(p!==void 0)return p;let h=oW.getEdits(i,n,o,a,t);if(h!==void 0)return h;let m=rW.getEdits(e,i,n,o,a,t);return m!==void 0?m:sW.getEdits(e,o,a)}static typeWithoutInterceptors(t,e,i,n,o){return dW.getEdits(t,n,o)}},pW=class{constructor(t,e,i,n,o,s){this.deletedText=t;this.deletedSelectionStart=e;this.deletedSelectionEnd=i;this.insertedText=n;this.insertedSelectionStart=o;this.insertedSelectionEnd=s}};var ce;(Rt=>(Rt.editorSimpleInput=new A("editorSimpleInput",!1,!0),Rt.editorTextFocus=new A("editorTextFocus",!1,u("editorTextFocus","Whether the editor text has focus (cursor is blinking)")),Rt.focus=new A("editorFocus",!1,u("editorFocus","Whether the editor or an editor widget has focus (e.g. focus is in the find widget)")),Rt.textInputFocus=new A("textInputFocus",!1,u("textInputFocus","Whether an editor or a rich text input has focus (cursor is blinking)")),Rt.readOnly=new A("editorReadonly",!1,u("editorReadonly","Whether the editor is read-only")),Rt.inDiffEditor=new A("inDiffEditor",!1,u("inDiffEditor","Whether the context is a diff editor")),Rt.isEmbeddedDiffEditor=new A("isEmbeddedDiffEditor",!1,u("isEmbeddedDiffEditor","Whether the context is an embedded diff editor")),Rt.multiDiffEditorAllCollapsed=new A("multiDiffEditorAllCollapsed",void 0,u("multiDiffEditorAllCollapsed","Whether all files in multi diff editor are collapsed")),Rt.hasChanges=new A("diffEditorHasChanges",!1,u("diffEditorHasChanges","Whether the diff editor has changes")),Rt.comparingMovedCode=new A("comparingMovedCode",!1,u("comparingMovedCode","Whether a moved code block is selected for comparison")),Rt.accessibleDiffViewerVisible=new A("accessibleDiffViewerVisible",!1,u("accessibleDiffViewerVisible","Whether the accessible diff viewer is visible")),Rt.diffEditorRenderSideBySideInlineBreakpointReached=new A("diffEditorRenderSideBySideInlineBreakpointReached",!1,u("diffEditorRenderSideBySideInlineBreakpointReached","Whether the diff editor render side by side inline breakpoint is reached")),Rt.diffEditorInlineMode=new A("diffEditorInlineMode",!1,u("diffEditorInlineMode","Whether inline mode is active")),Rt.diffEditorOriginalWritable=new A("diffEditorOriginalWritable",!1,u("diffEditorOriginalWritable","Whether modified is writable in the diff editor")),Rt.diffEditorModifiedWritable=new A("diffEditorModifiedWritable",!1,u("diffEditorModifiedWritable","Whether modified is writable in the diff editor")),Rt.diffEditorOriginalUri=new A("diffEditorOriginalUri","",u("diffEditorOriginalUri","The uri of the original document")),Rt.diffEditorModifiedUri=new A("diffEditorModifiedUri","",u("diffEditorModifiedUri","The uri of the modified document")),Rt.columnSelection=new A("editorColumnSelection",!1,u("editorColumnSelection","Whether `editor.columnSelection` is enabled")),Rt.writable=Rt.readOnly.toNegated(),Rt.hasNonEmptySelection=new A("editorHasSelection",!1,u("editorHasSelection","Whether the editor has text selected")),Rt.hasOnlyEmptySelection=Rt.hasNonEmptySelection.toNegated(),Rt.hasMultipleSelections=new A("editorHasMultipleSelections",!1,u("editorHasMultipleSelections","Whether the editor has multiple selections")),Rt.hasSingleSelection=Rt.hasMultipleSelections.toNegated(),Rt.tabMovesFocus=new A("editorTabMovesFocus",!1,u("editorTabMovesFocus","Whether `Tab` will move focus out of the editor")),Rt.tabDoesNotMoveFocus=Rt.tabMovesFocus.toNegated(),Rt.isInEmbeddedEditor=new A("isInEmbeddedEditor",!1,!0),Rt.canUndo=new A("canUndo",!1,!0),Rt.canRedo=new A("canRedo",!1,!0),Rt.hoverVisible=new A("editorHoverVisible",!1,u("editorHoverVisible","Whether the editor hover is visible")),Rt.hoverFocused=new A("editorHoverFocused",!1,u("editorHoverFocused","Whether the editor hover is focused")),Rt.stickyScrollFocused=new A("stickyScrollFocused",!1,u("stickyScrollFocused","Whether the sticky scroll is focused")),Rt.stickyScrollVisible=new A("stickyScrollVisible",!1,u("stickyScrollVisible","Whether the sticky scroll is visible")),Rt.standaloneColorPickerVisible=new A("standaloneColorPickerVisible",!1,u("standaloneColorPickerVisible","Whether the standalone color picker is visible")),Rt.standaloneColorPickerFocused=new A("standaloneColorPickerFocused",!1,u("standaloneColorPickerFocused","Whether the standalone color picker is focused")),Rt.inCompositeEditor=new A("inCompositeEditor",void 0,u("inCompositeEditor","Whether the editor is part of a larger editor (e.g. notebooks)")),Rt.notInCompositeEditor=Rt.inCompositeEditor.toNegated(),Rt.languageId=new A("editorLangId","",u("editorLangId","The language identifier of the editor")),Rt.hasCompletionItemProvider=new A("editorHasCompletionItemProvider",!1,u("editorHasCompletionItemProvider","Whether the editor has a completion item provider")),Rt.hasCodeActionsProvider=new A("editorHasCodeActionsProvider",!1,u("editorHasCodeActionsProvider","Whether the editor has a code actions provider")),Rt.hasCodeLensProvider=new A("editorHasCodeLensProvider",!1,u("editorHasCodeLensProvider","Whether the editor has a code lens provider")),Rt.hasDefinitionProvider=new A("editorHasDefinitionProvider",!1,u("editorHasDefinitionProvider","Whether the editor has a definition provider")),Rt.hasDeclarationProvider=new A("editorHasDeclarationProvider",!1,u("editorHasDeclarationProvider","Whether the editor has a declaration provider")),Rt.hasImplementationProvider=new A("editorHasImplementationProvider",!1,u("editorHasImplementationProvider","Whether the editor has an implementation provider")),Rt.hasTypeDefinitionProvider=new A("editorHasTypeDefinitionProvider",!1,u("editorHasTypeDefinitionProvider","Whether the editor has a type definition provider")),Rt.hasHoverProvider=new A("editorHasHoverProvider",!1,u("editorHasHoverProvider","Whether the editor has a hover provider")),Rt.hasDocumentHighlightProvider=new A("editorHasDocumentHighlightProvider",!1,u("editorHasDocumentHighlightProvider","Whether the editor has a document highlight provider")),Rt.hasDocumentSymbolProvider=new A("editorHasDocumentSymbolProvider",!1,u("editorHasDocumentSymbolProvider","Whether the editor has a document symbol provider")),Rt.hasReferenceProvider=new A("editorHasReferenceProvider",!1,u("editorHasReferenceProvider","Whether the editor has a reference provider")),Rt.hasRenameProvider=new A("editorHasRenameProvider",!1,u("editorHasRenameProvider","Whether the editor has a rename provider")),Rt.hasSignatureHelpProvider=new A("editorHasSignatureHelpProvider",!1,u("editorHasSignatureHelpProvider","Whether the editor has a signature help provider")),Rt.hasInlayHintsProvider=new A("editorHasInlayHintsProvider",!1,u("editorHasInlayHintsProvider","Whether the editor has an inline hints provider")),Rt.hasDocumentFormattingProvider=new A("editorHasDocumentFormattingProvider",!1,u("editorHasDocumentFormattingProvider","Whether the editor has a document formatting provider")),Rt.hasDocumentSelectionFormattingProvider=new A("editorHasDocumentSelectionFormattingProvider",!1,u("editorHasDocumentSelectionFormattingProvider","Whether the editor has a document selection formatting provider")),Rt.hasMultipleDocumentFormattingProvider=new A("editorHasMultipleDocumentFormattingProvider",!1,u("editorHasMultipleDocumentFormattingProvider","Whether the editor has multiple document formatting providers")),Rt.hasMultipleDocumentSelectionFormattingProvider=new A("editorHasMultipleDocumentSelectionFormattingProvider",!1,u("editorHasMultipleDocumentSelectionFormattingProvider","Whether the editor has multiple document selection formatting providers"))))(ce||={});var Ci=0,An=class extends _r{runEditorCommand(t,e,i){let n=e._getViewModel();n&&this.runCoreEditorCommand(n,i||{})}},Ds;(a=>{let r=function(l){if(!vi(l))return!1;let d=l;return!(!Bt(d.to)||!Vn(d.by)&&!Bt(d.by)||!Vn(d.value)&&!cr(d.value)||!Vn(d.revealCursor)&&!HS(d.revealCursor))};a.metadata={description:"Scroll editor in the given direction",args:[{name:"Editor scroll argument object",description:"Property-value pairs that can be passed through this argument:\n					* 'to': A mandatory direction value.\n						```\n						'up', 'down'\n						```\n					* 'by': Unit to move. Default is computed based on 'to' value.\n						```\n						'line', 'wrappedLine', 'page', 'halfPage', 'editor'\n						```\n					* 'value': Number of units to move. Default is '1'.\n					* 'revealCursor': If 'true' reveals the cursor if it is outside view port.\n				",constraint:r,schema:{type:"object",required:["to"],properties:{to:{type:"string",enum:["up","down"]},by:{type:"string",enum:["line","wrappedLine","page","halfPage","editor"]},value:{type:"number",default:1},revealCursor:{type:"boolean"}}}}]},a.RawDirection={Up:"up",Right:"right",Down:"down",Left:"left"},a.RawUnit={Line:"line",WrappedLine:"wrappedLine",Page:"page",HalfPage:"halfPage",Editor:"editor",Column:"column"};function n(l){let d;switch(l.to){case a.RawDirection.Up:d=1;break;case a.RawDirection.Right:d=2;break;case a.RawDirection.Down:d=3;break;case a.RawDirection.Left:d=4;break;default:return null}let c;switch(l.by){case a.RawUnit.Line:c=1;break;case a.RawUnit.WrappedLine:c=2;break;case a.RawUnit.Page:c=3;break;case a.RawUnit.HalfPage:c=4;break;case a.RawUnit.Editor:c=5;break;case a.RawUnit.Column:c=6;break;default:c=2}let p=Math.floor(l.value||1),h=!!l.revealCursor;return{direction:d,unit:c,value:p,revealCursor:h,select:!!l.select}}a.parse=n;let o;(h=>(h[h.Up=1]="Up",h[h.Right=2]="Right",h[h.Down=3]="Down",h[h.Left=4]="Left"))(o=a.Direction||={});let s;(f=>(f[f.Line=1]="Line",f[f.WrappedLine=2]="WrappedLine",f[f.Page=3]="Page",f[f.HalfPage=4]="HalfPage",f[f.Editor=5]="Editor",f[f.Column=6]="Column"))(s=a.Unit||={})})(Ds||={});var gR;(i=>{let r=function(n){if(!vi(n))return!1;let o=n;return!(!cr(o.lineNumber)&&!Bt(o.lineNumber)||!Vn(o.at)&&!Bt(o.at))};i.metadata={description:"Reveal the given line at the given logical position",args:[{name:"Reveal line argument object",description:"Property-value pairs that can be passed through this argument:\n					* 'lineNumber': A mandatory line number value.\n					* 'at': Logical position at which line has to be revealed.\n						```\n						'top', 'center', 'bottom'\n						```\n				",constraint:r,schema:{type:"object",required:["lineNumber"],properties:{lineNumber:{type:["number","string"]},at:{type:"string",enum:["top","center","bottom"]}}}}]},i.RawAtArgument={Top:"top",Center:"center",Bottom:"bottom"}})(gR||={});var fR=class{constructor(t){t.addImplementation(1e4,"code-editor",(e,i)=>{let n=e.get(En).getFocusedCodeEditor();return n&&n.hasTextFocus()?this._runEditorCommand(e,n,i):!1}),t.addImplementation(1e3,"generic-dom-input-textarea",(e,i)=>{let n=fo();return n&&dc(n)?(this.runDOMCommand(n),!0):!1}),t.addImplementation(0,"generic-dom",(e,i)=>{let n=e.get(En).getActiveCodeEditor();return n?(n.focus(),this._runEditorCommand(e,n,i)):!1})}_runEditorCommand(t,e,i){let n=this.runEditorCommand(t,e,i);return n||!0}};var br;(ze=>{class r extends An{_inSelectionMode;constructor(ee){super(ee),this._inSelectionMode=ee.inSelectionMode}runCoreEditorCommand(ee,De){if(!De.position)return;ee.model.pushStackElement(),ee.setCursorStates(De.source,3,[Ar.moveTo(ee,ee.getPrimaryCursorState(),this._inSelectionMode,De.position,De.viewPosition)])&&De.revealType!==2&&ee.revealAllCursors(De.source,!0,!0)}}ze.MoveTo=qe(new r({id:"_moveTo",inSelectionMode:!1,precondition:void 0})),ze.MoveToSelect=qe(new r({id:"_moveToSelect",inSelectionMode:!0,precondition:void 0}));class i extends An{runCoreEditorCommand(ee,De){ee.model.pushStackElement();let We=this._getColumnSelectResult(ee,ee.getPrimaryCursorState(),ee.getCursorColumnSelectData(),De);We!==null&&(ee.setCursorStates(De.source,3,We.viewStates.map(ri=>Zt.fromViewState(ri))),ee.setCursorColumnSelectData({isReal:!0,fromViewLineNumber:We.fromLineNumber,fromViewVisualColumn:We.fromVisualColumn,toViewLineNumber:We.toLineNumber,toViewVisualColumn:We.toVisualColumn}),We.reversed?ee.revealTopMostCursor(De.source):ee.revealBottomMostCursor(De.source))}}ze.ColumnSelect=qe(new class extends i{constructor(){super({id:"columnSelect",precondition:void 0})}_getColumnSelectResult(Ae,ee,De,We){if(typeof We.position>"u"||typeof We.viewPosition>"u"||typeof We.mouseColumn>"u")return null;let ri=Ae.model.validatePosition(We.position),Zi=Ae.coordinatesConverter.validateViewPosition(new H(We.viewPosition.lineNumber,We.viewPosition.column),ri),Wr=We.doColumnSelect?De.fromViewLineNumber:Zi.lineNumber,Ps=We.doColumnSelect?De.fromViewVisualColumn:We.mouseColumn-1;return Pb.columnSelect(Ae.cursorConfig,Ae,Wr,Ps,Zi.lineNumber,We.mouseColumn-1)}}),ze.CursorColumnSelectLeft=qe(new class extends i{constructor(){super({id:"cursorColumnSelectLeft",precondition:void 0,kbOpts:{weight:Ci,kbExpr:ce.textInputFocus,primary:3599,linux:{primary:0}}})}_getColumnSelectResult(Ae,ee,De,We){return Pb.columnSelectLeft(Ae.cursorConfig,Ae,De)}}),ze.CursorColumnSelectRight=qe(new class extends i{constructor(){super({id:"cursorColumnSelectRight",precondition:void 0,kbOpts:{weight:Ci,kbExpr:ce.textInputFocus,primary:3601,linux:{primary:0}}})}_getColumnSelectResult(Ae,ee,De,We){return Pb.columnSelectRight(Ae.cursorConfig,Ae,De)}});class a extends i{_isPaged;constructor(ee){super(ee),this._isPaged=ee.isPaged}_getColumnSelectResult(ee,De,We,ri){return Pb.columnSelectUp(ee.cursorConfig,ee,We,this._isPaged)}}ze.CursorColumnSelectUp=qe(new a({isPaged:!1,id:"cursorColumnSelectUp",precondition:void 0,kbOpts:{weight:Ci,kbExpr:ce.textInputFocus,primary:3600,linux:{primary:0}}})),ze.CursorColumnSelectPageUp=qe(new a({isPaged:!0,id:"cursorColumnSelectPageUp",precondition:void 0,kbOpts:{weight:Ci,kbExpr:ce.textInputFocus,primary:3595,linux:{primary:0}}}));class c extends i{_isPaged;constructor(ee){super(ee),this._isPaged=ee.isPaged}_getColumnSelectResult(ee,De,We,ri){return Pb.columnSelectDown(ee.cursorConfig,ee,We,this._isPaged)}}ze.CursorColumnSelectDown=qe(new c({isPaged:!1,id:"cursorColumnSelectDown",precondition:void 0,kbOpts:{weight:Ci,kbExpr:ce.textInputFocus,primary:3602,linux:{primary:0}}})),ze.CursorColumnSelectPageDown=qe(new c({isPaged:!0,id:"cursorColumnSelectPageDown",precondition:void 0,kbOpts:{weight:Ci,kbExpr:ce.textInputFocus,primary:3596,linux:{primary:0}}}));class m extends An{constructor(){super({id:"cursorMove",precondition:void 0,metadata:Vt.metadata})}runCoreEditorCommand(ee,De){let We=Vt.parse(De);We&&this._runCursorMove(ee,De.source,We)}_runCursorMove(ee,De,We){ee.model.pushStackElement(),ee.setCursorStates(De,3,m._move(ee,ee.getCursorStates(),We)),ee.revealAllCursors(De,!0)}static _move(ee,De,We){let ri=We.select,Zi=We.value;switch(We.direction){case Vt.Direction.Left:case Vt.Direction.Right:case Vt.Direction.Up:case Vt.Direction.Down:case Vt.Direction.PrevBlankLine:case Vt.Direction.NextBlankLine:case Vt.Direction.WrappedLineStart:case Vt.Direction.WrappedLineFirstNonWhitespaceCharacter:case Vt.Direction.WrappedLineColumnCenter:case Vt.Direction.WrappedLineEnd:case Vt.Direction.WrappedLineLastNonWhitespaceCharacter:return Ar.simpleMove(ee,De,We.direction,ri,Zi,We.unit);case Vt.Direction.ViewPortTop:case Vt.Direction.ViewPortBottom:case Vt.Direction.ViewPortCenter:case Vt.Direction.ViewPortIfOutside:return Ar.viewportMove(ee,De,We.direction,ri,Zi);default:return null}}}ze.CursorMoveImpl=m,ze.CursorMove=qe(new m);let g;(ee=>ee[ee.PAGE_SIZE_MARKER=-1]="PAGE_SIZE_MARKER")(g||={});class v extends An{_staticArgs;constructor(ee){super(ee),this._staticArgs=ee.args}runCoreEditorCommand(ee,De){let We=this._staticArgs;this._staticArgs.value===-1&&(We={direction:this._staticArgs.direction,unit:this._staticArgs.unit,select:this._staticArgs.select,value:De.pageSize||ee.cursorConfig.pageSize}),ee.model.pushStackElement(),ee.setCursorStates(De.source,3,Ar.simpleMove(ee,ee.getCursorStates(),We.direction,We.select,We.value,We.unit)),ee.revealAllCursors(De.source,!0)}}ze.CursorLeft=qe(new v({args:{direction:Vt.Direction.Left,unit:Vt.Unit.None,select:!1,value:1},id:"cursorLeft",precondition:void 0,kbOpts:{weight:Ci,kbExpr:ce.textInputFocus,primary:15,mac:{primary:15,secondary:[288]}}})),ze.CursorLeftSelect=qe(new v({args:{direction:Vt.Direction.Left,unit:Vt.Unit.None,select:!0,value:1},id:"cursorLeftSelect",precondition:void 0,kbOpts:{weight:Ci,kbExpr:ce.textInputFocus,primary:1039}})),ze.CursorRight=qe(new v({args:{direction:Vt.Direction.Right,unit:Vt.Unit.None,select:!1,value:1},id:"cursorRight",precondition:void 0,kbOpts:{weight:Ci,kbExpr:ce.textInputFocus,primary:17,mac:{primary:17,secondary:[292]}}})),ze.CursorRightSelect=qe(new v({args:{direction:Vt.Direction.Right,unit:Vt.Unit.None,select:!0,value:1},id:"cursorRightSelect",precondition:void 0,kbOpts:{weight:Ci,kbExpr:ce.textInputFocus,primary:1041}})),ze.CursorUp=qe(new v({args:{direction:Vt.Direction.Up,unit:Vt.Unit.WrappedLine,select:!1,value:1},id:"cursorUp",precondition:void 0,kbOpts:{weight:Ci,kbExpr:ce.textInputFocus,primary:16,mac:{primary:16,secondary:[302]}}})),ze.CursorUpSelect=qe(new v({args:{direction:Vt.Direction.Up,unit:Vt.Unit.WrappedLine,select:!0,value:1},id:"cursorUpSelect",precondition:void 0,kbOpts:{weight:Ci,kbExpr:ce.textInputFocus,primary:1040,secondary:[3088],mac:{primary:1040},linux:{primary:1040}}})),ze.CursorPageUp=qe(new v({args:{direction:Vt.Direction.Up,unit:Vt.Unit.WrappedLine,select:!1,value:-1},id:"cursorPageUp",precondition:void 0,kbOpts:{weight:Ci,kbExpr:ce.textInputFocus,primary:11}})),ze.CursorPageUpSelect=qe(new v({args:{direction:Vt.Direction.Up,unit:Vt.Unit.WrappedLine,select:!0,value:-1},id:"cursorPageUpSelect",precondition:void 0,kbOpts:{weight:Ci,kbExpr:ce.textInputFocus,primary:1035}})),ze.CursorDown=qe(new v({args:{direction:Vt.Direction.Down,unit:Vt.Unit.WrappedLine,select:!1,value:1},id:"cursorDown",precondition:void 0,kbOpts:{weight:Ci,kbExpr:ce.textInputFocus,primary:18,mac:{primary:18,secondary:[300]}}})),ze.CursorDownSelect=qe(new v({args:{direction:Vt.Direction.Down,unit:Vt.Unit.WrappedLine,select:!0,value:1},id:"cursorDownSelect",precondition:void 0,kbOpts:{weight:Ci,kbExpr:ce.textInputFocus,primary:1042,secondary:[3090],mac:{primary:1042},linux:{primary:1042}}})),ze.CursorPageDown=qe(new v({args:{direction:Vt.Direction.Down,unit:Vt.Unit.WrappedLine,select:!1,value:-1},id:"cursorPageDown",precondition:void 0,kbOpts:{weight:Ci,kbExpr:ce.textInputFocus,primary:12}})),ze.CursorPageDownSelect=qe(new v({args:{direction:Vt.Direction.Down,unit:Vt.Unit.WrappedLine,select:!0,value:-1},id:"cursorPageDownSelect",precondition:void 0,kbOpts:{weight:Ci,kbExpr:ce.textInputFocus,primary:1036}})),ze.CreateCursor=qe(new class extends An{constructor(){super({id:"createCursor",precondition:void 0})}runCoreEditorCommand(Ae,ee){if(!ee.position)return;let De;ee.wholeLine?De=Ar.line(Ae,Ae.getPrimaryCursorState(),!1,ee.position,ee.viewPosition):De=Ar.moveTo(Ae,Ae.getPrimaryCursorState(),!1,ee.position,ee.viewPosition);let We=Ae.getCursorStates();if(We.length>1){let ri=De.modelState?De.modelState.position:null,Zi=De.viewState?De.viewState.position:null;for(let Wr=0,Ps=We.length;Wr<Ps;Wr++){let Wt=We[Wr];if(!(ri&&!Wt.modelState.selection.containsPosition(ri))&&!(Zi&&!Wt.viewState.selection.containsPosition(Zi))){We.splice(Wr,1),Ae.model.pushStackElement(),Ae.setCursorStates(ee.source,3,We);return}}}We.push(De),Ae.model.pushStackElement(),Ae.setCursorStates(ee.source,3,We)}}),ze.LastCursorMoveToSelect=qe(new class extends An{constructor(){super({id:"_lastCursorMoveToSelect",precondition:void 0})}runCoreEditorCommand(Ae,ee){if(!ee.position)return;let De=Ae.getLastAddedCursorIndex(),We=Ae.getCursorStates(),ri=We.slice(0);ri[De]=Ar.moveTo(Ae,We[De],!0,ee.position,ee.viewPosition),Ae.model.pushStackElement(),Ae.setCursorStates(ee.source,3,ri)}});class be extends An{_inSelectionMode;constructor(ee){super(ee),this._inSelectionMode=ee.inSelectionMode}runCoreEditorCommand(ee,De){ee.model.pushStackElement(),ee.setCursorStates(De.source,3,Ar.moveToBeginningOfLine(ee,ee.getCursorStates(),this._inSelectionMode)),ee.revealAllCursors(De.source,!0)}}ze.CursorHome=qe(new be({inSelectionMode:!1,id:"cursorHome",precondition:void 0,kbOpts:{weight:Ci,kbExpr:ce.textInputFocus,primary:14,mac:{primary:14,secondary:[2063]}}})),ze.CursorHomeSelect=qe(new be({inSelectionMode:!0,id:"cursorHomeSelect",precondition:void 0,kbOpts:{weight:Ci,kbExpr:ce.textInputFocus,primary:1038,mac:{primary:1038,secondary:[3087]}}}));class Ee extends An{_inSelectionMode;constructor(ee){super(ee),this._inSelectionMode=ee.inSelectionMode}runCoreEditorCommand(ee,De){ee.model.pushStackElement(),ee.setCursorStates(De.source,3,this._exec(ee.getCursorStates())),ee.revealAllCursors(De.source,!0)}_exec(ee){let De=[];for(let We=0,ri=ee.length;We<ri;We++){let Zi=ee[We],Wr=Zi.modelState.position.lineNumber;De[We]=Zt.fromModelState(Zi.modelState.move(this._inSelectionMode,Wr,1,0))}return De}}ze.CursorLineStart=qe(new Ee({inSelectionMode:!1,id:"cursorLineStart",precondition:void 0,kbOpts:{weight:Ci,kbExpr:ce.textInputFocus,primary:0,mac:{primary:287}}})),ze.CursorLineStartSelect=qe(new Ee({inSelectionMode:!0,id:"cursorLineStartSelect",precondition:void 0,kbOpts:{weight:Ci,kbExpr:ce.textInputFocus,primary:0,mac:{primary:1311}}}));class pe extends An{_inSelectionMode;constructor(ee){super(ee),this._inSelectionMode=ee.inSelectionMode}runCoreEditorCommand(ee,De){ee.model.pushStackElement(),ee.setCursorStates(De.source,3,Ar.moveToEndOfLine(ee,ee.getCursorStates(),this._inSelectionMode,De.sticky||!1)),ee.revealAllCursors(De.source,!0)}}ze.CursorEnd=qe(new pe({inSelectionMode:!1,id:"cursorEnd",precondition:void 0,kbOpts:{args:{sticky:!1},weight:Ci,kbExpr:ce.textInputFocus,primary:13,mac:{primary:13,secondary:[2065]}},metadata:{description:"Go to End",args:[{name:"args",schema:{type:"object",properties:{sticky:{description:u("stickydesc","Stick to the end even when going to longer lines"),type:"boolean",default:!1}}}}]}})),ze.CursorEndSelect=qe(new pe({inSelectionMode:!0,id:"cursorEndSelect",precondition:void 0,kbOpts:{args:{sticky:!1},weight:Ci,kbExpr:ce.textInputFocus,primary:1037,mac:{primary:1037,secondary:[3089]}},metadata:{description:"Select to End",args:[{name:"args",schema:{type:"object",properties:{sticky:{description:u("stickydesc","Stick to the end even when going to longer lines"),type:"boolean",default:!1}}}}]}}));class at extends An{_inSelectionMode;constructor(ee){super(ee),this._inSelectionMode=ee.inSelectionMode}runCoreEditorCommand(ee,De){ee.model.pushStackElement(),ee.setCursorStates(De.source,3,this._exec(ee,ee.getCursorStates())),ee.revealAllCursors(De.source,!0)}_exec(ee,De){let We=[];for(let ri=0,Zi=De.length;ri<Zi;ri++){let Wr=De[ri],Ps=Wr.modelState.position.lineNumber,Wt=ee.model.getLineMaxColumn(Ps);We[ri]=Zt.fromModelState(Wr.modelState.move(this._inSelectionMode,Ps,Wt,0))}return We}}ze.CursorLineEnd=qe(new at({inSelectionMode:!1,id:"cursorLineEnd",precondition:void 0,kbOpts:{weight:Ci,kbExpr:ce.textInputFocus,primary:0,mac:{primary:291}}})),ze.CursorLineEndSelect=qe(new at({inSelectionMode:!0,id:"cursorLineEndSelect",precondition:void 0,kbOpts:{weight:Ci,kbExpr:ce.textInputFocus,primary:0,mac:{primary:1315}}}));class Ro extends An{_inSelectionMode;constructor(ee){super(ee),this._inSelectionMode=ee.inSelectionMode}runCoreEditorCommand(ee,De){ee.model.pushStackElement(),ee.setCursorStates(De.source,3,Ar.moveToBeginningOfBuffer(ee,ee.getCursorStates(),this._inSelectionMode)),ee.revealAllCursors(De.source,!0)}}ze.CursorTop=qe(new Ro({inSelectionMode:!1,id:"cursorTop",precondition:void 0,kbOpts:{weight:Ci,kbExpr:ce.textInputFocus,primary:2062,mac:{primary:2064}}})),ze.CursorTopSelect=qe(new Ro({inSelectionMode:!0,id:"cursorTopSelect",precondition:void 0,kbOpts:{weight:Ci,kbExpr:ce.textInputFocus,primary:3086,mac:{primary:3088}}}));class Qi extends An{_inSelectionMode;constructor(ee){super(ee),this._inSelectionMode=ee.inSelectionMode}runCoreEditorCommand(ee,De){ee.model.pushStackElement(),ee.setCursorStates(De.source,3,Ar.moveToEndOfBuffer(ee,ee.getCursorStates(),this._inSelectionMode)),ee.revealAllCursors(De.source,!0)}}ze.CursorBottom=qe(new Qi({inSelectionMode:!1,id:"cursorBottom",precondition:void 0,kbOpts:{weight:Ci,kbExpr:ce.textInputFocus,primary:2061,mac:{primary:2066}}})),ze.CursorBottomSelect=qe(new Qi({inSelectionMode:!0,id:"cursorBottomSelect",precondition:void 0,kbOpts:{weight:Ci,kbExpr:ce.textInputFocus,primary:3085,mac:{primary:3090}}}));class dp extends An{constructor(){super({id:"editorScroll",precondition:void 0,metadata:Ds.metadata})}determineScrollMethod(ee){let De=[6],We=[1,2,3,4,5,6],ri=[4,2],Zi=[1,3];return De.includes(ee.unit)&&ri.includes(ee.direction)?this._runHorizontalEditorScroll.bind(this):We.includes(ee.unit)&&Zi.includes(ee.direction)?this._runVerticalEditorScroll.bind(this):null}runCoreEditorCommand(ee,De){let We=Ds.parse(De);if(!We)return;let ri=this.determineScrollMethod(We);ri&&ri(ee,De.source,We)}_runVerticalEditorScroll(ee,De,We){let ri=this._computeDesiredScrollTop(ee,We);if(We.revealCursor){let Zi=ee.getCompletelyVisibleViewRangeAtScrollTop(ri);ee.setCursorStates(De,3,[Ar.findPositionInViewportIfOutside(ee,ee.getPrimaryCursorState(),Zi,We.select)])}ee.viewLayout.setScrollPosition({scrollTop:ri},0)}_computeDesiredScrollTop(ee,De){if(De.unit===1){let Zi=ee.viewLayout.getFutureViewport(),Wr=ee.getCompletelyVisibleViewRangeAtScrollTop(Zi.top),Ps=ee.coordinatesConverter.convertViewRangeToModelRange(Wr),Wt;De.direction===1?Wt=Math.max(1,Ps.startLineNumber-De.value):Wt=Math.min(ee.model.getLineCount(),Ps.startLineNumber+De.value);let W=ee.coordinatesConverter.convertModelPositionToViewPosition(new H(Wt,1));return ee.viewLayout.getVerticalOffsetForLineNumber(W.lineNumber)}if(De.unit===5){let Zi=0;return De.direction===3&&(Zi=ee.model.getLineCount()-ee.cursorConfig.pageSize),ee.viewLayout.getVerticalOffsetForLineNumber(Zi)}let We;De.unit===3?We=ee.cursorConfig.pageSize*De.value:De.unit===4?We=Math.round(ee.cursorConfig.pageSize/2)*De.value:We=De.value;let ri=(De.direction===1?-1:1)*We;return ee.viewLayout.getCurrentScrollTop()+ri*ee.cursorConfig.lineHeight}_runHorizontalEditorScroll(ee,De,We){let ri=this._computeDesiredScrollLeft(ee,We);ee.viewLayout.setScrollPosition({scrollLeft:ri},0)}_computeDesiredScrollLeft(ee,De){let We=(De.direction===4?-1:1)*De.value;return ee.viewLayout.getCurrentScrollLeft()+We*ee.cursorConfig.typicalHalfwidthCharacterWidth}}ze.EditorScrollImpl=dp,ze.EditorScroll=qe(new dp),ze.ScrollLineUp=qe(new class extends An{constructor(){super({id:"scrollLineUp",precondition:void 0,kbOpts:{weight:Ci,kbExpr:ce.textInputFocus,primary:2064,mac:{primary:267}}})}runCoreEditorCommand(Ae,ee){ze.EditorScroll.runCoreEditorCommand(Ae,{to:Ds.RawDirection.Up,by:Ds.RawUnit.WrappedLine,value:1,revealCursor:!1,select:!1,source:ee.source})}}),ze.ScrollPageUp=qe(new class extends An{constructor(){super({id:"scrollPageUp",precondition:void 0,kbOpts:{weight:Ci,kbExpr:ce.textInputFocus,primary:2059,win:{primary:523},linux:{primary:523}}})}runCoreEditorCommand(Ae,ee){ze.EditorScroll.runCoreEditorCommand(Ae,{to:Ds.RawDirection.Up,by:Ds.RawUnit.Page,value:1,revealCursor:!1,select:!1,source:ee.source})}}),ze.ScrollEditorTop=qe(new class extends An{constructor(){super({id:"scrollEditorTop",precondition:void 0,kbOpts:{weight:Ci,kbExpr:ce.textInputFocus}})}runCoreEditorCommand(Ae,ee){ze.EditorScroll.runCoreEditorCommand(Ae,{to:Ds.RawDirection.Up,by:Ds.RawUnit.Editor,value:1,revealCursor:!1,select:!1,source:ee.source})}}),ze.ScrollLineDown=qe(new class extends An{constructor(){super({id:"scrollLineDown",precondition:void 0,kbOpts:{weight:Ci,kbExpr:ce.textInputFocus,primary:2066,mac:{primary:268}}})}runCoreEditorCommand(Ae,ee){ze.EditorScroll.runCoreEditorCommand(Ae,{to:Ds.RawDirection.Down,by:Ds.RawUnit.WrappedLine,value:1,revealCursor:!1,select:!1,source:ee.source})}}),ze.ScrollPageDown=qe(new class extends An{constructor(){super({id:"scrollPageDown",precondition:void 0,kbOpts:{weight:Ci,kbExpr:ce.textInputFocus,primary:2060,win:{primary:524},linux:{primary:524}}})}runCoreEditorCommand(Ae,ee){ze.EditorScroll.runCoreEditorCommand(Ae,{to:Ds.RawDirection.Down,by:Ds.RawUnit.Page,value:1,revealCursor:!1,select:!1,source:ee.source})}}),ze.ScrollEditorBottom=qe(new class extends An{constructor(){super({id:"scrollEditorBottom",precondition:void 0,kbOpts:{weight:Ci,kbExpr:ce.textInputFocus}})}runCoreEditorCommand(Ae,ee){ze.EditorScroll.runCoreEditorCommand(Ae,{to:Ds.RawDirection.Down,by:Ds.RawUnit.Editor,value:1,revealCursor:!1,select:!1,source:ee.source})}}),ze.ScrollLeft=qe(new class extends An{constructor(){super({id:"scrollLeft",precondition:void 0,kbOpts:{weight:Ci,kbExpr:ce.textInputFocus}})}runCoreEditorCommand(Ae,ee){ze.EditorScroll.runCoreEditorCommand(Ae,{to:Ds.RawDirection.Left,by:Ds.RawUnit.Column,value:2,revealCursor:!1,select:!1,source:ee.source})}}),ze.ScrollRight=qe(new class extends An{constructor(){super({id:"scrollRight",precondition:void 0,kbOpts:{weight:Ci,kbExpr:ce.textInputFocus}})}runCoreEditorCommand(Ae,ee){ze.EditorScroll.runCoreEditorCommand(Ae,{to:Ds.RawDirection.Right,by:Ds.RawUnit.Column,value:2,revealCursor:!1,select:!1,source:ee.source})}});class Ka extends An{_inSelectionMode;constructor(ee){super(ee),this._inSelectionMode=ee.inSelectionMode}runCoreEditorCommand(ee,De){De.position&&(ee.model.pushStackElement(),ee.setCursorStates(De.source,3,[Ar.word(ee,ee.getPrimaryCursorState(),this._inSelectionMode,De.position)]),De.revealType!==2&&ee.revealAllCursors(De.source,!0,!0))}}ze.WordSelect=qe(new Ka({inSelectionMode:!1,id:"_wordSelect",precondition:void 0})),ze.WordSelectDrag=qe(new Ka({inSelectionMode:!0,id:"_wordSelectDrag",precondition:void 0})),ze.LastCursorWordSelect=qe(new class extends An{constructor(){super({id:"lastCursorWordSelect",precondition:void 0})}runCoreEditorCommand(Ae,ee){if(!ee.position)return;let De=Ae.getLastAddedCursorIndex(),We=Ae.getCursorStates(),ri=We.slice(0),Zi=We[De];ri[De]=Ar.word(Ae,Zi,Zi.modelState.hasSelection(),ee.position),Ae.model.pushStackElement(),Ae.setCursorStates(ee.source,3,ri)}});class cp extends An{_inSelectionMode;constructor(ee){super(ee),this._inSelectionMode=ee.inSelectionMode}runCoreEditorCommand(ee,De){De.position&&(ee.model.pushStackElement(),ee.setCursorStates(De.source,3,[Ar.line(ee,ee.getPrimaryCursorState(),this._inSelectionMode,De.position,De.viewPosition)]),De.revealType!==2&&ee.revealAllCursors(De.source,!1,!0))}}ze.LineSelect=qe(new cp({inSelectionMode:!1,id:"_lineSelect",precondition:void 0})),ze.LineSelectDrag=qe(new cp({inSelectionMode:!0,id:"_lineSelectDrag",precondition:void 0}));class ld extends An{_inSelectionMode;constructor(ee){super(ee),this._inSelectionMode=ee.inSelectionMode}runCoreEditorCommand(ee,De){if(!De.position)return;let We=ee.getLastAddedCursorIndex(),ri=ee.getCursorStates(),Zi=ri.slice(0);Zi[We]=Ar.line(ee,ri[We],this._inSelectionMode,De.position,De.viewPosition),ee.model.pushStackElement(),ee.setCursorStates(De.source,3,Zi)}}ze.LastCursorLineSelect=qe(new ld({inSelectionMode:!1,id:"lastCursorLineSelect",precondition:void 0})),ze.LastCursorLineSelectDrag=qe(new ld({inSelectionMode:!0,id:"lastCursorLineSelectDrag",precondition:void 0})),ze.CancelSelection=qe(new class extends An{constructor(){super({id:"cancelSelection",precondition:ce.hasNonEmptySelection,kbOpts:{weight:Ci,kbExpr:ce.textInputFocus,primary:9,secondary:[1033]}})}runCoreEditorCommand(Ae,ee){Ae.model.pushStackElement(),Ae.setCursorStates(ee.source,3,[Ar.cancelSelection(Ae,Ae.getPrimaryCursorState())]),Ae.revealAllCursors(ee.source,!0)}}),ze.RemoveSecondaryCursors=qe(new class extends An{constructor(){super({id:"removeSecondaryCursors",precondition:ce.hasMultipleSelections,kbOpts:{weight:Ci+1,kbExpr:ce.textInputFocus,primary:9,secondary:[1033]}})}runCoreEditorCommand(Ae,ee){Ae.model.pushStackElement(),Ae.setCursorStates(ee.source,3,[Ae.getPrimaryCursorState()]),Ae.revealAllCursors(ee.source,!0),La(u("removedCursor","Removed secondary cursors"))}}),ze.RevealLine=qe(new class extends An{constructor(){super({id:"revealLine",precondition:void 0,metadata:gR.metadata})}runCoreEditorCommand(Ae,ee){let De=ee,We=De.lineNumber||0,ri=typeof We=="number"?We+1:parseInt(We)+1;ri<1&&(ri=1);let Zi=Ae.model.getLineCount();ri>Zi&&(ri=Zi);let Wr=new L(ri,1,ri,Ae.model.getLineMaxColumn(ri)),Ps=0;if(De.at)switch(De.at){case gR.RawAtArgument.Top:Ps=3;break;case gR.RawAtArgument.Center:Ps=1;break;case gR.RawAtArgument.Bottom:Ps=4;break;default:break}let Wt=Ae.coordinatesConverter.convertModelRangeToViewRange(Wr);Ae.revealRange(ee.source,!1,Wt,Ps,0)}}),ze.SelectAll=new class extends fR{constructor(){super(Joe)}runDOMCommand(Ae){po&&(Ae.focus(),Ae.select()),Ae.ownerDocument.execCommand("selectAll")}runEditorCommand(Ae,ee,De){let We=ee._getViewModel();We&&this.runCoreEditorCommand(We,De)}runCoreEditorCommand(Ae,ee){Ae.model.pushStackElement(),Ae.setCursorStates("keyboard",3,[Ar.selectAll(Ae,Ae.getPrimaryCursorState())])}},ze.SetSelection=qe(new class extends An{constructor(){super({id:"setSelection",precondition:void 0})}runCoreEditorCommand(Ae,ee){ee.selection&&(Ae.model.pushStackElement(),Ae.setCursorStates(ee.source,3,[Zt.fromModelSelection(ee.selection)]))}})})(br||={});var NEe=P.and(ce.textInputFocus,ce.columnSelection);function zE(r,t){wt.registerKeybindingRule({id:r,primary:t,when:NEe,weight:Ci+1})}zE(br.CursorColumnSelectLeft.id,1039);zE(br.CursorColumnSelectRight.id,1041);zE(br.CursorColumnSelectUp.id,1040);zE(br.CursorColumnSelectPageUp.id,1035);zE(br.CursorColumnSelectDown.id,1042);zE(br.CursorColumnSelectPageDown.id,1036);function Mce(r){return r.register(),r}var Bq;(l=>{class r extends _r{runEditorCommand(c,p,h){let m=p._getViewModel();m&&this.runCoreEditingCommand(p,m,h||{})}}l.CoreEditingCommand=r,l.LineBreakInsert=qe(new class extends r{constructor(){super({id:"lineBreakInsert",precondition:ce.writable,kbOpts:{weight:Ci,kbExpr:ce.textInputFocus,primary:0,mac:{primary:301}}})}runCoreEditingCommand(d,c,p){d.pushUndoStop(),d.executeCommands(this.id,VE.lineBreakInsert(c.cursorConfig,c.model,c.getCursorStates().map(h=>h.modelState.selection)))}}),l.Outdent=qe(new class extends r{constructor(){super({id:"outdent",precondition:ce.writable,kbOpts:{weight:Ci,kbExpr:P.and(ce.editorTextFocus,ce.tabDoesNotMoveFocus),primary:1026}})}runCoreEditingCommand(d,c,p){d.pushUndoStop(),d.executeCommands(this.id,Fu.outdent(c.cursorConfig,c.model,c.getCursorStates().map(h=>h.modelState.selection))),d.pushUndoStop()}}),l.Tab=qe(new class extends r{constructor(){super({id:"tab",precondition:ce.writable,kbOpts:{weight:Ci,kbExpr:P.and(ce.editorTextFocus,ce.tabDoesNotMoveFocus),primary:2}})}runCoreEditingCommand(d,c,p){d.pushUndoStop(),d.executeCommands(this.id,Fu.tab(c.cursorConfig,c.model,c.getCursorStates().map(h=>h.modelState.selection))),d.pushUndoStop()}}),l.DeleteLeft=qe(new class extends r{constructor(){super({id:"deleteLeft",precondition:void 0,kbOpts:{weight:Ci,kbExpr:ce.textInputFocus,primary:1,secondary:[1025],mac:{primary:1,secondary:[1025,294,257]}}})}runCoreEditingCommand(d,c,p){let[h,m]=ug.deleteLeft(c.getPrevEditOperationType(),c.cursorConfig,c.model,c.getCursorStates().map(f=>f.modelState.selection),c.getCursorAutoClosedCharacters());h&&d.pushUndoStop(),d.executeCommands(this.id,m),c.setPrevEditOperationType(2)}}),l.DeleteRight=qe(new class extends r{constructor(){super({id:"deleteRight",precondition:void 0,kbOpts:{weight:Ci,kbExpr:ce.textInputFocus,primary:20,mac:{primary:20,secondary:[290,276]}}})}runCoreEditingCommand(d,c,p){let[h,m]=ug.deleteRight(c.getPrevEditOperationType(),c.cursorConfig,c.model,c.getCursorStates().map(f=>f.modelState.selection));h&&d.pushUndoStop(),d.executeCommands(this.id,m),c.setPrevEditOperationType(3)}}),l.Undo=new class extends fR{constructor(){super(M8)}runDOMCommand(d){d.ownerDocument.execCommand("undo")}runEditorCommand(d,c,p){if(!(!c.hasModel()||c.getOption(93)===!0))return c.getModel().undo()}},l.Redo=new class extends fR{constructor(){super(A8)}runDOMCommand(d){d.ownerDocument.execCommand("redo")}runEditorCommand(d,c,p){if(!(!c.hasModel()||c.getOption(93)===!0))return c.getModel().redo()}}})(Bq||={});var hW=class extends MI{_handlerId;constructor(t,e,i){super({id:t,precondition:void 0,metadata:i}),this._handlerId=e}runCommand(t,e){let i=t.get(En).getFocusedCodeEditor();i&&i.trigger("keyboard",this._handlerId,e)}};function Ey(r,t){Mce(new hW("default:"+r,r)),Mce(new hW(r,r,t))}Ey("type",{description:"Type",args:[{name:"args",schema:{type:"object",required:["text"],properties:{text:{type:"string"}}}}]});Ey("replacePreviousChar");Ey("compositionType");Ey("compositionStart");Ey("compositionEnd");Ey("paste");Ey("cut");var KE=class r{onKeyDown=null;onKeyUp=null;onContextMenu=null;onMouseMove=null;onMouseLeave=null;onMouseDown=null;onMouseUp=null;onMouseDrag=null;onMouseDrop=null;onMouseDropCanceled=null;onMouseWheel=null;_coordinatesConverter;constructor(t){this._coordinatesConverter=t}emitKeyDown(t){this.onKeyDown?.(t)}emitKeyUp(t){this.onKeyUp?.(t)}emitContextMenu(t){this.onContextMenu?.(this._convertViewToModelMouseEvent(t))}emitMouseMove(t){this.onMouseMove?.(this._convertViewToModelMouseEvent(t))}emitMouseLeave(t){this.onMouseLeave?.(this._convertViewToModelMouseEvent(t))}emitMouseDown(t){this.onMouseDown?.(this._convertViewToModelMouseEvent(t))}emitMouseUp(t){this.onMouseUp?.(this._convertViewToModelMouseEvent(t))}emitMouseDrag(t){this.onMouseDrag?.(this._convertViewToModelMouseEvent(t))}emitMouseDrop(t){this.onMouseDrop?.(this._convertViewToModelMouseEvent(t))}emitMouseDropCanceled(){this.onMouseDropCanceled?.()}emitMouseWheel(t){this.onMouseWheel?.(t)}_convertViewToModelMouseEvent(t){return t.target?{event:t.event,target:this._convertViewToModelMouseTarget(t.target)}:t}_convertViewToModelMouseTarget(t){return r.convertViewToModelMouseTarget(t,this._coordinatesConverter)}static convertViewToModelMouseTarget(t,e){let i={...t};return i.position&&(i.position=e.convertViewPositionToModelPosition(i.position)),i.range&&(i.range=e.convertViewRangeToModelRange(i.range)),(i.type===5||i.type===8)&&(i.detail=this.convertViewToModelViewZoneData(i.detail,e)),i}static convertViewToModelViewZoneData(t,e){return{viewZoneId:t.viewZoneId,positionBefore:t.positionBefore?e.convertViewPositionToModelPosition(t.positionBefore):t.positionBefore,positionAfter:t.positionAfter?e.convertViewPositionToModelPosition(t.positionAfter):t.positionAfter,position:e.convertViewPositionToModelPosition(t.position),afterLineNumber:e.convertViewPositionToModelPosition(new H(t.afterLineNumber,1)).lineNumber}}};var mW=class{configuration;viewModel;userInputEvents;commandDelegate;constructor(t,e,i,n){this.configuration=t,this.viewModel=e,this.userInputEvents=i,this.commandDelegate=n}paste(t,e,i,n){this.commandDelegate.paste(t,e,i,n)}type(t){this.commandDelegate.type(t)}compositionType(t,e,i,n){this.commandDelegate.compositionType(t,e,i,n)}compositionStart(){this.commandDelegate.startComposition()}compositionEnd(){this.commandDelegate.endComposition()}cut(){this.commandDelegate.cut()}setSelection(t){br.SetSelection.runCoreEditorCommand(this.viewModel,{source:"keyboard",selection:t})}_validateViewColumn(t){let e=this.viewModel.getLineMinColumn(t.lineNumber);return t.column<e?new H(t.lineNumber,e):t}_hasMulticursorModifier(t){switch(this.configuration.options.get(79)){case"altKey":return t.altKey;case"ctrlKey":return t.ctrlKey;case"metaKey":return t.metaKey;default:return!1}}_hasNonMulticursorModifier(t){switch(this.configuration.options.get(79)){case"altKey":return t.ctrlKey||t.metaKey;case"ctrlKey":return t.altKey||t.metaKey;case"metaKey":return t.ctrlKey||t.altKey;default:return!1}}dispatchMouse(t){let e=this.configuration.options,i=ci&&e.get(109),n=e.get(22);t.middleButton&&!i?this._columnSelect(t.position,t.mouseColumn,t.inSelectionMode):t.startedOnLineNumbers?this._hasMulticursorModifier(t)?t.inSelectionMode?this._lastCursorLineSelect(t.position,t.revealType):this._createCursor(t.position,!0):t.inSelectionMode?this._lineSelectDrag(t.position,t.revealType):this._lineSelect(t.position,t.revealType):t.mouseDownCount>=4?this._selectAll():t.mouseDownCount===3?this._hasMulticursorModifier(t)?t.inSelectionMode?this._lastCursorLineSelectDrag(t.position,t.revealType):this._lastCursorLineSelect(t.position,t.revealType):t.inSelectionMode?this._lineSelectDrag(t.position,t.revealType):this._lineSelect(t.position,t.revealType):t.mouseDownCount===2?t.onInjectedText||(this._hasMulticursorModifier(t)?this._lastCursorWordSelect(t.position,t.revealType):t.inSelectionMode?this._wordSelectDrag(t.position,t.revealType):this._wordSelect(t.position,t.revealType)):this._hasMulticursorModifier(t)?this._hasNonMulticursorModifier(t)||(t.shiftKey?this._columnSelect(t.position,t.mouseColumn,!0):t.inSelectionMode?this._lastCursorMoveToSelect(t.position,t.revealType):this._createCursor(t.position,!1)):t.inSelectionMode?t.altKey?this._columnSelect(t.position,t.mouseColumn,!0):n?this._columnSelect(t.position,t.mouseColumn,!0):this._moveToSelect(t.position,t.revealType):this.moveTo(t.position,t.revealType)}_usualArgs(t,e){return t=this._validateViewColumn(t),{source:"mouse",position:this._convertViewToModelPosition(t),viewPosition:t,revealType:e}}moveTo(t,e){br.MoveTo.runCoreEditorCommand(this.viewModel,this._usualArgs(t,e))}_moveToSelect(t,e){br.MoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(t,e))}_columnSelect(t,e,i){t=this._validateViewColumn(t),br.ColumnSelect.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(t),viewPosition:t,mouseColumn:e,doColumnSelect:i})}_createCursor(t,e){t=this._validateViewColumn(t),br.CreateCursor.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(t),viewPosition:t,wholeLine:e})}_lastCursorMoveToSelect(t,e){br.LastCursorMoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(t,e))}_wordSelect(t,e){br.WordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(t,e))}_wordSelectDrag(t,e){br.WordSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(t,e))}_lastCursorWordSelect(t,e){br.LastCursorWordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(t,e))}_lineSelect(t,e){br.LineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(t,e))}_lineSelectDrag(t,e){br.LineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(t,e))}_lastCursorLineSelect(t,e){br.LastCursorLineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(t,e))}_lastCursorLineSelectDrag(t,e){br.LastCursorLineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(t,e))}_selectAll(){br.SelectAll.runCoreEditorCommand(this.viewModel,{source:"mouse"})}_convertViewToModelPosition(t){return this.viewModel.coordinatesConverter.convertViewPositionToModelPosition(t)}emitKeyDown(t){this.userInputEvents.emitKeyDown(t)}emitKeyUp(t){this.userInputEvents.emitKeyUp(t)}emitContextMenu(t){this.userInputEvents.emitContextMenu(t)}emitMouseMove(t){this.userInputEvents.emitMouseMove(t)}emitMouseLeave(t){this.userInputEvents.emitMouseLeave(t)}emitMouseUp(t){this.userInputEvents.emitMouseUp(t)}emitMouseDown(t){this.userInputEvents.emitMouseDown(t)}emitMouseDrag(t){this.userInputEvents.emitMouseDrag(t)}emitMouseDrop(t){this.userInputEvents.emitMouseDrop(t)}emitMouseDropCanceled(){this.userInputEvents.emitMouseDropCanceled()}emitMouseWheel(t){this.userInputEvents.emitMouseWheel(t)}};var GE=class extends bc{_context;viewController;viewHelper;mouseTargetFactory;_mouseDownOperation;lastMouseLeaveTime;_height;_mouseLeaveMonitor=null;constructor(t,e,i){super(),this._context=t,this.viewController=e,this.viewHelper=i,this.mouseTargetFactory=new NE(this._context,i),this._mouseDownOperation=this._register(new Vq(this._context,this.viewController,this.viewHelper,this.mouseTargetFactory,(s,a)=>this._createMouseTarget(s,a),s=>this._getMouseColumn(s))),this.lastMouseLeaveTime=-1,this._height=this._context.configuration.options.get(147).height;let n=new LV(this.viewHelper.viewDomNode);this._register(n.onContextMenu(this.viewHelper.viewDomNode,s=>this._onContextMenu(s,!0))),this._register(n.onMouseMove(this.viewHelper.viewDomNode,s=>{this._onMouseMove(s),this._mouseLeaveMonitor||(this._mouseLeaveMonitor=F(this.viewHelper.viewDomNode.ownerDocument,"mousemove",a=>{this.viewHelper.viewDomNode.contains(a.target)||this._onMouseLeave(new Rc(a,!1,this.viewHelper.viewDomNode))}))})),this._register(n.onMouseUp(this.viewHelper.viewDomNode,s=>this._onMouseUp(s))),this._register(n.onMouseLeave(this.viewHelper.viewDomNode,s=>this._onMouseLeave(s)));let o=0;this._register(n.onPointerDown(this.viewHelper.viewDomNode,(s,a)=>{o=a})),this._register(F(this.viewHelper.viewDomNode,Q.POINTER_UP,s=>{this._mouseDownOperation.onPointerUp()})),this._register(n.onMouseDown(this.viewHelper.viewDomNode,s=>this._onMouseDown(s,o))),this._setupMouseWheelZoomListener(),this._context.addEventHandler(this)}_setupMouseWheelZoomListener(){let t=Bk.INSTANCE,e=0,i=Pp.getZoomLevel(),n=!1,o=0,s=l=>{if(this.viewController.emitMouseWheel(l),!this._context.configuration.options.get(77))return;let d=new Id(l);if(t.acceptStandardWheelEvent(d),t.isPhysicalMouseWheel()){if(a(l)){let c=Pp.getZoomLevel(),p=d.deltaY>0?1:-1;Pp.setZoomLevel(c+p),d.preventDefault(),d.stopPropagation()}}else Date.now()-e>50&&(i=Pp.getZoomLevel(),n=a(l),o=0),e=Date.now(),o+=d.deltaY,n&&(Pp.setZoomLevel(i+o/5),d.preventDefault(),d.stopPropagation())};this._register(F(this.viewHelper.viewDomNode,Q.MOUSE_WHEEL,s,{capture:!0,passive:!1}));function a(l){return ye?(l.metaKey||l.ctrlKey)&&!l.shiftKey&&!l.altKey:l.ctrlKey&&!l.metaKey&&!l.shiftKey&&!l.altKey}}dispose(){this._context.removeEventHandler(this),this._mouseLeaveMonitor&&(this._mouseLeaveMonitor.dispose(),this._mouseLeaveMonitor=null),super.dispose()}onConfigurationChanged(t){if(t.hasChanged(147)){let e=this._context.configuration.options.get(147).height;this._height!==e&&(this._height=e,this._mouseDownOperation.onHeightChanged())}return!1}onCursorStateChanged(t){return this._mouseDownOperation.onCursorStateChanged(t),!1}onFocusChanged(t){return!1}getTargetAtClientPoint(t,e){let n=new iR(t,e).toPageCoordinates(ue(this.viewHelper.viewDomNode)),o=MV(this.viewHelper.viewDomNode);if(n.y<o.y||n.y>o.y+o.height||n.x<o.x||n.x>o.x+o.width)return null;let s=AV(this.viewHelper.viewDomNode,o,n);return this.mouseTargetFactory.createMouseTarget(this.viewHelper.getLastRenderData(),o,n,s,null)}_createMouseTarget(t,e){let i=t.target;if(!this.viewHelper.viewDomNode.contains(i)){let n=tu(this.viewHelper.viewDomNode);n&&(i=n.elementsFromPoint(t.posx,t.posy).find(o=>this.viewHelper.viewDomNode.contains(o)))}return this.mouseTargetFactory.createMouseTarget(this.viewHelper.getLastRenderData(),t.editorPos,t.pos,t.relativePos,e?i:null)}_getMouseColumn(t){return this.mouseTargetFactory.getMouseColumn(t.relativePos)}_onContextMenu(t,e){this.viewController.emitContextMenu({event:t,target:this._createMouseTarget(t,e)})}_onMouseMove(t){this.mouseTargetFactory.mouseTargetIsWidget(t)||t.preventDefault(),!(this._mouseDownOperation.isActive()||t.timestamp<this.lastMouseLeaveTime)&&this.viewController.emitMouseMove({event:t,target:this._createMouseTarget(t,!0)})}_onMouseLeave(t){this._mouseLeaveMonitor&&(this._mouseLeaveMonitor.dispose(),this._mouseLeaveMonitor=null),this.lastMouseLeaveTime=new Date().getTime(),this.viewController.emitMouseLeave({event:t,target:null})}_onMouseUp(t){this.viewController.emitMouseUp({event:t,target:this._createMouseTarget(t,!0)})}_onMouseDown(t,e){let i=this._createMouseTarget(t,!0),n=i.type===6||i.type===7,o=i.type===2||i.type===3||i.type===4,s=i.type===3,a=this._context.configuration.options.get(111),l=i.type===8||i.type===5,d=i.type===9,c=t.leftButton||t.middleButton;ye&&t.leftButton&&t.ctrlKey&&(c=!1);let p=()=>{t.preventDefault(),this.viewHelper.focusTextArea()};if(c&&(n||s&&a))p(),this._mouseDownOperation.start(i.type,t,e);else if(o)t.preventDefault();else if(l){let h=i.detail;c&&this.viewHelper.shouldSuppressMouseDownOnViewZone(h.viewZoneId)&&(p(),this._mouseDownOperation.start(i.type,t,e),t.preventDefault())}else d&&this.viewHelper.shouldSuppressMouseDownOnWidget(i.detail)&&(p(),t.preventDefault());this.viewController.emitMouseDown({event:t,target:i})}_onMouseWheel(t){this.viewController.emitMouseWheel(t)}},Vq=class extends R{constructor(e,i,n,o,s,a){super();this._context=e;this._viewController=i;this._viewHelper=n;this._mouseTargetFactory=o;this._createMouseTarget=s,this._getMouseColumn=a,this._mouseMoveMonitor=this._register(new PV(this._viewHelper.viewDomNode)),this._topBottomDragScrolling=this._register(new Wq(this._context,this._viewHelper,this._mouseTargetFactory,(l,d,c)=>this._dispatchMouse(l,d,c))),this._mouseState=new Uq,this._currentSelection=new Et(1,1,1,1),this._isActive=!1,this._lastMouseEvent=null}_createMouseTarget;_getMouseColumn;_mouseMoveMonitor;_topBottomDragScrolling;_mouseState;_currentSelection;_isActive;_lastMouseEvent;dispose(){super.dispose()}isActive(){return this._isActive}_onMouseDownThenMove(e){this._lastMouseEvent=e,this._mouseState.setModifiers(e);let i=this._findMousePosition(e,!1);i&&(this._mouseState.isDragAndDrop?this._viewController.emitMouseDrag({event:e,target:i}):i.type===13&&(i.outsidePosition==="above"||i.outsidePosition==="below")?this._topBottomDragScrolling.start(i,e):(this._topBottomDragScrolling.stop(),this._dispatchMouse(i,!0,1)))}start(e,i,n){this._lastMouseEvent=i,this._mouseState.setStartedOnLineNumbers(e===3),this._mouseState.setStartButtons(i),this._mouseState.setModifiers(i);let o=this._findMousePosition(i,!0);if(!o||!o.position)return;this._mouseState.trySetCount(i.detail,o.position),i.detail=this._mouseState.count;let s=this._context.configuration.options;if(!s.get(93)&&s.get(35)&&!s.get(22)&&!this._mouseState.altKey&&i.detail<2&&!this._isActive&&!this._currentSelection.isEmpty()&&o.type===6&&o.position&&this._currentSelection.containsPosition(o.position)){this._mouseState.isDragAndDrop=!0,this._isActive=!0,this._mouseMoveMonitor.startMonitoring(this._viewHelper.viewLinesDomNode,n,i.buttons,a=>this._onMouseDownThenMove(a),a=>{let l=this._findMousePosition(this._lastMouseEvent,!1);El(a)?this._viewController.emitMouseDropCanceled():this._viewController.emitMouseDrop({event:this._lastMouseEvent,target:l?this._createMouseTarget(this._lastMouseEvent,!0):null}),this._stop()});return}this._mouseState.isDragAndDrop=!1,this._dispatchMouse(o,i.shiftKey,1),this._isActive||(this._isActive=!0,this._mouseMoveMonitor.startMonitoring(this._viewHelper.viewLinesDomNode,n,i.buttons,a=>this._onMouseDownThenMove(a),()=>this._stop()))}_stop(){this._isActive=!1,this._topBottomDragScrolling.stop()}onHeightChanged(){this._mouseMoveMonitor.stopMonitoring()}onPointerUp(){this._mouseMoveMonitor.stopMonitoring()}onCursorStateChanged(e){this._currentSelection=e.selections[0]}_getPositionOutsideEditor(e){let i=e.editorPos,n=this._context.viewModel,o=this._context.viewLayout,s=this._getMouseColumn(e);if(e.posy<i.y){let l=i.y-e.posy,d=Math.max(o.getCurrentScrollTop()-l,0),c=OE.getZoneAtCoord(this._context,d);if(c){let h=this._helpPositionJumpOverViewZone(c);if(h)return Mr.createOutsideEditor(s,h,"above",l)}let p=o.getLineNumberAtVerticalOffset(d);return Mr.createOutsideEditor(s,new H(p,1),"above",l)}if(e.posy>i.y+i.height){let l=e.posy-i.y-i.height,d=o.getCurrentScrollTop()+e.relativePos.y,c=OE.getZoneAtCoord(this._context,d);if(c){let h=this._helpPositionJumpOverViewZone(c);if(h)return Mr.createOutsideEditor(s,h,"below",l)}let p=o.getLineNumberAtVerticalOffset(d);return Mr.createOutsideEditor(s,new H(p,n.getLineMaxColumn(p)),"below",l)}let a=o.getLineNumberAtVerticalOffset(o.getCurrentScrollTop()+e.relativePos.y);if(e.posx<i.x){let l=i.x-e.posx;return Mr.createOutsideEditor(s,new H(a,1),"left",l)}if(e.posx>i.x+i.width){let l=e.posx-i.x-i.width;return Mr.createOutsideEditor(s,new H(a,n.getLineMaxColumn(a)),"right",l)}return null}_findMousePosition(e,i){let n=this._getPositionOutsideEditor(e);if(n)return n;let o=this._createMouseTarget(e,i);if(!o.position)return null;if(o.type===8||o.type===5){let a=this._helpPositionJumpOverViewZone(o.detail);if(a)return Mr.createViewZone(o.type,o.element,o.mouseColumn,a,o.detail)}return o}_helpPositionJumpOverViewZone(e){let i=new H(this._currentSelection.selectionStartLineNumber,this._currentSelection.selectionStartColumn),n=e.positionBefore,o=e.positionAfter;return n&&o?n.isBefore(i)?n:o:null}_dispatchMouse(e,i,n){e.position&&this._viewController.dispatchMouse({position:e.position,mouseColumn:e.mouseColumn,startedOnLineNumbers:this._mouseState.startedOnLineNumbers,revealType:n,inSelectionMode:i,mouseDownCount:this._mouseState.count,altKey:this._mouseState.altKey,ctrlKey:this._mouseState.ctrlKey,metaKey:this._mouseState.metaKey,shiftKey:this._mouseState.shiftKey,leftButton:this._mouseState.leftButton,middleButton:this._mouseState.middleButton,onInjectedText:e.type===6&&e.detail.injectedText!==null})}},Wq=class extends R{constructor(e,i,n,o){super();this._context=e;this._viewHelper=i;this._mouseTargetFactory=n;this._dispatchMouse=o;this._operation=null}_operation;dispose(){super.dispose(),this.stop()}start(e,i){this._operation?this._operation.setPosition(e,i):this._operation=new Hq(this._context,this._viewHelper,this._mouseTargetFactory,this._dispatchMouse,e,i)}stop(){this._operation&&(this._operation.dispose(),this._operation=null)}},Hq=class extends R{constructor(e,i,n,o,s,a){super();this._context=e;this._viewHelper=i;this._mouseTargetFactory=n;this._dispatchMouse=o;this._position=s,this._mouseEvent=a,this._lastTime=Date.now(),this._animationFrameDisposable=eo(ue(a.browserEvent),()=>this._execute())}_position;_mouseEvent;_lastTime;_animationFrameDisposable;dispose(){this._animationFrameDisposable.dispose(),super.dispose()}setPosition(e,i){this._position=e,this._mouseEvent=i}_tick(){let e=Date.now(),i=e-this._lastTime;return this._lastTime=e,i}_getScrollSpeed(){let e=this._context.configuration.options.get(68),i=this._context.configuration.options.get(147).height/e,n=this._position.outsideDistance/e;return n<=1.5?Math.max(30,i*(1+n)):n<=3?Math.max(60,i*(2+n)):Math.max(200,i*(7+n))}_execute(){let e=this._context.configuration.options.get(68),i=this._getScrollSpeed(),n=this._tick(),o=i*(n/1e3)*e,s=this._position.outsidePosition==="above"?-o:o;this._context.viewModel.viewLayout.deltaScrollNow(0,s),this._viewHelper.renderNow();let a=this._context.viewLayout.getLinesViewportData(),l=this._position.outsidePosition==="above"?a.startLineNumber:a.endLineNumber,d;{let c=MV(this._viewHelper.viewDomNode),p=this._context.configuration.options.get(147).horizontalScrollbarHeight,h=new Lb(this._mouseEvent.pos.x,c.y+c.height-p-.1),m=AV(this._viewHelper.viewDomNode,c,h);d=this._mouseTargetFactory.createMouseTarget(this._viewHelper.getLastRenderData(),c,h,m,null)}(!d.position||d.position.lineNumber!==l)&&(this._position.outsidePosition==="above"?d=Mr.createOutsideEditor(this._position.mouseColumn,new H(l,1),"above",this._position.outsideDistance):d=Mr.createOutsideEditor(this._position.mouseColumn,new H(l,this._context.viewModel.getLineMaxColumn(l)),"below",this._position.outsideDistance)),this._dispatchMouse(d,!0,2),this._animationFrameDisposable=eo(ue(d.element),()=>this._execute())}},Uq=class r{static CLEAR_MOUSE_DOWN_COUNT_TIME=400;_altKey;get altKey(){return this._altKey}_ctrlKey;get ctrlKey(){return this._ctrlKey}_metaKey;get metaKey(){return this._metaKey}_shiftKey;get shiftKey(){return this._shiftKey}_leftButton;get leftButton(){return this._leftButton}_middleButton;get middleButton(){return this._middleButton}_startedOnLineNumbers;get startedOnLineNumbers(){return this._startedOnLineNumbers}_lastMouseDownPosition;_lastMouseDownPositionEqualCount;_lastMouseDownCount;_lastSetMouseDownCountTime;isDragAndDrop;constructor(){this._altKey=!1,this._ctrlKey=!1,this._metaKey=!1,this._shiftKey=!1,this._leftButton=!1,this._middleButton=!1,this._startedOnLineNumbers=!1,this._lastMouseDownPosition=null,this._lastMouseDownPositionEqualCount=0,this._lastMouseDownCount=0,this._lastSetMouseDownCountTime=0,this.isDragAndDrop=!1}get count(){return this._lastMouseDownCount}setModifiers(t){this._altKey=t.altKey,this._ctrlKey=t.ctrlKey,this._metaKey=t.metaKey,this._shiftKey=t.shiftKey}setStartButtons(t){this._leftButton=t.leftButton,this._middleButton=t.middleButton}setStartedOnLineNumbers(t){this._startedOnLineNumbers=t}trySetCount(t,e){let i=new Date().getTime();i-this._lastSetMouseDownCountTime>r.CLEAR_MOUSE_DOWN_COUNT_TIME&&(t=1),this._lastSetMouseDownCountTime=i,t>this._lastMouseDownCount+1&&(t=this._lastMouseDownCount+1),this._lastMouseDownPosition&&this._lastMouseDownPosition.equals(e)?this._lastMouseDownPositionEqualCount++:this._lastMouseDownPositionEqualCount=1,this._lastMouseDownPosition=e,this._lastMouseDownCount=Math.min(t,this._lastMouseDownPositionEqualCount)}};function gW(r,t,e,i){let n=r.getPlainTextToCopy(t,e,St),o=r.model.getEOL(),s=e&&t.length===1&&t[0].isEmpty(),a=Array.isArray(n)?n:null,l=Array.isArray(n)?n.join(o):n,d,c=null;if(BEe.forceCopyWithSyntaxHighlighting||i&&l.length<65536){let h=r.getRichTextToCopy(t,e);h&&(d=h.html,c=h.mode)}return{isFromEmptySelection:s,multicursorText:a,text:l,html:d,mode:c}}var xy=class r{static INSTANCE=new r;_lastState;constructor(){this._lastState=null}set(t,e){this._lastState={lastCopiedValue:t,data:e}}get(t){return this._lastState&&this._lastState.lastCopiedValue===t?this._lastState.data:(this._lastState=null,null)}},BEe={forceCopyWithSyntaxHighlighting:!1};var qE=class r{static _getPageOfLine(t,e){return Math.floor((t-1)/e)}static _getRangeForPage(t,e){let i=t*e,n=i+1,o=i+e;return new L(n,1,o+1,1)}static fromEditorSelection(t,e,i,n){let s=r._getPageOfLine(e.startLineNumber,i),a=r._getRangeForPage(s,i),l=r._getPageOfLine(e.endLineNumber,i),d=r._getRangeForPage(l,i),c=a.intersectRanges(new L(1,1,e.startLineNumber,e.startColumn));if(n&&t.getValueLengthInRange(c,1)>500){let I=t.modifyPosition(c.getEndPosition(),-500);c=L.fromPositions(I,c.getEndPosition())}let p=t.getValueInRange(c,1),h=t.getLineCount(),m=t.getLineMaxColumn(h),f=d.intersectRanges(new L(e.endLineNumber,e.endColumn,h,m));if(n&&t.getValueLengthInRange(f,1)>500){let I=t.modifyPosition(f.getStartPosition(),500);f=L.fromPositions(f.getStartPosition(),I)}let g=t.getValueInRange(f,1),v;if(s===l||s+1===l)v=t.getValueInRange(e,1);else{let I=a.intersectRanges(e),y=d.intersectRanges(e);v=t.getValueInRange(I,1)+"\u2026"+t.getValueInRange(y,1)}return n&&v.length>2*500&&(v=v.substring(0,500)+"\u2026"+v.substring(v.length-500,v.length)),{value:p+v+g,selection:e,selectionStart:p.length,selectionEnd:p.length+v.length,newlineCountBeforeSelection:c.endLineNumber-c.startLineNumber}}};function bR(r,t){if(r.get(2)===1){let i=t.lookupKeybinding("editor.action.toggleScreenReaderAccessibilityMode")?.getAriaLabel(),n=t.lookupKeybinding("workbench.action.showCommands")?.getAriaLabel(),o=t.lookupKeybinding("workbench.action.openGlobalKeybindings")?.getAriaLabel(),s=u("accessibilityModeOff","The editor is not accessible at this time.");return i?u("accessibilityOffAriaLabel","{0} To enable screen reader optimized mode, use {1}",s,i):n?u("accessibilityOffAriaLabelNoKb","{0} To enable screen reader optimized mode, open the quick pick with {1} and run the command Toggle Screen Reader Accessibility Mode, which is currently not triggerable via keyboard.",s,n):o?u("accessibilityOffAriaLabelNoKbs","{0} Please assign a keybinding for the command Toggle Screen Reader Accessibility Mode by accessing the keybindings editor with {1} and run it.",s,o):s}return r.get(4)}function vR(r){let t=0,e=-1;do{if(e=r.indexOf(`
`,e+1),e===-1)break;t++}while(!0);return t}var hl=!1,Nr=class r{constructor(t,e,i,n,o){this.value=t;this.selectionStart=e;this.selectionEnd=i;this.selection=n;this.newlineCountBeforeSelection=o}static EMPTY=new r("",0,0,null,void 0);toString(){return`[ <${this.value}>, selectionStart: ${this.selectionStart}, selectionEnd: ${this.selectionEnd}]`}static readFromTextArea(t,e){let i=t.getValue(),n=t.getSelectionStart(),o=t.getSelectionEnd(),s;if(e){let a=i.substring(0,n),l=e.value.substring(0,e.selectionStart);a===l&&(s=e.newlineCountBeforeSelection)}return new r(i,n,o,null,s)}collapseSelection(){return this.selectionStart===this.value.length?this:new r(this.value,this.value.length,this.value.length,null,void 0)}writeToTextArea(t,e,i){hl&&console.log(`writeToTextArea ${t}: ${this.toString()}`),e.setValue(t,this.value),i&&e.setSelectionRange(t,this.selectionStart,this.selectionEnd)}deduceEditorPosition(t){if(t<=this.selectionStart){let n=this.value.substring(t,this.selectionStart);return this._finishDeduceEditorPosition(this.selection?.getStartPosition()??null,n,-1)}if(t>=this.selectionEnd){let n=this.value.substring(this.selectionEnd,t);return this._finishDeduceEditorPosition(this.selection?.getEndPosition()??null,n,1)}let e=this.value.substring(this.selectionStart,t);if(e.indexOf("\u2026")===-1)return this._finishDeduceEditorPosition(this.selection?.getStartPosition()??null,e,1);let i=this.value.substring(t,this.selectionEnd);return this._finishDeduceEditorPosition(this.selection?.getEndPosition()??null,i,-1)}_finishDeduceEditorPosition(t,e,i){let n=0,o=-1;for(;(o=e.indexOf(`
`,o+1))!==-1;)n++;return[t,i*e.length,n]}static deduceInput(t,e,i){if(!t)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0};hl&&(console.log("------------------------deduceInput"),console.log(`PREVIOUS STATE: ${t.toString()}`),console.log(`CURRENT STATE: ${e.toString()}`));let n=Math.min(bd(t.value,e.value),t.selectionStart,e.selectionStart),o=Math.min(Gv(t.value,e.value),t.value.length-t.selectionEnd,e.value.length-e.selectionEnd),s=t.value.substring(n,t.value.length-o),a=e.value.substring(n,e.value.length-o),l=t.selectionStart-n,d=t.selectionEnd-n,c=e.selectionStart-n,p=e.selectionEnd-n;if(hl&&(console.log(`AFTER DIFFING PREVIOUS STATE: <${s}>, selectionStart: ${l}, selectionEnd: ${d}`),console.log(`AFTER DIFFING CURRENT STATE: <${a}>, selectionStart: ${c}, selectionEnd: ${p}`)),c===p){let m=t.selectionStart-n;return hl&&console.log(`REMOVE PREVIOUS: ${m} chars`),{text:a,replacePrevCharCnt:m,replaceNextCharCnt:0,positionDelta:0}}let h=d-l;return{text:a,replacePrevCharCnt:h,replaceNextCharCnt:0,positionDelta:0}}static deduceAndroidCompositionInput(t,e){if(!t)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0};if(hl&&(console.log("------------------------deduceAndroidCompositionInput"),console.log(`PREVIOUS STATE: ${t.toString()}`),console.log(`CURRENT STATE: ${e.toString()}`)),t.value===e.value)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:e.selectionEnd-t.selectionEnd};let i=Math.min(bd(t.value,e.value),t.selectionEnd),n=Math.min(Gv(t.value,e.value),t.value.length-t.selectionEnd),o=t.value.substring(i,t.value.length-n),s=e.value.substring(i,e.value.length-n),a=t.selectionStart-i,l=t.selectionEnd-i,d=e.selectionStart-i,c=e.selectionEnd-i;return hl&&(console.log(`AFTER DIFFING PREVIOUS STATE: <${o}>, selectionStart: ${a}, selectionEnd: ${l}`),console.log(`AFTER DIFFING CURRENT STATE: <${s}>, selectionStart: ${d}, selectionEnd: ${c}`)),{text:s,replacePrevCharCnt:l,replaceNextCharCnt:o.length-l,positionDelta:c-s.length}}static fromScreenReaderContentState(t){return new r(t.value,t.selectionStart,t.selectionEnd,t.selection,t.newlineCountBeforeSelection)}};var bW;(t=>t.Tap="-monaco-textarea-synthetic-tap")(bW||={});var zq=class{_lastTypeTextLength;constructor(){this._lastTypeTextLength=0}handleCompositionUpdate(t){t=t||"";let e={text:t,replacePrevCharCnt:this._lastTypeTextLength,replaceNextCharCnt:0,positionDelta:0};return this._lastTypeTextLength=t.length,e}},$E=class extends R{constructor(e,i,n,o,s,a){super();this._host=e;this._textArea=i;this._OS=n;this._browser=o;this._accessibilityService=s;this._logService=a;this._asyncTriggerCut=this._register(new Ye(()=>this._onCut.fire(),0)),this._textAreaState=Nr.EMPTY,this._selectionChangeListener=null,this._accessibilityService.isScreenReaderOptimized()&&this.writeNativeTextAreaContent("ctor"),this._register(X.runAndSubscribe(this._accessibilityService.onDidChangeScreenReaderOptimized,()=>{this._accessibilityService.isScreenReaderOptimized()&&!this._asyncFocusGainWriteScreenReaderContent.value?this._asyncFocusGainWriteScreenReaderContent.value=this._register(new Ye(()=>this.writeNativeTextAreaContent("asyncFocusGain"),0)):this._asyncFocusGainWriteScreenReaderContent.clear()})),this._hasFocus=!1,this._currentComposition=null;let l=null;this._register(this._textArea.onKeyDown(d=>{let c=new ut(d);(c.keyCode===114||this._currentComposition&&c.keyCode===1)&&c.stopPropagation(),c.equals(9)&&c.preventDefault(),l=c,this._onKeyDown.fire(c)})),this._register(this._textArea.onKeyUp(d=>{let c=new ut(d);this._onKeyUp.fire(c)})),this._register(this._textArea.onCompositionStart(d=>{hl&&console.log("[compositionstart]",d);let c=new zq;if(this._currentComposition){this._currentComposition=c;return}if(this._currentComposition=c,this._OS===2&&l&&l.equals(114)&&this._textAreaState.selectionStart===this._textAreaState.selectionEnd&&this._textAreaState.selectionStart>0&&this._textAreaState.value.substr(this._textAreaState.selectionStart-1,1)===d.data&&(l.code==="ArrowRight"||l.code==="ArrowLeft")){hl&&console.log("[compositionstart] Handling long press case on macOS + arrow key",d),c.handleCompositionUpdate("x"),this._onCompositionStart.fire({data:d.data});return}if(this._browser.isAndroid){this._onCompositionStart.fire({data:d.data});return}this._onCompositionStart.fire({data:d.data})})),this._register(this._textArea.onCompositionUpdate(d=>{hl&&console.log("[compositionupdate]",d);let c=this._currentComposition;if(!c)return;if(this._browser.isAndroid){let h=Nr.readFromTextArea(this._textArea,this._textAreaState),m=Nr.deduceAndroidCompositionInput(this._textAreaState,h);this._textAreaState=h,this._onType.fire(m),this._onCompositionUpdate.fire(d);return}let p=c.handleCompositionUpdate(d.data);this._textAreaState=Nr.readFromTextArea(this._textArea,this._textAreaState),this._onType.fire(p),this._onCompositionUpdate.fire(d)})),this._register(this._textArea.onCompositionEnd(d=>{hl&&console.log("[compositionend]",d);let c=this._currentComposition;if(!c)return;if(this._currentComposition=null,this._browser.isAndroid){let h=Nr.readFromTextArea(this._textArea,this._textAreaState),m=Nr.deduceAndroidCompositionInput(this._textAreaState,h);this._textAreaState=h,this._onType.fire(m),this._onCompositionEnd.fire();return}let p=c.handleCompositionUpdate(d.data);this._textAreaState=Nr.readFromTextArea(this._textArea,this._textAreaState),this._onType.fire(p),this._onCompositionEnd.fire()})),this._register(this._textArea.onInput(d=>{if(hl&&console.log("[input]",d),this._textArea.setIgnoreSelectionChangeTime("received input event"),this._currentComposition)return;let c=Nr.readFromTextArea(this._textArea,this._textAreaState),p=Nr.deduceInput(this._textAreaState,c,this._OS===2);p.replacePrevCharCnt===0&&p.text.length===1&&(Rn(p.text.charCodeAt(0))||p.text.charCodeAt(0)===127)||(this._textAreaState=c,(p.text!==""||p.replacePrevCharCnt!==0||p.replaceNextCharCnt!==0||p.positionDelta!==0)&&this._onType.fire(p))})),this._register(this._textArea.onCut(d=>{this._textArea.setIgnoreSelectionChangeTime("received cut event"),this._ensureClipboardGetsEditorSelection(d),this._asyncTriggerCut.schedule()})),this._register(this._textArea.onCopy(d=>{this._ensureClipboardGetsEditorSelection(d)})),this._register(this._textArea.onPaste(d=>{if(this._textArea.setIgnoreSelectionChangeTime("received paste event"),d.preventDefault(),!d.clipboardData)return;let[c,p]=Ace.getTextData(d.clipboardData);c&&(p=p||xy.INSTANCE.get(c),this._onPaste.fire({text:c,metadata:p}))})),this._register(this._textArea.onFocus(()=>{let d=this._hasFocus;this._setHasFocus(!0),this._accessibilityService.isScreenReaderOptimized()&&this._browser.isSafari&&!d&&this._hasFocus&&(this._asyncFocusGainWriteScreenReaderContent.value||(this._asyncFocusGainWriteScreenReaderContent.value=new Ye(()=>this.writeNativeTextAreaContent("asyncFocusGain"),0)),this._asyncFocusGainWriteScreenReaderContent.value.schedule())})),this._register(this._textArea.onBlur(()=>{this._currentComposition&&(this._currentComposition=null,this.writeNativeTextAreaContent("blurWithoutCompositionEnd"),this._onCompositionEnd.fire()),this._setHasFocus(!1)})),this._register(this._textArea.onSyntheticTap(()=>{this._browser.isAndroid&&this._currentComposition&&(this._currentComposition=null,this.writeNativeTextAreaContent("tapWithoutCompositionEnd"),this._onCompositionEnd.fire())}))}_onFocus=this._register(new x);onFocus=this._onFocus.event;_onBlur=this._register(new x);onBlur=this._onBlur.event;_onKeyDown=this._register(new x);onKeyDown=this._onKeyDown.event;_onKeyUp=this._register(new x);onKeyUp=this._onKeyUp.event;_onCut=this._register(new x);onCut=this._onCut.event;_onPaste=this._register(new x);onPaste=this._onPaste.event;_onType=this._register(new x);onType=this._onType.event;_onCompositionStart=this._register(new x);onCompositionStart=this._onCompositionStart.event;_onCompositionUpdate=this._register(new x);onCompositionUpdate=this._onCompositionUpdate.event;_onCompositionEnd=this._register(new x);onCompositionEnd=this._onCompositionEnd.event;_onSelectionChangeRequest=this._register(new x);onSelectionChangeRequest=this._onSelectionChangeRequest.event;_asyncTriggerCut;_asyncFocusGainWriteScreenReaderContent=this._register(new yt);_textAreaState;get textAreaState(){return this._textAreaState}_selectionChangeListener;_hasFocus;_currentComposition;_initializeFromTest(){this._hasFocus=!0,this._textAreaState=Nr.readFromTextArea(this._textArea,null)}_installSelectionChangeListener(){let e=0;return F(this._textArea.ownerDocument,"selectionchange",i=>{if(cg.onSelectionChange(),!this._hasFocus||this._currentComposition||!this._browser.isChrome)return;let n=Date.now(),o=n-e;if(e=n,o<5)return;let s=n-this._textArea.getIgnoreSelectionChangeTime();if(this._textArea.resetSelectionChangeTime(),s<100||!this._textAreaState.selection)return;let a=this._textArea.getValue();if(this._textAreaState.value!==a)return;let l=this._textArea.getSelectionStart(),d=this._textArea.getSelectionEnd();if(this._textAreaState.selectionStart===l&&this._textAreaState.selectionEnd===d)return;let c=this._textAreaState.deduceEditorPosition(l),p=this._host.deduceModelPosition(c[0],c[1],c[2]),h=this._textAreaState.deduceEditorPosition(d),m=this._host.deduceModelPosition(h[0],h[1],h[2]),f=new Et(p.lineNumber,p.column,m.lineNumber,m.column);this._onSelectionChangeRequest.fire(f)})}dispose(){super.dispose(),this._selectionChangeListener&&(this._selectionChangeListener.dispose(),this._selectionChangeListener=null)}focusTextArea(){this._setHasFocus(!0),this.refreshFocusState()}isFocused(){return this._hasFocus}refreshFocusState(){this._setHasFocus(this._textArea.hasFocus())}_setHasFocus(e){this._hasFocus!==e&&(this._hasFocus=e,this._selectionChangeListener&&(this._selectionChangeListener.dispose(),this._selectionChangeListener=null),this._hasFocus&&(this._selectionChangeListener=this._installSelectionChangeListener()),this._hasFocus&&this.writeNativeTextAreaContent("focusgain"),this._hasFocus?this._onFocus.fire():this._onBlur.fire())}_setAndWriteTextAreaState(e,i){this._hasFocus||(i=i.collapseSelection()),i.writeToTextArea(e,this._textArea,this._hasFocus),this._textAreaState=i}writeNativeTextAreaContent(e){!this._accessibilityService.isScreenReaderOptimized()&&e==="render"||this._currentComposition||(this._logService.trace(`writeTextAreaState(reason: ${e})`),this._setAndWriteTextAreaState(e,this._host.getScreenReaderContent()))}_ensureClipboardGetsEditorSelection(e){let i=this._host.getDataToCopy(),n={version:1,isFromEmptySelection:i.isFromEmptySelection,multicursorText:i.multicursorText,mode:i.mode};xy.INSTANCE.set(this._browser.isFirefox?i.text.replace(/\r\n/g,`
`):i.text,n),e.preventDefault(),e.clipboardData&&Ace.setTextData(e.clipboardData,i.text,i.html,n)}};$E=E([b(4,Un),b(5,bt)],$E);var Ace={getTextData(r){let t=r.getData(Oo.text),e=null,i=r.getData("vscode-editor-data");if(typeof i=="string")try{e=JSON.parse(i),e.version!==1&&(e=null)}catch{}return t.length===0&&e===null&&r.files.length>0?[Array.prototype.slice.call(r.files,0).map(o=>o.name).join(`
`),null]:[t,e]},setTextData(r,t,e,i){r.setData(Oo.text,t),typeof e=="string"&&r.setData("text/html",e),r.setData("vscode-editor-data",JSON.stringify(i))}},fW=class extends R{constructor(e){super();this._actual=e;this._ignoreSelectionChangeTime=0,this._register(this.onKeyDown(()=>cg.onKeyDown())),this._register(this.onBeforeInput(()=>cg.onBeforeInput())),this._register(this.onInput(()=>cg.onInput())),this._register(this.onKeyUp(()=>cg.onKeyUp())),this._register(F(this._actual,bW.Tap,()=>this._onSyntheticTap.fire()))}onKeyDown=this._register(new lt(this._actual,"keydown")).event;onKeyPress=this._register(new lt(this._actual,"keypress")).event;onKeyUp=this._register(new lt(this._actual,"keyup")).event;onCompositionStart=this._register(new lt(this._actual,"compositionstart")).event;onCompositionUpdate=this._register(new lt(this._actual,"compositionupdate")).event;onCompositionEnd=this._register(new lt(this._actual,"compositionend")).event;onBeforeInput=this._register(new lt(this._actual,"beforeinput")).event;onInput=this._register(new lt(this._actual,"input")).event;onCut=this._register(new lt(this._actual,"cut")).event;onCopy=this._register(new lt(this._actual,"copy")).event;onPaste=this._register(new lt(this._actual,"paste")).event;onFocus=this._register(new lt(this._actual,"focus")).event;onBlur=this._register(new lt(this._actual,"blur")).event;get ownerDocument(){return this._actual.ownerDocument}_onSyntheticTap=this._register(new x);onSyntheticTap=this._onSyntheticTap.event;_ignoreSelectionChangeTime;hasFocus(){let e=tu(this._actual);return e?e.activeElement===this._actual:this._actual.isConnected?fo()===this._actual:!1}setIgnoreSelectionChangeTime(e){this._ignoreSelectionChangeTime=Date.now()}getIgnoreSelectionChangeTime(){return this._ignoreSelectionChangeTime}resetSelectionChangeTime(){this._ignoreSelectionChangeTime=0}getValue(){return this._actual.value}setValue(e,i){let n=this._actual;n.value!==i&&(this.setIgnoreSelectionChangeTime("setValue"),n.value=i)}getSelectionStart(){return this._actual.selectionDirection==="backward"?this._actual.selectionEnd:this._actual.selectionStart}getSelectionEnd(){return this._actual.selectionDirection==="backward"?this._actual.selectionStart:this._actual.selectionEnd}setSelectionRange(e,i,n){let o=this._actual,s=null,a=tu(o);a?s=a.activeElement:s=fo();let l=ue(s),d=s===o,c=o.selectionStart,p=o.selectionEnd;if(d&&c===i&&p===n){po&&l.parent!==l&&o.focus();return}if(d){this.setIgnoreSelectionChangeTime("setSelectionRange"),o.setSelectionRange(i,n),po&&l.parent!==l&&o.focus();return}try{let h=fte(o);this.setIgnoreSelectionChangeTime("setSelectionRange"),o.focus(),o.setSelectionRange(i,n),bte(o,h)}catch{}}};var Kq=class extends GE{_lastPointerType;constructor(t,e,i){super(t,e,i),this._register(yi.addTarget(this.viewHelper.linesContentDomNode)),this._register(F(this.viewHelper.linesContentDomNode,At.Tap,o=>this.onTap(o))),this._register(F(this.viewHelper.linesContentDomNode,At.Change,o=>this.onChange(o))),this._register(F(this.viewHelper.linesContentDomNode,At.Contextmenu,o=>this._onContextMenu(new Rc(o,!1,this.viewHelper.viewDomNode),!1))),this._lastPointerType="mouse",this._register(F(this.viewHelper.linesContentDomNode,"pointerdown",o=>{let s=o.pointerType;if(s==="mouse"){this._lastPointerType="mouse";return}else s==="touch"?this._lastPointerType="touch":this._lastPointerType="pen"}));let n=new RV(this.viewHelper.viewDomNode);this._register(n.onPointerMove(this.viewHelper.viewDomNode,o=>this._onMouseMove(o))),this._register(n.onPointerUp(this.viewHelper.viewDomNode,o=>this._onMouseUp(o))),this._register(n.onPointerLeave(this.viewHelper.viewDomNode,o=>this._onMouseLeave(o))),this._register(n.onPointerDown(this.viewHelper.viewDomNode,(o,s)=>this._onMouseDown(o,s)))}onTap(t){!t.initialTarget||!this.viewHelper.linesContentDomNode.contains(t.initialTarget)||(t.preventDefault(),this.viewHelper.focusTextArea(),this._dispatchGesture(t,!1))}onChange(t){this._lastPointerType==="touch"&&this._context.viewModel.viewLayout.deltaScrollNow(-t.translationX,-t.translationY),this._lastPointerType==="pen"&&this._dispatchGesture(t,!0)}_dispatchGesture(t,e){let i=this._createMouseTarget(new Rc(t,!1,this.viewHelper.viewDomNode),!1);i.position&&this.viewController.dispatchMouse({position:i.position,mouseColumn:i.position.column,startedOnLineNumbers:!1,revealType:1,mouseDownCount:t.tapCount,inSelectionMode:e,altKey:!1,ctrlKey:!1,metaKey:!1,shiftKey:!1,leftButton:!1,middleButton:!1,onInjectedText:i.type===6&&i.detail.injectedText!==null})}_onMouseDown(t,e){t.browserEvent.pointerType!=="touch"&&super._onMouseDown(t,e)}},Gq=class extends GE{constructor(t,e,i){super(t,e,i),this._register(yi.addTarget(this.viewHelper.linesContentDomNode)),this._register(F(this.viewHelper.linesContentDomNode,At.Tap,n=>this.onTap(n))),this._register(F(this.viewHelper.linesContentDomNode,At.Change,n=>this.onChange(n))),this._register(F(this.viewHelper.linesContentDomNode,At.Contextmenu,n=>this._onContextMenu(new Rc(n,!1,this.viewHelper.viewDomNode),!1)))}onTap(t){t.preventDefault(),this.viewHelper.focusTextArea();let e=this._createMouseTarget(new Rc(t,!1,this.viewHelper.viewDomNode),!1);if(e.position){let i=document.createEvent("CustomEvent");i.initEvent(bW.Tap,!1,!0),this.viewHelper.dispatchTextAreaEvent(i),this.viewController.moveTo(e.position,1)}}onChange(t){this._context.viewModel.viewLayout.deltaScrollNow(-t.translationX,-t.translationY)}},vW=class extends R{handler;constructor(t,e,i){super(),(Hr||pJ&&AM)&&Qc.pointerEvents?this.handler=this._register(new Kq(t,e,i)):Ke.TouchEvent?this.handler=this._register(new Gq(t,e,i)):this.handler=this._register(new GE(t,e,i))}getTargetAtClientPoint(t,e){return this.handler.getTargetAtClientPoint(t,e)}};var Na=class extends bc{};var IW=class extends Dn{_visibleLines;domNode;_dynamicOverlays=[];_isFocused=!1;constructor(t){super(t),this._visibleLines=new kE({createLine:()=>new qq(this._dynamicOverlays)}),this.domNode=this._visibleLines.domNode;let i=this._context.configuration.options.get(51);hn(this.domNode,i),this.domNode.setClassName("view-overlays")}shouldRender(){if(super.shouldRender())return!0;for(let t=0,e=this._dynamicOverlays.length;t<e;t++)if(this._dynamicOverlays[t].shouldRender())return!0;return!1}dispose(){super.dispose();for(let t=0,e=this._dynamicOverlays.length;t<e;t++)this._dynamicOverlays[t].dispose();this._dynamicOverlays=[]}getDomNode(){return this.domNode}addDynamicOverlay(t){this._dynamicOverlays.push(t)}onConfigurationChanged(t){this._visibleLines.onConfigurationChanged(t);let i=this._context.configuration.options.get(51);return hn(this.domNode,i),!0}onFlushed(t){return this._visibleLines.onFlushed(t)}onFocusChanged(t){return this._isFocused=t.isFocused,!0}onLinesChanged(t){return this._visibleLines.onLinesChanged(t)}onLinesDeleted(t){return this._visibleLines.onLinesDeleted(t)}onLinesInserted(t){return this._visibleLines.onLinesInserted(t)}onScrollChanged(t){return this._visibleLines.onScrollChanged(t)||!0}onTokensChanged(t){return this._visibleLines.onTokensChanged(t)}onZonesChanged(t){return this._visibleLines.onZonesChanged(t)}prepareRender(t){let e=this._dynamicOverlays.filter(i=>i.shouldRender());for(let i=0,n=e.length;i<n;i++){let o=e[i];o.prepareRender(t),o.onDidRender()}}render(t){this._viewOverlaysRender(t),this.domNode.toggleClassName("focused",this._isFocused)}_viewOverlaysRender(t){this._visibleLines.renderLines(t.viewportData)}},qq=class{_dynamicOverlays;_domNode;_renderedContent;constructor(t){this._dynamicOverlays=t,this._domNode=null,this._renderedContent=null}getDomNode(){return this._domNode?this._domNode.domNode:null}setDomNode(t){this._domNode=Ot(t)}onContentChanged(){}onTokensChanged(){}renderLine(t,e,i,n,o){let s="";for(let a=0,l=this._dynamicOverlays.length;a<l;a++){let d=this._dynamicOverlays[a];s+=d.render(n.startLineNumber,t)}return this._renderedContent===s?!1:(this._renderedContent=s,o.appendString('<div style="top:'),o.appendString(String(e)),o.appendString("px;height:"),o.appendString(String(i)),o.appendString('px;">'),o.appendString(s),o.appendString("</div>"),!0)}layoutLine(t,e,i){this._domNode&&(this._domNode.setTop(e),this._domNode.setHeight(i))}},yW=class extends IW{_contentWidth;constructor(t){super(t);let i=this._context.configuration.options.get(147);this._contentWidth=i.contentWidth,this.domNode.setHeight(0)}onConfigurationChanged(t){let i=this._context.configuration.options.get(147);return this._contentWidth=i.contentWidth,super.onConfigurationChanged(t)||!0}onScrollChanged(t){return super.onScrollChanged(t)||t.scrollWidthChanged}_viewOverlaysRender(t){super._viewOverlaysRender(t),this.domNode.setWidth(Math.max(t.scrollWidth,this._contentWidth))}},SW=class extends IW{_contentLeft;constructor(t){super(t);let e=this._context.configuration.options,i=e.get(147);this._contentLeft=i.contentLeft,this.domNode.setClassName("margin-view-overlays"),this.domNode.setWidth(1),hn(this.domNode,e.get(51))}onConfigurationChanged(t){let e=this._context.configuration.options;hn(this.domNode,e.get(51));let i=e.get(147);return this._contentLeft=i.contentLeft,super.onConfigurationChanged(t)||!0}onScrollChanged(t){return super.onScrollChanged(t)||t.scrollHeightChanged}_viewOverlaysRender(t){super._viewOverlaysRender(t);let e=Math.min(t.scrollHeight,1e6);this.domNode.setHeight(e),this.domNode.setWidth(this._contentLeft)}};var CW=class extends Dn{domNode;blocks=[];contentWidth=-1;contentLeft=0;constructor(t){super(t),this.domNode=Ot(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.domNode.setClassName("blockDecorations-container"),this.update()}update(){let t=!1,i=this._context.configuration.options.get(147),n=i.contentWidth-i.verticalScrollbarWidth;this.contentWidth!==n&&(this.contentWidth=n,t=!0);let o=i.contentLeft;return this.contentLeft!==o&&(this.contentLeft=o,t=!0),t}dispose(){super.dispose()}onConfigurationChanged(t){return this.update()}onScrollChanged(t){return t.scrollTopChanged||t.scrollLeftChanged}onDecorationsChanged(t){return!0}onZonesChanged(t){return!0}prepareRender(t){}render(t){let e=0,i=t.getDecorationsInViewport();for(let n of i){if(!n.options.blockClassName)continue;let o=this.blocks[e];o||(o=this.blocks[e]=Ot(document.createElement("div")),this.domNode.appendChild(o));let s,a;n.options.blockIsAfterEnd?(s=t.getVerticalOffsetAfterLineNumber(n.range.endLineNumber,!1),a=t.getVerticalOffsetAfterLineNumber(n.range.endLineNumber,!0)):(s=t.getVerticalOffsetForLineNumber(n.range.startLineNumber,!0),a=n.range.isEmpty()&&!n.options.blockDoesNotCollapse?t.getVerticalOffsetForLineNumber(n.range.startLineNumber,!1):t.getVerticalOffsetAfterLineNumber(n.range.endLineNumber,!0));let[l,d,c,p]=n.options.blockPadding??[0,0,0,0];o.setClassName("blockDecorations-block "+n.options.blockClassName),o.setLeft(this.contentLeft-p),o.setWidth(this.contentWidth+p+d),o.setTop(s-t.scrollTop-l),o.setHeight(a-s+l+c),e++}for(let n=e;n<this.blocks.length;n++)this.blocks[n].domNode.remove();this.blocks.length=e}};var wW=class extends Dn{_viewDomNode;_widgets;domNode;overflowingContentWidgetsDomNode;constructor(t,e){super(t),this._viewDomNode=e,this._widgets={},this.domNode=Ot(document.createElement("div")),Pr.write(this.domNode,1),this.domNode.setClassName("contentWidgets"),this.domNode.setPosition("absolute"),this.domNode.setTop(0),this.overflowingContentWidgetsDomNode=Ot(document.createElement("div")),Pr.write(this.overflowingContentWidgetsDomNode,2),this.overflowingContentWidgetsDomNode.setClassName("overflowingContentWidgets")}dispose(){super.dispose(),this._widgets={}}onConfigurationChanged(t){let e=Object.keys(this._widgets);for(let i of e)this._widgets[i].onConfigurationChanged(t);return!0}onDecorationsChanged(t){return!0}onFlushed(t){return!0}onLineMappingChanged(t){return this._updateAnchorsViewPositions(),!0}onLinesChanged(t){return this._updateAnchorsViewPositions(),!0}onLinesDeleted(t){return this._updateAnchorsViewPositions(),!0}onLinesInserted(t){return this._updateAnchorsViewPositions(),!0}onScrollChanged(t){return!0}onZonesChanged(t){return!0}_updateAnchorsViewPositions(){let t=Object.keys(this._widgets);for(let e of t)this._widgets[e].updateAnchorViewPosition()}addWidget(t){let e=new jq(this._context,this._viewDomNode,t);this._widgets[e.id]=e,e.allowEditorOverflow?this.overflowingContentWidgetsDomNode.appendChild(e.domNode):this.domNode.appendChild(e.domNode),this.setShouldRender()}setWidgetPosition(t,e,i,n,o){this._widgets[t.getId()].setPosition(e,i,n,o),this.setShouldRender()}removeWidget(t){let e=t.getId();if(this._widgets.hasOwnProperty(e)){let i=this._widgets[e];delete this._widgets[e];let n=i.domNode.domNode;n.remove(),n.removeAttribute("monaco-visible-content-widget"),this.setShouldRender()}}shouldSuppressMouseDownOnWidget(t){return this._widgets.hasOwnProperty(t)?this._widgets[t].suppressMouseDown:!1}onBeforeRender(t){let e=Object.keys(this._widgets);for(let i of e)this._widgets[i].onBeforeRender(t)}prepareRender(t){let e=Object.keys(this._widgets);for(let i of e)this._widgets[i].prepareRender(t)}render(t){let e=Object.keys(this._widgets);for(let i of e)this._widgets[i].render(t)}},jq=class{_context;_viewDomNode;_actual;domNode;id;allowEditorOverflow;suppressMouseDown;_fixedOverflowWidgets;_contentWidth;_contentLeft;_lineHeight;_primaryAnchor=new Ty(null,null);_secondaryAnchor=new Ty(null,null);_affinity;_preference;_cachedDomNodeOffsetWidth;_cachedDomNodeOffsetHeight;_maxWidth;_isVisible;_renderData;constructor(t,e,i){this._context=t,this._viewDomNode=e,this._actual=i,this.domNode=Ot(this._actual.getDomNode()),this.id=this._actual.getId(),this.allowEditorOverflow=this._actual.allowEditorOverflow||!1,this.suppressMouseDown=this._actual.suppressMouseDown||!1;let n=this._context.configuration.options,o=n.get(147);this._fixedOverflowWidgets=n.get(43),this._contentWidth=o.contentWidth,this._contentLeft=o.contentLeft,this._lineHeight=n.get(68),this._affinity=null,this._preference=[],this._cachedDomNodeOffsetWidth=-1,this._cachedDomNodeOffsetHeight=-1,this._maxWidth=this._getMaxWidth(),this._isVisible=!1,this._renderData=null,this.domNode.setPosition(this._fixedOverflowWidgets&&this.allowEditorOverflow?"fixed":"absolute"),this.domNode.setDisplay("none"),this.domNode.setVisibility("hidden"),this.domNode.setAttribute("widgetId",this.id),this.domNode.setMaxWidth(this._maxWidth)}onConfigurationChanged(t){let e=this._context.configuration.options;if(this._lineHeight=e.get(68),t.hasChanged(147)){let i=e.get(147);this._contentLeft=i.contentLeft,this._contentWidth=i.contentWidth,this._maxWidth=this._getMaxWidth()}}updateAnchorViewPosition(){this._setPosition(this._affinity,this._primaryAnchor.modelPosition,this._secondaryAnchor.modelPosition)}_setPosition(t,e,i){this._affinity=t,this._primaryAnchor=n(e,this._context.viewModel,this._affinity),this._secondaryAnchor=n(i,this._context.viewModel,this._affinity);function n(o,s,a){if(!o)return new Ty(null,null);let l=s.model.validatePosition(o);if(s.coordinatesConverter.modelPositionIsVisible(l)){let d=s.coordinatesConverter.convertModelPositionToViewPosition(l,a??void 0);return new Ty(o,d)}return new Ty(o,null)}}_getMaxWidth(){let t=this.domNode.domNode.ownerDocument,e=t.defaultView;return this.allowEditorOverflow?e?.innerWidth||t.documentElement.offsetWidth||t.body.offsetWidth:this._contentWidth}setPosition(t,e,i,n){this._setPosition(n,t,e),this._preference=i,this._primaryAnchor.viewPosition&&this._preference&&this._preference.length>0?this.domNode.setDisplay("block"):this.domNode.setDisplay("none"),this._cachedDomNodeOffsetWidth=-1,this._cachedDomNodeOffsetHeight=-1}_layoutBoxInViewport(t,e,i,n){let o=t.top,s=o,a=t.top+t.height,l=n.viewportHeight-a,d=o-i,c=s>=i,p=a,h=l>=i,m=t.left;return m+e>n.scrollLeft+n.viewportWidth&&(m=n.scrollLeft+n.viewportWidth-e),m<n.scrollLeft&&(m=n.scrollLeft),{fitsAbove:c,aboveTop:d,fitsBelow:h,belowTop:p,left:m}}_layoutHorizontalSegmentInPage(t,e,i,n){let a=Math.max(15,e.left-n),l=Math.min(e.left+e.width+n,t.width-15),c=this._viewDomNode.domNode.ownerDocument.defaultView,p=e.left+i-(c?.scrollX??0);if(p+n>l){let h=p-(l-n);p-=h,i-=h}if(p<a){let h=p-a;p-=h,i-=h}return[i,p]}_layoutBoxInPage(t,e,i,n){let o=t.top-i,s=t.top+t.height,a=Oi(this._viewDomNode.domNode),l=this._viewDomNode.domNode.ownerDocument,d=l.defaultView,c=a.top+o-(d?.scrollY??0),p=a.top+s-(d?.scrollY??0),h=Qa(l.body),[m,f]=this._layoutHorizontalSegmentInPage(h,a,t.left-n.scrollLeft+this._contentLeft,e),g=22,v=22,I=c>=g,y=p+i<=h.height-v;return this._fixedOverflowWidgets?{fitsAbove:I,aboveTop:Math.max(c,g),fitsBelow:y,belowTop:p,left:f}:{fitsAbove:I,aboveTop:o,fitsBelow:y,belowTop:s,left:m}}_prepareRenderWidgetAtExactPositionOverflowing(t){return new _y(t.top,t.left+this._contentLeft)}_getAnchorsCoordinates(t){let e=o(this._primaryAnchor.viewPosition,this._affinity,this._lineHeight),i=this._secondaryAnchor.viewPosition?.lineNumber===this._primaryAnchor.viewPosition?.lineNumber?this._secondaryAnchor.viewPosition:null,n=o(i,this._affinity,this._lineHeight);return{primary:e,secondary:n};function o(s,a,l){if(!s)return null;let d=t.visibleRangeForPosition(s);if(!d)return null;let c=s.column===1&&a===3?0:d.left,p=t.getVerticalOffsetForLineNumber(s.lineNumber)-t.scrollTop;return new EW(p,c,l)}}_reduceAnchorCoordinates(t,e,i){if(!e)return t;let n=this._context.configuration.options.get(51),o=e.left;return o<t.left?o=Math.max(o,t.left-i+n.typicalFullwidthCharacterWidth):o=Math.min(o,t.left+i-n.typicalFullwidthCharacterWidth),new EW(t.top,o,t.height)}_prepareRenderWidget(t){if(!this._preference||this._preference.length===0)return null;let{primary:e,secondary:i}=this._getAnchorsCoordinates(t);if(!e)return{kind:"offViewport",preserveFocus:this.domNode.domNode.contains(this.domNode.domNode.ownerDocument.activeElement)};if(this._cachedDomNodeOffsetWidth===-1||this._cachedDomNodeOffsetHeight===-1){let s=null;if(typeof this._actual.beforeRender=="function"&&(s=$q(this._actual.beforeRender,this._actual)),s)this._cachedDomNodeOffsetWidth=s.width,this._cachedDomNodeOffsetHeight=s.height;else{let l=this.domNode.domNode.getBoundingClientRect();this._cachedDomNodeOffsetWidth=Math.round(l.width),this._cachedDomNodeOffsetHeight=Math.round(l.height)}}let n=this._reduceAnchorCoordinates(e,i,this._cachedDomNodeOffsetWidth),o;this.allowEditorOverflow?o=this._layoutBoxInPage(n,this._cachedDomNodeOffsetWidth,this._cachedDomNodeOffsetHeight,t):o=this._layoutBoxInViewport(n,this._cachedDomNodeOffsetWidth,this._cachedDomNodeOffsetHeight,t);for(let s=1;s<=2;s++)for(let a of this._preference)if(a===1){if(!o)return null;if(s===2||o.fitsAbove)return{kind:"inViewport",coordinate:new _y(o.aboveTop,o.left),position:1}}else if(a===2){if(!o)return null;if(s===2||o.fitsBelow)return{kind:"inViewport",coordinate:new _y(o.belowTop,o.left),position:2}}else return this.allowEditorOverflow?{kind:"inViewport",coordinate:this._prepareRenderWidgetAtExactPositionOverflowing(new _y(n.top,n.left)),position:0}:{kind:"inViewport",coordinate:new _y(n.top,n.left),position:0};return null}onBeforeRender(t){!this._primaryAnchor.viewPosition||!this._preference||this._primaryAnchor.viewPosition.lineNumber<t.startLineNumber||this._primaryAnchor.viewPosition.lineNumber>t.endLineNumber||this.domNode.setMaxWidth(this._maxWidth)}prepareRender(t){this._renderData=this._prepareRenderWidget(t)}render(t){if(!this._renderData||this._renderData.kind==="offViewport"){this._isVisible&&(this.domNode.removeAttribute("monaco-visible-content-widget"),this._isVisible=!1,this._renderData?.kind==="offViewport"&&this._renderData.preserveFocus?this.domNode.setTop(-1e3):this.domNode.setVisibility("hidden")),typeof this._actual.afterRender=="function"&&$q(this._actual.afterRender,this._actual,null);return}this.allowEditorOverflow?(this.domNode.setTop(this._renderData.coordinate.top),this.domNode.setLeft(this._renderData.coordinate.left)):(this.domNode.setTop(this._renderData.coordinate.top+t.scrollTop-t.bigNumbersDelta),this.domNode.setLeft(this._renderData.coordinate.left)),this._isVisible||(this.domNode.setVisibility("inherit"),this.domNode.setAttribute("monaco-visible-content-widget","true"),this._isVisible=!0),typeof this._actual.afterRender=="function"&&$q(this._actual.afterRender,this._actual,this._renderData.position)}},Ty=class{constructor(t,e){this.modelPosition=t;this.viewPosition=e}},_y=class{constructor(t,e){this.top=t;this.left=e}_coordinateBrand=void 0},EW=class{constructor(t,e,i){this.top=t;this.left=e;this.height=i}_anchorCoordinateBrand=void 0};function $q(r,t,...e){try{return r.call(t,...e)}catch{return null}}var xW=class extends Na{_context;_renderLineHighlight;_wordWrap;_contentLeft;_contentWidth;_selectionIsEmpty;_renderLineHighlightOnlyWhenFocus;_focused;_cursorLineNumbers;_selections;_renderData;constructor(t){super(),this._context=t;let e=this._context.configuration.options,i=e.get(147);this._renderLineHighlight=e.get(98),this._renderLineHighlightOnlyWhenFocus=e.get(99),this._wordWrap=i.isViewportWrapping,this._contentLeft=i.contentLeft,this._contentWidth=i.contentWidth,this._selectionIsEmpty=!0,this._focused=!1,this._cursorLineNumbers=[1],this._selections=[new Et(1,1,1,1)],this._renderData=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}_readFromSelections(){let t=!1,e=new Set;for(let o of this._selections)e.add(o.positionLineNumber);let i=Array.from(e);i.sort((o,s)=>o-s),xi(this._cursorLineNumbers,i)||(this._cursorLineNumbers=i,t=!0);let n=this._selections.every(o=>o.isEmpty());return this._selectionIsEmpty!==n&&(this._selectionIsEmpty=n,t=!0),t}onThemeChanged(t){return this._readFromSelections()}onConfigurationChanged(t){let e=this._context.configuration.options,i=e.get(147);return this._renderLineHighlight=e.get(98),this._renderLineHighlightOnlyWhenFocus=e.get(99),this._wordWrap=i.isViewportWrapping,this._contentLeft=i.contentLeft,this._contentWidth=i.contentWidth,!0}onCursorStateChanged(t){return this._selections=t.selections,this._readFromSelections()}onFlushed(t){return!0}onLinesDeleted(t){return!0}onLinesInserted(t){return!0}onScrollChanged(t){return t.scrollWidthChanged||t.scrollTopChanged}onZonesChanged(t){return!0}onFocusChanged(t){return this._renderLineHighlightOnlyWhenFocus?(this._focused=t.isFocused,!0):!1}prepareRender(t){if(!this._shouldRenderThis()){this._renderData=null;return}let e=t.visibleRange.startLineNumber,i=t.visibleRange.endLineNumber,n=[];for(let s=e;s<=i;s++){let a=s-e;n[a]=""}if(this._wordWrap){let s=this._renderOne(t,!1);for(let a of this._cursorLineNumbers){let l=this._context.viewModel.coordinatesConverter,d=l.convertViewPositionToModelPosition(new H(a,1)).lineNumber,c=l.convertModelPositionToViewPosition(new H(d,1)).lineNumber,p=l.convertModelPositionToViewPosition(new H(d,this._context.viewModel.model.getLineMaxColumn(d))).lineNumber,h=Math.max(c,e),m=Math.min(p,i);for(let f=h;f<=m;f++){let g=f-e;n[g]=s}}}let o=this._renderOne(t,!0);for(let s of this._cursorLineNumbers){if(s<e||s>i)continue;let a=s-e;n[a]=o}this._renderData=n}render(t,e){if(!this._renderData)return"";let i=e-t;return i>=this._renderData.length?"":this._renderData[i]}_shouldRenderInMargin(){return(this._renderLineHighlight==="gutter"||this._renderLineHighlight==="all")&&(!this._renderLineHighlightOnlyWhenFocus||this._focused)}_shouldRenderInContent(){return(this._renderLineHighlight==="line"||this._renderLineHighlight==="all")&&this._selectionIsEmpty&&(!this._renderLineHighlightOnlyWhenFocus||this._focused)}},TW=class extends xW{_renderOne(t,e){return`<div class="${"current-line"+(this._shouldRenderInMargin()?" current-line-both":"")+(e?" current-line-exact":"")}" style="width:${Math.max(t.scrollWidth,this._contentWidth)}px;"></div>`}_shouldRenderThis(){return this._shouldRenderInContent()}_shouldRenderOther(){return this._shouldRenderInMargin()}},_W=class extends xW{_renderOne(t,e){return`<div class="${"current-line"+(this._shouldRenderInMargin()?" current-line-margin":"")+(this._shouldRenderOther()?" current-line-margin-both":"")+(this._shouldRenderInMargin()&&e?" current-line-exact-margin":"")}" style="width:${this._contentLeft}px"></div>`}_shouldRenderThis(){return!0}_shouldRenderOther(){return this._shouldRenderInContent()}};Zo((r,t)=>{let e=r.getColor(t3);if(e&&(t.addRule(`.monaco-editor .view-overlays .current-line { background-color: ${e}; }`),t.addRule(`.monaco-editor .margin-view-overlays .current-line-margin { background-color: ${e}; border: none; }`)),!e||e.isTransparent()||r.defines(i3)){let i=r.getColor(i3);i&&(t.addRule(`.monaco-editor .view-overlays .current-line-exact { border: 2px solid ${i}; }`),t.addRule(`.monaco-editor .margin-view-overlays .current-line-exact-margin { border: 2px solid ${i}; }`),oa(r.type)&&(t.addRule(".monaco-editor .view-overlays .current-line-exact { border-width: 1px; }"),t.addRule(".monaco-editor .margin-view-overlays .current-line-exact-margin { border-width: 1px; }")))}});var DW=class extends Na{_context;_typicalHalfwidthCharacterWidth;_renderResult;constructor(t){super(),this._context=t;let e=this._context.configuration.options;this._typicalHalfwidthCharacterWidth=e.get(51).typicalHalfwidthCharacterWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(t){let e=this._context.configuration.options;return this._typicalHalfwidthCharacterWidth=e.get(51).typicalHalfwidthCharacterWidth,!0}onDecorationsChanged(t){return!0}onFlushed(t){return!0}onLinesChanged(t){return!0}onLinesDeleted(t){return!0}onLinesInserted(t){return!0}onScrollChanged(t){return t.scrollTopChanged||t.scrollWidthChanged}onZonesChanged(t){return!0}prepareRender(t){let e=t.getDecorationsInViewport(),i=[],n=0;for(let l=0,d=e.length;l<d;l++){let c=e[l];c.options.className&&(i[n++]=c)}i=i.sort((l,d)=>{if(l.options.zIndex<d.options.zIndex)return-1;if(l.options.zIndex>d.options.zIndex)return 1;let c=l.options.className,p=d.options.className;return c<p?-1:c>p?1:L.compareRangesUsingStarts(l.range,d.range)});let o=t.visibleRange.startLineNumber,s=t.visibleRange.endLineNumber,a=[];for(let l=o;l<=s;l++){let d=l-o;a[d]=""}this._renderWholeLineDecorations(t,i,a),this._renderNormalDecorations(t,i,a),this._renderResult=a}_renderWholeLineDecorations(t,e,i){let n=t.visibleRange.startLineNumber,o=t.visibleRange.endLineNumber;for(let s=0,a=e.length;s<a;s++){let l=e[s];if(!l.options.isWholeLine)continue;let d='<div class="cdr '+l.options.className+'" style="left:0;width:100%;"></div>',c=Math.max(l.range.startLineNumber,n),p=Math.min(l.range.endLineNumber,o);for(let h=c;h<=p;h++){let m=h-n;i[m]+=d}}}_renderNormalDecorations(t,e,i){let n=t.visibleRange.startLineNumber,o=null,s=!1,a=null,l=!1;for(let d=0,c=e.length;d<c;d++){let p=e[d];if(p.options.isWholeLine)continue;let h=p.options.className,m=!!p.options.showIfCollapsed,f=p.range;if(m&&f.endColumn===1&&f.endLineNumber!==f.startLineNumber&&(f=new L(f.startLineNumber,f.startColumn,f.endLineNumber-1,this._context.viewModel.getLineMaxColumn(f.endLineNumber-1))),o===h&&s===m&&L.areIntersectingOrTouching(a,f)){a=L.plusRange(a,f);continue}o!==null&&this._renderNormalDecoration(t,a,o,l,s,n,i),o=h,s=m,a=f,l=p.options.shouldFillLineOnLineBreak??!1}o!==null&&this._renderNormalDecoration(t,a,o,l,s,n,i)}_renderNormalDecoration(t,e,i,n,o,s,a){let l=t.linesVisibleRangesForRange(e,i==="findMatch");if(l)for(let d=0,c=l.length;d<c;d++){let p=l[d];if(p.outsideRenderedLine)continue;let h=p.lineNumber-s;if(o&&p.ranges.length===1){let m=p.ranges[0];if(m.width<this._typicalHalfwidthCharacterWidth){let f=Math.round(m.left+m.width/2),g=Math.max(0,Math.round(f-this._typicalHalfwidthCharacterWidth/2));p.ranges[0]=new DE(g,this._typicalHalfwidthCharacterWidth)}}for(let m=0,f=p.ranges.length;m<f;m++){let g=n&&p.continuesOnNextLine&&f===1,v=p.ranges[m],I='<div class="cdr '+i+'" style="left:'+String(v.left)+"px;width:"+(g?"100%;":String(v.width)+"px;")+'"></div>';a[h]+=I}}}render(t,e){if(!this._renderResult)return"";let i=e-t;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}};var kW=class extends Dn{scrollbar;scrollbarDomNode;constructor(t,e,i,n){super(t);let o=this._context.configuration.options,s=o.get(105),a=o.get(76),l=o.get(41),d=o.get(108),c={listenOnDomNode:i.domNode,className:"editor-scrollable "+sk(t.theme.type),useShadows:!1,lazyRender:!0,vertical:s.vertical,horizontal:s.horizontal,verticalHasArrows:s.verticalHasArrows,horizontalHasArrows:s.horizontalHasArrows,verticalScrollbarSize:s.verticalScrollbarSize,verticalSliderSize:s.verticalSliderSize,horizontalScrollbarSize:s.horizontalScrollbarSize,horizontalSliderSize:s.horizontalSliderSize,handleMouseWheel:s.handleMouseWheel,alwaysConsumeMouseWheel:s.alwaysConsumeMouseWheel,arrowSize:s.arrowSize,mouseWheelScrollSensitivity:a,fastScrollSensitivity:l,scrollPredominantAxis:d,scrollByPage:s.scrollByPage};this.scrollbar=this._register(new Yf(e.domNode,c,this._context.viewLayout.getScrollable())),Pr.write(this.scrollbar.getDomNode(),6),this.scrollbarDomNode=Ot(this.scrollbar.getDomNode()),this.scrollbarDomNode.setPosition("absolute"),this._setLayout();let p=(h,m,f)=>{let g={};if(m){let v=h.scrollTop;v&&(g.scrollTop=this._context.viewLayout.getCurrentScrollTop()+v,h.scrollTop=0)}if(f){let v=h.scrollLeft;v&&(g.scrollLeft=this._context.viewLayout.getCurrentScrollLeft()+v,h.scrollLeft=0)}this._context.viewModel.viewLayout.setScrollPosition(g,1)};this._register(F(i.domNode,"scroll",h=>p(i.domNode,!0,!0))),this._register(F(e.domNode,"scroll",h=>p(e.domNode,!0,!1))),this._register(F(n.domNode,"scroll",h=>p(n.domNode,!0,!1))),this._register(F(this.scrollbarDomNode.domNode,"scroll",h=>p(this.scrollbarDomNode.domNode,!0,!1)))}dispose(){super.dispose()}_setLayout(){let t=this._context.configuration.options,e=t.get(147);this.scrollbarDomNode.setLeft(e.contentLeft),t.get(74).side==="right"?this.scrollbarDomNode.setWidth(e.contentWidth+e.minimap.minimapWidth):this.scrollbarDomNode.setWidth(e.contentWidth),this.scrollbarDomNode.setHeight(e.height)}getOverviewRulerLayoutInfo(){return this.scrollbar.getOverviewRulerLayoutInfo()}getDomNode(){return this.scrollbarDomNode}delegateVerticalScrollbarPointerDown(t){this.scrollbar.delegateVerticalScrollbarPointerDown(t)}delegateScrollFromMouseWheelEvent(t){this.scrollbar.delegateScrollFromMouseWheelEvent(t)}onConfigurationChanged(t){if(t.hasChanged(105)||t.hasChanged(76)||t.hasChanged(41)){let e=this._context.configuration.options,i=e.get(105),n=e.get(76),o=e.get(41),s=e.get(108),a={vertical:i.vertical,horizontal:i.horizontal,verticalScrollbarSize:i.verticalScrollbarSize,horizontalScrollbarSize:i.horizontalScrollbarSize,scrollByPage:i.scrollByPage,handleMouseWheel:i.handleMouseWheel,mouseWheelScrollSensitivity:n,fastScrollSensitivity:o,scrollPredominantAxis:s};this.scrollbar.updateOptions(a)}return t.hasChanged(147)&&this._setLayout(),!0}onScrollChanged(t){return!0}onThemeChanged(t){return this.scrollbar.updateClassName("editor-scrollable "+sk(this._context.theme.type)),!0}prepareRender(t){}render(t){this.scrollbar.renderNow()}};var ky=class{constructor(t,e,i,n,o){this.startLineNumber=t;this.endLineNumber=e;this.className=i;this.tooltip=n;this.zIndex=o??0}_decorationToRenderBrand=void 0;zIndex},Xq=class{constructor(t,e,i){this.className=t;this.zIndex=e;this.tooltip=i}},Yq=class{decorations=[];add(t){this.decorations.push(t)}getDecorations(){return this.decorations}},jE=class extends Na{_render(t,e,i){let n=[];for(let a=t;a<=e;a++){let l=a-t;n[l]=new Yq}if(i.length===0)return n;i.sort((a,l)=>a.className===l.className?a.startLineNumber===l.startLineNumber?a.endLineNumber-l.endLineNumber:a.startLineNumber-l.startLineNumber:a.className<l.className?-1:1);let o=null,s=0;for(let a=0,l=i.length;a<l;a++){let d=i[a],c=d.className,p=d.zIndex,h=Math.max(d.startLineNumber,t)-t,m=Math.min(d.endLineNumber,e)-t;o===c?(h=Math.max(s+1,h),s=Math.max(s,m)):(o=c,s=m);for(let f=h;f<=s;f++)n[f].add(new Xq(c,p,d.tooltip))}return n}},LW=class extends Dn{domNode;_lineHeight;_glyphMargin;_glyphMarginLeft;_glyphMarginWidth;_glyphMarginDecorationLaneCount;_managedDomNodes;_decorationGlyphsToRender;_widgets={};constructor(t){super(t),this._context=t;let e=this._context.configuration.options,i=e.get(147);this.domNode=Ot(document.createElement("div")),this.domNode.setClassName("glyph-margin-widgets"),this.domNode.setPosition("absolute"),this.domNode.setTop(0),this._lineHeight=e.get(68),this._glyphMargin=e.get(58),this._glyphMarginLeft=i.glyphMarginLeft,this._glyphMarginWidth=i.glyphMarginWidth,this._glyphMarginDecorationLaneCount=i.glyphMarginDecorationLaneCount,this._managedDomNodes=[],this._decorationGlyphsToRender=[]}dispose(){this._managedDomNodes=[],this._decorationGlyphsToRender=[],this._widgets={},super.dispose()}getWidgets(){return Object.values(this._widgets)}onConfigurationChanged(t){let e=this._context.configuration.options,i=e.get(147);return this._lineHeight=e.get(68),this._glyphMargin=e.get(58),this._glyphMarginLeft=i.glyphMarginLeft,this._glyphMarginWidth=i.glyphMarginWidth,this._glyphMarginDecorationLaneCount=i.glyphMarginDecorationLaneCount,!0}onDecorationsChanged(t){return!0}onFlushed(t){return!0}onLinesChanged(t){return!0}onLinesDeleted(t){return!0}onLinesInserted(t){return!0}onScrollChanged(t){return t.scrollTopChanged}onZonesChanged(t){return!0}addWidget(t){let e=Ot(t.getDomNode());this._widgets[t.getId()]={widget:t,preference:t.getPosition(),domNode:e,renderInfo:null},e.setPosition("absolute"),e.setDisplay("none"),e.setAttribute("widgetId",t.getId()),this.domNode.appendChild(e),this.setShouldRender()}setWidgetPosition(t,e){let i=this._widgets[t.getId()];return i.preference.lane===e.lane&&i.preference.zIndex===e.zIndex&&L.equalsRange(i.preference.range,e.range)?!1:(i.preference=e,this.setShouldRender(),!0)}removeWidget(t){let e=t.getId();if(this._widgets[e]){let n=this._widgets[e].domNode.domNode;delete this._widgets[e],n.remove(),this.setShouldRender()}}_collectDecorationBasedGlyphRenderRequest(t,e){let i=t.visibleRange.startLineNumber,n=t.visibleRange.endLineNumber,o=t.getDecorationsInViewport();for(let s of o){let a=s.options.glyphMarginClassName;if(!a)continue;let l=Math.max(s.range.startLineNumber,i),d=Math.min(s.range.endLineNumber,n),c=s.options.glyphMargin?.position??2,p=s.options.zIndex??0;for(let h=l;h<=d;h++){let m=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new H(h,0)),f=this._context.viewModel.glyphLanes.getLanesAtLine(m.lineNumber).indexOf(c);e.push(new Qq(h,f,p,a))}}}_collectWidgetBasedGlyphRenderRequest(t,e){let i=t.visibleRange.startLineNumber,n=t.visibleRange.endLineNumber;for(let o of Object.values(this._widgets)){let s=o.preference.range,{startLineNumber:a,endLineNumber:l}=this._context.viewModel.coordinatesConverter.convertModelRangeToViewRange(L.lift(s));if(!a||!l||l<i||a>n)continue;let d=Math.max(a,i),c=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new H(d,0)),p=this._context.viewModel.glyphLanes.getLanesAtLine(c.lineNumber).indexOf(o.preference.lane);e.push(new Zq(d,p,o.preference.zIndex,o))}}_collectSortedGlyphRenderRequests(t){let e=[];return this._collectDecorationBasedGlyphRenderRequest(t,e),this._collectWidgetBasedGlyphRenderRequest(t,e),e.sort((i,n)=>i.lineNumber===n.lineNumber?i.laneIndex===n.laneIndex?i.zIndex===n.zIndex?n.type===i.type?i.type===0&&n.type===0?i.className<n.className?-1:1:0:n.type-i.type:n.zIndex-i.zIndex:i.laneIndex-n.laneIndex:i.lineNumber-n.lineNumber),e}prepareRender(t){if(!this._glyphMargin){this._decorationGlyphsToRender=[];return}for(let n of Object.values(this._widgets))n.renderInfo=null;let e=new Ms(this._collectSortedGlyphRenderRequests(t)),i=[];for(;e.length>0;){let n=e.peek();if(!n)break;let o=e.takeWhile(a=>a.lineNumber===n.lineNumber&&a.laneIndex===n.laneIndex);if(!o||o.length===0)break;let s=o[0];if(s.type===0){let a=[];for(let l of o){if(l.zIndex!==s.zIndex||l.type!==s.type)break;(a.length===0||a[a.length-1]!==l.className)&&a.push(l.className)}i.push(s.accept(a.join(" ")))}else s.widget.renderInfo={lineNumber:s.lineNumber,laneIndex:s.laneIndex}}this._decorationGlyphsToRender=i}render(t){if(!this._glyphMargin){for(let i of Object.values(this._widgets))i.domNode.setDisplay("none");for(;this._managedDomNodes.length>0;)this._managedDomNodes.pop()?.domNode.remove();return}let e=Math.round(this._glyphMarginWidth/this._glyphMarginDecorationLaneCount);for(let i of Object.values(this._widgets))if(!i.renderInfo)i.domNode.setDisplay("none");else{let n=t.viewportData.relativeVerticalOffset[i.renderInfo.lineNumber-t.viewportData.startLineNumber],o=this._glyphMarginLeft+i.renderInfo.laneIndex*this._lineHeight;i.domNode.setDisplay("block"),i.domNode.setTop(n),i.domNode.setLeft(o),i.domNode.setWidth(e),i.domNode.setHeight(this._lineHeight)}for(let i=0;i<this._decorationGlyphsToRender.length;i++){let n=this._decorationGlyphsToRender[i],o=t.viewportData.relativeVerticalOffset[n.lineNumber-t.viewportData.startLineNumber],s=this._glyphMarginLeft+n.laneIndex*this._lineHeight,a;i<this._managedDomNodes.length?a=this._managedDomNodes[i]:(a=Ot(document.createElement("div")),this._managedDomNodes.push(a),this.domNode.appendChild(a)),a.setClassName("cgmr codicon "+n.combinedClassName),a.setPosition("absolute"),a.setTop(o),a.setLeft(s),a.setWidth(e),a.setHeight(this._lineHeight)}for(;this._managedDomNodes.length>this._decorationGlyphsToRender.length;)this._managedDomNodes.pop()?.domNode.remove()}};var Qq=class{constructor(t,e,i,n){this.lineNumber=t;this.laneIndex=e;this.zIndex=i;this.className=n}type=0;accept(t){return new Jq(this.lineNumber,this.laneIndex,t)}},Zq=class{constructor(t,e,i,n){this.lineNumber=t;this.laneIndex=e;this.zIndex=i;this.widget=n}type=1},Jq=class{constructor(t,e,i){this.lineNumber=t;this.laneIndex=e;this.combinedClassName=i}};var RW=class extends Na{_context;_primaryPosition;_spaceWidth;_renderResult;_maxIndentLeft;_bracketPairGuideOptions;constructor(t){super(),this._context=t,this._primaryPosition=null;let e=this._context.configuration.options,i=e.get(148),n=e.get(51);this._spaceWidth=n.spaceWidth,this._maxIndentLeft=i.wrappingColumn===-1?-1:i.wrappingColumn*n.typicalHalfwidthCharacterWidth,this._bracketPairGuideOptions=e.get(16),this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(t){let e=this._context.configuration.options,i=e.get(148),n=e.get(51);return this._spaceWidth=n.spaceWidth,this._maxIndentLeft=i.wrappingColumn===-1?-1:i.wrappingColumn*n.typicalHalfwidthCharacterWidth,this._bracketPairGuideOptions=e.get(16),!0}onCursorStateChanged(t){let i=t.selections[0].getPosition();return this._primaryPosition?.equals(i)?!1:(this._primaryPosition=i,!0)}onDecorationsChanged(t){return!0}onFlushed(t){return!0}onLinesChanged(t){return!0}onLinesDeleted(t){return!0}onLinesInserted(t){return!0}onScrollChanged(t){return t.scrollTopChanged}onZonesChanged(t){return!0}onLanguageConfigurationChanged(t){return!0}prepareRender(t){if(!this._bracketPairGuideOptions.indentation&&this._bracketPairGuideOptions.bracketPairs===!1){this._renderResult=null;return}let e=t.visibleRange.startLineNumber,i=t.visibleRange.endLineNumber,n=t.scrollWidth,o=this._primaryPosition,s=this.getGuidesByLine(e,Math.min(i+1,this._context.viewModel.getLineCount()),o),a=[];for(let l=e;l<=i;l++){let d=l-e,c=s[d],p="",h=t.visibleRangeForPosition(new H(l,1))?.left??0;for(let m of c){let f=m.column===-1?h+(m.visibleColumn-1)*this._spaceWidth:t.visibleRangeForPosition(new H(l,m.column)).left;if(f>n||this._maxIndentLeft>0&&f>this._maxIndentLeft)break;let g=m.horizontalLine?m.horizontalLine.top?"horizontal-top":"horizontal-bottom":"vertical",v=m.horizontalLine?(t.visibleRangeForPosition(new H(l,m.horizontalLine.endColumn))?.left??f+this._spaceWidth)-f:this._spaceWidth;p+=`<div class="core-guide ${m.className} ${g}" style="left:${f}px;width:${v}px"></div>`}a[d]=p}this._renderResult=a}getGuidesByLine(t,e,i){let n=this._bracketPairGuideOptions.bracketPairs!==!1?this._context.viewModel.getBracketGuidesInRangeByLine(t,e,i,{highlightActive:this._bracketPairGuideOptions.highlightActiveBracketPair,horizontalGuides:this._bracketPairGuideOptions.bracketPairsHorizontal===!0?2:this._bracketPairGuideOptions.bracketPairsHorizontal==="active"?1:0,includeInactive:this._bracketPairGuideOptions.bracketPairs===!0}):null,o=this._bracketPairGuideOptions.indentation?this._context.viewModel.getLinesIndentGuides(t,e):null,s=0,a=0,l=0;if(this._bracketPairGuideOptions.highlightActiveIndentation!==!1&&i){let p=this._context.viewModel.getActiveIndentGuide(i.lineNumber,t,e);s=p.startLineNumber,a=p.endLineNumber,l=p.indent}let{indentSize:d}=this._context.viewModel.model.getOptions(),c=[];for(let p=t;p<=e;p++){let h=new Array;c.push(h);let m=n?n[p-t]:[],f=new Ms(m),g=o?o[p-t]:0;for(let v=1;v<=g;v++){let I=(v-1)*d+1,y=(this._bracketPairGuideOptions.highlightActiveIndentation==="always"||m.length===0)&&s<=p&&p<=a&&v===l;h.push(...f.takeWhile(C=>C.visibleColumn<I)||[]);let w=f.peek();(!w||w.visibleColumn!==I||w.horizontalLine)&&h.push(new mc(I,-1,`core-guide-indent lvl-${(v-1)%30}`+(y?" indent-active":""),null,-1,-1))}h.push(...f.takeWhile(v=>!0)||[])}return c}render(t,e){if(!this._renderResult)return"";let i=e-t;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}};function XE(r){if(!(r&&r.isTransparent()))return r}Zo((r,t)=>{let e=[{bracketColor:gN,guideColor:Ure,guideColorActive:jre},{bracketColor:fN,guideColor:zre,guideColorActive:Xre},{bracketColor:bN,guideColor:Kre,guideColorActive:Yre},{bracketColor:vN,guideColor:Gre,guideColorActive:Qre},{bracketColor:IN,guideColor:qre,guideColorActive:Zre},{bracketColor:yN,guideColor:$re,guideColorActive:Jre}],i=new bk,n=[{indentColor:Tre,indentColorActive:Pre},{indentColor:_re,indentColorActive:Mre},{indentColor:Dre,indentColorActive:Are},{indentColor:kre,indentColorActive:Ore},{indentColor:Lre,indentColorActive:Nre},{indentColor:Rre,indentColorActive:Fre}],o=e.map(a=>{let l=r.getColor(a.bracketColor),d=r.getColor(a.guideColor),c=r.getColor(a.guideColorActive),p=XE(XE(d)??l?.transparent(.3)),h=XE(XE(c)??l);if(!(!p||!h))return{guideColor:p,guideColorActive:h}}).filter(go),s=n.map(a=>{let l=r.getColor(a.indentColor),d=r.getColor(a.indentColorActive),c=XE(l),p=XE(d);if(!(!c||!p))return{indentColor:c,indentColorActive:p}}).filter(go);if(o.length>0){for(let a=0;a<30;a++){let l=o[a%o.length];t.addRule(`.monaco-editor .${i.getInlineClassNameOfLevel(a).replace(/ /g,".")} { --guide-color: ${l.guideColor}; --guide-color-active: ${l.guideColorActive}; }`)}t.addRule(".monaco-editor .vertical { box-shadow: 1px 0 0 0 var(--guide-color) inset; }"),t.addRule(".monaco-editor .horizontal-top { border-top: 1px solid var(--guide-color); }"),t.addRule(".monaco-editor .horizontal-bottom { border-bottom: 1px solid var(--guide-color); }"),t.addRule(`.monaco-editor .vertical.${i.activeClassName} { box-shadow: 1px 0 0 0 var(--guide-color-active) inset; }`),t.addRule(`.monaco-editor .horizontal-top.${i.activeClassName} { border-top: 1px solid var(--guide-color-active); }`),t.addRule(`.monaco-editor .horizontal-bottom.${i.activeClassName} { border-bottom: 1px solid var(--guide-color-active); }`)}if(s.length>0){for(let a=0;a<30;a++){let l=s[a%s.length];t.addRule(`.monaco-editor .lines-content .core-guide-indent.lvl-${a} { --indent-color: ${l.indentColor}; --indent-color-active: ${l.indentColorActive}; }`)}t.addRule(".monaco-editor .lines-content .core-guide-indent { box-shadow: 1px 0 0 0 var(--indent-color) inset; }"),t.addRule(".monaco-editor .lines-content .core-guide-indent.indent-active { box-shadow: 1px 0 0 0 var(--indent-color-active) inset; }")}});var YE=class r extends Na{static CLASS_NAME="line-numbers";_context;_lineHeight;_renderLineNumbers;_renderCustomLineNumbers;_renderFinalNewline;_lineNumbersLeft;_lineNumbersWidth;_lastCursorModelPosition;_renderResult;_activeLineNumber;constructor(t){super(),this._context=t,this._readConfig(),this._lastCursorModelPosition=new H(1,1),this._renderResult=null,this._activeLineNumber=1,this._context.addEventHandler(this)}_readConfig(){let t=this._context.configuration.options;this._lineHeight=t.get(68);let e=t.get(69);this._renderLineNumbers=e.renderType,this._renderCustomLineNumbers=e.renderFn,this._renderFinalNewline=t.get(97);let i=t.get(147);this._lineNumbersLeft=i.lineNumbersLeft,this._lineNumbersWidth=i.lineNumbersWidth}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(t){return this._readConfig(),!0}onCursorStateChanged(t){let e=t.selections[0].getPosition();this._lastCursorModelPosition=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(e);let i=!1;return this._activeLineNumber!==e.lineNumber&&(this._activeLineNumber=e.lineNumber,i=!0),(this._renderLineNumbers===2||this._renderLineNumbers===3)&&(i=!0),i}onFlushed(t){return!0}onLinesChanged(t){return!0}onLinesDeleted(t){return!0}onLinesInserted(t){return!0}onScrollChanged(t){return t.scrollTopChanged}onZonesChanged(t){return!0}onDecorationsChanged(t){return t.affectsLineNumber}_getLineRenderLineNumber(t){let e=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new H(t,1));if(e.column!==1)return"";let i=e.lineNumber;if(this._renderCustomLineNumbers)return this._renderCustomLineNumbers(i);if(this._renderLineNumbers===2){let n=Math.abs(this._lastCursorModelPosition.lineNumber-i);return n===0?'<span class="relative-current-line-number">'+i+"</span>":String(n)}if(this._renderLineNumbers===3){if(this._lastCursorModelPosition.lineNumber===i||i%10===0)return String(i);let n=this._context.viewModel.getLineCount();return i===n?String(i):""}return String(i)}prepareRender(t){if(this._renderLineNumbers===0){this._renderResult=null;return}let e=ci?this._lineHeight%2===0?" lh-even":" lh-odd":"",i=t.visibleRange.startLineNumber,n=t.visibleRange.endLineNumber,o=this._context.viewModel.getDecorationsInViewport(t.visibleRange).filter(d=>!!d.options.lineNumberClassName);o.sort((d,c)=>L.compareRangesUsingEnds(d.range,c.range));let s=0,a=this._context.viewModel.getLineCount(),l=[];for(let d=i;d<=n;d++){let c=d-i,p=this._getLineRenderLineNumber(d),h="";for(;s<o.length&&o[s].range.endLineNumber<d;)s++;for(let m=s;m<o.length;m++){let{range:f,options:g}=o[m];f.startLineNumber<=d&&(h+=" "+g.lineNumberClassName)}if(!p&&!h){l[c]="";continue}d===a&&this._context.viewModel.getLineLength(d)===0&&(this._renderFinalNewline==="off"&&(p=""),this._renderFinalNewline==="dimmed"&&(h+=" dimmed-line-number")),d===this._activeLineNumber&&(h+=" active-line-number"),l[c]=`<div class="${r.CLASS_NAME}${e}${h}" style="left:${this._lineNumbersLeft}px;width:${this._lineNumbersWidth}px;">${p}</div>`}this._renderResult=l}render(t,e){if(!this._renderResult)return"";let i=e-t;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}};Zo((r,t)=>{let e=r.getColor(xre),i=r.getColor(Bre);i?t.addRule(`.monaco-editor .line-numbers.dimmed-line-number { color: ${i}; }`):e&&t.addRule(`.monaco-editor .line-numbers.dimmed-line-number { color: ${e.transparent(.4)}; }`)});var e$=class{_currentVisibleRange;constructor(){this._currentVisibleRange=new L(1,1,1,1)}getCurrentVisibleRange(){return this._currentVisibleRange}setCurrentVisibleRange(t){this._currentVisibleRange=t}},t$=class{constructor(t,e,i,n,o,s,a){this.minimalReveal=t;this.lineNumber=e;this.startColumn=i;this.endColumn=n;this.startScrollTop=o;this.stopScrollTop=s;this.scrollType=a;this.minLineNumber=e,this.maxLineNumber=e}type="range";minLineNumber;maxLineNumber},i$=class{constructor(t,e,i,n,o){this.minimalReveal=t;this.selections=e;this.startScrollTop=i;this.stopScrollTop=n;this.scrollType=o;let s=e[0].startLineNumber,a=e[0].endLineNumber;for(let l=1,d=e.length;l<d;l++){let c=e[l];s=Math.min(s,c.startLineNumber),a=Math.max(a,c.endLineNumber)}this.minLineNumber=s,this.maxLineNumber=a}type="selections";minLineNumber;maxLineNumber},PW=class r extends Dn{static HORIZONTAL_EXTRA_PX=30;_linesContent;_textRangeRestingSpot;_visibleLines;domNode;_lineHeight;_typicalHalfwidthCharacterWidth;_isViewportWrapping;_revealHorizontalRightPadding;_cursorSurroundingLines;_cursorSurroundingLinesStyle;_canUseLayerHinting;_viewLineOptions;_maxLineWidth;_asyncUpdateLineWidths;_asyncCheckMonospaceFontAssumptions;_horizontalRevealRequest;_lastRenderedData;_stickyScrollEnabled;_maxNumberStickyLines;constructor(t,e){super(t);let i=this._context.configuration,n=this._context.configuration.options,o=n.get(51),s=n.get(148);this._lineHeight=n.get(68),this._typicalHalfwidthCharacterWidth=o.typicalHalfwidthCharacterWidth,this._isViewportWrapping=s.isViewportWrapping,this._revealHorizontalRightPadding=n.get(102),this._cursorSurroundingLines=n.get(29),this._cursorSurroundingLinesStyle=n.get(30),this._canUseLayerHinting=!n.get(32),this._viewLineOptions=new dR(i,this._context.theme.type),this._linesContent=e,this._textRangeRestingSpot=document.createElement("div"),this._visibleLines=new kE({createLine:()=>new Ou(this._viewLineOptions)}),this.domNode=this._visibleLines.domNode,Pr.write(this.domNode,8),this.domNode.setClassName(`view-lines ${Nu}`),hn(this.domNode,o),this._maxLineWidth=0,this._asyncUpdateLineWidths=new Ye(()=>{this._updateLineWidthsSlow()},200),this._asyncCheckMonospaceFontAssumptions=new Ye(()=>{this._checkMonospaceFontAssumptions()},2e3),this._lastRenderedData=new e$,this._horizontalRevealRequest=null,this._stickyScrollEnabled=n.get(117).enabled,this._maxNumberStickyLines=n.get(117).maxLineCount}dispose(){this._asyncUpdateLineWidths.dispose(),this._asyncCheckMonospaceFontAssumptions.dispose(),super.dispose()}getDomNode(){return this.domNode}onConfigurationChanged(t){this._visibleLines.onConfigurationChanged(t),t.hasChanged(148)&&(this._maxLineWidth=0);let e=this._context.configuration.options,i=e.get(51),n=e.get(148);return this._lineHeight=e.get(68),this._typicalHalfwidthCharacterWidth=i.typicalHalfwidthCharacterWidth,this._isViewportWrapping=n.isViewportWrapping,this._revealHorizontalRightPadding=e.get(102),this._cursorSurroundingLines=e.get(29),this._cursorSurroundingLinesStyle=e.get(30),this._canUseLayerHinting=!e.get(32),this._stickyScrollEnabled=e.get(117).enabled,this._maxNumberStickyLines=e.get(117).maxLineCount,hn(this.domNode,i),this._onOptionsMaybeChanged(),t.hasChanged(147)&&(this._maxLineWidth=0),!0}_onOptionsMaybeChanged(){let t=this._context.configuration,e=new dR(t,this._context.theme.type);if(!this._viewLineOptions.equals(e)){this._viewLineOptions=e;let i=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber();for(let o=i;o<=n;o++)this._visibleLines.getVisibleLine(o).onOptionsChanged(this._viewLineOptions);return!0}return!1}onCursorStateChanged(t){let e=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber(),n=!1;for(let o=e;o<=i;o++)n=this._visibleLines.getVisibleLine(o).onSelectionChanged()||n;return n}onDecorationsChanged(t){{let e=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();for(let n=e;n<=i;n++)this._visibleLines.getVisibleLine(n).onDecorationsChanged()}return!0}onFlushed(t){let e=this._visibleLines.onFlushed(t);return this._maxLineWidth=0,e}onLinesChanged(t){return this._visibleLines.onLinesChanged(t)}onLinesDeleted(t){return this._visibleLines.onLinesDeleted(t)}onLinesInserted(t){return this._visibleLines.onLinesInserted(t)}onRevealRangeRequest(t){let e=this._computeScrollTopToRevealRange(this._context.viewLayout.getFutureViewport(),t.source,t.minimalReveal,t.range,t.selections,t.verticalType);if(e===-1)return!1;let i=this._context.viewLayout.validateScrollPosition({scrollTop:e});t.revealHorizontal?t.range&&t.range.startLineNumber!==t.range.endLineNumber?i={scrollTop:i.scrollTop,scrollLeft:0}:t.range?this._horizontalRevealRequest=new t$(t.minimalReveal,t.range.startLineNumber,t.range.startColumn,t.range.endColumn,this._context.viewLayout.getCurrentScrollTop(),i.scrollTop,t.scrollType):t.selections&&t.selections.length>0&&(this._horizontalRevealRequest=new i$(t.minimalReveal,t.selections,this._context.viewLayout.getCurrentScrollTop(),i.scrollTop,t.scrollType)):this._horizontalRevealRequest=null;let o=Math.abs(this._context.viewLayout.getCurrentScrollTop()-i.scrollTop)<=this._lineHeight?1:t.scrollType;return this._context.viewModel.viewLayout.setScrollPosition(i,o),!0}onScrollChanged(t){if(this._horizontalRevealRequest&&t.scrollLeftChanged&&(this._horizontalRevealRequest=null),this._horizontalRevealRequest&&t.scrollTopChanged){let e=Math.min(this._horizontalRevealRequest.startScrollTop,this._horizontalRevealRequest.stopScrollTop),i=Math.max(this._horizontalRevealRequest.startScrollTop,this._horizontalRevealRequest.stopScrollTop);(t.scrollTop<e||t.scrollTop>i)&&(this._horizontalRevealRequest=null)}return this.domNode.setWidth(t.scrollWidth),this._visibleLines.onScrollChanged(t)||!0}onTokensChanged(t){return this._visibleLines.onTokensChanged(t)}onZonesChanged(t){return this._context.viewModel.viewLayout.setMaxLineWidth(this._maxLineWidth),this._visibleLines.onZonesChanged(t)}onThemeChanged(t){return this._onOptionsMaybeChanged()}getPositionFromDOMInfo(t,e){let i=this._getViewLineDomNode(t);if(i===null)return null;let n=this._getLineNumberFor(i);if(n===-1||n<1||n>this._context.viewModel.getLineCount())return null;if(this._context.viewModel.getLineMaxColumn(n)===1)return new H(n,1);let o=this._visibleLines.getStartLineNumber(),s=this._visibleLines.getEndLineNumber();if(n<o||n>s)return null;let a=this._visibleLines.getVisibleLine(n).getColumnOfNodeOffset(t,e),l=this._context.viewModel.getLineMinColumn(n);return a<l&&(a=l),new H(n,a)}_getViewLineDomNode(t){for(;t&&t.nodeType===1;){if(t.className===Ou.CLASS_NAME)return t;t=t.parentElement}return null}_getLineNumberFor(t){let e=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();for(let n=e;n<=i;n++){let o=this._visibleLines.getVisibleLine(n);if(t===o.getDomNode())return n}return-1}getLineWidth(t){let e=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();if(t<e||t>i)return-1;let n=new LE(this.domNode.domNode,this._textRangeRestingSpot),o=this._visibleLines.getVisibleLine(t).getWidth(n);return this._updateLineWidthsSlowIfDomDidLayout(n),o}linesVisibleRangesForRange(t,e){if(this.shouldRender())return null;let i=t.endLineNumber,n=L.intersectRanges(t,this._lastRenderedData.getCurrentVisibleRange());if(!n)return null;let o=[],s=0,a=new LE(this.domNode.domNode,this._textRangeRestingSpot),l=0;e&&(l=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new H(n.startLineNumber,1)).lineNumber);let d=this._visibleLines.getStartLineNumber(),c=this._visibleLines.getEndLineNumber();for(let p=n.startLineNumber;p<=n.endLineNumber;p++){if(p<d||p>c)continue;let h=p===n.startLineNumber?n.startColumn:1,m=p!==n.endLineNumber,f=m?this._context.viewModel.getLineMaxColumn(p):n.endColumn,g=this._visibleLines.getVisibleLine(p).getVisibleRangesForRange(p,h,f,a);if(g){if(e&&p<i){let v=l;l=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new H(p+1,1)).lineNumber,v!==l&&(g.ranges[g.ranges.length-1].width+=this._typicalHalfwidthCharacterWidth)}o[s++]=new FV(g.outsideRenderedLine,p,DE.from(g.ranges),m)}}return this._updateLineWidthsSlowIfDomDidLayout(a),s===0?null:o}_visibleRangesForLineRange(t,e,i){if(this.shouldRender()||t<this._visibleLines.getStartLineNumber()||t>this._visibleLines.getEndLineNumber())return null;let n=new LE(this.domNode.domNode,this._textRangeRestingSpot),o=this._visibleLines.getVisibleLine(t).getVisibleRangesForRange(t,e,i,n);return this._updateLineWidthsSlowIfDomDidLayout(n),o}visibleRangeForPosition(t){let e=this._visibleRangesForLineRange(t.lineNumber,t.column,t.column);return e?new BV(e.outsideRenderedLine,e.ranges[0].left):null}updateLineWidths(){this._updateLineWidths(!1)}_updateLineWidthsFast(){return this._updateLineWidths(!0)}_updateLineWidthsSlow(){this._updateLineWidths(!1)}_updateLineWidthsSlowIfDomDidLayout(t){t.didDomLayout&&(this._asyncUpdateLineWidths.isScheduled()||(this._asyncUpdateLineWidths.cancel(),this._updateLineWidthsSlow()))}_updateLineWidths(t){let e=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber(),n=1,o=!0;for(let s=e;s<=i;s++){let a=this._visibleLines.getVisibleLine(s);if(t&&!a.getWidthIsFast()){o=!1;continue}n=Math.max(n,a.getWidth(null))}return o&&e===1&&i===this._context.viewModel.getLineCount()&&(this._maxLineWidth=0),this._ensureMaxLineWidth(n),o}_checkMonospaceFontAssumptions(){let t=-1,e=-1,i=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber();for(let o=i;o<=n;o++){let s=this._visibleLines.getVisibleLine(o);if(s.needsMonospaceFontCheck()){let a=s.getWidth(null);a>e&&(e=a,t=o)}}if(t!==-1&&!this._visibleLines.getVisibleLine(t).monospaceAssumptionsAreValid())for(let o=i;o<=n;o++)this._visibleLines.getVisibleLine(o).onMonospaceAssumptionsInvalidated()}prepareRender(){throw new Error("Not supported")}render(){throw new Error("Not supported")}renderText(t){if(this._visibleLines.renderLines(t),this._lastRenderedData.setCurrentVisibleRange(t.visibleRange),this.domNode.setWidth(this._context.viewLayout.getScrollWidth()),this.domNode.setHeight(Math.min(this._context.viewLayout.getScrollHeight(),1e6)),this._horizontalRevealRequest){let i=this._horizontalRevealRequest;if(t.startLineNumber<=i.minLineNumber&&i.maxLineNumber<=t.endLineNumber){this._horizontalRevealRequest=null,this.onDidRender();let n=this._computeScrollLeftToReveal(i);n&&(this._isViewportWrapping||this._ensureMaxLineWidth(n.maxHorizontalOffset),this._context.viewModel.viewLayout.setScrollPosition({scrollLeft:n.scrollLeft},i.scrollType))}}if(this._updateLineWidthsFast()?this._asyncUpdateLineWidths.cancel():this._asyncUpdateLineWidths.schedule(),ci&&!this._asyncCheckMonospaceFontAssumptions.isScheduled()){let i=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber();for(let o=i;o<=n;o++)if(this._visibleLines.getVisibleLine(o).needsMonospaceFontCheck()){this._asyncCheckMonospaceFontAssumptions.schedule();break}}this._linesContent.setLayerHinting(this._canUseLayerHinting),this._linesContent.setContain("strict");let e=this._context.viewLayout.getCurrentScrollTop()-t.bigNumbersDelta;this._linesContent.setTop(-e),this._linesContent.setLeft(-this._context.viewLayout.getCurrentScrollLeft())}_ensureMaxLineWidth(t){let e=Math.ceil(t);this._maxLineWidth<e&&(this._maxLineWidth=e,this._context.viewModel.viewLayout.setMaxLineWidth(this._maxLineWidth))}_computeScrollTopToRevealRange(t,e,i,n,o,s){let a=t.top,l=t.height,d=a+l,c,p,h;if(o&&o.length>0){let I=o[0].startLineNumber,y=o[0].endLineNumber;for(let w=1,C=o.length;w<C;w++){let S=o[w];I=Math.min(I,S.startLineNumber),y=Math.max(y,S.endLineNumber)}c=!1,p=this._context.viewLayout.getVerticalOffsetForLineNumber(I),h=this._context.viewLayout.getVerticalOffsetForLineNumber(y)+this._lineHeight}else if(n)c=!0,p=this._context.viewLayout.getVerticalOffsetForLineNumber(n.startLineNumber),h=this._context.viewLayout.getVerticalOffsetForLineNumber(n.endLineNumber)+this._lineHeight;else return-1;let m=(e==="mouse"||i)&&this._cursorSurroundingLinesStyle==="default",f=0,g=0;if(m)i||(f=this._lineHeight);else{let I=l/this._lineHeight,y=Math.max(this._cursorSurroundingLines,this._stickyScrollEnabled?this._maxNumberStickyLines:0),w=Math.min(I/2,y);f=w*this._lineHeight,g=Math.max(0,w-1)*this._lineHeight}i||(s===0||s===4)&&(g+=this._lineHeight),p-=f,h+=g;let v;if(h-p>l){if(!c)return-1;v=p}else if(s===5||s===6)if(s===6&&a<=p&&h<=d)v=a;else{let I=Math.max(5*this._lineHeight,l*.2),y=p-I,w=h-l;v=Math.max(w,y)}else if(s===1||s===2)if(s===2&&a<=p&&h<=d)v=a;else{let I=(p+h)/2;v=Math.max(0,I-l/2)}else v=this._computeMinimumScrolling(a,d,p,h,s===3,s===4);return v}_computeScrollLeftToReveal(t){let e=this._context.viewLayout.getCurrentViewport(),i=this._context.configuration.options.get(147),n=e.left,o=n+e.width-i.verticalScrollbarWidth,s=1073741824,a=0;if(t.type==="range"){let d=this._visibleRangesForLineRange(t.lineNumber,t.startColumn,t.endColumn);if(!d)return null;for(let c of d.ranges)s=Math.min(s,Math.round(c.left)),a=Math.max(a,Math.round(c.left+c.width))}else for(let d of t.selections){if(d.startLineNumber!==d.endLineNumber)return null;let c=this._visibleRangesForLineRange(d.startLineNumber,d.startColumn,d.endColumn);if(!c)return null;for(let p of c.ranges)s=Math.min(s,Math.round(p.left)),a=Math.max(a,Math.round(p.left+p.width))}return t.minimalReveal||(s=Math.max(0,s-r.HORIZONTAL_EXTRA_PX),a+=this._revealHorizontalRightPadding),t.type==="selections"&&a-s>e.width?null:{scrollLeft:this._computeMinimumScrolling(n,o,s,a),maxHorizontalOffset:a}}_computeMinimumScrolling(t,e,i,n,o,s){t=t|0,e=e|0,i=i|0,n=n|0,o=!!o,s=!!s;let a=e-t;if(n-i<a){if(o)return i;if(s)return Math.max(0,n-a);if(i<t)return i;if(n>e)return Math.max(0,n-a)}else return i;return t}};var MW=class extends jE{_context;_decorationsLeft;_decorationsWidth;_renderResult;constructor(t){super(),this._context=t;let i=this._context.configuration.options.get(147);this._decorationsLeft=i.decorationsLeft,this._decorationsWidth=i.decorationsWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(t){let i=this._context.configuration.options.get(147);return this._decorationsLeft=i.decorationsLeft,this._decorationsWidth=i.decorationsWidth,!0}onDecorationsChanged(t){return!0}onFlushed(t){return!0}onLinesChanged(t){return!0}onLinesDeleted(t){return!0}onLinesInserted(t){return!0}onScrollChanged(t){return t.scrollTopChanged}onZonesChanged(t){return!0}_getDecorations(t){let e=t.getDecorationsInViewport(),i=[],n=0;for(let o=0,s=e.length;o<s;o++){let a=e[o],l=a.options.linesDecorationsClassName,d=a.options.zIndex;l&&(i[n++]=new ky(a.range.startLineNumber,a.range.endLineNumber,l,a.options.linesDecorationsTooltip??null,d));let c=a.options.firstLineDecorationClassName;c&&(i[n++]=new ky(a.range.startLineNumber,a.range.startLineNumber,c,a.options.linesDecorationsTooltip??null,d))}return i}prepareRender(t){let e=t.visibleRange.startLineNumber,i=t.visibleRange.endLineNumber,n=this._render(e,i,this._getDecorations(t)),o=this._decorationsLeft.toString(),s=this._decorationsWidth.toString(),a='" style="left:'+o+"px;width:"+s+'px;"></div>',l=[];for(let d=e;d<=i;d++){let c=d-e,p=n[c].getDecorations(),h="";for(let m of p){let f='<div class="cldr '+m.className;m.tooltip!==null&&(f+='" title="'+m.tooltip),f+=a,h+=f}l[c]=h}this._renderResult=l}render(t,e){return this._renderResult?this._renderResult[e-t]:""}};var QE=class r extends Dn{static CLASS_NAME="glyph-margin";static OUTER_CLASS_NAME="margin";_domNode;_canUseLayerHinting;_contentLeft;_glyphMarginLeft;_glyphMarginWidth;_glyphMarginBackgroundDomNode;constructor(t){super(t);let e=this._context.configuration.options,i=e.get(147);this._canUseLayerHinting=!e.get(32),this._contentLeft=i.contentLeft,this._glyphMarginLeft=i.glyphMarginLeft,this._glyphMarginWidth=i.glyphMarginWidth,this._domNode=Ot(document.createElement("div")),this._domNode.setClassName(r.OUTER_CLASS_NAME),this._domNode.setPosition("absolute"),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._glyphMarginBackgroundDomNode=Ot(document.createElement("div")),this._glyphMarginBackgroundDomNode.setClassName(r.CLASS_NAME),this._domNode.appendChild(this._glyphMarginBackgroundDomNode)}dispose(){super.dispose()}getDomNode(){return this._domNode}onConfigurationChanged(t){let e=this._context.configuration.options,i=e.get(147);return this._canUseLayerHinting=!e.get(32),this._contentLeft=i.contentLeft,this._glyphMarginLeft=i.glyphMarginLeft,this._glyphMarginWidth=i.glyphMarginWidth,!0}onScrollChanged(t){return super.onScrollChanged(t)||t.scrollTopChanged}prepareRender(t){}render(t){this._domNode.setLayerHinting(this._canUseLayerHinting),this._domNode.setContain("strict");let e=t.scrollTop-t.bigNumbersDelta;this._domNode.setTop(-e);let i=Math.min(t.scrollHeight,1e6);this._domNode.setHeight(i),this._domNode.setWidth(this._contentLeft),this._glyphMarginBackgroundDomNode.setLeft(this._glyphMarginLeft),this._glyphMarginBackgroundDomNode.setWidth(this._glyphMarginWidth),this._glyphMarginBackgroundDomNode.setHeight(i)}};var AW=class extends jE{_context;_renderResult;constructor(t){super(),this._context=t,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(t){return!0}onDecorationsChanged(t){return!0}onFlushed(t){return!0}onLinesChanged(t){return!0}onLinesDeleted(t){return!0}onLinesInserted(t){return!0}onScrollChanged(t){return t.scrollTopChanged}onZonesChanged(t){return!0}_getDecorations(t){let e=t.getDecorationsInViewport(),i=[],n=0;for(let o=0,s=e.length;o<s;o++){let a=e[o],l=a.options.marginClassName,d=a.options.zIndex;l&&(i[n++]=new ky(a.range.startLineNumber,a.range.endLineNumber,l,null,d))}return i}prepareRender(t){let e=t.visibleRange.startLineNumber,i=t.visibleRange.endLineNumber,n=this._render(e,i,this._getDecorations(t)),o=[];for(let s=e;s<=i;s++){let a=s-e,l=n[a].getDecorations(),d="";for(let c of l)d+='<div class="cmdr '+c.className+'" style=""></div>';o[a]=d}this._renderResult=o}render(t,e){return this._renderResult?this._renderResult[e-t]:""}};var Bu=class r{_rgba8Brand=void 0;static Empty=new r(0,0,0,0);r;g;b;a;constructor(t,e,i,n){this.r=r._clamp(t),this.g=r._clamp(e),this.b=r._clamp(i),this.a=r._clamp(n)}equals(t){return this.r===t.r&&this.g===t.g&&this.b===t.b&&this.a===t.a}static _clamp(t){return t<0?0:t>255?255:t|0}};var Oce=(()=>{let r=[];for(let t=32;t<=126;t++)r.push(t);return r.push(65533),r})(),Nce=(r,t)=>(r-=32,r<0||r>96?t<=2?(r+96)%96:95:r);var IR=class r{constructor(t,e){this.scale=e;this.charDataNormal=r.soften(t,12/15),this.charDataLight=r.soften(t,50/60)}_minimapCharRendererBrand=void 0;charDataNormal;charDataLight;static soften(t,e){let i=new Uint8ClampedArray(t.length);for(let n=0,o=t.length;n<o;n++)i[n]=Hv(t[n]*e);return i}renderChar(t,e,i,n,o,s,a,l,d,c,p){let h=1*this.scale,m=2*this.scale,f=p?1:m;if(e+h>t.width||i+f>t.height){console.warn("bad render request outside image data");return}let g=c?this.charDataLight:this.charDataNormal,v=Nce(n,d),I=t.width*4,y=a.r,w=a.g,C=a.b,S=o.r-y,D=o.g-w,k=o.b-C,M=Math.max(s,l),O=t.data,K=v*h*m,G=i*I+e*4;for(let Y=0;Y<f;Y++){let ge=G;for(let xe=0;xe<h;xe++){let be=g[K++]/255*(s/255);O[ge++]=y+S*be,O[ge++]=w+D*be,O[ge++]=C+k*be,O[ge++]=M}G+=I}}blockRenderChar(t,e,i,n,o,s,a,l){let d=1*this.scale,c=2*this.scale,p=l?1:c;if(e+d>t.width||i+p>t.height){console.warn("bad render request outside image data");return}let h=t.width*4,m=.5*(o/255),f=s.r,g=s.g,v=s.b,I=n.r-f,y=n.g-g,w=n.b-v,C=f+I*m,S=g+y*m,D=v+w*m,k=Math.max(o,a),M=t.data,O=i*h+e*4;for(let K=0;K<p;K++){let G=O;for(let Y=0;Y<d;Y++)M[G++]=C,M[G++]=S,M[G++]=D,M[G++]=k;O+=h}}};var ZE=class r extends R{static _INSTANCE=null;static getInstance(){return this._INSTANCE||(this._INSTANCE=rc(new r)),this._INSTANCE}_colors;_backgroundIsLight;_onDidChange=new x;onDidChange=this._onDidChange.event;constructor(){super(),this._updateColorMap(),this._register(Is.onDidChange(t=>{t.changedColorMap&&this._updateColorMap()}))}_updateColorMap(){let t=Is.getColorMap();if(!t){this._colors=[Bu.Empty],this._backgroundIsLight=!0;return}this._colors=[Bu.Empty];for(let i=1;i<t.length;i++){let n=t[i].rgba;this._colors[i]=new Bu(n.r,n.g,n.b,Math.round(n.a*255))}let e=t[2].getRelativeLuminance();this._backgroundIsLight=e>=.5,this._onDidChange.fire(void 0)}getColor(t){return(t<1||t>=this._colors.length)&&(t=2),this._colors[t]}backgroundIsLight(){return this._backgroundIsLight}};var Bce={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15},Vce=r=>{let t=new Uint8ClampedArray(r.length/2);for(let e=0;e<r.length;e+=2)t[e>>1]=Bce[r[e]]<<4|Bce[r[e+1]]&15;return t},n$={1:$a(()=>Vce("0000511D6300CF609C709645A78432005642574171487021003C451900274D35D762755E8B629C5BA856AF57BA649530C167D1512A272A3F6038604460398526BCA2A968DB6F8957C768BE5FBE2FB467CF5D8D5B795DC7625B5DFF50DE64C466DB2FC47CD860A65E9A2EB96CB54CE06DA763AB2EA26860524D3763536601005116008177A8705E53AB738E6A982F88BAA35B5F5B626D9C636B449B737E5B7B678598869A662F6B5B8542706C704C80736A607578685B70594A49715A4522E792")),2:$a(()=>Vce("000000000000000055394F383D2800008B8B1F210002000081B1CBCBCC820000847AAF6B9AAF2119BE08B8881AD60000A44FD07DCCF107015338130C00000000385972265F390B406E2437634B4B48031B12B8A0847000001E15B29A402F0000000000004B33460B00007A752C2A0000000000004D3900000084394B82013400ABA5CFC7AD9C0302A45A3E5A98AB000089A43382D97900008BA54AA087A70A0248A6A7AE6DBE0000BF6F94987EA40A01A06DCFA7A7A9030496C32F77891D0000A99FB1A0AFA80603B29AB9CA75930D010C0948354D3900000C0948354F37460D0028BE673D8400000000AF9D7B6E00002B007AA8933400007AA642675C2700007984CFB9C3985B768772A8A6B7B20000CAAECAAFC4B700009F94A6009F840009D09F9BA4CA9C0000CC8FC76DC87F0000C991C472A2000000A894A48CA7B501079BA2C9C69BA20000B19A5D3FA89000005CA6009DA2960901B0A7F0669FB200009D009E00B7890000DAD0F5D092820000D294D4C48BD10000B5A7A4A3B1A50402CAB6CBA6A2000000B5A7A4A3B1A8044FCDADD19D9CB00000B7778F7B8AAE0803C9AB5D3F5D3F00009EA09EA0BAB006039EA0989A8C7900009B9EF4D6B7C00000A9A7816CACA80000ABAC84705D3F000096DA635CDC8C00006F486F266F263D4784006124097B00374F6D2D6D2D6D4A3A95872322000000030000000000008D8939130000000000002E22A5C9CBC70600AB25C0B5C9B400061A2DB04CA67001082AA6BEBEBFC606002321DACBC19E03087AA08B6768380000282FBAC0B8CA7A88AD25BBA5A29900004C396C5894A6000040485A6E356E9442A32CD17EADA70000B4237923628600003E2DE9C1D7B500002F25BBA5A2990000231DB6AFB4A804023025C0B5CAB588062B2CBDBEC0C706882435A75CA20000002326BD6A82A908048B4B9A5A668000002423A09CB4BB060025259C9D8A7900001C1FCAB2C7C700002A2A9387ABA200002626A4A47D6E9D14333163A0C87500004B6F9C2D643A257049364936493647358A34438355497F1A0000A24C1D590000D38DFFBDD4CD3126"))};var OW=class r{static lastCreated;static lastFontFamily;static create(t,e){if(this.lastCreated&&t===this.lastCreated.scale&&e===this.lastFontFamily)return this.lastCreated;let i;return n$[t]?i=new IR(n$[t](),t):i=r.createFromSampleData(r.createSampleData(e).data,t),this.lastFontFamily=e,this.lastCreated=i,i}static createSampleData(t){let e=document.createElement("canvas"),i=e.getContext("2d");e.style.height="16px",e.height=16,e.width=96*10,e.style.width=96*10+"px",i.fillStyle="#ffffff",i.font=`bold 16px ${t}`,i.textBaseline="middle";let n=0;for(let o of Oce)i.fillText(String.fromCharCode(o),n,16/2),n+=10;return i.getImageData(0,0,96*10,16)}static createFromSampleData(t,e){let i=16*10*4*96;if(t.length!==i)throw new Error("Unexpected source in MinimapCharRenderer");let n=r._downsample(t,e);return new IR(n,e)}static _downsampleChar(t,e,i,n,o){let s=1*o,a=2*o,l=n,d=0;for(let c=0;c<a;c++){let p=c/a*16,h=(c+1)/a*16;for(let m=0;m<s;m++){let f=m/s*10,g=(m+1)/s*10,v=0,I=0;for(let w=p;w<h;w++){let C=e+Math.floor(w)*3840,S=1-(w-Math.floor(w));for(let D=f;D<g;D++){let k=1-(D-Math.floor(D)),M=C+Math.floor(D)*4,O=k*S;I+=O,v+=t[M]*t[M+3]/255*O}}let y=v/I;d=Math.max(d,y),i[l++]=Hv(y)}}return d}static _downsample(t,e){let i=2*e*1*e,n=i*96,o=new Uint8ClampedArray(n),s=0,a=0,l=0;for(let d=0;d<96;d++)l=Math.max(l,this._downsampleChar(t,a,o,s,e)),s+=i,a+=10*4;if(l>0){let d=255/l;for(let c=0;c<n;c++)o[c]*=d}return o}};var Wce=St?'"Segoe WPC", "Segoe UI", sans-serif':ye?"-apple-system, BlinkMacSystemFont, sans-serif":'system-ui, "Ubuntu", "Droid Sans", sans-serif';var WEe=140,HEe=2,NW=class r{renderMinimap;size;minimapHeightIsEditorHeight;scrollBeyondLastLine;paddingTop;paddingBottom;showSlider;autohide;pixelRatio;typicalHalfwidthCharacterWidth;lineHeight;minimapLeft;minimapWidth;minimapHeight;canvasInnerWidth;canvasInnerHeight;canvasOuterWidth;canvasOuterHeight;isSampling;editorHeight;fontScale;minimapLineHeight;minimapCharWidth;sectionHeaderFontFamily;sectionHeaderFontSize;sectionHeaderLetterSpacing;sectionHeaderFontColor;charRenderer;defaultBackgroundColor;backgroundColor;foregroundAlpha;constructor(t,e,i){let n=t.options,o=n.get(145),s=n.get(147),a=s.minimap,l=n.get(51),d=n.get(74);this.renderMinimap=a.renderMinimap,this.size=d.size,this.minimapHeightIsEditorHeight=a.minimapHeightIsEditorHeight,this.scrollBeyondLastLine=n.get(107),this.paddingTop=n.get(85).top,this.paddingBottom=n.get(85).bottom,this.showSlider=d.showSlider,this.autohide=d.autohide,this.pixelRatio=o,this.typicalHalfwidthCharacterWidth=l.typicalHalfwidthCharacterWidth,this.lineHeight=n.get(68),this.minimapLeft=a.minimapLeft,this.minimapWidth=a.minimapWidth,this.minimapHeight=s.height,this.canvasInnerWidth=a.minimapCanvasInnerWidth,this.canvasInnerHeight=a.minimapCanvasInnerHeight,this.canvasOuterWidth=a.minimapCanvasOuterWidth,this.canvasOuterHeight=a.minimapCanvasOuterHeight,this.isSampling=a.minimapIsSampling,this.editorHeight=s.height,this.fontScale=a.minimapScale,this.minimapLineHeight=a.minimapLineHeight,this.minimapCharWidth=1*this.fontScale,this.sectionHeaderFontFamily=Wce,this.sectionHeaderFontSize=d.sectionHeaderFontSize*o,this.sectionHeaderLetterSpacing=d.sectionHeaderLetterSpacing,this.sectionHeaderFontColor=r._getSectionHeaderColor(e,i.getColor(1)),this.charRenderer=$a(()=>OW.create(this.fontScale,l.fontFamily)),this.defaultBackgroundColor=i.getColor(2),this.backgroundColor=r._getMinimapBackground(e,this.defaultBackgroundColor),this.foregroundAlpha=r._getMinimapForegroundOpacity(e)}static _getMinimapBackground(t,e){let i=t.getColor(Nne);return i?new Bu(i.rgba.r,i.rgba.g,i.rgba.b,Math.round(255*i.rgba.a)):e}static _getMinimapForegroundOpacity(t){let e=t.getColor(Fne);return e?Bu._clamp(Math.round(255*e.rgba.a)):255}static _getSectionHeaderColor(t,e){let i=t.getColor(Qo);return i?new Bu(i.rgba.r,i.rgba.g,i.rgba.b,Math.round(255*i.rgba.a)):e}equals(t){return this.renderMinimap===t.renderMinimap&&this.size===t.size&&this.minimapHeightIsEditorHeight===t.minimapHeightIsEditorHeight&&this.scrollBeyondLastLine===t.scrollBeyondLastLine&&this.paddingTop===t.paddingTop&&this.paddingBottom===t.paddingBottom&&this.showSlider===t.showSlider&&this.autohide===t.autohide&&this.pixelRatio===t.pixelRatio&&this.typicalHalfwidthCharacterWidth===t.typicalHalfwidthCharacterWidth&&this.lineHeight===t.lineHeight&&this.minimapLeft===t.minimapLeft&&this.minimapWidth===t.minimapWidth&&this.minimapHeight===t.minimapHeight&&this.canvasInnerWidth===t.canvasInnerWidth&&this.canvasInnerHeight===t.canvasInnerHeight&&this.canvasOuterWidth===t.canvasOuterWidth&&this.canvasOuterHeight===t.canvasOuterHeight&&this.isSampling===t.isSampling&&this.editorHeight===t.editorHeight&&this.fontScale===t.fontScale&&this.minimapLineHeight===t.minimapLineHeight&&this.minimapCharWidth===t.minimapCharWidth&&this.sectionHeaderFontSize===t.sectionHeaderFontSize&&this.sectionHeaderLetterSpacing===t.sectionHeaderLetterSpacing&&this.defaultBackgroundColor&&this.defaultBackgroundColor.equals(t.defaultBackgroundColor)&&this.backgroundColor&&this.backgroundColor.equals(t.backgroundColor)&&this.foregroundAlpha===t.foregroundAlpha}},o$=class r{constructor(t,e,i,n,o,s,a,l,d){this.scrollTop=t;this.scrollHeight=e;this.sliderNeeded=i;this._computedSliderRatio=n;this.sliderTop=o;this.sliderHeight=s;this.topPaddingLineCount=a;this.startLineNumber=l;this.endLineNumber=d}getDesiredScrollTopFromDelta(t){return Math.round(this.scrollTop+t/this._computedSliderRatio)}getDesiredScrollTopFromTouchLocation(t){return Math.round((t-this.sliderHeight/2)/this._computedSliderRatio)}intersectWithViewport(t){let e=Math.max(this.startLineNumber,t.startLineNumber),i=Math.min(this.endLineNumber,t.endLineNumber);return e>i?null:[e,i]}getYForLineNumber(t,e){return+(t-this.startLineNumber+this.topPaddingLineCount)*e}static create(t,e,i,n,o,s,a,l,d,c,p){let h=t.pixelRatio,m=t.minimapLineHeight,f=Math.floor(t.canvasInnerHeight/m),g=t.lineHeight;if(t.minimapHeightIsEditorHeight){let D=l*t.lineHeight+t.paddingTop+t.paddingBottom;t.scrollBeyondLastLine&&(D+=Math.max(0,o-t.lineHeight-t.paddingBottom));let k=Math.max(1,Math.floor(o*o/D)),M=Math.max(0,t.minimapHeight-k),O=M/(c-o),K=d*O,G=M>0,Y=Math.floor(t.canvasInnerHeight/t.minimapLineHeight),ge=Math.floor(t.paddingTop/t.lineHeight);return new r(d,c,G,O,K,k,ge,1,Math.min(a,Y))}let v;if(s&&i!==a){let D=i-e+1;v=Math.floor(D*m/h)}else{let D=o/g;v=Math.floor(D*m/h)}let I=Math.floor(t.paddingTop/g),y=Math.floor(t.paddingBottom/g);if(t.scrollBeyondLastLine){let D=o/g;y=Math.max(y,D-1)}let w;if(y>0){let D=o/g;w=(I+a+y-D-1)*m/h}else w=Math.max(0,(I+a)*m/h-v);w=Math.min(t.minimapHeight-v,w);let C=w/(c-o),S=d*C;if(f>=I+a+y){let D=w>0;return new r(d,c,D,C,S,v,I,1,a)}else{let D;e>1?D=e+I:D=Math.max(1,d/g);let k,M=Math.max(1,Math.floor(D-S*h/m));M<I?(k=I-M+1,M=1):(k=0,M=Math.max(1,M-I)),p&&p.scrollHeight===c&&(p.scrollTop>d&&(M=Math.min(M,p.startLineNumber),k=Math.max(k,p.topPaddingLineCount)),p.scrollTop<d&&(M=Math.max(M,p.startLineNumber),k=Math.min(k,p.topPaddingLineCount)));let O=Math.min(a,M-k+f-1),K=(d-n)/g,G;return d>=t.paddingTop?G=(e-M+k+K)*m/h:G=d/t.paddingTop*(k+K)*m/h,new r(d,c,!0,C,G,v,k,M,O)}}},FW=class r{static INVALID=new r(-1);dy;constructor(t){this.dy=t}onContentChanged(){this.dy=-1}onTokensChanged(){this.dy=-1}},BW=class{renderedLayout;_imageData;_renderedLines;constructor(t,e,i){this.renderedLayout=t,this._imageData=e,this._renderedLines=new oR({createLine:()=>FW.INVALID}),this._renderedLines._set(t.startLineNumber,i)}linesEquals(t){if(!this.scrollEquals(t))return!1;let i=this._renderedLines._get().lines;for(let n=0,o=i.length;n<o;n++)if(i[n].dy===-1)return!1;return!0}scrollEquals(t){return this.renderedLayout.startLineNumber===t.startLineNumber&&this.renderedLayout.endLineNumber===t.endLineNumber}_get(){let t=this._renderedLines._get();return{imageData:this._imageData,rendLineNumberStart:t.rendLineNumberStart,lines:t.lines}}onLinesChanged(t,e){return this._renderedLines.onLinesChanged(t,e)}onLinesDeleted(t,e){this._renderedLines.onLinesDeleted(t,e)}onLinesInserted(t,e){this._renderedLines.onLinesInserted(t,e)}onTokensChanged(t){return this._renderedLines.onTokensChanged(t)}},r$=class r{_backgroundFillData;_buffers;_lastUsedBuffer;constructor(t,e,i,n){this._backgroundFillData=r._createBackgroundFillData(e,i,n),this._buffers=[t.createImageData(e,i),t.createImageData(e,i)],this._lastUsedBuffer=0}getBuffer(){this._lastUsedBuffer=1-this._lastUsedBuffer;let t=this._buffers[this._lastUsedBuffer];return t.data.set(this._backgroundFillData),t}static _createBackgroundFillData(t,e,i){let n=i.r,o=i.g,s=i.b,a=i.a,l=new Uint8ClampedArray(t*e*4),d=0;for(let c=0;c<e;c++)for(let p=0;p<t;p++)l[d]=n,l[d+1]=o,l[d+2]=s,l[d+3]=a,d+=4;return l}},VW=class r{constructor(t,e){this.samplingRatio=t;this.minimapLines=e}static compute(t,e,i){if(t.renderMinimap===0||!t.isSampling)return[null,[]];let{minimapLineCount:n}=LD.computeContainedMinimapLineCount({viewLineCount:e,scrollBeyondLastLine:t.scrollBeyondLastLine,paddingTop:t.paddingTop,paddingBottom:t.paddingBottom,height:t.editorHeight,lineHeight:t.lineHeight,pixelRatio:t.pixelRatio}),o=e/n,s=o/2;if(!i||i.minimapLines.length===0){let v=[];if(v[0]=1,n>1){for(let I=0,y=n-1;I<y;I++)v[I]=Math.round(I*o+s);v[n-1]=e}return[new r(o,v),[]]}let a=i.minimapLines,l=a.length,d=[],c=0,p=0,h=1,m=10,f=[],g=null;for(let v=0;v<n;v++){let I=Math.max(h,Math.round(v*o)),y=Math.max(I,Math.round((v+1)*o));for(;c<l&&a[c]<I;){if(f.length<m){let C=c+1+p;g&&g.type==="deleted"&&g._oldIndex===c-1?g.deleteToLineNumber++:(g={type:"deleted",_oldIndex:c,deleteFromLineNumber:C,deleteToLineNumber:C},f.push(g)),p--}c++}let w;if(c<l&&a[c]<=y)w=a[c],c++;else if(v===0?w=1:v+1===n?w=e:w=Math.round(v*o+s),f.length<m){let C=c+1+p;g&&g.type==="inserted"&&g._i===v-1?g.insertToLineNumber++:(g={type:"inserted",_i:v,insertFromLineNumber:C,insertToLineNumber:C},f.push(g)),p++}d[v]=w,h=w}if(f.length<m)for(;c<l;){let v=c+1+p;g&&g.type==="deleted"&&g._oldIndex===c-1?g.deleteToLineNumber++:(g={type:"deleted",_oldIndex:c,deleteFromLineNumber:v,deleteToLineNumber:v},f.push(g)),p--,c++}else f=[{type:"flush"}];return[new r(o,d),f]}modelLineToMinimapLine(t){return Math.min(this.minimapLines.length,Math.max(1,Math.round(t/this.samplingRatio)))}modelLineRangeToMinimapLineRange(t,e){let i=this.modelLineToMinimapLine(t)-1;for(;i>0&&this.minimapLines[i-1]>=t;)i--;let n=this.modelLineToMinimapLine(e)-1;for(;n+1<this.minimapLines.length&&this.minimapLines[n+1]<=e;)n++;if(i===n){let o=this.minimapLines[i];if(o<t||o>e)return null}return[i+1,n+1]}decorationLineRangeToMinimapLineRange(t,e){let i=this.modelLineToMinimapLine(t),n=this.modelLineToMinimapLine(e);return t!==e&&n===i&&(n===this.minimapLines.length?i>1&&i--:n++),[i,n]}onLinesDeleted(t){let e=t.toLineNumber-t.fromLineNumber+1,i=this.minimapLines.length,n=0;for(let o=this.minimapLines.length-1;o>=0&&!(this.minimapLines[o]<t.fromLineNumber);o--)this.minimapLines[o]<=t.toLineNumber?(this.minimapLines[o]=Math.max(1,t.fromLineNumber-1),i=Math.min(i,o),n=Math.max(n,o)):this.minimapLines[o]-=e;return[i,n]}onLinesInserted(t){let e=t.toLineNumber-t.fromLineNumber+1;for(let i=this.minimapLines.length-1;i>=0&&!(this.minimapLines[i]<t.fromLineNumber);i--)this.minimapLines[i]+=e}},WW=class extends Dn{tokensColorTracker;_selections;_minimapSelections;options;_samplingState;_shouldCheckSampling;_sectionHeaderCache=new zr(10,1.5);_actual;constructor(t){super(t),this.tokensColorTracker=ZE.getInstance(),this._selections=[],this._minimapSelections=null,this.options=new NW(this._context.configuration,this._context.theme,this.tokensColorTracker);let[e]=VW.compute(this.options,this._context.viewModel.getLineCount(),null);this._samplingState=e,this._shouldCheckSampling=!1,this._actual=new s$(t.theme,this)}dispose(){this._actual.dispose(),super.dispose()}getDomNode(){return this._actual.getDomNode()}_onOptionsMaybeChanged(){let t=new NW(this._context.configuration,this._context.theme,this.tokensColorTracker);return this.options.equals(t)?!1:(this.options=t,this._recreateLineSampling(),this._actual.onDidChangeOptions(),!0)}onConfigurationChanged(t){return this._onOptionsMaybeChanged()}onCursorStateChanged(t){return this._selections=t.selections,this._minimapSelections=null,this._actual.onSelectionChanged()}onDecorationsChanged(t){return t.affectsMinimap?this._actual.onDecorationsChanged():!1}onFlushed(t){return this._samplingState&&(this._shouldCheckSampling=!0),this._actual.onFlushed()}onLinesChanged(t){if(this._samplingState){let e=this._samplingState.modelLineRangeToMinimapLineRange(t.fromLineNumber,t.fromLineNumber+t.count-1);return e?this._actual.onLinesChanged(e[0],e[1]-e[0]+1):!1}else return this._actual.onLinesChanged(t.fromLineNumber,t.count)}onLinesDeleted(t){if(this._samplingState){let[e,i]=this._samplingState.onLinesDeleted(t);return e<=i&&this._actual.onLinesChanged(e+1,i-e+1),this._shouldCheckSampling=!0,!0}else return this._actual.onLinesDeleted(t.fromLineNumber,t.toLineNumber)}onLinesInserted(t){return this._samplingState?(this._samplingState.onLinesInserted(t),this._shouldCheckSampling=!0,!0):this._actual.onLinesInserted(t.fromLineNumber,t.toLineNumber)}onScrollChanged(t){return this._actual.onScrollChanged()}onThemeChanged(t){return this._actual.onThemeChanged(),this._onOptionsMaybeChanged(),!0}onTokensChanged(t){if(this._samplingState){let e=[];for(let i of t.ranges){let n=this._samplingState.modelLineRangeToMinimapLineRange(i.fromLineNumber,i.toLineNumber);n&&e.push({fromLineNumber:n[0],toLineNumber:n[1]})}return e.length?this._actual.onTokensChanged(e):!1}else return this._actual.onTokensChanged(t.ranges)}onTokensColorsChanged(t){return this._onOptionsMaybeChanged(),this._actual.onTokensColorsChanged()}onZonesChanged(t){return this._actual.onZonesChanged()}prepareRender(t){this._shouldCheckSampling&&(this._shouldCheckSampling=!1,this._recreateLineSampling())}render(t){let e=t.visibleRange.startLineNumber,i=t.visibleRange.endLineNumber;this._samplingState&&(e=this._samplingState.modelLineToMinimapLine(e),i=this._samplingState.modelLineToMinimapLine(i));let n={viewportContainsWhitespaceGaps:t.viewportData.whitespaceViewportData.length>0,scrollWidth:t.scrollWidth,scrollHeight:t.scrollHeight,viewportStartLineNumber:e,viewportEndLineNumber:i,viewportStartLineNumberVerticalOffset:t.getVerticalOffsetForLineNumber(e),scrollTop:t.scrollTop,scrollLeft:t.scrollLeft,viewportWidth:t.viewportWidth,viewportHeight:t.viewportHeight};this._actual.render(n)}_recreateLineSampling(){this._minimapSelections=null;let t=!!this._samplingState,[e,i]=VW.compute(this.options,this._context.viewModel.getLineCount(),this._samplingState);if(this._samplingState=e,t&&this._samplingState)for(let n of i)switch(n.type){case"deleted":this._actual.onLinesDeleted(n.deleteFromLineNumber,n.deleteToLineNumber);break;case"inserted":this._actual.onLinesInserted(n.insertFromLineNumber,n.insertToLineNumber);break;case"flush":this._actual.onFlushed();break}}getLineCount(){return this._samplingState?this._samplingState.minimapLines.length:this._context.viewModel.getLineCount()}getRealLineCount(){return this._context.viewModel.getLineCount()}getLineContent(t){return this._samplingState?this._context.viewModel.getLineContent(this._samplingState.minimapLines[t-1]):this._context.viewModel.getLineContent(t)}getLineMaxColumn(t){return this._samplingState?this._context.viewModel.getLineMaxColumn(this._samplingState.minimapLines[t-1]):this._context.viewModel.getLineMaxColumn(t)}getMinimapLinesRenderingData(t,e,i){if(this._samplingState){let n=[];for(let o=0,s=e-t+1;o<s;o++)i[o]?n[o]=this._context.viewModel.getViewLineData(this._samplingState.minimapLines[t+o-1]):n[o]=null;return n}return this._context.viewModel.getMinimapLinesRenderingData(t,e,i).data}getSelections(){if(this._minimapSelections===null)if(this._samplingState){this._minimapSelections=[];for(let t of this._selections){let[e,i]=this._samplingState.decorationLineRangeToMinimapLineRange(t.startLineNumber,t.endLineNumber);this._minimapSelections.push(new Et(e,t.startColumn,i,t.endColumn))}}else this._minimapSelections=this._selections;return this._minimapSelections}getMinimapDecorationsInViewport(t,e){let i=this._getMinimapDecorationsInViewport(t,e).filter(n=>!n.options.minimap?.sectionHeaderStyle);if(this._samplingState){let n=[];for(let o of i){if(!o.options.minimap)continue;let s=o.range,a=this._samplingState.modelLineToMinimapLine(s.startLineNumber),l=this._samplingState.modelLineToMinimapLine(s.endLineNumber);n.push(new VC(new L(a,s.startColumn,l,s.endColumn),o.options))}return n}return i}getSectionHeaderDecorationsInViewport(t,e){let i=this.options.minimapLineHeight,o=this.options.sectionHeaderFontSize/i;return t=Math.floor(Math.max(1,t-o)),this._getMinimapDecorationsInViewport(t,e).filter(s=>!!s.options.minimap?.sectionHeaderStyle)}_getMinimapDecorationsInViewport(t,e){let i;if(this._samplingState){let n=this._samplingState.minimapLines[t-1],o=this._samplingState.minimapLines[e-1];i=new L(n,1,o,this._context.viewModel.getLineMaxColumn(o))}else i=new L(t,1,e,this._context.viewModel.getLineMaxColumn(e));return this._context.viewModel.getMinimapDecorationsInRange(i)}getSectionHeaderText(t,e){let i=t.options.minimap?.sectionHeaderText;if(!i)return null;let n=this._sectionHeaderCache.get(i);if(n)return n;let o=e(i);return this._sectionHeaderCache.set(i,o),o}getOptions(){return this._context.viewModel.model.getOptions()}revealLineNumber(t){this._samplingState&&(t=this._samplingState.minimapLines[t-1]),this._context.viewModel.revealRange("mouse",!1,new L(t,1,t,1),1,0)}setScrollTop(t){this._context.viewModel.viewLayout.setScrollPosition({scrollTop:t},1)}},s$=class r extends R{_theme;_model;_domNode;_shadow;_canvas;_decorationsCanvas;_slider;_sliderHorizontal;_pointerDownListener;_sliderPointerMoveMonitor;_sliderPointerDownListener;_gestureDisposable;_sliderTouchStartListener;_sliderTouchMoveListener;_sliderTouchEndListener;_lastRenderData;_selectionColor;_renderDecorations=!1;_gestureInProgress=!1;_buffers;constructor(t,e){super(),this._theme=t,this._model=e,this._lastRenderData=null,this._buffers=null,this._selectionColor=this._theme.getColor(I8),this._domNode=Ot(document.createElement("div")),Pr.write(this._domNode,9),this._domNode.setClassName(this._getMinimapDomNodeClassName()),this._domNode.setPosition("absolute"),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._shadow=Ot(document.createElement("div")),this._shadow.setClassName("minimap-shadow-hidden"),this._domNode.appendChild(this._shadow),this._canvas=Ot(document.createElement("canvas")),this._canvas.setPosition("absolute"),this._canvas.setLeft(0),this._domNode.appendChild(this._canvas),this._decorationsCanvas=Ot(document.createElement("canvas")),this._decorationsCanvas.setPosition("absolute"),this._decorationsCanvas.setClassName("minimap-decorations-layer"),this._decorationsCanvas.setLeft(0),this._domNode.appendChild(this._decorationsCanvas),this._slider=Ot(document.createElement("div")),this._slider.setPosition("absolute"),this._slider.setClassName("minimap-slider"),this._slider.setLayerHinting(!0),this._slider.setContain("strict"),this._domNode.appendChild(this._slider),this._sliderHorizontal=Ot(document.createElement("div")),this._sliderHorizontal.setPosition("absolute"),this._sliderHorizontal.setClassName("minimap-slider-horizontal"),this._slider.appendChild(this._sliderHorizontal),this._applyLayout(),this._pointerDownListener=Ut(this._domNode.domNode,Q.POINTER_DOWN,i=>{if(i.preventDefault(),this._model.options.renderMinimap===0||!this._lastRenderData)return;if(this._model.options.size!=="proportional"){if(i.button===0&&this._lastRenderData){let d=Oi(this._slider.domNode),c=d.top+d.height/2;this._startSliderDragging(i,c,this._lastRenderData.renderedLayout)}return}let o=this._model.options.minimapLineHeight,s=this._model.options.canvasInnerHeight/this._model.options.canvasOuterHeight*i.offsetY,l=Math.floor(s/o)+this._lastRenderData.renderedLayout.startLineNumber-this._lastRenderData.renderedLayout.topPaddingLineCount;l=Math.min(l,this._model.getLineCount()),this._model.revealLineNumber(l)}),this._sliderPointerMoveMonitor=new Hl,this._sliderPointerDownListener=Ut(this._slider.domNode,Q.POINTER_DOWN,i=>{i.preventDefault(),i.stopPropagation(),i.button===0&&this._lastRenderData&&this._startSliderDragging(i,i.pageY,this._lastRenderData.renderedLayout)}),this._gestureDisposable=yi.addTarget(this._domNode.domNode),this._sliderTouchStartListener=F(this._domNode.domNode,At.Start,i=>{i.preventDefault(),i.stopPropagation(),this._lastRenderData&&(this._slider.toggleClassName("active",!0),this._gestureInProgress=!0,this.scrollDueToTouchEvent(i))},{passive:!1}),this._sliderTouchMoveListener=F(this._domNode.domNode,At.Change,i=>{i.preventDefault(),i.stopPropagation(),this._lastRenderData&&this._gestureInProgress&&this.scrollDueToTouchEvent(i)},{passive:!1}),this._sliderTouchEndListener=Ut(this._domNode.domNode,At.End,i=>{i.preventDefault(),i.stopPropagation(),this._gestureInProgress=!1,this._slider.toggleClassName("active",!1)})}_startSliderDragging(t,e,i){if(!t.target||!(t.target instanceof Element))return;let n=t.pageX;this._slider.toggleClassName("active",!0);let o=(s,a)=>{let l=Oi(this._domNode.domNode),d=Math.min(Math.abs(a-n),Math.abs(a-l.left),Math.abs(a-l.left-l.width));if(St&&d>WEe){this._model.setScrollTop(i.scrollTop);return}let c=s-e;this._model.setScrollTop(i.getDesiredScrollTopFromDelta(c))};t.pageY!==e&&o(t.pageY,n),this._sliderPointerMoveMonitor.startMonitoring(t.target,t.pointerId,t.buttons,s=>o(s.pageY,s.pageX),()=>{this._slider.toggleClassName("active",!1)})}scrollDueToTouchEvent(t){let e=this._domNode.domNode.getBoundingClientRect().top,i=this._lastRenderData.renderedLayout.getDesiredScrollTopFromTouchLocation(t.pageY-e);this._model.setScrollTop(i)}dispose(){this._pointerDownListener.dispose(),this._sliderPointerMoveMonitor.dispose(),this._sliderPointerDownListener.dispose(),this._gestureDisposable.dispose(),this._sliderTouchStartListener.dispose(),this._sliderTouchMoveListener.dispose(),this._sliderTouchEndListener.dispose(),super.dispose()}_getMinimapDomNodeClassName(){let t=["minimap"];return this._model.options.showSlider==="always"?t.push("slider-always"):t.push("slider-mouseover"),this._model.options.autohide&&t.push("autohide"),t.join(" ")}getDomNode(){return this._domNode}_applyLayout(){this._domNode.setLeft(this._model.options.minimapLeft),this._domNode.setWidth(this._model.options.minimapWidth),this._domNode.setHeight(this._model.options.minimapHeight),this._shadow.setHeight(this._model.options.minimapHeight),this._canvas.setWidth(this._model.options.canvasOuterWidth),this._canvas.setHeight(this._model.options.canvasOuterHeight),this._canvas.domNode.width=this._model.options.canvasInnerWidth,this._canvas.domNode.height=this._model.options.canvasInnerHeight,this._decorationsCanvas.setWidth(this._model.options.canvasOuterWidth),this._decorationsCanvas.setHeight(this._model.options.canvasOuterHeight),this._decorationsCanvas.domNode.width=this._model.options.canvasInnerWidth,this._decorationsCanvas.domNode.height=this._model.options.canvasInnerHeight,this._slider.setWidth(this._model.options.minimapWidth)}_getBuffer(){return this._buffers||this._model.options.canvasInnerWidth>0&&this._model.options.canvasInnerHeight>0&&(this._buffers=new r$(this._canvas.domNode.getContext("2d"),this._model.options.canvasInnerWidth,this._model.options.canvasInnerHeight,this._model.options.backgroundColor)),this._buffers?this._buffers.getBuffer():null}onDidChangeOptions(){this._lastRenderData=null,this._buffers=null,this._applyLayout(),this._domNode.setClassName(this._getMinimapDomNodeClassName())}onSelectionChanged(){return this._renderDecorations=!0,!0}onDecorationsChanged(){return this._renderDecorations=!0,!0}onFlushed(){return this._lastRenderData=null,!0}onLinesChanged(t,e){return this._lastRenderData?this._lastRenderData.onLinesChanged(t,e):!1}onLinesDeleted(t,e){return this._lastRenderData?.onLinesDeleted(t,e),!0}onLinesInserted(t,e){return this._lastRenderData?.onLinesInserted(t,e),!0}onScrollChanged(){return this._renderDecorations=!0,!0}onThemeChanged(){return this._selectionColor=this._theme.getColor(I8),this._renderDecorations=!0,!0}onTokensChanged(t){return this._lastRenderData?this._lastRenderData.onTokensChanged(t):!1}onTokensColorsChanged(){return this._lastRenderData=null,this._buffers=null,!0}onZonesChanged(){return this._lastRenderData=null,!0}render(t){if(this._model.options.renderMinimap===0){this._shadow.setClassName("minimap-shadow-hidden"),this._sliderHorizontal.setWidth(0),this._sliderHorizontal.setHeight(0);return}t.scrollLeft+t.viewportWidth>=t.scrollWidth?this._shadow.setClassName("minimap-shadow-hidden"):this._shadow.setClassName("minimap-shadow-visible");let i=o$.create(this._model.options,t.viewportStartLineNumber,t.viewportEndLineNumber,t.viewportStartLineNumberVerticalOffset,t.viewportHeight,t.viewportContainsWhitespaceGaps,this._model.getLineCount(),this._model.getRealLineCount(),t.scrollTop,t.scrollHeight,this._lastRenderData?this._lastRenderData.renderedLayout:null);this._slider.setDisplay(i.sliderNeeded?"block":"none"),this._slider.setTop(i.sliderTop),this._slider.setHeight(i.sliderHeight),this._sliderHorizontal.setLeft(0),this._sliderHorizontal.setWidth(this._model.options.minimapWidth),this._sliderHorizontal.setTop(0),this._sliderHorizontal.setHeight(i.sliderHeight),this.renderDecorations(i),this._lastRenderData=this.renderLines(i)}renderDecorations(t){if(this._renderDecorations){this._renderDecorations=!1;let e=this._model.getSelections();e.sort(L.compareRangesUsingStarts);let i=this._model.getMinimapDecorationsInViewport(t.startLineNumber,t.endLineNumber);i.sort((h,m)=>(h.options.zIndex||0)-(m.options.zIndex||0));let{canvasInnerWidth:n,canvasInnerHeight:o}=this._model.options,s=this._model.options.minimapLineHeight,a=this._model.options.minimapCharWidth,l=this._model.getOptions().tabSize,d=this._decorationsCanvas.domNode.getContext("2d");d.clearRect(0,0,n,o);let c=new HW(t.startLineNumber,t.endLineNumber,!1);this._renderSelectionLineHighlights(d,e,c,t,s),this._renderDecorationsLineHighlights(d,i,c,t,s);let p=new HW(t.startLineNumber,t.endLineNumber,null);this._renderSelectionsHighlights(d,e,p,t,s,l,a,n),this._renderDecorationsHighlights(d,i,p,t,s,l,a,n),this._renderSectionHeaders(t)}}_renderSelectionLineHighlights(t,e,i,n,o){if(!this._selectionColor||this._selectionColor.isTransparent())return;t.fillStyle=this._selectionColor.transparent(.5).toString();let s=0,a=0;for(let l of e){let d=n.intersectWithViewport(l);if(!d)continue;let[c,p]=d;for(let f=c;f<=p;f++)i.set(f,!0);let h=n.getYForLineNumber(c,o),m=n.getYForLineNumber(p,o);a>=h||(a>s&&t.fillRect(ru,s,t.canvas.width,a-s),s=h),a=m}a>s&&t.fillRect(ru,s,t.canvas.width,a-s)}_renderDecorationsLineHighlights(t,e,i,n,o){let s=new Map;for(let a=e.length-1;a>=0;a--){let l=e[a],d=l.options.minimap;if(!d||d.position!==1)continue;let c=n.intersectWithViewport(l.range);if(!c)continue;let[p,h]=c,m=d.getColor(this._theme.value);if(!m||m.isTransparent())continue;let f=s.get(m.toString());f||(f=m.transparent(.5).toString(),s.set(m.toString(),f)),t.fillStyle=f;for(let g=p;g<=h;g++){if(i.has(g))continue;i.set(g,!0);let v=n.getYForLineNumber(p,o);t.fillRect(ru,v,t.canvas.width,o)}}}_renderSelectionsHighlights(t,e,i,n,o,s,a,l){if(!(!this._selectionColor||this._selectionColor.isTransparent()))for(let d of e){let c=n.intersectWithViewport(d);if(!c)continue;let[p,h]=c;for(let m=p;m<=h;m++)this.renderDecorationOnLine(t,i,d,this._selectionColor,n,m,o,o,s,a,l)}}_renderDecorationsHighlights(t,e,i,n,o,s,a,l){for(let d of e){let c=d.options.minimap;if(!c)continue;let p=n.intersectWithViewport(d.range);if(!p)continue;let[h,m]=p,f=c.getColor(this._theme.value);if(!(!f||f.isTransparent()))for(let g=h;g<=m;g++)switch(c.position){case 1:this.renderDecorationOnLine(t,i,d.range,f,n,g,o,o,s,a,l);continue;case 2:{let v=n.getYForLineNumber(g,o);this.renderDecoration(t,f,2,v,HEe,o);continue}}}}renderDecorationOnLine(t,e,i,n,o,s,a,l,d,c,p){let h=o.getYForLineNumber(s,l);if(h+a<0||h>this._model.options.canvasInnerHeight)return;let{startLineNumber:m,endLineNumber:f}=i,g=m===s?i.startColumn:1,v=f===s?i.endColumn:this._model.getLineMaxColumn(s),I=this.getXOffsetForPosition(e,s,g,d,c,p),y=this.getXOffsetForPosition(e,s,v,d,c,p);this.renderDecoration(t,n,I,h,y-I,a)}getXOffsetForPosition(t,e,i,n,o,s){if(i===1)return ru;if((i-1)*o>=s)return s;let l=t.get(e);if(!l){let d=this._model.getLineContent(e);l=[ru];let c=ru;for(let p=1;p<d.length+1;p++){let h=d.charCodeAt(p-1),m=h===9?n*o:vd(h)?2*o:o,f=c+m;if(f>=s){l[p]=s;break}l[p]=f,c=f}t.set(e,l)}return i-1<l.length?l[i-1]:s}renderDecoration(t,e,i,n,o,s){t.fillStyle=e&&e.toString()||"",t.fillRect(i,n,o,s)}_renderSectionHeaders(t){let e=this._model.options.minimapLineHeight,i=this._model.options.sectionHeaderFontSize,n=this._model.options.sectionHeaderLetterSpacing,o=i*1.5,{canvasInnerWidth:s}=this._model.options,a=this._model.options.backgroundColor,l=`rgb(${a.r} ${a.g} ${a.b} / .7)`,d=this._model.options.sectionHeaderFontColor,c=`rgb(${d.r} ${d.g} ${d.b})`,p=c,h=this._decorationsCanvas.domNode.getContext("2d");h.letterSpacing=n+"px",h.font="500 "+i+"px "+this._model.options.sectionHeaderFontFamily,h.strokeStyle=p,h.lineWidth=.2;let m=this._model.getSectionHeaderDecorationsInViewport(t.startLineNumber,t.endLineNumber);m.sort((g,v)=>g.range.startLineNumber-v.range.startLineNumber);let f=r._fitSectionHeader.bind(null,h,s-ru);for(let g of m){let v=t.getYForLineNumber(g.range.startLineNumber,e)+i,I=v-i,y=I+2,w=this._model.getSectionHeaderText(g,f);r._renderSectionLabel(h,w,g.options.minimap?.sectionHeaderStyle===2,l,c,s,I,o,v,y)}}static _fitSectionHeader(t,e,i){if(!i)return i;let n="\u2026",o=t.measureText(i).width,s=t.measureText(n).width;if(o<=e||o<=s)return i;let a=i.length,l=o/i.length,d=Math.floor((e-s)/l)-1,c=Math.ceil(d/2);for(;c>0&&/\s/.test(i[c-1]);)--c;return i.substring(0,c)+n+i.substring(a-(d-c))}static _renderSectionLabel(t,e,i,n,o,s,a,l,d,c){e&&(t.fillStyle=n,t.fillRect(0,a,s,l),t.fillStyle=o,t.fillText(e,ru,d)),i&&(t.beginPath(),t.moveTo(0,c),t.lineTo(s,c),t.closePath(),t.stroke())}renderLines(t){let e=t.startLineNumber,i=t.endLineNumber,n=this._model.options.minimapLineHeight;if(this._lastRenderData&&this._lastRenderData.linesEquals(t)){let be=this._lastRenderData._get();return new BW(t,be.imageData,be.lines)}let o=this._getBuffer();if(!o)return null;let[s,a,l]=r._renderUntouchedLines(o,t.topPaddingLineCount,e,i,n,this._lastRenderData),d=this._model.getMinimapLinesRenderingData(e,i,l),c=this._model.getOptions().tabSize,p=this._model.options.defaultBackgroundColor,h=this._model.options.backgroundColor,m=this._model.options.foregroundAlpha,f=this._model.tokensColorTracker,g=f.backgroundIsLight(),v=this._model.options.renderMinimap,I=this._model.options.charRenderer(),y=this._model.options.fontScale,w=this._model.options.minimapCharWidth,S=(v===1?2:3)*y,D=n>S?Math.floor((n-S)/2):0,k=h.a/255,M=new Bu(Math.round((h.r-p.r)*k+p.r),Math.round((h.g-p.g)*k+p.g),Math.round((h.b-p.b)*k+p.b),255),O=t.topPaddingLineCount*n,K=[];for(let be=0,fe=i-e+1;be<fe;be++)l[be]&&r._renderLine(o,M,h.a,g,v,w,f,m,I,O,D,c,d[be],y,n),K[be]=new FW(O),O+=n;let G=s===-1?0:s,ge=(a===-1?o.height:a)-G;return this._canvas.domNode.getContext("2d").putImageData(o,0,0,0,G,o.width,ge),new BW(t,o,K)}static _renderUntouchedLines(t,e,i,n,o,s){let a=[];if(!s){for(let O=0,K=n-i+1;O<K;O++)a[O]=!0;return[-1,-1,a]}let l=s._get(),d=l.imageData.data,c=l.rendLineNumberStart,p=l.lines,h=p.length,m=t.width,f=t.data,g=(n-i+1)*o*m*4,v=-1,I=-1,y=-1,w=-1,C=-1,S=-1,D=e*o;for(let O=i;O<=n;O++){let K=O-i,G=O-c,Y=G>=0&&G<h?p[G].dy:-1;if(Y===-1){a[K]=!0,D+=o;continue}let ge=Y*m*4,xe=(Y+o)*m*4,be=D*m*4,fe=(D+o)*m*4;w===ge&&S===be?(w=xe,S=fe):(y!==-1&&(f.set(d.subarray(y,w),C),v===-1&&y===0&&y===C&&(v=w),I===-1&&w===g&&y===C&&(I=y)),y=ge,w=xe,C=be,S=fe),a[K]=!1,D+=o}y!==-1&&(f.set(d.subarray(y,w),C),v===-1&&y===0&&y===C&&(v=w),I===-1&&w===g&&y===C&&(I=y));let k=v===-1?-1:v/(m*4),M=I===-1?-1:I/(m*4);return[k,M,a]}static _renderLine(t,e,i,n,o,s,a,l,d,c,p,h,m,f,g){let v=m.content,I=m.tokens,y=t.width-s,w=g===1,C=ru,S=0,D=0;for(let k=0,M=I.getCount();k<M;k++){let O=I.getEndOffset(k),K=I.getForeground(k),G=a.getColor(K);for(;S<O;S++){if(C>y)return;let Y=v.charCodeAt(S);if(Y===9){let ge=h-(S+D)%h;D+=ge-1,C+=ge*s}else if(Y===32)C+=s;else{let ge=vd(Y)?2:1;for(let xe=0;xe<ge;xe++)if(o===2?d.blockRenderChar(t,C,c+p,G,l,e,i,w):d.renderChar(t,C,c+p,Y,G,l,e,i,f,n,w),C+=s,C>y)return}}}}},HW=class{_startLineNumber;_endLineNumber;_defaultValue;_values;constructor(t,e,i){this._startLineNumber=t,this._endLineNumber=e,this._defaultValue=i,this._values=[];for(let n=0,o=this._endLineNumber-this._startLineNumber+1;n<o;n++)this._values[n]=i}has(t){return this.get(t)!==this._defaultValue}set(t,e){t<this._startLineNumber||t>this._endLineNumber||(this._values[t-this._startLineNumber]=e)}get(t){return t<this._startLineNumber||t>this._endLineNumber?this._defaultValue:this._values[t-this._startLineNumber]}};var UW=class extends Dn{_viewDomNode;_widgets;_viewDomNodeRect;_domNode;overflowingOverlayWidgetsDomNode;_verticalScrollbarWidth;_minimapWidth;_horizontalScrollbarHeight;_editorHeight;_editorWidth;constructor(t,e){super(t),this._viewDomNode=e;let n=this._context.configuration.options.get(147);this._widgets={},this._verticalScrollbarWidth=n.verticalScrollbarWidth,this._minimapWidth=n.minimap.minimapWidth,this._horizontalScrollbarHeight=n.horizontalScrollbarHeight,this._editorHeight=n.height,this._editorWidth=n.width,this._viewDomNodeRect={top:0,left:0,width:0,height:0},this._domNode=Ot(document.createElement("div")),Pr.write(this._domNode,4),this._domNode.setClassName("overlayWidgets"),this.overflowingOverlayWidgetsDomNode=Ot(document.createElement("div")),Pr.write(this.overflowingOverlayWidgetsDomNode,5),this.overflowingOverlayWidgetsDomNode.setClassName("overflowingOverlayWidgets")}dispose(){super.dispose(),this._widgets={}}getDomNode(){return this._domNode}onConfigurationChanged(t){let i=this._context.configuration.options.get(147);return this._verticalScrollbarWidth=i.verticalScrollbarWidth,this._minimapWidth=i.minimap.minimapWidth,this._horizontalScrollbarHeight=i.horizontalScrollbarHeight,this._editorHeight=i.height,this._editorWidth=i.width,!0}addWidget(t){let e=Ot(t.getDomNode());this._widgets[t.getId()]={widget:t,preference:null,domNode:e},e.setPosition("absolute"),e.setAttribute("widgetId",t.getId()),t.allowEditorOverflow?this.overflowingOverlayWidgetsDomNode.appendChild(e):this._domNode.appendChild(e),this.setShouldRender(),this._updateMaxMinWidth()}setWidgetPosition(t,e){let i=this._widgets[t.getId()],n=e?e.preference:null,o=e?.stackOridinal;return i.preference===n&&i.stack===o?(this._updateMaxMinWidth(),!1):(i.preference=n,i.stack=o,this.setShouldRender(),this._updateMaxMinWidth(),!0)}removeWidget(t){let e=t.getId();if(this._widgets.hasOwnProperty(e)){let n=this._widgets[e].domNode.domNode;delete this._widgets[e],n.remove(),this.setShouldRender(),this._updateMaxMinWidth()}}_updateMaxMinWidth(){let t=0,e=Object.keys(this._widgets);for(let i=0,n=e.length;i<n;i++){let o=e[i],a=this._widgets[o].widget.getMinContentWidthInPx?.();typeof a<"u"&&(t=Math.max(t,a))}this._context.viewLayout.setOverlayWidgetsMinWidth(t)}_renderWidget(t,e){let i=t.domNode;if(t.preference===null){i.setTop("");return}let n=2*this._verticalScrollbarWidth+this._minimapWidth;if(t.preference===0||t.preference===1){if(t.preference===1){let o=i.domNode.clientHeight;i.setTop(this._editorHeight-o-2*this._horizontalScrollbarHeight)}else i.setTop(0);t.stack!==void 0?(i.setTop(e[t.preference]),e[t.preference]+=i.domNode.clientWidth):i.setRight(n)}else if(t.preference===2)i.domNode.style.right="50%",t.stack!==void 0?(i.setTop(e[2]),e[2]+=i.domNode.clientHeight):i.setTop(0);else{let{top:o,left:s}=t.preference;if(this._context.configuration.options.get(43)&&t.widget.allowEditorOverflow){let l=this._viewDomNodeRect;i.setTop(o+l.top),i.setLeft(s+l.left),i.setPosition("fixed")}else i.setTop(o),i.setLeft(s),i.setPosition("absolute")}}prepareRender(t){this._viewDomNodeRect=Oi(this._viewDomNode.domNode)}render(t){this._domNode.setWidth(this._editorWidth);let e=Object.keys(this._widgets),i=Array.from({length:3},()=>0);e.sort((n,o)=>(this._widgets[n].stack||0)-(this._widgets[o].stack||0));for(let n=0,o=e.length;n<o;n++){let s=e[n];this._renderWidget(this._widgets[s],i)}}};var a$=class{lineHeight;pixelRatio;overviewRulerLanes;renderBorder;borderColor;hideCursor;cursorColorSingle;cursorColorPrimary;cursorColorSecondary;themeType;backgroundColor;top;right;domWidth;domHeight;canvasWidth;canvasHeight;x;w;constructor(t,e){let i=t.options;this.lineHeight=i.get(68),this.pixelRatio=i.get(145),this.overviewRulerLanes=i.get(84),this.renderBorder=i.get(83);let n=e.getColor(mN);this.borderColor=n?n.toString():null,this.hideCursor=i.get(60);let o=e.getColor($C);this.cursorColorSingle=o?o.transparent(.7).toString():null;let s=e.getColor(uN);this.cursorColorPrimary=s?s.transparent(.7).toString():null;let a=e.getColor(pN);this.cursorColorSecondary=a?a.transparent(.7).toString():null,this.themeType=e.type;let l=i.get(74),d=l.enabled,c=l.side,p=e.getColor(Vre),h=Is.getDefaultBackground();p?this.backgroundColor=p:d&&c==="right"?this.backgroundColor=h:this.backgroundColor=null;let f=i.get(147).overviewRuler;this.top=f.top,this.right=f.right,this.domWidth=f.width,this.domHeight=f.height,this.overviewRulerLanes===0?(this.canvasWidth=0,this.canvasHeight=0):(this.canvasWidth=this.domWidth*this.pixelRatio|0,this.canvasHeight=this.domHeight*this.pixelRatio|0);let[g,v]=this._initLanes(1,this.canvasWidth,this.overviewRulerLanes);this.x=g,this.w=v}_initLanes(t,e,i){let n=e-t;if(i>=3){let o=Math.floor(n/3),s=Math.floor(n/3),a=n-o-s,l=t,d=l+o,c=l+o+a;return[[0,l,d,l,c,l,d,l],[0,o,a,o+a,s,o+a+s,a+s,o+a+s]]}else if(i===2){let o=Math.floor(n/2),s=n-o,a=t,l=a+o;return[[0,a,a,a,l,a,a,a],[0,o,o,o,s,o+s,o+s,o+s]]}else{let o=t,s=n;return[[0,o,o,o,o,o,o,o],[0,s,s,s,s,s,s,s]]}}equals(t){return this.lineHeight===t.lineHeight&&this.pixelRatio===t.pixelRatio&&this.overviewRulerLanes===t.overviewRulerLanes&&this.renderBorder===t.renderBorder&&this.borderColor===t.borderColor&&this.hideCursor===t.hideCursor&&this.cursorColorSingle===t.cursorColorSingle&&this.cursorColorPrimary===t.cursorColorPrimary&&this.cursorColorSecondary===t.cursorColorSecondary&&this.themeType===t.themeType&&j.equals(this.backgroundColor,t.backgroundColor)&&this.top===t.top&&this.right===t.right&&this.domWidth===t.domWidth&&this.domHeight===t.domHeight&&this.canvasWidth===t.canvasWidth&&this.canvasHeight===t.canvasHeight}};var zW=class extends Dn{_actualShouldRender=0;_tokensColorTrackerListener;_domNode;_settings;_cursorPositions;_renderedDecorations=[];_renderedCursorPositions=[];constructor(t){super(t),this._domNode=Ot(document.createElement("canvas")),this._domNode.setClassName("decorationsOverviewRuler"),this._domNode.setPosition("absolute"),this._domNode.setLayerHinting(!0),this._domNode.setContain("strict"),this._domNode.setAttribute("aria-hidden","true"),this._updateSettings(!1),this._tokensColorTrackerListener=Is.onDidChange(e=>{e.changedColorMap&&this._updateSettings(!0)}),this._cursorPositions=[{position:new H(1,1),color:this._settings.cursorColorSingle}]}dispose(){super.dispose(),this._tokensColorTrackerListener.dispose()}_updateSettings(t){let e=new a$(this._context.configuration,this._context.theme);return this._settings&&this._settings.equals(e)?!1:(this._settings=e,this._domNode.setTop(this._settings.top),this._domNode.setRight(this._settings.right),this._domNode.setWidth(this._settings.domWidth),this._domNode.setHeight(this._settings.domHeight),this._domNode.domNode.width=this._settings.canvasWidth,this._domNode.domNode.height=this._settings.canvasHeight,t&&this._render(),!0)}_markRenderingIsNeeded(){return this._actualShouldRender=2,!0}_markRenderingIsMaybeNeeded(){return this._actualShouldRender=1,!0}onConfigurationChanged(t){return this._updateSettings(!1)?this._markRenderingIsNeeded():!1}onCursorStateChanged(t){this._cursorPositions=[];for(let e=0,i=t.selections.length;e<i;e++){let n=this._settings.cursorColorSingle;i>1&&(n=e===0?this._settings.cursorColorPrimary:this._settings.cursorColorSecondary),this._cursorPositions.push({position:t.selections[e].getPosition(),color:n})}return this._cursorPositions.sort((e,i)=>H.compare(e.position,i.position)),this._markRenderingIsMaybeNeeded()}onDecorationsChanged(t){return t.affectsOverviewRuler?this._markRenderingIsMaybeNeeded():!1}onFlushed(t){return this._markRenderingIsNeeded()}onScrollChanged(t){return t.scrollHeightChanged?this._markRenderingIsNeeded():!1}onZonesChanged(t){return this._markRenderingIsNeeded()}onThemeChanged(t){return this._updateSettings(!1)?this._markRenderingIsNeeded():!1}getDomNode(){return this._domNode.domNode}prepareRender(t){}render(t){this._render(),this._actualShouldRender=0}_render(){let t=this._settings.backgroundColor;if(this._settings.overviewRulerLanes===0){this._domNode.setBackgroundColor(t?j.Format.CSS.formatHexA(t):""),this._domNode.setDisplay("none");return}let e=this._context.viewModel.getAllOverviewRulerDecorations(this._context.theme);if(e.sort(LI.compareByRenderingProps),this._actualShouldRender===1&&!LI.equalsArr(this._renderedDecorations,e)&&(this._actualShouldRender=2),this._actualShouldRender===1&&!xi(this._renderedCursorPositions,this._cursorPositions,(f,g)=>f.position.lineNumber===g.position.lineNumber&&f.color===g.color)&&(this._actualShouldRender=2),this._actualShouldRender===1)return;this._renderedDecorations=e,this._renderedCursorPositions=this._cursorPositions,this._domNode.setDisplay("block");let i=this._settings.canvasWidth,n=this._settings.canvasHeight,o=this._settings.lineHeight,s=this._context.viewLayout,a=this._context.viewLayout.getScrollHeight(),l=n/a,d=6*this._settings.pixelRatio|0,c=d/2|0,p=this._domNode.domNode.getContext("2d");t?t.isOpaque()?(p.fillStyle=j.Format.CSS.formatHexA(t),p.fillRect(0,0,i,n)):(p.clearRect(0,0,i,n),p.fillStyle=j.Format.CSS.formatHexA(t),p.fillRect(0,0,i,n)):p.clearRect(0,0,i,n);let h=this._settings.x,m=this._settings.w;for(let f of e){let g=f.color,v=f.data;p.fillStyle=g;let I=0,y=0,w=0;for(let C=0,S=v.length/3;C<S;C++){let D=v[3*C],k=v[3*C+1],M=v[3*C+2],O=s.getVerticalOffsetForLineNumber(k)*l|0,K=(s.getVerticalOffsetForLineNumber(M)+o)*l|0;if(K-O<d){let Y=(O+K)/2|0;Y<c?Y=c:Y+c>n&&(Y=n-c),O=Y-c,K=Y+c}O>w+1||D!==I?(C!==0&&p.fillRect(h[I],y,m[I],w-y),I=D,y=O,w=K):K>w&&(w=K)}p.fillRect(h[I],y,m[I],w-y)}if(!this._settings.hideCursor){let f=2*this._settings.pixelRatio|0,g=f/2|0,v=this._settings.x[7],I=this._settings.w[7],y=-100,w=-100,C=null;for(let S=0,D=this._cursorPositions.length;S<D;S++){let k=this._cursorPositions[S].color;if(!k)continue;let M=this._cursorPositions[S].position,O=s.getVerticalOffsetForLineNumber(M.lineNumber)*l|0;O<g?O=g:O+g>n&&(O=n-g);let K=O-g,G=K+f;K>w+1||k!==C?(S!==0&&C&&p.fillRect(v,y,I,w-y),y=K,w=G):G>w&&(w=G),C=k,p.fillStyle=k}C&&p.fillRect(v,y,I,w-y)}this._settings.renderBorder&&this._settings.borderColor&&this._settings.overviewRulerLanes>0&&(p.beginPath(),p.lineWidth=1,p.strokeStyle=this._settings.borderColor,p.moveTo(0,0),p.lineTo(0,n),p.moveTo(1,0),p.lineTo(i,0),p.stroke())}};var KW=class extends bc{_context;_domNode;_zoneManager;constructor(t,e){super(),this._context=t;let i=this._context.configuration.options;this._domNode=Ot(document.createElement("canvas")),this._domNode.setClassName(e),this._domNode.setPosition("absolute"),this._domNode.setLayerHinting(!0),this._domNode.setContain("strict"),this._zoneManager=new K0(n=>this._context.viewLayout.getVerticalOffsetForLineNumber(n)),this._zoneManager.setDOMWidth(0),this._zoneManager.setDOMHeight(0),this._zoneManager.setOuterHeight(this._context.viewLayout.getScrollHeight()),this._zoneManager.setLineHeight(i.get(68)),this._zoneManager.setPixelRatio(i.get(145)),this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}onConfigurationChanged(t){let e=this._context.configuration.options;return t.hasChanged(68)&&(this._zoneManager.setLineHeight(e.get(68)),this._render()),t.hasChanged(145)&&(this._zoneManager.setPixelRatio(e.get(145)),this._domNode.setWidth(this._zoneManager.getDOMWidth()),this._domNode.setHeight(this._zoneManager.getDOMHeight()),this._domNode.domNode.width=this._zoneManager.getCanvasWidth(),this._domNode.domNode.height=this._zoneManager.getCanvasHeight(),this._render()),!0}onFlushed(t){return this._render(),!0}onScrollChanged(t){return t.scrollHeightChanged&&(this._zoneManager.setOuterHeight(t.scrollHeight),this._render()),!0}onZonesChanged(t){return this._render(),!0}getDomNode(){return this._domNode.domNode}setLayout(t){this._domNode.setTop(t.top),this._domNode.setRight(t.right);let e=!1;e=this._zoneManager.setDOMWidth(t.width)||e,e=this._zoneManager.setDOMHeight(t.height)||e,e&&(this._domNode.setWidth(this._zoneManager.getDOMWidth()),this._domNode.setHeight(this._zoneManager.getDOMHeight()),this._domNode.domNode.width=this._zoneManager.getCanvasWidth(),this._domNode.domNode.height=this._zoneManager.getCanvasHeight(),this._render())}setZones(t){this._zoneManager.setZones(t),this._render()}_render(){if(this._zoneManager.getOuterHeight()===0)return!1;let t=this._zoneManager.getCanvasWidth(),e=this._zoneManager.getCanvasHeight(),i=this._zoneManager.resolveColorZones(),n=this._zoneManager.getId2Color(),o=this._domNode.domNode.getContext("2d");return o.clearRect(0,0,t,e),i.length>0&&this._renderOneLane(o,i,n,t),!0}_renderOneLane(t,e,i,n){let o=0,s=0,a=0;for(let l of e){let d=l.colorId,c=l.from,p=l.to;d!==o?(t.fillRect(0,s,n,a-s),o=d,t.fillStyle=i[o],s=c,a=p):a>=c?a=Math.max(a,p):(t.fillRect(0,s,n,a-s),s=c,a=p)}t.fillRect(0,s,n,a-s)}};var GW=class extends Dn{domNode;_renderedRulers;_rulers;_typicalHalfwidthCharacterWidth;constructor(t){super(t),this.domNode=Ot(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.domNode.setClassName("view-rulers"),this._renderedRulers=[];let e=this._context.configuration.options;this._rulers=e.get(104),this._typicalHalfwidthCharacterWidth=e.get(51).typicalHalfwidthCharacterWidth}dispose(){super.dispose()}onConfigurationChanged(t){let e=this._context.configuration.options;return this._rulers=e.get(104),this._typicalHalfwidthCharacterWidth=e.get(51).typicalHalfwidthCharacterWidth,!0}onScrollChanged(t){return t.scrollHeightChanged}prepareRender(t){}_ensureRulersCount(){let t=this._renderedRulers.length,e=this._rulers.length;if(t===e)return;if(t<e){let{tabSize:n}=this._context.viewModel.model.getOptions(),o=n,s=e-t;for(;s>0;){let a=Ot(document.createElement("div"));a.setClassName("view-ruler"),a.setWidth(o),this.domNode.appendChild(a),this._renderedRulers.push(a),s--}return}let i=t-e;for(;i>0;){let n=this._renderedRulers.pop();this.domNode.removeChild(n),i--}}render(t){this._ensureRulersCount();for(let e=0,i=this._rulers.length;e<i;e++){let n=this._renderedRulers[e],o=this._rulers[e];n.setBoxShadow(o.color?`1px 0 0 0 ${o.color} inset`:""),n.setHeight(Math.min(t.scrollHeight,1e6)),n.setLeft(o.column*this._typicalHalfwidthCharacterWidth)}}};var qW=class extends Dn{_domNode;_scrollTop;_width;_shouldShow;_useShadows;constructor(t){super(t),this._scrollTop=0,this._width=0,this._updateWidth(),this._shouldShow=!1;let i=this._context.configuration.options.get(105);this._useShadows=i.useShadows,this._domNode=Ot(document.createElement("div")),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true")}dispose(){super.dispose()}_updateShouldShow(){let t=this._useShadows&&this._scrollTop>0;return this._shouldShow!==t?(this._shouldShow=t,!0):!1}getDomNode(){return this._domNode}_updateWidth(){let e=this._context.configuration.options.get(147);e.minimap.renderMinimap===0||e.minimap.minimapWidth>0&&e.minimap.minimapLeft===0?this._width=e.width:this._width=e.width-e.verticalScrollbarWidth}onConfigurationChanged(t){let i=this._context.configuration.options.get(105);return this._useShadows=i.useShadows,this._updateWidth(),this._updateShouldShow(),!0}onScrollChanged(t){return this._scrollTop=t.scrollTop,this._updateShouldShow()}prepareRender(t){}render(t){this._domNode.setWidth(this._width),this._domNode.setClassName(this._shouldShow?"scroll-decoration":"")}};var l$=class{left;width;startStyle;endStyle;constructor(t){this.left=t.left,this.width=t.width,this.startStyle=null,this.endStyle=null}},d$=class{lineNumber;ranges;constructor(t,e){this.lineNumber=t,this.ranges=e}};function zEe(r){return new l$(r)}function KEe(r){return new d$(r.lineNumber,r.ranges.map(zEe))}var jW=class r extends Na{static SELECTION_CLASS_NAME="selected-text";static SELECTION_TOP_LEFT="top-left-radius";static SELECTION_BOTTOM_LEFT="bottom-left-radius";static SELECTION_TOP_RIGHT="top-right-radius";static SELECTION_BOTTOM_RIGHT="bottom-right-radius";static EDITOR_BACKGROUND_CLASS_NAME="monaco-editor-background";static ROUNDED_PIECE_WIDTH=10;_context;_roundedSelection;_typicalHalfwidthCharacterWidth;_selections;_renderResult;constructor(t){super(),this._context=t;let e=this._context.configuration.options;this._roundedSelection=e.get(103),this._typicalHalfwidthCharacterWidth=e.get(51).typicalHalfwidthCharacterWidth,this._selections=[],this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(t){let e=this._context.configuration.options;return this._roundedSelection=e.get(103),this._typicalHalfwidthCharacterWidth=e.get(51).typicalHalfwidthCharacterWidth,!0}onCursorStateChanged(t){return this._selections=t.selections.slice(0),!0}onDecorationsChanged(t){return!0}onFlushed(t){return!0}onLinesChanged(t){return!0}onLinesDeleted(t){return!0}onLinesInserted(t){return!0}onScrollChanged(t){return t.scrollTopChanged}onZonesChanged(t){return!0}_visibleRangesHaveGaps(t){for(let e=0,i=t.length;e<i;e++)if(t[e].ranges.length>1)return!0;return!1}_enrichVisibleRangesWithStyle(t,e,i){let n=this._typicalHalfwidthCharacterWidth/4,o=null,s=null;if(i&&i.length>0&&e.length>0){let a=e[0].lineNumber;if(a===t.startLineNumber)for(let d=0;!o&&d<i.length;d++)i[d].lineNumber===a&&(o=i[d].ranges[0]);let l=e[e.length-1].lineNumber;if(l===t.endLineNumber)for(let d=i.length-1;!s&&d>=0;d--)i[d].lineNumber===l&&(s=i[d].ranges[0]);o&&!o.startStyle&&(o=null),s&&!s.startStyle&&(s=null)}for(let a=0,l=e.length;a<l;a++){let d=e[a].ranges[0],c=d.left,p=d.left+d.width,h={top:0,bottom:0},m={top:0,bottom:0};if(a>0){let f=e[a-1].ranges[0].left,g=e[a-1].ranges[0].left+e[a-1].ranges[0].width;$W(c-f)<n?h.top=2:c>f&&(h.top=1),$W(p-g)<n?m.top=2:f<p&&p<g&&(m.top=1)}else o&&(h.top=o.startStyle.top,m.top=o.endStyle.top);if(a+1<l){let f=e[a+1].ranges[0].left,g=e[a+1].ranges[0].left+e[a+1].ranges[0].width;$W(c-f)<n?h.bottom=2:f<c&&c<g&&(h.bottom=1),$W(p-g)<n?m.bottom=2:p<g&&(m.bottom=1)}else s&&(h.bottom=s.startStyle.bottom,m.bottom=s.endStyle.bottom);d.startStyle=h,d.endStyle=m}}_getVisibleRangesWithStyle(t,e,i){let o=(e.linesVisibleRangesForRange(t,!0)||[]).map(KEe);return!this._visibleRangesHaveGaps(o)&&this._roundedSelection&&this._enrichVisibleRangesWithStyle(e.visibleRange,o,i),o}_createSelectionPiece(t,e,i,n,o){return'<div class="cslr '+i+'" style="top:'+t.toString()+"px;bottom:"+e.toString()+"px;left:"+n.toString()+"px;width:"+o.toString()+'px;"></div>'}_actualRenderOneSelection(t,e,i,n){if(n.length===0)return;let o=!!n[0].ranges[0].startStyle,s=n[0].lineNumber,a=n[n.length-1].lineNumber;for(let l=0,d=n.length;l<d;l++){let c=n[l],p=c.lineNumber,h=p-e,m=i&&p===s?1:0,f=i&&p!==s&&p===a?1:0,g="",v="";for(let I=0,y=c.ranges.length;I<y;I++){let w=c.ranges[I];if(o){let S=w.startStyle,D=w.endStyle;if(S.top===1||S.bottom===1){g+=this._createSelectionPiece(m,f,r.SELECTION_CLASS_NAME,w.left-r.ROUNDED_PIECE_WIDTH,r.ROUNDED_PIECE_WIDTH);let k=r.EDITOR_BACKGROUND_CLASS_NAME;S.top===1&&(k+=" "+r.SELECTION_TOP_RIGHT),S.bottom===1&&(k+=" "+r.SELECTION_BOTTOM_RIGHT),g+=this._createSelectionPiece(m,f,k,w.left-r.ROUNDED_PIECE_WIDTH,r.ROUNDED_PIECE_WIDTH)}if(D.top===1||D.bottom===1){g+=this._createSelectionPiece(m,f,r.SELECTION_CLASS_NAME,w.left+w.width,r.ROUNDED_PIECE_WIDTH);let k=r.EDITOR_BACKGROUND_CLASS_NAME;D.top===1&&(k+=" "+r.SELECTION_TOP_LEFT),D.bottom===1&&(k+=" "+r.SELECTION_BOTTOM_LEFT),g+=this._createSelectionPiece(m,f,k,w.left+w.width,r.ROUNDED_PIECE_WIDTH)}}let C=r.SELECTION_CLASS_NAME;if(o){let S=w.startStyle,D=w.endStyle;S.top===0&&(C+=" "+r.SELECTION_TOP_LEFT),S.bottom===0&&(C+=" "+r.SELECTION_BOTTOM_LEFT),D.top===0&&(C+=" "+r.SELECTION_TOP_RIGHT),D.bottom===0&&(C+=" "+r.SELECTION_BOTTOM_RIGHT)}v+=this._createSelectionPiece(m,f,C,w.left,w.width)}t[h][0]+=g,t[h][1]+=v}}_previousFrameVisibleRangesWithStyle=[];prepareRender(t){let e=[],i=t.visibleRange.startLineNumber,n=t.visibleRange.endLineNumber;for(let s=i;s<=n;s++){let a=s-i;e[a]=["",""]}let o=[];for(let s=0,a=this._selections.length;s<a;s++){let l=this._selections[s];if(l.isEmpty()){o[s]=null;continue}let d=this._getVisibleRangesWithStyle(l,t,this._previousFrameVisibleRangesWithStyle[s]);o[s]=d,this._actualRenderOneSelection(e,i,this._selections.length>1,d)}this._previousFrameVisibleRangesWithStyle=o,this._renderResult=e.map(([s,a])=>s+a)}render(t,e){if(!this._renderResult)return"";let i=e-t;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}};Zo((r,t)=>{let e=r.getColor(fne);e&&!e.isTransparent()&&t.addRule(`.monaco-editor .view-line span.inline-selected-text { color: ${e}; }`)});function $W(r){return r<0?-r:r}var XW=class r extends Dn{static BLINK_INTERVAL=500;_readOnly;_cursorBlinking;_cursorStyle;_cursorSmoothCaretAnimation;_selectionIsEmpty;_isComposingInput;_isVisible;_domNode;_startCursorBlinkAnimation;_cursorFlatBlinkInterval;_blinkingEnabled;_editorHasFocus;_primaryCursor;_secondaryCursors;_renderData;constructor(t){super(t);let e=this._context.configuration.options;this._readOnly=e.get(93),this._cursorBlinking=e.get(26),this._cursorStyle=e.get(28),this._cursorSmoothCaretAnimation=e.get(27),this._selectionIsEmpty=!0,this._isComposingInput=!1,this._isVisible=!1,this._primaryCursor=new cR(this._context,0),this._secondaryCursors=[],this._renderData=[],this._domNode=Ot(document.createElement("div")),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._updateDomClassName(),this._domNode.appendChild(this._primaryCursor.getDomNode()),this._startCursorBlinkAnimation=new Qs,this._cursorFlatBlinkInterval=new $S,this._blinkingEnabled=!1,this._editorHasFocus=!1,this._updateBlinking()}dispose(){super.dispose(),this._startCursorBlinkAnimation.dispose(),this._cursorFlatBlinkInterval.dispose()}getDomNode(){return this._domNode}onCompositionStart(t){return this._isComposingInput=!0,this._updateBlinking(),!0}onCompositionEnd(t){return this._isComposingInput=!1,this._updateBlinking(),!0}onConfigurationChanged(t){let e=this._context.configuration.options;this._readOnly=e.get(93),this._cursorBlinking=e.get(26),this._cursorStyle=e.get(28),this._cursorSmoothCaretAnimation=e.get(27),this._updateBlinking(),this._updateDomClassName(),this._primaryCursor.onConfigurationChanged(t);for(let i=0,n=this._secondaryCursors.length;i<n;i++)this._secondaryCursors[i].onConfigurationChanged(t);return!0}_onCursorPositionChanged(t,e,i){let n=this._secondaryCursors.length!==e.length||this._cursorSmoothCaretAnimation==="explicit"&&i!==3;if(this._primaryCursor.setPlurality(e.length?1:0),this._primaryCursor.onCursorPositionChanged(t,n),this._updateBlinking(),this._secondaryCursors.length<e.length){let o=e.length-this._secondaryCursors.length;for(let s=0;s<o;s++){let a=new cR(this._context,2);this._domNode.domNode.insertBefore(a.getDomNode().domNode,this._primaryCursor.getDomNode().domNode.nextSibling),this._secondaryCursors.push(a)}}else if(this._secondaryCursors.length>e.length){let o=this._secondaryCursors.length-e.length;for(let s=0;s<o;s++)this._domNode.removeChild(this._secondaryCursors[0].getDomNode()),this._secondaryCursors.splice(0,1)}for(let o=0;o<e.length;o++)this._secondaryCursors[o].onCursorPositionChanged(e[o],n)}onCursorStateChanged(t){let e=[];for(let n=0,o=t.selections.length;n<o;n++)e[n]=t.selections[n].getPosition();this._onCursorPositionChanged(e[0],e.slice(1),t.reason);let i=t.selections[0].isEmpty();return this._selectionIsEmpty!==i&&(this._selectionIsEmpty=i,this._updateDomClassName()),!0}onDecorationsChanged(t){return!0}onFlushed(t){return!0}onFocusChanged(t){return this._editorHasFocus=t.isFocused,this._updateBlinking(),!1}onLinesChanged(t){return!0}onLinesDeleted(t){return!0}onLinesInserted(t){return!0}onScrollChanged(t){return!0}onTokensChanged(t){let e=i=>{for(let n=0,o=t.ranges.length;n<o;n++)if(t.ranges[n].fromLineNumber<=i.lineNumber&&i.lineNumber<=t.ranges[n].toLineNumber)return!0;return!1};if(e(this._primaryCursor.getPosition()))return!0;for(let i of this._secondaryCursors)if(e(i.getPosition()))return!0;return!1}onZonesChanged(t){return!0}_getCursorBlinking(){return this._isComposingInput?0:this._editorHasFocus?this._readOnly?5:this._cursorBlinking:0}_updateBlinking(){this._startCursorBlinkAnimation.cancel(),this._cursorFlatBlinkInterval.cancel();let t=this._getCursorBlinking(),e=t===0,i=t===5;e?this._hide():this._show(),this._blinkingEnabled=!1,this._updateDomClassName(),!e&&!i&&(t===1?this._cursorFlatBlinkInterval.cancelAndSet(()=>{this._isVisible?this._hide():this._show()},r.BLINK_INTERVAL,ue(this._domNode.domNode)):this._startCursorBlinkAnimation.setIfNotSet(()=>{this._blinkingEnabled=!0,this._updateDomClassName()},r.BLINK_INTERVAL))}_updateDomClassName(){this._domNode.setClassName(this._getClassName())}_getClassName(){let t="cursors-layer";switch(this._selectionIsEmpty||(t+=" has-selection"),this._cursorStyle){case 1:t+=" cursor-line-style";break;case 2:t+=" cursor-block-style";break;case 3:t+=" cursor-underline-style";break;case 4:t+=" cursor-line-thin-style";break;case 5:t+=" cursor-block-outline-style";break;case 6:t+=" cursor-underline-thin-style";break;default:t+=" cursor-line-style"}if(this._blinkingEnabled)switch(this._getCursorBlinking()){case 1:t+=" cursor-blink";break;case 2:t+=" cursor-smooth";break;case 3:t+=" cursor-phase";break;case 4:t+=" cursor-expand";break;case 5:t+=" cursor-solid";break;default:t+=" cursor-solid"}else t+=" cursor-solid";return(this._cursorSmoothCaretAnimation==="on"||this._cursorSmoothCaretAnimation==="explicit")&&(t+=" cursor-smooth-caret-animation"),t}_show(){this._primaryCursor.show();for(let t=0,e=this._secondaryCursors.length;t<e;t++)this._secondaryCursors[t].show();this._isVisible=!0}_hide(){this._primaryCursor.hide();for(let t=0,e=this._secondaryCursors.length;t<e;t++)this._secondaryCursors[t].hide();this._isVisible=!1}prepareRender(t){this._primaryCursor.prepareRender(t);for(let e=0,i=this._secondaryCursors.length;e<i;e++)this._secondaryCursors[e].prepareRender(t)}render(t){let e=[],i=0,n=this._primaryCursor.render(t);n&&(e[i++]=n);for(let o=0,s=this._secondaryCursors.length;o<s;o++){let a=this._secondaryCursors[o].render(t);a&&(e[i++]=a)}this._renderData=e}getLastRenderData(){return this._renderData}};Zo((r,t)=>{let e=[{class:".cursor",foreground:$C,background:cN},{class:".cursor-primary",foreground:uN,background:wre},{class:".cursor-secondary",foreground:pN,background:Ere}];for(let i of e){let n=r.getColor(i.foreground);if(n){let o=r.getColor(i.background);o||(o=n.opposite()),t.addRule(`.monaco-editor .cursors-layer ${i.class} { background-color: ${n}; border-color: ${n}; color: ${o}; }`),oa(r.type)&&t.addRule(`.monaco-editor .cursors-layer.has-selection ${i.class} { border-left: 1px solid ${o}; border-right: 1px solid ${o}; }`)}}});var c$=()=>{throw new Error("Invalid change accessor")},YW=class extends Dn{_zones;_lineHeight;_contentWidth;_contentLeft;domNode;marginDomNode;constructor(t){super(t);let e=this._context.configuration.options,i=e.get(147);this._lineHeight=e.get(68),this._contentWidth=i.contentWidth,this._contentLeft=i.contentLeft,this.domNode=Ot(document.createElement("div")),this.domNode.setClassName("view-zones"),this.domNode.setPosition("absolute"),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.marginDomNode=Ot(document.createElement("div")),this.marginDomNode.setClassName("margin-view-zones"),this.marginDomNode.setPosition("absolute"),this.marginDomNode.setAttribute("role","presentation"),this.marginDomNode.setAttribute("aria-hidden","true"),this._zones={}}dispose(){super.dispose(),this._zones={}}_recomputeWhitespacesProps(){let t=this._context.viewLayout.getWhitespaces(),e=new Map;for(let n of t)e.set(n.id,n);let i=!1;return this._context.viewModel.changeWhitespace(n=>{let o=Object.keys(this._zones);for(let s=0,a=o.length;s<a;s++){let l=o[s],d=this._zones[l],c=this._computeWhitespaceProps(d.delegate);d.isInHiddenArea=c.isInHiddenArea;let p=e.get(l);p&&(p.afterLineNumber!==c.afterViewLineNumber||p.height!==c.heightInPx)&&(n.changeOneWhitespace(l,c.afterViewLineNumber,c.heightInPx),this._safeCallOnComputedHeight(d.delegate,c.heightInPx),i=!0)}}),i}onConfigurationChanged(t){let e=this._context.configuration.options,i=e.get(147);return this._lineHeight=e.get(68),this._contentWidth=i.contentWidth,this._contentLeft=i.contentLeft,t.hasChanged(68)&&this._recomputeWhitespacesProps(),!0}onLineMappingChanged(t){return this._recomputeWhitespacesProps()}onLinesDeleted(t){return!0}onScrollChanged(t){return t.scrollTopChanged||t.scrollWidthChanged}onZonesChanged(t){return!0}onLinesInserted(t){return!0}_getZoneOrdinal(t){return t.ordinal??t.afterColumn??1e4}_computeWhitespaceProps(t){if(t.afterLineNumber===0)return{isInHiddenArea:!1,afterViewLineNumber:0,heightInPx:this._heightInPixels(t),minWidthInPx:this._minWidthInPixels(t)};let e;if(typeof t.afterColumn<"u")e=this._context.viewModel.model.validatePosition({lineNumber:t.afterLineNumber,column:t.afterColumn});else{let s=this._context.viewModel.model.validatePosition({lineNumber:t.afterLineNumber,column:1}).lineNumber;e=new H(s,this._context.viewModel.model.getLineMaxColumn(s))}let i;e.column===this._context.viewModel.model.getLineMaxColumn(e.lineNumber)?i=this._context.viewModel.model.validatePosition({lineNumber:e.lineNumber+1,column:1}):i=this._context.viewModel.model.validatePosition({lineNumber:e.lineNumber,column:e.column+1});let n=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(e,t.afterColumnAffinity,!0),o=t.showInHiddenAreas||this._context.viewModel.coordinatesConverter.modelPositionIsVisible(i);return{isInHiddenArea:!o,afterViewLineNumber:n.lineNumber,heightInPx:o?this._heightInPixels(t):0,minWidthInPx:this._minWidthInPixels(t)}}changeViewZones(t){let e=!1;return this._context.viewModel.changeWhitespace(i=>{let n={addZone:o=>(e=!0,this._addZone(i,o)),removeZone:o=>{o&&(e=this._removeZone(i,o)||e)},layoutZone:o=>{o&&(e=this._layoutZone(i,o)||e)}};GEe(t,n),n.addZone=c$,n.removeZone=c$,n.layoutZone=c$}),e}_addZone(t,e){let i=this._computeWhitespaceProps(e),o={whitespaceId:t.insertWhitespace(i.afterViewLineNumber,this._getZoneOrdinal(e),i.heightInPx,i.minWidthInPx),delegate:e,isInHiddenArea:i.isInHiddenArea,isVisible:!1,domNode:Ot(e.domNode),marginDomNode:e.marginDomNode?Ot(e.marginDomNode):null};return this._safeCallOnComputedHeight(o.delegate,i.heightInPx),o.domNode.setPosition("absolute"),o.domNode.domNode.style.width="100%",o.domNode.setDisplay("none"),o.domNode.setAttribute("monaco-view-zone",o.whitespaceId),this.domNode.appendChild(o.domNode),o.marginDomNode&&(o.marginDomNode.setPosition("absolute"),o.marginDomNode.domNode.style.width="100%",o.marginDomNode.setDisplay("none"),o.marginDomNode.setAttribute("monaco-view-zone",o.whitespaceId),this.marginDomNode.appendChild(o.marginDomNode)),this._zones[o.whitespaceId]=o,this.setShouldRender(),o.whitespaceId}_removeZone(t,e){if(this._zones.hasOwnProperty(e)){let i=this._zones[e];return delete this._zones[e],t.removeWhitespace(i.whitespaceId),i.domNode.removeAttribute("monaco-visible-view-zone"),i.domNode.removeAttribute("monaco-view-zone"),i.domNode.domNode.remove(),i.marginDomNode&&(i.marginDomNode.removeAttribute("monaco-visible-view-zone"),i.marginDomNode.removeAttribute("monaco-view-zone"),i.marginDomNode.domNode.remove()),this.setShouldRender(),!0}return!1}_layoutZone(t,e){if(this._zones.hasOwnProperty(e)){let i=this._zones[e],n=this._computeWhitespaceProps(i.delegate);return i.isInHiddenArea=n.isInHiddenArea,t.changeOneWhitespace(i.whitespaceId,n.afterViewLineNumber,n.heightInPx),this._safeCallOnComputedHeight(i.delegate,n.heightInPx),this.setShouldRender(),!0}return!1}shouldSuppressMouseDownOnViewZone(t){return this._zones.hasOwnProperty(t)?!!this._zones[t].delegate.suppressMouseDown:!1}_heightInPixels(t){return typeof t.heightInPx=="number"?t.heightInPx:typeof t.heightInLines=="number"?this._lineHeight*t.heightInLines:this._lineHeight}_minWidthInPixels(t){return typeof t.minWidthInPx=="number"?t.minWidthInPx:0}_safeCallOnComputedHeight(t,e){if(typeof t.onComputedHeight=="function")try{t.onComputedHeight(e)}catch(i){Xe(i)}}_safeCallOnDomNodeTop(t,e){if(typeof t.onDomNodeTop=="function")try{t.onDomNodeTop(e)}catch(i){Xe(i)}}prepareRender(t){}render(t){let e=t.viewportData.whitespaceViewportData,i={},n=!1;for(let s of e)this._zones[s.id].isInHiddenArea||(i[s.id]=s,n=!0);let o=Object.keys(this._zones);for(let s=0,a=o.length;s<a;s++){let l=o[s],d=this._zones[l],c=0,p=0,h="none";i.hasOwnProperty(l)?(c=i[l].verticalOffset-t.bigNumbersDelta,p=i[l].height,h="block",d.isVisible||(d.domNode.setAttribute("monaco-visible-view-zone","true"),d.isVisible=!0),this._safeCallOnDomNodeTop(d.delegate,t.getScrolledTopFromAbsoluteTop(i[l].verticalOffset))):(d.isVisible&&(d.domNode.removeAttribute("monaco-visible-view-zone"),d.isVisible=!1),this._safeCallOnDomNodeTop(d.delegate,t.getScrolledTopFromAbsoluteTop(-1e6))),d.domNode.setTop(c),d.domNode.setHeight(p),d.domNode.setDisplay(h),d.marginDomNode&&(d.marginDomNode.setTop(c),d.marginDomNode.setHeight(p),d.marginDomNode.setDisplay(h))}n&&(this.domNode.setWidth(Math.max(t.scrollWidth,this._contentWidth)),this.marginDomNode.setWidth(this._contentLeft))}};function GEe(r,t){try{return r(t)}catch(e){Xe(e)}}var QW=class extends Na{_context;_options;_selection;_renderResult;constructor(t){super(),this._context=t,this._options=new ZW(this._context.configuration),this._selection=[],this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(t){let e=new ZW(this._context.configuration);return this._options.equals(e)?t.hasChanged(147):(this._options=e,!0)}onCursorStateChanged(t){return this._selection=t.selections,this._options.renderWhitespace==="selection"}onDecorationsChanged(t){return!0}onFlushed(t){return!0}onLinesChanged(t){return!0}onLinesDeleted(t){return!0}onLinesInserted(t){return!0}onScrollChanged(t){return t.scrollTopChanged}onZonesChanged(t){return!0}prepareRender(t){if(this._options.renderWhitespace==="none"){this._renderResult=null;return}let e=t.visibleRange.startLineNumber,n=t.visibleRange.endLineNumber-e+1,o=new Array(n);for(let a=0;a<n;a++)o[a]=!0;let s=this._context.viewModel.getMinimapLinesRenderingData(t.viewportData.startLineNumber,t.viewportData.endLineNumber,o);this._renderResult=[];for(let a=t.viewportData.startLineNumber;a<=t.viewportData.endLineNumber;a++){let l=a-t.viewportData.startLineNumber,d=s.data[l],c=null;if(this._options.renderWhitespace==="selection"){let p=this._selection;for(let h of p){if(h.endLineNumber<a||h.startLineNumber>a)continue;let m=h.startLineNumber===a?h.startColumn:d.minColumn,f=h.endLineNumber===a?h.endColumn:d.maxColumn;m<f&&(c||(c=[]),c.push(new RE(m-1,f-1)))}}this._renderResult[l]=this._applyRenderWhitespace(t,a,c,d)}}_applyRenderWhitespace(t,e,i,n){if(this._options.renderWhitespace==="selection"&&!i||this._options.renderWhitespace==="trailing"&&n.continuesWithWrappedLine)return"";let o=this._context.theme.getColor(hN),s=this._options.renderWithSVG,a=n.content,l=this._options.stopRenderingLineAfter===-1?a.length:Math.min(this._options.stopRenderingLineAfter,a.length),d=n.continuesWithWrappedLine,c=n.minColumn-1,p=this._options.renderWhitespace==="boundary",h=this._options.renderWhitespace==="trailing",m=this._options.lineHeight,f=this._options.middotWidth,g=this._options.wsmiddotWidth,v=this._options.spaceWidth,I=Math.abs(g-v),y=Math.abs(f-v),w=I<y?11825:183,C=this._options.canUseHalfwidthRightwardsArrow,S="",D=!1,k=Jn(a),M;k===-1?(D=!0,k=l,M=l):M=fd(a);let O=0,K=i&&i[O],G=0;for(let Y=c;Y<l;Y++){let ge=a.charCodeAt(Y);if(K&&Y>=K.endOffset&&(O++,K=i&&i[O]),ge!==9&&ge!==32||h&&!D&&Y<=M)continue;if(p&&Y>=k&&Y<=M&&ge===32){let be=Y-1>=0?a.charCodeAt(Y-1):0,fe=Y+1<l?a.charCodeAt(Y+1):0;if(be!==32&&fe!==32)continue}if(p&&d&&Y===l-1){let be=Y-1>=0?a.charCodeAt(Y-1):0;if(ge===32&&be!==32&&be!==9)continue}if(i&&(!K||K.startOffset>Y||K.endOffset<=Y))continue;let xe=t.visibleRangeForPosition(new H(e,Y+1));xe&&(s?(G=Math.max(G,xe.left),ge===9?S+=this._renderArrow(m,v,xe.left):S+=`<circle cx="${(xe.left+v/2).toFixed(2)}" cy="${(m/2).toFixed(2)}" r="${(v/7).toFixed(2)}" />`):ge===9?S+=`<div class="mwh" style="left:${xe.left}px;height:${m}px;">${C?"\uFFEB":"\u2192"}</div>`:S+=`<div class="mwh" style="left:${xe.left}px;height:${m}px;">${String.fromCharCode(w)}</div>`)}return s?(G=Math.round(G+v),`<svg style="bottom:0;position:absolute;width:${G}px;height:${m}px" viewBox="0 0 ${G} ${m}" xmlns="http://www.w3.org/2000/svg" fill="${o}">`+S+"</svg>"):S}_renderArrow(t,e,i){let n=e/7,o=e,s=t/2,a=i,l={x:0,y:n/2},d={x:100/125*o,y:l.y},c={x:d.x-.2*d.x,y:d.y+.2*d.x},p={x:c.x+.1*d.x,y:c.y+.1*d.x},h={x:p.x+.35*d.x,y:p.y-.35*d.x},m={x:h.x,y:-h.y},f={x:p.x,y:-p.y},g={x:c.x,y:-c.y},v={x:d.x,y:-d.y},I={x:l.x,y:-l.y};return`<path d="M ${[l,d,c,p,h,m,f,g,v,I].map(C=>`${(a+C.x).toFixed(2)} ${(s+C.y).toFixed(2)}`).join(" L ")}" />`}render(t,e){if(!this._renderResult)return"";let i=e-t;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}},ZW=class{renderWhitespace;renderWithSVG;spaceWidth;middotWidth;wsmiddotWidth;canUseHalfwidthRightwardsArrow;lineHeight;stopRenderingLineAfter;constructor(t){let e=t.options,i=e.get(51),n=e.get(39);n==="off"?(this.renderWhitespace="none",this.renderWithSVG=!1):n==="svg"?(this.renderWhitespace=e.get(101),this.renderWithSVG=!0):(this.renderWhitespace=e.get(101),this.renderWithSVG=!1),this.spaceWidth=i.spaceWidth,this.middotWidth=i.middotWidth,this.wsmiddotWidth=i.wsmiddotWidth,this.canUseHalfwidthRightwardsArrow=i.canUseHalfwidthRightwardsArrow,this.lineHeight=e.get(68),this.stopRenderingLineAfter=e.get(119)}equals(t){return this.renderWhitespace===t.renderWhitespace&&this.renderWithSVG===t.renderWithSVG&&this.spaceWidth===t.spaceWidth&&this.middotWidth===t.middotWidth&&this.wsmiddotWidth===t.wsmiddotWidth&&this.canUseHalfwidthRightwardsArrow===t.canUseHalfwidthRightwardsArrow&&this.lineHeight===t.lineHeight&&this.stopRenderingLineAfter===t.stopRenderingLineAfter}};var JE=class extends Dn{};var u$=class{_onDidChange=new x;onDidChange=this._onDidChange.event;_enabled=!0;get enabled(){return this._enabled}enable(){this._enabled=!0,this._onDidChange.fire()}disable(){this._enabled=!1,this._onDidChange.fire()}},p$=new u$;var m$=class{constructor(t,e,i,n,o){this._context=t;this.modelLineNumber=e;this.distanceToModelLineStart=i;this.widthOfHiddenLineTextBefore=n;this.distanceToModelLineEnd=o}_visibleTextAreaBrand=void 0;startPosition=null;endPosition=null;visibleTextareaStart=null;visibleTextareaEnd=null;_previousPresentation=null;prepareRender(t){let e=new H(this.modelLineNumber,this.distanceToModelLineStart+1),i=new H(this.modelLineNumber,this._context.viewModel.model.getLineMaxColumn(this.modelLineNumber)-this.distanceToModelLineEnd);this.startPosition=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(e),this.endPosition=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(i),this.startPosition.lineNumber===this.endPosition.lineNumber?(this.visibleTextareaStart=t.visibleRangeForPosition(this.startPosition),this.visibleTextareaEnd=t.visibleRangeForPosition(this.endPosition)):(this.visibleTextareaStart=null,this.visibleTextareaEnd=null)}definePresentation(t){return this._previousPresentation||(t?this._previousPresentation=t:this._previousPresentation={foreground:1,italic:!1,bold:!1,underline:!1,strikethrough:!1}),this._previousPresentation}},h$=po,ex=class extends JE{constructor(e,i,n,o,s){super(e);this._keybindingService=o;this._instantiationService=s;this._viewController=i,this._visibleRangeProvider=n,this._scrollLeft=0,this._scrollTop=0;let a=this._context.configuration.options,l=a.get(147);this._setAccessibilityOptions(a),this._contentLeft=l.contentLeft,this._contentWidth=l.contentWidth,this._contentHeight=l.height,this._fontInfo=a.get(51),this._lineHeight=a.get(68),this._emptySelectionClipboard=a.get(38),this._copyWithSyntaxHighlighting=a.get(25),this._visibleTextArea=null,this._selections=[new Et(1,1,1,1)],this._modelSelections=[new Et(1,1,1,1)],this._lastRenderPosition=null,this.textArea=Ot(document.createElement("textarea")),Pr.write(this.textArea,7),this.textArea.setClassName(`inputarea ${Nu}`),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off");let{tabSize:d}=this._context.viewModel.model.getOptions();this.textArea.domNode.style.tabSize=`${d*this._fontInfo.spaceWidth}px`,this.textArea.setAttribute("autocorrect","off"),this.textArea.setAttribute("autocapitalize","off"),this.textArea.setAttribute("autocomplete","off"),this.textArea.setAttribute("spellcheck","false"),this.textArea.setAttribute("aria-label",bR(a,this._keybindingService)),this.textArea.setAttribute("aria-required",a.get(5)?"true":"false"),this.textArea.setAttribute("tabindex",String(a.get(126))),this.textArea.setAttribute("role","textbox"),this.textArea.setAttribute("aria-roledescription",u("editor","editor")),this.textArea.setAttribute("aria-multiline","true"),this.textArea.setAttribute("aria-autocomplete",a.get(93)?"none":"both"),this._ensureReadOnlyAttribute(),this.textAreaCover=Ot(document.createElement("div")),this.textAreaCover.setPosition("absolute");let c={getLineCount:()=>this._context.viewModel.getLineCount(),getLineMaxColumn:m=>this._context.viewModel.getLineMaxColumn(m),getValueInRange:(m,f)=>this._context.viewModel.getValueInRange(m,f),getValueLengthInRange:(m,f)=>this._context.viewModel.getValueLengthInRange(m,f),modifyPosition:(m,f)=>this._context.viewModel.modifyPosition(m,f)},p={getDataToCopy:()=>gW(this._context.viewModel,this._modelSelections,this._emptySelectionClipboard,this._copyWithSyntaxHighlighting),getScreenReaderContent:()=>{if(this._accessibilitySupport===1){let f=this._selections[0];if(ye&&f.isEmpty()){let v=f.getStartPosition(),I=this._getWordBeforePosition(v);if(I.length===0&&(I=this._getCharacterBeforePosition(v)),I.length>0)return new Nr(I,I.length,I.length,L.fromPositions(v),0)}if(ye&&!f.isEmpty()&&c.getValueLengthInRange(f,0)<500){let v=c.getValueInRange(f,0);return new Nr(v,0,v.length,f,0)}if(ms&&!f.isEmpty()){let v="vscode-placeholder";return new Nr(v,0,v.length,null,void 0)}return Nr.EMPTY}if(E4){let f=this._selections[0];if(f.isEmpty()){let g=f.getStartPosition(),[v,I]=this._getAndroidWordAtPosition(g);if(v.length>0)return new Nr(v,I,I,L.fromPositions(g),0)}return Nr.EMPTY}let m=qE.fromEditorSelection(c,this._selections[0],this._accessibilityPageSize,this._accessibilitySupport===0);return Nr.fromScreenReaderContentState(m)},deduceModelPosition:(m,f,g)=>this._context.viewModel.deduceModelPositionRelativeToViewPosition(m,f,g)},h=this._register(new fW(this.textArea.domNode));this._textAreaInput=this._register(this._instantiationService.createInstance($E,p,h,Ys,{isAndroid:E4,isChrome:nf,isFirefox:po,isSafari:ms})),this._register(this._textAreaInput.onKeyDown(m=>{this._viewController.emitKeyDown(m)})),this._register(this._textAreaInput.onKeyUp(m=>{this._viewController.emitKeyUp(m)})),this._register(this._textAreaInput.onPaste(m=>{let f=!1,g=null,v=null;m.metadata&&(f=this._emptySelectionClipboard&&!!m.metadata.isFromEmptySelection,g=typeof m.metadata.multicursorText<"u"?m.metadata.multicursorText:null,v=m.metadata.mode),this._viewController.paste(m.text,f,g,v)})),this._register(this._textAreaInput.onCut(()=>{this._viewController.cut()})),this._register(this._textAreaInput.onType(m=>{m.replacePrevCharCnt||m.replaceNextCharCnt||m.positionDelta?(hl&&console.log(` => compositionType: <<${m.text}>>, ${m.replacePrevCharCnt}, ${m.replaceNextCharCnt}, ${m.positionDelta}`),this._viewController.compositionType(m.text,m.replacePrevCharCnt,m.replaceNextCharCnt,m.positionDelta)):(hl&&console.log(` => type: <<${m.text}>>`),this._viewController.type(m.text))})),this._register(this._textAreaInput.onSelectionChangeRequest(m=>{this._viewController.setSelection(m)})),this._register(this._textAreaInput.onCompositionStart(m=>{let f=this.textArea.domNode,g=this._modelSelections[0],{distanceToModelLineStart:v,widthOfHiddenTextBefore:I}=(()=>{let w=f.value.substring(0,Math.min(f.selectionStart,f.selectionEnd)),C=w.lastIndexOf(`
`),S=w.substring(C+1),D=S.lastIndexOf("	"),k=S.length-D-1,M=g.getStartPosition(),O=Math.min(M.column-1,k),K=M.column-1-O,G=S.substring(0,S.length-O),{tabSize:Y}=this._context.viewModel.model.getOptions(),ge=qEe(this.textArea.domNode.ownerDocument,G,this._fontInfo,Y);return{distanceToModelLineStart:K,widthOfHiddenTextBefore:ge}})(),{distanceToModelLineEnd:y}=(()=>{let w=f.value.substring(Math.max(f.selectionStart,f.selectionEnd)),C=w.indexOf(`
`),S=C===-1?w:w.substring(0,C),D=S.indexOf("	"),k=D===-1?S.length:S.length-D-1,M=g.getEndPosition(),O=Math.min(this._context.viewModel.model.getLineMaxColumn(M.lineNumber)-M.column,k);return{distanceToModelLineEnd:this._context.viewModel.model.getLineMaxColumn(M.lineNumber)-M.column-O}})();this._context.viewModel.revealRange("keyboard",!0,L.fromPositions(this._selections[0].getStartPosition()),0,1),this._visibleTextArea=new m$(this._context,g.startLineNumber,v,I,y),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off"),this._visibleTextArea.prepareRender(this._visibleRangeProvider),this._render(),this.textArea.setClassName(`inputarea ${Nu} ime-input`),this._viewController.compositionStart(),this._context.viewModel.onCompositionStart()})),this._register(this._textAreaInput.onCompositionUpdate(m=>{this._visibleTextArea&&(this._visibleTextArea.prepareRender(this._visibleRangeProvider),this._render())})),this._register(this._textAreaInput.onCompositionEnd(()=>{this._visibleTextArea=null,this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off"),this._render(),this.textArea.setClassName(`inputarea ${Nu}`),this._viewController.compositionEnd(),this._context.viewModel.onCompositionEnd()})),this._register(this._textAreaInput.onFocus(()=>{this._context.viewModel.setHasFocus(!0)})),this._register(this._textAreaInput.onBlur(()=>{this._context.viewModel.setHasFocus(!1)})),this._register(p$.onDidChange(()=>{this._ensureReadOnlyAttribute()}))}_viewController;_visibleRangeProvider;_scrollLeft;_scrollTop;_accessibilitySupport;_accessibilityPageSize;_textAreaWrapping;_textAreaWidth;_contentLeft;_contentWidth;_contentHeight;_fontInfo;_lineHeight;_emptySelectionClipboard;_copyWithSyntaxHighlighting;_visibleTextArea;_selections;_modelSelections;_lastRenderPosition;textArea;textAreaCover;_textAreaInput;get domNode(){return this.textArea}appendTo(e){e.appendChild(this.textArea),e.appendChild(this.textAreaCover)}writeScreenReaderContent(e){this._textAreaInput.writeNativeTextAreaContent(e)}dispose(){super.dispose(),this.textArea.domNode.remove(),this.textAreaCover.domNode.remove()}_getAndroidWordAtPosition(e){let i='`~!@#$%^&*()-=+[{]}\\|;:",.<>/?',n=this._context.viewModel.getLineContent(e.lineNumber),o=Ap(i,[]),s=!0,a=e.column,l=!0,d=e.column,c=0;for(;c<50&&(s||l);){if(s&&a<=1&&(s=!1),s){let p=n.charCodeAt(a-2);o.get(p)!==0?s=!1:a--}if(l&&d>n.length&&(l=!1),l){let p=n.charCodeAt(d-1);o.get(p)!==0?l=!1:d++}c++}return[n.substring(a-1,d-1),e.column-a]}_getWordBeforePosition(e){let i=this._context.viewModel.getLineContent(e.lineNumber),n=Ap(this._context.configuration.options.get(133),[]),o=e.column,s=0;for(;o>1;){let a=i.charCodeAt(o-2);if(n.get(a)!==0||s>50)return i.substring(o-1,e.column-1);s++,o--}return i.substring(0,e.column-1)}_getCharacterBeforePosition(e){if(e.column>1){let n=this._context.viewModel.getLineContent(e.lineNumber).charAt(e.column-2);if(!Rn(n.charCodeAt(0)))return n}return""}_setAccessibilityOptions(e){this._accessibilitySupport=e.get(2);let i=e.get(3);this._accessibilitySupport===2&&i===uc.accessibilityPageSize.defaultValue?this._accessibilityPageSize=500:this._accessibilityPageSize=i;let o=e.get(147).wrappingColumn;if(o!==-1&&this._accessibilitySupport!==1){let s=e.get(51);this._textAreaWrapping=!0,this._textAreaWidth=Math.round(o*s.typicalHalfwidthCharacterWidth)}else this._textAreaWrapping=!1,this._textAreaWidth=h$?0:1}onConfigurationChanged(e){let i=this._context.configuration.options,n=i.get(147);this._setAccessibilityOptions(i),this._contentLeft=n.contentLeft,this._contentWidth=n.contentWidth,this._contentHeight=n.height,this._fontInfo=i.get(51),this._lineHeight=i.get(68),this._emptySelectionClipboard=i.get(38),this._copyWithSyntaxHighlighting=i.get(25),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off");let{tabSize:o}=this._context.viewModel.model.getOptions();return this.textArea.domNode.style.tabSize=`${o*this._fontInfo.spaceWidth}px`,this.textArea.setAttribute("aria-label",bR(i,this._keybindingService)),this.textArea.setAttribute("aria-required",i.get(5)?"true":"false"),this.textArea.setAttribute("tabindex",String(i.get(126))),(e.hasChanged(34)||e.hasChanged(93))&&this._ensureReadOnlyAttribute(),e.hasChanged(2)&&this._textAreaInput.writeNativeTextAreaContent("strategy changed"),!0}onCursorStateChanged(e){return this._selections=e.selections.slice(0),this._modelSelections=e.modelSelections.slice(0),this._textAreaInput.writeNativeTextAreaContent("selection changed"),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return this._scrollLeft=e.scrollLeft,this._scrollTop=e.scrollTop,!0}onZonesChanged(e){return!0}isFocused(){return this._textAreaInput.isFocused()}focus(){this._textAreaInput.focusTextArea()}refreshFocusState(){this._textAreaInput.refreshFocusState()}getLastRenderData(){return this._lastRenderPosition}setAriaOptions(e){e.activeDescendant?(this.textArea.setAttribute("aria-haspopup","true"),this.textArea.setAttribute("aria-autocomplete","list"),this.textArea.setAttribute("aria-activedescendant",e.activeDescendant)):(this.textArea.setAttribute("aria-haspopup","false"),this.textArea.setAttribute("aria-autocomplete","both"),this.textArea.removeAttribute("aria-activedescendant")),e.role&&this.textArea.setAttribute("role",e.role)}_ensureReadOnlyAttribute(){let e=this._context.configuration.options;!p$.enabled||e.get(34)&&e.get(93)?this.textArea.setAttribute("readonly","true"):this.textArea.removeAttribute("readonly")}_primaryCursorPosition=new H(1,1);_primaryCursorVisibleRange=null;prepareRender(e){this._primaryCursorPosition=new H(this._selections[0].positionLineNumber,this._selections[0].positionColumn),this._primaryCursorVisibleRange=e.visibleRangeForPosition(this._primaryCursorPosition),this._visibleTextArea?.prepareRender(e)}render(e){this._textAreaInput.writeNativeTextAreaContent("render"),this._render()}_render(){if(this._visibleTextArea){let n=this._visibleTextArea.visibleTextareaStart,o=this._visibleTextArea.visibleTextareaEnd,s=this._visibleTextArea.startPosition,a=this._visibleTextArea.endPosition;if(s&&a&&n&&o&&o.left>=this._scrollLeft&&n.left<=this._scrollLeft+this._contentWidth){let l=this._context.viewLayout.getVerticalOffsetForLineNumber(this._primaryCursorPosition.lineNumber)-this._scrollTop,d=vR(this.textArea.domNode.value.substr(0,this.textArea.domNode.selectionStart)),c=this._visibleTextArea.widthOfHiddenLineTextBefore,p=this._contentLeft+n.left-this._scrollLeft,h=o.left-n.left+1;if(p<this._contentLeft){let y=this._contentLeft-p;p+=y,c+=y,h-=y}h>this._contentWidth&&(h=this._contentWidth);let m=this._context.viewModel.getViewLineData(s.lineNumber),f=m.tokens.findTokenIndexAtOffset(s.column-1),g=m.tokens.findTokenIndexAtOffset(a.column-1),v=f===g,I=this._visibleTextArea.definePresentation(v?m.tokens.getPresentation(f):null);this.textArea.domNode.scrollTop=d*this._lineHeight,this.textArea.domNode.scrollLeft=c,this._doRender({lastRenderPosition:null,top:l,left:p,width:h,height:this._lineHeight,useCover:!1,color:(Is.getColorMap()||[])[I.foreground],italic:I.italic,bold:I.bold,underline:I.underline,strikethrough:I.strikethrough})}return}if(!this._primaryCursorVisibleRange){this._renderAtTopLeft();return}let e=this._contentLeft+this._primaryCursorVisibleRange.left-this._scrollLeft;if(e<this._contentLeft||e>this._contentLeft+this._contentWidth){this._renderAtTopLeft();return}let i=this._context.viewLayout.getVerticalOffsetForLineNumber(this._selections[0].positionLineNumber)-this._scrollTop;if(i<0||i>this._contentHeight){this._renderAtTopLeft();return}if(ye||this._accessibilitySupport===2){this._doRender({lastRenderPosition:this._primaryCursorPosition,top:i,left:this._textAreaWrapping?this._contentLeft:e,width:this._textAreaWidth,height:this._lineHeight,useCover:!1}),this.textArea.domNode.scrollLeft=this._primaryCursorVisibleRange.left;let n=this._textAreaInput.textAreaState.newlineCountBeforeSelection??vR(this.textArea.domNode.value.substring(0,this.textArea.domNode.selectionStart));this.textArea.domNode.scrollTop=n*this._lineHeight;return}this._doRender({lastRenderPosition:this._primaryCursorPosition,top:i,left:this._textAreaWrapping?this._contentLeft:e,width:this._textAreaWidth,height:h$?0:1,useCover:!1})}_renderAtTopLeft(){this._doRender({lastRenderPosition:null,top:0,left:0,width:this._textAreaWidth,height:h$?0:1,useCover:!0})}_doRender(e){this._lastRenderPosition=e.lastRenderPosition;let i=this.textArea,n=this.textAreaCover;hn(i,this._fontInfo),i.setTop(e.top),i.setLeft(e.left),i.setWidth(e.width),i.setHeight(e.height),i.setColor(e.color?j.Format.CSS.formatHex(e.color):""),i.setFontStyle(e.italic?"italic":""),e.bold&&i.setFontWeight("bold"),i.setTextDecoration(`${e.underline?" underline":""}${e.strikethrough?" line-through":""}`),n.setTop(e.useCover?e.top:0),n.setLeft(e.useCover?e.left:0),n.setWidth(e.useCover?e.width:0),n.setHeight(e.useCover?e.height:0);let o=this._context.configuration.options;o.get(58)?n.setClassName("monaco-editor-background textAreaCover "+QE.OUTER_CLASS_NAME):o.get(69).renderType!==0?n.setClassName("monaco-editor-background textAreaCover "+YE.CLASS_NAME):n.setClassName("monaco-editor-background textAreaCover")}};ex=E([b(3,Be),b(4,ne)],ex);function qEe(r,t,e,i){if(t.length===0)return 0;let n=r.createElement("div");n.style.position="absolute",n.style.top="-50000px",n.style.width="50000px";let o=r.createElement("span");hn(o,e),o.style.whiteSpace="pre",o.style.tabSize=`${i*e.spaceWidth}px`,o.append(t),n.appendChild(o),r.body.appendChild(n);let s=o.offsetWidth;return n.remove(),s}var rs=q("clipboardService");var JW=class extends R{constructor(e,i){super();this._domNode=e;this._onFocusChange=i;this._register(F(this._domNode,"focus",()=>this._handleFocusedChanged(!0))),this._register(F(this._domNode,"blur",()=>this._handleFocusedChanged(!1)))}_isFocused=!1;_handleFocusedChanged(e){this._isFocused!==e&&(this._isFocused=e,this._onFocusChange(this._isFocused))}focus(){this._domNode.focus()}get isFocused(){return this._isFocused}};function tx(r,t,e,i){return r.addEventListener(t,e,i),{dispose(){r.removeEventListener(t,e)}}}var ix=class{constructor(t,e,i){this._domNode=t;this._context=e;this._keybindingService=i;this._updateConfigurationSettings(),this._updateDomAttributes()}_contentLeft=1;_contentWidth=1;_lineHeight=1;_fontInfo;_accessibilitySupport=0;_accessibilityPageSize=1;_primarySelection=new Et(1,1,1,1);_screenReaderContentState;onConfigurationChanged(t){this._updateConfigurationSettings(),this._updateDomAttributes(),t.hasChanged(2)&&this.writeScreenReaderContent()}_updateConfigurationSettings(){let t=this._context.configuration.options,e=t.get(147);this._contentLeft=e.contentLeft,this._contentWidth=e.contentWidth,this._fontInfo=t.get(51),this._lineHeight=t.get(68),this._accessibilitySupport=t.get(2),this._accessibilityPageSize=t.get(3)}_updateDomAttributes(){let t=this._context.configuration.options;this._domNode.domNode.setAttribute("aria-label",bR(t,this._keybindingService));let e=this._context.viewModel.model.getOptions().tabSize,i=t.get(51).spaceWidth;this._domNode.domNode.style.tabSize=`${e*i}px`}onCursorStateChanged(t){this._primarySelection=t.selections[0]??new Et(1,1,1,1)}prepareRender(t){this.writeScreenReaderContent()}render(t){if(!this._screenReaderContentState)return;hn(this._domNode,this._fontInfo);let e=this._context.viewLayout.getVerticalOffsetForLineNumber(this._primarySelection.positionLineNumber),i=this._context.viewLayout.getCurrentScrollTop(),n=e-i;this._domNode.setTop(n),this._domNode.setLeft(this._contentLeft),this._domNode.setWidth(this._contentWidth),this._domNode.setHeight(this._lineHeight);let o=this._screenReaderContentState.value.substring(0,this._screenReaderContentState.selectionStart),s=vR(o);this._domNode.domNode.scrollTop=s*this._lineHeight}setAriaOptions(){}writeScreenReaderContent(){this._screenReaderContentState=this._getScreenReaderContentState(),this._screenReaderContentState&&(this._domNode.domNode.textContent!==this._screenReaderContentState.value&&(this._domNode.domNode.textContent=this._screenReaderContentState.value),this._setSelectionOfScreenReaderContent(this._screenReaderContentState.selectionStart,this._screenReaderContentState.selectionEnd))}_getScreenReaderContentState(){let t=this._accessibilitySupport===1?1:this._accessibilityPageSize,e={getLineCount:()=>this._context.viewModel.getLineCount(),getLineMaxColumn:i=>this._context.viewModel.getLineMaxColumn(i),getValueInRange:(i,n)=>this._context.viewModel.getValueInRange(i,n),getValueLengthInRange:(i,n)=>this._context.viewModel.getValueLengthInRange(i,n),modifyPosition:(i,n)=>this._context.viewModel.modifyPosition(i,n)};return qE.fromEditorSelection(e,this._primarySelection,t,this._accessibilitySupport===0)}_setSelectionOfScreenReaderContent(t,e){let n=Gr().document.getSelection();if(!n)return;let o=this._domNode.domNode.firstChild;if(!o)return;let s=Gr().document.activeElement,a=new globalThis.Range;a.setStart(o,t),a.setEnd(o,e),n.removeAllRanges(),n.addRange(a),on(s)&&s.focus()}};ix=E([b(2,Be)],ix);var nx=class extends JE{domNode;_editContext;_screenReaderSupport;_parent;_decorations=[];_renderingContext;_primarySelection=new Et(1,1,1,1);_textStartPositionWithinEditor=new H(1,1);_compositionRangeWithinEditor;_focusTracker;constructor(t,e,i,n){super(t),this.domNode=new tI(document.createElement("div")),this.domNode.setClassName("native-edit-context"),this._updateDomAttributes(),this._focusTracker=this._register(new JW(this.domNode.domNode,o=>this._context.viewModel.setHasFocus(o))),this._editContext=new EditContext,this.domNode.domNode.editContext=this._editContext,this._screenReaderSupport=i.createInstance(ix,this.domNode,t),this._register(F(this.domNode.domNode,"copy",()=>this._ensureClipboardGetsEditorSelection(n))),this._register(F(this.domNode.domNode,"cut",()=>{this._ensureClipboardGetsEditorSelection(n),e.cut()})),this._register(F(this.domNode.domNode,"keyup",o=>e.emitKeyUp(new ut(o)))),this._register(F(this.domNode.domNode,"keydown",async o=>{let s=new ut(o);s.keyCode===114&&s.stopPropagation(),s.keyCode===3&&this._onType(e,{text:`
`,replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0}),e.emitKeyDown(s)})),this._register(tx(this._editContext,"textformatupdate",o=>this._handleTextFormatUpdate(o))),this._register(tx(this._editContext,"characterboundsupdate",o=>this._updateCharacterBounds())),this._register(tx(this._editContext,"textupdate",o=>{let s=this._compositionRangeWithinEditor;if(s){let a=this._context.viewModel.getPrimaryCursorState().modelState.position,l=L.fromPositions(s.getStartPosition(),a);this._compositionRangeWithinEditor=l}this._emitTypeEvent(e,o),this._screenReaderSupport.writeScreenReaderContent()})),this._register(tx(this._editContext,"compositionstart",o=>{let s=this._context.viewModel.getPrimaryCursorState().modelState.position,a=L.fromPositions(s,s);this._compositionRangeWithinEditor=a,e.compositionStart(),this._context.viewModel.onCompositionStart()})),this._register(tx(this._editContext,"compositionend",o=>{this._compositionRangeWithinEditor=void 0,e.compositionEnd(),this._context.viewModel.onCompositionEnd()}))}dispose(){super.dispose(),this.domNode.domNode.remove()}appendTo(t){t.appendChild(this.domNode),this._parent=t.domNode}setAriaOptions(){this._screenReaderSupport.setAriaOptions()}getLastRenderData(){return this._primarySelection.getPosition()}prepareRender(t){this._renderingContext=t,this._screenReaderSupport.prepareRender(t),this._updateEditContext(),this._updateSelectionAndControlBounds(),this._updateCharacterBounds()}render(t){this._screenReaderSupport.render(t)}onCursorStateChanged(t){return this._primarySelection=t.modelSelections[0]??new Et(1,1,1,1),this._screenReaderSupport.onCursorStateChanged(t),!0}onConfigurationChanged(t){return this._screenReaderSupport.onConfigurationChanged(t),this._updateDomAttributes(),!0}writeScreenReaderContent(){this._screenReaderSupport.writeScreenReaderContent()}isFocused(){return this._focusTracker.isFocused}focus(){this._focusTracker.focus()}refreshFocusState(){}_updateDomAttributes(){let t=this._context.configuration.options;this.domNode.domNode.setAttribute("tabindex",String(t.get(126)))}_updateEditContext(){let t=this._getNewEditContextState();this._editContext.updateText(0,Number.MAX_SAFE_INTEGER,t.text),this._editContext.updateSelection(t.selectionStartOffset,t.selectionEndOffset),this._textStartPositionWithinEditor=t.textStartPositionWithinEditor}_emitTypeEvent(t,e){if(!this._editContext)return;let i=this._context.viewModel.model,n=i.getOffsetAt(this._textStartPositionWithinEditor),o=i.getOffsetAt(this._primarySelection.getEndPosition()),s=i.getOffsetAt(this._primarySelection.getStartPosition()),a=o-n,l=s-n,d=0,c=0;e.updateRangeEnd>a&&(d=e.updateRangeEnd-a),e.updateRangeStart<l&&(c=l-e.updateRangeStart);let p="";l<e.updateRangeStart&&(p+=this._editContext.text.substring(l,e.updateRangeStart)),p+=e.text,a>e.updateRangeEnd&&(p+=this._editContext.text.substring(e.updateRangeEnd,a));let h={text:p,replacePrevCharCnt:c,replaceNextCharCnt:d,positionDelta:0};this._onType(t,h);let m=l-c+p.length;this._updateCursorStatesAfterType(m,e.selectionStart,e.selectionEnd)}_onType(t,e){e.replacePrevCharCnt||e.replaceNextCharCnt||e.positionDelta?t.compositionType(e.text,e.replacePrevCharCnt,e.replaceNextCharCnt,e.positionDelta):t.type(e.text)}_updateCursorStatesAfterType(t,e,i){let n=e-t,o=i-t,l=this._context.viewModel.getCursorStates().map(d=>d.modelState.position).map(d=>{let c=d.lineNumber,p=d.column;return new Et(c,p+n,c,p+o)}).map(d=>Zt.fromModelSelection(d));this._context.viewModel.setCursorStates("editContext",3,l)}_getNewEditContextState(){let t=this._primarySelection.startColumn-1,e=0;for(let a=this._primarySelection.startLineNumber;a<=this._primarySelection.endLineNumber;a++)a===this._primarySelection.endLineNumber?e+=this._primarySelection.endColumn-1:e+=this._context.viewModel.model.getLineMaxColumn(a);let i=this._context.viewModel.model.getLineMaxColumn(this._primarySelection.endLineNumber),n=new L(this._primarySelection.startLineNumber,1,this._primarySelection.endLineNumber,i),o=this._context.viewModel.model.getValueInRange(n,0),s=n.getStartPosition();return{text:o,selectionStartOffset:t,selectionEndOffset:e,textStartPositionWithinEditor:s}}_handleTextFormatUpdate(t){if(!this._editContext)return;let e=t.getTextFormats(),i=this._textStartPositionWithinEditor,n=[];e.forEach(o=>{let s=this._context.viewModel.model,a=s.getOffsetAt(i),l=s.getPositionAt(a+o.rangeStart),d=s.getPositionAt(a+o.rangeEnd),c=L.fromPositions(l,d),p=["edit-context-format-decoration",`underline-style-${o.underlineStyle.toLowerCase()}`,`underline-thickness-${o.underlineThickness.toLowerCase()}`];n.push({range:c,options:{description:"textFormatDecoration",inlineClassName:p.join(" ")}})}),this._decorations=this._context.viewModel.model.deltaDecorations(this._decorations,n)}_updateSelectionAndControlBounds(){if(!this._parent)return;let t=this._context.configuration.options,e=t.get(68),i=t.get(147).contentLeft,n=this._parent.getBoundingClientRect(),o=this._context.viewLayout.getVerticalOffsetForLineNumber(this._primarySelection.startLineNumber),s=this._context.viewLayout.getCurrentScrollTop(),a=n.top+o-s,l=(this._primarySelection.endLineNumber-this._primarySelection.startLineNumber+1)*e,d=n.left+i,c;if(this._primarySelection.isEmpty()){if(this._renderingContext){let m=this._renderingContext.linesVisibleRangesForRange(this._primarySelection,!0)??[];m.length>0&&(d+=Math.min(...m.map(f=>Math.min(...f.ranges.map(g=>g.left)))))}c=t.get(51).typicalHalfwidthCharacterWidth/2}else c=n.width-i;let p=new DOMRect(d,a,c,l),h=p;this._editContext.updateControlBounds(h),this._editContext.updateSelectionBounds(p)}_updateCharacterBounds(){if(!this._parent||!this._compositionRangeWithinEditor)return;let t=this._context.configuration.options,e=t.get(68),i=t.get(147).contentLeft,n=this._parent.getBoundingClientRect(),o=this._compositionRangeWithinEditor,s=this._context.viewLayout.getVerticalOffsetForLineNumber(o.startLineNumber),a=this._context.viewLayout.getCurrentScrollTop(),l=n.top+s-a,d=[];if(this._renderingContext){let f=this._renderingContext.linesVisibleRangesForRange(o,!0)??[];for(let g of f)for(let v of g.ranges)d.push(new DOMRect(n.left+i+v.left,l,v.width,e))}let c=this._context.viewModel.model,p=c.getOffsetAt(this._textStartPositionWithinEditor),m=c.getOffsetAt(o.getStartPosition())-p;this._editContext.updateCharacterBounds(m,d)}_ensureClipboardGetsEditorSelection(t){let e=this._context.configuration.options,i=e.get(38),n=e.get(25),o=this._context.viewModel.getCursorStates().map(l=>l.modelState.selection),s=gW(this._context.viewModel,o,i,n),a={version:1,isFromEmptySelection:s.isFromEmptySelection,multicursorText:s.multicursorText,mode:s.mode};xy.INSTANCE.set(po?s.text.replace(/\r\n/g,`
`):s.text,a),t.writeText(s.text)}};nx=E([b(2,ne),b(3,rs)],nx);var ox=class extends bc{constructor(e,i,n,o,s,a,l){super();this._instantiationService=l;this._selections=[new Et(1,1,1,1)],this._renderAnimationFrame=null;let d=new mW(i,o,s,e);this._context=new VV(i,n,o),this._context.addEventHandler(this),this._viewParts=[];let c=this._context.configuration.options.get(37);this._editContext=c?this._instantiationService.createInstance(nx,this._context,d):this._instantiationService.createInstance(ex,this._context,d,this._createTextAreaHandlerHelper()),this._viewParts.push(this._editContext),this._linesContent=Ot(document.createElement("div")),this._linesContent.setClassName("lines-content monaco-editor-background"),this._linesContent.setPosition("absolute"),this.domNode=Ot(document.createElement("div")),this.domNode.setClassName(this._getEditorClassName()),this.domNode.setAttribute("role","code"),this._overflowGuardContainer=Ot(document.createElement("div")),Pr.write(this._overflowGuardContainer,3),this._overflowGuardContainer.setClassName("overflow-guard"),this._scrollbar=new kW(this._context,this._linesContent,this.domNode,this._overflowGuardContainer),this._viewParts.push(this._scrollbar),this._viewLines=new PW(this._context,this._linesContent),this._viewZones=new YW(this._context),this._viewParts.push(this._viewZones);let p=new zW(this._context);this._viewParts.push(p);let h=new qW(this._context);this._viewParts.push(h);let m=new yW(this._context);this._viewParts.push(m),m.addDynamicOverlay(new TW(this._context)),m.addDynamicOverlay(new jW(this._context)),m.addDynamicOverlay(new RW(this._context)),m.addDynamicOverlay(new DW(this._context)),m.addDynamicOverlay(new QW(this._context));let f=new SW(this._context);this._viewParts.push(f),f.addDynamicOverlay(new _W(this._context)),f.addDynamicOverlay(new AW(this._context)),f.addDynamicOverlay(new MW(this._context)),f.addDynamicOverlay(new YE(this._context)),this._glyphMarginWidgets=new LW(this._context),this._viewParts.push(this._glyphMarginWidgets);let g=new QE(this._context);g.getDomNode().appendChild(this._viewZones.marginDomNode),g.getDomNode().appendChild(f.getDomNode()),g.getDomNode().appendChild(this._glyphMarginWidgets.domNode),this._viewParts.push(g),this._contentWidgets=new wW(this._context,this.domNode),this._viewParts.push(this._contentWidgets),this._viewCursors=new XW(this._context),this._viewParts.push(this._viewCursors),this._overlayWidgets=new UW(this._context,this.domNode),this._viewParts.push(this._overlayWidgets);let v=new GW(this._context);this._viewParts.push(v);let I=new CW(this._context);this._viewParts.push(I);let y=new WW(this._context);if(this._viewParts.push(y),p){let w=this._scrollbar.getOverviewRulerLayoutInfo();w.parent.insertBefore(p.getDomNode(),w.insertBefore)}this._linesContent.appendChild(m.getDomNode()),this._linesContent.appendChild(v.domNode),this._linesContent.appendChild(this._viewZones.domNode),this._linesContent.appendChild(this._viewLines.getDomNode()),this._linesContent.appendChild(this._contentWidgets.domNode),this._linesContent.appendChild(this._viewCursors.getDomNode()),this._overflowGuardContainer.appendChild(g.getDomNode()),this._overflowGuardContainer.appendChild(this._scrollbar.getDomNode()),this._overflowGuardContainer.appendChild(h.getDomNode()),this._editContext.appendTo(this._overflowGuardContainer),this._overflowGuardContainer.appendChild(this._overlayWidgets.getDomNode()),this._overflowGuardContainer.appendChild(y.getDomNode()),this._overflowGuardContainer.appendChild(I.domNode),this.domNode.appendChild(this._overflowGuardContainer),a?(a.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode.domNode),a.appendChild(this._overlayWidgets.overflowingOverlayWidgetsDomNode.domNode)):(this.domNode.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode),this.domNode.appendChild(this._overlayWidgets.overflowingOverlayWidgetsDomNode)),this._applyLayout(),this._pointerHandler=this._register(new vW(this._context,d,this._createPointerHandlerHelper()))}_scrollbar;_context;_selections;_viewLines;_viewZones;_contentWidgets;_overlayWidgets;_glyphMarginWidgets;_viewCursors;_viewParts;_editContext;_pointerHandler;_linesContent;domNode;_overflowGuardContainer;_shouldRecomputeGlyphMarginLanes=!1;_renderAnimationFrame;_computeGlyphMarginLanes(){let e=this._context.viewModel.model,i=this._context.viewModel.glyphLanes,n=[],o=0;n=n.concat(e.getAllMarginDecorations().map(s=>{let a=s.options.glyphMargin?.position??2;return o=Math.max(o,s.range.endLineNumber),{range:s.range,lane:a,persist:s.options.glyphMargin?.persistLane}})),n=n.concat(this._glyphMarginWidgets.getWidgets().map(s=>{let a=e.validateRange(s.preference.range);return o=Math.max(o,a.endLineNumber),{range:a,lane:s.preference.lane}})),n.sort((s,a)=>L.compareRangesUsingStarts(s.range,a.range)),i.reset(o);for(let s of n)i.push(s.lane,s.range,s.persist);return i}_createPointerHandlerHelper(){return{viewDomNode:this.domNode.domNode,linesContentDomNode:this._linesContent.domNode,viewLinesDomNode:this._viewLines.getDomNode().domNode,focusTextArea:()=>{this.focus()},dispatchTextAreaEvent:e=>{this._editContext.domNode.domNode.dispatchEvent(e)},getLastRenderData:()=>{let e=this._viewCursors.getLastRenderData()||[],i=this._editContext.getLastRenderData();return new qV(e,i)},renderNow:()=>{this.render(!0,!1)},shouldSuppressMouseDownOnViewZone:e=>this._viewZones.shouldSuppressMouseDownOnViewZone(e),shouldSuppressMouseDownOnWidget:e=>this._contentWidgets.shouldSuppressMouseDownOnWidget(e),getPositionFromDOMInfo:(e,i)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.getPositionFromDOMInfo(e,i)),visibleRangeForPosition:(e,i)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.visibleRangeForPosition(new H(e,i))),getLineWidth:e=>(this._flushAccumulatedAndRenderNow(),this._viewLines.getLineWidth(e))}}_createTextAreaHandlerHelper(){return{visibleRangeForPosition:e=>(this._flushAccumulatedAndRenderNow(),this._viewLines.visibleRangeForPosition(e))}}_applyLayout(){let i=this._context.configuration.options.get(147);this.domNode.setWidth(i.width),this.domNode.setHeight(i.height),this._overflowGuardContainer.setWidth(i.width),this._overflowGuardContainer.setHeight(i.height),this._linesContent.setWidth(16777216),this._linesContent.setHeight(16777216)}_getEditorClassName(){let e=this._editContext.isFocused()?" focused":"";return this._context.configuration.options.get(144)+" "+sk(this._context.theme.type)+e}handleEvents(e){super.handleEvents(e),this._scheduleRender()}onConfigurationChanged(e){return this.domNode.setClassName(this._getEditorClassName()),this._applyLayout(),!1}onCursorStateChanged(e){return this._selections=e.selections,!1}onDecorationsChanged(e){return e.affectsGlyphMargin&&(this._shouldRecomputeGlyphMarginLanes=!0),!1}onFocusChanged(e){return this.domNode.setClassName(this._getEditorClassName()),!1}onThemeChanged(e){return this._context.theme.update(e.theme),this.domNode.setClassName(this._getEditorClassName()),!1}dispose(){this._renderAnimationFrame!==null&&(this._renderAnimationFrame.dispose(),this._renderAnimationFrame=null),this._contentWidgets.overflowingContentWidgetsDomNode.domNode.remove(),this._context.removeEventHandler(this),this._viewLines.dispose();for(let e of this._viewParts)e.dispose();super.dispose()}_scheduleRender(){if(this._store.isDisposed)throw new _t;if(this._renderAnimationFrame===null){let e=this._createCoordinatedRendering();this._renderAnimationFrame=g$.INSTANCE.scheduleCoordinatedRendering({window:ue(this.domNode?.domNode),prepareRenderText:()=>{if(this._store.isDisposed)throw new _t;try{return e.prepareRenderText()}finally{this._renderAnimationFrame=null}},renderText:()=>{if(this._store.isDisposed)throw new _t;return e.renderText()},prepareRender:(i,n)=>{if(this._store.isDisposed)throw new _t;return e.prepareRender(i,n)},render:(i,n)=>{if(this._store.isDisposed)throw new _t;return e.render(i,n)}})}}_flushAccumulatedAndRenderNow(){let e=this._createCoordinatedRendering();Mb(()=>e.prepareRenderText());let i=Mb(()=>e.renderText());if(i){let[n,o]=i;Mb(()=>e.prepareRender(n,o)),Mb(()=>e.render(n,o))}}_getViewPartsToRender(){let e=[],i=0;for(let n of this._viewParts)n.shouldRender()&&(e[i++]=n);return e}_createCoordinatedRendering(){return{prepareRenderText:()=>{if(this._shouldRecomputeGlyphMarginLanes){this._shouldRecomputeGlyphMarginLanes=!1;let e=this._computeGlyphMarginLanes();this._context.configuration.setGlyphMarginDecorationLaneCount(e.requiredLanes)}cg.onRenderStart()},renderText:()=>{if(!this.domNode.domNode.isConnected)return null;let e=this._getViewPartsToRender();if(!this._viewLines.shouldRender()&&e.length===0)return null;let i=this._context.viewLayout.getLinesViewportData();this._context.viewModel.setViewport(i.startLineNumber,i.endLineNumber,i.centeredLineNumber);let n=new OV(this._selections,i,this._context.viewLayout.getWhitespaceViewportData(),this._context.viewModel);return this._contentWidgets.shouldRender()&&this._contentWidgets.onBeforeRender(n),this._viewLines.shouldRender()&&(this._viewLines.renderText(n),this._viewLines.onDidRender(),e=this._getViewPartsToRender()),[e,new NV(this._context.viewLayout,n,this._viewLines)]},prepareRender:(e,i)=>{for(let n of e)n.prepareRender(i)},render:(e,i)=>{for(let n of e)n.render(i),n.onDidRender()}}}delegateVerticalScrollbarPointerDown(e){this._scrollbar.delegateVerticalScrollbarPointerDown(e)}delegateScrollFromMouseWheelEvent(e){this._scrollbar.delegateScrollFromMouseWheelEvent(e)}restoreState(e){this._context.viewModel.viewLayout.setScrollPosition({scrollTop:e.scrollTop,scrollLeft:e.scrollLeft},1),this._context.viewModel.visibleLinesStabilized()}getOffsetForColumn(e,i){let n=this._context.viewModel.model.validatePosition({lineNumber:e,column:i}),o=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(n);this._flushAccumulatedAndRenderNow();let s=this._viewLines.visibleRangeForPosition(new H(o.lineNumber,o.column));return s?s.left:-1}getTargetAtClientPoint(e,i){let n=this._pointerHandler.getTargetAtClientPoint(e,i);return n?KE.convertViewToModelMouseTarget(n,this._context.viewModel.coordinatesConverter):null}createOverviewRuler(e){return new KW(this._context,e)}change(e){this._viewZones.changeViewZones(e),this._scheduleRender()}render(e,i){if(i){this._viewLines.forceShouldRender();for(let n of this._viewParts)n.forceShouldRender()}e?this._flushAccumulatedAndRenderNow():this._scheduleRender()}writeScreenReaderContent(e){this._editContext.writeScreenReaderContent(e)}focus(){this._editContext.focus()}isFocused(){return this._editContext.isFocused()}refreshFocusState(){this._editContext.refreshFocusState()}setAriaOptions(e){this._editContext.setAriaOptions(e)}addContentWidget(e){this._contentWidgets.addWidget(e.widget),this.layoutContentWidget(e),this._scheduleRender()}layoutContentWidget(e){this._contentWidgets.setWidgetPosition(e.widget,e.position?.position??null,e.position?.secondaryPosition??null,e.position?.preference??null,e.position?.positionAffinity??null),this._scheduleRender()}removeContentWidget(e){this._contentWidgets.removeWidget(e.widget),this._scheduleRender()}addOverlayWidget(e){this._overlayWidgets.addWidget(e.widget),this.layoutOverlayWidget(e),this._scheduleRender()}layoutOverlayWidget(e){this._overlayWidgets.setWidgetPosition(e.widget,e.position)&&this._scheduleRender()}removeOverlayWidget(e){this._overlayWidgets.removeWidget(e.widget),this._scheduleRender()}addGlyphMarginWidget(e){this._glyphMarginWidgets.addWidget(e.widget),this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender()}layoutGlyphMarginWidget(e){let i=e.position;this._glyphMarginWidgets.setWidgetPosition(e.widget,i)&&(this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender())}removeGlyphMarginWidget(e){this._glyphMarginWidgets.removeWidget(e.widget),this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender()}};ox=E([b(6,ne)],ox);function Mb(r){try{return r()}catch(t){return Xe(t),null}}var g$=class r{static INSTANCE=new r;_coordinatedRenderings=[];_animationFrameRunners=new Map;constructor(){}scheduleCoordinatedRendering(t){return this._coordinatedRenderings.push(t),this._scheduleRender(t.window),{dispose:()=>{let e=this._coordinatedRenderings.indexOf(t);if(e!==-1&&(this._coordinatedRenderings.splice(e,1),this._coordinatedRenderings.length===0)){for(let[i,n]of this._animationFrameRunners)n.dispose();this._animationFrameRunners.clear()}}}}_scheduleRender(t){if(!this._animationFrameRunners.has(t)){let e=()=>{this._animationFrameRunners.delete(t),this._onRenderScheduled()};this._animationFrameRunners.set(t,jS(t,e,100))}}_onRenderScheduled(){let t=this._coordinatedRenderings.slice(0);this._coordinatedRenderings=[];for(let i of t)Mb(()=>i.prepareRenderText());let e=[];for(let i=0,n=t.length;i<n;i++){let o=t[i];e[i]=Mb(()=>o.renderText())}for(let i=0,n=t.length;i<n;i++){let o=t[i],s=e[i];if(!s)continue;let[a,l]=s;Mb(()=>o.prepareRender(a,l))}for(let i=0,n=t.length;i<n;i++){let o=t[i],s=e[i];if(!s)continue;let[a,l]=s;Mb(()=>o.render(a,l))}}};var jEe=kh("domLineBreaksComputer",{createHTML:r=>r}),eH=class r{constructor(t){this.targetWindow=t}static create(t){return new r(new WeakRef(t))}createLineBreaksComputer(t,e,i,n,o){let s=[],a=[];return{addRequest:(l,d,c)=>{s.push(l),a.push(d)},finalize:()=>XEe(Yt(this.targetWindow.deref()),s,t,e,i,n,o,a)}}};function XEe(r,t,e,i,n,o,s,a){function l(O){let K=a[O];if(K){let G=ol.applyInjectedText(t[O],K),Y=K.map(xe=>xe.options),ge=K.map(xe=>xe.column-1);return new Rm(ge,Y,[G.length],[],0)}else return null}if(n===-1){let O=[];for(let K=0,G=t.length;K<G;K++)O[K]=l(K);return O}let d=Math.round(n*e.typicalHalfwidthCharacterWidth),c=o===3?2:o===2?1:0,p=Math.round(i*c),h=Math.ceil(e.spaceWidth*p),m=document.createElement("div");hn(m,e);let f=new xd(1e4),g=[],v=[],I=[],y=[],w=[];for(let O=0;O<t.length;O++){let K=ol.applyInjectedText(t[O],a[O]),G=0,Y=0,ge=d;if(o!==0)if(G=Jn(K),G===-1)G=0;else{for(let Le=0;Le<G;Le++){let Ee=K.charCodeAt(Le)===9?i-Y%i:1;Y+=Ee}let fe=Math.ceil(e.spaceWidth*Y);fe+e.typicalFullwidthCharacterWidth>d?(G=0,Y=0):ge=d-fe}let xe=K.substr(G),be=YEe(xe,Y,i,ge,f,h);g[O]=G,v[O]=Y,I[O]=xe,y[O]=be[0],w[O]=be[1]}let C=f.build(),S=jEe?.createHTML(C)??C;m.innerHTML=S,m.style.position="absolute",m.style.top="10000",s==="keepAll"?(m.style.wordBreak="keep-all",m.style.overflowWrap="anywhere"):(m.style.wordBreak="inherit",m.style.overflowWrap="break-word"),r.document.body.appendChild(m);let D=document.createRange(),k=Array.prototype.slice.call(m.children,0),M=[];for(let O=0;O<t.length;O++){let K=k[O],G=QEe(D,K,I[O],y[O]);if(G===null){M[O]=l(O);continue}let Y=g[O],ge=v[O]+p,xe=w[O],be=[];for(let Ce=0,Je=G.length;Ce<Je;Ce++)be[Ce]=xe[G[Ce]];if(Y!==0)for(let Ce=0,Je=G.length;Ce<Je;Ce++)G[Ce]+=Y;let fe,Le,Ee=a[O];Ee?(fe=Ee.map(Ce=>Ce.options),Le=Ee.map(Ce=>Ce.column-1)):(fe=null,Le=null),M[O]=new Rm(Le,fe,G,be,ge)}return m.remove(),M}function YEe(r,t,e,i,n,o){if(o!==0){let h=String(o);n.appendString('<div style="text-indent: -'),n.appendString(h),n.appendString("px; padding-left: "),n.appendString(h),n.appendString("px; box-sizing: border-box; width:")}else n.appendString('<div style="width:');n.appendString(String(i)),n.appendString('px;">');let s=r.length,a=t,l=0,d=[],c=[],p=0<s?r.charCodeAt(0):0;n.appendString("<span>");for(let h=0;h<s;h++){h!==0&&h%16384===0&&n.appendString("</span><span>"),d[h]=l,c[h]=a;let m=p;p=h+1<s?r.charCodeAt(h+1):0;let f=1,g=1;switch(m){case 9:f=e-a%e,g=f;for(let v=1;v<=f;v++)v<f?n.appendCharCode(160):n.appendASCIICharCode(32);break;case 32:p===32?n.appendCharCode(160):n.appendASCIICharCode(32);break;case 60:n.appendString("&lt;");break;case 62:n.appendString("&gt;");break;case 38:n.appendString("&amp;");break;case 0:n.appendString("&#00;");break;case 65279:case 8232:case 8233:case 133:n.appendCharCode(65533);break;default:vd(m)&&g++,m<32?n.appendCharCode(9216+m):n.appendCharCode(m)}l+=f,a+=g}return n.appendString("</span>"),d[r.length]=l,c[r.length]=a,n.appendString("</div>"),[d,c]}function QEe(r,t,e,i){if(e.length<=1)return null;let n=Array.prototype.slice.call(t.children,0),o=[];try{b$(r,n,i,0,null,e.length-1,null,o)}catch(s){return console.log(s),null}return o.length===0?null:(o.push(e.length),o)}function b$(r,t,e,i,n,o,s,a){if(i===o||(n=n||f$(r,t,e[i],e[i+1]),s=s||f$(r,t,e[o],e[o+1]),Math.abs(n[0].top-s[0].top)<=.1))return;if(i+1===o){a.push(o);return}let l=i+(o-i)/2|0,d=f$(r,t,e[l],e[l+1]);b$(r,t,e,i,n,l,d,a),b$(r,t,e,l,d,o,s,a)}function f$(r,t,e,i){return r.setStart(t[e/16384|0].firstChild,e%16384),r.setEnd(t[i/16384|0].firstChild,i%16384),r.getClientRects()}var tH=class extends R{_editor=null;_instantiationService=null;_instances=this._register(new us);_pending=new Map;_finishedInstantiation=[];constructor(){super(),this._finishedInstantiation[0]=!1,this._finishedInstantiation[1]=!1,this._finishedInstantiation[2]=!1,this._finishedInstantiation[3]=!1}initialize(t,e,i){this._editor=t,this._instantiationService=i;for(let n of e){if(this._pending.has(n.id)){Xe(new Error(`Cannot have two contributions with the same id ${n.id}`));continue}this._pending.set(n.id,n)}this._instantiateSome(0),this._register(Jv(ue(this._editor.getDomNode()),()=>{this._instantiateSome(1)})),this._register(Jv(ue(this._editor.getDomNode()),()=>{this._instantiateSome(2)})),this._register(Jv(ue(this._editor.getDomNode()),()=>{this._instantiateSome(3)},5e3))}saveViewState(){let t={};for(let[e,i]of this._instances)typeof i.saveViewState=="function"&&(t[e]=i.saveViewState());return t}restoreViewState(t){for(let[e,i]of this._instances)typeof i.restoreViewState=="function"&&i.restoreViewState(t[e])}get(t){return this._instantiateById(t),this._instances.get(t)||null}set(t,e){this._instances.set(t,e)}onBeforeInteractionEvent(){this._instantiateSome(2)}onAfterModelAttached(){return Jv(ue(this._editor?.getDomNode()),()=>{this._instantiateSome(1)},50)}_instantiateSome(t){if(this._finishedInstantiation[t])return;this._finishedInstantiation[t]=!0;let e=this._findPendingContributionsByInstantiation(t);for(let i of e)this._instantiateById(i.id)}_findPendingContributionsByInstantiation(t){let e=[];for(let[,i]of this._pending)i.instantiation===t&&e.push(i);return e}_instantiateById(t){let e=this._pending.get(t);if(e){if(this._pending.delete(t),!this._instantiationService||!this._editor)throw new Error("Cannot instantiate contributions before being initialized!");try{let i=this._instantiationService.createInstance(e.ctor,this._editor);this._instances.set(e.id,i),typeof i.restoreViewState=="function"&&e.instantiation!==0&&console.warn(`Editor contribution '${e.id}' should be eager instantiated because it uses saveViewState / restoreViewState.`)}catch(i){Xe(i)}}}};var iH=class{constructor(t,e,i,n,o,s,a){this.id=t;this.label=e;this.alias=i;this.metadata=n;this._precondition=o;this._run=s;this._contextKeyService=a}isSupported(){return this._contextKeyService.contextMatchesRules(this._precondition)}run(t){return this.isSupported()?this._run(t):Promise.resolve(void 0)}};var nH=class r{static create(t){return new r(t.get(136),t.get(135))}classifier;constructor(t,e){this.classifier=new v$(t,e)}createLineBreaksComputer(t,e,i,n,o){let s=[],a=[],l=[];return{addRequest:(d,c,p)=>{s.push(d),a.push(c),l.push(p)},finalize:()=>{let d=t.typicalFullwidthCharacterWidth/t.typicalHalfwidthCharacterWidth,c=[];for(let p=0,h=s.length;p<h;p++){let m=a[p],f=l[p];f&&!f.injectionOptions&&!m?c[p]=ZEe(this.classifier,f,s[p],e,i,d,n,o):c[p]=JEe(this.classifier,s[p],m,e,i,d,n,o)}return I$.length=0,y$.length=0,c}}}};var v$=class extends bI{constructor(t,e){super(0);for(let i=0;i<t.length;i++)this.set(t.charCodeAt(i),1);for(let i=0;i<e.length;i++)this.set(e.charCodeAt(i),2)}get(t){return t>=0&&t<256?this._asciiMap[t]:t>=12352&&t<=12543||t>=13312&&t<=19903||t>=19968&&t<=40959?3:this._map.get(t)||this._defaultValue}},I$=[],y$=[];function ZEe(r,t,e,i,n,o,s,a){if(n===-1)return null;let l=e.length;if(l<=1)return null;let d=a==="keepAll",c=t.breakOffsets,p=t.breakOffsetsVisibleColumn,h=Uce(e,i,n,o,s),m=n-h,f=I$,g=y$,v=0,I=0,y=0,w=n,C=c.length,S=0;if(S>=0){let D=Math.abs(p[S]-w);for(;S+1<C;){let k=Math.abs(p[S+1]-w);if(k>=D)break;D=k,S++}}for(;S<C;){let D=S<0?0:c[S],k=S<0?0:p[S];I>D&&(D=I,k=y);let M=0,O=0,K=0,G=0;if(k<=w){let ge=k,xe=D===0?0:e.charCodeAt(D-1),be=D===0?0:r.get(xe),fe=!0;for(let Le=D;Le<l;Le++){let Ee=Le,Ce=e.charCodeAt(Le),Je,pe;if(Rn(Ce)?(Le++,Je=0,pe=2):(Je=r.get(Ce),pe=yR(Ce,ge,i,o)),Ee>I&&S$(xe,be,Ce,Je,d)&&(M=Ee,O=ge),ge+=pe,ge>w){Ee>I?(K=Ee,G=ge-pe):(K=Le+1,G=ge),ge-O>m&&(M=0),fe=!1;break}xe=Ce,be=Je}if(fe){v>0&&(f[v]=c[c.length-1],g[v]=p[c.length-1],v++);break}}if(M===0){let ge=k,xe=e.charCodeAt(D),be=r.get(xe),fe=!1;for(let Le=D-1;Le>=I;Le--){let Ee=Le+1,Ce=e.charCodeAt(Le);if(Ce===9){fe=!0;break}let Je,pe;if(xp(Ce)?(Le--,Je=0,pe=2):(Je=r.get(Ce),pe=vd(Ce)?o:1),ge<=w){if(K===0&&(K=Ee,G=ge),ge<=w-m)break;if(S$(Ce,Je,xe,be,d)){M=Ee,O=ge;break}}ge-=pe,xe=Ce,be=Je}if(M!==0){let Le=m-(G-O);if(Le<=i){let Ee=e.charCodeAt(K),Ce;Rn(Ee)?Ce=2:Ce=yR(Ee,G,i,o),Le-Ce<0&&(M=0)}}if(fe){S--;continue}}if(M===0&&(M=K,O=G),M<=I){let ge=e.charCodeAt(I);Rn(ge)?(M=I+2,O=y+2):(M=I+1,O=y+yR(ge,y,i,o))}for(I=M,f[v]=M,y=O,g[v]=O,v++,w=O+m;S<0||S<C&&p[S]<O;)S++;let Y=Math.abs(p[S]-w);for(;S+1<C;){let ge=Math.abs(p[S+1]-w);if(ge>=Y)break;Y=ge,S++}}return v===0?null:(f.length=v,g.length=v,I$=t.breakOffsets,y$=t.breakOffsetsVisibleColumn,t.breakOffsets=f,t.breakOffsetsVisibleColumn=g,t.wrappedTextIndentLength=h,t)}function JEe(r,t,e,i,n,o,s,a){let l=ol.applyInjectedText(t,e),d,c;if(e&&e.length>0?(d=e.map(O=>O.options),c=e.map(O=>O.column-1)):(d=null,c=null),n===-1)return d?new Rm(c,d,[l.length],[],0):null;let p=l.length;if(p<=1)return d?new Rm(c,d,[l.length],[],0):null;let h=a==="keepAll",m=Uce(l,i,n,o,s),f=n-m,g=[],v=[],I=0,y=0,w=0,C=n,S=l.charCodeAt(0),D=r.get(S),k=yR(S,0,i,o),M=1;Rn(S)&&(k+=1,S=l.charCodeAt(1),D=r.get(S),M++);for(let O=M;O<p;O++){let K=O,G=l.charCodeAt(O),Y,ge;Rn(G)?(O++,Y=0,ge=2):(Y=r.get(G),ge=yR(G,k,i,o)),S$(S,D,G,Y,h)&&(y=K,w=k),k+=ge,k>C&&((y===0||k-w>f)&&(y=K,w=k-ge),g[I]=y,v[I]=w,I++,C=w+f,y=0),S=G,D=Y}return I===0&&(!e||e.length===0)?null:(g[I]=p,v[I]=k,new Rm(c,d,g,v,m))}function yR(r,t,e,i){return r===9?e-t%e:vd(r)||r<32?i:1}function Hce(r,t){return t-r%t}function S$(r,t,e,i,n){return e!==32&&(t===2&&i!==2||t!==1&&i===1||!n&&t===3&&i!==2||!n&&i===3&&t!==1)}function Uce(r,t,e,i,n){let o=0;if(n!==0){let s=Jn(r);if(s!==-1){for(let l=0;l<s;l++){let d=r.charCodeAt(l)===9?Hce(o,t):1;o+=d}let a=n===3?2:n===2?1:0;for(let l=0;l<a;l++){let d=Hce(o,t);o+=d}o+i>e&&(o=0)}}return o}var SR=class{_cursorContextBrand=void 0;model;viewModel;coordinatesConverter;cursorConfig;constructor(t,e,i,n){this.model=t,this.viewModel=e,this.coordinatesConverter=i,this.cursorConfig=n}};var CR=class r{modelState;viewState;_selTrackedRange;_trackSelection;constructor(t){this._selTrackedRange=null,this._trackSelection=!0,this._setState(t,new No(new L(1,1,1,1),0,0,new H(1,1),0),new No(new L(1,1,1,1),0,0,new H(1,1),0))}dispose(t){this._removeTrackedRange(t)}startTrackingSelection(t){this._trackSelection=!0,this._updateTrackedRange(t)}stopTrackingSelection(t){this._trackSelection=!1,this._removeTrackedRange(t)}_updateTrackedRange(t){this._trackSelection&&(this._selTrackedRange=t.model._setTrackedRange(this._selTrackedRange,this.modelState.selection,0))}_removeTrackedRange(t){this._selTrackedRange=t.model._setTrackedRange(this._selTrackedRange,null,0)}asCursorState(){return new Zt(this.modelState,this.viewState)}readSelectionFromMarkers(t){let e=t.model._getTrackedRange(this._selTrackedRange);return this.modelState.selection.isEmpty()&&!e.isEmpty()?Et.fromRange(e.collapseToEnd(),this.modelState.selection.getDirection()):Et.fromRange(e,this.modelState.selection.getDirection())}ensureValidState(t){this._setState(t,this.modelState,this.viewState)}setState(t,e,i){this._setState(t,e,i)}static _validatePositionWithCache(t,e,i,n){return e.equals(i)?n:t.normalizePosition(e,2)}static _validateViewState(t,e){let i=e.position,n=e.selectionStart.getStartPosition(),o=e.selectionStart.getEndPosition(),s=t.normalizePosition(i,2),a=this._validatePositionWithCache(t,n,i,s),l=this._validatePositionWithCache(t,o,n,a);return i.equals(s)&&n.equals(a)&&o.equals(l)?e:new No(L.fromPositions(a,l),e.selectionStartKind,e.selectionStartLeftoverVisibleColumns+n.column-a.column,s,e.leftoverVisibleColumns+i.column-s.column)}_setState(t,e,i){if(i&&(i=r._validateViewState(t.viewModel,i)),e){let n=t.model.validateRange(e.selectionStart),o=e.selectionStart.equalsRange(n)?e.selectionStartLeftoverVisibleColumns:0,s=t.model.validatePosition(e.position),a=e.position.equals(s)?e.leftoverVisibleColumns:0;e=new No(n,e.selectionStartKind,o,s,a)}else{if(!i)return;let n=t.model.validateRange(t.coordinatesConverter.convertViewRangeToModelRange(i.selectionStart)),o=t.model.validatePosition(t.coordinatesConverter.convertViewPositionToModelPosition(i.position));e=new No(n,i.selectionStartKind,i.selectionStartLeftoverVisibleColumns,o,i.leftoverVisibleColumns)}if(i){let n=t.coordinatesConverter.validateViewRange(i.selectionStart,e.selectionStart),o=t.coordinatesConverter.validateViewPosition(i.position,e.position);i=new No(n,e.selectionStartKind,e.selectionStartLeftoverVisibleColumns,o,e.leftoverVisibleColumns)}else{let n=t.coordinatesConverter.convertModelPositionToViewPosition(new H(e.selectionStart.startLineNumber,e.selectionStart.startColumn)),o=t.coordinatesConverter.convertModelPositionToViewPosition(new H(e.selectionStart.endLineNumber,e.selectionStart.endColumn)),s=new L(n.lineNumber,n.column,o.lineNumber,o.column),a=t.coordinatesConverter.convertModelPositionToViewPosition(e.position);i=new No(s,e.selectionStartKind,e.selectionStartLeftoverVisibleColumns,a,e.leftoverVisibleColumns)}this.modelState=e,this.viewState=i,this._updateTrackedRange(t)}};var wR=class{context;cursors;lastAddedCursorIndex;constructor(t){this.context=t,this.cursors=[new CR(t)],this.lastAddedCursorIndex=0}dispose(){for(let t of this.cursors)t.dispose(this.context)}startTrackingSelections(){for(let t of this.cursors)t.startTrackingSelection(this.context)}stopTrackingSelections(){for(let t of this.cursors)t.stopTrackingSelection(this.context)}updateContext(t){this.context=t}ensureValidState(){for(let t of this.cursors)t.ensureValidState(this.context)}readSelectionFromMarkers(){return this.cursors.map(t=>t.readSelectionFromMarkers(this.context))}getAll(){return this.cursors.map(t=>t.asCursorState())}getViewPositions(){return this.cursors.map(t=>t.viewState.position)}getTopMostViewPosition(){return fJ(this.cursors,Sr(t=>t.viewState.position,H.compare)).viewState.position}getBottomMostViewPosition(){return gJ(this.cursors,Sr(t=>t.viewState.position,H.compare)).viewState.position}getSelections(){return this.cursors.map(t=>t.modelState.selection)}getViewSelections(){return this.cursors.map(t=>t.viewState.selection)}setSelections(t){this.setStates(Zt.fromModelSelections(t))}getPrimaryCursor(){return this.cursors[0].asCursorState()}setStates(t){t!==null&&(this.cursors[0].setState(this.context,t[0].modelState,t[0].viewState),this._setSecondaryStates(t.slice(1)))}_setSecondaryStates(t){let e=this.cursors.length-1,i=t.length;if(e<i){let n=i-e;for(let o=0;o<n;o++)this._addSecondaryCursor()}else if(e>i){let n=e-i;for(let o=0;o<n;o++)this._removeSecondaryCursor(this.cursors.length-2)}for(let n=0;n<i;n++)this.cursors[n+1].setState(this.context,t[n].modelState,t[n].viewState)}killSecondaryCursors(){this._setSecondaryStates([])}_addSecondaryCursor(){this.cursors.push(new CR(this.context)),this.lastAddedCursorIndex=this.cursors.length-1}getLastAddedCursorIndex(){return this.cursors.length===1||this.lastAddedCursorIndex===0?0:this.lastAddedCursorIndex}_removeSecondaryCursor(t){this.lastAddedCursorIndex>=t+1&&this.lastAddedCursorIndex--,this.cursors[t+1].dispose(this.context),this.cursors.splice(t+1,1)}normalize(){if(this.cursors.length===1)return;let t=this.cursors.slice(0),e=[];for(let i=0,n=t.length;i<n;i++)e.push({index:i,selection:t[i].modelState.selection});e.sort(Sr(i=>i.selection,L.compareRangesUsingStarts));for(let i=0;i<e.length-1;i++){let n=e[i],o=e[i+1],s=n.selection,a=o.selection;if(!this.context.cursorConfig.multiCursorMergeOverlapping)continue;let l;if(a.isEmpty()||s.isEmpty()?l=a.getStartPosition().isBeforeOrEqual(s.getEndPosition()):l=a.getStartPosition().isBefore(s.getEndPosition()),l){let d=n.index<o.index?i:i+1,c=n.index<o.index?i+1:i,p=e[c].index,h=e[d].index,m=e[c].selection,f=e[d].selection;if(!m.equalsSelection(f)){let g=m.plusRange(f),v=m.selectionStartLineNumber===m.startLineNumber&&m.selectionStartColumn===m.startColumn,I=f.selectionStartLineNumber===f.startLineNumber&&f.selectionStartColumn===f.startColumn,y;p===this.lastAddedCursorIndex?(y=v,this.lastAddedCursorIndex=h):y=I;let w;y?w=new Et(g.startLineNumber,g.startColumn,g.endLineNumber,g.endColumn):w=new Et(g.endLineNumber,g.endColumn,g.startLineNumber,g.startColumn),e[d].selection=w;let C=Zt.fromModelSelection(w);t[h].setState(this.context,C.modelState,C.viewState)}for(let g of e)g.index>p&&g.index--;t.splice(p,1),e.splice(c,1),this._removeSecondaryCursor(p-1),i--}}}};var oH=class extends R{_onEvent=this._register(new x);onEvent=this._onEvent.event;_eventHandlers;_viewEventQueue;_isConsumingViewEventQueue;_collector;_collectorCnt;_outgoingEvents;constructor(){super(),this._eventHandlers=[],this._viewEventQueue=null,this._isConsumingViewEventQueue=!1,this._collector=null,this._collectorCnt=0,this._outgoingEvents=[]}emitOutgoingEvent(t){this._addOutgoingEvent(t),this._emitOutgoingEvents()}_addOutgoingEvent(t){for(let e=0,i=this._outgoingEvents.length;e<i;e++){let n=this._outgoingEvents[e].kind===t.kind?this._outgoingEvents[e].attemptToMerge(t):null;if(n){this._outgoingEvents[e]=n;return}}this._outgoingEvents.push(t)}_emitOutgoingEvents(){for(;this._outgoingEvents.length>0;){if(this._collector||this._isConsumingViewEventQueue)return;let t=this._outgoingEvents.shift();t.isNoOp()||this._onEvent.fire(t)}}addViewEventHandler(t){for(let e=0,i=this._eventHandlers.length;e<i;e++)this._eventHandlers[e]===t&&console.warn("Detected duplicate listener in ViewEventDispatcher",t);this._eventHandlers.push(t)}removeViewEventHandler(t){for(let e=0;e<this._eventHandlers.length;e++)if(this._eventHandlers[e]===t){this._eventHandlers.splice(e,1);break}}beginEmitViewEvents(){return this._collectorCnt++,this._collectorCnt===1&&(this._collector=new C$),this._collector}endEmitViewEvents(){if(this._collectorCnt--,this._collectorCnt===0){let t=this._collector.outgoingEvents,e=this._collector.viewEvents;this._collector=null;for(let i of t)this._addOutgoingEvent(i);e.length>0&&this._emitMany(e)}this._emitOutgoingEvents()}emitSingleViewEvent(t){try{this.beginEmitViewEvents().emitViewEvent(t)}finally{this.endEmitViewEvents()}}_emitMany(t){this._viewEventQueue?this._viewEventQueue=this._viewEventQueue.concat(t):this._viewEventQueue=t,this._isConsumingViewEventQueue||this._consumeViewEventQueue()}_consumeViewEventQueue(){try{this._isConsumingViewEventQueue=!0,this._doConsumeQueue()}finally{this._isConsumingViewEventQueue=!1}}_doConsumeQueue(){for(;this._viewEventQueue;){let t=this._viewEventQueue;this._viewEventQueue=null;let e=this._eventHandlers.slice(0);for(let i of e)i.handleEvents(t)}}},C$=class{viewEvents;outgoingEvents;constructor(){this.viewEvents=[],this.outgoingEvents=[]}emitViewEvent(t){this.viewEvents.push(t)}emitOutgoingEvent(t){this.outgoingEvents.push(t)}};var rH=class r{kind=0;_oldContentWidth;_oldContentHeight;contentWidth;contentHeight;contentWidthChanged;contentHeightChanged;constructor(t,e,i,n){this._oldContentWidth=t,this._oldContentHeight=e,this.contentWidth=i,this.contentHeight=n,this.contentWidthChanged=this._oldContentWidth!==this.contentWidth,this.contentHeightChanged=this._oldContentHeight!==this.contentHeight}isNoOp(){return!this.contentWidthChanged&&!this.contentHeightChanged}attemptToMerge(t){return t.kind!==this.kind?null:new r(this._oldContentWidth,this._oldContentHeight,t.contentWidth,t.contentHeight)}},sH=class r{kind=1;oldHasFocus;hasFocus;constructor(t,e){this.oldHasFocus=t,this.hasFocus=e}isNoOp(){return this.oldHasFocus===this.hasFocus}attemptToMerge(t){return t.kind!==this.kind?null:new r(this.oldHasFocus,t.hasFocus)}},aH=class r{kind=2;_oldScrollWidth;_oldScrollLeft;_oldScrollHeight;_oldScrollTop;scrollWidth;scrollLeft;scrollHeight;scrollTop;scrollWidthChanged;scrollLeftChanged;scrollHeightChanged;scrollTopChanged;constructor(t,e,i,n,o,s,a,l){this._oldScrollWidth=t,this._oldScrollLeft=e,this._oldScrollHeight=i,this._oldScrollTop=n,this.scrollWidth=o,this.scrollLeft=s,this.scrollHeight=a,this.scrollTop=l,this.scrollWidthChanged=this._oldScrollWidth!==this.scrollWidth,this.scrollLeftChanged=this._oldScrollLeft!==this.scrollLeft,this.scrollHeightChanged=this._oldScrollHeight!==this.scrollHeight,this.scrollTopChanged=this._oldScrollTop!==this.scrollTop}isNoOp(){return!this.scrollWidthChanged&&!this.scrollLeftChanged&&!this.scrollHeightChanged&&!this.scrollTopChanged}attemptToMerge(t){return t.kind!==this.kind?null:new r(this._oldScrollWidth,this._oldScrollLeft,this._oldScrollHeight,this._oldScrollTop,t.scrollWidth,t.scrollLeft,t.scrollHeight,t.scrollTop)}},lH=class{kind=3;constructor(){}isNoOp(){return!1}attemptToMerge(t){return t.kind!==this.kind?null:this}},dH=class{kind=4;constructor(){}isNoOp(){return!1}attemptToMerge(t){return t.kind!==this.kind?null:this}},cH=class r{kind=6;oldSelections;selections;oldModelVersionId;modelVersionId;source;reason;reachedMaxCursorCount;constructor(t,e,i,n,o,s,a){this.oldSelections=t,this.selections=e,this.oldModelVersionId=i,this.modelVersionId=n,this.source=o,this.reason=s,this.reachedMaxCursorCount=a}static _selectionsAreEqual(t,e){if(!t&&!e)return!0;if(!t||!e)return!1;let i=t.length,n=e.length;if(i!==n)return!1;for(let o=0;o<i;o++)if(!t[o].equalsSelection(e[o]))return!1;return!0}isNoOp(){return r._selectionsAreEqual(this.oldSelections,this.selections)&&this.oldModelVersionId===this.modelVersionId}attemptToMerge(t){return t.kind!==this.kind?null:new r(this.oldSelections,t.selections,this.oldModelVersionId,t.modelVersionId,t.source,t.reason,this.reachedMaxCursorCount||t.reachedMaxCursorCount)}},uH=class{kind=5;constructor(){}isNoOp(){return!1}attemptToMerge(t){return t.kind!==this.kind?null:this}},pH=class{constructor(t){this.event=t}kind=7;isNoOp(){return!1}attemptToMerge(t){return null}},hH=class{constructor(t){this.event=t}kind=8;isNoOp(){return!1}attemptToMerge(t){return null}},mH=class{constructor(t){this.event=t}kind=9;isNoOp(){return!1}attemptToMerge(t){return null}},gH=class{constructor(t){this.event=t}kind=10;isNoOp(){return!1}attemptToMerge(t){return null}},fH=class{constructor(t){this.event=t}kind=11;isNoOp(){return!1}attemptToMerge(t){return null}},bH=class{constructor(t){this.event=t}kind=12;isNoOp(){return!1}attemptToMerge(t){return null}};var vH=class extends R{_model;_knownModelVersionId;_viewModel;_coordinatesConverter;context;_cursors;_hasFocus;_isHandling;_compositionState;_columnSelectData;_autoClosedActions;_prevEditOperationType;constructor(t,e,i,n){super(),this._model=t,this._knownModelVersionId=this._model.getVersionId(),this._viewModel=e,this._coordinatesConverter=i,this.context=new SR(this._model,this._viewModel,this._coordinatesConverter,n),this._cursors=new wR(this.context),this._hasFocus=!1,this._isHandling=!1,this._compositionState=null,this._columnSelectData=null,this._autoClosedActions=[],this._prevEditOperationType=0}dispose(){this._cursors.dispose(),this._autoClosedActions=_e(this._autoClosedActions),super.dispose()}updateConfiguration(t){this.context=new SR(this._model,this._viewModel,this._coordinatesConverter,t),this._cursors.updateContext(this.context)}onLineMappingChanged(t){this._knownModelVersionId===this._model.getVersionId()&&this.setStates(t,"viewModel",0,this.getCursorStates())}setHasFocus(t){this._hasFocus=t}_validateAutoClosedActions(){if(this._autoClosedActions.length>0){let t=this._cursors.getSelections();for(let e=0;e<this._autoClosedActions.length;e++){let i=this._autoClosedActions[e];i.isValid(t)||(i.dispose(),this._autoClosedActions.splice(e,1),e--)}}}getPrimaryCursorState(){return this._cursors.getPrimaryCursor()}getLastAddedCursorIndex(){return this._cursors.getLastAddedCursorIndex()}getCursorStates(){return this._cursors.getAll()}setStates(t,e,i,n){let o=!1,s=this.context.cursorConfig.multiCursorLimit;n!==null&&n.length>s&&(n=n.slice(0,s),o=!0);let a=ER.from(this._model,this);return this._cursors.setStates(n),this._cursors.normalize(),this._columnSelectData=null,this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(t,e,i,a,o)}setCursorColumnSelectData(t){this._columnSelectData=t}revealAll(t,e,i,n,o,s){let a=this._cursors.getViewPositions(),l=null,d=null;a.length>1?d=this._cursors.getViewSelections():l=L.fromPositions(a[0],a[0]),t.emitViewEvent(new Om(e,i,l,d,n,o,s))}revealPrimary(t,e,i,n,o,s){let l=[this._cursors.getPrimaryCursor().viewState.selection];t.emitViewEvent(new Om(e,i,null,l,n,o,s))}saveState(){let t=[],e=this._cursors.getSelections();for(let i=0,n=e.length;i<n;i++){let o=e[i];t.push({inSelectionMode:!o.isEmpty(),selectionStart:{lineNumber:o.selectionStartLineNumber,column:o.selectionStartColumn},position:{lineNumber:o.positionLineNumber,column:o.positionColumn}})}return t}restoreState(t,e){let i=[];for(let n=0,o=e.length;n<o;n++){let s=e[n],a=1,l=1;s.position&&s.position.lineNumber&&(a=s.position.lineNumber),s.position&&s.position.column&&(l=s.position.column);let d=a,c=l;s.selectionStart&&s.selectionStart.lineNumber&&(d=s.selectionStart.lineNumber),s.selectionStart&&s.selectionStart.column&&(c=s.selectionStart.column),i.push({selectionStartLineNumber:d,selectionStartColumn:c,positionLineNumber:a,positionColumn:l})}this.setStates(t,"restoreState",0,Zt.fromModelSelections(i)),this.revealAll(t,"restoreState",!1,0,!0,1)}onModelContentChanged(t,e){if(e instanceof xC){if(this._isHandling)return;this._isHandling=!0;try{this.setStates(t,"modelChange",0,this.getCursorStates())}finally{this._isHandling=!1}}else{let i=e.rawContentChangedEvent;if(this._knownModelVersionId=i.versionId,this._isHandling)return;let n=i.containsEvent(1);if(this._prevEditOperationType=0,n)this._cursors.dispose(),this._cursors=new wR(this.context),this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(t,"model",1,null,!1);else if(this._hasFocus&&i.resultingSelection&&i.resultingSelection.length>0){let o=Zt.fromModelSelections(i.resultingSelection);this.setStates(t,"modelChange",i.isUndoing?5:i.isRedoing?6:2,o)&&this.revealAll(t,"modelChange",!1,0,!0,0)}else{let o=this._cursors.readSelectionFromMarkers();this.setStates(t,"modelChange",2,Zt.fromModelSelections(o))}}}getSelection(){return this._cursors.getPrimaryCursor().modelState.selection}getTopMostViewPosition(){return this._cursors.getTopMostViewPosition()}getBottomMostViewPosition(){return this._cursors.getBottomMostViewPosition()}getCursorColumnSelectData(){if(this._columnSelectData)return this._columnSelectData;let t=this._cursors.getPrimaryCursor(),e=t.viewState.selectionStart.getStartPosition(),i=t.viewState.position;return{isReal:!1,fromViewLineNumber:e.lineNumber,fromViewVisualColumn:this.context.cursorConfig.visibleColumnFromColumn(this._viewModel,e),toViewLineNumber:i.lineNumber,toViewVisualColumn:this.context.cursorConfig.visibleColumnFromColumn(this._viewModel,i)}}getSelections(){return this._cursors.getSelections()}getPosition(){return this._cursors.getPrimaryCursor().modelState.position}setSelections(t,e,i,n){this.setStates(t,e,n,Zt.fromModelSelections(i))}getPrevEditOperationType(){return this._prevEditOperationType}setPrevEditOperationType(t){this._prevEditOperationType=t}_pushAutoClosedAction(t,e){let i=[],n=[];for(let a=0,l=t.length;a<l;a++)i.push({range:t[a],options:{description:"auto-closed-character",inlineClassName:"auto-closed-character",stickiness:1}}),n.push({range:e[a],options:{description:"auto-closed-enclosing",stickiness:1}});let o=this._model.deltaDecorations([],i),s=this._model.deltaDecorations([],n);this._autoClosedActions.push(new IH(this._model,o,s))}_executeEditOperation(t){if(!t)return;t.shouldPushStackElementBefore&&this._model.pushStackElement();let e=w$.executeCommands(this._model,this._cursors.getSelections(),t.commands);if(e){this._interpretCommandResult(e);let i=[],n=[];for(let o=0;o<t.commands.length;o++){let s=t.commands[o];s instanceof WE&&s.enclosingRange&&s.closeCharacterRange&&(i.push(s.closeCharacterRange),n.push(s.enclosingRange))}i.length>0&&this._pushAutoClosedAction(i,n),this._prevEditOperationType=t.type}t.shouldPushStackElementAfter&&this._model.pushStackElement()}_interpretCommandResult(t){(!t||t.length===0)&&(t=this._cursors.readSelectionFromMarkers()),this._columnSelectData=null,this._cursors.setSelections(t),this._cursors.normalize()}_emitStateChangedIfNecessary(t,e,i,n,o){let s=ER.from(this._model,this);if(s.equals(n))return!1;let a=this._cursors.getSelections(),l=this._cursors.getViewSelections();if(t.emitViewEvent(new M0(l,a,i)),!n||n.cursorState.length!==s.cursorState.length||s.cursorState.some((d,c)=>!d.modelState.equals(n.cursorState[c].modelState))){let d=n?n.cursorState.map(p=>p.modelState.selection):null,c=n?n.modelVersionId:0;t.emitOutgoingEvent(new cH(d,a,c,s.modelVersionId,e||"keyboard",i,o))}return!0}_findAutoClosingPairs(t){if(!t.length)return null;let e=[];for(let i=0,n=t.length;i<n;i++){let o=t[i];if(!o.text||o.text.indexOf(`
`)>=0)return null;let s=o.text.match(/([)\]}>'"`])([^)\]}>'"`]*)$/);if(!s)return null;let a=s[1],l=this.context.cursorConfig.autoClosingPairs.autoClosingPairsCloseSingleChar.get(a);if(!l||l.length!==1)return null;let d=l[0].open,c=o.text.length-s[2].length-1,p=o.text.lastIndexOf(d,c-1);if(p===-1)return null;e.push([p,c])}return e}executeEdits(t,e,i,n){let o=null;e==="snippet"&&(o=this._findAutoClosingPairs(i)),o&&(i[0]._isTracked=!0);let s=[],a=[],l=this._model.pushEditOperations(this.getSelections(),i,d=>{if(o)for(let p=0,h=o.length;p<h;p++){let[m,f]=o[p],g=d[p],v=g.range.startLineNumber,I=g.range.startColumn-1+m,y=g.range.startColumn-1+f;s.push(new L(v,y+1,v,y+2)),a.push(new L(v,I+1,v,y+2))}let c=n(d);return c&&(this._isHandling=!0),c});l&&(this._isHandling=!1,this.setSelections(t,e,l,0)),s.length>0&&this._pushAutoClosedAction(s,a)}_executeEdit(t,e,i,n=0){if(this.context.cursorConfig.readOnly)return;let o=ER.from(this._model,this);this._cursors.stopTrackingSelections(),this._isHandling=!0;try{this._cursors.ensureValidState(),t()}catch(s){Xe(s)}this._isHandling=!1,this._cursors.startTrackingSelections(),this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(e,i,n,o,!1)&&this.revealAll(e,i,!1,0,!0,0)}getAutoClosedCharacters(){return IH.getAllAutoClosedCharacters(this._autoClosedActions)}startComposition(t){this._compositionState=new x$(this._model,this.getSelections())}endComposition(t,e){let i=this._compositionState?this._compositionState.deduceOutcome(this._model,this.getSelections()):null;this._compositionState=null,this._executeEdit(()=>{e==="keyboard"&&this._executeEditOperation(Fu.compositionEndWithInterceptors(this._prevEditOperationType,this.context.cursorConfig,this._model,i,this.getSelections(),this.getAutoClosedCharacters()))},t,e)}type(t,e,i){this._executeEdit(()=>{if(i==="keyboard"){let n=e.length,o=0;for(;o<n;){let s=W_(e,o),a=e.substr(o,s);this._executeEditOperation(Fu.typeWithInterceptors(!!this._compositionState,this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),this.getAutoClosedCharacters(),a)),o+=s}}else this._executeEditOperation(Fu.typeWithoutInterceptors(this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),e))},t,i)}compositionType(t,e,i,n,o,s){if(e.length===0&&i===0&&n===0){if(o!==0){let a=this.getSelections().map(l=>{let d=l.getPosition();return new Et(d.lineNumber,d.column+o,d.lineNumber,d.column+o)});this.setSelections(t,s,a,0)}return}this._executeEdit(()=>{this._executeEditOperation(Fu.compositionType(this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),e,i,n,o))},t,s)}paste(t,e,i,n,o){this._executeEdit(()=>{this._executeEditOperation(Fu.paste(this.context.cursorConfig,this._model,this.getSelections(),e,i,n||[]))},t,o,4)}cut(t,e){this._executeEdit(()=>{this._executeEditOperation(ug.cut(this.context.cursorConfig,this._model,this.getSelections()))},t,e)}executeCommand(t,e,i){this._executeEdit(()=>{this._cursors.killSecondaryCursors(),this._executeEditOperation(new hr(0,[e],{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!1}))},t,i)}executeCommands(t,e,i){this._executeEdit(()=>{this._executeEditOperation(new hr(0,e,{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!1}))},t,i)}},ER=class r{constructor(t,e){this.modelVersionId=t;this.cursorState=e}static from(t,e){return new r(t.getVersionId(),e.getCursorStates())}equals(t){if(!t||this.modelVersionId!==t.modelVersionId||this.cursorState.length!==t.cursorState.length)return!1;for(let e=0,i=this.cursorState.length;e<i;e++)if(!this.cursorState[e].equals(t.cursorState[e]))return!1;return!0}},IH=class{static getAllAutoClosedCharacters(t){let e=[];for(let i of t)e=e.concat(i.getAutoClosedCharactersRanges());return e}_model;_autoClosedCharactersDecorations;_autoClosedEnclosingDecorations;constructor(t,e,i){this._model=t,this._autoClosedCharactersDecorations=e,this._autoClosedEnclosingDecorations=i}dispose(){this._autoClosedCharactersDecorations=this._model.deltaDecorations(this._autoClosedCharactersDecorations,[]),this._autoClosedEnclosingDecorations=this._model.deltaDecorations(this._autoClosedEnclosingDecorations,[])}getAutoClosedCharactersRanges(){let t=[];for(let e=0;e<this._autoClosedCharactersDecorations.length;e++){let i=this._model.getDecorationRange(this._autoClosedCharactersDecorations[e]);i&&t.push(i)}return t}isValid(t){let e=[];for(let i=0;i<this._autoClosedEnclosingDecorations.length;i++){let n=this._model.getDecorationRange(this._autoClosedEnclosingDecorations[i]);if(n&&(e.push(n),n.startLineNumber!==n.endLineNumber))return!1}e.sort(L.compareRangesUsingStarts),t.sort(L.compareRangesUsingStarts);for(let i=0;i<t.length;i++)if(i>=e.length||!e[i].strictContainsRange(t[i]))return!1;return!0}},w$=class{static executeCommands(t,e,i){let n={model:t,selectionsBefore:e,trackedRanges:[],trackedRangesDirection:[]},o=this._innerExecuteCommands(n,i);for(let s=0,a=n.trackedRanges.length;s<a;s++)n.model._setTrackedRange(n.trackedRanges[s],null,0);return o}static _innerExecuteCommands(t,e){if(this._arrayIsEmpty(e))return null;let i=this._getEditOperations(t,e);if(i.operations.length===0)return null;let n=i.operations,o=this._getLoserCursorMap(n);if(o.hasOwnProperty("0"))return console.warn("Ignoring commands"),null;let s=[];for(let d=0,c=n.length;d<c;d++)o.hasOwnProperty(n[d].identifier.major.toString())||s.push(n[d]);i.hadTrackedEditOperation&&s.length>0&&(s[0]._isTracked=!0);let a=t.model.pushEditOperations(t.selectionsBefore,s,d=>{let c=[];for(let m=0;m<t.selectionsBefore.length;m++)c[m]=[];for(let m of d)m.identifier&&c[m.identifier.major].push(m);let p=(m,f)=>m.identifier.minor-f.identifier.minor,h=[];for(let m=0;m<t.selectionsBefore.length;m++)c[m].length>0?(c[m].sort(p),h[m]=e[m].computeCursorState(t.model,{getInverseEditOperations:()=>c[m],getTrackedSelection:f=>{let g=parseInt(f,10),v=t.model._getTrackedRange(t.trackedRanges[g]);return t.trackedRangesDirection[g]===0?new Et(v.startLineNumber,v.startColumn,v.endLineNumber,v.endColumn):new Et(v.endLineNumber,v.endColumn,v.startLineNumber,v.startColumn)}})):h[m]=t.selectionsBefore[m];return h});a||(a=t.selectionsBefore);let l=[];for(let d in o)o.hasOwnProperty(d)&&l.push(parseInt(d,10));l.sort((d,c)=>c-d);for(let d of l)a.splice(d,1);return a}static _arrayIsEmpty(t){for(let e=0,i=t.length;e<i;e++)if(t[e])return!1;return!0}static _getEditOperations(t,e){let i=[],n=!1;for(let o=0,s=e.length;o<s;o++){let a=e[o];if(a){let l=this._getEditOperationsFromCommand(t,o,a);i=i.concat(l.operations),n=n||l.hadTrackedEditOperation}}return{operations:i,hadTrackedEditOperation:n}}static _getEditOperationsFromCommand(t,e,i){let n=[],o=0,s=(p,h,m=!1)=>{L.isEmpty(p)&&h===""||n.push({identifier:{major:e,minor:o++},range:p,text:h,forceMoveMarkers:m,isAutoWhitespaceEdit:i.insertsAutoWhitespace})},a=!1,c={addEditOperation:s,addTrackedEditOperation:(p,h,m)=>{a=!0,s(p,h,m)},trackSelection:(p,h)=>{let m=Et.liftSelection(p),f;if(m.isEmpty())if(typeof h=="boolean")h?f=2:f=3;else{let I=t.model.getLineMaxColumn(m.startLineNumber);m.startColumn===I?f=2:f=3}else f=1;let g=t.trackedRanges.length,v=t.model._setTrackedRange(null,m,f);return t.trackedRanges[g]=v,t.trackedRangesDirection[g]=m.getDirection(),g.toString()}};try{i.getEditOperations(t.model,c)}catch(p){return Xe(p),{operations:[],hadTrackedEditOperation:!1}}return{operations:n,hadTrackedEditOperation:a}}static _getLoserCursorMap(t){t=t.slice(0),t.sort((i,n)=>-L.compareRangesUsingEnds(i.range,n.range));let e={};for(let i=1;i<t.length;i++){let n=t[i-1],o=t[i];if(L.getStartPosition(n.range).isBefore(L.getEndPosition(o.range))){let s;n.identifier.major>o.identifier.major?s=n.identifier.major:s=o.identifier.major,e[s.toString()]=!0;for(let a=0;a<t.length;a++)t[a].identifier.major===s&&(t.splice(a,1),a<i&&i--,a--);i>0&&i--}}return e}},E$=class{constructor(t,e,i){this.text=t;this.startSelection=e;this.endSelection=i}},x$=class r{_original;static _capture(t,e){let i=[];for(let n of e){if(n.startLineNumber!==n.endLineNumber)return null;i.push(new E$(t.getLineContent(n.startLineNumber),n.startColumn-1,n.endColumn-1))}return i}constructor(t,e){this._original=r._capture(t,e)}deduceOutcome(t,e){if(!this._original)return null;let i=r._capture(t,e);if(!i||this._original.length!==i.length)return null;let n=[];for(let o=0,s=this._original.length;o<s;o++)n.push(r._deduceOutcome(this._original[o],i[o]));return n}static _deduceOutcome(t,e){let i=Math.min(t.startSelection,e.startSelection,bd(t.text,e.text)),n=Math.min(t.text.length-t.endSelection,e.text.length-e.endSelection,Gv(t.text,e.text)),o=t.text.substring(i,t.text.length-n),s=e.text.substring(i,e.text.length-n);return new pW(o,t.startSelection-i,t.endSelection-i,s,e.startSelection-i,e.endSelection-i)}};var zce={getInitialState:()=>I3,tokenizeEncoded:(r,t,e)=>LN(0,e)};async function Gce(r,t,e){if(!e)return Kce(t,r.languageIdCodec,zce);let i=await Is.getOrCreate(e);return Kce(t,r.languageIdCodec,i||zce)}function qce(r,t,e,i,n,o,s){let a="<div>",l=i,d=0,c=!0;for(let p=0,h=t.getCount();p<h;p++){let m=t.getEndOffset(p);if(m<=i)continue;let f="";for(;l<m&&l<n;l++){let g=r.charCodeAt(l);switch(g){case 9:{let v=o-(l+d)%o;for(d+=v-1;v>0;)s&&c?(f+="&#160;",c=!1):(f+=" ",c=!0),v--;break}case 60:f+="&lt;",c=!1;break;case 62:f+="&gt;",c=!1;break;case 38:f+="&amp;",c=!1;break;case 0:f+="&#00;",c=!1;break;case 65279:case 8232:case 8233:case 133:f+="\uFFFD",c=!1;break;case 13:f+="&#8203",c=!1;break;case 32:s&&c?(f+="&#160;",c=!1):(f+=" ",c=!0);break;default:f+=String.fromCharCode(g),c=!1}}if(a+=`<span style="${t.getInlineStyle(p,e)}">${f}</span>`,m>n||l>=n)break}return a+="</div>",a}function Kce(r,t,e){let i='<div class="monaco-tokenized-source">',n=Xc(r),o=e.getInitialState();for(let s=0,a=n.length;s<a;s++){let l=n[s];s>0&&(i+="<br/>");let d=e.tokenizeEncoded(l,!0,o);io.convertToEndOffset(d.tokens,l.length);let p=new io(d.tokens,l,t).inflate(),h=0;for(let m=0,f=p.getCount();m<f;m++){let g=p.getClassName(m),v=p.getEndOffset(m);i+=`<span class="${g}">${Cp(l.substring(h,v))}</span>`,h=v}o=d.endState}return i+="</div>",i}var T$=class{_hasPending;_inserts;_changes;_removes;constructor(){this._hasPending=!1,this._inserts=[],this._changes=[],this._removes=[]}insert(t){this._hasPending=!0,this._inserts.push(t)}change(t){this._hasPending=!0,this._changes.push(t)}remove(t){this._hasPending=!0,this._removes.push(t)}mustCommit(){return this._hasPending}commit(t){if(!this._hasPending)return;let e=this._inserts,i=this._changes,n=this._removes;this._hasPending=!1,this._inserts=[],this._changes=[],this._removes=[],t._commitPendingChanges(e,i,n)}},_$=class{id;afterLineNumber;ordinal;height;minWidth;prefixSum;constructor(t,e,i,n,o){this.id=t,this.afterLineNumber=e,this.ordinal=i,this.height=n,this.minWidth=o,this.prefixSum=0}},yH=class r{static INSTANCE_COUNT=0;_instanceId;_pendingChanges;_lastWhitespaceId;_arr;_prefixSumValidIndex;_minWidth;_lineCount;_lineHeight;_paddingTop;_paddingBottom;constructor(t,e,i,n){this._instanceId=vA(++r.INSTANCE_COUNT),this._pendingChanges=new T$,this._lastWhitespaceId=0,this._arr=[],this._prefixSumValidIndex=-1,this._minWidth=-1,this._lineCount=t,this._lineHeight=e,this._paddingTop=i,this._paddingBottom=n}static findInsertionIndex(t,e,i){let n=0,o=t.length;for(;n<o;){let s=n+o>>>1;e===t[s].afterLineNumber?i<t[s].ordinal?o=s:n=s+1:e<t[s].afterLineNumber?o=s:n=s+1}return n}setLineHeight(t){this._checkPendingChanges(),this._lineHeight=t}setPadding(t,e){this._paddingTop=t,this._paddingBottom=e}onFlushed(t){this._checkPendingChanges(),this._lineCount=t}changeWhitespace(t){let e=!1;try{t({insertWhitespace:(n,o,s,a)=>{e=!0,n=n|0,o=o|0,s=s|0,a=a|0;let l=this._instanceId+ ++this._lastWhitespaceId;return this._pendingChanges.insert(new _$(l,n,o,s,a)),l},changeOneWhitespace:(n,o,s)=>{e=!0,o=o|0,s=s|0,this._pendingChanges.change({id:n,newAfterLineNumber:o,newHeight:s})},removeWhitespace:n=>{e=!0,this._pendingChanges.remove({id:n})}})}finally{this._pendingChanges.commit(this)}return e}_commitPendingChanges(t,e,i){if((t.length>0||i.length>0)&&(this._minWidth=-1),t.length+e.length+i.length<=1){for(let l of t)this._insertWhitespace(l);for(let l of e)this._changeOneWhitespace(l.id,l.newAfterLineNumber,l.newHeight);for(let l of i){let d=this._findWhitespaceIndex(l.id);d!==-1&&this._removeWhitespace(d)}return}let n=new Set;for(let l of i)n.add(l.id);let o=new Map;for(let l of e)o.set(l.id,l);let s=l=>{let d=[];for(let c of l)if(!n.has(c.id)){if(o.has(c.id)){let p=o.get(c.id);c.afterLineNumber=p.newAfterLineNumber,c.height=p.newHeight}d.push(c)}return d},a=s(this._arr).concat(s(t));a.sort((l,d)=>l.afterLineNumber===d.afterLineNumber?l.ordinal-d.ordinal:l.afterLineNumber-d.afterLineNumber),this._arr=a,this._prefixSumValidIndex=-1}_checkPendingChanges(){this._pendingChanges.mustCommit()&&this._pendingChanges.commit(this)}_insertWhitespace(t){let e=r.findInsertionIndex(this._arr,t.afterLineNumber,t.ordinal);this._arr.splice(e,0,t),this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,e-1)}_findWhitespaceIndex(t){let e=this._arr;for(let i=0,n=e.length;i<n;i++)if(e[i].id===t)return i;return-1}_changeOneWhitespace(t,e,i){let n=this._findWhitespaceIndex(t);if(n!==-1&&(this._arr[n].height!==i&&(this._arr[n].height=i,this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,n-1)),this._arr[n].afterLineNumber!==e)){let o=this._arr[n];this._removeWhitespace(n),o.afterLineNumber=e,this._insertWhitespace(o)}}_removeWhitespace(t){this._arr.splice(t,1),this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,t-1)}onLinesDeleted(t,e){this._checkPendingChanges(),t=t|0,e=e|0,this._lineCount-=e-t+1;for(let i=0,n=this._arr.length;i<n;i++){let o=this._arr[i].afterLineNumber;t<=o&&o<=e?this._arr[i].afterLineNumber=t-1:o>e&&(this._arr[i].afterLineNumber-=e-t+1)}}onLinesInserted(t,e){this._checkPendingChanges(),t=t|0,e=e|0,this._lineCount+=e-t+1;for(let i=0,n=this._arr.length;i<n;i++){let o=this._arr[i].afterLineNumber;t<=o&&(this._arr[i].afterLineNumber+=e-t+1)}}getWhitespacesTotalHeight(){return this._checkPendingChanges(),this._arr.length===0?0:this.getWhitespacesAccumulatedHeight(this._arr.length-1)}getWhitespacesAccumulatedHeight(t){this._checkPendingChanges(),t=t|0;let e=Math.max(0,this._prefixSumValidIndex+1);e===0&&(this._arr[0].prefixSum=this._arr[0].height,e++);for(let i=e;i<=t;i++)this._arr[i].prefixSum=this._arr[i-1].prefixSum+this._arr[i].height;return this._prefixSumValidIndex=Math.max(this._prefixSumValidIndex,t),this._arr[t].prefixSum}getLinesTotalHeight(){this._checkPendingChanges();let t=this._lineHeight*this._lineCount,e=this.getWhitespacesTotalHeight();return t+e+this._paddingTop+this._paddingBottom}getWhitespaceAccumulatedHeightBeforeLineNumber(t){this._checkPendingChanges(),t=t|0;let e=this._findLastWhitespaceBeforeLineNumber(t);return e===-1?0:this.getWhitespacesAccumulatedHeight(e)}_findLastWhitespaceBeforeLineNumber(t){t=t|0;let e=this._arr,i=0,n=e.length-1;for(;i<=n;){let s=(n-i|0)/2|0,a=i+s|0;if(e[a].afterLineNumber<t){if(a+1>=e.length||e[a+1].afterLineNumber>=t)return a;i=a+1|0}else n=a-1|0}return-1}_findFirstWhitespaceAfterLineNumber(t){t=t|0;let i=this._findLastWhitespaceBeforeLineNumber(t)+1;return i<this._arr.length?i:-1}getFirstWhitespaceIndexAfterLineNumber(t){return this._checkPendingChanges(),t=t|0,this._findFirstWhitespaceAfterLineNumber(t)}getVerticalOffsetForLineNumber(t,e=!1){this._checkPendingChanges(),t=t|0;let i;t>1?i=this._lineHeight*(t-1):i=0;let n=this.getWhitespaceAccumulatedHeightBeforeLineNumber(t-(e?1:0));return i+n+this._paddingTop}getVerticalOffsetAfterLineNumber(t,e=!1){this._checkPendingChanges(),t=t|0;let i=this._lineHeight*t,n=this.getWhitespaceAccumulatedHeightBeforeLineNumber(t+(e?1:0));return i+n+this._paddingTop}hasWhitespace(){return this._checkPendingChanges(),this.getWhitespacesCount()>0}getWhitespaceMinWidth(){if(this._checkPendingChanges(),this._minWidth===-1){let t=0;for(let e=0,i=this._arr.length;e<i;e++)t=Math.max(t,this._arr[e].minWidth);this._minWidth=t}return this._minWidth}isAfterLines(t){this._checkPendingChanges();let e=this.getLinesTotalHeight();return t>e}isInTopPadding(t){return this._paddingTop===0?!1:(this._checkPendingChanges(),t<this._paddingTop)}isInBottomPadding(t){if(this._paddingBottom===0)return!1;this._checkPendingChanges();let e=this.getLinesTotalHeight();return t>=e-this._paddingBottom}getLineNumberAtOrAfterVerticalOffset(t){if(this._checkPendingChanges(),t=t|0,t<0)return 1;let e=this._lineCount|0,i=this._lineHeight,n=1,o=e;for(;n<o;){let s=(n+o)/2|0,a=this.getVerticalOffsetForLineNumber(s)|0;if(t>=a+i)n=s+1;else{if(t>=a)return s;o=s}}return n>e?e:n}getLinesViewportData(t,e){this._checkPendingChanges(),t=t|0,e=e|0;let i=this._lineHeight,n=this.getLineNumberAtOrAfterVerticalOffset(t)|0,o=this.getVerticalOffsetForLineNumber(n)|0,s=this._lineCount|0,a=this.getFirstWhitespaceIndexAfterLineNumber(n)|0,l=this.getWhitespacesCount()|0,d,c;a===-1?(a=l,c=s+1,d=0):(c=this.getAfterLineNumberForWhitespaceIndex(a)|0,d=this.getHeightForWhitespaceIndex(a)|0);let p=o,h=p,m=5e5,f=0;o>=m&&(f=Math.floor(o/m)*m,f=Math.floor(f/i)*i,h-=f);let g=[],v=t+(e-t)/2,I=-1;for(let S=n;S<=s;S++){if(I===-1){let D=p,k=p+i;(D<=v&&v<k||D>v)&&(I=S)}for(p+=i,g[S-n]=h,h+=i;c===S;)h+=d,p+=d,a++,a>=l?c=s+1:(c=this.getAfterLineNumberForWhitespaceIndex(a)|0,d=this.getHeightForWhitespaceIndex(a)|0);if(p>=e){s=S;break}}I===-1&&(I=s);let y=this.getVerticalOffsetForLineNumber(s)|0,w=n,C=s;return w<C&&o<t&&w++,w<C&&y+i>e&&C--,{bigNumbersDelta:f,startLineNumber:n,endLineNumber:s,relativeVerticalOffset:g,centeredLineNumber:I,completelyVisibleStartLineNumber:w,completelyVisibleEndLineNumber:C,lineHeight:this._lineHeight}}getVerticalOffsetForWhitespaceIndex(t){this._checkPendingChanges(),t=t|0;let e=this.getAfterLineNumberForWhitespaceIndex(t),i;e>=1?i=this._lineHeight*e:i=0;let n;return t>0?n=this.getWhitespacesAccumulatedHeight(t-1):n=0,i+n+this._paddingTop}getWhitespaceIndexAtOrAfterVerticallOffset(t){this._checkPendingChanges(),t=t|0;let e=0,i=this.getWhitespacesCount()-1;if(i<0)return-1;let n=this.getVerticalOffsetForWhitespaceIndex(i),o=this.getHeightForWhitespaceIndex(i);if(t>=n+o)return-1;for(;e<i;){let s=Math.floor((e+i)/2),a=this.getVerticalOffsetForWhitespaceIndex(s),l=this.getHeightForWhitespaceIndex(s);if(t>=a+l)e=s+1;else{if(t>=a)return s;i=s}}return e}getWhitespaceAtVerticalOffset(t){this._checkPendingChanges(),t=t|0;let e=this.getWhitespaceIndexAtOrAfterVerticallOffset(t);if(e<0||e>=this.getWhitespacesCount())return null;let i=this.getVerticalOffsetForWhitespaceIndex(e);if(i>t)return null;let n=this.getHeightForWhitespaceIndex(e),o=this.getIdForWhitespaceIndex(e),s=this.getAfterLineNumberForWhitespaceIndex(e);return{id:o,afterLineNumber:s,verticalOffset:i,height:n}}getWhitespaceViewportData(t,e){this._checkPendingChanges(),t=t|0,e=e|0;let i=this.getWhitespaceIndexAtOrAfterVerticallOffset(t),n=this.getWhitespacesCount()-1;if(i<0)return[];let o=[];for(let s=i;s<=n;s++){let a=this.getVerticalOffsetForWhitespaceIndex(s),l=this.getHeightForWhitespaceIndex(s);if(a>=e)break;o.push({id:this.getIdForWhitespaceIndex(s),afterLineNumber:this.getAfterLineNumberForWhitespaceIndex(s),verticalOffset:a,height:l})}return o}getWhitespaces(){return this._checkPendingChanges(),this._arr.slice(0)}getWhitespacesCount(){return this._checkPendingChanges(),this._arr.length}getIdForWhitespaceIndex(t){return this._checkPendingChanges(),t=t|0,this._arr[t].id}getAfterLineNumberForWhitespaceIndex(t){return this._checkPendingChanges(),t=t|0,this._arr[t].afterLineNumber}getHeightForWhitespaceIndex(t){return this._checkPendingChanges(),t=t|0,this._arr[t].height}};var ixe=125,Ly=class{width;contentWidth;scrollWidth;height;contentHeight;scrollHeight;constructor(t,e,i,n){t=t|0,e=e|0,i=i|0,n=n|0,t<0&&(t=0),e<0&&(e=0),i<0&&(i=0),n<0&&(n=0),this.width=t,this.contentWidth=e,this.scrollWidth=Math.max(t,e),this.height=i,this.contentHeight=n,this.scrollHeight=Math.max(i,n)}equals(t){return this.width===t.width&&this.contentWidth===t.contentWidth&&this.height===t.height&&this.contentHeight===t.contentHeight}},D$=class extends R{_scrollable;_dimensions;onDidScroll;_onDidContentSizeChange=this._register(new x);onDidContentSizeChange=this._onDidContentSizeChange.event;constructor(t,e){super(),this._dimensions=new Ly(0,0,0,0),this._scrollable=this._register(new iu({forceIntegerValues:!0,smoothScrollDuration:t,scheduleAtNextAnimationFrame:e})),this.onDidScroll=this._scrollable.onScroll}getScrollable(){return this._scrollable}setSmoothScrollDuration(t){this._scrollable.setSmoothScrollDuration(t)}validateScrollPosition(t){return this._scrollable.validateScrollPosition(t)}getScrollDimensions(){return this._dimensions}setScrollDimensions(t){if(this._dimensions.equals(t))return;let e=this._dimensions;this._dimensions=t,this._scrollable.setScrollDimensions({width:t.width,scrollWidth:t.scrollWidth,height:t.height,scrollHeight:t.scrollHeight},!0);let i=e.contentWidth!==t.contentWidth,n=e.contentHeight!==t.contentHeight;(i||n)&&this._onDidContentSizeChange.fire(new rH(e.contentWidth,e.contentHeight,t.contentWidth,t.contentHeight))}getFutureScrollPosition(){return this._scrollable.getFutureScrollPosition()}getCurrentScrollPosition(){return this._scrollable.getCurrentScrollPosition()}setScrollPositionNow(t){this._scrollable.setScrollPositionNow(t)}setScrollPositionSmooth(t){this._scrollable.setScrollPositionSmooth(t)}hasPendingScrollAnimation(){return this._scrollable.hasPendingScrollAnimation()}},SH=class extends R{_configuration;_linesLayout;_maxLineWidth;_overlayWidgetsMinWidth;_scrollable;onDidScroll;onDidContentSizeChange;constructor(t,e,i){super(),this._configuration=t;let n=this._configuration.options,o=n.get(147),s=n.get(85);this._linesLayout=new yH(e,n.get(68),s.top,s.bottom),this._maxLineWidth=0,this._overlayWidgetsMinWidth=0,this._scrollable=this._register(new D$(0,i)),this._configureSmoothScrollDuration(),this._scrollable.setScrollDimensions(new Ly(o.contentWidth,0,o.height,0)),this.onDidScroll=this._scrollable.onDidScroll,this.onDidContentSizeChange=this._scrollable.onDidContentSizeChange,this._updateHeight()}dispose(){super.dispose()}getScrollable(){return this._scrollable.getScrollable()}onHeightMaybeChanged(){this._updateHeight()}_configureSmoothScrollDuration(){this._scrollable.setSmoothScrollDuration(this._configuration.options.get(116)?ixe:0)}onConfigurationChanged(t){let e=this._configuration.options;if(t.hasChanged(68)&&this._linesLayout.setLineHeight(e.get(68)),t.hasChanged(85)){let i=e.get(85);this._linesLayout.setPadding(i.top,i.bottom)}if(t.hasChanged(147)){let i=e.get(147),n=i.contentWidth,o=i.height,s=this._scrollable.getScrollDimensions(),a=s.contentWidth;this._scrollable.setScrollDimensions(new Ly(n,s.contentWidth,o,this._getContentHeight(n,o,a)))}else this._updateHeight();t.hasChanged(116)&&this._configureSmoothScrollDuration()}onFlushed(t){this._linesLayout.onFlushed(t)}onLinesDeleted(t,e){this._linesLayout.onLinesDeleted(t,e)}onLinesInserted(t,e){this._linesLayout.onLinesInserted(t,e)}_getHorizontalScrollbarHeight(t,e){let n=this._configuration.options.get(105);return n.horizontal===2||t>=e?0:n.horizontalScrollbarSize}_getContentHeight(t,e,i){let n=this._configuration.options,o=this._linesLayout.getLinesTotalHeight();return n.get(107)?o+=Math.max(0,e-n.get(68)-n.get(85).bottom):n.get(105).ignoreHorizontalScrollbarInContentHeight||(o+=this._getHorizontalScrollbarHeight(t,i)),o}_updateHeight(){let t=this._scrollable.getScrollDimensions(),e=t.width,i=t.height,n=t.contentWidth;this._scrollable.setScrollDimensions(new Ly(e,t.contentWidth,i,this._getContentHeight(e,i,n)))}getCurrentViewport(){let t=this._scrollable.getScrollDimensions(),e=this._scrollable.getCurrentScrollPosition();return new lk(e.scrollTop,e.scrollLeft,t.width,t.height)}getFutureViewport(){let t=this._scrollable.getScrollDimensions(),e=this._scrollable.getFutureScrollPosition();return new lk(e.scrollTop,e.scrollLeft,t.width,t.height)}_computeContentWidth(){let t=this._configuration.options,e=this._maxLineWidth,i=t.get(148),n=t.get(51),o=t.get(147);if(i.isViewportWrapping){let s=t.get(74);return e>o.contentWidth+n.typicalHalfwidthCharacterWidth&&s.enabled&&s.side==="right"?e+o.verticalScrollbarWidth:e}else{let s=t.get(106)*n.typicalHalfwidthCharacterWidth,a=this._linesLayout.getWhitespaceMinWidth();return Math.max(e+s+o.verticalScrollbarWidth,a,this._overlayWidgetsMinWidth)}}setMaxLineWidth(t){this._maxLineWidth=t,this._updateContentWidth()}setOverlayWidgetsMinWidth(t){this._overlayWidgetsMinWidth=t,this._updateContentWidth()}_updateContentWidth(){let t=this._scrollable.getScrollDimensions();this._scrollable.setScrollDimensions(new Ly(t.width,this._computeContentWidth(),t.height,t.contentHeight)),this._updateHeight()}saveState(){let t=this._scrollable.getFutureScrollPosition(),e=t.scrollTop,i=this._linesLayout.getLineNumberAtOrAfterVerticalOffset(e),n=this._linesLayout.getWhitespaceAccumulatedHeightBeforeLineNumber(i);return{scrollTop:e,scrollTopWithoutViewZones:e-n,scrollLeft:t.scrollLeft}}changeWhitespace(t){let e=this._linesLayout.changeWhitespace(t);return e&&this.onHeightMaybeChanged(),e}getVerticalOffsetForLineNumber(t,e=!1){return this._linesLayout.getVerticalOffsetForLineNumber(t,e)}getVerticalOffsetAfterLineNumber(t,e=!1){return this._linesLayout.getVerticalOffsetAfterLineNumber(t,e)}isAfterLines(t){return this._linesLayout.isAfterLines(t)}isInTopPadding(t){return this._linesLayout.isInTopPadding(t)}isInBottomPadding(t){return this._linesLayout.isInBottomPadding(t)}getLineNumberAtVerticalOffset(t){return this._linesLayout.getLineNumberAtOrAfterVerticalOffset(t)}getWhitespaceAtVerticalOffset(t){return this._linesLayout.getWhitespaceAtVerticalOffset(t)}getLinesViewportData(){let t=this.getCurrentViewport();return this._linesLayout.getLinesViewportData(t.top,t.top+t.height)}getLinesViewportDataAtScrollTop(t){let e=this._scrollable.getScrollDimensions();return t+e.height>e.scrollHeight&&(t=e.scrollHeight-e.height),t<0&&(t=0),this._linesLayout.getLinesViewportData(t,t+e.height)}getWhitespaceViewportData(){let t=this.getCurrentViewport();return this._linesLayout.getWhitespaceViewportData(t.top,t.top+t.height)}getWhitespaces(){return this._linesLayout.getWhitespaces()}getContentWidth(){return this._scrollable.getScrollDimensions().contentWidth}getScrollWidth(){return this._scrollable.getScrollDimensions().scrollWidth}getContentHeight(){return this._scrollable.getScrollDimensions().contentHeight}getScrollHeight(){return this._scrollable.getScrollDimensions().scrollHeight}getCurrentScrollLeft(){return this._scrollable.getCurrentScrollPosition().scrollLeft}getCurrentScrollTop(){return this._scrollable.getCurrentScrollPosition().scrollTop}validateScrollPosition(t){return this._scrollable.validateScrollPosition(t)}setScrollPosition(t,e){e===1?this._scrollable.setScrollPositionNow(t):this._scrollable.setScrollPositionSmooth(t)}hasPendingScrollAnimation(){return this._scrollable.hasPendingScrollAnimation()}deltaScrollNow(t,e){let i=this._scrollable.getCurrentScrollPosition();this._scrollable.setScrollPositionNow({scrollLeft:i.scrollLeft+t,scrollTop:i.scrollTop+e})}};function EH(r,t){return r===null?t?CH.INSTANCE:wH.INSTANCE:new L$(r,t)}var L$=class{_projectionData;_isVisible;constructor(t,e){this._projectionData=t,this._isVisible=e}isVisible(){return this._isVisible}setVisible(t){return this._isVisible=t,this}getProjectionData(){return this._projectionData}getViewLineCount(){return this._isVisible?this._projectionData.getOutputLineCount():0}getViewLineContent(t,e,i){this._assertVisible();let n=i>0?this._projectionData.breakOffsets[i-1]:0,o=this._projectionData.breakOffsets[i],s;if(this._projectionData.injectionOffsets!==null){let a=this._projectionData.injectionOffsets.map((d,c)=>new ol(0,0,d+1,this._projectionData.injectionOptions[c],0));s=ol.applyInjectedText(t.getLineContent(e),a).substring(n,o)}else s=t.getValueInRange({startLineNumber:e,startColumn:n+1,endLineNumber:e,endColumn:o+1});return i>0&&(s=$ce(this._projectionData.wrappedTextIndentLength)+s),s}getViewLineLength(t,e,i){return this._assertVisible(),this._projectionData.getLineLength(i)}getViewLineMinColumn(t,e,i){return this._assertVisible(),this._projectionData.getMinOutputOffset(i)+1}getViewLineMaxColumn(t,e,i){return this._assertVisible(),this._projectionData.getMaxOutputOffset(i)+1}getViewLineData(t,e,i){let n=new Array;return this.getViewLinesData(t,e,i,1,0,[!0],n),n[0]}getViewLinesData(t,e,i,n,o,s,a){this._assertVisible();let l=this._projectionData,d=l.injectionOffsets,c=l.injectionOptions,p=null;if(d){p=[];let m=0,f=0;for(let g=0;g<l.getOutputLineCount();g++){let v=new Array;p[g]=v;let I=g>0?l.breakOffsets[g-1]:0,y=l.breakOffsets[g];for(;f<d.length;){let w=c[f].content.length,C=d[f]+m,S=C+w;if(C>y)break;if(I<S){let D=c[f];if(D.inlineClassName){let k=g>0?l.wrappedTextIndentLength:0,M=k+Math.max(C-I,0),O=k+Math.min(S-I,y-I);M!==O&&v.push(new U0(M,O,D.inlineClassName,D.inlineClassNameAffectsLetterSpacing))}}if(S<=y)m+=w,f++;else break}}}let h;if(d){let m=[];for(let f=0;f<d.length;f++){let g=d[f],v=c[f].tokens;v?v.forEach((I,y)=>{m.push({offset:g,text:I.substring(c[f].content),tokenMetadata:y.metadata})}):m.push({offset:g,text:c[f].content,tokenMetadata:io.defaultTokenMetadata})}h=t.tokenization.getLineTokens(e).withInserted(m)}else h=t.tokenization.getLineTokens(e);for(let m=i;m<i+n;m++){let f=o+m-i;if(!s[f]){a[f]=null;continue}a[f]=this._getViewLineData(h,p?p[m]:null,m)}}_getViewLineData(t,e,i){this._assertVisible();let n=this._projectionData,o=i>0?n.wrappedTextIndentLength:0,s=i>0?n.breakOffsets[i-1]:0,a=n.breakOffsets[i],l=t.sliceAndInflate(s,a,o),d=l.getLineContent();i>0&&(d=$ce(n.wrappedTextIndentLength)+d);let c=this._projectionData.getMinOutputOffset(i)+1,p=d.length+1,h=i+1<this.getViewLineCount(),m=i===0?0:n.breakOffsetsVisibleColumn[i-1];return new kI(d,h,c,p,m,l,e)}getModelColumnOfViewPosition(t,e){return this._assertVisible(),this._projectionData.translateToInputOffset(t,e-1)+1}getViewPositionOfModelPosition(t,e,i=2){return this._assertVisible(),this._projectionData.translateToOutputPosition(e-1,i).toPosition(t)}getViewLineNumberOfModelPosition(t,e){this._assertVisible();let i=this._projectionData.translateToOutputPosition(e-1);return t+i.outputLineIndex}normalizePosition(t,e,i){let n=e.lineNumber-t;return this._projectionData.normalizeOutputPosition(t,e.column-1,i).toPosition(n)}getInjectedTextAt(t,e){return this._projectionData.getInjectedText(t,e-1)}_assertVisible(){if(!this._isVisible)throw new Error("Not supported")}},CH=class r{static INSTANCE=new r;constructor(){}isVisible(){return!0}setVisible(t){return t?this:wH.INSTANCE}getProjectionData(){return null}getViewLineCount(){return 1}getViewLineContent(t,e,i){return t.getLineContent(e)}getViewLineLength(t,e,i){return t.getLineLength(e)}getViewLineMinColumn(t,e,i){return t.getLineMinColumn(e)}getViewLineMaxColumn(t,e,i){return t.getLineMaxColumn(e)}getViewLineData(t,e,i){let n=t.tokenization.getLineTokens(e),o=n.getLineContent();return new kI(o,!1,1,o.length+1,0,n.inflate(),null)}getViewLinesData(t,e,i,n,o,s,a){if(!s[o]){a[o]=null;return}a[o]=this.getViewLineData(t,e,0)}getModelColumnOfViewPosition(t,e){return e}getViewPositionOfModelPosition(t,e){return new H(t,e)}getViewLineNumberOfModelPosition(t,e){return t}normalizePosition(t,e,i){return e}getInjectedTextAt(t,e){return null}},wH=class r{static INSTANCE=new r;constructor(){}isVisible(){return!1}setVisible(t){return t?CH.INSTANCE:this}getProjectionData(){return null}getViewLineCount(){return 0}getViewLineContent(t,e,i){throw new Error("Not supported")}getViewLineLength(t,e,i){throw new Error("Not supported")}getViewLineMinColumn(t,e,i){throw new Error("Not supported")}getViewLineMaxColumn(t,e,i){throw new Error("Not supported")}getViewLineData(t,e,i){throw new Error("Not supported")}getViewLinesData(t,e,i,n,o,s,a){throw new Error("Not supported")}getModelColumnOfViewPosition(t,e){throw new Error("Not supported")}getViewPositionOfModelPosition(t,e){throw new Error("Not supported")}getViewLineNumberOfModelPosition(t,e){throw new Error("Not supported")}normalizePosition(t,e,i){throw new Error("Not supported")}getInjectedTextAt(t,e){throw new Error("Not supported")}},k$=[""];function $ce(r){if(r>=k$.length)for(let t=1;t<=r;t++)k$[t]=nxe(t);return k$[r]}function nxe(r){return new Array(r+1).join(" ")}var xH=class{_values;_isValid;_validEndIndex;_prefixSum;_indexBySum;constructor(t){this._values=t,this._isValid=!1,this._validEndIndex=-1,this._prefixSum=[],this._indexBySum=[]}getTotalSum(){return this._ensureValid(),this._indexBySum.length}getPrefixSum(t){return this._ensureValid(),t===0?0:this._prefixSum[t-1]}getIndexOf(t){this._ensureValid();let e=this._indexBySum[t],i=e>0?this._prefixSum[e-1]:0;return new R$(e,t-i)}removeValues(t,e){this._values.splice(t,e),this._invalidate(t)}insertValues(t,e){this._values=gp(this._values,t,e),this._invalidate(t)}_invalidate(t){this._isValid=!1,this._validEndIndex=Math.min(this._validEndIndex,t-1)}_ensureValid(){if(!this._isValid){for(let t=this._validEndIndex+1,e=this._values.length;t<e;t++){let i=this._values[t],n=t>0?this._prefixSum[t-1]:0;this._prefixSum[t]=n+i;for(let o=0;o<i;o++)this._indexBySum[n+o]=t}this._prefixSum.length=this._values.length,this._indexBySum.length=this._prefixSum[this._prefixSum.length-1],this._isValid=!0,this._validEndIndex=this._values.length-1}}setValue(t,e){this._values[t]!==e&&(this._values[t]=e,this._invalidate(t))}},R$=class{constructor(t,e){this.index=t;this.remainder=e;this.index=t,this.remainder=e}_prefixSumIndexOfResultBrand=void 0};var TH=class{_editorId;model;_validModelVersionId;_domLineBreaksComputerFactory;_monospaceLineBreaksComputerFactory;fontInfo;tabSize;wrappingColumn;wrappingIndent;wordBreak;wrappingStrategy;modelLineProjections;projectedModelLineLineCounts;hiddenAreasDecorationIds;constructor(t,e,i,n,o,s,a,l,d,c){this._editorId=t,this.model=e,this._validModelVersionId=-1,this._domLineBreaksComputerFactory=i,this._monospaceLineBreaksComputerFactory=n,this.fontInfo=o,this.tabSize=s,this.wrappingStrategy=a,this.wrappingColumn=l,this.wrappingIndent=d,this.wordBreak=c,this._constructLines(!0,null)}dispose(){this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,[])}createCoordinatesConverter(){return new P$(this)}_constructLines(t,e){this.modelLineProjections=[],t&&(this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,[]));let i=this.model.getLinesContent(),n=this.model.getInjectedTextDecorations(this._editorId),o=i.length,s=this.createLineBreaksComputer(),a=new Ms(ol.fromDecorations(n));for(let g=0;g<o;g++){let v=a.takeWhile(I=>I.lineNumber===g+1);s.addRequest(i[g],v,e?e[g]:null)}let l=s.finalize(),d=[],c=this.hiddenAreasDecorationIds.map(g=>this.model.getDecorationRange(g)).sort(L.compareRangesUsingStarts),p=1,h=0,m=-1,f=m+1<c.length?h+1:o+2;for(let g=0;g<o;g++){let v=g+1;v===f&&(m++,p=c[m].startLineNumber,h=c[m].endLineNumber,f=m+1<c.length?h+1:o+2);let I=v>=p&&v<=h,y=EH(l[g],!I);d[g]=y.getViewLineCount(),this.modelLineProjections[g]=y}this._validModelVersionId=this.model.getVersionId(),this.projectedModelLineLineCounts=new xH(d)}getHiddenAreas(){return this.hiddenAreasDecorationIds.map(t=>this.model.getDecorationRange(t))}setHiddenAreas(t){let e=t.map(h=>this.model.validateRange(h)),i=oxe(e),n=this.hiddenAreasDecorationIds.map(h=>this.model.getDecorationRange(h)).sort(L.compareRangesUsingStarts);if(i.length===n.length){let h=!1;for(let m=0;m<i.length;m++)if(!i[m].equalsRange(n[m])){h=!0;break}if(!h)return!1}let o=i.map(h=>({range:h,options:Ii.EMPTY}));this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,o);let s=i,a=1,l=0,d=-1,c=d+1<s.length?l+1:this.modelLineProjections.length+2,p=!1;for(let h=0;h<this.modelLineProjections.length;h++){let m=h+1;m===c&&(d++,a=s[d].startLineNumber,l=s[d].endLineNumber,c=d+1<s.length?l+1:this.modelLineProjections.length+2);let f=!1;if(m>=a&&m<=l?this.modelLineProjections[h].isVisible()&&(this.modelLineProjections[h]=this.modelLineProjections[h].setVisible(!1),f=!0):(p=!0,this.modelLineProjections[h].isVisible()||(this.modelLineProjections[h]=this.modelLineProjections[h].setVisible(!0),f=!0)),f){let g=this.modelLineProjections[h].getViewLineCount();this.projectedModelLineLineCounts.setValue(h,g)}}return p||this.setHiddenAreas([]),!0}modelPositionIsVisible(t,e){return t<1||t>this.modelLineProjections.length?!1:this.modelLineProjections[t-1].isVisible()}getModelLineViewLineCount(t){return t<1||t>this.modelLineProjections.length?1:this.modelLineProjections[t-1].getViewLineCount()}setTabSize(t){return this.tabSize===t?!1:(this.tabSize=t,this._constructLines(!1,null),!0)}setWrappingSettings(t,e,i,n,o){let s=this.fontInfo.equals(t),a=this.wrappingStrategy===e,l=this.wrappingColumn===i,d=this.wrappingIndent===n,c=this.wordBreak===o;if(s&&a&&l&&d&&c)return!1;let p=s&&a&&!l&&d&&c;this.fontInfo=t,this.wrappingStrategy=e,this.wrappingColumn=i,this.wrappingIndent=n,this.wordBreak=o;let h=null;if(p){h=[];for(let m=0,f=this.modelLineProjections.length;m<f;m++)h[m]=this.modelLineProjections[m].getProjectionData()}return this._constructLines(!1,h),!0}createLineBreaksComputer(){return(this.wrappingStrategy==="advanced"?this._domLineBreaksComputerFactory:this._monospaceLineBreaksComputerFactory).createLineBreaksComputer(this.fontInfo,this.tabSize,this.wrappingColumn,this.wrappingIndent,this.wordBreak)}onModelFlushed(){this._constructLines(!0,null)}onModelLinesDeleted(t,e,i){if(!t||t<=this._validModelVersionId)return null;let n=e===1?1:this.projectedModelLineLineCounts.getPrefixSum(e-1)+1,o=this.projectedModelLineLineCounts.getPrefixSum(i);return this.modelLineProjections.splice(e-1,i-e+1),this.projectedModelLineLineCounts.removeValues(e-1,i-e+1),new NC(n,o)}onModelLinesInserted(t,e,i,n){if(!t||t<=this._validModelVersionId)return null;let o=e>2&&!this.modelLineProjections[e-2].isVisible(),s=e===1?1:this.projectedModelLineLineCounts.getPrefixSum(e-1)+1,a=0,l=[],d=[];for(let c=0,p=n.length;c<p;c++){let h=EH(n[c],!o);l.push(h);let m=h.getViewLineCount();a+=m,d[c]=m}return this.modelLineProjections=this.modelLineProjections.slice(0,e-1).concat(l).concat(this.modelLineProjections.slice(e-1)),this.projectedModelLineLineCounts.insertValues(e-1,d),new FC(s,s+a-1)}onModelLineChanged(t,e,i){if(t!==null&&t<=this._validModelVersionId)return[!1,null,null,null];let n=e-1,o=this.modelLineProjections[n].getViewLineCount(),s=this.modelLineProjections[n].isVisible(),a=EH(i,s);this.modelLineProjections[n]=a;let l=this.modelLineProjections[n].getViewLineCount(),d=!1,c=0,p=-1,h=0,m=-1,f=0,g=-1;o>l?(c=this.projectedModelLineLineCounts.getPrefixSum(e-1)+1,p=c+l-1,f=p+1,g=f+(o-l)-1,d=!0):o<l?(c=this.projectedModelLineLineCounts.getPrefixSum(e-1)+1,p=c+o-1,h=p+1,m=h+(l-o)-1,d=!0):(c=this.projectedModelLineLineCounts.getPrefixSum(e-1)+1,p=c+l-1),this.projectedModelLineLineCounts.setValue(n,l);let v=c<=p?new ak(c,p-c+1):null,I=h<=m?new FC(h,m):null,y=f<=g?new NC(f,g):null;return[d,v,I,y]}acceptVersionId(t){this._validModelVersionId=t,this.modelLineProjections.length===1&&!this.modelLineProjections[0].isVisible()&&this.setHiddenAreas([])}getViewLineCount(){return this.projectedModelLineLineCounts.getTotalSum()}_toValidViewLineNumber(t){if(t<1)return 1;let e=this.getViewLineCount();return t>e?e:t|0}getActiveIndentGuide(t,e,i){t=this._toValidViewLineNumber(t),e=this._toValidViewLineNumber(e),i=this._toValidViewLineNumber(i);let n=this.convertViewPositionToModelPosition(t,this.getViewLineMinColumn(t)),o=this.convertViewPositionToModelPosition(e,this.getViewLineMinColumn(e)),s=this.convertViewPositionToModelPosition(i,this.getViewLineMinColumn(i)),a=this.model.guides.getActiveIndentGuide(n.lineNumber,o.lineNumber,s.lineNumber),l=this.convertModelPositionToViewPosition(a.startLineNumber,1),d=this.convertModelPositionToViewPosition(a.endLineNumber,this.model.getLineMaxColumn(a.endLineNumber));return{startLineNumber:l.lineNumber,endLineNumber:d.lineNumber,indent:a.indent}}getViewLineInfo(t){t=this._toValidViewLineNumber(t);let e=this.projectedModelLineLineCounts.getIndexOf(t-1),i=e.index,n=e.remainder;return new _H(i+1,n)}getMinColumnOfViewLine(t){return this.modelLineProjections[t.modelLineNumber-1].getViewLineMinColumn(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getMaxColumnOfViewLine(t){return this.modelLineProjections[t.modelLineNumber-1].getViewLineMaxColumn(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getModelStartPositionOfViewLine(t){let e=this.modelLineProjections[t.modelLineNumber-1],i=e.getViewLineMinColumn(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx),n=e.getModelColumnOfViewPosition(t.modelLineWrappedLineIdx,i);return new H(t.modelLineNumber,n)}getModelEndPositionOfViewLine(t){let e=this.modelLineProjections[t.modelLineNumber-1],i=e.getViewLineMaxColumn(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx),n=e.getModelColumnOfViewPosition(t.modelLineWrappedLineIdx,i);return new H(t.modelLineNumber,n)}getViewLineInfosGroupedByModelRanges(t,e){let i=this.getViewLineInfo(t),n=this.getViewLineInfo(e),o=new Array,s=this.getModelStartPositionOfViewLine(i),a=new Array;for(let l=i.modelLineNumber;l<=n.modelLineNumber;l++){let d=this.modelLineProjections[l-1];if(d.isVisible()){let c=l===i.modelLineNumber?i.modelLineWrappedLineIdx:0,p=l===n.modelLineNumber?n.modelLineWrappedLineIdx+1:d.getViewLineCount();for(let h=c;h<p;h++)a.push(new _H(l,h))}if(!d.isVisible()&&s){let c=new H(l-1,this.model.getLineMaxColumn(l-1)+1),p=L.fromPositions(s,c);o.push(new DH(p,a)),a=[],s=null}else d.isVisible()&&!s&&(s=new H(l,1))}if(s){let l=L.fromPositions(s,this.getModelEndPositionOfViewLine(n));o.push(new DH(l,a))}return o}getViewLinesBracketGuides(t,e,i,n){let o=i?this.convertViewPositionToModelPosition(i.lineNumber,i.column):null,s=[];for(let a of this.getViewLineInfosGroupedByModelRanges(t,e)){let l=a.modelRange.startLineNumber,d=this.model.guides.getLinesBracketGuides(l,a.modelRange.endLineNumber,o,n);for(let c of a.viewLines){let h=d[c.modelLineNumber-l].map(m=>{if(m.forWrappedLinesAfterColumn!==-1&&this.modelLineProjections[c.modelLineNumber-1].getViewPositionOfModelPosition(0,m.forWrappedLinesAfterColumn).lineNumber>=c.modelLineWrappedLineIdx||m.forWrappedLinesBeforeOrAtColumn!==-1&&this.modelLineProjections[c.modelLineNumber-1].getViewPositionOfModelPosition(0,m.forWrappedLinesBeforeOrAtColumn).lineNumber<c.modelLineWrappedLineIdx)return;if(!m.horizontalLine)return m;let f=-1;if(m.column!==-1){let I=this.modelLineProjections[c.modelLineNumber-1].getViewPositionOfModelPosition(0,m.column);if(I.lineNumber===c.modelLineWrappedLineIdx)f=I.column;else if(I.lineNumber<c.modelLineWrappedLineIdx)f=this.getMinColumnOfViewLine(c);else if(I.lineNumber>c.modelLineWrappedLineIdx)return}let g=this.convertModelPositionToViewPosition(c.modelLineNumber,m.horizontalLine.endColumn),v=this.modelLineProjections[c.modelLineNumber-1].getViewPositionOfModelPosition(0,m.horizontalLine.endColumn);return v.lineNumber===c.modelLineWrappedLineIdx?new mc(m.visibleColumn,f,m.className,new Lm(m.horizontalLine.top,g.column),-1,-1):v.lineNumber<c.modelLineWrappedLineIdx||m.visibleColumn!==-1?void 0:new mc(m.visibleColumn,f,m.className,new Lm(m.horizontalLine.top,this.getMaxColumnOfViewLine(c)),-1,-1)});s.push(h.filter(m=>!!m))}}return s}getViewLinesIndentGuides(t,e){t=this._toValidViewLineNumber(t),e=this._toValidViewLineNumber(e);let i=this.convertViewPositionToModelPosition(t,this.getViewLineMinColumn(t)),n=this.convertViewPositionToModelPosition(e,this.getViewLineMaxColumn(e)),o=[],s=[],a=[],l=i.lineNumber-1,d=n.lineNumber-1,c=null;for(let f=l;f<=d;f++){let g=this.modelLineProjections[f];if(g.isVisible()){let v=g.getViewLineNumberOfModelPosition(0,f===l?i.column:1),I=g.getViewLineNumberOfModelPosition(0,this.model.getLineMaxColumn(f+1)),y=I-v+1,w=0;y>1&&g.getViewLineMinColumn(this.model,f+1,I)===1&&(w=v===0?1:2),s.push(y),a.push(w),c===null&&(c=new H(f+1,0))}else c!==null&&(o=o.concat(this.model.guides.getLinesIndentGuides(c.lineNumber,f)),c=null)}c!==null&&(o=o.concat(this.model.guides.getLinesIndentGuides(c.lineNumber,n.lineNumber)),c=null);let p=e-t+1,h=new Array(p),m=0;for(let f=0,g=o.length;f<g;f++){let v=o[f],I=Math.min(p-m,s[f]),y=a[f],w;y===2?w=0:y===1?w=1:w=I;for(let C=0;C<I;C++)C===w&&(v=0),h[m++]=v}return h}getViewLineContent(t){let e=this.getViewLineInfo(t);return this.modelLineProjections[e.modelLineNumber-1].getViewLineContent(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx)}getViewLineLength(t){let e=this.getViewLineInfo(t);return this.modelLineProjections[e.modelLineNumber-1].getViewLineLength(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx)}getViewLineMinColumn(t){let e=this.getViewLineInfo(t);return this.modelLineProjections[e.modelLineNumber-1].getViewLineMinColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx)}getViewLineMaxColumn(t){let e=this.getViewLineInfo(t);return this.modelLineProjections[e.modelLineNumber-1].getViewLineMaxColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx)}getViewLineData(t){let e=this.getViewLineInfo(t);return this.modelLineProjections[e.modelLineNumber-1].getViewLineData(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx)}getViewLinesData(t,e,i){t=this._toValidViewLineNumber(t),e=this._toValidViewLineNumber(e);let n=this.projectedModelLineLineCounts.getIndexOf(t-1),o=t,s=n.index,a=n.remainder,l=[];for(let d=s,c=this.model.getLineCount();d<c;d++){let p=this.modelLineProjections[d];if(!p.isVisible())continue;let h=d===s?a:0,m=p.getViewLineCount()-h,f=!1;if(o+m>e&&(f=!0,m=e-o+1),p.getViewLinesData(this.model,d+1,h,m,o-t,i,l),o+=m,f)break}return l}validateViewPosition(t,e,i){t=this._toValidViewLineNumber(t);let n=this.projectedModelLineLineCounts.getIndexOf(t-1),o=n.index,s=n.remainder,a=this.modelLineProjections[o],l=a.getViewLineMinColumn(this.model,o+1,s),d=a.getViewLineMaxColumn(this.model,o+1,s);e<l&&(e=l),e>d&&(e=d);let c=a.getModelColumnOfViewPosition(s,e);return this.model.validatePosition(new H(o+1,c)).equals(i)?new H(t,e):this.convertModelPositionToViewPosition(i.lineNumber,i.column)}validateViewRange(t,e){let i=this.validateViewPosition(t.startLineNumber,t.startColumn,e.getStartPosition()),n=this.validateViewPosition(t.endLineNumber,t.endColumn,e.getEndPosition());return new L(i.lineNumber,i.column,n.lineNumber,n.column)}convertViewPositionToModelPosition(t,e){let i=this.getViewLineInfo(t),n=this.modelLineProjections[i.modelLineNumber-1].getModelColumnOfViewPosition(i.modelLineWrappedLineIdx,e);return this.model.validatePosition(new H(i.modelLineNumber,n))}convertViewRangeToModelRange(t){let e=this.convertViewPositionToModelPosition(t.startLineNumber,t.startColumn),i=this.convertViewPositionToModelPosition(t.endLineNumber,t.endColumn);return new L(e.lineNumber,e.column,i.lineNumber,i.column)}convertModelPositionToViewPosition(t,e,i=2,n=!1,o=!1){let s=this.model.validatePosition(new H(t,e)),a=s.lineNumber,l=s.column,d=a-1,c=!1;if(o)for(;d<this.modelLineProjections.length&&!this.modelLineProjections[d].isVisible();)d++,c=!0;else for(;d>0&&!this.modelLineProjections[d].isVisible();)d--,c=!0;if(d===0&&!this.modelLineProjections[d].isVisible())return new H(n?0:1,1);let p=1+this.projectedModelLineLineCounts.getPrefixSum(d),h;return c?o?h=this.modelLineProjections[d].getViewPositionOfModelPosition(p,1,i):h=this.modelLineProjections[d].getViewPositionOfModelPosition(p,this.model.getLineMaxColumn(d+1),i):h=this.modelLineProjections[a-1].getViewPositionOfModelPosition(p,l,i),h}convertModelRangeToViewRange(t,e=0){if(t.isEmpty()){let i=this.convertModelPositionToViewPosition(t.startLineNumber,t.startColumn,e);return L.fromPositions(i)}else{let i=this.convertModelPositionToViewPosition(t.startLineNumber,t.startColumn,1),n=this.convertModelPositionToViewPosition(t.endLineNumber,t.endColumn,0);return new L(i.lineNumber,i.column,n.lineNumber,n.column)}}getViewLineNumberOfModelPosition(t,e){let i=t-1;if(this.modelLineProjections[i].isVisible()){let o=1+this.projectedModelLineLineCounts.getPrefixSum(i);return this.modelLineProjections[i].getViewLineNumberOfModelPosition(o,e)}for(;i>0&&!this.modelLineProjections[i].isVisible();)i--;if(i===0&&!this.modelLineProjections[i].isVisible())return 1;let n=1+this.projectedModelLineLineCounts.getPrefixSum(i);return this.modelLineProjections[i].getViewLineNumberOfModelPosition(n,this.model.getLineMaxColumn(i+1))}getDecorationsInRange(t,e,i,n,o){let s=this.convertViewPositionToModelPosition(t.startLineNumber,t.startColumn),a=this.convertViewPositionToModelPosition(t.endLineNumber,t.endColumn);if(a.lineNumber-s.lineNumber<=t.endLineNumber-t.startLineNumber)return this.model.getDecorationsInRange(new L(s.lineNumber,1,a.lineNumber,a.column),e,i,n,o);let l=[],d=s.lineNumber-1,c=a.lineNumber-1,p=null;for(let g=d;g<=c;g++)if(this.modelLineProjections[g].isVisible())p===null&&(p=new H(g+1,g===d?s.column:1));else if(p!==null){let I=this.model.getLineMaxColumn(g);l=l.concat(this.model.getDecorationsInRange(new L(p.lineNumber,p.column,g,I),e,i,n)),p=null}p!==null&&(l=l.concat(this.model.getDecorationsInRange(new L(p.lineNumber,p.column,a.lineNumber,a.column),e,i,n)),p=null),l.sort((g,v)=>{let I=L.compareRangesUsingStarts(g.range,v.range);return I===0?g.id<v.id?-1:g.id>v.id?1:0:I});let h=[],m=0,f=null;for(let g of l){let v=g.id;f!==v&&(f=v,h[m++]=g)}return h}getInjectedTextAt(t){let e=this.getViewLineInfo(t.lineNumber);return this.modelLineProjections[e.modelLineNumber-1].getInjectedTextAt(e.modelLineWrappedLineIdx,t.column)}normalizePosition(t,e){let i=this.getViewLineInfo(t.lineNumber);return this.modelLineProjections[i.modelLineNumber-1].normalizePosition(i.modelLineWrappedLineIdx,t,e)}getLineIndentColumn(t){let e=this.getViewLineInfo(t);return e.modelLineWrappedLineIdx===0?this.model.getLineIndentColumn(e.modelLineNumber):0}};function oxe(r){if(r.length===0)return[];let t=r.slice();t.sort(L.compareRangesUsingStarts);let e=[],i=t[0].startLineNumber,n=t[0].endLineNumber;for(let o=1,s=t.length;o<s;o++){let a=t[o];a.startLineNumber>n+1?(e.push(new L(i,1,n,1)),i=a.startLineNumber,n=a.endLineNumber):a.endLineNumber>n&&(n=a.endLineNumber)}return e.push(new L(i,1,n,1)),e}var _H=class{constructor(t,e){this.modelLineNumber=t;this.modelLineWrappedLineIdx=e}get isWrappedLineContinuation(){return this.modelLineWrappedLineIdx>0}},DH=class{constructor(t,e){this.modelRange=t;this.viewLines=e}},P$=class{_lines;constructor(t){this._lines=t}convertViewPositionToModelPosition(t){return this._lines.convertViewPositionToModelPosition(t.lineNumber,t.column)}convertViewRangeToModelRange(t){return this._lines.convertViewRangeToModelRange(t)}validateViewPosition(t,e){return this._lines.validateViewPosition(t.lineNumber,t.column,e)}validateViewRange(t,e){return this._lines.validateViewRange(t,e)}convertModelPositionToViewPosition(t,e,i,n){return this._lines.convertModelPositionToViewPosition(t.lineNumber,t.column,e,i,n)}convertModelRangeToViewRange(t,e){return this._lines.convertModelRangeToViewRange(t,e)}modelPositionIsVisible(t){return this._lines.modelPositionIsVisible(t.lineNumber,t.column)}getModelLineViewLineCount(t){return this._lines.getModelLineViewLineCount(t)}getViewLineNumberOfModelPosition(t,e){return this._lines.getViewLineNumberOfModelPosition(t,e)}};var kH=class{model;constructor(t){this.model=t}dispose(){}createCoordinatesConverter(){return new M$(this)}getHiddenAreas(){return[]}setHiddenAreas(t){return!1}setTabSize(t){return!1}setWrappingSettings(t,e,i,n){return!1}createLineBreaksComputer(){let t=[];return{addRequest:(e,i,n)=>{t.push(null)},finalize:()=>t}}onModelFlushed(){}onModelLinesDeleted(t,e,i){return new NC(e,i)}onModelLinesInserted(t,e,i,n){return new FC(e,i)}onModelLineChanged(t,e,i){return[!1,new ak(e,1),null,null]}acceptVersionId(t){}getViewLineCount(){return this.model.getLineCount()}getActiveIndentGuide(t,e,i){return{startLineNumber:t,endLineNumber:t,indent:0}}getViewLinesBracketGuides(t,e,i){return new Array(e-t+1).fill([])}getViewLinesIndentGuides(t,e){let i=e-t+1,n=new Array(i);for(let o=0;o<i;o++)n[o]=0;return n}getViewLineContent(t){return this.model.getLineContent(t)}getViewLineLength(t){return this.model.getLineLength(t)}getViewLineMinColumn(t){return this.model.getLineMinColumn(t)}getViewLineMaxColumn(t){return this.model.getLineMaxColumn(t)}getViewLineData(t){let e=this.model.tokenization.getLineTokens(t),i=e.getLineContent();return new kI(i,!1,1,i.length+1,0,e.inflate(),null)}getViewLinesData(t,e,i){let n=this.model.getLineCount();t=Math.min(Math.max(1,t),n),e=Math.min(Math.max(1,e),n);let o=[];for(let s=t;s<=e;s++){let a=s-t;o[a]=i[a]?this.getViewLineData(s):null}return o}getDecorationsInRange(t,e,i,n,o){return this.model.getDecorationsInRange(t,e,i,n,o)}normalizePosition(t,e){return this.model.normalizePosition(t,e)}getLineIndentColumn(t){return this.model.getLineIndentColumn(t)}getInjectedTextAt(t){return null}},M$=class{_lines;constructor(t){this._lines=t}_validPosition(t){return this._lines.model.validatePosition(t)}_validRange(t){return this._lines.model.validateRange(t)}convertViewPositionToModelPosition(t){return this._validPosition(t)}convertViewRangeToModelRange(t){return this._validRange(t)}validateViewPosition(t,e){return this._validPosition(e)}validateViewRange(t,e){return this._validRange(e)}convertModelPositionToViewPosition(t){return this._validPosition(t)}convertModelRangeToViewRange(t){return this._validRange(t)}modelPositionIsVisible(t){let e=this._lines.model.getLineCount();return!(t.lineNumber<1||t.lineNumber>e)}modelRangeIsVisible(t){let e=this._lines.model.getLineCount();return!(t.startLineNumber<1||t.startLineNumber>e||t.endLineNumber<1||t.endLineNumber>e)}getModelLineViewLineCount(t){return 1}getViewLineNumberOfModelPosition(t,e){return t}};var LH=class{editorId;model;configuration;_linesCollection;_coordinatesConverter;_decorationsCache;_cachedModelDecorationsResolver;_cachedModelDecorationsResolverViewRange;constructor(t,e,i,n,o){this.editorId=t,this.model=e,this.configuration=i,this._linesCollection=n,this._coordinatesConverter=o,this._decorationsCache=Object.create(null),this._cachedModelDecorationsResolver=null,this._cachedModelDecorationsResolverViewRange=null}_clearCachedModelDecorationsResolver(){this._cachedModelDecorationsResolver=null,this._cachedModelDecorationsResolverViewRange=null}dispose(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}reset(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}onModelDecorationsChanged(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}onLineMappingChanged(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}_getOrCreateViewModelDecoration(t){let e=t.id,i=this._decorationsCache[e];if(!i){let n=t.range,o=t.options,s;if(o.isWholeLine){let a=this._coordinatesConverter.convertModelPositionToViewPosition(new H(n.startLineNumber,1),0,!1,!0),l=this._coordinatesConverter.convertModelPositionToViewPosition(new H(n.endLineNumber,this.model.getLineMaxColumn(n.endLineNumber)),1);s=new L(a.lineNumber,a.column,l.lineNumber,l.column)}else s=this._coordinatesConverter.convertModelRangeToViewRange(n,1);i=new VC(s,o),this._decorationsCache[e]=i}return i}getMinimapDecorationsInRange(t){return this._getDecorationsInRange(t,!0,!1).decorations}getDecorationsViewportData(t){let e=this._cachedModelDecorationsResolver!==null;return e=e&&t.equalsRange(this._cachedModelDecorationsResolverViewRange),e||(this._cachedModelDecorationsResolver=this._getDecorationsInRange(t,!1,!1),this._cachedModelDecorationsResolverViewRange=t),this._cachedModelDecorationsResolver}getInlineDecorationsOnLine(t,e=!1,i=!1){let n=new L(t,this._linesCollection.getViewLineMinColumn(t),t,this._linesCollection.getViewLineMaxColumn(t));return this._getDecorationsInRange(n,e,i).inlineDecorations[0]}_getDecorationsInRange(t,e,i){let n=this._linesCollection.getDecorationsInRange(t,this.editorId,hI(this.configuration.options),e,i),o=t.startLineNumber,s=t.endLineNumber,a=[],l=0,d=[];for(let c=o;c<=s;c++)d[c-o]=[];for(let c=0,p=n.length;c<p;c++){let h=n[c],m=h.options;if(!rxe(this.model,h))continue;let f=this._getOrCreateViewModelDecoration(h),g=f.range;if(a[l++]=f,m.inlineClassName){let v=new Nm(g,m.inlineClassName,m.inlineClassNameAffectsLetterSpacing?3:0),I=Math.max(o,g.startLineNumber),y=Math.min(s,g.endLineNumber);for(let w=I;w<=y;w++)d[w-o].push(v)}if(m.beforeContentClassName&&o<=g.startLineNumber&&g.startLineNumber<=s){let v=new Nm(new L(g.startLineNumber,g.startColumn,g.startLineNumber,g.startColumn),m.beforeContentClassName,1);d[g.startLineNumber-o].push(v)}if(m.afterContentClassName&&o<=g.endLineNumber&&g.endLineNumber<=s){let v=new Nm(new L(g.endLineNumber,g.endColumn,g.endLineNumber,g.endColumn),m.afterContentClassName,2);d[g.endLineNumber-o].push(v)}}return{decorations:a,inlineDecorations:d}}};function rxe(r,t){return!(t.options.hideInCommentTokens&&sxe(r,t)||t.options.hideInStringTokens&&axe(r,t))}function sxe(r,t){return jce(r,t.range,e=>e===1)}function axe(r,t){return jce(r,t.range,e=>e===2)}function jce(r,t,e){for(let i=t.startLineNumber;i<=t.endLineNumber;i++){let n=r.tokenization.getLineTokens(i),o=i===t.startLineNumber,s=i===t.endLineNumber,a=o?n.findTokenIndexAtOffset(t.startColumn-1):0;for(;a<n.getCount()&&!(s&&n.getStartOffset(a)>t.endColumn-1);){if(!e(n.getStandardTokenType(a)))return!1;a++}}return!0}var Ry=3,RH=class{lanes;persist=0;_requiredLanes=1;constructor(t){this.lanes=new Uint8Array(Math.ceil((t+1)*Ry/8))}reset(t){let e=Math.ceil((t+1)*Ry/8);this.lanes.length<e?this.lanes=new Uint8Array(e):this.lanes.fill(0),this._requiredLanes=1}get requiredLanes(){return this._requiredLanes}push(t,e,i){i&&(this.persist|=1<<t-1);for(let n=e.startLineNumber;n<=e.endLineNumber;n++){let o=Ry*n+(t-1);this.lanes[o>>>3]|=1<<o%8,this._requiredLanes=Math.max(this._requiredLanes,this.countAtLine(n))}}getLanesAtLine(t){let e=[],i=Ry*t;for(let n=0;n<Ry;n++)(this.persist&1<<n||this.lanes[i>>>3]&1<<i%8)&&e.push(n+1),i++;return e.length?e:[2]}countAtLine(t){let e=Ry*t,i=0;for(let n=0;n<Ry;n++)(this.persist&1<<n||this.lanes[e>>>3]&1<<e%8)&&i++,e++;return i}};var lxe=!0,PH=class extends R{constructor(e,i,n,o,s,a,l,d,c,p){super();this.languageConfigurationService=l;this._themeService=d;this._attachedView=c;this._transactionalTarget=p;if(this._editorId=e,this._configuration=i,this.model=n,this._eventDispatcher=new oH,this.onEvent=this._eventDispatcher.onEvent,this.cursorConfig=new Pm(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._updateConfigurationViewLineCount=this._register(new Ye(()=>this._updateConfigurationViewLineCountNow(),0)),this._hasFocus=!1,this._viewportStart=A$.create(this.model),this.glyphLanes=new RH(0),lxe&&this.model.isTooLargeForTokenization())this._lines=new kH(this.model);else{let h=this._configuration.options,m=h.get(51),f=h.get(141),g=h.get(148),v=h.get(140),I=h.get(131);this._lines=new TH(this._editorId,this.model,o,s,m,this.model.getOptions().tabSize,f,g.wrappingColumn,v,I)}this.coordinatesConverter=this._lines.createCoordinatesConverter(),this._cursor=this._register(new vH(n,this,this.coordinatesConverter,this.cursorConfig)),this.viewLayout=this._register(new SH(this._configuration,this.getLineCount(),a)),this._register(this.viewLayout.onDidScroll(h=>{h.scrollTopChanged&&this._handleVisibleLinesChanged(),h.scrollTopChanged&&this._viewportStart.invalidate(),this._eventDispatcher.emitSingleViewEvent(new N0(h)),this._eventDispatcher.emitOutgoingEvent(new aH(h.oldScrollWidth,h.oldScrollLeft,h.oldScrollHeight,h.oldScrollTop,h.scrollWidth,h.scrollLeft,h.scrollHeight,h.scrollTop))})),this._register(this.viewLayout.onDidContentSizeChange(h=>{this._eventDispatcher.emitOutgoingEvent(h)})),this._decorations=new LH(this._editorId,this.model,this._configuration,this._lines,this.coordinatesConverter),this._registerModelEvents(),this._register(this._configuration.onDidChangeFast(h=>{try{let m=this._eventDispatcher.beginEmitViewEvents();this._onConfigurationChanged(m,h)}finally{this._eventDispatcher.endEmitViewEvents()}})),this._register(ZE.getInstance().onDidChange(()=>{this._eventDispatcher.emitSingleViewEvent(new V0)})),this._register(this._themeService.onDidColorThemeChange(h=>{this._invalidateDecorationsColorCache(),this._eventDispatcher.emitSingleViewEvent(new F0(h))})),this._updateConfigurationViewLineCountNow()}_editorId;_configuration;model;_eventDispatcher;onEvent;cursorConfig;_updateConfigurationViewLineCount;_hasFocus;_viewportStart;_lines;coordinatesConverter;viewLayout;_cursor;_decorations;glyphLanes;dispose(){super.dispose(),this._decorations.dispose(),this._lines.dispose(),this._viewportStart.dispose(),this._eventDispatcher.dispose()}createLineBreaksComputer(){return this._lines.createLineBreaksComputer()}addViewEventHandler(e){this._eventDispatcher.addViewEventHandler(e)}removeViewEventHandler(e){this._eventDispatcher.removeViewEventHandler(e)}_updateConfigurationViewLineCountNow(){this._configuration.setViewLineCount(this._lines.getViewLineCount())}getModelVisibleRanges(){let e=this.viewLayout.getLinesViewportData(),i=new L(e.startLineNumber,this.getLineMinColumn(e.startLineNumber),e.endLineNumber,this.getLineMaxColumn(e.endLineNumber));return this._toModelVisibleRanges(i)}visibleLinesStabilized(){let e=this.getModelVisibleRanges();this._attachedView.setVisibleLines(e,!0)}_handleVisibleLinesChanged(){let e=this.getModelVisibleRanges();this._attachedView.setVisibleLines(e,!1)}setHasFocus(e){this._hasFocus=e,this._cursor.setHasFocus(e),this._eventDispatcher.emitSingleViewEvent(new A0(e)),this._eventDispatcher.emitOutgoingEvent(new sH(!e,e))}onCompositionStart(){this._eventDispatcher.emitSingleViewEvent(new L0)}onCompositionEnd(){this._eventDispatcher.emitSingleViewEvent(new R0)}_captureStableViewport(){if(this._viewportStart.isValid&&this.viewLayout.getCurrentScrollTop()>0){let e=new H(this._viewportStart.viewLineNumber,this.getLineMinColumn(this._viewportStart.viewLineNumber)),i=this.coordinatesConverter.convertViewPositionToModelPosition(e);return new MH(i,this._viewportStart.startLineDelta)}return new MH(null,0)}_onConfigurationChanged(e,i){let n=this._captureStableViewport(),o=this._configuration.options,s=o.get(51),a=o.get(141),l=o.get(148),d=o.get(140),c=o.get(131);this._lines.setWrappingSettings(s,a,l.wrappingColumn,d,c)&&(e.emitViewEvent(new _I),e.emitViewEvent(new DI),e.emitViewEvent(new Up(null)),this._cursor.onLineMappingChanged(e),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount()),this._updateConfigurationViewLineCount.schedule()),i.hasChanged(93)&&(this._decorations.reset(),e.emitViewEvent(new Up(null))),i.hasChanged(100)&&(this._decorations.reset(),e.emitViewEvent(new Up(null))),e.emitViewEvent(new P0(i)),this.viewLayout.onConfigurationChanged(i),n.recoverViewportStart(this.coordinatesConverter,this.viewLayout),Pm.shouldRecreate(i)&&(this.cursorConfig=new Pm(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig))}_registerModelEvents(){this._register(this.model.onDidChangeContentOrInjectedText(e=>{try{let n=this._eventDispatcher.beginEmitViewEvents(),o=!1,s=!1,a=e instanceof kf?e.rawContentChangedEvent.changes:e.changes,l=e instanceof kf?e.rawContentChangedEvent.versionId:null,d=this._lines.createLineBreaksComputer();for(let h of a)switch(h.changeType){case 4:{for(let m=0;m<h.detail.length;m++){let f=h.detail[m],g=h.injectedTexts[m];g&&(g=g.filter(v=>!v.ownerId||v.ownerId===this._editorId)),d.addRequest(f,g,null)}break}case 2:{let m=null;h.injectedText&&(m=h.injectedText.filter(f=>!f.ownerId||f.ownerId===this._editorId)),d.addRequest(h.detail,m,null);break}}let c=d.finalize(),p=new Ms(c);for(let h of a)switch(h.changeType){case 1:{this._lines.onModelFlushed(),n.emitViewEvent(new _I),this._decorations.reset(),this.viewLayout.onFlushed(this.getLineCount()),o=!0;break}case 3:{let m=this._lines.onModelLinesDeleted(l,h.fromLineNumber,h.toLineNumber);m!==null&&(n.emitViewEvent(m),this.viewLayout.onLinesDeleted(m.fromLineNumber,m.toLineNumber)),o=!0;break}case 4:{let m=p.takeCount(h.detail.length),f=this._lines.onModelLinesInserted(l,h.fromLineNumber,h.toLineNumber,m);f!==null&&(n.emitViewEvent(f),this.viewLayout.onLinesInserted(f.fromLineNumber,f.toLineNumber)),o=!0;break}case 2:{let m=p.dequeue(),[f,g,v,I]=this._lines.onModelLineChanged(l,h.lineNumber,m);s=f,g&&n.emitViewEvent(g),v&&(n.emitViewEvent(v),this.viewLayout.onLinesInserted(v.fromLineNumber,v.toLineNumber)),I&&(n.emitViewEvent(I),this.viewLayout.onLinesDeleted(I.fromLineNumber,I.toLineNumber));break}case 5:break}l!==null&&this._lines.acceptVersionId(l),this.viewLayout.onHeightMaybeChanged(),!o&&s&&(n.emitViewEvent(new DI),n.emitViewEvent(new Up(null)),this._cursor.onLineMappingChanged(n),this._decorations.onLineMappingChanged())}finally{this._eventDispatcher.endEmitViewEvents()}let i=this._viewportStart.isValid;if(this._viewportStart.invalidate(),this._configuration.setModelLineCount(this.model.getLineCount()),this._updateConfigurationViewLineCountNow(),!this._hasFocus&&this.model.getAttachedEditorCount()>=2&&i){let n=this.model._getTrackedRange(this._viewportStart.modelTrackedRange);if(n){let o=this.coordinatesConverter.convertModelPositionToViewPosition(n.getStartPosition()),s=this.viewLayout.getVerticalOffsetForLineNumber(o.lineNumber);this.viewLayout.setScrollPosition({scrollTop:s+this._viewportStart.startLineDelta},1)}}try{let n=this._eventDispatcher.beginEmitViewEvents();e instanceof kf&&n.emitOutgoingEvent(new gH(e.contentChangedEvent)),this._cursor.onModelContentChanged(n,e)}finally{this._eventDispatcher.endEmitViewEvents()}this._handleVisibleLinesChanged()})),this._register(this.model.onDidChangeTokens(e=>{let i=[];for(let n=0,o=e.ranges.length;n<o;n++){let s=e.ranges[n],a=this.coordinatesConverter.convertModelPositionToViewPosition(new H(s.fromLineNumber,1)).lineNumber,l=this.coordinatesConverter.convertModelPositionToViewPosition(new H(s.toLineNumber,this.model.getLineMaxColumn(s.toLineNumber))).lineNumber;i[n]={fromLineNumber:a,toLineNumber:l}}this._eventDispatcher.emitSingleViewEvent(new B0(i)),this._eventDispatcher.emitOutgoingEvent(new bH(e))})),this._register(this.model.onDidChangeLanguageConfiguration(e=>{this._eventDispatcher.emitSingleViewEvent(new O0),this.cursorConfig=new Pm(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new mH(e))})),this._register(this.model.onDidChangeLanguage(e=>{this.cursorConfig=new Pm(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new hH(e))})),this._register(this.model.onDidChangeOptions(e=>{if(this._lines.setTabSize(this.model.getOptions().tabSize)){try{let i=this._eventDispatcher.beginEmitViewEvents();i.emitViewEvent(new _I),i.emitViewEvent(new DI),i.emitViewEvent(new Up(null)),this._cursor.onLineMappingChanged(i),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount())}finally{this._eventDispatcher.endEmitViewEvents()}this._updateConfigurationViewLineCount.schedule()}this.cursorConfig=new Pm(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new fH(e))})),this._register(this.model.onDidChangeDecorations(e=>{this._decorations.onModelDecorationsChanged(),this._eventDispatcher.emitSingleViewEvent(new Up(e)),this._eventDispatcher.emitOutgoingEvent(new pH(e))}))}hiddenAreasModel=new N$;previousHiddenAreas=[];setHiddenAreas(e,i){this.hiddenAreasModel.setHiddenAreas(i,e);let n=this.hiddenAreasModel.getMergedRanges();if(n===this.previousHiddenAreas)return;this.previousHiddenAreas=n;let o=this._captureStableViewport(),s=!1;try{let a=this._eventDispatcher.beginEmitViewEvents();s=this._lines.setHiddenAreas(n),s&&(a.emitViewEvent(new _I),a.emitViewEvent(new DI),a.emitViewEvent(new Up(null)),this._cursor.onLineMappingChanged(a),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount()),this.viewLayout.onHeightMaybeChanged());let l=o.viewportStartModelPosition?.lineNumber;l&&n.some(c=>c.startLineNumber<=l&&l<=c.endLineNumber)||o.recoverViewportStart(this.coordinatesConverter,this.viewLayout)}finally{this._eventDispatcher.endEmitViewEvents()}this._updateConfigurationViewLineCount.schedule(),s&&this._eventDispatcher.emitOutgoingEvent(new dH)}getVisibleRangesPlusViewportAboveBelow(){let e=this._configuration.options.get(147),i=this._configuration.options.get(68),n=Math.max(20,Math.round(e.height/i)),o=this.viewLayout.getLinesViewportData(),s=Math.max(1,o.completelyVisibleStartLineNumber-n),a=Math.min(this.getLineCount(),o.completelyVisibleEndLineNumber+n);return this._toModelVisibleRanges(new L(s,this.getLineMinColumn(s),a,this.getLineMaxColumn(a)))}getVisibleRanges(){let e=this.getCompletelyVisibleViewRange();return this._toModelVisibleRanges(e)}getHiddenAreas(){return this._lines.getHiddenAreas()}_toModelVisibleRanges(e){let i=this.coordinatesConverter.convertViewRangeToModelRange(e),n=this._lines.getHiddenAreas();if(n.length===0)return[i];let o=[],s=0,a=i.startLineNumber,l=i.startColumn,d=i.endLineNumber,c=i.endColumn;for(let p=0,h=n.length;p<h;p++){let m=n[p].startLineNumber,f=n[p].endLineNumber;f<a||m>d||(a<m&&(o[s++]=new L(a,l,m-1,this.model.getLineMaxColumn(m-1))),a=f+1,l=1)}return(a<d||a===d&&l<c)&&(o[s++]=new L(a,l,d,c)),o}getCompletelyVisibleViewRange(){let e=this.viewLayout.getLinesViewportData(),i=e.completelyVisibleStartLineNumber,n=e.completelyVisibleEndLineNumber;return new L(i,this.getLineMinColumn(i),n,this.getLineMaxColumn(n))}getCompletelyVisibleViewRangeAtScrollTop(e){let i=this.viewLayout.getLinesViewportDataAtScrollTop(e),n=i.completelyVisibleStartLineNumber,o=i.completelyVisibleEndLineNumber;return new L(n,this.getLineMinColumn(n),o,this.getLineMaxColumn(o))}saveState(){let e=this.viewLayout.saveState(),i=e.scrollTop,n=this.viewLayout.getLineNumberAtVerticalOffset(i),o=this.coordinatesConverter.convertViewPositionToModelPosition(new H(n,this.getLineMinColumn(n))),s=this.viewLayout.getVerticalOffsetForLineNumber(n)-i;return{scrollLeft:e.scrollLeft,firstPosition:o,firstPositionDeltaTop:s}}reduceRestoreState(e){if(typeof e.firstPosition>"u")return this._reduceRestoreStateCompatibility(e);let i=this.model.validatePosition(e.firstPosition),n=this.coordinatesConverter.convertModelPositionToViewPosition(i),o=this.viewLayout.getVerticalOffsetForLineNumber(n.lineNumber)-e.firstPositionDeltaTop;return{scrollLeft:e.scrollLeft,scrollTop:o}}_reduceRestoreStateCompatibility(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTopWithoutViewZones}}getTabSize(){return this.model.getOptions().tabSize}getLineCount(){return this._lines.getViewLineCount()}setViewport(e,i,n){this._viewportStart.update(this,e)}getActiveIndentGuide(e,i,n){return this._lines.getActiveIndentGuide(e,i,n)}getLinesIndentGuides(e,i){return this._lines.getViewLinesIndentGuides(e,i)}getBracketGuidesInRangeByLine(e,i,n,o){return this._lines.getViewLinesBracketGuides(e,i,n,o)}getLineContent(e){return this._lines.getViewLineContent(e)}getLineLength(e){return this._lines.getViewLineLength(e)}getLineMinColumn(e){return this._lines.getViewLineMinColumn(e)}getLineMaxColumn(e){return this._lines.getViewLineMaxColumn(e)}getLineFirstNonWhitespaceColumn(e){let i=Jn(this.getLineContent(e));return i===-1?0:i+1}getLineLastNonWhitespaceColumn(e){let i=fd(this.getLineContent(e));return i===-1?0:i+2}getMinimapDecorationsInRange(e){return this._decorations.getMinimapDecorationsInRange(e)}getDecorationsInViewport(e){return this._decorations.getDecorationsViewportData(e).decorations}getInjectedTextAt(e){return this._lines.getInjectedTextAt(e)}getViewportViewLineRenderingData(e,i){let o=this._decorations.getDecorationsViewportData(e).inlineDecorations[i-e.startLineNumber];return this._getViewLineRenderingData(i,o)}getViewLineRenderingData(e){let i=this._decorations.getInlineDecorationsOnLine(e);return this._getViewLineRenderingData(e,i)}_getViewLineRenderingData(e,i){let n=this.model.mightContainRTL(),o=this.model.mightContainNonBasicASCII(),s=this.getTabSize(),a=this._lines.getViewLineData(e);return a.inlineDecorations&&(i=[...i,...a.inlineDecorations.map(l=>l.toInlineDecoration(e))]),new zp(a.minColumn,a.maxColumn,a.content,a.continuesWithWrappedLine,n,o,a.tokens,i,s,a.startVisibleColumn)}getViewLineData(e){return this._lines.getViewLineData(e)}getMinimapLinesRenderingData(e,i,n){let o=this._lines.getViewLinesData(e,i,n);return new H0(this.getTabSize(),o)}getAllOverviewRulerDecorations(e){let i=this.model.getOverviewRulerDecorations(this._editorId,hI(this._configuration.options)),n=new O$;for(let o of i){let s=o.options,a=s.overviewRuler;if(!a)continue;let l=a.position;if(l===0)continue;let d=a.getColor(e.value),c=this.coordinatesConverter.getViewLineNumberOfModelPosition(o.range.startLineNumber,o.range.startColumn),p=this.coordinatesConverter.getViewLineNumberOfModelPosition(o.range.endLineNumber,o.range.endColumn);n.accept(d,s.zIndex,c,p,l)}return n.asArray}_invalidateDecorationsColorCache(){let e=this.model.getOverviewRulerDecorations();for(let i of e)i.options.overviewRuler?.invalidateCachedColor(),i.options.minimap?.invalidateCachedColor()}getValueInRange(e,i){let n=this.coordinatesConverter.convertViewRangeToModelRange(e);return this.model.getValueInRange(n,i)}getValueLengthInRange(e,i){let n=this.coordinatesConverter.convertViewRangeToModelRange(e);return this.model.getValueLengthInRange(n,i)}modifyPosition(e,i){let n=this.coordinatesConverter.convertViewPositionToModelPosition(e),o=this.model.modifyPosition(n,i);return this.coordinatesConverter.convertModelPositionToViewPosition(o)}deduceModelPositionRelativeToViewPosition(e,i,n){let o=this.coordinatesConverter.convertViewPositionToModelPosition(e);this.model.getEOL().length===2&&(i<0?i-=n:i+=n);let a=this.model.getOffsetAt(o)+i;return this.model.getPositionAt(a)}getPlainTextToCopy(e,i,n){let o=n?`\r
`:this.model.getEOL();e=e.slice(0),e.sort(L.compareRangesUsingStarts);let s=!1,a=!1;for(let d of e)d.isEmpty()?s=!0:a=!0;if(!a){if(!i)return"";let d=e.map(p=>p.startLineNumber),c="";for(let p=0;p<d.length;p++)p>0&&d[p-1]===d[p]||(c+=this.model.getLineContent(d[p])+o);return c}if(s&&i){let d=[],c=0;for(let p of e){let h=p.startLineNumber;p.isEmpty()?h!==c&&d.push(this.model.getLineContent(h)):d.push(this.model.getValueInRange(p,n?2:0)),c=h}return d.length===1?d[0]:d}let l=[];for(let d of e)d.isEmpty()||l.push(this.model.getValueInRange(d,n?2:0));return l.length===1?l[0]:l}getRichTextToCopy(e,i){let n=this.model.getLanguageId();if(n===jn||e.length!==1)return null;let o=e[0];if(o.isEmpty()){if(!i)return null;let p=o.startLineNumber;o=new L(p,this.model.getLineMinColumn(p),p,this.model.getLineMaxColumn(p))}let s=this._configuration.options.get(51),a=this._getColorMap(),d=/[:;\\\/<>]/.test(s.fontFamily)||s.fontFamily===vs.fontFamily,c;return d?c=vs.fontFamily:(c=s.fontFamily,c=c.replace(/"/g,"'"),/[,']/.test(c)||/[+ ]/.test(c)&&(c=`'${c}'`),c=`${c}, ${vs.fontFamily}`),{mode:n,html:`<div style="color: ${a[1]};background-color: ${a[2]};font-family: ${c};font-weight: ${s.fontWeight};font-size: ${s.fontSize}px;line-height: ${s.lineHeight}px;white-space: pre;">`+this._getHTMLToCopy(o,a)+"</div>"}}_getHTMLToCopy(e,i){let n=e.startLineNumber,o=e.startColumn,s=e.endLineNumber,a=e.endColumn,l=this.getTabSize(),d="";for(let c=n;c<=s;c++){let p=this.model.tokenization.getLineTokens(c),h=p.getLineContent(),m=c===n?o-1:0,f=c===s?a-1:h.length;h===""?d+="<br>":d+=qce(h,p.inflate(),i,m,f,l,St)}return d}_getColorMap(){let e=Is.getColorMap(),i=["#000000"];if(e)for(let n=1,o=e.length;n<o;n++)i[n]=j.Format.CSS.formatHex(e[n]);return i}getPrimaryCursorState(){return this._cursor.getPrimaryCursorState()}getLastAddedCursorIndex(){return this._cursor.getLastAddedCursorIndex()}getCursorStates(){return this._cursor.getCursorStates()}setCursorStates(e,i,n){return this._withViewEventsCollector(o=>this._cursor.setStates(o,e,i,n))}getCursorColumnSelectData(){return this._cursor.getCursorColumnSelectData()}getCursorAutoClosedCharacters(){return this._cursor.getAutoClosedCharacters()}setCursorColumnSelectData(e){this._cursor.setCursorColumnSelectData(e)}getPrevEditOperationType(){return this._cursor.getPrevEditOperationType()}setPrevEditOperationType(e){this._cursor.setPrevEditOperationType(e)}getSelection(){return this._cursor.getSelection()}getSelections(){return this._cursor.getSelections()}getPosition(){return this._cursor.getPrimaryCursorState().modelState.position}setSelections(e,i,n=0){this._withViewEventsCollector(o=>this._cursor.setSelections(o,e,i,n))}saveCursorState(){return this._cursor.saveState()}restoreCursorState(e){this._withViewEventsCollector(i=>this._cursor.restoreState(i,e))}_executeCursorEdit(e){if(this._cursor.context.cursorConfig.readOnly){this._eventDispatcher.emitOutgoingEvent(new uH);return}this._withViewEventsCollector(e)}executeEdits(e,i,n){this._executeCursorEdit(o=>this._cursor.executeEdits(o,e,i,n))}startComposition(){this._executeCursorEdit(e=>this._cursor.startComposition(e))}endComposition(e){this._executeCursorEdit(i=>this._cursor.endComposition(i,e))}type(e,i){this._executeCursorEdit(n=>this._cursor.type(n,e,i))}compositionType(e,i,n,o,s){this._executeCursorEdit(a=>this._cursor.compositionType(a,e,i,n,o,s))}paste(e,i,n,o){this._executeCursorEdit(s=>this._cursor.paste(s,e,i,n,o))}cut(e){this._executeCursorEdit(i=>this._cursor.cut(i,e))}executeCommand(e,i){this._executeCursorEdit(n=>this._cursor.executeCommand(n,e,i))}executeCommands(e,i){this._executeCursorEdit(n=>this._cursor.executeCommands(n,e,i))}revealAllCursors(e,i,n=!1){this._withViewEventsCollector(o=>this._cursor.revealAll(o,e,n,0,i,0))}revealPrimaryCursor(e,i,n=!1){this._withViewEventsCollector(o=>this._cursor.revealPrimary(o,e,n,0,i,0))}revealTopMostCursor(e){let i=this._cursor.getTopMostViewPosition(),n=new L(i.lineNumber,i.column,i.lineNumber,i.column);this._withViewEventsCollector(o=>o.emitViewEvent(new Om(e,!1,n,null,0,!0,0)))}revealBottomMostCursor(e){let i=this._cursor.getBottomMostViewPosition(),n=new L(i.lineNumber,i.column,i.lineNumber,i.column);this._withViewEventsCollector(o=>o.emitViewEvent(new Om(e,!1,n,null,0,!0,0)))}revealRange(e,i,n,o,s){this._withViewEventsCollector(a=>a.emitViewEvent(new Om(e,!1,n,null,o,i,s)))}changeWhitespace(e){this.viewLayout.changeWhitespace(e)&&(this._eventDispatcher.emitSingleViewEvent(new W0),this._eventDispatcher.emitOutgoingEvent(new lH))}_withViewEventsCollector(e){return this._transactionalTarget.batchChanges(()=>{try{let i=this._eventDispatcher.beginEmitViewEvents();return e(i)}finally{this._eventDispatcher.endEmitViewEvents()}})}batchEvents(e){this._withViewEventsCollector(()=>{e()})}normalizePosition(e,i){return this._lines.normalizePosition(e,i)}getLineIndentColumn(e){return this._lines.getLineIndentColumn(e)}},A$=class r{constructor(t,e,i,n,o){this._model=t;this._viewLineNumber=e;this._isValid=i;this._modelTrackedRange=n;this._startLineDelta=o}static create(t){let e=t._setTrackedRange(null,new L(1,1,1,1),1);return new r(t,1,!1,e,0)}get viewLineNumber(){return this._viewLineNumber}get isValid(){return this._isValid}get modelTrackedRange(){return this._modelTrackedRange}get startLineDelta(){return this._startLineDelta}dispose(){this._model._setTrackedRange(this._modelTrackedRange,null,1)}update(t,e){let i=t.coordinatesConverter.convertViewPositionToModelPosition(new H(e,t.getLineMinColumn(e))),n=t.model._setTrackedRange(this._modelTrackedRange,new L(i.lineNumber,i.column,i.lineNumber,i.column),1),o=t.viewLayout.getVerticalOffsetForLineNumber(e),s=t.viewLayout.getCurrentScrollTop();this._viewLineNumber=e,this._isValid=!0,this._modelTrackedRange=n,this._startLineDelta=s-o}invalidate(){this._isValid=!1}},O$=class{_asMap=Object.create(null);asArray=[];accept(t,e,i,n,o){let s=this._asMap[t];if(s){let a=s.data,l=a[a.length-3],d=a[a.length-1];if(l===o&&d+1>=i){n>d&&(a[a.length-1]=n);return}a.push(o,i,n)}else{let a=new LI(t,e,[o,i,n]);this._asMap[t]=a,this.asArray.push(a)}}},N$=class{hiddenAreas=new Map;shouldRecompute=!1;ranges=[];setHiddenAreas(t,e){let i=this.hiddenAreas.get(t);i&&Xce(i,e)||(this.hiddenAreas.set(t,e),this.shouldRecompute=!0)}getMergedRanges(){if(!this.shouldRecompute)return this.ranges;this.shouldRecompute=!1;let t=Array.from(this.hiddenAreas.values()).reduce((e,i)=>dxe(e,i),[]);return Xce(this.ranges,t)?this.ranges:(this.ranges=t,this.ranges)}};function dxe(r,t){let e=[],i=0,n=0;for(;i<r.length&&n<t.length;){let o=r[i],s=t[n];if(o.endLineNumber<s.startLineNumber-1)e.push(r[i++]);else if(s.endLineNumber<o.startLineNumber-1)e.push(t[n++]);else{let a=Math.min(o.startLineNumber,s.startLineNumber),l=Math.max(o.endLineNumber,s.endLineNumber);e.push(new L(a,1,l,1)),i++,n++}}for(;i<r.length;)e.push(r[i++]);for(;n<t.length;)e.push(t[n++]);return e}function Xce(r,t){if(r.length!==t.length)return!1;for(let e=0;e<r.length;e++)if(!r[e].equalsRange(t[e]))return!1;return!0}var MH=class{constructor(t,e){this.viewportStartModelPosition=t;this.startLineDelta=e}recoverViewportStart(t,e){if(!this.viewportStartModelPosition)return;let i=t.convertModelPositionToViewPosition(this.viewportStartModelPosition),n=e.getVerticalOffsetForLineNumber(i.lineNumber);e.setScrollPosition({scrollTop:n+this.startLineDelta},1)}};var $s=class extends R{constructor(e,i,n,o,s,a,l,d,c,p,h,m){super();this.languageConfigurationService=h;s.willCreateCodeEditor();let f={...i};this._domElement=e,this._overflowWidgetsDomNode=f.overflowWidgetsDomNode,delete f.overflowWidgetsDomNode,this._id=++cxe,this._decorationTypeKeysToIds={},this._decorationTypeSubtypes={},this._telemetryData=n.telemetryData,this._configuration=this._register(this._createConfiguration(n.isSimpleWidget||!1,n.contextMenuId??(n.isSimpleWidget?V.SimpleEditorContext:V.EditorContext),f,p)),this._register(this._configuration.onDidChange(I=>{this._onDidChangeConfiguration.fire(I);let y=this._configuration.options;if(I.hasChanged(147)){let w=y.get(147);this._onDidLayoutChange.fire(w)}})),this._contextKeyService=this._register(l.createScoped(this._domElement)),this._notificationService=c,this._codeEditorService=s,this._commandService=a,this._themeService=d,this._register(new V$(this,this._contextKeyService)),this._register(new W$(this,this._contextKeyService,m)),this._instantiationService=this._register(o.createChild(new el([re,this._contextKeyService]))),this._modelData=null,this._focusTracker=new H$(e,this._overflowWidgetsDomNode),this._register(this._focusTracker.onChange(()=>{this._editorWidgetFocus.setValue(this._focusTracker.hasFocus())})),this._contentWidgets={},this._overlayWidgets={},this._glyphMarginWidgets={};let g;Array.isArray(n.contributions)?g=n.contributions:g=Fm.getEditorContributions(),this._contributions.initialize(this,g,this._instantiationService);for(let I of Fm.getEditorActions()){if(this._actions.has(I.id)){Xe(new Error(`Cannot have two actions with the same id ${I.id}`));continue}let y=new iH(I.id,I.label,I.alias,I.metadata,I.precondition??void 0,w=>this._instantiationService.invokeFunction(C=>Promise.resolve(I.runEditorCommand(C,this,w))),this._contextKeyService);this._actions.set(y.id,y)}let v=()=>!this._configuration.options.get(93)&&this._configuration.options.get(36).enabled;this._register(new wl(this._domElement,{onDragOver:I=>{if(!v())return;let y=this.getTargetAtClientPoint(I.clientX,I.clientY);y?.position&&this.showDropIndicatorAt(y.position)},onDrop:async I=>{if(!v()||(this.removeDropIndicator(),!I.dataTransfer))return;let y=this.getTargetAtClientPoint(I.clientX,I.clientY);y?.position&&this._onDropIntoEditor.fire({position:y.position,event:I})},onDragLeave:()=>{this.removeDropIndicator()},onDragEnd:()=>{this.removeDropIndicator()}})),this._codeEditorService.addCodeEditor(this)}static dropIntoEditorDecorationOptions=Ii.register({description:"workbench-dnd-target",className:"dnd-target"});_deliveryQueue=see();_contributions=this._register(new tH);_onDidDispose=this._register(new x);onDidDispose=this._onDidDispose.event;_onDidChangeModelContent=this._register(new x({deliveryQueue:this._deliveryQueue}));onDidChangeModelContent=this._onDidChangeModelContent.event;_onDidChangeModelLanguage=this._register(new x({deliveryQueue:this._deliveryQueue}));onDidChangeModelLanguage=this._onDidChangeModelLanguage.event;_onDidChangeModelLanguageConfiguration=this._register(new x({deliveryQueue:this._deliveryQueue}));onDidChangeModelLanguageConfiguration=this._onDidChangeModelLanguageConfiguration.event;_onDidChangeModelOptions=this._register(new x({deliveryQueue:this._deliveryQueue}));onDidChangeModelOptions=this._onDidChangeModelOptions.event;_onDidChangeModelDecorations=this._register(new x({deliveryQueue:this._deliveryQueue}));onDidChangeModelDecorations=this._onDidChangeModelDecorations.event;_onDidChangeModelTokens=this._register(new x({deliveryQueue:this._deliveryQueue}));onDidChangeModelTokens=this._onDidChangeModelTokens.event;_onDidChangeConfiguration=this._register(new x({deliveryQueue:this._deliveryQueue}));onDidChangeConfiguration=this._onDidChangeConfiguration.event;_onWillChangeModel=this._register(new x({deliveryQueue:this._deliveryQueue}));onWillChangeModel=this._onWillChangeModel.event;_onDidChangeModel=this._register(new x({deliveryQueue:this._deliveryQueue}));onDidChangeModel=this._onDidChangeModel.event;_onDidChangeCursorPosition=this._register(new x({deliveryQueue:this._deliveryQueue}));onDidChangeCursorPosition=this._onDidChangeCursorPosition.event;_onDidChangeCursorSelection=this._register(new x({deliveryQueue:this._deliveryQueue}));onDidChangeCursorSelection=this._onDidChangeCursorSelection.event;_onDidAttemptReadOnlyEdit=this._register(new ss(this._contributions,this._deliveryQueue));onDidAttemptReadOnlyEdit=this._onDidAttemptReadOnlyEdit.event;_onDidLayoutChange=this._register(new x({deliveryQueue:this._deliveryQueue}));onDidLayoutChange=this._onDidLayoutChange.event;_editorTextFocus=this._register(new AH({deliveryQueue:this._deliveryQueue}));onDidFocusEditorText=this._editorTextFocus.onDidChangeToTrue;onDidBlurEditorText=this._editorTextFocus.onDidChangeToFalse;_editorWidgetFocus=this._register(new AH({deliveryQueue:this._deliveryQueue}));onDidFocusEditorWidget=this._editorWidgetFocus.onDidChangeToTrue;onDidBlurEditorWidget=this._editorWidgetFocus.onDidChangeToFalse;_onWillType=this._register(new ss(this._contributions,this._deliveryQueue));onWillType=this._onWillType.event;_onDidType=this._register(new ss(this._contributions,this._deliveryQueue));onDidType=this._onDidType.event;_onDidCompositionStart=this._register(new ss(this._contributions,this._deliveryQueue));onDidCompositionStart=this._onDidCompositionStart.event;_onDidCompositionEnd=this._register(new ss(this._contributions,this._deliveryQueue));onDidCompositionEnd=this._onDidCompositionEnd.event;_onDidPaste=this._register(new ss(this._contributions,this._deliveryQueue));onDidPaste=this._onDidPaste.event;_onMouseUp=this._register(new ss(this._contributions,this._deliveryQueue));onMouseUp=this._onMouseUp.event;_onMouseDown=this._register(new ss(this._contributions,this._deliveryQueue));onMouseDown=this._onMouseDown.event;_onMouseDrag=this._register(new ss(this._contributions,this._deliveryQueue));onMouseDrag=this._onMouseDrag.event;_onMouseDrop=this._register(new ss(this._contributions,this._deliveryQueue));onMouseDrop=this._onMouseDrop.event;_onMouseDropCanceled=this._register(new ss(this._contributions,this._deliveryQueue));onMouseDropCanceled=this._onMouseDropCanceled.event;_onDropIntoEditor=this._register(new ss(this._contributions,this._deliveryQueue));onDropIntoEditor=this._onDropIntoEditor.event;_onContextMenu=this._register(new ss(this._contributions,this._deliveryQueue));onContextMenu=this._onContextMenu.event;_onMouseMove=this._register(new ss(this._contributions,this._deliveryQueue));onMouseMove=this._onMouseMove.event;_onMouseLeave=this._register(new ss(this._contributions,this._deliveryQueue));onMouseLeave=this._onMouseLeave.event;_onMouseWheel=this._register(new ss(this._contributions,this._deliveryQueue));onMouseWheel=this._onMouseWheel.event;_onKeyUp=this._register(new ss(this._contributions,this._deliveryQueue));onKeyUp=this._onKeyUp.event;_onKeyDown=this._register(new ss(this._contributions,this._deliveryQueue));onKeyDown=this._onKeyDown.event;_onDidContentSizeChange=this._register(new x({deliveryQueue:this._deliveryQueue}));onDidContentSizeChange=this._onDidContentSizeChange.event;_onDidScrollChange=this._register(new x({deliveryQueue:this._deliveryQueue}));onDidScrollChange=this._onDidScrollChange.event;_onDidChangeViewZones=this._register(new x({deliveryQueue:this._deliveryQueue}));onDidChangeViewZones=this._onDidChangeViewZones.event;_onDidChangeHiddenAreas=this._register(new x({deliveryQueue:this._deliveryQueue}));onDidChangeHiddenAreas=this._onDidChangeHiddenAreas.event;_updateCounter=0;_onBeginUpdate=this._register(new x);onBeginUpdate=this._onBeginUpdate.event;_onEndUpdate=this._register(new x);onEndUpdate=this._onEndUpdate.event;get isSimpleWidget(){return this._configuration.isSimpleWidget}get contextMenuId(){return this._configuration.contextMenuId}_telemetryData;_domElement;_overflowWidgetsDomNode;_id;_configuration;_contributionsDisposable;_actions=new Map;_modelData;_instantiationService;_contextKeyService;get contextKeyService(){return this._contextKeyService}_notificationService;_codeEditorService;_commandService;_themeService;_focusTracker;_contentWidgets;_overlayWidgets;_glyphMarginWidgets;_decorationTypeKeysToIds;_decorationTypeSubtypes;_bannerDomNode=null;_dropIntoEditorDecorations=this.createDecorationsCollection();writeScreenReaderContent(e){this._modelData?.view.writeScreenReaderContent(e)}_createConfiguration(e,i,n,o){return new pC(e,i,n,this._domElement,o)}getId(){return this.getEditorType()+":"+this._id}getEditorType(){return CI.ICodeEditor}dispose(){this._codeEditorService.removeCodeEditor(this),this._focusTracker.dispose(),this._actions.clear(),this._contentWidgets={},this._overlayWidgets={},this._removeDecorationTypes(),this._postDetachModelCleanup(this._detachModel()),this._onDidDispose.fire(),super.dispose()}invokeWithinContext(e){return this._instantiationService.invokeFunction(e)}updateOptions(e){this._configuration.updateOptions(e||{})}getOptions(){return this._configuration.options}getOption(e){return this._configuration.options.get(e)}getRawOptions(){return this._configuration.getRawOptions()}getOverflowWidgetsDomNode(){return this._overflowWidgetsDomNode}getConfiguredWordAtPosition(e){return this._modelData?FE.getWordAtPosition(this._modelData.model,this._configuration.options.get(133),this._configuration.options.get(132),e):null}getValue(e=null){if(!this._modelData)return"";let i=!!(e&&e.preserveBOM),n=0;return e&&e.lineEnding&&e.lineEnding===`
`?n=1:e&&e.lineEnding&&e.lineEnding===`\r
`&&(n=2),this._modelData.model.getValue(n,i)}setValue(e){try{if(this._beginUpdate(),!this._modelData)return;this._modelData.model.setValue(e)}finally{this._endUpdate()}}getModel(){return this._modelData?this._modelData.model:null}setModel(e=null){try{this._beginUpdate();let i=e;if(this._modelData===null&&i===null||this._modelData&&this._modelData.model===i)return;let n={oldModelUrl:this._modelData?.model.uri||null,newModelUrl:i?.uri||null};this._onWillChangeModel.fire(n);let o=this.hasTextFocus(),s=this._detachModel();this._attachModel(i),o&&this.hasModel()&&this.focus(),this._removeDecorationTypes(),this._onDidChangeModel.fire(n),this._postDetachModelCleanup(s),this._contributionsDisposable=this._contributions.onAfterModelAttached()}finally{this._endUpdate()}}_removeDecorationTypes(){if(this._decorationTypeKeysToIds={},this._decorationTypeSubtypes){for(let e in this._decorationTypeSubtypes){let i=this._decorationTypeSubtypes[e];for(let n in i)this._removeDecorationType(e+"-"+n)}this._decorationTypeSubtypes={}}}getVisibleRanges(){return this._modelData?this._modelData.viewModel.getVisibleRanges():[]}getVisibleRangesPlusViewportAboveBelow(){return this._modelData?this._modelData.viewModel.getVisibleRangesPlusViewportAboveBelow():[]}getWhitespaces(){return this._modelData?this._modelData.viewModel.viewLayout.getWhitespaces():[]}static _getVerticalOffsetAfterPosition(e,i,n,o){let s=e.model.validatePosition({lineNumber:i,column:n}),a=e.viewModel.coordinatesConverter.convertModelPositionToViewPosition(s);return e.viewModel.viewLayout.getVerticalOffsetAfterLineNumber(a.lineNumber,o)}getTopForLineNumber(e,i=!1){return this._modelData?$s._getVerticalOffsetForPosition(this._modelData,e,1,i):-1}getTopForPosition(e,i){return this._modelData?$s._getVerticalOffsetForPosition(this._modelData,e,i,!1):-1}static _getVerticalOffsetForPosition(e,i,n,o=!1){let s=e.model.validatePosition({lineNumber:i,column:n}),a=e.viewModel.coordinatesConverter.convertModelPositionToViewPosition(s);return e.viewModel.viewLayout.getVerticalOffsetForLineNumber(a.lineNumber,o)}getBottomForLineNumber(e,i=!1){if(!this._modelData)return-1;let n=this._modelData.model.getLineMaxColumn(e);return $s._getVerticalOffsetAfterPosition(this._modelData,e,n,i)}setHiddenAreas(e,i){this._modelData?.viewModel.setHiddenAreas(e.map(n=>L.lift(n)),i)}getVisibleColumnFromPosition(e){if(!this._modelData)return e.column;let i=this._modelData.model.validatePosition(e),n=this._modelData.model.getOptions().tabSize;return tn.visibleColumnFromColumn(this._modelData.model.getLineContent(i.lineNumber),i.column,n)+1}getStatusbarColumn(e){if(!this._modelData)return e.column;let i=this._modelData.model.validatePosition(e),n=this._modelData.model.getOptions().tabSize;return tn.toStatusbarColumn(this._modelData.model.getLineContent(i.lineNumber),i.column,n)}getPosition(){return this._modelData?this._modelData.viewModel.getPosition():null}setPosition(e,i="api"){if(this._modelData){if(!H.isIPosition(e))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(i,[{selectionStartLineNumber:e.lineNumber,selectionStartColumn:e.column,positionLineNumber:e.lineNumber,positionColumn:e.column}])}}_sendRevealRange(e,i,n,o){if(!this._modelData)return;if(!L.isIRange(e))throw new Error("Invalid arguments");let s=this._modelData.model.validateRange(e),a=this._modelData.viewModel.coordinatesConverter.convertModelRangeToViewRange(s);this._modelData.viewModel.revealRange("api",n,a,i,o)}revealLine(e,i=0){this._revealLine(e,0,i)}revealLineInCenter(e,i=0){this._revealLine(e,1,i)}revealLineInCenterIfOutsideViewport(e,i=0){this._revealLine(e,2,i)}revealLineNearTop(e,i=0){this._revealLine(e,5,i)}_revealLine(e,i,n){if(typeof e!="number")throw new Error("Invalid arguments");this._sendRevealRange(new L(e,1,e,1),i,!1,n)}revealPosition(e,i=0){this._revealPosition(e,0,!0,i)}revealPositionInCenter(e,i=0){this._revealPosition(e,1,!0,i)}revealPositionInCenterIfOutsideViewport(e,i=0){this._revealPosition(e,2,!0,i)}revealPositionNearTop(e,i=0){this._revealPosition(e,5,!0,i)}_revealPosition(e,i,n,o){if(!H.isIPosition(e))throw new Error("Invalid arguments");this._sendRevealRange(new L(e.lineNumber,e.column,e.lineNumber,e.column),i,n,o)}getSelection(){return this._modelData?this._modelData.viewModel.getSelection():null}getSelections(){return this._modelData?this._modelData.viewModel.getSelections():null}setSelection(e,i="api"){let n=Et.isISelection(e),o=L.isIRange(e);if(!n&&!o)throw new Error("Invalid arguments");if(n)this._setSelectionImpl(e,i);else if(o){let s={selectionStartLineNumber:e.startLineNumber,selectionStartColumn:e.startColumn,positionLineNumber:e.endLineNumber,positionColumn:e.endColumn};this._setSelectionImpl(s,i)}}_setSelectionImpl(e,i){if(!this._modelData)return;let n=new Et(e.selectionStartLineNumber,e.selectionStartColumn,e.positionLineNumber,e.positionColumn);this._modelData.viewModel.setSelections(i,[n])}revealLines(e,i,n=0){this._revealLines(e,i,0,n)}revealLinesInCenter(e,i,n=0){this._revealLines(e,i,1,n)}revealLinesInCenterIfOutsideViewport(e,i,n=0){this._revealLines(e,i,2,n)}revealLinesNearTop(e,i,n=0){this._revealLines(e,i,5,n)}_revealLines(e,i,n,o){if(typeof e!="number"||typeof i!="number")throw new Error("Invalid arguments");this._sendRevealRange(new L(e,1,i,1),n,!1,o)}revealRange(e,i=0,n=!1,o=!0){this._revealRange(e,n?1:0,o,i)}revealRangeInCenter(e,i=0){this._revealRange(e,1,!0,i)}revealRangeInCenterIfOutsideViewport(e,i=0){this._revealRange(e,2,!0,i)}revealRangeNearTop(e,i=0){this._revealRange(e,5,!0,i)}revealRangeNearTopIfOutsideViewport(e,i=0){this._revealRange(e,6,!0,i)}revealRangeAtTop(e,i=0){this._revealRange(e,3,!0,i)}_revealRange(e,i,n,o){if(!L.isIRange(e))throw new Error("Invalid arguments");this._sendRevealRange(L.lift(e),i,n,o)}setSelections(e,i="api",n=0){if(this._modelData){if(!e||e.length===0)throw new Error("Invalid arguments");for(let o=0,s=e.length;o<s;o++)if(!Et.isISelection(e[o]))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(i,e,n)}}getContentWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getContentWidth():-1}getScrollWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollWidth():-1}getScrollLeft(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollLeft():-1}getContentHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getContentHeight():-1}getScrollHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollHeight():-1}getScrollTop(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollTop():-1}setScrollLeft(e,i=1){if(this._modelData){if(typeof e!="number")throw new Error("Invalid arguments");this._modelData.viewModel.viewLayout.setScrollPosition({scrollLeft:e},i)}}setScrollTop(e,i=1){if(this._modelData){if(typeof e!="number")throw new Error("Invalid arguments");this._modelData.viewModel.viewLayout.setScrollPosition({scrollTop:e},i)}}setScrollPosition(e,i=1){this._modelData&&this._modelData.viewModel.viewLayout.setScrollPosition(e,i)}hasPendingScrollAnimation(){return this._modelData?this._modelData.viewModel.viewLayout.hasPendingScrollAnimation():!1}saveViewState(){if(!this._modelData)return null;let e=this._contributions.saveViewState(),i=this._modelData.viewModel.saveCursorState(),n=this._modelData.viewModel.saveState();return{cursorState:i,viewState:n,contributionsState:e}}restoreViewState(e){if(!this._modelData||!this._modelData.hasRealView)return;let i=e;if(i&&i.cursorState&&i.viewState){let n=i.cursorState;Array.isArray(n)?n.length>0&&this._modelData.viewModel.restoreCursorState(n):this._modelData.viewModel.restoreCursorState([n]),this._contributions.restoreViewState(i.contributionsState||{});let o=this._modelData.viewModel.reduceRestoreState(i.viewState);this._modelData.view.restoreState(o)}}handleInitialized(){this._getViewModel()?.visibleLinesStabilized()}onVisible(){this._modelData?.view.refreshFocusState()}onHide(){this._modelData?.view.refreshFocusState(),this._focusTracker.refreshState()}getContribution(e){return this._contributions.get(e)}getActions(){return Array.from(this._actions.values())}getSupportedActions(){let e=this.getActions();return e=e.filter(i=>i.isSupported()),e}getAction(e){return this._actions.get(e)||null}trigger(e,i,n){n=n||{};try{switch(this._beginUpdate(),i){case"compositionStart":this._startComposition();return;case"compositionEnd":this._endComposition(e);return;case"type":{let s=n;this._type(e,s.text||"");return}case"replacePreviousChar":{let s=n;this._compositionType(e,s.text||"",s.replaceCharCnt||0,0,0);return}case"compositionType":{let s=n;this._compositionType(e,s.text||"",s.replacePrevCharCnt||0,s.replaceNextCharCnt||0,s.positionDelta||0);return}case"paste":{let s=n;this._paste(e,s.text||"",s.pasteOnNewLine||!1,s.multicursorText||null,s.mode||null,s.clipboardEvent);return}case"cut":this._cut(e);return}let o=this.getAction(i);if(o){Promise.resolve(o.run(n)).then(void 0,Xe);return}if(!this._modelData||this._triggerEditorCommand(e,i,n))return;this._triggerCommand(i,n)}finally{this._endUpdate()}}_triggerCommand(e,i){this._commandService.executeCommand(e,i)}_startComposition(){this._modelData&&(this._modelData.viewModel.startComposition(),this._onDidCompositionStart.fire())}_endComposition(e){this._modelData&&(this._modelData.viewModel.endComposition(e),this._onDidCompositionEnd.fire())}_type(e,i){!this._modelData||i.length===0||(e==="keyboard"&&this._onWillType.fire(i),this._modelData.viewModel.type(i,e),e==="keyboard"&&this._onDidType.fire(i))}_compositionType(e,i,n,o,s){this._modelData&&this._modelData.viewModel.compositionType(i,n,o,s,e)}_paste(e,i,n,o,s,a){if(!this._modelData)return;let l=this._modelData.viewModel,d=l.getSelection().getStartPosition();l.paste(i,n,o,e);let c=l.getSelection().getStartPosition();e==="keyboard"&&this._onDidPaste.fire({clipboardEvent:a,range:new L(d.lineNumber,d.column,c.lineNumber,c.column),languageId:s})}_cut(e){this._modelData&&this._modelData.viewModel.cut(e)}_triggerEditorCommand(e,i,n){let o=Fm.getEditorCommand(i);return o?(n=n||{},n.source=e,this._instantiationService.invokeFunction(s=>{Promise.resolve(o.runEditorCommand(s,this,n)).then(void 0,Xe)}),!0):!1}_getViewModel(){return this._modelData?this._modelData.viewModel:null}pushUndoStop(){return!this._modelData||this._configuration.options.get(93)?!1:(this._modelData.model.pushStackElement(),!0)}popUndoStop(){return!this._modelData||this._configuration.options.get(93)?!1:(this._modelData.model.popStackElement(),!0)}executeEdits(e,i,n){if(!this._modelData||this._configuration.options.get(93))return!1;let o;return n?Array.isArray(n)?o=()=>n:o=n:o=()=>null,this._modelData.viewModel.executeEdits(e,i,o),!0}executeCommand(e,i){this._modelData&&this._modelData.viewModel.executeCommand(i,e)}executeCommands(e,i){this._modelData&&this._modelData.viewModel.executeCommands(i,e)}createDecorationsCollection(e){return new U$(this,e)}changeDecorations(e){return this._modelData?this._modelData.model.changeDecorations(e,this._id):null}getLineDecorations(e){return this._modelData?this._modelData.model.getLineDecorations(e,this._id,hI(this._configuration.options)):null}getDecorationsInRange(e){return this._modelData?this._modelData.model.getDecorationsInRange(e,this._id,hI(this._configuration.options)):null}deltaDecorations(e,i){return this._modelData?e.length===0&&i.length===0?e:this._modelData.model.deltaDecorations(e,i,this._id):[]}removeDecorations(e){!this._modelData||e.length===0||this._modelData.model.changeDecorations(i=>{i.deltaDecorations(e,[])})}setDecorationsByType(e,i,n){let o={},s=this._decorationTypeSubtypes[i]||{};this._decorationTypeSubtypes[i]=o;let a=[];for(let d of n){let c=i;if(d.renderOptions){let h=wr(d.renderOptions).toString(16);c=i+"-"+h,!s[h]&&!o[h]&&this._registerDecorationType(e,c,d.renderOptions,i),o[h]=!0}let p=this._resolveDecorationOptions(c,!!d.hoverMessage);d.hoverMessage&&(p.hoverMessage=d.hoverMessage),a.push({range:d.range,options:p})}for(let d in s)o[d]||this._removeDecorationType(i+"-"+d);let l=this._decorationTypeKeysToIds[i]||[];this.changeDecorations(d=>this._decorationTypeKeysToIds[i]=d.deltaDecorations(l,a))}setDecorationsByTypeFast(e,i){let n=this._decorationTypeSubtypes[e]||{};for(let l in n)this._removeDecorationType(e+"-"+l);this._decorationTypeSubtypes[e]={};let o=Ii.createDynamic(this._resolveDecorationOptions(e,!1)),s=new Array(i.length);for(let l=0,d=i.length;l<d;l++)s[l]={range:i[l],options:o};let a=this._decorationTypeKeysToIds[e]||[];this.changeDecorations(l=>this._decorationTypeKeysToIds[e]=l.deltaDecorations(a,s))}removeDecorationsByType(e){let i=this._decorationTypeKeysToIds[e];i&&this.changeDecorations(n=>n.deltaDecorations(i,[])),this._decorationTypeKeysToIds.hasOwnProperty(e)&&delete this._decorationTypeKeysToIds[e],this._decorationTypeSubtypes.hasOwnProperty(e)&&delete this._decorationTypeSubtypes[e]}getLayoutInfo(){return this._configuration.options.get(147)}createOverviewRuler(e){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.createOverviewRuler(e)}getContainerDomNode(){return this._domElement}getDomNode(){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.domNode.domNode}delegateVerticalScrollbarPointerDown(e){!this._modelData||!this._modelData.hasRealView||this._modelData.view.delegateVerticalScrollbarPointerDown(e)}delegateScrollFromMouseWheelEvent(e){!this._modelData||!this._modelData.hasRealView||this._modelData.view.delegateScrollFromMouseWheelEvent(e)}layout(e,i=!1){this._configuration.observeContainer(e),i||this.render()}focus(){!this._modelData||!this._modelData.hasRealView||this._modelData.view.focus()}hasTextFocus(){return!this._modelData||!this._modelData.hasRealView?!1:this._modelData.view.isFocused()}hasWidgetFocus(){return this._focusTracker&&this._focusTracker.hasFocus()}addContentWidget(e){let i={widget:e,position:e.getPosition()};this._contentWidgets.hasOwnProperty(e.getId())&&console.warn("Overwriting a content widget with the same id:"+e.getId()),this._contentWidgets[e.getId()]=i,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addContentWidget(i)}layoutContentWidget(e){let i=e.getId();if(this._contentWidgets.hasOwnProperty(i)){let n=this._contentWidgets[i];n.position=e.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutContentWidget(n)}}removeContentWidget(e){let i=e.getId();if(this._contentWidgets.hasOwnProperty(i)){let n=this._contentWidgets[i];delete this._contentWidgets[i],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeContentWidget(n)}}addOverlayWidget(e){let i={widget:e,position:e.getPosition()};this._overlayWidgets.hasOwnProperty(e.getId())&&console.warn("Overwriting an overlay widget with the same id."),this._overlayWidgets[e.getId()]=i,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addOverlayWidget(i)}layoutOverlayWidget(e){let i=e.getId();if(this._overlayWidgets.hasOwnProperty(i)){let n=this._overlayWidgets[i];n.position=e.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutOverlayWidget(n)}}removeOverlayWidget(e){let i=e.getId();if(this._overlayWidgets.hasOwnProperty(i)){let n=this._overlayWidgets[i];delete this._overlayWidgets[i],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeOverlayWidget(n)}}addGlyphMarginWidget(e){let i={widget:e,position:e.getPosition()};this._glyphMarginWidgets.hasOwnProperty(e.getId())&&console.warn("Overwriting a glyph margin widget with the same id."),this._glyphMarginWidgets[e.getId()]=i,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addGlyphMarginWidget(i)}layoutGlyphMarginWidget(e){let i=e.getId();if(this._glyphMarginWidgets.hasOwnProperty(i)){let n=this._glyphMarginWidgets[i];n.position=e.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutGlyphMarginWidget(n)}}removeGlyphMarginWidget(e){let i=e.getId();if(this._glyphMarginWidgets.hasOwnProperty(i)){let n=this._glyphMarginWidgets[i];delete this._glyphMarginWidgets[i],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeGlyphMarginWidget(n)}}changeViewZones(e){!this._modelData||!this._modelData.hasRealView||this._modelData.view.change(e)}getTargetAtClientPoint(e,i){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.getTargetAtClientPoint(e,i)}getScrolledVisiblePosition(e){if(!this._modelData||!this._modelData.hasRealView)return null;let i=this._modelData.model.validatePosition(e),n=this._configuration.options,o=n.get(147),s=$s._getVerticalOffsetForPosition(this._modelData,i.lineNumber,i.column)-this.getScrollTop(),a=this._modelData.view.getOffsetForColumn(i.lineNumber,i.column)+o.glyphMarginWidth+o.lineNumbersWidth+o.decorationsWidth-this.getScrollLeft();return{top:s,left:a,height:n.get(68)}}getOffsetForColumn(e,i){return!this._modelData||!this._modelData.hasRealView?-1:this._modelData.view.getOffsetForColumn(e,i)}render(e=!1){!this._modelData||!this._modelData.hasRealView||this._modelData.viewModel.batchEvents(()=>{this._modelData.view.render(!0,e)})}setAriaOptions(e){!this._modelData||!this._modelData.hasRealView||this._modelData.view.setAriaOptions(e)}applyFontInfo(e){hn(e,this._configuration.options.get(51))}setBanner(e,i){this._bannerDomNode&&this._domElement.contains(this._bannerDomNode)&&this._bannerDomNode.remove(),this._bannerDomNode=e,this._configuration.setReservedHeight(e?i:0),this._bannerDomNode&&this._domElement.prepend(this._bannerDomNode)}_attachModel(e){if(!e){this._modelData=null;return}let i=[];this._domElement.setAttribute("data-mode-id",e.getLanguageId()),this._configuration.setIsDominatedByLongLines(e.isDominatedByLongLines()),this._configuration.setModelLineCount(e.getLineCount());let n=e.onBeforeAttached(),o=new PH(this._id,this._configuration,e,eH.create(ue(this._domElement)),nH.create(this._configuration.options),l=>eo(ue(this._domElement),l),this.languageConfigurationService,this._themeService,n,{batchChanges:l=>{try{return this._beginUpdate(),l()}finally{this._endUpdate()}}});i.push(e.onWillDispose(()=>this.setModel(null))),i.push(o.onEvent(l=>{switch(l.kind){case 0:this._onDidContentSizeChange.fire(l);break;case 1:this._editorTextFocus.setValue(l.hasFocus);break;case 2:this._onDidScrollChange.fire(l);break;case 3:this._onDidChangeViewZones.fire();break;case 4:this._onDidChangeHiddenAreas.fire();break;case 5:this._onDidAttemptReadOnlyEdit.fire();break;case 6:{if(l.reachedMaxCursorCount){let h=this.getOption(81),m=u("cursors.maximum","The number of cursors has been limited to {0}. Consider using [find and replace](https://code.visualstudio.com/docs/editor/codebasics#_find-and-replace) for larger changes or increase the editor multi cursor limit setting.",h);this._notificationService.prompt(Sc.Warning,m,[{label:"Find and Replace",run:()=>{this._commandService.executeCommand("editor.action.startFindReplaceAction")}},{label:u("goToSetting","Increase Multi Cursor Limit"),run:()=>{this._commandService.executeCommand("workbench.action.openSettings2",{query:"editor.multiCursorLimit"})}}])}let d=[];for(let h=0,m=l.selections.length;h<m;h++)d[h]=l.selections[h].getPosition();let c={position:d[0],secondaryPositions:d.slice(1),reason:l.reason,source:l.source};this._onDidChangeCursorPosition.fire(c);let p={selection:l.selections[0],secondarySelections:l.selections.slice(1),modelVersionId:l.modelVersionId,oldSelections:l.oldSelections,oldModelVersionId:l.oldModelVersionId,source:l.source,reason:l.reason};this._onDidChangeCursorSelection.fire(p);break}case 7:this._onDidChangeModelDecorations.fire(l.event);break;case 8:this._domElement.setAttribute("data-mode-id",e.getLanguageId()),this._onDidChangeModelLanguage.fire(l.event);break;case 9:this._onDidChangeModelLanguageConfiguration.fire(l.event);break;case 10:this._onDidChangeModelContent.fire(l.event);break;case 11:this._onDidChangeModelOptions.fire(l.event);break;case 12:this._onDidChangeModelTokens.fire(l.event);break}}));let[s,a]=this._createView(o);if(a){this._domElement.appendChild(s.domNode.domNode);let l=Object.keys(this._contentWidgets);for(let d=0,c=l.length;d<c;d++){let p=l[d];s.addContentWidget(this._contentWidgets[p])}l=Object.keys(this._overlayWidgets);for(let d=0,c=l.length;d<c;d++){let p=l[d];s.addOverlayWidget(this._overlayWidgets[p])}l=Object.keys(this._glyphMarginWidgets);for(let d=0,c=l.length;d<c;d++){let p=l[d];s.addGlyphMarginWidget(this._glyphMarginWidgets[p])}s.render(!1,!0),s.domNode.domNode.setAttribute("data-uri",e.uri.toString())}this._modelData=new B$(e,o,s,a,i,n)}_createView(e){let i;this.isSimpleWidget?i={paste:(s,a,l,d)=>{this._paste("keyboard",s,a,l,d)},type:s=>{this._type("keyboard",s)},compositionType:(s,a,l,d)=>{this._compositionType("keyboard",s,a,l,d)},startComposition:()=>{this._startComposition()},endComposition:()=>{this._endComposition("keyboard")},cut:()=>{this._cut("keyboard")}}:i={paste:(s,a,l,d)=>{let c={text:s,pasteOnNewLine:a,multicursorText:l,mode:d};this._commandService.executeCommand("paste",c)},type:s=>{let a={text:s};this._commandService.executeCommand("type",a)},compositionType:(s,a,l,d)=>{if(l||d){let c={text:s,replacePrevCharCnt:a,replaceNextCharCnt:l,positionDelta:d};this._commandService.executeCommand("compositionType",c)}else{let c={text:s,replaceCharCnt:a};this._commandService.executeCommand("replacePreviousChar",c)}},startComposition:()=>{this._commandService.executeCommand("compositionStart",{})},endComposition:()=>{this._commandService.executeCommand("compositionEnd",{})},cut:()=>{this._commandService.executeCommand("cut",{})}};let n=new KE(e.coordinatesConverter);return n.onKeyDown=s=>this._onKeyDown.fire(s),n.onKeyUp=s=>this._onKeyUp.fire(s),n.onContextMenu=s=>this._onContextMenu.fire(s),n.onMouseMove=s=>this._onMouseMove.fire(s),n.onMouseLeave=s=>this._onMouseLeave.fire(s),n.onMouseDown=s=>this._onMouseDown.fire(s),n.onMouseUp=s=>this._onMouseUp.fire(s),n.onMouseDrag=s=>this._onMouseDrag.fire(s),n.onMouseDrop=s=>this._onMouseDrop.fire(s),n.onMouseDropCanceled=s=>this._onMouseDropCanceled.fire(s),n.onMouseWheel=s=>this._onMouseWheel.fire(s),[new ox(i,this._configuration,this._themeService.getColorTheme(),e,n,this._overflowWidgetsDomNode,this._instantiationService),!0]}_postDetachModelCleanup(e){e?.removeAllDecorationsWithOwnerId(this._id)}_detachModel(){if(this._contributionsDisposable?.dispose(),this._contributionsDisposable=void 0,!this._modelData)return null;let e=this._modelData.model,i=this._modelData.hasRealView?this._modelData.view.domNode.domNode:null;return this._modelData.dispose(),this._modelData=null,this._domElement.removeAttribute("data-mode-id"),i&&this._domElement.contains(i)&&i.remove(),this._bannerDomNode&&this._domElement.contains(this._bannerDomNode)&&this._bannerDomNode.remove(),e}_registerDecorationType(e,i,n,o){this._codeEditorService.registerDecorationType(e,i,n,o,this)}_removeDecorationType(e){this._codeEditorService.removeDecorationType(e)}_resolveDecorationOptions(e,i){return this._codeEditorService.resolveDecorationOptions(e,i)}getTelemetryData(){return this._telemetryData}hasModel(){return this._modelData!==null}showDropIndicatorAt(e){let i=[{range:new L(e.lineNumber,e.column,e.lineNumber,e.column),options:$s.dropIntoEditorDecorationOptions}];this._dropIntoEditorDecorations.set(i),this.revealPosition(e,1)}removeDropIndicator(){this._dropIntoEditorDecorations.clear()}setContextValue(e,i){this._contextKeyService.createKey(e,i)}_beginUpdate(){this._updateCounter++,this._updateCounter===1&&this._onBeginUpdate.fire()}_endUpdate(){this._updateCounter--,this._updateCounter===0&&this._onEndUpdate.fire()}};$s=E([b(3,ne),b(4,En),b(5,ct),b(6,re),b(7,Fe),b(8,mi),b(9,Un),b(10,Do),b(11,ni)],$s);var cxe=0,B$=class{constructor(t,e,i,n,o,s){this.model=t;this.viewModel=e;this.view=i;this.hasRealView=n;this.listenersToRemove=o;this.attachedView=s}dispose(){_e(this.listenersToRemove),this.model.onBeforeDetached(this.attachedView),this.hasRealView&&this.view.dispose(),this.viewModel.dispose()}};var AH=class extends R{constructor(e){super();this._emitterOptions=e;this._value=0}_onDidChangeToTrue=this._register(new x(this._emitterOptions));onDidChangeToTrue=this._onDidChangeToTrue.event;_onDidChangeToFalse=this._register(new x(this._emitterOptions));onDidChangeToFalse=this._onDidChangeToFalse.event;_value;setValue(e){let i=e?2:1;this._value!==i&&(this._value=i,this._value===2?this._onDidChangeToTrue.fire():this._value===1&&this._onDidChangeToFalse.fire())}},ss=class extends x{constructor(e,i){super({deliveryQueue:i});this._contributions=e}fire(e){this._contributions.onBeforeInteractionEvent(),super.fire(e)}},V$=class extends R{_editor;_editorSimpleInput;_editorFocus;_textInputFocus;_editorTextFocus;_tabMovesFocus;_editorReadonly;_inDiffEditor;_editorColumnSelection;_hasMultipleSelections;_hasNonEmptySelection;_canUndo;_canRedo;constructor(t,e){super(),this._editor=t,e.createKey("editorId",t.getId()),this._editorSimpleInput=ce.editorSimpleInput.bindTo(e),this._editorFocus=ce.focus.bindTo(e),this._textInputFocus=ce.textInputFocus.bindTo(e),this._editorTextFocus=ce.editorTextFocus.bindTo(e),this._tabMovesFocus=ce.tabMovesFocus.bindTo(e),this._editorReadonly=ce.readOnly.bindTo(e),this._inDiffEditor=ce.inDiffEditor.bindTo(e),this._editorColumnSelection=ce.columnSelection.bindTo(e),this._hasMultipleSelections=ce.hasMultipleSelections.bindTo(e),this._hasNonEmptySelection=ce.hasNonEmptySelection.bindTo(e),this._canUndo=ce.canUndo.bindTo(e),this._canRedo=ce.canRedo.bindTo(e),this._register(this._editor.onDidChangeConfiguration(()=>this._updateFromConfig())),this._register(this._editor.onDidChangeCursorSelection(()=>this._updateFromSelection())),this._register(this._editor.onDidFocusEditorWidget(()=>this._updateFromFocus())),this._register(this._editor.onDidBlurEditorWidget(()=>this._updateFromFocus())),this._register(this._editor.onDidFocusEditorText(()=>this._updateFromFocus())),this._register(this._editor.onDidBlurEditorText(()=>this._updateFromFocus())),this._register(this._editor.onDidChangeModel(()=>this._updateFromModel())),this._register(this._editor.onDidChangeConfiguration(()=>this._updateFromModel())),this._register(uC.onDidChangeTabFocus(i=>this._tabMovesFocus.set(i))),this._updateFromConfig(),this._updateFromSelection(),this._updateFromFocus(),this._updateFromModel(),this._editorSimpleInput.set(this._editor.isSimpleWidget)}_updateFromConfig(){let t=this._editor.getOptions();this._tabMovesFocus.set(uC.getTabFocusMode()),this._editorReadonly.set(t.get(93)),this._inDiffEditor.set(t.get(62)),this._editorColumnSelection.set(t.get(22))}_updateFromSelection(){let t=this._editor.getSelections();t?(this._hasMultipleSelections.set(t.length>1),this._hasNonEmptySelection.set(t.some(e=>!e.isEmpty()))):(this._hasMultipleSelections.reset(),this._hasNonEmptySelection.reset())}_updateFromFocus(){this._editorFocus.set(this._editor.hasWidgetFocus()&&!this._editor.isSimpleWidget),this._editorTextFocus.set(this._editor.hasTextFocus()&&!this._editor.isSimpleWidget),this._textInputFocus.set(this._editor.hasTextFocus())}_updateFromModel(){let t=this._editor.getModel();this._canUndo.set(!!(t&&t.canUndo())),this._canRedo.set(!!(t&&t.canRedo()))}},W$=class extends R{constructor(e,i,n){super();this._editor=e;this._contextKeyService=i;this._languageFeaturesService=n;this._langId=ce.languageId.bindTo(i),this._hasCompletionItemProvider=ce.hasCompletionItemProvider.bindTo(i),this._hasCodeActionsProvider=ce.hasCodeActionsProvider.bindTo(i),this._hasCodeLensProvider=ce.hasCodeLensProvider.bindTo(i),this._hasDefinitionProvider=ce.hasDefinitionProvider.bindTo(i),this._hasDeclarationProvider=ce.hasDeclarationProvider.bindTo(i),this._hasImplementationProvider=ce.hasImplementationProvider.bindTo(i),this._hasTypeDefinitionProvider=ce.hasTypeDefinitionProvider.bindTo(i),this._hasHoverProvider=ce.hasHoverProvider.bindTo(i),this._hasDocumentHighlightProvider=ce.hasDocumentHighlightProvider.bindTo(i),this._hasDocumentSymbolProvider=ce.hasDocumentSymbolProvider.bindTo(i),this._hasReferenceProvider=ce.hasReferenceProvider.bindTo(i),this._hasRenameProvider=ce.hasRenameProvider.bindTo(i),this._hasSignatureHelpProvider=ce.hasSignatureHelpProvider.bindTo(i),this._hasInlayHintsProvider=ce.hasInlayHintsProvider.bindTo(i),this._hasDocumentFormattingProvider=ce.hasDocumentFormattingProvider.bindTo(i),this._hasDocumentSelectionFormattingProvider=ce.hasDocumentSelectionFormattingProvider.bindTo(i),this._hasMultipleDocumentFormattingProvider=ce.hasMultipleDocumentFormattingProvider.bindTo(i),this._hasMultipleDocumentSelectionFormattingProvider=ce.hasMultipleDocumentSelectionFormattingProvider.bindTo(i),this._isInEmbeddedEditor=ce.isInEmbeddedEditor.bindTo(i);let o=()=>this._update();this._register(e.onDidChangeModel(o)),this._register(e.onDidChangeModelLanguage(o)),this._register(n.completionProvider.onDidChange(o)),this._register(n.codeActionProvider.onDidChange(o)),this._register(n.codeLensProvider.onDidChange(o)),this._register(n.definitionProvider.onDidChange(o)),this._register(n.declarationProvider.onDidChange(o)),this._register(n.implementationProvider.onDidChange(o)),this._register(n.typeDefinitionProvider.onDidChange(o)),this._register(n.hoverProvider.onDidChange(o)),this._register(n.documentHighlightProvider.onDidChange(o)),this._register(n.documentSymbolProvider.onDidChange(o)),this._register(n.referenceProvider.onDidChange(o)),this._register(n.renameProvider.onDidChange(o)),this._register(n.documentFormattingEditProvider.onDidChange(o)),this._register(n.documentRangeFormattingEditProvider.onDidChange(o)),this._register(n.signatureHelpProvider.onDidChange(o)),this._register(n.inlayHintsProvider.onDidChange(o)),o()}_langId;_hasCompletionItemProvider;_hasCodeActionsProvider;_hasCodeLensProvider;_hasDefinitionProvider;_hasDeclarationProvider;_hasImplementationProvider;_hasTypeDefinitionProvider;_hasHoverProvider;_hasDocumentHighlightProvider;_hasDocumentSymbolProvider;_hasReferenceProvider;_hasRenameProvider;_hasDocumentFormattingProvider;_hasDocumentSelectionFormattingProvider;_hasMultipleDocumentFormattingProvider;_hasMultipleDocumentSelectionFormattingProvider;_hasSignatureHelpProvider;_hasInlayHintsProvider;_isInEmbeddedEditor;dispose(){super.dispose()}reset(){this._contextKeyService.bufferChangeEvents(()=>{this._langId.reset(),this._hasCompletionItemProvider.reset(),this._hasCodeActionsProvider.reset(),this._hasCodeLensProvider.reset(),this._hasDefinitionProvider.reset(),this._hasDeclarationProvider.reset(),this._hasImplementationProvider.reset(),this._hasTypeDefinitionProvider.reset(),this._hasHoverProvider.reset(),this._hasDocumentHighlightProvider.reset(),this._hasDocumentSymbolProvider.reset(),this._hasReferenceProvider.reset(),this._hasRenameProvider.reset(),this._hasDocumentFormattingProvider.reset(),this._hasDocumentSelectionFormattingProvider.reset(),this._hasSignatureHelpProvider.reset(),this._isInEmbeddedEditor.reset()})}_update(){let e=this._editor.getModel();if(!e){this.reset();return}this._contextKeyService.bufferChangeEvents(()=>{this._langId.set(e.getLanguageId()),this._hasCompletionItemProvider.set(this._languageFeaturesService.completionProvider.has(e)),this._hasCodeActionsProvider.set(this._languageFeaturesService.codeActionProvider.has(e)),this._hasCodeLensProvider.set(this._languageFeaturesService.codeLensProvider.has(e)),this._hasDefinitionProvider.set(this._languageFeaturesService.definitionProvider.has(e)),this._hasDeclarationProvider.set(this._languageFeaturesService.declarationProvider.has(e)),this._hasImplementationProvider.set(this._languageFeaturesService.implementationProvider.has(e)),this._hasTypeDefinitionProvider.set(this._languageFeaturesService.typeDefinitionProvider.has(e)),this._hasHoverProvider.set(this._languageFeaturesService.hoverProvider.has(e)),this._hasDocumentHighlightProvider.set(this._languageFeaturesService.documentHighlightProvider.has(e)),this._hasDocumentSymbolProvider.set(this._languageFeaturesService.documentSymbolProvider.has(e)),this._hasReferenceProvider.set(this._languageFeaturesService.referenceProvider.has(e)),this._hasRenameProvider.set(this._languageFeaturesService.renameProvider.has(e)),this._hasSignatureHelpProvider.set(this._languageFeaturesService.signatureHelpProvider.has(e)),this._hasInlayHintsProvider.set(this._languageFeaturesService.inlayHintsProvider.has(e)),this._hasDocumentFormattingProvider.set(this._languageFeaturesService.documentFormattingEditProvider.has(e)||this._languageFeaturesService.documentRangeFormattingEditProvider.has(e)),this._hasDocumentSelectionFormattingProvider.set(this._languageFeaturesService.documentRangeFormattingEditProvider.has(e)),this._hasMultipleDocumentFormattingProvider.set(this._languageFeaturesService.documentFormattingEditProvider.all(e).length+this._languageFeaturesService.documentRangeFormattingEditProvider.all(e).length>1),this._hasMultipleDocumentSelectionFormattingProvider.set(this._languageFeaturesService.documentRangeFormattingEditProvider.all(e).length>1),this._isInEmbeddedEditor.set(e.uri.scheme===Ie.walkThroughSnippet||e.uri.scheme===Ie.vscodeChatCodeBlock)})}},H$=class extends R{_hasDomElementFocus;_domFocusTracker;_overflowWidgetsDomNode;_onChange=this._register(new x);onChange=this._onChange.event;_overflowWidgetsDomNodeHasFocus;_hadFocus=void 0;constructor(t,e){super(),this._hasDomElementFocus=!1,this._domFocusTracker=this._register(Er(t)),this._overflowWidgetsDomNodeHasFocus=!1,this._register(this._domFocusTracker.onDidFocus(()=>{this._hasDomElementFocus=!0,this._update()})),this._register(this._domFocusTracker.onDidBlur(()=>{this._hasDomElementFocus=!1,this._update()})),e&&(this._overflowWidgetsDomNode=this._register(Er(e)),this._register(this._overflowWidgetsDomNode.onDidFocus(()=>{this._overflowWidgetsDomNodeHasFocus=!0,this._update()})),this._register(this._overflowWidgetsDomNode.onDidBlur(()=>{this._overflowWidgetsDomNodeHasFocus=!1,this._update()})))}_update(){let t=this._hasDomElementFocus||this._overflowWidgetsDomNodeHasFocus;this._hadFocus!==t&&(this._hadFocus=t,this._onChange.fire(void 0))}hasFocus(){return this._hadFocus??!1}refreshState(){this._domFocusTracker.refreshState(),this._overflowWidgetsDomNode?.refreshState?.()}},U$=class{constructor(t,e){this._editor=t;Array.isArray(e)&&e.length>0&&this.set(e)}_decorationIds=[];_isChangingDecorations=!1;get length(){return this._decorationIds.length}onDidChange(t,e,i){return this._editor.onDidChangeModelDecorations(n=>{this._isChangingDecorations||t.call(e,n)},i)}getRange(t){return!this._editor.hasModel()||t>=this._decorationIds.length?null:this._editor.getModel().getDecorationRange(this._decorationIds[t])}getRanges(){if(!this._editor.hasModel())return[];let t=this._editor.getModel(),e=[];for(let i of this._decorationIds){let n=t.getDecorationRange(i);n&&e.push(n)}return e}has(t){return this._decorationIds.includes(t.id)}clear(){this._decorationIds.length!==0&&this.set([])}set(t){try{this._isChangingDecorations=!0,this._editor.changeDecorations(e=>{this._decorationIds=e.deltaDecorations(this._decorationIds,t)})}finally{this._isChangingDecorations=!1}return this._decorationIds}append(t){let e=[];try{this._isChangingDecorations=!0,this._editor.changeDecorations(i=>{e=i.deltaDecorations([],t),this._decorationIds=this._decorationIds.concat(e)})}finally{this._isChangingDecorations=!1}return e}},uxe=encodeURIComponent("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 6 3' enable-background='new 0 0 6 3' height='3' width='6'><g fill='"),pxe=encodeURIComponent("'><polygon points='5.5,0 2.5,3 1.1,3 4.1,0'/><polygon points='4,0 6,2 6,0.6 5.4,0'/><polygon points='0,2 1,3 2.4,3 0,0.6'/></g></svg>");function F$(r){return uxe+encodeURIComponent(r.toString())+pxe}var hxe=encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" height="3" width="12"><g fill="'),mxe=encodeURIComponent('"><circle cx="1" cy="1" r="1"/><circle cx="5" cy="1" r="1"/><circle cx="9" cy="1" r="1"/></g></svg>');function gxe(r){return hxe+encodeURIComponent(r.toString())+mxe}Zo((r,t)=>{let e=r.getColor(xI);e&&t.addRule(`.monaco-editor .squiggly-error { background: url("data:image/svg+xml,${F$(e)}") repeat-x bottom left; }`);let i=r.getColor(Zr);i&&t.addRule(`.monaco-editor .squiggly-warning { background: url("data:image/svg+xml,${F$(i)}") repeat-x bottom left; }`);let n=r.getColor(Jr);n&&t.addRule(`.monaco-editor .squiggly-info { background: url("data:image/svg+xml,${F$(n)}") repeat-x bottom left; }`);let o=r.getColor(mne);o&&t.addRule(`.monaco-editor .squiggly-hint { background: url("data:image/svg+xml,${gxe(o)}") no-repeat bottom left; }`);let s=r.getColor(Wre);s&&t.addRule(`.monaco-editor.showUnused .squiggly-inline-unnecessary { opacity: ${s.rgba.a}; }`)});var z$=class r{static _table={36:0,58:1,44:2,123:3,125:4,92:5,47:6,124:7,43:11,45:12,63:13};static isDigitCharacter(t){return t>=48&&t<=57}static isVariableCharacter(t){return t===95||t>=97&&t<=122||t>=65&&t<=90}value="";pos=0;text(t){this.value=t,this.pos=0}tokenText(t){return this.value.substr(t.pos,t.len)}next(){if(this.pos>=this.value.length)return{type:14,pos:this.pos,len:0};let t=this.pos,e=0,i=this.value.charCodeAt(t),n;if(n=r._table[i],typeof n=="number")return this.pos+=1,{type:n,pos:t,len:1};if(r.isDigitCharacter(i)){n=8;do e+=1,i=this.value.charCodeAt(t+e);while(r.isDigitCharacter(i));return this.pos+=e,{type:n,pos:t,len:e}}if(r.isVariableCharacter(i)){n=9;do i=this.value.charCodeAt(t+ ++e);while(r.isVariableCharacter(i)||r.isDigitCharacter(i));return this.pos+=e,{type:n,pos:t,len:e}}n=10;do e+=1,i=this.value.charCodeAt(t+e);while(!isNaN(i)&&typeof r._table[i]>"u"&&!r.isDigitCharacter(i)&&!r.isVariableCharacter(i));return this.pos+=e,{type:n,pos:t,len:e}}},Ab=class{_markerBrand;parent;_children=[];appendChild(t){return t instanceof vr&&this._children[this._children.length-1]instanceof vr?this._children[this._children.length-1].value+=t.value:(t.parent=this,this._children.push(t)),this}replace(t,e){let{parent:i}=t,n=i.children.indexOf(t),o=i.children.slice(0);o.splice(n,1,...e),i._children=o,function s(a,l){for(let d of a)d.parent=l,s(d.children,d)}(e,i)}get children(){return this._children}get rightMostDescendant(){return this._children.length>0?this._children[this._children.length-1].rightMostDescendant:this}get snippet(){let t=this;for(;;){if(!t)return;if(t instanceof rx)return t;t=t.parent}}toString(){return this.children.reduce((t,e)=>t+e.toString(),"")}len(){return 0}},vr=class r extends Ab{constructor(e){super();this.value=e}static escape(e){return e.replace(/\$|}|\\/g,"\\$&")}toString(){return this.value}toTextmateString(){return r.escape(this.value)}len(){return this.value.length}clone(){return new r(this.value)}},OH=class extends Ab{transform},da=class r extends OH{constructor(e){super();this.index=e}static compareByIndex(e,i){return e.index===i.index?0:e.isFinalTabstop?1:i.isFinalTabstop||e.index<i.index?-1:e.index>i.index?1:0}get isFinalTabstop(){return this.index===0}get choice(){return this._children.length===1&&this._children[0]instanceof Py?this._children[0]:void 0}toTextmateString(){let e="";return this.transform&&(e=this.transform.toTextmateString()),this.children.length===0&&!this.transform?`$${this.index}`:this.children.length===0?`\${${this.index}${e}}`:this.choice?`\${${this.index}|${this.choice.toTextmateString()}|${e}}`:`\${${this.index}:${this.children.map(i=>i.toTextmateString()).join("")}${e}}`}clone(){let e=new r(this.index);return this.transform&&(e.transform=this.transform.clone()),e._children=this.children.map(i=>i.clone()),e}},Py=class r extends Ab{options=[];appendChild(t){return t instanceof vr&&(t.parent=this,this.options.push(t)),this}toString(){return this.options[0].value}toTextmateString(){return this.options.map(t=>t.value.replace(/\||,|\\/g,"\\$&")).join(",")}len(){return this.options[0].len()}clone(){let t=new r;return this.options.forEach(t.appendChild,t),t}},K$=class r extends Ab{regexp=new RegExp("");resolve(t){let e=this,i=!1,n=t.replace(this.regexp,function(){return i=!0,e._replace(Array.prototype.slice.call(arguments,0,-2))});return!i&&this._children.some(o=>o instanceof Vu&&!!o.elseValue)&&(n=this._replace([])),n}_replace(t){let e="";for(let i of this._children)if(i instanceof Vu){let n=t[i.index]||"";n=i.resolve(n),e+=n}else e+=i.toString();return e}toString(){return""}toTextmateString(){return`/${this.regexp.source}/${this.children.map(t=>t.toTextmateString())}/${(this.regexp.ignoreCase?"i":"")+(this.regexp.global?"g":"")}`}clone(){let t=new r;return t.regexp=new RegExp(this.regexp.source,(this.regexp.ignoreCase?"i":"")+(this.regexp.global?"g":"")),t._children=this.children.map(e=>e.clone()),t}},Vu=class r extends Ab{constructor(e,i,n,o){super();this.index=e;this.shorthandName=i;this.ifValue=n;this.elseValue=o}resolve(e){return this.shorthandName==="upcase"?e?e.toLocaleUpperCase():"":this.shorthandName==="downcase"?e?e.toLocaleLowerCase():"":this.shorthandName==="capitalize"?e?e[0].toLocaleUpperCase()+e.substr(1):"":this.shorthandName==="pascalcase"?e?this._toPascalCase(e):"":this.shorthandName==="camelcase"?e?this._toCamelCase(e):"":e&&typeof this.ifValue=="string"?this.ifValue:!e&&typeof this.elseValue=="string"?this.elseValue:e||""}_toPascalCase(e){let i=e.match(/[a-z0-9]+/gi);return i?i.map(n=>n.charAt(0).toUpperCase()+n.substr(1)).join(""):e}_toCamelCase(e){let i=e.match(/[a-z0-9]+/gi);return i?i.map((n,o)=>o===0?n.charAt(0).toLowerCase()+n.substr(1):n.charAt(0).toUpperCase()+n.substr(1)).join(""):e}toTextmateString(){let e="${";return e+=this.index,this.shorthandName?e+=`:/${this.shorthandName}`:this.ifValue&&this.elseValue?e+=`:?${this.ifValue}:${this.elseValue}`:this.ifValue?e+=`:+${this.ifValue}`:this.elseValue&&(e+=`:-${this.elseValue}`),e+="}",e}clone(){return new r(this.index,this.shorthandName,this.ifValue,this.elseValue)}},My=class r extends OH{constructor(e){super();this.name=e}resolve(e){let i=e.resolve(this);return this.transform&&(i=this.transform.resolve(i||"")),i!==void 0?(this._children=[new vr(i)],!0):!1}toTextmateString(){let e="";return this.transform&&(e=this.transform.toTextmateString()),this.children.length===0?`\${${this.name}${e}}`:`\${${this.name}:${this.children.map(i=>i.toTextmateString()).join("")}${e}}`}clone(){let e=new r(this.name);return this.transform&&(e.transform=this.transform.clone()),e._children=this.children.map(i=>i.clone()),e}};function Yce(r,t){let e=[...r];for(;e.length>0;){let i=e.shift();if(!t(i))break;e.unshift(...i.children)}}var rx=class r extends Ab{_placeholders;get placeholderInfo(){if(!this._placeholders){let t=[],e;this.walk(function(i){return i instanceof da&&(t.push(i),e=!e||e.index<i.index?i:e),!0}),this._placeholders={all:t,last:e}}return this._placeholders}get placeholders(){let{all:t}=this.placeholderInfo;return t}offset(t){let e=0,i=!1;return this.walk(n=>n===t?(i=!0,!1):(e+=n.len(),!0)),i?e:-1}fullLen(t){let e=0;return Yce([t],i=>(e+=i.len(),!0)),e}enclosingPlaceholders(t){let e=[],{parent:i}=t;for(;i;)i instanceof da&&e.push(i),i=i.parent;return e}resolveVariables(t){return this.walk(e=>(e instanceof My&&e.resolve(t)&&(this._placeholders=void 0),!0)),this}appendChild(t){return this._placeholders=void 0,super.appendChild(t)}replace(t,e){return this._placeholders=void 0,super.replace(t,e)}toTextmateString(){return this.children.reduce((t,e)=>t+e.toTextmateString(),"")}clone(){let t=new r;return this._children=this.children.map(e=>e.clone()),t}walk(t){Yce(this.children,t)}},Fa=class r{static escape(t){return t.replace(/\$|}|\\/g,"\\$&")}static asInsertText(t){return new r().parse(t).toString()}static guessNeedsClipboard(t){return/\${?CLIPBOARD/.test(t)}_scanner=new z$;_token={type:14,pos:0,len:0};parse(t,e,i){let n=new rx;return this.parseFragment(t,n),this.ensureFinalTabstop(n,i??!1,e??!1),n}parseFragment(t,e){let i=e.children.length;for(this._scanner.text(t),this._token=this._scanner.next();this._parse(e););let n=new Map,o=[];e.walk(l=>(l instanceof da&&(l.isFinalTabstop?n.set(0,void 0):!n.has(l.index)&&l.children.length>0?n.set(l.index,l.children):o.push(l)),!0));let s=(l,d)=>{let c=n.get(l.index);if(!c)return;let p=new da(l.index);p.transform=l.transform;for(let h of c){let m=h.clone();p.appendChild(m),m instanceof da&&n.has(m.index)&&!d.has(m.index)&&(d.add(m.index),s(m,d),d.delete(m.index))}e.replace(l,[p])},a=new Set;for(let l of o)s(l,a);return e.children.slice(i)}ensureFinalTabstop(t,e,i){(e||i&&t.placeholders.length>0)&&(t.placeholders.find(o=>o.index===0)||t.appendChild(new da(0)))}_accept(t,e){if(t===void 0||this._token.type===t){let i=e?this._scanner.tokenText(this._token):!0;return this._token=this._scanner.next(),i}return!1}_backTo(t){return this._scanner.pos=t.pos+t.len,this._token=t,!1}_until(t){let e=this._token;for(;this._token.type!==t;){if(this._token.type===14)return!1;if(this._token.type===5){let n=this._scanner.next();if(n.type!==0&&n.type!==4&&n.type!==5)return!1}this._token=this._scanner.next()}let i=this._scanner.value.substring(e.pos,this._token.pos).replace(/\\(\$|}|\\)/g,"$1");return this._token=this._scanner.next(),i}_parse(t){return this._parseEscaped(t)||this._parseTabstopOrVariableName(t)||this._parseComplexPlaceholder(t)||this._parseComplexVariable(t)||this._parseAnything(t)}_parseEscaped(t){let e;return(e=this._accept(5,!0))?(e=this._accept(0,!0)||this._accept(4,!0)||this._accept(5,!0)||e,t.appendChild(new vr(e)),!0):!1}_parseTabstopOrVariableName(t){let e,i=this._token;return this._accept(0)&&(e=this._accept(9,!0)||this._accept(8,!0))?(t.appendChild(/^\d+$/.test(e)?new da(Number(e)):new My(e)),!0):this._backTo(i)}_parseComplexPlaceholder(t){let e,i=this._token;if(!(this._accept(0)&&this._accept(3)&&(e=this._accept(8,!0))))return this._backTo(i);let o=new da(Number(e));if(this._accept(1))for(;;){if(this._accept(4))return t.appendChild(o),!0;if(!this._parse(o))return t.appendChild(new vr("${"+e+":")),o.children.forEach(t.appendChild,t),!0}else if(o.index>0&&this._accept(7)){let s=new Py;for(;;){if(this._parseChoiceElement(s)){if(this._accept(2))continue;if(this._accept(7)&&(o.appendChild(s),this._accept(4)))return t.appendChild(o),!0}return this._backTo(i),!1}}else return this._accept(6)?this._parseTransform(o)?(t.appendChild(o),!0):(this._backTo(i),!1):this._accept(4)?(t.appendChild(o),!0):this._backTo(i)}_parseChoiceElement(t){let e=this._token,i=[];for(;!(this._token.type===2||this._token.type===7);){let n;if((n=this._accept(5,!0))?n=this._accept(2,!0)||this._accept(7,!0)||this._accept(5,!0)||n:n=this._accept(void 0,!0),!n)return this._backTo(e),!1;i.push(n)}return i.length===0?(this._backTo(e),!1):(t.appendChild(new vr(i.join(""))),!0)}_parseComplexVariable(t){let e,i=this._token;if(!(this._accept(0)&&this._accept(3)&&(e=this._accept(9,!0))))return this._backTo(i);let o=new My(e);if(this._accept(1))for(;;){if(this._accept(4))return t.appendChild(o),!0;if(!this._parse(o))return t.appendChild(new vr("${"+e+":")),o.children.forEach(t.appendChild,t),!0}else return this._accept(6)?this._parseTransform(o)?(t.appendChild(o),!0):(this._backTo(i),!1):this._accept(4)?(t.appendChild(o),!0):this._backTo(i)}_parseTransform(t){let e=new K$,i="",n="";for(;!this._accept(6);){let o;if(o=this._accept(5,!0)){o=this._accept(6,!0)||o,i+=o;continue}if(this._token.type!==14){i+=this._accept(void 0,!0);continue}return!1}for(;!this._accept(6);){let o;if(o=this._accept(5,!0)){o=this._accept(5,!0)||this._accept(6,!0)||o,e.appendChild(new vr(o));continue}if(!(this._parseFormatString(e)||this._parseAnything(e)))return!1}for(;!this._accept(4);){if(this._token.type!==14){n+=this._accept(void 0,!0);continue}return!1}try{e.regexp=new RegExp(i,n)}catch{return!1}return t.transform=e,!0}_parseFormatString(t){let e=this._token;if(!this._accept(0))return!1;let i=!1;this._accept(3)&&(i=!0);let n=this._accept(8,!0);if(n)if(i){if(this._accept(4))return t.appendChild(new Vu(Number(n))),!0;if(!this._accept(1))return this._backTo(e),!1}else return t.appendChild(new Vu(Number(n))),!0;else return this._backTo(e),!1;if(this._accept(6)){let o=this._accept(9,!0);return!o||!this._accept(4)?(this._backTo(e),!1):(t.appendChild(new Vu(Number(n),o)),!0)}else if(this._accept(11)){let o=this._until(4);if(o)return t.appendChild(new Vu(Number(n),void 0,o,void 0)),!0}else if(this._accept(12)){let o=this._until(4);if(o)return t.appendChild(new Vu(Number(n),void 0,void 0,o)),!0}else if(this._accept(13)){let o=this._until(1);if(o){let s=this._until(4);if(s)return t.appendChild(new Vu(Number(n),void 0,o,s)),!0}}else{let o=this._until(4);if(o)return t.appendChild(new Vu(Number(n),void 0,void 0,o)),!0}return this._backTo(e),!1}_parseAnything(t){return this._token.type!==14?(t.appendChild(new vr(this._scanner.tokenText(this._token))),this._accept(void 0),!0):!1}};var zt={Visible:LF,HasFocusedSuggestion:new A("suggestWidgetHasFocusedSuggestion",!1,u("suggestWidgetHasSelection","Whether any suggestion is focused")),DetailsVisible:new A("suggestWidgetDetailsVisible",!1,u("suggestWidgetDetailsVisible","Whether suggestion details are visible")),MultipleSuggestions:new A("suggestWidgetMultipleSuggestions",!1,u("suggestWidgetMultipleSuggestions","Whether there are multiple suggestions to pick from")),MakesTextEdit:new A("suggestionMakesTextEdit",!0,u("suggestionMakesTextEdit","Whether inserting the current suggestion yields in a change or has everything already been typed")),AcceptSuggestionsOnEnter:new A("acceptSuggestionOnEnter",!0,u("acceptSuggestionOnEnter","Whether suggestions are inserted when pressing Enter")),HasInsertAndReplaceRange:new A("suggestionHasInsertAndReplaceRange",!1,u("suggestionHasInsertAndReplaceRange","Whether the current suggestion has insert and replace behaviour")),InsertMode:new A("suggestionInsertMode",void 0,{type:"string",description:u("suggestionInsertMode","Whether the default behaviour is to insert or replace")}),CanResolve:new A("suggestionCanResolve",!1,u("suggestionCanResolve","Whether the current suggestion supports to resolve further details"))},Rh=new V("suggestWidgetStatusBar"),G$=class{constructor(t,e,i,n){this.position=t;this.completion=e;this.container=i;this.provider=n;this.textLabel=typeof e.label=="string"?e.label:e.label?.label,this.labelLow=this.textLabel.toLowerCase(),this.isInvalid=!this.textLabel,this.sortTextLow=e.sortText&&e.sortText.toLowerCase(),this.filterTextLow=e.filterText&&e.filterText.toLowerCase(),this.extensionId=e.extensionId,L.isIRange(e.range)?(this.editStart=new H(e.range.startLineNumber,e.range.startColumn),this.editInsertEnd=new H(e.range.endLineNumber,e.range.endColumn),this.editReplaceEnd=new H(e.range.endLineNumber,e.range.endColumn),this.isInvalid=this.isInvalid||L.spansMultipleLines(e.range)||e.range.startLineNumber!==t.lineNumber):(this.editStart=new H(e.range.insert.startLineNumber,e.range.insert.startColumn),this.editInsertEnd=new H(e.range.insert.endLineNumber,e.range.insert.endColumn),this.editReplaceEnd=new H(e.range.replace.endLineNumber,e.range.replace.endColumn),this.isInvalid=this.isInvalid||L.spansMultipleLines(e.range.insert)||L.spansMultipleLines(e.range.replace)||e.range.insert.startLineNumber!==t.lineNumber||e.range.replace.startLineNumber!==t.lineNumber||e.range.insert.startColumn!==e.range.replace.startColumn),typeof n.resolveCompletionItem!="function"&&(this._resolveCache=Promise.resolve(),this._resolveDuration=0)}_brand;editStart;editInsertEnd;editReplaceEnd;textLabel;labelLow;sortTextLow;filterTextLow;isInvalid=!1;score=Dl.Default;distance=0;idx;word;extensionId;_resolveDuration;_resolveCache;get isResolved(){return this._resolveDuration!==void 0}get resolveDuration(){return this._resolveDuration!==void 0?this._resolveDuration:-1}async resolve(t){if(!this._resolveCache){let e=t.onCancellationRequested(()=>{this._resolveCache=void 0,this._resolveDuration=void 0}),i=new Ko(!0);this._resolveCache=Promise.resolve(this.provider.resolveCompletionItem(this.completion,t)).then(n=>{Object.assign(this.completion,n),this._resolveDuration=i.elapsed()},n=>{vl(n)&&(this._resolveCache=void 0,this._resolveDuration=void 0)}).finally(()=>{e.dispose()})}return this._resolveCache}};var Ay=class r{constructor(t=2,e=new Set,i=new Set,n=new Map,o=!0){this.snippetSortOrder=t;this.kindFilter=e;this.providerFilter=i;this.providerItemsToReuse=n;this.showDeprecated=o}static default=new r},Ob;function Qce(){return Ob}function Zce(r){let t=Ob;return Ob=r,t}var q$=class{constructor(t,e,i,n){this.items=t;this.needsClipboard=e;this.durations=i;this.disposable=n}};async function xR(r,t,e,i=Ay.default,n={triggerKind:0},o=Pt.None){let s=new Ko;e=e.clone();let a=t.getWordAtPosition(e),l=a?new L(e.lineNumber,a.startColumn,e.lineNumber,a.endColumn):L.fromPositions(e),d={replace:l,insert:l.setEndPosition(e.lineNumber,e.column)},c=[],p=new B,h=[],m=!1,f=(v,I,y)=>{let w=!1;if(!I)return w;for(let C of I.suggestions)if(!i.kindFilter.has(C.kind)){if(!i.showDeprecated&&C?.tags?.includes(1))continue;C.range||(C.range=d),C.sortText||(C.sortText=typeof C.label=="string"?C.label:C.label.label),!m&&C.insertTextRules&&C.insertTextRules&4&&(m=Fa.guessNeedsClipboard(C.insertText)),c.push(new G$(e,C,I,v)),w=!0}return Wv(I)&&p.add(I),h.push({providerName:v._debugDisplayName??"unknown_provider",elapsedProvider:I.duration??-1,elapsedOverall:y.elapsed()}),w},g=(async()=>{if(!Ob||i.kindFilter.has(27))return;let v=i.providerItemsToReuse.get(Ob);if(v){v.forEach(w=>c.push(w));return}if(i.providerFilter.size>0&&!i.providerFilter.has(Ob))return;let I=new Ko,y=await Ob.provideCompletionItems(t,e,n,o);f(Ob,y,I)})();for(let v of r.orderedGroups(t)){let I=!1;if(await Promise.all(v.map(async y=>{if(i.providerItemsToReuse.has(y)){let w=i.providerItemsToReuse.get(y);w.forEach(C=>c.push(C)),I=I||w.length>0;return}if(!(i.providerFilter.size>0&&!i.providerFilter.has(y)))try{let w=new Ko,C=await y.provideCompletionItems(t,e,n,o);I=f(y,C,w)||I}catch(w){zo(w)}})),I||o.isCancellationRequested)break}return await g,o.isCancellationRequested?(p.dispose(),Promise.reject(new wo)):new q$(c.sort(Ixe(i.snippetSortOrder)),m,{entries:h,elapsed:s.elapsed()},p)}function j$(r,t){if(r.sortTextLow&&t.sortTextLow){if(r.sortTextLow<t.sortTextLow)return-1;if(r.sortTextLow>t.sortTextLow)return 1}return r.textLabel<t.textLabel?-1:r.textLabel>t.textLabel?1:r.completion.kind-t.completion.kind}function bxe(r,t){if(r.completion.kind!==t.completion.kind){if(r.completion.kind===27)return-1;if(t.completion.kind===27)return 1}return j$(r,t)}function vxe(r,t){if(r.completion.kind!==t.completion.kind){if(r.completion.kind===27)return 1;if(t.completion.kind===27)return-1}return j$(r,t)}var FH=new Map;FH.set(0,bxe);FH.set(2,vxe);FH.set(1,j$);function Ixe(r){return FH.get(r)}tt.registerCommand("_executeCompletionItemProvider",async(r,...t)=>{let[e,i,n,o]=t;un(Z.isUri(e)),un(H.isIPosition(i)),un(typeof n=="string"||!n),un(typeof o=="number"||!o);let{completionProvider:s}=r.get(ni),a=await r.get(Tr).createModelReference(e);try{let l={incomplete:!1,suggestions:[]},d=[],c=a.object.textEditorModel.validatePosition(i),p=await xR(s,a.object.textEditorModel,c,void 0,{triggerCharacter:n??void 0,triggerKind:n?1:0});for(let h of p.items)d.length<(o??0)&&d.push(h.resolve(Pt.None)),l.incomplete=l.incomplete||h.container.incomplete,l.suggestions.push(h.completion);try{return await Promise.all(d),l}finally{setTimeout(()=>p.disposable.dispose(),100)}}finally{a.dispose()}});function BH(r,t){r.getContribution("editor.contrib.suggestController")?.triggerSuggest(new Set().add(t),void 0,!0)}var Oy=class{static isAllOff(t){return t.other==="off"&&t.comments==="off"&&t.strings==="off"}static isAllOn(t){return t.other==="on"&&t.comments==="on"&&t.strings==="on"}static valueFor(t,e){switch(e){case 1:return t.comments;case 2:return t.strings;default:return t.other}}};var Jce=new j(new xt(0,122,204)),yxe={showArrow:!0,showFrame:!0,className:"",frameColor:Jce,arrowColor:Jce,keepEditorSelection:!1},Sxe="vs.editor.contrib.zoneWidget",X$=class{domNode;id="";afterLineNumber;afterColumn;heightInLines;showInHiddenAreas;ordinal;_onDomNodeTop;_onComputedHeight;constructor(t,e,i,n,o,s,a,l){this.domNode=t,this.afterLineNumber=e,this.afterColumn=i,this.heightInLines=n,this.showInHiddenAreas=a,this.ordinal=l,this._onDomNodeTop=o,this._onComputedHeight=s}onDomNodeTop(t){this._onDomNodeTop(t)}onComputedHeight(t){this._onComputedHeight(t)}},Y$=class{_id;_domNode;constructor(t,e){this._id=t,this._domNode=e}getId(){return this._id}getDomNode(){return this._domNode}getPosition(){return null}},Q$=class r{constructor(t){this._editor=t}static _IdGenerator=new Gk(".arrow-decoration-");_ruleName=r._IdGenerator.nextId();_decorations=this._editor.createDecorationsCollection();_color=null;_height=-1;dispose(){this.hide(),zA(this._ruleName)}set color(t){this._color!==t&&(this._color=t,this._updateStyle())}set height(t){this._height!==t&&(this._height=t,this._updateStyle())}_updateStyle(){zA(this._ruleName),lD(`.monaco-editor ${this._ruleName}`,`border-style: solid; border-color: transparent; border-bottom-color: ${this._color}; border-width: ${this._height}px; bottom: -${this._height}px !important; margin-left: -${this._height}px; `)}show(t){t.column===1&&(t={lineNumber:t.lineNumber,column:2}),this._decorations.set([{range:L.fromPositions(t),options:{description:"zone-widget-arrow",className:this._ruleName,stickiness:1}}])}hide(){this._decorations.clear()}},Fb=class{_arrow=null;_overlayWidget=null;_resizeSash=null;_positionMarkerId;_viewZone=null;_disposables=new B;container=null;domNode;editor;options;constructor(t,e={}){this.editor=t,this._positionMarkerId=this.editor.createDecorationsCollection(),this.options=Xi(e),Bs(this.options,yxe,!1),this.domNode=document.createElement("div"),this.options.isAccessible||(this.domNode.setAttribute("aria-hidden","true"),this.domNode.setAttribute("role","presentation")),this._disposables.add(this.editor.onDidLayoutChange(i=>{let n=this._getWidth(i);this.domNode.style.width=n+"px",this.domNode.style.left=this._getLeft(i)+"px",this._onWidth(n)}))}dispose(){this._overlayWidget&&(this.editor.removeOverlayWidget(this._overlayWidget),this._overlayWidget=null),this._viewZone&&this.editor.changeViewZones(t=>{this._viewZone&&t.removeZone(this._viewZone.id),this._viewZone=null}),this._positionMarkerId.clear(),this._disposables.dispose()}create(){this.domNode.classList.add("zone-widget"),this.options.className&&this.domNode.classList.add(this.options.className),this.container=document.createElement("div"),this.container.classList.add("zone-widget-container"),this.domNode.appendChild(this.container),this.options.showArrow&&(this._arrow=new Q$(this.editor),this._disposables.add(this._arrow)),this._fillContainer(this.container),this._initSash(),this._applyStyles()}style(t){t.frameColor&&(this.options.frameColor=t.frameColor),t.arrowColor&&(this.options.arrowColor=t.arrowColor),this._applyStyles()}_applyStyles(){if(this.container&&this.options.frameColor){let t=this.options.frameColor.toString();this.container.style.borderTopColor=t,this.container.style.borderBottomColor=t}if(this._arrow&&this.options.arrowColor){let t=this.options.arrowColor.toString();this._arrow.color=t}}_getWidth(t){return t.width-t.minimap.minimapWidth-t.verticalScrollbarWidth}_getLeft(t){return t.minimap.minimapWidth>0&&t.minimap.minimapLeft===0?t.minimap.minimapWidth:0}_onViewZoneTop(t){this.domNode.style.top=t+"px"}_onViewZoneHeight(t){if(this.domNode.style.height=`${t}px`,this.container){let e=t-this._decoratingElementsHeight();this.container.style.height=`${e}px`;let i=this.editor.getLayoutInfo();this._doLayout(e,this._getWidth(i))}this._resizeSash?.layout()}get position(){let t=this._positionMarkerId.getRange(0);if(t)return t.getStartPosition()}hasFocus(){return this.domNode.contains(fo())}_isShowing=!1;show(t,e){let i=L.isIRange(t)?L.lift(t):L.fromPositions(t);this._isShowing=!0,this._showImpl(i,e),this._isShowing=!1,this._positionMarkerId.set([{range:i,options:Ii.EMPTY}])}updatePositionAndHeight(t,e){this._viewZone&&(t=L.isIRange(t)?L.getStartPosition(t):t,this._viewZone.afterLineNumber=t.lineNumber,this._viewZone.afterColumn=t.column,this._viewZone.heightInLines=e??this._viewZone.heightInLines,this.editor.changeViewZones(i=>{i.layoutZone(this._viewZone.id)}),this._positionMarkerId.set([{range:L.isIRange(t)?t:L.fromPositions(t),options:Ii.EMPTY}]))}hide(){this._viewZone&&(this.editor.changeViewZones(t=>{this._viewZone&&t.removeZone(this._viewZone.id)}),this._viewZone=null),this._overlayWidget&&(this.editor.removeOverlayWidget(this._overlayWidget),this._overlayWidget=null),this._arrow?.hide(),this._positionMarkerId.clear()}_decoratingElementsHeight(){let t=this.editor.getOption(68),e=0;if(this.options.showArrow){let i=Math.round(t/3);e+=2*i}if(this.options.showFrame){let i=Math.round(t/9);e+=2*i}return e}_showImpl(t,e){let i=t.getStartPosition(),n=this.editor.getLayoutInfo(),o=this._getWidth(n);this.domNode.style.width=`${o}px`,this.domNode.style.left=this._getLeft(n)+"px";let s=document.createElement("div");s.style.overflow="hidden";let a=this.editor.getOption(68);if(!this.options.allowUnlimitedHeight){let h=Math.max(12,this.editor.getLayoutInfo().height/a*.8);e=Math.min(e,h)}let l=0,d=0;if(this._arrow&&this.options.showArrow&&(l=Math.round(a/3),this._arrow.height=l,this._arrow.show(i)),this.options.showFrame&&(d=Math.round(a/9)),this.editor.changeViewZones(h=>{this._viewZone&&h.removeZone(this._viewZone.id),this._overlayWidget&&(this.editor.removeOverlayWidget(this._overlayWidget),this._overlayWidget=null),this.domNode.style.top="-1000px",this._viewZone=new X$(s,i.lineNumber,i.column,e,m=>this._onViewZoneTop(m),m=>this._onViewZoneHeight(m),this.options.showInHiddenAreas,this.options.ordinal),this._viewZone.id=h.addZone(this._viewZone),this._overlayWidget=new Y$(Sxe+this._viewZone.id,this.domNode),this.editor.addOverlayWidget(this._overlayWidget)}),this.container&&this.options.showFrame){let h=this.options.frameWidth?this.options.frameWidth:d;this.container.style.borderTopWidth=h+"px",this.container.style.borderBottomWidth=h+"px"}let c=e*a-this._decoratingElementsHeight();this.container&&(this.container.style.top=l+"px",this.container.style.height=c+"px",this.container.style.overflow="hidden"),this._doLayout(c,o),this.options.keepEditorSelection||this.editor.setSelection(t);let p=this.editor.getModel();if(p){let h=p.validateRange(new L(t.startLineNumber,1,t.endLineNumber+1,1));this.revealRange(h,h.startLineNumber===p.getLineCount())}}revealRange(t,e){e?this.editor.revealLineNearTop(t.endLineNumber,0):this.editor.revealRange(t,0)}setCssClass(t,e){this.container&&(e&&this.container.classList.remove(e),this.container.classList.add(t))}_onWidth(t){}_doLayout(t,e){}_relayout(t){this._viewZone&&this._viewZone.heightInLines!==t&&this.editor.changeViewZones(e=>{this._viewZone&&(this._viewZone.heightInLines=t,e.layoutZone(this._viewZone.id))})}_initSash(){if(this._resizeSash)return;this._resizeSash=this._disposables.add(new xl(this.domNode,this,{orientation:1})),this.options.isResizeable||(this._resizeSash.state=0);let t;this._disposables.add(this._resizeSash.onDidStart(e=>{this._viewZone&&(t={startY:e.startY,heightInLines:this._viewZone.heightInLines})})),this._disposables.add(this._resizeSash.onDidEnd(()=>{t=void 0})),this._disposables.add(this._resizeSash.onDidChange(e=>{if(t){let i=(e.currentY-t.startY)/this.editor.getOption(68),n=i<0?Math.ceil(i):Math.floor(i),o=t.heightInLines+n;o>5&&o<35&&this._relayout(o)}}))}getHorizontalSashLeft(){return 0}getHorizontalSashTop(){return(this.domNode.style.height===null?0:parseInt(this.domNode.style.height))-this._decoratingElementsHeight()/2}getHorizontalSashWidth(){let t=this.editor.getLayoutInfo();return t.width-t.minimap.minimapWidth}};var Wu=class{constructor(t,e,i,n,o,s,a,l){this._contextMenuService=e;this._contextViewService=i;this._contextKeyService=n;this._keybindingService=o;this._menuService=s;this._configurationService=a;this._workspaceContextService=l;this._editor=t,this._toDispose.add(this._editor.onContextMenu(d=>this._onContextMenu(d))),this._toDispose.add(this._editor.onMouseWheel(d=>{if(this._contextMenuIsBeingShownCount>0){let c=this._contextViewService.getContextViewElement(),p=d.srcElement;p.shadowRoot&&tu(c)===p.shadowRoot||this._contextViewService.hideContextView()}})),this._toDispose.add(this._editor.onKeyDown(d=>{this._editor.getOption(24)&&d.keyCode===58&&(d.preventDefault(),d.stopPropagation(),this.showContextMenu())}))}static ID="editor.contrib.contextmenu";static get(t){return t.getContribution(Wu.ID)}_toDispose=new B;_contextMenuIsBeingShownCount=0;_editor;_onContextMenu(t){if(!this._editor.hasModel())return;if(!this._editor.getOption(24)){this._editor.focus(),t.target.position&&!this._editor.getSelection().containsPosition(t.target.position)&&this._editor.setPosition(t.target.position);return}if(t.target.type===12||t.target.type===6&&t.target.detail.injectedText)return;if(t.event.preventDefault(),t.event.stopPropagation(),t.target.type===11)return this._showScrollbarContextMenu(t.event);if(t.target.type!==6&&t.target.type!==7&&t.target.type!==1)return;if(this._editor.focus(),t.target.position){let i=!1;for(let n of this._editor.getSelections())if(n.containsPosition(t.target.position)){i=!0;break}i||this._editor.setPosition(t.target.position)}let e=null;t.target.type!==1&&(e=t.event),this.showContextMenu(e)}showContextMenu(t){if(!this._editor.getOption(24)||!this._editor.hasModel())return;let e=this._getMenuActions(this._editor.getModel(),this._editor.contextMenuId);e.length>0&&this._doShowContextMenu(e,t)}_getMenuActions(t,e){let i=[],n=this._menuService.getMenuActions(e,this._contextKeyService,{arg:t.uri});for(let o of n){let[,s]=o,a=0;for(let l of s)if(l instanceof to){let d=this._getMenuActions(t,l.item.submenu);d.length>0&&(i.push(new vo(l.id,l.label,d)),a++)}else i.push(l),a++;a&&i.push(new Qt)}return i.length&&i.pop(),i}_doShowContextMenu(t,e=null){if(!this._editor.hasModel())return;let i=this._editor.getOption(61);this._editor.updateOptions({hover:{enabled:!1}});let n=e;if(!n){this._editor.revealPosition(this._editor.getPosition(),1),this._editor.render();let s=this._editor.getScrolledVisiblePosition(this._editor.getPosition()),a=Oi(this._editor.getDomNode()),l=a.left+s.left,d=a.top+s.top+s.height;n={x:l,y:d}}let o=this._editor.getOption(129)&&!Hr;this._contextMenuIsBeingShownCount++,this._contextMenuService.showContextMenu({domForShadowRoot:o?this._editor.getOverflowWidgetsDomNode()??this._editor.getDomNode():void 0,getAnchor:()=>n,getActions:()=>t,getActionViewItem:s=>{let a=this._keybindingFor(s);if(a)return new Kl(s,s,{label:!0,keybinding:a.getLabel(),isMenu:!0});let l=s;return typeof l.getActionViewItem=="function"?l.getActionViewItem():new Kl(s,s,{icon:!0,label:!0,isMenu:!0})},getKeyBinding:s=>this._keybindingFor(s),onHide:s=>{this._contextMenuIsBeingShownCount--,this._editor.updateOptions({hover:i})}})}_showScrollbarContextMenu(t){if(!this._editor.hasModel()||tie(this._workspaceContextService.getWorkspace()))return;let e=this._editor.getOption(74),i=0,n=d=>({id:`menu-action-${++i}`,label:d.label,tooltip:"",class:void 0,enabled:typeof d.enabled>"u"?!0:d.enabled,checked:d.checked,run:d.run}),o=(d,c)=>new vo(`menu-action-${++i}`,d,c,void 0),s=(d,c,p,h,m)=>{if(!c)return n({label:d,enabled:c,run:()=>{}});let f=v=>()=>{this._configurationService.updateValue(p,v)},g=[];for(let v of m)g.push(n({label:v.label,checked:h===v.value,run:f(v.value)}));return o(d,g)},a=[];a.push(n({label:u("context.minimap.minimap","Minimap"),checked:e.enabled,run:()=>{this._configurationService.updateValue("editor.minimap.enabled",!e.enabled)}})),a.push(new Qt),a.push(n({label:u("context.minimap.renderCharacters","Render Characters"),enabled:e.enabled,checked:e.renderCharacters,run:()=>{this._configurationService.updateValue("editor.minimap.renderCharacters",!e.renderCharacters)}})),a.push(s(u("context.minimap.size","Vertical size"),e.enabled,"editor.minimap.size",e.size,[{label:u("context.minimap.size.proportional","Proportional"),value:"proportional"},{label:u("context.minimap.size.fill","Fill"),value:"fill"},{label:u("context.minimap.size.fit","Fit"),value:"fit"}])),a.push(s(u("context.minimap.slider","Slider"),e.enabled,"editor.minimap.showSlider",e.showSlider,[{label:u("context.minimap.slider.mouseover","Mouse Over"),value:"mouseover"},{label:u("context.minimap.slider.always","Always"),value:"always"}]));let l=this._editor.getOption(129)&&!Hr;this._contextMenuIsBeingShownCount++,this._contextMenuService.showContextMenu({domForShadowRoot:l?this._editor.getDomNode():void 0,getAnchor:()=>t,getActions:()=>a,onHide:d=>{this._contextMenuIsBeingShownCount--,this._editor.focus()}})}_keybindingFor(t){return this._keybindingService.lookupKeybinding(t.id)}dispose(){this._contextMenuIsBeingShownCount>0&&this._contextViewService.hideContextView(),this._toDispose.dispose()}};Wu=E([b(1,vt),b(2,so),b(3,re),b(4,Be),b(5,jt),b(6,se),b(7,kt)],Wu);var Z$=class extends mr{constructor(){super({id:"editor.action.showContextMenu",label:u("action.showContextMenu.label","Show Editor Context Menu"),alias:"Show Editor Context Menu",precondition:void 0,kbOpts:{kbExpr:ce.textInputFocus,primary:1092,weight:100}})}run(t,e){Wu.get(e)?.showContextMenu()}};gr(Wu.ID,Wu,2);Dr(Z$);var FYi=new RegExp("\\bMARK:\\s*(.*)$","d");var hg=q("editorWorkerService");var VH=class r{async provideSelectionRanges(t,e){let i=[];for(let n of e){let o=[];i.push(o);let s=new Map;await new Promise(a=>r._bracketsRightYield(a,0,t,n,s)),await new Promise(a=>r._bracketsLeftYield(a,0,t,n,s,o))}return i}static _maxDuration=30;static _maxRounds=2;static _bracketsRightYield(t,e,i,n,o){let s=new Map,a=Date.now();for(;;){if(e>=r._maxRounds){t();break}if(!n){t();break}let l=i.bracketPairs.findNextBracket(n);if(!l){t();break}if(Date.now()-a>r._maxDuration){setTimeout(()=>r._bracketsRightYield(t,e+1,i,n,o));break}if(l.bracketInfo.isOpeningBracket){let c=l.bracketInfo.bracketText,p=s.has(c)?s.get(c):0;s.set(c,p+1)}else{let c=l.bracketInfo.getOpeningBrackets()[0].bracketText,p=s.has(c)?s.get(c):0;if(p-=1,s.set(c,Math.max(0,p)),p<0){let h=o.get(c);h||(h=new lr,o.set(c,h)),h.push(l.range)}}n=l.range.getEndPosition()}}static _bracketsLeftYield(t,e,i,n,o,s){let a=new Map,l=Date.now();for(;;){if(e>=r._maxRounds&&o.size===0){t();break}if(!n){t();break}let d=i.bracketPairs.findPrevBracket(n);if(!d){t();break}if(Date.now()-l>r._maxDuration){setTimeout(()=>r._bracketsLeftYield(t,e+1,i,n,o,s));break}if(d.bracketInfo.isOpeningBracket){let p=d.bracketInfo.bracketText,h=a.has(p)?a.get(p):0;if(h-=1,a.set(p,Math.max(0,h)),h<0){let m=o.get(p);if(m){let f=m.shift();m.size===0&&o.delete(p);let g=L.fromPositions(d.range.getEndPosition(),f.getStartPosition()),v=L.fromPositions(d.range.getStartPosition(),f.getEndPosition());s.push({range:g}),s.push({range:v}),r._addBracketLeading(i,v,s)}}}else{let p=d.bracketInfo.getOpeningBrackets()[0].bracketText,h=a.has(p)?a.get(p):0;a.set(p,h+1)}n=d.range.getStartPosition()}}static _addBracketLeading(t,e,i){if(e.startLineNumber===e.endLineNumber)return;let n=e.startLineNumber,o=t.getLineFirstNonWhitespaceColumn(n);o!==0&&o!==e.startColumn&&(i.push({range:L.fromPositions(new H(n,o),e.getEndPosition())}),i.push({range:L.fromPositions(new H(n,1),e.getEndPosition())}));let s=n-1;if(s>0){let a=t.getLineFirstNonWhitespaceColumn(s);a===e.startColumn&&a!==t.getLineLastNonWhitespaceColumn(s)&&(i.push({range:L.fromPositions(new H(s,a),e.getEndPosition())}),i.push({range:L.fromPositions(new H(s,1),e.getEndPosition())}))}}};var WH=class r{static None=new class extends r{distance(){return 0}};static async create(t,e){if(!e.getOption(120).localityBonus||!e.hasModel())return r.None;let i=e.getModel(),n=e.getPosition();if(!t.canComputeWordRanges(i.uri))return r.None;let[o]=await new VH().provideSelectionRanges(i,[n]);if(o.length===0)return r.None;let s=await t.computeWordRanges(i.uri,o[0].range);if(!s)return r.None;let a=i.getWordUntilPosition(n);return delete s[a.word],new class extends r{distance(l,d){if(!n.equals(e.getPosition()))return 0;if(d.kind===17)return 2<<20;let c=typeof d.label=="string"?d.label:d.label.label,p=s[c];if(SJ(p))return 2<<20;let h=HM(p,L.fromPositions(l),L.compareRangesUsingStarts),m=h>=0?p[h]:p[Math.max(0,~h-1)],f=o.length;for(let g of o){if(!L.containsRange(g.range,m))break;f-=1}return f}}}};var HH=class r{constructor(t,e,i,n,o,s,a=iI.default,l=void 0){this.clipboardText=l;this._items=t,this._column=e,this._wordDistance=n,this._options=o,this._refilterKind=1,this._lineContext=i,this._fuzzyScoreOptions=a,s==="top"?this._snippetCompareFn=r._compareCompletionItemsSnippetsUp:s==="bottom"&&(this._snippetCompareFn=r._compareCompletionItemsSnippetsDown)}_items;_column;_wordDistance;_options;_snippetCompareFn=r._compareCompletionItems;_fuzzyScoreOptions;_lineContext;_refilterKind;_filteredItems;_itemsByProvider;_stats;get lineContext(){return this._lineContext}set lineContext(t){(this._lineContext.leadingLineContent!==t.leadingLineContent||this._lineContext.characterCountDelta!==t.characterCountDelta)&&(this._refilterKind=this._lineContext.characterCountDelta<t.characterCountDelta&&this._filteredItems?2:1,this._lineContext=t)}get items(){return this._ensureCachedState(),this._filteredItems}getItemsByProvider(){return this._ensureCachedState(),this._itemsByProvider}getIncompleteProvider(){this._ensureCachedState();let t=new Set;for(let[e,i]of this.getItemsByProvider())i.length>0&&i[0].container.incomplete&&t.add(e);return t}get stats(){return this._ensureCachedState(),this._stats}_ensureCachedState(){this._refilterKind!==0&&this._createCachedState()}_createCachedState(){this._itemsByProvider=new Map;let t=[],{leadingLineContent:e,characterCountDelta:i}=this._lineContext,n="",o="",s=this._refilterKind===1?this._items:this._filteredItems,a=[],l=!this._options.filterGraceful||s.length>2e3?_m:Vte;for(let d=0;d<s.length;d++){let c=s[d];if(c.isInvalid)continue;let p=this._itemsByProvider.get(c.provider);p?p.push(c):this._itemsByProvider.set(c.provider,[c]);let h=c.position.column-c.editStart.column,m=h+i-(c.position.column-this._column);if(n.length!==m&&(n=m===0?"":e.slice(-m),o=n.toLowerCase()),c.word=n,m===0)c.score=Dl.Default;else{let f=0;for(;f<h;){let g=n.charCodeAt(f);if(g===32||g===9)f+=1;else break}if(f>=m)c.score=Dl.Default;else if(typeof c.completion.filterText=="string"){let g=l(n,o,f,c.completion.filterText,c.filterTextLow,0,this._fuzzyScoreOptions);if(!g)continue;fm(c.completion.filterText,c.textLabel)===0?c.score=g:(c.score=Nte(n,o,f,c.textLabel,c.labelLow,0),c.score[0]=g[0])}else{let g=l(n,o,f,c.textLabel,c.labelLow,0,this._fuzzyScoreOptions);if(!g)continue;c.score=g}}c.idx=d,c.distance=this._wordDistance.distance(c.position,c.completion),a.push(c),t.push(c.textLabel.length)}this._filteredItems=a.sort(this._snippetCompareFn),this._refilterKind=0,this._stats={pLabelLen:t.length?FM(t.length-.85,t,(d,c)=>d-c):0}}static _compareCompletionItems(t,e){return t.score[0]>e.score[0]?-1:t.score[0]<e.score[0]?1:t.distance<e.distance?-1:t.distance>e.distance?1:t.idx<e.idx?-1:t.idx>e.idx?1:0}static _compareCompletionItemsSnippetsDown(t,e){if(t.completion.kind!==e.completion.kind){if(t.completion.kind===27)return 1;if(e.completion.kind===27)return-1}return r._compareCompletionItems(t,e)}static _compareCompletionItemsSnippetsUp(t,e){if(t.completion.kind!==e.completion.kind){if(t.completion.kind===27)return-1;if(e.completion.kind===27)return 1}return r._compareCompletionItems(t,e)}};var Ny=q("ILanguageFeatureDebounceService"),tj;(i=>{let r=new WeakMap,t=0;function e(n){let o=r.get(n);return o===void 0&&(o=++t,r.set(n,o)),o}i.of=e})(tj||={});var J$=class{constructor(t){this._default=t}get(t){return this._default}update(t,e){return this._default}default(){return this._default}},ej=class{constructor(t,e,i,n,o,s){this._logService=t;this._name=e;this._registry=i;this._default=n;this._min=o;this._max=s}_cache=new zr(50,.7);_key(t){return t.id+this._registry.all(t).reduce((e,i)=>eD(tj.of(i),e),0)}get(t){let e=this._key(t),i=this._cache.get(e);return i?pn(i.value,this._min,this._max):this.default()}update(t,e){let i=this._key(t),n=this._cache.get(i);n||(n=new NA(6),this._cache.set(i,n));let o=pn(n.update(e),this._min,this._max);return ef(t.uri,"output")||this._logService.trace(`[DEBOUNCE: ${this._name}] for ${t.uri.toString()} is ${o}ms`),o}_overall(){let t=new tD;for(let[,e]of this._cache)t.update(e.value);return t.value}default(){let t=this._overall()|0||this._default;return pn(t,this._min,this._max)}},TR=class{constructor(t,e){this._logService=t;this._isDev=e.isExtensionDevelopment||!e.isBuilt}_data=new Map;_isDev;for(t,e,i){let n=i?.min??50,o=i?.max??n**2,s=i?.key??void 0,a=`${tj.of(t)},${n}${s?","+s:""}`,l=this._data.get(a);return l||(this._isDev?(this._logService.debug(`[DEBOUNCE: ${e}] is disabled in developed mode`),l=new J$(n*1.5)):l=new ej(this._logService,e,t,this._overallAverage()|0||n*1.5,n,o),this._data.set(a,l)),l}_overallAverage(){let t=new tD;for(let e of this._data.values())t.update(e.default());return t.value}};TR=E([b(0,bt),b(1,$o)],TR);gi(Ny,TR,1);var Cxe=[];function eue(){return Cxe}function tue(r,t){return new H(r.lineNumber+t.lineNumber-1,t.lineNumber===1?r.column+t.column-1:t.column)}function ij(r,t){return new H(r.lineNumber-t.lineNumber+1,r.lineNumber-t.lineNumber===0?r.column-t.column+1:r.column)}var Bb=class{constructor(t,e){this.lineNumber=t;this.parts=e}equals(t){return this.lineNumber===t.lineNumber&&this.parts.length===t.parts.length&&this.parts.every((e,i)=>e.equals(t.parts[i]))}render(t,e=!1){return new lu([...this.parts.map(i=>new _o(L.fromPositions(new H(this.lineNumber,i.column)),e?`[${i.lines.join(`
`)}]`:i.lines.join(`
`)))]).applyToString(t)}renderForScreenReader(t){if(this.parts.length===0)return"";let e=this.parts[this.parts.length-1],i=t.substr(0,e.column-1);return new lu([...this.parts.map(o=>new _o(L.fromPositions(new H(1,o.column)),o.lines.join(`
`)))]).applyToString(i).substring(this.parts[0].column-1)}isEmpty(){return this.parts.every(t=>t.lines.length===0)}get lineCount(){return 1+this.parts.reduce((t,e)=>t+e.lines.length-1,0)}},sx=class{constructor(t,e,i){this.column=t;this.text=e;this.preview=i}lines=Xc(this.text);equals(t){return this.column===t.column&&this.lines.length===t.lines.length&&this.lines.every((e,i)=>e===t.lines[i])}},UH=class{constructor(t,e,i,n=0){this.lineNumber=t;this.columnRange=e;this.text=i;this.additionalReservedLineCount=n}parts=[new sx(this.columnRange.endColumnExclusive,this.text,!1)];newLines=Xc(this.text);renderForScreenReader(t){return this.newLines.join(`
`)}render(t,e=!1){let i=this.columnRange.toRange(this.lineNumber);return e?new lu([new _o(L.fromPositions(i.getStartPosition()),"("),new _o(L.fromPositions(i.getEndPosition()),`)[${this.newLines.join(`
`)}]`)]).applyToString(t):new lu([new _o(i,this.newLines.join(`
`))]).applyToString(t)}get lineCount(){return this.newLines.length}isEmpty(){return this.parts.every(t=>t.lines.length===0)}equals(t){return this.lineNumber===t.lineNumber&&this.columnRange.equals(t.columnRange)&&this.newLines.length===t.newLines.length&&this.newLines.every((e,i)=>e===t.newLines[i])&&this.additionalReservedLineCount===t.additionalReservedLineCount}};function nj(r,t){return xi(r,t,oj)}function oj(r,t){return r===t?!0:!r||!t?!1:r instanceof Bb&&t instanceof Bb||r instanceof UH&&t instanceof UH?r.equals(t):!1}function iue(r,t){let e=new yC,i=new wC(e,d=>t.getLanguageConfiguration(d)),n=new EC(new rj([r]),i),o=gk(n,[],void 0,!0),s="",a=r.getLineContent();function l(d,c){if(d.kind===2)if(l(d.openingBracket,c),c=Gi(c,d.openingBracket.length),d.child&&(l(d.child,c),c=Gi(c,d.child.length)),d.closingBracket)l(d.closingBracket,c),c=Gi(c,d.closingBracket.length);else{let h=i.getSingleLanguageBracketTokens(d.openingBracket.languageId).findClosingTokenText(d.openingBracket.bracketIds);s+=h}else if(d.kind!==3){if(d.kind===0||d.kind===1)s+=a.substring(c,Gi(c,d.length));else if(d.kind===4)for(let p of d.children)l(p,c),c=Gi(c,p.length)}}return l(o,Xo),s}var rj=class{constructor(t){this.lines=t}getValue(){return this.lines.map(t=>t.getLineContent()).join(`
`)}getLineCount(){return this.lines.length}getLineLength(t){return this.lines[t-1].getLineContent().length}tokenization={getLineTokens:t=>this.lines[t-1]}};async function oue(r,t,e,i,n=Pt.None,o){let s=t instanceof H?wxe(t,e):t,a=r.all(e),l=new Kc;for(let I of a)I.groupId&&l.add(I.groupId,I);function d(I){if(!I.yieldsToGroupIds)return[];let y=[];for(let w of I.yieldsToGroupIds||[]){let C=l.get(w);for(let S of C)y.push(S)}return y}let c=new Map,p=new Set;function h(I,y){if(y=[...y,I],p.has(I))return y;p.add(I);try{let w=d(I);for(let C of w){let S=h(C,y);if(S)return S}}finally{p.delete(I)}}function m(I){let y=c.get(I);if(y)return y;let w=h(I,[]);w&&zo(new Error(`Inline completions: cyclic yield-to dependency detected. Path: ${w.map(S=>S.toString?S.toString():""+S).join(" -> ")}`));let C=new Kr;return c.set(I,C.p),(async()=>{if(!w){let S=d(I);for(let D of S){let k=await m(D);if(k&&k.items.length>0)return}}try{return t instanceof H?await I.provideInlineCompletions(e,t,i,n):await I.provideInlineEdits?.(e,t,i,n)}catch(S){zo(S);return}})().then(S=>C.complete(S),S=>C.error(S)),C.p}let f=await Promise.all(a.map(async I=>({provider:I,completions:await m(I)}))),g=new Map,v=[];for(let I of f){let y=I.completions;if(!y)continue;let w=new aj(y,I.provider);v.push(w);for(let C of y.items){let S=lj.from(C,w,s,e,o);g.set(S.hash(),S)}}return new sj(Array.from(g.values()),new Set(g.keys()),v)}var sj=class{constructor(t,e,i){this.completions=t;this.hashs=e;this.providerResults=i}has(t){return this.hashs.has(t.hash())}dispose(){for(let t of this.providerResults)t.removeRef()}},aj=class{constructor(t,e){this.inlineCompletions=t;this.provider=e}refCount=1;addRef(){this.refCount++}removeRef(){this.refCount--,this.refCount===0&&this.provider.freeInlineCompletions(this.inlineCompletions)}},lj=class r{constructor(t,e,i,n,o,s,a,l){this.filterText=t;this.command=e;this.range=i;this.insertText=n;this.snippetInfo=o;this.additionalTextEdits=s;this.sourceInlineCompletion=a;this.source=l;t=t.replace(/\r\n|\r/g,`
`),n=t.replace(/\r\n|\r/g,`
`)}static from(t,e,i,n,o){let s,a,l=t.range?L.lift(t.range):i;if(typeof t.insertText=="string"){if(s=t.insertText,o&&t.completeBracketPairs){s=nue(s,l.getStartPosition(),n,o);let d=s.length-t.insertText.length;d!==0&&(l=new L(l.startLineNumber,l.startColumn,l.endLineNumber,l.endColumn+d))}a=void 0}else if("snippet"in t.insertText){let d=t.insertText.snippet.length;if(o&&t.completeBracketPairs){t.insertText.snippet=nue(t.insertText.snippet,l.getStartPosition(),n,o);let p=t.insertText.snippet.length-d;p!==0&&(l=new L(l.startLineNumber,l.startColumn,l.endLineNumber,l.endColumn+p))}let c=new Fa().parse(t.insertText.snippet);c.children.length===1&&c.children[0]instanceof vr?(s=c.children[0].value,a=void 0):(s=c.toString(),a={snippet:t.insertText.snippet,range:l})}else gm(t.insertText);return new r(s,t.command,l,s,a,t.additionalTextEdits||eue(),t,e)}withRange(t){return new r(this.filterText,this.command,t,this.insertText,this.snippetInfo,this.additionalTextEdits,this.sourceInlineCompletion,this.source)}hash(){return JSON.stringify({insertText:this.insertText,range:this.range.toString()})}toSingleTextEdit(){return new _o(this.range,this.insertText)}};function wxe(r,t){let e=t.getWordAtPosition(r),i=t.getLineMaxColumn(r.lineNumber);return e?new L(r.lineNumber,e.startColumn,r.lineNumber,i):L.fromPositions(r,r.with(void 0,i))}function nue(r,t,e,i){let o=e.getLineContent(t.lineNumber).substring(0,t.column-1)+r,s=c0.replace(Qe.ofStartAndLength(t.column-1,o.length-(t.column-1)),r),l=e.tokenization.tokenizeLineWithEdit(t.lineNumber,s)?.mainLineTokens?.sliceAndInflate(t.column-1,o.length,0);return l?iue(l,i):r}function Vb(r,t,e){let i=e?r.range.intersectRanges(e):r.range;if(!i)return r;let n=t.getValueInRange(i,1),o=bd(n,r.text),s=pr.ofText(n.substring(0,o)).addToPosition(r.range.getStartPosition()),a=r.text.substring(o),l=L.fromPositions(s,r.range.getEndPosition());return new _o(l,a)}function dj(r,t){return r.text.startsWith(t.text)&&Exe(r.range,t.range)}function cj(r,t,e,i,n=0){let o=Vb(r,t);if(o.range.endLineNumber!==o.range.startLineNumber)return;let s=t.getLineContent(o.range.startLineNumber),a=yn(s).length;if(o.range.startColumn-1<=a){let f=yn(o.text).length,g=s.substring(o.range.startColumn-1,a),[v,I]=[o.range.getStartPosition(),o.range.getEndPosition()],y=v.column+g.length<=I.column?v.delta(0,g.length):I,w=L.fromPositions(y,I),C=o.text.startsWith(g)?o.text.substring(g.length):o.text.substring(f);o=new _o(w,C)}let d=t.getValueInRange(o.range),c=xxe(d,o.text);if(!c)return;let p=o.range.startLineNumber,h=new Array;if(e==="prefix"){let f=c.filter(g=>g.originalLength===0);if(f.length>1||f.length===1&&f[0].originalStart!==d.length)return}let m=o.text.length-n;for(let f of c){let g=o.range.startColumn+f.originalStart+f.originalLength;if(e==="subwordSmart"&&i&&i.lineNumber===o.range.startLineNumber&&g<i.column||f.originalLength>0)return;if(f.modifiedLength===0)continue;let v=f.modifiedStart+f.modifiedLength,I=Math.max(f.modifiedStart,Math.min(v,m)),y=o.text.substring(f.modifiedStart,I),w=o.text.substring(I,Math.max(f.modifiedStart,v));y.length>0&&h.push(new sx(g,y,!1)),w.length>0&&h.push(new sx(g,w,!0))}return new Bb(p,h)}function Exe(r,t){return t.getStartPosition().equals(r.getStartPosition())&&t.getEndPosition().isBeforeOrEqual(r.getEndPosition())}var zH;function xxe(r,t){if(zH?.originalValue===r&&zH?.newValue===t)return zH?.changes;{let e=sue(r,t,!0);if(e){let i=rue(e);if(i>0){let n=sue(r,t,!1);n&&rue(n)<i&&(e=n)}}return zH={originalValue:r,newValue:t,changes:e},e}}function rue(r){let t=0;for(let e of r)t+=e.originalLength;return t}function sue(r,t,e){if(r.length>5e3||t.length>5e3)return;function i(d){let c=0;for(let p=0,h=d.length;p<h;p++){let m=d.charCodeAt(p);m>c&&(c=m)}return c}let n=Math.max(i(r),i(t));function o(d){if(d<0)throw new Error("unexpected");return n+d+1}function s(d){let c=0,p=0,h=new Int32Array(d.length);for(let m=0,f=d.length;m<f;m++)if(e&&d[m]==="("){let g=p*100+c;h[m]=o(2*g),c++}else if(e&&d[m]===")"){c=Math.max(c-1,0);let g=p*100+c;h[m]=o(2*g+1),c===0&&p++}else h[m]=d.charCodeAt(m);return h}let a=s(r),l=s(t);return new Dm({getElements:()=>a},{getElements:()=>l}).ComputeDiff(!1).changes}var ax=class extends R{constructor(e,i,n,o,s){super();this.textModel=e;this.versionId=i;this._debounceValue=n;this.languageFeaturesService=o;this.languageConfigurationService=s;this._register(this.textModel.onDidChangeContent(()=>{this._updateOperation.clear()}))}_updateOperation=this._register(new yt);inlineCompletions=PS("inlineCompletions",void 0);suggestWidgetInlineCompletions=PS("suggestWidgetInlineCompletions",void 0);fetch(e,i,n){let o=new pj(e,i,this.textModel.getVersionId()),s=i.selectedSuggestionInfo?this.suggestWidgetInlineCompletions:this.inlineCompletions;if(this._updateOperation.value?.request.satisfies(o))return this._updateOperation.value.promise;if(s.get()?.request.satisfies(o))return Promise.resolve(!0);let a=!!this._updateOperation.value;this._updateOperation.clear();let l=new Kt,d=(async()=>{if((a||i.triggerKind===0)&&await Txe(this._debounceValue.get(this.textModel),l.token),l.token.isCancellationRequested||this._store.isDisposed||this.textModel.getVersionId()!==o.versionId)return!1;let h=new Date,m=await oue(this.languageFeaturesService.inlineCompletionsProvider,e,this.textModel,i,l.token,this.languageConfigurationService);if(l.token.isCancellationRequested||this._store.isDisposed||this.textModel.getVersionId()!==o.versionId)return!1;let f=new Date;this._debounceValue.update(this.textModel,f.getTime()-h.getTime());let g=new mj(m,o,this.textModel,this.versionId);if(n){let v=n.toInlineCompletion(void 0);n.canBeReused(this.textModel,e)&&!m.has(v)&&g.prepend(n.inlineCompletion,v.range,!0)}return this._updateOperation.clear(),nn(v=>{s.set(g,v)}),!0})(),c=new hj(o,l,d);return this._updateOperation.value=c,d}clear(e){this._updateOperation.clear(),this.inlineCompletions.set(void 0,e),this.suggestWidgetInlineCompletions.set(void 0,e)}clearSuggestWidgetInlineCompletions(e){this._updateOperation.value?.request.context.selectedSuggestionInfo&&this._updateOperation.clear(),this.suggestWidgetInlineCompletions.set(void 0,e)}cancelUpdate(){this._updateOperation.clear()}};ax=E([b(3,ni),b(4,Do)],ax);function Txe(r,t){return new Promise(e=>{let i,n=setTimeout(()=>{i&&i.dispose(),e()},r);t&&(i=t.onCancellationRequested(()=>{clearTimeout(n),i&&i.dispose(),e()}))})}var pj=class{constructor(t,e,i){this.position=t;this.context=e;this.versionId=i}satisfies(t){return this.position.equals(t.position)&&_S(this.context.selectedSuggestionInfo,t.context.selectedSuggestionInfo,WJ())&&(t.context.triggerKind===0||this.context.triggerKind===1)&&this.versionId===t.versionId}},hj=class{constructor(t,e,i){this.request=t;this.cancellationTokenSource=e;this.promise=i}dispose(){this.cancellationTokenSource.cancel()}},mj=class{constructor(t,e,i,n){this.inlineCompletionProviderResult=t;this.request=e;this._textModel=i;this._versionId=n;let o=i.deltaDecorations([],t.completions.map(s=>({range:s.range,options:{description:"inline-completion-tracking-range"}})));this._inlineCompletions=t.completions.map((s,a)=>new KH(s,o[a],this._textModel,this._versionId))}_inlineCompletions;get inlineCompletions(){return this._inlineCompletions}_refCount=1;_prependedInlineCompletionItems=[];clone(){return this._refCount++,this}dispose(){if(this._refCount--,this._refCount===0){setTimeout(()=>{this._textModel.isDisposed()||this._textModel.deltaDecorations(this._inlineCompletions.map(t=>t.decorationId),[])},0),this.inlineCompletionProviderResult.dispose();for(let t of this._prependedInlineCompletionItems)t.source.removeRef()}}prepend(t,e,i){i&&t.source.addRef();let n=this._textModel.deltaDecorations([],[{range:e,options:{description:"inline-completion-tracking-range"}}])[0];this._inlineCompletions.unshift(new KH(t,n,this._textModel,this._versionId)),this._prependedInlineCompletionItems.push(t)}},KH=class{constructor(t,e,i,n){this.inlineCompletion=t;this.decorationId=e;this._textModel=i;this._modelVersion=n}semanticId=JSON.stringify([this.inlineCompletion.filterText,this.inlineCompletion.insertText,this.inlineCompletion.range.getStartPosition().toString()]);get forwardStable(){return this.inlineCompletion.source.inlineCompletions.enableForwardStability??!1}_updatedRange=Os({owner:this,equalsFn:L.equalsRange},t=>(this._modelVersion.read(t),this._textModel.getDecorationRange(this.decorationId)));toInlineCompletion(t){return this.inlineCompletion.withRange(this._updatedRange.read(t)??uj)}toSingleTextEdit(t){return new _o(this._updatedRange.read(t)??uj,this.inlineCompletion.insertText)}isVisible(t,e,i){let n=Vb(this._toFilterTextReplacement(i),t),o=this._updatedRange.read(i);if(!o||!this.inlineCompletion.range.getStartPosition().equals(o.getStartPosition())||e.lineNumber!==n.range.startLineNumber)return!1;let s=t.getValueInRange(n.range,1),a=n.text,l=Math.max(0,e.column-n.range.startColumn),d=a.substring(0,l),c=a.substring(l),p=s.substring(0,l),h=s.substring(l),m=t.getLineIndentColumn(n.range.startLineNumber);return n.range.startColumn<=m&&(p=p.trimStart(),p.length===0&&(h=h.trimStart()),d=d.trimStart(),d.length===0&&(c=c.trimStart())),d.startsWith(p)&&!!uK(h,c)}canBeReused(t,e){let i=this._updatedRange.read(void 0);return!!i&&i.containsPosition(e)&&this.isVisible(t,e,void 0)&&pr.ofRange(i).isGreaterThanOrEqualTo(pr.ofRange(this.inlineCompletion.range))}_toFilterTextReplacement(t){return new _o(this._updatedRange.read(t)??uj,this.inlineCompletion.filterText)}},uj=new L(1,1,1,1);var lue=Object.freeze({CURRENT_YEAR:!0,CURRENT_YEAR_SHORT:!0,CURRENT_MONTH:!0,CURRENT_DATE:!0,CURRENT_HOUR:!0,CURRENT_MINUTE:!0,CURRENT_SECOND:!0,CURRENT_DAY_NAME:!0,CURRENT_DAY_NAME_SHORT:!0,CURRENT_MONTH_NAME:!0,CURRENT_MONTH_NAME_SHORT:!0,CURRENT_SECONDS_UNIX:!0,CURRENT_TIMEZONE_OFFSET:!0,SELECTION:!0,CLIPBOARD:!0,TM_SELECTED_TEXT:!0,TM_CURRENT_LINE:!0,TM_CURRENT_WORD:!0,TM_LINE_INDEX:!0,TM_LINE_NUMBER:!0,TM_FILENAME:!0,TM_FILENAME_BASE:!0,TM_DIRECTORY:!0,TM_FILEPATH:!0,CURSOR_INDEX:!0,CURSOR_NUMBER:!0,RELATIVE_FILEPATH:!0,BLOCK_COMMENT_START:!0,BLOCK_COMMENT_END:!0,LINE_COMMENT:!0,WORKSPACE_NAME:!0,WORKSPACE_FOLDER:!0,RANDOM:!0,RANDOM_HEX:!0,UUID:!0}),_R=class{constructor(t){this._delegates=t}resolve(t){for(let e of this._delegates){let i=e.resolve(t);if(i!==void 0)return i}}},DR=class{constructor(t,e,i,n){this._model=t;this._selection=e;this._selectionIdx=i;this._overtypingCapturer=n}resolve(t){let{name:e}=t;if(e==="SELECTION"||e==="TM_SELECTED_TEXT"){let i=this._model.getValueInRange(this._selection)||void 0,n=this._selection.startLineNumber!==this._selection.endLineNumber;if(!i&&this._overtypingCapturer){let o=this._overtypingCapturer.getLastOvertypedInfo(this._selectionIdx);o&&(i=o.value,n=o.multiline)}if(i&&n&&t.snippet){let o=this._model.getLineContent(this._selection.startLineNumber),s=yn(o,0,this._selection.startColumn-1),a=s;t.snippet.walk(d=>d===t?!1:(d instanceof vr&&(a=yn(Xc(d.value).pop())),!0));let l=bd(a,s);i=i.replace(/(\r\n|\r|\n)(.*)/g,(d,c,p)=>`${c}${a.substr(l)}${p}`)}return i}else{if(e==="TM_CURRENT_LINE")return this._model.getLineContent(this._selection.positionLineNumber);if(e==="TM_CURRENT_WORD"){let i=this._model.getWordAtPosition({lineNumber:this._selection.positionLineNumber,column:this._selection.positionColumn});return i&&i.word||void 0}else{if(e==="TM_LINE_INDEX")return String(this._selection.positionLineNumber-1);if(e==="TM_LINE_NUMBER")return String(this._selection.positionLineNumber);if(e==="CURSOR_INDEX")return String(this._selectionIdx);if(e==="CURSOR_NUMBER")return String(this._selectionIdx+1)}}}},kR=class{constructor(t,e){this._labelService=t;this._model=e}resolve(t){let{name:e}=t;if(e==="TM_FILENAME")return Eo(this._model.uri.fsPath);if(e==="TM_FILENAME_BASE"){let i=Eo(this._model.uri.fsPath),n=i.lastIndexOf(".");return n<=0?i:i.slice(0,n)}else{if(e==="TM_DIRECTORY")return zg(this._model.uri.fsPath)==="."?"":this._labelService.getUriLabel(Hn(this._model.uri));if(e==="TM_FILEPATH")return this._labelService.getUriLabel(this._model.uri);if(e==="RELATIVE_FILEPATH")return this._labelService.getUriLabel(this._model.uri,{relative:!0,noPrefix:!0})}}},LR=class{constructor(t,e,i,n){this._readClipboardText=t;this._selectionIdx=e;this._selectionCount=i;this._spread=n}resolve(t){if(t.name!=="CLIPBOARD")return;let e=this._readClipboardText();if(e){if(this._spread){let i=e.split(/\r\n|\n|\r/).filter(n=>!gd(n));if(i.length===this._selectionCount)return i[this._selectionIdx]}return e}}},Fy=class{constructor(t,e,i){this._model=t;this._selection=e;this._languageConfigurationService=i}resolve(t){let{name:e}=t,i=this._model.getLanguageIdAtPosition(this._selection.selectionStartLineNumber,this._selection.selectionStartColumn),n=this._languageConfigurationService.getLanguageConfiguration(i).comments;if(n){if(e==="LINE_COMMENT")return n.lineCommentToken||void 0;if(e==="BLOCK_COMMENT_START")return n.blockCommentStartToken||void 0;if(e==="BLOCK_COMMENT_END")return n.blockCommentEndToken||void 0}}};Fy=E([b(2,Do)],Fy);var RR=class r{static dayNames=[u("Sunday","Sunday"),u("Monday","Monday"),u("Tuesday","Tuesday"),u("Wednesday","Wednesday"),u("Thursday","Thursday"),u("Friday","Friday"),u("Saturday","Saturday")];static dayNamesShort=[u("SundayShort","Sun"),u("MondayShort","Mon"),u("TuesdayShort","Tue"),u("WednesdayShort","Wed"),u("ThursdayShort","Thu"),u("FridayShort","Fri"),u("SaturdayShort","Sat")];static monthNames=[u("January","January"),u("February","February"),u("March","March"),u("April","April"),u("May","May"),u("June","June"),u("July","July"),u("August","August"),u("September","September"),u("October","October"),u("November","November"),u("December","December")];static monthNamesShort=[u("JanuaryShort","Jan"),u("FebruaryShort","Feb"),u("MarchShort","Mar"),u("AprilShort","Apr"),u("MayShort","May"),u("JuneShort","Jun"),u("JulyShort","Jul"),u("AugustShort","Aug"),u("SeptemberShort","Sep"),u("OctoberShort","Oct"),u("NovemberShort","Nov"),u("DecemberShort","Dec")];_date=new Date;resolve(t){let{name:e}=t;if(e==="CURRENT_YEAR")return String(this._date.getFullYear());if(e==="CURRENT_YEAR_SHORT")return String(this._date.getFullYear()).slice(-2);if(e==="CURRENT_MONTH")return String(this._date.getMonth().valueOf()+1).padStart(2,"0");if(e==="CURRENT_DATE")return String(this._date.getDate().valueOf()).padStart(2,"0");if(e==="CURRENT_HOUR")return String(this._date.getHours().valueOf()).padStart(2,"0");if(e==="CURRENT_MINUTE")return String(this._date.getMinutes().valueOf()).padStart(2,"0");if(e==="CURRENT_SECOND")return String(this._date.getSeconds().valueOf()).padStart(2,"0");if(e==="CURRENT_DAY_NAME")return r.dayNames[this._date.getDay()];if(e==="CURRENT_DAY_NAME_SHORT")return r.dayNamesShort[this._date.getDay()];if(e==="CURRENT_MONTH_NAME")return r.monthNames[this._date.getMonth()];if(e==="CURRENT_MONTH_NAME_SHORT")return r.monthNamesShort[this._date.getMonth()];if(e==="CURRENT_SECONDS_UNIX")return String(Math.floor(this._date.getTime()/1e3));if(e==="CURRENT_TIMEZONE_OFFSET"){let i=this._date.getTimezoneOffset(),n=i>0?"-":"+",o=Math.trunc(Math.abs(i/60)),s=o<10?"0"+o:o,a=Math.abs(i)-o*60,l=a<10?"0"+a:a;return n+s+":"+l}}},PR=class{constructor(t){this._workspaceService=t}resolve(t){if(!this._workspaceService)return;let e=Jte(this._workspaceService.getWorkspace());if(!Zte(e)){if(t.name==="WORKSPACE_NAME")return this._resolveWorkspaceName(e);if(t.name==="WORKSPACE_FOLDER")return this._resoveWorkspacePath(e)}}_resolveWorkspaceName(t){if(bf(t))return Eo(t.uri.path);let e=Eo(t.configPath.path);return e.endsWith(_D)&&(e=e.substr(0,e.length-_D.length-1)),e}_resoveWorkspacePath(t){if(bf(t))return jp(t.uri.fsPath);let e=Eo(t.configPath.path),i=t.configPath.fsPath;return i.endsWith(e)&&(i=i.substr(0,i.length-e.length-1)),i?jp(i):"/"}},MR=class{resolve(t){let{name:e}=t;if(e==="RANDOM")return Math.random().toString().slice(-6);if(e==="RANDOM_HEX")return Math.random().toString(16).slice(-6);if(e==="UUID")return Ni()}};var GH=class r{constructor(t,e,i){this._editor=t;this._snippet=e;this._snippetLineLeadingWhitespace=i;this._placeholderGroups=UM(e.placeholders,da.compareByIndex),this._placeholderGroupsIdx=-1}_placeholderDecorations;_placeholderGroups;_offset=-1;_placeholderGroupsIdx;_nestingLevel=1;static _decor={active:Ii.register({description:"snippet-placeholder-1",stickiness:0,className:"snippet-placeholder"}),inactive:Ii.register({description:"snippet-placeholder-2",stickiness:1,className:"snippet-placeholder"}),activeFinal:Ii.register({description:"snippet-placeholder-3",stickiness:1,className:"finish-snippet-placeholder"}),inactiveFinal:Ii.register({description:"snippet-placeholder-4",stickiness:1,className:"finish-snippet-placeholder"})};initialize(t){this._offset=t.newPosition}dispose(){this._placeholderDecorations&&this._editor.removeDecorations([...this._placeholderDecorations.values()]),this._placeholderGroups.length=0}_initDecorations(){if(this._offset===-1)throw new Error("Snippet not initialized!");if(this._placeholderDecorations)return;this._placeholderDecorations=new Map;let t=this._editor.getModel();this._editor.changeDecorations(e=>{for(let i of this._snippet.placeholders){let n=this._snippet.offset(i),o=this._snippet.fullLen(i),s=L.fromPositions(t.getPositionAt(this._offset+n),t.getPositionAt(this._offset+n+o)),a=i.isFinalTabstop?r._decor.inactiveFinal:r._decor.inactive,l=e.addDecoration(s,a);this._placeholderDecorations.set(i,l)}})}move(t){if(!this._editor.hasModel())return[];if(this._initDecorations(),this._placeholderGroupsIdx>=0){let n=[];for(let o of this._placeholderGroups[this._placeholderGroupsIdx])if(o.transform){let s=this._placeholderDecorations.get(o),a=this._editor.getModel().getDecorationRange(s),l=this._editor.getModel().getValueInRange(a),d=o.transform.resolve(l).split(/\r\n|\r|\n/);for(let c=1;c<d.length;c++)d[c]=this._editor.getModel().normalizeIndentation(this._snippetLineLeadingWhitespace+d[c]);n.push($r.replace(a,d.join(this._editor.getModel().getEOL())))}n.length>0&&this._editor.executeEdits("snippet.placeholderTransform",n)}let e=!1;t===!0&&this._placeholderGroupsIdx<this._placeholderGroups.length-1?(this._placeholderGroupsIdx+=1,e=!0):t===!1&&this._placeholderGroupsIdx>0&&(this._placeholderGroupsIdx-=1,e=!0);let i=this._editor.getModel().changeDecorations(n=>{let o=new Set,s=[];for(let a of this._placeholderGroups[this._placeholderGroupsIdx]){let l=this._placeholderDecorations.get(a),d=this._editor.getModel().getDecorationRange(l);s.push(new Et(d.startLineNumber,d.startColumn,d.endLineNumber,d.endColumn)),e=e&&this._hasPlaceholderBeenCollapsed(a),n.changeDecorationOptions(l,a.isFinalTabstop?r._decor.activeFinal:r._decor.active),o.add(a);for(let c of this._snippet.enclosingPlaceholders(a)){let p=this._placeholderDecorations.get(c);n.changeDecorationOptions(p,c.isFinalTabstop?r._decor.activeFinal:r._decor.active),o.add(c)}}for(let[a,l]of this._placeholderDecorations)o.has(a)||n.changeDecorationOptions(l,a.isFinalTabstop?r._decor.inactiveFinal:r._decor.inactive);return s});return e?this.move(t):i??[]}_hasPlaceholderBeenCollapsed(t){let e=t;for(;e;){if(e instanceof da){let i=this._placeholderDecorations.get(e);if(this._editor.getModel().getDecorationRange(i).isEmpty()&&e.toString().length>0)return!0}e=e.parent}return!1}get isAtFirstPlaceholder(){return this._placeholderGroupsIdx<=0||this._placeholderGroups.length===0}get isAtLastPlaceholder(){return this._placeholderGroupsIdx===this._placeholderGroups.length-1}get hasPlaceholder(){return this._snippet.placeholders.length>0}get isTrivialSnippet(){if(this._snippet.placeholders.length===0)return!0;if(this._snippet.placeholders.length===1){let[t]=this._snippet.placeholders;if(t.isFinalTabstop&&this._snippet.rightMostDescendant===t)return!0}return!1}computePossibleSelections(){let t=new Map;for(let e of this._placeholderGroups){let i;for(let n of e){if(n.isFinalTabstop)break;i||(i=[],t.set(n.index,i));let o=this._placeholderDecorations.get(n),s=this._editor.getModel().getDecorationRange(o);if(!s){t.delete(n.index);break}i.push(s)}}return t}get activeChoice(){if(!this._placeholderDecorations)return;let t=this._placeholderGroups[this._placeholderGroupsIdx][0];if(!t?.choice)return;let e=this._placeholderDecorations.get(t);if(!e)return;let i=this._editor.getModel().getDecorationRange(e);if(i)return{range:i,choice:t.choice}}get hasChoice(){let t=!1;return this._snippet.walk(e=>(t=e instanceof Py,!t)),t}merge(t){let e=this._editor.getModel();this._nestingLevel*=10,this._editor.changeDecorations(i=>{for(let n of this._placeholderGroups[this._placeholderGroupsIdx]){let o=t.shift();console.assert(o._offset!==-1),console.assert(!o._placeholderDecorations);let s=o._snippet.placeholderInfo.last.index;for(let l of o._snippet.placeholderInfo.all)l.isFinalTabstop?l.index=n.index+(s+1)/this._nestingLevel:l.index=n.index+l.index/this._nestingLevel;this._snippet.replace(n,o._snippet.children);let a=this._placeholderDecorations.get(n);i.removeDecoration(a),this._placeholderDecorations.delete(n);for(let l of o._snippet.placeholders){let d=o._snippet.offset(l),c=o._snippet.fullLen(l),p=L.fromPositions(e.getPositionAt(o._offset+d),e.getPositionAt(o._offset+d+c)),h=i.addDecoration(p,r._decor.inactive);this._placeholderDecorations.set(l,h)}}this._placeholderGroups=UM(this._snippet.placeholders,da.compareByIndex)})}getEnclosingRange(){let t,e=this._editor.getModel();for(let i of this._placeholderDecorations.values()){let n=e.getDecorationRange(i)??void 0;t?t=t.plusRange(n):t=n}return t}},due={overwriteBefore:0,overwriteAfter:0,adjustWhitespace:!0,clipboardText:void 0,overtypingCapturer:void 0},ca=class{constructor(t,e,i=due,n){this._editor=t;this._template=e;this._options=i;this._languageConfigurationService=n}static adjustWhitespace(t,e,i,n,o){let s=t.getLineContent(e.lineNumber),a=yn(s,0,e.column-1),l;return n.walk(d=>{if(!(d instanceof vr)||d.parent instanceof Py||o&&!o.has(d))return!0;let c=d.value.split(/\r\n|\r|\n/);if(i){let h=n.offset(d);if(h===0)c[0]=t.normalizeIndentation(c[0]);else{l=l??n.toString();let m=l.charCodeAt(h-1);(m===10||m===13)&&(c[0]=t.normalizeIndentation(a+c[0]))}for(let m=1;m<c.length;m++)c[m]=t.normalizeIndentation(a+c[m])}let p=c.join(t.getEOL());return p!==d.value&&(d.parent.replace(d,[new vr(p)]),l=void 0),!0}),a}static adjustSelection(t,e,i,n){if(i!==0||n!==0){let{positionLineNumber:o,positionColumn:s}=e,a=s-i,l=s+n,d=t.validateRange({startLineNumber:o,startColumn:a,endLineNumber:o,endColumn:l});e=Et.createWithDirection(d.startLineNumber,d.startColumn,d.endLineNumber,d.endColumn,e.getDirection())}return e}static createEditsAndSnippetsFromSelections(t,e,i,n,o,s,a,l,d){let c=[],p=[];if(!t.hasModel())return{edits:c,snippets:p};let h=t.getModel(),m=t.invokeWithinContext(C=>C.get(kt)),f=t.invokeWithinContext(C=>new kR(C.get(hi),h)),g=()=>a,v=h.getValueInRange(ca.adjustSelection(h,t.getSelection(),i,0)),I=h.getValueInRange(ca.adjustSelection(h,t.getSelection(),0,n)),y=h.getLineFirstNonWhitespaceColumn(t.getSelection().positionLineNumber),w=t.getSelections().map((C,S)=>({selection:C,idx:S})).sort((C,S)=>L.compareRangesUsingStarts(C.selection,S.selection));for(let{selection:C,idx:S}of w){let D=ca.adjustSelection(h,C,i,0),k=ca.adjustSelection(h,C,0,n);v!==h.getValueInRange(D)&&(D=C),I!==h.getValueInRange(k)&&(k=C);let M=C.setStartPosition(D.startLineNumber,D.startColumn).setEndPosition(k.endLineNumber,k.endColumn),O=new Fa().parse(e,!0,o),K=M.getStartPosition(),G=ca.adjustWhitespace(h,K,s||S>0&&y!==h.getLineFirstNonWhitespaceColumn(C.positionLineNumber),O);O.resolveVariables(new _R([f,new LR(g,S,w.length,t.getOption(80)==="spread"),new DR(h,C,S,l),new Fy(h,C,d),new RR,new PR(m),new MR])),c[S]=$r.replace(M,O.toString()),c[S].identifier={major:S,minor:0},c[S]._isTracked=!0,p[S]=new GH(t,O,G)}return{edits:c,snippets:p}}static createEditsAndSnippetsFromEdits(t,e,i,n,o,s,a){if(!t.hasModel()||e.length===0)return{edits:[],snippets:[]};let l=[],d=t.getModel(),c=new Fa,p=new rx,h=new _R([t.invokeWithinContext(f=>new kR(f.get(hi),d)),new LR(()=>o,0,t.getSelections().length,t.getOption(80)==="spread"),new DR(d,t.getSelection(),0,s),new Fy(d,t.getSelection(),a),new RR,new PR(t.invokeWithinContext(f=>f.get(kt))),new MR]);e=e.sort((f,g)=>L.compareRangesUsingStarts(f.range,g.range));let m=0;for(let f=0;f<e.length;f++){let{range:g,template:v}=e[f];if(f>0){let S=e[f-1].range,D=L.fromPositions(S.getEndPosition(),g.getStartPosition()),k=new vr(d.getValueInRange(D));p.appendChild(k),m+=k.value.length}let I=c.parseFragment(v,p);ca.adjustWhitespace(d,g.getStartPosition(),!0,p,new Set(I)),p.resolveVariables(h);let y=p.toString(),w=y.slice(m);m=y.length;let C=$r.replace(g,w);C.identifier={major:f,minor:0},C._isTracked=!0,l.push(C)}return c.ensureFinalTabstop(p,i,!0),{edits:l,snippets:[new GH(t,p,"")]}}_templateMerges=[];_snippets=[];dispose(){_e(this._snippets)}_logInfo(){return`template="${this._template}", merged_templates="${this._templateMerges.join(" -> ")}"`}insert(){if(!this._editor.hasModel())return;let{edits:t,snippets:e}=typeof this._template=="string"?ca.createEditsAndSnippetsFromSelections(this._editor,this._template,this._options.overwriteBefore,this._options.overwriteAfter,!1,this._options.adjustWhitespace,this._options.clipboardText,this._options.overtypingCapturer,this._languageConfigurationService):ca.createEditsAndSnippetsFromEdits(this._editor,this._template,!1,this._options.adjustWhitespace,this._options.clipboardText,this._options.overtypingCapturer,this._languageConfigurationService);this._snippets=e,this._editor.executeEdits("snippet",t,i=>{let n=i.filter(o=>!!o.identifier);for(let o=0;o<e.length;o++)e[o].initialize(n[o].textChange);return this._snippets[0].hasPlaceholder?this._move(!0):n.map(o=>Et.fromPositions(o.range.getEndPosition()))}),this._editor.revealRange(this._editor.getSelections()[0])}merge(t,e=due){if(!this._editor.hasModel())return;this._templateMerges.push([this._snippets[0]._nestingLevel,this._snippets[0]._placeholderGroupsIdx,t]);let{edits:i,snippets:n}=ca.createEditsAndSnippetsFromSelections(this._editor,t,e.overwriteBefore,e.overwriteAfter,!0,e.adjustWhitespace,e.clipboardText,e.overtypingCapturer,this._languageConfigurationService);this._editor.executeEdits("snippet",i,o=>{let s=o.filter(l=>!!l.identifier);for(let l=0;l<n.length;l++)n[l].initialize(s[l].textChange);let a=n[0].isTrivialSnippet;if(!a){for(let l of this._snippets)l.merge(n);console.assert(n.length===0)}return this._snippets[0].hasPlaceholder&&!a?this._move(void 0):s.map(l=>Et.fromPositions(l.range.getEndPosition()))})}next(){let t=this._move(!0);this._editor.setSelections(t),this._editor.revealPositionInCenterIfOutsideViewport(t[0].getPosition())}prev(){let t=this._move(!1);this._editor.setSelections(t),this._editor.revealPositionInCenterIfOutsideViewport(t[0].getPosition())}_move(t){let e=[];for(let i of this._snippets){let n=i.move(t);e.push(...n)}return e}get isAtFirstPlaceholder(){return this._snippets[0].isAtFirstPlaceholder}get isAtLastPlaceholder(){return this._snippets[0].isAtLastPlaceholder}get hasPlaceholder(){return this._snippets[0].hasPlaceholder}get hasChoice(){return this._snippets[0].hasChoice}get activeChoice(){return this._snippets[0].activeChoice}isSelectionWithinPlaceholders(){if(!this.hasPlaceholder)return!1;let t=this._editor.getSelections();if(t.length<this._snippets.length)return!1;let e=new Map;for(let i of this._snippets){let n=i.computePossibleSelections();if(e.size===0)for(let[o,s]of n){s.sort(L.compareRangesUsingStarts);for(let a of t)if(s[0].containsRange(a)){e.set(o,[]);break}}if(e.size===0)return!1;e.forEach((o,s)=>{o.push(...n.get(s))})}t.sort(L.compareRangesUsingStarts);for(let[i,n]of e){if(n.length!==t.length){e.delete(i);continue}n.sort(L.compareRangesUsingStarts);for(let o=0;o<n.length;o++)if(!n[o].containsRange(t[o])){e.delete(i);continue}}return e.size>0}getEnclosingRange(){let t;for(let e of this._snippets){let i=e.getEnclosingRange();t?t=t.plusRange(i):t=i}return t}};ca=E([b(3,Do)],ca);var mg=class r{constructor(t,e,i,n,o){this._initialScrollTop=t;this._initialContentHeight=e;this._visiblePosition=i;this._visiblePositionScrollDelta=n;this._cursorPosition=o}static capture(t){if(t.getScrollTop()===0||t.hasPendingScrollAnimation())return new r(t.getScrollTop(),t.getContentHeight(),null,0,null);let e=null,i=0,n=t.getVisibleRanges();if(n.length>0){e=n[0].getStartPosition();let o=t.getTopForPosition(e.lineNumber,e.column);i=t.getScrollTop()-o}return new r(t.getScrollTop(),t.getContentHeight(),e,i,t.getPosition())}restore(t){if(!(this._initialContentHeight===t.getContentHeight()&&this._initialScrollTop===t.getScrollTop())&&this._visiblePosition){let e=t.getTopForPosition(this._visiblePosition.lineNumber,this._visiblePosition.column);t.setScrollTop(e+this._visiblePositionScrollDelta)}}restoreRelativeVerticalPositionOfCursor(t){if(this._initialContentHeight===t.getContentHeight()&&this._initialScrollTop===t.getScrollTop())return;let e=t.getPosition();if(!this._cursorPosition||!e)return;let i=t.getTopForLineNumber(e.lineNumber)-t.getTopForLineNumber(this._cursorPosition.lineNumber);t.setScrollTop(t.getScrollTop()+i,1)}};var AR=class{constructor(t){this.name=t}select(t,e,i){if(i.length===0)return 0;let n=i[0].score[0];for(let o=0;o<i.length;o++){let{score:s,completion:a}=i[o];if(s[0]!==n)break;if(a.preselect)return o}return 0}},qH=class extends AR{constructor(){super("first")}memorize(t,e,i){}toJSON(){}fromJSON(){}},gj=class extends AR{constructor(){super("recentlyUsed")}_cache=new zr(300,.66);_seq=0;memorize(t,e,i){let n=`${t.getLanguageId()}/${i.textLabel}`;this._cache.set(n,{touch:this._seq++,type:i.completion.kind,insertText:i.completion.insertText})}select(t,e,i){if(i.length===0)return 0;let n=t.getLineContent(e.lineNumber).substr(e.column-10,e.column-1);if(/\s$/.test(n))return super.select(t,e,i);let o=i[0].score[0],s=-1,a=-1,l=-1;for(let d=0;d<i.length&&i[d].score[0]===o;d++){let c=`${t.getLanguageId()}/${i[d].textLabel}`,p=this._cache.peek(c);if(p&&p.touch>l&&p.type===i[d].completion.kind&&p.insertText===i[d].completion.insertText&&(l=p.touch,a=d),i[d].completion.preselect&&s===-1)return s=d}return a!==-1?a:s!==-1?s:0}toJSON(){return this._cache.toJSON()}fromJSON(t){this._cache.clear();let e=0;for(let[i,n]of t)n.touch=e,n.type=typeof n.type=="number"?n.type:xf.fromString(n.type),this._cache.set(i,n);this._seq=this._cache.size}},fj=class extends AR{constructor(){super("recentlyUsedByPrefix")}_trie=iC.forStrings();_seq=0;memorize(t,e,i){let{word:n}=t.getWordUntilPosition(e),o=`${t.getLanguageId()}/${n}`;this._trie.set(o,{type:i.completion.kind,insertText:i.completion.insertText,touch:this._seq++})}select(t,e,i){let{word:n}=t.getWordUntilPosition(e);if(!n)return super.select(t,e,i);let o=`${t.getLanguageId()}/${n}`,s=this._trie.get(o);if(s||(s=this._trie.findSubstr(o)),s)for(let a=0;a<i.length;a++){let{kind:l,insertText:d}=i[a].completion;if(l===s.type&&d===s.insertText)return a}return super.select(t,e,i)}toJSON(){let t=[];return this._trie.forEach((e,i)=>t.push([i,e])),t.sort((e,i)=>-(e[1].touch-i[1].touch)).forEach((e,i)=>e[1].touch=i),t.slice(0,200)}fromJSON(t){if(this._trie.clear(),t.length>0){this._seq=t[0][1].touch+1;for(let[e,i]of t)i.type=typeof i.type=="number"?i.type:xf.fromString(i.type),this._trie.set(e,i)}}},gg=class{constructor(t,e){this._storageService=t;this._configService=e;this._persistSoon=new Ye(()=>this._saveState(),500),this._disposables.add(t.onWillSaveState(i=>{i.reason===1&&this._saveState()}))}static _strategyCtors=new Map([["recentlyUsedByPrefix",fj],["recentlyUsed",gj],["first",qH]]);static _storagePrefix="suggest/memories";_serviceBrand;_persistSoon;_disposables=new B;_strategy;dispose(){this._disposables.dispose(),this._persistSoon.dispose()}memorize(t,e,i){this._withStrategy(t,e).memorize(t,e,i),this._persistSoon.schedule()}select(t,e,i){return this._withStrategy(t,e).select(t,e,i)}_withStrategy(t,e){let i=this._configService.getValue("editor.suggestSelection",{overrideIdentifier:t.getLanguageIdAtPosition(e.lineNumber,e.column),resource:t.uri});if(this._strategy?.name!==i){this._saveState();let n=gg._strategyCtors.get(i)||qH;this._strategy=new n;try{let s=this._configService.getValue("editor.suggest.shareSuggestSelections")?0:1,a=this._storageService.get(`${gg._storagePrefix}/${i}`,s);a&&this._strategy.fromJSON(JSON.parse(a))}catch{}}return this._strategy}_saveState(){if(this._strategy){let e=this._configService.getValue("editor.suggest.shareSuggestSelections")?0:1,i=JSON.stringify(this._strategy);this._storageService.store(`${gg._storagePrefix}/${this._strategy.name}`,i,e,1)}}};gg=E([b(0,nt),b(1,se)],gg);var bj=q("ISuggestMemories");gi(bj,gg,1);var fg=class{constructor(t,e){this._editor=t;this._ckAtEnd=fg.AtEnd.bindTo(e),this._configListener=this._editor.onDidChangeConfiguration(i=>i.hasChanged(125)&&this._update()),this._update()}static AtEnd=new A("atEndOfWord",!1);_ckAtEnd;_configListener;_enabled=!1;_selectionListener;dispose(){this._configListener.dispose(),this._selectionListener?.dispose(),this._ckAtEnd.reset()}_update(){let t=this._editor.getOption(125)==="on";if(this._enabled!==t)if(this._enabled=t,this._enabled){let e=()=>{if(!this._editor.hasModel()){this._ckAtEnd.set(!1);return}let i=this._editor.getModel(),n=this._editor.getSelection(),o=i.getWordAtPosition(n.getStartPosition());if(!o){this._ckAtEnd.set(!1);return}this._ckAtEnd.set(o.endColumn===n.getStartPosition().column)};this._selectionListener=this._editor.onDidChangeCursorSelection(e),e()}else this._selectionListener&&(this._ckAtEnd.reset(),this._selectionListener.dispose(),this._selectionListener=void 0)}};fg=E([b(1,re)],fg);var ml=class extends $s{_parentEditor;_overwriteOptions;constructor(t,e,i,n,o,s,a,l,d,c,p,h,m){super(t,{...n.getRawOptions(),overflowWidgetsDomNode:n.getOverflowWidgetsDomNode()},i,o,s,a,l,d,c,p,h,m),this._parentEditor=n,this._overwriteOptions=e,super.updateOptions(this._overwriteOptions),this._register(n.onDidChangeConfiguration(f=>this._onParentConfigurationChanged(f)))}getParentEditor(){return this._parentEditor}_onParentConfigurationChanged(t){super.updateOptions(this._parentEditor.getRawOptions()),super.updateOptions(this._overwriteOptions)}updateOptions(t){Bs(this._overwriteOptions,t,!0),super.updateOptions(this._overwriteOptions)}};ml=E([b(4,ne),b(5,En),b(6,ct),b(7,re),b(8,Fe),b(9,mi),b(10,Un),b(11,Do),b(12,ni)],ml);var lx=class{constructor(t,e,i,n,o){this._menuId=e;this._menuService=n;this._contextKeyService=o;this.element=U(t,J(".suggest-status-bar"));let s=a=>a instanceof wn?i.createInstance(pF,a,{useComma:!0}):void 0;this._leftActions=new Fi(this.element,{actionViewItemProvider:s}),this._rightActions=new Fi(this.element,{actionViewItemProvider:s}),this._leftActions.domNode.classList.add("left"),this._rightActions.domNode.classList.add("right")}element;_leftActions;_rightActions;_menuDisposables=new B;dispose(){this._menuDisposables.dispose(),this._leftActions.dispose(),this._rightActions.dispose(),this.element.remove()}show(){let t=this._menuService.createMenu(this._menuId,this._contextKeyService),e=()=>{let i=[],n=[];for(let[o,s]of t.getActions())o==="left"?i.push(...s):n.push(...s);this._leftActions.clear(),this._leftActions.push(i),this._rightActions.clear(),this._rightActions.push(n)};this._menuDisposables.add(t.onDidChange(()=>e())),this._menuDisposables.add(t)}hide(){this._menuDisposables.clear()}};lx=E([b(2,ne),b(3,jt),b(4,re)],lx);var win=T("symbolIcon.arrayForeground",st,u("symbolIcon.arrayForeground","The foreground color for array symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Ein=T("symbolIcon.booleanForeground",st,u("symbolIcon.booleanForeground","The foreground color for boolean symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),xin=T("symbolIcon.classForeground",{dark:"#EE9D28",light:"#D67E00",hcDark:"#EE9D28",hcLight:"#D67E00"},u("symbolIcon.classForeground","The foreground color for class symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Tin=T("symbolIcon.colorForeground",st,u("symbolIcon.colorForeground","The foreground color for color symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),_in=T("symbolIcon.constantForeground",st,u("symbolIcon.constantForeground","The foreground color for constant symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Din=T("symbolIcon.constructorForeground",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},u("symbolIcon.constructorForeground","The foreground color for constructor symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),kin=T("symbolIcon.enumeratorForeground",{dark:"#EE9D28",light:"#D67E00",hcDark:"#EE9D28",hcLight:"#D67E00"},u("symbolIcon.enumeratorForeground","The foreground color for enumerator symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Lin=T("symbolIcon.enumeratorMemberForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},u("symbolIcon.enumeratorMemberForeground","The foreground color for enumerator member symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Rin=T("symbolIcon.eventForeground",{dark:"#EE9D28",light:"#D67E00",hcDark:"#EE9D28",hcLight:"#D67E00"},u("symbolIcon.eventForeground","The foreground color for event symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Pin=T("symbolIcon.fieldForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},u("symbolIcon.fieldForeground","The foreground color for field symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Min=T("symbolIcon.fileForeground",st,u("symbolIcon.fileForeground","The foreground color for file symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Ain=T("symbolIcon.folderForeground",st,u("symbolIcon.folderForeground","The foreground color for folder symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Oin=T("symbolIcon.functionForeground",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},u("symbolIcon.functionForeground","The foreground color for function symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Nin=T("symbolIcon.interfaceForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},u("symbolIcon.interfaceForeground","The foreground color for interface symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Fin=T("symbolIcon.keyForeground",st,u("symbolIcon.keyForeground","The foreground color for key symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Bin=T("symbolIcon.keywordForeground",st,u("symbolIcon.keywordForeground","The foreground color for keyword symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Vin=T("symbolIcon.methodForeground",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},u("symbolIcon.methodForeground","The foreground color for method symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Win=T("symbolIcon.moduleForeground",st,u("symbolIcon.moduleForeground","The foreground color for module symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Hin=T("symbolIcon.namespaceForeground",st,u("symbolIcon.namespaceForeground","The foreground color for namespace symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Uin=T("symbolIcon.nullForeground",st,u("symbolIcon.nullForeground","The foreground color for null symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),zin=T("symbolIcon.numberForeground",st,u("symbolIcon.numberForeground","The foreground color for number symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Kin=T("symbolIcon.objectForeground",st,u("symbolIcon.objectForeground","The foreground color for object symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Gin=T("symbolIcon.operatorForeground",st,u("symbolIcon.operatorForeground","The foreground color for operator symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),qin=T("symbolIcon.packageForeground",st,u("symbolIcon.packageForeground","The foreground color for package symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),$in=T("symbolIcon.propertyForeground",st,u("symbolIcon.propertyForeground","The foreground color for property symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),jin=T("symbolIcon.referenceForeground",st,u("symbolIcon.referenceForeground","The foreground color for reference symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Xin=T("symbolIcon.snippetForeground",st,u("symbolIcon.snippetForeground","The foreground color for snippet symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Yin=T("symbolIcon.stringForeground",st,u("symbolIcon.stringForeground","The foreground color for string symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Qin=T("symbolIcon.structForeground",st,u("symbolIcon.structForeground","The foreground color for struct symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Zin=T("symbolIcon.textForeground",st,u("symbolIcon.textForeground","The foreground color for text symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Jin=T("symbolIcon.typeParameterForeground",st,u("symbolIcon.typeParameterForeground","The foreground color for type parameter symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),enn=T("symbolIcon.unitForeground",st,u("symbolIcon.unitForeground","The foreground color for unit symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),tnn=T("symbolIcon.variableForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},u("symbolIcon.variableForeground","The foreground color for variable symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));var Wb=class{domNode;_onDidWillResize=new x;onDidWillResize=this._onDidWillResize.event;_onDidResize=new x;onDidResize=this._onDidResize.event;_northSash;_eastSash;_southSash;_westSash;_sashListener=new B;_size=new Ge(0,0);_minSize=new Ge(0,0);_maxSize=new Ge(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER);_preferredSize;constructor(){this.domNode=document.createElement("div"),this._eastSash=new xl(this.domNode,{getVerticalSashLeft:()=>this._size.width},{orientation:0}),this._westSash=new xl(this.domNode,{getVerticalSashLeft:()=>0},{orientation:0}),this._northSash=new xl(this.domNode,{getHorizontalSashTop:()=>0},{orientation:1,orthogonalEdge:"north"}),this._southSash=new xl(this.domNode,{getHorizontalSashTop:()=>this._size.height},{orientation:1,orthogonalEdge:"south"}),this._northSash.orthogonalStartSash=this._westSash,this._northSash.orthogonalEndSash=this._eastSash,this._southSash.orthogonalStartSash=this._westSash,this._southSash.orthogonalEndSash=this._eastSash;let t,e=0,i=0;this._sashListener.add(X.any(this._northSash.onDidStart,this._eastSash.onDidStart,this._southSash.onDidStart,this._westSash.onDidStart)(()=>{t===void 0&&(this._onDidWillResize.fire(),t=this._size,e=0,i=0)})),this._sashListener.add(X.any(this._northSash.onDidEnd,this._eastSash.onDidEnd,this._southSash.onDidEnd,this._westSash.onDidEnd)(()=>{t!==void 0&&(t=void 0,e=0,i=0,this._onDidResize.fire({dimension:this._size,done:!0}))})),this._sashListener.add(this._eastSash.onDidChange(n=>{t&&(i=n.currentX-n.startX,this.layout(t.height+e,t.width+i),this._onDidResize.fire({dimension:this._size,done:!1,east:!0}))})),this._sashListener.add(this._westSash.onDidChange(n=>{t&&(i=-(n.currentX-n.startX),this.layout(t.height+e,t.width+i),this._onDidResize.fire({dimension:this._size,done:!1,west:!0}))})),this._sashListener.add(this._northSash.onDidChange(n=>{t&&(e=-(n.currentY-n.startY),this.layout(t.height+e,t.width+i),this._onDidResize.fire({dimension:this._size,done:!1,north:!0}))})),this._sashListener.add(this._southSash.onDidChange(n=>{t&&(e=n.currentY-n.startY,this.layout(t.height+e,t.width+i),this._onDidResize.fire({dimension:this._size,done:!1,south:!0}))})),this._sashListener.add(X.any(this._eastSash.onDidReset,this._westSash.onDidReset)(n=>{this._preferredSize&&(this.layout(this._size.height,this._preferredSize.width),this._onDidResize.fire({dimension:this._size,done:!0}))})),this._sashListener.add(X.any(this._northSash.onDidReset,this._southSash.onDidReset)(n=>{this._preferredSize&&(this.layout(this._preferredSize.height,this._size.width),this._onDidResize.fire({dimension:this._size,done:!0}))}))}dispose(){this._northSash.dispose(),this._southSash.dispose(),this._eastSash.dispose(),this._westSash.dispose(),this._sashListener.dispose(),this._onDidResize.dispose(),this._onDidWillResize.dispose(),this.domNode.remove()}enableSashes(t,e,i,n){this._northSash.state=t?3:0,this._eastSash.state=e?3:0,this._southSash.state=i?3:0,this._westSash.state=n?3:0}layout(t=this.size.height,e=this.size.width){let{height:i,width:n}=this._minSize,{height:o,width:s}=this._maxSize;t=Math.max(i,Math.min(o,t)),e=Math.max(n,Math.min(s,e));let a=new Ge(e,t);Ge.equals(a,this._size)||(this.domNode.style.height=t+"px",this.domNode.style.width=e+"px",this._size=a,this._northSash.layout(),this._eastSash.layout(),this._southSash.layout(),this._westSash.layout())}clearSashHoverState(){this._eastSash.clearSashHoverState(),this._westSash.clearSashHoverState(),this._northSash.clearSashHoverState(),this._southSash.clearSashHoverState()}get size(){return this._size}set maxSize(t){this._maxSize=t}get maxSize(){return this._maxSize}set minSize(t){this._minSize=t}get minSize(){return this._minSize}set preferredSize(t){this._preferredSize=t}get preferredSize(){return this._preferredSize}};var Ph=class{constructor(t,e,i){this._options=t;this._languageService=e;this._openerService=i}static _ttpTokenizer=kh("tokenizeToString",{createHTML(t){return t}});_onDidRenderAsync=new x;onDidRenderAsync=this._onDidRenderAsync.event;dispose(){this._onDidRenderAsync.dispose()}render(t,e,i){if(!t)return{element:document.createElement("span"),dispose:()=>{}};let n=new B,o=n.add(Qf(t,{...this._getRenderOptions(t,n),...e},i));return o.element.classList.add("rendered-markdown"),{element:o.element,dispose:()=>n.dispose()}}_getRenderOptions(t,e){return{codeBlockRenderer:async(i,n)=>{let o;i?o=this._languageService.getLanguageIdByLanguageName(i):this._options.editor&&(o=this._options.editor.getModel()?.getLanguageId()),o||(o=jn);let s=await Gce(this._languageService,n,o),a=document.createElement("span");if(a.innerHTML=Ph._ttpTokenizer?.createHTML(s)??s,this._options.editor){let l=this._options.editor.getOption(51);hn(a,l)}else this._options.codeBlockFontFamily&&(a.style.fontFamily=this._options.codeBlockFontFamily);return this._options.codeBlockFontSize!==void 0&&(a.style.fontSize=this._options.codeBlockFontSize),a},asyncRenderCallback:()=>this._onDidRenderAsync.fire(),actionHandler:{callback:i=>this.openMarkdownLink(i,t),disposables:e}}}async openMarkdownLink(t,e){await vj(this._openerService,t,e.isTrusted)}};Ph=E([b(1,ti),b(2,Yi)],Ph);async function vj(r,t,e){try{return await r.open(t,{fromUserGesture:!0,allowContributedOpeners:!0,allowCommands:_xe(e)})}catch(i){return Xe(i),!1}}function _xe(r){return r===!0?!0:r&&Array.isArray(r.enabledCommands)?r.enabledCommands:!1}function OR(r){return!!r&&!!(r.completion.documentation||r.completion.detail&&r.completion.detail!==r.completion.label)}var dx=class{constructor(t,e){this._editor=t;this.domNode=J(".suggest-details"),this.domNode.classList.add("no-docs"),this._markdownRenderer=e.createInstance(Ph,{editor:t}),this._body=J(".body"),this._scrollbar=new Da(this._body,{alwaysConsumeMouseWheel:!0}),U(this.domNode,this._scrollbar.getDomNode()),this._disposables.add(this._scrollbar),this._header=U(this._body,J(".header")),this._close=U(this._header,J("span"+de.asCSSSelector(N.close))),this._close.title=u("details.close","Close"),this._close.role="button",this._close.tabIndex=-1,this._type=U(this._header,J("p.type")),this._docs=U(this._body,J("p.docs")),this._configureFont(),this._disposables.add(this._editor.onDidChangeConfiguration(i=>{i.hasChanged(51)&&this._configureFont()}))}domNode;_onDidClose=new x;onDidClose=this._onDidClose.event;_onDidChangeContents=new x;onDidChangeContents=this._onDidChangeContents.event;_close;_scrollbar;_body;_header;_type;_docs;_disposables=new B;_markdownRenderer;_renderDisposeable=new B;_borderWidth=1;_size=new Ge(330,0);dispose(){this._disposables.dispose(),this._renderDisposeable.dispose()}_configureFont(){let t=this._editor.getOptions(),e=t.get(51),i=e.getMassagedFontFamily(),n=t.get(121)||e.fontSize,o=t.get(122)||e.lineHeight,s=e.fontWeight,a=`${n}px`,l=`${o}px`;this.domNode.style.fontSize=a,this.domNode.style.lineHeight=`${o/n}`,this.domNode.style.fontWeight=s,this.domNode.style.fontFeatureSettings=e.fontFeatureSettings,this._type.style.fontFamily=i,this._close.style.height=l,this._close.style.width=l}getLayoutInfo(){let t=this._editor.getOption(122)||this._editor.getOption(51).lineHeight,e=this._borderWidth,i=e*2;return{lineHeight:t,borderWidth:e,borderHeight:i,verticalPadding:22,horizontalPadding:14}}renderLoading(){this._type.textContent=u("loading","Loading..."),this._docs.textContent="",this.domNode.classList.remove("no-docs","no-type"),this.layout(this.size.width,this.getLayoutInfo().lineHeight*2),this._onDidChangeContents.fire(this)}renderItem(t,e){this._renderDisposeable.clear();let{detail:i,documentation:n}=t.completion;if(e){let o="";o+=`score: ${t.score[0]}
`,o+=`prefix: ${t.word??"(no prefix)"}
`,o+=`word: ${t.completion.filterText?t.completion.filterText+" (filterText)":t.textLabel}
`,o+=`distance: ${t.distance} (localityBonus-setting)
`,o+=`index: ${t.idx}, based on ${t.completion.sortText&&`sortText: "${t.completion.sortText}"`||"label"}
`,o+=`commit_chars: ${t.completion.commitCharacters?.join("")}
`,n=new Sn().appendCodeblock("empty",o),i=`Provider: ${t.provider._debugDisplayName}`}if(!e&&!OR(t)){this.clearContents();return}if(this.domNode.classList.remove("no-docs","no-type"),i){let o=i.length>1e5?`${i.substr(0,1e5)}\u2026`:i;this._type.textContent=o,this._type.title=o,rn(this._type),this._type.classList.toggle("auto-wrap",!/\r?\n^\s+/gmi.test(o))}else ai(this._type),this._type.title="",ji(this._type),this.domNode.classList.add("no-type");if(ai(this._docs),typeof n=="string")this._docs.classList.remove("markdown-docs"),this._docs.textContent=n;else if(n){this._docs.classList.add("markdown-docs"),ai(this._docs);let o=this._markdownRenderer.render(n);this._docs.appendChild(o.element),this._renderDisposeable.add(o),this._renderDisposeable.add(this._markdownRenderer.onDidRenderAsync(()=>{this.layout(this._size.width,this._type.clientHeight+this._docs.clientHeight),this._onDidChangeContents.fire(this)}))}this.domNode.style.userSelect="text",this.domNode.tabIndex=-1,this._close.onmousedown=o=>{o.preventDefault(),o.stopPropagation()},this._close.onclick=o=>{o.preventDefault(),o.stopPropagation(),this._onDidClose.fire()},this._body.scrollTop=0,this.layout(this._size.width,this._type.clientHeight+this._docs.clientHeight),this._onDidChangeContents.fire(this)}clearContents(){this.domNode.classList.add("no-docs"),this._type.textContent="",this._docs.textContent=""}get isEmpty(){return this.domNode.classList.contains("no-docs")}get size(){return this._size}layout(t,e){let i=new Ge(t,e);Ge.equals(i,this._size)||(this._size=i,VA(this.domNode,t,e)),this._scrollbar.scanDomNode()}scrollDown(t=8){this._body.scrollTop+=t}scrollUp(t=8){this._body.scrollTop-=t}scrollTop(){this._body.scrollTop=0}scrollBottom(){this._body.scrollTop=this._body.scrollHeight}pageDown(){this.scrollDown(80)}pageUp(){this.scrollUp(80)}set borderWidth(t){this._borderWidth=t}get borderWidth(){return this._borderWidth}focus(){this.domNode.focus()}};dx=E([b(1,ne)],dx);var $H=class{constructor(t,e){this.widget=t;this._editor=e;this._resizable=new Wb,this._resizable.domNode.classList.add("suggest-details-container"),this._resizable.domNode.appendChild(t.domNode),this._resizable.enableSashes(!1,!0,!0,!1);let i,n,o=0,s=0;this._disposables.add(this._resizable.onDidWillResize(()=>{i=this._topLeft,n=this._resizable.size})),this._disposables.add(this._resizable.onDidResize(a=>{if(i&&n){this.widget.layout(a.dimension.width,a.dimension.height);let l=!1;a.west&&(s=n.width-a.dimension.width,l=!0),a.north&&(o=n.height-a.dimension.height,l=!0),l&&this._applyTopLeft({top:i.top+o,left:i.left+s})}a.done&&(i=void 0,n=void 0,o=0,s=0,this._userSize=a.dimension)})),this._disposables.add(this.widget.onDidChangeContents(()=>{this._anchorBox&&this._placeAtAnchor(this._anchorBox,this._userSize??this.widget.size,this._preferAlignAtTop)}))}allowEditorOverflow=!0;_disposables=new B;_resizable;_added=!1;_anchorBox;_preferAlignAtTop=!0;_userSize;_topLeft;dispose(){this._resizable.dispose(),this._disposables.dispose(),this.hide()}getId(){return"suggest.details"}getDomNode(){return this._resizable.domNode}getPosition(){return this._topLeft?{preference:this._topLeft}:null}show(){this._added||(this._editor.addOverlayWidget(this),this._added=!0)}hide(t=!1){this._resizable.clearSashHoverState(),this._added&&(this._editor.removeOverlayWidget(this),this._added=!1,this._anchorBox=void 0,this._topLeft=void 0),t&&(this._userSize=void 0,this.widget.clearContents())}placeAtAnchor(t,e){let i=t.getBoundingClientRect();this._anchorBox=i,this._preferAlignAtTop=e,this._placeAtAnchor(this._anchorBox,this._userSize??this.widget.size,e)}_placeAtAnchor(t,e,i){let n=Qa(this.getDomNode().ownerDocument.body),o=this.widget.getLayoutInfo(),s=new Ge(220,2*o.lineHeight),a=t.top,l=function(){let S=n.width-(t.left+t.width+o.borderWidth+o.horizontalPadding),D=-o.borderWidth+t.left+t.width,k=new Ge(S,n.height-t.top-o.borderHeight-o.verticalPadding),M=k.with(void 0,t.top+t.height-o.borderHeight-o.verticalPadding);return{top:a,left:D,fit:S-e.width,maxSizeTop:k,maxSizeBottom:M,minSize:s.with(Math.min(S,s.width))}}(),d=function(){let S=t.left-o.borderWidth-o.horizontalPadding,D=Math.max(o.horizontalPadding,t.left-e.width-o.borderWidth),k=new Ge(S,n.height-t.top-o.borderHeight-o.verticalPadding),M=k.with(void 0,t.top+t.height-o.borderHeight-o.verticalPadding);return{top:a,left:D,fit:S-e.width,maxSizeTop:k,maxSizeBottom:M,minSize:s.with(Math.min(S,s.width))}}(),c=function(){let S=t.left,D=-o.borderWidth+t.top+t.height,k=new Ge(t.width-o.borderHeight,n.height-t.top-t.height-o.verticalPadding);return{top:D,left:S,fit:k.height-e.height,maxSizeBottom:k,maxSizeTop:k,minSize:s.with(k.width)}}(),p=[l,d,c],h=p.find(S=>S.fit>=0)??p.sort((S,D)=>D.fit-S.fit)[0],m=t.top+t.height-o.borderHeight,f,g=e.height,v=Math.max(h.maxSizeTop.height,h.maxSizeBottom.height);g>v&&(g=v);let I;i?g<=h.maxSizeTop.height?(f=!0,I=h.maxSizeTop):(f=!1,I=h.maxSizeBottom):g<=h.maxSizeBottom.height?(f=!1,I=h.maxSizeBottom):(f=!0,I=h.maxSizeTop);let{top:y,left:w}=h;!f&&g>t.height&&(y=m-g);let C=this._editor.getDomNode();if(C){let S=C.getBoundingClientRect();y-=S.top,w-=S.left}this._applyTopLeft({left:w,top:y}),this._resizable.enableSashes(!f,h===l,f,h!==l),this._resizable.minSize=h.minSize,this._resizable.maxSize=I,this._resizable.layout(g,Math.min(I.width,e.width)),this.widget.layout(this._resizable.size.width,this._resizable.size.height)}_applyTopLeft(t){this._topLeft=t,this._editor.layoutOverlayWidget(this)}};var Dxe=/(?:\/|^)(?:([^\/]+)\/)?([^\/]+)$/;function ua(r,t,e,i,n){if(de.isThemeIcon(n))return[`codicon-${n.id}`,"predefined-file-icon"];if(Z.isUri(n))return[];let o=i===2?["rootfolder-icon"]:i===1?["folder-icon"]:["file-icon"];if(e){let s;if(e.scheme===Ie.data)s=Cm.parseMetaData(e).get(Cm.META_DATA_LABEL);else{let a=e.path.match(Dxe);a?(s=jH(a[2].toLowerCase()),a[1]&&o.push(`${jH(a[1].toLowerCase())}-name-dir-icon`)):s=jH(e.authority.toLowerCase())}if(i===2)o.push(`${s}-root-name-folder-icon`);else if(i===1)o.push(`${s}-name-folder-icon`);else{if(s){if(o.push(`${s}-name-file-icon`),o.push("name-file-icon"),s.length<=255){let l=s.split(".");for(let d=1;d<l.length;d++)o.push(`${l.slice(d).join(".")}-ext-file-icon`)}o.push("ext-file-icon")}let a=kxe(r,t,e);a&&o.push(`${jH(a)}-lang-file-icon`)}}return o}function kxe(r,t,e){if(!e)return null;let i=null;if(e.scheme===Ie.data){let o=Cm.parseMetaData(e).get(Cm.META_DATA_MIME);o&&(i=t.getLanguageIdByMimeType(o))}else{let n=r.getModel(e);n&&(i=n.getLanguageId())}return i&&i!==jn?i:t.guessLanguageIdByFilepathOrFirstLine(e)}function jH(r){return r.replace(/[\s]/g,"/")}function yj(r){return`suggest-aria-id:${r}`}var Lxe=ke("suggest-more-info",N.chevronRight,u("suggestMoreInfoIcon","Icon for more information in the suggest widget.")),Rxe=new class NR{static _regexRelaxed=/(#([\da-fA-F]{3}){1,2}|(rgb|hsl)a\(\s*(\d{1,3}%?\s*,\s*){3}(1|0?\.\d+)\)|(rgb|hsl)\(\s*\d{1,3}%?(\s*,\s*\d{1,3}%?){2}\s*\))/;static _regexStrict=new RegExp(`^${NR._regexRelaxed.source}$`,"i");extract(t,e){if(t.textLabel.match(NR._regexStrict))return e[0]=t.textLabel,!0;if(t.completion.detail&&t.completion.detail.match(NR._regexStrict))return e[0]=t.completion.detail,!0;if(t.completion.documentation){let i=typeof t.completion.documentation=="string"?t.completion.documentation:t.completion.documentation.value,n=NR._regexRelaxed.exec(i);if(n&&(n.index===0||n.index+n[0].length===i.length))return e[0]=n[0],!0}return!1}},cx=class{constructor(t,e,i,n){this._editor=t;this._modelService=e;this._languageService=i;this._themeService=n}_onDidToggleDetails=new x;onDidToggleDetails=this._onDidToggleDetails.event;templateId="suggestion";dispose(){this._onDidToggleDetails.dispose()}renderTemplate(t){let e=new B,i=t;i.classList.add("show-file-icons");let n=U(t,J(".icon")),o=U(n,J("span.colorspan")),s=U(t,J(".contents")),a=U(s,J(".main")),l=U(a,J(".icon-label.codicon")),d=U(a,J("span.left")),c=U(a,J("span.right")),p=new gh(d,{supportHighlights:!0,supportIcons:!0});e.add(p);let h=U(d,J("span.signature-label")),m=U(d,J("span.qualifier-label")),f=U(c,J("span.details-label")),g=U(c,J("span.readMore"+de.asCSSSelector(Lxe)));return g.title=u("readMore","Read More"),{root:i,left:d,right:c,icon:n,colorspan:o,iconLabel:p,iconContainer:l,parametersLabel:h,qualifierLabel:m,detailsLabel:f,readMore:g,disposables:e,configureFont:()=>{let I=this._editor.getOptions(),y=I.get(51),w=y.getMassagedFontFamily(),C=y.fontFeatureSettings,S=I.get(121)||y.fontSize,D=I.get(122)||y.lineHeight,k=y.fontWeight,M=y.letterSpacing,O=`${S}px`,K=`${D}px`,G=`${M}px`;i.style.fontSize=O,i.style.fontWeight=k,i.style.letterSpacing=G,a.style.fontFamily=w,a.style.fontFeatureSettings=C,a.style.lineHeight=K,n.style.height=K,n.style.width=K,g.style.height=K,g.style.width=K}}}renderElement(t,e,i){i.configureFont();let{completion:n}=t;i.root.id=yj(e),i.colorspan.style.backgroundColor="";let o={labelEscapeNewLines:!0,matches:qo(t.score)},s=[];if(n.kind===19&&Rxe.extract(t,s))i.icon.className="icon customcolor",i.iconContainer.className="icon hide",i.colorspan.style.backgroundColor=s[0];else if(n.kind===20&&this._themeService.getFileIconTheme().hasFileIcons){i.icon.className="icon hide",i.iconContainer.className="icon hide";let a=ua(this._modelService,this._languageService,Z.from({scheme:"fake",path:t.textLabel}),0),l=ua(this._modelService,this._languageService,Z.from({scheme:"fake",path:n.detail}),0);o.extraClasses=a.length>l.length?a:l}else n.kind===23&&this._themeService.getFileIconTheme().hasFolderIcons?(i.icon.className="icon hide",i.iconContainer.className="icon hide",o.extraClasses=[ua(this._modelService,this._languageService,Z.from({scheme:"fake",path:t.textLabel}),1),ua(this._modelService,this._languageService,Z.from({scheme:"fake",path:n.detail}),1)].flat()):(i.icon.className="icon hide",i.iconContainer.className="",i.iconContainer.classList.add("suggest-icon",...de.asClassNameArray(xf.toIcon(n.kind))));n.tags&&n.tags.indexOf(1)>=0&&(o.extraClasses=(o.extraClasses||[]).concat(["deprecated"]),o.matches=[]),i.iconLabel.setLabel(t.textLabel,void 0,o),typeof n.label=="string"?(i.parametersLabel.textContent="",i.detailsLabel.textContent=Ij(n.detail||""),i.root.classList.add("string-label")):(i.parametersLabel.textContent=Ij(n.label.detail||""),i.detailsLabel.textContent=Ij(n.label.description||""),i.root.classList.remove("string-label")),this._editor.getOption(120).showInlineDetails?rn(i.detailsLabel):ji(i.detailsLabel),OR(t)?(i.right.classList.add("can-expand-details"),rn(i.readMore),i.readMore.onmousedown=a=>{a.stopPropagation(),a.preventDefault()},i.readMore.onclick=a=>{a.stopPropagation(),a.preventDefault(),this._onDidToggleDetails.fire()}):(i.right.classList.remove("can-expand-details"),ji(i.readMore),i.readMore.onmousedown=null,i.readMore.onclick=null)}disposeTemplate(t){t.disposables.dispose()}};cx=E([b(1,qi),b(2,ti),b(3,Fe)],cx);function Ij(r){return r.replace(/\r\n|\r|\n/g,"")}T("editorSuggestWidget.background",xr,u("editorSuggestWidgetBackground","Background color of the suggest widget."));T("editorSuggestWidget.border",nk,u("editorSuggestWidgetBorder","Border color of the suggest widget."));var Pxe=T("editorSuggestWidget.foreground",Qo,u("editorSuggestWidgetForeground","Foreground color of the suggest widget."));T("editorSuggestWidget.selectedForeground",T0,u("editorSuggestWidgetSelectedForeground","Foreground color of the selected entry in the suggest widget."));T("editorSuggestWidget.selectedIconForeground",_0,u("editorSuggestWidgetSelectedIconForeground","Icon foreground color of the selected entry in the suggest widget."));var Mxe=T("editorSuggestWidget.selectedBackground",D0,u("editorSuggestWidgetSelectedBackground","Background color of the selected entry in the suggest widget."));T("editorSuggestWidget.highlightForeground",AC,u("editorSuggestWidgetHighlightForeground","Color of the match highlights in the suggest widget."));T("editorSuggestWidget.focusHighlightForeground",woe,u("editorSuggestWidgetFocusHighlightForeground","Color of the match highlights in the suggest widget when an item is focused."));T("editorSuggestWidgetStatus.foreground",Ne(Pxe,.5),u("editorSuggestWidgetStatusForeground","Foreground color of the suggest widget status."));var Sj=class{constructor(t,e){this._service=t;this._key=`suggestWidget.size/${e.getEditorType()}/${e instanceof ml}`}_key;restore(){let t=this._service.get(this._key,0)??"";try{let e=JSON.parse(t);if(Ge.is(e))return Ge.lift(e)}catch{}}store(t){this._service.store(this._key,JSON.stringify(t),0,1)}reset(){this._service.remove(this._key,0)}},Hu=class{constructor(t,e,i,n,o){this.editor=t;this._storageService=e;this.element=new Wb,this.element.domNode.classList.add("editor-widget","suggest-widget"),this._contentWidget=new Cj(this,t),this._persistedSize=new Sj(e,t);class s{constructor(m,f,g=!1,v=!1){this.persistedSize=m;this.currentSize=f;this.persistHeight=g;this.persistWidth=v}}let a;this._disposables.add(this.element.onDidWillResize(()=>{this._contentWidget.lockPreference(),a=new s(this._persistedSize.restore(),this.element.size)})),this._disposables.add(this.element.onDidResize(h=>{if(this._resize(h.dimension.width,h.dimension.height),a&&(a.persistHeight=a.persistHeight||!!h.north||!!h.south,a.persistWidth=a.persistWidth||!!h.east||!!h.west),!!h.done){if(a){let{itemHeight:m,defaultSize:f}=this.getLayoutInfo(),g=Math.round(m/2),{width:v,height:I}=this.element.size;(!a.persistHeight||Math.abs(a.currentSize.height-I)<=g)&&(I=a.persistedSize?.height??f.height),(!a.persistWidth||Math.abs(a.currentSize.width-v)<=g)&&(v=a.persistedSize?.width??f.width),this._persistedSize.store(new Ge(v,I))}this._contentWidget.unlockPreference(),a=void 0}})),this._messageElement=U(this.element.domNode,J(".message")),this._listElement=U(this.element.domNode,J(".tree"));let l=this._disposables.add(o.createInstance(dx,this.editor));l.onDidClose(()=>this.toggleDetails(),this,this._disposables),this._details=new $H(l,this.editor);let d=()=>this.element.domNode.classList.toggle("no-icons",!this.editor.getOption(120).showIcons);d();let c=o.createInstance(cx,this.editor);this._disposables.add(c),this._disposables.add(c.onDidToggleDetails(()=>this.toggleDetails())),this._list=new ho("SuggestWidget",this._listElement,{getHeight:h=>this.getLayoutInfo().itemHeight,getTemplateId:h=>"suggestion"},[c],{alwaysConsumeMouseWheel:!0,useShadows:!1,mouseSupport:!1,multipleSelectionSupport:!1,accessibilityProvider:{getRole:()=>"option",getWidgetAriaLabel:()=>u("suggest","Suggest"),getWidgetRole:()=>"listbox",getAriaLabel:h=>{let m=h.textLabel;if(typeof h.completion.label!="string"){let{detail:I,description:y}=h.completion.label;I&&y?m=u("label.full","{0} {1}, {2}",m,I,y):I?m=u("label.detail","{0} {1}",m,I):y&&(m=u("label.desc","{0}, {1}",m,y))}if(!h.isResolved||!this._isDetailsVisible())return m;let{documentation:f,detail:g}=h.completion,v=Sp("{0}{1}",g||"",f?typeof f=="string"?f:f.value:"");return u("ariaCurrenttSuggestionReadDetails","{0}, docs: {1}",m,v)}}}),this._list.style(qI({listInactiveFocusBackground:Mxe,listInactiveFocusOutline:fi})),this._status=o.createInstance(lx,this.element.domNode,Rh);let p=()=>this.element.domNode.classList.toggle("with-status-bar",this.editor.getOption(120).showStatusBar);p(),this._disposables.add(n.onDidColorThemeChange(h=>this._onThemeChange(h))),this._onThemeChange(n.getColorTheme()),this._disposables.add(this._list.onMouseDown(h=>this._onListMouseDownOrTap(h))),this._disposables.add(this._list.onTap(h=>this._onListMouseDownOrTap(h))),this._disposables.add(this._list.onDidChangeSelection(h=>this._onListSelection(h))),this._disposables.add(this._list.onDidChangeFocus(h=>this._onListFocus(h))),this._disposables.add(this.editor.onDidChangeCursorSelection(()=>this._onCursorSelectionChanged())),this._disposables.add(this.editor.onDidChangeConfiguration(h=>{h.hasChanged(120)&&(p(),d()),this._completionModel&&(h.hasChanged(51)||h.hasChanged(121)||h.hasChanged(122))&&this._list.splice(0,this._list.length,this._completionModel.items)})),this._ctxSuggestWidgetVisible=zt.Visible.bindTo(i),this._ctxSuggestWidgetDetailsVisible=zt.DetailsVisible.bindTo(i),this._ctxSuggestWidgetMultipleSuggestions=zt.MultipleSuggestions.bindTo(i),this._ctxSuggestWidgetHasFocusedSuggestion=zt.HasFocusedSuggestion.bindTo(i),this._disposables.add(Ut(this._details.widget.domNode,"keydown",h=>{this._onDetailsKeydown.fire(h)})),this._disposables.add(this.editor.onMouseDown(h=>this._onEditorMouseDown(h)))}static LOADING_MESSAGE=u("suggestWidget.loading","Loading...");static NO_SUGGESTIONS_MESSAGE=u("suggestWidget.noSuggestions","No suggestions.");_state=0;_isAuto=!1;_loadingTimeout;_pendingLayout=new yt;_pendingShowDetails=new yt;_currentSuggestionDetails;_focusedItem;_ignoreFocusEvents=!1;_completionModel;_cappedHeight;_forceRenderingAbove=!1;_explainMode=!1;element;_messageElement;_listElement;_list;_status;_details;_contentWidget;_persistedSize;_ctxSuggestWidgetVisible;_ctxSuggestWidgetDetailsVisible;_ctxSuggestWidgetMultipleSuggestions;_ctxSuggestWidgetHasFocusedSuggestion;_showTimeout=new Qs;_disposables=new B;_onDidSelect=new hd;_onDidFocus=new hd;_onDidHide=new x;_onDidShow=new x;onDidSelect=this._onDidSelect.event;onDidFocus=this._onDidFocus.event;onDidHide=this._onDidHide.event;onDidShow=this._onDidShow.event;_onDetailsKeydown=new x;onDetailsKeyDown=this._onDetailsKeydown.event;dispose(){this._details.widget.dispose(),this._details.dispose(),this._list.dispose(),this._status.dispose(),this._disposables.dispose(),this._loadingTimeout?.dispose(),this._pendingLayout.dispose(),this._pendingShowDetails.dispose(),this._showTimeout.dispose(),this._contentWidget.dispose(),this.element.dispose()}_onEditorMouseDown(t){this._details.widget.domNode.contains(t.target.element)?this._details.widget.domNode.focus():this.element.domNode.contains(t.target.element)&&this.editor.focus()}_onCursorSelectionChanged(){this._state!==0&&this._contentWidget.layout()}_onListMouseDownOrTap(t){typeof t.element>"u"||typeof t.index>"u"||(t.browserEvent.preventDefault(),t.browserEvent.stopPropagation(),this._select(t.element,t.index))}_onListSelection(t){t.elements.length&&this._select(t.elements[0],t.indexes[0])}_select(t,e){let i=this._completionModel;i&&(this._onDidSelect.fire({item:t,index:e,model:i}),this.editor.focus())}_onThemeChange(t){this._details.widget.borderWidth=oa(t.type)?2:1}_onListFocus(t){if(this._ignoreFocusEvents)return;if(this._state===5&&this._setState(3),!t.elements.length){this._currentSuggestionDetails&&(this._currentSuggestionDetails.cancel(),this._currentSuggestionDetails=void 0,this._focusedItem=void 0),this.editor.setAriaOptions({activeDescendant:void 0}),this._ctxSuggestWidgetHasFocusedSuggestion.set(!1);return}if(!this._completionModel)return;this._ctxSuggestWidgetHasFocusedSuggestion.set(!0);let e=t.elements[0],i=t.indexes[0];e!==this._focusedItem&&(this._currentSuggestionDetails?.cancel(),this._currentSuggestionDetails=void 0,this._focusedItem=e,this._list.reveal(i),this._currentSuggestionDetails=va(async n=>{let o=Sd(()=>{this._isDetailsVisible()&&this._showDetails(!0,!1)},250),s=n.onCancellationRequested(()=>o.dispose());try{return await e.resolve(n)}finally{o.dispose(),s.dispose()}}),this._currentSuggestionDetails.then(()=>{i>=this._list.length||e!==this._list.element(i)||(this._ignoreFocusEvents=!0,this._list.splice(i,1,[e]),this._list.setFocus([i]),this._ignoreFocusEvents=!1,this._isDetailsVisible()?this._showDetails(!1,!1):this.element.domNode.classList.remove("docs-side"),this.editor.setAriaOptions({activeDescendant:yj(i)}))}).catch(Xe)),this._onDidFocus.fire({item:e,index:i,model:this._completionModel})}_setState(t){if(this._state!==t)switch(this._state=t,this.element.domNode.classList.toggle("frozen",t===4),this.element.domNode.classList.remove("message"),t){case 0:ji(this._messageElement,this._listElement,this._status.element),this._details.hide(!0),this._status.hide(),this._contentWidget.hide(),this._ctxSuggestWidgetVisible.reset(),this._ctxSuggestWidgetMultipleSuggestions.reset(),this._ctxSuggestWidgetHasFocusedSuggestion.reset(),this._showTimeout.cancel(),this.element.domNode.classList.remove("visible"),this._list.splice(0,this._list.length),this._focusedItem=void 0,this._cappedHeight=void 0,this._explainMode=!1;break;case 1:this.element.domNode.classList.add("message"),this._messageElement.textContent=Hu.LOADING_MESSAGE,ji(this._listElement,this._status.element),rn(this._messageElement),this._details.hide(),this._show(),this._focusedItem=void 0,La(Hu.LOADING_MESSAGE);break;case 2:this.element.domNode.classList.add("message"),this._messageElement.textContent=Hu.NO_SUGGESTIONS_MESSAGE,ji(this._listElement,this._status.element),rn(this._messageElement),this._details.hide(),this._show(),this._focusedItem=void 0,La(Hu.NO_SUGGESTIONS_MESSAGE);break;case 3:ji(this._messageElement),rn(this._listElement,this._status.element),this._show();break;case 4:ji(this._messageElement),rn(this._listElement,this._status.element),this._show();break;case 5:ji(this._messageElement),rn(this._listElement,this._status.element),this._details.show(),this._show(),this._details.widget.focus();break}}_show(){this._status.show(),this._contentWidget.show(),this._layout(this._persistedSize.restore()),this._ctxSuggestWidgetVisible.set(!0),this._showTimeout.cancelAndSet(()=>{this.element.domNode.classList.add("visible"),this._onDidShow.fire(this)},100)}showTriggered(t,e){this._state===0&&(this._contentWidget.setPosition(this.editor.getPosition()),this._isAuto=!!t,this._isAuto||(this._loadingTimeout=Sd(()=>this._setState(1),e)))}showSuggestions(t,e,i,n,o){if(this._contentWidget.setPosition(this.editor.getPosition()),this._loadingTimeout?.dispose(),this._currentSuggestionDetails?.cancel(),this._currentSuggestionDetails=void 0,this._completionModel!==t&&(this._completionModel=t),i&&this._state!==2&&this._state!==0){this._setState(4);return}let s=this._completionModel.items.length,a=s===0;if(this._ctxSuggestWidgetMultipleSuggestions.set(s>1),a){this._setState(n?0:2),this._completionModel=void 0;return}this._focusedItem=void 0,this._onDidFocus.pause(),this._onDidSelect.pause();try{this._list.splice(0,this._list.length,this._completionModel.items),this._setState(i?4:3),this._list.reveal(e,0),this._list.setFocus(o?[]:[e])}finally{this._onDidFocus.resume(),this._onDidSelect.resume()}this._pendingLayout.value=jS(ue(this.element.domNode),()=>{this._pendingLayout.clear(),this._layout(this.element.size),this._details.widget.domNode.classList.remove("focused")})}focusSelected(){this._list.length>0&&this._list.setFocus([0])}selectNextPage(){switch(this._state){case 0:return!1;case 5:return this._details.widget.pageDown(),!0;case 1:return!this._isAuto;default:return this._list.focusNextPage(),!0}}selectNext(){switch(this._state){case 0:return!1;case 1:return!this._isAuto;default:return this._list.focusNext(1,!0),!0}}selectLast(){switch(this._state){case 0:return!1;case 5:return this._details.widget.scrollBottom(),!0;case 1:return!this._isAuto;default:return this._list.focusLast(),!0}}selectPreviousPage(){switch(this._state){case 0:return!1;case 5:return this._details.widget.pageUp(),!0;case 1:return!this._isAuto;default:return this._list.focusPreviousPage(),!0}}selectPrevious(){switch(this._state){case 0:return!1;case 1:return!this._isAuto;default:return this._list.focusPrevious(1,!0),!1}}selectFirst(){switch(this._state){case 0:return!1;case 5:return this._details.widget.scrollTop(),!0;case 1:return!this._isAuto;default:return this._list.focusFirst(),!0}}getFocusedItem(){if(this._state!==0&&this._state!==2&&this._state!==1&&this._completionModel&&this._list.getFocus().length>0)return{item:this._list.getFocusedElements()[0],index:this._list.getFocus()[0],model:this._completionModel}}toggleDetailsFocus(){this._state===5?(this._list.setFocus(this._list.getFocus()),this._setState(3)):this._state===3&&(this._setState(5),this._isDetailsVisible()?this._details.widget.focus():this.toggleDetails(!0))}toggleDetails(t=!1){this._isDetailsVisible()?(this._pendingShowDetails.clear(),this._ctxSuggestWidgetDetailsVisible.set(!1),this._setDetailsVisible(!1),this._details.hide(),this.element.domNode.classList.remove("shows-details")):(OR(this._list.getFocusedElements()[0])||this._explainMode)&&(this._state===3||this._state===5||this._state===4)&&(this._ctxSuggestWidgetDetailsVisible.set(!0),this._setDetailsVisible(!0),this._showDetails(!1,t))}_showDetails(t,e){this._pendingShowDetails.value=jS(ue(this.element.domNode),()=>{this._pendingShowDetails.clear(),this._details.show();let i=!1;t?this._details.widget.renderLoading():this._details.widget.renderItem(this._list.getFocusedElements()[0],this._explainMode),this._details.widget.isEmpty?this._details.hide():(this._positionDetails(),this.element.domNode.classList.add("shows-details"),e&&(this._details.widget.focus(),i=!0)),i||this.editor.focus()})}toggleExplainMode(){this._list.getFocusedElements()[0]&&(this._explainMode=!this._explainMode,this._isDetailsVisible()?this._showDetails(!1,!1):this.toggleDetails())}resetPersistedSize(){this._persistedSize.reset()}hideWidget(){this._pendingLayout.clear(),this._pendingShowDetails.clear(),this._loadingTimeout?.dispose(),this._setState(0),this._onDidHide.fire(this),this.element.clearSashHoverState();let t=this._persistedSize.restore(),e=Math.ceil(this.getLayoutInfo().itemHeight*4.3);t&&t.height<e&&this._persistedSize.store(t.with(void 0,e))}isFrozen(){return this._state===4}_afterRender(t){if(t===null){this._isDetailsVisible()&&this._details.hide();return}this._state===2||this._state===1||(this._isDetailsVisible()&&!this._details.widget.isEmpty&&this._details.show(),this._positionDetails())}_layout(t){if(!this.editor.hasModel()||!this.editor.getDomNode())return;let e=Qa(this.element.domNode.ownerDocument.body),i=this.getLayoutInfo();t||(t=i.defaultSize);let n=t.height,o=t.width;if(this._status.element.style.height=`${i.itemHeight}px`,this._state===2||this._state===1)n=i.itemHeight+i.borderHeight,o=i.defaultSize.width/2,this.element.enableSashes(!1,!1,!1,!1),this.element.minSize=this.element.maxSize=new Ge(o,n),this._contentWidget.setPreference(2);else{let s=e.width-i.borderHeight-2*i.horizontalPadding;o>s&&(o=s);let a=this._completionModel?this._completionModel.stats.pLabelLen*i.typicalHalfwidthCharacterWidth:o,l=i.statusBarHeight+this._list.contentHeight+i.borderHeight,d=i.itemHeight+i.statusBarHeight,c=Oi(this.editor.getDomNode()),p=this.editor.getScrolledVisiblePosition(this.editor.getPosition()),h=c.top+p.top+p.height,m=Math.min(e.height-h-i.verticalPadding,l),f=c.top+p.top-i.verticalPadding,g=Math.min(f,l),v=Math.min(Math.max(g,m)+i.borderHeight,l);n===this._cappedHeight?.capped&&(n=this._cappedHeight.wanted),n<d&&(n=d),n>v&&(n=v),n>m||this._forceRenderingAbove&&f>150?(this._contentWidget.setPreference(1),this.element.enableSashes(!0,!0,!1,!1),v=g):(this._contentWidget.setPreference(2),this.element.enableSashes(!1,!0,!0,!1),v=m),this.element.preferredSize=new Ge(a,i.defaultSize.height),this.element.maxSize=new Ge(s,v),this.element.minSize=new Ge(220,d),this._cappedHeight=n===l?{wanted:this._cappedHeight?.wanted??t.height,capped:n}:void 0}this._resize(o,n)}_resize(t,e){let{width:i,height:n}=this.element.maxSize;t=Math.min(i,t),e=Math.min(n,e);let{statusBarHeight:o}=this.getLayoutInfo();this._list.layout(e-o,t),this._listElement.style.height=`${e-o}px`,this.element.layout(e,t),this._contentWidget.layout(),this._positionDetails()}_positionDetails(){this._isDetailsVisible()&&this._details.placeAtAnchor(this.element.domNode,this._contentWidget.getPosition()?.preference[0]===2)}getLayoutInfo(){let t=this.editor.getOption(51),e=pn(this.editor.getOption(122)||t.lineHeight,8,1e3),i=!this.editor.getOption(120).showStatusBar||this._state===2||this._state===1?0:e,n=this._details.widget.borderWidth,o=2*n;return{itemHeight:e,statusBarHeight:i,borderWidth:n,borderHeight:o,typicalHalfwidthCharacterWidth:t.typicalHalfwidthCharacterWidth,verticalPadding:22,horizontalPadding:14,defaultSize:new Ge(430,i+12*e+o)}}_isDetailsVisible(){return this._storageService.getBoolean("expandSuggestionDocs",0,!1)}_setDetailsVisible(t){this._storageService.store("expandSuggestionDocs",t,0,0)}forceRenderingAbove(){this._forceRenderingAbove||(this._forceRenderingAbove=!0,this._layout(this._persistedSize.restore()))}stopForceRenderingAbove(){this._forceRenderingAbove=!1}};Hu=E([b(1,nt),b(2,re),b(3,Fe),b(4,ne)],Hu);var Cj=class{constructor(t,e){this._widget=t;this._editor=e}allowEditorOverflow=!0;suppressMouseDown=!1;_position;_preference;_preferenceLocked=!1;_added=!1;_hidden=!1;dispose(){this._added&&(this._added=!1,this._editor.removeContentWidget(this))}getId(){return"editor.widget.suggestWidget"}getDomNode(){return this._widget.element.domNode}show(){this._hidden=!1,this._added||(this._added=!0,this._editor.addContentWidget(this))}hide(){this._hidden||(this._hidden=!0,this.layout())}layout(){this._editor.layoutContentWidget(this)}getPosition(){return this._hidden||!this._position||!this._preference?null:{position:this._position,preference:[this._preference]}}beforeRender(){let{height:t,width:e}=this._widget.element.size,{borderWidth:i,horizontalPadding:n}=this._widget.getLayoutInfo();return new Ge(e+2*i+n,t+2*i)}afterRender(t){this._widget._afterRender(t)}setPreference(t){this._preferenceLocked||(this._preference=t)}lockPreference(){this._preferenceLocked=!0}unlockPreference(){this._preferenceLocked=!1}setPosition(t){this._position=t}};var qd=class{constructor(t,e){this._editor=t;this._ckOtherSuggestions=qd.OtherSuggestions.bindTo(e)}static OtherSuggestions=new A("hasOtherSuggestions",!1);_ckOtherSuggestions;_index=0;_model;_acceptNext;_listener;_ignore;dispose(){this.reset()}reset(){this._ckOtherSuggestions.reset(),this._listener?.dispose(),this._model=void 0,this._acceptNext=void 0,this._ignore=!1}set({model:t,index:e},i){if(t.items.length===0){this.reset();return}if(qd._moveIndex(!0,t,e)===e){this.reset();return}this._acceptNext=i,this._model=t,this._index=e,this._listener=this._editor.onDidChangeCursorPosition(()=>{this._ignore||this.reset()}),this._ckOtherSuggestions.set(!0)}static _moveIndex(t,e,i){let n=i;for(let o=e.items.length;o>0&&(n=(n+e.items.length+(t?1:-1))%e.items.length,!(n===i||!e.items[n].completion.additionalTextEdits));o--);return n}next(){this._move(!0)}prev(){this._move(!1)}_move(t){if(this._model)try{this._ignore=!0,this._index=qd._moveIndex(t,this._model,this._index),this._acceptNext({index:this._index,item:this._model.items[this._index],model:this._model})}finally{this._ignore=!1}}};qd=E([b(1,re)],qd);var XH=class{_disposables=new B;_active;constructor(t,e,i,n){this._disposables.add(i.onDidSuggest(o=>{o.completionModel.items.length===0&&this.reset()})),this._disposables.add(i.onDidCancel(o=>{this.reset()})),this._disposables.add(e.onDidShow(()=>this._onItem(e.getFocusedItem()))),this._disposables.add(e.onDidFocus(this._onItem,this)),this._disposables.add(e.onDidHide(this.reset,this)),this._disposables.add(t.onWillType(o=>{if(this._active&&!e.isFrozen()&&i.state!==0){let s=o.charCodeAt(o.length-1);this._active.acceptCharacters.has(s)&&t.getOption(0)&&n(this._active.item)}}))}_onItem(t){if(!t||!pm(t.item.completion.commitCharacters)){this.reset();return}if(this._active&&this._active.item.item===t.item)return;let e=new RO;for(let i of t.item.completion.commitCharacters)i.length>0&&e.add(i.charCodeAt(0));this._active={acceptCharacters:e,item:t}}reset(){this._active=void 0}dispose(){this._disposables.dispose()}};var Oxe=!1,wj=class{constructor(t,e){this._model=t;this._position=e;if(t.getLineMaxColumn(e.lineNumber)!==e.column){let n=t.getOffsetAt(e),o=t.getPositionAt(n+1);t.changeDecorations(s=>{this._marker&&s.removeDecoration(this._marker),this._marker=s.addDecoration(L.fromPositions(e,o),this._decorationOptions)})}}_decorationOptions=Ii.register({description:"suggest-line-suffix",stickiness:1});_marker;dispose(){this._marker&&!this._model.isDisposed()&&this._model.changeDecorations(t=>{t.removeDecoration(this._marker),this._marker=void 0})}delta(t){if(this._model.isDisposed()||this._position.lineNumber!==t.lineNumber)return 0;if(this._marker){let e=this._model.getDecorationRange(this._marker);return this._model.getOffsetAt(e.getStartPosition())-this._model.getOffsetAt(t)}else return this._model.getLineMaxColumn(t.lineNumber)-t.column}};var Ba=class{constructor(t,e,i,n,o,s,a){this._memoryService=e;this._commandService=i;this._contextKeyService=n;this._instantiationService=o;this._logService=s;this._telemetryService=a;this.editor=t,this.model=o.createInstance(Hb,this.editor),this._selectors.register({priority:0,select:(p,h,m)=>this._memoryService.select(p,h,m)});let l=zt.InsertMode.bindTo(n);l.set(t.getOption(120).insertMode),this._toDispose.add(this.model.onDidTrigger(()=>l.set(t.getOption(120).insertMode))),this.widget=this._toDispose.add(new cf(ue(t.getDomNode()),()=>{let p=this._instantiationService.createInstance(Hu,this.editor);this._toDispose.add(p),this._toDispose.add(p.onDidSelect(v=>this._insertSuggestion(v,0),this));let h=new XH(this.editor,p,this.model,v=>this._insertSuggestion(v,2));this._toDispose.add(h);let m=zt.MakesTextEdit.bindTo(this._contextKeyService),f=zt.HasInsertAndReplaceRange.bindTo(this._contextKeyService),g=zt.CanResolve.bindTo(this._contextKeyService);return this._toDispose.add(le(()=>{m.reset(),f.reset(),g.reset()})),this._toDispose.add(p.onDidFocus(({item:v})=>{let I=this.editor.getPosition(),y=v.editStart.column,w=I.column,C=!0;this.editor.getOption(1)==="smart"&&this.model.state===2&&!v.completion.additionalTextEdits&&!(v.completion.insertTextRules&4)&&w-y===v.completion.insertText.length&&(C=this.editor.getModel().getValueInRange({startLineNumber:I.lineNumber,startColumn:y,endLineNumber:I.lineNumber,endColumn:w})!==v.completion.insertText),m.set(C),f.set(!H.equals(v.editInsertEnd,v.editReplaceEnd)),g.set(!!v.provider.resolveCompletionItem||!!v.completion.documentation||v.completion.detail!==v.completion.label)})),this._toDispose.add(p.onDetailsKeyDown(v=>{if(v.toKeyCodeChord().equals(new of(!0,!1,!1,!1,33))||ye&&v.toKeyCodeChord().equals(new of(!1,!1,!1,!0,33))){v.stopPropagation();return}v.toKeyCodeChord().isModifierKey()||this.editor.focus()})),p})),this._overtypingCapturer=this._toDispose.add(new cf(ue(t.getDomNode()),()=>this._toDispose.add(new QH(this.editor,this.model)))),this._alternatives=this._toDispose.add(new cf(ue(t.getDomNode()),()=>this._toDispose.add(new qd(this.editor,this._contextKeyService)))),this._toDispose.add(o.createInstance(fg,t)),this._toDispose.add(this.model.onDidTrigger(p=>{this.widget.value.showTriggered(p.auto,p.shy?250:50),this._lineSuffix.value=new wj(this.editor.getModel(),p.position)})),this._toDispose.add(this.model.onDidSuggest(p=>{if(p.triggerOptions.shy)return;let h=-1;for(let f of this._selectors.itemsOrderedByPriorityDesc)if(h=f.select(this.editor.getModel(),this.editor.getPosition(),p.completionModel.items),h!==-1)break;if(h===-1&&(h=0),this.model.state===0)return;let m=!1;if(p.triggerOptions.auto){let f=this.editor.getOption(120);f.selectionMode==="never"||f.selectionMode==="always"?m=f.selectionMode==="never":f.selectionMode==="whenTriggerCharacter"?m=p.triggerOptions.triggerKind!==1:f.selectionMode==="whenQuickSuggestion"&&(m=p.triggerOptions.triggerKind===1&&!p.triggerOptions.refilter)}this.widget.value.showSuggestions(p.completionModel,h,p.isFrozen,p.triggerOptions.auto,m)})),this._toDispose.add(this.model.onDidCancel(p=>{p.retrigger||this.widget.value.hideWidget()})),this._toDispose.add(this.editor.onDidBlurEditorWidget(()=>{Oxe||(this.model.cancel(),this.model.clear())}));let d=zt.AcceptSuggestionsOnEnter.bindTo(n),c=()=>{let p=this.editor.getOption(1);d.set(p==="on"||p==="smart")};this._toDispose.add(this.editor.onDidChangeConfiguration(()=>c())),c()}static ID="editor.contrib.suggestController";static get(t){return t.getContribution(Ba.ID)}editor;model;widget;_alternatives;_lineSuffix=new yt;_toDispose=new B;_overtypingCapturer;_selectors=new Ej(t=>t.priority);_onWillInsertSuggestItem=new x;onWillInsertSuggestItem=this._onWillInsertSuggestItem.event;dispose(){this._alternatives.dispose(),this._toDispose.dispose(),this.widget.dispose(),this.model.dispose(),this._lineSuffix.dispose(),this._onWillInsertSuggestItem.dispose()}_insertSuggestion(t,e){if(!t||!t.item){this._alternatives.value.reset(),this.model.cancel(),this.model.clear();return}if(!this.editor.hasModel())return;let i=kn.get(this.editor);if(!i)return;this._onWillInsertSuggestItem.fire({item:t.item});let n=this.editor.getModel(),o=n.getAlternativeVersionId(),{item:s}=t,a=[],l=new Kt;e&1||this.editor.pushUndoStop();let d=this.getOverwriteInfo(s,!!(e&8));this._memoryService.memorize(n,this.editor.getPosition(),s);let c=s.isResolved,p=-1,h=-1;if(Array.isArray(s.completion.additionalTextEdits)){this.model.cancel();let f=mg.capture(this.editor);this.editor.executeEdits("suggestController.additionalTextEdits.sync",s.completion.additionalTextEdits.map(g=>{let v=L.lift(g.range);if(v.startLineNumber===s.position.lineNumber&&v.startColumn>s.position.column){let I=this.editor.getPosition().column-s.position.column,y=I,w=L.spansMultipleLines(v)?0:I;v=new L(v.startLineNumber,v.startColumn+y,v.endLineNumber,v.endColumn+w)}return $r.replaceMove(v,g.text)})),f.restoreRelativeVerticalPositionOfCursor(this.editor)}else if(!c){let f=new Ko,g,v=n.onDidChangeContent(C=>{if(C.isFlush){l.cancel(),v.dispose();return}for(let S of C.changes){let D=L.getEndPosition(S.range);(!g||H.isBefore(D,g))&&(g=D)}}),I=e;e|=2;let y=!1,w=this.editor.onWillType(()=>{w.dispose(),y=!0,I&2||this.editor.pushUndoStop()});a.push(s.resolve(l.token).then(()=>{if(!s.completion.additionalTextEdits||l.token.isCancellationRequested)return;if(g&&s.completion.additionalTextEdits.some(S=>H.isBefore(g,L.getStartPosition(S.range))))return!1;y&&this.editor.pushUndoStop();let C=mg.capture(this.editor);return this.editor.executeEdits("suggestController.additionalTextEdits.async",s.completion.additionalTextEdits.map(S=>$r.replaceMove(L.lift(S.range),S.text))),C.restoreRelativeVerticalPositionOfCursor(this.editor),(y||!(I&2))&&this.editor.pushUndoStop(),!0}).then(C=>{this._logService.trace("[suggest] async resolving of edits DONE (ms, applied?)",f.elapsed(),C),h=C===!0?1:C===!1?0:-2}).finally(()=>{v.dispose(),w.dispose()}))}let{insertText:m}=s.completion;if(s.completion.insertTextRules&4||(m=Fa.escape(m)),this.model.cancel(),i.insert(m,{overwriteBefore:d.overwriteBefore,overwriteAfter:d.overwriteAfter,undoStopBefore:!1,undoStopAfter:!1,adjustWhitespace:!(s.completion.insertTextRules&1),clipboardText:t.model.clipboardText,overtypingCapturer:this._overtypingCapturer.value}),e&2||this.editor.pushUndoStop(),s.completion.command)if(s.completion.command.id===YH.id)this.model.trigger({auto:!0,retrigger:!0});else{let f=new Ko;a.push(this._commandService.executeCommand(s.completion.command.id,...s.completion.command.arguments?[...s.completion.command.arguments]:[]).catch(g=>{s.completion.extensionId?zo(g):Xe(g)}).finally(()=>{p=f.elapsed()}))}e&4&&this._alternatives.value.set(t,f=>{for(l.cancel();n.canUndo();){o!==n.getAlternativeVersionId()&&n.undo(),this._insertSuggestion(f,3|(e&8?8:0));break}}),this._alertCompletionItem(s),Promise.all(a).finally(()=>{this._reportSuggestionAcceptedTelemetry(s,n,c,p,h,t.index,t.model.items),this.model.clear(),l.dispose()})}_reportSuggestionAcceptedTelemetry(t,e,i,n,o,s,a){if(Math.floor(Math.random()*100)===0)return;let l=new Map;for(let h=0;h<Math.min(30,a.length);h++){let m=a[h].textLabel;l.has(m)?l.get(m).push(h):l.set(m,[h])}let d=l.get(t.textLabel),p=d&&d.length>1?d[0]:-1;this._telemetryService.publicLog2("suggest.acceptedSuggestion",{extensionId:t.extensionId?.value??"unknown",providerId:t.provider._debugDisplayName??"unknown",kind:t.completion.kind,basenameHash:wr(Ji(e.uri)).toString(16),languageId:e.getLanguageId(),fileExtension:Sm(e.uri),resolveInfo:t.provider.resolveCompletionItem?i?1:0:-1,resolveDuration:t.resolveDuration,commandDuration:n,additionalEditsAsync:o,index:s,firstIndex:p})}getOverwriteInfo(t,e){un(this.editor.hasModel());let i=this.editor.getOption(120).insertMode==="replace";e&&(i=!i);let n=t.position.column-t.editStart.column,o=(i?t.editReplaceEnd.column:t.editInsertEnd.column)-t.position.column,s=this.editor.getPosition().column-t.position.column,a=this._lineSuffix.value?this._lineSuffix.value.delta(this.editor.getPosition()):0;return{overwriteBefore:n+s,overwriteAfter:o+a}}_alertCompletionItem(t){if(pm(t.completion.additionalTextEdits)){let e=u("aria.alert.snippet","Accepting '{0}' made {1} additional edits",t.textLabel,t.completion.additionalTextEdits.length);ka(e)}}triggerSuggest(t,e,i){this.editor.hasModel()&&(this.model.trigger({auto:e??!1,completionOptions:{providerFilter:t,kindFilter:i?new Set:void 0}}),this.editor.revealPosition(this.editor.getPosition(),0),this.editor.focus())}triggerSuggestAndAcceptBest(t){if(!this.editor.hasModel())return;let e=this.editor.getPosition(),i=()=>{e.equals(this.editor.getPosition())&&this._commandService.executeCommand(t.fallback)},n=o=>{if(o.completion.insertTextRules&4||o.completion.additionalTextEdits)return!0;let s=this.editor.getPosition(),a=o.editStart.column,l=s.column;return l-a!==o.completion.insertText.length?!0:this.editor.getModel().getValueInRange({startLineNumber:s.lineNumber,startColumn:a,endLineNumber:s.lineNumber,endColumn:l})!==o.completion.insertText};X.once(this.model.onDidTrigger)(o=>{let s=[];X.any(this.model.onDidTrigger,this.model.onDidCancel)(()=>{_e(s),i()},void 0,s),this.model.onDidSuggest(({completionModel:a})=>{if(_e(s),a.items.length===0){i();return}let l=this._memoryService.select(this.editor.getModel(),this.editor.getPosition(),a.items),d=a.items[l];if(!n(d)){i();return}this.editor.pushUndoStop(),this._insertSuggestion({index:l,item:d,model:a},7)},void 0,s)}),this.model.trigger({auto:!1,shy:!0}),this.editor.revealPosition(e,0),this.editor.focus()}acceptSelectedSuggestion(t,e){let i=this.widget.value.getFocusedItem(),n=0;t&&(n|=4),e&&(n|=8),this._insertSuggestion(i,n)}acceptNextSuggestion(){this._alternatives.value.next()}acceptPrevSuggestion(){this._alternatives.value.prev()}cancelSuggestWidget(){this.model.cancel(),this.model.clear(),this.widget.value.hideWidget()}focusSuggestion(){this.widget.value.focusSelected()}selectNextSuggestion(){this.widget.value.selectNext()}selectNextPageSuggestion(){this.widget.value.selectNextPage()}selectLastSuggestion(){this.widget.value.selectLast()}selectPrevSuggestion(){this.widget.value.selectPrevious()}selectPrevPageSuggestion(){this.widget.value.selectPreviousPage()}selectFirstSuggestion(){this.widget.value.selectFirst()}toggleSuggestionDetails(){this.widget.value.toggleDetails()}toggleExplainMode(){this.widget.value.toggleExplainMode()}toggleSuggestionFocus(){this.widget.value.toggleDetailsFocus()}resetWidgetSize(){this.widget.value.resetPersistedSize()}forceRenderingAbove(){this.widget.value.forceRenderingAbove()}stopForceRenderingAbove(){this.widget.isInitialized&&this.widget.value.stopForceRenderingAbove()}registerSelector(t){return this._selectors.register(t)}};Ba=E([b(1,bj),b(2,ct),b(3,re),b(4,ne),b(5,bt),b(6,Tt)],Ba);var Ej=class{constructor(t){this.prioritySelector=t}_items=new Array;register(t){if(this._items.indexOf(t)!==-1)throw new Error("Value is already registered");return this._items.push(t),this._items.sort((e,i)=>this.prioritySelector(i)-this.prioritySelector(e)),{dispose:()=>{let e=this._items.indexOf(t);e>=0&&this._items.splice(e,1)}}}get itemsOrderedByPriorityDesc(){return this._items}},YH=class r extends mr{static id="editor.action.triggerSuggest";constructor(){super({id:r.id,label:u("suggest.trigger.label","Trigger Suggest"),alias:"Trigger Suggest",precondition:P.and(ce.writable,ce.hasCompletionItemProvider,zt.Visible.toNegated()),kbOpts:{kbExpr:ce.textInputFocus,primary:2058,secondary:[2087],mac:{primary:266,secondary:[521,2087]},weight:100}})}run(t,e,i){let n=Ba.get(e);if(!n)return;let o;i&&typeof i=="object"&&i.auto===!0&&(o=!0),n.triggerSuggest(void 0,o,void 0)}};gr(Ba.ID,Ba,2);Dr(YH);var Jl=190,pa=_r.bindToContribution(Ba.get);qe(new pa({id:"acceptSelectedSuggestion",precondition:P.and(zt.Visible,zt.HasFocusedSuggestion),handler(r){r.acceptSelectedSuggestion(!0,!1)},kbOpts:[{primary:2,kbExpr:P.and(zt.Visible,ce.textInputFocus),weight:Jl},{primary:3,kbExpr:P.and(zt.Visible,ce.textInputFocus,zt.AcceptSuggestionsOnEnter,zt.MakesTextEdit),weight:Jl}],menuOpts:[{menuId:Rh,title:u("accept.insert","Insert"),group:"left",order:1,when:zt.HasInsertAndReplaceRange.toNegated()},{menuId:Rh,title:u("accept.insert","Insert"),group:"left",order:1,when:P.and(zt.HasInsertAndReplaceRange,zt.InsertMode.isEqualTo("insert"))},{menuId:Rh,title:u("accept.replace","Replace"),group:"left",order:1,when:P.and(zt.HasInsertAndReplaceRange,zt.InsertMode.isEqualTo("replace"))}]}));qe(new pa({id:"acceptAlternativeSelectedSuggestion",precondition:P.and(zt.Visible,ce.textInputFocus,zt.HasFocusedSuggestion),kbOpts:{weight:Jl,kbExpr:ce.textInputFocus,primary:1027,secondary:[1026]},handler(r){r.acceptSelectedSuggestion(!1,!0)},menuOpts:[{menuId:Rh,group:"left",order:2,when:P.and(zt.HasInsertAndReplaceRange,zt.InsertMode.isEqualTo("insert")),title:u("accept.replace","Replace")},{menuId:Rh,group:"left",order:2,when:P.and(zt.HasInsertAndReplaceRange,zt.InsertMode.isEqualTo("replace")),title:u("accept.insert","Insert")}]}));tt.registerCommandAlias("acceptSelectedSuggestionOnEnter","acceptSelectedSuggestion");qe(new pa({id:"hideSuggestWidget",precondition:zt.Visible,handler:r=>r.cancelSuggestWidget(),kbOpts:{weight:Jl,kbExpr:ce.textInputFocus,primary:9,secondary:[1033]}}));qe(new pa({id:"selectNextSuggestion",precondition:P.and(zt.Visible,P.or(zt.MultipleSuggestions,zt.HasFocusedSuggestion.negate())),handler:r=>r.selectNextSuggestion(),kbOpts:{weight:Jl,kbExpr:ce.textInputFocus,primary:18,secondary:[2066],mac:{primary:18,secondary:[2066,300]}}}));qe(new pa({id:"selectNextPageSuggestion",precondition:P.and(zt.Visible,P.or(zt.MultipleSuggestions,zt.HasFocusedSuggestion.negate())),handler:r=>r.selectNextPageSuggestion(),kbOpts:{weight:Jl,kbExpr:ce.textInputFocus,primary:12,secondary:[2060]}}));qe(new pa({id:"selectLastSuggestion",precondition:P.and(zt.Visible,P.or(zt.MultipleSuggestions,zt.HasFocusedSuggestion.negate())),handler:r=>r.selectLastSuggestion()}));qe(new pa({id:"selectPrevSuggestion",precondition:P.and(zt.Visible,P.or(zt.MultipleSuggestions,zt.HasFocusedSuggestion.negate())),handler:r=>r.selectPrevSuggestion(),kbOpts:{weight:Jl,kbExpr:ce.textInputFocus,primary:16,secondary:[2064],mac:{primary:16,secondary:[2064,302]}}}));qe(new pa({id:"selectPrevPageSuggestion",precondition:P.and(zt.Visible,P.or(zt.MultipleSuggestions,zt.HasFocusedSuggestion.negate())),handler:r=>r.selectPrevPageSuggestion(),kbOpts:{weight:Jl,kbExpr:ce.textInputFocus,primary:11,secondary:[2059]}}));qe(new pa({id:"selectFirstSuggestion",precondition:P.and(zt.Visible,P.or(zt.MultipleSuggestions,zt.HasFocusedSuggestion.negate())),handler:r=>r.selectFirstSuggestion()}));qe(new pa({id:"focusSuggestion",precondition:P.and(zt.Visible,zt.HasFocusedSuggestion.negate()),handler:r=>r.focusSuggestion(),kbOpts:{weight:Jl,kbExpr:ce.textInputFocus,primary:2058,secondary:[2087],mac:{primary:266,secondary:[2087]}}}));qe(new pa({id:"focusAndAcceptSuggestion",precondition:P.and(zt.Visible,zt.HasFocusedSuggestion.negate()),handler:r=>{r.focusSuggestion(),r.acceptSelectedSuggestion(!0,!1)}}));qe(new pa({id:"toggleSuggestionDetails",precondition:P.and(zt.Visible,zt.HasFocusedSuggestion),handler:r=>r.toggleSuggestionDetails(),kbOpts:{weight:Jl,kbExpr:ce.textInputFocus,primary:2058,secondary:[2087],mac:{primary:266,secondary:[2087]}},menuOpts:[{menuId:Rh,group:"right",order:1,when:P.and(zt.DetailsVisible,zt.CanResolve),title:u("detail.more","Show Less")},{menuId:Rh,group:"right",order:1,when:P.and(zt.DetailsVisible.toNegated(),zt.CanResolve),title:u("detail.less","Show More")}]}));qe(new pa({id:"toggleExplainMode",precondition:zt.Visible,handler:r=>r.toggleExplainMode(),kbOpts:{weight:100,primary:2138}}));qe(new pa({id:"toggleSuggestionFocus",precondition:zt.Visible,handler:r=>r.toggleSuggestionFocus(),kbOpts:{weight:Jl,kbExpr:ce.textInputFocus,primary:2570,mac:{primary:778}}}));qe(new pa({id:"insertBestCompletion",precondition:P.and(ce.textInputFocus,P.equals("config.editor.tabCompletion","on"),fg.AtEnd,zt.Visible.toNegated(),qd.OtherSuggestions.toNegated(),kn.InSnippetMode.toNegated()),handler:(r,t)=>{r.triggerSuggestAndAcceptBest(vi(t)?{fallback:"tab",...t}:{fallback:"tab"})},kbOpts:{weight:Jl,primary:2}}));qe(new pa({id:"insertNextSuggestion",precondition:P.and(ce.textInputFocus,P.equals("config.editor.tabCompletion","on"),qd.OtherSuggestions,zt.Visible.toNegated(),kn.InSnippetMode.toNegated()),handler:r=>r.acceptNextSuggestion(),kbOpts:{weight:Jl,kbExpr:ce.textInputFocus,primary:2}}));qe(new pa({id:"insertPrevSuggestion",precondition:P.and(ce.textInputFocus,P.equals("config.editor.tabCompletion","on"),qd.OtherSuggestions,zt.Visible.toNegated(),kn.InSnippetMode.toNegated()),handler:r=>r.acceptPrevSuggestion(),kbOpts:{weight:Jl,kbExpr:ce.textInputFocus,primary:1026}}));Dr(class extends mr{constructor(){super({id:"editor.action.resetSuggestSize",label:u("suggest.reset.label","Reset Suggest Widget Size"),alias:"Reset Suggest Widget Size",precondition:void 0})}run(r,t){Ba.get(t)?.resetWidgetSize()}});var ZH=class extends R{constructor(e,i,n,o,s,a,l,d,c,p,h,m){super();this.textModel=e;this.selectedSuggestItem=i;this._textModelVersionId=n;this._positions=o;this._debounceValue=s;this._suggestPreviewEnabled=a;this._suggestPreviewMode=l;this._inlineSuggestMode=d;this._enabled=c;this._instantiationService=p;this._commandService=h;this._languageConfigurationService=m;this._register($g(this._fetchInlineCompletionsPromise));let f;this._register(Ft(g=>{let I=this.state.read(g)?.inlineCompletion;if(I?.semanticId!==f?.semanticId&&(f=I,I)){let y=I.inlineCompletion,w=y.source;w.provider.handleItemDidShow?.(w.inlineCompletions,y.sourceInlineCompletion,y.insertText)}}))}_source=this._register(this._instantiationService.createInstance(ax,this.textModel,this._textModelVersionId,this._debounceValue));_isActive=Ht(this,!1);_forceUpdateExplicitlySignal=Ip(this);_selectedInlineCompletionId=Ht(this,void 0);_primaryPosition=dt(this,e=>this._positions.read(e)[0]??new H(1,1));_isAcceptingPartially=!1;get isAcceptingPartially(){return this._isAcceptingPartially}_preserveCurrentCompletionReasons=new Set([1,0,2]);_getReason(e){return e?.isUndoing?0:e?.isRedoing?1:this.isAcceptingPartially?2:3}_fetchInlineCompletionsPromise=r4({owner:this,createEmptyChangeSummary:()=>({preserveCurrentCompletion:!1,inlineCompletionTriggerKind:0}),handleChange:(e,i)=>(e.didChange(this._textModelVersionId)&&this._preserveCurrentCompletionReasons.has(this._getReason(e.change))?i.preserveCurrentCompletion=!0:e.didChange(this._forceUpdateExplicitlySignal)&&(i.inlineCompletionTriggerKind=1),!0)},(e,i)=>{if(this._forceUpdateExplicitlySignal.read(e),!(this._enabled.read(e)&&this.selectedSuggestItem.read(e)||this._isActive.read(e))){this._source.cancelUpdate();return}this._textModelVersionId.read(e);let o=this._source.suggestWidgetInlineCompletions.get(),s=this.selectedSuggestItem.read(e);if(o&&!s){let p=this._source.inlineCompletions.get();nn(h=>{(!p||o.request.versionId>p.request.versionId)&&this._source.inlineCompletions.set(o.clone(),h),this._source.clearSuggestWidgetInlineCompletions(h)})}let a=this._primaryPosition.read(e),l={triggerKind:i.inlineCompletionTriggerKind,selectedSuggestionInfo:s?.toSelectedSuggestionInfo()},d=this.selectedInlineCompletion.get(),c=i.preserveCurrentCompletion||d?.forwardStable?d:void 0;return this._source.fetch(a,l,c)});async trigger(e){this._isActive.set(!0,e),await this._fetchInlineCompletionsPromise.get()}async triggerExplicitly(e){yp(e,i=>{this._isActive.set(!0,i),this._forceUpdateExplicitlySignal.trigger(i)}),await this._fetchInlineCompletionsPromise.get()}stop(e){yp(e,i=>{this._isActive.set(!1,i),this._source.clear(i)})}_filteredInlineCompletionItems=Os({owner:this,equalsFn:TS()},e=>{let i=this._source.inlineCompletions.read(e);if(!i)return[];let n=this._primaryPosition.read(e);return i.inlineCompletions.filter(s=>s.isVisible(this.textModel,n,e))});selectedInlineCompletionIndex=dt(this,e=>{let i=this._selectedInlineCompletionId.read(e),n=this._filteredInlineCompletionItems.read(e),o=this._selectedInlineCompletionId===void 0?-1:n.findIndex(s=>s.semanticId===i);return o===-1?(this._selectedInlineCompletionId.set(void 0,void 0),0):o});selectedInlineCompletion=dt(this,e=>{let i=this._filteredInlineCompletionItems.read(e),n=this.selectedInlineCompletionIndex.read(e);return i[n]});activeCommands=Os({owner:this,equalsFn:TS()},e=>this.selectedInlineCompletion.read(e)?.inlineCompletion.source.inlineCompletions.commands??[]);lastTriggerKind=this._source.inlineCompletions.map(this,e=>e?.request.context.triggerKind);inlineCompletionsCount=dt(this,e=>{if(this.lastTriggerKind.read(e)===1)return this._filteredInlineCompletionItems.read(e).length});state=Os({owner:this,equalsFn:(e,i)=>!e||!i?e===i:nj(e.ghostTexts,i.ghostTexts)&&e.inlineCompletion===i.inlineCompletion&&e.suggestItem===i.suggestItem},e=>{let i=this.textModel,n=this.selectedSuggestItem.read(e);if(n){let o=Vb(n.toSingleTextEdit(),i),s=this._computeAugmentation(o,e);if(!this._suggestPreviewEnabled.read(e)&&!s)return;let l=s?.edit??o,d=s?s.edit.text.length-o.text.length:0,c=this._suggestPreviewMode.read(e),p=this._positions.read(e),h=[l,...xj(this.textModel,p,l)],m=h.map((g,v)=>cj(g,i,c,p[v],d)).filter(go),f=m[0]??new Bb(l.range.endLineNumber,[]);return{edits:h,primaryGhostText:f,ghostTexts:m,inlineCompletion:s?.completion,suggestItem:n}}else{if(!this._isActive.read(e))return;let o=this.selectedInlineCompletion.read(e);if(!o)return;let s=o.toSingleTextEdit(e),a=this._inlineSuggestMode.read(e),l=this._positions.read(e),d=[s,...xj(this.textModel,l,s)],c=d.map((p,h)=>cj(p,i,a,l[h],0)).filter(go);return c[0]?{edits:d,primaryGhostText:c[0],ghostTexts:c,inlineCompletion:o,suggestItem:void 0}:void 0}});_computeAugmentation(e,i){let n=this.textModel,o=this._source.suggestWidgetInlineCompletions.read(i),s=o?o.inlineCompletions:[this.selectedInlineCompletion.read(i)].filter(go);return vJ(s,l=>{let d=l.toSingleTextEdit(i);return d=Vb(d,n,L.fromPositions(d.range.getStartPosition(),e.range.getEndPosition())),dj(d,e)?{completion:l,edit:d}:void 0})}ghostTexts=Os({owner:this,equalsFn:nj},e=>{let i=this.state.read(e);if(i)return i.ghostTexts});primaryGhostText=Os({owner:this,equalsFn:oj},e=>{let i=this.state.read(e);if(i)return i?.primaryGhostText});async _deltaSelectedInlineCompletionIndex(e){await this.triggerExplicitly();let i=this._filteredInlineCompletionItems.get()||[];if(i.length>0){let n=(this.selectedInlineCompletionIndex.get()+e+i.length)%i.length;this._selectedInlineCompletionId.set(i[n].semanticId,void 0)}else this._selectedInlineCompletionId.set(void 0,void 0)}async next(){await this._deltaSelectedInlineCompletionIndex(1)}async previous(){await this._deltaSelectedInlineCompletionIndex(-1)}async accept(e){if(e.getModel()!==this.textModel)throw new _t;let i=this.state.get();if(!i||i.primaryGhostText.isEmpty()||!i.inlineCompletion)return;let n=i.inlineCompletion.toInlineCompletion(void 0);if(n.command&&n.source.addRef(),e.pushUndoStop(),n.snippetInfo)e.executeEdits("inlineSuggestion.accept",[$r.replace(n.range,""),...n.additionalTextEdits]),e.setPosition(n.snippetInfo.range.getStartPosition(),"inlineCompletionAccept"),kn.get(e)?.insert(n.snippetInfo.snippet,{undoStopBefore:!1});else{let o=i.edits,s=cue(o).map(a=>Et.fromPositions(a));e.executeEdits("inlineSuggestion.accept",[...o.map(a=>$r.replace(a.range,a.text)),...n.additionalTextEdits]),e.setSelections(s,"inlineCompletionAccept")}this.stop(),n.command&&(await this._commandService.executeCommand(n.command.id,...n.command.arguments||[]).then(void 0,zo),n.source.removeRef())}async acceptNextWord(e){await this._acceptNext(e,(i,n)=>{let o=this.textModel.getLanguageIdAtPosition(i.lineNumber,i.column),s=this._languageConfigurationService.getLanguageConfiguration(o),a=new RegExp(s.wordDefinition.source,s.wordDefinition.flags.replace("g","")),l=n.match(a),d=0;l&&l.index!==void 0?l.index===0?d=l[0].length:d=l.index:d=n.length;let p=/\s+/g.exec(n);return p&&p.index!==void 0&&p.index+p[0].length<d&&(d=p.index+p[0].length),d},0)}async acceptNextLine(e){await this._acceptNext(e,(i,n)=>{let o=n.match(/\n/);return o&&o.index!==void 0?o.index+1:n.length},1)}async _acceptNext(e,i,n){if(e.getModel()!==this.textModel)throw new _t;let o=this.state.get();if(!o||o.primaryGhostText.isEmpty()||!o.inlineCompletion)return;let s=o.primaryGhostText,a=o.inlineCompletion.toInlineCompletion(void 0);if(a.snippetInfo||a.filterText!==a.insertText){await this.accept(e);return}let l=s.parts[0],d=new H(s.lineNumber,l.column),c=l.text,p=i(d,c);if(p===c.length&&s.parts.length===1){this.accept(e);return}let h=c.substring(0,p),m=this._positions.get(),f=m[0];a.source.addRef();try{this._isAcceptingPartially=!0;try{e.pushUndoStop();let g=L.fromPositions(f,d),v=e.getModel().getValueInRange(g)+h,I=new _o(g,v),y=[I,...xj(this.textModel,m,I)],w=cue(y).map(C=>Et.fromPositions(C));e.executeEdits("inlineSuggestion.accept",y.map(C=>$r.replace(C.range,C.text))),e.setSelections(w,"inlineCompletionPartialAccept"),e.revealPositionInCenterIfOutsideViewport(e.getPosition(),1)}finally{this._isAcceptingPartially=!1}if(a.source.provider.handlePartialAccept){let g=L.fromPositions(a.range.getStartPosition(),pr.ofText(h).addToPosition(d)),v=e.getModel().getValueInRange(g,1);a.source.provider.handlePartialAccept(a.source.inlineCompletions,a.sourceInlineCompletion,v.length,{kind:n})}}finally{a.source.removeRef()}}handleSuggestAccepted(e){let i=Vb(e.toSingleTextEdit(),this.textModel),n=this._computeAugmentation(i,void 0);if(!n)return;let o=n.completion.inlineCompletion;o.source.provider.handlePartialAccept?.(o.source.inlineCompletions,o.sourceInlineCompletion,i.text.length,{kind:2})}};ZH=E([b(9,ne),b(10,ct),b(11,Do)],ZH);function xj(r,t,e){if(t.length===1)return[];let i=t[0],n=t.slice(1),o=e.range.getStartPosition(),s=e.range.getEndPosition(),a=r.getValueInRange(L.fromPositions(i,s)),l=ij(i,o);if(l.lineNumber<1)return Xe(new _t(`positionWithinTextEdit line number should be bigger than 0.
			Invalid subtraction between ${i.toString()} and ${o.toString()}`)),[];let d=Nxe(e.text,l);return n.map(c=>{let p=tue(ij(c,o),s),h=r.getValueInRange(L.fromPositions(c,p)),m=bd(a,h),f=L.fromPositions(c,c.delta(0,m));return new _o(f,d)})}function Nxe(r,t){let e="",i=mee(r);for(let n=t.lineNumber-1;n<i.length;n++)e+=i[n].substring(n===t.lineNumber-1?t.column-1:0);return e}function cue(r){let t=VM.createSortPermutation(r,Sr(o=>o.range,L.compareRangesUsingStarts)),i=new lu(t.apply(r)).getNewRanges();return t.inverse().apply(i).map(o=>o.getEndPosition())}var ux=class r extends R{constructor(e,i){super();this.contextKeyService=e;this.model=i;this._register(Ft(n=>{let s=this.model.read(n)?.state.read(n),a=!!s?.inlineCompletion&&s?.primaryGhostText!==void 0&&!s?.primaryGhostText.isEmpty();this.inlineCompletionVisible.set(a),s?.primaryGhostText&&s?.inlineCompletion&&this.suppressSuggestions.set(s.inlineCompletion.inlineCompletion.source.inlineCompletions.suppressSuggestions)})),this._register(Ft(n=>{let o=this.model.read(n),s=!1,a=!0,l=o?.primaryGhostText.read(n);if(o?.selectedSuggestItem&&l&&l.parts.length>0){let{column:d,lines:c}=l.parts[0],p=c[0],h=o.textModel.getLineIndentColumn(l.lineNumber);if(d<=h){let f=Jn(p);f===-1&&(f=p.length-1),s=f>0;let g=o.textModel.getOptions().tabSize;a=tn.visibleColumnFromColumn(p,f+1,g)<g}}this.inlineCompletionSuggestsIndentation.set(s),this.inlineCompletionSuggestsIndentationLessThanTabSize.set(a)}))}static inlineSuggestionVisible=new A("inlineSuggestionVisible",!1,u("inlineSuggestionVisible","Whether an inline suggestion is visible"));static inlineSuggestionHasIndentation=new A("inlineSuggestionHasIndentation",!1,u("inlineSuggestionHasIndentation","Whether the inline suggestion starts with whitespace"));static inlineSuggestionHasIndentationLessThanTabSize=new A("inlineSuggestionHasIndentationLessThanTabSize",!0,u("inlineSuggestionHasIndentationLessThanTabSize","Whether the inline suggestion starts with whitespace that is less than what would be inserted by tab"));static suppressSuggestions=new A("inlineSuggestionSuppressSuggestions",void 0,u("suppressSuggestions","Whether suggestions should be suppressed for the current suggestion"));inlineCompletionVisible=r.inlineSuggestionVisible.bindTo(this.contextKeyService);inlineCompletionSuggestsIndentation=r.inlineSuggestionHasIndentation.bindTo(this.contextKeyService);inlineCompletionSuggestsIndentationLessThanTabSize=r.inlineSuggestionHasIndentationLessThanTabSize.bindTo(this.contextKeyService);suppressSuggestions=r.suppressSuggestions.bindTo(this.contextKeyService)};var bg=class{static shouldAutoTrigger(t){if(!t.hasModel())return!1;let e=t.getModel(),i=t.getPosition();e.tokenization.tokenizeIfCheap(i.lineNumber);let n=e.getWordAtPosition(i);return!(!n||n.endColumn!==i.column&&n.startColumn+1!==i.column||!isNaN(Number(n.word)))}lineNumber;column;leadingLineContent;leadingWord;triggerOptions;constructor(t,e,i){this.leadingLineContent=t.getLineContent(e.lineNumber).substr(0,e.column-1),this.leadingWord=t.getWordUntilPosition(e),this.lineNumber=e.lineNumber,this.column=e.column,this.triggerOptions=i}};function Fxe(r,t,e){if(!t.getContextKeyValue(ux.inlineSuggestionVisible.key))return!0;let i=t.getContextKeyValue(ux.suppressSuggestions.key);return i!==void 0?!i:!r.getOption(63).suppressSuggestions}function Bxe(r,t,e){if(!t.getContextKeyValue("inlineSuggestionVisible"))return!0;let i=t.getContextKeyValue(ux.suppressSuggestions.key);return i!==void 0?!i:!r.getOption(63).suppressSuggestions}var Hb=class{constructor(t,e,i,n,o,s,a,l,d){this._editor=t;this._editorWorkerService=e;this._clipboardService=i;this._telemetryService=n;this._logService=o;this._contextKeyService=s;this._configurationService=a;this._languageFeaturesService=l;this._envService=d;this._currentSelection=this._editor.getSelection()||new Et(1,1,1,1),this._toDispose.add(this._editor.onDidChangeModel(()=>{this._updateTriggerCharacters(),this.cancel()})),this._toDispose.add(this._editor.onDidChangeModelLanguage(()=>{this._updateTriggerCharacters(),this.cancel()})),this._toDispose.add(this._editor.onDidChangeConfiguration(()=>{this._updateTriggerCharacters()})),this._toDispose.add(this._languageFeaturesService.completionProvider.onDidChange(()=>{this._updateTriggerCharacters(),this._updateActiveSuggestSession()}));let c=!1;this._toDispose.add(this._editor.onDidCompositionStart(()=>{c=!0})),this._toDispose.add(this._editor.onDidCompositionEnd(()=>{c=!1,this._onCompositionEnd()})),this._toDispose.add(this._editor.onDidChangeCursorSelection(p=>{c||this._onCursorChange(p)})),this._toDispose.add(this._editor.onDidChangeModelContent(()=>{!c&&this._triggerState!==void 0&&this._refilterCompletionItems()})),this._updateTriggerCharacters()}_toDispose=new B;_triggerCharacterListener=new B;_triggerQuickSuggest=new Qs;_triggerState=void 0;_requestToken;_context;_currentSelection;_completionModel;_completionDisposables=new B;_onDidCancel=new x;_onDidTrigger=new x;_onDidSuggest=new x;onDidCancel=this._onDidCancel.event;onDidTrigger=this._onDidTrigger.event;onDidSuggest=this._onDidSuggest.event;dispose(){_e(this._triggerCharacterListener),_e([this._onDidCancel,this._onDidSuggest,this._onDidTrigger,this._triggerQuickSuggest]),this._toDispose.dispose(),this._completionDisposables.dispose(),this.cancel()}_updateTriggerCharacters(){if(this._triggerCharacterListener.clear(),this._editor.getOption(93)||!this._editor.hasModel()||!this._editor.getOption(123))return;let t=new Map;for(let i of this._languageFeaturesService.completionProvider.all(this._editor.getModel()))for(let n of i.triggerCharacters||[]){let o=t.get(n);if(!o){o=new Set;let s=Qce();s&&o.add(s),t.set(n,o)}o.add(i)}let e=i=>{if(!Bxe(this._editor,this._contextKeyService,this._configurationService)||bg.shouldAutoTrigger(this._editor))return;if(!i){let s=this._editor.getPosition();i=this._editor.getModel().getLineContent(s.lineNumber).substr(0,s.column-1)}let n="";xp(i.charCodeAt(i.length-1))?Rn(i.charCodeAt(i.length-2))&&(n=i.substr(i.length-2)):n=i.charAt(i.length-1);let o=t.get(n);if(o){let s=new Map;if(this._completionModel)for(let[a,l]of this._completionModel.getItemsByProvider())o.has(a)||s.set(a,l);this.trigger({auto:!0,triggerKind:1,triggerCharacter:n,retrigger:!!this._completionModel,clipboardText:this._completionModel?.clipboardText,completionOptions:{providerFilter:o,providerItemsToReuse:s}})}};this._triggerCharacterListener.add(this._editor.onDidType(e)),this._triggerCharacterListener.add(this._editor.onDidCompositionEnd(()=>e()))}get state(){return this._triggerState?this._triggerState.auto?2:1:0}cancel(t=!1){this._triggerState!==void 0&&(this._triggerQuickSuggest.cancel(),this._requestToken?.cancel(),this._requestToken=void 0,this._triggerState=void 0,this._completionModel=void 0,this._context=void 0,this._onDidCancel.fire({retrigger:t}))}clear(){this._completionDisposables.clear()}_updateActiveSuggestSession(){this._triggerState!==void 0&&(!this._editor.hasModel()||!this._languageFeaturesService.completionProvider.has(this._editor.getModel())?this.cancel():this.trigger({auto:this._triggerState.auto,retrigger:!0}))}_onCursorChange(t){if(!this._editor.hasModel())return;let e=this._currentSelection;if(this._currentSelection=this._editor.getSelection(),!t.selection.isEmpty()||t.reason!==0&&t.reason!==3||t.source!=="keyboard"&&t.source!=="deleteLeft"){this.cancel();return}this._triggerState===void 0&&t.reason===0?(e.containsRange(this._currentSelection)||e.getEndPosition().isBeforeOrEqual(this._currentSelection.getPosition()))&&this._doTriggerQuickSuggest():this._triggerState!==void 0&&t.reason===3&&this._refilterCompletionItems()}_onCompositionEnd(){this._triggerState===void 0?this._doTriggerQuickSuggest():this._refilterCompletionItems()}_doTriggerQuickSuggest(){Oy.isAllOff(this._editor.getOption(91))||this._editor.getOption(120).snippetsPreventQuickSuggestions&&kn.get(this._editor)?.isInSnippet()||(this.cancel(),this._triggerQuickSuggest.cancelAndSet(()=>{if(this._triggerState!==void 0||!bg.shouldAutoTrigger(this._editor)||!this._editor.hasModel()||!this._editor.hasWidgetFocus())return;let t=this._editor.getModel(),e=this._editor.getPosition(),i=this._editor.getOption(91);if(!Oy.isAllOff(i)){if(!Oy.isAllOn(i)){t.tokenization.tokenizeIfCheap(e.lineNumber);let n=t.tokenization.getLineTokens(e.lineNumber),o=n.getStandardTokenType(n.findTokenIndexAtOffset(Math.max(e.column-1-1,0)));if(Oy.valueFor(i,o)!=="on")return}Fxe(this._editor,this._contextKeyService,this._configurationService)&&this._languageFeaturesService.completionProvider.has(t)&&this.trigger({auto:!0})}},this._editor.getOption(92)))}_refilterCompletionItems(){un(this._editor.hasModel()),un(this._triggerState!==void 0);let t=this._editor.getModel(),e=this._editor.getPosition(),i=new bg(t,e,{...this._triggerState,refilter:!0});this._onNewContext(i)}trigger(t){if(!this._editor.hasModel())return;let e=this._editor.getModel(),i=new bg(e,this._editor.getPosition(),t);this.cancel(t.retrigger),this._triggerState=t,this._onDidTrigger.fire({auto:t.auto,shy:t.shy??!1,position:this._editor.getPosition()}),this._context=i;let n={triggerKind:t.triggerKind??0};t.triggerCharacter&&(n={triggerKind:1,triggerCharacter:t.triggerCharacter}),this._requestToken=new Kt;let o=this._editor.getOption(114),s=1;switch(o){case"top":s=0;break;case"bottom":s=2;break}let{itemKind:a,showDeprecated:l}=Hb.createSuggestFilter(this._editor),d=new Ay(s,t.completionOptions?.kindFilter??a,t.completionOptions?.providerFilter,t.completionOptions?.providerItemsToReuse,l),c=WH.create(this._editorWorkerService,this._editor),p=xR(this._languageFeaturesService.completionProvider,e,this._editor.getPosition(),d,n,this._requestToken.token);Promise.all([p,c]).then(async([h,m])=>{if(this._requestToken?.dispose(),!this._editor.hasModel())return;let f=t?.clipboardText;if(!f&&h.needsClipboard&&(f=await this._clipboardService.readText()),this._triggerState===void 0)return;let g=this._editor.getModel(),v=new bg(g,this._editor.getPosition(),t),I={...iI.default,firstMatchCanBeWeak:!this._editor.getOption(120).matchOnWordStartOnly};if(this._completionModel=new HH(h.items,this._context.column,{leadingLineContent:v.leadingLineContent,characterCountDelta:v.column-this._context.column},m,this._editor.getOption(120),this._editor.getOption(114),I,f),this._completionDisposables.add(h.disposable),this._onNewContext(v),this._reportDurationsTelemetry(h.durations),!this._envService.isBuilt||this._envService.isExtensionDevelopment)for(let y of h.items)y.isInvalid&&this._logService.warn(`[suggest] did IGNORE invalid completion item from ${y.provider._debugDisplayName}`,y.completion)}).catch(Xe)}_telemetryGate=0;_reportDurationsTelemetry(t){this._telemetryGate++%230===0&&setTimeout(()=>{this._telemetryService.publicLog2("suggest.durations.json",{data:JSON.stringify(t)}),this._logService.debug("suggest.durations.json",t)})}static createSuggestFilter(t){let e=new Set;t.getOption(114)==="none"&&e.add(27);let n=t.getOption(120);return n.showMethods||e.add(0),n.showFunctions||e.add(1),n.showConstructors||e.add(2),n.showFields||e.add(3),n.showVariables||e.add(4),n.showClasses||e.add(5),n.showStructs||e.add(6),n.showInterfaces||e.add(7),n.showModules||e.add(8),n.showProperties||e.add(9),n.showEvents||e.add(10),n.showOperators||e.add(11),n.showUnits||e.add(12),n.showValues||e.add(13),n.showConstants||e.add(14),n.showEnums||e.add(15),n.showEnumMembers||e.add(16),n.showKeywords||e.add(17),n.showWords||e.add(18),n.showColors||e.add(19),n.showFiles||e.add(20),n.showReferences||e.add(21),n.showColors||e.add(22),n.showFolders||e.add(23),n.showTypeParameters||e.add(24),n.showSnippets||e.add(27),n.showUsers||e.add(25),n.showIssues||e.add(26),{itemKind:e,showDeprecated:n.showDeprecated}}_onNewContext(t){if(this._context){if(t.lineNumber!==this._context.lineNumber){this.cancel();return}if(yn(t.leadingLineContent)!==yn(this._context.leadingLineContent)){this.cancel();return}if(t.column<this._context.column){t.leadingWord.word?this.trigger({auto:this._context.triggerOptions.auto,retrigger:!0}):this.cancel();return}if(this._completionModel){if(t.leadingWord.word.length!==0&&t.leadingWord.startColumn>this._context.leadingWord.startColumn){if(bg.shouldAutoTrigger(this._editor)&&this._context){let i=this._completionModel.getItemsByProvider();this.trigger({auto:this._context.triggerOptions.auto,retrigger:!0,clipboardText:this._completionModel.clipboardText,completionOptions:{providerItemsToReuse:i}})}return}if(t.column>this._context.column&&this._completionModel.getIncompleteProvider().size>0&&t.leadingWord.word.length!==0){let e=new Map,i=new Set;for(let[n,o]of this._completionModel.getItemsByProvider())o.length>0&&o[0].container.incomplete?i.add(n):e.set(n,o);this.trigger({auto:this._context.triggerOptions.auto,triggerKind:2,retrigger:!0,clipboardText:this._completionModel.clipboardText,completionOptions:{providerFilter:i,providerItemsToReuse:e}})}else{let e=this._completionModel.lineContext,i=!1;if(this._completionModel.lineContext={leadingLineContent:t.leadingLineContent,characterCountDelta:t.column-this._context.column},this._completionModel.items.length===0){let n=bg.shouldAutoTrigger(this._editor);if(!this._context){this.cancel();return}if(n&&this._context.leadingWord.endColumn<t.leadingWord.startColumn){this.trigger({auto:this._context.triggerOptions.auto,retrigger:!0});return}if(this._context.triggerOptions.auto){this.cancel();return}else if(this._completionModel.lineContext=e,i=this._completionModel.items.length>0,i&&t.leadingWord.word.length===0){this.cancel();return}}this._onDidSuggest.fire({completionModel:this._completionModel,triggerOptions:t.triggerOptions,isFrozen:i})}}}}};Hb=E([b(1,hg),b(2,rs),b(3,Tt),b(4,bt),b(5,re),b(6,se),b(7,ni),b(8,$o)],Hb);var QH=class r{static _maxSelectionLength=51200;_disposables=new B;_lastOvertyped=[];_locked=!1;constructor(t,e){this._disposables.add(t.onWillType(()=>{if(this._locked||!t.hasModel())return;let i=t.getSelections(),n=i.length,o=!1;for(let a=0;a<n;a++)if(!i[a].isEmpty()){o=!0;break}if(!o){this._lastOvertyped.length!==0&&(this._lastOvertyped.length=0);return}this._lastOvertyped=[];let s=t.getModel();for(let a=0;a<n;a++){let l=i[a];if(s.getValueLengthInRange(l)>r._maxSelectionLength)return;this._lastOvertyped[a]={value:s.getValueInRange(l),multiline:l.startLineNumber!==l.endLineNumber}}})),this._disposables.add(e.onDidTrigger(i=>{this._locked=!0})),this._disposables.add(e.onDidCancel(i=>{this._locked=!1}))}getLastOvertypedInfo(t){if(t>=0&&t<this._lastOvertyped.length)return this._lastOvertyped[t]}dispose(){this._disposables.dispose()}};var JH={overwriteBefore:0,overwriteAfter:0,undoStopBefore:!0,undoStopAfter:!0,adjustWhitespace:!0,clipboardText:void 0,overtypingCapturer:void 0},kn=class{constructor(t,e,i,n,o){this._editor=t;this._logService=e;this._languageFeaturesService=i;this._languageConfigurationService=o;this._inSnippet=kn.InSnippetMode.bindTo(n),this._hasNextTabstop=kn.HasNextTabstop.bindTo(n),this._hasPrevTabstop=kn.HasPrevTabstop.bindTo(n)}static ID="snippetController2";static get(t){return t.getContribution(kn.ID)}static InSnippetMode=new A("inSnippetMode",!1,u("inSnippetMode","Whether the editor in current in snippet mode"));static HasNextTabstop=new A("hasNextTabstop",!1,u("hasNextTabstop","Whether there is a next tab stop when in snippet mode"));static HasPrevTabstop=new A("hasPrevTabstop",!1,u("hasPrevTabstop","Whether there is a previous tab stop when in snippet mode"));_inSnippet;_hasNextTabstop;_hasPrevTabstop;_session;_snippetListener=new B;_modelVersionId=-1;_currentChoice;_choiceCompletions;dispose(){this._inSnippet.reset(),this._hasPrevTabstop.reset(),this._hasNextTabstop.reset(),this._session?.dispose(),this._snippetListener.dispose()}apply(t,e){try{this._doInsert(t,typeof e>"u"?JH:{...JH,...e})}catch(i){this.cancel(),this._logService.error(i),this._logService.error("snippet_error"),this._logService.error("insert_edits=",t),this._logService.error("existing_template=",this._session?this._session._logInfo():"<no_session>")}}insert(t,e){try{this._doInsert(t,typeof e>"u"?JH:{...JH,...e})}catch(i){this.cancel(),this._logService.error(i),this._logService.error("snippet_error"),this._logService.error("insert_template=",t),this._logService.error("existing_template=",this._session?this._session._logInfo():"<no_session>")}}_doInsert(t,e){if(this._editor.hasModel()){if(this._snippetListener.clear(),e.undoStopBefore&&this._editor.getModel().pushStackElement(),this._session&&typeof t!="string"&&this.cancel(),this._session?(un(typeof t=="string"),this._session.merge(t,e)):(this._modelVersionId=this._editor.getModel().getAlternativeVersionId(),this._session=new ca(this._editor,t,e,this._languageConfigurationService),this._session.insert()),e.undoStopAfter&&this._editor.getModel().pushStackElement(),this._session?.hasChoice){let i={_debugDisplayName:"snippetChoiceCompletions",provideCompletionItems:(d,c)=>{if(!this._session||d!==this._editor.getModel()||!H.equals(this._editor.getPosition(),c))return;let{activeChoice:p}=this._session;if(!p||p.choice.options.length===0)return;let h=d.getValueInRange(p.range),m=!!p.choice.options.find(g=>g.value===h),f=[];for(let g=0;g<p.choice.options.length;g++){let v=p.choice.options[g];f.push({kind:13,label:v.value,insertText:v.value,sortText:"a".repeat(g+1),range:p.range,filterText:m?`${h}_${v.value}`:void 0,command:{id:"jumpToNextSnippetPlaceholder",title:u("next","Go to next placeholder...")}})}return{suggestions:f}}},n=this._editor.getModel(),o,s=!1,a=()=>{o?.dispose(),s=!1},l=()=>{s||(o=this._languageFeaturesService.completionProvider.register({language:n.getLanguageId(),pattern:n.uri.fsPath,scheme:n.uri.scheme,exclusive:!0},i),this._snippetListener.add(o),s=!0)};this._choiceCompletions={provider:i,enable:l,disable:a}}this._updateState(),this._snippetListener.add(this._editor.onDidChangeModelContent(i=>i.isFlush&&this.cancel())),this._snippetListener.add(this._editor.onDidChangeModel(()=>this.cancel())),this._snippetListener.add(this._editor.onDidChangeCursorSelection(()=>this._updateState()))}}_updateState(){if(!(!this._session||!this._editor.hasModel())){if(this._modelVersionId===this._editor.getModel().getAlternativeVersionId())return this.cancel();if(!this._session.hasPlaceholder)return this.cancel();if(this._session.isAtLastPlaceholder||!this._session.isSelectionWithinPlaceholders())return this._editor.getModel().pushStackElement(),this.cancel();this._inSnippet.set(!0),this._hasPrevTabstop.set(!this._session.isAtFirstPlaceholder),this._hasNextTabstop.set(!this._session.isAtLastPlaceholder),this._handleChoice()}}_handleChoice(){if(!this._session||!this._editor.hasModel()){this._currentChoice=void 0;return}let{activeChoice:t}=this._session;if(!t||!this._choiceCompletions){this._choiceCompletions?.disable(),this._currentChoice=void 0;return}this._currentChoice!==t.choice&&(this._currentChoice=t.choice,this._choiceCompletions.enable(),queueMicrotask(()=>{BH(this._editor,this._choiceCompletions.provider)}))}finish(){for(;this._inSnippet.get();)this.next()}cancel(t=!1){this._inSnippet.reset(),this._hasPrevTabstop.reset(),this._hasNextTabstop.reset(),this._snippetListener.clear(),this._currentChoice=void 0,this._session?.dispose(),this._session=void 0,this._modelVersionId=-1,t&&this._editor.setSelections([this._editor.getSelection()])}prev(){this._session?.prev(),this._updateState()}next(){this._session?.next(),this._updateState()}isInSnippet(){return!!this._inSnippet.get()}getSessionEnclosingRange(){if(this._session)return this._session.getEnclosingRange()}};kn=E([b(1,bt),b(2,ni),b(3,re),b(4,Do)],kn);gr(kn.ID,kn,4);var eU=_r.bindToContribution(kn.get);qe(new eU({id:"jumpToNextSnippetPlaceholder",precondition:P.and(kn.InSnippetMode,kn.HasNextTabstop),handler:r=>r.next(),kbOpts:{weight:130,kbExpr:ce.textInputFocus,primary:2}}));qe(new eU({id:"jumpToPrevSnippetPlaceholder",precondition:P.and(kn.InSnippetMode,kn.HasPrevTabstop),handler:r=>r.prev(),kbOpts:{weight:130,kbExpr:ce.textInputFocus,primary:1026}}));qe(new eU({id:"leaveSnippet",precondition:kn.InSnippetMode,handler:r=>r.cancel(!0),kbOpts:{weight:130,kbExpr:ce.textInputFocus,primary:9,secondary:[1033]}}));qe(new eU({id:"acceptSnippet",precondition:kn.InSnippetMode,handler:r=>r.finish()}));var px=class extends R{static ID="editor.contrib.menuPreventer";_editor;_altListeningMouse;_altMouseTriggered;constructor(t){super(),this._editor=t,this._altListeningMouse=!1,this._altMouseTriggered=!1,this._register(this._editor.onMouseDown(e=>{this._altListeningMouse&&(this._altMouseTriggered=!0)})),this._register(this._editor.onKeyDown(e=>{e.equals(512)&&(this._altListeningMouse||(this._altMouseTriggered=!1),this._altListeningMouse=!0)})),this._register(this._editor.onKeyUp(e=>{e.equals(512)&&(this._altMouseTriggered&&e.preventDefault(),this._altListeningMouse=!1,this._altMouseTriggered=!1)}))}};gr(px.ID,px,2);var uue="editor.contrib.selectionClipboard";var pue=q("extensionResourceLoaderService");var Tj=class{codeSnippet;isBogous;isTrivial;usesClipboardVariable;usesSelectionVariable;constructor(t){this.isBogous=!1,this.isTrivial=!1,this.usesClipboardVariable=!1,this.usesSelectionVariable=!1,this.codeSnippet=t;let e=new Fa().parse(t,!1),i=new Map,n=0;for(let s of e.placeholders)n=Math.max(n,s.index);if(e.placeholders.length===0)this.isTrivial=!0;else if(n===0){let s=ls(e.children);this.isTrivial=s instanceof da&&s.isFinalTabstop}let o=[...e.children];for(;o.length>0;){let s=o.shift();if(s instanceof My){if(s.children.length===0&&!lue[s.name]){let a=i.has(s.name)?i.get(s.name):++n;i.set(s.name,a);let l=new da(a).appendChild(new vr(s.name));e.replace(s,[l]),this.isBogous=!0}switch(s.name){case"CLIPBOARD":this.usesClipboardVariable=!0;break;case"SELECTION":case"TM_SELECTED_TEXT":this.usesSelectionVariable=!0;break}}else o.push(...s.children)}this.isBogous&&(this.codeSnippet=e.toTextmateString())}},FR=class{constructor(t,e,i,n,o,s,a,l,d,c){this.isFileTemplate=t;this.scopes=e;this.name=i;this.prefix=n;this.description=o;this.body=s;this.source=a;this.snippetSource=l;this.snippetIdentifier=d;this.extensionId=c;this.prefixLow=n.toLowerCase(),this._bodyInsights=new cf(Gr(),()=>new Tj(this.body))}_bodyInsights;prefixLow;get codeSnippet(){return this._bodyInsights.value.codeSnippet}get isBogous(){return this._bodyInsights.value.isBogous}get isTrivial(){return this._bodyInsights.value.isTrivial}get needsClipboard(){return this._bodyInsights.value.usesClipboardVariable}get usesSelection(){return this._bodyInsights.value.usesSelectionVariable}};function Vxe(r){return vi(r)&&!!r.body}var hx=class{constructor(t,e,i,n,o,s){this.source=t;this.location=e;this.defaultScopes=i;this._extension=n;this._fileService=o;this._extensionResourceLoaderService=s;this.isGlobalSnippets=hm(e.path)===".code-snippets",this.isUserSnippets=!this._extension}data=[];isGlobalSnippets;isUserSnippets;_loadPromise;select(t,e){this.isGlobalSnippets||!this.isUserSnippets?this._scopeSelect(t,e):this._filepathSelect(t,e)}_filepathSelect(t,e){t+".json"===Eo(this.location.path)&&e.push(...this.data)}_scopeSelect(t,e){for(let n of this.data){let o=n.scopes.length;if(o===0)e.push(n);else for(let s=0;s<o;s++)if(n.scopes[s]===t){e.push(n);break}}let i=t.lastIndexOf(".");i>=0&&this._scopeSelect(t.substring(0,i),e)}async _load(){return this._extension?this._extensionResourceLoaderService.readExtensionResource(this.location):(await this._fileService.readFile(this.location)).value.toString()}load(){return this._loadPromise||(this._loadPromise=Promise.resolve(this._load()).then(t=>{let e=Ak(t);if($3(e)==="object")for(let[i,n]of Object.entries(e))if(Vxe(n))this._parseSnippet(i,n,this.data);else for(let[o,s]of Object.entries(n))this._parseSnippet(o,s,this.data);return this})),this._loadPromise}reset(){this._loadPromise=void 0,this.data.length=0}_parseSnippet(t,e,i){let{isFileTemplate:n,prefix:o,body:s,description:a}=e;if(o||(o=""),Array.isArray(s)&&(s=s.join(`
`)),typeof s!="string")return;Array.isArray(a)&&(a=a.join(`
`));let l;this.defaultScopes?l=this.defaultScopes:typeof e.scope=="string"?l=e.scope.split(",").map(c=>c.trim()).filter(Boolean):l=[];let d;this._extension?d=this._extension.displayName||this._extension.name:this.source===2?d=u("source.workspaceSnippetGlobal","Workspace Snippet"):this.isGlobalSnippets?d=u("source.userSnippetGlobal","Global User Snippet"):d=u("source.userSnippet","User Snippet");for(let c of mt.wrap(o))i.push(new FR(!!n,l,t,c,a,s,d,this.source,this._extension?`${af(this._extension.extensionLocation,this.location)}/${t}`:`${Eo(this.location.path)}/${t}`,this._extension?.identifier))}};var BR=q("snippetService");var Ub=[],_j=[],Dj=[];function VR(r,t=!1){gue(r,!1,t)}function mue(r){gue(r,!0,!1)}function gue(r,t,e){let i=Wxe(r,t);Ub.push(i),i.userConfigured?Dj.push(i):_j.push(i),e&&!i.userConfigured&&Ub.forEach(n=>{n.mime===i.mime||n.userConfigured||(i.extension&&n.extension===i.extension&&console.warn(`Overwriting extension <<${i.extension}>> to now point to mime <<${i.mime}>>`),i.filename&&n.filename===i.filename&&console.warn(`Overwriting filename <<${i.filename}>> to now point to mime <<${i.mime}>>`),i.filepattern&&n.filepattern===i.filepattern&&console.warn(`Overwriting filepattern <<${i.filepattern}>> to now point to mime <<${i.mime}>>`),i.firstline&&n.firstline===i.firstline&&console.warn(`Overwriting firstline <<${i.firstline}>> to now point to mime <<${i.mime}>>`))})}function Wxe(r,t){return{id:r.id,mime:r.mime,filename:r.filename,extension:r.extension,filepattern:r.filepattern,firstline:r.firstline,userConfigured:t,filenameLowercase:r.filename?r.filename.toLowerCase():void 0,extensionLowercase:r.extension?r.extension.toLowerCase():void 0,filepatternLowercase:r.filepattern?du(r.filepattern.toLowerCase()):void 0,filepatternOnPath:r.filepattern?r.filepattern.indexOf(Xt.sep)>=0:!1}}function fue(){Ub=Ub.filter(r=>r.userConfigured),_j=[]}function bue(){Ub=Ub.filter(r=>!r.userConfigured),Dj=[]}function vue(r,t){return yue(r,t).map(e=>e.mime)}function Iue(r,t){return yue(r,t).map(e=>e.id)}function yue(r,t){let e;if(r)switch(r.scheme){case Ie.file:e=r.fsPath;break;case Ie.data:{e=Cm.parseMetaData(r).get(Cm.META_DATA_LABEL);break}case Ie.vscodeNotebookCell:e=void 0;break;default:e=r.path}if(!e)return[{id:"unknown",mime:Oo.unknown}];e=e.toLowerCase();let i=Eo(e),n=hue(e,i,Dj);if(n)return[n,{id:jn,mime:Oo.text}];let o=hue(e,i,_j);if(o)return[o,{id:jn,mime:Oo.text}];if(t){let s=Hxe(t);if(s)return[s,{id:jn,mime:Oo.text}]}return[{id:"unknown",mime:Oo.unknown}]}function hue(r,t,e){let i,n,o;for(let s=e.length-1;s>=0;s--){let a=e[s];if(t===a.filenameLowercase){i=a;break}if(a.filepattern&&(!n||a.filepattern.length>n.filepattern.length)){let l=a.filepatternOnPath?r:t;a.filepatternLowercase?.(l)&&(n=a)}a.extension&&(!o||a.extension.length>o.extension.length)&&t.endsWith(a.extensionLowercase)&&(o=a)}if(i)return i;if(n)return n;if(o)return o}function Hxe(r){if(bA(r)&&(r=r.substr(1)),r.length>0)for(let t=Ub.length-1;t>=0;t--){let e=Ub[t];if(!e.firstline)continue;let i=r.match(e.firstline);if(i&&i.length>0)return e}}var Uu=Object.prototype.hasOwnProperty,Sue="vs.editor.nullLanguage",kj=class{_nextLanguageId;_languageIdToLanguage=[];_languageToLanguageId=new Map;constructor(){this._register(Sue,0),this._register(jn,1),this._nextLanguageId=2}_register(t,e){this._languageIdToLanguage[e]=t,this._languageToLanguageId.set(t,e)}register(t){if(this._languageToLanguageId.has(t))return;let e=this._nextLanguageId++;this._register(t,e)}encodeLanguageId(t){return this._languageToLanguageId.get(t)||0}decodeLanguageId(t){return this._languageIdToLanguage[t]||Sue}},tU=class r extends R{static instanceCount=0;_onDidChange=this._register(new x);onDidChange=this._onDidChange.event;_warnOnOverwrite;languageIdCodec;_dynamicLanguages;_languages;_mimeTypesMap;_nameMap;_lowercaseNameMap;constructor(t=!0,e=!1){super(),r.instanceCount++,this._warnOnOverwrite=e,this.languageIdCodec=new kj,this._dynamicLanguages=[],this._languages={},this._mimeTypesMap={},this._nameMap={},this._lowercaseNameMap={},t&&(this._initializeFromRegistry(),this._register(SC.onDidChangeLanguages(i=>{this._initializeFromRegistry()})))}dispose(){r.instanceCount--,super.dispose()}setDynamicLanguages(t){this._dynamicLanguages=t,this._initializeFromRegistry()}_initializeFromRegistry(){this._languages={},this._mimeTypesMap={},this._nameMap={},this._lowercaseNameMap={},fue();let t=[].concat(SC.getLanguages()).concat(this._dynamicLanguages);this._registerLanguages(t)}registerLanguage(t){return SC.registerLanguage(t)}_registerLanguages(t){for(let e of t)this._registerLanguage(e);this._mimeTypesMap={},this._nameMap={},this._lowercaseNameMap={},Object.keys(this._languages).forEach(e=>{let i=this._languages[e];i.name&&(this._nameMap[i.name]=i.identifier),i.aliases.forEach(n=>{this._lowercaseNameMap[n.toLowerCase()]=i.identifier}),i.mimetypes.forEach(n=>{this._mimeTypesMap[n]=i.identifier})}),Pe.as(ur.Configuration).registerOverrideIdentifiers(this.getRegisteredLanguageIds()),this._onDidChange.fire()}_registerLanguage(t){let e=t.id,i;Uu.call(this._languages,e)?i=this._languages[e]:(this.languageIdCodec.register(e),i={identifier:e,name:null,mimetypes:[],aliases:[],extensions:[],filenames:[],configurationFiles:[],icons:[]},this._languages[e]=i),this._mergeLanguage(i,t)}_mergeLanguage(t,e){let i=e.id,n=null;if(Array.isArray(e.mimetypes)&&e.mimetypes.length>0&&(t.mimetypes.push(...e.mimetypes),n=e.mimetypes[0]),n||(n=`text/x-${i}`,t.mimetypes.push(n)),Array.isArray(e.extensions)){e.configuration?t.extensions=e.extensions.concat(t.extensions):t.extensions=t.extensions.concat(e.extensions);for(let a of e.extensions)VR({id:i,mime:n,extension:a},this._warnOnOverwrite)}if(Array.isArray(e.filenames))for(let a of e.filenames)VR({id:i,mime:n,filename:a},this._warnOnOverwrite),t.filenames.push(a);if(Array.isArray(e.filenamePatterns))for(let a of e.filenamePatterns)VR({id:i,mime:n,filepattern:a},this._warnOnOverwrite);if(typeof e.firstLine=="string"&&e.firstLine.length>0){let a=e.firstLine;a.charAt(0)!=="^"&&(a="^"+a);try{let l=new RegExp(a);hee(l)||VR({id:i,mime:n,firstline:l},this._warnOnOverwrite)}catch(l){console.warn(`[${e.id}]: Invalid regular expression \`${a}\`: `,l)}}t.aliases.push(i);let o=null;if(typeof e.aliases<"u"&&Array.isArray(e.aliases)&&(e.aliases.length===0?o=[null]:o=e.aliases),o!==null)for(let a of o)!a||a.length===0||t.aliases.push(a);let s=o!==null&&o.length>0;if(!(s&&o[0]===null)){let a=(s?o[0]:null)||i;(s||!t.name)&&(t.name=a)}e.configuration&&t.configurationFiles.push(e.configuration),e.icon&&t.icons.push(e.icon)}isRegisteredLanguageId(t){return t?Uu.call(this._languages,t):!1}getRegisteredLanguageIds(){return Object.keys(this._languages)}getSortedRegisteredLanguageNames(){let t=[];for(let e in this._nameMap)Uu.call(this._nameMap,e)&&t.push({languageName:e,languageId:this._nameMap[e]});return t.sort((e,i)=>fm(e.languageName,i.languageName)),t}getLanguageName(t){return Uu.call(this._languages,t)?this._languages[t].name:null}getMimeType(t){return Uu.call(this._languages,t)&&this._languages[t].mimetypes[0]||null}getExtensions(t){return Uu.call(this._languages,t)?this._languages[t].extensions:[]}getFilenames(t){return Uu.call(this._languages,t)?this._languages[t].filenames:[]}getIcon(t){return Uu.call(this._languages,t)&&this._languages[t].icons[0]||null}getConfigurationFiles(t){return Uu.call(this._languages,t)?this._languages[t].configurationFiles||[]:[]}getLanguageIdByLanguageName(t){let e=t.toLowerCase();return Uu.call(this._lowercaseNameMap,e)?this._lowercaseNameMap[e]:null}getLanguageIdByMimeType(t){return t&&Uu.call(this._mimeTypesMap,t)?this._mimeTypesMap[t]:null}guessLanguageIdByFilepathOrFirstLine(t,e){return!t&&!e?[]:Iue(t,e)}};var iU=class r extends R{_serviceBrand;static instanceCount=0;_onDidRequestBasicLanguageFeatures=this._register(new x);onDidRequestBasicLanguageFeatures=this._onDidRequestBasicLanguageFeatures.event;_onDidRequestRichLanguageFeatures=this._register(new x);onDidRequestRichLanguageFeatures=this._onDidRequestRichLanguageFeatures.event;_onDidChange=this._register(new x({leakWarningThreshold:200}));onDidChange=this._onDidChange.event;_requestedBasicLanguages=new Set;_requestedRichLanguages=new Set;_registry;languageIdCodec;constructor(t=!1){super(),r.instanceCount++,this._registry=this._register(new tU(!0,t)),this.languageIdCodec=this._registry.languageIdCodec,this._register(this._registry.onDidChange(()=>this._onDidChange.fire()))}dispose(){r.instanceCount--,super.dispose()}registerLanguage(t){return this._registry.registerLanguage(t)}isRegisteredLanguageId(t){return this._registry.isRegisteredLanguageId(t)}getRegisteredLanguageIds(){return this._registry.getRegisteredLanguageIds()}getSortedRegisteredLanguageNames(){return this._registry.getSortedRegisteredLanguageNames()}getLanguageName(t){return this._registry.getLanguageName(t)}getMimeType(t){return this._registry.getMimeType(t)}getIcon(t){return this._registry.getIcon(t)}getExtensions(t){return this._registry.getExtensions(t)}getFilenames(t){return this._registry.getFilenames(t)}getConfigurationFiles(t){return this._registry.getConfigurationFiles(t)}getLanguageIdByLanguageName(t){return this._registry.getLanguageIdByLanguageName(t)}getLanguageIdByMimeType(t){return this._registry.getLanguageIdByMimeType(t)}guessLanguageIdByFilepathOrFirstLine(t,e){return this._registry.guessLanguageIdByFilepathOrFirstLine(t,e).at(0)??null}createById(t){return new WR(this.onDidChange,()=>this._createAndGetLanguageIdentifier(t))}createByMimeType(t){return new WR(this.onDidChange,()=>{let e=this.getLanguageIdByMimeType(t);return this._createAndGetLanguageIdentifier(e)})}createByFilepathOrFirstLine(t,e){return new WR(this.onDidChange,()=>{let i=this.guessLanguageIdByFilepathOrFirstLine(t,e);return this._createAndGetLanguageIdentifier(i)})}_createAndGetLanguageIdentifier(t){return(!t||!this.isRegisteredLanguageId(t))&&(t=jn),t}requestBasicLanguageFeatures(t){this._requestedBasicLanguages.has(t)||(this._requestedBasicLanguages.add(t),this._onDidRequestBasicLanguageFeatures.fire(t))}requestRichLanguageFeatures(t){this._requestedRichLanguages.has(t)||(this._requestedRichLanguages.add(t),this.requestBasicLanguageFeatures(t),Is.getOrCreate(t),this._onDidRequestRichLanguageFeatures.fire(t))}},WR=class{_value;onDidChange;constructor(t,e){this._value=Pi(this,t,()=>e()),this.onDidChange=X.fromObservable(this._value)}get languageId(){return this._value.get()}};var mx;(t=>t.ExtensionFeaturesRegistry="workbench.registry.extensionFeatures")(mx||={});var kpn=q("IExtensionFeaturesManagementService"),Lj=class{extensionFeatures=new Map;registerExtensionFeature(t){if(this.extensionFeatures.has(t.id))throw new Error(`Extension feature with id '${t.id}' already exists`);return this.extensionFeatures.set(t.id,t),{dispose:()=>this.extensionFeatures.delete(t.id)}}getExtensionFeature(t){return this.extensionFeatures.get(t)}getExtensionFeatures(){return Array.from(this.extensionFeatures.values())}};Pe.add(mx.ExtensionFeaturesRegistry,new Lj);var UR=Ra.registerExtensionPoint({extensionPoint:"languages",jsonSchema:{description:u("vscode.extension.contributes.languages","Contributes language declarations."),type:"array",items:{type:"object",defaultSnippets:[{body:{id:"${1:languageId}",aliases:["${2:label}"],extensions:["${3:extension}"],configuration:"./language-configuration.json"}}],properties:{id:{description:u("vscode.extension.contributes.languages.id","ID of the language."),type:"string"},aliases:{description:u("vscode.extension.contributes.languages.aliases","Name aliases for the language."),type:"array",items:{type:"string"}},extensions:{description:u("vscode.extension.contributes.languages.extensions","File extensions associated to the language."),default:[".foo"],type:"array",items:{type:"string"}},filenames:{description:u("vscode.extension.contributes.languages.filenames","File names associated to the language."),type:"array",items:{type:"string"}},filenamePatterns:{description:u("vscode.extension.contributes.languages.filenamePatterns","File name glob patterns associated to the language."),type:"array",items:{type:"string"}},mimetypes:{description:u("vscode.extension.contributes.languages.mimetypes","Mime types associated to the language."),type:"array",items:{type:"string"}},firstLine:{description:u("vscode.extension.contributes.languages.firstLine","A regular expression matching the first line of a file of the language."),type:"string"},configuration:{description:u("vscode.extension.contributes.languages.configuration","A relative path to a file containing configuration options for the language."),type:"string",default:"./language-configuration.json"},icon:{type:"object",description:u("vscode.extension.contributes.languages.icon","A icon to use as file icon, if no icon theme provides one for the language."),properties:{light:{description:u("vscode.extension.contributes.languages.icon.light","Icon path when a light theme is used"),type:"string"},dark:{description:u("vscode.extension.contributes.languages.icon.dark","Icon path when a dark theme is used"),type:"string"}}}}}},activationEventsGenerator:(r,t)=>{for(let e of r)e.id&&e.configuration&&t.push(`onLanguage:${e.id}`)}}),Rj=class extends R{type="table";shouldRender(t){return!!t.contributes?.languages}render(t){let e=t.contributes,i=e?.languages||[],n=[];for(let c of i)Cue(c)&&n.push({id:c.id,name:(c.aliases||[])[0]||c.id,extensions:c.extensions||[],hasGrammar:!1,hasSnippets:!1});let o=wJ(n,c=>c.id);if((e?.grammars||[]).forEach(c=>{if(!Bt(c.language))return;let p=o[c.language];p?p.hasGrammar=!0:(p={id:c.language,name:c.language,extensions:[],hasGrammar:!0,hasSnippets:!1},o[p.id]=p,n.push(p))}),(e?.snippets||[]).forEach(c=>{if(!Bt(c.language))return;let p=o[c.language];p?p.hasSnippets=!0:(p={id:c.language,name:c.language,extensions:[],hasGrammar:!1,hasSnippets:!0},o[p.id]=p,n.push(p))}),!n.length)return{data:{headers:[],rows:[]},dispose:()=>{}};let l=[u("language id","ID"),u("language name","Name"),u("file extensions","File Extensions"),u("grammar","Grammar"),u("snippets","Snippets")],d=n.sort((c,p)=>c.id.localeCompare(p.id)).map(c=>[c.id,c.name,new Sn().appendMarkdown(`${c.extensions.map(p=>`\`${p}\``).join("&nbsp;")}`),c.hasGrammar?"\u2714\uFE0E":"\u2014",c.hasSnippets?"\u2714\uFE0E":"\u2014"]);return{data:{headers:l,rows:d},dispose:()=>{}}}};Pe.as(mx.ExtensionFeaturesRegistry).registerExtensionFeature({id:"languages",label:u("languages","Programming Languages"),access:{canToggle:!1},renderer:new qr(Rj)});var HR=class extends iU{constructor(e,i,n,o){super(n.verbose||n.isExtensionDevelopment||!n.isBuilt);this.logService=o;this._configurationService=i,this._extensionService=e,UR.setHandler(s=>{let a=[];for(let l=0,d=s.length;l<d;l++){let c=s[l];if(!Array.isArray(c.value)){c.collector.error(u("invalid","Invalid `contributes.{0}`. Expected an array.",UR.name));continue}for(let p=0,h=c.value.length;p<h;p++){let m=c.value[p];if(Cue(m,c.collector)){let f;m.configuration&&(f=pi(c.description.extensionLocation,m.configuration)),a.push({id:m.id,extensions:m.extensions,filenames:m.filenames,filenamePatterns:m.filenamePatterns,firstLine:m.firstLine,aliases:m.aliases,mimetypes:m.mimetypes,configuration:f,icon:m.icon&&{light:pi(c.description.extensionLocation,m.icon.light),dark:pi(c.description.extensionLocation,m.icon.dark)}})}}}this._registry.setDynamicLanguages(a)}),this.updateMime(),this._register(this._configurationService.onDidChangeConfiguration(s=>{s.affectsConfiguration(nN)&&this.updateMime()})),this._extensionService.whenInstalledExtensionsRegistered().then(()=>{this.updateMime()}),this._register(this.onDidRequestRichLanguageFeatures(s=>{this._extensionService.activateByEvent(`onLanguage:${s}`),this._extensionService.activateByEvent("onLanguage")}))}_configurationService;_extensionService;updateMime(){let e=this._configurationService.getValue();bue(),e.files?.associations&&Object.keys(e.files.associations).forEach(i=>{let n=e.files.associations[i];if(typeof n!="string"){this.logService.warn(`Ignoring configured 'files.associations' for '${i}' because its type is not a string but '${typeof n}'`);return}let o=this.getMimeType(n)||`text/x-${n}`;mue({id:n,mime:o,filepattern:i})}),this._onDidChange.fire()}};HR=E([b(0,_n),b(1,se),b(2,$o),b(3,bt)],HR);function nU(r){return typeof r>"u"?!0:Array.isArray(r)?r.every(t=>typeof t=="string"):!1}function Cue(r,t){return r?typeof r.id!="string"?(t?.error(u("require.id","property `{0}` is mandatory and must be of type `string`","id")),!1):nU(r.extensions)?nU(r.filenames)?typeof r.firstLine<"u"&&typeof r.firstLine!="string"?(t?.error(u("opt.firstLine","property `{0}` can be omitted and must be of type `string`","firstLine")),!1):typeof r.configuration<"u"&&typeof r.configuration!="string"?(t?.error(u("opt.configuration","property `{0}` can be omitted and must be of type `string`","configuration")),!1):nU(r.aliases)?nU(r.mimetypes)?typeof r.icon<"u"&&(typeof r.icon!="object"||typeof r.icon.light!="string"||typeof r.icon.dark!="string")?(t?.error(u("opt.icon","property `{0}` can be omitted and must be of type `object` with properties `{1}` and `{2}` of type `string`","icon","light","dark")),!1):!0:(t?.error(u("opt.mimetypes","property `{0}` can be omitted and must be of type `string[]`","mimetypes")),!1):(t?.error(u("opt.aliases","property `{0}` can be omitted and must be of type `string[]`","aliases")),!1):(t?.error(u("opt.filenames","property `{0}` can be omitted and must be of type `string[]`","filenames")),!1):(t?.error(u("opt.extensions","property `{0}` can be omitted and must be of type `string[]`","extensions")),!1):(t?.error(u("invalid.empty","Empty value for `contributes.{0}`",UR.name)),!1)}gi(ti,HR,0);var wue="_snippet.markAsUsed";tt.registerCommand(wue,(r,...t)=>{let e=r.get(BR),[i]=t;i instanceof FR&&e.updateUsageTimestamp(i)});var zb=class{constructor(t,e){this.snippet=t;this.label={label:t.prefix,description:t.name},this.detail=u("detail.snippet","{0} ({1})",t.description||t.name,t.source),this.insertText=t.codeSnippet,this.extensionId=t.extensionId,this.range=e,this.sortText=`${t.snippetSource===3?"z":"a"}-${t.prefix}`,this.kind=27,this.insertTextRules=4,this.command={id:wue,title:"",arguments:[t]}}label;detail;insertText;documentation;range;sortText;kind;insertTextRules;extensionId;command;resolve(){return this.documentation=new Sn().appendCodeblock("",Fa.asInsertText(this.snippet.codeSnippet)),this}static compareByLabel(t,e){return Zg(t.label.label,e.label.label)}},gx=class{constructor(t,e,i){this._languageService=t;this._snippets=e;this._languageConfigurationService=i}_debugDisplayName="snippetCompletions";async provideCompletionItems(t,e,i){let n=new Ko,o=e.lineNumber,s=t.getWordAtPosition(e)??{startColumn:e.column,endColumn:e.column,word:""},a=t.getLineContent(e.lineNumber).toLowerCase(),l=a.substring(0,s.startColumn+s.word.length-1),d=this._computeSnippetPositions(t,o,s,l),c=e.column-1,p=i.triggerCharacter?.toLowerCase()??"",h=this._getLanguageIdAtPosition(t,e),m=this._languageConfigurationService.getLanguageConfiguration(h),f=new Set(await this._snippets.getSnippets(h)),g=[];for(let v of f){if(i.triggerKind===1&&!v.prefixLow.startsWith(p))continue;let I;for(let O of d)if(!(O.prefixLow.match(/^\s/)&&!v.prefixLow.match(/^\s/))&&gK(O.prefixLow,0,O.prefixLow.length,v.prefixLow,0,v.prefixLow.length)){I=O;break}if(!I)continue;let y=I.startColumn-1,w=v.prefixLow.length-(c-y),C=NS(a,v.prefixLow,c,c+w,c-y),S=e.with(void 0,y+1),D=C===0?e.column+w:e.column;c<a.length&&m.getAutoClosingPairs().autoClosingPairsCloseSingleChar.get(a[c])?.some(G=>G.open===a[S.column-1]&&v.prefix.startsWith(G.open)&&v.prefix[v.prefix.length-1]===G.close)&&D++;let k=L.fromPositions({lineNumber:o,column:I.startColumn},{lineNumber:o,column:D}),M=k.setEndPosition(o,e.column);g.push(new zb(v,{replace:k,insert:M})),f.delete(v)}if(!p&&(/\s/.test(a[e.column-2])||!a))for(let v of f){let I=L.fromPositions(e),y=a.indexOf(v.prefixLow,c)===c?I.setEndPosition(e.lineNumber,e.column+v.prefixLow.length):I;g.push(new zb(v,{replace:y,insert:I}))}return this._disambiguateSnippets(g),{suggestions:g,duration:n.elapsed()}}_disambiguateSnippets(t){t.sort(zb.compareByLabel);for(let e=0;e<t.length;e++){let i=t[e],n=e+1;for(;n<t.length&&i.label===t[n].label;n++)t[n].label.label=u("snippetSuggest.longLabel","{0}, {1}",t[n].label.label,t[n].snippet.name);n>e+1&&(t[e].label.label=u("snippetSuggest.longLabel","{0}, {1}",t[e].label.label,t[e].snippet.name),e=n)}}resolveCompletionItem(t){return t instanceof zb?t.resolve():t}_computeSnippetPositions(t,e,i,n){let o=[];for(let s=1;s<i.startColumn;s++){let a=t.getWordAtPosition(new H(e,s));o.push({startColumn:s,prefixLow:n.substring(s-1),isWord:!!a}),a&&(s=a.endColumn,o.push({startColumn:a.endColumn,prefixLow:n.substring(a.endColumn-1),isWord:!1}))}return(i.word.length>0||o.length===0)&&o.push({startColumn:i.startColumn,prefixLow:n.substring(i.startColumn-1),isWord:!0}),o}_getLanguageIdAtPosition(t,e){t.tokenization.tokenizeIfCheap(e.lineNumber);let i=t.getLanguageIdAtPosition(e.lineNumber,e.column);return this._languageService.getLanguageName(i)||(i=t.getLanguageId()),i}};gx=E([b(0,ti),b(1,BR),b(2,Do)],gx);var By=q("IUserDataProfileService"),umn=q("IUserDataProfileManagementService");var pmn=q("IUserDataProfileImportExportService"),hmn=ke("defaultProfile-icon",N.settings,u("defaultProfileIcon","Icon for Default Profile.")),zxe=ie("profiles","Profiles"),mmn={...zxe},Kxe="code-profile",gmn=[{name:u("profile","Profile"),extensions:[Kxe]}],fmn=new A("profiles.enabled",!0),bmn=new A("currentProfile",""),vmn=new A("isCurrentProfileTransient",!1),Imn=new A("hasProfiles",!1);var Pj;(i=>{function r(n,o,s){if(gd(o.path))return n.collector.error(u("invalid.path.0","Expected string in `contributes.{0}.path`. Provided value: {1}",n.description.name,String(o.path))),null;if(gd(o.language)&&!o.path.endsWith(".code-snippets"))return n.collector.error(u("invalid.language.0","When omitting the language, the value of `contributes.{0}.path` must be a `.code-snippets`-file. Provided value: {1}",n.description.name,String(o.path))),null;if(!gd(o.language)&&!s.isRegisteredLanguageId(o.language))return n.collector.error(u("invalid.language","Unknown language in `contributes.{0}.language`. Provided value: {1}",n.description.name,String(o.language))),null;let a=n.description.extensionLocation,l=pi(a,o.path);return R4(l,a)?{language:o.language,location:l}:(n.collector.error(u("invalid.path.1","Expected `contributes.{0}.path` ({1}) to be included inside extension's folder ({2}). This might make the extension non-portable.",n.description.name,l.path,a.path)),null)}i.toValidSnippet=r,i.snippetsContribution={description:u("vscode.extension.contributes.snippets","Contributes snippets."),type:"array",defaultSnippets:[{body:[{language:"",path:""}]}],items:{type:"object",defaultSnippets:[{body:{language:"${1:id}",path:"./snippets/${2:id}.json."}}],properties:{language:{description:u("vscode.extension.contributes.snippets-language","Language identifier for which this snippet is contributed to."),type:"string"},path:{description:u("vscode.extension.contributes.snippets-path","Path of the snippets file. The path is relative to the extension folder and typically starts with './snippets/'."),type:"string"}}}},i.point=Ra.registerExtensionPoint({extensionPoint:"snippets",deps:[UR],jsonSchema:i.snippetsContribution})})(Pj||={});function Gxe(r,t,e){return In(r.watch(t),r.onDidFilesChange(i=>{i.affects(t)&&e()}))}var Kb=class{constructor(t){this._storageService=t;let e=t.get(Kb._key,0,""),i;try{i=JSON.parse(e)}catch{}this._ignored=G_(i)?new Set(i):new Set}static _key="snippets.ignoredSnippets";_ignored;isIgnored(t){return this._ignored.has(t)}updateIgnored(t,e){let i=!1;this._ignored.has(t)&&!e?(this._ignored.delete(t),i=!0):!this._ignored.has(t)&&e&&(this._ignored.add(t),i=!0),i&&this._storageService.store(Kb._key,JSON.stringify(Array.from(this._ignored)),0,0)}};Kb=E([b(0,nt)],Kb);var Gb=class{constructor(t){this._storageService=t;let e=t.get(Gb._key,0,""),i;try{i=JSON.parse(e)}catch{i=[]}this._usages=Array.isArray(i)?new Map(i):new Map}static _key="snippets.usageTimestamps";_usages;getUsageTimestamp(t){return this._usages.get(t)}updateUsageTimestamp(t){this._usages.delete(t),this._usages.set(t,Date.now());let e=[...this._usages].slice(-100);this._storageService.store(Gb._key,JSON.stringify(e),0,0)}};Gb=E([b(0,nt)],Gb);var oU=class{constructor(t,e,i,n,o,s,a,l,d,c,p){this._environmentService=t;this._userDataProfileService=e;this._contextService=i;this._languageService=n;this._logService=o;this._fileService=s;this._textfileService=a;this._extensionResourceLoaderService=l;this._pendingWork.push(Promise.resolve(d.when(3).then(()=>{this._initExtensionSnippets(),this._initUserSnippets(),this._initWorkspaceSnippets()}))),Zce(new gx(this._languageService,this,p)),this._enablement=c.createInstance(Kb),this._usageTimestamps=c.createInstance(Gb)}_disposables=new B;_pendingWork=[];_files=new Fn;_enablement;_usageTimestamps;dispose(){this._disposables.dispose()}isEnabled(t){return!this._enablement.isIgnored(t.snippetIdentifier)}updateEnablement(t,e){this._enablement.updateIgnored(t.snippetIdentifier,!e)}updateUsageTimestamp(t){this._usageTimestamps.updateUsageTimestamp(t.snippetIdentifier)}_joinSnippets(){let t=this._pendingWork.slice(0);return this._pendingWork.length=0,Promise.all(t)}async getSnippetFiles(){return await this._joinSnippets(),this._files.values()}async getSnippets(t,e){await this._joinSnippets();let i=[],n=[];if(t){if(this._languageService.isRegisteredLanguageId(t))for(let o of this._files.values())n.push(o.load().then(s=>s.select(t,i)).catch(s=>this._logService.error(s,o.location.toString())))}else for(let o of this._files.values())n.push(o.load().then(s=>$5(i,i.length,s.data)).catch(s=>this._logService.error(s,o.location.toString())));return await Promise.all(n),this._filterAndSortSnippets(i,e)}getSnippetsSync(t,e){let i=[];if(this._languageService.isRegisteredLanguageId(t))for(let n of this._files.values())n.load().catch(o=>{}),n.select(t,i);return this._filterAndSortSnippets(i,e)}_filterAndSortSnippets(t,e){let i=[];for(let n of t)!n.prefix&&!e?.includeNoPrefixSnippets||!this.isEnabled(n)&&!e?.includeDisabledSnippets||typeof e?.fileTemplateSnippets=="boolean"&&e.fileTemplateSnippets!==n.isFileTemplate||i.push(n);return i.sort((n,o)=>{let s=0;if(!e?.noRecencySort){let a=this._usageTimestamps.getUsageTimestamp(n.snippetIdentifier)??-1;s=(this._usageTimestamps.getUsageTimestamp(o.snippetIdentifier)??-1)-a}return s===0&&(s=this._compareSnippet(n,o)),s})}_compareSnippet(t,e){return t.snippetSource<e.snippetSource?-1:t.snippetSource>e.snippetSource?1:t.source<e.source?-1:t.source>e.source||t.name>e.name?1:t.name<e.name?-1:0}_initExtensionSnippets(){Pj.point.setHandler(t=>{for(let[e,i]of this._files)i.source===3&&this._files.delete(e);for(let e of t)for(let i of e.value){let n=Pj.toValidSnippet(e,i,this._languageService);if(!n)continue;let o=this._files.get(n.location);if(o)o.defaultScopes?o.defaultScopes.push(n.language):o.defaultScopes=[];else{let s=new hx(3,n.location,n.language?[n.language]:void 0,e.description,this._fileService,this._extensionResourceLoaderService);this._files.set(s.location,s),this._environmentService.isExtensionDevelopment&&s.load().then(a=>{a.data.some(l=>l.isBogous)&&e.collector.warn(u("badVariableUse","One or more snippets from the extension '{0}' very likely confuse snippet-variables and snippet-placeholders (see https://code.visualstudio.com/docs/editor/userdefinedsnippets#_snippet-syntax for more details)",e.description.name))},a=>{e.collector.warn(u("badFile",'The snippet file "{0}" could not be read.',s.location.toString()))})}}})}_initWorkspaceSnippets(){let t=new B,e=()=>{t.clear(),this._pendingWork.push(this._initWorkspaceFolderSnippets(this._contextService.getWorkspace(),t))};this._disposables.add(t),this._disposables.add(this._contextService.onDidChangeWorkspaceFolders(e)),this._disposables.add(this._contextService.onDidChangeWorkbenchState(e)),e()}async _initWorkspaceFolderSnippets(t,e){let i=t.folders.map(async n=>{let o=n.toResource(".vscode");await this._fileService.exists(o)?this._initFolderSnippets(2,o,e):e.add(this._fileService.onDidFilesChange(a=>{a.contains(o,1)&&this._initFolderSnippets(2,o,e)}))});await Promise.all(i)}async _initUserSnippets(){let t=new B,e=async()=>{t.clear();let i=this._userDataProfileService.currentProfile.snippetsHome;await this._fileService.createFolder(i),await this._initFolderSnippets(1,i,t)};this._disposables.add(t),this._disposables.add(this._userDataProfileService.onDidChangeCurrentProfile(i=>i.join((async()=>{this._pendingWork.push(e())})()))),await e()}_initFolderSnippets(t,e,i){let n=new B,o=async()=>{if(n.clear(),!!await this._fileService.exists(e))try{let s=await this._fileService.resolve(e);for(let a of s.children||[])n.add(this._addSnippetFile(a.resource,t))}catch(s){this._logService.error(`Failed snippets from folder '${e.toString()}'`,s)}};return i.add(this._textfileService.files.onDidSave(s=>{R4(s.model.resource,e)&&o()})),i.add(Gxe(this._fileService,e,o)),i.add(n),o()}_addSnippetFile(t,e){let i=Sm(t);if(e===1&&i===".json"){let n=Ji(t).replace(/\.json/,"");this._files.set(t,new hx(e,t,[n],void 0,this._fileService,this._extensionResourceLoaderService))}else i===".code-snippets"&&this._files.set(t,new hx(e,t,void 0,void 0,this._fileService,this._extensionResourceLoaderService));return{dispose:()=>this._files.delete(t)}}};oU=E([b(0,$o),b(1,By),b(2,kt),b(3,ti),b(4,bt),b(5,Ei),b(6,Us),b(7,pue),b(8,er),b(9,ne),b(10,Do)],oU);function Eue(r,t){let i=r.getLineContent(t.lineNumber).substr(0,t.column-1),n=Math.max(0,i.length-100);for(let o=i.length-1;o>=n;o--){let s=i.charAt(o);if(/\s/.test(s))return i.substr(o+1)}return n===0?i:""}var Mj=q("IEditorCancelService"),xue=new A("cancellableOperation",!1,u("cancellableOperation","Whether the editor runs a cancellable operation, e.g. like 'Peek References'"));gi(Mj,class{_tokens=new WeakMap;add(r,t){let e=this._tokens.get(r);e||(e=r.invokeWithinContext(n=>{let o=xue.bindTo(n.get(re)),s=new lr;return{key:o,tokens:s}}),this._tokens.set(r,e));let i;return e.key.set(!0),i=e.tokens.push(t),()=>{i&&(i(),e.key.set(!e.tokens.isEmpty()),i=void 0)}}cancel(r){let t=this._tokens.get(r);if(!t)return;let e=t.tokens.pop();e&&(e.cancel(),t.key.set(!t.tokens.isEmpty()))}},1);var rU=class extends Kt{constructor(e,i){super(i);this.editor=e;this._unregister=e.invokeWithinContext(n=>n.get(Mj).add(e,this))}_unregister;dispose(){this._unregister(),super.dispose()}};qe(new class extends _r{constructor(){super({id:"editor.cancelOperation",kbOpts:{weight:100,primary:9},precondition:xue})}runEditorCommand(r,t){r.get(Mj).cancel(t)}});var sU=class r{flags;position;selection;modelVersionId;scrollLeft;scrollTop;constructor(t,e){if(this.flags=e,this.flags&1){let i=t.getModel();this.modelVersionId=i?Sp("{0}#{1}",i.uri.toString(),i.getVersionId()):null}else this.modelVersionId=null;this.flags&4?this.position=t.getPosition():this.position=null,this.flags&2?this.selection=t.getSelection():this.selection=null,this.flags&8?(this.scrollLeft=t.getScrollLeft(),this.scrollTop=t.getScrollTop()):(this.scrollLeft=-1,this.scrollTop=-1)}_equals(t){if(!(t instanceof r))return!1;let e=t;return!(this.modelVersionId!==e.modelVersionId||this.scrollLeft!==e.scrollLeft||this.scrollTop!==e.scrollTop||!this.position&&e.position||this.position&&!e.position||this.position&&e.position&&!this.position.equals(e.position)||!this.selection&&e.selection||this.selection&&!e.selection||this.selection&&e.selection&&!this.selection.equalsRange(e.selection))}validate(t){return this._equals(new r(t,this.flags))}},aU=class extends rU{_listener=new B;constructor(t,e,i,n){super(t,n),e&4&&this._listener.add(t.onDidChangeCursorPosition(o=>{(!i||!L.containsPosition(i,o.position))&&this.cancel()})),e&2&&this._listener.add(t.onDidChangeCursorSelection(o=>{(!i||!L.containsRange(i,o.selection))&&this.cancel()})),e&8&&this._listener.add(t.onDidScrollChange(o=>this.cancel())),e&1&&(this._listener.add(t.onDidChangeModel(o=>this.cancel())),this._listener.add(t.onDidChangeModelContent(o=>this.cancel())))}dispose(){this._listener.dispose(),super.dispose()}};var $d=class{constructor(t,e,i,n,o){this._editor=t;this._snippetService=e;this._clipboardService=i;this._languageFeaturesService=n;this._hasSnippets=$d.ContextKey.bindTo(o),this._configListener=this._editor.onDidChangeConfiguration(s=>{s.hasChanged(125)&&this._update()}),this._update()}static ID="editor.tabCompletionController";static ContextKey=new A("hasSnippetCompletions",void 0);static get(t){return t.getContribution($d.ID)}_hasSnippets;_configListener;_enabled;_selectionListener;_activeSnippets=[];_completionProvider;dispose(){this._configListener.dispose(),this._selectionListener?.dispose()}_update(){let t=this._editor.getOption(125)==="onlySnippets";this._enabled!==t&&(this._enabled=t,this._enabled?(this._selectionListener=this._editor.onDidChangeCursorSelection(e=>this._updateSnippets()),this._editor.getModel()&&this._updateSnippets()):this._selectionListener?.dispose())}_updateSnippets(){if(this._activeSnippets=[],this._completionProvider?.dispose(),!this._editor.hasModel())return;let t=this._editor.getSelection(),e=this._editor.getModel();e.tokenization.tokenizeIfCheap(t.positionLineNumber);let i=e.getLanguageIdAtPosition(t.positionLineNumber,t.positionColumn),n=this._snippetService.getSnippetsSync(i);if(!n){this._hasSnippets.set(!1);return}if(L.isEmpty(t)){let s=Eue(e,t.getPosition());if(s)for(let a of n)s.endsWith(a.prefix)&&this._activeSnippets.push(a)}else if(!L.spansMultipleLines(t)&&e.getValueLengthInRange(t)<=100){let s=e.getValueInRange(t);if(s)for(let a of n)s===a.prefix&&this._activeSnippets.push(a)}let o=this._activeSnippets.length;if(o===0)this._hasSnippets.set(!1);else if(o===1)this._hasSnippets.set(!0);else{this._hasSnippets.set(!0),this._completionProvider={_debugDisplayName:"tabCompletion",dispose:()=>{s.dispose()},provideCompletionItems:(a,l)=>a!==e||!t.containsPosition(l)?void 0:{suggestions:this._activeSnippets.map(c=>{let p=L.fromPositions(l.delta(0,-c.prefix.length),l);return new zb(c,p)})}};let s=this._languageFeaturesService.completionProvider.register({language:e.getLanguageId(),pattern:e.uri.fsPath,scheme:e.uri.scheme},this._completionProvider)}}async performSnippetCompletions(){if(this._editor.hasModel())if(this._activeSnippets.length===1){let[t]=this._activeSnippets,e;if(t.needsClipboard){let i=new sU(this._editor,5);if(e=await this._clipboardService.readText(),!i.validate(this._editor))return}kn.get(this._editor)?.insert(t.codeSnippet,{overwriteBefore:t.prefix.length,overwriteAfter:0,clipboardText:e})}else this._activeSnippets.length>1&&this._completionProvider&&BH(this._editor,this._completionProvider)}};$d=E([b(1,BR),b(2,rs),b(3,ni),b(4,re)],$d);gr($d.ID,$d,0);var $xe=_r.bindToContribution($d.get);qe(new $xe({id:"insertSnippet",precondition:$d.ContextKey,handler:r=>r.performSnippetCompletions(),kbOpts:{weight:100,kbExpr:P.and(ce.editorTextFocus,ce.tabDoesNotMoveFocus,kn.InSnippetMode.toNegated()),primary:2}}));function lU(r){return{wordWrap:"on",overviewRulerLanes:0,glyphMargin:!1,lineNumbers:"off",folding:!1,selectOnLineNumbers:!1,hideCursorInOverviewRuler:!0,selectionHighlight:!1,scrollbar:{horizontal:"hidden",alwaysConsumeMouseWheel:!1},lineDecorationsWidth:0,overviewRulerBorder:!1,scrollBeyondLastLine:!1,renderLineHighlight:"none",fixedOverflowWidgets:!0,acceptSuggestionOnEnter:"smart",dragAndDrop:!1,revealHorizontalRightPadding:5,minimap:{enabled:!1},guides:{indentation:!1},accessibilitySupport:r.getValue("editor.accessibilitySupport"),cursorBlinking:r.getValue("editor.cursorBlinking"),experimentalEditContextEnabled:r.getValue("editor.experimentalEditContextEnabled")}}function dU(){return{isSimpleWidget:!0,contributions:Fm.getSomeEditorContributions([px.ID,uue,Wu.ID,Ba.ID,kn.ID,$d.ID])}}var fx=J,Aj=q("privateBreakpointWidgetService"),Tue="breakpointwidgetdecoration";function jxe(r){return r.getModel().bracketPairs.getBracketPairsInRange(L.fromPositions(r.getPosition())).some(i=>i.openingBracketInfo.bracketText==="{")}function Xxe(r,t){let e=r.getColor(Qo)?.transparent(.4);return[{range:{startLineNumber:0,endLineNumber:0,startColumn:0,endColumn:1},renderOptions:{after:{contentText:t,color:e?e.toString():void 0}}}]}var bx=class extends Fb{constructor(e,i,n,o,s,a,l,d,c,p,h,m,f,g,v,I,y){super(e,{showFrame:!0,showArrow:!1,frameWidth:1,isAccessible:!0});this.lineNumber=i;this.column=n;this.contextViewService=s;this.debugService=a;this.themeService=l;this.contextKeyService=d;this.instantiationService=c;this.modelService=p;this.codeEditorService=h;this._configurationService=m;this.languageFeaturesService=f;this.keybindingService=g;this.labelService=v;this.textModelService=I;this.hoverService=y;this.toDispose=[];let w=this.editor.getModel();if(w){let C=w.uri,S=this.debugService.getModel().getBreakpoints({lineNumber:this.lineNumber,column:this.column,uri:C});this.breakpoint=S.length?S[0]:void 0}o===void 0?this.breakpoint&&!this.breakpoint.condition&&!this.breakpoint.hitCondition&&this.breakpoint.logMessage?this.context=2:this.breakpoint&&!this.breakpoint.condition&&this.breakpoint.hitCondition?this.context=1:this.breakpoint&&this.breakpoint.triggeredBy?this.context=3:this.context=0:this.context=o,this.toDispose.push(this.debugService.getModel().onDidChangeBreakpoints(C=>{this.breakpoint&&C&&C.removed&&C.removed.indexOf(this.breakpoint)>=0&&this.dispose()})),this.codeEditorService.registerDecorationType("breakpoint-widget",Tue,{}),this.create()}selectContainer;inputContainer;selectBreakpointContainer;input;selectBreakpointBox;selectModeBox;toDispose;conditionInput="";hitCountInput="";logMessageInput="";modeInput;breakpoint;context;heightInPx;triggeredByBreakpointInput;get placeholder(){let e=this.keybindingService.lookupKeybinding(cU.ID)?.getLabel()||"Enter",i=this.keybindingService.lookupKeybinding(uU.ID)?.getLabel()||"Escape";switch(this.context){case 2:return u("breakpointWidgetLogMessagePlaceholder","Message to log when breakpoint is hit. Expressions within {} are interpolated. '{0}' to accept, '{1}' to cancel.",e,i);case 1:return u("breakpointWidgetHitCountPlaceholder","Break when hit count condition is met. '{0}' to accept, '{1}' to cancel.",e,i);default:return u("breakpointWidgetExpressionPlaceholder","Break when expression evaluates to true. '{0}' to accept, '{1}' to cancel.",e,i)}}getInputValue(e){switch(this.context){case 2:return e&&e.logMessage?e.logMessage:this.logMessageInput;case 1:return e&&e.hitCondition?e.hitCondition:this.hitCountInput;default:return e&&e.condition?e.condition:this.conditionInput}}rememberInput(){if(this.context!==3){let e=this.input.getModel().getValue();switch(this.context){case 2:this.logMessageInput=e;break;case 1:this.hitCountInput=e;break;default:this.conditionInput=e}}}setInputMode(){if(this.editor.hasModel()){let e=this.context===2?jn:this.editor.getModel().getLanguageId();this.input.getModel().setLanguage(e)}}show(e){let i=this.input.getModel().getLineCount();super.show(e,i+1)}fitHeightToContent(){let e=this.input.getModel().getLineCount();this._relayout(e+1)}_fillContainer(e){this.setCssClass("breakpoint-widget");let i=new th([{text:u("expression","Expression")},{text:u("hitCount","Hit Count")},{text:u("logMessage","Log Message")},{text:u("triggeredBy","Wait for Breakpoint")}],this.context,this.contextViewService,Jm,{ariaLabel:u("breakpointType","Breakpoint Type")});this.selectContainer=fx(".breakpoint-select-container"),i.render(U(e,this.selectContainer)),i.onDidSelect(n=>{this.rememberInput(),this.context=n.index,this.updateContextInput()}),this.createModesInput(e),this.inputContainer=fx(".inputContainer"),this.toDispose.push(this.hoverService.setupManagedHover(gt("mouse"),this.inputContainer,this.placeholder)),this.createBreakpointInput(U(e,this.inputContainer)),this.input.getModel().setValue(this.getInputValue(this.breakpoint)),this.toDispose.push(this.input.getModel().onDidChangeContent(()=>{this.fitHeightToContent()})),this.input.setPosition({lineNumber:1,column:this.input.getModel().getLineMaxColumn(1)}),this.createTriggerBreakpointInput(e),this.updateContextInput(),setTimeout(()=>this.focusInput(),150)}createModesInput(e){let i=this.debugService.getModel().getBreakpointModes("source");if(i.length<=1)return;let n=this.selectModeBox=new th([{text:u("bpMode","Mode"),isDisabled:!0},...i.map(a=>({text:a.label,description:a.description}))],i.findIndex(a=>a.mode===this.breakpoint?.mode)+1,this.contextViewService,Jm);this.toDispose.push(n),this.toDispose.push(n.onDidSelect(a=>{this.modeInput=i[a.index-1]}));let o=fx(".select-mode-container"),s=fx(".select-box-container");U(o,s),n.render(s),U(e,o)}createTriggerBreakpointInput(e){let i=this.debugService.getModel().getBreakpoints().filter(d=>d!==this.breakpoint&&!d.logMessage),n=[{text:u("noTriggerByBreakpoint","None"),isDisabled:!0},...i.map(d=>({text:`${this.labelService.getUriLabel(d.uri,{relative:!0})}: ${d.lineNumber}`,description:u("triggerByLoading","Loading...")}))],o=i.findIndex(d=>this.breakpoint?.triggeredBy===d.getId());for(let[d,c]of i.entries())this.textModelService.createModelReference(c.uri).then(p=>{try{n[d+1].description=p.object.textEditorModel.getLineContent(c.lineNumber).trim()}finally{p.dispose()}}).catch(()=>{n[d+1].description=u("noBpSource","Could not load source.")});let s=this.selectBreakpointBox=new th(n,o+1,this.contextViewService,Jm,{ariaLabel:u("selectBreakpoint","Select breakpoint")});s.onDidSelect(d=>{d.index===0?this.triggeredByBreakpointInput=void 0:this.triggeredByBreakpointInput=i[d.index-1]}),this.toDispose.push(s),this.selectBreakpointContainer=fx(".select-breakpoint-container"),this.toDispose.push(F(this.selectBreakpointContainer,Q.KEY_DOWN,d=>{new ut(d).equals(9)&&this.close(!1)}));let a=fx(".select-box-container");U(this.selectBreakpointContainer,a),s.render(a),U(e,this.selectBreakpointContainer);let l=new zI(this.selectBreakpointContainer,dF);l.label=u("ok","Ok"),this.toDispose.push(l.onDidClick(()=>this.close(!0))),this.toDispose.push(l)}updateContextInput(){if(this.context===3)this.inputContainer.hidden=!0,this.selectBreakpointContainer.hidden=!1;else{this.inputContainer.hidden=!1,this.selectBreakpointContainer.hidden=!0,this.setInputMode();let e=this.getInputValue(this.breakpoint);this.input.getModel().setValue(e),this.focusInput()}}_doLayout(e,i){this.heightInPx=e,this.input.layout({height:e,width:i-113}),this.centerInputVertically()}_onWidth(e){typeof this.heightInPx=="number"&&this._doLayout(this.heightInPx,e)}createBreakpointInput(e){let i=this.contextKeyService.createScoped(e);this.toDispose.push(i);let n=this.instantiationService.createChild(new el([re,i],[Aj,this]));this.toDispose.push(n);let o=this.createEditorOptions(),s=dU();this.input=n.createInstance($s,e,o,s),pq.bindTo(i).set(!0);let a=this.modelService.createModel("",null,Z.parse(`${Gs}:${this.editor.getId()}:breakpointinput`),!0);this.editor.hasModel()&&a.setLanguage(this.editor.getModel().getLanguageId()),this.input.setModel(a),this.setInputMode(),this.toDispose.push(a);let l=()=>{let c=this.input.getModel().getValue()?[]:Xxe(this.themeService.getColorTheme(),this.placeholder);this.input.setDecorationsByType("breakpoint-widget",Tue,c)};this.input.getModel().onDidChangeContent(()=>l()),this.themeService.onDidColorThemeChange(()=>l()),this.toDispose.push(this.languageFeaturesService.completionProvider.register({scheme:Gs,hasAccessToAllModels:!0},{_debugDisplayName:"breakpointWidget",provideCompletionItems:(d,c,p,h)=>{let m,f=this.editor.getModel();return f&&(this.context===0||this.context===2&&jxe(this.input))?m=xR(this.languageFeaturesService.completionProvider,f,new H(this.lineNumber,1),new Ay(void 0,new Set().add(27)),p,h).then(g=>{let v=0;if(this.context===0)v=c.column-1;else{let I=this.input.getModel().getValue();for(;c.column-2-v>=0&&I[c.column-2-v]!=="{"&&I[c.column-2-v]!==" ";)v++}return{suggestions:g.items.map(I=>(I.completion.range=L.fromPositions(c.delta(0,-v),c),I.completion))}}):m=Promise.resolve({suggestions:[]}),m}})),this.toDispose.push(this._configurationService.onDidChangeConfiguration(d=>{(d.affectsConfiguration("editor.fontSize")||d.affectsConfiguration("editor.lineHeight"))&&(this.input.updateOptions(this.createEditorOptions()),this.centerInputVertically())}))}createEditorOptions(){let e=this._configurationService.getValue("editor"),i=lU(this._configurationService);return i.fontSize=e.fontSize,i.fontFamily=e.fontFamily,i.lineHeight=e.lineHeight,i.fontLigatures=e.fontLigatures,i.ariaLabel=this.placeholder,i}centerInputVertically(){if(this.container&&typeof this.heightInPx=="number"){let e=this.input.getOption(68),i=this.input.getModel().getLineCount(),n=(this.heightInPx-i*e)/2;this.inputContainer.style.marginTop=n+"px"}}close(e){if(e){let i,n,o,s,a,l;if(this.rememberInput(),(this.conditionInput||this.context===0)&&(i=this.conditionInput),(this.hitCountInput||this.context===1)&&(n=this.hitCountInput),(this.logMessageInput||this.context===2)&&(o=this.logMessageInput),this.selectModeBox&&(a=this.modeInput?.mode,l=this.modeInput?.label),this.context===3&&(i=void 0,n=void 0,o=void 0,s=this.triggeredByBreakpointInput?.getId()),this.breakpoint){let d=new Map;d.set(this.breakpoint.getId(),{condition:i,hitCondition:n,logMessage:o,triggeredBy:s,mode:a,modeLabel:l}),this.debugService.updateBreakpoints(this.breakpoint.originalUri,d,!1).then(void 0,Xe)}else{let d=this.editor.getModel();d&&this.debugService.addBreakpoints(d.uri,[{lineNumber:this.lineNumber,column:this.column,enabled:!0,condition:i,hitCondition:n,logMessage:o,triggeredBy:s,mode:a,modeLabel:l}])}}this.dispose()}focusInput(){this.context===3?this.selectBreakpointBox.focus():this.input.focus()}dispose(){super.dispose(),this.input.dispose(),_e(this.toDispose),setTimeout(()=>this.editor.focus(),0)}};bx=E([b(4,so),b(5,we),b(6,Fe),b(7,re),b(8,ne),b(9,qi),b(10,En),b(11,se),b(12,ni),b(13,Be),b(14,hi),b(15,Tr),b(16,Nt)],bx);var cU=class r extends _r{static ID="breakpointWidget.action.acceptInput";constructor(){super({id:r.ID,precondition:jL,kbOpts:{kbExpr:pq,primary:3,weight:100}})}runEditorCommand(t,e){t.get(Aj).close(!0)}},uU=class r extends _r{static ID="closeBreakpointWidget";constructor(){super({id:r.ID,precondition:jL,kbOpts:{kbExpr:ce.textInputFocus,primary:9,secondary:[1033],weight:100}})}runEditorCommand(t,e,i){let n=e.getContribution(Gd);if(n)return n.closeBreakpointWidget();t.get(Aj).close(!1)}};qe(new cU);qe(new uU);var Yxe=J,Qxe={description:"breakpoint-helper-decoration",glyphMarginClassName:de.asClassName(ML),glyphMargin:{position:3},glyphMarginHoverMessage:new Sn().appendText(u("breakpointHelper","Click to add a breakpoint")),stickiness:1};function Zxe(r,t,e,i,n,o){let s=[];return e.forEach(a=>{if(a.lineNumber>t.getLineCount())return;let l=e.some(p=>p!==a&&p.lineNumber===a.lineNumber),d=t.getLineFirstNonWhitespaceColumn(a.lineNumber),c=t.validateRange(a.column?new L(a.lineNumber,a.column,a.lineNumber,a.column+1):new L(a.lineNumber,d,a.lineNumber,d+1));s.push({options:Jxe(r,t,a,i,n,o,l),range:c})}),s}function Jxe(r,t,e,i,n,o,s){let a=r.get(we),l=r.get(ti),d=r.get(hi),{icon:c,message:p,showAdapterUnverifiedMessage:h}=Dh(i,n,e,d,a.getModel()),m,f;if(h){let I;f=a.getModel().getSessions().map(y=>{let w=a.getAdapterManager().getDebugger(y.configuration.type),C=w?.strings?.unverifiedBreakpoints;if(C)return I||(I=l.guessLanguageIdByFilepathOrFirstLine(e.uri)??void 0),I&&w.interestedInLanguage(I)?C:void 0}).find(y=>!!y)}if(p)if(m=new Sn(void 0,{isTrusted:!0,supportThemeIcons:!0}),e.condition||e.hitCondition){let I=t.getLanguageId();m.appendCodeblock(I,p),f&&m.appendMarkdown("$(warning) "+f)}else m.appendText(p),f&&m.appendMarkdown(`

$(warning) `+f);else f&&(m=new Sn(void 0,{isTrusted:!0,supportThemeIcons:!0}).appendMarkdown(f));let g=null;o&&(g={color:_d(Due),position:1});let v=e.column&&(s||e.column>t.getLineFirstNonWhitespaceColumn(e.lineNumber));return{description:"breakpoint-decoration",glyphMargin:{position:3},glyphMarginClassName:de.asClassName(c),glyphMarginHoverMessage:m,stickiness:1,before:v?{content:Jg,inlineClassName:"debug-breakpoint-placeholder",inlineClassNameAffectsLetterSpacing:!0}:void 0,overviewRuler:g,zIndex:9999}}async function eTe(r,t,e){return e.capabilities.supportsBreakpointLocationsRequest?await Promise.all(Mo(t,i=>i).map(async i=>{try{return{lineNumber:i,positions:await e.breakpointsLocations(r.uri,i)}}catch{return{lineNumber:i,positions:[]}}})):[]}function tTe(r,t,e){let i=[];for(let{positions:n,lineNumber:o}of e){if(n.length===0)continue;let s=r.getLineFirstNonWhitespaceColumn(o),a=r.getLineLastNonWhitespaceColumn(o);n.forEach(l=>{let d=new L(l.lineNumber,l.column,l.lineNumber,l.column+1);if(l.column<=s&&!t.some(p=>p.range.startColumn>s&&p.range.startLineNumber===l.lineNumber)||l.column>a)return;let c=t.find(p=>p.range.equalsRange(d));c&&c.inlineWidget||i.push({range:d,options:{description:"breakpoint-placeholder-decoration",stickiness:1,before:c?void 0:{content:Jg,inlineClassName:"debug-breakpoint-placeholder",inlineClassNameAffectsLetterSpacing:!0}},breakpoint:c?c.breakpoint:void 0})})}return i}var vx=class{constructor(t,e,i,n,o,s,a,l){this.editor=t;this.debugService=e;this.contextMenuService=i;this.instantiationService=n;this.dialogService=s;this.configurationService=a;this.labelService=l;this.breakpointWidgetVisible=jL.bindTo(o),this.setDecorationsScheduler=new Ye(()=>this.setDecorations(),30),this.setDecorationsScheduler.schedule(),this.registerListeners()}breakpointHintDecoration=null;breakpointWidget;breakpointWidgetVisible;toDispose=[];ignoreDecorationsChangedEvent=!1;ignoreBreakpointsChangeEvent=!1;breakpointDecorations=[];candidateDecorations=[];setDecorationsScheduler;getContextMenuActionsAtPosition(t,e){if(!this.debugService.getAdapterManager().hasEnabledDebuggers())return[];if(!this.debugService.canSetBreakpointsIn(e))return[];let i=this.debugService.getModel().getBreakpoints({lineNumber:t,uri:e.uri});return this.getContextMenuActions(i,e.uri,t)}registerListeners(){this.toDispose.push(this.editor.onMouseDown(async t=>{if(!this.debugService.getAdapterManager().hasEnabledDebuggers())return;let e=this.editor.getModel();if(!t.target.position||!e||t.target.type!==2||t.target.detail.isAfterLines||!this.marginFreeFromNonDebugDecorations(t.target.position.lineNumber)&&!t.target.element?.className.includes("breakpoint"))return;let i=this.debugService.canSetBreakpointsIn(e),n=t.target.position.lineNumber,o=e.uri;if(!(t.event.rightButton||ye&&t.event.leftButton&&t.event.ctrlKey)){let s=this.debugService.getModel().getBreakpoints({uri:o,lineNumber:n});if(s.length){let a=t.event.shiftKey,l=s.some(d=>d.enabled);if(a)s.forEach(d=>this.debugService.enableOrDisableBreakpoints(!l,d));else if(!ci&&s.some(d=>!!d.condition||!!d.logMessage||!!d.hitCondition||!!d.triggeredBy)){let d=s.every(m=>!!m.logMessage),c=d?u("logPoint","Logpoint"):u("breakpoint","Breakpoint"),p=u("breakpointHasConditionDisabled","This {0} has a {1} that will get lost on remove. Consider enabling the {0} instead.",c.toLowerCase(),d?u("message","message"):u("condition","condition")),h=u("breakpointHasConditionEnabled","This {0} has a {1} that will get lost on remove. Consider disabling the {0} instead.",c.toLowerCase(),d?u("message","message"):u("condition","condition"));await this.dialogService.prompt({type:Si.Info,message:l?h:p,buttons:[{label:u({key:"removeLogPoint",comment:["&& denotes a mnemonic"]},"&&Remove {0}",c),run:()=>s.forEach(m=>this.debugService.removeBreakpoints(m.getId()))},{label:u("disableLogPoint","{0} {1}",l?u({key:"disable",comment:["&& denotes a mnemonic"]},"&&Disable"):u({key:"enable",comment:["&& denotes a mnemonic"]},"&&Enable"),c),run:()=>s.forEach(m=>this.debugService.enableOrDisableBreakpoints(!l,m))}],cancelButton:!0})}else l?s.forEach(d=>this.debugService.removeBreakpoints(d.getId())):s.forEach(d=>this.debugService.enableOrDisableBreakpoints(!l,d))}else if(i)if(t.event.middleButton){let a=this.configurationService.getValue("debug").gutterMiddleClickAction;if(a!=="none"){let l;switch(a){case"logpoint":l=2;break;case"conditionalBreakpoint":l=0;break;case"triggeredBreakpoint":l=3}this.showBreakpointWidget(n,void 0,l)}}else this.debugService.addBreakpoints(o,[{lineNumber:n}])}})),Qc.pointerEvents&&ms||(this.toDispose.push(this.editor.onMouseMove(t=>{if(!this.debugService.getAdapterManager().hasEnabledDebuggers())return;let e=-1,i=this.editor.getModel();i&&t.target.position&&(t.target.type===2||t.target.type===3)&&this.debugService.canSetBreakpointsIn(i)&&this.marginFreeFromNonDebugDecorations(t.target.position.lineNumber)&&(t.target.detail.isAfterLines||(e=t.target.position.lineNumber)),this.ensureBreakpointHintDecoration(e)})),this.toDispose.push(this.editor.onMouseLeave(()=>{this.ensureBreakpointHintDecoration(-1)}))),this.toDispose.push(this.editor.onDidChangeModel(async()=>{this.closeBreakpointWidget(),await this.setDecorations()})),this.toDispose.push(this.debugService.getModel().onDidChangeBreakpoints(()=>{!this.ignoreBreakpointsChangeEvent&&!this.setDecorationsScheduler.isScheduled()&&this.setDecorationsScheduler.schedule()})),this.toDispose.push(this.debugService.onDidChangeState(()=>{this.setDecorationsScheduler.isScheduled()||this.setDecorationsScheduler.schedule()})),this.toDispose.push(this.editor.onDidChangeModelDecorations(()=>this.onModelDecorationsChanged())),this.toDispose.push(this.configurationService.onDidChangeConfiguration(async t=>{(t.affectsConfiguration("debug.showBreakpointsInOverviewRuler")||t.affectsConfiguration("debug.showInlineBreakpointCandidates"))&&await this.setDecorations()}))}getContextMenuActions(t,e,i,n){let o=[];if(t.length===1){let s=t[0].logMessage?u("logPoint","Logpoint"):u("breakpoint","Breakpoint");o.push(new et("debug.removeBreakpoint",u("removeBreakpoint","Remove {0}",s),void 0,!0,async()=>{await this.debugService.removeBreakpoints(t[0].getId())})),o.push(new et("workbench.debug.action.editBreakpointAction",u("editBreakpoint","Edit {0}...",s),void 0,!0,()=>Promise.resolve(this.showBreakpointWidget(t[0].lineNumber,t[0].column)))),o.push(new et("workbench.debug.viewlet.action.toggleBreakpoint",t[0].enabled?u("disableBreakpoint","Disable {0}",s):u("enableBreakpoint","Enable {0}",s),void 0,!0,()=>this.debugService.enableOrDisableBreakpoints(!t[0].enabled,t[0])))}else if(t.length>1){let s=t.slice().sort((a,l)=>a.column&&l.column?a.column-l.column:1);o.push(new vo("debug.removeBreakpoints",u("removeBreakpoints","Remove Breakpoints"),s.map(a=>new et("removeInlineBreakpoint",a.column?u("removeInlineBreakpointOnColumn","Remove Inline Breakpoint on Column {0}",a.column):u("removeLineBreakpoint","Remove Line Breakpoint"),void 0,!0,()=>this.debugService.removeBreakpoints(a.getId()))))),o.push(new vo("debug.editBreakpoints",u("editBreakpoints","Edit Breakpoints"),s.map(a=>new et("editBreakpoint",a.column?u("editInlineBreakpointOnColumn","Edit Inline Breakpoint on Column {0}",a.column):u("editLineBreakpoint","Edit Line Breakpoint"),void 0,!0,()=>Promise.resolve(this.showBreakpointWidget(a.lineNumber,a.column)))))),o.push(new vo("debug.enableDisableBreakpoints",u("enableDisableBreakpoints","Enable/Disable Breakpoints"),s.map(a=>new et(a.enabled?"disableColumnBreakpoint":"enableColumnBreakpoint",a.enabled?a.column?u("disableInlineColumnBreakpoint","Disable Inline Breakpoint on Column {0}",a.column):u("disableBreakpointOnLine","Disable Line Breakpoint"):a.column?u("enableBreakpoints","Enable Inline Breakpoint on Column {0}",a.column):u("enableBreakpointOnLine","Enable Line Breakpoint"),void 0,!0,()=>this.debugService.enableOrDisableBreakpoints(!a.enabled,a)))))}else o.push(new et("addBreakpoint",u("addBreakpoint","Add Breakpoint"),void 0,!0,()=>this.debugService.addBreakpoints(e,[{lineNumber:i,column:n}]))),o.push(new et("addConditionalBreakpoint",u("addConditionalBreakpoint","Add Conditional Breakpoint..."),void 0,!0,()=>Promise.resolve(this.showBreakpointWidget(i,n,0)))),o.push(new et("addLogPoint",u("addLogPoint","Add Logpoint..."),void 0,!0,()=>Promise.resolve(this.showBreakpointWidget(i,n,2)))),o.push(new et("addTriggeredBreakpoint",u("addTriggeredBreakpoint","Add Triggered Breakpoint..."),void 0,!0,()=>Promise.resolve(this.showBreakpointWidget(i,n,3))));return this.debugService.state===2&&(o.push(new Qt),o.push(new et("runToLine",u("runToLine","Run to Line"),void 0,!0,()=>this.debugService.runTo(e,i).catch(Xe)))),o}marginFreeFromNonDebugDecorations(t){let e=this.editor.getLineDecorations(t);if(e)for(let{options:i}of e){let n=i.glyphMarginClassName;if(!n)continue;if(!(n.includes("codicon-")||n.startsWith("coverage-deco-"))||n.includes("codicon-testing-")||n.includes("codicon-merge-")||n.includes("codicon-arrow-")||n.includes("codicon-loading")||n.includes("codicon-fold")||n.includes("codicon-gutter-lightbulb")||n.includes("codicon-lightbulb-sparkle"))return!1}return!0}ensureBreakpointHintDecoration(t){this.editor.changeDecorations(e=>{this.breakpointHintDecoration&&(e.removeDecoration(this.breakpointHintDecoration),this.breakpointHintDecoration=null),t!==-1&&(this.breakpointHintDecoration=e.addDecoration({startLineNumber:t,startColumn:1,endLineNumber:t,endColumn:1},Qxe))})}async setDecorations(){if(!this.editor.hasModel())return;let t=(c,p)=>{let h=tTe(i,this.breakpointDecorations,p),m=c.deltaDecorations(this.candidateDecorations.map(f=>f.decorationId),h);this.candidateDecorations.forEach(f=>{f.inlineWidget.dispose()}),this.candidateDecorations=m.map((f,g)=>{let v=h[g],I=v.breakpoint?Dh(this.debugService.state,this.debugService.getModel().areBreakpointsActivated(),v.breakpoint,this.labelService,this.debugService.getModel()).icon:_c.disabled,y=()=>this.getContextMenuActions(v.breakpoint?[v.breakpoint]:[],e.getModel().uri,v.range.startLineNumber,v.range.startColumn),w=new zR(e,f,de.asClassName(I),v.breakpoint,this.debugService,this.contextMenuService,y);return{decorationId:f,inlineWidget:w}})},e=this.editor,i=e.getModel(),n=this.debugService.getModel().getBreakpoints({uri:i.uri}),o=this.configurationService.getValue("debug"),s=this.instantiationService.invokeFunction(c=>Zxe(c,i,n,this.debugService.state,this.debugService.getModel().areBreakpointsActivated(),o.showBreakpointsInOverviewRuler)),a=this.debugService.getViewModel().focusedSession,l=o.showInlineBreakpointCandidates&&a?eTe(this.editor.getModel(),s.map(c=>c.range.startLineNumber),a):Promise.resolve([]),d=await Promise.race([l,To(500).then(()=>{})]);d===void 0&&l.then(c=>e.changeDecorations(p=>t(p,c)));try{this.ignoreDecorationsChangedEvent=!0,e.changeDecorations(c=>{let p=c.deltaDecorations(this.breakpointDecorations.map(h=>h.decorationId),s);this.breakpointDecorations.forEach(h=>{h.inlineWidget?.dispose()}),this.breakpointDecorations=p.map((h,m)=>{let f,g=n[m];if(s[m].options.before){let v=()=>this.getContextMenuActions([g],e.getModel().uri,g.lineNumber,g.column);f=new zR(e,h,s[m].options.glyphMarginClassName,g,this.debugService,this.contextMenuService,v)}return{decorationId:h,breakpoint:g,range:s[m].range,inlineWidget:f}}),d&&t(c,d)})}finally{this.ignoreDecorationsChangedEvent=!1}for(let c of this.breakpointDecorations)c.inlineWidget&&this.editor.layoutContentWidget(c.inlineWidget)}async onModelDecorationsChanged(){if(this.breakpointDecorations.length===0||this.ignoreDecorationsChangedEvent||!this.editor.hasModel())return;let t=!1,e=this.editor.getModel();if(this.breakpointDecorations.forEach(n=>{if(t)return;let o=e.getDecorationRange(n.decorationId);o&&!n.range.equalsRange(o)&&(t=!0,n.range=o)}),!t)return;let i=new Map;for(let n=0,o=this.breakpointDecorations.length;n<o;n++){let s=this.breakpointDecorations[n],a=e.getDecorationRange(s.decorationId);a&&s.breakpoint&&i.set(s.breakpoint.getId(),{lineNumber:a.startLineNumber,column:s.breakpoint.column?a.startColumn:void 0})}try{this.ignoreBreakpointsChangeEvent=!0,await this.debugService.updateBreakpoints(e.uri,i,!0)}finally{this.ignoreBreakpointsChangeEvent=!1}}showBreakpointWidget(t,e,i){this.breakpointWidget?.dispose(),this.breakpointWidget=this.instantiationService.createInstance(bx,this.editor,t,e,i),this.breakpointWidget.show({lineNumber:t,column:1}),this.breakpointWidgetVisible.set(!0)}closeBreakpointWidget(){this.breakpointWidget&&(this.breakpointWidget.dispose(),this.breakpointWidget=void 0,this.breakpointWidgetVisible.reset(),this.editor.focus())}dispose(){this.breakpointWidget?.dispose(),this.editor.removeDecorations(this.breakpointDecorations.map(t=>t.decorationId)),_e(this.toDispose)}};vx=E([b(1,we),b(2,vt),b(3,ne),b(4,re),b(5,Io),b(6,se),b(7,hi)],vx);e6.registerGutterActionsGenerator(({lineNumber:r,editor:t,accessor:e},i)=>{let n=t.getModel(),o=e.get(we);if(!n||!o.getAdapterManager().hasEnabledDebuggers()||!o.canSetBreakpointsIn(n))return;let s=t.getContribution(Gd);if(!s)return;let a=s.getContextMenuActionsAtPosition(r,n);for(let l of a)i.push(l,"2_debug")});var zR=class{constructor(t,e,i,n,o,s,a){this.editor=t;this.decorationId=e;this.breakpoint=n;this.debugService=o;this.contextMenuService=s;this.getContextMenuActions=a;this.range=this.editor.getModel().getDecorationRange(e),this.toDispose.push(this.editor.onDidChangeModelDecorations(()=>{let d=this.editor.getModel().getDecorationRange(this.decorationId);this.range&&!this.range.equalsRange(d)&&(this.range=d,this.editor.layoutContentWidget(this))})),this.create(i),this.editor.addContentWidget(this),this.editor.layoutContentWidget(this)}allowEditorOverflow=!1;suppressMouseDown=!0;domNode;range;toDispose=[];create(t){this.domNode=Yxe(".inline-breakpoint-widget"),t&&this.domNode.classList.add(...t.split(" ")),this.toDispose.push(F(this.domNode,Q.CLICK,async i=>{switch(this.breakpoint?.enabled){case void 0:await this.debugService.addBreakpoints(this.editor.getModel().uri,[{lineNumber:this.range.startLineNumber,column:this.range.startColumn}]);break;case!0:await this.debugService.removeBreakpoints(this.breakpoint.getId());break;case!1:this.debugService.enableOrDisableBreakpoints(!0,this.breakpoint);break}})),this.toDispose.push(F(this.domNode,Q.CONTEXT_MENU,i=>{let n=new _i(ue(this.domNode),i),o=this.getContextMenuActions();this.contextMenuService.showContextMenu({getAnchor:()=>n,getActions:()=>o,getActionsContext:()=>this.breakpoint,onHide:()=>QM(o)})}));let e=()=>{let i=this.editor.getOption(68);this.domNode.style.height=`${i}px`,this.domNode.style.width=`${Math.ceil(.8*i)}px`,this.domNode.style.marginLeft="4px"};e(),this.toDispose.push(this.editor.onDidChangeConfiguration(i=>{(i.hasChanged(53)||i.hasChanged(68))&&e()}))}getId(){return Ni()}getDomNode(){return this.domNode}getPosition(){return this.range?(this.domNode.classList.toggle("line-start",this.range.startColumn===1),{position:{lineNumber:this.range.startLineNumber,column:this.range.startColumn-1},preference:[0]}):null}dispose(){this.editor.removeContentWidget(this),_e(this.toDispose)}};E([Re],zR.prototype,"getId",1);Zo((r,t)=>{let e=".monaco-editor .glyph-margin-widgets, .monaco-workbench .debug-breakpoints, .monaco-workbench .disassembly-view, .monaco-editor .contentWidgets",i=r.getColor(Due);i&&(t.addRule(`${e} {
			${_B.map(l=>`${de.asCSSSelector(l.regular)}`).join(`,
		`)},
			${de.asCSSSelector(TB)},
			${de.asCSSSelector(ML)}:not([class*='codicon-debug-breakpoint']):not([class*='codicon-debug-stackframe']),
			${de.asCSSSelector(_c.regular)}${de.asCSSSelector(ny)}::after,
			${de.asCSSSelector(_c.regular)}${de.asCSSSelector(iy)}::after {
				color: ${i} !important;
			}
		}`),t.addRule(`${e} {
			${de.asCSSSelector(_c.pending)} {
				color: ${i} !important;
				font-size: 12px !important;
			}
		}`));let n=r.getColor(iTe);n&&t.addRule(`${e} {
			${_B.map(l=>de.asCSSSelector(l.disabled)).join(`,
		`)} {
				color: ${n};
			}
		}`);let o=r.getColor(nTe);o&&t.addRule(`${e} {
			${_B.map(l=>de.asCSSSelector(l.unverified)).join(`,
		`)} {
				color: ${o};
			}
		}`);let s=r.getColor(oTe);s&&t.addRule(`
		.monaco-editor .debug-top-stack-frame-column {
			color: ${s} !important;
		}
		${e} {
			${de.asCSSSelector(iy)} {
				color: ${s} !important;
			}
		}
		`);let a=r.getColor(rTe);a&&t.addRule(`${e} {
			${de.asCSSSelector(ny)} {
				color: ${a} !important;
			}
		}`)});var Due=T("debugIcon.breakpointForeground","#E51400",u("debugIcon.breakpointForeground","Icon color for breakpoints.")),iTe=T("debugIcon.breakpointDisabledForeground","#848484",u("debugIcon.breakpointDisabledForeground","Icon color for disabled breakpoints.")),nTe=T("debugIcon.breakpointUnverifiedForeground","#848484",u("debugIcon.breakpointUnverifiedForeground","Icon color for unverified breakpoints.")),oTe=T("debugIcon.breakpointCurrentStackframeForeground",{dark:"#FFCC00",light:"#BE8700",hcDark:"#FFCC00",hcLight:"#BE8700"},u("debugIcon.breakpointCurrentStackframeForeground","Icon color for the current breakpoint stack frame.")),rTe=T("debugIcon.breakpointStackframeForeground","#89D185",u("debugIcon.breakpointStackframeForeground","Icon color for all breakpoint stack frames."));var sTe=Xle;var tIn=q("extensionManagementServerService"),iIn=Ao.asBrowserUri("vs/workbench/services/extensionManagement/common/media/defaultIcon.png").toString(!0),nIn=sTe,oIn={id:"extensions",order:30,title:u("extensionsConfigurationTitle","Extensions"),type:"object"};var rIn=q("extensionEnablementService"),sIn=q("IWebExtensionsScannerService");var xIn=ke("extensions-editor-label-icon",N.extensions,u("extensionsEditorLabelIcon","Icon of the extensions editor label."));var KR=q("extensionsWorkbenchService");var pU=class extends R{constructor(e,i){super();this.containers=e;this._register(i.onChange(this.update,this))}set extension(e){this.containers.forEach(i=>i.extension=e)}update(e){for(let i of this.containers)e&&i.extension?O9(i.extension.identifier,e.identifier)&&(i.extension.server&&e.server&&i.extension.server!==e.server?i.updateWhenCounterExtensionChanges&&i.update():i.extension=e):i.update()}};pU=E([b(1,KR)],pU);var hyn=new A("hasOutdatedExtensions",!1),myn=new A("hasGallery",!1);var gyn=new V("extensionsSearchActionsMenu");var hU=class extends ww{constructor(e,i,n,o,s,a,l,d){super(e,i,s,n);this.storageService=n;this.instantiationService=o;this.contextMenuService=a;this.extensionService=l;this.contextService=d}viewPaneContainer;create(e){super.create(e),this.viewPaneContainer=this._register(this.createViewPaneContainer(e)),this._register(this.viewPaneContainer.onTitleAreaUpdate(()=>this.updateTitleArea())),this.viewPaneContainer.create(e)}setVisible(e){super.setVisible(e),this.viewPaneContainer?.setVisible(e)}layout(e){this.viewPaneContainer?.layout(e)}setBoundarySashes(e){this.viewPaneContainer?.setBoundarySashes(e)}getOptimalWidth(){return this.viewPaneContainer?.getOptimalWidth()??0}openView(e,i){return this.viewPaneContainer?.openView(e,i)}getViewPaneContainer(){return this.viewPaneContainer}getActionsContext(){return this.getViewPaneContainer()?.getActionsContext()}getContextMenuActions(){return this.viewPaneContainer?.menuActions?.getContextMenuActions()??[]}getMenuIds(){let e=[];return this.viewPaneContainer?.menuActions&&(e.push(this.viewPaneContainer.menuActions.menuId),this.viewPaneContainer.isViewMergedWithContainer()&&e.push(this.viewPaneContainer.panes[0].menuActions.menuId)),e}getActions(){let e=[];if(this.viewPaneContainer?.menuActions&&(e.push(...this.viewPaneContainer.menuActions.getPrimaryActions()),this.viewPaneContainer.isViewMergedWithContainer())){let i=this.viewPaneContainer.panes[0];i.shouldShowFilterInHeader()&&e.push(zF),e.push(...i.menuActions.getPrimaryActions())}return e}getSecondaryActions(){if(!this.viewPaneContainer?.menuActions)return[];let e=this.viewPaneContainer.isViewMergedWithContainer()?this.viewPaneContainer.panes[0].menuActions.getSecondaryActions():[],i=this.viewPaneContainer.menuActions.getSecondaryActions(),n=i.findIndex(o=>o instanceof to&&o.item.submenu===TL);if(n!==-1){let o=i[n];o.actions.some(({enabled:s})=>s)?i.length===1&&e.length===0?i=o.actions.slice():n!==0&&(i=[o,...i.slice(0,n),...i.slice(n+1)]):i.splice(n,1)}return i.length&&e.length?[...i,new Qt,...e]:i.length?i:e}getActionViewItem(e,i){return this.viewPaneContainer?.getActionViewItem(e,i)}getTitle(){return this.viewPaneContainer?.getTitle()??""}focus(){super.focus(),this.viewPaneContainer?.focus()}};hU=E([b(1,Tt),b(2,nt),b(3,ne),b(4,Fe),b(5,vt),b(6,_n),b(7,kt)],hU);var Oj={Viewlets:"workbench.contributions.viewlets",Panels:"workbench.contributions.panels",Auxiliary:"workbench.contributions.auxiliary"},GR=class extends M1{registerPaneComposite(t){super.registerComposite(t)}deregisterPaneComposite(t){super.deregisterComposite(t)}getPaneComposite(t){return this.getComposite(t)}getPaneComposites(){return this.getComposites()}};Pe.add(Oj.Viewlets,new GR);Pe.add(Oj.Panels,new GR);Pe.add(Oj.Auxiliary,new GR);var ed=q("paneCompositePartService");async function Lue(r){let t=r.get(ki),e=r.get(we),i=r.get($e),n=e.getModel().getSessions(!1),o=r.get(qi),s=r.get(ti),a=r.get(hi),l=new B,d=t.createQuickPick({useSeparators:!0});l.add(d),d.matchOnLabel=d.matchOnDescription=d.matchOnDetail=d.sortByLabel=!1,d.placeholder=u("moveFocusedView.selectView","Search loaded scripts by name"),d.items=await kue(d.value,n,i,o,s,a),l.add(d.onDidChangeValue(async()=>{d.items=await kue(d.value,n,i,o,s,a)})),l.add(d.onDidAccept(()=>{d.selectedItems[0].accept(),d.hide(),l.dispose()})),d.show()}async function aTe(r,t,e,i,n,o){let s=[];return s.push({type:"separator",label:r.name}),(await r.getLoadedSources()).forEach(l=>{let d=lTe(l,t,e,i,n,o);d&&s.push(d)}),s}async function kue(r,t,e,i,n,o){let s=[],a=await Promise.all(t.map(l=>aTe(l,r,e,i,n,o)));for(let l of a)for(let d of l)s.push(d);return s}function lTe(r,t,e,i,n,o){let s=o.getUriBasenameLabel(r.uri),a=o.getUriLabel(Hn(r.uri)),l=_l(t,s,!0),d=_l(t,a,!0);if(l||d)return{label:s,description:a==="."?void 0:a,highlights:{label:l??void 0,description:d??void 0},iconClasses:ua(i,n,r.uri),accept:()=>{r.available&&r.openInEditor(e,{startLineNumber:0,startColumn:0,endLineNumber:0,endColumn:0})}}}async function Pue(r,t){let e=r.get(ki),i=r.get(we),n=r.get(Mi),o=r.get(ct),s=new B,a=e.createQuickPick({useSeparators:!0});s.add(a),a.matchOnLabel=a.matchOnDescription=a.matchOnDetail=a.sortByLabel=!1,a.placeholder=u("moveFocusedView.selectView","Search debug sessions by name");let l=Rue(a.value,t,i,n,o);a.items=l.picks,a.activeItems=l.activeItems,s.add(a.onDidChangeValue(async()=>{a.items=Rue(a.value,t,i,n,o).picks})),s.add(a.onDidAccept(()=>{a.selectedItems[0].accept(),a.hide(),s.dispose()})),a.show()}function Rue(r,t,e,i,n){let o=[],s=[],a=e.getViewModel().focusedSession,l=e.getModel().getSessions(!1),d=[];l.forEach(p=>{p.compact&&p.parentSession&&s.push(p.parentSession)}),l.forEach(p=>{let h=s.includes(p);if(p.parentSession||o.push({type:"separator",label:h?p.name:void 0}),!h){let m=cTe(p,r,e,i,n);m&&(o.push(m),p.getId()===a?.getId()&&d.push(m))}}),o.length&&o.push({type:"separator"});let c=u("workbench.action.debug.startDebug","Start a New Debug Session");return o.push({label:`$(plus) ${c}`,ariaLabel:c,accept:()=>n.executeCommand(t)}),{picks:o,activeItems:d}}function dTe(r){let t=r.configuration.name.length?r.configuration.name:r.name,e=r.compact?void 0:r.parentSession?.configuration.name,i="",n="";return e&&(n=u("workbench.action.debug.spawnFrom","Session {0} spawned from {1}",t,e),i=e),{label:t,description:i,ariaLabel:n}}function cTe(r,t,e,i,n){let o=dTe(r),s=_l(t,o.label,!0);if(s)return{label:o.label,description:o.description,ariaLabel:o.ariaLabel,highlights:{label:s},accept:()=>{e.focusStackFrame(void 0,void 0,r,{explicit:!0}),i.isViewVisible(ln)||i.openView(ln,!0)}}}var Mue="workbench.view.explorer";var yCn=new A("explorerViewletVisible",!0,{type:"boolean",description:u("explorerViewletVisible","True when the EXPLORER viewlet is visible.")}),Aue=new A("foldersViewVisible",!0,{type:"boolean",description:u("foldersViewVisible","True when the FOLDERS view (the file tree within the explorer view container) is visible.")}),SCn=new A("explorerResourceIsFolder",!1,{type:"boolean",description:u("explorerResourceIsFolder","True when the focused item in the EXPLORER is a folder.")}),uTe=new A("explorerResourceReadonly",!1,{type:"boolean",description:u("explorerResourceReadonly","True when the focused item in the EXPLORER is read-only.")}),CCn=uTe.toNegated(),wCn=new A("explorerResourceAvailableEditorIds",""),ECn=new A("explorerResourceIsRoot",!1,{type:"boolean",description:u("explorerResourceIsRoot","True when the focused item in the EXPLORER is a root folder.")}),xCn=new A("explorerResourceCut",!1,{type:"boolean",description:u("explorerResourceCut","True when an item in the EXPLORER has been cut for cut and paste.")}),TCn=new A("explorerResourceMoveableToTrash",!1,{type:"boolean",description:u("explorerResourceMoveableToTrash","True when the focused item in the EXPLORER can be moved to trash.")}),pTe=new A("filesExplorerFocus",!0,{type:"boolean",description:u("filesExplorerFocus","True when the focus is inside the EXPLORER view.")}),_Cn=new A("openEditorsFocus",!0,{type:"boolean",description:u("openEditorsFocus","True when the focus is inside the OPEN EDITORS view.")}),hTe=new A("explorerViewletFocus",!0,{type:"boolean",description:u("explorerViewletFocus","True when the focus is inside the EXPLORER viewlet.")}),DCn=new A("explorerViewletCompressedFocus",!0,{type:"boolean",description:u("explorerViewletCompressedFocus","True when the focused item in the EXPLORER view is a compact item.")}),kCn=new A("explorerViewletCompressedFirstFocus",!0,{type:"boolean",description:u("explorerViewletCompressedFirstFocus","True when the focus is inside a compact item's first part in the EXPLORER view.")}),LCn=new A("explorerViewletCompressedLastFocus",!0,{type:"boolean",description:u("explorerViewletCompressedLastFocus","True when the focus is inside a compact item's last part in the EXPLORER view.")}),RCn=new A("viewHasSomeCollapsibleItem",!1,{type:"boolean",description:u("viewHasSomeCollapsibleItem","True when a workspace in the EXPLORER view has some collapsible root child.")}),PCn=P.and(Aue,pTe,P.not(oE)),MCn=P.and(Aue,hTe,P.not(oE)),Oue="workbench.editors.files.textFileEditor";var qb=class extends R{constructor(e,i,n,o){super();this.textFileService=e;this.fileService=i;this.languageService=n;this.modelService=o}fileWatcherDisposable=this._register(new yt);static async open(e,i,n,o,s){await o.openEditor({original:{resource:qb.resourceToTextFile(i,e)},modified:{resource:e},label:n,options:s})}static resourceToTextFile(e,i){return i.with({scheme:e,query:JSON.stringify({scheme:i.scheme,query:i.query})})}static textFileToResource(e){let{scheme:i,query:n}=JSON.parse(e.query);return e.with({scheme:i,query:n})}async provideTextContent(e){if(!e.query)return null;let i=qb.textFileToResource(e),n=await this.resolveEditorModel(e);if(!this.fileWatcherDisposable.value){let o=new B;this.fileWatcherDisposable.value=o,o.add(this.fileService.onDidFilesChange(s=>{s.contains(i,0)&&this.resolveEditorModel(e,!1)})),n&&o.add(X.once(n.onWillDispose)(()=>this.fileWatcherDisposable.clear()))}return n}async resolveEditorModel(e,i=!0){let n=qb.textFileToResource(e),o=await this.textFileService.readStream(n),s=this.modelService.getModel(e);if(s)this.modelService.updateModel(s,o.value);else if(i){let a=this.modelService.getModel(n),l;a?l=this.languageService.createById(a.getLanguageId()):l=this.languageService.createByFilepathOrFirstLine(n),s=this.modelService.createModel(o.value,l,e)}return s}};qb=E([b(0,Us),b(1,Ei),b(2,ti),b(3,qi)],qb);var Nue=q("requestService");function mTe(r){return r.res.statusCode&&r.res.statusCode>=200&&r.res.statusCode<300||r.res.statusCode===1223}function gTe(r){return r.res.statusCode===204}async function Fue(r){if(!mTe(r))throw new Error("Server returned "+r.res.statusCode);if(gTe(r))return null;let e=(await Iie(r.stream)).toString();try{return JSON.parse(e)}catch(i){throw i.message+=`:
`+e,i}}var Nj;function fTe(r){let t=Pe.as(ur.Configuration),e=Nj;Nj={id:"http",order:15,title:u("httpConfigurationTitle","HTTP"),type:"object",scope:r,properties:{"http.proxy":{type:"string",pattern:"^(https?|socks|socks4a?|socks5h?)://([^:]*(:[^@]*)?@)?([^:]+|\\[[:0-9a-fA-F]+\\])(:\\d+)?/?$|^$",markdownDescription:u("proxy","The proxy setting to use. If not set, will be inherited from the `http_proxy` and `https_proxy` environment variables."),restricted:!0},"http.proxyStrictSSL":{type:"boolean",default:!0,description:u("strictSSL","Controls whether the proxy server certificate should be verified against the list of supplied CAs."),restricted:!0},"http.proxyKerberosServicePrincipal":{type:"string",markdownDescription:u("proxyKerberosServicePrincipal","Overrides the principal service name for Kerberos authentication with the HTTP proxy. A default based on the proxy hostname is used when this is not set."),restricted:!0},"http.noProxy":{type:"array",items:{type:"string"},markdownDescription:u("noProxy","Specifies domain names for which proxy settings should be ignored for HTTP/HTTPS requests."),restricted:!0},"http.proxyAuthorization":{type:["null","string"],default:null,markdownDescription:u("proxyAuthorization","The value to send as the `Proxy-Authorization` header for every network request."),restricted:!0},"http.proxySupport":{type:"string",enum:["off","on","fallback","override"],enumDescriptions:[u("proxySupportOff","Disable proxy support for extensions."),u("proxySupportOn","Enable proxy support for extensions."),u("proxySupportFallback","Enable proxy support for extensions, fall back to request options, when no proxy found."),u("proxySupportOverride","Enable proxy support for extensions, override request options.")],default:"override",description:u("proxySupport","Use the proxy support for extensions."),restricted:!0},"http.systemCertificates":{type:"boolean",default:!0,description:u("systemCertificates","Controls whether CA certificates should be loaded from the OS. (On Windows and macOS, a reload of the window is required after turning this off.)"),restricted:!0},"http.experimental.systemCertificatesV2":{type:"boolean",tags:["experimental"],default:!1,description:u("systemCertificatesV2","Controls whether experimental loading of CA certificates from the OS should be enabled. This uses a more general approach than the default implemenation."),restricted:!0}}},t.updateConfigurations({add:[Nj],remove:e?[e]:[]})}fTe(1);var Iwn=q("ILanguageModelsService"),Bue={type:"object",properties:{vendor:{type:"string",description:u("vscode.extension.contributes.languageModels.vendor","A globally unique vendor of language models.")}}},bTe=Ra.registerExtensionPoint({extensionPoint:"languageModels",jsonSchema:{description:u("vscode.extension.contributes.languageModels","Contribute language models of a specific vendor."),oneOf:[Bue,{type:"array",items:Bue}]},activationEventsGenerator:(r,t)=>{for(let e of r)t.push(`onLanguageModelChat:${e.vendor}`)}}),mU=class{constructor(t,e){this._extensionService=t;this._logService=e;this._store.add(bTe.setHandler(i=>{this._vendors.clear();for(let o of i){if(!ede(o.description,"chatProvider")){o.collector.error(u("vscode.extension.contributes.languageModels.chatProviderRequired","This contribution point requires the 'chatProvider' proposal."));continue}for(let s of mt.wrap(o.value)){if(this._vendors.has(s.vendor)){o.collector.error(u("vscode.extension.contributes.languageModels.vendorAlreadyRegistered","The vendor '{0}' is already registered and cannot be registered twice",s.vendor));continue}if(gd(s.vendor)){o.collector.error(u("vscode.extension.contributes.languageModels.emptyVendor","The vendor field cannot be empty."));continue}if(s.vendor.trim()!==s.vendor){o.collector.error(u("vscode.extension.contributes.languageModels.whitespaceVendor","The vendor field cannot start or end with whitespace."));continue}this._vendors.add(s.vendor)}}let n=[];for(let[o,s]of this._providers)this._vendors.has(s.metadata.vendor)||(this._providers.delete(o),n.push(o));n.length>0&&this._onDidChangeProviders.fire({removed:n})}))}_serviceBrand;_store=new B;_providers=new Map;_vendors=new Set;_onDidChangeProviders=this._store.add(new x);onDidChangeLanguageModels=this._onDidChangeProviders.event;dispose(){this._store.dispose(),this._providers.clear()}getLanguageModelIds(){return Array.from(this._providers.keys())}lookupLanguageModel(t){return this._providers.get(t)?.metadata}async selectLanguageModels(t){if(t.vendor)await this._extensionService.activateByEvent(`onLanguageModelChat:${t.vendor}}`);else{let i=Array.from(this._vendors).map(n=>this._extensionService.activateByEvent(`onLanguageModelChat:${n}`));await Promise.all(i)}let e=[];for(let[i,n]of this._providers)(t.vendor===void 0||n.metadata.vendor===t.vendor)&&(t.family===void 0||n.metadata.family===t.family)&&(t.version===void 0||n.metadata.version===t.version)&&(t.identifier===void 0||n.metadata.id===t.identifier)&&(!n.metadata.targetExtensions||n.metadata.targetExtensions.some(o=>Qr.equals(o,t.extension)))&&e.push(i);return this._logService.trace("[LM] selected language models",t,e),e}registerLanguageModelChat(t,e){if(this._logService.trace("[LM] registering language model chat",t,e.metadata),!this._vendors.has(e.metadata.vendor))throw new Error(`Chat response provider uses UNKNOWN vendor ${e.metadata.vendor}.`);if(this._providers.has(t))throw new Error(`Chat response provider with identifier ${t} is already registered.`);return this._providers.set(t,e),this._onDidChangeProviders.fire({added:[{identifier:t,metadata:e.metadata}]}),le(()=>{this._providers.delete(t)&&(this._onDidChangeProviders.fire({removed:[t]}),this._logService.trace("[LM] UNregistered language model chat",t,e.metadata))})}async sendChatRequest(t,e,i,n,o){let s=this._providers.get(t);if(!s)throw new Error(`Chat response provider with identifier ${t} is not registered.`);return s.sendChatRequest(i,e,n,o)}computeTokenLength(t,e,i){let n=this._providers.get(t);if(!n)throw new Error(`Chat response provider with identifier ${t} is not registered.`);return n.provideTokenCount(e,i)}};mU=E([b(0,_n),b(1,bt)],mU);var Vue=q("IChatVariablesService");var Wue=q("ILanguageModelToolsService"),gU=class extends R{constructor(e,i){super();this._extensionService=e;this._contextKeyService=i;this._register(this._contextKeyService.onDidChangeContext(n=>{n.affectsSome(this._toolContextKeys)&&this._onDidChangeToolsScheduler.schedule()}))}_serviceBrand;_onDidChangeTools=new x;onDidChangeTools=this._onDidChangeTools.event;_onDidChangeToolsScheduler=new Ye(()=>this._onDidChangeTools.fire(),750);_tools=new Map;_toolContextKeys=new Set;registerToolData(e){if(this._tools.has(e.id))throw new Error(`Tool "${e.id}" is already registered.`);return this._tools.set(e.id,{data:e}),this._onDidChangeToolsScheduler.schedule(),e.when?.keys().forEach(i=>this._toolContextKeys.add(i)),le(()=>{this._tools.delete(e.id),this._refreshAllToolContextKeys(),this._onDidChangeToolsScheduler.schedule()})}_refreshAllToolContextKeys(){this._toolContextKeys.clear();for(let e of this._tools.values())e.data.when?.keys().forEach(i=>this._toolContextKeys.add(i))}registerToolImplementation(e,i){let n=this._tools.get(e);if(!n)throw new Error(`Tool "${e}" was not contributed.`);if(n.impl)throw new Error(`Tool "${e}" already has an implementation.`);return n.impl=i,le(()=>{n.impl=void 0})}getTools(){let e=mt.map(this._tools.values(),i=>i.data);return mt.filter(e,i=>!i.when||this._contextKeyService.contextMatchesRules(i.when))}getTool(e){return this._getToolEntry(e)?.data}_getToolEntry(e){let i=this._tools.get(e);if(i&&(!i.data.when||this._contextKeyService.contextMatchesRules(i.data.when)))return i}getToolByName(e){for(let i of this.getTools())if(i.name===e)return i}async invokeTool(e,i,n){let o=this._tools.get(e.toolId);if(!o)throw new Error(`Tool ${e.toolId} was not contributed`);if(!o.impl&&(await this._extensionService.activateByEvent(`onLanguageModelTool:${e.toolId}`),o=this._tools.get(e.toolId),!o?.impl))throw new Error(`Tool ${e.toolId} does not have an implementation registered.`);return o.impl.invoke(e,i,n)}};gU=E([b(0,_n),b(1,re)],gU);var vTe=/^@([\w_\-\.]+)(?=(\s|$|\b))/i,ITe=/^#([\w_\-]+)(:\d+)?(?=(\s|$|\b))/i,yTe=/\/([\w_\-]+)(?=(\s|$|\b))/i,fU=class{constructor(t,e,i,n){this.agentService=t;this.variableService=e;this.slashCommandService=i;this.toolsService=n}parseChatRequest(t,e,i="panel",n){let o=[],s=this.variableService.getDynamicVariables(t),a=1,l=1;for(let p=0;p<e.length;p++){let h=e.charAt(p-1),m=e.charAt(p),f;if((h.match(/\s/)||p===0)&&(m===qR?f=this.tryToParseVariable(e.slice(p),p,new H(a,l),o):m===Fj?f=this.tryToParseAgent(e.slice(p),e,p,new H(a,l),o,i,n):m===$R&&(f=this.tryToParseSlashCommand(e.slice(p),e,p,new H(a,l),o,i)),f||(f=this.tryToParseDynamicVariable(e.slice(p),p,new H(a,l),s))),f){if(p!==0){let g=o.at(-1),v=g?.range.endExclusive??0,I=g?.editorRange.endLineNumber??1,y=g?.editorRange.endColumn??1;o.push(new Mc(new Qe(v,p),new L(I,y,a,l),e.slice(v,p)))}o.push(f)}m===`
`?(a++,l=1):l++}let d=o.at(-1),c=d?.range.endExclusive??0;return c<e.length&&o.push(new Mc(new Qe(c,e.length),new L(d?.editorRange.endLineNumber??1,d?.editorRange.endColumn??1,a,l),e.slice(c,e.length))),{parts:o,text:e}}tryToParseAgent(t,e,i,n,o,s,a){let l=t.match(vTe);if(!l)return;let[d,c]=l,p=new Qe(i,i+d.length),h=new L(n.lineNumber,n.column,n.lineNumber,n.column+d.length),m=this.agentService.getAgentsByName(c);if(!m.length){let y=this.agentService.getAgentByFullyQualifiedId(c);y&&(m=[y])}let f=m.length>1&&a?.selectedAgent?a.selectedAgent:m.find(y=>y.locations.includes(s));if(!f||o.some(y=>y instanceof zu)||o.some(y=>y instanceof Mc&&y.text.trim()!==""||!(y instanceof zu)))return;let v=o.at(-1)?.range.endExclusive??0;if(e.slice(v,i).trim()==="")return new zu(p,h,f)}tryToParseVariable(t,e,i,n){let o=t.match(ITe);if(!o)return;let[s,a]=o,l=o[2]??"",d=new Qe(e,e+s.length),c=new L(i.lineNumber,i.column,i.lineNumber,i.column+s.length),p=n.find(g=>g instanceof zu),h=!p||p.agent.metadata.supportsSlowVariables,m=this.variableService.getVariable(a);if(m&&(!m.isSlow||h))return new Ix(d,c,a,l,m.id);let f=this.toolsService.getToolByName(a);if(f&&f.canBeInvokedManually&&(!p||p.agent.supportsToolReferences))return new yx(d,c,a,f.id)}tryToParseSlashCommand(t,e,i,n,o,s){let a=t.match(yTe);if(!a||o.some(m=>m instanceof Wy))return;let[l,d]=a,c=new Qe(i,i+l.length),p=new L(n.lineNumber,n.column,n.lineNumber,n.column+l.length),h=o.find(m=>m instanceof zu);if(h){if(o.some(I=>I instanceof Mc&&I.text.trim()!==""||!(I instanceof zu)&&!(I instanceof Mc)))return;let f=o.at(-1)?.range.endExclusive??0;if(e.slice(f,i).trim()!=="")return;let v=h.agent.slashCommands.find(I=>I.name===d);if(v)return new Vy(c,p,v)}else{let f=this.slashCommandService.getCommands(s).find(g=>g.command===d);if(f)return new Wy(c,p,f);{let v=this.agentService.getDefaultAgent(s)?.slashCommands.find(I=>I.name===d);if(v)return new Vy(c,p,v)}}}tryToParseDynamicVariable(t,e,i,n){let o=n.find(s=>s.range.startLineNumber===i.lineNumber&&s.range.startColumn===i.column);if(o){let s=o.range.endColumn-o.range.startColumn,a=t.substring(0,s),l=new Qe(e,e+s);return new Sx(l,o.range,a,o.id,o.modelDescription,o.data)}}};fU=E([b(0,XR),b(1,Vue),b(2,Hue),b(3,Wue)],fU);function STe(r){return!!r&&typeof r=="object"&&"uri"in r&&r.uri instanceof Z&&"version"in r&&typeof r.version=="number"&&"ranges"in r&&Array.isArray(r.ranges)&&r.ranges.every(L.isIRange)}function Uue(r){return!!r&&typeof r=="object"&&"documents"in r&&Array.isArray(r.documents)&&r.documents.every(STe)}var fxn=q("IChatService");var Hue=q("chatSlashCommandService"),bU=class extends R{constructor(e){super();this._extensionService=e}_commands=new Map;_onDidChangeCommands=this._register(new x);onDidChangeCommands=this._onDidChangeCommands.event;dispose(){super.dispose(),this._commands.clear()}registerSlashCommand(e,i){if(this._commands.has(e.command))throw new Error(`Already registered a command with id ${e.command}}`);return this._commands.set(e.command,{data:e,command:i}),this._onDidChangeCommands.fire(),le(()=>{this._commands.delete(e.command)&&this._onDidChangeCommands.fire()})}getCommands(e){return Array.from(this._commands.values(),i=>i.data).filter(i=>i.locations.includes(e))}hasCommand(e){return this._commands.has(e)}async executeCommand(e,i,n,o,s,a){let l=this._commands.get(e);if(!l)throw new Error("No command with id ${id} NOT registered");if(l.command||await this._extensionService.activateByEvent(`onSlash:${e}`),!l.command)throw new Error(`No command with id ${e} NOT resolved`);return await l.command(i,n,o,s,a)}};bU=E([b(0,_n)],bU);var Mc=class r{constructor(t,e,i){this.range=t;this.editorRange=e;this.text=i}static Kind="text";kind=r.Kind;get promptText(){return this.text}},qR="#",Fj="@",$R="/",Ix=class r{constructor(t,e,i,n,o){this.range=t;this.editorRange=e;this.variableName=i;this.variableArg=n;this.variableId=o}static Kind="var";kind=r.Kind;get text(){let t=this.variableArg?`:${this.variableArg}`:"";return`${qR}${this.variableName}${t}`}get promptText(){return this.text}},yx=class r{constructor(t,e,i,n){this.range=t;this.editorRange=e;this.toolName=i;this.toolId=n}static Kind="tool";kind=r.Kind;get text(){return`${qR}${this.toolName}`}get promptText(){return this.text}},zu=class r{constructor(t,e,i){this.range=t;this.editorRange=e;this.agent=i}static Kind="agent";kind=r.Kind;get text(){return`${Fj}${this.agent.name}`}get promptText(){return""}},Vy=class r{constructor(t,e,i){this.range=t;this.editorRange=e;this.command=i}static Kind="subcommand";kind=r.Kind;get text(){return`${$R}${this.command.name}`}get promptText(){return""}},Wy=class r{constructor(t,e,i){this.range=t;this.editorRange=e;this.slashCommand=i}static Kind="slash";kind=r.Kind;get text(){return`${$R}${this.slashCommand.command}`}get promptText(){return`${$R}${this.slashCommand.command}`}},Sx=class r{constructor(t,e,i,n,o,s){this.range=t;this.editorRange=e;this.text=i;this.id=n;this.modelDescription=o;this.data=s}static Kind="dynamic";kind=r.Kind;get referenceText(){return this.text.replace(qR,"")}get promptText(){return this.text}};function zue(r){return{text:r.text,parts:r.parts.map(t=>{if(t.kind===Mc.Kind)return new Mc(new Qe(t.range.start,t.range.endExclusive),t.editorRange,t.text);if(t.kind===Ix.Kind)return new Ix(new Qe(t.range.start,t.range.endExclusive),t.editorRange,t.variableName,t.variableArg,t.variableId||"");if(t.kind===yx.Kind)return new yx(new Qe(t.range.start,t.range.endExclusive),t.editorRange,t.toolName,t.toolId);if(t.kind===zu.Kind){let e=t.agent;return e=vU(e),new zu(new Qe(t.range.start,t.range.endExclusive),t.editorRange,e)}else{if(t.kind===Vy.Kind)return new Vy(new Qe(t.range.start,t.range.endExclusive),t.editorRange,t.command);if(t.kind===Wy.Kind)return new Wy(new Qe(t.range.start,t.range.endExclusive),t.editorRange,t.slashCommand);if(t.kind===Sx.Kind)return new Sx(new Qe(t.range.start,t.range.endExclusive),t.editorRange,t.text,t.id,t.modelDescription,Wl(t.data));throw new Error(`Unknown chat request part: ${t.kind}`)}})}}var yU=class r{constructor(t,e,i,n=0,o,s,a){this._session=t;this.message=e;this._variableData=i;this._attempt=n;this._confirmation=o;this._locationData=s;this._attachedContext=a;this.id="request_"+r.nextId++}static nextId=0;response;id;get session(){return this._session}get username(){return this.session.requesterUsername}get avatarIconUri(){return this.session.requesterAvatarIconUri}get attempt(){return this._attempt}get variableData(){return this._variableData}set variableData(t){this._variableData=t}get confirmation(){return this._confirmation}get locationData(){return this._locationData}get attachedContext(){return this._attachedContext}adoptTo(t){this._session=t}},Bj=class extends R{_onDidChangeValue=this._register(new x);get onDidChangeValue(){return this._onDidChangeValue.event}_responseParts;_responseRepr="";_markdownContent="";_citations=[];get value(){return this._responseParts}constructor(t){super(),this._responseParts=Ov(t).map(e=>ya(e)?{content:e,kind:"markdownContent"}:"kind"in e?e:{kind:"treeData",treeData:e}),this._updateRepr(!0)}toString(){return this._responseRepr}toMarkdown(){return this._markdownContent}clear(){this._responseParts=[],this._updateRepr(!0)}updateContent(t,e){if(t.kind==="markdownContent"){let i=this._responseParts.length-1,n=this._responseParts[i];!n||n.kind!=="markdownContent"||!wTe(n.content,t.content)?this._responseParts.push(t):n.content=ETe(n.content,t.content),this._updateRepr(e)}else if(t.kind==="textEdit"){if(t.edits.length>0){let i=!1;for(let n=0;!i&&n<this._responseParts.length;n++){let o=this._responseParts[n];o.kind==="textEditGroup"&&zi(o.uri,t.uri)&&(o.edits.push(t.edits),i=!0)}i||this._responseParts.push({kind:"textEditGroup",uri:t.uri,edits:[t.edits]}),this._updateRepr(e)}}else if(t.kind==="progressTask"){let i=this._responseParts.push(t)-1;this._updateRepr(e);let n=t.onDidAddProgress(()=>{this._updateRepr(!1)});t.task?.().then(o=>{n.dispose(),typeof o=="string"&&(this._responseParts[i].content=new Sn(o)),this._updateRepr(!1)})}else this._responseParts.push(t),this._updateRepr(e)}addCitation(t){this._citations.push(t),this._updateRepr()}_updateRepr(t){this._responseRepr=this._responseParts.map(e=>e.kind==="treeData"?"":e.kind==="inlineReference"?Ji("uri"in e.inlineReference?e.inlineReference.uri:e.inlineReference):e.kind==="command"?e.command.title:e.kind==="textEditGroup"?u("editsSummary","Made changes."):e.kind==="progressMessage"?"":e.kind==="confirmation"?`${e.title}
${e.message}`:e.content.value).filter(e=>e.length>0).join(`

`),this._responseRepr+=this._citations.length?`

`+xTe(this._citations):"",this._markdownContent=this._responseParts.map(e=>e.kind==="inlineReference"?Ji("uri"in e.inlineReference?e.inlineReference.uri:e.inlineReference):e.kind==="markdownContent"||e.kind==="markdownVuln"?e.content.value:"").filter(e=>e.length>0).join(`

`),t||this._onDidChangeValue.fire()}},Cx=class r extends R{constructor(e,i,n,o,s,a=!1,l=!1,d,c,p,h){super();this._session=i;this._agent=n;this._slashCommand=o;this.requestId=s;this._isComplete=a;this._isCanceled=l;this._vote=d;this._voteDownReason=c;this._result=p;this._isStale=Array.isArray(e)&&(e.length!==0||ya(e)&&e.value.length!==0),this._followups=h?[...h]:void 0,this._response=this._register(new Bj(e)),this._register(this._response.onDidChangeValue(()=>this._onDidChange.fire())),this.id="response_"+r.nextId++}_onDidChange=this._register(new x);onDidChange=this._onDidChange.event;static nextId=0;id;get session(){return this._session}get isComplete(){return this._isComplete}get isCanceled(){return this._isCanceled}get vote(){return this._vote}get voteDownReason(){return this._voteDownReason}get followups(){return this._followups}_response;get response(){return this._response}get result(){return this._result}get username(){return this.session.responderUsername}get avatarIcon(){return this.session.responderAvatarIcon}_followups;get agent(){return this._agent}get slashCommand(){return this._slashCommand}_agentOrSlashCommandDetected;get agentOrSlashCommandDetected(){return this._agentOrSlashCommandDetected??!1}_usedContext;get usedContext(){return this._usedContext}_contentReferences=[];get contentReferences(){return this._contentReferences}_codeCitations=[];get codeCitations(){return this._codeCitations}_progressMessages=[];get progressMessages(){return this._progressMessages}_isStale=!1;get isStale(){return this._isStale}updateContent(e,i){this._response.updateContent(e,i)}applyReference(e){e.kind==="usedContext"?this._usedContext=e:e.kind==="reference"&&(this._contentReferences.push(e),this._onDidChange.fire())}applyCodeCitation(e){this._codeCitations.push(e),this._response.addCitation(e),this._onDidChange.fire()}setAgent(e,i){this._agent=e,this._slashCommand=i,this._agentOrSlashCommandDetected=!0,this._onDidChange.fire()}setResult(e){this._result=e,this._onDidChange.fire()}complete(){this._result?.errorDetails?.responseIsRedacted&&this._response.clear(),this._isComplete=!0,this._onDidChange.fire()}cancel(){this._isComplete=!0,this._isCanceled=!0,this._onDidChange.fire()}setFollowups(e){this._followups=e,this._onDidChange.fire()}setVote(e){this._vote=e,this._onDidChange.fire()}setVoteDownReason(e){this._voteDownReason=e,this._onDidChange.fire()}setEditApplied(e,i){return!this.response.value.includes(e)||!e.state?!1:(e.state.applied=i,this._onDidChange.fire(),!0)}adoptTo(e){this._session=e,this._onDidChange.fire()}};function CTe(r){let t=r;return typeof t=="object"&&typeof t.requesterUsername=="string"}function YR(r){let t=r;return CTe(r)&&typeof t.creationDate=="number"&&typeof t.sessionId=="string"&&r.requests.every(e=>!e.usedContext||Uue(e.usedContext))}var IU=(i=>(i[i.Created=0]="Created",i[i.Initializing=1]="Initializing",i[i.Initialized=2]="Initialized",i))(IU||{}),wx=class extends R{constructor(e,i,n,o,s){super();this.initialData=e;this._initialLocation=i;this.logService=n;this.chatAgentService=o;this.instantiationService=s;this._isImported=!!e&&!YR(e)||(e?.isImported??!1),this._sessionId=YR(e)&&e.sessionId||Ni(),this._requests=e?this._deserialize(e):[],this._creationDate=YR(e)&&e.creationDate||Date.now(),this._lastMessageDate=YR(e)&&e.lastMessageDate||this._creationDate,this._customTitle=YR(e)?e.customTitle:void 0,this._initialRequesterAvatarIconUri=e?.requesterAvatarIconUri&&Z.revive(e.requesterAvatarIconUri),this._initialResponderAvatarIconUri=AJ(e?.responderAvatarIconUri)?Z.revive(e.responderAvatarIconUri):e?.responderAvatarIconUri}static getDefaultTitle(e){let i=e.at(0)?.message??"";return(typeof i=="string"?i:i.text).split(`
`)[0].substring(0,50)}_onDidDispose=this._register(new x);onDidDispose=this._onDidDispose.event;_onDidChange=this._register(new x);onDidChange=this._onDidChange.event;_requests;_initState=0;_isInitializedDeferred=new Kr;_welcomeMessage;get welcomeMessage(){return this._welcomeMessage}_sessionId;get sessionId(){return this._sessionId}get requestInProgress(){let e=this.lastRequest;return!!e?.response&&!e.response.isComplete}get hasRequests(){return this._requests.length>0}get lastRequest(){return this._requests.at(-1)}_creationDate;get creationDate(){return this._creationDate}_lastMessageDate;get lastMessageDate(){return this._lastMessageDate}get _defaultAgent(){return this.chatAgentService.getDefaultAgent("panel")}get requesterUsername(){return(this._defaultAgent?this._defaultAgent.metadata.requester?.name:this.initialData?.requesterUsername)??""}get responderUsername(){return(this._defaultAgent?this._defaultAgent.fullName:this.initialData?.responderUsername)??""}_initialRequesterAvatarIconUri;get requesterAvatarIconUri(){return this._defaultAgent?this._defaultAgent.metadata.requester?.icon:this._initialRequesterAvatarIconUri}_initialResponderAvatarIconUri;get responderAvatarIcon(){return this._defaultAgent?this._defaultAgent?.metadata.themeIcon:this._initialResponderAvatarIconUri}get initState(){return this._initState}_isImported=!1;get isImported(){return this._isImported}_customTitle;get customTitle(){return this._customTitle}get title(){return this._customTitle||wx.getDefaultTitle(this._requests)}get initialLocation(){return this._initialLocation}_deserialize(e){let i=e.requests;if(!Array.isArray(i))return this.logService.error(`Ignoring malformed session data: ${JSON.stringify(e)}`),[];if(e.welcomeMessage){let n=e.welcomeMessage.map(o=>typeof o=="string"?new Sn(o):o);this._welcomeMessage=this.instantiationService.createInstance(Hy,n,[])}try{return i.map(n=>{let o=typeof n.message=="string"?this.getParsedRequestFromString(n.message):zue(n.message),s=this.reviveVariableData(n.variableData),a=new yU(this,o,s);if(n.response||n.result||n.responseErrorDetails){let l=n.agent&&"metadata"in n.agent?vU(n.agent):void 0,d="responseErrorDetails"in n?{errorDetails:n.responseErrorDetails}:n.result;a.response=new Cx(n.response??[new Sn(n.response)],this,l,n.slashCommand,a.id,!0,n.isCanceled,n.vote,n.voteDownReason,d,n.followups),n.usedContext&&a.response.applyReference(Wl(n.usedContext)),n.contentReferences?.forEach(c=>a.response.applyReference(Wl(c))),n.codeCitations?.forEach(c=>a.response.applyCodeCitation(Wl(c)))}return a})}catch(n){return this.logService.error("Failed to parse chat data",n),[]}}reviveVariableData(e){let i=e&&Array.isArray(e.variables)?e:{variables:[]};return i.variables=i.variables.map(n=>n&&"values"in n&&Array.isArray(n.values)?{id:n.id??"",name:n.name,value:n.values[0]?.value,range:n.range,modelDescription:n.modelDescription,references:n.references}:n),i}getParsedRequestFromString(e){let i=[new Mc(new Qe(0,e.length),{startColumn:1,startLineNumber:1,endColumn:1,endLineNumber:1},e)];return{text:e,parts:i}}startInitialize(){if(this.initState!==0)throw new Error(`ChatModel is in the wrong state for startInitialize: ${IU[this.initState]}`);this._initState=1}deinitialize(){this._initState=0,this._isInitializedDeferred=new Kr}initialize(e){if(this.initState!==1)throw new Error(`ChatModel is in the wrong state for initialize: ${IU[this.initState]}`);this._initState=2,this._welcomeMessage||(this._welcomeMessage=e),this._isInitializedDeferred.complete(),this._onDidChange.fire({kind:"initialize"})}setInitializationError(e){if(this.initState!==1)throw new Error(`ChatModel is in the wrong state for setInitializationError: ${IU[this.initState]}`);this._isInitializedDeferred.isSettled||this._isInitializedDeferred.error(e)}waitForInitialization(){return this._isInitializedDeferred.p}getRequests(){return this._requests}addRequest(e,i,n,o,s,a,l,d){let c=new yU(this,e,i,n,a,l,d);return c.response=new Cx([],this,o,s,c.id),this._requests.push(c),this._lastMessageDate=Date.now(),this._onDidChange.fire({kind:"addRequest",request:c}),c}setCustomTitle(e){this._customTitle=e}updateRequest(e,i){e.variableData=i,this._onDidChange.fire({kind:"changedRequest",request:e})}adoptRequest(e){let i=e.session,n=i._requests.findIndex(o=>o.id===e.id);n!==-1&&(i._requests.splice(n,1),e.adoptTo(this),e.response?.adoptTo(this),this._requests.push(e),i._onDidChange.fire({kind:"removeRequest",requestId:e.id,responseId:e.response?.id,reason:2}),this._onDidChange.fire({kind:"addRequest",request:e}))}acceptResponseProgress(e,i,n){if(e.response||(e.response=new Cx([],this,void 0,void 0,e.id)),e.response.isComplete)throw new Error("acceptResponseProgress: Adding progress to a completed response");if(i.kind==="markdownContent"||i.kind==="treeData"||i.kind==="inlineReference"||i.kind==="markdownVuln"||i.kind==="progressMessage"||i.kind==="command"||i.kind==="textEdit"||i.kind==="warning"||i.kind==="progressTask"||i.kind==="confirmation")e.response.updateContent(i,n);else if(i.kind==="usedContext"||i.kind==="reference")e.response.applyReference(i);else if(i.kind==="agentDetection"){let o=this.chatAgentService.getAgent(i.agentId);o&&(e.response.setAgent(o,i.command),this._onDidChange.fire({kind:"setAgent",agent:o,command:i.command}))}else i.kind==="codeCitation"?e.response.applyCodeCitation(i):i.kind==="move"?this._onDidChange.fire({kind:"move",target:i.uri,range:i.range}):this.logService.error(`Couldn't handle progress: ${JSON.stringify(i)}`)}removeRequest(e,i=0){let n=this._requests.findIndex(s=>s.id===e),o=this._requests[n];n!==-1&&(this._onDidChange.fire({kind:"removeRequest",requestId:o.id,responseId:o.response?.id,reason:i}),this._requests.splice(n,1),o.response?.dispose())}cancelRequest(e){e.response&&e.response.cancel()}setResponse(e,i){e.response||(e.response=new Cx([],this,void 0,void 0,e.id)),e.response.setResult(i)}completeResponse(e){if(!e.response)throw new Error("Call setResponse before completeResponse");e.response.complete()}setFollowups(e,i){e.response&&e.response.setFollowups(i)}setResponseModel(e,i){e.response=i,this._onDidChange.fire({kind:"addResponse",response:i})}toExport(){return{requesterUsername:this.requesterUsername,requesterAvatarIconUri:this.requesterAvatarIconUri,responderUsername:this.responderUsername,responderAvatarIconUri:this.responderAvatarIcon,initialLocation:this.initialLocation,welcomeMessage:this._welcomeMessage?.content.map(e=>Array.isArray(e)?e:e.value),requests:this._requests.map(e=>{let i={...e.message,parts:e.message.parts.map(s=>s&&"toJSON"in s?s.toJSON():s)},n=e.response?.agent,o=n&&"toJSON"in n?n.toJSON():n?{...n}:void 0;return{message:i,variableData:e.variableData,response:e.response?e.response.response.value.map(s=>s.kind==="treeData"?s.treeData:s.kind==="markdownContent"?s.content:s):void 0,result:e.response?.result,followups:e.response?.followups,isCanceled:e.response?.isCanceled,vote:e.response?.vote,voteDownReason:e.response?.voteDownReason,agent:o,slashCommand:e.response?.slashCommand,usedContext:e.response?.usedContext,contentReferences:e.response?.contentReferences,codeCitations:e.response?.codeCitations}})}}toJSON(){return{version:3,...this.toExport(),sessionId:this.sessionId,creationDate:this._creationDate,isImported:this._isImported,lastMessageDate:this._lastMessageDate,customTitle:this._customTitle}}dispose(){this._requests.forEach(e=>e.response?.dispose()),this._onDidDispose.fire(),super.dispose()}};wx=E([b(2,bt),b(3,XR),b(4,ne)],wx);var Hy=class{constructor(t,e,i){this.content=t;this.sampleQuestions=e;this.chatAgentService=i;this._id="welcome_"+Hy.nextId++}static nextId=0;_id;get id(){return this._id}get username(){return this.chatAgentService.getContributedDefaultAgent("panel")?.fullName??""}get avatarIcon(){return this.chatAgentService.getDefaultAgent("panel")?.metadata.themeIcon}};Hy=E([b(2,XR)],Hy);function wTe(r,t){if(r.baseUri&&t.baseUri){if(!(r.baseUri.scheme===t.baseUri.scheme&&r.baseUri.authority===t.baseUri.authority&&r.baseUri.path===t.baseUri.path&&r.baseUri.query===t.baseUri.query&&r.baseUri.fragment===t.baseUri.fragment))return!1}else if(r.baseUri||t.baseUri)return!1;return sn(r.isTrusted,t.isTrusted)&&r.supportHtml===t.supportHtml&&r.supportThemeIcons===t.supportThemeIcons}function ETe(r,t){let e=typeof t=="string"?t:t.value;return{value:r.value+e,isTrusted:r.isTrusted,supportThemeIcons:r.supportThemeIcons,supportHtml:r.supportHtml,baseUri:r.baseUri}}function xTe(r){if(r.length===0)return"";let t=r.reduce((i,n)=>i.add(n.license),new Set);return t.size===1?u("codeCitation","Similar code found with 1 license type",t.size):u("codeCitations","Similar code found with {0} license types",t.size)}var jR=(n=>(n.Panel="panel",n.Terminal="terminal",n.Notebook="notebook",n.Editor="editor",n))(jR||{});(t=>{function r(e){switch(e){case"panel":return"panel";case"terminal":return"terminal";case"notebook":return"notebook";case"editor":return"editor"}return"panel"}t.fromRaw=r})(jR||={});var XR=q("chatAgentService"),SU=class{constructor(t){this.contextKeyService=t;this._hasDefaultAgent=Kue.bindTo(this.contextKeyService),this._defaultAgentRegistered=Gue.bindTo(this.contextKeyService)}static AGENT_LEADER="@";_agents=new Map;_onDidChangeAgents=new x;onDidChangeAgents=this._onDidChangeAgents.event;_hasDefaultAgent;_defaultAgentRegistered;registerAgent(t,e){if(this.getAgent(t))throw new Error(`Agent already registered: ${JSON.stringify(t)}`);e.isDefault&&this._defaultAgentRegistered.set(!0);let n=this,o=e.slashCommands;e={...e,get slashCommands(){return o.filter(a=>!a.when||n.contextKeyService.contextMatchesRules(P.deserialize(a.when)))}};let s={data:e};return this._agents.set(t,s),this._onDidChangeAgents.fire(void 0),le(()=>{this._agents.delete(t),e.isDefault&&this._defaultAgentRegistered.set(!1),this._onDidChangeAgents.fire(void 0)})}registerAgentImplementation(t,e){let i=this._agents.get(t);if(!i)throw new Error(`Unknown agent: ${JSON.stringify(t)}`);if(i.impl)throw new Error(`Agent already has implementation: ${JSON.stringify(t)}`);return i.data.isDefault&&this._hasDefaultAgent.set(!0),i.impl=e,this._onDidChangeAgents.fire(new Ex(i.data,e)),le(()=>{i.impl=void 0,this._onDidChangeAgents.fire(void 0),i.data.isDefault&&this._hasDefaultAgent.set(!1)})}registerDynamicAgent(t,e){t.isDynamic=!0;let i={data:t,impl:e};return this._agents.set(t.id,i),this._onDidChangeAgents.fire(new Ex(t,e)),le(()=>{this._agents.delete(t.id),this._onDidChangeAgents.fire(void 0)})}_agentCompletionProviders=new Map;registerAgentCompletionProvider(t,e){return this._agentCompletionProviders.set(t,e),{dispose:()=>{this._agentCompletionProviders.delete(t)}}}async getAgentCompletionItems(t,e,i){return await this._agentCompletionProviders.get(t)?.(e,i)??[]}updateAgent(t,e){let i=this._agents.get(t);if(!i?.impl)throw new Error(`No activated agent with id ${JSON.stringify(t)} registered`);i.data.metadata={...i.data.metadata,...e},this._onDidChangeAgents.fire(new Ex(i.data,i.impl))}getDefaultAgent(t){return lm(this.getActivatedAgents(),e=>!!e.isDefault&&e.locations.includes(t))}getContributedDefaultAgent(t){return this.getAgents().find(e=>!!e.isDefault&&e.locations.includes(t))}getSecondaryAgent(){return mt.find(this._agents.values(),t=>!!t.data.metadata.isSecondary)?.data}getAgent(t){if(this._agentIsEnabled(t))return this._agents.get(t)?.data}_agentIsEnabled(t){let e=this._agents.get(t);return!e?.data.when||this.contextKeyService.contextMatchesRules(P.deserialize(e.data.when))}getAgentByFullyQualifiedId(t){let e=mt.find(this._agents.values(),i=>TTe(i.data)===t)?.data;if(!(e&&!this._agentIsEnabled(e.id)))return e}getAgents(){return Array.from(this._agents.values()).map(t=>t.data).filter(t=>this._agentIsEnabled(t.id))}getActivatedAgents(){return Array.from(this._agents.values()).filter(t=>!!t.impl).filter(t=>this._agentIsEnabled(t.data.id)).map(t=>new Ex(t.data,t.impl))}getAgentsByName(t){return this.getAgents().filter(e=>e.name===t)}agentHasDupeName(t){let e=this.getAgent(t);return e?this.getAgentsByName(e.name).filter(i=>i.extensionId.value!==e.extensionId.value).length>0:!1}async invokeAgent(t,e,i,n,o){let s=this._agents.get(t);if(!s?.impl)throw new Error(`No activated agent with id "${t}"`);return await s.impl.invoke(e,i,n,o)}async getFollowups(t,e,i,n,o){let s=this._agents.get(t);if(!s?.impl)throw new Error(`No activated agent with id "${t}"`);return s.impl?.provideFollowups?s.impl.provideFollowups(e,i,n,o):[]}async getChatTitle(t,e,i){let n=this._agents.get(t);if(!n?.impl)throw new Error(`No activated agent with id "${t}"`);if(n.impl?.provideChatTitle)return n.impl.provideChatTitle(e,i)}_chatParticipantDetectionProviders=new Map;registerChatParticipantDetectionProvider(t,e){return this._chatParticipantDetectionProviders.set(t,e),le(()=>{this._chatParticipantDetectionProviders.delete(t)})}hasChatParticipantDetectionProviders(){return this._chatParticipantDetectionProviders.size>0}async detectAgentOrCommand(t,e,i,n){let o=mt.first(this._chatParticipantDetectionProviders.values());if(!o)return;let s=this.getAgents().reduce((c,p)=>{c.push({participant:p.id,disambiguation:p.disambiguation??[]});for(let h of p.slashCommands)c.push({participant:p.id,command:h.name,disambiguation:h.disambiguation??[]});return c},[]),a=await o.provideParticipantDetection(t,e,{...i,participants:s},n);if(!a)return;let l=this.getAgent(a.participant);if(!l)return;if(!a.command)return{agent:l};let d=l?.slashCommands.find(c=>c.name===a.command);if(d)return{agent:l,command:d}}};SU=E([b(0,re)],SU);var Ex=class{constructor(t,e){this.data=t;this.impl=e}when;publisherDisplayName;isDynamic;get id(){return this.data.id}get name(){return this.data.name??""}get fullName(){return this.data.fullName??""}get description(){return this.data.description??""}get extensionId(){return this.data.extensionId}get extensionPublisherId(){return this.data.extensionPublisherId}get extensionPublisherDisplayName(){return this.data.publisherDisplayName}get extensionDisplayName(){return this.data.extensionDisplayName}get isDefault(){return this.data.isDefault}get metadata(){return this.data.metadata}get slashCommands(){return this.data.slashCommands}get locations(){return this.data.locations}get disambiguation(){return this.data.disambiguation}async invoke(t,e,i,n){return this.impl.invoke(t,e,i,n)}async provideFollowups(t,e,i,n){return this.impl.provideFollowups?this.impl.provideFollowups(t,e,i,n):[]}provideWelcomeMessage(t,e){if(this.impl.provideWelcomeMessage)return this.impl.provideWelcomeMessage(t,e)}provideSampleQuestions(t,e){if(this.impl.provideSampleQuestions)return this.impl.provideSampleQuestions(t,e)}toJSON(){return this.data}},G_n=q("chatAgentNameService"),$b=class{constructor(t,e,i,n){this.requestService=e;this.logService=i;this.storageService=n;if(!t.chatParticipantRegistry)return;this.url=t.chatParticipantRegistry;let o=n.get($b.StorageKey,-1);try{this.registry.set(JSON.parse(o??"{}"),void 0)}catch{n.remove($b.StorageKey,-1)}this.refresh()}static StorageKey="chat.participantNameRegistry";url;registry=Ht(this,Object.create(null));disposed=!1;refresh(){this.disposed||this.update().catch(t=>this.logService.warn("Failed to fetch chat participant registry",t)).then(()=>To(5*60*1e3)).then(()=>this.refresh())}async update(){let t=await this.requestService.request({type:"GET",url:this.url},Pt.None);if(t.res.statusCode!==200)throw new Error("Could not get extensions report.");let e=await Fue(t);if(!e||e.version!==1)throw new Error("Unexpected chat participant registry response.");let i=e.restrictedChatParticipants;this.registry.set(i,void 0),this.storageService.store($b.StorageKey,JSON.stringify(i),-1,1)}getAgentNameRestriction(t){let e=this.checkAgentNameRestriction(t.name,t).get(),i=!t.fullName||this.checkAgentNameRestriction(t.fullName.replace(/\s/g,""),t).get();return e&&i}checkAgentNameRestriction(t,e){return this.registry.map(n=>n[t.toLowerCase()]).map(n=>n?n.some(o=>dr(o,o.includes(".")?e.extensionId.value:e.extensionPublisherId)):!0)}dispose(){this.disposed=!0}};$b=E([b(0,al),b(1,Nue),b(2,bt),b(3,nt)],$b);function TTe(r){return`${r.extensionId.value}.${r.id}`}function vU(r){let t="name"in r?r:{...r,name:r.id};return"extensionPublisherId"in t||(t.extensionPublisherId=t.extensionPublisher??""),"extensionDisplayName"in t||(t.extensionDisplayName=""),"extensionId"in t||(t.extensionId=new Qr("")),Wl(t)}var Z_n=new A("chatSessionResponseVote","",{type:"string",description:u("interactiveSessionResponseVote","When the response has been voted up, is set to 'up'. When voted down, is set to 'down'. Otherwise an empty string.")}),J_n=new A("chatVoteUpEnabled",!1,{type:"boolean",description:u("chatVoteUpEnabled","True when the chat vote up action is enabled.")}),eDn=new A("chatSessionResponseDetectedAgentOrCommand",!1,{type:"boolean",description:u("chatSessionResponseDetectedAgentOrCommand","When the agent or command was automatically detected")}),tDn=new A("chatResponseSupportsIssueReporting",!1,{type:"boolean",description:u("chatResponseSupportsIssueReporting","True when the current chat response supports issue reporting.")}),iDn=new A("chatSessionResponseFiltered",!1,{type:"boolean",description:u("chatResponseFiltered","True when the chat response was filtered out by the server.")}),nDn=new A("chatSessionResponseError",!1,{type:"boolean",description:u("chatResponseErrored","True when the chat response resulted in an error.")}),oDn=new A("chatSessionRequestInProgress",!1,{type:"boolean",description:u("interactiveSessionRequestInProgress","True when the current request is still in progress.")}),rDn=new A("chatResponse",!1,{type:"boolean",description:u("chatResponse","The chat item is a response.")}),sDn=new A("chatRequest",!1,{type:"boolean",description:u("chatRequest","The chat item is a request")}),aDn=new A("chatEditApplied",!1,{type:"boolean",description:u("chatEditApplied","True when the chat text edits have been applied.")}),lDn=new A("chatInputHasText",!1,{type:"boolean",description:u("interactiveInputHasText","True when the chat input has text.")}),dDn=new A("chatInputHasFocus",!1,{type:"boolean",description:u("interactiveInputHasFocus","True when the chat input has focus.")}),cDn=new A("inChatInput",!1,{type:"boolean",description:u("inInteractiveInput","True when focus is in the chat input, false otherwise.")}),xx=new A("inChat",!1,{type:"boolean",description:u("inChat","True when focus is in the chat widget, false otherwise.")}),Kue=new A("chatIsEnabled",!1,{type:"boolean",description:u("chatIsEnabled","True when chat is enabled because a default chat participant is activated with an implementation.")}),Gue=new A("chatPanelParticipantRegistered",!1,{type:"boolean",description:u("chatParticipantRegistered","True when a default chat participant is registered for the panel.")}),uDn=new A("chatExtensionInvalid",!1,{type:"boolean",description:u("chatExtensionInvalid","True when the installed chat extension is invalid and needs to be updated.")}),pDn=new A("chatCursorAtTop",!1),hDn=new A("chatInputHasAgent",!1),mDn=new A("chatLocation",void 0),gDn=new A("quickChatHasFocus",!1,{type:"boolean",description:u("inQuickChat","True when the quick chat UI has focus, false otherwise.")});var Uy="debug.addConfiguration",QR="editor.debug.action.toggleInlineBreakpoint",Wj="debug.copyStackTrace",Hj="workbench.action.debug.reverseContinue",Uj="workbench.action.debug.stepBack",Mh="workbench.action.debug.restart",CU="workbench.action.debug.terminateThread",Ah="workbench.action.debug.stepOver",Oh="workbench.action.debug.stepInto",zj="workbench.action.debug.stepIntoTarget",Nh="workbench.action.debug.stepOut",vg="workbench.action.debug.pause",td="workbench.action.debug.disconnect",Tx="workbench.action.debug.disconnectAndSuspend",Va="workbench.action.debug.stop",Kj="workbench.action.debug.restartFrame",Fh="workbench.action.debug.continue",Gj="workbench.debug.action.focusRepl",ZR="debug.jumpToCursor",_x="workbench.action.debug.focusProcess",Ku="workbench.action.debug.selectandstart",wU="workbench.action.debug.selectDebugConsole",qj="workbench.action.debug.selectDebugSession",Bh="workbench.action.debug.configure",Oc="workbench.action.debug.start",JR="workbench.action.debug.run",$j="debug.renameWatchExpression",jj="debug.setWatchExpression",Xj="debug.removeWatchExpression",Yj="workbench.action.debug.nextConsole",Qj="workbench.action.debug.prevConsole",Zj="workbench.action.debug.showLoadedScripts",Jj="workbench.action.debug.callStackTop",eX="workbench.action.debug.callStackBottom",tX="workbench.action.debug.callStackUp",iX="workbench.action.debug.callStackDown",eP="debug.addToWatchExpressions",zy="debug.copyEvaluatePath",jb="workbench.debug.viewlet.action.copyValue",tP=ie("debug","Debug"),Xb=ie("restartDebug","Restart"),Yb=ie("stepOverDebug","Step Over"),Qb=ie("stepIntoDebug","Step Into"),que=ie("stepIntoTargetDebug","Step Into Target"),Zb=ie("stepOutDebug","Step Out"),Jb=ie("pauseDebug","Pause"),Ig=ie("disconnect","Disconnect"),iP=ie("disconnectSuspend","Disconnect and Suspend"),Vh=ie("stop","Stop"),ev=ie("continueDebug","Continue"),$ue=ie("focusSession","Focus Session"),jue=ie("selectAndStartDebugging","Select and Start Debugging"),Dx=u("openLaunchJson","Open '{0}'","launch.json"),nP=ie("startDebug","Start Debugging"),nX=ie("startWithoutDebugging","Start Without Debugging"),Xue=ie("nextDebugConsole","Focus Next Debug Console"),Yue=ie("prevDebugConsole","Focus Previous Debug Console"),Que=ie("openLoadedScript","Open Loaded Script..."),Zue=ie("callStackTop","Navigate to Top of Call Stack"),Jue=ie("callStackBottom","Navigate to Bottom of Call Stack"),epe=ie("callStackUp","Navigate Up Call Stack"),tpe=ie("callStackDown","Navigate Down Call Stack"),oP=ie("copyAsExpression","Copy as Expression"),rP=ie("copyValue","Copy Value"),sP=ie("addToWatchExpressions","Add to Watch"),ipe=ie("selectDebugConsole","Select Debug Console"),npe=ie("selectDebugSession","Select Debug Session"),aP="debug ",lP="debug consoles ";function _Te(r){return r&&typeof r.sessionId=="string"&&typeof r.threadId=="string"}async function Ac(r,t,e){let i=r.get(we),n;if(_Te(t)){let o=i.getModel().getSession(t.sessionId);o&&(n=o.getAllThreads().find(s=>s.getId()===t.threadId))}else if(oX(t)){let o=i.getModel().getSession(t.sessionId);if(o){let s=o.getAllThreads();n=s.length>0?s[0]:void 0}}if(!n&&(n=i.getViewModel().focusedThread,!n)){let o=i.getViewModel().focusedSession,s=o?o.getAllThreads():void 0;n=s&&s.length?s[0]:void 0}n&&await e(n)}function DTe(r){return r&&typeof r.sessionId=="string"&&typeof r.threadId=="string"&&typeof r.frameId=="string"}function ope(r,t){if(DTe(t)){let e=r.getModel().getSession(t.sessionId);if(e){let i=e.getAllThreads().find(n=>n.getId()===t.threadId);if(i)return i.getCallStack().find(n=>n.getId()===t.frameId)}}else return r.getViewModel().focusedStackFrame}function oX(r){return r&&typeof r.sessionId=="string"}async function rpe(r,t){let e=r.get(we),i=r.get(Mi),n=e.getModel().getSessions(!0).filter(a=>a.hasSeparateRepl()),o=e.getViewModel().focusedSession,s=0;if(n.length>0&&o){for(;o&&!o.hasSeparateRepl();)o=o.parentSession;if(o){let a=n.indexOf(o);t?s=a===n.length-1?0:a+1:s=a===0?n.length-1:a-1}}await e.focusStackFrame(void 0,void 0,n[s],{explicit:!0}),i.isViewVisible(ln)||await i.openView(ln,!0)}async function spe(r,t){let e=r.getViewModel().focusedStackFrame;if(e){let i=e.thread.getCallStack(),n=i.findIndex(s=>s.frameId===e.frameId),o;if(t){if(n>=i.length-1)if(e.thread.reachedEndOfCallStack){lpe(r);return}else await r.getModel().fetchCallstack(e.thread,20),i=e.thread.getCallStack(),n=i.findIndex(s=>s.frameId===e.frameId);o=Vj(!0,i,n)}else{if(n<=0){ape(r);return}o=Vj(!1,i,n)}o&&r.focusStackFrame(o,void 0,void 0,{preserveFocus:!1})}}async function ape(r){let t=r.getViewModel().focusedThread;if(t){await r.getModel().fetchCallstack(t);let e=t.getCallStack();if(e.length>0){let i=Vj(!1,e,0);i&&r.focusStackFrame(i,void 0,void 0,{preserveFocus:!1})}}}function lpe(r){let t=r.getViewModel().focusedThread;t&&r.focusStackFrame(t.getTopStackFrame(),void 0,void 0,{preserveFocus:!1})}function Vj(r,t,e){e>=t.length?e=t.length-1:e<0&&(e=0);let i=e,n;do if(r?i===t.length-1?i=0:i++:i===0?i=t.length-1:i--,n=t[i],!Sh(n))return n;while(i!==e)}tt.registerCommand({id:Wj,handler:async(r,t,e)=>{let i=r.get(GC),n=r.get(rs),o=r.get(we),s=ope(o,e);if(s){let a=i.getEOL(s.source.uri);await n.writeText(s.thread.getCallStack().map(l=>l.toString()).join(a))}}});tt.registerCommand({id:Hj,handler:async(r,t,e)=>{await Ac(r,e,i=>i.reverseContinue())}});tt.registerCommand({id:Uj,handler:async(r,t,e)=>{let i=r.get(re);_h.getValue(i)?await Ac(r,e,n=>n.stepBack("instruction")):await Ac(r,e,n=>n.stepBack())}});tt.registerCommand({id:CU,handler:async(r,t,e)=>{await Ac(r,e,i=>i.terminate())}});tt.registerCommand({id:ZR,handler:async r=>{let e=r.get(we).getViewModel().focusedStackFrame,n=r.get($e).activeTextEditorControl,o=r.get(mi),s=r.get(ki);if(e&&no(n)&&n.hasModel()){let a=n.getPosition(),l=n.getModel().uri,d=e.thread.session.getSourceForUri(l);if(d){let p=(await e.thread.session.gotoTargets(d.raw,a.lineNumber,a.column))?.body.targets;if(p&&p.length){let h=p[0].id;if(p.length>1){let m=p.map(g=>({label:g.label,_id:g.id})),f=await s.pick(m,{placeHolder:u("chooseLocation","Choose the specific location")});if(!f)return;h=f._id}return await e.thread.session.goto(e.thread.threadId,h).catch(m=>o.warn(m))}}}return o.warn(u("noExecutableCode","No executable code is associated at the current cursor position."))}});tt.registerCommand({id:Jj,handler:async(r,t,e)=>{let i=r.get(we);lpe(i)}});tt.registerCommand({id:eX,handler:async(r,t,e)=>{let i=r.get(we);await ape(i)}});tt.registerCommand({id:tX,handler:async(r,t,e)=>{let i=r.get(we);spe(i,!1)}});tt.registerCommand({id:iX,handler:async(r,t,e)=>{let i=r.get(we);spe(i,!0)}});Ue.appendMenuItem(V.EditorContext,{command:{id:ZR,title:u("jumpToCursor","Jump to Cursor"),category:tP},when:P.and(gy,ce.editorTextFocus),group:"debug",order:3});wt.registerCommandAndKeybindingRule({id:Yj,weight:201,when:Eh,primary:2060,mac:{primary:3166},handler:async(r,t,e)=>{rpe(r,!0)}});wt.registerCommandAndKeybindingRule({id:Qj,weight:201,when:Eh,primary:2059,mac:{primary:3164},handler:async(r,t,e)=>{rpe(r,!1)}});wt.registerCommandAndKeybindingRule({id:Mh,weight:200,primary:3135,when:ui,handler:async(r,t,e)=>{let i=r.get(we),n=r.get(se),o;if(oX(e)?o=i.getModel().getSession(e.sessionId):o=i.getViewModel().focusedSession,o){let s=n.getValue("debug").showSubSessionsInToolBar;for(;!s&&o.lifecycleManagedByParent&&o.parentSession;)o=o.parentSession;o.removeReplExpressions(),await i.restartSession(o)}else{let{launch:s,name:a}=i.getConfigurationManager().selectedConfiguration;await i.startDebugging(s,a,{noDebug:!1,startedByUser:!0})}}});wt.registerCommandAndKeybindingRule({id:Ah,weight:200,primary:68,when:Gt.isEqualTo("stopped"),handler:async(r,t,e)=>{let i=r.get(re);_h.getValue(i)?await Ac(r,e,n=>n.next("instruction")):await Ac(r,e,n=>n.next())}});var dpe=si&&St?581:69;wt.registerCommandAndKeybindingRule({id:Oh,weight:210,primary:dpe,when:Gt.notEqualsTo("inactive"),handler:async(r,t,e)=>{let i=r.get(re);_h.getValue(i)?await Ac(r,e,n=>n.stepIn("instruction")):await Ac(r,e,n=>n.stepIn())}});wt.registerCommandAndKeybindingRule({id:Nh,weight:200,primary:1093,when:Gt.isEqualTo("stopped"),handler:async(r,t,e)=>{let i=r.get(re);_h.getValue(i)?await Ac(r,e,n=>n.stepOut("instruction")):await Ac(r,e,n=>n.stepOut())}});wt.registerCommandAndKeybindingRule({id:vg,weight:202,primary:64,when:Gt.isEqualTo("running"),handler:async(r,t,e)=>{await Ac(r,e,i=>i.pause())}});wt.registerCommandAndKeybindingRule({id:zj,primary:dpe|2048,when:P.and(Cb,ui,Gt.isEqualTo("stopped")),weight:200,handler:async(r,t,e)=>{let i=r.get(ki),n=r.get(we),o=n.getViewModel().focusedSession,s=n.getViewModel().focusedStackFrame;if(!s||!o)return;let a=await r.get($e).openEditor({resource:s.source.uri,options:{revealIfOpened:!0}}),l;if(a){let p=a?.getControl();no(p)&&(l=p)}let d=new B,c=d.add(i.createQuickPick());c.busy=!0,c.show(),d.add(c.onDidChangeActive(([p])=>{l&&p&&p.target.line!==void 0&&(l.revealLineInCenterIfOutsideViewport(p.target.line),l.setSelection({startLineNumber:p.target.line,startColumn:p.target.column||1,endLineNumber:p.target.endLine||p.target.line,endColumn:p.target.endColumn||p.target.column||1}))})),d.add(c.onDidAccept(()=>{c.activeItems.length&&o.stepIn(s.thread.threadId,c.activeItems[0].target.id)})),d.add(c.onDidHide(()=>d.dispose())),o.stepInTargets(s.frameId).then(p=>{c.busy=!1,p?.length?c.items=p?.map(h=>({target:h,label:h.label})):c.placeholder=u("editor.debug.action.stepIntoTargets.none","No step targets available")})}});async function rX(r,t,e,i,n){let o=r.get(we),s;oX(e)?s=o.getModel().getSession(e.sessionId):s=o.getViewModel().focusedSession;let l=r.get(se).getValue("debug").showSubSessionsInToolBar;for(;!l&&s&&s.lifecycleManagedByParent&&s.parentSession;)s=s.parentSession;await o.stopSession(s,i,n)}wt.registerCommandAndKeybindingRule({id:td,weight:200,primary:1087,when:P.and(qs,ui),handler:(r,t,e)=>rX(r,t,e,!0)});tt.registerCommand({id:Tx,handler:(r,t,e)=>rX(r,t,e,!0,!0)});wt.registerCommandAndKeybindingRule({id:Va,weight:200,primary:1087,when:P.and(qs.toNegated(),ui),handler:(r,t,e)=>rX(r,t,e,!1)});tt.registerCommand({id:Kj,handler:async(r,t,e)=>{let i=r.get(we),n=r.get(mi),o=ope(i,e);if(o)try{await o.restart()}catch(s){n.error(s)}}});wt.registerCommandAndKeybindingRule({id:Fh,weight:210,primary:63,when:Gt.isEqualTo("stopped"),handler:async(r,t,e)=>{await Ac(r,e,i=>i.continue())}});tt.registerCommand({id:Zj,handler:async r=>{await Lue(r)}});tt.registerCommand({id:Gj,handler:async r=>{await r.get(Mi).openView(ln,!0)}});tt.registerCommand({id:"debug.startFromConfig",handler:async(r,t)=>{await r.get(we).startDebugging(void 0,t)}});tt.registerCommand({id:_x,handler:async(r,t)=>{let e=r.get(we),i=r.get($e),n=e.getModel().getSessions().find(s=>s.parentSession===t&&s.state===2);n&&t.state!==2&&(t=n),await e.focusStackFrame(void 0,void 0,t,{explicit:!0});let o=e.getViewModel().focusedStackFrame;o&&await o.openInEditor(i,!0)}});tt.registerCommand({id:Ku,handler:async(r,t,e)=>{let i=r.get(ki),n=r.get(we);if(t){let o=n.getConfigurationManager(),s=await o.getDynamicProviders();for(let a of s)if(a.type===t){let l=await a.pick();if(l){await o.selectConfiguration(l.launch,l.config.name,l.config,{type:a.type}),n.startDebugging(l.launch,l.config,{noDebug:e?.noDebug,startedByUser:!0});return}}}i.quickAccess.show(aP)}});tt.registerCommand({id:wU,handler:async r=>{r.get(ki).quickAccess.show(lP)}});tt.registerCommand({id:qj,handler:async r=>{Pue(r,Ku)}});wt.registerCommandAndKeybindingRule({id:Oc,weight:200,primary:63,when:P.and(oi,Gt.isEqualTo("inactive")),handler:async(r,t)=>{let e=r.get(we);await VL(r.get(se),r.get($e));let{launch:i,name:n,getConfig:o}=e.getConfigurationManager().selectedConfiguration,s=await o(),a=s?Object.assign(Xi(s),t?.config):n;await e.startDebugging(i,a,{noDebug:t?.noDebug,startedByUser:!0},!1)}});wt.registerCommandAndKeybindingRule({id:JR,weight:200,primary:2111,mac:{primary:319},when:P.and(oi,Gt.notEqualsTo(Ql(1))),handler:async r=>{await r.get(ct).executeCommand(Oc,{noDebug:!0})}});wt.registerCommandAndKeybindingRule({id:"debug.toggleBreakpoint",weight:205,when:P.and(vE,dB.toNegated()),primary:10,handler:r=>{let t=r.get(Wo),e=r.get(we),i=t.lastFocusedList;if(i instanceof ho){let n=i.getFocusedElements();n&&n.length&&e.enableOrDisableBreakpoints(!n[0].enabled,n[0])}}});wt.registerCommandAndKeybindingRule({id:"debug.enableOrDisableBreakpoint",weight:200,primary:void 0,when:ce.editorTextFocus,handler:r=>{let t=r.get(we),i=r.get($e).activeTextEditorControl;if(no(i)){let n=i.getModel();if(n){let o=i.getPosition();if(o){let s=t.getModel().getBreakpoints({uri:n.uri,lineNumber:o.lineNumber});s.length&&t.enableOrDisableBreakpoints(!s[0].enabled,s[0])}}}}});wt.registerCommandAndKeybindingRule({id:$j,weight:205,when:XL,primary:60,mac:{primary:3},handler:(r,t)=>{let e=r.get(we);if(!(t instanceof Hi)){let n=r.get(Wo).lastFocusedList;if(n){let o=n.getFocus();Array.isArray(o)&&o[0]instanceof Hi&&(t=o[0])}}t instanceof Hi&&e.getViewModel().setSelectedExpression(t,!1)}});tt.registerCommand({id:jj,handler:async(r,t)=>{let e=r.get(we);(t instanceof Hi||t instanceof Li)&&e.getViewModel().setSelectedExpression(t,!0)}});wt.registerCommandAndKeybindingRule({id:"debug.setVariable",weight:205,when:aV,primary:60,mac:{primary:3},handler:r=>{let t=r.get(Wo),e=r.get(we),i=t.lastFocusedList;if(i){let n=i.getFocus();Array.isArray(n)&&n[0]instanceof Li&&e.getViewModel().setSelectedExpression(n[0],!1)}}});wt.registerCommandAndKeybindingRule({id:Xj,weight:200,when:P.and(XL,lV.toNegated()),primary:20,mac:{primary:2049},handler:(r,t)=>{let e=r.get(we);if(t instanceof Hi){e.removeWatchExpressions(t.getId());return}let n=r.get(Wo).lastFocusedList;if(n){let o=n.getFocus();if(Array.isArray(o)&&o[0]instanceof Hi){let s=n.getSelection();s&&s.indexOf(o[0])>=0&&(o=s),o.forEach(a=>e.removeWatchExpressions(a.getId()))}}}});wt.registerCommandAndKeybindingRule({id:"debug.removeBreakpoint",weight:200,when:P.and(vE,dV.toNegated()),primary:20,mac:{primary:2049},handler:r=>{let t=r.get(Wo),e=r.get(we),i=t.lastFocusedList;if(i instanceof ho){let n=i.getFocusedElements(),o=n.length?n[0]:void 0;o instanceof ir?e.removeBreakpoints(o.getId()):o instanceof ns?e.removeFunctionBreakpoints(o.getId()):o instanceof xs&&e.removeDataBreakpoints(o.getId())}}});wt.registerCommandAndKeybindingRule({id:"debug.installAdditionalDebuggers",weight:200,when:void 0,primary:void 0,handler:async(r,t)=>{let e=r.get(KR),i="@category:debuggers";return typeof t=="string"&&(i+=` ${t}`),e.openSearch(i)}});he(class extends Me{constructor(){super({id:Uy,title:ie("addConfiguration","Add Configuration..."),category:tP,f1:!0,menu:{id:V.EditorContent,when:P.and(P.regex(zs.Path.key,/\.vscode[/\\]launch\.json$/),$9.isEqualTo(Oue))}})}async run(t,e){let i=t.get(we).getConfigurationManager(),n=i.getLaunches().find(o=>o.uri.toString()===e)||i.selectedConfiguration.launch;if(n){let{editor:o,created:s}=await n.openConfigFile({preserveFocus:!1});if(o&&!s){let a=o.getControl();a&&await a.getContribution(dg)?.addLaunchConfiguration()}}}});var kTe=r=>{let t=r.get(we),i=r.get($e).activeTextEditorControl;if(no(i)){let n=i.getPosition();if(n&&i.hasModel()&&t.canSetBreakpointsIn(i.getModel())){let o=i.getModel().uri;t.getModel().getBreakpoints({lineNumber:n.lineNumber,uri:o}).some(a=>a.sessionAgnosticData.column===n.column||!a.column&&n.column<=1)||t.addBreakpoints(o,[{lineNumber:n.lineNumber,column:n.column>1?n.column:void 0}])}}};wt.registerCommandAndKeybindingRule({weight:200,primary:1091,when:ce.editorTextFocus,id:QR,handler:kTe});Ue.appendMenuItem(V.EditorContext,{command:{id:QR,title:u("addInlineBreakpoint","Add Inline Breakpoint"),category:tP},when:P.and(ui,wL.toNegated(),ce.editorTextFocus,xx.toNegated()),group:"debug",order:1});wt.registerCommandAndKeybindingRule({id:"debug.openBreakpointToSide",weight:200,when:vE,primary:2051,secondary:[515],handler:r=>{let e=r.get(Wo).lastFocusedList;if(e instanceof ho){let i=e.getFocusedElements();if(i.length&&i[0]instanceof ir)return xE(i[0],!0,!1,!0,r.get(we),r.get($e))}}});wt.registerCommandAndKeybindingRule({id:"debug.openView",weight:200,when:oi.toNegated(),primary:63,secondary:[2111],handler:async r=>{await r.get(ed).openPaneComposite(nr,0,!0)}});var ppe=q("tunnelService"),Tkn=q("sharedTunnelsService");function hpe(r){if(r.scheme!=="http"&&r.scheme!=="https")return;let t=/^(localhost|127\.0\.0\.1|0\.0\.0\.0):(\d+)$/.exec(r.authority);if(t)return{address:t[1],port:+t[2]}}var sX=["localhost","127.0.0.1","0:0:0:0:0:0:0:1","::1"];function cpe(r){return sX.indexOf(r)>=0}var aX=["0.0.0.0","0:0:0:0:0:0:0:0","::"];function upe(r){return aX.indexOf(r)>=0}var EU=class extends R{constructor(e,i){super();this.logService=e;this.configurationService=i}_onTunnelOpened=new x;onTunnelOpened=this._onTunnelOpened.event;_onTunnelClosed=new x;onTunnelClosed=this._onTunnelClosed.event;_onAddedTunnelProvider=new x;onAddedTunnelProvider=this._onAddedTunnelProvider.event;_tunnels=new Map;_tunnelProvider;_canElevate=!1;_canChangeProtocol=!0;_privacyOptions=[];_factoryInProgress=new Set;get hasTunnelProvider(){return!!this._tunnelProvider}get defaultTunnelHost(){let e=this.configurationService.getValue("remote.localPortHost");return!e||e==="localhost"?"127.0.0.1":"0.0.0.0"}setTunnelProvider(e){return this._tunnelProvider=e,e?(this._onAddedTunnelProvider.fire(),{dispose:()=>{this._tunnelProvider=void 0,this._canElevate=!1,this._privacyOptions=[]}}):(this._canElevate=!1,this._privacyOptions=[],this._onAddedTunnelProvider.fire(),{dispose:()=>{}})}setTunnelFeatures(e){this._canElevate=e.elevation,this._privacyOptions=e.privacyOptions,this._canChangeProtocol=e.protocol}get canChangeProtocol(){return this._canChangeProtocol}get canElevate(){return this._canElevate}get canChangePrivacy(){return this._privacyOptions.length>0}get privacyOptions(){return this._privacyOptions}get tunnels(){return this.getTunnels()}async getTunnels(){let e=[],i=Array.from(this._tunnels.values());for(let n of i){let o=Array.from(n.values());for(let s of o){let a=await s.value;a&&typeof a!="string"&&e.push(a)}}return e}async dispose(){super.dispose();for(let e of this._tunnels.values()){for(let{value:i}of e.values())await i.then(n=>typeof n!="string"?n?.dispose():void 0);e.clear()}this._tunnels.clear()}setEnvironmentTunnel(e,i,n,o,s){this.addTunnelToMap(e,i,Promise.resolve({tunnelRemoteHost:e,tunnelRemotePort:i,localAddress:n,privacy:o,protocol:s,dispose:()=>Promise.resolve()}))}async getExistingTunnel(e,i){(upe(e)||cpe(e))&&(e=sX[0]);let n=this.getTunnelFromMap(e,i);if(n)return++n.refcount,n.value}openTunnel(e,i,n,o,s,a=!1,l,d){this.logService.trace(`ForwardedPorts: (TunnelService) openTunnel request for ${i}:${n} on local port ${s}.`);let c=this._tunnelProvider??e;if(!c)return;if(i||(i="localhost"),o||(o=this.defaultTunnelHost),this._tunnelProvider&&this._factoryInProgress.has(n)){this.logService.debug("ForwardedPorts: (TunnelService) Another call to create a tunnel with the same address has occurred before the last one completed. This call will be ignored.");return}let p=this.retainOrCreateTunnel(c,i,n,o,s,a,l,d);return p?p.then(h=>{if(h){if(typeof h=="string")return this.logService.trace("ForwardedPorts: (TunnelService) The tunnel provider returned an error when creating the tunnel."),this.removeEmptyOrErrorTunnelFromMap(i,n),h}else{this.logService.trace("ForwardedPorts: (TunnelService) New tunnel is undefined."),this.removeEmptyOrErrorTunnelFromMap(i,n);return}this.logService.trace("ForwardedPorts: (TunnelService) New tunnel established.");let m=this.makeTunnel(h);return(h.tunnelRemoteHost!==i||h.tunnelRemotePort!==n)&&this.logService.warn("ForwardedPorts: (TunnelService) Created tunnel does not match requirements of requested tunnel. Host or port mismatch."),l&&h.privacy!==l&&this.logService.warn("ForwardedPorts: (TunnelService) Created tunnel does not match requirements of requested tunnel. Privacy mismatch."),this._onTunnelOpened.fire(m),m}):(this.logService.trace("ForwardedPorts: (TunnelService) Tunnel was not created."),p)}makeTunnel(e){return{tunnelRemotePort:e.tunnelRemotePort,tunnelRemoteHost:e.tunnelRemoteHost,tunnelLocalPort:e.tunnelLocalPort,localAddress:e.localAddress,privacy:e.privacy,protocol:e.protocol,dispose:async()=>{this.logService.trace(`ForwardedPorts: (TunnelService) dispose request for ${e.tunnelRemoteHost}:${e.tunnelRemotePort} `);let i=this._tunnels.get(e.tunnelRemoteHost);if(i){let n=i.get(e.tunnelRemotePort);n&&(n.refcount--,await this.tryDisposeTunnel(e.tunnelRemoteHost,e.tunnelRemotePort,n))}}}}async tryDisposeTunnel(e,i,n){if(n.refcount<=0){this.logService.trace(`ForwardedPorts: (TunnelService) Tunnel is being disposed ${e}:${i}.`);let o=n.value.then(async s=>{s&&typeof s!="string"&&(await s.dispose(!0),this._onTunnelClosed.fire({host:s.tunnelRemoteHost,port:s.tunnelRemotePort}))});return this._tunnels.has(e)&&this._tunnels.get(e).delete(i),o}}async closeTunnel(e,i){this.logService.trace(`ForwardedPorts: (TunnelService) close request for ${e}:${i} `);let n=this._tunnels.get(e);if(n&&n.has(i)){let o=n.get(i);o.refcount=0,await this.tryDisposeTunnel(e,i,o)}}addTunnelToMap(e,i,n){this._tunnels.has(e)||this._tunnels.set(e,new Map),this._tunnels.get(e).set(i,{refcount:1,value:n})}async removeEmptyOrErrorTunnelFromMap(e,i){let n=this._tunnels.get(e);if(n){let o=n.get(i),s=o?await o.value:void 0;(!s||typeof s=="string")&&n.delete(i),n.size===0&&this._tunnels.delete(e)}}getTunnelFromMap(e,i){let n=[e];cpe(e)?(n.push(...sX),n.push(...aX)):upe(e)&&n.push(...aX);let o=n.map(s=>this._tunnels.get(s));for(let s of o){let a=s?.get(i);if(a)return a}}canTunnel(e){return!!hpe(e)}createWithProvider(e,i,n,o,s,a,l){this.logService.trace(`ForwardedPorts: (TunnelService) Creating tunnel with provider ${i}:${n} on local port ${o}.`);let d=n;this._factoryInProgress.add(d);let c=o===void 0?n:o,p={elevationRequired:s?this.isPortPrivileged(c):!1},h={remoteAddress:{host:i,port:n},localAddressPort:o,privacy:a,public:a?a!=="private":void 0,protocol:l},m=e.forwardPort(h,p);return m?(this.addTunnelToMap(i,n,m),m.finally(()=>{this.logService.trace("ForwardedPorts: (TunnelService) Tunnel created by provider."),this._factoryInProgress.delete(d)})):this._factoryInProgress.delete(d),m}};EU=E([b(0,bt),b(1,se)],EU);function mpe(r){return r.scheme!==Ie.file&&r.scheme!==Ie.vscodeRemote}function lX(r){if(r.folders.length)return r.folders.every(t=>mpe(t.uri))?r.folders[0].uri:void 0;if(r.configuration&&mpe(r.configuration))return r.configuration}function gpe(r){return lX(r)?.scheme}var yg=q("pathService"),kx=class{constructor(t,e,i,n){this.localUserHome=t;this.remoteAgentService=e;this.environmentService=i;this.contextService=n;this.resolveOS=(async()=>(await this.remoteAgentService.getEnvironment())?.os||Ys)(),this.resolveUserHome=(async()=>{let o=await this.remoteAgentService.getEnvironment();return this.maybeUnresolvedUserHome=o?.userHome??t})()}resolveOS;resolveUserHome;maybeUnresolvedUserHome;hasValidBasename(t,e,i){return typeof e=="string"||typeof e>"u"?this.resolveOS.then(n=>this.doHasValidBasename(t,n,e)):this.doHasValidBasename(t,e,i)}doHasValidBasename(t,e,i){return t.scheme===Ie.file||t.scheme===Ie.vscodeRemote?_ee(i??Ji(t),e===1):!0}get defaultUriScheme(){return kx.findDefaultUriScheme(this.environmentService,this.contextService)}static findDefaultUriScheme(t,e){if(t.remoteAuthority)return Ie.vscodeRemote;let i=gpe(e.getWorkspace());if(i)return i;let n=e.getWorkspace().folders[0];if(n)return n.uri.scheme;let o=e.getWorkspace().configuration;return o?o.scheme:Ie.file}userHome(t){return t?.preferLocal?this.localUserHome:this.resolveUserHome}get resolvedUserHome(){return this.maybeUnresolvedUserHome}get path(){return this.resolveOS.then(t=>t===1?Zn:Xt)}async fileURI(t){let e="";if(await this.resolveOS===1&&(t=t.replace(/\\/g,"/")),t[0]==="/"&&t[1]==="/"){let n=t.indexOf("/",2);n===-1?(e=t.substring(2),t="/"):(e=t.substring(2,n),t=t.substring(n)||"/")}return Z.from({scheme:Ie.file,authority:e,path:t,query:"",fragment:""})}};kx=E([b(1,qF),b(2,Jo),b(3,kt)],kx);var fpe="\\u0000-\\u0020\\u007f-\\u009f",LTe=new RegExp("(?:[a-zA-Z][a-zA-Z0-9+.-]{2,}:\\/\\/|data:|www\\.)[^\\s"+fpe+'"]{2,}[^\\s'+fpe+`"')}\\],:;.!?]`,"ug"),RTe=/(?:[a-zA-Z]:(?:(?:\\|\/)[\w\.-]*)+)/,PTe=/(?:(?:\~|\.)(?:(?:\\|\/)[\w\.-]*)+)/,MTe=new RegExp(`(${RTe.source}|${PTe.source})`),ATe=/((?:\~|\.)?(?:\/[\w\.-]*)+)/,OTe=/(?:\:([\d]+))?(?:\:([\d]+))?/,NTe=new RegExp(`${St?MTe.source:ATe.source}${OTe.source}`,"g"),FTe=/:([\d]+)(?::([\d]+))?$/,BTe=2e3;var id=class{constructor(t,e,i,n,o,s,a,l){this.editorService=t;this.fileService=e;this.openerService=i;this.pathService=n;this.tunnelService=o;this.environmentService=s;this.configurationService=a;this.hoverService=l}linkify(t,e,i,n,o){return this._linkify(t,e,i,n,o)}_linkify(t,e,i,n,o,s){if(e){let l=t.split(`
`);for(let p=0;p<l.length-1;p++)l[p]=l[p]+`
`;l[l.length-1]||l.pop();let d=l.map(p=>this._linkify(p,!1,i,n,o,s));if(d.length===1)return d[0];let c=document.createElement("span");return d.forEach(p=>c.appendChild(p)),c}let a=document.createElement("span");for(let l of this.detectLinks(t))try{switch(l.kind){case"text":a.appendChild(s?this.linkifyLocation(l.value,s.locationReference,s.session,o):document.createTextNode(l.value));break;case"web":a.appendChild(this.createWebLink(n?t:void 0,l.value,o));break;case"path":{let d=l.captures[0],c=l.captures[1]?Number(l.captures[1]):0,p=l.captures[2]?Number(l.captures[2]):0;a.appendChild(this.createPathLink(n?t:void 0,l.value,d,c,p,i,o));break}}}catch{a.appendChild(document.createTextNode(l.value))}return a}linkifyLocation(t,e,i,n){let o=this.createLink(t);return this.decorateLink(o,void 0,t,n,async s=>{let a=await i.resolveLocationReference(e);await a.source.openInEditor(this.editorService,{startLineNumber:a.line,startColumn:a.column,endLineNumber:a.endLine??a.line,endColumn:a.endColumn??a.column},s)}),o}makeReferencedLinkDetector(t,e){return{linkify:(i,n,o,s,a)=>this._linkify(i,n,o,s,a,{locationReference:t,session:e}),linkifyLocation:this.linkifyLocation.bind(this)}}createWebLink(t,e,i){let n=this.createLink(e),o=Z.parse(e),s=FTe.exec(o.path);return s&&(o=o.with({path:o.path.slice(0,s.index),fragment:`L${s[0].slice(1)}`})),this.decorateLink(n,o,t,i,async()=>{if(o.scheme===Ie.file){let a=o.fsPath,l=await this.pathService.path,d=ds(l.sep===Xt.sep&&St?a.replace(/\\/g,Xt.sep):a),c=Z.parse(d);if(!await this.fileService.exists(c))return;await this.editorService.openEditor({resource:c,options:{pinned:!0,selection:s?{startLineNumber:+s[1],startColumn:+s[2]}:void 0}});return}this.openerService.open(e,{allowTunneling:!!this.environmentService.remoteAuthority&&this.configurationService.getValue("remote.forwardOnOpen")})}),n}createPathLink(t,e,i,n,o,s,a){if(i[0]==="/"&&i[1]==="/")return document.createTextNode(e);let l={selection:{startLineNumber:n,startColumn:o}};if(i[0]==="."){if(!s)return document.createTextNode(e);let p=s.toResource(i),h=this.createLink(e);return this.decorateLink(h,p,t,a,m=>this.editorService.openEditor({resource:p,options:{...l,preserveFocus:m}})),h}if(i[0]==="~"){let p=this.pathService.resolvedUserHome;p&&(i=cs(p.fsPath,i.substring(1)))}let d=this.createLink(e);d.tabIndex=0;let c=Z.file(ds(i));return this.fileService.stat(c).then(p=>{p.isDirectory||this.decorateLink(d,c,t,a,h=>this.editorService.openEditor({resource:c,options:{...l,preserveFocus:h}}))}).catch(()=>{}),d}createLink(t){let e=document.createElement("a");return e.textContent=t,e}decorateLink(t,e,i,n,o){t.classList.add("link");let s=e&&this.tunnelService.canTunnel(e)?u("followForwardedLink","follow link using forwarded port"):u("followLink","follow link"),a=t.ariaLabel=i?ye?u("fileLinkWithPathMac",`Cmd + click to {0}
{1}`,s,i):u("fileLinkWithPath",`Ctrl + click to {0}
{1}`,s,i):ye?u("fileLinkMac","Cmd + click to {0}",s):u("fileLink","Ctrl + click to {0}",s);n?.type===0?n.store.add(this.hoverService.setupManagedHover(gt("element"),t,a)):n?.type!==2&&(t.title=a),t.onmousemove=l=>{t.classList.toggle("pointer",ye?l.metaKey:l.ctrlKey)},t.onmouseleave=()=>t.classList.remove("pointer"),t.onclick=l=>{let d=ue(t).getSelection();!d||d.type==="Range"||(ye?l.metaKey:l.ctrlKey)&&(l.preventDefault(),l.stopImmediatePropagation(),o(!1))},t.onkeydown=l=>{let d=new ut(l);(d.keyCode===3||d.keyCode===10)&&(d.preventDefault(),d.stopPropagation(),o(d.keyCode===10))}}detectLinks(t){if(t.length>BTe)return[{kind:"text",value:t,captures:[]}];let e=[LTe,NTe],i=["web","path"],n=[],o=(s,a)=>{if(a>=e.length){n.push({value:s,kind:"text",captures:[]});return}let l=e[a],d=0,c;for(l.lastIndex=0;(c=l.exec(s))!==null;){let h=s.substring(d,c.index);h&&o(h,a+1);let m=c[0];n.push({value:m,kind:i[a],captures:c.slice(1)}),d=c.index+m.length}let p=s.substring(d);p&&o(p,a+1)};return o(t,0),n}};id=E([b(0,$e),b(1,Ei),b(2,Yi),b(3,yg),b(4,ppe),b(5,Jo),b(6,se),b(7,Nt)],id);var bpe=1e4,VTe=0,dX=()=>`topReplElement:${VTe++}`,Gu=class{constructor(t,e,i,n,o,s){this.session=t;this.id=e;this.value=i;this.severity=n;this.sourceData=o;this.expression=s}_count=1;_onDidChangeCount=new x;toString(t=!1){let e=this.value;for(let n=1;n<this.count;n++)e+=(e.endsWith(`
`)?"":`
`)+this.value;let i=this.sourceData&&t?` ${this.sourceData.source.name}`:"";return e+i}getId(){return this.id}getChildren(){return this.expression?.getChildren()||Promise.resolve([])}set count(t){this._count=t,this._onDidChangeCount.fire()}get count(){return this._count}get onDidChangeCount(){return this._onDidChangeCount.event}get hasChildren(){return!!this.expression?.hasChildren}},Ky=class{constructor(t,e,i){this.expression=t;this.severity=e;this.sourceData=i;this.hasChildren=t.hasChildren}hasChildren;id=Ni();getChildren(){return this.expression.getChildren()}toString(){return this.expression.toString()}getId(){return this.id}},xU=class r{constructor(t,e,i,n,o){this.id=t;this.name=e;this.valueObj=i;this.sourceData=n;this.annotation=o}static MAX_CHILDREN=1e3;getId(){return this.id}get value(){return this.valueObj===null?"null":Array.isArray(this.valueObj)?`Array[${this.valueObj.length}]`:vi(this.valueObj)?"Object":Bt(this.valueObj)?`"${this.valueObj}"`:String(this.valueObj)||""}get hasChildren(){return Array.isArray(this.valueObj)&&this.valueObj.length>0||vi(this.valueObj)&&Object.getOwnPropertyNames(this.valueObj).length>0}evaluateLazy(){throw new Error("Method not implemented.")}getChildren(){let t=[];return Array.isArray(this.valueObj)?t=this.valueObj.slice(0,r.MAX_CHILDREN).map((e,i)=>new r(`${this.id}:${i}`,String(i),e)):vi(this.valueObj)&&(t=Object.getOwnPropertyNames(this.valueObj).slice(0,r.MAX_CHILDREN).map((e,i)=>new r(`${this.id}:${i}`,e,this.valueObj[e]))),Promise.resolve(t)}toString(){return`${this.name}
${this.value}`}},tv=class{constructor(t){this.value=t;this.id=Ni()}id;toString(){return this.value}getId(){return this.id}},jd=class extends Wd{constructor(e){super(void 0,void 0,0,Ni());this.originalExpression=e}_available=!0;get available(){return this._available}async evaluateExpression(e,i,n,o){let s=await super.evaluateExpression(e,i,n,o);return this._available=s,s}toString(){return`${this.value}`}},Wh=class r{constructor(t,e,i){this.name=t;this.autoExpand=e;this.sourceData=i;this.id=`replGroup:${r.COUNTER++}`}children=[];id;ended=!1;static COUNTER=0;get hasChildren(){return!0}getId(){return this.id}toString(t=!1){let e=t&&this.sourceData?` ${this.sourceData.source.name}`:"";return this.name+e}addChild(t){let e=this.children.length?this.children[this.children.length-1]:void 0;e instanceof r&&!e.hasEnded?e.addChild(t):this.children.push(t)}getChildren(){return this.children}end(){let t=this.children.length?this.children[this.children.length-1]:void 0;t instanceof r&&!t.hasEnded?t.end():this.ended=!0}get hasEnded(){return this.ended}};function WTe(r,t){return!r&&!t?!0:r&&t?r.column===t.column&&r.lineNumber===t.lineNumber&&r.source.uri.toString()===t.source.uri.toString():!1}var TU=class r{constructor(t){this.configurationService=t}replElements=[];_onDidChangeElements=new x;onDidChangeElements=this._onDidChangeElements.event;getReplElements(){return this.replElements}async addReplExpression(t,e,i){this.addReplElement(new tv(i));let n=new jd(i);await n.evaluateExpression(i,t,e,"repl"),this.addReplElement(n)}appendToRepl(t,{output:e,expression:i,sev:n,source:o}){let s="\x1B[2J",a=e.lastIndexOf(s);if(a!==-1&&(this.removeReplExpressions(),this.appendToRepl(t,{output:u("consoleCleared","Console was cleared"),sev:Si.Ignore}),e=e.substring(a+s.length)),i){this.addReplElement(e?new Gu(t,dX(),e,n,o,i):new Ky(i,n,o));return}let l=this.replElements.length?this.replElements[this.replElements.length-1]:void 0;if(l instanceof Gu&&l.severity===n){let c=this.configurationService.getValue("debug");if(l.value===e&&WTe(l.sourceData,o)&&c.console.collapseIdenticalLines){l.count++;return}if(!l.value.endsWith(`
`)&&!l.value.endsWith(`\r
`)&&l.count===1){this.replElements[this.replElements.length-1]=new Gu(t,dX(),l.value+e,n,o),this._onDidChangeElements.fire(void 0);return}}let d=new Gu(t,dX(),e,n,o);this.addReplElement(d)}startGroup(t,e,i){let n=new Wh(t,e,i);this.addReplElement(n)}endGroup(){let t=this.replElements[this.replElements.length-1];t instanceof Wh&&t.end()}addReplElement(t){let e=this.replElements.length?this.replElements[this.replElements.length-1]:void 0;e instanceof Wh&&!e.hasEnded?e.addChild(t):(this.replElements.push(t),this.replElements.length>bpe&&this.replElements.splice(0,this.replElements.length-bpe)),this._onDidChangeElements.fire(t)}removeReplExpressions(){this.replElements.length>0&&(this.replElements=[],this._onDidChangeElements.fire(void 0))}clone(){let t=new r(this.configurationService);return t.replElements=this.replElements.slice(),t}};var UTe=1024,zTe=/^(true|false)$/i,KTe=/^(['"]).*\1$/,iv=J;function nv(r){let t=iv(".");return t.classList.add("debug-view-content"),r.appendChild(t),t}function Xd(r,t,e,i,n){let o=typeof t=="string"?t:t.value;e.className="value",o===null||(t instanceof Hi||t instanceof Li||t instanceof jd)&&!t.available?(e.classList.add("unavailable"),o!==Hi.DEFAULT_VALUE&&e.classList.add("error")):(typeof t!="string"&&i.showChanged&&t.valueChanged&&o!==Hi.DEFAULT_VALUE&&(e.className="value changed",t.valueChanged=!1),i.colorize&&typeof t!="string"&&(t.type==="number"||t.type==="boolean"||t.type==="string"?e.classList.add(t.type):isNaN(+o)?zTe.test(o)?e.classList.add("boolean"):KTe.test(o)&&e.classList.add("string"):e.classList.add("number"))),i.maxValueLength&&o&&o.length>i.maxValueLength&&(o=o.substring(0,i.maxValueLength)+"..."),o||(o="");let s=t instanceof Wd?t.getSession():void 0,a=i.hover===!1?{type:0,store:r}:{type:2};if(t instanceof Wd&&t.valueLocationReference!==void 0&&s&&i.linkDetector?(e.textContent="",e.appendChild(i.linkDetector.linkifyLocation(o,t.valueLocationReference,s,a))):i.linkDetector?(e.textContent="",e.appendChild(i.linkDetector.linkify(o,!1,s?s.root:void 0,!0,a))):e.textContent=o,i.hover!==!1){let{commands:l=[],commandService:d}=i.hover||{};r.add(n.setupManagedHover(gt("mouse"),e,()=>{let c=J("div"),p=J("div.hover-row"),h=U(p,J("div.hover-contents")),m=U(h,J("pre.debug-var-hover-pre"));return m.textContent=o,c.appendChild(p),c},{actions:l.map(({id:c,args:p})=>{let h=tt.getCommand(c)?.metadata?.description;return{label:typeof h=="string"?h:h?h.value:c,commandId:c,run:()=>d.executeCommand(c,...p)}})}))}}function _U(r,t,e,i,n,o,s,a,l){if(i.available){n.type.textContent="";let c=i.name;i.value&&typeof i.name=="string"&&(i.type&&l?(c+=": ",n.type.textContent=i.type+" ="):c+=" ="),n.label.set(c,s,i.type&&!l?i.type:i.name),n.name.classList.toggle("virtual",i.presentationHint?.kind==="virtual"),n.name.classList.toggle("internal",i.presentationHint?.visibility==="internal")}else i.value&&typeof i.name=="string"&&i.name&&n.label.set(":");n.expression.classList.toggle("lazy",!!i.presentationHint?.lazy);let d=[{id:jb,args:[i,[i]]}];i.evaluateName&&d.push({id:zy,args:[{variable:i}]}),Xd(r,i,n.value,{showChanged:o,maxValueLength:UTe,hover:{commands:d,commandService:t},colorize:!0,linkDetector:a},e)}var Hh=class{constructor(t,e){this.debugService=t;this.debugVisualizer=e}async getChildren(t){let e=this.debugService.getViewModel(),i=await this.doGetChildren(t);return Promise.all(i.map(async n=>{let o=e.getVisualizedExpression(n);if(typeof o=="string"){let s=await this.debugVisualizer.getVisualizedNodeFor(o,n);if(s)return e.setVisualizedExpression(n,s),s}else if(o)return o;return n}))}};Hh=E([b(0,we),b(1,hE)],Hh);var qu=class{constructor(t,e,i){this.debugService=t;this.contextViewService=e;this.hoverService=i}renderTemplate(t){let e=new B,i=U(t,iv(".expression")),n=U(i,iv("span.name")),o=U(i,iv("span.lazy-button"));o.classList.add(...de.asClassNameArray(N.eye)),e.add(this.hoverService.setupManagedHover(gt("mouse"),o,u("debug.lazyButton.tooltip","Click to expand")));let s=U(i,iv("span.type")),a=U(i,iv("span.value")),l=e.add(new Rr(n)),d=U(i,iv(".inputBoxContainer")),c;this.renderActionBar&&(U(i,iv(".span.actionbar-spacer")),c=e.add(new Fi(i)));let p={expression:i,name:n,type:s,value:a,label:l,inputBoxContainer:d,actionBar:c,elementDisposable:new B,templateDisposable:e,lazyButton:o,currentElement:void 0};return e.add(F(o,Q.CLICK,()=>{p.currentElement&&this.debugService.getViewModel().evaluateLazyExpression(p.currentElement)})),p}renderExpressionElement(t,e,i){i.currentElement=t,this.renderExpression(e.element,i,qo(e.filterData)),i.actionBar&&this.renderActionBar(i.actionBar,t,i);let n=this.debugService.getViewModel().getSelectedExpression();if(t===n?.expression||t instanceof Li&&t.errorMessage){let o=this.getInputBoxOptions(t,!!n?.settingWatch);o&&i.elementDisposable.add(this.renderInputBox(i.name,i.value,i.inputBoxContainer,o))}}renderInputBox(t,e,i,n){t.style.display="none",e.style.display="none",i.style.display="initial",ai(i);let o=new rh(i,this.contextViewService,{...n,inputBoxStyles:Zm});o.value=n.initialValue,o.focus(),o.select();let s=$a((l,d)=>{t.style.display="",e.style.display="",i.style.display="none";let c=o.value;_e(a),d&&(this.debugService.getViewModel().setSelectedExpression(void 0,!1),n.onFinish(c,l))}),a=[o,Ut(o.inputElement,Q.KEY_DOWN,l=>{let d=l.equals(9),c=l.equals(3);(d||c)&&(l.preventDefault(),l.stopPropagation(),s(c,!0))}),F(o.inputElement,Q.BLUR,()=>{s(!0,!0)}),F(o.inputElement,Q.CLICK,l=>{l.preventDefault(),l.stopPropagation()})];return le(()=>{s(!1,!1)})}disposeElement(t,e,i){i.elementDisposable.clear()}disposeTemplate(t){t.elementDisposable.dispose(),t.templateDisposable.dispose()}};qu=E([b(0,we),b(1,so),b(2,Nt)],qu);var Lx=class extends Yn{constructor(e,i,n,o,s,a,l,d,c,p,h){super(null,e,{hoverDelegate:a?.hoverDelegate});this._contextMenuProvider=s;this._options=a;this._primaryAction=new Gl(e,{hoverDelegate:a?.hoverDelegate},l,d,c,p,s,h),a?.actionRunner&&(this._primaryAction.actionRunner=a.actionRunner),this._dropdown=new Tu(i,n,this._contextMenuProvider,{menuAsChild:a?.menuAsChild??!0,classNames:o?["codicon","codicon-chevron-down",o]:["codicon","codicon-chevron-down"],actionRunner:this._options?.actionRunner,keybindingProvider:this._options?.getKeyBinding,hoverDelegate:a?.hoverDelegate})}_primaryAction;_dropdown;_container=null;_dropdownContainer=null;get onDidChangeDropdownVisibility(){return this._dropdown.onDidChangeVisibility}setActionContext(e){super.setActionContext(e),this._primaryAction.setActionContext(e),this._dropdown.setActionContext(e)}render(e){this._container=e,super.render(this._container),this._container.classList.add("monaco-dropdown-with-primary");let i=J(".action-container");this._primaryAction.render(U(this._container,i)),this._dropdownContainer=J(".dropdown-action-container"),this._dropdown.render(U(this._container,this._dropdownContainer)),this._register(F(i,Q.KEY_DOWN,n=>{let o=new ut(n);o.equals(17)&&(this._primaryAction.element.tabIndex=-1,this._dropdown.focus(),o.stopPropagation())})),this._register(F(this._dropdownContainer,Q.KEY_DOWN,n=>{let o=new ut(n);o.equals(15)&&(this._primaryAction.element.tabIndex=0,this._dropdown.setFocusable(!1),this._primaryAction.element?.focus(),o.stopPropagation())})),this.updateEnabled()}focus(e){e?this._dropdown.focus():(this._primaryAction.element.tabIndex=0,this._primaryAction.element.focus())}blur(){this._primaryAction.element.tabIndex=-1,this._dropdown.blur(),this._container.blur()}setFocusable(e){e?this._primaryAction.element.tabIndex=0:(this._primaryAction.element.tabIndex=-1,this._dropdown.setFocusable(!1))}updateEnabled(){let e=!this.action.enabled;this.element?.classList.toggle("disabled",e)}update(e,i,n){this._dropdown.dispose(),this._dropdown=new Tu(e,i,this._contextMenuProvider,{menuAsChild:!0,classNames:["codicon",n||"codicon-chevron-down"],actionRunner:this._options?.actionRunner,hoverDelegate:this._options?.hoverDelegate,keybindingProvider:this._options?.getKeyBinding}),this._dropdownContainer&&this._dropdown.render(this._dropdownContainer)}dispose(){this._primaryAction.dispose(),this._dropdown.dispose(),super.dispose()}};Lx=E([b(6,Be),b(7,mi),b(8,re),b(9,Fe),b(10,Un)],Lx);function vpe(r,t,e){return jJ({debugName:()=>`Configuration Key "${r}"`},i=>e.onDidChangeConfiguration(n=>{n.affectsConfiguration(r)&&i(n)}),()=>e.getValue(r)??t)}function Uh(r,t,e){let i=r.bindTo(t);return fp({debugName:()=>`Set Context Key "${r.key}"`},n=>{i.set(e(n))})}var Rx=q("accessibilitySignalService"),CPn=Symbol("AcknowledgeDocCommentsToken"),DU=class extends R{constructor(e,i,n){super();this.configurationService=e;this.accessibilityService=i;this.telemetryService=n}_serviceBrand;sounds=new Map;screenReaderAttached=Pi(this,this.accessibilityService.onDidChangeScreenReaderOptimized,()=>this.accessibilityService.isScreenReaderOptimized());sentTelemetry=new Set;getEnabledState(e,i,n){return new tA(this._signalEnabledState.get({signal:e,userGesture:i,modality:n}))}async playSignal(e,i={}){let n=i.modality==="announcement"||i.modality===void 0,o=e.announcementMessage;n&&this.isAnnouncementEnabled(e,i.userGesture)&&o&&this.accessibilityService.status(o),(i.modality==="sound"||i.modality===void 0)&&this.isSoundEnabled(e,i.userGesture)&&(this.sendSignalTelemetry(e,i.source),await this.playSound(e.sound.getSound(),i.allowManyInParallel))}async playSignals(e){for(let s of e)this.sendSignalTelemetry("signal"in s?s.signal:s,"source"in s?s.source:void 0);let i=e.map(s=>"signal"in s?s.signal:s),n=i.filter(s=>this.isAnnouncementEnabled(s)).map(s=>s.announcementMessage);n.length&&this.accessibilityService.status(n.join(", "));let o=new Set(i.filter(s=>this.isSoundEnabled(s)).map(s=>s.sound.getSound()));await Promise.all(Array.from(o).map(s=>this.playSound(s,!0)))}sendSignalTelemetry(e,i){let n=this.accessibilityService.isScreenReaderOptimized(),o=e.name+(i?`::${i}`:"")+(n?"{screenReaderOptimized}":"");this.sentTelemetry.has(o)||this.getVolumeInPercent()===0||(this.sentTelemetry.add(o),this.telemetryService.publicLog2("signal.played",{signal:e.name,source:i??"",isScreenReaderOptimized:n}))}getVolumeInPercent(){let e=this.configurationService.getValue("accessibility.signalOptions.volume");return typeof e!="number"?50:Math.max(Math.min(e,100),0)}playingSounds=new Set;async playSound(e,i=!1){if(!i&&this.playingSounds.has(e))return;this.playingSounds.add(e);let n=Ao.asBrowserUri(`vs/platform/accessibilitySignal/browser/media/${e.fileName}`).toString(!0);try{let o=this.sounds.get(n);if(o)o.volume=this.getVolumeInPercent()/100,o.currentTime=0,await o.play();else{let s=await GTe(n,this.getVolumeInPercent()/100);this.sounds.set(n,s)}}catch(o){o.message.includes("play() can only be initiated by a user gesture")||console.error("Error while playing sound",o)}finally{this.playingSounds.delete(e)}}playSignalLoop(e,i){let n=!0,o=()=>{n&&this.playSignal(e,{allowManyInParallel:!0}).finally(()=>{setTimeout(()=>{n&&o()},i)})};return o(),le(()=>n=!1)}_signalConfigValue=new Yg(e=>vpe(e.settingsKey,{sound:"off",announcement:"off"},this.configurationService));_signalEnabledState=new Yg({getCacheKey:HJ},e=>dt(i=>{let n=this._signalConfigValue.get(e.signal).read(i);return!!((e.modality==="sound"||e.modality===void 0)&&Ipe(n.sound,()=>this.screenReaderAttached.read(i),e.userGesture)||(e.modality==="announcement"||e.modality===void 0)&&Ipe(n.announcement,()=>this.screenReaderAttached.read(i),e.userGesture))}).recomputeInitiallyAndOnChange(this._store));isAnnouncementEnabled(e,i){return e.announcementMessage?this._signalEnabledState.get({signal:e,userGesture:!!i,modality:"announcement"}).get():!1}isSoundEnabled(e,i){return this._signalEnabledState.get({signal:e,userGesture:!!i,modality:"sound"}).get()}onSoundEnabledChanged(e){return this.getEnabledState(e,!1).onDidChange}getDelayMs(e,i,n){if(!this.configurationService.getValue("accessibility.signalOptions.debouncePositionChanges"))return 0;let o;return e.name===ks.errorAtPosition.name&&n==="positional"?o=this.configurationService.getValue("accessibility.signalOptions.experimental.delays.errorAtPosition"):e.name===ks.warningAtPosition.name&&n==="positional"?o=this.configurationService.getValue("accessibility.signalOptions.experimental.delays.warningAtPosition"):o=this.configurationService.getValue("accessibility.signalOptions.experimental.delays.general"),i==="sound"?o.sound:o.announcement}};DU=E([b(0,se),b(1,Un),b(2,Tt)],DU);function Ipe(r,t,e){return r==="on"||r==="always"||r==="auto"&&t()||r==="userGesture"&&e}function GTe(r,t){return new Promise((e,i)=>{let n=new Audio(r);n.volume=t,n.addEventListener("ended",()=>{e(n)}),n.addEventListener("error",o=>{i(o.error)}),n.play().catch(o=>{i(o)})})}var bn=class r{constructor(t){this.fileName=t}static register(t){return new r(t.fileName)}static error=r.register({fileName:"error.mp3"});static warning=r.register({fileName:"warning.mp3"});static success=r.register({fileName:"success.mp3"});static foldedArea=r.register({fileName:"foldedAreas.mp3"});static break=r.register({fileName:"break.mp3"});static quickFixes=r.register({fileName:"quickFixes.mp3"});static taskCompleted=r.register({fileName:"taskCompleted.mp3"});static taskFailed=r.register({fileName:"taskFailed.mp3"});static terminalBell=r.register({fileName:"terminalBell.mp3"});static diffLineInserted=r.register({fileName:"diffLineInserted.mp3"});static diffLineDeleted=r.register({fileName:"diffLineDeleted.mp3"});static diffLineModified=r.register({fileName:"diffLineModified.mp3"});static chatRequestSent=r.register({fileName:"chatRequestSent.mp3"});static chatResponseReceived1=r.register({fileName:"chatResponseReceived1.mp3"});static chatResponseReceived2=r.register({fileName:"chatResponseReceived2.mp3"});static chatResponseReceived3=r.register({fileName:"chatResponseReceived3.mp3"});static chatResponseReceived4=r.register({fileName:"chatResponseReceived4.mp3"});static clear=r.register({fileName:"clear.mp3"});static save=r.register({fileName:"save.mp3"});static format=r.register({fileName:"format.mp3"});static voiceRecordingStarted=r.register({fileName:"voiceRecordingStarted.mp3"});static voiceRecordingStopped=r.register({fileName:"voiceRecordingStopped.mp3"});static progress=r.register({fileName:"progress.mp3"})},cX=class{constructor(t){this.randomOneOf=t}getSound(t=!1){if(t||this.randomOneOf.length===1)return this.randomOneOf[0];{let e=Math.floor(Math.random()*this.randomOneOf.length);return this.randomOneOf[e]}}},ks=class r{constructor(t,e,i,n,o,s){this.sound=t;this.name=e;this.legacySoundSettingsKey=i;this.settingsKey=n;this.legacyAnnouncementSettingsKey=o;this.announcementMessage=s}static _signals=new Set;static register(t){let e=new cX("randomOneOf"in t.sound?t.sound.randomOneOf:[t.sound]),i=new r(e,t.name,t.legacySoundSettingsKey,t.settingsKey,t.legacyAnnouncementSettingsKey,t.announcementMessage);return r._signals.add(i),i}static get allAccessibilitySignals(){return[...this._signals]}static errorAtPosition=r.register({name:u("accessibilitySignals.positionHasError.name","Error at Position"),sound:bn.error,announcementMessage:u("accessibility.signals.positionHasError","Error"),settingsKey:"accessibility.signals.positionHasError",delaySettingsKey:"accessibility.signalOptions.delays.errorAtPosition"});static warningAtPosition=r.register({name:u("accessibilitySignals.positionHasWarning.name","Warning at Position"),sound:bn.warning,announcementMessage:u("accessibility.signals.positionHasWarning","Warning"),settingsKey:"accessibility.signals.positionHasWarning",delaySettingsKey:"accessibility.signalOptions.delays.warningAtPosition"});static errorOnLine=r.register({name:u("accessibilitySignals.lineHasError.name","Error on Line"),sound:bn.error,legacySoundSettingsKey:"audioCues.lineHasError",legacyAnnouncementSettingsKey:"accessibility.alert.error",announcementMessage:u("accessibility.signals.lineHasError","Error on Line"),settingsKey:"accessibility.signals.lineHasError"});static warningOnLine=r.register({name:u("accessibilitySignals.lineHasWarning.name","Warning on Line"),sound:bn.warning,legacySoundSettingsKey:"audioCues.lineHasWarning",legacyAnnouncementSettingsKey:"accessibility.alert.warning",announcementMessage:u("accessibility.signals.lineHasWarning","Warning on Line"),settingsKey:"accessibility.signals.lineHasWarning"});static foldedArea=r.register({name:u("accessibilitySignals.lineHasFoldedArea.name","Folded Area on Line"),sound:bn.foldedArea,legacySoundSettingsKey:"audioCues.lineHasFoldedArea",legacyAnnouncementSettingsKey:"accessibility.alert.foldedArea",announcementMessage:u("accessibility.signals.lineHasFoldedArea","Folded"),settingsKey:"accessibility.signals.lineHasFoldedArea"});static break=r.register({name:u("accessibilitySignals.lineHasBreakpoint.name","Breakpoint on Line"),sound:bn.break,legacySoundSettingsKey:"audioCues.lineHasBreakpoint",legacyAnnouncementSettingsKey:"accessibility.alert.breakpoint",announcementMessage:u("accessibility.signals.lineHasBreakpoint","Breakpoint"),settingsKey:"accessibility.signals.lineHasBreakpoint"});static inlineSuggestion=r.register({name:u("accessibilitySignals.lineHasInlineSuggestion.name","Inline Suggestion on Line"),sound:bn.quickFixes,legacySoundSettingsKey:"audioCues.lineHasInlineSuggestion",settingsKey:"accessibility.signals.lineHasInlineSuggestion"});static terminalQuickFix=r.register({name:u("accessibilitySignals.terminalQuickFix.name","Terminal Quick Fix"),sound:bn.quickFixes,legacySoundSettingsKey:"audioCues.terminalQuickFix",legacyAnnouncementSettingsKey:"accessibility.alert.terminalQuickFix",announcementMessage:u("accessibility.signals.terminalQuickFix","Quick Fix"),settingsKey:"accessibility.signals.terminalQuickFix"});static onDebugBreak=r.register({name:u("accessibilitySignals.onDebugBreak.name","Debugger Stopped on Breakpoint"),sound:bn.break,legacySoundSettingsKey:"audioCues.onDebugBreak",legacyAnnouncementSettingsKey:"accessibility.alert.onDebugBreak",announcementMessage:u("accessibility.signals.onDebugBreak","Breakpoint"),settingsKey:"accessibility.signals.onDebugBreak"});static noInlayHints=r.register({name:u("accessibilitySignals.noInlayHints","No Inlay Hints on Line"),sound:bn.error,legacySoundSettingsKey:"audioCues.noInlayHints",legacyAnnouncementSettingsKey:"accessibility.alert.noInlayHints",announcementMessage:u("accessibility.signals.noInlayHints","No Inlay Hints"),settingsKey:"accessibility.signals.noInlayHints"});static taskCompleted=r.register({name:u("accessibilitySignals.taskCompleted","Task Completed"),sound:bn.taskCompleted,legacySoundSettingsKey:"audioCues.taskCompleted",legacyAnnouncementSettingsKey:"accessibility.alert.taskCompleted",announcementMessage:u("accessibility.signals.taskCompleted","Task Completed"),settingsKey:"accessibility.signals.taskCompleted"});static taskFailed=r.register({name:u("accessibilitySignals.taskFailed","Task Failed"),sound:bn.taskFailed,legacySoundSettingsKey:"audioCues.taskFailed",legacyAnnouncementSettingsKey:"accessibility.alert.taskFailed",announcementMessage:u("accessibility.signals.taskFailed","Task Failed"),settingsKey:"accessibility.signals.taskFailed"});static terminalCommandFailed=r.register({name:u("accessibilitySignals.terminalCommandFailed","Terminal Command Failed"),sound:bn.error,legacySoundSettingsKey:"audioCues.terminalCommandFailed",legacyAnnouncementSettingsKey:"accessibility.alert.terminalCommandFailed",announcementMessage:u("accessibility.signals.terminalCommandFailed","Command Failed"),settingsKey:"accessibility.signals.terminalCommandFailed"});static terminalCommandSucceeded=r.register({name:u("accessibilitySignals.terminalCommandSucceeded","Terminal Command Succeeded"),sound:bn.success,announcementMessage:u("accessibility.signals.terminalCommandSucceeded","Command Succeeded"),settingsKey:"accessibility.signals.terminalCommandSucceeded"});static terminalBell=r.register({name:u("accessibilitySignals.terminalBell","Terminal Bell"),sound:bn.terminalBell,legacySoundSettingsKey:"audioCues.terminalBell",legacyAnnouncementSettingsKey:"accessibility.alert.terminalBell",announcementMessage:u("accessibility.signals.terminalBell","Terminal Bell"),settingsKey:"accessibility.signals.terminalBell"});static notebookCellCompleted=r.register({name:u("accessibilitySignals.notebookCellCompleted","Notebook Cell Completed"),sound:bn.taskCompleted,legacySoundSettingsKey:"audioCues.notebookCellCompleted",legacyAnnouncementSettingsKey:"accessibility.alert.notebookCellCompleted",announcementMessage:u("accessibility.signals.notebookCellCompleted","Notebook Cell Completed"),settingsKey:"accessibility.signals.notebookCellCompleted"});static notebookCellFailed=r.register({name:u("accessibilitySignals.notebookCellFailed","Notebook Cell Failed"),sound:bn.taskFailed,legacySoundSettingsKey:"audioCues.notebookCellFailed",legacyAnnouncementSettingsKey:"accessibility.alert.notebookCellFailed",announcementMessage:u("accessibility.signals.notebookCellFailed","Notebook Cell Failed"),settingsKey:"accessibility.signals.notebookCellFailed"});static diffLineInserted=r.register({name:u("accessibilitySignals.diffLineInserted","Diff Line Inserted"),sound:bn.diffLineInserted,legacySoundSettingsKey:"audioCues.diffLineInserted",settingsKey:"accessibility.signals.diffLineInserted"});static diffLineDeleted=r.register({name:u("accessibilitySignals.diffLineDeleted","Diff Line Deleted"),sound:bn.diffLineDeleted,legacySoundSettingsKey:"audioCues.diffLineDeleted",settingsKey:"accessibility.signals.diffLineDeleted"});static diffLineModified=r.register({name:u("accessibilitySignals.diffLineModified","Diff Line Modified"),sound:bn.diffLineModified,legacySoundSettingsKey:"audioCues.diffLineModified",settingsKey:"accessibility.signals.diffLineModified"});static chatRequestSent=r.register({name:u("accessibilitySignals.chatRequestSent","Chat Request Sent"),sound:bn.chatRequestSent,legacySoundSettingsKey:"audioCues.chatRequestSent",legacyAnnouncementSettingsKey:"accessibility.alert.chatRequestSent",announcementMessage:u("accessibility.signals.chatRequestSent","Chat Request Sent"),settingsKey:"accessibility.signals.chatRequestSent"});static chatResponseReceived=r.register({name:u("accessibilitySignals.chatResponseReceived","Chat Response Received"),legacySoundSettingsKey:"audioCues.chatResponseReceived",sound:{randomOneOf:[bn.chatResponseReceived1,bn.chatResponseReceived2,bn.chatResponseReceived3,bn.chatResponseReceived4]},settingsKey:"accessibility.signals.chatResponseReceived"});static progress=r.register({name:u("accessibilitySignals.progress","Progress"),sound:bn.progress,legacySoundSettingsKey:"audioCues.chatResponsePending",legacyAnnouncementSettingsKey:"accessibility.alert.progress",announcementMessage:u("accessibility.signals.progress","Progress"),settingsKey:"accessibility.signals.progress"});static clear=r.register({name:u("accessibilitySignals.clear","Clear"),sound:bn.clear,legacySoundSettingsKey:"audioCues.clear",legacyAnnouncementSettingsKey:"accessibility.alert.clear",announcementMessage:u("accessibility.signals.clear","Clear"),settingsKey:"accessibility.signals.clear"});static save=r.register({name:u("accessibilitySignals.save","Save"),sound:bn.save,legacySoundSettingsKey:"audioCues.save",legacyAnnouncementSettingsKey:"accessibility.alert.save",announcementMessage:u("accessibility.signals.save","Save"),settingsKey:"accessibility.signals.save"});static format=r.register({name:u("accessibilitySignals.format","Format"),sound:bn.format,legacySoundSettingsKey:"audioCues.format",legacyAnnouncementSettingsKey:"accessibility.alert.format",announcementMessage:u("accessibility.signals.format","Format"),settingsKey:"accessibility.signals.format"});static voiceRecordingStarted=r.register({name:u("accessibilitySignals.voiceRecordingStarted","Voice Recording Started"),sound:bn.voiceRecordingStarted,legacySoundSettingsKey:"audioCues.voiceRecordingStarted",settingsKey:"accessibility.signals.voiceRecordingStarted"});static voiceRecordingStopped=r.register({name:u("accessibilitySignals.voiceRecordingStopped","Voice Recording Stopped"),sound:bn.voiceRecordingStopped,legacySoundSettingsKey:"audioCues.voiceRecordingStopped",settingsKey:"accessibility.signals.voiceRecordingStopped"})};var ype=q("speechService"),FPn=new A("hasSpeechProvider",!1,{type:"boolean",description:u("hasSpeechProvider","A speech provider is registered to the speech service.")}),BPn=new A("speechToTextInProgress",!1,{type:"boolean",description:u("speechToTextInProgress","A speech-to-text session is in progress.")}),VPn=new A("textToSpeechInProgress",!1,{type:"boolean",description:u("textToSpeechInProgress","A text-to-speech session is in progress.")});var Spe={"da-DK":{name:u("speechLanguage.da-DK","Danish (Denmark)")},"de-DE":{name:u("speechLanguage.de-DE","German (Germany)")},"en-AU":{name:u("speechLanguage.en-AU","English (Australia)")},"en-CA":{name:u("speechLanguage.en-CA","English (Canada)")},"en-GB":{name:u("speechLanguage.en-GB","English (United Kingdom)")},"en-IE":{name:u("speechLanguage.en-IE","English (Ireland)")},"en-IN":{name:u("speechLanguage.en-IN","English (India)")},"en-NZ":{name:u("speechLanguage.en-NZ","English (New Zealand)")},"en-US":{name:u("speechLanguage.en-US","English (United States)")},"es-ES":{name:u("speechLanguage.es-ES","Spanish (Spain)")},"es-MX":{name:u("speechLanguage.es-MX","Spanish (Mexico)")},"fr-CA":{name:u("speechLanguage.fr-CA","French (Canada)")},"fr-FR":{name:u("speechLanguage.fr-FR","French (France)")},"hi-IN":{name:u("speechLanguage.hi-IN","Hindi (India)")},"it-IT":{name:u("speechLanguage.it-IT","Italian (Italy)")},"ja-JP":{name:u("speechLanguage.ja-JP","Japanese (Japan)")},"ko-KR":{name:u("speechLanguage.ko-KR","Korean (South Korea)")},"nl-NL":{name:u("speechLanguage.nl-NL","Dutch (Netherlands)")},"pt-PT":{name:u("speechLanguage.pt-PT","Portuguese (Portugal)")},"pt-BR":{name:u("speechLanguage.pt-BR","Portuguese (Brazil)")},"ru-RU":{name:u("speechLanguage.ru-RU","Russian (Russia)")},"sv-SE":{name:u("speechLanguage.sv-SE","Swedish (Sweden)")},"tr-TR":{name:u("speechLanguage.tr-TR","Turkish (T\xFCrkiye)")},"zh-CN":{name:u("speechLanguage.zh-CN","Chinese (Simplified, China)")},"zh-HK":{name:u("speechLanguage.zh-HK","Chinese (Traditional, Hong Kong)")},"zh-TW":{name:u("speechLanguage.zh-TW","Chinese (Traditional, Taiwan)")}};var aMn=new A("accessibilityHelpIsShown",!1,!0),lMn=new A("accessibleViewIsShown",!1,!0),dMn=new A("accessibleViewSupportsNavigation",!1,!0),cMn=new A("accessibleViewVerbosityEnabled",!1,!0),uMn=new A("accessibleViewGoToSymbolSupported",!1,!0),pMn=new A("accessibleViewOnLastLine",!1,!0),hMn=new A("accessibleViewCurrentProviderId",void 0,void 0),mMn=new A("accessibleViewInCodeBlock",void 0,void 0),gMn=new A("accessibleViewContainsCodeBlocks",void 0,void 0),fMn=new A("accessibleViewHasUnassignedKeybindings",void 0,void 0),bMn=new A("accessibleViewHasAssignedKeybindings",void 0,void 0);var nd={type:"boolean",default:!0,tags:["accessibility"]},Cpe=Object.freeze({id:"accessibility",title:u("accessibilityConfigurationTitle","Accessibility"),type:"object"}),So={type:"string",enum:["auto","on","off"],default:"auto",enumDescriptions:[u("sound.enabled.auto","Enable sound when a screen reader is attached."),u("sound.enabled.on","Enable sound."),u("sound.enabled.off","Disable sound.")],tags:["accessibility"]},Ls={type:"object",tags:["accessibility"],additionalProperties:!1,default:{sound:"auto",announcement:"auto"}},Rs={type:"string",enum:["auto","off"],default:"auto",enumDescriptions:[u("announcement.enabled.auto","Enable announcement, will only play when in screen reader optimized mode."),u("announcement.enabled.off","Disable announcement.")],tags:["accessibility"]},Gy={type:"object",tags:["accessibility"],additionalProperties:!1,default:{sound:"auto"}},vMn={...Cpe,scope:4,properties:{"accessibility.verbosity.terminal":{description:u("verbosity.terminal.description","Provide information about how to access the terminal accessibility help menu when the terminal is focused."),...nd},"accessibility.verbosity.diffEditor":{description:u("verbosity.diffEditor.description","Provide information about how to navigate changes in the diff editor when it is focused."),...nd},"accessibility.verbosity.panelChat":{description:u("verbosity.chat.description","Provide information about how to access the chat help menu when the chat input is focused."),...nd},"accessibility.verbosity.inlineChat":{description:u("verbosity.interactiveEditor.description","Provide information about how to access the inline editor chat accessibility help menu and alert with hints that describe how to use the feature when the input is focused."),...nd},"accessibility.verbosity.inlineCompletions":{description:u("verbosity.inlineCompletions.description","Provide information about how to access the inline completions hover and Accessible View."),...nd},"accessibility.verbosity.keybindingsEditor":{description:u("verbosity.keybindingsEditor.description","Provide information about how to change a keybinding in the keybindings editor when a row is focused."),...nd},"accessibility.verbosity.notebook":{description:u("verbosity.notebook","Provide information about how to focus the cell container or inner editor when a notebook cell is focused."),...nd},"accessibility.verbosity.hover":{description:u("verbosity.hover","Provide information about how to open the hover in an Accessible View."),...nd},"accessibility.verbosity.notification":{description:u("verbosity.notification","Provide information about how to open the notification in an Accessible View."),...nd},"accessibility.verbosity.emptyEditorHint":{description:u("verbosity.emptyEditorHint","Provide information about relevant actions in an empty text editor."),...nd},"accessibility.verbosity.replInputHint":{description:u("verbosity.replInputHint","Provide information about relevant actions For the Repl input."),...nd},"accessibility.verbosity.comments":{description:u("verbosity.comments","Provide information about actions that can be taken in the comment widget or in a file which contains comments."),...nd},"accessibility.verbosity.diffEditorActive":{description:u("verbosity.diffEditorActive","Indicate when a diff editor becomes the active editor."),...nd},"accessibility.verbosity.debug":{description:u("verbosity.debug","Provide information about how to access the debug console accessibility help dialog when the debug console or run and debug viewlet is focused. Note that a reload of the window is required for this to take effect."),...nd},"accessibility.accessibleView.closeOnKeyPress":{markdownDescription:u("terminal.integrated.accessibleView.closeOnKeyPress","On keypress, close the Accessible View and focus the element from which it was invoked."),type:"boolean",default:!0},"accessibility.signalOptions.volume":{description:u("accessibility.signalOptions.volume","The volume of the sounds in percent (0-100)."),type:"number",minimum:0,maximum:100,default:70,tags:["accessibility"]},"accessibility.signalOptions.debouncePositionChanges":{description:u("accessibility.signalOptions.debouncePositionChanges","Whether or not position changes should be debounced"),type:"boolean",default:!1,tags:["accessibility"]},"accessibility.signalOptions.experimental.delays.general":{type:"object",description:"Delays for all signals besides error and warning at position",additionalProperties:!1,properties:{announcement:{description:u("accessibility.signalOptions.delays.general.announcement","The delay in milliseconds before an announcement is made."),type:"number",minimum:0,default:3e3},sound:{description:u("accessibility.signalOptions.delays.general.sound","The delay in milliseconds before a sound is played."),type:"number",minimum:0,default:400}},tags:["accessibility"]},"accessibility.signalOptions.experimental.delays.warningAtPosition":{type:"object",additionalProperties:!1,properties:{announcement:{description:u("accessibility.signalOptions.delays.warningAtPosition.announcement","The delay in milliseconds before an announcement is made when there's a warning at the position."),type:"number",minimum:0,default:3e3},sound:{description:u("accessibility.signalOptions.delays.warningAtPosition.sound","The delay in milliseconds before a sound is played when there's a warning at the position."),type:"number",minimum:0,default:1e3}},tags:["accessibility"]},"accessibility.signalOptions.experimental.delays.errorAtPosition":{type:"object",additionalProperties:!1,properties:{announcement:{description:u("accessibility.signalOptions.delays.errorAtPosition.announcement","The delay in milliseconds before an announcement is made when there's an error at the position."),type:"number",minimum:0,default:3e3},sound:{description:u("accessibility.signalOptions.delays.errorAtPosition.sound","The delay in milliseconds before a sound is played when there's an error at the position."),type:"number",minimum:0,default:1e3}},tags:["accessibility"]},"accessibility.signals.lineHasBreakpoint":{...Ls,description:u("accessibility.signals.lineHasBreakpoint","Plays a signal - sound (audio cue) and/or announcement (alert) - when the active line has a breakpoint."),properties:{sound:{description:u("accessibility.signals.lineHasBreakpoint.sound","Plays a sound when the active line has a breakpoint."),...So},announcement:{description:u("accessibility.signals.lineHasBreakpoint.announcement","Announces when the active line has a breakpoint."),...Rs}}},"accessibility.signals.lineHasInlineSuggestion":{...Gy,description:u("accessibility.signals.lineHasInlineSuggestion","Plays a sound / audio cue when the active line has an inline suggestion."),properties:{sound:{description:u("accessibility.signals.lineHasInlineSuggestion.sound","Plays a sound when the active line has an inline suggestion."),...So,default:"off"}}},"accessibility.signals.lineHasError":{...Ls,description:u("accessibility.signals.lineHasError","Plays a signal - sound (audio cue) and/or announcement (alert) - when the active line has an error."),properties:{sound:{description:u("accessibility.signals.lineHasError.sound","Plays a sound when the active line has an error."),...So},announcement:{description:u("accessibility.signals.lineHasError.announcement","Announces when the active line has an error."),...Rs,default:"off"}}},"accessibility.signals.lineHasFoldedArea":{...Ls,description:u("accessibility.signals.lineHasFoldedArea","Plays a signal - sound (audio cue) and/or announcement (alert) - the active line has a folded area that can be unfolded."),properties:{sound:{description:u("accessibility.signals.lineHasFoldedArea.sound","Plays a sound when the active line has a folded area that can be unfolded."),...So,default:"off"},announcement:{description:u("accessibility.signals.lineHasFoldedArea.announcement","Announces when the active line has a folded area that can be unfolded."),...Rs}}},"accessibility.signals.lineHasWarning":{...Ls,description:u("accessibility.signals.lineHasWarning","Plays a signal - sound (audio cue) and/or announcement (alert) - when the active line has a warning."),properties:{sound:{description:u("accessibility.signals.lineHasWarning.sound","Plays a sound when the active line has a warning."),...So},announcement:{description:u("accessibility.signals.lineHasWarning.announcement","Announces when the active line has a warning."),...Rs,default:"off"}}},"accessibility.signals.positionHasError":{...Ls,description:u("accessibility.signals.positionHasError","Plays a signal - sound (audio cue) and/or announcement (alert) - when the active line has a warning."),properties:{sound:{description:u("accessibility.signals.positionHasError.sound","Plays a sound when the active line has a warning."),...So},announcement:{description:u("accessibility.signals.positionHasError.announcement","Announces when the active line has a warning."),...Rs,default:"on"}}},"accessibility.signals.positionHasWarning":{...Ls,description:u("accessibility.signals.positionHasWarning","Plays a signal - sound (audio cue) and/or announcement (alert) - when the active line has a warning."),properties:{sound:{description:u("accessibility.signals.positionHasWarning.sound","Plays a sound when the active line has a warning."),...So},announcement:{description:u("accessibility.signals.positionHasWarning.announcement","Announces when the active line has a warning."),...Rs,default:"on"}}},"accessibility.signals.onDebugBreak":{...Ls,description:u("accessibility.signals.onDebugBreak","Plays a signal - sound (audio cue) and/or announcement (alert) - when the debugger stopped on a breakpoint."),properties:{sound:{description:u("accessibility.signals.onDebugBreak.sound","Plays a sound when the debugger stopped on a breakpoint."),...So},announcement:{description:u("accessibility.signals.onDebugBreak.announcement","Announces when the debugger stopped on a breakpoint."),...Rs}}},"accessibility.signals.noInlayHints":{...Ls,description:u("accessibility.signals.noInlayHints","Plays a signal - sound (audio cue) and/or announcement (alert) - when trying to read a line with inlay hints that has no inlay hints."),properties:{sound:{description:u("accessibility.signals.noInlayHints.sound","Plays a sound when trying to read a line with inlay hints that has no inlay hints."),...So},announcement:{description:u("accessibility.signals.noInlayHints.announcement","Announces when trying to read a line with inlay hints that has no inlay hints."),...Rs}}},"accessibility.signals.taskCompleted":{...Ls,description:u("accessibility.signals.taskCompleted","Plays a signal - sound (audio cue) and/or announcement (alert) - when a task is completed."),properties:{sound:{description:u("accessibility.signals.taskCompleted.sound","Plays a sound when a task is completed."),...So},announcement:{description:u("accessibility.signals.taskCompleted.announcement","Announces when a task is completed."),...Rs}}},"accessibility.signals.taskFailed":{...Ls,description:u("accessibility.signals.taskFailed","Plays a signal - sound (audio cue) and/or announcement (alert) - when a task fails (non-zero exit code)."),properties:{sound:{description:u("accessibility.signals.taskFailed.sound","Plays a sound when a task fails (non-zero exit code)."),...So},announcement:{description:u("accessibility.signals.taskFailed.announcement","Announces when a task fails (non-zero exit code)."),...Rs}}},"accessibility.signals.terminalCommandFailed":{...Ls,description:u("accessibility.signals.terminalCommandFailed","Plays a signal - sound (audio cue) and/or announcement (alert) - when a terminal command fails (non-zero exit code) or when a command with such an exit code is navigated to in the accessible view."),properties:{sound:{description:u("accessibility.signals.terminalCommandFailed.sound","Plays a sound when a terminal command fails (non-zero exit code) or when a command with such an exit code is navigated to in the accessible view."),...So},announcement:{description:u("accessibility.signals.terminalCommandFailed.announcement","Announces when a terminal command fails (non-zero exit code) or when a command with such an exit code is navigated to in the accessible view."),...Rs}}},"accessibility.signals.terminalCommandSucceeded":{...Ls,description:u("accessibility.signals.terminalCommandSucceeded","Plays a signal - sound (audio cue) and/or announcement (alert) - when a terminal command succeeds (zero exit code) or when a command with such an exit code is navigated to in the accessible view."),properties:{sound:{description:u("accessibility.signals.terminalCommandSucceeded.sound","Plays a sound when a terminal command succeeds (zero exit code) or when a command with such an exit code is navigated to in the accessible view."),...So},announcement:{description:u("accessibility.signals.terminalCommandSucceeded.announcement","Announces when a terminal command succeeds (zero exit code) or when a command with such an exit code is navigated to in the accessible view."),...Rs}}},"accessibility.signals.terminalQuickFix":{...Ls,description:u("accessibility.signals.terminalQuickFix","Plays a signal - sound (audio cue) and/or announcement (alert) - when terminal Quick Fixes are available."),properties:{sound:{description:u("accessibility.signals.terminalQuickFix.sound","Plays a sound when terminal Quick Fixes are available."),...So},announcement:{description:u("accessibility.signals.terminalQuickFix.announcement","Announces when terminal Quick Fixes are available."),...Rs}}},"accessibility.signals.terminalBell":{...Ls,description:u("accessibility.signals.terminalBell","Plays a signal - sound (audio cue) and/or announcement (alert) - when the terminal bell is ringing."),properties:{sound:{description:u("accessibility.signals.terminalBell.sound","Plays a sound when the terminal bell is ringing."),...So},announcement:{description:u("accessibility.signals.terminalBell.announcement","Announces when the terminal bell is ringing."),...Rs}}},"accessibility.signals.diffLineInserted":{...Gy,description:u("accessibility.signals.diffLineInserted","Plays a sound / audio cue when the focus moves to an inserted line in Accessible Diff Viewer mode or to the next/previous change."),properties:{sound:{description:u("accessibility.signals.sound","Plays a sound when the focus moves to an inserted line in Accessible Diff Viewer mode or to the next/previous change."),...So}}},"accessibility.signals.diffLineModified":{...Gy,description:u("accessibility.signals.diffLineModified","Plays a sound / audio cue when the focus moves to an modified line in Accessible Diff Viewer mode or to the next/previous change."),properties:{sound:{description:u("accessibility.signals.diffLineModified.sound","Plays a sound when the focus moves to a modified line in Accessible Diff Viewer mode or to the next/previous change."),...So}}},"accessibility.signals.diffLineDeleted":{...Gy,description:u("accessibility.signals.diffLineDeleted","Plays a sound / audio cue when the focus moves to an deleted line in Accessible Diff Viewer mode or to the next/previous change."),properties:{sound:{description:u("accessibility.signals.diffLineDeleted.sound","Plays a sound when the focus moves to an deleted line in Accessible Diff Viewer mode or to the next/previous change."),...So}}},"accessibility.signals.notebookCellCompleted":{...Ls,description:u("accessibility.signals.notebookCellCompleted","Plays a signal - sound (audio cue) and/or announcement (alert) - when a notebook cell execution is successfully completed."),properties:{sound:{description:u("accessibility.signals.notebookCellCompleted.sound","Plays a sound when a notebook cell execution is successfully completed."),...So},announcement:{description:u("accessibility.signals.notebookCellCompleted.announcement","Announces when a notebook cell execution is successfully completed."),...Rs}}},"accessibility.signals.notebookCellFailed":{...Ls,description:u("accessibility.signals.notebookCellFailed","Plays a signal - sound (audio cue) and/or announcement (alert) - when a notebook cell execution fails."),properties:{sound:{description:u("accessibility.signals.notebookCellFailed.sound","Plays a sound when a notebook cell execution fails."),...So},announcement:{description:u("accessibility.signals.notebookCellFailed.announcement","Announces when a notebook cell execution fails."),...Rs}}},"accessibility.signals.chatRequestSent":{...Ls,description:u("accessibility.signals.chatRequestSent","Plays a signal - sound (audio cue) and/or announcement (alert) - when a chat request is made."),properties:{sound:{description:u("accessibility.signals.chatRequestSent.sound","Plays a sound when a chat request is made."),...So},announcement:{description:u("accessibility.signals.chatRequestSent.announcement","Announces when a chat request is made."),...Rs}}},"accessibility.signals.progress":{...Ls,description:u("accessibility.signals.progress","Plays a signal - sound (audio cue) and/or announcement (alert) - on loop while progress is occurring."),properties:{sound:{description:u("accessibility.signals.progress.sound","Plays a sound on loop while progress is occurring."),...So},announcement:{description:u("accessibility.signals.progress.announcement","Alerts on loop while progress is occurring."),...Rs}}},"accessibility.signals.chatResponseReceived":{...Gy,description:u("accessibility.signals.chatResponseReceived","Plays a sound / audio cue when the response has been received."),properties:{sound:{description:u("accessibility.signals.chatResponseReceived.sound","Plays a sound on loop while the response has been received."),...So}}},"accessibility.signals.voiceRecordingStarted":{...Gy,description:u("accessibility.signals.voiceRecordingStarted","Plays a sound / audio cue when the voice recording has started."),properties:{sound:{description:u("accessibility.signals.voiceRecordingStarted.sound","Plays a sound when the voice recording has started."),...So}},default:{sound:"on"}},"accessibility.signals.voiceRecordingStopped":{...Gy,description:u("accessibility.signals.voiceRecordingStopped","Plays a sound / audio cue when the voice recording has stopped."),properties:{sound:{description:u("accessibility.signals.voiceRecordingStopped.sound","Plays a sound when the voice recording has stopped."),...So,default:"off"}}},"accessibility.signals.clear":{...Ls,description:u("accessibility.signals.clear","Plays a signal - sound (audio cue) and/or announcement (alert) - when a feature is cleared (for example, the terminal, Debug Console, or Output channel)."),properties:{sound:{description:u("accessibility.signals.clear.sound","Plays a sound when a feature is cleared."),...So},announcement:{description:u("accessibility.signals.clear.announcement","Announces when a feature is cleared."),...Rs}}},"accessibility.signals.save":{type:"object",tags:["accessibility"],additionalProperties:!1,markdownDescription:u("accessibility.signals.save","Plays a signal - sound (audio cue) and/or announcement (alert) - when a file is saved."),properties:{sound:{description:u("accessibility.signals.save.sound","Plays a sound when a file is saved."),type:"string",enum:["userGesture","always","never"],default:"never",enumDescriptions:[u("accessibility.signals.save.sound.userGesture","Plays the sound when a user explicitly saves a file."),u("accessibility.signals.save.sound.always","Plays the sound whenever a file is saved, including auto save."),u("accessibility.signals.save.sound.never","Never plays the sound.")]},announcement:{description:u("accessibility.signals.save.announcement","Announces when a file is saved."),type:"string",enum:["userGesture","always","never"],default:"never",enumDescriptions:[u("accessibility.signals.save.announcement.userGesture","Announces when a user explicitly saves a file."),u("accessibility.signals.save.announcement.always","Announces whenever a file is saved, including auto save."),u("accessibility.signals.save.announcement.never","Never plays the announcement.")]}},default:{sound:"never",announcement:"never"}},"accessibility.signals.format":{type:"object",tags:["accessibility"],additionalProperties:!1,markdownDescription:u("accessibility.signals.format","Plays a signal - sound (audio cue) and/or announcement (alert) - when a file or notebook is formatted."),properties:{sound:{description:u("accessibility.signals.format.sound","Plays a sound when a file or notebook is formatted."),type:"string",enum:["userGesture","always","never"],default:"never",enumDescriptions:[u("accessibility.signals.format.userGesture","Plays the sound when a user explicitly formats a file."),u("accessibility.signals.format.always","Plays the sound whenever a file is formatted, including if it is set to format on save, type, or, paste, or run of a cell."),u("accessibility.signals.format.never","Never plays the sound.")]},announcement:{description:u("accessibility.signals.format.announcement","Announces when a file or notebook is formatted."),type:"string",enum:["userGesture","always","never"],default:"never",enumDescriptions:[u("accessibility.signals.format.announcement.userGesture","Announces when a user explicitly formats a file."),u("accessibility.signals.format.announcement.always","Announces whenever a file is formatted, including if it is set to format on save, type, or, paste, or run of a cell."),u("accessibility.signals.format.announcement.never","Never announces.")]}},default:{sound:"never",announcement:"never"}},"accessibility.underlineLinks":{type:"boolean",description:u("accessibility.underlineLinks","Controls whether links should be underlined in the workbench."),default:!1},"accessibility.debugWatchVariableAnnouncements":{type:"boolean",description:u("accessibility.debugWatchVariableAnnouncements","Controls whether variable changes should be announced in the debug watch view."),default:!0}}};var qTe=1200,kU=class extends R{constructor(e,i){super();this.speechService=e;this.productService=i;this._register(X.runAndSubscribe(e.onDidChangeHasSpeechProvider,()=>this.updateConfiguration()))}static ID="workbench.contrib.dynamicSpeechAccessibilityConfiguration";updateConfiguration(){if(!this.speechService.hasSpeechProvider)return;let e=this.getLanguages(),i=Object.keys(e).sort((o,s)=>e[o].name.localeCompare(e[s].name));Pe.as(ur.Configuration).registerConfiguration({...Cpe,properties:{"accessibility.voice.speechTimeout":{markdownDescription:u("voice.speechTimeout","The duration in milliseconds that voice speech recognition remains active after you stop speaking. For example in a chat session, the transcribed text is submitted automatically after the timeout is met. Set to `0` to disable this feature."),type:"number",default:qTe,minimum:0,tags:["accessibility"]},"accessibility.voice.speechLanguage":{markdownDescription:u("voice.speechLanguage","The language that text-to-speech and speech-to-text should use. Select `auto` to use the configured display language if possible. Note that not all display languages maybe supported by speech recognition and synthesizers."),type:"string",enum:i,default:"auto",tags:["accessibility"],enumDescriptions:i.map(o=>e[o].name),enumItemLabels:i.map(o=>e[o].name)},"accessibility.voice.autoSynthesize":{type:"string",enum:["on","off","auto"],enumDescriptions:[u("accessibility.voice.autoSynthesize.on","Enable the feature. When a screen reader is enabled, note that this will disable aria updates."),u("accessibility.voice.autoSynthesize.off","Disable the feature."),u("accessibility.voice.autoSynthesize.auto","When a screen reader is detected, disable the feature. Otherwise, enable the feature.")],markdownDescription:u("autoSynthesize","Whether a textual response should automatically be read out aloud when speech was used as input. For example in a chat session, a response is automatically synthesized when voice was used as chat request."),default:this.productService.quality!=="stable"?"auto":"off",tags:["accessibility"]}}})}getLanguages(){return{auto:{name:u("speechLanguage.auto","Auto (Use Display Language)")},...Spe}}};kU=E([b(0,ype),b(1,al)],kU);Pe.as(Nd.ConfigurationMigration).registerConfigurationMigrations([{key:"audioCues.volume",migrateFn:(r,t)=>[["accessibility.signalOptions.volume",{value:r}],["audioCues.volume",{value:void 0}]]}]);Pe.as(Nd.ConfigurationMigration).registerConfigurationMigrations([{key:"audioCues.debouncePositionChanges",migrateFn:r=>[["accessibility.signalOptions.debouncePositionChanges",{value:r}],["audioCues.debouncePositionChanges",{value:void 0}]]}]);Pe.as(Nd.ConfigurationMigration).registerConfigurationMigrations([{key:"accessibility.signalOptions",migrateFn:(r,t)=>{let e=uX(t,"general"),i=uX(t,"errorAtPosition"),n=uX(t,"warningAtPosition"),o=$Te(t),s=jTe(t),a=[];return o&&a.push(["accessibility.signalOptions.volume",{value:o}]),e&&a.push(["accessibility.signalOptions.experimental.delays.general",{value:e}]),i&&a.push(["accessibility.signalOptions.experimental.delays.errorAtPosition",{value:i}]),n&&a.push(["accessibility.signalOptions.experimental.delays.warningAtPosition",{value:n}]),s&&a.push(["accessibility.signalOptions.debouncePositionChanges",{value:s}]),a.push(["accessibility.signalOptions",{value:void 0}]),a}}]);Pe.as(Nd.ConfigurationMigration).registerConfigurationMigrations([{key:"accessibility.signals.sounds.volume",migrateFn:r=>[["accessibility.signalOptions.volume",{value:r}],["accessibility.signals.sounds.volume",{value:void 0}]]}]);Pe.as(Nd.ConfigurationMigration).registerConfigurationMigrations([{key:"accessibility.signals.debouncePositionChanges",migrateFn:r=>[["accessibility.signalOptions.debouncePositionChanges",{value:r}],["accessibility.signals.debouncePositionChanges",{value:void 0}]]}]);function uX(r,t){return r(`accessibility.signalOptions.experimental.delays.${t}`)||r("accessibility.signalOptions")?.["experimental.delays"]?.[`${t}`]||r("accessibility.signalOptions")?.delays?.[`${t}`]}function $Te(r){return r("accessibility.signalOptions.volume")||r("accessibility.signalOptions")?.volume||r("accessibility.signals.sounds.volume")||r("audioCues.volume")}function jTe(r){return r("accessibility.signalOptions.debouncePositionChanges")||r("accessibility.signalOptions")?.debouncePositionChanges||r("accessibility.signals.debouncePositionChanges")||r("audioCues.debouncePositionChanges")}Pe.as(Nd.ConfigurationMigration).registerConfigurationMigrations([{key:"accessibility.voice.autoSynthesize",migrateFn:r=>{let t;if(r===!0)t="on";else if(r===!1)t="off";else return[];return[["accessibility.voice.autoSynthesize",{value:t}]]}}]);Pe.as(Nd.ConfigurationMigration).registerConfigurationMigrations([{key:"accessibility.signals.chatResponsePending",migrateFn:(r,t)=>[["accessibility.signals.progress",{value:r}],["accessibility.signals.chatResponsePending",{value:void 0}]]}]);Pe.as(Nd.ConfigurationMigration).registerConfigurationMigrations(ks.allAccessibilitySignals.map(r=>r.legacySoundSettingsKey?{key:r.legacySoundSettingsKey,migrateFn:(t,e)=>{let i=[],n=r.legacyAnnouncementSettingsKey,o;return n&&(o=e(n)??void 0,o!==void 0&&typeof o!="string"&&(o=o?"auto":"off")),i.push([`${r.legacySoundSettingsKey}`,{value:void 0}]),i.push([`${r.settingsKey}`,{value:o!==void 0?{announcement:o,sound:t}:{sound:t}}]),i}}:void 0).filter(go));Pe.as(Nd.ConfigurationMigration).registerConfigurationMigrations(ks.allAccessibilitySignals.filter(r=>!!r.legacyAnnouncementSettingsKey&&!!r.legacySoundSettingsKey).map(r=>({key:r.legacyAnnouncementSettingsKey,migrateFn:(t,e)=>{let i=[],n=e(r.settingsKey)?.sound||e(r.legacySoundSettingsKey);return t!==void 0&&typeof t!="string"&&(t=t?"auto":"off"),i.push([`${r.settingsKey}`,{value:t!==void 0?{announcement:t,sound:n}:{sound:n}}]),i.push([`${r.legacyAnnouncementSettingsKey}`,{value:void 0}]),i.push([`${r.legacySoundSettingsKey}`,{value:void 0}]),i}})));var wpe=J,Sg=class extends Yn{constructor(e,i,n,o,s,a,l,d,c,p,h){super(e,i,n);this.context=e;this.debugService=o;this.configurationService=s;this.commandService=a;this.contextService=l;this.keybindingService=c;this.hoverService=p;this.contextKeyService=h;this.toDispose=[],this.selectBox=new th([],-1,d,Jm,{ariaLabel:u("debugLaunchConfigurations","Debug Launch Configurations")}),this.selectBox.setFocusable(!1),this.toDispose.push(this.selectBox),this.registerListeners()}static SEPARATOR="\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500";container;start;selectBox;debugOptions=[];toDispose;selected=0;providers=[];registerListeners(){this.toDispose.push(this.configurationService.onDidChangeConfiguration(e=>{e.affectsConfiguration("launch")&&this.updateOptions()})),this.toDispose.push(this.debugService.getConfigurationManager().onDidSelectConfiguration(()=>{this.updateOptions()}))}render(e){this.container=e,e.classList.add("start-debug-action-item"),this.start=U(e,wpe(de.asCSSSelector(DB)));let i=this.keybindingService.lookupKeybinding(this.action.id)?.getLabel(),n=i?` (${i})`:"",o=this.action.label+n;this.toDispose.push(this.hoverService.setupManagedHover(gt("mouse"),this.start,o)),this.start.setAttribute("role","button"),this._setAriaLabel(o),this.toDispose.push(F(this.start,Q.CLICK,()=>{this.start.blur(),this.debugService.state!==1&&this.actionRunner.run(this.action,this.context)})),this.toDispose.push(F(this.start,Q.MOUSE_DOWN,d=>{this.action.enabled&&d.button===0&&this.start.classList.add("active")})),this.toDispose.push(F(this.start,Q.MOUSE_UP,()=>{this.start.classList.remove("active")})),this.toDispose.push(F(this.start,Q.MOUSE_OUT,()=>{this.start.classList.remove("active")})),this.toDispose.push(F(this.start,Q.KEY_DOWN,d=>{let c=new ut(d);c.equals(17)&&(this.start.tabIndex=-1,this.selectBox.focus(),c.stopPropagation())})),this.toDispose.push(this.selectBox.onDidSelect(async d=>{let c=this.debugOptions[d.index];(c.handler?await c.handler():!1)?this.selected=d.index:this.selectBox.select(this.selected)}));let s=wpe(".configuration");this.selectBox.render(U(e,s)),this.toDispose.push(F(s,Q.KEY_DOWN,d=>{let c=new ut(d);c.equals(15)&&(this.selectBox.setFocusable(!1),this.start.tabIndex=0,this.start.focus(),c.stopPropagation())})),this.container.style.border=`1px solid ${Se(Bf)}`,s.style.borderLeft=`1px solid ${Se(Bf)}`,this.container.style.backgroundColor=Se(Ff);let a=this.debugService.getConfigurationManager(),l=()=>a.getDynamicProviders().then(d=>{d.length!==this.providers.length&&(this.providers=d,this.updateOptions())});this.toDispose.push(a.onDidChangeConfigurationProviders(l)),l(),this.updateOptions()}setActionContext(e){this.context=e}isEnabled(){return!0}focus(e){e?this.selectBox.focus():(this.start.tabIndex=0,this.start.focus())}blur(){this.start.tabIndex=-1,this.selectBox.blur(),this.container.blur()}setFocusable(e){e?this.start.tabIndex=0:(this.start.tabIndex=-1,this.selectBox.setFocusable(!1))}dispose(){this.toDispose=_e(this.toDispose),super.dispose()}updateOptions(){this.selected=0,this.debugOptions=[];let e=this.debugService.getConfigurationManager(),i=this.contextService.getWorkbenchState()===3,n,o=[];e.getAllConfigurations().forEach(({launch:s,name:a,presentation:l})=>{n!==l?.group&&(n=l?.group,this.debugOptions.length&&(this.debugOptions.push({label:Sg.SEPARATOR,handler:()=>Promise.resolve(!1)}),o.push(this.debugOptions.length-1))),a===e.selectedConfiguration.name&&s===e.selectedConfiguration.launch&&(this.selected=this.debugOptions.length);let d=i?`${a} (${s.name})`:a;this.debugOptions.push({label:d,handler:async()=>(await e.selectConfiguration(s,a),!0)})}),e.getRecentDynamicConfigurations().slice(0,3).forEach(({name:s,type:a})=>{a===e.selectedConfiguration.type&&e.selectedConfiguration.name===s&&(this.selected=this.debugOptions.length),this.debugOptions.push({label:s,handler:async()=>(await e.selectConfiguration(void 0,s,void 0,{type:a}),!0)})}),this.debugOptions.length===0&&this.debugOptions.push({label:u("noConfigurations","No Configurations"),handler:async()=>!1}),this.debugOptions.push({label:Sg.SEPARATOR,handler:()=>Promise.resolve(!1)}),o.push(this.debugOptions.length-1),this.providers.forEach(s=>{this.debugOptions.push({label:`${s.label}...`,handler:async()=>{let a=await s.pick();return a?(await e.selectConfiguration(a.launch,a.config.name,a.config,{type:s.type}),!0):!1}})}),e.getLaunches().filter(s=>!s.hidden).forEach(s=>{let a=i?u("addConfigTo","Add Config ({0})...",s.name):u("addConfiguration","Add Configuration...");this.debugOptions.push({label:a,handler:async()=>(await this.commandService.executeCommand(Uy,s.uri.toString()),!1)})}),this.selectBox.setOptions(this.debugOptions.map((s,a)=>({text:s.label,isDisabled:o.indexOf(a)!==-1})),this.selected)}_setAriaLabel(e){let i=e,n;this.configurationService.getValue("accessibility.verbosity.debug")&&(n=this.keybindingService.lookupKeybinding("editor.action.accessibilityHelp",this.contextKeyService)?.getLabel()??void 0),n?i=u("commentLabelWithKeybinding","{0}, use ({1}) for accessibility help",i,n):i=u("commentLabelWithKeybindingNoKeybinding","{0}, run the command Open Accessibility Help which is currently not triggerable via keybinding.",i),this.start.ariaLabel=i}};Sg=E([b(3,we),b(4,se),b(5,ct),b(6,kt),b(7,so),b(8,Be),b(9,Nt),b(10,re)],Sg);var zh=class extends Cw{constructor(e,i,n,o,s){super(null,e,[],-1,o,Jm,{ariaLabel:u("debugSession","Debug Session")});this.debugService=n;this.configurationService=s;this._register(this.debugService.getViewModel().onDidFocusSession(()=>{let l=this.getSelectedSession();if(l){let d=this.getSessions().indexOf(l);this.select(d)}})),this._register(this.debugService.onDidNewSession(l=>{let d=[];d.push(l.onDidChangeName(()=>this.update())),d.push(l.onDidEndAdapter(()=>_e(d))),this.update()})),this.getSessions().forEach(l=>{this._register(l.onDidChangeName(()=>this.update()))}),this._register(this.debugService.onDidEndSession(()=>this.update()));let a=i?this.mapFocusedSessionToSelected(i):void 0;this.update(a)}getActionContext(e,i){return this.getSessions()[i]}update(e){e||(e=this.getSelectedSession());let i=this.getSessions(),n=i.map(o=>{let s=o.getLabel();return o.parentSession?`\xA0\xA0${s}`:s});this.setOptions(n.map(o=>({text:o})),e?i.indexOf(e):void 0)}getSelectedSession(){let e=this.debugService.getViewModel().focusedSession;return e?this.mapFocusedSessionToSelected(e):void 0}getSessions(){let e=this.configurationService.getValue("debug").showSubSessionsInToolBar,i=this.debugService.getModel().getSessions();return e?i:i.filter(n=>!n.parentSession)}mapFocusedSessionToSelected(e){let i=this.configurationService.getValue("debug").showSubSessionsInToolBar;for(;e.parentSession&&!i;)e=e.parentSession;return e}};zh=E([b(2,we),b(3,so),b(4,se)],zh);var Epe=T("debugToolBar.background",{dark:"#333333",light:"#F3F3F3",hcDark:"#000000",hcLight:"#FFFFFF"},u("debugToolBarBackground","Debug toolbar background color.")),xpe=T("debugToolBar.border",null,u("debugToolBarBorder","Debug toolbar border color.")),YTe=T("debugIcon.startForeground",{dark:"#89D185",light:"#388A34",hcDark:"#89D185",hcLight:"#388A34"},u("debugIcon.startForeground","Debug toolbar icon for start debugging."));function Tpe(){let r=T("debugTokenExpression.name",{dark:"#c586c0",light:"#9b46b0",hcDark:st,hcLight:st},"Foreground color for the token names shown in the debug views (ie. the Variables or Watch view)."),t=T("debugTokenExpression.type",{dark:"#4A90E2",light:"#4A90E2",hcDark:st,hcLight:st},"Foreground color for the token types shown in the debug views (ie. the Variables or Watch view)."),e=T("debugTokenExpression.value",{dark:"#cccccc99",light:"#6c6c6ccc",hcDark:st,hcLight:st},"Foreground color for the token values shown in the debug views (ie. the Variables or Watch view)."),i=T("debugTokenExpression.string",{dark:"#ce9178",light:"#a31515",hcDark:"#f48771",hcLight:"#a31515"},"Foreground color for strings in the debug views (ie. the Variables or Watch view)."),n=T("debugTokenExpression.boolean",{dark:"#4e94ce",light:"#0000ff",hcDark:"#75bdfe",hcLight:"#0000ff"},"Foreground color for booleans in the debug views (ie. the Variables or Watch view)."),o=T("debugTokenExpression.number",{dark:"#b5cea8",light:"#098658",hcDark:"#89d185",hcLight:"#098658"},"Foreground color for numbers in the debug views (ie. the Variables or Watch view)."),s=T("debugTokenExpression.error",{dark:"#f48771",light:"#e51400",hcDark:"#f48771",hcLight:"#e51400"},"Foreground color for expression errors in the debug views (ie. the Variables or Watch view) and for error logs shown in the debug console."),a=T("debugView.exceptionLabelForeground",{dark:st,light:"#FFF",hcDark:st,hcLight:st},"Foreground color for a label shown in the CALL STACK view when the debugger breaks on an exception."),l=T("debugView.exceptionLabelBackground",{dark:"#6C2022",light:"#A31515",hcDark:"#6C2022",hcLight:"#A31515"},"Background color for a label shown in the CALL STACK view when the debugger breaks on an exception."),d=T("debugView.stateLabelForeground",st,"Foreground color for a label in the CALL STACK view showing the current session's or thread's state."),c=T("debugView.stateLabelBackground","#88888844","Background color for a label in the CALL STACK view showing the current session's or thread's state."),p=T("debugView.valueChangedHighlight","#569CD6","Color used to highlight value changes in the debug views (ie. in the Variables view)."),h=T("debugConsole.infoForeground",{dark:Jr,light:Jr,hcDark:st,hcLight:st},"Foreground color for info messages in debug REPL console."),m=T("debugConsole.warningForeground",{dark:Zr,light:Zr,hcDark:"#008000",hcLight:Zr},"Foreground color for warning messages in debug REPL console."),f=T("debugConsole.errorForeground",tk,"Foreground color for error messages in debug REPL console."),g=T("debugConsole.sourceForeground",st,"Foreground color for source filenames in debug REPL console."),v=T("debugConsoleInputIcon.foreground",st,"Foreground color for debug console input marker icon."),I=T("debugIcon.pauseForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},u("debugIcon.pauseForeground","Debug toolbar icon for pause.")),y=T("debugIcon.stopForeground",{dark:"#F48771",light:"#A1260D",hcDark:"#F48771",hcLight:"#A1260D"},u("debugIcon.stopForeground","Debug toolbar icon for stop.")),w=T("debugIcon.disconnectForeground",{dark:"#F48771",light:"#A1260D",hcDark:"#F48771",hcLight:"#A1260D"},u("debugIcon.disconnectForeground","Debug toolbar icon for disconnect.")),C=T("debugIcon.restartForeground",{dark:"#89D185",light:"#388A34",hcDark:"#89D185",hcLight:"#388A34"},u("debugIcon.restartForeground","Debug toolbar icon for restart.")),S=T("debugIcon.stepOverForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},u("debugIcon.stepOverForeground","Debug toolbar icon for step over.")),D=T("debugIcon.stepIntoForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},u("debugIcon.stepIntoForeground","Debug toolbar icon for step into.")),k=T("debugIcon.stepOutForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},u("debugIcon.stepOutForeground","Debug toolbar icon for step over.")),M=T("debugIcon.continueForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},u("debugIcon.continueForeground","Debug toolbar icon for continue.")),O=T("debugIcon.stepBackForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},u("debugIcon.stepBackForeground","Debug toolbar icon for step back."));Zo((K,G)=>{let Y=K.getColor(gc),ge=K.getColor(Rf),xe=K.getColor(Doe),be=K.getColor(a),fe=K.getColor(l),Le=K.getColor(d),Ee=K.getColor(c),Ce=K.getColor(p),Je=K.getColor(EI);G.addRule(`
			/* Text colour of the call stack row's filename */
			.debug-pane .debug-call-stack .monaco-list-row:not(.selected) .stack-frame > .file .file-name {
				color: ${xe}
			}

			/* Line & column number "badge" for selected call stack row */
			.debug-pane .monaco-list-row.selected .line-number {
				background-color: ${Y};
				color: ${ge};
			}

			/* Line & column number "badge" for unselected call stack row (basically all other rows) */
			.debug-pane .line-number {
				background-color: ${Y.transparent(.6)};
				color: ${ge.transparent(.6)};
			}

			/* State "badge" displaying the active session's current state.
			* Only visible when there are more active debug sessions/threads running.
			*/
			.debug-pane .debug-call-stack .thread > .state.label,
			.debug-pane .debug-call-stack .session > .state.label {
				background-color: ${Ee};
				color: ${Le};
			}

			/* State "badge" displaying the active session's current state.
			* Only visible when there are more active debug sessions/threads running
			* and thread paused due to a thrown exception.
			*/
			.debug-pane .debug-call-stack .thread > .state.label.exception,
			.debug-pane .debug-call-stack .session > .state.label.exception {
				background-color: ${fe};
				color: ${be};
			}

			/* Info "badge" shown when the debugger pauses due to a thrown exception. */
			.debug-pane .call-stack-state-message > .label.exception {
				background-color: ${fe};
				color: ${be};
			}

			/* Animation of changed values in Debug viewlet */
			@keyframes debugViewletValueChanged {
				0%   { background-color: ${Ce.transparent(0)} }
				5%   { background-color: ${Ce.transparent(.9)} }
				100% { background-color: ${Ce.transparent(.3)} }
			}

			.debug-pane .monaco-list-row .expression .value.changed {
				background-color: ${Ce.transparent(.3)};
				animation-name: debugViewletValueChanged;
				animation-duration: 1s;
				animation-fill-mode: forwards;
			}

			.monaco-list-row .expression .lazy-button:hover {
				background-color: ${Je}
			}
		`);let pe=K.getColor(Oe);pe&&G.addRule(`
			.debug-pane .line-number {
				border: 1px solid ${pe};
			}
			`),oa(K.type)&&G.addRule(`
			.debug-pane .line-number {
				background-color: ${Y};
				color: ${ge};
			}`);let qt=K.getColor(r),Mt=K.getColor(t),at=K.getColor(e),On=K.getColor(i),Nn=K.getColor(n),Ro=K.getColor(s),or=K.getColor(o);G.addRule(`
			.monaco-workbench .monaco-list-row .expression .name {
				color: ${qt};
			}

			.monaco-workbench .monaco-list-row .expression .type {
				color: ${Mt};
			}

			.monaco-workbench .monaco-list-row .expression .value,
			.monaco-workbench .debug-hover-widget .value {
				color: ${at};
			}

			.monaco-workbench .monaco-list-row .expression .value.string,
			.monaco-workbench .debug-hover-widget .value.string {
				color: ${On};
			}

			.monaco-workbench .monaco-list-row .expression .value.boolean,
			.monaco-workbench .debug-hover-widget .value.boolean {
				color: ${Nn};
			}

			.monaco-workbench .monaco-list-row .expression .error,
			.monaco-workbench .debug-hover-widget .error,
			.monaco-workbench .debug-pane .debug-variables .scope .error {
				color: ${Ro};
			}

			.monaco-workbench .monaco-list-row .expression .value.number,
			.monaco-workbench .debug-hover-widget .value.number {
				color: ${or};
			}
		`);let sd=K.getColor(Nf)||j.fromHex("#80808060"),Qi=K.getColor(h),Br=K.getColor(m),im=K.getColor(f),dp=K.getColor(g),Vr=K.getColor(v);G.addRule(`
			.repl .repl-input-wrapper {
				border-top: 1px solid ${sd};
			}

			.monaco-workbench .repl .repl-tree .output .expression .value.info {
				color: ${Qi};
			}

			.monaco-workbench .repl .repl-tree .output .expression .value.warn {
				color: ${Br};
			}

			.monaco-workbench .repl .repl-tree .output .expression .value.error {
				color: ${im};
			}

			.monaco-workbench .repl .repl-tree .output .expression .source {
				color: ${dp};
			}

			.monaco-workbench .repl .repl-tree .monaco-tl-contents .arrow {
				color: ${Vr};
			}
		`),K.defines(v)||G.addRule(`
				.monaco-workbench.vs .repl .repl-tree .monaco-tl-contents .arrow {
					opacity: 0.25;
				}

				.monaco-workbench.vs-dark .repl .repl-tree .monaco-tl-contents .arrow {
					opacity: 0.4;
				}

				.monaco-workbench.hc-black .repl .repl-tree .monaco-tl-contents .arrow,
				.monaco-workbench.hc-light .repl .repl-tree .monaco-tl-contents .arrow {
					opacity: 1;
				}
			`);let Bc=K.getColor(YTe);Bc&&G.addRule(`.monaco-workbench ${de.asCSSSelector(DB)} { color: ${Bc}; }`);let Vc=K.getColor(I);Vc&&G.addRule(`.monaco-workbench .part > .title > .title-actions .action-label${de.asCSSSelector(sy)}, .monaco-workbench ${de.asCSSSelector(sy)} { color: ${Vc}; }`);let nm=K.getColor(y);nm&&G.addRule(`.monaco-workbench .part > .title > .title-actions .action-label${de.asCSSSelector(rg)},.monaco-workbench ${de.asCSSSelector(rg)} { color: ${nm}; }`);let om=K.getColor(w);om&&G.addRule(`.monaco-workbench .part > .title > .title-actions .action-label${de.asCSSSelector(Dc)},.monaco-workbench .debug-view-content ${de.asCSSSelector(Dc)}, .monaco-workbench .debug-toolbar ${de.asCSSSelector(Dc)}, .monaco-workbench .command-center-center ${de.asCSSSelector(Dc)} { color: ${om}; }`);let Rt=K.getColor(C);Rt&&G.addRule(`.monaco-workbench ${de.asCSSSelector(oy)}, .monaco-workbench ${de.asCSSSelector(AL)}, .monaco-workbench .part > .title > .title-actions .action-label${de.asCSSSelector(oy)}, .monaco-workbench .part > .title > .title-actions .action-label${de.asCSSSelector(AL)} { color: ${Rt}; }`);let nc=K.getColor(S);nc&&G.addRule(`.monaco-workbench .part > .title > .title-actions .action-label${de.asCSSSelector(ry)}, .monaco-workbench ${de.asCSSSelector(ry)} { color: ${nc}; }`);let Wc=K.getColor(D);Wc&&G.addRule(`.monaco-workbench .part > .title > .title-actions .action-label${de.asCSSSelector(mb)}, .monaco-workbench .part > .title > .title-actions .action-label${de.asCSSSelector(mb)}, .monaco-workbench ${de.asCSSSelector(mb)} { color: ${Wc}; }`);let ad=K.getColor(k);ad&&G.addRule(`.monaco-workbench .part > .title > .title-actions .action-label${de.asCSSSelector(gb)}, .monaco-workbench .part > .title > .title-actions .action-label${de.asCSSSelector(gb)}, .monaco-workbench ${de.asCSSSelector(gb)} { color: ${ad}; }`);let Ka=K.getColor(M);Ka&&G.addRule(`.monaco-workbench .part > .title > .title-actions .action-label${de.asCSSSelector(ay)}, .monaco-workbench ${de.asCSSSelector(ay)}, .monaco-workbench .part > .title > .title-actions .action-label${de.asCSSSelector(NL)}, .monaco-workbench ${de.asCSSSelector(NL)} { color: ${Ka}; }`);let Bg=K.getColor(O);Bg&&G.addRule(`.monaco-workbench .part > .title > .title-actions .action-label${de.asCSSSelector(OL)}, .monaco-workbench ${de.asCSSSelector(OL)} { color: ${Bg}; }`)})}var _pe="debug.actionswidgetposition",Dpe="debug.actionswidgety",Px=class extends fc{constructor(e,i,n,o,s,a,l,d,c,p){super(l);this.notificationService=e;this.telemetryService=i;this.debugService=n;this.layoutService=o;this.storageService=s;this.configurationService=a;this.instantiationService=d;this.$el=J("div.debug-toolbar"),this.$el.style.top=`${o.mainContainerOffset.top}px`,this.dragArea=U(this.$el,J("div.drag-area"+de.asCSSSelector(Rde)));let h=U(this.$el,J("div.action-bar-container"));this.debugToolBarMenu=c.createMenu(V.DebugToolBar,p),this._register(this.debugToolBarMenu),this.activeActions=[],this.actionBar=this._register(new Fi(h,{orientation:0,actionViewItemProvider:(m,f)=>{if(m.id===_x)return this.instantiationService.createInstance(zh,m,void 0);if(m.id===Va||m.id===td){this.stopActionViewItemDisposables.clear();let g=this.instantiationService.invokeFunction(v=>dP(m,this.stopActionViewItemDisposables,v,{hoverDelegate:f.hoverDelegate}));if(g)return g}return aa(this.instantiationService,m,f)}})),this.updateScheduler=this._register(new Ye(()=>{let m=this.debugService.state,f=this.configurationService.getValue("debug").toolBarLocation;if(m===0||f!=="floating"||this.debugService.getModel().getSessions().every(v=>v.suppressDebugToolbar)||m===1&&this.debugService.initializingOptions?.suppressDebugToolbar)return this.hide();let g=[];Vo(this.debugToolBarMenu,{shouldForwardArgs:!0},g),xi(g,this.activeActions,(v,I)=>v.id===I.id&&v.enabled===I.enabled)||(this.actionBar.clear(),this.actionBar.push(g,{icon:!0,label:!1}),this.activeActions=g),this.show()},20)),this.updateStyles(),this.registerListeners(),this.hide()}$el;dragArea;actionBar;activeActions;updateScheduler;debugToolBarMenu;isVisible=!1;isBuilt=!1;stopActionViewItemDisposables=this._register(new B);auxWindowCoordinates=new WeakMap;trackPixelRatioListener=this._register(new yt);registerListeners(){this._register(this.debugService.onDidChangeState(()=>this.updateScheduler.schedule())),this._register(this.configurationService.onDidChangeConfiguration(n=>{n.affectsConfiguration("debug.toolBarLocation")&&this.updateScheduler.schedule(),(n.affectsConfiguration("workbench.editor.showTabs")||n.affectsConfiguration("window.commandCenter"))&&(this._yRange=void 0,this.setCoordinates())})),this._register(this.debugToolBarMenu.onDidChange(()=>this.updateScheduler.schedule())),this._register(this.actionBar.actionRunner.onDidRun(n=>{n.error&&!vl(n.error)&&this.notificationService.warn(n.error),this.telemetryService.publicLog2("workbenchActionExecuted",{id:n.action.id,from:"debugActionsWidget"})})),this._register($4(this.dragArea,n=>{let o=new _i(ue(this.dragArea),n),s=ue(this.layoutService.activeContainer);if(o.detail===2){let a=this.$el.clientWidth;this.setCoordinates(.5*s.innerWidth-.5*a,this.yDefault),this.storePosition()}})),this._register(ite(this.dragArea,n=>{this.dragArea.classList.add("dragged");let o=ue(this.layoutService.activeContainer),s=nte(o,l=>{let d=new _i(o,l);d.preventDefault(),this.setCoordinates(d.posx-14,d.posy-14)}),a=$4(o,l=>{this.storePosition(),this.dragArea.classList.remove("dragged"),s.dispose(),a.dispose()})})),this._register(this.layoutService.onDidChangePartVisibility(()=>this.setCoordinates()));let e=this._register(new yt),i=()=>{e.value=this._register(F(ue(this.layoutService.activeContainer),Q.RESIZE,()=>this.setCoordinates()))};this._register(this.layoutService.onDidChangeActiveContainer(async()=>{this._yRange=void 0,await this.layoutService.whenContainerStylesLoaded(ue(this.layoutService.activeContainer)),this.isBuilt&&(this.doShowInActiveContainer(),this.setCoordinates()),i()})),i()}storePosition(){let e=ue(this.layoutService.activeContainer),i=this.layoutService.activeContainer===this.layoutService.mainContainer,n=this.$el.getBoundingClientRect(),o=n.top,s=n.left/e.innerWidth;i?(this.storageService.store(_pe,s,0,1),this.storageService.store(Dpe,o,0,1)):this.auxWindowCoordinates.set(e,{x:s,y:o})}updateStyles(){if(super.updateStyles(),this.$el){this.$el.style.backgroundColor=this.getColor(Epe)||"";let e=this.getColor(Hp);this.$el.style.boxShadow=e?`0 0 8px 2px ${e}`:"";let i=this.getColor(Am),n=this.getColor(xpe);i?this.$el.style.border=`1px solid ${i}`:(this.$el.style.border=n?`solid ${n}`:"none",this.$el.style.border="1px 0")}}setCoordinates(e,i){if(!this.isVisible)return;let n=this.$el.clientWidth,o=ue(this.layoutService.activeContainer),s=o===Ke;if(e===void 0){let a=s?Number(this.storageService.get(_pe,0)):this.auxWindowCoordinates.get(o)?.x;e=a!==void 0&&!isNaN(a)?a*o.innerWidth:.5*o.innerWidth-.5*n}e=pn(e,0,o.innerWidth-n),this.$el.style.left=`${e}px`,i===void 0&&(i=s?this.storageService.getNumber(Dpe,0):this.auxWindowCoordinates.get(o)?.y),this.setYCoordinate(i??this.yDefault)}setYCoordinate(e){let[i,n]=this.yRange;e=Math.max(i,Math.min(e,n)),this.$el.style.top=`${e}px`}get yDefault(){return this.layoutService.mainContainerOffset.top}_yRange;get yRange(){if(!this._yRange){let e=this.layoutService.isVisible("workbench.parts.titlebar",ue(this.layoutService.activeContainer)),i=e?0:this.layoutService.mainContainerOffset.top,n=0;e&&(this.configurationService.getValue("window.commandCenter")===!0?n+=35:n+=28),this.configurationService.getValue("workbench.editor.showTabs")!=="none"&&(n+=35),this._yRange=[i,n]}return this._yRange}show(){if(this.isVisible){this.setCoordinates();return}this.isBuilt||(this.isBuilt=!0,this.doShowInActiveContainer()),this.isVisible=!0,rn(this.$el),this.setCoordinates()}doShowInActiveContainer(){this.layoutService.activeContainer.appendChild(this.$el),this.trackPixelRatioListener.value=Zs.getInstance(ue(this.$el)).onDidChange(()=>this.setCoordinates())}hide(){this.isVisible=!1,ji(this.$el)}dispose(){super.dispose(),this.$el?.remove()}};Px=E([b(0,mi),b(1,Tt),b(2,we),b(3,ii),b(4,nt),b(5,se),b(6,Fe),b(7,ne),b(8,jt),b(9,re)],Px);function dP(r,t,e,i){let n=e.get(jt),o=e.get(re),s=e.get(ne),a=e.get(vt),l=n.getMenuActions(V.DebugToolBarStop,o,{shouldForwardArgs:!0}),d=[];if(Vo(l,d),!d.length)return;let c=t.add(new et("notebook.moreRunActions",u("notebook.moreRunActionsLabel","More..."),"codicon-chevron-down",!0));return s.createInstance(Lx,r,c,d,"debug-stop-actions",a,i)}var pX=[],$u=(r,t,e,i,n,o,s)=>{Ue.appendMenuItem(V.DebugToolBar,{group:"navigation",when:n,order:e,command:{id:r,title:t,icon:i,precondition:o},alt:s}),pX.push(Ue.appendMenuItem(V.ViewContainerTitle,{group:"navigation",when:P.and(n,P.equals("viewContainer",nr),Gt.notEqualsTo("inactive"),P.equals("config.debug.toolBarLocation","docked")),order:e,command:{id:r,title:t,icon:i,precondition:o}}))};rc(Ue.onDidChangeMenu(r=>{if(r.has(V.DebugToolBar)){_e(pX);let t=Ue.getMenuItems(V.DebugToolBar);for(let e of t)pX.push(Ue.appendMenuItem(V.ViewContainerTitle,{...e,when:P.and(e.when,P.equals("viewContainer",nr),Gt.notEqualsTo("inactive"),P.equals("config.debug.toolBarLocation","docked"))}))}}));var Lpe=P.equals("config.debug.toolBarLocation","commandCenter");Ue.appendMenuItem(V.CommandCenterCenter,{submenu:V.DebugToolBar,title:"Debug",icon:N.debug,order:1,when:P.and(ui,Lpe)});$u(Fh,ev,10,ay,Gt.isEqualTo("stopped"));$u(vg,Jb,10,sy,Gt.notEqualsTo("stopped"),P.and(Gt.isEqualTo("running"),Th.toNegated()));$u(Va,Vh,70,rg,qs.toNegated(),void 0,{id:td,title:Ig,icon:Dc,precondition:P.and(qs.toNegated(),Kd)});$u(td,Ig,70,Dc,qs,void 0,{id:Va,title:Vh,icon:rg,precondition:P.and(qs,Kd)});$u(Ah,Yb,20,ry,void 0,Gt.isEqualTo("stopped"));$u(Oh,Qb,30,mb,void 0,Gt.isEqualTo("stopped"));$u(Nh,Zb,40,gb,void 0,Gt.isEqualTo("stopped"));$u(Mh,Xb,60,oy);$u(Uj,u("stepBackDebug","Step Back"),50,OL,YL,Gt.isEqualTo("stopped"));$u(Hj,u("reverseContinue","Reverse"),55,NL,YL,Gt.isEqualTo("stopped"));$u(_x,$ue,100,N.listTree,P.and(bV,Lpe.negate()));Ue.appendMenuItem(V.DebugToolBarStop,{group:"navigation",when:P.and(qs.toNegated(),Kd),order:0,command:{id:td,title:Ig,icon:Dc}});Ue.appendMenuItem(V.DebugToolBarStop,{group:"navigation",when:P.and(qs,Kd),order:0,command:{id:Va,title:Vh,icon:rg}});Ue.appendMenuItem(V.DebugToolBarStop,{group:"navigation",when:P.or(P.and(qs.toNegated(),wb,Kd),P.and(qs,wb)),order:0,command:{id:Tx,title:iP,icon:Dc}});var js=J;function Ppe(r,t){return t.sessionId=r.getId(),t}function Mpe(r,t){return t.threadId=r.getId(),Ppe(r.session,t),t}function QTe(r,t){return t.frameId=r.getId(),t.frameName=r.name,t.frameLocation={range:r.range,source:r.source.raw},Mpe(r.thread,t),t}function IX(r){return r instanceof Ma?QTe(r,{}):r instanceof Hd?Mpe(r,{}):ju(r)?Ppe(r,{}):void 0}function yX(r){return r instanceof Ma?r.source.inMemory?r.source.raw.path||r.source.reference||r.source.name:r.source.uri.toString():r instanceof Hd?r.threadId:ju(r)?r.getId():""}function Ape(r){let t=r.thread.getStaleCallStack();t=t.length>0?t:r.thread.getCallStack();let e=t.map(o=>o.source).filter(o=>o!==r.source),i=0;if(e.forEach(o=>{o.name===r.source.name&&(i=Math.max(i,Gv(r.source.uri.path,o.uri.path)))}),i===0)return r.source.name;let n=Math.max(0,r.source.uri.path.lastIndexOf(Xt.sep,r.source.uri.path.length-i-1));return(n>0?"...":"")+r.source.uri.path.substring(n)}async function hX(r,t){r.parentSession&&await hX(r.parentSession,t),await t.expand(r)}var Mx=class extends Lr{constructor(e,i,n,o,s,a,l,d,c,p,h,m,f){super(e,o,i,l,d,a,s,c,p,h,m);this.options=e;this.debugService=n;this.menuService=f;this.onCallStackChangeScheduler=this._register(new Ye(async()=>{let g=this.debugService.getModel().getSessions();g.length===0&&this.autoExpandedSessions.clear();let v=g.length===1&&g[0].getAllThreads().length===1?g[0].getAllThreads()[0]:void 0,I=g.length===1?g[0].getStoppedDetails():void 0;I&&(v||typeof I.threadId!="number")?(this.stateMessageLabel.textContent=PU(I),this.stateMessageLabelHover.update(gX(I)),this.stateMessageLabel.classList.toggle("exception",I.reason==="exception"),this.stateMessage.hidden=!1):g.length===1&&g[0].state===3?(this.stateMessageLabel.textContent=u({key:"running",comment:["indicates state"]},"Running"),this.stateMessageLabelHover.update(g[0].getLabel()),this.stateMessageLabel.classList.remove("exception"),this.stateMessage.hidden=!1):this.stateMessage.hidden=!0,this.updateActions(),this.needsRefresh=!1,this.dataSource.deemphasizedStackFramesToShow=[],await this.tree.updateChildren();try{let y=new Set;g.forEach(w=>{w.parentSession&&!this.autoExpandedSessions.has(w.parentSession)&&y.add(w.parentSession)});for(let w of y)await hX(w,this.tree),this.autoExpandedSessions.add(w)}catch{}this.selectionNeedsUpdate&&(this.selectionNeedsUpdate=!1,await this.updateTreeSelection())},50))}stateMessage;stateMessageLabel;stateMessageLabelHover;onCallStackChangeScheduler;needsRefresh=!1;ignoreSelectionChangedEvent=!1;ignoreFocusStackFrameEvent=!1;dataSource;tree;autoExpandedSessions=new Set;selectionNeedsUpdate=!1;renderHeaderTitle(e){super.renderHeaderTitle(e,this.options.title),this.stateMessage=U(e,js("span.call-stack-state-message")),this.stateMessage.hidden=!0,this.stateMessageLabel=U(this.stateMessage,js("span.label")),this.stateMessageLabelHover=this._register(this.hoverService.setupManagedHover(gt("mouse"),this.stateMessage,""))}renderBody(e){super.renderBody(e),this.element.classList.add("debug-pane"),e.classList.add("debug-call-stack");let i=nv(e);this.dataSource=new fX(this.debugService),this.tree=this.instantiationService.createInstance(lE,"CallStackView",i,new mX,new vX(this.debugService),[this.instantiationService.createInstance(rv),this.instantiationService.createInstance(sv),this.instantiationService.createInstance(av),this.instantiationService.createInstance(lv),new Ax,new RU],this.dataSource,{accessibilityProvider:new bX,compressionEnabled:!0,autoExpandSingleChildren:!0,identityProvider:{getId:o=>typeof o=="string"?o:o instanceof Array?`showMore ${o[0].getId()}`:o.getId()},keyboardNavigationLabelProvider:{getKeyboardNavigationLabel:o=>ju(o)?o.getLabel():o instanceof Hd?`${o.name} ${o.stateLabel}`:o instanceof Ma||typeof o=="string"?o:o instanceof vb?Ax.LABEL:u("showMoreStackFrames2","Show More Stack Frames"),getCompressedNodeKeyboardNavigationLabel:o=>{let s=o[0];return ju(s)?s.getLabel():""}},expandOnlyOnTwistieClick:!0,overrideStyles:this.getLocationBasedColors().listOverrideStyles}),this.tree.setInput(this.debugService.getModel()),this._register(this.tree),this._register(this.tree.onDidOpen(async o=>{if(this.ignoreSelectionChangedEvent)return;let s=(l,d,c,p={})=>{this.ignoreFocusStackFrameEvent=!0;try{this.debugService.focusStackFrame(l,d,c,{...p,explicit:!0})}finally{this.ignoreFocusStackFrameEvent=!1}},a=o.element;if(a instanceof Ma){let l={preserveFocus:o.editorOptions.preserveFocus,sideBySide:o.sideBySide,pinned:o.editorOptions.pinned};s(a,a.thread,a.thread.session,l)}if(a instanceof Hd&&s(void 0,a,a.session),ju(a)&&s(void 0,void 0,a),a instanceof vb){let l=this.debugService.getModel().getSession(a.sessionId),d=l&&l.getThread(a.threadId);if(d){let c=d.stoppedDetails?.totalFrames,p=typeof c=="number"?c-d.getCallStack().length:void 0;await d.fetchCallStack(p),await this.tree.updateChildren()}}a instanceof Array&&(this.dataSource.deemphasizedStackFramesToShow.push(...a),this.tree.updateChildren())})),this._register(this.debugService.getModel().onDidChangeCallStack(()=>{if(!this.isBodyVisible()){this.needsRefresh=!0;return}this.onCallStackChangeScheduler.isScheduled()||this.onCallStackChangeScheduler.schedule()}));let n=X.any(this.debugService.getViewModel().onDidFocusStackFrame,this.debugService.getViewModel().onDidFocusSession);this._register(n(async()=>{if(!this.ignoreFocusStackFrameEvent){if(!this.isBodyVisible()){this.needsRefresh=!0,this.selectionNeedsUpdate=!0;return}if(this.onCallStackChangeScheduler.isScheduled()){this.selectionNeedsUpdate=!0;return}await this.updateTreeSelection()}})),this._register(this.tree.onContextMenu(o=>this.onContextMenu(o))),this.debugService.state===2&&this.onCallStackChangeScheduler.schedule(0),this._register(this.onDidChangeBodyVisibility(o=>{o&&this.needsRefresh&&this.onCallStackChangeScheduler.schedule()})),this._register(this.debugService.onDidNewSession(o=>{let s=[];s.push(o.onDidChangeName(()=>{this.tree.hasNode(o)&&this.tree.rerender(o)})),s.push(o.onDidEndAdapter(()=>_e(s))),o.parentSession&&this.autoExpandedSessions.delete(o.parentSession)}))}layoutBody(e,i){super.layoutBody(e,i),this.tree.layout(e,i)}focus(){super.focus(),this.tree.domFocus()}collapseAll(){this.tree.collapseAll()}async updateTreeSelection(){if(!this.tree||!this.tree.getInput())return;let e=s=>{this.ignoreSelectionChangedEvent=!0;try{this.tree.setSelection([s]),this.tree.getRelativeTop(s)===null?this.tree.reveal(s,.5):this.tree.reveal(s)}catch{}finally{this.ignoreSelectionChangedEvent=!1}},i=this.debugService.getViewModel().focusedThread,n=this.debugService.getViewModel().focusedSession,o=this.debugService.getViewModel().focusedStackFrame;if(!i)n?e(n):this.tree.setSelection([]);else{try{await hX(i.session,this.tree)}catch{}try{await this.tree.expand(i)}catch{}let s=o||n;s&&e(s)}}onContextMenu(e){let i=e.element,n=[];ju(i)?n=Ope(i):i instanceof Hd?n=Npe(i):i instanceof Ma&&(n=ZTe(i));let a={primary:[],secondary:[]},l=this.contextKeyService.createOverlay(n),d=this.menuService.getMenuActions(V.DebugCallStackContext,l,{arg:yX(i),shouldForwardArgs:!0});sa(d,a,"inline"),this.contextMenuService.showContextMenu({getAnchor:()=>e.anchor,getActions:()=>a.secondary,getActionsContext:()=>IX(i)})}};Mx=E([b(1,vt),b(2,we),b(3,Be),b(4,ne),b(5,$i),b(6,se),b(7,re),b(8,Yi),b(9,Fe),b(10,Tt),b(11,Nt),b(12,jt)],Mx);function Ope(r){return[[Ho.key,"session"],[cV.key,FL(r)],[Sb.key,r.state===2],[hq.key,r.getAllThreads().length===1]]}var rv=class{constructor(t,e,i,n){this.instantiationService=t;this.contextKeyService=e;this.hoverService=i;this.menuService=n}static ID="session";get templateId(){return rv.ID}renderTemplate(t){let e=U(t,js(".session"));U(e,js(de.asCSSSelector(Ade)));let i=U(e,js(".name")),n=U(e,js("span.state.label.monaco-count-badge.long")),o=new B,s=o.add(new Rr(i)),a=o.add(new B),l=o.add(new Fi(e,{actionViewItemProvider:(c,p)=>{if((c.id===Va||c.id===td)&&c instanceof wn){a.clear();let h=this.instantiationService.invokeFunction(m=>dP(c,a,m,{...p,menuAsChild:!1}));if(h)return h}if(c instanceof wn)return this.instantiationService.createInstance(Gl,c,{hoverDelegate:p.hoverDelegate});if(c instanceof to)return this.instantiationService.createInstance(eg,c,{hoverDelegate:p.hoverDelegate})}})),d=o.add(new B);return{session:e,name:i,stateLabel:n,label:s,actionBar:l,elementDisposable:d,templateDisposable:o}}renderElement(t,e,i){this.doRenderElement(t.element,qo(t.filterData),i)}renderCompressedElements(t,e,i){let n=t.element.elements[t.element.elements.length-1],o=qo(t.filterData);this.doRenderElement(n,o,i)}doRenderElement(t,e,i){let n=i.elementDisposable.add(this.hoverService.setupManagedHover(gt("mouse"),i.session,u({key:"session",comment:["Session is a noun"]},"Session")));i.label.set(t.getLabel(),e);let o=t.getStoppedDetails(),s=t.getAllThreads().find(c=>c.stopped),a=this.contextKeyService.createOverlay(Ope(t)),l=i.elementDisposable.add(this.menuService.createMenu(V.DebugCallStackContext,a)),d=()=>{i.actionBar.clear();let c=[],h={primary:c,secondary:[]};Vo(l,{arg:yX(t),shouldForwardArgs:!0},h,"inline"),i.actionBar.push(c,{icon:!0,label:!1}),i.actionBar.context=IX(t)};i.elementDisposable.add(l.onDidChange(()=>d())),d(),i.stateLabel.style.display="",o?(i.stateLabel.textContent=PU(o),n.update(`${t.getLabel()}: ${gX(o)}`),i.stateLabel.classList.toggle("exception",o.reason==="exception")):s&&s.stoppedDetails?(i.stateLabel.textContent=PU(s.stoppedDetails),n.update(`${t.getLabel()}: ${gX(s.stoppedDetails)}`),i.stateLabel.classList.toggle("exception",s.stoppedDetails.reason==="exception")):(i.stateLabel.textContent=u({key:"running",comment:["indicates state"]},"Running"),i.stateLabel.classList.remove("exception"))}disposeTemplate(t){t.templateDisposable.dispose()}disposeElement(t,e,i){i.elementDisposable.clear()}disposeCompressedElements(t,e,i,n){i.elementDisposable.clear()}};rv=E([b(0,ne),b(1,re),b(2,Nt),b(3,jt)],rv);function Npe(r){return[[Ho.key,"thread"],[Sb.key,r.stopped]]}var sv=class{constructor(t,e,i){this.contextKeyService=t;this.hoverService=e;this.menuService=i}static ID="thread";get templateId(){return sv.ID}renderTemplate(t){let e=U(t,js(".thread")),i=U(e,js(".name")),n=U(e,js("span.state.label.monaco-count-badge.long")),o=new B,s=o.add(new Rr(i)),a=o.add(new Fi(e)),l=o.add(new B);return{thread:e,name:i,stateLabel:n,label:s,actionBar:a,elementDisposable:l,templateDisposable:o}}renderElement(t,e,i){let n=t.element;i.elementDisposable.add(this.hoverService.setupManagedHover(gt("mouse"),i.thread,n.name)),i.label.set(n.name,qo(t.filterData)),i.stateLabel.textContent=n.stateLabel,i.stateLabel.classList.toggle("exception",n.stoppedDetails?.reason==="exception");let o=this.contextKeyService.createOverlay(Npe(n)),s=i.elementDisposable.add(this.menuService.createMenu(V.DebugCallStackContext,o)),a=()=>{i.actionBar.clear();let l=[],c={primary:l,secondary:[]};Vo(s,{arg:yX(n),shouldForwardArgs:!0},c,"inline"),i.actionBar.push(l,{icon:!0,label:!1}),i.actionBar.context=IX(n)};i.elementDisposable.add(s.onDidChange(()=>a())),a()}renderCompressedElements(t,e,i,n){throw new Error("Method not implemented.")}disposeElement(t,e,i){i.elementDisposable.clear()}disposeTemplate(t){t.templateDisposable.dispose()}};sv=E([b(0,re),b(1,Nt),b(2,jt)],sv);function ZTe(r){return[[Ho.key,"stackFrame"],[mV.key,r.canRestart]]}var av=class{constructor(t,e,i){this.hoverService=t;this.labelService=e;this.notificationService=i}static ID="stackFrame";get templateId(){return av.ID}renderTemplate(t){let e=U(t,js(".stack-frame")),i=U(e,js("span.label.expression")),n=U(e,js(".file")),o=U(n,js("span.file-name")),s=U(n,js("span.line-number-wrapper")),a=U(s,js("span.line-number.monaco-count-badge")),l=new B,d=l.add(new Rr(i)),c=l.add(new Fi(e));return{file:n,fileName:o,label:d,lineNumber:a,stackFrame:e,actionBar:c,templateDisposable:l}}renderElement(t,e,i){let n=t.element;i.stackFrame.classList.toggle("disabled",!n.source||!n.source.available||Sh(n)),i.stackFrame.classList.toggle("label",n.presentationHint==="label");let o=!!n.thread.session.capabilities.supportsRestartFrame&&n.presentationHint!=="label"&&n.presentationHint!=="subtle"&&n.canRestart;i.stackFrame.classList.toggle("has-actions",o);let s=n.source.inMemory?n.source.uri.path:this.labelService.getUriLabel(n.source.uri);if(n.source.raw.origin&&(s+=`
${n.source.raw.origin}`),i.templateDisposable.add(this.hoverService.setupManagedHover(gt("mouse"),i.file,s)),i.label.set(n.name,qo(t.filterData),n.name),i.fileName.textContent=Ape(n),n.range.startLineNumber!==void 0?(i.lineNumber.textContent=`${n.range.startLineNumber}`,n.range.startColumn&&(i.lineNumber.textContent+=`:${n.range.startColumn}`),i.lineNumber.classList.remove("unavailable")):i.lineNumber.classList.add("unavailable"),i.actionBar.clear(),o){let a=new et("debug.callStack.restartFrame",u("restartFrame","Restart Frame"),de.asClassName(AL),!0,async()=>{try{await n.restart()}catch(l){this.notificationService.error(l)}});i.actionBar.push(a,{icon:!0,label:!1})}}renderCompressedElements(t,e,i,n){throw new Error("Method not implemented.")}disposeTemplate(t){t.actionBar.dispose()}};av=E([b(0,Nt),b(1,hi),b(2,mi)],av);var lv=class{constructor(t){this.hoverService=t}static ID="error";get templateId(){return lv.ID}renderTemplate(t){return{label:U(t,js(".error")),templateDisposable:new B}}renderElement(t,e,i){let n=t.element;i.label.textContent=n,i.templateDisposable.add(this.hoverService.setupManagedHover(gt("mouse"),i.label,n))}renderCompressedElements(t,e,i,n){throw new Error("Method not implemented.")}disposeTemplate(t){}};lv=E([b(0,Nt)],lv);var Ax=class r{static ID="loadMore";static LABEL=u("loadAllStackFrames","Load More Stack Frames");constructor(){}get templateId(){return r.ID}renderTemplate(t){let e=U(t,js(".load-all"));return e.style.color=Se(wI),{label:e}}renderElement(t,e,i){i.label.textContent=r.LABEL}renderCompressedElements(t,e,i,n){throw new Error("Method not implemented.")}disposeTemplate(t){}},RU=class r{static ID="showMore";constructor(){}get templateId(){return r.ID}renderTemplate(t){let e=U(t,js(".show-more"));return e.style.color=Se(wI),{label:e}}renderElement(t,e,i){let n=t.element;n.every(o=>!!(o.source&&o.source.origin&&o.source.origin===n[0].source.origin))?i.label.textContent=u("showMoreAndOrigin","Show {0} More: {1}",n.length,n[0].source.origin):i.label.textContent=u("showMoreStackFrames","Show {0} More Stack Frames",n.length)}renderCompressedElements(t,e,i,n){throw new Error("Method not implemented.")}disposeTemplate(t){}},mX=class{getHeight(t){return t instanceof Ma&&t.presentationHint==="label"||t instanceof vb||t instanceof Array?16:22}getTemplateId(t){return ju(t)?rv.ID:t instanceof Hd?sv.ID:t instanceof Ma?av.ID:typeof t=="string"?lv.ID:t instanceof vb?Ax.ID:RU.ID}};function gX(r){return r.text??PU(r)}function PU(r){return r.description||(r.reason?u({key:"pausedOn",comment:["indicates reason for program being paused"]},"Paused on {0}",r.reason):u("paused","Paused"))}function Rpe(r){return typeof r.getSessions=="function"}function ju(r){return r&&typeof r.getAllThreads=="function"}var fX=class{constructor(t){this.debugService=t}deemphasizedStackFramesToShow=[];hasChildren(t){if(ju(t)){let e=t.getAllThreads();return e.length>1||e.length===1&&e[0].stopped||!!this.debugService.getModel().getSessions().find(i=>i.parentSession===t)}return Rpe(t)||t instanceof Hd&&t.stopped}async getChildren(t){if(Rpe(t)){let e=t.getSessions();if(e.length===0)return Promise.resolve([]);if(e.length>1||this.debugService.getViewModel().isMultiSessionView())return Promise.resolve(e.filter(n=>!n.parentSession));let i=e[0].getAllThreads();return i.length===1?this.getThreadChildren(i[0]):Promise.resolve(i)}else if(ju(t)){let e=this.debugService.getModel().getSessions().filter(n=>n.parentSession===t),i=t.getAllThreads();return i.length===1?(await this.getThreadChildren(i[0])).concat(e):Promise.resolve(i.concat(e))}else return this.getThreadChildren(t)}getThreadChildren(t){return this.getThreadCallstack(t).then(e=>{let i=[];return e.forEach((n,o)=>{if(n instanceof Ma&&n.source&&Sh(n)&&this.deemphasizedStackFramesToShow.indexOf(n)===-1){if(i.length){let a=i[i.length-1];if(a instanceof Array){a.push(n);return}}let s=o<e.length-1?e[o+1]:void 0;if(s instanceof Ma&&s.source&&Sh(s)){i.push([n]);return}}i.push(n)}),i})}async getThreadCallstack(t){let e=t.getCallStack();return(!e||!e.length)&&(await t.fetchCallStack(),e=t.getCallStack()),e.length===1&&t.session.capabilities.supportsDelayedStackTraceLoading&&t.stoppedDetails&&t.stoppedDetails.totalFrames&&t.stoppedDetails.totalFrames>1&&(e=e.concat(t.getStaleCallStack().slice(1))),t.stoppedDetails&&t.stoppedDetails.framesErrorMessage&&(e=e.concat([t.stoppedDetails.framesErrorMessage])),!t.reachedEndOfCallStack&&t.stoppedDetails&&(e=e.concat([new vb(t.session.getId(),t.threadId)])),e}},bX=class{getWidgetAriaLabel(){return u({comment:["Debug is a noun in this context, not a verb."],key:"callStackAriaLabel"},"Debug Call Stack")}getWidgetRole(){return"treegrid"}getRole(t){return"row"}getAriaLabel(t){if(t instanceof Hd)return u({key:"threadAriaLabel",comment:['Placeholders stand for the thread name and the thread state.For example "Thread 1" and "Stopped']},"Thread {0} {1}",t.name,t.stateLabel);if(t instanceof Ma)return u("stackFrameAriaLabel","Stack Frame {0}, line {1}, {2}",t.name,t.range.startLineNumber,Ape(t));if(ju(t)){let e=t.getAllThreads().find(n=>n.stopped),i=e?e.stateLabel:u({key:"running",comment:["indicates state"]},"Running");return u({key:"sessionLabel",comment:['Placeholders stand for the session name and the session state. For example "Launch Program" and "Running"']},"Session {0} {1}",t.getLabel(),i)}return typeof t=="string"?t:t instanceof Array?u("showMoreStackFrames","Show {0} More Stack Frames",t.length):Ax.LABEL}},vX=class{constructor(t){this.debugService=t}isIncompressible(t){return ju(t)?!(t.compact||this.debugService.getModel().getSessions().some(i=>i.parentSession===t&&i.compact)):!0}};he(class extends tr{constructor(){super({id:"callStack.collapse",viewId:ag,title:u("collapse","Collapse All"),f1:!1,icon:N.collapseAll,precondition:Gt.isEqualTo(Ql(2)),menu:{id:V.ViewTitle,order:10,group:"navigation",when:P.equals("view",ag)}})}runInView(t,e){e.collapseAll()}});function dv(r,t,e,i,n,o){Ue.appendMenuItem(V.DebugCallStackContext,{group:"inline",order:n,when:i,command:{id:r,title:t,icon:e,precondition:o}})}var cP=P.or(Ho.isEqualTo("thread"),P.and(Ho.isEqualTo("session"),hq));dv(vg,Jb,sy,P.and(cP,Sb.toNegated()),10,Th.toNegated());dv(Fh,ev,ay,P.and(cP,Sb),10);dv(Ah,Yb,ry,cP,20,Sb);dv(Oh,Qb,mb,cP,30,Sb);dv(Nh,Zb,gb,cP,40,Sb);dv(Mh,Xb,oy,Ho.isEqualTo("session"),50);dv(Va,Vh,rg,P.and(cV.toNegated(),Ho.isEqualTo("session")),60);dv(td,Ig,Dc,P.and(cV,Ho.isEqualTo("session")),60);var MU=class r{static matchQuery=_l;_parsedQueries=[];set filterQuery(t){if(this._parsedQueries=[],t=t.trim(),t&&t!==""){let e=OO(t,",").map(i=>i.trim()).filter(i=>!!i.length);for(let i of e)i.startsWith("\\")?this._parsedQueries.push({type:"include",query:i.slice(1)}):i.startsWith("!")?this._parsedQueries.push({type:"exclude",query:i.slice(1)}):this._parsedQueries.push({type:"include",query:i})}}filter(t,e){if(t instanceof tv||t instanceof jd||t instanceof Li)return 1;let i=!1,n=!1,o=t.toString(!0);for(let{type:s,query:a}of this._parsedQueries){if(s==="exclude"&&r.matchQuery(a,o))return!1;s==="include"&&(i=!0,r.matchQuery(a,o)&&(n=!0))}return i?n:typeof e<"u"?e:1}};var SX=[],H0n=T("terminal.background",null,u("terminal.background","The background color of the terminal, this allows coloring the terminal differently to the panel.")),U0n=T("terminal.foreground",{light:"#333333",dark:"#CCCCCC",hcDark:"#FFFFFF",hcLight:"#292929"},u("terminal.foreground","The foreground color of the terminal.")),z0n=T("terminalCursor.foreground",null,u("terminalCursor.foreground","The foreground color of the terminal cursor.")),K0n=T("terminalCursor.background",null,u("terminalCursor.background","The background color of the terminal cursor. Allows customizing the color of a character overlapped by a block cursor.")),AU=T("terminal.selectionBackground",Mm,u("terminal.selectionBackground","The selection background color of the terminal.")),G0n=T("terminal.inactiveSelectionBackground",{light:Ne(AU,.5),dark:Ne(AU,.5),hcDark:Ne(AU,.7),hcLight:Ne(AU,.5)},u("terminal.inactiveSelectionBackground","The selection background color of the terminal when it does not have focus.")),q0n=T("terminal.selectionForeground",{light:null,dark:null,hcDark:"#000000",hcLight:"#ffffff"},u("terminal.selectionForeground","The selection foreground color of the terminal. When this is null the selection foreground will be retained and have the minimum contrast ratio feature applied.")),$0n=T("terminalCommandDecoration.defaultBackground",{light:"#00000040",dark:"#ffffff40",hcDark:"#ffffff80",hcLight:"#00000040"},u("terminalCommandDecoration.defaultBackground","The default terminal command decoration background color.")),j0n=T("terminalCommandDecoration.successBackground",{dark:"#1B81A8",light:"#2090D3",hcDark:"#1B81A8",hcLight:"#007100"},u("terminalCommandDecoration.successBackground","The terminal command decoration background color for successful commands.")),X0n=T("terminalCommandDecoration.errorBackground",{dark:"#F14C4C",light:"#E51400",hcDark:"#F14C4C",hcLight:"#B5200D"},u("terminalCommandDecoration.errorBackground","The terminal command decoration background color for error commands.")),Y0n=T("terminalOverviewRuler.cursorForeground","#A0A0A0CC",u("terminalOverviewRuler.cursorForeground","The overview ruler cursor color.")),Q0n=T("terminal.border",E9,u("terminal.border","The color of the border that separates split panes within the terminal. This defaults to panel.border.")),Z0n=T("terminalOverviewRuler.border",mN,u("terminalOverviewRuler.border","The overview ruler left-side border color.")),J0n=T("terminal.findMatchBackground",{dark:m8,light:m8,hcDark:null,hcLight:"#0F4A85"},u("terminal.findMatchBackground","Color of the current search match in the terminal. The color must not be opaque so as not to hide underlying terminal content."),!0),eNn=T("terminal.hoverHighlightBackground",Ne(bne,.5),u("terminal.findMatchHighlightBorder","Border color of the other search matches in the terminal.")),tNn=T("terminal.findMatchBorder",{dark:null,light:null,hcDark:"#f38518",hcLight:"#0F4A85"},u("terminal.findMatchBorder","Border color of the current search match in the terminal.")),iNn=T("terminal.findMatchHighlightBackground",{dark:Ol,light:Ol,hcDark:null,hcLight:null},u("terminal.findMatchHighlightBackground","Color of the other search matches in the terminal. The color must not be opaque so as not to hide underlying terminal content."),!0),nNn=T("terminal.findMatchHighlightBorder",{dark:null,light:null,hcDark:"#f38518",hcLight:"#0F4A85"},u("terminal.findMatchHighlightBorder","Border color of the other search matches in the terminal.")),oNn=T("terminalOverviewRuler.findMatchForeground",{dark:v8,light:v8,hcDark:"#f38518",hcLight:"#0F4A85"},u("terminalOverviewRuler.findMatchHighlightForeground","Overview ruler marker color for find matches in the terminal.")),rNn=T("terminal.dropBackground",jw,u("terminal.dragAndDropBackground","Background color when dragging on top of terminals. The color should have transparency so that the terminal contents can still shine through."),!0),sNn=T("terminal.tab.activeBorder",Gw,u("terminal.tab.activeBorder","Border on the side of the terminal tab in the panel. This defaults to tab.activeBorder.")),aNn=T("terminal.initialHintForeground",{dark:"#ffffff56",light:"#0007",hcDark:null,hcLight:null},u("terminalInitialHintForeground","Foreground color of the terminal initial hint."));function CX(r,t,e,i){let n=document.createElement("span"),o=r.length,s=[],a,l,d,c=!1,p=0,h="";for(;p<o;){let w=!1;if(r.charCodeAt(p)===27&&r.charAt(p+1)==="["){let C=p;p+=2;let S="";for(;p<o;){let D=r.charAt(p);if(S+=D,p++,D.match(/^[ABCDHIJKfhmpsu]$/)){w=!0;break}}if(w){if(Fpe(n,h,s,t,i,a,l,d),h="",S.match(/^(?:[34][0-8]|9[0-7]|10[0-7]|[0-9]|2[1-5,7-9]|[34]9|5[8,9]|1[0-9])(?:;[349][0-7]|10[0-7]|[013]|[245]|[34]9)?(?:;[012]?[0-9]?[0-9])*;?m$/)){let D=S.slice(0,-1).split(";").filter(k=>k!=="").map(k=>parseInt(k,10));if(D[0]===38||D[0]===48||D[0]===58){let k=D[0]===38?"foreground":D[0]===48?"background":"underline";D[1]===5?I(D,k):D[1]===2&&v(D,k)}else g(D)}}else p=C}w===!1&&(h+=r.charAt(p),p++)}return h&&Fpe(n,h,s,t,i,a,l,d),n;function m(w,C){w==="foreground"?a=C:w==="background"?l=C:w==="underline"&&(d=C),s=s.filter(S=>S!==`code-${w}-colored`),C!==void 0&&s.push(`code-${w}-colored`)}function f(){let w=a;m("foreground",l),m("background",w)}function g(w){for(let C of w)switch(C){case 0:{s=[],a=void 0,l=void 0;break}case 1:{s=s.filter(S=>S!=="code-bold"),s.push("code-bold");break}case 2:{s=s.filter(S=>S!=="code-dim"),s.push("code-dim");break}case 3:{s=s.filter(S=>S!=="code-italic"),s.push("code-italic");break}case 4:{s=s.filter(S=>S!=="code-underline"&&S!=="code-double-underline"),s.push("code-underline");break}case 5:{s=s.filter(S=>S!=="code-blink"),s.push("code-blink");break}case 6:{s=s.filter(S=>S!=="code-rapid-blink"),s.push("code-rapid-blink");break}case 7:{c||(c=!0,f());break}case 8:{s=s.filter(S=>S!=="code-hidden"),s.push("code-hidden");break}case 9:{s=s.filter(S=>S!=="code-strike-through"),s.push("code-strike-through");break}case 10:{s=s.filter(S=>!S.startsWith("code-font"));break}case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:case 19:case 20:{s=s.filter(S=>!S.startsWith("code-font")),s.push(`code-font-${C-10}`);break}case 21:{s=s.filter(S=>S!=="code-underline"&&S!=="code-double-underline"),s.push("code-double-underline");break}case 22:{s=s.filter(S=>S!=="code-bold"&&S!=="code-dim");break}case 23:{s=s.filter(S=>S!=="code-italic"&&S!=="code-font-10");break}case 24:{s=s.filter(S=>S!=="code-underline"&&S!=="code-double-underline");break}case 25:{s=s.filter(S=>S!=="code-blink"&&S!=="code-rapid-blink");break}case 27:{c&&(c=!1,f());break}case 28:{s=s.filter(S=>S!=="code-hidden");break}case 29:{s=s.filter(S=>S!=="code-strike-through");break}case 53:{s=s.filter(S=>S!=="code-overline"),s.push("code-overline");break}case 55:{s=s.filter(S=>S!=="code-overline");break}case 39:{m("foreground",void 0);break}case 49:{m("background",void 0);break}case 59:{m("underline",void 0);break}case 73:{s=s.filter(S=>S!=="code-superscript"&&S!=="code-subscript"),s.push("code-superscript");break}case 74:{s=s.filter(S=>S!=="code-superscript"&&S!=="code-subscript"),s.push("code-subscript");break}case 75:{s=s.filter(S=>S!=="code-superscript"&&S!=="code-subscript");break}default:{y(C);break}}}function v(w,C){if(w.length>=5&&w[2]>=0&&w[2]<=255&&w[3]>=0&&w[3]<=255&&w[4]>=0&&w[4]<=255){let S=new xt(w[2],w[3],w[4]);m(C,S)}}function I(w,C){let S=w[2],D=JTe(S);if(D)m(C,D);else if(S>=0&&S<=15){if(C==="underline"){let k=e.getColorTheme(),M=SX[S],O=k.getColor(M);O&&m(C,O.rgba);return}S+=30,S>=38&&(S+=52),C==="background"&&(S+=10),y(S)}}function y(w){let C=e.getColorTheme(),S,D;if(w>=30&&w<=37?(D=w-30,S="foreground"):w>=90&&w<=97?(D=w-90+8,S="foreground"):w>=40&&w<=47?(D=w-40,S="background"):w>=100&&w<=107&&(D=w-100+8,S="background"),D!==void 0&&S){let k=SX[D],M=C.getColor(k);M&&m(S,M.rgba)}}}function Fpe(r,t,e,i,n,o,s,a){if(!r||!t)return;let l=i.linkify(t,!0,n);l.className=e.join(" "),o&&(l.style.color=j.Format.CSS.formatRGB(new j(o))),s&&(l.style.backgroundColor=j.Format.CSS.formatRGB(new j(s))),a&&(l.style.textDecorationColor=j.Format.CSS.formatRGB(new j(a))),r.appendChild(l)}function JTe(r){if(r%1===0)if(r>=16&&r<=231){r-=16;let t=r%6;r=(r-t)/6;let e=r%6;r=(r-e)/6;let i=r,n=255/5;return t=Math.round(t*n),e=Math.round(e*n),i=Math.round(i*n),new xt(i,e,t)}else if(r>=232&&r<=255){r-=232;let t=Math.round(r/23*255);return new xt(t,t,t)}else return}var Yd=J,uP=class r{static ID="replEvaluationInput";get templateId(){return r.ID}renderTemplate(t){U(t,Yd("span.arrow"+de.asCSSSelector(zde)));let e=U(t,Yd(".expression"));return{label:new Rr(e)}}renderElement(t,e,i){let n=t.element;i.label.set(n.value,qo(t.filterData))}disposeTemplate(t){t.label.dispose()}},Cg=class{constructor(t,e,i){this.linkDetector=t;this.themeService=e;this.instaService=i}static ID="replGroup";get templateId(){return Cg.ID}renderTemplate(t){t.classList.add("group");let e=U(t,Yd(".output.expression.value-and-source")),i=U(e,Yd("span.label")),n=this.instaService.createInstance(Ox,e);return{label:i,source:n}}renderElement(t,e,i){let n=t.element;ai(i.label);let o=CX(n.name,this.linkDetector,this.themeService,void 0);i.label.appendChild(o),i.source.setSource(n.sourceData)}disposeTemplate(t){t.source.dispose()}};Cg=E([b(1,Fe),b(2,ne)],Cg);var pP=class r{constructor(t,e){this.linkDetector=t;this.hoverService=e}static ID="replEvaluationResult";get templateId(){return r.ID}renderTemplate(t){let e=U(t,Yd(".evaluation-result.expression"));return{value:U(e,Yd("span.value")),elementStore:new B}}renderElement(t,e,i){i.elementStore.clear();let n=t.element;Xd(i.elementStore,n,i.value,{colorize:!0,hover:!1,linkDetector:this.linkDetector},this.hoverService)}disposeTemplate(t){t.elementStore.dispose()}},wg=class{constructor(t,e,i){this.linkDetector=t;this.themeService=e;this.instaService=i}static ID="outputReplElement";get templateId(){return wg.ID}renderTemplate(t){let e=Object.create(null);t.classList.add("output");let i=U(t,Yd(".output.expression.value-and-source"));return e.container=t,e.countContainer=U(i,Yd(".count-badge-wrapper")),e.count=new Aw(e.countContainer,{},cF),e.value=U(i,Yd("span.value.label")),e.source=this.instaService.createInstance(Ox,i),e}renderElement({element:t},e,i){this.setElementCount(t,i),i.elementListener=t.onDidChangeCount(()=>this.setElementCount(t,i)),ai(i.value),i.value.className="value";let n=t.expression?.valueLocationReference,o=n!==void 0?this.linkDetector.makeReferencedLinkDetector(n,t.session):this.linkDetector;i.value.appendChild(CX(t.value,o,this.themeService,t.session.root)),i.value.classList.add(t.severity===Si.Warning?"warn":t.severity===Si.Error?"error":t.severity===Si.Ignore?"ignore":"info"),i.source.setSource(t.sourceData),i.getReplElementSource=()=>t.sourceData}setElementCount(t,e){t.count>=2?(e.count.setCount(t.count),e.countContainer.hidden=!1):e.countContainer.hidden=!0}disposeTemplate(t){t.source.dispose()}disposeElement(t,e,i){i.elementListener.dispose()}};wg=E([b(1,Fe),b(2,ne)],wg);var Eg=class extends qu{constructor(e,i,n,o,s){super(i,n,s);this.linkDetector=e;this.commandService=o}static ID="replVariable";get templateId(){return Eg.ID}renderElement(e,i,n){let o=e.element;n.elementDisposable.clear(),super.renderExpressionElement(o instanceof Ky?o.expression:o,e,n)}renderExpression(e,i,n){let o=e instanceof Ky;o||!e.name?(i.label.set(""),Xd(i.elementDisposable,o?e.expression:e,i.value,{colorize:!0,linkDetector:this.linkDetector,hover:!1},this.hoverService),i.expression.classList.remove("nested-variable")):(_U(i.elementDisposable,this.commandService,this.hoverService,e,i,!0,n,this.linkDetector),i.expression.classList.toggle("nested-variable",wX(e)))}getInputBoxOptions(e){}};Eg=E([b(1,we),b(2,so),b(3,ct),b(4,Nt)],Eg);var hP=class r{constructor(t,e){this.linkDetector=t;this.hoverService=e}static ID="rawObject";get templateId(){return r.ID}renderTemplate(t){t.classList.add("output");let e=U(t,Yd(".output.expression")),i=U(e,Yd("span.name")),n=new Rr(i),o=U(e,Yd("span.value"));return{container:t,expression:e,name:i,label:n,value:o,elementStore:new B}}renderElement(t,e,i){i.elementStore.clear();let n=t.element;i.label.set(n.name?`${n.name}:`:"",qo(t.filterData)),n.name?i.name.textContent=`${n.name}:`:i.name.textContent="",Xd(i.elementStore,n.value,i.value,{linkDetector:this.linkDetector,hover:!1},this.hoverService)}disposeTemplate(t){t.elementStore.dispose(),t.label.dispose()}};function wX(r){return r instanceof Li&&(r.parent instanceof jd||r.parent instanceof Li)}var OU=class extends T1{constructor(e,i){super();this.configurationService=e;this.replOptions=i}getHeight(e){return this.configurationService.getValue("debug").console.wordWrap?super.getHeight(e):this.estimateHeight(e,!0)}estimateHeight(e,i=!1){let n=this.replOptions.replConfiguration.lineHeight,o=a=>a.match(/\n/g)?.length??0;if((a=>typeof a.value=="string")(e)&&!wX(e)){let a=e.value,l=o(a)+(i?0:Math.floor(a.length/70))+(e instanceof Gu?0:1);return Math.max(l,1)*n}return n}getTemplateId(e){return e instanceof Li||e instanceof Ky?Eg.ID:e instanceof jd?pP.ID:e instanceof tv?uP.ID:e instanceof Gu?wg.ID:e instanceof Wh?Cg.ID:hP.ID}hasDynamicHeight(e){return wX(e)?!1:e.toString().length>0}};function Bpe(r){return typeof r.getReplElements=="function"}var NU=class{hasChildren(t){return Bpe(t)?!0:!!t.hasChildren}getChildren(t){return Bpe(t)?Promise.resolve(t.getReplElements()):Promise.resolve(t.getChildren())}},FU=class{getWidgetAriaLabel(){return u("debugConsole","Debug Console")}getAriaLabel(t){return t instanceof Li?u("replVariableAriaLabel","Variable {0}, value {1}",t.name,t.value):t instanceof Gu||t instanceof tv||t instanceof jd?t.value+(t instanceof Gu&&t.count>1?u({key:"occurred",comment:["Front will the value of the debug console element. Placeholder will be replaced by a number which represents occurrance count."]},", occurred {0} times",t.count):""):t instanceof xU?u("replRawObjectAriaLabel","Debug console variable {0}, value {1}",t.name,t.value):t instanceof Wh?u("replGroup","Debug console group {0}",t.name):""}},Ox=class extends R{constructor(e,i,n,o){super();this.hoverService=n;this.labelService=o;this.el=U(e,Yd(".source")),this._register(F(this.el,"click",s=>{s.preventDefault(),s.stopPropagation(),this.source&&this.source.source.openInEditor(i,{startLineNumber:this.source.lineNumber,startColumn:this.source.column,endLineNumber:this.source.lineNumber,endColumn:this.source.column})}))}el;source;hover;setSource(e){this.source=e,this.el.textContent=e?`${Eo(e.source.name)}:${e.lineNumber}`:"",this.hover??=this._register(this.hoverService.setupManagedHover(gt("mouse"),this.el,"")),this.hover.update(e?`${this.labelService.getUriLabel(e.source.uri)}:${e.lineNumber}`:"")}};Ox=E([b(1,$e),b(2,Nt),b(3,hi)],Ox);function e_e(r,t,e){let i=new Set;return In(...r.map((n,o)=>In(n.onDidFocus(()=>{e?.(o,"focus"),i.size||t(!0),i.add(o)}),n.onDidBlur(()=>{e?.(o,"blur"),i.delete(o),i.size||t(!1)}))))}var EX=new A("navigableContainerFocused",!1),Nc=class{constructor(t,e,i){this.logService=e;this.configurationService=i;this.focused=EX.bindTo(t),Nc.INSTANCE=this}static ID="workbench.contrib.navigableContainerManager";static INSTANCE;containers=new Set;lastContainer;focused;dispose(){this.containers.clear(),this.focused.reset(),Nc.INSTANCE=void 0}get debugEnabled(){return this.configurationService.getValue("workbench.navigibleContainer.enableDebug")}log(t,...e){this.debugEnabled&&this.logService.debug(t,...e)}static register(t){let e=this.INSTANCE;return e?(e.containers.add(t),e.log("NavigableContainerManager.register",t.name),In(e_e(t.focusNotifiers,i=>{i?(e.log("NavigableContainerManager.focus",t.name),e.focused.set(!0),e.lastContainer=t):(e.log("NavigableContainerManager.blur",t.name,e.lastContainer?.name),e.lastContainer===t&&(e.focused.set(!1),e.lastContainer=void 0))},(i,n)=>{e.log("NavigableContainerManager.partFocusChange",t.name,i,n)}),le(()=>{e.containers.delete(t),e.log("NavigableContainerManager.unregister",t.name,e.lastContainer?.name),e.lastContainer===t&&(e.focused.set(!1),e.lastContainer=void 0)}))):R.None}static getActive(){return this.INSTANCE?.lastContainer}};Nc=E([b(0,re),b(1,bt),b(2,se)],Nc);function Vpe(r){return Nc.register(r)}Yk(Nc.ID,Nc,Ec.BlockStartup);wt.registerCommandAndKeybindingRule({id:"widgetNavigation.focusPrevious",weight:200,when:P.and(EX,P.or(Ih?.negate(),vde)),primary:2064,handler:()=>{Nc.getActive()?.focusPreviousWidget()}});wt.registerCommandAndKeybindingRule({id:"widgetNavigation.focusNext",weight:200,when:P.and(EX,P.or(Ih?.negate(),Ide)),primary:2066,handler:()=>{Nc.getActive()?.focusNextWidget()}});var BU=J,xX="debug.repl.history",TX="debug.repl.filterHistory",_X="debug.repl.filterValue",Wpe="replinputdecoration";function Nx(r){r.scrollTop=r.scrollHeight-r.renderHeight}var Fx=new Set,Hpe={getId:r=>r.getId()},Xu=class extends Xw{constructor(e,i,n,o,s,a,l,d,c,p,h,m,f,g,v,I,y,w,C,S){let D=o.get(_X,1,"");super({...e,filterOptions:{placeholder:u({key:"workbench.debug.filter.placeholder",comment:["Text in the brackets after e.g. is not localizable"]},"Filter (e.g. text, !exclude, \\escape)"),text:D,history:JSON.parse(o.get(TX,1,"[]"))}},g,p,h,l,c,n,v,s,I,y);this.debugService=i;this.storageService=o;this.modelService=a;this.configurationService=h;this.textResourcePropertiesService=m;this.editorService=f;this.keybindingService=g;this.languageFeaturesService=C;this.logService=S;this.menu=w.createMenu(V.DebugConsoleContext,l),this._register(this.menu),this.history=new kw(JSON.parse(this.storageService.get(xX,1,"[]")),100),this.filter=new MU,this.filter.filterQuery=D,this.multiSessionRepl=fq.bindTo(l),this.replOptions=this._register(this.instantiationService.createInstance(xg,this.id,()=>this.getLocationBasedColors().background)),this._register(this.replOptions.onDidChange(()=>this.onDidStyleChange())),d.registerDecorationType("repl-decoration",Wpe,{}),this.multiSessionRepl.set(this.isMultiSessionView),this.registerListeners()}static REFRESH_DELAY=50;static URI=Z.parse(`${Gs}:replinput`);history;tree;replOptions;previousTreeScrollHeight=0;replDelegate;container;treeContainer;replInput;replInputContainer;bodyContentDimension;replInputLineCount=1;model;setHistoryNavigationEnablement;scopedInstantiationService;replElementsChangeListener;styleElement;styleChangedWhenInvisible=!1;completionItemProvider;modelChangeListener=R.None;filter;multiSessionRepl;menu;replDataSource;findIsOpen=!1;registerListeners(){this.debugService.getViewModel().focusedSession&&this.onDidFocusSession(this.debugService.getViewModel().focusedSession),this._register(this.debugService.getViewModel().onDidFocusSession(async e=>this.onDidFocusSession(e))),this._register(this.debugService.getViewModel().onDidEvaluateLazyExpression(async e=>{e instanceof Li&&this.tree?.hasNode(e)&&(await this.tree.updateChildren(e,!1,!0),await this.tree.expand(e))})),this._register(this.debugService.onWillNewSession(async e=>{let i=this.tree?.getInput();(!i||i.state===0)&&await this.selectSession(e),this.multiSessionRepl.set(this.isMultiSessionView)})),this._register(this.debugService.onDidEndSession(async()=>{await Promise.resolve(),this.multiSessionRepl.set(this.isMultiSessionView)})),this._register(this.themeService.onDidColorThemeChange(()=>{this.refreshReplElements(!1),this.isVisible()&&this.updateInputDecoration()})),this._register(this.onDidChangeBodyVisibility(e=>{e&&(this.model||(this.model=this.modelService.getModel(Xu.URI)||this.modelService.createModel("",null,Xu.URI,!0)),this.setMode(),this.replInput.setModel(this.model),this.updateInputDecoration(),this.refreshReplElements(!0),this.styleChangedWhenInvisible&&(this.styleChangedWhenInvisible=!1,this.onDidStyleChange()))})),this._register(this.configurationService.onDidChangeConfiguration(e=>{if(e.affectsConfiguration("debug.console.wordWrap")&&this.tree&&(this.tree.dispose(),this.treeContainer.innerText="",ai(this.treeContainer),this.createReplTree()),e.affectsConfiguration("debug.console.acceptSuggestionOnEnter")){let i=this.configurationService.getValue("debug");this.replInput.updateOptions({acceptSuggestionOnEnter:i.console.acceptSuggestionOnEnter==="on"?"on":"off"})}})),this._register(this.editorService.onDidActiveEditorChange(()=>{this.setMode()})),this._register(this.filterWidget.onDidChangeFilterText(()=>{this.filter.filterQuery=this.filterWidget.getFilterText(),this.tree&&(this.tree.refilter(),Nx(this.tree))}))}async onDidFocusSession(e){e&&(Fx.delete(e),this.completionItemProvider?.dispose(),e.capabilities.supportsCompletionsRequest&&(this.completionItemProvider=this.languageFeaturesService.completionProvider.register({scheme:Gs,pattern:"**/replinput",hasAccessToAllModels:!0},{_debugDisplayName:"debugConsole",triggerCharacters:e.capabilities.completionTriggerCharacters||["."],provideCompletionItems:async(i,n,o,s)=>{this.setHistoryNavigationEnablement(!1);let a=this.replInput.getModel();if(a){let l=a.getWordAtPosition(n),d=l?l.word.length:0,c=a.getValue(),p=this.debugService.getViewModel().focusedStackFrame,h=p?p.frameId:void 0,m=await e.completions(h,p?.thread.threadId||0,c,n,d,s),f=[],g=v=>L.fromPositions(n.delta(0,-v),n);if(m&&m.body&&m.body.targets&&m.body.targets.forEach(v=>{if(v&&v.label){let I,y=v.text||v.label;if(typeof v.selectionStart=="number"){I=4;let w=typeof v.selectionLength=="number"?v.selectionLength:0,C=w>0?"${1:"+y.substring(v.selectionStart,v.selectionStart+w)+"}$0":"$0";y=y.substring(0,v.selectionStart)+C+y.substring(v.selectionStart+w)}f.push({label:v.label,insertText:y,detail:v.detail,kind:xf.fromString(v.type||"property"),filterText:v.start&&v.length?c.substring(v.start,v.start+v.length).concat(v.label):void 0,range:g(v.length||d),sortText:v.sortText,insertTextRules:I})}}),this.configurationService.getValue("debug").console.historySuggestions){let v=this.history.getHistory(),I=String(v.length).length;v.forEach((y,w)=>f.push({label:y,insertText:y,kind:18,range:g(y.length),sortText:"ZZZ"+String(v.length-w).padStart(I,"0")}))}return{suggestions:f}}return Promise.resolve({suggestions:[]})}}))),await this.selectSession()}getFilterStats(){return{total:this.tree?.getNode().children.length??0,filtered:this.tree?.getNode().children.filter(e=>e.visible).length??0}}get isReadonly(){let e=this.tree?.getInput();return!(e&&e.state!==0)}showPreviousValue(){this.isReadonly||this.navigateHistory(!0)}showNextValue(){this.isReadonly||this.navigateHistory(!1)}focusFilter(){this.filterWidget.focus()}openFind(){this.tree?.openFind()}setMode(){if(!this.isVisible())return;let e=this.editorService.activeTextEditorControl;no(e)&&(this.modelChangeListener.dispose(),this.modelChangeListener=e.onDidChangeModelLanguage(()=>this.setMode()),this.model&&e.hasModel()&&this.model.setLanguage(e.getModel().getLanguageId()))}onDidStyleChange(){if(!this.isVisible()){this.styleChangedWhenInvisible=!0;return}if(this.styleElement){this.replInput.updateOptions({fontSize:this.replOptions.replConfiguration.fontSize,lineHeight:this.replOptions.replConfiguration.lineHeight,fontFamily:this.replOptions.replConfiguration.fontFamily==="default"?vs.fontFamily:this.replOptions.replConfiguration.fontFamily});let e=this.replInput.getOption(68);this.styleElement.textContent=`
				.repl .repl-input-wrapper .repl-input-chevron {
					line-height: ${e}px
				}

				.repl .repl-input-wrapper .monaco-editor .lines-content {
					background-color: ${this.replOptions.replConfiguration.backgroundColor};
				}
			`;let i=this.replOptions.replConfiguration.fontFamily==="default"?"var(--monaco-monospace-font)":this.replOptions.replConfiguration.fontFamily;this.container.style.setProperty("--vscode-repl-font-family",i),this.container.style.setProperty("--vscode-repl-font-size",`${this.replOptions.replConfiguration.fontSize}px`),this.container.style.setProperty("--vscode-repl-font-size-for-twistie",`${this.replOptions.replConfiguration.fontSizeForTwistie}px`),this.container.style.setProperty("--vscode-repl-line-height",this.replOptions.replConfiguration.cssLineHeight),this.tree?.rerender(),this.bodyContentDimension&&this.layoutBodyContent(this.bodyContentDimension.height,this.bodyContentDimension.width)}}navigateHistory(e){let i=(e?this.history.previous()??this.history.first():this.history.next())??"";this.replInput.setValue(i),La(i),this.replInput.setPosition({lineNumber:1,column:i.length+1}),this.setHistoryNavigationEnablement(!0)}async selectSession(e){let i=this.tree?.getInput();if(!e){let n=this.debugService.getViewModel().focusedSession;n?e=n:(!i||Fx.has(i))&&(e=this.debugService.getModel().getSessions(!0).find(o=>!Fx.has(o)))}if(e&&(this.replElementsChangeListener?.dispose(),this.replElementsChangeListener=e.onDidChangeReplElements(()=>{this.refreshReplElements(e.getReplElements().length===0)}),this.tree&&i!==e)){try{await this.tree.setInput(e)}catch(n){this.logService.error(n)}Nx(this.tree)}this.replInput?.updateOptions({readOnly:this.isReadonly}),this.updateInputDecoration()}async clearRepl(){let e=this.tree?.getInput();e&&(e.removeReplExpressions(),e.state===0&&(Fx.add(e),await this.selectSession(),this.multiSessionRepl.set(this.isMultiSessionView))),this.replInput.focus()}acceptReplInput(){let e=this.tree?.getInput();if(e&&!this.isReadonly){e.addReplExpression(this.debugService.getViewModel().focusedStackFrame,this.replInput.getValue()),Nx(this.tree),this.history.add(this.replInput.getValue()),this.replInput.setValue("");let i=this.replInputLineCount>1;this.replInputLineCount=1,i&&this.bodyContentDimension&&this.layoutBodyContent(this.bodyContentDimension.height,this.bodyContentDimension.width)}}sendReplInput(e){let i=this.tree?.getInput();i&&!this.isReadonly&&(i.addReplExpression(this.debugService.getViewModel().focusedStackFrame,e),Nx(this.tree),this.history.add(e))}getVisibleContent(){let e="";if(this.model&&this.tree){let i=this.textResourcePropertiesService.getEOL(this.model.uri),n=o=>{o.children.forEach(s=>{s.visible&&(e+=s.element.toString().trimRight()+i,!s.collapsed&&s.children.length&&n(s))})};n(this.tree.getNode())}return gee(e)}layoutBodyContent(e,i){this.bodyContentDimension=new Ge(i,e);let n=Math.min(this.replInput.getContentHeight(),e);if(this.tree){let o=this.tree.scrollTop+this.tree.renderHeight>=this.tree.scrollHeight,s=e-n;this.tree.getHTMLElement().style.height=`${s}px`,this.tree.layout(s,i),o&&Nx(this.tree)}this.replInputContainer.style.height=`${n}px`,this.replInput.layout({width:i-30,height:n})}collapseAll(){this.tree?.collapseAll()}getDebugSession(){return this.tree?.getInput()}getReplInput(){return this.replInput}getReplDataSource(){return this.replDataSource}getFocusedElement(){return this.tree?.getFocus()?.[0]}focusTree(){this.tree?.domFocus()}focus(){super.focus(),setTimeout(()=>this.replInput.focus(),0)}getActionViewItem(e){if(e.id===Upe){let i=(this.tree?this.tree.getInput():void 0)??this.debugService.getViewModel().focusedSession;return this.instantiationService.createInstance(PX,e,i)}return super.getActionViewItem(e)}get isMultiSessionView(){return this.debugService.getModel().getSessions(!0).filter(e=>e.hasSeparateRepl()&&!Fx.has(e)).length>1}get refreshScheduler(){let e=new Set;return new Ye(async()=>{if(!this.tree||!this.tree.getInput())return;await this.tree.updateChildren(void 0,!0,!1,{diffIdentityProvider:Hpe});let i=this.tree.getInput();if(i){let s=async a=>{for(let l of a)l instanceof Wh&&(l.autoExpand&&!e.has(l.getId())&&(e.add(l.getId()),await this.tree.expand(l)),this.tree.isCollapsed(l)||await s(l.getChildren()))};await s(i.getReplElements())}let{total:n,filtered:o}=this.getFilterStats();this.filterWidget.updateBadge(n===o||n===0?void 0:u("showing filtered repl lines","Showing {0} of {1}",o,n))},Xu.REFRESH_DELAY)}render(){super.render(),this._register(Vpe({name:"repl",focusNotifiers:[this,this.filterWidget],focusNextWidget:()=>{let e=this.tree?.getHTMLElement();this.filterWidget.hasFocus()?this.tree?.domFocus():e&&fs(e)&&this.focus()},focusPreviousWidget:()=>{let e=this.tree?.getHTMLElement();this.replInput.hasTextFocus()?this.tree?.domFocus():e&&fs(e)&&this.focusFilter()}}))}renderBody(e){super.renderBody(e),this.container=U(e,BU(".repl")),this.treeContainer=U(this.container,BU(`.repl-tree.${Nu}`)),this.createReplInput(this.container),this.createReplTree()}createReplTree(){this.replDelegate=new OU(this.configurationService,this.replOptions);let e=this.configurationService.getValue("debug").console.wordWrap;this.treeContainer.classList.toggle("word-wrap",e);let i=this.instantiationService.createInstance(id);this.replDataSource=new NU;let n=this.tree=this.instantiationService.createInstance(is,"DebugRepl",this.treeContainer,this.replDelegate,[this.instantiationService.createInstance(Eg,i),this.instantiationService.createInstance(wg,i),new uP,this.instantiationService.createInstance(Cg,i),new pP(i,this.hoverService),new hP(i,this.hoverService)],this.replDataSource,{filter:this.filter,accessibilityProvider:new FU,identityProvider:Hpe,mouseSupport:!1,findWidgetEnabled:!0,keyboardNavigationLabelProvider:{getKeyboardNavigationLabel:s=>s.toString(!0)},horizontalScrolling:!e,setRowLineHeight:!1,supportDynamicHeights:e,overrideStyles:this.getLocationBasedColors().listOverrideStyles});this._register(n.onDidChangeContentHeight(()=>{n.scrollHeight!==this.previousTreeScrollHeight&&n.scrollTop+n.renderHeight>=this.previousTreeScrollHeight-2&&setTimeout(()=>{Nx(n)},0),this.previousTreeScrollHeight=n.scrollHeight})),this._register(n.onContextMenu(s=>this.onContextMenu(s))),this._register(n.onDidChangeFindOpenState(s=>this.findIsOpen=s));let o;this._register(n.onMouseClick(()=>{if(this.findIsOpen)return;let s=ue(this.treeContainer).getSelection();(!s||s.type!=="Range"||o===s.toString())&&this.replInput.focus(),o=s?s.toString():""})),this.selectSession(),this.styleElement=Go(this.container),this.onDidStyleChange()}createReplInput(e){this.replInputContainer=U(e,BU(".repl-input-wrapper")),U(this.replInputContainer,BU(".repl-input-chevron"+de.asCSSSelector(Kde)));let{historyNavigationBackwardsEnablement:i,historyNavigationForwardsEnablement:n}=this._register(uL(this.scopedContextKeyService,this));this.setHistoryNavigationEnablement=a=>{i.set(a),n.set(a)},Eh.bindTo(this.scopedContextKeyService).set(!0),this.scopedInstantiationService=this._register(this.instantiationService.createChild(new el([re,this.scopedContextKeyService])));let o=lU(this.configurationService);o.readOnly=!0,o.suggest={showStatusBar:!0};let s=this.configurationService.getValue("debug");o.acceptSuggestionOnEnter=s.console.acceptSuggestionOnEnter==="on"?"on":"off",o.ariaLabel=this.getAriaLabel(),this.replInput=this.scopedInstantiationService.createInstance($s,this.replInputContainer,o,dU()),this._register(this.replInput.onDidChangeModelContent(()=>{let a=this.replInput.getModel();this.setHistoryNavigationEnablement(!!a&&a.getValue()==="");let l=a?Math.min(10,a.getLineCount()):1;l!==this.replInputLineCount&&(this.replInputLineCount=l,this.bodyContentDimension&&this.layoutBodyContent(this.bodyContentDimension.height,this.bodyContentDimension.width))})),this._register(this.replInput.onDidFocusEditorText(()=>this.updateInputDecoration())),this._register(this.replInput.onDidBlurEditorText(()=>this.updateInputDecoration())),this._register(Ut(this.replInputContainer,Q.FOCUS,()=>this.replInputContainer.classList.add("synthetic-focus"))),this._register(Ut(this.replInputContainer,Q.BLUR,()=>this.replInputContainer.classList.remove("synthetic-focus")))}getAriaLabel(){let e=u("debugConsole","Debug Console");if(!this.configurationService.getValue("accessibility.verbosity.debug"))return e;let i=this.keybindingService.lookupKeybinding("editor.action.accessibilityHelp")?.getAriaLabel();return i?e=u("commentLabelWithKeybinding","{0}, use ({1}) for accessibility help",e,i):e=u("commentLabelWithKeybindingNoKeybinding","{0}, run the command Open Accessibility Help which is currently not triggerable via keybinding.",e),e}onContextMenu(e){let i=[];sa(this.menu,{arg:e.element,shouldForwardArgs:!1},i),this.contextMenuService.showContextMenu({getAnchor:()=>e.anchor,getActions:()=>i,getActionsContext:()=>e.element})}refreshReplElements(e){if(this.tree&&this.isVisible()){if(this.refreshScheduler.isScheduled())return;this.refreshScheduler.schedule(e?0:void 0)}}updateInputDecoration(){if(!this.replInput)return;let e=[];if(this.isReadonly&&this.replInput.hasTextFocus()&&!this.replInput.getValue()){let i=Td(Qo,this.themeService.getColorTheme())?.transparent(.4);e.push({range:{startLineNumber:0,endLineNumber:0,startColumn:0,endColumn:1},renderOptions:{after:{contentText:u("startDebugFirst","Please start a debug session to evaluate expressions"),color:i?i.toString():void 0}}})}this.replInput.setDecorationsByType("repl-decoration",Wpe,e)}saveState(){let e=this.history.getHistory();e.length?this.storageService.store(xX,JSON.stringify(e),1,1):this.storageService.remove(xX,1);let i=this.filterWidget.getHistory();i.length?this.storageService.store(TX,JSON.stringify(i),1,1):this.storageService.remove(TX,1);let n=this.filterWidget.getFilterText();n?this.storageService.store(_X,n,1,1):this.storageService.remove(_X,1),super.saveState()}dispose(){this.replInput?.dispose(),this.replElementsChangeListener?.dispose(),this.refreshScheduler.dispose(),this.modelChangeListener.dispose(),super.dispose()}};E([Re],Xu.prototype,"refreshScheduler",1),Xu=E([b(1,we),b(2,ne),b(3,nt),b(4,Fe),b(5,qi),b(6,re),b(7,En),b(8,$i),b(9,vt),b(10,se),b(11,GC),b(12,$e),b(13,Be),b(14,Yi),b(15,Tt),b(16,Nt),b(17,jt),b(18,ni),b(19,bt)],Xu);var xg=class extends R{constructor(e,i,n,o,s){super();this.backgroundColorDelegate=i;this.configurationService=n;this.themeService=o;this.viewDescriptorService=s;this._register(this.themeService.onDidColorThemeChange(a=>this.update())),this._register(this.viewDescriptorService.onDidChangeLocation(a=>{a.views.some(l=>l.id===e)&&this.update()})),this._register(this.configurationService.onDidChangeConfiguration(a=>{(a.affectsConfiguration("debug.console.lineHeight")||a.affectsConfiguration("debug.console.fontSize")||a.affectsConfiguration("debug.console.fontFamily"))&&this.update()})),this.update()}static lineHeightEm=1.4;_onDidChange=this._register(new x);onDidChange=this._onDidChange.event;_replConfig;get replConfiguration(){return this._replConfig}update(){let e=this.configurationService.getValue("debug").console;this._replConfig={fontSize:e.fontSize,fontFamily:e.fontFamily,lineHeight:e.lineHeight?e.lineHeight:xg.lineHeightEm*e.fontSize,cssLineHeight:e.lineHeight?`${e.lineHeight}px`:`${xg.lineHeightEm}em`,backgroundColor:this.themeService.getColorTheme().getColor(this.backgroundColorDelegate()),fontSizeForTwistie:e.fontSize*xg.lineHeightEm/2-8},this._onDidChange.fire()}};xg=E([b(2,se),b(3,Fe),b(4,$i)],xg);var DX=class extends mr{constructor(){super({id:"repl.action.acceptInput",label:u({key:"actions.repl.acceptInput",comment:["Apply input from the debug console input box"]},"Debug Console: Accept Input"),alias:"Debug Console: Accept Input",precondition:Eh,kbOpts:{kbExpr:ce.textInputFocus,primary:3,weight:100}})}run(t,e){Ba.get(e)?.cancelSuggestWidget(),Bx(t.get(Mi))?.acceptReplInput()}},kX=class extends tr{constructor(){super({viewId:ln,id:"repl.action.filter",title:u("repl.action.filter","Debug Console: Focus Filter"),precondition:Eh,keybinding:[{when:ce.textInputFocus,primary:2084,weight:100}]})}runInView(t,e){e.focusFilter()}},LX=class extends tr{constructor(){super({viewId:ln,id:"repl.action.find",title:u("repl.action.find","Debug Console: Focus Find"),precondition:Eh,keybinding:[{when:P.or(Eh,P.equals("focusedView","workbench.panel.repl.view")),primary:2596,weight:100}],icon:N.search,menu:[{id:V.ViewTitle,group:"navigation",when:P.equals("view",ln),order:15},{id:V.DebugConsoleContext,group:"z_commands",order:25}]})}runInView(t,e){e.openFind()}},RX=class extends mr{constructor(){super({id:"repl.action.copyAll",label:u("actions.repl.copyAll","Debug: Console Copy All"),alias:"Debug Console Copy All",precondition:Eh})}run(t,e){let i=t.get(rs),n=Bx(t.get(Mi));if(n)return i.writeText(n.getVisibleContent())}};Dr(DX);Dr(RX);he(kX);he(LX);var PX=class extends zh{getSessions(){return this.debugService.getModel().getSessions(!0).filter(t=>t.hasSeparateRepl()&&!Fx.has(t))}mapFocusedSessionToSelected(t){for(;t.parentSession&&!t.hasSeparateRepl();)t=t.parentSession;return t}};function Bx(r){return r.getActiveViewWithId(ln)??void 0}var Upe="workbench.action.debug.selectRepl";he(class extends tr{constructor(){super({id:Upe,viewId:ln,title:u("selectRepl","Select Debug Console"),f1:!1,menu:{id:V.ViewTitle,group:"navigation",when:P.and(P.equals("view",ln),fq),order:20}})}async runInView(r,t,e){let i=r.get(we);if(e&&e.state!==0&&e!==i.getViewModel().focusedSession){if(e.state!==2){let n=i.getModel().getSessions().find(o=>o.parentSession===e&&o.state===2);n&&(e=n)}await i.focusStackFrame(void 0,void 0,e,{explicit:!0})}await t.selectSession(e)}});he(class extends tr{constructor(){super({id:"workbench.debug.panel.action.clearReplAction",viewId:ln,title:ie("clearRepl","Clear Console"),metadata:{description:ie("clearRepl.descriotion","Clears all program output from your debug REPL")},f1:!0,icon:Ode,menu:[{id:V.ViewTitle,group:"navigation",when:P.equals("view",ln),order:30},{id:V.DebugConsoleContext,group:"z_commands",order:20}],keybinding:[{primary:0,mac:{primary:2089},weight:201,when:P.equals("focusedView","workbench.panel.repl.view")}]})}runInView(r,t){let e=r.get(Rx);t.clearRepl(),e.playSignal(ks.clear)}});he(class extends tr{constructor(){super({id:"debug.collapseRepl",title:u("collapse","Collapse All"),viewId:ln,menu:{id:V.DebugConsoleContext,group:"z_commands",order:10}})}runInView(r,t){t.collapseAll(),t.focus()}});he(class extends tr{constructor(){super({id:"debug.replPaste",title:u("paste","Paste"),viewId:ln,precondition:Gt.notEqualsTo(Ql(0)),menu:{id:V.DebugConsoleContext,group:"2_cutcopypaste",order:30}})}async runInView(r,t){let i=await r.get(rs).readText();if(i){let n=t.getReplInput();n.setValue(n.getValue().concat(i)),t.focus();let o=n.getModel(),s=o?o.getLineCount():0,a=o?.getLineMaxColumn(s);typeof s=="number"&&typeof a=="number"&&n.setPosition({lineNumber:s,column:a})}}});he(class extends tr{constructor(){super({id:"workbench.debug.action.copyAll",title:u("copyAll","Copy All"),viewId:ln,menu:{id:V.DebugConsoleContext,group:"2_cutcopypaste",order:20}})}async runInView(r,t){await r.get(rs).writeText(t.getVisibleContent())}});he(class extends Me{constructor(){super({id:"debug.replCopy",title:u("copy","Copy"),menu:{id:V.DebugConsoleContext,group:"2_cutcopypaste",order:10}})}async run(r,t){let e=r.get(rs),i=r.get(we),o=Gr().getSelection()?.toString();if(o&&o.length>0)return e.writeText(o);if(t)return e.writeText(await this.tryEvaluateAndCopy(i,t)||t.toString())}async tryEvaluateAndCopy(r,t){if(!(t instanceof jd))return;let e=r.getViewModel().focusedStackFrame,i=r.getViewModel().focusedSession;if(!(!e||!i||!i.capabilities.supportsClipboardContext))try{return(await i.evaluate(t.originalExpression,e.frameId,"clipboard"))?.body.result}catch{return}}});var VU=class{priority=70;name="debugConsole";when=P.equals("focusedView","workbench.panel.repl.view");type="view";getProvider(t){let e=t.get(Mi),i=t.get(U8),n=Bx(e);if(!n)return;let o=n.getFocusedElement();return new mP(n,o,i)}},mP=class extends R{constructor(e,i,n){super();this._replView=e;this._focusedElement=i;this._accessibleViewService=n;this._treeHadFocus=!!i}id="repl";_content;_onDidChangeContent=this._register(new x);onDidChangeContent=this._onDidChangeContent.event;_onDidResolveChildren=this._register(new x);onDidResolveChildren=this._onDidResolveChildren.event;verbositySettingKey="accessibility.verbosity.debug";options={type:"view"};_elementPositionMap=new Map;_treeHadFocus=!1;provideContent(){let e=this._replView.getDebugSession();if(!e)return"No debug session available.";let i=e.getReplElements();return i.length?(this._content||this._updateContent(i),this._content??i.map(n=>n.toString(!0)).join(`
`)):"No output in the debug console."}onClose(){if(this._content=void 0,this._elementPositionMap.clear(),this._treeHadFocus)return this._replView.focusTree();this._replView.getReplInput().focus()}onOpen(){this._register(this.onDidResolveChildren(()=>{this._onDidChangeContent.fire(),queueMicrotask(()=>{if(this._focusedElement){let e=this._elementPositionMap.get(this._focusedElement.getId());e&&this._accessibleViewService.setPosition(e,!0)}})}))}async _updateContent(e){let i=this._replView.getReplDataSource();if(!i)return;let n=1,o=[];for(let s of e)if(o.push(s.toString().replace(/\n/g,"")),this._elementPositionMap.set(s.getId(),new H(n,1)),n++,i.hasChildren(s)){let a=[],l=await i.getChildren(s);for(let d of l){let c=d.getId();this._elementPositionMap.has(c)||this._elementPositionMap.set(c,new H(n,1)),a.push("  "+d.toString()),n++}o.push(a.join(`
`))}this._content=o.join(`
`),this._onDidResolveChildren.fire()}};mP=E([b(2,U8)],mP);var Vx=class extends Vf{constructor(e,i,n){super(lP,{canAcceptInBackground:!0});this._debugService=e;this._viewsService=i;this._commandService=n}_getPicks(e,i,n){let o=[];this._debugService.getModel().getSessions(!0).filter(a=>a.hasSeparateRepl()).forEach((a,l)=>{let d=this._createPick(a,l,e);d&&o.push(d)}),o.length>0&&o.push({type:"separator"});let s=u("workbench.action.debug.startDebug","Start a New Debug Session");return o.push({label:`$(plus) ${s}`,ariaLabel:s,accept:()=>this._commandService.executeCommand(Ku)}),o}_createPick(e,i,n){let o=e.name,s=_l(n,o,!0);if(s)return{label:o,highlights:{label:s},accept:(a,l)=>{this._debugService.focusStackFrame(void 0,void 0,e,{explicit:!0}),this._viewsService.isViewVisible(ln)||this._viewsService.openView(ln,!0)}}}};Vx=E([b(0,we),b(1,Mi),b(2,ct)],Vx);var Wa=class{constructor(t,e,i){this._openerService=i;this._editor=t,this._visible=Wa.MESSAGE_VISIBLE.bindTo(e)}static ID="editor.contrib.messageController";static MESSAGE_VISIBLE=new A("messageVisible",!1,u("messageVisible","Whether the editor is currently showing an inline message"));static get(t){return t.getContribution(Wa.ID)}_editor;_visible;_messageWidget=new yt;_messageListeners=new B;_message;_mouseOverMessage=!1;dispose(){this._message?.dispose(),this._messageListeners.dispose(),this._messageWidget.dispose(),this._visible.reset()}isVisible(){return this._visible.get()}showMessage(t,e){ka(ya(t)?t.value:t),this._visible.set(!0),this._messageWidget.clear(),this._messageListeners.clear(),this._message=ya(t)?Qf(t,{actionHandler:{callback:n=>{this.closeMessage(),vj(this._openerService,n,ya(t)?t.isTrusted:void 0)},disposables:this._messageListeners}}):void 0,this._messageWidget.value=new WU(this._editor,e,typeof t=="string"?t:this._message.element),this._messageListeners.add(X.debounce(this._editor.onDidBlurEditorText,(n,o)=>o,0)(()=>{this._mouseOverMessage||this._messageWidget.value&&$n(fo(),this._messageWidget.value.getDomNode())||this.closeMessage()})),this._messageListeners.add(this._editor.onDidChangeCursorPosition(()=>this.closeMessage())),this._messageListeners.add(this._editor.onDidDispose(()=>this.closeMessage())),this._messageListeners.add(this._editor.onDidChangeModel(()=>this.closeMessage())),this._messageListeners.add(F(this._messageWidget.value.getDomNode(),Q.MOUSE_ENTER,()=>this._mouseOverMessage=!0,!0)),this._messageListeners.add(F(this._messageWidget.value.getDomNode(),Q.MOUSE_LEAVE,()=>this._mouseOverMessage=!1,!0));let i;this._messageListeners.add(this._editor.onMouseMove(n=>{n.target.position&&(i?i.containsPosition(n.target.position)||this.closeMessage():i=new L(e.lineNumber-3,1,n.target.position.lineNumber+3,1))}))}closeMessage(){this._visible.reset(),this._messageListeners.clear(),this._messageWidget.value&&this._messageListeners.add(WU.fadeOut(this._messageWidget.value))}};Wa=E([b(1,re),b(2,Yi)],Wa);var t_e=_r.bindToContribution(Wa.get);qe(new t_e({id:"leaveEditorMessage",precondition:Wa.MESSAGE_VISIBLE,handler:r=>r.closeMessage(),kbOpts:{weight:130,primary:9}}));var WU=class{allowEditorOverflow=!0;suppressMouseDown=!1;_editor;_position;_domNode;static fadeOut(t){let e=()=>{t.dispose(),clearTimeout(i),t.getDomNode().removeEventListener("animationend",e)},i=setTimeout(e,110);return t.getDomNode().addEventListener("animationend",e),t.getDomNode().classList.add("fadeOut"),{dispose:e}}constructor(t,{lineNumber:e,column:i},n){this._editor=t,this._editor.revealLinesInCenterIfOutsideViewport(e,e,0),this._position={lineNumber:e,column:i},this._domNode=document.createElement("div"),this._domNode.classList.add("monaco-editor-overlaymessage"),this._domNode.style.marginLeft="-6px";let o=document.createElement("div");o.classList.add("anchor","top"),this._domNode.appendChild(o);let s=document.createElement("div");typeof n=="string"?(s.classList.add("message"),s.textContent=n):(n.classList.add("message"),s.appendChild(n)),this._domNode.appendChild(s);let a=document.createElement("div");a.classList.add("anchor","below"),this._domNode.appendChild(a),this._editor.addContentWidget(this),this._domNode.classList.add("fadeIn")}dispose(){this._editor.removeContentWidget(this)}getId(){return"messageoverlay"}getDomNode(){return this._domNode}getPosition(){return{position:this._position,preference:[1,2],positionAffinity:1}}afterRender(t){this._domNode.classList.toggle("below",t===2)}};gr(Wa.ID,Wa,4);var MX=class extends Me{constructor(){super({id:"editor.debug.action.toggleBreakpoint",title:{...ie("toggleBreakpointAction","Debug: Toggle Breakpoint"),mnemonicTitle:u({key:"miToggleBreakpoint",comment:["&& denotes a mnemonic"]},"Toggle &&Breakpoint")},f1:!0,precondition:oi,keybinding:{when:P.or(ce.editorTextFocus,_h),primary:67,weight:100},menu:{id:V.MenubarDebugMenu,when:oi,group:"4_new_breakpoint",order:1}})}async run(t){let e=t.get($e),i=t.get(we),n=e.activeEditorPane;if(n instanceof Oa){let a=n.focusedAddressAndOffset;if(a){let d=i.getModel().getInstructionBreakpoints().find(c=>c.address===a.address);d?i.removeInstructionBreakpoints(d.instructionReference,d.offset):i.addInstructionBreakpoint({instructionReference:a.reference,offset:a.offset,address:a.address,canPersist:!1})}return}let o=t.get(En),s=o.getFocusedCodeEditor()||o.getActiveCodeEditor();if(s?.hasModel()){let a=s.getModel().uri,l=i.canSetBreakpointsIn(s.getModel()),d=[...new Set(s.getSelections().map(c=>c.getPosition().lineNumber))];await Promise.all(d.map(async c=>{let p=i.getModel().getBreakpoints({lineNumber:c,uri:a});p.length?await Promise.all(p.map(h=>i.removeBreakpoints(h.getId()))):l&&await i.addBreakpoints(a,[{lineNumber:c}])}))}}},AX=class extends mr{constructor(){super({id:"editor.debug.action.conditionalBreakpoint",label:u("conditionalBreakpointEditorAction","Debug: Add Conditional Breakpoint..."),alias:"Debug: Add Conditional Breakpoint...",precondition:oi,menuOpts:{menuId:V.MenubarNewBreakpointMenu,title:u({key:"miConditionalBreakpoint",comment:["&& denotes a mnemonic"]},"&&Conditional Breakpoint..."),group:"1_breakpoints",order:1,when:oi}})}async run(t,e){let i=t.get(we),n=e.getPosition();n&&e.hasModel()&&i.canSetBreakpointsIn(e.getModel())&&e.getContribution(Gd)?.showBreakpointWidget(n.lineNumber,void 0,0)}},OX=class extends mr{constructor(){super({id:"editor.debug.action.addLogPoint",label:u("logPointEditorAction","Debug: Add Logpoint..."),precondition:oi,alias:"Debug: Add Logpoint...",menuOpts:[{menuId:V.MenubarNewBreakpointMenu,title:u({key:"miLogPoint",comment:["&& denotes a mnemonic"]},"&&Logpoint..."),group:"1_breakpoints",order:4,when:oi}]})}async run(t,e){let i=t.get(we),n=e.getPosition();n&&e.hasModel()&&i.canSetBreakpointsIn(e.getModel())&&e.getContribution(Gd)?.showBreakpointWidget(n.lineNumber,n.column,2)}},NX=class extends mr{constructor(){super({id:"editor.debug.action.triggerByBreakpoint",label:u("triggerByBreakpointEditorAction","Debug: Add Triggered Breakpoint..."),precondition:oi,alias:"Debug: Triggered Breakpoint...",menuOpts:[{menuId:V.MenubarNewBreakpointMenu,title:u({key:"miTriggerByBreakpoint",comment:["&& denotes a mnemonic"]},"&&Triggered Breakpoint..."),group:"1_breakpoints",order:4,when:oi}]})}async run(t,e){let i=t.get(we),n=e.getPosition();n&&e.hasModel()&&i.canSetBreakpointsIn(e.getModel())&&e.getContribution(Gd)?.showBreakpointWidget(n.lineNumber,n.column,3)}},FX=class extends mr{constructor(){super({id:"editor.debug.action.editBreakpoint",label:u("EditBreakpointEditorAction","Debug: Edit Breakpoint"),alias:"Debug: Edit Existing Breakpoint",precondition:oi,menuOpts:{menuId:V.MenubarNewBreakpointMenu,title:u({key:"miEditBreakpoint",comment:["&& denotes a mnemonic"]},"&&Edit Breakpoint"),group:"1_breakpoints",order:1,when:oi}})}async run(t,e){let i=t.get(we),n=e.getPosition(),o=i.getModel();if(!(e.hasModel()&&n))return;let s=o.getBreakpoints({lineNumber:n.lineNumber});if(s.length===0)return;let a=s.map(c=>c.column?Math.abs(c.column-n.column):n.column),l=a.indexOf(Math.min(...a)),d=s[l];e.getContribution(Gd)?.showBreakpointWidget(d.lineNumber,d.column)}},BX=class r extends Me{static ID="debug.action.openDisassemblyView";constructor(){super({id:r.ID,title:{...ie("openDisassemblyView","Open Disassembly View"),mnemonicTitle:u({key:"miDisassemblyView",comment:["&& denotes a mnemonic"]},"&&DisassemblyView")},precondition:IV,menu:[{id:V.EditorContext,group:"debug",order:5,when:P.and(ui,wL.toNegated(),Gt.isEqualTo("stopped"),ce.editorTextFocus,SE,vV)},{id:V.DebugCallStackContext,group:"z_commands",order:50,when:P.and(ui,Gt.isEqualTo("stopped"),Ho.isEqualTo("stackFrame"),SE)},{id:V.CommandPalette,when:P.and(ui,Gt.isEqualTo("stopped"),SE)}]})}run(t){t.get($e).openEditor(Yl.instance,{pinned:!0,revealIfOpened:!0})}},VX=class r extends Me{static ID="debug.action.toggleDisassemblyViewSourceCode";static configID="debug.disassemblyView.showSourceCode";constructor(){super({id:r.ID,title:{...ie("toggleDisassemblyViewSourceCode","Toggle Source Code in Disassembly View"),mnemonicTitle:u({key:"mitogglesource",comment:["&& denotes a mnemonic"]},"&&ToggleSource")},metadata:{description:ie("toggleDisassemblyViewSourceCodeDescription","Shows or hides source code in disassembly")},f1:!0})}run(t,e,...i){let n=t.get(se);if(n){let o=n.getValue("debug").disassemblyView.showSourceCode;n.updateValue(r.configID,!o)}}},Wx=class r extends mr{static ID="editor.debug.action.runToCursor";static LABEL=ie("runToCursor","Run to Cursor");constructor(){super({id:r.ID,label:r.LABEL.value,alias:"Debug: Run to Cursor",precondition:P.and(oi,wL.toNegated(),P.or(ce.editorTextFocus,_h),xx.negate()),contextMenuOpts:{group:"debug",order:2,when:ui}})}async run(t,e){let i=e.getPosition();if(!(e.hasModel()&&i))return;let n=e.getModel().uri,o=t.get(we),s=o.getViewModel(),a=t.get(zn),l,d=s.focusedStackFrame;d&&a.extUri.isEqual(d.source.uri,n)&&d.range.startLineNumber===i.lineNumber&&(l=i.column),await o.runTo(n,i.lineNumber,l)}},Hx=class r extends mr{static ID="editor.debug.action.selectionToRepl";static LABEL=ie("evaluateInDebugConsole","Evaluate in Debug Console");constructor(){super({id:r.ID,label:r.LABEL.value,alias:"Debug: Evaluate in Console",precondition:P.and(ui,ce.editorTextFocus,xx.negate()),contextMenuOpts:{group:"debug",order:0}})}async run(t,e){let i=t.get(we),n=t.get(Mi),s=i.getViewModel().focusedSession;if(!e.hasModel()||!s)return;let a=e.getSelection(),l;a.isEmpty()?l=e.getModel().getLineContent(a.selectionStartLineNumber).trim():l=e.getModel().getValueInRange(a),(await n.openView(ln,!1))?.sendReplInput(l)}},Ux=class r extends mr{static ID="editor.debug.action.selectionToWatch";static LABEL=ie("addToWatch","Add to Watch");constructor(){super({id:r.ID,label:r.LABEL.value,alias:"Debug: Add to Watch",precondition:P.and(ui,ce.editorTextFocus,xx.negate()),contextMenuOpts:{group:"debug",order:1}})}async run(t,e){let i=t.get(we),n=t.get(Mi),o=t.get(ni);if(!e.hasModel())return;let s,a=e.getModel(),l=e.getSelection();if(!l.isEmpty())s=a.getValueInRange(l);else{let d=e.getPosition(),c=await RB(o,a,d);if(!c)return;s=c.matchingExpression}s&&(await n.openView(Mu),i.addWatchExpression(s))}},WX=class extends mr{constructor(){super({id:"editor.debug.action.showDebugHover",label:u("showDebugHover","Debug: Show Hover"),alias:"Debug: Show Hover",precondition:ui,kbOpts:{kbExpr:ce.editorTextFocus,primary:mo(2089,2087),weight:100}})}async run(t,e){let i=e.getPosition();if(!(!i||!e.hasModel()))return e.getContribution(dg)?.showHover(i,!0)}},Gpe=u("editor.debug.action.stepIntoTargets.notAvailable","Step targets are not available here"),HX=class r extends mr{static ID="editor.debug.action.stepIntoTargets";static LABEL=u({key:"stepIntoTargets",comment:["Step Into Targets lets the user step into an exact function he or she is interested in."]},"Step Into Target");constructor(){super({id:r.ID,label:r.LABEL,alias:"Debug: Step Into Target",precondition:P.and(Cb,ui,Gt.isEqualTo("stopped"),ce.editorTextFocus),contextMenuOpts:{group:"debug",order:1.5}})}async run(t,e){let i=t.get(we),n=t.get(vt),o=t.get(zn),s=i.getViewModel().focusedSession,a=i.getViewModel().focusedStackFrame,l=e.getSelection(),d=l?.getPosition()||a&&{lineNumber:a.range.startLineNumber,column:a.range.startColumn};if(!s||!a||!e.hasModel()||!o.extUri.isEqual(e.getModel().uri,a.source.uri)){d&&Wa.get(e)?.showMessage(Gpe,d);return}let c=await s.stepInTargets(a.frameId);if(!c?.length){Wa.get(e)?.showMessage(Gpe,d);return}if(l){let g=[];for(let y of c)y.line&&g.push({start:new H(y.line,y.column||1),end:y.endLine?new H(y.endLine,y.endColumn||1):void 0,target:y});g.sort((y,w)=>w.start.lineNumber-y.start.lineNumber||w.start.column-y.start.column);let v=l.getPosition(),I=g.find(y=>y.end&&v.isBefore(y.end)&&y.start.isBeforeOrEqual(v))||g.find(y=>y.end===void 0&&y.start.isBeforeOrEqual(v));if(I){s.stepIn(a.thread.threadId,I.target.id);return}}e.revealLineInCenterIfOutsideViewport(a.range.startLineNumber);let p=e.getScrolledVisiblePosition(d),h=Oi(e.getDomNode()),m=h.left+p.left,f=h.top+p.top+p.height;n.showContextMenu({getAnchor:()=>({x:m,y:f}),getActions:()=>c.map(g=>new et(`stepIntoTarget:${g.id}`,g.label,void 0,!0,()=>s.stepIn(a.thread.threadId,g.id)))})}},HU=class extends mr{constructor(e,i){super(i);this.isNext=e}async run(e,i){let n=e.get(we),o=e.get($e),s=e.get(zn);if(i.hasModel()){let a=i.getModel().uri,l=i.getPosition().lineNumber,d=n.getModel().getBreakpoints({enabledOnly:!0}),c=this.isNext?d.filter(p=>s.extUri.isEqual(p.uri,a)&&p.lineNumber>l).shift():d.filter(p=>s.extUri.isEqual(p.uri,a)&&p.lineNumber<l).pop();if(c||(c=this.isNext?d.filter(p=>p.uri.toString()>a.toString()).shift():d.filter(p=>p.uri.toString()<a.toString()).pop()),!c&&d.length&&(c=this.isNext?d[0]:d[d.length-1]),c)return xE(c,!1,!0,!1,n,o)}}},UX=class extends HU{constructor(){super(!0,{id:"editor.debug.action.goToNextBreakpoint",label:u("goToNextBreakpoint","Debug: Go to Next Breakpoint"),alias:"Debug: Go to Next Breakpoint",precondition:oi})}},zX=class extends HU{constructor(){super(!1,{id:"editor.debug.action.goToPreviousBreakpoint",label:u("goToPreviousBreakpoint","Debug: Go to Previous Breakpoint"),alias:"Debug: Go to Previous Breakpoint",precondition:oi})}},KX=class extends mr{constructor(){super({id:"editor.debug.action.closeExceptionWidget",label:u("closeExceptionWidget","Close Exception Widget"),alias:"Close Exception Widget",precondition:fV,kbOpts:{primary:9,weight:100}})}async run(t,e){e.getContribution(dg)?.closeExceptionWidget()}};he(BX);he(VX);he(MX);Dr(AX);Dr(OX);Dr(NX);Dr(FX);Dr(Wx);Dr(HX);Dr(Hx);Dr(Ux);Dr(WX);Dr(UX);Dr(zX);Dr(KX);var qpe="editor.action.showHover";var gP="editor.action.increaseHoverVerbosityLevel";var IWn=u({key:"increaseHoverVerbosityLevel",comment:["Label for action that will increase the hover verbosity level."]},"Increase Hover Verbosity Level"),fP="editor.action.decreaseHoverVerbosityLevel";var yWn=u({key:"decreaseHoverVerbosityLevel",comment:["Label for action that will decrease the hover verbosity level."]},"Decrease Hover Verbosity Level");var GX=class{constructor(t,e,i,n){this.value=t;this.isComplete=e;this.hasLoadingMessage=i;this.options=n}},UU=class extends R{constructor(e,i){super();this._editor=e;this._computer=i}_onResult=this._register(new x);onResult=this._onResult.event;_asyncComputationScheduler=this._register(new bP(e=>this._triggerAsyncComputation(e),0));_syncComputationScheduler=this._register(new bP(e=>this._triggerSyncComputation(e),0));_loadingMessageScheduler=this._register(new bP(e=>this._triggerLoadingMessage(e),0));_state=0;_asyncIterable=null;_asyncIterableDone=!1;_result=[];_options;dispose(){this._asyncIterable&&(this._asyncIterable.cancel(),this._asyncIterable=null),this._options=void 0,super.dispose()}get _hoverTime(){return this._editor.getOption(61).delay}get _firstWaitTime(){return this._hoverTime/2}get _secondWaitTime(){return this._hoverTime-this._firstWaitTime}get _loadingMessageTime(){return 3*this._hoverTime}_setState(e,i){this._state=e,this._fireResult(i)}_triggerAsyncComputation(e){this._setState(2,e),this._syncComputationScheduler.schedule(e,this._secondWaitTime),this._computer.computeAsync?(this._asyncIterableDone=!1,this._asyncIterable=Nee(i=>this._computer.computeAsync(e,i)),(async()=>{try{for await(let i of this._asyncIterable)i&&(this._result.push(i),this._fireResult(e));this._asyncIterableDone=!0,(this._state===3||this._state===4)&&this._setState(0,e)}catch(i){Xe(i)}})()):this._asyncIterableDone=!0}_triggerSyncComputation(e){this._computer.computeSync&&(this._result=this._result.concat(this._computer.computeSync(e))),this._setState(this._asyncIterableDone?0:3,e)}_triggerLoadingMessage(e){this._state===3&&this._setState(4,e)}_fireResult(e){if(this._state===1||this._state===2)return;let i=this._state===0,n=this._state===4;this._onResult.fire(new GX(this._result.slice(0),i,n,e))}start(e,i){if(e===0)this._state===0&&(this._setState(1,i),this._asyncComputationScheduler.schedule(i,this._firstWaitTime),this._loadingMessageScheduler.schedule(i,this._loadingMessageTime));else switch(this._state){case 0:this._triggerAsyncComputation(i),this._syncComputationScheduler.cancel(),this._triggerSyncComputation(i);break;case 2:this._syncComputationScheduler.cancel(),this._triggerSyncComputation(i);break}}cancel(){this._asyncComputationScheduler.cancel(),this._syncComputationScheduler.cancel(),this._loadingMessageScheduler.cancel(),this._asyncIterable&&(this._asyncIterable.cancel(),this._asyncIterable=null),this._result=[],this._options=void 0,this._state=0}get options(){return this._options}},bP=class extends R{_scheduler;_options;constructor(t,e){super(),this._scheduler=this._register(new Ye(()=>t(this._options),e))}schedule(t,e){this._options=t,this._scheduler.schedule(e)}cancel(){this._scheduler.cancel()}};var zx=class{constructor(t,e,i,n){this.priority=t;this.range=e;this.initialMousePosX=i;this.initialMousePosY=n}type=1;equals(t){return t.type===1&&this.range.equalsRange(t.range)}canAdoptVisibleHover(t,e){return t.type===1&&e.lineNumber===this.range.startLineNumber}},zU=class{constructor(t,e,i,n,o,s){this.priority=t;this.owner=e;this.range=i;this.initialMousePosX=n;this.initialMousePosY=o;this.supportsMarkerHover=s}type=2;equals(t){return t.type===2&&this.owner===t.owner}canAdoptVisibleHover(t,e){return t.type===2&&this.owner===t.owner}},cv=class{constructor(t){this.renderedHoverParts=t}dispose(){for(let t of this.renderedHoverParts)t.dispose()}},$pe=new class{_participants=[];register(t){this._participants.push(t)}getAll(){return this._participants}};var jpe="editor.action.inlineSuggest.showPrevious",Xpe="editor.action.inlineSuggest.showNext";var KU=class extends R{constructor(e,i,n){super();this.editor=e;this.model=i;this.instantiationService=n;this._register(Cr((o,s)=>{let a=this.model.read(o);if(!a||!this.alwaysShowToolbar.read(o))return;let l=qc((c,p)=>{let h=p.add(this.instantiationService.createInstance(Kh,this.editor,!0,this.position,a.selectedInlineCompletionIndex,a.inlineCompletionsCount,a.activeCommands));return e.addContentWidget(h),p.add(le(()=>e.removeContentWidget(h))),p.add(Ft(m=>{this.position.read(m)&&a.lastTriggerKind.read(m)!==1&&a.triggerExplicitly()})),h}),d=iA(this,(c,p)=>!!this.position.read(c)||!!p);s.add(Ft(c=>{d.read(c)&&l.read(c)}))}))}alwaysShowToolbar=Pi(this,this.editor.onDidChangeConfiguration,()=>this.editor.getOption(63).showToolbar==="always");sessionPosition=void 0;position=dt(this,e=>{let i=this.model.read(e)?.primaryGhostText.read(e);if(!this.alwaysShowToolbar.read(e)||!i||i.parts.length===0)return this.sessionPosition=void 0,null;let n=i.parts[0].column;this.sessionPosition&&this.sessionPosition.lineNumber!==i.lineNumber&&(this.sessionPosition=void 0);let o=new H(i.lineNumber,Math.min(n,this.sessionPosition?.column??Number.MAX_SAFE_INTEGER));return this.sessionPosition=o,o})};KU=E([b(2,ne)],KU);var i_e=ke("inline-suggestion-hints-next",N.chevronRight,u("parameterHintsNextIcon","Icon for show next parameter hint.")),n_e=ke("inline-suggestion-hints-previous",N.chevronLeft,u("parameterHintsPreviousIcon","Icon for show previous parameter hint.")),Kh=class extends R{constructor(e,i,n,o,s,a,l,d,c,p,h){super();this.editor=e;this.withBorder=i;this._position=n;this._currentSuggestionIdx=o;this._suggestionCount=s;this._extraCommands=a;this._commandService=l;this.keybindingService=c;this._contextKeyService=p;this._menuService=h;this.toolBar=this._register(d.createInstance(vP,this.nodes.toolBar,V.InlineSuggestionToolbar,{menuOptions:{renderShortTitle:!0},toolbarOptions:{primaryGroup:m=>m.startsWith("primary")},actionViewItemProvider:(m,f)=>{if(m instanceof wn)return d.createInstance($X,m,void 0);if(m===this.availableSuggestionCountAction){let g=new qX(void 0,m,{label:!0,icon:!1});return g.setClass("availableSuggestionCount"),g}},telemetrySource:"InlineSuggestionToolbar"})),this.toolBar.setPrependedPrimaryActions([this.previousAction,this.availableSuggestionCountAction,this.nextAction]),this._register(this.toolBar.onDidChangeDropdownVisibility(m=>{Kh._dropDownVisible=m})),this._register(Ft(m=>{this._position.read(m),this.editor.layoutContentWidget(this)})),this._register(Ft(m=>{let f=this._suggestionCount.read(m),g=this._currentSuggestionIdx.read(m);f!==void 0?(this.clearAvailableSuggestionCountLabelDebounced.cancel(),this.availableSuggestionCountAction.label=`${g+1}/${f}`):this.clearAvailableSuggestionCountLabelDebounced.schedule(),f!==void 0&&f>1?(this.disableButtonsDebounced.cancel(),this.previousAction.enabled=this.nextAction.enabled=!0):this.disableButtonsDebounced.schedule()})),this._register(Ft(m=>{let g=this._extraCommands.read(m).map(v=>({class:void 0,id:v.id,enabled:!0,tooltip:v.tooltip||"",label:v.title,run:I=>this._commandService.executeCommand(v.id)}));for(let[v,I]of this.inlineCompletionsActionsMenus.getActions())for(let y of I)y instanceof wn&&g.push(y);g.length>0&&g.unshift(new Qt),this.toolBar.setAdditionalSecondaryActions(g)}))}static _dropDownVisible=!1;static get dropDownVisible(){return this._dropDownVisible}static id=0;id=`InlineSuggestionHintsContentWidget${Kh.id++}`;allowEditorOverflow=!0;suppressMouseDown=!1;nodes=wi("div.inlineSuggestionsHints",{className:this.withBorder?".withBorder":""},[wi("div@toolBar")]);createCommandAction(e,i,n){let o=new et(e,i,n,!0,()=>this._commandService.executeCommand(e)),s=this.keybindingService.lookupKeybinding(e,this._contextKeyService),a=i;return s&&(a=u({key:"content",comment:["A label","A keybinding"]},"{0} ({1})",i,s.getLabel())),o.tooltip=a,o}previousAction=this.createCommandAction(jpe,u("previous","Previous"),de.asClassName(n_e));availableSuggestionCountAction=new et("inlineSuggestionHints.availableSuggestionCount","",void 0,!1);nextAction=this.createCommandAction(Xpe,u("next","Next"),de.asClassName(i_e));toolBar;inlineCompletionsActionsMenus=this._register(this._menuService.createMenu(V.InlineCompletionsActions,this._contextKeyService));clearAvailableSuggestionCountLabelDebounced=this._register(new Ye(()=>{this.availableSuggestionCountAction.label=""},100));disableButtonsDebounced=this._register(new Ye(()=>{this.previousAction.enabled=this.nextAction.enabled=!1},100));getId(){return this.id}getDomNode(){return this.nodes.root}getPosition(){return{position:this._position.get(),preference:[1,2],positionAffinity:3}}};Kh=E([b(6,ct),b(7,ne),b(8,Be),b(9,re),b(10,jt)],Kh);var qX=class extends Kl{_className=void 0;setClass(t){this._className=t}render(t){super.render(t),this._className&&t.classList.add(this._className)}updateTooltip(){}},$X=class extends Gl{updateLabel(){let t=this._keybindingService.lookupKeybinding(this._action.id,this._contextKeyService);if(!t)return super.updateLabel();if(this.label){let e=wi("div.keybinding").root;this._register(new Y1(e,Ys,{disableTitle:!0,...Nae})).set(t),this.label.textContent=this._action.label,this.label.appendChild(e),this.label.classList.add("inlineSuggestionStatusBarItemLabel")}}updateTooltip(){}},vP=class extends ul{constructor(e,i,n,o,s,a,l,d,c){super(e,{resetMenu:i,...n},o,s,a,l,d,c);this.menuId=i;this.options2=n;this.menuService=o;this.contextKeyService=s;this._store.add(this.menu.onDidChange(()=>this.updateToolbar())),this.updateToolbar()}menu=this._store.add(this.menuService.createMenu(this.menuId,this.contextKeyService,{emitEventsForSubmenuChanges:!0}));additionalActions=[];prependedPrimaryActions=[];updateToolbar(){let e=[],i=[];Vo(this.menu,this.options2?.menuOptions,{primary:e,secondary:i},this.options2?.toolbarOptions?.primaryGroup,this.options2?.toolbarOptions?.shouldInlineSubmenu,this.options2?.toolbarOptions?.useSeparatorsInPrimaryActions),i.push(...this.additionalActions),e.unshift(...this.prependedPrimaryActions),this.setActions(e,i)}setPrependedPrimaryActions(e){xi(this.prependedPrimaryActions,e,(i,n)=>i===n)||(this.prependedPrimaryActions=e,this.updateToolbar())}setAdditionalSecondaryActions(e){xi(this.additionalActions,e,(i,n)=>i===n)||(this.additionalActions=e,this.updateToolbar())}};vP=E([b(3,jt),b(4,re),b(5,vt),b(6,Be),b(7,ct),b(8,Tt)],vP);function GU(r,t,e){let i=Oi(r);return!(t<i.left||t>i.left+i.width||e<i.top||e>i.top+i.height)}var o_e=30,r_e=24,qU=class extends R{constructor(e,i=new Ge(10,10)){super();this._editor=e;this._resizableNode.domNode.style.position="absolute",this._resizableNode.minSize=Ge.lift(i),this._resizableNode.layout(i.height,i.width),this._resizableNode.enableSashes(!0,!0,!0,!0),this._register(this._resizableNode.onDidResize(n=>{this._resize(new Ge(n.dimension.width,n.dimension.height)),n.done&&(this._isResizing=!1)})),this._register(this._resizableNode.onDidWillResize(()=>{this._isResizing=!0}))}allowEditorOverflow=!0;suppressMouseDown=!1;_resizableNode=this._register(new Wb);_contentPosition=null;_isResizing=!1;get isResizing(){return this._isResizing}getDomNode(){return this._resizableNode.domNode}getPosition(){return this._contentPosition}get position(){return this._contentPosition?.position?H.lift(this._contentPosition.position):void 0}_availableVerticalSpaceAbove(e){let i=this._editor.getDomNode(),n=this._editor.getScrolledVisiblePosition(e);return!i||!n?void 0:Oi(i).top+n.top-o_e}_availableVerticalSpaceBelow(e){let i=this._editor.getDomNode(),n=this._editor.getScrolledVisiblePosition(e);if(!i||!n)return;let o=Oi(i),s=Qa(i.ownerDocument.body),a=o.top+n.top+n.height;return s.height-a-r_e}_findPositionPreference(e,i){let n=Math.min(this._availableVerticalSpaceBelow(i)??1/0,e),o=Math.min(this._availableVerticalSpaceAbove(i)??1/0,e),s=Math.min(Math.max(o,n),e),a=Math.min(e,s),l;return this._editor.getOption(61).above?l=a<=o?1:2:l=a<=n?2:1,l===1?this._resizableNode.enableSashes(!0,!0,!1,!1):this._resizableNode.enableSashes(!1,!0,!0,!1),l}_resize(e){this._resizableNode.layout(e.height,e.width)}};var Ype=J,Kx=class extends R{constructor(e){super();this._keybindingService=e;this.hoverElement=Ype("div.hover-row.status-bar"),this.hoverElement.tabIndex=0,this.actionsElement=U(this.hoverElement,Ype("div.actions"))}hoverElement;actions=[];actionsElement;_hasContent=!1;get hasContent(){return this._hasContent}addAction(e){let i=this._keybindingService.lookupKeybinding(e.commandId),n=i?i.getLabel():null;this._hasContent=!0;let o=this._register(b1.render(this.actionsElement,e,n));return this.actions.push(o),o}append(e){let i=U(this.actionsElement,e);return this._hasContent=!0,i}};Kx=E([b(0,Be)],Kx);var $U=class r{constructor(t,e){this._editor=t;this._participants=e}static _getLineDecorations(t,e){if(e.type!==1&&!e.supportsMarkerHover)return[];let i=t.getModel(),n=e.range.startLineNumber;if(n>i.getLineCount())return[];let o=i.getLineMaxColumn(n);return t.getLineDecorations(n).filter(s=>{if(s.options.isWholeLine)return!0;let a=s.range.startLineNumber===n?s.range.startColumn:1,l=s.range.endLineNumber===n?s.range.endColumn:o;if(s.options.showIfCollapsed){if(a>e.range.startColumn+1||e.range.endColumn-1>l)return!1}else if(a>e.range.startColumn||e.range.endColumn>l)return!1;return!0})}computeAsync(t,e){let i=t.anchor;if(!this._editor.hasModel()||!i)return gs.EMPTY;let n=r._getLineDecorations(this._editor,i);return gs.merge(this._participants.map(o=>o.computeAsync?o.computeAsync(i,n,e):gs.EMPTY))}computeSync(t){if(!this._editor.hasModel())return[];let e=t.anchor,i=r._getLineDecorations(this._editor,e),n=[];for(let o of this._participants)n=n.concat(o.computeSync(e,i));return cn(n)}};var IP=class{constructor(t,e,i){this.hoverParts=t;this.isComplete=e;this.options=i}filter(t){let e=this.hoverParts.filter(i=>i.isValidForHoverAnchor(t));return e.length===this.hoverParts.length?this:new jX(this,e,this.isComplete,this.options)}},jX=class extends IP{constructor(e,i,n,o){super(i,n,o);this.original=e}filter(e){return this.original.filter(e)}};var XX=class{constructor(t,e,i){this.provider=t;this.hover=e;this.ordinal=i}};async function s_e(r,t,e,i,n){let o=await Promise.resolve(r.provideHover(e,i,n)).catch(zo);if(!(!o||!a_e(o)))return new XX(r,o,t)}function yP(r,t,e,i,n=!1){let s=r.ordered(t,n).map((a,l)=>s_e(a,l,t,e,i));return gs.fromPromises(s).coalesce()}function Zpe(r,t,e,i,n=!1){return yP(r,t,e,i,n).map(o=>o.hover).toPromise()}Fl("_executeHoverProvider",(r,t,e)=>{let i=r.get(ni);return Zpe(i.hoverProvider,t,e,Pt.None)});Fl("_executeHoverProvider_recursive",(r,t,e)=>{let i=r.get(ni);return Zpe(i.hoverProvider,t,e,Pt.None,!0)});function a_e(r){let t=typeof r.range<"u",e=typeof r.contents<"u"&&r.contents&&r.contents.length>0;return t&&e}var Gx=J,l_e=ke("hover-increase-verbosity",N.add,u("increaseHoverVerbosity","Icon for increaseing hover verbosity.")),d_e=ke("hover-decrease-verbosity",N.remove,u("decreaseHoverVerbosity","Icon for decreasing hover verbosity.")),od=class{constructor(t,e,i,n,o,s=void 0){this.owner=t;this.range=e;this.contents=i;this.isBeforeContent=n;this.ordinal=o;this.source=s}isValidForHoverAnchor(t){return t.type===1&&this.range.startColumn<=t.range.startColumn&&this.range.endColumn>=t.range.endColumn}},jU=class{constructor(t,e,i){this.hover=t;this.hoverProvider=e;this.hoverPosition=i}supportsVerbosityAction(t){switch(t){case 0:return this.hover.canIncreaseVerbosity??!1;case 1:return this.hover.canDecreaseVerbosity??!1}}},uv=class{constructor(t,e,i,n,o,s,a,l){this._editor=t;this._languageService=e;this._openerService=i;this._configurationService=n;this._languageFeaturesService=o;this._keybindingService=s;this._hoverService=a;this._commandService=l}hoverOrdinal=3;_renderedHoverParts;createLoadingMessage(t){return new od(this,t.range,[new Sn().appendText(u("modesContentHover.loading","Loading..."))],!1,2e3)}computeSync(t,e){if(!this._editor.hasModel()||t.type!==1)return[];let i=this._editor.getModel(),n=t.range.startLineNumber,o=i.getLineMaxColumn(n),s=[],a=1e3,l=i.getLineLength(n),d=i.getLanguageIdAtPosition(t.range.startLineNumber,t.range.startColumn),c=this._editor.getOption(119),p=this._configurationService.getValue("editor.maxTokenizationLineLength",{overrideIdentifier:d}),h=!1;c>=0&&l>c&&t.range.startColumn>=c&&(h=!0,s.push(new od(this,t.range,[{value:u("stopped rendering","Rendering paused for long line for performance reasons. This can be configured via `editor.stopRenderingLineAfter`.")}],!1,a++))),!h&&typeof p=="number"&&l>=p&&s.push(new od(this,t.range,[{value:u("too many characters","Tokenization is skipped for long lines for performance reasons. This can be configured via `editor.maxTokenizationLineLength`.")}],!1,a++));let m=!1;for(let f of e){let g=f.range.startLineNumber===n?f.range.startColumn:1,v=f.range.endLineNumber===n?f.range.endColumn:o,I=f.options.hoverMessage;if(!I||oI(I))continue;f.options.beforeContentClassName&&(m=!0);let y=new L(t.range.startLineNumber,g,t.range.startLineNumber,v);s.push(new od(this,y,Ov(I),m,a++))}return s}computeAsync(t,e,i){if(!this._editor.hasModel()||t.type!==1)return gs.EMPTY;let n=this._editor.getModel(),o=this._languageFeaturesService.hoverProvider;return o.has(n)?this._getMarkdownHovers(o,n,t,i):gs.EMPTY}_getMarkdownHovers(t,e,i,n){let o=i.range.getStartPosition();return yP(t,e,o,n).filter(l=>!oI(l.hover.contents)).map(l=>{let d=l.hover.range?L.lift(l.hover.range):i.range,c=new jU(l.hover,l.provider,o);return new od(this,d,l.hover.contents,!1,l.ordinal,c)})}renderHoverParts(t,e){return this._renderedHoverParts=new YX(e,t.fragment,this,this._editor,this._languageService,this._openerService,this._commandService,this._keybindingService,this._hoverService,this._configurationService,t.onContentsChanged),this._renderedHoverParts}getAccessibleContent(t){return this._renderedHoverParts?.getAccessibleContent(t)??""}doesMarkdownHoverAtIndexSupportVerbosityAction(t,e){return this._renderedHoverParts?.doesMarkdownHoverAtIndexSupportVerbosityAction(t,e)??!1}updateMarkdownHoverVerbosityLevel(t,e,i){return Promise.resolve(this._renderedHoverParts?.updateMarkdownHoverPartVerbosityLevel(t,e,i))}};uv=E([b(1,ti),b(2,Yi),b(3,se),b(4,ni),b(5,Be),b(6,Nt),b(7,ct)],uv);var qx=class{constructor(t,e,i){this.hoverPart=t;this.hoverElement=e;this.disposables=i}get hoverAccessibleContent(){return this.hoverElement.innerText.trim()}dispose(){this.disposables.dispose()}},YX=class{constructor(t,e,i,n,o,s,a,l,d,c,p){this._hoverParticipant=i;this._editor=n;this._languageService=o;this._openerService=s;this._commandService=a;this._keybindingService=l;this._hoverService=d;this._configurationService=c;this._onFinishedRendering=p;this.renderedHoverParts=this._renderHoverParts(t,e,this._onFinishedRendering),this._disposables.add(le(()=>{this.renderedHoverParts.forEach(h=>{h.dispose()}),this._ongoingHoverOperations.forEach(h=>{h.tokenSource.dispose(!0)})}))}renderedHoverParts;_ongoingHoverOperations=new Map;_disposables=new B;_renderHoverParts(t,e,i){return t.sort(Sr(n=>n.ordinal,ud)),t.map(n=>{let o=this._renderHoverPart(n,i);return e.appendChild(o.hoverElement),o})}_renderHoverPart(t,e){let i=this._renderMarkdownHover(t,e),n=i.hoverElement,o=t.source,s=new B;if(s.add(i),!o)return new qx(t,n,s);let a=o.supportsVerbosityAction(0),l=o.supportsVerbosityAction(1);if(!a&&!l)return new qx(t,n,s);let d=Gx("div.verbosity-actions");return n.prepend(d),s.add(this._renderHoverExpansionAction(d,0,a)),s.add(this._renderHoverExpansionAction(d,1,l)),new qx(t,n,s)}_renderMarkdownHover(t,e){return c_e(this._editor,t,this._languageService,this._openerService,e)}_renderHoverExpansionAction(t,e,i){let n=new B,o=e===0,s=U(t,Gx(de.asCSSSelector(o?l_e:d_e)));s.tabIndex=0;let a=new sh("mouse",!1,{target:t,position:{hoverPosition:0}},this._configurationService,this._hoverService);if(n.add(this._hoverService.setupManagedHover(a,s,u_e(this._keybindingService,e))),!i)return s.classList.add("disabled"),n;s.classList.add("enabled");let l=()=>this._commandService.executeCommand(e===0?gP:fP);return n.add(new Wk(s,l)),n.add(new Hk(s,l,[3,10])),n}async updateMarkdownHoverPartVerbosityLevel(t,e,i=!0){let n=this._editor.getModel();if(!n)return;let o=this._getRenderedHoverPartAtIndex(e),s=o?.hoverPart.source;if(!o||!s?.supportsVerbosityAction(t))return;let a=await this._fetchHover(s,n,t);if(!a)return;let l=new jU(a,s.hoverProvider,s.hoverPosition),d=o.hoverPart,c=new od(this._hoverParticipant,d.range,a.contents,d.isBeforeContent,d.ordinal,l),p=this._renderHoverPart(c,this._onFinishedRendering);return this._replaceRenderedHoverPartAtIndex(e,p,c),i&&this._focusOnHoverPartWithIndex(e),{hoverPart:c,hoverElement:p.hoverElement}}getAccessibleContent(t){let e=this.renderedHoverParts.findIndex(s=>s.hoverPart===t);if(e===-1)return;let i=this._getRenderedHoverPartAtIndex(e);return i?i.hoverElement.innerText.replace(/[^\S\n\r]+/gu," "):void 0}doesMarkdownHoverAtIndexSupportVerbosityAction(t,e){let i=this._getRenderedHoverPartAtIndex(t),n=i?.hoverPart.source;return!(!i||!n?.supportsVerbosityAction(e))}async _fetchHover(t,e,i){let n=i===0?1:-1,o=t.hoverProvider,s=this._ongoingHoverOperations.get(o);s&&(s.tokenSource.cancel(),n+=s.verbosityDelta);let a=new Kt;this._ongoingHoverOperations.set(o,{verbosityDelta:n,tokenSource:a});let l={verbosityRequest:{verbosityDelta:n,previousHover:t.hover}},d;try{d=await Promise.resolve(o.provideHover(e,t.hoverPosition,a.token,l))}catch(c){zo(c)}return a.dispose(),this._ongoingHoverOperations.delete(o),d}_replaceRenderedHoverPartAtIndex(t,e,i){if(t>=this.renderedHoverParts.length||t<0)return;let n=this.renderedHoverParts[t],o=n.hoverElement,s=e.hoverElement,a=Array.from(s.children);o.replaceChildren(...a);let l=new qx(i,o,e.disposables);o.focus(),n.dispose(),this.renderedHoverParts[t]=l}_focusOnHoverPartWithIndex(t){this.renderedHoverParts[t].hoverElement.focus()}_getRenderedHoverPartAtIndex(t){return this.renderedHoverParts[t]}dispose(){this._disposables.dispose()}};function c_e(r,t,e,i,n){let o=new B,s=Gx("div.hover-row"),a=Gx("div.hover-row-contents");s.appendChild(a);let l=t.contents;for(let c of l){if(oI(c))continue;let p=Gx("div.markdown-hover"),h=U(p,Gx("div.hover-contents")),m=o.add(new Ph({editor:r},e,i));o.add(m.onDidRenderAsync(()=>{h.className="hover-contents code-hover-contents",n()}));let f=o.add(m.render(c));h.appendChild(f.element),a.appendChild(p)}return{hoverPart:t,hoverElement:s,dispose(){o.dispose()}}}function u_e(r,t){switch(t){case 0:{let e=r.lookupKeybinding(gP);return e?u("increaseVerbosityWithKb","Increase Hover Verbosity ({0})",e.getLabel()):u("increaseVerbosity","Increase Hover Verbosity")}case 1:{let e=r.lookupKeybinding(fP);return e?u("decreaseVerbosityWithKb","Decrease Hover Verbosity ({0})",e.getLabel()):u("decreaseVerbosity","Decrease Hover Verbosity")}}}var qy=class{constructor(t){this._editorWorkerService=t}async provideDocumentColors(t,e){return this._editorWorkerService.computeDefaultDocumentColors(t.uri)}provideColorPresentations(t,e,i){let n=e.range,o=e.color,s=o.alpha,a=new j(new xt(Math.round(255*o.red),Math.round(255*o.green),Math.round(255*o.blue),s)),l=s?j.Format.CSS.formatRGB(a):j.Format.CSS.formatRGBA(a),d=s?j.Format.CSS.formatHSL(a):j.Format.CSS.formatHSLA(a),c=s?j.Format.CSS.formatHex(a):j.Format.CSS.formatHexA(a),p=[];return p.push({label:l,textEdit:{range:n,text:l}}),p.push({label:d,textEdit:{range:n,text:d}}),p.push({label:c,textEdit:{range:n,text:c}}),p}};qy=E([b(0,hg)],qy);var XU=class extends R{constructor(t,e){super(),this._register(t.colorProvider.register("*",new qy(e)))}};XU=E([b(0,ni),b(1,hg)],XU);async function YU(r,t,e,i=!0){return p_e(new QX,r,t,e,i)}function ZX(r,t,e,i){return Promise.resolve(e.provideColorPresentations(r,t,i))}var QX=class{constructor(){}async compute(t,e,i,n){let o=await t.provideDocumentColors(e,i);if(Array.isArray(o))for(let s of o)n.push({colorInfo:s,provider:t});return Array.isArray(o)}};async function p_e(r,t,e,i,n){let o=!1,s,a=[],l=t.ordered(e);for(let d=l.length-1;d>=0;d--){let c=l[d];if(c instanceof qy)s=c;else try{await r.compute(c,e,i,a)&&(o=!0)}catch(p){zo(p)}}return o?a:s&&n?(await r.compute(s,e,i,a),a):[]}var h_e=Object.create({}),Gh=class extends R{constructor(e,i,n,o){super();this._editor=e;this._configurationService=i;this._languageFeaturesService=n;this._debounceInformation=o.for(n.colorProvider,"Document Colors",{min:Gh.RECOMPUTE_TIME}),this._register(e.onDidChangeModel(()=>{this._isColorDecoratorsEnabled=this.isEnabled(),this.updateColors()})),this._register(e.onDidChangeModelLanguage(()=>this.updateColors())),this._register(n.colorProvider.onDidChange(()=>this.updateColors())),this._register(e.onDidChangeConfiguration(s=>{let a=this._isColorDecoratorsEnabled;this._isColorDecoratorsEnabled=this.isEnabled(),this._isDefaultColorDecoratorsEnabled=this._editor.getOption(149);let l=a!==this._isColorDecoratorsEnabled||s.hasChanged(21),d=s.hasChanged(149);(l||d)&&(this._isColorDecoratorsEnabled?this.updateColors():this.removeAllDecorations())})),this._timeoutTimer=null,this._computePromise=null,this._isColorDecoratorsEnabled=this.isEnabled(),this._isDefaultColorDecoratorsEnabled=this._editor.getOption(149),this.updateColors()}static ID="editor.contrib.colorDetector";static RECOMPUTE_TIME=1e3;_localToDispose=this._register(new B);_computePromise;_timeoutTimer;_debounceInformation;_decorationsIds=[];_colorDatas=new Map;_colorDecoratorIds=this._editor.createDecorationsCollection();_isColorDecoratorsEnabled;_isDefaultColorDecoratorsEnabled;_ruleFactory=new _E(this._editor);_decoratorLimitReporter=new JX;isEnabled(){let e=this._editor.getModel();if(!e)return!1;let i=e.getLanguageId(),n=this._configurationService.getValue(i);if(n&&typeof n=="object"){let o=n.colorDecorators;if(o&&o.enable!==void 0&&!o.enable)return o.enable}return this._editor.getOption(20)}get limitReporter(){return this._decoratorLimitReporter}static get(e){return e.getContribution(this.ID)}dispose(){this.stop(),this.removeAllDecorations(),super.dispose()}updateColors(){if(this.stop(),!this._isColorDecoratorsEnabled)return;let e=this._editor.getModel();!e||!this._languageFeaturesService.colorProvider.has(e)||(this._localToDispose.add(this._editor.onDidChangeModelContent(()=>{this._timeoutTimer||(this._timeoutTimer=new Qs,this._timeoutTimer.cancelAndSet(()=>{this._timeoutTimer=null,this.beginCompute()},this._debounceInformation.get(e)))})),this.beginCompute())}async beginCompute(){this._computePromise=va(async e=>{let i=this._editor.getModel();if(!i)return[];let n=new Ko(!1),o=await YU(this._languageFeaturesService.colorProvider,i,e,this._isDefaultColorDecoratorsEnabled);return this._debounceInformation.update(i,n.elapsed()),o});try{let e=await this._computePromise;this.updateDecorations(e),this.updateColorDecorators(e),this._computePromise=null}catch(e){Xe(e)}}stop(){this._timeoutTimer&&(this._timeoutTimer.cancel(),this._timeoutTimer=null),this._computePromise&&(this._computePromise.cancel(),this._computePromise=null),this._localToDispose.clear()}updateDecorations(e){let i=e.map(n=>({range:{startLineNumber:n.colorInfo.range.startLineNumber,startColumn:n.colorInfo.range.startColumn,endLineNumber:n.colorInfo.range.endLineNumber,endColumn:n.colorInfo.range.endColumn},options:Ii.EMPTY}));this._editor.changeDecorations(n=>{this._decorationsIds=n.deltaDecorations(this._decorationsIds,i),this._colorDatas=new Map,this._decorationsIds.forEach((o,s)=>this._colorDatas.set(o,e[s]))})}_colorDecorationClassRefs=this._register(new B);updateColorDecorators(e){this._colorDecorationClassRefs.clear();let i=[],n=this._editor.getOption(21);for(let s=0;s<e.length&&i.length<n;s++){let{red:a,green:l,blue:d,alpha:c}=e[s].colorInfo.color,p=new xt(Math.round(a*255),Math.round(l*255),Math.round(d*255),c),h=`rgba(${p.r}, ${p.g}, ${p.b}, ${p.a})`,m=this._colorDecorationClassRefs.add(this._ruleFactory.createClassNameRef({backgroundColor:h}));i.push({range:{startLineNumber:e[s].colorInfo.range.startLineNumber,startColumn:e[s].colorInfo.range.startColumn,endLineNumber:e[s].colorInfo.range.endLineNumber,endColumn:e[s].colorInfo.range.endColumn},options:{description:"colorDetector",before:{content:Jg,inlineClassName:`${m.className} colorpicker-color-decoration`,inlineClassNameAffectsLetterSpacing:!0,attachedData:h_e}}})}let o=n<e.length?n:!1;this._decoratorLimitReporter.update(e.length,o),this._colorDecoratorIds.set(i)}removeAllDecorations(){this._editor.removeDecorations(this._decorationsIds),this._decorationsIds=[],this._colorDecoratorIds.clear(),this._colorDecorationClassRefs.clear()}getColorData(e){let i=this._editor.getModel();if(!i)return null;let n=i.getDecorationsInRange(L.fromPositions(e,e)).filter(o=>this._colorDatas.has(o.id));return n.length===0?null:this._colorDatas.get(n[0].id)}isColorDecoration(e){return this._colorDecoratorIds.has(e)}};Gh=E([b(1,se),b(2,ni),b(3,Ny)],Gh);var JX=class{_onDidChange=new x;onDidChange=this._onDidChange.event;_computed=0;_limited=!1;get computed(){return this._computed}get limited(){return this._limited}update(t,e){(t!==this._computed||e!==this._limited)&&(this._computed=t,this._limited=e,this._onDidChange.fire())}};var QU=class{constructor(t,e,i){this.presentationIndex=i;this.originalColor=t,this._color=t,this._colorPresentations=e}originalColor;_color;get color(){return this._color}set color(t){this._color.equals(t)||(this._color=t,this._onDidChangeColor.fire(t))}get presentation(){return this.colorPresentations[this.presentationIndex]}_colorPresentations;get colorPresentations(){return this._colorPresentations}set colorPresentations(t){this._colorPresentations=t,this.presentationIndex>t.length-1&&(this.presentationIndex=0),this._onDidChangePresentation.fire(this.presentation)}_onColorFlushed=new x;onColorFlushed=this._onColorFlushed.event;_onDidChangeColor=new x;onDidChangeColor=this._onDidChangeColor.event;_onDidChangePresentation=new x;onDidChangePresentation=this._onDidChangePresentation.event;selectNextColorPresentation(){this.presentationIndex=(this.presentationIndex+1)%this.colorPresentations.length,this.flushColor(),this._onDidChangePresentation.fire(this.presentation)}guessColorPresentation(t,e){let i=-1;for(let n=0;n<this.colorPresentations.length;n++)if(e.toLowerCase()===this.colorPresentations[n].label){i=n;break}if(i===-1){let n=e.split("(")[0].toLowerCase();for(let o=0;o<this.colorPresentations.length;o++)if(this.colorPresentations[o].label.toLowerCase().startsWith(n)){i=o;break}}i!==-1&&i!==this.presentationIndex&&(this.presentationIndex=i,this._onDidChangePresentation.fire(this.presentation))}flushColor(){this._onColorFlushed.fire(this._color)}};var ehe=J,ZU=class extends R{constructor(e,i,n){super();this.model=i;this.pixelRatio=n;this._domNode=ehe(".saturation-wrap"),U(e,this._domNode),this._canvas=document.createElement("canvas"),this._canvas.className="saturation-box",U(this._domNode,this._canvas),this.selection=ehe(".saturation-selection"),U(this._domNode,this.selection),this.layout(),this._register(F(this._domNode,Q.POINTER_DOWN,o=>this.onPointerDown(o))),this._register(this.model.onDidChangeColor(this.onDidChangeColor,this)),this.monitor=null}_domNode;selection;_canvas;width;height;monitor;_onDidChange=new x;onDidChange=this._onDidChange.event;_onColorFlushed=new x;onColorFlushed=this._onColorFlushed.event;get domNode(){return this._domNode}get canvas(){return this._canvas}onPointerDown(e){if(!e.target||!(e.target instanceof Element))return;this.monitor=this._register(new Hl);let i=Oi(this._domNode);e.target!==this.selection&&this.onDidChangePosition(e.offsetX,e.offsetY),this.monitor.startMonitoring(e.target,e.pointerId,e.buttons,o=>this.onDidChangePosition(o.pageX-i.left,o.pageY-i.top),()=>null);let n=F(e.target.ownerDocument,Q.POINTER_UP,()=>{this._onColorFlushed.fire(),n.dispose(),this.monitor&&(this.monitor.stopMonitoring(!0),this.monitor=null)},!0)}onDidChangePosition(e,i){let n=Math.max(0,Math.min(1,e/this.width)),o=Math.max(0,Math.min(1,1-i/this.height));this.paintSelection(n,o),this._onDidChange.fire({s:n,v:o})}layout(){this.width=this._domNode.offsetWidth,this.height=this._domNode.offsetHeight,this._canvas.width=this.width*this.pixelRatio,this._canvas.height=this.height*this.pixelRatio,this.paint();let e=this.model.color.hsva;this.paintSelection(e.s,e.v)}paint(){let e=this.model.color.hsva,i=new j(new pc(e.h,1,1,1)),n=this._canvas.getContext("2d"),o=n.createLinearGradient(0,0,this._canvas.width,0);o.addColorStop(0,"rgba(255, 255, 255, 1)"),o.addColorStop(.5,"rgba(255, 255, 255, 0.5)"),o.addColorStop(1,"rgba(255, 255, 255, 0)");let s=n.createLinearGradient(0,0,0,this._canvas.height);s.addColorStop(0,"rgba(0, 0, 0, 0)"),s.addColorStop(1,"rgba(0, 0, 0, 1)"),n.rect(0,0,this._canvas.width,this._canvas.height),n.fillStyle=j.Format.CSS.format(i),n.fill(),n.fillStyle=o,n.fill(),n.fillStyle=s,n.fill()}paintSelection(e,i){this.selection.style.left=`${e*this.width}px`,this.selection.style.top=`${this.height-i*this.height}px`}onDidChangeColor(e){if(this.monitor&&this.monitor.isMonitoring())return;this.paint();let i=e.hsva;this.paintSelection(i.s,i.v)}};var JU=class extends R{_button;_onClicked=this._register(new x);onClicked=this._onClicked.event;constructor(t){super(),this._button=U(t,document.createElement("button")),this._button.classList.add("insert-button"),this._button.textContent="Insert",this._register(F(this._button,Q.CLICK,()=>{this._onClicked.fire()}))}get button(){return this._button}};var SP=J,e2=class extends R{constructor(e,i,n=!1){super();this.model=i;n?(this.domNode=U(e,SP(".standalone-strip")),this.overlay=U(this.domNode,SP(".standalone-overlay"))):(this.domNode=U(e,SP(".strip")),this.overlay=U(this.domNode,SP(".overlay"))),this.slider=U(this.domNode,SP(".slider")),this.slider.style.top="0px",this._register(F(this.domNode,Q.POINTER_DOWN,o=>this.onPointerDown(o))),this._register(i.onDidChangeColor(this.onDidChangeColor,this)),this.layout()}domNode;overlay;slider;height;_onDidChange=new x;onDidChange=this._onDidChange.event;_onColorFlushed=new x;onColorFlushed=this._onColorFlushed.event;layout(){this.height=this.domNode.offsetHeight-this.slider.offsetHeight;let e=this.getValue(this.model.color);this.updateSliderPosition(e)}onDidChangeColor(e){let i=this.getValue(e);this.updateSliderPosition(i)}onPointerDown(e){if(!e.target||!(e.target instanceof Element))return;let i=this._register(new Hl),n=Oi(this.domNode);this.domNode.classList.add("grabbing"),e.target!==this.slider&&this.onDidChangeTop(e.offsetY),i.startMonitoring(e.target,e.pointerId,e.buttons,s=>this.onDidChangeTop(s.pageY-n.top),()=>null);let o=F(e.target.ownerDocument,Q.POINTER_UP,()=>{this._onColorFlushed.fire(),o.dispose(),i.stopMonitoring(!0),this.domNode.classList.remove("grabbing")},!0)}onDidChangeTop(e){let i=Math.max(0,Math.min(1,1-e/this.height));this.updateSliderPosition(i),this._onDidChange.fire(i)}updateSliderPosition(e){this.slider.style.top=`${(1-e)*this.height}px`}},t2=class extends e2{constructor(t,e,i=!1){super(t,e,i),this.domNode.classList.add("opacity-strip"),this.onDidChangeColor(this.model.color)}onDidChangeColor(t){super.onDidChangeColor(t);let{r:e,g:i,b:n}=t.rgba,o=new j(new xt(e,i,n,1)),s=new j(new xt(e,i,n,0));this.overlay.style.background=`linear-gradient(to bottom, ${o} 0%, ${s} 100%)`}getValue(t){return t.hsva.a}},i2=class extends e2{constructor(t,e,i=!1){super(t,e,i),this.domNode.classList.add("hue-strip")}getValue(t){return 1-t.hsva.h/360}};var m_e=J,n2=class extends R{constructor(e,i,n,o=!1){super();this.model=i;this.pixelRatio=n;this._domNode=m_e(".colorpicker-body"),U(e,this._domNode),this._saturationBox=new ZU(this._domNode,this.model,this.pixelRatio),this._register(this._saturationBox),this._register(this._saturationBox.onDidChange(this.onDidSaturationValueChange,this)),this._register(this._saturationBox.onColorFlushed(this.flushColor,this)),this._opacityStrip=new t2(this._domNode,this.model,o),this._register(this._opacityStrip),this._register(this._opacityStrip.onDidChange(this.onDidOpacityChange,this)),this._register(this._opacityStrip.onColorFlushed(this.flushColor,this)),this._hueStrip=new i2(this._domNode,this.model,o),this._register(this._hueStrip),this._register(this._hueStrip.onDidChange(this.onDidHueChange,this)),this._register(this._hueStrip.onColorFlushed(this.flushColor,this)),o&&(this._insertButton=this._register(new JU(this._domNode)),this._domNode.classList.add("standalone-colorpicker"))}_domNode;_saturationBox;_hueStrip;_opacityStrip;_insertButton=null;flushColor(){this.model.flushColor()}onDidSaturationValueChange({s:e,v:i}){let n=this.model.color.hsva;this.model.color=new j(new pc(n.h,e,i,n.a))}onDidOpacityChange(e){let i=this.model.color.hsva;this.model.color=new j(new pc(i.h,i.s,i.v,e))}onDidHueChange(e){let i=this.model.color.hsva,n=(1-e)*360;this.model.color=new j(new pc(n===360?0:n,i.s,i.v,i.a))}get domNode(){return this._domNode}get saturationBox(){return this._saturationBox}get opacityStrip(){return this._opacityStrip}get hueStrip(){return this._hueStrip}get enterButton(){return this._insertButton}layout(){this._saturationBox.layout(),this._opacityStrip.layout(),this._hueStrip.layout()}};var g_e=J,o2=class extends R{_button;_onClicked=this._register(new x);onClicked=this._onClicked.event;constructor(t){super(),this._button=document.createElement("div"),this._button.classList.add("close-button"),U(t,this._button);let e=document.createElement("div");e.classList.add("close-button-inner-div"),U(this._button,e),U(e,g_e(".button"+de.asCSSSelector(ke("color-picker-close",N.close,u("closeIcon","Icon to close the color picker"))))).classList.add("close-icon"),this._register(F(this._button,Q.CLICK,()=>{this._onClicked.fire()}))}};var r2=J,s2=class extends R{constructor(e,i,n,o=!1){super();this.model=i;this.showingStandaloneColorPicker=o;this._domNode=r2(".colorpicker-header"),U(e,this._domNode),this._pickedColorNode=U(this._domNode,r2(".picked-color")),U(this._pickedColorNode,r2("span.codicon.codicon-color-mode")),this._pickedColorPresentation=U(this._pickedColorNode,document.createElement("span")),this._pickedColorPresentation.classList.add("picked-color-presentation");let s=u("clickToToggleColorOptions","Click to toggle color options (rgb/hsl/hex)");this._pickedColorNode.setAttribute("title",s),this._originalColorNode=U(this._domNode,r2(".original-color")),this._originalColorNode.style.backgroundColor=j.Format.CSS.format(this.model.originalColor)||"",this.backgroundColor=n.getColorTheme().getColor(Mf)||j.white,this._register(n.onDidColorThemeChange(a=>{this.backgroundColor=a.getColor(Mf)||j.white})),this._register(F(this._pickedColorNode,Q.CLICK,()=>this.model.selectNextColorPresentation())),this._register(F(this._originalColorNode,Q.CLICK,()=>{this.model.color=this.model.originalColor,this.model.flushColor()})),this._register(i.onDidChangeColor(this.onDidChangeColor,this)),this._register(i.onDidChangePresentation(this.onDidChangePresentation,this)),this._pickedColorNode.style.backgroundColor=j.Format.CSS.format(i.color)||"",this._pickedColorNode.classList.toggle("light",i.color.rgba.a<.5?this.backgroundColor.isLighter():i.color.isLighter()),this.onDidChangeColor(this.model.color),this.showingStandaloneColorPicker&&(this._domNode.classList.add("standalone-colorpicker"),this._closeButton=this._register(new o2(this._domNode)))}_domNode;_pickedColorNode;_pickedColorPresentation;_originalColorNode;_closeButton=null;backgroundColor;get domNode(){return this._domNode}get closeButton(){return this._closeButton}get pickedColorNode(){return this._pickedColorNode}get originalColorNode(){return this._originalColorNode}onDidChangeColor(e){this._pickedColorNode.style.backgroundColor=j.Format.CSS.format(e)||"",this._pickedColorNode.classList.toggle("light",e.rgba.a<.5?this.backgroundColor.isLighter():e.isLighter()),this.onDidChangePresentation()}onDidChangePresentation(){this._pickedColorPresentation.textContent=this.model.presentation?this.model.presentation.label:""}};var f_e=J,a2=class r extends ko{constructor(e,i,n,o,s=!1){super();this.model=i;this.pixelRatio=n;this._register(Zs.getInstance(ue(e)).onDidChange(()=>this.layout())),this._domNode=f_e(".colorpicker-widget"),e.appendChild(this._domNode),this.header=this._register(new s2(this._domNode,this.model,o,s)),this.body=this._register(new n2(this._domNode,this.model,this.pixelRatio,s))}static ID="editor.contrib.colorPickerWidget";_domNode;body;header;getId(){return r.ID}layout(){this.body.layout()}get domNode(){return this._domNode}};var l2=class{constructor(t,e,i,n){this.owner=t;this.range=e;this.model=i;this.provider=n}},$y=class{constructor(t,e){this._editor=t;this._themeService=e}hoverOrdinal=2;_color=null;async createColorHover(t,e,i){if(!this._editor.hasModel()||!Gh.get(this._editor))return null;let o=await YU(i,this._editor.getModel(),Pt.None),s=null,a=null;for(let p of o){let h=p.colorInfo;L.containsRange(h.range,t.range)&&(s=h,a=p.provider)}let l=s??t,d=a??e,c=!!s;return{colorHover:await d2(this,this._editor.getModel(),l,d),foundInEditor:c}}async updateEditorModel(t){if(!this._editor.hasModel())return;let e=t.model,i=new L(t.range.startLineNumber,t.range.startColumn,t.range.endLineNumber,t.range.endColumn);this._color&&(await CP(this._editor.getModel(),e,this._color,i,t),i=eY(this._editor,i,e))}renderHoverParts(t,e){return c2(this,this._editor,this._themeService,e,t)}set color(t){this._color=t}get color(){return this._color}};$y=E([b(1,Fe)],$y);async function d2(r,t,e,i){let n=t.getValueInRange(e.range),{red:o,green:s,blue:a,alpha:l}=e.color,d=new xt(Math.round(o*255),Math.round(s*255),Math.round(a*255),l),c=new j(d),p=await ZX(t,e,i,Pt.None),h=new QU(c,[],0);return h.colorPresentations=p||[],h.guessColorPresentation(c,n),r instanceof pv?new u2(r,L.lift(e.range),h,i):new l2(r,L.lift(e.range),h,i)}function c2(r,t,e,i,n){if(i.length===0||!t.hasModel())return;if(n.setMinimumDimensions){let h=t.getOption(68)+8;n.setMinimumDimensions(new Ge(302,h))}let o=new B,s=i[0],a=t.getModel(),l=s.model,d=o.add(new a2(n.fragment,l,t.getOption(145),e,r instanceof $y)),c=!1,p=new L(s.range.startLineNumber,s.range.startColumn,s.range.endLineNumber,s.range.endColumn);if(r instanceof $y){let h=s.model.color;r.color=h,CP(a,l,h,p,s),o.add(l.onColorFlushed(m=>{r.color=m}))}else o.add(l.onColorFlushed(async h=>{await CP(a,l,h,p,s),c=!0,p=eY(t,p,l)}));return o.add(l.onDidChangeColor(h=>{CP(a,l,h,p,s)})),o.add(t.onDidChangeModelContent(h=>{c?c=!1:(n.hide(),t.focus())})),{hoverPart:s,colorPicker:d,disposables:o}}function eY(r,t,e){let i=[],n=e.presentation.textEdit??{range:t,text:e.presentation.label,forceMoveMarkers:!1};i.push(n),e.presentation.additionalTextEdits&&i.push(...e.presentation.additionalTextEdits);let o=L.lift(n.range),s=r.getModel()._setTrackedRange(null,o,3);return r.executeEdits("colorpicker",i),r.pushUndoStop(),r.getModel()._getTrackedRange(s)??o}async function CP(r,t,e,i,n){let o=await ZX(r,{range:i,color:{red:e.rgba.r/255,green:e.rgba.g/255,blue:e.rgba.b/255,alpha:e.rgba.a}},n.provider,Pt.None);t.colorPresentations=o||[]}var u2=class{constructor(t,e,i,n){this.owner=t;this.range=e;this.model=i;this.provider=n}forceShowAtRange=!0;isValidForHoverAnchor(t){return t.type===1&&this.range.startColumn<=t.range.startColumn&&this.range.endColumn>=t.range.endColumn}},pv=class{constructor(t,e){this._editor=t;this._themeService=e}hoverOrdinal=2;_colorPicker;computeSync(t,e){return[]}computeAsync(t,e,i){return gs.fromPromise(this._computeAsync(t,e,i))}async _computeAsync(t,e,i){if(!this._editor.hasModel())return[];let n=Gh.get(this._editor);if(!n)return[];for(let o of e){if(!n.isColorDecoration(o))continue;let s=n.getColorData(o.range.getStartPosition());if(s)return[await d2(this,this._editor.getModel(),s.colorInfo,s.provider)]}return[]}renderHoverParts(t,e){let i=c2(this,this._editor,this._themeService,e,t);if(!i)return new cv([]);this._colorPicker=i.colorPicker;let n={hoverPart:i.hoverPart,hoverElement:this._colorPicker.domNode,dispose(){i.disposables.dispose()}};return new cv([n])}getAccessibleContent(t){return u("hoverAccessibilityColorParticipant","There is a color picker here.")}handleResize(){this._colorPicker?.layout()}isColorPickerVisible(){return!!this._colorPicker}};pv=E([b(1,Fe)],pv);function tY(r,t){return!!r[t]}var wP=class{target;hasTriggerModifier;hasSideBySideModifier;isNoneOrSingleMouseDown;isLeftClick;isMiddleClick;isRightClick;constructor(t,e){this.target=t.target,this.isLeftClick=t.event.leftButton,this.isMiddleClick=t.event.middleButton,this.isRightClick=t.event.rightButton,this.hasTriggerModifier=tY(t.event,e.triggerModifier),this.hasSideBySideModifier=tY(t.event,e.triggerSideBySideModifier),this.isNoneOrSingleMouseDown=t.event.detail<=1}},p2=class{keyCodeIsTriggerKey;keyCodeIsSideBySideKey;hasTriggerModifier;constructor(t,e){this.keyCodeIsTriggerKey=t.keyCode===e.triggerKey,this.keyCodeIsSideBySideKey=t.keyCode===e.triggerSideBySideKey,this.hasTriggerModifier=tY(t,e.triggerModifier)}},$x=class{triggerKey;triggerModifier;triggerSideBySideKey;triggerSideBySideModifier;constructor(t,e,i,n){this.triggerKey=t,this.triggerModifier=e,this.triggerSideBySideKey=i,this.triggerSideBySideModifier=n}equals(t){return this.triggerKey===t.triggerKey&&this.triggerModifier===t.triggerModifier&&this.triggerSideBySideKey===t.triggerSideBySideKey&&this.triggerSideBySideModifier===t.triggerSideBySideModifier}};function the(r){return r==="altKey"?ye?new $x(57,"metaKey",6,"altKey"):new $x(5,"ctrlKey",6,"altKey"):ye?new $x(6,"altKey",57,"metaKey"):new $x(6,"altKey",5,"ctrlKey")}var h2=class extends R{_onMouseMoveOrRelevantKeyDown=this._register(new x);onMouseMoveOrRelevantKeyDown=this._onMouseMoveOrRelevantKeyDown.event;_onExecute=this._register(new x);onExecute=this._onExecute.event;_onCancel=this._register(new x);onCancel=this._onCancel.event;_editor;_extractLineNumberFromMouseEvent;_opts;_lastMouseMoveEvent;_hasTriggerKeyOnMouseDown;_lineNumberOnMouseDown;constructor(t,e){super(),this._editor=t,this._extractLineNumberFromMouseEvent=e?.extractLineNumberFromMouseEvent??(i=>i.target.position?i.target.position.lineNumber:0),this._opts=the(this._editor.getOption(79)),this._lastMouseMoveEvent=null,this._hasTriggerKeyOnMouseDown=!1,this._lineNumberOnMouseDown=0,this._register(this._editor.onDidChangeConfiguration(i=>{if(i.hasChanged(79)){let n=the(this._editor.getOption(79));if(this._opts.equals(n))return;this._opts=n,this._lastMouseMoveEvent=null,this._hasTriggerKeyOnMouseDown=!1,this._lineNumberOnMouseDown=0,this._onCancel.fire()}})),this._register(this._editor.onMouseMove(i=>this._onEditorMouseMove(new wP(i,this._opts)))),this._register(this._editor.onMouseDown(i=>this._onEditorMouseDown(new wP(i,this._opts)))),this._register(this._editor.onMouseUp(i=>this._onEditorMouseUp(new wP(i,this._opts)))),this._register(this._editor.onKeyDown(i=>this._onEditorKeyDown(new p2(i,this._opts)))),this._register(this._editor.onKeyUp(i=>this._onEditorKeyUp(new p2(i,this._opts)))),this._register(this._editor.onMouseDrag(()=>this._resetHandler())),this._register(this._editor.onDidChangeCursorSelection(i=>this._onDidChangeCursorSelection(i))),this._register(this._editor.onDidChangeModel(i=>this._resetHandler())),this._register(this._editor.onDidChangeModelContent(()=>this._resetHandler())),this._register(this._editor.onDidScrollChange(i=>{(i.scrollTopChanged||i.scrollLeftChanged)&&this._resetHandler()}))}_onDidChangeCursorSelection(t){t.selection&&t.selection.startColumn!==t.selection.endColumn&&this._resetHandler()}_onEditorMouseMove(t){this._lastMouseMoveEvent=t,this._onMouseMoveOrRelevantKeyDown.fire([t,null])}_onEditorMouseDown(t){this._hasTriggerKeyOnMouseDown=t.hasTriggerModifier,this._lineNumberOnMouseDown=this._extractLineNumberFromMouseEvent(t)}_onEditorMouseUp(t){let e=this._extractLineNumberFromMouseEvent(t);this._hasTriggerKeyOnMouseDown&&this._lineNumberOnMouseDown&&this._lineNumberOnMouseDown===e&&this._onExecute.fire(t)}_onEditorKeyDown(t){this._lastMouseMoveEvent&&(t.keyCodeIsTriggerKey||t.keyCodeIsSideBySideKey&&t.hasTriggerModifier)?this._onMouseMoveOrRelevantKeyDown.fire([this._lastMouseMoveEvent,t]):t.hasTriggerModifier&&this._onCancel.fire()}_onEditorKeyUp(t){t.keyCodeIsTriggerKey&&this._onCancel.fire()}_resetHandler(){this._lastMouseMoveEvent=null,this._hasTriggerKeyOnMouseDown=!1,this._onCancel.fire()}};var EP=class{constructor(t,e){this.range=t;this.direction=e}},iY=class r{constructor(t,e,i){this.hint=t;this.anchor=e;this.provider=i}_isResolved=!1;_currentResolve;with(t){let e=new r(this.hint,t.anchor,this.provider);return e._isResolved=this._isResolved,e._currentResolve=this._currentResolve,e}async resolve(t){if(typeof this.provider.resolveInlayHint=="function"){if(this._currentResolve)return await this._currentResolve,t.isCancellationRequested?void 0:this.resolve(t);this._isResolved||(this._currentResolve=this._doResolve(t).finally(()=>this._currentResolve=void 0)),await this._currentResolve}}async _doResolve(t){try{let e=await Promise.resolve(this.provider.resolveInlayHint(this.hint,t));this.hint.tooltip=e?.tooltip??this.hint.tooltip,this.hint.label=e?.label??this.hint.label,this.hint.textEdits=e?.textEdits??this.hint.textEdits,this._isResolved=!0}catch(e){zo(e),this._isResolved=!1}}},xP=class r{static _emptyInlayHintList=Object.freeze({dispose(){},hints:[]});static async create(t,e,i,n){let o=[],s=t.ordered(e).reverse().map(a=>i.map(async l=>{try{let d=await a.provideInlayHints(e,l,n);(d?.hints.length||a.onDidChangeInlayHints)&&o.push([d??r._emptyInlayHintList,a])}catch(d){zo(d)}}));if(await Promise.all(s.flat()),n.isCancellationRequested||e.isDisposed())throw new wo;return new r(i,o,e)}_disposables=new B;items;ranges;provider;constructor(t,e,i){this.ranges=t,this.provider=new Set;let n=[];for(let[o,s]of e){this._disposables.add(o),this.provider.add(s);for(let a of o.hints){let l=i.validatePosition(a.position),d="before",c=r._getRangeAtPosition(i,l),p;c.getStartPosition().isBefore(l)?(p=L.fromPositions(c.getStartPosition(),l),d="after"):(p=L.fromPositions(l,c.getEndPosition()),d="before"),n.push(new iY(a,new EP(p,d),s))}}this.items=n.sort((o,s)=>H.compare(o.hint.position,s.hint.position))}dispose(){this._disposables.dispose()}static _getRangeAtPosition(t,e){let i=e.lineNumber,n=t.getWordAtPosition(e);if(n)return new L(i,n.startColumn,i,n.endColumn);t.tokenization.tokenizeIfCheap(i);let o=t.tokenization.getLineTokens(i),s=e.column-1,a=o.findTokenIndexAtOffset(s),l=o.getStartOffset(a),d=o.getEndOffset(a);return d-l===1&&(l===s&&a>1?(l=o.getStartOffset(a-1),d=o.getEndOffset(a-1)):d===s&&a<o.getCount()-1&&(l=o.getStartOffset(a+1),d=o.getEndOffset(a+1))),new L(i,l+1,i,d+1)}};function ihe(r){return Z.from({scheme:Ie.command,path:r.id,query:r.arguments&&encodeURIComponent(JSON.stringify(r.arguments))}).toString()}var nY=q("IPeekViewService");gi(nY,class{_widgets=new Map;addExclusiveWidget(r,t){let e=this._widgets.get(r);e&&(e.listener.dispose(),e.widget.dispose());let i=()=>{let n=this._widgets.get(r);n&&n.widget===t&&(n.listener.dispose(),this._widgets.delete(r))};this._widgets.set(r,{widget:t,listener:t.onDidClose(i)})}},1);var ha;(e=>(e.inPeekEditor=new A("inReferenceSearchEditor",!0,u("inReferenceSearchEditor","Whether the current code editor is embedded inside peek")),e.notInPeekEditor=e.inPeekEditor.toNegated()))(ha||={});var jx=class{static ID="editor.contrib.referenceController";constructor(t,e){t instanceof ml&&ha.inPeekEditor.bindTo(e)}dispose(){}};jx=E([b(1,re)],jx);gr(jx.ID,jx,0);function nhe(r){let t=r.get(En).getFocusedCodeEditor();return t instanceof ml?t.getParentEditor():t}var b_e={headerBackgroundColor:j.white,primaryHeadingColor:j.fromHex("#333333"),secondaryHeadingColor:j.fromHex("#6c6c6cb3")},Xx=class extends Fb{constructor(e,i,n){super(e,i);this.instantiationService=n;Bs(this.options,b_e,!1)}_onDidClose=new x;onDidClose=this._onDidClose.event;disposed;_headElement;_titleElement;_primaryHeading;_secondaryHeading;_metaHeading;_actionbarWidget;_bodyElement;dispose(){this.disposed||(this.disposed=!0,super.dispose(),this._onDidClose.fire(this))}style(e){let i=this.options;e.headerBackgroundColor&&(i.headerBackgroundColor=e.headerBackgroundColor),e.primaryHeadingColor&&(i.primaryHeadingColor=e.primaryHeadingColor),e.secondaryHeadingColor&&(i.secondaryHeadingColor=e.secondaryHeadingColor),super.style(e)}_applyStyles(){super._applyStyles();let e=this.options;this._headElement&&e.headerBackgroundColor&&(this._headElement.style.backgroundColor=e.headerBackgroundColor.toString()),this._primaryHeading&&e.primaryHeadingColor&&(this._primaryHeading.style.color=e.primaryHeadingColor.toString()),this._secondaryHeading&&e.secondaryHeadingColor&&(this._secondaryHeading.style.color=e.secondaryHeadingColor.toString()),this._bodyElement&&e.frameColor&&(this._bodyElement.style.borderColor=e.frameColor.toString())}_fillContainer(e){this.setCssClass("peekview-widget"),this._headElement=J(".head"),this._bodyElement=J(".body"),this._fillHead(this._headElement),this._fillBody(this._bodyElement),e.appendChild(this._headElement),e.appendChild(this._bodyElement)}_fillHead(e,i){this._titleElement=J(".peekview-title"),this.options.supportOnTitleClick&&(this._titleElement.classList.add("clickable"),Ut(this._titleElement,"click",s=>this._onTitleClick(s))),U(this._headElement,this._titleElement),this._fillTitleIcon(this._titleElement),this._primaryHeading=J("span.filename"),this._secondaryHeading=J("span.dirname"),this._metaHeading=J("span.meta"),U(this._titleElement,this._primaryHeading,this._secondaryHeading,this._metaHeading);let n=J(".peekview-actions");U(this._headElement,n);let o=this._getActionBarOptions();this._actionbarWidget=new Fi(n,o),this._disposables.add(this._actionbarWidget),i||this._actionbarWidget.push(new et("peekview.close",u("label.close","Close"),de.asClassName(N.close),!0,()=>(this.dispose(),Promise.resolve())),{label:!1,icon:!0})}_fillTitleIcon(e){}_getActionBarOptions(){return{actionViewItemProvider:aa.bind(void 0,this.instantiationService),orientation:0}}_onTitleClick(e){}setTitle(e,i){this._primaryHeading&&this._secondaryHeading&&(this._primaryHeading.innerText=e,this._primaryHeading.setAttribute("title",e),i?this._secondaryHeading.innerText=i:ai(this._secondaryHeading))}setMetaTitle(e){this._metaHeading&&(e?(this._metaHeading.innerText=e,rn(this._metaHeading)):ji(this._metaHeading))}_doLayout(e,i){if(!this._isShowing&&e<0){this.dispose();return}let n=Math.ceil(this.editor.getOption(68)*1.2),o=Math.round(e-(n+2));this._doLayoutHead(n,i),this._doLayoutBody(o,i)}_doLayoutHead(e,i){this._headElement&&(this._headElement.style.height=`${e}px`,this._headElement.style.lineHeight=this._headElement.style.height)}_doLayoutBody(e,i){this._bodyElement&&(this._bodyElement.style.height=`${e}px`)}};Xx=E([b(2,ne)],Xx);var ohe=T("peekViewTitle.background",{dark:"#252526",light:"#F3F3F3",hcDark:j.black,hcLight:j.white},u("peekViewTitleBackground","Background color of the peek view title area.")),rhe=T("peekViewTitleLabel.foreground",{dark:j.white,light:j.black,hcDark:j.white,hcLight:Qo},u("peekViewTitleForeground","Color of the peek view title.")),she=T("peekViewTitleDescription.foreground",{dark:"#ccccccb3",light:"#616161",hcDark:"#FFFFFF99",hcLight:"#292929"},u("peekViewTitleInfoForeground","Color of the peek view title info.")),ahe=T("peekView.border",{dark:Jr,light:Jr,hcDark:Oe,hcLight:Oe},u("peekViewBorder","Color of the peek view borders and arrow.")),lhe=T("peekViewResult.background",{dark:"#252526",light:"#F3F3F3",hcDark:j.black,hcLight:j.white},u("peekViewResultsBackground","Background color of the peek view result list.")),t8n=T("peekViewResult.lineForeground",{dark:"#bbbbbb",light:"#646465",hcDark:j.white,hcLight:Qo},u("peekViewResultsMatchForeground","Foreground color for line nodes in the peek view result list.")),i8n=T("peekViewResult.fileForeground",{dark:j.white,light:"#1E1E1E",hcDark:j.white,hcLight:Qo},u("peekViewResultsFileForeground","Foreground color for file nodes in the peek view result list.")),n8n=T("peekViewResult.selectionBackground",{dark:"#3399ff33",light:"#3399ff33",hcDark:null,hcLight:null},u("peekViewResultsSelectionBackground","Background color of the selected entry in the peek view result list.")),o8n=T("peekViewResult.selectionForeground",{dark:j.white,light:"#6C6C6C",hcDark:j.white,hcLight:Qo},u("peekViewResultsSelectionForeground","Foreground color of the selected entry in the peek view result list.")),dhe=T("peekViewEditor.background",{dark:"#001F33",light:"#F2F8FC",hcDark:j.black,hcLight:j.white},u("peekViewEditorBackground","Background color of the peek view editor.")),r8n=T("peekViewEditorGutter.background",dhe,u("peekViewEditorGutterBackground","Background color of the gutter in the peek view editor.")),s8n=T("peekViewEditorStickyScroll.background",dhe,u("peekViewEditorStickScrollBackground","Background color of sticky scroll in the peek view editor.")),a8n=T("peekViewResult.matchHighlightBackground",{dark:"#ea5c004d",light:"#ea5c004d",hcDark:null,hcLight:null},u("peekViewResultsMatchHighlight","Match highlight color in the peek view result list.")),l8n=T("peekViewEditor.matchHighlightBackground",{dark:"#ff8f0099",light:"#f5d802de",hcDark:null,hcLight:null},u("peekViewEditorMatchHighlight","Match highlight color in the peek view editor.")),d8n=T("peekViewEditor.matchHighlightBorder",{dark:null,light:null,hcDark:fi,hcLight:fi},u("peekViewEditorMatchHighlightBorder","Match highlight border in the peek view editor."));var Qd=class{constructor(t,e,i,n){this.isProviderFirst=t;this.parent=e;this.link=i;this._rangeCallback=n}id=qk.nextId();_range;get uri(){return this.link.uri}get range(){return this._range??this.link.targetSelectionRange??this.link.range}set range(t){this._range=t,this._rangeCallback(this)}get ariaMessage(){let t=this.parent.getPreview(this)?.preview(this.range);return t?u({key:"aria.oneReference.preview",comment:["Placeholders are: 0: filename, 1:line number, 2: column number, 3: preview snippet of source code"]},"{0} in {1} on line {2} at column {3}",t.value,Ji(this.uri),this.range.startLineNumber,this.range.startColumn):u("aria.oneReference","in {0} on line {1} at column {2}",Ji(this.uri),this.range.startLineNumber,this.range.startColumn)}},oY=class{constructor(t){this._modelReference=t}dispose(){this._modelReference.dispose()}preview(t,e=8){let i=this._modelReference.object.textEditorModel;if(!i)return;let{startLineNumber:n,startColumn:o,endLineNumber:s,endColumn:a}=t,l=i.getWordUntilPosition({lineNumber:n,column:o-e}),d=new L(n,l.startColumn,n,o),c=new L(s,a,s,1073741824),p=i.getValueInRange(d).replace(/^\s+/,""),h=i.getValueInRange(t),m=i.getValueInRange(c).replace(/\s+$/,"");return{value:p+h+m,highlight:{start:p.length,end:p.length+h.length}}}},Tg=class{constructor(t,e){this.parent=t;this.uri=e}children=[];_previews=new Fn;dispose(){_e(this._previews.values()),this._previews.clear()}getPreview(t){return this._previews.get(t.uri)}get ariaMessage(){let t=this.children.length;return t===1?u("aria.fileReferences.1","1 symbol in {0}, full path {1}",Ji(this.uri),this.uri.fsPath):u("aria.fileReferences.N","{0} symbols in {1}, full path {2}",t,Ji(this.uri),this.uri.fsPath)}async resolve(t){if(this._previews.size!==0)return this;for(let e of this.children)if(!this._previews.has(e.uri))try{let i=await t.createModelReference(e.uri);this._previews.set(e.uri,new oY(i))}catch(i){Xe(i)}return this}},Ha=class r{_links;_title;groups=[];references=[];_onDidChangeReferenceRange=new x;onDidChangeReferenceRange=this._onDidChangeReferenceRange.event;constructor(t,e){this._links=t,this._title=e;let[i]=t;t.sort(r._compareReferences);let n;for(let o of t)if((!n||!Ti.isEqual(n.uri,o.uri,!0))&&(n=new Tg(this,o.uri),this.groups.push(n)),n.children.length===0||r._compareReferences(o,n.children[n.children.length-1])!==0){let s=new Qd(i===o,n,o,a=>this._onDidChangeReferenceRange.fire(a));this.references.push(s),n.children.push(s)}}dispose(){_e(this.groups),this._onDidChangeReferenceRange.dispose(),this.groups.length=0}clone(){return new r(this._links,this._title)}get title(){return this._title}get isEmpty(){return this.groups.length===0}get ariaMessage(){return this.isEmpty?u("aria.result.0","No results found"):this.references.length===1?u("aria.result.1","Found 1 symbol in {0}",this.references[0].uri.fsPath):this.groups.length===1?u("aria.result.n1","Found {0} symbols in {1}",this.references.length,this.groups[0].uri.fsPath):u("aria.result.nm","Found {0} symbols in {1} files",this.references.length,this.groups.length)}nextOrPreviousReference(t,e){let{parent:i}=t,n=i.children.indexOf(t),o=i.children.length,s=i.parent.groups.length;return s===1||e&&n+1<o||!e&&n>0?(e?n=(n+1)%o:n=(n+o-1)%o,i.children[n]):(n=i.parent.groups.indexOf(i),e?(n=(n+1)%s,i.parent.groups[n].children[0]):(n=(n+s-1)%s,i.parent.groups[n].children[i.parent.groups[n].children.length-1]))}nearestReference(t,e){let i=this.references.map((n,o)=>({idx:o,prefixLen:bd(n.uri.toString(),t.toString()),offsetDist:Math.abs(n.range.startLineNumber-e.lineNumber)*100+Math.abs(n.range.startColumn-e.column)})).sort((n,o)=>n.prefixLen>o.prefixLen?-1:n.prefixLen<o.prefixLen?1:n.offsetDist<o.offsetDist?-1:n.offsetDist>o.offsetDist?1:0)[0];if(i)return this.references[i.idx]}referenceAt(t,e){for(let i of this.references)if(i.uri.toString()===t.toString()&&L.containsPosition(i.range,e))return i}firstReference(){for(let t of this.references)if(t.isProviderFirst)return t;return this.references[0]}static _compareReferences(t,e){return Ti.compare(t.uri,e.uri)||L.compareRangesUsingStarts(t.range,e.range)}};var Yx=class{constructor(t){this._resolverService=t}hasChildren(t){return t instanceof Ha||t instanceof Tg}getChildren(t){if(t instanceof Ha)return t.groups;if(t instanceof Tg)return t.resolve(this._resolverService).then(e=>e.children);throw new Error("bad tree")}};Yx=E([b(0,Tr)],Yx);var m2=class{getHeight(){return 23}getTemplateId(t){return t instanceof Tg?_g.id:_P.id}},Qx=class{constructor(t){this._keybindingService=t}getKeyboardNavigationLabel(t){if(t instanceof Qd){let e=t.parent.getPreview(t)?.preview(t.range);if(e)return e.value}return Ji(t.uri)}mightProducePrintableCharacter(t){return this._keybindingService.mightProducePrintableCharacter(t)}};Qx=E([b(0,Be)],Qx);var g2=class{getId(t){return t instanceof Qd?t.id:t.uri}},TP=class extends R{constructor(e,i){super();this._labelService=i;let n=document.createElement("div");n.classList.add("reference-file"),this.file=this._register(new gh(n,{supportHighlights:!0})),this.badge=new Aw(U(n,J(".count")),{},cF),e.appendChild(n)}file;badge;set(e,i){let n=Hn(e.uri);this.file.setLabel(this._labelService.getUriBasenameLabel(e.uri),this._labelService.getUriLabel(n,{relative:!0}),{title:this._labelService.getUriLabel(e.uri),matches:i});let o=e.children.length;this.badge.setCount(o),o>1?this.badge.setTitleFormat(u("referencesCount","{0} references",o)):this.badge.setTitleFormat(u("referenceCount","{0} reference",o))}};TP=E([b(1,hi)],TP);var _g=class{constructor(t){this._instantiationService=t}static id="FileReferencesRenderer";templateId=_g.id;renderTemplate(t){return this._instantiationService.createInstance(TP,t)}renderElement(t,e,i){i.set(t.element,qo(t.filterData))}disposeTemplate(t){t.dispose()}};_g=E([b(0,ne)],_g);var rY=class extends R{label;constructor(t){super(),this.label=this._register(new Rr(t))}set(t,e){let i=t.parent.getPreview(t)?.preview(t.range);if(!i||!i.value)this.label.set(`${Ji(t.uri)}:${t.range.startLineNumber+1}:${t.range.startColumn+1}`);else{let{value:n,highlight:o}=i;e&&!Dl.isDefault(e)?(this.label.element.classList.toggle("referenceMatch",!1),this.label.set(n,qo(e))):(this.label.element.classList.toggle("referenceMatch",!0),this.label.set(n,[o]))}}},_P=class r{static id="OneReferenceRenderer";templateId=r.id;renderTemplate(t){return new rY(t)}renderElement(t,e,i){i.set(t.element,t.filterData)}disposeTemplate(t){t.dispose()}},f2=class{getWidgetAriaLabel(){return u("treeAriaLabel","References")}getAriaLabel(t){return t.ariaMessage}};var sY=class r{constructor(t,e){this._editor=t;this._model=e;this._callOnDispose.add(this._editor.onDidChangeModel(()=>this._onModelChanged())),this._onModelChanged()}static DecorationOptions=Ii.register({description:"reference-decoration",stickiness:1,className:"reference-decoration"});_decorations=new Map;_decorationIgnoreSet=new Set;_callOnDispose=new B;_callOnModelChange=new B;dispose(){this._callOnModelChange.dispose(),this._callOnDispose.dispose(),this.removeDecorations()}_onModelChanged(){this._callOnModelChange.clear();let t=this._editor.getModel();if(t){for(let e of this._model.references)if(e.uri.toString()===t.uri.toString()){this._addDecorations(e.parent);return}}}_addDecorations(t){if(!this._editor.hasModel())return;this._callOnModelChange.add(this._editor.getModel().onDidChangeDecorations(()=>this._onDecorationChanged()));let e=[],i=[];for(let n=0,o=t.children.length;n<o;n++){let s=t.children[n];this._decorationIgnoreSet.has(s.id)||s.uri.toString()===this._editor.getModel().uri.toString()&&(e.push({range:s.range,options:r.DecorationOptions}),i.push(n))}this._editor.changeDecorations(n=>{let o=n.deltaDecorations([],e);for(let s=0;s<o.length;s++)this._decorations.set(o[s],t.children[i[s]])})}_onDecorationChanged(){let t=[],e=this._editor.getModel();if(e){for(let[i,n]of this._decorations){let o=e.getDecorationRange(i);if(!o)continue;let s=!1;if(!L.equalsRange(o,n.range)){if(L.spansMultipleLines(o))s=!0;else{let a=n.range.endColumn-n.range.startColumn,l=o.endColumn-o.startColumn;a!==l&&(s=!0)}s?(this._decorationIgnoreSet.add(n.id),t.push(i)):n.range=o}}for(let i=0,n=t.length;i<n;i++)this._decorations.delete(t[i]);this._editor.removeDecorations(t)}}removeDecorations(){this._editor.removeDecorations([...this._decorations.keys()]),this._decorations.clear()}},b2=class{ratio=.7;heightInLines=18;static fromJSON(t){let e,i;try{let n=JSON.parse(t);e=n.ratio,i=n.heightInLines}catch{}return{ratio:e||.7,heightInLines:i||18}}},aY=class extends is{},Zx=class extends Xx{constructor(e,i,n,o,s,a,l,d,c){super(e,{showFrame:!1,showArrow:!0,isResizeable:!0,isAccessible:!0,supportOnTitleClick:!0},a);this._defaultTreeKeyboardSupport=i;this.layoutData=n;this._textModelResolverService=s;this._instantiationService=a;this._peekViewService=l;this._uriLabel=d;this._keybindingService=c;this._applyTheme(o.getColorTheme()),this._callOnDispose.add(o.onDidColorThemeChange(this._applyTheme.bind(this))),this._peekViewService.addExclusiveWidget(e,this),this.create()}_model;_decorationsManager;_disposeOnNewModel=new B;_callOnDispose=new B;_onDidSelectReference=new x;onDidSelectReference=this._onDidSelectReference.event;_tree;_treeContainer;_splitView;_preview;_previewModelReference;_previewNotAvailableMessage;_previewContainer;_messageContainer;_dim=new Ge(0,0);_isClosing=!1;get isClosing(){return this._isClosing}dispose(){this._isClosing=!0,this.setModel(void 0),this._callOnDispose.dispose(),this._disposeOnNewModel.dispose(),_e(this._preview),_e(this._previewNotAvailableMessage),_e(this._tree),_e(this._previewModelReference),this._splitView.dispose(),super.dispose()}_applyTheme(e){let i=e.getColor(ahe)||j.transparent;this.style({arrowColor:i,frameColor:i,headerBackgroundColor:e.getColor(ohe)||j.transparent,primaryHeadingColor:e.getColor(rhe),secondaryHeadingColor:e.getColor(she)})}show(e){super.show(e,this.layoutData.heightInLines||18)}focusOnReferenceTree(){this._tree.domFocus()}focusOnPreviewEditor(){this._preview.focus()}isPreviewEditorFocused(){return this._preview.hasTextFocus()}_onTitleClick(e){this._preview&&this._preview.getModel()&&this._onDidSelectReference.fire({element:this._getFocusedReference(),kind:e.ctrlKey||e.metaKey||e.altKey?"side":"open",source:"title"})}_fillBody(e){this.setCssClass("reference-zone-widget"),this._messageContainer=U(e,J("div.messages")),ji(this._messageContainer),this._splitView=new wc(e,{orientation:1}),this._previewContainer=U(e,J("div.preview.inline"));let i={scrollBeyondLastLine:!1,scrollbar:{verticalScrollbarSize:14,horizontal:"auto",useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,alwaysConsumeMouseWheel:!0},overviewRulerLanes:2,fixedOverflowWidgets:!0,minimap:{enabled:!1}};this._preview=this._instantiationService.createInstance(ml,this._previewContainer,i,{},this.editor),ji(this._previewContainer),this._previewNotAvailableMessage=this._instantiationService.createInstance(xa,u("missingPreviewMessage","no preview available"),jn,xa.DEFAULT_CREATION_OPTIONS,null),this._treeContainer=U(e,J("div.ref-tree.inline"));let n={keyboardSupport:this._defaultTreeKeyboardSupport,accessibilityProvider:new f2,keyboardNavigationLabelProvider:this._instantiationService.createInstance(Qx),identityProvider:new g2,openOnSingleClick:!0,selectionNavigation:!0,overrideStyles:{listBackground:lhe}};this._defaultTreeKeyboardSupport&&this._callOnDispose.add(Ut(this._treeContainer,"keydown",s=>{s.equals(9)&&(this._keybindingService.dispatchEvent(s,s.target),s.stopPropagation())},!0)),this._tree=this._instantiationService.createInstance(aY,"ReferencesWidget",this._treeContainer,new m2,[this._instantiationService.createInstance(_g),this._instantiationService.createInstance(_P)],this._instantiationService.createInstance(Yx),n),this._splitView.addView({onDidChange:X.None,element:this._previewContainer,minimumSize:200,maximumSize:Number.MAX_VALUE,layout:s=>{this._preview.layout({height:this._dim.height,width:s})}},Rd.Distribute),this._splitView.addView({onDidChange:X.None,element:this._treeContainer,minimumSize:100,maximumSize:Number.MAX_VALUE,layout:s=>{this._treeContainer.style.height=`${this._dim.height}px`,this._treeContainer.style.width=`${s}px`,this._tree.layout(this._dim.height,s)}},Rd.Distribute),this._disposables.add(this._splitView.onDidSashChange(()=>{this._dim.width&&(this.layoutData.ratio=this._splitView.getViewSize(0)/this._dim.width)},void 0));let o=(s,a)=>{s instanceof Qd&&(a==="show"&&this._revealReference(s,!1),this._onDidSelectReference.fire({element:s,kind:a,source:"tree"}))};this._disposables.add(this._tree.onDidOpen(s=>{s.sideBySide?o(s.element,"side"):s.editorOptions.pinned?o(s.element,"goto"):o(s.element,"show")})),ji(this._treeContainer)}_onWidth(e){this._dim&&this._doLayoutBody(this._dim.height,e)}_doLayoutBody(e,i){super._doLayoutBody(e,i),this._dim=new Ge(i,e),this.layoutData.heightInLines=this._viewZone?this._viewZone.heightInLines:this.layoutData.heightInLines,this._splitView.layout(i),this._splitView.resizeView(0,i*this.layoutData.ratio)}setSelection(e){return this._revealReference(e,!0).then(()=>{this._model&&(this._tree.setSelection([e]),this._tree.setFocus([e]))})}setModel(e){return this._disposeOnNewModel.clear(),this._model=e,this._model?this._onNewModel():Promise.resolve()}_onNewModel(){return this._model?this._model.isEmpty?(this.setTitle(""),this._messageContainer.innerText=u("noResults","No results"),rn(this._messageContainer),Promise.resolve(void 0)):(ji(this._messageContainer),this._decorationsManager=new sY(this._preview,this._model),this._disposeOnNewModel.add(this._decorationsManager),this._disposeOnNewModel.add(this._model.onDidChangeReferenceRange(e=>this._tree.rerender(e))),this._disposeOnNewModel.add(this._preview.onMouseDown(e=>{let{event:i,target:n}=e;if(i.detail!==2)return;let o=this._getFocusedReference();o&&this._onDidSelectReference.fire({element:{uri:o.uri,range:n.range},kind:i.ctrlKey||i.metaKey||i.altKey?"side":"open",source:"editor"})})),this.container.classList.add("results-loaded"),rn(this._treeContainer),rn(this._previewContainer),this._splitView.layout(this._dim.width),this.focusOnReferenceTree(),this._tree.setInput(this._model.groups.length===1?this._model.groups[0]:this._model)):Promise.resolve(void 0)}_getFocusedReference(){let[e]=this._tree.getFocus();if(e instanceof Qd)return e;if(e instanceof Tg&&e.children.length>0)return e.children[0]}async revealReference(e){await this._revealReference(e,!1),this._onDidSelectReference.fire({element:e,kind:"goto",source:"tree"})}_revealedReference;async _revealReference(e,i){if(this._revealedReference===e)return;this._revealedReference=e,e.uri.scheme!==Ie.inMemory?this.setTitle(Ns(e.uri),this._uriLabel.getUriLabel(Hn(e.uri))):this.setTitle(u("peekView.alternateTitle","References"));let n=this._textModelResolverService.createModelReference(e.uri);this._tree.getInput()===e.parent?this._tree.reveal(e):(i&&this._tree.reveal(e.parent),await this._tree.expand(e.parent),this._tree.reveal(e));let o=await n;if(!this._model){o.dispose();return}_e(this._previewModelReference);let s=o.object;if(s){let a=this._preview.getModel()===s.textEditorModel?0:1,l=L.lift(e.range).collapseToStart();this._previewModelReference=o,this._preview.setModel(s.textEditorModel),this._preview.setSelection(l),this._preview.revealRangeInCenter(l,a)}else this._preview.setModel(this._previewNotAvailableMessage),o.dispose()}};Zx=E([b(3,Fe),b(4,Tr),b(5,ne),b(6,nY),b(7,hi),b(8,Be)],Zx);var jy=new A("referenceSearchVisible",!1,u("referenceSearchVisible","Whether reference peek is visible, like 'Peek References' or 'Peek Definition'")),Yu=class{constructor(t,e,i,n,o,s,a,l){this._defaultTreeKeyboardSupport=t;this._editor=e;this._editorService=n;this._notificationService=o;this._instantiationService=s;this._storageService=a;this._configurationService=l;this._referenceSearchVisible=jy.bindTo(i)}static ID="editor.contrib.referencesController";_disposables=new B;_widget;_model;_peekMode;_requestIdPool=0;_ignoreModelChangeEvent=!1;_referenceSearchVisible;static get(t){return t.getContribution(Yu.ID)}dispose(){this._referenceSearchVisible.reset(),this._disposables.dispose(),this._widget?.dispose(),this._model?.dispose(),this._widget=void 0,this._model=void 0}toggleWidget(t,e,i){let n;if(this._widget&&(n=this._widget.position),this.closeWidget(),n&&t.containsPosition(n))return;this._peekMode=i,this._referenceSearchVisible.set(!0),this._disposables.add(this._editor.onDidChangeModelLanguage(()=>{this.closeWidget()})),this._disposables.add(this._editor.onDidChangeModel(()=>{this._ignoreModelChangeEvent||this.closeWidget()}));let o="peekViewLayout",s=b2.fromJSON(this._storageService.get(o,0,"{}"));this._widget=this._instantiationService.createInstance(Zx,this._editor,this._defaultTreeKeyboardSupport,s),this._widget.setTitle(u("labelLoading","Loading...")),this._widget.show(t),this._disposables.add(this._widget.onDidClose(()=>{e.cancel(),this._widget?(this._storageService.store(o,JSON.stringify(this._widget.layoutData),0,1),this._widget.isClosing||this.closeWidget(),this._widget=void 0):this.closeWidget()})),this._disposables.add(this._widget.onDidSelectReference(l=>{let{element:d,kind:c}=l;if(d)switch(c){case"open":(l.source!=="editor"||!this._configurationService.getValue("editor.stablePeek"))&&this.openReference(d,!1,!1);break;case"side":this.openReference(d,!0,!1);break;case"goto":i?this._gotoReference(d,!0):this.openReference(d,!1,!0);break}}));let a=++this._requestIdPool;e.then(l=>{if(a!==this._requestIdPool||!this._widget){l.dispose();return}return this._model?.dispose(),this._model=l,this._widget.setModel(this._model).then(()=>{if(this._widget&&this._model&&this._editor.hasModel()){this._model.isEmpty?this._widget.setMetaTitle(""):this._widget.setMetaTitle(u("metaTitle.N","{0} ({1})",this._model.title,this._model.references.length));let d=this._editor.getModel().uri,c=new H(t.startLineNumber,t.startColumn),p=this._model.nearestReference(d,c);if(p)return this._widget.setSelection(p).then(()=>{this._widget&&this._editor.getOption(88)==="editor"&&this._widget.focusOnPreviewEditor()})}})},l=>{this._notificationService.error(l)})}changeFocusBetweenPreviewAndReferences(){this._widget&&(this._widget.isPreviewEditorFocused()?this._widget.focusOnReferenceTree():this._widget.focusOnPreviewEditor())}async goToNextOrPreviousReference(t){if(!this._editor.hasModel()||!this._model||!this._widget)return;let e=this._widget.position;if(!e)return;let i=this._model.nearestReference(this._editor.getModel().uri,e);if(!i)return;let n=this._model.nextOrPreviousReference(i,t),o=this._editor.hasTextFocus(),s=this._widget.isPreviewEditorFocused();await this._widget.setSelection(n),await this._gotoReference(n,!1),o?this._editor.focus():this._widget&&s&&this._widget.focusOnPreviewEditor()}async revealReference(t){!this._editor.hasModel()||!this._model||!this._widget||await this._widget.revealReference(t)}closeWidget(t=!0){this._widget?.dispose(),this._model?.dispose(),this._referenceSearchVisible.reset(),this._disposables.clear(),this._widget=void 0,this._model=void 0,t&&this._editor.focus(),this._requestIdPool+=1}_gotoReference(t,e){this._widget?.hide(),this._ignoreModelChangeEvent=!0;let i=L.lift(t.range).collapseToStart();return this._editorService.openCodeEditor({resource:t.uri,options:{selection:i,selectionSource:"code.jump",pinned:e}},this._editor).then(n=>{if(this._ignoreModelChangeEvent=!1,!n||!this._widget){this.closeWidget();return}if(this._editor===n)this._widget.show(i),this._widget.focusOnReferenceTree();else{let o=Yu.get(n),s=this._model.clone();this.closeWidget(),n.focus(),o?.toggleWidget(i,va(a=>Promise.resolve(s)),this._peekMode??!1)}},n=>{this._ignoreModelChangeEvent=!1,Xe(n)})}openReference(t,e,i){e||this.closeWidget();let{uri:n,range:o}=t;this._editorService.openCodeEditor({resource:n,options:{selection:o,selectionSource:"code.jump",pinned:i}},this._editor,e)}};Yu=E([b(2,re),b(3,En),b(4,mi),b(5,ne),b(6,nt),b(7,se)],Yu);function Xy(r,t){let e=nhe(r);if(!e)return;let i=Yu.get(e);i&&t(i)}wt.registerCommandAndKeybindingRule({id:"togglePeekWidgetFocus",weight:100,primary:mo(2089,60),when:P.or(jy,ha.inPeekEditor),handler(r){Xy(r,t=>{t.changeFocusBetweenPreviewAndReferences()})}});wt.registerCommandAndKeybindingRule({id:"goToNextReference",weight:90,primary:62,secondary:[70],when:P.or(jy,ha.inPeekEditor),handler(r){Xy(r,t=>{t.goToNextOrPreviousReference(!0)})}});wt.registerCommandAndKeybindingRule({id:"goToPreviousReference",weight:90,primary:1086,secondary:[1094],when:P.or(jy,ha.inPeekEditor),handler(r){Xy(r,t=>{t.goToNextOrPreviousReference(!1)})}});tt.registerCommandAlias("goToNextReferenceFromEmbeddedEditor","goToNextReference");tt.registerCommandAlias("goToPreviousReferenceFromEmbeddedEditor","goToPreviousReference");tt.registerCommandAlias("closeReferenceSearchEditor","closeReferenceSearch");tt.registerCommand("closeReferenceSearch",r=>Xy(r,t=>t.closeWidget()));wt.registerKeybindingRule({id:"closeReferenceSearch",weight:-1,primary:9,secondary:[1033],when:P.and(ha.inPeekEditor,P.not("config.editor.stablePeek"))});wt.registerKeybindingRule({id:"closeReferenceSearch",weight:250,primary:9,secondary:[1033],when:P.and(jy,P.not("config.editor.stablePeek"),P.or(ce.editorTextFocus,dB.negate()))});wt.registerCommandAndKeybindingRule({id:"revealReference",weight:200,primary:3,mac:{primary:3,secondary:[2066]},when:P.and(jy,Ih,yB.negate(),SB.negate()),handler(r){let e=r.get(Wo).lastFocusedList?.getFocus();Array.isArray(e)&&e[0]instanceof Qd&&Xy(r,i=>i.revealReference(e[0]))}});wt.registerCommandAndKeybindingRule({id:"openReferenceToSide",weight:100,primary:2051,mac:{primary:259},when:P.and(jy,Ih,yB.negate(),SB.negate()),handler(r){let e=r.get(Wo).lastFocusedList?.getFocus();Array.isArray(e)&&e[0]instanceof Qd&&Xy(r,i=>i.openReference(e[0],!0,!0))}});tt.registerCommand("openReference",r=>{let e=r.get(Wo).lastFocusedList?.getFocus();Array.isArray(e)&&e[0]instanceof Qd&&Xy(r,i=>i.openReference(e[0],!1,!0))});var lY=new A("hasSymbols",!1,u("hasSymbols","Whether there are symbol locations that can be navigated via keyboard-only.")),LP=q("ISymbolNavigationService"),DP=class{constructor(t,e,i,n){this._editorService=e;this._notificationService=i;this._keybindingService=n;this._ctxHasSymbols=lY.bindTo(t)}_ctxHasSymbols;_currentModel=void 0;_currentIdx=-1;_currentState;_currentMessage;_ignoreEditorChange=!1;reset(){this._ctxHasSymbols.reset(),this._currentState?.dispose(),this._currentMessage?.dispose(),this._currentModel=void 0,this._currentIdx=-1}put(t){let e=t.parent.parent;if(e.references.length<=1){this.reset();return}this._currentModel=e,this._currentIdx=e.references.indexOf(t),this._ctxHasSymbols.set(!0),this._showMessage();let i=new kP(this._editorService),n=i.onDidChange(o=>{if(this._ignoreEditorChange)return;let s=this._editorService.getActiveCodeEditor();if(!s)return;let a=s.getModel(),l=s.getPosition();if(!a||!l)return;let d=!1,c=!1;for(let p of e.references)if(zi(p.uri,a.uri))d=!0,c=c||L.containsPosition(p.range,l);else if(d)break;(!d||!c)&&this.reset()});this._currentState=In(i,n)}revealNext(t){if(!this._currentModel)return Promise.resolve();this._currentIdx+=1,this._currentIdx%=this._currentModel.references.length;let e=this._currentModel.references[this._currentIdx];return this._showMessage(),this._ignoreEditorChange=!0,this._editorService.openCodeEditor({resource:e.uri,options:{selection:L.collapseToStart(e.range),selectionRevealType:3}},t).finally(()=>{this._ignoreEditorChange=!1})}_showMessage(){this._currentMessage?.dispose();let t=this._keybindingService.lookupKeybinding("editor.gotoNextSymbolFromResult"),e=t?u("location.kb","Symbol {0} of {1}, {2} for next",this._currentIdx+1,this._currentModel.references.length,t.getLabel()):u("location","Symbol {0} of {1}",this._currentIdx+1,this._currentModel.references.length);this._currentMessage=this._notificationService.status(e)}};DP=E([b(0,re),b(1,En),b(2,mi),b(3,Be)],DP);gi(LP,DP,1);qe(new class extends _r{constructor(){super({id:"editor.gotoNextSymbolFromResult",precondition:lY,kbOpts:{weight:100,primary:70}})}runEditorCommand(r,t){return r.get(LP).revealNext(t)}});wt.registerCommandAndKeybindingRule({id:"editor.gotoNextSymbolFromResult.cancel",weight:100,when:lY,primary:9,handler(r){r.get(LP).reset()}});var kP=class{_listener=new Map;_disposables=new B;_onDidChange=new x;onDidChange=this._onDidChange.event;constructor(t){this._disposables.add(t.onCodeEditorRemove(this._onDidRemoveEditor,this)),this._disposables.add(t.onCodeEditorAdd(this._onDidAddEditor,this)),t.listCodeEditors().forEach(this._onDidAddEditor,this)}dispose(){this._disposables.dispose(),this._onDidChange.dispose(),_e(this._listener.values())}_onDidAddEditor(t){this._listener.set(t,In(t.onDidChangeCursorPosition(e=>this._onDidChange.fire({editor:t})),t.onDidChangeModelContent(e=>this._onDidChange.fire({editor:t}))))}_onDidRemoveEditor(t){this._listener.get(t)?.dispose(),this._listener.delete(t)}};kP=E([b(0,En)],kP);function dY(r,t){return t.uri.scheme===r.uri.scheme?!0:!IA(t.uri,Ie.walkThroughSnippet,Ie.vscodeChatCodeBlock,Ie.vscodeChatCodeCompareBlock)}async function RP(r,t,e,i,n){let s=e.ordered(r,i).map(l=>Promise.resolve(n(l,r,t)).then(void 0,d=>{zo(d)})),a=await Promise.all(s);return cn(a.flat()).filter(l=>dY(r,l))}function v2(r,t,e,i,n){return RP(t,e,r,i,(o,s,a)=>o.provideDefinition(s,a,n))}function I2(r,t,e,i,n){return RP(t,e,r,i,(o,s,a)=>o.provideDeclaration(s,a,n))}function y2(r,t,e,i,n){return RP(t,e,r,i,(o,s,a)=>o.provideImplementation(s,a,n))}function S2(r,t,e,i,n){return RP(t,e,r,i,(o,s,a)=>o.provideTypeDefinition(s,a,n))}function Jx(r,t,e,i,n,o){return RP(t,e,r,n,async(s,a,l)=>{let d=(await s.provideReferences(a,l,{includeDeclaration:!0},o))?.filter(p=>dY(a,p));if(!i||!d||d.length!==2)return d;let c=(await s.provideReferences(a,l,{includeDeclaration:!1},o))?.filter(p=>dY(a,p));return c&&c.length===1?c:d})}async function qh(r){let t=await r(),e=new Ha(t,""),i=e.references.map(n=>n.link);return e.dispose(),i}Fl("_executeDefinitionProvider",(r,t,e)=>{let i=r.get(ni),n=v2(i.definitionProvider,t,e,!1,Pt.None);return qh(()=>n)});Fl("_executeDefinitionProvider_recursive",(r,t,e)=>{let i=r.get(ni),n=v2(i.definitionProvider,t,e,!0,Pt.None);return qh(()=>n)});Fl("_executeTypeDefinitionProvider",(r,t,e)=>{let i=r.get(ni),n=S2(i.typeDefinitionProvider,t,e,!1,Pt.None);return qh(()=>n)});Fl("_executeTypeDefinitionProvider_recursive",(r,t,e)=>{let i=r.get(ni),n=S2(i.typeDefinitionProvider,t,e,!0,Pt.None);return qh(()=>n)});Fl("_executeDeclarationProvider",(r,t,e)=>{let i=r.get(ni),n=I2(i.declarationProvider,t,e,!1,Pt.None);return qh(()=>n)});Fl("_executeDeclarationProvider_recursive",(r,t,e)=>{let i=r.get(ni),n=I2(i.declarationProvider,t,e,!0,Pt.None);return qh(()=>n)});Fl("_executeReferenceProvider",(r,t,e)=>{let i=r.get(ni),n=Jx(i.referenceProvider,t,e,!1,!1,Pt.None);return qh(()=>n)});Fl("_executeReferenceProvider_recursive",(r,t,e)=>{let i=r.get(ni),n=Jx(i.referenceProvider,t,e,!1,!0,Pt.None);return qh(()=>n)});Fl("_executeImplementationProvider",(r,t,e)=>{let i=r.get(ni),n=y2(i.implementationProvider,t,e,!1,Pt.None);return qh(()=>n)});Fl("_executeImplementationProvider_recursive",(r,t,e)=>{let i=r.get(ni),n=y2(i.implementationProvider,t,e,!0,Pt.None);return qh(()=>n)});Ue.appendMenuItem(V.EditorContext,{submenu:V.EditorContextPeek,title:u("peek.submenu","Peek"),group:"navigation",order:100});var Yy=class r{constructor(t,e){this.model=t;this.position=e}static is(t){return!t||typeof t!="object"?!1:!!(t instanceof r||H.isIPosition(t.position)&&t.model)}},$h=class r extends $0{static _allSymbolNavigationCommands=new Map;static _activeAlternativeCommands=new Set;static all(){return r._allSymbolNavigationCommands.values()}static _patchConfig(t){let e={...t,f1:!0};if(e.menu)for(let i of mt.wrap(e.menu))(i.id===V.EditorContext||i.id===V.EditorContextPeek)&&(i.when=P.and(t.precondition,i.when));return e}configuration;constructor(t,e){super(r._patchConfig(e)),this.configuration=t,r._allSymbolNavigationCommands.set(e.id,this)}runEditorCommand(t,e,i,n){if(!e.hasModel())return Promise.resolve(void 0);let o=t.get(mi),s=t.get(En),a=t.get(jN),l=t.get(LP),d=t.get(ni),c=t.get(ne),p=e.getModel(),h=e.getPosition(),m=Yy.is(i)?i:new Yy(p,h),f=new aU(e,5),g=Zv(this._getLocationModel(d,m.model,m.position,f.token),f.token).then(async v=>{if(!v||f.token.isCancellationRequested)return;ka(v.ariaMessage);let I;if(v.referenceAt(p.uri,h)){let w=this._getAlternativeCommand(e);!r._activeAlternativeCommands.has(w)&&r._allSymbolNavigationCommands.has(w)&&(I=r._allSymbolNavigationCommands.get(w))}let y=v.references.length;if(y===0){if(!this.configuration.muteMessage){let w=p.getWordAtPosition(h);Wa.get(e)?.showMessage(this._getNoResultFoundMessage(w),h)}}else if(y===1&&I)r._activeAlternativeCommands.add(this.desc.id),c.invokeFunction(w=>I.runEditorCommand(w,e,i,n).finally(()=>{r._activeAlternativeCommands.delete(this.desc.id)}));else return this._onResult(s,l,e,v,n)},v=>{o.error(v)}).finally(()=>{f.dispose()});return a.showWhile(g,250),g}async _onResult(t,e,i,n,o){let s=this._getGoToPreference(i);if(!(i instanceof ml)&&(this.configuration.openInPeek||s==="peek"&&n.references.length>1))this._openInPeek(i,n,o);else{let a=n.firstReference(),l=n.references.length>1&&s==="gotoAndPeek",d=await this._openReference(i,t,a,this.configuration.openToSide,!l);l&&d?this._openInPeek(d,n,o):n.dispose(),s==="goto"&&e.put(a)}}async _openReference(t,e,i,n,o){let s;if(Bie(i)&&(s=i.targetSelectionRange),s||(s=i.range),!s)return;let a=await e.openCodeEditor({resource:i.uri,options:{selection:L.collapseToStart(s),selectionRevealType:3,selectionSource:"code.jump"}},t,n);if(a){if(o){let l=a.getModel(),d=a.createDecorationsCollection([{range:s,options:{description:"symbol-navigate-action-highlight",className:"symbolHighlight"}}]);setTimeout(()=>{a.getModel()===l&&d.clear()},350)}return a}}_openInPeek(t,e,i){let n=Yu.get(t);n&&t.hasModel()?n.toggleWidget(i??t.getSelection(),va(o=>Promise.resolve(e)),this.configuration.openInPeek):e.dispose()}},Qy=class extends $h{async _getLocationModel(t,e,i,n){return new Ha(await v2(t.definitionProvider,e,i,!1,n),u("def.title","Definitions"))}_getNoResultFoundMessage(t){return t&&t.word?u("noResultWord","No definition found for '{0}'",t.word):u("generic.noResults","No definition found")}_getAlternativeCommand(t){return t.getOption(59).alternativeDefinitionCommand}_getGoToPreference(t){return t.getOption(59).multipleDefinitions}};he(class cY extends Qy{static id="editor.action.revealDefinition";constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:cY.id,title:{...ie("actions.goToDecl.label","Go to Definition"),mnemonicTitle:u({key:"miGotoDefinition",comment:["&& denotes a mnemonic"]},"Go to &&Definition")},precondition:ce.hasDefinitionProvider,keybinding:[{when:ce.editorTextFocus,primary:70,weight:100},{when:P.and(ce.editorTextFocus,ey),primary:2118,weight:100}],menu:[{id:V.EditorContext,group:"navigation",order:1.1},{id:V.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:2}]}),tt.registerCommandAlias("editor.action.goToDeclaration",cY.id)}});he(class uY extends Qy{static id="editor.action.revealDefinitionAside";constructor(){super({openToSide:!0,openInPeek:!1,muteMessage:!1},{id:uY.id,title:ie("actions.goToDeclToSide.label","Open Definition to the Side"),precondition:P.and(ce.hasDefinitionProvider,ce.isInEmbeddedEditor.toNegated()),keybinding:[{when:ce.editorTextFocus,primary:mo(2089,70),weight:100},{when:P.and(ce.editorTextFocus,ey),primary:mo(2089,2118),weight:100}]}),tt.registerCommandAlias("editor.action.openDeclarationToTheSide",uY.id)}});he(class pY extends Qy{static id="editor.action.peekDefinition";constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:pY.id,title:ie("actions.previewDecl.label","Peek Definition"),precondition:P.and(ce.hasDefinitionProvider,ha.notInPeekEditor,ce.isInEmbeddedEditor.toNegated()),keybinding:{when:ce.editorTextFocus,primary:582,linux:{primary:3140},weight:100},menu:{id:V.EditorContextPeek,group:"peek",order:2}}),tt.registerCommandAlias("editor.action.previewDeclaration",pY.id)}});var C2=class extends $h{async _getLocationModel(t,e,i,n){return new Ha(await I2(t.declarationProvider,e,i,!1,n),u("decl.title","Declarations"))}_getNoResultFoundMessage(t){return t&&t.word?u("decl.noResultWord","No declaration found for '{0}'",t.word):u("decl.generic.noResults","No declaration found")}_getAlternativeCommand(t){return t.getOption(59).alternativeDeclarationCommand}_getGoToPreference(t){return t.getOption(59).multipleDeclarations}};he(class che extends C2{static id="editor.action.revealDeclaration";constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:che.id,title:{...ie("actions.goToDeclaration.label","Go to Declaration"),mnemonicTitle:u({key:"miGotoDeclaration",comment:["&& denotes a mnemonic"]},"Go to &&Declaration")},precondition:P.and(ce.hasDeclarationProvider,ce.isInEmbeddedEditor.toNegated()),menu:[{id:V.EditorContext,group:"navigation",order:1.3},{id:V.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:3}]})}_getNoResultFoundMessage(t){return t&&t.word?u("decl.noResultWord","No declaration found for '{0}'",t.word):u("decl.generic.noResults","No declaration found")}});he(class extends C2{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:"editor.action.peekDeclaration",title:ie("actions.peekDecl.label","Peek Declaration"),precondition:P.and(ce.hasDeclarationProvider,ha.notInPeekEditor,ce.isInEmbeddedEditor.toNegated()),menu:{id:V.EditorContextPeek,group:"peek",order:3}})}});var w2=class extends $h{async _getLocationModel(t,e,i,n){return new Ha(await S2(t.typeDefinitionProvider,e,i,!1,n),u("typedef.title","Type Definitions"))}_getNoResultFoundMessage(t){return t&&t.word?u("goToTypeDefinition.noResultWord","No type definition found for '{0}'",t.word):u("goToTypeDefinition.generic.noResults","No type definition found")}_getAlternativeCommand(t){return t.getOption(59).alternativeTypeDefinitionCommand}_getGoToPreference(t){return t.getOption(59).multipleTypeDefinitions}};he(class uhe extends w2{static ID="editor.action.goToTypeDefinition";constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:uhe.ID,title:{...ie("actions.goToTypeDefinition.label","Go to Type Definition"),mnemonicTitle:u({key:"miGotoTypeDefinition",comment:["&& denotes a mnemonic"]},"Go to &&Type Definition")},precondition:ce.hasTypeDefinitionProvider,keybinding:{when:ce.editorTextFocus,primary:0,weight:100},menu:[{id:V.EditorContext,group:"navigation",order:1.4},{id:V.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:3}]})}});he(class phe extends w2{static ID="editor.action.peekTypeDefinition";constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:phe.ID,title:ie("actions.peekTypeDefinition.label","Peek Type Definition"),precondition:P.and(ce.hasTypeDefinitionProvider,ha.notInPeekEditor,ce.isInEmbeddedEditor.toNegated()),menu:{id:V.EditorContextPeek,group:"peek",order:4}})}});var E2=class extends $h{async _getLocationModel(t,e,i,n){return new Ha(await y2(t.implementationProvider,e,i,!1,n),u("impl.title","Implementations"))}_getNoResultFoundMessage(t){return t&&t.word?u("goToImplementation.noResultWord","No implementation found for '{0}'",t.word):u("goToImplementation.generic.noResults","No implementation found")}_getAlternativeCommand(t){return t.getOption(59).alternativeImplementationCommand}_getGoToPreference(t){return t.getOption(59).multipleImplementations}};he(class hhe extends E2{static ID="editor.action.goToImplementation";constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:hhe.ID,title:{...ie("actions.goToImplementation.label","Go to Implementations"),mnemonicTitle:u({key:"miGotoImplementation",comment:["&& denotes a mnemonic"]},"Go to &&Implementations")},precondition:ce.hasImplementationProvider,keybinding:{when:ce.editorTextFocus,primary:2118,weight:100},menu:[{id:V.EditorContext,group:"navigation",order:1.45},{id:V.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:4}]})}});he(class mhe extends E2{static ID="editor.action.peekImplementation";constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:mhe.ID,title:ie("actions.peekImplementation.label","Peek Implementations"),precondition:P.and(ce.hasImplementationProvider,ha.notInPeekEditor,ce.isInEmbeddedEditor.toNegated()),keybinding:{when:ce.editorTextFocus,primary:3142,weight:100},menu:{id:V.EditorContextPeek,group:"peek",order:5}})}});var x2=class extends $h{_getNoResultFoundMessage(t){return t?u("references.no","No references found for '{0}'",t.word):u("references.noGeneric","No references found")}_getAlternativeCommand(t){return t.getOption(59).alternativeReferenceCommand}_getGoToPreference(t){return t.getOption(59).multipleReferences}};he(class extends x2{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:"editor.action.goToReferences",title:{...ie("goToReferences.label","Go to References"),mnemonicTitle:u({key:"miGotoReference",comment:["&& denotes a mnemonic"]},"Go to &&References")},precondition:P.and(ce.hasReferenceProvider,ha.notInPeekEditor,ce.isInEmbeddedEditor.toNegated()),keybinding:{when:ce.editorTextFocus,primary:1094,weight:100},menu:[{id:V.EditorContext,group:"navigation",order:1.45},{id:V.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:5}]})}async _getLocationModel(t,e,i,n){return new Ha(await Jx(t.referenceProvider,e,i,!0,!1,n),u("ref.title","References"))}});he(class extends x2{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:"editor.action.referenceSearch.trigger",title:ie("references.action.label","Peek References"),precondition:P.and(ce.hasReferenceProvider,ha.notInPeekEditor,ce.isInEmbeddedEditor.toNegated()),menu:{id:V.EditorContextPeek,group:"peek",order:6}})}async _getLocationModel(t,e,i,n){return new Ha(await Jx(t.referenceProvider,e,i,!1,!1,n),u("ref.title","References"))}});var hY=class extends $h{constructor(e,i,n){super(e,{id:"editor.action.goToLocation",title:ie("label.generic","Go to Any Symbol"),precondition:P.and(ha.notInPeekEditor,ce.isInEmbeddedEditor.toNegated())});this._references=i;this._gotoMultipleBehaviour=n}async _getLocationModel(e,i,n,o){return new Ha(this._references,u("generic.title","Locations"))}_getNoResultFoundMessage(e){return e&&u("generic.noResult","No results for '{0}'",e.word)||""}_getGoToPreference(e){return this._gotoMultipleBehaviour??e.getOption(59).multipleReferences}_getAlternativeCommand(){return""}};tt.registerCommand({id:"editor.action.goToLocations",metadata:{description:"Go to locations from a position in a file",args:[{name:"uri",description:"The text document in which to start",constraint:Z},{name:"position",description:"The position at which to start",constraint:H.isIPosition},{name:"locations",description:"An array of locations.",constraint:Array},{name:"multiple",description:"Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto`"},{name:"noResultsMessage",description:"Human readable message that shows when locations is empty."}]},handler:async(r,t,e,i,n,o,s)=>{un(Z.isUri(t)),un(H.isIPosition(e)),un(Array.isArray(i)),un(typeof n>"u"||typeof n=="string"),un(typeof s>"u"||typeof s=="boolean");let a=r.get(En),l=await a.openCodeEditor({resource:t},a.getFocusedCodeEditor());if(no(l))return l.setPosition(e),l.revealPositionInCenterIfOutsideViewport(e,0),l.invokeWithinContext(d=>{let c=new class extends hY{_getNoResultFoundMessage(p){return o||super._getNoResultFoundMessage(p)}}({muteMessage:!o,openInPeek:!!s,openToSide:!1},i,n);d.get(ne).invokeFunction(c.run.bind(c),l)})}});tt.registerCommand({id:"editor.action.peekLocations",metadata:{description:"Peek locations from a position in a file",args:[{name:"uri",description:"The text document in which to start",constraint:Z},{name:"position",description:"The position at which to start",constraint:H.isIPosition},{name:"locations",description:"An array of locations.",constraint:Array},{name:"multiple",description:"Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto`"}]},handler:async(r,t,e,i,n)=>{r.get(ct).executeCommand("editor.action.goToLocations",t,e,i,n,void 0,!0)}});tt.registerCommand({id:"editor.action.findReferences",handler:(r,t,e)=>{un(Z.isUri(t)),un(H.isIPosition(e));let i=r.get(ni),n=r.get(En);return n.openCodeEditor({resource:t},n.getFocusedCodeEditor()).then(o=>{if(!no(o)||!o.hasModel())return;let s=Yu.get(o);if(!s)return;let a=va(d=>Jx(i.referenceProvider,o.getModel(),H.lift(e),!1,!1,d).then(c=>new Ha(c,u("ref.title","References")))),l=new L(e.lineNumber,e.column,e.lineNumber,e.column);return Promise.resolve(s.toggleWidget(l,a,!1))})}});tt.registerCommandAlias("editor.action.showReferences","editor.action.peekLocations");async function ghe(r,t,e,i){let n=r.get(Tr),o=r.get(vt),s=r.get(ct),a=r.get(ne),l=r.get(mi);if(await i.item.resolve(Pt.None),!i.part.location)return;let d=i.part.location,c=[],p=new Set(Ue.getMenuItems(V.EditorContext).map(m=>yf(m)?m.command.id:Ni()));for(let m of $h.all())p.has(m.desc.id)&&c.push(new et(m.desc.id,wn.label(m.desc,{renderShortTitle:!0}),void 0,!0,async()=>{let f=await n.createModelReference(d.uri);try{let g=new Yy(f.object.textEditorModel,L.getStartPosition(d.range)),v=i.item.anchor.range;await a.invokeFunction(m.runEditorCommand.bind(m),t,g,v)}finally{f.dispose()}}));if(i.part.command){let{command:m}=i.part;c.push(new Qt),c.push(new et(m.id,m.title,void 0,!0,async()=>{try{await s.executeCommand(m.id,...m.arguments??[])}catch(f){l.notify({severity:Sc.Error,source:i.item.provider.displayName,message:f})}}))}let h=t.getOption(129);o.showContextMenu({domForShadowRoot:h?t.getDomNode()??void 0:void 0,getAnchor:()=>{let m=Oi(e);return{x:m.left,y:m.top+m.height+8}},getActions:()=>c,onHide:()=>{t.focus()},autoSelectFirstItem:!0})}async function fhe(r,t,e,i){let o=await r.get(Tr).createModelReference(i.uri);await e.invokeWithinContext(async s=>{let a=t.hasSideBySideModifier,l=s.get(re),d=ha.inPeekEditor.getValue(l),c=!a&&e.getOption(90)&&!d;return new Qy({openToSide:a,openInPeek:c,muteMessage:!0},{title:{value:"",original:""},id:"",precondition:void 0}).run(s,new Yy(o.object.textEditorModel,L.getStartPosition(i.range)),L.lift(i.range))}),o.dispose()}var mY=class r{_entries=new zr(50);get(t){let e=r._key(t);return this._entries.get(e)}set(t,e){let i=r._key(t);this._entries.set(i,e)}static _key(t){return`${t.uri.toString()}/${t.getVersionId()}`}},bhe=q("IInlayHintsCache");gi(bhe,mY,1);var eT=class{constructor(t,e){this.item=t;this.index=e}get part(){let t=this.item.hint.label;return typeof t=="string"?{label:t}:t[this.index]}},gY=class{constructor(t,e){this.part=t;this.hasTriggerModifier=e}};var Qu=class{constructor(t,e,i,n,o,s,a){this._editor=t;this._languageFeaturesService=e;this._inlayHintsCache=n;this._commandService=o;this._notificationService=s;this._instaService=a;this._debounceInfo=i.for(e.inlayHintsProvider,"InlayHint",{min:25}),this._disposables.add(e.inlayHintsProvider.onDidChange(()=>this._update())),this._disposables.add(t.onDidChangeModel(()=>this._update())),this._disposables.add(t.onDidChangeModelLanguage(()=>this._update())),this._disposables.add(t.onDidChangeConfiguration(l=>{l.hasChanged(143)&&this._update()})),this._update()}static ID="editor.contrib.InlayHints";static _MAX_DECORATORS=1500;static _whitespaceData={};static get(t){return t.getContribution(Qu.ID)??void 0}_disposables=new B;_sessionDisposables=new B;_debounceInfo;_decorationsMetadata=new Map;_ruleFactory=new _E(this._editor);_cursorInfo;_activeRenderMode=0;_activeInlayHintPart;dispose(){this._sessionDisposables.dispose(),this._removeAllDecorations(),this._disposables.dispose()}_update(){this._sessionDisposables.clear(),this._removeAllDecorations();let t=this._editor.getOption(143);if(t.enabled==="off")return;let e=this._editor.getModel();if(!e||!this._languageFeaturesService.inlayHintsProvider.has(e))return;if(t.enabled==="on")this._activeRenderMode=0;else{let l,d;t.enabled==="onUnlessPressed"?(l=0,d=1):(l=1,d=0),this._activeRenderMode=l,this._sessionDisposables.add(eu.getInstance().event(c=>{if(!this._editor.hasModel())return;let p=c.altKey&&c.ctrlKey&&!(c.shiftKey||c.metaKey)?d:l;if(p!==this._activeRenderMode){this._activeRenderMode=p;let h=this._editor.getModel(),m=this._copyInlayHintsWithCurrentAnchor(h);this._updateHintsDecorators([h.getFullModelRange()],m),s.schedule(0)}}))}let i=this._inlayHintsCache.get(e);i&&this._updateHintsDecorators([e.getFullModelRange()],i),this._sessionDisposables.add(le(()=>{e.isDisposed()||this._cacheHintsForFastRestore(e)}));let n,o=new Set,s=new Ye(async()=>{let l=Date.now();n?.dispose(!0),n=new Kt;let d=e.onWillDispose(()=>n?.cancel());try{let c=n.token,p=await xP.create(this._languageFeaturesService.inlayHintsProvider,e,this._getHintsRanges(),c);if(s.delay=this._debounceInfo.update(e,Date.now()-l),c.isCancellationRequested){p.dispose();return}for(let h of p.provider)typeof h.onDidChangeInlayHints=="function"&&!o.has(h)&&(o.add(h),this._sessionDisposables.add(h.onDidChangeInlayHints(()=>{s.isScheduled()||s.schedule()})));this._sessionDisposables.add(p),this._updateHintsDecorators(p.ranges,p.items),this._cacheHintsForFastRestore(e)}catch(c){Xe(c)}finally{n.dispose(),d.dispose()}},this._debounceInfo.get(e));this._sessionDisposables.add(s),this._sessionDisposables.add(le(()=>n?.dispose(!0))),s.schedule(0),this._sessionDisposables.add(this._editor.onDidScrollChange(l=>{(l.scrollTopChanged||!s.isScheduled())&&s.schedule()}));let a=this._sessionDisposables.add(new yt);this._sessionDisposables.add(this._editor.onDidChangeModelContent(l=>{n?.cancel();let d=Math.max(s.delay,800);this._cursorInfo={position:this._editor.getPosition(),notEarlierThan:Date.now()+d},a.value=Sd(()=>s.schedule(0),d),s.schedule()})),this._sessionDisposables.add(this._editor.onDidChangeConfiguration(l=>{l.hasChanged(143)&&s.schedule()})),this._sessionDisposables.add(this._installDblClickGesture(()=>s.schedule(0))),this._sessionDisposables.add(this._installLinkGesture()),this._sessionDisposables.add(this._installContextMenu())}_installLinkGesture(){let t=new B,e=t.add(new h2(this._editor)),i=new B;return t.add(i),t.add(e.onMouseMoveOrRelevantKeyDown(n=>{let[o]=n,s=this._getInlayHintLabelPart(o),a=this._editor.getModel();if(!s||!a){i.clear();return}let l=new Kt;i.add(le(()=>l.dispose(!0))),s.item.resolve(l.token),this._activeInlayHintPart=s.part.command||s.part.location?new gY(s,o.hasTriggerModifier):void 0;let d=a.validatePosition(s.item.hint.position).lineNumber,c=new L(d,1,d,a.getLineMaxColumn(d)),p=this._getInlineHintsForRange(c);this._updateHintsDecorators([c],p),i.add(le(()=>{this._activeInlayHintPart=void 0,this._updateHintsDecorators([c],p)}))})),t.add(e.onCancel(()=>i.clear())),t.add(e.onExecute(async n=>{let o=this._getInlayHintLabelPart(n);if(o){let s=o.part;s.location?this._instaService.invokeFunction(fhe,n,this._editor,s.location):UG.is(s.command)&&await this._invokeCommand(s.command,o.item)}})),t}_getInlineHintsForRange(t){let e=new Set;for(let i of this._decorationsMetadata.values())t.containsRange(i.item.anchor.range)&&e.add(i.item);return Array.from(e)}_installDblClickGesture(t){return this._editor.onMouseUp(async e=>{if(e.event.detail!==2)return;let i=this._getInlayHintLabelPart(e);if(i&&(e.event.preventDefault(),await i.item.resolve(Pt.None),pm(i.item.hint.textEdits))){let n=i.item.hint.textEdits.map(o=>$r.replace(L.lift(o.range),o.text));this._editor.executeEdits("inlayHint.default",n),t()}})}_installContextMenu(){return this._editor.onContextMenu(async t=>{if(!on(t.event.target))return;let e=this._getInlayHintLabelPart(t);e&&await this._instaService.invokeFunction(ghe,this._editor,t.event.target,e)})}_getInlayHintLabelPart(t){if(t.target.type!==6)return;let e=t.target.detail.injectedText?.options;if(e instanceof Gf&&e?.attachedData instanceof eT)return e.attachedData}async _invokeCommand(t,e){try{await this._commandService.executeCommand(t.id,...t.arguments??[])}catch(i){this._notificationService.notify({severity:Sc.Error,source:e.provider.displayName,message:i})}}_cacheHintsForFastRestore(t){let e=this._copyInlayHintsWithCurrentAnchor(t);this._inlayHintsCache.set(t,e)}_copyInlayHintsWithCurrentAnchor(t){let e=new Map;for(let[i,n]of this._decorationsMetadata){if(e.has(n.item))continue;let o=t.getDecorationRange(i);if(o){let s=new EP(o,n.item.anchor.direction),a=n.item.with({anchor:s});e.set(n.item,a)}}return Array.from(e.values())}_getHintsRanges(){let e=this._editor.getModel(),i=this._editor.getVisibleRangesPlusViewportAboveBelow(),n=[];for(let o of i.sort(L.compareRangesUsingStarts)){let s=e.validateRange(new L(o.startLineNumber-30,o.startColumn,o.endLineNumber+30,o.endColumn));n.length===0||!L.areIntersectingOrTouching(n[n.length-1],s)?n.push(s):n[n.length-1]=L.plusRange(n[n.length-1],s)}return n}_updateHintsDecorators(t,e){let i=new Map;if(this._cursorInfo&&this._cursorInfo.notEarlierThan>Date.now()&&t.some(v=>v.containsPosition(this._cursorInfo.position))){let{position:v}=this._cursorInfo;this._cursorInfo=void 0;let I=new Map;for(let S of this._editor.getLineDecorations(v.lineNumber)??[]){let D=this._decorationsMetadata.get(S.id);if(S.range.startColumn>v.column)continue;let k=D?.decoration.options[D.item.anchor.direction];if(k&&k.attachedData!==Qu._whitespaceData){let M=I.get(D.item)??0;I.set(D.item,M+k.content.length)}}let y=e.filter(S=>S.anchor.range.startLineNumber===v.lineNumber&&S.anchor.range.endColumn<=v.column),w=Array.from(I.values()),C;for(;;){let S=y.shift(),D=w.shift();if(!D&&!S)break;if(S)i.set(S,D??0),C=S;else if(C&&D){let k=i.get(C);k+=D,k+=w.reduce((M,O)=>M+O,0),w.length=0;break}}}let n=[],o=(v,I,y,w,C)=>{let S={content:y,inlineClassNameAffectsLetterSpacing:!0,inlineClassName:I.className,cursorStops:w,attachedData:C};n.push({item:v,classNameRef:I,decoration:{range:v.anchor.range,options:{description:"InlayHint",showIfCollapsed:v.anchor.range.isEmpty(),collapseOnReplaceEdit:!v.anchor.range.isEmpty(),stickiness:0,[v.anchor.direction]:this._activeRenderMode===0?S:void 0}}})},s=(v,I)=>{let y=this._ruleFactory.createClassNameRef({width:`${a/3|0}px`,display:"inline-block"});o(v,y,"\u200A",I?1:3,Qu._whitespaceData)},{fontSize:a,fontFamily:l,padding:d,isUniform:c}=this._getLayoutInfo(),p=this._editor.getOption(143).maximumLength,h="--code-editorInlayHintsFontFamily";this._editor.getContainerDomNode().style.setProperty(h,l);let m={line:0,totalLen:0};for(let v=0;v<e.length;v++){let I=e[v];if(m.line!==I.anchor.range.startLineNumber&&(m={line:I.anchor.range.startLineNumber,totalLen:0}),p&&m.totalLen>p)continue;I.hint.paddingLeft&&s(I,!1);let y=typeof I.hint.label=="string"?[{label:I.hint.label}]:I.hint.label,w=i.get(I),C=0;for(let S=0;S<y.length;S++){let D=y[S],k=S===0,M=S===y.length-1,O={fontSize:`${a}px`,fontFamily:`var(${h}), ${vs.fontFamily}`,verticalAlign:c?"baseline":"middle",unicodeBidi:"isolate"};pm(I.hint.textEdits)&&(O.cursor="default"),this._fillInColors(O,I.hint),(D.command||D.location)&&this._activeInlayHintPart?.part.item===I&&this._activeInlayHintPart.part.index===S&&(O.textDecoration="underline",this._activeInlayHintPart.hasTriggerModifier&&(O.color=_d(gne),O.cursor="pointer"));let K=D.label;m.totalLen+=K.length;let G=!1,Y=p!==0?m.totalLen-p:0;Y>0&&(K=K.slice(0,-Y)+"\u2026",G=!0),C+=K.length;let ge=w!==void 0?C-w:0;if(ge>0&&(C-=ge,K=K.slice(0,-(1+ge))+"\u2026",G=!0),d&&(k&&(M||G)?(O.padding=`1px ${Math.max(1,a/4)|0}px`,O.borderRadius=`${a/4|0}px`):k?(O.padding=`1px 0 1px ${Math.max(1,a/4)|0}px`,O.borderRadius=`${a/4|0}px 0 0 ${a/4|0}px`):M||G?(O.padding=`1px ${Math.max(1,a/4)|0}px 1px 0`,O.borderRadius=`0 ${a/4|0}px ${a/4|0}px 0`):O.padding="1px 0 1px 0"),o(I,this._ruleFactory.createClassNameRef(O),I_e(K),M&&!I.hint.paddingRight?1:3,new eT(I,S)),G)break}if(w!==void 0&&C<w){let S=w-C;o(I,this._ruleFactory.createClassNameRef({}),"\u200A".repeat(S),3)}if(I.hint.paddingRight&&s(I,!0),n.length>Qu._MAX_DECORATORS)break}let f=[];for(let[v,I]of this._decorationsMetadata){let y=this._editor.getModel()?.getDecorationRange(v);y&&t.some(w=>w.containsRange(y))&&(f.push(v),I.classNameRef.dispose(),this._decorationsMetadata.delete(v))}let g=mg.capture(this._editor);this._editor.changeDecorations(v=>{let I=v.deltaDecorations(f,n.map(y=>y.decoration));for(let y=0;y<I.length;y++){let w=n[y];this._decorationsMetadata.set(I[y],w)}}),g.restore(this._editor)}_fillInColors(t,e){e.kind===2?(t.backgroundColor=_d(wne),t.color=_d(Cne)):e.kind===1?(t.backgroundColor=_d(Sne),t.color=_d(yne)):(t.backgroundColor=_d(w0),t.color=_d(C0))}_getLayoutInfo(){let t=this._editor.getOption(143),e=t.padding,i=this._editor.getOption(53),n=this._editor.getOption(50),o=t.fontSize;(!o||o<5||o>i)&&(o=i);let s=t.fontFamily||n;return{fontSize:o,fontFamily:s,padding:e,isUniform:!e&&s===n&&o===i}}_removeAllDecorations(){this._editor.removeDecorations(Array.from(this._decorationsMetadata.keys()));for(let t of this._decorationsMetadata.values())t.classNameRef.dispose();this._decorationsMetadata.clear()}getInlayHintsForLine(t){if(!this._editor.hasModel())return[];let e=new Set,i=[];for(let n of this._editor.getLineDecorations(t)){let o=this._decorationsMetadata.get(n.id);o&&!e.has(o.item.hint)&&(e.add(o.item.hint),i.push(o.item))}return i}};Qu=E([b(1,ni),b(2,Ny),b(3,bhe),b(4,ct),b(5,mi),b(6,ne)],Qu);function I_e(r){return r.replace(/[ \t]/g,"\xA0")}tt.registerCommand("_executeInlayHintProvider",async(r,...t)=>{let[e,i]=t;un(Z.isUri(e)),un(L.isIRange(i));let{inlayHintsProvider:n}=r.get(ni),o=await r.get(Tr).createModelReference(e);try{let s=await xP.create(n,o.object.textEditorModel,[L.lift(i)],Pt.None),a=s.items.map(l=>l.hint);return setTimeout(()=>s.dispose(),0),a}finally{o.dispose()}});var T2=class extends zU{constructor(e,i,n,o){super(10,i,e.item.anchor.range,n,o,!0);this.part=e}},tT=class extends uv{constructor(e,i,n,o,s,a,l,d,c){super(e,i,n,a,d,o,s,c);this._resolverService=l}hoverOrdinal=6;suggestHoverAnchor(e){if(!Qu.get(this._editor)||e.target.type!==6)return null;let n=e.target.detail.injectedText?.options;return n instanceof Gf&&n.attachedData instanceof eT?new T2(n.attachedData,this,e.event.posx,e.event.posy):null}computeSync(){return[]}computeAsync(e,i,n){return e instanceof T2?new gs(async o=>{let{part:s}=e;if(await s.item.resolve(n),n.isCancellationRequested)return;let a;typeof s.item.hint.tooltip=="string"?a=new Sn().appendText(s.item.hint.tooltip):s.item.hint.tooltip&&(a=s.item.hint.tooltip),a&&o.emitOne(new od(this,e.range,[a],!1,0)),pm(s.item.hint.textEdits)&&o.emitOne(new od(this,e.range,[new Sn().appendText(u("hint.dbl","Double-click to insert"))],!1,10001));let l;if(typeof s.part.tooltip=="string"?l=new Sn().appendText(s.part.tooltip):s.part.tooltip&&(l=s.part.tooltip),l&&o.emitOne(new od(this,e.range,[l],!1,1)),s.part.location||s.part.command){let c,h=this._editor.getOption(79)==="altKey"?ye?u("links.navigate.kb.meta.mac","cmd + click"):u("links.navigate.kb.meta","ctrl + click"):ye?u("links.navigate.kb.alt.mac","option + click"):u("links.navigate.kb.alt","alt + click");s.part.location&&s.part.command?c=new Sn().appendText(u("hint.defAndCommand","Go to Definition ({0}), right click for more",h)):s.part.location?c=new Sn().appendText(u("hint.def","Go to Definition ({0})",h)):s.part.command&&(c=new Sn(`[${u("hint.cmd","Execute Command")}](${ihe(s.part.command)} "${s.part.command.title}") (${h})`,{isTrusted:!0})),c&&o.emitOne(new od(this,e.range,[c],!1,1e4))}let d=await this._resolveInlayHintLabelPartHover(s,n);for await(let c of d)o.emitOne(c)}):gs.EMPTY}async _resolveInlayHintLabelPartHover(e,i){if(!e.part.location)return gs.EMPTY;let{uri:n,range:o}=e.part.location,s=await this._resolverService.createModelReference(n);try{let a=s.object.textEditorModel;return this._languageFeaturesService.hoverProvider.has(a)?yP(this._languageFeaturesService.hoverProvider,a,new H(o.startLineNumber,o.startColumn),i).filter(l=>!oI(l.hover.contents)).map(l=>new od(this,e.item.anchor.range,l.hover.contents,!1,2+l.ordinal)):gs.EMPTY}finally{s.dispose()}}};tT=E([b(1,ti),b(2,Yi),b(3,Be),b(4,Nt),b(5,se),b(6,Tr),b(7,ni),b(8,ct)],tT);var _2=class r extends R{closestMouseDistance;initialMousePosX;initialMousePosY;showAtPosition;showAtSecondaryPosition;shouldFocus;source;shouldAppearBeforeContent;_renderedHoverParts;constructor(t,e,i,n,o){super();let s=e.hoverParts;this._renderedHoverParts=this._register(new bY(t,i,s,o,n));let a=e.options,l=a.anchor,{showAtPosition:d,showAtSecondaryPosition:c}=r.computeHoverPositions(t,l.range,s);this.shouldAppearBeforeContent=s.some(p=>p.isBeforeContent),this.showAtPosition=d,this.showAtSecondaryPosition=c,this.initialMousePosX=l.initialMousePosX,this.initialMousePosY=l.initialMousePosY,this.shouldFocus=a.shouldFocus,this.source=a.source}get domNode(){return this._renderedHoverParts.domNode}get domNodeHasChildren(){return this._renderedHoverParts.domNodeHasChildren}get focusedHoverPartIndex(){return this._renderedHoverParts.focusedHoverPartIndex}focusHoverPartWithIndex(t){this._renderedHoverParts.focusHoverPartWithIndex(t)}getAccessibleWidgetContent(){return this._renderedHoverParts.getAccessibleContent()}getAccessibleWidgetContentAtIndex(t){return this._renderedHoverParts.getAccessibleHoverContentAtIndex(t)}async updateHoverVerbosityLevel(t,e,i){this._renderedHoverParts.updateHoverVerbosityLevel(t,e,i)}doesHoverAtIndexSupportVerbosityAction(t,e){return this._renderedHoverParts.doesHoverAtIndexSupportVerbosityAction(t,e)}isColorPickerVisible(){return this._renderedHoverParts.isColorPickerVisible()}static computeHoverPositions(t,e,i){let n=1;if(t.hasModel()){let c=t._getViewModel(),p=c.coordinatesConverter,h=p.convertModelRangeToViewRange(e),m=c.getLineMinColumn(h.startLineNumber),f=new H(h.startLineNumber,m);n=p.convertViewPositionToModelPosition(f).column}let o=e.startLineNumber,s=e.startColumn,a;for(let c of i){let p=c.range,h=p.startLineNumber===o,m=p.endLineNumber===o;if(h&&m){let g=p.startColumn,v=Math.min(s,g);s=Math.max(v,n)}c.forceShowAtRange&&(a=p)}let l,d;if(a){let c=a.getStartPosition();l=c,d=c}else l=e.getStartPosition(),d=new H(o,s);return{showAtPosition:l,showAtSecondaryPosition:d}}},fY=class{constructor(t,e){this._statusBar=e;t.appendChild(this._statusBar.hoverElement)}get hoverElement(){return this._statusBar.hoverElement}get actions(){return this._statusBar.actions}dispose(){this._statusBar.dispose()}},bY=class r extends R{static _DECORATION_OPTIONS=Ii.register({description:"content-hover-highlight",className:"hoverHighlight"});_renderedParts=[];_fragment;_context;_markdownHoverParticipant;_colorHoverParticipant;_focusedHoverPartIndex=-1;constructor(t,e,i,n,o){super(),this._context=o,this._fragment=document.createDocumentFragment(),this._register(this._renderParts(e,i,o,n)),this._register(this._registerListenersOnRenderedParts()),this._register(this._createEditorDecorations(t,i)),this._updateMarkdownAndColorParticipantInfo(e)}_createEditorDecorations(t,e){if(e.length===0)return R.None;let i=e[0].range;for(let o of e){let s=o.range;i=L.plusRange(i,s)}let n=t.createDecorationsCollection();return n.set([{range:i,options:r._DECORATION_OPTIONS}]),le(()=>{n.clear()})}_renderParts(t,e,i,n){let o=new Kx(n),s={fragment:this._fragment,statusBar:o,...i},a=new B;for(let d of t){let c=this._renderHoverPartsForParticipant(e,d,s);a.add(c);for(let p of c.renderedHoverParts)this._renderedParts.push({type:"hoverPart",participant:d,hoverPart:p.hoverPart,hoverElement:p.hoverElement})}let l=this._renderStatusBar(this._fragment,o);return l&&(a.add(l),this._renderedParts.push({type:"statusBar",hoverElement:l.hoverElement,actions:l.actions})),le(()=>{a.dispose()})}_renderHoverPartsForParticipant(t,e,i){let n=t.filter(s=>s.owner===e);return n.length>0?e.renderHoverParts(i,n):new cv([])}_renderStatusBar(t,e){if(e.hasContent)return new fY(t,e)}_registerListenersOnRenderedParts(){let t=new B;return this._renderedParts.forEach((e,i)=>{let n=e.hoverElement;n.tabIndex=0,t.add(F(n,Q.FOCUS_IN,o=>{o.stopPropagation(),this._focusedHoverPartIndex=i})),t.add(F(n,Q.FOCUS_OUT,o=>{o.stopPropagation(),this._focusedHoverPartIndex=-1}))}),t}_updateMarkdownAndColorParticipantInfo(t){let e=t.find(i=>i instanceof uv&&!(i instanceof tT));e&&(this._markdownHoverParticipant=e),this._colorHoverParticipant=t.find(i=>i instanceof pv)}focusHoverPartWithIndex(t){t<0||t>=this._renderedParts.length||this._renderedParts[t].hoverElement.focus()}getAccessibleContent(){let t=[];for(let e=0;e<this._renderedParts.length;e++)t.push(this.getAccessibleHoverContentAtIndex(e));return t.join(`

`)}getAccessibleHoverContentAtIndex(t){let e=this._renderedParts[t];if(!e)return"";if(e.type==="statusBar"){let i=[u("hoverAccessibilityStatusBar","This is a hover status bar.")];for(let n of e.actions){let o=n.actionKeybindingLabel;o?i.push(u("hoverAccessibilityStatusBarActionWithKeybinding","It has an action with label {0} and keybinding {1}.",n.actionLabel,o)):i.push(u("hoverAccessibilityStatusBarActionWithoutKeybinding","It has an action with label {0}.",n.actionLabel))}return i.join(`
`)}return e.participant.getAccessibleContent(e.hoverPart)}async updateHoverVerbosityLevel(t,e,i){if(!this._markdownHoverParticipant)return;let n=this._normalizedIndexToMarkdownHoverIndexRange(this._markdownHoverParticipant,e);if(n===void 0)return;let o=await this._markdownHoverParticipant.updateMarkdownHoverVerbosityLevel(t,n,i);o&&(this._renderedParts[e]={type:"hoverPart",participant:this._markdownHoverParticipant,hoverPart:o.hoverPart,hoverElement:o.hoverElement},this._context.onContentsChanged())}doesHoverAtIndexSupportVerbosityAction(t,e){if(!this._markdownHoverParticipant)return!1;let i=this._normalizedIndexToMarkdownHoverIndexRange(this._markdownHoverParticipant,t);return i===void 0?!1:this._markdownHoverParticipant.doesMarkdownHoverAtIndexSupportVerbosityAction(i,e)}isColorPickerVisible(){return this._colorHoverParticipant?.isColorPickerVisible()??!1}_normalizedIndexToMarkdownHoverIndexRange(t,e){let i=this._renderedParts[e];if(!i||i.type!=="hoverPart"||!(i.participant===t))return;let o=this._renderedParts.findIndex(s=>s.type==="hoverPart"&&s.participant===t);if(o===-1)throw new _t;return e-o}get domNode(){return this._fragment}get domNodeHasChildren(){return this._fragment.hasChildNodes()}get focusedHoverPartIndex(){return this._focusedHoverPartIndex}};var vhe=30,y_e=6,gl=class extends qU{constructor(e,i,n,o,s){let a=e.getOption(68)+8,l=150,d=new Ge(l,a);super(e,d);this._configurationService=n;this._accessibilityService=o;this._keybindingService=s;this._minimumSize=d,this._hoverVisibleKey=ce.hoverVisible.bindTo(i),this._hoverFocusedKey=ce.hoverFocused.bindTo(i),U(this._resizableNode.domNode,this._hover.containerDomNode),this._resizableNode.domNode.style.zIndex="50",this._register(this._editor.onDidLayoutChange(()=>{this.isVisible&&this._updateMaxDimensions()})),this._register(this._editor.onDidChangeConfiguration(p=>{p.hasChanged(51)&&this._updateFont()}));let c=this._register(Er(this._resizableNode.domNode));this._register(c.onDidFocus(()=>{this._hoverFocusedKey.set(!0)})),this._register(c.onDidBlur(()=>{this._hoverFocusedKey.set(!1)})),this._setRenderedHover(void 0),this._editor.addContentWidget(this)}static ID="editor.contrib.resizableContentHoverWidget";static _lastDimensions=new Ge(0,0);_renderedHover;_positionPreference;_minimumSize;_contentWidth;_hover=this._register(new f1);_hoverVisibleKey;_hoverFocusedKey;_onDidResize=this._register(new x);onDidResize=this._onDidResize.event;get isVisibleFromKeyboard(){return this._renderedHover?.source===1}get isVisible(){return this._hoverVisibleKey.get()??!1}get isFocused(){return this._hoverFocusedKey.get()??!1}dispose(){super.dispose(),this._renderedHover?.dispose(),this._editor.removeContentWidget(this)}getId(){return gl.ID}static _applyDimensions(e,i,n){let o=typeof i=="number"?`${i}px`:i,s=typeof n=="number"?`${n}px`:n;e.style.width=o,e.style.height=s}_setContentsDomNodeDimensions(e,i){let n=this._hover.contentsDomNode;return gl._applyDimensions(n,e,i)}_setContainerDomNodeDimensions(e,i){let n=this._hover.containerDomNode;return gl._applyDimensions(n,e,i)}_setHoverWidgetDimensions(e,i){this._setContentsDomNodeDimensions(e,i),this._setContainerDomNodeDimensions(e,i),this._layoutContentWidget()}static _applyMaxDimensions(e,i,n){let o=typeof i=="number"?`${i}px`:i,s=typeof n=="number"?`${n}px`:n;e.style.maxWidth=o,e.style.maxHeight=s}_setHoverWidgetMaxDimensions(e,i){gl._applyMaxDimensions(this._hover.contentsDomNode,e,i),gl._applyMaxDimensions(this._hover.containerDomNode,e,i),this._hover.containerDomNode.style.setProperty("--vscode-hover-maxWidth",typeof e=="number"?`${e}px`:e),this._layoutContentWidget()}_setAdjustedHoverWidgetDimensions(e){this._setHoverWidgetMaxDimensions("none","none");let i=e.width,n=e.height;this._setHoverWidgetDimensions(i,n)}_updateResizableNodeMaxDimensions(){let e=this._findMaximumRenderingWidth()??1/0,i=this._findMaximumRenderingHeight()??1/0;this._resizableNode.maxSize=new Ge(e,i),this._setHoverWidgetMaxDimensions(e,i)}_resize(e){gl._lastDimensions=new Ge(e.width,e.height),this._setAdjustedHoverWidgetDimensions(e),this._resizableNode.layout(e.height,e.width),this._updateResizableNodeMaxDimensions(),this._hover.scrollbar.scanDomNode(),this._editor.layoutContentWidget(this),this._onDidResize.fire()}_findAvailableSpaceVertically(){let e=this._renderedHover?.showAtPosition;if(e)return this._positionPreference===1?this._availableVerticalSpaceAbove(e):this._availableVerticalSpaceBelow(e)}_findMaximumRenderingHeight(){let e=this._findAvailableSpaceVertically();if(!e)return;let i=y_e;return Array.from(this._hover.contentsDomNode.children).forEach(n=>{i+=n.clientHeight}),Math.min(e,i)}_isHoverTextOverflowing(){this._hover.containerDomNode.style.setProperty("--vscode-hover-whiteSpace","nowrap"),this._hover.containerDomNode.style.setProperty("--vscode-hover-sourceWhiteSpace","nowrap");let e=Array.from(this._hover.contentsDomNode.children).some(i=>i.scrollWidth>i.clientWidth);return this._hover.containerDomNode.style.removeProperty("--vscode-hover-whiteSpace"),this._hover.containerDomNode.style.removeProperty("--vscode-hover-sourceWhiteSpace"),e}_findMaximumRenderingWidth(){if(!this._editor||!this._editor.hasModel())return;let e=this._isHoverTextOverflowing(),i=typeof this._contentWidth>"u"?0:this._contentWidth-2;return e||this._hover.containerDomNode.clientWidth<i?Qa(this._hover.containerDomNode.ownerDocument.body).width-14:this._hover.containerDomNode.clientWidth+2}isMouseGettingCloser(e,i){if(!this._renderedHover)return!1;if(this._renderedHover.initialMousePosX===void 0||this._renderedHover.initialMousePosY===void 0)return this._renderedHover.initialMousePosX=e,this._renderedHover.initialMousePosY=i,!1;let n=Oi(this.getDomNode());this._renderedHover.closestMouseDistance===void 0&&(this._renderedHover.closestMouseDistance=Ihe(this._renderedHover.initialMousePosX,this._renderedHover.initialMousePosY,n.left,n.top,n.width,n.height));let o=Ihe(e,i,n.left,n.top,n.width,n.height);return o>this._renderedHover.closestMouseDistance+4?!1:(this._renderedHover.closestMouseDistance=Math.min(this._renderedHover.closestMouseDistance,o),!0)}_setRenderedHover(e){this._renderedHover?.dispose(),this._renderedHover=e,this._hoverVisibleKey.set(!!e),this._hover.containerDomNode.classList.toggle("hidden",!e)}_updateFont(){let{fontSize:e,lineHeight:i}=this._editor.getOption(51),n=this._hover.contentsDomNode;n.style.fontSize=`${e}px`,n.style.lineHeight=`${i/e}`,Array.prototype.slice.call(this._hover.contentsDomNode.getElementsByClassName("code")).forEach(s=>this._editor.applyFontInfo(s))}_updateContent(e){let i=this._hover.contentsDomNode;i.style.paddingBottom="",i.textContent="",i.appendChild(e)}_layoutContentWidget(){this._editor.layoutContentWidget(this),this._hover.onContentsChanged()}_updateMaxDimensions(){let e=Math.max(this._editor.getLayoutInfo().height/4,250,gl._lastDimensions.height),i=Math.max(this._editor.getLayoutInfo().width*.66,750,gl._lastDimensions.width);this._setHoverWidgetMaxDimensions(i,e)}_render(e){this._setRenderedHover(e),this._updateFont(),this._updateContent(e.domNode),this._updateMaxDimensions(),this.onContentsChanged(),this._editor.render()}getPosition(){return this._renderedHover?{position:this._renderedHover.showAtPosition,secondaryPosition:this._renderedHover.showAtSecondaryPosition,positionAffinity:this._renderedHover.shouldAppearBeforeContent?3:void 0,preference:[this._positionPreference??1]}:null}show(e){if(!this._editor||!this._editor.hasModel())return;this._render(e);let i=Tm(this._hover.containerDomNode),n=e.showAtPosition;this._positionPreference=this._findPositionPreference(i,n)??1,this.onContentsChanged(),e.shouldFocus&&this._hover.containerDomNode.focus(),this._onDidResize.fire();let s=this._hover.containerDomNode.ownerDocument.activeElement===this._hover.containerDomNode&&Yse(this._configurationService.getValue("accessibility.verbosity.hover")===!0&&this._accessibilityService.isScreenReaderOptimized(),this._keybindingService.lookupKeybinding("editor.action.accessibleView")?.getAriaLabel()??"");s&&(this._hover.contentsDomNode.ariaLabel=this._hover.contentsDomNode.textContent+", "+s)}hide(){if(!this._renderedHover)return;let e=this._renderedHover.shouldFocus||this._hoverFocusedKey.get();this._setRenderedHover(void 0),this._resizableNode.maxSize=new Ge(1/0,1/0),this._resizableNode.clearSashHoverState(),this._hoverFocusedKey.set(!1),this._editor.layoutContentWidget(this),e&&this._editor.focus()}_removeConstraintsRenderNormally(){let e=this._editor.getLayoutInfo();this._resizableNode.layout(e.height,e.width),this._setHoverWidgetDimensions("auto","auto")}setMinimumDimensions(e){this._minimumSize=new Ge(Math.max(this._minimumSize.width,e.width),Math.max(this._minimumSize.height,e.height)),this._updateMinimumWidth()}_updateMinimumWidth(){let e=typeof this._contentWidth>"u"?this._minimumSize.width:Math.min(this._contentWidth,this._minimumSize.width);this._resizableNode.minSize=new Ge(e,this._minimumSize.height)}onContentsChanged(){this._removeConstraintsRenderNormally();let e=this._hover.containerDomNode,i=Tm(e),n=xm(e);if(this._resizableNode.layout(i,n),this._setHoverWidgetDimensions(n,i),i=Tm(e),n=xm(e),this._contentWidth=n,this._updateMinimumWidth(),this._resizableNode.layout(i,n),this._renderedHover?.showAtPosition){let o=Tm(this._hover.containerDomNode);this._positionPreference=this._findPositionPreference(o,this._renderedHover.showAtPosition)}this._layoutContentWidget()}focus(){this._hover.containerDomNode.focus()}scrollUp(){let e=this._hover.scrollbar.getScrollPosition().scrollTop,i=this._editor.getOption(51);this._hover.scrollbar.setScrollPosition({scrollTop:e-i.lineHeight})}scrollDown(){let e=this._hover.scrollbar.getScrollPosition().scrollTop,i=this._editor.getOption(51);this._hover.scrollbar.setScrollPosition({scrollTop:e+i.lineHeight})}scrollLeft(){let e=this._hover.scrollbar.getScrollPosition().scrollLeft;this._hover.scrollbar.setScrollPosition({scrollLeft:e-vhe})}scrollRight(){let e=this._hover.scrollbar.getScrollPosition().scrollLeft;this._hover.scrollbar.setScrollPosition({scrollLeft:e+vhe})}pageUp(){let e=this._hover.scrollbar.getScrollPosition().scrollTop,i=this._hover.scrollbar.getScrollDimensions().height;this._hover.scrollbar.setScrollPosition({scrollTop:e-i})}pageDown(){let e=this._hover.scrollbar.getScrollPosition().scrollTop,i=this._hover.scrollbar.getScrollDimensions().height;this._hover.scrollbar.setScrollPosition({scrollTop:e+i})}goToTop(){this._hover.scrollbar.setScrollPosition({scrollTop:0})}goToBottom(){this._hover.scrollbar.setScrollPosition({scrollTop:this._hover.scrollbar.getScrollDimensions().scrollHeight})}};gl=E([b(1,re),b(2,se),b(3,Un),b(4,Be)],gl);function Ihe(r,t,e,i,n,o){let s=e+n/2,a=i+o/2,l=Math.max(Math.abs(r-s)-n/2,0),d=Math.max(Math.abs(t-a)-o/2,0);return Math.sqrt(l*l+d*d)}var iT=class extends R{constructor(e,i,n){super();this._editor=e;this._instantiationService=i;this._keybindingService=n;this._contentHoverWidget=this._register(this._instantiationService.createInstance(gl,this._editor)),this._participants=this._initializeHoverParticipants(),this._hoverOperation=this._register(new UU(this._editor,new $U(this._editor,this._participants))),this._registerListeners()}_currentResult=null;_renderedContentHover;_contentHoverWidget;_participants;_hoverOperation;_onContentsChanged=this._register(new x);onContentsChanged=this._onContentsChanged.event;_initializeHoverParticipants(){let e=[];for(let i of $pe.getAll()){let n=this._instantiationService.createInstance(i,this._editor);e.push(n)}return e.sort((i,n)=>i.hoverOrdinal-n.hoverOrdinal),this._register(this._contentHoverWidget.onDidResize(()=>{this._participants.forEach(i=>i.handleResize?.())})),e}_registerListeners(){this._register(this._hoverOperation.onResult(i=>{let n=i.hasLoadingMessage?this._addLoadingMessage(i):i.value;this._withResult(new IP(n,i.isComplete,i.options))}));let e=this._contentHoverWidget.getDomNode();this._register(Ut(e,"keydown",i=>{i.equals(9)&&this.hide()})),this._register(Ut(e,"mouseleave",i=>{this._onMouseLeave(i)})),this._register(Is.onDidChange(()=>{this._contentHoverWidget.position&&this._currentResult&&this._setCurrentResult(this._currentResult)}))}_startShowingOrUpdateHover(e,i,n,o,s){if(!(this._contentHoverWidget.position&&this._currentResult))return e?(this._startHoverOperationIfNecessary(e,i,n,o,!1),!0):!1;let l=this._editor.getOption(61).sticky,d=s&&this._contentHoverWidget.isMouseGettingCloser(s.event.posx,s.event.posy);return l&&d?(e&&this._startHoverOperationIfNecessary(e,i,n,o,!0),!0):e?this._currentResult&&this._currentResult.options.anchor.equals(e)?!0:this._currentResult&&e.canAdoptVisibleHover(this._currentResult.options.anchor,this._contentHoverWidget.position)?(this._currentResult&&this._setCurrentResult(this._currentResult.filter(e)),this._startHoverOperationIfNecessary(e,i,n,o,!1),!0):(this._setCurrentResult(null),this._startHoverOperationIfNecessary(e,i,n,o,!1),!0):(this._setCurrentResult(null),!1)}_startHoverOperationIfNecessary(e,i,n,o,s){if(this._hoverOperation.options&&this._hoverOperation.options.anchor.equals(e))return;this._hoverOperation.cancel();let l={anchor:e,source:n,shouldFocus:o,insistOnKeepingHoverVisible:s};this._hoverOperation.start(i,l)}_setCurrentResult(e){let i=e;if(this._currentResult===i)return;i&&i.hoverParts.length===0&&(i=null),this._currentResult=i,this._currentResult?this._showHover(this._currentResult):this._hideHover()}_addLoadingMessage(e){for(let i of this._participants){if(!i.createLoadingMessage)continue;let n=i.createLoadingMessage(e.options.anchor);if(n)return e.value.slice(0).concat([n])}return e.value}_withResult(e){if(this._contentHoverWidget.position&&this._currentResult&&this._currentResult.isComplete||this._setCurrentResult(e),!e.isComplete)return;let o=e.hoverParts.length===0,s=e.options.insistOnKeepingHoverVisible;o&&s||this._setCurrentResult(e)}_showHover(e){let i=this._getHoverContext();this._renderedContentHover=new _2(this._editor,e,this._participants,i,this._keybindingService),this._renderedContentHover.domNodeHasChildren?this._contentHoverWidget.show(this._renderedContentHover):this._renderedContentHover.dispose()}_hideHover(){this._contentHoverWidget.hide()}_getHoverContext(){return{hide:()=>{this.hide()},onContentsChanged:()=>{this._onContentsChanged.fire(),this._contentHoverWidget.onContentsChanged()},setMinimumDimensions:o=>{this._contentHoverWidget.setMinimumDimensions(o)}}}showsOrWillShow(e){if(this._contentHoverWidget.isResizing)return!0;let n=this._findHoverAnchorCandidates(e);if(!(n.length>0))return this._startShowingOrUpdateHover(null,0,0,!1,e);let s=n[0];return this._startShowingOrUpdateHover(s,0,0,!1,e)}_findHoverAnchorCandidates(e){let i=[];for(let o of this._participants){if(!o.suggestHoverAnchor)continue;let s=o.suggestHoverAnchor(e);s&&i.push(s)}let n=e.target;switch(n.type){case 6:{i.push(new zx(0,n.range,e.event.posx,e.event.posy));break}case 7:{let o=this._editor.getOption(51).typicalHalfwidthCharacterWidth/2;if(!(!n.detail.isAfterLines&&typeof n.detail.horizontalDistanceToText=="number"&&n.detail.horizontalDistanceToText<o))break;i.push(new zx(0,n.range,e.event.posx,e.event.posy));break}}return i.sort((o,s)=>s.priority-o.priority),i}_onMouseLeave(e){let i=this._editor.getDomNode();(!i||!GU(i,e.x,e.y))&&this.hide()}startShowingAtRange(e,i,n,o){this._startShowingOrUpdateHover(new zx(0,e,void 0,void 0),i,n,o,null)}getWidgetContent(){let e=this._contentHoverWidget.getDomNode();if(e.textContent)return e.textContent}async updateHoverVerbosityLevel(e,i,n){this._renderedContentHover?.updateHoverVerbosityLevel(e,i,n)}doesHoverAtIndexSupportVerbosityAction(e,i){return this._renderedContentHover?.doesHoverAtIndexSupportVerbosityAction(e,i)??!1}getAccessibleWidgetContent(){return this._renderedContentHover?.getAccessibleWidgetContent()}getAccessibleWidgetContentAtIndex(e){return this._renderedContentHover?.getAccessibleWidgetContentAtIndex(e)}focusedHoverPartIndex(){return this._renderedContentHover?.focusedHoverPartIndex??-1}containsNode(e){return e?this._contentHoverWidget.getDomNode().contains(e):!1}focus(){this._contentHoverWidget.focus()}focusHoverPartWithIndex(e){this._renderedContentHover?.focusHoverPartWithIndex(e)}scrollUp(){this._contentHoverWidget.scrollUp()}scrollDown(){this._contentHoverWidget.scrollDown()}scrollLeft(){this._contentHoverWidget.scrollLeft()}scrollRight(){this._contentHoverWidget.scrollRight()}pageUp(){this._contentHoverWidget.pageUp()}pageDown(){this._contentHoverWidget.pageDown()}goToTop(){this._contentHoverWidget.goToTop()}goToBottom(){this._contentHoverWidget.goToBottom()}hide(){this._hoverOperation.cancel(),this._setCurrentResult(null)}getDomNode(){return this._contentHoverWidget.getDomNode()}get isColorPickerVisible(){return this._renderedContentHover?.isColorPickerVisible()??!1}get isVisibleFromKeyboard(){return this._contentHoverWidget.isVisibleFromKeyboard}get isVisible(){return this._contentHoverWidget.isVisible}get isFocused(){return this._contentHoverWidget.isFocused}get isResizing(){return this._contentHoverWidget.isResizing}get widget(){return this._contentHoverWidget}};iT=E([b(1,ne),b(2,Be)],iT);var D2=!1,Dg=class extends R{constructor(e,i,n){super();this._editor=e;this._instantiationService=i;this._keybindingService=n;this._reactToEditorMouseMoveRunner=this._register(new Ye(()=>this._reactToEditorMouseMove(this._mouseMoveEvent),0)),this._hookListeners(),this._register(this._editor.onDidChangeConfiguration(o=>{o.hasChanged(61)&&(this._unhookListeners(),this._hookListeners())}))}_onHoverContentsChanged=this._register(new x);onHoverContentsChanged=this._onHoverContentsChanged.event;static ID="editor.contrib.contentHover";shouldKeepOpenOnEditorMouseMoveOrLeave=!1;_listenersStore=new B;_contentWidget;_mouseMoveEvent;_reactToEditorMouseMoveRunner;_hoverSettings;_hoverState={mouseDown:!1,activatedByDecoratorClick:!1};static get(e){return e.getContribution(Dg.ID)}_hookListeners(){let e=this._editor.getOption(61);this._hoverSettings={enabled:e.enabled,sticky:e.sticky,hidingDelay:e.hidingDelay},e.enabled?(this._listenersStore.add(this._editor.onMouseDown(i=>this._onEditorMouseDown(i))),this._listenersStore.add(this._editor.onMouseUp(()=>this._onEditorMouseUp())),this._listenersStore.add(this._editor.onMouseMove(i=>this._onEditorMouseMove(i))),this._listenersStore.add(this._editor.onKeyDown(i=>this._onKeyDown(i)))):(this._listenersStore.add(this._editor.onMouseMove(i=>this._onEditorMouseMove(i))),this._listenersStore.add(this._editor.onKeyDown(i=>this._onKeyDown(i)))),this._listenersStore.add(this._editor.onMouseLeave(i=>this._onEditorMouseLeave(i))),this._listenersStore.add(this._editor.onDidChangeModel(()=>{this._cancelScheduler(),this._hideWidgets()})),this._listenersStore.add(this._editor.onDidChangeModelContent(()=>this._cancelScheduler())),this._listenersStore.add(this._editor.onDidScrollChange(i=>this._onEditorScrollChanged(i)))}_unhookListeners(){this._listenersStore.clear()}_cancelScheduler(){this._mouseMoveEvent=void 0,this._reactToEditorMouseMoveRunner.cancel()}_onEditorScrollChanged(e){(e.scrollTopChanged||e.scrollLeftChanged)&&this._hideWidgets()}_onEditorMouseDown(e){this._hoverState.mouseDown=!0,!this._shouldNotHideCurrentHoverWidget(e)&&this._hideWidgets()}_shouldNotHideCurrentHoverWidget(e){return this._isMouseOnContentHoverWidget(e)||this._isContentWidgetResizing()}_isMouseOnContentHoverWidget(e){let i=this._contentWidget?.getDomNode();return i?GU(i,e.event.posx,e.event.posy):!1}_onEditorMouseUp(){this._hoverState.mouseDown=!1}_onEditorMouseLeave(e){this.shouldKeepOpenOnEditorMouseMoveOrLeave||(this._cancelScheduler(),this._shouldNotHideCurrentHoverWidget(e))||D2||this._hideWidgets()}_shouldNotRecomputeCurrentHoverWidget(e){let i=this._hoverSettings.sticky,n=(a,l)=>{let d=this._isMouseOnContentHoverWidget(a);return l&&d},o=a=>{let l=this._isMouseOnContentHoverWidget(a),d=this._contentWidget?.isColorPickerVisible??!1;return l&&d},s=(a,l)=>(l&&this._contentWidget?.containsNode(a.event.browserEvent.view?.document.activeElement)&&!a.event.browserEvent.view?.getSelection()?.isCollapsed)??!1;return n(e,i)||o(e)||s(e,i)}_onEditorMouseMove(e){if(this.shouldKeepOpenOnEditorMouseMoveOrLeave||(this._mouseMoveEvent=e,this._contentWidget?.isFocused||this._contentWidget?.isResizing))return;let i=this._hoverSettings.sticky;if(i&&this._contentWidget?.isVisibleFromKeyboard)return;if(this._shouldNotRecomputeCurrentHoverWidget(e)){this._reactToEditorMouseMoveRunner.cancel();return}let o=this._hoverSettings.hidingDelay;if(this._contentWidget?.isVisible&&i&&o>0){this._reactToEditorMouseMoveRunner.isScheduled()||this._reactToEditorMouseMoveRunner.schedule(o);return}this._reactToEditorMouseMove(e)}_reactToEditorMouseMove(e){if(!e)return;let n=e.target.element?.classList.contains("colorpicker-color-decoration"),o=this._editor.getOption(150),s=this._hoverSettings.enabled,a=this._hoverState.activatedByDecoratorClick;if(n&&(o==="click"&&!a||o==="hover"&&!s&&!D2||o==="clickAndHover"&&!s&&!a)||!n&&!s&&!a){this._hideWidgets();return}this._tryShowHoverWidget(e)||D2||this._hideWidgets()}_tryShowHoverWidget(e){return this._getOrCreateContentWidget().showsOrWillShow(e)}_onKeyDown(e){if(!this._editor.hasModel())return;let i=this._keybindingService.softDispatch(e,this._editor.getDomNode()),n=i.kind===1||i.kind===2&&(i.commandId===qpe||i.commandId===gP||i.commandId===fP)&&this._contentWidget?.isVisible;e.keyCode===5||e.keyCode===6||e.keyCode===57||e.keyCode===4||n||this._hideWidgets()}_hideWidgets(){D2||this._hoverState.mouseDown&&this._contentWidget?.isColorPickerVisible||Kh.dropDownVisible||(this._hoverState.activatedByDecoratorClick=!1,this._contentWidget?.hide())}_getOrCreateContentWidget(){return this._contentWidget||(this._contentWidget=this._instantiationService.createInstance(iT,this._editor),this._listenersStore.add(this._contentWidget.onContentsChanged(()=>this._onHoverContentsChanged.fire()))),this._contentWidget}hideContentHover(){this._hideWidgets()}showContentHover(e,i,n,o,s=!1){this._hoverState.activatedByDecoratorClick=s,this._getOrCreateContentWidget().startShowingAtRange(e,i,n,o)}_isContentWidgetResizing(){return this._contentWidget?.widget.isResizing||!1}focusedHoverPartIndex(){return this._getOrCreateContentWidget().focusedHoverPartIndex()}doesHoverAtIndexSupportVerbosityAction(e,i){return this._getOrCreateContentWidget().doesHoverAtIndexSupportVerbosityAction(e,i)}updateHoverVerbosityLevel(e,i,n){this._getOrCreateContentWidget().updateHoverVerbosityLevel(e,i,n)}focus(){this._contentWidget?.focus()}focusHoverPartWithIndex(e){this._contentWidget?.focusHoverPartWithIndex(e)}scrollUp(){this._contentWidget?.scrollUp()}scrollDown(){this._contentWidget?.scrollDown()}scrollLeft(){this._contentWidget?.scrollLeft()}scrollRight(){this._contentWidget?.scrollRight()}pageUp(){this._contentWidget?.pageUp()}pageDown(){this._contentWidget?.pageDown()}goToTop(){this._contentWidget?.goToTop()}goToBottom(){this._contentWidget?.goToBottom()}getWidgetContent(){return this._contentWidget?.getWidgetContent()}getAccessibleWidgetContent(){return this._contentWidget?.getAccessibleWidgetContent()}getAccessibleWidgetContentAtIndex(e){return this._contentWidget?.getAccessibleWidgetContentAtIndex(e)}get isColorPickerVisible(){return this._contentWidget?.isColorPickerVisible}get isHoverVisible(){return this._contentWidget?.isVisible}dispose(){super.dispose(),this._unhookListeners(),this._listenersStore.dispose(),this._contentWidget?.dispose()}};Dg=E([b(1,ne),b(2,Be)],Dg);var PP=class extends ko{constructor(e){super();this.label=e;this._domNode=J(".floating-click-widget"),this._domNode.style.padding="6px 11px",this._domNode.style.borderRadius="2px",this._domNode.style.cursor="pointer",this._domNode.style.zIndex="1"}_onClick=this._register(new x);onClick=this._onClick.event;_domNode;getDomNode(){return this._domNode}render(){ai(this._domNode),this._domNode.style.backgroundColor=ek(Of,Se(Hs)),this._domNode.style.color=ek(rk,Se(Qo)),this._domNode.style.border=`1px solid ${Se(Oe)}`,U(this._domNode,J("")).textContent=this.label,this.onclick(this._domNode,()=>this._onClick.fire())}},Zy=class extends R{renderEmitter=new x;onDidRender=this.renderEmitter.event;menu;constructor(t,e,i){super(),this.menu=this._register(e.createMenu(t,i))}render(){let t=this._register(new B),e=()=>{if(t.clear(),!this.isVisible())return;let i=[];if(Vo(this.menu,{renderShortTitle:!0,shouldForwardArgs:!0},i),i.length===0)return;let[n]=i,o=this.createWidget(n,t);t.add(o),t.add(o.onClick(()=>n.run(this.getActionArg()))),o.render()};this._register(this.menu.onDidChange(e)),e()}getActionArg(){}isVisible(){return!0}};Zy=E([b(1,jt),b(2,re)],Zy);var k2=class extends Zy{constructor(e,i,n,o){super(e.menuId,n,o);this.options=e;this.instantiationService=i;this.render()}createWidget(e,i){let n=this.instantiationService.createInstance(PP,e.label),o=n.getDomNode();return this.options.container.appendChild(o),i.add(le(()=>o.remove())),n}getActionArg(){return this.options.getActionArg()}};k2=E([b(1,ne),b(2,jt),b(3,re)],k2);var Jy=class extends R{constructor(e){super();this.editorService=e}_onHighlightRemoved=this._register(new x);onHighlightRemoved=this._onHighlightRemoved.event;rangeHighlightDecorationId=null;editor=null;editorDisposables=this._register(new B);removeHighlightRange(){if(this.editor&&this.rangeHighlightDecorationId){let e=this.rangeHighlightDecorationId;this.editor.changeDecorations(i=>{i.removeDecoration(e)}),this._onHighlightRemoved.fire()}this.rangeHighlightDecorationId=null}highlightRange(e,i){i=i??this.getEditor(e),no(i)?this.doHighlightRange(i,e):joe(i)&&no(i.activeCodeEditor)&&this.doHighlightRange(i.activeCodeEditor,e)}doHighlightRange(e,i){this.removeHighlightRange(),e.changeDecorations(n=>{this.rangeHighlightDecorationId=n.addDecoration(i.range,this.createRangeHighlightDecoration(i.isWholeLine))}),this.setEditor(e)}getEditor(e){let i=this.editorService.activeEditor?.resource;if(i&&zi(i,e.resource)&&no(this.editorService.activeTextEditorControl))return this.editorService.activeTextEditorControl}setEditor(e){this.editor!==e&&(this.editorDisposables.clear(),this.editor=e,this.editorDisposables.add(this.editor.onDidChangeCursorPosition(i=>{(i.reason===0||i.reason===3||i.reason===5||i.reason===6)&&this.removeHighlightRange()})),this.editorDisposables.add(this.editor.onDidChangeModel(()=>{this.removeHighlightRange()})),this.editorDisposables.add(this.editor.onDidDispose(()=>{this.removeHighlightRange(),this.editor=null})))}static _WHOLE_LINE_RANGE_HIGHLIGHT=Ii.register({description:"codeeditor-range-highlight-whole",stickiness:1,className:"rangeHighlight",isWholeLine:!0});static _RANGE_HIGHLIGHT=Ii.register({description:"codeeditor-range-highlight",stickiness:1,className:"rangeHighlight"});createRangeHighlightDecoration(e=!0){return e?Jy._WHOLE_LINE_RANGE_HIGHLIGHT:Jy._RANGE_HIGHLIGHT}dispose(){super.dispose(),this.editor?.getModel()&&(this.removeHighlightRange(),this.editor=null)}};Jy=E([b(0,$e)],Jy);var MP=class extends PP{constructor(e,i,n,o){super(n&&o.lookupKeybinding(n)?`${i} (${o.lookupKeybinding(n).getLabel()})`:i);this.editor=e}getId(){return"editor.overlayWidget.floatingClickWidget"}getPosition(){return{preference:1}}render(){super.render(),this.editor.addOverlayWidget(this)}dispose(){this.editor.removeOverlayWidget(this),super.dispose()}};MP=E([b(3,Be)],MP);var L2=class extends Zy{constructor(e,i,n,o){super(V.EditorContent,n,o);this.editor=e;this.instantiationService=i;this.render()}static ID="editor.contrib.floatingClickMenu";createWidget(e){return this.instantiationService.createInstance(MP,this.editor,e.label,e.id)}isVisible(){return!(this.editor instanceof ml)&&this.editor?.hasModel()&&!this.editor.getOption(62)}getActionArg(){return this.editor.getModel()?.uri}};L2=E([b(1,ne),b(2,jt),b(3,re)],L2);var vY=J,R2=!0,P2,Xs,nT=class extends Lr{constructor(e,i,n,o,s,a,l,d,c,p,h,m,f){super(e,o,i,s,d,l,a,c,p,h,m);this.debugService=n;this.menuService=f;this.updateTreeScheduler=new Ye(async()=>{let g=this.debugService.getViewModel().focusedStackFrame;this.needsRefresh=!1;let v=this.tree.getInput();if(v&&this.savedViewState.set(v.getId(),this.tree.getViewState()),!g){await this.tree.setInput(null);return}let I=this.savedViewState.get(g.getId());await this.tree.setInput(g,I);let w=(await g.getScopes()).find(C=>!C.expensive);w&&this.tree.hasNode(w)&&(this.autoExpandedScopes.add(w.getId()),await this.tree.expand(w))},400)}updateTreeScheduler;needsRefresh=!1;tree;savedViewState=new Map;autoExpandedScopes=new Set;renderBody(e){super.renderBody(e),this.element.classList.add("debug-pane"),e.classList.add("debug-variables");let i=nv(e),n=this.instantiationService.createInstance(id);this.tree=this.instantiationService.createInstance(is,"VariablesView",i,new yY,[this.instantiationService.createInstance(rd,n),this.instantiationService.createInstance(ma,n),new A2,new O2],this.instantiationService.createInstance(IY),{accessibilityProvider:new SY,identityProvider:{getId:s=>s.getId()},keyboardNavigationLabelProvider:{getKeyboardNavigationLabel:s=>s.name},overrideStyles:this.getLocationBasedColors().listOverrideStyles}),this._register(ma.rendererOnVisualizationRange(this.debugService.getViewModel(),this.tree)),this.tree.setInput(this.debugService.getViewModel().focusedStackFrame??null),aV.bindTo(this.tree.contextKeyService),this._register(this.debugService.getViewModel().onDidFocusStackFrame(s=>{if(!this.isBodyVisible()){this.needsRefresh=!0;return}let a=s.explicit?0:void 0;this.updateTreeScheduler.schedule(a)})),this._register(this.debugService.getViewModel().onWillUpdateViews(()=>{let s=this.debugService.getViewModel().focusedStackFrame;s&&R2&&s.forgetScopes(),R2=!0,this.tree.updateChildren()})),this._register(this.tree),this._register(this.tree.onMouseDblClick(s=>this.onMouseDblClick(s))),this._register(this.tree.onContextMenu(async s=>await this.onContextMenu(s))),this._register(this.onDidChangeBodyVisibility(s=>{s&&this.needsRefresh&&this.updateTreeScheduler.schedule()}));let o;this._register(this.debugService.getViewModel().onDidSelectExpression(s=>{let a=s?.expression;a&&this.tree.hasNode(a)?(o=this.tree.options.horizontalScrolling,o&&this.tree.updateOptions({horizontalScrolling:!1}),this.tree.rerender(a)):!s&&o!==void 0&&(this.tree.updateOptions({horizontalScrolling:o}),o=void 0)})),this._register(this.debugService.getViewModel().onDidEvaluateLazyExpression(async s=>{s instanceof Li&&this.tree.hasNode(s)&&(await this.tree.updateChildren(s,!1,!0),await this.tree.expand(s))})),this._register(this.debugService.onDidEndSession(()=>{this.savedViewState.clear(),this.autoExpandedScopes.clear()}))}layoutBody(e,i){super.layoutBody(i,e),this.tree.layout(e,i)}focus(){super.focus(),this.tree.domFocus()}collapseAll(){this.tree.collapseAll()}onMouseDblClick(e){this.canSetExpressionValue(e.element)&&this.debugService.getViewModel().setSelectedExpression(e.element,!1)}canSetExpressionValue(e){return this.debugService.getViewModel().focusedSession?e instanceof Xl?!!e.treeItem.canEdit:e instanceof Li&&!e.presentationHint?.attributes?.includes("readOnly")&&!e.presentationHint?.lazy:!1}async onContextMenu(e){let i=e.element;if(!(!(i instanceof Li)||!i.value))return CY(this.contextKeyService,this.menuService,this.contextMenuService,V.DebugVariablesContext,e)}};nT=E([b(1,vt),b(2,we),b(3,Be),b(4,se),b(5,ne),b(6,$i),b(7,re),b(8,Yi),b(9,Fe),b(10,Tt),b(11,Nt),b(12,jt)],nT);async function CY(r,t,e,i,n){let o=n.element;if(!(o instanceof Li)||!o.value)return;let s=await C_e(r,o),a=wY(o),l=t.getMenuActions(i,s,{arg:a,shouldForwardArgs:!1}),d=[];sa(l,{primary:[],secondary:d},"inline"),e.showContextMenu({getAnchor:()=>n.anchor,getActions:()=>d})}var wY=r=>({sessionId:r.getSession()?.getId(),container:r.parent instanceof Hi?{expression:r.parent.name}:r.parent.toDebugProtocolObject(),variable:r.toDebugProtocolObject()});async function C_e(r,t){let e=t.getSession();if(!e||!e.capabilities.supportsDataBreakpoints)return M2(r,t);let i=[];Xs=await e.dataBreakpointInfo(t.name,t.parent.reference);let n=Xs?.dataId,o=Xs?.accessTypes;if(!o)i.push([yE.key,!!n]);else for(let s of o)switch(s){case"read":i.push([eR.key,!!n]);break;case"write":i.push([yE.key,!!n]);break;case"readWrite":i.push([JL.key,!!n]);break}return M2(r,t,i)}function M2(r,t,e=[]){return P2=t,BB(r,t,e)}function She(r){return r instanceof Ma}var IY=class extends Hh{hasChildren(t){return t?She(t)?!0:t.hasChildren:!1}doGetChildren(t){return She(t)?t.getScopes():t.getChildren()}},yY=class{getHeight(t){return 22}getTemplateId(t){return t instanceof UL?O2.ID:t instanceof sg?A2.ID:t instanceof Xl?ma.ID:rd.ID}},A2=class r{static ID="scope";get templateId(){return r.ID}renderTemplate(t){let e=U(t,vY(".scope")),i=new Rr(e);return{name:e,label:i}}renderElement(t,e,i){i.label.set(t.element.name,qo(t.filterData))}disposeTemplate(t){t.label.dispose()}},O2=class r{static ID="scopeError";get templateId(){return r.ID}renderTemplate(t){let e=U(t,vY(".scope"));return{error:U(e,vY(".error"))}}renderElement(t,e,i){i.error.innerText=t.element.name}disposeTemplate(){}},ma=class extends qu{constructor(e,i,n,o,s,a){super(i,n,o);this.linkDetector=e;this.menuService=s;this.contextKeyService=a}static ID="viz";static rendererOnVisualizationRange(e,i){return e.onDidChangeVisualization(({original:n})=>{if(!i.hasNode(n))return;let o=i.getParentElement(n);i.updateChildren(o,!1,!1)})}get templateId(){return ma.ID}renderElement(e,i,n){n.elementDisposable.clear(),super.renderExpressionElement(e.element,e,n)}renderExpression(e,i,n){let o=e,s=o.name;o.value&&typeof o.name=="string"&&(s+=":"),i.label.set(s,n,o.name),Xd(i.elementDisposable,o,i.value,{showChanged:!1,maxValueLength:1024,colorize:!0,linkDetector:this.linkDetector},this.hoverService)}getInputBoxOptions(e){let i=e;return{initialValue:e.value,ariaLabel:u("variableValueAriaLabel","Type new variable value"),validationOptions:{validation:()=>i.errorMessage?{content:i.errorMessage}:null},onFinish:(n,o)=>{i.errorMessage=void 0,o&&i.edit(n).then(()=>{R2=!1,this.debugService.getViewModel().updateViews()})}}}renderActionBar(e,i,n){let o=i,s=o.original?M2(this.contextKeyService,o.original):this.contextKeyService,a=o.original?wY(o.original):void 0,l=this.menuService.getMenuActions(V.DebugVariablesContext,s,{arg:a,shouldForwardArgs:!1}),d=[];if(sa(l,{primary:d,secondary:[]},"inline"),o.original){let c=new et("debugViz",u("removeVisualizer","Remove Visualizer"),de.asClassName(N.eye),!0,()=>this.debugService.getViewModel().setVisualizedExpression(o.original,void 0));c.checked=!0,d.push(c),e.domNode.style.display="initial"}e.clear(),e.context=a,e.push(d,{icon:!0,label:!1})}};ma=E([b(1,we),b(2,so),b(3,Nt),b(4,jt),b(5,re)],ma);var rd=class extends qu{constructor(e,i,n,o,s,a,l,d,c,p){super(l,d,c);this.linkDetector=e;this.menuService=i;this.contextKeyService=n;this.visualization=o;this.contextMenuService=s;this.commandService=a;this.configurationService=p}static ID="variable";get templateId(){return rd.ID}renderExpression(e,i,n){let o=this.configurationService.getValue("debug").showVariableTypes;_U(i.elementDisposable,this.commandService,this.hoverService,e,i,!0,n,this.linkDetector,o)}renderElement(e,i,n){n.elementDisposable.clear(),n.elementDisposable.add(this.configurationService.onDidChangeConfiguration(o=>{o.affectsConfiguration("debug.showVariableTypes")&&super.renderExpressionElement(e.element,e,n)})),super.renderExpressionElement(e.element,e,n)}getInputBoxOptions(e){let i=e;return{initialValue:e.value,ariaLabel:u("variableValueAriaLabel","Type new variable value"),validationOptions:{validation:()=>i.errorMessage?{content:i.errorMessage}:null},onFinish:(n,o)=>{i.errorMessage=void 0;let s=this.debugService.getViewModel().focusedStackFrame;o&&i.value!==n&&s&&i.setVariable(n,s).then(()=>{R2=!1,this.debugService.getViewModel().updateViews()})}}}renderActionBar(e,i,n){let o=i,s=M2(this.contextKeyService,o),a=[],l=wY(o),d=this.menuService.getMenuActions(V.DebugVariablesContext,s,{arg:l,shouldForwardArgs:!1});sa(d,{primary:a,secondary:[]},"inline"),e.clear(),e.context=l,e.push(a,{icon:!0,label:!1});let c=new Kt;n.elementDisposable.add(le(()=>c.dispose(!0))),this.visualization.getApplicableFor(i,c.token).then(p=>{n.elementDisposable.add(p);let h=i instanceof Xl&&i.original||i,m=p.object.map(f=>new et("debugViz",f.name,f.iconClass||"debug-viz-icon",void 0,this.useVisualizer(f,h,c.token)));m.length===0||(m.length===1?e.push(m[0],{icon:!0,label:!1}):e.push(new et("debugViz",u("useVisualizer","Visualize Variable..."),de.asClassName(N.eye),void 0,()=>this.pickVisualizer(m,h,n)),{icon:!0,label:!1}))})}pickVisualizer(e,i,n){this.contextMenuService.showContextMenu({getAnchor:()=>n.actionBar.getContainer(),getActions:()=>e})}useVisualizer(e,i,n){return async()=>{let o=await e.resolve(n);if(!n.isCancellationRequested)if(o.type===0)e.execute();else{let s=await this.visualization.getVisualizedNodeFor(o.id,i);s&&this.debugService.getViewModel().setVisualizedExpression(i,s)}}}};rd=E([b(1,jt),b(2,re),b(3,hE),b(4,vt),b(5,ct),b(6,we),b(7,so),b(8,Nt),b(9,se)],rd);var SY=class{getWidgetAriaLabel(){return u("variablesAriaTreeLabel","Debug Variables")}getAriaLabel(t){return t instanceof sg?u("variableScopeAriaLabel","Scope {0}",t.name):t instanceof Li?u({key:"variableAriaLabel",comment:["Placeholders are variable name and variable value respectivly. They should not be translated."]},"{0}, value {1}",t.name,t.value):null}},EY="debug.setVariable";tt.registerCommand({id:EY,handler:r=>{r.get(we).getViewModel().setSelectedExpression(P2,!1)}});tt.registerCommand({metadata:{description:rP},id:jb,handler:async(r,t,e)=>{let i=r.get(we),n=r.get(rs),o="",s;t instanceof Li||t instanceof Hi?(o="watch",s=e||[]):(o="variables",s=P2?[P2]:[]);let a=i.getViewModel().focusedStackFrame,l=i.getViewModel().focusedSession;if(!a||!l||s.length===0)return;let d=l.capabilities.supportsClipboardContext?"clipboard":o,c=s.map(p=>p instanceof Li?p.evaluateName||p.value:p.name);try{let p=await Promise.all(c.map(m=>l.evaluate(m,a.frameId,d))),h=cn(p).map(m=>m.body.result);h.length&&n.writeText(h.join(`
`))}catch{let h=s.map(m=>m.value);n.writeText(h.join(`
`))}}});var AP="workbench.debug.viewlet.action.viewMemory",Che="ms-vscode.hexeditor",w_e="hexEditor.hexedit";tt.registerCommand({id:AP,handler:async(r,t,e)=>{let i=r.get(we),n,o;if("sessionId"in t){if(!t.sessionId||!t.variable.memoryReference)return;n=t.sessionId,o=t.variable.memoryReference}else{if(!t.memoryReference)return;let h=i.getViewModel().focusedSession;if(!h)return;n=h.getId(),o=t.memoryReference}let s=r.get(KR),a=r.get($e),l=r.get(mi),d=r.get(_n),c=r.get(Tt);(await d.getExtension(Che)||await E_e(s,l))&&(c.publicLog("debug/didViewMemory",{debugType:i.getModel().getSession(n)?.configuration.type}),await a.openEditor({resource:tce(n,o),options:{revealIfOpened:!0,override:w_e}},Vl))}});async function E_e(r,t){try{return await r.install(Che,{justification:u("viewMemory.prompt","Inspecting binary data requires this extension."),enable:!0},15),!0}catch(e){return t.error(e),!1}}var N2="debug.breakWhenValueChanges";tt.registerCommand({id:N2,handler:async r=>{let t=r.get(we);Xs&&await t.addDataBreakpoint({description:Xs.description,src:{type:0,dataId:Xs.dataId},canPersist:!!Xs.canPersist,accessTypes:Xs.accessTypes,accessType:"write"})}});var F2="debug.breakWhenValueIsAccessed";tt.registerCommand({id:F2,handler:async r=>{let t=r.get(we);Xs&&await t.addDataBreakpoint({description:Xs.description,src:{type:0,dataId:Xs.dataId},canPersist:!!Xs.canPersist,accessTypes:Xs.accessTypes,accessType:"readWrite"})}});var B2="debug.breakWhenValueIsRead";tt.registerCommand({id:B2,handler:async r=>{let t=r.get(we);Xs&&await t.addDataBreakpoint({description:Xs.description,src:{type:0,dataId:Xs.dataId},canPersist:!!Xs.canPersist,accessTypes:Xs.accessTypes,accessType:"read"})}});tt.registerCommand({metadata:{description:oP},id:zy,handler:async(r,t)=>{await r.get(rs).writeText(t.variable.evaluateName)}});tt.registerCommand({metadata:{description:sP},id:eP,handler:async(r,t)=>{r.get(we).addWatchExpression(t.variable.evaluateName)}});he(class extends tr{constructor(){super({id:"variables.collapse",viewId:hy,title:u("collapse","Collapse All"),f1:!1,icon:N.collapseAll,menu:{id:V.ViewTitle,group:"navigation",when:P.equals("view",hy)}})}runInView(r,t){t.collapseAll()}});var oT=J;async function whe(r,t){if(!r)return null;let i=(await r.getChildren()).filter(n=>t[0]===n.name);return i.length!==1?null:t.length===1?i[0]:whe(i[0],t.slice(1))}async function x_e(r,t){let i=(await r.getScopes()).filter(o=>!o.expensive),n=cn(await Promise.all(i.map(o=>whe(o,t))));return n.length>0&&n.every(o=>o.value===n[0].value)?n[0]:void 0}var Zu=class{constructor(t,e,i,n,o,s,a){this.editor=t;this.debugService=e;this.instantiationService=i;this.menuService=n;this.contextKeyService=o;this.contextMenuService=s;this.hoverService=a;this.toDispose=[],this.showAtPosition=null,this.positionPreference=[1,2],this.debugHoverComputer=this.instantiationService.createInstance(OP,this.editor)}static ID="debug.hoverWidget";allowEditorOverflow=!0;_isVisible;safeTriangle;showCancellationSource;domNode;tree;showAtPosition;positionPreference;highlightDecorations=this.editor.createDecorationsCollection();complexValueContainer;complexValueTitle;valueContainer;treeContainer;toDispose;scrollbar;debugHoverComputer;expressionToRender;isUpdatingTree=!1;get isShowingComplexValue(){return this.complexValueContainer?.hidden===!1}create(){this.domNode=oT(".debug-hover-widget"),this.complexValueContainer=U(this.domNode,oT(".complex-value")),this.complexValueTitle=U(this.complexValueContainer,oT(".title")),this.treeContainer=U(this.complexValueContainer,oT(".debug-hover-tree")),this.treeContainer.setAttribute("role","tree");let t=U(this.complexValueContainer,oT(".tip"));t.textContent=u({key:"quickTip",comment:['"switch to editor language hover" means to show the programming language hover widget instead of the debug hover']},"Hold {0} key to switch to editor language hover",ye?"Option":"Alt");let e=this.instantiationService.createInstance(TY),i=this.instantiationService.createInstance(id);this.tree=this.instantiationService.createInstance(is,"DebugHover",this.treeContainer,new _Y,[this.instantiationService.createInstance(rd,i),this.instantiationService.createInstance(ma,i)],e,{accessibilityProvider:new xY,mouseSupport:!1,horizontalScrolling:!0,useShadows:!1,keyboardNavigationLabelProvider:{getKeyboardNavigationLabel:n=>n.name},overrideStyles:{listBackground:Mf}}),this.toDispose.push(ma.rendererOnVisualizationRange(this.debugService.getViewModel(),this.tree)),this.valueContainer=oT(".value"),this.valueContainer.tabIndex=0,this.valueContainer.setAttribute("role","tooltip"),this.scrollbar=new Da(this.valueContainer,{horizontal:2}),this.domNode.appendChild(this.scrollbar.getDomNode()),this.toDispose.push(this.scrollbar),this.editor.applyFontInfo(this.domNode),this.domNode.style.backgroundColor=Se(Mf),this.domNode.style.border=`1px solid ${Se(Ine)}`,this.domNode.style.color=Se(vne),this.toDispose.push(this.tree.onContextMenu(async n=>await this.onContextMenu(n))),this.toDispose.push(this.tree.onDidChangeContentHeight(()=>{this.isUpdatingTree||this.layoutTreeAndContainer()})),this.toDispose.push(this.tree.onDidChangeContentWidth(()=>{this.isUpdatingTree||this.layoutTreeAndContainer()})),this.registerListeners(),this.editor.addContentWidget(this)}async onContextMenu(t){let e=t.element;if(!(!(e instanceof Li)||!e.value))return CY(this.contextKeyService,this.menuService,this.contextMenuService,V.DebugHoverContext,t)}registerListeners(){this.toDispose.push(Ut(this.domNode,"keydown",t=>{t.equals(9)&&this.hide()})),this.toDispose.push(this.editor.onDidChangeConfiguration(t=>{t.hasChanged(51)&&this.editor.applyFontInfo(this.domNode)})),this.toDispose.push(this.debugService.getViewModel().onDidEvaluateLazyExpression(async t=>{t instanceof Li&&this.tree.hasNode(t)&&(await this.tree.updateChildren(t,!1,!0),await this.tree.expand(t))}))}isHovered(){return!!this.domNode?.matches(":hover")}isVisible(){return!!this._isVisible}willBeVisible(){return!!this.showCancellationSource}getId(){return Zu.ID}getDomNode(){return this.domNode}isInSafeTriangle(t,e){return this._isVisible&&!!this.safeTriangle?.contains(t,e)}async showAt(t,e,i){this.showCancellationSource?.dispose(!0);let n=this.showCancellationSource=new Kt,o=this.debugService.getViewModel().focusedSession;if(!o||!this.editor.hasModel())return this.hide(),1;let s=await this.debugHoverComputer.compute(t,n.token);if(n.token.isCancellationRequested)return this.hide(),2;if(!s.range)return this.hide(),1;if(this.isVisible()&&!s.rangeChanged)return 0;let a=await this.debugHoverComputer.evaluate(o);return n.token.isCancellationRequested?(this.hide(),2):!a||a instanceof Hi&&!a.available?(this.hide(),1):(this.highlightDecorations.set([{range:s.range,options:Zu._HOVER_HIGHLIGHT_DECORATION_OPTIONS}]),this.doShow(s.range.getStartPosition(),a,e,i))}static _HOVER_HIGHLIGHT_DECORATION_OPTIONS=Ii.register({description:"bdebug-hover-highlight",className:"hoverHighlight"});async doShow(t,e,i,n){this.domNode||this.create(),this.showAtPosition=t;let o=new B;if(this._isVisible={store:o},!e.hasChildren){this.complexValueContainer.hidden=!0,this.valueContainer.hidden=!1,Xd(o,e,this.valueContainer,{showChanged:!1,colorize:!0,hover:!1},this.hoverService),this.valueContainer.title="",this.editor.layoutContentWidget(this),this.scrollbar.scanDomNode(),i&&(this.editor.render(),this.valueContainer.focus());return}this.valueContainer.hidden=!0,this.expressionToRender=e,this.complexValueTitle.textContent=e.value,this.complexValueTitle.title=e.value,this.editor.layoutContentWidget(this),this.tree.scrollTop=0,this.tree.scrollLeft=0,this.complexValueContainer.hidden=!1,this.safeTriangle=n&&new FA(n.posx,n.posy,this.domNode),i&&(this.editor.render(),this.tree.domFocus())}layoutTreeAndContainer(){this.layoutTree(),this.editor.layoutContentWidget(this)}layoutTree(){let e=1/0;if(this.showAtPosition){let s=this.editor.getDomNode()?.offsetTop||0,a=this.treeContainer.offsetTop+s,l=this.editor.getTopForLineNumber(this.showAtPosition.lineNumber,!0)-this.editor.getScrollTop();a<l&&(e=l+s-22)}let i=Math.min(Math.max(266,this.editor.getLayoutInfo().height*.55),this.tree.contentHeight+10,e),n=this.tree.contentWidth,o=pn(n,400,550);this.tree.layout(i,o),this.treeContainer.style.height=`${i}px`,this.scrollbar.scanDomNode()}beforeRender(){if(this.expressionToRender){let t=this.expressionToRender;this.expressionToRender=void 0,this.isUpdatingTree=!0,this.tree.setInput(t).finally(()=>{this.isUpdatingTree=!1})}return null}afterRender(t){t&&(this.positionPreference=[t])}hide(){this.showCancellationSource&&(this.showCancellationSource.dispose(!0),this.showCancellationSource=void 0),this._isVisible&&(uf(this.domNode)&&this.editor.focus(),this._isVisible.store.dispose(),this._isVisible=void 0,this.highlightDecorations.clear(),this.editor.layoutContentWidget(this),this.positionPreference=[1,2])}getPosition(){return this._isVisible?{position:this.showAtPosition,preference:this.positionPreference}:null}dispose(){this.toDispose=_e(this.toDispose)}};Zu=E([b(1,we),b(2,ne),b(3,jt),b(4,re),b(5,vt),b(6,Nt)],Zu);var xY=class{getWidgetAriaLabel(){return u("treeAriaLabel","Debug Hover")}getAriaLabel(t){return u({key:"variableAriaLabel",comment:["Do not translate placeholders. Placeholders are name and value of a variable."]},"{0}, value {1}, variables, debug",t.name,t.value)}},TY=class extends Hh{hasChildren(t){return t.hasChildren}doGetChildren(t){return t.getChildren()}},_Y=class{getHeight(t){return 18}getTemplateId(t){return t instanceof Xl?ma.ID:rd.ID}},OP=class{constructor(t,e,i,n){this.editor=t;this.debugService=e;this.languageFeaturesService=i;this.logService=n}_current;async compute(t,e){if(!this.debugService.getViewModel().focusedSession||!this.editor.hasModel())return{rangeChanged:!1};let n=this.editor.getModel(),o=await RB(this.languageFeaturesService,n,t,e);if(!o)return{rangeChanged:!1};let{range:s,matchingExpression:a}=o,l=!this._current?.range.equalsRange(s);return this._current={expression:a,range:L.lift(s)},{rangeChanged:l,range:this._current.range}}async evaluate(t){if(!this._current){this.logService.error("No expression to evaluate");return}let e=this.editor.getModel(),i=e&&t.getSourceForUri(e?.uri);if(t.capabilities.supportsEvaluateForHovers){let n=new Hi(this._current.expression);return await n.evaluate(t,this.debugService.getViewModel().focusedStackFrame,"hover",void 0,i?{line:this._current.range.startLineNumber,column:this._current.range.startColumn,source:i.raw}:void 0),n}else{let n=this.debugService.getViewModel().focusedStackFrame;if(n)return await x_e(n,cn(this._current.expression.split(".").map(o=>o.trim())))}}};OP=E([b(1,we),b(2,ni),b(3,bt)],OP);var NP=J,T_e=T("debugExceptionWidget.border","#a31515",u("debugExceptionWidgetBorder","Exception widget border color.")),__e=T("debugExceptionWidget.background",{dark:"#420b0d",light:"#f1dfde",hcDark:"#420b0d",hcLight:"#f1dfde"},u("debugExceptionWidgetBackground","Exception widget background color.")),rT=class extends Fb{constructor(e,i,n,o,s){super(e,{showFrame:!0,showArrow:!0,isAccessible:!0,frameWidth:1,className:"exception-widget-container"});this.exceptionInfo=i;this.debugSession=n;this.instantiationService=s;this.applyTheme(o.getColorTheme()),this._disposables.add(o.onDidColorThemeChange(this.applyTheme.bind(this))),this.create();let a=new Ye(()=>this._doLayout(void 0,void 0),50);this._disposables.add(this.editor.onDidLayoutChange(()=>a.schedule())),this._disposables.add(a)}backgroundColor;applyTheme(e){this.backgroundColor=e.getColor(__e);let i=e.getColor(T_e);this.style({arrowColor:i,frameColor:i})}_applyStyles(){this.container&&(this.container.style.backgroundColor=this.backgroundColor?this.backgroundColor.toString():""),super._applyStyles()}_fillContainer(e){this.setCssClass("exception-widget");let i=this.editor.getOption(51);e.style.fontSize=`${i.fontSize}px`,e.style.lineHeight=`${i.lineHeight}px`,e.tabIndex=0;let n=NP(".title"),o=NP(".label");U(n,o);let s=NP(".actions");U(n,s),o.textContent=this.exceptionInfo.id?u("exceptionThrownWithId","Exception has occurred: {0}",this.exceptionInfo.id):u("exceptionThrown","Exception has occurred.");let a=o.textContent;if(new Fi(s).push(new et("editor.closeExceptionWidget",u("close","Close"),de.asClassName(Goe),!0,async()=>{this.editor.getContribution(dg)?.closeExceptionWidget()}),{label:!1,icon:!0}),U(e,n),this.exceptionInfo.description){let d=NP(".description");d.textContent=this.exceptionInfo.description,a+=", "+this.exceptionInfo.description,U(e,d)}if(this.exceptionInfo.details&&this.exceptionInfo.details.stackTrace){let d=NP(".stack-trace"),p=this.instantiationService.createInstance(id).linkify(this.exceptionInfo.details.stackTrace,!0,this.debugSession?this.debugSession.root:void 0,void 0,{type:0,store:this._disposables});d.appendChild(p),U(e,d),a+=", "+this.exceptionInfo.details.stackTrace}e.setAttribute("aria-label",a)}_doLayout(e,i){this.container.style.height="initial";let n=this.editor.getOption(68),o=Math.round(n/3),s=Math.ceil((this.container.offsetHeight+o)/n);this._relayout(s)}focus(){this.container?.focus()}hasFocus(){return this.container?uf(this.container):!1}};rT=E([b(3,Fe),b(4,ne)],rT);var D_e=100,Ehe=150,k_e=500,xhe=200,Peo=T("editor.inlineValuesForeground",{dark:"#ffffff80",light:"#00000080",hcDark:"#ffffff80",hcLight:"#00000080"},u("editor.inlineValuesForeground","Color for the debug inline value text.")),Meo=T("editor.inlineValuesBackground","#ffc80033",u("editor.inlineValuesBackground","Color for the debug inline value background.")),DY=class{constructor(t,e){this.column=t;this.text=e}};function The(r,t,e=1073741824){return t.length>Ehe&&(t=t.substring(0,Ehe)+"..."),[{range:{startLineNumber:r,endLineNumber:r,startColumn:e,endColumn:e},options:{description:"debug-inline-value-decoration-spacer",after:{content:Jg,cursorStops:3},showIfCollapsed:!0}},{range:{startLineNumber:r,endLineNumber:r,startColumn:e,endColumn:e},options:{description:"debug-inline-value-decoration",after:{content:L_e(t),inlineClassName:"debug-inline-value",inlineClassNameAffectsLetterSpacing:!0,cursorStops:3},showIfCollapsed:!0}}]}function L_e(r){return r.replace(/[ \t]/g,Jg)}function R_e(r,t,e,i){let n=new Map;for(let s of r)if(n.set(s.name,s.value),n.size>=D_e)break;let o=new Map;return n.forEach((s,a)=>{let l=i.get(a);if(l)for(let d of l)t.some(c=>d>=c.startLineNumber&&d<=c.endLineNumber)&&(o.has(d)||o.set(d,[]),o.get(d).indexOf(a)===-1&&o.get(d).push(a))}),[...o].map(([s,a])=>({line:s,variables:a.sort((l,d)=>{let c=e.getLineContent(s);return c.indexOf(l)-c.indexOf(d)}).map(l=>({name:l,value:n.get(l)}))}))}function P_e(r,t,e){if(r.getLineLength(t)>k_e)return;let n=r.getLineContent(t);r.tokenization.forceTokenization(t);let o=r.tokenization.getLineTokens(t);for(let s=0,a=o.getCount();s<a;s++)if(o.getStandardTokenType(s)===0){rI.lastIndex=0;let d=o.getStartOffset(s),c=o.getEndOffset(s),p=n.substring(d,c),h=rI.exec(p);if(h){let m=h[0];e.has(m)||e.set(m,[]),e.get(m).push(t)}}}var kg=class{constructor(t,e,i,n,o,s,a,l,d,c){this.editor=t;this.debugService=e;this.instantiationService=i;this.commandService=n;this.configurationService=o;this.hostService=s;this.uriIdentityService=a;this.languageFeaturesService=d;this.debounceInfo=c.for(d.inlineValuesProvider,"InlineValues",{min:xhe}),this.hoverWidget=this.instantiationService.createInstance(Zu,this.editor),this.toDispose=[this.defaultHoverLockout,this.altListener,this.displayedStore],this.registerListeners(),this.exceptionWidgetVisible=fV.bindTo(l),this.toggleExceptionWidget()}toDispose;hoverWidget;hoverPosition;mouseDown=!1;exceptionWidgetVisible;gutterIsHovered=!1;exceptionWidget;configurationWidget;altListener=new yt;altPressed=!1;oldDecorations=this.editor.createDecorationsCollection();displayedStore=new B;editorHoverOptions;debounceInfo;defaultHoverLockout=new yt;registerListeners(){this.toDispose.push(this.debugService.getViewModel().onDidFocusStackFrame(t=>this.onFocusStackFrame(t.stackFrame))),this.toDispose.push(this.editor.onMouseDown(t=>this.onEditorMouseDown(t))),this.toDispose.push(this.editor.onMouseUp(()=>this.mouseDown=!1)),this.toDispose.push(this.editor.onMouseMove(t=>this.onEditorMouseMove(t))),this.toDispose.push(this.editor.onMouseLeave(t=>{let e=this.hoverWidget.getDomNode();if(!e)return;let i=e.getBoundingClientRect();(t.event.posx<i.left||t.event.posx>i.right||t.event.posy<i.top||t.event.posy>i.bottom)&&this.hideHoverWidget()})),this.toDispose.push(this.editor.onKeyDown(t=>this.onKeyDown(t))),this.toDispose.push(this.editor.onDidChangeModelContent(()=>{this._wordToLineNumbersMap=void 0,this.updateInlineValuesScheduler.schedule()})),this.toDispose.push(this.debugService.getViewModel().onWillUpdateViews(()=>this.updateInlineValuesScheduler.schedule())),this.toDispose.push(this.debugService.getViewModel().onDidEvaluateLazyExpression(()=>this.updateInlineValuesScheduler.schedule())),this.toDispose.push(this.editor.onDidChangeModel(async()=>{this.addDocumentListeners(),this.toggleExceptionWidget(),this.hideHoverWidget(),this._wordToLineNumbersMap=void 0;let t=this.debugService.getViewModel().focusedStackFrame;await this.updateInlineValueDecorations(t)})),this.toDispose.push(this.editor.onDidScrollChange(()=>{this.hideHoverWidget();let t=this.editor.getModel();t&&this.languageFeaturesService.inlineValuesProvider.has(t)&&this.updateInlineValuesScheduler.schedule()})),this.toDispose.push(this.configurationService.onDidChangeConfiguration(t=>{t.affectsConfiguration("editor.hover")&&this.updateHoverConfiguration()})),this.toDispose.push(this.debugService.onDidChangeState(t=>{t!==2&&this.toggleExceptionWidget()})),this.updateHoverConfiguration()}_wordToLineNumbersMap;updateHoverConfiguration(){let t=this.editor.getModel();t&&(this.editorHoverOptions=this.configurationService.getValue("editor.hover",{resource:t.uri,overrideIdentifier:t.getLanguageId()}))}addDocumentListeners(){let t=this.debugService.getViewModel().focusedStackFrame,e=this.editor.getModel();e&&this.applyDocumentListeners(e,t)}applyDocumentListeners(t,e){if(!e||!this.uriIdentityService.extUri.isEqual(t.uri,e.source.uri)){this.altListener.clear();return}let i=this.editor.getContainerDomNode().ownerDocument;this.altListener.value=F(i,"keydown",n=>{if(new ut(n).keyCode===6){this.altPressed=!0;let s=this.hoverWidget.isVisible();this.hoverWidget.hide(),this.defaultHoverLockout.clear(),s&&this.hoverPosition&&this.showEditorHover(this.hoverPosition.position,!1);let a=new lt(i,"keyup"),l=X.any(this.hostService.onDidChangeFocus,a.event)(d=>{let c;El(d)&&(c=new ut(d)),(!c||c.keyCode===6)&&(this.altPressed=!1,this.preventDefaultEditorHover(),l.dispose(),a.dispose())})}})}async showHover(t,e,i){this.preventDefaultEditorHover();let n=this.debugService.getViewModel().focusedStackFrame,o=this.editor.getModel();n&&o&&this.uriIdentityService.extUri.isEqual(n.source.uri,o.uri)?await this.hoverWidget.showAt(t,e,i)===1&&this.showEditorHover(t,e):this.showEditorHover(t,e)}preventDefaultEditorHover(){if(this.defaultHoverLockout.value||this.editorHoverOptions?.enabled===!1)return;this.editor.getContribution(Dg.ID)?.hideContentHover(),this.editor.updateOptions({hover:{enabled:!1}}),this.defaultHoverLockout.value={dispose:()=>{this.editor.updateOptions({hover:{enabled:this.editorHoverOptions?.enabled??!0}})}}}showEditorHover(t,e){let i=this.editor.getContribution(Dg.ID),n=new L(t.lineNumber,t.column,t.lineNumber,t.column);this.defaultHoverLockout.clear(),i?.showContentHover(n,1,0,e)}async onFocusStackFrame(t){let e=this.editor.getModel();e&&(this.applyDocumentListeners(e,t),t&&this.uriIdentityService.extUri.isEqual(t.source.uri,e.uri)?await this.toggleExceptionWidget():this.hideHoverWidget()),await this.updateInlineValueDecorations(t)}get hoverDelay(){let t=this.editorHoverOptions?.delay||0,e=pn(2-(t-300)/600,1,2);return t*e}get showHoverScheduler(){let t=new Ye(()=>{this.hoverPosition&&!this.altPressed&&this.showHover(this.hoverPosition.position,!1,this.hoverPosition.event)},this.hoverDelay);return this.toDispose.push(t),t}hideHoverWidget(){this.hoverWidget.willBeVisible()&&this.hoverWidget.hide(),this.showHoverScheduler.cancel(),this.defaultHoverLockout.clear()}onEditorMouseDown(t){this.mouseDown=!0,!(t.target.type===9&&t.target.detail===Zu.ID)&&this.hideHoverWidget()}onEditorMouseMove(t){if(this.debugService.state!==2)return;let e=t.target,i=ye?"metaKey":"ctrlKey";this.altPressed||(e.type===2?(this.defaultHoverLockout.clear(),this.gutterIsHovered=!0):this.gutterIsHovered&&(this.gutterIsHovered=!1,this.updateHoverConfiguration())),!(e.type===9&&e.detail===Zu.ID&&!t.event[i]&&((this.editorHoverOptions?.sticky??!0)||this.hoverWidget.isShowingComplexValue))&&(e.type===6?e.position&&!H.equals(e.position,this.hoverPosition?.position||null)&&!this.hoverWidget.isInSafeTriangle(t.event.posx,t.event.posy)&&(this.hoverPosition={position:e.position,event:t.event},this.preventDefaultEditorHover(),this.showHoverScheduler.schedule(this.hoverDelay)):this.mouseDown||this.hideHoverWidget())}onKeyDown(t){let e=ye?57:5;t.keyCode!==e&&t.keyCode!==6&&this.hideHoverWidget()}async toggleExceptionWidget(){let t=this.editor.getModel(),e=this.debugService.getViewModel().focusedStackFrame,i=e?e.thread.getCallStack():null;if(!t||!e||!i||i.length===0){this.closeExceptionWidget();return}let n=i.find(s=>!!(s&&s.source&&s.source.available&&s.source.presentationHint!=="deemphasize"));if(!n||n!==e){this.closeExceptionWidget();return}let o=this.uriIdentityService.extUri.isEqual(n.source.uri,t.uri);if(this.exceptionWidget&&!o)this.closeExceptionWidget();else if(o){let s=await e.thread.exceptionInfo;s&&this.showExceptionWidget(s,this.debugService.getViewModel().focusedSession,n.range.startLineNumber,n.range.startColumn)}}showExceptionWidget(t,e,i,n){this.exceptionWidget&&this.exceptionWidget.dispose(),this.exceptionWidget=this.instantiationService.createInstance(rT,this.editor,t,e),this.exceptionWidget.show({lineNumber:i,column:n},0),this.exceptionWidget.focus(),this.editor.revealRangeInCenter({startLineNumber:i,startColumn:n,endLineNumber:i,endColumn:n}),this.exceptionWidgetVisible.set(!0)}closeExceptionWidget(){if(this.exceptionWidget){let t=this.exceptionWidget.hasFocus();this.exceptionWidget.dispose(),this.exceptionWidget=void 0,this.exceptionWidgetVisible.set(!1),t&&this.editor.focus()}}async addLaunchConfiguration(){let t=this.editor.getModel();if(!t)return;let e,i,n=()=>{let s=0;Ok(t.getValue(),{onObjectProperty:a=>{i=a},onArrayBegin:a=>{i==="configurations"&&s===0&&(e=t.getPositionAt(a+1)),s++},onArrayEnd:()=>{s--}})};if(n(),!e){let{tabSize:s,insertSpaces:a}=t.getOptions(),l=t.getEOL(),d=Eo(t.uri.fsPath)==="launch.json"?fF(t.getValue(),["configurations"],[],{tabSize:s,insertSpaces:a,eol:l})[0]:fF(t.getValue(),["launch"],{configurations:[]},{tabSize:s,insertSpaces:a,eol:l})[0],c=t.getPositionAt(d.offset),p=c.lineNumber,h=new L(p,c.column,p,t.getLineMaxColumn(p));t.pushEditOperations(null,[$r.replace(h,d.content)],()=>null),n()}if(!e)return;this.editor.focus(),await(s=>(t.getLineLastNonWhitespaceColumn(s.lineNumber)>s.column&&(this.editor.setPosition(s),Bq.LineBreakInsert.runEditorCommand(null,this.editor,null)),this.editor.setPosition(s),this.commandService.executeCommand("editor.action.insertLineAfter")))(e),await this.commandService.executeCommand("editor.action.triggerSuggest")}get removeInlineValuesScheduler(){return new Ye(()=>{this.displayedStore.clear(),this.oldDecorations.clear()},100)}get updateInlineValuesScheduler(){let t=this.editor.getModel();return new Ye(async()=>await this.updateInlineValueDecorations(this.debugService.getViewModel().focusedStackFrame),t?this.debounceInfo.get(t):xhe)}async updateInlineValueDecorations(t){let e="{0} = {1}",i=", ",n=this.editor.getModel(),o=this.configurationService.getValue("debug").inlineValues;if(!(o===!0||o==="on"||o==="auto"&&n&&this.languageFeaturesService.inlineValuesProvider.has(n))||!n||!t||n.uri.toString()!==t.source.uri.toString()){this.removeInlineValuesScheduler.isScheduled()||this.removeInlineValuesScheduler.schedule();return}this.removeInlineValuesScheduler.cancel(),this.displayedStore.clear();let a=this.editor.getVisibleRangesPlusViewportAboveBelow(),l,d=new Kt;if(this.displayedStore.add(le(()=>d.dispose(!0))),this.languageFeaturesService.inlineValuesProvider.has(n)){let p=async(I,y)=>{let w=await t.getMostSpecificScopes(t.range),C=y?I:I.toLowerCase();for(let S of w){let k=(await S.getChildren()).find(M=>y?M.name===C:M.name.toLowerCase()===C);if(k)return k.value}},h={frameId:t.frameId,stoppedLocation:new L(t.range.startLineNumber,t.range.startColumn+1,t.range.endLineNumber,t.range.endColumn+1)},m=this.languageFeaturesService.inlineValuesProvider.ordered(n).reverse();l=[];let f=new Map,g=m.flatMap(I=>a.map(y=>Promise.resolve(I.provideInlineValues(n,y,h,d.token)).then(async w=>{if(w)for(let C of w){let S;switch(C.type){case"text":S=C.text;break;case"variable":{let D=C.variableName;D||(D=n.getLineContent(C.range.startLineNumber).substring(C.range.startColumn-1,C.range.endColumn-1));let k=await p(D,C.caseSensitiveLookup);k&&(S=Sp(e,D,k));break}case"expression":{let D=C.expression;if(D||(D=n.getLineContent(C.range.startLineNumber).substring(C.range.startColumn-1,C.range.endColumn-1)),D){let k=new Hi(D);await k.evaluate(t.thread.session,t,"watch",!0),k.available&&(S=Sp(e,D,k.value))}break}}if(S){let D=C.range.startLineNumber,k=f.get(D);k||(k=[],f.set(D,k)),k.some(M=>M.text===S)||k.push(new DY(C.range.startColumn,S))}}},w=>{zo(w)}))),v=Date.now();await Promise.all(g),this.updateInlineValuesScheduler.delay=this.debounceInfo.update(n,Date.now()-v),f.forEach((I,y)=>{if(I.length>0){I=I.sort((C,S)=>C.column-S.column);let w=I.map(C=>C.text).join(i);l.push(...The(y,w))}})}else{let p=await t.getMostSpecificScopes(t.range),h=await Promise.all(p.map(async f=>({scope:f,variables:await f.getChildren()}))),m=new Map;for(let{scope:f,variables:g}of h){let v=new L(0,0,t.range.startLineNumber,t.range.startColumn);f.range&&(v=v.setStartPosition(f.range.startLineNumber,f.range.startColumn));let I=a.map(w=>w.intersectRanges(v)).filter(go);this._wordToLineNumbersMap??=new kY(n);for(let w of I)this._wordToLineNumbersMap.ensureRangePopulated(w);let y=R_e(g,I,n,this._wordToLineNumbersMap.value);for(let{line:w,variables:C}of y){let S=m.get(w);S||(S=new Map,m.set(w,S));for(let{name:D,value:k}of C)S.has(D)||S.set(D,k)}}l=[...m.entries()].flatMap(([f,g])=>The(f,[...g].map(([v,I])=>`${v} = ${I}`).join(", ")))}if(d.token.isCancellationRequested)return;let c;if(this.editor.getOption(134)!=="off"){let p=this.editor.getPosition();p&&this.editor.getVisibleRanges().some(h=>h.containsPosition(p))&&(c={position:p,top:this.editor.getTopForPosition(p.lineNumber,p.column)})}if(this.oldDecorations.set(l),c){let p=this.editor.getTopForPosition(c.position.lineNumber,c.position.column);this.editor.setScrollTop(this.editor.getScrollTop()-(c.top-p),1)}}dispose(){this.hoverWidget&&this.hoverWidget.dispose(),this.configurationWidget&&this.configurationWidget.dispose(),this.toDispose=_e(this.toDispose)}};E([Re],kg.prototype,"showHoverScheduler",1),E([Re],kg.prototype,"removeInlineValuesScheduler",1),E([Re],kg.prototype,"updateInlineValuesScheduler",1),kg=E([b(1,we),b(2,ne),b(3,ct),b(4,se),b(5,Tn),b(6,zn),b(7,re),b(8,ni),b(9,Ny)],kg);var kY=class{constructor(t){this.model=t;this.intervals=new Uint8Array(Math.ceil(t.getLineCount()/8))}intervals;value=new Map;ensureRangePopulated(t){for(let e=t.startLineNumber;e<=t.endLineNumber;e++){let i=e>>3,n=1<<(e&7);this.intervals[i]&n||(P_e(this.model,e,this.value),this.intervals[i]|=n)}}};tt.registerCommand("_executeInlineValueProvider",async(r,t,e,i)=>{if(un(Z.isUri(t)),un(L.isIRange(e)),!i||typeof i.frameId!="number"||!L.isIRange(i.stoppedLocation))throw Uc("context");let n=r.get(qi).getModel(t);if(!n)throw Uc("uri");let o=L.lift(e),{inlineValuesProvider:s}=r.get(ni),a=s.ordered(n);return(await Promise.all(a.map(d=>d.provideInlineValues(n,o,i,Pt.None)))).flat().filter(go)});var sT=class{toDispose=[];constructor(t,e,i){let n,o=s=>{n&&(n.dispose(),n=void 0),s&&(n=s.onDidProgressStart(async a=>{let l=new Promise(c=>{let p=X.any(X.filter(s.onDidProgressEnd,h=>h.body.progressId===a.body.progressId),s.onDidEndAdapter)(()=>{p.dispose(),c()})});i.isViewContainerVisible(nr)&&e.withProgress({location:nr},()=>l);let d=t.getAdapterManager().getDebuggerLabel(s.configuration.type);e.withProgress({location:15,title:a.body.title,cancellable:a.body.cancellable,source:d,delay:500},c=>{let p=0,h=f=>{let g;typeof f.percentage=="number"&&(g=f.percentage-p,p+=g),c.report({message:f.message,increment:g,total:typeof g=="number"?100:void 0})};a.body.message&&h(a.body);let m=s.onDidProgressUpdate(f=>{f.body.progressId===a.body.progressId&&h(f.body)});return l.then(()=>m.dispose())},()=>s.cancel(a.body.progressId))}))};this.toDispose.push(t.getViewModel().onDidFocusSession(o)),o(t.getViewModel().focusedSession),this.toDispose.push(t.onWillNewSession(s=>{n||o(s)}))}dispose(){_e(this.toDispose)}};sT=E([b(0,we),b(1,Cu),b(2,Mi)],sT);var aT=class extends Vf{constructor(e,i,n,o){super(aP,{noResultsPick:{label:u("noDebugResults","No matching launch configurations")}});this.debugService=e;this.contextService=i;this.commandService=n;this.notificationService=o}async _getPicks(e){let i=[];if(!this.debugService.getAdapterManager().hasEnabledDebuggers())return[];i.push({type:"separator",label:"launch.json"});let n=this.debugService.getConfigurationManager(),o;for(let l of n.getAllConfigurations()){let d=_l(e,l.name,!0);d&&(o!==l.presentation?.group&&(i.push({type:"separator"}),o=l.presentation?.group),i.push({label:l.name,description:this.contextService.getWorkbenchState()===3?l.launch.name:"",highlights:{label:d},buttons:[{iconClass:de.asClassName(dE),tooltip:u("customizeLaunchConfig","Configure Launch Configuration")}],trigger:()=>(l.launch.openConfigFile({preserveFocus:!1}),1),accept:async()=>{await n.selectConfiguration(l.launch,l.name);try{await this.debugService.startDebugging(l.launch,void 0,{startedByUser:!0})}catch(c){this.notificationService.error(c)}}}))}let s=await n.getDynamicProviders();s.length>0&&i.push({type:"separator",label:u({key:"contributed",comment:["contributed is lower case because it looks better like that in UI. Nothing preceeds it. It is a name of the grouping of debug configurations."]},"contributed")}),n.getRecentDynamicConfigurations().forEach(({name:l,type:d})=>{let c=_l(e,l,!0);c&&i.push({label:l,highlights:{label:c},buttons:[{iconClass:de.asClassName(Mde),tooltip:u("removeLaunchConfig","Remove Launch Configuration")}],trigger:()=>(n.removeRecentDynamicConfigurations(l,d),1),accept:async()=>{await n.selectConfiguration(void 0,l,void 0,{type:d});try{let{launch:p,getConfig:h}=n.selectedConfiguration,m=await h();await this.debugService.startDebugging(p,m,{startedByUser:!0})}catch(p){this.notificationService.error(p)}}})}),s.forEach(l=>{i.push({label:`$(folder) ${l.label}...`,ariaLabel:u({key:"providerAriaLabel",comment:['Placeholder stands for the provider label. For example "NodeJS".']},"{0} contributed configurations",l.label),accept:async()=>{let d=await l.pick();d&&(await n.selectConfiguration(d.launch,d.config.name,d.config,{type:l.type}),this.debugService.startDebugging(d.launch,d.config,{startedByUser:!0}))}})});let a=n.getLaunches().filter(l=>!l.hidden);a.length>0&&i.push({type:"separator",label:u("configure","configure")});for(let l of a){let d=this.contextService.getWorkbenchState()===3?u("addConfigTo","Add Config ({0})...",l.name):u("addConfiguration","Add Configuration...");i.push({label:d,description:this.contextService.getWorkbenchState()===3?l.name:"",highlights:{label:_l(e,d,!0)??void 0},accept:()=>this.commandService.executeCommand(Uy,l.uri.toString())})}return i}};aT=E([b(0,we),b(1,kt),b(2,ct),b(3,mi)],aT);var V2=q("extensionHostDebugService");var Ito=q("workspaceTrustEnablementService"),yto=q("workspaceTrustManagementService");var _he=q("workspaceTrustRequestService");var lT=class{constructor(t,e){this.breakpointContribution=t;this.contextKeyService=e;this.breakpointsWhen=typeof t.when=="string"?P.deserialize(t.when):void 0}breakpointsWhen;get language(){return this.breakpointContribution.language}get enabled(){return!this.breakpointsWhen||this.contextKeyService.contextMatchesRules(this.breakpointsWhen)}};lT=E([b(1,re)],lT);var Dhe=q("configurationResolverService");function khe(r){r.pattern=r.pattern||"^(?!.*\\$\\{(env|config|command)\\.)",r.patternErrorMessage=r.patternErrorMessage||u("deprecatedVariables","'env.', 'config.' and 'command.' are deprecated, use 'env:', 'config:' and 'command:' instead.")}var dT=class{constructor(t,e,i,n,o,s,a,l,d){this.adapterManager=t;this.configurationService=n;this.resourcePropertiesService=o;this.configurationResolverService=s;this.environmentService=a;this.debugService=l;this.contextKeyService=d;this.debuggerContribution={type:e.type},this.merge(e,i),this.debuggerWhen=typeof this.debuggerContribution.when=="string"?P.deserialize(this.debuggerContribution.when):void 0,this.debuggerHiddenWhen=typeof this.debuggerContribution.hiddenWhen=="string"?P.deserialize(this.debuggerContribution.hiddenWhen):void 0}debuggerContribution;mergedExtensionDescriptions=[];mainExtensionDescription;debuggerWhen;debuggerHiddenWhen;merge(t,e){function i(n,o,s,a=0){return vi(n)?(vi(o)&&Object.keys(o).forEach(l=>{l!=="__proto__"&&(vi(n[l])&&vi(o[l])?i(n[l],o[l],s,a+1):l in n?s&&(a===0&&l==="type"||(n[l]=o[l])):n[l]=o[l])}),n):o}this.mergedExtensionDescriptions.indexOf(e)<0&&(this.mergedExtensionDescriptions.push(e),i(this.debuggerContribution,t,e.isBuiltin),jde(t)&&(this.mainExtensionDescription=e))}async startDebugging(t,e){let i=this.debugService.getModel().getSession(e);return await this.debugService.startDebugging(void 0,t,{parentSession:i},void 0)}async createDebugAdapter(t){await this.adapterManager.activateDebuggers("onDebugAdapterProtocolTracker",this.type);let e=this.adapterManager.createDebugAdapter(t);if(e)return Promise.resolve(e);throw new Error(u("cannot.find.da","Cannot find debug adapter for type '{0}'.",this.type))}async substituteVariables(t,e){let i=await this.adapterManager.substituteVariables(this.type,t,e);return await this.configurationResolverService.resolveWithInteractionReplace(t,i,"launch",this.variables,i.__configurationTarget)}runInTerminal(t,e){return this.adapterManager.runInTerminal(this.type,t,e)}get label(){return this.debuggerContribution.label||this.debuggerContribution.type}get type(){return this.debuggerContribution.type}get variables(){return this.debuggerContribution.variables}get configurationSnippets(){return this.debuggerContribution.configurationSnippets}get languages(){return this.debuggerContribution.languages}get when(){return this.debuggerWhen}get hiddenWhen(){return this.debuggerHiddenWhen}get enabled(){return!this.debuggerWhen||this.contextKeyService.contextMatchesRules(this.debuggerWhen)}get isHiddenFromDropdown(){return this.debuggerHiddenWhen?this.contextKeyService.contextMatchesRules(this.debuggerHiddenWhen):!1}get strings(){return this.debuggerContribution.strings??this.debuggerContribution.uiMessages}interestedInLanguage(t){return!!(this.languages&&this.languages.indexOf(t)>=0)}hasInitialConfiguration(){return!!this.debuggerContribution.initialConfigurations}hasDynamicConfigurationProviders(){return this.debugService.getConfigurationManager().hasDebugConfigurationProvider(this.type,2)}hasConfigurationProvider(){return this.debugService.getConfigurationManager().hasDebugConfigurationProvider(this.type)}getInitialConfigurationContent(t){let e=this.debuggerContribution.initialConfigurations||[];t&&(e=e.concat(t));let i=this.resourcePropertiesService.getEOL(Z.from({scheme:Ie.untitled,path:"1"}))===`\r
`?`\r
`:`
`,n=JSON.stringify(e,null,"	").split(`
`).map(c=>"	"+c).join(i).trim(),o=u("launch.config.comment1","Use IntelliSense to learn about possible attributes."),s=u("launch.config.comment2","Hover to view descriptions of existing attributes."),a=u("launch.config.comment3","For more information, visit: {0}","https://go.microsoft.com/fwlink/?linkid=830387"),l=["{",`	// ${o}`,`	// ${s}`,`	// ${a}`,'	"version": "0.2.0",',`	"configurations": ${n}`,"}"].join(i),d=this.configurationService.getValue();return d.editor&&d.editor.insertSpaces&&(l=l.replace(new RegExp("	","g")," ".repeat(d.editor.tabSize))),Promise.resolve(l)}getMainExtensionDescriptor(){return this.mainExtensionDescription||this.mergedExtensionDescriptions[0]}getCustomTelemetryEndpoint(){let t=this.debuggerContribution.aiKey;if(!t)return;let e=Qle(this.environmentService.remoteAuthority)!=="other";return{id:`${this.getMainExtensionDescriptor().publisher}.${this.type}`,aiKey:t,sendErrorTelemetry:e}}getSchemaAttributes(t){return this.debuggerContribution.configurationAttributes?Object.keys(this.debuggerContribution.configurationAttributes).map(e=>{let i=`${this.type}:${e}`,n=`${this.type}:${e}:platform`,o=this.debuggerContribution.configurationAttributes[e],s=["name","type","request"];o.required=o.required&&o.required.length?s.concat(o.required):s,o.additionalProperties=!1,o.type="object",o.properties||(o.properties={});let a=o.properties;a.type={enum:[this.type],enumDescriptions:[this.label],description:u("debugType","Type of configuration."),pattern:"^(?!node2)",deprecationMessage:this.debuggerContribution.deprecated||(this.enabled?void 0:yV(this.type)),doNotSuggest:!!this.debuggerContribution.deprecated,errorMessage:u("debugTypeNotRecognised","The debug type is not recognized. Make sure that you have a corresponding debug extension installed and that it is enabled."),patternErrorMessage:u("node2NotSupported",'"node2" is no longer supported, use "node" instead and set the "protocol" attribute to "inspector".')},a.request={enum:[e],description:u("debugRequest",'Request type of configuration. Can be "launch" or "attach".')};for(let d in t.common.properties)a[d]={$ref:`#/definitions/common/properties/${d}`};Object.keys(a).forEach(d=>{khe(a[d])}),t[i]={...o},t[n]={type:"object",additionalProperties:!1,properties:xte(a,d=>d!=="type"&&d!=="request"&&d!=="name")};let l={...o};return l.properties={...a,windows:{$ref:`#/definitions/${n}`,description:u("debugWindowsConfiguration","Windows specific launch configuration attributes.")},osx:{$ref:`#/definitions/${n}`,description:u("debugOSXConfiguration","OS X specific launch configuration attributes.")},linux:{$ref:`#/definitions/${n}`,description:u("debugLinuxConfiguration","Linux specific launch configuration attributes.")}},l}):null}};dT=E([b(3,se),b(4,GC),b(5,Dhe),b(6,Jo),b(7,we),b(8,re)],dT);var LY=u("JsonSchema.input.id","The input's id is used to associate an input with a variable of the form ${input:id}."),RY=u("JsonSchema.input.type","The type of user input prompt to use."),Lhe=u("JsonSchema.input.description","The description is shown when the user is prompted for input."),Rhe=u("JsonSchema.input.default","The default value for the input."),Phe={definitions:{inputs:{type:"array",description:u("JsonSchema.inputs","User inputs. Used for defining user input prompts, such as free string input or a choice from several options."),items:{oneOf:[{type:"object",required:["id","type","description"],additionalProperties:!1,properties:{id:{type:"string",description:LY},type:{type:"string",description:RY,enum:["promptString"],enumDescriptions:[u("JsonSchema.input.type.promptString","The 'promptString' type opens an input box to ask the user for input.")]},description:{type:"string",description:Lhe},default:{type:"string",description:Rhe},password:{type:"boolean",description:u("JsonSchema.input.password","Controls if a password input is shown. Password input hides the typed text.")}}},{type:"object",required:["id","type","description","options"],additionalProperties:!1,properties:{id:{type:"string",description:LY},type:{type:"string",description:RY,enum:["pickString"],enumDescriptions:[u("JsonSchema.input.type.pickString","The 'pickString' type shows a selection list.")]},description:{type:"string",description:Lhe},default:{type:"string",description:Rhe},options:{type:"array",description:u("JsonSchema.input.options","An array of strings that defines the options for a quick pick."),items:{oneOf:[{type:"string"},{type:"object",required:["value"],additionalProperties:!1,properties:{label:{type:"string",description:u("JsonSchema.input.pickString.optionLabel","Label for the option.")},value:{type:"string",description:u("JsonSchema.input.pickString.optionValue","Value for the option.")}}}]}}}},{type:"object",required:["id","type","command"],additionalProperties:!1,properties:{id:{type:"string",description:LY},type:{type:"string",description:RY,enum:["command"],enumDescriptions:[u("JsonSchema.input.type.command","The 'command' type executes a command.")]},command:{type:"string",description:u("JsonSchema.input.command.command","The command to execute for this input variable.")},args:{oneOf:[{type:"object",description:u("JsonSchema.input.command.args","Optional arguments passed to the command.")},{type:"array",description:u("JsonSchema.input.command.args","Optional arguments passed to the command.")},{type:"string",description:u("JsonSchema.input.command.args","Optional arguments passed to the command.")}]}}}]}}}};var Ahe=Ra.registerExtensionPoint({extensionPoint:"debuggers",defaultExtensionKind:["workspace"],jsonSchema:{description:u("vscode.extension.contributes.debuggers","Contributes debug adapters."),type:"array",defaultSnippets:[{body:[{type:""}]}],items:{additionalProperties:!1,type:"object",defaultSnippets:[{body:{type:"",program:"",runtime:""}}],properties:{type:{description:u("vscode.extension.contributes.debuggers.type","Unique identifier for this debug adapter."),type:"string"},label:{description:u("vscode.extension.contributes.debuggers.label","Display name for this debug adapter."),type:"string"},program:{description:u("vscode.extension.contributes.debuggers.program","Path to the debug adapter program. Path is either absolute or relative to the extension folder."),type:"string"},args:{description:u("vscode.extension.contributes.debuggers.args","Optional arguments to pass to the adapter."),type:"array"},runtime:{description:u("vscode.extension.contributes.debuggers.runtime","Optional runtime in case the program attribute is not an executable but requires a runtime."),type:"string"},runtimeArgs:{description:u("vscode.extension.contributes.debuggers.runtimeArgs","Optional runtime arguments."),type:"array"},variables:{description:u("vscode.extension.contributes.debuggers.variables","Mapping from interactive variables (e.g. ${action.pickProcess}) in `launch.json` to a command."),type:"object"},initialConfigurations:{description:u("vscode.extension.contributes.debuggers.initialConfigurations","Configurations for generating the initial 'launch.json'."),type:["array","string"]},languages:{description:u("vscode.extension.contributes.debuggers.languages",'List of languages for which the debug extension could be considered the "default debugger".'),type:"array"},configurationSnippets:{description:u("vscode.extension.contributes.debuggers.configurationSnippets","Snippets for adding new configurations in 'launch.json'."),type:"array"},configurationAttributes:{description:u("vscode.extension.contributes.debuggers.configurationAttributes","JSON schema configurations for validating 'launch.json'."),type:"object"},when:{description:u("vscode.extension.contributes.debuggers.when","Condition which must be true to enable this type of debugger. Consider using 'shellExecutionSupported', 'virtualWorkspace', 'resourceScheme' or an extension-defined context key as appropriate for this."),type:"string",default:""},hiddenWhen:{description:u("vscode.extension.contributes.debuggers.hiddenWhen","When this condition is true, this debugger type is hidden from the debugger list, but is still enabled."),type:"string",default:""},deprecated:{description:u("vscode.extension.contributes.debuggers.deprecated","Optional message to mark this debug type as being deprecated."),type:"string",default:""},windows:{description:u("vscode.extension.contributes.debuggers.windows","Windows specific settings."),type:"object",properties:{runtime:{description:u("vscode.extension.contributes.debuggers.windows.runtime","Runtime used for Windows."),type:"string"}}},osx:{description:u("vscode.extension.contributes.debuggers.osx","macOS specific settings."),type:"object",properties:{runtime:{description:u("vscode.extension.contributes.debuggers.osx.runtime","Runtime used for macOS."),type:"string"}}},linux:{description:u("vscode.extension.contributes.debuggers.linux","Linux specific settings."),type:"object",properties:{runtime:{description:u("vscode.extension.contributes.debuggers.linux.runtime","Runtime used for Linux."),type:"string"}}},strings:{description:u("vscode.extension.contributes.debuggers.strings","UI strings contributed by this debug adapter."),type:"object",properties:{unverifiedBreakpoints:{description:u("vscode.extension.contributes.debuggers.strings.unverifiedBreakpoints","When there are unverified breakpoints in a language supported by this debug adapter, this message will appear on the breakpoint hover and in the breakpoints view. Markdown and command links are supported."),type:"string"}}}}}}}),Ohe=Ra.registerExtensionPoint({extensionPoint:"breakpoints",jsonSchema:{description:u("vscode.extension.contributes.breakpoints","Contributes breakpoints."),type:"array",defaultSnippets:[{body:[{language:""}]}],items:{type:"object",additionalProperties:!1,defaultSnippets:[{body:{language:""}}],properties:{language:{description:u("vscode.extension.contributes.breakpoints.language","Allow breakpoints for this language."),type:"string"},when:{description:u("vscode.extension.contributes.breakpoints.when","Condition which must be true to enable breakpoints in this language. Consider matching this to the debugger when clause as appropriate."),type:"string",default:""}}}}}),MY={type:"object",description:u("presentation","Presentation options on how to show this configuration in the debug configuration dropdown and the command palette."),properties:{hidden:{type:"boolean",default:!1,description:u("presentation.hidden","Controls if this configuration should be shown in the configuration dropdown and the command palette.")},group:{type:"string",default:"",description:u("presentation.group","Group that this configuration belongs to. Used for grouping and sorting in the configuration dropdown and the command palette.")},order:{type:"number",default:1,description:u("presentation.order","Order of this configuration within a group. Used for grouping and sorting in the configuration dropdown and the command palette.")}},default:{hidden:!1,group:"",order:1}},Mhe={name:"Compound",configurations:[]},hv={id:$m,type:"object",title:u("app.launch.json.title","Launch"),allowTrailingCommas:!0,allowComments:!0,required:[],default:{version:"0.2.0",configurations:[],compounds:[]},properties:{version:{type:"string",description:u("app.launch.json.version","Version of this file format."),default:"0.2.0"},configurations:{type:"array",description:u("app.launch.json.configurations","List of configurations. Add new configurations or edit existing ones by using IntelliSense."),items:{defaultSnippets:[],type:"object",oneOf:[]}},compounds:{type:"array",description:u("app.launch.json.compounds","List of compounds. Each compound references multiple configurations which will get launched together."),items:{type:"object",required:["name","configurations"],properties:{name:{type:"string",description:u("app.launch.json.compound.name","Name of compound. Appears in the launch configuration drop down menu.")},presentation:MY,configurations:{type:"array",default:[],items:{oneOf:[{enum:[],description:u("useUniqueNames","Please use unique configuration names.")},{type:"object",required:["name"],properties:{name:{enum:[],description:u("app.launch.json.compound.name","Name of compound. Appears in the launch configuration drop down menu.")},folder:{enum:[],description:u("app.launch.json.compound.folder","Name of folder in which the compound is located.")}}}]},description:u("app.launch.json.compounds.configurations","Names of configurations that will be started as part of this compound.")},stopAll:{type:"boolean",default:!1,description:u("app.launch.json.compound.stopAll","Controls whether manually terminating one session will stop all of the compound sessions.")},preLaunchTask:{type:"string",default:"",description:u("compoundPrelaunchTask","Task to run before any of the compound configurations start.")}},default:Mhe},default:[Mhe]},inputs:Phe.definitions.inputs}},PY=class extends R{type="table";shouldRender(t){return!!t.contributes?.debuggers}render(t){let e=t.contributes?.debuggers||[];if(!e.length)return{data:{headers:[],rows:[]},dispose:()=>{}};let i=[u("debugger name","Name"),u("debugger type","Type")],n=e.map(o=>[o.label??"",o.type]);return{data:{headers:i,rows:n},dispose:()=>{}}}};Pe.as(mx.ExtensionFeaturesRegistry).registerExtensionFeature({id:"debuggers",label:u("debuggers","Debuggers"),access:{canToggle:!1},renderer:new qr(PY)});var N_e;(i=>(i.shortcut="shortcut",i.command="command",i.reconnect="reconnect"))(N_e||={});var F_e=new A("customExecutionSupported",!1,u("tasks.customExecutionSupported","Whether CustomExecution tasks are supported. Consider using in the when clause of a 'taskDefinition' contribution.")),B_e=new A("shellExecutionSupported",!1,u("tasks.shellExecutionSupported","Whether ShellExecution tasks are supported. Consider using in the when clause of a 'taskDefinition' contribution.")),Ano=new A("taskCommandsRegistered",!1,u("tasks.taskCommandsRegistered","Whether the task commands have been registered yet")),V_e=new A("processExecutionSupported",!1,u("tasks.processExecutionSupported","Whether ProcessExecution tasks are supported. Consider using in the when clause of a 'taskDefinition' contribution.")),Ono=new A("serverlessWebContext",!1,u("tasks.serverlessWebContext","True when in the web with no remote authority.")),Nno=P.or(P.and(B_e,V_e),F_e),W2=q("taskService");var W_e=Pe.as(wd.JSONContribution),cT=class extends R{constructor(e,i,n,o,s,a,l,d,c,p,h,m,f){super();this.editorService=i;this.configurationService=n;this.quickInputService=o;this.instantiationService=s;this.commandService=a;this.extensionService=l;this.contextKeyService=d;this.languageService=c;this.dialogService=p;this.lifecycleService=h;this.tasksService=m;this.menuService=f;this.adapterDescriptorFactories=[],this.debuggers=[],this.registerListeners(),this.contextKeyService.bufferChangeEvents(()=>{this.debuggersAvailable=oi.bindTo(d),this.debugExtensionsAvailable=gV.bindTo(d)}),this._register(this.contextKeyService.onDidChangeContext(v=>{v.affectsSome(this.debuggerWhenKeys)&&(this.debuggersAvailable.set(this.hasEnabledDebuggers()),this.updateDebugAdapterSchema())})),this._register(this.onDidDebuggersExtPointRead(()=>{this.debugExtensionsAvailable.set(this.debuggers.length>0)}));let g=this._register(new Ye(()=>this.updateTaskLabels(),5e3));this._register(X.any(m.onDidChangeTaskConfig,m.onDidChangeTaskProviders)(()=>{g.cancel(),g.schedule()})),this.lifecycleService.when(4).then(()=>this.debugExtensionsAvailable.set(this.debuggers.length>0)),this._register(e.onDidNewSession(v=>{this.usedDebugTypes.add(v.configuration.type)})),g.schedule()}debuggers;adapterDescriptorFactories;debugAdapterFactories=new Map;debuggersAvailable;debugExtensionsAvailable;_onDidRegisterDebugger=new x;_onDidDebuggersExtPointRead=new x;breakpointContributions=[];debuggerWhenKeys=new Set;taskLabels=[];earlyActivatedExtensions;usedDebugTypes=new Set;registerListeners(){Ahe.setHandler((e,i)=>{i.added.forEach(n=>{n.value.forEach(o=>{if((!o.type||typeof o.type!="string")&&n.collector.error(u("debugNoType","Debugger 'type' can not be omitted and must be of type 'string'.")),o.type!=="*"){let s=this.getDebugger(o.type);if(s)s.merge(o,n.description);else{let a=this.instantiationService.createInstance(dT,this,o,n.description);a.when?.keys().forEach(l=>this.debuggerWhenKeys.add(l)),this.debuggers.push(a)}}})}),e.forEach(n=>{n.value.forEach(o=>{o.type==="*"&&this.debuggers.forEach(s=>s.merge(o,n.description))})}),i.removed.forEach(n=>{let o=n.value.map(s=>s.type);this.debuggers=this.debuggers.filter(s=>o.indexOf(s.type)===-1)}),this.updateDebugAdapterSchema(),this._onDidDebuggersExtPointRead.fire()}),Ohe.setHandler(e=>{this.breakpointContributions=e.flatMap(i=>i.value.map(n=>this.instantiationService.createInstance(lT,n)))})}updateTaskLabels(){this.tasksService.getKnownTasks().then(e=>{this.taskLabels=e.map(i=>i._label),this.updateDebugAdapterSchema()})}updateDebugAdapterSchema(){let e=hv.properties.configurations.items,i=XB.getJsonSchema(),n={common:{properties:{name:{type:"string",description:u("debugName","Name of configuration; appears in the launch configuration dropdown menu."),default:"Launch"},debugServer:{type:"number",description:u("debugServer","For debug extension development only: if a port is specified VS Code tries to connect to a debug adapter running in server mode"),default:4711},preLaunchTask:{anyOf:[i,{type:["string"]}],default:"",defaultSnippets:[{body:{task:"",type:""}}],description:u("debugPrelaunchTask","Task to run before debug session starts."),examples:this.taskLabels},postDebugTask:{anyOf:[i,{type:["string"]}],default:"",defaultSnippets:[{body:{task:"",type:""}}],description:u("debugPostDebugTask","Task to run after debug session ends."),examples:this.taskLabels},presentation:MY,internalConsoleOptions:SV,suppressMultipleSessionWarning:{type:"boolean",description:u("suppressMultipleSessionWarning","Disable the warning when trying to start the same debug configuration more than once."),default:!0}}}};hv.definitions=n,e.oneOf=[],e.defaultSnippets=[],this.debuggers.forEach(o=>{let s=o.getSchemaAttributes(n);s&&e.oneOf&&e.oneOf.push(...s);let a=o.configurationSnippets;a&&e.defaultSnippets&&e.defaultSnippets.push(...a)}),W_e.registerSchema($m,hv)}registerDebugAdapterFactory(e,i){return e.forEach(n=>this.debugAdapterFactories.set(n,i)),this.debuggersAvailable.set(this.hasEnabledDebuggers()),this._onDidRegisterDebugger.fire(),{dispose:()=>{e.forEach(n=>this.debugAdapterFactories.delete(n))}}}hasEnabledDebuggers(){for(let[e]of this.debugAdapterFactories){let i=this.getDebugger(e);if(i&&i.enabled)return!0}return!1}createDebugAdapter(e){let i=this.debugAdapterFactories.get(e.configuration.type);if(i)return i.createDebugAdapter(e)}substituteVariables(e,i,n){let o=this.debugAdapterFactories.get(e);return o?o.substituteVariables(i,n):Promise.resolve(n)}runInTerminal(e,i,n){let o=this.debugAdapterFactories.get(e);return o?o.runInTerminal(i,n):Promise.resolve(void 0)}registerDebugAdapterDescriptorFactory(e){return this.adapterDescriptorFactories.push(e),{dispose:()=>{this.unregisterDebugAdapterDescriptorFactory(e)}}}unregisterDebugAdapterDescriptorFactory(e){let i=this.adapterDescriptorFactories.indexOf(e);i>=0&&this.adapterDescriptorFactories.splice(i,1)}getDebugAdapterDescriptor(e){let i=e.configuration,n=this.adapterDescriptorFactories.filter(o=>o.type===i.type&&o.createDebugAdapterDescriptor);return n.length===1?n[0].createDebugAdapterDescriptor(e):Promise.resolve(void 0)}getDebuggerLabel(e){let i=this.getDebugger(e);if(i)return i.label}get onDidRegisterDebugger(){return this._onDidRegisterDebugger.event}get onDidDebuggersExtPointRead(){return this._onDidDebuggersExtPointRead.event}canSetBreakpointsIn(e){let i=e.getLanguageId();return!i||i==="jsonc"||i==="log"?!1:this.configurationService.getValue("debug").allowBreakpointsEverywhere?!0:this.breakpointContributions.some(n=>n.language===i&&n.enabled)}getDebugger(e){return this.debuggers.find(i=>dr(i.type,e))}getEnabledDebugger(e){let i=this.getDebugger(e);return i&&i.enabled?i:void 0}someDebuggerInterestedInLanguage(e){return!!this.debuggers.filter(i=>i.enabled).find(i=>i.interestedInLanguage(e))}async guessDebugger(e){let i=this.editorService.activeTextEditorControl,n=[],o=null,s=null;if(no(i)){s=i.getModel();let h=s?s.getLanguageId():void 0;h&&(o=this.languageService.getLanguageName(h));let m=this.debuggers.filter(f=>f.enabled).filter(f=>h&&f.interestedInLanguage(h));if(m.length===1)return m[0];m.length>1&&(n=m)}if((!o||e||s&&this.canSetBreakpointsIn(s))&&n.length===0&&(await this.activateDebuggers("onDebugInitialConfigurations"),n=this.debuggers.filter(h=>h.enabled).filter(h=>h.hasInitialConfiguration()||h.hasDynamicConfigurationProviders()||h.hasConfigurationProvider())),n.length===0&&o){o.indexOf(" ")>=0&&(o=`'${o}'`);let{confirmed:h}=await this.dialogService.confirm({type:Si.Warning,message:u("CouldNotFindLanguage","You don't have an extension for debugging {0}. Should we find a {0} extension in the Marketplace?",o),primaryButton:u({key:"findExtension",comment:["&& denotes a mnemonic"]},"&&Find {0} extension",o)});h&&await this.commandService.executeCommand("debug.installAdditionalDebuggers",o);return}this.initExtensionActivationsIfNeeded(),n.sort((h,m)=>h.label.localeCompare(m.label)),n=n.filter(h=>!h.isHiddenFromDropdown);let a=[],l=[];n.forEach(h=>{let m=h.getMainExtensionDescriptor();m.id&&this.earlyActivatedExtensions?.has(m.id)||this.usedDebugTypes.has(h.type)?a.push(h):l.push(h)});let d=[];a.length>0&&d.push({type:"separator",label:u("suggestedDebuggers","Suggested")},...a.map(h=>({label:h.label,debugger:h}))),l.length>0&&(d.length>0&&d.push({type:"separator",label:""}),d.push(...l.map(h=>({label:h.label,debugger:h})))),d.push({type:"separator",label:""},{label:o?u("installLanguage","Install an extension for {0}...",o):u("installExt","Install extension...")});let c=this.menuService.getMenuActions(V.DebugCreateConfiguration,this.contextKeyService);for(let[,h]of c)for(let m of h)d.push(m);let p=u("selectDebug","Select debugger");return this.quickInputService.pick(d,{activeItem:d[0],placeHolder:p}).then(async h=>{if(h&&"debugger"in h&&h.debugger)return h.debugger;if(h instanceof wn){h.run();return}h&&this.commandService.executeCommand("debug.installAdditionalDebuggers",o)})}initExtensionActivationsIfNeeded(){if(!this.earlyActivatedExtensions){this.earlyActivatedExtensions=new Set;let e=this.extensionService.getExtensionsStatus();for(let i in e)e[i].activationTimes&&this.earlyActivatedExtensions.add(i)}}async activateDebuggers(e,i){this.initExtensionActivationsIfNeeded();let n=[this.extensionService.activateByEvent(e),this.extensionService.activateByEvent("onDebug")];i&&n.push(this.extensionService.activateByEvent(`${e}:${i}`)),await Promise.all(n)}};cT=E([b(1,$e),b(2,se),b(3,ki),b(4,ne),b(5,ct),b(6,_n),b(7,re),b(8,ti),b(9,Io),b(10,er),b(11,W2),b(12,jt)],cT);var FP=q("historyService");var Fhe=Pe.as(wd.JSONContribution);Fhe.registerSchema($m,hv);var AY="debug.selectedconfigname",OY="debug.selectedroot",Nhe="debug.selectedtype",NY="debug.recentdynamicconfigurations",uT=class{constructor(t,e,i,n,o,s,a,l,d,c,p){this.adapterManager=t;this.contextService=e;this.configurationService=i;this.quickInputService=n;this.instantiationService=o;this.storageService=s;this.extensionService=a;this.historyService=l;this.uriIdentityService=d;this.logService=p;this.configProviders=[],this.toDispose=[this._onDidChangeConfigurationProviders],this.initLaunches(),this.setCompoundSchemaValues(),this.registerListeners();let h=this.storageService.get(OY,1),m=this.storageService.get(Nhe,1),f=this.launches.find(I=>I.uri.toString()===h),g=this.storageService.get(AY,1);this.debugConfigurationTypeContext=mce.bindTo(c);let v=m?{type:m}:void 0;f&&f.getConfigurationNames().length?this.selectConfiguration(f,g,void 0,v):this.launches.length>0&&this.selectConfiguration(void 0,g,void 0,v)}launches;selectedName;selectedLaunch;getSelectedConfig=()=>Promise.resolve(void 0);selectedType;selectedDynamic=!1;toDispose;_onDidSelectConfigurationName=new x;configProviders;debugConfigurationTypeContext;_onDidChangeConfigurationProviders=new x;onDidChangeConfigurationProviders=this._onDidChangeConfigurationProviders.event;registerDebugConfigurationProvider(t){return this.configProviders.push(t),this._onDidChangeConfigurationProviders.fire(),{dispose:()=>{this.unregisterDebugConfigurationProvider(t),this._onDidChangeConfigurationProviders.fire()}}}unregisterDebugConfigurationProvider(t){let e=this.configProviders.indexOf(t);e>=0&&this.configProviders.splice(e,1)}hasDebugConfigurationProvider(t,e){return e===void 0&&(e=1),!!this.configProviders.find(n=>n.provideDebugConfigurations&&n.type===t&&n.triggerKind===e)}async resolveConfigurationByProviders(t,e,i,n){let o=async(l,d)=>{l!=="*"&&await this.adapterManager.activateDebuggers("onDebugResolve",l);for(let c of this.configProviders)c.type===l&&c.resolveDebugConfiguration&&d&&(d=await c.resolveDebugConfiguration(t,d,n));return d},s=i.type??e,a=i;for(let l=new Set;a&&!l.has(s);)l.add(s),a=await o(s,a),a=await o("*",a),s=a?.type??e;return a}async resolveDebugConfigurationWithSubstitutedVariables(t,e,i,n){let o=this.configProviders.filter(a=>a.type===e&&a.resolveDebugConfigurationWithSubstitutedVariables).concat(this.configProviders.filter(a=>a.type==="*"&&a.resolveDebugConfigurationWithSubstitutedVariables)),s=i;return await Oee(o.map(a=>async()=>{s&&(s=await a.resolveDebugConfigurationWithSubstitutedVariables(t,s,n))})),s}async provideDebugConfigurations(t,e,i){return await this.adapterManager.activateDebuggers("onDebugInitialConfigurations"),(await Promise.all(this.configProviders.filter(o=>o.type===e&&o.triggerKind===1&&o.provideDebugConfigurations).map(o=>o.provideDebugConfigurations(t,i)))).reduce((o,s)=>o.concat(s),[])}async getDynamicProviders(){await this.extensionService.whenInstalledExtensionsRegistered();let t="onDebugDynamicConfigurations",e=this.extensionService.extensions.reduce((i,n)=>{if(!n.activationEvents)return i;let o=[],s=!1;for(let a of n.activationEvents)a===t?s=!0:a.startsWith(`${t}:`)&&o.push(a.slice(t.length+1));if(o.length)o.forEach(a=>i.add(a));else if(s){let a=n.contributes?.debuggers?.[0].type;a&&i.add(a)}return i},new Set);for(let i of this.configProviders)i.triggerKind===2&&e.add(i.type);return[...e].map(i=>({label:this.adapterManager.getDebuggerLabel(i),getProvider:async()=>(await this.adapterManager.activateDebuggers(t,i),this.configProviders.find(n=>n.type===i&&n.triggerKind===2&&n.provideDebugConfigurations)),type:i,pick:async()=>{await this.adapterManager.activateDebuggers(t,i);let n=new Kt,o=[],s=this.configProviders.find(m=>m.type===i&&m.triggerKind===2&&m.provideDebugConfigurations);this.getLaunches().forEach(m=>{m.workspace&&s&&o.push(s.provideDebugConfigurations(m.workspace.uri,n.token).then(f=>f.map(g=>({label:g.name,description:m.name,config:g,buttons:[{iconClass:de.asClassName(dE),tooltip:u("editLaunchConfig","Edit Debug Configuration in launch.json")}],launch:m}))))});let a=new B,l=a.add(this.quickInputService.createQuickPick());l.busy=!0,l.placeholder=u("selectConfiguration","Select Launch Configuration");let d=new Promise(m=>{a.add(l.onDidAccept(()=>m(l.activeItems[0]))),a.add(l.onDidTriggerItemButton(async f=>{m(void 0);let{launch:g,config:v}=f.item;await g.openConfigFile({preserveFocus:!1,type:v.type,suppressInitialConfigs:!0}),await g.writeConfiguration(v),await this.selectConfiguration(g,v.name),this.removeRecentDynamicConfigurations(v.name,v.type)})),a.add(l.onDidHide(()=>m(void 0)))}),c;try{c=await Promise.all(o)}catch(m){this.logService.error(m),a.dispose();return}let p=c.flat();l.items=p,l.busy=!1,l.show();let h=await d;if(a.dispose(),!h){n.cancel();return}return h}}))}getAllConfigurations(){let t=[];for(let e of this.launches)for(let i of e.getConfigurationNames()){let n=e.getConfiguration(i)||e.getCompound(i);n&&t.push({launch:e,name:i,presentation:n.presentation})}return A6(t)}removeRecentDynamicConfigurations(t,e){let i=this.getRecentDynamicConfigurations().filter(n=>n.name!==t||n.type!==e);this.storageService.store(NY,JSON.stringify(i),1,1),this.selectedConfiguration.name===t&&this.selectedType===e&&this.selectedDynamic?this.selectConfiguration(void 0,void 0):this._onDidSelectConfigurationName.fire()}getRecentDynamicConfigurations(){return JSON.parse(this.storageService.get(NY,1,"[]"))}registerListeners(){this.toDispose.push(X.any(this.contextService.onDidChangeWorkspaceFolders,this.contextService.onDidChangeWorkbenchState)(()=>{this.initLaunches(),this.selectConfiguration(void 0),this.setCompoundSchemaValues()})),this.toDispose.push(this.configurationService.onDidChangeConfiguration(async t=>{t.affectsConfiguration("launch")&&(await this.selectConfiguration(void 0),this.setCompoundSchemaValues())})),this.toDispose.push(this.adapterManager.onDidDebuggersExtPointRead(()=>{this.setCompoundSchemaValues()}))}initLaunches(){this.launches=this.contextService.getWorkspace().folders.map(t=>this.instantiationService.createInstance(BP,this,this.adapterManager,t)),this.contextService.getWorkbenchState()===3&&this.launches.push(this.instantiationService.createInstance(pT,this,this.adapterManager)),this.launches.push(this.instantiationService.createInstance(hT,this,this.adapterManager)),this.selectedLaunch&&this.launches.indexOf(this.selectedLaunch)===-1&&this.selectConfiguration(void 0)}setCompoundSchemaValues(){let t=hv.properties.compounds.items.properties.configurations,e=this.launches.map(n=>n.getConfigurationNames(!0)).reduce((n,o)=>n.concat(o),[]);t.items.oneOf[0].enum=e,t.items.oneOf[1].properties.name.enum=e;let i=this.contextService.getWorkspace().folders.map(n=>n.name);t.items.oneOf[1].properties.folder.enum=i,Fhe.registerSchema($m,hv)}getLaunches(){return this.launches}getLaunch(t){if(Z.isUri(t))return this.launches.find(e=>e.workspace&&this.uriIdentityService.extUri.isEqual(e.workspace.uri,t))}get selectedConfiguration(){return{launch:this.selectedLaunch,name:this.selectedName,getConfig:this.getSelectedConfig,type:this.selectedType}}get onDidSelectConfiguration(){return this._onDidSelectConfigurationName.event}getWorkspaceLaunch(){if(this.contextService.getWorkbenchState()===3)return this.launches[this.launches.length-1]}async selectConfiguration(t,e,i,n){if(typeof t>"u"){let c=this.historyService.getLastActiveWorkspaceRoot();t=this.getLaunch(c),(!t||t.getConfigurationNames().length===0)&&(t=this.launches.find(p=>!!(p&&p.getConfigurationNames().length))||t||this.launches[0])}let o=this.selectedLaunch,s=this.selectedName,a=this.selectedDynamic;this.selectedLaunch=t,this.selectedLaunch?this.storageService.store(OY,this.selectedLaunch.uri.toString(),1,1):this.storageService.remove(OY,1);let l=t?t.getConfigurationNames():[];this.getSelectedConfig=()=>{let c=this.selectedName?t?.getConfiguration(this.selectedName):void 0;return Promise.resolve(c||i)};let d=i?.type;if(e&&l.indexOf(e)>=0)this.setSelectedLaunchName(e);else if(n&&n.type){if(d=n.type,!i){let p=(await this.getDynamicProviders()).filter(h=>h.type===d);this.getSelectedConfig=async()=>{let h=await Promise.all(p.map(f=>f.getProvider())),m=h.length>0?h[0]:void 0;if(m&&t&&t.workspace){let f=new Kt,v=(await m.provideDebugConfigurations(t.workspace.uri,f.token)).find(I=>I.name===e);if(v)return v}}}this.setSelectedLaunchName(e);let c=this.getRecentDynamicConfigurations();e&&n.type&&(c.unshift({name:e,type:n.type}),c=Mo(c,p=>`${p.name} : ${p.type}`),this.storageService.store(NY,JSON.stringify(c),1,1))}else if(!this.selectedName||l.indexOf(this.selectedName)===-1){let c=l.length?l[0]:void 0;this.setSelectedLaunchName(c)}!i&&t&&this.selectedName&&(i=t.getConfiguration(this.selectedName),d=i?.type),this.selectedType=n?.type||i?.type,this.selectedDynamic=!!n,this.storageService.store(Nhe,n?this.selectedType:void 0,1,1),d?this.debugConfigurationTypeContext.set(d):this.debugConfigurationTypeContext.reset(),(this.selectedLaunch!==o||this.selectedName!==s||a!==this.selectedDynamic)&&this._onDidSelectConfigurationName.fire()}setSelectedLaunchName(t){this.selectedName=t,this.selectedName?this.storageService.store(AY,this.selectedName,1,1):this.storageService.remove(AY,1)}dispose(){this.toDispose=_e(this.toDispose)}};uT=E([b(1,kt),b(2,se),b(3,ki),b(4,ne),b(5,nt),b(6,_n),b(7,FP),b(8,zn),b(9,re),b(10,bt)],uT);var VP=class{constructor(t,e){this.configurationManager=t;this.adapterManager=e}getCompound(t){let e=this.getConfig();if(!(!e||!e.compounds))return e.compounds.find(i=>i.name===t)}getConfigurationNames(t=!1){let e=this.getConfig();if(!e||!Array.isArray(e.configurations)&&!Array.isArray(e.compounds))return[];{let i=[];return e.configurations&&i.push(...e.configurations.filter(n=>n&&typeof n.name=="string")),t?i.map(n=>n.name):(e.compounds&&i.push(...e.compounds.filter(n=>typeof n.name=="string"&&n.configurations&&n.configurations.length)),A6(i).map(n=>n.name))}}getConfiguration(t){let e=Xi(this.getConfig());if(!e||!e.configurations)return;let i=e.configurations.find(n=>n&&n.name===t);return i&&(this instanceof hT?i.__configurationTarget=2:this instanceof pT?i.__configurationTarget=5:i.__configurationTarget=6),i}async getInitialConfigurationContent(t,e,i,n){let o="",s=e?this.adapterManager.getEnabledDebugger(e):await this.adapterManager.guessDebugger(!0);if(s){let a=i?await this.configurationManager.provideDebugConfigurations(t,s.type,n||Pt.None):[];o=await s.getInitialConfigurationContent(a)}return o}get hidden(){return!1}},BP=class extends VP{constructor(e,i,n,o,s,a,l){super(e,i);this.workspace=n;this.fileService=o;this.textFileService=s;this.editorService=a;this.configurationService=l}get uri(){return pi(this.workspace.uri,"/.vscode/launch.json")}get name(){return this.workspace.name}getConfig(){return this.configurationService.inspect("launch",{resource:this.workspace.uri}).workspaceFolderValue}async openConfigFile({preserveFocus:e,type:i,suppressInitialConfigs:n},o){let s=this.uri,a=!1,l="";try{l=(await this.fileService.readFile(s)).value.toString()}catch{if(l=await this.getInitialConfigurationContent(this.workspace.uri,i,!n,o),!l)return{editor:null,created:!1};a=!0;try{await this.textFileService.write(s,l)}catch(m){throw new Error(u("DebugConfig.failed","Unable to create 'launch.json' file inside the '.vscode' folder ({0}).",m.message))}}let d=l.indexOf(`"${this.configurationManager.selectedConfiguration.name}"`),c=1;for(let m=0;m<d;m++)l.charAt(m)===`
`&&c++;let p=c>1?{startLineNumber:c,startColumn:4}:void 0;return{editor:await this.editorService.openEditor({resource:s,options:{selection:p,preserveFocus:e,pinned:a,revealIfVisible:!0}},Zp)??null,created:a}}async writeConfiguration(e){let i=Xi(this.getConfig());i.configurations||(i.configurations=[]),i.configurations.push(e),await this.configurationService.updateValue("launch",i,{resource:this.workspace.uri},6)}};BP=E([b(3,Ei),b(4,Us),b(5,$e),b(6,se)],BP);var pT=class extends VP{constructor(e,i,n,o,s){super(e,i);this.editorService=n;this.configurationService=o;this.contextService=s}get workspace(){}get uri(){return this.contextService.getWorkspace().configuration}get name(){return u("workspace","workspace")}getConfig(){return this.configurationService.inspect("launch").workspaceValue}async openConfigFile({preserveFocus:e,type:i,useInitialConfigs:n},o){if(!!!this.getConfig()){let l=await this.getInitialConfigurationContent(void 0,i,n,o);if(l)await this.configurationService.updateValue("launch",Ak(l),5);else return{editor:null,created:!1}}return{editor:await this.editorService.openEditor({resource:this.contextService.getWorkspace().configuration,options:{preserveFocus:e}},Zp)??null,created:!1}}};pT=E([b(2,$e),b(3,se),b(4,kt)],pT);var hT=class extends VP{constructor(e,i,n,o){super(e,i);this.configurationService=n;this.preferencesService=o}get workspace(){}get uri(){return this.preferencesService.userSettingsResource}get name(){return u("user settings","user settings")}get hidden(){return!0}getConfig(){return this.configurationService.inspect("launch").userValue}async openConfigFile({preserveFocus:e,type:i,useInitialContent:n}){return{editor:await this.preferencesService.openUserSettings({jsonEditor:!0,preserveFocus:e,revealSetting:{key:"launch"}})??null,created:!1}}};hT=E([b(2,se),b(3,jm)],hT);var H_e=/range=([0-9]+):([0-9]+)/,H2=class{constructor(t){this.debugService=t;t.onDidEndSession(({session:e})=>{for(let[i,n]of this.fdMemory)n.session===e&&this.close(i)})}memoryFdCounter=0;fdMemory=new Map;changeEmitter=new x;onDidChangeCapabilities=X.None;onDidChangeFile=this.changeEmitter.event;capabilities=1028;watch(t,e){if(e.recursive)return le(()=>{});let{session:i,memoryReference:n,offset:o}=this.parseUri(t),s=new B;return s.add(i.onDidChangeState(()=>{(i.state===3||i.state===0)&&this.changeEmitter.fire([{type:2,resource:t}])})),s.add(i.onDidInvalidateMemory(a=>{a.body.memoryReference===n&&(o&&(a.body.offset>=o.toOffset||a.body.offset+a.body.count<o.fromOffset)||this.changeEmitter.fire([{resource:t,type:0}]))})),s}stat(t){let{readOnly:e}=this.parseUri(t);return Promise.resolve({type:1,mtime:0,ctime:0,size:0,permissions:e?1:void 0})}mkdir(){throw rl("Not allowed","NoPermissions")}readdir(){throw rl("Not allowed","NoPermissions")}delete(){throw rl("Not allowed","NoPermissions")}rename(){throw rl("Not allowed","NoPermissions")}open(t,e){let{session:i,memoryReference:n,offset:o}=this.parseUri(t),s=this.memoryFdCounter++,a=i.getMemory(n);return o&&(a=new FY(a,o)),this.fdMemory.set(s,{session:i,region:a}),Promise.resolve(s)}close(t){return this.fdMemory.get(t)?.region.dispose(),this.fdMemory.delete(t),Promise.resolve()}async writeFile(t,e){let{offset:i}=this.parseUri(t);if(!i)throw rl("Range must be present to read a file","EntryNotFound");let n=await this.open(t,{create:!1});try{await this.write(n,i.fromOffset,e,0,e.length)}finally{this.close(n)}}async readFile(t){let{offset:e}=this.parseUri(t);if(!e)throw rl("Range must be present to read a file","EntryNotFound");let i=new Uint8Array(e.toOffset-e.fromOffset),n=await this.open(t,{create:!1});try{return await this.read(n,e.fromOffset,i,0,i.length),i}finally{this.close(n)}}async read(t,e,i,n,o){let s=this.fdMemory.get(t);if(!s)throw rl("No file with that descriptor open","Unavailable");let a=await s.region.read(e,o),l=0;for(let d of a)switch(d.type){case 1:return l;case 2:if(l>0)return l;throw rl(d.error,"Unknown");case 0:{let c=Math.max(0,e-d.offset),p=d.data.slice(c,Math.min(d.data.byteLength,c+(o-l)));i.set(p.buffer,n+l),l+=p.byteLength;break}default:gm(d)}return l}write(t,e,i,n,o){let s=this.fdMemory.get(t);if(!s)throw rl("No file with that descriptor open","Unavailable");return s.region.write(e,Jt.wrap(i).slice(n,n+o))}parseUri(t){if(t.scheme!==py)throw rl(`Cannot open file with scheme ${t.scheme}`,"EntryNotFound");let e=this.debugService.getModel().getSession(t.authority);if(!e)throw rl("Debug session not found","EntryNotFound");let i,n=H_e.exec(t.query);n&&(i={fromOffset:Number(n[1]),toOffset:Number(n[2])});let[,o]=t.path.split("/");return{session:e,offset:i,readOnly:!e.capabilities.supportsWriteMemoryRequest,sessionId:t.authority,memoryReference:decodeURIComponent(o)}}},FY=class extends R{constructor(e,i){super();this.parent=e;this.range=i;this.writable=e.writable,this._register(e),this._register(e.onDidInvalidate(n=>{let o=pn(n.fromOffset-i.fromOffset,0,this.width),s=pn(n.toOffset-i.fromOffset,0,this.width);s>o&&this.invalidateEmitter.fire({fromOffset:o,toOffset:s})}))}invalidateEmitter=new x;onDidInvalidate=this.invalidateEmitter.event;writable;width=this.range.toOffset-this.range.fromOffset;read(e,i){if(e<0)throw new RangeError(`Invalid fromOffset: ${e}`);return this.parent.read(this.range.fromOffset+e,this.range.fromOffset+Math.min(i,this.width))}write(e,i){return this.parent.write(this.range.fromOffset+e,i)}};var mT=class{constructor(t,e,i,n,o,s,a,l){this.dbgr=e;this.sessionId=i;this.name=n;this.extensionHostDebugService=o;this.openerService=s;this.notificationService=a;this.dialogSerivce=l;this.debugAdapter=t,this._capabilities=Object.create(null),this.toDispose.push(this.debugAdapter.onError(d=>{this.shutdown(d)})),this.toDispose.push(this.debugAdapter.onExit(d=>{d!==0?this.shutdown(new Error(`exit code: ${d}`)):this.shutdown()})),this.debugAdapter.onEvent(d=>{switch(d.event){case"initialized":this._readyForBreakpoints=!0,this._onDidInitialize.fire(d);break;case"loadedSource":this._onDidLoadedSource.fire(d);break;case"capabilities":if(d.body){let c=d.body.capabilities;this.mergeCapabilities(c)}break;case"stopped":this.didReceiveStoppedEvent=!0,this.stoppedSinceLastStep=!0,this._onDidStop.fire(d);break;case"continued":this.allThreadsContinued=d.body.allThreadsContinued!==!1,this._onDidContinued.fire(d);break;case"thread":this._onDidThread.fire(d);break;case"output":this._onDidOutput.fire(d);break;case"breakpoint":this._onDidBreakpoint.fire(d);break;case"terminated":this._onDidTerminateDebugee.fire(d);break;case"exited":this._onDidExitDebugee.fire(d);break;case"progressStart":this._onDidProgressStart.fire(d);break;case"progressUpdate":this._onDidProgressUpdate.fire(d);break;case"progressEnd":this._onDidProgressEnd.fire(d);break;case"invalidated":this._onDidInvalidated.fire(d);break;case"memory":this._onDidInvalidateMemory.fire(d);break;case"process":break;case"module":break;default:this._onDidCustomEvent.fire(d);break}this._onDidEvent.fire(d)}),this.debugAdapter.onRequest(d=>this.dispatchRequest(d))}allThreadsContinued=!0;_readyForBreakpoints=!1;_capabilities;debugAdapterStopped=!1;inShutdown=!1;terminated=!1;firedAdapterExitEvent=!1;startTime=0;didReceiveStoppedEvent=!1;_onDidInitialize=new x;_onDidStop=new x;_onDidContinued=new x;_onDidTerminateDebugee=new x;_onDidExitDebugee=new x;_onDidThread=new x;_onDidOutput=new x;_onDidBreakpoint=new x;_onDidLoadedSource=new x;_onDidProgressStart=new x;_onDidProgressUpdate=new x;_onDidProgressEnd=new x;_onDidInvalidated=new x;_onDidInvalidateMemory=new x;_onDidCustomEvent=new x;_onDidEvent=new x;_onDidExitAdapter=new x;debugAdapter;stoppedSinceLastStep=!1;toDispose=[];get isInShutdown(){return this.inShutdown}get onDidExitAdapter(){return this._onDidExitAdapter.event}get capabilities(){return this._capabilities}get readyForBreakpoints(){return this._readyForBreakpoints}get onDidInitialize(){return this._onDidInitialize.event}get onDidStop(){return this._onDidStop.event}get onDidContinued(){return this._onDidContinued.event}get onDidTerminateDebugee(){return this._onDidTerminateDebugee.event}get onDidExitDebugee(){return this._onDidExitDebugee.event}get onDidThread(){return this._onDidThread.event}get onDidOutput(){return this._onDidOutput.event}get onDidBreakpoint(){return this._onDidBreakpoint.event}get onDidLoadedSource(){return this._onDidLoadedSource.event}get onDidCustomEvent(){return this._onDidCustomEvent.event}get onDidProgressStart(){return this._onDidProgressStart.event}get onDidProgressUpdate(){return this._onDidProgressUpdate.event}get onDidProgressEnd(){return this._onDidProgressEnd.event}get onDidInvalidated(){return this._onDidInvalidated.event}get onDidInvalidateMemory(){return this._onDidInvalidateMemory.event}get onDidEvent(){return this._onDidEvent.event}async start(){if(!this.debugAdapter)return Promise.reject(new Error(u("noDebugAdapterStart","No debug adapter, can not start debug session.")));await this.debugAdapter.startSession(),this.startTime=new Date().getTime()}async initialize(t){let e=await this.send("initialize",t,void 0,void 0,!1);return e&&this.mergeCapabilities(e.body),e}disconnect(t){let e=this.capabilities.supportTerminateDebuggee?t.terminateDebuggee:void 0,i=this.capabilities.supportTerminateDebuggee&&this.capabilities.supportSuspendDebuggee?t.suspendDebuggee:void 0;return this.shutdown(void 0,t.restart,e,i)}async launchOrAttach(t){let e=await this.send(t.request,t,void 0,void 0,!1);return e&&this.mergeCapabilities(e.body),e}terminate(t=!1){return this.capabilities.supportsTerminateRequest?this.terminated?this.disconnect({terminateDebuggee:!0,restart:t}):(this.terminated=!0,this.send("terminate",{restart:t},void 0)):Promise.reject(new Error("terminated not supported"))}restart(t){return this.capabilities.supportsRestartRequest?this.send("restart",t):Promise.reject(new Error("restart not supported"))}async next(t){this.stoppedSinceLastStep=!1;let e=await this.send("next",t);return this.stoppedSinceLastStep||this.fireSimulatedContinuedEvent(t.threadId),e}async stepIn(t){this.stoppedSinceLastStep=!1;let e=await this.send("stepIn",t);return this.stoppedSinceLastStep||this.fireSimulatedContinuedEvent(t.threadId),e}async stepOut(t){this.stoppedSinceLastStep=!1;let e=await this.send("stepOut",t);return this.stoppedSinceLastStep||this.fireSimulatedContinuedEvent(t.threadId),e}async continue(t){this.stoppedSinceLastStep=!1;let e=await this.send("continue",t);return e&&e.body&&e.body.allThreadsContinued!==void 0&&(this.allThreadsContinued=e.body.allThreadsContinued),this.stoppedSinceLastStep||this.fireSimulatedContinuedEvent(t.threadId,this.allThreadsContinued),e}pause(t){return this.send("pause",t)}terminateThreads(t){return this.capabilities.supportsTerminateThreadsRequest?this.send("terminateThreads",t):Promise.reject(new Error("terminateThreads not supported"))}setVariable(t){return this.capabilities.supportsSetVariable?this.send("setVariable",t):Promise.reject(new Error("setVariable not supported"))}setExpression(t){return this.capabilities.supportsSetExpression?this.send("setExpression",t):Promise.reject(new Error("setExpression not supported"))}async restartFrame(t,e){if(this.capabilities.supportsRestartFrame){this.stoppedSinceLastStep=!1;let i=await this.send("restartFrame",t);return this.stoppedSinceLastStep||this.fireSimulatedContinuedEvent(e),i}return Promise.reject(new Error("restartFrame not supported"))}stepInTargets(t){return this.capabilities.supportsStepInTargetsRequest?this.send("stepInTargets",t):Promise.reject(new Error("stepInTargets not supported"))}completions(t,e){return this.capabilities.supportsCompletionsRequest?this.send("completions",t,e):Promise.reject(new Error("completions not supported"))}setBreakpoints(t){return this.send("setBreakpoints",t)}setFunctionBreakpoints(t){return this.capabilities.supportsFunctionBreakpoints?this.send("setFunctionBreakpoints",t):Promise.reject(new Error("setFunctionBreakpoints not supported"))}dataBreakpointInfo(t){return this.capabilities.supportsDataBreakpoints?this.send("dataBreakpointInfo",t):Promise.reject(new Error("dataBreakpointInfo not supported"))}setDataBreakpoints(t){return this.capabilities.supportsDataBreakpoints?this.send("setDataBreakpoints",t):Promise.reject(new Error("setDataBreakpoints not supported"))}setExceptionBreakpoints(t){return this.send("setExceptionBreakpoints",t)}breakpointLocations(t){return this.capabilities.supportsBreakpointLocationsRequest?this.send("breakpointLocations",t):Promise.reject(new Error("breakpointLocations is not supported"))}configurationDone(){return this.capabilities.supportsConfigurationDoneRequest?this.send("configurationDone",null):Promise.reject(new Error("configurationDone not supported"))}stackTrace(t,e){return this.send("stackTrace",t,e)}exceptionInfo(t){return this.capabilities.supportsExceptionInfoRequest?this.send("exceptionInfo",t):Promise.reject(new Error("exceptionInfo not supported"))}scopes(t,e){return this.send("scopes",t,e)}variables(t,e){return this.send("variables",t,e)}source(t){return this.send("source",t)}locations(t){return this.send("locations",t)}loadedSources(t){return this.capabilities.supportsLoadedSourcesRequest?this.send("loadedSources",t):Promise.reject(new Error("loadedSources not supported"))}threads(){return this.send("threads",null)}evaluate(t){return this.send("evaluate",t)}async stepBack(t){if(this.capabilities.supportsStepBack){this.stoppedSinceLastStep=!1;let e=await this.send("stepBack",t);return this.stoppedSinceLastStep||this.fireSimulatedContinuedEvent(t.threadId),e}return Promise.reject(new Error("stepBack not supported"))}async reverseContinue(t){if(this.capabilities.supportsStepBack){this.stoppedSinceLastStep=!1;let e=await this.send("reverseContinue",t);return this.stoppedSinceLastStep||this.fireSimulatedContinuedEvent(t.threadId),e}return Promise.reject(new Error("reverseContinue not supported"))}gotoTargets(t){return this.capabilities.supportsGotoTargetsRequest?this.send("gotoTargets",t):Promise.reject(new Error("gotoTargets is not supported"))}async goto(t){if(this.capabilities.supportsGotoTargetsRequest){this.stoppedSinceLastStep=!1;let e=await this.send("goto",t);return this.stoppedSinceLastStep||this.fireSimulatedContinuedEvent(t.threadId),e}return Promise.reject(new Error("goto is not supported"))}async setInstructionBreakpoints(t){return this.capabilities.supportsInstructionBreakpoints?await this.send("setInstructionBreakpoints",t):Promise.reject(new Error("setInstructionBreakpoints is not supported"))}async disassemble(t){return this.capabilities.supportsDisassembleRequest?await this.send("disassemble",t):Promise.reject(new Error("disassemble is not supported"))}async readMemory(t){return this.capabilities.supportsReadMemoryRequest?await this.send("readMemory",t):Promise.reject(new Error("readMemory is not supported"))}async writeMemory(t){return this.capabilities.supportsWriteMemoryRequest?await this.send("writeMemory",t):Promise.reject(new Error("writeMemory is not supported"))}cancel(t){return this.send("cancel",t)}custom(t,e){return this.send(t,e)}async shutdown(t,e=!1,i=void 0,n=void 0){if(!this.inShutdown)if(this.inShutdown=!0,this.debugAdapter)try{let o={restart:e};typeof i=="boolean"&&(o.terminateDebuggee=i),typeof n=="boolean"&&(o.suspendDebuggee=n),await this.send("disconnect",o,void 0,t?200:2e3)}catch{}finally{await this.stopAdapter(t)}else return this.stopAdapter(t)}async stopAdapter(t){try{if(this.debugAdapter){let e=this.debugAdapter;this.debugAdapter=null,await e.stopSession(),this.debugAdapterStopped=!0}}finally{this.fireAdapterExitEvent(t)}}fireAdapterExitEvent(t){if(!this.firedAdapterExitEvent){this.firedAdapterExitEvent=!0;let e={emittedStopped:this.didReceiveStoppedEvent,sessionLengthInSeconds:(new Date().getTime()-this.startTime)/1e3};t&&!this.debugAdapterStopped&&(e.error=t),this._onDidExitAdapter.fire(e)}}async dispatchRequest(t){let e={type:"response",seq:0,command:t.command,request_seq:t.seq,success:!0},i=n=>this.debugAdapter&&this.debugAdapter.sendResponse(n);if(t.command==="launchVSCode")try{let n=await this.launchVsCode(t.arguments);if(!n.success){let{confirmed:o}=await this.dialogSerivce.confirm({type:Sc.Warning,message:u("canNotStart","The debugger needs to open a new tab or window for the debuggee but the browser prevented this. You must give permission to continue."),primaryButton:u({key:"continue",comment:["&& denotes a mnemonic"]},"&&Continue")});o?n=await this.launchVsCode(t.arguments):(e.success=!1,i(e),await this.shutdown())}e.body={rendererDebugPort:n.rendererDebugPort},i(e)}catch(n){e.success=!1,e.message=n.message,i(e)}else if(t.command==="runInTerminal")try{let n=await this.dbgr.runInTerminal(t.arguments,this.sessionId),o=e;o.body={},typeof n=="number"&&(o.body.shellProcessId=n),i(o)}catch(n){e.success=!1,e.message=n.message,i(e)}else if(t.command==="startDebugging")try{let n=t.arguments,o={...n.configuration,request:n.request,type:this.dbgr.type,name:n.configuration.name||this.name};await this.dbgr.startDebugging(o,this.sessionId)||(e.success=!1,e.message="Failed to start debugging"),i(e)}catch(n){e.success=!1,e.message=n.message,i(e)}else e.success=!1,e.message=`unknown request '${t.command}'`,i(e)}launchVsCode(t){let e=[];for(let i of t.args){let n=(i.prefix||"")+(i.path||""),o=/^--(.+)=(.+)$/.exec(n);if(o&&o.length===3){let s=o[1],a=o[2];(s==="file-uri"||s==="folder-uri")&&!dy(i.path)&&(a=dy(a)?a:Z.file(a).toString()),e.push(`--${s}=${a}`)}else e.push(n)}return t.env&&e.push(`--extensionEnvironment=${JSON.stringify(t.env)}`),this.extensionHostDebugService.openExtensionDevelopmentHostWindow(e,!!t.debugRenderer)}send(t,e,i,n,o=!0){return new Promise((s,a)=>{if(!this.debugAdapter){this.inShutdown?s(void 0):a(new Error(u("noDebugAdapter","No debugger available found. Can not send '{0}'.",t)));return}let l,d=this.debugAdapter.sendRequest(t,e,c=>{l?.dispose(),c.success?s(c):a(c)},n);i&&(l=i.onCancellationRequested(()=>{l.dispose(),this.capabilities.supportsCancelRequest&&this.cancel({requestId:d})}))}).then(void 0,s=>Promise.reject(this.handleErrorResponse(s,o)))}handleErrorResponse(t,e){if(t.command==="canceled"&&t.message==="canceled")return new wo;let i=t?.body?.error,n=t?.message||"",o=i?qde(i.format,!1,i.variables):n,s=i?.url;if(i&&s){let l=i.urlLabel?i.urlLabel:u("moreInfo","More Info"),d=Z.parse(s),c=d.scheme===Ie.command?"debug.moreInfo.command":"debug.moreInfo";return WC(o,[fn({id:c,label:l,run:()=>this.openerService.open(d,{allowCommands:!0})})])}e&&i&&i.format&&i.showUser&&this.notificationService.error(o);let a=new Ga(o);return a.showUser=i?.showUser,a}mergeCapabilities(t){t&&(this._capabilities=Bs(this._capabilities,t))}fireSimulatedContinuedEvent(t,e=!1){this._onDidContinued.fire({type:"event",event:"continued",body:{threadId:t,allThreadsContinued:e},seq:void 0})}dispose(){_e(this.toDispose)}};mT=E([b(4,V2),b(5,Yi),b(6,mi),b(7,Io)],mT);var U_e={deserialize:r=>JSON.parse(r),serialize:r=>JSON.stringify(r)},jh=class extends R{constructor(e,i){super();this.storage=i;this.key=e.key,this.scope=e.scope,this.target=e.target,this.serialization=e.serialization??U_e,this.onDidChange=this.storage.onDidChangeValue(this.scope,this.key,this._register(new B))}serialization;key;scope;target;value;onDidChange;get(e){if(this.value===void 0){let i=this.storage.get(this.key,this.scope);this.value=i===void 0?e:this.serialization.deserialize(i)}return this.value}store(e){this.value=e,this.storage.store(this.key,this.serialization.serialize(e),this.scope,this.target)}delete(){this.storage.remove(this.key,this.scope)}};jh=E([b(1,nt)],jh);var U2=class r extends R{constructor(e){super();this._value=e}changeEmitter=this._register(new x);onDidChange=this.changeEmitter.event;get value(){return this._value}set value(e){e!==this._value&&(this._value=e,this.changeEmitter.fire(e))}static stored(e,i){let n=new r(e.get(i));return n._register(e),n._register(n.onDidChange(o=>e.store(o))),n}};var z2=class extends R{constructor(e){super();this.storageService=e}excluded=this._register(U2.stored(new jh({key:"excludedTestItems",scope:1,target:1,serialization:{deserialize:e=>new Set(JSON.parse(e)),serialize:e=>JSON.stringify([...e])}},this.storageService),new Set));onTestExclusionsChanged=this.excluded.onDidChange;get hasAny(){return this.excluded.value.size>0}get all(){return this.excluded.value}toggle(e,i){i!==!0&&this.excluded.value.has(e.item.extId)?this.excluded.value=new Set(mt.filter(this.excluded.value,n=>n!==e.item.extId)):i!==!1&&!this.excluded.value.has(e.item.extId)&&(this.excluded.value=new Set([...this.excluded.value,e.item.extId]))}contains(e){return this.excluded.value.has(e.item.extId)}clear(){this.excluded.value=new Set}};z2=E([b(0,nt)],z2);var K2=q("testService");var Uao={6:u("testState.errored","Errored"),4:u("testState.failed","Failed"),3:u("testState.passed","Passed"),1:u("testState.queued","Queued"),2:u("testState.running","Running"),5:u("testState.skipped","Skipped"),0:u("testState.unset","Not yet run")};var zao={4:u("testGroup.debug","Debug"),2:u("testGroup.run","Run"),8:u("testGroup.coverage","Coverage")};var Ju;(pe=>(pe.providerCount=new A("testing.providerCount",0),pe.canRefreshTests=new A("testing.canRefresh",!1,{type:"boolean",description:u("testing.canRefresh","Indicates whether any test controller has an attached refresh handler.")}),pe.isRefreshingTests=new A("testing.isRefreshing",!1,{type:"boolean",description:u("testing.isRefreshing","Indicates whether any test controller is currently refreshing tests.")}),pe.isContinuousModeOn=new A("testing.isContinuousModeOn",!1,{type:"boolean",description:u("testing.isContinuousModeOn","Indicates whether continuous test mode is on.")}),pe.hasDebuggableTests=new A("testing.hasDebuggableTests",!1,{type:"boolean",description:u("testing.hasDebuggableTests","Indicates whether any test controller has registered a debug configuration")}),pe.hasRunnableTests=new A("testing.hasRunnableTests",!1,{type:"boolean",description:u("testing.hasRunnableTests","Indicates whether any test controller has registered a run configuration")}),pe.hasCoverableTests=new A("testing.hasCoverableTests",!1,{type:"boolean",description:u("testing.hasCoverableTests","Indicates whether any test controller has registered a coverage configuration")}),pe.hasNonDefaultProfile=new A("testing.hasNonDefaultProfile",!1,{type:"boolean",description:u("testing.hasNonDefaultConfig","Indicates whether any test controller has registered a non-default configuration")}),pe.hasConfigurableProfile=new A("testing.hasConfigurableProfile",!1,{type:"boolean",description:u("testing.hasConfigurableConfig","Indicates whether any test configuration can be configured")}),pe.supportsContinuousRun=new A("testing.supportsContinuousRun",!1,{type:"boolean",description:u("testing.supportsContinuousRun","Indicates whether continous test running is supported")}),pe.isParentRunningContinuously=new A("testing.isParentRunningContinuously",!1,{type:"boolean",description:u("testing.isParentRunningContinuously","Indicates whether the parent of a test is continuously running, set in the menu context of test items")}),pe.activeEditorHasTests=new A("testing.activeEditorHasTests",!1,{type:"boolean",description:u("testing.activeEditorHasTests","Indicates whether any tests are present in the current editor")}),pe.cursorInsideTestRange=new A("testing.cursorInsideTestRange",!1,{type:"boolean",description:u("testing.cursorInsideTestRange","Whether the cursor is currently inside a test range")}),pe.isTestCoverageOpen=new A("testing.isTestCoverageOpen",!1,{type:"boolean",description:u("testing.isTestCoverageOpen","Indicates whether a test coverage report is open")}),pe.hasPerTestCoverage=new A("testing.hasPerTestCoverage",!1,{type:"boolean",description:u("testing.hasPerTestCoverage","Indicates whether per-test coverage is available")}),pe.isCoverageFilteredToTest=new A("testing.isCoverageFilteredToTest",!1,{type:"boolean",description:u("testing.isCoverageFilteredToTest","Indicates whether coverage has been filterd to a single test")}),pe.coverageToolbarEnabled=new A("testing.coverageToolbarEnabled",!0,{type:"boolean",description:u("testing.coverageToolbarEnabled","Indicates whether the coverage toolbar is enabled")}),pe.inlineCoverageEnabled=new A("testing.inlineCoverageEnabled",!1,{type:"boolean",description:u("testing.inlineCoverageEnabled","Indicates whether inline coverage is shown")}),pe.canGoToRelatedCode=new A("testing.canGoToRelatedCode",!1,{type:"boolean",description:u("testing.canGoToRelatedCode","Whether a controller implements a capability to find code related to a test")}),pe.canGoToRelatedTest=new A("testing.canGoToRelatedTest",!1,{type:"boolean",description:u("testing.canGoToRelatedTest","Whether a controller implements a capability to find tests related to code")}),pe.peekHasStack=new A("testing.peekHasStack",!1,{type:"boolean",description:u("testing.peekHasStack","Whether the message shown in a peek view has a stack trace")}),pe.capabilityToContextKey={2:pe.hasRunnableTests,8:pe.hasCoverableTests,4:pe.hasDebuggableTests,16:pe.hasNonDefaultProfile,32:pe.hasConfigurableProfile,64:pe.supportsContinuousRun},pe.hasAnyResults=new A("testing.hasAnyResults",!1),pe.viewMode=new A("testing.explorerViewMode","list"),pe.viewSorting=new A("testing.explorerViewSorting","location"),pe.isRunning=new A("testing.isRunning",!1),pe.isInPeek=new A("testing.isInPeek",!1),pe.isPeekVisible=new A("testing.isPeekVisible",!1),pe.peekItemType=new A("peekItemType",void 0,{type:"string",description:u("testing.peekItemType",'Type of the item in the output peek view. Either a "test", "message", "task", or "result".')}),pe.controllerId=new A("controllerId",void 0,{type:"string",description:u("testing.controllerId","Controller ID of the current test item")}),pe.testItemExtId=new A("testId",void 0,{type:"string",description:u("testing.testId","ID of the current test item, set when creating or opening menus on test items")}),pe.testItemHasUri=new A("testing.testItemHasUri",!1,{type:"boolean",description:u("testing.testItemHasUri","Boolean indicating whether the test item has a URI defined")}),pe.testItemIsHidden=new A("testing.testItemIsHidden",!1,{type:"boolean",description:u("testing.testItemIsHidden","Boolean indicating whether the test item is hidden")}),pe.testMessageContext=new A("testMessage",void 0,{type:"string",description:u("testing.testMessage","Value set in `testMessage.contextValue`, available in editor/content and testing/message/context")}),pe.testResultOutdated=new A("testResultOutdated",void 0,{type:"boolean",description:u("testing.testResultOutdated","Value available in editor/content and testing/message/context when the result is outdated")}),pe.testResultState=new A("testResultState",void 0,{type:"string",description:u("testing.testResultState","Value available testing/item/result indicating the state of the item.")}),pe.testProfileContextGroup=new A("testing.profile.context.group",void 0,{type:"string",description:u("testing.profile.context.group",'Type of menu where the configure testing profile submenu exists. Either "run", "debug", or "coverage"')})))(Ju||={});var Bhe=q("testProfileService");var VY=(r,t)=>r.isDefault!==t.isDefault?r.isDefault?-1:1:r.label.localeCompare(t.label);var G2=class extends R{userDefaults;capabilitiesContexts;changeEmitter=this._register(new x);controllerProfiles=new Map;onDidChange=this.changeEmitter.event;constructor(t,e){super(),e.remove("testingPreferredProfiles",1),this.userDefaults=this._register(new jh({key:"testingPreferredProfiles2",scope:1,target:1},e)),this.capabilitiesContexts={2:Ju.hasRunnableTests.bindTo(t),4:Ju.hasDebuggableTests.bindTo(t),8:Ju.hasCoverableTests.bindTo(t),16:Ju.hasNonDefaultProfile.bindTo(t),32:Ju.hasConfigurableProfile.bindTo(t),64:Ju.supportsContinuousRun.bindTo(t)},this.refreshContextKeys()}addProfile(t,e){let i=this.userDefaults.get()?.[t.id]?.[e.profileId],n={...e,isDefault:i??e.isDefault,wasInitiallyDefault:e.isDefault},o=this.controllerProfiles.get(e.controllerId);o?(o.profiles.push(n),o.profiles.sort(VY)):(o={profiles:[n],controller:t},this.controllerProfiles.set(e.controllerId,o)),this.refreshContextKeys(),this.changeEmitter.fire()}updateProfile(t,e,i){let n=this.controllerProfiles.get(t);if(!n)return;let o=n.profiles.find(s=>s.controllerId===t&&s.profileId===e);if(o){if(Object.assign(o,i),n.profiles.sort(VY),i.isDefault!==void 0){let s=Xi(this.userDefaults.get({}));WY(s,o,i.isDefault),this.userDefaults.store(s)}this.changeEmitter.fire()}}configure(t,e){this.controllerProfiles.get(t)?.controller.configureRunProfile(e)}removeProfile(t,e){let i=this.controllerProfiles.get(t);if(!i)return;if(!e){this.controllerProfiles.delete(t),this.changeEmitter.fire();return}let n=i.profiles.findIndex(o=>o.profileId===e);n!==-1&&(i.profiles.splice(n,1),this.refreshContextKeys(),this.changeEmitter.fire())}capabilitiesForTest(t){let e=this.controllerProfiles.get(wh.root(t.extId));if(!e)return 0;let i=0;for(let n of e.profiles)(!n.tag||t.tags.includes(n.tag))&&(i|=i&n.group?16:n.group);return i}all(){return this.controllerProfiles.values()}getControllerProfiles(t){return this.controllerProfiles.get(t)?.profiles??[]}getGroupDefaultProfiles(t,e){let i=e?this.controllerProfiles.get(e)?.profiles||[]:[...mt.flatMap(this.controllerProfiles.values(),o=>o.profiles)],n=i.filter(o=>o.group===t&&o.isDefault);if(n.length===0){let o=i.find(s=>s.group===t);o&&n.push(o)}return n}setGroupDefaultProfiles(t,e){let i={};for(let n of this.controllerProfiles.values()){i[n.controller.id]={};for(let o of n.profiles)o.group===t&&WY(i,o,e.some(s=>s.profileId===o.profileId));for(let o of n.profiles){if(o.group===t)continue;let s=n.profiles.find(a=>a.group===t&&a.label===o.label);s&&WY(i,o,s.isDefault)}n.profiles.sort(VY)}this.userDefaults.store(i),this.changeEmitter.fire()}refreshContextKeys(){let t=0;for(let{profiles:e}of this.controllerProfiles.values())for(let i of e)t|=t&i.group?16:i.group,t|=i.supportsContinuousRun?64:0;for(let e of ace)this.capabilitiesContexts[e].set((t&e)!==0)}};G2=E([b(0,re),b(1,nt)],G2);var WY=(r,t,e)=>{t.isDefault=e,r[t.controllerId]??={},t.isDefault!==t.wasInitiallyDefault?r[t.controllerId][t.profileId]=t.isDefault:delete r[t.controllerId][t.profileId]};var HY=128,z_e=16,K_e=1024*128,G_e=.2,Vhe=q("ITestResultStorage"),$2=1,WP=class extends R{constructor(e,i,n){super();this.uriIdentityService=e;this.storageService=i;this.logService=n}stored=this._register(new jh({key:"storedTestResults",scope:1,target:1},this.storageService));async read(){return(await Promise.all(this.stored.get([]).map(async({id:i,rev:n})=>{if(n===$2)try{let o=await this.readForResultId(i);return o?new iV(this.uriIdentityService,o):void 0}catch(o){this.logService.warn(`Error deserializing stored test result ${i}`,o);return}}))).filter(go)}getResultOutputWriter(e){let i=yie();return this.storeOutputForResultId(e,i),i}async persist(e){let i=new Map(this.stored.get([]).map(({id:a,bytes:l})=>[a,l])),n=[],o=[],s=K_e;for(let a=0;a<e.length&&a<HY&&(s>0||n.length<z_e);a++){let l=e[a],d=i.get(l.id);if(d!==void 0){i.delete(l.id),n.push({id:l.id,rev:$2,bytes:d}),s-=d;continue}let c=l.toJSON();if(!c)continue;let p=Jt.fromString(JSON.stringify(c));o.push(this.storeForResultId(l.id,c)),n.push({id:l.id,rev:$2,bytes:p.byteLength}),s-=p.byteLength}for(let a of i.keys())o.push(this.deleteForResultId(a).catch(()=>{}));this.stored.store(n),await Promise.all(o)}};WP=E([b(0,zn),b(1,nt),b(2,bt)],WP);var q2=class extends WP{constructor(e,i,n,o,s,a){super(e,i,n);this.fileService=s;this.directory=Z.joinPath(a.workspaceStorageHome,o.getWorkspace().id,"testResults")}directory;async readForResultId(e){let i=await this.fileService.readFile(this.getResultJsonPath(e));return JSON.parse(i.value.toString())}storeForResultId(e,i){return this.fileService.writeFile(this.getResultJsonPath(e),Jt.fromString(JSON.stringify(i)))}deleteForResultId(e){return this.fileService.del(this.getResultJsonPath(e)).catch(()=>{})}async readOutputRangeForResultId(e,i,n){try{let{value:o}=await this.fileService.readFile(this.getResultOutputPath(e),{position:i,length:n});return o}catch{return Jt.alloc(0)}}async readOutputForResultId(e){try{let{value:i}=await this.fileService.readFileStream(this.getResultOutputPath(e));return i}catch{return kO(Jt.alloc(0))}}async storeOutputForResultId(e,i){await this.fileService.createFile(this.getResultOutputPath(e),i)}async persist(e){await super.persist(e),Math.random()<G_e&&await this.cleanupDereferenced()}async cleanupDereferenced(){let{children:e}=await this.fileService.resolve(this.directory);if(!e)return;let i=new Set(this.stored.get([]).filter(n=>n.rev===$2).map(n=>n.id));await Promise.all(e.filter(n=>!i.has(n.name.replace(/\.[a-z]+$/,""))).map(n=>this.fileService.del(n.resource).catch(()=>{})))}getResultJsonPath(e){return Z.joinPath(this.directory,`${e}.json`)}getResultOutputPath(e){return Z.joinPath(this.directory,`${e}.output`)}};q2=E([b(0,zn),b(1,nt),b(2,bt),b(3,kt),b(4,Ei),b(5,$o)],q2);var q_e=r=>r.results.length>0&&r.results[0].completedAt===void 0,Whe=q("testResultService"),j2=class extends R{constructor(e,i,n,o){super();this.storage=i;this.testProfiles=n;this.telemetryService=o;this._register(le(()=>_e(this._resultsDisposables))),this.isRunning=Ju.isRunning.bindTo(e),this.hasAnyResults=Ju.hasAnyResults.bindTo(e)}changeResultEmitter=this._register(new x);_results=[];_resultsDisposables=[];testChangeEmitter=this._register(new x);get results(){return this.loadResults(),this._results}onResultsChanged=this.changeResultEmitter.event;onTestChanged=this.testChangeEmitter.event;isRunning;hasAnyResults;loadResults=$a(()=>this.storage.read().then(e=>{for(let i=e.length-1;i>=0;i--)this.push(e[i])}));persistScheduler=new Ye(()=>this.persistImmediately(),500);getStateById(e){for(let i of this.results){let n=i.getStateById(e);if(n&&n.computedState!==0)return[i,n]}}createLiveResult(e){if("targets"in e){let o=Ni();return this.push(new yb(o,!0,e,this.telemetryService))}let i;e.profile&&(i=this.testProfiles.getControllerProfiles(e.controllerId).find(s=>s.profileId===e.profile.id));let n={preserveFocus:e.preserveFocus,targets:[],exclude:e.exclude,continuous:e.continuous,group:i?.group??2};return i&&n.targets.push({profileId:i.profileId,controllerId:e.controllerId,testIds:e.include}),this.push(new yb(e.id,e.persist,n,this.telemetryService))}push(e){if(e.completedAt===void 0)this.results.unshift(e);else{let n=Av(this.results,o=>o.completedAt!==void 0&&o.completedAt<=e.completedAt);this.results.splice(n,0,e),this.persistScheduler.schedule()}this.hasAnyResults.set(!0),this.results.length>HY&&(this.results.pop(),this._resultsDisposables.pop()?.dispose());let i=new B;if(this._resultsDisposables.push(i),e instanceof yb)i.add(e),i.add(e.onComplete(()=>this.onComplete(e))),i.add(e.onChange(this.testChangeEmitter.fire,this.testChangeEmitter)),this.isRunning.set(!0),this.changeResultEmitter.fire({started:e});else{this.changeResultEmitter.fire({inserted:e});for(let n of e.tests)for(let o of this.results)if(o===e){this.testChangeEmitter.fire({item:n,result:e,reason:0});break}else if(o.getStateById(n.item.extId)!==void 0)break}return e}getResult(e){return this.results.find(i=>i.id===e)}clear(){let e=[],i=[];for(let n of this.results)n.completedAt!==void 0?i.push(n):e.push(n);this._results=e,this.persistScheduler.schedule(),e.length===0&&this.hasAnyResults.set(!1),this.changeResultEmitter.fire({removed:i})}onComplete(e){this.resort(),this.updateIsRunning(),this.persistScheduler.schedule(),this.changeResultEmitter.fire({completed:e})}resort(){this.results.sort((e,i)=>(i.completedAt??Number.MAX_SAFE_INTEGER)-(e.completedAt??Number.MAX_SAFE_INTEGER))}updateIsRunning(){this.isRunning.set(q_e(this))}async persistImmediately(){await this.loadResults(),this.storage.persist(this.results)}};j2=E([b(0,re),b(1,Vhe),b(2,Bhe),b(3,Tt)],j2);var $_e=1500,gT=class{constructor(t,e,i,n,o,s,a,l,d,c,p,h,m,f,g,v,I,y,w,C,S,D){this.id=t;this._configuration=e;this.root=i;this.model=n;this.debugService=s;this.telemetryService=a;this.hostService=l;this.configurationService=d;this.paneCompositeService=c;this.workspaceContextService=p;this.productService=h;this.notificationService=m;this.uriIdentityService=g;this.instantiationService=v;this.customEndpointTelemetryService=I;this.workbenchEnvironmentService=y;this.logService=w;this.testService=C;this.accessibilityService=D;this._options=o||{},this.parentSession=this._options.parentSession,this.hasSeparateRepl()?this.repl=new TU(this.configurationService):this.repl=this.parentSession.repl;let k=this.globalDisposables,M=k.add(new yt);M.value=this.repl.onDidChangeElements(G=>this._onDidChangeREPLElements.fire(G)),f&&k.add(f.onWillShutdown(()=>{this.shutdown(),_e(k)})),this.correlatedTestRun=o?.testRun?S.getResult(o.testRun.runId):this.parentSession?.correlatedTestRun,this.correlatedTestRun&&k.add(this.correlatedTestRun.onComplete(()=>this.terminate()));let O=this._options.compoundRoot;O&&k.add(O.onDidSessionStop(()=>this.terminate())),this.passFocusScheduler=new Ye(()=>{if(this.debugService.getModel().getSessions().some(G=>G.state===2)||this.getAllThreads().some(G=>G.stopped))if(typeof this.lastContinuedThreadId=="number"){let G=this.debugService.getViewModel().focusedThread;if(G&&G.threadId===this.lastContinuedThreadId&&!G.stopped){let Y=this.getStoppedDetails()?.threadId,ge=typeof Y=="number"?this.getThread(Y):void 0;this.debugService.focusStackFrame(void 0,ge)}}else{let G=this.debugService.getViewModel().focusedSession;G&&G.getId()===this.getId()&&G.state!==2&&this.debugService.focusStackFrame(void 0)}},800);let K=this._options.parentSession;K&&k.add(K.onDidEndAdapter(()=>{!this.hasSeparateRepl()&&this.raw?.isInShutdown===!1&&(this.repl=this.repl.clone(),M.value=this.repl.onDidChangeElements(G=>this._onDidChangeREPLElements.fire(G)),this.parentSession=void 0)}))}parentSession;_subId;raw;initialized=!1;_options;sources=new Map;threads=new Map;threadIds=[];cancellationMap=new Map;rawListeners=new B;globalDisposables=new B;fetchThreadsScheduler;passFocusScheduler;lastContinuedThreadId;repl;stoppedDetails=[];statusQueue=this.rawListeners.add(new UY);correlatedTestRun;didTerminateTestRun;_onDidChangeState=new x;_onDidEndAdapter=new x;_onDidLoadedSource=new x;_onDidCustomEvent=new x;_onDidProgressStart=new x;_onDidProgressUpdate=new x;_onDidProgressEnd=new x;_onDidInvalidMemory=new x;_onDidChangeREPLElements=new x;_name;_onDidChangeName=new x;_waitToResume;getId(){return this.id}setSubId(t){this._subId=t}getMemory(t){return new UB(t,this)}get subId(){return this._subId}get configuration(){return this._configuration.resolved}get unresolvedConfiguration(){return this._configuration.unresolved}get lifecycleManagedByParent(){return!!this._options.lifecycleManagedByParent}get compact(){return!!this._options.compact}get saveBeforeRestart(){return this._options.saveBeforeRestart??!this._options?.parentSession}get compoundRoot(){return this._options.compoundRoot}get suppressDebugStatusbar(){return this._options.suppressDebugStatusbar??!1}get suppressDebugToolbar(){return this._options.suppressDebugToolbar??!1}get suppressDebugView(){return this._options.suppressDebugView??!1}get autoExpandLazyVariables(){let t=this.accessibilityService.isScreenReaderOptimized(),e=this.configurationService.getValue("debug").autoExpandLazyVariables;return e==="auto"&&t||e==="on"}setConfiguration(t){this._configuration=t}getLabel(){return this.workspaceContextService.getWorkspace().folders.length>1&&this.root?`${this.name} (${Ns(this.root.uri)})`:this.name}setName(t){this._name=t,this._onDidChangeName.fire(t)}get name(){return this._name||this.configuration.name}get state(){if(!this.initialized)return 1;if(!this.raw)return 0;let t=this.debugService.getViewModel().focusedThread;return t&&t.session===this?t.stopped?2:3:this.getAllThreads().some(e=>e.stopped)?2:3}get capabilities(){return this.raw?this.raw.capabilities:Object.create(null)}get onDidChangeState(){return this._onDidChangeState.event}get onDidEndAdapter(){return this._onDidEndAdapter.event}get onDidChangeReplElements(){return this._onDidChangeREPLElements.event}get onDidChangeName(){return this._onDidChangeName.event}get onDidCustomEvent(){return this._onDidCustomEvent.event}get onDidLoadedSource(){return this._onDidLoadedSource.event}get onDidProgressStart(){return this._onDidProgressStart.event}get onDidProgressUpdate(){return this._onDidProgressUpdate.event}get onDidProgressEnd(){return this._onDidProgressEnd.event}get onDidInvalidateMemory(){return this._onDidInvalidMemory.event}async initialize(t){this.raw&&await this.shutdown();try{let e=await t.createDebugAdapter(this);this.raw=this.instantiationService.createInstance(mT,e,t,this.id,this.configuration.name),await this.raw.start(),this.registerListeners(),await this.raw.initialize({clientID:"vscode",clientName:this.productService.nameLong,adapterID:this.configuration.type,pathFormat:"path",linesStartAt1:!0,columnsStartAt1:!0,supportsVariableType:!0,supportsVariablePaging:!0,supportsRunInTerminalRequest:!0,locale:qa,supportsProgressReporting:!0,supportsInvalidatedEvent:!0,supportsMemoryReferences:!0,supportsArgsCanBeInterpretedByShell:!0,supportsMemoryEvent:!0,supportsStartDebuggingRequest:!0}),this.initialized=!0,this._onDidChangeState.fire(),this.debugService.setExceptionBreakpointsForSession(this,this.raw&&this.raw.capabilities.exceptionBreakpointFilters||[]),this.debugService.getModel().registerBreakpointModes(this.configuration.type,this.raw.capabilities.breakpointModes||[])}catch(e){throw this.initialized=!0,this._onDidChangeState.fire(),await this.shutdown(),e}}async launchOrAttach(t){if(!this.raw)throw new Error(u("noDebugAdapter","No debugger available, can not send '{0}'","launch or attach"));if(this.parentSession&&this.parentSession.state===0)throw ZZ();t.__sessionId=this.getId();try{await this.raw.launchOrAttach(t)}catch(e){throw this.shutdown(),e}}async terminate(t=!1){this.raw||this.onDidExitAdapter(),this.cancelAllRequests(),this._options.lifecycleManagedByParent&&this.parentSession?await this.parentSession.terminate(t):this.correlatedTestRun&&!this.correlatedTestRun.completedAt&&!this.didTerminateTestRun?(this.didTerminateTestRun=!0,this.testService.cancelTestRun(this.correlatedTestRun.id)):this.raw&&(this.raw.capabilities.supportsTerminateRequest&&this._configuration.resolved.request==="launch"?await this.raw.terminate(t):await this.raw.disconnect({restart:t,terminateDebuggee:!0})),t||this._options.compoundRoot?.sessionStopped()}async disconnect(t=!1,e=!1){this.raw||this.onDidExitAdapter(),this.cancelAllRequests(),this._options.lifecycleManagedByParent&&this.parentSession?await this.parentSession.disconnect(t,e):this.raw&&await this.raw.disconnect({restart:t,terminateDebuggee:!1,suspendDebuggee:e}),t||this._options.compoundRoot?.sessionStopped()}async restart(){if(!this.raw)throw new Error(u("noDebugAdapter","No debugger available, can not send '{0}'","restart"));this.cancelAllRequests(),this._options.lifecycleManagedByParent&&this.parentSession?await this.parentSession.restart():await this.raw.restart({arguments:this.configuration})}async sendBreakpoints(t,e,i){if(!this.raw)throw new Error(u("noDebugAdapter","No debugger available, can not send '{0}'","breakpoints"));if(!this.raw.readyForBreakpoints)return Promise.resolve(void 0);let n=this.getRawSource(t);e.length&&!n.adapterData&&(n.adapterData=e[0].adapterData),n.path&&(n.path=jp(n.path));let o=await this.raw.setBreakpoints({source:n,lines:e.map(s=>s.sessionAgnosticData.lineNumber),breakpoints:e.map(s=>s.toDAP()),sourceModified:i});if(o?.body){let s=new Map;for(let a=0;a<e.length;a++)s.set(e[a].getId(),o.body.breakpoints[a]);this.model.setBreakpointSessionData(this.getId(),this.capabilities,s)}}async sendFunctionBreakpoints(t){if(!this.raw)throw new Error(u("noDebugAdapter","No debugger available, can not send '{0}'","function breakpoints"));if(this.raw.readyForBreakpoints){let e=await this.raw.setFunctionBreakpoints({breakpoints:t.map(i=>i.toDAP())});if(e?.body){let i=new Map;for(let n=0;n<t.length;n++)i.set(t[n].getId(),e.body.breakpoints[n]);this.model.setBreakpointSessionData(this.getId(),this.capabilities,i)}}}async sendExceptionBreakpoints(t){if(!this.raw)throw new Error(u("noDebugAdapter","No debugger available, can not send '{0}'","exception breakpoints"));if(this.raw.readyForBreakpoints){let e=this.capabilities.supportsExceptionFilterOptions?{filters:[],filterOptions:t.map(n=>n.condition?{filterId:n.filter,condition:n.condition}:{filterId:n.filter})}:{filters:t.map(n=>n.filter)},i=await this.raw.setExceptionBreakpoints(e);if(i?.body&&i.body.breakpoints){let n=new Map;for(let o=0;o<t.length;o++)n.set(t[o].getId(),i.body.breakpoints[o]);this.model.setBreakpointSessionData(this.getId(),this.capabilities,n)}}}dataBytesBreakpointInfo(t,e){if(this.raw?.capabilities.supportsDataBreakpointBytes===!1)throw new Error(u("sessionDoesNotSupporBytesBreakpoints","Session does not support breakpoints with bytes"));return this._dataBreakpointInfo({name:t,bytes:e,asAddress:!0})}dataBreakpointInfo(t,e){return this._dataBreakpointInfo({name:t,variablesReference:e})}async _dataBreakpointInfo(t){if(!this.raw)throw new Error(u("noDebugAdapter","No debugger available, can not send '{0}'","data breakpoints info"));if(!this.raw.readyForBreakpoints)throw new Error(u("sessionNotReadyForBreakpoints","Session is not ready for breakpoints"));return(await this.raw.dataBreakpointInfo(t))?.body}async sendDataBreakpoints(t){if(!this.raw)throw new Error(u("noDebugAdapter","No debugger available, can not send '{0}'","data breakpoints"));if(this.raw.readyForBreakpoints){let e=await Promise.all(t.map(async n=>{try{return{dap:await n.toDAP(this),bp:n}}catch(o){return{bp:n,message:o.message}}})),i=await this.raw.setDataBreakpoints({breakpoints:e.map(n=>n.dap).filter(go)});if(i?.body){let n=new Map,o=0;for(let s of e)s.dap?o<i.body.breakpoints.length&&n.set(s.bp.getId(),i.body.breakpoints[o++]):n.set(s.bp.getId(),s.message);this.model.setBreakpointSessionData(this.getId(),this.capabilities,n)}}}async sendInstructionBreakpoints(t){if(!this.raw)throw new Error(u("noDebugAdapter","No debugger available, can not send '{0}'","instruction breakpoints"));if(this.raw.readyForBreakpoints){let e=await this.raw.setInstructionBreakpoints({breakpoints:t.map(i=>i.toDAP())});if(e?.body){let i=new Map;for(let n=0;n<t.length;n++)i.set(t[n].getId(),e.body.breakpoints[n]);this.model.setBreakpointSessionData(this.getId(),this.capabilities,i)}}}async breakpointsLocations(t,e){if(!this.raw)throw new Error(u("noDebugAdapter","No debugger available, can not send '{0}'","breakpoints locations"));let i=this.getRawSource(t),n=await this.raw.breakpointLocations({source:i,line:e});if(!n||!n.body||!n.body.breakpoints)return[];let o=n.body.breakpoints.map(s=>({lineNumber:s.line,column:s.column||1}));return Mo(o,s=>`${s.lineNumber}:${s.column}`)}getDebugProtocolBreakpoint(t){return this.model.getDebugProtocolBreakpoint(t,this.getId())}customRequest(t,e){if(!this.raw)throw new Error(u("noDebugAdapter","No debugger available, can not send '{0}'",t));return this.raw.custom(t,e)}stackTrace(t,e,i,n){if(!this.raw)throw new Error(u("noDebugAdapter","No debugger available, can not send '{0}'","stackTrace"));let o=this.getNewCancellationToken(t,n);return this.raw.stackTrace({threadId:t,startFrame:e,levels:i},o)}async exceptionInfo(t){if(!this.raw)throw new Error(u("noDebugAdapter","No debugger available, can not send '{0}'","exceptionInfo"));let e=await this.raw.exceptionInfo({threadId:t});if(e)return{id:e.body.exceptionId,description:e.body.description,breakMode:e.body.breakMode,details:e.body.details}}scopes(t,e){if(!this.raw)throw new Error(u("noDebugAdapter","No debugger available, can not send '{0}'","scopes"));let i=this.getNewCancellationToken(e);return this.raw.scopes({frameId:t},i)}variables(t,e,i,n,o){if(!this.raw)throw new Error(u("noDebugAdapter","No debugger available, can not send '{0}'","variables"));let s=e?this.getNewCancellationToken(e):void 0;return this.raw.variables({variablesReference:t,filter:i,start:n,count:o},s)}evaluate(t,e,i,n){if(!this.raw)throw new Error(u("noDebugAdapter","No debugger available, can not send '{0}'","evaluate"));return this.raw.evaluate({expression:t,frameId:e,context:i,line:n?.line,column:n?.column,source:n?.source})}async restartFrame(t,e){if(await this.waitForTriggeredBreakpoints(),!this.raw)throw new Error(u("noDebugAdapter","No debugger available, can not send '{0}'","restartFrame"));await this.raw.restartFrame({frameId:t},e)}setLastSteppingGranularity(t,e){let i=this.getThread(t);i&&(i.lastSteppingGranularity=e)}async next(t,e){if(await this.waitForTriggeredBreakpoints(),!this.raw)throw new Error(u("noDebugAdapter","No debugger available, can not send '{0}'","next"));this.setLastSteppingGranularity(t,e),await this.raw.next({threadId:t,granularity:e})}async stepIn(t,e,i){if(await this.waitForTriggeredBreakpoints(),!this.raw)throw new Error(u("noDebugAdapter","No debugger available, can not send '{0}'","stepIn"));this.setLastSteppingGranularity(t,i),await this.raw.stepIn({threadId:t,targetId:e,granularity:i})}async stepOut(t,e){if(await this.waitForTriggeredBreakpoints(),!this.raw)throw new Error(u("noDebugAdapter","No debugger available, can not send '{0}'","stepOut"));this.setLastSteppingGranularity(t,e),await this.raw.stepOut({threadId:t,granularity:e})}async stepBack(t,e){if(await this.waitForTriggeredBreakpoints(),!this.raw)throw new Error(u("noDebugAdapter","No debugger available, can not send '{0}'","stepBack"));this.setLastSteppingGranularity(t,e),await this.raw.stepBack({threadId:t,granularity:e})}async continue(t){if(await this.waitForTriggeredBreakpoints(),!this.raw)throw new Error(u("noDebugAdapter","No debugger available, can not send '{0}'","continue"));await this.raw.continue({threadId:t})}async reverseContinue(t){if(await this.waitForTriggeredBreakpoints(),!this.raw)throw new Error(u("noDebugAdapter","No debugger available, can not send '{0}'","reverse continue"));await this.raw.reverseContinue({threadId:t})}async pause(t){if(!this.raw)throw new Error(u("noDebugAdapter","No debugger available, can not send '{0}'","pause"));await this.raw.pause({threadId:t})}async terminateThreads(t){if(!this.raw)throw new Error(u("noDebugAdapter","No debugger available, can not send '{0}'","terminateThreads"));await this.raw.terminateThreads({threadIds:t})}setVariable(t,e,i){if(!this.raw)throw new Error(u("noDebugAdapter","No debugger available, can not send '{0}'","setVariable"));return this.raw.setVariable({variablesReference:t,name:e,value:i})}setExpression(t,e,i){if(!this.raw)throw new Error(u("noDebugAdapter","No debugger available, can not send '{0}'","setExpression"));return this.raw.setExpression({expression:e,value:i,frameId:t})}gotoTargets(t,e,i){if(!this.raw)throw new Error(u("noDebugAdapter","No debugger available, can not send '{0}'","gotoTargets"));return this.raw.gotoTargets({source:t,line:e,column:i})}goto(t,e){if(!this.raw)throw new Error(u("noDebugAdapter","No debugger available, can not send '{0}'","goto"));return this.raw.goto({threadId:t,targetId:e})}loadSource(t){if(!this.raw)return Promise.reject(new Error(u("noDebugAdapter","No debugger available, can not send '{0}'","loadSource")));let e=this.getSourceForUri(t),i;if(e)i=e.raw;else{let n=yh.getEncodedDebugData(t);i={path:n.path,sourceReference:n.sourceReference}}return this.raw.source({sourceReference:i.sourceReference||0,source:i})}async getLoadedSources(){if(!this.raw)return Promise.reject(new Error(u("noDebugAdapter","No debugger available, can not send '{0}'","getLoadedSources")));let t=await this.raw.loadedSources({});return t?.body&&t.body.sources?t.body.sources.map(e=>this.getSource(e)):[]}async completions(t,e,i,n,o,s){if(!this.raw)return Promise.reject(new Error(u("noDebugAdapter","No debugger available, can not send '{0}'","completions")));let a=this.getNewCancellationToken(e,s);return this.raw.completions({frameId:t,text:i,column:n.column,line:n.lineNumber},a)}async stepInTargets(t){return this.raw?(await this.raw.stepInTargets({frameId:t}))?.body.targets:Promise.reject(new Error(u("noDebugAdapter","No debugger available, can not send '{0}'","stepInTargets")))}async cancel(t){return this.raw?this.raw.cancel({progressId:t}):Promise.reject(new Error(u("noDebugAdapter","No debugger available, can not send '{0}'","cancel")))}async disassemble(t,e,i,n){return this.raw?(await this.raw.disassemble({memoryReference:t,offset:e,instructionOffset:i,instructionCount:n,resolveSymbols:!0}))?.body?.instructions:Promise.reject(new Error(u("noDebugAdapter","No debugger available, can not send '{0}'","disassemble")))}readMemory(t,e,i){return this.raw?this.raw.readMemory({count:i,memoryReference:t,offset:e}):Promise.reject(new Error(u("noDebugAdapter","No debugger available, can not send '{0}'","readMemory")))}writeMemory(t,e,i,n){return this.raw?this.raw.writeMemory({memoryReference:t,offset:e,allowPartial:n,data:i}):Promise.reject(new Error(u("noDebugAdapter","No debugger available, can not send '{0}'","disassemble")))}async resolveLocationReference(t){if(!this.raw)throw new Error(u("noDebugAdapter","No debugger available, can not send '{0}'","locations"));let e=await this.raw.locations({locationReference:t});if(!e?.body)throw new Error(u("noDebugAdapter","No debugger available, can not send '{0}'","locations"));let i=this.getSource(e.body.source);return{column:1,...e.body,source:i}}getThread(t){return this.threads.get(t)}getAllThreads(){let t=[];return this.threadIds.forEach(e=>{let i=this.threads.get(e);i&&t.push(i)}),t}clearThreads(t,e=void 0){if(e!=null){let i=this.threads.get(e);i&&(i.clearCallStack(),i.stoppedDetails=void 0,i.stopped=!1,t&&this.threads.delete(e))}else this.threads.forEach(i=>{i.clearCallStack(),i.stoppedDetails=void 0,i.stopped=!1}),t&&(this.threads.clear(),this.threadIds=[],Wd.allValues.clear())}getStoppedDetails(){return this.stoppedDetails.length>=1?this.stoppedDetails[0]:void 0}rawUpdate(t){this.threadIds=[],t.threads.forEach(i=>{if(this.threadIds.push(i.id),!this.threads.has(i.id))this.threads.set(i.id,new Hd(this,i.name,i.id));else if(i.name){let n=this.threads.get(i.id);n&&(n.name=i.name)}}),this.threads.forEach(i=>{this.threadIds.indexOf(i.threadId)===-1&&this.threads.delete(i.threadId)});let e=t.stoppedDetails;if(e)if(e.allThreadsStopped)this.threads.forEach(i=>{i.stoppedDetails=i.threadId===e.threadId?e:{reason:i.stoppedDetails?.reason},i.stopped=!0,i.clearCallStack()});else{let i=typeof e.threadId=="number"?this.threads.get(e.threadId):void 0;i&&(i.stoppedDetails=e,i.clearCallStack(),i.stopped=!0)}}waitForTriggeredBreakpoints(){if(this._waitToResume)return kA(this._waitToResume,$_e)}async fetchThreads(t){if(this.raw){let e=await this.raw.threads();e?.body&&e.body.threads&&this.model.rawUpdate({sessionId:this.getId(),threads:e.body.threads,stoppedDetails:t})}}initializeForTest(t){this.raw=t,this.registerListeners()}registerListeners(){if(!this.raw)return;this.rawListeners.add(this.raw.onDidInitialize(async()=>{La(this.configuration.noDebug?u("debuggingStartedNoDebug","Started running without debugging."):u("debuggingStarted","Debugging started."));let i=async()=>{if(this.raw&&this.raw.capabilities.supportsConfigurationDoneRequest)try{await this.raw.configurationDone()}catch(n){this.notificationService.error(n),this.raw?.disconnect({})}};try{await this.debugService.sendAllBreakpoints(this)}finally{await i(),await this.fetchThreads()}}));let t=this.statusQueue;this.rawListeners.add(this.raw.onDidStop(i=>this.handleStop(i.body))),this.rawListeners.add(this.raw.onDidThread(i=>{if(t.cancel([i.body.threadId]),i.body.reason==="started")this.fetchThreadsScheduler||(this.fetchThreadsScheduler=new Ye(()=>{this.fetchThreads()},100),this.rawListeners.add(this.fetchThreadsScheduler)),this.fetchThreadsScheduler.isScheduled()||this.fetchThreadsScheduler.schedule();else if(i.body.reason==="exited"){this.model.clearThreads(this.getId(),!0,i.body.threadId);let n=this.debugService.getViewModel(),o=n.focusedThread;this.passFocusScheduler.cancel(),o&&i.body.threadId===o.threadId&&this.debugService.focusStackFrame(void 0,void 0,n.focusedSession,{explicit:!1})}})),this.rawListeners.add(this.raw.onDidTerminateDebugee(async i=>{La(u("debuggingStopped","Debugging stopped.")),i.body&&i.body.restart?await this.debugService.restartSession(this,i.body.restart):this.raw&&await this.raw.disconnect({terminateDebuggee:!1})})),this.rawListeners.add(this.raw.onDidContinued(i=>{let n=i.body.allThreadsContinued!==!1;t.cancel(n?void 0:[i.body.threadId]);let o=n?void 0:i.body.threadId;if(typeof o=="number"){this.stoppedDetails=this.stoppedDetails.filter(a=>a.threadId!==o);let s=this.cancellationMap.get(o);this.cancellationMap.delete(o),s?.forEach(a=>a.dispose(!0))}else this.stoppedDetails=[],this.cancelAllRequests();this.lastContinuedThreadId=o,this.passFocusScheduler.schedule(),this.model.clearThreads(this.getId(),!1,o),this._onDidChangeState.fire()}));let e=new TA;this.rawListeners.add(this.raw.onDidOutput(async i=>{let n=i.body.category==="stderr"?Si.Error:i.body.category==="console"?Si.Warning:Si.Info;if(i.body.variablesReference){let o=i.body.source&&i.body.line?{lineNumber:i.body.line,column:i.body.column?i.body.column:1,source:this.getSource(i.body.source)}:void 0,a=new Wd(this,void 0,i.body.variablesReference,Ni()).getChildren();e.queue(async()=>{let l=await a;if(l.length===1){this.appendToRepl({output:i.body.output,expression:l[0],sev:n,source:o},i.body.category==="important");return}l.forEach(d=>{d.name=null,this.appendToRepl({output:"",expression:d,sev:n,source:o},i.body.category==="important")})});return}e.queue(async()=>{if(!i.body||!this.raw)return;if(i.body.category==="telemetry"){let s=this.raw.dbgr.getCustomTelemetryEndpoint();if(s&&this.telemetryService.telemetryLevel!==0){let a=i.body.data;!s.sendErrorTelemetry&&i.body.data&&(a=$de(i.body.data)),this.customEndpointTelemetryService.publicLog(s,i.body.output,a)}return}let o=i.body.source&&i.body.line?{lineNumber:i.body.line,column:i.body.column?i.body.column:1,source:this.getSource(i.body.source)}:void 0;if(i.body.group==="start"||i.body.group==="startCollapsed"){let s=i.body.group==="start";this.repl.startGroup(i.body.output||"",s,o);return}i.body.group==="end"&&(this.repl.endGroup(),!i.body.output)||typeof i.body.output=="string"&&this.appendToRepl({output:i.body.output,sev:n,source:o},i.body.category==="important")})})),this.rawListeners.add(this.raw.onDidBreakpoint(i=>{let n=i.body&&i.body.breakpoint?i.body.breakpoint.id:void 0,o=this.model.getBreakpoints().find(d=>d.getIdFromAdapter(this.getId())===n),s=this.model.getFunctionBreakpoints().find(d=>d.getIdFromAdapter(this.getId())===n),a=this.model.getDataBreakpoints().find(d=>d.getIdFromAdapter(this.getId())===n),l=this.model.getExceptionBreakpoints().find(d=>d.getIdFromAdapter(this.getId())===n);if(i.body.reason==="new"&&i.body.breakpoint.source&&i.body.breakpoint.line){let d=this.getSource(i.body.breakpoint.source),c=this.model.addBreakpoints(d.uri,[{column:i.body.breakpoint.column,enabled:!0,lineNumber:i.body.breakpoint.line}],!1);if(c.length===1){let p=new Map([[c[0].getId(),i.body.breakpoint]]);this.model.setBreakpointSessionData(this.getId(),this.capabilities,p)}}if(i.body.reason==="removed"&&(o&&this.model.removeBreakpoints([o]),s&&this.model.removeFunctionBreakpoints(s.getId()),a&&this.model.removeDataBreakpoints(a.getId())),i.body.reason==="changed"){if(o){o.column||(i.body.breakpoint.column=void 0);let d=new Map([[o.getId(),i.body.breakpoint]]);this.model.setBreakpointSessionData(this.getId(),this.capabilities,d)}if(s){let d=new Map([[s.getId(),i.body.breakpoint]]);this.model.setBreakpointSessionData(this.getId(),this.capabilities,d)}if(a){let d=new Map([[a.getId(),i.body.breakpoint]]);this.model.setBreakpointSessionData(this.getId(),this.capabilities,d)}if(l){let d=new Map([[l.getId(),i.body.breakpoint]]);this.model.setBreakpointSessionData(this.getId(),this.capabilities,d)}}})),this.rawListeners.add(this.raw.onDidLoadedSource(i=>{this._onDidLoadedSource.fire({reason:i.body.reason,source:this.getSource(i.body.source)})})),this.rawListeners.add(this.raw.onDidCustomEvent(i=>{this._onDidCustomEvent.fire(i)})),this.rawListeners.add(this.raw.onDidProgressStart(i=>{this._onDidProgressStart.fire(i)})),this.rawListeners.add(this.raw.onDidProgressUpdate(i=>{this._onDidProgressUpdate.fire(i)})),this.rawListeners.add(this.raw.onDidProgressEnd(i=>{this._onDidProgressEnd.fire(i)})),this.rawListeners.add(this.raw.onDidInvalidateMemory(i=>{this._onDidInvalidMemory.fire(i)})),this.rawListeners.add(this.raw.onDidInvalidated(async i=>{let n=i.body.areas||["all"];if(n.includes("threads")||n.includes("stacks")||n.includes("all")){this.cancelAllRequests(),this.model.clearThreads(this.getId(),!0);let s=this.stoppedDetails;this.stoppedDetails.length=1,await Promise.all(s.map(a=>this.handleStop(a)))}let o=this.debugService.getViewModel();o.focusedSession===this&&o.updateViews()})),this.rawListeners.add(this.raw.onDidExitAdapter(i=>this.onDidExitAdapter(i)))}async handleStop(t){this.passFocusScheduler.cancel(),this.stoppedDetails.push(t),t.hitBreakpointIds&&(this._waitToResume=this.enableDependentBreakpoints(t.hitBreakpointIds)),this.statusQueue.run(this.fetchThreads(t).then(()=>t.threadId===void 0?this.threadIds:[t.threadId]),async(e,i)=>{let n=t.threadId===void 0&&this.threadIds.length>10,o=this.debugService.getViewModel().focusedThread,s=o!==void 0&&o.session===this&&!this.threads.has(o.threadId);s&&this.debugService.focusStackFrame(void 0,void 0);let a=typeof e=="number"?this.getThread(e):void 0;if(a){let l=this.model.refreshTopOfCallstack(a,!n),d=async()=>{if(s||!t.preserveFocusHint&&a.getCallStack().length){let p=this.debugService.getViewModel().focusedStackFrame;if(!p||p.thread.session===this){let h=!this.configurationService.getValue("debug").focusEditorOnBreak;await this.debugService.focusStackFrame(void 0,a,void 0,{preserveFocus:h})}a.stoppedDetails&&!i.isCancellationRequested&&(a.stoppedDetails.reason==="breakpoint"&&this.configurationService.getValue("debug").openDebug==="openOnDebugBreak"&&!this.suppressDebugView&&await this.paneCompositeService.openPaneComposite(nr,0),this.configurationService.getValue("debug").focusWindowOnBreak&&!this.workbenchEnvironmentService.extensionTestsLocationURI&&(Gr().document.hasFocus()||await this.hostService.focus(Ke,{force:!0})))}};if(await l.topCallStack,t.hitBreakpointIds||(this._waitToResume=this.enableDependentBreakpoints(a)),i.isCancellationRequested||(d(),await l.wholeCallStack,i.isCancellationRequested))return;let c=this.debugService.getViewModel().focusedStackFrame;(!c||Sh(c))&&d()}this._onDidChangeState.fire()})}async enableDependentBreakpoints(t){let e;if(Array.isArray(t))e=this.model.getBreakpoints().filter(o=>t.includes(o.getIdFromAdapter(this.id)));else{let o=t.getTopStackFrame();if(o===void 0||t.stoppedDetails&&t.stoppedDetails.reason!=="breakpoint")return;e=this.getBreakpointsAtPosition(o.source.uri,o.range.startLineNumber,o.range.endLineNumber,o.range.startColumn,o.range.endColumn)}let i=new Set;this.model.getBreakpoints({triggeredOnly:!0,enabledOnly:!0}).forEach(o=>{e.forEach(s=>{o.enabled&&o.triggeredBy===s.getId()&&(o.setSessionDidTrigger(this.getId()),i.add(o.uri.toString()))})});let n=[];return i.forEach(o=>n.push(this.debugService.sendBreakpoints(Z.parse(o),void 0,this))),Promise.all(n)}getBreakpointsAtPosition(t,e,i,n,o){return this.model.getBreakpoints({uri:t}).filter(s=>!(s.lineNumber<e||s.lineNumber>i||s.column&&(s.column<n||s.column>o)))}onDidExitAdapter(t){this.initialized=!0,this.model.setBreakpointSessionData(this.getId(),this.capabilities,void 0),this.shutdown(),this._onDidEndAdapter.fire(t)}shutdown(){this.rawListeners.clear(),this.raw&&(this.raw.disconnect({}),this.raw.dispose(),this.raw=void 0),this.fetchThreadsScheduler?.dispose(),this.fetchThreadsScheduler=void 0,this.passFocusScheduler.cancel(),this.passFocusScheduler.dispose(),this.model.clearThreads(this.getId(),!0),this._onDidChangeState.fire()}dispose(){this.cancelAllRequests(),this.rawListeners.dispose(),this.globalDisposables.dispose()}getSourceForUri(t){return this.sources.get(this.uriIdentityService.asCanonicalUri(t).toString())}getSource(t){let e=new yh(t,this.getId(),this.uriIdentityService,this.logService),i=e.uri.toString(),n=this.sources.get(i);return n?(e=n,e.raw=Bs(e.raw,t),e.raw&&t&&(e.raw.presentationHint=t.presentationHint)):this.sources.set(i,e),e}getRawSource(t){let e=this.getSourceForUri(t);if(e)return e.raw;{let i=yh.getEncodedDebugData(t);return{name:i.name,path:i.path,sourceReference:i.sourceReference}}}getNewCancellationToken(t,e){let i=new Kt(e),n=this.cancellationMap.get(t)||[];return n.push(i),this.cancellationMap.set(t,n),i.token}cancelAllRequests(){this.cancellationMap.forEach(t=>t.forEach(e=>e.dispose(!0))),this.cancellationMap.clear()}getReplElements(){return this.repl.getReplElements()}hasSeparateRepl(){return!this.parentSession||this._options.repl!=="mergeWithParent"}removeReplExpressions(){this.repl.removeReplExpressions()}async addReplExpression(t,e){await this.repl.addReplExpression(this,t,e),this.debugService.getViewModel().updateViews()}appendToRepl(t,e){this.repl.appendToRepl(this,t),e&&this.notificationService.notify({message:t.output.toString(),severity:t.sev,source:this.name})}};gT=E([b(5,we),b(6,Tt),b(7,Tn),b(8,se),b(9,ed),b(10,kt),b(11,al),b(12,mi),b(13,er),b(14,zn),b(15,ne),b(16,Yoe),b(17,Jo),b(18,bt),b(19,K2),b(20,Whe),b(21,Un)],gT);var UY=class extends R{pendingCancellations=[];threadOps=this._register(new us);async run(t,e){let i=new Set;this.pendingCancellations.push(i);let n=await t;for(let o=0;o<this.pendingCancellations.length;o++){let s=this.pendingCancellations[o];if(s===i){this.pendingCancellations.splice(o,1);break}else for(let a of n)s.add(a)}i.has(void 0)||await Promise.all(n.map(o=>{if(i.has(o))return;this.threadOps.get(o)?.cancel();let s=new Kt;return this.threadOps.set(o,s),e(o,s.token)}))}cancel(t){if(t)for(let e of t){this.threadOps.get(e)?.cancel(),this.threadOps.deleteAndDispose(e);for(let i of this.pendingCancellations)i.add(e)}else{for(let[e,i]of this.threadOps)i.cancel();this.threadOps.clearAndDisposeAll();for(let e of this.pendingCancellations)e.add(void 0)}}};var X2;(v=>(v.MARKERS_CONTAINER_ID="workbench.panel.markers",v.MARKERS_VIEW_ID="workbench.panel.markers.view",v.MARKERS_VIEW_STORAGE_ID="workbench.panel.markers",v.MARKER_COPY_ACTION_ID="problems.action.copy",v.MARKER_COPY_MESSAGE_ACTION_ID="problems.action.copyMessage",v.RELATED_INFORMATION_COPY_MESSAGE_ACTION_ID="problems.action.copyRelatedInformationMessage",v.FOCUS_PROBLEMS_FROM_FILTER="problems.action.focusProblemsFromFilter",v.MARKERS_VIEW_FOCUS_FILTER="problems.action.focusFilter",v.MARKERS_VIEW_CLEAR_FILTER_TEXT="problems.action.clearFilterText",v.MARKERS_VIEW_SHOW_MULTILINE_MESSAGE="problems.action.showMultilineMessage",v.MARKERS_VIEW_SHOW_SINGLELINE_MESSAGE="problems.action.showSinglelineMessage",v.MARKER_OPEN_ACTION_ID="problems.action.open",v.MARKER_OPEN_SIDE_ACTION_ID="problems.action.openToSide",v.MARKER_SHOW_PANEL_ID="workbench.action.showErrorsWarnings",v.MARKER_SHOW_QUICK_FIX="problems.action.showQuickFixes",v.TOGGLE_MARKERS_VIEW_ACTION_ID="workbench.actions.view.toggleProblems"))(X2||={});var j_e;(c=>(c.MarkersViewModeContextKey=new A("problemsViewMode","tree"),c.MarkersTreeVisibilityContextKey=new A("problemsVisibility",!1),c.MarkerFocusContextKey=new A("problemFocus",!1),c.MarkerViewFilterFocusContextKey=new A("problemsFilterFocus",!1),c.RelatedInformationFocusContextKey=new A("relatedInformationFocus",!1),c.ShowErrorsFilterContextKey=new A("problems.filter.errors",!0),c.ShowWarningsFilterContextKey=new A("problems.filter.warnings",!0),c.ShowInfoFilterContextKey=new A("problems.filter.info",!0),c.ShowActiveFileFilterContextKey=new A("problems.filter.activeFile",!1),c.ShowExcludedFilesFilterContextKey=new A("problems.filter.excludedFiles",!0)))(j_e||={});var zY=(r,t)=>X.once(X.filter(r,t));var Hhe="debug.taskerrorchoice",Uhe=u("abort","Abort"),X_e=u({key:"debugAnyway",comment:["&& denotes a mnemonic"]},"&&Debug Anyway"),Y_e=u("debugAnywayNoMemo","Debug Anyway"),fT=class{constructor(t,e,i,n,o,s,a,l){this.taskService=t;this.markerService=e;this.configurationService=i;this.viewsService=n;this.dialogService=o;this.storageService=s;this.commandService=a;this.progressService=l}globalCancellation=new Kt;cancel(){this.globalCancellation.dispose(!0),this.globalCancellation=new Kt}dispose(){this.globalCancellation.dispose(!0)}async runTaskAndCheckErrors(t,e){try{let i=await this.runTask(t,e,this.globalCancellation.token);if(i&&(i.exitCode===void 0||i.cancelled))return 0;let n=e?this.markerService.read({severities:8,take:2}).length:0,o=i&&i.exitCode===0,s=i&&i.exitCode!==0,a=this.configurationService.getValue("debug").onTaskErrors;if(o||a==="debugAnyway"||n===0&&!s)return 1;if(a==="showErrors")return await this.viewsService.openView(X2.MARKERS_VIEW_ID,!0),Promise.resolve(0);if(a==="abort")return Promise.resolve(0);let l=typeof e=="string"?e:e?e.name:"",d=n>1?u("preLaunchTaskErrors","Errors exist after running preLaunchTask '{0}'.",l):n===1?u("preLaunchTaskError","Error exists after running preLaunchTask '{0}'.",l):i&&typeof i.exitCode=="number"?u("preLaunchTaskExitCode","The preLaunchTask '{0}' terminated with exit code {1}.",l,i.exitCode):u("preLaunchTaskTerminated","The preLaunchTask '{0}' terminated.",l),c;(y=>(y[y.DebugAnyway=1]="DebugAnyway",y[y.ShowErrors=2]="ShowErrors",y[y.Cancel=0]="Cancel"))(c||={});let{result:p,checkboxChecked:h}=await this.dialogService.prompt({type:Si.Warning,message:d,buttons:[{label:X_e,run:()=>1},{label:u({key:"showErrors",comment:["&& denotes a mnemonic"]},"&&Show Errors"),run:()=>2}],cancelButton:{label:Uhe,run:()=>0},checkbox:{label:u("remember","Remember my choice in user settings")}}),m=p===1,f=p===0;return h&&this.configurationService.updateValue("debug.onTaskErrors",p===1?"debugAnyway":f?"abort":"showErrors"),f?Promise.resolve(0):m?1:(await this.viewsService.openView(X2.MARKERS_VIEW_ID,!0),Promise.resolve(0))}catch(i){let n=this.taskService.configureAction(),o=JSON.parse(this.storageService.get(Hhe,1,"{}")),s=-1,a;if((p=>(p[p.DebugAnyway=0]="DebugAnyway",p[p.ConfigureTask=1]="ConfigureTask",p[p.Cancel=2]="Cancel"))(a||={}),o[i.message]!==void 0)s=o[i.message];else{let{result:l,checkboxChecked:d}=await this.dialogService.prompt({type:Si.Error,message:i.message,buttons:[{label:u({key:"debugAnyway",comment:["&& denotes a mnemonic"]},"&&Debug Anyway"),run:()=>0},{label:n.label,run:()=>1}],cancelButton:{run:()=>2},checkbox:{label:u("rememberTask","Remember my choice for this task")}});s=l,d&&(o[i.message]=s,this.storageService.store(Hhe,JSON.stringify(o),1,1))}return s===1&&await n.run(),s===0?1:0}}async runTask(t,e,i=this.globalCancellation.token){if(!e)return Promise.resolve(null);if(!t)return Promise.reject(new Error(u("invalidTaskReference","Task '{0}' can not be referenced from a launch configuration that is in a different workspace folder.",typeof e=="string"?e:e.type)));let n=await this.taskService.getTask(t,e);if(!n){let m=typeof e=="string"?u("DebugTaskNotFoundWithTaskId","Could not find the task '{0}'.",e):u("DebugTaskNotFound","Could not find the specified task.");return Promise.reject(WC(m,[new et(Bh,Dx,void 0,!0,()=>this.commandService.executeCommand(Bh))]))}let o=!1,s=new B,a=m=>m.getKey()??m.getMapKey(),l=a(n),d=new Promise(m=>s.add(zY(this.taskService.onDidStateChange,f=>(f.kind==="inactive"||f.kind==="processEnded"&&f.exitCode===void 0)&&a(f.__task)===l)(f=>{o=!0,m(f.kind==="processEnded"?{exitCode:f.exitCode}:null)})));s.add(zY(this.taskService.onDidStateChange,m=>(m.kind==="active"||m.kind==="dependsOnStarted")&&a(m.__task)===l)(()=>{o=!0}));let c=s.add(new x);s.add(zY(this.taskService.onDidStateChange,m=>m.kind==="acquiredInput"&&a(m.__task)===l)(()=>c.fire()));let p=this.taskService.getActiveTasks().then(async m=>{if(m.find(g=>a(g)===l))return c.fire(),(await this.taskService.getBusyTasks()).find(v=>a(v)===l)?(o=!0,d):Promise.resolve(null);let f=this.taskService.run(n);return n.configurationProperties.isBackground?d:f.then(g=>g??null)}),h=new Promise((m,f)=>{p.then(g=>{o=!0,m(g)},g=>f(g)),s.add(i.onCancellationRequested(()=>{m({exitCode:void 0,cancelled:!0}),this.taskService.terminate(n).catch(()=>{})})),s.add(c.event(()=>{let g=n.configurationProperties.isBackground?5e3:1e4;s.add(Sd(()=>{if(!o){let v=u("taskNotTracked","The task '{0}' has not exited and doesn't have a 'problemMatcher' defined. Make sure to define a problem matcher for watch tasks.",typeof e=="string"?e:JSON.stringify(e));f({severity:Si.Error,message:v})}},g)),s.add(Sd(()=>{let v=u("runningTask","Waiting for preLaunchTask '{0}'...",n.configurationProperties.name),I=[Y_e,Uhe],y=n instanceof QB||n instanceof ZB;y&&I.splice(1,0,u("configureTask","Configure Task")),this.progressService.withProgress({location:15,title:v,buttons:I},()=>h.catch(()=>{}),w=>{w===void 0||(w===0?m({exitCode:0}):(m({exitCode:void 0,cancelled:!0}),this.taskService.terminate(n).catch(()=>{}),y&&w===1&&this.taskService.openConfig(n)))})},1e4))}))});return h.finally(()=>s.dispose())}};fT=E([b(0,W2),b(1,WO),b(2,se),b(3,Mi),b(4,Io),b(5,nt),b(6,ct),b(7,Cu)],fT);var bT=class{constructor(t,e){this.model=t;this.telemetryService=e}logDebugSessionStart(t,e){let i=t.getMainExtensionDescriptor();this.telemetryService.publicLog("debugSessionStart",{type:t.type,breakpointCount:this.model.getBreakpoints().length,exceptionBreakpoints:this.model.getExceptionBreakpoints(),watchExpressionsCount:this.model.getWatchExpressions().length,extensionName:i.identifier.value,isBuiltin:i.isBuiltin,launchJsonExists:e})}logDebugSessionStop(t,e){let i=this.model.getBreakpoints();this.telemetryService.publicLog("debugSessionStop",{type:t&&t.configuration.type,success:e.emittedStopped||i.length===0,sessionLengthInSeconds:e.sessionLengthInSeconds,breakpointCount:i.length,watchExpressionsCount:this.model.getWatchExpressions().length})}};bT=E([b(1,Tt)],bT);var Y2=class{constructor(t){this.contextKeyService=t;t.bufferChangeEvents(()=>{this.expressionSelectedContextKey=lV.bindTo(t),this.loadedScriptsSupportedContextKey=pV.bindTo(t),this.stepBackSupportedContextKey=YL.bindTo(t),this.focusedSessionIsAttach=qs.bindTo(t),this.focusedSessionIsNoDebug=Th.bindTo(t),this.restartFrameSupportedContextKey=hV.bindTo(t),this.stepIntoTargetsSupported=Cb.bindTo(t),this.jumpToCursorSupported=gy.bindTo(t),this.setVariableSupported=QL.bindTo(t),this.setDataBreakpointAtByteSupported=IE.bindTo(t),this.setExpressionSupported=ZL.bindTo(t),this.multiSessionDebug=bV.bindTo(t),this.terminateDebuggeeSupported=Kd.bindTo(t),this.suspendDebuggeeSupported=wb.bindTo(t),this.disassembleRequestSupported=SE.bindTo(t),this.focusedStackFrameHasInstructionPointerReference=IV.bindTo(t)})}firstSessionStart=!0;_focusedStackFrame;_focusedSession;_focusedThread;selectedExpression;_onDidFocusSession=new x;_onDidFocusThread=new x;_onDidFocusStackFrame=new x;_onDidSelectExpression=new x;_onDidEvaluateLazyExpression=new x;_onWillUpdateViews=new x;_onDidChangeVisualization=new x;visualized=new WeakMap;preferredVisualizers=new Map;expressionSelectedContextKey;loadedScriptsSupportedContextKey;stepBackSupportedContextKey;focusedSessionIsAttach;focusedSessionIsNoDebug;restartFrameSupportedContextKey;stepIntoTargetsSupported;jumpToCursorSupported;setVariableSupported;setDataBreakpointAtByteSupported;setExpressionSupported;multiSessionDebug;terminateDebuggeeSupported;suspendDebuggeeSupported;disassembleRequestSupported;focusedStackFrameHasInstructionPointerReference;getId(){return"root"}get focusedSession(){return this._focusedSession}get focusedThread(){return this._focusedThread}get focusedStackFrame(){return this._focusedStackFrame}setFocus(t,e,i,n){let o=this._focusedStackFrame!==t,s=this._focusedSession!==i,a=this._focusedThread!==e;this._focusedStackFrame=t,this._focusedThread=e,this._focusedSession=i,this.contextKeyService.bufferChangeEvents(()=>{this.loadedScriptsSupportedContextKey.set(!!i?.capabilities.supportsLoadedSourcesRequest),this.stepBackSupportedContextKey.set(!!i?.capabilities.supportsStepBack),this.restartFrameSupportedContextKey.set(!!i?.capabilities.supportsRestartFrame),this.stepIntoTargetsSupported.set(!!i?.capabilities.supportsStepInTargetsRequest),this.jumpToCursorSupported.set(!!i?.capabilities.supportsGotoTargetsRequest),this.setVariableSupported.set(!!i?.capabilities.supportsSetVariable),this.setDataBreakpointAtByteSupported.set(!!i?.capabilities.supportsDataBreakpointBytes),this.setExpressionSupported.set(!!i?.capabilities.supportsSetExpression),this.terminateDebuggeeSupported.set(!!i?.capabilities.supportTerminateDebuggee),this.suspendDebuggeeSupported.set(!!i?.capabilities.supportSuspendDebuggee),this.disassembleRequestSupported.set(!!i?.capabilities.supportsDisassembleRequest),this.focusedStackFrameHasInstructionPointerReference.set(!!t?.instructionPointerReference);let l=!!i&&FL(i);this.focusedSessionIsAttach.set(l),this.focusedSessionIsNoDebug.set(!!i&&!!i.configuration.noDebug)}),s&&this._onDidFocusSession.fire(i),o?this._onDidFocusStackFrame.fire({stackFrame:t,explicit:n,session:i}):a&&this._onDidFocusThread.fire({thread:e,explicit:n,session:i})}get onDidFocusSession(){return this._onDidFocusSession.event}get onDidFocusThread(){return this._onDidFocusThread.event}get onDidFocusStackFrame(){return this._onDidFocusStackFrame.event}get onDidChangeVisualization(){return this._onDidChangeVisualization.event}getSelectedExpression(){return this.selectedExpression}setSelectedExpression(t,e){this.selectedExpression=t?{expression:t,settingWatch:e}:void 0,this.expressionSelectedContextKey.set(!!t),this._onDidSelectExpression.fire(this.selectedExpression)}get onDidSelectExpression(){return this._onDidSelectExpression.event}get onDidEvaluateLazyExpression(){return this._onDidEvaluateLazyExpression.event}updateViews(){this._onWillUpdateViews.fire()}get onWillUpdateViews(){return this._onWillUpdateViews.event}isMultiSessionView(){return!!this.multiSessionDebug.get()}setMultiSessionView(t){this.multiSessionDebug.set(t)}setVisualizedExpression(t,e){let i=this.visualized.get(t)||t,n=this.getPreferredVisualizedKey(t);e?(this.visualized.set(t,e),this.preferredVisualizers.set(n,e.treeId)):(this.visualized.delete(t),this.preferredVisualizers.delete(n)),this._onDidChangeVisualization.fire({original:i,replacement:e||t})}getVisualizedExpression(t){return this.visualized.get(t)||this.preferredVisualizers.get(this.getPreferredVisualizedKey(t))}async evaluateLazyExpression(t){await t.evaluateLazy(),this._onDidEvaluateLazyExpression.fire(t)}getPreferredVisualizedKey(t){return JSON.stringify([t.name,t.type,!!t.memoryReference].join("\0"))}};var mv=q("activityService"),Q2=class{constructor(t){this.descriptorFn=t;this.descriptorFn=t}getDescription(){return this.descriptorFn(null)}},ep=class extends Q2{constructor(e,i){super(i);this.number=e;this.number=e}getDescription(){return this.descriptorFn(this.number)}};var Z2=class extends Q2{};var vT=class{constructor(t,e,i,n,o,s,a,l,d,c,p,h,m,f,g,v,I,y,w,C,S){this.editorService=t;this.paneCompositeService=e;this.viewsService=i;this.viewDescriptorService=n;this.notificationService=o;this.dialogService=s;this.layoutService=a;this.contextService=l;this.contextKeyService=d;this.lifecycleService=c;this.instantiationService=p;this.extensionService=h;this.fileService=m;this.configurationService=f;this.extensionHostDebugService=g;this.activityService=v;this.commandService=I;this.quickInputService=y;this.workspaceTrustRequestService=w;this.uriIdentityService=C;this.testService=S;this.breakpointsToSendOnResourceSaved=new Set,this._onDidChangeState=new x,this._onDidNewSession=new x,this._onWillNewSession=new x,this._onDidEndSession=new x,this.adapterManager=this.instantiationService.createInstance(cT,{onDidNewSession:this.onDidNewSession}),this.disposables.add(this.adapterManager),this.configurationManager=this.instantiationService.createInstance(uT,this.adapterManager),this.disposables.add(this.configurationManager),this.debugStorage=this.disposables.add(this.instantiationService.createInstance(uE)),this.chosenEnvironments=this.debugStorage.loadChosenEnvironments(),this.model=this.instantiationService.createInstance(gE,this.debugStorage),this.telemetry=this.instantiationService.createInstance(bT,this.model),this.viewModel=new Y2(d),this.taskRunner=this.instantiationService.createInstance(fT),this.disposables.add(this.fileService.onDidFilesChange(D=>this.onFileChanges(D))),this.disposables.add(this.lifecycleService.onWillShutdown(this.dispose,this)),this.disposables.add(this.extensionHostDebugService.onAttachSession(D=>{let k=this.model.getSession(D.sessionId,!0);k&&(k.configuration.request="attach",k.configuration.port=D.port,k.setSubId(D.subId),this.launchOrAttachToSession(k))})),this.disposables.add(this.extensionHostDebugService.onTerminateSession(D=>{let k=this.model.getSession(D.sessionId);k&&k.subId===D.subId&&k.disconnect()})),this.disposables.add(this.viewModel.onDidFocusStackFrame(()=>{this.onStateChange()})),this.disposables.add(this.viewModel.onDidFocusSession(D=>{this.onStateChange(),D&&this.setExceptionBreakpointFallbackSession(D.getId())})),this.disposables.add(X.any(this.adapterManager.onDidRegisterDebugger,this.configurationManager.onDidSelectConfiguration)(()=>{let D=this.state!==0||this.configurationManager.getAllConfigurations().length>0&&this.adapterManager.hasEnabledDebuggers()?"default":"simple";this.debugUx.set(D),this.debugStorage.storeDebugUxState(D)})),this.disposables.add(this.model.onDidChangeCallStack(()=>{let D=this.model.getSessions().filter(k=>!k.parentSession).length;if(this.activity?.dispose(),D>0){let k=this.viewDescriptorService.getViewContainerByViewId(ag);k&&(this.activity=this.activityService.showViewContainerActivity(k.id,{badge:new ep(D,M=>M===1?u("1activeSession","1 active session"):u("nActiveSessions","{0} active sessions",M))}))}})),this.disposables.add(t.onDidActiveEditorChange(()=>{this.contextKeyService.bufferChangeEvents(()=>{t.activeEditor===Yl.instance?this.disassemblyViewFocus.set(!0):this.disassemblyViewFocus?.reset()})})),this.disposables.add(this.lifecycleService.onBeforeShutdown(()=>{for(let D of t.editors)D.resource?.scheme===py&&D.dispose()})),this.disposables.add(h.onWillStop(D=>{D.veto(this.model.getSessions().length>0,u("active debug session","A debug session is still running."))})),this.initContextKeys(d)}_onDidChangeState;_onDidNewSession;_onWillNewSession;_onDidEndSession;restartingSessions=new Set;debugStorage;model;viewModel;telemetry;taskRunner;configurationManager;adapterManager;disposables=new B;debugType;debugState;inDebugMode;debugUx;hasDebugged;breakpointsExist;disassemblyViewFocus;breakpointsToSendOnResourceSaved;initializing=!1;_initializingOptions;previousState;sessionCancellationTokens=new Map;activity;chosenEnvironments;haveDoneLazySetup=!1;initContextKeys(t){queueMicrotask(()=>{t.bufferChangeEvents(()=>{this.debugType=VB.bindTo(t),this.debugState=Gt.bindTo(t),this.hasDebugged=rV.bindTo(t),this.inDebugMode=ui.bindTo(t),this.debugUx=zd.bindTo(t),this.debugUx.set(this.debugStorage.loadDebugUxState()),this.breakpointsExist=lg.bindTo(t),this.disassemblyViewFocus=_h.bindTo(t)});let e=()=>this.breakpointsExist.set(!!(this.model.getBreakpoints().length||this.model.getDataBreakpoints().length||this.model.getFunctionBreakpoints().length));e(),this.disposables.add(this.model.onDidChangeBreakpoints(()=>e()))})}getModel(){return this.model}getViewModel(){return this.viewModel}getConfigurationManager(){return this.configurationManager}getAdapterManager(){return this.adapterManager}sourceIsNotAvailable(t){this.model.sourceIsNotAvailable(t)}dispose(){this.disposables.dispose()}get state(){let t=this.viewModel.focusedSession;return t?t.state:this.initializing?1:0}get initializingOptions(){return this._initializingOptions}startInitializingState(t){this.initializing||(this.initializing=!0,this._initializingOptions=t,this.onStateChange())}endInitializingState(){this.initializing&&(this.initializing=!1,this._initializingOptions=void 0,this.onStateChange())}cancelTokens(t){if(t){let e=this.sessionCancellationTokens.get(t);e&&(e.cancel(),this.sessionCancellationTokens.delete(t))}else this.sessionCancellationTokens.forEach(e=>e.cancel()),this.sessionCancellationTokens.clear()}onStateChange(){let t=this.state;this.previousState!==t&&(this.contextKeyService.bufferChangeEvents(()=>{this.debugState.set(Ql(t)),this.inDebugMode.set(t!==0);let e=t!==0&&t!==1||this.adapterManager.hasEnabledDebuggers()&&this.configurationManager.selectedConfiguration.name?"default":"simple";this.debugUx.set(e),this.debugStorage.storeDebugUxState(e)}),this.previousState=t,this._onDidChangeState.fire(t))}get onDidChangeState(){return this._onDidChangeState.event}get onDidNewSession(){return this._onDidNewSession.event}get onWillNewSession(){return this._onWillNewSession.event}get onDidEndSession(){return this._onDidEndSession.event}lazySetup(){this.haveDoneLazySetup||(this.disposables.add(this.fileService.registerProvider(py,new H2(this))),this.haveDoneLazySetup=!0)}async startDebugging(t,e,i,n=!i?.parentSession){let o=i&&i.noDebug?u("runTrust","Running executes build tasks and program code from your workspace."):u("debugTrust","Debugging executes build tasks and program code from your workspace.");if(!await this.workspaceTrustRequestService.requestWorkspaceTrust({message:o}))return!1;this.lazySetup(),this.startInitializingState(i),this.hasDebugged.set(!0);try{await this.extensionService.activateByEvent("onDebug"),n&&await VL(this.configurationService,this.editorService),await this.extensionService.whenInstalledExtensionsRegistered();let a,l;if(e||(e=this.configurationManager.selectedConfiguration.name),typeof e=="string"&&t?(a=t.getConfiguration(e),l=t.getCompound(e)):typeof e!="string"&&(a=e),l){if(!l.configurations)throw new Error(u({key:"compoundMustHaveConfigurations",comment:['compound indicates a "compounds" configuration item','"configurations" is an attribute and should not be localized']},'Compound must have "configurations" attribute set in order to start multiple configurations.'));if(l.preLaunchTask&&await this.taskRunner.runTaskAndCheckErrors(t?.workspace||this.contextService.getWorkspace(),l.preLaunchTask)===0)return this.endInitializingState(),!1;l.stopAll&&(i={...i,compoundRoot:new LB});let p=(await Promise.all(l.configurations.map(h=>{let m=typeof h=="string"?h:h.name;if(m===l.name)return Promise.resolve(!1);let f;if(typeof h=="string"){let g=this.configurationManager.getLaunches().filter(v=>!!v.getConfiguration(m));if(g.length===1)f=g[0];else if(t&&g.length>1&&g.indexOf(t)>=0)f=t;else throw new Error(g.length===0?u("noConfigurationNameInWorkspace","Could not find launch configuration '{0}' in the workspace.",m):u("multipleConfigurationNamesInWorkspace","There are multiple launch configurations '{0}' in the workspace. Use folder name to qualify the configuration.",m))}else if(h.folder){let g=this.configurationManager.getLaunches().filter(v=>v.workspace&&v.workspace.name===h.folder&&!!v.getConfiguration(h.name));if(g.length===1)f=g[0];else throw new Error(u("noFolderWithName","Can not find folder with name '{0}' for configuration '{1}' in compound '{2}'.",h.folder,h.name,l.name))}return this.createSession(f,f.getConfiguration(m),i)}))).every(h=>!!h);return this.endInitializingState(),p}if(e&&!a){let c=t?u("configMissing","Configuration '{0}' is missing in 'launch.json'.",typeof e=="string"?e:e.name):u("launchJsonDoesNotExist","'launch.json' does not exist for passed workspace folder.");throw new Error(c)}let d=await this.createSession(t,a,i);return this.endInitializingState(),d}catch(a){return this.notificationService.error(a),this.endInitializingState(),Promise.reject(a)}}async createSession(t,e,i){let n;e?n=e.type:e=Object.create(null),(i&&i.noDebug||i&&typeof i.noDebug>"u"&&i.parentSession&&i.parentSession.configuration.noDebug)&&(e.noDebug=!0);let o=Xi(e),s,a;n||(a=this.editorService.activeEditor,a&&a.resource&&(n=this.chosenEnvironments[a.resource.toString()]),n||(s=await this.adapterManager.guessDebugger(!1),s&&(n=s.type)));let l=new Kt,d=Ni();this.sessionCancellationTokens.set(d,l);let c=await this.configurationManager.resolveConfigurationByProviders(t&&t.workspace?t.workspace.uri:void 0,n,e,l.token);if(c&&c.type)try{let p=await this.substituteVariables(t,c);if(!p||l.token.isCancellationRequested)return!1;let h=t?.workspace||this.contextService.getWorkspace();if(await this.taskRunner.runTaskAndCheckErrors(h,p.preLaunchTask)===0)return!1;let f=await this.configurationManager.resolveDebugConfigurationWithSubstitutedVariables(t&&t.workspace?t.workspace.uri:void 0,p.type,p,l.token);if(!f)return t&&n&&f===null&&!l.token.isCancellationRequested&&await t.openConfigFile({preserveFocus:!0,type:n},l.token),!1;p=f;let g=this.adapterManager.getDebugger(p.type);if(!g||c.request!=="attach"&&c.request!=="launch"){let I;c.request!=="attach"&&c.request!=="launch"?I=c.request?u("debugRequestNotSupported","Attribute '{0}' has an unsupported value '{1}' in the chosen debug configuration.","request",c.request):u("debugRequesMissing","Attribute '{0}' is missing from the chosen debug configuration.","request"):I=p.type?u("debugTypeNotSupported","Configured debug type '{0}' is not supported.",p.type):u("debugTypeMissing","Missing property 'type' for the chosen launch configuration.");let y=[];return y.push(new et("installAdditionalDebuggers",u({key:"installAdditionalDebuggers",comment:['Placeholder is the debug type, so for example "node", "python"']},"Install {0} Extension",p.type),void 0,!0,async()=>this.commandService.executeCommand("debug.installAdditionalDebuggers",p?.type))),await this.showError(I,y),!1}if(!g.enabled)return await this.showError(yV(g.type),[]),!1;let v=await this.doCreateSession(d,t?.workspace,{resolved:p,unresolved:o},i);return v&&s&&a&&a.resource&&(this.chosenEnvironments[a.resource.toString()]=s.type,this.debugStorage.storeChosenEnvironments(this.chosenEnvironments)),v}catch(p){return p&&p.message?await this.showError(p.message):this.contextService.getWorkbenchState()===1&&await this.showError(u("noFolderWorkspaceDebugError","The active file can not be debugged. Make sure it is saved and that you have a debug extension installed for that file type.")),t&&!l.token.isCancellationRequested&&await t.openConfigFile({preserveFocus:!0},l.token),!1}return t&&n&&c===null&&!l.token.isCancellationRequested&&await t.openConfigFile({preserveFocus:!0,type:n},l.token),!1}async doCreateSession(t,e,i,n){let o=this.instantiationService.createInstance(gT,t,i,e,this.model,n);if(n?.startedByUser&&this.model.getSessions().some(a=>a.getLabel()===o.getLabel())&&i.resolved.suppressMultipleSessionWarning!==!0&&!(await this.dialogService.confirm({message:u("multipleSession","'{0}' is already running. Do you want to start another instance?",o.getLabel())})).confirmed)return!1;this.model.addSession(o),this._onWillNewSession.fire(o);let s=this.configurationService.getValue("debug").openDebug;!i.resolved.noDebug&&(s==="openOnSessionStart"||s!=="neverOpen"&&this.viewModel.firstSessionStart)&&!o.suppressDebugView&&await this.paneCompositeService.openPaneComposite(nr,0);try{await this.launchOrAttachToSession(o);let a=o.configuration.internalConsoleOptions||this.configurationService.getValue("debug").internalConsoleOptions;(a==="openOnSessionStart"||this.viewModel.firstSessionStart&&a==="openOnFirstSessionStart")&&this.viewsService.openView(ln,!1),this.viewModel.firstSessionStart=!1;let l=this.configurationService.getValue("debug").showSubSessionsInToolBar,d=this.model.getSessions();return(l?d:d.filter(p=>!p.parentSession)).length>1&&this.viewModel.setMultiSessionView(!0),this._onDidNewSession.fire(o),!0}catch(a){if(vl(a)||(o&&o.getReplElements().length>0&&this.viewsService.openView(ln,!1),o.configuration&&o.configuration.request==="attach"&&o.configuration.__autoAttach))return!1;let l=a instanceof Error?a.message:a;return a.showUser!==!1&&await this.showError(l,ck(a)?a.actions:[]),!1}}async launchOrAttachToSession(t,e=!1){this.registerSessionListeners(t);let i=this.adapterManager.getDebugger(t.configuration.type);try{await t.initialize(i),await t.launchOrAttach(t.configuration);let n=!!t.root&&!!this.configurationService.getValue("launch",{resource:t.root.uri});await this.telemetry.logDebugSessionStart(i,n),(e||!this.viewModel.focusedSession||t.parentSession===this.viewModel.focusedSession&&t.compact)&&await this.focusStackFrame(void 0,void 0,t)}catch(n){return this.viewModel.focusedSession===t&&await this.focusStackFrame(void 0),Promise.reject(n)}}registerSessionListeners(t){let e=new B;this.disposables.add(e);let i=e.add(new Ye(()=>{t.state===3&&this.viewModel.focusedSession===t&&this.viewModel.setFocus(void 0,this.viewModel.focusedThread,t,!1)},200));e.add(t.onDidChangeState(()=>{t.state===3&&this.viewModel.focusedSession===t&&i.schedule(),t===this.viewModel.focusedSession&&this.onStateChange()})),e.add(this.onDidEndSession(n=>{n.session===t&&this.disposables.delete(e)})),e.add(t.onDidEndAdapter(async n=>{n&&(n.error&&this.notificationService.error(u("debugAdapterCrash","Debug adapter process has terminated unexpectedly ({0})",n.error.message||n.error.toString())),this.telemetry.logDebugSessionStop(t,n));let o=BL(t);if(o&&o.state===3&&o.configuration.noDebug&&this.extensionHostDebugService.close(o.getId()),t.configuration.postDebugTask){let a=t.root??this.contextService.getWorkspace();try{await this.taskRunner.runTask(a,t.configuration.postDebugTask)}catch(l){this.notificationService.error(l)}}if(this.endInitializingState(),this.cancelTokens(t.getId()),this.configurationService.getValue("debug").closeReadonlyTabsOnEnd){let a=this.editorService.getEditors(1).filter(({editor:l})=>l.resource?.scheme===Gs&&t.getId()===yh.getEncodedDebugData(l.resource).sessionId);this.editorService.closeEditors(a)}this._onDidEndSession.fire({session:t,restart:this.restartingSessions.has(t)});let s=this.viewModel.focusedSession;if(s&&s.getId()===t.getId()){let{session:a,thread:l,stackFrame:d}=zhe(this.model,void 0,void 0,void 0,s);this.viewModel.setFocus(d,l,a,!1)}if(this.model.getSessions().length===0&&(this.viewModel.setMultiSessionView(!1),this.layoutService.isVisible("workbench.parts.sidebar")&&this.configurationService.getValue("debug").openExplorerOnEnd&&this.paneCompositeService.openPaneComposite(Mue,0),this.model.getDataBreakpoints().filter(l=>!l.canPersist).forEach(l=>this.model.removeDataBreakpoints(l.getId())),this.configurationService.getValue("debug").console.closeOnEnd)){let l=this.viewDescriptorService.getViewContainerByViewId(ln);l&&this.viewsService.isViewContainerVisible(l.id)&&this.viewsService.closeViewContainer(l.id)}this.model.removeExceptionBreakpointsForSession(t.getId())}))}async restartSession(t,e){t.saveBeforeRestart&&await VL(this.configurationService,this.editorService);let i=!!e,n=async()=>{if(i)return Promise.resolve(1);let h=t.root||this.contextService.getWorkspace();await this.taskRunner.runTask(h,t.configuration.preRestartTask),await this.taskRunner.runTask(h,t.configuration.postDebugTask);let m=await this.taskRunner.runTaskAndCheckErrors(h,t.configuration.preLaunchTask);return m!==1?m:this.taskRunner.runTaskAndCheckErrors(h,t.configuration.postRestartTask)},o=BL(t);if(o){await n()===1&&this.extensionHostDebugService.reload(o.getId());return}let s=!1,a,l=t.root?this.configurationManager.getLaunch(t.root.uri):void 0;l&&(a=l.getConfiguration(t.configuration.name),a&&!sn(a,t.unresolvedConfiguration)&&(a.noDebug=t.configuration.noDebug,s=!0));let d=t.configuration;if(l&&s&&a){let h=new Kt;this.sessionCancellationTokens.set(t.getId(),h);let m=await this.configurationManager.resolveConfigurationByProviders(l.workspace?l.workspace.uri:void 0,a.type,a,h.token);m?(d=await this.substituteVariables(l,m),d&&!h.token.isCancellationRequested&&(d=await this.configurationManager.resolveDebugConfigurationWithSubstitutedVariables(l&&l.workspace?l.workspace.uri:void 0,d.type,d,h.token))):d=m}d&&t.setConfiguration({resolved:d,unresolved:a}),t.configuration.__restart=e;let c=async h=>{this.restartingSessions.add(t);let m=!1;try{m=await h()!==!1}catch(f){throw m=!1,f}finally{this.restartingSessions.delete(t),m||this._onDidEndSession.fire({session:t,restart:!1})}};if(t.correlatedTestRun){t.correlatedTestRun.completedAt||(this.testService.cancelTestRun(t.correlatedTestRun.id),await X.toPromise(t.correlatedTestRun.onComplete)),this.testService.runResolvedTests(t.correlatedTestRun.request);return}if(t.capabilities.supportsRestartRequest){await n()===1&&await c(async()=>(await t.restart(),!0));return}let p=!!this.viewModel.focusedSession&&t.getId()===this.viewModel.focusedSession.getId();return c(async()=>(i?await t.disconnect(!0):await t.terminate(!0),new Promise((h,m)=>{setTimeout(async()=>{if(await n()!==1||!d)return h(!1);try{await this.launchOrAttachToSession(t,p),this._onDidNewSession.fire(t),h(!0)}catch(g){m(g)}},300)})))}async stopSession(t,e=!1,i=!1){if(t)return e?t.disconnect(void 0,i):t.terminate();let n=this.model.getSessions();return n.length===0&&(this.taskRunner.cancel(),await this.quickInputService.cancel(),this.endInitializingState(),this.cancelTokens(void 0)),Promise.all(n.map(o=>e?o.disconnect(void 0,i):o.terminate()))}async substituteVariables(t,e){let i=this.adapterManager.getDebugger(e.type);if(i){let n;if(t&&t.workspace)n=t.workspace;else{let o=this.contextService.getWorkspace().folders;o.length===1&&(n=o[0])}try{return await i.substituteVariables(n,e)}catch(o){this.showError(o.message,void 0,!!t?.getConfiguration(e.name));return}}return Promise.resolve(e)}async showError(t,e=[],i=!0){let n=new et(Bh,Dx,void 0,!0,()=>this.commandService.executeCommand(Bh)),o=e.filter(s=>s.id.endsWith(".command")).length>0?e:[...e,...i?[n]:[]];await this.dialogService.prompt({type:Si.Error,message:t,buttons:o.map(s=>({label:s.label,run:()=>s.run()})),cancelButton:!0})}async focusStackFrame(t,e,i,n){let{stackFrame:o,thread:s,session:a}=zhe(this.model,t,e,i);if(o){let l=await o.openInEditor(this.editorService,n?.preserveFocus??!0,n?.sideBySide,n?.pinned);if(l&&l.input!==Yl.instance){let d=l.getControl();if(o&&no(d)&&d.hasModel()){let c=d.getModel(),p=o.range.startLineNumber;if(p>=1&&p<=c.getLineCount()){let h=d.getModel().getLineContent(p);ka(u({key:"debuggingPaused",comment:['First placeholder is the file line content, second placeholder is the reason why debugging is stopped, for example "breakpoint", third is the stack frame name, and last is the line number.']},"{0}, debugging paused {1}, {2}:{3}",h,s&&s.stoppedDetails?`, reason ${s.stoppedDetails.reason}`:"",o.source?o.source.name:"",o.range.startLineNumber))}}}}a?this.debugType.set(a.configuration.type):this.debugType.reset(),this.viewModel.setFocus(o,s,a,!!n?.explicit)}addWatchExpression(t){let e=this.model.addWatchExpression(t);t||this.viewModel.setSelectedExpression(e,!1),this.debugStorage.storeWatchExpressions(this.model.getWatchExpressions())}renameWatchExpression(t,e){this.model.renameWatchExpression(t,e),this.debugStorage.storeWatchExpressions(this.model.getWatchExpressions())}moveWatchExpression(t,e){this.model.moveWatchExpression(t,e),this.debugStorage.storeWatchExpressions(this.model.getWatchExpressions())}removeWatchExpressions(t){this.model.removeWatchExpressions(t),this.debugStorage.storeWatchExpressions(this.model.getWatchExpressions())}canSetBreakpointsIn(t){return this.adapterManager.canSetBreakpointsIn(t)}async enableOrDisableBreakpoints(t,e){e?(this.model.setEnablement(e,t),this.debugStorage.storeBreakpoints(this.model),e instanceof ir?(await this.makeTriggeredBreakpointsMatchEnablement(t,e),await this.sendBreakpoints(e.originalUri)):e instanceof ns?await this.sendFunctionBreakpoints():e instanceof xs?await this.sendDataBreakpoints():e instanceof os?await this.sendInstructionBreakpoints():await this.sendExceptionBreakpoints()):(this.model.enableOrDisableAllBreakpoints(t),this.debugStorage.storeBreakpoints(this.model),await this.sendAllBreakpoints()),this.debugStorage.storeBreakpoints(this.model)}async addBreakpoints(t,e,i=!0){let n=this.model.addBreakpoints(t,e);return i&&n.forEach(o=>La(u("breakpointAdded","Added breakpoint, line {0}, file {1}",o.lineNumber,t.fsPath))),this.debugStorage.storeBreakpoints(this.model),await this.sendBreakpoints(t),this.debugStorage.storeBreakpoints(this.model),n}async updateBreakpoints(t,e,i){this.model.updateBreakpoints(e),this.debugStorage.storeBreakpoints(this.model),i?this.breakpointsToSendOnResourceSaved.add(t):(await this.sendBreakpoints(t),this.debugStorage.storeBreakpoints(this.model))}async removeBreakpoints(t){let e=this.model.getBreakpoints(),i=e.filter(o=>!t||o.getId()===t);i.forEach(o=>La(u("breakpointRemoved","Removed breakpoint, line {0}, file {1}",o.lineNumber,o.uri.fsPath)));let n=new Set(i.map(o=>o.originalUri.toString()));this.model.removeBreakpoints(i),this.unlinkTriggeredBreakpoints(e,i).forEach(o=>n.add(o.toString())),this.debugStorage.storeBreakpoints(this.model),await Promise.all([...n].map(o=>this.sendBreakpoints(Z.parse(o))))}setBreakpointsActivated(t){return this.model.setBreakpointsActivated(t),this.sendAllBreakpoints()}async addFunctionBreakpoint(t,e){this.model.addFunctionBreakpoint(t??{name:""},e),t&&(this.debugStorage.storeBreakpoints(this.model),await this.sendFunctionBreakpoints(),this.debugStorage.storeBreakpoints(this.model))}async updateFunctionBreakpoint(t,e){this.model.updateFunctionBreakpoint(t,e),this.debugStorage.storeBreakpoints(this.model),await this.sendFunctionBreakpoints()}async removeFunctionBreakpoints(t){this.model.removeFunctionBreakpoints(t),this.debugStorage.storeBreakpoints(this.model),await this.sendFunctionBreakpoints()}async addDataBreakpoint(t){this.model.addDataBreakpoint(t),this.debugStorage.storeBreakpoints(this.model),await this.sendDataBreakpoints(),this.debugStorage.storeBreakpoints(this.model)}async updateDataBreakpoint(t,e){this.model.updateDataBreakpoint(t,e),this.debugStorage.storeBreakpoints(this.model),await this.sendDataBreakpoints()}async removeDataBreakpoints(t){this.model.removeDataBreakpoints(t),this.debugStorage.storeBreakpoints(this.model),await this.sendDataBreakpoints()}async addInstructionBreakpoint(t){this.model.addInstructionBreakpoint(t),this.debugStorage.storeBreakpoints(this.model),await this.sendInstructionBreakpoints(),this.debugStorage.storeBreakpoints(this.model)}async removeInstructionBreakpoints(t,e){this.model.removeInstructionBreakpoints(t,e),this.debugStorage.storeBreakpoints(this.model),await this.sendInstructionBreakpoints()}setExceptionBreakpointFallbackSession(t){this.model.setExceptionBreakpointFallbackSession(t),this.debugStorage.storeBreakpoints(this.model)}setExceptionBreakpointsForSession(t,e){this.model.setExceptionBreakpointsForSession(t.getId(),e),this.debugStorage.storeBreakpoints(this.model)}async setExceptionBreakpointCondition(t,e){this.model.setExceptionBreakpointCondition(t,e),this.debugStorage.storeBreakpoints(this.model),await this.sendExceptionBreakpoints()}async sendAllBreakpoints(t){let e=Mo(this.model.getBreakpoints(),i=>i.originalUri.toString()).map(i=>this.sendBreakpoints(i.originalUri,!1,t));t?.capabilities.supportsConfigurationDoneRequest?await Promise.all([...e,this.sendFunctionBreakpoints(t),this.sendDataBreakpoints(t),this.sendInstructionBreakpoints(t),this.sendExceptionBreakpoints(t)]):(await Promise.all(e),await this.sendFunctionBreakpoints(t),await this.sendDataBreakpoints(t),await this.sendInstructionBreakpoints(t),await this.sendExceptionBreakpoints(t))}unlinkTriggeredBreakpoints(t,e){let i=[];for(let n of e)for(let o of t)!e.includes(o)&&o.triggeredBy===n.getId()&&(this.model.updateBreakpoints(new Map([[o.getId(),{triggeredBy:void 0}]])),i.push(o.originalUri));return i}async makeTriggeredBreakpointsMatchEnablement(t,e){if(t&&e.triggeredBy){let i=this.model.getBreakpoints().find(n=>e.triggeredBy===n.getId());i&&!i.enabled&&await this.enableOrDisableBreakpoints(t,i)}await Promise.all(this.model.getBreakpoints().filter(i=>i.triggeredBy===e.getId()&&i.enabled!==t).map(i=>this.enableOrDisableBreakpoints(t,i)))}async sendBreakpoints(t,e=!1,i){let n=this.model.getBreakpoints({originalUri:t,enabledOnly:!0});await HP(this.model,i,async o=>{if(!o.configuration.noDebug){let s=n.filter(a=>!a.triggeredBy||a.getSessionDidTrigger(o.getId()));await o.sendBreakpoints(t,s,e)}})}async sendFunctionBreakpoints(t){let e=this.model.getFunctionBreakpoints().filter(i=>i.enabled&&this.model.areBreakpointsActivated());await HP(this.model,t,async i=>{i.capabilities.supportsFunctionBreakpoints&&!i.configuration.noDebug&&await i.sendFunctionBreakpoints(e)})}async sendDataBreakpoints(t){let e=this.model.getDataBreakpoints().filter(i=>i.enabled&&this.model.areBreakpointsActivated());await HP(this.model,t,async i=>{i.capabilities.supportsDataBreakpoints&&!i.configuration.noDebug&&await i.sendDataBreakpoints(e)})}async sendInstructionBreakpoints(t){let e=this.model.getInstructionBreakpoints().filter(i=>i.enabled&&this.model.areBreakpointsActivated());await HP(this.model,t,async i=>{i.capabilities.supportsInstructionBreakpoints&&!i.configuration.noDebug&&await i.sendInstructionBreakpoints(e)})}sendExceptionBreakpoints(t){return HP(this.model,t,async e=>{let i=this.model.getExceptionBreakpointsForSession(e.getId()).filter(n=>n.enabled);e.capabilities.supportsConfigurationDoneRequest&&(!e.capabilities.exceptionBreakpointFilters||e.capabilities.exceptionBreakpointFilters.length===0)||e.configuration.noDebug||await e.sendExceptionBreakpoints(i)})}onFileChanges(t){let e=this.model.getBreakpoints().filter(n=>t.contains(n.originalUri,2));e.length&&this.model.removeBreakpoints(e);let i=[];for(let n of this.breakpointsToSendOnResourceSaved)t.contains(n,0)&&i.push(n);for(let n of i)this.breakpointsToSendOnResourceSaved.delete(n),this.sendBreakpoints(n,!0)}async runTo(t,e,i){let n,o=this.getViewModel().focusedThread,s=async()=>{if(!!!this.getModel().getBreakpoints({column:i,lineNumber:e,uri:t}).length){let d=await this.addAndValidateBreakpoints(t,e,i);d.thread&&(o=d.thread),d.breakpoint&&(n=d.breakpoint)}return{threadToContinue:o,breakpointToRemove:n}},a=l=>l===2||l===0?(n&&this.removeBreakpoints(n.getId()),!0):!1;if(await s(),this.state===0){let{launch:l,name:d,getConfig:c}=this.getConfigurationManager().selectedConfiguration,p=await c(),h=p?Object.assign(Xi(p),{}):d,m=this.onDidChangeState(f=>{a(f)&&m.dispose()});await this.startDebugging(l,h,void 0,!0)}if(this.state===2){let l=this.getViewModel().focusedSession;if(!l||!o)return;let d=o.session.onDidChangeState(()=>{a(l.state)&&d.dispose()});await o.continue()}}async addAndValidateBreakpoints(t,e,i){let n=this.getModel(),o=this.getViewModel(),a=(await this.addBreakpoints(t,[{lineNumber:e,column:i}],!1))?.[0];if(!a)return{breakpoint:void 0,thread:o.focusedThread};if(!a.verified){let p;await kA(new Promise(h=>{p=n.onDidChangeBreakpoints(()=>{a.verified&&h()})}),2e3),p.dispose()}let l;(g=>(g[g.Focused=0]="Focused",g[g.Verified=1]="Verified",g[g.VerifiedAndPausedInFile=2]="VerifiedAndPausedInFile",g[g.VerifiedAndFocused=3]="VerifiedAndFocused"))(l||={});let d=o.focusedThread,c=0;for(let p of a.sessionsThatVerified){let h=n.getSession(p);if(!h)continue;let m=h.getAllThreads().filter(f=>f.stopped);if(c<3&&o.focusedThread&&m.includes(o.focusedThread)&&(d=o.focusedThread,c=3),c<2){let f=m.find(g=>{let v=g.getTopStackFrame();return v&&this.uriIdentityService.extUri.isEqual(v.source.uri,t)});f&&(d=f,c=2)}c<1&&(d=m[0],c=2)}return{thread:d,breakpoint:a}}};vT=E([b(0,$e),b(1,ed),b(2,Mi),b(3,$i),b(4,mi),b(5,Io),b(6,ii),b(7,kt),b(8,re),b(9,er),b(10,ne),b(11,_n),b(12,Ei),b(13,se),b(14,V2),b(15,mv),b(16,ct),b(17,ki),b(18,_he),b(19,zn),b(20,K2)],vT);function zhe(r,t,e,i,n){if(!i)if(t||e)i=t?t.thread.session:e.session;else{let o=r.getSessions();i=o.find(a=>a.state===2)||o.find(a=>a!==n&&a!==n?.parentSession)||(o.length?o[0]:void 0)}if(!e)if(t)e=t.thread;else{let o=i?i.getAllThreads():void 0;e=o&&o.find(a=>a.stopped)||(o&&o.length?o[0]:void 0)}return!t&&e&&(t=e.getTopStackFrame()),{session:i,thread:e,stackFrame:t}}async function HP(r,t,e){t?await e(t):await Promise.all(r.getSessions().map(i=>e(i)))}var Q_e=ke("auxiliarybar-right-layout-icon",N.layoutSidebarRight,u("toggleAuxiliaryIconRight","Icon to toggle the auxiliary bar off in its right position.")),Z_e=ke("auxiliarybar-right-off-layout-icon",N.layoutSidebarRightOff,u("toggleAuxiliaryIconRightOn","Icon to toggle the auxiliary bar on in its right position.")),J_e=ke("auxiliarybar-left-layout-icon",N.layoutSidebarLeft,u("toggleAuxiliaryIconLeft","Icon to toggle the auxiliary bar in its left position.")),eDe=ke("auxiliarybar-left-off-layout-icon",N.layoutSidebarLeftOff,u("toggleAuxiliaryIconLeftOn","Icon to toggle the auxiliary bar on in its left position.")),gv=class r extends Me{static ID="workbench.action.toggleAuxiliaryBar";static LABEL=ie("toggleAuxiliaryBar","Toggle Secondary Side Bar Visibility");constructor(){super({id:r.ID,title:r.LABEL,toggled:{condition:ph,title:u("secondary sidebar","Secondary Side Bar"),mnemonicTitle:u({key:"secondary sidebar mnemonic",comment:["&& denotes a mnemonic"]},"Secondary Si&&de Bar")},category:$t.View,f1:!0,keybinding:{weight:200,primary:2592},menu:[{id:V.LayoutControlMenuSubmenu,group:"0_workbench_layout",order:1},{id:V.MenubarAppearanceMenu,group:"2_workbench_layout",order:2}]})}async run(t){let e=t.get(ii);e.setPartHidden(e.isVisible("workbench.parts.auxiliarybar"),"workbench.parts.auxiliarybar")}};he(gv);he(class KY extends Me{static ID="workbench.action.focusAuxiliaryBar";static LABEL=ie("focusAuxiliaryBar","Focus into Secondary Side Bar");constructor(){super({id:KY.ID,title:KY.LABEL,category:$t.View,f1:!0})}async run(t){let e=t.get(ed),i=t.get(ii);i.isVisible("workbench.parts.auxiliarybar")||i.setPartHidden(!1,"workbench.parts.auxiliarybar"),e.getActivePaneComposite(2)?.focus()}});Ue.appendMenuItems([{id:V.LayoutControlMenu,item:{group:"0_workbench_toggles",command:{id:gv.ID,title:u("toggleSecondarySideBar","Toggle Secondary Side Bar"),toggled:{condition:ph,icon:J_e},icon:eDe},when:P.and(P.or(P.equals("config.workbench.layoutControl.type","toggles"),P.equals("config.workbench.layoutControl.type","both")),P.equals("config.workbench.sideBar.location","right")),order:0}},{id:V.LayoutControlMenu,item:{group:"0_workbench_toggles",command:{id:gv.ID,title:u("toggleSecondarySideBar","Toggle Secondary Side Bar"),toggled:{condition:ph,icon:Q_e},icon:Z_e},when:P.and(P.or(P.equals("config.workbench.layoutControl.type","toggles"),P.equals("config.workbench.layoutControl.type","both")),P.equals("config.workbench.sideBar.location","left")),order:2}},{id:V.ViewTitleContext,item:{group:"3_workbench_layout_move",command:{id:gv.ID,title:ie("hideAuxiliaryBar","Hide Secondary Side Bar")},when:P.and(ph,P.equals("viewLocation",Es(2))),order:2}}]);var iDe=ke("panel-maximize",N.chevronUp,u("maximizeIcon","Icon to maximize a panel.")),nDe=ke("panel-restore",N.chevronDown,u("restoreIcon","Icon to restore a panel.")),Ghe=ke("panel-close",N.close,u("closeIcon","Icon to close a panel.")),oDe=ke("panel-layout-icon",N.layoutPanel,u("togglePanelOffIcon","Icon to toggle the panel off when it is on.")),rDe=ke("panel-layout-icon-off",N.layoutPanelOff,u("togglePanelOnIcon","Icon to toggle the panel on when it is off.")),eS=class r extends Me{static ID="workbench.action.togglePanel";static LABEL=ie("togglePanelVisibility","Toggle Panel Visibility");constructor(){super({id:r.ID,title:r.LABEL,toggled:{condition:QI,title:u("toggle panel","Panel"),mnemonicTitle:u({key:"toggle panel mnemonic",comment:["&& denotes a mnemonic"]},"&&Panel")},f1:!0,category:$t.View,keybinding:{primary:2088,weight:200},menu:[{id:V.MenubarAppearanceMenu,group:"2_workbench_layout",order:5},{id:V.LayoutControlMenuSubmenu,group:"0_workbench_layout",order:4}]})}async run(t){let e=t.get(ii);e.setPartHidden(e.isVisible("workbench.parts.panel"),"workbench.parts.panel")}};he(eS);he(class extends Me{static ID="workbench.action.focusPanel";static LABEL=u("focusPanel","Focus into Panel");constructor(){super({id:"workbench.action.focusPanel",title:ie("focusPanel","Focus into Panel"),category:$t.View,f1:!0})}async run(r){let t=r.get(ii),e=r.get(ed);t.isVisible("workbench.parts.panel")||t.setPartHidden(!1,"workbench.parts.panel"),e.getActivePaneComposite(1)?.focus()}});var J2={LEFT:"workbench.action.positionPanelLeft",RIGHT:"workbench.action.positionPanelRight",BOTTOM:"workbench.action.positionPanelBottom",TOP:"workbench.action.positionPanelTop"},ez={LEFT:"workbench.action.alignPanelLeft",RIGHT:"workbench.action.alignPanelRight",CENTER:"workbench.action.alignPanelCenter",JUSTIFY:"workbench.action.alignPanelJustify"};function qhe(r,t,e,i,n){return{id:r,title:t,shortLabel:e,value:i,when:n}}function tz(r,t,e,i){return qhe(r,t,e,i,ub.notEqualsTo(Jf(i)))}function iz(r,t,e,i){return qhe(r,t,e,i,hh.notEqualsTo(i))}var sDe=[tz(J2.TOP,ie("positionPanelTop","Move Panel To Top"),u("positionPanelTopShort","Top"),3),tz(J2.LEFT,ie("positionPanelLeft","Move Panel Left"),u("positionPanelLeftShort","Left"),0),tz(J2.RIGHT,ie("positionPanelRight","Move Panel Right"),u("positionPanelRightShort","Right"),1),tz(J2.BOTTOM,ie("positionPanelBottom","Move Panel To Bottom"),u("positionPanelBottomShort","Bottom"),2)],aDe=[iz(ez.LEFT,ie("alignPanelLeft","Set Panel Alignment to Left"),u("alignPanelLeftShort","Left"),"left"),iz(ez.RIGHT,ie("alignPanelRight","Set Panel Alignment to Right"),u("alignPanelRightShort","Right"),"right"),iz(ez.CENTER,ie("alignPanelCenter","Set Panel Alignment to Center"),u("alignPanelCenterShort","Center"),"center"),iz(ez.JUSTIFY,ie("alignPanelJustify","Set Panel Alignment to Justify"),u("alignPanelJustifyShort","Justify"),"justify")];Ue.appendMenuItem(V.MenubarAppearanceMenu,{submenu:V.PanelPositionMenu,title:u("positionPanel","Panel Position"),group:"3_workbench_layout_move",order:4});sDe.forEach((r,t)=>{let{id:e,title:i,shortLabel:n,value:o,when:s}=r;he(class extends Me{constructor(){super({id:e,title:i,category:$t.View,f1:!0})}run(a){a.get(ii).setPanelPosition(o===void 0?2:o)}}),Ue.appendMenuItem(V.PanelPositionMenu,{command:{id:e,title:n,toggled:s.negate()},order:5+t})});Ue.appendMenuItem(V.MenubarAppearanceMenu,{submenu:V.PanelAlignmentMenu,title:u("alignPanel","Align Panel"),group:"3_workbench_layout_move",order:5});aDe.forEach(r=>{let{id:t,title:e,shortLabel:i,value:n,when:o}=r;he(class extends Me{constructor(){super({id:t,title:e,category:$t.View,toggled:o.negate(),f1:!0})}run(s){s.get(ii).setPanelAlignment(n===void 0?"center":n)}}),Ue.appendMenuItem(V.PanelAlignmentMenu,{command:{id:t,title:i,toggled:o.negate()},order:5})});var nz=class extends Me{constructor(t,e){super({id:t,title:e,category:$t.View,f1:!0})}async run(t,e){let i=t.get(ed),n=i.getVisiblePaneCompositeIds(1),o=i.getActivePaneComposite(1);if(!o)return;let s;for(let a=0;a<n.length;a++)if(n[a]===o.getId()){s=n[(a+n.length+e)%n.length];break}typeof s=="string"&&await i.openPaneComposite(s,1,!0)}};he(class extends nz{constructor(){super("workbench.action.previousPanelView",ie("previousPanelView","Previous Panel View"))}run(r){return super.run(r,-1)}});he(class extends nz{constructor(){super("workbench.action.nextPanelView",ie("nextPanelView","Next Panel View"))}run(r){return super.run(r,1)}});he(class extends Me{constructor(){super({id:"workbench.action.toggleMaximizedPanel",title:ie("toggleMaximizedPanel","Toggle Maximized Panel"),tooltip:u("maximizePanel","Maximize Panel Size"),category:$t.View,f1:!0,icon:iDe,precondition:P.or(hh.isEqualTo("center"),P.and(ub.notEqualsTo("bottom"),ub.notEqualsTo("top"))),toggled:{condition:cde,icon:nDe,tooltip:u("minimizePanel","Restore Panel Size")},menu:[{id:V.PanelTitle,group:"navigation",order:1,when:P.or(hh.isEqualTo("center"),P.and(ub.notEqualsTo("bottom"),ub.notEqualsTo("top")))}]})}run(r){let t=r.get(ii),e=r.get(mi);if(t.getPanelAlignment()!=="center"&&F1(t.getPanelPosition())){e.warn(u("panelMaxNotSupported","Maximizing the panel is only supported when it is center aligned."));return}t.isVisible("workbench.parts.panel")?t.toggleMaximizedPanel():(t.setPartHidden(!1,"workbench.parts.panel"),t.isPanelMaximized()||t.toggleMaximizedPanel())}});he(class extends Me{constructor(){super({id:"workbench.action.closePanel",title:ie("closePanel","Hide Panel"),category:$t.View,icon:Ghe,menu:[{id:V.CommandPalette,when:QI},{id:V.PanelTitle,group:"navigation",order:2}]})}run(r){r.get(ii).setPartHidden(!0,"workbench.parts.panel")}});he(class extends Me{constructor(){super({id:"workbench.action.closeAuxiliaryBar",title:ie("closeSecondarySideBar","Hide Secondary Side Bar"),category:$t.View,icon:Ghe,menu:[{id:V.CommandPalette,when:ph},{id:V.AuxiliaryBarTitle,group:"navigation",order:2,when:P.notEquals("config.workbench.activityBar.location","top")}]})}run(r){r.get(ii).setPartHidden(!0,"workbench.parts.auxiliarybar")}});Ue.appendMenuItems([{id:V.LayoutControlMenu,item:{group:"0_workbench_toggles",command:{id:eS.ID,title:u("togglePanel","Toggle Panel"),icon:rDe,toggled:{condition:QI,icon:oDe}},when:P.or(P.equals("config.workbench.layoutControl.type","toggles"),P.equals("config.workbench.layoutControl.type","both")),order:1}},{id:V.ViewTitleContext,item:{group:"3_workbench_layout_move",command:{id:eS.ID,title:ie("hidePanel","Hide Panel")},when:P.and(QI,P.equals("viewLocation",Es(1))),order:2}}]);var IT=class extends Me{constructor(e,i,n){super(n);this.source=e;this.destination=i}run(e,...i){let n=e.get($i),o=e.get(ii),s=e.get(Mi),a=n.getViewContainersByLocation(this.source),l=n.getViewContainersByLocation(this.destination);if(a.length){let d=s.getVisibleViewContainer(this.source);a.forEach(c=>n.moveViewContainerToLocation(c,this.destination,void 0,this.desc.id)),o.setPartHidden(!1,this.destination===1?"workbench.parts.panel":"workbench.parts.auxiliarybar"),d&&l.length===0&&s.openViewContainer(d.id,!0)}}},GY=class r extends IT{static ID="workbench.action.movePanelToSidePanel";constructor(){super(1,2,{id:r.ID,title:ie("movePanelToSecondarySideBar","Move Panel Views To Secondary Side Bar"),category:$t.View,f1:!1})}},qY=class r extends IT{static ID="workbench.action.movePanelToSecondarySideBar";constructor(){super(1,2,{id:r.ID,title:ie("movePanelToSecondarySideBar","Move Panel Views To Secondary Side Bar"),category:$t.View,f1:!0})}};he(GY);he(qY);var $Y=class r extends IT{static ID="workbench.action.moveSidePanelToPanel";constructor(){super(2,1,{id:r.ID,title:ie("moveSidePanelToPanel","Move Secondary Side Bar Views To Panel"),category:$t.View,f1:!1})}},jY=class r extends IT{static ID="workbench.action.moveSecondarySideBarToPanel";constructor(){super(2,1,{id:r.ID,title:ie("moveSidePanelToPanel","Move Secondary Side Bar Views To Panel"),category:$t.View,f1:!0})}};he($Y);he(jY);var cDe=ke("menuBar",N.layoutMenubar,u("menuBarIcon","Represents the menu bar")),uDe=ke("activity-bar-left",N.layoutActivitybarLeft,u("activityBarLeft","Represents the activity bar in the left position")),pDe=ke("activity-bar-right",N.layoutActivitybarRight,u("activityBarRight","Represents the activity bar in the right position")),oz=ke("panel-left",N.layoutSidebarLeft,u("panelLeft","Represents a side bar in the left position")),hDe=ke("panel-left-off",N.layoutSidebarLeftOff,u("panelLeftOff","Represents a side bar in the left position toggled off")),rz=ke("panel-right",N.layoutSidebarRight,u("panelRight","Represents side bar in the right position")),mDe=ke("panel-right-off",N.layoutSidebarRightOff,u("panelRightOff","Represents side bar in the right position toggled off")),gDe=ke("panel-bottom",N.layoutPanel,u("panelBottom","Represents the bottom panel")),fDe=ke("statusBar",N.layoutStatusbar,u("statusBarIcon","Represents the status bar")),bDe=ke("panel-align-left",N.layoutPanelLeft,u("panelBottomLeft","Represents the bottom panel alignment set to the left")),vDe=ke("panel-align-right",N.layoutPanelRight,u("panelBottomRight","Represents the bottom panel alignment set to the right")),IDe=ke("panel-align-center",N.layoutPanelCenter,u("panelBottomCenter","Represents the bottom panel alignment set to the center")),yDe=ke("panel-align-justify",N.layoutPanelJustify,u("panelBottomJustify","Represents the bottom panel alignment set to justified")),SDe=ke("fullscreen",N.screenFull,u("fullScreenIcon","Represents full screen")),CDe=ke("centerLayoutIcon",N.layoutCentered,u("centerLayoutIcon","Represents centered layout mode")),wDe=ke("zenMode",N.target,u("zenModeIcon","Represents zen mode"));he(class extends Me{constructor(){super({id:"workbench.action.closeSidebar",title:ie("closeSidebar","Close Primary Side Bar"),category:$t.View,f1:!0})}run(r){r.get(ii).setPartHidden(!0,"workbench.parts.sidebar")}});var EDe="workbench.action.toggleActivityBarVisibility";he(class extends Me{constructor(){super({id:"workbench.action.toggleCenteredLayout",title:{...ie("toggleCenteredLayout","Toggle Centered Layout"),mnemonicTitle:u({key:"miToggleCenteredLayout",comment:["&& denotes a mnemonic"]},"&&Centered Layout")},precondition:jl.toNegated(),category:$t.View,f1:!0,toggled:Z9,menu:[{id:V.MenubarAppearanceMenu,group:"1_toggle_view",order:3}]})}run(r){let t=r.get(ii);t.centerMainEditorLayout(!t.isMainEditorLayoutCentered())}});var $he="workbench.sideBar.location",sz=class extends Me{constructor(e,i,n){super({id:e,title:i,f1:!1});this.position=n}async run(e){let i=e.get(ii),n=e.get(se);if(i.getSideBarPosition()!==this.position)return n.updateValue($he,Jf(this.position))}},az=class r extends sz{static ID="workbench.action.moveSideBarRight";constructor(){super(r.ID,ie("moveSidebarRight","Move Primary Side Bar Right"),1)}},lz=class r extends sz{static ID="workbench.action.moveSideBarLeft";constructor(){super(r.ID,ie("moveSidebarLeft","Move Primary Side Bar Left"),0)}};he(az);he(lz);var tp=class r extends Me{static ID="workbench.action.toggleSidebarPosition";static LABEL=u("toggleSidebarPosition","Toggle Primary Side Bar Position");static getLabel(t){return t.getSideBarPosition()===0?u("moveSidebarRight","Move Primary Side Bar Right"):u("moveSidebarLeft","Move Primary Side Bar Left")}constructor(){super({id:r.ID,title:ie("toggleSidebarPosition","Toggle Primary Side Bar Position"),category:$t.View,f1:!0})}run(t){let e=t.get(ii),i=t.get(se),o=e.getSideBarPosition()===0?"right":"left";return i.updateValue($he,o)}};he(tp);var jhe=ke("configure-layout-icon",N.layout,u("cofigureLayoutIcon","Icon represents workbench layout configuration."));Ue.appendMenuItem(V.LayoutControlMenu,{submenu:V.LayoutControlMenuSubmenu,title:u("configureLayout","Configure Layout"),icon:jhe,group:"1_workbench_layout",when:P.equals("config.workbench.layoutControl.type","menu")});Ue.appendMenuItems([{id:V.ViewContainerTitleContext,item:{group:"3_workbench_layout_move",command:{id:tp.ID,title:u("move side bar right","Move Primary Side Bar Right")},when:P.and(P.notEquals("config.workbench.sideBar.location","right"),P.equals("viewContainerLocation",Es(0))),order:1}},{id:V.ViewTitleContext,item:{group:"3_workbench_layout_move",command:{id:tp.ID,title:u("move sidebar right","Move Primary Side Bar Right")},when:P.and(P.notEquals("config.workbench.sideBar.location","right"),P.equals("viewLocation",Es(0))),order:1}},{id:V.ViewContainerTitleContext,item:{group:"3_workbench_layout_move",command:{id:tp.ID,title:u("move sidebar left","Move Primary Side Bar Left")},when:P.and(P.equals("config.workbench.sideBar.location","right"),P.equals("viewContainerLocation",Es(0))),order:1}},{id:V.ViewTitleContext,item:{group:"3_workbench_layout_move",command:{id:tp.ID,title:u("move sidebar left","Move Primary Side Bar Left")},when:P.and(P.equals("config.workbench.sideBar.location","right"),P.equals("viewLocation",Es(0))),order:1}},{id:V.ViewTitleContext,item:{group:"3_workbench_layout_move",command:{id:tp.ID,title:u("move second sidebar left","Move Secondary Side Bar Left")},when:P.and(P.notEquals("config.workbench.sideBar.location","right"),P.equals("viewLocation",Es(2))),order:1}},{id:V.ViewTitleContext,item:{group:"3_workbench_layout_move",command:{id:tp.ID,title:u("move second sidebar right","Move Secondary Side Bar Right")},when:P.and(P.equals("config.workbench.sideBar.location","right"),P.equals("viewLocation",Es(2))),order:1}}]);Ue.appendMenuItem(V.MenubarAppearanceMenu,{group:"3_workbench_layout_move",command:{id:tp.ID,title:u({key:"miMoveSidebarRight",comment:["&& denotes a mnemonic"]},"&&Move Primary Side Bar Right")},when:P.notEquals("config.workbench.sideBar.location","right"),order:2});Ue.appendMenuItem(V.MenubarAppearanceMenu,{group:"3_workbench_layout_move",command:{id:tp.ID,title:u({key:"miMoveSidebarLeft",comment:["&& denotes a mnemonic"]},"&&Move Primary Side Bar Left")},when:P.equals("config.workbench.sideBar.location","right"),order:2});he(class extends Me{constructor(){super({id:"workbench.action.toggleEditorVisibility",title:{...ie("toggleEditor","Toggle Editor Area Visibility"),mnemonicTitle:u({key:"miShowEditorArea",comment:["&& denotes a mnemonic"]},"Show &&Editor Area")},category:$t.View,f1:!0,toggled:lde,precondition:P.and(jl.toNegated(),P.or(hh.isEqualTo("center"),ub.notEqualsTo("bottom")))})}run(r){r.get(ii).toggleMaximizedPanel()}});Ue.appendMenuItem(V.MenubarViewMenu,{group:"2_appearance",title:u({key:"miAppearance",comment:["&& denotes a mnemonic"]},"&&Appearance"),submenu:V.MenubarAppearanceMenu,order:1});var fv=class r extends Me{static ID="workbench.action.toggleSidebarVisibility";constructor(){super({id:r.ID,title:ie("toggleSidebar","Toggle Primary Side Bar Visibility"),toggled:{condition:db,title:u("primary sidebar","Primary Side Bar"),mnemonicTitle:u({key:"primary sidebar mnemonic",comment:["&& denotes a mnemonic"]},"&&Primary Side Bar")},category:$t.View,f1:!0,keybinding:{weight:200,primary:2080},menu:[{id:V.LayoutControlMenuSubmenu,group:"0_workbench_layout",order:0},{id:V.MenubarAppearanceMenu,group:"2_workbench_layout",order:1}]})}run(t){let e=t.get(ii);e.setPartHidden(e.isVisible("workbench.parts.sidebar"),"workbench.parts.sidebar")}};he(fv);Ue.appendMenuItems([{id:V.ViewContainerTitleContext,item:{group:"3_workbench_layout_move",command:{id:fv.ID,title:u("compositePart.hideSideBarLabel","Hide Primary Side Bar")},when:P.and(db,P.equals("viewContainerLocation",Es(0))),order:2}},{id:V.ViewTitleContext,item:{group:"3_workbench_layout_move",command:{id:fv.ID,title:u("compositePart.hideSideBarLabel","Hide Primary Side Bar")},when:P.and(db,P.equals("viewLocation",Es(0))),order:2}},{id:V.LayoutControlMenu,item:{group:"0_workbench_toggles",command:{id:fv.ID,title:u("toggleSideBar","Toggle Primary Side Bar"),icon:hDe,toggled:{condition:db,icon:oz}},when:P.and(P.or(P.equals("config.workbench.layoutControl.type","toggles"),P.equals("config.workbench.layoutControl.type","both")),P.equals("config.workbench.sideBar.location","left")),order:0}},{id:V.LayoutControlMenu,item:{group:"0_workbench_toggles",command:{id:fv.ID,title:u("toggleSideBar","Toggle Primary Side Bar"),icon:mDe,toggled:{condition:db,icon:rz}},when:P.and(P.or(P.equals("config.workbench.layoutControl.type","toggles"),P.equals("config.workbench.layoutControl.type","both")),P.equals("config.workbench.sideBar.location","right")),order:2}}]);var tS=class r extends Me{static ID="workbench.action.toggleStatusbarVisibility";static statusbarVisibleKey="workbench.statusBar.visible";constructor(){super({id:r.ID,title:{...ie("toggleStatusbar","Toggle Status Bar Visibility"),mnemonicTitle:u({key:"miStatusbar",comment:["&& denotes a mnemonic"]},"S&&tatus Bar")},category:$t.View,f1:!0,toggled:P.equals("config.workbench.statusBar.visible",!0),menu:[{id:V.MenubarAppearanceMenu,group:"2_workbench_layout",order:3}]})}run(t){let e=t.get(ii),i=t.get(se),o=!e.isVisible("workbench.parts.statusbar",Ke);return i.updateValue(r.statusbarVisibleKey,o)}};he(tS);var bv=class extends Me{constructor(e,i,n,o,s,a){super({id:o,title:n,category:$t.View,precondition:s,metadata:a?{description:a}:void 0,f1:!0});this.settingName=e;this.value=i}run(e){return e.get(se).updateValue(this.settingName,this.value)}},XY=class r extends bv{static ID="workbench.action.hideEditorTabs";constructor(){let t=P.and(P.equals("config.workbench.editor.showTabs","none").negate(),Fd.negate()),e=ie("hideEditorTabs","Hide Editor Tabs");super("workbench.editor.showTabs","none",e,r.ID,t,ie("hideEditorTabsDescription","Hide Tab Bar"))}},YY=class r extends bv{static ID="workbench.action.zenHideEditorTabs";constructor(){let t=P.and(P.equals("config.zenMode.showTabs","none").negate(),Fd),e=ie("hideEditorTabsZenMode","Hide Editor Tabs in Zen Mode");super("zenMode.showTabs","none",e,r.ID,t,ie("hideEditorTabsZenModeDescription","Hide Tab Bar in Zen Mode"))}},QY=class r extends bv{static ID="workbench.action.showMultipleEditorTabs";constructor(){let t=P.and(P.equals("config.workbench.editor.showTabs","multiple").negate(),Fd.negate()),e=ie("showMultipleEditorTabs","Show Multiple Editor Tabs");super("workbench.editor.showTabs","multiple",e,r.ID,t,ie("showMultipleEditorTabsDescription","Show Tab Bar with multiple tabs"))}},ZY=class r extends bv{static ID="workbench.action.zenShowMultipleEditorTabs";constructor(){let t=P.and(P.equals("config.zenMode.showTabs","multiple").negate(),Fd),e=ie("showMultipleEditorTabsZenMode","Show Multiple Editor Tabs in Zen Mode");super("zenMode.showTabs","multiple",e,r.ID,t,ie("showMultipleEditorTabsZenModeDescription","Show Tab Bar in Zen Mode"))}},JY=class r extends bv{static ID="workbench.action.showEditorTab";constructor(){let t=P.and(P.equals("config.workbench.editor.showTabs","single").negate(),Fd.negate()),e=ie("showSingleEditorTab","Show Single Editor Tab");super("workbench.editor.showTabs","single",e,r.ID,t,ie("showSingleEditorTabDescription","Show Tab Bar with one Tab"))}},eQ=class r extends bv{static ID="workbench.action.zenShowEditorTab";constructor(){let t=P.and(P.equals("config.zenMode.showTabs","single").negate(),Fd),e=ie("showSingleEditorTabZenMode","Show Single Editor Tab in Zen Mode");super("zenMode.showTabs","single",e,r.ID,t,ie("showSingleEditorTabZenModeDescription","Show Tab Bar in Zen Mode with one Tab"))}};he(XY);he(YY);he(QY);he(ZY);he(JY);he(eQ);Ue.appendMenuItem(V.MenubarAppearanceMenu,{submenu:V.EditorTabsBarShowTabsSubmenu,title:u("tabBar","Tab Bar"),group:"3_workbench_layout_move",order:10,when:Fd.negate()});Ue.appendMenuItem(V.MenubarAppearanceMenu,{submenu:V.EditorTabsBarShowTabsZenModeSubmenu,title:u("tabBar","Tab Bar"),group:"3_workbench_layout_move",order:10,when:Fd});var tQ=class r extends Me{static ID="workbench.action.editorActionsTitleBar";constructor(){super({id:r.ID,title:ie("moveEditorActionsToTitleBar","Move Editor Actions to Title Bar"),category:$t.View,precondition:P.equals("config.workbench.editor.editorActionsLocation","titleBar").negate(),metadata:{description:ie("moveEditorActionsToTitleBarDescription","Move Editor Actions from the tab bar to the title bar")},f1:!0})}run(t){return t.get(se).updateValue("workbench.editor.editorActionsLocation","titleBar")}};he(tQ);var iQ=class r extends Me{static ID="workbench.action.editorActionsDefault";constructor(){super({id:r.ID,title:ie("moveEditorActionsToTabBar","Move Editor Actions to Tab Bar"),category:$t.View,precondition:P.and(P.equals("config.workbench.editor.editorActionsLocation","default").negate(),P.equals("config.workbench.editor.showTabs","none").negate()),metadata:{description:ie("moveEditorActionsToTabBarDescription","Move Editor Actions from the title bar to the tab bar")},f1:!0})}run(t){return t.get(se).updateValue("workbench.editor.editorActionsLocation","default")}};he(iQ);var nQ=class r extends Me{static ID="workbench.action.hideEditorActions";constructor(){super({id:r.ID,title:ie("hideEditorActons","Hide Editor Actions"),category:$t.View,precondition:P.equals("config.workbench.editor.editorActionsLocation","hidden").negate(),metadata:{description:ie("hideEditorActonsDescription","Hide Editor Actions in the tab and title bar")},f1:!0})}run(t){return t.get(se).updateValue("workbench.editor.editorActionsLocation","hidden")}};he(nQ);var oQ=class r extends Me{static ID="workbench.action.showEditorActions";constructor(){super({id:r.ID,title:ie("showEditorActons","Show Editor Actions"),category:$t.View,precondition:P.equals("config.workbench.editor.editorActionsLocation","hidden"),metadata:{description:ie("showEditorActonsDescription","Make Editor Actions visible.")},f1:!0})}run(t){return t.get(se).updateValue("workbench.editor.editorActionsLocation","default")}};he(oQ);Ue.appendMenuItem(V.MenubarAppearanceMenu,{submenu:V.EditorActionsPositionSubmenu,title:u("editorActionsPosition","Editor Actions Position"),group:"3_workbench_layout_move",order:11});var rQ=class r extends Me{static ID="workbench.action.configureEditorTabs";constructor(){super({id:r.ID,title:ie("configureTabs","Configure Tabs"),category:$t.View})}run(t){t.get(jm).openSettings({jsonEditor:!1,query:"workbench.editor tab"})}};he(rQ);var sQ=class r extends Me{static ID="workbench.action.configureEditor";constructor(){super({id:r.ID,title:ie("configureEditors","Configure Editors"),category:$t.View})}run(t){t.get(jm).openSettings({jsonEditor:!1,query:"workbench.editor"})}};he(sQ);he(class extends Me{constructor(){super({id:"workbench.action.toggleSeparatePinnedEditorTabs",title:ie("toggleSeparatePinnedEditorTabs","Separate Pinned Editor Tabs"),category:$t.View,precondition:P.equals("config.workbench.editor.showTabs","multiple"),metadata:{description:ie("toggleSeparatePinnedEditorTabsDescription","Toggle whether pinned editor tabs are shown on a separate row above unpinned tabs.")},f1:!0})}run(r){let t=r.get(se),i=!t.getValue("workbench.editor.pinnedTabsOnSeparateRow");return t.updateValue("workbench.editor.pinnedTabsOnSeparateRow",i)}});he(class extends Me{constructor(){super({id:"workbench.action.toggleZenMode",title:{...ie("toggleZenMode","Toggle Zen Mode"),mnemonicTitle:u({key:"miToggleZenMode",comment:["&& denotes a mnemonic"]},"Zen Mode")},precondition:jl.toNegated(),category:$t.View,f1:!0,keybinding:{weight:200,primary:mo(2089,56)},toggled:Fd,menu:[{id:V.MenubarAppearanceMenu,group:"1_toggle_view",order:2}]})}run(r){return r.get(ii).toggleZenMode()}});wt.registerCommandAndKeybindingRule({id:"workbench.action.exitZenMode",weight:-900,handler(r){let t=r.get(ii),e=r.get(re);Fd.getValue(e)&&t.toggleZenMode()},when:Fd,primary:mo(9,9)});if(St||ci||si){he(class extends Me{constructor(){super({id:"workbench.action.toggleMenuBar",title:{...ie("toggleMenuBar","Toggle Menu Bar"),mnemonicTitle:u({key:"miMenuBar",comment:["&& denotes a mnemonic"]},"Menu &&Bar")},category:$t.View,f1:!0,toggled:P.and(Bd.toNegated(),P.notEquals("config.window.menuBarVisibility","hidden"),P.notEquals("config.window.menuBarVisibility","toggle"),P.notEquals("config.window.menuBarVisibility","compact")),menu:[{id:V.MenubarAppearanceMenu,group:"2_workbench_layout",order:0}]})}run(t){return t.get(ii).toggleMenuBar()}});for(let r of[V.TitleBarContext,V.TitleBarTitleContext])Ue.appendMenuItem(r,{command:{id:"workbench.action.toggleMenuBar",title:u("miMenuBarNoMnemonic","Menu Bar"),toggled:P.and(Bd.toNegated(),P.notEquals("config.window.menuBarVisibility","hidden"),P.notEquals("config.window.menuBarVisibility","toggle"),P.notEquals("config.window.menuBarVisibility","compact"))},when:P.and(jl.toNegated(),P.notEquals(Jw.key,"native"),ku.negate()),group:"2_config",order:0})}he(class extends Me{constructor(){super({id:"workbench.action.resetViewLocations",title:ie("resetViewLocations","Reset View Locations"),category:$t.View,f1:!0})}run(r){return r.get($i).reset()}});he(class extends Me{constructor(){super({id:"workbench.action.moveView",title:ie("moveView","Move View"),category:$t.View,f1:!0})}async run(r){let t=r.get($i),e=r.get(ne),i=r.get(ki),n=r.get(re),o=r.get(ed),s=Ks.getValue(n),a;s&&t.getViewDescriptorById(s)?.canMoveView&&(a=s);try{if(a=await this.getView(i,t,o,a),!a)return;let l=new dz;e.invokeFunction(d=>l.run(d,a))}catch{}}getViewItems(r,t){let e=[];return t.getVisiblePaneCompositeIds(0).forEach(s=>{let a=r.getViewContainerById(s),l=r.getViewContainerModel(a),d=!1;l.visibleViewDescriptors.forEach(c=>{c.canMoveView&&(d||(e.push({type:"separator",label:u("sidebarContainer","Side Bar / {0}",l.title)}),d=!0),e.push({id:c.id,label:c.name.value}))})}),t.getPinnedPaneCompositeIds(1).forEach(s=>{let a=r.getViewContainerById(s),l=r.getViewContainerModel(a),d=!1;l.visibleViewDescriptors.forEach(c=>{c.canMoveView&&(d||(e.push({type:"separator",label:u("panelContainer","Panel / {0}",l.title)}),d=!0),e.push({id:c.id,label:c.name.value}))})}),t.getPinnedPaneCompositeIds(2).forEach(s=>{let a=r.getViewContainerById(s),l=r.getViewContainerModel(a),d=!1;l.visibleViewDescriptors.forEach(c=>{c.canMoveView&&(d||(e.push({type:"separator",label:u("secondarySideBarContainer","Secondary Side Bar / {0}",l.title)}),d=!0),e.push({id:c.id,label:c.name.value}))})}),e}async getView(r,t,e,i){let n=new B,o=n.add(r.createQuickPick({useSeparators:!0}));return o.placeholder=u("moveFocusedView.selectView","Select a View to Move"),o.items=this.getViewItems(t,e),o.selectedItems=o.items.filter(s=>s.id===i),new Promise((s,a)=>{n.add(o.onDidAccept(()=>{let l=o.selectedItems[0];l.id?s(l.id):a(),o.hide()})),n.add(o.onDidHide(()=>{n.dispose(),a()})),o.show()})}});var dz=class extends Me{constructor(){super({id:"workbench.action.moveFocusedView",title:ie("moveFocusedView","Move Focused View"),category:$t.View,precondition:Ks.notEqualsTo(""),f1:!0})}run(t,e){let i=t.get($i),n=t.get(Mi),o=t.get(ki),s=t.get(re),a=t.get(Io),l=t.get(ed),d=e||Ks.getValue(s);if(d===void 0||d.trim()===""){a.error(u("moveFocusedView.error.noFocusedView","There is no view currently focused."));return}let c=i.getViewDescriptorById(d);if(!c||!c.canMoveView){a.error(u("moveFocusedView.error.nonMovableView","The currently focused view is not movable."));return}let p=new B,h=p.add(o.createQuickPick({useSeparators:!0}));h.placeholder=u("moveFocusedView.selectDestination","Select a Destination for the View"),h.title=u({key:"moveFocusedView.title",comment:["{0} indicates the title of the view the user has selected to move."]},"View: Move {0}",c.name.value);let m=[],f=i.getViewContainerByViewId(d),g=i.getViewLocationById(d),v=i.getViewContainerModel(f).allViewDescriptors.length===1;v&&g===1||m.push({id:"_.panel.newcontainer",label:u({key:"moveFocusedView.newContainerInPanel",comment:["Creates a new top-level tab in the panel."]},"New Panel Entry")}),v&&g===0||m.push({id:"_.sidebar.newcontainer",label:u("moveFocusedView.newContainerInSidebar","New Side Bar Entry")}),v&&g===2||m.push({id:"_.auxiliarybar.newcontainer",label:u("moveFocusedView.newContainerInSidePanel","New Secondary Side Bar Entry")}),m.push({type:"separator",label:u("sidebar","Side Bar")});let I=l.getVisiblePaneCompositeIds(0);m.push(...I.filter(C=>C===i.getViewContainerByViewId(d).id?!1:!i.getViewContainerById(C).rejectAddedViews).map(C=>({id:C,label:i.getViewContainerModel(i.getViewContainerById(C)).title}))),m.push({type:"separator",label:u("panel","Panel")});let y=l.getPinnedPaneCompositeIds(1);m.push(...y.filter(C=>C===i.getViewContainerByViewId(d).id?!1:!i.getViewContainerById(C).rejectAddedViews).map(C=>({id:C,label:i.getViewContainerModel(i.getViewContainerById(C)).title}))),m.push({type:"separator",label:u("secondarySideBar","Secondary Side Bar")});let w=l.getPinnedPaneCompositeIds(2);m.push(...w.filter(C=>C===i.getViewContainerByViewId(d).id?!1:!i.getViewContainerById(C).rejectAddedViews).map(C=>({id:C,label:i.getViewContainerModel(i.getViewContainerById(C)).title}))),h.items=m,p.add(h.onDidAccept(()=>{let C=h.selectedItems[0];C.id==="_.panel.newcontainer"?(i.moveViewToLocation(c,1,this.desc.id),n.openView(d,!0)):C.id==="_.sidebar.newcontainer"?(i.moveViewToLocation(c,0,this.desc.id),n.openView(d,!0)):C.id==="_.auxiliarybar.newcontainer"?(i.moveViewToLocation(c,2,this.desc.id),n.openView(d,!0)):C.id&&(i.moveViewsToContainer([c],i.getViewContainerById(C.id),void 0,this.desc.id),n.openView(d,!0)),h.hide()})),p.add(h.onDidHide(()=>p.dispose())),h.show()}};he(dz);he(class extends Me{constructor(){super({id:"workbench.action.resetFocusedViewLocation",title:ie("resetFocusedViewLocation","Reset Focused View Location"),category:$t.View,f1:!0,precondition:Ks.notEqualsTo("")})}run(r){let t=r.get($i),e=r.get(re),i=r.get(Io),n=r.get(Mi),o=Ks.getValue(e),s=null;if(o!==void 0&&o.trim()!==""&&(s=t.getViewDescriptorById(o)),!s){i.error(u("resetFocusedView.error.noFocusedView","There is no view currently focused."));return}let a=t.getDefaultContainerById(s.id);!a||a===t.getViewContainerByViewId(s.id)||(t.moveViewsToContainer([s],a,void 0,this.desc.id),n.openView(s.id,!0))}});var Ua=class extends Me{static RESIZE_INCREMENT=60;resizePart(t,e,i,n){let o;if(n===void 0){let s=i.hasFocus("workbench.parts.editor"),a=i.hasFocus("workbench.parts.sidebar"),l=i.hasFocus("workbench.parts.panel"),d=i.hasFocus("workbench.parts.auxiliarybar");a?o="workbench.parts.sidebar":l?o="workbench.parts.panel":s?o="workbench.parts.editor":d&&(o="workbench.parts.auxiliarybar")}else o=n;o&&i.resizePart(o,t,e)}},aQ=class extends Ua{constructor(){super({id:"workbench.action.increaseViewSize",title:ie("increaseViewSize","Increase Current View Size"),f1:!0,precondition:jl.toNegated()})}run(t){this.resizePart(Ua.RESIZE_INCREMENT,Ua.RESIZE_INCREMENT,t.get(ii))}},lQ=class extends Ua{constructor(){super({id:"workbench.action.increaseViewWidth",title:ie("increaseEditorWidth","Increase Editor Width"),f1:!0,precondition:jl.toNegated()})}run(t){this.resizePart(Ua.RESIZE_INCREMENT,0,t.get(ii),"workbench.parts.editor")}},dQ=class extends Ua{constructor(){super({id:"workbench.action.increaseViewHeight",title:ie("increaseEditorHeight","Increase Editor Height"),f1:!0,precondition:jl.toNegated()})}run(t){this.resizePart(0,Ua.RESIZE_INCREMENT,t.get(ii),"workbench.parts.editor")}},cQ=class extends Ua{constructor(){super({id:"workbench.action.decreaseViewSize",title:ie("decreaseViewSize","Decrease Current View Size"),f1:!0,precondition:jl.toNegated()})}run(t){this.resizePart(-Ua.RESIZE_INCREMENT,-Ua.RESIZE_INCREMENT,t.get(ii))}},uQ=class extends Ua{constructor(){super({id:"workbench.action.decreaseViewWidth",title:ie("decreaseEditorWidth","Decrease Editor Width"),f1:!0,precondition:jl.toNegated()})}run(t){this.resizePart(-Ua.RESIZE_INCREMENT,0,t.get(ii),"workbench.parts.editor")}},pQ=class extends Ua{constructor(){super({id:"workbench.action.decreaseViewHeight",title:ie("decreaseEditorHeight","Decrease Editor Height"),f1:!0,precondition:jl.toNegated()})}run(t){this.resizePart(0,-Ua.RESIZE_INCREMENT,t.get(ii),"workbench.parts.editor")}};he(aQ);he(lQ);he(dQ);he(cQ);he(uQ);he(pQ);function xDe(r){return r.iconA!==void 0}var yT=(r,t,e,i)=>({id:r,active:t,label:e,visualIcon:i,activeIcon:N.eye,inactiveIcon:N.eyeClosed,activeAriaLabel:u("selectToHide","Select to Hide"),inactiveAriaLabel:u("selectToShow","Select to Show"),useButtons:!0}),Lg=(r,t,e,i)=>({id:r,active:t,label:e,visualIcon:i,activeIcon:N.check,activeAriaLabel:u("active","Active"),useButtons:!1}),TDe=P.and(Bd.toNegated(),P.notEquals("config.window.menuBarVisibility","hidden"),P.notEquals("config.window.menuBarVisibility","toggle"),P.notEquals("config.window.menuBarVisibility","compact")),cz=[];(!ye||!Po)&&cz.push(yT("workbench.action.toggleMenuBar",TDe,u("menuBar","Menu Bar"),cDe));cz.push(yT(EDe,P.notEquals("config.workbench.activityBar.location","hidden"),u("activityBar","Activity Bar"),{whenA:P.equals("config.workbench.sideBar.location","left"),iconA:uDe,iconB:pDe}),yT(fv.ID,db,u("sideBar","Primary Side Bar"),{whenA:P.equals("config.workbench.sideBar.location","left"),iconA:oz,iconB:rz}),yT(gv.ID,ph,u("secondarySideBar","Secondary Side Bar"),{whenA:P.equals("config.workbench.sideBar.location","left"),iconA:rz,iconB:oz}),yT(eS.ID,QI,u("panel","Panel"),gDe),yT(tS.ID,P.equals("config.workbench.statusBar.visible",!0),u("statusBar","Status Bar"),fDe));var Xhe=[Lg(lz.ID,P.equals("config.workbench.sideBar.location","left"),u("leftSideBar","Left"),oz),Lg(az.ID,P.equals("config.workbench.sideBar.location","right"),u("rightSideBar","Right"),rz)],Yhe=[Lg("workbench.action.alignPanelLeft",hh.isEqualTo("left"),u("leftPanel","Left"),bDe),Lg("workbench.action.alignPanelRight",hh.isEqualTo("right"),u("rightPanel","Right"),vDe),Lg("workbench.action.alignPanelCenter",hh.isEqualTo("center"),u("centerPanel","Center"),IDe),Lg("workbench.action.alignPanelJustify",hh.isEqualTo("justify"),u("justifyPanel","Justify"),yDe)],Qhe=[Lg("workbench.action.toggleFullScreen",ku,u("fullscreen","Full Screen"),SDe),Lg("workbench.action.toggleZenMode",Fd,u("zenMode","Zen Mode"),wDe),Lg("workbench.action.toggleCenteredLayout",Z9,u("centeredLayout","Centered Layout"),CDe)],Zhe=new Set;for(let{active:r}of[...cz,...Xhe,...Yhe,...Qhe])for(let t of r.keys())Zhe.add(t);he(class extends Me{_currentQuickPick;constructor(){super({id:"workbench.action.customizeLayout",title:ie("customizeLayout","Customize Layout..."),f1:!0,icon:jhe,menu:[{id:V.LayoutControlMenuSubmenu,group:"z_end"},{id:V.LayoutControlMenu,when:P.equals("config.workbench.layoutControl.type","both"),group:"z_end"}]})}getItems(t,e){let i=n=>{let o=n.active.evaluate(t.getContext(null)),s=n.useButtons?n.label:n.label+(o&&n.activeIcon?` $(${n.activeIcon.id})`:!o&&n.inactiveIcon?` $(${n.inactiveIcon.id})`:""),a=n.label+(o&&n.activeAriaLabel?` (${n.activeAriaLabel})`:!o&&n.inactiveAriaLabel?` (${n.inactiveAriaLabel})`:"");if(n.visualIcon){let d=n.visualIcon;xDe(d)&&(d=d.whenA.evaluate(t.getContext(null))?d.iconA:d.iconB),s=`$(${d.id}) ${s}`}let l=o?n.activeIcon:n.inactiveIcon;return{type:"item",id:n.id,label:s,ariaLabel:a,keybinding:e.lookupKeybinding(n.id,t),buttons:n.useButtons?[{alwaysVisible:!1,tooltip:a,iconClass:l?de.asClassName(l):void 0}]:void 0}};return[{type:"separator",label:u("toggleVisibility","Visibility")},...cz.map(i),{type:"separator",label:u("sideBarPosition","Primary Side Bar Position")},...Xhe.map(i),{type:"separator",label:u("panelAlignment","Panel Alignment")},...Yhe.map(i),{type:"separator",label:u("layoutModes","Modes")},...Qhe.map(i)]}run(t){if(this._currentQuickPick){this._currentQuickPick.hide();return}let e=t.get(se),i=t.get(re),n=t.get(ct),o=t.get(ki),s=t.get(Be),a=new B,l=a.add(o.createQuickPick({useSeparators:!0}));this._currentQuickPick=l,l.items=this.getItems(i,s),l.ignoreFocusOut=!0,l.hideInput=!0,l.title=u("customizeLayoutQuickPickTitle","Customize Layout");let d={alwaysVisible:!0,iconClass:de.asClassName(N.close),tooltip:u("close","Close")},c={alwaysVisible:!0,iconClass:de.asClassName(N.discard),tooltip:u("restore defaults","Restore Defaults")};l.buttons=[c,d];let p;a.add(i.onDidChangeContext(h=>{h.affectsSome(Zhe)&&(l.items=this.getItems(i,s),p&&(l.activeItems=l.items.filter(m=>m.id===p?.id)),setTimeout(()=>o.focus(),0))})),a.add(l.onDidAccept(h=>{l.selectedItems.length&&(p=l.selectedItems[0],n.executeCommand(p.id))})),a.add(l.onDidTriggerItemButton(h=>{h.item&&(p=h.item,n.executeCommand(p.id))})),a.add(l.onDidTriggerButton(h=>{if(h===d)l.hide();else if(h===c){let m=f=>{let g=e.inspect(f);e.updateValue(f,g.defaultValue)};m("workbench.activityBar.location"),m("workbench.sideBar.location"),m("workbench.statusBar.visible"),m("workbench.panel.defaultLocation"),(!ye||!Po)&&m("window.menuBarVisibility"),n.executeCommand("workbench.action.alignPanelCenter")}})),a.add(l.onDidHide(()=>{l.dispose()})),a.add(l.onDispose(()=>{this._currentQuickPick=void 0,a.dispose()})),l.show()}});var uz=class r extends R{constructor(e){super();this.storageService=e;this.restoreState(),this.registerListeners()}static HIDDEN_ENTRIES_KEY="workbench.statusbar.hidden";_onDidChangeEntryVisibility=this._register(new x);onDidChangeEntryVisibility=this._onDidChangeEntryVisibility.event;_entries=[];get entries(){return this._entries.slice(0)}_lastFocusedEntry;get lastFocusedEntry(){return this._lastFocusedEntry&&!this.isHidden(this._lastFocusedEntry.id)?this._lastFocusedEntry:void 0}hidden=new Set;restoreState(){let e=this.storageService.get(r.HIDDEN_ENTRIES_KEY,0);if(e)try{this.hidden=new Set(JSON.parse(e))}catch{}}registerListeners(){this._register(this.storageService.onDidChangeValue(0,r.HIDDEN_ENTRIES_KEY,this._register(new B))(()=>this.onDidStorageValueChange()))}onDidStorageValueChange(){let e=new Set(this.hidden);this.hidden.clear(),this.restoreState();let i=new Set;for(let n of e)this.hidden.has(n)||i.add(n);for(let n of this.hidden)e.has(n)||i.add(n);if(i.size>0)for(let n of this._entries)i.has(n.id)&&(this.updateVisibility(n.id,!0),i.delete(n.id))}add(e){this._entries.push(e),this.updateVisibility(e,!1),this.sort(),this.markFirstLastVisibleEntry()}remove(e){let i=this._entries.indexOf(e);i>=0&&(this._entries.splice(i,1),this._entries.some(n=>iS(n.priority.primary)&&n.priority.primary.id===e.id)&&this.sort(),this.markFirstLastVisibleEntry())}isHidden(e){return this.hidden.has(e)}hide(e){this.hidden.has(e)||(this.hidden.add(e),this.updateVisibility(e,!0),this.saveState())}show(e){this.hidden.has(e)&&(this.hidden.delete(e),this.updateVisibility(e,!0),this.saveState())}findEntry(e){return this._entries.find(i=>i.container===e)}getEntries(e){return this._entries.filter(i=>i.alignment===e)}focusNextEntry(){this.focusEntry(1,0)}focusPreviousEntry(){this.focusEntry(-1,this.entries.length-1)}isEntryFocused(){return!!this.getFocusedEntry()}getFocusedEntry(){return this._entries.find(e=>uf(e.container))}focusEntry(e,i){let n=a=>{let l=a,d=l>=0&&l<this._entries.length?this._entries[l]:void 0;for(;d&&this.isHidden(d.id);)l+=e,d=l>=0&&l<this._entries.length?this._entries[l]:void 0;return d},o=this.getFocusedEntry();if(o){let a=n(this._entries.indexOf(o)+e);if(a){this._lastFocusedEntry=a,a.labelContainer.focus();return}}let s=n(i);s&&(this._lastFocusedEntry=s,s.labelContainer.focus())}updateVisibility(e,i){if(typeof e=="string"){let n=e;for(let o of this._entries)o.id===n&&this.updateVisibility(o,i)}else{let n=e,o=this.isHidden(n.id);o?ji(n.container):rn(n.container),i&&this._onDidChangeEntryVisibility.fire({id:n.id,visible:!o}),this.markFirstLastVisibleEntry()}}saveState(){this.hidden.size>0?this.storageService.store(r.HIDDEN_ENTRIES_KEY,JSON.stringify(Array.from(this.hidden.values())),0,0):this.storageService.remove(r.HIDDEN_ENTRIES_KEY,0)}sort(){let e=new Map,i=new Map;for(let s=0;s<this._entries.length;s++){let a=this._entries[s];if(typeof a.priority.primary=="number")e.set(a,s);else{let l=a.priority.primary.id,d=i.get(l);if(!d){for(let c of i.values())if(c.has(l)){d=c;break}d||(d=new Map,i.set(l,d))}d.set(a.id,a)}}let n=Array.from(e.keys());n.sort((s,a)=>s.alignment===a.alignment?s.priority.primary!==a.priority.primary?Number(a.priority.primary)-Number(s.priority.primary):s.priority.secondary!==a.priority.secondary?a.priority.secondary-s.priority.secondary:e.get(s)-e.get(a):s.alignment===0?-1:a.alignment===0?1:0);let o;if(i.size>0){o=[];for(let s of n){let a=i.get(s.id),l=a?Array.from(a.values()):void 0;l&&o.push(...l.filter(d=>iS(d.priority.primary)&&d.priority.primary.alignment===0)),o.push(s),l&&o.push(...l.filter(d=>iS(d.priority.primary)&&d.priority.primary.alignment===1)),i.delete(s.id)}for(let[,s]of i)o.push(...s.values())}else o=n;this._entries=o}markFirstLastVisibleEntry(){this.doMarkFirstLastVisibleStatusbarItem(this.getEntries(0)),this.doMarkFirstLastVisibleStatusbarItem(this.getEntries(1))}doMarkFirstLastVisibleStatusbarItem(e){let i,n;for(let o of e)o.container.classList.remove("first-visible-item","last-visible-item"),!this.isHidden(o.id)&&(i||(i=o),n=o);i?.container.classList.add("first-visible-item"),n?.container.classList.add("last-visible-item")}};var pz=class extends et{constructor(e,i,n){super(e,i,void 0,!0);this.model=n;this.checked=!n.isHidden(e)}async run(){this.model.isHidden(this.id)?this.model.show(this.id):this.model.hide(this.id)}},hz=class extends et{constructor(e,i,n){super(e,u("hide","Hide '{0}'",i),void 0,!0);this.model=n}async run(){this.model.hide(this.id)}};wt.registerCommandAndKeybindingRule({id:"workbench.statusBar.focusPrevious",weight:200,primary:15,secondary:[16],when:cb,handler:r=>{r.get(Zd).focusPreviousEntry()}});wt.registerCommandAndKeybindingRule({id:"workbench.statusBar.focusNext",weight:200,primary:17,secondary:[18],when:cb,handler:r=>{r.get(Zd).focusNextEntry()}});wt.registerCommandAndKeybindingRule({id:"workbench.statusBar.focusFirst",weight:200,primary:14,when:cb,handler:r=>{let t=r.get(Zd);t.focus(!1),t.focusNextEntry()}});wt.registerCommandAndKeybindingRule({id:"workbench.statusBar.focusLast",weight:200,primary:13,when:cb,handler:r=>{let t=r.get(Zd);t.focus(!1),t.focusPreviousEntry()}});wt.registerCommandAndKeybindingRule({id:"workbench.statusBar.clearFocus",weight:200,primary:9,when:cb,handler:r=>{let t=r.get(Zd),e=r.get($e);t.isEntryFocused()?t.focus(!1):e.activeEditorPane&&e.activeEditorPane.focus()}});var hQ=class extends Me{constructor(){super({id:"workbench.action.focusStatusBar",title:ie("focusStatusBar","Focus Status Bar"),category:$t.View,f1:!0})}async run(t){t.get(ii).focusPart("workbench.parts.statusbar",Gr())}};he(hQ);var mz=class{constructor(t){this._container=t}hover;set text(t){bo(this._container,...zl(t??""))}set title(t){!this.hover&&t?this.hover=Bo().setupManagedHover(gt("mouse"),this._container,t):this.hover&&this.hover.update(t)}dispose(){this.hover?.dispose()}};var ST=class extends R{constructor(e,i,n,o,s,a,l,d){super();this.container=e;this.hoverDelegate=n;this.commandService=o;this.hoverService=s;this.notificationService=a;this.telemetryService=l;this.themeService=d;this.labelContainer=document.createElement("a"),this.labelContainer.tabIndex=-1,this.labelContainer.setAttribute("role","button"),this.labelContainer.className="statusbar-item-label",this._register(yi.addTarget(this.labelContainer)),this.label=this._register(new mQ(this.labelContainer)),this.container.appendChild(this.labelContainer),this.beakContainer=document.createElement("div"),this.beakContainer.className="status-bar-item-beak-container",this.container.appendChild(this.beakContainer),this.update(i)}label;entry=void 0;foregroundListener=this._register(new yt);backgroundListener=this._register(new yt);commandMouseListener=this._register(new yt);commandTouchListener=this._register(new yt);commandKeyboardListener=this._register(new yt);focusListener=this._register(new yt);focusOutListener=this._register(new yt);hover=void 0;labelContainer;beakContainer;get name(){return Yt(this.entry).name}get hasCommand(){return typeof this.entry?.command<"u"}update(e){if(this.label.showProgress=e.showProgress??!1,(!this.entry||e.text!==this.entry.text)&&(this.label.text=e.text,e.text?rn(this.labelContainer):ji(this.labelContainer)),(!this.entry||e.ariaLabel!==this.entry.ariaLabel)&&(this.container.setAttribute("aria-label",e.ariaLabel),this.labelContainer.setAttribute("aria-label",e.ariaLabel)),(!this.entry||e.role!==this.entry.role)&&this.labelContainer.setAttribute("role",e.role||"button"),!this.entry||!this.isEqualTooltip(this.entry,e)){let n=ya(e.tooltip)?{markdown:e.tooltip,markdownNotSupportedFallback:void 0}:e.tooltip;this.hover?this.hover.update(n):this.hover=this._register(this.hoverService.setupManagedHover(this.hoverDelegate,this.container,n)),e.command!==gz&&(this.focusListener.value=F(this.labelContainer,Q.FOCUS,o=>{Ve.stop(o),this.hover?.show(!1)}),this.focusOutListener.value=F(this.labelContainer,Q.FOCUS_OUT,o=>{Ve.stop(o),this.hover?.hide()}))}if(!this.entry||e.command!==this.entry.command){this.commandMouseListener.clear(),this.commandTouchListener.clear(),this.commandKeyboardListener.clear();let n=e.command;n&&(n!==gz||this.hover)?(this.commandMouseListener.value=F(this.labelContainer,Q.CLICK,()=>this.executeCommand(n)),this.commandTouchListener.value=F(this.labelContainer,At.Tap,()=>this.executeCommand(n)),this.commandKeyboardListener.value=F(this.labelContainer,Q.KEY_DOWN,o=>{let s=new ut(o);s.equals(10)||s.equals(3)?(Ve.stop(o),this.executeCommand(n)):(s.equals(9)||s.equals(15)||s.equals(17))&&(Ve.stop(o),this.hover?.hide())}),this.labelContainer.classList.remove("disabled")):this.labelContainer.classList.add("disabled")}(!this.entry||e.showBeak!==this.entry.showBeak)&&(e.showBeak?this.container.classList.add("has-beak"):this.container.classList.remove("has-beak"));let i=!!e.backgroundColor||e.kind&&e.kind!=="standard";if(!this.entry||e.kind!==this.entry.kind){for(let n of eme)this.container.classList.remove(`${n}-kind`);e.kind&&e.kind!=="standard"&&this.container.classList.add(`${e.kind}-kind`),this.container.classList.toggle("has-background-color",i)}(!this.entry||e.color!==this.entry.color)&&this.applyColor(this.labelContainer,e.color),(!this.entry||e.backgroundColor!==this.entry.backgroundColor)&&(this.container.classList.toggle("has-background-color",i),this.applyColor(this.container,e.backgroundColor,!0)),this.entry=e}isEqualTooltip({tooltip:e},{tooltip:i}){return e===void 0?i===void 0:ya(e)?ya(i)&&YA(e,i):e===i}async executeCommand(e){if(e===gz)this.hover?.show(!0);else{let i=typeof e=="string"?e:e.id,n=typeof e=="string"?[]:e.arguments??[];this.telemetryService.publicLog2("workbenchActionExecuted",{id:i,from:"status bar"});try{await this.commandService.executeCommand(i,...n)}catch(o){this.notificationService.error(PI(o))}}}applyColor(e,i,n){let o;if(n?this.backgroundListener.clear():this.foregroundListener.clear(),i)if(tne(i)){o=this.themeService.getColorTheme().getColor(i.id)?.toString();let s=this.themeService.onDidColorThemeChange(a=>{let l=a.getColor(i.id)?.toString();n?e.style.backgroundColor=l??"":e.style.color=l??""});n?this.backgroundListener.value=s:this.foregroundListener.value=s}else o=i;n?e.style.backgroundColor=o??"":e.style.color=o??""}};ST=E([b(3,ct),b(4,Nt),b(5,mi),b(6,Tt),b(7,Fe)],ST);var mQ=class extends mz{constructor(e){super(e);this.container=e}progressCodicon=Eu(D8);currentText="";currentShowProgress=!1;set showProgress(e){this.currentShowProgress!==e&&(this.currentShowProgress=e,this.progressCodicon=Eu(e==="syncing"?D8:qoe),this.text=this.currentText)}set text(e){if(this.currentShowProgress){this.container.firstChild!==this.progressCodicon&&this.container.appendChild(this.progressCodicon);for(let n of Array.from(this.container.childNodes))n!==this.progressCodicon&&n.remove();let i=e??"";i&&(i=` ${i}`),U(this.container,...zl(i))}else super.text=e}};var Xh=class extends Ew{constructor(e,i,n,o,s,a,l,d){super(e,{hasTitle:!1},n,s,a);this.instantiationService=i;this.contextService=o;this.storageService=s;this.contextMenuService=l;this.contextKeyService=d;this.registerListeners()}static HEIGHT=22;minimumWidth=0;maximumWidth=Number.POSITIVE_INFINITY;minimumHeight=Xh.HEIGHT;maximumHeight=Xh.HEIGHT;styleElement;pendingEntries=[];viewModel=this._register(new uz(this.storageService));onDidChangeEntryVisibility=this.viewModel.onDidChangeEntryVisibility;_onWillDispose=this._register(new x);onWillDispose=this._onWillDispose.event;leftItemsContainer;rightItemsContainer;hoverDelegate=this._register(this.instantiationService.createInstance(sh,"element",!0,(e,i)=>({persistence:{hideOnKeyDown:!0,sticky:i}})));compactEntriesDisposable=this._register(new yt);styleOverrides=new Set;registerListeners(){this._register(this.onDidChangeEntryVisibility(()=>this.updateCompactEntries())),this._register(this.contextService.onDidChangeWorkbenchState(()=>this.updateStyles()))}addEntry(e,i,n,o=0){let s;return tme(o)?s=o:s={primary:o,secondary:wr(i)},this.element?this.doAddEntry(e,i,n,s):this.doAddPendingEntry(e,i,n,s)}doAddPendingEntry(e,i,n,o){let s={entry:e,id:i,alignment:n,priority:o};return this.pendingEntries.push(s),{update:l=>{s.accessor?s.accessor.update(l):s.entry=l},dispose:()=>{s.accessor?s.accessor.dispose():this.pendingEntries=this.pendingEntries.filter(l=>l!==s)}}}doAddEntry(e,i,n,o){let s=this.doCreateStatusItem(i,n),a=this.instantiationService.createInstance(ST,s,e,this.hoverDelegate),l=new class{id=i;alignment=n;priority=o;container=s;labelContainer=a.labelContainer;get name(){return a.name}get hasCommand(){return a.hasCommand}},{needsFullRefresh:d}=this.doAddOrRemoveModelEntry(l,!0);return d?this.appendStatusbarEntries():this.appendStatusbarEntry(l),{update:c=>{a.update(c)},dispose:()=>{let{needsFullRefresh:c}=this.doAddOrRemoveModelEntry(l,!1);c?this.appendStatusbarEntries():s.remove(),_e(a)}}}doCreateStatusItem(e,i,...n){let o=document.createElement("div");return o.id=e,o.classList.add("statusbar-item"),n&&o.classList.add(...n),i===1?o.classList.add("right"):o.classList.add("left"),o}doAddOrRemoveModelEntry(e,i){let n=this.viewModel.entries;i?this.viewModel.add(e):this.viewModel.remove(e);let o=this.viewModel.entries;return i?n.splice(o.indexOf(e),0,e):n.splice(n.indexOf(e),1),{needsFullRefresh:!xi(n,o)}}isEntryVisible(e){return!this.viewModel.isHidden(e)}updateEntryVisibility(e,i){i?this.viewModel.show(e):this.viewModel.hide(e)}focusNextEntry(){this.viewModel.focusNextEntry()}focusPreviousEntry(){this.viewModel.focusPreviousEntry()}isEntryFocused(){return this.viewModel.isEntryFocused()}focus(e=!0){this.getContainer()?.focus();let i=this.viewModel.lastFocusedEntry;e&&i&&setTimeout(()=>i.labelContainer.focus(),0)}createContentArea(e){this.element=e;let i=this._register(this.contextKeyService.createScoped(this.element));return cb.bindTo(i).set(!0),this.leftItemsContainer=document.createElement("div"),this.leftItemsContainer.classList.add("left-items","items-container"),this.element.appendChild(this.leftItemsContainer),this.element.tabIndex=0,this.rightItemsContainer=document.createElement("div"),this.rightItemsContainer.classList.add("right-items","items-container"),this.element.appendChild(this.rightItemsContainer),this._register(F(e,Q.CONTEXT_MENU,n=>this.showContextMenu(n))),this._register(yi.addTarget(e)),this._register(F(e,At.Contextmenu,n=>this.showContextMenu(n))),this.createInitialStatusbarEntries(),this.element}createInitialStatusbarEntries(){for(this.appendStatusbarEntries();this.pendingEntries.length;){let e=this.pendingEntries.shift();e&&(e.accessor=this.addEntry(e.entry,e.id,e.alignment,e.priority.primary))}}appendStatusbarEntries(){let e=Yt(this.leftItemsContainer),i=Yt(this.rightItemsContainer);ai(e),ai(i);for(let n of[...this.viewModel.getEntries(0),...this.viewModel.getEntries(1).reverse()])(n.alignment===0?e:i).appendChild(n.container);this.updateCompactEntries()}appendStatusbarEntry(e){let i=this.viewModel.getEntries(e.alignment);e.alignment===1&&i.reverse();let n=Yt(e.alignment===0?this.leftItemsContainer:this.rightItemsContainer),o=i.indexOf(e);o+1===i.length?n.appendChild(e.container):n.insertBefore(e.container,i[o+1].container),this.updateCompactEntries()}updateCompactEntries(){let e=this.viewModel.entries,i=new Map;for(let a of e)this.viewModel.isHidden(a.id)||i.set(a.id,a),a.container.classList.remove("compact-left","compact-right");let n=new Map;for(let a of i.values())if(iS(a.priority.primary)&&a.priority.primary.compact){let l=a.priority.primary.id,d=i.get(l);if(!d)continue;let c=n.get(l);if(!c){for(let p of n.values())if(p.has(l)){c=p;break}c||(c=new Map,n.set(l,c))}c.set(a.id,a),c.set(d.id,d),a.priority.primary.alignment===0?(d.container.classList.add("compact-left"),a.container.classList.add("compact-right")):(d.container.classList.add("compact-right"),a.container.classList.add("compact-left"))}let o=this.getColor(dh),s=this.getColor(Nle);if(this.compactEntriesDisposable.value=new B,o&&s&&!oa(this.theme.type))for(let[,a]of n)for(let l of a.values())l.hasCommand&&(this.compactEntriesDisposable.value.add(F(l.labelContainer,Q.MOUSE_OVER,()=>{a.forEach(d=>d.labelContainer.style.backgroundColor=o),l.labelContainer.style.backgroundColor=s})),this.compactEntriesDisposable.value.add(F(l.labelContainer,Q.MOUSE_OUT,()=>{a.forEach(d=>d.labelContainer.style.backgroundColor="")})))}showContextMenu(e){Ve.stop(e,!0);let i=new _i(ue(this.element),e),n;this.contextMenuService.showContextMenu({getAnchor:()=>i,getActions:()=>(n=this.getContextMenuActions(i),n),onHide:()=>{n&&QM(n)}})}getContextMenuActions(e){let i=[];i.push(fn({id:tS.ID,label:u("hideStatusBar","Hide Status Bar"),run:()=>this.instantiationService.invokeFunction(s=>new tS().run(s))})),i.push(new Qt);let n=new Set;for(let s of this.viewModel.entries)n.has(s.id)||(i.push(new pz(s.id,s.name,this.viewModel)),n.add(s.id));let o;for(let s=e.target;s;s=s.parentElement){let a=this.viewModel.findEntry(s);if(a){o=a;break}}return o&&(i.push(new Qt),i.push(new hz(o.id,o.name,this.viewModel))),i}updateStyles(){super.updateStyles();let e=Yt(this.getContainer()),i=[...this.styleOverrides].sort((d,c)=>d.priority-c.priority)[0],n=this.getColor(i?.background??(this.contextService.getWorkbenchState()!==1?Rle:Ple))||"";e.style.backgroundColor=n;let o=this.getColor(i?.foreground??(this.contextService.getWorkbenchState()!==1?$l:Lle))||"";e.style.color=o;let s=this.getColor(Ole),a=this.getColor(i?.border??(this.contextService.getWorkbenchState()!==1?gL:Ale))||this.getColor(Oe);a?(e.classList.add("status-border-top"),e.style.setProperty("--status-border-top-color",a)):(e.classList.remove("status-border-top"),e.style.removeProperty("--status-border-top-color"));let l=this.getColor(Mle);this.styleElement||(this.styleElement=Go(e)),this.styleElement.textContent=`

				/* Status bar focus outline */
				.monaco-workbench .part.statusbar:focus {
					outline-color: ${l};
				}

				/* Status bar item focus outline */
				.monaco-workbench .part.statusbar > .items-container > .statusbar-item a:focus-visible {
					outline: 1px solid ${this.getColor(fi)??s};
					outline-offset: ${a?"-2px":"-1px"};
				}

				/* Notification Beak */
				.monaco-workbench .part.statusbar > .items-container > .statusbar-item.has-beak > .status-bar-item-beak-container:before {
					border-bottom-color: ${n};
				}
			`}layout(e,i,n,o){super.layout(e,i,n,o),super.layoutContents(e,i)}overrideStyle(e){return this.styleOverrides.add(e),this.updateStyles(),le(()=>{this.styleOverrides.delete(e),this.updateStyles()})}toJSON(){return{type:"workbench.parts.statusbar"}}dispose(){this._onWillDispose.fire(),super.dispose()}};Xh=E([b(1,ne),b(2,Fe),b(3,kt),b(4,nt),b(5,ii),b(6,vt),b(7,re)],Xh);var UP=class extends Xh{constructor(t,e,i,n,o,s,a){super("workbench.parts.statusbar",t,e,i,n,o,s,a)}};UP=E([b(0,ne),b(1,Fe),b(2,kt),b(3,nt),b(4,ii),b(5,vt),b(6,re)],UP);var nS=class extends Xh{constructor(e,i,n,o,s,a,l,d){let c=nS.COUNTER++;super(`workbench.parts.auxiliaryStatus.${c}`,i,n,o,s,a,l,d);this.container=e}static COUNTER=1;height=Xh.HEIGHT};nS=E([b(1,ne),b(2,Fe),b(3,kt),b(4,nt),b(5,ii),b(6,vt),b(7,re)],nS);var zP=class extends xw{constructor(e,i,n){super("workbench.statusBarService",n,i);this.instantiationService=e;this._register(this.registerPart(this.mainPart))}mainPart=this._register(this.instantiationService.createInstance(UP));_onDidCreateAuxiliaryStatusbarPart=this._register(new x);onDidCreateAuxiliaryStatusbarPart=this._onDidCreateAuxiliaryStatusbarPart.event;createAuxiliaryStatusbarPart(e){let i=document.createElement("footer");i.classList.add("part","statusbar"),i.setAttribute("role","status"),i.style.position="relative",i.setAttribute("aria-live","off"),i.setAttribute("tabindex","0"),e.appendChild(i);let n=this.instantiationService.createInstance(nS,i),o=this.registerPart(n);return n.create(i),X.once(n.onWillDispose)(()=>o.dispose()),this._onDidCreateAuxiliaryStatusbarPart.fire(n),n}createScoped(e,i){return i.add(this.instantiationService.createInstance(KP,e))}onDidChangeEntryVisibility=this.mainPart.onDidChangeEntryVisibility;addEntry(e,i,n,o=0){return e.showInAllWindows?this.doAddEntryToAllWindows(e,i,n,o):this.mainPart.addEntry(e,i,n,o)}doAddEntryToAllWindows(e,i,n,o=0){let s=new B,a=new Set;function l(d){let c=new B;c.add(d.onWillDispose(()=>c.dispose()));let p=c.add(d.addEntry(e,i,n,o));a.add(p),c.add(le(()=>a.delete(p))),s.add(c),c.add(le(()=>s.delete(c)))}for(let d of this.parts)l(d);return s.add(this.onDidCreateAuxiliaryStatusbarPart(d=>l(d))),{update:d=>{for(let c of a)c.update(d)},dispose:()=>s.dispose()}}isEntryVisible(e){return this.mainPart.isEntryVisible(e)}updateEntryVisibility(e,i){for(let n of this.parts)n.updateEntryVisibility(e,i)}focus(e){this.activePart.focus(e)}focusNextEntry(){this.activePart.focusNextEntry()}focusPreviousEntry(){this.activePart.focusPreviousEntry()}isEntryFocused(){return this.activePart.isEntryFocused()}overrideStyle(e){let i=new B;for(let n of this.parts)i.add(n.overrideStyle(e));return i}};zP=E([b(0,ne),b(1,nt),b(2,Fe)],zP);var KP=class extends R{constructor(e,i){super();this.statusbarEntryContainer=e;this.statusbarService=i}createAuxiliaryStatusbarPart(e){return this.statusbarService.createAuxiliaryStatusbarPart(e)}createScoped(e,i){return this.statusbarService.createScoped(e,i)}getPart(){return this.statusbarEntryContainer}onDidChangeEntryVisibility=this.statusbarEntryContainer.onDidChangeEntryVisibility;addEntry(e,i,n,o=0){return this.statusbarEntryContainer.addEntry(e,i,n,o)}isEntryVisible(e){return this.statusbarEntryContainer.isEntryVisible(e)}updateEntryVisibility(e,i){this.statusbarEntryContainer.updateEntryVisibility(e,i)}focus(e){this.statusbarEntryContainer.focus(e)}focusNextEntry(){this.statusbarEntryContainer.focusNextEntry()}focusPreviousEntry(){this.statusbarEntryContainer.focusPreviousEntry()}isEntryFocused(){return this.statusbarEntryContainer.isEntryFocused()}overrideStyle(e){return this.statusbarEntryContainer.overrideStyle(e)}};KP=E([b(1,Zd)],KP);gi(Zd,zP,0);var Zd=q("statusbarService");function iS(r){let t=r;return typeof t?.id=="string"&&typeof t.alignment=="number"}function tme(r){let t=r;return(typeof t?.primary=="number"||iS(t?.primary))&&typeof t?.secondary=="number"}var gz={id:"statusBar.entry.showTooltip",title:""},eme=["standard","warning","error","prominent","remote","offline"];var CT=class{constructor(t,e,i){this.statusBarService=t;this.debugService=e;let n=()=>{this.entryAccessor=this.statusBarService.addEntry(this.entry,"status.debug",0,30)},o=()=>{this.showInStatusBar=i.getValue("debug").showInStatusBar,this.showInStatusBar==="always"&&!this.entryAccessor&&n()};o(),this.toDispose.push(this.debugService.onDidChangeState(s=>{s!==0&&this.showInStatusBar==="onFirstSessionStart"&&!this.entryAccessor&&n()})),this.toDispose.push(i.onDidChangeConfiguration(s=>{s.affectsConfiguration("debug.showInStatusBar")&&(o(),this.entryAccessor&&this.showInStatusBar==="never"&&(this.entryAccessor.dispose(),this.entryAccessor=void 0))})),this.toDispose.push(this.debugService.getConfigurationManager().onDidSelectConfiguration(s=>{this.entryAccessor?.update(this.entry)}))}showInStatusBar;toDispose=[];entryAccessor;get entry(){let t="",e=this.debugService.getConfigurationManager(),i=e.selectedConfiguration.name||"";return i&&e.selectedConfiguration.launch&&(t=e.getLaunches().length>1?`${i} (${e.selectedConfiguration.launch.name})`:i),{name:u("status.debug","Debug"),text:"$(debug-alt-small) "+t,ariaLabel:u("debugTarget","Debug: {0}",t),tooltip:u("selectAndStartDebug","Select and start debug configuration"),command:"workbench.action.debug.selectandstart"}}dispose(){this.entryAccessor?.dispose(),_e(this.toDispose)}};CT=E([b(0,Zd),b(1,we),b(2,se)],CT);var ime=q("updateService");var wT=J;var fz=class r extends R{constructor(e,i,n){super();this.container=e;this.options=i;this.menuStyle=n;this.container.setAttribute("role","menubar"),this.isCompact&&this.container.classList.add("compact"),this.menus=[],this.mnemonics=new Map,this._focusState=1,this._onVisibilityChange=this._register(new x),this._onFocusStateChange=this._register(new x),this.createOverflowMenu(),this.menuUpdater=this._register(new Ye(()=>this.update(),200)),this.actionRunner=this.options.actionRunner??this._register(new jo),this._register(this.actionRunner.onWillRun(()=>{this.setUnfocusedState()})),this._register(eu.getInstance().event(this.onModifierKeyToggled,this)),this._register(F(this.container,Q.KEY_DOWN,s=>{let a=new ut(s),l=!0,d=s.key?s.key.toLocaleLowerCase():"",c=ye&&!this.isCompact;if(a.equals(15)||c&&a.equals(1026))this.focusPrevious();else if(a.equals(17)||c&&a.equals(2))this.focusNext();else if(a.equals(9)&&this.isFocused&&!this.isOpen)this.setUnfocusedState();else if(!this.isOpen&&!a.ctrlKey&&this.options.enableMnemonics&&this.mnemonicsInUse&&this.mnemonics.has(d)){let p=this.mnemonics.get(d);this.onMenuTriggered(p,!1)}else l=!1;!this.isCompact&&(a.equals(1026)||a.equals(2))&&a.preventDefault(),l&&(a.preventDefault(),a.stopPropagation())}));let o=ue(this.container);this._register(F(o,Q.MOUSE_DOWN,()=>{this.isFocused&&this.setUnfocusedState()})),this._register(F(this.container,Q.FOCUS_IN,s=>{let a=s;a.relatedTarget&&(this.container.contains(a.relatedTarget)||(this.focusToReturn=a.relatedTarget))})),this._register(F(this.container,Q.FOCUS_OUT,s=>{let a=s;a.relatedTarget?a.relatedTarget&&!this.container.contains(a.relatedTarget)&&(this.focusToReturn=void 0,this.setUnfocusedState()):this.setUnfocusedState()})),this._register(F(o,Q.KEY_DOWN,s=>{if(!this.options.enableMnemonics||!s.altKey||s.ctrlKey||s.defaultPrevented)return;let a=s.key.toLocaleLowerCase();if(!this.mnemonics.has(a))return;this.mnemonicsInUse=!0,this.updateMnemonicVisibility(!0);let l=this.mnemonics.get(a);this.onMenuTriggered(l,!1)})),this.setUnfocusedState()}static OVERFLOW_INDEX=-1;menus;overflowMenu;focusedMenu;focusToReturn;menuUpdater;_mnemonicsInUse=!1;openedViaKeyboard=!1;awaitingAltRelease=!1;ignoreNextMouseUp=!1;mnemonics;updatePending=!1;_focusState;actionRunner;_onVisibilityChange;_onFocusStateChange;numMenusShown=0;overflowLayoutScheduled=void 0;menuDisposables=this._register(new B);push(e){Ov(e).forEach(n=>{let o=this.menus.length,s=G1(n.label),a=_w.exec(n.label);if(a){let l=a[1]?a[1]:a[3];this.registerMnemonic(this.menus.length,l)}if(this.isCompact)this.menus.push(n);else{let l=wT("div.menubar-menu-button",{role:"menuitem",tabindex:-1,"aria-label":s,"aria-haspopup":!0}),d=wT("div.menubar-menu-title",{role:"none","aria-hidden":!0});l.appendChild(d),this.container.insertBefore(l,this.overflowMenu.buttonElement),this.updateLabels(d,l,n.label),this._register(F(l,Q.KEY_UP,c=>{let p=new ut(c),h=!0;(p.equals(18)||p.equals(3))&&!this.isOpen?(this.focusedMenu={index:o},this.openedViaKeyboard=!0,this.focusState=3):h=!1,h&&(p.preventDefault(),p.stopPropagation())})),this._register(yi.addTarget(l)),this._register(F(l,At.Tap,c=>{this.isOpen&&this.focusedMenu&&this.focusedMenu.holder&&$n(c.initialTarget,this.focusedMenu.holder)||(this.ignoreNextMouseUp=!1,this.onMenuTriggered(o,!0),c.preventDefault(),c.stopPropagation())})),this._register(F(l,Q.MOUSE_DOWN,c=>{if(!new _i(ue(l),c).leftButton){c.preventDefault();return}this.isOpen?this.ignoreNextMouseUp=!1:(this.ignoreNextMouseUp=!0,this.onMenuTriggered(o,!0)),c.preventDefault(),c.stopPropagation()})),this._register(F(l,Q.MOUSE_UP,c=>{c.defaultPrevented||(this.ignoreNextMouseUp?this.ignoreNextMouseUp=!1:this.isFocused&&this.onMenuTriggered(o,!0))})),this._register(F(l,Q.MOUSE_ENTER,()=>{this.isOpen&&!this.isCurrentMenu(o)?(l.focus(),this.cleanupCustomMenu(),this.showCustomMenu(o,!1)):this.isFocused&&!this.isOpen&&(this.focusedMenu={index:o},l.focus())})),this.menus.push({label:n.label,actions:n.actions,buttonElement:l,titleElement:d})}})}createOverflowMenu(){let e=this.isCompact?u("mAppMenu","Application Menu"):u("mMore","More"),i=wT("div.menubar-menu-button",{role:"menuitem",tabindex:this.isCompact?0:-1,"aria-label":e,"aria-haspopup":!0}),n=wT("div.menubar-menu-title.toolbar-toggle-more"+de.asCSSSelector(N.menuBarMore),{role:"none","aria-hidden":!0});i.appendChild(n),this.container.appendChild(i),i.style.visibility="hidden",this._register(F(i,Q.KEY_UP,o=>{let s=new ut(o),a=!0,l=[3];this.isCompact?(l.push(10),this.options.compactMode?.horizontal===0?l.push(17):this.options.compactMode?.horizontal===1&&l.push(15)):l.push(18),l.some(d=>s.equals(d))&&!this.isOpen?(this.focusedMenu={index:r.OVERFLOW_INDEX},this.openedViaKeyboard=!0,this.focusState=3):a=!1,a&&(s.preventDefault(),s.stopPropagation())})),this._register(yi.addTarget(i)),this._register(F(i,At.Tap,o=>{this.isOpen&&this.focusedMenu&&this.focusedMenu.holder&&$n(o.initialTarget,this.focusedMenu.holder)||(this.ignoreNextMouseUp=!1,this.onMenuTriggered(r.OVERFLOW_INDEX,!0),o.preventDefault(),o.stopPropagation())})),this._register(F(i,Q.MOUSE_DOWN,o=>{if(!new _i(ue(i),o).leftButton){o.preventDefault();return}this.isOpen?this.ignoreNextMouseUp=!1:(this.ignoreNextMouseUp=!0,this.onMenuTriggered(r.OVERFLOW_INDEX,!0)),o.preventDefault(),o.stopPropagation()})),this._register(F(i,Q.MOUSE_UP,o=>{o.defaultPrevented||(this.ignoreNextMouseUp?this.ignoreNextMouseUp=!1:this.isFocused&&this.onMenuTriggered(r.OVERFLOW_INDEX,!0))})),this._register(F(i,Q.MOUSE_ENTER,()=>{this.isOpen&&!this.isCurrentMenu(r.OVERFLOW_INDEX)?(this.overflowMenu.buttonElement.focus(),this.cleanupCustomMenu(),this.showCustomMenu(r.OVERFLOW_INDEX,!1)):this.isFocused&&!this.isOpen&&(this.focusedMenu={index:r.OVERFLOW_INDEX},i.focus())})),this.overflowMenu={buttonElement:i,titleElement:n,label:"More",actions:[]}}updateMenu(e){let i=this.menus.filter(n=>n.label===e.label);i&&i.length&&(i[0].actions=e.actions)}dispose(){super.dispose(),this.menus.forEach(e=>{e.titleElement?.remove(),e.buttonElement?.remove()}),this.overflowMenu.titleElement.remove(),this.overflowMenu.buttonElement.remove(),_e(this.overflowLayoutScheduled),this.overflowLayoutScheduled=void 0}blur(){this.setUnfocusedState()}getWidth(){if(!this.isCompact&&this.menus){let e=this.menus[0].buttonElement.getBoundingClientRect().left;return(this.hasOverflow?this.overflowMenu.buttonElement.getBoundingClientRect().right:this.menus[this.menus.length-1].buttonElement.getBoundingClientRect().right)-e}return 0}getHeight(){return this.container.clientHeight}toggleFocus(){!this.isFocused&&this.options.visibility!=="hidden"?(this.mnemonicsInUse=!0,this.focusedMenu={index:this.numMenusShown>0?0:r.OVERFLOW_INDEX},this.focusState=2):this.isOpen||this.setUnfocusedState()}updateOverflowAction(){if(!this.menus||!this.menus.length)return;let e="overflow-menu-only";this.container.classList.toggle(e,!1);let i=this.container.offsetWidth,n=0,o=this.isCompact,s=this.numMenusShown;this.numMenusShown=0;let a=this.menus.filter(l=>l.buttonElement!==void 0&&l.titleElement!==void 0);for(let l of a){if(!o){let d=l.buttonElement.offsetWidth;n+d>i?o=!0:(n+=d,this.numMenusShown++,this.numMenusShown>s&&(l.buttonElement.style.visibility="visible"))}o&&(l.buttonElement.style.visibility="hidden")}if(this.numMenusShown-1<=a.length/4){for(let l of a)l.buttonElement.style.visibility="hidden";o=!0,this.numMenusShown=0,n=0}if(this.isCompact){this.overflowMenu.actions=[];for(let d=this.numMenusShown;d<this.menus.length;d++)this.overflowMenu.actions.push(new vo(`menubar.submenu.${this.menus[d].label}`,this.menus[d].label,this.menus[d].actions||[]));let l=this.options.getCompactMenuActions?.();l&&l.length&&(this.overflowMenu.actions.push(new Qt),this.overflowMenu.actions.push(...l)),this.overflowMenu.buttonElement.style.visibility="visible"}else if(o){for(;n+this.overflowMenu.buttonElement.offsetWidth>i&&this.numMenusShown>0;){this.numMenusShown--;let l=a[this.numMenusShown].buttonElement.offsetWidth;a[this.numMenusShown].buttonElement.style.visibility="hidden",n-=l}this.overflowMenu.actions=[];for(let l=this.numMenusShown;l<a.length;l++)this.overflowMenu.actions.push(new vo(`menubar.submenu.${a[l].label}`,a[l].label,a[l].actions||[]));this.overflowMenu.buttonElement.nextElementSibling!==a[this.numMenusShown].buttonElement&&(this.overflowMenu.buttonElement.remove(),this.container.insertBefore(this.overflowMenu.buttonElement,a[this.numMenusShown].buttonElement)),this.overflowMenu.buttonElement.style.visibility="visible"}else this.overflowMenu.buttonElement.remove(),this.container.appendChild(this.overflowMenu.buttonElement),this.overflowMenu.buttonElement.style.visibility="hidden";this.container.classList.toggle(e,this.numMenusShown===0)}updateLabels(e,i,n){let o=G1(n);if(this.options.enableMnemonics){let a=Cp(n);UI.lastIndex=0;let l=UI.exec(a);for(;l&&l[1];)l=UI.exec(a);let d=c=>c.replace(/&amp;&amp;/g,"&amp;");l?(e.innerText="",e.append(wp(d(a.substr(0,l.index))," "),wT("mnemonic",{"aria-hidden":"true"},l[3]),Qg(d(a.substr(l.index+l[0].length))," "))):e.innerText=d(a).trim()}else e.innerText=o.replace(/&&/g,"&");let s=_w.exec(n);if(s){let a=s[1]?s[1]:s[3];this.options.enableMnemonics?i.setAttribute("aria-keyshortcuts","Alt+"+a.toLocaleLowerCase()):i.removeAttribute("aria-keyshortcuts")}}update(e){if(e&&(this.options=e),this.isFocused){this.updatePending=!0;return}this.menus.forEach(i=>{!i.buttonElement||!i.titleElement||this.updateLabels(i.titleElement,i.buttonElement,i.label)}),this.overflowLayoutScheduled||(this.overflowLayoutScheduled=eo(ue(this.container),()=>{this.updateOverflowAction(),this.overflowLayoutScheduled=void 0})),this.setUnfocusedState()}registerMnemonic(e,i){this.mnemonics.set(i.toLocaleLowerCase(),e)}hideMenubar(){this.container.style.display!=="none"&&(this.container.style.display="none",this._onVisibilityChange.fire(!1))}showMenubar(){this.container.style.display!=="flex"&&(this.container.style.display="flex",this._onVisibilityChange.fire(!0),this.updateOverflowAction())}get focusState(){return this._focusState}set focusState(e){if(this._focusState>=2&&e<2&&this.updatePending&&(this.menuUpdater.schedule(),this.updatePending=!1),e===this._focusState)return;let i=this.isVisible,n=this.isOpen,o=this.isFocused;switch(this._focusState=e,e){case 0:i&&this.hideMenubar(),n&&this.cleanupCustomMenu(),o&&(this.focusedMenu=void 0,this.focusToReturn&&(this.focusToReturn.focus(),this.focusToReturn=void 0));break;case 1:i||this.showMenubar(),n&&this.cleanupCustomMenu(),o&&(this.focusedMenu&&(this.focusedMenu.index===r.OVERFLOW_INDEX?this.overflowMenu.buttonElement.blur():this.menus[this.focusedMenu.index].buttonElement?.blur()),this.focusedMenu=void 0,this.focusToReturn&&(this.focusToReturn.focus(),this.focusToReturn=void 0));break;case 2:i||this.showMenubar(),n&&this.cleanupCustomMenu(),this.focusedMenu&&(this.focusedMenu.index===r.OVERFLOW_INDEX?this.overflowMenu.buttonElement.focus():this.menus[this.focusedMenu.index].buttonElement?.focus());break;case 3:i||this.showMenubar(),this.focusedMenu&&(this.cleanupCustomMenu(),this.showCustomMenu(this.focusedMenu.index,this.openedViaKeyboard));break}this._focusState=e,this._onFocusStateChange.fire(this.focusState>=2)}get isVisible(){return this.focusState>=1}get isFocused(){return this.focusState>=2}get isOpen(){return this.focusState>=3}get hasOverflow(){return this.isCompact||this.numMenusShown<this.menus.length}get isCompact(){return this.options.compactMode!==void 0}setUnfocusedState(){this.options.visibility==="toggle"||this.options.visibility==="hidden"?this.focusState=0:this.options.visibility==="classic"&&K_(Ke)?this.focusState=0:this.focusState=1,this.ignoreNextMouseUp=!1,this.mnemonicsInUse=!1,this.updateMnemonicVisibility(!1)}focusPrevious(){if(!this.focusedMenu||this.numMenusShown===0)return;let e=(this.focusedMenu.index-1+this.numMenusShown)%this.numMenusShown;this.focusedMenu.index===r.OVERFLOW_INDEX?e=this.numMenusShown-1:this.focusedMenu.index===0&&this.hasOverflow&&(e=r.OVERFLOW_INDEX),e!==this.focusedMenu.index&&(this.isOpen?(this.cleanupCustomMenu(),this.showCustomMenu(e)):this.isFocused&&(this.focusedMenu.index=e,e===r.OVERFLOW_INDEX?this.overflowMenu.buttonElement.focus():this.menus[e].buttonElement?.focus()))}focusNext(){if(!this.focusedMenu||this.numMenusShown===0)return;let e=(this.focusedMenu.index+1)%this.numMenusShown;this.focusedMenu.index===r.OVERFLOW_INDEX?e=0:this.focusedMenu.index===this.numMenusShown-1&&(e=r.OVERFLOW_INDEX),e!==this.focusedMenu.index&&(this.isOpen?(this.cleanupCustomMenu(),this.showCustomMenu(e)):this.isFocused&&(this.focusedMenu.index=e,e===r.OVERFLOW_INDEX?this.overflowMenu.buttonElement.focus():this.menus[e].buttonElement?.focus()))}updateMnemonicVisibility(e){this.menus&&this.menus.forEach(i=>{if(i.titleElement&&i.titleElement.children.length){let n=i.titleElement.children.item(0);n&&(n.style.textDecoration=this.options.alwaysOnMnemonics||e?"underline":"")}})}get mnemonicsInUse(){return this._mnemonicsInUse}set mnemonicsInUse(e){this._mnemonicsInUse=e}get shouldAltKeyFocus(){return ye?!1:!this.options.disableAltFocus||this.options.visibility==="toggle"}get onVisibilityChange(){return this._onVisibilityChange.event}get onFocusStateChange(){return this._onFocusStateChange.event}onMenuTriggered(e,i){this.isOpen?this.isCurrentMenu(e)?this.setUnfocusedState():(this.cleanupCustomMenu(),this.showCustomMenu(e,this.openedViaKeyboard)):(this.focusedMenu={index:e},this.openedViaKeyboard=!i,this.focusState=3)}onModifierKeyToggled(e){let i=!e.altKey&&!e.ctrlKey&&!e.shiftKey&&!e.metaKey;this.options.visibility!=="hidden"&&(e.event&&this.shouldAltKeyFocus&&YZ.toEnum(e.event.code)===159&&e.event.preventDefault(),this.isFocused&&e.lastKeyPressed==="alt"&&e.altKey&&(this.setUnfocusedState(),this.mnemonicsInUse=!1,this.awaitingAltRelease=!0),i&&e.lastKeyPressed==="alt"&&e.lastKeyReleased==="alt"&&(this.awaitingAltRelease||(!this.isFocused&&this.shouldAltKeyFocus?(this.mnemonicsInUse=!0,this.focusedMenu={index:this.numMenusShown>0?0:r.OVERFLOW_INDEX},this.focusState=2):this.isOpen||this.setUnfocusedState())),!e.altKey&&e.lastKeyReleased==="alt"&&(this.awaitingAltRelease=!1),this.options.enableMnemonics&&this.menus&&!this.isOpen&&this.updateMnemonicVisibility(!this.awaitingAltRelease&&e.altKey||this.mnemonicsInUse))}isCurrentMenu(e){return this.focusedMenu?this.focusedMenu.index===e:!1}cleanupCustomMenu(){this.focusedMenu&&(this.focusedMenu.index===r.OVERFLOW_INDEX?this.overflowMenu.buttonElement.focus():this.menus[this.focusedMenu.index].buttonElement?.focus(),this.focusedMenu.holder&&(this.focusedMenu.holder.parentElement?.classList.remove("open"),this.focusedMenu.holder.remove()),this.focusedMenu.widget?.dispose(),this.focusedMenu={index:this.focusedMenu.index}),this.menuDisposables.clear()}showCustomMenu(e,i=!0){let n=e>=this.numMenusShown?r.OVERFLOW_INDEX:e,o=n===r.OVERFLOW_INDEX?this.overflowMenu:this.menus[n];if(!o.actions||!o.buttonElement||!o.titleElement)return;let s=wT("div.menubar-menu-items-holder",{title:""});o.buttonElement.classList.add("open");let a=o.titleElement.getBoundingClientRect(),l=Y4(o.titleElement);if(this.options.compactMode?.horizontal===0)s.style.left=`${a.left+this.container.clientWidth}px`;else if(this.options.compactMode?.horizontal===1){let p=ue(this.container).innerWidth;s.style.right=`${p-a.left}px`,s.style.left="auto"}else s.style.left=`${a.left*l}px`;this.options.compactMode?.vertical===0?s.style.top=`${a.top-this.menus.length*30+this.container.clientHeight}px`:this.options.compactMode?.vertical===1?s.style.top=`${a.top}px`:s.style.top=`${a.bottom*l}px`,o.buttonElement.appendChild(s);let d={getKeyBinding:this.options.getKeybinding,actionRunner:this.actionRunner,enableMnemonics:this.options.alwaysOnMnemonics||this.mnemonicsInUse&&this.options.enableMnemonics,ariaLabel:o.buttonElement.getAttribute("aria-label")??void 0,expandDirection:this.isCompact?this.options.compactMode:{horizontal:0,vertical:1},useEventAsContext:!0},c=this.menuDisposables.add(new eL(s,o.actions,d,this.menuStyle));this.menuDisposables.add(c.onDidCancel(()=>{this.focusState=2})),n!==e?c.trigger(e-this.numMenusShown):c.focus(i),this.focusedMenu={index:n,holder:s,widget:c}}};var nme="inQuickOpen",Gvo=new A(nme,!1,u("inQuickOpen","Whether keyboard focus is inside the quick open control")),gQ=P.has(nme),kDe="inFilesPicker",qvo=P.and(gQ,P.has(kDe));function fQ(r,t){return e=>{let i=e.get(Be),n=e.get(ki),s={keybindings:i.lookupKeybindings(r)};n.navigate(!!t,s)}}var bz=class extends R{constructor(e,i){super();this.editorService=e;this.editorGroupsService=i}_editorViewState=void 0;openedTransientEditors=new Set;set(){if(this._editorViewState)return;let e=this.editorService.activeEditorPane;e&&(this._editorViewState={group:e.group,editor:e.input,state:Xoe(e.getControl())?.saveViewState()??void 0})}async openTransientEditor(e,i){e.options={...e.options,transient:!0};let n=await this.editorService.openEditor(e,i);return n?.input&&n.input!==this._editorViewState?.editor&&n.group.isTransient(n.input)&&this.openedTransientEditors.add(n.input),n}async restore(){if(this._editorViewState){for(let e of this.openedTransientEditors)if(!e.isDirty())for(let i of this.editorGroupsService.groups)i.isTransient(e)&&await i.closeEditor(e,{preserveFocus:!0});await this._editorViewState.group.openEditor(this._editorViewState.editor,{viewState:this._editorViewState.state,preserveFocus:!0}),this.reset()}}reset(){this._editorViewState=void 0,this.openedTransientEditors.clear()}dispose(){super.dispose(),this.reset()}};bz=E([b(0,$e),b(1,gn)],bz);var ame="inRecentFilesPicker",vz=class extends Me{removeFromRecentlyOpened={iconClass:de.asClassName(N.removeClose),tooltip:u("remove","Remove from Recently Opened")};dirtyRecentlyOpenedFolder={iconClass:"dirty-workspace "+de.asClassName(N.closeDirty),tooltip:u("dirtyRecentlyOpenedFolder","Folder With Unsaved Files"),alwaysVisible:!0};dirtyRecentlyOpenedWorkspace={...this.dirtyRecentlyOpenedFolder,tooltip:u("dirtyRecentlyOpenedWorkspace","Workspace With Unsaved Files")};constructor(t){super(t)}async run(t){let e=t.get(ql),i=t.get(ki),n=t.get(kt),o=t.get(hi),s=t.get(Be),a=t.get(qi),l=t.get(ti),d=t.get(Tn),c=t.get(Io),p=await e.getRecentlyOpened(),h=await e.getDirtyWorkspaces(),m=!1,f=new Fn,g=new Fn;for(let G of h)p9(G)?f.set(G.folderUri,!0):(g.set(G.workspace.configPath,G.workspace),m=!0);let v=new Fn,I=new Fn;for(let G of p.workspaces)Bw(G)?v.set(G.folderUri,!0):(I.set(G.workspace.configPath,G.workspace),m=!0);let y=[];for(let G of p.workspaces){let Y=Bw(G)?f.has(G.folderUri):g.has(G.workspace.configPath);y.push(this.toQuickPick(a,l,o,G,Y))}for(let G of h)p9(G)&&!v.has(G.folderUri)?y.push(this.toQuickPick(a,l,o,G,!0)):jae(G)&&!I.has(G.workspace.configPath)&&y.push(this.toQuickPick(a,l,o,G,!0));let w=p.files.map(G=>this.toQuickPick(a,l,o,G,!1)),C=p.workspaces[0],S=C&&n.isCurrentWorkspace(lL(C)?C.workspace:C.folderUri),D,k={type:"separator",label:m?u("workspacesAndFolders","folders & workspaces"):u("folders","folders")},M={type:"separator",label:u("files","files")},O=[k,...y,M,...w],K=await i.pick(O,{contextKey:ame,activeItem:[...y,...w][S?1:0],placeHolder:ye?u("openRecentPlaceholderMac","Select to open (hold Cmd-key to force new window or Option-key for same window)"):u("openRecentPlaceholder","Select to open (hold Ctrl-key to force new window or Alt-key for same window)"),matchOnDescription:!0,onKeyMods:G=>D=G,quickNavigate:this.isQuickNavigate()?{keybindings:s.lookupKeybindings(this.desc.id)}:void 0,hideInput:this.isQuickNavigate(),onDidTriggerItemButton:async G=>{if(G.button===this.removeFromRecentlyOpened)await e.removeRecentlyOpened([G.item.resource]),G.removeItem();else if(G.button===this.dirtyRecentlyOpenedFolder||G.button===this.dirtyRecentlyOpenedWorkspace){let Y=G.button===this.dirtyRecentlyOpenedWorkspace,{confirmed:ge}=await c.confirm({title:Y?u("dirtyWorkspace","Workspace with Unsaved Files"):u("dirtyFolder","Folder with Unsaved Files"),message:Y?u("dirtyWorkspaceConfirm","Do you want to open the workspace to review the unsaved files?"):u("dirtyFolderConfirm","Do you want to open the folder to review the unsaved files?"),detail:Y?u("dirtyWorkspaceConfirmDetail","Workspaces with unsaved files cannot be removed until all unsaved files have been saved or reverted."):u("dirtyFolderConfirmDetail","Folders with unsaved files cannot be removed until all unsaved files have been saved or reverted.")});ge&&(d.openWindow([G.item.openable],{remoteAuthority:G.item.remoteAuthority||null}),i.cancel())}}});if(K)return d.openWindow([K.openable],{forceNewWindow:D?.ctrlCmd,forceReuseWindow:D?.alt,remoteAuthority:K.remoteAuthority||null})}toQuickPick(t,e,i,n,o){let s,a,l,d,c=!1;Bw(n)?(d=n.folderUri,a=ua(t,e,d,1),s={folderUri:d},l=n.label||i.getWorkspaceLabel(d,{verbose:2})):lL(n)?(d=n.workspace.configPath,a=ua(t,e,d,2),s={workspaceUri:d},l=n.label||i.getWorkspaceLabel(n.workspace,{verbose:2}),c=!0):(d=n.fileUri,a=ua(t,e,d,0),s={fileUri:d},l=n.label||i.getUriLabel(d));let{name:p,parentPath:h}=Dse(l);return{iconClasses:a,label:p,ariaLabel:o?c?u("recentDirtyWorkspaceAriaLabel","{0}, workspace with unsaved changes",p):u("recentDirtyFolderAriaLabel","{0}, folder with unsaved changes",p):p,description:h,buttons:o?[c?this.dirtyRecentlyOpenedWorkspace:this.dirtyRecentlyOpenedFolder]:[this.removeFromRecentlyOpened],openable:s,resource:d,remoteAuthority:n.remoteAuthority}}},GP=class r extends vz{static ID="workbench.action.openRecent";constructor(){super({id:r.ID,title:{...ie("openRecent","Open Recent..."),mnemonicTitle:u({key:"miMore",comment:["&& denotes a mnemonic"]},"&&More...")},category:$t.File,f1:!0,keybinding:{weight:200,primary:2096,mac:{primary:304}},menu:{id:V.MenubarRecentMenu,group:"y_more",order:1}})}isQuickNavigate(){return!1}},bQ=class extends vz{constructor(){super({id:"workbench.action.quickOpenRecent",title:ie("quickOpenRecent","Quick Open Recent..."),category:$t.File,f1:!1})}isQuickNavigate(){return!0}},vQ=class extends Me{constructor(){super({id:"workbench.action.toggleFullScreen",title:{...ie("toggleFullScreen","Toggle Full Screen"),mnemonicTitle:u({key:"miToggleFullScreen",comment:["&& denotes a mnemonic"]},"&&Full Screen")},category:$t.View,f1:!0,keybinding:{weight:200,primary:69,mac:{primary:2340}},precondition:fde.toNegated(),toggled:ku,menu:[{id:V.MenubarAppearanceMenu,group:"1_toggle_view",order:1}]})}run(t){return t.get(Tn).toggleFullScreen(Gr())}},IQ=class r extends Me{static ID="workbench.action.reloadWindow";constructor(){super({id:r.ID,title:ie("reloadWindow","Reload Window"),category:$t.Developer,f1:!0,keybinding:{weight:250,when:bde,primary:2096}})}async run(t){return t.get(Tn).reload()}},yQ=class extends Me{constructor(){super({id:"workbench.action.showAboutDialog",title:{...ie("about","About"),mnemonicTitle:u({key:"miAbout",comment:["&& denotes a mnemonic"]},"&&About")},category:$t.Help,f1:!0,menu:{id:V.MenubarHelpMenu,group:"z_about",order:1,when:Bd.toNegated()}})}run(t){return t.get(Io).about()}},SQ=class extends Me{constructor(){super({id:"workbench.action.newWindow",title:{...ie("newWindow","New Window"),mnemonicTitle:u({key:"miNewWindow",comment:["&& denotes a mnemonic"]},"New &&Window")},f1:!0,keybinding:{weight:200,primary:si?St?mo(2089,1068):3628:3116,secondary:si?[3116]:void 0},menu:{id:V.MenubarFileMenu,group:"1_new",order:3}})}run(t){return t.get(Tn).openWindow({remoteAuthority:null})}},CQ=class extends Me{constructor(){super({id:"workbench.action.blur",title:ie("blur","Remove keyboard focus from focused element")})}run(){let t=fo();on(t)&&t.blur()}};he(SQ);he(vQ);he(bQ);he(GP);he(IQ);he(yQ);he(CQ);var lme=P.and(gQ,P.has(ame)),ome="workbench.action.quickOpenNavigateNextInRecentFilesPicker";wt.registerCommandAndKeybindingRule({id:ome,weight:250,handler:fQ(ome,!0),when:lme,primary:2096,mac:{primary:304}});var rme="workbench.action.quickOpenNavigatePreviousInRecentFilesPicker";wt.registerCommandAndKeybindingRule({id:rme,weight:250,handler:fQ(rme,!1),when:lme,primary:3120,mac:{primary:1328}});tt.registerCommand("workbench.action.toggleConfirmBeforeClose",r=>{let t=r.get(se),e=t.inspect("window.confirmBeforeClose").userValue;return t.updateValue("window.confirmBeforeClose",e==="never"?"keyboardOnly":"never")});Ue.appendMenuItem(V.MenubarFileMenu,{group:"z_ConfirmClose",command:{id:"workbench.action.toggleConfirmBeforeClose",title:u("miConfirmClose","Confirm Before Close"),toggled:P.notEquals("config.window.confirmBeforeClose","never")},order:1,when:ey});Ue.appendMenuItem(V.MenubarFileMenu,{title:u({key:"miOpenRecent",comment:["&& denotes a mnemonic"]},"Open &&Recent"),submenu:V.MenubarRecentMenu,group:"2_open",order:4});Ue.appendMenuItem(V.MenubarMainMenu,{submenu:V.MenubarFileMenu,title:{value:"File",original:"File",mnemonicTitle:u({key:"mFile",comment:["&& denotes a mnemonic"]},"&&File")},order:1});Ue.appendMenuItem(V.MenubarMainMenu,{submenu:V.MenubarEditMenu,title:{value:"Edit",original:"Edit",mnemonicTitle:u({key:"mEdit",comment:["&& denotes a mnemonic"]},"&&Edit")},order:2});Ue.appendMenuItem(V.MenubarMainMenu,{submenu:V.MenubarSelectionMenu,title:{value:"Selection",original:"Selection",mnemonicTitle:u({key:"mSelection",comment:["&& denotes a mnemonic"]},"&&Selection")},order:3});Ue.appendMenuItem(V.MenubarMainMenu,{submenu:V.MenubarViewMenu,title:{value:"View",original:"View",mnemonicTitle:u({key:"mView",comment:["&& denotes a mnemonic"]},"&&View")},order:4});Ue.appendMenuItem(V.MenubarMainMenu,{submenu:V.MenubarGoMenu,title:{value:"Go",original:"Go",mnemonicTitle:u({key:"mGoto",comment:["&& denotes a mnemonic"]},"&&Go")},order:5});Ue.appendMenuItem(V.MenubarMainMenu,{submenu:V.MenubarTerminalMenu,title:{value:"Terminal",original:"Terminal",mnemonicTitle:u({key:"mTerminal",comment:["&& denotes a mnemonic"]},"&&Terminal")},order:7});Ue.appendMenuItem(V.MenubarMainMenu,{submenu:V.MenubarHelpMenu,title:{value:"Help",original:"Help",mnemonicTitle:u({key:"mHelp",comment:["&& denotes a mnemonic"]},"&&Help")},order:8});Ue.appendMenuItem(V.MenubarMainMenu,{submenu:V.MenubarPreferencesMenu,title:{value:"Preferences",original:"Preferences",mnemonicTitle:u({key:"mPreferences",comment:["&& denotes a mnemonic"]},"Preferences")},when:Bd,order:9});var wQ=class r extends R{constructor(e,i,n,o,s,a,l,d,c,p,h,m,f,g){super();this.menuService=e;this.workspacesService=i;this.contextKeyService=n;this.keybindingService=o;this.configurationService=s;this.labelService=a;this.updateService=l;this.storageService=d;this.notificationService=c;this.preferencesService=p;this.environmentService=h;this.accessibilityService=m;this.hostService=f;this.commandService=g;this.mainMenu=this._register(this.menuService.createMenu(V.MenubarMainMenu,this.contextKeyService)),this.mainMenuDisposables=this._register(new B),this.setupMainMenu(),this.menuUpdater=this._register(new Ye(()=>this.doUpdateMenubar(!1),200)),this.notifyUserOfCustomMenubarAccessibility()}keys=["window.menuBarVisibility","window.enableMenuBarMnemonics","window.customMenuBarAltFocus","workbench.sideBar.location","window.nativeTabs"];mainMenu;menus={};topLevelTitles={};mainMenuDisposables;recentlyOpened={files:[],workspaces:[]};menuUpdater;static MAX_MENU_RECENT_ENTRIES=10;registerListeners(){this._register(this.hostService.onDidChangeFocus(e=>this.onDidChangeWindowFocus(e))),this._register(this.configurationService.onDidChangeConfiguration(e=>this.onConfigurationUpdated(e))),this._register(this.updateService.onStateChange(()=>this.onUpdateStateChange())),this._register(this.workspacesService.onDidChangeRecentlyOpened(()=>{this.onDidChangeRecentlyOpened()})),this._register(this.keybindingService.onDidUpdateKeybindings(()=>this.updateMenubar())),this._register(this.labelService.onDidChangeFormatters(()=>{this.onDidChangeRecentlyOpened()})),this._register(this.mainMenu.onDidChange(()=>{this.setupMainMenu(),this.doUpdateMenubar(!0)}))}setupMainMenu(){this.mainMenuDisposables.clear(),this.menus={},this.topLevelTitles={};let[,e]=this.mainMenu.getActions()[0];for(let i of e)i instanceof to&&typeof i.item.title!="string"&&(this.menus[i.item.title.original]=this.mainMenuDisposables.add(this.menuService.createMenu(i.item.submenu,this.contextKeyService,{emitEventsForSubmenuChanges:!0})),this.topLevelTitles[i.item.title.original]=i.item.title.mnemonicTitle??i.item.title.value)}updateMenubar(){this.menuUpdater.schedule()}calculateActionLabel(e){let i=e.label;switch(e.id){default:break}return i}onUpdateStateChange(){this.updateMenubar()}onUpdateKeybindings(){this.updateMenubar()}getOpenRecentActions(){if(!this.recentlyOpened)return[];let{workspaces:e,files:i}=this.recentlyOpened,n=[];if(e.length>0){for(let o=0;o<r.MAX_MENU_RECENT_ENTRIES&&o<e.length;o++)n.push(this.createOpenRecentMenuAction(e[o]));n.push(new Qt)}if(i.length>0){for(let o=0;o<r.MAX_MENU_RECENT_ENTRIES&&o<i.length;o++)n.push(this.createOpenRecentMenuAction(i[o]));n.push(new Qt)}return n}onDidChangeWindowFocus(e){e&&this.onDidChangeRecentlyOpened()}onConfigurationUpdated(e){this.keys.some(i=>e.affectsConfiguration(i))&&this.updateMenubar(),e.affectsConfiguration("editor.accessibilitySupport")&&this.notifyUserOfCustomMenubarAccessibility(),e.affectsConfiguration("window.menuBarVisibility")&&this.onDidChangeRecentlyOpened()}get menubarHidden(){return ye&&Po?!1:ow(this.configurationService)==="hidden"}onDidChangeRecentlyOpened(){this.menubarHidden||this.workspacesService.getRecentlyOpened().then(e=>{this.recentlyOpened=e,this.updateMenubar()})}createOpenRecentMenuAction(e){let i,n,o,s,a=e.remoteAuthority;Bw(e)?(n=e.folderUri,i=e.label||this.labelService.getWorkspaceLabel(n,{verbose:2}),o="openRecentFolder",s={folderUri:n}):lL(e)?(n=e.workspace.configPath,i=e.label||this.labelService.getWorkspaceLabel(e.workspace,{verbose:2}),o="openRecentWorkspace",s={workspaceUri:n}):(n=e.fileUri,i=e.label||this.labelService.getUriLabel(n),o="openRecentFile",s={fileUri:n});let l=fn({id:o,label:_se(i),run:d=>{let c=d&&(!ye&&(d.ctrlKey||d.shiftKey)||ye&&(d.metaKey||d.altKey));return this.hostService.openWindow([s],{forceNewWindow:!!c,remoteAuthority:a||null})}});return Object.assign(l,{uri:n,remoteAuthority:a})}notifyUserOfCustomMenubarAccessibility(){if(si||ye)return;let e=this.storageService.getBoolean("menubar/accessibleMenubarNotified",-1,!1),i=!Gm(this.configurationService);if(e||i||!this.accessibilityService.isScreenReaderOptimized())return;let n=u("menubar.customTitlebarAccessibilityNotification","Accessibility support is enabled for you. For the most accessible experience, we recommend the custom title bar style.");this.notificationService.prompt(Sc.Info,n,[{label:u("goToSetting","Open Settings"),run:()=>this.preferencesService.openUserSettings({query:"window.titleBarStyle"})}]),this.storageService.store("menubar/accessibleMenubarNotified",!0,-1,0)}},Iz;function LDe(){return Iz||(Iz=new x,he(class extends Me{constructor(){super({id:"workbench.actions.menubar.focus",title:ie("focusMenu","Focus Application Menu"),keybinding:{primary:580,weight:200,when:ey},f1:!0})}async run(){Iz?.fire()}})),Iz}var ET=class extends wQ{constructor(e,i,n,o,s,a,l,d,c,p,h,m,f,g,v){super(e,i,n,o,s,a,l,d,c,p,h,m,g,v);this.telemetryService=f;this._onVisibilityChange=this._register(new x),this._onFocusStateChange=this._register(new x),this.actionRunner=this._register(new jo),this.actionRunner.onDidRun(I=>{this.telemetryService.publicLog2("workbenchActionExecuted",{id:I.action.id,from:"menu"})}),this.workspacesService.getRecentlyOpened().then(I=>{this.recentlyOpened=I}),this.registerListeners()}menubar;container;alwaysOnMnemonics=!1;focusInsideMenubar=!1;pendingFirstTimeUpdate=!1;visible=!0;actionRunner;webNavigationMenu=this._register(this.menuService.createMenu(V.MenubarHomeMenu,this.contextKeyService));_onVisibilityChange;_onFocusStateChange;doUpdateMenubar(e){this.focusInsideMenubar||this.setupCustomMenubar(e),e&&(this.pendingFirstTimeUpdate=!0)}getUpdateAction(){switch(this.updateService.state.type){case"idle":return new et("update.check",u({key:"checkForUpdates",comment:["&& denotes a mnemonic"]},"Check for &&Updates..."),void 0,!0,()=>this.updateService.checkForUpdates(!0));case"checking for updates":return new et("update.checking",u("checkingForUpdates","Checking for Updates..."),void 0,!1);case"available for download":return new et("update.downloadNow",u({key:"download now",comment:["&& denotes a mnemonic"]},"D&&ownload Update"),void 0,!0,()=>this.updateService.downloadUpdate());case"downloading":return new et("update.downloading",u("DownloadingUpdate","Downloading Update..."),void 0,!1);case"downloaded":return ye?null:new et("update.install",u({key:"installUpdate...",comment:["&& denotes a mnemonic"]},"Install &&Update..."),void 0,!0,()=>this.updateService.applyUpdate());case"updating":return new et("update.updating",u("installingUpdate","Installing Update..."),void 0,!1);case"ready":return new et("update.restart",u({key:"restartToUpdate",comment:["&& denotes a mnemonic"]},"Restart to &&Update"),void 0,!0,()=>this.updateService.quitAndInstall());default:return null}}get currentMenubarVisibility(){return ow(this.configurationService)}get currentDisableMenuBarAltFocus(){let e=this.configurationService.getValue("window.customMenuBarAltFocus"),i=!1;return typeof e=="boolean"&&(i=!e),i}insertActionsBefore(e,i){switch(e.id){case GP.ID:i.push(...this.getOpenRecentActions());break;case"workbench.action.showAboutDialog":if(!ye&&!si){let n=this.getUpdateAction();n&&(n.label=zm(n.label),i.push(n),i.push(new Qt))}break;default:break}}get currentEnableMenuBarMnemonics(){let e=this.configurationService.getValue("window.enableMenuBarMnemonics");return typeof e!="boolean"&&(e=!0),e&&(!si||K_(Ke))}get currentCompactMenuMode(){if(this.currentMenubarVisibility!=="compact")return;let i=this.configurationService.getValue("workbench.sideBar.location")==="right"?1:0,o=this.configurationService.getValue("workbench.activityBar.location")==="bottom"?0:1;return{horizontal:i,vertical:o}}onDidVisibilityChange(e){this.visible=e,this.onDidChangeRecentlyOpened(),this._onVisibilityChange.fire(e)}toActionsArray(e){let i=[];return sa(e,{shouldForwardArgs:!0},i),i}reinstallDisposables=this._register(new B);setupCustomMenubar(e){if(!this.container)return;e?(this.menubar&&this.reinstallDisposables.clear(),this.menubar=this.reinstallDisposables.add(new fz(this.container,this.getMenuBarOptions(),Uae)),this.accessibilityService.alwaysUnderlineAccessKeys().then(n=>{this.alwaysOnMnemonics=n,this.menubar?.update(this.getMenuBarOptions())}),this.reinstallDisposables.add(this.menubar.onFocusStateChange(n=>{this._onFocusStateChange.fire(n),n||(this.pendingFirstTimeUpdate?(this.setupCustomMenubar(!0),this.pendingFirstTimeUpdate=!1):this.updateMenubar(),this.focusInsideMenubar=!1)})),this.reinstallDisposables.add(this.menubar.onVisibilityChange(n=>this.onDidVisibilityChange(n))),this.reinstallDisposables.add(F(this.container,Q.FOCUS_IN,()=>{this.focusInsideMenubar=!0})),this.reinstallDisposables.add(F(this.container,Q.FOCUS_OUT,()=>{this.focusInsideMenubar=!1})),this.menubar.isVisible&&this.onDidVisibilityChange(!0)):this.menubar?.update(this.getMenuBarOptions());let i=(n,o,s)=>{o.splice(0);for(let a of n)if(this.insertActionsBefore(a,o),a instanceof Qt)o.push(a);else if(a instanceof to||a instanceof wn){let l=typeof a.item.title=="string"?a.item.title:a.item.title.mnemonicTitle??a.item.title.value;if(a instanceof to){let d=[];i(a.actions,d,s),d.length>0&&o.push(new vo(a.id,zm(l),d))}else{IO(a.item.toggled)&&(l=a.item.toggled.mnemonicTitle??a.item.toggled.title??l);let d=new et(a.id,zm(l),a.class,a.enabled,()=>this.commandService.executeCommand(a.id));d.tooltip=a.tooltip,d.checked=a.checked,o.push(d)}}if(s==="File"&&this.currentCompactMenuMode===void 0){let a=this.getWebNavigationActions();a.length&&o.push(...a)}};for(let n of Object.keys(this.topLevelTitles)){let o=this.menus[n];e&&o&&(this.reinstallDisposables.add(o.onDidChange(()=>{if(!this.focusInsideMenubar){let a=[];i(this.toActionsArray(o),a,n),this.menubar?.updateMenu({actions:a,label:zm(this.topLevelTitles[n])})}})),o===this.menus.File&&this.reinstallDisposables.add(this.webNavigationMenu.onDidChange(()=>{if(!this.focusInsideMenubar){let a=[];i(this.toActionsArray(o),a,n),this.menubar?.updateMenu({actions:a,label:zm(this.topLevelTitles[n])})}})));let s=[];o&&i(this.toActionsArray(o),s,n),this.menubar&&(e?this.menubar.push({actions:s,label:zm(this.topLevelTitles[n])}):this.menubar.updateMenu({actions:s,label:zm(this.topLevelTitles[n])}))}}getWebNavigationActions(){if(!si)return[];let e=[];for(let i of this.webNavigationMenu.getActions()){let[,n]=i;for(let o of n)if(o instanceof wn){let s=typeof o.item.title=="string"?o.item.title:o.item.title.mnemonicTitle??o.item.title.value;e.push(new et(o.id,zm(s),o.class,o.enabled,async a=>{this.commandService.executeCommand(o.id,a)}))}e.push(new Qt)}return e.length&&e.pop(),e}getMenuBarOptions(){return{enableMnemonics:this.currentEnableMenuBarMnemonics,disableAltFocus:this.currentDisableMenuBarAltFocus,visibility:this.currentMenubarVisibility,actionRunner:this.actionRunner,getKeybinding:e=>this.keybindingService.lookupKeybinding(e.id),alwaysOnMnemonics:this.alwaysOnMnemonics,compactMode:this.currentCompactMenuMode,getCompactMenuActions:()=>si?this.getWebNavigationActions():[]}}onDidChangeWindowFocus(e){this.visible&&(super.onDidChangeWindowFocus(e),this.container&&(e?this.container.classList.remove("inactive"):(this.container.classList.add("inactive"),this.menubar?.blur())))}onUpdateStateChange(){this.visible&&super.onUpdateStateChange()}onDidChangeRecentlyOpened(){this.visible&&super.onDidChangeRecentlyOpened()}onUpdateKeybindings(){this.visible&&super.onUpdateKeybindings()}registerListeners(){super.registerListeners(),this._register(F(Ke,Q.RESIZE,()=>{this.menubar&&!(Hr&&Qc.pointerEvents)&&this.menubar.blur()})),si&&(this._register(yee(e=>{e===Ke.vscodeWindowId&&this.updateMenubar()})),this._register(this.webNavigationMenu.onDidChange(()=>this.updateMenubar())),this._register(LDe().event(()=>this.menubar?.toggleFocus())))}get onVisibilityChange(){return this._onVisibilityChange.event}get onFocusStateChange(){return this._onFocusStateChange.event}getMenubarItemsDimensions(){return this.menubar?new Ge(this.menubar.getWidth(),this.menubar.getHeight()):new Ge(0,0)}create(e){return this.container=e,this.container&&this.doUpdateMenubar(!0),this.container}layout(e){this.menubar?.update(this.getMenuBarOptions())}toggleFocus(){this.menubar?.toggleFocus()}};ET=E([b(0,jt),b(1,ql),b(2,re),b(3,Be),b(4,se),b(5,hi),b(6,ime),b(7,nt),b(8,mi),b(9,jm),b(10,Jo),b(11,Un),b(12,Tt),b(13,Tn),b(14,ct)],ET);var RDe=(()=>{if(ye&&Po)return"${activeEditorShort}${separator}${rootName}${separator}${profileName}";let r="${dirty}${activeEditorShort}${separator}${rootName}${separator}${profileName}${separator}${appName}";return si?r+"${separator}${remoteName}":r})(),PDe=ye?" \u2014 ":" - ",Jd=class extends R{constructor(e,i,n,o,s,a,l,d,c,p,h){super();this.configurationService=n;this.contextKeyService=o;this.environmentService=a;this.contextService=l;this.labelService=d;this.userDataProfileService=c;this.productService=p;this.viewsService=h;this.editorService=s.createScoped(i,this._store),this.windowId=e.vscodeWindowId,this.updateTitleIncludesFocusedView(),this.registerListeners()}static NLS_USER_IS_ADMIN=St?u("userIsAdmin","[Administrator]"):u("userIsSudo","[Superuser]");static NLS_EXTENSION_HOST=u("devExtensionWindowTitlePrefix","[Extension Development Host]");static TITLE_DIRTY="\u25CF ";properties={isPure:!0,isAdmin:!1,prefix:void 0};variables=new Map;activeEditorListeners=this._register(new B);titleUpdater=this._register(new Ye(()=>this.doUpdateTitle(),0));onDidChangeEmitter=new x;onDidChange=this.onDidChangeEmitter.event;get value(){return this.title??""}get workspaceName(){return this.labelService.getWorkspaceLabel(this.contextService.getWorkspace())}get fileName(){let e=this.editorService.activeEditor;if(!e)return;let i=e.getTitle(0);return`${e?.isDirty()&&!e.isSaving()?Jd.TITLE_DIRTY:""}${i}`}title;titleIncludesFocusedView=!1;editorService;windowId;registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(e=>this.onConfigurationChanged(e))),this._register(this.editorService.onDidActiveEditorChange(()=>this.onActiveEditorChange())),this._register(this.contextService.onDidChangeWorkspaceFolders(()=>this.titleUpdater.schedule())),this._register(this.contextService.onDidChangeWorkbenchState(()=>this.titleUpdater.schedule())),this._register(this.contextService.onDidChangeWorkspaceName(()=>this.titleUpdater.schedule())),this._register(this.labelService.onDidChangeFormatters(()=>this.titleUpdater.schedule())),this._register(this.userDataProfileService.onDidChangeCurrentProfile(()=>this.titleUpdater.schedule())),this._register(this.viewsService.onDidChangeFocusedView(()=>{this.titleIncludesFocusedView&&this.titleUpdater.schedule()})),this._register(this.contextKeyService.onDidChangeContext(e=>{e.affectsSome(this.variables)&&this.titleUpdater.schedule()}))}onConfigurationChanged(e){e.affectsConfiguration("window.title")&&this.updateTitleIncludesFocusedView(),(e.affectsConfiguration("window.title")||e.affectsConfiguration("window.titleSeparator"))&&this.titleUpdater.schedule()}updateTitleIncludesFocusedView(){let e=this.configurationService.getValue("window.title");this.titleIncludesFocusedView=typeof e=="string"&&e.includes("${focusedView}")}onActiveEditorChange(){this.activeEditorListeners.clear(),this.titleUpdater.schedule();let e=this.editorService.activeEditor;if(e&&(this.activeEditorListeners.add(e.onDidChangeDirty(()=>this.titleUpdater.schedule())),this.activeEditorListeners.add(e.onDidChangeLabel(()=>this.titleUpdater.schedule()))),this.titleIncludesFocusedView){let i=this.editorService.activeTextEditorControl,n=[];no(i)?n.push(i):RI(i)&&n.push(i.getOriginalEditor(),i.getModifiedEditor());for(let o of n)this.activeEditorListeners.add(o.onDidBlurEditorText(()=>this.titleUpdater.schedule())),this.activeEditorListeners.add(o.onDidFocusEditorText(()=>this.titleUpdater.schedule()))}}doUpdateTitle(){let e=this.getFullWindowTitle();if(e!==this.title){let i=e;b4(i)||(i=this.productService.nameLong);let n=Em(this.windowId,!0).window;!n.document.title&&ye&&i===this.productService.nameLong&&(n.document.title=`${this.productService.nameLong} ${Jd.TITLE_DIRTY}`),n.document.title=i,this.title=e,this.onDidChangeEmitter.fire()}}getFullWindowTitle(){let{prefix:e,suffix:i}=this.getTitleDecorations(),n=this.getWindowTitle()||this.productService.nameLong;return e&&(n=`${e} ${n}`),i&&(n=`${n} ${i}`),n.replace(/[^\S ]/g," ")}getTitleDecorations(){let e,i;return this.properties.prefix&&(e=this.properties.prefix),this.environmentService.isExtensionDevelopment&&(e=e?`${Jd.NLS_EXTENSION_HOST} - ${e}`:Jd.NLS_EXTENSION_HOST),this.properties.isAdmin&&(i=Jd.NLS_USER_IS_ADMIN),{prefix:e,suffix:i}}updateProperties(e){let i=typeof e.isAdmin=="boolean"?e.isAdmin:this.properties.isAdmin,n=typeof e.isPure=="boolean"?e.isPure:this.properties.isPure,o=typeof e.prefix=="string"?e.prefix:this.properties.prefix;(i!==this.properties.isAdmin||n!==this.properties.isPure||o!==this.properties.prefix)&&(this.properties.isAdmin=i,this.properties.isPure=n,this.properties.prefix=o,this.titleUpdater.schedule())}registerVariables(e){let i=!1;for(let{name:n,contextKey:o}of e)this.variables.has(o)||(this.variables.set(o,n),i=!0);i&&this.titleUpdater.schedule()}getWindowTitle(){let e=this.editorService.activeEditor,i=this.contextService.getWorkspace(),n;i.configuration?n=i.configuration:i.folders.length&&(n=i.folders[0].uri);let o=ro.getOriginalUri(e,{supportSideBySide:1}),s=o?Hn(o):void 0;s?.path==="."&&(s=void 0);let a;this.contextService.getWorkbenchState()===2?a=i.folders[0]:o&&(a=this.contextService.getWorkspaceFolder(o)??void 0);let l;if(this.environmentService.remoteAuthority&&!si)l=this.labelService.getHostLabel(Ie.vscodeRemote,this.environmentService.remoteAuthority);else{let G=lX(i);G&&(l=this.labelService.getHostLabel(G.scheme,G.authority))}let d=e?e.getTitle(0):"",c=e?e.getTitle(1):d,p=e?e.getTitle(2):c,h=s?Ji(s):"",m=s?this.labelService.getUriLabel(s,{relative:!0}):"",f=s?this.labelService.getUriLabel(s):"",g=this.labelService.getWorkspaceLabel(i),v=this.labelService.getWorkspaceLabel(i,{verbose:0}),I=n?this.labelService.getUriLabel(n):"",y=a?a.name:"",w=a?this.labelService.getUriLabel(a.uri):"",C=e?.isDirty()&&!e.isSaving()?Jd.TITLE_DIRTY:"",S=this.productService.nameLong,D=this.userDataProfileService.currentProfile.isDefault?"":this.userDataProfileService.currentProfile.name,k=this.viewsService.getFocusedViewName(),M={};for(let[G,Y]of this.variables)M[Y]=this.contextKeyService.getContextKeyValue(G)??"";let O=this.configurationService.getValue("window.title");typeof O!="string"&&(O=RDe);let K=this.configurationService.getValue("window.titleSeparator");return typeof K!="string"&&(K=PDe),Tse(O,{...M,activeEditorShort:d,activeEditorLong:p,activeEditorMedium:c,activeFolderShort:h,activeFolderMedium:m,activeFolderLong:f,rootName:g,rootPath:I,rootNameShort:v,folderName:y,folderPath:w,dirty:C,appName:S,remoteName:l,profileName:D,focusedView:k,separator:{label:K}})}isCustomTitleFormat(){let e=this.configurationService.inspect("window.title"),i=this.configurationService.inspect("window.titleSeparator");return e.value!==e.defaultValue||i.value!==i.defaultValue}};Jd=E([b(2,se),b(3,re),b(4,$e),b(5,ih),b(6,kt),b(7,hi),b(8,By),b(9,al),b(10,Mi)],Jd);var xT=class{_disposables=new B;_onDidChangeVisibility=new x;onDidChangeVisibility=this._onDidChangeVisibility.event;element=document.createElement("div");constructor(t,e,i,n){this.element.classList.add("command-center");let o=i.createInstance(lh,this.element,V.CommandCenter,{contextMenu:V.TitleBarContext,hiddenItemStrategy:-1,toolbarOptions:{primaryGroup:()=>!0},telemetrySource:"commandCenter",actionViewItemProvider:(s,a)=>s instanceof to&&s.item.submenu===V.CommandCenterCenter?i.createInstance(oS,s,t,{...a,hoverDelegate:e}):aa(i,s,{...a,hoverDelegate:e})});this._disposables.add(X.filter(n.onShow,()=>Z4(this.element),this._disposables)(this._setVisibility.bind(this,!1))),this._disposables.add(X.filter(n.onHide,()=>Z4(this.element),this._disposables)(this._setVisibility.bind(this,!0))),this._disposables.add(o)}_setVisibility(t){this.element.classList.toggle("hide",!t),this._onDidChangeVisibility.fire()}dispose(){this._disposables.dispose()}};xT=E([b(2,ne),b(3,ki)],xT);var oS=class extends Yn{constructor(e,i,n,o,s,a,l){super(void 0,e.actions.find(d=>d.id==="workbench.action.quickOpenWithModes")??e.actions[0],n);this._submenu=e;this._windowTitle=i;this._hoverService=o;this._keybindingService=s;this._instaService=a;this._editorGroupService=l;this._hoverDelegate=n.hoverDelegate??gt("mouse")}static _quickOpenCommandId="workbench.action.quickOpenWithModes";_hoverDelegate;render(e){super.render(e),e.classList.add("command-center-center"),e.classList.toggle("multiple",this._submenu.actions.length>1);let i=this._store.add(this._hoverService.setupManagedHover(this._hoverDelegate,e,this.getTooltip()));this._store.add(this._windowTitle.onDidChange(()=>{i.update(this.getTooltip())}));let n=[];for(let o of this._submenu.actions)o instanceof vo?n.push(o.actions):n.push([o]);for(let o=0;o<n.length;o++){let s=n[o],a=this._instaService.createInstance(ul,e,{hiddenItemStrategy:-1,telemetrySource:"commandCenterCenter",actionViewItemProvider:(l,d)=>{if(d={...d,hoverDelegate:this._hoverDelegate},l.id!==oS._quickOpenCommandId)return aa(this._instaService,l,d);let c=this;return this._instaService.createInstance(class extends Yn{constructor(){super(void 0,l,d)}render(h){super.render(h),h.classList.toggle("command-center-quick-pick"),h.role="button";let m=this.action,f=document.createElement("span");f.ariaHidden="true",f.className=m.class??"",f.classList.add("search-icon");let g=this._getLabel(),v=document.createElement("span");v.classList.add("search-label"),v.innerText=g,bo(h,f,v);let I=this._store.add(c._hoverService.setupManagedHover(c._hoverDelegate,h,this.getTooltip()));this._store.add(c._windowTitle.onDidChange(()=>{I.update(this.getTooltip()),v.innerText=this._getLabel()})),this._store.add(c._editorGroupService.onDidChangeEditorPartOptions(({newPartOptions:y,oldPartOptions:w})=>{y.showTabs!==w.showTabs&&(I.update(this.getTooltip()),v.innerText=this._getLabel())}))}getTooltip(){return c.getTooltip()}_getLabel(){let{prefix:h,suffix:m}=c._windowTitle.getTitleDecorations(),f=c._windowTitle.workspaceName;return c._windowTitle.isCustomTitleFormat()?f=c._windowTitle.getWindowTitle():c._editorGroupService.partOptions.showTabs==="none"&&(f=c._windowTitle.fileName??f),f||(f=u("label.dfl","Search")),h&&(f=u("label1","{0} {1}",h,f)),m&&(f=u("label2","{0} {1}",f,m)),f.replaceAll(/\r\n|\r|\n/g,"\u23CE")}})}});if(a.setActions(s),this._store.add(a),o<n.length-1){let l=Eu(N.circleSmallFilled);l.style.padding="0 12px",l.style.height="100%",l.style.opacity="0.5",e.appendChild(l)}}}getTooltip(){let e=this._keybindingService.lookupKeybinding(this.action.id)?.getLabel();return e?u("title","Search {0} ({1}) \u2014 {2}",this._windowTitle.workspaceName,e,this._windowTitle.value):u("title2","Search {0} \u2014 {1}",this._windowTitle.workspaceName,this._windowTitle.value)}};oS=E([b(3,Nt),b(4,Be),b(5,ne),b(6,gn)],oS);Ue.appendMenuItem(V.CommandCenter,{submenu:V.CommandCenterCenter,title:u("title3","Command Center"),icon:N.shield,order:101});var Rg="workbench.actions.manage",Pg="workbench.actions.accounts";var TT=class extends et{constructor(e){super(e.id,e.name,e.classNames?.join(" "),!0);this.item=e}_onDidChangeCompositeBarActionItem=this._register(new x);onDidChangeCompositeBarActionItem=this._onDidChangeCompositeBarActionItem.event;_onDidChangeActivity=this._register(new x);onDidChangeActivity=this._onDidChangeActivity.event;_activity;get compositeBarActionItem(){return this.item}set compositeBarActionItem(e){this._label=e.name,this.item=e,this._onDidChangeCompositeBarActionItem.fire(this)}get activity(){return this._activity}set activity(e){this._activity=e,this._onDidChangeActivity.fire(e)}activate(){this.checked||this._setChecked(!0)}deactivate(){this.checked&&this._setChecked(!1)}},ip=class extends Yn{constructor(e,i,n,o,s,a,l){super(null,e,i);this.badgesEnabled=n;this.themeService=o;this.hoverService=s;this.configurationService=a;this.keybindingService=l;this.options=i,this._register(this.themeService.onDidColorThemeChange(this.onThemeChange,this)),this._register(e.onDidChangeCompositeBarActionItem(()=>this.update())),this._register(X.filter(l.onDidUpdateKeybindings,()=>this.keybindingLabel!==this.computeKeybindingLabel())(()=>this.updateTitle())),this._register(e.onDidChangeActivity(()=>this.updateActivity())),this._register(le(()=>this.showHoverScheduler.cancel()))}static hoverLeaveTime=0;container;label;badge;options;badgeContent;badgeDisposable=this._register(new yt);mouseUpTimeout;keybindingLabel;hoverDisposables=this._register(new B);lastHover;showHoverScheduler=new Ye(()=>this.showHover(),0);get compositeBarActionItem(){return this._action.compositeBarActionItem}updateStyles(){let e=this.themeService.getColorTheme(),i=this.options.colors(e);if(this.label){if(this.options.icon){let n=this._action.checked?i.activeForegroundColor:i.inactiveForegroundColor;this.compositeBarActionItem.iconUrl?(this.label.style.backgroundColor=n?n.toString():"",this.label.style.color=""):(this.label.style.color=n?n.toString():"",this.label.style.backgroundColor="")}else{let n=this._action.checked?i.activeForegroundColor:i.inactiveForegroundColor,o=this._action.checked?i.activeBorderBottomColor:null;this.label.style.color=n?n.toString():"",this.label.style.borderBottomColor=o?o.toString():""}this.container.style.setProperty("--insert-border-color",i.dragAndDropBorder?i.dragAndDropBorder.toString():"")}if(this.badgeContent){let n=i.badgeForeground??e.getColor(Rf),o=i.badgeBackground??e.getColor(gc),s=e.getColor(Oe);this.badgeContent.style.color=n?n.toString():"",this.badgeContent.style.backgroundColor=o?o.toString():"",this.badgeContent.style.borderStyle=s&&!this.options.compact?"solid":"",this.badgeContent.style.borderWidth=s?"1px":"",this.badgeContent.style.borderColor=s?s.toString():""}}render(e){super.render(e),this.container=e,this.options.icon&&this.container.classList.add("icon"),this.options.hasPopup?(this.container.setAttribute("role","button"),this.container.setAttribute("aria-haspopup","true")):this.container.setAttribute("role","tab"),this._register(F(this.container,Q.MOUSE_DOWN,()=>{this.container.classList.add("clicked")})),this._register(F(this.container,Q.MOUSE_UP,()=>{this.mouseUpTimeout&&clearTimeout(this.mouseUpTimeout),this.mouseUpTimeout=setTimeout(()=>{this.container.classList.remove("clicked")},800)})),this.label=U(e,J("a")),this.badge=U(e,J(".badge")),this.badgeContent=U(this.badge,J(".badge-content")),U(e,J(".active-item-indicator")),ji(this.badge),this.update(),this.updateStyles(),this.updateHover()}onThemeChange(e){this.updateStyles()}update(){this.updateLabel(),this.updateActivity(),this.updateTitle(),this.updateStyles()}updateActivity(){let e=this.action;if(!this.badge||!this.badgeContent||!(e instanceof TT))return;let i=e.activity;this.badgeDisposable.clear(),ai(this.badgeContent),ji(this.badge);let n=this.badgesEnabled(this.compositeBarActionItem.id);if(i&&n){let{badge:o}=i,s=[];if(this.options.compact&&s.push("compact"),o instanceof Z2)rn(this.badge),s.push("progress-badge");else if(o instanceof ep&&o.number){let a=o.number.toString();if(o.number>999){let l=o.number/1e3,d=Math.floor(l);l>d?a=`${d}K+`:a=`${l}K`}this.options.compact&&a.length>=3&&s.push("compact-content"),this.badgeContent.textContent=a,rn(this.badge)}s.length&&(this.badge.classList.add(...s),this.badgeDisposable.value=le(()=>this.badge.classList.remove(...s)))}this.updateTitle()}updateLabel(){this.label.className="action-label",this.compositeBarActionItem.classNames&&this.label.classList.add(...this.compositeBarActionItem.classNames),this.options.icon||(this.label.textContent=this.action.label)}updateTitle(){let e=this.computeTitle();[this.label,this.badge,this.container].forEach(i=>{i&&(i.setAttribute("aria-label",e),i.setAttribute("title",""),i.removeAttribute("title"))})}computeTitle(){this.keybindingLabel=this.computeKeybindingLabel();let e=this.keybindingLabel?u("titleKeybinding","{0} ({1})",this.compositeBarActionItem.name,this.keybindingLabel):this.compositeBarActionItem.name,i=this.action.activity?.badge;return i?.getDescription()&&(e=u("badgeTitle","{0} - {1}",e,i.getDescription())),e}computeKeybindingLabel(){return(this.compositeBarActionItem.keybindingId?this.keybindingService.lookupKeybinding(this.compositeBarActionItem.keybindingId):null)?.getLabel()}updateHover(){this.hoverDisposables.clear(),this.updateTitle(),this.hoverDisposables.add(F(this.container,Q.MOUSE_OVER,()=>{this.showHoverScheduler.isScheduled()||(Date.now()-ip.hoverLeaveTime<200?this.showHover(!0):this.showHoverScheduler.schedule(this.configurationService.getValue("workbench.hover.delay")))},!0)),this.hoverDisposables.add(F(this.container,Q.MOUSE_LEAVE,e=>{e.target===this.container&&(ip.hoverLeaveTime=Date.now(),this.hoverService.hideHover(),this.showHoverScheduler.cancel())},!0)),this.hoverDisposables.add(le(()=>{this.hoverService.hideHover(),this.showHoverScheduler.cancel()}))}showHover(e=!1){if(this.lastHover&&!this.lastHover.isDisposed)return;let i=this.options.hoverOptions.position();this.lastHover=this.hoverService.showHover({target:this.container,content:this.computeTitle(),position:{hoverPosition:i},persistence:{hideOnKeyDown:!0},appearance:{showPointer:!0,compact:!0,skipFadeInAnimation:e}})}dispose(){super.dispose(),this.mouseUpTimeout&&clearTimeout(this.mouseUpTimeout),this.badge.remove()}};ip=E([b(3,Fe),b(4,Nt),b(5,se),b(6,Be)],ip);var yz=class extends ip{constructor(e,i,n,o,s,a,l,d,c,p,h,m){super(e,{icon:!0,colors:a,hasPopup:!0,hoverOptions:l},()=>!0,c,p,h,m);this.getOverflowingComposites=i;this.getActiveCompositeId=n;this.getBadge=o;this.getCompositeOpenAction=s;this.contextMenuService=d}showMenu(){this.contextMenuService.showContextMenu({getAnchor:()=>this.container,getActions:()=>this.getActions(),getCheckedActionsRepresentation:()=>"radio"})}getActions(){return this.getOverflowingComposites().map(e=>{let i=this.getCompositeOpenAction(e.id);i.checked=this.getActiveCompositeId()===i.id;let n=this.getBadge(e.id),o;return n instanceof ep&&(o=n.number),o?i.label=u("numberBadge","{0} ({1})",e.name,o):i.label=e.name||"",i})}};yz=E([b(7,vt),b(8,Fe),b(9,Nt),b(10,se),b(11,Be)],yz);var qP=class extends et{constructor(e){super("activitybar.manage.extension",u("manageExtension","Manage Extension"));this.commandService=e}run(e){return this.commandService.executeCommand("_extensions.manage",e)}};qP=E([b(0,ct)],qP);var vv=class extends ip{constructor(e,i,n,o,s,a,l,d,c,p,h,m,f,g){super(i,e,d.areBadgesEnabled.bind(d),m,f,g,p);this.compositeActivityAction=i;this.toggleCompositePinnedAction=n;this.toggleCompositeBadgeAction=o;this.compositeContextMenuActionsProvider=s;this.contextMenuActionsProvider=a;this.dndHandler=l;this.compositeBar=d;this.contextMenuService=c;vv.manageExtensionAction||(vv.manageExtensionAction=h.createInstance(qP))}static manageExtensionAction;render(e){super.render(e),this.updateChecked(),this.updateEnabled(),this._register(F(this.container,Q.CONTEXT_MENU,n=>{Ve.stop(n,!0),this.showContextMenu(e)}));let i;this._register(rb.INSTANCE.registerDraggable(this.container,()=>({type:"composite",id:this.compositeBarActionItem.id}),{onDragOver:n=>{let o=n.dragAndDropData.getData().id!==this.compositeBarActionItem.id&&this.dndHandler.onDragOver(n.dragAndDropData,this.compositeBarActionItem.id,n.eventData);dL(n.eventData.dataTransfer,"move",o),i=this.updateFromDragging(e,o,n.eventData)},onDragLeave:n=>{i=this.updateFromDragging(e,!1,n.eventData)},onDragEnd:n=>{i=this.updateFromDragging(e,!1,n.eventData)},onDrop:n=>{Ve.stop(n.eventData,!0),this.dndHandler.drop(n.dragAndDropData,this.compositeBarActionItem.id,n.eventData,i),i=this.updateFromDragging(e,!1,n.eventData)},onDragStart:n=>{n.dragAndDropData.getData().id===this.compositeBarActionItem.id&&(n.eventData.dataTransfer&&(n.eventData.dataTransfer.effectAllowed="move"),this.blur())}})),[this.badge,this.label].forEach(n=>this._register(new d1(n,()=>{this.action.checked||this.action.run()}))),this.updateStyles()}updateFromDragging(e,i,n){let o=e.getBoundingClientRect(),s=n.clientX,a=n.clientY,l=o.bottom-o.top,d=o.right-o.left,c=a<=o.top+l*.4,p=a>o.bottom-l*.4,h=a<=o.top+l*.5,m=s<=o.left+d*.4,f=s>o.right-d*.4,g=s<=o.left+d*.5,v=e.classList,I={vertical:v.contains("top")?"top":v.contains("bottom")?"bottom":void 0,horizontal:v.contains("left")?"left":v.contains("right")?"right":void 0},y=c||h&&!I.vertical||!p&&I.vertical==="top",w=p||!h&&!I.vertical||!c&&I.vertical==="bottom",C=m||g&&!I.horizontal||!f&&I.horizontal==="left",S=f||!g&&!I.horizontal||!m&&I.horizontal==="right";if(e.classList.toggle("top",i&&y),e.classList.toggle("bottom",i&&w),e.classList.toggle("left",i&&C),e.classList.toggle("right",i&&S),!!i)return{verticallyBefore:y,horizontallyBefore:C}}showContextMenu(e){let i=[this.toggleCompositePinnedAction,this.toggleCompositeBadgeAction],n=this.compositeContextMenuActionsProvider(this.compositeBarActionItem.id);n.length&&i.push(...n),this.compositeActivityAction.compositeBarActionItem.extensionId&&(i.push(new Qt),i.push(vv.manageExtensionAction)),this.compositeBar.isPinned(this.compositeBarActionItem.id)?(this.toggleCompositePinnedAction.label=u("hide","Hide '{0}'",this.compositeBarActionItem.name),this.toggleCompositePinnedAction.checked=!1):this.toggleCompositePinnedAction.label=u("keep","Keep '{0}'",this.compositeBarActionItem.name),this.compositeBar.areBadgesEnabled(this.compositeBarActionItem.id)?this.toggleCompositeBadgeAction.label=u("hideBadge","Hide Badge"):this.toggleCompositeBadgeAction.label=u("showBadge","Show Badge");let a=this.contextMenuActionsProvider();a.length&&(i.push(new Qt),i.push(...a));let l=Oi(e),d={x:Math.floor(l.left+l.width/2),y:l.top+l.height};this.contextMenuService.showContextMenu({getAnchor:()=>d,getActions:()=>i,getActionsContext:()=>this.compositeBarActionItem.id})}updateChecked(){this.action.checked?(this.container.classList.add("checked"),this.container.setAttribute("aria-label",this.getTooltip()??this.container.title),this.container.setAttribute("aria-expanded","true"),this.container.setAttribute("aria-selected","true")):(this.container.classList.remove("checked"),this.container.setAttribute("aria-label",this.getTooltip()??this.container.title),this.container.setAttribute("aria-expanded","false"),this.container.setAttribute("aria-selected","false")),this.updateStyles()}updateEnabled(){this.element&&(this.action.enabled?this.element.classList.remove("disabled"):this.element.classList.add("disabled"))}dispose(){super.dispose(),this.label.remove()}};vv=E([b(8,vt),b(9,Be),b(10,ne),b(11,Fe),b(12,Nt),b(13,se)],vv);var dme=q("encryptionService"),PCo=q("encryptionMainService");var EQ=q("secretStorageService"),Sz=class extends R{constructor(e,i,n,o){super();this._useInMemoryStorage=e;this._storageService=i;this._encryptionService=n;this._logService=o}_storagePrefix="secret://";onDidChangeSecretEmitter=this._register(new x);onDidChangeSecret=this.onDidChangeSecretEmitter.event;_sequencer=new xA;_type="unknown";_onDidChangeValueDisposable=this._register(new B);get type(){return this._type}_lazyStorageService=new qn(()=>this.initialize());get resolvedStorageService(){return this._lazyStorageService.value}get(e){return this._sequencer.queue(e,async()=>{let i=await this.resolvedStorageService,n=this.getKey(e);this._logService.trace("[secrets] getting secret for key:",n);let o=i.get(n,-1);if(!o){this._logService.trace("[secrets] no secret found for key:",n);return}try{this._logService.trace("[secrets] decrypting gotten secret for key:",n);let s=this._type==="in-memory"?o:await this._encryptionService.decrypt(o);return this._logService.trace("[secrets] decrypted secret for key:",n),s}catch(s){this._logService.error(s),this.delete(e);return}})}set(e,i){return this._sequencer.queue(e,async()=>{let n=await this.resolvedStorageService;this._logService.trace("[secrets] encrypting secret for key:",e);let o;try{o=this._type==="in-memory"?i:await this._encryptionService.encrypt(i)}catch(a){throw this._logService.error(a),a}let s=this.getKey(e);this._logService.trace("[secrets] storing encrypted secret for key:",s),n.store(s,o,-1,1),this._logService.trace("[secrets] stored encrypted secret for key:",s)})}delete(e){return this._sequencer.queue(e,async()=>{let i=await this.resolvedStorageService,n=this.getKey(e);this._logService.trace("[secrets] deleting secret for key:",n),i.remove(n,-1),this._logService.trace("[secrets] deleted secret for key:",n)})}async initialize(){let e;if(!this._useInMemoryStorage&&await this._encryptionService.isEncryptionAvailable())this._logService.trace("[SecretStorageService] Encryption is available, using persisted storage"),this._type="persisted",e=this._storageService;else{if(this._type==="in-memory")return this._storageService;this._logService.trace("[SecretStorageService] Encryption is not available, falling back to in-memory storage"),this._type="in-memory",e=this._register(new l1)}return this._onDidChangeValueDisposable.clear(),this._onDidChangeValueDisposable.add(e.onDidChangeValue(-1,void 0,this._onDidChangeValueDisposable)(i=>{this.onDidChangeValue(i.key)})),e}reinitialize(){this._lazyStorageService=new qn(()=>this.initialize())}onDidChangeValue(e){if(!e.startsWith(this._storagePrefix))return;let i=e.slice(this._storagePrefix.length);this._logService.trace(`[SecretStorageService] Notifying change in value for secret: ${i}`),this.onDidChangeSecretEmitter.fire(i)}getKey(e){return`${this._storagePrefix}${e}`}};Sz=E([b(1,nt),b(2,dme),b(3,bt)],Sz);var $P=q("IAuthenticationService"),jCo=q("IAuthenticationExtensionsService");var xQ=q("IAuthenticationAccessService"),jP=class extends R{constructor(e,i){super();this._storageService=e;this._productService=i}_serviceBrand;_onDidChangeExtensionSessionAccess=this._register(new x);onDidChangeExtensionSessionAccess=this._onDidChangeExtensionSessionAccess.event;isAccessAllowed(e,i,n){let o=this._productService.trustedExtensionAuthAccess;if(Array.isArray(o)){if(o.includes(n))return!0}else if(o?.[e]?.includes(n))return!0;let a=this.readAllowedExtensions(e,i).find(l=>l.id===n);if(a)return a.allowed!==void 0?a.allowed:!0}readAllowedExtensions(e,i){let n=[];try{let o=this._storageService.get(`${e}-${i}`,-1);o&&(n=JSON.parse(o))}catch{}return n}updateAllowedExtensions(e,i,n){let o=this.readAllowedExtensions(e,i);for(let s of n){let a=o.findIndex(l=>l.id===s.id);a===-1?o.push(s):o[a].allowed=s.allowed}this._storageService.store(`${e}-${i}`,JSON.stringify(o),-1,0),this._onDidChangeExtensionSessionAccess.fire({providerId:e,accountName:i})}removeAllowedExtensions(e,i){this._storageService.remove(`${e}-${i}`,-1),this._onDidChangeExtensionSessionAccess.fire({providerId:e,accountName:i})}};jP=E([b(0,nt),b(1,al)],jP);gi(xQ,jP,1);function MDe(r){return`onAuthenticationRequest:${r}`}async function cme(r,t){let e=await r.get(`${t.urlProtocol}.loginAccount`);if(e)try{let i=JSON.parse(e);if(i&&Bt(i.id)&&Bt(i.accessToken)&&Bt(i.providerId))return i}catch(i){console.error(`Failed parsing current auth session value: ${i}`)}}var XP=class extends R{constructor(e,i,n){super();this._extensionService=e;this._environmentService=n;this._register(i.onDidChangeExtensionSessionAccess(o=>{this._onDidChangeSessions.fire({providerId:o.providerId,label:o.accountName,event:{added:[],changed:[],removed:[]}})})),this._registerEnvContributedAuthenticationProviders()}_onDidRegisterAuthenticationProvider=this._register(new x);onDidRegisterAuthenticationProvider=this._onDidRegisterAuthenticationProvider.event;_onDidUnregisterAuthenticationProvider=this._register(new x);onDidUnregisterAuthenticationProvider=this._onDidUnregisterAuthenticationProvider.event;_onDidChangeSessions=this._register(new x);onDidChangeSessions=this._onDidChangeSessions.event;_onDidChangeDeclaredProviders=this._register(new x);onDidChangeDeclaredProviders=this._onDidChangeDeclaredProviders.event;_authenticationProviders=new Map;_authenticationProviderDisposables=this._register(new us);_declaredProviders=[];get declaredProviders(){return this._declaredProviders}_registerEnvContributedAuthenticationProviders(){if(this._environmentService.options?.authenticationProviders?.length)for(let e of this._environmentService.options.authenticationProviders)this.registerAuthenticationProvider(e.id,e)}registerDeclaredAuthenticationProvider(e){if(gd(e.id))throw new Error(u("authentication.missingId","An authentication contribution must specify an id."));if(gd(e.label))throw new Error(u("authentication.missingLabel","An authentication contribution must specify a label."));if(this.declaredProviders.some(i=>i.id===e.id))throw new Error(u("authentication.idConflict","This authentication id '{0}' has already been registered",e.id));this._declaredProviders.push(e),this._onDidChangeDeclaredProviders.fire()}unregisterDeclaredAuthenticationProvider(e){let i=this.declaredProviders.findIndex(n=>n.id===e);i>-1&&this.declaredProviders.splice(i,1),this._onDidChangeDeclaredProviders.fire()}isAuthenticationProviderRegistered(e){return this._authenticationProviders.has(e)}registerAuthenticationProvider(e,i){this._authenticationProviders.set(e,i);let n=new B;n.add(i.onDidChangeSessions(o=>this._onDidChangeSessions.fire({providerId:e,label:i.label,event:o}))),Wv(i)&&n.add(i),this._authenticationProviderDisposables.set(e,n),this._onDidRegisterAuthenticationProvider.fire({id:e,label:i.label})}unregisterAuthenticationProvider(e){let i=this._authenticationProviders.get(e);i&&(this._authenticationProviders.delete(e),this._onDidUnregisterAuthenticationProvider.fire({id:e,label:i.label})),this._authenticationProviderDisposables.deleteAndDispose(e)}getProviderIds(){let e=[];return this._authenticationProviders.forEach(i=>{e.push(i.id)}),e}getProvider(e){if(this._authenticationProviders.has(e))return this._authenticationProviders.get(e);throw new Error(`No authentication provider '${e}' is currently registered.`)}async getAccounts(e){let i=await this.getSessions(e),n=new Array,o=new Set;for(let s of i)o.has(s.account.label)||(o.add(s.account.label),n.push(s.account));return n}async getSessions(e,i,n,o=!1){let s=this._authenticationProviders.get(e)||await this.tryActivateProvider(e,o);if(s)return await s.getSessions(i,{account:n});throw new Error(`No authentication provider '${e}' is currently registered.`)}async createSession(e,i,n){let o=this._authenticationProviders.get(e)||await this.tryActivateProvider(e,!!n?.activateImmediate);if(o)return await o.createSession(i,{account:n?.account});throw new Error(`No authentication provider '${e}' is currently registered.`)}async removeSession(e,i){let n=this._authenticationProviders.get(e);if(n)return n.removeSession(i);throw new Error(`No authentication provider '${e}' is currently registered.`)}async tryActivateProvider(e,i){await this._extensionService.activateByEvent(MDe(e),i?1:0);let n=this._authenticationProviders.get(e);if(n)return n;let o=new B,s=new Promise((l,d)=>{o.add(X.once(this.onDidRegisterAuthenticationProvider)(c=>{if(c.id===e)if(n=this._authenticationProviders.get(e),n)l(n);else throw new Error(`No authentication provider '${e}' is currently registered.`)}))}),a=new Promise((l,d)=>{let c=setTimeout(()=>{d("Timed out waiting for authentication provider to register")},5e3);o.add(le(()=>clearTimeout(c)))});return Promise.race([s,a]).finally(()=>o.dispose())}};XP=E([b(0,_n),b(1,xQ),b(2,ih)],XP);gi($P,XP,1);var YP=ke("settings-view-bar-icon",N.settingsGear,u("settingsViewBarIcon","Settings icon in the view bar.")),Awo=[YP,N.vm,N.server,N.recordKeys,N.deviceMobile,N.watch,N.vr,N.piano,N.ruby,N.code,N.coffee,N.snake,N.window,N.library,N.extensions,N.terminal,N.beaker,N.package,N.cloud,N.book,N.globe,N.database,N.notebook,N.robot,N.game,N.chip,N.music,N.gift,N.send,N.briefcase,N.megaphone,N.comment,N.telescope,N.creditCard,N.map,N.deviceCameraVideo,N.unmute,N.law,N.graphLine,N.heart,N.home,N.inbox,N.mortarBoard,N.rocket,N.magnet,N.lock,N.milestone,N.tag,N.pulse,N.radioTower,N.smiley,N.zap,N.squirrel,N.symbolColor,N.mail,N.key,N.pieChart,N.organization,N.preview,N.wand,N.starEmpty,N.lightbulb,N.symbolRuler,N.dashboard,N.calendar,N.shield,N.flame,N.compass,N.paintcan,N.archive,N.mic,N.jersey];var Mg=class extends R{constructor(e,i,n,o,s,a,l){super();this.contextMenuActionsProvider=e;this.colors=i;this.activityHoverOptions=n;this.instantiationService=s;this.storageService=a;this.extensionService=l;this.element=document.createElement("div");let d=()=>({anchorAlignment:o.getValue("workbench.sideBar.location")==="left"?1:0,anchorAxisAlignment:1});this.globalActivityActionBar=this._register(new Fi(this.element,{actionViewItemProvider:(c,p)=>{if(c.id===Rg)return this.instantiationService.createInstance(DT,this.contextMenuActionsProvider,{...p,colors:this.colors,hoverOptions:this.activityHoverOptions},d);if(c.id===Pg)return this.instantiationService.createInstance(np,this.contextMenuActionsProvider,{...p,colors:this.colors,hoverOptions:this.activityHoverOptions},d,h=>{h.unshift(fn({id:"hideAccounts",label:u("hideAccounts","Hide Accounts"),run:()=>Cz(a,!1)}),new Qt)});throw new Error(`No view item for action '${c.id}'`)},orientation:1,ariaLabel:u("manage","Manage"),preventLoopNavigation:!0})),this.accountsVisibilityPreference&&this.globalActivityActionBar.push(this.accountAction,{index:Mg.ACCOUNTS_ACTION_INDEX}),this.globalActivityActionBar.push(this.globalActivityAction),this.registerListeners()}static ACCOUNTS_ACTION_INDEX=0;static ACCOUNTS_ICON=ke("accounts-view-bar-icon",N.account,u("accountsViewBarIcon","Accounts icon in the view bar."));element;globalActivityAction=this._register(new et(Rg));accountAction=this._register(new et(Pg));globalActivityActionBar;registerListeners(){this.extensionService.whenInstalledExtensionsRegistered().then(()=>{this._store.isDisposed||this._register(this.storageService.onDidChangeValue(0,np.ACCOUNTS_VISIBILITY_PREFERENCE_KEY,this._store)(()=>this.toggleAccountsActivity()))})}create(e){e.appendChild(this.element)}focus(){this.globalActivityActionBar.focus(!0)}size(){return this.globalActivityActionBar.viewItems.length}getContextMenuActions(){return[fn({id:"toggleAccountsVisibility",label:u("accounts","Accounts"),checked:this.accountsVisibilityPreference,run:()=>this.accountsVisibilityPreference=!this.accountsVisibilityPreference})]}toggleAccountsActivity(){this.globalActivityActionBar.length()===2&&this.accountsVisibilityPreference||(this.globalActivityActionBar.length()===2?this.globalActivityActionBar.pull(Mg.ACCOUNTS_ACTION_INDEX):this.globalActivityActionBar.push(this.accountAction,{index:Mg.ACCOUNTS_ACTION_INDEX}))}get accountsVisibilityPreference(){return QP(this.storageService)}set accountsVisibilityPreference(e){Cz(this.storageService,e)}};Mg=E([b(3,se),b(4,ne),b(5,nt),b(6,_n)],Mg);var _T=class extends ip{constructor(e,i,n,o,s,a,l,d,c,p,h,m,f){super(i,{draggable:!1,icon:!0,hasPopup:!0,...n},()=>!0,a,l,h,m);this.menuId=e;this.contextMenuActionsProvider=o;this.contextMenuAlignmentOptions=s;this.menuService=d;this.contextMenuService=c;this.contextKeyService=p;this.activityService=f;this.updateItemActivity(),this._register(this.activityService.onDidChangeActivity(g=>{Bt(g)&&g===this.compositeBarActionItem.id&&this.updateItemActivity()}))}updateItemActivity(){let e=this.activityService.getActivity(this.compositeBarActionItem.id),i=e[0];if(i){let{badge:n,priority:o}=i;n instanceof ep&&e.length>1&&(i={badge:this.getCumulativeNumberBadge(e,o??0)})}this.action.activity=i}getCumulativeNumberBadge(e,i){let n=e.filter(a=>a.badge instanceof ep&&(a.priority??0)===i),o=n.reduce((a,l)=>a+l.badge.number,0),s=()=>n.reduce((a,l,d)=>(a=a+l.badge.getDescription(),d<n.length-1&&(a=`${a}
`),a),"");return new ep(o,s)}render(e){super.render(e),this._register(F(this.container,Q.MOUSE_DOWN,async i=>{Ve.stop(i,!0),i?.button!==2&&this.run()})),this._register(F(this.container,Q.CONTEXT_MENU,async i=>{i.stopPropagation();let n=new B,o=await this.resolveContextMenuActions(n),s=new _i(ue(this.container),i);this.contextMenuService.showContextMenu({getAnchor:()=>s,getActions:()=>o,onHide:()=>n.dispose()})})),this._register(F(this.container,Q.KEY_UP,i=>{let n=new ut(i);(n.equals(3)||n.equals(10))&&(Ve.stop(i,!0),this.run())})),this._register(F(this.container,At.Tap,i=>{Ve.stop(i,!0),this.run()}))}async resolveContextMenuActions(e){return this.contextMenuActionsProvider()}async run(){let e=new B,i=e.add(this.menuService.createMenu(this.menuId,this.contextKeyService)),n=await this.resolveMainMenuActions(i,e),{anchorAlignment:o,anchorAxisAlignment:s}=this.contextMenuAlignmentOptions()??{anchorAlignment:void 0,anchorAxisAlignment:void 0};this.contextMenuService.showContextMenu({getAnchor:()=>this.label,anchorAlignment:o,anchorAxisAlignment:s,getActions:()=>n,onHide:()=>e.dispose(),menuActionOptions:{renderShortTitle:!0}})}async resolveMainMenuActions(e,i){let n=[];return Vo(e,{renderShortTitle:!0},{primary:[],secondary:n}),n}};_T=E([b(5,Fe),b(6,Nt),b(7,jt),b(8,vt),b(9,re),b(10,se),b(11,Be),b(12,mv)],_T);var np=class extends _T{constructor(e,i,n,o,s,a,l,d,c,p,h,m,f,g,v,I,y,w,C,S){let D=C.createInstance(TT,{id:Pg,name:u("accounts","Accounts"),classNames:de.asClassNameArray(Mg.ACCOUNTS_ICON)});super(V.AccountsContext,D,i,e,n,s,l,c,d,p,g,v,w);this.fillContextMenuActions=o;this.lifecycleService=a;this.authenticationService=h;this.productService=f;this.secretStorageService=I;this.logService=y;this.commandService=S;this._register(D),this.registerListeners(),this.initialize()}static ACCOUNTS_VISIBILITY_PREFERENCE_KEY="workbench.activity.showAccounts";groupedAccounts=new Map;problematicProviders=new Set;initialized=!1;sessionFromEmbedder=new qn(()=>cme(this.secretStorageService,this.productService));registerListeners(){this._register(this.authenticationService.onDidRegisterAuthenticationProvider(async e=>{await this.addAccountsFromProvider(e.id)})),this._register(this.authenticationService.onDidUnregisterAuthenticationProvider(e=>{this.groupedAccounts.delete(e.id),this.problematicProviders.delete(e.id)})),this._register(this.authenticationService.onDidChangeSessions(async e=>{if(e.event.removed)for(let i of e.event.removed)this.removeAccount(e.providerId,i.account);for(let i of[...e.event.changed??[],...e.event.added??[]])try{await this.addOrUpdateAccount(e.providerId,i.account)}catch(n){this.logService.error(n)}}))}async initialize(){if(await this.lifecycleService.when(3),this._store.isDisposed)return;let e=this._register(Jv(ue(this.element),async()=>{await this.doInitialize(),e.dispose()}))}async doInitialize(){let e=this.authenticationService.getProviderIds(),i=await Promise.allSettled(e.map(n=>this.addAccountsFromProvider(n)));for(let n of i)n.status==="rejected"&&this.logService.error(n.reason);this.initialized=!0}async resolveMainMenuActions(e,i){await super.resolveMainMenuActions(e,i);let n=this.authenticationService.getProviderIds(),o=e.getActions(),s=[];for(let a of n){if(!this.initialized){let c=i.add(new et("noAccountsAvailable",u("loading","Loading..."),void 0,!1));s.push(c);break}let l=this.authenticationService.getProvider(a).label,d=this.groupedAccounts.get(a);if(!d){if(this.problematicProviders.has(a)){let c=i.add(new et("providerUnavailable",u("authProviderUnavailable","{0} is currently unavailable",l),void 0,!1));s.push(c);try{await this.addAccountsFromProvider(a)}catch(p){this.logService.error(p)}}continue}for(let c of d){let h=[fn({id:`configureSessions${c.label}`,label:u("manageTrustedExtensions","Manage Trusted Extensions"),enabled:!0,run:()=>this.commandService.executeCommand("_manageTrustedExtensionsForAccount",{providerId:a,accountLabel:c.label})})];c.canSignOut&&h.push(fn({id:"signOut",label:u("signOut","Sign Out"),enabled:!0,run:()=>this.commandService.executeCommand("_signOutOfAccount",{providerId:a,accountLabel:c.label})}));let m=new vo("activitybar.submenu",`${c.label} (${l})`,h);s.push(m)}}if(n.length&&!s.length){let a=i.add(new et("noAccountsAvailable",u("noAccounts","You are not signed in to any accounts"),void 0,!1));s.push(a)}return s.length&&o.length&&s.push(new Qt),o.forEach((a,l)=>{let d=a[1];s=s.concat(d),l!==o.length-1&&s.push(new Qt)}),s}async resolveContextMenuActions(e){let i=await super.resolveContextMenuActions(e);return this.fillContextMenuActions(i),i}async addOrUpdateAccount(e,i){let n=this.groupedAccounts.get(e);n||(n=[],this.groupedAccounts.set(e,n));let o=await this.sessionFromEmbedder.value,s=!0;o&&!o.canSignOut&&(await this.authenticationService.getSessions(e)).some(l=>l.id===o.id&&l.account.id===i.id)&&(s=!1);let a=n.find(l=>l.label===i.label);a?s||(a.canSignOut=s):n.push({...i,canSignOut:s})}removeAccount(e,i){let n=this.groupedAccounts.get(e);if(!n)return;let o=n.findIndex(s=>s.id===i.id);o!==-1&&(n.splice(o,1),n.length===0&&this.groupedAccounts.delete(e))}async addAccountsFromProvider(e){try{let i=await this.authenticationService.getSessions(e);this.problematicProviders.delete(e);for(let n of i)try{await this.addOrUpdateAccount(e,n.account)}catch(o){this.logService.error(o)}}catch(i){this.logService.error(i),this.problematicProviders.add(e)}}};np=E([b(4,Fe),b(5,er),b(6,Nt),b(7,vt),b(8,jt),b(9,re),b(10,$P),b(11,Jo),b(12,al),b(13,se),b(14,Be),b(15,EQ),b(16,bt),b(17,mv),b(18,ne),b(19,ct)],np);var DT=class extends _T{constructor(e,i,n,o,s,a,l,d,c,p,h,m,f,g){let v=f.createInstance(TT,{id:Rg,name:u("manage","Manage"),classNames:de.asClassNameArray(o.currentProfile.icon?de.fromId(o.currentProfile.icon):YP)});super(V.GlobalActivity,v,i,e,n,s,a,l,d,c,p,m,g);this.userDataProfileService=o;this._register(v),this._register(this.userDataProfileService.onDidChangeCurrentProfile(I=>{v.compositeBarActionItem={...v.compositeBarActionItem,classNames:de.asClassNameArray(o.currentProfile.icon?de.fromId(o.currentProfile.icon):YP)}}))}profileBadge;profileBadgeContent;render(e){super.render(e),this.profileBadge=U(e,J(".profile-badge")),this.profileBadgeContent=U(this.profileBadge,J(".profile-badge-content")),this.updateProfileBadge()}updateProfileBadge(){!this.profileBadge||!this.profileBadgeContent||(ai(this.profileBadgeContent),ji(this.profileBadge),!this.userDataProfileService.currentProfile.isDefault&&(this.userDataProfileService.currentProfile.icon&&this.userDataProfileService.currentProfile.icon!==YP.id||this.action.activity||(rn(this.profileBadge),this.profileBadgeContent.classList.toggle("profile-text-overlay",!0),this.profileBadgeContent.classList.toggle("profile-icon-overlay",!1),this.profileBadgeContent.textContent=this.userDataProfileService.currentProfile.name.substring(0,2).toUpperCase())))}updateActivity(){super.updateActivity(),this.updateProfileBadge()}computeTitle(){return this.userDataProfileService.currentProfile.isDefault?super.computeTitle():u("manage profile","Manage {0} (Profile)",this.userDataProfileService.currentProfile.name)}};DT=E([b(3,By),b(4,Fe),b(5,Nt),b(6,jt),b(7,vt),b(8,re),b(9,se),b(10,Jo),b(11,Be),b(12,ne),b(13,mv)],DT);var kT=class extends np{constructor(t,e,i,n,o,s,a,l,d,c,p,h,m,f,g,v,I,y,w){super(()=>ume(g,!0),{...e,colors:C=>({badgeBackground:C.getColor(bL),badgeForeground:C.getColor(vL)}),hoverOptions:t,compact:!0},()=>{},C=>C,i,n,o,s,a,l,d,c,p,h,m,f,v,I,y,w)}};kT=E([b(2,Fe),b(3,er),b(4,Nt),b(5,vt),b(6,jt),b(7,re),b(8,$P),b(9,Jo),b(10,al),b(11,se),b(12,Be),b(13,EQ),b(14,nt),b(15,bt),b(16,mv),b(17,ne),b(18,ct)],kT);var LT=class extends DT{constructor(t,e,i,n,o,s,a,l,d,c,p,h,m,f){super(()=>ume(f,!1),{...e,colors:g=>({badgeBackground:g.getColor(bL),badgeForeground:g.getColor(vL)}),hoverOptions:t,compact:!0},()=>{},i,n,o,s,a,l,d,c,p,h,m)}};LT=E([b(2,By),b(3,Fe),b(4,Nt),b(5,jt),b(6,vt),b(7,re),b(8,se),b(9,Jo),b(10,Be),b(11,ne),b(12,mv),b(13,nt)],LT);function ume(r,t){let e=[];return t&&e.push(fn({id:"hideAccounts",label:u("hideAccounts","Hide Accounts"),run:()=>Cz(r,!1)}),new Qt),[...e,fn({id:"toggle.hideAccounts",label:u("accounts","Accounts"),checked:QP(r),run:()=>Cz(r,!QP(r))}),fn({id:"toggle.hideManage",label:u("manage","Manage"),checked:!0,enabled:!1,run:()=>{throw new Error('"Manage" can not be hidden')}})]}function QP(r){return r.getBoolean(np.ACCOUNTS_VISIBILITY_PREFERENCE_KEY,0,!0)}function Cz(r,t){r.store(np.ACCOUNTS_VISIBILITY_PREFERENCE_KEY,t,0,0)}var rS=class extends Vf{constructor(e,i,n,o,s){super(e,{canAcceptInBackground:!0,noResultsPick:{label:u("noViewResults","No matching editors"),groupId:-1}});this.editorGroupService=i;this.editorService=n;this.modelService=o;this.languageService=s}pickState=new class{scorerCache=Object.create(null);isQuickNavigating=void 0;reset(e){e||(this.scorerCache=Object.create(null)),this.isQuickNavigating=e}};provide(e,i){return this.pickState.reset(!!e.quickNavigate),super.provide(e,i)}_getPicks(e){let i=cre(e),n=this.doGetEditorPickItems().filter(s=>{if(!i.normalized)return!0;let a=J0(s,i,!0,W8,this.pickState.scorerCache);return a.score?(s.highlights={label:a.labelMatch,description:a.descriptionMatch},!0):!1});if(i.normalized){let s=this.editorGroupService.getGroups(2).map(a=>a.id);n.sort((a,l)=>a.groupId!==l.groupId?s.indexOf(a.groupId)-s.indexOf(l.groupId):dre(a,l,i,!0,W8,this.pickState.scorerCache))}let o=[];if(this.editorGroupService.count>1){let s;for(let a of n){if(typeof s!="number"||s!==a.groupId){let l=this.editorGroupService.getGroup(a.groupId);l&&o.push({type:"separator",label:l.label}),s=a.groupId}o.push(a)}}else o.push(...n);return o}doGetEditorPickItems(){let e=this.doGetEditors(),i=new Map;for(let{groupId:n}of e)if(!i.has(n)){let o=this.editorGroupService.getGroup(n);o&&i.set(n,o.ariaLabel)}return this.doGetEditors().map(({editor:n,groupId:o})=>{let s=ro.getOriginalUri(n,{supportSideBySide:1}),a=n.isDirty()&&!n.isSaving(),l=n.getDescription(),d=l?`${n.getName()} ${l}`:n.getName();return{groupId:o,resource:s,label:n.getName(),ariaLabel:i.size>1?a?u("entryAriaLabelWithGroupDirty","{0}, unsaved changes, {1}",d,i.get(o)):u("entryAriaLabelWithGroup","{0}, {1}",d,i.get(o)):a?u("entryAriaLabelDirty","{0}, unsaved changes",d):d,description:l,iconClasses:ua(this.modelService,this.languageService,s,void 0,n.getIcon()).concat(n.getLabelExtraClasses()),italic:!this.editorGroupService.getGroup(o)?.isPinned(n),buttons:[{iconClass:a?"dirty-editor "+de.asClassName(N.closeDirty):de.asClassName(N.close),tooltip:u("closeEditor","Close Editor"),alwaysVisible:a}],trigger:async()=>{let c=this.editorGroupService.getGroup(o);return c&&(await c.closeEditor(n,{preserveFocus:!0}),!c.contains(n))?3:0},accept:(c,p)=>this.editorGroupService.getGroup(o)?.openEditor(n,{preserveFocus:p.inBackground})}})}};rS=E([b(1,gn),b(2,$e),b(3,qi),b(4,ti)],rS);var Iv=class extends rS{static PREFIX="edt active ";constructor(t,e,i,n){super(Iv.PREFIX,t,e,i,n)}doGetEditors(){let t=this.editorGroupService.activeGroup;return t.getEditors(0).map(e=>({editor:e,groupId:t.id}))}};Iv=E([b(0,gn),b(1,$e),b(2,qi),b(3,ti)],Iv);var sS=class extends rS{static PREFIX="edt ";constructor(t,e,i,n){super(sS.PREFIX,t,e,i,n)}doGetEditors(){let t=[];for(let e of this.editorGroupService.getGroups(2))for(let i of e.getEditors(1))t.push({editor:i,groupId:e.id});return t}};sS=E([b(0,gn),b(1,$e),b(2,qi),b(3,ti)],sS);var aS=class extends rS{static PREFIX="edt mru ";constructor(t,e,i,n){super(aS.PREFIX,t,e,i,n)}doGetEditors(){let t=[];for(let e of this.editorService.getEditors(0))t.push(e);return t}};aS=E([b(0,gn),b(1,$e),b(2,qi),b(3,ti)],aS);var yv=class extends oh{constructor(e,i,n,o,s,a,l,d,c,p){super(e,i,o,d,a);this.instantiationService=s;this.textResourceConfigurationService=l;this.editorService=c;this.editorGroupService=p;this.viewState=this.getEditorMemento(p,l,n,100)}viewState;groupListener=this._register(new yt);editorViewStateDisposables;setEditorVisible(e){this.groupListener.value=this.group.onWillCloseEditor(i=>this.onWillCloseEditor(i)),super.setEditorVisible(e)}onWillCloseEditor(e){let i=e.editor;i===this.input&&this.updateEditorViewState(i)}clearInput(){this.updateEditorViewState(this.input),super.clearInput()}saveState(){this.updateEditorViewState(this.input),super.saveState()}updateEditorViewState(e){if(!e||!this.tracksEditorViewState(e))return;let i=this.toEditorViewStateResource(e);i&&(this.tracksDisposedEditorViewState()||(this.editorViewStateDisposables||(this.editorViewStateDisposables=new Map),this.editorViewStateDisposables.has(e)||this.editorViewStateDisposables.set(e,X.once(e.onWillDispose)(()=>{this.clearEditorViewState(i,this.group),this.editorViewStateDisposables?.delete(e)}))),e.isDisposed()&&!this.tracksDisposedEditorViewState()||!this.shouldRestoreEditorViewState(e)&&!this.group.contains(e)?this.clearEditorViewState(i,this.group):e.isDisposed()||this.saveEditorViewState(i))}shouldRestoreEditorViewState(e,i){return i?.newInGroup?this.textResourceConfigurationService.getValue(ro.getOriginalUri(e,{supportSideBySide:1}),"workbench.editor.restoreViewState")!==!1:!0}getViewState(){let e=this.input;if(!e||!this.tracksEditorViewState(e))return;let i=this.toEditorViewStateResource(e);if(i)return this.computeEditorViewState(i)}saveEditorViewState(e){let i=this.computeEditorViewState(e);i&&this.viewState.saveEditorState(this.group,e,i)}loadEditorViewState(e,i){if(!e||!this.tracksEditorViewState(e)||!this.shouldRestoreEditorViewState(e,i))return;let n=this.toEditorViewStateResource(e);if(n)return this.viewState.loadEditorState(this.group,n)}moveEditorViewState(e,i,n){return this.viewState.moveEditorState(e,i,n)}clearEditorViewState(e,i){this.viewState.clearEditorState(e,i)}dispose(){if(super.dispose(),this.editorViewStateDisposables){for(let[,e]of this.editorViewStateDisposables)e.dispose();this.editorViewStateDisposables=void 0}}tracksDisposedEditorViewState(){return!1}};yv=E([b(3,Tt),b(4,ne),b(5,nt),b(6,Cs),b(7,Fe),b(8,$e),b(9,gn)],yv);function ODe(r){let t=r;return typeof t?.primary=="object"&&typeof t.secondary=="object"}var op=class extends yv{constructor(e,i,n,o,s,a,l,d,c){super(op.ID,e,op.VIEW_STATE_PREFERENCE_KEY,i,n,s,l,o,d,c);this.configurationService=a;this.registerListeners()}static ID=Kse;static SIDE_BY_SIDE_LAYOUT_SETTING="workbench.editor.splitInGroupLayout";static VIEW_STATE_PREFERENCE_KEY="sideBySideEditorViewState";get minimumPrimaryWidth(){return this.primaryEditorPane?this.primaryEditorPane.minimumWidth:0}get maximumPrimaryWidth(){return this.primaryEditorPane?this.primaryEditorPane.maximumWidth:Number.POSITIVE_INFINITY}get minimumPrimaryHeight(){return this.primaryEditorPane?this.primaryEditorPane.minimumHeight:0}get maximumPrimaryHeight(){return this.primaryEditorPane?this.primaryEditorPane.maximumHeight:Number.POSITIVE_INFINITY}get minimumSecondaryWidth(){return this.secondaryEditorPane?this.secondaryEditorPane.minimumWidth:0}get maximumSecondaryWidth(){return this.secondaryEditorPane?this.secondaryEditorPane.maximumWidth:Number.POSITIVE_INFINITY}get minimumSecondaryHeight(){return this.secondaryEditorPane?this.secondaryEditorPane.minimumHeight:0}get maximumSecondaryHeight(){return this.secondaryEditorPane?this.secondaryEditorPane.maximumHeight:Number.POSITIVE_INFINITY}set minimumWidth(e){}set maximumWidth(e){}set minimumHeight(e){}set maximumHeight(e){}get minimumWidth(){return this.minimumPrimaryWidth+this.minimumSecondaryWidth}get maximumWidth(){return this.maximumPrimaryWidth+this.maximumSecondaryWidth}get minimumHeight(){return this.minimumPrimaryHeight+this.minimumSecondaryHeight}get maximumHeight(){return this.maximumPrimaryHeight+this.maximumSecondaryHeight}_boundarySashes;onDidCreateEditors=this._register(new x);_onDidChangeSizeConstraints=this._register(new sc);onDidChangeSizeConstraints=X.any(this.onDidCreateEditors.event,this._onDidChangeSizeConstraints.event);_onDidChangeSelection=this._register(new x);onDidChangeSelection=this._onDidChangeSelection.event;primaryEditorPane=void 0;secondaryEditorPane=void 0;primaryEditorContainer;secondaryEditorContainer;splitview;splitviewDisposables=this._register(new B);editorDisposables=this._register(new B);orientation=this.configurationService.getValue(op.SIDE_BY_SIDE_LAYOUT_SETTING)==="vertical"?0:1;dimension=new Ge(0,0);lastFocusedSide=void 0;registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(e=>this.onConfigurationUpdated(e)))}onConfigurationUpdated(e){e.affectsConfiguration(op.SIDE_BY_SIDE_LAYOUT_SETTING)&&(this.orientation=this.configurationService.getValue(op.SIDE_BY_SIDE_LAYOUT_SETTING)==="vertical"?0:1,this.splitview&&this.recreateSplitview())}recreateSplitview(){let e=Yt(this.getContainer()),i=this.getSplitViewRatio();this.splitview&&(this.splitview.el.remove(),this.splitviewDisposables.clear()),this.createSplitView(e,i),this.layout(this.dimension)}getSplitViewRatio(){let e;if(this.splitview){let i=this.splitview.getViewSize(0),n=this.splitview.getViewSize(1);if(Math.abs(i-n)>1){let o=this.splitview.orientation===1?this.dimension.width:this.dimension.height;e=i/o}}return e}createEditor(e){e.classList.add("side-by-side-editor"),this.secondaryEditorContainer=J(".side-by-side-editor-container.editor-instance"),this.primaryEditorContainer=J(".side-by-side-editor-container.editor-instance"),this.createSplitView(e)}createSplitView(e,i){this.splitview=this.splitviewDisposables.add(new wc(e,{orientation:this.orientation})),this.splitviewDisposables.add(this.splitview.onDidSashReset(()=>this.splitview?.distributeViewSizes())),this.orientation===1?this.splitview.orthogonalEndSash=this._boundarySashes?.bottom:(this.splitview.orthogonalStartSash=this._boundarySashes?.left,this.splitview.orthogonalEndSash=this._boundarySashes?.right);let n=Rd.Distribute,o=Rd.Distribute;if(i){let l=this.splitview.orientation===1?this.dimension.width:this.dimension.height;n=Math.round(l*i),o=l-n,this.splitview.layout(this.orientation===1?this.dimension.width:this.dimension.height)}let s=Yt(this.secondaryEditorContainer);this.splitview.addView({element:s,layout:l=>this.layoutPane(this.secondaryEditorPane,l),minimumSize:this.orientation===1?eb.width:eb.height,maximumSize:Number.POSITIVE_INFINITY,onDidChange:X.None},n);let a=Yt(this.primaryEditorContainer);this.splitview.addView({element:a,layout:l=>this.layoutPane(this.primaryEditorPane,l),minimumSize:this.orientation===1?eb.width:eb.height,maximumSize:Number.POSITIVE_INFINITY,onDidChange:X.None},o),this.updateStyles()}getTitle(){return this.input?this.input.getName():u("sideBySideEditor","Side by Side Editor")}async setInput(e,i,n,o){let s=this.input;await super.setInput(e,i,n,o),(!s||!e.matches(s))&&(s&&this.disposeEditors(),this.createEditors(e));let{primary:a,secondary:l,viewState:d}=this.loadViewState(e,i,n);if(this.lastFocusedSide=d?.focus,typeof d?.ratio=="number"&&this.splitview){let c=this.splitview.orientation===1?this.dimension.width:this.dimension.height;this.splitview.resizeView(0,Math.round(c*d.ratio))}else this.splitview?.distributeViewSizes();await Promise.all([this.secondaryEditorPane?.setInput(e.secondary,l,n,o),this.primaryEditorPane?.setInput(e.primary,a,n,o)]),typeof i?.target=="number"&&(this.lastFocusedSide=i.target)}loadViewState(e,i,n){let o=ODe(i?.viewState)?i?.viewState:this.loadEditorViewState(e,n),s=Object.create(null),a;return i?.target===2?a={...i}:s={...i},s.viewState=o?.primary,o?.secondary&&(a?a.viewState=o?.secondary:a={viewState:o.secondary}),{primary:s,secondary:a,viewState:o}}createEditors(e){this.secondaryEditorPane=this.doCreateEditor(e.secondary,Yt(this.secondaryEditorContainer)),this.primaryEditorPane=this.doCreateEditor(e.primary,Yt(this.primaryEditorContainer)),this.layout(this.dimension),this._onDidChangeSizeConstraints.input=X.any(X.map(this.secondaryEditorPane.onDidChangeSizeConstraints,()=>{}),X.map(this.primaryEditorPane.onDidChangeSizeConstraints,()=>{})),this.onDidCreateEditors.fire(void 0),this.editorDisposables.add(this.primaryEditorPane.onDidFocus(()=>this.onDidFocusChange(1))),this.editorDisposables.add(this.secondaryEditorPane.onDidFocus(()=>this.onDidFocusChange(2)))}doCreateEditor(e,i){let n=Pe.as(Ld.EditorPane).getEditorPane(e);if(!n)throw new Error("No editor pane descriptor for editor found");let o=n.instantiate(this.instantiationService,this.group);return o.create(i),o.setVisible(this.isVisible()),e7(o)&&this.editorDisposables.add(o.onDidChangeSelection(s=>this._onDidChangeSelection.fire(s))),this.editorDisposables.add(o),o}onDidFocusChange(e){this.lastFocusedSide=e,this._onDidChangeControl.fire()}getSelection(){let e=this.getLastFocusedEditorPane();if(e7(e)){let i=e.getSelection();if(i)return new _Q(i,e===this.primaryEditorPane?1:2)}}setOptions(e){super.setOptions(e),typeof e?.target=="number"&&(this.lastFocusedSide=e.target),this.getLastFocusedEditorPane()?.setOptions(e)}setEditorVisible(e){this.primaryEditorPane?.setVisible(e),this.secondaryEditorPane?.setVisible(e),super.setEditorVisible(e)}clearInput(){super.clearInput(),this.primaryEditorPane?.clearInput(),this.secondaryEditorPane?.clearInput(),this.disposeEditors()}focus(){super.focus(),this.getLastFocusedEditorPane()?.focus()}getLastFocusedEditorPane(){return this.lastFocusedSide===2?this.secondaryEditorPane:this.primaryEditorPane}layout(e){this.dimension=e,Yt(this.splitview).layout(this.orientation===1?e.width:e.height)}setBoundarySashes(e){this._boundarySashes=e,this.splitview&&(this.splitview.orthogonalEndSash=e.bottom)}layoutPane(e,i){e?.layout(this.orientation===1?new Ge(i,this.dimension.height):new Ge(this.dimension.width,i))}getControl(){return this.getLastFocusedEditorPane()?.getControl()}getPrimaryEditorPane(){return this.primaryEditorPane}getSecondaryEditorPane(){return this.secondaryEditorPane}tracksEditorViewState(e){return e instanceof Fo}computeEditorViewState(e){if(!this.input||!zi(e,this.toEditorViewStateResource(this.input)))return;let i=this.primaryEditorPane?.getViewState(),n=this.secondaryEditorPane?.getViewState();if(!(!i||!n))return{primary:i,secondary:n,focus:this.lastFocusedSide,ratio:this.getSplitViewRatio()}}toEditorViewStateResource(e){let i,n;if(e instanceof Fo&&(i=e.primary.resource,n=e.secondary.resource),!(!n||!i))return Z.from({scheme:"sideBySide",path:`${YS(n.toString())}${YS(i.toString())}`})}updateStyles(){super.updateStyles(),this.primaryEditorContainer&&(this.orientation===1?(this.primaryEditorContainer.style.borderLeftWidth="1px",this.primaryEditorContainer.style.borderLeftStyle="solid",this.primaryEditorContainer.style.borderLeftColor=this.getColor(Cle)??"",this.primaryEditorContainer.style.borderTopWidth="0"):(this.primaryEditorContainer.style.borderTopWidth="1px",this.primaryEditorContainer.style.borderTopStyle="solid",this.primaryEditorContainer.style.borderTopColor=this.getColor(Sle)??"",this.primaryEditorContainer.style.borderLeftWidth="0"))}dispose(){this.disposeEditors(),super.dispose()}disposeEditors(){this.editorDisposables.clear(),this.secondaryEditorPane=void 0,this.primaryEditorPane=void 0,this.lastFocusedSide=void 0,this.secondaryEditorContainer&&ai(this.secondaryEditorContainer),this.primaryEditorContainer&&ai(this.primaryEditorContainer)}};op=E([b(1,Tt),b(2,ne),b(3,Fe),b(4,nt),b(5,se),b(6,Cs),b(7,$e),b(8,gn)],op);var _Q=class r{constructor(t,e){this.selection=t;this.side=e}compare(t){return t instanceof r?this.side!==t.side?3:this.selection.compare(t.selection):3}restore(t){let e={...t,target:this.side};return this.selection.restore(e)}};var Sv=class extends yv{constructor(e,i,n,o,s,a,l,d,c,p){super(e,i,Sv.VIEW_STATE_PREFERENCE_KEY,n,o,s,a,l,d,c);this.fileService=p;this._register(this.textResourceConfigurationService.onDidChangeConfiguration(h=>this.handleConfigurationChangeEvent(h))),this._register(X.any(this.editorGroupService.onDidAddGroup,this.editorGroupService.onDidRemoveGroup)(()=>{let h=this.computeAriaLabel();this.editorContainer?.setAttribute("aria-label",h),this.updateEditorControlOptions({ariaLabel:h})})),this._register(this.fileService.onDidChangeFileSystemProviderCapabilities(h=>this.onDidChangeFileSystemProvider(h.scheme))),this._register(this.fileService.onDidChangeFileSystemProviderRegistrations(h=>this.onDidChangeFileSystemProvider(h.scheme)))}static VIEW_STATE_PREFERENCE_KEY="textEditorViewState";_onDidChangeSelection=this._register(new x);onDidChangeSelection=this._onDidChangeSelection.event;_onDidChangeScroll=this._register(new x);onDidChangeScroll=this._onDidChangeScroll.event;editorContainer;hasPendingConfigurationChange;lastAppliedEditorOptions;inputListener=this._register(new yt);handleConfigurationChangeEvent(e){let i=this.getActiveResource();this.shouldHandleConfigurationChangeEvent(e,i)&&(this.isVisible()?this.updateEditorConfiguration(i):this.hasPendingConfigurationChange=!0)}shouldHandleConfigurationChangeEvent(e,i){return e.affectsConfiguration(i,"editor")||e.affectsConfiguration(i,"problems.visibility")}consumePendingConfigurationChangeEvent(){this.hasPendingConfigurationChange&&(this.updateEditorConfiguration(),this.hasPendingConfigurationChange=!1)}computeConfiguration(e){let i=vi(e.editor)?Xi(e.editor):Object.create(null);return Object.assign(i,this.getConfigurationOverrides(e)),i.ariaLabel=this.computeAriaLabel(),i}computeAriaLabel(){return this.input?H1(this.input,void 0,this.group,this.editorGroupService.count):u("editor","Editor")}onDidChangeFileSystemProvider(e){this.input&&this.getActiveResource()?.scheme===e&&this.updateReadonly(this.input)}onDidChangeInputCapabilities(e){this.input===e&&this.updateReadonly(e)}updateReadonly(e){this.updateEditorControlOptions({...this.getReadonlyConfiguration(e.isReadonly())})}getReadonlyConfiguration(e){return{readOnly:!!e,readOnlyMessage:typeof e!="boolean"?e:void 0}}getConfigurationOverrides(e){return{overviewRulerLanes:3,lineNumbersMinChars:3,fixedOverflowWidgets:!0,...this.getReadonlyConfiguration(this.input?.isReadonly()),renderValidationDecorations:e.problems?.visibility!==!1?"on":"off"}}createEditor(e){this.editorContainer=e,this.createEditorControl(e,this.computeConfiguration(this.textResourceConfigurationService.getValue(this.getActiveResource()))),this.registerCodeEditorListeners()}registerCodeEditorListeners(){let e=this.getMainControl();e&&(this._register(e.onDidChangeModelLanguage(()=>this.updateEditorConfiguration())),this._register(e.onDidChangeModel(()=>this.updateEditorConfiguration())),this._register(e.onDidChangeCursorPosition(i=>this._onDidChangeSelection.fire({reason:this.toEditorPaneSelectionChangeReason(i)}))),this._register(e.onDidChangeModelContent(()=>this._onDidChangeSelection.fire({reason:3}))),this._register(e.onDidScrollChange(()=>this._onDidChangeScroll.fire())))}toEditorPaneSelectionChangeReason(e){switch(e.source){case"api":return 1;case"code.navigation":return 4;case"code.jump":return 5;default:return 2}}getSelection(){let e=this.getMainControl();if(e){let i=e.getSelection();if(i)return new DQ(i)}}async setInput(e,i,n,o){await super.setInput(e,i,n,o),this.inputListener.value=e.onDidChangeCapabilities(()=>this.onDidChangeInputCapabilities(e)),this.updateEditorConfiguration(),Yt(this.editorContainer).setAttribute("aria-label",this.computeAriaLabel())}clearInput(){this.inputListener.clear(),super.clearInput()}getScrollPosition(){let e=this.getMainControl();if(!e)throw new Error("Control has not yet been initialized");return{scrollTop:e.getScrollTop()-e.getTopForLineNumber(1),scrollLeft:e.getScrollLeft()}}setScrollPosition(e){let i=this.getMainControl();if(!i)throw new Error("Control has not yet been initialized");i.setScrollTop(e.scrollTop),e.scrollLeft&&i.setScrollLeft(e.scrollLeft)}setEditorVisible(e){e&&this.consumePendingConfigurationChangeEvent(),super.setEditorVisible(e)}toEditorViewStateResource(e){return e.resource}updateEditorConfiguration(e=this.getActiveResource()){let i;if(e&&(i=this.textResourceConfigurationService.getValue(e)),!i)return;let n=this.computeConfiguration(i),o=n;this.lastAppliedEditorOptions&&(o=Ete(this.lastAppliedEditorOptions,o)),Object.keys(o).length>0&&(this.lastAppliedEditorOptions=n,this.updateEditorControlOptions(o))}getActiveResource(){let e=this.getMainControl();if(e){let i=e.getModel();if(i)return i.uri}if(this.input)return this.input.resource}dispose(){this.lastAppliedEditorOptions=void 0,super.dispose()}};Sv=E([b(2,Tt),b(3,ne),b(4,nt),b(5,Cs),b(6,Fe),b(7,$e),b(8,gn),b(9,Ei)],Sv);var DQ=class r{constructor(t){this.textSelection=t}static TEXT_EDITOR_SELECTION_THRESHOLD=10;compare(t){if(!(t instanceof r))return 3;let e=Math.min(this.textSelection.selectionStartLineNumber,this.textSelection.positionLineNumber),i=Math.min(t.textSelection.selectionStartLineNumber,t.textSelection.positionLineNumber);return e===i?1:Math.abs(e-i)<r.TEXT_EDITOR_SELECTION_THRESHOLD?2:3}restore(t){return{...t,selection:this.textSelection,selectionRevealType:1}}log(){return`line: ${this.textSelection.startLineNumber}-${this.textSelection.endLineNumber}, col:  ${this.textSelection.startColumn}-${this.textSelection.endColumn}`}};function kQ(r,t,e){let i=!1,n=NDe(r);if(Nk(n)&&(t.restoreViewState(n),i=!0),r.selection){let o={startLineNumber:r.selection.startLineNumber,startColumn:r.selection.startColumn,endLineNumber:r.selection.endLineNumber??r.selection.startLineNumber,endColumn:r.selection.endColumn??r.selection.startColumn};t.setSelection(o,r.selectionSource??"code.navigation"),r.selectionRevealType===2?t.revealRangeNearTop(o,e):r.selectionRevealType===3?t.revealRangeNearTopIfOutsideViewport(o,e):r.selectionRevealType===1?t.revealRangeInCenterIfOutsideViewport(o,e):t.revealRangeInCenter(o,e),i=!0}return i}function NDe(r){if(!r.selection||!r.viewState)return r.viewState;let t=r.viewState;if(t.modified)return t.modified.cursorState=[],t;let e=r.viewState;return e.cursorState&&(e.cursorState=[]),e}var RT=class extends Wf{_originalModel;get originalModel(){return this._originalModel}_modifiedModel;get modifiedModel(){return this._modifiedModel}constructor(t,e){super(),this._originalModel=t,this._modifiedModel=e}async resolve(){await Promise.all([this._originalModel?.resolve(),this._modifiedModel?.resolve()])}isResolved(){return!!(this._originalModel?.isResolved()&&this._modifiedModel?.isResolved())}dispose(){super.dispose()}};var PT=class extends RT{_originalModel;get originalModel(){return this._originalModel}_modifiedModel;get modifiedModel(){return this._modifiedModel}_textDiffEditorModel=void 0;get textDiffEditorModel(){return this._textDiffEditorModel}constructor(t,e){super(t,e),this._originalModel=t,this._modifiedModel=e,this.updateTextDiffEditorModel()}async resolve(){await super.resolve(),this.updateTextDiffEditorModel()}updateTextDiffEditorModel(){this.originalModel?.isResolved()&&this.modifiedModel?.isResolved()&&(this._textDiffEditorModel?(this._textDiffEditorModel.original=this.originalModel.textEditorModel,this._textDiffEditorModel.modified=this.modifiedModel.textEditorModel):this._textDiffEditorModel={original:this.originalModel.textEditorModel,modified:this.modifiedModel.textEditorModel})}isResolved(){return!!this._textDiffEditorModel}isReadonly(){return!!this.modifiedModel&&this.modifiedModel.isReadonly()}dispose(){this._textDiffEditorModel=void 0,super.dispose()}};var fl=class extends Fo{constructor(e,i,n,o,s,a){super(e,i,n,o,a);this.original=n;this.modified=o;this.forceOpenAsBinary=s}static ID="workbench.editors.diffEditorInput";get typeId(){return fl.ID}get editorId(){return this.modified.editorId===this.original.editorId?this.modified.editorId:void 0}get capabilities(){let e=super.capabilities;return this.labels.forceDescription&&(e|=64),e}cachedModel=void 0;labels=this.computeLabels();computeLabels(){let e,i=!1;if(this.preferredName)e=this.preferredName;else{let p=this.original.getName(),h=this.modified.getName();e=u("sideBySideLabels","{0} \u2194 {1}",p,h),i=p===h}let n,o,s;if(this.preferredDescription)n=this.preferredDescription,o=this.preferredDescription,s=this.preferredDescription;else{n=this.computeLabel(this.original.getDescription(0),this.modified.getDescription(0)),s=this.computeLabel(this.original.getDescription(2),this.modified.getDescription(2));let p=this.original.getDescription(1),h=this.modified.getDescription(1);if(typeof p=="string"&&typeof h=="string"&&(p||h)){let[m,f]=UN([p,h]);o=this.computeLabel(m,f)}}let a=this.computeLabel(this.original.getTitle(0)??this.original.getName(),this.modified.getTitle(0)??this.modified.getName()," \u2194 "),l=this.computeLabel(this.original.getTitle(1)??this.original.getName(),this.modified.getTitle(1)??this.modified.getName()," \u2194 "),d=this.computeLabel(this.original.getTitle(2)??this.original.getName(),this.modified.getTitle(2)??this.modified.getName()," \u2194 "),c=this.getPreferredTitle();return c&&(a=`${c} (${a})`,l=`${c} (${l})`,d=`${c} (${d})`),{name:e,shortDescription:n,mediumDescription:o,longDescription:s,forceDescription:i,shortTitle:a,mediumTitle:l,longTitle:d}}computeLabel(e,i,n=" - "){if(!(!e||!i))return e===i?i:`${e}${n}${i}`}getName(){return this.labels.name}getDescription(e=1){switch(e){case 0:return this.labels.shortDescription;case 2:return this.labels.longDescription;case 1:default:return this.labels.mediumDescription}}getTitle(e){switch(e){case 0:return this.labels.shortTitle;case 2:return this.labels.longTitle;default:case 1:return this.labels.mediumTitle}}async resolve(){let e=await this.createModel();return this.cachedModel?.dispose(),this.cachedModel=e,this.cachedModel}prefersEditorPane(e){return this.forceOpenAsBinary?e.find(i=>i.typeId===Gse):e.find(i=>i.typeId===n1)}async createModel(){let[e,i]=await Promise.all([this.original.resolve(),this.modified.resolve()]);return i instanceof vu&&e instanceof vu?new PT(e,i):new RT(R8(e)?e:void 0,R8(i)?i:void 0)}toUntyped(e){let i=super.toUntyped(e);if(i)return{...i,modified:i.primary,original:i.secondary}}matches(e){return this===e?!0:e instanceof fl?this.modified.matches(e.modified)&&this.original.matches(e.original)&&e.forceOpenAsBinary===this.forceOpenAsBinary:kd(e)?this.modified.matches(e.modified)&&this.original.matches(e.original):!1}dispose(){this.cachedModel&&(this.cachedModel.dispose(),this.cachedModel=void 0),super.dispose()}};fl=E([b(5,$e)],fl);function pme(r,t,e,i){if(r.length===0)return t;if(t.length===0)return r;let n=[],o=0,s=0;for(;o<r.length&&s<t.length;){let a=r[o],l=t[s],d=e(a),c=e(l);d<c?(n.push(a),o++):d>c?(n.push(l),s++):(n.push(i(a,l)),o++,s++)}for(;o<r.length;)n.push(r[o]),o++;for(;s<t.length;)n.push(t[s]),s++;return n}function MT(r,t){let e=new B,i=r.createDecorationsCollection();return e.add(fp({debugName:()=>`Apply decorations from ${t.debugName}`},n=>{let o=t.read(n);i.set(o)})),e.add({dispose:()=>{i.clear()}}),e}function cS(r,t){return r.appendChild(t),le(()=>{t.remove()})}function hme(r,t){return r.prepend(t),le(()=>{t.remove()})}var wz=class extends R{elementSizeObserver;_width;get width(){return this._width}_height;get height(){return this._height}_automaticLayout=!1;get automaticLayout(){return this._automaticLayout}constructor(t,e){super(),this.elementSizeObserver=this._register(new ZS(t,e)),this._width=Ht(this,this.elementSizeObserver.getWidth()),this._height=Ht(this,this.elementSizeObserver.getHeight()),this._register(this.elementSizeObserver.onDidChange(i=>nn(n=>{this._width.set(this.elementSizeObserver.getWidth(),n),this._height.set(this.elementSizeObserver.getHeight(),n)})))}observe(t){this.elementSizeObserver.observe(t)}setAutomaticLayout(t){this._automaticLayout=t,t?this.elementSizeObserver.startObserving():this.elementSizeObserver.stopObserving()}};function PQ(r,t,e){let i=t.get(),n=i,o=i,s=Ht("animatedValue",i),a=-1,l=300,d;e.add(Gg({createEmptyChangeSummary:()=>({animate:!1}),handleChange:(p,h)=>(p.didChange(t)&&(h.animate=h.animate||p.change),!0)},(p,h)=>{d!==void 0&&(r.cancelAnimationFrame(d),d=void 0),n=o,i=t.read(p),a=Date.now()-(h.animate?0:l),c()}));function c(){let p=Date.now()-a;o=Math.floor(FDe(p,n,i-n,l)),p<l?d=r.requestAnimationFrame(c):o=i,s.set(o,void 0)}return s}function FDe(r,t,e,i){return r===i?t+e:e*(-Math.pow(2,-10*r/i)+1)+t}var lS=class extends R{constructor(t,e,i){super(),this._register(new LQ(t,i)),this._register(ec(i,{height:e.actualHeight,top:e.actualTop}))}},Yh=class{constructor(t,e){this._afterLineNumber=t;this.heightInPx=e}domNode=document.createElement("div");_actualTop=Ht(this,void 0);_actualHeight=Ht(this,void 0);actualTop=this._actualTop;actualHeight=this._actualHeight;showInHiddenAreas=!0;get afterLineNumber(){return this._afterLineNumber.get()}onChange=this._afterLineNumber;onDomNodeTop=t=>{this._actualTop.set(t,void 0)};onComputedHeight=t=>{this._actualHeight.set(t,void 0)}},LQ=class r{constructor(t,e){this._editor=t;this._domElement=e;this._editor.addOverlayWidget(this._overlayWidget)}static _counter=0;_overlayWidgetId=`managedOverlayWidget-${r._counter++}`;_overlayWidget={getId:()=>this._overlayWidgetId,getDomNode:()=>this._domElement,getPosition:()=>null};dispose(){this._editor.removeOverlayWidget(this._overlayWidget)}};function ec(r,t){return Ft(e=>{for(let[i,n]of Object.entries(t))n&&typeof n=="object"&&"read"in n&&(n=n.read(e)),typeof n=="number"&&(n=`${n}px`),i=i.replace(/[A-Z]/g,o=>"-"+o.toLowerCase()),r.style[i]=n})}function AT(r,t,e,i){let n=new B,o=[];return n.add(Cr((s,a)=>{let l=t.read(s),d=new Map,c=new Map;e&&e(!0),r.changeViewZones(p=>{for(let h of o)p.removeZone(h),i?.delete(h);o.length=0;for(let h of l){let m=p.addZone(h);h.setZoneId&&h.setZoneId(m),o.push(m),i?.add(m),d.set(h,m)}}),e&&e(!1),a.add(Gg({createEmptyChangeSummary(){return{zoneIds:[]}},handleChange(p,h){let m=c.get(p.changedObservable);return m!==void 0&&h.zoneIds.push(m),!0}},(p,h)=>{for(let m of l)m.onChange&&(c.set(m.onChange,d.get(m)),m.onChange.read(p));e&&e(!0),r.changeViewZones(m=>{for(let f of h.zoneIds)m.layoutZone(f)}),e&&e(!1)}))})),n.add({dispose(){e&&e(!0),r.changeViewZones(s=>{for(let a of o)s.removeZone(a)}),i?.clear(),e&&e(!1)}}),n}function MQ(r,t){let e=lm(t,n=>n.original.startLineNumber<=r.lineNumber);if(!e)return L.fromPositions(r);if(e.original.endLineNumberExclusive<=r.lineNumber){let n=r.lineNumber-e.original.endLineNumberExclusive+e.modified.endLineNumberExclusive;return L.fromPositions(new H(n,r.column))}if(!e.innerChanges)return L.fromPositions(new H(e.modified.startLineNumber,1));let i=lm(e.innerChanges,n=>n.originalRange.getStartPosition().isBeforeOrEqual(r));if(!i){let n=r.lineNumber-e.original.startLineNumber+e.modified.startLineNumber;return L.fromPositions(new H(n,r.column))}if(i.originalRange.containsPosition(r))return i.modifiedRange;{let n=BDe(i.originalRange.getEndPosition(),r);return L.fromPositions(n.addToPosition(i.modifiedRange.getEndPosition()))}}function BDe(r,t){return r.lineNumber===t.lineNumber?new pr(0,t.column-r.column):new pr(t.lineNumber-r.lineNumber,t.column-1)}function mme(r,t){let e;return r.filter(i=>{let n=t(i,e);return e=i,n})}var dS=class{static create(t,e=void 0){return new ZP(t,t,e)}static createWithDisposable(t,e,i=void 0){let n=new B;return n.add(e),n.add(t),new ZP(t,n,i)}static createOfNonDisposable(t,e,i=void 0){return new ZP(t,e,i)}},ZP=class extends dS{constructor(e,i,n){super();this.object=e;this._disposable=i;this._debugOwner=n;n&&this._addOwner(n)}_refCount=1;_isDisposed=!1;_owners=[];_addOwner(e){e&&this._owners.push(e)}createNewRef(e){return this._refCount++,e&&this._addOwner(e),new RQ(this,e)}dispose(){this._isDisposed||(this._isDisposed=!0,this._decreaseRefCount(this._debugOwner))}_decreaseRefCount(e){if(this._refCount--,this._refCount===0&&this._disposable.dispose(),e){let i=this._owners.indexOf(e);i!==-1&&this._owners.splice(i,1)}}},RQ=class extends dS{constructor(e,i){super();this._base=e;this._debugOwner=i}_isDisposed=!1;get object(){return this._base.object}createNewRef(e){return this._base.createNewRef(e)}dispose(){this._isDisposed||(this._isDisposed=!0,this._base._decreaseRefCount(this._debugOwner))}};function uS(r){return AQ.get(r)}var AQ=class r extends R{constructor(e){super();this.editor=e;this._register(this.editor.onBeginUpdate(()=>this._beginUpdate())),this._register(this.editor.onEndUpdate(()=>this._endUpdate())),this._register(this.editor.onDidChangeModel(()=>{this._beginUpdate();try{this._model.set(this.editor.getModel(),this._currentTransaction),this._forceUpdate()}finally{this._endUpdate()}})),this._register(this.editor.onDidType(i=>{this._beginUpdate();try{this._forceUpdate(),this.onDidType.trigger(this._currentTransaction,i)}finally{this._endUpdate()}})),this._register(this.editor.onDidChangeModelContent(i=>{this._beginUpdate();try{this._versionId.set(this.editor.getModel()?.getVersionId()??null,this._currentTransaction,i),this._forceUpdate()}finally{this._endUpdate()}})),this._register(this.editor.onDidChangeCursorSelection(i=>{this._beginUpdate();try{this._selections.set(this.editor.getSelections(),this._currentTransaction,i),this._forceUpdate()}finally{this._endUpdate()}}))}static _map=new Map;static get(e){let i=r._map.get(e);if(!i){i=new r(e),r._map.set(e,i);let n=e.onDidDispose(()=>{let o=r._map.get(e);o&&(r._map.delete(e),o.dispose(),n.dispose())})}return i}_updateCounter=0;_currentTransaction=void 0;_beginUpdate(){this._updateCounter++,this._updateCounter===1&&(this._currentTransaction=new jg(()=>{}))}_endUpdate(){if(this._updateCounter--,this._updateCounter===0){let e=this._currentTransaction;this._currentTransaction=void 0,e.finish()}}forceUpdate(e){this._beginUpdate();try{return this._forceUpdate(),e?e(this._currentTransaction):void 0}finally{this._endUpdate()}}_forceUpdate(){this._beginUpdate();try{this._model.set(this.editor.getModel(),this._currentTransaction),this._versionId.set(this.editor.getModel()?.getVersionId()??null,this._currentTransaction,void 0),this._selections.set(this.editor.getSelections(),this._currentTransaction,void 0)}finally{this._endUpdate()}}_model=Ht(this,this.editor.getModel());model=this._model;isReadonly=Pi(this,this.editor.onDidChangeConfiguration,()=>this.editor.getOption(93));_versionId=rA({owner:this,lazy:!0},this.editor.getModel()?.getVersionId()??null);versionId=this._versionId;_selections=rA({owner:this,equalsFn:_S(TS(Et.selectionsEqual)),lazy:!0},this.editor.getSelections()??null);selections=this._selections;positions=Os({owner:this,equalsFn:_S(TS(H.equals))},e=>this.selections.read(e)?.map(i=>i.getStartPosition())??null);isFocused=Pi(this,e=>{let i=this.editor.onDidFocusEditorWidget(e),n=this.editor.onDidBlurEditorWidget(e);return{dispose(){i.dispose(),n.dispose()}}},()=>this.editor.hasWidgetFocus());value=kS(this,e=>(this.versionId.read(e),this.model.read(e)?.getValue()??""),(e,i)=>{let n=this.model.get();n!==null&&e!==n.getValue()&&n.setValue(e)});valueIsEmpty=dt(this,e=>(this.versionId.read(e),this.editor.getModel()?.getValueLength()===0));cursorSelection=Os({owner:this,equalsFn:_S(Et.selectionsEqual)},e=>this.selections.read(e)?.[0]??null);cursorPosition=Os({owner:this,equalsFn:H.equals},e=>this.selections.read(e)?.[0]?.getPosition()??null);onDidType=Ip(this);scrollTop=Pi(this.editor.onDidScrollChange,()=>this.editor.getScrollTop());scrollLeft=Pi(this.editor.onDidScrollChange,()=>this.editor.getScrollLeft());layoutInfo=Pi(this.editor.onDidLayoutChange,()=>this.editor.getLayoutInfo());layoutInfoContentLeft=this.layoutInfo.map(e=>e.contentLeft);layoutInfoDecorationsLeft=this.layoutInfo.map(e=>e.decorationsLeft);contentWidth=Pi(this.editor.onDidContentSizeChange,()=>this.editor.getContentWidth());getOption(e){return Pi(this,i=>this.editor.onDidChangeConfiguration(n=>{n.hasChanged(e)&&i(void 0)}),()=>this.editor.getOption(e))}setDecorations(e){let i=new B,n=this.editor.createDecorationsCollection();return i.add(fp({owner:this,debugName:()=>`Apply decorations from ${e.debugName}`},o=>{let s=e.read(o);n.set(s)})),i.add({dispose:()=>{n.clear()}}),i}_overlayWidgetCounter=0;createOverlayWidget(e){let i="observableOverlayWidget"+this._overlayWidgetCounter++,n={getDomNode:()=>e.domNode,getPosition:()=>e.position.get(),getId:()=>i,allowEditorOverflow:e.allowEditorOverflow,getMinContentWidthInPx:()=>e.minContentWidthInPx.get()};this.editor.addOverlayWidget(n);let o=Ft(s=>{e.position.read(s),e.minContentWidthInPx.read(s),this.editor.layoutOverlayWidget(n)});return le(()=>{o.dispose(),this.editor.removeOverlayWidget(n)})}};var OQ=q("diffProviderFactoryService"),JP=class{constructor(t){this.instantiationService=t}_serviceBrand;createDiffProvider(t){return this.instantiationService.createInstance(rp,t)}};JP=E([b(0,ne)],JP);gi(OQ,JP,1);var rp=class{constructor(t,e,i){this.editorWorkerService=e;this.telemetryService=i;this.setOptions(t)}onDidChangeEventEmitter=new x;onDidChange=this.onDidChangeEventEmitter.event;diffAlgorithm="advanced";diffAlgorithmOnDidChangeSubscription=void 0;static diffCache=new Map;dispose(){this.diffAlgorithmOnDidChangeSubscription?.dispose()}async computeDiff(t,e,i,n){if(typeof this.diffAlgorithm!="string")return this.diffAlgorithm.computeDiff(t,e,i,n);if(t.isDisposed()||e.isDisposed())return{changes:[],identical:!0,quitEarly:!1,moves:[]};if(t.getLineCount()===1&&t.getLineMaxColumn(1)===1)return e.getLineCount()===1&&e.getLineMaxColumn(1)===1?{changes:[],identical:!0,quitEarly:!1,moves:[]}:{changes:[new Ll(new ht(1,2),new ht(1,e.getLineCount()+1),[new ea(t.getFullModelRange(),e.getFullModelRange())])],identical:!1,quitEarly:!1,moves:[]};let o=JSON.stringify([t.uri.toString(),e.uri.toString()]),s=JSON.stringify([t.id,e.id,t.getAlternativeVersionId(),e.getAlternativeVersionId(),JSON.stringify(i)]),a=rp.diffCache.get(o);if(a&&a.context===s)return a.result;let l=Ko.create(),d=await this.editorWorkerService.computeDiff(t.uri,e.uri,i,this.diffAlgorithm),c=l.elapsed();if(this.telemetryService.publicLog2("diffEditor.computeDiff",{timeMs:c,timedOut:d?.quitEarly??!0,detectedMoves:i.computeMoves?d?.moves.length??0:-1}),n.isCancellationRequested)return{changes:[],identical:!1,quitEarly:!0,moves:[]};if(!d)throw new Error("no diff result available");return rp.diffCache.size>10&&rp.diffCache.delete(rp.diffCache.keys().next().value),rp.diffCache.set(o,{result:d,context:s}),d}setOptions(t){let e=!1;t.diffAlgorithm&&this.diffAlgorithm!==t.diffAlgorithm&&(this.diffAlgorithmOnDidChangeSubscription?.dispose(),this.diffAlgorithmOnDidChangeSubscription=void 0,this.diffAlgorithm=t.diffAlgorithm,typeof t.diffAlgorithm!="string"&&(this.diffAlgorithmOnDidChangeSubscription=t.diffAlgorithm.onDidChange(()=>this.onDidChangeEventEmitter.fire())),e=!0),e&&this.onDidChangeEventEmitter.fire()}};rp=E([b(1,hg),b(2,Tt)],rp);function xz(){return oc&&!!oc.VSCODE_DEV}function NQ(r){if(xz()){let t=VDe();return t.add(r),{dispose(){t.delete(r)}}}else return{dispose(){}}}function VDe(){Ez||(Ez=new Set);let r=globalThis;return r.$hotReload_applyNewExports||(r.$hotReload_applyNewExports=t=>{let e={config:{mode:void 0},...t},i=[];for(let n of Ez){let o=n(e);o&&i.push(o)}if(i.length>0)return n=>{let o=!1;for(let s of i)s(n)&&(o=!0);return o}}),Ez}var Ez;xz()&&NQ(({oldExports:r,newSrc:t,config:e})=>{if(e.mode==="patch-prototype")return i=>{for(let n in i){let o=i[n];if(console.log(`[hot-reload] Patching prototype methods of '${n}'`,{exportedItem:o}),typeof o=="function"&&o.prototype){let s=r[n];if(s){for(let a of Object.getOwnPropertyNames(o.prototype)){let l=Object.getOwnPropertyDescriptor(o.prototype,a),d=Object.getOwnPropertyDescriptor(s.prototype,a);l?.value?.toString()!==d?.value?.toString()&&console.log(`[hot-reload] Patching prototype method '${n}.${a}'`),Object.defineProperty(s.prototype,a,l)}i[n]=s}}}return!0}});function Fc(r,t){return WDe([r],t),r}function WDe(r,t){xz()&&hs("reload",i=>NQ(({oldExports:n})=>{if([...Object.values(n)].some(o=>r.includes(o)))return o=>(i(void 0),!0)})).read(t)}var Zh=class r{constructor(t,e){this.diffs=t;this.hitTimeout=e}static trivial(t,e){return new r([new Co(Qe.ofLength(t.length),Qe.ofLength(e.length))],!1)}static trivialTimedOut(t,e){return new r([new Co(Qe.ofLength(t.length),Qe.ofLength(e.length))],!0)}},Co=class r{constructor(t,e){this.seq1Range=t;this.seq2Range=e}static invert(t,e){let i=[];return zM(t,(n,o)=>{i.push(r.fromOffsetPairs(n?n.getEndExclusives():Qh.zero,o?o.getStarts():new Qh(e,(n?n.seq2Range.endExclusive-n.seq1Range.endExclusive:0)+e)))}),i}static fromOffsetPairs(t,e){return new r(new Qe(t.offset1,e.offset1),new Qe(t.offset2,e.offset2))}static assertSorted(t){let e;for(let i of t){if(e&&!(e.seq1Range.endExclusive<=i.seq1Range.start&&e.seq2Range.endExclusive<=i.seq2Range.start))throw new _t("Sequence diffs must be sorted");e=i}}swap(){return new r(this.seq2Range,this.seq1Range)}toString(){return`${this.seq1Range} <-> ${this.seq2Range}`}join(t){return new r(this.seq1Range.join(t.seq1Range),this.seq2Range.join(t.seq2Range))}delta(t){return t===0?this:new r(this.seq1Range.delta(t),this.seq2Range.delta(t))}deltaStart(t){return t===0?this:new r(this.seq1Range.deltaStart(t),this.seq2Range.deltaStart(t))}deltaEnd(t){return t===0?this:new r(this.seq1Range.deltaEnd(t),this.seq2Range.deltaEnd(t))}intersectsOrTouches(t){return this.seq1Range.intersectsOrTouches(t.seq1Range)||this.seq2Range.intersectsOrTouches(t.seq2Range)}intersect(t){let e=this.seq1Range.intersect(t.seq1Range),i=this.seq2Range.intersect(t.seq2Range);if(!(!e||!i))return new r(e,i)}getStarts(){return new Qh(this.seq1Range.start,this.seq2Range.start)}getEndExclusives(){return new Qh(this.seq1Range.endExclusive,this.seq2Range.endExclusive)}},Qh=class r{constructor(t,e){this.offset1=t;this.offset2=e}static zero=new r(0,0);static max=new r(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER);toString(){return`${this.offset1} <-> ${this.offset2}`}delta(t){return t===0?this:new r(this.offset1+t,this.offset2+t)}equals(t){return this.offset1===t.offset1&&this.offset2===t.offset2}},Cv=class r{static instance=new r;isValid(){return!0}},Tz=class{constructor(t){this.timeout=t;if(t<=0)throw new _t("timeout must be positive")}startTime=Date.now();valid=!0;isValid(){return!(Date.now()-this.startTime<this.timeout)&&this.valid&&(this.valid=!1),this.valid}disable(){this.timeout=Number.MAX_SAFE_INTEGER,this.isValid=()=>!0,this.valid=!0}};var OT=class{constructor(t,e){this.width=t;this.height=e;this.array=new Array(t*e)}array=[];get(t,e){return this.array[t+e*this.width]}set(t,e,i){this.array[t+e*this.width]=i}};function tM(r){return r===32||r===9}var eM=class r{constructor(t,e,i){this.range=t;this.lines=e;this.source=i;let n=0;for(let o=t.startLineNumber-1;o<t.endLineNumberExclusive-1;o++){let s=e[o];for(let l=0;l<s.length;l++){n++;let d=s[l],c=r.getKey(d);this.histogram[c]=(this.histogram[c]||0)+1}n++;let a=r.getKey(`
`);this.histogram[a]=(this.histogram[a]||0)+1}this.totalCount=n}static chrKeys=new Map;static getKey(t){let e=this.chrKeys.get(t);return e===void 0&&(e=this.chrKeys.size,this.chrKeys.set(t,e)),e}totalCount;histogram=[];computeSimilarity(t){let e=0,i=Math.max(this.histogram.length,t.histogram.length);for(let n=0;n<i;n++)e+=Math.abs((this.histogram[n]??0)-(t.histogram[n]??0));return 1-e/(this.totalCount+t.totalCount)}};var _z=class{compute(t,e,i=Cv.instance,n){if(t.length===0||e.length===0)return Zh.trivial(t,e);let o=new OT(t.length,e.length),s=new OT(t.length,e.length),a=new OT(t.length,e.length);for(let f=0;f<t.length;f++)for(let g=0;g<e.length;g++){if(!i.isValid())return Zh.trivialTimedOut(t,e);let v=f===0?0:o.get(f-1,g),I=g===0?0:o.get(f,g-1),y;t.getElement(f)===e.getElement(g)?(f===0||g===0?y=0:y=o.get(f-1,g-1),f>0&&g>0&&s.get(f-1,g-1)===3&&(y+=a.get(f-1,g-1)),y+=n?n(f,g):1):y=-1;let w=Math.max(v,I,y);if(w===y){let C=f>0&&g>0?a.get(f-1,g-1):0;a.set(f,g,C+1),s.set(f,g,3)}else w===v?(a.set(f,g,0),s.set(f,g,1)):w===I&&(a.set(f,g,0),s.set(f,g,2));o.set(f,g,w)}let l=[],d=t.length,c=e.length;function p(f,g){(f+1!==d||g+1!==c)&&l.push(new Co(new Qe(f+1,d),new Qe(g+1,c))),d=f,c=g}let h=t.length-1,m=e.length-1;for(;h>=0&&m>=0;)s.get(h,m)===3?(p(h,m),h--,m--):s.get(h,m)===1?h--:m--;return p(-1,-1),l.reverse(),new Zh(l,!1)}};var NT=class{compute(t,e,i=Cv.instance){if(t.length===0||e.length===0)return Zh.trivial(t,e);let n=t,o=e;function s(g,v){for(;g<n.length&&v<o.length&&n.getElement(g)===o.getElement(v);)g++,v++;return g}let a=0,l=new FQ;l.set(0,s(0,0));let d=new BQ;d.set(0,l.get(0)===0?null:new Dz(null,0,0,l.get(0)));let c=0;e:for(;;){if(a++,!i.isValid())return Zh.trivialTimedOut(n,o);let g=-Math.min(a,o.length+a%2),v=Math.min(a,n.length+a%2);for(c=g;c<=v;c+=2){let I=0,y=c===v?-1:l.get(c+1),w=c===g?-1:l.get(c-1)+1;I++;let C=Math.min(Math.max(y,w),n.length),S=C-c;if(I++,C>n.length||S>o.length)continue;let D=s(C,S);l.set(c,D);let k=C===y?d.get(c+1):d.get(c-1);if(d.set(c,D!==C?new Dz(k,C,S,D-C):k),l.get(c)===n.length&&l.get(c)-c===o.length)break e}}let p=d.get(c),h=[],m=n.length,f=o.length;for(;;){let g=p?p.x+p.length:0,v=p?p.y+p.length:0;if((g!==m||v!==f)&&h.push(new Co(new Qe(g,m),new Qe(v,f))),!p)break;m=p.x,f=p.y,p=p.prev}return h.reverse(),new Zh(h,!1)}},Dz=class{constructor(t,e,i,n){this.prev=t;this.x=e;this.y=i;this.length=n}},FQ=class{positiveArr=new Int32Array(10);negativeArr=new Int32Array(10);get(t){return t<0?(t=-t-1,this.negativeArr[t]):this.positiveArr[t]}set(t,e){if(t<0){if(t=-t-1,t>=this.negativeArr.length){let i=this.negativeArr;this.negativeArr=new Int32Array(i.length*2),this.negativeArr.set(i)}this.negativeArr[t]=e}else{if(t>=this.positiveArr.length){let i=this.positiveArr;this.positiveArr=new Int32Array(i.length*2),this.positiveArr.set(i)}this.positiveArr[t]=e}}},BQ=class{positiveArr=[];negativeArr=[];get(t){return t<0?(t=-t-1,this.negativeArr[t]):this.positiveArr[t]}set(t,e){t<0?(t=-t-1,this.negativeArr[t]=e):this.positiveArr[t]=e}};var wv=class{constructor(t,e,i){this.lines=t;this.range=e;this.considerWhitespaceChanges=i;this.firstElementOffsetByLineIdx.push(0);for(let n=this.range.startLineNumber;n<=this.range.endLineNumber;n++){let o=t[n-1],s=0;n===this.range.startLineNumber&&this.range.startColumn>1&&(s=this.range.startColumn-1,o=o.substring(s)),this.lineStartOffsets.push(s);let a=0;if(!i){let d=o.trimStart();a=o.length-d.length,o=d.trimEnd()}this.trimmedWsLengthsByLineIdx.push(a);let l=n===this.range.endLineNumber?Math.min(this.range.endColumn-1-s-a,o.length):o.length;for(let d=0;d<l;d++)this.elements.push(o.charCodeAt(d));n<this.range.endLineNumber&&(this.elements.push(10),this.firstElementOffsetByLineIdx.push(this.elements.length))}}elements=[];firstElementOffsetByLineIdx=[];lineStartOffsets=[];trimmedWsLengthsByLineIdx=[];toString(){return`Slice: "${this.text}"`}get text(){return this.getText(new Qe(0,this.length))}getText(t){return this.elements.slice(t.start,t.endExclusive).map(e=>String.fromCharCode(e)).join("")}getElement(t){return this.elements[t]}get length(){return this.elements.length}getBoundaryScore(t){let e=fme(t>0?this.elements[t-1]:-1),i=fme(t<this.elements.length?this.elements[t]:-1);if(e===7&&i===8)return 0;if(e===8)return 150;let n=0;return e!==i&&(n+=10,e===0&&i===1&&(n+=1)),n+=gme(e),n+=gme(i),n}translateOffset(t,e="right"){let i=cm(this.firstElementOffsetByLineIdx,o=>o<=t),n=t-this.firstElementOffsetByLineIdx[i];return new H(this.range.startLineNumber+i,1+this.lineStartOffsets[i]+n+(n===0&&e==="left"?0:this.trimmedWsLengthsByLineIdx[i]))}translateRange(t){let e=this.translateOffset(t.start,"right"),i=this.translateOffset(t.endExclusive,"left");return i.isBefore(e)?L.fromPositions(i,i):L.fromPositions(e,i)}findWordContaining(t){if(t<0||t>=this.elements.length||!VQ(this.elements[t]))return;let e=t;for(;e>0&&VQ(this.elements[e-1]);)e--;let i=t;for(;i<this.elements.length&&VQ(this.elements[i]);)i++;return new Qe(e,i)}countLinesIn(t){return this.translateOffset(t.endExclusive).lineNumber-this.translateOffset(t.start).lineNumber}isStronglyEqual(t,e){return this.elements[t]===this.elements[e]}extendToFullLines(t){let e=dm(this.firstElementOffsetByLineIdx,n=>n<=t.start)??0,i=hJ(this.firstElementOffsetByLineIdx,n=>t.endExclusive<=n)??this.elements.length;return new Qe(e,i)}};function VQ(r){return r>=97&&r<=122||r>=65&&r<=90||r>=48&&r<=57}var HDe={0:0,1:0,2:0,3:10,4:2,5:30,6:3,7:10,8:10};function gme(r){return HDe[r]}function fme(r){return r===10?8:r===13?7:tM(r)?6:r>=97&&r<=122?0:r>=65&&r<=90?1:r>=48&&r<=57?2:r===-1?3:r===44||r===59?5:4}function vme(r,t,e,i,n,o){let{moves:s,excludedChanges:a}=zDe(r,t,e,o);if(!o.isValid())return[];let l=r.filter(c=>!a.has(c)),d=KDe(l,i,n,t,e,o);return __(s,d),s=GDe(s),s=s.filter(c=>{let p=c.original.toOffsetRange().slice(t).map(m=>m.trim());return p.join(`
`).length>=15&&UDe(p,m=>m.length>=2)>=2}),s=qDe(r,s),s}function UDe(r,t){let e=0;for(let i of r)t(i)&&e++;return e}function zDe(r,t,e,i){let n=[],o=r.filter(l=>l.modified.isEmpty&&l.original.length>=3).map(l=>new eM(l.original,t,l)),s=new Set(r.filter(l=>l.original.isEmpty&&l.modified.length>=3).map(l=>new eM(l.modified,e,l))),a=new Set;for(let l of o){let d=-1,c;for(let p of s){let h=l.computeSimilarity(p);h>d&&(d=h,c=p)}if(d>.9&&c&&(s.delete(c),n.push(new Ws(l.range,c.range)),a.add(l.source),a.add(c.source)),!i.isValid())return{moves:n,excludedChanges:a}}return{moves:n,excludedChanges:a}}function KDe(r,t,e,i,n,o){let s=[],a=new Kc;for(let h of r)for(let m=h.original.startLineNumber;m<h.original.endLineNumberExclusive-2;m++){let f=`${t[m-1]}:${t[m+1-1]}:${t[m+2-1]}`;a.add(f,{range:new ht(m,m+3)})}let l=[];r.sort(Sr(h=>h.modified.startLineNumber,ud));for(let h of r){let m=[];for(let f=h.modified.startLineNumber;f<h.modified.endLineNumberExclusive-2;f++){let g=`${e[f-1]}:${e[f+1-1]}:${e[f+2-1]}`,v=new ht(f,f+3),I=[];a.forEach(g,({range:y})=>{for(let C of m)if(C.originalLineRange.endLineNumberExclusive+1===y.endLineNumberExclusive&&C.modifiedLineRange.endLineNumberExclusive+1===v.endLineNumberExclusive){C.originalLineRange=new ht(C.originalLineRange.startLineNumber,y.endLineNumberExclusive),C.modifiedLineRange=new ht(C.modifiedLineRange.startLineNumber,v.endLineNumberExclusive),I.push(C);return}let w={modifiedLineRange:v,originalLineRange:y};l.push(w),I.push(w)}),m=I}if(!o.isValid())return[]}l.sort(_J(Sr(h=>h.modifiedLineRange.length,ud)));let d=new Ed,c=new Ed;for(let h of l){let m=h.modifiedLineRange.startLineNumber-h.originalLineRange.startLineNumber,f=d.subtractFrom(h.modifiedLineRange),g=c.subtractFrom(h.originalLineRange).getWithDelta(m),v=f.getIntersection(g);for(let I of v.ranges){if(I.length<3)continue;let y=I,w=I.delta(-m);s.push(new Ws(w,y)),d.addRange(y),c.addRange(w)}}s.sort(Sr(h=>h.original.startLineNumber,ud));let p=new E_(r);for(let h=0;h<s.length;h++){let m=s[h],f=p.findLastMonotonous(D=>D.original.startLineNumber<=m.original.startLineNumber),g=dm(r,D=>D.modified.startLineNumber<=m.modified.startLineNumber),v=Math.max(m.original.startLineNumber-f.original.startLineNumber,m.modified.startLineNumber-g.modified.startLineNumber),I=p.findLastMonotonous(D=>D.original.startLineNumber<m.original.endLineNumberExclusive),y=dm(r,D=>D.modified.startLineNumber<m.modified.endLineNumberExclusive),w=Math.max(I.original.endLineNumberExclusive-m.original.endLineNumberExclusive,y.modified.endLineNumberExclusive-m.modified.endLineNumberExclusive),C;for(C=0;C<v;C++){let D=m.original.startLineNumber-C-1,k=m.modified.startLineNumber-C-1;if(D>i.length||k>n.length||d.contains(k)||c.contains(D)||!bme(i[D-1],n[k-1],o))break}C>0&&(c.addRange(new ht(m.original.startLineNumber-C,m.original.startLineNumber)),d.addRange(new ht(m.modified.startLineNumber-C,m.modified.startLineNumber)));let S;for(S=0;S<w;S++){let D=m.original.endLineNumberExclusive+S,k=m.modified.endLineNumberExclusive+S;if(D>i.length||k>n.length||d.contains(k)||c.contains(D)||!bme(i[D-1],n[k-1],o))break}S>0&&(c.addRange(new ht(m.original.endLineNumberExclusive,m.original.endLineNumberExclusive+S)),d.addRange(new ht(m.modified.endLineNumberExclusive,m.modified.endLineNumberExclusive+S))),(C>0||S>0)&&(s[h]=new Ws(new ht(m.original.startLineNumber-C,m.original.endLineNumberExclusive+S),new ht(m.modified.startLineNumber-C,m.modified.endLineNumberExclusive+S)))}return s}function bme(r,t,e){if(r.trim()===t.trim())return!0;if(r.length>300&&t.length>300)return!1;let n=new NT().compute(new wv([r],new L(1,1,1,r.length),!1),new wv([t],new L(1,1,1,t.length),!1),e),o=0,s=Co.invert(n.diffs,r.length);for(let c of s)c.seq1Range.forEach(p=>{tM(r.charCodeAt(p))||o++});function a(c){let p=0;for(let h=0;h<r.length;h++)tM(c.charCodeAt(h))||p++;return p}let l=a(r.length>t.length?r:t);return o/l>.6&&l>10}function GDe(r){if(r.length===0)return r;r.sort(Sr(e=>e.original.startLineNumber,ud));let t=[r[0]];for(let e=1;e<r.length;e++){let i=t[t.length-1],n=r[e],o=n.original.startLineNumber-i.original.endLineNumberExclusive,s=n.modified.startLineNumber-i.modified.endLineNumberExclusive;if(o>=0&&s>=0&&o+s<=2){t[t.length-1]=i.join(n);continue}t.push(n)}return t}function qDe(r,t){let e=new E_(r);return t=t.filter(i=>{let n=e.findLastMonotonous(a=>a.original.startLineNumber<i.original.endLineNumberExclusive)||new Ws(new ht(1,1),new ht(1,1)),o=dm(r,a=>a.modified.startLineNumber<i.modified.endLineNumberExclusive);return n!==o}),t}var iM=class{constructor(t,e){this.trimmedHash=t;this.lines=e}getElement(t){return this.trimmedHash[t]}get length(){return this.trimmedHash.length}getBoundaryScore(t){let e=t===0?0:Ime(this.lines[t-1]),i=t===this.lines.length?0:Ime(this.lines[t]);return 1e3-(e+i)}getText(t){return this.lines.slice(t.start,t.endExclusive).join(`
`)}isStronglyEqual(t,e){return this.lines[t]===this.lines[e]}};function Ime(r){let t=0;for(;t<r.length&&(r.charCodeAt(t)===32||r.charCodeAt(t)===9);)t++;return t}function nM(r,t,e){let i=e;return i=yme(r,t,i),i=yme(r,t,i),i=$De(r,t,i),i}function yme(r,t,e){if(e.length===0)return e;let i=[];i.push(e[0]);for(let o=1;o<e.length;o++){let s=i[i.length-1],a=e[o];if(a.seq1Range.isEmpty||a.seq2Range.isEmpty){let l=a.seq1Range.start-s.seq1Range.endExclusive,d;for(d=1;d<=l&&!(r.getElement(a.seq1Range.start-d)!==r.getElement(a.seq1Range.endExclusive-d)||t.getElement(a.seq2Range.start-d)!==t.getElement(a.seq2Range.endExclusive-d));d++);if(d--,d===l){i[i.length-1]=new Co(new Qe(s.seq1Range.start,a.seq1Range.endExclusive-l),new Qe(s.seq2Range.start,a.seq2Range.endExclusive-l));continue}a=a.delta(-d)}i.push(a)}let n=[];for(let o=0;o<i.length-1;o++){let s=i[o+1],a=i[o];if(a.seq1Range.isEmpty||a.seq2Range.isEmpty){let l=s.seq1Range.start-a.seq1Range.endExclusive,d;for(d=0;d<l&&!(!r.isStronglyEqual(a.seq1Range.start+d,a.seq1Range.endExclusive+d)||!t.isStronglyEqual(a.seq2Range.start+d,a.seq2Range.endExclusive+d));d++);if(d===l){i[o+1]=new Co(new Qe(a.seq1Range.start+l,s.seq1Range.endExclusive),new Qe(a.seq2Range.start+l,s.seq2Range.endExclusive));continue}d>0&&(a=a.delta(d))}n.push(a)}return i.length>0&&n.push(i[i.length-1]),n}function $De(r,t,e){if(!r.getBoundaryScore||!t.getBoundaryScore)return e;for(let i=0;i<e.length;i++){let n=i>0?e[i-1]:void 0,o=e[i],s=i+1<e.length?e[i+1]:void 0,a=new Qe(n?n.seq1Range.endExclusive+1:0,s?s.seq1Range.start-1:r.length),l=new Qe(n?n.seq2Range.endExclusive+1:0,s?s.seq2Range.start-1:t.length);o.seq1Range.isEmpty?e[i]=Sme(o,r,t,a,l):o.seq2Range.isEmpty&&(e[i]=Sme(o.swap(),t,r,l,a).swap())}return e}function Sme(r,t,e,i,n){let s=1;for(;r.seq1Range.start-s>=i.start&&r.seq2Range.start-s>=n.start&&e.isStronglyEqual(r.seq2Range.start-s,r.seq2Range.endExclusive-s)&&s<100;)s++;s--;let a=0;for(;r.seq1Range.start+a<i.endExclusive&&r.seq2Range.endExclusive+a<n.endExclusive&&e.isStronglyEqual(r.seq2Range.start+a,r.seq2Range.endExclusive+a)&&a<100;)a++;if(s===0&&a===0)return r;let l=0,d=-1;for(let c=-s;c<=a;c++){let p=r.seq2Range.start+c,h=r.seq2Range.endExclusive+c,m=r.seq1Range.start+c,f=t.getBoundaryScore(m)+e.getBoundaryScore(p)+e.getBoundaryScore(h);f>d&&(d=f,l=c)}return r.delta(l)}function Cme(r,t,e){let i=[];for(let n of e){let o=i[i.length-1];if(!o){i.push(n);continue}n.seq1Range.start-o.seq1Range.endExclusive<=2||n.seq2Range.start-o.seq2Range.endExclusive<=2?i[i.length-1]=new Co(o.seq1Range.join(n.seq1Range),o.seq2Range.join(n.seq2Range)):i.push(n)}return i}function wme(r,t,e){let i=Co.invert(e,r.length),n=[],o=new Qh(0,0);function s(l,d){if(l.offset1<o.offset1||l.offset2<o.offset2)return;let c=r.findWordContaining(l.offset1),p=t.findWordContaining(l.offset2);if(!c||!p)return;let h=new Co(c,p),m=h.intersect(d),f=m.seq1Range.length,g=m.seq2Range.length;for(;i.length>0;){let v=i[0];if(!(v.seq1Range.intersects(h.seq1Range)||v.seq2Range.intersects(h.seq2Range)))break;let y=r.findWordContaining(v.seq1Range.start),w=t.findWordContaining(v.seq2Range.start),C=new Co(y,w),S=C.intersect(v);if(f+=S.seq1Range.length,g+=S.seq2Range.length,h=h.join(C),h.seq1Range.endExclusive>=v.seq1Range.endExclusive)i.shift();else break}f+g<(h.seq1Range.length+h.seq2Range.length)*2/3&&n.push(h),o=h.getEndExclusives()}for(;i.length>0;){let l=i.shift();l.seq1Range.isEmpty||(s(l.getStarts(),l),s(l.getEndExclusives().delta(-1),l))}return jDe(e,n)}function jDe(r,t){let e=[];for(;r.length>0||t.length>0;){let i=r[0],n=t[0],o;i&&(!n||i.seq1Range.start<n.seq1Range.start)?o=r.shift():o=t.shift(),e.length>0&&e[e.length-1].seq1Range.endExclusive>=o.seq1Range.start?e[e.length-1]=e[e.length-1].join(o):e.push(o)}return e}function Eme(r,t,e){let i=e;if(i.length===0)return i;let n=0,o;do{o=!1;let a=[i[0]];for(let l=1;l<i.length;l++){let p=function(m,f){let g=new Qe(c.seq1Range.endExclusive,d.seq1Range.start);return r.getText(g).replace(/\s/g,"").length<=4&&(m.seq1Range.length+m.seq2Range.length>5||f.seq1Range.length+f.seq2Range.length>5)};var s=p;let d=i[l],c=a[a.length-1];p(c,d)?(o=!0,a[a.length-1]=a[a.length-1].join(d)):a.push(d)}i=a}while(n++<10&&o);return i}function xme(r,t,e){let i=e;if(i.length===0)return i;let n=0,o;do{o=!1;let l=[i[0]];for(let d=1;d<i.length;d++){let h=function(f,g){let v=new Qe(p.seq1Range.endExclusive,c.seq1Range.start);if(r.countLinesIn(v)>5||v.length>500)return!1;let y=r.getText(v).trim();if(y.length>20||y.split(/\r\n|\r|\n/).length>1)return!1;let w=r.countLinesIn(f.seq1Range),C=f.seq1Range.length,S=t.countLinesIn(f.seq2Range),D=f.seq2Range.length,k=r.countLinesIn(g.seq1Range),M=g.seq1Range.length,O=t.countLinesIn(g.seq2Range),K=g.seq2Range.length,G=2*40+50;function Y(ge){return Math.min(ge,G)}return Math.pow(Math.pow(Y(w*40+C),1.5)+Math.pow(Y(S*40+D),1.5),1.5)+Math.pow(Math.pow(Y(k*40+M),1.5)+Math.pow(Y(O*40+K),1.5),1.5)>(G**1.5)**1.5*1.3};var a=h;let c=i[d],p=l[l.length-1];h(p,c)?(o=!0,l[l.length-1]=l[l.length-1].join(c)):l.push(c)}i=l}while(n++<10&&o);let s=[];return yJ(i,(l,d,c)=>{let p=d;function h(y){return y.length>0&&y.trim().length<=3&&d.seq1Range.length+d.seq2Range.length>100}let m=r.extendToFullLines(d.seq1Range),f=r.getText(new Qe(m.start,d.seq1Range.start));h(f)&&(p=p.deltaStart(-f.length));let g=r.getText(new Qe(d.seq1Range.endExclusive,m.endExclusive));h(g)&&(p=p.deltaEnd(g.length));let v=Co.fromOffsetPairs(l?l.getEndExclusives():Qh.zero,c?c.getStarts():Qh.max),I=p.intersect(v);s.length>0&&I.getStarts().equals(s[s.length-1].getEndExclusives())?s[s.length-1]=s[s.length-1].join(I):s.push(I)}),s}var kz=class{dynamicProgrammingDiffing=new _z;myersDiffingAlgorithm=new NT;computeDiff(t,e,i){if(t.length<=1&&xi(t,e,(S,D)=>S===D))return new fI([],[],!1);if(t.length===1&&t[0].length===0||e.length===1&&e[0].length===0)return new fI([new Ll(new ht(1,t.length+1),new ht(1,e.length+1),[new ea(new L(1,1,t.length,t[t.length-1].length+1),new L(1,1,e.length,e[e.length-1].length+1))])],[],!1);let n=i.maxComputationTimeMs===0?Cv.instance:new Tz(i.maxComputationTimeMs),o=!i.ignoreTrimWhitespace,s=new Map;function a(S){let D=s.get(S);return D===void 0&&(D=s.size,s.set(S,D)),D}let l=t.map(S=>a(S.trim())),d=e.map(S=>a(S.trim())),c=new iM(l,t),p=new iM(d,e),h=c.length+p.length<1700?this.dynamicProgrammingDiffing.compute(c,p,n,(S,D)=>t[S]===e[D]?e[D].length===0?.1:1+Math.log(1+e[D].length):.99):this.myersDiffingAlgorithm.compute(c,p,n),m=h.diffs,f=h.hitTimeout;m=nM(c,p,m),m=Eme(c,p,m);let g=[],v=S=>{if(o)for(let D=0;D<S;D++){let k=I+D,M=y+D;if(t[k]!==e[M]){let O=this.refineDiff(t,e,new Co(new Qe(k,k+1),new Qe(M,M+1)),n,o);for(let K of O.mappings)g.push(K);O.hitTimeout&&(f=!0)}}},I=0,y=0;for(let S of m){Gc(()=>S.seq1Range.start-I===S.seq2Range.start-y);let D=S.seq1Range.start-I;v(D),I=S.seq1Range.endExclusive,y=S.seq2Range.endExclusive;let k=this.refineDiff(t,e,S,n,o);k.hitTimeout&&(f=!0);for(let M of k.mappings)g.push(M)}v(t.length-I);let w=Tme(g,t,e),C=[];return i.computeMoves&&(C=this.computeMoves(w,t,e,l,d,n,o)),Gc(()=>{function S(k,M){if(k.lineNumber<1||k.lineNumber>M.length)return!1;let O=M[k.lineNumber-1];return!(k.column<1||k.column>O.length+1)}function D(k,M){return!(k.startLineNumber<1||k.startLineNumber>M.length+1||k.endLineNumberExclusive<1||k.endLineNumberExclusive>M.length+1)}for(let k of w){if(!k.innerChanges)return!1;for(let M of k.innerChanges)if(!(S(M.modifiedRange.getStartPosition(),e)&&S(M.modifiedRange.getEndPosition(),e)&&S(M.originalRange.getStartPosition(),t)&&S(M.originalRange.getEndPosition(),t)))return!1;if(!D(k.modified,e)||!D(k.original,t))return!1}return!0}),new fI(w,C,f)}computeMoves(t,e,i,n,o,s,a){return vme(t,e,i,n,o,s).map(c=>{let p=this.refineDiff(e,i,new Co(c.original.toOffsetRange(),c.modified.toOffsetRange()),s,a),h=Tme(p.mappings,e,i,!0);return new EO(c,h)})}refineDiff(t,e,i,n,o){let a=YDe(i).toRangeMapping2(t,e),l=new wv(t,a.originalRange,o),d=new wv(e,a.modifiedRange,o),c=l.length+d.length<500?this.dynamicProgrammingDiffing.compute(l,d,n):this.myersDiffingAlgorithm.compute(l,d,n),p=!1,h=c.diffs;p&&Co.assertSorted(h),h=nM(l,d,h),p&&Co.assertSorted(h),h=wme(l,d,h),p&&Co.assertSorted(h),h=Cme(l,d,h),p&&Co.assertSorted(h),h=xme(l,d,h),p&&Co.assertSorted(h);let m=h.map(f=>new ea(l.translateRange(f.seq1Range),d.translateRange(f.seq2Range)));return p&&ea.assertSorted(m),{mappings:m,hitTimeout:c.hitTimeout}}};function Tme(r,t,e,i=!1){let n=[];for(let o of CS(r.map(s=>XDe(s,t,e)),(s,a)=>s.original.overlapOrTouch(a.original)||s.modified.overlapOrTouch(a.modified))){let s=o[0],a=o[o.length-1];n.push(new Ll(s.original.join(a.original),s.modified.join(a.modified),o.map(l=>l.innerChanges[0])))}return Gc(()=>!i&&n.length>0&&(n[0].modified.startLineNumber!==n[0].original.startLineNumber||e.length-n[n.length-1].modified.endLineNumberExclusive!==t.length-n[n.length-1].original.endLineNumberExclusive)?!1:M_(n,(o,s)=>s.original.startLineNumber-o.original.endLineNumberExclusive===s.modified.startLineNumber-o.modified.endLineNumberExclusive&&o.original.endLineNumberExclusive<s.original.startLineNumber&&o.modified.endLineNumberExclusive<s.modified.startLineNumber)),n}function XDe(r,t,e){let i=0,n=0;r.modifiedRange.endColumn===1&&r.originalRange.endColumn===1&&r.originalRange.startLineNumber+i<=r.originalRange.endLineNumber&&r.modifiedRange.startLineNumber+i<=r.modifiedRange.endLineNumber&&(n=-1),r.modifiedRange.startColumn-1>=e[r.modifiedRange.startLineNumber-1].length&&r.originalRange.startColumn-1>=t[r.originalRange.startLineNumber-1].length&&r.originalRange.startLineNumber<=r.originalRange.endLineNumber+n&&r.modifiedRange.startLineNumber<=r.modifiedRange.endLineNumber+n&&(i=1);let o=new ht(r.originalRange.startLineNumber+i,r.originalRange.endLineNumber+1+n),s=new ht(r.modifiedRange.startLineNumber+i,r.modifiedRange.endLineNumber+1+n);return new Ll(o,s,[r])}function YDe(r){return new Ws(new ht(r.seq1Range.start+1,r.seq1Range.endExclusive+1),new ht(r.seq2Range.start+1,r.seq2Range.endExclusive+1))}var CRo=T("diffEditor.move.border","#8b8b8b9c",u("diffEditor.move.border","The border color for text that got moved in the diff editor.")),wRo=T("diffEditor.moveActive.border","#FFA500",u("diffEditor.moveActive.border","The active border color for text that got moved in the diff editor.")),ERo=T("diffEditor.unchangedRegionShadow",{dark:"#000000",light:"#737373BF",hcDark:"#000000",hcLight:"#737373BF"},u("diffEditor.unchangedRegionShadow","The color of the shadow around unchanged region widgets.")),QDe=ke("diff-insert",N.add,u("diffInsertIcon","Line decoration for inserts in the diff editor.")),WQ=ke("diff-remove",N.remove,u("diffRemoveIcon","Line decoration for removals in the diff editor.")),HQ=Ii.register({className:"line-insert",description:"line-insert",isWholeLine:!0,linesDecorationsClassName:"insert-sign "+de.asClassName(QDe),marginClassName:"gutter-insert"}),UQ=Ii.register({className:"line-delete",description:"line-delete",isWholeLine:!0,linesDecorationsClassName:"delete-sign "+de.asClassName(WQ),marginClassName:"gutter-delete"}),zQ=Ii.register({className:"line-insert",description:"line-insert",isWholeLine:!0,marginClassName:"gutter-insert"}),KQ=Ii.register({className:"line-delete",description:"line-delete",isWholeLine:!0,marginClassName:"gutter-delete"}),GQ=Ii.register({className:"char-insert",description:"char-insert",shouldFillLineOnLineBreak:!0}),_me=Ii.register({className:"char-insert",description:"char-insert",isWholeLine:!0}),Dme=Ii.register({className:"char-insert diff-range-empty",description:"char-insert diff-range-empty"}),oM=Ii.register({className:"char-delete",description:"char-delete",shouldFillLineOnLineBreak:!0}),kme=Ii.register({className:"char-delete",description:"char-delete",isWholeLine:!0}),Lme=Ii.register({className:"char-delete diff-range-empty",description:"char-delete diff-range-empty"});var Lz=class extends R{constructor(e,i,n,o,s,a,l,d,c){super();this._getViewZoneId=e;this._marginDomNode=i;this._modifiedEditor=n;this._diff=o;this._editor=s;this._viewLineCounts=a;this._originalTextModel=l;this._contextMenuService=d;this._clipboardService=c;this._marginDomNode.style.zIndex="10",this._diffActions=document.createElement("div"),this._diffActions.className=de.asClassName(N.lightBulb)+" lightbulb-glyph",this._diffActions.style.position="absolute";let p=this._modifiedEditor.getOption(68);this._diffActions.style.right="0px",this._diffActions.style.visibility="hidden",this._diffActions.style.height=`${p}px`,this._diffActions.style.lineHeight=`${p}px`,this._marginDomNode.appendChild(this._diffActions);let h=0,m=n.getOption(129)&&!Hr,f=(g,v)=>{this._contextMenuService.showContextMenu({domForShadowRoot:m?n.getDomNode()??void 0:void 0,getAnchor:()=>({x:g,y:v}),getActions:()=>{let I=[],y=o.modified.isEmpty;return I.push(new et("diff.clipboard.copyDeletedContent",y?o.original.length>1?u("diff.clipboard.copyDeletedLinesContent.label","Copy deleted lines"):u("diff.clipboard.copyDeletedLinesContent.single.label","Copy deleted line"):o.original.length>1?u("diff.clipboard.copyChangedLinesContent.label","Copy changed lines"):u("diff.clipboard.copyChangedLinesContent.single.label","Copy changed line"),void 0,!0,async()=>{let C=this._originalTextModel.getValueInRange(o.original.toExclusiveRange());await this._clipboardService.writeText(C)})),o.original.length>1&&I.push(new et("diff.clipboard.copyDeletedLineContent",y?u("diff.clipboard.copyDeletedLineContent.label","Copy deleted line ({0})",o.original.startLineNumber+h):u("diff.clipboard.copyChangedLineContent.label","Copy changed line ({0})",o.original.startLineNumber+h),void 0,!0,async()=>{let C=this._originalTextModel.getLineContent(o.original.startLineNumber+h);C===""&&(C=this._originalTextModel.getEndOfLineSequence()===0?`
`:`\r
`),await this._clipboardService.writeText(C)})),n.getOption(93)||I.push(new et("diff.inline.revertChange",u("diff.inline.revertChange.label","Revert this change"),void 0,!0,async()=>{this._editor.revert(this._diff)})),I},autoSelectFirstItem:!0})};this._register(Ut(this._diffActions,"mousedown",g=>{if(!g.leftButton)return;let{top:v,height:I}=Oi(this._diffActions),y=Math.floor(p/3);g.preventDefault(),f(g.posx,v+I+y)})),this._register(n.onMouseMove(g=>{(g.target.type===8||g.target.type===5)&&g.target.detail.viewZoneId===this._getViewZoneId()?(h=this._updateLightBulbPosition(this._marginDomNode,g.event.browserEvent.y,p),this.visibility=!0):this.visibility=!1})),this._register(n.onMouseDown(g=>{g.event.leftButton&&(g.target.type===8||g.target.type===5)&&g.target.detail.viewZoneId===this._getViewZoneId()&&(g.event.preventDefault(),h=this._updateLightBulbPosition(this._marginDomNode,g.event.browserEvent.y,p),f(g.event.posx,g.event.posy+p))}))}_diffActions;_visibility=!1;get visibility(){return this._visibility}set visibility(e){this._visibility!==e&&(this._visibility=e,this._diffActions.style.visibility=e?"visible":"hidden")}_updateLightBulbPosition(e,i,n){let{top:o}=Oi(e),s=i-o,a=Math.floor(s/n),l=a*n;if(this._diffActions.style.top=`${l}px`,this._viewLineCounts){let d=0;for(let c=0;c<this._viewLineCounts.length;c++)if(d+=this._viewLineCounts[c],a<d)return c}return a}};var Rme=kh("diffEditorWidget",{createHTML:r=>r});function Mme(r,t,e,i){hn(i,t.fontInfo);let n=e.length>0,o=new xd(1e4),s=0,a=0,l=[];for(let h=0;h<r.lineTokens.length;h++){let m=h+1,f=r.lineTokens[h],g=r.lineBreakData[h],v=Pc.filter(e,m,1,Number.MAX_SAFE_INTEGER);if(g){let I=0;for(let y of g.breakOffsets){let w=f.sliceAndInflate(I,y,0);s=Math.max(s,Pme(a,w,Pc.extractWrapped(v,I,y),n,r.mightContainNonBasicASCII,r.mightContainRTL,t,o)),a++,I=y}l.push(g.breakOffsets.length)}else l.push(1),s=Math.max(s,Pme(a,f,v,n,r.mightContainNonBasicASCII,r.mightContainRTL,t,o)),a++}s+=t.scrollBeyondLastColumn;let d=o.build(),c=Rme?Rme.createHTML(d):d;i.innerHTML=c;let p=s*t.typicalHalfwidthCharacterWidth;return{heightInLines:a,minWidthInPx:p,viewLineCounts:l}}var Rz=class{constructor(t,e,i,n){this.lineTokens=t;this.lineBreakData=e;this.mightContainNonBasicASCII=i;this.mightContainRTL=n}},Pz=class r{constructor(t,e,i,n,o,s,a,l,d,c,p){this.tabSize=t;this.fontInfo=e;this.disableMonospaceOptimizations=i;this.typicalHalfwidthCharacterWidth=n;this.scrollBeyondLastColumn=o;this.lineHeight=s;this.lineDecorationsWidth=a;this.stopRenderingLineAfter=l;this.renderWhitespace=d;this.renderControlCharacters=c;this.fontLigatures=p}static fromEditor(t){let e=t.getOptions(),i=e.get(51),n=e.get(147);return new r(t.getModel()?.getOptions().tabSize||0,i,e.get(33),i.typicalHalfwidthCharacterWidth,e.get(106),e.get(68),n.decorationsWidth,e.get(119),e.get(101),e.get(96),e.get(52))}};function Pme(r,t,e,i,n,o,s,a){a.appendString('<div class="view-line'),i||a.appendString(" char-delete"),a.appendString('" style="top:'),a.appendString(String(r*s.lineHeight)),a.appendString('px;width:1000000px;">');let l=t.getLineContent(),d=zp.isBasicASCII(l,n),c=zp.containsRTL(l,d,o),p=lR(new Rb(s.fontInfo.isMonospace&&!s.disableMonospaceOptimizations,s.fontInfo.canUseHalfwidthRightwardsArrow,l,!1,d,c,0,t,e,s.tabSize,0,s.fontInfo.spaceWidth,s.fontInfo.middotWidth,s.fontInfo.wsmiddotWidth,s.stopRenderingLineAfter,s.renderWhitespace,s.renderControlCharacters,s.fontLigatures!==ou.OFF,null),a);return a.appendString("</div>"),p.characterMapping.getHorizontalOffset(p.characterMapping.length)}var FT=class extends R{constructor(e,i,n,o,s,a,l,d,c,p){super();this._targetWindow=e;this._editors=i;this._diffModel=n;this._options=o;this._diffEditorWidget=s;this._canIgnoreViewZoneUpdateEvent=a;this._origViewZonesToIgnore=l;this._modViewZonesToIgnore=d;this._clipboardService=c;this._contextMenuService=p;let h=Ht("invalidateAlignmentsState",0),m=this._register(new Ye(()=>{h.set(h.get()+1,void 0)},0));this._register(this._editors.original.onDidChangeViewZones(C=>{this._canIgnoreViewZoneUpdateEvent()||m.schedule()})),this._register(this._editors.modified.onDidChangeViewZones(C=>{this._canIgnoreViewZoneUpdateEvent()||m.schedule()})),this._register(this._editors.original.onDidChangeConfiguration(C=>{(C.hasChanged(148)||C.hasChanged(68))&&m.schedule()})),this._register(this._editors.modified.onDidChangeConfiguration(C=>{(C.hasChanged(148)||C.hasChanged(68))&&m.schedule()}));let f=this._diffModel.map(C=>C?Pi(this,C.model.original.onDidChangeTokens,()=>C.model.original.tokenization.backgroundTokenizationState===2):void 0).map((C,S)=>C?.read(S)),g=dt(C=>{let S=this._diffModel.read(C),D=S?.diff.read(C);if(!S||!D)return null;h.read(C);let M=this._options.renderSideBySide.read(C);return Ame(this._editors.original,this._editors.modified,D.mappings,this._origViewZonesToIgnore,this._modViewZonesToIgnore,M)}),v=dt(C=>{let S=this._diffModel.read(C)?.movedTextToCompare.read(C);if(!S)return null;h.read(C);let D=S.changes.map(k=>new sM(k));return Ame(this._editors.original,this._editors.modified,D,this._origViewZonesToIgnore,this._modViewZonesToIgnore,!0)});function I(){let C=document.createElement("div");return C.className="diagonal-fill",C}let y=this._register(new B);this.viewZones=qc(this,(C,S)=>{y.clear();let D=g.read(C)||[],k=[],M=[],O=this._modifiedTopPadding.read(C);O>0&&M.push({afterLineNumber:0,domNode:document.createElement("div"),heightInPx:O,showInHiddenAreas:!0,suppressMouseDown:!0});let K=this._originalTopPadding.read(C);K>0&&k.push({afterLineNumber:0,domNode:document.createElement("div"),heightInPx:K,showInHiddenAreas:!0,suppressMouseDown:!0});let G=this._options.renderSideBySide.read(C),Y=G?void 0:this._editors.modified._getViewModel()?.createLineBreaksComputer();if(Y){let pe=this._editors.original.getModel();for(let qt of D)if(qt.diff)for(let Mt=qt.originalRange.startLineNumber;Mt<qt.originalRange.endLineNumberExclusive;Mt++){if(Mt>pe.getLineCount())return{orig:k,mod:M};Y?.addRequest(pe.getLineContent(Mt),null,null)}}let ge=Y?.finalize()??[],xe=0,be=this._editors.modified.getOption(68),fe=this._diffModel.read(C)?.movedTextToCompare.read(C),Le=this._editors.original.getModel()?.mightContainNonBasicASCII()??!1,Ee=this._editors.original.getModel()?.mightContainRTL()??!1,Ce=Pz.fromEditor(this._editors.modified);for(let pe of D)if(pe.diff&&!G&&(!this._options.useTrueInlineDiffRendering.read(C)||!rM(pe.diff))){if(!pe.originalRange.isEmpty){f.read(C);let Mt=document.createElement("div");Mt.classList.add("view-lines","line-delete","monaco-mouse-cursor-text");let at=this._editors.original.getModel();if(pe.originalRange.endLineNumberExclusive-1>at.getLineCount())return{orig:k,mod:M};let On=new Rz(pe.originalRange.mapToLineArray(Qi=>at.tokenization.getLineTokens(Qi)),pe.originalRange.mapToLineArray(Qi=>ge[xe++]),Le,Ee),Nn=[];for(let Qi of pe.diff.innerChanges||[])Nn.push(new Nm(Qi.originalRange.delta(-(pe.diff.original.startLineNumber-1)),oM.className,0));let Ro=Mme(On,Ce,Nn,Mt),or=document.createElement("div");if(or.className="inline-deleted-margin-view-zone",hn(or,Ce.fontInfo),this._options.renderIndicators.read(C))for(let Qi=0;Qi<Ro.heightInLines;Qi++){let Br=document.createElement("div");Br.className=`delete-sign ${de.asClassName(WQ)}`,Br.setAttribute("style",`position:absolute;top:${Qi*be}px;width:${Ce.lineDecorationsWidth}px;height:${be}px;right:0;`),or.appendChild(Br)}let sd;y.add(new Lz(()=>Yt(sd),or,this._editors.modified,pe.diff,this._diffEditorWidget,Ro.viewLineCounts,this._editors.original.getModel(),this._contextMenuService,this._clipboardService));for(let Qi=0;Qi<Ro.viewLineCounts.length;Qi++){let Br=Ro.viewLineCounts[Qi];Br>1&&k.push({afterLineNumber:pe.originalRange.startLineNumber+Qi,domNode:I(),heightInPx:(Br-1)*be,showInHiddenAreas:!0,suppressMouseDown:!0})}M.push({afterLineNumber:pe.modifiedRange.startLineNumber-1,domNode:Mt,heightInPx:Ro.heightInLines*be,minWidthInPx:Ro.minWidthInPx,marginDomNode:or,setZoneId(Qi){sd=Qi},showInHiddenAreas:!0,suppressMouseDown:!0})}let qt=document.createElement("div");qt.className="gutter-delete",k.push({afterLineNumber:pe.originalRange.endLineNumberExclusive-1,domNode:I(),heightInPx:pe.modifiedHeightInPx,marginDomNode:qt,showInHiddenAreas:!0,suppressMouseDown:!0})}else{let qt=pe.modifiedHeightInPx-pe.originalHeightInPx;if(qt>0){if(fe?.lineRangeMapping.original.delta(-1).deltaLength(2).contains(pe.originalRange.endLineNumberExclusive-1))continue;k.push({afterLineNumber:pe.originalRange.endLineNumberExclusive-1,domNode:I(),heightInPx:qt,showInHiddenAreas:!0,suppressMouseDown:!0})}else{let Mt=function(){let On=document.createElement("div");return On.className="arrow-revert-change "+de.asClassName(N.arrowRight),S.add(F(On,"mousedown",Nn=>Nn.stopPropagation())),S.add(F(On,"click",Nn=>{Nn.stopPropagation(),s.revert(pe.diff)})),J("div",{},On)};var Je=Mt;if(fe?.lineRangeMapping.modified.delta(-1).deltaLength(2).contains(pe.modifiedRange.endLineNumberExclusive-1))continue;let at;pe.diff&&pe.diff.modified.isEmpty&&this._options.shouldRenderOldRevertArrows.read(C)&&(at=Mt()),M.push({afterLineNumber:pe.modifiedRange.endLineNumberExclusive-1,domNode:I(),heightInPx:-qt,marginDomNode:at,showInHiddenAreas:!0,suppressMouseDown:!0})}}for(let pe of v.read(C)??[]){if(!fe?.lineRangeMapping.original.intersect(pe.originalRange)||!fe?.lineRangeMapping.modified.intersect(pe.modifiedRange))continue;let qt=pe.modifiedHeightInPx-pe.originalHeightInPx;qt>0?k.push({afterLineNumber:pe.originalRange.endLineNumberExclusive-1,domNode:I(),heightInPx:qt,showInHiddenAreas:!0,suppressMouseDown:!0}):M.push({afterLineNumber:pe.modifiedRange.endLineNumberExclusive-1,domNode:I(),heightInPx:-qt,showInHiddenAreas:!0,suppressMouseDown:!0})}return{orig:k,mod:M}});let w=!1;this._register(this._editors.original.onDidScrollChange(C=>{C.scrollLeftChanged&&!w&&(w=!0,this._editors.modified.setScrollLeft(C.scrollLeft),w=!1)})),this._register(this._editors.modified.onDidScrollChange(C=>{C.scrollLeftChanged&&!w&&(w=!0,this._editors.original.setScrollLeft(C.scrollLeft),w=!1)})),this._originalScrollTop=Pi(this._editors.original.onDidScrollChange,()=>this._editors.original.getScrollTop()),this._modifiedScrollTop=Pi(this._editors.modified.onDidScrollChange,()=>this._editors.modified.getScrollTop()),this._register(Ft(C=>{let S=this._originalScrollTop.read(C)-(this._originalScrollOffsetAnimated.get()-this._modifiedScrollOffsetAnimated.read(C))-(this._originalTopPadding.get()-this._modifiedTopPadding.read(C));S!==this._editors.modified.getScrollTop()&&this._editors.modified.setScrollTop(S,1)})),this._register(Ft(C=>{let S=this._modifiedScrollTop.read(C)-(this._modifiedScrollOffsetAnimated.get()-this._originalScrollOffsetAnimated.read(C))-(this._modifiedTopPadding.get()-this._originalTopPadding.read(C));S!==this._editors.original.getScrollTop()&&this._editors.original.setScrollTop(S,1)})),this._register(Ft(C=>{let S=this._diffModel.read(C)?.movedTextToCompare.read(C),D=0;if(S){let k=this._editors.original.getTopForLineNumber(S.lineRangeMapping.original.startLineNumber,!0)-this._originalTopPadding.get();D=this._editors.modified.getTopForLineNumber(S.lineRangeMapping.modified.startLineNumber,!0)-this._modifiedTopPadding.get()-k}D>0?(this._modifiedTopPadding.set(0,void 0),this._originalTopPadding.set(D,void 0)):D<0?(this._modifiedTopPadding.set(-D,void 0),this._originalTopPadding.set(0,void 0)):setTimeout(()=>{this._modifiedTopPadding.set(0,void 0),this._originalTopPadding.set(0,void 0)},400),this._editors.modified.hasTextFocus()?this._originalScrollOffset.set(this._modifiedScrollOffset.get()-D,void 0,!0):this._modifiedScrollOffset.set(this._originalScrollOffset.get()+D,void 0,!0)}))}_originalTopPadding=Ht(this,0);_originalScrollTop;_originalScrollOffset=Ht(this,0);_originalScrollOffsetAnimated=PQ(this._targetWindow,this._originalScrollOffset,this._store);_modifiedTopPadding=Ht(this,0);_modifiedScrollTop;_modifiedScrollOffset=Ht(this,0);_modifiedScrollOffsetAnimated=PQ(this._targetWindow,this._modifiedScrollOffset,this._store);viewZones};FT=E([b(8,rs),b(9,vt)],FT);function Ame(r,t,e,i,n,o){let s=new Ms(Ome(r,i)),a=new Ms(Ome(t,n)),l=r.getOption(68),d=t.getOption(68),c=[],p=0,h=0;function m(g,v){for(;;){let I=s.peek(),y=a.peek();if(I&&I.lineNumber>=g&&(I=void 0),y&&y.lineNumber>=v&&(y=void 0),!I&&!y)break;let w=I?I.lineNumber-p:Number.MAX_VALUE,C=y?y.lineNumber-h:Number.MAX_VALUE;w<C?(s.dequeue(),y={lineNumber:I.lineNumber-p+h,heightInPx:0}):w>C?(a.dequeue(),I={lineNumber:y.lineNumber-h+p,heightInPx:0}):(s.dequeue(),a.dequeue()),c.push({originalRange:ht.ofLength(I.lineNumber,1),modifiedRange:ht.ofLength(y.lineNumber,1),originalHeightInPx:l+I.heightInPx,modifiedHeightInPx:d+y.heightInPx,diff:void 0})}}for(let g of e){let C=function(S,D,k=!1){if(S<w||D<y)return;if(I)I=!1;else if(!k&&(S===w||D===y))return;let M=new ht(w,S),O=new ht(y,D);if(M.isEmpty&&O.isEmpty)return;let K=s.takeWhile(Y=>Y.lineNumber<S)?.reduce((Y,ge)=>Y+ge.heightInPx,0)??0,G=a.takeWhile(Y=>Y.lineNumber<D)?.reduce((Y,ge)=>Y+ge.heightInPx,0)??0;c.push({originalRange:M,modifiedRange:O,originalHeightInPx:M.length*l+K,modifiedHeightInPx:O.length*d+G,diff:g.lineRangeMapping}),w=S,y=D};var f=C;let v=g.lineRangeMapping;m(v.original.startLineNumber,v.modified.startLineNumber);let I=!0,y=v.modified.startLineNumber,w=v.original.startLineNumber;if(o)for(let S of v.innerChanges||[]){S.originalRange.startColumn>1&&S.modifiedRange.startColumn>1&&C(S.originalRange.startLineNumber,S.modifiedRange.startLineNumber);let D=r.getModel(),k=S.originalRange.endLineNumber<=D.getLineCount()?D.getLineMaxColumn(S.originalRange.endLineNumber):Number.MAX_SAFE_INTEGER;S.originalRange.endColumn<k&&C(S.originalRange.endLineNumber,S.modifiedRange.endLineNumber)}C(v.original.endLineNumberExclusive,v.modified.endLineNumberExclusive,!0),p=v.original.endLineNumberExclusive,h=v.modified.endLineNumberExclusive}return m(Number.MAX_VALUE,Number.MAX_VALUE),c}function Ome(r,t){let e=[],i=[],n=r.getOption(148).wrappingColumn!==-1,o=r._getViewModel().coordinatesConverter,s=r.getOption(68);if(n)for(let l=1;l<=r.getModel().getLineCount();l++){let d=o.getModelLineViewLineCount(l);d>1&&i.push({lineNumber:l,heightInPx:s*(d-1)})}for(let l of r.getWhitespaces()){if(t.has(l.id))continue;let d=l.afterLineNumber===0?0:o.convertViewPositionToModelPosition(new H(l.afterLineNumber,1)).lineNumber;e.push({lineNumber:d,heightInPx:l.height})}return pme(e,i,l=>l.lineNumber,(l,d)=>({lineNumber:l.lineNumber,heightInPx:l.heightInPx+d.heightInPx}))}function rM(r){return r.innerChanges?r.innerChanges.every(t=>Nme(t.modifiedRange)&&Nme(t.originalRange)||t.originalRange.equalsRange(new L(1,1,1,1))):!1}function Nme(r){return r.startLineNumber===r.endLineNumber}var Fme={enableSplitViewResizing:!0,splitViewDefaultRatio:.5,renderSideBySide:!0,renderMarginRevertIcon:!0,renderGutterMenu:!0,maxComputationTime:5e3,maxFileSize:50,ignoreTrimWhitespace:!0,renderIndicators:!0,originalEditable:!1,diffCodeLens:!1,renderOverviewRuler:!0,diffWordWrap:"inherit",diffAlgorithm:"advanced",accessibilityVerbose:!1,experimental:{showMoves:!1,showEmptyDecorations:!0,useTrueInlineView:!1},hideUnchangedRegions:{enabled:!1,contextLineCount:3,minimumLineCount:3,revealLineCount:20},isInEmbeddedEditor:!1,onlyShowAccessibleDiffViewer:!1,renderSideBySideInlineBreakpoint:900,useInlineViewWhenSpaceIsLimited:!0,compactMode:!1};var BT=class{constructor(t,e){this._accessibilityService=e;let i={...t,...Bme(t,Fme)};this._options=Ht(this,i)}_options;get editorOptions(){return this._options}_diffEditorWidth=Ht(this,0);_screenReaderMode=Pi(this,this._accessibilityService.onDidChangeScreenReaderOptimized,()=>this._accessibilityService.isScreenReaderOptimized());couldShowInlineViewBecauseOfSize=dt(this,t=>this._options.read(t).renderSideBySide&&this._diffEditorWidth.read(t)<=this._options.read(t).renderSideBySideInlineBreakpoint);renderOverviewRuler=dt(this,t=>this._options.read(t).renderOverviewRuler);renderSideBySide=dt(this,t=>this.compactMode.read(t)&&this.shouldRenderInlineViewInSmartMode.read(t)?!1:this._options.read(t).renderSideBySide&&!(this._options.read(t).useInlineViewWhenSpaceIsLimited&&this.couldShowInlineViewBecauseOfSize.read(t)&&!this._screenReaderMode.read(t)));readOnly=dt(this,t=>this._options.read(t).readOnly);shouldRenderOldRevertArrows=dt(this,t=>!(!this._options.read(t).renderMarginRevertIcon||!this.renderSideBySide.read(t)||this.readOnly.read(t)||this.shouldRenderGutterMenu.read(t)));shouldRenderGutterMenu=dt(this,t=>this._options.read(t).renderGutterMenu);renderIndicators=dt(this,t=>this._options.read(t).renderIndicators);enableSplitViewResizing=dt(this,t=>this._options.read(t).enableSplitViewResizing);splitViewDefaultRatio=dt(this,t=>this._options.read(t).splitViewDefaultRatio);ignoreTrimWhitespace=dt(this,t=>this._options.read(t).ignoreTrimWhitespace);maxComputationTimeMs=dt(this,t=>this._options.read(t).maxComputationTime);showMoves=dt(this,t=>this._options.read(t).experimental.showMoves&&this.renderSideBySide.read(t));isInEmbeddedEditor=dt(this,t=>this._options.read(t).isInEmbeddedEditor);diffWordWrap=dt(this,t=>this._options.read(t).diffWordWrap);originalEditable=dt(this,t=>this._options.read(t).originalEditable);diffCodeLens=dt(this,t=>this._options.read(t).diffCodeLens);accessibilityVerbose=dt(this,t=>this._options.read(t).accessibilityVerbose);diffAlgorithm=dt(this,t=>this._options.read(t).diffAlgorithm);showEmptyDecorations=dt(this,t=>this._options.read(t).experimental.showEmptyDecorations);onlyShowAccessibleDiffViewer=dt(this,t=>this._options.read(t).onlyShowAccessibleDiffViewer);compactMode=dt(this,t=>this._options.read(t).compactMode);trueInlineDiffRenderingEnabled=dt(this,t=>this._options.read(t).experimental.useTrueInlineView);useTrueInlineDiffRendering=dt(this,t=>!this.renderSideBySide.read(t)&&this.trueInlineDiffRenderingEnabled.read(t));hideUnchangedRegions=dt(this,t=>this._options.read(t).hideUnchangedRegions.enabled);hideUnchangedRegionsRevealLineCount=dt(this,t=>this._options.read(t).hideUnchangedRegions.revealLineCount);hideUnchangedRegionsContextLineCount=dt(this,t=>this._options.read(t).hideUnchangedRegions.contextLineCount);hideUnchangedRegionsMinimumLineCount=dt(this,t=>this._options.read(t).hideUnchangedRegions.minimumLineCount);updateOptions(t){let e=Bme(t,this._options.get()),i={...this._options.get(),...t,...e};this._options.set(i,void 0,{changedOptions:t})}setWidth(t){this._diffEditorWidth.set(t,void 0)}_model=Ht(this,void 0);setModel(t){this._model.set(t,void 0)}shouldRenderInlineViewInSmartMode=this._model.map(this,t=>YJ(this,e=>{let i=t?.diff.read(e);return i?ZDe(i,this.trueInlineDiffRenderingEnabled.read(e)):void 0})).flatten().map(this,t=>!!t);inlineViewHideOriginalLineNumbers=this.compactMode};BT=E([b(1,Un)],BT);function ZDe(r,t){return r.mappings.every(e=>JDe(e.lineRangeMapping)||eke(e.lineRangeMapping)||t&&rM(e.lineRangeMapping))}function JDe(r){return r.original.length===0}function eke(r){return r.modified.length===0}function Bme(r,t){return{enableSplitViewResizing:He(r.enableSplitViewResizing,t.enableSplitViewResizing),splitViewDefaultRatio:aie(r.splitViewDefaultRatio,.5,.1,.9),renderSideBySide:He(r.renderSideBySide,t.renderSideBySide),renderMarginRevertIcon:He(r.renderMarginRevertIcon,t.renderMarginRevertIcon),maxComputationTime:If(r.maxComputationTime,t.maxComputationTime,0,1073741824),maxFileSize:If(r.maxFileSize,t.maxFileSize,0,1073741824),ignoreTrimWhitespace:He(r.ignoreTrimWhitespace,t.ignoreTrimWhitespace),renderIndicators:He(r.renderIndicators,t.renderIndicators),originalEditable:He(r.originalEditable,t.originalEditable),diffCodeLens:He(r.diffCodeLens,t.diffCodeLens),renderOverviewRuler:He(r.renderOverviewRuler,t.renderOverviewRuler),diffWordWrap:Pn(r.diffWordWrap,t.diffWordWrap,["off","on","inherit"]),diffAlgorithm:Pn(r.diffAlgorithm,t.diffAlgorithm,["legacy","advanced"],{smart:"legacy",experimental:"advanced"}),accessibilityVerbose:He(r.accessibilityVerbose,t.accessibilityVerbose),experimental:{showMoves:He(r.experimental?.showMoves,t.experimental.showMoves),showEmptyDecorations:He(r.experimental?.showEmptyDecorations,t.experimental.showEmptyDecorations),useTrueInlineView:He(r.experimental?.useTrueInlineView,t.experimental.useTrueInlineView)},hideUnchangedRegions:{enabled:He(r.hideUnchangedRegions?.enabled??r.experimental?.collapseUnchangedRegions,t.hideUnchangedRegions.enabled),contextLineCount:If(r.hideUnchangedRegions?.contextLineCount,t.hideUnchangedRegions.contextLineCount,0,1073741824),minimumLineCount:If(r.hideUnchangedRegions?.minimumLineCount,t.hideUnchangedRegions.minimumLineCount,0,1073741824),revealLineCount:If(r.hideUnchangedRegions?.revealLineCount,t.hideUnchangedRegions.revealLineCount,0,1073741824)},isInEmbeddedEditor:He(r.isInEmbeddedEditor,t.isInEmbeddedEditor),onlyShowAccessibleDiffViewer:He(r.onlyShowAccessibleDiffViewer,t.onlyShowAccessibleDiffViewer),renderSideBySideInlineBreakpoint:If(r.renderSideBySideInlineBreakpoint,t.renderSideBySideInlineBreakpoint,0,1073741824),useInlineViewWhenSpaceIsLimited:He(r.useInlineViewWhenSpaceIsLimited,t.useInlineViewWhenSpaceIsLimited),renderGutterMenu:He(r.renderGutterMenu,t.renderGutterMenu),compactMode:He(r.compactMode,t.compactMode)}}var VT=class extends R{constructor(e,i,n){super();this.model=e;this._options=i;this._diffProviderFactoryService=n;this._register(le(()=>this._cancellationTokenSource.cancel()));let o=Ip("contentChangedSignal"),s=this._register(new Ye(()=>o.trigger(void 0),200));this._register(Ft(l=>{let d=this._unchangedRegions.read(l);if(!d||d.regions.some(g=>g.isDragged.read(l)))return;let c=d.originalDecorationIds.map(g=>e.original.getDecorationRange(g)).map(g=>g?ht.fromRangeInclusive(g):void 0),p=d.modifiedDecorationIds.map(g=>e.modified.getDecorationRange(g)).map(g=>g?ht.fromRangeInclusive(g):void 0),h=d.regions.map((g,v)=>!c[v]||!p[v]?void 0:new WT(c[v].startLineNumber,p[v].startLineNumber,c[v].length,g.visibleLineCountTop.read(l),g.visibleLineCountBottom.read(l))).filter(go),m=[],f=!1;for(let g of CS(h,(v,I)=>v.getHiddenModifiedRange(l).endLineNumberExclusive===I.getHiddenModifiedRange(l).startLineNumber))if(g.length>1){f=!0;let v=g.reduce((y,w)=>y+w.lineCount,0),I=new WT(g[0].originalLineNumber,g[0].modifiedLineNumber,v,g[0].visibleLineCountTop.get(),g[g.length-1].visibleLineCountBottom.get());m.push(I)}else m.push(g[0]);if(f){let g=e.original.deltaDecorations(d.originalDecorationIds,m.map(I=>({range:I.originalUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}}))),v=e.modified.deltaDecorations(d.modifiedDecorationIds,m.map(I=>({range:I.modifiedUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}})));nn(I=>{this._unchangedRegions.set({regions:m,originalDecorationIds:g,modifiedDecorationIds:v},I)})}}));let a=(l,d,c)=>{let p=WT.fromDiffs(l.changes,e.original.getLineCount(),e.modified.getLineCount(),this._options.hideUnchangedRegionsMinimumLineCount.read(c),this._options.hideUnchangedRegionsContextLineCount.read(c)),h,m=this._unchangedRegions.get();if(m){let I=m.originalDecorationIds.map(S=>e.original.getDecorationRange(S)).map(S=>S?ht.fromRangeInclusive(S):void 0),y=m.modifiedDecorationIds.map(S=>e.modified.getDecorationRange(S)).map(S=>S?ht.fromRangeInclusive(S):void 0),C=mme(m.regions.map((S,D)=>{if(!I[D]||!y[D])return;let k=I[D].length;return new WT(I[D].startLineNumber,y[D].startLineNumber,k,Math.min(S.visibleLineCountTop.get(),k),Math.min(S.visibleLineCountBottom.get(),k-S.visibleLineCountTop.get()))}).filter(go),(S,D)=>!D||S.modifiedLineNumber>=D.modifiedLineNumber+D.lineCount&&S.originalLineNumber>=D.originalLineNumber+D.lineCount).map(S=>new Ws(S.getHiddenOriginalRange(c),S.getHiddenModifiedRange(c)));C=Ws.clip(C,ht.ofLength(1,e.original.getLineCount()),ht.ofLength(1,e.modified.getLineCount())),h=Ws.inverse(C,e.original.getLineCount(),e.modified.getLineCount())}let f=[];if(h)for(let I of p){let y=h.filter(w=>w.original.intersectsStrict(I.originalUnchangedRange)&&w.modified.intersectsStrict(I.modifiedUnchangedRange));f.push(...I.setVisibleRanges(y,d))}else f.push(...p);let g=e.original.deltaDecorations(m?.originalDecorationIds||[],f.map(I=>({range:I.originalUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}}))),v=e.modified.deltaDecorations(m?.modifiedDecorationIds||[],f.map(I=>({range:I.modifiedUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}})));this._unchangedRegions.set({regions:f,originalDecorationIds:g,modifiedDecorationIds:v},d)};this._register(e.modified.onDidChangeContent(l=>{if(this._diff.get()){let c=Ic.fromModelContentChanges(l.changes),p=(this._lastDiff,e.original,e.modified,void 0);p&&(this._lastDiff=p,nn(h=>{this._diff.set(aM.fromDiffResult(this._lastDiff),h),a(p,h);let m=this.movedTextToCompare.get();this.movedTextToCompare.set(m?this._lastDiff.moves.find(f=>f.lineRangeMapping.modified.intersect(m.lineRangeMapping.modified)):void 0,h)}))}this._isDiffUpToDate.set(!1,void 0),s.schedule()})),this._register(e.original.onDidChangeContent(l=>{if(this._diff.get()){let c=Ic.fromModelContentChanges(l.changes),p=(this._lastDiff,e.original,e.modified,void 0);p&&(this._lastDiff=p,nn(h=>{this._diff.set(aM.fromDiffResult(this._lastDiff),h),a(p,h);let m=this.movedTextToCompare.get();this.movedTextToCompare.set(m?this._lastDiff.moves.find(f=>f.lineRangeMapping.modified.intersect(m.lineRangeMapping.modified)):void 0,h)}))}this._isDiffUpToDate.set(!1,void 0),s.schedule()})),this._register(Cr(async(l,d)=>{this._options.hideUnchangedRegionsMinimumLineCount.read(l),this._options.hideUnchangedRegionsContextLineCount.read(l),s.cancel(),o.read(l);let c=this._diffProvider.read(l);c.onChangeSignal.read(l),Fc(kz,l),Fc(nM,l),this._isDiffUpToDate.set(!1,void 0);let p=[];d.add(e.original.onDidChangeContent(f=>{let g=Ic.fromModelContentChanges(f.changes);p=qC(p,g)}));let h=[];d.add(e.modified.onDidChangeContent(f=>{let g=Ic.fromModelContentChanges(f.changes);h=qC(h,g)}));let m=await c.diffProvider.computeDiff(e.original,e.modified,{ignoreTrimWhitespace:this._options.ignoreTrimWhitespace.read(l),maxComputationTimeMs:this._options.maxComputationTimeMs.read(l),computeMoves:this._options.showMoves.read(l)},this._cancellationTokenSource.token);this._cancellationTokenSource.token.isCancellationRequested||e.original.isDisposed()||e.modified.isDisposed()||(m=tke(m,e.original,e.modified),m=(e.original,e.modified,void 0)??m,m=(e.original,e.modified,void 0)??m,nn(f=>{a(m,f),this._lastDiff=m;let g=aM.fromDiffResult(m);this._diff.set(g,f),this._isDiffUpToDate.set(!0,f);let v=this.movedTextToCompare.get();this.movedTextToCompare.set(v?this._lastDiff.moves.find(I=>I.lineRangeMapping.modified.intersect(v.lineRangeMapping.modified)):void 0,f)}))}))}_isDiffUpToDate=Ht(this,!1);isDiffUpToDate=this._isDiffUpToDate;_lastDiff;_diff=Ht(this,void 0);diff=this._diff;_unchangedRegions=Ht(this,void 0);unchangedRegions=dt(this,e=>this._options.hideUnchangedRegions.read(e)?this._unchangedRegions.read(e)?.regions??[]:(nn(i=>{for(let n of this._unchangedRegions.get()?.regions||[])n.collapseAll(i)}),[]));movedTextToCompare=Ht(this,void 0);_activeMovedText=Ht(this,void 0);_hoveredMovedText=Ht(this,void 0);activeMovedText=dt(this,e=>this.movedTextToCompare.read(e)??this._hoveredMovedText.read(e)??this._activeMovedText.read(e));setActiveMovedText(e){this._activeMovedText.set(e,void 0)}setHoveredMovedText(e){this._hoveredMovedText.set(e,void 0)}_cancellationTokenSource=new Kt;_diffProvider=dt(this,e=>{let i=this._diffProviderFactoryService.createDiffProvider({diffAlgorithm:this._options.diffAlgorithm.read(e)}),n=hs("onDidChange",i.onDidChange);return{diffProvider:i,onChangeSignal:n}});ensureModifiedLineIsVisible(e,i,n){if(this.diff.get()?.mappings.length===0)return;let o=this._unchangedRegions.get()?.regions||[];for(let s of o)if(s.getHiddenModifiedRange(void 0).contains(e)){s.showModifiedLine(e,i,n);return}}ensureOriginalLineIsVisible(e,i,n){if(this.diff.get()?.mappings.length===0)return;let o=this._unchangedRegions.get()?.regions||[];for(let s of o)if(s.getHiddenOriginalRange(void 0).contains(e)){s.showOriginalLine(e,i,n);return}}async waitForDiff(){await c4(this.isDiffUpToDate,e=>e)}serializeState(){return{collapsedRegions:this._unchangedRegions.get()?.regions.map(i=>({range:i.getHiddenModifiedRange(void 0).serialize()}))}}restoreSerializedState(e){let i=e.collapsedRegions?.map(o=>ht.deserialize(o.range)),n=this._unchangedRegions.get();!n||!i||nn(o=>{for(let s of n.regions)for(let a of i)if(s.modifiedUnchangedRange.intersect(a)){s.setHiddenModifiedRange(a,o);break}})}};VT=E([b(2,OQ)],VT);function tke(r,t,e){return{changes:r.changes.map(i=>new Ll(i.original,i.modified,i.innerChanges?i.innerChanges.map(n=>ike(n,t,e)):void 0)),moves:r.moves,identical:r.identical,quitEarly:r.quitEarly}}function ike(r,t,e){let i=r.originalRange,n=r.modifiedRange;return i.startColumn===1&&n.startColumn===1&&(i.endColumn!==1||n.endColumn!==1)&&i.endColumn===t.getLineMaxColumn(i.endLineNumber)&&n.endColumn===e.getLineMaxColumn(n.endLineNumber)&&i.endLineNumber<t.getLineCount()&&n.endLineNumber<e.getLineCount()&&(i=i.setEndPosition(i.endLineNumber+1,1),n=n.setEndPosition(n.endLineNumber+1,1)),new ea(i,n)}var aM=class r{constructor(t,e,i,n){this.mappings=t;this.movedTexts=e;this.identical=i;this.quitEarly=n}static fromDiffResult(t){return new r(t.changes.map(e=>new sM(e)),t.moves||[],t.identical,t.quitEarly)}},sM=class{constructor(t){this.lineRangeMapping=t}},WT=class r{constructor(t,e,i,n,o){this.originalLineNumber=t;this.modifiedLineNumber=e;this.lineCount=i;let s=Math.max(Math.min(n,this.lineCount),0),a=Math.max(Math.min(o,this.lineCount-n),0);n4(n===s),n4(o===a),this._visibleLineCountTop.set(s,void 0),this._visibleLineCountBottom.set(a,void 0)}static fromDiffs(t,e,i,n,o){let s=Ll.inverse(t,e,i),a=[];for(let l of s){let d=l.original.startLineNumber,c=l.modified.startLineNumber,p=l.original.length,h=d===1&&c===1,m=d+p===e+1&&c+p===i+1;(h||m)&&p>=o+n?(h&&!m&&(p-=o),m&&!h&&(d+=o,c+=o,p-=o),a.push(new r(d,c,p,0,0))):p>=o*2+n&&(d+=o,c+=o,p-=o*2,a.push(new r(d,c,p,0,0)))}return a}get originalUnchangedRange(){return ht.ofLength(this.originalLineNumber,this.lineCount)}get modifiedUnchangedRange(){return ht.ofLength(this.modifiedLineNumber,this.lineCount)}_visibleLineCountTop=Ht(this,0);visibleLineCountTop=this._visibleLineCountTop;_visibleLineCountBottom=Ht(this,0);visibleLineCountBottom=this._visibleLineCountBottom;_shouldHideControls=dt(this,t=>this.visibleLineCountTop.read(t)+this.visibleLineCountBottom.read(t)===this.lineCount&&!this.isDragged.read(t));isDragged=Ht(this,void 0);setVisibleRanges(t,e){let i=[],n=new Ed(t.map(l=>l.modified)).subtractFrom(this.modifiedUnchangedRange),o=this.originalLineNumber,s=this.modifiedLineNumber,a=this.modifiedLineNumber+this.lineCount;if(n.ranges.length===0)this.showAll(e),i.push(this);else{let l=0;for(let d of n.ranges){let c=l===n.ranges.length-1;l++;let p=(c?a:d.endLineNumberExclusive)-s,h=new r(o,s,p,0,0);h.setHiddenModifiedRange(d,e),i.push(h),o=h.originalUnchangedRange.endLineNumberExclusive,s=h.modifiedUnchangedRange.endLineNumberExclusive}}return i}shouldHideControls(t){return this._shouldHideControls.read(t)}getHiddenOriginalRange(t){return ht.ofLength(this.originalLineNumber+this._visibleLineCountTop.read(t),this.lineCount-this._visibleLineCountTop.read(t)-this._visibleLineCountBottom.read(t))}getHiddenModifiedRange(t){return ht.ofLength(this.modifiedLineNumber+this._visibleLineCountTop.read(t),this.lineCount-this._visibleLineCountTop.read(t)-this._visibleLineCountBottom.read(t))}setHiddenModifiedRange(t,e){let i=t.startLineNumber-this.modifiedLineNumber,n=this.modifiedLineNumber+this.lineCount-t.endLineNumberExclusive;this.setState(i,n,e)}getMaxVisibleLineCountTop(){return this.lineCount-this._visibleLineCountBottom.get()}getMaxVisibleLineCountBottom(){return this.lineCount-this._visibleLineCountTop.get()}showMoreAbove(t=10,e){let i=this.getMaxVisibleLineCountTop();this._visibleLineCountTop.set(Math.min(this._visibleLineCountTop.get()+t,i),e)}showMoreBelow(t=10,e){let i=this.lineCount-this._visibleLineCountTop.get();this._visibleLineCountBottom.set(Math.min(this._visibleLineCountBottom.get()+t,i),e)}showAll(t){this._visibleLineCountBottom.set(this.lineCount-this._visibleLineCountTop.get(),t)}showModifiedLine(t,e,i){let n=t+1-(this.modifiedLineNumber+this._visibleLineCountTop.get()),o=this.modifiedLineNumber-this._visibleLineCountBottom.get()+this.lineCount-t;e===0&&n<o||e===1?this._visibleLineCountTop.set(this._visibleLineCountTop.get()+n,i):this._visibleLineCountBottom.set(this._visibleLineCountBottom.get()+o,i)}showOriginalLine(t,e,i){let n=t-this.originalLineNumber,o=this.originalLineNumber+this.lineCount-t;e===0&&n<o||e===1?this._visibleLineCountTop.set(Math.min(this._visibleLineCountTop.get()+o-n,this.getMaxVisibleLineCountTop()),i):this._visibleLineCountBottom.set(Math.min(this._visibleLineCountBottom.get()+n-o,this.getMaxVisibleLineCountBottom()),i)}collapseAll(t){this._visibleLineCountTop.set(0,t),this._visibleLineCountBottom.set(0,t)}setState(t,e,i){t=Math.max(Math.min(t,this.lineCount),0),e=Math.max(Math.min(e,this.lineCount-t),0),this._visibleLineCountTop.set(t,i),this._visibleLineCountBottom.set(e,i)}};var as=class extends R{constructor(e,i,n,o,s,a,l){super();this._editors=e;this._rootElement=i;this._diffModel=n;this._rootWidth=o;this._rootHeight=s;this._modifiedEditorLayoutInfo=a;this._themeService=l;let d=Pi(this._themeService.onDidColorThemeChange,()=>this._themeService.getColorTheme()),c=dt(m=>{let f=d.read(m),g=f.getColor(Tne)||(f.getColor(Ene)||y0).transparent(2),v=f.getColor(_ne)||(f.getColor(xne)||S0).transparent(2);return{insertColor:g,removeColor:v}}),p=Ot(document.createElement("div"));p.setClassName("diffViewport"),p.setPosition("absolute");let h=wi("div.diffOverview",{style:{position:"absolute",top:"0px",width:as.ENTIRE_DIFF_OVERVIEW_WIDTH+"px"}}).root;this._register(cS(h,p.domNode)),this._register(Ut(h,Q.POINTER_DOWN,m=>{this._editors.modified.delegateVerticalScrollbarPointerDown(m)})),this._register(F(h,Q.MOUSE_WHEEL,m=>{this._editors.modified.delegateScrollFromMouseWheelEvent(m)},{passive:!1})),this._register(cS(this._rootElement,h)),this._register(Cr((m,f)=>{let g=this._diffModel.read(m),v=this._editors.original.createOverviewRuler("original diffOverviewRuler");v&&(f.add(v),f.add(cS(h,v.getDomNode())));let I=this._editors.modified.createOverviewRuler("modified diffOverviewRuler");if(I&&(f.add(I),f.add(cS(h,I.getDomNode()))),!v||!I)return;let y=hs("viewZoneChanged",this._editors.original.onDidChangeViewZones),w=hs("viewZoneChanged",this._editors.modified.onDidChangeViewZones),C=hs("hiddenRangesChanged",this._editors.original.onDidChangeHiddenAreas),S=hs("hiddenRangesChanged",this._editors.modified.onDidChangeHiddenAreas);f.add(Ft(D=>{y.read(D),w.read(D),C.read(D),S.read(D);let k=c.read(D),M=g?.diff.read(D)?.mappings;function O(Y,ge,xe){let be=xe._getViewModel();return be?Y.filter(fe=>fe.length>0).map(fe=>{let Le=be.coordinatesConverter.convertModelPositionToViewPosition(new H(fe.startLineNumber,1)),Ee=be.coordinatesConverter.convertModelPositionToViewPosition(new H(fe.endLineNumberExclusive,1)),Ce=Ee.lineNumber-Le.lineNumber;return new dk(Le.lineNumber,Ee.lineNumber,Ce,ge.toString())}):[]}let K=O((M||[]).map(Y=>Y.lineRangeMapping.original),k.removeColor,this._editors.original),G=O((M||[]).map(Y=>Y.lineRangeMapping.modified),k.insertColor,this._editors.modified);v?.setZones(K),I?.setZones(G)})),f.add(Ft(D=>{let k=this._rootHeight.read(D),M=this._rootWidth.read(D),O=this._modifiedEditorLayoutInfo.read(D);if(O){let K=as.ENTIRE_DIFF_OVERVIEW_WIDTH-2*as.ONE_OVERVIEW_WIDTH;v.setLayout({top:0,height:k,right:K+as.ONE_OVERVIEW_WIDTH,width:as.ONE_OVERVIEW_WIDTH}),I.setLayout({top:0,height:k,right:0,width:as.ONE_OVERVIEW_WIDTH});let G=this._editors.modifiedScrollTop.read(D),Y=this._editors.modifiedScrollHeight.read(D),ge=this._editors.modified.getOption(105),xe=new Xf(ge.verticalHasArrows?ge.arrowSize:0,ge.verticalScrollbarSize,0,O.height,Y,G);p.setTop(xe.getSliderPosition()),p.setHeight(xe.getSliderSize())}else p.setTop(0),p.setHeight(0);h.style.height=k+"px",h.style.left=M-as.ENTIRE_DIFF_OVERVIEW_WIDTH+"px",p.setWidth(as.ENTIRE_DIFF_OVERVIEW_WIDTH)}))}))}static ONE_OVERVIEW_WIDTH=15;static ENTIRE_DIFF_OVERVIEW_WIDTH=this.ONE_OVERVIEW_WIDTH*2;width=as.ENTIRE_DIFF_OVERVIEW_WIDTH};as=E([b(6,Fe)],as);var HT=class extends R{constructor(e,i,n,o,s,a,l){super();this.originalEditorElement=e;this.modifiedEditorElement=i;this._options=n;this._argCodeEditorWidgetOptions=o;this._createInnerEditor=s;this._instantiationService=a;this._keybindingService=l;this._argCodeEditorWidgetOptions=null,this._register(Gg({createEmptyChangeSummary:()=>({}),handleChange:(d,c)=>(d.didChange(n.editorOptions)&&Object.assign(c,d.change.changedOptions),!0)},(d,c)=>{n.editorOptions.read(d),this._options.renderSideBySide.read(d),this.modified.updateOptions(this._adjustOptionsForRightHandSide(d,c)),this.original.updateOptions(this._adjustOptionsForLeftHandSide(d,c))}))}original=this._register(this._createLeftHandSideEditor(this._options.editorOptions.get(),this._argCodeEditorWidgetOptions.originalEditor||{}));modified=this._register(this._createRightHandSideEditor(this._options.editorOptions.get(),this._argCodeEditorWidgetOptions.modifiedEditor||{}));_onDidContentSizeChange=this._register(new x);get onDidContentSizeChange(){return this._onDidContentSizeChange.event}modifiedScrollTop=Pi(this,this.modified.onDidScrollChange,()=>this.modified.getScrollTop());modifiedScrollHeight=Pi(this,this.modified.onDidScrollChange,()=>this.modified.getScrollHeight());modifiedObs=uS(this.modified);originalObs=uS(this.original);modifiedModel=this.modifiedObs.model;modifiedSelections=Pi(this,this.modified.onDidChangeCursorSelection,()=>this.modified.getSelections()??[]);modifiedCursor=Os({owner:this,equalsFn:H.equals},e=>this.modifiedSelections.read(e)[0]?.getPosition()??new H(1,1));originalCursor=Pi(this,this.original.onDidChangeCursorPosition,()=>this.original.getPosition()??new H(1,1));isOriginalFocused=uS(this.original).isFocused;isModifiedFocused=uS(this.modified).isFocused;isFocused=dt(this,e=>this.isOriginalFocused.read(e)||this.isModifiedFocused.read(e));_createLeftHandSideEditor(e,i){let n=this._adjustOptionsForLeftHandSide(void 0,e),o=this._constructInnerEditor(this._instantiationService,this.originalEditorElement,n,i);return o.setContextValue("isInDiffLeftEditor",!0),o}_createRightHandSideEditor(e,i){let n=this._adjustOptionsForRightHandSide(void 0,e),o=this._constructInnerEditor(this._instantiationService,this.modifiedEditorElement,n,i);return o.setContextValue("isInDiffRightEditor",!0),o}_constructInnerEditor(e,i,n,o){let s=this._createInnerEditor(e,i,n,o);return this._register(s.onDidContentSizeChange(a=>{let l=this.original.getContentWidth()+this.modified.getContentWidth()+as.ENTIRE_DIFF_OVERVIEW_WIDTH,d=Math.max(this.modified.getContentHeight(),this.original.getContentHeight());this._onDidContentSizeChange.fire({contentHeight:d,contentWidth:l,contentHeightChanged:a.contentHeightChanged,contentWidthChanged:a.contentWidthChanged})})),s}_adjustOptionsForLeftHandSide(e,i){let n=this._adjustOptionsForSubEditor(i);return this._options.renderSideBySide.get()?(n.unicodeHighlight=this._options.editorOptions.get().unicodeHighlight||{},n.wordWrapOverride1=this._options.diffWordWrap.get()):(n.wordWrapOverride1="off",n.wordWrapOverride2="off",n.stickyScroll={enabled:!1},n.unicodeHighlight={nonBasicASCII:!1,ambiguousCharacters:!1,invisibleCharacters:!1}),n.glyphMargin=this._options.renderSideBySide.get(),i.originalAriaLabel&&(n.ariaLabel=i.originalAriaLabel),n.ariaLabel=this._updateAriaLabel(n.ariaLabel),n.readOnly=!this._options.originalEditable.get(),n.dropIntoEditor={enabled:!n.readOnly},n.extraEditorClassName="original-in-monaco-diff-editor",n}_adjustOptionsForRightHandSide(e,i){let n=this._adjustOptionsForSubEditor(i);return i.modifiedAriaLabel&&(n.ariaLabel=i.modifiedAriaLabel),n.ariaLabel=this._updateAriaLabel(n.ariaLabel),n.wordWrapOverride1=this._options.diffWordWrap.get(),n.revealHorizontalRightPadding=uc.revealHorizontalRightPadding.defaultValue+as.ENTIRE_DIFF_OVERVIEW_WIDTH,n.scrollbar.verticalHasArrows=!1,n.extraEditorClassName="modified-in-monaco-diff-editor",n}_adjustOptionsForSubEditor(e){let i={...e,dimension:{height:0,width:0}};return i.inDiffEditor=!0,i.automaticLayout=!1,i.scrollbar={...i.scrollbar||{}},i.folding=!1,i.codeLens=this._options.diffCodeLens.get(),i.fixedOverflowWidgets=!0,i.minimap={...i.minimap||{}},i.minimap.enabled=!1,this._options.hideUnchangedRegions.get()?i.stickyScroll={enabled:!1}:i.stickyScroll=this._options.editorOptions.get().stickyScroll,i}_updateAriaLabel(e){e||(e="");let i=u("diff-aria-navigation-tip"," use {0} to open the accessibility help.",this._keybindingService.lookupKeybinding("editor.action.accessibilityHelp")?.getAriaLabel());return this._options.accessibilityVerbose.get()?e+i:e?e.replaceAll(i,""):""}};HT=E([b(5,ne),b(6,Be)],HT);var nke=ke("diff-review-insert",N.add,u("accessibleDiffViewerInsertIcon","Icon for 'Insert' in accessible diff viewer.")),oke=ke("diff-review-remove",N.remove,u("accessibleDiffViewerRemoveIcon","Icon for 'Remove' in accessible diff viewer.")),rke=ke("diff-review-close",N.close,u("accessibleDiffViewerCloseIcon","Icon for 'Close' in accessible diff viewer.")),Jh=class extends R{constructor(e,i,n,o,s,a,l,d,c){super();this._parentNode=e;this._visible=i;this._setVisible=n;this._canClose=o;this._width=s;this._height=a;this._diffs=l;this._models=d;this._instantiationService=c}static _ttPolicy=kh("diffReview",{createHTML:e=>e});_state=qc(this,(e,i)=>{let n=this._visible.read(e);if(this._parentNode.style.visibility=n?"visible":"hidden",!n)return null;let o=i.add(this._instantiationService.createInstance(dM,this._diffs,this._models,this._setVisible,this._canClose)),s=i.add(this._instantiationService.createInstance(cM,this._parentNode,o,this._width,this._height,this._models));return{model:o,view:s}}).recomputeInitiallyAndOnChange(this._store);next(){nn(e=>{let i=this._visible.get();this._setVisible(!0,e),i&&this._state.get().model.nextGroup(e)})}prev(){nn(e=>{this._setVisible(!0,e),this._state.get().model.previousGroup(e)})}close(){nn(e=>{this._setVisible(!1,e)})}};Jh=E([b(8,ne)],Jh);var dM=class extends R{constructor(e,i,n,o,s){super();this._diffs=e;this._models=i;this._setVisible=n;this.canClose=o;this._accessibilitySignalService=s;this._register(Ft(a=>{let l=this._diffs.read(a);if(!l){this._groups.set([],void 0);return}let d=ske(l,this._models.getOriginalModel().getLineCount(),this._models.getModifiedModel().getLineCount());nn(c=>{let p=this._models.getModifiedPosition();if(p){let h=d.findIndex(m=>p?.lineNumber<m.range.modified.endLineNumberExclusive);h!==-1&&this._currentGroupIdx.set(h,c)}this._groups.set(d,c)})})),this._register(Ft(a=>{let l=this.currentElement.read(a);l?.type===2?this._accessibilitySignalService.playSignal(ks.diffLineDeleted,{source:"accessibleDiffViewer.currentElementChanged"}):l?.type===3&&this._accessibilitySignalService.playSignal(ks.diffLineInserted,{source:"accessibleDiffViewer.currentElementChanged"})})),this._register(Ft(a=>{let l=this.currentElement.read(a);if(l&&l.type!==0){let d=l.modifiedLineNumber??l.diff.modified.startLineNumber;this._models.modifiedSetSelection(L.fromPositions(new H(d,1)))}}))}_groups=Ht(this,[]);_currentGroupIdx=Ht(this,0);_currentElementIdx=Ht(this,0);groups=this._groups;currentGroup=this._currentGroupIdx.map((e,i)=>this._groups.read(i)[e]);currentGroupIndex=this._currentGroupIdx;currentElement=this._currentElementIdx.map((e,i)=>this.currentGroup.read(i)?.lines[e]);_goToGroupDelta(e,i){let n=this.groups.get();!n||n.length<=1||yp(i,o=>{this._currentGroupIdx.set(Qe.ofLength(n.length).clipCyclic(this._currentGroupIdx.get()+e),o),this._currentElementIdx.set(0,o)})}nextGroup(e){this._goToGroupDelta(1,e)}previousGroup(e){this._goToGroupDelta(-1,e)}_goToLineDelta(e){let i=this.currentGroup.get();!i||i.lines.length<=1||nn(n=>{this._currentElementIdx.set(Qe.ofLength(i.lines.length).clip(this._currentElementIdx.get()+e),n)})}goToNextLine(){this._goToLineDelta(1)}goToPreviousLine(){this._goToLineDelta(-1)}goToLine(e){let i=this.currentGroup.get();if(!i)return;let n=i.lines.indexOf(e);n!==-1&&nn(o=>{this._currentElementIdx.set(n,o)})}revealCurrentElementInEditor(){if(!this.canClose.get())return;this._setVisible(!1,void 0);let e=this.currentElement.get();e&&(e.type===2?this._models.originalReveal(L.fromPositions(new H(e.originalLineNumber,1))):this._models.modifiedReveal(e.type!==0?L.fromPositions(new H(e.modifiedLineNumber,1)):void 0))}close(){this.canClose.get()&&(this._setVisible(!1,void 0),this._models.modifiedFocus())}};dM=E([b(4,Rx)],dM);var lM=3;function ske(r,t,e){let i=[];for(let n of CS(r,(o,s)=>s.modified.startLineNumber-o.modified.endLineNumberExclusive<2*lM)){let o=[];o.push(new $Q);let s=new ht(Math.max(1,n[0].original.startLineNumber-lM),Math.min(n[n.length-1].original.endLineNumberExclusive+lM,t+1)),a=new ht(Math.max(1,n[0].modified.startLineNumber-lM),Math.min(n[n.length-1].modified.endLineNumberExclusive+lM,e+1));zM(n,(c,p)=>{let h=new ht(c?c.original.endLineNumberExclusive:s.startLineNumber,p?p.original.startLineNumber:s.endLineNumberExclusive),m=new ht(c?c.modified.endLineNumberExclusive:a.startLineNumber,p?p.modified.startLineNumber:a.endLineNumberExclusive);h.forEach(f=>{o.push(new YQ(f,m.startLineNumber+(f-h.startLineNumber)))}),p&&(p.original.forEach(f=>{o.push(new jQ(p,f))}),p.modified.forEach(f=>{o.push(new XQ(p,f))}))});let l=n[0].modified.join(n[n.length-1].modified),d=n[0].original.join(n[n.length-1].original);i.push(new qQ(new Ws(l,d),o))}return i}var qQ=class{constructor(t,e){this.range=t;this.lines=e}},$Q=class{type=0},jQ=class{constructor(t,e){this.diff=t;this.originalLineNumber=e}type=2;modifiedLineNumber=void 0},XQ=class{constructor(t,e){this.diff=t;this.modifiedLineNumber=e}type=3;originalLineNumber=void 0},YQ=class{constructor(t,e){this.originalLineNumber=t;this.modifiedLineNumber=e}type=1},cM=class extends R{constructor(e,i,n,o,s,a){super();this._element=e;this._model=i;this._width=n;this._height=o;this._models=s;this._languageService=a;this.domNode=this._element,this.domNode.className="monaco-component diff-review monaco-editor-background";let l=document.createElement("div");l.className="diff-review-actions",this._actionBar=this._register(new Fi(l)),this._register(Ft(d=>{this._actionBar.clear(),this._model.canClose.read(d)&&this._actionBar.push(new et("diffreview.close",u("label.close","Close"),"close-diff-review "+de.asClassName(rke),!0,async()=>i.close()),{label:!1,icon:!0})})),this._content=document.createElement("div"),this._content.className="diff-review-content",this._content.setAttribute("role","code"),this._scrollbar=this._register(new Da(this._content,{})),bo(this.domNode,this._scrollbar.getDomNode(),l),this._register(Ft(d=>{this._height.read(d),this._width.read(d),this._scrollbar.scanDomNode()})),this._register(le(()=>{bo(this.domNode)})),this._register(ec(this.domNode,{width:this._width,height:this._height})),this._register(ec(this._content,{width:this._width,height:this._height})),this._register(Cr((d,c)=>{this._model.currentGroup.read(d),this._render(c)})),this._register(Ut(this.domNode,"keydown",d=>{(d.equals(18)||d.equals(2066)||d.equals(530))&&(d.preventDefault(),this._model.goToNextLine()),(d.equals(16)||d.equals(2064)||d.equals(528))&&(d.preventDefault(),this._model.goToPreviousLine()),(d.equals(9)||d.equals(2057)||d.equals(521)||d.equals(1033))&&(d.preventDefault(),this._model.close()),(d.equals(10)||d.equals(3))&&(d.preventDefault(),this._model.revealCurrentElementInEditor())}))}domNode;_content;_scrollbar;_actionBar;_render(e){let i=this._models.getOriginalOptions(),n=this._models.getModifiedOptions(),o=document.createElement("div");o.className="diff-review-table",o.setAttribute("role","list"),o.setAttribute("aria-label",u("ariaLabel","Accessible Diff Viewer. Use arrow up and down to navigate.")),hn(o,n.get(51)),bo(this._content,o);let s=this._models.getOriginalModel(),a=this._models.getModifiedModel();if(!s||!a)return;let l=s.getOptions(),d=a.getOptions(),c=n.get(68),p=this._model.currentGroup.get();for(let h of p?.lines||[]){if(!p)break;let m;if(h.type===0){let g=document.createElement("div");g.className="diff-review-row",g.setAttribute("role","listitem");let v=p.range,I=this._model.currentGroupIndex.get(),y=this._model.groups.get().length,w=k=>k===0?u("no_lines_changed","no lines changed"):k===1?u("one_line_changed","1 line changed"):u("more_lines_changed","{0} lines changed",k),C=w(v.original.length),S=w(v.modified.length);g.setAttribute("aria-label",u({key:"header",comment:["This is the ARIA label for a git diff header.","A git diff header looks like this: @@ -154,12 +159,39 @@.","That encodes that at original line 154 (which is now line 159), 12 lines were removed/changed with 39 lines.","Variables 0 and 1 refer to the diff index out of total number of diffs.","Variables 2 and 4 will be numbers (a line number).",'Variables 3 and 5 will be "no lines changed", "1 line changed" or "X lines changed", localized separately.']},"Difference {0} of {1}: original line {2}, {3}, modified line {4}, {5}",I+1,y,v.original.startLineNumber,C,v.modified.startLineNumber,S));let D=document.createElement("div");D.className="diff-review-cell diff-review-summary",D.appendChild(document.createTextNode(`${I+1}/${y}: @@ -${v.original.startLineNumber},${v.original.length} +${v.modified.startLineNumber},${v.modified.length} @@`)),g.appendChild(D),m=g}else m=this._createRow(h,c,this._width.get(),i,s,l,n,a,d);o.appendChild(m);let f=dt(g=>this._model.currentElement.read(g)===h);e.add(Ft(g=>{let v=f.read(g);m.tabIndex=v?0:-1,v&&m.focus()})),e.add(F(m,"focus",()=>{this._model.goToLine(h)}))}this._scrollbar.scanDomNode()}_createRow(e,i,n,o,s,a,l,d,c){let p=o.get(147),h=p.glyphMarginWidth+p.lineNumbersWidth,m=l.get(147),f=10+m.glyphMarginWidth+m.lineNumbersWidth,g="diff-review-row",v="",I="diff-review-spacer",y=null;switch(e.type){case 3:g="diff-review-row line-insert",v=" char-insert",y=nke;break;case 2:g="diff-review-row line-delete",v=" char-delete",y=oke;break}let w=document.createElement("div");w.style.minWidth=n+"px",w.className=g,w.setAttribute("role","listitem"),w.ariaLevel="";let C=document.createElement("div");C.className="diff-review-cell",C.style.height=`${i}px`,w.appendChild(C);let S=document.createElement("span");S.style.width=h+"px",S.style.minWidth=h+"px",S.className="diff-review-line-number"+v,e.originalLineNumber!==void 0?S.appendChild(document.createTextNode(String(e.originalLineNumber))):S.innerText="\xA0",C.appendChild(S);let D=document.createElement("span");D.style.width=f+"px",D.style.minWidth=f+"px",D.style.paddingRight="10px",D.className="diff-review-line-number"+v,e.modifiedLineNumber!==void 0?D.appendChild(document.createTextNode(String(e.modifiedLineNumber))):D.innerText="\xA0",C.appendChild(D);let k=document.createElement("span");if(k.className=I,y){let K=document.createElement("span");K.className=de.asClassName(y),K.innerText="\xA0\xA0",k.appendChild(K)}else k.innerText="\xA0\xA0";C.appendChild(k);let M;if(e.modifiedLineNumber!==void 0){let K=this._getLineHtml(d,l,c.tabSize,e.modifiedLineNumber,this._languageService.languageIdCodec);Jh._ttPolicy&&(K=Jh._ttPolicy.createHTML(K)),C.insertAdjacentHTML("beforeend",K),M=d.getLineContent(e.modifiedLineNumber)}else{let K=this._getLineHtml(s,o,a.tabSize,e.originalLineNumber,this._languageService.languageIdCodec);Jh._ttPolicy&&(K=Jh._ttPolicy.createHTML(K)),C.insertAdjacentHTML("beforeend",K),M=s.getLineContent(e.originalLineNumber)}M.length===0&&(M=u("blankLine","blank"));let O="";switch(e.type){case 1:e.originalLineNumber===e.modifiedLineNumber?O=u({key:"unchangedLine",comment:["The placeholders are contents of the line and should not be translated."]},"{0} unchanged line {1}",M,e.originalLineNumber):O=u("equalLine","{0} original line {1} modified line {2}",M,e.originalLineNumber,e.modifiedLineNumber);break;case 3:O=u("insertLine","+ {0} modified line {1}",M,e.modifiedLineNumber);break;case 2:O=u("deleteLine","- {0} original line {1}",M,e.originalLineNumber);break}return w.setAttribute("aria-label",O),w}_getLineHtml(e,i,n,o,s){let a=e.getLineContent(o),l=i.get(51),d=io.createEmpty(a,s),c=zp.isBasicASCII(a,e.mightContainNonBasicASCII()),p=zp.containsRTL(a,c,e.mightContainRTL());return Cce(new Rb(l.isMonospace&&!i.get(33),l.canUseHalfwidthRightwardsArrow,a,!1,c,p,0,d,[],n,0,l.spaceWidth,l.middotWidth,l.wsmiddotWidth,i.get(119),i.get(101),i.get(96),i.get(52)!==ou.OFF,null)).html}};cM=E([b(5,ti)],cM);var Mz=class{constructor(t){this.editors=t}getOriginalModel(){return this.editors.original.getModel()}getOriginalOptions(){return this.editors.original.getOptions()}originalReveal(t){this.editors.original.revealRange(t),this.editors.original.setSelection(t),this.editors.original.focus()}getModifiedModel(){return this.editors.modified.getModel()}getModifiedOptions(){return this.editors.modified.getOptions()}modifiedReveal(t){t&&(this.editors.modified.revealRange(t),this.editors.modified.setSelection(t)),this.editors.modified.focus()}modifiedSetSelection(t){this.editors.modified.setSelection(t)}modifiedFocus(){this.editors.modified.focus()}getModifiedPosition(){return this.editors.modified.getPosition()??void 0}};var Ev=class r extends R{constructor(e,i,n,o,s){super();this._rootElement=e;this._diffModel=i;this._originalEditorLayoutInfo=n;this._modifiedEditorLayoutInfo=o;this._editors=s;this._element=document.createElementNS("http://www.w3.org/2000/svg","svg"),this._element.setAttribute("class","moved-blocks-lines"),this._rootElement.appendChild(this._element),this._register(le(()=>this._element.remove())),this._register(Ft(p=>{let h=this._originalEditorLayoutInfo.read(p),m=this._modifiedEditorLayoutInfo.read(p);!h||!m||(this._element.style.left=`${h.width-h.verticalScrollbarWidth}px`,this._element.style.height=`${h.height}px`,this._element.style.width=`${h.verticalScrollbarWidth+h.contentLeft-r.movedCodeBlockPadding+this.width.read(p)}px`)})),this._register($g(this._state));let a=dt(p=>{let m=this._diffModel.read(p)?.diff.read(p);return m?m.movedTexts.map(f=>({move:f,original:new Yh(qg(f.lineRangeMapping.original.startLineNumber-1),18),modified:new Yh(qg(f.lineRangeMapping.modified.startLineNumber-1),18)})):[]});this._register(AT(this._editors.original,a.map(p=>p.map(h=>h.original)))),this._register(AT(this._editors.modified,a.map(p=>p.map(h=>h.modified)))),this._register(Cr((p,h)=>{let m=a.read(p);for(let f of m)h.add(new Az(this._editors.original,f.original,f.move,"original",this._diffModel.get())),h.add(new Az(this._editors.modified,f.modified,f.move,"modified",this._diffModel.get()))}));let l=hs("original.onDidFocusEditorWidget",p=>this._editors.original.onDidFocusEditorWidget(()=>setTimeout(()=>p(void 0),0))),d=hs("modified.onDidFocusEditorWidget",p=>this._editors.modified.onDidFocusEditorWidget(()=>setTimeout(()=>p(void 0),0))),c="modified";this._register(Gg({createEmptyChangeSummary:()=>{},handleChange:(p,h)=>(p.didChange(l)&&(c="original"),p.didChange(d)&&(c="modified"),!0)},p=>{l.read(p),d.read(p);let h=this._diffModel.read(p);if(!h)return;let m=h.diff.read(p),f;if(m&&c==="original"){let g=this._editors.originalCursor.read(p);g&&(f=m.movedTexts.find(v=>v.lineRangeMapping.original.contains(g.lineNumber)))}if(m&&c==="modified"){let g=this._editors.modifiedCursor.read(p);g&&(f=m.movedTexts.find(v=>v.lineRangeMapping.modified.contains(g.lineNumber)))}f!==h.movedTextToCompare.get()&&h.movedTextToCompare.set(void 0,void 0),h.setActiveMovedText(f)}))}static movedCodeBlockPadding=4;_element;_originalScrollTop=Pi(this,this._editors.original.onDidScrollChange,()=>this._editors.original.getScrollTop());_modifiedScrollTop=Pi(this,this._editors.modified.onDidScrollChange,()=>this._editors.modified.getScrollTop());_viewZonesChanged=hs("onDidChangeViewZones",this._editors.modified.onDidChangeViewZones);width=Ht(this,0);_modifiedViewZonesChangedSignal=hs("modified.onDidChangeViewZones",this._editors.modified.onDidChangeViewZones);_originalViewZonesChangedSignal=hs("original.onDidChangeViewZones",this._editors.original.onDidChangeViewZones);_state=qc(this,(e,i)=>{this._element.replaceChildren();let n=this._diffModel.read(e),o=n?.diff.read(e)?.movedTexts;if(!o||o.length===0){this.width.set(0,void 0);return}this._viewZonesChanged.read(e);let s=this._originalEditorLayoutInfo.read(e),a=this._modifiedEditorLayoutInfo.read(e);if(!s||!a){this.width.set(0,void 0);return}this._modifiedViewZonesChangedSignal.read(e),this._originalViewZonesChangedSignal.read(e);let l=o.map(g=>{function v(O,K){let G=K.getTopForLineNumber(O.startLineNumber,!0),Y=K.getTopForLineNumber(O.endLineNumberExclusive,!0);return(G+Y)/2}let I=v(g.lineRangeMapping.original,this._editors.original),y=this._originalScrollTop.read(e),w=v(g.lineRangeMapping.modified,this._editors.modified),C=this._modifiedScrollTop.read(e),S=I-y,D=w-C,k=Math.min(I,w),M=Math.max(I,w);return{range:new Qe(k,M),from:S,to:D,fromWithoutScroll:I,toWithoutScroll:w,move:g}});l.sort(xJ(Sr(g=>g.fromWithoutScroll>g.toWithoutScroll,TJ),Sr(g=>g.fromWithoutScroll>g.toWithoutScroll?g.fromWithoutScroll:-g.toWithoutScroll,ud)));let d=QQ.compute(l.map(g=>g.range)),c=10,p=s.verticalScrollbarWidth,h=(d.getTrackCount()-1)*10+c*2,m=p+h+(a.contentLeft-r.movedCodeBlockPadding),f=0;for(let g of l){let v=d.getTrack(f),I=p+c+v*10,y=15,w=15,C=m,S=a.glyphMarginWidth+a.lineNumbersWidth,D=18,k=document.createElementNS("http://www.w3.org/2000/svg","rect");k.classList.add("arrow-rectangle"),k.setAttribute("x",`${C-S}`),k.setAttribute("y",`${g.to-D/2}`),k.setAttribute("width",`${S}`),k.setAttribute("height",`${D}`),this._element.appendChild(k);let M=document.createElementNS("http://www.w3.org/2000/svg","g"),O=document.createElementNS("http://www.w3.org/2000/svg","path");O.setAttribute("d",`M 0 ${g.from} L ${I} ${g.from} L ${I} ${g.to} L ${C-w} ${g.to}`),O.setAttribute("fill","none"),M.appendChild(O);let K=document.createElementNS("http://www.w3.org/2000/svg","polygon");K.classList.add("arrow"),i.add(Ft(G=>{O.classList.toggle("currentMove",g.move===n.activeMovedText.read(G)),K.classList.toggle("currentMove",g.move===n.activeMovedText.read(G))})),K.setAttribute("points",`${C-w},${g.to-y/2} ${C},${g.to} ${C-w},${g.to+y/2}`),M.appendChild(K),this._element.appendChild(M),f++}this.width.set(h,void 0)})},QQ=class r{constructor(t,e){this._trackCount=t;this.trackPerLineIdx=e}static compute(t){let e=[],i=[];for(let n of t){let o=e.findIndex(s=>!s.intersectsStrict(n));o===-1&&(e.length>=6?o=bJ(e,Sr(a=>a.intersectWithRangeLength(n),ud)):(o=e.length,e.push(new SO))),e[o].addRange(n),i.push(o)}return new r(e.length,i)}getTrack(t){return this.trackPerLineIdx[t]}getTrackCount(){return this._trackCount}},Az=class extends lS{constructor(e,i,n,o,s){let a=wi("div.diff-hidden-lines-widget");super(e,i,a.root);this._editor=e;this._move=n;this._kind=o;this._diffModel=s;a.root.appendChild(this._nodes.root);let l=Pi(this._editor.onDidLayoutChange,()=>this._editor.getLayoutInfo());this._register(ec(this._nodes.root,{paddingRight:l.map(m=>m.verticalScrollbarWidth)}));let d;n.changes.length>0?d=this._kind==="original"?u("codeMovedToWithChanges","Code moved with changes to line {0}-{1}",this._move.lineRangeMapping.modified.startLineNumber,this._move.lineRangeMapping.modified.endLineNumberExclusive-1):u("codeMovedFromWithChanges","Code moved with changes from line {0}-{1}",this._move.lineRangeMapping.original.startLineNumber,this._move.lineRangeMapping.original.endLineNumberExclusive-1):d=this._kind==="original"?u("codeMovedTo","Code moved to line {0}-{1}",this._move.lineRangeMapping.modified.startLineNumber,this._move.lineRangeMapping.modified.endLineNumberExclusive-1):u("codeMovedFrom","Code moved from line {0}-{1}",this._move.lineRangeMapping.original.startLineNumber,this._move.lineRangeMapping.original.endLineNumberExclusive-1);let c=this._register(new Fi(this._nodes.actionBar,{highlightToggledItems:!0})),p=new et("",d,"",!1);c.push(p,{icon:!1,label:!0});let h=new et("","Compare",de.asClassName(N.compareChanges),!0,()=>{this._editor.focus(),this._diffModel.movedTextToCompare.set(this._diffModel.movedTextToCompare.get()===n?void 0:this._move,void 0)});this._register(Ft(m=>{let f=this._diffModel.movedTextToCompare.read(m)===n;h.checked=f})),c.push(h,{icon:!1,label:!0})}_nodes=wi("div.diff-moved-code-block",{style:{marginRight:"4px"}},[wi("div.text-content@textContent"),wi("div.action-bar@actionBar")])};var Oz=class extends R{constructor(e,i,n,o){super();this._editors=e;this._diffModel=i;this._options=n;this._register(MT(this._editors.original,this._decorations.map(s=>s?.originalDecorations||[]))),this._register(MT(this._editors.modified,this._decorations.map(s=>s?.modifiedDecorations||[])))}_decorations=dt(this,e=>{let i=this._diffModel.read(e),n=i?.diff.read(e);if(!n)return null;let o=this._diffModel.read(e).movedTextToCompare.read(e),s=this._options.renderIndicators.read(e),a=this._options.showEmptyDecorations.read(e),l=[],d=[];if(!o)for(let p of n.mappings)if(p.lineRangeMapping.original.isEmpty||l.push({range:p.lineRangeMapping.original.toInclusiveRange(),options:s?UQ:KQ}),p.lineRangeMapping.modified.isEmpty||d.push({range:p.lineRangeMapping.modified.toInclusiveRange(),options:s?HQ:zQ}),p.lineRangeMapping.modified.isEmpty||p.lineRangeMapping.original.isEmpty)p.lineRangeMapping.original.isEmpty||l.push({range:p.lineRangeMapping.original.toInclusiveRange(),options:kme}),p.lineRangeMapping.modified.isEmpty||d.push({range:p.lineRangeMapping.modified.toInclusiveRange(),options:_me});else{let h=this._options.useTrueInlineDiffRendering.read(e)&&rM(p.lineRangeMapping);for(let m of p.lineRangeMapping.innerChanges||[])if(p.lineRangeMapping.original.contains(m.originalRange.startLineNumber)&&l.push({range:m.originalRange,options:m.originalRange.isEmpty()&&a?Lme:oM}),p.lineRangeMapping.modified.contains(m.modifiedRange.startLineNumber)&&d.push({range:m.modifiedRange,options:m.modifiedRange.isEmpty()&&a&&!h?Dme:GQ}),h){let f=i.model.original.getValueInRange(m.originalRange);d.push({range:m.modifiedRange,options:{description:"deleted-text",before:{content:f,inlineClassName:"inline-deleted-text"},zIndex:1e5,showIfCollapsed:!0}})}}if(o)for(let p of o.changes){let h=p.original.toInclusiveRange();h&&l.push({range:h,options:s?UQ:KQ});let m=p.modified.toInclusiveRange();m&&d.push({range:m,options:s?HQ:zQ});for(let f of p.innerChanges||[])l.push({range:f.originalRange,options:oM}),d.push({range:f.modifiedRange,options:GQ})}let c=this._diffModel.read(e).activeMovedText.read(e);for(let p of n.movedTexts)l.push({range:p.lineRangeMapping.original.toInclusiveRange(),options:{description:"moved",blockClassName:"movedOriginal"+(p===c?" currentMove":""),blockPadding:[Ev.movedCodeBlockPadding,0,Ev.movedCodeBlockPadding,Ev.movedCodeBlockPadding]}}),d.push({range:p.lineRangeMapping.modified.toInclusiveRange(),options:{description:"moved",blockClassName:"movedModified"+(p===c?" currentMove":""),blockPadding:[4,0,4,4]}});return{originalDecorations:l,modifiedDecorations:d}})};var Nz=class{constructor(t,e){this._options=t;this.dimensions=e}sashLeft=kS(this,t=>{let e=this._sashRatio.read(t)??this._options.splitViewDefaultRatio.read(t);return this._computeSashLeft(e,t)},(t,e)=>{let i=this.dimensions.width.get();this._sashRatio.set(t/i,e)});_sashRatio=Ht(this,void 0);resetSash(){this._sashRatio.set(void 0,void 0)}_computeSashLeft(t,e){let i=this.dimensions.width.read(e),n=Math.floor(this._options.splitViewDefaultRatio.read(e)*i),o=this._options.enableSplitViewResizing.read(e)?Math.floor(t*i):n,s=100;return i<=s*2?n:o<s?s:o>i-s?i-s:o}},UT=class extends R{constructor(e,i,n,o,s,a){super();this._domNode=e;this._dimensions=i;this._enabled=n;this._boundarySashes=o;this.sashLeft=s;this._resetSash=a;this._register(this._sash.onDidStart(()=>{this._startSashPosition=this.sashLeft.get()})),this._register(this._sash.onDidChange(l=>{this.sashLeft.set(this._startSashPosition+(l.currentX-l.startX),void 0)})),this._register(this._sash.onDidEnd(()=>this._sash.layout())),this._register(this._sash.onDidReset(()=>this._resetSash())),this._register(Ft(l=>{let d=this._boundarySashes.read(l);d&&(this._sash.orthogonalEndSash=d.bottom)})),this._register(Ft(l=>{let d=this._enabled.read(l);this._sash.state=d?3:0,this.sashLeft.read(l),this._dimensions.height.read(l),this._sash.layout()}))}_sash=this._register(new xl(this._domNode,{getVerticalSashTop:e=>0,getVerticalSashLeft:e=>this.sashLeft.get(),getVerticalSashHeight:e=>this._dimensions.height.get()},{orientation:0}));_startSashPosition=void 0};var Fz=class extends R{constructor(e,i,n){super();this._editor=e;this._domNode=i;this.itemProvider=n;this._domNode.className="gutter monaco-editor";let o=this._domNode.appendChild(wi("div.scroll-decoration",{role:"presentation",ariaHidden:"true",style:{width:"100%"}}).root),s=new ResizeObserver(()=>{nn(a=>{this.domNodeSizeChanged.trigger(a)})});s.observe(this._domNode),this._register(le(()=>s.disconnect())),this._register(Ft(a=>{o.className=this.isScrollTopZero.read(a)?"":"scroll-decoration"})),this._register(Ft(a=>this.render(a)))}scrollTop=Pi(this,this._editor.onDidScrollChange,e=>this._editor.getScrollTop());isScrollTopZero=this.scrollTop.map(e=>e===0);modelAttached=Pi(this,this._editor.onDidChangeModel,e=>this._editor.hasModel());editorOnDidChangeViewZones=hs("onDidChangeViewZones",this._editor.onDidChangeViewZones);editorOnDidContentSizeChange=hs("onDidContentSizeChange",this._editor.onDidContentSizeChange);domNodeSizeChanged=Ip("domNodeSizeChanged");dispose(){super.dispose(),bo(this._domNode)}views=new Map;render(e){if(!this.modelAttached.read(e))return;this.domNodeSizeChanged.read(e),this.editorOnDidChangeViewZones.read(e),this.editorOnDidContentSizeChange.read(e);let i=this.scrollTop.read(e),n=this._editor.getVisibleRanges(),o=new Set(this.views.keys()),s=Qe.ofStartAndLength(0,this._domNode.clientHeight);if(!s.isEmpty)for(let a of n){let l=new ht(a.startLineNumber,a.endLineNumber+1),d=this.itemProvider.getIntersectingGutterItems(l,e);nn(c=>{for(let p of d){if(!p.range.intersect(l))continue;o.delete(p.id);let h=this.views.get(p.id);if(h)h.item.set(p,c);else{let v=document.createElement("div");this._domNode.appendChild(v);let I=Ht("item",p),y=this.itemProvider.createView(I,v);h=new ZQ(I,y,v),this.views.set(p.id,h)}let m=p.range.startLineNumber<=this._editor.getModel().getLineCount()?this._editor.getTopForLineNumber(p.range.startLineNumber,!0)-i:this._editor.getBottomForLineNumber(p.range.startLineNumber-1,!1)-i,g=(p.range.endLineNumberExclusive===1?Math.max(m,this._editor.getTopForLineNumber(p.range.startLineNumber,!1)-i):Math.max(m,this._editor.getBottomForLineNumber(p.range.endLineNumberExclusive-1,!0)-i))-m;h.domNode.style.top=`${m}px`,h.domNode.style.height=`${g}px`,h.gutterItemView.layout(Qe.ofStartAndLength(m,g),s)}})}for(let a of o){let l=this.views.get(a);l.gutterItemView.dispose(),l.domNode.remove(),this.views.delete(a)}}},ZQ=class{constructor(t,e,i){this.item=t;this.gutterItemView=e;this.domNode=i}};var Bz=class extends jo{constructor(e){super();this._getContext=e}runAction(e,i){let n=this._getContext();return super.runAction(e,n)}};var uM=class extends MD{constructor(e){super();this._textModel=e}getValueOfRange(e){return this._textModel.getValueInRange(e)}get length(){let e=this._textModel.getLineCount(),i=this._textModel.getLineLength(e);return new pr(e-1,i)}};var JQ=[],Vz=35,zT=class extends R{constructor(e,i,n,o,s,a,l,d,c){super();this._diffModel=i;this._editors=n;this._options=o;this._sashLayout=s;this._boundarySashes=a;this._instantiationService=l;this._contextKeyService=d;this._menuService=c;this._register(hme(e,this.elements.root)),this._register(F(this.elements.root,"click",()=>{this._editors.modified.focus()})),this._register(ec(this.elements.root,{display:this._hasActions.map(h=>h?"block":"none")})),pd(this,h=>this._showSash.read(h)?new UT(e,this._sashLayout.dimensions,this._options.enableSplitViewResizing,this._boundarySashes,kS(this,f=>this._sashLayout.sashLeft.read(f)-Vz,(f,g)=>this._sashLayout.sashLeft.set(f+Vz,g)),()=>this._sashLayout.resetSash()):void 0).recomputeInitiallyAndOnChange(this._store);let p=dt(this,h=>{let m=this._diffModel.read(h);if(!m)return[];let f=m.diff.read(h);if(!f)return[];let g=this._selectedDiffs.read(h);if(g.length>0){let I=Ll.fromRangeMappings(g.flatMap(y=>y.rangeMappings));return[new Wz(I,!0,V.DiffEditorSelectionToolbar,void 0,m.model.original.uri,m.model.modified.uri)]}let v=this._currentDiff.read(h);return f.mappings.map(I=>new Wz(I.lineRangeMapping.withInnerChangesFromLineRanges(),I.lineRangeMapping===v?.lineRangeMapping,V.DiffEditorHunkToolbar,void 0,m.model.original.uri,m.model.modified.uri))});this._register(new Fz(this._editors.modified,this.elements.root,{getIntersectingGutterItems:(h,m)=>p.read(m),createView:(h,m)=>this._instantiationService.createInstance(pM,h,m,this)})),this._register(F(this.elements.gutter,Q.MOUSE_WHEEL,h=>{this._editors.modified.getOption(105).handleMouseWheel&&this._editors.modified.delegateScrollFromMouseWheelEvent(h)},{passive:!1}))}_menu=this._register(this._menuService.createMenu(V.DiffEditorHunkToolbar,this._contextKeyService));_actions=Pi(this,this._menu.onDidChange,()=>this._menu.getActions());_hasActions=this._actions.map(e=>e.length>0);_showSash=dt(this,e=>this._options.renderSideBySide.read(e)&&this._hasActions.read(e));width=dt(this,e=>this._hasActions.read(e)?Vz:0);elements=wi("div.gutter@gutter",{style:{position:"absolute",height:"100%",width:Vz+"px"}},[]);computeStagedValue(e){let i=e.innerChanges??[],n=new uM(this._editors.modifiedModel.get()),o=new uM(this._editors.original.getModel());return new lu(i.map(l=>l.toTextEdit(n))).apply(o)}_currentDiff=dt(this,e=>{let i=this._diffModel.read(e);if(!i)return;let n=i.diff.read(e)?.mappings,o=this._editors.modifiedCursor.read(e);if(o)return n?.find(s=>s.lineRangeMapping.modified.contains(o.lineNumber))});_selectedDiffs=dt(this,e=>{let n=this._diffModel.read(e)?.diff.read(e);if(!n)return JQ;let o=this._editors.modifiedSelections.read(e);if(o.every(d=>d.isEmpty()))return JQ;let s=new Ed(o.map(d=>ht.fromRangeInclusive(d))),l=n.mappings.filter(d=>d.lineRangeMapping.innerChanges&&s.intersects(d.lineRangeMapping.modified)).map(d=>({mapping:d,rangeMappings:d.lineRangeMapping.innerChanges.filter(c=>o.some(p=>L.areIntersecting(c.modifiedRange,p)))}));return l.length===0||l.every(d=>d.rangeMappings.length===0)?JQ:l});layout(e){this.elements.gutter.style.left=e+"px"}};zT=E([b(6,ne),b(7,re),b(8,jt)],zT);var Wz=class{constructor(t,e,i,n,o,s){this.mapping=t;this.showAlways=e;this.menuId=i;this.rangeOverride=n;this.originalUri=o;this.modifiedUri=s}get id(){return this.mapping.modified.toString()}get range(){return this.rangeOverride??this.mapping.modified}},pM=class extends R{constructor(e,i,n,o){super();this._item=e;let s=this._register(o.createInstance(sh,"element",!0,{position:{hoverPosition:1}}));this._register(cS(i,this._elements.root)),this._register(Ft(a=>{let l=this._showAlways.read(a);this._elements.root.classList.toggle("noTransition",!0),this._elements.root.classList.toggle("showAlways",l),setTimeout(()=>{this._elements.root.classList.toggle("noTransition",!1)},0)})),this._register(Cr((a,l)=>{this._elements.buttons.replaceChildren();let d=l.add(o.createInstance(lh,this._elements.buttons,this._menuId.read(a),{orientation:1,hoverDelegate:s,toolbarOptions:{primaryGroup:c=>c.startsWith("primary")},overflowBehavior:{maxItems:this._isSmall.read(a)?1:3},hiddenItemStrategy:0,actionRunner:new Bz(()=>{let c=this._item.get(),p=c.mapping;return{mapping:p,originalWithModifiedChanges:n.computeStagedValue(p),originalUri:c.originalUri,modifiedUri:c.modifiedUri}}),menuOptions:{shouldForwardArgs:!0}}));l.add(d.onDidChangeMenuItems(()=>{this._lastItemRange&&this.layout(this._lastItemRange,this._lastViewRange)}))}))}_elements=wi("div.gutterItem",{style:{height:"20px",width:"34px"}},[wi("div.background@background",{},[]),wi("div.buttons@buttons",{},[])]);_showAlways=this._item.map(this,e=>e.showAlways);_menuId=this._item.map(this,e=>e.menuId);_isSmall=Ht(this,!1);_lastItemRange=void 0;_lastViewRange=void 0;layout(e,i){this._lastItemRange=e,this._lastViewRange=i;let n=this._elements.buttons.clientHeight;this._isSmall.set(this._item.get().mapping.original.startLineNumber===1&&e.length<30,void 0),n=this._elements.buttons.clientHeight;let o=e.length/2-n/2,s=n,a=e.start+o,l=Qe.tryCreate(s,i.endExclusive-s-n),d=Qe.tryCreate(e.start+s,e.endExclusive-n-s);d&&l&&d.start<d.endExclusive&&(a=l.clip(a),a=d.clip(a)),this._elements.buttons.style.top=`${a-e.start}px`}};pM=E([b(3,ne)],pM);var Ag=class extends R{constructor(e,i,n,o){super();this._editors=e;this._diffModel=i;this._options=n;this._instantiationService=o;this._register(this._editors.original.onDidChangeCursorPosition(d=>{if(d.reason===1)return;let c=this._diffModel.get();nn(p=>{for(let h of this._editors.original.getSelections()||[])c?.ensureOriginalLineIsVisible(h.getStartPosition().lineNumber,0,p),c?.ensureOriginalLineIsVisible(h.getEndPosition().lineNumber,0,p)})})),this._register(this._editors.modified.onDidChangeCursorPosition(d=>{if(d.reason===1)return;let c=this._diffModel.get();nn(p=>{for(let h of this._editors.modified.getSelections()||[])c?.ensureModifiedLineIsVisible(h.getStartPosition().lineNumber,0,p),c?.ensureModifiedLineIsVisible(h.getEndPosition().lineNumber,0,p)})}));let s=this._diffModel.map((d,c)=>{let p=d?.unchangedRegions.read(c)??[];return p.length===1&&p[0].modifiedLineNumber===1&&p[0].lineCount===this._editors.modifiedModel.read(c)?.getLineCount()?[]:p});this.viewZones=qc(this,(d,c)=>{let p=this._modifiedOutlineSource.read(d);if(!p)return{origViewZones:[],modViewZones:[]};let h=[],m=[],f=this._options.renderSideBySide.read(d),g=this._options.compactMode.read(d),v=s.read(d);for(let I=0;I<v.length;I++){let y=v[I];if(!y.shouldHideControls(d)&&!(g&&(I===0||I===v.length-1)))if(g){{let w=dt(this,S=>y.getHiddenOriginalRange(S).startLineNumber-1),C=new Yh(w,12);h.push(C),c.add(new Hz(this._editors.original,C,y,!f))}{let w=dt(this,S=>y.getHiddenModifiedRange(S).startLineNumber-1),C=new Yh(w,12);m.push(C),c.add(new Hz(this._editors.modified,C,y))}}else{{let w=dt(this,S=>y.getHiddenOriginalRange(S).startLineNumber-1),C=new Yh(w,24);h.push(C),c.add(new Uz(this._editors.original,C,y,y.originalUnchangedRange,!f,p,S=>this._diffModel.get().ensureModifiedLineIsVisible(S,2,void 0),this._options))}{let w=dt(this,S=>y.getHiddenModifiedRange(S).startLineNumber-1),C=new Yh(w,24);m.push(C),c.add(new Uz(this._editors.modified,C,y,y.modifiedUnchangedRange,!1,p,S=>this._diffModel.get().ensureModifiedLineIsVisible(S,2,void 0),this._options))}}}return{origViewZones:h,modViewZones:m}});let a={description:"unchanged lines",className:"diff-unchanged-lines",isWholeLine:!0},l={description:"Fold Unchanged",glyphMarginHoverMessage:new Sn(void 0,{isTrusted:!0,supportThemeIcons:!0}).appendMarkdown(u("foldUnchanged","Fold Unchanged Region")),glyphMarginClassName:"fold-unchanged "+de.asClassName(N.fold),zIndex:10001};this._register(MT(this._editors.original,dt(this,d=>{let c=s.read(d),p=c.map(h=>({range:h.originalUnchangedRange.toInclusiveRange(),options:a}));for(let h of c)h.shouldHideControls(d)&&p.push({range:L.fromPositions(new H(h.originalLineNumber,1)),options:l});return p}))),this._register(MT(this._editors.modified,dt(this,d=>{let c=s.read(d),p=c.map(h=>({range:h.modifiedUnchangedRange.toInclusiveRange(),options:a}));for(let h of c)h.shouldHideControls(d)&&p.push({range:ht.ofLength(h.modifiedLineNumber,1).toInclusiveRange(),options:l});return p}))),this._register(Ft(d=>{let c=s.read(d);this._isUpdatingHiddenAreas=!0;try{this._editors.original.setHiddenAreas(c.map(p=>p.getHiddenOriginalRange(d).toInclusiveRange()).filter(go)),this._editors.modified.setHiddenAreas(c.map(p=>p.getHiddenModifiedRange(d).toInclusiveRange()).filter(go))}finally{this._isUpdatingHiddenAreas=!1}})),this._register(this._editors.modified.onMouseUp(d=>{if(!d.event.rightButton&&d.target.position&&d.target.element?.className.includes("fold-unchanged")){let c=d.target.position.lineNumber,p=this._diffModel.get();if(!p)return;let h=p.unchangedRegions.get().find(m=>m.modifiedUnchangedRange.includes(c));if(!h)return;h.collapseAll(void 0),d.event.stopPropagation(),d.event.preventDefault()}})),this._register(this._editors.original.onMouseUp(d=>{if(!d.event.rightButton&&d.target.position&&d.target.element?.className.includes("fold-unchanged")){let c=d.target.position.lineNumber,p=this._diffModel.get();if(!p)return;let h=p.unchangedRegions.get().find(m=>m.originalUnchangedRange.includes(c));if(!h)return;h.collapseAll(void 0),d.event.stopPropagation(),d.event.preventDefault()}}))}static _breadcrumbsSourceFactory=Ht(Ag,()=>({dispose(){},getBreadcrumbItems(e,i){return[]}}));static setBreadcrumbsSourceFactory(e){this._breadcrumbsSourceFactory.set(e,void 0)}_modifiedOutlineSource=pd(this,e=>{let i=this._editors.modifiedModel.read(e),n=Ag._breadcrumbsSourceFactory.read(e);return!i||!n?void 0:n(i,this._instantiationService)});viewZones;_isUpdatingHiddenAreas=!1;get isUpdatingHiddenAreas(){return this._isUpdatingHiddenAreas}};Ag=E([b(3,ne)],Ag);var Hz=class extends lS{constructor(e,i,n,o=!1){let s=wi("div.diff-hidden-lines-widget");super(e,i,s.root);this._unchangedRegion=n;this._hide=o;s.root.appendChild(this._nodes.root),this._hide&&this._nodes.root.replaceChildren(),this._register(Ft(a=>{if(!this._hide){let l=this._unchangedRegion.getHiddenModifiedRange(a).length,d=u("hiddenLines","{0} hidden lines",l);this._nodes.text.innerText=d}}))}_nodes=wi("div.diff-hidden-lines-compact",[wi("div.line-left",[]),wi("div.text@text",[]),wi("div.line-right",[])])},Uz=class extends lS{constructor(e,i,n,o,s,a,l,d){let c=wi("div.diff-hidden-lines-widget");super(e,i,c.root);this._editor=e;this._unchangedRegion=n;this._unchangedRegionRange=o;this._hide=s;this._modifiedOutlineSource=a;this._revealModifiedHiddenLine=l;this._options=d;c.root.appendChild(this._nodes.root),this._hide?bo(this._nodes.first):this._register(ec(this._nodes.first,{width:uS(this._editor).layoutInfoContentLeft})),this._register(Ft(h=>{let m=this._unchangedRegion.visibleLineCountTop.read(h)+this._unchangedRegion.visibleLineCountBottom.read(h)===this._unchangedRegion.lineCount;this._nodes.bottom.classList.toggle("canMoveTop",!m),this._nodes.bottom.classList.toggle("canMoveBottom",this._unchangedRegion.visibleLineCountBottom.read(h)>0),this._nodes.top.classList.toggle("canMoveTop",this._unchangedRegion.visibleLineCountTop.read(h)>0),this._nodes.top.classList.toggle("canMoveBottom",!m);let f=this._unchangedRegion.isDragged.read(h),g=this._editor.getDomNode();g&&(g.classList.toggle("draggingUnchangedRegion",!!f),f==="top"?(g.classList.toggle("canMoveTop",this._unchangedRegion.visibleLineCountTop.read(h)>0),g.classList.toggle("canMoveBottom",!m)):f==="bottom"?(g.classList.toggle("canMoveTop",!m),g.classList.toggle("canMoveBottom",this._unchangedRegion.visibleLineCountBottom.read(h)>0)):(g.classList.toggle("canMoveTop",!1),g.classList.toggle("canMoveBottom",!1)))}));let p=this._editor;this._register(F(this._nodes.top,"mousedown",h=>{if(h.button!==0)return;this._nodes.top.classList.toggle("dragging",!0),this._nodes.root.classList.toggle("dragging",!0),h.preventDefault();let m=h.clientY,f=!1,g=this._unchangedRegion.visibleLineCountTop.get();this._unchangedRegion.isDragged.set("top",void 0);let v=ue(this._nodes.top),I=F(v,"mousemove",w=>{let S=w.clientY-m;f=f||Math.abs(S)>2;let D=Math.round(S/p.getOption(68)),k=Math.max(0,Math.min(g+D,this._unchangedRegion.getMaxVisibleLineCountTop()));this._unchangedRegion.visibleLineCountTop.set(k,void 0)}),y=F(v,"mouseup",w=>{f||this._unchangedRegion.showMoreAbove(this._options.hideUnchangedRegionsRevealLineCount.get(),void 0),this._nodes.top.classList.toggle("dragging",!1),this._nodes.root.classList.toggle("dragging",!1),this._unchangedRegion.isDragged.set(void 0,void 0),I.dispose(),y.dispose()})})),this._register(F(this._nodes.bottom,"mousedown",h=>{if(h.button!==0)return;this._nodes.bottom.classList.toggle("dragging",!0),this._nodes.root.classList.toggle("dragging",!0),h.preventDefault();let m=h.clientY,f=!1,g=this._unchangedRegion.visibleLineCountBottom.get();this._unchangedRegion.isDragged.set("bottom",void 0);let v=ue(this._nodes.bottom),I=F(v,"mousemove",w=>{let S=w.clientY-m;f=f||Math.abs(S)>2;let D=Math.round(S/p.getOption(68)),k=Math.max(0,Math.min(g-D,this._unchangedRegion.getMaxVisibleLineCountBottom())),M=this._unchangedRegionRange.endLineNumberExclusive>p.getModel().getLineCount()?p.getContentHeight():p.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);this._unchangedRegion.visibleLineCountBottom.set(k,void 0);let O=this._unchangedRegionRange.endLineNumberExclusive>p.getModel().getLineCount()?p.getContentHeight():p.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);p.setScrollTop(p.getScrollTop()+(O-M))}),y=F(v,"mouseup",w=>{if(this._unchangedRegion.isDragged.set(void 0,void 0),!f){let C=p.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);this._unchangedRegion.showMoreBelow(this._options.hideUnchangedRegionsRevealLineCount.get(),void 0);let S=p.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);p.setScrollTop(p.getScrollTop()+(S-C))}this._nodes.bottom.classList.toggle("dragging",!1),this._nodes.root.classList.toggle("dragging",!1),I.dispose(),y.dispose()})})),this._register(Ft(h=>{let m=[];if(!this._hide){let f=n.getHiddenModifiedRange(h).length,g=u("hiddenLines","{0} hidden lines",f),v=J("span",{title:u("diff.hiddenLines.expandAll","Double click to unfold")},g);v.addEventListener("dblclick",w=>{w.button===0&&(w.preventDefault(),this._unchangedRegion.showAll(void 0))}),m.push(v);let I=this._unchangedRegion.getHiddenModifiedRange(h),y=this._modifiedOutlineSource.getBreadcrumbItems(I,h);if(y.length>0){m.push(J("span",void 0,"\xA0\xA0|\xA0\xA0"));for(let w=0;w<y.length;w++){let C=y[w],S=HG.toIcon(C.kind),D=wi("div.breadcrumb-item",{style:{display:"flex",alignItems:"center"}},[Eu(S),"\xA0",C.name,...w===y.length-1?[]:[Eu(N.chevronRight)]]).root;m.push(D),D.onclick=()=>{this._revealModifiedHiddenLine(C.startLineNumber)}}}}bo(this._nodes.others,...m)}))}_nodes=wi("div.diff-hidden-lines",[wi("div.top@top",{title:u("diff.hiddenLines.top","Click or drag to show more above")}),wi("div.center@content",{style:{display:"flex"}},[wi("div@first",{style:{display:"flex",justifyContent:"center",alignItems:"center",flexShrink:"0"}},[J("a",{title:u("showUnchangedRegion","Show Unchanged Region"),role:"button",onclick:()=>{this._unchangedRegion.showAll(void 0)}},...zl("$(unfold)"))]),wi("div@others",{style:{display:"flex",justifyContent:"center",alignItems:"center"}})]),wi("div.bottom@bottom",{title:u("diff.bottom","Click or drag to show more below"),role:"button"})])};var eZ=[],zz=class extends R{constructor(e,i,n,o){super();this._editors=e;this._diffModel=i;this._options=n;this._widget=o;this._register(Cr((s,a)=>{if(!this._options.shouldRenderOldRevertArrows.read(s))return;let l=this._diffModel.read(s),d=l?.diff.read(s);if(!l||!d||l.movedTextToCompare.read(s))return;let c=[],p=this._selectedDiffs.read(s),h=new Set(p.map(m=>m.mapping));if(p.length>0){let m=this._editors.modifiedSelections.read(s),f=a.add(new Kz(m[m.length-1].positionLineNumber,this._widget,p.flatMap(g=>g.rangeMappings),!0));this._editors.modified.addGlyphMarginWidget(f),c.push(f)}for(let m of d.mappings)if(!h.has(m)&&!m.lineRangeMapping.modified.isEmpty&&m.lineRangeMapping.innerChanges){let f=a.add(new Kz(m.lineRangeMapping.modified.startLineNumber,this._widget,m.lineRangeMapping,!1));this._editors.modified.addGlyphMarginWidget(f),c.push(f)}a.add(le(()=>{for(let m of c)this._editors.modified.removeGlyphMarginWidget(m)}))}))}_selectedDiffs=dt(this,e=>{let n=this._diffModel.read(e)?.diff.read(e);if(!n)return eZ;let o=this._editors.modifiedSelections.read(e);if(o.every(d=>d.isEmpty()))return eZ;let s=new Ed(o.map(d=>ht.fromRangeInclusive(d))),l=n.mappings.filter(d=>d.lineRangeMapping.innerChanges&&s.intersects(d.lineRangeMapping.modified)).map(d=>({mapping:d,rangeMappings:d.lineRangeMapping.innerChanges.filter(c=>o.some(p=>L.areIntersecting(c.modifiedRange,p)))}));return l.length===0||l.every(d=>d.rangeMappings.length===0)?eZ:l})},Kz=class r extends R{constructor(e,i,n,o){super();this._lineNumber=e;this._widget=i;this._diffs=n;this._revertSelection=o;this._register(F(this._domNode,Q.MOUSE_DOWN,s=>{s.button!==2&&(s.stopPropagation(),s.preventDefault())})),this._register(F(this._domNode,Q.MOUSE_UP,s=>{s.stopPropagation(),s.preventDefault()})),this._register(F(this._domNode,Q.CLICK,s=>{this._diffs instanceof Ws?this._widget.revert(this._diffs):this._widget.revertRangeMappings(this._diffs),s.stopPropagation(),s.preventDefault()}))}static counter=0;_id=`revertButton${r.counter++}`;getId(){return this._id}_domNode=wi("div.revertButton",{title:this._revertSelection?u("revertSelectedChanges","Revert Selected Changes"):u("revertChange","Revert Change")},[Eu(N.arrowRight)]).root;getDomNode(){return this._domNode}getPosition(){return{lane:3,range:{startColumn:1,startLineNumber:this._lineNumber,endColumn:1,endLineNumber:this._lineNumber},zIndex:10001}}};var Gz=class r extends R{static idCounter=0;_id=++r.idCounter;_onDidDispose=this._register(new x);onDidDispose=this._onDidDispose.event;getId(){return this.getEditorType()+":v2:"+this._id}getVisibleColumnFromPosition(t){return this._targetEditor.getVisibleColumnFromPosition(t)}getStatusbarColumn(t){return this._targetEditor.getStatusbarColumn(t)}getPosition(){return this._targetEditor.getPosition()}setPosition(t,e="api"){this._targetEditor.setPosition(t,e)}revealLine(t,e=0){this._targetEditor.revealLine(t,e)}revealLineInCenter(t,e=0){this._targetEditor.revealLineInCenter(t,e)}revealLineInCenterIfOutsideViewport(t,e=0){this._targetEditor.revealLineInCenterIfOutsideViewport(t,e)}revealLineNearTop(t,e=0){this._targetEditor.revealLineNearTop(t,e)}revealPosition(t,e=0){this._targetEditor.revealPosition(t,e)}revealPositionInCenter(t,e=0){this._targetEditor.revealPositionInCenter(t,e)}revealPositionInCenterIfOutsideViewport(t,e=0){this._targetEditor.revealPositionInCenterIfOutsideViewport(t,e)}revealPositionNearTop(t,e=0){this._targetEditor.revealPositionNearTop(t,e)}getSelection(){return this._targetEditor.getSelection()}getSelections(){return this._targetEditor.getSelections()}setSelection(t,e="api"){this._targetEditor.setSelection(t,e)}setSelections(t,e="api"){this._targetEditor.setSelections(t,e)}revealLines(t,e,i=0){this._targetEditor.revealLines(t,e,i)}revealLinesInCenter(t,e,i=0){this._targetEditor.revealLinesInCenter(t,e,i)}revealLinesInCenterIfOutsideViewport(t,e,i=0){this._targetEditor.revealLinesInCenterIfOutsideViewport(t,e,i)}revealLinesNearTop(t,e,i=0){this._targetEditor.revealLinesNearTop(t,e,i)}revealRange(t,e=0,i=!1,n=!0){this._targetEditor.revealRange(t,e,i,n)}revealRangeInCenter(t,e=0){this._targetEditor.revealRangeInCenter(t,e)}revealRangeInCenterIfOutsideViewport(t,e=0){this._targetEditor.revealRangeInCenterIfOutsideViewport(t,e)}revealRangeNearTop(t,e=0){this._targetEditor.revealRangeNearTop(t,e)}revealRangeNearTopIfOutsideViewport(t,e=0){this._targetEditor.revealRangeNearTopIfOutsideViewport(t,e)}revealRangeAtTop(t,e=0){this._targetEditor.revealRangeAtTop(t,e)}getSupportedActions(){return this._targetEditor.getSupportedActions()}focus(){this._targetEditor.focus()}trigger(t,e,i){this._targetEditor.trigger(t,e,i)}createDecorationsCollection(t){return this._targetEditor.createDecorationsCollection(t)}changeDecorations(t){return this._targetEditor.changeDecorations(t)}};var pS=class extends Gz{constructor(e,i,n,o,s,a,l,d){super();this._domElement=e;this._parentContextKeyService=o;this._parentInstantiationService=s;this._accessibilitySignalService=l;this._editorProgressService=d;a.willCreateDiffEditor(),this._contextKeyService.createKey("isInDiffEditor",!0),this._domElement.appendChild(this.elements.root),this._register(le(()=>this.elements.root.remove())),this._rootSizeObserver=this._register(new wz(this.elements.root,i.dimension)),this._rootSizeObserver.setAutomaticLayout(i.automaticLayout??!1),this._options=this._instantiationService.createInstance(BT,i),this._register(Ft(S=>{this._options.setWidth(this._rootSizeObserver.width.read(S))})),this._contextKeyService.createKey(ce.isEmbeddedDiffEditor.key,!1),this._register(Uh(ce.isEmbeddedDiffEditor,this._contextKeyService,S=>this._options.isInEmbeddedEditor.read(S))),this._register(Uh(ce.comparingMovedCode,this._contextKeyService,S=>!!this._diffModel.read(S)?.movedTextToCompare.read(S))),this._register(Uh(ce.diffEditorRenderSideBySideInlineBreakpointReached,this._contextKeyService,S=>this._options.couldShowInlineViewBecauseOfSize.read(S))),this._register(Uh(ce.diffEditorInlineMode,this._contextKeyService,S=>!this._options.renderSideBySide.read(S))),this._register(Uh(ce.hasChanges,this._contextKeyService,S=>(this._diffModel.read(S)?.diff.read(S)?.mappings.length??0)>0)),this._editors=this._register(this._instantiationService.createInstance(HT,this.elements.original,this.elements.modified,this._options,n,(S,D,k,M)=>this._createInnerEditor(S,D,k,M))),this._register(Uh(ce.diffEditorOriginalWritable,this._contextKeyService,S=>this._options.originalEditable.read(S))),this._register(Uh(ce.diffEditorModifiedWritable,this._contextKeyService,S=>!this._options.readOnly.read(S))),this._register(Uh(ce.diffEditorOriginalUri,this._contextKeyService,S=>this._diffModel.read(S)?.model.original.uri.toString()??"")),this._register(Uh(ce.diffEditorModifiedUri,this._contextKeyService,S=>this._diffModel.read(S)?.model.modified.uri.toString()??"")),this._overviewRulerPart=pd(this,S=>this._options.renderOverviewRuler.read(S)?this._instantiationService.createInstance(Fc(as,S),this._editors,this.elements.root,this._diffModel,this._rootSizeObserver.width,this._rootSizeObserver.height,this._layoutInfo.map(D=>D.modifiedEditor)):void 0).recomputeInitiallyAndOnChange(this._store);let c={height:this._rootSizeObserver.height,width:this._rootSizeObserver.width.map((S,D)=>S-(this._overviewRulerPart.read(D)?.width??0))};this._sashLayout=new Nz(this._options,c),this._sash=pd(this,S=>{let D=this._options.renderSideBySide.read(S);return this.elements.root.classList.toggle("side-by-side",D),D?new UT(this.elements.root,c,this._options.enableSplitViewResizing,this._boundarySashes,this._sashLayout.sashLeft,()=>this._sashLayout.resetSash()):void 0}).recomputeInitiallyAndOnChange(this._store);let p=pd(this,S=>this._instantiationService.createInstance(Fc(Ag,S),this._editors,this._diffModel,this._options)).recomputeInitiallyAndOnChange(this._store);pd(this,S=>this._instantiationService.createInstance(Fc(Oz,S),this._editors,this._diffModel,this._options,this)).recomputeInitiallyAndOnChange(this._store);let h=new Set,m=new Set,f=!1,g=pd(this,S=>this._instantiationService.createInstance(Fc(FT,S),ue(this._domElement),this._editors,this._diffModel,this._options,this,()=>f||p.get().isUpdatingHiddenAreas,h,m)).recomputeInitiallyAndOnChange(this._store),v=dt(this,S=>{let D=g.read(S).viewZones.read(S).orig,k=p.read(S).viewZones.read(S).origViewZones;return D.concat(k)}),I=dt(this,S=>{let D=g.read(S).viewZones.read(S).mod,k=p.read(S).viewZones.read(S).modViewZones;return D.concat(k)});this._register(AT(this._editors.original,v,S=>{f=S},h));let y;this._register(AT(this._editors.modified,I,S=>{f=S,f?y=mg.capture(this._editors.modified):(y?.restore(this._editors.modified),y=void 0)},m)),this._accessibleDiffViewer=pd(this,S=>this._instantiationService.createInstance(Fc(Jh,S),this.elements.accessibleDiffViewer,this._accessibleDiffViewerVisible,(D,k)=>this._accessibleDiffViewerShouldBeVisible.set(D,k),this._options.onlyShowAccessibleDiffViewer.map(D=>!D),this._rootSizeObserver.width,this._rootSizeObserver.height,this._diffModel.map((D,k)=>D?.diff.read(k)?.mappings.map(M=>M.lineRangeMapping)),new Mz(this._editors))).recomputeInitiallyAndOnChange(this._store);let w=this._accessibleDiffViewerVisible.map(S=>S?"hidden":"visible");this._register(ec(this.elements.modified,{visibility:w})),this._register(ec(this.elements.original,{visibility:w})),this._createDiffEditorContributions(),a.addDiffEditor(this),this._gutter=pd(this,S=>this._options.shouldRenderGutterMenu.read(S)?this._instantiationService.createInstance(Fc(zT,S),this.elements.root,this._diffModel,this._editors,this._options,this._sashLayout,this._boundarySashes):void 0),this._register($g(this._layoutInfo)),pd(this,S=>new(Fc(Ev,S))(this.elements.root,this._diffModel,this._layoutInfo.map(D=>D.originalEditor),this._layoutInfo.map(D=>D.modifiedEditor),this._editors)).recomputeInitiallyAndOnChange(this._store,S=>{this._movedBlocksLinesPart.set(S,void 0)}),this._register(X.runAndSubscribe(this._editors.modified.onDidChangeCursorPosition,S=>this._handleCursorPositionChange(S,!0))),this._register(X.runAndSubscribe(this._editors.original.onDidChangeCursorPosition,S=>this._handleCursorPositionChange(S,!1)));let C=this._diffModel.map(this,(S,D)=>{if(S)return S.diff.read(D)===void 0&&!S.isDiffUpToDate.read(D)});this._register(Cr((S,D)=>{if(C.read(S)===!0){let k=this._editorProgressService.show(!0,1e3);D.add(le(()=>k.done()))}})),this._register(Cr((S,D)=>{D.add(new(Fc(zz,S))(this._editors,this._diffModel,this._options,this))})),this._register(Cr((S,D)=>{let k=this._diffModel.read(S);if(k)for(let M of[k.model.original,k.model.modified])D.add(M.onWillDispose(O=>{Xe(new _t("TextModel got disposed before DiffEditorWidget model got reset")),this.setModel(null)}))})),this._register(Ft(S=>{this._options.setModel(this._diffModel.read(S))}))}static ENTIRE_DIFF_OVERVIEW_WIDTH=as.ENTIRE_DIFF_OVERVIEW_WIDTH;elements=wi("div.monaco-diff-editor.side-by-side",{style:{position:"relative",height:"100%"}},[wi("div.editor.original@original",{style:{position:"absolute",height:"100%"}}),wi("div.editor.modified@modified",{style:{position:"absolute",height:"100%"}}),wi("div.accessibleDiffViewer@accessibleDiffViewer",{style:{position:"absolute",height:"100%"}})]);_diffModelSrc=this._register(PS(this,void 0));_diffModel=dt(this,e=>this._diffModelSrc.read(e)?.object);onDidChangeModel=X.fromObservableLight(this._diffModel);get onDidContentSizeChange(){return this._editors.onDidContentSizeChange}_contextKeyService=this._register(this._parentContextKeyService.createScoped(this._domElement));_instantiationService=this._register(this._parentInstantiationService.createChild(new el([re,this._contextKeyService])));_rootSizeObserver;_sashLayout;_sash;_boundarySashes=Ht(this,void 0);_accessibleDiffViewerShouldBeVisible=Ht(this,!1);_accessibleDiffViewerVisible=dt(this,e=>this._options.onlyShowAccessibleDiffViewer.read(e)?!0:this._accessibleDiffViewerShouldBeVisible.read(e));_accessibleDiffViewer;_options;_editors;_overviewRulerPart;_movedBlocksLinesPart=Ht(this,void 0);_gutter;get collapseUnchangedRegions(){return this._options.hideUnchangedRegions.get()}getViewWidth(){return this._rootSizeObserver.width.get()}getContentHeight(){return this._editors.modified.getContentHeight()}_createInnerEditor(e,i,n,o){return e.createInstance($s,i,n,o)}_layoutInfo=dt(this,e=>{let i=this._rootSizeObserver.width.read(e),n=this._rootSizeObserver.height.read(e);this._rootSizeObserver.automaticLayout?this.elements.root.style.height="100%":this.elements.root.style.height=n+"px";let o=this._sash.read(e),s=this._gutter.read(e),a=s?.width.read(e)??0,l=this._overviewRulerPart.read(e)?.width??0,d,c,p,h,m;if(!!o){let g=o.sashLeft.read(e),v=this._movedBlocksLinesPart.read(e)?.width.read(e)??0;d=0,c=g-a-v,m=g-a,p=g,h=i-p-l}else{m=0;let g=this._options.inlineViewHideOriginalLineNumbers.read(e);d=a,g?c=0:c=Math.max(5,this._editors.originalObs.layoutInfoDecorationsLeft.read(e)),p=a+c,h=i-p-l}return this.elements.original.style.left=d+"px",this.elements.original.style.width=c+"px",this._editors.original.layout({width:c,height:n},!0),s?.layout(m),this.elements.modified.style.left=p+"px",this.elements.modified.style.width=h+"px",this._editors.modified.layout({width:h,height:n},!0),{modifiedEditor:this._editors.modified.getLayoutInfo(),originalEditor:this._editors.original.getLayoutInfo()}});_createDiffEditorContributions(){let e=Fm.getDiffEditorContributions();for(let i of e)try{this._register(this._instantiationService.createInstance(i.ctor,this))}catch(n){Xe(n)}}get _targetEditor(){return this._editors.modified}getEditorType(){return CI.IDiffEditor}onVisible(){this._editors.original.onVisible(),this._editors.modified.onVisible()}onHide(){this._editors.original.onHide(),this._editors.modified.onHide()}layout(e){this._rootSizeObserver.observe(e)}hasTextFocus(){return this._editors.original.hasTextFocus()||this._editors.modified.hasTextFocus()}saveViewState(){let e=this._editors.original.saveViewState(),i=this._editors.modified.saveViewState();return{original:e,modified:i,modelState:this._diffModel.get()?.serializeState()}}restoreViewState(e){if(e&&e.original&&e.modified){let i=e;this._editors.original.restoreViewState(i.original),this._editors.modified.restoreViewState(i.modified),i.modelState&&this._diffModel.get()?.restoreSerializedState(i.modelState)}}handleInitialized(){this._editors.original.handleInitialized(),this._editors.modified.handleInitialized()}createViewModel(e){return this._instantiationService.createInstance(VT,e,this._options)}getModel(){return this._diffModel.get()?.model??null}setModel(e){let i=e?"model"in e?dS.create(e).createNewRef(this):dS.create(this.createViewModel(e),this):null;this.setDiffModel(i)}setDiffModel(e,i){let n=this._diffModel.get();!e&&n&&this._accessibleDiffViewer.get().close(),this._diffModel.get()!==e?.object&&yp(i,o=>{let s=e?.object;Pi.batchEventsGlobally(o,()=>{this._editors.original.setModel(s?s.model.original:null),this._editors.modified.setModel(s?s.model.modified:null)});let a=this._diffModelSrc.get()?.createNewRef(this);this._diffModelSrc.set(e?.createNewRef(this),o),setTimeout(()=>{a?.dispose()},0)})}updateOptions(e){this._options.updateOptions(e)}getContainerDomNode(){return this._domElement}getOriginalEditor(){return this._editors.original}getModifiedEditor(){return this._editors.modified}setBoundarySashes(e){this._boundarySashes.set(e,void 0)}_diffValue=this._diffModel.map((e,i)=>e?.diff.read(i));onDidUpdateDiff=X.fromObservableLight(this._diffValue);get ignoreTrimWhitespace(){return this._options.ignoreTrimWhitespace.get()}get maxComputationTime(){return this._options.maxComputationTimeMs.get()}get renderSideBySide(){return this._options.renderSideBySide.get()}getLineChanges(){let e=this._diffModel.get()?.diff.get();return e?ake(e):null}getDiffComputationResult(){let e=this._diffModel.get()?.diff.get();return e?{changes:this.getLineChanges(),changes2:e.mappings.map(i=>i.lineRangeMapping),identical:e.identical,quitEarly:e.quitEarly}:null}revert(e){let i=this._diffModel.get();!i||!i.isDiffUpToDate.get()||this._editors.modified.executeEdits("diffEditor",[{range:e.modified.toExclusiveRange(),text:i.model.original.getValueInRange(e.original.toExclusiveRange())}])}revertRangeMappings(e){let i=this._diffModel.get();if(!i||!i.isDiffUpToDate.get())return;let n=e.map(o=>({range:o.modifiedRange,text:i.model.original.getValueInRange(o.originalRange)}));this._editors.modified.executeEdits("diffEditor",n)}_goTo(e){this._editors.modified.setPosition(new H(e.lineRangeMapping.modified.startLineNumber,1)),this._editors.modified.revealRangeInCenter(e.lineRangeMapping.modified.toExclusiveRange())}goToDiff(e){let i=this._diffModel.get()?.diff.get()?.mappings;if(!i||i.length===0)return;let n=this._editors.modified.getPosition().lineNumber,o;e==="next"?o=i.find(s=>s.lineRangeMapping.modified.startLineNumber>n)??i[0]:o=lm(i,s=>s.lineRangeMapping.modified.startLineNumber<n)??i[i.length-1],this._goTo(o),o.lineRangeMapping.modified.isEmpty?this._accessibilitySignalService.playSignal(ks.diffLineDeleted,{source:"diffEditor.goToDiff"}):o.lineRangeMapping.original.isEmpty?this._accessibilitySignalService.playSignal(ks.diffLineInserted,{source:"diffEditor.goToDiff"}):o&&this._accessibilitySignalService.playSignal(ks.diffLineModified,{source:"diffEditor.goToDiff"})}revealFirstDiff(){let e=this._diffModel.get();e&&this.waitForDiff().then(()=>{let i=e.diff.get()?.mappings;!i||i.length===0||this._goTo(i[0])})}accessibleDiffViewerNext(){this._accessibleDiffViewer.get().next()}accessibleDiffViewerPrev(){this._accessibleDiffViewer.get().prev()}async waitForDiff(){let e=this._diffModel.get();e&&await e.waitForDiff()}mapToOtherSide(){let e=this._editors.modified.hasWidgetFocus(),i=e?this._editors.modified:this._editors.original,n=e?this._editors.original:this._editors.modified,o,s=i.getSelection();if(s){let a=this._diffModel.get()?.diff.get()?.mappings.map(l=>e?l.lineRangeMapping.flip():l.lineRangeMapping);if(a){let l=MQ(s.getStartPosition(),a),d=MQ(s.getEndPosition(),a);o=L.plusRange(l,d)}}return{destination:n,destinationSelection:o}}switchSide(){let{destination:e,destinationSelection:i}=this.mapToOtherSide();e.focus(),i&&e.setSelection(i)}exitCompareMove(){let e=this._diffModel.get();e&&e.movedTextToCompare.set(void 0,void 0)}collapseAllUnchangedRegions(){let e=this._diffModel.get()?.unchangedRegions.get();e&&nn(i=>{for(let n of e)n.collapseAll(i)})}showAllUnchangedRegions(){let e=this._diffModel.get()?.unchangedRegions.get();e&&nn(i=>{for(let n of e)n.showAll(i)})}_handleCursorPositionChange(e,i){if(e?.reason===3){let n=this._diffModel.get()?.diff.get()?.mappings.find(o=>i?o.lineRangeMapping.modified.contains(e.position.lineNumber):o.lineRangeMapping.original.contains(e.position.lineNumber));n?.lineRangeMapping.modified.isEmpty?this._accessibilitySignalService.playSignal(ks.diffLineDeleted,{source:"diffEditor.cursorPositionChanged"}):n?.lineRangeMapping.original.isEmpty?this._accessibilitySignalService.playSignal(ks.diffLineInserted,{source:"diffEditor.cursorPositionChanged"}):n&&this._accessibilitySignalService.playSignal(ks.diffLineModified,{source:"diffEditor.cursorPositionChanged"})}}};pS=E([b(3,re),b(4,ne),b(5,En),b(6,Rx),b(7,jN)],pS);function ake(r){return r.mappings.map(t=>{let e=t.lineRangeMapping,i,n,o,s,a=e.innerChanges;return e.original.isEmpty?(i=e.original.startLineNumber-1,n=0,a=void 0):(i=e.original.startLineNumber,n=e.original.endLineNumberExclusive-1),e.modified.isEmpty?(o=e.modified.startLineNumber-1,s=0,a=void 0):(o=e.modified.startLineNumber,s=e.modified.endLineNumberExclusive-1),{originalStartLineNumber:i,originalEndLineNumber:n,modifiedStartLineNumber:o,modifiedEndLineNumber:s,charChanges:a?.map(l=>({originalStartLineNumber:l.originalRange.startLineNumber,originalStartColumn:l.originalRange.startColumn,originalEndLineNumber:l.originalRange.endLineNumber,originalEndColumn:l.originalRange.endColumn,modifiedStartLineNumber:l.modifiedRange.startLineNumber,modifiedStartColumn:l.modifiedRange.startColumn,modifiedEndLineNumber:l.modifiedRange.endLineNumber,modifiedEndColumn:l.modifiedRange.endColumn}))}})}var xv=class extends Sv{constructor(e,i,n,o,s,a,l,d,c,p){super(xv.ID,e,i,n,o,s,l,a,d,c);this.preferencesService=p}static ID=n1;diffEditorControl=void 0;inputLifecycleStopWatch=void 0;get scopedContextKeyService(){if(!this.diffEditorControl)return;let e=this.diffEditorControl.getOriginalEditor(),i=this.diffEditorControl.getModifiedEditor();return(e.hasTextFocus()?e:i).invokeWithinContext(n=>n.get(re))}getTitle(){return this.input?this.input.getName():u("textDiffEditor","Text Diff Editor")}createEditorControl(e,i){this.diffEditorControl=this._register(this.instantiationService.createInstance(pS,e,i,{}))}updateEditorControlOptions(e){this.diffEditorControl?.updateOptions(e)}getMainControl(){return this.diffEditorControl?.getModifiedEditor()}_previousViewModel=null;async setInput(e,i,n,o){this._previousViewModel&&(this._previousViewModel.dispose(),this._previousViewModel=null),this.inputLifecycleStopWatch=void 0,await super.setInput(e,i,n,o);try{let s=await e.resolve();if(o.isCancellationRequested)return;if(!(s instanceof PT)){this.openAsBinary(e,i);return}let a=Yt(this.diffEditorControl),l=s,d=l.textDiffEditorModel?a.createViewModel(l.textDiffEditorModel):null;this._previousViewModel=d,await d?.waitForDiff(),a.setModel(d);let c=!1;Nk(i?.viewState)||(c=this.restoreTextDiffEditorViewState(e,i,n,a));let p=!1;i&&(p=kQ(i,a,1)),!p&&!c&&a.revealFirstDiff(),a.updateOptions({...this.getReadonlyConfiguration(l.modifiedModel?.isReadonly()),originalEditable:!l.originalModel?.isReadonly()}),a.handleInitialized(),this.inputLifecycleStopWatch=new Ko(!1)}catch(s){await this.handleSetInputError(s,e,i)}}async handleSetInputError(e,i,n){if(this.isFileBinaryError(e))return this.openAsBinary(i,n);if(e.fileOperationResult===7){let o;throw e instanceof tN?o=u("fileTooLargeForHeapErrorWithSize","At least one file is not displayed in the text compare editor because it is very large ({0}).",vc.formatSize(e.size)):o=u("fileTooLargeForHeapErrorWithoutSize","At least one file is not displayed in the text compare editor because it is very large."),qse(this.group,i,n,o,this.preferencesService)}throw e}restoreTextDiffEditorViewState(e,i,n,o){let s=this.loadEditorViewState(e,n);return s?(i?.selection&&s.modified&&(s.modified.cursorState=[]),o.restoreViewState(s),i?.revealIfVisible&&o.revealFirstDiff(),!0):!1}openAsBinary(e,i){let n=e.original,o=e.modified,s=this.instantiationService.createInstance(fl,e.getName(),e.getDescription(),n,o,!0),a=Pe.as(Ld.EditorFactory).getFileEditorFactory();a.isFileEditor(n)&&n.setForceOpenAsBinary(),a.isFileEditor(o)&&o.setForceOpenAsBinary(),this.group.replaceEditors([{editor:e,replacement:s,options:{...i,activation:3,pinned:this.group.isPinned(e),sticky:this.group.isSticky(e)}}])}setOptions(e){super.setOptions(e),e&&kQ(e,Yt(this.diffEditorControl),0)}shouldHandleConfigurationChangeEvent(e,i){return super.shouldHandleConfigurationChangeEvent(e,i)?!0:e.affectsConfiguration(i,"diffEditor")||e.affectsConfiguration(i,"accessibility.verbosity.diffEditor")}computeConfiguration(e){let i=super.computeConfiguration(e);if(vi(e.diffEditor)){let o=Xi(e.diffEditor);o.diffCodeLens=o.codeLens,delete o.codeLens,o.diffWordWrap=o.wordWrap,delete o.wordWrap,Object.assign(i,o)}let n=e.accessibility?.verbosity?.diffEditor??!1;return i.accessibilityVerbose=n,i}getConfigurationOverrides(e){return{...super.getConfigurationOverrides(e),...this.getReadonlyConfiguration(this.input?.isReadonly()),originalEditable:this.input instanceof fl&&!this.input.original.isReadonly(),lineDecorationsWidth:"2ch"}}updateReadonly(e){e instanceof fl?this.diffEditorControl?.updateOptions({...this.getReadonlyConfiguration(e.isReadonly()),originalEditable:!e.original.isReadonly()}):super.updateReadonly(e)}isFileBinaryError(e){return Array.isArray(e)?e.some(n=>this.isFileBinaryError(n)):e.textFileOperationResult===0}clearInput(){this._previousViewModel&&(this._previousViewModel.dispose(),this._previousViewModel=null),super.clearInput();let e=this.inputLifecycleStopWatch?.elapsed();this.inputLifecycleStopWatch=void 0,typeof e=="number"&&this.logInputLifecycleTelemetry(e,this.getControl()?.getModel()?.modified?.getLanguageId()),this.diffEditorControl?.setModel(null)}logInputLifecycleTelemetry(e,i){let n=!1;this.diffEditorControl instanceof pS&&(n=this.diffEditorControl.collapseUnchangedRegions),this.telemetryService.publicLog2("diffEditor.editorVisibleTime",{editorVisibleTimeMs:e,languageId:i??"",collapseUnchangedRegions:n})}getControl(){return this.diffEditorControl}focus(){super.focus(),this.diffEditorControl?.focus()}hasFocus(){return this.diffEditorControl?.hasTextFocus()||super.hasFocus()}setEditorVisible(e){super.setEditorVisible(e),e?this.diffEditorControl?.onVisible():this.diffEditorControl?.onHide()}layout(e){this.diffEditorControl?.layout(e)}setBoundarySashes(e){this.diffEditorControl?.setBoundarySashes(e)}tracksEditorViewState(e){return e instanceof fl}computeEditorViewState(e){if(!this.diffEditorControl)return;let i=this.diffEditorControl.getModel();if(!i||!i.modified||!i.original)return;let n=this.toEditorViewStateResource(i);if(n&&zi(n,e))return this.diffEditorControl.saveViewState()??void 0}toEditorViewStateResource(e){let i,n;if(e instanceof fl?(i=e.original.resource,n=e.modified.resource):kr(e)||(i=e.original.uri,n=e.modified.uri),!(!i||!n))return Z.from({scheme:"diff",path:`${YS(i.toString())}${YS(n.toString())}`})}};xv=E([b(1,Tt),b(2,ne),b(3,nt),b(4,Cs),b(5,$e),b(6,Fe),b(7,gn),b(8,Ei),b(9,jm)],xv);var hM="workbench.action.closeActiveEditor";var Wme="copyActiveEditor";var mM="workbench.action.unlockEditorGroup";var tZ="workbench.action.unpinEditor",Hme="workbench.action.splitEditor",iZ="workbench.action.splitEditorUp",nZ="workbench.action.splitEditorDown";var Ume="workbench.action.toggleMaximizeEditorGroup";var qz=[Hme,hM,tZ,mM,Ume];var $z=class{_serviceBrand;_dragOperations=new Map;removeDragOperationTransfer(t){if(t&&this._dragOperations.has(t)){let e=this._dragOperations.get(t);return this._dragOperations.delete(t),e}}addDragOperationTransfer(t,e){this._dragOperations.set(t,e)}},KT=class{constructor(t){this.identifier=t}};var jz=q("IFileDecorationsService");var sZ=q("notebookDocumentService"),oZ=["W","X","Y","Z","a","b","c","d","e","f"],hke=new RegExp(`^[${oZ.join("")}]+`),zme=7;function aZ(r){if(r.scheme!==Ie.vscodeNotebookCell)return;let t=r.fragment.indexOf("s");if(t<0)return;let e=parseInt(r.fragment.substring(0,t).replace(hke,""),zme),i=AD(r.fragment.substring(t+1)).toString();if(!isNaN(e))return{handle:e,notebook:r.with({scheme:i,fragment:null})}}function Kme(r,t){let e=t.toString(zme),n=`${e.length<oZ.length?oZ[e.length-1]:"z"}${e}s${OD(Jt.fromString(r.scheme),!0,!0)}`;return r.with({scheme:Ie.vscodeNotebookCell,fragment:n})}function Gme(r){if(r.scheme!==Ie.vscodeNotebookMetadata)return;let t=AD(r.fragment).toString();return r.with({scheme:t,fragment:null})}function qme(r){let t=`${OD(Jt.fromString(r.scheme),!0,!0)}`;return r.with({scheme:Ie.vscodeNotebookMetadata,fragment:t})}var rZ=class{_documents=new Fn;getNotebook(t){if(t.scheme===Ie.vscodeNotebookCell){let e=aZ(t);if(e){let i=this._documents.get(e.notebook);if(i)return i}}return this._documents.get(t)}addNotebookDocument(t){this._documents.set(t.uri,t)}removeNotebookDocument(t){this._documents.delete(t.uri)}};gi(sZ,rZ,1);function em(r){if(!(!r||!r.resource))return Z.isUri(r.resource)?r.resource:r.resource.primary}var hS={onDidChangeVisibility:X.None},tc=class extends R{constructor(e,i,n,o,s,a,l,d,c,p){super();this.instantiationService=i;this.configurationService=n;this.modelService=o;this.workspaceService=s;this.languageService=a;this.decorationsService=l;this.themeService=d;this.labelService=c;this.textFileService=p;this.registerListeners(e)}_onDidChangeDecorations=this._register(new x);onDidChangeDecorations=this._onDidChangeDecorations.event;widgets=[];labels=[];registerListeners(e){this._register(e.onDidChangeVisibility(i=>{this.widgets.forEach(n=>n.notifyVisibilityChanged(i))})),this._register(this.languageService.onDidChange(()=>this.widgets.forEach(i=>i.notifyExtensionsRegistered()))),this._register(this.modelService.onModelLanguageChanged(i=>{i.model.uri&&this.widgets.forEach(n=>n.notifyModelLanguageChanged(i.model))})),this._register(this.modelService.onModelAdded(i=>{i.uri&&this.widgets.forEach(n=>n.notifyModelAdded(i))})),this._register(this.workspaceService.onDidChangeWorkspaceFolders(()=>{this.widgets.forEach(i=>i.notifyWorkspaceFoldersChange())})),this._register(this.decorationsService.onDidChangeDecorations(i=>{let n=!1;this.widgets.forEach(o=>{o.notifyFileDecorationsChanges(i)&&(n=!0)}),n&&this._onDidChangeDecorations.fire()})),this._register(this.themeService.onDidColorThemeChange(()=>this.widgets.forEach(i=>i.notifyThemeChange()))),this._register(this.configurationService.onDidChangeConfiguration(i=>{i.affectsConfiguration(nN)&&this.widgets.forEach(n=>n.notifyFileAssociationsChange())})),this._register(this.labelService.onDidChangeFormatters(i=>{this.widgets.forEach(n=>n.notifyFormattersChange(i.scheme))})),this._register(this.textFileService.untitled.onDidChangeLabel(i=>{this.widgets.forEach(n=>n.notifyUntitledLabelChange(i.resource))}))}get(e){return this.labels[e]}create(e,i){let n=this.instantiationService.createInstance(gM,e,i),o={element:n.element,onDidRender:n.onDidRender,setLabel:(s,a,l)=>n.setLabel(s,a,l),setResource:(s,a)=>n.setResource(s,a),setFile:(s,a)=>n.setFile(s,a),clear:()=>n.clear(),dispose:()=>this.disposeWidget(n)};return this.labels.push(o),this.widgets.push(n),o}disposeWidget(e){let i=this.widgets.indexOf(e);i>-1&&(this.widgets.splice(i,1),this.labels.splice(i,1)),_e(e)}clear(){this.widgets=_e(this.widgets),this.labels=[]}dispose(){super.dispose(),this.clear()}};tc=E([b(1,ne),b(2,se),b(3,qi),b(4,kt),b(5,ti),b(6,jz),b(7,Fe),b(8,hi),b(9,Us)],tc);var GT=class extends tc{label;get element(){return this.label}constructor(t,e,i,n,o,s,a,l,d,c,p){super(hS,i,n,o,s,a,l,d,c,p),this.label=this._register(this.create(t,e))}};GT=E([b(2,ne),b(3,se),b(4,qi),b(5,kt),b(6,ti),b(7,jz),b(8,Fe),b(9,hi),b(10,Us)],GT);var gM=class extends gh{constructor(e,i,n,o,s,a,l,d,c){super(e,i);this.languageService=n;this.modelService=o;this.decorationsService=s;this.labelService=a;this.textFileService=l;this.contextService=d;this.notebookDocumentService=c}_onDidRender=this._register(new x);onDidRender=this._onDidRender.event;label=void 0;decoration=this._register(new yt);options=void 0;computedIconClasses=void 0;computedLanguageId=void 0;computedPathLabel=void 0;computedWorkspaceFolderLabel=void 0;needsRedraw=void 0;isHidden=!1;notifyVisibilityChanged(e){e===this.isHidden&&(this.isHidden=!e,e&&this.needsRedraw&&(this.render({updateIcon:this.needsRedraw===2,updateDecoration:this.needsRedraw===2}),this.needsRedraw=void 0))}notifyModelLanguageChanged(e){this.handleModelEvent(e)}notifyModelAdded(e){this.handleModelEvent(e)}handleModelEvent(e){let i=em(this.label);i&&zi(e.uri,i)&&this.computedLanguageId!==e.getLanguageId()&&(this.computedLanguageId=e.getLanguageId(),this.render({updateIcon:!0,updateDecoration:!1}))}notifyFileDecorationsChanges(e){if(!this.options)return!1;let i=em(this.label);return i&&this.options.fileDecorations&&e.affectsResource(i)?this.render({updateIcon:!1,updateDecoration:!0}):!1}notifyExtensionsRegistered(){this.render({updateIcon:!0,updateDecoration:!1})}notifyThemeChange(){this.render({updateIcon:!1,updateDecoration:!1})}notifyFileAssociationsChange(){this.render({updateIcon:!0,updateDecoration:!1})}notifyFormattersChange(e){em(this.label)?.scheme===e&&this.render({updateIcon:!1,updateDecoration:!1})}notifyUntitledLabelChange(e){zi(e,em(this.label))&&this.render({updateIcon:!1,updateDecoration:!1})}notifyWorkspaceFoldersChange(){if(typeof this.computedWorkspaceFolderLabel=="string"){let e=em(this.label);Z.isUri(e)&&this.label?.name===this.computedWorkspaceFolderLabel&&this.setFile(e,this.options)}}setFile(e,i){let n=i?.hideLabel,o;if(!n){if(i?.fileKind===2){let a=this.contextService.getWorkspaceFolder(e);a&&(o=a.name,this.computedWorkspaceFolderLabel=o)}o||(o=jp(Ns(e)))}let s;if(!i?.hidePath){let a=this.labelService.getUriLabel(Hn(e),{relative:!0});a&&a!=="."&&(s=a)}this.setResource({resource:e,name:o,description:s,range:i?.range},i)}setResource(e,i=Object.create(null)){let n=em(e),o=e?.resource&&!Z.isUri(e.resource);if(!i.forceLabel&&!o&&n?.scheme===Ie.untitled){let c=this.textFileService.untitled.get(n);if(c&&!c.hasAssociatedFilePath){if(typeof e.name=="string"&&(e.name=c.name),typeof e.description=="string"){let h=c.resource.path;e.name!==h?e.description=h:e.description=void 0}let p=c.resource.path;c.name!==p?i.title=`${c.name} \u2022 ${p}`:i.title=p}}if(!i.forceLabel&&!o&&n?.scheme===Ie.vscodeNotebookCell){let c=this.notebookDocumentService.getNotebook(n),p=c?.getCellIndex(n);c&&p!==void 0&&typeof e.name=="string"&&(i.title=u("notebookCellLabel","{0} \u2022 Cell {1}",e.name,`${p+1}`)),typeof e.name=="string"&&c&&p!==void 0&&typeof e.name=="string"&&(e.name=u("notebookCellLabel","{0} \u2022 Cell {1}",e.name,`${p+1}`))}let s=this.hasResourceChanged(e),a=s||this.hasPathLabelChanged(e),l=this.hasFileKindChanged(i),d=this.hasIconChanged(i);this.label=e,this.options=i,s&&(this.computedLanguageId=void 0),a&&(this.computedPathLabel=void 0),this.render({updateIcon:s||l||d,updateDecoration:s||l})}hasFileKindChanged(e){let i=e?.fileKind,n=this.options?.fileKind;return i!==n}hasResourceChanged(e){let i=em(e),n=em(this.label);return i&&n?i.toString()!==n.toString():!(!i&&!n)}hasPathLabelChanged(e){let i=em(e);return!!i&&this.computedPathLabel!==this.labelService.getUriLabel(i)}hasIconChanged(e){return this.options?.icon!==e?.icon}clear(){this.label=void 0,this.options=void 0,this.computedLanguageId=void 0,this.computedIconClasses=void 0,this.computedPathLabel=void 0,this.setLabel("")}render(e){if(this.isHidden)return this.needsRedraw!==2&&(this.needsRedraw=e.updateIcon||e.updateDecoration?2:1),!1;if(e.updateIcon&&(this.computedIconClasses=void 0),!this.label)return!1;let i={title:"",italic:this.options?.italic,strikethrough:this.options?.strikethrough,matches:this.options?.matches,descriptionMatches:this.options?.descriptionMatches,extraClasses:[],separator:this.options?.separator,domId:this.options?.domId,disabledCommand:this.options?.disabledCommand,labelEscapeNewLines:this.options?.labelEscapeNewLines,descriptionTitle:this.options?.descriptionTitle},n=em(this.label);if(this.options?.title!==void 0&&(i.title=this.options.title),n&&n.scheme!==Ie.data&&(!this.options?.title||typeof this.options.title!="string"&&!this.options.title.markdownNotSupportedFallback)&&(this.computedPathLabel||(this.computedPathLabel=this.labelService.getUriLabel(n)),!i.title||typeof i.title=="string"?i.title=this.computedPathLabel:i.title.markdownNotSupportedFallback||(i.title.markdownNotSupportedFallback=this.computedPathLabel)),this.options&&!this.options.hideIcon&&(this.computedIconClasses||(this.computedIconClasses=ua(this.modelService,this.languageService,n,this.options.fileKind,this.options.icon)),Z.isUri(this.options.icon)&&(i.iconPath=this.options.icon),i.extraClasses=this.computedIconClasses.slice(0)),this.options?.extraClasses&&i.extraClasses.push(...this.options.extraClasses),this.options?.fileDecorations&&n){e.updateDecoration&&(this.decoration.value=this.decorationsService.getDecoration(n,this.options.fileKind!==0));let o=this.decoration.value;if(o){if(o.tooltip){if(typeof i.title=="string")i.title=`${i.title} \u2022 ${o.tooltip}`;else if(typeof i.title?.markdown=="string"){let s=`${i.title.markdown} \u2022 ${o.tooltip}`;i.title={markdown:s,markdownNotSupportedFallback:s}}}o.strikethrough&&(i.strikethrough=!0),this.options.fileDecorations.colors&&i.extraClasses.push(o.labelClassName),this.options.fileDecorations.badges&&(i.extraClasses.push(o.badgeClassName),i.extraClasses.push(o.iconClassName))}}return this.label.range&&(i.suffix=this.label.range.startLineNumber!==this.label.range.endLineNumber?`:${this.label.range.startLineNumber}-${this.label.range.endLineNumber}`:`:${this.label.range.startLineNumber}`),this.setLabel(this.label.name??"",this.label.description,i),this._onDidRender.fire(),!0}dispose(){super.dispose(),this.label=void 0,this.options=void 0,this.computedLanguageId=void 0,this.computedIconClasses=void 0,this.computedPathLabel=void 0,this.computedWorkspaceFolderLabel=void 0}};gM=E([b(2,ti),b(3,qi),b(4,jz),b(5,hi),b(6,Us),b(7,kt),b(8,sZ)],gM);var sp=q("IEditorBreadcrumbsService"),lZ=class{_map=new Map;register(t,e){if(this._map.has(t))throw new Error(`group (${t}) has already a widget`);return this._map.set(t,e),{dispose:()=>this._map.delete(t)}}getWidget(t){return this._map.get(t)}};gi(sp,lZ,1);var bl=class r{constructor(){}static IsEnabled=r._stub("breadcrumbs.enabled");static UseQuickPick=r._stub("breadcrumbs.useQuickPick");static FilePath=r._stub("breadcrumbs.filePath");static SymbolPath=r._stub("breadcrumbs.symbolPath");static SymbolSortOrder=r._stub("breadcrumbs.symbolSortOrder");static Icons=r._stub("breadcrumbs.icons");static TitleScrollbarSizing=r._stub("workbench.editor.titleScrollbarSizing");static FileExcludes=r._stub("files.exclude");static _stub(t){return{bindTo(e){let i=new x,n=e.onDidChangeConfiguration(o=>{o.affectsConfiguration(t)&&i.fire(void 0)});return new class{name=t;onDidChange=i.event;getValue(o){return o?e.getValue(t,o):e.getValue(t)}updateValue(o,s){return s?e.updateValue(t,o,s):e.updateValue(t,o)}dispose(){n.dispose(),i.dispose()}}}}}};Pe.as(ur.Configuration).registerConfiguration({id:"breadcrumbs",title:u("title","Breadcrumb Navigation"),order:101,type:"object",properties:{"breadcrumbs.enabled":{description:u("enabled","Enable/disable navigation breadcrumbs."),type:"boolean",default:!0},"breadcrumbs.filePath":{description:u("filepath","Controls whether and how file paths are shown in the breadcrumbs view."),type:"string",default:"on",enum:["on","off","last"],enumDescriptions:[u("filepath.on","Show the file path in the breadcrumbs view."),u("filepath.off","Do not show the file path in the breadcrumbs view."),u("filepath.last","Only show the last element of the file path in the breadcrumbs view.")]},"breadcrumbs.symbolPath":{description:u("symbolpath","Controls whether and how symbols are shown in the breadcrumbs view."),type:"string",default:"on",enum:["on","off","last"],enumDescriptions:[u("symbolpath.on","Show all symbols in the breadcrumbs view."),u("symbolpath.off","Do not show symbols in the breadcrumbs view."),u("symbolpath.last","Only show the current symbol in the breadcrumbs view.")]},"breadcrumbs.symbolSortOrder":{description:u("symbolSortOrder","Controls how symbols are sorted in the breadcrumbs outline view."),type:"string",default:"position",scope:5,enum:["position","name","type"],enumDescriptions:[u("symbolSortOrder.position","Show symbol outline in file position order."),u("symbolSortOrder.name","Show symbol outline in alphabetical order."),u("symbolSortOrder.type","Show symbol outline in symbol type order.")]},"breadcrumbs.icons":{description:u("icons","Render breadcrumb items with icons."),type:"boolean",default:!0},"breadcrumbs.showFiles":{type:"boolean",default:!0,scope:5,markdownDescription:u("filteredTypes.file","When enabled breadcrumbs show `file`-symbols.")},"breadcrumbs.showModules":{type:"boolean",default:!0,scope:5,markdownDescription:u("filteredTypes.module","When enabled breadcrumbs show `module`-symbols.")},"breadcrumbs.showNamespaces":{type:"boolean",default:!0,scope:5,markdownDescription:u("filteredTypes.namespace","When enabled breadcrumbs show `namespace`-symbols.")},"breadcrumbs.showPackages":{type:"boolean",default:!0,scope:5,markdownDescription:u("filteredTypes.package","When enabled breadcrumbs show `package`-symbols.")},"breadcrumbs.showClasses":{type:"boolean",default:!0,scope:5,markdownDescription:u("filteredTypes.class","When enabled breadcrumbs show `class`-symbols.")},"breadcrumbs.showMethods":{type:"boolean",default:!0,scope:5,markdownDescription:u("filteredTypes.method","When enabled breadcrumbs show `method`-symbols.")},"breadcrumbs.showProperties":{type:"boolean",default:!0,scope:5,markdownDescription:u("filteredTypes.property","When enabled breadcrumbs show `property`-symbols.")},"breadcrumbs.showFields":{type:"boolean",default:!0,scope:5,markdownDescription:u("filteredTypes.field","When enabled breadcrumbs show `field`-symbols.")},"breadcrumbs.showConstructors":{type:"boolean",default:!0,scope:5,markdownDescription:u("filteredTypes.constructor","When enabled breadcrumbs show `constructor`-symbols.")},"breadcrumbs.showEnums":{type:"boolean",default:!0,scope:5,markdownDescription:u("filteredTypes.enum","When enabled breadcrumbs show `enum`-symbols.")},"breadcrumbs.showInterfaces":{type:"boolean",default:!0,scope:5,markdownDescription:u("filteredTypes.interface","When enabled breadcrumbs show `interface`-symbols.")},"breadcrumbs.showFunctions":{type:"boolean",default:!0,scope:5,markdownDescription:u("filteredTypes.function","When enabled breadcrumbs show `function`-symbols.")},"breadcrumbs.showVariables":{type:"boolean",default:!0,scope:5,markdownDescription:u("filteredTypes.variable","When enabled breadcrumbs show `variable`-symbols.")},"breadcrumbs.showConstants":{type:"boolean",default:!0,scope:5,markdownDescription:u("filteredTypes.constant","When enabled breadcrumbs show `constant`-symbols.")},"breadcrumbs.showStrings":{type:"boolean",default:!0,scope:5,markdownDescription:u("filteredTypes.string","When enabled breadcrumbs show `string`-symbols.")},"breadcrumbs.showNumbers":{type:"boolean",default:!0,scope:5,markdownDescription:u("filteredTypes.number","When enabled breadcrumbs show `number`-symbols.")},"breadcrumbs.showBooleans":{type:"boolean",default:!0,scope:5,markdownDescription:u("filteredTypes.boolean","When enabled breadcrumbs show `boolean`-symbols.")},"breadcrumbs.showArrays":{type:"boolean",default:!0,scope:5,markdownDescription:u("filteredTypes.array","When enabled breadcrumbs show `array`-symbols.")},"breadcrumbs.showObjects":{type:"boolean",default:!0,scope:5,markdownDescription:u("filteredTypes.object","When enabled breadcrumbs show `object`-symbols.")},"breadcrumbs.showKeys":{type:"boolean",default:!0,scope:5,markdownDescription:u("filteredTypes.key","When enabled breadcrumbs show `key`-symbols.")},"breadcrumbs.showNull":{type:"boolean",default:!0,scope:5,markdownDescription:u("filteredTypes.null","When enabled breadcrumbs show `null`-symbols.")},"breadcrumbs.showEnumMembers":{type:"boolean",default:!0,scope:5,markdownDescription:u("filteredTypes.enumMember","When enabled breadcrumbs show `enumMember`-symbols.")},"breadcrumbs.showStructs":{type:"boolean",default:!0,scope:5,markdownDescription:u("filteredTypes.struct","When enabled breadcrumbs show `struct`-symbols.")},"breadcrumbs.showEvents":{type:"boolean",default:!0,scope:5,markdownDescription:u("filteredTypes.event","When enabled breadcrumbs show `event`-symbols.")},"breadcrumbs.showOperators":{type:"boolean",default:!0,scope:5,markdownDescription:u("filteredTypes.operator","When enabled breadcrumbs show `operator`-symbols.")},"breadcrumbs.showTypeParameters":{type:"boolean",default:!0,scope:5,markdownDescription:u("filteredTypes.typeParameter","When enabled breadcrumbs show `typeParameter`-symbols.")}}});var $me=q("IOutlineService");var mS=class{constructor(t,e){this.uri=t;this.kind=e}},$T=class{constructor(t,e){this.element=t;this.outline=e}},qT=class{constructor(t,e,i,n,o){this.resource=t;this._workspaceService=n;this._outlineService=o;this._cfgFilePath=bl.FilePath.bindTo(i),this._cfgSymbolPath=bl.SymbolPath.bindTo(i),this._disposables.add(this._cfgFilePath.onDidChange(s=>this._onDidUpdate.fire(this))),this._disposables.add(this._cfgSymbolPath.onDidChange(s=>this._onDidUpdate.fire(this))),this._workspaceService.onDidChangeWorkspaceFolders(this._onDidChangeWorkspaceFolders,this,this._disposables),this._fileInfo=this._initFilePathInfo(t),e&&(this._bindToEditor(e),this._disposables.add(o.onDidChange(()=>this._bindToEditor(e))),this._disposables.add(e.onDidChangeControl(()=>this._bindToEditor(e)))),this._onDidUpdate.fire(this)}_disposables=new B;_fileInfo;_cfgFilePath;_cfgSymbolPath;_currentOutline=new yt;_outlineDisposables=new B;_onDidUpdate=new x;onDidUpdate=this._onDidUpdate.event;dispose(){this._disposables.dispose(),this._cfgFilePath.dispose(),this._cfgSymbolPath.dispose(),this._currentOutline.dispose(),this._outlineDisposables.dispose(),this._onDidUpdate.dispose()}isRelative(){return!!this._fileInfo.folder}getElements(){let t=[];if(this._cfgFilePath.getValue()==="on"?t=t.concat(this._fileInfo.path):this._cfgFilePath.getValue()==="last"&&this._fileInfo.path.length>0&&(t=t.concat(this._fileInfo.path.slice(-1))),this._cfgSymbolPath.getValue()==="off"||!this._currentOutline.value)return t;let e=this._currentOutline.value.config.breadcrumbsDataSource.getBreadcrumbElements();for(let i=this._cfgSymbolPath.getValue()==="last"&&e.length>0?e.length-1:0;i<e.length;i++)t.push(new $T(e[i],this._currentOutline.value));return e.length===0&&!this._currentOutline.value.isEmpty&&t.push(new $T(this._currentOutline.value,this._currentOutline.value)),t}_initFilePathInfo(t){if(IA(t,Ie.untitled,Ie.data))return{folder:void 0,path:[]};let e={folder:this._workspaceService.getWorkspaceFolder(t)??void 0,path:[]},i=t;for(;i&&i.path!=="/"&&!(e.folder&&zi(e.folder.uri,i));){e.path.unshift(new mS(i,e.path.length===0?0:1));let n=i.path.length;if(i=Hn(i),i.path.length===n)break}return e.folder&&this._workspaceService.getWorkbenchState()===3&&e.path.unshift(new mS(e.folder.uri,2)),e}_onDidChangeWorkspaceFolders(){this._fileInfo=this._initFilePathInfo(this.resource),this._onDidUpdate.fire(this)}_bindToEditor(t){let e=new Kt;this._currentOutline.clear(),this._outlineDisposables.clear(),this._outlineDisposables.add(le(()=>e.dispose(!0))),this._outlineService.createOutline(t,2,e.token).then(i=>{e.token.isCancellationRequested&&(i?.dispose(),i=void 0),this._currentOutline.value=i,this._onDidUpdate.fire(this),i&&this._outlineDisposables.add(i.onDidChange(()=>this._onDidUpdate.fire(this)))}).catch(i=>{this._onDidUpdate.fire(this),Xe(i)})}};qT=E([b(2,se),b(3,kt),b(4,$me)],qT);var jT=class{constructor(t,e,i,n,o){this.resource=e;this._instantiationService=i;this._themeService=n;this._configurationService=o;this._domNode=document.createElement("div"),this._domNode.className="monaco-breadcrumbs-picker show-file-icons",t.appendChild(this._domNode)}_disposables=new B;_domNode;_arrow;_treeContainer;_tree;_fakeEvent=new UIEvent("fakeEvent");_layoutInfo;_onWillPickElement=new x;onWillPickElement=this._onWillPickElement.event;_previewDispoables=new yt;dispose(){this._disposables.dispose(),this._previewDispoables.dispose(),this._onWillPickElement.dispose(),this._domNode.remove(),setTimeout(()=>this._tree.dispose(),0)}async show(t,e,i,n,o){let a=this._themeService.getColorTheme().getColor(f8);this._arrow=document.createElement("div"),this._arrow.className="arrow",this._arrow.style.borderColor=`transparent transparent ${a?a.toString():""}`,this._domNode.appendChild(this._arrow),this._treeContainer=document.createElement("div"),this._treeContainer.style.background=a?a.toString():"",this._treeContainer.style.paddingTop="2px",this._treeContainer.style.borderRadius="3px",this._treeContainer.style.boxShadow=`0 0 8px 2px ${this._themeService.getColorTheme().getColor(Hp)}`,this._treeContainer.style.border=`1px solid ${this._themeService.getColorTheme().getColor(Am)}`,this._domNode.appendChild(this._treeContainer),this._layoutInfo={maxHeight:e,width:i,arrowSize:n,arrowOffset:o,inputHeight:0},this._tree=this._createTree(this._treeContainer,t),this._disposables.add(this._tree.onDidOpen(async l=>{let{element:d,editorOptions:c,sideBySide:p}=l;await this._revealElement(d,{...c,preserveFocus:!1},p)})),this._disposables.add(this._tree.onDidChangeFocus(l=>{this._previewDispoables.value=this._previewElement(l.elements[0])})),this._disposables.add(this._tree.onDidChangeContentHeight(()=>{this._layout()})),this._domNode.focus();try{await this._setInput(t),this._layout()}catch(l){Xe(l)}}_layout(){let t=2*this._layoutInfo.arrowSize,e=Math.min(this._layoutInfo.maxHeight-t,this._tree.contentHeight),i=e+t;this._domNode.style.height=`${i}px`,this._domNode.style.width=`${this._layoutInfo.width}px`,this._arrow.style.top=`-${2*this._layoutInfo.arrowSize}px`,this._arrow.style.borderWidth=`${this._layoutInfo.arrowSize}px`,this._arrow.style.marginLeft=`${this._layoutInfo.arrowOffset}px`,this._treeContainer.style.height=`${e}px`,this._treeContainer.style.width=`${this._layoutInfo.width}px`,this._tree.layout(e,this._layoutInfo.width)}restoreViewState(){}};jT=E([b(2,ne),b(3,Fe),b(4,se)],jT);var dZ=class{getHeight(t){return 22}getTemplateId(t){return"FileStat"}},cZ=class{getId(t){return Z.isUri(t)?t.toString():rO(t)?t.id:Rp(t)?t.uri.toString():t.resource.toString()}},fM=class{constructor(t){this._fileService=t}hasChildren(t){return Z.isUri(t)||rO(t)||Rp(t)||t.isDirectory}async getChildren(t){if(rO(t))return t.folders;let e;return Rp(t)?e=t.uri:Z.isUri(t)?e=t:e=t.resource,(await this._fileService.resolve(e)).children??[]}};fM=E([b(0,Ei)],fM);var bM=class{constructor(t,e){this._labels=t;this._configService=e}templateId="FileStat";renderTemplate(t){return this._labels.create(t,{supportHighlights:!0})}renderElement(t,e,i){let n=this._configService.getValue("explorer.decorations"),{element:o}=t,s,a;Rp(o)?(s=o.uri,a=2):(s=o.resource,a=o.isDirectory?1:0),i.setFile(s,{fileKind:a,hidePath:!0,fileDecorations:n,matches:qo(t.filterData),extraClasses:["picker-item"]})}disposeTemplate(t){t.dispose()}};bM=E([b(1,se)],bM);var uZ=class{getKeyboardNavigationLabel(t){return t.name}},pZ=class{getWidgetAriaLabel(){return u("breadcrumbs","Breadcrumbs")}getAriaLabel(t){return t.name}},vM=class{constructor(t,e){this._workspaceService=t;let i=bl.FileExcludes.bindTo(e),n=()=>{t.getWorkspace().folders.forEach(o=>{let s=i.getValue({resource:o.uri});if(!s)return;let a={};for(let l in s){if(typeof s[l]!="boolean")continue;let d=l.indexOf("**/")!==0?Xt.join(o.uri.path,l):l;a[d]=s[l]}this._cachedExpressions.set(o.uri.toString(),du(a))})};n(),this._disposables.add(i),this._disposables.add(i.onDidChange(n)),this._disposables.add(t.onDidChangeWorkspaceFolders(n))}_cachedExpressions=new Map;_disposables=new B;dispose(){this._disposables.dispose()}filter(t,e){if(Rp(t))return!0;let i=this._workspaceService.getWorkspaceFolder(t.resource);return!i||!this._cachedExpressions.has(i.uri.toString())?!0:!this._cachedExpressions.get(i.uri.toString())(k_(i.uri.path,t.resource.path),Ji(t.resource))}};vM=E([b(0,kt),b(1,se)],vM);var hZ=class{compare(t,e){return Rp(t)&&Rp(e)?t.index-e.index:t.isDirectory===e.isDirectory?N8(t.name,e.name):t.isDirectory?-1:1}},XT=class extends jT{constructor(e,i,n,o,s,a,l){super(e,i,n,o,s);this._workspaceService=a;this._editorService=l}_createTree(e){this._treeContainer.classList.add("file-icon-themable-tree"),this._treeContainer.classList.add("show-file-icons");let i=o=>{this._treeContainer.classList.toggle("align-icons-and-twisties",o.hasFileIcons&&!o.hasFolderIcons),this._treeContainer.classList.toggle("hide-arrows",o.hidesExplorerArrows===!0)};this._disposables.add(this._themeService.onDidFileIconThemeChange(i)),i(this._themeService.getFileIconTheme());let n=this._instantiationService.createInstance(tc,hS);return this._disposables.add(n),this._instantiationService.createInstance(is,"BreadcrumbsFilePicker",e,new dZ,[this._instantiationService.createInstance(bM,n)],this._instantiationService.createInstance(fM),{multipleSelectionSupport:!1,sorter:new hZ,filter:this._instantiationService.createInstance(vM),identityProvider:new cZ,keyboardNavigationLabelProvider:new uZ,accessibilityProvider:this._instantiationService.createInstance(pZ),showNotFoundMessage:!1,overrideStyles:{listBackground:f8}})}async _setInput(e){let{uri:i,kind:n}=e,o;n===2?o=this._workspaceService.getWorkspace():o=Hn(i);let s=this._tree;await s.setInput(o);let a;for(let{element:l}of s.getNode().children)if(Rp(l)&&zi(l.uri,i)){a=l;break}else if(zi(l.resource,i)){a=l;break}a&&(s.reveal(a,.5),s.setFocus([a],this._fakeEvent)),s.domFocus()}_previewElement(e){return R.None}async _revealElement(e,i,n){return!Rp(e)&&e.isFile?(this._onWillPickElement.fire(),await this._editorService.openEditor({resource:e.resource,options:i},n?Vl:void 0),!0):!1}};XT=E([b(2,ne),b(3,Fe),b(4,se),b(5,kt),b(6,$e)],XT);var IM=class{constructor(t,e,i){this.comparator=t;this._order=i.getValue(e,"breadcrumbs.symbolSortOrder")}_order;compare(t,e){return this._order==="name"?this.comparator.compareByName(t,e):this._order==="type"?this.comparator.compareByType(t,e):this.comparator.compareByPosition(t,e)}};IM=E([b(2,Cs)],IM);var Xz=class extends jT{_createTree(t,e){let{config:i}=e.outline;return this._instantiationService.createInstance(hb,"BreadcrumbsOutlinePicker",t,i.delegate,i.renderers,i.treeDataSource,{...i.options,sorter:this._instantiationService.createInstance(IM,i.comparator,void 0),collapseByDefault:!0,expandOnlyOnTwistieClick:!0,multipleSelectionSupport:!1,showNotFoundMessage:!1})}_setInput(t){let e=t.outline.captureViewState();this.restoreViewState=()=>{e.dispose()};let i=this._tree;return i.setInput(t.outline),t.element!==t.outline&&(i.reveal(t.element,.5),i.setFocus([t.element],this._fakeEvent)),i.domFocus(),Promise.resolve()}_previewElement(t){return this._tree.getInput().preview(t)}async _revealElement(t,e,i){return this._onWillPickElement.fire(),await this._tree.getInput().reveal(t,e,i,!1),!0}};var Yz=class r extends Ow{constructor(e,i,n){super();this.model=e;this.element=i;this.options=n}_disposables=new B;dispose(){this._disposables.dispose()}equals(e){return e instanceof r?this.element.element===e.element.element&&this.options.showFileIcons===e.options.showFileIcons&&this.options.showSymbolIcons===e.options.showSymbolIcons:!1}render(e){let{element:i,outline:n}=this.element;if(i===n){let l=J("span",void 0,"\u2026");e.appendChild(l);return}let o=n.config.delegate.getTemplateId(i),s=n.config.renderers.find(l=>l.templateId===o);if(!s){e.innerText="<<NO RENDERER>>";return}let a=s.renderTemplate(e);s.renderElement({element:i,children:[],depth:0,visibleChildrenCount:0,visibleChildIndex:0,collapsible:!1,collapsed:!1,visible:!0,filterData:void 0},0,a,void 0),this._disposables.add(le(()=>{s.disposeTemplate(a)}))}},Qz=class r extends Ow{constructor(e,i,n,o,s){super();this.model=e;this.element=i;this.options=n;this._labels=o;this._hoverDelegate=s}_disposables=new B;dispose(){this._disposables.dispose()}equals(e){return e instanceof r?Ti.isEqual(this.element.uri,e.element.uri)&&this.options.showFileIcons===e.options.showFileIcons&&this.options.showSymbolIcons===e.options.showSymbolIcons:!1}render(e){let i=this._labels.create(e,{hoverDelegate:this._hoverDelegate});i.setFile(this.element.uri,{hidePath:!0,hideIcon:this.element.kind===1||!this.options.showFileIcons,fileKind:this.element.kind,fileDecorations:{colors:this.options.showDecorationColors,badges:!1}}),e.classList.add(bu[this.element.kind].toLowerCase()),this._disposables.add(i)}},mke=ke("breadcrumb-separator",N.chevronRight,u("separatorIcon","Icon for the separator in the breadcrumbs.")),Vi=class{constructor(t,e,i,n,o,s,a,l,d,c,p,h){this._options=e;this._editorGroup=i;this._contextKeyService=n;this._contextViewService=o;this._instantiationService=s;this._quickInputService=a;this._fileService=l;this._editorService=d;this._labelService=c;this.domNode=document.createElement("div"),this.domNode.classList.add("breadcrumbs-control"),U(t,this.domNode),this._cfUseQuickPick=bl.UseQuickPick.bindTo(p),this._cfShowIcons=bl.Icons.bindTo(p),this._cfTitleScrollbarSizing=bl.TitleScrollbarSizing.bindTo(p),this._labels=this._instantiationService.createInstance(tc,hS);let m=this._cfTitleScrollbarSizing.getValue()??"default",f=e.widgetStyles??uF;this._widget=new lF(this.domNode,Vi.SCROLLBAR_SIZES[m],mke,f),this._widget.onDidSelectItem(this._onSelectEvent,this,this._disposables),this._widget.onDidFocusItem(this._onFocusEvent,this,this._disposables),this._widget.onDidChangeFocus(this._updateCkBreadcrumbsActive,this,this._disposables),this._ckBreadcrumbsPossible=Vi.CK_BreadcrumbsPossible.bindTo(this._contextKeyService),this._ckBreadcrumbsVisible=Vi.CK_BreadcrumbsVisible.bindTo(this._contextKeyService),this._ckBreadcrumbsActive=Vi.CK_BreadcrumbsActive.bindTo(this._contextKeyService),this._hoverDelegate=gt("mouse"),this._disposables.add(h.register(this._editorGroup.id,this._widget)),this.hide()}static HEIGHT=22;static SCROLLBAR_SIZES={default:3,large:8};static Payload_Reveal={};static Payload_RevealAside={};static Payload_Pick={};static CK_BreadcrumbsPossible=new A("breadcrumbsPossible",!1,u("breadcrumbsPossible","Whether the editor can show breadcrumbs"));static CK_BreadcrumbsVisible=new A("breadcrumbsVisible",!1,u("breadcrumbsVisible","Whether breadcrumbs are currently visible"));static CK_BreadcrumbsActive=new A("breadcrumbsActive",!1,u("breadcrumbsActive","Whether breadcrumbs have focus"));_ckBreadcrumbsPossible;_ckBreadcrumbsVisible;_ckBreadcrumbsActive;_cfUseQuickPick;_cfShowIcons;_cfTitleScrollbarSizing;domNode;_widget;_disposables=new B;_breadcrumbsDisposables=new B;_labels;_model=new yt;_breadcrumbsPickerShowing=!1;_breadcrumbsPickerIgnoreOnceItem;_hoverDelegate;_onDidVisibilityChange=this._disposables.add(new x);get onDidVisibilityChange(){return this._onDidVisibilityChange.event}dispose(){this._disposables.dispose(),this._breadcrumbsDisposables.dispose(),this._ckBreadcrumbsPossible.reset(),this._ckBreadcrumbsVisible.reset(),this._ckBreadcrumbsActive.reset(),this._cfUseQuickPick.dispose(),this._cfShowIcons.dispose(),this._widget.dispose(),this._labels.dispose(),this.domNode.remove()}get model(){return this._model.value}layout(t){this._widget.layout(t)}isHidden(){return this.domNode.classList.contains("hidden")}hide(){let t=this.isHidden();this._breadcrumbsDisposables.clear(),this._ckBreadcrumbsVisible.set(!1),this.domNode.classList.toggle("hidden",!0),t||this._onDidVisibilityChange.fire()}show(){let t=this.isHidden();this._ckBreadcrumbsVisible.set(!0),this.domNode.classList.toggle("hidden",!1),t&&this._onDidVisibilityChange.fire()}revealLast(){this._widget.revealLast()}update(){this._breadcrumbsDisposables.clear();let t=ro.getCanonicalUri(this._editorGroup.activeEditor,{supportSideBySide:1}),e=this.isHidden();if(!t||!this._fileService.hasProvider(t))return this._ckBreadcrumbsPossible.set(!1),e?!1:(this.hide(),!0);let i=ro.getOriginalUri(this._editorGroup.activeEditor,{supportSideBySide:1});this.show(),this._ckBreadcrumbsPossible.set(!0);let n=this._instantiationService.createInstance(qT,i??t,this._editorGroup.activeEditorPane);this._model.value=n,this.domNode.classList.toggle("backslash-path",this._labelService.getSeparator(t.scheme,t.authority)==="\\");let o=()=>{this.domNode.classList.toggle("relative-path",n.isRelative());let c=this._cfShowIcons.getValue(),p={...this._options,showFileIcons:this._options.showFileIcons&&c,showSymbolIcons:this._options.showSymbolIcons&&c},h=n.getElements().map(m=>m instanceof mS?new Qz(n,m,p,this._labels,this._hoverDelegate):new Yz(n,m,p));h.length===0?(this._widget.setEnabled(!1),this._widget.setItems([new class extends Ow{render(m){m.innerText=u("empty","no elements")}equals(m){return m===this}dispose(){}}])):(this._widget.setEnabled(!0),this._widget.setItems(h),this._widget.reveal(h[h.length-1]))},s=n.onDidUpdate(o),a=this._cfShowIcons.onDidChange(o);o(),this._breadcrumbsDisposables.clear(),this._breadcrumbsDisposables.add(s),this._breadcrumbsDisposables.add(le(()=>this._model.clear())),this._breadcrumbsDisposables.add(a),this._breadcrumbsDisposables.add(le(()=>this._widget.setItems([])));let l=()=>{let c=this._cfTitleScrollbarSizing.getValue()??"default";this._widget.setHorizontalScrollbarSize(Vi.SCROLLBAR_SIZES[c])};l();let d=this._cfTitleScrollbarSizing.onDidChange(l);return this._breadcrumbsDisposables.add(d),this._breadcrumbsDisposables.add({dispose:()=>{this._breadcrumbsPickerShowing&&this._contextViewService.hideContextView({source:this})}}),e!==this.isHidden()}_onFocusEvent(t){t.item&&this._breadcrumbsPickerShowing&&(this._breadcrumbsPickerIgnoreOnceItem=void 0,this._widget.setSelection(t.item))}_onSelectEvent(t){if(!t.item)return;if(t.item===this._breadcrumbsPickerIgnoreOnceItem){this._breadcrumbsPickerIgnoreOnceItem=void 0,this._widget.setFocused(void 0),this._widget.setSelection(void 0);return}let{element:e}=t.item;this._editorGroup.focus();let i=this._getEditorGroup(t.payload);if(i!==void 0){this._widget.setFocused(void 0),this._widget.setSelection(void 0),this._revealInEditor(t,e,i);return}if(this._cfUseQuickPick.getValue()){this._widget.setFocused(void 0),this._widget.setSelection(void 0),this._quickInputService.quickAccess.show(e instanceof $T?"@":"");return}let n,o;this._contextViewService.showContextView({render:s=>{t.item instanceof Qz?n=this._instantiationService.createInstance(XT,s,t.item.model.resource):t.item instanceof Yz&&(n=this._instantiationService.createInstance(Xz,s,t.item.model.resource));let a=n.onWillPickElement(()=>this._contextViewService.hideContextView({source:this,didPick:!0})),l=Zs.getInstance(ue(this.domNode)).onDidChange(()=>this._contextViewService.hideContextView({source:this})),d=Er(s),c=d.onDidBlur(()=>{this._breadcrumbsPickerIgnoreOnceItem=this._widget.isDOMFocused()?t.item:void 0,this._contextViewService.hideContextView({source:this})});return this._breadcrumbsPickerShowing=!0,this._updateCkBreadcrumbsActive(),In(n,a,l,d,c)},getAnchor:()=>{if(!o){let s=ue(this.domNode),a=s.innerWidth-8,l=Math.min(s.innerHeight*.7,300),d=Math.min(a,Math.max(240,a/4.17)),c=8,p,h=Oi(t.node.firstChild),m=h.top+h.height+c;m+l>=s.innerHeight&&(l=s.innerHeight-m-30);let f=h.left;if(f+d>=a&&(f=a-d),t.payload instanceof _i){let g=d-2*c;p=t.payload.posx-f,p>g&&(f=Math.min(a-d,f+p-g),p=g)}else p=h.left+h.width*.3-f;n.show(e,l,d,c,Math.max(0,p)),o={x:f,y:m}}return o},onHide:s=>{s?.didPick||n.restoreViewState(),this._breadcrumbsPickerShowing=!1,this._updateCkBreadcrumbsActive(),s?.source===this&&(this._widget.setFocused(void 0),this._widget.setSelection(void 0)),n.dispose()}})}_updateCkBreadcrumbsActive(){let t=this._widget.isDOMFocused()||this._breadcrumbsPickerShowing;this._ckBreadcrumbsActive.set(t)}async _revealInEditor(t,e,i,n=!1){if(e instanceof mS)if(e.kind===0)await this._editorService.openEditor({resource:e.uri,options:{pinned:n}},i);else{let o=this._widget.getItems(),s=o.indexOf(t.item);this._widget.setFocused(o[s+1]),this._widget.setSelection(o[s+1],Vi.Payload_Pick)}else e.outline.reveal(e,{pinned:n},i===Vl,!1)}_getEditorGroup(t){return t===Vi.Payload_RevealAside?Vl:t===Vi.Payload_Reveal?Zp:void 0}};Vi=E([b(3,re),b(4,so),b(5,ne),b(6,ki),b(7,Ei),b(8,$e),b(9,hi),b(10,se),b(11,sp)],Vi);var Tv=class{constructor(t,e,i,n,o,s){this._container=t;this._editorGroup=e;this._options=i;this._instantiationService=o;let a=this._disposables.add(bl.IsEnabled.bindTo(n));this._disposables.add(a.onDidChange(()=>{let l=a.getValue();!l&&this._control?(this._controlDisposables.clear(),this._control=void 0,this._onDidEnablementChange.fire()):l&&!this._control&&(this._control=this.createControl(),this._control.update(),this._onDidEnablementChange.fire())})),a.getValue()&&(this._control=this.createControl()),this._disposables.add(s.onDidChangeFileSystemProviderRegistrations(l=>{this._control?.model&&this._control.model.resource.scheme!==l.scheme||this._control?.update()&&this._onDidEnablementChange.fire()}))}_disposables=new B;_controlDisposables=new B;_control;get control(){return this._control}_onDidEnablementChange=this._disposables.add(new x);get onDidEnablementChange(){return this._onDidEnablementChange.event}_onDidVisibilityChange=this._disposables.add(new x);get onDidVisibilityChange(){return this._onDidVisibilityChange.event}createControl(){let t=this._controlDisposables.add(this._instantiationService.createInstance(Vi,this._container,this._options,this._editorGroup));return this._controlDisposables.add(t.onDidVisibilityChange(()=>this._onDidVisibilityChange.fire())),t}dispose(){this._disposables.dispose(),this._controlDisposables.dispose()}};Tv=E([b(3,se),b(4,ne),b(5,Ei)],Tv);he(class extends Me{constructor(){super({id:"breadcrumbs.toggle",title:{...ie("cmd.toggle","Toggle Breadcrumbs"),mnemonicTitle:u({key:"miBreadcrumbs",comment:["&& denotes a mnemonic"]},"Toggle &&Breadcrumbs")},category:$t.View,toggled:{condition:P.equals("config.breadcrumbs.enabled",!0),title:u("cmd.toggle2","Toggle Breadcrumbs"),mnemonicTitle:u({key:"miBreadcrumbs2",comment:["&& denotes a mnemonic"]},"Toggle &&Breadcrumbs")},menu:[{id:V.CommandPalette},{id:V.MenubarAppearanceMenu,group:"4_editor",order:2},{id:V.NotebookToolbar,group:"notebookLayout",order:2},{id:V.StickyScrollContext},{id:V.NotebookStickyScrollContext,group:"notebookView",order:2}]})}run(t){let e=t.get(se),i=bl.IsEnabled.bindTo(e).getValue();bl.IsEnabled.bindTo(e).updateValue(!i)}});function mZ(r,t){let e=r.get(gn),n=r.get(sp).getWidget(e.activeGroup.id);if(n){let o=ls(n.getItems());n.setFocused(o),t&&n.setSelection(o,Vi.Payload_Pick)}}he(class extends Me{constructor(){super({id:"breadcrumbs.focusAndSelect",title:ie("cmd.focusAndSelect","Focus and Select Breadcrumbs"),precondition:Vi.CK_BreadcrumbsVisible,keybinding:{weight:200,primary:3161,when:Vi.CK_BreadcrumbsPossible},f1:!0})}run(t,...e){mZ(t,!0)}});he(class extends Me{constructor(){super({id:"breadcrumbs.focus",title:ie("cmd.focus","Focus Breadcrumbs"),precondition:Vi.CK_BreadcrumbsVisible,keybinding:{weight:200,primary:3157,when:Vi.CK_BreadcrumbsPossible},f1:!0})}run(t,...e){mZ(t,!1)}});wt.registerCommandAndKeybindingRule({id:"breadcrumbs.toggleToOn",weight:200,primary:3161,when:P.not("config.breadcrumbs.enabled"),handler:async r=>{let t=r.get(ne),e=r.get(se),i=bl.IsEnabled.bindTo(e);return i.getValue()||(await i.updateValue(!0),await To(50)),t.invokeFunction(mZ,!0)}});wt.registerCommandAndKeybindingRule({id:"breadcrumbs.focusNext",weight:200,primary:17,secondary:[2065],mac:{primary:17,secondary:[529]},when:P.and(Vi.CK_BreadcrumbsVisible,Vi.CK_BreadcrumbsActive),handler(r){let t=r.get(gn),i=r.get(sp).getWidget(t.activeGroup.id);i&&i.focusNext()}});wt.registerCommandAndKeybindingRule({id:"breadcrumbs.focusPrevious",weight:200,primary:15,secondary:[2063],mac:{primary:15,secondary:[527]},when:P.and(Vi.CK_BreadcrumbsVisible,Vi.CK_BreadcrumbsActive),handler(r){let t=r.get(gn),i=r.get(sp).getWidget(t.activeGroup.id);i&&i.focusPrev()}});wt.registerCommandAndKeybindingRule({id:"breadcrumbs.focusNextWithPicker",weight:201,primary:2065,mac:{primary:529},when:P.and(Vi.CK_BreadcrumbsVisible,Vi.CK_BreadcrumbsActive,Ih),handler(r){let t=r.get(gn),i=r.get(sp).getWidget(t.activeGroup.id);i&&i.focusNext()}});wt.registerCommandAndKeybindingRule({id:"breadcrumbs.focusPreviousWithPicker",weight:201,primary:2063,mac:{primary:527},when:P.and(Vi.CK_BreadcrumbsVisible,Vi.CK_BreadcrumbsActive,Ih),handler(r){let t=r.get(gn),i=r.get(sp).getWidget(t.activeGroup.id);i&&i.focusPrev()}});wt.registerCommandAndKeybindingRule({id:"breadcrumbs.selectFocused",weight:200,primary:3,secondary:[18],when:P.and(Vi.CK_BreadcrumbsVisible,Vi.CK_BreadcrumbsActive),handler(r){let t=r.get(gn),i=r.get(sp).getWidget(t.activeGroup.id);i&&i.setSelection(i.getFocused(),Vi.Payload_Pick)}});wt.registerCommandAndKeybindingRule({id:"breadcrumbs.revealFocused",weight:200,primary:10,secondary:[2051],when:P.and(Vi.CK_BreadcrumbsVisible,Vi.CK_BreadcrumbsActive),handler(r){let t=r.get(gn),i=r.get(sp).getWidget(t.activeGroup.id);i&&i.setSelection(i.getFocused(),Vi.Payload_Reveal)}});wt.registerCommandAndKeybindingRule({id:"breadcrumbs.selectEditor",weight:201,primary:9,when:P.and(Vi.CK_BreadcrumbsVisible,Vi.CK_BreadcrumbsActive),handler(r){let t=r.get(gn),i=r.get(sp).getWidget(t.activeGroup.id);i&&(i.setFocused(void 0),i.setSelection(void 0),t.activeGroup.activeEditorPane?.focus())}});wt.registerCommandAndKeybindingRule({id:"breadcrumbs.revealFocusedFromTreeAside",weight:200,primary:2051,when:P.and(Vi.CK_BreadcrumbsVisible,Vi.CK_BreadcrumbsActive,Ih),handler(r){let t=r.get($e),i=r.get(Wo).lastFocusedList;if(!(i instanceof hb)&&!(i instanceof is))return;let n=i.getFocus()[0];if(Z.isUri(n?.resource))return t.openEditor({resource:n.resource,options:{pinned:!0}},Vl);let o=i.getInput();if(o&&typeof o.outlineKind=="string")return o.reveal(n,{pinned:!0,preserveFocus:!1},!0,!1)}});var yM=class extends Me{constructor(e,i,n){super(e);this.commandId=i;this.commandArgs=n}run(e){return e.get(ct).executeCommand(this.commandId,this.commandArgs)}};var jme=class extends yM{static LABEL=u("splitEditorGroupUp","Split Editor Up");constructor(){super({id:iZ,title:ie("splitEditorGroupUp","Split Editor Up"),f1:!0,keybinding:{weight:200,primary:mo(2089,2141)},category:$t.View},iZ)}},Xme=class extends yM{static LABEL=u("splitEditorGroupDown","Split Editor Down");constructor(){super({id:nZ,title:ie("splitEditorGroupDown","Split Editor Down"),f1:!0,keybinding:{weight:200,primary:mo(2089,2141)},category:$t.View},nZ)}};var Zz=class extends et{constructor(e,i,n){super(e,i,de.asClassName(N.close));this.commandService=n}static ID="workbench.action.closeActiveEditor";static LABEL=u("closeEditor","Close Editor");run(e){return this.commandService.executeCommand(hM,void 0,e)}};Zz=E([b(2,ct)],Zz);var _v=class extends et{constructor(e,i,n){super(e,i,de.asClassName(N.pinned));this.commandService=n}static ID="workbench.action.unpinActiveEditor";static LABEL=u("unpinEditor","Unpin Editor");run(e){return this.commandService.executeCommand(tZ,void 0,e)}};_v=E([b(2,ct)],_v);var Dv=class extends et{constructor(e,i,n){super(e,i,de.asClassName(N.close));this.editorGroupService=n}static ID="workbench.action.closeActiveEditor";static LABEL=u("closeOneEditor","Close");async run(e){let i=e?this.editorGroupService.getGroup(e.groupId):this.editorGroupService.activeGroup;if(!i)return;let n=e?.editorIndex!==void 0?i.getEditorByIndex(e.editorIndex):i.activeEditor;if(!n)return;let o=[];i.isSelected(n)?o.push(...i.selectedEditors):o.push(n);for(let s of o)await i.closeEditor(s,{preserveFocus:e?.preserveFocus})}};Dv=E([b(2,gn)],Dv);var gZ=class extends Me{groupsToClose(t){let e=[],i=t.getGroups(2);for(let n=i.length-1;n>=0;n--)e.push(i[n]);return e}async run(t){let e=t.get($e),i=t.get(bt),n=t.get(Cu),o=t.get(gn),s=t.get(qm),a=t.get(Ta),l=new Set,d=new Set,c=new Set,p=new Map;for(let{editor:h,groupId:m}of e.getEditors(1,{excludeSticky:this.excludeSticky})){let f=!1;if(h.closeHandler?f=h.closeHandler.showConfirm():f=h.isDirty()&&!h.isSaving(),!!f)if(typeof h.closeHandler?.confirm=="function"){let g=p.get(h.typeId);g||(g=new Set,p.set(h.typeId,g)),g.add({editor:h,groupId:m})}else!h.hasCapability(4)&&s.getAutoSaveMode(h).mode===3?d.add({editor:h,groupId:m}):Po&&(St||ci)&&!h.hasCapability(4)&&s.getAutoSaveMode(h).mode===4?c.add({editor:h,groupId:m}):l.add({editor:h,groupId:m})}if(l.size>0){let h=Array.from(l.values());switch(await this.revealEditorsToConfirm(h,o),await a.showSaveConfirm(h.map(({editor:f})=>f instanceof Fo?f.primary.getName():f.getName()))){case 2:return;case 1:await this.revertEditors(e,i,n,h);break;case 0:await e.save(h,{reason:1});break}}for(let[,h]of p){let m=Array.from(h.values());await this.revealEditorsToConfirm(m,o);let f=await m.at(0)?.editor.closeHandler?.confirm?.(m);if(typeof f=="number")switch(f){case 2:return;case 1:await this.revertEditors(e,i,n,m);break;case 0:await e.save(m,{reason:1});break}}if(d.size>0){let h=Array.from(d.values());await e.save(h,{reason:3})}if(c.size>0){let h=Array.from(c.values());await e.save(h,{reason:4})}return this.doCloseAll(o)}revertEditors(t,e,i,n){return i.withProgress({location:10,delay:800,title:u("reverting","Reverting Editors...")},()=>this.doRevertEditors(t,e,n))}async doRevertEditors(t,e,i){try{await t.revert(i)}catch(n){e.error(n),await t.revert(i,{soft:!0})}}async revealEditorsToConfirm(t,e){try{let i=new Set;for(let{editor:n,groupId:o}of t){if(i.has(o))continue;i.add(o),await e.getGroup(o)?.openEditor(n)}}catch{}}async doCloseAll(t){await Promise.all(this.groupsToClose(t).map(e=>e.closeAllEditors({excludeSticky:this.excludeSticky})))}},Yme=class r extends gZ{static ID="workbench.action.closeAllEditors";static LABEL=ie("closeAllEditors","Close All Editors");constructor(){super({id:r.ID,title:r.LABEL,f1:!0,keybinding:{weight:200,primary:mo(2089,2101)},icon:N.closeAll,category:$t.View})}get excludeSticky(){return!0}};var Qme=class r extends Me{static ID="workbench.action.navigateForward";static LABEL=u("navigateForward","Go Forward");constructor(){super({id:r.ID,title:{...ie("navigateForward","Go Forward"),mnemonicTitle:u({key:"miForward",comment:["&& denotes a mnemonic"]},"&&Forward")},f1:!0,icon:N.arrowRight,precondition:P.has("canNavigateForward"),keybinding:{weight:200,win:{primary:529},mac:{primary:1368},linux:{primary:3160}},menu:[{id:V.MenubarGoMenu,group:"1_history_nav",order:2},{id:V.CommandCenter,order:2}]})}async run(t){await t.get(FP).goForward(0)}},Zme=class r extends Me{static ID="workbench.action.navigateBack";static LABEL=u("navigateBack","Go Back");constructor(){super({id:r.ID,title:{...ie("navigateBack","Go Back"),mnemonicTitle:u({key:"miBack",comment:["&& denotes a mnemonic"]},"&&Back")},f1:!0,precondition:P.has("canNavigateBack"),icon:N.arrowLeft,keybinding:{weight:200,win:{primary:527},mac:{primary:344},linux:{primary:2648}},menu:[{id:V.MenubarGoMenu,group:"1_history_nav",order:1},{id:V.CommandCenter,order:1}]})}async run(t){await t.get(FP).goBack(0)}};var Jme=class extends yM{static ID="workbench.action.splitEditorToLeftGroup";static LABEL=u("splitEditorToLeftGroup","Split Editor into Left Group");constructor(){super({id:"workbench.action.splitEditorToLeftGroup",title:ie("splitEditorToLeftGroup","Split Editor into Left Group"),f1:!0,category:$t.View},Wme,{to:"left",by:"group"})}};var fZ=q("treeViewsDndService");gi(fZ,$z,1);var Jz=class extends R{constructor(e){super();this.model=e;this._register(this.model.onDidModelChange(i=>{let n=i.editorIndex??i.editor;n!==void 0&&!this.filter(n)||this._onDidModelChange.fire(i)}))}_onDidModelChange=this._register(new x);onDidModelChange=this._onDidModelChange.event;get id(){return this.model.id}get isLocked(){return this.model.isLocked}get stickyCount(){return this.model.stickyCount}get activeEditor(){return this.model.activeEditor&&this.filter(this.model.activeEditor)?this.model.activeEditor:null}get previewEditor(){return this.model.previewEditor&&this.filter(this.model.previewEditor)?this.model.previewEditor:null}get selectedEditors(){return this.model.selectedEditors.filter(e=>this.filter(e))}isPinned(e){return this.model.isPinned(e)}isTransient(e){return this.model.isTransient(e)}isSticky(e){return this.model.isSticky(e)}isActive(e){return this.model.isActive(e)}isSelected(e){return this.model.isSelected(e)}isFirst(e){return this.model.isFirst(e,this.getEditors(1))}isLast(e){return this.model.isLast(e,this.getEditors(1))}getEditors(e,i){return this.model.getEditors(e,i).filter(o=>this.filter(o))}findEditor(e,i){let n=this.model.findEditor(e,i);if(n)return this.filter(n[1])?n:void 0}},YT=class extends Jz{get count(){return this.model.stickyCount}getEditors(t,e){return e?.excludeSticky?[]:t===1?this.model.getEditors(1).slice(0,this.model.stickyCount):super.getEditors(t,e)}isSticky(t){return!0}getEditorByIndex(t){return t<this.count?this.model.getEditorByIndex(t):void 0}indexOf(t,e,i){let n=this.model.indexOf(t,e,i);return n<0||n>=this.model.stickyCount?-1:n}contains(t,e){let i=this.model.indexOf(t,void 0,e);return i>=0&&i<this.model.stickyCount}filter(t){return this.model.isSticky(t)}},QT=class extends Jz{get count(){return this.model.count-this.model.stickyCount}get stickyCount(){return 0}isSticky(t){return!1}getEditors(t,e){return t===1?this.model.getEditors(1).slice(this.model.stickyCount):super.getEditors(t,e)}getEditorByIndex(t){return t>=0?this.model.getEditorByIndex(t+this.model.stickyCount):void 0}indexOf(t,e,i){let n=this.model.indexOf(t,e,i);return n<this.model.stickyCount||n>=this.model.count?-1:n-this.model.stickyCount}contains(t,e){let i=this.model.indexOf(t,void 0,e);return i>=this.model.stickyCount&&i<this.model.count}filter(t){return!this.model.isSticky(t)}};var Fr=class extends ic{constructor(e,i,n,o,s,a,l,d,c,p,h,m,f,g,v,I,y){super(e,i,n,o,s,a,l,d,c,p,h,m,I,y);this.editorService=f;this.pathService=g;this.treeViewsDragAndDropService=v;(async()=>this.path=await this.pathService.path)(),this._register(this.tabResourceLabels.onDidChangeDecorations(()=>this.doHandleDecorationsChange()))}static SCROLLBAR_SIZES={default:3,large:10};static TAB_WIDTH={compact:38,shrink:80,fit:120};static DRAG_OVER_OPEN_TAB_THRESHOLD=1500;static MOUSE_WHEEL_EVENT_THRESHOLD=150;static MOUSE_WHEEL_DISTANCE_THRESHOLD=1.5;titleContainer;tabsAndActionsContainer;tabsContainer;tabsScrollbar;tabSizingFixedDisposables;closeEditorAction=this._register(this.instantiationService.createInstance(Dv,Dv.ID,Dv.LABEL));unpinEditorAction=this._register(this.instantiationService.createInstance(_v,_v.ID,_v.LABEL));tabResourceLabels=this._register(this.instantiationService.createInstance(tc,hS));tabLabels=[];activeTabLabel;tabActionBars=[];tabDisposables=[];dimensions={container:Ge.None,available:Ge.None};layoutScheduler=this._register(new yt);blockRevealActiveTab;path=St?Zn:Xt;lastMouseWheelEventTime=0;isMouseOverTabs=!1;create(e){super.create(e),this.titleContainer=e,this.tabsAndActionsContainer=document.createElement("div"),this.tabsAndActionsContainer.classList.add("tabs-and-actions-container"),this.titleContainer.appendChild(this.tabsAndActionsContainer),this.tabsContainer=document.createElement("div"),this.tabsContainer.setAttribute("role","tablist"),this.tabsContainer.draggable=!0,this.tabsContainer.classList.add("tabs-container"),this._register(yi.addTarget(this.tabsContainer)),this.tabSizingFixedDisposables=this._register(new B),this.updateTabSizing(!1),this.tabsScrollbar=this.createTabsScrollbar(this.tabsContainer),this.tabsAndActionsContainer.appendChild(this.tabsScrollbar.getDomNode()),this.registerTabsContainerListeners(this.tabsContainer,this.tabsScrollbar),this.createEditorActionsToolBar(this.tabsAndActionsContainer,["editor-actions"]),this.updateTabsControlVisibility()}createTabsScrollbar(e){let i=this._register(new bw(e,{horizontal:1,horizontalScrollbarSize:this.getTabsScrollbarSizing(),vertical:2,scrollYToX:!0,useShadows:!1}));return this._register(i.onScroll(n=>{n.scrollLeftChanged&&(e.scrollLeft=n.scrollLeft)})),i}updateTabsScrollbarSizing(){this.tabsScrollbar?.updateOptions({horizontalScrollbarSize:this.getTabsScrollbarSizing()})}updateTabSizing(e){let[i,n]=$v(this.tabsContainer,this.tabSizingFixedDisposables);n.clear();let o=this.groupsView.partOptions;o.tabSizing==="fixed"?(i.style.setProperty("--tab-sizing-fixed-min-width",`${o.tabSizingFixedMinWidth}px`),i.style.setProperty("--tab-sizing-fixed-max-width",`${o.tabSizingFixedMaxWidth}px`),n.add(F(i,Q.MOUSE_ENTER,()=>{this.isMouseOverTabs=!0})),n.add(F(i,Q.MOUSE_LEAVE,()=>{this.isMouseOverTabs=!1,this.updateTabsFixedWidth(!1)}))):e&&(i.style.removeProperty("--tab-sizing-fixed-min-width"),i.style.removeProperty("--tab-sizing-fixed-max-width"),this.updateTabsFixedWidth(!1))}updateTabsFixedWidth(e){this.forEachTab((i,n,o)=>{if(e){let{width:s}=o.getBoundingClientRect();o.style.setProperty("--tab-sizing-current-width",`${s}px`)}else o.style.removeProperty("--tab-sizing-current-width")})}getTabsScrollbarSizing(){return this.groupsView.partOptions.titleScrollbarSizing!=="large"?Fr.SCROLLBAR_SIZES.default:Fr.SCROLLBAR_SIZES.large}registerTabsContainerListeners(e,i){this._register(F(e,Q.SCROLL,()=>{e.classList.contains("scroll")&&i.setScrollPosition({scrollLeft:e.scrollLeft})}));for(let a of[At.Tap,Q.DBLCLICK])this._register(F(e,a,l=>{if(a===Q.DBLCLICK){if(l.target!==e)return}else if(l.tapCount!==2||l.initialTarget!==e)return;Ve.stop(l),this.editorService.openEditor({resource:void 0,options:{pinned:!0,index:this.groupView.count,override:uw.id}},this.groupView.id)}));this._register(F(e,Q.MOUSE_DOWN,a=>{a.button===1&&a.preventDefault()})),ci&&this._register(F(e,Q.MOUSE_UP,a=>{a.button===1&&a.preventDefault()}));let n,o=!1;this._register(new wl(e,{onDragStart:a=>{o=this.onGroupDragStart(a,e)},onDrag:a=>{n=a},onDragEnter:a=>{if(e.classList.add("scroll"),a.target===e){if(!this.isSupportedDropTransfer(a)){a.dataTransfer&&(a.dataTransfer.dropEffect="none");return}this.editorTransfer.hasData(Ad.prototype)||a.dataTransfer&&(a.dataTransfer.dropEffect="copy"),this.updateDropFeedback(e,!0,a)}},onDragLeave:a=>{this.updateDropFeedback(e,!1,a),e.classList.remove("scroll")},onDragEnd:a=>{this.updateDropFeedback(e,!1,a),e.classList.remove("scroll"),this.onGroupDragEnd(a,n,e,o)},onDrop:a=>{if(this.updateDropFeedback(e,!1,a),e.classList.remove("scroll"),a.target===e){let l=this.groupTransfer.hasData(Od.prototype);this.onDrop(a,l?this.groupView.count:this.tabsModel.count,e)}}})),this._register(F(e,Q.MOUSE_WHEEL,a=>{let l=this.groupView.activeEditor;if(!l||this.groupView.count<2)return;if(this.groupsView.partOptions.scrollToSwitchTabs===!0){if(a.shiftKey)return}else if(!a.shiftKey)return;let d=Date.now();if(d-this.lastMouseWheelEventTime<Fr.MOUSE_WHEEL_EVENT_THRESHOLD-2*(Math.abs(a.deltaX)+Math.abs(a.deltaY)))return;this.lastMouseWheelEventTime=d;let c;if(a.deltaX+a.deltaY<-Fr.MOUSE_WHEEL_DISTANCE_THRESHOLD)c=-1;else if(a.deltaX+a.deltaY>Fr.MOUSE_WHEEL_DISTANCE_THRESHOLD)c=1;else return;let p=this.groupView.getEditorByIndex(this.groupView.getIndexOfEditor(l)+c);p&&(this.groupView.openEditor(p),Ve.stop(a,!0))}));let s=a=>{Ve.stop(a);let l=e;Za(a)&&(l=new _i(ue(this.parent),a)),this.contextMenuService.showContextMenu({getAnchor:()=>l,menuId:V.EditorTabsBarContext,contextKeyService:this.contextKeyService,menuActionOptions:{shouldForwardArgs:!0},getActionsContext:()=>({groupId:this.groupView.id}),getKeyBinding:d=>this.getKeybinding(d),onHide:()=>this.groupView.focus()})};this._register(F(e,At.Contextmenu,a=>s(a))),this._register(F(e,Q.CONTEXT_MENU,a=>s(a)))}doHandleDecorationsChange(){this.layout(this.dimensions)}updateEditorActionsToolbar(){super.updateEditorActionsToolbar(),this.layout(this.dimensions)}openEditor(e,i){let n=this.handleOpenedEditors();return i?.focusTabControl&&this.withTab(e,(o,s,a)=>a.focus()),n}openEditors(e){return this.handleOpenedEditors()}handleOpenedEditors(){this.updateTabsControlVisibility();let[e,i]=$v(this.tabsContainer,this.tabsScrollbar);for(let l=e.children.length;l<this.tabsModel.count;l++)e.appendChild(this.createTab(l,e,i));let n=this.didActiveEditorChange(),o=this.activeTabLabel,s=this.tabLabels.length;this.computeTabLabels();let a=!1;return n||s!==this.tabLabels.length||!this.equalsEditorInputLabel(o,this.activeTabLabel)?(this.redraw({forceRevealActiveTab:!0}),a=!0):this.layout(this.dimensions,{forceRevealActiveTab:!0}),a}didActiveEditorChange(){return!!(!this.activeTabLabel?.editor&&this.tabsModel.activeEditor||this.activeTabLabel?.editor&&!this.tabsModel.activeEditor||!this.activeTabLabel?.editor||!this.tabsModel.isActive(this.activeTabLabel.editor))}equalsEditorInputLabel(e,i){return e===i?!0:!e||!i?!1:e.name===i.name&&e.description===i.description&&e.forceDescription===i.forceDescription&&e.title===i.title&&e.ariaLabel===i.ariaLabel}beforeCloseEditor(e){if(this.isMouseOverTabs&&this.groupsView.partOptions.tabSizing==="fixed"){let i=this.tabsModel.isLast(e);this.updateTabsFixedWidth(!i)}}closeEditor(e){this.handleClosedEditors()}closeEditors(e){this.handleClosedEditors()}handleClosedEditors(){if(this.tabsModel.count){let e=Yt(this.tabsContainer);for(;e.children.length>this.tabsModel.count;)e.lastChild?.remove(),_e(this.tabDisposables.pop());this.computeTabLabels(),this.redraw({forceRevealActiveTab:!0})}else this.tabsContainer&&ai(this.tabsContainer),this.tabDisposables=_e(this.tabDisposables),this.tabResourceLabels.clear(),this.tabLabels=[],this.activeTabLabel=void 0,this.tabActionBars=[],this.clearEditorActionsToolbar(),this.updateTabsControlVisibility()}moveEditor(e,i,n){let o=this.tabLabels[i];this.tabLabels.splice(i,1),this.tabLabels.splice(n,0,o),this.forEachTab((s,a,l,d,c,p)=>{this.redrawTab(s,a,l,d,c,p)},Math.min(i,n),Math.max(i,n)),this.layout(this.dimensions,{forceRevealActiveTab:!0})}pinEditor(e){this.withTab(e,(i,n,o,s,a)=>this.redrawTabLabel(i,n,o,s,a))}stickEditor(e){this.doHandleStickyEditorChange(e)}unstickEditor(e){this.doHandleStickyEditorChange(e)}doHandleStickyEditorChange(e){this.withTab(e,(i,n,o,s,a,l)=>this.redrawTab(i,n,o,s,a,l)),this.forEachTab((i,n,o,s,a)=>{this.redrawTabBorders(n,o)}),this.layout(this.dimensions,{forceRevealActiveTab:!0})}setActive(e){this.forEachTab((i,n,o,s,a,l)=>{this.redrawTabSelectedActiveAndDirty(e,i,o,l)}),this.updateEditorActionsToolbar(),this.layout(this.dimensions,{forceRevealActiveTab:!0})}updateEditorSelections(){this.forEachTab((e,i,n,o,s,a)=>{this.redrawTabSelectedActiveAndDirty(this.groupsView.activeGroup===this.groupView,e,n,a)})}updateEditorLabelScheduler=this._register(new Ye(()=>this.doUpdateEditorLabels(),0));updateEditorLabel(e){this.updateEditorLabelScheduler.schedule()}doUpdateEditorLabels(){this.computeTabLabels(),this.forEachTab((e,i,n,o,s)=>{this.redrawTabLabel(e,i,n,o,s)}),this.layout(this.dimensions)}updateEditorDirty(e){this.withTab(e,(i,n,o,s,a,l)=>this.redrawTabSelectedActiveAndDirty(this.groupsView.activeGroup===this.groupView,i,o,l))}updateOptions(e,i){super.updateOptions(e,i),e.labelFormat!==i.labelFormat&&this.computeTabLabels(),e.titleScrollbarSizing!==i.titleScrollbarSizing&&this.updateTabsScrollbarSizing(),e.alwaysShowEditorActions!==i.alwaysShowEditorActions&&this.updateEditorActionsToolbar(),(e.tabSizingFixedMinWidth!==i.tabSizingFixedMinWidth||e.tabSizingFixedMaxWidth!==i.tabSizingFixedMaxWidth||e.tabSizing!==i.tabSizing)&&this.updateTabSizing(!0),(e.labelFormat!==i.labelFormat||e.tabActionLocation!==i.tabActionLocation||e.tabActionCloseVisibility!==i.tabActionCloseVisibility||e.tabActionUnpinVisibility!==i.tabActionUnpinVisibility||e.tabSizing!==i.tabSizing||e.pinnedTabSizing!==i.pinnedTabSizing||e.showIcons!==i.showIcons||e.hasIcons!==i.hasIcons||e.highlightModifiedTabs!==i.highlightModifiedTabs||e.wrapTabs!==i.wrapTabs||!sn(e.decorations,i.decorations))&&this.redraw()}updateStyles(){this.redraw()}forEachTab(e,i,n){this.tabsModel.getEditors(1).forEach((o,s)=>{typeof i=="number"&&i>s||typeof n=="number"&&n<s||this.doWithTab(s,o,e)})}withTab(e,i){this.doWithTab(this.tabsModel.indexOf(e),e,i)}doWithTab(e,i,n){let s=Yt(this.tabsContainer).children[e],a=this.tabResourceLabels.get(e),l=this.tabLabels[e],d=this.tabActionBars[e];s&&a&&l&&n(i,e,s,a,l,d)}createTab(e,i,n){let o=document.createElement("div");o.draggable=!0,o.setAttribute("role","tab"),o.classList.add("tab"),this._register(yi.addTarget(o));let s=document.createElement("div");s.classList.add("tab-border-top-container"),o.appendChild(s);let a=this.tabResourceLabels.create(o,{hoverDelegate:this.getHoverDelegate()}),l=document.createElement("div");l.classList.add("tab-actions"),o.appendChild(l);let d=this,c=new gS({groupId:this.groupView.id,get editorIndex(){return d.toEditorIndex(e)}}),p=new Fi(l,{ariaLabel:u("ariaLabelTabActions","Tab actions"),actionRunner:c}),h=p.onWillRun(I=>{I.action.id===this.closeEditorAction.id&&this.blockRevealActiveTabOnce()}),m=In(p,h,le(wS(this.tabActionBars,p))),f=document.createElement("div");f.classList.add("tab-fade-hider"),o.appendChild(f);let g=document.createElement("div");g.classList.add("tab-border-bottom-container"),o.appendChild(g);let v=this.registerTabListeners(o,e,i,n);return this.tabDisposables.push(In(v,m,c,a)),o}toEditorIndex(e){let i=Yt(this.tabsModel.getEditorByIndex(e));return this.groupView.getIndexOfEditor(i)}lastSingleSelectSelectedEditor;registerTabListeners(e,i,n,o){let s=new B,a=async(p,h)=>{if(e.blur(),Za(p)&&(p.button!==0||ye&&p.ctrlKey)){p.button===1&&p.preventDefault();return}if(this.originatesFromTabActionBar(p))return;let m=this.tabsModel.getEditorByIndex(i);if(m)if(p.shiftKey){let f;if(this.lastSingleSelectSelectedEditor&&this.tabsModel.isSelected(this.lastSingleSelectSelectedEditor))f=this.lastSingleSelectSelectedEditor;else{let g=Yt(this.groupView.activeEditor);this.lastSingleSelectSelectedEditor=g,f=g}await this.selectEditorsBetween(m,f)}else if(p.ctrlKey&&!ye||p.metaKey&&ye)this.tabsModel.isSelected(m)?await this.unselectEditor(m):(await this.selectEditor(m),this.lastSingleSelectSelectedEditor=m);else{let f=this.tabsModel.isSelected(m)?this.groupView.selectedEditors.filter(g=>!g.matches(m)):[];await this.groupView.openEditor(m,{preserveFocus:h,activation:1},{inactiveSelection:f,focusTabControl:!0})}},l=p=>{Ve.stop(p);let h=this.tabsModel.getEditorByIndex(i);h&&this.onTabContextMenu(h,p,e)};s.add(F(e,Q.MOUSE_DOWN,p=>a(p,!1))),s.add(F(e,At.Tap,p=>a(p,!0))),s.add(F(e,At.Change,p=>{o.setScrollPosition({scrollLeft:o.getScrollPosition().scrollLeft-p.translationX})})),s.add(F(e,Q.MOUSE_UP,async p=>{if(Ve.stop(p),e.blur(),Za(p)&&(p.button!==0||ye&&p.ctrlKey)||this.originatesFromTabActionBar(p))return;!(p.ctrlKey&&!ye||p.metaKey&&ye)&&!p.shiftKey&&this.groupView.selectedEditors.length>1&&await this.unselectAllEditors()})),s.add(F(e,Q.AUXCLICK,p=>{if(p.button===1){Ve.stop(p,!0);let h=this.tabsModel.getEditorByIndex(i);if(h){if(r1(this.tabsModel,h,2,this.groupsView.partOptions))return;this.blockRevealActiveTabOnce(),this.closeEditorAction.run({groupId:this.groupView.id,editorIndex:this.groupView.getIndexOfEditor(h)})}}})),s.add(F(e,Q.KEY_DOWN,p=>{let h=new ut(p);h.shiftKey&&h.keyCode===68&&l(p)})),s.add(F(e,At.Contextmenu,p=>{l(p)})),s.add(F(e,Q.KEY_UP,p=>{let h=new ut(p),m=!1;if(h.equals(3)||h.equals(10)){m=!0;let f=this.tabsModel.getEditorByIndex(i);f&&this.groupView.openEditor(f)}else if([15,17,16,18,14,13].some(f=>h.equals(f))){let f=this.toEditorIndex(i);h.equals(15)||h.equals(16)?f=f-1:h.equals(17)||h.equals(18)?f=f+1:h.equals(14)?f=0:f=this.groupView.count-1;let g=this.groupView.getEditorByIndex(f);g&&(m=!0,this.groupView.openEditor(g,{preserveFocus:!0},{focusTabControl:!0}))}m&&Ve.stop(p,!0),o.setScrollPosition({scrollLeft:n.scrollLeft})}));for(let p of[At.Tap,Q.DBLCLICK])s.add(F(e,p,h=>{if(p===Q.DBLCLICK)Ve.stop(h);else if(h.tapCount!==2)return;let m=this.tabsModel.getEditorByIndex(i);if(m&&this.tabsModel.isPinned(m))switch(this.groupsView.partOptions.doubleClickTabToToggleEditorGroupSizes){case"maximize":this.groupsView.toggleMaximizeGroup(this.groupView);break;case"expand":this.groupsView.toggleExpandGroup(this.groupView);break;case"off":break}else this.groupView.pinEditor(m)}));s.add(F(e,Q.CONTEXT_MENU,p=>{Ve.stop(p,!0);let h=this.tabsModel.getEditorByIndex(i);h&&this.onTabContextMenu(h,p,e)},!0));let d,c=!1;return s.add(new wl(e,{onDragStart:p=>{let h=this.tabsModel.getEditorByIndex(i);if(!h)return;c=this.isNewWindowOperation(p);let m=this.groupView.selectedEditors;if(this.editorTransfer.setData(m.map(f=>new Ad({editor:f,groupId:this.groupView.id})),Ad.prototype),p.dataTransfer)if(p.dataTransfer.effectAllowed="copyMove",m.length>1){let f=`${h.getName()} + ${m.length-1}`;c1(p,f,"monaco-editor-group-drag-image",this.getColor(Ss),this.getColor(Nl))}else p.dataTransfer.setDragImage(e,0,0);this.doFillResourceDataTransfers(m,p,c),eo(ue(this.parent),()=>this.updateDropFeedback(e,!1,p,i))},onDrag:p=>{d=p},onDragEnter:p=>{if(!this.isSupportedDropTransfer(p)){p.dataTransfer&&(p.dataTransfer.dropEffect="none");return}this.editorTransfer.hasData(Ad.prototype)||p.dataTransfer&&(p.dataTransfer.dropEffect="copy"),this.updateDropFeedback(e,!0,p,i)},onDragOver:(p,h)=>{if(h>=Fr.DRAG_OVER_OPEN_TAB_THRESHOLD){let m=this.tabsModel.getEditorByIndex(i);m&&this.tabsModel.activeEditor!==m&&this.groupView.openEditor(m,{preserveFocus:!0})}this.updateDropFeedback(e,!0,p,i)},onDragEnd:async p=>{this.updateDropFeedback(e,!1,p,i);let h=this.editorTransfer.getData(Ad.prototype);if(this.editorTransfer.clearData(Ad.prototype),!c||IF()||!h||h.length===0)return;let m=await this.maybeCreateAuxiliaryEditorPartAt(p,e);if(!m)return;let f=m.activeGroup,g=h.map(v=>({editor:v.identifier.editor}));this.isMoveOperation(d??p,f.id,h[0].identifier.editor)?this.groupView.moveEditors(g,f):this.groupView.copyEditors(g,f),f.focus()},onDrop:p=>{this.updateDropFeedback(e,!1,p,i);let h=i;this.getTabDragOverLocation(p,e)==="right"&&h++,this.onDrop(p,h,n)}})),s}isSupportedDropTransfer(e){if(this.groupTransfer.hasData(Od.prototype)){let i=this.groupTransfer.getData(Od.prototype);return!(Array.isArray(i)&&i.length>0&&i[0].identifier===this.groupView.id)}return!!(this.editorTransfer.hasData(Ad.prototype)||e.dataTransfer&&e.dataTransfer.types.length>0)}updateDropFeedback(e,i,n,o){let s=typeof o=="number",a;i?s?a=this.computeDropTarget(n,o,e):a={leftElement:e.lastElementChild,rightElement:void 0}:a=void 0,this.updateDropTarget(a)}dropTarget;updateDropTarget(e){let i=this.dropTarget;if(i===e||i&&e&&i.leftElement===e.leftElement&&i.rightElement===e.rightElement)return;let n="drop-target-left",o="drop-target-right";i&&(i.leftElement?.classList.remove(n),i.rightElement?.classList.remove(o)),e&&(e.leftElement?.classList.add(n),e.rightElement?.classList.add(o)),this.dropTarget=e}getTabDragOverLocation(e,i){let n=i.getBoundingClientRect();return e.clientX-n.left<=n.width/2?"left":"right"}computeDropTarget(e,i,n){let o=this.getTabDragOverLocation(e,n)==="left",s=i===this.tabsModel.count-1;if(o&&i===0)return{leftElement:void 0,rightElement:n};if(!o&&s)return{leftElement:n,rightElement:void 0};let l=o?n.previousElementSibling:n,d=o?n:n.nextElementSibling;return{leftElement:l,rightElement:d}}async selectEditor(e){this.groupView.isActive(e)||await this.groupView.setSelection(e,this.groupView.selectedEditors)}async selectEditorsBetween(e,i){let n=this.groupView.getIndexOfEditor(e);if(n===-1)throw new _t;let o=this.groupView.getIndexOfEditor(i);if(o===-1)throw new _t;let s=this.groupView.selectedEditors,a=o;for(;a>=0&&a<=this.groupView.count-1;){a=o<n?a-1:a+1;let h=this.groupView.getEditorByIndex(a);if(!h||!this.groupView.isSelected(h))break;s=s.filter(m=>!m.matches(h))}let l=o<n?o:n,d=o<n?n:o,c=this.groupView.getEditors(1).slice(l,d+1);for(let h of c)this.groupView.isSelected(h)||s.push(h);let p=s.filter(h=>!h.matches(e));await this.groupView.setSelection(e,p)}async unselectEditor(e){let i=this.groupView.isActive(e);if(i&&this.groupView.selectedEditors.length===1)return;let n=Yt(this.groupView.activeEditor);if(i){let s=this.groupView.getEditors(0);for(let a=1;a<s.length;a++){let l=s[a];if(this.groupView.isSelected(l)){n=l;break}}}let o=this.groupView.selectedEditors.filter(s=>!s.matches(e)&&!s.matches(n));await this.groupView.setSelection(n,o)}async unselectAllEditors(){if(this.groupView.selectedEditors.length>1){let e=Yt(this.groupView.activeEditor);await this.groupView.setSelection(e,[])}}computeTabLabels(){let{labelFormat:e}=this.groupsView.partOptions,{verbosity:i,shortenDuplicates:n}=this.getLabelConfigFlags(e),o=[],s=-1;this.tabsModel.getEditors(1).forEach((a,l)=>{o.push({editor:a,name:a.getName(),description:a.getDescription(i),forceDescription:a.hasCapability(64),title:a.getTitle(2),ariaLabel:H1(a,l,this.groupView,this.editorPartsView.count)}),a===this.tabsModel.activeEditor&&(s=l)}),n&&this.shortenTabLabels(o),this.tabLabels=o,this.activeTabLabel=o[s]}shortenTabLabels(e){let i=new Map;for(let n of e)typeof n.description=="string"?mm(i,n.name,[]).push(n):n.description="";for(let[,n]of i){if(n.length===1&&!n[0].forceDescription){n[0].description="";continue}let o=new Map;for(let d of n)mm(o,d.description,[]).push(d);let s=!1;for(let[,d]of o)if(!s&&d.length>1){let[c,...p]=d.map(({editor:h})=>h.getDescription(2));s=p.some(h=>h!==c)}if(s){o.clear();for(let d of n)d.description=d.editor.getDescription(2),mm(o,d.description,[]).push(d)}let a=[];for(let[d]of o)a.push(d);if(a.length===1){for(let d of o.get(a[0])||[])d.forceDescription||(d.description="");continue}let l=UN(a,this.path.sep);a.forEach((d,c)=>{for(let p of o.get(d)||[])p.description=l[c]})}}getLabelConfigFlags(e){switch(e){case"short":return{verbosity:0,shortenDuplicates:!1};case"medium":return{verbosity:1,shortenDuplicates:!1};case"long":return{verbosity:2,shortenDuplicates:!1};default:return{verbosity:1,shortenDuplicates:!0}}}redraw(e){if(this.tabsAndActionsContainer){let i=this.getColor(Ile);!i&&oa(this.theme.type)&&(i=this.getColor(VF)||this.getColor(Oe)),i?(this.tabsAndActionsContainer.classList.add("tabs-border-bottom"),this.tabsAndActionsContainer.style.setProperty("--tabs-border-bottom-color",i.toString())):(this.tabsAndActionsContainer.classList.remove("tabs-border-bottom"),this.tabsAndActionsContainer.style.removeProperty("--tabs-border-bottom-color"))}this.forEachTab((i,n,o,s,a,l)=>{this.redrawTab(i,n,o,s,a,l)}),this.updateEditorActionsToolbar(),this.layout(this.dimensions,e)}redrawTab(e,i,n,o,s,a){let l=this.tabsModel.isSticky(i),d=this.groupsView.partOptions;this.redrawTabLabel(e,i,n,o,s);let c=l&&d.tabActionUnpinVisibility,p=!c&&d.tabActionCloseVisibility,h=c||p,m;h?m=c?this.unpinEditorAction:this.closeEditorAction:m=l?this.unpinEditorAction:this.closeEditorAction,a.hasAction(m)||(a.isEmpty()||a.clear(),a.push(m,{icon:!0,label:!1,keybinding:this.getKeybindingLabel(m)})),n.classList.toggle("pinned-action-off",l&&!c),n.classList.toggle("close-action-off",!c&&!p);for(let g of["left","right"])n.classList.toggle(`tab-actions-${g}`,h&&d.tabActionLocation===g);let f=l&&d.pinnedTabSizing==="shrink"?"shrink":d.tabSizing;for(let g of["fit","shrink","fixed"])n.classList.toggle(`sizing-${g}`,f===g);n.classList.toggle("has-icon",d.showIcons&&d.hasIcons),n.classList.toggle("sticky",l);for(let g of["normal","compact","shrink"])n.classList.toggle(`sticky-${g}`,l&&d.pinnedTabSizing===g);if(!d.wrapTabs&&l&&d.pinnedTabSizing!=="normal"){let g=0;switch(d.pinnedTabSizing){case"compact":g=Fr.TAB_WIDTH.compact;break;case"shrink":g=Fr.TAB_WIDTH.shrink;break}n.style.left=`${i*g}px`}else n.style.left="auto";this.redrawTabBorders(i,n),this.redrawTabSelectedActiveAndDirty(this.groupsView.activeGroup===this.groupView,e,n,a)}redrawTabLabel(e,i,n,o,s){let a=this.groupsView.partOptions,l,d=!1,c=!!a.decorations?.badges,p=!!a.decorations?.colors,h;a.pinnedTabSizing==="compact"&&this.tabsModel.isSticky(i)?(l=a.showIcons&&a.hasIcons?"":s.name?.charAt(0).toUpperCase(),h="",d=!0,c=!1):(l=s.name,h=s.description||""),s.ariaLabel&&(n.setAttribute("aria-label",s.ariaLabel),n.setAttribute("aria-description","")),o.setResource({name:l,description:h,resource:ro.getOriginalUri(e,{supportSideBySide:3})},{title:this.getHoverTitle(e),extraClasses:cn(["tab-label",c?"tab-label-has-badge":void 0].concat(e.getLabelExtraClasses())),italic:!this.tabsModel.isPinned(e),forceLabel:d,fileDecorations:{colors:p,badges:c},icon:e.getIcon(),hideIcon:a.showIcons===!1});let m=ro.getOriginalUri(e,{supportSideBySide:1});m?n.setAttribute("data-resource-name",Ns(m)):n.removeAttribute("data-resource-name")}redrawTabSelectedActiveAndDirty(e,i,n,o){let s=this.tabsModel.isActive(i),a=this.doRedrawTabDirty(e,s,i,n);this.doRedrawTabActive(e,!a,i,n,o)}doRedrawTabActive(e,i,n,o,s){let a=this.tabsModel.isActive(n),l=this.tabsModel.isSelected(n);if(o.classList.toggle("active",a),o.classList.toggle("selected",l),o.setAttribute("aria-selected",a?"true":"false"),o.tabIndex=a?0:-1,s.setFocusable(a),a){let c=this.getColor(e?Gw:ple);o.classList.toggle("tab-border-bottom",!!c),o.style.setProperty("--tab-border-bottom-color",c??"")}let d=null;i&&(a&&(d=this.getColor(e?pL:hle)),d===null&&l&&(d=this.getColor(mle))),o.classList.toggle("tab-border-top",!!d),o.style.setProperty("--tab-border-top-color",d??"")}doRedrawTabDirty(e,i,n,o){let s=!1;if(n.isDirty()&&!n.isSaving())if(o.classList.add("dirty"),this.groupsView.partOptions.highlightModifiedTabs){let a;e&&i?a=this.getColor(qw):e&&!i?a=this.getColor(OF):!e&&i?a=this.getColor(fle):a=this.getColor(ble),a&&(s=!0,o.classList.add("dirty-border-top"),o.style.setProperty("--tab-dirty-border-top-color",a))}else o.classList.remove("dirty-border-top"),o.style.removeProperty("--tab-dirty-border-top-color");else o.classList.remove("dirty","dirty-border-top"),o.style.removeProperty("--tab-dirty-border-top-color");return s}redrawTabBorders(e,i){let o=this.tabsModel.isSticky(e)&&this.tabsModel.stickyCount===e+1,s=this.tabsModel.stickyCount!==this.tabsModel.count,a=(o&&s?this.getColor(ule):void 0)||this.getColor(VF)||this.getColor(Oe);i.style.borderRight=a?`1px solid ${a}`:"",i.style.outlineColor=this.getColor(fi)||""}prepareEditorActions(e){return this.groupsView.activeGroup===this.groupView?e:{primary:this.groupsView.partOptions.alwaysShowEditorActions?e.primary:e.primary.filter(n=>n.id===mM),secondary:e.secondary}}getHeight(){return this.dimensions.used?this.dimensions.used.height:this.computeHeight()}computeHeight(){let e;return this.visible?this.groupsView.partOptions.wrapTabs&&this.tabsAndActionsContainer?.classList.contains("wrapping")?e=this.tabsAndActionsContainer.offsetHeight:e=this.tabHeight:e=0,e}layout(e,i){if(Object.assign(this.dimensions,e),this.visible){if(!this.layoutScheduler.value){let n=eo(ue(this.parent),()=>{this.doLayout(this.dimensions,this.layoutScheduler.value?.options),this.layoutScheduler.clear()});this.layoutScheduler.value={options:i,dispose:()=>n.dispose()}}i?.forceRevealActiveTab&&(this.layoutScheduler.value.options={...this.layoutScheduler.value.options,forceRevealActiveTab:!0})}return this.dimensions.used||(this.dimensions.used=new Ge(e.container.width,this.computeHeight())),this.dimensions.used}doLayout(e,i){e.container!==Ge.None&&e.available!==Ge.None&&this.doLayoutTabs(e,i);let n=this.dimensions.used,o=this.dimensions.used=new Ge(e.container.width,this.computeHeight());n&&n.height!==o.height&&this.groupView.relayout()}doLayoutTabs(e,i){this.doLayoutTabsWrapping(e)||this.doLayoutTabsNonWrapping(i)}doLayoutTabsWrapping(e){let[i,n,o,s]=$v(this.tabsAndActionsContainer,this.tabsContainer,this.editorActionsToolbarContainer,this.tabsScrollbar),a=i.classList.contains("wrapping"),l=a;function d(c){l=c,i.classList.toggle("wrapping",l),n.style.setProperty("--last-tab-margin-right",l?`${o.offsetWidth}px`:"0");for(let p of n.children)p.classList.remove("last-in-row")}if(this.groupsView.partOptions.wrapTabs){let c=n.offsetWidth,p=n.scrollWidth,h=()=>{let m=this.getLastTab();return m?!(m.offsetWidth+o.offsetWidth-e.available.width>1):!0};(l||p>c&&h())&&d(!0),l&&(n.offsetHeight>e.available.height||p===c&&n.offsetHeight===this.tabHeight||!h())&&d(!1)}else a&&d(!1);if(l&&!a){let c=n.offsetWidth;s.setScrollDimensions({width:c,scrollWidth:c})}if(l){let c=new Map,p,h;for(let m of n.children){let f=m,g=f.offsetTop;g!==p&&(p=g,h&&c.set(h,!0)),h=f,c.set(f,!1)}h&&c.set(h,!0);for(let[m,f]of c)m.classList.toggle("last-in-row",f)}return l}doLayoutTabsNonWrapping(e){let[i,n]=$v(this.tabsContainer,this.tabsScrollbar),o=i.offsetWidth,s=i.scrollWidth,a=0;if(this.tabsModel.stickyCount>0){let S=0;switch(this.groupsView.partOptions.pinnedTabSizing){case"compact":S=Fr.TAB_WIDTH.compact;break;case"shrink":S=Fr.TAB_WIDTH.shrink;break}a=this.tabsModel.stickyCount*S}let l=this.tabsModel.activeEditor?this.getTabAndIndex(this.tabsModel.activeEditor):void 0,[d,c]=l??[void 0,void 0],p=this.groupsView.partOptions.pinnedTabSizing!=="normal"&&typeof c=="number"&&this.tabsModel.isSticky(c),h=o-a;this.tabsModel.stickyCount>0&&h<Fr.TAB_WIDTH.fit?(i.classList.add("disable-sticky-tabs"),h=o,a=0,p=!1):i.classList.remove("disable-sticky-tabs");let m,f;!this.blockRevealActiveTab&&d&&(m=d.offsetLeft,f=d.offsetWidth);let{width:g,scrollWidth:v}=n.getScrollDimensions();n.setScrollDimensions({width:o,scrollWidth:s});let I=g!==o||v!==s;if(this.blockRevealActiveTab||typeof m!="number"||typeof f!="number"||p||!I&&!e?.forceRevealActiveTab){this.blockRevealActiveTab=!1;return}let y=n.getScrollPosition().scrollLeft,w=f<=h,C=m-a;w&&y+h<C+f?n.setScrollPosition({scrollLeft:y+(C+f-(y+h))}):(y>C||!w)&&n.setScrollPosition({scrollLeft:C})}updateTabsControlVisibility(){Yt(this.tabsAndActionsContainer).classList.toggle("empty",!this.visible),!this.visible&&this.dimensions&&(this.dimensions.used=void 0)}get visible(){return this.tabsModel.count>0}getTabAndIndex(e){let i=this.tabsModel.indexOf(e),n=this.getTabAtIndex(i);if(n)return[n,i]}getTabAtIndex(e){if(e>=0)return Yt(this.tabsContainer).children[e]}getLastTab(){return this.getTabAtIndex(this.tabsModel.count-1)}blockRevealActiveTabOnce(){this.blockRevealActiveTab=!0}originatesFromTabActionBar(e){let i;return Za(e)?i=e.target||e.srcElement:i=e.initialTarget,!!Q4(i,"action-item","tab")}async onDrop(e,i,n){Ve.stop(e,!0),this.updateDropFeedback(n,!1,e,i),n.classList.remove("scroll");let o=this.tabsModel instanceof QT?i+this.groupView.stickyCount:i,s={sticky:this.tabsModel instanceof YT&&this.tabsModel.stickyCount===o,index:o};if(this.groupTransfer.hasData(Od.prototype)){let a=this.groupTransfer.getData(Od.prototype);if(Array.isArray(a)&&a.length>0){let l=this.editorPartsView.getGroup(a[0].identifier);if(l){let d={index:o};this.isMoveOperation(e,l.id)||(d.mode=0),this.groupsView.mergeGroup(l,this.groupView,d)}this.groupView.focus(),this.groupTransfer.clearData(Od.prototype)}}else if(this.editorTransfer.hasData(Ad.prototype)){let a=this.editorTransfer.getData(Ad.prototype);if(Array.isArray(a)&&a.length>0){let l=this.editorPartsView.getGroup(a[0].identifier.groupId);if(l)for(let d of a){let c=d.identifier.editor;if(l.id!==d.identifier.groupId)continue;let p=l.getIndexOfEditor(c);l===this.groupView&&p<o&&o--,this.isMoveOperation(e,d.identifier.groupId,c)?l.moveEditor(c,this.groupView,{...s,index:o}):l.copyEditor(c,this.groupView,{...s,index:o}),o++}}this.groupView.focus(),this.editorTransfer.clearData(Ad.prototype)}else if(this.treeItemsTransfer.hasData(KT.prototype)){let a=this.treeItemsTransfer.getData(KT.prototype);if(Array.isArray(a)&&a.length>0){let l=[];for(let d of a){let c=await this.treeViewsDragAndDropService.removeDragOperationTransfer(d.identifier);if(c){let p=await Xae(c);l.push(...p.map(h=>({...h,options:{...h.options,pinned:!0,index:o}})))}}this.editorService.openEditors(l,this.groupView,{validateTrust:!0})}this.treeItemsTransfer.clearData(KT.prototype)}else this.instantiationService.createInstance(Vw,{allowWorkspaceOpen:!1}).handleDrop(e,ue(this.parent),()=>this.groupView,()=>this.groupView.focus(),s)}dispose(){super.dispose(),this.tabDisposables=_e(this.tabDisposables)}};Fr=E([b(5,vt),b(6,ne),b(7,re),b(8,Be),b(9,mi),b(10,ki),b(11,Fe),b(12,$e),b(13,yg),b(14,fZ),b(15,Zw),b(16,Tn)],Fr);Zo((r,t)=>{let e=r.getColor(VF);e&&t.addRule(`
			.monaco-workbench .part.editor > .content .editor-group-container > .title > .tabs-and-actions-container.wrapping .tabs-container > .tab {
				border-bottom: 1px solid ${e};
			}
		`);let i=r.getColor(fi);i&&t.addRule(`
			.monaco-workbench .part.editor > .content .editor-group-container.active > .title .tabs-container > .tab.active,
			.monaco-workbench .part.editor > .content .editor-group-container.active > .title .tabs-container > .tab.active:hover  {
				outline: 1px solid;
				outline-offset: -5px;
			}

			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.selected:not(.active):not(:hover)  {
				outline: 1px dotted;
				outline-offset: -5px;
			}

			.monaco-workbench .part.editor > .content .editor-group-container.active > .title .tabs-container > .tab.active:focus {
				outline-style: dashed;
			}

			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.active {
				outline: 1px dotted;
				outline-offset: -5px;
			}

			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab:hover  {
				outline: 1px dashed;
				outline-offset: -5px;
			}

			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.active > .tab-actions .action-label,
			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.active:hover > .tab-actions .action-label,
			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.dirty > .tab-actions .action-label,
			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.sticky > .tab-actions .action-label,
			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab:hover > .tab-actions .action-label {
				opacity: 1 !important;
			}
		`);let n=r.getColor(Oe);n&&t.addRule(`
			.monaco-workbench .part.editor > .content .editor-group-container > .title .editor-actions {
				outline: 1px solid ${n}
			}
		`);let o=r.getColor(PF);o&&t.addRule(`
			.monaco-workbench .part.editor > .content .editor-group-container.active > .title .tabs-container > .tab:not(.selected):hover {
				background-color: ${o} !important;
			}
		`);let s=r.getColor(dle);s&&t.addRule(`
			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab:not(.selected):hover  {
				background-color: ${s} !important;
			}
		`);let a=r.getColor(MF);a&&t.addRule(`
			.monaco-workbench .part.editor > .content .editor-group-container.active > .title .tabs-container > .tab:not(.selected):hover  {
				color: ${a} !important;
			}
		`);let l=r.getColor(cle);l&&t.addRule(`
			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab:not(.selected):hover  {
				color: ${l} !important;
			}
		`);let d=r.getColor(AF);d&&t.addRule(`
			.monaco-workbench .part.editor > .content .editor-group-container.active > .title .tabs-container > .tab:hover > .tab-border-bottom-container {
				display: block;
				position: absolute;
				left: 0;
				pointer-events: none;
				width: 100%;
				z-index: 10;
				bottom: 0;
				height: 1px;
				background-color: ${d};
			}
		`);let c=r.getColor(gle);if(c&&t.addRule(`
			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab:hover > .tab-border-bottom-container  {
				display: block;
				position: absolute;
				left: 0;
				pointer-events: none;
				width: 100%;
				z-index: 10;
				bottom: 0;
				height: 1px;
				background-color: ${c};
			}
		`),!oa(r.type)&&!ms&&!i){let p=FF(r),h=r.getColor(Hs),m=r.getColor(vle),f=r.getColor(jw),g;m&&h&&(g=m.flatten(h,h,p));let v;m&&h&&f&&h&&(v=m.flatten(h,f,h,p));let I=(k,M,O=!1)=>`
			.monaco-workbench .part.editor > .content:not(.dragged-over) .editor-group-container${O?".active":""} > .title .tabs-container > .tab.sizing-shrink:not(.dragged):not(.sticky-compact):hover > .tab-label > .monaco-icon-label-container::after,
			.monaco-workbench .part.editor > .content:not(.dragged-over) .editor-group-container${O?".active":""} > .title .tabs-container > .tab.sizing-fixed:not(.dragged):not(.sticky-compact):hover > .tab-label > .monaco-icon-label-container::after {
				background: linear-gradient(to left, ${k}, transparent) !important;
			}

			.monaco-workbench .part.editor > .content.dragged-over .editor-group-container${O?".active":""} > .title .tabs-container > .tab.sizing-shrink:not(.dragged):not(.sticky-compact):hover > .tab-label > .monaco-icon-label-container::after,
			.monaco-workbench .part.editor > .content.dragged-over .editor-group-container${O?".active":""} > .title .tabs-container > .tab.sizing-fixed:not(.dragged):not(.sticky-compact):hover > .tab-label > .monaco-icon-label-container::after {
				background: linear-gradient(to left, ${M}, transparent) !important;
			}
		`;if(o&&g&&v){let k=o.flatten(g),M=o.flatten(v);t.addRule(I(k,M,!0))}if(s&&g&&v){let k=s.flatten(g),M=s.flatten(v);t.addRule(I(k,M))}if(f&&v){let k=f.flatten(v);t.addRule(`
				.monaco-workbench .part.editor > .content.dragged-over .editor-group-container.active > .title .tabs-container > .tab.sizing-shrink.dragged-over:not(.active):not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after,
				.monaco-workbench .part.editor > .content.dragged-over .editor-group-container:not(.active) > .title .tabs-container > .tab.sizing-shrink.dragged-over:not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after,
				.monaco-workbench .part.editor > .content.dragged-over .editor-group-container.active > .title .tabs-container > .tab.sizing-fixed.dragged-over:not(.active):not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after,
				.monaco-workbench .part.editor > .content.dragged-over .editor-group-container:not(.active) > .title .tabs-container > .tab.sizing-fixed.dragged-over:not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after {
					background: linear-gradient(to left, ${k}, transparent) !important;
				}
		`)}let y=(k,M,O,K)=>`
				.monaco-workbench .part.editor > .content:not(.dragged-over) .editor-group-container${O?".active":":not(.active)"} > .title .tabs-container > .tab.sizing-shrink${K?".active":""}:not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after,
				.monaco-workbench .part.editor > .content:not(.dragged-over) .editor-group-container${O?".active":":not(.active)"} > .title .tabs-container > .tab.sizing-fixed${K?".active":""}:not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after {
					background: linear-gradient(to left, ${k}, transparent);
				}

				.monaco-workbench .part.editor > .content.dragged-over .editor-group-container${O?".active":":not(.active)"} > .title .tabs-container > .tab.sizing-shrink${K?".active":""}:not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after,
				.monaco-workbench .part.editor > .content.dragged-over .editor-group-container${O?".active":":not(.active)"} > .title .tabs-container > .tab.sizing-fixed${K?".active":""}:not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after {
					background: linear-gradient(to left, ${M}, transparent);
				}
		`,w=r.getColor(BF);if(w&&g&&v){let k=w.flatten(g),M=w.flatten(v);t.addRule(y(k,M,!0,!0))}let C=r.getColor(sle);if(C&&g&&v){let k=C.flatten(g),M=C.flatten(v);t.addRule(y(k,M,!1,!0))}let S=r.getColor(C9);if(S&&g&&v){let k=S.flatten(g),M=S.flatten(v);t.addRule(y(k,M,!0,!1))}let D=r.getColor(ale);if(D&&g&&v){let k=D.flatten(g),M=D.flatten(v);t.addRule(y(k,M,!1,!1))}}});var e5=class extends ic{titleContainer;editorLabel;activeLabel=Object.create(null);breadcrumbsControlFactory;get breadcrumbsControl(){return this.breadcrumbsControlFactory?.control}create(t){super.create(t);let e=this.titleContainer=t;e.draggable=!0,this.registerContainerListeners(e),this._register(yi.addTarget(e));let i=document.createElement("div");i.classList.add("label-container"),e.appendChild(i),this.editorLabel=this._register(this.instantiationService.createInstance(GT,i,{hoverDelegate:this.getHoverDelegate()})).element,this._register(F(this.editorLabel.element,Q.CLICK,n=>this.onTitleLabelClick(n))),this.breadcrumbsControlFactory=this._register(this.instantiationService.createInstance(Tv,i,this.groupView,{showFileIcons:!1,showSymbolIcons:!0,showDecorationColors:!1,widgetStyles:{...uF,breadcrumbsBackground:j.transparent.toString()},showPlaceholder:!1})),this._register(this.breadcrumbsControlFactory.onDidEnablementChange(()=>this.handleBreadcrumbsEnablementChange())),e.classList.toggle("breadcrumbs",!!this.breadcrumbsControl),this._register(le(()=>e.classList.remove("breadcrumbs"))),this.createEditorActionsToolBar(e,["title-actions"])}registerContainerListeners(t){let e,i=!1;this._register(new wl(t,{onDragStart:n=>{i=this.onGroupDragStart(n,t)},onDrag:n=>{e=n},onDragEnd:n=>{this.onGroupDragEnd(n,e,t,i)}})),this._register(F(t,Q.DBLCLICK,n=>this.onTitleDoubleClick(n))),this._register(F(t,Q.AUXCLICK,n=>this.onTitleAuxClick(n))),this._register(F(t,At.Tap,n=>this.onTitleTap(n)));for(let n of[Q.CONTEXT_MENU,At.Contextmenu])this._register(F(t,n,o=>{this.tabsModel.activeEditor&&this.onTabContextMenu(this.tabsModel.activeEditor,o,t)}))}onTitleLabelClick(t){Ve.stop(t,!1),setTimeout(()=>this.quickInputService.quickAccess.show())}onTitleDoubleClick(t){Ve.stop(t),this.groupView.pinEditor()}onTitleAuxClick(t){t.button===1&&this.tabsModel.activeEditor&&(Ve.stop(t,!0),r1(this.tabsModel,this.tabsModel.activeEditor,2,this.groupsView.partOptions)||this.groupView.closeEditor(this.tabsModel.activeEditor))}onTitleTap(t){let e=t.initialTarget;!on(e)||!this.editorLabel||!$n(e,this.editorLabel.element)||setTimeout(()=>this.quickInputService.quickAccess.show(),50)}openEditor(t){return this.doHandleOpenEditor()}openEditors(t){return this.doHandleOpenEditor()}doHandleOpenEditor(){let t=this.ifActiveEditorChanged(()=>this.redraw());return t||this.ifActiveEditorPropertiesChanged(()=>this.redraw()),t}beforeCloseEditor(t){}closeEditor(t){this.ifActiveEditorChanged(()=>this.redraw())}closeEditors(t){this.ifActiveEditorChanged(()=>this.redraw())}moveEditor(t,e,i){this.ifActiveEditorChanged(()=>this.redraw())}pinEditor(t){this.ifEditorIsActive(t,()=>this.redraw())}stickEditor(t){}unstickEditor(t){}setActive(t){this.redraw()}updateEditorSelections(){}updateEditorLabel(t){this.ifEditorIsActive(t,()=>this.redraw())}updateEditorDirty(t){this.ifEditorIsActive(t,()=>{let e=Yt(this.titleContainer);t.isDirty()&&!t.isSaving()?e.classList.add("dirty"):e.classList.remove("dirty")})}updateOptions(t,e){super.updateOptions(t,e),(t.labelFormat!==e.labelFormat||!sn(t.decorations,e.decorations))&&this.redraw()}updateStyles(){this.redraw()}handleBreadcrumbsEnablementChange(){Yt(this.titleContainer).classList.toggle("breadcrumbs",!!this.breadcrumbsControl),this.redraw()}ifActiveEditorChanged(t){return!this.activeLabel.editor&&this.tabsModel.activeEditor||this.activeLabel.editor&&!this.tabsModel.activeEditor||!this.activeLabel.editor||!this.tabsModel.isActive(this.activeLabel.editor)?(t(),!0):!1}ifActiveEditorPropertiesChanged(t){!this.activeLabel.editor||!this.tabsModel.activeEditor||this.activeLabel.pinned!==this.tabsModel.isPinned(this.tabsModel.activeEditor)&&t()}ifEditorIsActive(t,e){this.tabsModel.isActive(t)&&e()}redraw(){let t=this.tabsModel.activeEditor??void 0,e=this.groupsView.partOptions,i=t?this.tabsModel.isPinned(t):!1,n=this.groupsView.activeGroup===this.groupView;this.activeLabel={editor:t,pinned:i},this.breadcrumbsControl&&(n?(this.breadcrumbsControl.update(),this.breadcrumbsControl.domNode.classList.toggle("preview",!i)):this.breadcrumbsControl.hide());let[o,s]=$v(this.titleContainer,this.editorLabel);if(!t)o.classList.remove("dirty"),s.clear(),this.clearEditorActionsToolbar();else{this.updateEditorDirty(t);let{labelFormat:a}=this.groupsView.partOptions,l;this.breadcrumbsControl&&!this.breadcrumbsControl.isHidden()||a==="default"&&!n?l="":l=t.getDescription(this.getVerbosity(a))||"",s.setResource({resource:ro.getOriginalUri(t,{supportSideBySide:3}),name:t.getName(),description:l},{title:this.getHoverTitle(t),italic:!i,extraClasses:["single-tab","title-label"].concat(t.getLabelExtraClasses()),fileDecorations:{colors:!!e.decorations?.colors,badges:!!e.decorations?.badges},icon:t.getIcon(),hideIcon:e.showIcons===!1}),n?o.style.color=this.getColor(ng)||"":o.style.color=this.getColor(lle)||"",this.updateEditorActionsToolbar()}}getVerbosity(t){switch(t){case"short":return 0;case"long":return 2;default:return 1}}prepareEditorActions(t){return this.groupsView.activeGroup===this.groupView?t:{primary:this.groupsView.partOptions.alwaysShowEditorActions?t.primary:t.primary.filter(i=>i.id===hM||i.id===mM),secondary:t.secondary}}getHeight(){return this.tabHeight}layout(t){return this.breadcrumbsControl?.layout(void 0),new Ge(t.container.width,this.getHeight())}};var ZT=class extends R{constructor(e,i,n,o,s,a){super();this.parent=e;this.groupsView=n;this.groupView=o;this.model=s;this.instantiationService=a;let l=this._register(new YT(this.model)),d=this._register(new QT(this.model));this.stickyEditorTabsControl=this._register(this.instantiationService.createInstance(Fr,this.parent,i,this.groupsView,this.groupView,l)),this.unstickyEditorTabsControl=this._register(this.instantiationService.createInstance(Fr,this.parent,i,this.groupsView,this.groupView,d)),this.handleTabBarsStateChange()}stickyEditorTabsControl;unstickyEditorTabsControl;activeControl;handleTabBarsStateChange(){this.activeControl=this.model.activeEditor?this.getEditorTabsController(this.model.activeEditor):void 0,this.handleTabBarsLayoutChange()}handleTabBarsLayoutChange(){if(this.groupView.count===0)return;let e=this.parent.classList.contains("two-tab-bars"),i=this.groupView.count!==this.groupView.stickyCount&&this.groupView.stickyCount>0;this.parent.classList.toggle("two-tab-bars",i),e!==i&&this.groupView.relayout()}didActiveControlChange(){return this.activeControl!==(this.model.activeEditor?this.getEditorTabsController(this.model.activeEditor):void 0)}getEditorTabsController(e){return this.model.isSticky(e)?this.stickyEditorTabsControl:this.unstickyEditorTabsControl}openEditor(e,i){let n=this.didActiveControlChange(),s=this.getEditorTabsController(e).openEditor(e,i)||n;return s&&this.handleOpenedEditors(),s}openEditors(e){let i=e.filter(d=>this.model.isSticky(d)),n=e.filter(d=>!this.model.isSticky(d)),o=this.didActiveControlChange(),s=this.stickyEditorTabsControl.openEditors(i),a=this.unstickyEditorTabsControl.openEditors(n),l=s||a||o;return l&&this.handleOpenedEditors(),l}handleOpenedEditors(){this.handleTabBarsStateChange()}beforeCloseEditor(e){this.getEditorTabsController(e).beforeCloseEditor(e)}closeEditor(e){this.stickyEditorTabsControl.closeEditor(e),this.unstickyEditorTabsControl.closeEditor(e),this.handleClosedEditors()}closeEditors(e){let i=e.filter(o=>this.model.isSticky(o)),n=e.filter(o=>!this.model.isSticky(o));this.stickyEditorTabsControl.closeEditors(i),this.unstickyEditorTabsControl.closeEditors(n),this.handleClosedEditors()}handleClosedEditors(){this.handleTabBarsStateChange()}moveEditor(e,i,n,o){o?(this.model.isSticky(e)?(this.stickyEditorTabsControl.openEditor(e),this.unstickyEditorTabsControl.closeEditor(e)):(this.stickyEditorTabsControl.closeEditor(e),this.unstickyEditorTabsControl.openEditor(e)),this.handleTabBarsStateChange()):this.model.isSticky(e)?this.stickyEditorTabsControl.moveEditor(e,i,n,o):this.unstickyEditorTabsControl.moveEditor(e,i-this.model.stickyCount,n-this.model.stickyCount,o)}pinEditor(e){this.getEditorTabsController(e).pinEditor(e)}stickEditor(e){this.unstickyEditorTabsControl.closeEditor(e),this.stickyEditorTabsControl.openEditor(e),this.handleTabBarsStateChange()}unstickEditor(e){this.stickyEditorTabsControl.closeEditor(e),this.unstickyEditorTabsControl.openEditor(e),this.handleTabBarsStateChange()}setActive(e){this.stickyEditorTabsControl.setActive(e),this.unstickyEditorTabsControl.setActive(e)}updateEditorSelections(){this.stickyEditorTabsControl.updateEditorSelections(),this.unstickyEditorTabsControl.updateEditorSelections()}updateEditorLabel(e){this.getEditorTabsController(e).updateEditorLabel(e)}updateEditorDirty(e){this.getEditorTabsController(e).updateEditorDirty(e)}updateOptions(e,i){this.stickyEditorTabsControl.updateOptions(e,i),this.unstickyEditorTabsControl.updateOptions(e,i)}layout(e){let i=this.stickyEditorTabsControl.layout(e),n={container:e.container,available:new Ge(e.available.width,e.available.height-i.height)},o=this.unstickyEditorTabsControl.layout(n);return new Ge(e.container.width,i.height+o.height)}getHeight(){return this.stickyEditorTabsControl.getHeight()+this.unstickyEditorTabsControl.getHeight()}dispose(){this.parent.classList.toggle("two-tab-bars",!1),super.dispose()}};ZT=E([b(5,ne)],ZT);var t5=class extends ic{activeEditor=null;prepareEditorActions(t){return{primary:[],secondary:[]}}openEditor(t){return this.handleOpenedEditors()}openEditors(t){return this.handleOpenedEditors()}handleOpenedEditors(){let t=this.activeEditorChanged();return this.activeEditor=this.tabsModel.activeEditor,t}activeEditorChanged(){return!!(!this.activeEditor&&this.tabsModel.activeEditor||this.activeEditor&&!this.tabsModel.activeEditor||!this.activeEditor||!this.tabsModel.isActive(this.activeEditor))}beforeCloseEditor(t){}closeEditor(t){this.handleClosedEditors()}closeEditors(t){this.handleClosedEditors()}handleClosedEditors(){this.activeEditor=this.tabsModel.activeEditor}moveEditor(t,e,i){}pinEditor(t){}stickEditor(t){}unstickEditor(t){}setActive(t){}updateEditorSelections(){}updateEditorLabel(t){}updateEditorDirty(t){}getHeight(){return 0}layout(t){return new Ge(t.container.width,this.getHeight())}};var i5=class extends fc{constructor(e,i,n,o,s,a,l){super(l);this.parent=e;this.editorPartsView=i;this.groupsView=n;this.groupView=o;this.model=s;this.instantiationService=a;this.editorTabsControl=this.createEditorTabsControl(),this.breadcrumbsControlFactory=this.createBreadcrumbsControl()}editorTabsControl;editorTabsControlDisposable=this._register(new B);breadcrumbsControlFactory;breadcrumbsControlDisposables=this._register(new B);get breadcrumbsControl(){return this.breadcrumbsControlFactory?.control}createEditorTabsControl(){let e;switch(this.groupsView.partOptions.showTabs){case"none":e=t5;break;case"single":e=e5;break;case"multiple":default:e=this.groupsView.partOptions.pinnedTabsOnSeparateRow?ZT:Fr;break}let i=this.instantiationService.createInstance(e,this.parent,this.editorPartsView,this.groupsView,this.groupView,this.model);return this.editorTabsControlDisposable.add(i)}createBreadcrumbsControl(){if(this.groupsView.partOptions.showTabs==="single")return;let e=document.createElement("div");e.classList.add("breadcrumbs-below-tabs"),this.parent.appendChild(e);let i=this.breadcrumbsControlDisposables.add(this.instantiationService.createInstance(Tv,e,this.groupView,{showFileIcons:!0,showSymbolIcons:!0,showDecorationColors:!1,showPlaceholder:!0}));return this.breadcrumbsControlDisposables.add(i.onDidEnablementChange(()=>this.groupView.relayout())),this.breadcrumbsControlDisposables.add(i.onDidVisibilityChange(()=>this.groupView.relayout())),i}openEditor(e,i){let n=this.editorTabsControl.openEditor(e,i);this.handleOpenedEditors(n)}openEditors(e){let i=this.editorTabsControl.openEditors(e);this.handleOpenedEditors(i)}handleOpenedEditors(e){e?this.breadcrumbsControl?.update():this.breadcrumbsControl?.revealLast()}beforeCloseEditor(e){return this.editorTabsControl.beforeCloseEditor(e)}closeEditor(e){this.editorTabsControl.closeEditor(e),this.handleClosedEditors()}closeEditors(e){this.editorTabsControl.closeEditors(e),this.handleClosedEditors()}handleClosedEditors(){this.groupView.activeEditor||this.breadcrumbsControl?.update()}moveEditor(e,i,n,o){return this.editorTabsControl.moveEditor(e,i,n,o)}pinEditor(e){return this.editorTabsControl.pinEditor(e)}stickEditor(e){return this.editorTabsControl.stickEditor(e)}unstickEditor(e){return this.editorTabsControl.unstickEditor(e)}setActive(e){return this.editorTabsControl.setActive(e)}updateEditorSelections(){this.editorTabsControl.updateEditorSelections()}updateEditorLabel(e){return this.editorTabsControl.updateEditorLabel(e)}updateEditorDirty(e){return this.editorTabsControl.updateEditorDirty(e)}updateOptions(e,i){e.showTabs!==i.showTabs||i.showTabs!=="single"&&e.pinnedTabsOnSeparateRow!==i.pinnedTabsOnSeparateRow?(this.editorTabsControlDisposable.clear(),this.breadcrumbsControlDisposables.clear(),ai(this.parent),this.editorTabsControl=this.createEditorTabsControl(),this.breadcrumbsControlFactory=this.createBreadcrumbsControl()):this.editorTabsControl.updateOptions(e,i)}layout(e){let i=this.editorTabsControl.layout(e),n;return this.breadcrumbsControl?.isHidden()===!1&&(n=new Ge(e.container.width,Vi.HEIGHT),this.breadcrumbsControl.layout(n)),new Ge(e.container.width,i.height+(n?n.height:0))}getHeight(){let e=this.editorTabsControl.getHeight(),i=this.breadcrumbsControl?.isHidden()===!1?Vi.HEIGHT:0;return{total:e+i,offset:e}}};i5=E([b(5,ne),b(6,Fe)],i5);var gS=class extends jo{constructor(e){super();this.context=e}run(e,i){let n=this.context;return i?.preserveFocus&&(n={...this.context,preserveFocus:!0}),super.run(e,n)}},ic=class extends fc{constructor(e,i,n,o,s,a,l,d,c,p,h,m,f,g){super(m);this.parent=e;this.editorPartsView=i;this.groupsView=n;this.groupView=o;this.tabsModel=s;this.contextMenuService=a;this.instantiationService=l;this.contextKeyService=d;this.keybindingService=c;this.notificationService=p;this.quickInputService=h;this.editorResolverService=f;this.hostService=g;this.contextMenuContextKeyService=this._register(this.contextKeyService.createScoped(e));let v=this._register(this.instantiationService.createChild(new el([re,this.contextMenuContextKeyService])));this.resourceContext=this._register(v.createInstance(zs)),this.editorPinnedContext=ide.bindTo(this.contextMenuContextKeyService),this.editorIsFirstContext=nde.bindTo(this.contextMenuContextKeyService),this.editorIsLastContext=ode.bindTo(this.contextMenuContextKeyService),this.editorStickyContext=G9.bindTo(this.contextMenuContextKeyService),this.editorAvailableEditorIds=j9.bindTo(this.contextMenuContextKeyService),this.editorCanSplitInGroupContext=q9.bindTo(this.contextMenuContextKeyService),this.sideBySideEditorContext=X9.bindTo(this.contextMenuContextKeyService),this.groupLockedContext=Y9.bindTo(this.contextMenuContextKeyService),this.renderDropdownAsChildElement=!1,this.tabsHoverDelegate=gt("mouse"),this.create(e)}editorTransfer=ob.getInstance();groupTransfer=ob.getInstance();treeItemsTransfer=ob.getInstance();static EDITOR_TAB_HEIGHT={normal:35,compact:22};editorActionsToolbarContainer;editorActionsToolbar;editorActionsToolbarDisposables=this._register(new B);editorActionsDisposables=this._register(new B);contextMenuContextKeyService;resourceContext;editorPinnedContext;editorIsFirstContext;editorIsLastContext;editorStickyContext;editorAvailableEditorIds;editorCanSplitInGroupContext;sideBySideEditorContext;groupLockedContext;renderDropdownAsChildElement;tabsHoverDelegate;create(e){this.updateTabHeight()}get editorActionsEnabled(){return this.groupsView.partOptions.editorActionsLocation==="default"&&this.groupsView.partOptions.showTabs!=="none"}createEditorActionsToolBar(e,i){this.editorActionsToolbarContainer=document.createElement("div"),this.editorActionsToolbarContainer.classList.add(...i),e.appendChild(this.editorActionsToolbarContainer),this.handleEditorActionToolBarVisibility(this.editorActionsToolbarContainer)}handleEditorActionToolBarVisibility(e){let i=this.editorActionsEnabled,n=!!this.editorActionsToolbar;i&&!n?this.doCreateEditorActionsToolBar(e):!i&&n&&(this.editorActionsToolbar?.getElement().remove(),this.editorActionsToolbar=void 0,this.editorActionsToolbarDisposables.clear(),this.editorActionsDisposables.clear()),e.classList.toggle("hidden",!i)}doCreateEditorActionsToolBar(e){let i={groupId:this.groupView.id};this.editorActionsToolbar=this.editorActionsToolbarDisposables.add(this.instantiationService.createInstance(ul,e,{actionViewItemProvider:(n,o)=>this.actionViewItemProvider(n,o),orientation:0,ariaLabel:u("ariaLabelEditorActions","Editor actions"),getKeyBinding:n=>this.getKeybinding(n),actionRunner:this.editorActionsToolbarDisposables.add(new gS(i)),anchorAlignmentProvider:()=>1,renderDropdownAsChildElement:this.renderDropdownAsChildElement,telemetrySource:"editorPart",resetMenu:V.EditorTitle,overflowBehavior:{maxItems:9,exempted:qz},highlightToggledItems:!0})),this.editorActionsToolbar.context=i,this.editorActionsToolbarDisposables.add(this.editorActionsToolbar.actionRunner.onDidRun(n=>{n.error&&!vl(n.error)&&this.notificationService.error(n.error)}))}actionViewItemProvider(e,i){let n=this.groupView.activeEditorPane;if(n instanceof oh){let o=n.getActionViewItem(e,i);if(o)return o}return aa(this.instantiationService,e,{...i,menuAsChild:this.renderDropdownAsChildElement})}updateEditorActionsToolbar(){if(!this.editorActionsEnabled)return;this.editorActionsDisposables.clear();let e=this.groupView.createEditorActions(this.editorActionsDisposables);this.editorActionsDisposables.add(e.onDidChange(()=>this.updateEditorActionsToolbar()));let i=Yt(this.editorActionsToolbar),{primary:n,secondary:o}=this.prepareEditorActions(e.actions);i.setActions(Ym(n),Ym(o))}getEditorPaneAwareContextKeyService(){return this.groupView.activeEditorPane?.scopedContextKeyService??this.contextKeyService}clearEditorActionsToolbar(){if(!this.editorActionsEnabled)return;Yt(this.editorActionsToolbar).setActions([],[])}onGroupDragStart(e,i){if(e.target!==i)return!1;let n=this.isNewWindowOperation(e);this.groupTransfer.setData([new Od(this.groupView.id)],Od.prototype),e.dataTransfer&&(e.dataTransfer.effectAllowed="copyMove");let o=!1;if(this.groupsView.partOptions.showTabs==="multiple"?o=this.doFillResourceDataTransfers(this.groupView.getEditors(1),e,n):this.groupView.activeEditor&&(o=this.doFillResourceDataTransfers([this.groupView.activeEditor],e,n)),!o&&po&&e.dataTransfer?.setData(_a.TEXT,String(this.groupView.label)),this.groupView.activeEditor){let s=this.groupView.activeEditor.getName();this.groupsView.partOptions.showTabs==="multiple"&&this.groupView.count>1&&(s=u("draggedEditorGroup","{0} (+{1})",s,this.groupView.count-1)),c1(e,s,"monaco-editor-group-drag-image",this.getColor(Ss),this.getColor(Nl))}return n}async onGroupDragEnd(e,i,n,o){if(this.groupTransfer.clearData(Od.prototype),e.target!==n||!o||IF())return;let s=await this.maybeCreateAuxiliaryEditorPartAt(e,n);if(!s)return;let a=s.activeGroup;this.groupsView.mergeGroup(this.groupView,a.id,{mode:this.isMoveOperation(i??e,a.id)?1:0}),a.focus()}async maybeCreateAuxiliaryEditorPartAt(e,i){let{point:n,display:o}=await this.hostService.getCursorScreenPoint()??{point:{x:e.screenX,y:e.screenY}},s=Gr();if(s.document.visibilityState==="visible"&&s.document.hasFocus()&&n.x>=s.screenX&&n.x<=s.screenX+s.outerWidth&&n.y>=s.screenY&&n.y<=s.screenY+s.outerHeight)return;let a=i.offsetWidth/2,l=30+i.offsetHeight/2,d={x:n.x-a,y:n.y-l};return o&&(d.x<o.x&&(d.x=o.x),d.y<o.y&&(d.y=o.y)),this.editorPartsView.createAuxiliaryEditorPart({bounds:d})}isNewWindowOperation(e){return this.groupsView.partOptions.dragToOpenWindow?!e.altKey:e.altKey}isMoveOperation(e,i,n){return n?.hasCapability(8)?!0:!(e.ctrlKey&&!ye||e.altKey&&ye)||i===this.groupView.id}doFillResourceDataTransfers(e,i,n){return e.length?(this.instantiationService.invokeFunction(g9,e.map(o=>({editor:o,groupId:this.groupView.id})),i,{disableStandardTransfer:n}),!0):!1}onTabContextMenu(e,i,n){this.resourceContext.set(ro.getOriginalUri(e,{supportSideBySide:1})),this.editorPinnedContext.set(this.tabsModel.isPinned(e)),this.editorIsFirstContext.set(this.tabsModel.isFirst(e)),this.editorIsLastContext.set(this.tabsModel.isLast(e)),this.editorStickyContext.set(this.tabsModel.isSticky(e)),this.groupLockedContext.set(this.tabsModel.isLocked),this.editorCanSplitInGroupContext.set(e.hasCapability(32)),this.sideBySideEditorContext.set(e.typeId===Fo.ID),ude(this.editorAvailableEditorIds,e,this.editorResolverService);let o=n;Za(i)&&(o=new _i(ue(n),i)),this.contextMenuService.showContextMenu({getAnchor:()=>o,menuId:V.EditorTitleContext,menuActionOptions:{shouldForwardArgs:!0,arg:this.resourceContext.get()},contextKeyService:this.contextMenuContextKeyService,getActionsContext:()=>({groupId:this.groupView.id,editorIndex:this.groupView.getIndexOfEditor(e)}),getKeyBinding:s=>this.keybindingService.lookupKeybinding(s.id,this.contextMenuContextKeyService),onHide:()=>this.groupsView.activeGroup.focus()})}getKeybinding(e){return this.keybindingService.lookupKeybinding(e.id,this.getEditorPaneAwareContextKeyService())}getKeybindingLabel(e){let i=this.getKeybinding(e);return i?i.getLabel()??void 0:void 0}get tabHeight(){return this.groupsView.partOptions.tabHeight!=="compact"?ic.EDITOR_TAB_HEIGHT.normal:ic.EDITOR_TAB_HEIGHT.compact}getHoverTitle(e){let i=e.getTitle(2);return this.tabsModel.isPinned(e)?i:{markdown:new Sn("",{supportThemeIcons:!0,isTrusted:!0}).appendText(i).appendMarkdown(' (_preview_ [$(gear)](command:workbench.action.openSettings?%5B%22workbench.editor.enablePreview%22%5D "Configure Preview Mode"))'),markdownNotSupportedFallback:i+" (preview)"}}getHoverDelegate(){return this.tabsHoverDelegate}updateTabHeight(){this.parent.style.setProperty("--editor-group-tab-height",`${this.tabHeight}px`)}updateOptions(e,i){e.tabHeight!==i.tabHeight&&this.updateTabHeight(),(e.editorActionsLocation!==i.editorActionsLocation||e.showTabs!==i.showTabs)&&this.editorActionsToolbarContainer&&(this.handleEditorActionToolBarVisibility(this.editorActionsToolbarContainer),this.updateEditorActionsToolbar())}};ic=E([b(5,vt),b(6,ne),b(7,re),b(8,Be),b(9,mi),b(10,ki),b(11,Fe),b(12,Zw),b(13,Tn)],ic);var n5=class extends Me{constructor(e,i,n,o,s){let a=s?jl.toNegated():P.true();super({id:`toggle.${e}`,title:i,metadata:n?{description:n}:void 0,toggled:P.equals(`config.${e}`,!0),menu:[{id:V.TitleBarContext,when:a,order:o,group:"2_config"},{id:V.TitleBarTitleContext,when:a,order:o,group:"2_config"}]});this.section=e}run(e,...i){let n=e.get(se),o=n.getValue(this.section);n.updateValue(this.section,!o)}};he(class extends n5{constructor(){super("window.commandCenter",u("toggle.commandCenter","Command Center"),u("toggle.commandCenterDescription","Toggle visibility of the Command Center in title bar"),1,!1)}});he(class extends n5{constructor(){super("workbench.layoutControl.enabled",u("toggle.layout","Layout Controls"),u("toggle.layoutDescription","Toggle visibility of the Layout Controls in title bar"),2,!0)}});he(class extends Me{constructor(){super({id:"toggle.window.customTitleBarVisibility",title:u("toggle.hideCustomTitleBar","Hide Custom Title Bar"),menu:[{id:V.TitleBarContext,order:0,when:P.equals(Jw.key,"native"),group:"3_toggle"},{id:V.TitleBarTitleContext,order:0,when:P.equals(Jw.key,"native"),group:"3_toggle"}]})}run(t,...e){t.get(se).updateValue("window.customTitleBarVisibility","never")}});he(class extends Me{constructor(){super({id:"toggle.window.customTitleBarVisibility.windowed",title:u("toggle.hideCustomTitleBarInFullScreen","Hide Custom Title Bar In Full Screen"),menu:[{id:V.TitleBarContext,order:1,when:ku,group:"3_toggle"},{id:V.TitleBarTitleContext,order:1,when:ku,group:"3_toggle"}]})}run(t,...e){t.get(se).updateValue("window.customTitleBarVisibility","windowed")}});var bZ=class extends Me{constructor(){super({id:"toggle.toggleCustomTitleBar",title:u("toggle.customTitleBar","Custom Title Bar"),toggled:CL,menu:[{id:V.MenubarAppearanceMenu,order:6,when:P.or(P.and(P.equals(Jw.key,"native"),P.and(P.equals("config.workbench.layoutControl.enabled",!1),P.equals("config.window.commandCenter",!1),P.notEquals("config.workbench.editor.editorActionsLocation","titleBar"),P.notEquals("config.workbench.activityBar.location","top"),P.notEquals("config.workbench.activityBar.location","bottom"))?.negate()),ku),group:"2_workbench_layout"}]})}run(t,...e){let i=t.get(se),n=t.get(re);switch(i.getValue("window.customTitleBarVisibility")){case"never":i.updateValue("window.customTitleBarVisibility","auto");break;case"windowed":{ku.evaluate(n.getContext(null))?i.updateValue("window.customTitleBarVisibility","auto"):i.updateValue("window.customTitleBarVisibility","never");break}case"auto":default:i.updateValue("window.customTitleBarVisibility","never");break}}};he(bZ);he(class extends Me{constructor(){super({id:"showCustomTitleBar",title:ie("showCustomTitleBar","Show Custom Title Bar"),precondition:CL.negate(),f1:!0})}run(t,...e){t.get(se).updateValue("window.customTitleBarVisibility","auto")}});he(class extends Me{constructor(){super({id:"hideCustomTitleBar",title:ie("hideCustomTitleBar","Hide Custom Title Bar"),precondition:CL,f1:!0})}run(t,...e){t.get(se).updateValue("window.customTitleBarVisibility","never")}});he(class extends Me{constructor(){super({id:"hideCustomTitleBarInFullScreen",title:ie("hideCustomTitleBarInFullScreen","Hide Custom Title Bar In Full Screen"),precondition:P.and(CL,ku),f1:!0})}run(t,...e){t.get(se).updateValue("window.customTitleBarVisibility","windowed")}});he(class ap extends Me{static settingsID="workbench.editor.editorActionsLocation";constructor(){let t=P.and(P.equals("config.workbench.editor.showTabs","none").negate(),P.equals(`config.${ap.settingsID}`,"default"))?.negate();super({id:`toggle.${ap.settingsID}`,title:u("toggle.editorActions","Editor Actions"),toggled:P.equals(`config.${ap.settingsID}`,"hidden").negate(),menu:[{id:V.TitleBarContext,order:3,when:t,group:"2_config"},{id:V.TitleBarTitleContext,order:3,when:t,group:"2_config"}]})}run(t,...e){let i=t.get(se),n=t.get(nt),o=i.getValue(ap.settingsID);if(o==="hidden"){if(i.getValue("workbench.editor.showTabs")!=="none")i.updateValue(ap.settingsID,"titleBar");else{let a=n.get(ap.settingsID,0);i.updateValue(ap.settingsID,a??"default")}n.remove(ap.settingsID,0)}else i.updateValue(ap.settingsID,"hidden"),n.store(ap.settingsID,o,0,0)}});var tge={id:Pg,label:u("accounts","Accounts"),tooltip:u("accounts","Accounts"),class:void 0,enabled:!0,run:function(){}},ige={id:Rg,label:u("manage","Manage"),tooltip:u("manage","Manage"),class:void 0,enabled:!0,run:function(){}};var o5=class extends xw{constructor(e,i,n){super("workbench.titleService",n,i);this.instantiationService=e;this._register(this.registerPart(this.mainPart)),this.registerActions(),this.registerAPICommands()}mainPart=this._register(this.createMainTitlebarPart());createMainTitlebarPart(){return this.instantiationService.createInstance(SM)}registerActions(){let e=this;this._register(he(class extends Me{constructor(){super({id:"workbench.action.focusTitleBar",title:ie("focusTitleBar","Focus Title Bar"),category:$t.View,f1:!0})}run(){e.getPartByDocument(pf()).focus()}}))}registerAPICommands(){this._register(tt.registerCommand({id:"registerWindowTitleVariable",handler:(e,i,n)=>{this.registerVariables([{name:i,contextKey:n}])},metadata:{description:"Registers a new title variable",args:[{name:"name",schema:{type:"string"},description:"The name of the variable to register"},{name:"contextKey",schema:{type:"string"},description:"The context key to use for the value of the variable"}]}}))}createAuxiliaryTitlebarPart(e,i){let n=document.createElement("div");n.classList.add("part","titlebar"),n.setAttribute("role","none"),n.style.position="relative",e.insertBefore(n,e.firstChild);let o=new B,s=this.doCreateAuxiliaryTitlebarPart(n,i);return o.add(this.registerPart(s)),o.add(X.runAndSubscribe(s.onDidChange,()=>n.style.height=`${s.height}px`)),s.create(n),this.properties&&s.updateProperties(this.properties),this.variables.size&&s.registerVariables(Array.from(this.variables.values())),X.once(s.onWillDispose)(()=>o.dispose()),s}doCreateAuxiliaryTitlebarPart(e,i){return this.instantiationService.createInstance(fS,e,i,this.mainPart)}onMenubarVisibilityChange=this.mainPart.onMenubarVisibilityChange;properties=void 0;updateProperties(e){this.properties=e;for(let i of this.parts)i.updateProperties(e)}variables=new Map;registerVariables(e){let i=[];for(let n of e)this.variables.has(n.name)||(this.variables.set(n.name,n),i.push(n));for(let n of this.parts)n.registerVariables(i)}};o5=E([b(0,ne),b(1,nt),b(2,Fe)],o5);var JT=class extends Ew{constructor(e,i,n,o,s,a,l,d,c,p,h,m,f,g,v,I){super(e,{hasTitle:!1},d,c,p);this.contextMenuService=o;this.configurationService=s;this.environmentService=a;this.instantiationService=l;this.storageService=c;this.contextKeyService=h;this.hostService=m;this.editorGroupService=f;this.menuService=v;this.keybindingService=I;this.isAuxiliary=n!=="main",this.editorService=g.createScoped(n,this._store),this.editorGroupsContainer=n==="main"?f.mainPart:n,this.windowTitle=this._register(l.createInstance(Jd,i,n)),this.hoverDelegate=this._register(wu()),this.registerListeners(_p(i))}minimumWidth=0;maximumWidth=Number.POSITIVE_INFINITY;get minimumHeight(){let e=si&&CA(),i=this.isCommandCenterVisible||e?Mse:30;return e&&(i=Math.max(i,wee(ue(this.element))?.height??0)),i/(this.preventZoom?qv(ue(this.element)):1)}get maximumHeight(){return this.minimumHeight}_onMenubarVisibilityChange=this._register(new x);onMenubarVisibilityChange=this._onMenubarVisibilityChange.event;_onWillDispose=this._register(new x);onWillDispose=this._onWillDispose.event;rootContainer;windowControlsContainer;dragRegion;title;leftContent;centerContent;rightContent;customMenubar;appIcon;appIconBadge;menubar;lastLayoutDimensions;actionToolBar;actionToolBarDisposable=this._register(new B);editorActionsChangeDisposable=this._register(new B);actionToolBarElement;layoutToolbarMenu;editorToolbarMenuDisposables=this._register(new B);layoutToolbarMenuDisposables=this._register(new B);activityToolbarDisposables=this._register(new B);hoverDelegate;titleDisposables=this._register(new B);titleBarStyle=B3(this.configurationService);isInactive=!1;isAuxiliary;windowTitle;editorService;editorGroupsContainer;registerListeners(e){this._register(this.hostService.onDidChangeFocus(i=>i?this.onFocus():this.onBlur())),this._register(this.hostService.onDidChangeActiveWindow(i=>i===e?this.onFocus():this.onBlur())),this._register(this.configurationService.onDidChangeConfiguration(i=>this.onConfigurationChanged(i))),this._register(this.editorGroupService.onDidChangeEditorPartOptions(i=>this.onEditorPartConfigurationChange(i)))}onBlur(){this.isInactive=!0,this.updateStyles()}onFocus(){this.isInactive=!1,this.updateStyles()}onEditorPartConfigurationChange({oldPartOptions:e,newPartOptions:i}){(e.editorActionsLocation!==i.editorActionsLocation||e.showTabs!==i.showTabs)&&rw(this.configurationService,this.titleBarStyle)&&this.actionToolBar&&(this.createActionToolBar(),this.createActionToolBarMenus({editorActions:!0}),this._onDidChange.fire(void 0))}onConfigurationChanged(e){if(!this.isAuxiliary&&!Gm(this.configurationService,this.titleBarStyle)&&(!ye||si)&&e.affectsConfiguration("window.menuBarVisibility")&&(this.currentMenubarVisibility==="compact"?this.uninstallMenubar():this.installMenubar()),rw(this.configurationService,this.titleBarStyle)&&this.actionToolBar){let i=e.affectsConfiguration("workbench.layoutControl.enabled"),n=e.affectsConfiguration("workbench.activityBar.location");(i||n)&&(this.createActionToolBarMenus({layoutActions:i,activityActions:n}),this._onDidChange.fire(void 0))}e.affectsConfiguration("window.commandCenter")&&(this.createTitle(),this._onDidChange.fire(void 0))}installMenubar(){this.menubar||(this.customMenubar=this._register(this.instantiationService.createInstance(ET)),this.menubar=U(this.leftContent,J("div.menubar")),this.menubar.setAttribute("role","menubar"),this._register(this.customMenubar.onVisibilityChange(e=>this.onMenubarVisibilityChanged(e))),this.customMenubar.create(this.menubar))}uninstallMenubar(){this.customMenubar?.dispose(),this.customMenubar=void 0,this.menubar?.remove(),this.menubar=void 0,this.onMenubarVisibilityChanged(!1)}onMenubarVisibilityChanged(e){(si||St||ci)&&(this.lastLayoutDimensions&&this.layout(this.lastLayoutDimensions.width,this.lastLayoutDimensions.height),this._onMenubarVisibilityChange.fire(e))}updateProperties(e){this.windowTitle.updateProperties(e)}registerVariables(e){this.windowTitle.registerVariables(e)}createContentArea(e){if(this.element=e,this.rootContainer=U(e,J(".titlebar-container")),this.leftContent=U(this.rootContainer,J(".titlebar-left")),this.centerContent=U(this.rootContainer,J(".titlebar-center")),this.rightContent=U(this.rootContainer,J(".titlebar-right")),!ye&&!si&&!Gm(this.configurationService,this.titleBarStyle)&&(this.appIcon=eI(this.leftContent,J("a.window-appicon")),!this.isAuxiliary&&si)){let i=this.environmentService.options?.homeIndicator;if(i){let n=Uoe().getIcon(i.icon)?{id:i.icon}:N.code;this.appIcon.setAttribute("href",i.href),this.appIcon.classList.add(...de.asClassNameArray(n)),this.appIconBadge=document.createElement("div"),this.appIconBadge.classList.add("home-bar-icon-badge"),this.appIcon.appendChild(this.appIconBadge)}}if(this.dragRegion=eI(this.rootContainer,J("div.titlebar-drag-region")),!this.isAuxiliary&&!Gm(this.configurationService,this.titleBarStyle)&&(!ye||si)&&this.currentMenubarVisibility!=="compact"&&this.installMenubar(),this.title=U(this.centerContent,J("div.window-title")),this.createTitle(),rw(this.configurationService,this.titleBarStyle)&&(this.actionToolBarElement=U(this.rightContent,J("div.action-toolbar-container")),this.createActionToolBar(),this.createActionToolBarMenus()),!Gm(this.configurationService,this.titleBarStyle)){let i=ye?"left":"right";ye&&Po&&new Intl.Locale(lJ)?.textInfo?.direction==="rtl"&&(i="right"),ye&&Po&&i==="left"||(this.windowControlsContainer=U(i==="left"?this.leftContent:this.rightContent,J("div.window-controls-container")),si&&U(i==="left"?this.rightContent:this.leftContent,J("div.window-controls-container")),CA()&&this.windowControlsContainer.classList.add("wco-enabled"))}return this._register(F(this.rootContainer,Q.CONTEXT_MENU,i=>{Ve.stop(i);let n;ye&&on(i.target)&&$n(i.target,this.title)?n=V.TitleBarTitleContext:n=V.TitleBarContext,this.onContextMenu(i,n)})),ye&&this._register(F(this.title,Q.MOUSE_DOWN,i=>{i.metaKey&&(Ve.stop(i,!0),this.onContextMenu(i,V.TitleBarTitleContext))},!0)),this.updateStyles(),this.element}createTitle(){if(this.titleDisposables.clear(),!this.isCommandCenterVisible)this.title.innerText=this.windowTitle.value,this.titleDisposables.add(this.windowTitle.onDidChange(()=>{this.title.innerText=this.windowTitle.value}));else{let e=this.instantiationService.createInstance(xT,this.windowTitle,this.hoverDelegate);bo(this.title,e.element),this.titleDisposables.add(e)}}actionViewItemProvider(e,i){if(!this.isAuxiliary){if(e.id===Rg)return this.instantiationService.createInstance(LT,{position:()=>2},i);if(e.id===Pg)return this.instantiationService.createInstance(kT,{position:()=>2},i)}let n=this.editorGroupsContainer.activeGroup?.activeEditorPane;if(n&&n instanceof oh){let o=n.getActionViewItem(e,i);if(o)return o}return aa(this.instantiationService,e,{...i,menuAsChild:!1})}getKeybinding(e){let i=this.editorGroupsContainer.activeGroup?.activeEditorPane?.scopedContextKeyService??this.contextKeyService;return this.keybindingService.lookupKeybinding(e.id,i)}createActionToolBar(){this.actionToolBarDisposable.clear(),this.actionToolBar=this.actionToolBarDisposable.add(this.instantiationService.createInstance(ul,this.actionToolBarElement,{contextMenu:V.TitleBarContext,orientation:0,ariaLabel:u("ariaLabelTitleActions","Title actions"),getKeyBinding:e=>this.getKeybinding(e),overflowBehavior:{maxItems:9,exempted:[Pg,Rg,...qz]},anchorAlignmentProvider:()=>1,telemetrySource:"titlePart",highlightToggledItems:this.editorActionsEnabled,actionViewItemProvider:(e,i)=>this.actionViewItemProvider(e,i),hoverDelegate:this.hoverDelegate})),this.editorActionsEnabled&&this.actionToolBarDisposable.add(this.editorGroupsContainer.onDidChangeActiveGroup(()=>this.createActionToolBarMenus({editorActions:!0})))}createActionToolBarMenus(e=!0){e===!0&&(e={editorActions:!0,layoutActions:!0,activityActions:!0});let i=()=>{let n={primary:[],secondary:[]};if(this.editorActionsEnabled){this.editorActionsChangeDisposable.clear();let o=this.editorGroupsContainer.activeGroup;if(o){let s=o.createEditorActions(this.editorActionsChangeDisposable);n.primary.push(...s.actions.primary),n.secondary.push(...s.actions.secondary),this.editorActionsChangeDisposable.add(s.onDidChange(()=>i()))}}this.layoutToolbarMenu&&Vo(this.layoutToolbarMenu,{},n,()=>!this.editorActionsEnabled),this.activityActionsEnabled&&(QP(this.storageService)&&n.primary.push(tge),n.primary.push(ige)),this.actionToolBar.setActions(Ym(n.primary),Ym(n.secondary))};if(e.editorActions)if(this.editorToolbarMenuDisposables.clear(),this.editorActionsEnabled&&this.editorService.activeEditor!==void 0){let n={groupId:this.editorGroupsContainer.activeGroup.id};this.actionToolBar.actionRunner=new gS(n),this.actionToolBar.context=n,this.editorToolbarMenuDisposables.add(this.actionToolBar.actionRunner)}else this.actionToolBar.actionRunner=new jo,this.actionToolBar.context=void 0,this.editorToolbarMenuDisposables.add(this.actionToolBar.actionRunner);e.layoutActions&&(this.layoutToolbarMenuDisposables.clear(),this.layoutControlEnabled?(this.layoutToolbarMenu=this.menuService.createMenu(V.LayoutControlMenu,this.contextKeyService),this.layoutToolbarMenuDisposables.add(this.layoutToolbarMenu),this.layoutToolbarMenuDisposables.add(this.layoutToolbarMenu.onDidChange(()=>i()))):this.layoutToolbarMenu=void 0),e.activityActions&&(this.activityToolbarDisposables.clear(),this.activityActionsEnabled&&this.activityToolbarDisposables.add(this.storageService.onDidChangeValue(0,np.ACCOUNTS_VISIBILITY_PREFERENCE_KEY,this._store)(()=>i()))),i()}updateStyles(){if(super.updateStyles(),this.element){this.isInactive?this.element.classList.add("inactive"):this.element.classList.remove("inactive");let e=this.getColor(this.isInactive?zle:NF,(o,s)=>o.isOpaque()?o:o.makeOpaque(FF(s)))||"";this.element.style.backgroundColor=e,this.appIconBadge&&(this.appIconBadge.style.backgroundColor=e),e&&j.fromHex(e).isLighter()?this.element.classList.add("light"):this.element.classList.remove("light");let i=this.getColor(this.isInactive?HF:Tc);this.element.style.color=i||"";let n=this.getColor(Kle);this.element.style.borderBottom=n?`1px solid ${n}`:""}}onContextMenu(e,i){let n=new _i(ue(this.element),e);this.contextMenuService.showContextMenu({getAnchor:()=>n,menuId:i,contextKeyService:this.contextKeyService,domForShadowRoot:ye&&Po?n.target:void 0})}get currentMenubarVisibility(){return this.isAuxiliary?"hidden":ow(this.configurationService)}get layoutControlEnabled(){return!this.isAuxiliary&&this.configurationService.getValue("workbench.layoutControl.enabled")!==!1}get isCommandCenterVisible(){return this.configurationService.getValue("window.commandCenter")!==!1}get editorActionsEnabled(){return this.editorGroupService.partOptions.editorActionsLocation==="titleBar"||this.editorGroupService.partOptions.editorActionsLocation==="default"&&this.editorGroupService.partOptions.showTabs==="none"}get activityActionsEnabled(){let e=this.configurationService.getValue("workbench.activityBar.location");return!this.isAuxiliary&&(e==="top"||e==="bottom")}get hasZoomableElements(){let e=!(this.currentMenubarVisibility==="hidden"||this.currentMenubarVisibility==="compact"||!si&&ye),i=this.isCommandCenterVisible,n=this.layoutControlEnabled||this.editorActionsEnabled||this.activityActionsEnabled;return e||i||n}get preventZoom(){return qv(ue(this.element))<1||!this.hasZoomableElements}layout(e,i){this.updateLayout(new Ge(e,i)),super.layoutContents(e,i)}updateLayout(e){if(this.lastLayoutDimensions=e,rw(this.configurationService,this.titleBarStyle)){let i=qv(ue(this.element));if(this.element.style.setProperty("--zoom-factor",i.toString()),this.rootContainer.classList.toggle("counter-zoom",this.preventZoom),this.customMenubar){let n=new Ge(0,e.height);this.customMenubar.layout(n)}}}focus(){this.customMenubar?this.customMenubar.toggleFocus():this.element.querySelector('[tabindex]:not([tabindex="-1"])').focus()}toJSON(){return{type:"workbench.parts.titlebar"}}dispose(){this._onWillDispose.fire(),super.dispose()}};JT=E([b(3,vt),b(4,se),b(5,ih),b(6,ne),b(7,Fe),b(8,nt),b(9,ii),b(10,re),b(11,Tn),b(12,gn),b(13,$e),b(14,jt),b(15,Be)],JT);var SM=class extends JT{constructor(t,e,i,n,o,s,a,l,d,c,p,h,m){super("workbench.parts.titlebar",Ke,"main",t,e,i,n,o,s,a,l,d,c,p,h,m)}};SM=E([b(0,vt),b(1,se),b(2,ih),b(3,ne),b(4,Fe),b(5,nt),b(6,ii),b(7,re),b(8,Tn),b(9,gn),b(10,$e),b(11,jt),b(12,Be)],SM);var fS=class extends JT{constructor(e,i,n,o,s,a,l,d,c,p,h,m,f,g,v,I){let y=fS.COUNTER++;super(`workbench.parts.auxiliaryTitle.${y}`,ue(e),i,o,s,a,l,d,c,p,h,m,f,g,v,I);this.container=e;this.mainTitlebar=n}static COUNTER=1;get height(){return this.minimumHeight}get preventZoom(){return qv(ue(this.element))<1||!this.mainTitlebar.hasZoomableElements}};fS=E([b(3,vt),b(4,se),b(5,ih),b(6,ne),b(7,Fe),b(8,nt),b(9,ii),b(10,re),b(11,Tn),b(12,gn),b(13,$e),b(14,jt),b(15,Be)],fS);var nge=q("titleService");var e_=class{toDispose=[];constructor(t,e,i){let n=()=>{t.state===2&&!e.hasFocus?i.updateProperties({prefix:"\u{1F534}"}):i.updateProperties({prefix:""})};this.toDispose.push(t.onDidChangeState(n)),this.toDispose.push(e.onDidChangeFocus(n))}dispose(){_e(this.toDispose)}};e_=E([b(0,we),b(1,Tn),b(2,nge)],e_);var r5="addRootFolder",oge=ie("addFolderToWorkspace","Add Folder to Workspace..."),vZ="setRootFolder",IZ="_workbench.pickWorkspaceFolder";tt.registerCommand({id:"workbench.action.files.openFileFolderInNewWindow",handler:r=>r.get(Ta).pickFileFolderAndOpen({forceNewWindow:!0})});tt.registerCommand({id:"_files.pickFolderAndOpen",handler:(r,t)=>r.get(Ta).pickFolderAndOpen(t)});tt.registerCommand({id:"workbench.action.files.openFolderInNewWindow",handler:r=>r.get(Ta).pickFolderAndOpen({forceNewWindow:!0})});tt.registerCommand({id:"workbench.action.files.openFileInNewWindow",handler:r=>r.get(Ta).pickFileAndOpen({forceNewWindow:!0})});tt.registerCommand({id:"workbench.action.openWorkspaceInNewWindow",handler:r=>r.get(Ta).pickWorkspaceAndOpen({forceNewWindow:!0})});tt.registerCommand({id:r5,handler:async r=>{let t=r.get(tg),e=await rge(r);!e||!e.length||await t.addFolders(e.map(i=>({uri:i})))}});tt.registerCommand({id:vZ,handler:async r=>{let t=r.get(tg),e=r.get(kt),i=await rge(r);!i||!i.length||await t.updateFolders(0,e.getWorkspace().folders.length,i.map(n=>({uri:n})))}});async function rge(r){let t=r.get(Ta),e=r.get(yg);return await t.showOpenDialog({openLabel:zN(u({key:"add",comment:["&& denotes a mnemonic"]},"&&Add")),title:u("addFolderToWorkspaceTitle","Add Folder to Workspace"),canSelectFolders:!0,canSelectMany:!0,defaultUri:await t.defaultFolderPath(),availableFileSystems:[e.defaultUriScheme]})}tt.registerCommand(IZ,async function(r,t){let e=r.get(ki),i=r.get(hi),n=r.get(kt),o=r.get(qi),s=r.get(ti),a=n.getWorkspace().folders;if(!a.length)return;let l=a.map(h=>{let m=h.name,f=i.getUriLabel(Hn(h.uri),{relative:!0});return{label:m,description:f!==m?f:void 0,folder:h,iconClasses:ua(o,s,h.uri,2)}}),d=(t?t[0]:void 0)||Object.create(null);d.activeItem||(d.activeItem=l[0]),d.placeHolder||(d.placeHolder=u("workspaceFolderPickerPlaceholder","Select workspace folder")),typeof d.matchOnDescription!="boolean"&&(d.matchOnDescription=!0);let c=(t?t[1]:void 0)||Pt.None,p=await e.pick(l,d,c);if(p)return a[l.indexOf(p)]});tt.registerCommand({id:"vscode.openFolder",handler:(r,t,e)=>{let i=r.get(ct);if(typeof e=="boolean"&&(e={forceNewWindow:e}),!t){let a={forceNewWindow:e?.forceNewWindow};return e?.forceLocalWindow&&(a.remoteAuthority=null,a.availableFileSystems=["file"]),i.executeCommand("_files.pickFolderAndOpen",a)}let n=Z.from(t,!0),o={forceNewWindow:e?.forceNewWindow,forceReuseWindow:e?.forceReuseWindow,noRecentEntry:e?.noRecentEntry,remoteAuthority:e?.forceLocalWindow?null:void 0,forceProfile:e?.forceProfile,forceTempProfile:e?.forceTempProfile},s=nC(n)||n.scheme===Ie.untitled?{workspaceUri:n}:{folderUri:n};return i.executeCommand("_files.windowOpen",[s],o)},metadata:{description:"Open a folder or workspace in the current window or new window depending on the newWindow argument. Note that opening in the same window will shutdown the current extension host process and start a new one on the given folder/workspace unless the newWindow parameter is set to true.",args:[{name:"uri",description:"(optional) Uri of the folder or workspace file to open. If not provided, a native dialog will ask the user for the folder",constraint:r=>r==null||r instanceof Z},{name:"options",description:"(optional) Options. Object with the following properties: `forceNewWindow`: Whether to open the folder/workspace in a new window or the same. Defaults to opening in the same window. `forceReuseWindow`: Whether to force opening the folder/workspace in the same window.  Defaults to false. `noRecentEntry`: Whether the opened URI will appear in the 'Open Recent' list. Defaults to false. Note, for backward compatibility, options can also be of type boolean, representing the `forceNewWindow` setting.",constraint:r=>r===void 0||typeof r=="object"||typeof r=="boolean"}]}});tt.registerCommand({id:"vscode.newWindow",handler:(r,t)=>{let e=r.get(ct),i={forceReuseWindow:t&&t.reuseWindow,remoteAuthority:t&&t.remoteAuthority};return e.executeCommand("_files.newWindow",i)},metadata:{description:"Opens an new window depending on the newWindow argument.",args:[{name:"options",description:"(optional) Options. Object with the following properties: `reuseWindow`: Whether to open a new window or the same. Defaults to opening in a new window. ",constraint:r=>r===void 0||typeof r=="object"}]}});tt.registerCommand("_workbench.removeFromRecentlyOpened",function(r,t){return r.get(ql).removeRecentlyOpened([t])});tt.registerCommand({id:"vscode.removeFromRecentlyOpened",handler:(r,t)=>{let e=r.get(ql);return typeof t=="string"?t=t.match(/^[^:/?#]+:\/\//)?Z.parse(t):Z.file(t):t=Z.revive(t),e.removeRecentlyOpened([t])},metadata:{description:"Removes an entry with the given path from the recently opened list.",args:[{name:"path",description:"URI or URI string to remove from recently opened.",constraint:r=>typeof r=="string"||r instanceof Z}]}});tt.registerCommand("_workbench.addToRecentlyOpened",async function(r,t){let e=r.get(ql),i=t.uri,n=t.label,o=t.remoteAuthority,s;return t.type==="workspace"?s={workspace:await e.getWorkspaceIdentifier(i),label:n,remoteAuthority:o}:t.type==="folder"?s={folderUri:i,label:n,remoteAuthority:o}:s={fileUri:i,label:n,remoteAuthority:o},e.addRecentlyOpened([s])});tt.registerCommand("_workbench.getRecentlyOpened",async function(r){return r.get(ql).getRecentlyOpened()});var n_=ie("workspaces","Workspaces"),t_=class r extends Me{static ID="workbench.action.files.openFile";constructor(){super({id:r.ID,title:ie("openFile","Open File..."),category:$t.File,f1:!0,keybinding:{when:Bd.toNegated(),weight:200,primary:2093}})}async run(t,e){return t.get(Ta).pickFileAndOpen({forceNewWindow:!1,telemetryExtraData:e})}},i_=class r extends Me{static ID="workbench.action.files.openFolder";constructor(){super({id:r.ID,title:ie("openFolder","Open Folder..."),category:$t.File,f1:!0,precondition:YI,keybinding:{weight:200,primary:void 0,linux:{primary:mo(2089,2093)},win:{primary:mo(2089,2093)}}})}async run(t,e){return t.get(Ta).pickFolderAndOpen({forceNewWindow:!1,telemetryExtraData:e})}},s5=class r extends Me{static ID="workbench.action.files.openFolderViaWorkspace";constructor(){super({id:r.ID,title:ie("openFolder","Open Folder..."),category:$t.File,f1:!0,precondition:P.and(YI.toNegated(),Pa.isEqualTo("workspace")),keybinding:{weight:200,primary:2093}})}run(t){return t.get(ct).executeCommand(vZ)}},bS=class r extends Me{static ID="workbench.action.files.openFileFolder";static LABEL=ie("openFileFolder","Open...");constructor(){super({id:r.ID,title:r.LABEL,category:$t.File,f1:!0,precondition:P.and(Bd,YI),keybinding:{weight:200,primary:2093}})}async run(t,e){return t.get(Ta).pickFileFolderAndOpen({forceNewWindow:!1,telemetryExtraData:e})}},a5=class r extends Me{static ID="workbench.action.openWorkspace";constructor(){super({id:r.ID,title:ie("openWorkspaceAction","Open Workspace from File..."),category:$t.File,f1:!0,precondition:uh})}async run(t,e){return t.get(Ta).pickWorkspaceAndOpen({telemetryExtraData:e})}},CM=class r extends Me{static ID="workbench.action.closeFolder";constructor(){super({id:r.ID,title:ie("closeWorkspace","Close Workspace"),category:n_,f1:!0,precondition:P.and(Pa.notEqualsTo("empty"),QF),keybinding:{weight:200,primary:mo(2089,36)}})}async run(t){let e=t.get(Tn),i=t.get(Jo);return e.openWindow({forceReuseWindow:!0,remoteAuthority:i.remoteAuthority})}},yZ=class r extends Me{static ID="workbench.action.openWorkspaceConfigFile";constructor(){super({id:r.ID,title:ie("openWorkspaceConfigFile","Open Workspace Configuration File"),category:n_,f1:!0,precondition:Pa.isEqualTo("workspace")})}async run(t){let e=t.get(kt),i=t.get($e),n=e.getWorkspace().configuration;n&&await i.openEditor({resource:n,options:{pinned:!0}})}},SZ=class r extends Me{static ID="workbench.action.addRootFolder";constructor(){super({id:r.ID,title:oge,category:n_,f1:!0,precondition:P.or(uh,Pa.isEqualTo("workspace"))})}run(t){return t.get(ct).executeCommand(r5)}},CZ=class r extends Me{static ID="workbench.action.removeRootFolder";constructor(){super({id:r.ID,title:ie("globalRemoveFolderFromWorkspace","Remove Folder from Workspace..."),category:n_,f1:!0,precondition:P.and(tde.notEqualsTo("0"),P.or(uh,Pa.isEqualTo("workspace")))})}async run(t){let e=t.get(ct),i=t.get(tg),n=await e.executeCommand(IZ);n&&await i.removeFolders([n.uri])}},l5=class r extends Me{static ID="workbench.action.saveWorkspaceAs";constructor(){super({id:r.ID,title:ie("saveWorkspaceAsAction","Save Workspace As..."),category:n_,f1:!0,precondition:uh})}async run(t){let e=t.get(tg),i=t.get(kt),n=await e.pickNewWorkspacePath();if(n&&nC(n))switch(i.getWorkbenchState()){case 1:case 2:{let o=i.getWorkspace().folders.map(s=>({uri:s.uri}));return e.createAndEnterWorkspace(o,n)}case 3:return e.saveAndEnterWorkspace(n)}}},d5=class r extends Me{static ID="workbench.action.duplicateWorkspaceInNewWindow";constructor(){super({id:r.ID,title:ie("duplicateWorkspaceInNewWindow","Duplicate As Workspace in New Window"),category:n_,f1:!0,precondition:uh})}async run(t){let e=t.get(kt),i=t.get(tg),n=t.get(Tn),o=t.get(ql),s=t.get(Jo),a=e.getWorkspace().folders,l=s.remoteAuthority,d=await o.createUntitledWorkspace(a,l);return await i.copyWorkspaceSettings(d),n.openWindow([{workspaceUri:d.configPath}],{forceNewWindow:!0,remoteAuthority:l})}};he(SZ);he(CZ);he(t_);he(i_);he(s5);he(bS);he(a5);he(yZ);he(CM);he(l5);he(d5);Ue.appendMenuItem(V.MenubarFileMenu,{group:"2_open",command:{id:t_.ID,title:u({key:"miOpenFile",comment:["&& denotes a mnemonic"]},"&&Open File...")},order:1,when:Bd.toNegated()});Ue.appendMenuItem(V.MenubarFileMenu,{group:"2_open",command:{id:i_.ID,title:u({key:"miOpenFolder",comment:["&& denotes a mnemonic"]},"Open &&Folder...")},order:2,when:YI});Ue.appendMenuItem(V.MenubarFileMenu,{group:"2_open",command:{id:s5.ID,title:u({key:"miOpenFolder",comment:["&& denotes a mnemonic"]},"Open &&Folder...")},order:2,when:P.and(YI.toNegated(),Pa.isEqualTo("workspace"))});Ue.appendMenuItem(V.MenubarFileMenu,{group:"2_open",command:{id:bS.ID,title:u({key:"miOpen",comment:["&& denotes a mnemonic"]},"&&Open...")},order:1,when:P.and(Bd,YI)});Ue.appendMenuItem(V.MenubarFileMenu,{group:"2_open",command:{id:a5.ID,title:u({key:"miOpenWorkspace",comment:["&& denotes a mnemonic"]},"Open Wor&&kspace from File...")},order:3,when:uh});Ue.appendMenuItem(V.MenubarFileMenu,{group:"3_workspace",command:{id:r5,title:u({key:"miAddFolderToWorkspace",comment:["&& denotes a mnemonic"]},"A&&dd Folder to Workspace...")},when:P.or(uh,Pa.isEqualTo("workspace")),order:1});Ue.appendMenuItem(V.MenubarFileMenu,{group:"3_workspace",command:{id:l5.ID,title:u("miSaveWorkspaceAs","Save Workspace As...")},order:2,when:uh});Ue.appendMenuItem(V.MenubarFileMenu,{group:"3_workspace",command:{id:d5.ID,title:u("duplicateWorkspace","Duplicate Workspace")},order:3,when:uh});Ue.appendMenuItem(V.MenubarFileMenu,{group:"6_close",command:{id:CM.ID,title:u({key:"miCloseFolder",comment:["&& denotes a mnemonic"]},"Close &&Folder")},order:3,when:P.and(Pa.isEqualTo("folder"),QF)});Ue.appendMenuItem(V.MenubarFileMenu,{group:"6_close",command:{id:CM.ID,title:u({key:"miCloseWorkspace",comment:["&& denotes a mnemonic"]},"Close &&Workspace")},order:3,when:P.and(Pa.isEqualTo("workspace"),QF)});var wZ="debugStartLanguage",fke=new A(wZ,void 0),sge=new A("debuggerInterestedInActiveEditor",!1),za=class extends Lr{constructor(e,i,n,o,s,a,l,d,c,p,h,m,f,g){super(e,n,o,s,a,p,c,h,i,f,g);this.debugService=l;this.editorService=d;this.debugStartLanguageContext=fke.bindTo(a),this.debuggerInterestedContext=sge.bindTo(a);let v=m.get(wZ,1);this.debugStartLanguageContext.set(v);let I=()=>{let C=this.editorService.activeTextEditorControl;if(RI(C)&&(C=C.getModifiedEditor()),no(C)){let S=C.getModel(),D=S?S.getLanguageId():void 0;if(D&&this.debugService.getAdapterManager().someDebuggerInterestedInLanguage(D)){this.debugStartLanguageContext.set(D),this.debuggerInterestedContext.set(!0),m.store(wZ,D,1,1);return}}this.debuggerInterestedContext.set(!1)},y=new B;this._register(y),this._register(d.onDidActiveEditorChange(()=>{y.clear();let C=this.editorService.activeTextEditorControl;RI(C)&&(C=C.getModifiedEditor()),no(C)&&y.add(C.onDidChangeModelLanguage(I)),I()})),this._register(this.debugService.getAdapterManager().onDidRegisterDebugger(I)),this._register(this.onDidChangeBodyVisibility(C=>{C&&I()})),I();let w=this.keybindingService.lookupKeybinding(Oc);age=w?` (${w.getLabel()})`:""}static ID="workbench.debug.welcome";static LABEL=ie("run","Run");debugStartLanguageContext;debuggerInterestedContext;shouldShowWelcome(){return!0}};za=E([b(1,Fe),b(2,Be),b(3,vt),b(4,se),b(5,re),b(6,we),b(7,$e),b(8,ne),b(9,$i),b(10,Yi),b(11,nt),b(12,Tt),b(13,Nt)],za);var o_=Pe.as(xc.ViewsRegistry);o_.registerViewWelcomeContent(za.ID,{content:u({key:"openAFileWhichCanBeDebugged",comment:['Please do not translate the word "command", it is part of our internal syntax which must not change','{Locked="](command:{0})"}']},"[Open a file](command:{0}) which can be debugged or run.",ye&&!si?bS.ID:t_.ID),when:P.and(oi,sge.toNegated()),group:"2_open"});var age="";o_.registerViewWelcomeContent(za.ID,{content:`[${u("runAndDebugAction","Run and Debug")}${age}](command:${Oc})`,when:oi,group:"4_debug",order:1});o_.registerViewWelcomeContent(za.ID,{content:`[${u("detectThenRunAndDebug","Show all automatic debug configurations")}](command:${Ku}).`,when:oi,group:"4_debug",order:10});o_.registerViewWelcomeContent(za.ID,{content:u({key:"customizeRunAndDebug",comment:['Please do not translate the word "command", it is part of our internal syntax which must not change','{Locked="](command:{0})"}']},"To customize Run and Debug [create a launch.json file](command:{0}).",Bh),when:P.and(oi,Pa.notEqualsTo("empty")),group:"4_debug"});o_.registerViewWelcomeContent(za.ID,{content:u({key:"customizeRunAndDebugOpenFolder",comment:['Please do not translate the word "command", it is part of our internal syntax which must not change','Please do not translate "launch.json", it is the specific configuration file name','{Locked="](command:{0})"}']},"To customize Run and Debug, [open a folder](command:{0}) and create a launch.json file.",ye&&!si?bS.ID:i_.ID),when:P.and(oi,Pa.isEqualTo("empty")),group:"4_debug"});o_.registerViewWelcomeContent(za.ID,{content:u("allDebuggersDisabled","All debug extensions are disabled. Enable a debug extension or install a new one from the Marketplace."),when:gV.toNegated(),group:"4_debug"});var r_=class extends ch{constructor(e,i,n,o,s,a,l,d,c,p,h,m,f,g){super(nr,{mergeViewWithContainerWhenSingleView:!0},s,h,e,c,i,p,d,l,a,g);this.progressService=n;this.debugService=o;this.contextViewService=m;this.contextKeyService=f;this._register(this.debugService.onDidChangeState(v=>this.onDebugServiceStateChange(v))),this._register(this.contextKeyService.onDidChangeContext(v=>{v.affectsSome(new Set([uq,"inDebugMode"]))&&this.updateTitleArea()})),this._register(this.contextService.onDidChangeWorkbenchState(()=>this.updateTitleArea())),this._register(this.configurationService.onDidChangeConfiguration(v=>{(v.affectsConfiguration("debug.toolBarLocation")||v.affectsConfiguration("debug.hideLauncherWhileDebugging"))&&this.updateTitleArea()}))}startDebugActionViewItem;progressResolve;breakpointView;paneListeners=new Map;stopActionViewItemDisposables=this._register(new B);create(e){super.create(e),e.classList.add("debug-viewlet")}focus(){super.focus(),this.startDebugActionViewItem?this.startDebugActionViewItem.focus():this.focusView(za.ID)}getActionViewItem(e,i){if(e.id===Oc)return this.startDebugActionViewItem=this.instantiationService.createInstance(Sg,null,e,i),this.startDebugActionViewItem;if(e.id===_x)return new zh(e,void 0,this.debugService,this.contextViewService,this.configurationService);if(e.id===Va||e.id===td){this.stopActionViewItemDisposables.clear();let n=this.instantiationService.invokeFunction(o=>dP(e,this.stopActionViewItemDisposables,o,{hoverDelegate:i.hoverDelegate}));if(n)return n}return aa(this.instantiationService,e,i)}focusView(e){let i=this.getView(e);i&&i.focus()}onDebugServiceStateChange(e){this.progressResolve&&(this.progressResolve(),this.progressResolve=void 0),e===1&&this.progressService.withProgress({location:nr},i=>new Promise(n=>this.progressResolve=n))}addPanes(e){super.addPanes(e);for(let{pane:i}of e)i.id===Aa?(this.breakpointView=i,this.updateBreakpointsMaxSize()):this.paneListeners.set(i.id,i.onDidChange(()=>this.updateBreakpointsMaxSize()))}removePanes(e){super.removePanes(e);for(let i of e)_e(this.paneListeners.get(i.id)),this.paneListeners.delete(i.id)}updateBreakpointsMaxSize(){if(this.breakpointView){let e=this.panes.every(i=>!i.isExpanded()||i===this.breakpointView);this.breakpointView.maximumBodySize=e?Number.POSITIVE_INFINITY:this.breakpointView.minimumBodySize}}};r_=E([b(0,ii),b(1,Tt),b(2,Cu),b(3,we),b(4,ne),b(5,kt),b(6,nt),b(7,Fe),b(8,vt),b(9,_n),b(10,se),b(11,so),b(12,re),b(13,$i)],r_);Ue.appendMenuItem(V.ViewContainerTitle,{when:P.and(P.equals("viewContainer",nr),zd.notEqualsTo("simple"),Pa.notEqualsTo("empty"),P.or(Gt.isEqualTo("inactive"),P.notEquals("config.debug.toolBarLocation","docked")),P.or(P.not("config.debug.hideLauncherWhileDebugging"),P.not("inDebugMode"))),order:10,group:"navigation",command:{precondition:Gt.notEqualsTo(Ql(1)),id:Oc,title:nP}});he(class extends Me{constructor(){super({id:Bh,title:{value:Dx,original:"Open 'launch.json'",mnemonicTitle:u({key:"miOpenConfigurations",comment:["&& denotes a mnemonic"]},"Open &&Configurations")},metadata:{description:ie("openLaunchConfigDescription","Opens the file used to configure how your program is debugged")},f1:!0,icon:dE,precondition:zd.notEqualsTo("simple"),menu:[{id:V.ViewContainerTitle,group:"navigation",order:20,when:P.and(P.equals("viewContainer",nr),zd.notEqualsTo("simple"),Pa.notEqualsTo("empty"),P.or(Gt.isEqualTo("inactive"),P.notEquals("config.debug.toolBarLocation","docked")))},{id:V.ViewContainerTitle,order:20,when:P.and(P.equals("viewContainer",nr),Gt.notEqualsTo("inactive"),P.equals("config.debug.toolBarLocation","docked"))},{id:V.MenubarDebugMenu,group:"2_configuration",order:1,when:oi}]})}async run(r){let t=r.get(we),e=r.get(ki),i=t.getConfigurationManager(),n;if(i.selectedConfiguration.name)n=i.selectedConfiguration.launch;else{let o=i.getLaunches().filter(s=>!s.hidden);if(o.length===1)n=o[0];else{let s=o.map(l=>({label:l.name,launch:l})),a=await e.pick(s,{activeItem:s[0],placeHolder:u({key:"selectWorkspaceFolder",comment:["User picks a workspace folder or a workspace configuration file here. Workspace configuration files can contain settings and thus a launch.json configuration can be written into one."]},"Select a workspace folder to create a launch.json file in or add it to the workspace config file")});a&&(n=a.launch)}}n&&await n.openConfigFile({preserveFocus:!1})}});he(class extends Me{constructor(){super({id:"debug.toggleReplIgnoreFocus",title:u("debugPanel","Debug Console"),toggled:P.has(`view.${ln}.visible`),menu:[{id:TL,group:"3_toggleRepl",order:30,when:P.and(P.equals("viewContainer",nr))}]})}async run(r){let t=r.get(Mi);t.isViewVisible(ln)?t.closeView(ln):await t.openView(ln)}});Ue.appendMenuItem(V.ViewContainerTitle,{when:P.and(P.equals("viewContainer",nr),Gt.notEqualsTo("inactive"),P.or(P.equals("config.debug.toolBarLocation","docked"),P.has("config.debug.hideLauncherWhileDebugging"))),order:10,command:{id:Ku,title:u("startAdditionalSession","Start Additional Session")}});var lp=class{constructor(t,e,i,n,o){this.debugService=e;this.modelService=i;this.languageService=n;this.editorWorkerService=o;t.registerTextModelContentProvider(Gs,this),lp.INSTANCE=this}static INSTANCE;pendingUpdates=new Map;dispose(){this.pendingUpdates.forEach(t=>t.dispose())}provideTextContent(t){return this.createOrUpdateContentModel(t,!0)}static refreshDebugContent(t){lp.INSTANCE?.createOrUpdateContentModel(t,!1)}createOrUpdateContentModel(t,e){let i=this.modelService.getModel(t);if(!i&&!e)return null;let n;if(t.query){let s=yh.getEncodedDebugData(t);n=this.debugService.getModel().getSession(s.sessionId)}if(n||(n=this.debugService.getViewModel().focusedSession),!n)return Promise.reject(new Ga(u("unable","Unable to resolve the resource without a debug session")));let o=s=>{this.debugService.sourceIsNotAvailable(t);let a=this.languageService.createById(jn),l=s?u("canNotResolveSourceWithError","Could not load source '{0}': {1}.",t.path,s):u("canNotResolveSource","Could not load source '{0}'.",t.path);return this.modelService.createModel(l,a,t)};return n.loadSource(t).then(s=>{if(s&&s.body)if(i){let a=s.body.content;this.pendingUpdates.get(i.id)?.cancel();let d=new Kt;return this.pendingUpdates.set(i.id,d),this.editorWorkerService.computeMoreMinimalEdits(i.uri,[{text:a,range:i.getFullModelRange()}]).then(c=>(this.pendingUpdates.delete(i.id),!d.token.isCancellationRequested&&c&&c.length>0&&i.applyEdits(c.map(p=>$r.replace(L.lift(p.range),p.text))),i))}else{let a=s.body.mimeType||vue(t)[0],l=this.languageService.createByMimeType(a);return this.modelService.createModel(s.body.content,l,t)}return o()},s=>o(s.message))}};lp=E([b(0,Tr),b(1,we),b(2,qi),b(3,ti),b(4,hg)],lp);var lge=!0,bke=/^[a-zA-Z][a-zA-Z0-9\+\-\.]+:/,Og=class r{constructor(t,e,i=!1){this._parent=t;this._label=e;this.isIncompressible=i;this._showedMoreThanOne=!1}_showedMoreThanOne;_children=new Map;_source;updateLabel(t){this._label=t}isLeaf(){return this._children.size===0}getSession(){if(this._parent)return this._parent.getSession()}setSource(t,e){if(this._source=e,this._children.clear(),e.raw&&e.raw.sources){for(let i of e.raw.sources)if(i.name&&i.path){let n=new r(this,i.name);this._children.set(i.path,n);let o=t.getSource(i);n.setSource(t,o)}}}createIfNeeded(t,e){let i=this._children.get(t);return i||(i=e(this,t),this._children.set(t,i)),i}getChild(t){return this._children.get(t)}remove(t){this._children.delete(t)}removeFromParent(){this._parent&&(this._parent.remove(this._label),this._parent._children.size===0&&this._parent.removeFromParent())}getTemplateId(){return"id"}getId(){let t=this.getParent();return t?`${t.getId()}/${this.getInternalId()}`:this.getInternalId()}getInternalId(){return this._label}getParent(){if(this._parent)return this._parent.isSkipped()?this._parent.getParent():this._parent}isSkipped(){return this._parent?!!this._parent.oneChild():!0}hasChildren(){let t=this.oneChild();return t?t.hasChildren():this._children.size>0}getChildren(){let t=this.oneChild();if(t)return t.getChildren();let e=[];for(let i of this._children.values())e.push(i);return e.sort((i,n)=>this.compare(i,n))}getLabel(t=!0){let e=this.oneChild();if(e){let i=this instanceof kv&&t?" \u2022 ":Xt.sep;return`${this._label}${i}${e.getLabel()}`}return this._label}getHoverLabel(){if(this._source&&this._parent&&this._parent._source)return this._source.raw.path||this._source.raw.name;let t=this.getLabel(!1),e=this.getParent();if(e){let i=e.getHoverLabel();if(i)return`${i}/${t}`}return t}getSource(){let t=this.oneChild();return t?t.getSource():this._source}compare(t,e){return t._label&&e._label?t._label.localeCompare(e._label):0}oneChild(){if(!this._source&&!this._showedMoreThanOne&&this.skipOneChild()){if(this._children.size===1)return this._children.values().next().value;this._children.size>1&&(this._showedMoreThanOne=!0)}}skipOneChild(){return lge?this instanceof c5:!(this instanceof kv)&&!(this instanceof Lv)}},kv=class extends Og{constructor(e,i){super(e,i.name,!0);this.folder=i}},c5=class extends Og{constructor(e,i,n){super(void 0,"Root");this._pathService=e;this._contextService=i;this._labelService=n}add(e){return this.createIfNeeded(e.getId(),()=>new Lv(this._labelService,this,e,this._pathService,this._contextService))}find(e){return this.getChild(e.getId())}},Lv=class r extends Og{constructor(e,i,n,o,s){super(i,n.getLabel(),!0);this._pathService=o;this.rootProvider=s;this._labelService=e,this._session=n}static URL_REGEXP=/^(https?:\/\/[^/]+)(\/.*)$/;_session;_map=new Map;_labelService;getInternalId(){return this._session.getId()}getSession(){return this._session}getHoverLabel(){}hasChildren(){return!0}compare(e,i){let n=this.category(e),o=this.category(i);return n!==o?n-o:super.compare(e,i)}category(e){if(e instanceof kv)return e.folder.index;let i=e.getLabel();return i&&/^<.+>$/.test(i)?1e3:999}async addPath(e){let i,n,o=e.raw.path;if(!o)return;this._labelService&&bke.test(o)&&(o=this._labelService.getUriLabel(Z.parse(o)));let s=r.URL_REGEXP.exec(o);if(s&&s.length===3)n=s[1],o=decodeURI(s[2]);else if(ja(o)){let l=Z.file(o);i=this.rootProvider?this.rootProvider.getWorkspaceFolder(l):null,i?(o=ds(wp(l.path.substring(i.uri.path.length),Xt.sep)),this.rootProvider.getWorkspace().folders.length>1?o=Xt.sep+o:i=null):(o=ds(o),St?o=jp(o):o=xse(o,(await this._pathService.userHome()).fsPath))}let a=this;o.split(/[\/\\]/).forEach((l,d)=>{if(d===0&&i){let c=i;a=a.createIfNeeded(i.name,p=>new kv(p,c))}else d===0&&n?a=a.createIfNeeded(n,c=>new Og(c,n)):a=a.createIfNeeded(l,c=>new Og(c,l))}),a.setSource(this._session,e),e.raw.path&&this._map.set(e.raw.path,a)}removePath(e){if(e.raw.path){let i=this._map.get(e.raw.path);if(i)return i.removeFromParent(),!0}return!1}};function dge(r,t){let e=r.getChildren(),i=t?!t.expanded.has(r.getId()):!(r instanceof Lv);return{element:r,collapsed:i,collapsible:r.hasChildren(),children:e.map(n=>dge(n,t))}}var s_=class extends Lr{constructor(e,i,n,o,s,a,l,d,c,p,h,m,f,g,v,I){super(e,n,i,a,d,s,o,f,g,v,I);this.editorService=l;this.contextService=c;this.debugService=p;this.labelService=h;this.pathService=m;this.loadedScriptsItemType=gce.bindTo(d)}treeContainer;loadedScriptsItemType;tree;treeLabels;changeScheduler;treeNeedsRefreshOnVisible=!1;filter;renderBody(e){super.renderBody(e),this.element.classList.add("debug-pane"),e.classList.add("debug-loaded-scripts"),e.classList.add("show-file-icons"),this.treeContainer=nv(e),this.filter=new TZ;let i=new c5(this.pathService,this.contextService,this.labelService);this.treeLabels=this.instantiationService.createInstance(tc,{onDidChangeVisibility:this.onDidChangeBodyVisibility}),this._register(this.treeLabels),this.tree=this.instantiationService.createInstance(aE,"LoadedScriptsView",this.treeContainer,new EZ,[new u5(this.treeLabels)],{compressionEnabled:lge,collapseByDefault:!0,hideTwistiesOfChildlessElements:!0,identityProvider:{getId:d=>d.getId()},keyboardNavigationLabelProvider:{getKeyboardNavigationLabel:d=>d.getLabel(),getCompressedNodeKeyboardNavigationLabel:d=>d.map(c=>c.getLabel()).join("/")},filter:this.filter,accessibilityProvider:new xZ,overrideStyles:this.getLocationBasedColors().listOverrideStyles});let n=d=>this.tree.setChildren(null,dge(i,d).children);n(),this.changeScheduler=new Ye(()=>{this.treeNeedsRefreshOnVisible=!1,this.tree&&n()},300),this._register(this.changeScheduler),this._register(this.tree.onDidOpen(d=>{if(d.element instanceof Og){let c=d.element.getSource();if(c&&c.available){let p={startLineNumber:0,startColumn:0,endLineNumber:0,endColumn:0};c.openInEditor(this.editorService,p,d.editorOptions.preserveFocus,d.sideBySide,d.editorOptions.pinned)}}})),this._register(this.tree.onDidChangeFocus(()=>{this.tree.getFocus()instanceof Lv?this.loadedScriptsItemType.set("session"):this.loadedScriptsItemType.reset()}));let o=()=>{this.isBodyVisible()?this.changeScheduler.schedule():this.treeNeedsRefreshOnVisible=!0},s=async d=>{if(d.capabilities.supportsLoadedSourcesRequest){let c=i.add(d),p=await d.getLoadedSources();for(let h of p)await c.addPath(h);o()}},a=d=>{this._register(d.onDidChangeName(async()=>{let c=i.find(d);c&&(c.updateLabel(d.getLabel()),o())})),this._register(d.onDidLoadedSource(async c=>{let p;switch(c.reason){case"new":case"changed":p=i.add(d),await p.addPath(c.source),o(),c.reason==="changed"&&lp.refreshDebugContent(c.source.uri);break;case"removed":p=i.find(d),p&&p.removePath(c.source)&&o();break;default:this.filter.setFilter(c.source.name),this.tree.refilter();break}}))};this._register(this.debugService.onDidNewSession(a)),this.debugService.getModel().getSessions().forEach(a),this._register(this.debugService.onDidEndSession(({session:d})=>{i.remove(d.getId()),this.changeScheduler.schedule()})),this.changeScheduler.schedule(0),this._register(this.onDidChangeBodyVisibility(d=>{d&&this.treeNeedsRefreshOnVisible&&this.changeScheduler.schedule()}));let l;this._register(this.tree.onDidChangeFindPattern(d=>{if(this.tree.findMode!==0)if(!l&&d){let c=new Set,p=h=>{h.element&&!h.collapsed&&c.add(h.element.getId());for(let m of h.children)p(m)};p(this.tree.getNode()),l={expanded:c},this.tree.expandAll()}else!d&&l&&(this.tree.setFocus([]),n(l),l=void 0)})),this.debugService.getModel().getSessions().forEach(d=>s(d))}layoutBody(e,i){super.layoutBody(e,i),this.tree.layout(e,i)}collapseAll(){this.tree.collapseAll()}dispose(){_e(this.tree),_e(this.treeLabels),super.dispose()}};s_=E([b(1,vt),b(2,Be),b(3,ne),b(4,$i),b(5,se),b(6,$e),b(7,re),b(8,kt),b(9,we),b(10,hi),b(11,yg),b(12,Yi),b(13,Fe),b(14,Tt),b(15,Nt)],s_);var EZ=class{getHeight(t){return 22}getTemplateId(t){return u5.ID}},u5=class r{constructor(t){this.labels=t}static ID="lsrenderer";get templateId(){return r.ID}renderTemplate(t){return{label:this.labels.create(t,{supportHighlights:!0})}}renderElement(t,e,i){let n=t.element,o=n.getLabel();this.render(n,o,i,t.filterData)}renderCompressedElements(t,e,i,n){let o=t.element.elements[t.element.elements.length-1],s=t.element.elements.map(a=>a.getLabel());this.render(o,s,i,t.filterData)}render(t,e,i,n){let o={name:e},s={title:t.getHoverLabel()};if(t instanceof kv)s.fileKind=2;else if(t instanceof Lv)s.title=u("loadedScriptsSession","Debug Session"),s.hideIcon=!0;else if(t instanceof Og){let a=t.getSource();a&&a.uri?(o.resource=a.uri,s.fileKind=0):s.fileKind=1}s.matches=qo(n),i.label.setResource(o,s)}disposeTemplate(t){t.label.dispose()}},xZ=class{getWidgetAriaLabel(){return u({comment:["Debug is a noun in this context, not a verb."],key:"loadedScriptsAriaLabel"},"Debug Loaded Scripts")}getAriaLabel(t){return t instanceof kv?u("loadedScriptsRootFolderAriaLabel","Workspace folder {0}, loaded script, debug",t.getLabel()):t instanceof Lv?u("loadedScriptsSessionAriaLabel","Session {0}, loaded script, debug",t.getLabel()):t.hasChildren()?u("loadedScriptsFolderAriaLabel","Folder {0}, loaded script, debug",t.getLabel()):u("loadedScriptsSourceAriaLabel","{0}, loaded script, debug",t.getLabel())}},TZ=class{filterText;setFilter(t){this.filterText=t}filter(t,e){return this.filterText?t.isLeaf()?t.getLabel().indexOf(this.filterText)>=0?1:0:2:1}};he(class extends tr{constructor(){super({id:"loadedScripts.collapse",viewId:my,title:u("collapse","Collapse All"),f1:!1,icon:N.collapseAll,menu:{id:V.ViewTitle,order:30,group:"navigation",when:P.equals("view",my)}})}runInView(t,e){e.collapseAll()}});var cge=T("statusBar.debuggingBackground",{dark:"#CC6633",light:"#CC6633",hcDark:"#BA592C",hcLight:"#B5200D"},u("statusBarDebuggingBackground","Status bar background color when a program is being debugged. The status bar is shown in the bottom of the window")),vke=T("statusBar.debuggingForeground",{dark:$l,light:$l,hcDark:$l,hcLight:"#FFFFFF"},u("statusBarDebuggingForeground","Status bar foreground color when a program is being debugged. The status bar is shown in the bottom of the window")),Ike=T("statusBar.debuggingBorder",gL,u("statusBarDebuggingBorder","Status bar border color separating to the sidebar and editor when a program is being debugged. The status bar is shown in the bottom of the window")),yke=T("commandCenter.debuggingBackground",Ne(cge,.258),u("commandCenter-activeBackground","Command center background color when a program is being debugged"),!0),a_=class{constructor(t,e,i,n,o){this.debugService=t;this.contextService=e;this.statusbarService=i;this.layoutService=n;this.configurationService=o;this.debugService.onDidChangeState(this.update,this,this.disposables),this.contextService.onDidChangeWorkbenchState(this.update,this,this.disposables),this.configurationService.onDidChangeConfiguration(s=>{(s.affectsConfiguration("debug.enableStatusBarColor")||s.affectsConfiguration("debug.toolBarLocation"))&&this.update()},void 0,this.disposables),this.update()}disposables=new B;disposable;set enabled(t){t!==!!this.disposable&&(t?this.disposable=this.statusbarService.overrideStyle({priority:10,foreground:vke,background:cge,border:Ike}):(this.disposable.dispose(),this.disposable=void 0))}update(){let t=this.configurationService.getValue("debug"),e=Ske(this.debugService.state,this.debugService.getModel().getSessions());t.enableStatusBarColor?this.enabled=e:this.enabled=!1;let i=t.toolBarLocation==="commandCenter";this.layoutService.mainContainer.style.setProperty(g0(Gle),i&&e?Se(yke):"")}dispose(){this.disposable?.dispose(),this.disposables.dispose()}};a_=E([b(0,we),b(1,kt),b(2,Zd),b(3,N1),b(4,se)],a_);function Ske(r,t){return!(r===0||r===1||t.every(e=>e.suppressDebugStatusbar||e.configuration?.noDebug))}var Cke=1024,_Z=!1,DZ=!1,l_=class extends Lr{constructor(e,i,n,o,s,a,l,d,c,p,h,m,f){super(e,o,i,l,d,a,s,c,p,h,m);this.debugService=n;this.menu=f.createMenu(V.DebugWatchContext,d),this._register(this.menu),this.watchExpressionsUpdatedScheduler=new Ye(()=>{this.needsRefresh=!1,this.tree.updateChildren()},50),this.watchExpressionsExist=sV.bindTo(d),this.variableReadonly=cy.bindTo(d),this.watchExpressionsExist.set(this.debugService.getModel().getWatchExpressions().length>0),this.watchItemType=xh.bindTo(d)}watchExpressionsUpdatedScheduler;needsRefresh=!1;tree;watchExpressionsExist;watchItemType;variableReadonly;menu;renderBody(e){super.renderBody(e),this.element.classList.add("debug-pane"),e.classList.add("debug-watch");let i=nv(e),n=this.instantiationService.createInstance(id),o=this.instantiationService.createInstance(Rv,n);this.tree=this.instantiationService.createInstance(is,"WatchExpressions",i,new kZ,[o,this.instantiationService.createInstance(rd,n),this.instantiationService.createInstance(ma,n)],this.instantiationService.createInstance(LZ),{accessibilityProvider:new RZ,identityProvider:{getId:a=>a.getId()},keyboardNavigationLabelProvider:{getKeyboardNavigationLabel:a=>{if(a!==this.debugService.getViewModel().getSelectedExpression()?.expression)return a.name}},dnd:new PZ(this.debugService),overrideStyles:this.getLocationBasedColors().listOverrideStyles}),this.tree.setInput(this.debugService),XL.bindTo(this.tree.contextKeyService),this._register(ma.rendererOnVisualizationRange(this.debugService.getViewModel(),this.tree)),this._register(this.tree.onContextMenu(a=>this.onContextMenu(a))),this._register(this.tree.onMouseDblClick(a=>this.onMouseDblClick(a))),this._register(this.debugService.getModel().onDidChangeWatchExpressions(async a=>{this.watchExpressionsExist.set(this.debugService.getModel().getWatchExpressions().length>0),this.isBodyVisible()?(a&&!a.name&&(DZ=!0),await this.tree.updateChildren(),DZ=!1,a instanceof Hi&&this.tree.reveal(a)):this.needsRefresh=!0})),this._register(this.debugService.getViewModel().onDidFocusStackFrame(()=>{if(!this.isBodyVisible()){this.needsRefresh=!0;return}this.watchExpressionsUpdatedScheduler.isScheduled()||this.watchExpressionsUpdatedScheduler.schedule()})),this._register(this.debugService.getViewModel().onWillUpdateViews(()=>{_Z||this.tree.updateChildren()})),this._register(this.onDidChangeBodyVisibility(a=>{a&&this.needsRefresh&&this.watchExpressionsUpdatedScheduler.schedule()}));let s;this._register(this.debugService.getViewModel().onDidSelectExpression(a=>{let l=a?.expression;l&&this.tree.hasNode(l)?(s=this.tree.options.horizontalScrolling,s&&this.tree.updateOptions({horizontalScrolling:!1}),l.name&&this.tree.rerender(l)):!l&&s!==void 0&&(this.tree.updateOptions({horizontalScrolling:s}),s=void 0)})),this._register(this.debugService.getViewModel().onDidEvaluateLazyExpression(async a=>{a instanceof Li&&this.tree.hasNode(a)&&(await this.tree.updateChildren(a,!1,!0),await this.tree.expand(a))}))}layoutBody(e,i){super.layoutBody(e,i),this.tree.layout(e,i)}focus(){super.focus(),this.tree.domFocus()}collapseAll(){this.tree.collapseAll()}onMouseDblClick(e){if(e.browserEvent.target.className.indexOf("twistie")>=0)return;let i=e.element,n=this.debugService.getViewModel().getSelectedExpression();i instanceof Hi&&i!==n?.expression||i instanceof Xl&&i.treeItem.canEdit?this.debugService.getViewModel().setSelectedExpression(i,!1):i||this.debugService.addWatchExpression()}onContextMenu(e){let i=e.element,n=this.tree.getSelection();this.watchItemType.set(i instanceof Hi?"expression":i instanceof Li?"variable":void 0);let o=[],s=i instanceof Li?i.presentationHint?.attributes:void 0;this.variableReadonly.set(!!s&&s.indexOf("readOnly")>=0||!!i?.presentationHint?.lazy),sa(this.menu,{arg:i,shouldForwardArgs:!0},o),this.contextMenuService.showContextMenu({getAnchor:()=>e.anchor,getActions:()=>o,getActionsContext:()=>i&&n.includes(i)?n:i?[i]:[]})}};l_=E([b(1,vt),b(2,we),b(3,Be),b(4,ne),b(5,$i),b(6,se),b(7,re),b(8,Yi),b(9,Fe),b(10,Tt),b(11,Nt),b(12,jt)],l_);var kZ=class{getHeight(t){return 22}getTemplateId(t){return t instanceof Hi?Rv.ID:t instanceof Xl?ma.ID:rd.ID}};function uge(r){return typeof r.getConfigurationManager=="function"}var LZ=class extends Hh{hasChildren(t){return uge(t)||t.hasChildren}doGetChildren(t){if(uge(t)){let e=t,i=e.getModel().getWatchExpressions(),n=e.getViewModel();return Promise.all(i.map(o=>o.name&&!DZ?o.evaluate(n.focusedSession,n.focusedStackFrame,"watch").then(()=>o):Promise.resolve(o)))}return t.getChildren()}},Rv=class extends qu{constructor(e,i,n,o,s,a,l){super(o,s,a);this.linkDetector=e;this.menuService=i;this.contextKeyService=n;this.configurationService=l}static ID="watchexpression";get templateId(){return Rv.ID}renderElement(e,i,n){n.elementDisposable.clear(),n.elementDisposable.add(this.configurationService.onDidChangeConfiguration(o=>{o.affectsConfiguration("debug.showVariableTypes")&&super.renderExpressionElement(e.element,e,n)})),super.renderExpressionElement(e.element,e,n)}renderExpression(e,i,n){let o;i.type.textContent="";let s=this.configurationService.getValue("debug").showVariableTypes;s&&e.type?(o=typeof e.value=="string"?`${e.name}: `:e.name,i.type.textContent=e.type+" ="):o=typeof e.value=="string"?`${e.name} =`:e.name;let a;e.type?s?a=`${e.name}`:a=e.type===e.value?e.type:`${e.type}`:a=e.value,i.label.set(o,n,a),Xd(i.elementDisposable,e,i.value,{showChanged:!0,maxValueLength:Cke,linkDetector:this.linkDetector,colorize:!0},this.hoverService)}getInputBoxOptions(e,i){return i?{initialValue:e.value,ariaLabel:u("typeNewValue","Type new value"),onFinish:async(n,o)=>{if(o&&n){let s=this.debugService.getViewModel().focusedStackFrame;s&&(e instanceof Li||e instanceof Hi)&&(await e.setExpression(n,s),this.debugService.getViewModel().updateViews())}}}:{initialValue:e.name?e.name:"",ariaLabel:u("watchExpressionInputAriaLabel","Type watch expression"),placeholder:u("watchExpressionPlaceholder","Expression to watch"),onFinish:(n,o)=>{o&&n?(this.debugService.renameWatchExpression(e.getId(),n),_Z=!0,this.debugService.getViewModel().updateViews(),_Z=!1):e.name||this.debugService.removeWatchExpressions(e.getId())}}}renderActionBar(e,i){let n=wke(this.contextKeyService,i),o=i,s=this.menuService.getMenuActions(V.DebugWatchContext,n,{arg:o,shouldForwardArgs:!1}),a=[];sa(s,{primary:a,secondary:[]},"inline"),e.clear(),e.context=o,e.push(a,{icon:!0,label:!1})}};Rv=E([b(1,jt),b(2,re),b(3,we),b(4,so),b(5,Nt),b(6,se)],Rv);function wke(r,t){return r.createOverlay([[fb.key,t.memoryReference!==void 0],[xh.key,"expression"]])}var RZ=class{getWidgetAriaLabel(){return u({comment:["Debug is a noun in this context, not a verb."],key:"watchAriaTreeLabel"},"Debug Watch Expressions")}getAriaLabel(t){return t instanceof Hi?u("watchExpressionAriaLabel","{0}, value {1}",t.name,t.value):u("watchVariableAriaLabel","{0}, value {1}",t.name,t.value)}},PZ=class{constructor(t){this.debugService=t}onDragOver(t,e,i,n,o){if(!(t instanceof Cc))return!1;let s=t.elements;if(!(s.length>0&&s[0]instanceof Hi))return!1;let a;if(i===void 0)a="drop-target-after",i=-1;else switch(n){case 0:case 1:a="drop-target-before";break;case 2:case 3:a="drop-target-after";break}return{accept:!0,effect:{type:1,position:a},feedback:[i]}}getDragURI(t){return!(t instanceof Hi)||t===this.debugService.getViewModel().getSelectedExpression()?.expression?null:t.getId()}getDragLabel(t){if(t.length===1)return t[0].name}drop(t,e,i,n,o){if(!(t instanceof Cc))return;let s=t.elements[0];if(!(s instanceof Hi))throw new Error("Invalid dragged element");let a=this.debugService.getModel().getWatchExpressions(),l=a.indexOf(s),d;if(e instanceof Hi){switch(d=a.indexOf(e),n){case 3:case 2:d++;break}l<d&&d--}else d=a.length-1;this.debugService.moveWatchExpression(s.getId(),d)}dispose(){}};he(class extends tr{constructor(){super({id:"watch.collapse",viewId:Mu,title:u("collapse","Collapse All"),f1:!1,icon:N.collapseAll,precondition:sV,menu:{id:V.ViewTitle,order:30,group:"navigation",when:P.equals("view",Mu)}})}runInView(t,e){e.collapseAll()}});var MZ="workbench.debug.viewlet.action.addWatchExpression",AZ=u("addWatchExpression","Add Expression");he(class extends Me{constructor(){super({id:MZ,title:AZ,f1:!1,icon:Bde,menu:{id:V.ViewTitle,group:"navigation",when:P.equals("view",Mu)}})}run(t){t.get(we).addWatchExpression()}});var OZ="workbench.debug.viewlet.action.removeAllWatchExpressions",NZ=u("removeAllWatchExpressions","Remove All Expressions");he(class extends Me{constructor(){super({id:OZ,title:NZ,f1:!1,icon:Nde,precondition:sV,menu:{id:V.ViewTitle,order:20,group:"navigation",when:P.equals("view",Mu)}})}run(t){t.get(we).removeWatchExpressions()}});var d_=class{constructor(t,e,i,n){this.debugService=e;this.configurationService=i;this.dialogService=n;this.disposable=t.onBeforeShutdown(async o=>o.veto(this.shouldVetoShutdown(o.reason),"veto.debug"))}disposable;shouldVetoShutdown(t){let e=this.debugService.getModel().getSessions().filter(n=>n.parentSession===void 0);return e.length===0||this.configurationService.getValue("debug").confirmOnExit==="never"?!1:this.showWindowCloseConfirmation(e.length)}dispose(){return this.disposable.dispose()}async showWindowCloseConfirmation(t){let e;return t===1?e=u("debug.debugSessionCloseConfirmationSingular","There is an active debug session, are you sure you want to stop it?"):e=u("debug.debugSessionCloseConfirmationPlural","There are active debug sessions, are you sure you want to stop them?"),!(await this.dialogService.confirm({message:e,type:"warning",primaryButton:u({key:"debug.stop",comment:["&& denotes a mnemonic"]},"&&Stop Debugging")})).confirmed}};d_=E([b(0,er),b(1,we),b(2,se),b(3,Io)],d_);var $Qo=q("INotebookExecutionService");var p5=q("INotebookExecutionStateService");var h5=100;var m5=q("INotebookKernelService"),PZo=q("INotebookKernelHistoryService");var pge="workbench.editor.notebook";var HJo=["application/json","application/javascript","text/html","image/svg+xml",Oo.latex,Oo.markdown,"image/png","image/jpeg",Oo.text],UJo=[Oo.latex,Oo.markdown,"application/json","text/html","image/svg+xml","image/png","image/jpeg",Oo.text];var Eke;(i=>{i.scheme=Ie.vscodeNotebookMetadata;function t(n){return qme(n)}i.generate=t;function e(n){return Gme(n)}i.parse=e})(Eke||={});var wM;(a=>{a.scheme=Ie.vscodeNotebookCell;function t(l,d){return Kme(l,d)}a.generate=t;function e(l){return aZ(l)}a.parse=e;function i(l,d){return l.with({scheme:Ie.vscodeNotebookCellOutput,fragment:`op${d??""},${l.scheme!==Ie.file?l.scheme:""}`})}a.generateCellOutputUri=i;function n(l){if(l.scheme!==Ie.vscodeNotebookCellOutput)return;let d=/^op([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})?\,(.*)$/i.exec(l.fragment);if(!d)return;let c=d[1]&&d[1]!==""?d[1]:void 0,p=d[2];return{outputId:c,notebook:l.with({scheme:p||Ie.file,fragment:null})}}a.parseCellOutputUri=n;function o(l,d,c){return a.generate(l,d).with({scheme:c})}a.generateCellPropertyUri=o;function s(l,d){if(l.scheme===d)return a.parse(l.with({scheme:a.scheme}))}a.parseCellPropertyUri=s})(wM||={});function hge(r,t,e,i=(n,o)=>n===o){let n=[];function o(l,d,c){if(d===0&&c.length===0)return;let p=n[n.length-1];p&&p.start+p.deleteCount===l?(p.deleteCount+=d,p.toInsert.push(...c)):n.push({start:l,deleteCount:d,toInsert:c})}let s=0,a=0;for(;;){if(s===r.length){o(s,0,t.slice(a));break}if(a===t.length){o(s,r.length-s,[]);break}let l=r[s],d=t[a];if(i(l,d)){s+=1,a+=1;continue}e(d)?(o(s,1,[]),s+=1):(o(s,0,[d]),a+=1)}return n}var zJo=new A("notebookEditorCursorAtBoundary","none"),KJo=new A("notebookEditorCursorAtLineBoundary","none");var it={displayOrder:"notebook.displayOrder",cellToolbarLocation:"notebook.cellToolbarLocation",cellToolbarVisibility:"notebook.cellToolbarVisibility",showCellStatusBar:"notebook.showCellStatusBar",textDiffEditorPreview:"notebook.diff.enablePreview",diffOverviewRuler:"notebook.diff.overviewRuler",experimentalInsertToolbarAlignment:"notebook.experimental.insertToolbarAlignment",compactView:"notebook.compactView",focusIndicator:"notebook.cellFocusIndicator",insertToolbarLocation:"notebook.insertToolbarLocation",globalToolbar:"notebook.globalToolbar",stickyScrollEnabled:"notebook.stickyScroll.enabled",stickyScrollMode:"notebook.stickyScroll.mode",undoRedoPerCell:"notebook.undoRedoPerCell",consolidatedOutputButton:"notebook.consolidatedOutputButton",showFoldingControls:"notebook.showFoldingControls",dragAndDropEnabled:"notebook.dragAndDropEnabled",cellEditorOptionsCustomizations:"notebook.editorOptionsCustomizations",consolidatedRunButton:"notebook.consolidatedRunButton",openGettingStarted:"notebook.experimental.openGettingStarted",globalToolbarShowLabel:"notebook.globalToolbarShowLabel",markupFontSize:"notebook.markup.fontSize",markdownLineHeight:"notebook.markdown.lineHeight",interactiveWindowCollapseCodeCells:"interactiveWindow.collapseCellInputCode",outputScrollingDeprecated:"notebook.experimental.outputScrolling",outputScrolling:"notebook.output.scrolling",textOutputLineLimit:"notebook.output.textLineLimit",LinkifyOutputFilePaths:"notebook.output.linkifyFilePaths",minimalErrorRendering:"notebook.output.minimalErrorRendering",formatOnSave:"notebook.formatOnSave.enabled",insertFinalNewline:"notebook.insertFinalNewline",defaultFormatter:"notebook.defaultFormatter",formatOnCellExecution:"notebook.formatOnCellExecution",codeActionsOnSave:"notebook.codeActionsOnSave",outputWordWrap:"notebook.output.wordWrap",outputLineHeightDeprecated:"notebook.outputLineHeight",outputLineHeight:"notebook.output.lineHeight",outputFontSizeDeprecated:"notebook.outputFontSize",outputFontSize:"notebook.output.fontSize",outputFontFamilyDeprecated:"notebook.outputFontFamily",outputFontFamily:"notebook.output.fontFamily",findFilters:"notebook.find.filters",logging:"notebook.logging",confirmDeleteRunningCell:"notebook.confirmDeleteRunningCell",remoteSaving:"notebook.experimental.remoteSave",gotoSymbolsAllSymbols:"notebook.gotoSymbols.showAllSymbols",outlineShowMarkdownHeadersOnly:"notebook.outline.showMarkdownHeadersOnly",outlineShowCodeCells:"notebook.outline.showCodeCells",outlineShowCodeCellSymbols:"notebook.outline.showCodeCellSymbols",breadcrumbsShowCodeCells:"notebook.breadcrumbs.showCodeCells",scrollToRevealCell:"notebook.scrolling.revealNextCellOnExecute",cellChat:"notebook.experimental.cellChat",cellGenerate:"notebook.experimental.generate",notebookVariablesView:"notebook.experimental.variablesView",InteractiveWindowPromptToSave:"interactiveWindow.promptToSaveOnClose",cellFailureDiagnostics:"notebook.cellFailureDiagnostics",outputBackupSizeLimit:"notebook.backup.sizeLimit"};function BZ(r){return["application/vnd.code.notebook.stdout","application/vnd.code.notebook.stderr"].includes(r)}var xke=new TextDecoder;function mge(r){let t=[],e=!1;for(let s of r)(t.length===0||e)&&(t.push(s),e=!0);let i=_ke(t),n=Jt.concat(t.map(s=>Jt.wrap(s))),o=Pke(n);return i=i||o.byteLength!==n.byteLength,{data:o,didCompression:i}}var g5="\x1B[A",FZ=g5.split("").map(r=>r.charCodeAt(0)),Tke=10;function _ke(r){let t=!1;return r.forEach((e,i)=>{if(i===0||e.length<g5.length)return;let n=r[i-1],o=e.subarray(0,g5.length);if(o[0]===FZ[0]&&o[1]===FZ[1]&&o[2]===FZ[2]){let s=n.lastIndexOf(Tke);if(s===-1)return;t=!0,r[i-1]=n.subarray(0,s),r[i]=e.subarray(g5.length)}}),t}function Dke(r){let t=r;do r=t,t=r.replace(/[^\n]\x08/gm,"");while(t.length<r.length);return r}function kke(r){for(r=r.replace(/\r+\n/gm,`
`);r.search(/\r[^$]/g)>-1;){let t=r.match(/^(.*)\r+/m)[1],e=r.match(/\r+(.*)$/m)[1];e=e+t.slice(e.length,t.length),r=r.replace(/\r+.*$/m,"\r").replace(/^.*\r/m,e)}return r}var Lke=8,Rke=13;function Pke(r){return!r.buffer.includes(Lke)&&!r.buffer.includes(Rke)?r:Jt.fromString(kke(Dke(xke.decode(r.buffer))))}var Pv=class extends R{constructor(e){super();this._rawOutput=e;this._alternativeOutputId=this._rawOutput.outputId}_onDidChangeData=this._register(new x);onDidChangeData=this._onDidChangeData.event;get outputs(){return this._rawOutput.outputs||[]}get metadata(){return this._rawOutput.metadata}get outputId(){return this._rawOutput.outputId}_alternativeOutputId;get alternativeOutputId(){return this._alternativeOutputId}_versionId=0;get versionId(){return this._versionId}replaceData(e){this.versionedBufferLengths={},this._rawOutput=e,this.optimizeOutputItems(),this._versionId=this._versionId+1,this._onDidChangeData.fire()}appendData(e){this.trackBufferLengths(),this._rawOutput.outputs.push(...e),this.optimizeOutputItems(),this._versionId=this._versionId+1,this._onDidChangeData.fire()}trackBufferLengths(){this.outputs.forEach(e=>{BZ(e.mime)&&(this.versionedBufferLengths[e.mime]||(this.versionedBufferLengths[e.mime]={}),this.versionedBufferLengths[e.mime][this.versionId]=e.data.byteLength)})}versionedBufferLengths={};appendedSinceVersion(e,i){let n=this.versionedBufferLengths[i]?.[e],o=this.outputs.find(s=>s.mime===i);if(n&&o)return o.data.slice(n)}optimizeOutputItems(){if(this.outputs.length>1&&this.outputs.every(e=>BZ(e.mime))){let e=new Map,i=[];this.outputs.forEach(n=>{let o;e.has(n.mime)?o=e.get(n.mime):(o=[],e.set(n.mime,o),i.push(n.mime)),o.push(n.data.buffer)}),this.outputs.length=0,i.forEach(n=>{let o=mge(e.get(n));this.outputs.push({mime:n,data:o.data}),o.didCompression&&(this.versionedBufferLengths={})})}}asDto(){return{metadata:this._rawOutput.metadata,outputs:this._rawOutput.outputs,outputId:this._rawOutput.outputId}}bumpVersion(){this._versionId=this._versionId+1}};var EM=class r extends R{constructor(e,i,n,o,s,a,l,d,c,p,h,m,f=void 0){super();this.uri=e;this.handle=i;this._source=n;this._language=o;this._mime=s;this.cellKind=a;this.collapseState=p;this.transientOptions=h;this._languageService=m;this._languageDetectionService=f;this._outputs=l.map(g=>new Pv(g)),this._metadata=d??{},this._internalMetadata=c??{}}_onDidChangeOutputs=this._register(new x);onDidChangeOutputs=this._onDidChangeOutputs.event;_onDidChangeOutputItems=this._register(new x);onDidChangeOutputItems=this._onDidChangeOutputItems.event;_onDidChangeContent=this._register(new x);onDidChangeContent=this._onDidChangeContent.event;_onDidChangeMetadata=this._register(new x);onDidChangeMetadata=this._onDidChangeMetadata.event;_onDidChangeInternalMetadata=this._register(new x);onDidChangeInternalMetadata=this._onDidChangeInternalMetadata.event;_onDidChangeLanguage=this._register(new x);onDidChangeLanguage=this._onDidChangeLanguage.event;_outputs;get outputs(){return this._outputs}_metadata;get metadata(){return this._metadata}set metadata(e){this._metadata=e,this._hash=null,this._onDidChangeMetadata.fire()}_internalMetadata;get internalMetadata(){return this._internalMetadata}set internalMetadata(e){let i=this._internalMetadata.lastRunSuccess!==e.lastRunSuccess;e={...e,runStartTimeAdjustment:Mke(this._internalMetadata,e)},this._internalMetadata=e,this._hash=null,this._onDidChangeInternalMetadata.fire({lastRunSuccessChanged:i})}get language(){return this._language}set language(e){this._textModel&&this._textModel.getLanguageId()===this._languageService.getLanguageIdByLanguageName(e)&&this._textModel.getLanguageId()===this._languageService.getLanguageIdByLanguageName(this.language)||(this._hasLanguageSetExplicitly=!0,this._setLanguageInternal(e))}get mime(){return this._mime}set mime(e){this._mime!==e&&(this._mime=e,this._hash=null,this._onDidChangeContent.fire("mime"))}_textBuffer;get textBuffer(){if(this._textBuffer)return this._textBuffer;let e=new Kf;e.acceptChunk(this._source);let i=e.finish(!0),{textBuffer:n,disposable:o}=i.create(1);return this._textBuffer=n,this._register(o),this._register(this._textBuffer.onDidChangeContent(()=>{this._hash=null,this._textModel||this._onDidChangeContent.fire("content"),this.autoDetectLanguage()})),this._textBuffer}_textBufferHash=null;_hash=null;_versionId=1;_alternativeId=1;get alternativeId(){return this._alternativeId}_textModelDisposables=this._register(new B);_textModel=void 0;get textModel(){return this._textModel}set textModel(e){this._textModel!==e&&(this._textModelDisposables.clear(),this._textModel=e,this._textModel&&(this.setRegisteredLanguage(this._languageService,this._textModel.getLanguageId(),this.language),this._textModelDisposables.add(this._textModel.onDidChangeLanguage(i=>this.setRegisteredLanguage(this._languageService,i.newLanguage,this.language))),this._textModelDisposables.add(this._textModel.onWillDispose(()=>this.textModel=void 0)),this._textModelDisposables.add(this._textModel.onDidChangeContent(()=>{this._textModel&&(this._versionId=this._textModel.getVersionId(),this._alternativeId=this._textModel.getAlternativeVersionId()),this._textBufferHash=null,this._onDidChangeContent.fire("content")})),this._textModel._overwriteVersionId(this._versionId),this._textModel._overwriteAlternativeVersionId(this._versionId)))}setRegisteredLanguage(e,i,n){let o=i===jn||i==="jupyter";!e.isRegisteredLanguageId(n)&&o?this._onDidChangeLanguage.fire(n):this.language=i}static AUTO_DETECT_LANGUAGE_THROTTLE_DELAY=600;autoDetectLanguageThrottler=this._register(new lf(r.AUTO_DETECT_LANGUAGE_THROTTLE_DELAY));_autoLanguageDetectionEnabled=!1;_hasLanguageSetExplicitly=!1;get hasLanguageSetExplicitly(){return this._hasLanguageSetExplicitly}enableAutoLanguageDetection(){this._autoLanguageDetectionEnabled=!0,this.autoDetectLanguage()}async autoDetectLanguage(){this._autoLanguageDetectionEnabled&&this.autoDetectLanguageThrottler.trigger(()=>this._doAutoDetectLanguage())}async _doAutoDetectLanguage(){if(this.hasLanguageSetExplicitly)return;let e=await this._languageDetectionService?.detectLanguage(this.uri);e&&(this._textModel&&this._textModel.getLanguageId()===this._languageService.getLanguageIdByLanguageName(e)&&this._textModel.getLanguageId()===this._languageService.getLanguageIdByLanguageName(this.language)||this._setLanguageInternal(e))}_setLanguageInternal(e){let i=this._languageService.getLanguageIdByLanguageName(e);if(i!==null){if(this._textModel){let n=this._languageService.createById(i);this._textModel.setLanguage(n.languageId)}this._language!==e&&(this._language=e,this._hash=null,this._onDidChangeLanguage.fire(e),this._onDidChangeContent.fire("language"))}}resetTextBuffer(e){this._textBuffer=e}getValue(){let e=this.getFullModelRange();return this.textBuffer.getEOL()===`
`?this.textBuffer.getValueInRange(e,1):this.textBuffer.getValueInRange(e,2)}getTextBufferHash(){if(this._textBufferHash!==null)return this._textBufferHash;let e=new OA,i=this.textBuffer.createSnapshot(!1),n;for(;n=i.read();)e.update(n);return this._textBufferHash=e.digest(),this._textBufferHash}getHashValue(){return this._hash!==null?this._hash:(this._hash=wr([wr(this.language),this.getTextBufferHash(),this._getPersisentMetadata(),this.transientOptions.transientOutputs?[]:this._outputs.map(e=>({outputs:e.outputs.map(i=>({mime:i.mime,data:Array.from(i.data.buffer)})),metadata:e.metadata}))]),this._hash)}_getPersisentMetadata(){return Ake(this.transientOptions.transientCellMetadata,this.metadata,this.language)}getTextLength(){return this.textBuffer.getLength()}getFullModelRange(){let e=this.textBuffer.getLineCount();return new L(1,1,e,this.textBuffer.getLineLength(e)+1)}spliceNotebookCellOutputs(e){if(e.deleteCount>0&&e.newOutputs.length>0){let i=Math.min(e.deleteCount,e.newOutputs.length);for(let o=0;o<i;o++){let s=this.outputs[e.start+o],a=e.newOutputs[o];this.replaceOutput(s.outputId,a)}this.outputs.splice(e.start+i,e.deleteCount-i,...e.newOutputs.slice(i)).forEach(o=>o.dispose()),this._onDidChangeOutputs.fire({start:e.start+i,deleteCount:e.deleteCount-i,newOutputs:e.newOutputs.slice(i)})}else this.outputs.splice(e.start,e.deleteCount,...e.newOutputs).forEach(n=>n.dispose()),this._onDidChangeOutputs.fire(e)}replaceOutput(e,i){let n=this.outputs.findIndex(s=>s.outputId===e);return n<0?!1:(this.outputs[n].replaceData({outputs:i.outputs,outputId:i.outputId,metadata:i.metadata}),i.dispose(),this._onDidChangeOutputItems.fire(),!0)}changeOutputItems(e,i,n){let o=this.outputs.findIndex(a=>a.outputId===e);if(o<0)return!1;let s=this.outputs[o];return i?s.appendData(n):s.replaceData({outputId:e,outputs:n,metadata:s.metadata}),this._onDidChangeOutputItems.fire(),!0}_outputNotEqualFastCheck(e,i){if(e.length!==i.length)return!1;for(let n=0;n<this.outputs.length;n++){let o=e[n],s=i[n];if(o.outputs.length!==s.outputs.length)return!1;for(let a=0;a<o.outputs.length;a++)if(o.outputs[a].mime!==s.outputs[a].mime||o.outputs[a].data.byteLength!==s.outputs[a].data.byteLength)return!1}return!0}equal(e){return this.language!==e.language||this.outputs.length!==e.outputs.length||this.getTextLength()!==e.getTextLength()||!this.transientOptions.transientOutputs&&!this._outputNotEqualFastCheck(this.outputs,e.outputs)?!1:this.getHashValue()===e.getHashValue()}fastEqual(e){return this.language!==e.language||this.mime!==e.mime||this.cellKind!==e.cellKind||this.internalMetadata?.executionOrder!==e.internalMetadata?.executionOrder||this.internalMetadata?.lastRunSuccess!==e.internalMetadata?.lastRunSuccess||this.internalMetadata?.runStartTime!==e.internalMetadata?.runStartTime||this.internalMetadata?.runStartTimeAdjustment!==e.internalMetadata?.runStartTimeAdjustment||this.internalMetadata?.runEndTime!==e.internalMetadata?.runEndTime||this._textBuffer&&this.getValue()!==e.source?!1:this._source===e.source}dispose(){_e(this._outputs);let e=new zf([],"",`
`,!1,!1,!0,!0);e.dispose(),this._textBuffer=e,super.dispose()}};function Mke(r,t){if(r.runStartTime!==t.runStartTime&&typeof t.runStartTime=="number"){let e=Date.now()-t.runStartTime;return e<0?Math.abs(e):0}else return t.runStartTimeAdjustment}function Ake(r,t,e){let i={};if(r){let s=new Set([...Object.keys(t)]);for(let a of s)r[a]||(i[a]=t[a])}else i=t;let n={language:e,...i};return e&&(n.language=e),qae(n,{})}var f5=class{constructor(t,e,i,n,o,s,a){this.resource=t;this.fromIndex=e;this.length=i;this.toIndex=n;this.editingDelegate=o;this.beforedSelections=s;this.endSelections=a}type=0;get label(){return this.length===1?"Move Cell":"Move Cells"}code="undoredo.textBufferEdit";undo(){if(!this.editingDelegate.moveCell)throw new Error("Notebook Move Cell not implemented for Undo/Redo");this.editingDelegate.moveCell(this.toIndex,this.length,this.fromIndex,this.endSelections,this.beforedSelections)}redo(){if(!this.editingDelegate.moveCell)throw new Error("Notebook Move Cell not implemented for Undo/Redo");this.editingDelegate.moveCell(this.fromIndex,this.length,this.toIndex,this.beforedSelections,this.endSelections)}},b5=class{constructor(t,e,i,n,o){this.resource=t;this.diffs=e;this.editingDelegate=i;this.beforeHandles=n;this.endHandles=o}type=0;get label(){return this.diffs.length===1&&this.diffs[0][1].length===0?this.diffs[0][2].length>1?"Insert Cells":"Insert Cell":this.diffs.length===1&&this.diffs[0][2].length===0?this.diffs[0][1].length>1?"Delete Cells":"Delete Cell":"Insert Cell"}code="undoredo.textBufferEdit";undo(){if(!this.editingDelegate.replaceCell)throw new Error("Notebook Replace Cell not implemented for Undo/Redo");this.diffs.forEach(t=>{this.editingDelegate.replaceCell(t[0],t[2].length,t[1],this.beforeHandles)})}redo(){if(!this.editingDelegate.replaceCell)throw new Error("Notebook Replace Cell not implemented for Undo/Redo");this.diffs.reverse().forEach(t=>{this.editingDelegate.replaceCell(t[0],t[1].length,t[2],this.endHandles)})}},v5=class{constructor(t,e,i,n,o){this.resource=t;this.index=e;this.oldMetadata=i;this.newMetadata=n;this.editingDelegate=o}type=0;label="Update Cell Metadata";code="undoredo.textBufferEdit";undo(){this.editingDelegate.updateCellMetadata&&this.editingDelegate.updateCellMetadata(this.index,this.oldMetadata)}redo(){this.editingDelegate.updateCellMetadata&&this.editingDelegate.updateCellMetadata(this.index,this.newMetadata)}};var VZ=class{constructor(t,e,i,n,o,s){this.textModel=t;this.undoRedoGroup=e;this._pauseableEmitter=i;this._postUndoRedo=n;this.type=1,this._beginSelectionState=o,this._beginAlternativeVersionId=s,this._resultAlternativeVersionId=s}type;get code(){return this._operations.length===1?this._operations[0].code:"undoredo.notebooks.stackOperation"}_operations=[];_beginSelectionState=void 0;_resultSelectionState=void 0;_beginAlternativeVersionId;_resultAlternativeVersionId;get label(){return this._operations.length===1?this._operations[0].label:"edit"}get resources(){return[this.textModel.uri]}get isEmpty(){return this._operations.length===0}pushEndState(t,e){this._resultAlternativeVersionId=t,this._resultSelectionState=e||this._resultSelectionState}pushEditOperation(t,e,i,n){this._operations.length===0&&(this._beginSelectionState=this._beginSelectionState??e),this._operations.push(t),this._resultSelectionState=i,this._resultAlternativeVersionId=n}async undo(){this._pauseableEmitter.pause();try{for(let t=this._operations.length-1;t>=0;t--)await this._operations[t].undo();this._postUndoRedo(this._beginAlternativeVersionId),this._pauseableEmitter.fire({rawEvents:[],synchronous:void 0,versionId:this.textModel.versionId,endSelectionState:this._beginSelectionState})}finally{this._pauseableEmitter.resume()}}async redo(){this._pauseableEmitter.pause();try{for(let t=0;t<this._operations.length;t++)await this._operations[t].redo();this._postUndoRedo(this._resultAlternativeVersionId),this._pauseableEmitter.fire({rawEvents:[],synchronous:void 0,versionId:this.textModel.versionId,endSelectionState:this._resultSelectionState})}finally{this._pauseableEmitter.resume()}}},WZ=class{constructor(t,e,i,n){this._textModel=t;this._undoService=e;this._pauseableEmitter=i;this._postUndoRedo=n}_pendingStackOperation=null;isUndoStackEmpty(){return this._pendingStackOperation===null||this._pendingStackOperation.isEmpty}pushStackElement(t,e){this._pendingStackOperation&&!this._pendingStackOperation.isEmpty&&(this._pendingStackOperation.pushEndState(t,e),this._undoService.pushElement(this._pendingStackOperation,this._pendingStackOperation.undoRedoGroup)),this._pendingStackOperation=null}_getOrCreateEditStackElement(t,e,i){return this._pendingStackOperation??=new VZ(this._textModel,e,this._pauseableEmitter,this._postUndoRedo,t,i||"")}pushEditOperation(t,e,i,n,o){this._getOrCreateEditStackElement(e,o,n).pushEditOperation(t,e,i,n)}},HZ=class extends hd{get isEmpty(){return this._eventQueue.isEmpty()}isDirtyEvent(){for(let t of this._eventQueue)for(let e=0;e<t.rawEvents.length;e++)if(!t.rawEvents[e].transient)return!0;return!1}},c_=class extends R{constructor(e,i,n,o,s,a,l,d,c){super();this.viewType=e;this.uri=i;this._undoService=a;this._modelService=l;this._languageService=d;this._languageDetectionService=c;this.transientOptions=s,this.metadata=o,this._initialize(n);let p=h=>{if(h.uri.scheme===Ie.vscodeNotebookCell&&h instanceof xa){let m=wM.parse(h.uri);if(m&&zi(m.notebook,this.uri)){let f=this._getCellIndexByHandle(m.handle);if(f>=0){let g=this.cells[f];g&&(g.textModel=h)}}}};this._register(l.onModelAdded(h=>p(h))),this._pauseableEmitter=new HZ({merge:h=>{let m=h[0],f=m.rawEvents,g=m.versionId,v=m.endSelectionState,I=m.synchronous;for(let y=1;y<h.length;y++)f.push(...h[y].rawEvents),g=h[y].versionId,v=h[y].endSelectionState!==void 0?h[y].endSelectionState:v,I=h[y].synchronous!==void 0?h[y].synchronous:I;return{rawEvents:f,versionId:g,endSelectionState:v,synchronous:I}}}),this._register(this._pauseableEmitter.event(h=>{h.rawEvents.length&&this._onDidChangeContent.fire(h)})),this._operationManager=new WZ(this,this._undoService,this._pauseableEmitter,h=>{this._increaseVersionId(!0),this._overwriteAlternativeVersionId(h)})}_isDisposed=!1;_onWillDispose=this._register(new x);_onWillAddRemoveCells=this._register(new x);_onDidChangeContent=this._register(new x);onWillDispose=this._onWillDispose.event;onWillAddRemoveCells=this._onWillAddRemoveCells.event;onDidChangeContent=this._onDidChangeContent.event;_cellhandlePool=0;_cellListeners=new Map;_cells=[];_defaultCollapseConfig;metadata={};transientOptions={transientCellMetadata:{},transientDocumentMetadata:{},transientOutputs:!1,cellContentMetadata:{}};_versionId=0;_notebookSpecificAlternativeId=0;_alternativeVersionId="1";_operationManager;_pauseableEmitter;get length(){return this._cells.length}get cells(){return this._cells}get versionId(){return this._versionId}get alternativeVersionId(){return this._alternativeVersionId}get notebookType(){return this.viewType}setCellCollapseDefault(e){this._defaultCollapseConfig=e}_initialize(e,i){this._cells=[],this._versionId=0,this._notebookSpecificAlternativeId=0;let n=e.map(o=>{let s=this._cellhandlePool++,a=wM.generate(this.uri,s),l=this._getDefaultCollapseState(o);return new EM(a,s,o.source,o.language,o.mime,o.cellKind,o.outputs,o.metadata,o.internalMetadata,l,this.transientOptions,this._languageService,this._languageDetectionService)});for(let o=0;o<n.length;o++){let s=n[o].onDidChangeContent(a=>{this._bindCellContentHandler(n[o],a)});this._cellListeners.set(n[o].handle,s),this._register(n[o])}this._cells.splice(0,0,...n),this._alternativeVersionId=this._generateAlternativeId(),i&&this._pauseableEmitter.fire({rawEvents:[{kind:100,transient:!1}],versionId:this.versionId,synchronous:!0,endSelectionState:void 0})}_bindCellContentHandler(e,i){switch(this._increaseVersionId(i==="content"),i){case"content":this._pauseableEmitter.fire({rawEvents:[{kind:10,index:this._getCellIndexByHandle(e.handle),transient:!1}],versionId:this.versionId,synchronous:!0,endSelectionState:void 0});break;case"language":this._pauseableEmitter.fire({rawEvents:[{kind:5,index:this._getCellIndexByHandle(e.handle),language:e.language,transient:!1}],versionId:this.versionId,synchronous:!0,endSelectionState:void 0});break;case"mime":this._pauseableEmitter.fire({rawEvents:[{kind:13,index:this._getCellIndexByHandle(e.handle),mime:e.mime,transient:!1}],versionId:this.versionId,synchronous:!0,endSelectionState:void 0});break}}_generateAlternativeId(){return`${this._notebookSpecificAlternativeId}_`+this.cells.map(e=>e.handle+","+e.alternativeId).join(";")}dispose(){this._isDisposed||(this._isDisposed=!0,this._onWillDispose.fire(),this._undoService.removeElements(this.uri),_e(this._cellListeners.values()),this._cellListeners.clear(),_e(this._cells),this._cells=[],super.dispose())}pushStackElement(){}_getCellIndexByHandle(e){return this.cells.findIndex(i=>i.handle===e)}_getCellIndexWithOutputIdHandleFromEdits(e,i){let n=i.find(o=>"outputs"in o&&o.outputs.some(s=>s.outputId===e));if(n){if("index"in n)return n.index;if("handle"in n){let o=this._getCellIndexByHandle(n.handle);return this._assertIndex(o),o}}return-1}_getCellIndexWithOutputIdHandle(e){return this.cells.findIndex(i=>!!i.outputs.find(n=>n.outputId===e))}reset(e,i,n){this.transientOptions=n;let o=c_.computeEdits(this,e);this.applyEdits([...o,{editType:5,metadata:i}],!0,void 0,()=>{},void 0,!1)}static computeEdits(e,i){let n=[],o=this._commonPrefix(e.cells,e.cells.length,0,i,i.length,0);if(o>0)for(let a=0;a<o;a++)n.push({editType:3,index:a,metadata:i[a].metadata??{}},...this._computeOutputEdit(a,e.cells[a].outputs,i[a].outputs));if(e.cells.length===i.length&&o===e.cells.length)return n;let s=this._commonSuffix(e.cells,e.cells.length-o,o,i,i.length-o,o);if(s>0?n.push({editType:1,index:o,count:e.cells.length-o-s,cells:i.slice(o,i.length-s)}):o>0?n.push({editType:1,index:o,count:e.cells.length-o,cells:i.slice(o)}):n.push({editType:1,index:0,count:e.cells.length,cells:i}),s>0)for(let a=s;a>0;a--)n.push({editType:3,index:e.cells.length-a,metadata:i[i.length-a].metadata??{}},...this._computeOutputEdit(e.cells.length-a,e.cells[e.cells.length-a].outputs,i[i.length-a].outputs));return n}static _computeOutputEdit(e,i,n){return i.length!==n.length?[{editType:2,index:e,outputs:n,append:!1}]:i.length===0?[]:n.map((o,s)=>({editType:7,outputId:i[s].outputId,items:o.outputs,append:!1}))}static _commonPrefix(e,i,n,o,s,a){let l=Math.min(i,s),d=0;for(let c=0;c<l&&e[n+c].fastEqual(o[a+c]);c++)d++;return d}static _commonSuffix(e,i,n,o,s,a){let l=Math.min(i,s),d=0;for(let c=0;c<l&&e[n+i-c-1].fastEqual(o[a+s-c-1]);c++)d++;return d}applyEdits(e,i,n,o,s,a){this._pauseableEmitter.pause(),this._operationManager.pushStackElement(this._alternativeVersionId,void 0);try{return this._doApplyEdits(e,i,a,n,s),!0}finally{if(!this._pauseableEmitter.isEmpty){let l=o();this._increaseVersionId(this._operationManager.isUndoStackEmpty()&&!this._pauseableEmitter.isDirtyEvent()),this._operationManager.pushStackElement(this._alternativeVersionId,l),this._pauseableEmitter.fire({rawEvents:[],versionId:this.versionId,synchronous:i,endSelectionState:l})}this._pauseableEmitter.resume()}}_doApplyEdits(e,i,n,o,s){let a=e.map((c,p)=>{let h=-1;if("index"in c)h=c.index;else if("handle"in c)h=this._getCellIndexByHandle(c.handle),this._assertIndex(h);else if("outputId"in c){if(h=this._getCellIndexWithOutputIdHandle(c.outputId),this._indexIsInvalid(h)&&(h=this._getCellIndexWithOutputIdHandleFromEdits(c.outputId,e.slice(0,p))),this._indexIsInvalid(h))return null}else if(c.editType!==5)throw new Error("Invalid cell edit");return{edit:c,cellIndex:h,end:c.editType===5?void 0:c.editType===1?c.index+c.count:h,originalIndex:p}}).filter(go),d=this._mergeCellEdits(a).sort((c,p)=>c.end===void 0||p.end===void 0?-1:p.end-c.end||p.originalIndex-c.originalIndex).reduce((c,p)=>{if(!c.length)c.push([p]);else{let h=c[c.length-1],m=h[0].cellIndex;p.cellIndex===m?h.push(p):c.push([p])}return c},[]).map(c=>{let p=[],h=[];return c.forEach(m=>{m.edit.editType===1?p.push(m):h.push(m)}),[...h.reverse(),...p]}).flat();for(let{edit:c,cellIndex:p}of d)switch(c.editType){case 1:this._replaceCells(c.index,c.count,c.cells,i,n,o,s);break;case 2:{this._assertIndex(p);let h=this._cells[p];c.append?this._spliceNotebookCellOutputs(h,{start:h.outputs.length,deleteCount:0,newOutputs:c.outputs.map(m=>new Pv(m))},!0,n):this._spliceNotebookCellOutputs2(h,c.outputs,n);break}case 7:{this._assertIndex(p);let h=this._cells[p];c.append?this._appendNotebookCellOutputItems(h,c.outputId,c.items):this._replaceNotebookCellOutputItems(h,c.outputId,c.items)}break;case 3:this._assertIndex(c.index),this._changeCellMetadata(this._cells[c.index],c.metadata,n,o,s);break;case 8:this._assertIndex(p),this._changeCellMetadataPartial(this._cells[p],c.metadata,n,o,s);break;case 9:this._assertIndex(p),this._changeCellInternalMetadataPartial(this._cells[p],c.internalMetadata);break;case 4:this._assertIndex(c.index),this._changeCellLanguage(this._cells[c.index],c.language,n,o,s);break;case 5:this._updateNotebookCellMetadata(c.metadata,n,o,s);break;case 6:this._moveCellToIdx(c.index,c.length,c.newIdx,i,n,o,void 0,s);break}}_mergeCellEdits(e){let i=[];return e.forEach(n=>{if(i.length){let o=i[i.length-1];o.edit.editType===2&&o.edit.append&&n.edit.editType===2&&n.edit.append&&o.cellIndex===n.cellIndex?o.edit.outputs=[...o.edit.outputs,...n.edit.outputs]:o.edit.editType===2&&!o.edit.append&&o.edit.outputs.length===0&&n.edit.editType===2&&n.edit.append&&o.cellIndex===n.cellIndex?(o.edit.append=!1,o.edit.outputs=n.edit.outputs):i.push(n)}else i.push(n)}),i}_getDefaultCollapseState(e){let i=e.cellKind===2?this._defaultCollapseConfig?.codeCell:this._defaultCollapseConfig?.markupCell;return e.collapseState??i??void 0}_replaceCells(e,i,n,o,s,a,l){if(i===0&&n.length===0)return;let d=this._cells.slice(0),c=new Set;d.forEach(g=>{c.add(g.handle)});for(let g=e;g<Math.min(e+i,this._cells.length);g++){let v=this._cells[g];this._cellListeners.get(v.handle)?.dispose(),this._cellListeners.delete(v.handle)}let p=n.map(g=>{let v=this._cellhandlePool++,I=wM.generate(this.uri,v),y=this._getDefaultCollapseState(g),w=new EM(I,v,g.source,g.language,g.mime,g.cellKind,g.outputs||[],g.metadata,g.internalMetadata,y,this.transientOptions,this._languageService,this._languageDetectionService),C=this._modelService.getModel(I);C&&C instanceof xa&&(w.textModel=C,w.language=g.language,w.textModel.setValue(g.source),w.resetTextBuffer(w.textModel.getTextBuffer()));let S=w.onDidChangeContent(D=>{this._bindCellContentHandler(w,D)});return this._cellListeners.set(w.handle,S),this._register(w),w}),h=this._cells.slice(0);h.splice(e,i,...p);let m=hge(this._cells,h,g=>c.has(g.handle)).map(g=>[g.start,g.deleteCount,g.toInsert]);this._onWillAddRemoveCells.fire({rawEvent:{kind:1,changes:m}}),this._cells=h;let f=m.map(g=>{let v=d.slice(g[0],g[0]+g[1]);return[g[0],v,g[2]]});s&&this._operationManager.pushEditOperation(new b5(this.uri,f,{insertCell:(g,v,I)=>{this._insertNewCell(g,[v],!0,I)},deleteCell:(g,v)=>{this._removeCell(g,1,!0,v)},replaceCell:(g,v,I,y)=>{this._replaceNewCells(g,v,I,!0,y)}},void 0,void 0),a,void 0,this._alternativeVersionId,l),this._pauseableEmitter.fire({rawEvents:[{kind:1,changes:m,transient:!1}],versionId:this.versionId,synchronous:o,endSelectionState:void 0})}_increaseVersionId(e){this._versionId=this._versionId+1,e||(this._notebookSpecificAlternativeId=this._versionId),this._alternativeVersionId=this._generateAlternativeId()}_overwriteAlternativeVersionId(e){this._alternativeVersionId=e,this._notebookSpecificAlternativeId=Number(e.substring(0,e.indexOf("_")))}_updateNotebookCellMetadata(e,i,n,o){let s=this.metadata,a=this._isDocumentMetadataChanged(this.metadata,e);if(a&&i){let l=this;this._operationManager.pushEditOperation(new class{type=0;get resource(){return l.uri}label="Update Cell Metadata";code="undoredo.textBufferEdit";undo(){l._updateNotebookCellMetadata(s,!1,n,o)}redo(){l._updateNotebookCellMetadata(e,!1,n,o)}},n,void 0,this._alternativeVersionId,o)}this.metadata=e,this._pauseableEmitter.fire({rawEvents:[{kind:11,metadata:this.metadata,transient:!a}],versionId:this.versionId,synchronous:!0,endSelectionState:void 0})}_insertNewCell(e,i,n,o){for(let a=0;a<i.length;a++){let l=i[a].onDidChangeContent(d=>{this._bindCellContentHandler(i[a],d)});this._cellListeners.set(i[a].handle,l)}let s=[[e,0,i]];this._onWillAddRemoveCells.fire({rawEvent:{kind:1,changes:s}}),this._cells.splice(e,0,...i),this._pauseableEmitter.fire({rawEvents:[{kind:1,changes:s,transient:!1}],versionId:this.versionId,synchronous:n,endSelectionState:o})}_removeCell(e,i,n,o){for(let a=e;a<e+i;a++){let l=this._cells[a];this._cellListeners.get(l.handle)?.dispose(),this._cellListeners.delete(l.handle)}let s=[[e,i,[]]];this._onWillAddRemoveCells.fire({rawEvent:{kind:1,changes:s}}),this._cells.splice(e,i),this._pauseableEmitter.fire({rawEvents:[{kind:1,changes:s,transient:!1}],versionId:this.versionId,synchronous:n,endSelectionState:o})}_replaceNewCells(e,i,n,o,s){for(let l=e;l<e+i;l++){let d=this._cells[l];this._cellListeners.get(d.handle)?.dispose(),this._cellListeners.delete(d.handle)}for(let l=0;l<n.length;l++){let d=n[l].onDidChangeContent(c=>{this._bindCellContentHandler(n[l],c)});this._cellListeners.set(n[l].handle,d)}let a=[[e,i,n]];this._onWillAddRemoveCells.fire({rawEvent:{kind:1,changes:a}}),this._cells.splice(e,i,...n),this._pauseableEmitter.fire({rawEvents:[{kind:1,changes:a,transient:!1}],versionId:this.versionId,synchronous:o,endSelectionState:s})}_isDocumentMetadataChanged(e,i){let n=new Set([...Object.keys(e||{}),...Object.keys(i||{})]);for(let o of n)if(o==="custom"){if(!this._customMetadataEqual(e[o],i[o])&&!this.transientOptions.transientDocumentMetadata[o])return!0}else if(e[o]!==i[o]&&!this.transientOptions.transientDocumentMetadata[o])return!0;return!1}_isCellMetadataChanged(e,i){let n=new Set([...Object.keys(e||{}),...Object.keys(i||{})]);for(let o of n)if(e[o]!==i[o]&&!this.transientOptions.transientCellMetadata[o])return!0;return!1}_customMetadataEqual(e,i){if(!e&&!i)return!0;if(!e||!i)return!1;let n=Object.getOwnPropertyNames(e),o=Object.getOwnPropertyNames(i);if(n.length!==o.length)return!1;for(let s=0;s<n.length;s++){let a=n[s];if(e[a]!==i[a])return!1}return!0}_changeCellMetadataPartial(e,i,n,o,s){let a={...e.metadata},l;for(l in i){let d=i[l]??void 0;a[l]=d}return this._changeCellMetadata(e,a,n,o,s)}_changeCellMetadata(e,i,n,o,s){let a=this._isCellMetadataChanged(e.metadata,i);if(a&&n){let l=this._cells.indexOf(e);this._operationManager.pushEditOperation(new v5(this.uri,l,Object.freeze(e.metadata),Object.freeze(i),{updateCellMetadata:(d,c)=>{let p=this._cells[d];p&&this._changeCellMetadata(p,c,!1,o,s)}}),o,void 0,this._alternativeVersionId,s)}e.metadata=i,this._pauseableEmitter.fire({rawEvents:[{kind:7,index:this._cells.indexOf(e),metadata:e.metadata,transient:!a}],versionId:this.versionId,synchronous:!0,endSelectionState:void 0})}_changeCellInternalMetadataPartial(e,i){let n={...e.internalMetadata},o;for(o in i){let s=i[o]??void 0;n[o]=s}e.internalMetadata=n,this._pauseableEmitter.fire({rawEvents:[{kind:12,index:this._cells.indexOf(e),internalMetadata:e.internalMetadata,transient:!0}],versionId:this.versionId,synchronous:!0,endSelectionState:void 0})}_changeCellLanguage(e,i,n,o,s){if(e.language===i)return;let a=e.language;if(e.language=i,n){let l=this;this._operationManager.pushEditOperation(new class{type=0;get resource(){return l.uri}label="Update Cell Language";code="undoredo.textBufferEdit";undo(){l._changeCellLanguage(e,a,!1,o,s)}redo(){l._changeCellLanguage(e,i,!1,o,s)}},o,void 0,this._alternativeVersionId,s)}this._pauseableEmitter.fire({rawEvents:[{kind:5,index:this._cells.indexOf(e),language:i,transient:!1}],versionId:this.versionId,synchronous:!0,endSelectionState:void 0})}_spliceNotebookCellOutputs2(e,i,n){if(i.length===0&&e.outputs.length===0)return;if(i.length<=1){this._spliceNotebookCellOutputs(e,{start:0,deleteCount:e.outputs.length,newOutputs:i.map(l=>new Pv(l))},!1,n);return}new Dm(new I5(e.outputs),new I5(i)).ComputeDiff(!1).changes.map(l=>({start:l.originalStart,deleteCount:l.originalLength,newOutputs:i.slice(l.modifiedStart,l.modifiedStart+l.modifiedLength).map(d=>new Pv(d))})).reverse().forEach(l=>{this._spliceNotebookCellOutputs(e,l,!1,n)})}_spliceNotebookCellOutputs(e,i,n,o){e.spliceNotebookCellOutputs(i),this._pauseableEmitter.fire({rawEvents:[{kind:8,index:this._cells.indexOf(e),outputs:e.outputs.map(s=>s.asDto())??[],append:n,transient:this.transientOptions.transientOutputs}],versionId:this.versionId,synchronous:!0,endSelectionState:void 0})}_appendNotebookCellOutputItems(e,i,n){e.changeOutputItems(i,!0,n)&&this._pauseableEmitter.fire({rawEvents:[{kind:9,index:this._cells.indexOf(e),outputId:i,outputItems:n,append:!0,transient:this.transientOptions.transientOutputs}],versionId:this.versionId,synchronous:!0,endSelectionState:void 0})}_replaceNotebookCellOutputItems(e,i,n){e.changeOutputItems(i,!1,n)&&this._pauseableEmitter.fire({rawEvents:[{kind:9,index:this._cells.indexOf(e),outputId:i,outputItems:n,append:!1,transient:this.transientOptions.transientOutputs}],versionId:this.versionId,synchronous:!0,endSelectionState:void 0})}_moveCellToIdx(e,i,n,o,s,a,l,d){s&&this._operationManager.pushEditOperation(new f5(this.uri,e,i,n,{moveCell:(p,h,m,f,g)=>{this._moveCellToIdx(p,h,m,!0,!1,f,g,d)}},a,l),a,l,this._alternativeVersionId,d),this._assertIndex(e),this._assertIndex(n);let c=this._cells.splice(e,i);return this._cells.splice(n,0,...c),this._pauseableEmitter.fire({rawEvents:[{kind:2,index:e,length:i,newIdx:n,cells:c,transient:!1}],versionId:this.versionId,synchronous:o,endSelectionState:l}),!0}_assertIndex(e){if(this._indexIsInvalid(e))throw new Error(`model index out of range ${e}`)}_indexIsInvalid(e){return e<0||e>=this._cells.length}findNextMatch(e,i,n,o,s){this._assertIndex(i.cellIndex);let l=new Iu(e,n,o,s).parseSearchRequest();if(!l)return null;let d=i.cellIndex,c=i.position;for(;d<this._cells.length;){let p=this._cells[d],h=new L(c.lineNumber,c.column,p.textBuffer.getLineCount(),p.textBuffer.getLineMaxColumn(p.textBuffer.getLineCount())),m=p.textBuffer.findMatchesLineByLine(h,l,!1,1);if(m.length>0)return{cell:p,match:m[0]};d++,c={lineNumber:1,column:1}}return null}};c_=E([b(5,u0),b(6,qi),b(7,ti),b(8,KC)],c_);var I5=class{constructor(t){this.outputs=t}getElements(){return this.outputs.map(t=>wr(t.outputs.map(e=>({mime:e.mime,data:e.data}))))}};var y5=class{constructor(t){this.notebookKernelService=t;this.cancellationTokenSource=new Kt}cancellationTokenSource;hasChildren(t){return t.kind==="root"||t.hasNamedChildren||t.indexedChildrenCount>0}cancel(){this.cancellationTokenSource.cancel(),this.cancellationTokenSource.dispose(),this.cancellationTokenSource=new Kt}async getChildren(t){return t.kind==="root"?this.getRootVariables(t.notebook):this.getVariables(t)}async getVariables(t){let e=this.notebookKernelService.getMatchingKernel(t.notebook).selected;if(e&&e.hasVariableProvider){let i=[];if(t.hasNamedChildren){let o=await e.provideVariables(t.notebook.uri,t.extHostId,"named",0,this.cancellationTokenSource.token).map(s=>this.createVariableElement(s,t.notebook)).toPromise();i=i.concat(o)}if(t.indexedChildrenCount>0){let n=await this.getIndexedChildren(t,e);i=i.concat(n)}return i}return[]}async getIndexedChildren(t,e){let i=[];if(t.indexedChildrenCount>h5){let n=Math.floor(Math.max(t.indexedChildrenCount/h5,100)),o=1e6,s=t.indexStart??0,a=s+Math.min(t.indexedChildrenCount,o);for(;s<a;s+=n){let l=s+n;l>a&&(l=a),i.push({kind:"variable",notebook:t.notebook,id:t.id+`${s}`,extHostId:t.extHostId,name:`[${s}..${l-1}]`,value:"",indexedChildrenCount:l-s,indexStart:s,hasNamedChildren:!1})}t.indexedChildrenCount>o&&i.push({kind:"variable",notebook:t.notebook,id:t.id+`${a+1}`,extHostId:t.extHostId,name:u("notebook.indexedChildrenLimitReached","Display limit reached"),value:"",indexedChildrenCount:0,hasNamedChildren:!1})}else if(t.indexedChildrenCount>0){let n=e.provideVariables(t.notebook.uri,t.extHostId,"indexed",t.indexStart??0,this.cancellationTokenSource.token);for await(let o of n)if(i.push(this.createVariableElement(o,t.notebook)),i.length>=h5)break}return i}async getRootVariables(t){let e=this.notebookKernelService.getMatchingKernel(t).selected;return e&&e.hasVariableProvider?await e.provideVariables(t.uri,void 0,"named",0,this.cancellationTokenSource.token).map(n=>this.createVariableElement(n,t)).toPromise():[]}createVariableElement(t,e){return{...t,kind:"variable",notebook:e,extHostId:t.id,id:`${t.id}`}}};var UZ=J,Nke=1024;var S5=class{getHeight(t){return 22}getTemplateId(t){return Ng.ID}},Ng=class{constructor(t){this._hoverService=t}static ID="variableElement";get templateId(){return Ng.ID}renderTemplate(t){let e=U(t,UZ(".expression")),i=U(e,UZ("span.name")),n=U(e,UZ("span.value"));return{expression:e,name:i,value:n,elementDisposables:new B}}renderElement(t,e,i){let n=t.element.value.trim()!==""?`${t.element.name}:`:t.element.name;i.name.textContent=n,i.name.title=t.element.type??"",Xd(i.elementDisposables,t.element,i.value,{colorize:!0,maxValueLength:Nke},this._hoverService)}disposeElement(t,e,i,n){i.elementDisposables.clear()}disposeTemplate(t){t.elementDisposables.dispose()}};Ng=E([b(0,Nt)],Ng);var C5=class{getWidgetAriaLabel(){return u("debugConsole","Notebook Variables")}getAriaLabel(t){return u("notebookVariableAriaLabel","Variable {0}, value {1}",t.name,t.value)}};var Fke="\u27EA ",Bke=" characters skipped \u27EB",Cnr=(Fke.length+Bke.length+5)*2,wnr=q("searchService");var Vke;(i=>{let r=[];function t(n){let o=n;return o&&r.push(o),{dispose(){if(o){let s=r.indexOf(o);s>=0&&(r.splice(s,1),o=void 0)}}}}i.register=t;function e(){return r.slice(0)}i.all=e})(Vke||={});var Qnr=new A("searchState",0);var E5=q("notebookService"),w5=class{constructor(t,e,i){this.viewType=t;this.serializer=e;this.extensionData=i}};var gge=q("INotebookModelResolverService");var tm=class extends R{constructor(e,i){super();this.configurationService=e;this.workspaceContextService=i;this.storeEnablementState(),this.storeCustomPatterns(),this.registerListeners()}_serviceBrand;static SETTING_ID_PATTERNS="workbench.editor.customLabels.patterns";static SETTING_ID_ENABLED="workbench.editor.customLabels.enabled";_onDidChange=this._register(new x);onDidChange=this._onDidChange.event;patterns=[];enabled=!0;cache=new YM(1e3);registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(e=>{if(e.affectsConfiguration(tm.SETTING_ID_ENABLED)){let i=this.enabled;this.storeEnablementState(),i!==this.enabled&&this.patterns.length>0&&this._onDidChange.fire()}else e.affectsConfiguration(tm.SETTING_ID_PATTERNS)&&(this.cache.clear(),this.storeCustomPatterns(),this._onDidChange.fire())}))}storeEnablementState(){this.enabled=this.configurationService.getValue(tm.SETTING_ID_ENABLED)}_templateRegexValidation=/[a-zA-Z0-9]/;storeCustomPatterns(){this.patterns=[];let e=this.configurationService.getValue(tm.SETTING_ID_PATTERNS);for(let i in e){let n=e[i];if(!this._templateRegexValidation.test(n))continue;let o=ja(i),s=du(i);this.patterns.push({pattern:i,template:n,isAbsolutePath:o,parsedPattern:s})}this.patterns.sort((i,n)=>this.patternWeight(n.pattern)-this.patternWeight(i.pattern))}patternWeight(e){let i=0;for(let n of e.split("/"))n==="**"?i+=1:n==="*"?i+=10:n.includes("*")||n.includes("?")?i+=50:n!==""&&(i+=100);return i}getName(e){if(!this.enabled||this.patterns.length===0)return;let i=e.toString(),n=this.cache.get(i);if(n!==void 0)return n??void 0;let o=this.applyPatterns(e);return this.cache.set(i,o??null),o}applyPatterns(e){let i=this.workspaceContextService.getWorkspaceFolder(e),n;for(let o of this.patterns){let s;if(i&&!o.isAbsolutePath?(n||(n=af(Hn(i.uri),e)??e.path),s=n):s=e.path,o.parsedPattern(s))return this.applyTemplate(o.template,e,s)}}_parsedTemplateExpression=/\$\{(dirname|filename|extname|extname\((?<extnameN>[-+]?\d+)\)|dirname\((?<dirnameN>[-+]?\d+)\))\}/g;_filenameCaptureExpression=/(?<filename>^\.*[^.]*)/;applyTemplate(e,i,n){let o;return e.replace(this._parsedTemplateExpression,(s,a,...l)=>{o=o??LJ(i.path);let{dirnameN:d="0",extnameN:c="0"}=l.pop();if(a==="filename"){let{filename:p}=this._filenameCaptureExpression.exec(o.base)?.groups??{};if(p)return p}else if(a==="extname"){let p=this.getExtnames(o.base);if(p)return p}else if(a.startsWith("extname")){let p=parseInt(c),h=this.getNthExtname(o.base,p);if(h)return h}else if(a.startsWith("dirname")){let p=parseInt(d),h=this.getNthDirname(zg(n),p);if(h)return h}return s})}removeLeadingDot(e){let i=e;for(;i.startsWith(".");)i=i.slice(1);return i}getNthDirname(e,i){e=e.startsWith("/")?e.slice(1):e;let n=e.split("/");return this.getNthFragment(n,i)}getExtnames(e){return this.removeLeadingDot(e).split(".").slice(1).join(".")}getNthExtname(e,i){let n=this.removeLeadingDot(e).split(".");return n.shift(),this.getNthFragment(n,i)}getNthFragment(e,i){let n=e.length,o;i<0?o=Math.abs(i)-1:o=n-i-1;let s=e[o];if(!(s===void 0||s===""))return s}};tm=E([b(0,se),b(1,kt)],tm);var xM=q("ICustomEditorLabelService");gi(xM,tm,1);var u_=class extends Bl{constructor(e,i,n,o,s,a,l){super();this.resource=e;this.labelService=n;this.fileService=o;this.filesConfigurationService=s;this.textResourceConfigurationService=a;this.customEditorLabelService=l;this._preferredResource=i||e,this.registerListeners()}get capabilities(){let e=32;return this.fileService.hasProvider(this.resource)?this.filesConfigurationService.isReadonly(this.resource)&&(e|=2):e|=4,e&2||(e|=128),e}_preferredResource;get preferredResource(){return this._preferredResource}registerListeners(){this._register(this.labelService.onDidChangeFormatters(e=>this.onLabelEvent(e.scheme))),this._register(this.fileService.onDidChangeFileSystemProviderRegistrations(e=>this.onLabelEvent(e.scheme))),this._register(this.fileService.onDidChangeFileSystemProviderCapabilities(e=>this.onLabelEvent(e.scheme))),this._register(this.customEditorLabelService.onDidChange(()=>this.updateLabel()))}onLabelEvent(e){e===this._preferredResource.scheme&&this.updateLabel()}updateLabel(){this._name=void 0,this._shortDescription=void 0,this._mediumDescription=void 0,this._longDescription=void 0,this._shortTitle=void 0,this._mediumTitle=void 0,this._longTitle=void 0,this._onDidChangeLabel.fire()}setPreferredResource(e){zi(e,this._preferredResource)||(this._preferredResource=e,this.updateLabel())}_name=void 0;getName(){return typeof this._name!="string"&&(this._name=this.customEditorLabelService.getName(this._preferredResource)??this.labelService.getUriBasenameLabel(this._preferredResource)),this._name}getDescription(e=1){switch(e){case 0:return this.shortDescription;case 2:return this.longDescription;case 1:default:return this.mediumDescription}}_shortDescription=void 0;get shortDescription(){return typeof this._shortDescription!="string"&&(this._shortDescription=this.labelService.getUriBasenameLabel(Hn(this._preferredResource))),this._shortDescription}_mediumDescription=void 0;get mediumDescription(){return typeof this._mediumDescription!="string"&&(this._mediumDescription=this.labelService.getUriLabel(Hn(this._preferredResource),{relative:!0})),this._mediumDescription}_longDescription=void 0;get longDescription(){return typeof this._longDescription!="string"&&(this._longDescription=this.labelService.getUriLabel(Hn(this._preferredResource))),this._longDescription}_shortTitle=void 0;get shortTitle(){return typeof this._shortTitle!="string"&&(this._shortTitle=this.getName()),this._shortTitle}_mediumTitle=void 0;get mediumTitle(){return typeof this._mediumTitle!="string"&&(this._mediumTitle=this.labelService.getUriLabel(this._preferredResource,{relative:!0})),this._mediumTitle}_longTitle=void 0;get longTitle(){return typeof this._longTitle!="string"&&(this._longTitle=this.labelService.getUriLabel(this._preferredResource)),this._longTitle}getTitle(e){switch(e){case 0:return this.shortTitle;case 2:return this.longTitle;default:case 1:return this.mediumTitle}}isReadonly(){return this.filesConfigurationService.isReadonly(this.resource)}ensureLimits(e){if(e?.limits)return e.limits;let i=fre(this.resource),n,o=this.textResourceConfigurationService.inspect(this.resource,null,"workbench.editorLargeFileConfirmation");return iie(o)&&(n=o.value*vc.MB),{size:n??i}}};u_=E([b(2,hi),b(3,Ei),b(4,qm),b(5,Cs),b(6,xM)],u_);var Fg=class extends u_{constructor(e,i,n,o,s,a,l,d,c,p,h,m,f,g){super(e,i,d,c,p,f,g);this.viewType=n;this.options=o;this._notebookService=s;this._notebookModelResolverService=a;this._fileDialogService=l;this._defaultDirtyState=!!o.startDirty,this._sideLoadedListener=s.onDidAddNotebookDocument(v=>{v.viewType===this.viewType&&v.uri.toString()===this.resource.toString()&&this.resolve().catch(Xe)}),this._register(h.onWillStop(v=>{if(!v.auto&&!this.isDirty())return;let I=v.auto?u("vetoAutoExtHostRestart","One of the opened editors is a notebook editor."):u("vetoExtHostRestart","Notebook '{0}' could not be saved.",this.resource.path);v.veto((async()=>{let y=m.findEditors(this);return v.auto?!0:!(y.length>0&&(await m.save(y[0])).success)})(),I)}))}static getOrCreate(e,i,n,o,s={}){let a=e.createInstance(Fg,i,n,o,s);return n&&a.setPreferredResource(n),a}static ID="workbench.input.notebook";editorModelReference=null;_sideLoadedListener;_defaultDirtyState=!1;dispose(){this._sideLoadedListener.dispose(),this.editorModelReference?.dispose(),this.editorModelReference=null,super.dispose()}get typeId(){return Fg.ID}get editorId(){return this.viewType}get capabilities(){let e=0;return this.resource.scheme===Ie.untitled&&(e|=4),this.editorModelReference?this.editorModelReference.object.isReadonly()&&(e|=2):this.filesConfigurationService.isReadonly(this.resource)&&(e|=2),e&2||(e|=128),e}getDescription(e=1){if(!this.hasCapability(4)||this.editorModelReference?.object.hasAssociatedFilePath())return super.getDescription(e)}isReadonly(){return this.editorModelReference?this.editorModelReference.object.isReadonly():this.filesConfigurationService.isReadonly(this.resource)}isDirty(){return this.editorModelReference?this.editorModelReference.object.isDirty():this._defaultDirtyState}isSaving(){let e=this.editorModelReference?.object;return!e||!e.isDirty()||e.hasErrorState||this.hasCapability(4)?!1:this.filesConfigurationService.hasShortAutoSaveDelay(this)}async save(e,i){if(this.editorModelReference)return this.hasCapability(4)?this.saveAs(e,i):(await this.editorModelReference.object.save(i),this)}async saveAs(e,i){if(!this.editorModelReference)return;let n=this._notebookService.getContributedNotebookType(this.viewType);if(!n)return;let o=this.hasCapability(4)?await this._suggestName(n,this.labelService.getUriBasenameLabel(this.resource)):this.editorModelReference.object.resource,s;if(this.editorModelReference.object.hasAssociatedFilePath())s=o;else if(s=await this._fileDialogService.pickFileToSave(o,i?.availableFileSystems),!s)return;if(!n.matches(s)){let a=n.selectors.map(l=>typeof l=="string"?l:FD(l)?`${l} (base ${l.base})`:l.exclude?`${l.include} (exclude: ${l.exclude})`:`${l.include}`).join(", ");throw new Error(`File name ${s} is not supported by ${n.providerDisplayName}.

Please make sure the file name matches following patterns:
${a}`)}return await this.editorModelReference.object.saveAs(s)}async _suggestName(e,i){let n=e.selectors[0],o=n&&typeof n=="string"?n:void 0;if(!o&&n){let s=n.include;typeof s=="string"&&(o=s)}if(o){let s=/^\*\.([A-Za-z_-]*)$/.exec(o);if(s&&s.length>1){let a=s[1];if(!i.endsWith(a))return pi(await this._fileDialogService.defaultFilePath(),i+"."+a)}}return pi(await this._fileDialogService.defaultFilePath(),i)}async rename(e,i){if(this.editorModelReference)return{editor:{resource:i},options:{override:this.viewType}}}async revert(e,i){this.editorModelReference&&this.editorModelReference.object.isDirty()&&await this.editorModelReference.object.revert(i)}async resolve(e,i){if(!await this._notebookService.canResolve(this.viewType))return null;if(i?.mark("extensionActivated"),this._sideLoadedListener.dispose(),this.editorModelReference)this.editorModelReference.object.load({limits:this.ensureLimits(e)});else{let n=!!(this.capabilities&512),o=await this._notebookModelResolverService.resolve(this.resource,this.viewType,{limits:this.ensureLimits(e),scratchpad:n});if(this.editorModelReference)return o.dispose(),this.editorModelReference.object;if(this.editorModelReference=o,this.isDisposed())return this.editorModelReference.dispose(),this.editorModelReference=null,null;this._register(this.editorModelReference.object.onDidChangeDirty(()=>this._onDidChangeDirty.fire())),this._register(this.editorModelReference.object.onDidChangeReadonly(()=>this._onDidChangeCapabilities.fire())),this._register(this.editorModelReference.object.onDidRevertUntitled(()=>this.dispose())),this.editorModelReference.object.isDirty()&&this._onDidChangeDirty.fire()}if(this.options._backupId){let n=await this._notebookService.withNotebookDataProvider(this.editorModelReference.object.notebook.viewType);if(!(n instanceof w5))throw new Error("CANNOT open file notebook with this provider");let o=await n.serializer.dataToNotebook(Jt.fromString(JSON.stringify({__webview_backup:this.options._backupId})));this.editorModelReference.object.notebook.applyEdits([{editType:1,index:0,count:this.editorModelReference.object.notebook.length,cells:o.cells}],!0,void 0,()=>{},void 0,!1),this.options._workingCopy&&(this.options._backupId=void 0,this.options._workingCopy=void 0,this.options.startDirty=void 0)}return this.editorModelReference.object}toUntyped(){return{resource:this.resource,options:{override:this.viewType}}}matches(e){return super.matches(e)?!0:e instanceof Fg?this.editorId===e.editorId&&zi(this.resource,e.resource):!1}};Fg=E([b(4,E5),b(5,gge),b(6,Ta),b(7,hi),b(8,Ei),b(9,qm),b(10,_n),b(11,$e),b(12,Cs),b(13,xM)],Fg);function fge(r){return!!r&&typeof r=="object"&&Array.isArray(r.editorInputs)&&r.editorInputs.every(t=>t instanceof Fg)}var bge=18;var vge=Object.freeze({codeCellLeftMargin:28,cellRunGutter:32,markdownCellTopMargin:8,markdownCellBottomMargin:8,markdownCellLeftMargin:0,markdownCellGutter:32,focusIndicatorLeftMargin:4}),Ige=Object.freeze({codeCellLeftMargin:8,cellRunGutter:36,markdownCellTopMargin:6,markdownCellBottomMargin:6,markdownCellLeftMargin:8,markdownCellGutter:36,focusIndicatorLeftMargin:4}),x5=class extends R{constructor(e,i,n,o,s,a){super();this.targetWindow=e;this.isReadonly=i;this.overrides=n;this.configurationService=o;this.notebookExecutionStateService=s;this.codeEditorService=a;let l=this.configurationService.getValue(it.showCellStatusBar),d=n?.globalToolbar??this.configurationService.getValue(it.globalToolbar)??!0,c=n?.stickyScrollEnabled??this.configurationService.getValue(it.stickyScrollEnabled)??!1,p=this._computeStickyScrollModeOption(),h=this.configurationService.getValue(it.consolidatedOutputButton)??!0,m=this.configurationService.getValue(it.consolidatedRunButton)??!1,f=n?.dragAndDropEnabled??this.configurationService.getValue(it.dragAndDropEnabled)??!0,g=this.configurationService.getValue(it.cellToolbarLocation)??{default:"right"},v=n?.cellToolbarInteraction??this.configurationService.getValue(it.cellToolbarVisibility),I=this.configurationService.getValue(it.compactView)??!0,y=this._computeFocusIndicatorOption(),w=this._computeInsertToolbarPositionOption(this.isReadonly),C=this._computeInsertToolbarAlignmentOption(),S=this._computeShowFoldingControlsOption(),D=this.configurationService.getValue("editor.fontSize"),k=this.configurationService.getValue(it.markupFontSize),M=this.configurationService.getValue(it.markdownLineHeight),O=this.configurationService.getValue(it.cellEditorOptionsCustomizations)??{};O=vi(O)?O:{};let K=this.configurationService.getValue(it.interactiveWindowCollapseCodeCells),G,Y=this.configurationService.getValue(it.outputLineHeightDeprecated);Y!==void 0?(this._migrateDeprecatedSetting(it.outputLineHeightDeprecated,it.outputLineHeight),G=Y):G=this.configurationService.getValue(it.outputLineHeight);let ge,xe=this.configurationService.getValue(it.outputFontSizeDeprecated);xe!==void 0?(this._migrateDeprecatedSetting(it.outputFontSizeDeprecated,it.outputFontSize),ge=xe):ge=this.configurationService.getValue(it.outputFontSize)||D;let be,fe=this.configurationService.getValue(it.outputFontFamilyDeprecated);fe!==void 0?(this._migrateDeprecatedSetting(it.outputFontFamilyDeprecated,it.outputFontFamily),be=fe):be=this.configurationService.getValue(it.outputFontFamily);let Le,Ee=this.configurationService.getValue(it.outputScrollingDeprecated);Ee!==void 0?(this._migrateDeprecatedSetting(it.outputScrollingDeprecated,it.outputScrolling),Le=Ee):Le=this.configurationService.getValue(it.outputScrolling);let Ce=this._computeOutputLineHeight(G,ge),Je=this.configurationService.getValue(it.outputWordWrap),pe=this.configurationService.getValue(it.textOutputLineLimit)??30,qt=this.configurationService.getValue(it.LinkifyOutputFilePaths)??!0,Mt=this.configurationService.getValue(it.minimalErrorRendering),at=this._computeEditorTopPadding();this._layoutConfiguration={...I?Ige:vge,cellTopMargin:6,cellBottomMargin:6,cellRightMargin:16,cellStatusBarHeight:22,cellOutputPadding:8,markdownPreviewPadding:8,editorToolbarHeight:0,editorTopPadding:at,editorBottomPadding:4,editorBottomPaddingWithoutStatusBar:12,collapsedIndicatorHeight:28,showCellStatusBar:l,globalToolbar:d,stickyScrollEnabled:c,stickyScrollMode:p,consolidatedOutputButton:h,consolidatedRunButton:m,dragAndDropEnabled:f,cellToolbarLocation:g,cellToolbarInteraction:v,compactView:I,focusIndicator:y,insertToolbarPosition:w,insertToolbarAlignment:C,showFoldingControls:S,fontSize:D,outputFontSize:ge,outputFontFamily:be,outputLineHeight:Ce,markupFontSize:k,markdownLineHeight:M,editorOptionsCustomizations:O,focusIndicatorGap:3,interactiveWindowCollapseCodeCells:K,markdownFoldHintHeight:22,outputScrolling:Le,outputWordWrap:Je,outputLineLimit:pe,outputLinkifyFilePaths:qt,outputMinimalError:Mt},this._register(this.configurationService.onDidChangeConfiguration(On=>{this._updateConfiguration(On)}))}_layoutConfiguration;_onDidChangeOptions=this._register(new x);onDidChangeOptions=this._onDidChangeOptions.event;_editorTopPadding=12;updateOptions(e){this.isReadonly!==e&&(this.isReadonly=e,this._updateConfiguration({affectsConfiguration(i){return i===it.insertToolbarLocation},source:7,affectedKeys:new Set([it.insertToolbarLocation]),change:{keys:[it.insertToolbarLocation],overrides:[]}}))}_computeEditorTopPadding(){let e=!1,i=s=>{this._editorTopPadding=s;let a=Object.assign({},this._layoutConfiguration);a.editorTopPadding=this._editorTopPadding,this._layoutConfiguration=a,this._onDidChangeOptions.fire({editorTopPadding:!0})},n=new Set,o=s=>{if(!e&&!n.has(s))try{let a=this.codeEditorService.resolveDecorationOptions(s,!0);if(a.afterContentClassName||a.beforeContentClassName){let l=this.codeEditorService.resolveDecorationCSSRules(s);if(l!==null){for(let d=0;d<l.length;d++)if((l[d].selectorText.endsWith("::after")||l[d].selectorText.endsWith("::after"))&&l[d].cssText.indexOf("top:")>-1){let c=this.configurationService.getValue("editor");i(Mp.createFromRawSettings(c,Zs.getInstance(this.targetWindow).value).lineHeight+2),e=!0;break}}}n.add(s)}catch{}};return this._register(this.codeEditorService.onDecorationTypeRegistered(o)),this.codeEditorService.listDecorationTypes().forEach(o),this._editorTopPadding}_migrateDeprecatedSetting(e,i){let n=this.configurationService.inspect(e);n.application!==void 0&&(this.configurationService.updateValue(e,void 0,1),this.configurationService.updateValue(i,n.application.value,1)),n.user!==void 0&&(this.configurationService.updateValue(e,void 0,2),this.configurationService.updateValue(i,n.user.value,2)),n.userLocal!==void 0&&(this.configurationService.updateValue(e,void 0,3),this.configurationService.updateValue(i,n.userLocal.value,3)),n.userRemote!==void 0&&(this.configurationService.updateValue(e,void 0,4),this.configurationService.updateValue(i,n.userRemote.value,4)),n.workspace!==void 0&&(this.configurationService.updateValue(e,void 0,5),this.configurationService.updateValue(i,n.workspace.value,5)),n.workspaceFolder!==void 0&&(this.configurationService.updateValue(e,void 0,6),this.configurationService.updateValue(i,n.workspaceFolder.value,6))}_computeOutputLineHeight(e,i){if(e===0){let o=this.configurationService.getValue("editor");e=RD.readFontInfo(this.targetWindow,Mp.createFromRawSettings(o,Zs.getInstance(this.targetWindow).value)).lineHeight}else if(e<9){let o=i;o===0&&(o=this.configurationService.getValue("editor.fontSize")),e=e*o}return e=Math.round(e),e<9&&(e=9),e}_updateConfiguration(e){let i=e.affectsConfiguration(it.showCellStatusBar),n=e.affectsConfiguration(it.cellToolbarLocation),o=e.affectsConfiguration(it.cellToolbarVisibility),s=e.affectsConfiguration(it.compactView),a=e.affectsConfiguration(it.focusIndicator),l=e.affectsConfiguration(it.insertToolbarLocation),d=e.affectsConfiguration(it.experimentalInsertToolbarAlignment),c=e.affectsConfiguration(it.globalToolbar),p=e.affectsConfiguration(it.stickyScrollEnabled),h=e.affectsConfiguration(it.stickyScrollMode),m=e.affectsConfiguration(it.consolidatedOutputButton),f=e.affectsConfiguration(it.consolidatedRunButton),g=e.affectsConfiguration(it.showFoldingControls),v=e.affectsConfiguration(it.dragAndDropEnabled),I=e.affectsConfiguration("editor.fontSize"),y=e.affectsConfiguration(it.outputFontSize),w=e.affectsConfiguration(it.markupFontSize),C=e.affectsConfiguration(it.markdownLineHeight),S=e.affectsConfiguration("editor.fontFamily"),D=e.affectsConfiguration(it.outputFontFamily),k=e.affectsConfiguration(it.cellEditorOptionsCustomizations),M=e.affectsConfiguration(it.interactiveWindowCollapseCodeCells),O=e.affectsConfiguration(it.outputLineHeight),K=e.affectsConfiguration(it.outputScrolling),G=e.affectsConfiguration(it.outputWordWrap),Y=e.affectsConfiguration(it.LinkifyOutputFilePaths),ge=e.affectsConfiguration(it.minimalErrorRendering);if(!i&&!n&&!o&&!s&&!a&&!l&&!d&&!c&&!p&&!h&&!m&&!f&&!g&&!v&&!I&&!y&&!w&&!C&&!S&&!D&&!k&&!M&&!O&&!K&&!G&&!Y&&!ge)return;let xe=Object.assign({},this._layoutConfiguration);if(i&&(xe.showCellStatusBar=this.configurationService.getValue(it.showCellStatusBar)),n&&(xe.cellToolbarLocation=this.configurationService.getValue(it.cellToolbarLocation)??{default:"right"}),o&&!this.overrides?.cellToolbarInteraction&&(xe.cellToolbarInteraction=this.configurationService.getValue(it.cellToolbarVisibility)),a&&(xe.focusIndicator=this._computeFocusIndicatorOption()),s){let be=this.configurationService.getValue(it.compactView)??!0;xe=Object.assign(xe,{...be?Ige:vge}),xe.compactView=be}if(d&&(xe.insertToolbarAlignment=this._computeInsertToolbarAlignmentOption()),l&&(xe.insertToolbarPosition=this._computeInsertToolbarPositionOption(this.isReadonly)),c&&this.overrides?.globalToolbar===void 0&&(xe.globalToolbar=this.configurationService.getValue(it.globalToolbar)??!0),p&&this.overrides?.stickyScrollEnabled===void 0&&(xe.stickyScrollEnabled=this.configurationService.getValue(it.stickyScrollEnabled)??!1),h&&(xe.stickyScrollMode=this.configurationService.getValue(it.stickyScrollMode)??"flat"),m&&(xe.consolidatedOutputButton=this.configurationService.getValue(it.consolidatedOutputButton)??!0),f&&(xe.consolidatedRunButton=this.configurationService.getValue(it.consolidatedRunButton)??!0),g&&(xe.showFoldingControls=this._computeShowFoldingControlsOption()),v&&(xe.dragAndDropEnabled=this.configurationService.getValue(it.dragAndDropEnabled)??!0),I&&(xe.fontSize=this.configurationService.getValue("editor.fontSize")),(y||I)&&(xe.outputFontSize=this.configurationService.getValue(it.outputFontSize)||xe.fontSize),w&&(xe.markupFontSize=this.configurationService.getValue(it.markupFontSize)),C&&(xe.markdownLineHeight=this.configurationService.getValue(it.markdownLineHeight)),D&&(xe.outputFontFamily=this.configurationService.getValue(it.outputFontFamily)),k&&(xe.editorOptionsCustomizations=this.configurationService.getValue(it.cellEditorOptionsCustomizations)),M&&(xe.interactiveWindowCollapseCodeCells=this.configurationService.getValue(it.interactiveWindowCollapseCodeCells)),O||I||y){let be=this.configurationService.getValue(it.outputLineHeight);xe.outputLineHeight=this._computeOutputLineHeight(be,xe.outputFontSize)}G&&(xe.outputWordWrap=this.configurationService.getValue(it.outputWordWrap)),K&&(xe.outputScrolling=this.configurationService.getValue(it.outputScrolling)),Y&&(xe.outputLinkifyFilePaths=this.configurationService.getValue(it.LinkifyOutputFilePaths)),ge&&(xe.outputMinimalError=this.configurationService.getValue(it.minimalErrorRendering)),this._layoutConfiguration=Object.freeze(xe),this._onDidChangeOptions.fire({cellStatusBarVisibility:i,cellToolbarLocation:n,cellToolbarInteraction:o,compactView:s,focusIndicator:a,insertToolbarPosition:l,insertToolbarAlignment:d,globalToolbar:c,stickyScrollEnabled:p,stickyScrollMode:h,showFoldingControls:g,consolidatedOutputButton:m,consolidatedRunButton:f,dragAndDropEnabled:v,fontSize:I,outputFontSize:y,markupFontSize:w,markdownLineHeight:C,fontFamily:S,outputFontFamily:D,editorOptionsCustomizations:k,interactiveWindowCollapseCodeCells:M,outputLineHeight:O,outputScrolling:K,outputWordWrap:G,outputLinkifyFilePaths:Y,minimalError:ge})}_computeInsertToolbarPositionOption(e){return e?"hidden":this.configurationService.getValue(it.insertToolbarLocation)??"both"}_computeInsertToolbarAlignmentOption(){return this.configurationService.getValue(it.experimentalInsertToolbarAlignment)??"center"}_computeShowFoldingControlsOption(){return this.configurationService.getValue(it.showFoldingControls)??"mouseover"}_computeFocusIndicatorOption(){return this.configurationService.getValue(it.focusIndicator)??"gutter"}_computeStickyScrollModeOption(){return this.configurationService.getValue(it.stickyScrollMode)??"flat"}getCellCollapseDefault(){return this._layoutConfiguration.interactiveWindowCollapseCodeCells==="never"?{codeCell:{inputCollapsed:!1}}:{codeCell:{inputCollapsed:!0}}}getLayoutConfiguration(){return this._layoutConfiguration}getDisplayOptions(){return this._layoutConfiguration}getCellEditorContainerLeftMargin(){let{codeCellLeftMargin:e,cellRunGutter:i}=this._layoutConfiguration;return e+i}computeCollapsedMarkdownCellHeight(e){let{bottomToolbarGap:i}=this.computeBottomToolbarDimensions(e);return this._layoutConfiguration.markdownCellTopMargin+this._layoutConfiguration.collapsedIndicatorHeight+i+this._layoutConfiguration.markdownCellBottomMargin}computeBottomToolbarOffset(e,i){let{bottomToolbarGap:n,bottomToolbarHeight:o}=this.computeBottomToolbarDimensions(i);return e-n-o/2}computeCodeCellEditorWidth(e){return e-(this._layoutConfiguration.codeCellLeftMargin+this._layoutConfiguration.cellRunGutter+this._layoutConfiguration.cellRightMargin)}computeMarkdownCellEditorWidth(e){return e-this._layoutConfiguration.markdownCellGutter-this._layoutConfiguration.markdownCellLeftMargin-this._layoutConfiguration.cellRightMargin}computeStatusBarHeight(){return this._layoutConfiguration.cellStatusBarHeight}_computeBottomToolbarDimensions(e,i,n,o){return n==="left"||o!=="hidden"?{bottomToolbarGap:18,bottomToolbarHeight:18}:i==="betweenCells"||i==="both"?e?{bottomToolbarGap:12,bottomToolbarHeight:20}:{bottomToolbarGap:20,bottomToolbarHeight:20}:{bottomToolbarGap:0,bottomToolbarHeight:0}}computeBottomToolbarDimensions(e){let i=this._layoutConfiguration,n=this.computeCellToolbarLocation(e),{bottomToolbarGap:o,bottomToolbarHeight:s}=this._computeBottomToolbarDimensions(i.compactView,i.insertToolbarPosition,i.insertToolbarAlignment,n);return{bottomToolbarGap:o,bottomToolbarHeight:s}}computeCellToolbarLocation(e){let i=this._layoutConfiguration.cellToolbarLocation;if(typeof i=="string"){if(i==="left"||i==="right"||i==="hidden")return i}else if(e){let n=i[e]??i.default,o="right";switch(n){case"left":o="left";break;case"right":o="right";break;case"hidden":o="hidden";break;default:o="right";break}return o}return"right"}computeTopInsertToolbarHeight(e){if(this._layoutConfiguration.insertToolbarPosition==="betweenCells"||this._layoutConfiguration.insertToolbarPosition==="both")return bge;let i=this.computeCellToolbarLocation(e);return i==="left"||i==="right"?bge:0}computeEditorPadding(e,i){return{top:this._editorTopPadding,bottom:this.statusBarIsVisible(e,i)?this._layoutConfiguration.editorBottomPadding:this._layoutConfiguration.editorBottomPaddingWithoutStatusBar}}computeEditorStatusbarHeight(e,i){return this.statusBarIsVisible(e,i)?this.computeStatusBarHeight():0}statusBarIsVisible(e,i){let n=this.notebookExecutionStateService.getCellExecution(i);return this._layoutConfiguration.showCellStatusBar==="visible"?!0:this._layoutConfiguration.showCellStatusBar==="visibleAfterExecute"?typeof e.lastRunSuccess=="boolean"||n!==void 0:!1}computeWebviewOptions(){return{outputNodePadding:this._layoutConfiguration.cellOutputPadding,outputNodeLeftPadding:this._layoutConfiguration.cellOutputPadding,previewNodePadding:this._layoutConfiguration.markdownPreviewPadding,markdownLeftMargin:this._layoutConfiguration.markdownCellGutter+this._layoutConfiguration.markdownCellLeftMargin,leftMargin:this._layoutConfiguration.codeCellLeftMargin,rightMargin:this._layoutConfiguration.cellRightMargin,runGutter:this._layoutConfiguration.cellRunGutter,dragAndDropEnabled:this._layoutConfiguration.dragAndDropEnabled,fontSize:this._layoutConfiguration.fontSize,outputFontSize:this._layoutConfiguration.outputFontSize,outputFontFamily:this._layoutConfiguration.outputFontFamily,markupFontSize:this._layoutConfiguration.markupFontSize,markdownLineHeight:this._layoutConfiguration.markdownLineHeight,outputLineHeight:this._layoutConfiguration.outputLineHeight,outputScrolling:this._layoutConfiguration.outputScrolling,outputWordWrap:this._layoutConfiguration.outputWordWrap,outputLineLimit:this._layoutConfiguration.outputLineLimit,outputLinkifyFilePaths:this._layoutConfiguration.outputLinkifyFilePaths,minimalError:this._layoutConfiguration.outputMinimalError}}computeDiffWebviewOptions(){return{outputNodePadding:this._layoutConfiguration.cellOutputPadding,outputNodeLeftPadding:0,previewNodePadding:this._layoutConfiguration.markdownPreviewPadding,markdownLeftMargin:0,leftMargin:32,rightMargin:0,runGutter:0,dragAndDropEnabled:!1,fontSize:this._layoutConfiguration.fontSize,outputFontSize:this._layoutConfiguration.outputFontSize,outputFontFamily:this._layoutConfiguration.outputFontFamily,markupFontSize:this._layoutConfiguration.markupFontSize,markdownLineHeight:this._layoutConfiguration.markdownLineHeight,outputLineHeight:this._layoutConfiguration.outputLineHeight,outputScrolling:this._layoutConfiguration.outputScrolling,outputWordWrap:this._layoutConfiguration.outputWordWrap,outputLineLimit:this._layoutConfiguration.outputLineLimit,outputLinkifyFilePaths:!1,minimalError:!1}}computeIndicatorPosition(e,i,n){let{bottomToolbarGap:o}=this.computeBottomToolbarDimensions(n);return{bottomIndicatorTop:e-o-this._layoutConfiguration.cellBottomMargin-i,verticalIndicatorHeight:e-o-i}}};x5=E([b(3,se),b(4,p5),b(5,En)],x5);var Kar=new A("webviewFindWidgetVisible",!1),Gar=new A("webviewFindWidgetFocused",!1),qar=new A("webviewFindWidgetEnabled",!1),$ar=q("webviewService");var TM=class{_memento;_state;constructor(t,e){this._memento=new gw(t,e),this._state=this._memento.getMemento(-1,1)}getOrigin(t,e){let i=this._getKey(t,e),n=this._state[i];if(n&&typeof n=="string")return n;let o=Ni();return this._state[i]=o,this._memento.saveMemento(),o}_getKey(t,e){return JSON.stringify({viewType:t,key:e})}};TM=E([b(1,nt)],TM);var T5=class{_store;constructor(t,e){this._store=new TM(t,e)}getOrigin(t,e){return this._store.getOrigin(t,e.value)}};T5=E([b(1,nt)],T5);var yge="jupyter-notebook",Wke="ms-toolsai.jupyter";var Sge=new Map;Sge.set(yge,new Map);Sge.get(yge)?.set("python",{extensionIds:["ms-python.python",Wke],displayName:"Python + Jupyter"});function Cge(r){if(!r)return;if(r.getId()===pge)return r.getControl();let t=r.input;if(t&&fge(t))return r.getControl()?.notebookEditor}var _5=class extends Lr{constructor(e,i,n,o,s,a,l,d,c,p,h,m,f,g,v,I,y){super(e,s,a,d,l,p,c,h,g,v,I);this.editorService=i;this.notebookKernelService=n;this.notebookExecutionStateService=o;this.quickInputService=m;this.commandService=f;this.menuService=y;this._register(this.editorService.onDidActiveEditorChange(this.handleActiveEditorChange.bind(this))),this._register(this.notebookKernelService.onDidNotebookVariablesUpdate(this.handleVariablesChanged.bind(this))),this._register(this.notebookExecutionStateService.onDidChangeExecution(this.handleExecutionStateChange.bind(this))),this.setActiveNotebook(),this.dataSource=new y5(this.notebookKernelService),this.updateScheduler=new Ye(()=>this.tree?.updateChildren(),100)}static ID="notebookVariablesView";static TITLE=ie("notebook.notebookVariables","Notebook Variables");tree;activeNotebook;dataSource;updateScheduler;renderBody(e){super.renderBody(e),this.element.classList.add("debug-pane"),this.tree=this.instantiationService.createInstance(is,"notebookVariablesTree",e,new S5,[new Ng(this.hoverService)],this.dataSource,{accessibilityProvider:new C5,identityProvider:{getId:i=>i.id}}),this.tree.layout(),this.activeNotebook&&this.tree.setInput({kind:"root",notebook:this.activeNotebook}),this._register(this.tree.onContextMenu(i=>this.onContextMenu(i)))}onContextMenu(e){if(!e.element)return;let i=e.element,n={source:i.notebook.uri.toString(),name:i.name,value:i.value,type:i.type,expression:i.expression,language:i.language,extensionId:i.extensionId},o=[],s=this.contextKeyService.createOverlay([[HB.key,i.name],[mE.key,i.value],[WB.key,i.type],[fce.key,i.interfaces],[bce.key,i.language],[vce.key,i.extensionId]]),a=this.menuService.getMenuActions(V.NotebookVariablesContext,s,{arg:n,shouldForwardArgs:!0});sa(a,o),this.contextMenuService.showContextMenu({getAnchor:()=>e.anchor,getActions:()=>o})}layoutBody(e,i){super.layoutBody(e,i),this.tree?.layout(e,i)}setActiveNotebook(){let e=this.activeNotebook,i=this.editorService.activeEditorPane;if(i?.getId()==="workbench.editor.notebook"||i?.getId()==="workbench.editor.interactive"){let n=Cge(i)?.getViewModel()?.notebookDocument;this.activeNotebook=n}return e!==this.activeNotebook}handleActiveEditorChange(){this.setActiveNotebook()&&this.activeNotebook&&(this.tree?.setInput({kind:"root",notebook:this.activeNotebook}),this.updateScheduler.schedule())}handleExecutionStateChange(e){this.activeNotebook&&e.affectsNotebook(this.activeNotebook.uri)&&(this.dataSource.cancel(),e.changed===void 0?this.updateScheduler.schedule():this.updateScheduler.cancel())}handleVariablesChanged(e){this.activeNotebook&&e.toString()===this.activeNotebook.uri.toString()&&(this.tree?.setInput({kind:"root",notebook:this.activeNotebook}),this.updateScheduler.schedule())}};_5=E([b(1,$e),b(2,m5),b(3,p5),b(4,Be),b(5,vt),b(6,re),b(7,se),b(8,ne),b(9,$i),b(10,Yi),b(11,ki),b(12,ct),b(13,Fe),b(14,Tt),b(15,Nt),b(16,jt)],_5);var zZ="workbench.debug.viewlet.action.copyWorkspaceVariableValue",KZ=u("copyWorkspaceVariableValue","Copy Value");he(class extends Me{constructor(){super({id:zZ,title:KZ,f1:!1})}run(r,t){let e=r.get(rs);t.value&&e.writeText(t.value)}});he(class extends Me{constructor(){super({id:"_executeNotebookVariableProvider",title:u("executeNotebookVariableProvider","Execute Notebook Variable Provider"),f1:!1})}async run(r,t){if(!t)return[];let e=Z.revive(t),i=r.get(m5),o=r.get(E5).getNotebookTextModel(e);if(!o)return[];let s=i.getMatchingKernel(o).selected;return s&&s.hasVariableProvider?await s.provideVariables(o.uri,void 0,"named",0,Pt.None).map(l=>l).toPromise():[]}});Pe.as(Nd.ConfigurationMigration).registerConfigurationMigrations([{key:"debug.autoExpandLazyVariables",migrateFn:r=>r===!0?{value:"on"}:r===!1?{value:"off"}:[]}]);var D5=class{priority=120;name="replHelp";when=P.equals("focusedView","workbench.panel.repl.view");type="help";getProvider(t){let e=t.get(Mi),i=Bx(e);if(i)return new GZ(i)}},GZ=class extends R{constructor(e){super();this._replView=e;this._treeHadFocus=!!e.getFocusedElement()}id="replHelp";verbositySettingKey="accessibility.verbosity.debug";options={type:"help"};_treeHadFocus=!1;onClose(){if(this._treeHadFocus)return this._replView.focusTree();this._replView.getReplInput().focus()}provideContent(){return[u("repl.help","The debug console is a Read-Eval-Print-Loop that allows you to evaluate expressions and run commands and can be focused with{0}.","<keybinding:workbench.panel.repl.view.focus>"),u("repl.output","The debug console output can be navigated to from the input field with the Focus Previous Widget command{0}.","<keybinding:widgetNavigation.focusPrevious>"),u("repl.input","The debug console input can be navigated to from the output with the Focus Next Widget command{0}.","<keybinding:widgetNavigation.focusNext>"),u("repl.history","The debug console output history can be navigated with the up and down arrow keys."),u("repl.accessibleView","The Open Accessible View command{0} will allow character by character navigation of the console output.","<keybinding:editor.action.accessibleView>"),u("repl.showRunAndDebug","The Show Run and Debug view command{0} will open the Run and Debug view and provides more information about debugging.","<keybinding:workbench.view.debug>"),u("repl.clear","The Debug: Clear Console command{0} will clear the console output.","<keybinding:workbench.debug.panel.action.clearReplAction>"),u("repl.lazyVariables","The setting `debug.expandLazyVariables` controls whether variables are evaluated automatically. This is enabled by default when using a screen reader.")].join(`
`)}};var vS=class extends R{static ID="debug.replAccessibilityAnnouncer";constructor(t,e,i){super();let n=t.getViewModel();this._register(n.onDidFocusSession(o=>{o&&this._register(o.onDidChangeReplElements(s=>{if(!s||!("originalExpression"in s))return;let a=s.toString();e.status(a),i.trace("ReplAccessibilityAnnouncer#onDidChangeReplElements",s.originalExpression+": "+a)}))}))}};vS=E([b(0,we),b(1,Un),b(2,bt)],vS);var k5;(Y=>(Y.accessibilityHelpTitle=u("accessibilityHelpTitle","Accessibility Help"),Y.openingDocs=u("openingDocs","Opening the Accessibility documentation page."),Y.readonlyDiffEditor=u("readonlyDiffEditor","You are in a read-only pane of a diff editor."),Y.editableDiffEditor=u("editableDiffEditor","You are in a pane of a diff editor."),Y.readonlyEditor=u("readonlyEditor","You are in a read-only code editor."),Y.editableEditor=u("editableEditor","You are in a code editor."),Y.changeConfigToOnMac=u("changeConfigToOnMac","Configure the application to be optimized for usage with a Screen Reader (Command+E)."),Y.changeConfigToOnWinLinux=u("changeConfigToOnWinLinux","Configure the application to be optimized for usage with a Screen Reader (Control+E)."),Y.auto_on=u("auto_on","The application is configured to be optimized for usage with a Screen Reader."),Y.auto_off=u("auto_off","The application is configured to never be optimized for usage with a Screen Reader."),Y.screenReaderModeEnabled=u("screenReaderModeEnabled","Screen Reader Optimized Mode enabled."),Y.screenReaderModeDisabled=u("screenReaderModeDisabled","Screen Reader Optimized Mode disabled."),Y.tabFocusModeOnMsg=u("tabFocusModeOnMsg","Pressing Tab in the current editor will move focus to the next focusable element. Toggle this behavior{0}.","<keybinding:editor.action.toggleTabFocusMode>"),Y.tabFocusModeOffMsg=u("tabFocusModeOffMsg","Pressing Tab in the current editor will insert the tab character. Toggle this behavior{0}.","<keybinding:editor.action.toggleTabFocusMode>"),Y.stickScroll=u("stickScrollKb","Focus Sticky Scroll{0} to focus the currently nested scopes.","<keybinding:editor.action.focusStickyDebugConsole>"),Y.codeFolding=u("codeFolding","Use code folding to collapse blocks of code and focus on the code you're interested in via the Toggle Folding Command{0}.","<keybinding:editor.toggleFold>"),Y.intellisense=u("intellisense","Use Intellisense to improve coding efficiency and reduce errors. Trigger suggestions{0}.","<keybinding:editor.action.triggerSuggest>"),Y.showOrFocusHover=u("showOrFocusHover","Show or focus the hover{0} to read information about the current symbol.","<keybinding:editor.action.showHover>"),Y.goToSymbol=u("goToSymbol","Go to Symbol{0} to quickly navigate between symbols in the current file.","<keybinding:workbench.action.gotoSymbol>"),Y.showAccessibilityHelpAction=u("showAccessibilityHelpAction","Show Accessibility Help"),Y.listSignalSounds=u("listSignalSoundsCommand","Run the command: List Signal Sounds for an overview of all sounds and their current status."),Y.listAlerts=u("listAnnouncementsCommand","Run the command: List Signal Announcements for an overview of announcements and their current status."),Y.quickChat=u("quickChatCommand","Toggle quick chat{0} to open or close a chat session.","<keybinding:workbench.action.quickchat.toggle>"),Y.startInlineChat=u("startInlineChatCommand","Start inline chat{0} to create an in editor chat session.","<keybinding:inlineChat.start>"),Y.startDebugging=u("debug.startDebugging","The Debug: Start Debugging command{0} will start a debug session.","<keybinding:workbench.action.debug.start>"),Y.setBreakpoint=u("debugConsole.setBreakpoint","The Debug: Inline Breakpoint command{0} will set or unset a breakpoint at the current cursor position in the active editor.","<keybinding:editor.debug.action.toggleInlineBreakpoint>"),Y.addToWatch=u("debugConsole.addToWatch","The Debug: Add to Watch command{0} will add the selected text to the watch view.","<keybinding:editor.debug.action.selectionToWatch>"),Y.debugExecuteSelection=u("debugConsole.executeSelection","The Debug: Execute Selection command{0} will execute the selected text in the debug console.","<keybinding:editor.debug.action.selectionToRepl>")))(k5||={});var Hke;(t=>t.inspectTokensAction=u("inspectTokens","Developer: Inspect Tokens"))(Hke||={});var Uke;(t=>t.gotoLineActionLabel=u("gotoLineActionLabel","Go to Line/Column..."))(Uke||={});var zke;(t=>t.helpQuickAccessActionLabel=u("helpQuickAccess","Show all Quick Access Providers"))(zke||={});var Kke;(e=>(e.quickCommandActionLabel=u("quickCommandActionLabel","Command Palette"),e.quickCommandHelp=u("quickCommandActionHelp","Show And Run Commands")))(Kke||={});var Gke;(e=>(e.quickOutlineActionLabel=u("quickOutlineActionLabel","Go to Symbol..."),e.quickOutlineByCategoryActionLabel=u("quickOutlineByCategoryActionLabel","Go to Symbol by Category...")))(Gke||={});var qke;(t=>t.editorViewAccessibleLabel=u("editorViewAccessibleLabel","Editor content"))(qke||={});var $ke;(t=>t.toggleHighContrast=u("toggleHighContrast","Toggle High Contrast Theme"))($ke||={});var jke;(t=>t.bulkEditServiceSummary=u("bulkEditServiceSummary","Made {0} edits in {1} files"))(jke||={});var L5=class{priority=120;name="runAndDebugHelp";when=P.or(P.and(P.equals("activeViewlet","workbench.view.debug"),dde),P.equals(Ks.key,hy),P.equals(Ks.key,Mu),P.equals(Ks.key,ag),P.equals(Ks.key,my),P.equals(Ks.key,Aa));type="help";getProvider(t){return new _M(t.get(ct),t.get(Mi))}},_M=class extends R{constructor(e,i){super();this._commandService=e;this._viewsService=i;this._focusedView=this._viewsService.getFocusedViewName()}id="runAndDebug";verbositySettingKey="accessibility.verbosity.debug";options={type:"help"};_focusedView;onClose(){switch(this._focusedView){case"Watch":this._commandService.executeCommand("workbench.debug.action.focusWatchView");break;case"Variables":this._commandService.executeCommand("workbench.debug.action.focusVariablesView");break;case"Call Stack":this._commandService.executeCommand("workbench.debug.action.focusCallStackView");break;case"Breakpoints":this._commandService.executeCommand("workbench.debug.action.focusBreakpointsView");break;default:this._commandService.executeCommand("workbench.view.debug")}}provideContent(){return[u("debug.showRunAndDebug","The Show Run and Debug view command{0} will open the current view.","<keybinding:workbench.view.debug>"),u("debug.startDebugging","The Debug: Start Debugging command{0} will start a debug session.","<keybinding:workbench.action.debug.start>"),u("debug.help","Access debug output and evaluate expressions in the debug console, which can be focused with{0}.","<keybinding:workbench.panel.repl.view.focus>"),k5.setBreakpoint,k5.addToWatch,u("onceDebugging","Once debugging, the following commands will be available:"),u("debug.restartDebugging","- Debug: Restart Debugging command{0} will restart the current debug session.","<keybinding:workbench.action.debug.restart>"),u("debug.stopDebugging","- Debug: Stop Debugging command{0} will stop the current debugging session.","<keybinding:workbench.action.debug.stop>"),u("debug.continue","- Debug: Continue command{0} will continue execution until the next breakpoint.","<keybinding:workbench.action.debug.continue>"),u("debug.stepInto","- Debug: Step Into command{0} will step into the next function call.","<keybinding:workbench.action.debug.stepInto>"),u("debug.stepOver","- Debug: Step Over command{0} will step over the current function call.","<keybinding:workbench.action.debug.stepOver>"),u("debug.stepOut","- Debug: Step Out command{0} will step out of the current function call.","<keybinding:workbench.action.debug.stepOut>"),u("debug.views","The debug viewlet is comprised of several views that can be focused with the following commands or navigated to via tab then arrow keys:"),u("debug.focusBreakpoints","- Debug: Focus Breakpoints View command{0} will focus the breakpoints view.","<keybinding:workbench.debug.action.focusBreakpointsView>"),u("debug.focusCallStack","- Debug: Focus Call Stack View command{0} will focus the call stack view.","<keybinding:workbench.debug.action.focusCallStackView>"),u("debug.focusVariables","- Debug: Focus Variables View command{0} will focus the variables view.","<keybinding:workbench.debug.action.focusVariablesView>"),u("debug.focusWatch","- Debug: Focus Watch View command{0} will focus the watch view.","<keybinding:workbench.debug.action.focusWatchView>"),u("debug.watchSetting","The setting {0} controls whether watch variable changes are announced.","accessibility.debugWatchVariableAnnouncements")].join(`
`)}};_M=E([b(0,ct),b(1,Mi)],_M);var IS=class extends R{constructor(e,i,n,o){super();this._debugService=e;this._logService=i;this._accessibilityService=n;this._configurationService=o;this._setListener(),this._register(o.onDidChangeConfiguration(s=>{s.affectsConfiguration("accessibility.debugWatchVariableAnnouncements")&&this._setListener()}))}static ID="workbench.contrib.debugWatchAccessibilityAnnouncer";_listener=this._register(new yt);_setListener(){this._configurationService.getValue("accessibility.debugWatchVariableAnnouncements")&&!this._listener.value?this._listener.value=this._debugService.getModel().onDidChangeWatchExpressionValue(i=>{!i||i.value===Hi.DEFAULT_VALUE||(this._accessibilityService.alert(`${i.name} = ${i.value}`),this._logService.trace(`debugAccessibilityAnnouncerValueChanged ${i.name} ${i.value}`))}):this._listener.clear()}};IS=E([b(0,we),b(1,bt),b(2,Un),b(3,se)],IS);var Xke=u("debugCategory","Debug");Tpe();gi(we,vT,1);gi(hE,pE,1);Pe.as(Pd.Workbench).registerWorkbenchContribution(CT,4);Pe.as(Pd.Workbench).registerWorkbenchContribution(sT,4);si&&Pe.as(Pd.Workbench).registerWorkbenchContribution(e_,4);Pe.as(Pd.Workbench).registerWorkbenchContribution(Px,3);Pe.as(Pd.Workbench).registerWorkbenchContribution(lp,4);Pe.as(Pd.Workbench).registerWorkbenchContribution(a_,4);Pe.as(Pd.Workbench).registerWorkbenchContribution(wE,4);Pe.as(Pd.Workbench).registerWorkbenchContribution(d_,4);Pe.as(j0.Quickaccess).registerQuickAccessProvider({ctor:aT,prefix:aP,contextKey:"inLaunchConfigurationsPicker",placeholder:u("startDebugPlaceholder","Type the name of a launch configuration to run."),helpEntries:[{description:u("startDebuggingHelp","Start Debugging"),commandId:Ku,commandCenterOrder:50}]});Pe.as(j0.Quickaccess).registerQuickAccessProvider({ctor:Vx,prefix:lP,contextKey:"inDebugConsolePicker",placeholder:u("tasksQuickAccessPlaceholder","Type the name of a debug console to open."),helpEntries:[{description:u("tasksQuickAccessHelp","Show All Debug Consoles"),commandId:wU}]});gr("editor.contrib.callStack",CE,1);gr(Gd,vx,1);gr(dg,kg,2);var Kn=(r,t,e,i)=>{Ue.appendMenuItem(V.CommandPalette,{when:P.and(oi,e),group:Xke,command:{id:r,title:t,category:tP,precondition:i}})};Kn(Mh,Xb);Kn(CU,ie("terminateThread","Terminate Thread"),ui);Kn(Ah,Yb,ui,Gt.isEqualTo("stopped"));Kn(Oh,Qb,ui,Gt.isEqualTo("stopped"));Kn(zj,que,ui,P.and(Cb,ui,Gt.isEqualTo("stopped")));Kn(Nh,Zb,ui,Gt.isEqualTo("stopped"));Kn(vg,Jb,ui,P.and(Gt.isEqualTo("running"),Th.toNegated()));Kn(td,Ig,ui,P.or(qs,Kd));Kn(Tx,iP,ui,P.or(qs,P.and(wb,Kd)));Kn(Va,Vh,ui,P.or(qs.toNegated(),Kd));Kn(Fh,ev,ui,Gt.isEqualTo("stopped"));Kn(Gj,ie({comment:["Debug is a noun in this context, not a verb."],key:"debugFocusConsole"},"Focus on Debug Console View"));Kn(ZR,ie("jumpToCursor","Jump to Cursor"),gy);Kn(ZR,ie("SetNextStatement","Set Next Statement"),gy);Kn(Wx.ID,Wx.LABEL,oi);Kn(Hx.ID,Hx.LABEL,ui);Kn(Ux.ID,Ux.LABEL);Kn(QR,ie("inlineBreakpoint","Inline Breakpoint"));Kn(Oc,nP,P.and(oi,Gt.notEqualsTo(Ql(1))));Kn(JR,nX,P.and(oi,Gt.notEqualsTo(Ql(1))));Kn(Ku,jue,P.and(oi,Gt.notEqualsTo(Ql(1))));Kn(Yj,Xue);Kn(Qj,Yue);Kn(Zj,Que,ui);Kn(wU,ipe);Kn(qj,npe);Kn(Jj,Zue,ui,Gt.isEqualTo("stopped"));Kn(eX,Jue,ui,Gt.isEqualTo("stopped"));Kn(tX,epe,ui,Gt.isEqualTo("stopped"));Kn(iX,tpe,ui,Gt.isEqualTo("stopped"));var dn=(r,t,e,i,n,o,s="navigation",a)=>{Ue.appendMenuItem(r,{group:s,when:n,order:i,icon:a,command:{id:t,title:e,icon:a,precondition:o}})};dn(V.DebugCallStackContext,Mh,Xb,10,Ho.isEqualTo("session"),void 0,"3_modification");dn(V.DebugCallStackContext,td,Ig,20,Ho.isEqualTo("session"),void 0,"3_modification");dn(V.DebugCallStackContext,Tx,iP,21,P.and(Ho.isEqualTo("session"),wb,Kd),void 0,"3_modification");dn(V.DebugCallStackContext,Va,Vh,30,Ho.isEqualTo("session"),void 0,"3_modification");dn(V.DebugCallStackContext,vg,Jb,10,P.and(Ho.isEqualTo("thread"),P.and(Gt.isEqualTo("running"),Th.toNegated())));dn(V.DebugCallStackContext,Fh,ev,10,P.and(Ho.isEqualTo("thread"),Gt.isEqualTo("stopped")));dn(V.DebugCallStackContext,Ah,Yb,20,Ho.isEqualTo("thread"),Gt.isEqualTo("stopped"));dn(V.DebugCallStackContext,Oh,Qb,30,Ho.isEqualTo("thread"),Gt.isEqualTo("stopped"));dn(V.DebugCallStackContext,Nh,Zb,40,Ho.isEqualTo("thread"),Gt.isEqualTo("stopped"));dn(V.DebugCallStackContext,CU,u("terminateThread","Terminate Thread"),10,Ho.isEqualTo("thread"),void 0,"termination");dn(V.DebugCallStackContext,Kj,u("restartFrame","Restart Frame"),10,P.and(Ho.isEqualTo("stackFrame"),hV),mV);dn(V.DebugCallStackContext,Wj,u("copyStackTrace","Copy Call Stack"),20,Ho.isEqualTo("stackFrame"),void 0,"3_modification");dn(V.DebugVariablesContext,AP,u("viewMemory","View Binary Data"),15,fb,ui,"inline",kB);dn(V.DebugVariablesContext,EY,u("setValue","Set Value"),10,P.or(QL,P.and(bb,ZL)),cy.toNegated(),"3_modification");dn(V.DebugVariablesContext,jb,rP,10,void 0,void 0,"5_cutcopypaste");dn(V.DebugVariablesContext,zy,oP,20,bb,void 0,"5_cutcopypaste");dn(V.DebugVariablesContext,eP,sP,100,bb,void 0,"z_commands");dn(V.DebugVariablesContext,B2,u("breakWhenValueIsRead","Break on Value Read"),200,eR,void 0,"z_commands");dn(V.DebugVariablesContext,N2,u("breakWhenValueChanges","Break on Value Change"),210,yE,void 0,"z_commands");dn(V.DebugVariablesContext,F2,u("breakWhenValueIsAccessed","Break on Value Access"),220,JL,void 0,"z_commands");dn(V.DebugHoverContext,AP,u("viewMemory","View Binary Data"),15,fb,ui,"inline",kB);dn(V.DebugHoverContext,jb,rP,10,void 0,void 0,"5_cutcopypaste");dn(V.DebugHoverContext,zy,oP,20,bb,void 0,"5_cutcopypaste");dn(V.DebugHoverContext,eP,sP,100,bb,void 0,"z_commands");dn(V.DebugHoverContext,B2,u("breakWhenValueIsRead","Break on Value Read"),200,eR,void 0,"z_commands");dn(V.DebugHoverContext,N2,u("breakWhenValueChanges","Break on Value Change"),210,yE,void 0,"z_commands");dn(V.DebugHoverContext,F2,u("breakWhenValueIsAccessed","Break on Value Access"),220,JL,void 0,"z_commands");dn(V.DebugWatchContext,MZ,AZ,10,void 0,void 0,"3_modification");dn(V.DebugWatchContext,$j,u("editWatchExpression","Edit Expression"),20,xh.isEqualTo("expression"),void 0,"3_modification");dn(V.DebugWatchContext,jj,u("setValue","Set Value"),30,P.or(P.and(xh.isEqualTo("expression"),ZL),P.and(xh.isEqualTo("variable"),QL)),cy.toNegated(),"3_modification");dn(V.DebugWatchContext,jb,u("copyValue","Copy Value"),40,P.or(xh.isEqualTo("expression"),xh.isEqualTo("variable")),ui,"3_modification");dn(V.DebugWatchContext,AP,u("viewMemory","View Binary Data"),10,fb,void 0,"inline",kB);dn(V.DebugWatchContext,Xj,u("removeWatchExpression","Remove Expression"),20,xh.isEqualTo("expression"),void 0,"inline",Fde);dn(V.DebugWatchContext,OZ,NZ,20,void 0,void 0,"z_commands");dn(V.NotebookVariablesContext,zZ,KZ,20,mE);if(ye){let r=(t,e,i,n,o)=>{Ue.appendMenuItem(V.TouchBarContext,{command:{id:t,title:e,icon:{dark:o}},when:P.and(oi,n),group:"9_debug",order:i})};r(JR,nX,0,ui.toNegated(),Ao.asFileUri("vs/workbench/contrib/debug/browser/media/continue-tb.png")),r(Oc,nP,1,ui.toNegated(),Ao.asFileUri("vs/workbench/contrib/debug/browser/media/run-with-debugging-tb.png")),r(Fh,ev,0,Gt.isEqualTo("stopped"),Ao.asFileUri("vs/workbench/contrib/debug/browser/media/continue-tb.png")),r(vg,Jb,1,P.and(ui,P.and(Gt.isEqualTo("running"),Th.toNegated())),Ao.asFileUri("vs/workbench/contrib/debug/browser/media/pause-tb.png")),r(Ah,Yb,2,ui,Ao.asFileUri("vs/workbench/contrib/debug/browser/media/stepover-tb.png")),r(Oh,Qb,3,ui,Ao.asFileUri("vs/workbench/contrib/debug/browser/media/stepinto-tb.png")),r(Nh,Zb,4,ui,Ao.asFileUri("vs/workbench/contrib/debug/browser/media/stepout-tb.png")),r(Mh,Xb,5,ui,Ao.asFileUri("vs/workbench/contrib/debug/browser/media/restart-tb.png")),r(Va,Vh,6,ui,Ao.asFileUri("vs/workbench/contrib/debug/browser/media/stop-tb.png"))}Ue.appendMenuItem(V.EditorTitle,{submenu:V.EditorTitleRun,rememberDefaultAction:!0,title:ie("run","Run or Debug..."),icon:Pde,group:"navigation",order:-1});Ue.appendMenuItem(V.MenubarMainMenu,{submenu:V.MenubarDebugMenu,title:{...ie("runMenu","Run"),mnemonicTitle:u({key:"mRun",comment:["&& denotes a mnemonic"]},"&&Run")},order:6});Ue.appendMenuItem(V.MenubarDebugMenu,{group:"1_debug",command:{id:Oc,title:u({key:"miStartDebugging",comment:["&& denotes a mnemonic"]},"&&Start Debugging")},order:1,when:oi});Ue.appendMenuItem(V.MenubarDebugMenu,{group:"1_debug",command:{id:JR,title:u({key:"miRun",comment:["&& denotes a mnemonic"]},"Run &&Without Debugging")},order:2,when:oi});Ue.appendMenuItem(V.MenubarDebugMenu,{group:"1_debug",command:{id:Va,title:u({key:"miStopDebugging",comment:["&& denotes a mnemonic"]},"&&Stop Debugging"),precondition:ui},order:3,when:oi});Ue.appendMenuItem(V.MenubarDebugMenu,{group:"1_debug",command:{id:Mh,title:u({key:"miRestart Debugging",comment:["&& denotes a mnemonic"]},"&&Restart Debugging"),precondition:ui},order:4,when:oi});Ue.appendMenuItem(V.MenubarDebugMenu,{group:"2_configuration",command:{id:Uy,title:u({key:"miAddConfiguration",comment:["&& denotes a mnemonic"]},"A&&dd Configuration...")},order:2,when:oi});Ue.appendMenuItem(V.MenubarDebugMenu,{group:"3_step",command:{id:Ah,title:u({key:"miStepOver",comment:["&& denotes a mnemonic"]},"Step &&Over"),precondition:Gt.isEqualTo("stopped")},order:1,when:oi});Ue.appendMenuItem(V.MenubarDebugMenu,{group:"3_step",command:{id:Oh,title:u({key:"miStepInto",comment:["&& denotes a mnemonic"]},"Step &&Into"),precondition:Gt.isEqualTo("stopped")},order:2,when:oi});Ue.appendMenuItem(V.MenubarDebugMenu,{group:"3_step",command:{id:Nh,title:u({key:"miStepOut",comment:["&& denotes a mnemonic"]},"Step O&&ut"),precondition:Gt.isEqualTo("stopped")},order:3,when:oi});Ue.appendMenuItem(V.MenubarDebugMenu,{group:"3_step",command:{id:Fh,title:u({key:"miContinue",comment:["&& denotes a mnemonic"]},"&&Continue"),precondition:Gt.isEqualTo("stopped")},order:4,when:oi});Ue.appendMenuItem(V.MenubarNewBreakpointMenu,{group:"1_breakpoints",command:{id:QR,title:u({key:"miInlineBreakpoint",comment:["&& denotes a mnemonic"]},"Inline Breakp&&oint")},order:2,when:oi});Ue.appendMenuItem(V.MenubarDebugMenu,{group:"4_new_breakpoint",title:u({key:"miNewBreakpoint",comment:["&& denotes a mnemonic"]},"&&New Breakpoint"),submenu:V.MenubarNewBreakpointMenu,order:2,when:oi});Ue.appendMenuItem(V.MenubarDebugMenu,{group:"z_install",command:{id:"debug.installAdditionalDebuggers",title:u({key:"miInstallAdditionalDebuggers",comment:["&& denotes a mnemonic"]},"&&Install Additional Debuggers...")},order:1});var Yke=Pe.as(xc.ViewContainersRegistry).registerViewContainer({id:oV,title:ie({comment:["Debug is a noun in this context, not a verb."],key:"debugPanel"},"Debug Console"),icon:k6,ctorDescriptor:new qr(ch,[oV,{mergeViewWithContainerWhenSingleView:!0}]),storageId:oV,hideIfEmpty:!0,order:2},1,{doNotRegisterOpenCommand:!0});Pe.as(xc.ViewsRegistry).registerViews([{id:ln,name:ie({comment:["Debug is a noun in this context, not a verb."],key:"debugPanel"},"Debug Console"),containerIcon:k6,canToggleVisibility:!1,canMoveView:!0,when:oi,ctorDescriptor:new qr(Xu),openCommandActionDescriptor:{id:"workbench.debug.action.toggleRepl",mnemonicTitle:u({key:"miToggleDebugConsole",comment:["&& denotes a mnemonic"]},"De&&bug Console"),keybindings:{primary:3127},order:2}}],Yke);var p_=Pe.as(xc.ViewContainersRegistry).registerViewContainer({id:nr,title:ie("run and debug","Run and Debug"),openCommandActionDescriptor:{id:nr,mnemonicTitle:u({key:"miViewRun",comment:["&& denotes a mnemonic"]},"&&Run"),keybindings:{primary:3106},order:3},ctorDescriptor:new qr(r_),icon:L6,alwaysUseContainerInfo:!0,order:3},0),h_=Pe.as(xc.ViewsRegistry);h_.registerViews([{id:hy,name:ie("variables","Variables"),containerIcon:Tde,ctorDescriptor:new qr(nT),order:10,weight:40,canToggleVisibility:!0,canMoveView:!0,focusCommand:{id:"workbench.debug.action.focusVariablesView"},when:zd.isEqualTo("default")}],p_);h_.registerViews([{id:Mu,name:ie("watch","Watch"),containerIcon:_de,ctorDescriptor:new qr(l_),order:20,weight:10,canToggleVisibility:!0,canMoveView:!0,focusCommand:{id:"workbench.debug.action.focusWatchView"},when:zd.isEqualTo("default")}],p_);h_.registerViews([{id:ag,name:ie("callStack","Call Stack"),containerIcon:Dde,ctorDescriptor:new qr(Mx),order:30,weight:30,canToggleVisibility:!0,canMoveView:!0,focusCommand:{id:"workbench.debug.action.focusCallStackView"},when:zd.isEqualTo("default")}],p_);h_.registerViews([{id:Aa,name:ie("breakpoints","Breakpoints"),containerIcon:kde,ctorDescriptor:new qr(EE),order:40,weight:20,canToggleVisibility:!0,canMoveView:!0,focusCommand:{id:"workbench.debug.action.focusBreakpointsView"},when:P.or(lg,zd.isEqualTo("default"),rV)}],p_);h_.registerViews([{id:za.ID,name:za.LABEL,containerIcon:L6,ctorDescriptor:new qr(za),order:1,weight:40,canToggleVisibility:!0,when:zd.isEqualTo("simple")}],p_);h_.registerViews([{id:my,name:ie("loadedScripts","Loaded Scripts"),containerIcon:Lde,ctorDescriptor:new qr(s_),order:35,weight:5,canToggleVisibility:!0,canMoveView:!0,collapsed:!0,when:P.and(pV,zd.isEqualTo("default"))}],p_);Pe.as(Ld.EditorPane).registerEditorPane(W1.create(Oa,nV,u("disassembly","Disassembly")),[new qr(Yl)]);var Qke=Pe.as(ur.Configuration);Qke.registerConfiguration({id:"debug",order:20,title:u("debugConfigurationTitle","Debug"),type:"object",properties:{"debug.showVariableTypes":{type:"boolean",description:u({comment:["This is the description for a setting"],key:"showVariableTypes"},"Show variable type in variable pane during debug session"),default:!1},"debug.allowBreakpointsEverywhere":{type:"boolean",description:u({comment:["This is the description for a setting"],key:"allowBreakpointsEverywhere"},"Allow setting breakpoints in any file."),default:!1},"debug.gutterMiddleClickAction":{type:"string",enum:["logpoint","conditionalBreakpoint","triggeredBreakpoint","none"],description:u({comment:["This is the description for a setting"],key:"gutterMiddleClickAction"},"Controls the action to perform when clicking the editor gutter with the middle mouse button."),enumDescriptions:[u("debug.gutterMiddleClickAction.logpoint","Add Logpoint."),u("debug.gutterMiddleClickAction.conditionalBreakpoint","Add Conditional Breakpoint."),u("debug.gutterMiddleClickAction.triggeredBreakpoint","Add Triggered Breakpoint."),u("debug.gutterMiddleClickAction.none","Don't perform any action.")],default:"logpoint"},"debug.openExplorerOnEnd":{type:"boolean",description:u({comment:["This is the description for a setting"],key:"openExplorerOnEnd"},"Automatically open the explorer view at the end of a debug session."),default:!1},"debug.closeReadonlyTabsOnEnd":{type:"boolean",description:u({comment:["This is the description for a setting"],key:"closeReadonlyTabsOnEnd"},"At the end of a debug session, all the read-only tabs associated with that session will be closed"),default:!1},"debug.inlineValues":{type:"string",enum:["on","off","auto"],description:u({comment:["This is the description for a setting"],key:"inlineValues"},"Show variable values inline in editor while debugging."),enumDescriptions:[u("inlineValues.on","Always show variable values inline in editor while debugging."),u("inlineValues.off","Never show variable values inline in editor while debugging."),u("inlineValues.focusNoScroll","Show variable values inline in editor while debugging when the language supports inline value locations.")],default:"auto"},"debug.toolBarLocation":{enum:["floating","docked","commandCenter","hidden"],markdownDescription:u({comment:["This is the description for a setting"],key:"toolBarLocation"},"Controls the location of the debug toolbar. Either `floating` in all views, `docked` in the debug view, `commandCenter` (requires {0}), or `hidden`.","`#window.commandCenter#`"),default:"floating",markdownEnumDescriptions:[u("debugToolBar.floating","Show debug toolbar in all views."),u("debugToolBar.docked","Show debug toolbar only in debug views."),u("debugToolBar.commandCenter","`(Experimental)` Show debug toolbar in the command center."),u("debugToolBar.hidden","Do not show debug toolbar.")]},"debug.showInStatusBar":{enum:["never","always","onFirstSessionStart"],enumDescriptions:[u("never","Never show debug in Status bar"),u("always","Always show debug in Status bar"),u("onFirstSessionStart","Show debug in Status bar only after debug was started for the first time")],description:u({comment:["This is the description for a setting"],key:"showInStatusBar"},"Controls when the debug Status bar should be visible."),default:"onFirstSessionStart"},"debug.internalConsoleOptions":SV,"debug.console.closeOnEnd":{type:"boolean",description:u("debug.console.closeOnEnd","Controls if the Debug Console should be automatically closed when the debug session ends."),default:!1},"debug.terminal.clearBeforeReusing":{type:"boolean",description:u({comment:["This is the description for a setting"],key:"debug.terminal.clearBeforeReusing"},"Before starting a new debug session in an integrated or external terminal, clear the terminal."),default:!1},"debug.openDebug":{enum:["neverOpen","openOnSessionStart","openOnFirstSessionStart","openOnDebugBreak"],default:"openOnDebugBreak",description:u("openDebug","Controls when the debug view should open.")},"debug.showSubSessionsInToolBar":{type:"boolean",description:u({comment:["This is the description for a setting"],key:"showSubSessionsInToolBar"},"Controls whether the debug sub-sessions are shown in the debug tool bar. When this setting is false the stop command on a sub-session will also stop the parent session."),default:!1},"debug.console.fontSize":{type:"number",description:u("debug.console.fontSize","Controls the font size in pixels in the Debug Console."),default:ye?12:14},"debug.console.fontFamily":{type:"string",description:u("debug.console.fontFamily","Controls the font family in the Debug Console."),default:"default"},"debug.console.lineHeight":{type:"number",description:u("debug.console.lineHeight","Controls the line height in pixels in the Debug Console. Use 0 to compute the line height from the font size."),default:0},"debug.console.wordWrap":{type:"boolean",description:u("debug.console.wordWrap","Controls if the lines should wrap in the Debug Console."),default:!0},"debug.console.historySuggestions":{type:"boolean",description:u("debug.console.historySuggestions","Controls if the Debug Console should suggest previously typed input."),default:!0},"debug.console.collapseIdenticalLines":{type:"boolean",description:u("debug.console.collapseIdenticalLines","Controls if the Debug Console should collapse identical lines and show a number of occurrences with a badge."),default:!0},"debug.console.acceptSuggestionOnEnter":{enum:["off","on"],description:u("debug.console.acceptSuggestionOnEnter","Controls whether suggestions should be accepted on Enter in the Debug Console. Enter is also used to evaluate whatever is typed in the Debug Console."),default:"off"},launch:{type:"object",description:u({comment:["This is the description for a setting"],key:"launch"},"Global debug launch configuration. Should be used as an alternative to 'launch.json' that is shared across workspaces."),default:{configurations:[],compounds:[]},$ref:$m,disallowConfigurationDefault:!0},"debug.focusWindowOnBreak":{type:"boolean",description:u("debug.focusWindowOnBreak","Controls whether the workbench window should be focused when the debugger breaks."),default:!0},"debug.focusEditorOnBreak":{type:"boolean",description:u("debug.focusEditorOnBreak","Controls whether the editor should be focused when the debugger breaks."),default:!0},"debug.onTaskErrors":{enum:["debugAnyway","showErrors","prompt","abort"],enumDescriptions:[u("debugAnyway","Ignore task errors and start debugging."),u("showErrors","Show the Problems view and do not start debugging."),u("prompt","Prompt user."),u("cancel","Cancel debugging.")],description:u("debug.onTaskErrors","Controls what to do when errors are encountered after running a preLaunchTask."),default:"prompt"},"debug.showBreakpointsInOverviewRuler":{type:"boolean",description:u({comment:["This is the description for a setting"],key:"showBreakpointsInOverviewRuler"},"Controls whether breakpoints should be shown in the overview ruler."),default:!1},"debug.showInlineBreakpointCandidates":{type:"boolean",description:u({comment:["This is the description for a setting"],key:"showInlineBreakpointCandidates"},"Controls whether inline breakpoints candidate decorations should be shown in the editor while debugging."),default:!0},"debug.saveBeforeStart":{description:u("debug.saveBeforeStart","Controls what editors to save before starting a debug session."),enum:["allEditorsInActiveGroup","nonUntitledEditorsInActiveGroup","none"],enumDescriptions:[u("debug.saveBeforeStart.allEditorsInActiveGroup","Save all editors in the active group before starting a debug session."),u("debug.saveBeforeStart.nonUntitledEditorsInActiveGroup","Save all editors in the active group except untitled ones before starting a debug session."),u("debug.saveBeforeStart.none","Don't save any editors before starting a debug session.")],default:"allEditorsInActiveGroup",scope:5},"debug.confirmOnExit":{description:u("debug.confirmOnExit","Controls whether to confirm when the window closes if there are active debug sessions."),type:"string",enum:["never","always"],enumDescriptions:[u("debug.confirmOnExit.never","Never confirm."),u("debug.confirmOnExit.always","Always confirm if there are debug sessions.")],default:"never"},"debug.disassemblyView.showSourceCode":{type:"boolean",default:!0,description:u("debug.disassemblyView.showSourceCode","Show Source Code in Disassembly View.")},"debug.autoExpandLazyVariables":{type:"string",enum:["auto","on","off"],default:"auto",enumDescriptions:[u("debug.autoExpandLazyVariables.auto","When in screen reader optimized mode, automatically expand lazy variables."),u("debug.autoExpandLazyVariables.on","Always automatically expand lazy variables."),u("debug.autoExpandLazyVariables.off","Never automatically expand lazy variables.")],description:u("debug.autoExpandLazyVariables","Controls whether variables that are lazily resolved, such as getters, are automatically resolved and expanded by the debugger.")},"debug.enableStatusBarColor":{type:"boolean",description:u("debug.enableStatusBarColor","Color of the Status bar when debugger is active."),default:!0},"debug.hideLauncherWhileDebugging":{type:"boolean",markdownDescription:u({comment:["This is the description for a setting"],key:"debug.hideLauncherWhileDebugging"},"Hide 'Start Debugging' control in title bar of 'Run and Debug' view while debugging is active. Only relevant when {0} is not `docked`.","`#debug.toolBarLocation#`"),default:!1}}});eN.register(new VU);eN.register(new D5);eN.register(new L5);Yk(vS.ID,vS,Ec.AfterRestored);Yk(IS.ID,IS,Ec.AfterRestored);
