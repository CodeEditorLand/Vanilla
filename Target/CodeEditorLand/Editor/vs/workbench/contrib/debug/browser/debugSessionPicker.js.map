{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/debug/browser/debugSessionPicker.ts"],
  "sourcesContent": ["import { matchesFuzzy } from \"../../../../base/common/filters.js\";\nimport { DisposableStore } from \"../../../../base/common/lifecycle.js\";\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as nls from \"../../../../nls.js\";\nimport {\n\tIQuickInputService,\n\ttype IQuickPickSeparator,\n} from \"../../../../platform/quickinput/common/quickInput.js\";\nimport {\n\tIDebugService,\n\ttype IDebugSession,\n\tREPL_VIEW_ID,\n} from \"../common/debug.js\";\n\nimport { ICommandService } from \"../../../../platform/commands/common/commands.js\";\nimport type { ServicesAccessor } from \"../../../../platform/instantiation/common/instantiation.js\";\nimport { IViewsService } from \"../../../services/views/common/viewsService.js\";\nimport type { IPickerDebugItem } from \"../common/loadedScriptsPicker.js\";\n\nexport async function showDebugSessionMenu(\n\taccessor: ServicesAccessor,\n\tselectAndStartID: string,\n) {\n\tconst quickInputService = accessor.get(IQuickInputService);\n\tconst debugService = accessor.get(IDebugService);\n\tconst viewsService = accessor.get(IViewsService);\n\tconst commandService = accessor.get(ICommandService);\n\n\tconst localDisposableStore = new DisposableStore();\n\tconst quickPick = quickInputService.createQuickPick<IPickerDebugItem>({\n\t\tuseSeparators: true,\n\t});\n\tlocalDisposableStore.add(quickPick);\n\tquickPick.matchOnLabel =\n\t\tquickPick.matchOnDescription =\n\t\tquickPick.matchOnDetail =\n\t\tquickPick.sortByLabel =\n\t\t\tfalse;\n\tquickPick.placeholder = nls.localize(\n\t\t\"moveFocusedView.selectView\",\n\t\t\"Search debug sessions by name\",\n\t);\n\n\tconst pickItems = _getPicksAndActiveItem(\n\t\tquickPick.value,\n\t\tselectAndStartID,\n\t\tdebugService,\n\t\tviewsService,\n\t\tcommandService,\n\t);\n\tquickPick.items = pickItems.picks;\n\tquickPick.activeItems = pickItems.activeItems;\n\n\tlocalDisposableStore.add(\n\t\tquickPick.onDidChangeValue(async () => {\n\t\t\tquickPick.items = _getPicksAndActiveItem(\n\t\t\t\tquickPick.value,\n\t\t\t\tselectAndStartID,\n\t\t\t\tdebugService,\n\t\t\t\tviewsService,\n\t\t\t\tcommandService,\n\t\t\t).picks;\n\t\t}),\n\t);\n\tlocalDisposableStore.add(\n\t\tquickPick.onDidAccept(() => {\n\t\t\tconst selectedItem = quickPick.selectedItems[0];\n\t\t\tselectedItem.accept();\n\t\t\tquickPick.hide();\n\t\t\tlocalDisposableStore.dispose();\n\t\t}),\n\t);\n\tquickPick.show();\n}\n\nfunction _getPicksAndActiveItem(\n\tfilter: string,\n\tselectAndStartID: string,\n\tdebugService: IDebugService,\n\tviewsService: IViewsService,\n\tcommandService: ICommandService,\n): {\n\tpicks: Array<IPickerDebugItem | IQuickPickSeparator>;\n\tactiveItems: Array<IPickerDebugItem>;\n} {\n\tconst debugConsolePicks: Array<IPickerDebugItem | IQuickPickSeparator> = [];\n\tconst headerSessions: IDebugSession[] = [];\n\n\tconst currSession = debugService.getViewModel().focusedSession;\n\tconst sessions = debugService.getModel().getSessions(false);\n\tconst activeItems: Array<IPickerDebugItem> = [];\n\n\tsessions.forEach((session) => {\n\t\tif (session.compact && session.parentSession) {\n\t\t\theaderSessions.push(session.parentSession);\n\t\t}\n\t});\n\n\tsessions.forEach((session) => {\n\t\tconst isHeader = headerSessions.includes(session);\n\t\tif (!session.parentSession) {\n\t\t\tdebugConsolePicks.push({\n\t\t\t\ttype: \"separator\",\n\t\t\t\tlabel: isHeader ? session.name : undefined,\n\t\t\t});\n\t\t}\n\n\t\tif (!isHeader) {\n\t\t\tconst pick = _createPick(\n\t\t\t\tsession,\n\t\t\t\tfilter,\n\t\t\t\tdebugService,\n\t\t\t\tviewsService,\n\t\t\t\tcommandService,\n\t\t\t);\n\t\t\tif (pick) {\n\t\t\t\tdebugConsolePicks.push(pick);\n\t\t\t\tif (session.getId() === currSession?.getId()) {\n\t\t\t\t\tactiveItems.push(pick);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\n\tif (debugConsolePicks.length) {\n\t\tdebugConsolePicks.push({ type: \"separator\" });\n\t}\n\n\tconst createDebugSessionLabel = nls.localize(\n\t\t\"workbench.action.debug.startDebug\",\n\t\t\"Start a New Debug Session\",\n\t);\n\tdebugConsolePicks.push({\n\t\tlabel: `$(plus) ${createDebugSessionLabel}`,\n\t\tariaLabel: createDebugSessionLabel,\n\t\taccept: () => commandService.executeCommand(selectAndStartID),\n\t});\n\n\treturn { picks: debugConsolePicks, activeItems };\n}\n\nfunction _getSessionInfo(session: IDebugSession): {\n\tlabel: string;\n\tdescription: string;\n\tariaLabel: string;\n} {\n\tconst label = !session.configuration.name.length\n\t\t? session.name\n\t\t: session.configuration.name;\n\tconst parentName = session.compact\n\t\t? undefined\n\t\t: session.parentSession?.configuration.name;\n\tlet description = \"\";\n\tlet ariaLabel = \"\";\n\tif (parentName) {\n\t\tariaLabel = nls.localize(\n\t\t\t\"workbench.action.debug.spawnFrom\",\n\t\t\t\"Session {0} spawned from {1}\",\n\t\t\tlabel,\n\t\t\tparentName,\n\t\t);\n\t\tdescription = parentName;\n\t}\n\n\treturn { label, description, ariaLabel };\n}\n\nfunction _createPick(\n\tsession: IDebugSession,\n\tfilter: string,\n\tdebugService: IDebugService,\n\tviewsService: IViewsService,\n\tcommandService: ICommandService,\n): IPickerDebugItem | undefined {\n\tconst pickInfo = _getSessionInfo(session);\n\tconst highlights = matchesFuzzy(filter, pickInfo.label, true);\n\tif (highlights) {\n\t\treturn {\n\t\t\tlabel: pickInfo.label,\n\t\t\tdescription: pickInfo.description,\n\t\t\tariaLabel: pickInfo.ariaLabel,\n\t\t\thighlights: { label: highlights },\n\t\t\taccept: () => {\n\t\t\t\tdebugService.focusStackFrame(undefined, undefined, session, {\n\t\t\t\t\texplicit: true,\n\t\t\t\t});\n\t\t\t\tif (!viewsService.isViewVisible(REPL_VIEW_ID)) {\n\t\t\t\t\tviewsService.openView(REPL_VIEW_ID, true);\n\t\t\t\t}\n\t\t\t},\n\t\t};\n\t}\n\treturn undefined;\n}\n"],
  "mappings": "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",
  "names": []
}
