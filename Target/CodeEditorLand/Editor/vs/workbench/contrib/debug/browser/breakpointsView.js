var xe=Object.defineProperty;var ye=Object.getOwnPropertyDescriptor;var P=(c,i,e,t)=>{for(var s=t>1?void 0:t?ye(i,e):i,n=c.length-1,o;n>=0;n--)(o=c[n])&&(s=(t?o(i,e,s):o(s))||s);return t&&s&&xe(i,e,s),s},m=(c,i)=>(e,t)=>i(e,t,c);import*as r from"../../../../base/browser/dom.js";import"../../../../base/browser/keyboardEvent.js";import{Gesture as Te}from"../../../../base/browser/touch.js";import{ActionBar as q}from"../../../../base/browser/ui/actionbar/actionbar.js";import"../../../../base/browser/ui/aria/aria.js";import{getDefaultHoverDelegate as I}from"../../../../base/browser/ui/hover/hoverDelegateFactory.js";import{IconLabel as Ce}from"../../../../base/browser/ui/iconLabel/iconLabel.js";import{InputBox as se}from"../../../../base/browser/ui/inputbox/inputBox.js";import"../../../../base/browser/ui/list/list.js";import"../../../../base/browser/ui/list/listWidget.js";import{Orientation as ce}from"../../../../base/browser/ui/splitview/splitview.js";import{Action as de}from"../../../../base/common/actions.js";import{equals as we}from"../../../../base/common/arrays.js";import{RunOnceScheduler as Ee}from"../../../../base/common/async.js";import{Codicon as ue}from"../../../../base/common/codicons.js";import{MarkdownString as Me}from"../../../../base/common/htmlContent.js";import{KeyCode as R}from"../../../../base/common/keyCodes.js";import{DisposableStore as Ae,dispose as y}from"../../../../base/common/lifecycle.js";import*as le from"../../../../base/common/resources.js";import{ThemeIcon as K}from"../../../../base/common/themables.js";import{Constants as ge}from"../../../../base/common/uint.js";import{isCodeEditor as Le}from"../../../../editor/browser/editorBrowser.js";import"../../../../editor/browser/editorExtensions.js";import{ILanguageService as He}from"../../../../editor/common/languages/language.js";import{localize as a,localize2 as C}from"../../../../nls.js";import{createAndFillInActionBarActions as G,createAndFillInContextMenuActions as Fe}from"../../../../platform/actions/browser/menuEntryActionViewItem.js";import{Action2 as w,IMenuService as Ve,MenuId as b,registerAction2 as k}from"../../../../platform/actions/common/actions.js";import{IConfigurationService as Ne}from"../../../../platform/configuration/common/configuration.js";import{ContextKeyExpr as B,IContextKeyService as Oe}from"../../../../platform/contextkey/common/contextkey.js";import{IContextMenuService as me,IContextViewService as _e}from"../../../../platform/contextview/browser/contextView.js";import{TextEditorSelectionRevealType as Pe}from"../../../../platform/editor/common/editor.js";import{IHoverService as $}from"../../../../platform/hover/browser/hover.js";import{IInstantiationService as Re}from"../../../../platform/instantiation/common/instantiation.js";import{IKeybindingService as Ke}from"../../../../platform/keybinding/common/keybinding.js";import{ILabelService as X}from"../../../../platform/label/common/label.js";import{WorkbenchList as Ue}from"../../../../platform/list/browser/listService.js";import{IOpenerService as qe}from"../../../../platform/opener/common/opener.js";import{IQuickInputService as be}from"../../../../platform/quickinput/common/quickInput.js";import{ITelemetryService as $e}from"../../../../platform/telemetry/common/telemetry.js";import{defaultInputBoxStyles as re}from"../../../../platform/theme/browser/defaultStyles.js";import{IThemeService as Xe}from"../../../../platform/theme/common/themeService.js";import{ViewAction as Y,ViewPane as We}from"../../../browser/parts/views/viewPane.js";import"../../../browser/parts/views/viewsViewlet.js";import"../../../common/editor.js";import{IViewDescriptorService as ze}from"../../../common/views.js";import*as S from"./debugIcons.js";import"./disassemblyView.js";import{BREAKPOINTS_VIEW_ID as T,BREAKPOINT_EDITOR_CONTRIBUTION_ID as je,CONTEXT_BREAKPOINTS_EXIST as Q,CONTEXT_BREAKPOINTS_FOCUSED as Ge,CONTEXT_BREAKPOINT_HAS_MODES as he,CONTEXT_BREAKPOINT_INPUT_FOCUSED as Ye,CONTEXT_BREAKPOINT_ITEM_IS_DATA_BYTES as ve,CONTEXT_BREAKPOINT_ITEM_TYPE as v,CONTEXT_BREAKPOINT_SUPPORTS_CONDITION as ae,CONTEXT_DEBUGGERS_AVAILABLE as U,CONTEXT_IN_DEBUG_MODE as Qe,CONTEXT_SET_DATA_BREAKPOINT_BYTES_SUPPORTED as pe,DEBUG_SCHEME as Je,DataBreakpointSetType as J,DebuggerString as Ze,IDebugService as h,State as N}from"../common/debug.js";import{Breakpoint as x,DataBreakpoint as O,ExceptionBreakpoint as W,FunctionBreakpoint as E,InstructionBreakpoint as M}from"../common/debugModel.js";import{DisassemblyViewInput as et}from"../common/disassemblyViewInput.js";import{ACTIVE_GROUP as tt,IEditorService as Ie,SIDE_GROUP as it}from"../../../services/editor/common/editorService.js";import{INotificationService as nt}from"../../../../platform/notification/common/notification.js";import{IViewsService as ot}from"../../../services/views/common/viewsService.js";const u=r.$;function A(c){const i=u("input");return i.type="checkbox",i.tabIndex=-1,c.push(Te.ignoreTarget(i)),i}const st=9;function ke(c,i,e){const t=c.getBreakpoints().length+c.getExceptionBreakpointsForSession(i).length+c.getFunctionBreakpoints().length+c.getDataBreakpoints().length+c.getInstructionBreakpoints().length;return Math.min(e,t)*22}let Z=class extends We{constructor(e,t,s,n,o,p,d,g,l,f,D,j,oe,pt,Se,De,ct){super(e,n,t,l,D,f,o,j,p,oe,De);this.debugService=s;this.editorService=d;this.contextViewService=g;this.labelService=pt;this.languageService=ct;this.menu=Se.createMenu(b.DebugBreakpointsContext,D),this._register(this.menu),this.breakpointItemType=v.bindTo(D),this.breakpointIsDataBytes=ve.bindTo(D),this.breakpointHasMultipleModes=he.bindTo(D),this.breakpointSupportsCondition=ae.bindTo(D),this.breakpointInputFocused=Ye.bindTo(D),this._register(this.debugService.getModel().onDidChangeBreakpoints(()=>this.onBreakpointsChange())),this._register(this.debugService.getViewModel().onDidFocusSession(()=>this.onBreakpointsChange())),this._register(this.debugService.onDidChangeState(()=>this.onStateChange())),this.hintDelayer=this._register(new Ee(()=>this.updateBreakpointsHint(!0),4e3))}list;needsRefresh=!1;needsStateChange=!1;ignoreLayout=!1;menu;breakpointItemType;breakpointIsDataBytes;breakpointHasMultipleModes;breakpointSupportsCondition;_inputBoxData;breakpointInputFocused;autoFocusedIndex=-1;hintContainer;hintDelayer;renderBody(e){super.renderBody(e),this.element.classList.add("debug-pane"),e.classList.add("debug-breakpoints");const t=new rt(this);this.list=this.instantiationService.createInstance(Ue,"Breakpoints",e,t,[this.instantiationService.createInstance(L,this.menu,this.breakpointHasMultipleModes,this.breakpointSupportsCondition,this.breakpointItemType),new ee(this.menu,this.breakpointHasMultipleModes,this.breakpointSupportsCondition,this.breakpointItemType,this.debugService,this.hoverService),new ne(this,this.debugService,this.contextViewService),this.instantiationService.createInstance(H,this.menu,this.breakpointSupportsCondition,this.breakpointItemType),new te(this,this.debugService,this.contextViewService,this.hoverService,this.labelService),this.instantiationService.createInstance(F,this.menu,this.breakpointHasMultipleModes,this.breakpointSupportsCondition,this.breakpointItemType,this.breakpointIsDataBytes),new ie(this,this.debugService,this.contextViewService,this.hoverService,this.labelService),this.instantiationService.createInstance(V)],{identityProvider:{getId:n=>n.getId()},multipleSelectionSupport:!1,keyboardNavigationLabelProvider:{getKeyboardNavigationLabel:n=>n},accessibilityProvider:new at(this.debugService,this.labelService),overrideStyles:this.getLocationBasedColors().listOverrideStyles}),Ge.bindTo(this.list.contextKeyService),this._register(this.list.onContextMenu(this.onListContextMenu,this)),this.list.onMouseMiddleClick(async({element:n})=>{n instanceof x?await this.debugService.removeBreakpoints(n.getId()):n instanceof E?await this.debugService.removeFunctionBreakpoints(n.getId()):n instanceof O?await this.debugService.removeDataBreakpoints(n.getId()):n instanceof M&&await this.debugService.removeInstructionBreakpoints(n.instructionReference,n.offset)}),this._register(this.list.onDidOpen(async n=>{n.element&&(r.isMouseEvent(n.browserEvent)&&n.browserEvent.button===1||(n.element instanceof x&&Be(n.element,n.sideBySide,n.editorOptions.preserveFocus||!1,n.editorOptions.pinned||!n.editorOptions.preserveFocus,this.debugService,this.editorService),n.element instanceof M&&(await this.editorService.openEditor(et.instance)).goToInstructionAndOffset(n.element.instructionReference,n.element.offset,r.isMouseEvent(n.browserEvent)&&n.browserEvent.detail===2),r.isMouseEvent(n.browserEvent)&&n.browserEvent.detail===2&&n.element instanceof E&&n.element!==this.inputBoxData?.breakpoint&&this.renderInputBox({breakpoint:n.element,type:"name"})))})),this.list.splice(0,this.list.length,this.elements),this._register(this.onDidChangeBodyVisibility(n=>{n&&(this.needsRefresh&&this.onBreakpointsChange(),this.needsStateChange&&this.onStateChange())}));const s=this.viewDescriptorService.getViewContainerModel(this.viewDescriptorService.getViewContainerByViewId(this.id));this._register(s.onDidChangeAllViewDescriptors(()=>{this.updateSize()}))}renderHeaderTitle(e,t){super.renderHeaderTitle(e,t);const s=r.append(e,u("span.breakpoint-warning"));this.hintContainer=this._register(new Ce(s,{supportIcons:!0,hoverDelegate:{showHover:(n,o)=>this.hoverService.showHover({content:n.content,target:this.hintContainer.element},o),delay:this.configurationService.getValue("workbench.hover.delay")}})),r.hide(this.hintContainer.element)}focus(){super.focus(),this.list?.domFocus()}renderInputBox(e){this._inputBoxData=e,this.onBreakpointsChange(),this._inputBoxData=void 0}get inputBoxData(){return this._inputBoxData}layoutBody(e,t){if(!this.ignoreLayout){super.layoutBody(e,t),this.list?.layout(e,t);try{this.ignoreLayout=!0,this.updateSize()}finally{this.ignoreLayout=!1}}}onListContextMenu(e){const t=e.element,s=t instanceof x?"breakpoint":t instanceof W?"exceptionBreakpoint":t instanceof E?"functionBreakpoint":t instanceof O?"dataBreakpoint":t instanceof M?"instructionBreakpoint":void 0;this.breakpointItemType.set(s);const n=this.debugService.getViewModel().focusedSession,o=t instanceof W?t.supportsCondition:!n||!!n.capabilities.supportsConditionalBreakpoints;this.breakpointSupportsCondition.set(o),this.breakpointIsDataBytes.set(t instanceof O&&t.src.type===J.Address);const p=[];Fe(this.menu,{arg:e.element,shouldForwardArgs:!1},{primary:[],secondary:p},"inline"),this.contextMenuService.showContextMenu({getAnchor:()=>e.anchor,getActions:()=>p,getActionsContext:()=>t})}updateSize(){const e=this.viewDescriptorService.getViewContainerModel(this.viewDescriptorService.getViewContainerByViewId(this.id)),t=this.debugService.getViewModel().focusedSession?.getId();this.minimumBodySize=this.orientation===ce.VERTICAL?ke(this.debugService.getModel(),t,st):170,this.maximumBodySize=this.orientation===ce.VERTICAL&&e.visibleViewDescriptors.length>1?ke(this.debugService.getModel(),t,Number.POSITIVE_INFINITY):Number.POSITIVE_INFINITY}updateBreakpointsHint(e=!1){if(!this.hintContainer)return;const t=this.debugService.getViewModel().focusedSession?.configuration.type,s=t?this.debugService.getAdapterManager().getDebugger(t):void 0,n=s?.strings?.[Ze.UnverifiedBreakpoints],o=n&&this.debugService.getModel().getBreakpoints().filter(p=>{if(p.verified||!p.enabled)return!1;const d=this.languageService.guessLanguageIdByFilepathOrFirstLine(p.uri);return d&&s.interestedInLanguage(d)});if(n&&o?.length&&this.debugService.getModel().areBreakpointsActivated())if(e){const p=new Me(void 0,{isTrusted:!0}).appendMarkdown(n);this.hintContainer.setLabel("$(warning)",void 0,{title:{markdown:p,markdownNotSupportedFallback:n}}),r.show(this.hintContainer.element)}else this.hintDelayer.schedule();else r.hide(this.hintContainer.element)}onBreakpointsChange(){if(this.isBodyVisible()){if(this.updateSize(),this.list){const e=this.list.getFocus()[0],t=e&&!this.elements.includes(this.list.element(e));this.list.splice(0,this.list.length,this.elements),this.needsRefresh=!1,t&&this.list.focusNth(Math.min(e,this.list.length-1))}this.updateBreakpointsHint()}else this.needsRefresh=!0}onStateChange(){if(this.isBodyVisible()){this.needsStateChange=!1;const e=this.debugService.getViewModel().focusedThread;let t=!1;if(e&&e.stoppedDetails&&e.stoppedDetails.hitBreakpointIds&&e.stoppedDetails.hitBreakpointIds.length>0){const s=e.stoppedDetails.hitBreakpointIds,o=this.elements.findIndex(p=>{const d=p.getIdFromAdapter(e.session.getId());return typeof d=="number"&&s.indexOf(d)!==-1});o>=0&&(this.list.setFocus([o]),this.list.setSelection([o]),t=!0,this.autoFocusedIndex=o)}if(!t){const s=this.list.getFocus(),n=this.list.getSelection();this.autoFocusedIndex>=0&&we(s,n)&&s.indexOf(this.autoFocusedIndex)>=0&&(this.list.setFocus([]),this.list.setSelection([])),this.autoFocusedIndex=-1}this.updateBreakpointsHint()}else this.needsStateChange=!0}get elements(){const e=this.debugService.getModel(),t=this.debugService.getViewModel().focusedSession?.getId();return e.getExceptionBreakpointsForSession(t).concat(e.getFunctionBreakpoints()).concat(e.getDataBreakpoints()).concat(e.getBreakpoints()).concat(e.getInstructionBreakpoints())}};Z=P([m(1,me),m(2,h),m(3,Ke),m(4,Re),m(5,Xe),m(6,Ie),m(7,_e),m(8,Ne),m(9,ze),m(10,Oe),m(11,qe),m(12,$e),m(13,X),m(14,Ve),m(15,$),m(16,He)],Z);class rt{constructor(i){this.view=i}getHeight(i){return 22}getTemplateId(i){if(i instanceof x)return L.ID;if(i instanceof E){const e=this.view.inputBoxData?.breakpoint;return!i.name||e&&e.getId()===i.getId()?te.ID:H.ID}if(i instanceof W){const e=this.view.inputBoxData?.breakpoint;return e&&e.getId()===i.getId()?ne.ID:ee.ID}if(i instanceof O){const e=this.view.inputBoxData?.breakpoint;return e&&e.getId()===i.getId()?ie.ID:F.ID}return i instanceof M?V.ID:""}}const z=new Map;let L=class{constructor(i,e,t,s,n,o,p){this.menu=i;this.breakpointHasMultipleModes=e;this.breakpointSupportsCondition=t;this.breakpointItemType=s;this.debugService=n;this.hoverService=o;this.labelService=p}static ID="breakpoints";get templateId(){return L.ID}renderTemplate(i){const e=Object.create(null);e.toDispose=[],e.breakpoint=r.append(i,u(".breakpoint")),e.icon=u(".icon"),e.checkbox=A(e.toDispose),e.toDispose.push(r.addStandardDisposableListener(e.checkbox,"change",s=>{this.debugService.enableOrDisableBreakpoints(!e.context.enabled,e.context)})),r.append(e.breakpoint,e.icon),r.append(e.breakpoint,e.checkbox),e.name=r.append(e.breakpoint,u("span.name")),e.filePath=r.append(e.breakpoint,u("span.file-path")),e.actionBar=new q(e.breakpoint),e.toDispose.push(e.actionBar);const t=r.append(e.breakpoint,u(".badge-container"));return e.badge=r.append(t,u("span.line-number.monaco-count-badge")),e}renderElement(i,e,t){t.context=i,t.breakpoint.classList.toggle("disabled",!this.debugService.getModel().areBreakpointsActivated()),t.name.textContent=le.basenameOrAuthority(i.uri);let s=i.lineNumber.toString();i.column&&(s+=`:${i.column}`),i.modeLabel&&(s=`${i.modeLabel}: ${s}`),t.badge.textContent=s,t.filePath.textContent=this.labelService.getUriLabel(le.dirname(i.uri),{relative:!0}),t.checkbox.checked=i.enabled;const{message:n,icon:o}=_(this.debugService.state,this.debugService.getModel().areBreakpointsActivated(),i,this.labelService,this.debugService.getModel());t.icon.className=K.asClassName(o),t.toDispose.push(this.hoverService.setupManagedHover(I("mouse"),t.breakpoint,i.message||n||"")),(this.debugService.state===N.Running||this.debugService.state===N.Stopped)&&!i.verified&&t.breakpoint.classList.add("disabled");const d=[],g=this.debugService.getViewModel().focusedSession;this.breakpointSupportsCondition.set(!g||!!g.capabilities.supportsConditionalBreakpoints),this.breakpointItemType.set("breakpoint"),this.breakpointHasMultipleModes.set(this.debugService.getModel().getBreakpointModes("source").length>1),G(this.menu,{arg:i,shouldForwardArgs:!0},{primary:d,secondary:[]},"inline"),t.actionBar.clear(),t.actionBar.push(d,{icon:!0,label:!1}),z.set(i.getId(),t.actionBar.domNode)}disposeTemplate(i){y(i.toDispose)}};L=P([m(4,h),m(5,$),m(6,X)],L);class ee{constructor(i,e,t,s,n,o){this.menu=i;this.breakpointHasMultipleModes=e;this.breakpointSupportsCondition=t;this.breakpointItemType=s;this.debugService=n;this.hoverService=o}static ID="exceptionbreakpoints";get templateId(){return ee.ID}renderTemplate(i){const e=Object.create(null);e.toDispose=[],e.breakpoint=r.append(i,u(".breakpoint")),e.checkbox=A(e.toDispose),e.toDispose.push(r.addStandardDisposableListener(e.checkbox,"change",s=>{this.debugService.enableOrDisableBreakpoints(!e.context.enabled,e.context)})),r.append(e.breakpoint,e.checkbox),e.name=r.append(e.breakpoint,u("span.name")),e.condition=r.append(e.breakpoint,u("span.condition")),e.breakpoint.classList.add("exception"),e.actionBar=new q(e.breakpoint),e.toDispose.push(e.actionBar);const t=r.append(e.breakpoint,u(".badge-container"));return e.badge=r.append(t,u("span.line-number.monaco-count-badge")),e}renderElement(i,e,t){t.context=i,t.name.textContent=i.label||`${i.filter} exceptions`;const s=i.verified?i.description||t.name.textContent:i.message||a("unverifiedExceptionBreakpoint","Unverified Exception Breakpoint");t.toDispose.push(this.hoverService.setupManagedHover(I("mouse"),t.breakpoint,s)),t.breakpoint.classList.toggle("disabled",!i.verified),t.checkbox.checked=i.enabled,t.condition.textContent=i.condition||"",t.toDispose.push(this.hoverService.setupManagedHover(I("mouse"),t.condition,a("expressionCondition","Expression condition: {0}",i.condition))),i.modeLabel?(t.badge.textContent=i.modeLabel,t.badge.style.display="block"):t.badge.style.display="none";const n=[];this.breakpointSupportsCondition.set(i.supportsCondition),this.breakpointItemType.set("exceptionBreakpoint"),this.breakpointHasMultipleModes.set(this.debugService.getModel().getBreakpointModes("exception").length>1),G(this.menu,{arg:i,shouldForwardArgs:!0},{primary:n,secondary:[]},"inline"),t.actionBar.clear(),t.actionBar.push(n,{icon:!0,label:!1}),z.set(i.getId(),t.actionBar.domNode)}disposeTemplate(i){y(i.toDispose)}}let H=class{constructor(i,e,t,s,n,o){this.menu=i;this.breakpointSupportsCondition=e;this.breakpointItemType=t;this.debugService=s;this.hoverService=n;this.labelService=o}static ID="functionbreakpoints";get templateId(){return H.ID}renderTemplate(i){const e=Object.create(null);e.toDispose=[],e.breakpoint=r.append(i,u(".breakpoint")),e.icon=u(".icon"),e.checkbox=A(e.toDispose),e.toDispose.push(r.addStandardDisposableListener(e.checkbox,"change",s=>{this.debugService.enableOrDisableBreakpoints(!e.context.enabled,e.context)})),r.append(e.breakpoint,e.icon),r.append(e.breakpoint,e.checkbox),e.name=r.append(e.breakpoint,u("span.name")),e.condition=r.append(e.breakpoint,u("span.condition")),e.actionBar=new q(e.breakpoint),e.toDispose.push(e.actionBar);const t=r.append(e.breakpoint,u(".badge-container"));return e.badge=r.append(t,u("span.line-number.monaco-count-badge")),e}renderElement(i,e,t){t.context=i,t.name.textContent=i.name;const{icon:s,message:n}=_(this.debugService.state,this.debugService.getModel().areBreakpointsActivated(),i,this.labelService,this.debugService.getModel());t.icon.className=K.asClassName(s),t.toDispose.push(this.hoverService.setupManagedHover(I("mouse"),t.icon,n||"")),t.checkbox.checked=i.enabled,t.toDispose.push(this.hoverService.setupManagedHover(I("mouse"),t.breakpoint,n||"")),i.condition&&i.hitCondition?t.condition.textContent=a("expressionAndHitCount","Condition: {0} | Hit Count: {1}",i.condition,i.hitCondition):t.condition.textContent=i.condition||i.hitCondition||"",i.modeLabel?(t.badge.textContent=i.modeLabel,t.badge.style.display="block"):t.badge.style.display="none";const o=this.debugService.getViewModel().focusedSession;t.breakpoint.classList.toggle("disabled",o&&!o.capabilities.supportsFunctionBreakpoints||!this.debugService.getModel().areBreakpointsActivated()),o&&!o.capabilities.supportsFunctionBreakpoints&&t.toDispose.push(this.hoverService.setupManagedHover(I("mouse"),t.breakpoint,a("functionBreakpointsNotSupported","Function breakpoints are not supported by this debug type")));const p=[];this.breakpointSupportsCondition.set(!o||!!o.capabilities.supportsConditionalBreakpoints),this.breakpointItemType.set("functionBreakpoint"),G(this.menu,{arg:i,shouldForwardArgs:!0},{primary:p,secondary:[]},"inline"),t.actionBar.clear(),t.actionBar.push(p,{icon:!0,label:!1}),z.set(i.getId(),t.actionBar.domNode)}disposeTemplate(i){y(i.toDispose)}};H=P([m(3,h),m(4,$),m(5,X)],H);let F=class{constructor(i,e,t,s,n,o,p,d){this.menu=i;this.breakpointHasMultipleModes=e;this.breakpointSupportsCondition=t;this.breakpointItemType=s;this.breakpointIsDataBytes=n;this.debugService=o;this.hoverService=p;this.labelService=d}static ID="databreakpoints";get templateId(){return F.ID}renderTemplate(i){const e=Object.create(null);e.breakpoint=r.append(i,u(".breakpoint")),e.toDispose=[],e.icon=u(".icon"),e.checkbox=A(e.toDispose),e.toDispose.push(r.addStandardDisposableListener(e.checkbox,"change",s=>{this.debugService.enableOrDisableBreakpoints(!e.context.enabled,e.context)})),r.append(e.breakpoint,e.icon),r.append(e.breakpoint,e.checkbox),e.name=r.append(e.breakpoint,u("span.name")),e.accessType=r.append(e.breakpoint,u("span.access-type")),e.condition=r.append(e.breakpoint,u("span.condition")),e.actionBar=new q(e.breakpoint),e.toDispose.push(e.actionBar);const t=r.append(e.breakpoint,u(".badge-container"));return e.badge=r.append(t,u("span.line-number.monaco-count-badge")),e}renderElement(i,e,t){t.context=i,t.name.textContent=i.description;const{icon:s,message:n}=_(this.debugService.state,this.debugService.getModel().areBreakpointsActivated(),i,this.labelService,this.debugService.getModel());t.icon.className=K.asClassName(s),t.toDispose.push(this.hoverService.setupManagedHover(I("mouse"),t.icon,n||"")),t.checkbox.checked=i.enabled,t.toDispose.push(this.hoverService.setupManagedHover(I("mouse"),t.breakpoint,n||"")),i.modeLabel?(t.badge.textContent=i.modeLabel,t.badge.style.display="block"):t.badge.style.display="none";const o=this.debugService.getViewModel().focusedSession;if(t.breakpoint.classList.toggle("disabled",o&&!o.capabilities.supportsDataBreakpoints||!this.debugService.getModel().areBreakpointsActivated()),o&&!o.capabilities.supportsDataBreakpoints&&t.toDispose.push(this.hoverService.setupManagedHover(I("mouse"),t.breakpoint,a("dataBreakpointsNotSupported","Data breakpoints are not supported by this debug type"))),i.accessType){const d=i.accessType==="read"?a("read","Read"):i.accessType==="write"?a("write","Write"):a("access","Access");t.accessType.textContent=d}else t.accessType.textContent="";i.condition&&i.hitCondition?t.condition.textContent=a("expressionAndHitCount","Condition: {0} | Hit Count: {1}",i.condition,i.hitCondition):t.condition.textContent=i.condition||i.hitCondition||"";const p=[];this.breakpointSupportsCondition.set(!o||!!o.capabilities.supportsConditionalBreakpoints),this.breakpointHasMultipleModes.set(this.debugService.getModel().getBreakpointModes("data").length>1),this.breakpointItemType.set("dataBreakpoint"),this.breakpointIsDataBytes.set(i.src.type===J.Address),G(this.menu,{arg:i,shouldForwardArgs:!0},{primary:p,secondary:[]},"inline"),t.actionBar.clear(),t.actionBar.push(p,{icon:!0,label:!1}),z.set(i.getId(),t.actionBar.domNode),this.breakpointIsDataBytes.reset()}disposeTemplate(i){y(i.toDispose)}};F=P([m(5,h),m(6,$),m(7,X)],F);let V=class{constructor(i,e,t){this.debugService=i;this.hoverService=e;this.labelService=t}static ID="instructionBreakpoints";get templateId(){return V.ID}renderTemplate(i){const e=Object.create(null);e.toDispose=[],e.breakpoint=r.append(i,u(".breakpoint")),e.icon=u(".icon"),e.checkbox=A(e.toDispose),e.toDispose.push(r.addStandardDisposableListener(e.checkbox,"change",s=>{this.debugService.enableOrDisableBreakpoints(!e.context.enabled,e.context)})),r.append(e.breakpoint,e.icon),r.append(e.breakpoint,e.checkbox),e.name=r.append(e.breakpoint,u("span.name")),e.address=r.append(e.breakpoint,u("span.file-path")),e.actionBar=new q(e.breakpoint),e.toDispose.push(e.actionBar);const t=r.append(e.breakpoint,u(".badge-container"));return e.badge=r.append(t,u("span.line-number.monaco-count-badge")),e}renderElement(i,e,t){t.context=i,t.breakpoint.classList.toggle("disabled",!this.debugService.getModel().areBreakpointsActivated()),t.name.textContent="0x"+i.address.toString(16),t.toDispose.push(this.hoverService.setupManagedHover(I("mouse"),t.name,"Decimal address: breakpoint.address.toString()")),t.checkbox.checked=i.enabled;const{message:s,icon:n}=_(this.debugService.state,this.debugService.getModel().areBreakpointsActivated(),i,this.labelService,this.debugService.getModel());t.icon.className=K.asClassName(n),t.toDispose.push(this.hoverService.setupManagedHover(I("mouse"),t.breakpoint,i.message||s||"")),(this.debugService.state===N.Running||this.debugService.state===N.Stopped)&&!i.verified&&t.breakpoint.classList.add("disabled"),i.modeLabel?(t.badge.textContent=i.modeLabel,t.badge.style.display="block"):t.badge.style.display="none"}disposeTemplate(i){y(i.toDispose)}};V=P([m(0,h),m(1,$),m(2,X)],V);class te{constructor(i,e,t,s,n){this.view=i;this.debugService=e;this.contextViewService=t;this.hoverService=s;this.labelService=n}static ID="functionbreakpointinput";get templateId(){return te.ID}renderTemplate(i){const e=Object.create(null),t=[],s=r.append(i,u(".breakpoint"));e.icon=u(".icon"),e.checkbox=A(t),r.append(s,e.icon),r.append(s,e.checkbox),this.view.breakpointInputFocused.set(!0);const n=r.append(s,u(".inputBoxContainer")),o=new se(n,this.contextViewService,{inputBoxStyles:re}),p=d=>{e.updating=!0;try{this.view.breakpointInputFocused.set(!1);const g=e.breakpoint.getId();d?(e.type==="name"&&this.debugService.updateFunctionBreakpoint(g,{name:o.value}),e.type==="condition"&&this.debugService.updateFunctionBreakpoint(g,{condition:o.value}),e.type==="hitCount"&&this.debugService.updateFunctionBreakpoint(g,{hitCondition:o.value})):e.type==="name"&&!e.breakpoint.name?this.debugService.removeFunctionBreakpoints(g):this.view.renderInputBox(void 0)}finally{e.updating=!1}};return t.push(r.addStandardDisposableListener(o.inputElement,"keydown",d=>{const g=d.equals(R.Escape),l=d.equals(R.Enter);(g||l)&&(d.preventDefault(),d.stopPropagation(),p(l))})),t.push(r.addDisposableListener(o.inputElement,"blur",()=>{e.updating||p(!!o.value)})),e.inputBox=o,e.toDispose=t,e}renderElement(i,e,t){t.breakpoint=i,t.type=this.view.inputBoxData?.type||"name";const{icon:s,message:n}=_(this.debugService.state,this.debugService.getModel().areBreakpointsActivated(),i,this.labelService,this.debugService.getModel());t.icon.className=K.asClassName(s),t.toDispose.push(this.hoverService.setupManagedHover(I("mouse"),t.icon,n||"")),t.checkbox.checked=i.enabled,t.checkbox.disabled=!0,t.inputBox.value=i.name||"";let o=a("functionBreakpointPlaceholder","Function to break on"),p=a("functionBreakPointInputAriaLabel","Type function breakpoint.");t.type==="condition"?(t.inputBox.value=i.condition||"",o=a("functionBreakpointExpressionPlaceholder","Break when expression evaluates to true"),p=a("functionBreakPointExpresionAriaLabel","Type expression. Function breakpoint will break when expression evaluates to true")):t.type==="hitCount"&&(t.inputBox.value=i.hitCondition||"",o=a("functionBreakpointHitCountPlaceholder","Break when hit count is met"),p=a("functionBreakPointHitCountAriaLabel","Type hit count. Function breakpoint will break when hit count is met.")),t.inputBox.setAriaLabel(p),t.inputBox.setPlaceHolder(o),setTimeout(()=>{t.inputBox.focus(),t.inputBox.select()},0)}disposeTemplate(i){y(i.toDispose)}}class ie{constructor(i,e,t,s,n){this.view=i;this.debugService=e;this.contextViewService=t;this.hoverService=s;this.labelService=n}static ID="databreakpointinput";get templateId(){return ie.ID}renderTemplate(i){const e=Object.create(null),t=[],s=r.append(i,u(".breakpoint"));e.icon=u(".icon"),e.checkbox=A(t),r.append(s,e.icon),r.append(s,e.checkbox),this.view.breakpointInputFocused.set(!0);const n=r.append(s,u(".inputBoxContainer")),o=new se(n,this.contextViewService,{inputBoxStyles:re}),p=d=>{e.updating=!0;try{this.view.breakpointInputFocused.set(!1);const g=e.breakpoint.getId();d?(e.type==="condition"&&this.debugService.updateDataBreakpoint(g,{condition:o.value}),e.type==="hitCount"&&this.debugService.updateDataBreakpoint(g,{hitCondition:o.value})):this.view.renderInputBox(void 0)}finally{e.updating=!1}};return t.push(r.addStandardDisposableListener(o.inputElement,"keydown",d=>{const g=d.equals(R.Escape),l=d.equals(R.Enter);(g||l)&&(d.preventDefault(),d.stopPropagation(),p(l))})),t.push(r.addDisposableListener(o.inputElement,"blur",()=>{e.updating||p(!!o.value)})),e.inputBox=o,e.toDispose=t,e}renderElement(i,e,t){t.breakpoint=i,t.type=this.view.inputBoxData?.type||"condition";const{icon:s,message:n}=_(this.debugService.state,this.debugService.getModel().areBreakpointsActivated(),i,this.labelService,this.debugService.getModel());t.icon.className=K.asClassName(s),t.toDispose.push(this.hoverService.setupManagedHover(I("mouse"),t.icon,n??"")),t.checkbox.checked=i.enabled,t.checkbox.disabled=!0,t.inputBox.value="";let o="",p="";t.type==="condition"?(t.inputBox.value=i.condition||"",o=a("dataBreakpointExpressionPlaceholder","Break when expression evaluates to true"),p=a("dataBreakPointExpresionAriaLabel","Type expression. Data breakpoint will break when expression evaluates to true")):t.type==="hitCount"&&(t.inputBox.value=i.hitCondition||"",o=a("dataBreakpointHitCountPlaceholder","Break when hit count is met"),p=a("dataBreakPointHitCountAriaLabel","Type hit count. Data breakpoint will break when hit count is met.")),t.inputBox.setAriaLabel(p),t.inputBox.setPlaceHolder(o),setTimeout(()=>{t.inputBox.focus(),t.inputBox.select()},0)}disposeTemplate(i){y(i.toDispose)}}class ne{constructor(i,e,t){this.view=i;this.debugService=e;this.contextViewService=t}static ID="exceptionbreakpointinput";get templateId(){return ne.ID}renderTemplate(i){const e=Object.create(null),t=[],s=r.append(i,u(".breakpoint"));s.classList.add("exception"),e.checkbox=A(t),r.append(s,e.checkbox),this.view.breakpointInputFocused.set(!0);const n=r.append(s,u(".inputBoxContainer")),o=new se(n,this.contextViewService,{ariaLabel:a("exceptionBreakpointAriaLabel","Type exception breakpoint condition"),inputBoxStyles:re}),p=d=>{this.view.breakpointInputFocused.set(!1);let g=e.breakpoint.condition;d&&(g=o.value!==""?o.value:void 0),this.debugService.setExceptionBreakpointCondition(e.breakpoint,g)};return t.push(r.addStandardDisposableListener(o.inputElement,"keydown",d=>{const g=d.equals(R.Escape),l=d.equals(R.Enter);(g||l)&&(d.preventDefault(),d.stopPropagation(),p(l))})),t.push(r.addDisposableListener(o.inputElement,"blur",()=>{setTimeout(()=>{p(!0)})})),e.inputBox=o,e.toDispose=t,e}renderElement(i,e,t){const s=i.conditionDescription||a("exceptionBreakpointPlaceholder","Break when expression evaluates to true");t.inputBox.setPlaceHolder(s),t.breakpoint=i,t.checkbox.checked=i.enabled,t.checkbox.disabled=!0,t.inputBox.value=i.condition||"",setTimeout(()=>{t.inputBox.focus(),t.inputBox.select()},0)}disposeTemplate(i){y(i.toDispose)}}class at{constructor(i,e){this.debugService=i;this.labelService=e}getWidgetAriaLabel(){return a("breakpoints","Breakpoints")}getRole(){return"checkbox"}isChecked(i){return i.enabled}getAriaLabel(i){if(i instanceof W)return i.toString();const{message:e}=_(this.debugService.state,this.debugService.getModel().areBreakpointsActivated(),i,this.labelService,this.debugService.getModel()),t=i.toString();return e?`${t}, ${e}`:t}}function Be(c,i,e,t,s,n){if(c.uri.scheme===Je&&s.state===N.Inactive)return Promise.resolve(void 0);const o=c.endLineNumber?{startLineNumber:c.lineNumber,endLineNumber:c.endLineNumber,startColumn:c.column||1,endColumn:c.endColumn||ge.MAX_SAFE_SMALL_INTEGER}:{startLineNumber:c.lineNumber,startColumn:c.column||1,endLineNumber:c.lineNumber,endColumn:c.column||ge.MAX_SAFE_SMALL_INTEGER};return n.openEditor({resource:c.uri,options:{preserveFocus:e,selection:o,revealIfOpened:!0,selectionRevealType:Pe.CenterIfOutsideViewport,pinned:t}},i?it:tt)}function _(c,i,e,t,s){const n=c===N.Running||c===N.Stopped,o=e instanceof O?S.dataBreakpoint:e instanceof E?S.functionBreakpoint:e.logMessage?S.logBreakpoint:S.breakpoint;if(!e.enabled||!i)return{icon:o.disabled,message:e.logMessage?a("disabledLogpoint","Disabled Logpoint"):a("disabledBreakpoint","Disabled Breakpoint")};const p=l=>"message"in e&&e.message?l.concat(", "+e.message):l;if(n&&e instanceof x&&e.pending)return{icon:S.breakpoint.pending};if(n&&!e.verified)return{icon:o.unverified,message:"message"in e&&e.message?e.message:e.logMessage?a("unverifiedLogpoint","Unverified Logpoint"):a("unverifiedBreakpoint","Unverified Breakpoint"),showAdapterUnverifiedMessage:!0};if(e instanceof O)return e.supported?{icon:o.regular,message:e.message||a("dataBreakpoint","Data Breakpoint")}:{icon:o.unverified,message:a("dataBreakpointUnsupported","Data breakpoints not supported by this debug type")};if(e instanceof E){if(!e.supported)return{icon:o.unverified,message:a("functionBreakpointUnsupported","Function breakpoints not supported by this debug type")};const l=[];return l.push(e.message||a("functionBreakpoint","Function Breakpoint")),e.condition&&l.push(a("expression","Condition: {0}",e.condition)),e.hitCondition&&l.push(a("hitCount","Hit Count: {0}",e.hitCondition)),{icon:o.regular,message:p(l.join(`
`))}}if(e instanceof M){if(!e.supported)return{icon:o.unverified,message:a("instructionBreakpointUnsupported","Instruction breakpoints not supported by this debug type")};const l=[];return e.message?l.push(e.message):e.instructionReference?l.push(a("instructionBreakpointAtAddress","Instruction breakpoint at address {0}",e.instructionReference)):l.push(a("instructionBreakpoint","Instruction breakpoint")),e.hitCondition&&l.push(a("hitCount","Hit Count: {0}",e.hitCondition)),{icon:o.regular,message:p(l.join(`
`))}}let d;if(e instanceof x&&e.triggeredBy&&(d=s.getBreakpoints().find(l=>l.getId()===e.triggeredBy)),e.logMessage||e.condition||e.hitCondition||d){const l=[];let f=e.logMessage?S.logBreakpoint.regular:S.conditionalBreakpoint.regular;return e.supported||(f=S.debugBreakpointUnsupported,l.push(a("breakpointUnsupported","Breakpoints of this type are not supported by the debugger"))),e.logMessage&&l.push(a("logMessage","Log Message: {0}",e.logMessage)),e.condition&&l.push(a("expression","Condition: {0}",e.condition)),e.hitCondition&&l.push(a("hitCount","Hit Count: {0}",e.hitCondition)),d&&l.push(a("triggeredBy","Hit after breakpoint: {0}",`${t.getUriLabel(d.uri,{relative:!0})}: ${d.lineNumber}`)),{icon:f,message:p(l.join(`
`))}}const g="message"in e&&e.message?e.message:e instanceof x&&t?t.getUriLabel(e.uri):a("breakpoint","Breakpoint");return{icon:o.regular,message:g}}k(class extends w{constructor(){super({id:"workbench.debug.viewlet.action.addFunctionBreakpointAction",title:{...C("addFunctionBreakpoint","Add Function Breakpoint"),mnemonicTitle:a({key:"miFunctionBreakpoint",comment:["&& denotes a mnemonic"]},"&&Function Breakpoint...")},f1:!0,icon:S.watchExpressionsAddFuncBreakpoint,menu:[{id:b.ViewTitle,group:"navigation",order:10,when:B.equals("view",T)},{id:b.MenubarNewBreakpointMenu,group:"1_breakpoints",order:3,when:U}]})}async run(c){const i=c.get(h);await c.get(ot).openView(T),i.addFunctionBreakpoint()}});class fe extends w{async run(i,e){const t=i.get(h),s=t.getViewModel().focusedSession;if(!s)return;let n;e&&e.src.type===J.Address&&(n=`${e.src.address} + ${e.src.bytes}`);const o=i.get(be),p=i.get(nt),d=await this.getRange(o,n);if(!d)return;let g;try{g=await s.dataBytesBreakpointInfo(d.address,d.bytes)}catch(D){p.error(a("dataBreakpointError","Failed to set data breakpoint at {0}: {1}",d.address,D.message))}if(!g?.dataId)return;let l="write";if(g.accessTypes&&g.accessTypes?.length>1){const D=g.accessTypes.map(oe=>({label:oe})),j=await o.pick(D,{placeHolder:a("dataBreakpointAccessType","Select the access type to monitor")});if(!j)return;l=j.label}const f={type:J.Address,...d};e&&await t.removeDataBreakpoints(e.getId()),await t.addDataBreakpoint({description:g.description,src:f,canPersist:!0,accessTypes:g.accessTypes,accessType:l,initialSessionData:{session:s,dataId:g.dataId}})}getRange(i,e){return new Promise(t=>{const s=new Ae,n=s.add(i.createInputBox());n.prompt=a("dataBreakpointMemoryRangePrompt","Enter a memory range in which to break"),n.placeholder=a("dataBreakpointMemoryRangePlaceholder","Absolute range (0x1234 - 0x1300) or range of bytes after an address (0x1234 + 0xff)"),e&&(n.value=e,n.valueSelection=[0,e.length]),s.add(n.onDidChangeValue(o=>{const p=this.parseAddress(o,!1);n.validationMessage=p?.error})),s.add(n.onDidAccept(()=>{const o=this.parseAddress(n.value,!0);"error"in o?n.validationMessage=o.error:t(o),n.dispose()})),s.add(n.onDidHide(()=>{t(void 0),s.dispose()})),n.ignoreFocusOut=!0,n.show()})}parseAddress(i,e){const t=/^(\S+)\s*(?:([+-])\s*(\S+))?/.exec(i);if(!t)return{error:a("dataBreakpointAddrFormat",'Address should be a range of numbers the form "[Start] - [End]" or "[Start] + [Bytes]"')};const s=f=>e?/^0x[0-9a-f]*|[0-9]*$/i.test(f):/^0x[0-9a-f]+|[0-9]+$/i.test(f),[,n,o="+",p="1"]=t;for(const f of[n,p])if(!s(f))return{error:a("dataBreakpointAddrStartEnd",'Number must be a decimal integer or hex value starting with "0x", got {0}',f)};if(!e)return;const d=BigInt(n),g=BigInt(p),l=`0x${d.toString(16)}`;return o==="-"?{address:l,bytes:Number(d-g)}:{address:l,bytes:Number(g)}}}k(class extends fe{constructor(){super({id:"workbench.debug.viewlet.action.addDataBreakpointOnAddress",title:{...C("addDataBreakpointOnAddress","Add Data Breakpoint at Address"),mnemonicTitle:a({key:"miDataBreakpoint",comment:["&& denotes a mnemonic"]},"&&Data Breakpoint...")},f1:!0,icon:S.watchExpressionsAddDataBreakpoint,menu:[{id:b.ViewTitle,group:"navigation",order:11,when:B.and(pe,B.equals("view",T))},{id:b.MenubarNewBreakpointMenu,group:"1_breakpoints",order:4,when:pe}]})}}),k(class extends fe{constructor(){super({id:"workbench.debug.viewlet.action.editDataBreakpointOnAddress",title:C("editDataBreakpointOnAddress","Edit Address..."),menu:[{id:b.DebugBreakpointsContext,when:B.and(pe,ve),group:"navigation",order:15}]})}}),k(class extends w{constructor(){super({id:"workbench.debug.viewlet.action.toggleBreakpointsActivatedAction",title:C("activateBreakpoints","Toggle Activate Breakpoints"),f1:!0,icon:S.breakpointsActivate,menu:{id:b.ViewTitle,group:"navigation",order:20,when:B.equals("view",T)}})}run(c){const i=c.get(h);i.setBreakpointsActivated(!i.getModel().areBreakpointsActivated())}}),k(class extends w{constructor(){super({id:"workbench.debug.viewlet.action.removeBreakpoint",title:a("removeBreakpoint","Remove Breakpoint"),icon:ue.removeClose,menu:[{id:b.DebugBreakpointsContext,group:"3_modification",order:10,when:v.notEqualsTo("exceptionBreakpoint")},{id:b.DebugBreakpointsContext,group:"inline",order:20,when:v.notEqualsTo("exceptionBreakpoint")}]})}async run(c,i){const e=c.get(h);i instanceof x?await e.removeBreakpoints(i.getId()):i instanceof E?await e.removeFunctionBreakpoints(i.getId()):i instanceof O?await e.removeDataBreakpoints(i.getId()):i instanceof M&&await e.removeInstructionBreakpoints(i.instructionReference,i.offset)}}),k(class extends w{constructor(){super({id:"workbench.debug.viewlet.action.removeAllBreakpoints",title:{...C("removeAllBreakpoints","Remove All Breakpoints"),mnemonicTitle:a({key:"miRemoveAllBreakpoints",comment:["&& denotes a mnemonic"]},"Remove &&All Breakpoints")},f1:!0,icon:S.breakpointsRemoveAll,menu:[{id:b.ViewTitle,group:"navigation",order:30,when:B.equals("view",T)},{id:b.DebugBreakpointsContext,group:"3_modification",order:20,when:B.and(Q,v.notEqualsTo("exceptionBreakpoint"))},{id:b.MenubarDebugMenu,group:"5_breakpoints",order:3,when:U}]})}run(c){const i=c.get(h);i.removeBreakpoints(),i.removeFunctionBreakpoints(),i.removeDataBreakpoints(),i.removeInstructionBreakpoints()}}),k(class extends w{constructor(){super({id:"workbench.debug.viewlet.action.enableAllBreakpoints",title:{...C("enableAllBreakpoints","Enable All Breakpoints"),mnemonicTitle:a({key:"miEnableAllBreakpoints",comment:["&& denotes a mnemonic"]},"&&Enable All Breakpoints")},f1:!0,precondition:U,menu:[{id:b.DebugBreakpointsContext,group:"z_commands",order:10,when:B.and(Q,v.notEqualsTo("exceptionBreakpoint"))},{id:b.MenubarDebugMenu,group:"5_breakpoints",order:1,when:U}]})}async run(c){await c.get(h).enableOrDisableBreakpoints(!0)}}),k(class extends w{constructor(){super({id:"workbench.debug.viewlet.action.disableAllBreakpoints",title:{...C("disableAllBreakpoints","Disable All Breakpoints"),mnemonicTitle:a({key:"miDisableAllBreakpoints",comment:["&& denotes a mnemonic"]},"Disable A&&ll Breakpoints")},f1:!0,precondition:U,menu:[{id:b.DebugBreakpointsContext,group:"z_commands",order:20,when:B.and(Q,v.notEqualsTo("exceptionBreakpoint"))},{id:b.MenubarDebugMenu,group:"5_breakpoints",order:2,when:U}]})}async run(c){await c.get(h).enableOrDisableBreakpoints(!1)}}),k(class extends w{constructor(){super({id:"workbench.debug.viewlet.action.reapplyBreakpointsAction",title:C("reapplyAllBreakpoints","Reapply All Breakpoints"),f1:!0,precondition:Qe,menu:[{id:b.DebugBreakpointsContext,group:"z_commands",order:30,when:B.and(Q,v.notEqualsTo("exceptionBreakpoint"))}]})}async run(c){await c.get(h).setBreakpointsActivated(!0)}}),k(class extends Y{constructor(){super({id:"debug.editBreakpoint",viewId:T,title:a("editCondition","Edit Condition..."),icon:ue.edit,precondition:ae,menu:[{id:b.DebugBreakpointsContext,when:v.notEqualsTo("functionBreakpoint"),group:"navigation",order:10},{id:b.DebugBreakpointsContext,group:"inline",order:10}]})}async runInView(c,i,e){const t=c.get(h),s=c.get(Ie);if(e instanceof x){const n=await Be(e,!1,!1,!0,t,s);if(n){const o=n.getControl();Le(o)&&o.getContribution(je)?.showBreakpointWidget(e.lineNumber,e.column)}}else if(e instanceof E){const n=c.get(me),o=[new de("breakpoint.editCondition",a("editCondition","Edit Condition..."),void 0,!0,async()=>i.renderInputBox({breakpoint:e,type:"condition"})),new de("breakpoint.editCondition",a("editHitCount","Edit Hit Count..."),void 0,!0,async()=>i.renderInputBox({breakpoint:e,type:"hitCount"}))],p=z.get(e.getId());p&&n.showContextMenu({getActions:()=>o,getAnchor:()=>p,onHide:()=>y(o)})}else i.renderInputBox({breakpoint:e,type:"condition"})}}),k(class extends Y{constructor(){super({id:"debug.editFunctionBreakpoint",viewId:T,title:a("editBreakpoint","Edit Function Condition..."),menu:[{id:b.DebugBreakpointsContext,group:"navigation",order:10,when:v.isEqualTo("functionBreakpoint")}]})}runInView(c,i,e){i.renderInputBox({breakpoint:e,type:"name"})}}),k(class extends Y{constructor(){super({id:"debug.editFunctionBreakpointHitCount",viewId:T,title:a("editHitCount","Edit Hit Count..."),precondition:ae,menu:[{id:b.DebugBreakpointsContext,group:"navigation",order:20,when:B.or(v.isEqualTo("functionBreakpoint"),v.isEqualTo("dataBreakpoint"))}]})}runInView(c,i,e){i.renderInputBox({breakpoint:e,type:"hitCount"})}}),k(class extends Y{constructor(){super({id:"debug.editBreakpointMode",viewId:T,title:a("editMode","Edit Mode..."),menu:[{id:b.DebugBreakpointsContext,group:"navigation",order:20,when:B.and(he,B.or(v.isEqualTo("breakpoint"),v.isEqualTo("exceptionBreakpoint"),v.isEqualTo("instructionBreakpoint")))}]})}async runInView(c,i,e){const t=e instanceof x?"source":e instanceof M?"instruction":"exception",s=c.get(h),n=s.getModel().getBreakpointModes(t),o=await c.get(be).pick(n.map(p=>({label:p.label,description:p.description,mode:p.mode})),{placeHolder:a("selectBreakpointMode","Select Breakpoint Mode")});if(o)if(t==="source"){const p=new Map;p.set(e.getId(),{mode:o.mode,modeLabel:o.label}),s.updateBreakpoints(e.originalUri,p,!1)}else e instanceof M?(s.removeInstructionBreakpoints(e.instructionReference,e.offset),s.addInstructionBreakpoint({...e.toJSON(),mode:o.mode,modeLabel:o.label})):e instanceof W&&(e.mode=o.mode,e.modeLabel=o.label,s.setExceptionBreakpointCondition(e,e.condition))}});export{Z as BreakpointsView,_ as getBreakpointMessageAndIcon,ke as getExpandedBodySize,Be as openBreakpointSource};
