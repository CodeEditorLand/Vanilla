{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/debug/browser/exceptionWidget.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport \"./media/exceptionWidget.css\";\nimport * as dom from \"../../../../base/browser/dom.js\";\nimport { ActionBar } from \"../../../../base/browser/ui/actionbar/actionbar.js\";\nimport { Action } from \"../../../../base/common/actions.js\";\nimport { RunOnceScheduler } from \"../../../../base/common/async.js\";\nimport type { Color } from \"../../../../base/common/color.js\";\nimport { ThemeIcon } from \"../../../../base/common/themables.js\";\nimport type { ICodeEditor } from \"../../../../editor/browser/editorBrowser.js\";\nimport { EditorOption } from \"../../../../editor/common/config/editorOptions.js\";\nimport { ZoneWidget } from \"../../../../editor/contrib/zoneWidget/browser/zoneWidget.js\";\nimport * as nls from \"../../../../nls.js\";\nimport { IInstantiationService } from \"../../../../platform/instantiation/common/instantiation.js\";\nimport { registerColor } from \"../../../../platform/theme/common/colorRegistry.js\";\nimport { widgetClose } from \"../../../../platform/theme/common/iconRegistry.js\";\nimport {\n\ttype IColorTheme,\n\tIThemeService,\n} from \"../../../../platform/theme/common/themeService.js\";\nimport {\n\tEDITOR_CONTRIBUTION_ID,\n\ttype IDebugEditorContribution,\n\ttype IDebugSession,\n\ttype IExceptionInfo,\n} from \"../common/debug.js\";\nimport { DebugLinkHoverBehavior, LinkDetector } from \"./linkDetector.js\";\nconst $ = dom.$;\n\n// theming\n\nconst debugExceptionWidgetBorder = registerColor(\n\t\"debugExceptionWidget.border\",\n\t\"#a31515\",\n\tnls.localize(\n\t\t\"debugExceptionWidgetBorder\",\n\t\t\"Exception widget border color.\",\n\t),\n);\nconst debugExceptionWidgetBackground = registerColor(\n\t\"debugExceptionWidget.background\",\n\t{\n\t\tdark: \"#420b0d\",\n\t\tlight: \"#f1dfde\",\n\t\thcDark: \"#420b0d\",\n\t\thcLight: \"#f1dfde\",\n\t},\n\tnls.localize(\n\t\t\"debugExceptionWidgetBackground\",\n\t\t\"Exception widget background color.\",\n\t),\n);\n\nexport class ExceptionWidget extends ZoneWidget {\n\tprivate backgroundColor: Color | undefined;\n\n\tconstructor(\n\t\teditor: ICodeEditor,\n\t\tprivate exceptionInfo: IExceptionInfo,\n\t\tprivate debugSession: IDebugSession | undefined,\n\t\t@IThemeService themeService: IThemeService,\n\t\t@IInstantiationService\n\t\tprivate readonly instantiationService: IInstantiationService,\n\t) {\n\t\tsuper(editor, {\n\t\t\tshowFrame: true,\n\t\t\tshowArrow: true,\n\t\t\tisAccessible: true,\n\t\t\tframeWidth: 1,\n\t\t\tclassName: \"exception-widget-container\",\n\t\t});\n\n\t\tthis.applyTheme(themeService.getColorTheme());\n\t\tthis._disposables.add(\n\t\t\tthemeService.onDidColorThemeChange(this.applyTheme.bind(this)),\n\t\t);\n\n\t\tthis.create();\n\t\tconst onDidLayoutChangeScheduler = new RunOnceScheduler(\n\t\t\t() => this._doLayout(undefined, undefined),\n\t\t\t50,\n\t\t);\n\t\tthis._disposables.add(\n\t\t\tthis.editor.onDidLayoutChange(() =>\n\t\t\t\tonDidLayoutChangeScheduler.schedule(),\n\t\t\t),\n\t\t);\n\t\tthis._disposables.add(onDidLayoutChangeScheduler);\n\t}\n\n\tprivate applyTheme(theme: IColorTheme): void {\n\t\tthis.backgroundColor = theme.getColor(debugExceptionWidgetBackground);\n\t\tconst frameColor = theme.getColor(debugExceptionWidgetBorder);\n\t\tthis.style({\n\t\t\tarrowColor: frameColor,\n\t\t\tframeColor: frameColor,\n\t\t}); // style() will trigger _applyStyles\n\t}\n\n\tprotected override _applyStyles(): void {\n\t\tif (this.container) {\n\t\t\tthis.container.style.backgroundColor = this.backgroundColor\n\t\t\t\t? this.backgroundColor.toString()\n\t\t\t\t: \"\";\n\t\t}\n\t\tsuper._applyStyles();\n\t}\n\n\tprotected _fillContainer(container: HTMLElement): void {\n\t\tthis.setCssClass(\"exception-widget\");\n\t\t// Set the font size and line height to the one from the editor configuration.\n\t\tconst fontInfo = this.editor.getOption(EditorOption.fontInfo);\n\t\tcontainer.style.fontSize = `${fontInfo.fontSize}px`;\n\t\tcontainer.style.lineHeight = `${fontInfo.lineHeight}px`;\n\t\tcontainer.tabIndex = 0;\n\t\tconst title = $(\".title\");\n\t\tconst label = $(\".label\");\n\t\tdom.append(title, label);\n\t\tconst actions = $(\".actions\");\n\t\tdom.append(title, actions);\n\t\tlabel.textContent = this.exceptionInfo.id\n\t\t\t? nls.localize(\n\t\t\t\t\t\"exceptionThrownWithId\",\n\t\t\t\t\t\"Exception has occurred: {0}\",\n\t\t\t\t\tthis.exceptionInfo.id,\n\t\t\t\t)\n\t\t\t: nls.localize(\"exceptionThrown\", \"Exception has occurred.\");\n\t\tlet ariaLabel = label.textContent;\n\n\t\tconst actionBar = new ActionBar(actions);\n\t\tactionBar.push(\n\t\t\tnew Action(\n\t\t\t\t\"editor.closeExceptionWidget\",\n\t\t\t\tnls.localize(\"close\", \"Close\"),\n\t\t\t\tThemeIcon.asClassName(widgetClose),\n\t\t\t\ttrue,\n\t\t\t\tasync () => {\n\t\t\t\t\tconst contribution =\n\t\t\t\t\t\tthis.editor.getContribution<IDebugEditorContribution>(\n\t\t\t\t\t\t\tEDITOR_CONTRIBUTION_ID,\n\t\t\t\t\t\t);\n\t\t\t\t\tcontribution?.closeExceptionWidget();\n\t\t\t\t},\n\t\t\t),\n\t\t\t{ label: false, icon: true },\n\t\t);\n\n\t\tdom.append(container, title);\n\n\t\tif (this.exceptionInfo.description) {\n\t\t\tconst description = $(\".description\");\n\t\t\tdescription.textContent = this.exceptionInfo.description;\n\t\t\tariaLabel += \", \" + this.exceptionInfo.description;\n\t\t\tdom.append(container, description);\n\t\t}\n\n\t\tif (\n\t\t\tthis.exceptionInfo.details &&\n\t\t\tthis.exceptionInfo.details.stackTrace\n\t\t) {\n\t\t\tconst stackTrace = $(\".stack-trace\");\n\t\t\tconst linkDetector =\n\t\t\t\tthis.instantiationService.createInstance(LinkDetector);\n\t\t\tconst linkedStackTrace = linkDetector.linkify(\n\t\t\t\tthis.exceptionInfo.details.stackTrace,\n\t\t\t\ttrue,\n\t\t\t\tthis.debugSession ? this.debugSession.root : undefined,\n\t\t\t\tundefined,\n\t\t\t\t{ type: DebugLinkHoverBehavior.Rich, store: this._disposables },\n\t\t\t);\n\t\t\tstackTrace.appendChild(linkedStackTrace);\n\t\t\tdom.append(container, stackTrace);\n\t\t\tariaLabel += \", \" + this.exceptionInfo.details.stackTrace;\n\t\t}\n\t\tcontainer.setAttribute(\"aria-label\", ariaLabel);\n\t}\n\n\tprotected override _doLayout(\n\t\t_heightInPixel: number | undefined,\n\t\t_widthInPixel: number | undefined,\n\t): void {\n\t\t// Reload the height with respect to the exception text content and relayout it to match the line count.\n\t\tthis.container!.style.height = \"initial\";\n\n\t\tconst lineHeight = this.editor.getOption(EditorOption.lineHeight);\n\t\tconst arrowHeight = Math.round(lineHeight / 3);\n\t\tconst computedLinesNumber = Math.ceil(\n\t\t\t(this.container!.offsetHeight + arrowHeight) / lineHeight,\n\t\t);\n\n\t\tthis._relayout(computedLinesNumber);\n\t}\n\n\tfocus(): void {\n\t\t// Focus into the container for accessibility purposes so the exception and stack trace gets read\n\t\tthis.container?.focus();\n\t}\n\n\toverride hasFocus(): boolean {\n\t\tif (!this.container) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn dom.isAncestorOfActiveElement(this.container);\n\t}\n}\n"],
  "mappings": "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",
  "names": []
}
