{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/debug/browser/exceptionWidget.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport './media/exceptionWidget.css';\nimport * as nls from '../../../../nls.js';\nimport * as dom from '../../../../base/browser/dom.js';\nimport { ZoneWidget } from '../../../../editor/contrib/zoneWidget/browser/zoneWidget.js';\nimport { ICodeEditor } from '../../../../editor/browser/editorBrowser.js';\nimport { IExceptionInfo, IDebugSession, IDebugEditorContribution, EDITOR_CONTRIBUTION_ID } from '../common/debug.js';\nimport { RunOnceScheduler } from '../../../../base/common/async.js';\nimport { IThemeService, IColorTheme } from '../../../../platform/theme/common/themeService.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport { Color } from '../../../../base/common/color.js';\nimport { registerColor } from '../../../../platform/theme/common/colorRegistry.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { DebugLinkHoverBehavior, LinkDetector } from './linkDetector.js';\nimport { EditorOption } from '../../../../editor/common/config/editorOptions.js';\nimport { ActionBar } from '../../../../base/browser/ui/actionbar/actionbar.js';\nimport { Action } from '../../../../base/common/actions.js';\nimport { widgetClose } from '../../../../platform/theme/common/iconRegistry.js';\nconst $ = dom.$;\n\n// theming\n\nconst debugExceptionWidgetBorder = registerColor('debugExceptionWidget.border', '#a31515', nls.localize('debugExceptionWidgetBorder', 'Exception widget border color.'));\nconst debugExceptionWidgetBackground = registerColor('debugExceptionWidget.background', { dark: '#420b0d', light: '#f1dfde', hcDark: '#420b0d', hcLight: '#f1dfde' }, nls.localize('debugExceptionWidgetBackground', 'Exception widget background color.'));\n\nexport class ExceptionWidget extends ZoneWidget {\n\n\tprivate backgroundColor: Color | undefined;\n\n\tconstructor(\n\t\teditor: ICodeEditor,\n\t\tprivate exceptionInfo: IExceptionInfo,\n\t\tprivate debugSession: IDebugSession | undefined,\n\t\t@IThemeService themeService: IThemeService,\n\t\t@IInstantiationService private readonly instantiationService: IInstantiationService\n\t) {\n\t\tsuper(editor, { showFrame: true, showArrow: true, isAccessible: true, frameWidth: 1, className: 'exception-widget-container' });\n\n\t\tthis.applyTheme(themeService.getColorTheme());\n\t\tthis._disposables.add(themeService.onDidColorThemeChange(this.applyTheme.bind(this)));\n\n\t\tthis.create();\n\t\tconst onDidLayoutChangeScheduler = new RunOnceScheduler(() => this._doLayout(undefined, undefined), 50);\n\t\tthis._disposables.add(this.editor.onDidLayoutChange(() => onDidLayoutChangeScheduler.schedule()));\n\t\tthis._disposables.add(onDidLayoutChangeScheduler);\n\t}\n\n\tprivate applyTheme(theme: IColorTheme): void {\n\t\tthis.backgroundColor = theme.getColor(debugExceptionWidgetBackground);\n\t\tconst frameColor = theme.getColor(debugExceptionWidgetBorder);\n\t\tthis.style({\n\t\t\tarrowColor: frameColor,\n\t\t\tframeColor: frameColor\n\t\t}); // style() will trigger _applyStyles\n\t}\n\n\tprotected override _applyStyles(): void {\n\t\tif (this.container) {\n\t\t\tthis.container.style.backgroundColor = this.backgroundColor ? this.backgroundColor.toString() : '';\n\t\t}\n\t\tsuper._applyStyles();\n\t}\n\n\tprotected _fillContainer(container: HTMLElement): void {\n\t\tthis.setCssClass('exception-widget');\n\t\t// Set the font size and line height to the one from the editor configuration.\n\t\tconst fontInfo = this.editor.getOption(EditorOption.fontInfo);\n\t\tcontainer.style.fontSize = `${fontInfo.fontSize}px`;\n\t\tcontainer.style.lineHeight = `${fontInfo.lineHeight}px`;\n\t\tcontainer.tabIndex = 0;\n\t\tconst title = $('.title');\n\t\tconst label = $('.label');\n\t\tdom.append(title, label);\n\t\tconst actions = $('.actions');\n\t\tdom.append(title, actions);\n\t\tlabel.textContent = this.exceptionInfo.id ? nls.localize('exceptionThrownWithId', 'Exception has occurred: {0}', this.exceptionInfo.id) : nls.localize('exceptionThrown', 'Exception has occurred.');\n\t\tlet ariaLabel = label.textContent;\n\n\t\tconst actionBar = new ActionBar(actions);\n\t\tactionBar.push(new Action('editor.closeExceptionWidget', nls.localize('close', \"Close\"), ThemeIcon.asClassName(widgetClose), true, async () => {\n\t\t\tconst contribution = this.editor.getContribution<IDebugEditorContribution>(EDITOR_CONTRIBUTION_ID);\n\t\t\tcontribution?.closeExceptionWidget();\n\t\t}), { label: false, icon: true });\n\n\t\tdom.append(container, title);\n\n\t\tif (this.exceptionInfo.description) {\n\t\t\tconst description = $('.description');\n\t\t\tdescription.textContent = this.exceptionInfo.description;\n\t\t\tariaLabel += ', ' + this.exceptionInfo.description;\n\t\t\tdom.append(container, description);\n\t\t}\n\n\t\tif (this.exceptionInfo.details && this.exceptionInfo.details.stackTrace) {\n\t\t\tconst stackTrace = $('.stack-trace');\n\t\t\tconst linkDetector = this.instantiationService.createInstance(LinkDetector);\n\t\t\tconst linkedStackTrace = linkDetector.linkify(this.exceptionInfo.details.stackTrace, true, this.debugSession ? this.debugSession.root : undefined, undefined, { type: DebugLinkHoverBehavior.Rich, store: this._disposables });\n\t\t\tstackTrace.appendChild(linkedStackTrace);\n\t\t\tdom.append(container, stackTrace);\n\t\t\tariaLabel += ', ' + this.exceptionInfo.details.stackTrace;\n\t\t}\n\t\tcontainer.setAttribute('aria-label', ariaLabel);\n\t}\n\n\tprotected override _doLayout(_heightInPixel: number | undefined, _widthInPixel: number | undefined): void {\n\t\t// Reload the height with respect to the exception text content and relayout it to match the line count.\n\t\tthis.container!.style.height = 'initial';\n\n\t\tconst lineHeight = this.editor.getOption(EditorOption.lineHeight);\n\t\tconst arrowHeight = Math.round(lineHeight / 3);\n\t\tconst computedLinesNumber = Math.ceil((this.container!.offsetHeight + arrowHeight) / lineHeight);\n\n\t\tthis._relayout(computedLinesNumber);\n\t}\n\n\tfocus(): void {\n\t\t// Focus into the container for accessibility purposes so the exception and stack trace gets read\n\t\tthis.container?.focus();\n\t}\n\n\toverride hasFocus(): boolean {\n\t\tif (!this.container) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn dom.isAncestorOfActiveElement(this.container);\n\t}\n}\n"],
  "mappings": "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",
  "names": []
}
