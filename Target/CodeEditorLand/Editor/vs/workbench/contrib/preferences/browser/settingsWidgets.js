var U=Object.defineProperty;var $=Object.getOwnPropertyDescriptor;var S=(h,d,e,t)=>{for(var s=t>1?void 0:t?$(d,e):d,i=h.length-1,n;i>=0;i--)(n=h[i])&&(s=(t?n(d,e,s):n(s))||s);return t&&s&&U(d,e,s),s},b=(h,d)=>(e,t)=>d(e,t,h);import{BrowserFeatures as Y}from"../../../../base/browser/canIUse.js";import*as a from"../../../../base/browser/dom.js";import{ActionBar as J}from"../../../../base/browser/ui/actionbar/actionbar.js";import{Button as w}from"../../../../base/browser/ui/button/button.js";import{InputBox as f}from"../../../../base/browser/ui/inputbox/inputBox.js";import{SelectBox as Q}from"../../../../base/browser/ui/selectBox/selectBox.js";import{Toggle as X,unthemedToggleStyles as Z}from"../../../../base/browser/ui/toggle/toggle.js";import{disposableTimeout as M}from"../../../../base/common/async.js";import{Codicon as ee}from"../../../../base/common/codicons.js";import{Emitter as te}from"../../../../base/common/event.js";import{KeyCode as T}from"../../../../base/common/keyCodes.js";import{Disposable as ie,DisposableStore as se}from"../../../../base/common/lifecycle.js";import{isIOS as ne}from"../../../../base/common/platform.js";import{isDefined as R,isUndefinedOrNull as B}from"../../../../base/common/types.js";import"./media/settingsWidgets.css";import{getDefaultHoverDelegate as x}from"../../../../base/browser/ui/hover/hoverDelegateFactory.js";import{MarkdownString as V}from"../../../../base/common/htmlContent.js";import{ThemeIcon as j}from"../../../../base/common/themables.js";import{localize as o}from"../../../../nls.js";import{IContextViewService as O}from"../../../../platform/contextview/browser/contextView.js";import{IHoverService as _}from"../../../../platform/hover/browser/hover.js";import{defaultButtonStyles as k,getInputBoxStyle as P,getSelectBoxStyles as ae}from"../../../../platform/theme/browser/defaultStyles.js";import{IThemeService as A}from"../../../../platform/theme/common/themeService.js";import{settingsSelectBackground as oe,settingsSelectBorder as re,settingsSelectForeground as de,settingsSelectListBorder as le,settingsTextInputBackground as N,settingsTextInputBorder as W,settingsTextInputForeground as G}from"../common/settingsEditorColorRegistry.js";import{settingsDiscardIcon as ce,settingsEditIcon as F,settingsRemoveIcon as q}from"./preferencesIcons.js";const l=a.$;class ue{_dataItems=[];_editKey=null;_selectedIdx=null;_newDataItem;get items(){const d=this._dataItems.map((e,t)=>{const s=typeof this._editKey=="number"&&this._editKey===t;return{...e,editing:s,selected:t===this._selectedIdx||s}});return this._editKey==="create"&&d.push({editing:!0,selected:!0,...this._newDataItem}),d}constructor(d){this._newDataItem=d}setEditKey(d){this._editKey=d}setValue(d){this._dataItems=d}select(d){this._selectedIdx=d}getSelected(){return this._selectedIdx}selectNext(){typeof this._selectedIdx=="number"?this._selectedIdx=Math.min(this._selectedIdx+1,this._dataItems.length-1):this._selectedIdx=0}selectPrevious(){typeof this._selectedIdx=="number"?this._selectedIdx=Math.max(this._selectedIdx-1,0):this._selectedIdx=0}}let E=class extends ie{constructor(e,t,s){super();this.container=e;this.themeService=t;this.contextViewService=s;this.listElement=a.append(e,l("div")),this.listElement.setAttribute("role","list"),this.getContainerClasses().forEach(i=>this.listElement.classList.add(i)),a.append(e,this.renderAddButton()),this.renderList(),this._register(a.addDisposableListener(this.listElement,a.EventType.POINTER_DOWN,i=>this.onListClick(i))),this._register(a.addDisposableListener(this.listElement,a.EventType.DBLCLICK,i=>this.onListDoubleClick(i))),this._register(a.addStandardDisposableListener(this.listElement,"keydown",i=>{if(i.equals(T.UpArrow))this.selectPreviousRow();else if(i.equals(T.DownArrow))this.selectNextRow();else return;i.preventDefault(),i.stopPropagation()}))}listElement;rowElements=[];_onDidChangeList=this._register(new te);model=new ue(this.getEmptyItem());listDisposables=this._register(new se);onDidChangeList=this._onDidChangeList.event;get domNode(){return this.listElement}get items(){return this.model.items}get inReadMode(){return this.model.items.every(e=>!e.editing)}setValue(e){this.model.setValue(e),this.renderList()}renderHeader(){}isAddButtonVisible(){return!0}renderList(){const e=a.isAncestorOfActiveElement(this.listElement);a.clearNode(this.listElement),this.listDisposables.clear();const t=this.model.items.some(i=>!!(i.editing&&this.isItemNew(i)));this.container.classList.toggle("setting-list-hide-add-button",!this.isAddButtonVisible()||t),this.model.items.length?this.listElement.tabIndex=0:this.listElement.removeAttribute("tabIndex");const s=this.renderHeader();s&&this.listElement.appendChild(s),this.rowElements=this.model.items.map((i,n)=>this.renderDataOrEditItem(i,n,e)),this.rowElements.forEach(i=>this.listElement.appendChild(i))}createBasicSelectBox(e){const t=e.options.map(({value:r,description:c})=>({text:r,description:c})),s=e.options.findIndex(r=>e.data===r.value),i=ae({selectBackground:oe,selectForeground:de,selectBorder:re,selectListBorder:le});return new Q(t,s,this.contextViewService,i,{useCustomDrawn:!(ne&&Y.pointerEvents)})}editSetting(e){this.model.setEditKey(e),this.renderList()}cancelEdit(){this.model.setEditKey("none"),this.renderList()}handleItemChange(e,t,s){this.model.setEditKey("none"),this.isItemNew(e)?this._onDidChangeList.fire({type:"add",newItem:t,targetIndex:s}):this._onDidChangeList.fire({type:"change",originalItem:e,newItem:t,targetIndex:s}),this.renderList()}renderDataOrEditItem(e,t,s){const i=e.editing?this.renderEdit(e,t):this.renderDataItem(e,t,s);return i.setAttribute("role","listitem"),i}renderDataItem(e,t,s){const i=this.renderItem(e,t),n=i.rowElement;n.setAttribute("data-index",t+""),n.setAttribute("tabindex",e.selected?"0":"-1"),n.classList.toggle("selected",e.selected);const r=new J(n);return this.listDisposables.add(r),r.push(this.getActionsForItem(e,t),{icon:!0,label:!0}),this.addTooltipsToRow(i,e),e.selected&&s&&M(()=>n.focus(),void 0,this.listDisposables),this.listDisposables.add(a.addDisposableListener(n,"click",c=>{c.stopPropagation()})),n}renderAddButton(){const e=l(".setting-list-new-row"),t=this._register(new w(e,k));return t.label=this.getLocalizedStrings().addButtonLabel,t.element.classList.add("setting-list-addButton"),this._register(t.onDidClick(()=>{this.model.setEditKey("create"),this.renderList()})),e}onListClick(e){const t=this.getClickedItemIndex(e);t<0||(e.preventDefault(),e.stopImmediatePropagation(),this.model.getSelected()!==t&&this.selectRow(t))}onListDoubleClick(e){const t=this.getClickedItemIndex(e);if(t<0)return;this.model.items[t]&&(this.editSetting(t),e.preventDefault(),e.stopPropagation())}getClickedItemIndex(e){if(!e.target||a.findParentWithClass(e.target,"monaco-action-bar"))return-1;const s=a.findParentWithClass(e.target,"setting-list-row");if(!s)return-1;const i=s.getAttribute("data-index");return i?Number.parseInt(i):-1}selectRow(e){this.model.select(e),this.rowElements.forEach(s=>s.classList.remove("selected"));const t=this.rowElements[this.model.getSelected()];t.classList.add("selected"),t.focus()}selectNextRow(){this.model.selectNext(),this.selectRow(this.model.getSelected())}selectPreviousRow(){this.model.selectPrevious(),this.selectRow(this.model.getSelected())}};E=S([b(1,A),b(2,O)],E);let L=class extends E{constructor(e,t,s,i){super(e,t,s);this.hoverService=i}keyValueSuggester;showAddButton=!0;setValue(e,t){this.keyValueSuggester=t?.keySuggester,this.showAddButton=t?.showAddButton??!0,super.setValue(e)}getEmptyItem(){return{value:{type:"string",data:""}}}isAddButtonVisible(){return this.showAddButton}getContainerClasses(){return["setting-list-widget"]}getActionsForItem(e,t){return[{class:j.asClassName(F),enabled:!0,id:"workbench.action.editListItem",tooltip:this.getLocalizedStrings().editActionTooltip,run:()=>this.editSetting(t)},{class:j.asClassName(q),enabled:!0,id:"workbench.action.removeListItem",tooltip:this.getLocalizedStrings().deleteActionTooltip,run:()=>this._onDidChangeList.fire({type:"remove",originalItem:e,targetIndex:t})}]}dragDetails;getDragImage(e){const t=l(".monaco-drag-image");return t.textContent=e.value.data,t}renderItem(e,t){const s=l(".setting-list-row"),i=a.append(s,l(".setting-list-value")),n=a.append(s,l(".setting-list-sibling"));return i.textContent=e.value.data.toString(),n.textContent=e.sibling?`when: ${e.sibling}`:null,this.addDragAndDrop(s,e,t),{rowElement:s,keyElement:i,valueElement:n}}addDragAndDrop(e,t,s){this.inReadMode?(e.draggable=!0,e.classList.add("draggable")):(e.draggable=!1,e.classList.remove("draggable")),this.listDisposables.add(a.addDisposableListener(e,a.EventType.DRAG_START,n=>{if(this.dragDetails={element:e,item:t,itemIndex:s},n.dataTransfer){n.dataTransfer.dropEffect="move";const r=this.getDragImage(t);e.ownerDocument.body.appendChild(r),n.dataTransfer.setDragImage(r,-10,-10),setTimeout(()=>r.remove(),0)}})),this.listDisposables.add(a.addDisposableListener(e,a.EventType.DRAG_OVER,n=>this.dragDetails?(n.preventDefault(),n.dataTransfer&&(n.dataTransfer.dropEffect="move"),!0):!1));let i=0;this.listDisposables.add(a.addDisposableListener(e,a.EventType.DRAG_ENTER,n=>{i++,e.classList.add("drag-hover")})),this.listDisposables.add(a.addDisposableListener(e,a.EventType.DRAG_LEAVE,n=>{i--,i||e.classList.remove("drag-hover")})),this.listDisposables.add(a.addDisposableListener(e,a.EventType.DROP,n=>this.dragDetails?(n.preventDefault(),i=0,this.dragDetails.element!==e&&this._onDidChangeList.fire({type:"move",originalItem:this.dragDetails.item,sourceIndex:this.dragDetails.itemIndex,newItem:t,targetIndex:s}),!0):!1)),this.listDisposables.add(a.addDisposableListener(e,a.EventType.DRAG_END,n=>{i=0,e.classList.remove("drag-hover"),n.dataTransfer?.clearData(),this.dragDetails&&(this.dragDetails=void 0)}))}renderEdit(e,t){const s=l(".setting-list-edit-row");let i,n,r;if(this.keyValueSuggester){const g=this.keyValueSuggester(this.model.items.map(({value:{data:I}})=>I),t);e={...e,value:{type:"enum",data:e.value.data,options:g?g.options:[]}}}switch(e.value.type){case"string":i=this.renderInputBox(e.value,s);break;case"enum":i=this.renderDropdown(e.value,s),r=e.value.options,e.value.options.length&&(n=this.isItemNew(e)?r[0].value:e.value.data);break}const c=()=>({value:{type:"string",data:i.value},sibling:m?.value}),u=g=>({value:{type:"enum",data:g,options:r??[]}}),p=g=>{g.equals(T.Enter)?this.handleItemChange(e,c(),t):g.equals(T.Escape)&&(this.cancelEdit(),g.preventDefault()),s?.focus()};if(e.value.type!=="string"){const g=i;this.listDisposables.add(g.onDidSelect(({selected:I})=>{n=I}))}else{const g=i;this.listDisposables.add(a.addStandardDisposableListener(g.inputElement,a.EventType.KEY_DOWN,p))}let m;B(e.sibling)?i instanceof f&&i.element.classList.add("no-sibling"):(m=new f(s,this.contextViewService,{placeholder:this.getLocalizedStrings().siblingInputPlaceholder,inputBoxStyles:P({inputBackground:N,inputForeground:G,inputBorder:W})}),m.element.classList.add("setting-list-siblingInput"),this.listDisposables.add(m),m.value=e.sibling,this.listDisposables.add(a.addStandardDisposableListener(m.inputElement,a.EventType.KEY_DOWN,p)));const v=this.listDisposables.add(new w(s,k));v.label=o("okButton","OK"),v.element.classList.add("setting-list-ok-button"),this.listDisposables.add(v.onDidClick(()=>{e.value.type==="string"?this.handleItemChange(e,c(),t):this.handleItemChange(e,u(n),t)}));const D=this.listDisposables.add(new w(s,{secondary:!0,...k}));return D.label=o("cancelButton","Cancel"),D.element.classList.add("setting-list-cancel-button"),this.listDisposables.add(D.onDidClick(()=>this.cancelEdit())),this.listDisposables.add(M(()=>{i.focus(),i instanceof f&&i.select()})),s}isItemNew(e){return e.value.data===""}addTooltipsToRow(e,{value:t,sibling:s}){const i=B(s)?o("listValueHintLabel","List item `{0}`",t.data):o("listSiblingHintLabel","List item `{0}` with sibling `${1}`",t.data,s),{rowElement:n}=e;this.listDisposables.add(this.hoverService.setupManagedHover(x("mouse"),n,i)),n.setAttribute("aria-label",i)}getLocalizedStrings(){return{deleteActionTooltip:o("removeItem","Remove Item"),editActionTooltip:o("editItem","Edit Item"),addButtonLabel:o("addItem","Add Item"),inputPlaceholder:o("itemInputPlaceholder","Item..."),siblingInputPlaceholder:o("listSiblingInputPlaceholder","Sibling...")}}renderInputBox(e,t){const s=new f(t,this.contextViewService,{placeholder:this.getLocalizedStrings().inputPlaceholder,inputBoxStyles:P({inputBackground:N,inputForeground:G,inputBorder:W})});return s.element.classList.add("setting-list-valueInput"),this.listDisposables.add(s),s.value=e.data.toString(),s}renderDropdown(e,t){if(e.type!=="enum")throw new Error("Valuetype must be enum.");const s=this.createBasicSelectBox(e),i=l(".setting-list-object-list-row");return s.render(i),t.appendChild(i),s}};L=S([b(1,A),b(2,O),b(3,_)],L);class Re extends L{getContainerClasses(){return["setting-list-include-exclude-widget"]}addDragAndDrop(d,e,t){}addTooltipsToRow(d,e){let t=B(e.sibling)?o("excludePatternHintLabel","Exclude files matching `{0}`",e.value.data):o("excludeSiblingHintLabel","Exclude files matching `{0}`, only when a file matching `{1}` is present",e.value.data,e.sibling);e.source&&(t+=o("excludeIncludeSource",". Default value provided by `{0}`",e.source));const s=new V().appendMarkdown(t),{rowElement:i}=d;this.listDisposables.add(this.hoverService.setupManagedHover(x("mouse"),i,{markdown:s,markdownNotSupportedFallback:t})),i.setAttribute("aria-label",t)}getLocalizedStrings(){return{deleteActionTooltip:o("removeExcludeItem","Remove Exclude Item"),editActionTooltip:o("editExcludeItem","Edit Exclude Item"),addButtonLabel:o("addPattern","Add Pattern"),inputPlaceholder:o("excludePatternInputPlaceholder","Exclude Pattern..."),siblingInputPlaceholder:o("excludeSiblingInputPlaceholder","When Pattern Is Present...")}}}class Ve extends L{getContainerClasses(){return["setting-list-include-exclude-widget"]}addDragAndDrop(d,e,t){}addTooltipsToRow(d,e){let t=B(e.sibling)?o("includePatternHintLabel","Include files matching `{0}`",e.value.data):o("includeSiblingHintLabel","Include files matching `{0}`, only when a file matching `{1}` is present",e.value.data,e.sibling);e.source&&(t+=o("excludeIncludeSource",". Default value provided by `{0}`",e.source));const s=new V().appendMarkdown(t),{rowElement:i}=d;this.listDisposables.add(this.hoverService.setupManagedHover(x("mouse"),i,{markdown:s,markdownNotSupportedFallback:t})),i.setAttribute("aria-label",t)}getLocalizedStrings(){return{deleteActionTooltip:o("removeIncludeItem","Remove Include Item"),editActionTooltip:o("editIncludeItem","Edit Include Item"),addButtonLabel:o("addPattern","Add Pattern"),inputPlaceholder:o("includePatternInputPlaceholder","Include Pattern..."),siblingInputPlaceholder:o("includeSiblingInputPlaceholder","When Pattern Is Present...")}}}let C=class extends E{constructor(e,t,s,i){super(e,t,s);this.hoverService=i}currentSettingKey="";showAddButton=!0;keySuggester=()=>{};valueSuggester=()=>{};setValue(e,t){this.showAddButton=t?.showAddButton??this.showAddButton,this.keySuggester=t?.keySuggester??this.keySuggester,this.valueSuggester=t?.valueSuggester??this.valueSuggester,R(t)&&t.settingKey!==this.currentSettingKey&&(this.model.setEditKey("none"),this.model.select(null),this.currentSettingKey=t.settingKey),super.setValue(e)}isItemNew(e){return e.key.data===""&&e.value.data===""}isAddButtonVisible(){return this.showAddButton}getEmptyItem(){return{key:{type:"string",data:""},value:{type:"string",data:""},removable:!0,resetable:!1}}getContainerClasses(){return["setting-list-object-widget"]}getActionsForItem(e,t){const s=[{class:j.asClassName(F),enabled:!0,id:"workbench.action.editListItem",label:"",tooltip:this.getLocalizedStrings().editActionTooltip,run:()=>this.editSetting(t)}];return e.resetable&&s.push({class:j.asClassName(ce),enabled:!0,id:"workbench.action.resetListItem",label:"",tooltip:this.getLocalizedStrings().resetActionTooltip,run:()=>this._onDidChangeList.fire({type:"reset",originalItem:e,targetIndex:t})}),e.removable&&s.push({class:j.asClassName(q),enabled:!0,id:"workbench.action.removeListItem",label:"",tooltip:this.getLocalizedStrings().deleteActionTooltip,run:()=>this._onDidChangeList.fire({type:"remove",originalItem:e,targetIndex:t})}),s}renderHeader(){const e=l(".setting-list-row-header"),t=a.append(e,l(".setting-list-object-key")),s=a.append(e,l(".setting-list-object-value")),{keyHeaderText:i,valueHeaderText:n}=this.getLocalizedStrings();return t.textContent=i,s.textContent=n,e}renderItem(e,t){const s=l(".setting-list-row");s.classList.add("setting-list-object-row");const i=a.append(s,l(".setting-list-object-key")),n=a.append(s,l(".setting-list-object-value"));return i.textContent=e.key.data,n.textContent=e.value.data.toString(),{rowElement:s,keyElement:i,valueElement:n}}renderEdit(e,t){const s=l(".setting-list-edit-row.setting-list-object-row"),i={...e},n=I=>{i.key=I,D.enabled=I.data!=="";const y=this.valueSuggester(I.data)??e.value;this.shouldUseSuggestion(e.value,i.value,y)&&(r(y),v())},r=I=>{i.value=I};let c,u;if(this.showAddButton){if(this.isItemNew(e)){const z=this.keySuggester(this.model.items.map(({key:{data:K}})=>K));if(R(z)){i.key=z;const K=this.valueSuggester(i.key.data);r(K??i.value)}}const{widget:I,element:y}=this.renderEditWidget(i.key,{idx:t,isKey:!0,originalItem:e,changedItem:i,update:n});c=I,u=y}else u=l(".setting-list-object-key"),u.textContent=e.key.data;let p;const m=l(".setting-list-object-value-container"),v=()=>{const{widget:I,element:y}=this.renderEditWidget(i.value,{idx:t,isKey:!1,originalItem:e,changedItem:i,update:r});p=I,a.clearNode(m),m.append(y)};v(),s.append(u,m);const D=this.listDisposables.add(new w(s,k));D.enabled=i.key.data!=="",D.label=o("okButton","OK"),D.element.classList.add("setting-list-ok-button"),this.listDisposables.add(D.onDidClick(()=>this.handleItemChange(e,i,t)));const g=this.listDisposables.add(new w(s,{secondary:!0,...k}));return g.label=o("cancelButton","Cancel"),g.element.classList.add("setting-list-cancel-button"),this.listDisposables.add(g.onDidClick(()=>this.cancelEdit())),this.listDisposables.add(M(()=>{const I=c??p;I.focus(),I instanceof f&&I.select()})),s}renderEditWidget(e,t){switch(e.type){case"string":return this.renderStringEditWidget(e,t);case"enum":return this.renderEnumEditWidget(e,t);case"boolean":return this.renderEnumEditWidget({type:"enum",data:e.data.toString(),options:[{value:"true"},{value:"false"}]},t)}}renderStringEditWidget(e,{idx:t,isKey:s,originalItem:i,changedItem:n,update:r}){const c=l(s?".setting-list-object-input-key":".setting-list-object-input-value"),u=new f(c,this.contextViewService,{placeholder:s?o("objectKeyInputPlaceholder","Key"):o("objectValueInputPlaceholder","Value"),inputBoxStyles:P({inputBackground:N,inputForeground:G,inputBorder:W})});u.element.classList.add("setting-list-object-input"),this.listDisposables.add(u),u.value=e.data,this.listDisposables.add(u.onDidChange(m=>r({...e,data:m})));const p=m=>{m.equals(T.Enter)?this.handleItemChange(i,n,t):m.equals(T.Escape)&&(this.cancelEdit(),m.preventDefault())};return this.listDisposables.add(a.addStandardDisposableListener(u.inputElement,a.EventType.KEY_DOWN,p)),{widget:u,element:c}}renderEnumEditWidget(e,{isKey:t,changedItem:s,update:i}){const n=this.createBasicSelectBox(e),r=t?s.key:s.value;this.listDisposables.add(n.onDidSelect(({selected:p})=>i(r.type==="boolean"?{...r,data:p==="true"}:{...r,data:p})));const c=l(".setting-list-object-input");return c.classList.add(t?"setting-list-object-input-key":"setting-list-object-input-value"),n.render(c),e.options.findIndex(p=>e.data===p.value)===-1&&e.options.length?i(r.type==="boolean"?{...r,data:!0}:{...r,data:e.options[0].value}):r.type==="boolean"&&i({...r,data:e.data==="true"}),{widget:n,element:c}}shouldUseSuggestion(e,t,s){if(s.type!=="enum"&&s.type===t.type&&s.data===t.data)return!1;if(e.data==="")return!0;if(t.type===s.type&&s.type!=="enum")return!1;if(t.type==="enum"&&s.type==="enum"){const i=new Set(t.options.map(({value:n})=>n));if(s.options.forEach(({value:n})=>i.delete(n)),i.size===0)return!1}return!0}addTooltipsToRow(e,t){const{keyElement:s,valueElement:i,rowElement:n}=e;let r;t.source?r=o("objectPairHintLabelWithSource","The property `{0}` is set to `{1}` by `{2}`.",t.key.data,t.value.data,t.source):r=o("objectPairHintLabel","The property `{0}` is set to `{1}`.",t.key.data,t.value.data);const c={markdown:new V().appendMarkdown(r),markdownNotSupportedFallback:r},u=this.getEnumDescription(t.key)??t.keyDescription??c;this.listDisposables.add(this.hoverService.setupManagedHover(x("mouse"),s,u));const p=this.getEnumDescription(t.value)??c;this.listDisposables.add(this.hoverService.setupManagedHover(x("mouse"),i,p)),n.setAttribute("aria-label",r)}getEnumDescription(e){return e.type==="enum"?e.options.find(({value:s})=>e.data===s)?.description:void 0}getLocalizedStrings(){return{deleteActionTooltip:o("removeItem","Remove Item"),resetActionTooltip:o("resetItem","Reset Item"),editActionTooltip:o("editItem","Edit Item"),addButtonLabel:o("addItem","Add Item"),keyHeaderText:o("objectKeyHeader","Item"),valueHeaderText:o("objectValueHeader","Value")}}};C=S([b(1,A),b(2,O),b(3,_)],C);let H=class extends E{constructor(e,t,s,i){super(e,t,s);this.hoverService=i}currentSettingKey="";setValue(e,t){R(t)&&t.settingKey!==this.currentSettingKey&&(this.model.setEditKey("none"),this.model.select(null),this.currentSettingKey=t.settingKey),super.setValue(e)}isItemNew(e){return!e.key.data&&!e.value.data}getEmptyItem(){return{key:{type:"string",data:""},value:{type:"boolean",data:!1},removable:!1,resetable:!0}}getContainerClasses(){return["setting-list-object-widget"]}getActionsForItem(e,t){return[]}isAddButtonVisible(){return!1}renderHeader(){}renderDataOrEditItem(e,t,s){const i=this.renderEdit(e,t);return i.setAttribute("role","listitem"),i}renderItem(e,t){const s=l(".blank-row"),i=l(".blank-row-key");return{rowElement:s,keyElement:i}}renderEdit(e,t){const s=l(".setting-list-edit-row.setting-list-object-row.setting-item-bool"),i={...e},n=v=>{i.value.data=v,this.handleItemChange(e,i,t)},r=e.keyDescription?`${e.keyDescription} (${e.key.data})`:e.key.data,{element:c,widget:u}=this.renderEditWidget(i.value.data,r,n);s.appendChild(c);const p=a.append(s,l(".setting-list-object-value"));p.textContent=r;const m={rowElement:s,keyElement:p,valueElement:u.domNode};return this.addTooltipsToRow(m,e),this._register(a.addDisposableListener(p,a.EventType.MOUSE_DOWN,v=>{v.target.tagName.toLowerCase()!=="a"&&(u.checked=!u.checked,n(u.checked)),a.EventHelper.stop(v)})),s}renderEditWidget(e,t,s){const i=new X({icon:ee.check,actionClassName:"setting-value-checkbox",isChecked:e,title:t,...Z});this.listDisposables.add(i);const n=l(".setting-list-object-input");return n.classList.add("setting-list-object-input-key-checkbox"),i.domNode.classList.add("setting-value-checkbox"),n.appendChild(i.domNode),this._register(a.addDisposableListener(n,a.EventType.MOUSE_DOWN,r=>{i.checked=!i.checked,s(i.checked),r.stopImmediatePropagation()})),{widget:i,element:n}}addTooltipsToRow(e,t){const s=o("objectPairHintLabel","The property `{0}` is set to `{1}`.",t.key.data,t.value.data),i=t.keyDescription??s,{rowElement:n,keyElement:r,valueElement:c}=e;this.listDisposables.add(this.hoverService.setupManagedHover(x("mouse"),r,i)),c.setAttribute("aria-label",s),n.setAttribute("aria-label",s)}getLocalizedStrings(){return{deleteActionTooltip:o("removeItem","Remove Item"),resetActionTooltip:o("resetItem","Reset Item"),editActionTooltip:o("editItem","Edit Item"),addButtonLabel:o("addItem","Add Item"),keyHeaderText:o("objectKeyHeader","Item"),valueHeaderText:o("objectValueHeader","Value")}}};H=S([b(1,A),b(2,O),b(3,_)],H);export{E as AbstractListSettingWidget,Re as ExcludeSettingWidget,Ve as IncludeSettingWidget,ue as ListSettingListModel,L as ListSettingWidget,H as ObjectSettingCheckboxWidget,C as ObjectSettingDropdownWidget};
