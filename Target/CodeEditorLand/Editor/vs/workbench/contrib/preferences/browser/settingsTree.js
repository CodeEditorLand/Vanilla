var it=Object.defineProperty;var rt=Object.getOwnPropertyDescriptor;var b=(o,t,e,n)=>{for(var i=n>1?void 0:n?rt(t,e):t,r=o.length-1,s;r>=0;r--)(s=o[r])&&(i=(n?s(t,e,i):s(i))||i);return n&&i&&it(t,e,i),i},p=(o,t)=>(e,n)=>t(e,n,o);import{BrowserFeatures as st}from"../../../../base/browser/canIUse.js";import*as u from"../../../../base/browser/dom.js";import{StandardKeyboardEvent as ot}from"../../../../base/browser/keyboardEvent.js";import{renderMarkdownAsPlaintext as at}from"../../../../base/browser/markdownRenderer.js";import"../../../../base/browser/mouseEvent.js";import*as me from"../../../../base/browser/ui/aria/aria.js";import{Button as ie}from"../../../../base/browser/ui/button/button.js";import{SimpleIconLabel as Se}from"../../../../base/browser/ui/iconLabel/simpleIconLabel.js";import{InputBox as Ie}from"../../../../base/browser/ui/inputbox/inputBox.js";import{CachedListVirtualDelegate as lt}from"../../../../base/browser/ui/list/list.js";import{DefaultStyleController as ct}from"../../../../base/browser/ui/list/listWidget.js";import{SelectBox as dt}from"../../../../base/browser/ui/selectBox/selectBox.js";import{Toggle as gt,unthemedToggleStyles as ut}from"../../../../base/browser/ui/toggle/toggle.js";import{ToolBar as pt}from"../../../../base/browser/ui/toolbar/toolbar.js";import{RenderIndentGuides as mt}from"../../../../base/browser/ui/tree/abstractTree.js";import"../../../../base/browser/ui/tree/objectTree.js";import{ObjectTreeModel as St}from"../../../../base/browser/ui/tree/objectTreeModel.js";import{TreeVisibility as It}from"../../../../base/browser/ui/tree/tree.js";import{Action as B,Separator as Te}from"../../../../base/common/actions.js";import{distinct as Tt}from"../../../../base/common/arrays.js";import{Codicon as ft}from"../../../../base/common/codicons.js";import{onUnexpectedError as fe}from"../../../../base/common/errors.js";import{Emitter as y,Event as D}from"../../../../base/common/event.js";import"../../../../base/common/jsonSchema.js";import{KeyCode as $}from"../../../../base/common/keyCodes.js";import{Disposable as Ee,DisposableStore as A,dispose as Et,isDisposable as re,toDisposable as se}from"../../../../base/common/lifecycle.js";import{isIOS as ve}from"../../../../base/common/platform.js";import{escapeRegExpCharacters as vt}from"../../../../base/common/strings.js";import{isDefined as V,isUndefinedOrNull as q}from"../../../../base/common/types.js";import{ILanguageService as ht}from"../../../../editor/common/languages/language.js";import{MarkdownRenderer as bt}from"../../../../editor/browser/widget/markdownRenderer/browser/markdownRenderer.js";import{localize as f}from"../../../../nls.js";import{IClipboardService as oe}from"../../../../platform/clipboard/common/clipboardService.js";import{ICommandService as he}from"../../../../platform/commands/common/commands.js";import{ConfigurationTarget as j,IConfigurationService as be,getLanguageTagSettingPlainKey as yt}from"../../../../platform/configuration/common/configuration.js";import{ConfigurationScope as xt}from"../../../../platform/configuration/common/configurationRegistry.js";import{IContextKeyService as Lt}from"../../../../platform/contextkey/common/contextkey.js";import{IContextMenuService as ye,IContextViewService as xe}from"../../../../platform/contextview/browser/contextView.js";import{IInstantiationService as ae}from"../../../../platform/instantiation/common/instantiation.js";import{IKeybindingService as Dt}from"../../../../platform/keybinding/common/keybinding.js";import{IListService as Ct,WorkbenchObjectTree as Ot}from"../../../../platform/list/browser/listService.js";import"../../../../platform/log/common/log.js";import{IOpenerService as _t}from"../../../../platform/opener/common/opener.js";import{IProductService as Le}from"../../../../platform/product/common/productService.js";import{ITelemetryService as kt}from"../../../../platform/telemetry/common/telemetry.js";import{defaultButtonStyles as le,getInputBoxStyle as De,getListStyles as wt,getSelectBoxStyles as Mt}from"../../../../platform/theme/browser/defaultStyles.js";import{editorBackground as x,foreground as F}from"../../../../platform/theme/common/colorRegistry.js";import{IThemeService as Nt}from"../../../../platform/theme/common/themeService.js";import{IUserDataProfilesService as Ce}from"../../../../platform/userDataProfile/common/userDataProfile.js";import{getIgnoredSettings as ce}from"../../../../platform/userDataSync/common/settingsMerge.js";import{IUserDataSyncEnablementService as At,getDefaultIgnoredSettings as J}from"../../../../platform/userDataSync/common/userDataSync.js";import{IExtensionsWorkbenchService as Vt}from"../../extensions/common/extensions.js";import{settingsMoreActionIcon as jt}from"./preferencesIcons.js";import"./preferencesWidgets.js";import{SettingsTreeIndicatorsLabel as Oe,getIndicatorsLabelAriaLabel as Rt}from"./settingsEditorSettingIndicators.js";import"./settingsLayout.js";import{SettingsTreeGroupElement as H,SettingsTreeNewExtensionsElement as _e,SettingsTreeSettingElement as R,inspectSetting as Bt,objectSettingSupportsRemoveDefaultValue as ke,settingKeyToDisplayFormat as Ht}from"./settingsTreeModels.js";import{ExcludeSettingWidget as Pt,IncludeSettingWidget as Ft,ListSettingWidget as Gt,ObjectSettingCheckboxWidget as we,ObjectSettingDropdownWidget as Wt}from"./settingsWidgets.js";import{LANGUAGE_SETTING_TAG as Ut,SETTINGS_EDITOR_COMMAND_SHOW_CONTEXT_MENU as Kt,compareTwoNullableNumbers as Me}from"../common/preferences.js";import{settingsNumberInputBackground as $t,settingsNumberInputBorder as qt,settingsNumberInputForeground as Jt,settingsSelectBackground as Xt,settingsSelectBorder as Yt,settingsSelectForeground as zt,settingsSelectListBorder as Qt,settingsTextInputBackground as Zt,settingsTextInputBorder as en,settingsTextInputForeground as tn}from"../common/settingsEditorColorRegistry.js";import{APPLY_ALL_PROFILES_SETTING as P,IWorkbenchConfigurationService as Ne}from"../../../services/configuration/common/configuration.js";import{IWorkbenchEnvironmentService as nn}from"../../../services/environment/common/environmentService.js";import{IExtensionService as rn}from"../../../services/extensions/common/extensions.js";import{SETTINGS_AUTHORITY as sn,SettingValueType as h}from"../../../services/preferences/common/preferences.js";import{getInvalidTypeError as Ae}from"../../../services/preferences/common/preferencesValidation.js";import{getDefaultHoverDelegate as de}from"../../../../base/browser/ui/hover/hoverDelegateFactory.js";import{IHoverService as on}from"../../../../platform/hover/browser/hover.js";import{URI as an}from"../../../../base/common/uri.js";const S=u.$;function ln(o){const t=typeof o.defaultValue=="object"?o.defaultValue??{}:{},e=o.isConfigured?{...t,...o.scopeValue}:t;return Object.keys(e).filter(n=>!!e[n]).map(n=>{const i=t[n];let r;if(i===e[n]&&o.setting.type==="object"&&o.defaultValueSource instanceof Map){const l=o.defaultValueSource.get(`${o.setting.key}.${n}`);r=typeof l=="string"?l:l?.displayName}const s=e[n],a=typeof s=="boolean"?void 0:s.when;return{value:{type:"string",data:n},sibling:a,elementType:o.valueType,source:r}})}function cn(o,t){const e=new Set(o);return t.forEach(({key:n})=>e.delete(n.data)),e.size===0}function G(o){if(o.anyOf)return o.anyOf.map(G).flat();const t=o.enumDescriptions??[];return(o.enum??[]).map((e,n)=>{const i=n<t.length?t[n]:void 0;return{value:e,description:i}})}function W(o){return o.anyOf?o.anyOf.map(W).some(e=>e==="enum")?"enum":"string":o.type==="boolean"?"boolean":o.type==="string"&&V(o.enum)&&o.enum.length>0?"enum":"string"}function ge(o,t,e){return o==="boolean"?{type:o,data:!!t}:o==="enum"?{type:o,data:""+t,options:e}:{type:o,data:""+t}}function dn(o){const t=typeof o.defaultValue=="object"?o.defaultValue??{}:{},e=typeof o.scopeValue=="object"?o.scopeValue??{}:{},n=o.isConfigured?{...t,...e}:t,{objectProperties:i,objectPatternProperties:r,objectAdditionalProperties:s}=o.setting,a=Object.entries(r??{}).map(([c,d])=>({pattern:new RegExp(c),schema:d})),l=Object.entries(i??{}).map(([c,d])=>({value:c,description:d.description}));return Object.keys(n).map(c=>{const d=t[c];let g;if(d===n[c]&&o.setting.type==="object"&&o.defaultValueSource instanceof Map){const E=o.defaultValueSource.get(`${o.setting.key}.${c}`);g=typeof E=="string"?E:E?.displayName}if(V(i)&&c in i){const E=G(i[c]);return{key:{type:"enum",data:c,options:l},value:ge(W(i[c]),n[c],E),keyDescription:i[c].description,removable:q(d),resetable:!q(d),source:g}}const T=d===void 0||ke(o.setting.key),v=!!d&&d!==n[c],I=a.find(({pattern:E})=>E.test(c))?.schema;if(I){const E=G(I);return{key:{type:"string",data:c},value:ge(W(I),n[c],E),keyDescription:I.description,removable:T,resetable:v,source:g}}const C=G(typeof s=="boolean"?{}:s??{});return{key:{type:"string",data:c},value:ge(typeof s=="object"?W(s):"string",n[c],C),keyDescription:typeof s=="object"?s.description:void 0,removable:T,resetable:v,source:g}}).filter(c=>!q(c.value.data))}function gn(o){const t=typeof o.defaultValue=="object"?o.defaultValue??{}:{},e=typeof o.scopeValue=="object"?o.scopeValue??{}:{},n=o.isConfigured?{...t,...e}:t,{objectProperties:i}=o.setting,r=[];for(const s in i){const a=t[s];let l;if(a===n[s]&&o.setting.type==="object"&&o.defaultValueSource instanceof Map){const c=o.defaultValueSource.get(s);l=typeof c=="string"?c:c?.displayName}r.push({key:{type:"string",data:s},value:{type:"boolean",data:!!n[s]},keyDescription:i[s].description,removable:!1,resetable:!0,source:l})}return r}function un(o){return(t,e)=>{const n=[];return o.setting.enum&&o.setting.enum.forEach((i,r)=>{if(!o.setting.uniqueItems||e!==void 0&&i===t[e]||!t.includes(i)){const s=o.setting.enumDescriptions?.[r];n.push({value:i,description:s})}}),n.length>0?{type:"enum",data:n[0].value,options:n}:void 0}}function pn(o){const{objectProperties:t}=o.setting,e=Object.keys(t??{});return n=>{const i=new Set(n),r=[];return e.forEach(s=>{i.has(s)||r.push({value:s,description:t[s].description})}),r.length>0?{type:"enum",data:r[0].value,options:r}:void 0}}function mn(o){const{objectProperties:t,objectPatternProperties:e,objectAdditionalProperties:n}=o.setting,i=Object.entries(e??{}).map(([r,s])=>({pattern:new RegExp(r),schema:s}));return r=>{let s;V(t)&&r in t&&(s=t[r]);const a=s??i.find(({pattern:l})=>l.test(r))?.schema;if(V(a)?s=a:V(n)&&typeof n=="object"&&(s=n),V(s)){const l=W(s);if(l==="boolean")return{type:l,data:s.default??!0};if(l==="enum"){const c=G(s);return{type:l,data:s.default??c[0].value,options:c}}else return{type:l,data:s.default??""}}}}function X(o){return o==="number"||o==="integer"}function Sn(o,t){const e={};for(const n in t){let i;const r=o.setting.objectPatternProperties,s=o.setting.objectProperties,a=o.setting.objectAdditionalProperties;if(s){for(const l in s)if(l===n){i=X(s[l].type);break}}if(i===void 0&&r){for(const l in r)if(n.match(l)){i=X(r[l].type);break}}i===void 0&&a&&typeof a!="boolean"&&X(a.type)&&(i=!0),e[n]=i?Number(t[n]):t[n]}return e}function In(o){if(!o.value||!Array.isArray(o.value))return[];if(o.setting.arrayItemType==="enum"){let t=[];return o.setting.enum&&(t=o.setting.enum.map((e,n)=>({value:e,description:o.setting.enumDescriptions?.[n]}))),o.value.map(e=>({value:{type:"enum",data:e,options:t}}))}else return o.value.map(t=>({value:{type:"string",data:t}}))}function Tn(o,t){return o.setting.enum&&o.setting.uniqueItems?o.setting.enum.length-t.length>0:!0}function kr(o,t,e){const n=Re(t);return{tree:Ve(o,n,e),leftoverSettings:n}}function wr(o,t,e,n){return[...Re(o)].filter(r=>r.restricted&&Bt(r.key,t,e,n).isConfigured)}async function Mr(o,t){const e=new Map,n=(s,a,l)=>{if(!e.has(s)){const c={id:s,label:a,children:[]};e.set(s,c)}e.get(s).children.push(l)},i=async s=>{const a=s.sections.map(T=>T.settings).flat(),l=s.extensionInfo.id,c=await o.getExtension(l),d=c?.displayName??c?.name??l,g={id:s.id||s.title,label:s.title,order:s.order,settings:a};n(l,d,g)},r=t.map(s=>i(s));return Promise.all(r).then(()=>{const s=[];for(const a of e.values()){for(const l of a.children)l.settings?.sort((c,d)=>Me(c.order,d.order));if(a.children.length===1)s.push({id:a.id,label:a.children[0].label,settings:a.children[0].settings});else{a.children.sort((c,d)=>Me(c.order,d.order));const l=a.children.find(c=>c.label===a.label);if(l&&!l.children){const c=a.children.filter(d=>d!==l);s.push({id:a.id,label:a.label,settings:l.settings,children:c})}else s.push(a)}}return s.sort((a,l)=>a.label.localeCompare(l.label)),{id:"extensions",label:f("extensions","Extensions"),children:s}})}function Ve(o,t,e){let n;o.children&&(n=o.children.map(r=>Ve(r,t,e)).filter(r=>r.children?.length||r.settings?.length));let i;if(o.settings&&(i=o.settings.map(r=>En(t,r,e)).flat()),!n&&!i)throw new Error(`TOC node has no child groups or settings: ${o.id}`);return{id:o.id,label:o.label,children:n,settings:i}}const fn=[/^settingsSync\..*/,/^sync\..*/,/^workbench.fontAliasing$/];function En(o,t,e){const n=[];return o.forEach(i=>{hn(i,t)&&(n.push(i),o.delete(i))}),!n.length&&!fn.some(i=>i.test(t))&&e.warn(`Settings pattern "${t}" doesn't match any settings`),n.sort((i,r)=>i.key.localeCompare(r.key))}const je=new Map;function vn(o){return o=vt(o).replace(/\\\*/g,".*"),new RegExp(`^${o}$`,"i")}function hn(o,t){let e=je.get(t);return e||(e=vn(t),je.set(t,e)),e.test(o.key)}function Re(o){const t=new Set;for(const e of o)for(const n of e.sections)for(const i of n.settings)(!i.overrides||!i.overrides.length)&&t.add(i);return t}const Be="settings.text.template",He="settings.multilineText.template",Pe="settings.number.template",Fe="settings.enum.template",Ge="settings.bool.template",We="settings.array.template",Ue="settings.exclude.template",Ke="settings.include.template",$e="settings.object.template",qe="settings.boolObject.template",Y="settings.complex.template",Je="settings.newExtensions.template",Xe="settings.group.template",Ye="settings.extensionToggle.template";function bn(o){o.querySelectorAll(`
		[tabindex="0"],
		input:not([tabindex="-1"]),
		select:not([tabindex="-1"]),
		textarea:not([tabindex="-1"]),
		a:not([tabindex="-1"]),
		button:not([tabindex="-1"]),
		area:not([tabindex="-1"])
	`).forEach(e=>{e.setAttribute(m.ELEMENT_FOCUSABLE_ATTR,"true"),e.setAttribute("tabindex","-1")})}function yn(o){o.querySelectorAll(`[${m.ELEMENT_FOCUSABLE_ATTR}="true"]`).forEach(e=>{e.removeAttribute(m.ELEMENT_FOCUSABLE_ATTR),e.setAttribute("tabindex","0")})}let m=class extends Ee{constructor(e,n,i,r,s,a,l,c,d,g,T,v,I,C,E){super();this.settingActions=e;this.disposableActionFactory=n;this._themeService=i;this._contextViewService=r;this._openerService=s;this._instantiationService=a;this._commandService=l;this._contextMenuService=c;this._keybindingService=d;this._configService=g;this._extensionsService=T;this._extensionsWorkbenchService=v;this._productService=I;this._telemetryService=C;this._hoverService=E;this.markdownRenderer=this._register(a.createInstance(bt,{})),this.ignoredSettings=ce(J(),this._configService),this._register(this._configService.onDidChangeConfiguration(L=>{this.ignoredSettings=ce(J(),this._configService),this._onDidChangeIgnoredSettings.fire()}))}static CONTROL_CLASS="setting-control-focus-target";static CONTROL_SELECTOR="."+this.CONTROL_CLASS;static CONTENTS_CLASS="setting-item-contents";static CONTENTS_SELECTOR="."+this.CONTENTS_CLASS;static ALL_ROWS_SELECTOR=".monaco-list-row";static SETTING_KEY_ATTR="data-key";static SETTING_ID_ATTR="data-id";static ELEMENT_FOCUSABLE_ATTR="data-focusable";_onDidClickOverrideElement=this._register(new y);onDidClickOverrideElement=this._onDidClickOverrideElement.event;_onDidChangeSetting=this._register(new y);onDidChangeSetting=this._onDidChangeSetting.event;_onDidOpenSettings=this._register(new y);onDidOpenSettings=this._onDidOpenSettings.event;_onDidClickSettingLink=this._register(new y);onDidClickSettingLink=this._onDidClickSettingLink.event;_onDidFocusSetting=this._register(new y);onDidFocusSetting=this._onDidFocusSetting.event;ignoredSettings;_onDidChangeIgnoredSettings=this._register(new y);onDidChangeIgnoredSettings=this._onDidChangeIgnoredSettings.event;_onDidChangeSettingHeight=this._register(new y);onDidChangeSettingHeight=this._onDidChangeSettingHeight.event;_onApplyFilter=this._register(new y);onApplyFilter=this._onApplyFilter.event;markdownRenderer;renderCommonTemplate(e,n,i){n.classList.add("setting-item"),n.classList.add("setting-item-"+i);const r=new A,s=u.append(n,S(m.CONTENTS_SELECTOR));s.classList.add("settings-row-inner-container");const a=u.append(s,S(".setting-item-title")),l=u.append(a,S(".setting-item-cat-label-container")),c=u.append(l,S("span.setting-item-category")),d=u.append(l,S("span.setting-item-label")),g=r.add(new Se(d)),T=this._instantiationService.createInstance(Oe,a);r.add(T);const v=u.append(s,S(".setting-item-description")),I=u.append(s,S(".setting-item-modified-indicator"));r.add(this._hoverService.setupManagedHover(de("mouse"),I,()=>f("modified","The setting has been configured in the current scope.")));const C=u.append(s,S(".setting-item-value")),E=u.append(C,S("div.setting-item-control")),L=u.append(s,S(".setting-item-deprecation-message")),O=u.append(s,S(".setting-toolbar-container")),pe=this.renderSettingToolbar(O),nt={toDispose:r,elementDisposables:r.add(new A),containerElement:s,categoryElement:c,labelElement:g,descriptionElement:v,controlElement:E,deprecationWarningElement:L,indicatorsLabel:T,toolbar:pe};return r.add(u.addDisposableListener(E,u.EventType.MOUSE_DOWN,ne=>ne.stopPropagation())),r.add(u.addDisposableListener(a,u.EventType.MOUSE_ENTER,ne=>s.classList.add("mouseover"))),r.add(u.addDisposableListener(a,u.EventType.MOUSE_LEAVE,ne=>s.classList.remove("mouseover"))),nt}addSettingElementFocusHandler(e){const n=u.trackFocus(e.containerElement);e.toDispose.add(n),n.onDidBlur(()=>{e.containerElement.classList.contains("focused")&&e.containerElement.classList.remove("focused")}),n.onDidFocus(()=>{e.containerElement.classList.add("focused"),e.context&&this._onDidFocusSetting.fire(e.context)})}renderSettingToolbar(e){const n=this._keybindingService.lookupKeybinding(Kt);let i=f("settingsContextMenuTitle","More Actions... ");return n&&(i+=` (${n&&n.getLabel()})`),new pt(e,this._contextMenuService,{toggleMenuTitle:i,renderDropdownAsChildElement:!ve,moreIcon:jt})}renderSettingElement(e,n,i){const r=e.element;r.inspectSelf(),i.context=r,i.toolbar.context=r;const s=this.disposableActionFactory(r.setting,r.settingsTarget);s.forEach(g=>re(g)&&i.elementDisposables.add(g)),i.toolbar.setActions([],[...this.settingActions,...s]);const a=r.setting;i.containerElement.classList.toggle("is-configured",r.isConfigured),i.containerElement.setAttribute(m.SETTING_KEY_ATTR,r.setting.key),i.containerElement.setAttribute(m.SETTING_ID_ATTR,r.id);const l=a.key+(r.isConfigured?" - Modified":"");if(i.categoryElement.textContent=r.displayCategory?r.displayCategory+": ":"",i.elementDisposables.add(this._hoverService.setupManagedHover(de("mouse"),i.categoryElement,l)),i.labelElement.text=r.displayLabel,i.labelElement.title=l,i.descriptionElement.innerText="",r.setting.descriptionIsMarkdown){const g=this.renderSettingMarkdown(r,i.containerElement,r.description,i.elementDisposables);i.descriptionElement.appendChild(g)}else i.descriptionElement.innerText=r.description;i.indicatorsLabel.updateScopeOverrides(r,this._onDidClickOverrideElement,this._onApplyFilter),i.elementDisposables.add(this._configService.onDidChangeConfiguration(g=>{g.affectsConfiguration(P)&&i.indicatorsLabel.updateScopeOverrides(r,this._onDidClickOverrideElement,this._onApplyFilter)}));const c=g=>this._onDidChangeSetting.fire({key:r.setting.key,value:g,type:i.context.valueType,manualReset:!1,scope:r.setting.scope}),d=r.setting.deprecationMessage||"";d&&r.setting.deprecationMessageIsMarkdown?(i.deprecationWarningElement.innerText="",i.deprecationWarningElement.appendChild(this.renderSettingMarkdown(r,i.containerElement,r.setting.deprecationMessage,i.elementDisposables))):i.deprecationWarningElement.innerText=d,i.deprecationWarningElement.prepend(S(".codicon.codicon-error")),i.containerElement.classList.toggle("is-deprecated",!!d),this.renderValue(r,i,c),i.indicatorsLabel.updateWorkspaceTrust(r),i.indicatorsLabel.updateSyncIgnored(r,this.ignoredSettings),i.indicatorsLabel.updateDefaultOverrideIndicator(r),i.elementDisposables.add(this.onDidChangeIgnoredSettings(()=>{i.indicatorsLabel.updateSyncIgnored(r,this.ignoredSettings)})),this.updateSettingTabbable(r,i),i.elementDisposables.add(r.onDidChangeTabbable(()=>{this.updateSettingTabbable(r,i)}))}updateSettingTabbable(e,n){e.tabbable?yn(n.containerElement):bn(n.containerElement)}renderSettingMarkdown(e,n,i,r){i=ue(i);const s=this.markdownRenderer.render({value:i,isTrusted:!0},{actionHandler:{callback:a=>{if(a.startsWith("#")){const l={source:e,targetKey:a.substring(1)};this._onDidClickSettingLink.fire(l)}else this._openerService.open(a,{allowCommands:!0}).catch(fe)},disposables:r},asyncRenderCallback:()=>{const a=n.clientHeight;a&&this._onDidChangeSettingHeight.fire({element:e,height:a})}});return r.add(s),s.element.classList.add("setting-item-markdown"),et(s.element),s.element}disposeTemplate(e){e.toDispose.dispose()}disposeElement(e,n,i,r){i.elementDisposables?.clear()}};m=b([p(2,Nt),p(3,xe),p(4,_t),p(5,ae),p(6,he),p(7,ye),p(8,Dt),p(9,be),p(10,rn),p(11,Vt),p(12,Le),p(13,kt),p(14,on)],m);class xn{templateId=Xe;renderTemplate(t){return t.classList.add("group-title"),{parent:t,toDispose:new A}}renderElement(t,e,n){n.parent.innerText="";const i=u.append(n.parent,S("div.settings-group-title-label.settings-row-inner-container"));i.classList.add(`settings-group-level-${t.element.level}`),i.textContent=t.element.label,t.element.isFirstGroup&&i.classList.add("settings-group-first")}disposeTemplate(t){}}let U=class{constructor(t){this._commandService=t}templateId=Je;renderTemplate(t){const e=new A;t.classList.add("setting-item-new-extensions");const n=new ie(t,{title:!0,...le});e.add(n),e.add(n.onDidClick(()=>{i.context&&this._commandService.executeCommand("workbench.extensions.action.showExtensionsWithIds",i.context.extensionIds)})),n.label=f("newExtensionsButtonLabel","Show matching extensions"),n.element.classList.add("settings-new-extensions-button");const i={button:n,toDispose:e};return i}renderElement(t,e,n){n.context=t.element}disposeTemplate(t){Et(t.toDispose)}};U=b([p(0,he)],U);class te extends m{static EDIT_IN_JSON_LABEL=f("editInSettingsJson","Edit in settings.json");templateId=Y;renderTemplate(t){const e=this.renderCommonTemplate(null,t,"complex"),n=u.append(e.controlElement,S("a.edit-in-settings-button"));n.classList.add(m.CONTROL_CLASS),n.role="button";const i=S(".setting-item-validation-message");e.containerElement.appendChild(i);const r={...e,button:n,validationErrorMessageElement:i};return this.addSettingElementFocusHandler(r),r}renderElement(t,e,n){super.renderSettingElement(t,e,n)}renderValue(t,e,n){const i=yt(t.setting.key),r=f("editLanguageSettingLabel","Edit settings for {0}",i),s=t.setting.isLanguageTagSetting;e.button.textContent=s?r:te.EDIT_IN_JSON_LABEL;const a=l=>{s?this._onApplyFilter.fire(`@${Ut}${i}`):this._onDidOpenSettings.fire(t.setting.key),l.preventDefault(),l.stopPropagation()};e.elementDisposables.add(u.addDisposableListener(e.button,u.EventType.CLICK,l=>{a(l)})),e.elementDisposables.add(u.addDisposableListener(e.button,u.EventType.KEY_DOWN,l=>{const c=new ot(l);(c.equals($.Space)||c.equals($.Enter))&&a(l)})),this.renderValidations(t,e),s?e.button.setAttribute("aria-label",r):e.button.setAttribute("aria-label",`${te.EDIT_IN_JSON_LABEL}: ${t.setting.key}`)}renderValidations(t,e){const n=t.isConfigured&&Ae(t.value,t.setting.type);if(n){e.containerElement.classList.add("invalid-input"),e.validationErrorMessageElement.innerText=n;return}e.containerElement.classList.remove("invalid-input")}}class Ln extends m{templateId=We;renderTemplate(t){const e=this.renderCommonTemplate(null,t,"list"),n=e.containerElement.querySelector(".setting-item-description"),i=S(".setting-item-validation-message");n.after(i);const r=this._instantiationService.createInstance(Gt,e.controlElement);r.domNode.classList.add(m.CONTROL_CLASS),e.toDispose.add(r);const s={...e,listWidget:r,validationErrorMessageElement:i};return this.addSettingElementFocusHandler(s),e.toDispose.add(r.onDidChangeList(a=>{const l=this.computeNewList(s,a);s.onChange?.(l)})),s}computeNewList(t,e){if(t.context){let n=[];if(Array.isArray(t.context.scopeValue)?n=[...t.context.scopeValue]:Array.isArray(t.context.value)&&(n=[...t.context.value]),e.type==="move"){const i=e.sourceIndex,r=e.targetIndex,s=n.splice(i,1)[0];n.splice(r,0,s)}else if(e.type==="remove"||e.type==="reset")n.splice(e.targetIndex,1);else if(e.type==="change"){const i=e.newItem.value.data.toString();e.targetIndex>-1?n[e.targetIndex]=i:n.push(i)}else e.type==="add"&&n.push(e.newItem.value.data.toString());return t.context.defaultValue&&Array.isArray(t.context.defaultValue)&&t.context.defaultValue.length===n.length&&t.context.defaultValue.join()===n.join()?void 0:n}}renderElement(t,e,n){super.renderSettingElement(t,e,n)}renderValue(t,e,n){const i=In(t),r=t.setting.enum?un(t):void 0;e.listWidget.setValue(i,{showAddButton:Tn(t,i),keySuggester:r}),e.context=t,e.elementDisposables.add(se(()=>{e.listWidget.cancelEdit()})),e.onChange=s=>{if(s&&!Z(t,e,s,!1)){const a=t.setting.arrayItemType,l=X(a)?s.map(c=>+c):s;n(l)}else n(s)},Z(t,e,i.map(s=>s.value.data.toString()),!0)}}class ze extends m{renderTemplateWithWidget(t,e){e.domNode.classList.add(m.CONTROL_CLASS),t.toDispose.add(e);const n=t.containerElement.querySelector(".setting-item-description"),i=S(".setting-item-validation-message");n.after(i);const r={...t,validationErrorMessageElement:i};return e instanceof we?r.objectCheckboxWidget=e:r.objectDropdownWidget=e,this.addSettingElementFocusHandler(r),r}renderElement(t,e,n){super.renderSettingElement(t,e,n)}}class Dn extends ze{templateId=$e;renderTemplate(t){const e=this.renderCommonTemplate(null,t,"list"),n=this._instantiationService.createInstance(Wt,e.controlElement),i=this.renderTemplateWithWidget(e,n);return e.toDispose.add(n.onDidChangeList(r=>{this.onDidChangeObject(i,r)})),i}onDidChangeObject(t,e){const n=t.objectDropdownWidget;if(t.context){const i=ke(t.context.setting.key),r=typeof t.context.defaultValue=="object"?t.context.defaultValue??{}:{},s=typeof t.context.scopeValue=="object"?t.context.scopeValue??{}:{},a={...t.context.scopeValue},l=[];if(n.items.forEach((d,g)=>{(e.type==="change"||e.type==="move")&&e.targetIndex===g?(e.originalItem.key.data!==e.newItem.key.data&&i&&e.originalItem.key.data in r?a[e.originalItem.key.data]=null:delete a[e.originalItem.key.data],a[e.newItem.key.data]=e.newItem.value.data,l.push(e.newItem)):(e.type!=="change"&&e.type!=="move"||e.newItem.key.data!==d.key.data)&&(a[d.key.data]=d.value.data,l.push(d))}),e.type==="remove"||e.type==="reset"){const d=e.originalItem.key.data,g=e.type==="remove"&&i&&r[d]===e.originalItem.value.data;g?a[d]=null:delete a[d];const T=l.findIndex(I=>I.key.data===d),v=r[d];g||q(r[d])&&T>-1?l.splice(T,1):!g&&T>-1&&(l[T].value.data=v)}else e.type==="add"&&(a[e.newItem.key.data]=e.newItem.value.data,l.push(e.newItem));Object.entries(a).forEach(([d,g])=>{s[d]!==g&&r[d]===g&&!(i&&g===null)&&delete a[d]});const c=Object.keys(a).length===0?void 0:a;t.objectDropdownWidget.setValue(l),t.onChange?.(c)}}renderValue(t,e,n){const i=dn(t),{key:r,objectProperties:s,objectPatternProperties:a,objectAdditionalProperties:l}=t.setting;e.objectDropdownWidget.setValue(i,{settingKey:r,showAddButton:l===!1?!cn(Object.keys(s??{}),i)||V(a):!0,keySuggester:pn(t),valueSuggester:mn(t)}),e.context=t,e.elementDisposables.add(se(()=>{e.objectDropdownWidget.cancelEdit()})),e.onChange=c=>{if(c&&!Z(t,e,c,!1)){const d=Sn(t,c);n(d)}else n(c)},Z(t,e,t.value,!0)}}class Cn extends ze{templateId=qe;renderTemplate(t){const e=this.renderCommonTemplate(null,t,"list"),n=this._instantiationService.createInstance(we,e.controlElement),i=this.renderTemplateWithWidget(e,n);return e.toDispose.add(n.onDidChangeList(r=>{this.onDidChangeObject(i,r)})),i}onDidChangeObject(t,e){if(t.context){const n=t.objectCheckboxWidget,i=typeof t.context.defaultValue=="object"?t.context.defaultValue??{}:{},r=typeof t.context.scopeValue=="object"?t.context.scopeValue??{}:{},s={...t.context.scopeValue},a=[];if(e.type!=="change")return;n.items.forEach((c,d)=>{e.targetIndex===d?(s[e.newItem.key.data]=e.newItem.value.data,a.push(e.newItem)):e.newItem.key.data!==c.key.data&&(s[c.key.data]=c.value.data,a.push(c))}),Object.entries(s).forEach(([c,d])=>{r[c]!==d&&i[c]===d&&delete s[c]});const l=Object.keys(s).length===0?void 0:s;t.objectCheckboxWidget.setValue(a),t.onChange?.(l),this._onDidFocusSetting.fire(t.context)}}renderValue(t,e,n){const i=gn(t),{key:r}=t.setting;e.objectCheckboxWidget.setValue(i,{settingKey:r}),e.context=t,e.onChange=s=>{n(s)}}}class Qe extends m{renderTemplate(t){const e=this.renderCommonTemplate(null,t,"list"),n=this._instantiationService.createInstance(this.isExclude()?Pt:Ft,e.controlElement);n.domNode.classList.add(m.CONTROL_CLASS),e.toDispose.add(n);const i={...e,includeExcludeWidget:n};return this.addSettingElementFocusHandler(i),e.toDispose.add(n.onDidChangeList(r=>this.onDidChangeIncludeExclude(i,r))),i}onDidChangeIncludeExclude(t,e){if(t.context){let r=function(s){const a=Object.keys(s).sort((c,d)=>c.localeCompare(d)),l={};for(const c of a)l[c]=s[c];return l};var n=r;const i={...t.context.scopeValue};e.type!=="add"&&(e.originalItem.value.data.toString()in t.context.defaultValue?i[e.originalItem.value.data.toString()]=!1:delete i[e.originalItem.value.data.toString()]),(e.type==="change"||e.type==="add"||e.type==="move")&&(e.newItem.value.data.toString()in t.context.defaultValue&&!e.newItem.sibling?delete i[e.newItem.value.data.toString()]:i[e.newItem.value.data.toString()]=e.newItem.sibling?{when:e.newItem.sibling}:!0),this._onDidChangeSetting.fire({key:t.context.setting.key,value:Object.keys(i).length===0?void 0:r(i),type:t.context.valueType,manualReset:!1,scope:t.context.setting.scope})}}renderElement(t,e,n){super.renderSettingElement(t,e,n)}renderValue(t,e,n){const i=ln(t);e.includeExcludeWidget.setValue(i),e.context=t,e.elementDisposables.add(se(()=>{e.includeExcludeWidget.cancelEdit()}))}}class On extends Qe{templateId=Ue;isExclude(){return!0}}class _n extends Qe{templateId=Ke;isExclude(){return!1}}const kn=De({inputBackground:Zt,inputForeground:tn,inputBorder:en});class Ze extends m{MULTILINE_MAX_HEIGHT=150;renderTemplate(t,e){const n=this.renderCommonTemplate(null,t,"text"),i=u.append(n.containerElement,S(".setting-item-validation-message")),r={flexibleHeight:e,flexibleWidth:!1,flexibleMaxHeight:this.MULTILINE_MAX_HEIGHT,inputBoxStyles:kn},s=new Ie(n.controlElement,this._contextViewService,r);n.toDispose.add(s),n.toDispose.add(s.onDidChange(l=>{a.onChange?.(l)})),n.toDispose.add(s),s.inputElement.classList.add(m.CONTROL_CLASS),s.inputElement.tabIndex=0;const a={...n,inputBox:s,validationErrorMessageElement:i};return this.addSettingElementFocusHandler(a),a}renderElement(t,e,n){super.renderSettingElement(t,e,n)}renderValue(t,e,n){e.onChange=void 0,e.inputBox.value=t.value,e.inputBox.setAriaLabel(t.setting.key),e.onChange=i=>{Q(t,e,!1)||n(i)},Q(t,e,!0)}}class wn extends Ze{templateId=Be;renderTemplate(t){const e=super.renderTemplate(t,!1);return e.toDispose.add(u.addStandardDisposableListener(e.inputBox.inputElement,u.EventType.KEY_DOWN,n=>{(n.equals($.UpArrow)||n.equals($.DownArrow))&&n.preventDefault()})),e}}class Mn extends Ze{templateId=He;renderTemplate(t){return super.renderTemplate(t,!0)}renderValue(t,e,n){const i=r=>{t.value=r,n(r)};super.renderValue(t,e,i),e.elementDisposables.add(e.inputBox.onDidHeightChange(r=>{e.containerElement.clientHeight&&this._onDidChangeSettingHeight.fire({element:t,height:e.containerElement.clientHeight})})),e.inputBox.layout()}}class Nn extends m{templateId=Fe;renderTemplate(t){const e=this.renderCommonTemplate(null,t,"enum"),n=Mt({selectBackground:Xt,selectForeground:zt,selectBorder:Yt,selectListBorder:Qt}),i=new dt([],0,this._contextViewService,n,{useCustomDrawn:!(ve&&st.pointerEvents)});e.toDispose.add(i),i.render(e.controlElement);const r=e.controlElement.querySelector("select");r&&(r.classList.add(m.CONTROL_CLASS),r.tabIndex=0),e.toDispose.add(i.onDidSelect(l=>{a.onChange?.(l.index)}));const s=e.containerElement.insertBefore(S(".setting-item-enumDescription"),e.descriptionElement.nextSibling),a={...e,selectBox:i,selectElement:r,enumDescriptionElement:s};return this.addSettingElementFocusHandler(a),a}renderElement(t,e,n){super.renderSettingElement(t,e,n)}renderValue(t,e,n){const i=t.setting.enumItemLabels?[...t.setting.enumItemLabels]:[],r=t.setting.enumDescriptions?[...t.setting.enumDescriptions]:[],s=[...t.setting.enum],a=t.setting.enumDescriptionsAreMarkdown,l=new A;e.elementDisposables.add(l);let c=!1;s.includes(t.defaultValue)||(s.unshift(t.defaultValue),r.unshift(""),i.unshift(""),c=!0);const d=tt(String(t.defaultValue)),g=s.map(String).map(tt).map((v,I)=>{const C=r[I]&&(a?ue(r[I],!1):r[I]);return{text:i[I]?i[I]:v,detail:i[I]?v:"",description:C,descriptionIsMarkdown:a,descriptionMarkdownActionHandler:{callback:E=>{this._openerService.open(E).catch(fe)},disposables:l},decoratorRight:v===d||c&&I===0?f("settings.Default","default"):""}});e.selectBox.setOptions(g),e.selectBox.setAriaLabel(t.setting.key);let T=s.indexOf(t.value);T===-1&&(T=0),e.onChange=void 0,e.selectBox.select(T),e.onChange=v=>{n(c&&v===0?t.defaultValue:s[v])},e.enumDescriptionElement.innerText=""}}const An=De({inputBackground:$t,inputForeground:Jt,inputBorder:qt});class Vn extends m{templateId=Pe;renderTemplate(t){const e=super.renderCommonTemplate(null,t,"number"),n=u.append(e.containerElement,S(".setting-item-validation-message")),i=new Ie(e.controlElement,this._contextViewService,{type:"number",inputBoxStyles:An});e.toDispose.add(i),e.toDispose.add(i.onDidChange(s=>{r.onChange?.(s)})),e.toDispose.add(i),i.inputElement.classList.add(m.CONTROL_CLASS),i.inputElement.tabIndex=0;const r={...e,inputBox:i,validationErrorMessageElement:n};return this.addSettingElementFocusHandler(r),r}renderElement(t,e,n){super.renderSettingElement(t,e,n)}renderValue(t,e,n){const i=t.valueType==="integer"||t.valueType==="nullable-integer"?parseInt:parseFloat,r=t.valueType==="nullable-integer"||t.valueType==="nullable-number"?s=>s===""?null:i(s):i;e.onChange=void 0,e.inputBox.value=typeof t.value=="number"?t.value.toString():"",e.inputBox.step=t.valueType.includes("integer")?"1":"any",e.inputBox.setAriaLabel(t.setting.key),e.onChange=s=>{Q(t,e,!1)||n(r(s))},Q(t,e,!0)}}class jn extends m{templateId=Ge;renderTemplate(t){t.classList.add("setting-item"),t.classList.add("setting-item-bool");const e=new A,n=u.append(t,S(m.CONTENTS_SELECTOR));n.classList.add("settings-row-inner-container");const i=u.append(n,S(".setting-item-title")),r=u.append(i,S("span.setting-item-category")),s=u.append(i,S("span.setting-item-label")),a=e.add(new Se(s)),l=this._instantiationService.createInstance(Oe,i),c=u.append(n,S(".setting-item-value-description")),d=u.append(c,S(".setting-item-bool-control")),g=u.append(c,S(".setting-item-description")),T=u.append(n,S(".setting-item-modified-indicator"));e.add(this._hoverService.setupManagedHover(de("mouse"),T,f("modified","The setting has been configured in the current scope.")));const v=u.append(n,S(".setting-item-deprecation-message")),I=new gt({icon:ft.check,actionClassName:"setting-value-checkbox",isChecked:!0,title:"",...ut});d.appendChild(I.domNode),e.add(I),e.add(I.onChange(()=>{L.onChange(I.checked)})),e.add(u.addDisposableListener(g,u.EventType.MOUSE_DOWN,O=>{O.target.tagName.toLowerCase()!=="a"&&(L.checkbox.checked=!L.checkbox.checked,L.onChange(I.checked)),u.EventHelper.stop(O)})),I.domNode.classList.add(m.CONTROL_CLASS);const C=u.append(n,S(".setting-toolbar-container")),E=this.renderSettingToolbar(C);e.add(E);const L={toDispose:e,elementDisposables:e.add(new A),containerElement:n,categoryElement:r,labelElement:a,controlElement:d,checkbox:I,descriptionElement:g,deprecationWarningElement:v,indicatorsLabel:l,toolbar:E};return this.addSettingElementFocusHandler(L),e.add(u.addDisposableListener(d,"mousedown",O=>O.stopPropagation())),e.add(u.addDisposableListener(i,u.EventType.MOUSE_ENTER,O=>n.classList.add("mouseover"))),e.add(u.addDisposableListener(i,u.EventType.MOUSE_LEAVE,O=>n.classList.remove("mouseover"))),L}renderElement(t,e,n){super.renderSettingElement(t,e,n)}renderValue(t,e,n){e.onChange=void 0,e.checkbox.checked=t.value,e.checkbox.setTitle(t.setting.key),e.onChange=n}}class Rn extends m{templateId=Ye;_onDidDismissExtensionSetting=this._register(new y);onDidDismissExtensionSetting=this._onDidDismissExtensionSetting.event;renderTemplate(t){const e=super.renderCommonTemplate(null,t,"extension-toggle"),n=new ie(e.containerElement,{title:!1,...le});n.element.classList.add("setting-item-extension-toggle-button"),n.label=f("showExtension","Show Extension");const i=new ie(e.containerElement,{title:!1,secondary:!0,...le});i.element.classList.add("setting-item-extension-dismiss-button"),i.label=f("dismiss","Dismiss");const r={...e,actionButton:n,dismissButton:i};return this.addSettingElementFocusHandler(r),r}renderElement(t,e,n){super.renderSettingElement(t,e,n)}renderValue(t,e,n){e.elementDisposables.clear();const i=t.setting.displayExtensionId;e.elementDisposables.add(e.actionButton.onDidClick(async()=>{this._telemetryService.publicLog2("ManageExtensionClick",{extensionId:i}),this._commandService.executeCommand("extension.open",i)})),e.elementDisposables.add(e.dismissButton.onDidClick(async()=>{this._telemetryService.publicLog2("DismissExtensionClick",{extensionId:i}),this._onDidDismissExtensionSetting.fire(i)}))}}let z=class extends Ee{constructor(e,n,i,r,s){super();this._instantiationService=e;this._contextMenuService=n;this._contextViewService=i;this._userDataProfilesService=r;this._userDataSyncEnablementService=s;this.settingActions=[new B("settings.resetSetting",f("resetSettingLabel","Reset Setting"),void 0,void 0,async g=>{g instanceof R&&(g.isUntrusted||this._onDidChangeSetting.fire({key:g.setting.key,value:void 0,type:g.setting.type,manualReset:!0,scope:g.setting.scope}))}),new Te,this._instantiationService.createInstance(_),this._instantiationService.createInstance(k),this._instantiationService.createInstance(w)];const a=(g,T)=>this.getActionsForSetting(g,T),l=g=>[],c=this._instantiationService.createInstance(Rn,[],l),d=[this._instantiationService.createInstance(jn,this.settingActions,a),this._instantiationService.createInstance(Vn,this.settingActions,a),this._instantiationService.createInstance(Ln,this.settingActions,a),this._instantiationService.createInstance(te,this.settingActions,a),this._instantiationService.createInstance(wn,this.settingActions,a),this._instantiationService.createInstance(Mn,this.settingActions,a),this._instantiationService.createInstance(On,this.settingActions,a),this._instantiationService.createInstance(_n,this.settingActions,a),this._instantiationService.createInstance(Nn,this.settingActions,a),this._instantiationService.createInstance(Dn,this.settingActions,a),this._instantiationService.createInstance(Cn,this.settingActions,a),c];this.onDidClickOverrideElement=D.any(...d.map(g=>g.onDidClickOverrideElement)),this.onDidChangeSetting=D.any(...d.map(g=>g.onDidChangeSetting),this._onDidChangeSetting.event),this.onDidDismissExtensionSetting=c.onDidDismissExtensionSetting,this.onDidOpenSettings=D.any(...d.map(g=>g.onDidOpenSettings)),this.onDidClickSettingLink=D.any(...d.map(g=>g.onDidClickSettingLink)),this.onDidFocusSetting=D.any(...d.map(g=>g.onDidFocusSetting)),this.onDidChangeSettingHeight=D.any(...d.map(g=>g.onDidChangeSettingHeight)),this.onApplyFilter=D.any(...d.map(g=>g.onApplyFilter)),this.allRenderers=[...d,this._instantiationService.createInstance(xn),this._instantiationService.createInstance(U)]}onDidClickOverrideElement;_onDidChangeSetting=this._register(new y);onDidChangeSetting;onDidDismissExtensionSetting;onDidOpenSettings;onDidClickSettingLink;onDidFocusSetting;onDidChangeSettingHeight;onApplyFilter;allRenderers;settingActions;getActionsForSetting(e,n){const i=[];return this._userDataProfilesService.isEnabled()&&e.scope!==xt.APPLICATION&&n===j.USER_LOCAL&&i.push(this._instantiationService.createInstance(N,e)),this._userDataSyncEnablementService.isEnabled()&&!e.disallowSyncIgnore&&i.push(this._instantiationService.createInstance(M,e)),i.length&&i.splice(0,0,new Te),i}cancelSuggesters(){this._contextViewService.hideContextView()}showContextMenu(e,n){const i=n.querySelector(".monaco-toolbar");i&&this._contextMenuService.showContextMenu({getActions:()=>this.settingActions,getAnchor:()=>i,getActionsContext:()=>e})}getSettingDOMElementForDOMElement(e){const n=u.findParentWithClass(e,m.CONTENTS_CLASS);return n||null}getDOMElementsForSettingKey(e,n){return e.querySelectorAll(`[${m.SETTING_KEY_ATTR}="${n}"]`)}getKeyForDOMElementInSetting(e){const n=this.getSettingDOMElementForDOMElement(e);return n&&n.getAttribute(m.SETTING_KEY_ATTR)}getIdForDOMElementInSetting(e){const n=this.getSettingDOMElementForDOMElement(e);return n&&n.getAttribute(m.SETTING_ID_ATTR)}dispose(){super.dispose(),this.settingActions.forEach(e=>{re(e)&&e.dispose()}),this.allRenderers.forEach(e=>{re(e)&&e.dispose()})}};z=b([p(0,ae),p(1,ye),p(2,xe),p(3,Ce),p(4,At)],z);function Q(o,t,e){if(o.setting.validator){const n=o.setting.validator(t.inputBox.value);if(n){t.containerElement.classList.add("invalid-input"),t.validationErrorMessageElement.innerText=n;const i=f("validationError","Validation Error.");return t.inputBox.inputElement.parentElement.setAttribute("aria-label",[i,n].join(" ")),e||me.status(i+" "+n),!0}else t.inputBox.inputElement.parentElement.removeAttribute("aria-label")}return t.containerElement.classList.remove("invalid-input"),!1}function Z(o,t,e,n){if(t.containerElement.classList.add("invalid-input"),o.setting.validator){const i=o.setting.validator(e);if(i&&i!==""){t.containerElement.classList.add("invalid-input"),t.validationErrorMessageElement.innerText=i;const r=f("validationError","Validation Error.");return t.containerElement.setAttribute("aria-label",[o.setting.key,r,i].join(" ")),n||me.status(r+" "+i),!0}else t.containerElement.setAttribute("aria-label",o.setting.key),t.containerElement.classList.remove("invalid-input")}return!1}function et(o){for(let t=0;t<o.childNodes.length;t++){const e=o.childNodes.item(t);(e.tagName&&e.tagName.toLowerCase())==="img"?e.remove():et(e)}}function ue(o,t=!0){return o.replace(/`#([^#\s`]+)#`|'#([^#\s']+)#'/g,(e,n,i)=>{const r=n??i,s=Ht(r),a=`${s.category}: ${s.label}`;return t?`[${a}](#${r} "${r}")`:`"${a}"`})}function tt(o){return o&&o.replace(/\n/g,"\\n").replace(/\r/g,"\\r")}let K=class{constructor(t,e){this.viewState=t;this.environmentService=e}filter(t,e){if(this.viewState.filterToCategory&&t instanceof R&&!this.settingContainedInGroup(t.setting,this.viewState.filterToCategory))return!1;if(t instanceof R&&this.viewState.settingsTarget!==j.USER_LOCAL){const n=!!this.environmentService.remoteAuthority;if(!t.matchesScope(this.viewState.settingsTarget,n))return!1}return t instanceof H?typeof t.count=="number"?t.count>0:It.Recurse:!(t instanceof _e&&(this.viewState.tagFilters?.size||this.viewState.filterToCategory))}settingContainedInGroup(t,e){return e.children.some(n=>n instanceof H?this.settingContainedInGroup(t,n):n instanceof R?n.setting.key===t.key:!1)}};K=b([p(1,nn)],K);class Bn extends lt{getTemplateId(t){if(t instanceof H)return Xe;if(t instanceof R)return t.valueType===h.ExtensionToggle?Ye:t.isConfigured&&Ae(t.value,t.setting.type)?Y:t.valueType===h.Boolean?Ge:t.valueType===h.Integer||t.valueType===h.Number||t.valueType===h.NullableInteger||t.valueType===h.NullableNumber?Pe:t.valueType===h.MultilineString?He:t.valueType===h.String?Be:t.valueType===h.Enum?Fe:t.valueType===h.Array?We:t.valueType===h.Exclude?Ue:t.valueType===h.Include?Ke:t.valueType===h.Object?$e:t.valueType===h.BooleanObject?qe:(t.valueType===h.LanguageTag,Y);if(t instanceof _e)return Je;throw new Error("unknown element type: "+t)}hasDynamicHeight(t){return!(t instanceof H)}estimateHeight(t){return t instanceof H?42:t instanceof R&&t.valueType===h.Boolean?78:104}}class Hn extends St{isCollapsible(t){return!1}setCollapsed(t,e,n){return!1}}class Pn{constructor(t,e,n){this.configurationService=t;this.languageService=e;this.userDataProfilesService=n}getAriaLabel(t){if(t instanceof R){const e=[];if(e.push(`${t.displayCategory} ${t.displayLabel}.`),t.isConfigured){const r=f("settings.Modified","Modified.");e.push(r)}const n=Rt(t,this.configurationService,this.userDataProfilesService,this.languageService);n.length&&e.push(`${n}.`);const i=at({value:ue(t.description,!1)});return i.length&&e.push(i),e.join(" ")}else return t instanceof H?t.label:t.id}getWidgetAriaLabel(){return f("settings","Settings")}}let ee=class extends Ot{constructor(t,e,n,i,r,s,a,l,c){super("SettingsTree",t,new Bn,n,{horizontalScrolling:!1,supportDynamicHeights:!0,identityProvider:{getId(d){return d.id}},accessibilityProvider:new Pn(s,l,c),styleController:d=>new ct(u.createStyleSheet(t),d),filter:a.createInstance(K,e),smoothScrolling:s.getValue("workbench.list.smoothScrolling"),multipleSelectionSupport:!1,findWidgetEnabled:!1,renderIndentGuides:mt.None,transformOptimization:!1},a,i,r,s),this.getHTMLElement().classList.add("settings-editor-tree"),this.style(wt({listBackground:x,listActiveSelectionBackground:x,listActiveSelectionForeground:F,listFocusAndSelectionBackground:x,listFocusAndSelectionForeground:F,listFocusBackground:x,listFocusForeground:F,listHoverForeground:F,listHoverBackground:x,listHoverOutline:x,listFocusOutline:x,listInactiveSelectionBackground:x,listInactiveSelectionForeground:F,listInactiveFocusBackground:x,listInactiveFocusOutline:x,treeIndentGuidesStroke:void 0,treeInactiveIndentGuidesStroke:void 0})),this.disposables.add(s.onDidChangeConfiguration(d=>{d.affectsConfiguration("workbench.list.smoothScrolling")&&this.updateOptions({smoothScrolling:s.getValue("workbench.list.smoothScrolling")})}))}createModel(t,e){return new Hn(t,e)}};ee=b([p(3,Lt),p(4,Ct),p(5,Ne),p(6,ae),p(7,ht),p(8,Ce)],ee);let _=class extends B{constructor(e){super(_.ID,_.LABEL);this.clipboardService=e}static ID="settings.copySettingId";static LABEL=f("copySettingIdLabel","Copy Setting ID");async run(e){return e&&await this.clipboardService.writeText(e.setting.key),Promise.resolve(void 0)}};_=b([p(0,oe)],_);let k=class extends B{constructor(e){super(k.ID,k.LABEL);this.clipboardService=e}static ID="settings.copySettingAsJSON";static LABEL=f("copySettingAsJSONLabel","Copy Setting as JSON");async run(e){if(e){const n=`"${e.setting.key}": ${JSON.stringify(e.value,void 0,"  ")}`;await this.clipboardService.writeText(n)}return Promise.resolve(void 0)}};k=b([p(0,oe)],k);let w=class extends B{constructor(e,n){super(w.ID,w.LABEL);this.clipboardService=e;this.productService=n}static ID="settings.copySettingAsURL";static LABEL=f("copySettingAsURLLabel","Copy Setting as URL");async run(e){if(e){const n=e.setting.key,i=this.productService.urlProtocol,r=an.from({scheme:i,authority:sn,path:`/${n}`},!0);await this.clipboardService.writeText(r.toString())}return Promise.resolve(void 0)}};w=b([p(0,oe),p(1,Le)],w);let M=class extends B{constructor(e,n){super(M.ID,M.LABEL);this.setting=e;this.configService=n;this._register(D.filter(n.onDidChangeConfiguration,i=>i.affectsConfiguration("settingsSync.ignoredSettings"))(()=>this.update())),this.update()}static ID="settings.stopSyncingSetting";static LABEL=f("stopSyncingSetting","Sync This Setting");async update(){const e=ce(J(),this.configService);this.checked=!e.includes(this.setting.key)}async run(){let e=[...this.configService.getValue("settingsSync.ignoredSettings")];e=e.filter(s=>s!==this.setting.key&&s!==`-${this.setting.key}`);const i=J().includes(this.setting.key),r=!this.checked;return r&&i&&e.push(`-${this.setting.key}`),!r&&!i&&e.push(this.setting.key),this.configService.updateValue("settingsSync.ignoredSettings",e.length?e:void 0,j.USER),Promise.resolve(void 0)}};M=b([p(1,be)],M);let N=class extends B{constructor(e,n){super(N.ID,N.LABEL);this.setting=e;this.configService=n;this._register(D.filter(n.onDidChangeConfiguration,i=>i.affectsConfiguration(P))(()=>this.update())),this.update()}static ID="settings.applyToAllProfiles";static LABEL=f("applyToAllProfiles","Apply Setting to all Profiles");update(){const e=this.configService.getValue(P);this.checked=e.includes(this.setting.key)}async run(){const e=this.configService.getValue(P)??[];this.checked?e.splice(e.indexOf(this.setting.key),1):e.push(this.setting.key);const n=Tt(e);this.checked?(await this.configService.updateValue(this.setting.key,this.configService.inspect(this.setting.key).application?.value,j.USER_LOCAL),await this.configService.updateValue(P,n.length?n:void 0,j.USER_LOCAL)):(await this.configService.updateValue(P,n.length?n:void 0,j.USER_LOCAL),await this.configService.updateValue(this.setting.key,this.configService.inspect(this.setting.key).userLocal?.value,j.USER_LOCAL))}};N=b([p(1,Ne)],N);export{m as AbstractSettingRenderer,Hn as NonCollapsibleObjectTreeModel,te as SettingComplexRenderer,U as SettingNewExtensionsRenderer,z as SettingTreeRenderers,ee as SettingsTree,K as SettingsTreeFilter,vn as createSettingMatchRegExp,Mr as createTocTreeForExtensionSettings,wr as resolveConfiguredUntrustedSettings,kr as resolveSettingsTree};
