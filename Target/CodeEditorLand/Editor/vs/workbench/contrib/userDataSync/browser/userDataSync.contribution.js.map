{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/userDataSync/browser/userDataSync.contribution.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Action } from \"../../../../base/common/actions.js\";\nimport { Disposable } from \"../../../../base/common/lifecycle.js\";\nimport { isWeb } from \"../../../../base/common/platform.js\";\nimport { localize } from \"../../../../nls.js\";\nimport { ICommandService } from \"../../../../platform/commands/common/commands.js\";\nimport {\n\tINotificationService,\n\tSeverity,\n} from \"../../../../platform/notification/common/notification.js\";\nimport { IProductService } from \"../../../../platform/product/common/productService.js\";\nimport { Registry } from \"../../../../platform/registry/common/platform.js\";\nimport {\n\tIUserDataAutoSyncService,\n\ttype UserDataSyncError,\n\tUserDataSyncErrorCode,\n} from \"../../../../platform/userDataSync/common/userDataSync.js\";\nimport {\n\ttype IWorkbenchContribution,\n\ttype IWorkbenchContributionsRegistry,\n\tExtensions as WorkbenchExtensions,\n} from \"../../../common/contributions.js\";\nimport { IHostService } from \"../../../services/host/browser/host.js\";\nimport { LifecyclePhase } from \"../../../services/lifecycle/common/lifecycle.js\";\nimport { SHOW_SYNC_LOG_COMMAND_ID } from \"../../../services/userDataSync/common/userDataSync.js\";\nimport { UserDataSyncWorkbenchContribution } from \"./userDataSync.js\";\nimport { UserDataSyncTrigger } from \"./userDataSyncTrigger.js\";\n\nclass UserDataSyncReportIssueContribution\n\textends Disposable\n\timplements IWorkbenchContribution\n{\n\tconstructor(\n\t\t@IUserDataAutoSyncService userDataAutoSyncService: IUserDataAutoSyncService,\n\t\t@INotificationService private readonly notificationService: INotificationService,\n\t\t@IProductService private readonly productService: IProductService,\n\t\t@ICommandService private readonly commandService: ICommandService,\n\t\t@IHostService private readonly hostService: IHostService,\n\t) {\n\t\tsuper();\n\t\tthis._register(userDataAutoSyncService.onError(error => this.onAutoSyncError(error)));\n\t}\n\n\tprivate onAutoSyncError(error: UserDataSyncError): void {\n\t\tswitch (error.code) {\n\t\t\tcase UserDataSyncErrorCode.LocalTooManyRequests: {\n\t\t\t\tconst message = isWeb\n\t\t\t\t\t? localize(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tkey: \"local too many requests - reload\",\n\t\t\t\t\t\t\t\tcomment: [\n\t\t\t\t\t\t\t\t\t\"Settings Sync is the name of the feature\",\n\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\"Settings sync is suspended temporarily because the current device is making too many requests. Please reload {0} to resume.\",\n\t\t\t\t\t\t\tthis.productService.nameLong,\n\t\t\t\t\t\t)\n\t\t\t\t\t: localize(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tkey: \"local too many requests - restart\",\n\t\t\t\t\t\t\t\tcomment: [\n\t\t\t\t\t\t\t\t\t\"Settings Sync is the name of the feature\",\n\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\"Settings sync is suspended temporarily because the current device is making too many requests. Please restart {0} to resume.\",\n\t\t\t\t\t\t\tthis.productService.nameLong,\n\t\t\t\t\t\t);\n\t\t\t\tthis.notificationService.notify({\n\t\t\t\t\tseverity: Severity.Error,\n\t\t\t\t\tmessage,\n\t\t\t\t\tactions: {\n\t\t\t\t\t\tprimary: [\n\t\t\t\t\t\t\tnew Action(\n\t\t\t\t\t\t\t\t\"Show Sync Logs\",\n\t\t\t\t\t\t\t\tlocalize(\"show sync logs\", \"Show Log\"),\n\t\t\t\t\t\t\t\tundefined,\n\t\t\t\t\t\t\t\ttrue,\n\t\t\t\t\t\t\t\t() =>\n\t\t\t\t\t\t\t\t\tthis.commandService.executeCommand(\n\t\t\t\t\t\t\t\t\t\tSHOW_SYNC_LOG_COMMAND_ID,\n\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\tnew Action(\n\t\t\t\t\t\t\t\t\"Restart\",\n\t\t\t\t\t\t\t\tisWeb\n\t\t\t\t\t\t\t\t\t? localize(\"reload\", \"Reload\")\n\t\t\t\t\t\t\t\t\t: localize(\"restart\", \"Restart\"),\n\t\t\t\t\t\t\t\tundefined,\n\t\t\t\t\t\t\t\ttrue,\n\t\t\t\t\t\t\t\t() => this.hostService.restart(),\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t],\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tcase UserDataSyncErrorCode.TooManyRequests: {\n\t\t\t\tconst operationId = error.operationId\n\t\t\t\t\t? localize(\n\t\t\t\t\t\t\t\"operationId\",\n\t\t\t\t\t\t\t\"Operation Id: {0}\",\n\t\t\t\t\t\t\terror.operationId,\n\t\t\t\t\t\t)\n\t\t\t\t\t: undefined;\n\t\t\t\tconst message = localize(\n\t\t\t\t\t{\n\t\t\t\t\t\tkey: \"server too many requests\",\n\t\t\t\t\t\tcomment: [\"Settings Sync is the name of the feature\"],\n\t\t\t\t\t},\n\t\t\t\t\t\"Settings sync is disabled because the current device is making too many requests. Please wait for 10 minutes and turn on sync.\",\n\t\t\t\t);\n\t\t\t\tthis.notificationService.notify({\n\t\t\t\t\tseverity: Severity.Error,\n\t\t\t\t\tmessage: operationId\n\t\t\t\t\t\t? `${message} ${operationId}`\n\t\t\t\t\t\t: message,\n\t\t\t\t\tsource: error.operationId\n\t\t\t\t\t\t? localize(\n\t\t\t\t\t\t\t\t\"settings sync\",\n\t\t\t\t\t\t\t\t\"Settings Sync. Operation Id: {0}\",\n\t\t\t\t\t\t\t\terror.operationId,\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t: undefined,\n\t\t\t\t\tactions: {\n\t\t\t\t\t\tprimary: [\n\t\t\t\t\t\t\tnew Action(\n\t\t\t\t\t\t\t\t\"Show Sync Logs\",\n\t\t\t\t\t\t\t\tlocalize(\"show sync logs\", \"Show Log\"),\n\t\t\t\t\t\t\t\tundefined,\n\t\t\t\t\t\t\t\ttrue,\n\t\t\t\t\t\t\t\t() =>\n\t\t\t\t\t\t\t\t\tthis.commandService.executeCommand(\n\t\t\t\t\t\t\t\t\t\tSHOW_SYNC_LOG_COMMAND_ID,\n\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t],\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n}\n\nconst workbenchRegistry = Registry.as<IWorkbenchContributionsRegistry>(\n\tWorkbenchExtensions.Workbench,\n);\nworkbenchRegistry.registerWorkbenchContribution(\n\tUserDataSyncWorkbenchContribution,\n\tLifecyclePhase.Restored,\n);\nworkbenchRegistry.registerWorkbenchContribution(\n\tUserDataSyncTrigger,\n\tLifecyclePhase.Eventually,\n);\nworkbenchRegistry.registerWorkbenchContribution(\n\tUserDataSyncReportIssueContribution,\n\tLifecyclePhase.Eventually,\n);\n"],
  "mappings": "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",
  "names": []
}
