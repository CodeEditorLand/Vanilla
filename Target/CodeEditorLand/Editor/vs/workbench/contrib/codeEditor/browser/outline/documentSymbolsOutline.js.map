{
  "version": 3,
  "sources": ["../../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/codeEditor/browser/outline/documentSymbolsOutline.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Emitter, Event } from '../../../../../base/common/event.js';\nimport { Disposable, DisposableStore, IDisposable, toDisposable } from '../../../../../base/common/lifecycle.js';\nimport { OutlineConfigCollapseItemsValues, IBreadcrumbsDataSource, IOutline, IOutlineCreator, IOutlineListConfig, IOutlineService, OutlineChangeEvent, OutlineConfigKeys, OutlineTarget, } from '../../../../services/outline/browser/outline.js';\nimport { IWorkbenchContributionsRegistry, Extensions as WorkbenchExtensions } from '../../../../common/contributions.js';\nimport { Registry } from '../../../../../platform/registry/common/platform.js';\nimport { LifecyclePhase } from '../../../../services/lifecycle/common/lifecycle.js';\nimport { IEditorPane } from '../../../../common/editor.js';\nimport { DocumentSymbolComparator, DocumentSymbolAccessibilityProvider, DocumentSymbolRenderer, DocumentSymbolFilter, DocumentSymbolGroupRenderer, DocumentSymbolIdentityProvider, DocumentSymbolNavigationLabelProvider, DocumentSymbolVirtualDelegate } from './documentSymbolsTree.js';\nimport { ICodeEditor, isCodeEditor, isDiffEditor } from '../../../../../editor/browser/editorBrowser.js';\nimport { OutlineGroup, OutlineElement, OutlineModel, TreeElement, IOutlineMarker, IOutlineModelService } from '../../../../../editor/contrib/documentSymbols/browser/outlineModel.js';\nimport { CancellationToken, CancellationTokenSource } from '../../../../../base/common/cancellation.js';\nimport { raceCancellation, TimeoutTimer, timeout, Barrier } from '../../../../../base/common/async.js';\nimport { onUnexpectedError } from '../../../../../base/common/errors.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { ITextModel } from '../../../../../editor/common/model.js';\nimport { ITextResourceConfigurationService } from '../../../../../editor/common/services/textResourceConfiguration.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { IPosition } from '../../../../../editor/common/core/position.js';\nimport { ScrollType } from '../../../../../editor/common/editorCommon.js';\nimport { Range } from '../../../../../editor/common/core/range.js';\nimport { IEditorOptions, TextEditorSelectionRevealType } from '../../../../../platform/editor/common/editor.js';\nimport { ICodeEditorService } from '../../../../../editor/browser/services/codeEditorService.js';\nimport { IModelContentChangedEvent } from '../../../../../editor/common/textModelEvents.js';\nimport { IDataSource } from '../../../../../base/browser/ui/tree/tree.js';\nimport { IConfigurationService } from '../../../../../platform/configuration/common/configuration.js';\nimport { localize } from '../../../../../nls.js';\nimport { IMarkerDecorationsService } from '../../../../../editor/common/services/markerDecorations.js';\nimport { MarkerSeverity } from '../../../../../platform/markers/common/markers.js';\nimport { isEqual } from '../../../../../base/common/resources.js';\nimport { ILanguageFeaturesService } from '../../../../../editor/common/services/languageFeatures.js';\n\ntype DocumentSymbolItem = OutlineGroup | OutlineElement;\n\nclass DocumentSymbolBreadcrumbsSource implements IBreadcrumbsDataSource<DocumentSymbolItem> {\n\n\tprivate _breadcrumbs: (OutlineGroup | OutlineElement)[] = [];\n\n\tconstructor(\n\t\tprivate readonly _editor: ICodeEditor,\n\t\t@ITextResourceConfigurationService private readonly _textResourceConfigurationService: ITextResourceConfigurationService,\n\t) { }\n\n\tgetBreadcrumbElements(): readonly DocumentSymbolItem[] {\n\t\treturn this._breadcrumbs;\n\t}\n\n\tclear(): void {\n\t\tthis._breadcrumbs = [];\n\t}\n\n\tupdate(model: OutlineModel, position: IPosition): void {\n\t\tconst newElements = this._computeBreadcrumbs(model, position);\n\t\tthis._breadcrumbs = newElements;\n\t}\n\n\tprivate _computeBreadcrumbs(model: OutlineModel, position: IPosition): Array<OutlineGroup | OutlineElement> {\n\t\tlet item: OutlineGroup | OutlineElement | undefined = model.getItemEnclosingPosition(position);\n\t\tif (!item) {\n\t\t\treturn [];\n\t\t}\n\t\tconst chain: Array<OutlineGroup | OutlineElement> = [];\n\t\twhile (item) {\n\t\t\tchain.push(item);\n\t\t\tconst parent: any = item.parent;\n\t\t\tif (parent instanceof OutlineModel) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (parent instanceof OutlineGroup && parent.parent && parent.parent.children.size === 1) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\titem = parent;\n\t\t}\n\t\tconst result: Array<OutlineGroup | OutlineElement> = [];\n\t\tfor (let i = chain.length - 1; i >= 0; i--) {\n\t\t\tconst element = chain[i];\n\t\t\tif (this._isFiltered(element)) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tresult.push(element);\n\t\t}\n\t\tif (result.length === 0) {\n\t\t\treturn [];\n\t\t}\n\t\treturn result;\n\t}\n\n\tprivate _isFiltered(element: TreeElement): boolean {\n\t\tif (!(element instanceof OutlineElement)) {\n\t\t\treturn false;\n\t\t}\n\t\tconst key = `breadcrumbs.${DocumentSymbolFilter.kindToConfigName[element.symbol.kind]}`;\n\t\tlet uri: URI | undefined;\n\t\tif (this._editor && this._editor.getModel()) {\n\t\t\tconst model = this._editor.getModel() as ITextModel;\n\t\t\turi = model.uri;\n\t\t}\n\t\treturn !this._textResourceConfigurationService.getValue<boolean>(uri, key);\n\t}\n}\n\n\nclass DocumentSymbolsOutline implements IOutline<DocumentSymbolItem> {\n\n\tprivate readonly _disposables = new DisposableStore();\n\tprivate readonly _onDidChange = new Emitter<OutlineChangeEvent>();\n\n\treadonly onDidChange: Event<OutlineChangeEvent> = this._onDidChange.event;\n\n\tprivate _outlineModel?: OutlineModel;\n\tprivate readonly _outlineDisposables = new DisposableStore();\n\n\tprivate readonly _breadcrumbsDataSource: DocumentSymbolBreadcrumbsSource;\n\n\treadonly config: IOutlineListConfig<DocumentSymbolItem>;\n\n\treadonly outlineKind = 'documentSymbols';\n\n\tget activeElement(): DocumentSymbolItem | undefined {\n\t\tconst posistion = this._editor.getPosition();\n\t\tif (!posistion || !this._outlineModel) {\n\t\t\treturn undefined;\n\t\t} else {\n\t\t\treturn this._outlineModel.getItemEnclosingPosition(posistion);\n\t\t}\n\t}\n\n\tconstructor(\n\t\tprivate readonly _editor: ICodeEditor,\n\t\ttarget: OutlineTarget,\n\t\tfirstLoadBarrier: Barrier,\n\t\t@ILanguageFeaturesService private readonly _languageFeaturesService: ILanguageFeaturesService,\n\t\t@ICodeEditorService private readonly _codeEditorService: ICodeEditorService,\n\t\t@IOutlineModelService private readonly _outlineModelService: IOutlineModelService,\n\t\t@IConfigurationService private readonly _configurationService: IConfigurationService,\n\t\t@IMarkerDecorationsService private readonly _markerDecorationsService: IMarkerDecorationsService,\n\t\t@ITextResourceConfigurationService textResourceConfigurationService: ITextResourceConfigurationService,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t) {\n\n\t\tthis._breadcrumbsDataSource = new DocumentSymbolBreadcrumbsSource(_editor, textResourceConfigurationService);\n\t\tconst delegate = new DocumentSymbolVirtualDelegate();\n\t\tconst renderers = [new DocumentSymbolGroupRenderer(), instantiationService.createInstance(DocumentSymbolRenderer, true, target)];\n\t\tconst treeDataSource: IDataSource<this, DocumentSymbolItem> = {\n\t\t\tgetChildren: (parent) => {\n\t\t\t\tif (parent instanceof OutlineElement || parent instanceof OutlineGroup) {\n\t\t\t\t\treturn parent.children.values();\n\t\t\t\t}\n\t\t\t\tif (parent === this && this._outlineModel) {\n\t\t\t\t\treturn this._outlineModel.children.values();\n\t\t\t\t}\n\t\t\t\treturn [];\n\t\t\t}\n\t\t};\n\t\tconst comparator = new DocumentSymbolComparator();\n\t\tconst initialState = textResourceConfigurationService.getValue<OutlineConfigCollapseItemsValues>(_editor.getModel()?.uri, OutlineConfigKeys.collapseItems);\n\t\tconst options = {\n\t\t\tcollapseByDefault: target === OutlineTarget.Breadcrumbs || (target === OutlineTarget.OutlinePane && initialState === OutlineConfigCollapseItemsValues.Collapsed),\n\t\t\texpandOnlyOnTwistieClick: true,\n\t\t\tmultipleSelectionSupport: false,\n\t\t\tidentityProvider: new DocumentSymbolIdentityProvider(),\n\t\t\tkeyboardNavigationLabelProvider: new DocumentSymbolNavigationLabelProvider(),\n\t\t\taccessibilityProvider: new DocumentSymbolAccessibilityProvider(localize('document', \"Document Symbols\")),\n\t\t\tfilter: target === OutlineTarget.OutlinePane\n\t\t\t\t? instantiationService.createInstance(DocumentSymbolFilter, 'outline')\n\t\t\t\t: target === OutlineTarget.Breadcrumbs\n\t\t\t\t\t? instantiationService.createInstance(DocumentSymbolFilter, 'breadcrumbs')\n\t\t\t\t\t: undefined\n\t\t};\n\n\t\tthis.config = {\n\t\t\tbreadcrumbsDataSource: this._breadcrumbsDataSource,\n\t\t\tdelegate,\n\t\t\trenderers,\n\t\t\ttreeDataSource,\n\t\t\tcomparator,\n\t\t\toptions,\n\t\t\tquickPickDataSource: { getQuickPickElements: () => { throw new Error('not implemented'); } }\n\t\t};\n\n\n\t\t// update as language, model, providers changes\n\t\tthis._disposables.add(_languageFeaturesService.documentSymbolProvider.onDidChange(_ => this._createOutline()));\n\t\tthis._disposables.add(this._editor.onDidChangeModel(_ => this._createOutline()));\n\t\tthis._disposables.add(this._editor.onDidChangeModelLanguage(_ => this._createOutline()));\n\n\t\t// update soon'ish as model content change\n\t\tconst updateSoon = new TimeoutTimer();\n\t\tthis._disposables.add(updateSoon);\n\t\tthis._disposables.add(this._editor.onDidChangeModelContent(event => {\n\t\t\tconst model = this._editor.getModel();\n\t\t\tif (model) {\n\t\t\t\tconst timeout = _outlineModelService.getDebounceValue(model);\n\t\t\t\tupdateSoon.cancelAndSet(() => this._createOutline(event), timeout);\n\t\t\t}\n\t\t}));\n\n\t\t// stop when editor dies\n\t\tthis._disposables.add(this._editor.onDidDispose(() => this._outlineDisposables.clear()));\n\n\t\t// initial load\n\t\tthis._createOutline().finally(() => firstLoadBarrier.open());\n\t}\n\n\tdispose(): void {\n\t\tthis._disposables.dispose();\n\t\tthis._outlineDisposables.dispose();\n\t}\n\n\tget isEmpty(): boolean {\n\t\treturn !this._outlineModel || TreeElement.empty(this._outlineModel);\n\t}\n\n\tget uri() {\n\t\treturn this._outlineModel?.uri;\n\t}\n\n\tasync reveal(entry: DocumentSymbolItem, options: IEditorOptions, sideBySide: boolean, select: boolean): Promise<void> {\n\t\tconst model = OutlineModel.get(entry);\n\t\tif (!model || !(entry instanceof OutlineElement)) {\n\t\t\treturn;\n\t\t}\n\t\tawait this._codeEditorService.openCodeEditor({\n\t\t\tresource: model.uri,\n\t\t\toptions: {\n\t\t\t\t...options,\n\t\t\t\tselection: select ? entry.symbol.range : Range.collapseToStart(entry.symbol.selectionRange),\n\t\t\t\tselectionRevealType: TextEditorSelectionRevealType.NearTopIfOutsideViewport,\n\t\t\t}\n\t\t}, this._editor, sideBySide);\n\t}\n\n\tpreview(entry: DocumentSymbolItem): IDisposable {\n\t\tif (!(entry instanceof OutlineElement)) {\n\t\t\treturn Disposable.None;\n\t\t}\n\n\t\tconst { symbol } = entry;\n\t\tthis._editor.revealRangeInCenterIfOutsideViewport(symbol.range, ScrollType.Smooth);\n\t\tconst decorationsCollection = this._editor.createDecorationsCollection([{\n\t\t\trange: symbol.range,\n\t\t\toptions: {\n\t\t\t\tdescription: 'document-symbols-outline-range-highlight',\n\t\t\t\tclassName: 'rangeHighlight',\n\t\t\t\tisWholeLine: true\n\t\t\t}\n\t\t}]);\n\t\treturn toDisposable(() => decorationsCollection.clear());\n\t}\n\n\tcaptureViewState(): IDisposable {\n\t\tconst viewState = this._editor.saveViewState();\n\t\treturn toDisposable(() => {\n\t\t\tif (viewState) {\n\t\t\t\tthis._editor.restoreViewState(viewState);\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate async _createOutline(contentChangeEvent?: IModelContentChangedEvent): Promise<void> {\n\n\t\tthis._outlineDisposables.clear();\n\t\tif (!contentChangeEvent) {\n\t\t\tthis._setOutlineModel(undefined);\n\t\t}\n\n\t\tif (!this._editor.hasModel()) {\n\t\t\treturn;\n\t\t}\n\t\tconst buffer = this._editor.getModel();\n\t\tif (!this._languageFeaturesService.documentSymbolProvider.has(buffer)) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst cts = new CancellationTokenSource();\n\t\tconst versionIdThen = buffer.getVersionId();\n\t\tconst timeoutTimer = new TimeoutTimer();\n\n\t\tthis._outlineDisposables.add(timeoutTimer);\n\t\tthis._outlineDisposables.add(toDisposable(() => cts.dispose(true)));\n\n\t\ttry {\n\t\t\tconst model = await this._outlineModelService.getOrCreate(buffer, cts.token);\n\t\t\tif (cts.token.isCancellationRequested) {\n\t\t\t\t// cancelled -> do nothing\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (TreeElement.empty(model) || !this._editor.hasModel()) {\n\t\t\t\t// empty -> no outline elements\n\t\t\t\tthis._setOutlineModel(model);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// heuristic: when the symbols-to-lines ratio changes by 50% between edits\n\t\t\t// wait a little (and hope that the next change isn't as drastic).\n\t\t\tif (contentChangeEvent && this._outlineModel && buffer.getLineCount() >= 25) {\n\t\t\t\tconst newSize = TreeElement.size(model);\n\t\t\t\tconst newLength = buffer.getValueLength();\n\t\t\t\tconst newRatio = newSize / newLength;\n\t\t\t\tconst oldSize = TreeElement.size(this._outlineModel);\n\t\t\t\tconst oldLength = newLength - contentChangeEvent.changes.reduce((prev, value) => prev + value.rangeLength, 0);\n\t\t\t\tconst oldRatio = oldSize / oldLength;\n\t\t\t\tif (newRatio <= oldRatio * 0.5 || newRatio >= oldRatio * 1.5) {\n\t\t\t\t\t// wait for a better state and ignore current model when more\n\t\t\t\t\t// typing has happened\n\t\t\t\t\tconst value = await raceCancellation(timeout(2000).then(() => true), cts.token, false);\n\t\t\t\t\tif (!value) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// feature: show markers with outline element\n\t\t\tthis._applyMarkersToOutline(model);\n\t\t\tthis._outlineDisposables.add(this._markerDecorationsService.onDidChangeMarker(textModel => {\n\t\t\t\tif (isEqual(model.uri, textModel.uri)) {\n\t\t\t\t\tthis._applyMarkersToOutline(model);\n\t\t\t\t\tthis._onDidChange.fire({});\n\t\t\t\t}\n\t\t\t}));\n\t\t\tthis._outlineDisposables.add(this._configurationService.onDidChangeConfiguration(e => {\n\t\t\t\tif (e.affectsConfiguration(OutlineConfigKeys.problemsEnabled) || e.affectsConfiguration('problems.visibility')) {\n\t\t\t\t\tconst problem = this._configurationService.getValue('problems.visibility');\n\t\t\t\t\tconst config = this._configurationService.getValue(OutlineConfigKeys.problemsEnabled);\n\n\t\t\t\t\tif (!problem || !config) {\n\t\t\t\t\t\tmodel.updateMarker([]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis._applyMarkersToOutline(model);\n\t\t\t\t\t}\n\t\t\t\t\tthis._onDidChange.fire({});\n\t\t\t\t}\n\t\t\t\tif (e.affectsConfiguration('outline')) {\n\t\t\t\t\t// outline filtering, problems on/off\n\t\t\t\t\tthis._onDidChange.fire({});\n\t\t\t\t}\n\t\t\t\tif (e.affectsConfiguration('breadcrumbs') && this._editor.hasModel()) {\n\t\t\t\t\t// breadcrumbs filtering\n\t\t\t\t\tthis._breadcrumbsDataSource.update(model, this._editor.getPosition());\n\t\t\t\t\tthis._onDidChange.fire({});\n\t\t\t\t}\n\t\t\t}));\n\n\t\t\t// feature: toggle icons\n\t\t\tthis._outlineDisposables.add(this._configurationService.onDidChangeConfiguration(e => {\n\t\t\t\tif (e.affectsConfiguration(OutlineConfigKeys.icons)) {\n\t\t\t\t\tthis._onDidChange.fire({});\n\t\t\t\t}\n\t\t\t\tif (e.affectsConfiguration('outline')) {\n\t\t\t\t\tthis._onDidChange.fire({});\n\t\t\t\t}\n\t\t\t}));\n\n\t\t\t// feature: update active when cursor changes\n\t\t\tthis._outlineDisposables.add(this._editor.onDidChangeCursorPosition(_ => {\n\t\t\t\ttimeoutTimer.cancelAndSet(() => {\n\t\t\t\t\tif (!buffer.isDisposed() && versionIdThen === buffer.getVersionId() && this._editor.hasModel()) {\n\t\t\t\t\t\tthis._breadcrumbsDataSource.update(model, this._editor.getPosition());\n\t\t\t\t\t\tthis._onDidChange.fire({ affectOnlyActiveElement: true });\n\t\t\t\t\t}\n\t\t\t\t}, 150);\n\t\t\t}));\n\n\t\t\t// update properties, send event\n\t\t\tthis._setOutlineModel(model);\n\n\t\t} catch (err) {\n\t\t\tthis._setOutlineModel(undefined);\n\t\t\tonUnexpectedError(err);\n\t\t}\n\t}\n\n\tprivate _applyMarkersToOutline(model: OutlineModel | undefined): void {\n\t\tconst problem = this._configurationService.getValue('problems.visibility');\n\t\tconst config = this._configurationService.getValue(OutlineConfigKeys.problemsEnabled);\n\t\tif (!model || !problem || !config) {\n\t\t\treturn;\n\t\t}\n\t\tconst markers: IOutlineMarker[] = [];\n\t\tfor (const [range, marker] of this._markerDecorationsService.getLiveMarkers(model.uri)) {\n\t\t\tif (marker.severity === MarkerSeverity.Error || marker.severity === MarkerSeverity.Warning) {\n\t\t\t\tmarkers.push({ ...range, severity: marker.severity });\n\t\t\t}\n\t\t}\n\t\tmodel.updateMarker(markers);\n\t}\n\n\tprivate _setOutlineModel(model: OutlineModel | undefined) {\n\t\tconst position = this._editor.getPosition();\n\t\tif (!position || !model) {\n\t\t\tthis._outlineModel = undefined;\n\t\t\tthis._breadcrumbsDataSource.clear();\n\t\t} else {\n\t\t\tif (!this._outlineModel?.merge(model)) {\n\t\t\t\tthis._outlineModel = model;\n\t\t\t}\n\t\t\tthis._breadcrumbsDataSource.update(model, position);\n\t\t}\n\t\tthis._onDidChange.fire({});\n\t}\n}\n\nclass DocumentSymbolsOutlineCreator implements IOutlineCreator<IEditorPane, DocumentSymbolItem> {\n\n\treadonly dispose: () => void;\n\n\tconstructor(\n\t\t@IOutlineService outlineService: IOutlineService\n\t) {\n\t\tconst reg = outlineService.registerOutlineCreator(this);\n\t\tthis.dispose = () => reg.dispose();\n\t}\n\n\tmatches(candidate: IEditorPane): candidate is IEditorPane {\n\t\tconst ctrl = candidate.getControl();\n\t\treturn isCodeEditor(ctrl) || isDiffEditor(ctrl);\n\t}\n\n\tasync createOutline(pane: IEditorPane, target: OutlineTarget, _token: CancellationToken): Promise<IOutline<DocumentSymbolItem> | undefined> {\n\t\tconst control = pane.getControl();\n\t\tlet editor: ICodeEditor | undefined;\n\t\tif (isCodeEditor(control)) {\n\t\t\teditor = control;\n\t\t} else if (isDiffEditor(control)) {\n\t\t\teditor = control.getModifiedEditor();\n\t\t}\n\t\tif (!editor) {\n\t\t\treturn undefined;\n\t\t}\n\t\tconst firstLoadBarrier = new Barrier();\n\t\tconst result = editor.invokeWithinContext(accessor => accessor.get(IInstantiationService).createInstance(DocumentSymbolsOutline, editor, target, firstLoadBarrier));\n\t\tawait firstLoadBarrier.wait();\n\t\treturn result;\n\t}\n}\n\nRegistry.as<IWorkbenchContributionsRegistry>(WorkbenchExtensions.Workbench).registerWorkbenchContribution(DocumentSymbolsOutlineCreator, LifecyclePhase.Eventually);\n"],
  "mappings": "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",
  "names": ["timeout"]
}
