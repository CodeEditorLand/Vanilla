var w=Object.defineProperty;var D=Object.getOwnPropertyDescriptor;var g=(i,e,o,t)=>{for(var n=t>1?void 0:t?D(e,o):e,s=i.length-1,l;s>=0;s--)(l=i[s])&&(n=(t?l(e,o,n):l(n))||n);return t&&n&&w(e,o,n),n},d=(i,e)=>(o,t)=>e(o,t,i);import"./documentSymbolsTree.css";import"../../../../../editor/contrib/symbolIcons/browser/symbolIcons.js";import*as a from"../../../../../base/browser/dom.js";import{HighlightedLabel as L}from"../../../../../base/browser/ui/highlightedlabel/highlightedLabel.js";import"../../../../../base/browser/ui/list/list.js";import"../../../../../base/browser/ui/tree/tree.js";import{createMatches as I}from"../../../../../base/common/filters.js";import{Range as v}from"../../../../../editor/common/core/range.js";import{SymbolKind as r,SymbolKinds as C,SymbolTag as O,getAriaLabelForSymbol as _,symbolKindNames as E}from"../../../../../editor/common/languages.js";import{OutlineElement as c,OutlineGroup as m,OutlineModel as N}from"../../../../../editor/contrib/documentSymbols/browser/outlineModel.js";import{localize as p}from"../../../../../nls.js";import{IconLabel as P}from"../../../../../base/browser/ui/iconLabel/iconLabel.js";import{IConfigurationService as x}from"../../../../../platform/configuration/common/configuration.js";import{MarkerSeverity as M}from"../../../../../platform/markers/common/markers.js";import{IThemeService as k}from"../../../../../platform/theme/common/themeService.js";import{listErrorForeground as V,listWarningForeground as z}from"../../../../../platform/theme/common/colorRegistry.js";import{ITextResourceConfigurationService as F}from"../../../../../editor/common/services/textResourceConfiguration.js";import"../../../../../base/browser/ui/list/listWidget.js";import{OutlineConfigKeys as f}from"../../../../services/outline/browser/outline.js";import{ThemeIcon as G}from"../../../../../base/common/themables.js";import{mainWindow as H}from"../../../../../base/browser/window.js";class Se{getKeyboardNavigationLabel(e){return e instanceof m?e.label:e.symbol.name}}class Ie{constructor(e){this._ariaLabel=e}getWidgetAriaLabel(){return this._ariaLabel}getAriaLabel(e){return e instanceof m?e.label:_(e.symbol.name,e.symbol.kind)}}class ve{getId(e){return e.id}}class h{constructor(e,o){this.labelContainer=e;this.label=o}static id="DocumentSymbolGroupTemplate";dispose(){this.label.dispose()}}class S{constructor(e,o,t,n){this.container=e;this.iconLabel=o;this.iconClass=t;this.decoration=n}static id="DocumentSymbolTemplate"}class Te{getHeight(e){return 22}getTemplateId(e){return e instanceof m?h.id:S.id}}class we{templateId=h.id;renderTemplate(e){const o=a.$(".outline-element-label");return e.classList.add("outline-element"),a.append(e,o),new h(o,new L(o))}renderElement(e,o,t){t.label.set(e.element.label,I(e.filterData))}disposeTemplate(e){e.dispose()}}let b=class{constructor(e,o,t,n){this._renderMarker=e;this._configurationService=t;this._themeService=n}templateId=S.id;renderTemplate(e){e.classList.add("outline-element");const o=new P(e,{supportHighlights:!0}),t=a.$(".outline-element-icon"),n=a.$(".outline-element-decoration");return e.prepend(t),e.appendChild(n),new S(e,o,t,n)}renderElement(e,o,t){const{element:n}=e,s=["nowrap"],l={matches:I(e.filterData),labelEscapeNewLines:!0,extraClasses:s,title:p("title.template","{0} ({1})",n.symbol.name,E[n.symbol.kind])};this._configurationService.getValue(f.icons)&&(t.iconClass.className="",t.iconClass.classList.add("outline-element-icon","inline",...G.asClassNameArray(C.toIcon(n.symbol.kind)))),n.symbol.tags.indexOf(O.Deprecated)>=0&&(s.push("deprecated"),l.matches=[]),t.iconLabel.setLabel(n.symbol.name,n.symbol.detail,l),this._renderMarker&&this._renderMarkerInfo(n,t)}_renderMarkerInfo(e,o){if(!e.marker){a.hide(o.decoration),o.container.style.removeProperty("--outline-element-color");return}const{count:t,topSev:n}=e.marker,s=this._themeService.getColorTheme().getColor(n===M.Error?V:z),l=s?s.toString():"inherit",y=this._configurationService.getValue("problems.visibility"),T=this._configurationService.getValue(f.problemsColors);if(!y||!T?o.container.style.removeProperty("--outline-element-color"):o.container.style.setProperty("--outline-element-color",l),y===void 0)return;!this._configurationService.getValue(f.problemsBadges)||!y?a.hide(o.decoration):t>0?(a.show(o.decoration),o.decoration.classList.remove("bubble"),o.decoration.innerText=t<10?t.toString():"+9",o.decoration.title=t===1?p("1.problem","1 problem in this element"):p("N.problem","{0} problems in this element",t),o.decoration.style.setProperty("--outline-element-color",l)):(a.show(o.decoration),o.decoration.classList.add("bubble"),o.decoration.innerText="\uEA71",o.decoration.title=p("deep.problem","Contains elements with problems"),o.decoration.style.setProperty("--outline-element-color",l))}disposeTemplate(e){e.iconLabel.dispose()}};b=g([d(2,x),d(3,k)],b);let u=class{constructor(e,o){this._prefix=e;this._textResourceConfigService=o}static kindToConfigName=Object.freeze({[r.File]:"showFiles",[r.Module]:"showModules",[r.Namespace]:"showNamespaces",[r.Package]:"showPackages",[r.Class]:"showClasses",[r.Method]:"showMethods",[r.Property]:"showProperties",[r.Field]:"showFields",[r.Constructor]:"showConstructors",[r.Enum]:"showEnums",[r.Interface]:"showInterfaces",[r.Function]:"showFunctions",[r.Variable]:"showVariables",[r.Constant]:"showConstants",[r.String]:"showStrings",[r.Number]:"showNumbers",[r.Boolean]:"showBooleans",[r.Array]:"showArrays",[r.Object]:"showObjects",[r.Key]:"showKeys",[r.Null]:"showNull",[r.EnumMember]:"showEnumMembers",[r.Struct]:"showStructs",[r.Event]:"showEvents",[r.Operator]:"showOperators",[r.TypeParameter]:"showTypeParameters"});filter(e){const o=N.get(e);if(!(e instanceof c))return!0;const t=u.kindToConfigName[e.symbol.kind],n=`${this._prefix}.${t}`;return this._textResourceConfigService.getValue(o?.uri,n)}};u=g([d(1,F)],u);class De{_collator=new a.WindowIdleValue(H,()=>new Intl.Collator(void 0,{numeric:!0}));compareByPosition(e,o){return e instanceof m&&o instanceof m?e.order-o.order:e instanceof c&&o instanceof c?v.compareRangesUsingStarts(e.symbol.range,o.symbol.range)||this._collator.value.compare(e.symbol.name,o.symbol.name):0}compareByType(e,o){return e instanceof m&&o instanceof m?e.order-o.order:e instanceof c&&o instanceof c?e.symbol.kind-o.symbol.kind||this._collator.value.compare(e.symbol.name,o.symbol.name):0}compareByName(e,o){return e instanceof m&&o instanceof m?e.order-o.order:e instanceof c&&o instanceof c?this._collator.value.compare(e.symbol.name,o.symbol.name)||v.compareRangesUsingStarts(e.symbol.range,o.symbol.range):0}}export{Ie as DocumentSymbolAccessibilityProvider,De as DocumentSymbolComparator,u as DocumentSymbolFilter,we as DocumentSymbolGroupRenderer,ve as DocumentSymbolIdentityProvider,Se as DocumentSymbolNavigationLabelProvider,b as DocumentSymbolRenderer,Te as DocumentSymbolVirtualDelegate};
