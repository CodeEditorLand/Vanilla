var p=Object.defineProperty;var E=Object.getOwnPropertyDescriptor;var l=(s,n,t,e)=>{for(var i=e>1?void 0:e?E(n,t):n,c=s.length-1,a;c>=0;c--)(a=s[c])&&(i=(e?a(n,t,i):a(i))||i);return e&&i&&p(n,t,i),i},o=(s,n)=>(t,e)=>n(t,e,s);import{Disposable as b}from"../../../../base/common/lifecycle.js";import*as v from"../../../../nls.js";import{Action2 as x,registerAction2 as S}from"../../../../platform/actions/common/actions.js";import{ICommandService as y}from"../../../../platform/commands/common/commands.js";import{IContextKeyService as f,RawContextKey as I}from"../../../../platform/contextkey/common/contextkey.js";import{IExtensionManagementService as u}from"../../../../platform/extensionManagement/common/extensionManagement.js";import{ExtensionIdentifier as h}from"../../../../platform/extensions/common/extensions.js";import{IProductService as C}from"../../../../platform/product/common/productService.js";import{ITelemetryService as A}from"../../../../platform/telemetry/common/telemetry.js";import{IWorkbenchExtensionEnablementService as g}from"../../../services/extensionManagement/common/extensionManagement.js";const m=new I("showRemoteStartEntryInWeb",!1);let r=class extends b{constructor(t,e,i,c,a,T){super();this.commandService=t;this.productService=e;this.extensionManagementService=i;this.extensionEnablementService=c;this.telemetryService=a;this.contextKeyService=T;const d=this.productService.remoteExtensionTips?.tunnel;this.startCommand=d?.startEntry?.startCommand??"",this.remoteExtensionId=d?.extensionId??"",this._init(),this.registerActions(),this.registerListeners()}static REMOTE_WEB_START_ENTRY_ACTIONS_COMMAND_ID="workbench.action.remote.showWebStartEntryActions";remoteExtensionId;startCommand;registerActions(){const t=v.localize2("remote.category","Remote"),e=this;this._register(S(class extends x{constructor(){super({id:r.REMOTE_WEB_START_ENTRY_ACTIONS_COMMAND_ID,category:t,title:v.localize2("remote.showWebStartEntryActions","Show Remote Start Entry for web"),f1:!1})}async run(){await e.showWebRemoteStartActions()}}))}registerListeners(){this._register(this.extensionEnablementService.onEnablementChanged(async t=>{for(const e of t)h.equals(this.remoteExtensionId,e.identifier.id)&&(this.extensionEnablementService.isEnabled(e)?m.bindTo(this.contextKeyService).set(!0):m.bindTo(this.contextKeyService).set(!1))}))}async _init(){const t=(await this.extensionManagementService.getInstalled()).find(e=>h.equals(e.identifier.id,this.remoteExtensionId));t&&this.extensionEnablementService.isEnabled(t)&&m.bindTo(this.contextKeyService).set(!0)}async showWebRemoteStartActions(){this.commandService.executeCommand(this.startCommand),this.telemetryService.publicLog2("workbenchActionExecuted",{id:this.startCommand,from:"remote start entry"})}};r=l([o(0,y),o(1,C),o(2,u),o(3,g),o(4,A),o(5,f)],r);export{r as RemoteStartEntry,m as showStartEntryInWeb};
