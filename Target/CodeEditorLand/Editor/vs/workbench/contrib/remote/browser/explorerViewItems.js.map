{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/remote/browser/explorerViewItems.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport type { ISelectOptionItem } from \"../../../../base/browser/ui/selectBox/selectBox.js\";\nimport {\n\tDisposable,\n\tDisposableMap,\n} from \"../../../../base/common/lifecycle.js\";\nimport { isStringArray } from \"../../../../base/common/types.js\";\nimport * as nls from \"../../../../nls.js\";\nimport {\n\tAction2,\n\tMenuId,\n\tMenuRegistry,\n\tregisterAction2,\n} from \"../../../../platform/actions/common/actions.js\";\nimport {\n\tContextKeyExpr,\n\ttype IContextKey,\n\tIContextKeyService,\n\tRawContextKey,\n} from \"../../../../platform/contextkey/common/contextkey.js\";\nimport {\n\tIStorageService,\n\tStorageScope,\n} from \"../../../../platform/storage/common/storage.js\";\nimport { getVirtualWorkspaceLocation } from \"../../../../platform/workspace/common/virtualWorkspace.js\";\nimport { IWorkspaceContextService } from \"../../../../platform/workspace/common/workspace.js\";\nimport type { IViewDescriptor } from \"../../../common/views.js\";\nimport { IWorkbenchEnvironmentService } from \"../../../services/environment/common/environmentService.js\";\nimport {\n\tIRemoteExplorerService,\n\tREMOTE_EXPLORER_TYPE_KEY,\n} from \"../../../services/remote/common/remoteExplorerService.js\";\nimport { VIEWLET_ID } from \"./remoteExplorer.js\";\n\ninterface IRemoteSelectItem extends ISelectOptionItem {\n\tauthority: string[];\n\tvirtualWorkspace?: string;\n\tdispose(): void;\n}\n\nexport const SELECTED_REMOTE_IN_EXPLORER = new RawContextKey<string>(\n\t\"selectedRemoteInExplorer\",\n\t\"\",\n);\n\nexport class SwitchRemoteViewItem extends Disposable {\n\tprivate switchRemoteMenu: MenuId;\n\tprivate completedRemotes: DisposableMap<string, IRemoteSelectItem> =\n\t\tthis._register(new DisposableMap());\n\tprivate readonly selectedRemoteContext: IContextKey<string>;\n\n\tconstructor(\n\t\t@IContextKeyService private readonly contextKeyService: IContextKeyService,\n\t\t@IRemoteExplorerService private remoteExplorerService: IRemoteExplorerService,\n\t\t@IWorkbenchEnvironmentService private environmentService: IWorkbenchEnvironmentService,\n\t\t@IStorageService private readonly storageService: IStorageService,\n\t\t@IWorkspaceContextService private readonly workspaceContextService: IWorkspaceContextService\n\t) {\n\t\tsuper();\n\t\tthis.selectedRemoteContext = SELECTED_REMOTE_IN_EXPLORER.bindTo(contextKeyService);\n\n\t\tthis.switchRemoteMenu = MenuId.for('workbench.remote.menu.switchRemoteMenu');\n\t\tthis._register(MenuRegistry.appendMenuItem(MenuId.ViewContainerTitle, {\n\t\t\tsubmenu: this.switchRemoteMenu,\n\t\t\ttitle: nls.localize('switchRemote.label', \"Switch Remote\"),\n\t\t\tgroup: 'navigation',\n\t\t\twhen: ContextKeyExpr.equals('viewContainer', VIEWLET_ID),\n\t\t\torder: 1,\n\t\t\tisSelection: true\n\t\t}));\n\t\tthis._register(remoteExplorerService.onDidChangeTargetType(e => {\n\t\t\tthis.select(e);\n\t\t}));\n\t}\n\n\tpublic setSelectionForConnection(): boolean {\n\t\tlet isSetForConnection = false;\n\t\tif (this.completedRemotes.size > 0) {\n\t\t\tlet authority: string[] | undefined;\n\t\t\tconst remoteAuthority = this.environmentService.remoteAuthority;\n\t\t\tlet virtualWorkspace: string | undefined;\n\t\t\tif (!remoteAuthority) {\n\t\t\t\tvirtualWorkspace = getVirtualWorkspaceLocation(\n\t\t\t\t\tthis.workspaceContextService.getWorkspace(),\n\t\t\t\t)?.scheme;\n\t\t\t}\n\t\t\tisSetForConnection = true;\n\t\t\tconst explorerType: string[] | undefined = remoteAuthority\n\t\t\t\t? [remoteAuthority.split(\"+\")[0]]\n\t\t\t\t: virtualWorkspace\n\t\t\t\t\t? [virtualWorkspace]\n\t\t\t\t\t: (this.storageService\n\t\t\t\t\t\t\t.get(\n\t\t\t\t\t\t\t\tREMOTE_EXPLORER_TYPE_KEY,\n\t\t\t\t\t\t\t\tStorageScope.WORKSPACE,\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t?.split(\",\") ??\n\t\t\t\t\t\tthis.storageService\n\t\t\t\t\t\t\t.get(REMOTE_EXPLORER_TYPE_KEY, StorageScope.PROFILE)\n\t\t\t\t\t\t\t?.split(\",\"));\n\t\t\tif (explorerType !== undefined) {\n\t\t\t\tauthority = this.getAuthorityForExplorerType(explorerType);\n\t\t\t}\n\t\t\tif (authority) {\n\t\t\t\tthis.select(authority);\n\t\t\t}\n\t\t}\n\t\treturn isSetForConnection;\n\t}\n\n\tprivate select(authority: string[]) {\n\t\tthis.selectedRemoteContext.set(authority[0]);\n\t\tthis.remoteExplorerService.targetType = authority;\n\t}\n\n\tprivate getAuthorityForExplorerType(\n\t\texplorerType: string[],\n\t): string[] | undefined {\n\t\tlet authority: string[] | undefined;\n\t\tfor (const option of this.completedRemotes) {\n\t\t\tfor (const authorityOption of option[1].authority) {\n\t\t\t\tfor (const explorerOption of explorerType) {\n\t\t\t\t\tif (authorityOption === explorerOption) {\n\t\t\t\t\t\tauthority = option[1].authority;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t} else if (option[1].virtualWorkspace === explorerOption) {\n\t\t\t\t\t\tauthority = option[1].authority;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn authority;\n\t}\n\n\tpublic removeOptionItems(views: IViewDescriptor[]) {\n\t\tfor (const view of views) {\n\t\t\tif (\n\t\t\t\tview.group &&\n\t\t\t\tview.group.startsWith(\"targets\") &&\n\t\t\t\tview.remoteAuthority &&\n\t\t\t\t(!view.when ||\n\t\t\t\t\tthis.contextKeyService.contextMatchesRules(view.when))\n\t\t\t) {\n\t\t\t\tconst authority = isStringArray(view.remoteAuthority)\n\t\t\t\t\t? view.remoteAuthority\n\t\t\t\t\t: [view.remoteAuthority];\n\t\t\t\tthis.completedRemotes.deleteAndDispose(authority[0]);\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic createOptionItems(views: IViewDescriptor[]) {\n\t\tconst startingCount = this.completedRemotes.size;\n\t\tfor (const view of views) {\n\t\t\tif (\n\t\t\t\tview.group &&\n\t\t\t\tview.group.startsWith(\"targets\") &&\n\t\t\t\tview.remoteAuthority &&\n\t\t\t\t(!view.when ||\n\t\t\t\t\tthis.contextKeyService.contextMatchesRules(view.when))\n\t\t\t) {\n\t\t\t\tconst text = view.name;\n\t\t\t\tconst authority = isStringArray(view.remoteAuthority)\n\t\t\t\t\t? view.remoteAuthority\n\t\t\t\t\t: [view.remoteAuthority];\n\t\t\t\tif (this.completedRemotes.has(authority[0])) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tconst thisCapture = this;\n\t\t\t\tconst action = registerAction2(\n\t\t\t\t\tclass extends Action2 {\n\t\t\t\t\t\tconstructor() {\n\t\t\t\t\t\t\tsuper({\n\t\t\t\t\t\t\t\tid: `workbench.action.remoteExplorer.show.${authority[0]}`,\n\t\t\t\t\t\t\t\ttitle: text,\n\t\t\t\t\t\t\t\ttoggled: SELECTED_REMOTE_IN_EXPLORER.isEqualTo(\n\t\t\t\t\t\t\t\t\tauthority[0],\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\tmenu: {\n\t\t\t\t\t\t\t\t\tid: thisCapture.switchRemoteMenu,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\tasync run(): Promise<void> {\n\t\t\t\t\t\t\tthisCapture.select(authority);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t\tthis.completedRemotes.set(authority[0], {\n\t\t\t\t\ttext: text.value,\n\t\t\t\t\tauthority,\n\t\t\t\t\tvirtualWorkspace: view.virtualWorkspace,\n\t\t\t\t\tdispose: () => action.dispose(),\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\tif (this.completedRemotes.size > startingCount) {\n\t\t\tthis.setSelectionForConnection();\n\t\t}\n\t}\n}\n"],
  "mappings": "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",
  "names": []
}
