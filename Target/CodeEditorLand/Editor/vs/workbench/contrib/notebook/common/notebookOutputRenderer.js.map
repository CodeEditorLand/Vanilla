{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/notebook/common/notebookOutputRenderer.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as glob from \"../../../../base/common/glob.js\";\nimport { Iterable } from \"../../../../base/common/iterator.js\";\nimport { joinPath } from \"../../../../base/common/resources.js\";\nimport type { URI } from \"../../../../base/common/uri.js\";\nimport type {\n\tExtensionIdentifier,\n\tIExtensionDescription,\n} from \"../../../../platform/extensions/common/extensions.js\";\nimport {\n\ttype ContributedNotebookRendererEntrypoint,\n\ttype INotebookRendererInfo,\n\ttype INotebookStaticPreloadInfo,\n\ttype NotebookRendererEntrypoint,\n\tNotebookRendererMatch,\n\tRendererMessagingSpec,\n} from \"./notebookCommon.js\";\n\nclass DependencyList {\n\tprivate readonly value: ReadonlySet<string>;\n\tpublic readonly defined: boolean;\n\n\tconstructor(value: Iterable<string>) {\n\t\tthis.value = new Set(value);\n\t\tthis.defined = this.value.size > 0;\n\t}\n\n\t/** Gets whether any of the 'available' dependencies match the ones in this list */\n\tpublic matches(available: ReadonlyArray<string>) {\n\t\t// For now this is simple, but this may expand to support globs later\n\t\t// @see https://github.com/microsoft/vscode/issues/119899\n\t\treturn available.some((v) => this.value.has(v));\n\t}\n}\n\nexport class NotebookOutputRendererInfo implements INotebookRendererInfo {\n\treadonly id: string;\n\treadonly entrypoint: NotebookRendererEntrypoint;\n\treadonly displayName: string;\n\treadonly extensionLocation: URI;\n\treadonly extensionId: ExtensionIdentifier;\n\treadonly hardDependencies: DependencyList;\n\treadonly optionalDependencies: DependencyList;\n\treadonly messaging: RendererMessagingSpec;\n\n\treadonly mimeTypes: readonly string[];\n\tprivate readonly mimeTypeGlobs: glob.ParsedPattern[];\n\n\treadonly isBuiltin: boolean;\n\n\tconstructor(descriptor: {\n\t\treadonly id: string;\n\t\treadonly displayName: string;\n\t\treadonly entrypoint: ContributedNotebookRendererEntrypoint;\n\t\treadonly mimeTypes: readonly string[];\n\t\treadonly extension: IExtensionDescription;\n\t\treadonly dependencies: readonly string[] | undefined;\n\t\treadonly optionalDependencies: readonly string[] | undefined;\n\t\treadonly requiresMessaging: RendererMessagingSpec | undefined;\n\t}) {\n\t\tthis.id = descriptor.id;\n\t\tthis.extensionId = descriptor.extension.identifier;\n\t\tthis.extensionLocation = descriptor.extension.extensionLocation;\n\t\tthis.isBuiltin = descriptor.extension.isBuiltin;\n\n\t\tif (typeof descriptor.entrypoint === \"string\") {\n\t\t\tthis.entrypoint = {\n\t\t\t\textends: undefined,\n\t\t\t\tpath: joinPath(this.extensionLocation, descriptor.entrypoint),\n\t\t\t};\n\t\t} else {\n\t\t\tthis.entrypoint = {\n\t\t\t\textends: descriptor.entrypoint.extends,\n\t\t\t\tpath: joinPath(\n\t\t\t\t\tthis.extensionLocation,\n\t\t\t\t\tdescriptor.entrypoint.path,\n\t\t\t\t),\n\t\t\t};\n\t\t}\n\n\t\tthis.displayName = descriptor.displayName;\n\t\tthis.mimeTypes = descriptor.mimeTypes;\n\t\tthis.mimeTypeGlobs = this.mimeTypes.map((pattern) =>\n\t\t\tglob.parse(pattern),\n\t\t);\n\t\tthis.hardDependencies = new DependencyList(\n\t\t\tdescriptor.dependencies ?? Iterable.empty(),\n\t\t);\n\t\tthis.optionalDependencies = new DependencyList(\n\t\t\tdescriptor.optionalDependencies ?? Iterable.empty(),\n\t\t);\n\t\tthis.messaging =\n\t\t\tdescriptor.requiresMessaging ?? RendererMessagingSpec.Never;\n\t}\n\n\tpublic matchesWithoutKernel(mimeType: string) {\n\t\tif (!this.matchesMimeTypeOnly(mimeType)) {\n\t\t\treturn NotebookRendererMatch.Never;\n\t\t}\n\n\t\tif (this.hardDependencies.defined) {\n\t\t\treturn NotebookRendererMatch.WithHardKernelDependency;\n\t\t}\n\n\t\tif (this.optionalDependencies.defined) {\n\t\t\treturn NotebookRendererMatch.WithOptionalKernelDependency;\n\t\t}\n\n\t\treturn NotebookRendererMatch.Pure;\n\t}\n\n\tpublic matches(mimeType: string, kernelProvides: ReadonlyArray<string>) {\n\t\tif (!this.matchesMimeTypeOnly(mimeType)) {\n\t\t\treturn NotebookRendererMatch.Never;\n\t\t}\n\n\t\tif (this.hardDependencies.defined) {\n\t\t\treturn this.hardDependencies.matches(kernelProvides)\n\t\t\t\t? NotebookRendererMatch.WithHardKernelDependency\n\t\t\t\t: NotebookRendererMatch.Never;\n\t\t}\n\n\t\treturn this.optionalDependencies.matches(kernelProvides)\n\t\t\t? NotebookRendererMatch.WithOptionalKernelDependency\n\t\t\t: NotebookRendererMatch.Pure;\n\t}\n\n\tprivate matchesMimeTypeOnly(mimeType: string) {\n\t\tif (this.entrypoint.extends) {\n\t\t\t// We're extending another renderer\n\t\t\treturn false;\n\t\t}\n\n\t\treturn (\n\t\t\tthis.mimeTypeGlobs.some((pattern) => pattern(mimeType)) ||\n\t\t\tthis.mimeTypes.some((pattern) => pattern === mimeType)\n\t\t);\n\t}\n}\n\nexport class NotebookStaticPreloadInfo implements INotebookStaticPreloadInfo {\n\treadonly type: string;\n\treadonly entrypoint: URI;\n\treadonly extensionLocation: URI;\n\treadonly localResourceRoots: readonly URI[];\n\n\tconstructor(descriptor: {\n\t\treadonly type: string;\n\t\treadonly entrypoint: string;\n\t\treadonly localResourceRoots: readonly string[];\n\t\treadonly extension: IExtensionDescription;\n\t}) {\n\t\tthis.type = descriptor.type;\n\n\t\tthis.entrypoint = joinPath(\n\t\t\tdescriptor.extension.extensionLocation,\n\t\t\tdescriptor.entrypoint,\n\t\t);\n\t\tthis.extensionLocation = descriptor.extension.extensionLocation;\n\t\tthis.localResourceRoots = descriptor.localResourceRoots.map((root) =>\n\t\t\tjoinPath(descriptor.extension.extensionLocation, root),\n\t\t);\n\t}\n}\n"],
  "mappings": ";;AAKA,YAAY,UAAU;AACtB,SAAS,gBAAgB;AACzB,SAAS,gBAAgB;AAMzB;AAAA,EAKC;AAAA,EACA;AAAA,OACM;AAEP,MAAM,eAAe;AAAA,EAtBrB,OAsBqB;AAAA;AAAA;AAAA,EACH;AAAA,EACD;AAAA,EAEhB,YAAY,OAAyB;AACpC,SAAK,QAAQ,IAAI,IAAI,KAAK;AAC1B,SAAK,UAAU,KAAK,MAAM,OAAO;AAAA,EAClC;AAAA;AAAA,EAGO,QAAQ,WAAkC;AAGhD,WAAO,UAAU,KAAK,CAAC,MAAM,KAAK,MAAM,IAAI,CAAC,CAAC;AAAA,EAC/C;AACD;AAEO,MAAM,2BAA4D;AAAA,EAvCzE,OAuCyE;AAAA;AAAA;AAAA,EAC/D;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EAEA;AAAA,EACQ;AAAA,EAER;AAAA,EAET,YAAY,YAST;AACF,SAAK,KAAK,WAAW;AACrB,SAAK,cAAc,WAAW,UAAU;AACxC,SAAK,oBAAoB,WAAW,UAAU;AAC9C,SAAK,YAAY,WAAW,UAAU;AAEtC,QAAI,OAAO,WAAW,eAAe,UAAU;AAC9C,WAAK,aAAa;AAAA,QACjB,SAAS;AAAA,QACT,MAAM,SAAS,KAAK,mBAAmB,WAAW,UAAU;AAAA,MAC7D;AAAA,IACD,OAAO;AACN,WAAK,aAAa;AAAA,QACjB,SAAS,WAAW,WAAW;AAAA,QAC/B,MAAM;AAAA,UACL,KAAK;AAAA,UACL,WAAW,WAAW;AAAA,QACvB;AAAA,MACD;AAAA,IACD;AAEA,SAAK,cAAc,WAAW;AAC9B,SAAK,YAAY,WAAW;AAC5B,SAAK,gBAAgB,KAAK,UAAU;AAAA,MAAI,CAAC,YACxC,KAAK,MAAM,OAAO;AAAA,IACnB;AACA,SAAK,mBAAmB,IAAI;AAAA,MAC3B,WAAW,gBAAgB,SAAS,MAAM;AAAA,IAC3C;AACA,SAAK,uBAAuB,IAAI;AAAA,MAC/B,WAAW,wBAAwB,SAAS,MAAM;AAAA,IACnD;AACA,SAAK,YACJ,WAAW,qBAAqB,sBAAsB;AAAA,EACxD;AAAA,EAEO,qBAAqB,UAAkB;AAC7C,QAAI,CAAC,KAAK,oBAAoB,QAAQ,GAAG;AACxC,aAAO,sBAAsB;AAAA,IAC9B;AAEA,QAAI,KAAK,iBAAiB,SAAS;AAClC,aAAO,sBAAsB;AAAA,IAC9B;AAEA,QAAI,KAAK,qBAAqB,SAAS;AACtC,aAAO,sBAAsB;AAAA,IAC9B;AAEA,WAAO,sBAAsB;AAAA,EAC9B;AAAA,EAEO,QAAQ,UAAkB,gBAAuC;AACvE,QAAI,CAAC,KAAK,oBAAoB,QAAQ,GAAG;AACxC,aAAO,sBAAsB;AAAA,IAC9B;AAEA,QAAI,KAAK,iBAAiB,SAAS;AAClC,aAAO,KAAK,iBAAiB,QAAQ,cAAc,IAChD,sBAAsB,2BACtB,sBAAsB;AAAA,IAC1B;AAEA,WAAO,KAAK,qBAAqB,QAAQ,cAAc,IACpD,sBAAsB,+BACtB,sBAAsB;AAAA,EAC1B;AAAA,EAEQ,oBAAoB,UAAkB;AAC7C,QAAI,KAAK,WAAW,SAAS;AAE5B,aAAO;AAAA,IACR;AAEA,WACC,KAAK,cAAc,KAAK,CAAC,YAAY,QAAQ,QAAQ,CAAC,KACtD,KAAK,UAAU,KAAK,CAAC,YAAY,YAAY,QAAQ;AAAA,EAEvD;AACD;AAEO,MAAM,0BAAgE;AAAA,EAhJ7E,OAgJ6E;AAAA;AAAA;AAAA,EACnE;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EAET,YAAY,YAKT;AACF,SAAK,OAAO,WAAW;AAEvB,SAAK,aAAa;AAAA,MACjB,WAAW,UAAU;AAAA,MACrB,WAAW;AAAA,IACZ;AACA,SAAK,oBAAoB,WAAW,UAAU;AAC9C,SAAK,qBAAqB,WAAW,mBAAmB;AAAA,MAAI,CAAC,SAC5D,SAAS,WAAW,UAAU,mBAAmB,IAAI;AAAA,IACtD;AAAA,EACD;AACD;",
  "names": []
}
