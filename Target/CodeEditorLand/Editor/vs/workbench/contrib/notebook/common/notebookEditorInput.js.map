{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/notebook/common/notebookEditorInput.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { VSBuffer } from \"../../../../base/common/buffer.js\";\nimport { onUnexpectedError } from \"../../../../base/common/errors.js\";\nimport * as glob from \"../../../../base/common/glob.js\";\nimport type { IMarkdownString } from \"../../../../base/common/htmlContent.js\";\nimport type {\n\tIDisposable,\n\tIReference,\n} from \"../../../../base/common/lifecycle.js\";\nimport { Schemas } from \"../../../../base/common/network.js\";\nimport { isEqual, joinPath } from \"../../../../base/common/resources.js\";\nimport type { URI } from \"../../../../base/common/uri.js\";\nimport { ITextResourceConfigurationService } from \"../../../../editor/common/services/textResourceConfiguration.js\";\nimport { localize } from \"../../../../nls.js\";\nimport { IFileDialogService } from \"../../../../platform/dialogs/common/dialogs.js\";\nimport type { IResourceEditorInput } from \"../../../../platform/editor/common/editor.js\";\nimport { IFileService } from \"../../../../platform/files/common/files.js\";\nimport type { IInstantiationService } from \"../../../../platform/instantiation/common/instantiation.js\";\nimport { ILabelService } from \"../../../../platform/label/common/label.js\";\nimport {\n\tEditorInputCapabilities,\n\ttype GroupIdentifier,\n\ttype IFileLimitedEditorInputOptions,\n\ttype IMoveResult,\n\ttype IRevertOptions,\n\ttype ISaveOptions,\n\ttype IUntypedEditorInput,\n\tVerbosity,\n} from \"../../../common/editor.js\";\nimport type { EditorInput } from \"../../../common/editor/editorInput.js\";\nimport { AbstractResourceEditorInput } from \"../../../common/editor/resourceEditorInput.js\";\nimport { ICustomEditorLabelService } from \"../../../services/editor/common/customEditorLabelService.js\";\nimport { IEditorService } from \"../../../services/editor/common/editorService.js\";\nimport { IExtensionService } from \"../../../services/extensions/common/extensions.js\";\nimport { IFilesConfigurationService } from \"../../../services/filesConfiguration/common/filesConfigurationService.js\";\nimport type { IWorkingCopyIdentifier } from \"../../../services/workingCopy/common/workingCopy.js\";\nimport {\n\tCellEditType,\n\ttype IResolvedNotebookEditorModel,\n} from \"./notebookCommon.js\";\nimport { INotebookEditorModelResolverService } from \"./notebookEditorModelResolverService.js\";\nimport type { NotebookPerfMarks } from \"./notebookPerformance.js\";\nimport type { NotebookProviderInfo } from \"./notebookProvider.js\";\nimport {\n\tINotebookService,\n\tSimpleNotebookProviderInfo,\n} from \"./notebookService.js\";\n\nexport interface NotebookEditorInputOptions {\n\tstartDirty?: boolean;\n\t/**\n\t * backupId for webview\n\t */\n\t_backupId?: string;\n\t_workingCopy?: IWorkingCopyIdentifier;\n}\n\nexport class NotebookEditorInput extends AbstractResourceEditorInput {\n\tstatic getOrCreate(\n\t\tinstantiationService: IInstantiationService,\n\t\tresource: URI,\n\t\tpreferredResource: URI | undefined,\n\t\tviewType: string,\n\t\toptions: NotebookEditorInputOptions = {},\n\t) {\n\t\tconst editor = instantiationService.createInstance(\n\t\t\tNotebookEditorInput,\n\t\t\tresource,\n\t\t\tpreferredResource,\n\t\t\tviewType,\n\t\t\toptions,\n\t\t);\n\t\tif (preferredResource) {\n\t\t\teditor.setPreferredResource(preferredResource);\n\t\t}\n\t\treturn editor;\n\t}\n\n\tstatic readonly ID: string = \"workbench.input.notebook\";\n\n\tprotected editorModelReference: IReference<IResolvedNotebookEditorModel> | null =\n\t\tnull;\n\tprivate _sideLoadedListener: IDisposable;\n\tprivate _defaultDirtyState = false;\n\n\tconstructor(\n\t\tresource: URI,\n\t\tpreferredResource: URI | undefined,\n\t\tpublic readonly viewType: string,\n\t\tpublic readonly options: NotebookEditorInputOptions,\n\t\t@INotebookService private readonly _notebookService: INotebookService,\n\t\t@INotebookEditorModelResolverService\n\t\tprivate readonly _notebookModelResolverService: INotebookEditorModelResolverService,\n\t\t@IFileDialogService\n\t\tprivate readonly _fileDialogService: IFileDialogService,\n\t\t@ILabelService labelService: ILabelService,\n\t\t@IFileService fileService: IFileService,\n\t\t@IFilesConfigurationService\n\t\tfilesConfigurationService: IFilesConfigurationService,\n\t\t@IExtensionService extensionService: IExtensionService,\n\t\t@IEditorService editorService: IEditorService,\n\t\t@ITextResourceConfigurationService\n\t\ttextResourceConfigurationService: ITextResourceConfigurationService,\n\t\t@ICustomEditorLabelService\n\t\tcustomEditorLabelService: ICustomEditorLabelService,\n\t) {\n\t\tsuper(\n\t\t\tresource,\n\t\t\tpreferredResource,\n\t\t\tlabelService,\n\t\t\tfileService,\n\t\t\tfilesConfigurationService,\n\t\t\ttextResourceConfigurationService,\n\t\t\tcustomEditorLabelService,\n\t\t);\n\t\tthis._defaultDirtyState = !!options.startDirty;\n\n\t\t// Automatically resolve this input when the \"wanted\" model comes to life via\n\t\t// some other way. This happens only once per input and resolve disposes\n\t\t// this listener\n\t\tthis._sideLoadedListener = _notebookService.onDidAddNotebookDocument(\n\t\t\t(e) => {\n\t\t\t\tif (\n\t\t\t\t\te.viewType === this.viewType &&\n\t\t\t\t\te.uri.toString() === this.resource.toString()\n\t\t\t\t) {\n\t\t\t\t\tthis.resolve().catch(onUnexpectedError);\n\t\t\t\t}\n\t\t\t},\n\t\t);\n\n\t\tthis._register(\n\t\t\textensionService.onWillStop((e) => {\n\t\t\t\tif (!e.auto && !this.isDirty()) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst reason = e.auto\n\t\t\t\t\t? localize(\n\t\t\t\t\t\t\t\"vetoAutoExtHostRestart\",\n\t\t\t\t\t\t\t\"One of the opened editors is a notebook editor.\",\n\t\t\t\t\t\t)\n\t\t\t\t\t: localize(\n\t\t\t\t\t\t\t\"vetoExtHostRestart\",\n\t\t\t\t\t\t\t\"Notebook '{0}' could not be saved.\",\n\t\t\t\t\t\t\tthis.resource.path,\n\t\t\t\t\t\t);\n\n\t\t\t\te.veto(\n\t\t\t\t\t(async () => {\n\t\t\t\t\t\tconst editors = editorService.findEditors(this);\n\t\t\t\t\t\tif (e.auto) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (editors.length > 0) {\n\t\t\t\t\t\t\tconst result = await editorService.save(editors[0]);\n\t\t\t\t\t\t\tif (result.success) {\n\t\t\t\t\t\t\t\treturn false; // Don't Veto\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn true; // Veto\n\t\t\t\t\t})(),\n\t\t\t\t\treason,\n\t\t\t\t);\n\t\t\t}),\n\t\t);\n\t}\n\n\toverride dispose() {\n\t\tthis._sideLoadedListener.dispose();\n\t\tthis.editorModelReference?.dispose();\n\t\tthis.editorModelReference = null;\n\t\tsuper.dispose();\n\t}\n\n\toverride get typeId(): string {\n\t\treturn NotebookEditorInput.ID;\n\t}\n\n\toverride get editorId(): string | undefined {\n\t\treturn this.viewType;\n\t}\n\n\toverride get capabilities(): EditorInputCapabilities {\n\t\tlet capabilities = EditorInputCapabilities.None;\n\n\t\tif (this.resource.scheme === Schemas.untitled) {\n\t\t\tcapabilities |= EditorInputCapabilities.Untitled;\n\t\t}\n\n\t\tif (this.editorModelReference) {\n\t\t\tif (this.editorModelReference.object.isReadonly()) {\n\t\t\t\tcapabilities |= EditorInputCapabilities.Readonly;\n\t\t\t}\n\t\t} else if (this.filesConfigurationService.isReadonly(this.resource)) {\n\t\t\tcapabilities |= EditorInputCapabilities.Readonly;\n\t\t}\n\n\t\tif (!(capabilities & EditorInputCapabilities.Readonly)) {\n\t\t\tcapabilities |= EditorInputCapabilities.CanDropIntoEditor;\n\t\t}\n\n\t\treturn capabilities;\n\t}\n\n\toverride getDescription(verbosity = Verbosity.MEDIUM): string | undefined {\n\t\tif (\n\t\t\t!this.hasCapability(EditorInputCapabilities.Untitled) ||\n\t\t\tthis.editorModelReference?.object.hasAssociatedFilePath()\n\t\t) {\n\t\t\treturn super.getDescription(verbosity);\n\t\t}\n\n\t\treturn undefined; // no description for untitled notebooks without associated file path\n\t}\n\n\toverride isReadonly(): boolean | IMarkdownString {\n\t\tif (!this.editorModelReference) {\n\t\t\treturn this.filesConfigurationService.isReadonly(this.resource);\n\t\t}\n\t\treturn this.editorModelReference.object.isReadonly();\n\t}\n\n\toverride isDirty() {\n\t\tif (!this.editorModelReference) {\n\t\t\treturn this._defaultDirtyState;\n\t\t}\n\t\treturn this.editorModelReference.object.isDirty();\n\t}\n\n\toverride isSaving(): boolean {\n\t\tconst model = this.editorModelReference?.object;\n\t\tif (\n\t\t\t!model ||\n\t\t\t!model.isDirty() ||\n\t\t\tmodel.hasErrorState ||\n\t\t\tthis.hasCapability(EditorInputCapabilities.Untitled)\n\t\t) {\n\t\t\treturn false; // require the model to be dirty, file-backed and not in an error state\n\t\t}\n\n\t\t// if a short auto save is configured, treat this as being saved\n\t\treturn this.filesConfigurationService.hasShortAutoSaveDelay(this);\n\t}\n\n\toverride async save(\n\t\tgroup: GroupIdentifier,\n\t\toptions?: ISaveOptions,\n\t): Promise<EditorInput | IUntypedEditorInput | undefined> {\n\t\tif (this.editorModelReference) {\n\t\t\tif (this.hasCapability(EditorInputCapabilities.Untitled)) {\n\t\t\t\treturn this.saveAs(group, options);\n\t\t\t} else {\n\t\t\t\tawait this.editorModelReference.object.save(options);\n\t\t\t}\n\n\t\t\treturn this;\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\toverride async saveAs(\n\t\tgroup: GroupIdentifier,\n\t\toptions?: ISaveOptions,\n\t): Promise<IUntypedEditorInput | undefined> {\n\t\tif (!this.editorModelReference) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst provider = this._notebookService.getContributedNotebookType(\n\t\t\tthis.viewType,\n\t\t);\n\n\t\tif (!provider) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst pathCandidate = this.hasCapability(\n\t\t\tEditorInputCapabilities.Untitled,\n\t\t)\n\t\t\t? await this._suggestName(\n\t\t\t\t\tprovider,\n\t\t\t\t\tthis.labelService.getUriBasenameLabel(this.resource),\n\t\t\t\t)\n\t\t\t: this.editorModelReference.object.resource;\n\t\tlet target: URI | undefined;\n\t\tif (this.editorModelReference.object.hasAssociatedFilePath()) {\n\t\t\ttarget = pathCandidate;\n\t\t} else {\n\t\t\ttarget = await this._fileDialogService.pickFileToSave(\n\t\t\t\tpathCandidate,\n\t\t\t\toptions?.availableFileSystems,\n\t\t\t);\n\t\t\tif (!target) {\n\t\t\t\treturn undefined; // save cancelled\n\t\t\t}\n\t\t}\n\n\t\tif (!provider.matches(target)) {\n\t\t\tconst patterns = provider.selectors\n\t\t\t\t.map((pattern) => {\n\t\t\t\t\tif (typeof pattern === \"string\") {\n\t\t\t\t\t\treturn pattern;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (glob.isRelativePattern(pattern)) {\n\t\t\t\t\t\treturn `${pattern} (base ${pattern.base})`;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (pattern.exclude) {\n\t\t\t\t\t\treturn `${pattern.include} (exclude: ${pattern.exclude})`;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn `${pattern.include}`;\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.join(\", \");\n\t\t\tthrow new Error(\n\t\t\t\t`File name ${target} is not supported by ${provider.providerDisplayName}.\\n\\nPlease make sure the file name matches following patterns:\\n${patterns}`,\n\t\t\t);\n\t\t}\n\n\t\treturn await this.editorModelReference.object.saveAs(target);\n\t}\n\n\tprivate async _suggestName(\n\t\tprovider: NotebookProviderInfo,\n\t\tsuggestedFilename: string,\n\t) {\n\t\t// guess file extensions\n\t\tconst firstSelector = provider.selectors[0];\n\t\tlet selectorStr =\n\t\t\tfirstSelector && typeof firstSelector === \"string\"\n\t\t\t\t? firstSelector\n\t\t\t\t: undefined;\n\t\tif (!selectorStr && firstSelector) {\n\t\t\tconst include = (firstSelector as { include?: string }).include;\n\t\t\tif (typeof include === \"string\") {\n\t\t\t\tselectorStr = include;\n\t\t\t}\n\t\t}\n\n\t\tif (selectorStr) {\n\t\t\tconst matches = /^\\*\\.([A-Za-z_-]*)$/.exec(selectorStr);\n\t\t\tif (matches && matches.length > 1) {\n\t\t\t\tconst fileExt = matches[1];\n\t\t\t\tif (!suggestedFilename.endsWith(fileExt)) {\n\t\t\t\t\treturn joinPath(\n\t\t\t\t\t\tawait this._fileDialogService.defaultFilePath(),\n\t\t\t\t\t\tsuggestedFilename + \".\" + fileExt,\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn joinPath(\n\t\t\tawait this._fileDialogService.defaultFilePath(),\n\t\t\tsuggestedFilename,\n\t\t);\n\t}\n\n\t// called when users rename a notebook document\n\toverride async rename(\n\t\tgroup: GroupIdentifier,\n\t\ttarget: URI,\n\t): Promise<IMoveResult | undefined> {\n\t\tif (this.editorModelReference) {\n\t\t\treturn {\n\t\t\t\teditor: { resource: target },\n\t\t\t\toptions: { override: this.viewType },\n\t\t\t};\n\t\t}\n\t\treturn undefined;\n\t}\n\n\toverride async revert(\n\t\t_group: GroupIdentifier,\n\t\toptions?: IRevertOptions,\n\t): Promise<void> {\n\t\tif (\n\t\t\tthis.editorModelReference &&\n\t\t\tthis.editorModelReference.object.isDirty()\n\t\t) {\n\t\t\tawait this.editorModelReference.object.revert(options);\n\t\t}\n\t}\n\n\toverride async resolve(\n\t\t_options?: IFileLimitedEditorInputOptions,\n\t\tperf?: NotebookPerfMarks,\n\t): Promise<IResolvedNotebookEditorModel | null> {\n\t\tif (!(await this._notebookService.canResolve(this.viewType))) {\n\t\t\treturn null;\n\t\t}\n\n\t\tperf?.mark(\"extensionActivated\");\n\n\t\t// we are now loading the notebook and don't need to listen to\n\t\t// \"other\" loading anymore\n\t\tthis._sideLoadedListener.dispose();\n\n\t\tif (this.editorModelReference) {\n\t\t\tthis.editorModelReference.object.load({\n\t\t\t\tlimits: this.ensureLimits(_options),\n\t\t\t});\n\t\t} else {\n\t\t\tconst scratchpad =\n\t\t\t\tthis.capabilities & EditorInputCapabilities.Scratchpad\n\t\t\t\t\t? true\n\t\t\t\t\t: false;\n\t\t\tconst ref = await this._notebookModelResolverService.resolve(\n\t\t\t\tthis.resource,\n\t\t\t\tthis.viewType,\n\t\t\t\t{ limits: this.ensureLimits(_options), scratchpad },\n\t\t\t);\n\t\t\tif (this.editorModelReference) {\n\t\t\t\t// Re-entrant, double resolve happened. Dispose the addition references and proceed\n\t\t\t\t// with the truth.\n\t\t\t\tref.dispose();\n\t\t\t\treturn (<IReference<IResolvedNotebookEditorModel>>(\n\t\t\t\t\tthis.editorModelReference\n\t\t\t\t)).object;\n\t\t\t}\n\t\t\tthis.editorModelReference = ref;\n\t\t\tif (this.isDisposed()) {\n\t\t\t\tthis.editorModelReference.dispose();\n\t\t\t\tthis.editorModelReference = null;\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tthis._register(\n\t\t\t\tthis.editorModelReference.object.onDidChangeDirty(() =>\n\t\t\t\t\tthis._onDidChangeDirty.fire(),\n\t\t\t\t),\n\t\t\t);\n\t\t\tthis._register(\n\t\t\t\tthis.editorModelReference.object.onDidChangeReadonly(() =>\n\t\t\t\t\tthis._onDidChangeCapabilities.fire(),\n\t\t\t\t),\n\t\t\t);\n\t\t\tthis._register(\n\t\t\t\tthis.editorModelReference.object.onDidRevertUntitled(() =>\n\t\t\t\t\tthis.dispose(),\n\t\t\t\t),\n\t\t\t);\n\t\t\tif (this.editorModelReference.object.isDirty()) {\n\t\t\t\tthis._onDidChangeDirty.fire();\n\t\t\t}\n\t\t}\n\n\t\tif (this.options._backupId) {\n\t\t\tconst info = await this._notebookService.withNotebookDataProvider(\n\t\t\t\tthis.editorModelReference.object.notebook.viewType,\n\t\t\t);\n\t\t\tif (!(info instanceof SimpleNotebookProviderInfo)) {\n\t\t\t\tthrow new Error(\"CANNOT open file notebook with this provider\");\n\t\t\t}\n\n\t\t\tconst data = await info.serializer.dataToNotebook(\n\t\t\t\tVSBuffer.fromString(\n\t\t\t\t\tJSON.stringify({\n\t\t\t\t\t\t__webview_backup: this.options._backupId,\n\t\t\t\t\t}),\n\t\t\t\t),\n\t\t\t);\n\t\t\tthis.editorModelReference.object.notebook.applyEdits(\n\t\t\t\t[\n\t\t\t\t\t{\n\t\t\t\t\t\teditType: CellEditType.Replace,\n\t\t\t\t\t\tindex: 0,\n\t\t\t\t\t\tcount: this.editorModelReference.object.notebook.length,\n\t\t\t\t\t\tcells: data.cells,\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\ttrue,\n\t\t\t\tundefined,\n\t\t\t\t() => undefined,\n\t\t\t\tundefined,\n\t\t\t\tfalse,\n\t\t\t);\n\n\t\t\tif (this.options._workingCopy) {\n\t\t\t\tthis.options._backupId = undefined;\n\t\t\t\tthis.options._workingCopy = undefined;\n\t\t\t\tthis.options.startDirty = undefined;\n\t\t\t}\n\t\t}\n\n\t\treturn this.editorModelReference.object;\n\t}\n\n\toverride toUntyped(): IResourceEditorInput {\n\t\treturn {\n\t\t\tresource: this.resource,\n\t\t\toptions: {\n\t\t\t\toverride: this.viewType,\n\t\t\t},\n\t\t};\n\t}\n\n\toverride matches(otherInput: EditorInput | IUntypedEditorInput): boolean {\n\t\tif (super.matches(otherInput)) {\n\t\t\treturn true;\n\t\t}\n\t\tif (otherInput instanceof NotebookEditorInput) {\n\t\t\treturn (\n\t\t\t\tthis.editorId === otherInput.editorId &&\n\t\t\t\tisEqual(this.resource, otherInput.resource)\n\t\t\t);\n\t\t}\n\t\treturn false;\n\t}\n}\n\nexport interface ICompositeNotebookEditorInput {\n\treadonly editorInputs: NotebookEditorInput[];\n}\n\nexport function isCompositeNotebookEditorInput(\n\tthing: unknown,\n): thing is ICompositeNotebookEditorInput {\n\treturn (\n\t\t!!thing &&\n\t\ttypeof thing === \"object\" &&\n\t\tArray.isArray((<ICompositeNotebookEditorInput>thing).editorInputs) &&\n\t\t(<ICompositeNotebookEditorInput>thing).editorInputs.every(\n\t\t\t(input) => input instanceof NotebookEditorInput,\n\t\t)\n\t);\n}\n\nexport function isNotebookEditorInput(\n\tthing: EditorInput | undefined,\n): thing is NotebookEditorInput {\n\treturn (\n\t\t!!thing &&\n\t\ttypeof thing === \"object\" &&\n\t\tthing.typeId === NotebookEditorInput.ID\n\t);\n}\n"],
  "mappings": "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",
  "names": []
}
