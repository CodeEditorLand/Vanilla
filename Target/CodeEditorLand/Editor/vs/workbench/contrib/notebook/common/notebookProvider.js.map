{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/notebook/common/notebookProvider.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as glob from \"../../../../base/common/glob.js\";\nimport { basename } from \"../../../../base/common/path.js\";\nimport type { URI } from \"../../../../base/common/uri.js\";\nimport type { ExtensionIdentifier } from \"../../../../platform/extensions/common/extensions.js\";\nimport type { RegisteredEditorPriority } from \"../../../services/editor/common/editorResolverService.js\";\nimport {\n\ttype INotebookExclusiveDocumentFilter,\n\ttype TransientOptions,\n\tisDocumentExcludePattern,\n} from \"./notebookCommon.js\";\n\ntype NotebookSelector =\n\t| string\n\t| glob.IRelativePattern\n\t| INotebookExclusiveDocumentFilter;\n\nexport interface NotebookEditorDescriptor {\n\treadonly extension?: ExtensionIdentifier;\n\treadonly id: string;\n\treadonly displayName: string;\n\treadonly selectors: readonly {\n\t\tfilenamePattern?: string;\n\t\texcludeFileNamePattern?: string;\n\t}[];\n\treadonly priority: RegisteredEditorPriority;\n\treadonly providerDisplayName: string;\n}\n\nexport class NotebookProviderInfo {\n\treadonly extension?: ExtensionIdentifier;\n\treadonly id: string;\n\treadonly displayName: string;\n\treadonly priority: RegisteredEditorPriority;\n\treadonly providerDisplayName: string;\n\n\tprivate _selectors: NotebookSelector[];\n\tget selectors() {\n\t\treturn this._selectors;\n\t}\n\tprivate _options: TransientOptions;\n\tget options() {\n\t\treturn this._options;\n\t}\n\n\tconstructor(descriptor: NotebookEditorDescriptor) {\n\t\tthis.extension = descriptor.extension;\n\t\tthis.id = descriptor.id;\n\t\tthis.displayName = descriptor.displayName;\n\t\tthis._selectors =\n\t\t\tdescriptor.selectors?.map((selector) => ({\n\t\t\t\tinclude: selector.filenamePattern,\n\t\t\t\texclude: selector.excludeFileNamePattern || \"\",\n\t\t\t})) || [];\n\t\tthis.priority = descriptor.priority;\n\t\tthis.providerDisplayName = descriptor.providerDisplayName;\n\t\tthis._options = {\n\t\t\ttransientCellMetadata: {},\n\t\t\ttransientDocumentMetadata: {},\n\t\t\ttransientOutputs: false,\n\t\t\tcellContentMetadata: {},\n\t\t};\n\t}\n\n\tupdate(args: {\n\t\tselectors?: NotebookSelector[];\n\t\toptions?: TransientOptions;\n\t}) {\n\t\tif (args.selectors) {\n\t\t\tthis._selectors = args.selectors;\n\t\t}\n\n\t\tif (args.options) {\n\t\t\tthis._options = args.options;\n\t\t}\n\t}\n\n\tmatches(resource: URI): boolean {\n\t\treturn this.selectors?.some((selector) =>\n\t\t\tNotebookProviderInfo.selectorMatches(selector, resource),\n\t\t);\n\t}\n\n\tstatic selectorMatches(selector: NotebookSelector, resource: URI): boolean {\n\t\tif (typeof selector === \"string\") {\n\t\t\t// filenamePattern\n\t\t\tif (\n\t\t\t\tglob.match(\n\t\t\t\t\tselector.toLowerCase(),\n\t\t\t\t\tbasename(resource.fsPath).toLowerCase(),\n\t\t\t\t)\n\t\t\t) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\tif (glob.isRelativePattern(selector)) {\n\t\t\tif (glob.match(selector, basename(resource.fsPath).toLowerCase())) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\tif (!isDocumentExcludePattern(selector)) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst filenamePattern = selector.include;\n\t\tconst excludeFilenamePattern = selector.exclude;\n\n\t\tif (\n\t\t\tglob.match(filenamePattern, basename(resource.fsPath).toLowerCase())\n\t\t) {\n\t\t\tif (excludeFilenamePattern) {\n\t\t\t\tif (\n\t\t\t\t\tglob.match(\n\t\t\t\t\t\texcludeFilenamePattern,\n\t\t\t\t\t\tbasename(resource.fsPath).toLowerCase(),\n\t\t\t\t\t)\n\t\t\t\t) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tstatic possibleFileEnding(\n\t\tselectors: NotebookSelector[],\n\t): string | undefined {\n\t\tfor (const selector of selectors) {\n\t\t\tconst ending = NotebookProviderInfo._possibleFileEnding(selector);\n\t\t\tif (ending) {\n\t\t\t\treturn ending;\n\t\t\t}\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tprivate static _possibleFileEnding(\n\t\tselector: NotebookSelector,\n\t): string | undefined {\n\t\tconst pattern = /^.*(\\.[a-zA-Z0-9_-]+)$/;\n\n\t\tlet candidate: string | undefined;\n\n\t\tif (typeof selector === \"string\") {\n\t\t\tcandidate = selector;\n\t\t} else if (glob.isRelativePattern(selector)) {\n\t\t\tcandidate = selector.pattern;\n\t\t} else if (selector.include) {\n\t\t\treturn NotebookProviderInfo._possibleFileEnding(selector.include);\n\t\t}\n\n\t\tif (candidate) {\n\t\t\tconst match = pattern.exec(candidate);\n\t\t\tif (match) {\n\t\t\t\treturn match[1];\n\t\t\t}\n\t\t}\n\n\t\treturn undefined;\n\t}\n}\n"],
  "mappings": ";;AAKA,YAAY,UAAU;AACtB,SAAS,gBAAgB;AAIzB;AAAA,EAGC;AAAA,OACM;AAmBA,MAAM,qBAAqB;AAAA,EAjClC,OAiCkC;AAAA;AAAA;AAAA,EACxB;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EAED;AAAA,EACR,IAAI,YAAY;AACf,WAAO,KAAK;AAAA,EACb;AAAA,EACQ;AAAA,EACR,IAAI,UAAU;AACb,WAAO,KAAK;AAAA,EACb;AAAA,EAEA,YAAY,YAAsC;AACjD,SAAK,YAAY,WAAW;AAC5B,SAAK,KAAK,WAAW;AACrB,SAAK,cAAc,WAAW;AAC9B,SAAK,aACJ,WAAW,WAAW,IAAI,CAAC,cAAc;AAAA,MACxC,SAAS,SAAS;AAAA,MAClB,SAAS,SAAS,0BAA0B;AAAA,IAC7C,EAAE,KAAK,CAAC;AACT,SAAK,WAAW,WAAW;AAC3B,SAAK,sBAAsB,WAAW;AACtC,SAAK,WAAW;AAAA,MACf,uBAAuB,CAAC;AAAA,MACxB,2BAA2B,CAAC;AAAA,MAC5B,kBAAkB;AAAA,MAClB,qBAAqB,CAAC;AAAA,IACvB;AAAA,EACD;AAAA,EAEA,OAAO,MAGJ;AACF,QAAI,KAAK,WAAW;AACnB,WAAK,aAAa,KAAK;AAAA,IACxB;AAEA,QAAI,KAAK,SAAS;AACjB,WAAK,WAAW,KAAK;AAAA,IACtB;AAAA,EACD;AAAA,EAEA,QAAQ,UAAwB;AAC/B,WAAO,KAAK,WAAW;AAAA,MAAK,CAAC,aAC5B,qBAAqB,gBAAgB,UAAU,QAAQ;AAAA,IACxD;AAAA,EACD;AAAA,EAEA,OAAO,gBAAgB,UAA4B,UAAwB;AAC1E,QAAI,OAAO,aAAa,UAAU;AAEjC,UACC,KAAK;AAAA,QACJ,SAAS,YAAY;AAAA,QACrB,SAAS,SAAS,MAAM,EAAE,YAAY;AAAA,MACvC,GACC;AACD,eAAO;AAAA,MACR;AAAA,IACD;AAEA,QAAI,KAAK,kBAAkB,QAAQ,GAAG;AACrC,UAAI,KAAK,MAAM,UAAU,SAAS,SAAS,MAAM,EAAE,YAAY,CAAC,GAAG;AAClE,eAAO;AAAA,MACR;AAAA,IACD;AAEA,QAAI,CAAC,yBAAyB,QAAQ,GAAG;AACxC,aAAO;AAAA,IACR;AAEA,UAAM,kBAAkB,SAAS;AACjC,UAAM,yBAAyB,SAAS;AAExC,QACC,KAAK,MAAM,iBAAiB,SAAS,SAAS,MAAM,EAAE,YAAY,CAAC,GAClE;AACD,UAAI,wBAAwB;AAC3B,YACC,KAAK;AAAA,UACJ;AAAA,UACA,SAAS,SAAS,MAAM,EAAE,YAAY;AAAA,QACvC,GACC;AACD,iBAAO;AAAA,QACR;AAAA,MACD;AACA,aAAO;AAAA,IACR;AAEA,WAAO;AAAA,EACR;AAAA,EAEA,OAAO,mBACN,WACqB;AACrB,eAAW,YAAY,WAAW;AACjC,YAAM,SAAS,qBAAqB,oBAAoB,QAAQ;AAChE,UAAI,QAAQ;AACX,eAAO;AAAA,MACR;AAAA,IACD;AACA,WAAO;AAAA,EACR;AAAA,EAEA,OAAe,oBACd,UACqB;AACrB,UAAM,UAAU;AAEhB,QAAI;AAEJ,QAAI,OAAO,aAAa,UAAU;AACjC,kBAAY;AAAA,IACb,WAAW,KAAK,kBAAkB,QAAQ,GAAG;AAC5C,kBAAY,SAAS;AAAA,IACtB,WAAW,SAAS,SAAS;AAC5B,aAAO,qBAAqB,oBAAoB,SAAS,OAAO;AAAA,IACjE;AAEA,QAAI,WAAW;AACd,YAAM,QAAQ,QAAQ,KAAK,SAAS;AACpC,UAAI,OAAO;AACV,eAAO,MAAM,CAAC;AAAA,MACf;AAAA,IACD;AAEA,WAAO;AAAA,EACR;AACD;",
  "names": []
}
