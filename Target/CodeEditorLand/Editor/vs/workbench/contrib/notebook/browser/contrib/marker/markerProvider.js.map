{
  "version": 3,
  "sources": ["../../../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/notebook/browser/contrib/marker/markerProvider.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { throttle } from \"../../../../../../base/common/decorators.js\";\nimport {\n\tDisposable,\n\ttype IDisposable,\n} from \"../../../../../../base/common/lifecycle.js\";\nimport { isEqual } from \"../../../../../../base/common/resources.js\";\nimport type { URI } from \"../../../../../../base/common/uri.js\";\nimport {\n\ttype IMarkerListProvider,\n\tIMarkerNavigationService,\n\tMarkerList,\n} from \"../../../../../../editor/contrib/gotoError/browser/markerNavigationService.js\";\nimport { IConfigurationService } from \"../../../../../../platform/configuration/common/configuration.js\";\nimport {\n\tIMarkerService,\n\tMarkerSeverity,\n} from \"../../../../../../platform/markers/common/markers.js\";\nimport {\n\teditorErrorForeground,\n\teditorWarningForeground,\n} from \"../../../../../../platform/theme/common/colorRegistry.js\";\nimport {\n\tWorkbenchPhase,\n\tregisterWorkbenchContribution2,\n} from \"../../../../../common/contributions.js\";\nimport { CellUri } from \"../../../common/notebookCommon.js\";\nimport {\n\ttype INotebookDeltaDecoration,\n\ttype INotebookEditor,\n\ttype INotebookEditorContribution,\n\tNotebookOverviewRulerLane,\n} from \"../../notebookBrowser.js\";\nimport { registerNotebookContribution } from \"../../notebookEditorExtensions.js\";\n\nclass MarkerListProvider implements IMarkerListProvider {\n\tstatic readonly ID = \"workbench.contrib.markerListProvider\";\n\n\tprivate readonly _dispoables: IDisposable;\n\n\tconstructor(\n\t\t@IMarkerService private readonly _markerService: IMarkerService,\n\t\t@IMarkerNavigationService markerNavigation: IMarkerNavigationService,\n\t\t@IConfigurationService\n\t\tprivate readonly _configService: IConfigurationService,\n\t) {\n\t\tthis._dispoables = markerNavigation.registerProvider(this);\n\t}\n\n\tdispose() {\n\t\tthis._dispoables.dispose();\n\t}\n\n\tgetMarkerList(resource: URI | undefined): MarkerList | undefined {\n\t\tif (!resource) {\n\t\t\treturn undefined;\n\t\t}\n\t\tconst data = CellUri.parse(resource);\n\t\tif (!data) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn new MarkerList(\n\t\t\t(uri) => {\n\t\t\t\tconst otherData = CellUri.parse(uri);\n\t\t\t\treturn (\n\t\t\t\t\totherData?.notebook.toString() === data.notebook.toString()\n\t\t\t\t);\n\t\t\t},\n\t\t\tthis._markerService,\n\t\t\tthis._configService,\n\t\t);\n\t}\n}\n\nclass NotebookMarkerDecorationContribution\n\textends Disposable\n\timplements INotebookEditorContribution\n{\n\tstatic id = \"workbench.notebook.markerDecoration\";\n\tprivate _markersOverviewRulerDecorations: string[] = [];\n\tconstructor(\n\t\tprivate readonly _notebookEditor: INotebookEditor,\n\t\t@IMarkerService private readonly _markerService: IMarkerService,\n\t) {\n\t\tsuper();\n\n\t\tthis._update();\n\t\tthis._register(\n\t\t\tthis._notebookEditor.onDidChangeModel(() => this._update()),\n\t\t);\n\t\tthis._register(\n\t\t\tthis._markerService.onMarkerChanged((e) => {\n\t\t\t\tif (\n\t\t\t\t\te.some((uri) =>\n\t\t\t\t\t\tthis._notebookEditor\n\t\t\t\t\t\t\t.getCellsInRange()\n\t\t\t\t\t\t\t.some((cell) => isEqual(cell.uri, uri)),\n\t\t\t\t\t)\n\t\t\t\t) {\n\t\t\t\t\tthis._update();\n\t\t\t\t}\n\t\t\t}),\n\t\t);\n\t}\n\n\t@throttle(100)\n\tprivate _update() {\n\t\tif (!this._notebookEditor.hasModel()) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst cellDecorations: INotebookDeltaDecoration[] = [];\n\t\tthis._notebookEditor.getCellsInRange().forEach((cell) => {\n\t\t\tconst marker = this._markerService.read({\n\t\t\t\tresource: cell.uri,\n\t\t\t\tseverities: MarkerSeverity.Error | MarkerSeverity.Warning,\n\t\t\t});\n\t\t\tmarker.forEach((m) => {\n\t\t\t\tconst color =\n\t\t\t\t\tm.severity === MarkerSeverity.Error\n\t\t\t\t\t\t? editorErrorForeground\n\t\t\t\t\t\t: editorWarningForeground;\n\t\t\t\tconst range = {\n\t\t\t\t\tstartLineNumber: m.startLineNumber,\n\t\t\t\t\tstartColumn: m.startColumn,\n\t\t\t\t\tendLineNumber: m.endLineNumber,\n\t\t\t\t\tendColumn: m.endColumn,\n\t\t\t\t};\n\t\t\t\tcellDecorations.push({\n\t\t\t\t\thandle: cell.handle,\n\t\t\t\t\toptions: {\n\t\t\t\t\t\toverviewRuler: {\n\t\t\t\t\t\t\tcolor: color,\n\t\t\t\t\t\t\tmodelRanges: [range],\n\t\t\t\t\t\t\tincludeOutput: false,\n\t\t\t\t\t\t\tposition: NotebookOverviewRulerLane.Right,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\n\t\tthis._markersOverviewRulerDecorations =\n\t\t\tthis._notebookEditor.deltaCellDecorations(\n\t\t\t\tthis._markersOverviewRulerDecorations,\n\t\t\t\tcellDecorations,\n\t\t\t);\n\t}\n}\n\nregisterWorkbenchContribution2(\n\tMarkerListProvider.ID,\n\tMarkerListProvider,\n\tWorkbenchPhase.BlockRestore,\n);\n\nregisterNotebookContribution(\n\tNotebookMarkerDecorationContribution.id,\n\tNotebookMarkerDecorationContribution,\n);\n"],
  "mappings": "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",
  "names": []
}
