{
  "version": 3,
  "sources": ["../../../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/notebook/browser/view/renderers/backLayerWebView.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { getWindow } from \"../../../../../../base/browser/dom.js\";\nimport type { IMouseWheelEvent } from \"../../../../../../base/browser/mouseEvent.js\";\nimport type { CodeWindow } from \"../../../../../../base/browser/window.js\";\nimport type {\n\tWorkbenchActionExecutedClassification,\n\tWorkbenchActionExecutedEvent,\n} from \"../../../../../../base/common/actions.js\";\nimport { coalesce } from \"../../../../../../base/common/arrays.js\";\nimport {\n\tDeferredPromise,\n\trunWhenGlobalIdle,\n} from \"../../../../../../base/common/async.js\";\nimport { decodeBase64 } from \"../../../../../../base/common/buffer.js\";\nimport { Emitter, type Event } from \"../../../../../../base/common/event.js\";\nimport type { IDisposable } from \"../../../../../../base/common/lifecycle.js\";\nimport { getExtensionForMimeType } from \"../../../../../../base/common/mime.js\";\nimport {\n\tFileAccess,\n\tSchemas,\n\tmatchesScheme,\n\tmatchesSomeScheme,\n} from \"../../../../../../base/common/network.js\";\nimport { equals } from \"../../../../../../base/common/objects.js\";\nimport * as osPath from \"../../../../../../base/common/path.js\";\nimport { isMacintosh, isWeb } from \"../../../../../../base/common/platform.js\";\nimport {\n\tdirname,\n\textname,\n\tisEqual,\n\tjoinPath,\n} from \"../../../../../../base/common/resources.js\";\nimport { URI } from \"../../../../../../base/common/uri.js\";\nimport * as UUID from \"../../../../../../base/common/uuid.js\";\nimport { TokenizationRegistry } from \"../../../../../../editor/common/languages.js\";\nimport { ILanguageService } from \"../../../../../../editor/common/languages/language.js\";\nimport { generateTokensCSSForColorMap } from \"../../../../../../editor/common/languages/supports/tokenization.js\";\nimport { tokenizeToString } from \"../../../../../../editor/common/languages/textToHtmlTokenizer.js\";\nimport * as nls from \"../../../../../../nls.js\";\nimport { MenuId } from \"../../../../../../platform/actions/common/actions.js\";\nimport { IConfigurationService } from \"../../../../../../platform/configuration/common/configuration.js\";\nimport { IContextKeyService } from \"../../../../../../platform/contextkey/common/contextkey.js\";\nimport { IContextMenuService } from \"../../../../../../platform/contextview/browser/contextView.js\";\nimport { IFileDialogService } from \"../../../../../../platform/dialogs/common/dialogs.js\";\nimport type {\n\tITextEditorOptions,\n\tITextEditorSelection,\n} from \"../../../../../../platform/editor/common/editor.js\";\nimport { IFileService } from \"../../../../../../platform/files/common/files.js\";\nimport { IOpenerService } from \"../../../../../../platform/opener/common/opener.js\";\nimport { IStorageService } from \"../../../../../../platform/storage/common/storage.js\";\nimport { ITelemetryService } from \"../../../../../../platform/telemetry/common/telemetry.js\";\nimport {\n\teditorFindMatch,\n\teditorFindMatchHighlight,\n} from \"../../../../../../platform/theme/common/colorRegistry.js\";\nimport {\n\tIThemeService,\n\tThemable,\n} from \"../../../../../../platform/theme/common/themeService.js\";\nimport { IWorkspaceContextService } from \"../../../../../../platform/workspace/common/workspace.js\";\nimport { IWorkspaceTrustManagementService } from \"../../../../../../platform/workspace/common/workspaceTrust.js\";\nimport type { EditorInput } from \"../../../../../common/editor/editorInput.js\";\nimport {\n\ttype IEditorGroup,\n\tIEditorGroupsService,\n} from \"../../../../../services/editor/common/editorGroupsService.js\";\nimport { IWorkbenchEnvironmentService } from \"../../../../../services/environment/common/environmentService.js\";\nimport { IPathService } from \"../../../../../services/path/common/pathService.js\";\nimport {\n\ttype IWebviewElement,\n\tIWebviewService,\n\tWebviewContentPurpose,\n\tWebviewOriginStore,\n} from \"../../../../webview/browser/webview.js\";\nimport { WebviewWindowDragMonitor } from \"../../../../webview/browser/webviewWindowDragMonitor.js\";\nimport {\n\tasWebviewUri,\n\twebviewGenericCspSource,\n} from \"../../../../webview/common/webview.js\";\nimport {\n\tCellUri,\n\ttype ICellOutput,\n\ttype INotebookRendererInfo,\n\tRendererMessagingSpec,\n} from \"../../../common/notebookCommon.js\";\nimport type { INotebookKernel } from \"../../../common/notebookKernelService.js\";\nimport { INotebookLoggingService } from \"../../../common/notebookLoggingService.js\";\nimport type { IScopedRendererMessaging } from \"../../../common/notebookRendererMessagingService.js\";\nimport { INotebookService } from \"../../../common/notebookService.js\";\nimport {\n\tCellEditState,\n\ttype ICellOutputViewModel,\n\ttype ICellViewModel,\n\ttype ICommonCellInfo,\n\ttype IDisplayOutputLayoutUpdateRequest,\n\ttype IDisplayOutputViewModel,\n\ttype IFocusNotebookCellOptions,\n\ttype IGenericCellViewModel,\n\ttype IInsetRenderOutput,\n\ttype INotebookEditorCreationOptions,\n\ttype INotebookWebviewMessage,\n\tRenderOutputType,\n} from \"../../notebookBrowser.js\";\nimport { MarkupCellViewModel } from \"../../viewModel/markupCellViewModel.js\";\nimport { NOTEBOOK_WEBVIEW_BOUNDARY } from \"../notebookCellList.js\";\nimport type {\n\tFromWebviewMessage,\n\tIAckOutputHeight,\n\tIClickedDataUrlMessage,\n\tICodeBlockHighlightRequest,\n\tIContentWidgetTopRequest,\n\tIControllerPreload,\n\tICreationContent,\n\tICreationRequestMessage,\n\tIFindMatch,\n\tIMarkupCellInitialization,\n\tRendererMetadata,\n\tStaticPreloadMetadata,\n\tToWebviewMessage,\n} from \"./webviewMessages.js\";\nimport { preloadsScriptStr } from \"./webviewPreloads.js\";\nimport { transformWebviewThemeVars } from \"./webviewThemeMapping.js\";\n\nconst LINE_COLUMN_REGEX = /:([\\d]+)(?::([\\d]+))?$/;\nconst LineQueryRegex = /line=(\\d+)$/;\nconst FRAGMENT_REGEX = /^(.*)#([^#]*)$/;\n\nexport interface ICachedInset<K extends ICommonCellInfo> {\n\toutputId: string;\n\tversionId: number;\n\tcellInfo: K;\n\trenderer?: INotebookRendererInfo;\n\tcachedCreation: ICreationRequestMessage;\n\tinitialized?: boolean;\n}\n\nexport interface IResolvedBackLayerWebview {\n\twebview: IWebviewElement;\n}\n\n/**\n * Notebook Editor Delegate for back layer webview\n */\nexport interface INotebookDelegateForWebview {\n\treadonly creationOptions: INotebookEditorCreationOptions;\n\tgetCellById(cellId: string): IGenericCellViewModel | undefined;\n\tfocusNotebookCell(\n\t\tcell: IGenericCellViewModel,\n\t\tfocus: \"editor\" | \"container\" | \"output\",\n\t\toptions?: IFocusNotebookCellOptions,\n\t): Promise<void>;\n\ttoggleNotebookCellSelection(\n\t\tcell: IGenericCellViewModel,\n\t\tselectFromPrevious: boolean,\n\t): void;\n\tgetCellByInfo(cellInfo: ICommonCellInfo): IGenericCellViewModel;\n\tfocusNextNotebookCell(\n\t\tcell: IGenericCellViewModel,\n\t\tfocus: \"editor\" | \"container\" | \"output\",\n\t): Promise<void>;\n\tupdateOutputHeight(\n\t\tcellInfo: ICommonCellInfo,\n\t\toutput: IDisplayOutputViewModel,\n\t\theight: number,\n\t\tisInit: boolean,\n\t\tsource?: string,\n\t): void;\n\tscheduleOutputHeightAck(\n\t\tcellInfo: ICommonCellInfo,\n\t\toutputId: string,\n\t\theight: number,\n\t): void;\n\tupdateMarkupCellHeight(\n\t\tcellId: string,\n\t\theight: number,\n\t\tisInit: boolean,\n\t): void;\n\tsetMarkupCellEditState(cellId: string, editState: CellEditState): void;\n\tdidStartDragMarkupCell(\n\t\tcellId: string,\n\t\tevent: { dragOffsetY: number },\n\t): void;\n\tdidDragMarkupCell(cellId: string, event: { dragOffsetY: number }): void;\n\tdidDropMarkupCell(\n\t\tcellId: string,\n\t\tevent: { dragOffsetY: number; ctrlKey: boolean; altKey: boolean },\n\t): void;\n\tdidEndDragMarkupCell(cellId: string): void;\n\tdidResizeOutput(cellId: string): void;\n\tsetScrollTop(scrollTop: number): void;\n\ttriggerScroll(event: IMouseWheelEvent): void;\n\tupdatePerformanceMetadata(\n\t\tcellId: string,\n\t\texecutionId: string,\n\t\tduration: number,\n\t\trendererId: string,\n\t): void;\n\tdidFocusOutputInputChange(inputFocused: boolean): void;\n}\n\ninterface BacklayerWebviewOptions {\n\treadonly outputNodePadding: number;\n\treadonly outputNodeLeftPadding: number;\n\treadonly previewNodePadding: number;\n\treadonly markdownLeftMargin: number;\n\treadonly leftMargin: number;\n\treadonly rightMargin: number;\n\treadonly runGutter: number;\n\treadonly dragAndDropEnabled: boolean;\n\treadonly fontSize: number;\n\treadonly outputFontSize: number;\n\treadonly fontFamily: string;\n\treadonly outputFontFamily: string;\n\treadonly markupFontSize: number;\n\treadonly markdownLineHeight: number;\n\treadonly outputLineHeight: number;\n\treadonly outputScrolling: boolean;\n\treadonly outputWordWrap: boolean;\n\treadonly outputLineLimit: number;\n\treadonly outputLinkifyFilePaths: boolean;\n\treadonly minimalError: boolean;\n}\n\nexport class BackLayerWebView<T extends ICommonCellInfo> extends Themable {\n\tprivate static _originStore?: WebviewOriginStore;\n\n\tprivate static getOriginStore(\n\t\tstorageService: IStorageService,\n\t): WebviewOriginStore {\n\t\tthis._originStore ??= new WebviewOriginStore(\n\t\t\t\"notebook.backlayerWebview.origins\",\n\t\t\tstorageService,\n\t\t);\n\t\treturn this._originStore;\n\t}\n\n\telement: HTMLElement;\n\twebview: IWebviewElement | undefined = undefined;\n\tinsetMapping: Map<IDisplayOutputViewModel, ICachedInset<T>> = new Map();\n\tpendingWebviewIdleCreationRequest: Map<\n\t\tIDisplayOutputViewModel,\n\t\tIDisposable\n\t> = new Map();\n\tpendingWebviewIdleInsetMapping: Map<\n\t\tIDisplayOutputViewModel,\n\t\tICachedInset<T>\n\t> = new Map();\n\tprivate reversedPendingWebviewIdleInsetMapping: Map<\n\t\tstring,\n\t\tIDisplayOutputViewModel\n\t> = new Map();\n\n\treadonly markupPreviewMapping = new Map<\n\t\tstring,\n\t\tIMarkupCellInitialization\n\t>();\n\tprivate hiddenInsetMapping: Set<IDisplayOutputViewModel> = new Set();\n\tprivate reversedInsetMapping: Map<string, IDisplayOutputViewModel> =\n\t\tnew Map();\n\tprivate localResourceRootsCache: URI[] | undefined = undefined;\n\tprivate readonly _onMessage = this._register(\n\t\tnew Emitter<INotebookWebviewMessage>(),\n\t);\n\tprivate readonly _preloadsCache = new Set<string>();\n\tpublic readonly onMessage: Event<INotebookWebviewMessage> =\n\t\tthis._onMessage.event;\n\tprivate _disposed = false;\n\tprivate _currentKernel?: INotebookKernel;\n\n\tprivate firstInit = true;\n\tprivate initializeMarkupPromise?: {\n\t\treadonly requestId: string;\n\t\treadonly p: DeferredPromise<void>;\n\t\treadonly isFirstInit: boolean;\n\t};\n\n\tprivate readonly nonce = UUID.generateUuid();\n\n\tconstructor(\n\t\tpublic notebookEditor: INotebookDelegateForWebview,\n\t\tprivate readonly id: string,\n\t\tpublic readonly notebookViewType: string,\n\t\tpublic readonly documentUri: URI,\n\t\tprivate options: BacklayerWebviewOptions,\n\t\tprivate readonly rendererMessaging: IScopedRendererMessaging | undefined,\n\t\t@IWebviewService private readonly webviewService: IWebviewService,\n\t\t@IOpenerService private readonly openerService: IOpenerService,\n\t\t@INotebookService private readonly notebookService: INotebookService,\n\t\t@IWorkspaceContextService private readonly contextService: IWorkspaceContextService,\n\t\t@IWorkbenchEnvironmentService private readonly environmentService: IWorkbenchEnvironmentService,\n\t\t@IFileDialogService private readonly fileDialogService: IFileDialogService,\n\t\t@IFileService private readonly fileService: IFileService,\n\t\t@IContextMenuService private readonly contextMenuService: IContextMenuService,\n\t\t@IContextKeyService private readonly contextKeyService: IContextKeyService,\n\t\t@IWorkspaceTrustManagementService private readonly workspaceTrustManagementService: IWorkspaceTrustManagementService,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@ILanguageService private readonly languageService: ILanguageService,\n\t\t@IWorkspaceContextService private readonly workspaceContextService: IWorkspaceContextService,\n\t\t@IEditorGroupsService private readonly editorGroupService: IEditorGroupsService,\n\t\t@IStorageService private readonly storageService: IStorageService,\n\t\t@IPathService private readonly pathService: IPathService,\n\t\t@INotebookLoggingService private readonly notebookLogService: INotebookLoggingService,\n\t\t@IThemeService themeService: IThemeService,\n\t\t@ITelemetryService private readonly telemetryService: ITelemetryService\n\t) {\n\t\tsuper(themeService);\n\n\t\tthis._logRendererDebugMessage('Creating backlayer webview for notebook');\n\n\t\tthis.element = document.createElement('div');\n\n\t\tthis.element.style.height = '1400px';\n\t\tthis.element.style.position = 'absolute';\n\n\t\tif (rendererMessaging) {\n\t\t\tthis._register(rendererMessaging);\n\t\t\trendererMessaging.receiveMessageHandler = (rendererId, message) => {\n\t\t\t\tif (!this.webview || this._disposed) {\n\t\t\t\t\treturn Promise.resolve(false);\n\t\t\t\t}\n\n\t\t\t\tthis._sendMessageToWebview({\n\t\t\t\t\t__vscode_notebook_message: true,\n\t\t\t\t\ttype: 'customRendererMessage',\n\t\t\t\t\trendererId: rendererId,\n\t\t\t\t\tmessage: message\n\t\t\t\t});\n\n\t\t\t\treturn Promise.resolve(true);\n\t\t\t};\n\t\t}\n\n\t\tthis._register(workspaceTrustManagementService.onDidChangeTrust(e => {\n\t\t\tconst baseUrl = this.asWebviewUri(this.getNotebookBaseUri(), undefined);\n\t\t\tconst htmlContent = this.generateContent(baseUrl.toString());\n\t\t\tthis.webview?.setHtml(htmlContent);\n\t\t}));\n\n\t\tthis._register(TokenizationRegistry.onDidChange(() => {\n\t\t\tthis._sendMessageToWebview({\n\t\t\t\ttype: 'tokenizedStylesChanged',\n\t\t\t\tcss: getTokenizationCss(),\n\t\t\t});\n\t\t}));\n\t}\n\n\tupdateOptions(options: BacklayerWebviewOptions) {\n\t\tthis.options = options;\n\t\tthis._updateStyles();\n\t\tthis._updateOptions();\n\t}\n\n\tprivate _logRendererDebugMessage(msg: string) {\n\t\tthis.notebookLogService.debug(\n\t\t\t\"BacklayerWebview\",\n\t\t\t`${this.documentUri} (${this.id}) - ${msg}`,\n\t\t);\n\t}\n\n\tprivate _updateStyles() {\n\t\tthis._sendMessageToWebview({\n\t\t\ttype: \"notebookStyles\",\n\t\t\tstyles: this._generateStyles(),\n\t\t});\n\t}\n\n\tprivate _updateOptions() {\n\t\tthis._sendMessageToWebview({\n\t\t\ttype: \"notebookOptions\",\n\t\t\toptions: {\n\t\t\t\tdragAndDropEnabled: this.options.dragAndDropEnabled,\n\t\t\t},\n\t\t\trenderOptions: {\n\t\t\t\tlineLimit: this.options.outputLineLimit,\n\t\t\t\toutputScrolling: this.options.outputScrolling,\n\t\t\t\toutputWordWrap: this.options.outputWordWrap,\n\t\t\t\tlinkifyFilePaths: this.options.outputLinkifyFilePaths,\n\t\t\t\tminimalError: this.options.minimalError,\n\t\t\t},\n\t\t});\n\t}\n\n\tprivate _generateStyles() {\n\t\treturn {\n\t\t\t\"notebook-output-left-margin\": `${this.options.leftMargin + this.options.runGutter}px`,\n\t\t\t\"notebook-output-width\": `calc(100% - ${this.options.leftMargin + this.options.rightMargin + this.options.runGutter}px)`,\n\t\t\t\"notebook-output-node-padding\": `${this.options.outputNodePadding}px`,\n\t\t\t\"notebook-run-gutter\": `${this.options.runGutter}px`,\n\t\t\t\"notebook-preview-node-padding\": `${this.options.previewNodePadding}px`,\n\t\t\t\"notebook-markdown-left-margin\": `${this.options.markdownLeftMargin}px`,\n\t\t\t\"notebook-output-node-left-padding\": `${this.options.outputNodeLeftPadding}px`,\n\t\t\t\"notebook-markdown-min-height\": `${this.options.previewNodePadding * 2}px`,\n\t\t\t\"notebook-markup-font-size\":\n\t\t\t\ttypeof this.options.markupFontSize === \"number\" &&\n\t\t\t\tthis.options.markupFontSize > 0\n\t\t\t\t\t? `${this.options.markupFontSize}px`\n\t\t\t\t\t: `calc(${this.options.fontSize}px * 1.2)`,\n\t\t\t\"notebook-markdown-line-height\":\n\t\t\t\ttypeof this.options.markdownLineHeight === \"number\" &&\n\t\t\t\tthis.options.markdownLineHeight > 0\n\t\t\t\t\t? `${this.options.markdownLineHeight}px`\n\t\t\t\t\t: `normal`,\n\t\t\t\"notebook-cell-output-font-size\": `${this.options.outputFontSize || this.options.fontSize}px`,\n\t\t\t\"notebook-cell-output-line-height\": `${this.options.outputLineHeight}px`,\n\t\t\t\"notebook-cell-output-max-height\": `${this.options.outputLineHeight * this.options.outputLineLimit + 2}px`,\n\t\t\t\"notebook-cell-output-font-family\":\n\t\t\t\tthis.options.outputFontFamily || this.options.fontFamily,\n\t\t\t\"notebook-cell-markup-empty-content\": nls.localize(\n\t\t\t\t\"notebook.emptyMarkdownPlaceholder\",\n\t\t\t\t\"Empty markdown cell, double-click or press enter to edit.\",\n\t\t\t),\n\t\t\t\"notebook-cell-renderer-not-found-error\": nls.localize(\n\t\t\t\t{\n\t\t\t\t\tkey: \"notebook.error.rendererNotFound\",\n\t\t\t\t\tcomment: [\"$0 is a placeholder for the mime type\"],\n\t\t\t\t},\n\t\t\t\t\"No renderer found for '$0'\",\n\t\t\t),\n\t\t\t\"notebook-cell-renderer-fallbacks-exhausted\": nls.localize(\n\t\t\t\t{\n\t\t\t\t\tkey: \"notebook.error.rendererFallbacksExhausted\",\n\t\t\t\t\tcomment: [\"$0 is a placeholder for the mime type\"],\n\t\t\t\t},\n\t\t\t\t\"Could not render content for '$0'\",\n\t\t\t),\n\t\t};\n\t}\n\n\tprivate generateContent(baseUrl: string) {\n\t\tconst renderersData = this.getRendererData();\n\t\tconst preloadsData = this.getStaticPreloadsData();\n\t\tconst renderOptions = {\n\t\t\tlineLimit: this.options.outputLineLimit,\n\t\t\toutputScrolling: this.options.outputScrolling,\n\t\t\toutputWordWrap: this.options.outputWordWrap,\n\t\t\tlinkifyFilePaths: this.options.outputLinkifyFilePaths,\n\t\t\tminimalError: this.options.minimalError,\n\t\t};\n\t\tconst preloadScript = preloadsScriptStr(\n\t\t\t{\n\t\t\t\t...this.options,\n\t\t\t\ttokenizationCss: getTokenizationCss(),\n\t\t\t},\n\t\t\t{ dragAndDropEnabled: this.options.dragAndDropEnabled },\n\t\t\trenderOptions,\n\t\t\trenderersData,\n\t\t\tpreloadsData,\n\t\t\tthis.workspaceTrustManagementService.isWorkspaceTrusted(),\n\t\t\tthis.nonce,\n\t\t);\n\n\t\tconst enableCsp = this.configurationService.getValue(\n\t\t\t\"notebook.experimental.enableCsp\",\n\t\t);\n\t\tconst currentHighlight = this.getColor(editorFindMatch);\n\t\tconst findMatchHighlight = this.getColor(editorFindMatchHighlight);\n\t\treturn /* html */ `\n\t\t<html lang=\"en\">\n\t\t\t<head>\n\t\t\t\t<meta charset=\"UTF-8\">\n\t\t\t\t<base href=\"${baseUrl}/\" />\n\t\t\t\t${\n\t\t\t\t\tenableCsp\n\t\t\t\t\t\t? `<meta http-equiv=\"Content-Security-Policy\" content=\"\n\t\t\t\t\tdefault-src 'none';\n\t\t\t\t\tscript-src ${webviewGenericCspSource} 'unsafe-inline' 'unsafe-eval';\n\t\t\t\t\tstyle-src ${webviewGenericCspSource} 'unsafe-inline';\n\t\t\t\t\timg-src ${webviewGenericCspSource} https: http: data:;\n\t\t\t\t\tfont-src ${webviewGenericCspSource} https:;\n\t\t\t\t\tconnect-src https:;\n\t\t\t\t\tchild-src https: data:;\n\t\t\t\t\">`\n\t\t\t\t\t\t: \"\"\n\t\t\t\t}\n\t\t\t\t<style nonce=\"${this.nonce}\">\n\t\t\t\t\t::highlight(find-highlight) {\n\t\t\t\t\t\tbackground-color: var(--vscode-editor-findMatchBackground, ${findMatchHighlight});\n\t\t\t\t\t}\n\n\t\t\t\t\t::highlight(current-find-highlight) {\n\t\t\t\t\t\tbackground-color: var(--vscode-editor-findMatchHighlightBackground, ${currentHighlight});\n\t\t\t\t\t}\n\n\t\t\t\t\t#container .cell_container {\n\t\t\t\t\t\twidth: 100%;\n\t\t\t\t\t}\n\n\t\t\t\t\t#container .output_container {\n\t\t\t\t\t\twidth: 100%;\n\t\t\t\t\t}\n\n\t\t\t\t\t#container > div > div > div.output {\n\t\t\t\t\t\tfont-size: var(--notebook-cell-output-font-size);\n\t\t\t\t\t\twidth: var(--notebook-output-width);\n\t\t\t\t\t\tmargin-left: var(--notebook-output-left-margin);\n\t\t\t\t\t\tbackground-color: var(--theme-notebook-output-background);\n\t\t\t\t\t\tpadding-top: var(--notebook-output-node-padding);\n\t\t\t\t\t\tpadding-right: var(--notebook-output-node-padding);\n\t\t\t\t\t\tpadding-bottom: var(--notebook-output-node-padding);\n\t\t\t\t\t\tpadding-left: var(--notebook-output-node-left-padding);\n\t\t\t\t\t\tbox-sizing: border-box;\n\t\t\t\t\t\tborder-top: none;\n\t\t\t\t\t}\n\n\t\t\t\t\t/* markdown */\n\t\t\t\t\t#container div.preview {\n\t\t\t\t\t\twidth: 100%;\n\t\t\t\t\t\tpadding-right: var(--notebook-preview-node-padding);\n\t\t\t\t\t\tpadding-left: var(--notebook-markdown-left-margin);\n\t\t\t\t\t\tpadding-top: var(--notebook-preview-node-padding);\n\t\t\t\t\t\tpadding-bottom: var(--notebook-preview-node-padding);\n\n\t\t\t\t\t\tbox-sizing: border-box;\n\t\t\t\t\t\twhite-space: nowrap;\n\t\t\t\t\t\toverflow: hidden;\n\t\t\t\t\t\twhite-space: initial;\n\n\t\t\t\t\t\tfont-size: var(--notebook-markup-font-size);\n\t\t\t\t\t\tline-height: var(--notebook-markdown-line-height);\n\t\t\t\t\t\tcolor: var(--theme-ui-foreground);\n\t\t\t\t\t}\n\n\t\t\t\t\t#container div.preview.draggable {\n\t\t\t\t\t\tuser-select: none;\n\t\t\t\t\t\t-webkit-user-select: none;\n\t\t\t\t\t\t-ms-user-select: none;\n\t\t\t\t\t\tcursor: grab;\n\t\t\t\t\t}\n\n\t\t\t\t\t#container div.preview.selected {\n\t\t\t\t\t\tbackground: var(--theme-notebook-cell-selected-background);\n\t\t\t\t\t}\n\n\t\t\t\t\t#container div.preview.dragging {\n\t\t\t\t\t\tbackground-color: var(--theme-background);\n\t\t\t\t\t\topacity: 0.5 !important;\n\t\t\t\t\t}\n\n\t\t\t\t\t.monaco-workbench.vs-dark .notebookOverlay .cell.markdown .latex img,\n\t\t\t\t\t.monaco-workbench.vs-dark .notebookOverlay .cell.markdown .latex-block img {\n\t\t\t\t\t\tfilter: brightness(0) invert(1)\n\t\t\t\t\t}\n\n\t\t\t\t\t#container .markup > div.nb-symbolHighlight {\n\t\t\t\t\t\tbackground-color: var(--theme-notebook-symbol-highlight-background);\n\t\t\t\t\t}\n\n\t\t\t\t\t#container .nb-symbolHighlight .output_container .output {\n\t\t\t\t\t\tbackground-color: var(--theme-notebook-symbol-highlight-background);\n\t\t\t\t\t}\n\n\t\t\t\t\t#container .markup > div.nb-multiCellHighlight {\n\t\t\t\t\t\tbackground-color: var(--theme-notebook-symbol-highlight-background);\n\t\t\t\t\t}\n\n\t\t\t\t\t#container .nb-multiCellHighlight .output_container .output {\n\t\t\t\t\t\tbackground-color: var(--theme-notebook-symbol-highlight-background);\n\t\t\t\t\t}\n\n\t\t\t\t\t#container .nb-chatGenerationHighlight .output_container .output {\n\t\t\t\t\t\tbackground-color: var(--vscode-notebook-selectedCellBackground);\n\t\t\t\t\t}\n\n\t\t\t\t\t#container > div.nb-cellDeleted .output_container {\n\t\t\t\t\t\tbackground-color: var(--theme-notebook-diff-removed-background);\n\t\t\t\t\t}\n\n\t\t\t\t\t#container > div.nb-cellAdded .output_container {\n\t\t\t\t\t\tbackground-color: var(--theme-notebook-diff-inserted-background);\n\t\t\t\t\t}\n\n\t\t\t\t\t#container > div > div:not(.preview) > div {\n\t\t\t\t\t\toverflow-x: auto;\n\t\t\t\t\t}\n\n\t\t\t\t\t#container .no-renderer-error {\n\t\t\t\t\t\tcolor: var(--vscode-editorError-foreground);\n\t\t\t\t\t}\n\n\t\t\t\t\tbody {\n\t\t\t\t\t\tpadding: 0px;\n\t\t\t\t\t\theight: 100%;\n\t\t\t\t\t\twidth: 100%;\n\t\t\t\t\t}\n\n\t\t\t\t\ttable, thead, tr, th, td, tbody {\n\t\t\t\t\t\tborder: none;\n\t\t\t\t\t\tborder-color: transparent;\n\t\t\t\t\t\tborder-spacing: 0;\n\t\t\t\t\t\tborder-collapse: collapse;\n\t\t\t\t\t}\n\n\t\t\t\t\ttable, th, tr {\n\t\t\t\t\t\tvertical-align: middle;\n\t\t\t\t\t\ttext-align: right;\n\t\t\t\t\t}\n\n\t\t\t\t\tthead {\n\t\t\t\t\t\tfont-weight: bold;\n\t\t\t\t\t\tbackground-color: rgba(130, 130, 130, 0.16);\n\t\t\t\t\t}\n\n\t\t\t\t\tth, td {\n\t\t\t\t\t\tpadding: 4px 8px;\n\t\t\t\t\t}\n\n\t\t\t\t\ttr:nth-child(even) {\n\t\t\t\t\t\tbackground-color: rgba(130, 130, 130, 0.08);\n\t\t\t\t\t}\n\n\t\t\t\t\ttbody th {\n\t\t\t\t\t\tfont-weight: normal;\n\t\t\t\t\t}\n\n\t\t\t\t\t.find-match {\n\t\t\t\t\t\tbackground-color: var(--vscode-editor-findMatchHighlightBackground);\n\t\t\t\t\t}\n\n\t\t\t\t\t.current-find-match {\n\t\t\t\t\t\tbackground-color: var(--vscode-editor-findMatchBackground);\n\t\t\t\t\t}\n\n\t\t\t\t\t#_defaultColorPalatte {\n\t\t\t\t\t\tcolor: var(--vscode-editor-findMatchHighlightBackground);\n\t\t\t\t\t\tbackground-color: var(--vscode-editor-findMatchBackground);\n\t\t\t\t\t}\n\t\t\t\t</style>\n\t\t\t</head>\n\t\t\t<body style=\"overflow: hidden;\">\n\t\t\t\t<div id='findStart' tabIndex=-1></div>\n\t\t\t\t<div id='container' class=\"widgetarea\" style=\"position: absolute;width:100%;top: 0px\"></div>\n\t\t\t\t<div id=\"_defaultColorPalatte\"></div>\n\t\t\t\t<script type=\"module\">${preloadScript}</script>\n\t\t\t</body>\n\t\t</html>`;\n\t}\n\n\tprivate getRendererData(): RendererMetadata[] {\n\t\treturn this.notebookService\n\t\t\t.getRenderers()\n\t\t\t.map((renderer): RendererMetadata => {\n\t\t\t\tconst entrypoint = {\n\t\t\t\t\textends: renderer.entrypoint.extends,\n\t\t\t\t\tpath: this.asWebviewUri(\n\t\t\t\t\t\trenderer.entrypoint.path,\n\t\t\t\t\t\trenderer.extensionLocation,\n\t\t\t\t\t).toString(),\n\t\t\t\t};\n\t\t\t\treturn {\n\t\t\t\t\tid: renderer.id,\n\t\t\t\t\tentrypoint,\n\t\t\t\t\tmimeTypes: renderer.mimeTypes,\n\t\t\t\t\tmessaging:\n\t\t\t\t\t\trenderer.messaging !== RendererMessagingSpec.Never &&\n\t\t\t\t\t\t!!this.rendererMessaging,\n\t\t\t\t\tisBuiltin: renderer.isBuiltin,\n\t\t\t\t};\n\t\t\t});\n\t}\n\n\tprivate getStaticPreloadsData(): StaticPreloadMetadata[] {\n\t\treturn Array.from(\n\t\t\tthis.notebookService.getStaticPreloads(this.notebookViewType),\n\t\t\t(preload) => {\n\t\t\t\treturn {\n\t\t\t\t\tentrypoint: this.asWebviewUri(\n\t\t\t\t\t\tpreload.entrypoint,\n\t\t\t\t\t\tpreload.extensionLocation,\n\t\t\t\t\t)\n\t\t\t\t\t\t.toString()\n\t\t\t\t\t\t.toString(),\n\t\t\t\t};\n\t\t\t},\n\t\t);\n\t}\n\n\tprivate asWebviewUri(uri: URI, fromExtension: URI | undefined) {\n\t\treturn asWebviewUri(\n\t\t\turi,\n\t\t\tfromExtension?.scheme === Schemas.vscodeRemote\n\t\t\t\t? { isRemote: true, authority: fromExtension.authority }\n\t\t\t\t: undefined,\n\t\t);\n\t}\n\n\tpostKernelMessage(message: any) {\n\t\tthis._sendMessageToWebview({\n\t\t\t__vscode_notebook_message: true,\n\t\t\ttype: \"customKernelMessage\",\n\t\t\tmessage,\n\t\t});\n\t}\n\n\tprivate resolveOutputId(\n\t\tid: string,\n\t): { cellInfo: T; output: ICellOutputViewModel } | undefined {\n\t\tconst output = this.reversedInsetMapping.get(id);\n\t\tif (!output) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst cellInfo = this.insetMapping.get(output)!.cellInfo;\n\t\treturn { cellInfo, output };\n\t}\n\n\tisResolved(): this is IResolvedBackLayerWebview {\n\t\treturn !!this.webview;\n\t}\n\n\tcreateWebview(targetWindow: CodeWindow): Promise<void> {\n\t\tconst baseUrl = this.asWebviewUri(this.getNotebookBaseUri(), undefined);\n\t\tconst htmlContent = this.generateContent(baseUrl.toString());\n\t\treturn this._initialize(htmlContent, targetWindow);\n\t}\n\n\tprivate getNotebookBaseUri() {\n\t\tif (this.documentUri.scheme === Schemas.untitled) {\n\t\t\tconst folder = this.workspaceContextService.getWorkspaceFolder(\n\t\t\t\tthis.documentUri,\n\t\t\t);\n\t\t\tif (folder) {\n\t\t\t\treturn folder.uri;\n\t\t\t}\n\n\t\t\tconst folders = this.workspaceContextService.getWorkspace().folders;\n\t\t\tif (folders.length) {\n\t\t\t\treturn folders[0].uri;\n\t\t\t}\n\t\t}\n\n\t\treturn dirname(this.documentUri);\n\t}\n\n\tprivate getBuiltinLocalResourceRoots(): URI[] {\n\t\t// Python notebooks assume that requirejs is a global.\n\t\t// For all other notebooks, they need to provide their own loader.\n\t\tif (!this.documentUri.path.toLowerCase().endsWith(\".ipynb\")) {\n\t\t\treturn [];\n\t\t}\n\n\t\tif (isWeb) {\n\t\t\treturn []; // script is inlined\n\t\t}\n\n\t\treturn [\n\t\t\tdirname(FileAccess.asFileUri(\"vs/loader.js\")), // TODO@esm this file will not exist in the future\n\t\t];\n\t}\n\n\tprivate _initialize(\n\t\tcontent: string,\n\t\ttargetWindow: CodeWindow,\n\t): Promise<void> {\n\t\tif (!getWindow(this.element).document.body.contains(this.element)) {\n\t\t\tthrow new Error(\"Element is already detached from the DOM tree\");\n\t\t}\n\n\t\tthis.webview = this._createInset(this.webviewService, content);\n\t\tthis.webview.mountTo(this.element, targetWindow);\n\t\tthis._register(this.webview);\n\n\t\tthis._register(\n\t\t\tnew WebviewWindowDragMonitor(targetWindow, () => this.webview),\n\t\t);\n\n\t\tconst initializePromise = new DeferredPromise<void>();\n\n\t\tthis._register(\n\t\t\tthis.webview.onFatalError((e) => {\n\t\t\t\tinitializePromise.error(\n\t\t\t\t\tnew Error(`Could not initialize webview: ${e.message}}`),\n\t\t\t\t);\n\t\t\t}),\n\t\t);\n\n\t\tthis._register(\n\t\t\tthis.webview.onMessage(async (message) => {\n\t\t\t\tconst data:\n\t\t\t\t\t| FromWebviewMessage\n\t\t\t\t\t| { readonly __vscode_notebook_message: undefined } =\n\t\t\t\t\tmessage.message;\n\t\t\t\tif (this._disposed) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!data.__vscode_notebook_message) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tswitch (data.type) {\n\t\t\t\t\tcase \"initialized\": {\n\t\t\t\t\t\tinitializePromise.complete();\n\t\t\t\t\t\tthis.initializeWebViewState();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tcase \"initializedMarkup\": {\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tthis.initializeMarkupPromise?.requestId ===\n\t\t\t\t\t\t\tdata.requestId\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tthis.initializeMarkupPromise?.p.complete();\n\t\t\t\t\t\t\tthis.initializeMarkupPromise = undefined;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tcase \"dimension\": {\n\t\t\t\t\t\tfor (const update of data.updates) {\n\t\t\t\t\t\t\tconst height = update.height;\n\t\t\t\t\t\t\tif (update.isOutput) {\n\t\t\t\t\t\t\t\tconst resolvedResult = this.resolveOutputId(\n\t\t\t\t\t\t\t\t\tupdate.id,\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tif (resolvedResult) {\n\t\t\t\t\t\t\t\t\tconst { cellInfo, output } = resolvedResult;\n\t\t\t\t\t\t\t\t\tthis.notebookEditor.updateOutputHeight(\n\t\t\t\t\t\t\t\t\t\tcellInfo,\n\t\t\t\t\t\t\t\t\t\toutput,\n\t\t\t\t\t\t\t\t\t\theight,\n\t\t\t\t\t\t\t\t\t\t!!update.init,\n\t\t\t\t\t\t\t\t\t\t\"webview#dimension\",\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\tthis.notebookEditor.scheduleOutputHeightAck(\n\t\t\t\t\t\t\t\t\t\tcellInfo,\n\t\t\t\t\t\t\t\t\t\tupdate.id,\n\t\t\t\t\t\t\t\t\t\theight,\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t} else if (update.init) {\n\t\t\t\t\t\t\t\t\t// might be idle render request's ack\n\t\t\t\t\t\t\t\t\tconst outputRequest =\n\t\t\t\t\t\t\t\t\t\tthis.reversedPendingWebviewIdleInsetMapping.get(\n\t\t\t\t\t\t\t\t\t\t\tupdate.id,\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\tif (outputRequest) {\n\t\t\t\t\t\t\t\t\t\tconst inset =\n\t\t\t\t\t\t\t\t\t\t\tthis.pendingWebviewIdleInsetMapping.get(\n\t\t\t\t\t\t\t\t\t\t\t\toutputRequest,\n\t\t\t\t\t\t\t\t\t\t\t)!;\n\n\t\t\t\t\t\t\t\t\t\t// clear the pending mapping\n\t\t\t\t\t\t\t\t\t\tthis.pendingWebviewIdleCreationRequest.delete(\n\t\t\t\t\t\t\t\t\t\t\toutputRequest,\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\tthis.pendingWebviewIdleCreationRequest.delete(\n\t\t\t\t\t\t\t\t\t\t\toutputRequest,\n\t\t\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t\t\t\tconst cellInfo = inset.cellInfo;\n\t\t\t\t\t\t\t\t\t\tthis.reversedInsetMapping.set(\n\t\t\t\t\t\t\t\t\t\t\tupdate.id,\n\t\t\t\t\t\t\t\t\t\t\toutputRequest,\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\tthis.insetMapping.set(\n\t\t\t\t\t\t\t\t\t\t\toutputRequest,\n\t\t\t\t\t\t\t\t\t\t\tinset,\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\tthis.notebookEditor.updateOutputHeight(\n\t\t\t\t\t\t\t\t\t\t\tcellInfo,\n\t\t\t\t\t\t\t\t\t\t\toutputRequest,\n\t\t\t\t\t\t\t\t\t\t\theight,\n\t\t\t\t\t\t\t\t\t\t\t!!update.init,\n\t\t\t\t\t\t\t\t\t\t\t\"webview#dimension\",\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\tthis.notebookEditor.scheduleOutputHeightAck(\n\t\t\t\t\t\t\t\t\t\t\tcellInfo,\n\t\t\t\t\t\t\t\t\t\t\tupdate.id,\n\t\t\t\t\t\t\t\t\t\t\theight,\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tthis.reversedPendingWebviewIdleInsetMapping.delete(\n\t\t\t\t\t\t\t\t\t\tupdate.id,\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tif (!update.init) {\n\t\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tconst output =\n\t\t\t\t\t\t\t\t\t\tthis.reversedInsetMapping.get(\n\t\t\t\t\t\t\t\t\t\t\tupdate.id,\n\t\t\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t\t\tif (!output) {\n\t\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tconst inset =\n\t\t\t\t\t\t\t\t\t\tthis.insetMapping.get(output)!;\n\t\t\t\t\t\t\t\t\tinset.initialized = true;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthis.notebookEditor.updateMarkupCellHeight(\n\t\t\t\t\t\t\t\t\tupdate.id,\n\t\t\t\t\t\t\t\t\theight,\n\t\t\t\t\t\t\t\t\t!!update.init,\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tcase \"mouseenter\": {\n\t\t\t\t\t\tconst resolvedResult = this.resolveOutputId(data.id);\n\t\t\t\t\t\tif (resolvedResult) {\n\t\t\t\t\t\t\tconst latestCell =\n\t\t\t\t\t\t\t\tthis.notebookEditor.getCellByInfo(\n\t\t\t\t\t\t\t\t\tresolvedResult.cellInfo,\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tif (latestCell) {\n\t\t\t\t\t\t\t\tlatestCell.outputIsHovered = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tcase \"mouseleave\": {\n\t\t\t\t\t\tconst resolvedResult = this.resolveOutputId(data.id);\n\t\t\t\t\t\tif (resolvedResult) {\n\t\t\t\t\t\t\tconst latestCell =\n\t\t\t\t\t\t\t\tthis.notebookEditor.getCellByInfo(\n\t\t\t\t\t\t\t\t\tresolvedResult.cellInfo,\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tif (latestCell) {\n\t\t\t\t\t\t\t\tlatestCell.outputIsHovered = false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tcase \"outputFocus\": {\n\t\t\t\t\t\tconst resolvedResult = this.resolveOutputId(data.id);\n\t\t\t\t\t\tif (resolvedResult) {\n\t\t\t\t\t\t\tconst latestCell =\n\t\t\t\t\t\t\t\tthis.notebookEditor.getCellByInfo(\n\t\t\t\t\t\t\t\t\tresolvedResult.cellInfo,\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tif (latestCell) {\n\t\t\t\t\t\t\t\tlatestCell.outputIsFocused = true;\n\t\t\t\t\t\t\t\tthis.notebookEditor.focusNotebookCell(\n\t\t\t\t\t\t\t\t\tlatestCell,\n\t\t\t\t\t\t\t\t\t\"output\",\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\toutputId:\n\t\t\t\t\t\t\t\t\t\t\tresolvedResult.output.model\n\t\t\t\t\t\t\t\t\t\t\t\t.outputId,\n\t\t\t\t\t\t\t\t\t\tskipReveal: true,\n\t\t\t\t\t\t\t\t\t\toutputWebviewFocused: true,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tcase \"outputBlur\": {\n\t\t\t\t\t\tconst resolvedResult = this.resolveOutputId(data.id);\n\t\t\t\t\t\tif (resolvedResult) {\n\t\t\t\t\t\t\tconst latestCell =\n\t\t\t\t\t\t\t\tthis.notebookEditor.getCellByInfo(\n\t\t\t\t\t\t\t\t\tresolvedResult.cellInfo,\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tif (latestCell) {\n\t\t\t\t\t\t\t\tlatestCell.outputIsFocused = false;\n\t\t\t\t\t\t\t\tlatestCell.inputInOutputIsFocused = false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tcase \"scroll-ack\": {\n\t\t\t\t\t\t// const date = new Date();\n\t\t\t\t\t\t// const top = data.data.top;\n\t\t\t\t\t\t// console.log('ack top ', top, ' version: ', data.version, ' - ', date.getMinutes() + ':' + date.getSeconds() + ':' + date.getMilliseconds());\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tcase \"scroll-to-reveal\": {\n\t\t\t\t\t\tthis.notebookEditor.setScrollTop(\n\t\t\t\t\t\t\tdata.scrollTop - NOTEBOOK_WEBVIEW_BOUNDARY,\n\t\t\t\t\t\t);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tcase \"did-scroll-wheel\": {\n\t\t\t\t\t\tthis.notebookEditor.triggerScroll({\n\t\t\t\t\t\t\t...data.payload,\n\t\t\t\t\t\t\tpreventDefault: () => {},\n\t\t\t\t\t\t\tstopPropagation: () => {},\n\t\t\t\t\t\t});\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tcase \"focus-editor\": {\n\t\t\t\t\t\tconst cell = this.notebookEditor.getCellById(\n\t\t\t\t\t\t\tdata.cellId,\n\t\t\t\t\t\t);\n\t\t\t\t\t\tif (cell) {\n\t\t\t\t\t\t\tif (data.focusNext) {\n\t\t\t\t\t\t\t\tthis.notebookEditor.focusNextNotebookCell(\n\t\t\t\t\t\t\t\t\tcell,\n\t\t\t\t\t\t\t\t\t\"editor\",\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tawait this.notebookEditor.focusNotebookCell(\n\t\t\t\t\t\t\t\t\tcell,\n\t\t\t\t\t\t\t\t\t\"editor\",\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tcase \"clicked-data-url\": {\n\t\t\t\t\t\tthis._onDidClickDataLink(data);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tcase \"clicked-link\": {\n\t\t\t\t\t\tif (matchesScheme(data.href, Schemas.command)) {\n\t\t\t\t\t\t\tconst uri = URI.parse(data.href);\n\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\turi.path === \"workbench.action.openLargeOutput\"\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tconst outputId = uri.query;\n\t\t\t\t\t\t\t\tconst group =\n\t\t\t\t\t\t\t\t\tthis.editorGroupService.activeGroup;\n\t\t\t\t\t\t\t\tif (group) {\n\t\t\t\t\t\t\t\t\tif (group.activeEditor) {\n\t\t\t\t\t\t\t\t\t\tgroup.pinEditor(group.activeEditor);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tthis.openerService.open(\n\t\t\t\t\t\t\t\t\tCellUri.generateCellOutputUri(\n\t\t\t\t\t\t\t\t\t\tthis.documentUri,\n\t\t\t\t\t\t\t\t\t\toutputId,\n\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (uri.path === \"cellOutput.enableScrolling\") {\n\t\t\t\t\t\t\t\tconst outputId = uri.query;\n\t\t\t\t\t\t\t\tconst cell =\n\t\t\t\t\t\t\t\t\tthis.reversedInsetMapping.get(outputId);\n\n\t\t\t\t\t\t\t\tif (cell) {\n\t\t\t\t\t\t\t\t\tthis.telemetryService.publicLog2<\n\t\t\t\t\t\t\t\t\t\tWorkbenchActionExecutedEvent,\n\t\t\t\t\t\t\t\t\t\tWorkbenchActionExecutedClassification\n\t\t\t\t\t\t\t\t\t>(\"workbenchActionExecuted\", {\n\t\t\t\t\t\t\t\t\t\tid: \"notebook.cell.toggleOutputScrolling\",\n\t\t\t\t\t\t\t\t\t\tfrom: \"inlineLink\",\n\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t\tcell.cellViewModel.outputsViewModels.forEach(\n\t\t\t\t\t\t\t\t\t\t(vm) => {\n\t\t\t\t\t\t\t\t\t\t\tif (vm.model.metadata) {\n\t\t\t\t\t\t\t\t\t\t\t\tvm.model.metadata[\n\t\t\t\t\t\t\t\t\t\t\t\t\t\"scrollable\"\n\t\t\t\t\t\t\t\t\t\t\t\t] = true;\n\t\t\t\t\t\t\t\t\t\t\t\tvm.resetRenderer();\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// We allow a very limited set of commands\n\t\t\t\t\t\t\tthis.openerService.open(data.href, {\n\t\t\t\t\t\t\t\tfromUserGesture: true,\n\t\t\t\t\t\t\t\tfromWorkspace: true,\n\t\t\t\t\t\t\t\tallowCommands: [\n\t\t\t\t\t\t\t\t\t\"github-issues.authNow\",\n\t\t\t\t\t\t\t\t\t\"workbench.extensions.search\",\n\t\t\t\t\t\t\t\t\t\"workbench.action.openSettings\",\n\t\t\t\t\t\t\t\t\t\"_notebook.selectKernel\",\n\t\t\t\t\t\t\t\t\t// TODO@rebornix explore open output channel with name command\n\t\t\t\t\t\t\t\t\t\"jupyter.viewOutput\",\n\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tmatchesSomeScheme(\n\t\t\t\t\t\t\t\tdata.href,\n\t\t\t\t\t\t\t\tSchemas.http,\n\t\t\t\t\t\t\t\tSchemas.https,\n\t\t\t\t\t\t\t\tSchemas.mailto,\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tthis.openerService.open(data.href, {\n\t\t\t\t\t\t\t\tfromUserGesture: true,\n\t\t\t\t\t\t\t\tfromWorkspace: true,\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else if (\n\t\t\t\t\t\t\tmatchesScheme(data.href, Schemas.vscodeNotebookCell)\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tconst uri = URI.parse(data.href);\n\t\t\t\t\t\t\tawait this._handleNotebookCellResource(uri);\n\t\t\t\t\t\t} else if (/^[\\w-]+:/.test(data.href)) {\n\t\t\t\t\t\t\t// uri with scheme\n\t\t\t\t\t\t\tif (osPath.isAbsolute(data.href)) {\n\t\t\t\t\t\t\t\tthis._openUri(URI.file(data.href));\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthis._openUri(URI.parse(data.href));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// Uri without scheme, such as a file path\n\t\t\t\t\t\t\tawait this._handleResourceOpening(\n\t\t\t\t\t\t\t\ttryDecodeURIComponent(data.href),\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tcase \"customKernelMessage\": {\n\t\t\t\t\t\tthis._onMessage.fire({ message: data.message });\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tcase \"customRendererMessage\": {\n\t\t\t\t\t\tthis.rendererMessaging?.postMessage(\n\t\t\t\t\t\t\tdata.rendererId,\n\t\t\t\t\t\t\tdata.message,\n\t\t\t\t\t\t);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tcase \"clickMarkupCell\": {\n\t\t\t\t\t\tconst cell = this.notebookEditor.getCellById(\n\t\t\t\t\t\t\tdata.cellId,\n\t\t\t\t\t\t);\n\t\t\t\t\t\tif (cell) {\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\tdata.shiftKey ||\n\t\t\t\t\t\t\t\t(isMacintosh ? data.metaKey : data.ctrlKey)\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t// Modify selection\n\t\t\t\t\t\t\t\tthis.notebookEditor.toggleNotebookCellSelection(\n\t\t\t\t\t\t\t\t\tcell,\n\t\t\t\t\t\t\t\t\t/* fromPrevious */ data.shiftKey,\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t// Normal click\n\t\t\t\t\t\t\t\tawait this.notebookEditor.focusNotebookCell(\n\t\t\t\t\t\t\t\t\tcell,\n\t\t\t\t\t\t\t\t\t\"container\",\n\t\t\t\t\t\t\t\t\t{ skipReveal: true },\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tcase \"contextMenuMarkupCell\": {\n\t\t\t\t\t\tconst cell = this.notebookEditor.getCellById(\n\t\t\t\t\t\t\tdata.cellId,\n\t\t\t\t\t\t);\n\t\t\t\t\t\tif (cell) {\n\t\t\t\t\t\t\t// Focus the cell first\n\t\t\t\t\t\t\tawait this.notebookEditor.focusNotebookCell(\n\t\t\t\t\t\t\t\tcell,\n\t\t\t\t\t\t\t\t\"container\",\n\t\t\t\t\t\t\t\t{ skipReveal: true },\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t// Then show the context menu\n\t\t\t\t\t\t\tconst webviewRect =\n\t\t\t\t\t\t\t\tthis.element.getBoundingClientRect();\n\t\t\t\t\t\t\tthis.contextMenuService.showContextMenu({\n\t\t\t\t\t\t\t\tmenuId: MenuId.NotebookCellTitle,\n\t\t\t\t\t\t\t\tcontextKeyService: this.contextKeyService,\n\t\t\t\t\t\t\t\tgetAnchor: () => ({\n\t\t\t\t\t\t\t\t\tx: webviewRect.x + data.clientX,\n\t\t\t\t\t\t\t\t\ty: webviewRect.y + data.clientY,\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tcase \"toggleMarkupPreview\": {\n\t\t\t\t\t\tconst cell = this.notebookEditor.getCellById(\n\t\t\t\t\t\t\tdata.cellId,\n\t\t\t\t\t\t);\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tcell &&\n\t\t\t\t\t\t\t!this.notebookEditor.creationOptions.isReadOnly\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tthis.notebookEditor.setMarkupCellEditState(\n\t\t\t\t\t\t\t\tdata.cellId,\n\t\t\t\t\t\t\t\tCellEditState.Editing,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tawait this.notebookEditor.focusNotebookCell(\n\t\t\t\t\t\t\t\tcell,\n\t\t\t\t\t\t\t\t\"editor\",\n\t\t\t\t\t\t\t\t{ skipReveal: true },\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tcase \"mouseEnterMarkupCell\": {\n\t\t\t\t\t\tconst cell = this.notebookEditor.getCellById(\n\t\t\t\t\t\t\tdata.cellId,\n\t\t\t\t\t\t);\n\t\t\t\t\t\tif (cell instanceof MarkupCellViewModel) {\n\t\t\t\t\t\t\tcell.cellIsHovered = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tcase \"mouseLeaveMarkupCell\": {\n\t\t\t\t\t\tconst cell = this.notebookEditor.getCellById(\n\t\t\t\t\t\t\tdata.cellId,\n\t\t\t\t\t\t);\n\t\t\t\t\t\tif (cell instanceof MarkupCellViewModel) {\n\t\t\t\t\t\t\tcell.cellIsHovered = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tcase \"cell-drag-start\": {\n\t\t\t\t\t\tthis.notebookEditor.didStartDragMarkupCell(\n\t\t\t\t\t\t\tdata.cellId,\n\t\t\t\t\t\t\tdata,\n\t\t\t\t\t\t);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tcase \"cell-drag\": {\n\t\t\t\t\t\tthis.notebookEditor.didDragMarkupCell(\n\t\t\t\t\t\t\tdata.cellId,\n\t\t\t\t\t\t\tdata,\n\t\t\t\t\t\t);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tcase \"cell-drop\": {\n\t\t\t\t\t\tthis.notebookEditor.didDropMarkupCell(data.cellId, {\n\t\t\t\t\t\t\tdragOffsetY: data.dragOffsetY,\n\t\t\t\t\t\t\tctrlKey: data.ctrlKey,\n\t\t\t\t\t\t\taltKey: data.altKey,\n\t\t\t\t\t\t});\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tcase \"cell-drag-end\": {\n\t\t\t\t\t\tthis.notebookEditor.didEndDragMarkupCell(data.cellId);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tcase \"renderedMarkup\": {\n\t\t\t\t\t\tconst cell = this.notebookEditor.getCellById(\n\t\t\t\t\t\t\tdata.cellId,\n\t\t\t\t\t\t);\n\t\t\t\t\t\tif (cell instanceof MarkupCellViewModel) {\n\t\t\t\t\t\t\tcell.renderedHtml = data.html;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis._handleHighlightCodeBlock(data.codeBlocks);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tcase \"renderedCellOutput\": {\n\t\t\t\t\t\tthis._handleHighlightCodeBlock(data.codeBlocks);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tcase \"outputResized\": {\n\t\t\t\t\t\tthis.notebookEditor.didResizeOutput(data.cellId);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tcase \"getOutputItem\": {\n\t\t\t\t\t\tconst resolvedResult = this.resolveOutputId(\n\t\t\t\t\t\t\tdata.outputId,\n\t\t\t\t\t\t);\n\t\t\t\t\t\tconst output =\n\t\t\t\t\t\t\tresolvedResult?.output.model.outputs.find(\n\t\t\t\t\t\t\t\t(output) => output.mime === data.mime,\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\tthis._sendMessageToWebview({\n\t\t\t\t\t\t\ttype: \"returnOutputItem\",\n\t\t\t\t\t\t\trequestId: data.requestId,\n\t\t\t\t\t\t\toutput: output\n\t\t\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\t\t\tmime: output.mime,\n\t\t\t\t\t\t\t\t\t\tvalueBytes: output.data.buffer,\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t: undefined,\n\t\t\t\t\t\t});\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tcase \"logRendererDebugMessage\": {\n\t\t\t\t\t\tthis._logRendererDebugMessage(\n\t\t\t\t\t\t\t`${data.message}${data.data ? \" \" + JSON.stringify(data.data, null, 4) : \"\"}`,\n\t\t\t\t\t\t);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tcase \"notebookPerformanceMessage\": {\n\t\t\t\t\t\tthis.notebookEditor.updatePerformanceMetadata(\n\t\t\t\t\t\t\tdata.cellId,\n\t\t\t\t\t\t\tdata.executionId,\n\t\t\t\t\t\t\tdata.duration,\n\t\t\t\t\t\t\tdata.rendererId,\n\t\t\t\t\t\t);\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tdata.mimeType &&\n\t\t\t\t\t\t\tdata.outputSize &&\n\t\t\t\t\t\t\tdata.rendererId === \"vscode.builtin-renderer\"\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tthis._sendPerformanceData(\n\t\t\t\t\t\t\t\tdata.mimeType,\n\t\t\t\t\t\t\t\tdata.outputSize,\n\t\t\t\t\t\t\t\tdata.duration,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tcase \"outputInputFocus\": {\n\t\t\t\t\t\tconst resolvedResult = this.resolveOutputId(data.id);\n\t\t\t\t\t\tif (resolvedResult) {\n\t\t\t\t\t\t\tconst latestCell =\n\t\t\t\t\t\t\t\tthis.notebookEditor.getCellByInfo(\n\t\t\t\t\t\t\t\t\tresolvedResult.cellInfo,\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tif (latestCell) {\n\t\t\t\t\t\t\t\tlatestCell.inputInOutputIsFocused =\n\t\t\t\t\t\t\t\t\tdata.inputFocused;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.notebookEditor.didFocusOutputInputChange(\n\t\t\t\t\t\t\tdata.inputFocused,\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}),\n\t\t);\n\n\t\treturn initializePromise.p;\n\t}\n\n\tprivate _sendPerformanceData(\n\t\tmimeType: string,\n\t\toutputSize: number,\n\t\trenderTime: number,\n\t) {\n\t\ttype NotebookOutputRenderClassification = {\n\t\t\towner: \"amunger\";\n\t\t\tcomment: \"Track performance data for output rendering\";\n\t\t\tmimeType: {\n\t\t\t\tclassification: \"SystemMetaData\";\n\t\t\t\tpurpose: \"FeatureInsight\";\n\t\t\t\tcomment: \"Presentation type of the output.\";\n\t\t\t};\n\t\t\toutputSize: {\n\t\t\t\tclassification: \"SystemMetaData\";\n\t\t\t\tpurpose: \"FeatureInsight\";\n\t\t\t\tcomment: \"Size of the output data buffer.\";\n\t\t\t\tisMeasurement: true;\n\t\t\t};\n\t\t\trenderTime: {\n\t\t\t\tclassification: \"SystemMetaData\";\n\t\t\t\tpurpose: \"FeatureInsight\";\n\t\t\t\tcomment: \"Time spent rendering output.\";\n\t\t\t\tisMeasurement: true;\n\t\t\t};\n\t\t};\n\n\t\ttype NotebookOutputRenderEvent = {\n\t\t\tmimeType: string;\n\t\t\toutputSize: number;\n\t\t\trenderTime: number;\n\t\t};\n\n\t\tconst telemetryData = {\n\t\t\tmimeType,\n\t\t\toutputSize,\n\t\t\trenderTime,\n\t\t};\n\n\t\tthis.telemetryService.publicLog2<\n\t\t\tNotebookOutputRenderEvent,\n\t\t\tNotebookOutputRenderClassification\n\t\t>(\"NotebookCellOutputRender\", telemetryData);\n\t}\n\n\tprivate _handleNotebookCellResource(uri: URI) {\n\t\tconst notebookResource = uri.path.length > 0 ? uri : this.documentUri;\n\n\t\tconst lineMatch = /(?:^|&)line=([^&]+)/.exec(uri.query);\n\t\tlet editorOptions: ITextEditorOptions | undefined;\n\t\tif (lineMatch) {\n\t\t\tconst parsedLineNumber = Number.parseInt(lineMatch[1], 10);\n\t\t\tif (!isNaN(parsedLineNumber)) {\n\t\t\t\tconst lineNumber = parsedLineNumber;\n\n\t\t\t\teditorOptions = {\n\t\t\t\t\tselection: { startLineNumber: lineNumber, startColumn: 1 },\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\tconst executionMatch = /(?:^|&)execution_count=([^&]+)/.exec(uri.query);\n\t\tif (executionMatch) {\n\t\t\tconst executionCount = Number.parseInt(executionMatch[1], 10);\n\t\t\tif (!isNaN(executionCount)) {\n\t\t\t\tconst notebookModel =\n\t\t\t\t\tthis.notebookService.getNotebookTextModel(notebookResource);\n\t\t\t\t// multiple cells with the same execution count can exist if the kernel is restarted\n\t\t\t\t// so look for the most recently added cell with the matching execution count.\n\t\t\t\t// Somewhat more likely to be correct in notebooks, an much more likely for the interactive window\n\t\t\t\tconst cell = notebookModel?.cells\n\t\t\t\t\t.slice()\n\t\t\t\t\t.reverse()\n\t\t\t\t\t.find((cell) => {\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\tcell.internalMetadata.executionOrder ===\n\t\t\t\t\t\t\texecutionCount\n\t\t\t\t\t\t);\n\t\t\t\t\t});\n\t\t\t\tif (cell?.uri) {\n\t\t\t\t\treturn this.openerService.open(cell.uri, {\n\t\t\t\t\t\tfromUserGesture: true,\n\t\t\t\t\t\tfromWorkspace: true,\n\t\t\t\t\t\teditorOptions: editorOptions,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// URLs built by the jupyter extension put the line query param in the fragment\n\t\t// They also have the cell fragment pre-calculated\n\t\tconst fragmentLineMatch = /\\?line=(\\d+)$/.exec(uri.fragment);\n\t\tif (fragmentLineMatch) {\n\t\t\tconst parsedLineNumber = Number.parseInt(fragmentLineMatch[1], 10);\n\t\t\tif (!isNaN(parsedLineNumber)) {\n\t\t\t\tconst lineNumber = parsedLineNumber + 1;\n\t\t\t\tconst fragment = uri.fragment.substring(\n\t\t\t\t\t0,\n\t\t\t\t\tfragmentLineMatch.index,\n\t\t\t\t);\n\n\t\t\t\t// open the uri with selection\n\t\t\t\tconst editorOptions: ITextEditorOptions = {\n\t\t\t\t\tselection: {\n\t\t\t\t\t\tstartLineNumber: lineNumber,\n\t\t\t\t\t\tstartColumn: 1,\n\t\t\t\t\t\tendLineNumber: lineNumber,\n\t\t\t\t\t\tendColumn: 1,\n\t\t\t\t\t},\n\t\t\t\t};\n\n\t\t\t\treturn this.openerService.open(\n\t\t\t\t\tnotebookResource.with({ fragment }),\n\t\t\t\t\t{\n\t\t\t\t\t\tfromUserGesture: true,\n\t\t\t\t\t\tfromWorkspace: true,\n\t\t\t\t\t\teditorOptions: editorOptions,\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\treturn this.openerService.open(notebookResource, {\n\t\t\tfromUserGesture: true,\n\t\t\tfromWorkspace: true,\n\t\t});\n\t}\n\n\tprivate async _handleResourceOpening(href: string) {\n\t\tlet linkToOpen: URI | undefined;\n\t\tlet fragment: string | undefined;\n\n\t\t// Separate out the fragment so that the subsequent calls\n\t\t// to URI.joinPath() don't URL encode it. This allows opening\n\t\t// links with both paths and fragments.\n\t\tconst hrefWithFragment = FRAGMENT_REGEX.exec(href);\n\t\tif (hrefWithFragment) {\n\t\t\thref = hrefWithFragment[1];\n\t\t\tfragment = hrefWithFragment[2];\n\t\t}\n\n\t\tif (href.startsWith(\"/\")) {\n\t\t\tlinkToOpen = await this.pathService.fileURI(href);\n\t\t\tconst folders = this.workspaceContextService.getWorkspace().folders;\n\t\t\tif (folders.length) {\n\t\t\t\tlinkToOpen = linkToOpen.with({\n\t\t\t\t\tscheme: folders[0].uri.scheme,\n\t\t\t\t\tauthority: folders[0].uri.authority,\n\t\t\t\t});\n\t\t\t}\n\t\t} else if (href.startsWith(\"~\")) {\n\t\t\tconst userHome = await this.pathService.userHome();\n\t\t\tif (userHome) {\n\t\t\t\tlinkToOpen = URI.joinPath(userHome, href.substring(2));\n\t\t\t}\n\t\t} else if (this.documentUri.scheme === Schemas.untitled) {\n\t\t\tconst folders = this.workspaceContextService.getWorkspace().folders;\n\t\t\tif (!folders.length) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tlinkToOpen = URI.joinPath(folders[0].uri, href);\n\t\t} else {\n\t\t\t// Resolve relative to notebook document\n\t\t\tlinkToOpen = URI.joinPath(dirname(this.documentUri), href);\n\t\t}\n\n\t\tif (linkToOpen) {\n\t\t\t// Re-attach fragment now that we have the full file path.\n\t\t\tif (fragment) {\n\t\t\t\tlinkToOpen = linkToOpen.with({ fragment });\n\t\t\t}\n\t\t\tthis._openUri(linkToOpen);\n\t\t}\n\t}\n\n\tprivate _openUri(uri: URI) {\n\t\tlet lineNumber: number | undefined;\n\t\tlet column: number | undefined;\n\t\tconst lineCol = LINE_COLUMN_REGEX.exec(uri.path);\n\t\tif (lineCol) {\n\t\t\turi = uri.with({\n\t\t\t\tpath: uri.path.slice(0, lineCol.index),\n\t\t\t\tfragment: `L${lineCol[0].slice(1)}`,\n\t\t\t});\n\t\t\tlineNumber = Number.parseInt(lineCol[1], 10);\n\t\t\tcolumn = Number.parseInt(lineCol[2], 10);\n\t\t}\n\n\t\t//#region error renderer migration, remove once done\n\t\tconst lineMatch = LineQueryRegex.exec(uri.query);\n\t\tif (lineMatch) {\n\t\t\tconst parsedLineNumber = Number.parseInt(lineMatch[1], 10);\n\t\t\tif (!isNaN(parsedLineNumber)) {\n\t\t\t\tlineNumber = parsedLineNumber + 1;\n\t\t\t\tcolumn = 1;\n\t\t\t\turi = uri.with({ fragment: `L${lineNumber}` });\n\t\t\t}\n\t\t}\n\n\t\turi = uri.with({\n\t\t\tquery: null,\n\t\t});\n\t\t//#endregion\n\n\t\tlet match: { group: IEditorGroup; editor: EditorInput } | undefined;\n\n\t\tfor (const group of this.editorGroupService.groups) {\n\t\t\tconst editorInput = group.editors.find(\n\t\t\t\t(editor) =>\n\t\t\t\t\teditor.resource && isEqual(editor.resource, uri, true),\n\t\t\t);\n\t\t\tif (editorInput) {\n\t\t\t\tmatch = { group, editor: editorInput };\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (match) {\n\t\t\tconst selection: ITextEditorSelection | undefined =\n\t\t\t\tlineNumber !== undefined && column !== undefined\n\t\t\t\t\t? { startLineNumber: lineNumber, startColumn: column }\n\t\t\t\t\t: undefined;\n\t\t\tconst textEditorOptions: ITextEditorOptions = {\n\t\t\t\tselection: selection,\n\t\t\t};\n\t\t\tmatch.group.openEditor(\n\t\t\t\tmatch.editor,\n\t\t\t\tselection ? textEditorOptions : undefined,\n\t\t\t);\n\t\t} else {\n\t\t\tthis.openerService.open(uri, {\n\t\t\t\tfromUserGesture: true,\n\t\t\t\tfromWorkspace: true,\n\t\t\t});\n\t\t}\n\t}\n\n\tprivate _handleHighlightCodeBlock(\n\t\tcodeBlocks: ReadonlyArray<ICodeBlockHighlightRequest>,\n\t) {\n\t\tfor (const { id, value, lang } of codeBlocks) {\n\t\t\t// The language id may be a language aliases (e.g.js instead of javascript)\n\t\t\tconst languageId =\n\t\t\t\tthis.languageService.getLanguageIdByLanguageName(lang);\n\t\t\tif (!languageId) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\ttokenizeToString(this.languageService, value, languageId).then(\n\t\t\t\t(html) => {\n\t\t\t\t\tif (this._disposed) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tthis._sendMessageToWebview({\n\t\t\t\t\t\ttype: \"tokenizedCodeBlock\",\n\t\t\t\t\t\thtml,\n\t\t\t\t\t\tcodeBlockId: id,\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t);\n\t\t}\n\t}\n\tprivate async _onDidClickDataLink(\n\t\tevent: IClickedDataUrlMessage,\n\t): Promise<void> {\n\t\tif (typeof event.data !== \"string\") {\n\t\t\treturn;\n\t\t}\n\n\t\tconst [splitStart, splitData] = event.data.split(\";base64,\");\n\t\tif (!splitData || !splitStart) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst defaultDir =\n\t\t\textname(this.documentUri) === \".interactive\"\n\t\t\t\t? (this.workspaceContextService.getWorkspace().folders[0]\n\t\t\t\t\t\t?.uri ??\n\t\t\t\t\t(await this.fileDialogService.defaultFilePath()))\n\t\t\t\t: dirname(this.documentUri);\n\t\tlet defaultName: string;\n\t\tif (event.downloadName) {\n\t\t\tdefaultName = event.downloadName;\n\t\t} else {\n\t\t\tconst mimeType = splitStart.replace(/^data:/, \"\");\n\t\t\tconst candidateExtension =\n\t\t\t\tmimeType && getExtensionForMimeType(mimeType);\n\t\t\tdefaultName = candidateExtension\n\t\t\t\t? `download${candidateExtension}`\n\t\t\t\t: \"download\";\n\t\t}\n\n\t\tconst defaultUri = joinPath(defaultDir, defaultName);\n\t\tconst newFileUri = await this.fileDialogService.showSaveDialog({\n\t\t\tdefaultUri,\n\t\t});\n\t\tif (!newFileUri) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst buff = decodeBase64(splitData);\n\t\tawait this.fileService.writeFile(newFileUri, buff);\n\t\tawait this.openerService.open(newFileUri);\n\t}\n\n\tprivate _createInset(webviewService: IWebviewService, content: string) {\n\t\tthis.localResourceRootsCache = this._getResourceRootsCache();\n\t\tconst webview = webviewService.createWebviewElement({\n\t\t\torigin: BackLayerWebView.getOriginStore(\n\t\t\t\tthis.storageService,\n\t\t\t).getOrigin(this.notebookViewType, undefined),\n\t\t\ttitle: nls.localize(\"webview title\", \"Notebook webview content\"),\n\t\t\toptions: {\n\t\t\t\tpurpose: WebviewContentPurpose.NotebookRenderer,\n\t\t\t\tenableFindWidget: false,\n\t\t\t\ttransformCssVariables: transformWebviewThemeVars,\n\t\t\t},\n\t\t\tcontentOptions: {\n\t\t\t\tallowMultipleAPIAcquire: true,\n\t\t\t\tallowScripts: true,\n\t\t\t\tlocalResourceRoots: this.localResourceRootsCache,\n\t\t\t},\n\t\t\textension: undefined,\n\t\t\tprovidedViewType: \"notebook.output\",\n\t\t});\n\n\t\twebview.setHtml(content);\n\t\twebview.setContextKeyService(this.contextKeyService);\n\t\treturn webview;\n\t}\n\n\tprivate _getResourceRootsCache(): URI[] {\n\t\tconst workspaceFolders = this.contextService\n\t\t\t.getWorkspace()\n\t\t\t.folders.map((x) => x.uri);\n\t\tconst notebookDir = this.getNotebookBaseUri();\n\t\treturn [\n\t\t\tthis.notebookService.getNotebookProviderResourceRoots(),\n\t\t\tthis.notebookService\n\t\t\t\t.getRenderers()\n\t\t\t\t.map((x) => dirname(x.entrypoint.path)),\n\t\t\t...Array.from(\n\t\t\t\tthis.notebookService.getStaticPreloads(this.notebookViewType),\n\t\t\t\t(x) => [dirname(x.entrypoint), ...x.localResourceRoots],\n\t\t\t),\n\t\t\tworkspaceFolders,\n\t\t\tnotebookDir,\n\t\t\tthis.getBuiltinLocalResourceRoots(),\n\t\t].flat();\n\t}\n\n\tprivate initializeWebViewState() {\n\t\tthis._preloadsCache.clear();\n\t\tif (this._currentKernel) {\n\t\t\tthis._updatePreloadsFromKernel(this._currentKernel);\n\t\t}\n\n\t\tfor (const [output, inset] of this.insetMapping.entries()) {\n\t\t\tthis._sendMessageToWebview({\n\t\t\t\t...inset.cachedCreation,\n\t\t\t\tinitiallyHidden: this.hiddenInsetMapping.has(output),\n\t\t\t});\n\t\t}\n\n\t\tif (this.initializeMarkupPromise?.isFirstInit) {\n\t\t\t// On first run the contents have already been initialized so we don't need to init them again\n\t\t\t// no op\n\t\t} else {\n\t\t\tconst mdCells = [...this.markupPreviewMapping.values()];\n\t\t\tthis.markupPreviewMapping.clear();\n\t\t\tthis.initializeMarkup(mdCells);\n\t\t}\n\n\t\tthis._updateStyles();\n\t\tthis._updateOptions();\n\t}\n\n\tprivate shouldUpdateInset(\n\t\tcell: IGenericCellViewModel,\n\t\toutput: ICellOutputViewModel,\n\t\tcellTop: number,\n\t\toutputOffset: number,\n\t): boolean {\n\t\tif (this._disposed) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (\n\t\t\t\"isOutputCollapsed\" in cell &&\n\t\t\t(cell as ICellViewModel).isOutputCollapsed\n\t\t) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (this.hiddenInsetMapping.has(output)) {\n\t\t\treturn true;\n\t\t}\n\n\t\tconst outputCache = this.insetMapping.get(output);\n\t\tif (!outputCache) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (\n\t\t\toutputOffset === outputCache.cachedCreation.outputOffset &&\n\t\t\tcellTop === outputCache.cachedCreation.cellTop\n\t\t) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tackHeight(updates: readonly IAckOutputHeight[]): void {\n\t\tthis._sendMessageToWebview({\n\t\t\ttype: \"ack-dimension\",\n\t\t\tupdates,\n\t\t});\n\t}\n\n\tupdateScrollTops(\n\t\toutputRequests: IDisplayOutputLayoutUpdateRequest[],\n\t\tmarkupPreviews: { id: string; top: number }[],\n\t) {\n\t\tif (this._disposed) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst widgets = coalesce(\n\t\t\toutputRequests.map(\n\t\t\t\t(request): IContentWidgetTopRequest | undefined => {\n\t\t\t\t\tconst outputCache = this.insetMapping.get(request.output);\n\t\t\t\t\tif (!outputCache) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (\n\t\t\t\t\t\t!request.forceDisplay &&\n\t\t\t\t\t\t!this.shouldUpdateInset(\n\t\t\t\t\t\t\trequest.cell,\n\t\t\t\t\t\t\trequest.output,\n\t\t\t\t\t\t\trequest.cellTop,\n\t\t\t\t\t\t\trequest.outputOffset,\n\t\t\t\t\t\t)\n\t\t\t\t\t) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst id = outputCache.outputId;\n\t\t\t\t\toutputCache.cachedCreation.cellTop = request.cellTop;\n\t\t\t\t\toutputCache.cachedCreation.outputOffset =\n\t\t\t\t\t\trequest.outputOffset;\n\t\t\t\t\tthis.hiddenInsetMapping.delete(request.output);\n\n\t\t\t\t\treturn {\n\t\t\t\t\t\tcellId: request.cell.id,\n\t\t\t\t\t\toutputId: id,\n\t\t\t\t\t\tcellTop: request.cellTop,\n\t\t\t\t\t\toutputOffset: request.outputOffset,\n\t\t\t\t\t\tforceDisplay: request.forceDisplay,\n\t\t\t\t\t};\n\t\t\t\t},\n\t\t\t),\n\t\t);\n\n\t\tif (!widgets.length && !markupPreviews.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._sendMessageToWebview({\n\t\t\ttype: \"view-scroll\",\n\t\t\twidgets: widgets,\n\t\t\tmarkupCells: markupPreviews,\n\t\t});\n\t}\n\n\tprivate async createMarkupPreview(\n\t\tinitialization: IMarkupCellInitialization,\n\t) {\n\t\tif (this._disposed) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.markupPreviewMapping.has(initialization.cellId)) {\n\t\t\tconsole.error(\n\t\t\t\t\"Trying to create markup preview that already exists\",\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\n\t\tthis.markupPreviewMapping.set(initialization.cellId, initialization);\n\t\tthis._sendMessageToWebview({\n\t\t\ttype: \"createMarkupCell\",\n\t\t\tcell: initialization,\n\t\t});\n\t}\n\n\tasync showMarkupPreview(newContent: IMarkupCellInitialization) {\n\t\tif (this._disposed) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst entry = this.markupPreviewMapping.get(newContent.cellId);\n\t\tif (!entry) {\n\t\t\treturn this.createMarkupPreview(newContent);\n\t\t}\n\n\t\tconst sameContent = newContent.content === entry.content;\n\t\tconst sameMetadata = equals(newContent.metadata, entry.metadata);\n\t\tif (!sameContent || !sameMetadata || !entry.visible) {\n\t\t\tthis._sendMessageToWebview({\n\t\t\t\ttype: \"showMarkupCell\",\n\t\t\t\tid: newContent.cellId,\n\t\t\t\thandle: newContent.cellHandle,\n\t\t\t\t// If the content has not changed, we still want to make sure the\n\t\t\t\t// preview is visible but don't need to send anything over\n\t\t\t\tcontent: sameContent ? undefined : newContent.content,\n\t\t\t\ttop: newContent.offset,\n\t\t\t\tmetadata: sameMetadata ? undefined : newContent.metadata,\n\t\t\t});\n\t\t}\n\t\tentry.metadata = newContent.metadata;\n\t\tentry.content = newContent.content;\n\t\tentry.offset = newContent.offset;\n\t\tentry.visible = true;\n\t}\n\n\tasync hideMarkupPreviews(cellIds: readonly string[]) {\n\t\tif (this._disposed) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst cellsToHide: string[] = [];\n\t\tfor (const cellId of cellIds) {\n\t\t\tconst entry = this.markupPreviewMapping.get(cellId);\n\t\t\tif (entry) {\n\t\t\t\tif (entry.visible) {\n\t\t\t\t\tcellsToHide.push(cellId);\n\t\t\t\t\tentry.visible = false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (cellsToHide.length) {\n\t\t\tthis._sendMessageToWebview({\n\t\t\t\ttype: \"hideMarkupCells\",\n\t\t\t\tids: cellsToHide,\n\t\t\t});\n\t\t}\n\t}\n\n\tasync unhideMarkupPreviews(cellIds: readonly string[]) {\n\t\tif (this._disposed) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst toUnhide: string[] = [];\n\t\tfor (const cellId of cellIds) {\n\t\t\tconst entry = this.markupPreviewMapping.get(cellId);\n\t\t\tif (entry) {\n\t\t\t\tif (!entry.visible) {\n\t\t\t\t\tentry.visible = true;\n\t\t\t\t\ttoUnhide.push(cellId);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconsole.error(\n\t\t\t\t\t`Trying to unhide a preview that does not exist: ${cellId}`,\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tthis._sendMessageToWebview({\n\t\t\ttype: \"unhideMarkupCells\",\n\t\t\tids: toUnhide,\n\t\t});\n\t}\n\n\tasync deleteMarkupPreviews(cellIds: readonly string[]) {\n\t\tif (this._disposed) {\n\t\t\treturn;\n\t\t}\n\n\t\tfor (const id of cellIds) {\n\t\t\tif (!this.markupPreviewMapping.has(id)) {\n\t\t\t\tconsole.error(\n\t\t\t\t\t`Trying to delete a preview that does not exist: ${id}`,\n\t\t\t\t);\n\t\t\t}\n\t\t\tthis.markupPreviewMapping.delete(id);\n\t\t}\n\n\t\tif (cellIds.length) {\n\t\t\tthis._sendMessageToWebview({\n\t\t\t\ttype: \"deleteMarkupCell\",\n\t\t\t\tids: cellIds,\n\t\t\t});\n\t\t}\n\t}\n\n\tasync updateMarkupPreviewSelections(selectedCellsIds: string[]) {\n\t\tif (this._disposed) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._sendMessageToWebview({\n\t\t\ttype: \"updateSelectedMarkupCells\",\n\t\t\tselectedCellIds: selectedCellsIds.filter((id) =>\n\t\t\t\tthis.markupPreviewMapping.has(id),\n\t\t\t),\n\t\t});\n\t}\n\n\tasync initializeMarkup(\n\t\tcells: readonly IMarkupCellInitialization[],\n\t): Promise<void> {\n\t\tif (this._disposed) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.initializeMarkupPromise?.p.complete();\n\t\tconst requestId = UUID.generateUuid();\n\t\tthis.initializeMarkupPromise = {\n\t\t\tp: new DeferredPromise(),\n\t\t\trequestId,\n\t\t\tisFirstInit: this.firstInit,\n\t\t};\n\n\t\tthis.firstInit = false;\n\n\t\tfor (const cell of cells) {\n\t\t\tthis.markupPreviewMapping.set(cell.cellId, cell);\n\t\t}\n\n\t\tthis._sendMessageToWebview({\n\t\t\ttype: \"initializeMarkup\",\n\t\t\tcells,\n\t\t\trequestId,\n\t\t});\n\n\t\treturn this.initializeMarkupPromise.p.p;\n\t}\n\n\t/**\n\t * Validate if cached inset is out of date and require a rerender\n\t * Note that it doesn't account for output content change.\n\t */\n\tprivate _cachedInsetEqual(\n\t\tcachedInset: ICachedInset<T>,\n\t\tcontent: IInsetRenderOutput,\n\t) {\n\t\tif (content.type === RenderOutputType.Extension) {\n\t\t\t// Use a new renderer\n\t\t\treturn cachedInset.renderer?.id === content.renderer.id;\n\t\t} else {\n\t\t\t// The new renderer is the default HTML renderer\n\t\t\treturn cachedInset.cachedCreation.type === \"html\";\n\t\t}\n\t}\n\n\trequestCreateOutputWhenWebviewIdle(\n\t\tcellInfo: T,\n\t\tcontent: IInsetRenderOutput,\n\t\tcellTop: number,\n\t\toffset: number,\n\t) {\n\t\tif (this._disposed) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.insetMapping.has(content.source)) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.pendingWebviewIdleCreationRequest.has(content.source)) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.pendingWebviewIdleInsetMapping.has(content.source)) {\n\t\t\t// handled in renderer process, waiting for webview to process it when idle\n\t\t\treturn;\n\t\t}\n\n\t\tthis.pendingWebviewIdleCreationRequest.set(\n\t\t\tcontent.source,\n\t\t\trunWhenGlobalIdle(() => {\n\t\t\t\tconst {\n\t\t\t\t\tmessage,\n\t\t\t\t\trenderer,\n\t\t\t\t\ttransfer: transferable,\n\t\t\t\t} = this._createOutputCreationMessage(\n\t\t\t\t\tcellInfo,\n\t\t\t\t\tcontent,\n\t\t\t\t\tcellTop,\n\t\t\t\t\toffset,\n\t\t\t\t\ttrue,\n\t\t\t\t\ttrue,\n\t\t\t\t);\n\t\t\t\tthis._sendMessageToWebview(message, transferable);\n\t\t\t\tthis.pendingWebviewIdleInsetMapping.set(content.source, {\n\t\t\t\t\toutputId: message.outputId,\n\t\t\t\t\tversionId: content.source.model.versionId,\n\t\t\t\t\tcellInfo: cellInfo,\n\t\t\t\t\trenderer,\n\t\t\t\t\tcachedCreation: message,\n\t\t\t\t});\n\t\t\t\tthis.reversedPendingWebviewIdleInsetMapping.set(\n\t\t\t\t\tmessage.outputId,\n\t\t\t\t\tcontent.source,\n\t\t\t\t);\n\t\t\t\tthis.pendingWebviewIdleCreationRequest.delete(content.source);\n\t\t\t}),\n\t\t);\n\t}\n\n\tcreateOutput(\n\t\tcellInfo: T,\n\t\tcontent: IInsetRenderOutput,\n\t\tcellTop: number,\n\t\toffset: number,\n\t): void {\n\t\tif (this._disposed) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst cachedInset = this.insetMapping.get(content.source);\n\n\t\t// we now request to render the output immediately, so we can remove the pending request\n\t\t// dispose the pending request in renderer process if it exists\n\t\tthis.pendingWebviewIdleCreationRequest.get(content.source)?.dispose();\n\t\tthis.pendingWebviewIdleCreationRequest.delete(content.source);\n\n\t\t// if request has already been sent out, we then remove it from the pending mapping\n\t\tthis.pendingWebviewIdleInsetMapping.delete(content.source);\n\t\tif (cachedInset) {\n\t\t\tthis.reversedPendingWebviewIdleInsetMapping.delete(\n\t\t\t\tcachedInset.outputId,\n\t\t\t);\n\t\t}\n\n\t\tif (cachedInset && this._cachedInsetEqual(cachedInset, content)) {\n\t\t\tthis.hiddenInsetMapping.delete(content.source);\n\t\t\tthis._sendMessageToWebview({\n\t\t\t\ttype: \"showOutput\",\n\t\t\t\tcellId: cachedInset.cellInfo.cellId,\n\t\t\t\toutputId: cachedInset.outputId,\n\t\t\t\tcellTop: cellTop,\n\t\t\t\toutputOffset: offset,\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\n\t\t// create new output\n\t\tconst {\n\t\t\tmessage,\n\t\t\trenderer,\n\t\t\ttransfer: transferable,\n\t\t} = this._createOutputCreationMessage(\n\t\t\tcellInfo,\n\t\t\tcontent,\n\t\t\tcellTop,\n\t\t\toffset,\n\t\t\tfalse,\n\t\t\tfalse,\n\t\t);\n\t\tthis._sendMessageToWebview(message, transferable);\n\t\tthis.insetMapping.set(content.source, {\n\t\t\toutputId: message.outputId,\n\t\t\tversionId: content.source.model.versionId,\n\t\t\tcellInfo: cellInfo,\n\t\t\trenderer,\n\t\t\tcachedCreation: message,\n\t\t});\n\t\tthis.hiddenInsetMapping.delete(content.source);\n\t\tthis.reversedInsetMapping.set(message.outputId, content.source);\n\t}\n\n\tprivate createMetadata(output: ICellOutput, mimeType: string) {\n\t\tif (mimeType.startsWith(\"image\")) {\n\t\t\tconst buffer = output.outputs.find(\n\t\t\t\t(out) => out.mime === \"text/plain\",\n\t\t\t)?.data.buffer;\n\t\t\tif (buffer?.length && buffer?.length > 0) {\n\t\t\t\tconst altText = new TextDecoder().decode(buffer);\n\t\t\t\treturn { ...output.metadata, vscode_altText: altText };\n\t\t\t}\n\t\t}\n\t\treturn output.metadata;\n\t}\n\n\tprivate _createOutputCreationMessage(\n\t\tcellInfo: T,\n\t\tcontent: IInsetRenderOutput,\n\t\tcellTop: number,\n\t\toffset: number,\n\t\tcreateOnIdle: boolean,\n\t\tinitiallyHidden: boolean,\n\t): {\n\t\treadonly message: ICreationRequestMessage;\n\t\treadonly renderer: INotebookRendererInfo | undefined;\n\t\ttransfer: readonly ArrayBuffer[];\n\t} {\n\t\tconst messageBase = {\n\t\t\ttype: \"html\",\n\t\t\texecutionId: cellInfo.executionId,\n\t\t\tcellId: cellInfo.cellId,\n\t\t\tcellTop: cellTop,\n\t\t\toutputOffset: offset,\n\t\t\tleft: 0,\n\t\t\trequiredPreloads: [],\n\t\t\tcreateOnIdle: createOnIdle,\n\t\t} as const;\n\n\t\tconst transfer: ArrayBuffer[] = [];\n\n\t\tlet message: ICreationRequestMessage;\n\t\tlet renderer: INotebookRendererInfo | undefined;\n\t\tif (content.type === RenderOutputType.Extension) {\n\t\t\tconst output = content.source.model;\n\t\t\trenderer = content.renderer;\n\t\t\tconst first = output.outputs.find(\n\t\t\t\t(op) => op.mime === content.mimeType,\n\t\t\t)!;\n\t\t\tconst metadata = this.createMetadata(output, content.mimeType);\n\t\t\tconst valueBytes = copyBufferIfNeeded(first.data.buffer, transfer);\n\t\t\tmessage = {\n\t\t\t\t...messageBase,\n\t\t\t\toutputId: output.outputId,\n\t\t\t\trendererId: content.renderer.id,\n\t\t\t\tcontent: {\n\t\t\t\t\ttype: RenderOutputType.Extension,\n\t\t\t\t\toutputId: output.outputId,\n\t\t\t\t\tmetadata: metadata,\n\t\t\t\t\toutput: {\n\t\t\t\t\t\tmime: first.mime,\n\t\t\t\t\t\tvalueBytes,\n\t\t\t\t\t},\n\t\t\t\t\tallOutputs: output.outputs.map((output) => ({\n\t\t\t\t\t\tmime: output.mime,\n\t\t\t\t\t})),\n\t\t\t\t},\n\t\t\t\tinitiallyHidden: initiallyHidden,\n\t\t\t};\n\t\t} else {\n\t\t\tmessage = {\n\t\t\t\t...messageBase,\n\t\t\t\toutputId: UUID.generateUuid(),\n\t\t\t\tcontent: {\n\t\t\t\t\ttype: content.type,\n\t\t\t\t\thtmlContent: content.htmlContent,\n\t\t\t\t},\n\t\t\t\tinitiallyHidden: initiallyHidden,\n\t\t\t};\n\t\t}\n\n\t\treturn {\n\t\t\tmessage,\n\t\t\trenderer,\n\t\t\ttransfer,\n\t\t};\n\t}\n\n\tupdateOutput(\n\t\tcellInfo: T,\n\t\tcontent: IInsetRenderOutput,\n\t\tcellTop: number,\n\t\toffset: number,\n\t): void {\n\t\tif (this._disposed) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.insetMapping.has(content.source)) {\n\t\t\tthis.createOutput(cellInfo, content, cellTop, offset);\n\t\t\treturn;\n\t\t}\n\n\t\tconst outputCache = this.insetMapping.get(content.source)!;\n\n\t\tif (outputCache.versionId === content.source.model.versionId) {\n\t\t\t// already sent this output version to the renderer\n\t\t\treturn;\n\t\t}\n\n\t\tthis.hiddenInsetMapping.delete(content.source);\n\t\tlet updatedContent: ICreationContent | undefined;\n\n\t\tconst transfer: ArrayBuffer[] = [];\n\t\tif (content.type === RenderOutputType.Extension) {\n\t\t\tconst output = content.source.model;\n\t\t\tconst firstBuffer = output.outputs.find(\n\t\t\t\t(op) => op.mime === content.mimeType,\n\t\t\t)!;\n\t\t\tconst appenededData = output.appendedSinceVersion(\n\t\t\t\toutputCache.versionId,\n\t\t\t\tcontent.mimeType,\n\t\t\t);\n\t\t\tconst appended = appenededData\n\t\t\t\t? {\n\t\t\t\t\t\tvalueBytes: appenededData.buffer,\n\t\t\t\t\t\tpreviousVersion: outputCache.versionId,\n\t\t\t\t\t}\n\t\t\t\t: undefined;\n\n\t\t\tconst valueBytes = copyBufferIfNeeded(\n\t\t\t\tfirstBuffer.data.buffer,\n\t\t\t\ttransfer,\n\t\t\t);\n\t\t\tupdatedContent = {\n\t\t\t\ttype: RenderOutputType.Extension,\n\t\t\t\toutputId: outputCache.outputId,\n\t\t\t\tmetadata: output.metadata,\n\t\t\t\toutput: {\n\t\t\t\t\tmime: content.mimeType,\n\t\t\t\t\tvalueBytes,\n\t\t\t\t\tappended: appended,\n\t\t\t\t},\n\t\t\t\tallOutputs: output.outputs.map((output) => ({\n\t\t\t\t\tmime: output.mime,\n\t\t\t\t})),\n\t\t\t};\n\t\t}\n\n\t\tthis._sendMessageToWebview(\n\t\t\t{\n\t\t\t\ttype: \"showOutput\",\n\t\t\t\tcellId: outputCache.cellInfo.cellId,\n\t\t\t\toutputId: outputCache.outputId,\n\t\t\t\tcellTop: cellTop,\n\t\t\t\toutputOffset: offset,\n\t\t\t\tcontent: updatedContent,\n\t\t\t},\n\t\t\ttransfer,\n\t\t);\n\n\t\toutputCache.versionId = content.source.model.versionId;\n\t\treturn;\n\t}\n\n\tasync copyImage(output: ICellOutputViewModel): Promise<void> {\n\t\tthis._sendMessageToWebview({\n\t\t\ttype: \"copyImage\",\n\t\t\toutputId: output.model.outputId,\n\t\t\taltOutputId: output.model.alternativeOutputId,\n\t\t});\n\t}\n\n\tremoveInsets(outputs: readonly ICellOutputViewModel[]): void {\n\t\tif (this._disposed) {\n\t\t\treturn;\n\t\t}\n\n\t\tfor (const output of outputs) {\n\t\t\tconst outputCache = this.insetMapping.get(output);\n\t\t\tif (!outputCache) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst id = outputCache.outputId;\n\n\t\t\tthis._sendMessageToWebview({\n\t\t\t\ttype: \"clearOutput\",\n\t\t\t\trendererId: outputCache.cachedCreation.rendererId,\n\t\t\t\tcellUri: outputCache.cellInfo.cellUri.toString(),\n\t\t\t\toutputId: id,\n\t\t\t\tcellId: outputCache.cellInfo.cellId,\n\t\t\t});\n\t\t\tthis.insetMapping.delete(output);\n\t\t\tthis.pendingWebviewIdleCreationRequest.get(output)?.dispose();\n\t\t\tthis.pendingWebviewIdleCreationRequest.delete(output);\n\t\t\tthis.pendingWebviewIdleInsetMapping.delete(output);\n\t\t\tthis.reversedPendingWebviewIdleInsetMapping.delete(id);\n\t\t\tthis.reversedInsetMapping.delete(id);\n\t\t}\n\t}\n\n\thideInset(output: ICellOutputViewModel): void {\n\t\tif (this._disposed) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst outputCache = this.insetMapping.get(output);\n\t\tif (!outputCache) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.hiddenInsetMapping.add(output);\n\n\t\tthis._sendMessageToWebview({\n\t\t\ttype: \"hideOutput\",\n\t\t\toutputId: outputCache.outputId,\n\t\t\tcellId: outputCache.cellInfo.cellId,\n\t\t});\n\t}\n\n\tfocusWebview() {\n\t\tif (this._disposed) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.webview?.focus();\n\t}\n\n\tselectOutputContents(cell: ICellViewModel) {\n\t\tif (this._disposed) {\n\t\t\treturn;\n\t\t}\n\t\tconst output = cell.outputsViewModels.find(\n\t\t\t(o) => o.model.outputId === cell.focusedOutputId,\n\t\t);\n\t\tconst outputId = output\n\t\t\t? this.insetMapping.get(output)?.outputId\n\t\t\t: undefined;\n\t\tthis._sendMessageToWebview({\n\t\t\ttype: \"select-output-contents\",\n\t\t\tcellOrOutputId: outputId || cell.id,\n\t\t});\n\t}\n\n\tselectInputContents(cell: ICellViewModel) {\n\t\tif (this._disposed) {\n\t\t\treturn;\n\t\t}\n\t\tconst output = cell.outputsViewModels.find(\n\t\t\t(o) => o.model.outputId === cell.focusedOutputId,\n\t\t);\n\t\tconst outputId = output\n\t\t\t? this.insetMapping.get(output)?.outputId\n\t\t\t: undefined;\n\t\tthis._sendMessageToWebview({\n\t\t\ttype: \"select-input-contents\",\n\t\t\tcellOrOutputId: outputId || cell.id,\n\t\t});\n\t}\n\n\tfocusOutput(\n\t\tcellOrOutputId: string,\n\t\talternateId: string | undefined,\n\t\tviewFocused: boolean,\n\t) {\n\t\tif (this._disposed) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!viewFocused) {\n\t\t\tthis.webview?.focus();\n\t\t}\n\n\t\tthis._sendMessageToWebview({\n\t\t\ttype: \"focus-output\",\n\t\t\tcellOrOutputId: cellOrOutputId,\n\t\t\talternateId: alternateId,\n\t\t});\n\t}\n\n\tblurOutput() {\n\t\tif (this._disposed) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._sendMessageToWebview({\n\t\t\ttype: \"blur-output\",\n\t\t});\n\t}\n\n\tasync find(\n\t\tquery: string,\n\t\toptions: {\n\t\t\twholeWord?: boolean;\n\t\t\tcaseSensitive?: boolean;\n\t\t\tincludeMarkup: boolean;\n\t\t\tincludeOutput: boolean;\n\t\t\tshouldGetSearchPreviewInfo: boolean;\n\t\t\townerID: string;\n\t\t\tfindIds: string[];\n\t\t},\n\t): Promise<IFindMatch[]> {\n\t\tif (query === \"\") {\n\t\t\tthis._sendMessageToWebview({\n\t\t\t\ttype: \"findStop\",\n\t\t\t\townerID: options.ownerID,\n\t\t\t});\n\t\t\treturn [];\n\t\t}\n\n\t\tconst p = new Promise<IFindMatch[]>((resolve) => {\n\t\t\tconst sub = this.webview?.onMessage((e) => {\n\t\t\t\tif (e.message.type === \"didFind\") {\n\t\t\t\t\tresolve(e.message.matches);\n\t\t\t\t\tsub?.dispose();\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\tthis._sendMessageToWebview({\n\t\t\ttype: \"find\",\n\t\t\tquery: query,\n\t\t\toptions,\n\t\t});\n\n\t\tconst ret = await p;\n\t\treturn ret;\n\t}\n\n\tfindStop(ownerID: string) {\n\t\tthis._sendMessageToWebview({\n\t\t\ttype: \"findStop\",\n\t\t\townerID,\n\t\t});\n\t}\n\n\tasync findHighlightCurrent(\n\t\tindex: number,\n\t\townerID: string,\n\t): Promise<number> {\n\t\tconst p = new Promise<number>((resolve) => {\n\t\t\tconst sub = this.webview?.onMessage((e) => {\n\t\t\t\tif (e.message.type === \"didFindHighlightCurrent\") {\n\t\t\t\t\tresolve(e.message.offset);\n\t\t\t\t\tsub?.dispose();\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\tthis._sendMessageToWebview({\n\t\t\ttype: \"findHighlightCurrent\",\n\t\t\tindex,\n\t\t\townerID,\n\t\t});\n\n\t\tconst ret = await p;\n\t\treturn ret;\n\t}\n\n\tasync findUnHighlightCurrent(\n\t\tindex: number,\n\t\townerID: string,\n\t): Promise<void> {\n\t\tthis._sendMessageToWebview({\n\t\t\ttype: \"findUnHighlightCurrent\",\n\t\t\tindex,\n\t\t\townerID,\n\t\t});\n\t}\n\n\tdeltaCellContainerClassNames(\n\t\tcellId: string,\n\t\tadded: string[],\n\t\tremoved: string[],\n\t) {\n\t\tthis._sendMessageToWebview({\n\t\t\ttype: \"decorations\",\n\t\t\tcellId,\n\t\t\taddedClassNames: added,\n\t\t\tremovedClassNames: removed,\n\t\t});\n\t}\n\n\tupdateOutputRenderers() {\n\t\tif (!this.webview) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst renderersData = this.getRendererData();\n\t\tthis.localResourceRootsCache = this._getResourceRootsCache();\n\t\tconst mixedResourceRoots = [\n\t\t\t...(this.localResourceRootsCache || []),\n\t\t\t...(this._currentKernel\n\t\t\t\t? [this._currentKernel.localResourceRoot]\n\t\t\t\t: []),\n\t\t];\n\n\t\tthis.webview.localResourcesRoot = mixedResourceRoots;\n\t\tthis._sendMessageToWebview({\n\t\t\ttype: \"updateRenderers\",\n\t\t\trendererData: renderersData,\n\t\t});\n\t}\n\n\tasync updateKernelPreloads(kernel: INotebookKernel | undefined) {\n\t\tif (this._disposed || kernel === this._currentKernel) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst previousKernel = this._currentKernel;\n\t\tthis._currentKernel = kernel;\n\n\t\tif (previousKernel && previousKernel.preloadUris.length > 0) {\n\t\t\tthis.webview?.reload(); // preloads will be restored after reload\n\t\t} else if (kernel) {\n\t\t\tthis._updatePreloadsFromKernel(kernel);\n\t\t}\n\t}\n\n\tprivate _updatePreloadsFromKernel(kernel: INotebookKernel) {\n\t\tconst resources: IControllerPreload[] = [];\n\t\tfor (const preload of kernel.preloadUris) {\n\t\t\tconst uri =\n\t\t\t\tthis.environmentService.isExtensionDevelopment &&\n\t\t\t\t(preload.scheme === \"http\" || preload.scheme === \"https\")\n\t\t\t\t\t? preload\n\t\t\t\t\t: this.asWebviewUri(preload, undefined);\n\n\t\t\tif (!this._preloadsCache.has(uri.toString())) {\n\t\t\t\tresources.push({\n\t\t\t\t\turi: uri.toString(),\n\t\t\t\t\toriginalUri: preload.toString(),\n\t\t\t\t});\n\t\t\t\tthis._preloadsCache.add(uri.toString());\n\t\t\t}\n\t\t}\n\n\t\tif (!resources.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._updatePreloads(resources);\n\t}\n\n\tprivate _updatePreloads(resources: IControllerPreload[]) {\n\t\tif (!this.webview) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst mixedResourceRoots = [\n\t\t\t...(this.localResourceRootsCache || []),\n\t\t\t...(this._currentKernel\n\t\t\t\t? [this._currentKernel.localResourceRoot]\n\t\t\t\t: []),\n\t\t];\n\n\t\tthis.webview.localResourcesRoot = mixedResourceRoots;\n\n\t\tthis._sendMessageToWebview({\n\t\t\ttype: \"preload\",\n\t\t\tresources: resources,\n\t\t});\n\t}\n\n\tprivate _sendMessageToWebview(\n\t\tmessage: ToWebviewMessage,\n\t\ttransfer?: readonly ArrayBuffer[],\n\t) {\n\t\tif (this._disposed) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.webview?.postMessage(message, transfer);\n\t}\n\n\toverride dispose() {\n\t\tthis._disposed = true;\n\t\tthis.webview?.dispose();\n\t\tthis.webview = undefined;\n\t\tthis.notebookEditor = null!;\n\t\tthis.insetMapping.clear();\n\t\tthis.pendingWebviewIdleCreationRequest.clear();\n\t\tsuper.dispose();\n\t}\n}\n\nfunction copyBufferIfNeeded(\n\tbuffer: Uint8Array,\n\ttransfer: ArrayBuffer[],\n): Uint8Array {\n\tif (buffer.byteLength === buffer.buffer.byteLength) {\n\t\t// No copy needed but we can't transfer either\n\t\treturn buffer;\n\t} else {\n\t\t// The buffer is smaller than its backing array buffer.\n\t\t// Create a copy to avoid sending the entire array buffer.\n\t\tconst valueBytes = new Uint8Array(buffer);\n\t\ttransfer.push(valueBytes.buffer);\n\t\treturn valueBytes;\n\t}\n}\n\nfunction getTokenizationCss() {\n\tconst colorMap = TokenizationRegistry.getColorMap();\n\tconst tokenizationCss = colorMap\n\t\t? generateTokensCSSForColorMap(colorMap)\n\t\t: \"\";\n\treturn tokenizationCss;\n}\n\nfunction tryDecodeURIComponent(uri: string) {\n\ttry {\n\t\treturn decodeURIComponent(uri);\n\t} catch {\n\t\treturn uri;\n\t}\n}\n"],
  "mappings": "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",
  "names": ["output", "cell", "editorOptions"]
}
