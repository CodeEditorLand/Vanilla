{
  "version": 3,
  "sources": ["../../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/notebook/browser/diff/diffComponents.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as DOM from '../../../../../base/browser/dom.js';\nimport { Disposable, DisposableStore } from '../../../../../base/common/lifecycle.js';\nimport { Schemas } from '../../../../../base/common/network.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { DiffElementCellViewModelBase, getFormattedOutputJSON, OutputComparison, outputEqual, OUTPUT_EDITOR_HEIGHT_MAGIC, PropertyFoldingState, SideBySideDiffElementViewModel, SingleSideDiffElementViewModel, DiffElementPlaceholderViewModel } from './diffElementViewModel.js';\nimport { CellDiffSideBySideRenderTemplate, CellDiffSingleSideRenderTemplate, DiffSide, DIFF_CELL_MARGIN, INotebookTextDiffEditor, NOTEBOOK_DIFF_CELL_INPUT, NOTEBOOK_DIFF_CELL_PROPERTY, NOTEBOOK_DIFF_CELL_PROPERTY_EXPANDED, CellDiffPlaceholderRenderTemplate, IDiffCellMarginOverlay, NOTEBOOK_DIFF_CELL_IGNORE_WHITESPACE } from './notebookDiffEditorBrowser.js';\nimport { CodeEditorWidget, ICodeEditorWidgetOptions } from '../../../../../editor/browser/widget/codeEditor/codeEditorWidget.js';\nimport { IModelService } from '../../../../../editor/common/services/model.js';\nimport { ILanguageService } from '../../../../../editor/common/languages/language.js';\nimport { CellEditType, CellUri, NotebookCellMetadata } from '../../common/notebookCommon.js';\nimport { ToolBar } from '../../../../../base/browser/ui/toolbar/toolbar.js';\nimport { IContextMenuService } from '../../../../../platform/contextview/browser/contextView.js';\nimport { IMenu, IMenuService, MenuId, MenuItemAction } from '../../../../../platform/actions/common/actions.js';\nimport { IKeybindingService } from '../../../../../platform/keybinding/common/keybinding.js';\nimport { INotificationService } from '../../../../../platform/notification/common/notification.js';\nimport { IAction } from '../../../../../base/common/actions.js';\nimport { createAndFillInActionBarActions } from '../../../../../platform/actions/browser/menuEntryActionViewItem.js';\nimport { IContextKey, IContextKeyService } from '../../../../../platform/contextkey/common/contextkey.js';\nimport { CodiconActionViewItem } from '../view/cellParts/cellActionView.js';\nimport { collapsedIcon, expandedIcon } from '../notebookIcons.js';\nimport { OutputContainer } from './diffElementOutputs.js';\nimport { EditorExtensionsRegistry } from '../../../../../editor/browser/editorExtensions.js';\nimport { ContextMenuController } from '../../../../../editor/contrib/contextmenu/browser/contextmenu.js';\nimport { SnippetController2 } from '../../../../../editor/contrib/snippet/browser/snippetController2.js';\nimport { SuggestController } from '../../../../../editor/contrib/suggest/browser/suggestController.js';\nimport { MenuPreventer } from '../../../codeEditor/browser/menuPreventer.js';\nimport { SelectionClipboardContributionID } from '../../../codeEditor/browser/selectionClipboard.js';\nimport { TabCompletionController } from '../../../snippets/browser/tabCompletion.js';\nimport { renderIcon, renderLabelWithIcons } from '../../../../../base/browser/ui/iconLabel/iconLabels.js';\nimport * as editorCommon from '../../../../../editor/common/editorCommon.js';\nimport { ITextModelService } from '../../../../../editor/common/services/resolverService.js';\nimport { IConfigurationService } from '../../../../../platform/configuration/common/configuration.js';\nimport { IThemeService } from '../../../../../platform/theme/common/themeService.js';\nimport { WorkbenchToolBar } from '../../../../../platform/actions/browser/toolbar.js';\nimport { ITelemetryService } from '../../../../../platform/telemetry/common/telemetry.js';\nimport { fixedDiffEditorOptions, fixedEditorOptions, getEditorPadding } from './diffCellEditorOptions.js';\nimport { AccessibilityVerbositySettingId } from '../../../accessibility/browser/accessibilityConfiguration.js';\nimport { IAccessibilityService } from '../../../../../platform/accessibility/common/accessibility.js';\nimport { DiffEditorWidget } from '../../../../../editor/browser/widget/diffEditor/diffEditorWidget.js';\nimport { ICommandService } from '../../../../../platform/commands/common/commands.js';\nimport { DiffNestedCellViewModel } from './diffNestedCellViewModel.js';\nimport { localize } from '../../../../../nls.js';\nimport { Emitter } from '../../../../../base/common/event.js';\nimport { ITextResourceConfigurationService } from '../../../../../editor/common/services/textResourceConfiguration.js';\nimport { getFormattedMetadataJSON } from '../../common/model/notebookCellTextModel.js';\nimport { IDiffEditorOptions } from '../../../../../editor/common/config/editorOptions.js';\n\nexport function getOptimizedNestedCodeEditorWidgetOptions(): ICodeEditorWidgetOptions {\n\treturn {\n\t\tisSimpleWidget: false,\n\t\tcontributions: EditorExtensionsRegistry.getSomeEditorContributions([\n\t\t\tMenuPreventer.ID,\n\t\t\tSelectionClipboardContributionID,\n\t\t\tContextMenuController.ID,\n\t\t\tSuggestController.ID,\n\t\t\tSnippetController2.ID,\n\t\t\tTabCompletionController.ID,\n\t\t])\n\t};\n}\n\nexport class CellDiffPlaceholderElement extends Disposable {\n\tconstructor(\n\t\tplaceholder: DiffElementPlaceholderViewModel,\n\t\ttemplateData: CellDiffPlaceholderRenderTemplate,\n\t) {\n\t\tsuper();\n\t\ttemplateData.body.classList.remove('left', 'right', 'full');\n\t\tconst text = (placeholder.hiddenCells.length === 1) ?\n\t\t\tlocalize('hiddenCell', '{0} hidden cell', placeholder.hiddenCells.length) :\n\t\t\tlocalize('hiddenCells', '{0} hidden cells', placeholder.hiddenCells.length);\n\t\ttemplateData.placeholder.innerText = text;\n\n\t\tthis._register(DOM.addDisposableListener(templateData.placeholder, 'dblclick', (e: MouseEvent) => {\n\t\t\tif (e.button !== 0) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\te.preventDefault();\n\t\t\tplaceholder.showHiddenCells();\n\t\t}));\n\t\tthis._register(templateData.marginOverlay.onAction(() => placeholder.showHiddenCells()));\n\t\ttemplateData.marginOverlay.show();\n\t}\n}\n\nclass PropertyHeader extends Disposable {\n\tprotected _foldingIndicator!: HTMLElement;\n\tprotected _statusSpan!: HTMLElement;\n\tprotected _description!: HTMLElement;\n\tprotected _toolbar!: WorkbenchToolBar;\n\tprotected _menu!: IMenu;\n\tprotected _propertyExpanded?: IContextKey<boolean>;\n\tprotected _propertyChanged?: IContextKey<boolean>;\n\n\tconstructor(\n\t\treadonly cell: DiffElementCellViewModelBase,\n\t\treadonly propertyHeaderContainer: HTMLElement,\n\t\treadonly notebookEditor: INotebookTextDiffEditor,\n\t\treadonly accessor: {\n\t\t\tupdateInfoRendering: (renderOutput: boolean) => void;\n\t\t\tcheckIfModified: (cell: DiffElementCellViewModelBase) => false | { reason: string | undefined };\n\t\t\tgetFoldingState: (cell: DiffElementCellViewModelBase) => PropertyFoldingState;\n\t\t\tupdateFoldingState: (cell: DiffElementCellViewModelBase, newState: PropertyFoldingState) => void;\n\t\t\tunChangedLabel: string;\n\t\t\tchangedLabel: string;\n\t\t\tprefix: string;\n\t\t\tmenuId: MenuId;\n\t\t},\n\t\t@IContextMenuService private readonly contextMenuService: IContextMenuService,\n\t\t@IKeybindingService private readonly keybindingService: IKeybindingService,\n\t\t@ICommandService private readonly commandService: ICommandService,\n\t\t@INotificationService private readonly notificationService: INotificationService,\n\t\t@IMenuService private readonly menuService: IMenuService,\n\t\t@IContextKeyService private readonly contextKeyService: IContextKeyService,\n\t\t@IThemeService private readonly themeService: IThemeService,\n\t\t@ITelemetryService private readonly telemetryService: ITelemetryService,\n\t\t@IAccessibilityService private readonly accessibilityService: IAccessibilityService\n\t) {\n\t\tsuper();\n\t}\n\n\tbuildHeader(): void {\n\t\tthis._foldingIndicator = DOM.append(this.propertyHeaderContainer, DOM.$('.property-folding-indicator'));\n\t\tthis._foldingIndicator.classList.add(this.accessor.prefix);\n\t\tconst metadataStatus = DOM.append(this.propertyHeaderContainer, DOM.$('div.property-status'));\n\t\tthis._statusSpan = DOM.append(metadataStatus, DOM.$('span'));\n\t\tthis._description = DOM.append(metadataStatus, DOM.$('span.property-description'));\n\n\t\tconst cellToolbarContainer = DOM.append(this.propertyHeaderContainer, DOM.$('div.property-toolbar'));\n\t\tthis._toolbar = this._register(new WorkbenchToolBar(cellToolbarContainer, {\n\t\t\tactionViewItemProvider: (action, options) => {\n\t\t\t\tif (action instanceof MenuItemAction) {\n\t\t\t\t\tconst item = new CodiconActionViewItem(action, { hoverDelegate: options.hoverDelegate }, this.keybindingService, this.notificationService, this.contextKeyService, this.themeService, this.contextMenuService, this.accessibilityService);\n\t\t\t\t\treturn item;\n\t\t\t\t}\n\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t}, this.menuService, this.contextKeyService, this.contextMenuService, this.keybindingService, this.commandService, this.telemetryService));\n\t\tthis._toolbar.context = {\n\t\t\tcell: this.cell\n\t\t};\n\n\t\tconst scopedContextKeyService = this.contextKeyService.createScoped(cellToolbarContainer);\n\t\tthis._register(scopedContextKeyService);\n\t\tthis._propertyChanged = NOTEBOOK_DIFF_CELL_PROPERTY.bindTo(scopedContextKeyService);\n\t\tthis._propertyExpanded = NOTEBOOK_DIFF_CELL_PROPERTY_EXPANDED.bindTo(scopedContextKeyService);\n\n\t\tthis._menu = this._register(this.menuService.createMenu(this.accessor.menuId, scopedContextKeyService));\n\t\tthis._register(this._menu.onDidChange(() => this.updateMenu()));\n\n\t\tthis._register(this.notebookEditor.onMouseUp(e => {\n\t\t\tif (!e.event.target || e.target !== this.cell) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst target = e.event.target as HTMLElement;\n\n\t\t\tif (\n\t\t\t\ttarget === this.propertyHeaderContainer ||\n\t\t\t\ttarget === this._foldingIndicator || this._foldingIndicator.contains(target) ||\n\t\t\t\ttarget === metadataStatus || metadataStatus.contains(target)\n\t\t\t) {\n\t\t\t\tconst oldFoldingState = this.accessor.getFoldingState(this.cell);\n\t\t\t\tthis.accessor.updateFoldingState(this.cell, oldFoldingState === PropertyFoldingState.Expanded ? PropertyFoldingState.Collapsed : PropertyFoldingState.Expanded);\n\t\t\t\tthis._updateFoldingIcon();\n\t\t\t\tthis.accessor.updateInfoRendering(this.cell.renderOutput);\n\t\t\t}\n\t\t}));\n\n\t\tthis.refresh();\n\t\tthis.accessor.updateInfoRendering(this.cell.renderOutput);\n\t}\n\trefresh() {\n\t\tthis.updateMenu();\n\t\tthis._updateFoldingIcon();\n\n\t\tconst metadataChanged = this.accessor.checkIfModified(this.cell);\n\t\tif (this._propertyChanged) {\n\t\t\tthis._propertyChanged.set(!!metadataChanged);\n\t\t}\n\t\tif (metadataChanged) {\n\t\t\tthis._statusSpan.textContent = this.accessor.changedLabel;\n\t\t\tthis._statusSpan.style.fontWeight = 'bold';\n\t\t\tif (metadataChanged.reason) {\n\t\t\t\tthis._description.textContent = metadataChanged.reason;\n\t\t\t}\n\t\t\tthis.propertyHeaderContainer.classList.add('modified');\n\t\t} else {\n\t\t\tthis._statusSpan.textContent = this.accessor.unChangedLabel;\n\t\t\tthis._statusSpan.style.fontWeight = 'normal';\n\t\t\tthis._description.textContent = '';\n\t\t\tthis.propertyHeaderContainer.classList.remove('modified');\n\t\t}\n\t}\n\n\tprivate updateMenu() {\n\t\tconst metadataChanged = this.accessor.checkIfModified(this.cell);\n\t\tif (metadataChanged) {\n\t\t\tconst actions: IAction[] = [];\n\t\t\tcreateAndFillInActionBarActions(this._menu, { shouldForwardArgs: true }, actions);\n\t\t\tthis._toolbar.setActions(actions);\n\t\t} else {\n\t\t\tthis._toolbar.setActions([]);\n\t\t}\n\t}\n\n\tprivate _updateFoldingIcon() {\n\t\tif (this.accessor.getFoldingState(this.cell) === PropertyFoldingState.Collapsed) {\n\t\t\tDOM.reset(this._foldingIndicator, renderIcon(collapsedIcon));\n\t\t\tthis._propertyExpanded?.set(false);\n\t\t} else {\n\t\t\tDOM.reset(this._foldingIndicator, renderIcon(expandedIcon));\n\t\t\tthis._propertyExpanded?.set(true);\n\t\t}\n\n\t}\n}\n\ninterface IDiffElementLayoutState {\n\touterWidth?: boolean;\n\teditorHeight?: boolean;\n\tmetadataEditor?: boolean;\n\tmetadataHeight?: boolean;\n\toutputTotalHeight?: boolean;\n}\n\nabstract class AbstractElementRenderer extends Disposable {\n\tprotected readonly _metadataLocalDisposable = this._register(new DisposableStore());\n\tprotected readonly _outputLocalDisposable = this._register(new DisposableStore());\n\tprotected _ignoreMetadata: boolean = false;\n\tprotected _ignoreOutputs: boolean = false;\n\tprotected _cellHeaderContainer!: HTMLElement;\n\tprotected _editorContainer!: HTMLElement;\n\tprotected _cellHeader!: PropertyHeader;\n\tprotected _metadataHeaderContainer!: HTMLElement;\n\tprotected _metadataHeader!: PropertyHeader;\n\tprotected _metadataInfoContainer!: HTMLElement;\n\tprotected _metadataEditorContainer?: HTMLElement;\n\tprotected readonly _metadataEditorDisposeStore!: DisposableStore;\n\tprotected _metadataEditor?: CodeEditorWidget | DiffEditorWidget;\n\n\tprotected _outputHeaderContainer!: HTMLElement;\n\tprotected _outputHeader!: PropertyHeader;\n\tprotected _outputInfoContainer!: HTMLElement;\n\tprotected _outputEditorContainer?: HTMLElement;\n\tprotected _outputViewContainer?: HTMLElement;\n\tprotected _outputLeftContainer?: HTMLElement;\n\tprotected _outputRightContainer?: HTMLElement;\n\tprotected _outputMetadataContainer?: HTMLElement;\n\tprotected _outputEmptyElement?: HTMLElement;\n\tprotected _outputLeftView?: OutputContainer;\n\tprotected _outputRightView?: OutputContainer;\n\tprotected readonly _outputEditorDisposeStore!: DisposableStore;\n\tprotected _outputEditor?: CodeEditorWidget | DiffEditorWidget;\n\tprotected _outputMetadataEditor?: DiffEditorWidget;\n\n\tprotected _diffEditorContainer!: HTMLElement;\n\tprotected _diagonalFill?: HTMLElement;\n\tprotected _isDisposed: boolean;\n\n\tconstructor(\n\t\treadonly notebookEditor: INotebookTextDiffEditor,\n\t\treadonly cell: DiffElementCellViewModelBase,\n\t\treadonly templateData: CellDiffSingleSideRenderTemplate | CellDiffSideBySideRenderTemplate,\n\t\treadonly style: 'left' | 'right' | 'full',\n\t\tprotected readonly instantiationService: IInstantiationService,\n\t\tprotected readonly languageService: ILanguageService,\n\t\tprotected readonly modelService: IModelService,\n\t\tprotected readonly textModelService: ITextModelService,\n\t\tprotected readonly contextMenuService: IContextMenuService,\n\t\tprotected readonly keybindingService: IKeybindingService,\n\t\tprotected readonly notificationService: INotificationService,\n\t\tprotected readonly menuService: IMenuService,\n\t\tprotected readonly contextKeyService: IContextKeyService,\n\t\tprotected readonly configurationService: IConfigurationService,\n\t\tprotected readonly textConfigurationService: ITextResourceConfigurationService\n\t) {\n\t\tsuper();\n\t\t// init\n\t\tthis._isDisposed = false;\n\t\tthis._metadataEditorDisposeStore = this._register(new DisposableStore());\n\t\tthis._outputEditorDisposeStore = this._register(new DisposableStore());\n\t\tthis._register(cell.onDidLayoutChange(e => {\n\t\t\tthis.layout(e);\n\t\t}));\n\t\tthis._register(cell.onDidLayoutChange(e => this.updateBorders()));\n\t\tthis.init();\n\t\tthis.buildBody();\n\n\t\tthis._register(cell.onDidStateChange(() => {\n\t\t\tthis.updateOutputRendering(this.cell.renderOutput);\n\t\t}));\n\t}\n\n\tabstract init(): void;\n\tabstract styleContainer(container: HTMLElement): void;\n\tabstract _buildOutput(): void;\n\tabstract _disposeOutput(): void;\n\tabstract _buildMetadata(): void;\n\tabstract _disposeMetadata(): void;\n\n\tbuildBody(): void {\n\t\tconst body = this.templateData.body;\n\t\tthis._diffEditorContainer = this.templateData.diffEditorContainer;\n\t\tbody.classList.remove('left', 'right', 'full');\n\t\tswitch (this.style) {\n\t\t\tcase 'left':\n\t\t\t\tbody.classList.add('left');\n\t\t\t\tbreak;\n\t\t\tcase 'right':\n\t\t\t\tbody.classList.add('right');\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbody.classList.add('full');\n\t\t\t\tbreak;\n\t\t}\n\n\t\tthis.styleContainer(this._diffEditorContainer);\n\t\tthis.updateSourceEditor();\n\t\tif (this.cell.modified) {\n\t\t\tthis._register(this.cell.modified.textModel.onDidChangeContent(() => this._cellHeader.refresh()));\n\t\t}\n\n\t\tthis._ignoreMetadata = this.configurationService.getValue('notebook.diff.ignoreMetadata');\n\t\tif (this._ignoreMetadata) {\n\t\t\tthis._disposeMetadata();\n\t\t} else {\n\t\t\tthis._buildMetadata();\n\t\t}\n\n\t\tthis._ignoreOutputs = this.configurationService.getValue<boolean>('notebook.diff.ignoreOutputs') || !!(this.notebookEditor.textModel?.transientOptions.transientOutputs);\n\t\tif (this._ignoreOutputs) {\n\t\t\tthis._disposeOutput();\n\t\t} else {\n\t\t\tthis._buildOutput();\n\t\t}\n\n\t\tthis._register(this.configurationService.onDidChangeConfiguration(e => {\n\t\t\tlet metadataLayoutChange = false;\n\t\t\tlet outputLayoutChange = false;\n\t\t\tif (e.affectsConfiguration('notebook.diff.ignoreMetadata')) {\n\t\t\t\tconst newValue = this.configurationService.getValue<boolean>('notebook.diff.ignoreMetadata');\n\n\t\t\t\tif (newValue !== undefined && this._ignoreMetadata !== newValue) {\n\t\t\t\t\tthis._ignoreMetadata = newValue;\n\n\t\t\t\t\tthis._metadataLocalDisposable.clear();\n\t\t\t\t\tif (this.configurationService.getValue('notebook.diff.ignoreMetadata')) {\n\t\t\t\t\t\tthis._disposeMetadata();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.cell.metadataStatusHeight = 25;\n\t\t\t\t\t\tthis._buildMetadata();\n\t\t\t\t\t\tthis.updateMetadataRendering();\n\t\t\t\t\t\tmetadataLayoutChange = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (e.affectsConfiguration('notebook.diff.ignoreOutputs')) {\n\t\t\t\tconst newValue = this.configurationService.getValue<boolean>('notebook.diff.ignoreOutputs');\n\n\t\t\t\tif (newValue !== undefined && this._ignoreOutputs !== (newValue || this.notebookEditor.textModel?.transientOptions.transientOutputs)) {\n\t\t\t\t\tthis._ignoreOutputs = newValue || !!(this.notebookEditor.textModel?.transientOptions.transientOutputs);\n\n\t\t\t\t\tthis._outputLocalDisposable.clear();\n\t\t\t\t\tif (this._ignoreOutputs) {\n\t\t\t\t\t\tthis._disposeOutput();\n\t\t\t\t\t\tthis.cell.layoutChange();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.cell.outputStatusHeight = 25;\n\t\t\t\t\t\tthis._buildOutput();\n\t\t\t\t\t\toutputLayoutChange = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (metadataLayoutChange || outputLayoutChange) {\n\t\t\t\tthis.layout({ metadataHeight: metadataLayoutChange, outputTotalHeight: outputLayoutChange });\n\t\t\t}\n\t\t}));\n\t}\n\n\tupdateMetadataRendering() {\n\t\tif (this.cell.metadataFoldingState === PropertyFoldingState.Expanded) {\n\t\t\t// we should expand the metadata editor\n\t\t\tthis._metadataInfoContainer.style.display = 'block';\n\n\t\t\tif (!this._metadataEditorContainer || !this._metadataEditor) {\n\t\t\t\t// create editor\n\t\t\t\tthis._metadataEditorContainer = DOM.append(this._metadataInfoContainer, DOM.$('.metadata-editor-container'));\n\t\t\t\tthis._buildMetadataEditor();\n\t\t\t} else {\n\t\t\t\tthis.cell.metadataHeight = this._metadataEditor.getContentHeight();\n\t\t\t}\n\t\t} else {\n\t\t\t// we should collapse the metadata editor\n\t\t\tthis._metadataInfoContainer.style.display = 'none';\n\t\t\t// this._metadataEditorDisposeStore.clear();\n\t\t\tthis.cell.metadataHeight = 0;\n\t\t}\n\t}\n\n\tupdateOutputRendering(renderRichOutput: boolean) {\n\t\tif (this.cell.outputFoldingState === PropertyFoldingState.Expanded) {\n\t\t\tthis._outputInfoContainer.style.display = 'block';\n\t\t\tif (renderRichOutput) {\n\t\t\t\tthis._hideOutputsRaw();\n\t\t\t\tthis._buildOutputRendererContainer();\n\t\t\t\tthis._showOutputsRenderer();\n\t\t\t\tthis._showOutputsEmptyView();\n\t\t\t} else {\n\t\t\t\tthis._hideOutputsRenderer();\n\t\t\t\tthis._buildOutputRawContainer();\n\t\t\t\tthis._showOutputsRaw();\n\t\t\t}\n\t\t} else {\n\t\t\tthis._outputInfoContainer.style.display = 'none';\n\n\t\t\tthis._hideOutputsRaw();\n\t\t\tthis._hideOutputsRenderer();\n\t\t\tthis._hideOutputsEmptyView();\n\t\t}\n\t}\n\n\tprivate _buildOutputRawContainer() {\n\t\tif (!this._outputEditorContainer) {\n\t\t\tthis._outputEditorContainer = DOM.append(this._outputInfoContainer, DOM.$('.output-editor-container'));\n\t\t\tthis._buildOutputEditor();\n\t\t}\n\t}\n\n\tprivate _showOutputsRaw() {\n\t\tif (this._outputEditorContainer) {\n\t\t\tthis._outputEditorContainer.style.display = 'block';\n\t\t\tthis.cell.rawOutputHeight = this._outputEditor!.getContentHeight();\n\t\t}\n\t}\n\n\tprivate _showOutputsEmptyView() {\n\t\tthis.cell.layoutChange();\n\t}\n\n\tprotected _hideOutputsRaw() {\n\t\tif (this._outputEditorContainer) {\n\t\t\tthis._outputEditorContainer.style.display = 'none';\n\t\t\tthis.cell.rawOutputHeight = 0;\n\t\t}\n\t}\n\n\tprotected _hideOutputsEmptyView() {\n\t\tthis.cell.layoutChange();\n\t}\n\n\tabstract _buildOutputRendererContainer(): void;\n\tabstract _hideOutputsRenderer(): void;\n\tabstract _showOutputsRenderer(): void;\n\n\tprivate _applySanitizedMetadataChanges(currentMetadata: NotebookCellMetadata, newMetadata: any) {\n\t\tconst result: { [key: string]: any } = {};\n\t\ttry {\n\t\t\tconst newMetadataObj = JSON.parse(newMetadata);\n\t\t\tconst keys = new Set([...Object.keys(newMetadataObj)]);\n\t\t\tfor (const key of keys) {\n\t\t\t\tswitch (key as keyof NotebookCellMetadata) {\n\t\t\t\t\tcase 'inputCollapsed':\n\t\t\t\t\tcase 'outputCollapsed':\n\t\t\t\t\t\t// boolean\n\t\t\t\t\t\tif (typeof newMetadataObj[key] === 'boolean') {\n\t\t\t\t\t\t\tresult[key] = newMetadataObj[key];\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tresult[key] = currentMetadata[key as keyof NotebookCellMetadata];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tresult[key] = newMetadataObj[key];\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst index = this.notebookEditor.textModel!.cells.indexOf(this.cell.modified!.textModel);\n\n\t\t\tif (index < 0) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.notebookEditor.textModel!.applyEdits([\n\t\t\t\t{ editType: CellEditType.Metadata, index, metadata: result }\n\t\t\t], true, undefined, () => undefined, undefined, true);\n\t\t} catch {\n\t\t}\n\t}\n\n\tprivate async _buildMetadataEditor() {\n\t\tthis._metadataEditorDisposeStore.clear();\n\n\t\tif (this.cell instanceof SideBySideDiffElementViewModel) {\n\t\t\tthis._metadataEditor = this.instantiationService.createInstance(DiffEditorWidget, this._metadataEditorContainer!, {\n\t\t\t\t...fixedDiffEditorOptions,\n\t\t\t\toverflowWidgetsDomNode: this.notebookEditor.getOverflowContainerDomNode(),\n\t\t\t\treadOnly: false,\n\t\t\t\toriginalEditable: false,\n\t\t\t\tignoreTrimWhitespace: false,\n\t\t\t\tautomaticLayout: false,\n\t\t\t\tdimension: {\n\t\t\t\t\theight: this.cell.layoutInfo.metadataHeight,\n\t\t\t\t\twidth: this.cell.getComputedCellContainerWidth(this.notebookEditor.getLayoutInfo(), true, true)\n\t\t\t\t}\n\t\t\t}, {\n\t\t\t\toriginalEditor: getOptimizedNestedCodeEditorWidgetOptions(),\n\t\t\t\tmodifiedEditor: getOptimizedNestedCodeEditorWidgetOptions()\n\t\t\t});\n\n\t\t\tif (this.cell.unchangedRegionsService.options.enabled) {\n\t\t\t\tthis._metadataEditor.updateOptions({ hideUnchangedRegions: this.cell.unchangedRegionsService.options });\n\t\t\t}\n\t\t\tthis._metadataEditorDisposeStore.add(this.cell.unchangedRegionsService.options.onDidChangeEnablement(() => {\n\t\t\t\tif (this._metadataEditor) {\n\t\t\t\t\tthis._metadataEditor.updateOptions({ hideUnchangedRegions: this.cell.unchangedRegionsService.options });\n\t\t\t\t}\n\t\t\t}));\n\n\n\t\t\tthis.layout({ metadataHeight: true });\n\t\t\tthis._metadataEditorDisposeStore.add(this._metadataEditor);\n\n\t\t\tthis._metadataEditorContainer?.classList.add('diff');\n\n\t\t\tconst [originalMetadataModel, modifiedMetadataModel] = await Promise.all([\n\t\t\t\tthis.textModelService.createModelReference(CellUri.generateCellPropertyUri(this.cell.originalDocument.uri, this.cell.original.handle, Schemas.vscodeNotebookCellMetadata)),\n\t\t\t\tthis.textModelService.createModelReference(CellUri.generateCellPropertyUri(this.cell.modifiedDocument.uri, this.cell.modified.handle, Schemas.vscodeNotebookCellMetadata))\n\t\t\t]);\n\t\t\tthis._metadataEditorDisposeStore.add(originalMetadataModel);\n\t\t\tthis._metadataEditorDisposeStore.add(modifiedMetadataModel);\n\t\t\tconst vm = this._metadataEditor.createViewModel({\n\t\t\t\toriginal: originalMetadataModel.object.textEditorModel,\n\t\t\t\tmodified: modifiedMetadataModel.object.textEditorModel\n\t\t\t});\n\t\t\t// Reduces flicker (compute this before setting the model)\n\t\t\t// Else when the model is set, the height of the editor will be x, after diff is computed, then height will be y.\n\t\t\t// & that results in flicker.\n\t\t\tawait vm.waitForDiff();\n\t\t\tthis._metadataEditor.setModel(vm);\n\n\t\t\tthis.cell.metadataHeight = this._metadataEditor.getContentHeight();\n\n\t\t\tthis._metadataEditorDisposeStore.add(this._metadataEditor.onDidContentSizeChange((e) => {\n\t\t\t\tif (e.contentHeightChanged && this.cell.metadataFoldingState === PropertyFoldingState.Expanded) {\n\t\t\t\t\tthis.cell.metadataHeight = e.contentHeight;\n\t\t\t\t}\n\t\t\t}));\n\n\t\t\tlet respondingToContentChange = false;\n\n\t\t\tthis._metadataEditorDisposeStore.add(modifiedMetadataModel.object.textEditorModel.onDidChangeContent(() => {\n\t\t\t\trespondingToContentChange = true;\n\t\t\t\tconst value = modifiedMetadataModel.object.textEditorModel.getValue();\n\t\t\t\tthis._applySanitizedMetadataChanges(this.cell.modified!.metadata, value);\n\t\t\t\tthis._metadataHeader.refresh();\n\t\t\t\trespondingToContentChange = false;\n\t\t\t}));\n\n\t\t\tthis._metadataEditorDisposeStore.add(this.cell.modified.textModel.onDidChangeMetadata(() => {\n\t\t\t\tif (respondingToContentChange) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst modifiedMetadataSource = getFormattedMetadataJSON(this.notebookEditor.textModel?.transientOptions.transientCellMetadata, this.cell.modified?.metadata || {}, this.cell.modified?.language);\n\t\t\t\tmodifiedMetadataModel.object.textEditorModel.setValue(modifiedMetadataSource);\n\t\t\t}));\n\n\t\t\treturn;\n\t\t} else {\n\t\t\tthis._metadataEditor = this.instantiationService.createInstance(CodeEditorWidget, this._metadataEditorContainer!, {\n\t\t\t\t...fixedEditorOptions,\n\t\t\t\tdimension: {\n\t\t\t\t\twidth: this.cell.getComputedCellContainerWidth(this.notebookEditor.getLayoutInfo(), false, true),\n\t\t\t\t\theight: this.cell.layoutInfo.metadataHeight\n\t\t\t\t},\n\t\t\t\toverflowWidgetsDomNode: this.notebookEditor.getOverflowContainerDomNode(),\n\t\t\t\treadOnly: false\n\t\t\t}, {});\n\t\t\tthis.layout({ metadataHeight: true });\n\t\t\tthis._metadataEditorDisposeStore.add(this._metadataEditor);\n\n\t\t\tconst mode = this.languageService.createById('jsonc');\n\t\t\tconst originalMetadataSource = getFormattedMetadataJSON(this.notebookEditor.textModel?.transientOptions.transientCellMetadata,\n\t\t\t\tthis.cell.type === 'insert'\n\t\t\t\t\t? this.cell.modified!.metadata || {}\n\t\t\t\t\t: this.cell.original!.metadata || {});\n\t\t\tconst uri = this.cell.type === 'insert'\n\t\t\t\t? this.cell.modified!.uri\n\t\t\t\t: this.cell.original!.uri;\n\t\t\tconst handle = this.cell.type === 'insert'\n\t\t\t\t? this.cell.modified!.handle\n\t\t\t\t: this.cell.original!.handle;\n\n\t\t\tconst modelUri = CellUri.generateCellPropertyUri(uri, handle, Schemas.vscodeNotebookCellMetadata);\n\t\t\tconst metadataModel = this.modelService.createModel(originalMetadataSource, mode, modelUri, false);\n\t\t\tthis._metadataEditor.setModel(metadataModel);\n\t\t\tthis._metadataEditorDisposeStore.add(metadataModel);\n\n\t\t\tthis.cell.metadataHeight = this._metadataEditor.getContentHeight();\n\n\t\t\tthis._metadataEditorDisposeStore.add(this._metadataEditor.onDidContentSizeChange((e) => {\n\t\t\t\tif (e.contentHeightChanged && this.cell.metadataFoldingState === PropertyFoldingState.Expanded) {\n\t\t\t\t\tthis.cell.metadataHeight = e.contentHeight;\n\t\t\t\t}\n\t\t\t}));\n\t\t}\n\t}\n\n\tprivate _buildOutputEditor() {\n\t\tthis._outputEditorDisposeStore.clear();\n\n\t\tif ((this.cell.type === 'modified' || this.cell.type === 'unchanged') && !this.notebookEditor.textModel!.transientOptions.transientOutputs) {\n\t\t\tconst originalOutputsSource = getFormattedOutputJSON(this.cell.original?.outputs || []);\n\t\t\tconst modifiedOutputsSource = getFormattedOutputJSON(this.cell.modified?.outputs || []);\n\t\t\tif (originalOutputsSource !== modifiedOutputsSource) {\n\t\t\t\tconst mode = this.languageService.createById('json');\n\t\t\t\tconst originalModel = this.modelService.createModel(originalOutputsSource, mode, undefined, true);\n\t\t\t\tconst modifiedModel = this.modelService.createModel(modifiedOutputsSource, mode, undefined, true);\n\t\t\t\tthis._outputEditorDisposeStore.add(originalModel);\n\t\t\t\tthis._outputEditorDisposeStore.add(modifiedModel);\n\n\t\t\t\tconst lineHeight = this.notebookEditor.getLayoutInfo().fontInfo.lineHeight || 17;\n\t\t\t\tconst lineCount = Math.max(originalModel.getLineCount(), modifiedModel.getLineCount());\n\t\t\t\tthis._outputEditor = this.instantiationService.createInstance(DiffEditorWidget, this._outputEditorContainer!, {\n\t\t\t\t\t...fixedDiffEditorOptions,\n\t\t\t\t\toverflowWidgetsDomNode: this.notebookEditor.getOverflowContainerDomNode(),\n\t\t\t\t\treadOnly: true,\n\t\t\t\t\tignoreTrimWhitespace: false,\n\t\t\t\t\tautomaticLayout: false,\n\t\t\t\t\tdimension: {\n\t\t\t\t\t\theight: Math.min(OUTPUT_EDITOR_HEIGHT_MAGIC, this.cell.layoutInfo.rawOutputHeight || lineHeight * lineCount),\n\t\t\t\t\t\twidth: this.cell.getComputedCellContainerWidth(this.notebookEditor.getLayoutInfo(), false, true)\n\t\t\t\t\t},\n\t\t\t\t\taccessibilityVerbose: this.configurationService.getValue<boolean>(AccessibilityVerbositySettingId.DiffEditor) ?? false\n\t\t\t\t}, {\n\t\t\t\t\toriginalEditor: getOptimizedNestedCodeEditorWidgetOptions(),\n\t\t\t\t\tmodifiedEditor: getOptimizedNestedCodeEditorWidgetOptions()\n\t\t\t\t});\n\t\t\t\tthis._outputEditorDisposeStore.add(this._outputEditor);\n\n\t\t\t\tthis._outputEditorContainer?.classList.add('diff');\n\n\t\t\t\tthis._outputEditor.setModel({\n\t\t\t\t\toriginal: originalModel,\n\t\t\t\t\tmodified: modifiedModel\n\t\t\t\t});\n\t\t\t\tthis._outputEditor.restoreViewState(this.cell.getOutputEditorViewState() as editorCommon.IDiffEditorViewState);\n\n\t\t\t\tthis.cell.rawOutputHeight = this._outputEditor.getContentHeight();\n\n\t\t\t\tthis._outputEditorDisposeStore.add(this._outputEditor.onDidContentSizeChange((e) => {\n\t\t\t\t\tif (e.contentHeightChanged && this.cell.outputFoldingState === PropertyFoldingState.Expanded) {\n\t\t\t\t\t\tthis.cell.rawOutputHeight = e.contentHeight;\n\t\t\t\t\t}\n\t\t\t\t}));\n\n\t\t\t\tthis._outputEditorDisposeStore.add(this.cell.modified!.textModel.onDidChangeOutputs(() => {\n\t\t\t\t\tconst modifiedOutputsSource = getFormattedOutputJSON(this.cell.modified?.outputs || []);\n\t\t\t\t\tmodifiedModel.setValue(modifiedOutputsSource);\n\t\t\t\t\tthis._outputHeader.refresh();\n\t\t\t\t}));\n\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tthis._outputEditor = this.instantiationService.createInstance(CodeEditorWidget, this._outputEditorContainer!, {\n\t\t\t...fixedEditorOptions,\n\t\t\tdimension: {\n\t\t\t\twidth: Math.min(OUTPUT_EDITOR_HEIGHT_MAGIC, this.cell.getComputedCellContainerWidth(this.notebookEditor.getLayoutInfo(), false, this.cell.type === 'unchanged' || this.cell.type === 'modified') - 32),\n\t\t\t\theight: this.cell.layoutInfo.rawOutputHeight\n\t\t\t},\n\t\t\toverflowWidgetsDomNode: this.notebookEditor.getOverflowContainerDomNode()\n\t\t}, {});\n\t\tthis._outputEditorDisposeStore.add(this._outputEditor);\n\n\t\tconst mode = this.languageService.createById('json');\n\t\tconst originaloutputSource = getFormattedOutputJSON(\n\t\t\tthis.notebookEditor.textModel!.transientOptions.transientOutputs\n\t\t\t\t? []\n\t\t\t\t: this.cell.type === 'insert'\n\t\t\t\t\t? this.cell.modified?.outputs || []\n\t\t\t\t\t: this.cell.original?.outputs || []);\n\t\tconst outputModel = this.modelService.createModel(originaloutputSource, mode, undefined, true);\n\t\tthis._outputEditorDisposeStore.add(outputModel);\n\t\tthis._outputEditor.setModel(outputModel);\n\t\tthis._outputEditor.restoreViewState(this.cell.getOutputEditorViewState());\n\n\t\tthis.cell.rawOutputHeight = this._outputEditor.getContentHeight();\n\n\t\tthis._outputEditorDisposeStore.add(this._outputEditor.onDidContentSizeChange((e) => {\n\t\t\tif (e.contentHeightChanged && this.cell.outputFoldingState === PropertyFoldingState.Expanded) {\n\t\t\t\tthis.cell.rawOutputHeight = e.contentHeight;\n\t\t\t}\n\t\t}));\n\t}\n\n\tprotected layoutNotebookCell() {\n\t\tthis.notebookEditor.layoutNotebookCell(\n\t\t\tthis.cell,\n\t\t\tthis.cell.layoutInfo.totalHeight\n\t\t);\n\t}\n\n\tupdateBorders() {\n\t\tthis.templateData.leftBorder.style.height = `${this.cell.layoutInfo.totalHeight - 32}px`;\n\t\tthis.templateData.rightBorder.style.height = `${this.cell.layoutInfo.totalHeight - 32}px`;\n\t\tthis.templateData.bottomBorder.style.top = `${this.cell.layoutInfo.totalHeight - 32}px`;\n\t}\n\n\toverride dispose() {\n\t\tif (this._outputEditor) {\n\t\t\tthis.cell.saveOutputEditorViewState(this._outputEditor.saveViewState());\n\t\t}\n\n\t\tif (this._metadataEditor) {\n\t\t\tthis.cell.saveMetadataEditorViewState(this._metadataEditor.saveViewState());\n\t\t}\n\n\t\tthis._metadataEditorDisposeStore.dispose();\n\t\tthis._outputEditorDisposeStore.dispose();\n\n\t\tthis._isDisposed = true;\n\t\tsuper.dispose();\n\t}\n\n\tabstract updateSourceEditor(): void;\n\tabstract layout(state: IDiffElementLayoutState): void;\n}\n\nabstract class SingleSideDiffElement extends AbstractElementRenderer {\n\tprotected _editor!: CodeEditorWidget;\n\toverride readonly cell: SingleSideDiffElementViewModel;\n\toverride readonly templateData: CellDiffSingleSideRenderTemplate;\n\tabstract get nestedCellViewModel(): DiffNestedCellViewModel;\n\tabstract get readonly(): boolean;\n\tconstructor(\n\t\tnotebookEditor: INotebookTextDiffEditor,\n\t\tcell: SingleSideDiffElementViewModel,\n\t\ttemplateData: CellDiffSingleSideRenderTemplate,\n\t\tstyle: 'left' | 'right' | 'full',\n\t\tinstantiationService: IInstantiationService,\n\t\tlanguageService: ILanguageService,\n\t\tmodelService: IModelService,\n\t\ttextModelService: ITextModelService,\n\t\tcontextMenuService: IContextMenuService,\n\t\tkeybindingService: IKeybindingService,\n\t\tnotificationService: INotificationService,\n\t\tmenuService: IMenuService,\n\t\tcontextKeyService: IContextKeyService,\n\t\tconfigurationService: IConfigurationService,\n\t\ttextConfigurationService: ITextResourceConfigurationService\n\t) {\n\t\tsuper(\n\t\t\tnotebookEditor,\n\t\t\tcell,\n\t\t\ttemplateData,\n\t\t\tstyle,\n\t\t\tinstantiationService,\n\t\t\tlanguageService,\n\t\t\tmodelService,\n\t\t\ttextModelService,\n\t\t\tcontextMenuService,\n\t\t\tkeybindingService,\n\t\t\tnotificationService,\n\t\t\tmenuService,\n\t\t\tcontextKeyService,\n\t\t\tconfigurationService,\n\t\t\ttextConfigurationService\n\t\t);\n\t\tthis.cell = cell;\n\t\tthis.templateData = templateData;\n\n\t\tthis.updateBorders();\n\t}\n\n\tinit() {\n\t\tthis._diagonalFill = this.templateData.diagonalFill;\n\t}\n\n\toverride buildBody() {\n\t\tconst body = this.templateData.body;\n\t\tthis._diffEditorContainer = this.templateData.diffEditorContainer;\n\t\tbody.classList.remove('left', 'right', 'full');\n\t\tswitch (this.style) {\n\t\t\tcase 'left':\n\t\t\t\tbody.classList.add('left');\n\t\t\t\tbreak;\n\t\t\tcase 'right':\n\t\t\t\tbody.classList.add('right');\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbody.classList.add('full');\n\t\t\t\tbreak;\n\t\t}\n\n\t\tthis.styleContainer(this._diffEditorContainer);\n\t\tthis.updateSourceEditor();\n\n\t\tif (this.configurationService.getValue('notebook.diff.ignoreMetadata')) {\n\t\t\tthis._disposeMetadata();\n\t\t} else {\n\t\t\tthis._buildMetadata();\n\t\t}\n\n\t\tif (this.configurationService.getValue('notebook.diff.ignoreOutputs') || this.notebookEditor.textModel?.transientOptions.transientOutputs) {\n\t\t\tthis._disposeOutput();\n\t\t} else {\n\t\t\tthis._buildOutput();\n\t\t}\n\n\t\tthis._register(this.configurationService.onDidChangeConfiguration(e => {\n\t\t\tlet metadataLayoutChange = false;\n\t\t\tlet outputLayoutChange = false;\n\t\t\tif (e.affectsConfiguration('notebook.diff.ignoreMetadata')) {\n\t\t\t\tthis._metadataLocalDisposable.clear();\n\t\t\t\tif (this.configurationService.getValue('notebook.diff.ignoreMetadata')) {\n\t\t\t\t\tthis._disposeMetadata();\n\t\t\t\t} else {\n\t\t\t\t\tthis.cell.metadataStatusHeight = 25;\n\t\t\t\t\tthis._buildMetadata();\n\t\t\t\t\tthis.updateMetadataRendering();\n\t\t\t\t\tmetadataLayoutChange = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (e.affectsConfiguration('notebook.diff.ignoreOutputs')) {\n\t\t\t\tthis._outputLocalDisposable.clear();\n\t\t\t\tif (this.configurationService.getValue('notebook.diff.ignoreOutputs') || this.notebookEditor.textModel?.transientOptions.transientOutputs) {\n\t\t\t\t\tthis._disposeOutput();\n\t\t\t\t} else {\n\t\t\t\t\tthis.cell.outputStatusHeight = 25;\n\t\t\t\t\tthis._buildOutput();\n\t\t\t\t\toutputLayoutChange = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (metadataLayoutChange || outputLayoutChange) {\n\t\t\t\tthis.layout({ metadataHeight: metadataLayoutChange, outputTotalHeight: outputLayoutChange });\n\t\t\t}\n\t\t}));\n\t}\n\n\toverride updateSourceEditor(): void {\n\t\tthis._cellHeaderContainer = this.templateData.cellHeaderContainer;\n\t\tthis._cellHeaderContainer.style.display = 'flex';\n\t\tthis._cellHeaderContainer.innerText = '';\n\t\tthis._editorContainer = this.templateData.editorContainer;\n\t\tthis._editorContainer.classList.add('diff');\n\n\t\tconst renderSourceEditor = () => {\n\t\t\tif (this.cell.cellFoldingState === PropertyFoldingState.Collapsed) {\n\t\t\t\tthis._editorContainer.style.display = 'none';\n\t\t\t\tthis.cell.editorHeight = 0;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst lineHeight = this.notebookEditor.getLayoutInfo().fontInfo.lineHeight || 17;\n\t\t\tconst editorHeight = this.cell.computeInputEditorHeight(lineHeight);\n\n\t\t\tthis._editorContainer.style.height = `${editorHeight}px`;\n\t\t\tthis._editorContainer.style.display = 'block';\n\n\t\t\tif (this._editor) {\n\t\t\t\tconst contentHeight = this._editor.getContentHeight();\n\t\t\t\tif (contentHeight >= 0) {\n\t\t\t\t\tthis.cell.editorHeight = contentHeight;\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis._editor = this.templateData.sourceEditor;\n\t\t\tthis._editor.layout(\n\t\t\t\t{\n\t\t\t\t\twidth: (this.notebookEditor.getLayoutInfo().width - 2 * DIFF_CELL_MARGIN) / 2 - 18,\n\t\t\t\t\theight: editorHeight\n\t\t\t\t}\n\t\t\t);\n\t\t\tthis._editor.updateOptions({ readOnly: this.readonly });\n\t\t\tthis.cell.editorHeight = editorHeight;\n\n\t\t\tthis._register(this._editor.onDidContentSizeChange((e) => {\n\t\t\t\tif (this.cell.cellFoldingState === PropertyFoldingState.Expanded && e.contentHeightChanged && this.cell.layoutInfo.editorHeight !== e.contentHeight) {\n\t\t\t\t\tthis.cell.editorHeight = e.contentHeight;\n\t\t\t\t}\n\t\t\t}));\n\t\t\tthis._initializeSourceDiffEditor(this.nestedCellViewModel);\n\t\t};\n\n\t\tthis._cellHeader = this._register(this.instantiationService.createInstance(\n\t\t\tPropertyHeader,\n\t\t\tthis.cell,\n\t\t\tthis._cellHeaderContainer,\n\t\t\tthis.notebookEditor,\n\t\t\t{\n\t\t\t\tupdateInfoRendering: () => renderSourceEditor(),\n\t\t\t\tcheckIfModified: (_) => ({ reason: undefined }),\n\t\t\t\tgetFoldingState: (cell) => cell.cellFoldingState,\n\t\t\t\tupdateFoldingState: (cell, state) => cell.cellFoldingState = state,\n\t\t\t\tunChangedLabel: 'Input',\n\t\t\t\tchangedLabel: 'Input',\n\t\t\t\tprefix: 'input',\n\t\t\t\tmenuId: MenuId.NotebookDiffCellInputTitle\n\t\t\t}\n\t\t));\n\t\tthis._cellHeader.buildHeader();\n\t\trenderSourceEditor();\n\n\t\tthis._initializeSourceDiffEditor(this.nestedCellViewModel);\n\t}\n\tprotected calculateDiagonalFillHeight() {\n\t\treturn this.cell.layoutInfo.cellStatusHeight + this.cell.layoutInfo.editorHeight + this.cell.layoutInfo.editorMargin + this.cell.layoutInfo.metadataStatusHeight + this.cell.layoutInfo.metadataHeight + this.cell.layoutInfo.outputTotalHeight + this.cell.layoutInfo.outputStatusHeight;\n\t}\n\n\tprivate async _initializeSourceDiffEditor(modifiedCell: DiffNestedCellViewModel) {\n\t\tconst modifiedRef = await this.textModelService.createModelReference(modifiedCell.uri);\n\n\t\tif (this._isDisposed) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst modifiedTextModel = modifiedRef.object.textEditorModel;\n\t\tthis._register(modifiedRef);\n\n\t\tthis._editor!.setModel(modifiedTextModel);\n\n\t\tconst editorViewState = this.cell.getSourceEditorViewState() as editorCommon.IDiffEditorViewState | null;\n\t\tif (editorViewState) {\n\t\t\tthis._editor!.restoreViewState(editorViewState);\n\t\t}\n\n\t\tconst contentHeight = this._editor!.getContentHeight();\n\t\tthis.cell.editorHeight = contentHeight;\n\t\tconst height = `${this.calculateDiagonalFillHeight()}px`;\n\t\tif (this._diagonalFill!.style.height !== height) {\n\t\t\tthis._diagonalFill!.style.height = height;\n\t\t}\n\t}\n\n\t_disposeMetadata() {\n\t\tthis.cell.metadataStatusHeight = 0;\n\t\tthis.cell.metadataHeight = 0;\n\t\tthis.templateData.cellHeaderContainer.style.display = 'none';\n\t\tthis.templateData.metadataHeaderContainer.style.display = 'none';\n\t\tthis.templateData.metadataInfoContainer.style.display = 'none';\n\t\tthis._metadataEditor = undefined;\n\t}\n\n\t_buildMetadata() {\n\t\tthis._metadataHeaderContainer = this.templateData.metadataHeaderContainer;\n\t\tthis._metadataInfoContainer = this.templateData.metadataInfoContainer;\n\t\tthis._metadataHeaderContainer.style.display = 'flex';\n\t\tthis._metadataInfoContainer.style.display = 'block';\n\t\tthis._metadataHeaderContainer.innerText = '';\n\t\tthis._metadataInfoContainer.innerText = '';\n\n\t\tthis._metadataHeader = this.instantiationService.createInstance(\n\t\t\tPropertyHeader,\n\t\t\tthis.cell,\n\t\t\tthis._metadataHeaderContainer,\n\t\t\tthis.notebookEditor,\n\t\t\t{\n\t\t\t\tupdateInfoRendering: this.updateMetadataRendering.bind(this),\n\t\t\t\tcheckIfModified: (cell) => {\n\t\t\t\t\treturn cell.checkMetadataIfModified();\n\t\t\t\t},\n\t\t\t\tgetFoldingState: (cell) => {\n\t\t\t\t\treturn cell.metadataFoldingState;\n\t\t\t\t},\n\t\t\t\tupdateFoldingState: (cell, state) => {\n\t\t\t\t\tcell.metadataFoldingState = state;\n\t\t\t\t},\n\t\t\t\tunChangedLabel: 'Metadata',\n\t\t\t\tchangedLabel: 'Metadata changed',\n\t\t\t\tprefix: 'metadata',\n\t\t\t\tmenuId: MenuId.NotebookDiffCellMetadataTitle\n\t\t\t}\n\t\t);\n\t\tthis._metadataLocalDisposable.add(this._metadataHeader);\n\t\tthis._metadataHeader.buildHeader();\n\t}\n\n\t_buildOutput() {\n\t\tthis.templateData.outputHeaderContainer.style.display = 'flex';\n\t\tthis.templateData.outputInfoContainer.style.display = 'block';\n\n\t\tthis._outputHeaderContainer = this.templateData.outputHeaderContainer;\n\t\tthis._outputInfoContainer = this.templateData.outputInfoContainer;\n\n\t\tthis._outputHeaderContainer.innerText = '';\n\t\tthis._outputInfoContainer.innerText = '';\n\n\t\tthis._outputHeader = this.instantiationService.createInstance(\n\t\t\tPropertyHeader,\n\t\t\tthis.cell,\n\t\t\tthis._outputHeaderContainer,\n\t\t\tthis.notebookEditor,\n\t\t\t{\n\t\t\t\tupdateInfoRendering: this.updateOutputRendering.bind(this),\n\t\t\t\tcheckIfModified: (cell) => {\n\t\t\t\t\treturn cell.checkIfOutputsModified();\n\t\t\t\t},\n\t\t\t\tgetFoldingState: (cell) => {\n\t\t\t\t\treturn cell.outputFoldingState;\n\t\t\t\t},\n\t\t\t\tupdateFoldingState: (cell, state) => {\n\t\t\t\t\tcell.outputFoldingState = state;\n\t\t\t\t},\n\t\t\t\tunChangedLabel: 'Outputs',\n\t\t\t\tchangedLabel: 'Outputs changed',\n\t\t\t\tprefix: 'output',\n\t\t\t\tmenuId: MenuId.NotebookDiffCellOutputsTitle\n\t\t\t}\n\t\t);\n\t\tthis._outputLocalDisposable.add(this._outputHeader);\n\t\tthis._outputHeader.buildHeader();\n\t}\n\n\t_disposeOutput() {\n\t\tthis._hideOutputsRaw();\n\t\tthis._hideOutputsRenderer();\n\t\tthis._hideOutputsEmptyView();\n\n\t\tthis.cell.rawOutputHeight = 0;\n\t\tthis.cell.outputMetadataHeight = 0;\n\t\tthis.cell.outputStatusHeight = 0;\n\t\tthis.templateData.outputHeaderContainer.style.display = 'none';\n\t\tthis.templateData.outputInfoContainer.style.display = 'none';\n\t\tthis._outputViewContainer = undefined;\n\t}\n}\nexport class DeletedElement extends SingleSideDiffElement {\n\tconstructor(\n\t\tnotebookEditor: INotebookTextDiffEditor,\n\t\tcell: SingleSideDiffElementViewModel,\n\t\ttemplateData: CellDiffSingleSideRenderTemplate,\n\t\t@ILanguageService languageService: ILanguageService,\n\t\t@IModelService modelService: IModelService,\n\t\t@ITextModelService textModelService: ITextModelService,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@IContextMenuService contextMenuService: IContextMenuService,\n\t\t@IKeybindingService keybindingService: IKeybindingService,\n\t\t@INotificationService notificationService: INotificationService,\n\t\t@IMenuService menuService: IMenuService,\n\t\t@IContextKeyService contextKeyService: IContextKeyService,\n\t\t@IConfigurationService configurationService: IConfigurationService,\n\t\t@ITextResourceConfigurationService textConfigurationService: ITextResourceConfigurationService,\n\t) {\n\t\tsuper(notebookEditor, cell, templateData, 'left', instantiationService, languageService, modelService, textModelService, contextMenuService, keybindingService, notificationService, menuService, contextKeyService, configurationService, textConfigurationService);\n\t}\n\n\tget nestedCellViewModel() {\n\t\treturn this.cell.original!;\n\t}\n\tget readonly() {\n\t\treturn true;\n\t}\n\n\tstyleContainer(container: HTMLElement) {\n\t\tcontainer.classList.remove('inserted');\n\t\tcontainer.classList.add('removed');\n\t}\n\n\tlayout(state: IDiffElementLayoutState) {\n\t\tDOM.scheduleAtNextAnimationFrame(DOM.getWindow(this._diffEditorContainer), () => {\n\t\t\tif ((state.editorHeight || state.outerWidth) && this._editor) {\n\t\t\t\tthis._editorContainer.style.height = `${this.cell.layoutInfo.editorHeight}px`;\n\t\t\t\tthis._editor.layout({\n\t\t\t\t\twidth: this.cell.getComputedCellContainerWidth(this.notebookEditor.getLayoutInfo(), false, false),\n\t\t\t\t\theight: this.cell.layoutInfo.editorHeight\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (state.outerWidth && this._editor) {\n\t\t\t\tthis._editorContainer.style.height = `${this.cell.layoutInfo.editorHeight}px`;\n\t\t\t\tthis._editor.layout();\n\t\t\t}\n\n\t\t\tif (state.metadataHeight || state.outerWidth) {\n\t\t\t\tthis._metadataEditor?.layout({\n\t\t\t\t\twidth: this.cell.getComputedCellContainerWidth(this.notebookEditor.getLayoutInfo(), false, false),\n\t\t\t\t\theight: this.cell.layoutInfo.metadataHeight\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (state.outputTotalHeight || state.outerWidth) {\n\t\t\t\tthis._outputEditor?.layout({\n\t\t\t\t\twidth: this.cell.getComputedCellContainerWidth(this.notebookEditor.getLayoutInfo(), false, false),\n\t\t\t\t\theight: this.cell.layoutInfo.outputTotalHeight\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (this._diagonalFill) {\n\t\t\t\tthis._diagonalFill.style.height = `${this.calculateDiagonalFillHeight()}px`;\n\t\t\t}\n\n\t\t\tthis.layoutNotebookCell();\n\t\t});\n\t}\n\n\n\t_buildOutputRendererContainer() {\n\t\tif (!this._outputViewContainer) {\n\t\t\tthis._outputViewContainer = DOM.append(this._outputInfoContainer, DOM.$('.output-view-container'));\n\t\t\tthis._outputEmptyElement = DOM.append(this._outputViewContainer, DOM.$('.output-empty-view'));\n\t\t\tconst span = DOM.append(this._outputEmptyElement, DOM.$('span'));\n\t\t\tspan.innerText = 'No outputs to render';\n\n\t\t\tif (!this.cell.original?.outputs.length) {\n\t\t\t\tthis._outputEmptyElement.style.display = 'block';\n\t\t\t} else {\n\t\t\t\tthis._outputEmptyElement.style.display = 'none';\n\t\t\t}\n\n\t\t\tthis.cell.layoutChange();\n\n\t\t\tthis._outputLeftView = this.instantiationService.createInstance(OutputContainer, this.notebookEditor, this.notebookEditor.textModel!, this.cell, this.cell.original!, DiffSide.Original, this._outputViewContainer);\n\t\t\tthis._register(this._outputLeftView);\n\t\t\tthis._outputLeftView.render();\n\n\t\t\tconst removedOutputRenderListener = this.notebookEditor.onDidDynamicOutputRendered(e => {\n\t\t\t\tif (e.cell.uri.toString() === this.cell.original!.uri.toString()) {\n\t\t\t\t\tthis.notebookEditor.deltaCellOutputContainerClassNames(DiffSide.Original, this.cell.original!.id, ['nb-cellDeleted'], []);\n\t\t\t\t\tremovedOutputRenderListener.dispose();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis._register(removedOutputRenderListener);\n\t\t}\n\n\t\tthis._outputViewContainer.style.display = 'block';\n\t}\n\n\t_decorate() {\n\t\tthis.notebookEditor.deltaCellOutputContainerClassNames(DiffSide.Original, this.cell.original!.id, ['nb-cellDeleted'], []);\n\t}\n\n\t_showOutputsRenderer() {\n\t\tif (this._outputViewContainer) {\n\t\t\tthis._outputViewContainer.style.display = 'block';\n\n\t\t\tthis._outputLeftView?.showOutputs();\n\t\t\tthis._decorate();\n\t\t}\n\t}\n\n\t_hideOutputsRenderer() {\n\t\tif (this._outputViewContainer) {\n\t\t\tthis._outputViewContainer.style.display = 'none';\n\n\t\t\tthis._outputLeftView?.hideOutputs();\n\t\t}\n\t}\n\n\toverride dispose() {\n\t\tif (this._editor) {\n\t\t\tthis.cell.saveSpirceEditorViewState(this._editor.saveViewState());\n\t\t}\n\n\t\tsuper.dispose();\n\t}\n}\n\nexport class InsertElement extends SingleSideDiffElement {\n\tconstructor(\n\t\tnotebookEditor: INotebookTextDiffEditor,\n\t\tcell: SingleSideDiffElementViewModel,\n\t\ttemplateData: CellDiffSingleSideRenderTemplate,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@ILanguageService languageService: ILanguageService,\n\t\t@IModelService modelService: IModelService,\n\t\t@ITextModelService textModelService: ITextModelService,\n\t\t@IContextMenuService contextMenuService: IContextMenuService,\n\t\t@IKeybindingService keybindingService: IKeybindingService,\n\t\t@INotificationService notificationService: INotificationService,\n\t\t@IMenuService menuService: IMenuService,\n\t\t@IContextKeyService contextKeyService: IContextKeyService,\n\t\t@IConfigurationService configurationService: IConfigurationService,\n\t\t@ITextResourceConfigurationService textConfigurationService: ITextResourceConfigurationService,\n\t) {\n\t\tsuper(notebookEditor, cell, templateData, 'right', instantiationService, languageService, modelService, textModelService, contextMenuService, keybindingService, notificationService, menuService, contextKeyService, configurationService, textConfigurationService);\n\t}\n\tget nestedCellViewModel() {\n\t\treturn this.cell.modified!;\n\t}\n\tget readonly() {\n\t\treturn false;\n\t}\n\n\tstyleContainer(container: HTMLElement): void {\n\t\tcontainer.classList.remove('removed');\n\t\tcontainer.classList.add('inserted');\n\t}\n\n\t_buildOutputRendererContainer() {\n\t\tif (!this._outputViewContainer) {\n\t\t\tthis._outputViewContainer = DOM.append(this._outputInfoContainer, DOM.$('.output-view-container'));\n\t\t\tthis._outputEmptyElement = DOM.append(this._outputViewContainer, DOM.$('.output-empty-view'));\n\t\t\tthis._outputEmptyElement.innerText = 'No outputs to render';\n\n\t\t\tif (!this.cell.modified?.outputs.length) {\n\t\t\t\tthis._outputEmptyElement.style.display = 'block';\n\t\t\t} else {\n\t\t\t\tthis._outputEmptyElement.style.display = 'none';\n\t\t\t}\n\n\t\t\tthis.cell.layoutChange();\n\n\t\t\tthis._outputRightView = this.instantiationService.createInstance(OutputContainer, this.notebookEditor, this.notebookEditor.textModel!, this.cell, this.cell.modified!, DiffSide.Modified, this._outputViewContainer);\n\t\t\tthis._register(this._outputRightView);\n\t\t\tthis._outputRightView.render();\n\n\t\t\tconst insertOutputRenderListener = this.notebookEditor.onDidDynamicOutputRendered(e => {\n\t\t\t\tif (e.cell.uri.toString() === this.cell.modified!.uri.toString()) {\n\t\t\t\t\tthis.notebookEditor.deltaCellOutputContainerClassNames(DiffSide.Modified, this.cell.modified!.id, ['nb-cellAdded'], []);\n\t\t\t\t\tinsertOutputRenderListener.dispose();\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis._register(insertOutputRenderListener);\n\t\t}\n\n\t\tthis._outputViewContainer.style.display = 'block';\n\t}\n\n\t_decorate() {\n\t\tthis.notebookEditor.deltaCellOutputContainerClassNames(DiffSide.Modified, this.cell.modified!.id, ['nb-cellAdded'], []);\n\t}\n\n\t_showOutputsRenderer() {\n\t\tif (this._outputViewContainer) {\n\t\t\tthis._outputViewContainer.style.display = 'block';\n\t\t\tthis._outputRightView?.showOutputs();\n\t\t\tthis._decorate();\n\t\t}\n\t}\n\n\t_hideOutputsRenderer() {\n\t\tif (this._outputViewContainer) {\n\t\t\tthis._outputViewContainer.style.display = 'none';\n\t\t\tthis._outputRightView?.hideOutputs();\n\t\t}\n\t}\n\n\tlayout(state: IDiffElementLayoutState) {\n\t\tDOM.scheduleAtNextAnimationFrame(DOM.getWindow(this._diffEditorContainer), () => {\n\t\t\tif ((state.editorHeight || state.outerWidth) && this._editor) {\n\t\t\t\tthis._editorContainer.style.height = `${this.cell.layoutInfo.editorHeight}px`;\n\t\t\t\tthis._editor.layout({\n\t\t\t\t\twidth: this.cell.getComputedCellContainerWidth(this.notebookEditor.getLayoutInfo(), false, false),\n\t\t\t\t\theight: this.cell.layoutInfo.editorHeight\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (state.outerWidth && this._editor) {\n\t\t\t\tthis._editorContainer.style.height = `${this.cell.layoutInfo.editorHeight}px`;\n\t\t\t\tthis._editor.layout();\n\t\t\t}\n\n\t\t\tif (state.metadataHeight || state.outerWidth) {\n\t\t\t\tthis._metadataEditor?.layout({\n\t\t\t\t\twidth: this.cell.getComputedCellContainerWidth(this.notebookEditor.getLayoutInfo(), false, true),\n\t\t\t\t\theight: this.cell.layoutInfo.metadataHeight\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (state.outputTotalHeight || state.outerWidth) {\n\t\t\t\tthis._outputEditor?.layout({\n\t\t\t\t\twidth: this.cell.getComputedCellContainerWidth(this.notebookEditor.getLayoutInfo(), false, false),\n\t\t\t\t\theight: this.cell.layoutInfo.outputTotalHeight\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.layoutNotebookCell();\n\n\t\t\tif (this._diagonalFill) {\n\t\t\t\tthis._diagonalFill.style.height = `${this.calculateDiagonalFillHeight()}px`;\n\t\t\t}\n\t\t});\n\t}\n\n\toverride dispose() {\n\t\tif (this._editor) {\n\t\t\tthis.cell.saveSpirceEditorViewState(this._editor.saveViewState());\n\t\t}\n\n\t\tsuper.dispose();\n\t}\n}\n\nexport class ModifiedElement extends AbstractElementRenderer {\n\tprivate _editor?: DiffEditorWidget;\n\tprivate _editorViewStateChanged: boolean;\n\tprotected _toolbar!: ToolBar;\n\tprotected _menu!: IMenu;\n\n\toverride readonly cell: SideBySideDiffElementViewModel;\n\toverride readonly templateData: CellDiffSideBySideRenderTemplate;\n\n\tconstructor(\n\t\tnotebookEditor: INotebookTextDiffEditor,\n\t\tcell: SideBySideDiffElementViewModel,\n\t\ttemplateData: CellDiffSideBySideRenderTemplate,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@ILanguageService languageService: ILanguageService,\n\t\t@IModelService modelService: IModelService,\n\t\t@ITextModelService textModelService: ITextModelService,\n\t\t@IContextMenuService contextMenuService: IContextMenuService,\n\t\t@IKeybindingService keybindingService: IKeybindingService,\n\t\t@INotificationService notificationService: INotificationService,\n\t\t@IMenuService menuService: IMenuService,\n\t\t@IContextKeyService contextKeyService: IContextKeyService,\n\t\t@IConfigurationService configurationService: IConfigurationService,\n\t\t@ITextResourceConfigurationService textConfigurationService: ITextResourceConfigurationService,\n\t) {\n\t\tsuper(notebookEditor, cell, templateData, 'full', instantiationService, languageService, modelService, textModelService, contextMenuService, keybindingService, notificationService, menuService, contextKeyService, configurationService, textConfigurationService);\n\t\tthis.cell = cell;\n\t\tthis.templateData = templateData;\n\t\tthis._editorViewStateChanged = false;\n\n\t\tthis.updateBorders();\n\t}\n\n\tinit() { }\n\tstyleContainer(container: HTMLElement): void {\n\t\tcontainer.classList.remove('inserted', 'removed');\n\t}\n\n\toverride buildBody(): void {\n\t\tsuper.buildBody();\n\t\tif (this.cell.displayIconToHideUnmodifiedCells) {\n\t\t\tthis._register(this.templateData.marginOverlay.onAction(() => this.cell.hideUnchangedCells()));\n\t\t\tthis.templateData.marginOverlay.show();\n\t\t} else {\n\t\t\tthis.templateData.marginOverlay.hide();\n\t\t}\n\t}\n\t_disposeMetadata() {\n\t\tthis.cell.metadataStatusHeight = 0;\n\t\tthis.cell.metadataHeight = 0;\n\t\tthis.templateData.metadataHeaderContainer.style.display = 'none';\n\t\tthis.templateData.metadataInfoContainer.style.display = 'none';\n\t\tthis._metadataEditor = undefined;\n\t}\n\n\t_buildMetadata() {\n\t\tthis._metadataHeaderContainer = this.templateData.metadataHeaderContainer;\n\t\tthis._metadataInfoContainer = this.templateData.metadataInfoContainer;\n\t\tthis._metadataHeaderContainer.style.display = 'flex';\n\t\tthis._metadataInfoContainer.style.display = 'block';\n\n\t\tthis._metadataHeaderContainer.innerText = '';\n\t\tthis._metadataInfoContainer.innerText = '';\n\n\t\tthis._metadataHeader = this.instantiationService.createInstance(\n\t\t\tPropertyHeader,\n\t\t\tthis.cell,\n\t\t\tthis._metadataHeaderContainer,\n\t\t\tthis.notebookEditor,\n\t\t\t{\n\t\t\t\tupdateInfoRendering: this.updateMetadataRendering.bind(this),\n\t\t\t\tcheckIfModified: (cell) => {\n\t\t\t\t\treturn cell.checkMetadataIfModified();\n\t\t\t\t},\n\t\t\t\tgetFoldingState: (cell) => {\n\t\t\t\t\treturn cell.metadataFoldingState;\n\t\t\t\t},\n\t\t\t\tupdateFoldingState: (cell, state) => {\n\t\t\t\t\tcell.metadataFoldingState = state;\n\t\t\t\t},\n\t\t\t\tunChangedLabel: 'Metadata',\n\t\t\t\tchangedLabel: 'Metadata changed',\n\t\t\t\tprefix: 'metadata',\n\t\t\t\tmenuId: MenuId.NotebookDiffCellMetadataTitle\n\t\t\t}\n\t\t);\n\t\tthis._metadataLocalDisposable.add(this._metadataHeader);\n\t\tthis._metadataHeader.buildHeader();\n\t}\n\n\t_disposeOutput() {\n\t\tthis._hideOutputsRaw();\n\t\tthis._hideOutputsRenderer();\n\t\tthis._hideOutputsEmptyView();\n\n\t\tthis.cell.rawOutputHeight = 0;\n\t\tthis.cell.outputMetadataHeight = 0;\n\t\tthis.cell.outputStatusHeight = 0;\n\t\tthis.templateData.outputHeaderContainer.style.display = 'none';\n\t\tthis.templateData.outputInfoContainer.style.display = 'none';\n\t\tthis._outputViewContainer = undefined;\n\t}\n\n\t_buildOutput() {\n\t\tthis.templateData.outputHeaderContainer.style.display = 'flex';\n\t\tthis.templateData.outputInfoContainer.style.display = 'block';\n\n\t\tthis._outputHeaderContainer = this.templateData.outputHeaderContainer;\n\t\tthis._outputInfoContainer = this.templateData.outputInfoContainer;\n\t\tthis._outputHeaderContainer.innerText = '';\n\t\tthis._outputInfoContainer.innerText = '';\n\n\t\tif (this.cell.checkIfOutputsModified()) {\n\t\t\tthis._outputInfoContainer.classList.add('modified');\n\t\t} else {\n\t\t\tthis._outputInfoContainer.classList.remove('modified');\n\t\t}\n\n\t\tthis._outputHeader = this.instantiationService.createInstance(\n\t\t\tPropertyHeader,\n\t\t\tthis.cell,\n\t\t\tthis._outputHeaderContainer,\n\t\t\tthis.notebookEditor,\n\t\t\t{\n\t\t\t\tupdateInfoRendering: this.updateOutputRendering.bind(this),\n\t\t\t\tcheckIfModified: (cell) => {\n\t\t\t\t\treturn cell.checkIfOutputsModified();\n\t\t\t\t},\n\t\t\t\tgetFoldingState: (cell) => {\n\t\t\t\t\treturn cell.outputFoldingState;\n\t\t\t\t},\n\t\t\t\tupdateFoldingState: (cell, state) => {\n\t\t\t\t\tcell.outputFoldingState = state;\n\t\t\t\t},\n\t\t\t\tunChangedLabel: 'Outputs',\n\t\t\t\tchangedLabel: 'Outputs changed',\n\t\t\t\tprefix: 'output',\n\t\t\t\tmenuId: MenuId.NotebookDiffCellOutputsTitle\n\t\t\t}\n\t\t);\n\t\tthis._outputLocalDisposable.add(this._outputHeader);\n\t\tthis._outputHeader.buildHeader();\n\t}\n\n\t_buildOutputRendererContainer() {\n\t\tif (!this._outputViewContainer) {\n\t\t\tthis._outputViewContainer = DOM.append(this._outputInfoContainer, DOM.$('.output-view-container'));\n\t\t\tthis._outputEmptyElement = DOM.append(this._outputViewContainer, DOM.$('.output-empty-view'));\n\t\t\tthis._outputEmptyElement.innerText = 'No outputs to render';\n\n\t\t\tif (!this.cell.checkIfOutputsModified() && this.cell.modified.outputs.length === 0) {\n\t\t\t\tthis._outputEmptyElement.style.display = 'block';\n\t\t\t} else {\n\t\t\t\tthis._outputEmptyElement.style.display = 'none';\n\t\t\t}\n\n\t\t\tthis.cell.layoutChange();\n\n\t\t\tthis._register(this.cell.modified.textModel.onDidChangeOutputs(() => {\n\t\t\t\t// currently we only allow outputs change to the modified cell\n\t\t\t\tif (!this.cell.checkIfOutputsModified() && this.cell.modified.outputs.length === 0) {\n\t\t\t\t\tthis._outputEmptyElement!.style.display = 'block';\n\t\t\t\t} else {\n\t\t\t\t\tthis._outputEmptyElement!.style.display = 'none';\n\t\t\t\t}\n\t\t\t\tthis._decorate();\n\t\t\t}));\n\n\t\t\tthis._outputLeftContainer = DOM.append(this._outputViewContainer, DOM.$('.output-view-container-left'));\n\t\t\tthis._outputRightContainer = DOM.append(this._outputViewContainer, DOM.$('.output-view-container-right'));\n\t\t\tthis._outputMetadataContainer = DOM.append(this._outputViewContainer, DOM.$('.output-view-container-metadata'));\n\n\t\t\tconst outputModified = this.cell.checkIfOutputsModified();\n\t\t\tconst outputMetadataChangeOnly = outputModified\n\t\t\t\t&& outputModified.kind === OutputComparison.Metadata\n\t\t\t\t&& this.cell.original.outputs.length === 1\n\t\t\t\t&& this.cell.modified.outputs.length === 1\n\t\t\t\t&& outputEqual(this.cell.original.outputs[0], this.cell.modified.outputs[0]) === OutputComparison.Metadata;\n\n\t\t\tif (outputModified && !outputMetadataChangeOnly) {\n\t\t\t\tconst originalOutputRenderListener = this.notebookEditor.onDidDynamicOutputRendered(e => {\n\t\t\t\t\tif (e.cell.uri.toString() === this.cell.original.uri.toString() && this.cell.checkIfOutputsModified()) {\n\t\t\t\t\t\tthis.notebookEditor.deltaCellOutputContainerClassNames(DiffSide.Original, this.cell.original.id, ['nb-cellDeleted'], []);\n\t\t\t\t\t\toriginalOutputRenderListener.dispose();\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tconst modifiedOutputRenderListener = this.notebookEditor.onDidDynamicOutputRendered(e => {\n\t\t\t\t\tif (e.cell.uri.toString() === this.cell.modified.uri.toString() && this.cell.checkIfOutputsModified()) {\n\t\t\t\t\t\tthis.notebookEditor.deltaCellOutputContainerClassNames(DiffSide.Modified, this.cell.modified.id, ['nb-cellAdded'], []);\n\t\t\t\t\t\tmodifiedOutputRenderListener.dispose();\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tthis._register(originalOutputRenderListener);\n\t\t\t\tthis._register(modifiedOutputRenderListener);\n\t\t\t}\n\n\t\t\t// We should use the original text model here\n\t\t\tthis._outputLeftView = this.instantiationService.createInstance(OutputContainer, this.notebookEditor, this.notebookEditor.textModel!, this.cell, this.cell.original, DiffSide.Original, this._outputLeftContainer);\n\t\t\tthis._outputLeftView.render();\n\t\t\tthis._register(this._outputLeftView);\n\t\t\tthis._outputRightView = this.instantiationService.createInstance(OutputContainer, this.notebookEditor, this.notebookEditor.textModel!, this.cell, this.cell.modified, DiffSide.Modified, this._outputRightContainer);\n\t\t\tthis._outputRightView.render();\n\t\t\tthis._register(this._outputRightView);\n\n\t\t\tif (outputModified && !outputMetadataChangeOnly) {\n\t\t\t\tthis._decorate();\n\t\t\t}\n\n\t\t\tif (outputMetadataChangeOnly) {\n\n\t\t\t\tthis._outputMetadataContainer.style.top = `${this.cell.layoutInfo.rawOutputHeight}px`;\n\t\t\t\t// single output, metadata change, let's render a diff editor for metadata\n\t\t\t\tthis._outputMetadataEditor = this.instantiationService.createInstance(DiffEditorWidget, this._outputMetadataContainer, {\n\t\t\t\t\t...fixedDiffEditorOptions,\n\t\t\t\t\toverflowWidgetsDomNode: this.notebookEditor.getOverflowContainerDomNode(),\n\t\t\t\t\treadOnly: true,\n\t\t\t\t\tignoreTrimWhitespace: false,\n\t\t\t\t\tautomaticLayout: false,\n\t\t\t\t\tdimension: {\n\t\t\t\t\t\theight: OUTPUT_EDITOR_HEIGHT_MAGIC,\n\t\t\t\t\t\twidth: this.cell.getComputedCellContainerWidth(this.notebookEditor.getLayoutInfo(), false, true)\n\t\t\t\t\t}\n\t\t\t\t}, {\n\t\t\t\t\toriginalEditor: getOptimizedNestedCodeEditorWidgetOptions(),\n\t\t\t\t\tmodifiedEditor: getOptimizedNestedCodeEditorWidgetOptions()\n\t\t\t\t});\n\n\t\t\t\tthis._register(this._outputMetadataEditor);\n\t\t\t\tconst originalOutputMetadataSource = JSON.stringify(this.cell.original.outputs[0].metadata ?? {}, undefined, '\\t');\n\t\t\t\tconst modifiedOutputMetadataSource = JSON.stringify(this.cell.modified.outputs[0].metadata ?? {}, undefined, '\\t');\n\n\t\t\t\tconst mode = this.languageService.createById('json');\n\t\t\t\tconst originalModel = this.modelService.createModel(originalOutputMetadataSource, mode, undefined, true);\n\t\t\t\tconst modifiedModel = this.modelService.createModel(modifiedOutputMetadataSource, mode, undefined, true);\n\n\t\t\t\tthis._outputMetadataEditor.setModel({\n\t\t\t\t\toriginal: originalModel,\n\t\t\t\t\tmodified: modifiedModel\n\t\t\t\t});\n\n\t\t\t\tthis.cell.outputMetadataHeight = this._outputMetadataEditor.getContentHeight();\n\n\t\t\t\tthis._register(this._outputMetadataEditor.onDidContentSizeChange((e) => {\n\t\t\t\t\tthis.cell.outputMetadataHeight = e.contentHeight;\n\t\t\t\t}));\n\t\t\t}\n\t\t}\n\n\t\tthis._outputViewContainer.style.display = 'block';\n\t}\n\n\t_decorate() {\n\t\tif (this.cell.checkIfOutputsModified()) {\n\t\t\tthis.notebookEditor.deltaCellOutputContainerClassNames(DiffSide.Original, this.cell.original.id, ['nb-cellDeleted'], []);\n\t\t\tthis.notebookEditor.deltaCellOutputContainerClassNames(DiffSide.Modified, this.cell.modified.id, ['nb-cellAdded'], []);\n\t\t} else {\n\t\t\tthis.notebookEditor.deltaCellOutputContainerClassNames(DiffSide.Original, this.cell.original.id, [], ['nb-cellDeleted']);\n\t\t\tthis.notebookEditor.deltaCellOutputContainerClassNames(DiffSide.Modified, this.cell.modified.id, [], ['nb-cellAdded']);\n\t\t}\n\t}\n\n\t_showOutputsRenderer() {\n\t\tif (this._outputViewContainer) {\n\t\t\tthis._outputViewContainer.style.display = 'block';\n\n\t\t\tthis._outputLeftView?.showOutputs();\n\t\t\tthis._outputRightView?.showOutputs();\n\t\t\tthis._outputMetadataEditor?.layout({\n\t\t\t\twidth: this._editor?.getViewWidth() || this.cell.getComputedCellContainerWidth(this.notebookEditor.getLayoutInfo(), false, true),\n\t\t\t\theight: this.cell.layoutInfo.outputMetadataHeight\n\t\t\t});\n\n\t\t\tthis._decorate();\n\t\t}\n\t}\n\n\t_hideOutputsRenderer() {\n\t\tif (this._outputViewContainer) {\n\t\t\tthis._outputViewContainer.style.display = 'none';\n\n\t\t\tthis._outputLeftView?.hideOutputs();\n\t\t\tthis._outputRightView?.hideOutputs();\n\t\t}\n\t}\n\n\tupdateSourceEditor(): void {\n\t\tthis._cellHeaderContainer = this.templateData.cellHeaderContainer;\n\t\tthis._cellHeaderContainer.style.display = 'flex';\n\t\tthis._cellHeaderContainer.innerText = '';\n\t\tconst modifiedCell = this.cell.modified;\n\t\tthis._editorContainer = this.templateData.editorContainer;\n\t\tthis._editorContainer.classList.add('diff');\n\n\t\tconst renderSourceEditor = () => {\n\t\t\tif (this.cell.cellFoldingState === PropertyFoldingState.Collapsed) {\n\t\t\t\tthis._editorContainer.style.display = 'none';\n\t\t\t\tthis.cell.editorHeight = 0;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst lineCount = modifiedCell.textModel.textBuffer.getLineCount();\n\t\t\tconst lineHeight = this.notebookEditor.getLayoutInfo().fontInfo.lineHeight || 17;\n\t\t\tconst editorHeight = this.cell.layoutInfo.editorHeight !== 0 ? this.cell.layoutInfo.editorHeight : this.cell.computeInputEditorHeight(lineHeight);\n\n\t\t\tthis._editorContainer.style.height = `${editorHeight}px`;\n\t\t\tthis._editorContainer.style.display = 'block';\n\n\t\t\tif (this._editor) {\n\t\t\t\tconst contentHeight = this._editor.getContentHeight();\n\t\t\t\tif (contentHeight >= 0) {\n\t\t\t\t\tthis.cell.editorHeight = contentHeight;\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis._editor = this.templateData.sourceEditor;\n\t\t\t// If there is only 1 line, then ensure we have the necessary padding to display the button for whitespaces.\n\t\t\t// E.g. assume we have a cell with 1 line and we add some whitespace,\n\t\t\t// Then diff editor displays the button `Show Whitespace Differences`, however with 12 paddings on the top, the\n\t\t\t// button can get cut off.\n\t\t\tconst options: IDiffEditorOptions = {\n\t\t\t\tpadding: getEditorPadding(lineCount)\n\t\t\t};\n\t\t\tif (this.cell.unchangedRegionsService.options.enabled) {\n\t\t\t\toptions.hideUnchangedRegions = this.cell.unchangedRegionsService.options;\n\t\t\t}\n\t\t\tthis._editor.updateOptions(options);\n\t\t\tthis._register(this.cell.unchangedRegionsService.options.onDidChangeEnablement(() => {\n\t\t\t\toptions.hideUnchangedRegions = this.cell.unchangedRegionsService.options;\n\t\t\t\tthis._editor?.updateOptions(options);\n\t\t\t}));\n\t\t\tthis._editor.layout({\n\t\t\t\twidth: this.notebookEditor.getLayoutInfo().width - 2 * DIFF_CELL_MARGIN,\n\t\t\t\theight: editorHeight\n\t\t\t});\n\t\t\tthis._register(this._editor.onDidContentSizeChange((e) => {\n\t\t\t\tif (this.cell.cellFoldingState === PropertyFoldingState.Expanded && e.contentHeightChanged && this.cell.layoutInfo.editorHeight !== e.contentHeight) {\n\t\t\t\t\tthis.cell.editorHeight = e.contentHeight;\n\t\t\t\t}\n\t\t\t}));\n\t\t\tthis._initializeSourceDiffEditor();\n\t\t};\n\n\t\tthis._cellHeader = this._register(this.instantiationService.createInstance(\n\t\t\tPropertyHeader,\n\t\t\tthis.cell,\n\t\t\tthis._cellHeaderContainer,\n\t\t\tthis.notebookEditor,\n\t\t\t{\n\t\t\t\tupdateInfoRendering: () => renderSourceEditor(),\n\t\t\t\tcheckIfModified: (cell) => {\n\t\t\t\t\treturn cell.modified?.textModel.getTextBufferHash() !== cell.original?.textModel.getTextBufferHash() ? { reason: undefined } : false;\n\t\t\t\t},\n\t\t\t\tgetFoldingState: (cell) => cell.cellFoldingState,\n\t\t\t\tupdateFoldingState: (cell, state) => cell.cellFoldingState = state,\n\t\t\t\tunChangedLabel: 'Input',\n\t\t\t\tchangedLabel: 'Input changed',\n\t\t\t\tprefix: 'input',\n\t\t\t\tmenuId: MenuId.NotebookDiffCellInputTitle\n\t\t\t}\n\t\t));\n\t\tthis._cellHeader.buildHeader();\n\t\trenderSourceEditor();\n\n\t\tconst scopedContextKeyService = this.contextKeyService.createScoped(this.templateData.inputToolbarContainer);\n\t\tthis._register(scopedContextKeyService);\n\t\tconst inputChanged = NOTEBOOK_DIFF_CELL_INPUT.bindTo(scopedContextKeyService);\n\t\tinputChanged.set(this.cell.modified.textModel.getTextBufferHash() !== this.cell.original.textModel.getTextBufferHash());\n\n\t\tconst ignoreWhitespace = NOTEBOOK_DIFF_CELL_IGNORE_WHITESPACE.bindTo(scopedContextKeyService);\n\t\tconst ignore = this.textConfigurationService.getValue<boolean>(this.cell.modified.uri, 'diffEditor.ignoreTrimWhitespace');\n\t\tignoreWhitespace.set(ignore);\n\n\t\tthis._toolbar = this.templateData.toolbar;\n\n\t\tthis._toolbar.context = {\n\t\t\tcell: this.cell\n\t\t};\n\n\t\tconst refreshToolbar = () => {\n\t\t\tconst ignore = this.textConfigurationService.getValue<boolean>(this.cell.modified.uri, 'diffEditor.ignoreTrimWhitespace');\n\t\t\tignoreWhitespace.set(ignore);\n\t\t\tconst hasChanges = this.cell.modified.textModel.getTextBufferHash() !== this.cell.original.textModel.getTextBufferHash();\n\t\t\tinputChanged.set(hasChanges);\n\n\t\t\tif (hasChanges) {\n\t\t\t\tconst actions: IAction[] = [];\n\t\t\t\tconst menu = this.menuService.getMenuActions(MenuId.NotebookDiffCellInputTitle, scopedContextKeyService, { shouldForwardArgs: true });\n\t\t\t\tcreateAndFillInActionBarActions(menu, actions);\n\t\t\t\tthis._toolbar.setActions(actions);\n\t\t\t} else {\n\t\t\t\tthis._toolbar.setActions([]);\n\t\t\t}\n\t\t};\n\n\t\tthis._register(this.cell.modified.textModel.onDidChangeContent(() => refreshToolbar()));\n\t\tthis._register(this.textConfigurationService.onDidChangeConfiguration(e => {\n\t\t\tif (e.affectsConfiguration(this.cell.modified.uri, 'diffEditor') &&\n\t\t\t\te.affectedKeys.has('diffEditor.ignoreTrimWhitespace')) {\n\t\t\t\trefreshToolbar();\n\t\t\t}\n\t\t}));\n\t\trefreshToolbar();\n\t}\n\n\tprivate async _initializeSourceDiffEditor() {\n\t\tconst [originalRef, modifiedRef] = await Promise.all([\n\t\t\tthis.textModelService.createModelReference(this.cell.original.uri),\n\t\t\tthis.textModelService.createModelReference(this.cell.modified.uri)]);\n\t\tthis._register(originalRef);\n\t\tthis._register(modifiedRef);\n\n\t\tif (this._isDisposed) {\n\t\t\toriginalRef.dispose();\n\t\t\tmodifiedRef.dispose();\n\t\t\treturn;\n\t\t}\n\n\t\tconst vm = this._register(this._editor!.createViewModel({\n\t\t\toriginal: originalRef.object.textEditorModel,\n\t\t\tmodified: modifiedRef.object.textEditorModel,\n\t\t}));\n\n\t\t// Reduces flicker (compute this before setting the model)\n\t\t// Else when the model is set, the height of the editor will be x, after diff is computed, then height will be y.\n\t\t// & that results in flicker.\n\t\tawait vm.waitForDiff();\n\t\tthis._editor!.setModel(vm);\n\n\t\tconst handleViewStateChange = () => {\n\t\t\tthis._editorViewStateChanged = true;\n\t\t};\n\n\t\tconst handleScrollChange = (e: editorCommon.IScrollEvent) => {\n\t\t\tif (e.scrollTopChanged || e.scrollLeftChanged) {\n\t\t\t\tthis._editorViewStateChanged = true;\n\t\t\t}\n\t\t};\n\n\t\tthis.updateEditorOptionsForWhitespace();\n\t\tthis._register(this._editor!.getOriginalEditor().onDidChangeCursorSelection(handleViewStateChange));\n\t\tthis._register(this._editor!.getOriginalEditor().onDidScrollChange(handleScrollChange));\n\t\tthis._register(this._editor!.getModifiedEditor().onDidChangeCursorSelection(handleViewStateChange));\n\t\tthis._register(this._editor!.getModifiedEditor().onDidScrollChange(handleScrollChange));\n\n\t\tconst editorViewState = this.cell.getSourceEditorViewState() as editorCommon.IDiffEditorViewState | null;\n\t\tif (editorViewState) {\n\t\t\tthis._editor!.restoreViewState(editorViewState);\n\t\t}\n\n\t\tconst contentHeight = this._editor!.getContentHeight();\n\t\tthis.cell.editorHeight = contentHeight;\n\t}\n\tprivate updateEditorOptionsForWhitespace() {\n\t\tconst editor = this._editor;\n\t\tif (!editor) {\n\t\t\treturn;\n\t\t}\n\t\tconst uri = editor.getModel()?.modified.uri || editor.getModel()?.original.uri;\n\t\tif (!uri) {\n\t\t\treturn;\n\t\t}\n\t\tconst ignoreTrimWhitespace = this.textConfigurationService.getValue<boolean>(uri, 'diffEditor.ignoreTrimWhitespace');\n\t\teditor.updateOptions({ ignoreTrimWhitespace });\n\n\t\tthis._register(this.textConfigurationService.onDidChangeConfiguration(e => {\n\t\t\tif (e.affectsConfiguration(uri, 'diffEditor') &&\n\t\t\t\te.affectedKeys.has('diffEditor.ignoreTrimWhitespace')) {\n\t\t\t\tconst ignoreTrimWhitespace = this.textConfigurationService.getValue<boolean>(uri, 'diffEditor.ignoreTrimWhitespace');\n\t\t\t\teditor.updateOptions({ ignoreTrimWhitespace });\n\t\t\t}\n\t\t}));\n\t}\n\tlayout(state: IDiffElementLayoutState) {\n\t\tDOM.scheduleAtNextAnimationFrame(DOM.getWindow(this._diffEditorContainer), () => {\n\t\t\tif (state.editorHeight && this._editor) {\n\t\t\t\tthis._editorContainer.style.height = `${this.cell.layoutInfo.editorHeight}px`;\n\t\t\t\tthis._editor.layout({\n\t\t\t\t\twidth: this._editor!.getViewWidth(),\n\t\t\t\t\theight: this.cell.layoutInfo.editorHeight\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (state.outerWidth && this._editor) {\n\t\t\t\tthis._editorContainer.style.height = `${this.cell.layoutInfo.editorHeight}px`;\n\t\t\t\tthis._editor.layout();\n\t\t\t}\n\n\t\t\tif (state.metadataHeight || state.outerWidth) {\n\t\t\t\tif (this._metadataEditorContainer) {\n\t\t\t\t\tthis._metadataEditorContainer.style.height = `${this.cell.layoutInfo.metadataHeight}px`;\n\t\t\t\t\tthis._metadataEditor?.layout({\n\t\t\t\t\t\twidth: this._editor?.getViewWidth() || this.cell.getComputedCellContainerWidth(this.notebookEditor.getLayoutInfo(), false, true),\n\t\t\t\t\t\theight: this.cell.layoutInfo.metadataHeight\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (state.outputTotalHeight || state.outerWidth) {\n\t\t\t\tif (this._outputEditorContainer) {\n\t\t\t\t\tthis._outputEditorContainer.style.height = `${this.cell.layoutInfo.outputTotalHeight}px`;\n\t\t\t\t\tthis._outputEditor?.layout({\n\t\t\t\t\t\twidth: this._editor?.getViewWidth() || this.cell.getComputedCellContainerWidth(this.notebookEditor.getLayoutInfo(), false, true),\n\t\t\t\t\t\theight: this.cell.layoutInfo.outputTotalHeight\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tif (this._outputMetadataContainer) {\n\t\t\t\t\tthis._outputMetadataContainer.style.height = `${this.cell.layoutInfo.outputMetadataHeight}px`;\n\t\t\t\t\tthis._outputMetadataContainer.style.top = `${this.cell.layoutInfo.outputTotalHeight - this.cell.layoutInfo.outputMetadataHeight}px`;\n\t\t\t\t\tthis._outputMetadataEditor?.layout({\n\t\t\t\t\t\twidth: this._editor?.getViewWidth() || this.cell.getComputedCellContainerWidth(this.notebookEditor.getLayoutInfo(), false, true),\n\t\t\t\t\t\theight: this.cell.layoutInfo.outputMetadataHeight\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.layoutNotebookCell();\n\t\t});\n\t}\n\n\toverride dispose() {\n\t\t// The editor isn't disposed yet, it can be re-used.\n\t\t// However the model can be disposed before the editor & that causes issues.\n\t\tif (this._editor) {\n\t\t\tthis._editor.setModel(null);\n\t\t}\n\n\t\tif (this._editor && this._editorViewStateChanged) {\n\t\t\tthis.cell.saveSpirceEditorViewState(this._editor.saveViewState());\n\t\t}\n\n\t\tsuper.dispose();\n\t}\n}\n\n\nexport class CollapsedCellOverlayWidget extends Disposable implements IDiffCellMarginOverlay {\n\tprivate readonly _nodes = DOM.h('div.diff-hidden-cells', [\n\t\tDOM.h('div.center@content', { style: { display: 'flex' } }, [\n\t\t\tDOM.$('a', {\n\t\t\t\ttitle: localize('showUnchangedCells', 'Show Unchanged Cells'),\n\t\t\t\trole: 'button',\n\t\t\t\tonclick: () => { this._action.fire(); }\n\t\t\t},\n\t\t\t\t...renderLabelWithIcons('$(unfold)'))]\n\t\t),\n\t]);\n\n\tprivate readonly _action = this._register(new Emitter<void>());\n\tpublic readonly onAction = this._action.event;\n\tconstructor(\n\t\tprivate readonly container: HTMLElement\n\t) {\n\t\tsuper();\n\n\t\tthis._nodes.root.style.display = 'none';\n\t\tcontainer.appendChild(this._nodes.root);\n\t}\n\n\tpublic show() {\n\t\tthis._nodes.root.style.display = 'block';\n\t}\n\n\tpublic hide() {\n\t\tthis._nodes.root.style.display = 'none';\n\t}\n\n\tpublic override dispose() {\n\t\tthis.hide();\n\t\tthis.container.removeChild(this._nodes.root);\n\t\tDOM.reset(this._nodes.root);\n\t\tsuper.dispose();\n\t}\n}\n\nexport class UnchangedCellOverlayWidget extends Disposable implements IDiffCellMarginOverlay {\n\tprivate readonly _nodes = DOM.h('div.diff-hidden-cells', [\n\t\tDOM.h('div.center@content', { style: { display: 'flex' } }, [\n\t\t\tDOM.$('a', {\n\t\t\t\ttitle: localize('hideUnchangedCells', 'Hide Unchanged Cells'),\n\t\t\t\trole: 'button',\n\t\t\t\tonclick: () => { this._action.fire(); }\n\t\t\t},\n\t\t\t\t...renderLabelWithIcons('$(fold)')\n\t\t\t),\n\t\t]\n\t\t),\n\t]);\n\n\tprivate readonly _action = this._register(new Emitter<void>());\n\tpublic readonly onAction = this._action.event;\n\tconstructor(\n\t\tprivate readonly container: HTMLElement\n\t) {\n\t\tsuper();\n\n\t\tthis._nodes.root.style.display = 'none';\n\t\tcontainer.appendChild(this._nodes.root);\n\t}\n\n\tpublic show() {\n\t\tthis._nodes.root.style.display = 'block';\n\t}\n\n\tpublic hide() {\n\t\tthis._nodes.root.style.display = 'none';\n\t}\n\tpublic override dispose() {\n\t\tthis.hide();\n\t\tthis.container.removeChild(this._nodes.root);\n\t\tDOM.reset(this._nodes.root);\n\t\tsuper.dispose();\n\t}\n}\n"],
  "mappings": ";;;;;;;;;;;;AAKA,YAAY,SAAS;AACrB,SAAS,YAAY,uBAAuB;AAC5C,SAAS,eAAe;AACxB,SAAS,6BAA6B;AACtC,SAAS,8BAA8B,wBAAwB,kBAAkB,aAAa,4BAA4B,sBAAsB,gCAAgC,gCAAgC,uCAAuC;AACvP,SAAS,kCAAkC,kCAAkC,UAAU,kBAAkB,yBAAyB,0BAA0B,6BAA6B,sCAAsC,mCAAmC,wBAAwB,4CAA4C;AACtU,SAAS,kBAAkB,gCAAgC;AAC3D,SAAS,qBAAqB;AAC9B,SAAS,wBAAwB;AACjC,SAAS,cAAc,SAAS,4BAA4B;AAC5D,SAAS,eAAe;AACxB,SAAS,2BAA2B;AACpC,SAAS,OAAO,cAAc,QAAQ,sBAAsB;AAC5D,SAAS,0BAA0B;AACnC,SAAS,4BAA4B;AACrC,SAAS,eAAe;AACxB,SAAS,uCAAuC;AAChD,SAAS,aAAa,0BAA0B;AAChD,SAAS,6BAA6B;AACtC,SAAS,eAAe,oBAAoB;AAC5C,SAAS,uBAAuB;AAChC,SAAS,gCAAgC;AACzC,SAAS,6BAA6B;AACtC,SAAS,0BAA0B;AACnC,SAAS,yBAAyB;AAClC,SAAS,qBAAqB;AAC9B,SAAS,wCAAwC;AACjD,SAAS,+BAA+B;AACxC,SAAS,YAAY,4BAA4B;AACjD,YAAY,kBAAkB;AAC9B,SAAS,yBAAyB;AAClC,SAAS,6BAA6B;AACtC,SAAS,qBAAqB;AAC9B,SAAS,wBAAwB;AACjC,SAAS,yBAAyB;AAClC,SAAS,wBAAwB,oBAAoB,wBAAwB;AAC7E,SAAS,uCAAuC;AAChD,SAAS,6BAA6B;AACtC,SAAS,wBAAwB;AACjC,SAAS,uBAAuB;AAChC,SAAS,+BAA+B;AACxC,SAAS,gBAAgB;AACzB,SAAS,eAAe;AACxB,SAAS,yCAAyC;AAClD,SAAS,gCAAgC;AACzC,SAAS,0BAA0B;AAE5B,SAAS,4CAAsE;AACrF,SAAO;AAAA,IACN,gBAAgB;AAAA,IAChB,eAAe,yBAAyB,2BAA2B;AAAA,MAClE,cAAc;AAAA,MACd;AAAA,MACA,sBAAsB;AAAA,MACtB,kBAAkB;AAAA,MAClB,mBAAmB;AAAA,MACnB,wBAAwB;AAAA,IACzB,CAAC;AAAA,EACF;AACD;AAZgB;AAcT,MAAM,mCAAmC,WAAW;AAAA,EAlE3D,OAkE2D;AAAA;AAAA;AAAA,EAC1D,YACC,aACA,cACC;AACD,UAAM;AACN,iBAAa,KAAK,UAAU,OAAO,QAAQ,SAAS,MAAM;AAC1D,UAAM,OAAQ,YAAY,YAAY,WAAW,IAChD,SAAS,cAAc,mBAAmB,YAAY,YAAY,MAAM,IACxE,SAAS,eAAe,oBAAoB,YAAY,YAAY,MAAM;AAC3E,iBAAa,YAAY,YAAY;AAErC,SAAK,UAAU,IAAI,sBAAsB,aAAa,aAAa,YAAY,CAAC,MAAkB;AACjG,UAAI,EAAE,WAAW,GAAG;AACnB;AAAA,MACD;AACA,QAAE,eAAe;AACjB,kBAAY,gBAAgB;AAAA,IAC7B,CAAC,CAAC;AACF,SAAK,UAAU,aAAa,cAAc,SAAS,MAAM,YAAY,gBAAgB,CAAC,CAAC;AACvF,iBAAa,cAAc,KAAK;AAAA,EACjC;AACD;AAEA,IAAM,iBAAN,cAA6B,WAAW;AAAA,EASvC,YACU,MACA,yBACA,gBACA,UAU6B,oBACD,mBACH,gBACK,qBACR,aACM,mBACL,cACI,kBACI,sBACvC;AACD,UAAM;AAvBG;AACA;AACA;AACA;AAU6B;AACD;AACH;AACK;AACR;AACM;AACL;AACI;AACI;AAAA,EAGzC;AAAA,EA5HD,OA0FwC;AAAA;AAAA;AAAA,EAC7B;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EA6BV,cAAoB;AACnB,SAAK,oBAAoB,IAAI,OAAO,KAAK,yBAAyB,IAAI,EAAE,6BAA6B,CAAC;AACtG,SAAK,kBAAkB,UAAU,IAAI,KAAK,SAAS,MAAM;AACzD,UAAM,iBAAiB,IAAI,OAAO,KAAK,yBAAyB,IAAI,EAAE,qBAAqB,CAAC;AAC5F,SAAK,cAAc,IAAI,OAAO,gBAAgB,IAAI,EAAE,MAAM,CAAC;AAC3D,SAAK,eAAe,IAAI,OAAO,gBAAgB,IAAI,EAAE,2BAA2B,CAAC;AAEjF,UAAM,uBAAuB,IAAI,OAAO,KAAK,yBAAyB,IAAI,EAAE,sBAAsB,CAAC;AACnG,SAAK,WAAW,KAAK,UAAU,IAAI,iBAAiB,sBAAsB;AAAA,MACzE,wBAAwB,wBAAC,QAAQ,YAAY;AAC5C,YAAI,kBAAkB,gBAAgB;AACrC,gBAAM,OAAO,IAAI,sBAAsB,QAAQ,EAAE,eAAe,QAAQ,cAAc,GAAG,KAAK,mBAAmB,KAAK,qBAAqB,KAAK,mBAAmB,KAAK,cAAc,KAAK,oBAAoB,KAAK,oBAAoB;AACxO,iBAAO;AAAA,QACR;AAEA,eAAO;AAAA,MACR,GAPwB;AAAA,IAQzB,GAAG,KAAK,aAAa,KAAK,mBAAmB,KAAK,oBAAoB,KAAK,mBAAmB,KAAK,gBAAgB,KAAK,gBAAgB,CAAC;AACzI,SAAK,SAAS,UAAU;AAAA,MACvB,MAAM,KAAK;AAAA,IACZ;AAEA,UAAM,0BAA0B,KAAK,kBAAkB,aAAa,oBAAoB;AACxF,SAAK,UAAU,uBAAuB;AACtC,SAAK,mBAAmB,4BAA4B,OAAO,uBAAuB;AAClF,SAAK,oBAAoB,qCAAqC,OAAO,uBAAuB;AAE5F,SAAK,QAAQ,KAAK,UAAU,KAAK,YAAY,WAAW,KAAK,SAAS,QAAQ,uBAAuB,CAAC;AACtG,SAAK,UAAU,KAAK,MAAM,YAAY,MAAM,KAAK,WAAW,CAAC,CAAC;AAE9D,SAAK,UAAU,KAAK,eAAe,UAAU,OAAK;AACjD,UAAI,CAAC,EAAE,MAAM,UAAU,EAAE,WAAW,KAAK,MAAM;AAC9C;AAAA,MACD;AAEA,YAAM,SAAS,EAAE,MAAM;AAEvB,UACC,WAAW,KAAK,2BAChB,WAAW,KAAK,qBAAqB,KAAK,kBAAkB,SAAS,MAAM,KAC3E,WAAW,kBAAkB,eAAe,SAAS,MAAM,GAC1D;AACD,cAAM,kBAAkB,KAAK,SAAS,gBAAgB,KAAK,IAAI;AAC/D,aAAK,SAAS,mBAAmB,KAAK,MAAM,oBAAoB,qBAAqB,WAAW,qBAAqB,YAAY,qBAAqB,QAAQ;AAC9J,aAAK,mBAAmB;AACxB,aAAK,SAAS,oBAAoB,KAAK,KAAK,YAAY;AAAA,MACzD;AAAA,IACD,CAAC,CAAC;AAEF,SAAK,QAAQ;AACb,SAAK,SAAS,oBAAoB,KAAK,KAAK,YAAY;AAAA,EACzD;AAAA,EACA,UAAU;AACT,SAAK,WAAW;AAChB,SAAK,mBAAmB;AAExB,UAAM,kBAAkB,KAAK,SAAS,gBAAgB,KAAK,IAAI;AAC/D,QAAI,KAAK,kBAAkB;AAC1B,WAAK,iBAAiB,IAAI,CAAC,CAAC,eAAe;AAAA,IAC5C;AACA,QAAI,iBAAiB;AACpB,WAAK,YAAY,cAAc,KAAK,SAAS;AAC7C,WAAK,YAAY,MAAM,aAAa;AACpC,UAAI,gBAAgB,QAAQ;AAC3B,aAAK,aAAa,cAAc,gBAAgB;AAAA,MACjD;AACA,WAAK,wBAAwB,UAAU,IAAI,UAAU;AAAA,IACtD,OAAO;AACN,WAAK,YAAY,cAAc,KAAK,SAAS;AAC7C,WAAK,YAAY,MAAM,aAAa;AACpC,WAAK,aAAa,cAAc;AAChC,WAAK,wBAAwB,UAAU,OAAO,UAAU;AAAA,IACzD;AAAA,EACD;AAAA,EAEQ,aAAa;AACpB,UAAM,kBAAkB,KAAK,SAAS,gBAAgB,KAAK,IAAI;AAC/D,QAAI,iBAAiB;AACpB,YAAM,UAAqB,CAAC;AAC5B,sCAAgC,KAAK,OAAO,EAAE,mBAAmB,KAAK,GAAG,OAAO;AAChF,WAAK,SAAS,WAAW,OAAO;AAAA,IACjC,OAAO;AACN,WAAK,SAAS,WAAW,CAAC,CAAC;AAAA,IAC5B;AAAA,EACD;AAAA,EAEQ,qBAAqB;AAC5B,QAAI,KAAK,SAAS,gBAAgB,KAAK,IAAI,MAAM,qBAAqB,WAAW;AAChF,UAAI,MAAM,KAAK,mBAAmB,WAAW,aAAa,CAAC;AAC3D,WAAK,mBAAmB,IAAI,KAAK;AAAA,IAClC,OAAO;AACN,UAAI,MAAM,KAAK,mBAAmB,WAAW,YAAY,CAAC;AAC1D,WAAK,mBAAmB,IAAI,IAAI;AAAA,IACjC;AAAA,EAED;AACD;AApIM,iBAAN;AAAA,EAuBG;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,GA/BG;AA8IN,MAAe,gCAAgC,WAAW;AAAA,EAkCzD,YACU,gBACA,MACA,cACA,OACU,sBACA,iBACA,cACA,kBACA,oBACA,mBACA,qBACA,aACA,mBACA,sBACA,0BAClB;AACD,UAAM;AAhBG;AACA;AACA;AACA;AACU;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAInB,SAAK,cAAc;AACnB,SAAK,8BAA8B,KAAK,UAAU,IAAI,gBAAgB,CAAC;AACvE,SAAK,4BAA4B,KAAK,UAAU,IAAI,gBAAgB,CAAC;AACrE,SAAK,UAAU,KAAK,kBAAkB,OAAK;AAC1C,WAAK,OAAO,CAAC;AAAA,IACd,CAAC,CAAC;AACF,SAAK,UAAU,KAAK,kBAAkB,OAAK,KAAK,cAAc,CAAC,CAAC;AAChE,SAAK,KAAK;AACV,SAAK,UAAU;AAEf,SAAK,UAAU,KAAK,iBAAiB,MAAM;AAC1C,WAAK,sBAAsB,KAAK,KAAK,YAAY;AAAA,IAClD,CAAC,CAAC;AAAA,EACH;AAAA,EA1SD,OAwO0D;AAAA;AAAA;AAAA,EACtC,2BAA2B,KAAK,UAAU,IAAI,gBAAgB,CAAC;AAAA,EAC/D,yBAAyB,KAAK,UAAU,IAAI,gBAAgB,CAAC;AAAA,EACtE,kBAA2B;AAAA,EAC3B,iBAA0B;AAAA,EAC1B;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACS;AAAA,EACT;AAAA,EAEA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACS;AAAA,EACT;AAAA,EACA;AAAA,EAEA;AAAA,EACA;AAAA,EACA;AAAA,EA2CV,YAAkB;AACjB,UAAM,OAAO,KAAK,aAAa;AAC/B,SAAK,uBAAuB,KAAK,aAAa;AAC9C,SAAK,UAAU,OAAO,QAAQ,SAAS,MAAM;AAC7C,YAAQ,KAAK,OAAO;AAAA,MACnB,KAAK;AACJ,aAAK,UAAU,IAAI,MAAM;AACzB;AAAA,MACD,KAAK;AACJ,aAAK,UAAU,IAAI,OAAO;AAC1B;AAAA,MACD;AACC,aAAK,UAAU,IAAI,MAAM;AACzB;AAAA,IACF;AAEA,SAAK,eAAe,KAAK,oBAAoB;AAC7C,SAAK,mBAAmB;AACxB,QAAI,KAAK,KAAK,UAAU;AACvB,WAAK,UAAU,KAAK,KAAK,SAAS,UAAU,mBAAmB,MAAM,KAAK,YAAY,QAAQ,CAAC,CAAC;AAAA,IACjG;AAEA,SAAK,kBAAkB,KAAK,qBAAqB,SAAS,8BAA8B;AACxF,QAAI,KAAK,iBAAiB;AACzB,WAAK,iBAAiB;AAAA,IACvB,OAAO;AACN,WAAK,eAAe;AAAA,IACrB;AAEA,SAAK,iBAAiB,KAAK,qBAAqB,SAAkB,6BAA6B,KAAK,CAAC,CAAE,KAAK,eAAe,WAAW,iBAAiB;AACvJ,QAAI,KAAK,gBAAgB;AACxB,WAAK,eAAe;AAAA,IACrB,OAAO;AACN,WAAK,aAAa;AAAA,IACnB;AAEA,SAAK,UAAU,KAAK,qBAAqB,yBAAyB,OAAK;AACtE,UAAI,uBAAuB;AAC3B,UAAI,qBAAqB;AACzB,UAAI,EAAE,qBAAqB,8BAA8B,GAAG;AAC3D,cAAM,WAAW,KAAK,qBAAqB,SAAkB,8BAA8B;AAE3F,YAAI,aAAa,UAAa,KAAK,oBAAoB,UAAU;AAChE,eAAK,kBAAkB;AAEvB,eAAK,yBAAyB,MAAM;AACpC,cAAI,KAAK,qBAAqB,SAAS,8BAA8B,GAAG;AACvE,iBAAK,iBAAiB;AAAA,UACvB,OAAO;AACN,iBAAK,KAAK,uBAAuB;AACjC,iBAAK,eAAe;AACpB,iBAAK,wBAAwB;AAC7B,mCAAuB;AAAA,UACxB;AAAA,QACD;AAAA,MACD;AAEA,UAAI,EAAE,qBAAqB,6BAA6B,GAAG;AAC1D,cAAM,WAAW,KAAK,qBAAqB,SAAkB,6BAA6B;AAE1F,YAAI,aAAa,UAAa,KAAK,oBAAoB,YAAY,KAAK,eAAe,WAAW,iBAAiB,mBAAmB;AACrI,eAAK,iBAAiB,YAAY,CAAC,CAAE,KAAK,eAAe,WAAW,iBAAiB;AAErF,eAAK,uBAAuB,MAAM;AAClC,cAAI,KAAK,gBAAgB;AACxB,iBAAK,eAAe;AACpB,iBAAK,KAAK,aAAa;AAAA,UACxB,OAAO;AACN,iBAAK,KAAK,qBAAqB;AAC/B,iBAAK,aAAa;AAClB,iCAAqB;AAAA,UACtB;AAAA,QACD;AAAA,MACD;AAEA,UAAI,wBAAwB,oBAAoB;AAC/C,aAAK,OAAO,EAAE,gBAAgB,sBAAsB,mBAAmB,mBAAmB,CAAC;AAAA,MAC5F;AAAA,IACD,CAAC,CAAC;AAAA,EACH;AAAA,EAEA,0BAA0B;AACzB,QAAI,KAAK,KAAK,yBAAyB,qBAAqB,UAAU;AAErE,WAAK,uBAAuB,MAAM,UAAU;AAE5C,UAAI,CAAC,KAAK,4BAA4B,CAAC,KAAK,iBAAiB;AAE5D,aAAK,2BAA2B,IAAI,OAAO,KAAK,wBAAwB,IAAI,EAAE,4BAA4B,CAAC;AAC3G,aAAK,qBAAqB;AAAA,MAC3B,OAAO;AACN,aAAK,KAAK,iBAAiB,KAAK,gBAAgB,iBAAiB;AAAA,MAClE;AAAA,IACD,OAAO;AAEN,WAAK,uBAAuB,MAAM,UAAU;AAE5C,WAAK,KAAK,iBAAiB;AAAA,IAC5B;AAAA,EACD;AAAA,EAEA,sBAAsB,kBAA2B;AAChD,QAAI,KAAK,KAAK,uBAAuB,qBAAqB,UAAU;AACnE,WAAK,qBAAqB,MAAM,UAAU;AAC1C,UAAI,kBAAkB;AACrB,aAAK,gBAAgB;AACrB,aAAK,8BAA8B;AACnC,aAAK,qBAAqB;AAC1B,aAAK,sBAAsB;AAAA,MAC5B,OAAO;AACN,aAAK,qBAAqB;AAC1B,aAAK,yBAAyB;AAC9B,aAAK,gBAAgB;AAAA,MACtB;AAAA,IACD,OAAO;AACN,WAAK,qBAAqB,MAAM,UAAU;AAE1C,WAAK,gBAAgB;AACrB,WAAK,qBAAqB;AAC1B,WAAK,sBAAsB;AAAA,IAC5B;AAAA,EACD;AAAA,EAEQ,2BAA2B;AAClC,QAAI,CAAC,KAAK,wBAAwB;AACjC,WAAK,yBAAyB,IAAI,OAAO,KAAK,sBAAsB,IAAI,EAAE,0BAA0B,CAAC;AACrG,WAAK,mBAAmB;AAAA,IACzB;AAAA,EACD;AAAA,EAEQ,kBAAkB;AACzB,QAAI,KAAK,wBAAwB;AAChC,WAAK,uBAAuB,MAAM,UAAU;AAC5C,WAAK,KAAK,kBAAkB,KAAK,cAAe,iBAAiB;AAAA,IAClE;AAAA,EACD;AAAA,EAEQ,wBAAwB;AAC/B,SAAK,KAAK,aAAa;AAAA,EACxB;AAAA,EAEU,kBAAkB;AAC3B,QAAI,KAAK,wBAAwB;AAChC,WAAK,uBAAuB,MAAM,UAAU;AAC5C,WAAK,KAAK,kBAAkB;AAAA,IAC7B;AAAA,EACD;AAAA,EAEU,wBAAwB;AACjC,SAAK,KAAK,aAAa;AAAA,EACxB;AAAA,EAMQ,+BAA+B,iBAAuC,aAAkB;AAC/F,UAAM,SAAiC,CAAC;AACxC,QAAI;AACH,YAAM,iBAAiB,KAAK,MAAM,WAAW;AAC7C,YAAM,OAAO,oBAAI,IAAI,CAAC,GAAG,OAAO,KAAK,cAAc,CAAC,CAAC;AACrD,iBAAW,OAAO,MAAM;AACvB,gBAAQ,KAAmC;AAAA,UAC1C,KAAK;AAAA,UACL,KAAK;AAEJ,gBAAI,OAAO,eAAe,GAAG,MAAM,WAAW;AAC7C,qBAAO,GAAG,IAAI,eAAe,GAAG;AAAA,YACjC,OAAO;AACN,qBAAO,GAAG,IAAI,gBAAgB,GAAiC;AAAA,YAChE;AACA;AAAA,UAED;AACC,mBAAO,GAAG,IAAI,eAAe,GAAG;AAChC;AAAA,QACF;AAAA,MACD;AAEA,YAAM,QAAQ,KAAK,eAAe,UAAW,MAAM,QAAQ,KAAK,KAAK,SAAU,SAAS;AAExF,UAAI,QAAQ,GAAG;AACd;AAAA,MACD;AAEA,WAAK,eAAe,UAAW,WAAW;AAAA,QACzC,EAAE,UAAU,aAAa,UAAU,OAAO,UAAU,OAAO;AAAA,MAC5D,GAAG,MAAM,QAAW,MAAM,QAAW,QAAW,IAAI;AAAA,IACrD,QAAQ;AAAA,IACR;AAAA,EACD;AAAA,EAEA,MAAc,uBAAuB;AACpC,SAAK,4BAA4B,MAAM;AAEvC,QAAI,KAAK,gBAAgB,gCAAgC;AACxD,WAAK,kBAAkB,KAAK,qBAAqB,eAAe,kBAAkB,KAAK,0BAA2B;AAAA,QACjH,GAAG;AAAA,QACH,wBAAwB,KAAK,eAAe,4BAA4B;AAAA,QACxE,UAAU;AAAA,QACV,kBAAkB;AAAA,QAClB,sBAAsB;AAAA,QACtB,iBAAiB;AAAA,QACjB,WAAW;AAAA,UACV,QAAQ,KAAK,KAAK,WAAW;AAAA,UAC7B,OAAO,KAAK,KAAK,8BAA8B,KAAK,eAAe,cAAc,GAAG,MAAM,IAAI;AAAA,QAC/F;AAAA,MACD,GAAG;AAAA,QACF,gBAAgB,0CAA0C;AAAA,QAC1D,gBAAgB,0CAA0C;AAAA,MAC3D,CAAC;AAED,UAAI,KAAK,KAAK,wBAAwB,QAAQ,SAAS;AACtD,aAAK,gBAAgB,cAAc,EAAE,sBAAsB,KAAK,KAAK,wBAAwB,QAAQ,CAAC;AAAA,MACvG;AACA,WAAK,4BAA4B,IAAI,KAAK,KAAK,wBAAwB,QAAQ,sBAAsB,MAAM;AAC1G,YAAI,KAAK,iBAAiB;AACzB,eAAK,gBAAgB,cAAc,EAAE,sBAAsB,KAAK,KAAK,wBAAwB,QAAQ,CAAC;AAAA,QACvG;AAAA,MACD,CAAC,CAAC;AAGF,WAAK,OAAO,EAAE,gBAAgB,KAAK,CAAC;AACpC,WAAK,4BAA4B,IAAI,KAAK,eAAe;AAEzD,WAAK,0BAA0B,UAAU,IAAI,MAAM;AAEnD,YAAM,CAAC,uBAAuB,qBAAqB,IAAI,MAAM,QAAQ,IAAI;AAAA,QACxE,KAAK,iBAAiB,qBAAqB,QAAQ,wBAAwB,KAAK,KAAK,iBAAiB,KAAK,KAAK,KAAK,SAAS,QAAQ,QAAQ,0BAA0B,CAAC;AAAA,QACzK,KAAK,iBAAiB,qBAAqB,QAAQ,wBAAwB,KAAK,KAAK,iBAAiB,KAAK,KAAK,KAAK,SAAS,QAAQ,QAAQ,0BAA0B,CAAC;AAAA,MAC1K,CAAC;AACD,WAAK,4BAA4B,IAAI,qBAAqB;AAC1D,WAAK,4BAA4B,IAAI,qBAAqB;AAC1D,YAAM,KAAK,KAAK,gBAAgB,gBAAgB;AAAA,QAC/C,UAAU,sBAAsB,OAAO;AAAA,QACvC,UAAU,sBAAsB,OAAO;AAAA,MACxC,CAAC;AAID,YAAM,GAAG,YAAY;AACrB,WAAK,gBAAgB,SAAS,EAAE;AAEhC,WAAK,KAAK,iBAAiB,KAAK,gBAAgB,iBAAiB;AAEjE,WAAK,4BAA4B,IAAI,KAAK,gBAAgB,uBAAuB,CAAC,MAAM;AACvF,YAAI,EAAE,wBAAwB,KAAK,KAAK,yBAAyB,qBAAqB,UAAU;AAC/F,eAAK,KAAK,iBAAiB,EAAE;AAAA,QAC9B;AAAA,MACD,CAAC,CAAC;AAEF,UAAI,4BAA4B;AAEhC,WAAK,4BAA4B,IAAI,sBAAsB,OAAO,gBAAgB,mBAAmB,MAAM;AAC1G,oCAA4B;AAC5B,cAAM,QAAQ,sBAAsB,OAAO,gBAAgB,SAAS;AACpE,aAAK,+BAA+B,KAAK,KAAK,SAAU,UAAU,KAAK;AACvE,aAAK,gBAAgB,QAAQ;AAC7B,oCAA4B;AAAA,MAC7B,CAAC,CAAC;AAEF,WAAK,4BAA4B,IAAI,KAAK,KAAK,SAAS,UAAU,oBAAoB,MAAM;AAC3F,YAAI,2BAA2B;AAC9B;AAAA,QACD;AAEA,cAAM,yBAAyB,yBAAyB,KAAK,eAAe,WAAW,iBAAiB,uBAAuB,KAAK,KAAK,UAAU,YAAY,CAAC,GAAG,KAAK,KAAK,UAAU,QAAQ;AAC/L,8BAAsB,OAAO,gBAAgB,SAAS,sBAAsB;AAAA,MAC7E,CAAC,CAAC;AAEF;AAAA,IACD,OAAO;AACN,WAAK,kBAAkB,KAAK,qBAAqB,eAAe,kBAAkB,KAAK,0BAA2B;AAAA,QACjH,GAAG;AAAA,QACH,WAAW;AAAA,UACV,OAAO,KAAK,KAAK,8BAA8B,KAAK,eAAe,cAAc,GAAG,OAAO,IAAI;AAAA,UAC/F,QAAQ,KAAK,KAAK,WAAW;AAAA,QAC9B;AAAA,QACA,wBAAwB,KAAK,eAAe,4BAA4B;AAAA,QACxE,UAAU;AAAA,MACX,GAAG,CAAC,CAAC;AACL,WAAK,OAAO,EAAE,gBAAgB,KAAK,CAAC;AACpC,WAAK,4BAA4B,IAAI,KAAK,eAAe;AAEzD,YAAM,OAAO,KAAK,gBAAgB,WAAW,OAAO;AACpD,YAAM,yBAAyB;AAAA,QAAyB,KAAK,eAAe,WAAW,iBAAiB;AAAA,QACvG,KAAK,KAAK,SAAS,WAChB,KAAK,KAAK,SAAU,YAAY,CAAC,IACjC,KAAK,KAAK,SAAU,YAAY,CAAC;AAAA,MAAC;AACtC,YAAM,MAAM,KAAK,KAAK,SAAS,WAC5B,KAAK,KAAK,SAAU,MACpB,KAAK,KAAK,SAAU;AACvB,YAAM,SAAS,KAAK,KAAK,SAAS,WAC/B,KAAK,KAAK,SAAU,SACpB,KAAK,KAAK,SAAU;AAEvB,YAAM,WAAW,QAAQ,wBAAwB,KAAK,QAAQ,QAAQ,0BAA0B;AAChG,YAAM,gBAAgB,KAAK,aAAa,YAAY,wBAAwB,MAAM,UAAU,KAAK;AACjG,WAAK,gBAAgB,SAAS,aAAa;AAC3C,WAAK,4BAA4B,IAAI,aAAa;AAElD,WAAK,KAAK,iBAAiB,KAAK,gBAAgB,iBAAiB;AAEjE,WAAK,4BAA4B,IAAI,KAAK,gBAAgB,uBAAuB,CAAC,MAAM;AACvF,YAAI,EAAE,wBAAwB,KAAK,KAAK,yBAAyB,qBAAqB,UAAU;AAC/F,eAAK,KAAK,iBAAiB,EAAE;AAAA,QAC9B;AAAA,MACD,CAAC,CAAC;AAAA,IACH;AAAA,EACD;AAAA,EAEQ,qBAAqB;AAC5B,SAAK,0BAA0B,MAAM;AAErC,SAAK,KAAK,KAAK,SAAS,cAAc,KAAK,KAAK,SAAS,gBAAgB,CAAC,KAAK,eAAe,UAAW,iBAAiB,kBAAkB;AAC3I,YAAM,wBAAwB,uBAAuB,KAAK,KAAK,UAAU,WAAW,CAAC,CAAC;AACtF,YAAM,wBAAwB,uBAAuB,KAAK,KAAK,UAAU,WAAW,CAAC,CAAC;AACtF,UAAI,0BAA0B,uBAAuB;AACpD,cAAMA,QAAO,KAAK,gBAAgB,WAAW,MAAM;AACnD,cAAM,gBAAgB,KAAK,aAAa,YAAY,uBAAuBA,OAAM,QAAW,IAAI;AAChG,cAAM,gBAAgB,KAAK,aAAa,YAAY,uBAAuBA,OAAM,QAAW,IAAI;AAChG,aAAK,0BAA0B,IAAI,aAAa;AAChD,aAAK,0BAA0B,IAAI,aAAa;AAEhD,cAAM,aAAa,KAAK,eAAe,cAAc,EAAE,SAAS,cAAc;AAC9E,cAAM,YAAY,KAAK,IAAI,cAAc,aAAa,GAAG,cAAc,aAAa,CAAC;AACrF,aAAK,gBAAgB,KAAK,qBAAqB,eAAe,kBAAkB,KAAK,wBAAyB;AAAA,UAC7G,GAAG;AAAA,UACH,wBAAwB,KAAK,eAAe,4BAA4B;AAAA,UACxE,UAAU;AAAA,UACV,sBAAsB;AAAA,UACtB,iBAAiB;AAAA,UACjB,WAAW;AAAA,YACV,QAAQ,KAAK,IAAI,4BAA4B,KAAK,KAAK,WAAW,mBAAmB,aAAa,SAAS;AAAA,YAC3G,OAAO,KAAK,KAAK,8BAA8B,KAAK,eAAe,cAAc,GAAG,OAAO,IAAI;AAAA,UAChG;AAAA,UACA,sBAAsB,KAAK,qBAAqB,SAAkB,gCAAgC,UAAU,KAAK;AAAA,QAClH,GAAG;AAAA,UACF,gBAAgB,0CAA0C;AAAA,UAC1D,gBAAgB,0CAA0C;AAAA,QAC3D,CAAC;AACD,aAAK,0BAA0B,IAAI,KAAK,aAAa;AAErD,aAAK,wBAAwB,UAAU,IAAI,MAAM;AAEjD,aAAK,cAAc,SAAS;AAAA,UAC3B,UAAU;AAAA,UACV,UAAU;AAAA,QACX,CAAC;AACD,aAAK,cAAc,iBAAiB,KAAK,KAAK,yBAAyB,CAAsC;AAE7G,aAAK,KAAK,kBAAkB,KAAK,cAAc,iBAAiB;AAEhE,aAAK,0BAA0B,IAAI,KAAK,cAAc,uBAAuB,CAAC,MAAM;AACnF,cAAI,EAAE,wBAAwB,KAAK,KAAK,uBAAuB,qBAAqB,UAAU;AAC7F,iBAAK,KAAK,kBAAkB,EAAE;AAAA,UAC/B;AAAA,QACD,CAAC,CAAC;AAEF,aAAK,0BAA0B,IAAI,KAAK,KAAK,SAAU,UAAU,mBAAmB,MAAM;AACzF,gBAAMC,yBAAwB,uBAAuB,KAAK,KAAK,UAAU,WAAW,CAAC,CAAC;AACtF,wBAAc,SAASA,sBAAqB;AAC5C,eAAK,cAAc,QAAQ;AAAA,QAC5B,CAAC,CAAC;AAEF;AAAA,MACD;AAAA,IACD;AAEA,SAAK,gBAAgB,KAAK,qBAAqB,eAAe,kBAAkB,KAAK,wBAAyB;AAAA,MAC7G,GAAG;AAAA,MACH,WAAW;AAAA,QACV,OAAO,KAAK,IAAI,4BAA4B,KAAK,KAAK,8BAA8B,KAAK,eAAe,cAAc,GAAG,OAAO,KAAK,KAAK,SAAS,eAAe,KAAK,KAAK,SAAS,UAAU,IAAI,EAAE;AAAA,QACrM,QAAQ,KAAK,KAAK,WAAW;AAAA,MAC9B;AAAA,MACA,wBAAwB,KAAK,eAAe,4BAA4B;AAAA,IACzE,GAAG,CAAC,CAAC;AACL,SAAK,0BAA0B,IAAI,KAAK,aAAa;AAErD,UAAM,OAAO,KAAK,gBAAgB,WAAW,MAAM;AACnD,UAAM,uBAAuB;AAAA,MAC5B,KAAK,eAAe,UAAW,iBAAiB,mBAC7C,CAAC,IACD,KAAK,KAAK,SAAS,WAClB,KAAK,KAAK,UAAU,WAAW,CAAC,IAChC,KAAK,KAAK,UAAU,WAAW,CAAC;AAAA,IAAC;AACtC,UAAM,cAAc,KAAK,aAAa,YAAY,sBAAsB,MAAM,QAAW,IAAI;AAC7F,SAAK,0BAA0B,IAAI,WAAW;AAC9C,SAAK,cAAc,SAAS,WAAW;AACvC,SAAK,cAAc,iBAAiB,KAAK,KAAK,yBAAyB,CAAC;AAExE,SAAK,KAAK,kBAAkB,KAAK,cAAc,iBAAiB;AAEhE,SAAK,0BAA0B,IAAI,KAAK,cAAc,uBAAuB,CAAC,MAAM;AACnF,UAAI,EAAE,wBAAwB,KAAK,KAAK,uBAAuB,qBAAqB,UAAU;AAC7F,aAAK,KAAK,kBAAkB,EAAE;AAAA,MAC/B;AAAA,IACD,CAAC,CAAC;AAAA,EACH;AAAA,EAEU,qBAAqB;AAC9B,SAAK,eAAe;AAAA,MACnB,KAAK;AAAA,MACL,KAAK,KAAK,WAAW;AAAA,IACtB;AAAA,EACD;AAAA,EAEA,gBAAgB;AACf,SAAK,aAAa,WAAW,MAAM,SAAS,GAAG,KAAK,KAAK,WAAW,cAAc,EAAE;AACpF,SAAK,aAAa,YAAY,MAAM,SAAS,GAAG,KAAK,KAAK,WAAW,cAAc,EAAE;AACrF,SAAK,aAAa,aAAa,MAAM,MAAM,GAAG,KAAK,KAAK,WAAW,cAAc,EAAE;AAAA,EACpF;AAAA,EAES,UAAU;AAClB,QAAI,KAAK,eAAe;AACvB,WAAK,KAAK,0BAA0B,KAAK,cAAc,cAAc,CAAC;AAAA,IACvE;AAEA,QAAI,KAAK,iBAAiB;AACzB,WAAK,KAAK,4BAA4B,KAAK,gBAAgB,cAAc,CAAC;AAAA,IAC3E;AAEA,SAAK,4BAA4B,QAAQ;AACzC,SAAK,0BAA0B,QAAQ;AAEvC,SAAK,cAAc;AACnB,UAAM,QAAQ;AAAA,EACf;AAID;AAEA,MAAe,8BAA8B,wBAAwB;AAAA,EApuBrE,OAouBqE;AAAA;AAAA;AAAA,EAC1D;AAAA,EACQ;AAAA,EACA;AAAA,EAGlB,YACC,gBACA,MACA,cACA,OACA,sBACA,iBACA,cACA,kBACA,oBACA,mBACA,qBACA,aACA,mBACA,sBACA,0BACC;AACD;AAAA,MACC;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,IACD;AACA,SAAK,OAAO;AACZ,SAAK,eAAe;AAEpB,SAAK,cAAc;AAAA,EACpB;AAAA,EAEA,OAAO;AACN,SAAK,gBAAgB,KAAK,aAAa;AAAA,EACxC;AAAA,EAES,YAAY;AACpB,UAAM,OAAO,KAAK,aAAa;AAC/B,SAAK,uBAAuB,KAAK,aAAa;AAC9C,SAAK,UAAU,OAAO,QAAQ,SAAS,MAAM;AAC7C,YAAQ,KAAK,OAAO;AAAA,MACnB,KAAK;AACJ,aAAK,UAAU,IAAI,MAAM;AACzB;AAAA,MACD,KAAK;AACJ,aAAK,UAAU,IAAI,OAAO;AAC1B;AAAA,MACD;AACC,aAAK,UAAU,IAAI,MAAM;AACzB;AAAA,IACF;AAEA,SAAK,eAAe,KAAK,oBAAoB;AAC7C,SAAK,mBAAmB;AAExB,QAAI,KAAK,qBAAqB,SAAS,8BAA8B,GAAG;AACvE,WAAK,iBAAiB;AAAA,IACvB,OAAO;AACN,WAAK,eAAe;AAAA,IACrB;AAEA,QAAI,KAAK,qBAAqB,SAAS,6BAA6B,KAAK,KAAK,eAAe,WAAW,iBAAiB,kBAAkB;AAC1I,WAAK,eAAe;AAAA,IACrB,OAAO;AACN,WAAK,aAAa;AAAA,IACnB;AAEA,SAAK,UAAU,KAAK,qBAAqB,yBAAyB,OAAK;AACtE,UAAI,uBAAuB;AAC3B,UAAI,qBAAqB;AACzB,UAAI,EAAE,qBAAqB,8BAA8B,GAAG;AAC3D,aAAK,yBAAyB,MAAM;AACpC,YAAI,KAAK,qBAAqB,SAAS,8BAA8B,GAAG;AACvE,eAAK,iBAAiB;AAAA,QACvB,OAAO;AACN,eAAK,KAAK,uBAAuB;AACjC,eAAK,eAAe;AACpB,eAAK,wBAAwB;AAC7B,iCAAuB;AAAA,QACxB;AAAA,MACD;AAEA,UAAI,EAAE,qBAAqB,6BAA6B,GAAG;AAC1D,aAAK,uBAAuB,MAAM;AAClC,YAAI,KAAK,qBAAqB,SAAS,6BAA6B,KAAK,KAAK,eAAe,WAAW,iBAAiB,kBAAkB;AAC1I,eAAK,eAAe;AAAA,QACrB,OAAO;AACN,eAAK,KAAK,qBAAqB;AAC/B,eAAK,aAAa;AAClB,+BAAqB;AAAA,QACtB;AAAA,MACD;AAEA,UAAI,wBAAwB,oBAAoB;AAC/C,aAAK,OAAO,EAAE,gBAAgB,sBAAsB,mBAAmB,mBAAmB,CAAC;AAAA,MAC5F;AAAA,IACD,CAAC,CAAC;AAAA,EACH;AAAA,EAES,qBAA2B;AACnC,SAAK,uBAAuB,KAAK,aAAa;AAC9C,SAAK,qBAAqB,MAAM,UAAU;AAC1C,SAAK,qBAAqB,YAAY;AACtC,SAAK,mBAAmB,KAAK,aAAa;AAC1C,SAAK,iBAAiB,UAAU,IAAI,MAAM;AAE1C,UAAM,qBAAqB,6BAAM;AAChC,UAAI,KAAK,KAAK,qBAAqB,qBAAqB,WAAW;AAClE,aAAK,iBAAiB,MAAM,UAAU;AACtC,aAAK,KAAK,eAAe;AACzB;AAAA,MACD;AACA,YAAM,aAAa,KAAK,eAAe,cAAc,EAAE,SAAS,cAAc;AAC9E,YAAM,eAAe,KAAK,KAAK,yBAAyB,UAAU;AAElE,WAAK,iBAAiB,MAAM,SAAS,GAAG,YAAY;AACpD,WAAK,iBAAiB,MAAM,UAAU;AAEtC,UAAI,KAAK,SAAS;AACjB,cAAM,gBAAgB,KAAK,QAAQ,iBAAiB;AACpD,YAAI,iBAAiB,GAAG;AACvB,eAAK,KAAK,eAAe;AAAA,QAC1B;AACA;AAAA,MACD;AAEA,WAAK,UAAU,KAAK,aAAa;AACjC,WAAK,QAAQ;AAAA,QACZ;AAAA,UACC,QAAQ,KAAK,eAAe,cAAc,EAAE,QAAQ,IAAI,oBAAoB,IAAI;AAAA,UAChF,QAAQ;AAAA,QACT;AAAA,MACD;AACA,WAAK,QAAQ,cAAc,EAAE,UAAU,KAAK,SAAS,CAAC;AACtD,WAAK,KAAK,eAAe;AAEzB,WAAK,UAAU,KAAK,QAAQ,uBAAuB,CAAC,MAAM;AACzD,YAAI,KAAK,KAAK,qBAAqB,qBAAqB,YAAY,EAAE,wBAAwB,KAAK,KAAK,WAAW,iBAAiB,EAAE,eAAe;AACpJ,eAAK,KAAK,eAAe,EAAE;AAAA,QAC5B;AAAA,MACD,CAAC,CAAC;AACF,WAAK,4BAA4B,KAAK,mBAAmB;AAAA,IAC1D,GApC2B;AAsC3B,SAAK,cAAc,KAAK,UAAU,KAAK,qBAAqB;AAAA,MAC3D;AAAA,MACA,KAAK;AAAA,MACL,KAAK;AAAA,MACL,KAAK;AAAA,MACL;AAAA,QACC,qBAAqB,6BAAM,mBAAmB,GAAzB;AAAA,QACrB,iBAAiB,wBAAC,OAAO,EAAE,QAAQ,OAAU,IAA5B;AAAA,QACjB,iBAAiB,wBAAC,SAAS,KAAK,kBAAf;AAAA,QACjB,oBAAoB,wBAAC,MAAM,UAAU,KAAK,mBAAmB,OAAzC;AAAA,QACpB,gBAAgB;AAAA,QAChB,cAAc;AAAA,QACd,QAAQ;AAAA,QACR,QAAQ,OAAO;AAAA,MAChB;AAAA,IACD,CAAC;AACD,SAAK,YAAY,YAAY;AAC7B,uBAAmB;AAEnB,SAAK,4BAA4B,KAAK,mBAAmB;AAAA,EAC1D;AAAA,EACU,8BAA8B;AACvC,WAAO,KAAK,KAAK,WAAW,mBAAmB,KAAK,KAAK,WAAW,eAAe,KAAK,KAAK,WAAW,eAAe,KAAK,KAAK,WAAW,uBAAuB,KAAK,KAAK,WAAW,iBAAiB,KAAK,KAAK,WAAW,oBAAoB,KAAK,KAAK,WAAW;AAAA,EACxQ;AAAA,EAEA,MAAc,4BAA4B,cAAuC;AAChF,UAAM,cAAc,MAAM,KAAK,iBAAiB,qBAAqB,aAAa,GAAG;AAErF,QAAI,KAAK,aAAa;AACrB;AAAA,IACD;AAEA,UAAM,oBAAoB,YAAY,OAAO;AAC7C,SAAK,UAAU,WAAW;AAE1B,SAAK,QAAS,SAAS,iBAAiB;AAExC,UAAM,kBAAkB,KAAK,KAAK,yBAAyB;AAC3D,QAAI,iBAAiB;AACpB,WAAK,QAAS,iBAAiB,eAAe;AAAA,IAC/C;AAEA,UAAM,gBAAgB,KAAK,QAAS,iBAAiB;AACrD,SAAK,KAAK,eAAe;AACzB,UAAM,SAAS,GAAG,KAAK,4BAA4B,CAAC;AACpD,QAAI,KAAK,cAAe,MAAM,WAAW,QAAQ;AAChD,WAAK,cAAe,MAAM,SAAS;AAAA,IACpC;AAAA,EACD;AAAA,EAEA,mBAAmB;AAClB,SAAK,KAAK,uBAAuB;AACjC,SAAK,KAAK,iBAAiB;AAC3B,SAAK,aAAa,oBAAoB,MAAM,UAAU;AACtD,SAAK,aAAa,wBAAwB,MAAM,UAAU;AAC1D,SAAK,aAAa,sBAAsB,MAAM,UAAU;AACxD,SAAK,kBAAkB;AAAA,EACxB;AAAA,EAEA,iBAAiB;AAChB,SAAK,2BAA2B,KAAK,aAAa;AAClD,SAAK,yBAAyB,KAAK,aAAa;AAChD,SAAK,yBAAyB,MAAM,UAAU;AAC9C,SAAK,uBAAuB,MAAM,UAAU;AAC5C,SAAK,yBAAyB,YAAY;AAC1C,SAAK,uBAAuB,YAAY;AAExC,SAAK,kBAAkB,KAAK,qBAAqB;AAAA,MAChD;AAAA,MACA,KAAK;AAAA,MACL,KAAK;AAAA,MACL,KAAK;AAAA,MACL;AAAA,QACC,qBAAqB,KAAK,wBAAwB,KAAK,IAAI;AAAA,QAC3D,iBAAiB,wBAAC,SAAS;AAC1B,iBAAO,KAAK,wBAAwB;AAAA,QACrC,GAFiB;AAAA,QAGjB,iBAAiB,wBAAC,SAAS;AAC1B,iBAAO,KAAK;AAAA,QACb,GAFiB;AAAA,QAGjB,oBAAoB,wBAAC,MAAM,UAAU;AACpC,eAAK,uBAAuB;AAAA,QAC7B,GAFoB;AAAA,QAGpB,gBAAgB;AAAA,QAChB,cAAc;AAAA,QACd,QAAQ;AAAA,QACR,QAAQ,OAAO;AAAA,MAChB;AAAA,IACD;AACA,SAAK,yBAAyB,IAAI,KAAK,eAAe;AACtD,SAAK,gBAAgB,YAAY;AAAA,EAClC;AAAA,EAEA,eAAe;AACd,SAAK,aAAa,sBAAsB,MAAM,UAAU;AACxD,SAAK,aAAa,oBAAoB,MAAM,UAAU;AAEtD,SAAK,yBAAyB,KAAK,aAAa;AAChD,SAAK,uBAAuB,KAAK,aAAa;AAE9C,SAAK,uBAAuB,YAAY;AACxC,SAAK,qBAAqB,YAAY;AAEtC,SAAK,gBAAgB,KAAK,qBAAqB;AAAA,MAC9C;AAAA,MACA,KAAK;AAAA,MACL,KAAK;AAAA,MACL,KAAK;AAAA,MACL;AAAA,QACC,qBAAqB,KAAK,sBAAsB,KAAK,IAAI;AAAA,QACzD,iBAAiB,wBAAC,SAAS;AAC1B,iBAAO,KAAK,uBAAuB;AAAA,QACpC,GAFiB;AAAA,QAGjB,iBAAiB,wBAAC,SAAS;AAC1B,iBAAO,KAAK;AAAA,QACb,GAFiB;AAAA,QAGjB,oBAAoB,wBAAC,MAAM,UAAU;AACpC,eAAK,qBAAqB;AAAA,QAC3B,GAFoB;AAAA,QAGpB,gBAAgB;AAAA,QAChB,cAAc;AAAA,QACd,QAAQ;AAAA,QACR,QAAQ,OAAO;AAAA,MAChB;AAAA,IACD;AACA,SAAK,uBAAuB,IAAI,KAAK,aAAa;AAClD,SAAK,cAAc,YAAY;AAAA,EAChC;AAAA,EAEA,iBAAiB;AAChB,SAAK,gBAAgB;AACrB,SAAK,qBAAqB;AAC1B,SAAK,sBAAsB;AAE3B,SAAK,KAAK,kBAAkB;AAC5B,SAAK,KAAK,uBAAuB;AACjC,SAAK,KAAK,qBAAqB;AAC/B,SAAK,aAAa,sBAAsB,MAAM,UAAU;AACxD,SAAK,aAAa,oBAAoB,MAAM,UAAU;AACtD,SAAK,uBAAuB;AAAA,EAC7B;AACD;AACO,IAAM,iBAAN,cAA6B,sBAAsB;AAAA,EAhhC1D,OAghC0D;AAAA;AAAA;AAAA,EACzD,YACC,gBACA,MACA,cACkB,iBACH,cACI,kBACI,sBACF,oBACD,mBACE,qBACR,aACM,mBACG,sBACY,0BAClC;AACD,UAAM,gBAAgB,MAAM,cAAc,QAAQ,sBAAsB,iBAAiB,cAAc,kBAAkB,oBAAoB,mBAAmB,qBAAqB,aAAa,mBAAmB,sBAAsB,wBAAwB;AAAA,EACpQ;AAAA,EAEA,IAAI,sBAAsB;AACzB,WAAO,KAAK,KAAK;AAAA,EAClB;AAAA,EACA,IAAI,WAAW;AACd,WAAO;AAAA,EACR;AAAA,EAEA,eAAe,WAAwB;AACtC,cAAU,UAAU,OAAO,UAAU;AACrC,cAAU,UAAU,IAAI,SAAS;AAAA,EAClC;AAAA,EAEA,OAAO,OAAgC;AACtC,QAAI,6BAA6B,IAAI,UAAU,KAAK,oBAAoB,GAAG,MAAM;AAChF,WAAK,MAAM,gBAAgB,MAAM,eAAe,KAAK,SAAS;AAC7D,aAAK,iBAAiB,MAAM,SAAS,GAAG,KAAK,KAAK,WAAW,YAAY;AACzE,aAAK,QAAQ,OAAO;AAAA,UACnB,OAAO,KAAK,KAAK,8BAA8B,KAAK,eAAe,cAAc,GAAG,OAAO,KAAK;AAAA,UAChG,QAAQ,KAAK,KAAK,WAAW;AAAA,QAC9B,CAAC;AAAA,MACF;AAEA,UAAI,MAAM,cAAc,KAAK,SAAS;AACrC,aAAK,iBAAiB,MAAM,SAAS,GAAG,KAAK,KAAK,WAAW,YAAY;AACzE,aAAK,QAAQ,OAAO;AAAA,MACrB;AAEA,UAAI,MAAM,kBAAkB,MAAM,YAAY;AAC7C,aAAK,iBAAiB,OAAO;AAAA,UAC5B,OAAO,KAAK,KAAK,8BAA8B,KAAK,eAAe,cAAc,GAAG,OAAO,KAAK;AAAA,UAChG,QAAQ,KAAK,KAAK,WAAW;AAAA,QAC9B,CAAC;AAAA,MACF;AAEA,UAAI,MAAM,qBAAqB,MAAM,YAAY;AAChD,aAAK,eAAe,OAAO;AAAA,UAC1B,OAAO,KAAK,KAAK,8BAA8B,KAAK,eAAe,cAAc,GAAG,OAAO,KAAK;AAAA,UAChG,QAAQ,KAAK,KAAK,WAAW;AAAA,QAC9B,CAAC;AAAA,MACF;AAEA,UAAI,KAAK,eAAe;AACvB,aAAK,cAAc,MAAM,SAAS,GAAG,KAAK,4BAA4B,CAAC;AAAA,MACxE;AAEA,WAAK,mBAAmB;AAAA,IACzB,CAAC;AAAA,EACF;AAAA,EAGA,gCAAgC;AAC/B,QAAI,CAAC,KAAK,sBAAsB;AAC/B,WAAK,uBAAuB,IAAI,OAAO,KAAK,sBAAsB,IAAI,EAAE,wBAAwB,CAAC;AACjG,WAAK,sBAAsB,IAAI,OAAO,KAAK,sBAAsB,IAAI,EAAE,oBAAoB,CAAC;AAC5F,YAAM,OAAO,IAAI,OAAO,KAAK,qBAAqB,IAAI,EAAE,MAAM,CAAC;AAC/D,WAAK,YAAY;AAEjB,UAAI,CAAC,KAAK,KAAK,UAAU,QAAQ,QAAQ;AACxC,aAAK,oBAAoB,MAAM,UAAU;AAAA,MAC1C,OAAO;AACN,aAAK,oBAAoB,MAAM,UAAU;AAAA,MAC1C;AAEA,WAAK,KAAK,aAAa;AAEvB,WAAK,kBAAkB,KAAK,qBAAqB,eAAe,iBAAiB,KAAK,gBAAgB,KAAK,eAAe,WAAY,KAAK,MAAM,KAAK,KAAK,UAAW,SAAS,UAAU,KAAK,oBAAoB;AAClN,WAAK,UAAU,KAAK,eAAe;AACnC,WAAK,gBAAgB,OAAO;AAE5B,YAAM,8BAA8B,KAAK,eAAe,2BAA2B,OAAK;AACvF,YAAI,EAAE,KAAK,IAAI,SAAS,MAAM,KAAK,KAAK,SAAU,IAAI,SAAS,GAAG;AACjE,eAAK,eAAe,mCAAmC,SAAS,UAAU,KAAK,KAAK,SAAU,IAAI,CAAC,gBAAgB,GAAG,CAAC,CAAC;AACxH,sCAA4B,QAAQ;AAAA,QACrC;AAAA,MACD,CAAC;AAED,WAAK,UAAU,2BAA2B;AAAA,IAC3C;AAEA,SAAK,qBAAqB,MAAM,UAAU;AAAA,EAC3C;AAAA,EAEA,YAAY;AACX,SAAK,eAAe,mCAAmC,SAAS,UAAU,KAAK,KAAK,SAAU,IAAI,CAAC,gBAAgB,GAAG,CAAC,CAAC;AAAA,EACzH;AAAA,EAEA,uBAAuB;AACtB,QAAI,KAAK,sBAAsB;AAC9B,WAAK,qBAAqB,MAAM,UAAU;AAE1C,WAAK,iBAAiB,YAAY;AAClC,WAAK,UAAU;AAAA,IAChB;AAAA,EACD;AAAA,EAEA,uBAAuB;AACtB,QAAI,KAAK,sBAAsB;AAC9B,WAAK,qBAAqB,MAAM,UAAU;AAE1C,WAAK,iBAAiB,YAAY;AAAA,IACnC;AAAA,EACD;AAAA,EAES,UAAU;AAClB,QAAI,KAAK,SAAS;AACjB,WAAK,KAAK,0BAA0B,KAAK,QAAQ,cAAc,CAAC;AAAA,IACjE;AAEA,UAAM,QAAQ;AAAA,EACf;AACD;AAlIa,iBAAN;AAAA,EAKJ;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,GAfU;AAoIN,IAAM,gBAAN,cAA4B,sBAAsB;AAAA,EAppCzD,OAopCyD;AAAA;AAAA;AAAA,EACxD,YACC,gBACA,MACA,cACuB,sBACL,iBACH,cACI,kBACE,oBACD,mBACE,qBACR,aACM,mBACG,sBACY,0BAClC;AACD,UAAM,gBAAgB,MAAM,cAAc,SAAS,sBAAsB,iBAAiB,cAAc,kBAAkB,oBAAoB,mBAAmB,qBAAqB,aAAa,mBAAmB,sBAAsB,wBAAwB;AAAA,EACrQ;AAAA,EACA,IAAI,sBAAsB;AACzB,WAAO,KAAK,KAAK;AAAA,EAClB;AAAA,EACA,IAAI,WAAW;AACd,WAAO;AAAA,EACR;AAAA,EAEA,eAAe,WAA8B;AAC5C,cAAU,UAAU,OAAO,SAAS;AACpC,cAAU,UAAU,IAAI,UAAU;AAAA,EACnC;AAAA,EAEA,gCAAgC;AAC/B,QAAI,CAAC,KAAK,sBAAsB;AAC/B,WAAK,uBAAuB,IAAI,OAAO,KAAK,sBAAsB,IAAI,EAAE,wBAAwB,CAAC;AACjG,WAAK,sBAAsB,IAAI,OAAO,KAAK,sBAAsB,IAAI,EAAE,oBAAoB,CAAC;AAC5F,WAAK,oBAAoB,YAAY;AAErC,UAAI,CAAC,KAAK,KAAK,UAAU,QAAQ,QAAQ;AACxC,aAAK,oBAAoB,MAAM,UAAU;AAAA,MAC1C,OAAO;AACN,aAAK,oBAAoB,MAAM,UAAU;AAAA,MAC1C;AAEA,WAAK,KAAK,aAAa;AAEvB,WAAK,mBAAmB,KAAK,qBAAqB,eAAe,iBAAiB,KAAK,gBAAgB,KAAK,eAAe,WAAY,KAAK,MAAM,KAAK,KAAK,UAAW,SAAS,UAAU,KAAK,oBAAoB;AACnN,WAAK,UAAU,KAAK,gBAAgB;AACpC,WAAK,iBAAiB,OAAO;AAE7B,YAAM,6BAA6B,KAAK,eAAe,2BAA2B,OAAK;AACtF,YAAI,EAAE,KAAK,IAAI,SAAS,MAAM,KAAK,KAAK,SAAU,IAAI,SAAS,GAAG;AACjE,eAAK,eAAe,mCAAmC,SAAS,UAAU,KAAK,KAAK,SAAU,IAAI,CAAC,cAAc,GAAG,CAAC,CAAC;AACtH,qCAA2B,QAAQ;AAAA,QACpC;AAAA,MACD,CAAC;AACD,WAAK,UAAU,0BAA0B;AAAA,IAC1C;AAEA,SAAK,qBAAqB,MAAM,UAAU;AAAA,EAC3C;AAAA,EAEA,YAAY;AACX,SAAK,eAAe,mCAAmC,SAAS,UAAU,KAAK,KAAK,SAAU,IAAI,CAAC,cAAc,GAAG,CAAC,CAAC;AAAA,EACvH;AAAA,EAEA,uBAAuB;AACtB,QAAI,KAAK,sBAAsB;AAC9B,WAAK,qBAAqB,MAAM,UAAU;AAC1C,WAAK,kBAAkB,YAAY;AACnC,WAAK,UAAU;AAAA,IAChB;AAAA,EACD;AAAA,EAEA,uBAAuB;AACtB,QAAI,KAAK,sBAAsB;AAC9B,WAAK,qBAAqB,MAAM,UAAU;AAC1C,WAAK,kBAAkB,YAAY;AAAA,IACpC;AAAA,EACD;AAAA,EAEA,OAAO,OAAgC;AACtC,QAAI,6BAA6B,IAAI,UAAU,KAAK,oBAAoB,GAAG,MAAM;AAChF,WAAK,MAAM,gBAAgB,MAAM,eAAe,KAAK,SAAS;AAC7D,aAAK,iBAAiB,MAAM,SAAS,GAAG,KAAK,KAAK,WAAW,YAAY;AACzE,aAAK,QAAQ,OAAO;AAAA,UACnB,OAAO,KAAK,KAAK,8BAA8B,KAAK,eAAe,cAAc,GAAG,OAAO,KAAK;AAAA,UAChG,QAAQ,KAAK,KAAK,WAAW;AAAA,QAC9B,CAAC;AAAA,MACF;AAEA,UAAI,MAAM,cAAc,KAAK,SAAS;AACrC,aAAK,iBAAiB,MAAM,SAAS,GAAG,KAAK,KAAK,WAAW,YAAY;AACzE,aAAK,QAAQ,OAAO;AAAA,MACrB;AAEA,UAAI,MAAM,kBAAkB,MAAM,YAAY;AAC7C,aAAK,iBAAiB,OAAO;AAAA,UAC5B,OAAO,KAAK,KAAK,8BAA8B,KAAK,eAAe,cAAc,GAAG,OAAO,IAAI;AAAA,UAC/F,QAAQ,KAAK,KAAK,WAAW;AAAA,QAC9B,CAAC;AAAA,MACF;AAEA,UAAI,MAAM,qBAAqB,MAAM,YAAY;AAChD,aAAK,eAAe,OAAO;AAAA,UAC1B,OAAO,KAAK,KAAK,8BAA8B,KAAK,eAAe,cAAc,GAAG,OAAO,KAAK;AAAA,UAChG,QAAQ,KAAK,KAAK,WAAW;AAAA,QAC9B,CAAC;AAAA,MACF;AAEA,WAAK,mBAAmB;AAExB,UAAI,KAAK,eAAe;AACvB,aAAK,cAAc,MAAM,SAAS,GAAG,KAAK,4BAA4B,CAAC;AAAA,MACxE;AAAA,IACD,CAAC;AAAA,EACF;AAAA,EAES,UAAU;AAClB,QAAI,KAAK,SAAS;AACjB,WAAK,KAAK,0BAA0B,KAAK,QAAQ,cAAc,CAAC;AAAA,IACjE;AAEA,UAAM,QAAQ;AAAA,EACf;AACD;AA5Ha,gBAAN;AAAA,EAKJ;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,GAfU;AA8HN,IAAM,kBAAN,cAA8B,wBAAwB;AAAA,EAlxC7D,OAkxC6D;AAAA;AAAA;AAAA,EACpD;AAAA,EACA;AAAA,EACE;AAAA,EACA;AAAA,EAEQ;AAAA,EACA;AAAA,EAElB,YACC,gBACA,MACA,cACuB,sBACL,iBACH,cACI,kBACE,oBACD,mBACE,qBACR,aACM,mBACG,sBACY,0BAClC;AACD,UAAM,gBAAgB,MAAM,cAAc,QAAQ,sBAAsB,iBAAiB,cAAc,kBAAkB,oBAAoB,mBAAmB,qBAAqB,aAAa,mBAAmB,sBAAsB,wBAAwB;AACnQ,SAAK,OAAO;AACZ,SAAK,eAAe;AACpB,SAAK,0BAA0B;AAE/B,SAAK,cAAc;AAAA,EACpB;AAAA,EAEA,OAAO;AAAA,EAAE;AAAA,EACT,eAAe,WAA8B;AAC5C,cAAU,UAAU,OAAO,YAAY,SAAS;AAAA,EACjD;AAAA,EAES,YAAkB;AAC1B,UAAM,UAAU;AAChB,QAAI,KAAK,KAAK,kCAAkC;AAC/C,WAAK,UAAU,KAAK,aAAa,cAAc,SAAS,MAAM,KAAK,KAAK,mBAAmB,CAAC,CAAC;AAC7F,WAAK,aAAa,cAAc,KAAK;AAAA,IACtC,OAAO;AACN,WAAK,aAAa,cAAc,KAAK;AAAA,IACtC;AAAA,EACD;AAAA,EACA,mBAAmB;AAClB,SAAK,KAAK,uBAAuB;AACjC,SAAK,KAAK,iBAAiB;AAC3B,SAAK,aAAa,wBAAwB,MAAM,UAAU;AAC1D,SAAK,aAAa,sBAAsB,MAAM,UAAU;AACxD,SAAK,kBAAkB;AAAA,EACxB;AAAA,EAEA,iBAAiB;AAChB,SAAK,2BAA2B,KAAK,aAAa;AAClD,SAAK,yBAAyB,KAAK,aAAa;AAChD,SAAK,yBAAyB,MAAM,UAAU;AAC9C,SAAK,uBAAuB,MAAM,UAAU;AAE5C,SAAK,yBAAyB,YAAY;AAC1C,SAAK,uBAAuB,YAAY;AAExC,SAAK,kBAAkB,KAAK,qBAAqB;AAAA,MAChD;AAAA,MACA,KAAK;AAAA,MACL,KAAK;AAAA,MACL,KAAK;AAAA,MACL;AAAA,QACC,qBAAqB,KAAK,wBAAwB,KAAK,IAAI;AAAA,QAC3D,iBAAiB,wBAAC,SAAS;AAC1B,iBAAO,KAAK,wBAAwB;AAAA,QACrC,GAFiB;AAAA,QAGjB,iBAAiB,wBAAC,SAAS;AAC1B,iBAAO,KAAK;AAAA,QACb,GAFiB;AAAA,QAGjB,oBAAoB,wBAAC,MAAM,UAAU;AACpC,eAAK,uBAAuB;AAAA,QAC7B,GAFoB;AAAA,QAGpB,gBAAgB;AAAA,QAChB,cAAc;AAAA,QACd,QAAQ;AAAA,QACR,QAAQ,OAAO;AAAA,MAChB;AAAA,IACD;AACA,SAAK,yBAAyB,IAAI,KAAK,eAAe;AACtD,SAAK,gBAAgB,YAAY;AAAA,EAClC;AAAA,EAEA,iBAAiB;AAChB,SAAK,gBAAgB;AACrB,SAAK,qBAAqB;AAC1B,SAAK,sBAAsB;AAE3B,SAAK,KAAK,kBAAkB;AAC5B,SAAK,KAAK,uBAAuB;AACjC,SAAK,KAAK,qBAAqB;AAC/B,SAAK,aAAa,sBAAsB,MAAM,UAAU;AACxD,SAAK,aAAa,oBAAoB,MAAM,UAAU;AACtD,SAAK,uBAAuB;AAAA,EAC7B;AAAA,EAEA,eAAe;AACd,SAAK,aAAa,sBAAsB,MAAM,UAAU;AACxD,SAAK,aAAa,oBAAoB,MAAM,UAAU;AAEtD,SAAK,yBAAyB,KAAK,aAAa;AAChD,SAAK,uBAAuB,KAAK,aAAa;AAC9C,SAAK,uBAAuB,YAAY;AACxC,SAAK,qBAAqB,YAAY;AAEtC,QAAI,KAAK,KAAK,uBAAuB,GAAG;AACvC,WAAK,qBAAqB,UAAU,IAAI,UAAU;AAAA,IACnD,OAAO;AACN,WAAK,qBAAqB,UAAU,OAAO,UAAU;AAAA,IACtD;AAEA,SAAK,gBAAgB,KAAK,qBAAqB;AAAA,MAC9C;AAAA,MACA,KAAK;AAAA,MACL,KAAK;AAAA,MACL,KAAK;AAAA,MACL;AAAA,QACC,qBAAqB,KAAK,sBAAsB,KAAK,IAAI;AAAA,QACzD,iBAAiB,wBAAC,SAAS;AAC1B,iBAAO,KAAK,uBAAuB;AAAA,QACpC,GAFiB;AAAA,QAGjB,iBAAiB,wBAAC,SAAS;AAC1B,iBAAO,KAAK;AAAA,QACb,GAFiB;AAAA,QAGjB,oBAAoB,wBAAC,MAAM,UAAU;AACpC,eAAK,qBAAqB;AAAA,QAC3B,GAFoB;AAAA,QAGpB,gBAAgB;AAAA,QAChB,cAAc;AAAA,QACd,QAAQ;AAAA,QACR,QAAQ,OAAO;AAAA,MAChB;AAAA,IACD;AACA,SAAK,uBAAuB,IAAI,KAAK,aAAa;AAClD,SAAK,cAAc,YAAY;AAAA,EAChC;AAAA,EAEA,gCAAgC;AAC/B,QAAI,CAAC,KAAK,sBAAsB;AAC/B,WAAK,uBAAuB,IAAI,OAAO,KAAK,sBAAsB,IAAI,EAAE,wBAAwB,CAAC;AACjG,WAAK,sBAAsB,IAAI,OAAO,KAAK,sBAAsB,IAAI,EAAE,oBAAoB,CAAC;AAC5F,WAAK,oBAAoB,YAAY;AAErC,UAAI,CAAC,KAAK,KAAK,uBAAuB,KAAK,KAAK,KAAK,SAAS,QAAQ,WAAW,GAAG;AACnF,aAAK,oBAAoB,MAAM,UAAU;AAAA,MAC1C,OAAO;AACN,aAAK,oBAAoB,MAAM,UAAU;AAAA,MAC1C;AAEA,WAAK,KAAK,aAAa;AAEvB,WAAK,UAAU,KAAK,KAAK,SAAS,UAAU,mBAAmB,MAAM;AAEpE,YAAI,CAAC,KAAK,KAAK,uBAAuB,KAAK,KAAK,KAAK,SAAS,QAAQ,WAAW,GAAG;AACnF,eAAK,oBAAqB,MAAM,UAAU;AAAA,QAC3C,OAAO;AACN,eAAK,oBAAqB,MAAM,UAAU;AAAA,QAC3C;AACA,aAAK,UAAU;AAAA,MAChB,CAAC,CAAC;AAEF,WAAK,uBAAuB,IAAI,OAAO,KAAK,sBAAsB,IAAI,EAAE,6BAA6B,CAAC;AACtG,WAAK,wBAAwB,IAAI,OAAO,KAAK,sBAAsB,IAAI,EAAE,8BAA8B,CAAC;AACxG,WAAK,2BAA2B,IAAI,OAAO,KAAK,sBAAsB,IAAI,EAAE,iCAAiC,CAAC;AAE9G,YAAM,iBAAiB,KAAK,KAAK,uBAAuB;AACxD,YAAM,2BAA2B,kBAC7B,eAAe,SAAS,iBAAiB,YACzC,KAAK,KAAK,SAAS,QAAQ,WAAW,KACtC,KAAK,KAAK,SAAS,QAAQ,WAAW,KACtC,YAAY,KAAK,KAAK,SAAS,QAAQ,CAAC,GAAG,KAAK,KAAK,SAAS,QAAQ,CAAC,CAAC,MAAM,iBAAiB;AAEnG,UAAI,kBAAkB,CAAC,0BAA0B;AAChD,cAAM,+BAA+B,KAAK,eAAe,2BAA2B,OAAK;AACxF,cAAI,EAAE,KAAK,IAAI,SAAS,MAAM,KAAK,KAAK,SAAS,IAAI,SAAS,KAAK,KAAK,KAAK,uBAAuB,GAAG;AACtG,iBAAK,eAAe,mCAAmC,SAAS,UAAU,KAAK,KAAK,SAAS,IAAI,CAAC,gBAAgB,GAAG,CAAC,CAAC;AACvH,yCAA6B,QAAQ;AAAA,UACtC;AAAA,QACD,CAAC;AAED,cAAM,+BAA+B,KAAK,eAAe,2BAA2B,OAAK;AACxF,cAAI,EAAE,KAAK,IAAI,SAAS,MAAM,KAAK,KAAK,SAAS,IAAI,SAAS,KAAK,KAAK,KAAK,uBAAuB,GAAG;AACtG,iBAAK,eAAe,mCAAmC,SAAS,UAAU,KAAK,KAAK,SAAS,IAAI,CAAC,cAAc,GAAG,CAAC,CAAC;AACrH,yCAA6B,QAAQ;AAAA,UACtC;AAAA,QACD,CAAC;AAED,aAAK,UAAU,4BAA4B;AAC3C,aAAK,UAAU,4BAA4B;AAAA,MAC5C;AAGA,WAAK,kBAAkB,KAAK,qBAAqB,eAAe,iBAAiB,KAAK,gBAAgB,KAAK,eAAe,WAAY,KAAK,MAAM,KAAK,KAAK,UAAU,SAAS,UAAU,KAAK,oBAAoB;AACjN,WAAK,gBAAgB,OAAO;AAC5B,WAAK,UAAU,KAAK,eAAe;AACnC,WAAK,mBAAmB,KAAK,qBAAqB,eAAe,iBAAiB,KAAK,gBAAgB,KAAK,eAAe,WAAY,KAAK,MAAM,KAAK,KAAK,UAAU,SAAS,UAAU,KAAK,qBAAqB;AACnN,WAAK,iBAAiB,OAAO;AAC7B,WAAK,UAAU,KAAK,gBAAgB;AAEpC,UAAI,kBAAkB,CAAC,0BAA0B;AAChD,aAAK,UAAU;AAAA,MAChB;AAEA,UAAI,0BAA0B;AAE7B,aAAK,yBAAyB,MAAM,MAAM,GAAG,KAAK,KAAK,WAAW,eAAe;AAEjF,aAAK,wBAAwB,KAAK,qBAAqB,eAAe,kBAAkB,KAAK,0BAA0B;AAAA,UACtH,GAAG;AAAA,UACH,wBAAwB,KAAK,eAAe,4BAA4B;AAAA,UACxE,UAAU;AAAA,UACV,sBAAsB;AAAA,UACtB,iBAAiB;AAAA,UACjB,WAAW;AAAA,YACV,QAAQ;AAAA,YACR,OAAO,KAAK,KAAK,8BAA8B,KAAK,eAAe,cAAc,GAAG,OAAO,IAAI;AAAA,UAChG;AAAA,QACD,GAAG;AAAA,UACF,gBAAgB,0CAA0C;AAAA,UAC1D,gBAAgB,0CAA0C;AAAA,QAC3D,CAAC;AAED,aAAK,UAAU,KAAK,qBAAqB;AACzC,cAAM,+BAA+B,KAAK,UAAU,KAAK,KAAK,SAAS,QAAQ,CAAC,EAAE,YAAY,CAAC,GAAG,QAAW,GAAI;AACjH,cAAM,+BAA+B,KAAK,UAAU,KAAK,KAAK,SAAS,QAAQ,CAAC,EAAE,YAAY,CAAC,GAAG,QAAW,GAAI;AAEjH,cAAM,OAAO,KAAK,gBAAgB,WAAW,MAAM;AACnD,cAAM,gBAAgB,KAAK,aAAa,YAAY,8BAA8B,MAAM,QAAW,IAAI;AACvG,cAAM,gBAAgB,KAAK,aAAa,YAAY,8BAA8B,MAAM,QAAW,IAAI;AAEvG,aAAK,sBAAsB,SAAS;AAAA,UACnC,UAAU;AAAA,UACV,UAAU;AAAA,QACX,CAAC;AAED,aAAK,KAAK,uBAAuB,KAAK,sBAAsB,iBAAiB;AAE7E,aAAK,UAAU,KAAK,sBAAsB,uBAAuB,CAAC,MAAM;AACvE,eAAK,KAAK,uBAAuB,EAAE;AAAA,QACpC,CAAC,CAAC;AAAA,MACH;AAAA,IACD;AAEA,SAAK,qBAAqB,MAAM,UAAU;AAAA,EAC3C;AAAA,EAEA,YAAY;AACX,QAAI,KAAK,KAAK,uBAAuB,GAAG;AACvC,WAAK,eAAe,mCAAmC,SAAS,UAAU,KAAK,KAAK,SAAS,IAAI,CAAC,gBAAgB,GAAG,CAAC,CAAC;AACvH,WAAK,eAAe,mCAAmC,SAAS,UAAU,KAAK,KAAK,SAAS,IAAI,CAAC,cAAc,GAAG,CAAC,CAAC;AAAA,IACtH,OAAO;AACN,WAAK,eAAe,mCAAmC,SAAS,UAAU,KAAK,KAAK,SAAS,IAAI,CAAC,GAAG,CAAC,gBAAgB,CAAC;AACvH,WAAK,eAAe,mCAAmC,SAAS,UAAU,KAAK,KAAK,SAAS,IAAI,CAAC,GAAG,CAAC,cAAc,CAAC;AAAA,IACtH;AAAA,EACD;AAAA,EAEA,uBAAuB;AACtB,QAAI,KAAK,sBAAsB;AAC9B,WAAK,qBAAqB,MAAM,UAAU;AAE1C,WAAK,iBAAiB,YAAY;AAClC,WAAK,kBAAkB,YAAY;AACnC,WAAK,uBAAuB,OAAO;AAAA,QAClC,OAAO,KAAK,SAAS,aAAa,KAAK,KAAK,KAAK,8BAA8B,KAAK,eAAe,cAAc,GAAG,OAAO,IAAI;AAAA,QAC/H,QAAQ,KAAK,KAAK,WAAW;AAAA,MAC9B,CAAC;AAED,WAAK,UAAU;AAAA,IAChB;AAAA,EACD;AAAA,EAEA,uBAAuB;AACtB,QAAI,KAAK,sBAAsB;AAC9B,WAAK,qBAAqB,MAAM,UAAU;AAE1C,WAAK,iBAAiB,YAAY;AAClC,WAAK,kBAAkB,YAAY;AAAA,IACpC;AAAA,EACD;AAAA,EAEA,qBAA2B;AAC1B,SAAK,uBAAuB,KAAK,aAAa;AAC9C,SAAK,qBAAqB,MAAM,UAAU;AAC1C,SAAK,qBAAqB,YAAY;AACtC,UAAM,eAAe,KAAK,KAAK;AAC/B,SAAK,mBAAmB,KAAK,aAAa;AAC1C,SAAK,iBAAiB,UAAU,IAAI,MAAM;AAE1C,UAAM,qBAAqB,6BAAM;AAChC,UAAI,KAAK,KAAK,qBAAqB,qBAAqB,WAAW;AAClE,aAAK,iBAAiB,MAAM,UAAU;AACtC,aAAK,KAAK,eAAe;AACzB;AAAA,MACD;AAEA,YAAM,YAAY,aAAa,UAAU,WAAW,aAAa;AACjE,YAAM,aAAa,KAAK,eAAe,cAAc,EAAE,SAAS,cAAc;AAC9E,YAAM,eAAe,KAAK,KAAK,WAAW,iBAAiB,IAAI,KAAK,KAAK,WAAW,eAAe,KAAK,KAAK,yBAAyB,UAAU;AAEhJ,WAAK,iBAAiB,MAAM,SAAS,GAAG,YAAY;AACpD,WAAK,iBAAiB,MAAM,UAAU;AAEtC,UAAI,KAAK,SAAS;AACjB,cAAM,gBAAgB,KAAK,QAAQ,iBAAiB;AACpD,YAAI,iBAAiB,GAAG;AACvB,eAAK,KAAK,eAAe;AAAA,QAC1B;AACA;AAAA,MACD;AAEA,WAAK,UAAU,KAAK,aAAa;AAKjC,YAAM,UAA8B;AAAA,QACnC,SAAS,iBAAiB,SAAS;AAAA,MACpC;AACA,UAAI,KAAK,KAAK,wBAAwB,QAAQ,SAAS;AACtD,gBAAQ,uBAAuB,KAAK,KAAK,wBAAwB;AAAA,MAClE;AACA,WAAK,QAAQ,cAAc,OAAO;AAClC,WAAK,UAAU,KAAK,KAAK,wBAAwB,QAAQ,sBAAsB,MAAM;AACpF,gBAAQ,uBAAuB,KAAK,KAAK,wBAAwB;AACjE,aAAK,SAAS,cAAc,OAAO;AAAA,MACpC,CAAC,CAAC;AACF,WAAK,QAAQ,OAAO;AAAA,QACnB,OAAO,KAAK,eAAe,cAAc,EAAE,QAAQ,IAAI;AAAA,QACvD,QAAQ;AAAA,MACT,CAAC;AACD,WAAK,UAAU,KAAK,QAAQ,uBAAuB,CAAC,MAAM;AACzD,YAAI,KAAK,KAAK,qBAAqB,qBAAqB,YAAY,EAAE,wBAAwB,KAAK,KAAK,WAAW,iBAAiB,EAAE,eAAe;AACpJ,eAAK,KAAK,eAAe,EAAE;AAAA,QAC5B;AAAA,MACD,CAAC,CAAC;AACF,WAAK,4BAA4B;AAAA,IAClC,GAhD2B;AAkD3B,SAAK,cAAc,KAAK,UAAU,KAAK,qBAAqB;AAAA,MAC3D;AAAA,MACA,KAAK;AAAA,MACL,KAAK;AAAA,MACL,KAAK;AAAA,MACL;AAAA,QACC,qBAAqB,6BAAM,mBAAmB,GAAzB;AAAA,QACrB,iBAAiB,wBAAC,SAAS;AAC1B,iBAAO,KAAK,UAAU,UAAU,kBAAkB,MAAM,KAAK,UAAU,UAAU,kBAAkB,IAAI,EAAE,QAAQ,OAAU,IAAI;AAAA,QAChI,GAFiB;AAAA,QAGjB,iBAAiB,wBAAC,SAAS,KAAK,kBAAf;AAAA,QACjB,oBAAoB,wBAAC,MAAM,UAAU,KAAK,mBAAmB,OAAzC;AAAA,QACpB,gBAAgB;AAAA,QAChB,cAAc;AAAA,QACd,QAAQ;AAAA,QACR,QAAQ,OAAO;AAAA,MAChB;AAAA,IACD,CAAC;AACD,SAAK,YAAY,YAAY;AAC7B,uBAAmB;AAEnB,UAAM,0BAA0B,KAAK,kBAAkB,aAAa,KAAK,aAAa,qBAAqB;AAC3G,SAAK,UAAU,uBAAuB;AACtC,UAAM,eAAe,yBAAyB,OAAO,uBAAuB;AAC5E,iBAAa,IAAI,KAAK,KAAK,SAAS,UAAU,kBAAkB,MAAM,KAAK,KAAK,SAAS,UAAU,kBAAkB,CAAC;AAEtH,UAAM,mBAAmB,qCAAqC,OAAO,uBAAuB;AAC5F,UAAM,SAAS,KAAK,yBAAyB,SAAkB,KAAK,KAAK,SAAS,KAAK,iCAAiC;AACxH,qBAAiB,IAAI,MAAM;AAE3B,SAAK,WAAW,KAAK,aAAa;AAElC,SAAK,SAAS,UAAU;AAAA,MACvB,MAAM,KAAK;AAAA,IACZ;AAEA,UAAM,iBAAiB,6BAAM;AAC5B,YAAMC,UAAS,KAAK,yBAAyB,SAAkB,KAAK,KAAK,SAAS,KAAK,iCAAiC;AACxH,uBAAiB,IAAIA,OAAM;AAC3B,YAAM,aAAa,KAAK,KAAK,SAAS,UAAU,kBAAkB,MAAM,KAAK,KAAK,SAAS,UAAU,kBAAkB;AACvH,mBAAa,IAAI,UAAU;AAE3B,UAAI,YAAY;AACf,cAAM,UAAqB,CAAC;AAC5B,cAAM,OAAO,KAAK,YAAY,eAAe,OAAO,4BAA4B,yBAAyB,EAAE,mBAAmB,KAAK,CAAC;AACpI,wCAAgC,MAAM,OAAO;AAC7C,aAAK,SAAS,WAAW,OAAO;AAAA,MACjC,OAAO;AACN,aAAK,SAAS,WAAW,CAAC,CAAC;AAAA,MAC5B;AAAA,IACD,GAduB;AAgBvB,SAAK,UAAU,KAAK,KAAK,SAAS,UAAU,mBAAmB,MAAM,eAAe,CAAC,CAAC;AACtF,SAAK,UAAU,KAAK,yBAAyB,yBAAyB,OAAK;AAC1E,UAAI,EAAE,qBAAqB,KAAK,KAAK,SAAS,KAAK,YAAY,KAC9D,EAAE,aAAa,IAAI,iCAAiC,GAAG;AACvD,uBAAe;AAAA,MAChB;AAAA,IACD,CAAC,CAAC;AACF,mBAAe;AAAA,EAChB;AAAA,EAEA,MAAc,8BAA8B;AAC3C,UAAM,CAAC,aAAa,WAAW,IAAI,MAAM,QAAQ,IAAI;AAAA,MACpD,KAAK,iBAAiB,qBAAqB,KAAK,KAAK,SAAS,GAAG;AAAA,MACjE,KAAK,iBAAiB,qBAAqB,KAAK,KAAK,SAAS,GAAG;AAAA,IAAC,CAAC;AACpE,SAAK,UAAU,WAAW;AAC1B,SAAK,UAAU,WAAW;AAE1B,QAAI,KAAK,aAAa;AACrB,kBAAY,QAAQ;AACpB,kBAAY,QAAQ;AACpB;AAAA,IACD;AAEA,UAAM,KAAK,KAAK,UAAU,KAAK,QAAS,gBAAgB;AAAA,MACvD,UAAU,YAAY,OAAO;AAAA,MAC7B,UAAU,YAAY,OAAO;AAAA,IAC9B,CAAC,CAAC;AAKF,UAAM,GAAG,YAAY;AACrB,SAAK,QAAS,SAAS,EAAE;AAEzB,UAAM,wBAAwB,6BAAM;AACnC,WAAK,0BAA0B;AAAA,IAChC,GAF8B;AAI9B,UAAM,qBAAqB,wBAAC,MAAiC;AAC5D,UAAI,EAAE,oBAAoB,EAAE,mBAAmB;AAC9C,aAAK,0BAA0B;AAAA,MAChC;AAAA,IACD,GAJ2B;AAM3B,SAAK,iCAAiC;AACtC,SAAK,UAAU,KAAK,QAAS,kBAAkB,EAAE,2BAA2B,qBAAqB,CAAC;AAClG,SAAK,UAAU,KAAK,QAAS,kBAAkB,EAAE,kBAAkB,kBAAkB,CAAC;AACtF,SAAK,UAAU,KAAK,QAAS,kBAAkB,EAAE,2BAA2B,qBAAqB,CAAC;AAClG,SAAK,UAAU,KAAK,QAAS,kBAAkB,EAAE,kBAAkB,kBAAkB,CAAC;AAEtF,UAAM,kBAAkB,KAAK,KAAK,yBAAyB;AAC3D,QAAI,iBAAiB;AACpB,WAAK,QAAS,iBAAiB,eAAe;AAAA,IAC/C;AAEA,UAAM,gBAAgB,KAAK,QAAS,iBAAiB;AACrD,SAAK,KAAK,eAAe;AAAA,EAC1B;AAAA,EACQ,mCAAmC;AAC1C,UAAM,SAAS,KAAK;AACpB,QAAI,CAAC,QAAQ;AACZ;AAAA,IACD;AACA,UAAM,MAAM,OAAO,SAAS,GAAG,SAAS,OAAO,OAAO,SAAS,GAAG,SAAS;AAC3E,QAAI,CAAC,KAAK;AACT;AAAA,IACD;AACA,UAAM,uBAAuB,KAAK,yBAAyB,SAAkB,KAAK,iCAAiC;AACnH,WAAO,cAAc,EAAE,qBAAqB,CAAC;AAE7C,SAAK,UAAU,KAAK,yBAAyB,yBAAyB,OAAK;AAC1E,UAAI,EAAE,qBAAqB,KAAK,YAAY,KAC3C,EAAE,aAAa,IAAI,iCAAiC,GAAG;AACvD,cAAMC,wBAAuB,KAAK,yBAAyB,SAAkB,KAAK,iCAAiC;AACnH,eAAO,cAAc,EAAE,sBAAAA,sBAAqB,CAAC;AAAA,MAC9C;AAAA,IACD,CAAC,CAAC;AAAA,EACH;AAAA,EACA,OAAO,OAAgC;AACtC,QAAI,6BAA6B,IAAI,UAAU,KAAK,oBAAoB,GAAG,MAAM;AAChF,UAAI,MAAM,gBAAgB,KAAK,SAAS;AACvC,aAAK,iBAAiB,MAAM,SAAS,GAAG,KAAK,KAAK,WAAW,YAAY;AACzE,aAAK,QAAQ,OAAO;AAAA,UACnB,OAAO,KAAK,QAAS,aAAa;AAAA,UAClC,QAAQ,KAAK,KAAK,WAAW;AAAA,QAC9B,CAAC;AAAA,MACF;AAEA,UAAI,MAAM,cAAc,KAAK,SAAS;AACrC,aAAK,iBAAiB,MAAM,SAAS,GAAG,KAAK,KAAK,WAAW,YAAY;AACzE,aAAK,QAAQ,OAAO;AAAA,MACrB;AAEA,UAAI,MAAM,kBAAkB,MAAM,YAAY;AAC7C,YAAI,KAAK,0BAA0B;AAClC,eAAK,yBAAyB,MAAM,SAAS,GAAG,KAAK,KAAK,WAAW,cAAc;AACnF,eAAK,iBAAiB,OAAO;AAAA,YAC5B,OAAO,KAAK,SAAS,aAAa,KAAK,KAAK,KAAK,8BAA8B,KAAK,eAAe,cAAc,GAAG,OAAO,IAAI;AAAA,YAC/H,QAAQ,KAAK,KAAK,WAAW;AAAA,UAC9B,CAAC;AAAA,QACF;AAAA,MACD;AAEA,UAAI,MAAM,qBAAqB,MAAM,YAAY;AAChD,YAAI,KAAK,wBAAwB;AAChC,eAAK,uBAAuB,MAAM,SAAS,GAAG,KAAK,KAAK,WAAW,iBAAiB;AACpF,eAAK,eAAe,OAAO;AAAA,YAC1B,OAAO,KAAK,SAAS,aAAa,KAAK,KAAK,KAAK,8BAA8B,KAAK,eAAe,cAAc,GAAG,OAAO,IAAI;AAAA,YAC/H,QAAQ,KAAK,KAAK,WAAW;AAAA,UAC9B,CAAC;AAAA,QACF;AAEA,YAAI,KAAK,0BAA0B;AAClC,eAAK,yBAAyB,MAAM,SAAS,GAAG,KAAK,KAAK,WAAW,oBAAoB;AACzF,eAAK,yBAAyB,MAAM,MAAM,GAAG,KAAK,KAAK,WAAW,oBAAoB,KAAK,KAAK,WAAW,oBAAoB;AAC/H,eAAK,uBAAuB,OAAO;AAAA,YAClC,OAAO,KAAK,SAAS,aAAa,KAAK,KAAK,KAAK,8BAA8B,KAAK,eAAe,cAAc,GAAG,OAAO,IAAI;AAAA,YAC/H,QAAQ,KAAK,KAAK,WAAW;AAAA,UAC9B,CAAC;AAAA,QACF;AAAA,MACD;AAEA,WAAK,mBAAmB;AAAA,IACzB,CAAC;AAAA,EACF;AAAA,EAES,UAAU;AAGlB,QAAI,KAAK,SAAS;AACjB,WAAK,QAAQ,SAAS,IAAI;AAAA,IAC3B;AAEA,QAAI,KAAK,WAAW,KAAK,yBAAyB;AACjD,WAAK,KAAK,0BAA0B,KAAK,QAAQ,cAAc,CAAC;AAAA,IACjE;AAEA,UAAM,QAAQ;AAAA,EACf;AACD;AAxhBa,kBAAN;AAAA,EAaJ;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,GAvBU;AA2hBN,MAAM,mCAAmC,WAA6C;AAAA,EAc5F,YACkB,WAChB;AACD,UAAM;AAFW;AAIjB,SAAK,OAAO,KAAK,MAAM,UAAU;AACjC,cAAU,YAAY,KAAK,OAAO,IAAI;AAAA,EACvC;AAAA,EAl0DD,OA6yD6F;AAAA;AAAA;AAAA,EAC3E,SAAS,IAAI,EAAE,yBAAyB;AAAA,IACxD,IAAI;AAAA,MAAE;AAAA,MAAsB,EAAE,OAAO,EAAE,SAAS,OAAO,EAAE;AAAA,MAAG;AAAA,QAC3D,IAAI;AAAA,UAAE;AAAA,UAAK;AAAA,YACV,OAAO,SAAS,sBAAsB,sBAAsB;AAAA,YAC5D,MAAM;AAAA,YACN,SAAS,6BAAM;AAAE,mBAAK,QAAQ,KAAK;AAAA,YAAG,GAA7B;AAAA,UACV;AAAA,UACC,GAAG,qBAAqB,WAAW;AAAA,QAAC;AAAA,MAAC;AAAA,IACvC;AAAA,EACD,CAAC;AAAA,EAEgB,UAAU,KAAK,UAAU,IAAI,QAAc,CAAC;AAAA,EAC7C,WAAW,KAAK,QAAQ;AAAA,EAUjC,OAAO;AACb,SAAK,OAAO,KAAK,MAAM,UAAU;AAAA,EAClC;AAAA,EAEO,OAAO;AACb,SAAK,OAAO,KAAK,MAAM,UAAU;AAAA,EAClC;AAAA,EAEgB,UAAU;AACzB,SAAK,KAAK;AACV,SAAK,UAAU,YAAY,KAAK,OAAO,IAAI;AAC3C,QAAI,MAAM,KAAK,OAAO,IAAI;AAC1B,UAAM,QAAQ;AAAA,EACf;AACD;AAEO,MAAM,mCAAmC,WAA6C;AAAA,EAgB5F,YACkB,WAChB;AACD,UAAM;AAFW;AAIjB,SAAK,OAAO,KAAK,MAAM,UAAU;AACjC,cAAU,YAAY,KAAK,OAAO,IAAI;AAAA,EACvC;AAAA,EA32DD,OAo1D6F;AAAA;AAAA;AAAA,EAC3E,SAAS,IAAI,EAAE,yBAAyB;AAAA,IACxD,IAAI;AAAA,MAAE;AAAA,MAAsB,EAAE,OAAO,EAAE,SAAS,OAAO,EAAE;AAAA,MAAG;AAAA,QAC3D,IAAI;AAAA,UAAE;AAAA,UAAK;AAAA,YACV,OAAO,SAAS,sBAAsB,sBAAsB;AAAA,YAC5D,MAAM;AAAA,YACN,SAAS,6BAAM;AAAE,mBAAK,QAAQ,KAAK;AAAA,YAAG,GAA7B;AAAA,UACV;AAAA,UACC,GAAG,qBAAqB,SAAS;AAAA,QAClC;AAAA,MACD;AAAA,IACA;AAAA,EACD,CAAC;AAAA,EAEgB,UAAU,KAAK,UAAU,IAAI,QAAc,CAAC;AAAA,EAC7C,WAAW,KAAK,QAAQ;AAAA,EAUjC,OAAO;AACb,SAAK,OAAO,KAAK,MAAM,UAAU;AAAA,EAClC;AAAA,EAEO,OAAO;AACb,SAAK,OAAO,KAAK,MAAM,UAAU;AAAA,EAClC;AAAA,EACgB,UAAU;AACzB,SAAK,KAAK;AACV,SAAK,UAAU,YAAY,KAAK,OAAO,IAAI;AAC3C,QAAI,MAAM,KAAK,OAAO,IAAI;AAC1B,UAAM,QAAQ;AAAA,EACf;AACD;",
  "names": ["mode", "modifiedOutputsSource", "ignore", "ignoreTrimWhitespace"]
}
