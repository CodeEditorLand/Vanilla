{
  "version": 3,
  "sources": ["../../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/notebook/browser/view/cellPart.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as DOM from '../../../../../base/browser/dom.js';\nimport { onUnexpectedError } from '../../../../../base/common/errors.js';\nimport { Disposable, DisposableStore, MutableDisposable } from '../../../../../base/common/lifecycle.js';\nimport { ICellViewModel } from '../notebookBrowser.js';\nimport { CellViewModelStateChangeEvent } from '../notebookViewEvents.js';\nimport { ICellExecutionStateChangedEvent } from '../../common/notebookExecutionStateService.js';\n\n/**\n * A content part is a non-floating element that is rendered inside a cell.\n * The rendering of the content part is synchronous to avoid flickering.\n */\nexport abstract class CellContentPart extends Disposable {\n\tprotected currentCell: ICellViewModel | undefined;\n\tprotected readonly cellDisposables = this._register(new DisposableStore());\n\n\tconstructor() {\n\t\tsuper();\n\t}\n\n\t/**\n\t * Prepare model for cell part rendering\n\t * No DOM operations recommended within this operation\n\t */\n\tprepareRenderCell(element: ICellViewModel): void { }\n\n\t/**\n\t * Update the DOM for the cell `element`\n\t */\n\trenderCell(element: ICellViewModel): void {\n\t\tthis.currentCell = element;\n\t\tsafeInvokeNoArg(() => this.didRenderCell(element));\n\t}\n\n\tdidRenderCell(element: ICellViewModel): void { }\n\n\t/**\n\t * Dispose any disposables generated from `didRenderCell`\n\t */\n\tunrenderCell(element: ICellViewModel): void {\n\t\tthis.currentCell = undefined;\n\t\tthis.cellDisposables.clear();\n\t}\n\n\t/**\n\t * Perform DOM read operations to prepare for the list/cell layout update.\n\t */\n\tprepareLayout(): void { }\n\n\t/**\n\t * Update internal DOM (top positions) per cell layout info change\n\t * Note that a cell part doesn't need to call `DOM.scheduleNextFrame`,\n\t * the list view will ensure that layout call is invoked in the right frame\n\t */\n\tupdateInternalLayoutNow(element: ICellViewModel): void { }\n\n\t/**\n\t * Update per cell state change\n\t */\n\tupdateState(element: ICellViewModel, e: CellViewModelStateChangeEvent): void { }\n\n\t/**\n\t * Update per execution state change.\n\t */\n\tupdateForExecutionState(element: ICellViewModel, e: ICellExecutionStateChangedEvent): void { }\n}\n\n/**\n * An overlay part renders on top of other components.\n * The rendering of the overlay part might be postponed to the next animation frame to avoid forced reflow.\n */\nexport abstract class CellOverlayPart extends Disposable {\n\tprotected currentCell: ICellViewModel | undefined;\n\tprotected readonly cellDisposables = this._register(new DisposableStore());\n\n\tconstructor() {\n\t\tsuper();\n\t}\n\n\t/**\n\t * Prepare model for cell part rendering\n\t * No DOM operations recommended within this operation\n\t */\n\tprepareRenderCell(element: ICellViewModel): void { }\n\n\t/**\n\t * Update the DOM for the cell `element`\n\t */\n\trenderCell(element: ICellViewModel): void {\n\t\tthis.currentCell = element;\n\t\tthis.didRenderCell(element);\n\t}\n\n\tdidRenderCell(element: ICellViewModel): void { }\n\n\t/**\n\t * Dispose any disposables generated from `didRenderCell`\n\t */\n\tunrenderCell(element: ICellViewModel): void {\n\t\tthis.currentCell = undefined;\n\t\tthis.cellDisposables.clear();\n\t}\n\n\t/**\n\t * Update internal DOM (top positions) per cell layout info change\n\t * Note that a cell part doesn't need to call `DOM.scheduleNextFrame`,\n\t * the list view will ensure that layout call is invoked in the right frame\n\t */\n\tupdateInternalLayoutNow(element: ICellViewModel): void { }\n\n\t/**\n\t * Update per cell state change\n\t */\n\tupdateState(element: ICellViewModel, e: CellViewModelStateChangeEvent): void { }\n\n\t/**\n\t * Update per execution state change.\n\t */\n\tupdateForExecutionState(element: ICellViewModel, e: ICellExecutionStateChangedEvent): void { }\n}\n\nfunction safeInvokeNoArg<T>(func: () => T): T | null {\n\ttry {\n\t\treturn func();\n\t} catch (e) {\n\t\tonUnexpectedError(e);\n\t\treturn null;\n\t}\n}\n\nexport class CellPartsCollection extends Disposable {\n\tprivate readonly _scheduledOverlayRendering = this._register(new MutableDisposable());\n\tprivate readonly _scheduledOverlayUpdateState = this._register(new MutableDisposable());\n\tprivate readonly _scheduledOverlayUpdateExecutionState = this._register(new MutableDisposable());\n\n\tconstructor(\n\t\tprivate readonly targetWindow: Window,\n\t\tprivate readonly contentParts: readonly CellContentPart[],\n\t\tprivate readonly overlayParts: readonly CellOverlayPart[]\n\t) {\n\t\tsuper();\n\t}\n\n\tconcatContentPart(other: readonly CellContentPart[], targetWindow: Window): CellPartsCollection {\n\t\treturn new CellPartsCollection(targetWindow, this.contentParts.concat(other), this.overlayParts);\n\t}\n\n\tconcatOverlayPart(other: readonly CellOverlayPart[], targetWindow: Window): CellPartsCollection {\n\t\treturn new CellPartsCollection(targetWindow, this.contentParts, this.overlayParts.concat(other));\n\t}\n\n\tscheduleRenderCell(element: ICellViewModel): void {\n\t\t// prepare model\n\t\tfor (const part of this.contentParts) {\n\t\t\tsafeInvokeNoArg(() => part.prepareRenderCell(element));\n\t\t}\n\n\t\tfor (const part of this.overlayParts) {\n\t\t\tsafeInvokeNoArg(() => part.prepareRenderCell(element));\n\t\t}\n\n\t\t// render content parts\n\t\tfor (const part of this.contentParts) {\n\t\t\tsafeInvokeNoArg(() => part.renderCell(element));\n\t\t}\n\n\t\tthis._scheduledOverlayRendering.value = DOM.modify(this.targetWindow, () => {\n\t\t\tfor (const part of this.overlayParts) {\n\t\t\t\tsafeInvokeNoArg(() => part.renderCell(element));\n\t\t\t}\n\t\t});\n\t}\n\n\tunrenderCell(element: ICellViewModel): void {\n\t\tfor (const part of this.contentParts) {\n\t\t\tsafeInvokeNoArg(() => part.unrenderCell(element));\n\t\t}\n\n\t\tthis._scheduledOverlayRendering.value = undefined;\n\t\tthis._scheduledOverlayUpdateState.value = undefined;\n\t\tthis._scheduledOverlayUpdateExecutionState.value = undefined;\n\n\t\tfor (const part of this.overlayParts) {\n\t\t\tsafeInvokeNoArg(() => part.unrenderCell(element));\n\t\t}\n\t}\n\n\tupdateInternalLayoutNow(viewCell: ICellViewModel) {\n\t\tfor (const part of this.contentParts) {\n\t\t\tsafeInvokeNoArg(() => part.updateInternalLayoutNow(viewCell));\n\t\t}\n\n\t\tfor (const part of this.overlayParts) {\n\t\t\tsafeInvokeNoArg(() => part.updateInternalLayoutNow(viewCell));\n\t\t}\n\t}\n\n\tprepareLayout() {\n\t\tfor (const part of this.contentParts) {\n\t\t\tsafeInvokeNoArg(() => part.prepareLayout());\n\t\t}\n\t}\n\n\tupdateState(viewCell: ICellViewModel, e: CellViewModelStateChangeEvent) {\n\t\tfor (const part of this.contentParts) {\n\t\t\tsafeInvokeNoArg(() => part.updateState(viewCell, e));\n\t\t}\n\n\t\tthis._scheduledOverlayUpdateState.value = DOM.modify(this.targetWindow, () => {\n\t\t\tfor (const part of this.overlayParts) {\n\t\t\t\tsafeInvokeNoArg(() => part.updateState(viewCell, e));\n\t\t\t}\n\t\t});\n\t}\n\n\tupdateForExecutionState(viewCell: ICellViewModel, e: ICellExecutionStateChangedEvent) {\n\t\tfor (const part of this.contentParts) {\n\t\t\tsafeInvokeNoArg(() => part.updateForExecutionState(viewCell, e));\n\t\t}\n\n\t\tthis._scheduledOverlayUpdateExecutionState.value = DOM.modify(this.targetWindow, () => {\n\t\t\tfor (const part of this.overlayParts) {\n\t\t\t\tsafeInvokeNoArg(() => part.updateForExecutionState(viewCell, e));\n\t\t\t}\n\t\t});\n\t}\n}\n"],
  "mappings": "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",
  "names": []
}
