{
  "version": 3,
  "sources": ["../../../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/notebook/browser/view/cellParts/cellFocusIndicator.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as DOM from \"../../../../../../base/browser/dom.js\";\nimport { FastDomNode } from \"../../../../../../base/browser/fastDomNode.js\";\nimport { CellKind } from \"../../../common/notebookCommon.js\";\nimport type {\n\tCodeCellLayoutInfo,\n\tICellViewModel,\n\tINotebookEditorDelegate,\n} from \"../../notebookBrowser.js\";\nimport type { CodeCellViewModel } from \"../../viewModel/codeCellViewModel.js\";\nimport type { MarkupCellViewModel } from \"../../viewModel/markupCellViewModel.js\";\nimport { CellContentPart } from \"../cellPart.js\";\nimport type { CellTitleToolbarPart } from \"./cellToolbars.js\";\n\nexport class CellFocusIndicator extends CellContentPart {\n\tpublic codeFocusIndicator: FastDomNode<HTMLElement>;\n\tpublic outputFocusIndicator: FastDomNode<HTMLElement>;\n\n\tconstructor(\n\t\treadonly notebookEditor: INotebookEditorDelegate,\n\t\treadonly titleToolbar: CellTitleToolbarPart,\n\t\treadonly top: FastDomNode<HTMLElement>,\n\t\treadonly left: FastDomNode<HTMLElement>,\n\t\treadonly right: FastDomNode<HTMLElement>,\n\t\treadonly bottom: FastDomNode<HTMLElement>,\n\t) {\n\t\tsuper();\n\n\t\tthis.codeFocusIndicator = new FastDomNode(\n\t\t\tDOM.append(\n\t\t\t\tthis.left.domNode,\n\t\t\t\tDOM.$(\n\t\t\t\t\t\".codeOutput-focus-indicator-container\",\n\t\t\t\t\tundefined,\n\t\t\t\t\tDOM.$(\".codeOutput-focus-indicator.code-focus-indicator\"),\n\t\t\t\t),\n\t\t\t),\n\t\t);\n\n\t\tthis.outputFocusIndicator = new FastDomNode(\n\t\t\tDOM.append(\n\t\t\t\tthis.left.domNode,\n\t\t\t\tDOM.$(\n\t\t\t\t\t\".codeOutput-focus-indicator-container\",\n\t\t\t\t\tundefined,\n\t\t\t\t\tDOM.$(\".codeOutput-focus-indicator.output-focus-indicator\"),\n\t\t\t\t),\n\t\t\t),\n\t\t);\n\n\t\tthis._register(\n\t\t\tDOM.addDisposableListener(\n\t\t\t\tthis.codeFocusIndicator.domNode,\n\t\t\t\tDOM.EventType.CLICK,\n\t\t\t\t() => {\n\t\t\t\t\tif (this.currentCell) {\n\t\t\t\t\t\tthis.currentCell.isInputCollapsed =\n\t\t\t\t\t\t\t!this.currentCell.isInputCollapsed;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t),\n\t\t);\n\t\tthis._register(\n\t\t\tDOM.addDisposableListener(\n\t\t\t\tthis.outputFocusIndicator.domNode,\n\t\t\t\tDOM.EventType.CLICK,\n\t\t\t\t() => {\n\t\t\t\t\tif (this.currentCell) {\n\t\t\t\t\t\tthis.currentCell.isOutputCollapsed =\n\t\t\t\t\t\t\t!this.currentCell.isOutputCollapsed;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t),\n\t\t);\n\n\t\tthis._register(\n\t\t\tDOM.addDisposableListener(\n\t\t\t\tthis.left.domNode,\n\t\t\t\tDOM.EventType.DBLCLICK,\n\t\t\t\t(e) => {\n\t\t\t\t\tif (!this.currentCell || !this.notebookEditor.hasModel()) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (e.target !== this.left.domNode) {\n\t\t\t\t\t\t// Don't allow dblclick on the codeFocusIndicator/outputFocusIndicator\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst clickedOnInput =\n\t\t\t\t\t\te.offsetY <\n\t\t\t\t\t\t(this.currentCell.layoutInfo as CodeCellLayoutInfo)\n\t\t\t\t\t\t\t.outputContainerOffset;\n\t\t\t\t\tif (clickedOnInput) {\n\t\t\t\t\t\tthis.currentCell.isInputCollapsed =\n\t\t\t\t\t\t\t!this.currentCell.isInputCollapsed;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.currentCell.isOutputCollapsed =\n\t\t\t\t\t\t\t!this.currentCell.isOutputCollapsed;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t),\n\t\t);\n\n\t\tthis._register(\n\t\t\tthis.titleToolbar.onDidUpdateActions(() => {\n\t\t\t\tthis.updateFocusIndicatorsForTitleMenu();\n\t\t\t}),\n\t\t);\n\t}\n\n\toverride updateInternalLayoutNow(element: ICellViewModel): void {\n\t\tif (element.cellKind === CellKind.Markup) {\n\t\t\tconst indicatorPostion =\n\t\t\t\tthis.notebookEditor.notebookOptions.computeIndicatorPosition(\n\t\t\t\t\telement.layoutInfo.totalHeight,\n\t\t\t\t\t(element as MarkupCellViewModel).layoutInfo.foldHintHeight,\n\t\t\t\t\tthis.notebookEditor.textModel?.viewType,\n\t\t\t\t);\n\t\t\tthis.bottom.domNode.style.transform = `translateY(${indicatorPostion.bottomIndicatorTop + 6}px)`;\n\t\t\tthis.left.setHeight(indicatorPostion.verticalIndicatorHeight);\n\t\t\tthis.right.setHeight(indicatorPostion.verticalIndicatorHeight);\n\t\t\tthis.codeFocusIndicator.setHeight(\n\t\t\t\tindicatorPostion.verticalIndicatorHeight -\n\t\t\t\t\tthis.getIndicatorTopMargin() * 2 -\n\t\t\t\t\telement.layoutInfo.chatHeight,\n\t\t\t);\n\t\t} else {\n\t\t\tconst cell = element as CodeCellViewModel;\n\t\t\tconst layoutInfo =\n\t\t\t\tthis.notebookEditor.notebookOptions.getLayoutConfiguration();\n\t\t\tconst bottomToolbarDimensions =\n\t\t\t\tthis.notebookEditor.notebookOptions.computeBottomToolbarDimensions(\n\t\t\t\t\tthis.notebookEditor.textModel?.viewType,\n\t\t\t\t);\n\t\t\tconst indicatorHeight =\n\t\t\t\tcell.layoutInfo.codeIndicatorHeight +\n\t\t\t\tcell.layoutInfo.outputIndicatorHeight +\n\t\t\t\tcell.layoutInfo.commentHeight;\n\t\t\tthis.left.setHeight(indicatorHeight);\n\t\t\tthis.right.setHeight(indicatorHeight);\n\t\t\tthis.codeFocusIndicator.setHeight(\n\t\t\t\tcell.layoutInfo.codeIndicatorHeight,\n\t\t\t);\n\t\t\tthis.outputFocusIndicator.setHeight(\n\t\t\t\tMath.max(\n\t\t\t\t\tcell.layoutInfo.outputIndicatorHeight -\n\t\t\t\t\t\tcell.viewContext.notebookOptions.getLayoutConfiguration()\n\t\t\t\t\t\t\t.focusIndicatorGap,\n\t\t\t\t\t0,\n\t\t\t\t),\n\t\t\t);\n\t\t\tthis.bottom.domNode.style.transform = `translateY(${cell.layoutInfo.totalHeight - bottomToolbarDimensions.bottomToolbarGap - layoutInfo.cellBottomMargin}px)`;\n\t\t}\n\n\t\tthis.updateFocusIndicatorsForTitleMenu();\n\t}\n\n\tprivate updateFocusIndicatorsForTitleMenu(): void {\n\t\tconst y =\n\t\t\t(this.currentCell?.layoutInfo.chatHeight ?? 0) +\n\t\t\tthis.getIndicatorTopMargin();\n\t\tthis.left.domNode.style.transform = `translateY(${y}px)`;\n\t\tthis.right.domNode.style.transform = `translateY(${y}px)`;\n\t}\n\n\tprivate getIndicatorTopMargin() {\n\t\tconst layoutInfo =\n\t\t\tthis.notebookEditor.notebookOptions.getLayoutConfiguration();\n\n\t\tif (this.titleToolbar.hasActions) {\n\t\t\treturn layoutInfo.editorToolbarHeight + layoutInfo.cellTopMargin;\n\t\t} else {\n\t\t\treturn layoutInfo.cellTopMargin;\n\t\t}\n\t}\n}\n"],
  "mappings": ";;AAKA,YAAY,SAAS;AACrB,SAAS,mBAAmB;AAC5B,SAAS,gBAAgB;AAQzB,SAAS,uBAAuB;AAGzB,MAAM,2BAA2B,gBAAgB;AAAA,EAIvD,YACU,gBACA,cACA,KACA,MACA,OACA,QACR;AACD,UAAM;AAPG;AACA;AACA;AACA;AACA;AACA;AAIT,SAAK,qBAAqB,IAAI;AAAA,MAC7B,IAAI;AAAA,QACH,KAAK,KAAK;AAAA,QACV,IAAI;AAAA,UACH;AAAA,UACA;AAAA,UACA,IAAI,EAAE,kDAAkD;AAAA,QACzD;AAAA,MACD;AAAA,IACD;AAEA,SAAK,uBAAuB,IAAI;AAAA,MAC/B,IAAI;AAAA,QACH,KAAK,KAAK;AAAA,QACV,IAAI;AAAA,UACH;AAAA,UACA;AAAA,UACA,IAAI,EAAE,oDAAoD;AAAA,QAC3D;AAAA,MACD;AAAA,IACD;AAEA,SAAK;AAAA,MACJ,IAAI;AAAA,QACH,KAAK,mBAAmB;AAAA,QACxB,IAAI,UAAU;AAAA,QACd,MAAM;AACL,cAAI,KAAK,aAAa;AACrB,iBAAK,YAAY,mBAChB,CAAC,KAAK,YAAY;AAAA,UACpB;AAAA,QACD;AAAA,MACD;AAAA,IACD;AACA,SAAK;AAAA,MACJ,IAAI;AAAA,QACH,KAAK,qBAAqB;AAAA,QAC1B,IAAI,UAAU;AAAA,QACd,MAAM;AACL,cAAI,KAAK,aAAa;AACrB,iBAAK,YAAY,oBAChB,CAAC,KAAK,YAAY;AAAA,UACpB;AAAA,QACD;AAAA,MACD;AAAA,IACD;AAEA,SAAK;AAAA,MACJ,IAAI;AAAA,QACH,KAAK,KAAK;AAAA,QACV,IAAI,UAAU;AAAA,QACd,CAAC,MAAM;AACN,cAAI,CAAC,KAAK,eAAe,CAAC,KAAK,eAAe,SAAS,GAAG;AACzD;AAAA,UACD;AAEA,cAAI,EAAE,WAAW,KAAK,KAAK,SAAS;AAEnC;AAAA,UACD;AAEA,gBAAM,iBACL,EAAE,UACD,KAAK,YAAY,WAChB;AACH,cAAI,gBAAgB;AACnB,iBAAK,YAAY,mBAChB,CAAC,KAAK,YAAY;AAAA,UACpB,OAAO;AACN,iBAAK,YAAY,oBAChB,CAAC,KAAK,YAAY;AAAA,UACpB;AAAA,QACD;AAAA,MACD;AAAA,IACD;AAEA,SAAK;AAAA,MACJ,KAAK,aAAa,mBAAmB,MAAM;AAC1C,aAAK,kCAAkC;AAAA,MACxC,CAAC;AAAA,IACF;AAAA,EACD;AAAA,EAjHD,OAkBwD;AAAA;AAAA;AAAA,EAChD;AAAA,EACA;AAAA,EA+FE,wBAAwB,SAA+B;AAC/D,QAAI,QAAQ,aAAa,SAAS,QAAQ;AACzC,YAAM,mBACL,KAAK,eAAe,gBAAgB;AAAA,QACnC,QAAQ,WAAW;AAAA,QAClB,QAAgC,WAAW;AAAA,QAC5C,KAAK,eAAe,WAAW;AAAA,MAChC;AACD,WAAK,OAAO,QAAQ,MAAM,YAAY,cAAc,iBAAiB,qBAAqB,CAAC;AAC3F,WAAK,KAAK,UAAU,iBAAiB,uBAAuB;AAC5D,WAAK,MAAM,UAAU,iBAAiB,uBAAuB;AAC7D,WAAK,mBAAmB;AAAA,QACvB,iBAAiB,0BAChB,KAAK,sBAAsB,IAAI,IAC/B,QAAQ,WAAW;AAAA,MACrB;AAAA,IACD,OAAO;AACN,YAAM,OAAO;AACb,YAAM,aACL,KAAK,eAAe,gBAAgB,uBAAuB;AAC5D,YAAM,0BACL,KAAK,eAAe,gBAAgB;AAAA,QACnC,KAAK,eAAe,WAAW;AAAA,MAChC;AACD,YAAM,kBACL,KAAK,WAAW,sBAChB,KAAK,WAAW,wBAChB,KAAK,WAAW;AACjB,WAAK,KAAK,UAAU,eAAe;AACnC,WAAK,MAAM,UAAU,eAAe;AACpC,WAAK,mBAAmB;AAAA,QACvB,KAAK,WAAW;AAAA,MACjB;AACA,WAAK,qBAAqB;AAAA,QACzB,KAAK;AAAA,UACJ,KAAK,WAAW,wBACf,KAAK,YAAY,gBAAgB,uBAAuB,EACtD;AAAA,UACH;AAAA,QACD;AAAA,MACD;AACA,WAAK,OAAO,QAAQ,MAAM,YAAY,cAAc,KAAK,WAAW,cAAc,wBAAwB,mBAAmB,WAAW,gBAAgB;AAAA,IACzJ;AAEA,SAAK,kCAAkC;AAAA,EACxC;AAAA,EAEQ,oCAA0C;AACjD,UAAM,KACJ,KAAK,aAAa,WAAW,cAAc,KAC5C,KAAK,sBAAsB;AAC5B,SAAK,KAAK,QAAQ,MAAM,YAAY,cAAc,CAAC;AACnD,SAAK,MAAM,QAAQ,MAAM,YAAY,cAAc,CAAC;AAAA,EACrD;AAAA,EAEQ,wBAAwB;AAC/B,UAAM,aACL,KAAK,eAAe,gBAAgB,uBAAuB;AAE5D,QAAI,KAAK,aAAa,YAAY;AACjC,aAAO,WAAW,sBAAsB,WAAW;AAAA,IACpD,OAAO;AACN,aAAO,WAAW;AAAA,IACnB;AAAA,EACD;AACD;",
  "names": []
}
