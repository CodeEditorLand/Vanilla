{
  "version": 3,
  "sources": ["../../../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/notebook/browser/view/cellParts/cellFocusIndicator.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as DOM from '../../../../../../base/browser/dom.js';\nimport { FastDomNode } from '../../../../../../base/browser/fastDomNode.js';\nimport { CodeCellLayoutInfo, ICellViewModel, INotebookEditorDelegate } from '../../notebookBrowser.js';\nimport { CellContentPart } from '../cellPart.js';\nimport { CellTitleToolbarPart } from './cellToolbars.js';\nimport { CodeCellViewModel } from '../../viewModel/codeCellViewModel.js';\nimport { MarkupCellViewModel } from '../../viewModel/markupCellViewModel.js';\nimport { CellKind } from '../../../common/notebookCommon.js';\n\nexport class CellFocusIndicator extends CellContentPart {\n\tpublic codeFocusIndicator: FastDomNode<HTMLElement>;\n\tpublic outputFocusIndicator: FastDomNode<HTMLElement>;\n\n\tconstructor(\n\t\treadonly notebookEditor: INotebookEditorDelegate,\n\t\treadonly titleToolbar: CellTitleToolbarPart,\n\t\treadonly top: FastDomNode<HTMLElement>,\n\t\treadonly left: FastDomNode<HTMLElement>,\n\t\treadonly right: FastDomNode<HTMLElement>,\n\t\treadonly bottom: FastDomNode<HTMLElement>\n\t) {\n\t\tsuper();\n\n\t\tthis.codeFocusIndicator = new FastDomNode(DOM.append(\n\t\t\tthis.left.domNode,\n\t\t\tDOM.$(\n\t\t\t\t'.codeOutput-focus-indicator-container',\n\t\t\t\tundefined,\n\t\t\t\tDOM.$('.codeOutput-focus-indicator.code-focus-indicator'))));\n\n\t\tthis.outputFocusIndicator = new FastDomNode(DOM.append(\n\t\t\tthis.left.domNode,\n\t\t\tDOM.$(\n\t\t\t\t'.codeOutput-focus-indicator-container',\n\t\t\t\tundefined,\n\t\t\t\tDOM.$('.codeOutput-focus-indicator.output-focus-indicator'))));\n\n\t\tthis._register(DOM.addDisposableListener(this.codeFocusIndicator.domNode, DOM.EventType.CLICK, () => {\n\t\t\tif (this.currentCell) {\n\t\t\t\tthis.currentCell.isInputCollapsed = !this.currentCell.isInputCollapsed;\n\t\t\t}\n\t\t}));\n\t\tthis._register(DOM.addDisposableListener(this.outputFocusIndicator.domNode, DOM.EventType.CLICK, () => {\n\t\t\tif (this.currentCell) {\n\t\t\t\tthis.currentCell.isOutputCollapsed = !this.currentCell.isOutputCollapsed;\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(DOM.addDisposableListener(this.left.domNode, DOM.EventType.DBLCLICK, e => {\n\t\t\tif (!this.currentCell || !this.notebookEditor.hasModel()) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (e.target !== this.left.domNode) {\n\t\t\t\t// Don't allow dblclick on the codeFocusIndicator/outputFocusIndicator\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst clickedOnInput = e.offsetY < (this.currentCell.layoutInfo as CodeCellLayoutInfo).outputContainerOffset;\n\t\t\tif (clickedOnInput) {\n\t\t\t\tthis.currentCell.isInputCollapsed = !this.currentCell.isInputCollapsed;\n\t\t\t} else {\n\t\t\t\tthis.currentCell.isOutputCollapsed = !this.currentCell.isOutputCollapsed;\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(this.titleToolbar.onDidUpdateActions(() => {\n\t\t\tthis.updateFocusIndicatorsForTitleMenu();\n\t\t}));\n\t}\n\n\toverride updateInternalLayoutNow(element: ICellViewModel): void {\n\t\tif (element.cellKind === CellKind.Markup) {\n\t\t\tconst indicatorPostion = this.notebookEditor.notebookOptions.computeIndicatorPosition(element.layoutInfo.totalHeight, (element as MarkupCellViewModel).layoutInfo.foldHintHeight, this.notebookEditor.textModel?.viewType);\n\t\t\tthis.bottom.domNode.style.transform = `translateY(${indicatorPostion.bottomIndicatorTop + 6}px)`;\n\t\t\tthis.left.setHeight(indicatorPostion.verticalIndicatorHeight);\n\t\t\tthis.right.setHeight(indicatorPostion.verticalIndicatorHeight);\n\t\t\tthis.codeFocusIndicator.setHeight(indicatorPostion.verticalIndicatorHeight - this.getIndicatorTopMargin() * 2 - element.layoutInfo.chatHeight);\n\t\t} else {\n\t\t\tconst cell = element as CodeCellViewModel;\n\t\t\tconst layoutInfo = this.notebookEditor.notebookOptions.getLayoutConfiguration();\n\t\t\tconst bottomToolbarDimensions = this.notebookEditor.notebookOptions.computeBottomToolbarDimensions(this.notebookEditor.textModel?.viewType);\n\t\t\tconst indicatorHeight = cell.layoutInfo.codeIndicatorHeight + cell.layoutInfo.outputIndicatorHeight + cell.layoutInfo.commentHeight;\n\t\t\tthis.left.setHeight(indicatorHeight);\n\t\t\tthis.right.setHeight(indicatorHeight);\n\t\t\tthis.codeFocusIndicator.setHeight(cell.layoutInfo.codeIndicatorHeight);\n\t\t\tthis.outputFocusIndicator.setHeight(Math.max(cell.layoutInfo.outputIndicatorHeight - cell.viewContext.notebookOptions.getLayoutConfiguration().focusIndicatorGap, 0));\n\t\t\tthis.bottom.domNode.style.transform = `translateY(${cell.layoutInfo.totalHeight - bottomToolbarDimensions.bottomToolbarGap - layoutInfo.cellBottomMargin}px)`;\n\t\t}\n\n\t\tthis.updateFocusIndicatorsForTitleMenu();\n\t}\n\n\tprivate updateFocusIndicatorsForTitleMenu(): void {\n\t\tconst y = (this.currentCell?.layoutInfo.chatHeight ?? 0) + this.getIndicatorTopMargin();\n\t\tthis.left.domNode.style.transform = `translateY(${y}px)`;\n\t\tthis.right.domNode.style.transform = `translateY(${y}px)`;\n\t}\n\n\tprivate getIndicatorTopMargin() {\n\t\tconst layoutInfo = this.notebookEditor.notebookOptions.getLayoutConfiguration();\n\n\t\tif (this.titleToolbar.hasActions) {\n\t\t\treturn layoutInfo.editorToolbarHeight + layoutInfo.cellTopMargin;\n\t\t} else {\n\t\t\treturn layoutInfo.cellTopMargin;\n\t\t}\n\t}\n}\n"],
  "mappings": ";;AAKA,YAAY,SAAS;AACrB,SAAS,mBAAmB;AAC5B,SAAS,oBAAoB,gBAAgB,+BAA+B;AAC5E,SAAS,uBAAuB;AAChC,SAAS,4BAA4B;AACrC,SAAS,yBAAyB;AAClC,SAAS,2BAA2B;AACpC,SAAS,gBAAgB;AAElB,MAAM,2BAA2B,gBAAgB;AAAA,EAIvD,YACU,gBACA,cACA,KACA,MACA,OACA,QACR;AACD,UAAM;AAPG;AACA;AACA;AACA;AACA;AACA;AAIT,SAAK,qBAAqB,IAAI,YAAY,IAAI;AAAA,MAC7C,KAAK,KAAK;AAAA,MACV,IAAI;AAAA,QACH;AAAA,QACA;AAAA,QACA,IAAI,EAAE,kDAAkD;AAAA,MAAC;AAAA,IAAC,CAAC;AAE7D,SAAK,uBAAuB,IAAI,YAAY,IAAI;AAAA,MAC/C,KAAK,KAAK;AAAA,MACV,IAAI;AAAA,QACH;AAAA,QACA;AAAA,QACA,IAAI,EAAE,oDAAoD;AAAA,MAAC;AAAA,IAAC,CAAC;AAE/D,SAAK,UAAU,IAAI,sBAAsB,KAAK,mBAAmB,SAAS,IAAI,UAAU,OAAO,MAAM;AACpG,UAAI,KAAK,aAAa;AACrB,aAAK,YAAY,mBAAmB,CAAC,KAAK,YAAY;AAAA,MACvD;AAAA,IACD,CAAC,CAAC;AACF,SAAK,UAAU,IAAI,sBAAsB,KAAK,qBAAqB,SAAS,IAAI,UAAU,OAAO,MAAM;AACtG,UAAI,KAAK,aAAa;AACrB,aAAK,YAAY,oBAAoB,CAAC,KAAK,YAAY;AAAA,MACxD;AAAA,IACD,CAAC,CAAC;AAEF,SAAK,UAAU,IAAI,sBAAsB,KAAK,KAAK,SAAS,IAAI,UAAU,UAAU,OAAK;AACxF,UAAI,CAAC,KAAK,eAAe,CAAC,KAAK,eAAe,SAAS,GAAG;AACzD;AAAA,MACD;AAEA,UAAI,EAAE,WAAW,KAAK,KAAK,SAAS;AAEnC;AAAA,MACD;AAEA,YAAM,iBAAiB,EAAE,UAAW,KAAK,YAAY,WAAkC;AACvF,UAAI,gBAAgB;AACnB,aAAK,YAAY,mBAAmB,CAAC,KAAK,YAAY;AAAA,MACvD,OAAO;AACN,aAAK,YAAY,oBAAoB,CAAC,KAAK,YAAY;AAAA,MACxD;AAAA,IACD,CAAC,CAAC;AAEF,SAAK,UAAU,KAAK,aAAa,mBAAmB,MAAM;AACzD,WAAK,kCAAkC;AAAA,IACxC,CAAC,CAAC;AAAA,EACH;AAAA,EA1ED,OAcwD;AAAA;AAAA;AAAA,EAChD;AAAA,EACA;AAAA,EA4DE,wBAAwB,SAA+B;AAC/D,QAAI,QAAQ,aAAa,SAAS,QAAQ;AACzC,YAAM,mBAAmB,KAAK,eAAe,gBAAgB,yBAAyB,QAAQ,WAAW,aAAc,QAAgC,WAAW,gBAAgB,KAAK,eAAe,WAAW,QAAQ;AACzN,WAAK,OAAO,QAAQ,MAAM,YAAY,cAAc,iBAAiB,qBAAqB,CAAC;AAC3F,WAAK,KAAK,UAAU,iBAAiB,uBAAuB;AAC5D,WAAK,MAAM,UAAU,iBAAiB,uBAAuB;AAC7D,WAAK,mBAAmB,UAAU,iBAAiB,0BAA0B,KAAK,sBAAsB,IAAI,IAAI,QAAQ,WAAW,UAAU;AAAA,IAC9I,OAAO;AACN,YAAM,OAAO;AACb,YAAM,aAAa,KAAK,eAAe,gBAAgB,uBAAuB;AAC9E,YAAM,0BAA0B,KAAK,eAAe,gBAAgB,+BAA+B,KAAK,eAAe,WAAW,QAAQ;AAC1I,YAAM,kBAAkB,KAAK,WAAW,sBAAsB,KAAK,WAAW,wBAAwB,KAAK,WAAW;AACtH,WAAK,KAAK,UAAU,eAAe;AACnC,WAAK,MAAM,UAAU,eAAe;AACpC,WAAK,mBAAmB,UAAU,KAAK,WAAW,mBAAmB;AACrE,WAAK,qBAAqB,UAAU,KAAK,IAAI,KAAK,WAAW,wBAAwB,KAAK,YAAY,gBAAgB,uBAAuB,EAAE,mBAAmB,CAAC,CAAC;AACpK,WAAK,OAAO,QAAQ,MAAM,YAAY,cAAc,KAAK,WAAW,cAAc,wBAAwB,mBAAmB,WAAW,gBAAgB;AAAA,IACzJ;AAEA,SAAK,kCAAkC;AAAA,EACxC;AAAA,EAEQ,oCAA0C;AACjD,UAAM,KAAK,KAAK,aAAa,WAAW,cAAc,KAAK,KAAK,sBAAsB;AACtF,SAAK,KAAK,QAAQ,MAAM,YAAY,cAAc,CAAC;AACnD,SAAK,MAAM,QAAQ,MAAM,YAAY,cAAc,CAAC;AAAA,EACrD;AAAA,EAEQ,wBAAwB;AAC/B,UAAM,aAAa,KAAK,eAAe,gBAAgB,uBAAuB;AAE9E,QAAI,KAAK,aAAa,YAAY;AACjC,aAAO,WAAW,sBAAsB,WAAW;AAAA,IACpD,OAAO;AACN,aAAO,WAAW;AAAA,IACnB;AAAA,EACD;AACD;",
  "names": []
}
