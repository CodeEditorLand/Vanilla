{
  "version": 3,
  "sources": ["../../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/notebook/browser/viewParts/notebookKernelView.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { ActionViewItem, IActionViewItemOptions } from '../../../../../base/browser/ui/actionbar/actionViewItems.js';\nimport { Action, IAction } from '../../../../../base/common/actions.js';\nimport { Event } from '../../../../../base/common/event.js';\nimport { localize, localize2 } from '../../../../../nls.js';\nimport { Action2, MenuId, registerAction2 } from '../../../../../platform/actions/common/actions.js';\nimport { ContextKeyExpr, IContextKeyService } from '../../../../../platform/contextkey/common/contextkey.js';\nimport { ExtensionIdentifier } from '../../../../../platform/extensions/common/extensions.js';\nimport { IInstantiationService, ServicesAccessor } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { ThemeIcon } from '../../../../../base/common/themables.js';\nimport { NOTEBOOK_ACTIONS_CATEGORY, SELECT_KERNEL_ID } from '../controller/coreActions.js';\nimport { getNotebookEditorFromEditorPane, INotebookEditor } from '../notebookBrowser.js';\nimport { selectKernelIcon } from '../notebookIcons.js';\nimport { KernelPickerMRUStrategy, KernelQuickPickContext } from './notebookKernelQuickPickStrategy.js';\nimport { NotebookTextModel } from '../../common/model/notebookTextModel.js';\nimport { NOTEBOOK_IS_ACTIVE_EDITOR, NOTEBOOK_KERNEL_COUNT } from '../../common/notebookContextKeys.js';\nimport { INotebookKernelHistoryService, INotebookKernelService } from '../../common/notebookKernelService.js';\nimport { IEditorService } from '../../../../services/editor/common/editorService.js';\n\nfunction getEditorFromContext(editorService: IEditorService, context?: KernelQuickPickContext): INotebookEditor | undefined {\n\tlet editor: INotebookEditor | undefined;\n\tif (context !== undefined && 'notebookEditorId' in context) {\n\t\tconst editorId = context.notebookEditorId;\n\t\tconst matchingEditor = editorService.visibleEditorPanes.find((editorPane) => {\n\t\t\tconst notebookEditor = getNotebookEditorFromEditorPane(editorPane);\n\t\t\treturn notebookEditor?.getId() === editorId;\n\t\t});\n\t\teditor = getNotebookEditorFromEditorPane(matchingEditor);\n\t} else if (context !== undefined && 'notebookEditor' in context) {\n\t\teditor = context?.notebookEditor;\n\t} else {\n\t\teditor = getNotebookEditorFromEditorPane(editorService.activeEditorPane);\n\t}\n\n\treturn editor;\n}\n\nregisterAction2(class extends Action2 {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: SELECT_KERNEL_ID,\n\t\t\tcategory: NOTEBOOK_ACTIONS_CATEGORY,\n\t\t\ttitle: localize2('notebookActions.selectKernel', 'Select Notebook Kernel'),\n\t\t\ticon: selectKernelIcon,\n\t\t\tf1: true,\n\t\t\tprecondition: NOTEBOOK_IS_ACTIVE_EDITOR,\n\t\t\tmenu: [{\n\t\t\t\tid: MenuId.EditorTitle,\n\t\t\t\twhen: ContextKeyExpr.and(\n\t\t\t\t\tNOTEBOOK_IS_ACTIVE_EDITOR,\n\t\t\t\t\tContextKeyExpr.notEquals('config.notebook.globalToolbar', true)\n\t\t\t\t),\n\t\t\t\tgroup: 'navigation',\n\t\t\t\torder: -10\n\t\t\t}, {\n\t\t\t\tid: MenuId.NotebookToolbar,\n\t\t\t\twhen: ContextKeyExpr.equals('config.notebook.globalToolbar', true),\n\t\t\t\tgroup: 'status',\n\t\t\t\torder: -10\n\t\t\t}, {\n\t\t\t\tid: MenuId.InteractiveToolbar,\n\t\t\t\twhen: NOTEBOOK_KERNEL_COUNT.notEqualsTo(0),\n\t\t\t\tgroup: 'status',\n\t\t\t\torder: -10\n\t\t\t}],\n\t\t\tmetadata: {\n\t\t\t\tdescription: localize('notebookActions.selectKernel.args', \"Notebook Kernel Args\"),\n\t\t\t\targs: [\n\t\t\t\t\t{\n\t\t\t\t\t\tname: 'kernelInfo',\n\t\t\t\t\t\tdescription: 'The kernel info',\n\t\t\t\t\t\tschema: {\n\t\t\t\t\t\t\t'type': 'object',\n\t\t\t\t\t\t\t'required': ['id', 'extension'],\n\t\t\t\t\t\t\t'properties': {\n\t\t\t\t\t\t\t\t'id': {\n\t\t\t\t\t\t\t\t\t'type': 'string'\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t'extension': {\n\t\t\t\t\t\t\t\t\t'type': 'string'\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t'notebookEditorId': {\n\t\t\t\t\t\t\t\t\t'type': 'string'\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t});\n\t}\n\n\tasync run(accessor: ServicesAccessor, context?: KernelQuickPickContext): Promise<boolean> {\n\t\tconst instantiationService = accessor.get(IInstantiationService);\n\t\tconst editorService = accessor.get(IEditorService);\n\n\t\tconst editor = getEditorFromContext(editorService, context);\n\n\t\tif (!editor || !editor.hasModel()) {\n\t\t\treturn false;\n\t\t}\n\n\t\tlet controllerId = context && 'id' in context ? context.id : undefined;\n\t\tlet extensionId = context && 'extension' in context ? context.extension : undefined;\n\n\t\tif (controllerId && (typeof controllerId !== 'string' || typeof extensionId !== 'string')) {\n\t\t\t// validate context: id & extension MUST be strings\n\t\t\tcontrollerId = undefined;\n\t\t\textensionId = undefined;\n\t\t}\n\n\t\tconst notebook = editor.textModel;\n\t\tconst notebookKernelService = accessor.get(INotebookKernelService);\n\t\tconst matchResult = notebookKernelService.getMatchingKernel(notebook);\n\t\tconst { selected } = matchResult;\n\n\t\tif (selected && controllerId && selected.id === controllerId && ExtensionIdentifier.equals(selected.extension, extensionId)) {\n\t\t\t// current kernel is wanted kernel -> done\n\t\t\treturn true;\n\t\t}\n\n\t\tconst wantedKernelId = controllerId ? `${extensionId}/${controllerId}` : undefined;\n\t\tconst strategy = instantiationService.createInstance(KernelPickerMRUStrategy);\n\t\treturn strategy.showQuickPick(editor, wantedKernelId);\n\t}\n});\n\nexport class NotebooKernelActionViewItem extends ActionViewItem {\n\n\tprivate _kernelLabel?: HTMLAnchorElement;\n\n\tconstructor(\n\t\tactualAction: IAction,\n\t\tprivate readonly _editor: { onDidChangeModel: Event<void>; textModel: NotebookTextModel | undefined; scopedContextKeyService?: IContextKeyService } | INotebookEditor,\n\t\toptions: IActionViewItemOptions,\n\t\t@INotebookKernelService private readonly _notebookKernelService: INotebookKernelService,\n\t\t@INotebookKernelHistoryService private readonly _notebookKernelHistoryService: INotebookKernelHistoryService,\n\t) {\n\t\tsuper(\n\t\t\tundefined,\n\t\t\tnew Action('fakeAction', undefined, ThemeIcon.asClassName(selectKernelIcon), true, (event) => actualAction.run(event)),\n\t\t\t{ ...options, label: false, icon: true }\n\t\t);\n\t\tthis._register(_editor.onDidChangeModel(this._update, this));\n\t\tthis._register(_notebookKernelService.onDidAddKernel(this._update, this));\n\t\tthis._register(_notebookKernelService.onDidRemoveKernel(this._update, this));\n\t\tthis._register(_notebookKernelService.onDidChangeNotebookAffinity(this._update, this));\n\t\tthis._register(_notebookKernelService.onDidChangeSelectedNotebooks(this._update, this));\n\t\tthis._register(_notebookKernelService.onDidChangeSourceActions(this._update, this));\n\t\tthis._register(_notebookKernelService.onDidChangeKernelDetectionTasks(this._update, this));\n\t}\n\n\toverride render(container: HTMLElement): void {\n\t\tthis._update();\n\t\tsuper.render(container);\n\t\tcontainer.classList.add('kernel-action-view-item');\n\t\tthis._kernelLabel = document.createElement('a');\n\t\tcontainer.appendChild(this._kernelLabel);\n\t\tthis.updateLabel();\n\t}\n\n\tprotected override updateLabel() {\n\t\tif (this._kernelLabel) {\n\t\t\tthis._kernelLabel.classList.add('kernel-label');\n\t\t\tthis._kernelLabel.innerText = this._action.label;\n\t\t}\n\t}\n\n\tprotected _update(): void {\n\t\tconst notebook = this._editor.textModel;\n\n\t\tif (!notebook) {\n\t\t\tthis._resetAction();\n\t\t\treturn;\n\t\t}\n\n\t\tKernelPickerMRUStrategy.updateKernelStatusAction(notebook, this._action, this._notebookKernelService, this._notebookKernelHistoryService);\n\n\t\tthis.updateClass();\n\t}\n\n\tprivate _resetAction(): void {\n\t\tthis._action.enabled = false;\n\t\tthis._action.label = '';\n\t\tthis._action.class = '';\n\t}\n}\n"],
  "mappings": "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",
  "names": []
}
