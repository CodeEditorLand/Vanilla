var m=Object.defineProperty;var u=Object.getOwnPropertyDescriptor;var h=(a,s,n,o)=>{for(var e=o>1?void 0:o?u(s,n):s,t=a.length-1,r;t>=0;t--)(r=a[t])&&(e=(o?r(s,n,e):r(e))||e);return o&&e&&m(s,n,e),e},l=(a,s)=>(n,o)=>s(n,o,a);import*as d from"../../../../../../vs/base/browser/dom.js";import{Disposable as v,DisposableStore as b,MutableDisposable as k}from"../../../../../../vs/base/common/lifecycle.js";import{HiddenItemStrategy as g,MenuWorkbenchToolBar as T}from"../../../../../../vs/platform/actions/browser/toolbar.js";import{IMenuService as C,MenuItemAction as I}from"../../../../../../vs/platform/actions/common/actions.js";import{IContextMenuService as f}from"../../../../../../vs/platform/contextview/browser/contextView.js";import{IInstantiationService as E}from"../../../../../../vs/platform/instantiation/common/instantiation.js";import"../../../../../../vs/workbench/contrib/notebook/browser/controller/coreActions.js";import"../../../../../../vs/workbench/contrib/notebook/browser/notebookBrowser.js";import"../../../../../../vs/workbench/contrib/notebook/browser/notebookOptions.js";import{CodiconActionViewItem as M}from"../../../../../../vs/workbench/contrib/notebook/browser/view/cellParts/cellActionView.js";let p=class extends v{constructor(n,o,e,t,r){super();this.notebookEditor=n;this.notebookOptions=o;this.instantiationService=e;this.contextMenuService=t;this.menuService=r;this.topCellToolbarContainer=d.$("div"),this.topCellToolbar=d.$(".cell-list-top-cell-toolbar-container"),this.topCellToolbarContainer.appendChild(this.topCellToolbar),this._register(this.notebookEditor.onDidAttachViewModel(()=>{this.updateTopToolbar()})),this._register(this.notebookOptions.onDidChangeOptions(i=>{(i.insertToolbarAlignment||i.insertToolbarPosition||i.cellToolbarLocation)&&this.updateTopToolbar()}))}topCellToolbarContainer;topCellToolbar;viewZone=this._register(new k);_modelDisposables=this._register(new b);updateTopToolbar(){const n=this.notebookOptions.getLayoutConfiguration();if(this.viewZone.value=new b,n.insertToolbarPosition==="hidden"||n.insertToolbarPosition==="notebookToolbar"){const o=this.notebookOptions.computeTopInsertToolbarHeight(this.notebookEditor.textModel?.viewType);o!==0&&this.notebookEditor.changeViewZones(e=>{const t=e.addZone({afterModelPosition:0,heightInPx:o,domNode:d.$("div")});e.layoutZone(t),this.viewZone.value?.add({dispose:()=>{this.notebookEditor.isDisposed||this.notebookEditor.changeViewZones(r=>{r.removeZone(t)})}})});return}this.notebookEditor.changeViewZones(o=>{const e=this.notebookOptions.computeTopInsertToolbarHeight(this.notebookEditor.textModel?.viewType),t=o.addZone({afterModelPosition:0,heightInPx:e,domNode:this.topCellToolbarContainer});o.layoutZone(t),this.viewZone.value?.add({dispose:()=>{this.notebookEditor.isDisposed||this.notebookEditor.changeViewZones(i=>{i.removeZone(t)})}}),d.clearNode(this.topCellToolbar);const r=this.instantiationService.createInstance(T,this.topCellToolbar,this.notebookEditor.creationOptions.menuIds.cellTopInsertToolbar,{actionViewItemProvider:(i,c)=>{if(i instanceof I)return this.instantiationService.createInstance(M,i,{hoverDelegate:c.hoverDelegate})},menuOptions:{shouldForwardArgs:!0},toolbarOptions:{primaryGroup:i=>/^inline/.test(i)},hiddenItemStrategy:g.Ignore});this.notebookEditor.hasModel()&&(r.context={notebookEditor:this.notebookEditor}),this.viewZone.value?.add(r),this.viewZone.value?.add(this.notebookEditor.onDidChangeModel(()=>{this._modelDisposables.clear(),this.notebookEditor.hasModel()&&(this._modelDisposables.add(this.notebookEditor.onDidChangeViewCells(()=>{this.updateClass()})),this.updateClass())})),this.updateClass()})}updateClass(){this.notebookEditor.hasModel()&&this.notebookEditor.getLength()===0?this.topCellToolbar.classList.add("emptyNotebook"):this.topCellToolbar.classList.remove("emptyNotebook")}};p=h([l(2,E),l(3,f),l(4,C)],p);export{p as ListTopCellToolbar};
