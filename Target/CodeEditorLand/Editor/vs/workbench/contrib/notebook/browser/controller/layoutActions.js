import{Codicon as v}from"../../../../../base/common/codicons.js";import{DisposableStore as T}from"../../../../../base/common/lifecycle.js";import{URI as N}from"../../../../../base/common/uri.js";import{localize as u,localize2 as r}from"../../../../../nls.js";import{Categories as E}from"../../../../../platform/action/common/actionCommonCategories.js";import{Action2 as c,MenuId as t,MenuRegistry as C,registerAction2 as l}from"../../../../../platform/actions/common/actions.js";import{ICommandService as m}from"../../../../../platform/commands/common/commands.js";import{ConfigurationTarget as p,IConfigurationService as w}from"../../../../../platform/configuration/common/configuration.js";import{ContextKeyExpr as i}from"../../../../../platform/contextkey/common/contextkey.js";import"../../../../../platform/instantiation/common/instantiation.js";import{IQuickInputService as L}from"../../../../../platform/quickinput/common/quickInput.js";import{NOTEBOOK_ACTIONS_CATEGORY as g}from"./coreActions.js";import{getNotebookEditorFromEditorPane as h}from"../notebookBrowser.js";import{INotebookEditorService as I}from"../services/notebookEditorService.js";import{NotebookSetting as f}from"../../common/notebookCommon.js";import{NOTEBOOK_EDITOR_FOCUSED as A,NOTEBOOK_IS_ACTIVE_EDITOR as d}from"../../common/notebookContextKeys.js";import{INotebookService as O}from"../../common/notebookService.js";import{IEditorService as P}from"../../../../services/editor/common/editorService.js";import{IPreferencesService as y}from"../../../../services/preferences/common/preferences.js";l(class extends c{constructor(){super({id:"workbench.notebook.layout.select",title:r("workbench.notebook.layout.select.label","Select between Notebook Layouts"),f1:!0,precondition:i.equals(`config.${f.openGettingStarted}`,!0),category:g,menu:[{id:t.EditorTitle,group:"notebookLayout",when:i.and(d,i.notEquals("config.notebook.globalToolbar",!0),i.equals(`config.${f.openGettingStarted}`,!0)),order:0},{id:t.NotebookToolbar,group:"notebookLayout",when:i.and(i.equals("config.notebook.globalToolbar",!0),i.equals(`config.${f.openGettingStarted}`,!0)),order:0}]})}run(o){o.get(m).executeCommand("workbench.action.openWalkthrough",{category:"notebooks",step:"notebookProfile"},!0)}}),l(class extends c{constructor(){super({id:"workbench.notebook.layout.configure",title:r("workbench.notebook.layout.configure.label","Customize Notebook Layout"),f1:!0,category:g,menu:[{id:t.NotebookToolbar,group:"notebookLayout",when:i.equals("config.notebook.globalToolbar",!0),order:1}]})}run(o){o.get(y).openSettings({jsonEditor:!1,query:"@tag:notebookLayout"})}}),l(class extends c{constructor(){super({id:"workbench.notebook.layout.configure.editorTitle",title:r("workbench.notebook.layout.configure.label","Customize Notebook Layout"),f1:!1,category:g,menu:[{id:t.NotebookEditorLayoutConfigure,group:"notebookLayout",when:d,order:1}]})}run(o){o.get(y).openSettings({jsonEditor:!1,query:"@tag:notebookLayout"})}}),C.appendMenuItem(t.EditorTitle,{submenu:t.NotebookEditorLayoutConfigure,rememberDefaultAction:!1,title:r("customizeNotebook","Customize Notebook..."),icon:v.gear,group:"navigation",order:-1,when:d}),l(class extends c{constructor(){super({id:"notebook.toggleLineNumbersFromEditorTitle",title:r("notebook.toggleLineNumbers","Toggle Notebook Line Numbers"),precondition:A,menu:[{id:t.NotebookEditorLayoutConfigure,group:"notebookLayoutDetails",order:1,when:d}],category:g,f1:!0,toggled:{condition:i.notEquals("config.notebook.lineNumbers","off"),title:u("notebook.showLineNumbers","Notebook Line Numbers")}})}async run(o){return o.get(m).executeCommand("notebook.toggleLineNumbers")}}),l(class extends c{constructor(){super({id:"notebook.toggleCellToolbarPositionFromEditorTitle",title:r("notebook.toggleCellToolbarPosition","Toggle Cell Toolbar Position"),menu:[{id:t.NotebookEditorLayoutConfigure,group:"notebookLayoutDetails",order:3}],category:g,f1:!1})}async run(o,...n){return o.get(m).executeCommand("notebook.toggleCellToolbarPosition",...n)}}),l(class extends c{constructor(){super({id:"breadcrumbs.toggleFromEditorTitle",title:r("notebook.toggleBreadcrumb","Toggle Breadcrumbs"),menu:[{id:t.NotebookEditorLayoutConfigure,group:"notebookLayoutDetails",order:2}],f1:!1})}async run(o){return o.get(m).executeCommand("breadcrumbs.toggle")}}),l(class extends c{constructor(){super({id:"notebook.saveMimeTypeOrder",title:r("notebook.saveMimeTypeOrder","Save Mimetype Display Order"),f1:!0,category:g,precondition:d})}run(o){const n=o.get(O),a=new T,e=a.add(o.get(L).createQuickPick());e.placeholder=u("notebook.placeholder","Settings file to save in"),e.items=[{target:p.USER,label:u("saveTarget.machine","User Settings")},{target:p.WORKSPACE,label:u("saveTarget.workspace","Workspace Settings")}],a.add(e.onDidAccept(()=>{const k=e.selectedItems[0]?.target;k!==void 0&&n.saveMimeDisplayOrder(k),e.dispose()})),a.add(e.onDidHide(()=>a.dispose())),e.show()}}),l(class extends c{constructor(){super({id:"workbench.notebook.layout.webview.reset",title:r("workbench.notebook.layout.webview.reset.label","Reset Notebook Webview"),f1:!1,category:g})}run(o,n){const a=o.get(P);if(n){const e=N.revive(n),S=o.get(I).listNotebookEditors().filter(b=>b.hasModel()&&b.textModel.uri.toString()===e.toString());for(const b of S)b.hasModel()&&b.getInnerWebview()?.reload()}else{const e=h(a.activeEditorPane);if(!e)return;e.getInnerWebview()?.reload()}}}),l(class extends c{constructor(){super({id:"notebook.action.toggleNotebookStickyScroll",title:{...r("toggleStickyScroll","Toggle Notebook Sticky Scroll"),mnemonicTitle:u({key:"mitoggleNotebookStickyScroll",comment:["&& denotes a mnemonic"]},"&&Toggle Notebook Sticky Scroll")},category:E.View,toggled:{condition:i.equals("config.notebook.stickyScroll.enabled",!0),title:u("notebookStickyScroll","Toggle Notebook Sticky Scroll"),mnemonicTitle:u({key:"mitoggleNotebookStickyScroll",comment:["&& denotes a mnemonic"]},"&&Toggle Notebook Sticky Scroll")},menu:[{id:t.CommandPalette},{id:t.NotebookStickyScrollContext,group:"notebookView",order:2}]})}async run(o){const n=o.get(w),a=!n.getValue("notebook.stickyScroll.enabled");return n.updateValue("notebook.stickyScroll.enabled",a)}});
