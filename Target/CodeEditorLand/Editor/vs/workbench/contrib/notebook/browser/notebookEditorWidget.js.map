{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/notebook/browser/notebookEditorWidget.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport './media/notebook.css';\nimport './media/notebookCellChat.css';\nimport './media/notebookCellEditorHint.css';\nimport './media/notebookCellInsertToolbar.css';\nimport './media/notebookCellStatusBar.css';\nimport './media/notebookCellTitleToolbar.css';\nimport './media/notebookFocusIndicator.css';\nimport './media/notebookToolbar.css';\nimport './media/notebookDnd.css';\nimport './media/notebookFolding.css';\nimport './media/notebookCellOutput.css';\nimport './media/notebookEditorStickyScroll.css';\nimport './media/notebookKernelActionViewItem.css';\nimport './media/notebookOutline.css';\nimport * as DOM from '../../../../base/browser/dom.js';\nimport { IMouseWheelEvent, StandardMouseEvent } from '../../../../base/browser/mouseEvent.js';\nimport { IListContextMenuEvent } from '../../../../base/browser/ui/list/list.js';\nimport { mainWindow } from '../../../../base/browser/window.js';\nimport { DeferredPromise, SequencerByKey } from '../../../../base/common/async.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { Color, RGBA } from '../../../../base/common/color.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { Emitter, Event } from '../../../../base/common/event.js';\nimport { combinedDisposable, Disposable, DisposableStore, dispose, IDisposable, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { setTimeout0 } from '../../../../base/common/platform.js';\nimport { extname, isEqual } from '../../../../base/common/resources.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { generateUuid } from '../../../../base/common/uuid.js';\nimport { FontMeasurements } from '../../../../editor/browser/config/fontMeasurements.js';\nimport { ICodeEditor } from '../../../../editor/browser/editorBrowser.js';\nimport { IEditorOptions } from '../../../../editor/common/config/editorOptions.js';\nimport { BareFontInfo, FontInfo } from '../../../../editor/common/config/fontInfo.js';\nimport { Range } from '../../../../editor/common/core/range.js';\nimport { Selection } from '../../../../editor/common/core/selection.js';\nimport { SuggestController } from '../../../../editor/contrib/suggest/browser/suggestController.js';\nimport * as nls from '../../../../nls.js';\nimport { MenuId } from '../../../../platform/actions/common/actions.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IContextKey, IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IContextMenuService } from '../../../../platform/contextview/browser/contextView.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { ServiceCollection } from '../../../../platform/instantiation/common/serviceCollection.js';\nimport { ILayoutService } from '../../../../platform/layout/browser/layoutService.js';\nimport { registerZIndex, ZIndex } from '../../../../platform/layout/browser/zIndexRegistry.js';\nimport { IEditorProgressService, IProgressRunner } from '../../../../platform/progress/common/progress.js';\nimport { ITelemetryService } from '../../../../platform/telemetry/common/telemetry.js';\nimport { contrastBorder, errorForeground, focusBorder, foreground, listInactiveSelectionBackground, registerColor, scrollbarSliderActiveBackground, scrollbarSliderBackground, scrollbarSliderHoverBackground, transparent } from '../../../../platform/theme/common/colorRegistry.js';\nimport { EDITOR_PANE_BACKGROUND, PANEL_BORDER, SIDE_BAR_BACKGROUND } from '../../../common/theme.js';\nimport { debugIconStartForeground } from '../../debug/browser/debugColors.js';\nimport { CellEditState, CellFindMatchWithIndex, CellFocusMode, CellLayoutContext, CellRevealRangeType, CellRevealType, IActiveNotebookEditorDelegate, IBaseCellEditorOptions, ICellOutputViewModel, ICellViewModel, ICommonCellInfo, IDisplayOutputLayoutUpdateRequest, IFocusNotebookCellOptions, IInsetRenderOutput, IModelDecorationsChangeAccessor, INotebookDeltaDecoration, INotebookEditor, INotebookEditorContribution, INotebookEditorContributionDescription, INotebookEditorCreationOptions, INotebookEditorDelegate, INotebookEditorMouseEvent, INotebookEditorOptions, INotebookEditorViewState, INotebookViewCellsUpdateEvent, INotebookViewZoneChangeAccessor, INotebookWebviewMessage, RenderOutputType, ScrollToRevealBehavior } from './notebookBrowser.js';\nimport { NotebookEditorExtensionsRegistry } from './notebookEditorExtensions.js';\nimport { INotebookEditorService } from './services/notebookEditorService.js';\nimport { notebookDebug } from './notebookLogger.js';\nimport { NotebookCellStateChangedEvent, NotebookLayoutChangedEvent, NotebookLayoutInfo } from './notebookViewEvents.js';\nimport { CellContextKeyManager } from './view/cellParts/cellContextKeys.js';\nimport { CellDragAndDropController } from './view/cellParts/cellDnd.js';\nimport { ListViewInfoAccessor, NotebookCellList, NOTEBOOK_WEBVIEW_BOUNDARY } from './view/notebookCellList.js';\nimport { INotebookCellList } from './view/notebookRenderingCommon.js';\nimport { BackLayerWebView } from './view/renderers/backLayerWebView.js';\nimport { CodeCellRenderer, MarkupCellRenderer, NotebookCellListDelegate } from './view/renderers/cellRenderer.js';\nimport { IAckOutputHeight, IMarkupCellInitialization } from './view/renderers/webviewMessages.js';\nimport { CodeCellViewModel, outputDisplayLimit } from './viewModel/codeCellViewModel.js';\nimport { NotebookEventDispatcher } from './viewModel/eventDispatcher.js';\nimport { MarkupCellViewModel } from './viewModel/markupCellViewModel.js';\nimport { CellViewModel, NotebookViewModel } from './viewModel/notebookViewModelImpl.js';\nimport { ViewContext } from './viewModel/viewContext.js';\nimport { NotebookEditorWorkbenchToolbar } from './viewParts/notebookEditorToolbar.js';\nimport { NotebookEditorContextKeys } from './viewParts/notebookEditorWidgetContextKeys.js';\nimport { NotebookOverviewRuler } from './viewParts/notebookOverviewRuler.js';\nimport { ListTopCellToolbar } from './viewParts/notebookTopCellToolbar.js';\nimport { NotebookTextModel } from '../common/model/notebookTextModel.js';\nimport { CellEditType, CellKind, INotebookFindOptions, NotebookFindScopeType, RENDERER_NOT_AVAILABLE, SelectionStateType } from '../common/notebookCommon.js';\nimport { NOTEBOOK_CURSOR_NAVIGATION_MODE, NOTEBOOK_EDITOR_EDITABLE, NOTEBOOK_EDITOR_FOCUSED, NOTEBOOK_OUTPUT_FOCUSED, NOTEBOOK_OUTPUT_INPUT_FOCUSED } from '../common/notebookContextKeys.js';\nimport { INotebookExecutionService } from '../common/notebookExecutionService.js';\nimport { INotebookExecutionStateService } from '../common/notebookExecutionStateService.js';\nimport { INotebookKernelService } from '../common/notebookKernelService.js';\nimport { NotebookOptions, OutputInnerContainerTopPadding } from './notebookOptions.js';\nimport { cellRangesToIndexes, ICellRange } from '../common/notebookRange.js';\nimport { INotebookRendererMessagingService } from '../common/notebookRendererMessagingService.js';\nimport { INotebookService } from '../common/notebookService.js';\nimport { IWebviewElement } from '../../webview/browser/webview.js';\nimport { EditorExtensionsRegistry } from '../../../../editor/browser/editorExtensions.js';\nimport { IEditorGroupsService } from '../../../services/editor/common/editorGroupsService.js';\nimport { NotebookPerfMarks } from '../common/notebookPerformance.js';\nimport { BaseCellEditorOptions } from './viewModel/cellEditorOptions.js';\nimport { FloatingEditorClickMenu } from '../../../browser/codeeditor.js';\nimport { IDimension } from '../../../../editor/common/core/dimension.js';\nimport { CellFindMatchModel } from './contrib/find/findModel.js';\nimport { INotebookLoggingService } from '../common/notebookLoggingService.js';\nimport { Schemas } from '../../../../base/common/network.js';\nimport { DropIntoEditorController } from '../../../../editor/contrib/dropOrPasteInto/browser/dropIntoEditorController.js';\nimport { CopyPasteController } from '../../../../editor/contrib/dropOrPasteInto/browser/copyPasteController.js';\nimport { NotebookStickyScroll } from './viewParts/notebookEditorStickyScroll.js';\nimport { AccessibilityVerbositySettingId } from '../../accessibility/browser/accessibilityConfiguration.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { PixelRatio } from '../../../../base/browser/pixelRatio.js';\nimport { PreventDefaultContextMenuItemsContextKeyName } from '../../webview/browser/webview.contribution.js';\nimport { NotebookAccessibilityProvider } from './notebookAccessibilityProvider.js';\nimport { NotebookHorizontalTracker } from './viewParts/notebookHorizontalTracker.js';\nimport { NotebookCellEditorPool } from './view/notebookCellEditorPool.js';\n\nconst $ = DOM.$;\n\nexport function getDefaultNotebookCreationOptions(): INotebookEditorCreationOptions {\n\t// We inlined the id to avoid loading comment contrib in tests\n\tconst skipContributions = [\n\t\t'editor.contrib.review',\n\t\tFloatingEditorClickMenu.ID,\n\t\t'editor.contrib.dirtydiff',\n\t\t'editor.contrib.testingOutputPeek',\n\t\t'editor.contrib.testingDecorations',\n\t\t'store.contrib.stickyScrollController',\n\t\t'editor.contrib.findController',\n\t\t'editor.contrib.emptyTextEditorHint'\n\t];\n\tconst contributions = EditorExtensionsRegistry.getEditorContributions().filter(c => skipContributions.indexOf(c.id) === -1);\n\n\treturn {\n\t\tmenuIds: {\n\t\t\tnotebookToolbar: MenuId.NotebookToolbar,\n\t\t\tcellTitleToolbar: MenuId.NotebookCellTitle,\n\t\t\tcellDeleteToolbar: MenuId.NotebookCellDelete,\n\t\t\tcellInsertToolbar: MenuId.NotebookCellBetween,\n\t\t\tcellTopInsertToolbar: MenuId.NotebookCellListTop,\n\t\t\tcellExecuteToolbar: MenuId.NotebookCellExecute,\n\t\t\tcellExecutePrimary: MenuId.NotebookCellExecutePrimary,\n\t\t},\n\t\tcellEditorContributions: contributions\n\t};\n}\n\nexport class NotebookEditorWidget extends Disposable implements INotebookEditorDelegate, INotebookEditor {\n\t//#region Eventing\n\tprivate readonly _onDidChangeCellState = this._register(new Emitter<NotebookCellStateChangedEvent>());\n\treadonly onDidChangeCellState = this._onDidChangeCellState.event;\n\tprivate readonly _onDidChangeViewCells = this._register(new Emitter<INotebookViewCellsUpdateEvent>());\n\treadonly onDidChangeViewCells: Event<INotebookViewCellsUpdateEvent> = this._onDidChangeViewCells.event;\n\tprivate readonly _onWillChangeModel = this._register(new Emitter<NotebookTextModel | undefined>());\n\treadonly onWillChangeModel: Event<NotebookTextModel | undefined> = this._onWillChangeModel.event;\n\tprivate readonly _onDidChangeModel = this._register(new Emitter<NotebookTextModel | undefined>());\n\treadonly onDidChangeModel: Event<NotebookTextModel | undefined> = this._onDidChangeModel.event;\n\tprivate readonly _onDidAttachViewModel = this._register(new Emitter<void>());\n\treadonly onDidAttachViewModel: Event<void> = this._onDidAttachViewModel.event;\n\tprivate readonly _onDidChangeOptions = this._register(new Emitter<void>());\n\treadonly onDidChangeOptions: Event<void> = this._onDidChangeOptions.event;\n\tprivate readonly _onDidChangeDecorations = this._register(new Emitter<void>());\n\treadonly onDidChangeDecorations: Event<void> = this._onDidChangeDecorations.event;\n\tprivate readonly _onDidScroll = this._register(new Emitter<void>());\n\treadonly onDidScroll: Event<void> = this._onDidScroll.event;\n\tprivate readonly _onDidChangeLayout = this._register(new Emitter<void>());\n\treadonly onDidChangeLayout: Event<void> = this._onDidChangeLayout.event;\n\tprivate readonly _onDidChangeActiveCell = this._register(new Emitter<void>());\n\treadonly onDidChangeActiveCell: Event<void> = this._onDidChangeActiveCell.event;\n\tprivate readonly _onDidChangeFocus = this._register(new Emitter<void>());\n\treadonly onDidChangeFocus: Event<void> = this._onDidChangeFocus.event;\n\tprivate readonly _onDidChangeSelection = this._register(new Emitter<void>());\n\treadonly onDidChangeSelection: Event<void> = this._onDidChangeSelection.event;\n\tprivate readonly _onDidChangeVisibleRanges = this._register(new Emitter<void>());\n\treadonly onDidChangeVisibleRanges: Event<void> = this._onDidChangeVisibleRanges.event;\n\tprivate readonly _onDidFocusEmitter = this._register(new Emitter<void>());\n\treadonly onDidFocusWidget = this._onDidFocusEmitter.event;\n\tprivate readonly _onDidBlurEmitter = this._register(new Emitter<void>());\n\treadonly onDidBlurWidget = this._onDidBlurEmitter.event;\n\tprivate readonly _onDidChangeActiveEditor = this._register(new Emitter<this>());\n\treadonly onDidChangeActiveEditor: Event<this> = this._onDidChangeActiveEditor.event;\n\tprivate readonly _onDidChangeActiveKernel = this._register(new Emitter<void>());\n\treadonly onDidChangeActiveKernel: Event<void> = this._onDidChangeActiveKernel.event;\n\tprivate readonly _onMouseUp: Emitter<INotebookEditorMouseEvent> = this._register(new Emitter<INotebookEditorMouseEvent>());\n\treadonly onMouseUp: Event<INotebookEditorMouseEvent> = this._onMouseUp.event;\n\tprivate readonly _onMouseDown: Emitter<INotebookEditorMouseEvent> = this._register(new Emitter<INotebookEditorMouseEvent>());\n\treadonly onMouseDown: Event<INotebookEditorMouseEvent> = this._onMouseDown.event;\n\tprivate readonly _onDidReceiveMessage = this._register(new Emitter<INotebookWebviewMessage>());\n\treadonly onDidReceiveMessage: Event<INotebookWebviewMessage> = this._onDidReceiveMessage.event;\n\tprivate readonly _onDidRenderOutput = this._register(new Emitter<ICellOutputViewModel>());\n\tprivate readonly onDidRenderOutput = this._onDidRenderOutput.event;\n\tprivate readonly _onDidRemoveOutput = this._register(new Emitter<ICellOutputViewModel>());\n\tprivate readonly onDidRemoveOutput = this._onDidRemoveOutput.event;\n\tprivate readonly _onDidResizeOutputEmitter = this._register(new Emitter<ICellViewModel>());\n\treadonly onDidResizeOutput = this._onDidResizeOutputEmitter.event;\n\n\t//#endregion\n\tprivate _overlayContainer!: HTMLElement;\n\tprivate _notebookTopToolbarContainer!: HTMLElement;\n\tprivate _notebookTopToolbar!: NotebookEditorWorkbenchToolbar;\n\tprivate _notebookStickyScrollContainer!: HTMLElement;\n\tprivate _notebookStickyScroll!: NotebookStickyScroll;\n\tprivate _notebookOverviewRulerContainer!: HTMLElement;\n\tprivate _notebookOverviewRuler!: NotebookOverviewRuler;\n\tprivate _body!: HTMLElement;\n\tprivate _styleElement!: HTMLStyleElement;\n\tprivate _overflowContainer!: HTMLElement;\n\tprivate _webview: BackLayerWebView<ICommonCellInfo> | null = null;\n\tprivate _webviewResolvePromise: Promise<BackLayerWebView<ICommonCellInfo> | null> | null = null;\n\tprivate _webviewTransparentCover: HTMLElement | null = null;\n\tprivate _listDelegate: NotebookCellListDelegate | null = null;\n\tprivate _list!: INotebookCellList;\n\tprivate _listViewInfoAccessor!: ListViewInfoAccessor;\n\tprivate _dndController: CellDragAndDropController | null = null;\n\tprivate _listTopCellToolbar: ListTopCellToolbar | null = null;\n\tprivate _renderedEditors: Map<ICellViewModel, ICodeEditor> = new Map();\n\tprivate _editorPool!: NotebookCellEditorPool;\n\tprivate _viewContext: ViewContext;\n\tprivate _notebookViewModel: NotebookViewModel | undefined;\n\tprivate readonly _localStore: DisposableStore = this._register(new DisposableStore());\n\tprivate _localCellStateListeners: DisposableStore[] = [];\n\tprivate _fontInfo: FontInfo | undefined;\n\tprivate _dimension?: DOM.Dimension;\n\tprivate _position?: DOM.IDomPosition;\n\tprivate _shadowElement?: HTMLElement;\n\tprivate _shadowElementViewInfo: { height: number; width: number; top: number; left: number } | null = null;\n\n\tprivate readonly _editorFocus: IContextKey<boolean>;\n\tprivate readonly _outputFocus: IContextKey<boolean>;\n\tprivate readonly _editorEditable: IContextKey<boolean>;\n\tprivate readonly _cursorNavMode: IContextKey<boolean>;\n\tprivate readonly _outputInputFocus: IContextKey<boolean>;\n\tprotected readonly _contributions = new Map<string, INotebookEditorContribution>();\n\tprivate _scrollBeyondLastLine: boolean;\n\tprivate readonly _insetModifyQueueByOutputId = new SequencerByKey<string>();\n\tprivate _cellContextKeyManager: CellContextKeyManager | null = null;\n\tprivate readonly _uuid = generateUuid();\n\tprivate _focusTracker!: DOM.IFocusTracker;\n\tprivate _webviewFocused: boolean = false;\n\tprivate _isVisible = false;\n\tget isVisible() {\n\t\treturn this._isVisible;\n\t}\n\n\tprivate _isDisposed: boolean = false;\n\n\tget isDisposed() {\n\t\treturn this._isDisposed;\n\t}\n\n\tset viewModel(newModel: NotebookViewModel | undefined) {\n\t\tthis._onWillChangeModel.fire(this._notebookViewModel?.notebookDocument);\n\t\tthis._notebookViewModel = newModel;\n\t\tthis._onDidChangeModel.fire(newModel?.notebookDocument);\n\t}\n\n\tget viewModel() {\n\t\treturn this._notebookViewModel;\n\t}\n\n\tget textModel() {\n\t\treturn this._notebookViewModel?.notebookDocument;\n\t}\n\n\tget isReadOnly() {\n\t\treturn this._notebookViewModel?.options.isReadOnly ?? false;\n\t}\n\n\tget activeCodeEditor(): ICodeEditor | undefined {\n\t\tif (this._isDisposed) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst [focused] = this._list.getFocusedElements();\n\t\treturn this._renderedEditors.get(focused);\n\t}\n\n\tget activeCellAndCodeEditor(): [ICellViewModel, ICodeEditor] | undefined {\n\t\tif (this._isDisposed) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst [focused] = this._list.getFocusedElements();\n\t\tconst editor = this._renderedEditors.get(focused);\n\t\tif (!editor) {\n\t\t\treturn;\n\t\t}\n\t\treturn [focused, editor];\n\t}\n\n\tget codeEditors(): [ICellViewModel, ICodeEditor][] {\n\t\treturn [...this._renderedEditors];\n\t}\n\n\tget visibleRanges() {\n\t\treturn this._list.visibleRanges || [];\n\t}\n\n\tprivate _baseCellEditorOptions = new Map<string, IBaseCellEditorOptions>();\n\n\treadonly isEmbedded: boolean;\n\tprivate _readOnly: boolean;\n\tprivate readonly _inRepl: boolean;\n\n\tpublic readonly scopedContextKeyService: IContextKeyService;\n\tprivate readonly instantiationService: IInstantiationService;\n\tprivate readonly _notebookOptions: NotebookOptions;\n\n\tprivate _currentProgress: IProgressRunner | undefined;\n\n\tget notebookOptions() {\n\t\treturn this._notebookOptions;\n\t}\n\n\tconstructor(\n\t\treadonly creationOptions: INotebookEditorCreationOptions,\n\t\tdimension: DOM.Dimension | undefined,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@IEditorGroupsService editorGroupsService: IEditorGroupsService,\n\t\t@INotebookRendererMessagingService private readonly notebookRendererMessaging: INotebookRendererMessagingService,\n\t\t@INotebookEditorService private readonly notebookEditorService: INotebookEditorService,\n\t\t@INotebookKernelService private readonly notebookKernelService: INotebookKernelService,\n\t\t@INotebookService private readonly _notebookService: INotebookService,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@IContextKeyService contextKeyService: IContextKeyService,\n\t\t@ILayoutService private readonly layoutService: ILayoutService,\n\t\t@IContextMenuService private readonly contextMenuService: IContextMenuService,\n\t\t@ITelemetryService private readonly telemetryService: ITelemetryService,\n\t\t@INotebookExecutionService private readonly notebookExecutionService: INotebookExecutionService,\n\t\t@INotebookExecutionStateService private readonly notebookExecutionStateService: INotebookExecutionStateService,\n\t\t@IEditorProgressService private editorProgressService: IEditorProgressService,\n\t\t@INotebookLoggingService private readonly logService: INotebookLoggingService,\n\t\t@IKeybindingService private readonly keybindingService: IKeybindingService,\n\t) {\n\t\tsuper();\n\n\t\tthis._dimension = dimension;\n\n\t\tthis.isEmbedded = creationOptions.isEmbedded ?? false;\n\t\tthis._readOnly = creationOptions.isReadOnly ?? false;\n\t\tthis._inRepl = creationOptions.forRepl ?? false;\n\n\t\tthis._overlayContainer = document.createElement('div');\n\t\tthis.scopedContextKeyService = this._register(contextKeyService.createScoped(this._overlayContainer));\n\t\tthis.instantiationService = this._register(instantiationService.createChild(new ServiceCollection([IContextKeyService, this.scopedContextKeyService])));\n\n\t\tthis._notebookOptions = creationOptions.options ??\n\t\t\tthis.instantiationService.createInstance(NotebookOptions, this.creationOptions?.codeWindow ?? mainWindow, this._readOnly, undefined);\n\t\tthis._register(this._notebookOptions);\n\t\tconst eventDispatcher = this._register(new NotebookEventDispatcher());\n\t\tthis._viewContext = new ViewContext(\n\t\t\tthis._notebookOptions,\n\t\t\teventDispatcher,\n\t\t\tlanguage => this.getBaseCellEditorOptions(language));\n\t\tthis._register(this._viewContext.eventDispatcher.onDidChangeLayout(() => {\n\t\t\tthis._onDidChangeLayout.fire();\n\t\t}));\n\t\tthis._register(this._viewContext.eventDispatcher.onDidChangeCellState(e => {\n\t\t\tthis._onDidChangeCellState.fire(e);\n\t\t}));\n\n\n\t\tthis._register(_notebookService.onDidChangeOutputRenderers(() => {\n\t\t\tthis._updateOutputRenderers();\n\t\t}));\n\n\t\tthis._register(this.instantiationService.createInstance(NotebookEditorContextKeys, this));\n\n\t\tthis._register(notebookKernelService.onDidChangeSelectedNotebooks(e => {\n\t\t\tif (isEqual(e.notebook, this.viewModel?.uri)) {\n\t\t\t\tthis._loadKernelPreloads();\n\t\t\t\tthis._onDidChangeActiveKernel.fire();\n\t\t\t}\n\t\t}));\n\n\t\tthis._scrollBeyondLastLine = this.configurationService.getValue<boolean>('editor.scrollBeyondLastLine');\n\n\t\tthis._register(this.configurationService.onDidChangeConfiguration(e => {\n\t\t\tif (e.affectsConfiguration('editor.scrollBeyondLastLine')) {\n\t\t\t\tthis._scrollBeyondLastLine = this.configurationService.getValue<boolean>('editor.scrollBeyondLastLine');\n\t\t\t\tif (this._dimension && this._isVisible) {\n\t\t\t\t\tthis.layout(this._dimension);\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(this._notebookOptions.onDidChangeOptions(e => {\n\t\t\tif (e.cellStatusBarVisibility || e.cellToolbarLocation || e.cellToolbarInteraction) {\n\t\t\t\tthis._updateForNotebookConfiguration();\n\t\t\t}\n\n\t\t\tif (e.fontFamily) {\n\t\t\t\tthis._generateFontInfo();\n\t\t\t}\n\n\t\t\tif (e.compactView\n\t\t\t\t|| e.focusIndicator\n\t\t\t\t|| e.insertToolbarPosition\n\t\t\t\t|| e.cellToolbarLocation\n\t\t\t\t|| e.dragAndDropEnabled\n\t\t\t\t|| e.fontSize\n\t\t\t\t|| e.markupFontSize\n\t\t\t\t|| e.markdownLineHeight\n\t\t\t\t|| e.fontFamily\n\t\t\t\t|| e.insertToolbarAlignment\n\t\t\t\t|| e.outputFontSize\n\t\t\t\t|| e.outputLineHeight\n\t\t\t\t|| e.outputFontFamily\n\t\t\t\t|| e.outputWordWrap\n\t\t\t\t|| e.outputScrolling\n\t\t\t\t|| e.outputLinkifyFilePaths\n\t\t\t\t|| e.minimalError\n\t\t\t) {\n\t\t\t\tthis._styleElement?.remove();\n\t\t\t\tthis._createLayoutStyles();\n\t\t\t\tthis._webview?.updateOptions({\n\t\t\t\t\t...this.notebookOptions.computeWebviewOptions(),\n\t\t\t\t\tfontFamily: this._generateFontFamily()\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (this._dimension && this._isVisible) {\n\t\t\t\tthis.layout(this._dimension);\n\t\t\t}\n\t\t}));\n\n\t\tconst container = creationOptions.codeWindow ? this.layoutService.getContainer(creationOptions.codeWindow) : this.layoutService.mainContainer;\n\t\tthis._register(editorGroupsService.getPart(container).onDidScroll(e => {\n\t\t\tif (!this._shadowElement || !this._isVisible) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.updateShadowElement(this._shadowElement, this._dimension);\n\t\t\tthis.layoutContainerOverShadowElement(this._dimension, this._position);\n\t\t}));\n\n\t\tthis.notebookEditorService.addNotebookEditor(this);\n\n\t\tconst id = generateUuid();\n\t\tthis._overlayContainer.id = `notebook-${id}`;\n\t\tthis._overlayContainer.className = 'notebookOverlay';\n\t\tthis._overlayContainer.classList.add('notebook-editor');\n\t\tthis._overlayContainer.inert = true;\n\t\tthis._overlayContainer.style.visibility = 'hidden';\n\n\t\tcontainer.appendChild(this._overlayContainer);\n\n\t\tthis._createBody(this._overlayContainer);\n\t\tthis._generateFontInfo();\n\t\tthis._isVisible = true;\n\t\tthis._editorFocus = NOTEBOOK_EDITOR_FOCUSED.bindTo(this.scopedContextKeyService);\n\t\tthis._outputFocus = NOTEBOOK_OUTPUT_FOCUSED.bindTo(this.scopedContextKeyService);\n\t\tthis._outputInputFocus = NOTEBOOK_OUTPUT_INPUT_FOCUSED.bindTo(this.scopedContextKeyService);\n\t\tthis._editorEditable = NOTEBOOK_EDITOR_EDITABLE.bindTo(this.scopedContextKeyService);\n\t\tthis._cursorNavMode = NOTEBOOK_CURSOR_NAVIGATION_MODE.bindTo(this.scopedContextKeyService);\n\t\t// Never display the native cut/copy context menu items in notebooks\n\t\tnew RawContextKey<boolean>(PreventDefaultContextMenuItemsContextKeyName, false).bindTo(this.scopedContextKeyService).set(true);\n\n\t\tthis._editorEditable.set(!creationOptions.isReadOnly);\n\n\t\tlet contributions: INotebookEditorContributionDescription[];\n\t\tif (Array.isArray(this.creationOptions.contributions)) {\n\t\t\tcontributions = this.creationOptions.contributions;\n\t\t} else {\n\t\t\tcontributions = NotebookEditorExtensionsRegistry.getEditorContributions();\n\t\t}\n\t\tfor (const desc of contributions) {\n\t\t\tlet contribution: INotebookEditorContribution | undefined;\n\t\t\ttry {\n\t\t\t\tcontribution = this.instantiationService.createInstance(desc.ctor, this);\n\t\t\t} catch (err) {\n\t\t\t\tonUnexpectedError(err);\n\t\t\t}\n\t\t\tif (contribution) {\n\t\t\t\tif (!this._contributions.has(desc.id)) {\n\t\t\t\t\tthis._contributions.set(desc.id, contribution);\n\t\t\t\t} else {\n\t\t\t\t\tcontribution.dispose();\n\t\t\t\t\tthrow new Error(`DUPLICATE notebook editor contribution: '${desc.id}'`);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis._updateForNotebookConfiguration();\n\t}\n\n\tprivate _debugFlag: boolean = false;\n\n\tprivate _debug(...args: any[]) {\n\t\tif (!this._debugFlag) {\n\t\t\treturn;\n\t\t}\n\n\t\tnotebookDebug(...args);\n\t}\n\n\t/**\n\t * EditorId\n\t */\n\tpublic getId(): string {\n\t\treturn this._uuid;\n\t}\n\n\tgetViewModel(): NotebookViewModel | undefined {\n\t\treturn this.viewModel;\n\t}\n\n\tgetLength() {\n\t\treturn this.viewModel?.length ?? 0;\n\t}\n\n\tgetSelections() {\n\t\treturn this.viewModel?.getSelections() ?? [];\n\t}\n\n\tsetSelections(selections: ICellRange[]) {\n\t\tif (!this.viewModel) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst focus = this.viewModel.getFocus();\n\t\tthis.viewModel.updateSelectionsState({\n\t\t\tkind: SelectionStateType.Index,\n\t\t\tfocus: focus,\n\t\t\tselections: selections\n\t\t});\n\t}\n\n\tgetFocus() {\n\t\treturn this.viewModel?.getFocus() ?? { start: 0, end: 0 };\n\t}\n\n\tsetFocus(focus: ICellRange) {\n\t\tif (!this.viewModel) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst selections = this.viewModel.getSelections();\n\t\tthis.viewModel.updateSelectionsState({\n\t\t\tkind: SelectionStateType.Index,\n\t\t\tfocus: focus,\n\t\t\tselections: selections\n\t\t});\n\t}\n\n\tgetSelectionViewModels(): ICellViewModel[] {\n\t\tif (!this.viewModel) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst cellsSet = new Set<number>();\n\n\t\treturn this.viewModel.getSelections().map(range => this.viewModel!.viewCells.slice(range.start, range.end)).reduce((a, b) => {\n\t\t\tb.forEach(cell => {\n\t\t\t\tif (!cellsSet.has(cell.handle)) {\n\t\t\t\t\tcellsSet.add(cell.handle);\n\t\t\t\t\ta.push(cell);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn a;\n\t\t}, [] as ICellViewModel[]);\n\t}\n\n\thasModel(): this is IActiveNotebookEditorDelegate {\n\t\treturn !!this._notebookViewModel;\n\t}\n\n\tshowProgress(): void {\n\t\tthis._currentProgress = this.editorProgressService.show(true);\n\t}\n\n\thideProgress(): void {\n\t\tif (this._currentProgress) {\n\t\t\tthis._currentProgress.done();\n\t\t\tthis._currentProgress = undefined;\n\t\t}\n\t}\n\n\t//#region Editor Core\n\n\tgetBaseCellEditorOptions(language: string): IBaseCellEditorOptions {\n\t\tconst existingOptions = this._baseCellEditorOptions.get(language);\n\n\t\tif (existingOptions) {\n\t\t\treturn existingOptions;\n\t\t} else {\n\t\t\tconst options = new BaseCellEditorOptions(this, this.notebookOptions, this.configurationService, language);\n\t\t\tthis._baseCellEditorOptions.set(language, options);\n\t\t\treturn options;\n\t\t}\n\t}\n\n\tprivate _updateForNotebookConfiguration() {\n\t\tif (!this._overlayContainer) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._overlayContainer.classList.remove('cell-title-toolbar-left');\n\t\tthis._overlayContainer.classList.remove('cell-title-toolbar-right');\n\t\tthis._overlayContainer.classList.remove('cell-title-toolbar-hidden');\n\t\tconst cellToolbarLocation = this._notebookOptions.computeCellToolbarLocation(this.viewModel?.viewType);\n\t\tthis._overlayContainer.classList.add(`cell-title-toolbar-${cellToolbarLocation}`);\n\n\t\tconst cellToolbarInteraction = this._notebookOptions.getDisplayOptions().cellToolbarInteraction;\n\t\tlet cellToolbarInteractionState = 'hover';\n\t\tthis._overlayContainer.classList.remove('cell-toolbar-hover');\n\t\tthis._overlayContainer.classList.remove('cell-toolbar-click');\n\n\t\tif (cellToolbarInteraction === 'hover' || cellToolbarInteraction === 'click') {\n\t\t\tcellToolbarInteractionState = cellToolbarInteraction;\n\t\t}\n\t\tthis._overlayContainer.classList.add(`cell-toolbar-${cellToolbarInteractionState}`);\n\n\t}\n\n\tprivate _generateFontInfo(): void {\n\t\tconst editorOptions = this.configurationService.getValue<IEditorOptions>('editor');\n\t\tconst targetWindow = DOM.getWindow(this.getDomNode());\n\t\tthis._fontInfo = FontMeasurements.readFontInfo(targetWindow, BareFontInfo.createFromRawSettings(editorOptions, PixelRatio.getInstance(targetWindow).value));\n\t}\n\n\tprivate _createBody(parent: HTMLElement): void {\n\t\tthis._notebookTopToolbarContainer = document.createElement('div');\n\t\tthis._notebookTopToolbarContainer.classList.add('notebook-toolbar-container');\n\t\tthis._notebookTopToolbarContainer.style.display = 'none';\n\t\tDOM.append(parent, this._notebookTopToolbarContainer);\n\n\t\tthis._notebookStickyScrollContainer = document.createElement('div');\n\t\tthis._notebookStickyScrollContainer.classList.add('notebook-sticky-scroll-container');\n\t\tDOM.append(parent, this._notebookStickyScrollContainer);\n\n\t\tthis._body = document.createElement('div');\n\t\tDOM.append(parent, this._body);\n\n\t\tthis._body.classList.add('cell-list-container');\n\t\tthis._createLayoutStyles();\n\t\tthis._createCellList();\n\n\t\tthis._notebookOverviewRulerContainer = document.createElement('div');\n\t\tthis._notebookOverviewRulerContainer.classList.add('notebook-overview-ruler-container');\n\t\tthis._list.scrollableElement.appendChild(this._notebookOverviewRulerContainer);\n\t\tthis._registerNotebookOverviewRuler();\n\n\t\tthis._register(this.instantiationService.createInstance(NotebookHorizontalTracker, this, this._list.scrollableElement));\n\n\t\tthis._overflowContainer = document.createElement('div');\n\t\tthis._overflowContainer.classList.add('notebook-overflow-widget-container', 'monaco-editor');\n\t\tDOM.append(parent, this._overflowContainer);\n\t}\n\n\tprivate _generateFontFamily() {\n\t\treturn this._fontInfo?.fontFamily ?? `\"SF Mono\", Monaco, Menlo, Consolas, \"Ubuntu Mono\", \"Liberation Mono\", \"DejaVu Sans Mono\", \"Courier New\", monospace`;\n\t}\n\n\tprivate _createLayoutStyles(): void {\n\t\tthis._styleElement = DOM.createStyleSheet(this._body);\n\t\tconst {\n\t\t\tcellRightMargin,\n\t\t\tcellTopMargin,\n\t\t\tcellRunGutter,\n\t\t\tcellBottomMargin,\n\t\t\tcodeCellLeftMargin,\n\t\t\tmarkdownCellGutter,\n\t\t\tmarkdownCellLeftMargin,\n\t\t\tmarkdownCellBottomMargin,\n\t\t\tmarkdownCellTopMargin,\n\t\t\tcollapsedIndicatorHeight,\n\t\t\tfocusIndicator,\n\t\t\tinsertToolbarPosition,\n\t\t\toutputFontSize,\n\t\t\tfocusIndicatorLeftMargin,\n\t\t\tfocusIndicatorGap\n\t\t} = this._notebookOptions.getLayoutConfiguration();\n\n\t\tconst {\n\t\t\tinsertToolbarAlignment,\n\t\t\tcompactView,\n\t\t\tfontSize\n\t\t} = this._notebookOptions.getDisplayOptions();\n\n\t\tconst getCellEditorContainerLeftMargin = this._notebookOptions.getCellEditorContainerLeftMargin();\n\n\t\tconst { bottomToolbarGap, bottomToolbarHeight } = this._notebookOptions.computeBottomToolbarDimensions(this.viewModel?.viewType);\n\n\t\tconst styleSheets: string[] = [];\n\t\tif (!this._fontInfo) {\n\t\t\tthis._generateFontInfo();\n\t\t}\n\n\t\tconst fontFamily = this._generateFontFamily();\n\n\t\tstyleSheets.push(`\n\t\t.notebook-editor {\n\t\t\t--notebook-cell-output-font-size: ${outputFontSize}px;\n\t\t\t--notebook-cell-input-preview-font-size: ${fontSize}px;\n\t\t\t--notebook-cell-input-preview-font-family: ${fontFamily};\n\t\t}\n\t\t`);\n\n\t\tif (compactView) {\n\t\t\tstyleSheets.push(`.notebookOverlay .cell-list-container > .monaco-list > .monaco-scrollable-element > .monaco-list-rows > .markdown-cell-row div.cell.code { margin-left: ${getCellEditorContainerLeftMargin}px; }`);\n\t\t} else {\n\t\t\tstyleSheets.push(`.notebookOverlay .cell-list-container > .monaco-list > .monaco-scrollable-element > .monaco-list-rows > .markdown-cell-row div.cell.code { margin-left: ${codeCellLeftMargin}px; }`);\n\t\t}\n\n\t\t// focus indicator\n\t\tif (focusIndicator === 'border') {\n\t\t\tstyleSheets.push(`\n\t\t\t.monaco-workbench .notebookOverlay .monaco-list .monaco-list-row .cell-focus-indicator-top:before,\n\t\t\t.monaco-workbench .notebookOverlay .monaco-list .monaco-list-row .cell-focus-indicator-bottom:before,\n\t\t\t.monaco-workbench .notebookOverlay .monaco-list .markdown-cell-row .cell-inner-container:before,\n\t\t\t.monaco-workbench .notebookOverlay .monaco-list .markdown-cell-row .cell-inner-container:after {\n\t\t\t\tcontent: \"\";\n\t\t\t\tposition: absolute;\n\t\t\t\twidth: 100%;\n\t\t\t\theight: 1px;\n\t\t\t}\n\n\t\t\t.monaco-workbench .notebookOverlay .monaco-list .monaco-list-row .cell-focus-indicator-left:before,\n\t\t\t.monaco-workbench .notebookOverlay .monaco-list .monaco-list-row .cell-focus-indicator-right:before {\n\t\t\t\tcontent: \"\";\n\t\t\t\tposition: absolute;\n\t\t\t\twidth: 1px;\n\t\t\t\theight: 100%;\n\t\t\t\tz-index: 10;\n\t\t\t}\n\n\t\t\t/* top border */\n\t\t\t.monaco-workbench .notebookOverlay .monaco-list .monaco-list-row .cell-focus-indicator-top:before {\n\t\t\t\tborder-top: 1px solid transparent;\n\t\t\t}\n\n\t\t\t/* left border */\n\t\t\t.monaco-workbench .notebookOverlay .monaco-list .monaco-list-row .cell-focus-indicator-left:before {\n\t\t\t\tborder-left: 1px solid transparent;\n\t\t\t}\n\n\t\t\t/* bottom border */\n\t\t\t.monaco-workbench .notebookOverlay .monaco-list .monaco-list-row .cell-focus-indicator-bottom:before {\n\t\t\t\tborder-bottom: 1px solid transparent;\n\t\t\t}\n\n\t\t\t/* right border */\n\t\t\t.monaco-workbench .notebookOverlay .monaco-list .monaco-list-row .cell-focus-indicator-right:before {\n\t\t\t\tborder-right: 1px solid transparent;\n\t\t\t}\n\t\t\t`);\n\n\t\t\t// left and right border margins\n\t\t\tstyleSheets.push(`\n\t\t\t.monaco-workbench .notebookOverlay .monaco-list .monaco-list-row.code-cell-row.focused .cell-focus-indicator-left:before,\n\t\t\t.monaco-workbench .notebookOverlay .monaco-list .monaco-list-row.code-cell-row.focused .cell-focus-indicator-right:before,\n\t\t\t.monaco-workbench .notebookOverlay .monaco-list.selection-multiple .monaco-list-row.code-cell-row.selected .cell-focus-indicator-left:before,\n\t\t\t.monaco-workbench .notebookOverlay .monaco-list.selection-multiple .monaco-list-row.code-cell-row.selected .cell-focus-indicator-right:before {\n\t\t\t\ttop: -${cellTopMargin}px; height: calc(100% + ${cellTopMargin + cellBottomMargin}px)\n\t\t\t}`);\n\t\t} else {\n\t\t\tstyleSheets.push(`\n\t\t\t.monaco-workbench .notebookOverlay .monaco-list .monaco-list-row .cell-focus-indicator-left .codeOutput-focus-indicator {\n\t\t\t\tborder-left: 3px solid transparent;\n\t\t\t\tborder-radius: 4px;\n\t\t\t\twidth: 0px;\n\t\t\t\tmargin-left: ${focusIndicatorLeftMargin}px;\n\t\t\t\tborder-color: var(--vscode-notebook-inactiveFocusedCellBorder) !important;\n\t\t\t}\n\n\t\t\t.monaco-workbench .notebookOverlay .monaco-list .monaco-list-row.focused .cell-focus-indicator-left .codeOutput-focus-indicator-container,\n\t\t\t.monaco-workbench .notebookOverlay .monaco-list .monaco-list-row .cell-output-hover .cell-focus-indicator-left .codeOutput-focus-indicator-container,\n\t\t\t.monaco-workbench .notebookOverlay .monaco-list .monaco-list-row .markdown-cell-hover .cell-focus-indicator-left .codeOutput-focus-indicator-container,\n\t\t\t.monaco-workbench .notebookOverlay .monaco-list .monaco-list-row:hover .cell-focus-indicator-left .codeOutput-focus-indicator-container {\n\t\t\t\tdisplay: block;\n\t\t\t}\n\n\t\t\t.monaco-workbench .notebookOverlay .monaco-list .monaco-list-row .cell-focus-indicator-left .codeOutput-focus-indicator-container:hover .codeOutput-focus-indicator {\n\t\t\t\tborder-left: 5px solid transparent;\n\t\t\t\tmargin-left: ${focusIndicatorLeftMargin - 1}px;\n\t\t\t}\n\t\t\t`);\n\n\t\t\tstyleSheets.push(`\n\t\t\t.monaco-workbench .notebookOverlay .monaco-list .monaco-list-row.focused .cell-inner-container.cell-output-focus .cell-focus-indicator-left .codeOutput-focus-indicator,\n\t\t\t.monaco-workbench .notebookOverlay .monaco-list:focus-within .monaco-list-row.focused .cell-inner-container .cell-focus-indicator-left .codeOutput-focus-indicator {\n\t\t\t\tborder-color: var(--vscode-notebook-focusedCellBorder) !important;\n\t\t\t}\n\n\t\t\t.monaco-workbench .notebookOverlay .monaco-list .monaco-list-row .cell-inner-container .cell-focus-indicator-left .output-focus-indicator {\n\t\t\t\tmargin-top: ${focusIndicatorGap}px;\n\t\t\t}\n\t\t\t`);\n\t\t}\n\n\t\t// between cell insert toolbar\n\t\tif (insertToolbarPosition === 'betweenCells' || insertToolbarPosition === 'both') {\n\t\t\tstyleSheets.push(`.monaco-workbench .notebookOverlay > .cell-list-container > .monaco-list > .monaco-scrollable-element > .monaco-list-rows > .monaco-list-row .cell-bottom-toolbar-container { display: flex; }`);\n\t\t\tstyleSheets.push(`.monaco-workbench .notebookOverlay > .cell-list-container > .monaco-list > .monaco-scrollable-element > .monaco-list-rows > .view-zones .cell-list-top-cell-toolbar-container { display: flex; }`);\n\t\t} else {\n\t\t\tstyleSheets.push(`.monaco-workbench .notebookOverlay > .cell-list-container > .monaco-list > .monaco-scrollable-element > .monaco-list-rows > .monaco-list-row .cell-bottom-toolbar-container { display: none; }`);\n\t\t\tstyleSheets.push(`.monaco-workbench .notebookOverlay > .cell-list-container > .monaco-list > .monaco-scrollable-element > .monaco-list-rows > .view-zones .cell-list-top-cell-toolbar-container { display: none; }`);\n\t\t}\n\n\t\tif (insertToolbarAlignment === 'left') {\n\t\t\tstyleSheets.push(`\n\t\t\t.monaco-workbench .notebookOverlay .cell-list-top-cell-toolbar-container .action-item:first-child,\n\t\t\t.monaco-workbench .notebookOverlay .cell-list-top-cell-toolbar-container .action-item:first-child, .monaco-workbench .notebookOverlay > .cell-list-container > .monaco-list > .monaco-scrollable-element > .monaco-list-rows > .monaco-list-row .cell-bottom-toolbar-container .action-item:first-child {\n\t\t\t\tmargin-right: 0px !important;\n\t\t\t}`);\n\n\t\t\tstyleSheets.push(`\n\t\t\t.monaco-workbench .notebookOverlay .cell-list-top-cell-toolbar-container .monaco-toolbar .action-label,\n\t\t\t.monaco-workbench .notebookOverlay .cell-list-top-cell-toolbar-container .monaco-toolbar .action-label, .monaco-workbench .notebookOverlay > .cell-list-container > .monaco-list > .monaco-scrollable-element > .monaco-list-rows > .monaco-list-row .cell-bottom-toolbar-container .monaco-toolbar .action-label {\n\t\t\t\tpadding: 0px !important;\n\t\t\t\tjustify-content: center;\n\t\t\t\tborder-radius: 4px;\n\t\t\t}`);\n\n\t\t\tstyleSheets.push(`\n\t\t\t.monaco-workbench .notebookOverlay .cell-list-top-cell-toolbar-container,\n\t\t\t.monaco-workbench .notebookOverlay .cell-list-top-cell-toolbar-container, .monaco-workbench .notebookOverlay > .cell-list-container > .monaco-list > .monaco-scrollable-element > .monaco-list-rows > .monaco-list-row .cell-bottom-toolbar-container {\n\t\t\t\talign-items: flex-start;\n\t\t\t\tjustify-content: left;\n\t\t\t\tmargin: 0 16px 0 ${8 + codeCellLeftMargin}px;\n\t\t\t}`);\n\n\t\t\tstyleSheets.push(`\n\t\t\t.monaco-workbench .notebookOverlay .cell-list-top-cell-toolbar-container,\n\t\t\t.notebookOverlay .cell-bottom-toolbar-container .action-item {\n\t\t\t\tborder: 0px;\n\t\t\t}`);\n\t\t}\n\n\t\tstyleSheets.push(`.notebookOverlay .cell-list-container > .monaco-list > .monaco-scrollable-element > .monaco-list-rows > .code-cell-row div.cell.code { margin-left: ${getCellEditorContainerLeftMargin}px; }`);\n\t\tstyleSheets.push(`.notebookOverlay .cell-list-container > .monaco-list > .monaco-scrollable-element > .monaco-list-rows > .monaco-list-row div.cell { margin-right: ${cellRightMargin}px; }`);\n\t\tstyleSheets.push(`.notebookOverlay .cell-list-container > .monaco-list > .monaco-scrollable-element > .monaco-list-rows > .monaco-list-row > .cell-inner-container { padding-top: ${cellTopMargin}px; }`);\n\t\tstyleSheets.push(`.notebookOverlay .cell-list-container > .monaco-list > .monaco-scrollable-element > .monaco-list-rows > .markdown-cell-row > .cell-inner-container { padding-bottom: ${markdownCellBottomMargin}px; padding-top: ${markdownCellTopMargin}px; }`);\n\t\tstyleSheets.push(`.notebookOverlay .cell-list-container > .monaco-list > .monaco-scrollable-element > .monaco-list-rows > .markdown-cell-row > .cell-inner-container.webview-backed-markdown-cell { padding: 0; }`);\n\t\tstyleSheets.push(`.notebookOverlay .cell-list-container > .monaco-list > .monaco-scrollable-element > .monaco-list-rows > .markdown-cell-row > .webview-backed-markdown-cell.markdown-cell-edit-mode .cell.code { padding-bottom: ${markdownCellBottomMargin}px; padding-top: ${markdownCellTopMargin}px; }`);\n\t\tstyleSheets.push(`.notebookOverlay .output { margin: 0px ${cellRightMargin}px 0px ${getCellEditorContainerLeftMargin}px; }`);\n\t\tstyleSheets.push(`.notebookOverlay .output { width: calc(100% - ${getCellEditorContainerLeftMargin + cellRightMargin}px); }`);\n\n\t\t// comment\n\t\tstyleSheets.push(`.notebookOverlay .cell-list-container > .monaco-list > .monaco-scrollable-element > .monaco-list-rows > .monaco-list-row .cell-comment-container { left: ${getCellEditorContainerLeftMargin}px; }`);\n\t\tstyleSheets.push(`.notebookOverlay .cell-list-container > .monaco-list > .monaco-scrollable-element > .monaco-list-rows > .monaco-list-row .cell-comment-container { width: calc(100% - ${getCellEditorContainerLeftMargin + cellRightMargin}px); }`);\n\n\t\t// output collapse button\n\t\tstyleSheets.push(`.monaco-workbench .notebookOverlay .output .output-collapse-container .expandButton { left: -${cellRunGutter}px; }`);\n\t\tstyleSheets.push(`.monaco-workbench .notebookOverlay .output .output-collapse-container .expandButton {\n\t\t\tposition: absolute;\n\t\t\twidth: ${cellRunGutter}px;\n\t\t\tpadding: 6px 0px;\n\t\t}`);\n\n\t\t// show more container\n\t\tstyleSheets.push(`.notebookOverlay .output-show-more-container { margin: 0px ${cellRightMargin}px 0px ${getCellEditorContainerLeftMargin}px; }`);\n\t\tstyleSheets.push(`.notebookOverlay .output-show-more-container { width: calc(100% - ${getCellEditorContainerLeftMargin + cellRightMargin}px); }`);\n\n\t\tstyleSheets.push(`.notebookOverlay .cell-list-container > .monaco-list > .monaco-scrollable-element > .monaco-list-rows > .monaco-list-row div.cell.markdown { padding-left: ${cellRunGutter}px; }`);\n\t\tstyleSheets.push(`.monaco-workbench .notebookOverlay > .cell-list-container .notebook-folding-indicator { left: ${(markdownCellGutter - 20) / 2 + markdownCellLeftMargin}px; }`);\n\t\tstyleSheets.push(`.notebookOverlay > .cell-list-container .notebook-folded-hint { left: ${markdownCellGutter + markdownCellLeftMargin + 8}px; }`);\n\t\tstyleSheets.push(`.notebookOverlay .monaco-list .monaco-list-row :not(.webview-backed-markdown-cell) .cell-focus-indicator-top { height: ${cellTopMargin}px; }`);\n\t\tstyleSheets.push(`.notebookOverlay .monaco-list .monaco-list-row .cell-focus-indicator-side { bottom: ${bottomToolbarGap}px; }`);\n\t\tstyleSheets.push(`.notebookOverlay .monaco-list .monaco-list-row.code-cell-row .cell-focus-indicator-left { width: ${getCellEditorContainerLeftMargin}px; }`);\n\t\tstyleSheets.push(`.notebookOverlay .monaco-list .monaco-list-row.markdown-cell-row .cell-focus-indicator-left { width: ${codeCellLeftMargin}px; }`);\n\t\tstyleSheets.push(`.notebookOverlay .monaco-list .monaco-list-row .cell-focus-indicator.cell-focus-indicator-right { width: ${cellRightMargin}px; }`);\n\t\tstyleSheets.push(`.notebookOverlay .monaco-list .monaco-list-row .cell-focus-indicator-bottom { height: ${cellBottomMargin}px; }`);\n\t\tstyleSheets.push(`.notebookOverlay .monaco-list .monaco-list-row .cell-shadow-container-bottom { top: ${cellBottomMargin}px; }`);\n\n\t\tstyleSheets.push(`\n\t\t\t.notebookOverlay .monaco-list .monaco-list-row:has(+ .monaco-list-row.selected) .cell-focus-indicator-bottom {\n\t\t\t\theight: ${bottomToolbarGap + cellBottomMargin}px;\n\t\t\t}\n\t\t`);\n\n\t\tstyleSheets.push(`\n\t\t\t.notebookOverlay .monaco-list .monaco-list-row.code-cell-row.nb-multiCellHighlight:has(+ .monaco-list-row.nb-multiCellHighlight) .cell-focus-indicator-bottom {\n\t\t\t\theight: ${bottomToolbarGap + cellBottomMargin}px;\n\t\t\t\tbackground-color: var(--vscode-notebook-symbolHighlightBackground) !important;\n\t\t\t}\n\n\t\t\t.notebookOverlay .monaco-list .monaco-list-row.markdown-cell-row.nb-multiCellHighlight:has(+ .monaco-list-row.nb-multiCellHighlight) .cell-focus-indicator-bottom {\n\t\t\t\theight: ${bottomToolbarGap + cellBottomMargin - 6}px;\n\t\t\t\tbackground-color: var(--vscode-notebook-symbolHighlightBackground) !important;\n\t\t\t}\n\t\t`);\n\n\n\t\tstyleSheets.push(`\n\t\t\t.monaco-workbench .notebookOverlay > .cell-list-container > .monaco-list > .monaco-scrollable-element > .monaco-list-rows > .monaco-list-row .input-collapse-container .cell-collapse-preview {\n\t\t\t\tline-height: ${collapsedIndicatorHeight}px;\n\t\t\t}\n\n\t\t\t.monaco-workbench .notebookOverlay > .cell-list-container > .monaco-list > .monaco-scrollable-element > .monaco-list-rows > .monaco-list-row .input-collapse-container .cell-collapse-preview .monaco-tokenized-source {\n\t\t\t\tmax-height: ${collapsedIndicatorHeight}px;\n\t\t\t}\n\t\t`);\n\n\t\tstyleSheets.push(`.monaco-workbench .notebookOverlay > .cell-list-container > .monaco-list > .monaco-scrollable-element > .monaco-list-rows > .monaco-list-row .cell-bottom-toolbar-container .monaco-toolbar { height: ${bottomToolbarHeight}px }`);\n\t\tstyleSheets.push(`.monaco-workbench .notebookOverlay > .cell-list-container > .monaco-list > .monaco-scrollable-element > .monaco-list-rows > .view-zones .cell-list-top-cell-toolbar-container .monaco-toolbar { height: ${bottomToolbarHeight}px }`);\n\n\t\t// cell toolbar\n\t\tstyleSheets.push(`.monaco-workbench .notebookOverlay.cell-title-toolbar-right > .cell-list-container > .monaco-list > .monaco-scrollable-element > .monaco-list-rows > .monaco-list-row .cell-title-toolbar {\n\t\t\tright: ${cellRightMargin + 26}px;\n\t\t}\n\t\t.monaco-workbench .notebookOverlay.cell-title-toolbar-left > .cell-list-container > .monaco-list > .monaco-scrollable-element > .monaco-list-rows > .monaco-list-row .cell-title-toolbar {\n\t\t\tleft: ${getCellEditorContainerLeftMargin + 16}px;\n\t\t}\n\t\t.monaco-workbench .notebookOverlay.cell-title-toolbar-hidden > .cell-list-container > .monaco-list > .monaco-scrollable-element > .monaco-list-rows > .monaco-list-row .cell-title-toolbar {\n\t\t\tdisplay: none;\n\t\t}`);\n\n\t\t// cell output innert container\n\t\tstyleSheets.push(`\n\t\t.monaco-workbench .notebookOverlay .output > div.foreground.output-inner-container {\n\t\t\tpadding: ${OutputInnerContainerTopPadding}px 8px;\n\t\t}\n\t\t.monaco-workbench .notebookOverlay > .cell-list-container > .monaco-list > .monaco-scrollable-element > .monaco-list-rows > .monaco-list-row .output-collapse-container {\n\t\t\tpadding: ${OutputInnerContainerTopPadding}px 8px;\n\t\t}\n\t\t`);\n\n\t\t// chat\n\t\tstyleSheets.push(`\n\t\t.monaco-workbench .notebookOverlay .cell-chat-part {\n\t\t\tmargin: 0 ${cellRightMargin}px 6px 4px;\n\t\t}\n\t\t`);\n\n\t\tthis._styleElement.textContent = styleSheets.join('\\n');\n\t}\n\n\tprivate _createCellList(): void {\n\t\tthis._body.classList.add('cell-list-container');\n\t\tthis._dndController = this._register(new CellDragAndDropController(this, this._body));\n\t\tconst getScopedContextKeyService = (container: HTMLElement) => this._list.contextKeyService.createScoped(container);\n\t\tthis._editorPool = this._register(this.instantiationService.createInstance(NotebookCellEditorPool, this, getScopedContextKeyService));\n\t\tconst renderers = [\n\t\t\tthis.instantiationService.createInstance(CodeCellRenderer, this, this._renderedEditors, this._editorPool, this._dndController, getScopedContextKeyService),\n\t\t\tthis.instantiationService.createInstance(MarkupCellRenderer, this, this._dndController, this._renderedEditors, getScopedContextKeyService),\n\t\t];\n\n\t\trenderers.forEach(renderer => {\n\t\t\tthis._register(renderer);\n\t\t});\n\n\t\tthis._listDelegate = this.instantiationService.createInstance(NotebookCellListDelegate, DOM.getWindow(this.getDomNode()));\n\t\tthis._register(this._listDelegate);\n\n\t\tconst accessibilityProvider = new NotebookAccessibilityProvider(this.notebookExecutionStateService, () => this.viewModel, this.keybindingService, this.configurationService);\n\t\tthis._register(accessibilityProvider);\n\n\t\tthis._list = this.instantiationService.createInstance(\n\t\t\tNotebookCellList,\n\t\t\t'NotebookCellList',\n\t\t\tthis._body,\n\t\t\tthis._viewContext.notebookOptions,\n\t\t\tthis._listDelegate,\n\t\t\trenderers,\n\t\t\tthis.scopedContextKeyService,\n\t\t\t{\n\t\t\t\tsetRowLineHeight: false,\n\t\t\t\tsetRowHeight: false,\n\t\t\t\tsupportDynamicHeights: true,\n\t\t\t\thorizontalScrolling: false,\n\t\t\t\tkeyboardSupport: false,\n\t\t\t\tmouseSupport: true,\n\t\t\t\tmultipleSelectionSupport: true,\n\t\t\t\tselectionNavigation: true,\n\t\t\t\ttypeNavigationEnabled: true,\n\t\t\t\tpaddingTop: 0,\n\t\t\t\tpaddingBottom: 0,\n\t\t\t\ttransformOptimization: false, //(isMacintosh && isNative) || getTitleBarStyle(this.configurationService, this.environmentService) === 'native',\n\t\t\t\tinitialSize: this._dimension,\n\t\t\t\tstyleController: (_suffix: string) => { return this._list; },\n\t\t\t\toverrideStyles: {\n\t\t\t\t\tlistBackground: notebookEditorBackground,\n\t\t\t\t\tlistActiveSelectionBackground: notebookEditorBackground,\n\t\t\t\t\tlistActiveSelectionForeground: foreground,\n\t\t\t\t\tlistFocusAndSelectionBackground: notebookEditorBackground,\n\t\t\t\t\tlistFocusAndSelectionForeground: foreground,\n\t\t\t\t\tlistFocusBackground: notebookEditorBackground,\n\t\t\t\t\tlistFocusForeground: foreground,\n\t\t\t\t\tlistHoverForeground: foreground,\n\t\t\t\t\tlistHoverBackground: notebookEditorBackground,\n\t\t\t\t\tlistHoverOutline: focusBorder,\n\t\t\t\t\tlistFocusOutline: focusBorder,\n\t\t\t\t\tlistInactiveSelectionBackground: notebookEditorBackground,\n\t\t\t\t\tlistInactiveSelectionForeground: foreground,\n\t\t\t\t\tlistInactiveFocusBackground: notebookEditorBackground,\n\t\t\t\t\tlistInactiveFocusOutline: notebookEditorBackground,\n\t\t\t\t},\n\t\t\t\taccessibilityProvider\n\t\t\t},\n\t\t);\n\t\tthis._dndController.setList(this._list);\n\n\t\t// create Webview\n\n\t\tthis._register(this._list);\n\t\tthis._listViewInfoAccessor = new ListViewInfoAccessor(this._list);\n\t\tthis._register(this._listViewInfoAccessor);\n\n\t\tthis._register(combinedDisposable(...renderers));\n\n\t\t// top cell toolbar\n\t\tthis._listTopCellToolbar = this._register(this.instantiationService.createInstance(ListTopCellToolbar, this, this.notebookOptions));\n\n\t\t// transparent cover\n\t\tthis._webviewTransparentCover = DOM.append(this._list.rowsContainer, $('.webview-cover'));\n\t\tthis._webviewTransparentCover.style.display = 'none';\n\n\t\tthis._register(DOM.addStandardDisposableGenericMouseDownListener(this._overlayContainer, (e: StandardMouseEvent) => {\n\t\t\tif (e.target.classList.contains('slider') && this._webviewTransparentCover) {\n\t\t\t\tthis._webviewTransparentCover.style.display = 'block';\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(DOM.addStandardDisposableGenericMouseUpListener(this._overlayContainer, () => {\n\t\t\tif (this._webviewTransparentCover) {\n\t\t\t\t// no matter when\n\t\t\t\tthis._webviewTransparentCover.style.display = 'none';\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(this._list.onMouseDown(e => {\n\t\t\tif (e.element) {\n\t\t\t\tthis._onMouseDown.fire({ event: e.browserEvent, target: e.element });\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(this._list.onMouseUp(e => {\n\t\t\tif (e.element) {\n\t\t\t\tthis._onMouseUp.fire({ event: e.browserEvent, target: e.element });\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(this._list.onDidChangeFocus(_e => {\n\t\t\tthis._onDidChangeActiveEditor.fire(this);\n\t\t\tthis._onDidChangeActiveCell.fire();\n\t\t\tthis._onDidChangeFocus.fire();\n\t\t\tthis._cursorNavMode.set(false);\n\t\t}));\n\n\t\tthis._register(this._list.onContextMenu(e => {\n\t\t\tthis.showListContextMenu(e);\n\t\t}));\n\n\t\tthis._register(this._list.onDidChangeVisibleRanges(() => {\n\t\t\tthis._onDidChangeVisibleRanges.fire();\n\t\t}));\n\n\t\tthis._register(this._list.onDidScroll((e) => {\n\t\t\tif (e.scrollTop !== e.oldScrollTop) {\n\t\t\t\tthis._onDidScroll.fire();\n\t\t\t\tthis.clearActiveCellWidgets();\n\t\t\t}\n\t\t}));\n\n\t\tthis._focusTracker = this._register(DOM.trackFocus(this.getDomNode()));\n\t\tthis._register(this._focusTracker.onDidBlur(() => {\n\t\t\tthis._editorFocus.set(false);\n\t\t\tthis.viewModel?.setEditorFocus(false);\n\t\t\tthis._onDidBlurEmitter.fire();\n\t\t}));\n\t\tthis._register(this._focusTracker.onDidFocus(() => {\n\t\t\tthis._editorFocus.set(true);\n\t\t\tthis.viewModel?.setEditorFocus(true);\n\t\t\tthis._onDidFocusEmitter.fire();\n\t\t}));\n\n\t\tthis._registerNotebookActionsToolbar();\n\t\tthis._registerNotebookStickyScroll();\n\n\t\tthis._register(this.configurationService.onDidChangeConfiguration(e => {\n\t\t\tif (e.affectsConfiguration(AccessibilityVerbositySettingId.Notebook)) {\n\t\t\t\tthis._list.ariaLabel = accessibilityProvider?.getWidgetAriaLabel();\n\t\t\t}\n\t\t}));\n\t}\n\n\tprivate showListContextMenu(e: IListContextMenuEvent<CellViewModel>) {\n\t\tthis.contextMenuService.showContextMenu({\n\t\t\tmenuId: MenuId.NotebookCellTitle,\n\t\t\tcontextKeyService: this.scopedContextKeyService,\n\t\t\tgetAnchor: () => e.anchor\n\t\t});\n\t}\n\n\tprivate _registerNotebookOverviewRuler() {\n\t\tthis._notebookOverviewRuler = this._register(this.instantiationService.createInstance(NotebookOverviewRuler, this, this._notebookOverviewRulerContainer));\n\t}\n\n\tprivate _registerNotebookActionsToolbar() {\n\t\tthis._notebookTopToolbar = this._register(this.instantiationService.createInstance(NotebookEditorWorkbenchToolbar, this, this.scopedContextKeyService, this._notebookOptions, this._notebookTopToolbarContainer));\n\t\tthis._register(this._notebookTopToolbar.onDidChangeVisibility(() => {\n\t\t\tif (this._dimension && this._isVisible) {\n\t\t\t\tthis.layout(this._dimension);\n\t\t\t}\n\t\t}));\n\t}\n\n\tprivate _registerNotebookStickyScroll() {\n\t\tthis._notebookStickyScroll = this._register(this.instantiationService.createInstance(NotebookStickyScroll, this._notebookStickyScrollContainer, this, this._list, (sizeDelta) => {\n\t\t\tif (this.isDisposed) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this._dimension && this._isVisible) {\n\t\t\t\tif (sizeDelta > 0) { // delta > 0 ==> sticky is growing, cell list shrinking\n\t\t\t\t\tthis.layout(this._dimension);\n\t\t\t\t\tthis.setScrollTop(this.scrollTop + sizeDelta);\n\t\t\t\t} else if (sizeDelta < 0) { // delta < 0 ==> sticky is shrinking, cell list growing\n\t\t\t\t\tthis.setScrollTop(this.scrollTop + sizeDelta);\n\t\t\t\t\tthis.layout(this._dimension);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis._onDidScroll.fire();\n\t\t}));\n\t}\n\n\tprivate _updateOutputRenderers() {\n\t\tif (!this.viewModel || !this._webview) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._webview.updateOutputRenderers();\n\t\tthis.viewModel.viewCells.forEach(cell => {\n\t\t\tcell.outputsViewModels.forEach(output => {\n\t\t\t\tif (output.pickedMimeType?.rendererId === RENDERER_NOT_AVAILABLE) {\n\t\t\t\t\toutput.resetRenderer();\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\tgetDomNode() {\n\t\treturn this._overlayContainer;\n\t}\n\n\tgetOverflowContainerDomNode() {\n\t\treturn this._overflowContainer;\n\t}\n\n\tgetInnerWebview(): IWebviewElement | undefined {\n\t\treturn this._webview?.webview;\n\t}\n\n\tsetEditorProgressService(editorProgressService: IEditorProgressService): void {\n\t\tthis.editorProgressService = editorProgressService;\n\t}\n\n\tsetParentContextKeyService(parentContextKeyService: IContextKeyService): void {\n\t\tthis.scopedContextKeyService.updateParent(parentContextKeyService);\n\t}\n\n\tasync setModel(textModel: NotebookTextModel, viewState: INotebookEditorViewState | undefined, perf?: NotebookPerfMarks): Promise<void> {\n\t\tif (this.viewModel === undefined || !this.viewModel.equal(textModel)) {\n\t\t\tconst oldBottomToolbarDimensions = this._notebookOptions.computeBottomToolbarDimensions(this.viewModel?.viewType);\n\t\t\tthis._detachModel();\n\t\t\tawait this._attachModel(textModel, viewState, perf);\n\t\t\tconst newBottomToolbarDimensions = this._notebookOptions.computeBottomToolbarDimensions(this.viewModel?.viewType);\n\n\t\t\tif (oldBottomToolbarDimensions.bottomToolbarGap !== newBottomToolbarDimensions.bottomToolbarGap\n\t\t\t\t|| oldBottomToolbarDimensions.bottomToolbarHeight !== newBottomToolbarDimensions.bottomToolbarHeight) {\n\t\t\t\tthis._styleElement?.remove();\n\t\t\t\tthis._createLayoutStyles();\n\t\t\t\tthis._webview?.updateOptions({\n\t\t\t\t\t...this.notebookOptions.computeWebviewOptions(),\n\t\t\t\t\tfontFamily: this._generateFontFamily()\n\t\t\t\t});\n\t\t\t}\n\t\t\ttype WorkbenchNotebookOpenClassification = {\n\t\t\t\towner: 'rebornix';\n\t\t\t\tcomment: 'Identify the notebook editor view type';\n\t\t\t\tscheme: { classification: 'SystemMetaData'; purpose: 'FeatureInsight'; comment: 'File system provider scheme for the resource' };\n\t\t\t\text: { classification: 'SystemMetaData'; purpose: 'FeatureInsight'; comment: 'File extension for the resource' };\n\t\t\t\tviewType: { classification: 'SystemMetaData'; purpose: 'FeatureInsight'; comment: 'View type of the notebook editor' };\n\t\t\t};\n\n\t\t\ttype WorkbenchNotebookOpenEvent = {\n\t\t\t\tscheme: string;\n\t\t\t\text: string;\n\t\t\t\tviewType: string;\n\t\t\t};\n\n\t\t\tthis.telemetryService.publicLog2<WorkbenchNotebookOpenEvent, WorkbenchNotebookOpenClassification>('notebook/editorOpened', {\n\t\t\t\tscheme: textModel.uri.scheme,\n\t\t\t\text: extname(textModel.uri),\n\t\t\t\tviewType: textModel.viewType\n\t\t\t});\n\t\t} else {\n\t\t\tthis.restoreListViewState(viewState);\n\t\t}\n\n\t\tthis._restoreSelectedKernel(viewState);\n\n\t\t// load preloads for matching kernel\n\t\tthis._loadKernelPreloads();\n\n\t\t// clear state\n\t\tthis._dndController?.clearGlobalDragState();\n\n\t\tthis._localStore.add(this._list.onDidChangeFocus(() => {\n\t\t\tthis.updateContextKeysOnFocusChange();\n\t\t}));\n\n\t\tthis.updateContextKeysOnFocusChange();\n\t\t// render markdown top down on idle\n\t\tthis._backgroundMarkdownRendering();\n\t}\n\n\tprivate _backgroundMarkdownRenderRunning = false;\n\tprivate _backgroundMarkdownRendering() {\n\t\tif (this._backgroundMarkdownRenderRunning) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._backgroundMarkdownRenderRunning = true;\n\t\tDOM.runWhenWindowIdle(DOM.getWindow(this.getDomNode()), (deadline) => {\n\t\t\tthis._backgroundMarkdownRenderingWithDeadline(deadline);\n\t\t});\n\t}\n\n\tprivate _backgroundMarkdownRenderingWithDeadline(deadline: IdleDeadline) {\n\t\tconst endTime = Date.now() + deadline.timeRemaining();\n\n\t\tconst execute = () => {\n\t\t\ttry {\n\t\t\t\tthis._backgroundMarkdownRenderRunning = true;\n\t\t\t\tif (this._isDisposed) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!this.viewModel) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst firstMarkupCell = this.viewModel.viewCells.find(cell => cell.cellKind === CellKind.Markup && !this._webview?.markupPreviewMapping.has(cell.id) && !this.cellIsHidden(cell)) as MarkupCellViewModel | undefined;\n\t\t\t\tif (!firstMarkupCell) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.createMarkupPreview(firstMarkupCell);\n\t\t\t} finally {\n\t\t\t\tthis._backgroundMarkdownRenderRunning = false;\n\t\t\t}\n\n\t\t\tif (Date.now() < endTime) {\n\t\t\t\tsetTimeout0(execute);\n\t\t\t} else {\n\t\t\t\tthis._backgroundMarkdownRendering();\n\t\t\t}\n\t\t};\n\n\t\texecute();\n\t}\n\n\tprivate updateContextKeysOnFocusChange() {\n\t\tif (!this.viewModel) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst focused = this._list.getFocusedElements()[0];\n\t\tif (focused) {\n\t\t\tif (!this._cellContextKeyManager) {\n\t\t\t\tthis._cellContextKeyManager = this._localStore.add(this.instantiationService.createInstance(CellContextKeyManager, this, focused as CellViewModel));\n\t\t\t}\n\n\t\t\tthis._cellContextKeyManager.updateForElement(focused as CellViewModel);\n\t\t}\n\t}\n\n\tasync setOptions(options: INotebookEditorOptions | undefined) {\n\t\tif (options?.isReadOnly !== undefined) {\n\t\t\tthis._readOnly = options?.isReadOnly;\n\t\t}\n\n\t\tif (!this.viewModel) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.viewModel.updateOptions({ isReadOnly: this._readOnly });\n\t\tthis.notebookOptions.updateOptions(this._readOnly);\n\n\t\t// reveal cell if editor options tell to do so\n\t\tconst cellOptions = options?.cellOptions ?? this._parseIndexedCellOptions(options);\n\t\tif (cellOptions) {\n\t\t\tconst cell = this.viewModel.viewCells.find(cell => cell.uri.toString() === cellOptions.resource.toString());\n\t\t\tif (cell) {\n\t\t\t\tthis.focusElement(cell);\n\t\t\t\tconst selection = cellOptions.options?.selection;\n\t\t\t\tif (selection) {\n\t\t\t\t\tcell.updateEditState(CellEditState.Editing, 'setOptions');\n\t\t\t\t\tcell.focusMode = CellFocusMode.Editor;\n\t\t\t\t\tawait this.revealRangeInCenterIfOutsideViewportAsync(cell, new Range(selection.startLineNumber, selection.startColumn, selection.endLineNumber || selection.startLineNumber, selection.endColumn || selection.startColumn));\n\t\t\t\t} else {\n\t\t\t\t\tthis._list.revealCell(cell, options?.cellRevealType ?? CellRevealType.CenterIfOutsideViewport);\n\t\t\t\t}\n\n\t\t\t\tconst editor = this._renderedEditors.get(cell)!;\n\t\t\t\tif (editor) {\n\t\t\t\t\tif (cellOptions.options?.selection) {\n\t\t\t\t\t\tconst { selection } = cellOptions.options;\n\t\t\t\t\t\tconst editorSelection = new Range(selection.startLineNumber, selection.startColumn, selection.endLineNumber || selection.startLineNumber, selection.endColumn || selection.startColumn);\n\t\t\t\t\t\teditor.setSelection(editorSelection);\n\t\t\t\t\t\teditor.revealPositionInCenterIfOutsideViewport({\n\t\t\t\t\t\t\tlineNumber: selection.startLineNumber,\n\t\t\t\t\t\t\tcolumn: selection.startColumn\n\t\t\t\t\t\t});\n\t\t\t\t\t\tawait this.revealRangeInCenterIfOutsideViewportAsync(cell, editorSelection);\n\t\t\t\t\t}\n\t\t\t\t\tif (!cellOptions.options?.preserveFocus) {\n\t\t\t\t\t\teditor.focus();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// select cells if options tell to do so\n\t\t// todo@rebornix https://github.com/microsoft/vscode/issues/118108 support selections not just focus\n\t\t// todo@rebornix support multipe selections\n\t\tif (options?.cellSelections) {\n\t\t\tconst focusCellIndex = options.cellSelections[0].start;\n\t\t\tconst focusedCell = this.viewModel.cellAt(focusCellIndex);\n\t\t\tif (focusedCell) {\n\t\t\t\tthis.viewModel.updateSelectionsState({\n\t\t\t\t\tkind: SelectionStateType.Index,\n\t\t\t\t\tfocus: { start: focusCellIndex, end: focusCellIndex + 1 },\n\t\t\t\t\tselections: options.cellSelections\n\t\t\t\t});\n\t\t\t\tthis.revealInCenterIfOutsideViewport(focusedCell);\n\t\t\t}\n\t\t}\n\n\t\tthis._updateForOptions();\n\t\tthis._onDidChangeOptions.fire();\n\t}\n\n\tprivate _parseIndexedCellOptions(options: INotebookEditorOptions | undefined) {\n\t\tif (options?.indexedCellOptions) {\n\t\t\t// convert index based selections\n\t\t\tconst cell = this.cellAt(options.indexedCellOptions.index);\n\t\t\tif (cell) {\n\t\t\t\treturn {\n\t\t\t\t\tresource: cell.uri,\n\t\t\t\t\toptions: {\n\t\t\t\t\t\tselection: options.indexedCellOptions.selection,\n\t\t\t\t\t\tpreserveFocus: false\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tprivate _detachModel() {\n\t\tthis._localStore.clear();\n\t\tdispose(this._localCellStateListeners);\n\t\tthis._list.detachViewModel();\n\t\tthis.viewModel?.dispose();\n\t\t// avoid event\n\t\tthis.viewModel = undefined;\n\t\tthis._webview?.dispose();\n\t\tthis._webview?.element.remove();\n\t\tthis._webview = null;\n\t\tthis._list.clear();\n\t}\n\n\n\tprivate _updateForOptions(): void {\n\t\tif (!this.viewModel) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._editorEditable.set(!this.viewModel.options.isReadOnly);\n\t\tthis._overflowContainer.classList.toggle('notebook-editor-editable', !this.viewModel.options.isReadOnly);\n\t\tthis.getDomNode().classList.toggle('notebook-editor-editable', !this.viewModel.options.isReadOnly);\n\t}\n\n\tprivate async _resolveWebview(): Promise<BackLayerWebView<ICommonCellInfo> | null> {\n\t\tif (!this.textModel) {\n\t\t\treturn null;\n\t\t}\n\n\t\tif (this._webviewResolvePromise) {\n\t\t\treturn this._webviewResolvePromise;\n\t\t}\n\n\t\tif (!this._webview) {\n\t\t\tthis._ensureWebview(this.getId(), this.textModel.viewType, this.textModel.uri);\n\t\t}\n\n\t\tthis._webviewResolvePromise = (async () => {\n\t\t\tif (!this._webview) {\n\t\t\t\tthrow new Error('Notebook output webview object is not created successfully.');\n\t\t\t}\n\n\t\t\tawait this._webview.createWebview(this.creationOptions.codeWindow ?? mainWindow);\n\t\t\tif (!this._webview.webview) {\n\t\t\t\tthrow new Error('Notebook output webview element was not created successfully.');\n\t\t\t}\n\n\t\t\tthis._localStore.add(this._webview.webview.onDidBlur(() => {\n\t\t\t\tthis._outputFocus.set(false);\n\t\t\t\tthis._webviewFocused = false;\n\n\t\t\t\tthis.updateEditorFocus();\n\t\t\t\tthis.updateCellFocusMode();\n\t\t\t}));\n\n\t\t\tthis._localStore.add(this._webview.webview.onDidFocus(() => {\n\t\t\t\tthis._outputFocus.set(true);\n\t\t\t\tthis.updateEditorFocus();\n\t\t\t\tthis._webviewFocused = true;\n\t\t\t}));\n\n\t\t\tthis._localStore.add(this._webview.onMessage(e => {\n\t\t\t\tthis._onDidReceiveMessage.fire(e);\n\t\t\t}));\n\n\t\t\treturn this._webview;\n\t\t})();\n\n\t\treturn this._webviewResolvePromise;\n\t}\n\n\tprivate _ensureWebview(id: string, viewType: string, resource: URI) {\n\t\tif (this._webview) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst that = this;\n\n\t\tthis._webview = this.instantiationService.createInstance(BackLayerWebView, {\n\t\t\tget creationOptions() { return that.creationOptions; },\n\t\t\tsetScrollTop(scrollTop: number) { that._list.scrollTop = scrollTop; },\n\t\t\ttriggerScroll(event: IMouseWheelEvent) { that._list.triggerScrollFromMouseWheelEvent(event); },\n\t\t\tgetCellByInfo: that.getCellByInfo.bind(that),\n\t\t\tgetCellById: that._getCellById.bind(that),\n\t\t\ttoggleNotebookCellSelection: that._toggleNotebookCellSelection.bind(that),\n\t\t\tfocusNotebookCell: that.focusNotebookCell.bind(that),\n\t\t\tfocusNextNotebookCell: that.focusNextNotebookCell.bind(that),\n\t\t\tupdateOutputHeight: that._updateOutputHeight.bind(that),\n\t\t\tscheduleOutputHeightAck: that._scheduleOutputHeightAck.bind(that),\n\t\t\tupdateMarkupCellHeight: that._updateMarkupCellHeight.bind(that),\n\t\t\tsetMarkupCellEditState: that._setMarkupCellEditState.bind(that),\n\t\t\tdidStartDragMarkupCell: that._didStartDragMarkupCell.bind(that),\n\t\t\tdidDragMarkupCell: that._didDragMarkupCell.bind(that),\n\t\t\tdidDropMarkupCell: that._didDropMarkupCell.bind(that),\n\t\t\tdidEndDragMarkupCell: that._didEndDragMarkupCell.bind(that),\n\t\t\tdidResizeOutput: that._didResizeOutput.bind(that),\n\t\t\tupdatePerformanceMetadata: that._updatePerformanceMetadata.bind(that),\n\t\t\tdidFocusOutputInputChange: that._didFocusOutputInputChange.bind(that),\n\t\t}, id, viewType, resource, {\n\t\t\t...this._notebookOptions.computeWebviewOptions(),\n\t\t\tfontFamily: this._generateFontFamily()\n\t\t}, this.notebookRendererMessaging.getScoped(this._uuid));\n\n\t\tthis._webview.element.style.width = '100%';\n\n\t\t// attach the webview container to the DOM tree first\n\t\tthis._list.attachWebview(this._webview.element);\n\t}\n\n\tprivate async _attachModel(textModel: NotebookTextModel, viewState: INotebookEditorViewState | undefined, perf?: NotebookPerfMarks) {\n\t\tthis._ensureWebview(this.getId(), textModel.viewType, textModel.uri);\n\n\t\tthis.viewModel = this.instantiationService.createInstance(NotebookViewModel, textModel.viewType, textModel, this._viewContext, this.getLayoutInfo(), { isReadOnly: this._readOnly, inRepl: this._inRepl });\n\t\tthis._viewContext.eventDispatcher.emit([new NotebookLayoutChangedEvent({ width: true, fontInfo: true }, this.getLayoutInfo())]);\n\t\tthis.notebookOptions.updateOptions(this._readOnly);\n\n\t\tthis._updateForOptions();\n\t\tthis._updateForNotebookConfiguration();\n\n\t\t// restore view states, including contributions\n\n\t\t{\n\t\t\t// restore view state\n\t\t\tthis.viewModel.restoreEditorViewState(viewState);\n\n\t\t\t// contribution state restore\n\n\t\t\tconst contributionsState = viewState?.contributionsState || {};\n\t\t\tfor (const [id, contribution] of this._contributions) {\n\t\t\t\tif (typeof contribution.restoreViewState === 'function') {\n\t\t\t\t\tcontribution.restoreViewState(contributionsState[id]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis._localStore.add(this.viewModel.onDidChangeViewCells(e => {\n\t\t\tthis._onDidChangeViewCells.fire(e);\n\t\t}));\n\n\t\tthis._localStore.add(this.viewModel.onDidChangeSelection(() => {\n\t\t\tthis._onDidChangeSelection.fire();\n\t\t\tthis.updateSelectedMarkdownPreviews();\n\t\t}));\n\n\t\tthis._localStore.add(this._list.onWillScroll(e => {\n\t\t\tif (this._webview?.isResolved()) {\n\t\t\t\tthis._webviewTransparentCover!.style.transform = `translateY(${e.scrollTop})`;\n\t\t\t}\n\t\t}));\n\n\t\tlet hasPendingChangeContentHeight = false;\n\t\tthis._localStore.add(this._list.onDidChangeContentHeight(() => {\n\t\t\tif (hasPendingChangeContentHeight) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\thasPendingChangeContentHeight = true;\n\n\t\t\tthis._localStore.add(DOM.scheduleAtNextAnimationFrame(DOM.getWindow(this.getDomNode()), () => {\n\t\t\t\thasPendingChangeContentHeight = false;\n\t\t\t\tthis._updateScrollHeight();\n\t\t\t}, 100));\n\t\t}));\n\n\t\tthis._localStore.add(this._list.onDidRemoveOutputs(outputs => {\n\t\t\toutputs.forEach(output => this.removeInset(output));\n\t\t}));\n\t\tthis._localStore.add(this._list.onDidHideOutputs(outputs => {\n\t\t\toutputs.forEach(output => this.hideInset(output));\n\t\t}));\n\t\tthis._localStore.add(this._list.onDidRemoveCellsFromView(cells => {\n\t\t\tconst hiddenCells: MarkupCellViewModel[] = [];\n\t\t\tconst deletedCells: MarkupCellViewModel[] = [];\n\n\t\t\tfor (const cell of cells) {\n\t\t\t\tif (cell.cellKind === CellKind.Markup) {\n\t\t\t\t\tconst mdCell = cell as MarkupCellViewModel;\n\t\t\t\t\tif (this.viewModel?.viewCells.find(cell => cell.handle === mdCell.handle)) {\n\t\t\t\t\t\t// Cell has been folded but is still in model\n\t\t\t\t\t\thiddenCells.push(mdCell);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Cell was deleted\n\t\t\t\t\t\tdeletedCells.push(mdCell);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.hideMarkupPreviews(hiddenCells);\n\t\t\tthis.deleteMarkupPreviews(deletedCells);\n\t\t}));\n\n\t\t// init rendering\n\t\tawait this._warmupWithMarkdownRenderer(this.viewModel, viewState, perf);\n\n\t\tperf?.mark('customMarkdownLoaded');\n\n\t\t// model attached\n\t\tthis._localCellStateListeners = this.viewModel.viewCells.map(cell => this._bindCellListener(cell));\n\t\tthis._lastCellWithEditorFocus = this.viewModel.viewCells.find(viewCell => this.getActiveCell() === viewCell && viewCell.focusMode === CellFocusMode.Editor) ?? null;\n\n\t\tthis._localStore.add(this.viewModel.onDidChangeViewCells((e) => {\n\t\t\tif (this._isDisposed) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// update cell listener\n\t\t\t[...e.splices].reverse().forEach(splice => {\n\t\t\t\tconst [start, deleted, newCells] = splice;\n\t\t\t\tconst deletedCells = this._localCellStateListeners.splice(start, deleted, ...newCells.map(cell => this._bindCellListener(cell)));\n\n\t\t\t\tdispose(deletedCells);\n\t\t\t});\n\n\t\t\tif (e.splices.some(s => s[2].some(cell => cell.cellKind === CellKind.Markup))) {\n\t\t\t\tthis._backgroundMarkdownRendering();\n\t\t\t}\n\t\t}));\n\n\t\tif (this._dimension) {\n\t\t\tthis._list.layout(this.getBodyHeight(this._dimension.height), this._dimension.width);\n\t\t} else {\n\t\t\tthis._list.layout();\n\t\t}\n\n\t\tthis._dndController?.clearGlobalDragState();\n\n\t\t// restore list state at last, it must be after list layout\n\t\tthis.restoreListViewState(viewState);\n\t}\n\n\tprivate _bindCellListener(cell: ICellViewModel) {\n\t\tconst store = new DisposableStore();\n\n\t\tstore.add(cell.onDidChangeLayout(e => {\n\t\t\t// e.totalHeight will be false it's not changed\n\t\t\tif (e.totalHeight || e.outerWidth) {\n\t\t\t\tthis.layoutNotebookCell(cell, cell.layoutInfo.totalHeight, e.context);\n\t\t\t}\n\t\t}));\n\n\t\tif (cell.cellKind === CellKind.Code) {\n\t\t\tstore.add((cell as CodeCellViewModel).onDidRemoveOutputs((outputs) => {\n\t\t\t\toutputs.forEach(output => this.removeInset(output));\n\t\t\t}));\n\t\t}\n\n\t\tstore.add((cell as CellViewModel).onDidChangeState(e => {\n\t\t\tif (e.inputCollapsedChanged && cell.isInputCollapsed && cell.cellKind === CellKind.Markup) {\n\t\t\t\tthis.hideMarkupPreviews([(cell as MarkupCellViewModel)]);\n\t\t\t}\n\n\t\t\tif (e.outputCollapsedChanged && cell.isOutputCollapsed && cell.cellKind === CellKind.Code) {\n\t\t\t\tcell.outputsViewModels.forEach(output => this.hideInset(output));\n\t\t\t}\n\n\t\t\tif (e.focusModeChanged) {\n\t\t\t\tthis._validateCellFocusMode(cell);\n\t\t\t}\n\t\t}));\n\n\t\treturn store;\n\t}\n\n\n\tprivate _lastCellWithEditorFocus: ICellViewModel | null = null;\n\tprivate _validateCellFocusMode(cell: ICellViewModel) {\n\t\tif (cell.focusMode !== CellFocusMode.Editor) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._lastCellWithEditorFocus && this._lastCellWithEditorFocus !== cell) {\n\t\t\tthis._lastCellWithEditorFocus.focusMode = CellFocusMode.Container;\n\t\t}\n\n\t\tthis._lastCellWithEditorFocus = cell;\n\t}\n\n\tprivate async _warmupWithMarkdownRenderer(viewModel: NotebookViewModel, viewState: INotebookEditorViewState | undefined, perf?: NotebookPerfMarks) {\n\n\t\tthis.logService.debug('NotebookEditorWidget', 'warmup ' + this.viewModel?.uri.toString());\n\t\tawait this._resolveWebview();\n\t\tperf?.mark('webviewCommLoaded');\n\n\t\tthis.logService.debug('NotebookEditorWidget', 'warmup - webview resolved');\n\n\t\t// make sure that the webview is not visible otherwise users will see pre-rendered markdown cells in wrong position as the list view doesn't have a correct `top` offset yet\n\t\tthis._webview!.element.style.visibility = 'hidden';\n\t\t// warm up can take around 200ms to load markdown libraries, etc.\n\t\tawait this._warmupViewportMarkdownCells(viewModel, viewState);\n\t\tthis.logService.debug('NotebookEditorWidget', 'warmup - viewport warmed up');\n\n\t\t// todo@rebornix @mjbvz, is this too complicated?\n\n\t\t/* now the webview is ready, and requests to render markdown are fast enough\n\t\t * we can start rendering the list view\n\t\t * render\n\t\t *   - markdown cell -> request to webview to (10ms, basically just latency between UI and iframe)\n\t\t *   - code cell -> render in place\n\t\t */\n\t\tthis._list.layout(0, 0);\n\t\tthis._list.attachViewModel(viewModel);\n\n\t\t// now the list widget has a correct contentHeight/scrollHeight\n\t\t// setting scrollTop will work properly\n\t\t// after setting scroll top, the list view will update `top` of the scrollable element, e.g. `top: -584px`\n\t\tthis._list.scrollTop = viewState?.scrollPosition?.top ?? 0;\n\t\tthis._debug('finish initial viewport warmup and view state restore.');\n\t\tthis._webview!.element.style.visibility = 'visible';\n\t\tthis.logService.debug('NotebookEditorWidget', 'warmup - list view model attached, set to visible');\n\t\tthis._onDidAttachViewModel.fire();\n\t}\n\n\tprivate async _warmupViewportMarkdownCells(viewModel: NotebookViewModel, viewState: INotebookEditorViewState | undefined) {\n\t\tif (viewState && viewState.cellTotalHeights) {\n\t\t\tconst totalHeightCache = viewState.cellTotalHeights;\n\t\t\tconst scrollTop = viewState.scrollPosition?.top ?? 0;\n\t\t\tconst scrollBottom = scrollTop + Math.max(this._dimension?.height ?? 0, 1080);\n\n\t\t\tlet offset = 0;\n\t\t\tconst requests: [ICellViewModel, number][] = [];\n\n\t\t\tfor (let i = 0; i < viewModel.length; i++) {\n\t\t\t\tconst cell = viewModel.cellAt(i)!;\n\t\t\t\tconst cellHeight = totalHeightCache[i] ?? 0;\n\n\t\t\t\tif (offset + cellHeight < scrollTop) {\n\t\t\t\t\toffset += cellHeight;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (cell.cellKind === CellKind.Markup) {\n\t\t\t\t\trequests.push([cell, offset]);\n\t\t\t\t}\n\n\t\t\t\toffset += cellHeight;\n\n\t\t\t\tif (offset > scrollBottom) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tawait this._webview!.initializeMarkup(requests.map(([model, offset]) => this.createMarkupCellInitialization(model, offset)));\n\t\t} else {\n\t\t\tconst initRequests = viewModel.viewCells\n\t\t\t\t.filter(cell => cell.cellKind === CellKind.Markup)\n\t\t\t\t.slice(0, 5)\n\t\t\t\t.map(cell => this.createMarkupCellInitialization(cell, -10000));\n\n\t\t\tawait this._webview!.initializeMarkup(initRequests);\n\n\t\t\t// no cached view state so we are rendering the first viewport\n\t\t\t// after above async call, we already get init height for markdown cells, we can update their offset\n\t\t\tlet offset = 0;\n\t\t\tconst offsetUpdateRequests: { id: string; top: number }[] = [];\n\t\t\tconst scrollBottom = Math.max(this._dimension?.height ?? 0, 1080);\n\t\t\tfor (const cell of viewModel.viewCells) {\n\t\t\t\tif (cell.cellKind === CellKind.Markup) {\n\t\t\t\t\toffsetUpdateRequests.push({ id: cell.id, top: offset });\n\t\t\t\t}\n\n\t\t\t\toffset += cell.getHeight(this.getLayoutInfo().fontInfo.lineHeight);\n\n\t\t\t\tif (offset > scrollBottom) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis._webview?.updateScrollTops([], offsetUpdateRequests);\n\t\t}\n\t}\n\n\tprivate createMarkupCellInitialization(model: ICellViewModel, offset: number): IMarkupCellInitialization {\n\t\treturn ({\n\t\t\tmime: model.mime,\n\t\t\tcellId: model.id,\n\t\t\tcellHandle: model.handle,\n\t\t\tcontent: model.getText(),\n\t\t\toffset: offset,\n\t\t\tvisible: false,\n\t\t\tmetadata: model.metadata,\n\t\t});\n\t}\n\n\trestoreListViewState(viewState: INotebookEditorViewState | undefined): void {\n\t\tif (!this.viewModel) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (viewState?.scrollPosition !== undefined) {\n\t\t\tthis._list.scrollTop = viewState.scrollPosition.top;\n\t\t\tthis._list.scrollLeft = viewState.scrollPosition.left;\n\t\t} else {\n\t\t\tthis._list.scrollTop = 0;\n\t\t\tthis._list.scrollLeft = 0;\n\t\t}\n\n\t\tconst focusIdx = typeof viewState?.focus === 'number' ? viewState.focus : 0;\n\t\tif (focusIdx < this.viewModel.length) {\n\t\t\tconst element = this.viewModel.cellAt(focusIdx);\n\t\t\tif (element) {\n\t\t\t\tthis.viewModel?.updateSelectionsState({\n\t\t\t\t\tkind: SelectionStateType.Handle,\n\t\t\t\t\tprimary: element.handle,\n\t\t\t\t\tselections: [element.handle]\n\t\t\t\t});\n\t\t\t}\n\t\t} else if (this._list.length > 0) {\n\t\t\tthis.viewModel.updateSelectionsState({\n\t\t\t\tkind: SelectionStateType.Index,\n\t\t\t\tfocus: { start: 0, end: 1 },\n\t\t\t\tselections: [{ start: 0, end: 1 }]\n\t\t\t});\n\t\t}\n\n\t\tif (viewState?.editorFocused) {\n\t\t\tconst cell = this.viewModel.cellAt(focusIdx);\n\t\t\tif (cell) {\n\t\t\t\tcell.focusMode = CellFocusMode.Editor;\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _restoreSelectedKernel(viewState: INotebookEditorViewState | undefined): void {\n\t\tif (viewState?.selectedKernelId && this.textModel) {\n\t\t\tconst matching = this.notebookKernelService.getMatchingKernel(this.textModel);\n\t\t\tconst kernel = matching.all.find(k => k.id === viewState.selectedKernelId);\n\t\t\t// Selected kernel may have already been picked prior to the view state loading\n\t\t\t// If so, don't overwrite it with the saved kernel.\n\t\t\tif (kernel && !matching.selected) {\n\t\t\t\tthis.notebookKernelService.selectKernelForNotebook(kernel, this.textModel);\n\t\t\t}\n\t\t}\n\t}\n\n\tgetEditorViewState(): INotebookEditorViewState {\n\t\tconst state = this.viewModel?.getEditorViewState();\n\t\tif (!state) {\n\t\t\treturn {\n\t\t\t\teditingCells: {},\n\t\t\t\tcellLineNumberStates: {},\n\t\t\t\teditorViewStates: {},\n\t\t\t\tcollapsedInputCells: {},\n\t\t\t\tcollapsedOutputCells: {},\n\t\t\t};\n\t\t}\n\n\t\tif (this._list) {\n\t\t\tstate.scrollPosition = { left: this._list.scrollLeft, top: this._list.scrollTop };\n\t\t\tconst cellHeights: { [key: number]: number } = {};\n\t\t\tfor (let i = 0; i < this.viewModel!.length; i++) {\n\t\t\t\tconst elm = this.viewModel!.cellAt(i) as CellViewModel;\n\t\t\t\tcellHeights[i] = elm.layoutInfo.totalHeight;\n\t\t\t}\n\n\t\t\tstate.cellTotalHeights = cellHeights;\n\n\t\t\tif (this.viewModel) {\n\t\t\t\tconst focusRange = this.viewModel.getFocus();\n\t\t\t\tconst element = this.viewModel.cellAt(focusRange.start);\n\t\t\t\tif (element) {\n\t\t\t\t\tconst itemDOM = this._list.domElementOfElement(element);\n\t\t\t\t\tconst editorFocused = element.getEditState() === CellEditState.Editing && !!(itemDOM && itemDOM.ownerDocument.activeElement && itemDOM.contains(itemDOM.ownerDocument.activeElement));\n\n\t\t\t\t\tstate.editorFocused = editorFocused;\n\t\t\t\t\tstate.focus = focusRange.start;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Save contribution view states\n\t\tconst contributionsState: { [key: string]: unknown } = {};\n\t\tfor (const [id, contribution] of this._contributions) {\n\t\t\tif (typeof contribution.saveViewState === 'function') {\n\t\t\t\tcontributionsState[id] = contribution.saveViewState();\n\t\t\t}\n\t\t}\n\t\tstate.contributionsState = contributionsState;\n\t\tif (this.textModel?.uri.scheme === Schemas.untitled) {\n\t\t\tstate.selectedKernelId = this.activeKernel?.id;\n\t\t}\n\n\t\treturn state;\n\t}\n\n\tprivate _allowScrollBeyondLastLine() {\n\t\treturn this._scrollBeyondLastLine && !this.isEmbedded;\n\t}\n\n\tprivate getBodyHeight(dimensionHeight: number) {\n\t\treturn Math.max(dimensionHeight - (this._notebookTopToolbar?.useGlobalToolbar ? /** Toolbar height */ 26 : 0), 0);\n\t}\n\n\tlayout(dimension: DOM.Dimension, shadowElement?: HTMLElement, position?: DOM.IDomPosition): void {\n\t\tif (!shadowElement && this._shadowElementViewInfo === null) {\n\t\t\tthis._dimension = dimension;\n\t\t\tthis._position = position;\n\t\t\treturn;\n\t\t}\n\n\t\tif (dimension.width <= 0 || dimension.height <= 0) {\n\t\t\tthis.onWillHide();\n\t\t\treturn;\n\t\t}\n\n\t\tconst whenContainerStylesLoaded = this.layoutService.whenContainerStylesLoaded(DOM.getWindow(this.getDomNode()));\n\t\tif (whenContainerStylesLoaded) {\n\t\t\t// In floating windows, we need to ensure that the\n\t\t\t// container is ready for us to compute certain\n\t\t\t// layout related properties.\n\t\t\twhenContainerStylesLoaded.then(() => this.layoutNotebook(dimension, shadowElement, position));\n\t\t} else {\n\t\t\tthis.layoutNotebook(dimension, shadowElement, position);\n\t\t}\n\n\t}\n\n\tprivate layoutNotebook(dimension: DOM.Dimension, shadowElement?: HTMLElement, position?: DOM.IDomPosition) {\n\t\tif (shadowElement) {\n\t\t\tthis.updateShadowElement(shadowElement, dimension, position);\n\t\t}\n\n\t\tif (this._shadowElementViewInfo && this._shadowElementViewInfo.width <= 0 && this._shadowElementViewInfo.height <= 0) {\n\t\t\tthis.onWillHide();\n\t\t\treturn;\n\t\t}\n\n\t\tthis._dimension = dimension;\n\t\tthis._position = position;\n\t\tconst newBodyHeight = this.getBodyHeight(dimension.height) - this.getLayoutInfo().stickyHeight;\n\t\tDOM.size(this._body, dimension.width, newBodyHeight);\n\n\t\tconst newCellListHeight = newBodyHeight;\n\t\tif (this._list.getRenderHeight() < newCellListHeight) {\n\t\t\t// the new dimension is larger than the list viewport, update its additional height first, otherwise the list view will move down a bit (as the `scrollBottom` will move down)\n\t\t\tthis._list.updateOptions({ paddingBottom: this._allowScrollBeyondLastLine() ? Math.max(0, (newCellListHeight - 50)) : 0, paddingTop: 0 });\n\t\t\tthis._list.layout(newCellListHeight, dimension.width);\n\t\t} else {\n\t\t\t// the new dimension is smaller than the list viewport, if we update the additional height, the `scrollBottom` will move up, which moves the whole list view upwards a bit. So we run a layout first.\n\t\t\tthis._list.layout(newCellListHeight, dimension.width);\n\t\t\tthis._list.updateOptions({ paddingBottom: this._allowScrollBeyondLastLine() ? Math.max(0, (newCellListHeight - 50)) : 0, paddingTop: 0 });\n\t\t}\n\n\t\tthis._overlayContainer.inert = false;\n\t\tthis._overlayContainer.style.visibility = 'visible';\n\t\tthis._overlayContainer.style.display = 'block';\n\t\tthis._overlayContainer.style.position = 'absolute';\n\t\tthis._overlayContainer.style.overflow = 'hidden';\n\n\t\tthis.layoutContainerOverShadowElement(dimension, position);\n\n\t\tif (this._webviewTransparentCover) {\n\t\t\tthis._webviewTransparentCover.style.height = `${dimension.height}px`;\n\t\t\tthis._webviewTransparentCover.style.width = `${dimension.width}px`;\n\t\t}\n\n\t\tthis._notebookTopToolbar.layout(this._dimension);\n\t\tthis._notebookOverviewRuler.layout();\n\n\t\tthis._viewContext?.eventDispatcher.emit([new NotebookLayoutChangedEvent({ width: true, fontInfo: true }, this.getLayoutInfo())]);\n\t}\n\n\tprivate updateShadowElement(shadowElement: HTMLElement, dimension?: IDimension, position?: DOM.IDomPosition) {\n\t\tthis._shadowElement = shadowElement;\n\t\tif (dimension && position) {\n\t\t\tthis._shadowElementViewInfo = {\n\t\t\t\theight: dimension.height,\n\t\t\t\twidth: dimension.width,\n\t\t\t\ttop: position.top,\n\t\t\t\tleft: position.left,\n\t\t\t};\n\t\t} else {\n\t\t\t// We have to recompute position and size ourselves (which is slow)\n\t\t\tconst containerRect = shadowElement.getBoundingClientRect();\n\t\t\tthis._shadowElementViewInfo = {\n\t\t\t\theight: containerRect.height,\n\t\t\t\twidth: containerRect.width,\n\t\t\t\ttop: containerRect.top,\n\t\t\t\tleft: containerRect.left\n\t\t\t};\n\t\t}\n\t}\n\n\tprivate layoutContainerOverShadowElement(dimension?: DOM.Dimension, position?: DOM.IDomPosition): void {\n\t\tif (dimension && position) {\n\t\t\tthis._overlayContainer.style.top = `${position.top}px`;\n\t\t\tthis._overlayContainer.style.left = `${position.left}px`;\n\t\t\tthis._overlayContainer.style.width = `${dimension.width}px`;\n\t\t\tthis._overlayContainer.style.height = `${dimension.height}px`;\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._shadowElementViewInfo) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst elementContainerRect = this._overlayContainer.parentElement?.getBoundingClientRect();\n\t\tthis._overlayContainer.style.top = `${this._shadowElementViewInfo.top - (elementContainerRect?.top || 0)}px`;\n\t\tthis._overlayContainer.style.left = `${this._shadowElementViewInfo.left - (elementContainerRect?.left || 0)}px`;\n\t\tthis._overlayContainer.style.width = `${dimension ? dimension.width : this._shadowElementViewInfo.width}px`;\n\t\tthis._overlayContainer.style.height = `${dimension ? dimension.height : this._shadowElementViewInfo.height}px`;\n\t}\n\n\t//#endregion\n\n\t//#region Focus tracker\n\tfocus() {\n\t\tthis._isVisible = true;\n\t\tthis._editorFocus.set(true);\n\n\t\tif (this._webviewFocused) {\n\t\t\tthis._webview?.focusWebview();\n\t\t} else {\n\t\t\tif (this.viewModel) {\n\t\t\t\tconst focusRange = this.viewModel.getFocus();\n\t\t\t\tconst element = this.viewModel.cellAt(focusRange.start);\n\n\t\t\t\t// The notebook editor doesn't have focus yet\n\t\t\t\tif (!this.hasEditorFocus()) {\n\t\t\t\t\tthis.focusContainer();\n\t\t\t\t\t// trigger editor to update as FocusTracker might not emit focus change event\n\t\t\t\t\tthis.updateEditorFocus();\n\t\t\t\t}\n\n\t\t\t\tif (element && element.focusMode === CellFocusMode.Editor) {\n\t\t\t\t\telement.updateEditState(CellEditState.Editing, 'editorWidget.focus');\n\t\t\t\t\telement.focusMode = CellFocusMode.Editor;\n\t\t\t\t\tthis.focusEditor(element);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis._list.domFocus();\n\t\t}\n\n\t\tif (this._currentProgress) {\n\t\t\t// The editor forces progress to hide when switching editors. So if progress should be visible, force it to show when the editor is focused.\n\t\t\tthis.showProgress();\n\t\t}\n\t}\n\n\tonShow() {\n\t\tthis._isVisible = true;\n\t}\n\n\tprivate focusEditor(activeElement: CellViewModel): void {\n\t\tfor (const [element, editor] of this._renderedEditors.entries()) {\n\t\t\tif (element === activeElement) {\n\t\t\t\teditor.focus();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n\n\tfocusContainer(clearSelection: boolean = false) {\n\t\tif (this._webviewFocused) {\n\t\t\tthis._webview?.focusWebview();\n\t\t} else {\n\t\t\tthis._list.focusContainer(clearSelection);\n\t\t}\n\t}\n\n\tselectOutputContent(cell: ICellViewModel) {\n\t\tthis._webview?.selectOutputContents(cell);\n\t}\n\n\tselectInputContents(cell: ICellViewModel) {\n\t\tthis._webview?.selectInputContents(cell);\n\t}\n\n\tonWillHide() {\n\t\tthis._isVisible = false;\n\t\tthis._editorFocus.set(false);\n\t\tthis._overlayContainer.inert = true;\n\t\tthis._overlayContainer.style.visibility = 'hidden';\n\t\tthis._overlayContainer.style.left = '-50000px';\n\t\tthis._notebookTopToolbarContainer.style.display = 'none';\n\t\tthis.clearActiveCellWidgets();\n\t}\n\n\tprivate clearActiveCellWidgets() {\n\t\tthis._renderedEditors.forEach((editor, cell) => {\n\t\t\tif (this.getActiveCell() === cell && editor) {\n\t\t\t\tSuggestController.get(editor)?.cancelSuggestWidget();\n\t\t\t\tDropIntoEditorController.get(editor)?.clearWidgets();\n\t\t\t\tCopyPasteController.get(editor)?.clearWidgets();\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate editorHasDomFocus(): boolean {\n\t\treturn DOM.isAncestorOfActiveElement(this.getDomNode());\n\t}\n\n\tupdateEditorFocus() {\n\t\t// Note - focus going to the webview will fire 'blur', but the webview element will be\n\t\t// a descendent of the notebook editor root.\n\t\tthis._focusTracker.refreshState();\n\t\tconst focused = this.editorHasDomFocus();\n\t\tthis._editorFocus.set(focused);\n\t\tthis.viewModel?.setEditorFocus(focused);\n\t}\n\n\tupdateCellFocusMode() {\n\t\tconst activeCell = this.getActiveCell();\n\n\t\tif (activeCell?.focusMode === CellFocusMode.Output && !this._webviewFocused) {\n\t\t\t// output previously has focus, but now it's blurred.\n\t\t\tactiveCell.focusMode = CellFocusMode.Container;\n\t\t}\n\t}\n\n\thasEditorFocus() {\n\t\t// _editorFocus is driven by the FocusTracker, which is only guaranteed to _eventually_ fire blur.\n\t\t// If we need to know whether we have focus at this instant, we need to check the DOM manually.\n\t\tthis.updateEditorFocus();\n\t\treturn this.editorHasDomFocus();\n\t}\n\n\thasWebviewFocus() {\n\t\treturn this._webviewFocused;\n\t}\n\n\thasOutputTextSelection() {\n\t\tif (!this.hasEditorFocus()) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst windowSelection = DOM.getWindow(this.getDomNode()).getSelection();\n\t\tif (windowSelection?.rangeCount !== 1) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst activeSelection = windowSelection.getRangeAt(0);\n\t\tif (activeSelection.startContainer === activeSelection.endContainer && activeSelection.endOffset - activeSelection.startOffset === 0) {\n\t\t\treturn false;\n\t\t}\n\n\t\tlet container: any = activeSelection.commonAncestorContainer;\n\n\t\tif (!this._body.contains(container)) {\n\t\t\treturn false;\n\t\t}\n\n\t\twhile (container\n\t\t\t&&\n\t\t\tcontainer !== this._body) {\n\t\t\tif ((container as HTMLElement).classList && (container as HTMLElement).classList.contains('output')) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tcontainer = container.parentNode;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\t_didFocusOutputInputChange(hasFocus: boolean) {\n\t\tthis._outputInputFocus.set(hasFocus);\n\t}\n\n\t//#endregion\n\n\t//#region Editor Features\n\n\tfocusElement(cell: ICellViewModel) {\n\t\tthis.viewModel?.updateSelectionsState({\n\t\t\tkind: SelectionStateType.Handle,\n\t\t\tprimary: cell.handle,\n\t\t\tselections: [cell.handle]\n\t\t});\n\t}\n\n\tget scrollTop() {\n\t\treturn this._list.scrollTop;\n\t}\n\n\tget scrollBottom() {\n\t\treturn this._list.scrollTop + this._list.getRenderHeight();\n\t}\n\n\tgetAbsoluteTopOfElement(cell: ICellViewModel) {\n\t\treturn this._list.getCellViewScrollTop(cell);\n\t}\n\n\tgetHeightOfElement(cell: ICellViewModel) {\n\t\treturn this._list.elementHeight(cell);\n\t}\n\n\tscrollToBottom() {\n\t\tthis._list.scrollToBottom();\n\t}\n\n\tsetScrollTop(scrollTop: number): void {\n\t\tthis._list.scrollTop = scrollTop;\n\t}\n\n\trevealCellRangeInView(range: ICellRange) {\n\t\treturn this._list.revealCells(range);\n\t}\n\n\trevealInView(cell: ICellViewModel) {\n\t\treturn this._list.revealCell(cell, CellRevealType.Default);\n\t}\n\n\trevealInViewAtTop(cell: ICellViewModel) {\n\t\tthis._list.revealCell(cell, CellRevealType.Top);\n\t}\n\n\trevealInCenter(cell: ICellViewModel) {\n\t\tthis._list.revealCell(cell, CellRevealType.Center);\n\t}\n\n\tasync revealInCenterIfOutsideViewport(cell: ICellViewModel) {\n\t\tawait this._list.revealCell(cell, CellRevealType.CenterIfOutsideViewport);\n\t}\n\n\tasync revealFirstLineIfOutsideViewport(cell: ICellViewModel) {\n\t\tawait this._list.revealCell(cell, CellRevealType.FirstLineIfOutsideViewport);\n\t}\n\n\tasync revealLineInViewAsync(cell: ICellViewModel, line: number): Promise<void> {\n\t\treturn this._list.revealRangeInCell(cell, new Range(line, 1, line, 1), CellRevealRangeType.Default);\n\t}\n\n\tasync revealLineInCenterAsync(cell: ICellViewModel, line: number): Promise<void> {\n\t\treturn this._list.revealRangeInCell(cell, new Range(line, 1, line, 1), CellRevealRangeType.Center);\n\t}\n\n\tasync revealLineInCenterIfOutsideViewportAsync(cell: ICellViewModel, line: number): Promise<void> {\n\t\treturn this._list.revealRangeInCell(cell, new Range(line, 1, line, 1), CellRevealRangeType.CenterIfOutsideViewport);\n\t}\n\n\tasync revealRangeInViewAsync(cell: ICellViewModel, range: Selection | Range): Promise<void> {\n\t\treturn this._list.revealRangeInCell(cell, range, CellRevealRangeType.Default);\n\t}\n\n\tasync revealRangeInCenterAsync(cell: ICellViewModel, range: Selection | Range): Promise<void> {\n\t\treturn this._list.revealRangeInCell(cell, range, CellRevealRangeType.Center);\n\t}\n\n\tasync revealRangeInCenterIfOutsideViewportAsync(cell: ICellViewModel, range: Selection | Range): Promise<void> {\n\t\treturn this._list.revealRangeInCell(cell, range, CellRevealRangeType.CenterIfOutsideViewport);\n\t}\n\n\trevealCellOffsetInCenter(cell: ICellViewModel, offset: number) {\n\t\treturn this._list.revealCellOffsetInCenter(cell, offset);\n\t}\n\n\trevealOffsetInCenterIfOutsideViewport(offset: number) {\n\t\treturn this._list.revealOffsetInCenterIfOutsideViewport(offset);\n\t}\n\n\tgetViewIndexByModelIndex(index: number): number {\n\t\tif (!this._listViewInfoAccessor) {\n\t\t\treturn -1;\n\t\t}\n\t\tconst cell = this.viewModel?.viewCells[index];\n\t\tif (!cell) {\n\t\t\treturn -1;\n\t\t}\n\n\t\treturn this._listViewInfoAccessor.getViewIndex(cell);\n\t}\n\n\tgetViewHeight(cell: ICellViewModel): number {\n\t\tif (!this._listViewInfoAccessor) {\n\t\t\treturn -1;\n\t\t}\n\n\t\treturn this._listViewInfoAccessor.getViewHeight(cell);\n\t}\n\n\tgetCellRangeFromViewRange(startIndex: number, endIndex: number): ICellRange | undefined {\n\t\treturn this._listViewInfoAccessor.getCellRangeFromViewRange(startIndex, endIndex);\n\t}\n\n\tgetCellsInRange(range?: ICellRange): ReadonlyArray<ICellViewModel> {\n\t\treturn this._listViewInfoAccessor.getCellsInRange(range);\n\t}\n\n\tsetCellEditorSelection(cell: ICellViewModel, range: Range): void {\n\t\tthis._list.setCellEditorSelection(cell, range);\n\t}\n\n\tsetHiddenAreas(_ranges: ICellRange[]): boolean {\n\t\treturn this._list.setHiddenAreas(_ranges, true);\n\t}\n\n\tgetVisibleRangesPlusViewportAboveAndBelow(): ICellRange[] {\n\t\treturn this._listViewInfoAccessor.getVisibleRangesPlusViewportAboveAndBelow();\n\t}\n\n\t//#endregion\n\n\t//#region Decorations\n\n\tdeltaCellDecorations(oldDecorations: string[], newDecorations: INotebookDeltaDecoration[]): string[] {\n\t\tconst ret = this.viewModel?.deltaCellDecorations(oldDecorations, newDecorations) || [];\n\t\tthis._onDidChangeDecorations.fire();\n\t\treturn ret;\n\t}\n\n\tdeltaCellContainerClassNames(cellId: string, added: string[], removed: string[]) {\n\t\tthis._webview?.deltaCellContainerClassNames(cellId, added, removed);\n\t}\n\n\tchangeModelDecorations<T>(callback: (changeAccessor: IModelDecorationsChangeAccessor) => T): T | null {\n\t\treturn this.viewModel?.changeModelDecorations<T>(callback) || null;\n\t}\n\n\t//#endregion\n\n\t//#region View Zones\n\tchangeViewZones(callback: (accessor: INotebookViewZoneChangeAccessor) => void): void {\n\t\tthis._list.changeViewZones(callback);\n\t}\n\t//#endregion\n\n\t//#region Kernel/Execution\n\n\tprivate async _loadKernelPreloads(): Promise<void> {\n\t\tif (!this.hasModel()) {\n\t\t\treturn;\n\t\t}\n\t\tconst { selected } = this.notebookKernelService.getMatchingKernel(this.textModel);\n\t\tif (!this._webview?.isResolved()) {\n\t\t\tawait this._resolveWebview();\n\t\t}\n\t\tthis._webview?.updateKernelPreloads(selected);\n\t}\n\n\tget activeKernel() {\n\t\treturn this.textModel && this.notebookKernelService.getSelectedOrSuggestedKernel(this.textModel);\n\t}\n\n\tasync cancelNotebookCells(cells?: Iterable<ICellViewModel>): Promise<void> {\n\t\tif (!this.viewModel || !this.hasModel()) {\n\t\t\treturn;\n\t\t}\n\t\tif (!cells) {\n\t\t\tcells = this.viewModel.viewCells;\n\t\t}\n\t\treturn this.notebookExecutionService.cancelNotebookCellHandles(this.textModel, Array.from(cells).map(cell => cell.handle));\n\t}\n\n\tasync executeNotebookCells(cells?: Iterable<ICellViewModel>): Promise<void> {\n\t\tif (!this.viewModel || !this.hasModel()) {\n\t\t\tthis.logService.info('notebookEditorWidget', 'No NotebookViewModel, cannot execute cells');\n\t\t\treturn;\n\t\t}\n\t\tif (!cells) {\n\t\t\tcells = this.viewModel.viewCells;\n\t\t}\n\t\treturn this.notebookExecutionService.executeNotebookCells(this.textModel, Array.from(cells).map(c => c.model), this.scopedContextKeyService);\n\t}\n\n\t//#endregion\n\n\t//#region Cell operations/layout API\n\tprivate _pendingLayouts: WeakMap<ICellViewModel, IDisposable> | null = new WeakMap<ICellViewModel, IDisposable>();\n\tasync layoutNotebookCell(cell: ICellViewModel, height: number, context?: CellLayoutContext): Promise<void> {\n\t\tthis._debug('layout cell', cell.handle, height);\n\t\tconst viewIndex = this._list.getViewIndex(cell);\n\t\tif (viewIndex === undefined) {\n\t\t\t// the cell is hidden\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._pendingLayouts?.has(cell)) {\n\t\t\tthis._pendingLayouts?.get(cell)!.dispose();\n\t\t}\n\n\t\tconst deferred = new DeferredPromise<void>();\n\t\tconst doLayout = () => {\n\t\t\tif (this._isDisposed) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!this.viewModel?.hasCell(cell)) {\n\t\t\t\t// Cell removed in the meantime?\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this._list.getViewIndex(cell) === undefined) {\n\t\t\t\t// Cell can be hidden\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this._list.elementHeight(cell) === height) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis._pendingLayouts?.delete(cell);\n\n\t\t\tif (!this.hasEditorFocus()) {\n\t\t\t\t// Do not scroll inactive notebook\n\t\t\t\t// https://github.com/microsoft/vscode/issues/145340\n\t\t\t\tconst cellIndex = this.viewModel?.getCellIndex(cell);\n\t\t\t\tconst visibleRanges = this.visibleRanges;\n\t\t\t\tif (cellIndex !== undefined\n\t\t\t\t\t&& visibleRanges && visibleRanges.length && visibleRanges[0].start === cellIndex\n\t\t\t\t\t// cell is partially visible\n\t\t\t\t\t&& this._list.scrollTop > this.getAbsoluteTopOfElement(cell)\n\t\t\t\t) {\n\t\t\t\t\treturn this._list.updateElementHeight2(cell, height, Math.min(cellIndex + 1, this.getLength() - 1));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis._list.updateElementHeight2(cell, height);\n\t\t\tdeferred.complete(undefined);\n\t\t};\n\n\t\tif (this._list.inRenderingTransaction) {\n\t\t\tconst layoutDisposable = DOM.scheduleAtNextAnimationFrame(DOM.getWindow(this.getDomNode()), doLayout);\n\n\t\t\tthis._pendingLayouts?.set(cell, toDisposable(() => {\n\t\t\t\tlayoutDisposable.dispose();\n\t\t\t\tdeferred.complete(undefined);\n\t\t\t}));\n\t\t} else {\n\t\t\tdoLayout();\n\t\t}\n\n\t\treturn deferred.p;\n\t}\n\n\tgetActiveCell() {\n\t\tconst elements = this._list.getFocusedElements();\n\n\t\tif (elements && elements.length) {\n\t\t\treturn elements[0];\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tprivate _toggleNotebookCellSelection(selectedCell: ICellViewModel, selectFromPrevious: boolean): void {\n\t\tconst currentSelections = this._list.getSelectedElements();\n\t\tconst isSelected = currentSelections.includes(selectedCell);\n\n\t\tconst previousSelection = selectFromPrevious ? currentSelections[currentSelections.length - 1] ?? selectedCell : selectedCell;\n\t\tconst selectedIndex = this._list.getViewIndex(selectedCell)!;\n\t\tconst previousIndex = this._list.getViewIndex(previousSelection)!;\n\n\t\tconst cellsInSelectionRange = this.getCellsInViewRange(selectedIndex, previousIndex);\n\t\tif (isSelected) {\n\t\t\t// Deselect\n\t\t\tthis._list.selectElements(currentSelections.filter(current => !cellsInSelectionRange.includes(current)));\n\t\t} else {\n\t\t\t// Add to selection\n\t\t\tthis.focusElement(selectedCell);\n\t\t\tthis._list.selectElements([...currentSelections.filter(current => !cellsInSelectionRange.includes(current)), ...cellsInSelectionRange]);\n\t\t}\n\t}\n\n\tprivate getCellsInViewRange(fromInclusive: number, toInclusive: number): ICellViewModel[] {\n\t\tconst selectedCellsInRange: ICellViewModel[] = [];\n\t\tfor (let index = 0; index < this._list.length; ++index) {\n\t\t\tconst cell = this._list.element(index);\n\t\t\tif (cell) {\n\t\t\t\tif ((index >= fromInclusive && index <= toInclusive) || (index >= toInclusive && index <= fromInclusive)) {\n\t\t\t\t\tselectedCellsInRange.push(cell);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn selectedCellsInRange;\n\t}\n\n\tasync focusNotebookCell(cell: ICellViewModel, focusItem: 'editor' | 'container' | 'output', options?: IFocusNotebookCellOptions) {\n\t\tif (this._isDisposed) {\n\t\t\treturn;\n\t\t}\n\n\t\tcell.focusedOutputId = undefined;\n\n\t\tif (focusItem === 'editor') {\n\t\t\tthis.focusElement(cell);\n\t\t\tthis._list.focusView();\n\n\t\t\tcell.updateEditState(CellEditState.Editing, 'focusNotebookCell');\n\t\t\tcell.focusMode = CellFocusMode.Editor;\n\t\t\tif (!options?.skipReveal) {\n\t\t\t\tif (typeof options?.focusEditorLine === 'number') {\n\t\t\t\t\tthis._cursorNavMode.set(true);\n\t\t\t\t\tawait this.revealLineInViewAsync(cell, options.focusEditorLine);\n\t\t\t\t\tconst editor = this._renderedEditors.get(cell)!;\n\t\t\t\t\tconst focusEditorLine = options.focusEditorLine;\n\t\t\t\t\teditor?.setSelection({\n\t\t\t\t\t\tstartLineNumber: focusEditorLine,\n\t\t\t\t\t\tstartColumn: 1,\n\t\t\t\t\t\tendLineNumber: focusEditorLine,\n\t\t\t\t\t\tendColumn: 1\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tconst selectionsStartPosition = cell.getSelectionsStartPosition();\n\t\t\t\t\tif (selectionsStartPosition?.length) {\n\t\t\t\t\t\tconst firstSelectionPosition = selectionsStartPosition[0];\n\t\t\t\t\t\tawait this.revealRangeInViewAsync(cell, Range.fromPositions(firstSelectionPosition, firstSelectionPosition));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tawait this.revealInView(cell);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\t\t} else if (focusItem === 'output') {\n\t\t\tthis.focusElement(cell);\n\n\t\t\tif (!this.hasEditorFocus()) {\n\t\t\t\tthis._list.focusView();\n\t\t\t}\n\n\t\t\tif (!this._webview) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst firstOutputId = cell.outputsViewModels.find(o => o.model.alternativeOutputId)?.model.alternativeOutputId;\n\t\t\tconst focusElementId = options?.outputId ?? firstOutputId ?? cell.id;\n\t\t\tthis._webview.focusOutput(focusElementId, options?.altOutputId, options?.outputWebviewFocused || this._webviewFocused);\n\n\t\t\tcell.updateEditState(CellEditState.Preview, 'focusNotebookCell');\n\t\t\tcell.focusMode = CellFocusMode.Output;\n\t\t\tcell.focusedOutputId = options?.outputId;\n\t\t\tthis._outputFocus.set(true);\n\t\t\tif (!options?.skipReveal) {\n\t\t\t\tthis.revealInCenterIfOutsideViewport(cell);\n\t\t\t}\n\t\t} else {\n\t\t\t// focus container\n\t\t\tconst itemDOM = this._list.domElementOfElement(cell);\n\t\t\tif (itemDOM && itemDOM.ownerDocument.activeElement && itemDOM.contains(itemDOM.ownerDocument.activeElement)) {\n\t\t\t\t(itemDOM.ownerDocument.activeElement as HTMLElement).blur();\n\t\t\t}\n\n\t\t\tthis._webview?.blurOutput();\n\n\t\t\tcell.updateEditState(CellEditState.Preview, 'focusNotebookCell');\n\t\t\tcell.focusMode = CellFocusMode.Container;\n\n\t\t\tthis.focusElement(cell);\n\t\t\tif (!options?.skipReveal) {\n\t\t\t\tif (typeof options?.focusEditorLine === 'number') {\n\t\t\t\t\tthis._cursorNavMode.set(true);\n\t\t\t\t\tawait this.revealInView(cell);\n\t\t\t\t} else if (options?.revealBehavior === ScrollToRevealBehavior.firstLine) {\n\t\t\t\t\tawait this.revealFirstLineIfOutsideViewport(cell);\n\t\t\t\t} else if (options?.revealBehavior === ScrollToRevealBehavior.fullCell) {\n\t\t\t\t\tawait this.revealInView(cell);\n\t\t\t\t} else {\n\t\t\t\t\tawait this.revealInCenterIfOutsideViewport(cell);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._list.focusView();\n\t\t\tthis.updateEditorFocus();\n\t\t}\n\t}\n\n\tasync focusNextNotebookCell(cell: ICellViewModel, focusItem: 'editor' | 'container' | 'output') {\n\t\tconst idx = this.viewModel?.getCellIndex(cell);\n\t\tif (typeof idx !== 'number') {\n\t\t\treturn;\n\t\t}\n\n\t\tconst newCell = this.viewModel?.cellAt(idx + 1);\n\t\tif (!newCell) {\n\t\t\treturn;\n\t\t}\n\n\t\tawait this.focusNotebookCell(newCell, focusItem);\n\t}\n\n\t//#endregion\n\n\t//#region Find\n\n\tprivate async _warmupCell(viewCell: CodeCellViewModel) {\n\t\tif (viewCell.isOutputCollapsed) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst outputs = viewCell.outputsViewModels;\n\t\tfor (const output of outputs.slice(0, outputDisplayLimit)) {\n\t\t\tconst [mimeTypes, pick] = output.resolveMimeTypes(this.textModel!, undefined);\n\t\t\tif (!mimeTypes.find(mimeType => mimeType.isTrusted) || mimeTypes.length === 0) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst pickedMimeTypeRenderer = mimeTypes[pick];\n\n\t\t\tif (!pickedMimeTypeRenderer) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst renderer = this._notebookService.getRendererInfo(pickedMimeTypeRenderer.rendererId);\n\n\t\t\tif (!renderer) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst result: IInsetRenderOutput = { type: RenderOutputType.Extension, renderer, source: output, mimeType: pickedMimeTypeRenderer.mimeType };\n\t\t\tconst inset = this._webview?.insetMapping.get(result.source);\n\t\t\tif (!inset || !inset.initialized) {\n\t\t\t\tconst p = new Promise<void>(resolve => {\n\t\t\t\t\tthis._register(Event.any(this.onDidRenderOutput, this.onDidRemoveOutput)(e => {\n\t\t\t\t\t\tif (e.model === result.source.model) {\n\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t}\n\t\t\t\t\t}));\n\t\t\t\t});\n\t\t\t\tthis.createOutput(viewCell, result, 0, false);\n\t\t\t\tawait p;\n\t\t\t} else {\n\t\t\t\t// request to update its visibility\n\t\t\t\tthis.createOutput(viewCell, result, 0, false);\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t}\n\n\tprivate async _warmupAll(includeOutput: boolean) {\n\t\tif (!this.hasModel() || !this.viewModel) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst cells = this.viewModel.viewCells;\n\t\tconst requests = [];\n\n\t\tfor (let i = 0; i < cells.length; i++) {\n\t\t\tif (cells[i].cellKind === CellKind.Markup && !this._webview!.markupPreviewMapping.has(cells[i].id)) {\n\t\t\t\trequests.push(this.createMarkupPreview(cells[i]));\n\t\t\t}\n\t\t}\n\n\t\tif (includeOutput && this._list) {\n\t\t\tfor (let i = 0; i < this._list.length; i++) {\n\t\t\t\tconst cell = this._list.element(i);\n\n\t\t\t\tif (cell?.cellKind === CellKind.Code) {\n\t\t\t\t\trequests.push(this._warmupCell((cell as CodeCellViewModel)));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn Promise.all(requests);\n\t}\n\n\tasync find(query: string, options: INotebookFindOptions, token: CancellationToken, skipWarmup: boolean = false, shouldGetSearchPreviewInfo = false, ownerID?: string): Promise<CellFindMatchWithIndex[]> {\n\t\tif (!this._notebookViewModel) {\n\t\t\treturn [];\n\t\t}\n\n\t\tif (!ownerID) {\n\t\t\townerID = this.getId();\n\t\t}\n\n\t\tconst findMatches = this._notebookViewModel.find(query, options).filter(match => match.length > 0);\n\n\t\tif ((!options.includeMarkupPreview && !options.includeOutput) || options.findScope?.findScopeType === NotebookFindScopeType.Text) {\n\t\t\tthis._webview?.findStop(ownerID);\n\t\t\treturn findMatches;\n\t\t}\n\n\t\t// search in webview enabled\n\n\t\tconst matchMap: { [key: string]: CellFindMatchWithIndex } = {};\n\t\tfindMatches.forEach(match => {\n\t\t\tmatchMap[match.cell.id] = match;\n\t\t});\n\n\t\tif (this._webview) {\n\t\t\t// request all outputs to be rendered\n\t\t\t// measure perf\n\t\t\tconst start = Date.now();\n\t\t\tawait this._warmupAll(!!options.includeOutput);\n\t\t\tconst end = Date.now();\n\t\t\tthis.logService.debug('Find', `Warmup time: ${end - start}ms`);\n\n\t\t\tif (token.isCancellationRequested) {\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\tlet findIds: string[] = [];\n\t\t\tif (options.findScope && options.findScope.findScopeType === NotebookFindScopeType.Cells && options.findScope.selectedCellRanges) {\n\t\t\t\tconst selectedIndexes = cellRangesToIndexes(options.findScope.selectedCellRanges);\n\t\t\t\tfindIds = selectedIndexes.map<string>(index => this._notebookViewModel?.viewCells[index].id ?? '');\n\t\t\t}\n\n\t\t\tconst webviewMatches = await this._webview.find(query, { caseSensitive: options.caseSensitive, wholeWord: options.wholeWord, includeMarkup: !!options.includeMarkupPreview, includeOutput: !!options.includeOutput, shouldGetSearchPreviewInfo, ownerID, findIds: findIds });\n\n\t\t\tif (token.isCancellationRequested) {\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\t// attach webview matches to model find matches\n\t\t\twebviewMatches.forEach(match => {\n\t\t\t\tconst cell = this._notebookViewModel!.viewCells.find(cell => cell.id === match.cellId);\n\n\t\t\t\tif (!cell) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (match.type === 'preview') {\n\t\t\t\t\t// markup preview\n\t\t\t\t\tif (cell.getEditState() === CellEditState.Preview && !options.includeMarkupPreview) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (cell.getEditState() === CellEditState.Editing && options.includeMarkupInput) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (!options.includeOutput) {\n\t\t\t\t\t\t// skip outputs if not included\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tconst exisitingMatch = matchMap[match.cellId];\n\n\t\t\t\tif (exisitingMatch) {\n\t\t\t\t\texisitingMatch.webviewMatches.push(match);\n\t\t\t\t} else {\n\n\t\t\t\t\tmatchMap[match.cellId] = new CellFindMatchModel(\n\t\t\t\t\t\tthis._notebookViewModel!.viewCells.find(cell => cell.id === match.cellId)!,\n\t\t\t\t\t\tthis._notebookViewModel!.viewCells.findIndex(cell => cell.id === match.cellId)!,\n\t\t\t\t\t\t[],\n\t\t\t\t\t\t[match]\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tconst ret: CellFindMatchWithIndex[] = [];\n\t\tthis._notebookViewModel.viewCells.forEach((cell, index) => {\n\t\t\tif (matchMap[cell.id]) {\n\t\t\t\tret.push(new CellFindMatchModel(cell, index, matchMap[cell.id].contentMatches, matchMap[cell.id].webviewMatches));\n\t\t\t}\n\t\t});\n\n\t\treturn ret;\n\t}\n\n\tasync findHighlightCurrent(matchIndex: number, ownerID?: string): Promise<number> {\n\t\tif (!this._webview) {\n\t\t\treturn 0;\n\t\t}\n\n\t\treturn this._webview?.findHighlightCurrent(matchIndex, ownerID ?? this.getId());\n\t}\n\n\tasync findUnHighlightCurrent(matchIndex: number, ownerID?: string): Promise<void> {\n\t\tif (!this._webview) {\n\t\t\treturn;\n\t\t}\n\n\t\treturn this._webview?.findUnHighlightCurrent(matchIndex, ownerID ?? this.getId());\n\t}\n\n\tfindStop(ownerID?: string) {\n\t\tthis._webview?.findStop(ownerID ?? this.getId());\n\t}\n\n\t//#endregion\n\n\t//#region MISC\n\n\tgetLayoutInfo(): NotebookLayoutInfo {\n\t\tif (!this._list) {\n\t\t\tthrow new Error('Editor is not initalized successfully');\n\t\t}\n\n\t\tif (!this._fontInfo) {\n\t\t\tthis._generateFontInfo();\n\t\t}\n\n\t\treturn {\n\t\t\twidth: this._dimension?.width ?? 0,\n\t\t\theight: this._dimension?.height ?? 0,\n\t\t\tscrollHeight: this._list?.getScrollHeight() ?? 0,\n\t\t\tfontInfo: this._fontInfo!,\n\t\t\tstickyHeight: this._notebookStickyScroll?.getCurrentStickyHeight() ?? 0\n\t\t};\n\t}\n\n\tasync createMarkupPreview(cell: MarkupCellViewModel) {\n\t\tif (!this._webview) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._webview.isResolved()) {\n\t\t\tawait this._resolveWebview();\n\t\t}\n\n\t\tif (!this._webview || !this._list.webviewElement) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.viewModel || !this._list.viewModel) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.viewModel.getCellIndex(cell) === -1) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.cellIsHidden(cell)) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst webviewTop = parseInt(this._list.webviewElement.domNode.style.top, 10);\n\t\tconst top = !!webviewTop ? (0 - webviewTop) : 0;\n\n\t\tconst cellTop = this._list.getCellViewScrollTop(cell);\n\t\tawait this._webview.showMarkupPreview({\n\t\t\tmime: cell.mime,\n\t\t\tcellHandle: cell.handle,\n\t\t\tcellId: cell.id,\n\t\t\tcontent: cell.getText(),\n\t\t\toffset: cellTop + top,\n\t\t\tvisible: true,\n\t\t\tmetadata: cell.metadata,\n\t\t});\n\t}\n\n\tprivate cellIsHidden(cell: ICellViewModel): boolean {\n\t\tconst modelIndex = this.viewModel!.getCellIndex(cell);\n\t\tconst foldedRanges = this.viewModel!.getHiddenRanges();\n\t\treturn foldedRanges.some(range => modelIndex >= range.start && modelIndex <= range.end);\n\t}\n\n\tasync unhideMarkupPreviews(cells: readonly MarkupCellViewModel[]) {\n\t\tif (!this._webview) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._webview.isResolved()) {\n\t\t\tawait this._resolveWebview();\n\t\t}\n\n\t\tawait this._webview?.unhideMarkupPreviews(cells.map(cell => cell.id));\n\t}\n\n\tasync hideMarkupPreviews(cells: readonly MarkupCellViewModel[]) {\n\t\tif (!this._webview || !cells.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._webview.isResolved()) {\n\t\t\tawait this._resolveWebview();\n\t\t}\n\n\t\tawait this._webview?.hideMarkupPreviews(cells.map(cell => cell.id));\n\t}\n\n\tasync deleteMarkupPreviews(cells: readonly MarkupCellViewModel[]) {\n\t\tif (!this._webview) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._webview.isResolved()) {\n\t\t\tawait this._resolveWebview();\n\t\t}\n\n\t\tawait this._webview?.deleteMarkupPreviews(cells.map(cell => cell.id));\n\t}\n\n\tprivate async updateSelectedMarkdownPreviews(): Promise<void> {\n\t\tif (!this._webview) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._webview.isResolved()) {\n\t\t\tawait this._resolveWebview();\n\t\t}\n\n\t\tconst selectedCells = this.getSelectionViewModels().map(cell => cell.id);\n\n\t\t// Only show selection when there is more than 1 cell selected\n\t\tawait this._webview?.updateMarkupPreviewSelections(selectedCells.length > 1 ? selectedCells : []);\n\t}\n\n\tasync createOutput(cell: CodeCellViewModel, output: IInsetRenderOutput, offset: number, createWhenIdle: boolean): Promise<void> {\n\t\tthis._insetModifyQueueByOutputId.queue(output.source.model.outputId, async () => {\n\t\t\tif (this._isDisposed || !this._webview) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!this._webview.isResolved()) {\n\t\t\t\tawait this._resolveWebview();\n\t\t\t}\n\n\t\t\tif (!this._webview) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!this._list.webviewElement) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (output.type === RenderOutputType.Extension) {\n\t\t\t\tthis.notebookRendererMessaging.prepare(output.renderer.id);\n\t\t\t}\n\n\t\t\tconst webviewTop = parseInt(this._list.webviewElement.domNode.style.top, 10);\n\t\t\tconst top = !!webviewTop ? (0 - webviewTop) : 0;\n\n\t\t\tconst cellTop = this._list.getCellViewScrollTop(cell) + top;\n\n\t\t\tconst existingOutput = this._webview.insetMapping.get(output.source);\n\t\t\tif (!existingOutput\n\t\t\t\t|| (!existingOutput.renderer && output.type === RenderOutputType.Extension)\n\t\t\t) {\n\t\t\t\tif (createWhenIdle) {\n\t\t\t\t\tthis._webview.requestCreateOutputWhenWebviewIdle({ cellId: cell.id, cellHandle: cell.handle, cellUri: cell.uri, executionId: cell.internalMetadata.executionId }, output, cellTop, offset);\n\t\t\t\t} else {\n\t\t\t\t\tthis._webview.createOutput({ cellId: cell.id, cellHandle: cell.handle, cellUri: cell.uri, executionId: cell.internalMetadata.executionId }, output, cellTop, offset);\n\t\t\t\t}\n\t\t\t} else if (existingOutput.renderer\n\t\t\t\t&& output.type === RenderOutputType.Extension\n\t\t\t\t&& existingOutput.renderer.id !== output.renderer.id) {\n\t\t\t\t// switch mimetype\n\t\t\t\tthis._webview.removeInsets([output.source]);\n\t\t\t\tthis._webview.createOutput({ cellId: cell.id, cellHandle: cell.handle, cellUri: cell.uri }, output, cellTop, offset);\n\t\t\t} else if (existingOutput.versionId !== output.source.model.versionId) {\n\t\t\t\tthis._webview.updateOutput({ cellId: cell.id, cellHandle: cell.handle, cellUri: cell.uri, executionId: cell.internalMetadata.executionId }, output, cellTop, offset);\n\t\t\t} else {\n\t\t\t\tconst outputIndex = cell.outputsViewModels.indexOf(output.source);\n\t\t\t\tconst outputOffset = cell.getOutputOffset(outputIndex);\n\t\t\t\tthis._webview.updateScrollTops([{\n\t\t\t\t\tcell,\n\t\t\t\t\toutput: output.source,\n\t\t\t\t\tcellTop,\n\t\t\t\t\toutputOffset,\n\t\t\t\t\tforceDisplay: !cell.isOutputCollapsed,\n\t\t\t\t}], []);\n\t\t\t}\n\t\t});\n\t}\n\n\tasync updateOutput(cell: CodeCellViewModel, output: IInsetRenderOutput, offset: number): Promise<void> {\n\t\tthis._insetModifyQueueByOutputId.queue(output.source.model.outputId, async () => {\n\t\t\tif (this._isDisposed || !this._webview || cell.isOutputCollapsed) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!this._webview.isResolved()) {\n\t\t\t\tawait this._resolveWebview();\n\t\t\t}\n\n\t\t\tif (!this._webview || !this._list.webviewElement) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!this._webview.insetMapping.has(output.source)) {\n\t\t\t\treturn this.createOutput(cell, output, offset, false);\n\t\t\t}\n\n\t\t\tif (output.type === RenderOutputType.Extension) {\n\t\t\t\tthis.notebookRendererMessaging.prepare(output.renderer.id);\n\t\t\t}\n\n\t\t\tconst webviewTop = parseInt(this._list.webviewElement.domNode.style.top, 10);\n\t\t\tconst top = !!webviewTop ? (0 - webviewTop) : 0;\n\n\t\t\tconst cellTop = this._list.getCellViewScrollTop(cell) + top;\n\t\t\tthis._webview.updateOutput({ cellId: cell.id, cellHandle: cell.handle, cellUri: cell.uri }, output, cellTop, offset);\n\t\t});\n\t}\n\n\tasync copyOutputImage(cellOutput: ICellOutputViewModel): Promise<void> {\n\t\tthis._webview?.copyImage(cellOutput);\n\t}\n\n\tremoveInset(output: ICellOutputViewModel) {\n\t\tthis._insetModifyQueueByOutputId.queue(output.model.outputId, async () => {\n\t\t\tif (this._isDisposed || !this._webview) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this._webview?.isResolved()) {\n\t\t\t\tthis._webview.removeInsets([output]);\n\t\t\t}\n\n\t\t\tthis._onDidRemoveOutput.fire(output);\n\t\t});\n\t}\n\n\thideInset(output: ICellOutputViewModel) {\n\t\tthis._insetModifyQueueByOutputId.queue(output.model.outputId, async () => {\n\t\t\tif (this._isDisposed || !this._webview) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this._webview?.isResolved()) {\n\t\t\t\tthis._webview.hideInset(output);\n\t\t\t}\n\t\t});\n\t}\n\n\t//#region --- webview IPC ----\n\tpostMessage(message: any) {\n\t\tif (this._webview?.isResolved()) {\n\t\t\tthis._webview.postKernelMessage(message);\n\t\t}\n\t}\n\n\t//#endregion\n\n\taddClassName(className: string) {\n\t\tthis._overlayContainer.classList.add(className);\n\t}\n\n\tremoveClassName(className: string) {\n\t\tthis._overlayContainer.classList.remove(className);\n\t}\n\n\tcellAt(index: number): ICellViewModel | undefined {\n\t\treturn this.viewModel?.cellAt(index);\n\t}\n\n\tgetCellByInfo(cellInfo: ICommonCellInfo): ICellViewModel {\n\t\tconst { cellHandle } = cellInfo;\n\t\treturn this.viewModel?.viewCells.find(vc => vc.handle === cellHandle) as CodeCellViewModel;\n\t}\n\n\tgetCellByHandle(handle: number): ICellViewModel | undefined {\n\t\treturn this.viewModel?.getCellByHandle(handle);\n\t}\n\n\tgetCellIndex(cell: ICellViewModel) {\n\t\treturn this.viewModel?.getCellIndexByHandle(cell.handle);\n\t}\n\n\tgetNextVisibleCellIndex(index: number): number | undefined {\n\t\treturn this.viewModel?.getNextVisibleCellIndex(index);\n\t}\n\n\tgetPreviousVisibleCellIndex(index: number): number | undefined {\n\t\treturn this.viewModel?.getPreviousVisibleCellIndex(index);\n\t}\n\n\tprivate _updateScrollHeight() {\n\t\tif (this._isDisposed || !this._webview?.isResolved()) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._list.webviewElement) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst scrollHeight = this._list.scrollHeight;\n\t\tthis._webview.element.style.height = `${scrollHeight + NOTEBOOK_WEBVIEW_BOUNDARY * 2}px`;\n\n\t\tconst webviewTop = parseInt(this._list.webviewElement.domNode.style.top, 10);\n\t\tconst top = !!webviewTop ? (0 - webviewTop) : 0;\n\n\t\tconst updateItems: IDisplayOutputLayoutUpdateRequest[] = [];\n\t\tconst removedItems: ICellOutputViewModel[] = [];\n\t\tthis._webview?.insetMapping.forEach((value, key) => {\n\t\t\tconst cell = this.viewModel?.getCellByHandle(value.cellInfo.cellHandle);\n\t\t\tif (!cell || !(cell instanceof CodeCellViewModel)) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.viewModel?.viewCells.find(cell => cell.handle === value.cellInfo.cellHandle);\n\t\t\tconst viewIndex = this._list.getViewIndex(cell);\n\n\t\t\tif (viewIndex === undefined) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (cell.outputsViewModels.indexOf(key) < 0) {\n\t\t\t\t// output is already gone\n\t\t\t\tremovedItems.push(key);\n\t\t\t}\n\n\t\t\tconst cellTop = this._list.getCellViewScrollTop(cell);\n\t\t\tconst outputIndex = cell.outputsViewModels.indexOf(key);\n\t\t\tconst outputOffset = cell.getOutputOffset(outputIndex);\n\t\t\tupdateItems.push({\n\t\t\t\tcell,\n\t\t\t\toutput: key,\n\t\t\t\tcellTop: cellTop + top,\n\t\t\t\toutputOffset,\n\t\t\t\tforceDisplay: false,\n\t\t\t});\n\t\t});\n\n\t\tthis._webview.removeInsets(removedItems);\n\n\t\tconst markdownUpdateItems: { id: string; top: number }[] = [];\n\t\tfor (const cellId of this._webview.markupPreviewMapping.keys()) {\n\t\t\tconst cell = this.viewModel?.viewCells.find(cell => cell.id === cellId);\n\t\t\tif (cell) {\n\t\t\t\tconst cellTop = this._list.getCellViewScrollTop(cell);\n\t\t\t\t// markdownUpdateItems.push({ id: cellId, top: cellTop });\n\t\t\t\tmarkdownUpdateItems.push({ id: cellId, top: cellTop + top });\n\t\t\t}\n\t\t}\n\n\t\tif (markdownUpdateItems.length || updateItems.length) {\n\t\t\tthis._debug('_list.onDidChangeContentHeight/markdown', markdownUpdateItems);\n\t\t\tthis._webview?.updateScrollTops(updateItems, markdownUpdateItems);\n\t\t}\n\t}\n\n\t//#endregion\n\n\t//#region BacklayerWebview delegate\n\tprivate _updateOutputHeight(cellInfo: ICommonCellInfo, output: ICellOutputViewModel, outputHeight: number, isInit: boolean, source?: string): void {\n\t\tconst cell = this.viewModel?.viewCells.find(vc => vc.handle === cellInfo.cellHandle);\n\t\tif (cell && cell instanceof CodeCellViewModel) {\n\t\t\tconst outputIndex = cell.outputsViewModels.indexOf(output);\n\t\t\tthis._debug('update cell output', cell.handle, outputHeight);\n\t\t\tcell.updateOutputHeight(outputIndex, outputHeight, source);\n\t\t\tthis.layoutNotebookCell(cell, cell.layoutInfo.totalHeight);\n\n\t\t\tif (isInit) {\n\t\t\t\tthis._onDidRenderOutput.fire(output);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate readonly _pendingOutputHeightAcks = new Map</* outputId */ string, IAckOutputHeight>();\n\n\tprivate _scheduleOutputHeightAck(cellInfo: ICommonCellInfo, outputId: string, height: number) {\n\t\tconst wasEmpty = this._pendingOutputHeightAcks.size === 0;\n\t\tthis._pendingOutputHeightAcks.set(outputId, { cellId: cellInfo.cellId, outputId, height });\n\n\t\tif (wasEmpty) {\n\t\t\tDOM.scheduleAtNextAnimationFrame(DOM.getWindow(this.getDomNode()), () => {\n\t\t\t\tthis._debug('ack height');\n\t\t\t\tthis._updateScrollHeight();\n\n\t\t\t\tthis._webview?.ackHeight([...this._pendingOutputHeightAcks.values()]);\n\n\t\t\t\tthis._pendingOutputHeightAcks.clear();\n\t\t\t}, -1); // -1 priority because this depends on calls to layoutNotebookCell, and that may be called multiple times before this runs\n\t\t}\n\t}\n\n\tprivate _getCellById(cellId: string): ICellViewModel | undefined {\n\t\treturn this.viewModel?.viewCells.find(vc => vc.id === cellId);\n\t}\n\n\tprivate _updateMarkupCellHeight(cellId: string, height: number, isInit: boolean) {\n\t\tconst cell = this._getCellById(cellId);\n\t\tif (cell && cell instanceof MarkupCellViewModel) {\n\t\t\tconst { bottomToolbarGap } = this._notebookOptions.computeBottomToolbarDimensions(this.viewModel?.viewType);\n\t\t\tthis._debug('updateMarkdownCellHeight', cell.handle, height + bottomToolbarGap, isInit);\n\t\t\tcell.renderedMarkdownHeight = height;\n\t\t}\n\t}\n\n\tprivate _setMarkupCellEditState(cellId: string, editState: CellEditState): void {\n\t\tconst cell = this._getCellById(cellId);\n\t\tif (cell instanceof MarkupCellViewModel) {\n\t\t\tthis.revealInView(cell);\n\t\t\tcell.updateEditState(editState, 'setMarkdownCellEditState');\n\t\t}\n\t}\n\n\tprivate _didStartDragMarkupCell(cellId: string, event: { dragOffsetY: number }): void {\n\t\tconst cell = this._getCellById(cellId);\n\t\tif (cell instanceof MarkupCellViewModel) {\n\t\t\tconst webviewOffset = this._list.webviewElement ? -parseInt(this._list.webviewElement.domNode.style.top, 10) : 0;\n\t\t\tthis._dndController?.startExplicitDrag(cell, event.dragOffsetY - webviewOffset);\n\t\t}\n\t}\n\n\tprivate _didDragMarkupCell(cellId: string, event: { dragOffsetY: number }): void {\n\t\tconst cell = this._getCellById(cellId);\n\t\tif (cell instanceof MarkupCellViewModel) {\n\t\t\tconst webviewOffset = this._list.webviewElement ? -parseInt(this._list.webviewElement.domNode.style.top, 10) : 0;\n\t\t\tthis._dndController?.explicitDrag(cell, event.dragOffsetY - webviewOffset);\n\t\t}\n\t}\n\n\tprivate _didDropMarkupCell(cellId: string, event: { dragOffsetY: number; ctrlKey: boolean; altKey: boolean }): void {\n\t\tconst cell = this._getCellById(cellId);\n\t\tif (cell instanceof MarkupCellViewModel) {\n\t\t\tconst webviewOffset = this._list.webviewElement ? -parseInt(this._list.webviewElement.domNode.style.top, 10) : 0;\n\t\t\tevent.dragOffsetY -= webviewOffset;\n\t\t\tthis._dndController?.explicitDrop(cell, event);\n\t\t}\n\t}\n\n\tprivate _didEndDragMarkupCell(cellId: string): void {\n\t\tconst cell = this._getCellById(cellId);\n\t\tif (cell instanceof MarkupCellViewModel) {\n\t\t\tthis._dndController?.endExplicitDrag(cell);\n\t\t}\n\t}\n\n\tprivate _didResizeOutput(cellId: string): void {\n\t\tconst cell = this._getCellById(cellId);\n\t\tif (cell) {\n\t\t\tthis._onDidResizeOutputEmitter.fire(cell);\n\t\t}\n\t}\n\n\tprivate _updatePerformanceMetadata(cellId: string, executionId: string, duration: number, rendererId: string): void {\n\t\tif (!this.hasModel()) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst cell = this._getCellById(cellId);\n\t\tconst cellIndex = !cell ? undefined : this.getCellIndex(cell);\n\t\tif (cell?.internalMetadata.executionId === executionId && cellIndex !== undefined) {\n\t\t\tconst renderDurationMap = cell.internalMetadata.renderDuration || {};\n\t\t\trenderDurationMap[rendererId] = (renderDurationMap[rendererId] ?? 0) + duration;\n\n\t\t\tthis.textModel.applyEdits([\n\t\t\t\t{\n\t\t\t\t\teditType: CellEditType.PartialInternalMetadata,\n\t\t\t\t\tindex: cellIndex,\n\t\t\t\t\tinternalMetadata: {\n\t\t\t\t\t\texecutionId: executionId,\n\t\t\t\t\t\trenderDuration: renderDurationMap\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t], true, undefined, () => undefined, undefined, false);\n\n\t\t}\n\t}\n\n\t//#endregion\n\n\t//#region Editor Contributions\n\tgetContribution<T extends INotebookEditorContribution>(id: string): T {\n\t\treturn <T>(this._contributions.get(id) || null);\n\t}\n\n\t//#endregion\n\n\toverride dispose() {\n\t\tthis._isDisposed = true;\n\t\t// dispose webview first\n\t\tthis._webview?.dispose();\n\t\tthis._webview = null;\n\n\t\tthis.notebookEditorService.removeNotebookEditor(this);\n\t\tdispose(this._contributions.values());\n\t\tthis._contributions.clear();\n\n\t\tthis._localStore.clear();\n\t\tdispose(this._localCellStateListeners);\n\t\tthis._list.dispose();\n\t\tthis._listTopCellToolbar?.dispose();\n\n\t\tthis._overlayContainer.remove();\n\t\tthis.viewModel?.dispose();\n\n\t\tthis._renderedEditors.clear();\n\t\tthis._baseCellEditorOptions.forEach(v => v.dispose());\n\t\tthis._baseCellEditorOptions.clear();\n\n\t\tthis._notebookOverviewRulerContainer.remove();\n\n\t\tsuper.dispose();\n\n\t\t// unref\n\t\tthis._webview = null;\n\t\tthis._webviewResolvePromise = null;\n\t\tthis._webviewTransparentCover = null;\n\t\tthis._dndController = null;\n\t\tthis._listTopCellToolbar = null;\n\t\tthis._notebookViewModel = undefined;\n\t\tthis._cellContextKeyManager = null;\n\t\tthis._notebookTopToolbar = null!;\n\t\tthis._list = null!;\n\t\tthis._listViewInfoAccessor = null!;\n\t\tthis._pendingLayouts = null;\n\t\tthis._listDelegate = null;\n\t}\n\n\ttoJSON(): { notebookUri: URI | undefined } {\n\t\treturn {\n\t\t\tnotebookUri: this.viewModel?.uri,\n\t\t};\n\t}\n}\n\nregisterZIndex(ZIndex.Base, 5, 'notebook-progress-bar',);\nregisterZIndex(ZIndex.Base, 10, 'notebook-list-insertion-indicator');\nregisterZIndex(ZIndex.Base, 20, 'notebook-cell-editor-outline');\nregisterZIndex(ZIndex.Base, 25, 'notebook-scrollbar');\nregisterZIndex(ZIndex.Base, 26, 'notebook-cell-status');\nregisterZIndex(ZIndex.Base, 26, 'notebook-folding-indicator');\nregisterZIndex(ZIndex.Base, 27, 'notebook-output');\nregisterZIndex(ZIndex.Base, 28, 'notebook-cell-bottom-toolbar-container');\nregisterZIndex(ZIndex.Base, 29, 'notebook-run-button-container');\nregisterZIndex(ZIndex.Base, 29, 'notebook-input-collapse-condicon');\nregisterZIndex(ZIndex.Base, 30, 'notebook-cell-output-toolbar');\nregisterZIndex(ZIndex.Sash, 1, 'notebook-cell-expand-part-button');\nregisterZIndex(ZIndex.Sash, 2, 'notebook-cell-toolbar');\nregisterZIndex(ZIndex.Sash, 3, 'notebook-cell-toolbar-dropdown-active');\n\nexport const notebookCellBorder = registerColor('notebook.cellBorderColor', {\n\tdark: transparent(listInactiveSelectionBackground, 1),\n\tlight: transparent(listInactiveSelectionBackground, 1),\n\thcDark: PANEL_BORDER,\n\thcLight: PANEL_BORDER\n}, nls.localize('notebook.cellBorderColor', \"The border color for notebook cells.\"));\n\nexport const focusedEditorBorderColor = registerColor('notebook.focusedEditorBorder', focusBorder, nls.localize('notebook.focusedEditorBorder', \"The color of the notebook cell editor border.\"));\n\nexport const cellStatusIconSuccess = registerColor('notebookStatusSuccessIcon.foreground', debugIconStartForeground, nls.localize('notebookStatusSuccessIcon.foreground', \"The error icon color of notebook cells in the cell status bar.\"));\n\nexport const runningCellRulerDecorationColor = registerColor('notebookEditorOverviewRuler.runningCellForeground', debugIconStartForeground, nls.localize('notebookEditorOverviewRuler.runningCellForeground', \"The color of the running cell decoration in the notebook editor overview ruler.\"));\n\nexport const cellStatusIconError = registerColor('notebookStatusErrorIcon.foreground', errorForeground, nls.localize('notebookStatusErrorIcon.foreground', \"The error icon color of notebook cells in the cell status bar.\"));\n\nexport const cellStatusIconRunning = registerColor('notebookStatusRunningIcon.foreground', foreground, nls.localize('notebookStatusRunningIcon.foreground', \"The running icon color of notebook cells in the cell status bar.\"));\n\nexport const notebookOutputContainerBorderColor = registerColor('notebook.outputContainerBorderColor', null, nls.localize('notebook.outputContainerBorderColor', \"The border color of the notebook output container.\"));\n\nexport const notebookOutputContainerColor = registerColor('notebook.outputContainerBackgroundColor', null, nls.localize('notebook.outputContainerBackgroundColor', \"The color of the notebook output container background.\"));\n\n// TODO@rebornix currently also used for toolbar border, if we keep all of this, pick a generic name\nexport const CELL_TOOLBAR_SEPERATOR = registerColor('notebook.cellToolbarSeparator', {\n\tdark: Color.fromHex('#808080').transparent(0.35),\n\tlight: Color.fromHex('#808080').transparent(0.35),\n\thcDark: contrastBorder,\n\thcLight: contrastBorder\n}, nls.localize('notebook.cellToolbarSeparator', \"The color of the separator in the cell bottom toolbar\"));\n\nexport const focusedCellBackground = registerColor('notebook.focusedCellBackground', null, nls.localize('focusedCellBackground', \"The background color of a cell when the cell is focused.\"));\n\nexport const selectedCellBackground = registerColor('notebook.selectedCellBackground', {\n\tdark: listInactiveSelectionBackground,\n\tlight: listInactiveSelectionBackground,\n\thcDark: null,\n\thcLight: null\n}, nls.localize('selectedCellBackground', \"The background color of a cell when the cell is selected.\"));\n\n\nexport const cellHoverBackground = registerColor('notebook.cellHoverBackground', {\n\tdark: transparent(focusedCellBackground, .5),\n\tlight: transparent(focusedCellBackground, .7),\n\thcDark: null,\n\thcLight: null\n}, nls.localize('notebook.cellHoverBackground', \"The background color of a cell when the cell is hovered.\"));\n\nexport const selectedCellBorder = registerColor('notebook.selectedCellBorder', {\n\tdark: notebookCellBorder,\n\tlight: notebookCellBorder,\n\thcDark: contrastBorder,\n\thcLight: contrastBorder\n}, nls.localize('notebook.selectedCellBorder', \"The color of the cell's top and bottom border when the cell is selected but not focused.\"));\n\nexport const inactiveSelectedCellBorder = registerColor('notebook.inactiveSelectedCellBorder', {\n\tdark: null,\n\tlight: null,\n\thcDark: focusBorder,\n\thcLight: focusBorder\n}, nls.localize('notebook.inactiveSelectedCellBorder', \"The color of the cell's borders when multiple cells are selected.\"));\n\nexport const focusedCellBorder = registerColor('notebook.focusedCellBorder', focusBorder, nls.localize('notebook.focusedCellBorder', \"The color of the cell's focus indicator borders when the cell is focused.\"));\n\nexport const inactiveFocusedCellBorder = registerColor('notebook.inactiveFocusedCellBorder', notebookCellBorder, nls.localize('notebook.inactiveFocusedCellBorder', \"The color of the cell's top and bottom border when a cell is focused while the primary focus is outside of the editor.\"));\n\nexport const cellStatusBarItemHover = registerColor('notebook.cellStatusBarItemHoverBackground', {\n\tlight: new Color(new RGBA(0, 0, 0, 0.08)),\n\tdark: new Color(new RGBA(255, 255, 255, 0.15)),\n\thcDark: new Color(new RGBA(255, 255, 255, 0.15)),\n\thcLight: new Color(new RGBA(0, 0, 0, 0.08)),\n}, nls.localize('notebook.cellStatusBarItemHoverBackground', \"The background color of notebook cell status bar items.\"));\n\nexport const cellInsertionIndicator = registerColor('notebook.cellInsertionIndicator', focusBorder, nls.localize('notebook.cellInsertionIndicator', \"The color of the notebook cell insertion indicator.\"));\n\nexport const listScrollbarSliderBackground = registerColor('notebookScrollbarSlider.background', scrollbarSliderBackground, nls.localize('notebookScrollbarSliderBackground', \"Notebook scrollbar slider background color.\"));\n\nexport const listScrollbarSliderHoverBackground = registerColor('notebookScrollbarSlider.hoverBackground', scrollbarSliderHoverBackground, nls.localize('notebookScrollbarSliderHoverBackground', \"Notebook scrollbar slider background color when hovering.\"));\n\nexport const listScrollbarSliderActiveBackground = registerColor('notebookScrollbarSlider.activeBackground', scrollbarSliderActiveBackground, nls.localize('notebookScrollbarSliderActiveBackground', \"Notebook scrollbar slider background color when clicked on.\"));\n\nexport const cellSymbolHighlight = registerColor('notebook.symbolHighlightBackground', {\n\tdark: Color.fromHex('#ffffff0b'),\n\tlight: Color.fromHex('#fdff0033'),\n\thcDark: null,\n\thcLight: null\n}, nls.localize('notebook.symbolHighlightBackground', \"Background color of highlighted cell\"));\n\nexport const cellEditorBackground = registerColor('notebook.cellEditorBackground', {\n\tlight: SIDE_BAR_BACKGROUND,\n\tdark: SIDE_BAR_BACKGROUND,\n\thcDark: null,\n\thcLight: null\n}, nls.localize('notebook.cellEditorBackground', \"Cell editor background color.\"));\n\nconst notebookEditorBackground = registerColor('notebook.editorBackground', {\n\tlight: EDITOR_PANE_BACKGROUND,\n\tdark: EDITOR_PANE_BACKGROUND,\n\thcDark: null,\n\thcLight: null\n}, nls.localize('notebook.editorBackground', \"Notebook background color.\"));\n"],
  "mappings": "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",
  "names": ["cell", "selection", "offset"]
}
