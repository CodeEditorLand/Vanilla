var h=Object.defineProperty;var v=Object.getOwnPropertyDescriptor;var c=(s,i,l,o)=>{for(var e=o>1?void 0:o?v(i,l):i,r=s.length-1,t;r>=0;r--)(t=s[r])&&(e=(o?t(i,l,e):t(e))||e);return o&&e&&h(i,l,e),e},f=(s,i)=>(l,o)=>i(l,o,s);import{Disposable as E}from"../../../../../../../vs/base/common/lifecycle.js";import{RedoCommand as M,UndoCommand as k}from"../../../../../../../vs/editor/browser/editorExtensions.js";import{registerWorkbenchContribution2 as w,WorkbenchPhase as I}from"../../../../../../../vs/workbench/common/contributions.js";import{CellEditState as p,getNotebookEditorFromEditorPane as g}from"../../../../../../../vs/workbench/contrib/notebook/browser/notebookBrowser.js";import"../../../../../../../vs/workbench/contrib/notebook/browser/viewModel/notebookViewModelImpl.js";import{CellKind as u}from"../../../../../../../vs/workbench/contrib/notebook/common/notebookCommon.js";import{IEditorService as S}from"../../../../../../../vs/workbench/services/editor/common/editorService.js";let a=class extends E{constructor(l){super();this._editorService=l;const o=105;this._register(k.addImplementation(o,"notebook-undo-redo",()=>{const e=g(this._editorService.activeEditorPane),r=e?.getViewModel();return e&&e.hasModel()&&r?r.undo().then(t=>{if(t?.length){for(let n=0;n<e.getLength();n++){const d=e.cellAt(n);d.cellKind===u.Markup&&t.find(m=>m.fragment===d.model.uri.fragment)&&d.updateEditState(p.Editing,"undo")}e?.setOptions({cellOptions:{resource:t[0]},preserveFocus:!0})}}):!1})),this._register(M.addImplementation(o,"notebook-undo-redo",()=>{const e=g(this._editorService.activeEditorPane),r=e?.getViewModel();return e&&e.hasModel()&&r?r.redo().then(t=>{if(t?.length){for(let n=0;n<e.getLength();n++){const d=e.cellAt(n);d.cellKind===u.Markup&&t.find(m=>m.fragment===d.model.uri.fragment)&&d.updateEditState(p.Editing,"redo")}e?.setOptions({cellOptions:{resource:t[0]},preserveFocus:!0})}}):!1}))}static ID="workbench.contrib.notebookUndoRedo"};a=c([f(0,S)],a),w(a.ID,a,I.BlockRestore);
