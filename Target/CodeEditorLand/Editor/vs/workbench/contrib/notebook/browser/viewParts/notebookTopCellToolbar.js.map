{
  "version": 3,
  "sources": ["../../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/notebook/browser/viewParts/notebookTopCellToolbar.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as DOM from '../../../../../base/browser/dom.js';\nimport { Disposable, DisposableStore, MutableDisposable } from '../../../../../base/common/lifecycle.js';\nimport { HiddenItemStrategy, MenuWorkbenchToolBar } from '../../../../../platform/actions/browser/toolbar.js';\nimport { IMenuService, MenuItemAction } from '../../../../../platform/actions/common/actions.js';\nimport { IContextMenuService } from '../../../../../platform/contextview/browser/contextView.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { INotebookActionContext } from '../controller/coreActions.js';\nimport { INotebookEditorDelegate } from '../notebookBrowser.js';\nimport { NotebookOptions } from '../notebookOptions.js';\nimport { CodiconActionViewItem } from '../view/cellParts/cellActionView.js';\n\nexport class ListTopCellToolbar extends Disposable {\n\tprivate readonly topCellToolbarContainer: HTMLElement;\n\tprivate topCellToolbar: HTMLElement;\n\tprivate readonly viewZone: MutableDisposable<DisposableStore> = this._register(new MutableDisposable());\n\tprivate readonly _modelDisposables = this._register(new DisposableStore());\n\tconstructor(\n\t\tprotected readonly notebookEditor: INotebookEditorDelegate,\n\t\tprivate readonly notebookOptions: NotebookOptions,\n\t\t@IInstantiationService protected readonly instantiationService: IInstantiationService,\n\t\t@IContextMenuService protected readonly contextMenuService: IContextMenuService,\n\t\t@IMenuService protected readonly menuService: IMenuService\n\t) {\n\t\tsuper();\n\n\t\tthis.topCellToolbarContainer = DOM.$('div');\n\t\tthis.topCellToolbar = DOM.$('.cell-list-top-cell-toolbar-container');\n\t\tthis.topCellToolbarContainer.appendChild(this.topCellToolbar);\n\n\t\tthis._register(this.notebookEditor.onDidAttachViewModel(() => {\n\t\t\tthis.updateTopToolbar();\n\t\t}));\n\n\t\tthis._register(this.notebookOptions.onDidChangeOptions(e => {\n\t\t\tif (e.insertToolbarAlignment || e.insertToolbarPosition || e.cellToolbarLocation) {\n\t\t\t\tthis.updateTopToolbar();\n\t\t\t}\n\t\t}));\n\t}\n\n\tprivate updateTopToolbar() {\n\t\tconst layoutInfo = this.notebookOptions.getLayoutConfiguration();\n\t\tthis.viewZone.value = new DisposableStore();\n\n\t\tif (layoutInfo.insertToolbarPosition === 'hidden' || layoutInfo.insertToolbarPosition === 'notebookToolbar') {\n\t\t\tconst height = this.notebookOptions.computeTopInsertToolbarHeight(this.notebookEditor.textModel?.viewType);\n\n\t\t\tif (height !== 0) {\n\t\t\t\t// reserve whitespace to avoid overlap with cell toolbar\n\t\t\t\tthis.notebookEditor.changeViewZones(accessor => {\n\t\t\t\t\tconst id = accessor.addZone({\n\t\t\t\t\t\tafterModelPosition: 0,\n\t\t\t\t\t\theightInPx: height,\n\t\t\t\t\t\tdomNode: DOM.$('div')\n\t\t\t\t\t});\n\t\t\t\t\taccessor.layoutZone(id);\n\t\t\t\t\tthis.viewZone.value?.add({\n\t\t\t\t\t\tdispose: () => {\n\t\t\t\t\t\t\tif (!this.notebookEditor.isDisposed) {\n\t\t\t\t\t\t\t\tthis.notebookEditor.changeViewZones(accessor => {\n\t\t\t\t\t\t\t\t\taccessor.removeZone(id);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\n\t\tthis.notebookEditor.changeViewZones(accessor => {\n\t\t\tconst height = this.notebookOptions.computeTopInsertToolbarHeight(this.notebookEditor.textModel?.viewType);\n\t\t\tconst id = accessor.addZone({\n\t\t\t\tafterModelPosition: 0,\n\t\t\t\theightInPx: height,\n\t\t\t\tdomNode: this.topCellToolbarContainer\n\t\t\t});\n\t\t\taccessor.layoutZone(id);\n\n\t\t\tthis.viewZone.value?.add({\n\t\t\t\tdispose: () => {\n\t\t\t\t\tif (!this.notebookEditor.isDisposed) {\n\t\t\t\t\t\tthis.notebookEditor.changeViewZones(accessor => {\n\t\t\t\t\t\t\taccessor.removeZone(id);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tDOM.clearNode(this.topCellToolbar);\n\n\t\t\tconst toolbar = this.instantiationService.createInstance(MenuWorkbenchToolBar, this.topCellToolbar, this.notebookEditor.creationOptions.menuIds.cellTopInsertToolbar, {\n\t\t\t\tactionViewItemProvider: (action, options) => {\n\t\t\t\t\tif (action instanceof MenuItemAction) {\n\t\t\t\t\t\tconst item = this.instantiationService.createInstance(CodiconActionViewItem, action, { hoverDelegate: options.hoverDelegate });\n\t\t\t\t\t\treturn item;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn undefined;\n\t\t\t\t},\n\t\t\t\tmenuOptions: {\n\t\t\t\t\tshouldForwardArgs: true\n\t\t\t\t},\n\t\t\t\ttoolbarOptions: {\n\t\t\t\t\tprimaryGroup: (g: string) => /^inline/.test(g),\n\t\t\t\t},\n\t\t\t\thiddenItemStrategy: HiddenItemStrategy.Ignore,\n\t\t\t});\n\n\t\t\tif (this.notebookEditor.hasModel()) {\n\t\t\t\ttoolbar.context = {\n\t\t\t\t\tnotebookEditor: this.notebookEditor\n\t\t\t\t} satisfies INotebookActionContext;\n\t\t\t}\n\n\t\t\tthis.viewZone.value?.add(toolbar);\n\n\t\t\t// update toolbar container css based on cell list length\n\t\t\tthis.viewZone.value?.add(this.notebookEditor.onDidChangeModel(() => {\n\t\t\t\tthis._modelDisposables.clear();\n\n\t\t\t\tif (this.notebookEditor.hasModel()) {\n\t\t\t\t\tthis._modelDisposables.add(this.notebookEditor.onDidChangeViewCells(() => {\n\t\t\t\t\t\tthis.updateClass();\n\t\t\t\t\t}));\n\n\t\t\t\t\tthis.updateClass();\n\t\t\t\t}\n\t\t\t}));\n\n\t\t\tthis.updateClass();\n\t\t});\n\t}\n\n\tprivate updateClass() {\n\t\tif (this.notebookEditor.hasModel() && this.notebookEditor.getLength() === 0) {\n\t\t\tthis.topCellToolbar.classList.add('emptyNotebook');\n\t\t} else {\n\t\t\tthis.topCellToolbar.classList.remove('emptyNotebook');\n\t\t}\n\t}\n}\n"],
  "mappings": "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",
  "names": ["accessor"]
}
