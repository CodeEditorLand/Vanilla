{
  "version": 3,
  "sources": ["../../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/notebook/browser/viewParts/notebookTopCellToolbar.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as DOM from \"../../../../../base/browser/dom.js\";\nimport {\n\tDisposable,\n\tDisposableStore,\n\tMutableDisposable,\n} from \"../../../../../base/common/lifecycle.js\";\nimport {\n\tHiddenItemStrategy,\n\tMenuWorkbenchToolBar,\n} from \"../../../../../platform/actions/browser/toolbar.js\";\nimport {\n\tIMenuService,\n\tMenuItemAction,\n} from \"../../../../../platform/actions/common/actions.js\";\nimport { IContextMenuService } from \"../../../../../platform/contextview/browser/contextView.js\";\nimport { IInstantiationService } from \"../../../../../platform/instantiation/common/instantiation.js\";\nimport type { INotebookActionContext } from \"../controller/coreActions.js\";\nimport type { INotebookEditorDelegate } from \"../notebookBrowser.js\";\nimport type { NotebookOptions } from \"../notebookOptions.js\";\nimport { CodiconActionViewItem } from \"../view/cellParts/cellActionView.js\";\n\nexport class ListTopCellToolbar extends Disposable {\n\tprivate readonly topCellToolbarContainer: HTMLElement;\n\tprivate topCellToolbar: HTMLElement;\n\tprivate readonly viewZone: MutableDisposable<DisposableStore> =\n\t\tthis._register(new MutableDisposable());\n\tprivate readonly _modelDisposables = this._register(new DisposableStore());\n\tconstructor(\n\t\tprotected readonly notebookEditor: INotebookEditorDelegate,\n\t\tprivate readonly notebookOptions: NotebookOptions,\n\t\t@IInstantiationService protected readonly instantiationService: IInstantiationService,\n\t\t@IContextMenuService protected readonly contextMenuService: IContextMenuService,\n\t\t@IMenuService protected readonly menuService: IMenuService\n\t) {\n\t\tsuper();\n\n\t\tthis.topCellToolbarContainer = DOM.$('div');\n\t\tthis.topCellToolbar = DOM.$('.cell-list-top-cell-toolbar-container');\n\t\tthis.topCellToolbarContainer.appendChild(this.topCellToolbar);\n\n\t\tthis._register(this.notebookEditor.onDidAttachViewModel(() => {\n\t\t\tthis.updateTopToolbar();\n\t\t}));\n\n\t\tthis._register(this.notebookOptions.onDidChangeOptions(e => {\n\t\t\tif (e.insertToolbarAlignment || e.insertToolbarPosition || e.cellToolbarLocation) {\n\t\t\t\tthis.updateTopToolbar();\n\t\t\t}\n\t\t}));\n\t}\n\n\tprivate updateTopToolbar() {\n\t\tconst layoutInfo = this.notebookOptions.getLayoutConfiguration();\n\t\tthis.viewZone.value = new DisposableStore();\n\n\t\tif (\n\t\t\tlayoutInfo.insertToolbarPosition === \"hidden\" ||\n\t\t\tlayoutInfo.insertToolbarPosition === \"notebookToolbar\"\n\t\t) {\n\t\t\tconst height = this.notebookOptions.computeTopInsertToolbarHeight(\n\t\t\t\tthis.notebookEditor.textModel?.viewType,\n\t\t\t);\n\n\t\t\tif (height !== 0) {\n\t\t\t\t// reserve whitespace to avoid overlap with cell toolbar\n\t\t\t\tthis.notebookEditor.changeViewZones((accessor) => {\n\t\t\t\t\tconst id = accessor.addZone({\n\t\t\t\t\t\tafterModelPosition: 0,\n\t\t\t\t\t\theightInPx: height,\n\t\t\t\t\t\tdomNode: DOM.$(\"div\"),\n\t\t\t\t\t});\n\t\t\t\t\taccessor.layoutZone(id);\n\t\t\t\t\tthis.viewZone.value?.add({\n\t\t\t\t\t\tdispose: () => {\n\t\t\t\t\t\t\tif (!this.notebookEditor.isDisposed) {\n\t\t\t\t\t\t\t\tthis.notebookEditor.changeViewZones(\n\t\t\t\t\t\t\t\t\t(accessor) => {\n\t\t\t\t\t\t\t\t\t\taccessor.removeZone(id);\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tthis.notebookEditor.changeViewZones((accessor) => {\n\t\t\tconst height = this.notebookOptions.computeTopInsertToolbarHeight(\n\t\t\t\tthis.notebookEditor.textModel?.viewType,\n\t\t\t);\n\t\t\tconst id = accessor.addZone({\n\t\t\t\tafterModelPosition: 0,\n\t\t\t\theightInPx: height,\n\t\t\t\tdomNode: this.topCellToolbarContainer,\n\t\t\t});\n\t\t\taccessor.layoutZone(id);\n\n\t\t\tthis.viewZone.value?.add({\n\t\t\t\tdispose: () => {\n\t\t\t\t\tif (!this.notebookEditor.isDisposed) {\n\t\t\t\t\t\tthis.notebookEditor.changeViewZones((accessor) => {\n\t\t\t\t\t\t\taccessor.removeZone(id);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tDOM.clearNode(this.topCellToolbar);\n\n\t\t\tconst toolbar = this.instantiationService.createInstance(\n\t\t\t\tMenuWorkbenchToolBar,\n\t\t\t\tthis.topCellToolbar,\n\t\t\t\tthis.notebookEditor.creationOptions.menuIds\n\t\t\t\t\t.cellTopInsertToolbar,\n\t\t\t\t{\n\t\t\t\t\tactionViewItemProvider: (action, options) => {\n\t\t\t\t\t\tif (action instanceof MenuItemAction) {\n\t\t\t\t\t\t\tconst item =\n\t\t\t\t\t\t\t\tthis.instantiationService.createInstance(\n\t\t\t\t\t\t\t\t\tCodiconActionViewItem,\n\t\t\t\t\t\t\t\t\taction,\n\t\t\t\t\t\t\t\t\t{ hoverDelegate: options.hoverDelegate },\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\treturn item;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn undefined;\n\t\t\t\t\t},\n\t\t\t\t\tmenuOptions: {\n\t\t\t\t\t\tshouldForwardArgs: true,\n\t\t\t\t\t},\n\t\t\t\t\ttoolbarOptions: {\n\t\t\t\t\t\tprimaryGroup: (g: string) => /^inline/.test(g),\n\t\t\t\t\t},\n\t\t\t\t\thiddenItemStrategy: HiddenItemStrategy.Ignore,\n\t\t\t\t},\n\t\t\t);\n\n\t\t\tif (this.notebookEditor.hasModel()) {\n\t\t\t\ttoolbar.context = {\n\t\t\t\t\tnotebookEditor: this.notebookEditor,\n\t\t\t\t} satisfies INotebookActionContext;\n\t\t\t}\n\n\t\t\tthis.viewZone.value?.add(toolbar);\n\n\t\t\t// update toolbar container css based on cell list length\n\t\t\tthis.viewZone.value?.add(\n\t\t\t\tthis.notebookEditor.onDidChangeModel(() => {\n\t\t\t\t\tthis._modelDisposables.clear();\n\n\t\t\t\t\tif (this.notebookEditor.hasModel()) {\n\t\t\t\t\t\tthis._modelDisposables.add(\n\t\t\t\t\t\t\tthis.notebookEditor.onDidChangeViewCells(() => {\n\t\t\t\t\t\t\t\tthis.updateClass();\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tthis.updateClass();\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t);\n\n\t\t\tthis.updateClass();\n\t\t});\n\t}\n\n\tprivate updateClass() {\n\t\tif (\n\t\t\tthis.notebookEditor.hasModel() &&\n\t\t\tthis.notebookEditor.getLength() === 0\n\t\t) {\n\t\t\tthis.topCellToolbar.classList.add(\"emptyNotebook\");\n\t\t} else {\n\t\t\tthis.topCellToolbar.classList.remove(\"emptyNotebook\");\n\t\t}\n\t}\n}\n"],
  "mappings": "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",
  "names": ["accessor"]
}
