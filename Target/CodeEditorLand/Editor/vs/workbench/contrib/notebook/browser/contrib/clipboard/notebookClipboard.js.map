{
  "version": 3,
  "sources": ["../../../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/notebook/browser/contrib/clipboard/notebookClipboard.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport {\n\tgetActiveElement,\n\tgetWindow,\n\tisAncestor,\n\tisEditableElement,\n\tisHTMLElement,\n} from \"../../../../../../base/browser/dom.js\";\nimport { KeyCode, KeyMod } from \"../../../../../../base/common/keyCodes.js\";\nimport { Disposable } from \"../../../../../../base/common/lifecycle.js\";\nimport * as platform from \"../../../../../../base/common/platform.js\";\nimport {\n\tRedoCommand,\n\tUndoCommand,\n} from \"../../../../../../editor/browser/editorExtensions.js\";\nimport {\n\tCopyAction,\n\tCutAction,\n\tPasteAction,\n} from \"../../../../../../editor/contrib/clipboard/browser/clipboard.js\";\nimport { localize, localize2 } from \"../../../../../../nls.js\";\nimport { Categories } from \"../../../../../../platform/action/common/actionCommonCategories.js\";\nimport {\n\tAction2,\n\tMenuId,\n\tregisterAction2,\n} from \"../../../../../../platform/actions/common/actions.js\";\nimport { IClipboardService } from \"../../../../../../platform/clipboard/common/clipboardService.js\";\nimport { ICommandService } from \"../../../../../../platform/commands/common/commands.js\";\nimport { ContextKeyExpr } from \"../../../../../../platform/contextkey/common/contextkey.js\";\nimport { InputFocusedContextKey } from \"../../../../../../platform/contextkey/common/contextkeys.js\";\nimport type { ServicesAccessor } from \"../../../../../../platform/instantiation/common/instantiation.js\";\nimport { KeybindingWeight } from \"../../../../../../platform/keybinding/common/keybindingsRegistry.js\";\nimport { ILogService } from \"../../../../../../platform/log/common/log.js\";\nimport {\n\tWorkbenchPhase,\n\tregisterWorkbenchContribution2,\n} from \"../../../../../common/contributions.js\";\nimport { IEditorService } from \"../../../../../services/editor/common/editorService.js\";\nimport { showWindowLogActionId } from \"../../../../../services/log/common/logConstants.js\";\nimport type { IWebview } from \"../../../../webview/browser/webview.js\";\nimport {\n\ttype NotebookCellTextModel,\n\tcloneNotebookCellTextModel,\n} from \"../../../common/model/notebookCellTextModel.js\";\nimport {\n\tCellEditType,\n\ttype ICellEditOperation,\n\ttype ISelectionState,\n\tSelectionStateType,\n} from \"../../../common/notebookCommon.js\";\nimport {\n\tNOTEBOOK_CELL_EDITABLE,\n\tNOTEBOOK_EDITOR_EDITABLE,\n\tNOTEBOOK_EDITOR_FOCUSED,\n\tNOTEBOOK_OUTPUT_FOCUSED,\n} from \"../../../common/notebookContextKeys.js\";\nimport { INotebookService } from \"../../../common/notebookService.js\";\nimport {\n\tCellOverflowToolbarGroups,\n\ttype INotebookActionContext,\n\ttype INotebookCellActionContext,\n\tNOTEBOOK_EDITOR_WIDGET_ACTION_WEIGHT,\n\tNOTEBOOK_OUTPUT_WEBVIEW_ACTION_WEIGHT,\n\tNotebookAction,\n\tNotebookCellAction,\n} from \"../../controller/coreActions.js\";\nimport {\n\ttype ICellViewModel,\n\ttype INotebookEditor,\n\tcellRangeToViewCells,\n\texpandCellRangesWithHiddenCells,\n\tgetNotebookEditorFromEditorPane,\n} from \"../../notebookBrowser.js\";\n\nlet _logging = false;\nfunction toggleLogging() {\n\t_logging = !_logging;\n}\n\nfunction _log(loggerService: ILogService, str: string) {\n\tif (_logging) {\n\t\tloggerService.info(`[NotebookClipboard]: ${str}`);\n\t}\n}\n\nfunction getFocusedEditor(accessor: ServicesAccessor) {\n\tconst loggerService = accessor.get(ILogService);\n\tconst editorService = accessor.get(IEditorService);\n\tconst editor = getNotebookEditorFromEditorPane(\n\t\teditorService.activeEditorPane,\n\t);\n\tif (!editor) {\n\t\t_log(\n\t\t\tloggerService,\n\t\t\t\"[Revive Webview] No notebook editor found for active editor pane, bypass\",\n\t\t);\n\t\treturn;\n\t}\n\n\tif (!editor.hasEditorFocus()) {\n\t\t_log(\n\t\t\tloggerService,\n\t\t\t\"[Revive Webview] Notebook editor is not focused, bypass\",\n\t\t);\n\t\treturn;\n\t}\n\n\tif (!editor.hasWebviewFocus()) {\n\t\t_log(\n\t\t\tloggerService,\n\t\t\t\"[Revive Webview] Notebook editor backlayer webview is not focused, bypass\",\n\t\t);\n\t\treturn;\n\t}\n\t// If none of the outputs have focus, then webview is not focused\n\tconst view = editor.getViewModel();\n\tif (\n\t\tview &&\n\t\tview.viewCells.every(\n\t\t\t(cell) => !cell.outputIsFocused && !cell.outputIsHovered,\n\t\t)\n\t) {\n\t\treturn;\n\t}\n\n\treturn { editor, loggerService };\n}\nfunction getFocusedWebviewDelegate(\n\taccessor: ServicesAccessor,\n): IWebview | undefined {\n\tconst result = getFocusedEditor(accessor);\n\tif (!result) {\n\t\treturn;\n\t}\n\tconst webview = result.editor.getInnerWebview();\n\t_log(\n\t\tresult.loggerService,\n\t\t\"[Revive Webview] Notebook editor backlayer webview is focused\",\n\t);\n\treturn webview;\n}\n\nfunction withWebview(\n\taccessor: ServicesAccessor,\n\tf: (webviewe: IWebview) => void,\n) {\n\tconst webview = getFocusedWebviewDelegate(accessor);\n\tif (webview) {\n\t\tf(webview);\n\t\treturn true;\n\t}\n\treturn false;\n}\n\nfunction withEditor(\n\taccessor: ServicesAccessor,\n\tf: (editor: INotebookEditor) => boolean,\n) {\n\tconst result = getFocusedEditor(accessor);\n\treturn result ? f(result.editor) : false;\n}\n\nconst PRIORITY = 105;\n\nUndoCommand.addImplementation(PRIORITY, \"notebook-webview\", (accessor) => {\n\treturn withWebview(accessor, (webview) => webview.undo());\n});\n\nRedoCommand.addImplementation(PRIORITY, \"notebook-webview\", (accessor) => {\n\treturn withWebview(accessor, (webview) => webview.redo());\n});\n\nCopyAction?.addImplementation(PRIORITY, \"notebook-webview\", (accessor) => {\n\treturn withWebview(accessor, (webview) => webview.copy());\n});\n\nPasteAction?.addImplementation(PRIORITY, \"notebook-webview\", (accessor) => {\n\treturn withWebview(accessor, (webview) => webview.paste());\n});\n\nCutAction?.addImplementation(PRIORITY, \"notebook-webview\", (accessor) => {\n\treturn withWebview(accessor, (webview) => webview.cut());\n});\n\nexport function runPasteCells(\n\teditor: INotebookEditor,\n\tactiveCell: ICellViewModel | undefined,\n\tpasteCells: {\n\t\titems: NotebookCellTextModel[];\n\t\tisCopy: boolean;\n\t},\n): boolean {\n\tif (!editor.hasModel()) {\n\t\treturn false;\n\t}\n\tconst textModel = editor.textModel;\n\n\tif (editor.isReadOnly) {\n\t\treturn false;\n\t}\n\n\tconst originalState: ISelectionState = {\n\t\tkind: SelectionStateType.Index,\n\t\tfocus: editor.getFocus(),\n\t\tselections: editor.getSelections(),\n\t};\n\n\tif (activeCell) {\n\t\tconst currCellIndex = editor.getCellIndex(activeCell);\n\t\tconst newFocusIndex =\n\t\t\ttypeof currCellIndex === \"number\" ? currCellIndex + 1 : 0;\n\t\ttextModel.applyEdits(\n\t\t\t[\n\t\t\t\t{\n\t\t\t\t\teditType: CellEditType.Replace,\n\t\t\t\t\tindex: newFocusIndex,\n\t\t\t\t\tcount: 0,\n\t\t\t\t\tcells: pasteCells.items.map((cell) =>\n\t\t\t\t\t\tcloneNotebookCellTextModel(cell),\n\t\t\t\t\t),\n\t\t\t\t},\n\t\t\t],\n\t\t\ttrue,\n\t\t\toriginalState,\n\t\t\t() => ({\n\t\t\t\tkind: SelectionStateType.Index,\n\t\t\t\tfocus: { start: newFocusIndex, end: newFocusIndex + 1 },\n\t\t\t\tselections: [\n\t\t\t\t\t{\n\t\t\t\t\t\tstart: newFocusIndex,\n\t\t\t\t\t\tend: newFocusIndex + pasteCells.items.length,\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t}),\n\t\t\tundefined,\n\t\t\ttrue,\n\t\t);\n\t} else {\n\t\tif (editor.getLength() !== 0) {\n\t\t\treturn false;\n\t\t}\n\n\t\ttextModel.applyEdits(\n\t\t\t[\n\t\t\t\t{\n\t\t\t\t\teditType: CellEditType.Replace,\n\t\t\t\t\tindex: 0,\n\t\t\t\t\tcount: 0,\n\t\t\t\t\tcells: pasteCells.items.map((cell) =>\n\t\t\t\t\t\tcloneNotebookCellTextModel(cell),\n\t\t\t\t\t),\n\t\t\t\t},\n\t\t\t],\n\t\t\ttrue,\n\t\t\toriginalState,\n\t\t\t() => ({\n\t\t\t\tkind: SelectionStateType.Index,\n\t\t\t\tfocus: { start: 0, end: 1 },\n\t\t\t\tselections: [{ start: 1, end: pasteCells.items.length + 1 }],\n\t\t\t}),\n\t\t\tundefined,\n\t\t\ttrue,\n\t\t);\n\t}\n\n\treturn true;\n}\n\nexport function runCopyCells(\n\taccessor: ServicesAccessor,\n\teditor: INotebookEditor,\n\ttargetCell: ICellViewModel | undefined,\n): boolean {\n\tif (!editor.hasModel()) {\n\t\treturn false;\n\t}\n\n\tif (editor.hasOutputTextSelection()) {\n\t\tgetWindow(editor.getDomNode()).document.execCommand(\"copy\");\n\t\treturn true;\n\t}\n\n\tconst clipboardService = accessor.get<IClipboardService>(IClipboardService);\n\tconst notebookService = accessor.get<INotebookService>(INotebookService);\n\tconst selections = editor.getSelections();\n\n\tif (targetCell) {\n\t\tconst targetCellIndex = editor.getCellIndex(targetCell);\n\t\tconst containingSelection = selections.find(\n\t\t\t(selection) =>\n\t\t\t\tselection.start <= targetCellIndex &&\n\t\t\t\ttargetCellIndex < selection.end,\n\t\t);\n\n\t\tif (!containingSelection) {\n\t\t\tclipboardService.writeText(targetCell.getText());\n\t\t\tnotebookService.setToCopy([targetCell.model], true);\n\t\t\treturn true;\n\t\t}\n\t}\n\n\tconst selectionRanges = expandCellRangesWithHiddenCells(\n\t\teditor,\n\t\teditor.getSelections(),\n\t);\n\tconst selectedCells = cellRangeToViewCells(editor, selectionRanges);\n\n\tif (!selectedCells.length) {\n\t\treturn false;\n\t}\n\n\tclipboardService.writeText(\n\t\tselectedCells.map((cell) => cell.getText()).join(\"\\n\"),\n\t);\n\tnotebookService.setToCopy(\n\t\tselectedCells.map((cell) => cell.model),\n\t\ttrue,\n\t);\n\n\treturn true;\n}\nexport function runCutCells(\n\taccessor: ServicesAccessor,\n\teditor: INotebookEditor,\n\ttargetCell: ICellViewModel | undefined,\n): boolean {\n\tif (!editor.hasModel() || editor.isReadOnly) {\n\t\treturn false;\n\t}\n\n\tconst textModel = editor.textModel;\n\tconst clipboardService = accessor.get<IClipboardService>(IClipboardService);\n\tconst notebookService = accessor.get<INotebookService>(INotebookService);\n\tconst selections = editor.getSelections();\n\n\tif (targetCell) {\n\t\t// from ui\n\t\tconst targetCellIndex = editor.getCellIndex(targetCell);\n\t\tconst containingSelection = selections.find(\n\t\t\t(selection) =>\n\t\t\t\tselection.start <= targetCellIndex &&\n\t\t\t\ttargetCellIndex < selection.end,\n\t\t);\n\n\t\tif (!containingSelection) {\n\t\t\tclipboardService.writeText(targetCell.getText());\n\t\t\t// delete cell\n\t\t\tconst focus = editor.getFocus();\n\t\t\tconst newFocus =\n\t\t\t\tfocus.end <= targetCellIndex\n\t\t\t\t\t? focus\n\t\t\t\t\t: { start: focus.start - 1, end: focus.end - 1 };\n\t\t\tconst newSelections = selections.map((selection) =>\n\t\t\t\tselection.end <= targetCellIndex\n\t\t\t\t\t? selection\n\t\t\t\t\t: { start: selection.start - 1, end: selection.end - 1 },\n\t\t\t);\n\n\t\t\ttextModel.applyEdits(\n\t\t\t\t[\n\t\t\t\t\t{\n\t\t\t\t\t\teditType: CellEditType.Replace,\n\t\t\t\t\t\tindex: targetCellIndex,\n\t\t\t\t\t\tcount: 1,\n\t\t\t\t\t\tcells: [],\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\ttrue,\n\t\t\t\t{\n\t\t\t\t\tkind: SelectionStateType.Index,\n\t\t\t\t\tfocus: editor.getFocus(),\n\t\t\t\t\tselections: selections,\n\t\t\t\t},\n\t\t\t\t() => ({\n\t\t\t\t\tkind: SelectionStateType.Index,\n\t\t\t\t\tfocus: newFocus,\n\t\t\t\t\tselections: newSelections,\n\t\t\t\t}),\n\t\t\t\tundefined,\n\t\t\t\ttrue,\n\t\t\t);\n\n\t\t\tnotebookService.setToCopy([targetCell.model], false);\n\t\t\treturn true;\n\t\t}\n\t}\n\n\tconst focus = editor.getFocus();\n\tconst containingSelection = selections.find(\n\t\t(selection) =>\n\t\t\tselection.start <= focus.start && focus.end <= selection.end,\n\t);\n\n\tif (!containingSelection) {\n\t\t// focus is out of any selection, we should only cut this cell\n\t\tconst targetCell = editor.cellAt(focus.start);\n\t\tclipboardService.writeText(targetCell.getText());\n\t\tconst newFocus =\n\t\t\tfocus.end === editor.getLength()\n\t\t\t\t? { start: focus.start - 1, end: focus.end - 1 }\n\t\t\t\t: focus;\n\t\tconst newSelections = selections.map((selection) =>\n\t\t\tselection.end <= focus.start\n\t\t\t\t? selection\n\t\t\t\t: { start: selection.start - 1, end: selection.end - 1 },\n\t\t);\n\t\ttextModel.applyEdits(\n\t\t\t[\n\t\t\t\t{\n\t\t\t\t\teditType: CellEditType.Replace,\n\t\t\t\t\tindex: focus.start,\n\t\t\t\t\tcount: 1,\n\t\t\t\t\tcells: [],\n\t\t\t\t},\n\t\t\t],\n\t\t\ttrue,\n\t\t\t{\n\t\t\t\tkind: SelectionStateType.Index,\n\t\t\t\tfocus: editor.getFocus(),\n\t\t\t\tselections: selections,\n\t\t\t},\n\t\t\t() => ({\n\t\t\t\tkind: SelectionStateType.Index,\n\t\t\t\tfocus: newFocus,\n\t\t\t\tselections: newSelections,\n\t\t\t}),\n\t\t\tundefined,\n\t\t\ttrue,\n\t\t);\n\n\t\tnotebookService.setToCopy([targetCell.model], false);\n\t\treturn true;\n\t}\n\n\tconst selectionRanges = expandCellRangesWithHiddenCells(\n\t\teditor,\n\t\teditor.getSelections(),\n\t);\n\tconst selectedCells = cellRangeToViewCells(editor, selectionRanges);\n\n\tif (!selectedCells.length) {\n\t\treturn false;\n\t}\n\n\tclipboardService.writeText(\n\t\tselectedCells.map((cell) => cell.getText()).join(\"\\n\"),\n\t);\n\tconst edits: ICellEditOperation[] = selectionRanges.map((range) => ({\n\t\teditType: CellEditType.Replace,\n\t\tindex: range.start,\n\t\tcount: range.end - range.start,\n\t\tcells: [],\n\t}));\n\tconst firstSelectIndex = selectionRanges[0].start;\n\n\t/**\n\t * If we have cells, 0, 1, 2, 3, 4, 5, 6\n\t * and cells 1, 2 are selected, and then we delete cells 1 and 2\n\t * the new focused cell should still be at index 1\n\t */\n\tconst newFocusedCellIndex =\n\t\tfirstSelectIndex < textModel.cells.length - 1\n\t\t\t? firstSelectIndex\n\t\t\t: Math.max(textModel.cells.length - 2, 0);\n\n\ttextModel.applyEdits(\n\t\tedits,\n\t\ttrue,\n\t\t{\n\t\t\tkind: SelectionStateType.Index,\n\t\t\tfocus: editor.getFocus(),\n\t\t\tselections: selectionRanges,\n\t\t},\n\t\t() => {\n\t\t\treturn {\n\t\t\t\tkind: SelectionStateType.Index,\n\t\t\t\tfocus: {\n\t\t\t\t\tstart: newFocusedCellIndex,\n\t\t\t\t\tend: newFocusedCellIndex + 1,\n\t\t\t\t},\n\t\t\t\tselections: [\n\t\t\t\t\t{\n\t\t\t\t\t\tstart: newFocusedCellIndex,\n\t\t\t\t\t\tend: newFocusedCellIndex + 1,\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t};\n\t\t},\n\t\tundefined,\n\t\ttrue,\n\t);\n\tnotebookService.setToCopy(\n\t\tselectedCells.map((cell) => cell.model),\n\t\tfalse,\n\t);\n\n\treturn true;\n}\n\nexport class NotebookClipboardContribution extends Disposable {\n\tstatic readonly ID = \"workbench.contrib.notebookClipboard\";\n\n\tconstructor(\n\t\t@IEditorService private readonly _editorService: IEditorService,\n\t) {\n\t\tsuper();\n\n\t\tconst PRIORITY = 105;\n\n\t\tif (CopyAction) {\n\t\t\tthis._register(\n\t\t\t\tCopyAction.addImplementation(\n\t\t\t\t\tPRIORITY,\n\t\t\t\t\t\"notebook-clipboard\",\n\t\t\t\t\t(accessor) => {\n\t\t\t\t\t\treturn this.runCopyAction(accessor);\n\t\t\t\t\t},\n\t\t\t\t),\n\t\t\t);\n\t\t}\n\n\t\tif (PasteAction) {\n\t\t\tthis._register(\n\t\t\t\tPasteAction.addImplementation(\n\t\t\t\t\tPRIORITY,\n\t\t\t\t\t\"notebook-clipboard\",\n\t\t\t\t\t(accessor) => {\n\t\t\t\t\t\treturn this.runPasteAction(accessor);\n\t\t\t\t\t},\n\t\t\t\t),\n\t\t\t);\n\t\t}\n\n\t\tif (CutAction) {\n\t\t\tthis._register(\n\t\t\t\tCutAction.addImplementation(\n\t\t\t\t\tPRIORITY,\n\t\t\t\t\t\"notebook-clipboard\",\n\t\t\t\t\t(accessor) => {\n\t\t\t\t\t\treturn this.runCutAction(accessor);\n\t\t\t\t\t},\n\t\t\t\t),\n\t\t\t);\n\t\t}\n\t}\n\n\tprivate _getContext() {\n\t\tconst editor = getNotebookEditorFromEditorPane(\n\t\t\tthis._editorService.activeEditorPane,\n\t\t);\n\t\tconst activeCell = editor?.getActiveCell();\n\n\t\treturn {\n\t\t\teditor,\n\t\t\tactiveCell,\n\t\t};\n\t}\n\n\tprivate _focusInsideEmebedMonaco(editor: INotebookEditor) {\n\t\tconst windowSelection = getWindow(editor.getDomNode()).getSelection();\n\n\t\tif (windowSelection?.rangeCount !== 1) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst activeSelection = windowSelection.getRangeAt(0);\n\t\tif (\n\t\t\tactiveSelection.startContainer === activeSelection.endContainer &&\n\t\t\tactiveSelection.endOffset - activeSelection.startOffset === 0\n\t\t) {\n\t\t\treturn false;\n\t\t}\n\n\t\tlet container: any = activeSelection.commonAncestorContainer;\n\t\tconst body = editor.getDomNode();\n\n\t\tif (!body.contains(container)) {\n\t\t\treturn false;\n\t\t}\n\n\t\twhile (container && container !== body) {\n\t\t\tif (\n\t\t\t\t(container as HTMLElement).classList &&\n\t\t\t\t(container as HTMLElement).classList.contains(\"monaco-editor\")\n\t\t\t) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tcontainer = container.parentNode;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\trunCopyAction(accessor: ServicesAccessor) {\n\t\tconst loggerService = accessor.get(ILogService);\n\n\t\tconst activeElement = getActiveElement();\n\t\tif (isHTMLElement(activeElement) && isEditableElement(activeElement)) {\n\t\t\t_log(\n\t\t\t\tloggerService,\n\t\t\t\t\"[NotebookEditor] focus is on input or textarea element, bypass\",\n\t\t\t);\n\t\t\treturn false;\n\t\t}\n\n\t\tconst { editor } = this._getContext();\n\t\tif (!editor) {\n\t\t\t_log(\n\t\t\t\tloggerService,\n\t\t\t\t\"[NotebookEditor] no active notebook editor, bypass\",\n\t\t\t);\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!isAncestor(activeElement, editor.getDomNode())) {\n\t\t\t_log(\n\t\t\t\tloggerService,\n\t\t\t\t\"[NotebookEditor] focus is outside of the notebook editor, bypass\",\n\t\t\t);\n\t\t\treturn false;\n\t\t}\n\n\t\tif (this._focusInsideEmebedMonaco(editor)) {\n\t\t\t_log(\n\t\t\t\tloggerService,\n\t\t\t\t\"[NotebookEditor] focus is on embed monaco editor, bypass\",\n\t\t\t);\n\t\t\treturn false;\n\t\t}\n\n\t\t_log(\n\t\t\tloggerService,\n\t\t\t\"[NotebookEditor] run copy actions on notebook model\",\n\t\t);\n\t\treturn runCopyCells(accessor, editor, undefined);\n\t}\n\n\trunPasteAction(accessor: ServicesAccessor) {\n\t\tconst activeElement = <HTMLElement>getActiveElement();\n\t\tif (activeElement && isEditableElement(activeElement)) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst notebookService =\n\t\t\taccessor.get<INotebookService>(INotebookService);\n\t\tconst pasteCells = notebookService.getToCopy();\n\n\t\tif (!pasteCells) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst { editor, activeCell } = this._getContext();\n\t\tif (!editor) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn runPasteCells(editor, activeCell, pasteCells);\n\t}\n\n\trunCutAction(accessor: ServicesAccessor) {\n\t\tconst activeElement = <HTMLElement>getActiveElement();\n\t\tif (activeElement && isEditableElement(activeElement)) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst { editor } = this._getContext();\n\t\tif (!editor) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn runCutCells(accessor, editor, undefined);\n\t}\n}\n\nregisterWorkbenchContribution2(\n\tNotebookClipboardContribution.ID,\n\tNotebookClipboardContribution,\n\tWorkbenchPhase.BlockRestore,\n);\n\nconst COPY_CELL_COMMAND_ID = \"notebook.cell.copy\";\nconst CUT_CELL_COMMAND_ID = \"notebook.cell.cut\";\nconst PASTE_CELL_COMMAND_ID = \"notebook.cell.paste\";\nconst PASTE_CELL_ABOVE_COMMAND_ID = \"notebook.cell.pasteAbove\";\n\nregisterAction2(\n\tclass extends NotebookCellAction {\n\t\tconstructor() {\n\t\t\tsuper({\n\t\t\t\tid: COPY_CELL_COMMAND_ID,\n\t\t\t\ttitle: localize(\"notebookActions.copy\", \"Copy Cell\"),\n\t\t\t\tmenu: {\n\t\t\t\t\tid: MenuId.NotebookCellTitle,\n\t\t\t\t\twhen: NOTEBOOK_EDITOR_FOCUSED,\n\t\t\t\t\tgroup: CellOverflowToolbarGroups.Copy,\n\t\t\t\t\torder: 2,\n\t\t\t\t},\n\t\t\t\tkeybinding: platform.isNative\n\t\t\t\t\t? undefined\n\t\t\t\t\t: {\n\t\t\t\t\t\t\tprimary: KeyMod.CtrlCmd | KeyCode.KeyC,\n\t\t\t\t\t\t\twin: {\n\t\t\t\t\t\t\t\tprimary: KeyMod.CtrlCmd | KeyCode.KeyC,\n\t\t\t\t\t\t\t\tsecondary: [KeyMod.CtrlCmd | KeyCode.Insert],\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\twhen: ContextKeyExpr.and(\n\t\t\t\t\t\t\t\tNOTEBOOK_EDITOR_FOCUSED,\n\t\t\t\t\t\t\t\tContextKeyExpr.not(InputFocusedContextKey),\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\tweight: KeybindingWeight.WorkbenchContrib,\n\t\t\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t\tasync runWithContext(\n\t\t\taccessor: ServicesAccessor,\n\t\t\tcontext: INotebookCellActionContext,\n\t\t) {\n\t\t\trunCopyCells(accessor, context.notebookEditor, context.cell);\n\t\t}\n\t},\n);\n\nregisterAction2(\n\tclass extends NotebookCellAction {\n\t\tconstructor() {\n\t\t\tsuper({\n\t\t\t\tid: CUT_CELL_COMMAND_ID,\n\t\t\t\ttitle: localize(\"notebookActions.cut\", \"Cut Cell\"),\n\t\t\t\tmenu: {\n\t\t\t\t\tid: MenuId.NotebookCellTitle,\n\t\t\t\t\twhen: ContextKeyExpr.and(\n\t\t\t\t\t\tNOTEBOOK_EDITOR_FOCUSED,\n\t\t\t\t\t\tNOTEBOOK_EDITOR_EDITABLE,\n\t\t\t\t\t\tNOTEBOOK_CELL_EDITABLE,\n\t\t\t\t\t),\n\t\t\t\t\tgroup: CellOverflowToolbarGroups.Copy,\n\t\t\t\t\torder: 1,\n\t\t\t\t},\n\t\t\t\tkeybinding: platform.isNative\n\t\t\t\t\t? undefined\n\t\t\t\t\t: {\n\t\t\t\t\t\t\twhen: ContextKeyExpr.and(\n\t\t\t\t\t\t\t\tNOTEBOOK_EDITOR_FOCUSED,\n\t\t\t\t\t\t\t\tContextKeyExpr.not(InputFocusedContextKey),\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\tprimary: KeyMod.CtrlCmd | KeyCode.KeyX,\n\t\t\t\t\t\t\twin: {\n\t\t\t\t\t\t\t\tprimary: KeyMod.CtrlCmd | KeyCode.KeyX,\n\t\t\t\t\t\t\t\tsecondary: [KeyMod.Shift | KeyCode.Delete],\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tweight: KeybindingWeight.WorkbenchContrib,\n\t\t\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t\tasync runWithContext(\n\t\t\taccessor: ServicesAccessor,\n\t\t\tcontext: INotebookCellActionContext,\n\t\t) {\n\t\t\trunCutCells(accessor, context.notebookEditor, context.cell);\n\t\t}\n\t},\n);\n\nregisterAction2(\n\tclass extends NotebookAction {\n\t\tconstructor() {\n\t\t\tsuper({\n\t\t\t\tid: PASTE_CELL_COMMAND_ID,\n\t\t\t\ttitle: localize(\"notebookActions.paste\", \"Paste Cell\"),\n\t\t\t\tmenu: {\n\t\t\t\t\tid: MenuId.NotebookCellTitle,\n\t\t\t\t\twhen: ContextKeyExpr.and(\n\t\t\t\t\t\tNOTEBOOK_EDITOR_FOCUSED,\n\t\t\t\t\t\tNOTEBOOK_EDITOR_EDITABLE,\n\t\t\t\t\t),\n\t\t\t\t\tgroup: CellOverflowToolbarGroups.Copy,\n\t\t\t\t\torder: 3,\n\t\t\t\t},\n\t\t\t\tkeybinding: platform.isNative\n\t\t\t\t\t? undefined\n\t\t\t\t\t: {\n\t\t\t\t\t\t\twhen: ContextKeyExpr.and(\n\t\t\t\t\t\t\t\tNOTEBOOK_EDITOR_FOCUSED,\n\t\t\t\t\t\t\t\tContextKeyExpr.not(InputFocusedContextKey),\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\tprimary: KeyMod.CtrlCmd | KeyCode.KeyV,\n\t\t\t\t\t\t\twin: {\n\t\t\t\t\t\t\t\tprimary: KeyMod.CtrlCmd | KeyCode.KeyV,\n\t\t\t\t\t\t\t\tsecondary: [KeyMod.Shift | KeyCode.Insert],\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tlinux: {\n\t\t\t\t\t\t\t\tprimary: KeyMod.CtrlCmd | KeyCode.KeyV,\n\t\t\t\t\t\t\t\tsecondary: [KeyMod.Shift | KeyCode.Insert],\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tweight: KeybindingWeight.EditorContrib,\n\t\t\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t\tasync runWithContext(\n\t\t\taccessor: ServicesAccessor,\n\t\t\tcontext: INotebookActionContext,\n\t\t) {\n\t\t\tconst notebookService =\n\t\t\t\taccessor.get<INotebookService>(INotebookService);\n\t\t\tconst pasteCells = notebookService.getToCopy();\n\n\t\t\tif (\n\t\t\t\t!context.notebookEditor.hasModel() ||\n\t\t\t\tcontext.notebookEditor.isReadOnly\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!pasteCells) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\trunPasteCells(context.notebookEditor, context.cell, pasteCells);\n\t\t}\n\t},\n);\n\nregisterAction2(\n\tclass extends NotebookCellAction {\n\t\tconstructor() {\n\t\t\tsuper({\n\t\t\t\tid: PASTE_CELL_ABOVE_COMMAND_ID,\n\t\t\t\ttitle: localize(\n\t\t\t\t\t\"notebookActions.pasteAbove\",\n\t\t\t\t\t\"Paste Cell Above\",\n\t\t\t\t),\n\t\t\t\tkeybinding: {\n\t\t\t\t\twhen: ContextKeyExpr.and(\n\t\t\t\t\t\tNOTEBOOK_EDITOR_FOCUSED,\n\t\t\t\t\t\tContextKeyExpr.not(InputFocusedContextKey),\n\t\t\t\t\t),\n\t\t\t\t\tprimary: KeyMod.CtrlCmd | KeyMod.Shift | KeyCode.KeyV,\n\t\t\t\t\tweight: NOTEBOOK_EDITOR_WIDGET_ACTION_WEIGHT,\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t\tasync runWithContext(\n\t\t\taccessor: ServicesAccessor,\n\t\t\tcontext: INotebookCellActionContext,\n\t\t) {\n\t\t\tconst notebookService =\n\t\t\t\taccessor.get<INotebookService>(INotebookService);\n\t\t\tconst pasteCells = notebookService.getToCopy();\n\t\t\tconst editor = context.notebookEditor;\n\t\t\tconst textModel = editor.textModel;\n\n\t\t\tif (editor.isReadOnly) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!pasteCells) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst originalState: ISelectionState = {\n\t\t\t\tkind: SelectionStateType.Index,\n\t\t\t\tfocus: editor.getFocus(),\n\t\t\t\tselections: editor.getSelections(),\n\t\t\t};\n\n\t\t\tconst currCellIndex = context.notebookEditor.getCellIndex(\n\t\t\t\tcontext.cell,\n\t\t\t);\n\t\t\tconst newFocusIndex = currCellIndex;\n\t\t\ttextModel.applyEdits(\n\t\t\t\t[\n\t\t\t\t\t{\n\t\t\t\t\t\teditType: CellEditType.Replace,\n\t\t\t\t\t\tindex: currCellIndex,\n\t\t\t\t\t\tcount: 0,\n\t\t\t\t\t\tcells: pasteCells.items.map((cell) =>\n\t\t\t\t\t\t\tcloneNotebookCellTextModel(cell),\n\t\t\t\t\t\t),\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\ttrue,\n\t\t\t\toriginalState,\n\t\t\t\t() => ({\n\t\t\t\t\tkind: SelectionStateType.Index,\n\t\t\t\t\tfocus: { start: newFocusIndex, end: newFocusIndex + 1 },\n\t\t\t\t\tselections: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tstart: newFocusIndex,\n\t\t\t\t\t\t\tend: newFocusIndex + pasteCells.items.length,\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t}),\n\t\t\t\tundefined,\n\t\t\t\ttrue,\n\t\t\t);\n\t\t}\n\t},\n);\n\nregisterAction2(\n\tclass extends Action2 {\n\t\tconstructor() {\n\t\t\tsuper({\n\t\t\t\tid: \"workbench.action.toggleNotebookClipboardLog\",\n\t\t\t\ttitle: localize2(\n\t\t\t\t\t\"toggleNotebookClipboardLog\",\n\t\t\t\t\t\"Toggle Notebook Clipboard Troubleshooting\",\n\t\t\t\t),\n\t\t\t\tcategory: Categories.Developer,\n\t\t\t\tf1: true,\n\t\t\t});\n\t\t}\n\n\t\trun(accessor: ServicesAccessor): void {\n\t\t\ttoggleLogging();\n\t\t\tif (_logging) {\n\t\t\t\tconst commandService = accessor.get(ICommandService);\n\t\t\t\tcommandService.executeCommand(showWindowLogActionId);\n\t\t\t}\n\t\t}\n\t},\n);\n\nregisterAction2(\n\tclass extends NotebookCellAction {\n\t\tconstructor() {\n\t\t\tsuper({\n\t\t\t\tid: \"notebook.cell.output.selectAll\",\n\t\t\t\ttitle: localize(\"notebook.cell.output.selectAll\", \"Select All\"),\n\t\t\t\tkeybinding: {\n\t\t\t\t\tprimary: KeyMod.CtrlCmd | KeyCode.KeyA,\n\t\t\t\t\twhen: ContextKeyExpr.and(\n\t\t\t\t\t\tNOTEBOOK_EDITOR_FOCUSED,\n\t\t\t\t\t\tNOTEBOOK_OUTPUT_FOCUSED,\n\t\t\t\t\t),\n\t\t\t\t\tweight: NOTEBOOK_OUTPUT_WEBVIEW_ACTION_WEIGHT,\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t\tasync runWithContext(\n\t\t\taccessor: ServicesAccessor,\n\t\t\t_context: INotebookCellActionContext,\n\t\t) {\n\t\t\twithEditor(accessor, (editor) => {\n\t\t\t\tif (!editor.hasEditorFocus()) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tif (editor.hasEditorFocus() && !editor.hasWebviewFocus()) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\tconst cell = editor.getActiveCell();\n\t\t\t\tif (\n\t\t\t\t\t!cell ||\n\t\t\t\t\t!cell.outputIsFocused ||\n\t\t\t\t\t!editor.hasWebviewFocus()\n\t\t\t\t) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\tif (cell.inputInOutputIsFocused) {\n\t\t\t\t\teditor.selectInputContents(cell);\n\t\t\t\t} else {\n\t\t\t\t\teditor.selectOutputContent(cell);\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t});\n\t\t}\n\t},\n);\n"],
  "mappings": "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",
  "names": ["containingSelection", "focus", "targetCell", "PRIORITY"]
}
