{
  "version": 3,
  "sources": ["../../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/notebook/browser/diff/diffNestedCellViewModel.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Emitter } from \"../../../../../base/common/event.js\";\nimport { Disposable } from \"../../../../../base/common/lifecycle.js\";\nimport { generateUuid } from \"../../../../../base/common/uuid.js\";\nimport { PrefixSumComputer } from \"../../../../../editor/common/model/prefixSumComputer.js\";\nimport type { NotebookCellTextModel } from \"../../common/model/notebookCellTextModel.js\";\nimport { INotebookService } from \"../../common/notebookService.js\";\nimport type {\n\tICellOutputViewModel,\n\tIGenericCellViewModel,\n} from \"../notebookBrowser.js\";\nimport type { CellViewModelStateChangeEvent } from \"../notebookViewEvents.js\";\nimport { CellOutputViewModel } from \"../viewModel/cellOutputViewModel.js\";\nimport type { IDiffNestedCellViewModel } from \"./notebookDiffEditorBrowser.js\";\n\nexport class DiffNestedCellViewModel\n\textends Disposable\n\timplements IDiffNestedCellViewModel, IGenericCellViewModel\n{\n\tprivate _id: string;\n\tget id() {\n\t\treturn this._id;\n\t}\n\n\tget outputs() {\n\t\treturn this.textModel.outputs;\n\t}\n\n\tget language() {\n\t\treturn this.textModel.language;\n\t}\n\n\tget metadata() {\n\t\treturn this.textModel.metadata;\n\t}\n\n\tget uri() {\n\t\treturn this.textModel.uri;\n\t}\n\n\tget handle() {\n\t\treturn this.textModel.handle;\n\t}\n\n\tprotected readonly _onDidChangeState: Emitter<CellViewModelStateChangeEvent> =\n\t\tthis._register(new Emitter<CellViewModelStateChangeEvent>());\n\n\tprivate _hoveringOutput = false;\n\tpublic get outputIsHovered(): boolean {\n\t\treturn this._hoveringOutput;\n\t}\n\n\tpublic set outputIsHovered(v: boolean) {\n\t\tthis._hoveringOutput = v;\n\t\tthis._onDidChangeState.fire({ outputIsHoveredChanged: true });\n\t}\n\n\tprivate _focusOnOutput = false;\n\tpublic get outputIsFocused(): boolean {\n\t\treturn this._focusOnOutput;\n\t}\n\n\tpublic set outputIsFocused(v: boolean) {\n\t\tthis._focusOnOutput = v;\n\t\tthis._onDidChangeState.fire({ outputIsFocusedChanged: true });\n\t}\n\n\tprivate _focusInputInOutput = false;\n\tpublic get inputInOutputIsFocused(): boolean {\n\t\treturn this._focusInputInOutput;\n\t}\n\n\tpublic set inputInOutputIsFocused(v: boolean) {\n\t\tthis._focusInputInOutput = v;\n\t}\n\n\tprivate _outputViewModels: ICellOutputViewModel[];\n\n\tget outputsViewModels() {\n\t\treturn this._outputViewModels;\n\t}\n\n\tprotected _outputCollection: number[] = [];\n\tprotected _outputsTop: PrefixSumComputer | null = null;\n\n\tprotected readonly _onDidChangeOutputLayout = this._register(\n\t\tnew Emitter<void>(),\n\t);\n\treadonly onDidChangeOutputLayout = this._onDidChangeOutputLayout.event;\n\n\tconstructor(\n\t\treadonly textModel: NotebookCellTextModel,\n\t\t@INotebookService private _notebookService: INotebookService\n\t) {\n\t\tsuper();\n\t\tthis._id = generateUuid();\n\n\t\tthis._outputViewModels = this.textModel.outputs.map(output => new CellOutputViewModel(this, output, this._notebookService));\n\t\tthis._register(this.textModel.onDidChangeOutputs((splice) => {\n\t\t\tthis._outputCollection.splice(splice.start, splice.deleteCount, ...splice.newOutputs.map(() => 0));\n\t\t\tconst removed = this._outputViewModels.splice(splice.start, splice.deleteCount, ...splice.newOutputs.map(output => new CellOutputViewModel(this, output, this._notebookService)));\n\t\t\tremoved.forEach(vm => vm.dispose());\n\n\t\t\tthis._outputsTop = null;\n\t\t\tthis._onDidChangeOutputLayout.fire();\n\t\t}));\n\t\tthis._outputCollection = new Array(this.textModel.outputs.length);\n\t}\n\n\tprivate _ensureOutputsTop() {\n\t\tif (!this._outputsTop) {\n\t\t\tconst values = new Uint32Array(this._outputCollection.length);\n\t\t\tfor (let i = 0; i < this._outputCollection.length; i++) {\n\t\t\t\tvalues[i] = this._outputCollection[i];\n\t\t\t}\n\n\t\t\tthis._outputsTop = new PrefixSumComputer(values);\n\t\t}\n\t}\n\n\tgetOutputOffset(index: number): number {\n\t\tthis._ensureOutputsTop();\n\n\t\tif (index >= this._outputCollection.length) {\n\t\t\tthrow new Error(\"Output index out of range!\");\n\t\t}\n\n\t\treturn this._outputsTop!.getPrefixSum(index - 1);\n\t}\n\n\tupdateOutputHeight(index: number, height: number): void {\n\t\tif (index >= this._outputCollection.length) {\n\t\t\tthrow new Error(\"Output index out of range!\");\n\t\t}\n\n\t\tthis._ensureOutputsTop();\n\t\tthis._outputCollection[index] = height;\n\t\tif (this._outputsTop!.setValue(index, height)) {\n\t\t\tthis._onDidChangeOutputLayout.fire();\n\t\t}\n\t}\n\n\tgetOutputTotalHeight() {\n\t\tthis._ensureOutputsTop();\n\n\t\treturn this._outputsTop?.getTotalSum() ?? 0;\n\t}\n\n\tpublic override dispose(): void {\n\t\tsuper.dispose();\n\n\t\tthis._outputViewModels.forEach((output) => {\n\t\t\toutput.dispose();\n\t\t});\n\t}\n}\n"],
  "mappings": "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",
  "names": []
}
